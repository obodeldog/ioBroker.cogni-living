const a0_0x4545e3=a0_0x3016;(function(_0x17684d,_0x50024a){const _0x480730=a0_0x3016,_0x5d6bbe=_0x17684d();while(!![]){try{const _0x50a480=parseInt(_0x480730(0x1e4))/0x1+-parseInt(_0x480730(0x21c))/0x2*(parseInt(_0x480730(0x1f0))/0x3)+-parseInt(_0x480730(0x1d7))/0x4*(-parseInt(_0x480730(0x1fb))/0x5)+-parseInt(_0x480730(0x1f1))/0x6*(-parseInt(_0x480730(0x1de))/0x7)+parseInt(_0x480730(0x200))/0x8*(parseInt(_0x480730(0x1dd))/0x9)+parseInt(_0x480730(0x1ff))/0xa+parseInt(_0x480730(0x208))/0xb*(-parseInt(_0x480730(0x209))/0xc);if(_0x50a480===_0x50024a)break;else _0x5d6bbe['push'](_0x5d6bbe['shift']());}catch(_0x23eac9){_0x5d6bbe['push'](_0x5d6bbe['shift']());}}}(a0_0xc4a6,0x72cf1));const a0_0x352df1=(function(){let _0x2330de=!![];return function(_0xa17af0,_0x1a4fbd){const _0x16a6f6=_0x2330de?function(){const _0x522f7c=a0_0x3016;if(_0x1a4fbd){const _0x2b7f96=_0x1a4fbd[_0x522f7c(0x1e7)](_0xa17af0,arguments);return _0x1a4fbd=null,_0x2b7f96;}}:function(){};return _0x2330de=![],_0x16a6f6;};}()),a0_0x391bd8=a0_0x352df1(this,function(){const _0x54c92b=a0_0x3016;return a0_0x391bd8['toString']()[_0x54c92b(0x21e)](_0x54c92b(0x1df))[_0x54c92b(0x1af)]()['constructor'](a0_0x391bd8)[_0x54c92b(0x21e)](_0x54c92b(0x1df));});a0_0x391bd8();'use strict';const {GoogleGenerativeAI}=require('@google/generative-ai'),setup=require('./setup'),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x4545e3(0x1fd),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_RAW_LOG=a0_0x4545e3(0x1f7),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':a0_0x4545e3(0x1b1),'family':a0_0x4545e3(0x1b2),'single_comfort':a0_0x4545e3(0x19f),'security':a0_0x4545e3(0x1a5),'energy_saver':a0_0x4545e3(0x215)};function a0_0x3016(_0x5a020a,_0x3ccbc5){const _0x28146f=a0_0xc4a6();return a0_0x3016=function(_0x391bd8,_0x352df1){_0x391bd8=_0x391bd8-0x19d;let _0xc4a6d3=_0x28146f[_0x391bd8];return _0xc4a6d3;},a0_0x3016(_0x5a020a,_0x3ccbc5);}function canCallApi(){const _0x5773ec=a0_0x4545e3,_0x265cb4=Date[_0x5773ec(0x1a7)]();return _0x265cb4-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x3b96b8=a0_0x4545e3;lastGlobalApiCall=Date[_0x3b96b8(0x1a7)]();}async function getWeatherContext(_0x267105){const _0x315bae=a0_0x4545e3;if(!_0x267105[_0x315bae(0x1f8)][_0x315bae(0x1ae)]||!_0x267105[_0x315bae(0x1f8)]['weatherInstance'])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x48e750=_0x267105[_0x315bae(0x1f8)][_0x315bae(0x1c8)];let _0x18e558=await _0x267105[_0x315bae(0x1f5)](_0x48e750+_0x315bae(0x1f3));if(!_0x18e558)_0x18e558=await _0x267105['getForeignStateAsync'](_0x48e750+_0x315bae(0x1ef));let _0x1cc17b=await _0x267105['getForeignStateAsync'](_0x48e750+'.Current.WeatherText');if(!_0x1cc17b)_0x1cc17b=await _0x267105['getForeignStateAsync'](_0x48e750+_0x315bae(0x1d2));let _0x2b24da='Unbekannt';const _0x488327=await _0x267105[_0x315bae(0x1f5)](_0x48e750+_0x315bae(0x1bd));if(_0x488327)_0x2b24da=_0x488327[_0x315bae(0x1ab)]?_0x315bae(0x212):_0x315bae(0x1e9);if(_0x18e558&&_0x1cc17b)return _0x18e558[_0x315bae(0x1ab)]+_0x315bae(0x1a1)+_0x1cc17b['val']+',\x20Lichtverh√§ltnisse:\x20'+_0x2b24da;}catch(_0x31cbd3){}return _0x315bae(0x21b);}async function consultButler(_0x240490,_0x20b0f2,_0x562678,_0x219492){const _0x1eae76=a0_0x4545e3;if(!_0x240490[_0x1eae76(0x213)])return{'approved':!![],'reason':_0x1eae76(0x1b6)};const _0x15c23d=Date[_0x1eae76(0x1a7)]();if(decisionCache[_0x20b0f2]&&_0x15c23d-decisionCache[_0x20b0f2]['timestamp']<CACHE_TTL_MS){const _0x41f501=decisionCache[_0x20b0f2][_0x1eae76(0x1fe)];return _0x240490[_0x1eae76(0x1d5)]['debug'](_0x1eae76(0x1c5)+_0x20b0f2+_0x1eae76(0x219)+(_0x41f501[_0x1eae76(0x203)]?'OK':'NO')+'\x20('+_0x41f501[_0x1eae76(0x216)]+')'),_0x41f501;}if(!canCallApi())return _0x240490[_0x1eae76(0x1d5)][_0x1eae76(0x1b0)](_0x1eae76(0x1c9)+_0x20b0f2+_0x1eae76(0x214)),{'approved':!![],'reason':_0x1eae76(0x1d0)};const _0x12558f=new Date()[_0x1eae76(0x1b4)](),_0xa3d13f=await getWeatherContext(_0x240490),_0x77d032=PERSONA_MAPPING[_0x240490['config'][_0x1eae76(0x1ed)]||_0x1eae76(0x1e3)],_0x7b262a='\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20'+_0x12558f+_0x1eae76(0x205)+_0xa3d13f+_0x1eae76(0x1a9)+(_0x219492*0x64)['toFixed'](0x0)+_0x1eae76(0x1ec)+_0x20b0f2+'\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22'+_0x562678+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x77d032+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x46547=await _0x240490[_0x1eae76(0x213)][_0x1eae76(0x1ca)](_0x7b262a),_0x175747=_0x46547[_0x1eae76(0x1c7)][_0x1eae76(0x1fa)]()[_0x1eae76(0x1e1)](/```json|```/g,'')[_0x1eae76(0x1a8)](),_0xa2445b=JSON[_0x1eae76(0x1fc)](_0x175747);return decisionCache[_0x20b0f2]={'decision':_0xa2445b,'timestamp':_0x15c23d},_0xa2445b;}catch(_0x101f69){return _0x240490['log'][_0x1eae76(0x218)](_0x1eae76(0x1da)+_0x101f69[_0x1eae76(0x1ac)]),decisionCache[_0x20b0f2]={'decision':{'approved':!![],'reason':_0x1eae76(0x20e)},'timestamp':_0x15c23d-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x1eae76(0x20e)};}}async function runGeminiAnalysis(_0x580352,_0x4cd453=''){const _0x204f20=a0_0x4545e3;if(!_0x580352[_0x204f20(0x213)])return;if(!canCallApi()){_0x580352[_0x204f20(0x1d5)][_0x204f20(0x1b0)]('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x580352['eventHistory'][_0x204f20(0x210)]===0x0)return;const _0x21fa37=_0x580352[_0x204f20(0x20c)][_0x204f20(0x1eb)](0x0,0xf),_0x316ef5=_0x580352['currentSystemMode'],_0x7dddb3=PERSONA_MAPPING[_0x580352[_0x204f20(0x1f8)][_0x204f20(0x1ed)]||_0x204f20(0x1e3)],_0x240cd6=_0x580352[_0x204f20(0x1f8)][_0x204f20(0x1e8)]||_0x204f20(0x20b);let _0x5b5705=_0x204f20(0x1c1);try{const _0x26b357=await _0x580352[_0x204f20(0x1cb)](_0x204f20(0x1bb));if(_0x26b357&&_0x26b357['val'])_0x5b5705=_0x26b357[_0x204f20(0x1ab)];}catch(_0x4a5971){}let _0x2561ed=![];try{const _0x4e0538=await _0x580352[_0x204f20(0x1cb)](_0x204f20(0x1f4));if(_0x4e0538&&_0x4e0538['val'])_0x2561ed=!![];}catch(_0x5e1736){}const _0x398e69=_0x204f20(0x1ea)+_0x7dddb3+'.\x20KONTEXT:\x20'+_0x240cd6+'.\x20SYSTEM_MODE:\x20'+_0x316ef5+'.\x20ANWESEND:\x20'+_0x5b5705+_0x204f20(0x1e5)+JSON[_0x204f20(0x1e2)](_0x21fa37)+_0x204f20(0x1ba)+_0x4cd453+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x320f91=await _0x580352['geminiModel'][_0x204f20(0x1ca)](_0x398e69),_0x21e0fb=JSON['parse'](_0x320f91[_0x204f20(0x1c7)][_0x204f20(0x1fa)]()[_0x204f20(0x1e1)](/```json|```/g,'')[_0x204f20(0x1a8)]());await _0x580352[_0x204f20(0x1f9)](_0x204f20(0x19d),{'val':JSON[_0x204f20(0x1e2)](_0x21e0fb),'ack':!![]});if(_0x21e0fb[_0x204f20(0x1c0)])await _0x580352[_0x204f20(0x1f9)](_0x204f20(0x211),{'val':_0x21e0fb[_0x204f20(0x1c0)],'ack':!![]});const _0x2fd637={'timestamp':Date[_0x204f20(0x1a7)](),'id':Date[_0x204f20(0x1a7)]()[_0x204f20(0x1af)](),'analysis':{'activity':{'summary':_0x21e0fb[_0x204f20(0x1c0)],'isAlert':_0x21e0fb[_0x204f20(0x19e)],'alertReason':_0x21e0fb[_0x204f20(0x1cc)]},'comfort':{'automationProposal':_0x21e0fb['automationProposal']}}};_0x580352[_0x204f20(0x1a3)]['unshift'](_0x2fd637);if(_0x580352[_0x204f20(0x1a3)][_0x204f20(0x210)]>0x32)_0x580352[_0x204f20(0x1a3)][_0x204f20(0x1b8)]();await _0x580352[_0x204f20(0x1f9)](_0x204f20(0x20a),{'val':JSON[_0x204f20(0x1e2)](_0x580352[_0x204f20(0x1a3)]),'ack':!![]});const _0x407572=_0x21e0fb[_0x204f20(0x19e)]||![];_0x407572!==_0x580352[_0x204f20(0x1ad)]&&(await _0x580352['setStateAsync']('analysis.isAlert',{'val':_0x407572,'ack':!![]}),_0x580352[_0x204f20(0x1ad)]=_0x407572,_0x407572&&(await _0x580352[_0x204f20(0x1f9)](_0x204f20(0x202),{'val':_0x21e0fb[_0x204f20(0x1cc)],'ack':!![]}),setup[_0x204f20(0x207)](_0x580352,_0x204f20(0x21f)+_0x21e0fb[_0x204f20(0x1cc)],![],_0x21e0fb[_0x204f20(0x1f6)])));if(_0x21e0fb[_0x204f20(0x1c2)]&&_0x21e0fb['automationProposal'][_0x204f20(0x1b7)]){await _0x580352[_0x204f20(0x1f9)](_0x204f20(0x1c3),{'val':!![],'ack':!![]}),await _0x580352['setStateAsync'](_0x204f20(0x1a2),{'val':_0x21e0fb[_0x204f20(0x1c2)][_0x204f20(0x1b5)],'ack':!![]}),await _0x580352['setStateAsync'](_0x204f20(0x1d4),{'val':_0x21e0fb[_0x204f20(0x1c2)][_0x204f20(0x1ce)],'ack':!![]}),await _0x580352[_0x204f20(0x1f9)](_0x204f20(0x21d),{'val':JSON['stringify'](_0x21e0fb['automationProposal']['targetValue']),'ack':!![]});if(_0x2561ed)executeAutomationAction(_0x580352);}}catch(_0xb5f7ae){_0x580352[_0x204f20(0x1d5)][_0x204f20(0x1a0)](_0x204f20(0x1e6)+_0xb5f7ae[_0x204f20(0x1ac)]);}}async function createDailyDigest(_0x1f35a7,_0x4c8fba){const _0x33d165=a0_0x4545e3;if(!_0x1f35a7[_0x33d165(0x217)])return;if(!canCallApi()){await _0x1f35a7[_0x33d165(0x1f9)](LTM_DP_STATUS,{'val':_0x33d165(0x1cf),'ack':!![]});return;}await _0x1f35a7[_0x33d165(0x1f9)](LTM_DP_STATUS,{'val':_0x33d165(0x206),'ack':!![]});if(!_0x1f35a7[_0x33d165(0x213)]||_0x1f35a7[_0x33d165(0x1b9)][_0x33d165(0x210)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1f35a7[_0x33d165(0x1f9)](LTM_DP_STATUS,{'val':_0x33d165(0x1ee),'ack':!![]});return;}const _0x11b908=JSON[_0x33d165(0x1fc)](JSON['stringify'](_0x1f35a7[_0x33d165(0x1b9)])),_0x20137c=_0x11b908[_0x33d165(0x210)],_0x2a92ea=_0x33d165(0x20d)+JSON['stringify'](_0x11b908);try{updateApiTimestamp();const _0x322357=await _0x1f35a7[_0x33d165(0x213)]['generateContent'](_0x2a92ea),_0x4b5a0a=JSON[_0x33d165(0x1fc)](_0x322357[_0x33d165(0x1c7)][_0x33d165(0x1fa)]()[_0x33d165(0x1e1)](/```json|```/g,'')['trim']()),_0x2e07c1={'timestamp':new Date()['toISOString'](),'eventCount':_0x20137c,'summary':_0x4b5a0a[_0x33d165(0x1c0)]||'Digest','activityLevel':_0x4b5a0a[_0x33d165(0x1aa)]||_0x33d165(0x220),'systemMode':_0x1f35a7[_0x33d165(0x1b3)]};_0x1f35a7['dailyDigests'][_0x33d165(0x1bc)](_0x2e07c1);const _0x5f2c9e=_0x1f35a7[_0x33d165(0x1f8)][_0x33d165(0x1d3)]||0x3c;_0x1f35a7[_0x33d165(0x1c6)][_0x33d165(0x210)]>_0x5f2c9e&&_0x1f35a7[_0x33d165(0x1c6)]['splice'](0x0,_0x1f35a7[_0x33d165(0x1c6)]['length']-_0x5f2c9e);await _0x1f35a7['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x33d165(0x1e2)](_0x1f35a7['dailyDigests']),'ack':!![]}),_0x1f35a7[_0x33d165(0x1b9)]=[],await _0x1f35a7[_0x33d165(0x1f9)](LTM_DP_RAW_LOG,{'val':JSON[_0x33d165(0x1e2)](_0x1f35a7[_0x33d165(0x1b9)]),'ack':!![]}),await _0x1f35a7[_0x33d165(0x1f9)](LTM_DP_STATUS,{'val':_0x33d165(0x201),'ack':!![]});const _0x5c6dd2=_0x33d165(0x1e0)+_0x4b5a0a[_0x33d165(0x1c0)]+_0x33d165(0x20f)+_0x4b5a0a[_0x33d165(0x1aa)];setup[_0x33d165(0x207)](_0x1f35a7,_0x5c6dd2,![],![]);if(_0x1f35a7[_0x33d165(0x217)]&&_0x4c8fba)_0x4c8fba['send'](_0x1f35a7,_0x33d165(0x1dc),{'digest':_0x2e07c1});}catch(_0x33628d){_0x1f35a7[_0x33d165(0x1d5)][_0x33d165(0x1a0)](_0x33628d[_0x33d165(0x1ac)]);}}async function runBaselineDriftAnalysis(_0x3c8e6b){const _0x3d0d7e=a0_0x4545e3;if(!_0x3c8e6b[_0x3d0d7e(0x217)]||!_0x3c8e6b[_0x3d0d7e(0x213)])return;if(!canCallApi())return;const _0x5e2900=_0x3c8e6b[_0x3d0d7e(0x1f8)][_0x3d0d7e(0x1a6)]||0xe;if(_0x3c8e6b['dailyDigests']['length']<_0x5e2900+0x7){await _0x3c8e6b[_0x3d0d7e(0x1f9)]('LTM.driftAnalysis.baselineDrift',{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x1d26ec=_0x3c8e6b[_0x3d0d7e(0x1c6)][_0x3d0d7e(0x1eb)](-_0x5e2900),_0x5388ea=_0x3c8e6b[_0x3d0d7e(0x1c6)][_0x3d0d7e(0x1eb)](0x0,_0x3c8e6b[_0x3d0d7e(0x1c6)][_0x3d0d7e(0x210)]-_0x5e2900),_0x5738e7=_0x3d0d7e(0x1d8)+JSON[_0x3d0d7e(0x1e2)](_0x5388ea)+_0x3d0d7e(0x1d6)+JSON[_0x3d0d7e(0x1e2)](_0x1d26ec);try{updateApiTimestamp();const _0x58355c=await _0x3c8e6b[_0x3d0d7e(0x213)]['generateContent'](_0x5738e7),_0x25bde8=JSON['parse'](_0x58355c[_0x3d0d7e(0x1c7)][_0x3d0d7e(0x1fa)]()[_0x3d0d7e(0x1e1)](/```json|```/g,'')[_0x3d0d7e(0x1a8)]());_0x25bde8[_0x3d0d7e(0x1f2)]&&(await _0x3c8e6b['setStateAsync'](_0x3d0d7e(0x1cd),{'val':_0x25bde8['baselineDrift'],'ack':!![]}),await _0x3c8e6b[_0x3d0d7e(0x1f9)]('LTM.driftAnalysis.driftDetails',{'val':_0x25bde8[_0x3d0d7e(0x1bf)],'ack':!![]}),await _0x3c8e6b[_0x3d0d7e(0x1f9)](_0x3d0d7e(0x204),{'val':Date[_0x3d0d7e(0x1a7)](),'ack':!![]}));}catch(_0x5a0da9){}}function a0_0xc4a6(){const _0x52dc06=['analysis.automation.description','analysisHistory','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','Sicherheit\x20geht\x20vor.','ltmStbWindowDays','now','trim','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','activityLevel','val','message','lastAlertState','useWeather','toString','debug','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','currentSystemMode','toLocaleTimeString','description','KI\x20offline\x20(Fallback)','detected','pop','rawEventLog','.\x20EMERGENCY:\x20','system.presenceWho','push','.Current.IsNight','info','driftDetails','summary','Unbekannt','automationProposal','analysis.automation.patternDetected','\x20=\x20','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','dailyDigests','response','weatherInstance','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','generateContent','getStateAsync','alertReason','LTM.driftAnalysis.baselineDrift','targetId','Skipped\x20(Traffic)','Traffic-Schutz\x20(Auto-Approved)','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','.forecast.current.state','ltmLtbWindowDays','analysis.automation.targetId','log','\x0aSTB:\x20','4tbeiZe','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','üåÖ\x20Morning\x20Briefing:\x0a','ü§ñ\x20Butler\x20Brain\x20Error:\x20','Briefing\x20Error:\x20','ANALYZE_HEALTH','4492188ZsJaBM','1085WImQVU','(((.+)+)+)+$','üìÖ\x20Daily\x20Digest:\x0a','replace','stringify','generic','15013pUfKdg','.\x20EVENTS:\x20','Gemini\x20Error:\x20','apply','livingContext','Tag','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','slice','%)\x20nach\x20\x22','aiPersona','Skipped\x20(No\x20AI\x20or\x20Data)','.forecast.current.temperature','3NUOaMz','5502gbdMek','baselineDrift','.Current.Temperature','analysis.automation.autoApply','getForeignStateAsync','isEmergency','LTM.rawEventLog','config','setStateAsync','text','595835UtcySF','parse','LTM.dailyDigests','decision','8805770IAStmS','8CVIYgq','Success','analysis.alertReason','approved','LTM.driftAnalysis.lastCheck',',\x20Wetter:\x20','Started...','sendNotification','159082KuTiVI','324tqSJee','analysis.analysisHistory','Keine\x20Details.','eventHistory','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','KI-Fehler\x20(Fallback)','\x0aAktivit√§t:\x20','length','analysis.activitySummary','Nacht','geminiModel','\x20√ºbersprungen\x20(Auto-Approved).','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','reason','isProVersion','warn','\x20->\x20','BUTLER\x20Execution\x20Error:\x20','Wetterdaten\x20nicht\x20abrufbar','1590586EeaTTK','analysis.automation.targetValue','search','‚ö†Ô∏è\x20ALARM:\x20','normal','analysis.lastResult','isAlert','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','error','¬∞C,\x20'];a0_0xc4a6=function(){return _0x52dc06;};return a0_0xc4a6();}async function executeAutomationAction(_0x40228f){const _0x3b6431=a0_0x4545e3;try{const _0x2929fd=await _0x40228f['getStateAsync']('analysis.automation.targetId'),_0x18ca34=await _0x40228f[_0x3b6431(0x1cb)](_0x3b6431(0x21d));if(_0x2929fd&&_0x2929fd['val']&&_0x18ca34){const _0x3701a7=_0x2929fd['val'];let _0x7807f4=_0x18ca34[_0x3b6431(0x1ab)];try{_0x7807f4=JSON[_0x3b6431(0x1fc)](_0x7807f4);}catch(_0x4135a8){}_0x40228f[_0x3b6431(0x1d5)][_0x3b6431(0x1be)](_0x3b6431(0x1d1)+_0x3701a7+_0x3b6431(0x1c4)+_0x7807f4),await _0x40228f['setForeignStateAsync'](_0x3701a7,_0x7807f4);}else _0x40228f['log'][_0x3b6431(0x218)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x39497a){_0x40228f['log']['error'](_0x3b6431(0x21a)+_0x39497a[_0x3b6431(0x1ac)]);}}async function sendMorningBriefing(_0x16045a){const _0x37f648=a0_0x4545e3;if(!_0x16045a['geminiModel'])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x3618a3=_0x37f648(0x1a4),_0xb9eb05=await _0x16045a['geminiModel'][_0x37f648(0x1ca)](_0x3618a3),_0x101f59=_0xb9eb05[_0x37f648(0x1c7)][_0x37f648(0x1fa)]();setup[_0x37f648(0x207)](_0x16045a,_0x37f648(0x1d9)+_0x101f59);}catch(_0x1b8bd3){_0x16045a[_0x37f648(0x1d5)][_0x37f648(0x1a0)](_0x37f648(0x1db)+_0x1b8bd3[_0x37f648(0x1ac)]);}}module['exports']={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};