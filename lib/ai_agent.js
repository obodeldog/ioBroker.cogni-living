const a0_0x157302=a0_0x4b7e;(function(_0x19188b,_0x47d805){const _0x484d85=a0_0x4b7e,_0x22ebe1=_0x19188b();while(!![]){try{const _0x4ce54b=-parseInt(_0x484d85(0x18c))/0x1+parseInt(_0x484d85(0x118))/0x2*(parseInt(_0x484d85(0x16d))/0x3)+parseInt(_0x484d85(0x128))/0x4*(-parseInt(_0x484d85(0x113))/0x5)+parseInt(_0x484d85(0x170))/0x6*(-parseInt(_0x484d85(0x154))/0x7)+-parseInt(_0x484d85(0x162))/0x8*(-parseInt(_0x484d85(0x185))/0x9)+parseInt(_0x484d85(0x17f))/0xa*(parseInt(_0x484d85(0x161))/0xb)+parseInt(_0x484d85(0x137))/0xc*(parseInt(_0x484d85(0x187))/0xd);if(_0x4ce54b===_0x47d805)break;else _0x22ebe1['push'](_0x22ebe1['shift']());}catch(_0x361b2c){_0x22ebe1['push'](_0x22ebe1['shift']());}}}(a0_0x3c58,0xd2ea3));const a0_0x3e64b9=(function(){let _0x1cc0f1=!![];return function(_0x2f23d8,_0x2813a5){const _0x2e987d=_0x1cc0f1?function(){if(_0x2813a5){const _0x8b328e=_0x2813a5['apply'](_0x2f23d8,arguments);return _0x2813a5=null,_0x8b328e;}}:function(){};return _0x1cc0f1=![],_0x2e987d;};}()),a0_0x18b317=a0_0x3e64b9(this,function(){const _0x426dbf=a0_0x4b7e;return a0_0x18b317['toString']()[_0x426dbf(0x10d)](_0x426dbf(0x152))[_0x426dbf(0x153)]()[_0x426dbf(0x12c)](a0_0x18b317)['search'](_0x426dbf(0x152));});function a0_0x3c58(){const _0x1fecaa=['map','isProVersion','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','debug','splice','eventHistory','models/gemini-flash-latest','Wetterdaten\x20nicht\x20abrufbar','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','1030JdJPwi','replace','push','Keine\x20Details.','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','now','2898387kLwEJr','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','23160891ETGDbj','timestamp','alertReason','Nacht','isEmergency','1136180kWjFGI','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','text','analysis.automation.targetValue','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','2-digit','LTM.processingStatus','ltmLtbWindowDays','geminiModel','Unbekannt','response','val','LTM.dailyDigests','name','dailyDigests','analysisHistory','\x20Ã¼bersprungen\x20(Auto-Approved).','Gemini\x20Error:\x20','.\x20KONTEXT:\x20','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','.forecast.current.state','.Current.Temperature','.\x20ANWESEND:\x20','.\x20SYSTEM_MODE:\x20','toISOString','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','Traffic-Schutz\x20(Auto-Approved)','\x0a\x20\x20\x20\x20EVENTS:\x0a','KI\x20offline\x20(Fallback)','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','N/A\x20(Learning)','lastAlertState','parse','ðŸ¤–\x20Health\x20Report\x20(','@google/generative-ai','livingContext','search','analysis.isAlert','filter','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','LTM.driftAnalysis.lastCheck','13075fbEtPY','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','approved','summary','Started...','170UAOteU','Briefing\x20Error:\x20','ANALYZE_HEALTH','\x20=\x20','rawEventLog','useWeather','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','.Current.WeatherText','Health\x20Report\x20Error:\x20','Digest','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','LTM.rawEventLog','generateContent','analysis.alertReason','getTime','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','1084CMjYdp','analysis.health.geminiDay','stringify','error','constructor','analysis.automation.description','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','aiPersona','setHours','system.presenceWho','\x0aSTB:\x20','unshift','\x0aAktivitÃ¤t:\x20',')\x20generated.','length','12Qnccdu',').\x20Sending\x20notification...','toLocaleTimeString','.\x20EMERGENCY:\x20','Success','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','analysis.automation.targetId',',\x20LichtverhÃ¤ltnisse:\x20','isAlert','getStateAsync','generic','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','pop','analysis.automation.autoApply','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','\x20->\x20','getForeignStateAsync','ðŸŒ…\x20Morning\x20Briefing:\x0a','KI-Fehler\x20(Fallback)','log','warn','âš ï¸\x20ALARM:\x20','analysis.health.geminiNight','.Current.IsNight','info','ltmStbWindowDays','(((.+)+)+)+$','toString','6706IyukaL','LTM.driftAnalysis.baselineDrift','slice','reason','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','automationProposal','Â°C,\x20','toFixed','.forecast.current.temperature',',\x20Wetter:\x20','LTM.driftAnalysis.driftDetails','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','sendNotification','129866UnFvxL','16bRKXoF','targetId','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','activityLevel','NIGHT','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','config','message','weatherInstance','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','getDate','309BaDtWx','setStateAsync','value','5898HrgYyA','targetValue','currentSystemMode','Tag','analysis.analysisHistory','trim'];a0_0x3c58=function(){return _0x1fecaa;};return a0_0x3c58();}a0_0x18b317();'use strict';const {GoogleGenerativeAI}=require(a0_0x157302(0x10b)),setup=require('./setup'),GEMINI_MODEL=a0_0x157302(0x17c),LTM_DP_DAILY_DIGESTS=a0_0x157302(0xf5),LTM_DP_STATUS=a0_0x157302(0xef),LTM_DP_RAW_LOG=a0_0x157302(0x123),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':a0_0x157302(0xfc),'family':a0_0x157302(0x183),'single_comfort':a0_0x157302(0x106),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x157302(0x114)};function canCallApi(){const _0x520690=Date['now']();return _0x520690-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x546da3=a0_0x157302;lastGlobalApiCall=Date[_0x546da3(0x184)]();}async function getWeatherContext(_0x10afa9){const _0x48faa7=a0_0x157302;if(!_0x10afa9['config'][_0x48faa7(0x11d)]||!_0x10afa9['config'][_0x48faa7(0x16a)])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x315edb=_0x10afa9[_0x48faa7(0x168)][_0x48faa7(0x16a)];let _0x4e4bf8=await _0x10afa9[_0x48faa7(0x148)](_0x315edb+_0x48faa7(0xfe));if(!_0x4e4bf8)_0x4e4bf8=await _0x10afa9[_0x48faa7(0x148)](_0x315edb+_0x48faa7(0x15c));let _0x22e6a2=await _0x10afa9['getForeignStateAsync'](_0x315edb+_0x48faa7(0x11f));if(!_0x22e6a2)_0x22e6a2=await _0x10afa9[_0x48faa7(0x148)](_0x315edb+_0x48faa7(0xfd));let _0x4e465c=_0x48faa7(0xf2);const _0x4da370=await _0x10afa9[_0x48faa7(0x148)](_0x315edb+_0x48faa7(0x14f));if(_0x4da370)_0x4e465c=_0x4da370['val']?_0x48faa7(0x18a):_0x48faa7(0x173);if(_0x4e4bf8&&_0x22e6a2)return _0x4e4bf8[_0x48faa7(0xf4)]+_0x48faa7(0x15a)+_0x22e6a2[_0x48faa7(0xf4)]+_0x48faa7(0x13e)+_0x4e465c;}catch(_0x4e1225){}return _0x48faa7(0x17d);}async function consultButler(_0x4748d1,_0x3b0a36,_0x6d46d5,_0x30306d){const _0xa9dbf5=a0_0x157302;if(!_0x4748d1[_0xa9dbf5(0xf1)])return{'approved':!![],'reason':_0xa9dbf5(0x105)};const _0x397de9=Date[_0xa9dbf5(0x184)]();if(decisionCache[_0x3b0a36]&&_0x397de9-decisionCache[_0x3b0a36][_0xa9dbf5(0x188)]<CACHE_TTL_MS){const _0x415c9c=decisionCache[_0x3b0a36]['decision'];return _0x4748d1['log']['debug'](_0xa9dbf5(0x15f)+_0x3b0a36+_0xa9dbf5(0x147)+(_0x415c9c[_0xa9dbf5(0x115)]?'OK':'NO')+'\x20('+_0x415c9c[_0xa9dbf5(0x157)]+')'),_0x415c9c;}if(!canCallApi())return _0x4748d1[_0xa9dbf5(0x14b)][_0xa9dbf5(0x179)](_0xa9dbf5(0x143)+_0x3b0a36+_0xa9dbf5(0xf9)),{'approved':!![],'reason':_0xa9dbf5(0x103)};const _0x1a21d5=new Date()[_0xa9dbf5(0x139)](),_0x4a3fad=await getWeatherContext(_0x4748d1),_0x25c4e9=PERSONA_MAPPING[_0x4748d1[_0xa9dbf5(0x168)]['aiPersona']||_0xa9dbf5(0x141)],_0x2c0f35=_0xa9dbf5(0x186)+_0x1a21d5+_0xa9dbf5(0x15d)+_0x4a3fad+_0xa9dbf5(0x158)+(_0x30306d*0x64)[_0xa9dbf5(0x15b)](0x0)+'%)\x20nach\x20\x22'+_0x3b0a36+'\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22'+_0x6d46d5+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x25c4e9+_0xa9dbf5(0x102);try{updateApiTimestamp();const _0x511a0f=await _0x4748d1[_0xa9dbf5(0xf1)][_0xa9dbf5(0x124)](_0x2c0f35),_0xd9d3d7=_0x511a0f['response'][_0xa9dbf5(0x18e)]()[_0xa9dbf5(0x180)](/```json|```/g,'')[_0xa9dbf5(0x175)](),_0x1c7b98=JSON[_0xa9dbf5(0x109)](_0xd9d3d7);return decisionCache[_0x3b0a36]={'decision':_0x1c7b98,'timestamp':_0x397de9},_0x1c7b98;}catch(_0x34d817){return _0x4748d1[_0xa9dbf5(0x14b)][_0xa9dbf5(0x14c)](_0xa9dbf5(0xed)+_0x34d817[_0xa9dbf5(0x169)]),decisionCache[_0x3b0a36]={'decision':{'approved':!![],'reason':_0xa9dbf5(0x14a)},'timestamp':_0x397de9-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0xa9dbf5(0x14a)};}}async function runGeminiAnalysis(_0x4c7a27,_0x14c31b=''){const _0x24cf73=a0_0x157302;if(!_0x4c7a27['geminiModel'])return;if(!canCallApi()){_0x4c7a27[_0x24cf73(0x14b)][_0x24cf73(0x179)](_0x24cf73(0x164));return;}if(_0x4c7a27[_0x24cf73(0x17b)][_0x24cf73(0x136)]===0x0)return;const _0x5f3b8d=_0x4c7a27[_0x24cf73(0x17b)][_0x24cf73(0x156)](0x0,0xf),_0x37823c=_0x4c7a27[_0x24cf73(0x172)],_0x3431b0=PERSONA_MAPPING[_0x4c7a27[_0x24cf73(0x168)][_0x24cf73(0x12f)]||_0x24cf73(0x141)],_0x47d327=_0x4c7a27[_0x24cf73(0x168)][_0x24cf73(0x10c)]||_0x24cf73(0x182);let _0x1f2339='Unbekannt';try{const _0x144e2e=await _0x4c7a27[_0x24cf73(0x140)](_0x24cf73(0x131));if(_0x144e2e&&_0x144e2e['val'])_0x1f2339=_0x144e2e[_0x24cf73(0xf4)];}catch(_0x4b799a){}let _0x27658e=![];try{const _0x37c3e5=await _0x4c7a27[_0x24cf73(0x140)](_0x24cf73(0x145));if(_0x37c3e5&&_0x37c3e5[_0x24cf73(0xf4)])_0x27658e=!![];}catch(_0x5b0b16){}const _0x3b0057=_0x24cf73(0x11e)+_0x3431b0+_0x24cf73(0xfb)+_0x47d327+_0x24cf73(0x100)+_0x37823c+_0x24cf73(0xff)+_0x1f2339+'.\x20EVENTS:\x20'+JSON[_0x24cf73(0x12a)](_0x5f3b8d)+_0x24cf73(0x13a)+_0x14c31b+_0x24cf73(0x127);try{updateApiTimestamp();const _0x31c7ff=await _0x4c7a27[_0x24cf73(0xf1)][_0x24cf73(0x124)](_0x3b0057),_0x4b4125=JSON[_0x24cf73(0x109)](_0x31c7ff[_0x24cf73(0xf3)]['text']()[_0x24cf73(0x180)](/```json|```/g,'')['trim']());await _0x4c7a27[_0x24cf73(0x16e)]('analysis.lastResult',{'val':JSON[_0x24cf73(0x12a)](_0x4b4125),'ack':!![]});if(_0x4b4125['summary'])await _0x4c7a27['setStateAsync']('analysis.activitySummary',{'val':_0x4b4125[_0x24cf73(0x116)],'ack':!![]});const _0x165d95={'timestamp':Date[_0x24cf73(0x184)](),'id':Date[_0x24cf73(0x184)]()[_0x24cf73(0x153)](),'analysis':{'activity':{'summary':_0x4b4125[_0x24cf73(0x116)],'isAlert':_0x4b4125['isAlert'],'alertReason':_0x4b4125[_0x24cf73(0x189)]},'comfort':{'automationProposal':_0x4b4125[_0x24cf73(0x159)]}}};_0x4c7a27[_0x24cf73(0xf8)][_0x24cf73(0x133)](_0x165d95);if(_0x4c7a27[_0x24cf73(0xf8)][_0x24cf73(0x136)]>0x32)_0x4c7a27['analysisHistory'][_0x24cf73(0x144)]();await _0x4c7a27[_0x24cf73(0x16e)](_0x24cf73(0x174),{'val':JSON[_0x24cf73(0x12a)](_0x4c7a27[_0x24cf73(0xf8)]),'ack':!![]});const _0x370d6c=_0x4b4125[_0x24cf73(0x13f)]||![];_0x370d6c!==_0x4c7a27[_0x24cf73(0x108)]&&(await _0x4c7a27[_0x24cf73(0x16e)](_0x24cf73(0x10e),{'val':_0x370d6c,'ack':!![]}),_0x4c7a27[_0x24cf73(0x108)]=_0x370d6c,_0x370d6c&&(await _0x4c7a27[_0x24cf73(0x16e)](_0x24cf73(0x125),{'val':_0x4b4125[_0x24cf73(0x189)],'ack':!![]}),setup[_0x24cf73(0x160)](_0x4c7a27,_0x24cf73(0x14d)+_0x4b4125[_0x24cf73(0x189)],![],_0x4b4125[_0x24cf73(0x18b)])));if(_0x4b4125[_0x24cf73(0x159)]&&_0x4b4125[_0x24cf73(0x159)]['detected']){await _0x4c7a27[_0x24cf73(0x16e)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x4c7a27[_0x24cf73(0x16e)](_0x24cf73(0x12d),{'val':_0x4b4125[_0x24cf73(0x159)]['description'],'ack':!![]}),await _0x4c7a27['setStateAsync']('analysis.automation.targetId',{'val':_0x4b4125[_0x24cf73(0x159)][_0x24cf73(0x163)],'ack':!![]}),await _0x4c7a27[_0x24cf73(0x16e)]('analysis.automation.targetValue',{'val':JSON[_0x24cf73(0x12a)](_0x4b4125[_0x24cf73(0x159)][_0x24cf73(0x171)]),'ack':!![]});if(_0x27658e)executeAutomationAction(_0x4c7a27);}}catch(_0x120658){_0x4c7a27[_0x24cf73(0x14b)]['error'](_0x24cf73(0xfa)+_0x120658['message']);}}async function createDailyDigest(_0x39d878,_0x4cd399){const _0x22a5b2=a0_0x157302;if(!_0x39d878['isProVersion'])return;if(!canCallApi()){await _0x39d878[_0x22a5b2(0x16e)](LTM_DP_STATUS,{'val':'Skipped\x20(Traffic)','ack':!![]});return;}await _0x39d878[_0x22a5b2(0x16e)](LTM_DP_STATUS,{'val':_0x22a5b2(0x117),'ack':!![]});if(!_0x39d878[_0x22a5b2(0xf1)]||_0x39d878['rawEventLog']['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x39d878['setStateAsync'](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0xb61c8f=JSON[_0x22a5b2(0x109)](JSON[_0x22a5b2(0x12a)](_0x39d878[_0x22a5b2(0x11c)])),_0x141e60=_0xb61c8f[_0x22a5b2(0x136)],_0x4cce89='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x22a5b2(0x12a)](_0xb61c8f);try{updateApiTimestamp();const _0x14a5bb=await _0x39d878[_0x22a5b2(0xf1)][_0x22a5b2(0x124)](_0x4cce89),_0x298ffa=JSON[_0x22a5b2(0x109)](_0x14a5bb[_0x22a5b2(0xf3)]['text']()['replace'](/```json|```/g,'')[_0x22a5b2(0x175)]()),_0xf7e54e={'timestamp':new Date()[_0x22a5b2(0x101)](),'eventCount':_0x141e60,'summary':_0x298ffa[_0x22a5b2(0x116)]||_0x22a5b2(0x121),'activityLevel':_0x298ffa[_0x22a5b2(0x165)]||'normal','systemMode':_0x39d878[_0x22a5b2(0x172)]};_0x39d878[_0x22a5b2(0xf7)][_0x22a5b2(0x181)](_0xf7e54e);const _0x502e8b=_0x39d878[_0x22a5b2(0x168)][_0x22a5b2(0xf0)]||0x3c;_0x39d878[_0x22a5b2(0xf7)][_0x22a5b2(0x136)]>_0x502e8b&&_0x39d878[_0x22a5b2(0xf7)][_0x22a5b2(0x17a)](0x0,_0x39d878[_0x22a5b2(0xf7)]['length']-_0x502e8b);await _0x39d878[_0x22a5b2(0x16e)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x22a5b2(0x12a)](_0x39d878[_0x22a5b2(0xf7)]),'ack':!![]}),_0x39d878[_0x22a5b2(0x11c)]=[],await _0x39d878[_0x22a5b2(0x16e)](LTM_DP_RAW_LOG,{'val':JSON[_0x22a5b2(0x12a)](_0x39d878[_0x22a5b2(0x11c)]),'ack':!![]}),await _0x39d878[_0x22a5b2(0x16e)](LTM_DP_STATUS,{'val':_0x22a5b2(0x13b),'ack':!![]});const _0xb46166='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x298ffa[_0x22a5b2(0x116)]+_0x22a5b2(0x134)+_0x298ffa[_0x22a5b2(0x165)];setup[_0x22a5b2(0x160)](_0x39d878,_0xb46166,![],![]);if(_0x39d878[_0x22a5b2(0x177)]&&_0x4cd399)_0x4cd399['send'](_0x39d878,_0x22a5b2(0x11a),{'digest':_0xf7e54e});}catch(_0x3a586b){_0x39d878['log']['error'](_0x3a586b[_0x22a5b2(0x169)]);}}async function runBaselineDriftAnalysis(_0x434d0d){const _0x2d8096=a0_0x157302;if(!_0x434d0d['isProVersion']||!_0x434d0d[_0x2d8096(0xf1)])return;if(!canCallApi())return;const _0x12cf15=_0x434d0d[_0x2d8096(0x168)][_0x2d8096(0x151)]||0xe;if(_0x434d0d[_0x2d8096(0xf7)]['length']<_0x12cf15+0x7){await _0x434d0d[_0x2d8096(0x16e)](_0x2d8096(0x155),{'val':_0x2d8096(0x107),'ack':!![]});return;}const _0x50e66e=_0x434d0d[_0x2d8096(0xf7)][_0x2d8096(0x156)](-_0x12cf15),_0x1bb162=_0x434d0d[_0x2d8096(0xf7)][_0x2d8096(0x156)](0x0,_0x434d0d[_0x2d8096(0xf7)][_0x2d8096(0x136)]-_0x12cf15),_0x516b55=_0x2d8096(0x142)+JSON[_0x2d8096(0x12a)](_0x1bb162)+_0x2d8096(0x132)+JSON['stringify'](_0x50e66e);try{updateApiTimestamp();const _0x8b9c4c=await _0x434d0d[_0x2d8096(0xf1)][_0x2d8096(0x124)](_0x516b55),_0x597674=JSON[_0x2d8096(0x109)](_0x8b9c4c[_0x2d8096(0xf3)]['text']()['replace'](/```json|```/g,'')[_0x2d8096(0x175)]());_0x597674['baselineDrift']&&(await _0x434d0d[_0x2d8096(0x16e)](_0x2d8096(0x155),{'val':_0x597674['baselineDrift'],'ack':!![]}),await _0x434d0d[_0x2d8096(0x16e)](_0x2d8096(0x15e),{'val':_0x597674['driftDetails'],'ack':!![]}),await _0x434d0d[_0x2d8096(0x16e)](_0x2d8096(0x112),{'val':Date[_0x2d8096(0x184)](),'ack':!![]}));}catch(_0x50874a){}}async function executeAutomationAction(_0x34405f){const _0x202661=a0_0x157302;try{const _0x2c7f5b=await _0x34405f[_0x202661(0x140)](_0x202661(0x13d)),_0x194cb7=await _0x34405f['getStateAsync'](_0x202661(0xec));if(_0x2c7f5b&&_0x2c7f5b[_0x202661(0xf4)]&&_0x194cb7){const _0x2f36ac=_0x2c7f5b[_0x202661(0xf4)];let _0x577494=_0x194cb7[_0x202661(0xf4)];try{_0x577494=JSON[_0x202661(0x109)](_0x577494);}catch(_0x18fe2a){}_0x34405f[_0x202661(0x14b)]['info'](_0x202661(0x122)+_0x2f36ac+_0x202661(0x11b)+_0x577494),await _0x34405f['setForeignStateAsync'](_0x2f36ac,_0x577494);}else _0x34405f[_0x202661(0x14b)][_0x202661(0x14c)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x367371){_0x34405f['log'][_0x202661(0x12b)]('BUTLER\x20Execution\x20Error:\x20'+_0x367371['message']);}}async function sendMorningBriefing(_0x2dcfdc){const _0x54a7cb=a0_0x157302;if(!_0x2dcfdc[_0x54a7cb(0xf1)]){_0x2dcfdc[_0x54a7cb(0x14b)][_0x54a7cb(0x14c)](_0x54a7cb(0x12e));return;}_0x2dcfdc[_0x54a7cb(0x14b)][_0x54a7cb(0x150)]('ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x275b80=_0x54a7cb(0x178),_0x230f63=await _0x2dcfdc[_0x54a7cb(0xf1)][_0x54a7cb(0x124)](_0x275b80),_0x3a251e=_0x230f63[_0x54a7cb(0xf3)][_0x54a7cb(0x18e)]();_0x2dcfdc[_0x54a7cb(0x14b)][_0x54a7cb(0x150)](_0x54a7cb(0x146)+_0x3a251e['length']+_0x54a7cb(0x138)),setup[_0x54a7cb(0x160)](_0x2dcfdc,_0x54a7cb(0x149)+_0x3a251e);}catch(_0xbc1a62){_0x2dcfdc['log'][_0x54a7cb(0x12b)](_0x54a7cb(0x119)+_0xbc1a62[_0x54a7cb(0x169)]);}}async function generateHealthReport(_0x5a3d75,_0x4d2163){const _0x34e43f=a0_0x157302;if(!_0x5a3d75[_0x34e43f(0xf1)])return;const _0x409908=Date['now']();_0x409908-lastGlobalApiCall<0xbb8&&(_0x5a3d75['log'][_0x34e43f(0x179)](_0x34e43f(0x13c)),await new Promise(_0x444be7=>setTimeout(_0x444be7,0x7d0)));const _0x5b8bfa=new Date();let _0x57edd2=0x0,_0x436a08=_0x5b8bfa[_0x34e43f(0x126)](),_0x4a5ae0='';if(_0x4d2163===_0x34e43f(0x166)){const _0x3e9faa=new Date(_0x5b8bfa);_0x3e9faa['setDate'](_0x3e9faa[_0x34e43f(0x16c)]()-0x1),_0x3e9faa[_0x34e43f(0x130)](0x16,0x0,0x0,0x0),_0x57edd2=_0x3e9faa['getTime']();const _0x3a4ef0=new Date(_0x5b8bfa);_0x3a4ef0[_0x34e43f(0x130)](0x8,0x0,0x0,0x0),_0x436a08=_0x3a4ef0[_0x34e43f(0x126)](),_0x4a5ae0=_0x34e43f(0x17e);}else{const _0x345f44=new Date(_0x5b8bfa);_0x345f44[_0x34e43f(0x130)](0x8,0x0,0x0,0x0),_0x57edd2=_0x345f44[_0x34e43f(0x126)](),_0x4a5ae0=_0x34e43f(0x167);}const _0x357e82=_0x5a3d75[_0x34e43f(0x17b)][_0x34e43f(0x10f)](_0x1b64e8=>_0x1b64e8[_0x34e43f(0x188)]>=_0x57edd2&&_0x1b64e8[_0x34e43f(0x188)]<=_0x436a08);if(_0x357e82[_0x34e43f(0x136)]===0x0){const _0x3651a4=_0x4d2163==='NIGHT'?_0x34e43f(0x111):_0x34e43f(0x18d),_0xef5606=_0x4d2163===_0x34e43f(0x166)?_0x34e43f(0x14e):_0x34e43f(0x129);await _0x5a3d75['setStateAsync'](_0xef5606,{'val':_0x3651a4,'ack':!![]});return;}const _0x2f1dd6=_0x357e82[_0x34e43f(0x176)](_0x2f6177=>new Date(_0x2f6177['timestamp'])[_0x34e43f(0x139)]([],{'hour':_0x34e43f(0xee),'minute':_0x34e43f(0xee)})+'\x20'+_0x2f6177[_0x34e43f(0xf6)]+'\x20('+_0x2f6177[_0x34e43f(0x16f)]+')')['join']('\x0a'),_0x37a90f=_0x34e43f(0x110)+_0x4a5ae0+_0x34e43f(0x104)+_0x2f1dd6+_0x34e43f(0x16b);try{updateApiTimestamp();const _0x56d320=await _0x5a3d75[_0x34e43f(0xf1)][_0x34e43f(0x124)](_0x37a90f),_0x17a65d=_0x56d320['response'][_0x34e43f(0x18e)](),_0x44c5d0=_0x4d2163==='NIGHT'?_0x34e43f(0x14e):_0x34e43f(0x129);await _0x5a3d75[_0x34e43f(0x16e)](_0x44c5d0,{'val':_0x17a65d,'ack':!![]}),_0x5a3d75[_0x34e43f(0x14b)][_0x34e43f(0x150)](_0x34e43f(0x10a)+_0x4d2163+_0x34e43f(0x135));}catch(_0x5e8e2e){_0x5a3d75[_0x34e43f(0x14b)][_0x34e43f(0x12b)](_0x34e43f(0x120)+_0x5e8e2e[_0x34e43f(0x169)]);}}function a0_0x4b7e(_0x35ecad,_0x4e696e){const _0x372e9c=a0_0x3c58();return a0_0x4b7e=function(_0x18b317,_0x3e64b9){_0x18b317=_0x18b317-0xec;let _0x3c587b=_0x372e9c[_0x18b317];return _0x3c587b;},a0_0x4b7e(_0x35ecad,_0x4e696e);}module['exports']={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};