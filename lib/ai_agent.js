const a0_0x225a51=a0_0x37c0;(function(_0x56a88d,_0x29e549){const _0x5d6cb2=a0_0x37c0,_0x24ed28=_0x56a88d();while(!![]){try{const _0x1b5c66=-parseInt(_0x5d6cb2(0x7a))/0x1+-parseInt(_0x5d6cb2(0xeb))/0x2*(-parseInt(_0x5d6cb2(0xde))/0x3)+parseInt(_0x5d6cb2(0xcf))/0x4+parseInt(_0x5d6cb2(0xf3))/0x5+-parseInt(_0x5d6cb2(0xfc))/0x6+parseInt(_0x5d6cb2(0xe5))/0x7*(-parseInt(_0x5d6cb2(0xe2))/0x8)+parseInt(_0x5d6cb2(0xf7))/0x9;if(_0x1b5c66===_0x29e549)break;else _0x24ed28['push'](_0x24ed28['shift']());}catch(_0x3eae12){_0x24ed28['push'](_0x24ed28['shift']());}}}(a0_0x2084,0xc17c7));const a0_0x3ce0f5=(function(){let _0x5a9b5c=!![];return function(_0x24b8fe,_0x433c5c){const _0x5b8268=_0x5a9b5c?function(){const _0x1d9d85=a0_0x37c0;if(_0x433c5c){const _0x4d91c2=_0x433c5c[_0x1d9d85(0xd4)](_0x24b8fe,arguments);return _0x433c5c=null,_0x4d91c2;}}:function(){};return _0x5a9b5c=![],_0x5b8268;};}()),a0_0xd54e24=a0_0x3ce0f5(this,function(){const _0x53e81a=a0_0x37c0;return a0_0xd54e24[_0x53e81a(0xed)]()[_0x53e81a(0xb1)](_0x53e81a(0x95))[_0x53e81a(0xed)]()[_0x53e81a(0x6c)](a0_0xd54e24)['search'](_0x53e81a(0x95));});a0_0xd54e24();'use strict';const {GoogleGenerativeAI}=require(a0_0x225a51(0xcc)),setup=require('./setup'),GEMINI_MODEL=a0_0x225a51(0x71),LTM_DP_DAILY_DIGESTS=a0_0x225a51(0xee),LTM_DP_STATUS=a0_0x225a51(0xf6),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x225a51(0x91),'senior_aal':'PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':a0_0x225a51(0xc6),'single_comfort':a0_0x225a51(0xfb),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x225a51(0xbb)};function a0_0x2084(){const _0x577bbe=['LTM.dailyDigests','length','decision','\x20->\x20','text','356175MBBSGS','filter','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','LTM.processingStatus','14841423ZDRgUV','name','\x0a\x20\x20\x20\x20EVENTS:\x0a','Unbekannt','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','5672154ADeISn','trim','alertReason','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','replace','map','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','constructor','analysis.analysisHistory','LTM.driftAnalysis.lastCheck','LTM.driftAnalysis.baselineDrift','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','models/gemini-flash-latest','üåÖ\x20Briefing\x20generated\x20(Length:\x20','BUTLER\x20Execution\x20Error:\x20','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','driftDetails','analysis.health.geminiDay','.forecast.current.temperature','analysis.lastResult','lastAlertState','278849QyrWEN','analysisHistory','analysis.activitySummary','.forecast.current.state','Tag','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','send','detected','weatherInstance',',\x20Wetter:\x20','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','.\x20ANWESEND:\x20','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','analysis.health.geminiNight','parse',')\x20generated.','getTime','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','message','analysis.automation.targetValue','NIGHT','ltmLtbWindowDays','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','.\x20EVENTS:\x20','generic','analysis.automation.autoApply','(((.+)+)+)+$','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','aiPersona','Skipped\x20(Traffic)','response','targetValue','description','eventHistory','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','LTM.driftAnalysis.driftDetails','\x20=\x20','üåÖ\x20Morning\x20Briefing:\x0a','debug','approved','Keine\x20Details.','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','üìÖ\x20Daily\x20Digest:\x0a','analysis.automation.targetId','sendNotification','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','summary','Nacht','slice','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','Health\x20Report\x20Error:\x20','value','targetId','search','splice','timestamp','stringify','KI\x20offline\x20(Fallback)','Gemini\x20Error:\x20','useWeather','rawEventLog','setHours','setStateAsync','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','getForeignStateAsync','dailyDigests','setDate','.Current.IsNight','isAlert','isProVersion','analysis.isAlert','getStateAsync','N/A\x20(Learning)','\x0aAktivit√§t:\x20','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','Traffic-Schutz\x20(Auto-Approved)','geminiModel','Briefing\x20Error:\x20','isEmergency','log','@google/generative-ai','currentSystemMode','Skipped\x20(No\x20AI\x20or\x20Data)','5012012jWUXCD','toFixed','now','reason','activityLevel','apply','generateContent','info','ltmStbWindowDays','Unbekannt\x20(Kein\x20Sensor)','exports','2-digit','automationProposal','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','error','51qQWSiw','val','warn','.\x20EMERGENCY:\x20','8UDmDfU','ü§ñ\x20Health\x20Report\x20(','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','8080709ZUIYyi','.\x20KONTEXT:\x20','KI-Fehler\x20(Fallback)','config','%)\x20nach\x20\x22','baselineDrift','23274XTpcFz','.Current.Temperature','toString'];a0_0x2084=function(){return _0x577bbe;};return a0_0x2084();}function canCallApi(){const _0x2cef69=a0_0x225a51,_0x32208d=Date[_0x2cef69(0xd1)]();return _0x32208d-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x234ab7=a0_0x225a51;lastGlobalApiCall=Date[_0x234ab7(0xd1)]();}async function getWeatherContext(_0x31f3a5){const _0x1d4004=a0_0x225a51;if(!_0x31f3a5[_0x1d4004(0xe8)][_0x1d4004(0xb7)]||!_0x31f3a5[_0x1d4004(0xe8)]['weatherInstance'])return _0x1d4004(0xd8);try{const _0x3d699b=_0x31f3a5[_0x1d4004(0xe8)][_0x1d4004(0x82)];let _0x2e34d9=await _0x31f3a5[_0x1d4004(0xbc)](_0x3d699b+_0x1d4004(0xec));if(!_0x2e34d9)_0x2e34d9=await _0x31f3a5['getForeignStateAsync'](_0x3d699b+_0x1d4004(0x77));let _0x470eab=await _0x31f3a5[_0x1d4004(0xbc)](_0x3d699b+'.Current.WeatherText');if(!_0x470eab)_0x470eab=await _0x31f3a5['getForeignStateAsync'](_0x3d699b+_0x1d4004(0x7d));let _0xfc9c4c=_0x1d4004(0xfa);const _0x402a3f=await _0x31f3a5['getForeignStateAsync'](_0x3d699b+_0x1d4004(0xbf));if(_0x402a3f)_0xfc9c4c=_0x402a3f[_0x1d4004(0xdf)]?_0x1d4004(0xab):_0x1d4004(0x7e);if(_0x2e34d9&&_0x470eab)return _0x2e34d9[_0x1d4004(0xdf)]+'¬∞C,\x20'+_0x470eab['val']+',\x20Lichtverh√§ltnisse:\x20'+_0xfc9c4c;}catch(_0x1b4e21){}return'Wetterdaten\x20nicht\x20abrufbar';}async function consultButler(_0x1f1ec4,_0x3c4592,_0x9521f6,_0x4e7aaf){const _0x31d7e4=a0_0x225a51;if(!_0x1f1ec4[_0x31d7e4(0xc8)])return{'approved':!![],'reason':_0x31d7e4(0xb5)};const _0x4814d6=Date[_0x31d7e4(0xd1)]();if(decisionCache[_0x3c4592]&&_0x4814d6-decisionCache[_0x3c4592]['timestamp']<CACHE_TTL_MS){const _0x40d6b3=decisionCache[_0x3c4592][_0x31d7e4(0xf0)];return _0x1f1ec4[_0x31d7e4(0xcb)]['debug'](_0x31d7e4(0x84)+_0x3c4592+_0x31d7e4(0xf1)+(_0x40d6b3[_0x31d7e4(0xa3)]?'OK':'NO')+'\x20('+_0x40d6b3[_0x31d7e4(0xd2)]+')'),_0x40d6b3;}if(!canCallApi())return _0x1f1ec4[_0x31d7e4(0xcb)]['debug'](_0x31d7e4(0xad)+_0x3c4592+'\x20√ºbersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x31d7e4(0xc7)};const _0x25f44f=new Date()['toLocaleTimeString'](),_0xf0865c=await getWeatherContext(_0x1f1ec4),_0xd2b4c8=PERSONA_MAPPING[_0x1f1ec4[_0x31d7e4(0xe8)][_0x31d7e4(0x98)]||_0x31d7e4(0x93)],_0x247255=_0x31d7e4(0x6b)+_0x25f44f+_0x31d7e4(0x83)+_0xf0865c+_0x31d7e4(0xa9)+(_0x4e7aaf*0x64)[_0x31d7e4(0xd0)](0x0)+_0x31d7e4(0xe9)+_0x3c4592+_0x31d7e4(0x68)+_0x9521f6+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0xd2b4c8+_0x31d7e4(0xa5);try{updateApiTimestamp();const _0x1ff17f=await _0x1f1ec4[_0x31d7e4(0xc8)][_0x31d7e4(0xd5)](_0x247255),_0x2d1e24=_0x1ff17f[_0x31d7e4(0x9a)][_0x31d7e4(0xf2)]()[_0x31d7e4(0x69)](/```json|```/g,'')[_0x31d7e4(0xfd)](),_0x1925a8=JSON[_0x31d7e4(0x89)](_0x2d1e24);return decisionCache[_0x3c4592]={'decision':_0x1925a8,'timestamp':_0x4814d6},_0x1925a8;}catch(_0xaabeee){return _0x1f1ec4[_0x31d7e4(0xcb)][_0x31d7e4(0xe0)]('ü§ñ\x20Butler\x20Brain\x20Error:\x20'+_0xaabeee[_0x31d7e4(0x8d)]),decisionCache[_0x3c4592]={'decision':{'approved':!![],'reason':_0x31d7e4(0xe7)},'timestamp':_0x4814d6-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x31d7e4(0xe7)};}}function a0_0x37c0(_0x38a7e2,_0x1e5d98){const _0x48bcb4=a0_0x2084();return a0_0x37c0=function(_0xd54e24,_0x3ce0f5){_0xd54e24=_0xd54e24-0x67;let _0x2084f8=_0x48bcb4[_0xd54e24];return _0x2084f8;},a0_0x37c0(_0x38a7e2,_0x1e5d98);}async function runGeminiAnalysis(_0x18665e,_0x2f3d7f=''){const _0x54919a=a0_0x225a51;if(!_0x18665e[_0x54919a(0xc8)])return;if(!canCallApi()){_0x18665e[_0x54919a(0xcb)][_0x54919a(0xa2)](_0x54919a(0x8c));return;}if(_0x18665e[_0x54919a(0x9d)][_0x54919a(0xef)]===0x0)return;const _0x2ca6ea=_0x18665e[_0x54919a(0x9d)]['slice'](0x0,0xf),_0x4b418d=_0x18665e['currentSystemMode'],_0x22fde5=PERSONA_MAPPING[_0x18665e['config'][_0x54919a(0x98)]||'generic'],_0x45fda2=_0x18665e[_0x54919a(0xe8)]['livingContext']||_0x54919a(0xa4);let _0x571e37='Unbekannt';try{const _0x4995a3=await _0x18665e[_0x54919a(0xc3)]('system.presenceWho');if(_0x4995a3&&_0x4995a3[_0x54919a(0xdf)])_0x571e37=_0x4995a3[_0x54919a(0xdf)];}catch(_0x4db536){}let _0x41c41f=![];try{const _0x2cc229=await _0x18665e[_0x54919a(0xc3)](_0x54919a(0x94));if(_0x2cc229&&_0x2cc229[_0x54919a(0xdf)])_0x41c41f=!![];}catch(_0x5d374c){}const _0x195f63='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x22fde5+_0x54919a(0xe6)+_0x45fda2+'.\x20SYSTEM_MODE:\x20'+_0x4b418d+_0x54919a(0x85)+_0x571e37+_0x54919a(0x92)+JSON[_0x54919a(0xb4)](_0x2ca6ea)+_0x54919a(0xe1)+_0x2f3d7f+_0x54919a(0x87);try{updateApiTimestamp();const _0x1912c6=await _0x18665e['geminiModel'][_0x54919a(0xd5)](_0x195f63),_0x67bb04=JSON['parse'](_0x1912c6['response'][_0x54919a(0xf2)]()[_0x54919a(0x69)](/```json|```/g,'')[_0x54919a(0xfd)]());await _0x18665e['setStateAsync'](_0x54919a(0x78),{'val':JSON['stringify'](_0x67bb04),'ack':!![]});if(_0x67bb04[_0x54919a(0xaa)])await _0x18665e[_0x54919a(0xba)](_0x54919a(0x7c),{'val':_0x67bb04['summary'],'ack':!![]});const _0x2ed715={'timestamp':Date[_0x54919a(0xd1)](),'id':Date[_0x54919a(0xd1)]()['toString'](),'analysis':{'activity':{'summary':_0x67bb04[_0x54919a(0xaa)],'isAlert':_0x67bb04[_0x54919a(0xc0)],'alertReason':_0x67bb04['alertReason']},'comfort':{'automationProposal':_0x67bb04[_0x54919a(0xdb)]}}};_0x18665e[_0x54919a(0x7b)]['unshift'](_0x2ed715);if(_0x18665e[_0x54919a(0x7b)][_0x54919a(0xef)]>0x32)_0x18665e[_0x54919a(0x7b)]['pop']();await _0x18665e[_0x54919a(0xba)](_0x54919a(0x6d),{'val':JSON[_0x54919a(0xb4)](_0x18665e['analysisHistory']),'ack':!![]});const _0x5855c9=_0x67bb04[_0x54919a(0xc0)]||![];_0x5855c9!==_0x18665e['lastAlertState']&&(await _0x18665e[_0x54919a(0xba)](_0x54919a(0xc2),{'val':_0x5855c9,'ack':!![]}),_0x18665e[_0x54919a(0x79)]=_0x5855c9,_0x5855c9&&(await _0x18665e['setStateAsync']('analysis.alertReason',{'val':_0x67bb04[_0x54919a(0x67)],'ack':!![]}),setup[_0x54919a(0xa8)](_0x18665e,'‚ö†Ô∏è\x20ALARM:\x20'+_0x67bb04[_0x54919a(0x67)],![],_0x67bb04[_0x54919a(0xca)])));if(_0x67bb04[_0x54919a(0xdb)]&&_0x67bb04[_0x54919a(0xdb)][_0x54919a(0x81)]){await _0x18665e[_0x54919a(0xba)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x18665e[_0x54919a(0xba)]('analysis.automation.description',{'val':_0x67bb04[_0x54919a(0xdb)][_0x54919a(0x9c)],'ack':!![]}),await _0x18665e['setStateAsync']('analysis.automation.targetId',{'val':_0x67bb04[_0x54919a(0xdb)][_0x54919a(0xb0)],'ack':!![]}),await _0x18665e['setStateAsync'](_0x54919a(0x8e),{'val':JSON[_0x54919a(0xb4)](_0x67bb04['automationProposal'][_0x54919a(0x9b)]),'ack':!![]});if(_0x41c41f)executeAutomationAction(_0x18665e);}}catch(_0x100612){_0x18665e[_0x54919a(0xcb)][_0x54919a(0xdd)](_0x54919a(0xb6)+_0x100612[_0x54919a(0x8d)]);}}async function createDailyDigest(_0x41a35c,_0x36212d){const _0x484d4b=a0_0x225a51;if(!_0x41a35c[_0x484d4b(0xc1)])return;if(!canCallApi()){await _0x41a35c[_0x484d4b(0xba)](LTM_DP_STATUS,{'val':_0x484d4b(0x99),'ack':!![]});return;}await _0x41a35c[_0x484d4b(0xba)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x41a35c['geminiModel']||_0x41a35c[_0x484d4b(0xb8)][_0x484d4b(0xef)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x41a35c[_0x484d4b(0xba)](LTM_DP_STATUS,{'val':_0x484d4b(0xce),'ack':!![]});return;}const _0x194b55=JSON[_0x484d4b(0x89)](JSON['stringify'](_0x41a35c[_0x484d4b(0xb8)])),_0x290e78=_0x194b55[_0x484d4b(0xef)],_0x5b456f=_0x484d4b(0x9e)+JSON['stringify'](_0x194b55);try{updateApiTimestamp();const _0x1b2608=await _0x41a35c[_0x484d4b(0xc8)]['generateContent'](_0x5b456f),_0x3e2cfa=JSON[_0x484d4b(0x89)](_0x1b2608[_0x484d4b(0x9a)]['text']()[_0x484d4b(0x69)](/```json|```/g,'')[_0x484d4b(0xfd)]()),_0x69ef58={'timestamp':new Date()['toISOString'](),'eventCount':_0x290e78,'summary':_0x3e2cfa['summary']||'Digest','activityLevel':_0x3e2cfa[_0x484d4b(0xd3)]||'normal','systemMode':_0x41a35c[_0x484d4b(0xcd)]};_0x41a35c[_0x484d4b(0xbd)]['push'](_0x69ef58);const _0x26000d=_0x41a35c['config'][_0x484d4b(0x90)]||0x3c;_0x41a35c[_0x484d4b(0xbd)][_0x484d4b(0xef)]>_0x26000d&&_0x41a35c[_0x484d4b(0xbd)][_0x484d4b(0xb2)](0x0,_0x41a35c[_0x484d4b(0xbd)][_0x484d4b(0xef)]-_0x26000d);await _0x41a35c[_0x484d4b(0xba)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x484d4b(0xb4)](_0x41a35c[_0x484d4b(0xbd)]),'ack':!![]}),_0x41a35c[_0x484d4b(0xb8)]=[],await _0x41a35c[_0x484d4b(0xba)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x41a35c[_0x484d4b(0xb8)]),'ack':!![]}),await _0x41a35c['setStateAsync'](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x42d4c5=_0x484d4b(0xa6)+_0x3e2cfa[_0x484d4b(0xaa)]+_0x484d4b(0xc5)+_0x3e2cfa[_0x484d4b(0xd3)];setup[_0x484d4b(0xa8)](_0x41a35c,_0x42d4c5,![],![]);if(_0x41a35c['isProVersion']&&_0x36212d)_0x36212d[_0x484d4b(0x80)](_0x41a35c,'ANALYZE_HEALTH',{'digest':_0x69ef58});}catch(_0x128f2a){_0x41a35c['log'][_0x484d4b(0xdd)](_0x128f2a[_0x484d4b(0x8d)]);}}async function runBaselineDriftAnalysis(_0x1b1516){const _0x5e71e2=a0_0x225a51;if(!_0x1b1516[_0x5e71e2(0xc1)]||!_0x1b1516[_0x5e71e2(0xc8)])return;if(!canCallApi())return;const _0xc1a357=_0x1b1516[_0x5e71e2(0xe8)][_0x5e71e2(0xd7)]||0xe;if(_0x1b1516[_0x5e71e2(0xbd)]['length']<_0xc1a357+0x7){await _0x1b1516[_0x5e71e2(0xba)](_0x5e71e2(0x6f),{'val':_0x5e71e2(0xc4),'ack':!![]});return;}const _0x28d363=_0x1b1516[_0x5e71e2(0xbd)][_0x5e71e2(0xac)](-_0xc1a357),_0x259a05=_0x1b1516[_0x5e71e2(0xbd)]['slice'](0x0,_0x1b1516[_0x5e71e2(0xbd)]['length']-_0xc1a357),_0x2061fe=_0x5e71e2(0x70)+JSON[_0x5e71e2(0xb4)](_0x259a05)+'\x0aSTB:\x20'+JSON['stringify'](_0x28d363);try{updateApiTimestamp();const _0x14772d=await _0x1b1516[_0x5e71e2(0xc8)][_0x5e71e2(0xd5)](_0x2061fe),_0x48fafa=JSON[_0x5e71e2(0x89)](_0x14772d[_0x5e71e2(0x9a)][_0x5e71e2(0xf2)]()[_0x5e71e2(0x69)](/```json|```/g,'')[_0x5e71e2(0xfd)]());_0x48fafa[_0x5e71e2(0xea)]&&(await _0x1b1516['setStateAsync'](_0x5e71e2(0x6f),{'val':_0x48fafa[_0x5e71e2(0xea)],'ack':!![]}),await _0x1b1516['setStateAsync'](_0x5e71e2(0x9f),{'val':_0x48fafa[_0x5e71e2(0x75)],'ack':!![]}),await _0x1b1516[_0x5e71e2(0xba)](_0x5e71e2(0x6e),{'val':Date[_0x5e71e2(0xd1)](),'ack':!![]}));}catch(_0x26b471){}}async function executeAutomationAction(_0x11d345){const _0x4eab5e=a0_0x225a51;try{const _0x38609f=await _0x11d345[_0x4eab5e(0xc3)](_0x4eab5e(0xa7)),_0x1a3143=await _0x11d345[_0x4eab5e(0xc3)](_0x4eab5e(0x8e));if(_0x38609f&&_0x38609f['val']&&_0x1a3143){const _0x1238e7=_0x38609f[_0x4eab5e(0xdf)];let _0x3b6f45=_0x1a3143[_0x4eab5e(0xdf)];try{_0x3b6f45=JSON['parse'](_0x3b6f45);}catch(_0x10b620){}_0x11d345[_0x4eab5e(0xcb)][_0x4eab5e(0xd6)](_0x4eab5e(0x96)+_0x1238e7+_0x4eab5e(0xa0)+_0x3b6f45),await _0x11d345['setForeignStateAsync'](_0x1238e7,_0x3b6f45);}else _0x11d345[_0x4eab5e(0xcb)]['warn']('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x392cd2){_0x11d345['log'][_0x4eab5e(0xdd)](_0x4eab5e(0x73)+_0x392cd2[_0x4eab5e(0x8d)]);}}async function sendMorningBriefing(_0x380411){const _0x2c30fe=a0_0x225a51;if(!_0x380411[_0x2c30fe(0xc8)]){_0x380411[_0x2c30fe(0xcb)]['warn']('ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x380411[_0x2c30fe(0xcb)]['info'](_0x2c30fe(0x86));try{updateApiTimestamp();const _0x2ac536=_0x2c30fe(0x7f),_0x404dcb=await _0x380411['geminiModel']['generateContent'](_0x2ac536),_0x1bcd0f=_0x404dcb[_0x2c30fe(0x9a)][_0x2c30fe(0xf2)]();_0x380411[_0x2c30fe(0xcb)]['info'](_0x2c30fe(0x72)+_0x1bcd0f[_0x2c30fe(0xef)]+').\x20Sending\x20notification...'),setup[_0x2c30fe(0xa8)](_0x380411,_0x2c30fe(0xa1)+_0x1bcd0f);}catch(_0x5b8ae5){_0x380411[_0x2c30fe(0xcb)][_0x2c30fe(0xdd)](_0x2c30fe(0xc9)+_0x5b8ae5[_0x2c30fe(0x8d)]);}}async function generateHealthReport(_0x1ad1ec,_0x3914f6){const _0x50a8ee=a0_0x225a51;if(!_0x1ad1ec['geminiModel'])return;const _0x399c45=Date[_0x50a8ee(0xd1)]();_0x399c45-lastGlobalApiCall<0xbb8&&(_0x1ad1ec['log'][_0x50a8ee(0xa2)](_0x50a8ee(0x97)),await new Promise(_0x55d0dc=>setTimeout(_0x55d0dc,0x7d0)));const _0x3a0cde=new Date();let _0x1ee1ee=0x0,_0x568b24=_0x3a0cde['getTime'](),_0x2c1de4='';if(_0x3914f6===_0x50a8ee(0x8f)){const _0x5c9391=new Date(_0x3a0cde);_0x5c9391[_0x50a8ee(0xbe)](_0x5c9391['getDate']()-0x1),_0x5c9391[_0x50a8ee(0xb9)](0x16,0x0,0x0,0x0),_0x1ee1ee=_0x5c9391[_0x50a8ee(0x8b)]();const _0x240b7c=new Date(_0x3a0cde);_0x240b7c[_0x50a8ee(0xb9)](0x8,0x0,0x0,0x0),_0x568b24=_0x240b7c['getTime'](),_0x2c1de4=_0x50a8ee(0x74);}else{const _0x5d1e95=new Date(_0x3a0cde);_0x5d1e95[_0x50a8ee(0xb9)](0x8,0x0,0x0,0x0),_0x1ee1ee=_0x5d1e95[_0x50a8ee(0x8b)](),_0x2c1de4=_0x50a8ee(0xf5);}const _0x54f4bb=_0x1ad1ec[_0x50a8ee(0x9d)][_0x50a8ee(0xf4)](_0x575c4b=>_0x575c4b[_0x50a8ee(0xb3)]>=_0x1ee1ee&&_0x575c4b[_0x50a8ee(0xb3)]<=_0x568b24);if(_0x54f4bb['length']===0x0){const _0x34b2e1=_0x3914f6===_0x50a8ee(0x8f)?_0x50a8ee(0xe4):_0x50a8ee(0xdc),_0x2e8069=_0x3914f6===_0x50a8ee(0x8f)?_0x50a8ee(0x88):_0x50a8ee(0x76);await _0x1ad1ec['setStateAsync'](_0x2e8069,{'val':_0x34b2e1,'ack':!![]});return;}const _0x54844a=_0x54f4bb[_0x50a8ee(0x6a)](_0x413c81=>new Date(_0x413c81[_0x50a8ee(0xb3)])['toLocaleTimeString']([],{'hour':_0x50a8ee(0xda),'minute':_0x50a8ee(0xda)})+'\x20'+_0x413c81[_0x50a8ee(0xf8)]+'\x20('+_0x413c81[_0x50a8ee(0xaf)]+')')['join']('\x0a'),_0x5b0e42='\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20'+_0x2c1de4+_0x50a8ee(0xf9)+_0x54844a+'\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x49e898=await _0x1ad1ec[_0x50a8ee(0xc8)][_0x50a8ee(0xd5)](_0x5b0e42),_0x1c84e9=_0x49e898[_0x50a8ee(0x9a)][_0x50a8ee(0xf2)](),_0x3c92b7=_0x3914f6==='NIGHT'?_0x50a8ee(0x88):_0x50a8ee(0x76);await _0x1ad1ec[_0x50a8ee(0xba)](_0x3c92b7,{'val':_0x1c84e9,'ack':!![]}),_0x1ad1ec[_0x50a8ee(0xcb)][_0x50a8ee(0xd6)](_0x50a8ee(0xe3)+_0x3914f6+_0x50a8ee(0x8a));}catch(_0x386a13){_0x1ad1ec['log'][_0x50a8ee(0xdd)](_0x50a8ee(0xae)+_0x386a13[_0x50a8ee(0x8d)]);}}module[a0_0x225a51(0xd9)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};