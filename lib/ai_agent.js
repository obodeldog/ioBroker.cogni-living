const a0_0x3a9448=a0_0x4643;(function(_0x617aae,_0x2ada12){const _0x21e50d=a0_0x4643,_0x169a5c=_0x617aae();while(!![]){try{const _0x2830d8=parseInt(_0x21e50d(0x1d1))/0x1*(parseInt(_0x21e50d(0x1ca))/0x2)+-parseInt(_0x21e50d(0x1b6))/0x3+parseInt(_0x21e50d(0x16b))/0x4+parseInt(_0x21e50d(0x17f))/0x5+-parseInt(_0x21e50d(0x196))/0x6*(parseInt(_0x21e50d(0x1de))/0x7)+parseInt(_0x21e50d(0x1aa))/0x8+-parseInt(_0x21e50d(0x1bc))/0x9*(parseInt(_0x21e50d(0x183))/0xa);if(_0x2830d8===_0x2ada12)break;else _0x169a5c['push'](_0x169a5c['shift']());}catch(_0x40259e){_0x169a5c['push'](_0x169a5c['shift']());}}}(a0_0x561e,0x79a5a));const a0_0x5e7331=(function(){let _0x47b07e=!![];return function(_0x1e6769,_0x359448){const _0x436c7b=_0x47b07e?function(){if(_0x359448){const _0x242507=_0x359448['apply'](_0x1e6769,arguments);return _0x359448=null,_0x242507;}}:function(){};return _0x47b07e=![],_0x436c7b;};}()),a0_0x47e971=a0_0x5e7331(this,function(){const _0x193151=a0_0x4643;return a0_0x47e971['toString']()['search'](_0x193151(0x1c2))[_0x193151(0x181)]()[_0x193151(0x180)](a0_0x47e971)[_0x193151(0x1d5)](_0x193151(0x1c2));});a0_0x47e971();'use strict';const {GoogleGenerativeAI}=require(a0_0x3a9448(0x1db)),setup=require(a0_0x3a9448(0x1be)),GEMINI_MODEL=a0_0x3a9448(0x1ce),LTM_DP_DAILY_DIGESTS=a0_0x3a9448(0x172),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_RAW_LOG=a0_0x3a9448(0x166),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;function a0_0x4643(_0x290955,_0x2e733b){const _0x4912ad=a0_0x561e();return a0_0x4643=function(_0x47e971,_0x5e7331){_0x47e971=_0x47e971-0x166;let _0x561e94=_0x4912ad[_0x47e971];return _0x561e94;},a0_0x4643(_0x290955,_0x2e733b);}const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':a0_0x3a9448(0x1cc),'family':a0_0x3a9448(0x1f2),'single_comfort':a0_0x3a9448(0x19c),'security':a0_0x3a9448(0x1ec),'energy_saver':a0_0x3a9448(0x1cf)};function canCallApi(){const _0x199d99=a0_0x3a9448,_0x454b0f=Date[_0x199d99(0x1b2)]();return _0x454b0f-lastGlobalApiCall>MIN_API_GAP_MS;}function a0_0x561e(){const _0x8a218a=['./setup','currentSystemMode','normal','toLocaleTimeString','(((.+)+)+)+$','Digest','analysis.automation.targetValue','.Current.WeatherText','.forecast.current.state','summary','üìÖ\x20Daily\x20Digest:\x0a','driftDetails','4TxGJLB','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','models/gemini-flash-latest','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','val','370445thIrvj','N/A\x20(Learning)','Success','.\x20SYSTEM_MODE:\x20','search','unshift','Tag','.\x20ANWESEND:\x20','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','warn','@google/generative-ai','.\x20EMERGENCY:\x20','BUTLER\x20Execution\x20Error:\x20','200200nxvBfC','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','KI\x20offline\x20(Fallback)','Briefing\x20Error:\x20','detected','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','toFixed','Wetterdaten\x20nicht\x20abrufbar','ü§ñ\x20Butler\x20Brain\x20Error:\x20','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','Keine\x20Details.','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','lastAlertState','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Sicherheit\x20geht\x20vor.','analysis.analysisHistory','decision','stringify','dailyDigests','baselineDrift','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','timestamp','targetId','LTM.rawEventLog','\x20√ºbersprungen\x20(Auto-Approved).','error','\x0aAktivit√§t:\x20','Gemini\x20Error:\x20','2020752FSxuox','\x20=\x20','analysis.automation.targetId','ANALYZE_HEALTH','replace','Nacht',',\x20Lichtverh√§ltnisse:\x20','LTM.dailyDigests','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','Skipped\x20(Traffic)','activityLevel','push','üåÖ\x20Briefing\x20generated\x20(Length:\x20','parse','KI-Fehler\x20(Fallback)','analysis.automation.autoApply','LTM.driftAnalysis.lastCheck','setStateAsync','splice','LTM.driftAnalysis.driftDetails','4001400zYOFnr','constructor','toString','Traffic-Schutz\x20(Auto-Approved)','10FzaFJJ','analysis.isAlert','config','Unbekannt','ltmLtbWindowDays','automationProposal','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','sendNotification','exports','slice','generateContent','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','pop','\x20->\x20','LTM.driftAnalysis.baselineDrift','Started...','getForeignStateAsync','approved','120JWOWEP','system.presenceWho','weatherInstance','‚ö†Ô∏è\x20ALARM:\x20',').\x20Sending\x20notification...','analysisHistory','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','.Current.IsNight',',\x20Wetter:\x20','¬∞C,\x20','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','getStateAsync','ltmStbWindowDays','targetValue','isProVersion','rawEventLog','trim','\x0aSTB:\x20','message','Skipped\x20(No\x20AI\x20or\x20Data)','3942704Oapdba','.Current.Temperature','info','log','length','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','debug','now','alertReason','generic','aiPersona','2262141AqifvR','analysis.automation.description','geminiModel','text','eventHistory','response','6433947sSkpIl','useWeather'];a0_0x561e=function(){return _0x8a218a;};return a0_0x561e();}function updateApiTimestamp(){const _0x38fd4d=a0_0x3a9448;lastGlobalApiCall=Date[_0x38fd4d(0x1b2)]();}async function getWeatherContext(_0x2e6039){const _0x3adc2c=a0_0x3a9448;if(!_0x2e6039['config'][_0x3adc2c(0x1bd)]||!_0x2e6039[_0x3adc2c(0x185)][_0x3adc2c(0x198)])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x85556d=_0x2e6039[_0x3adc2c(0x185)][_0x3adc2c(0x198)];let _0x542f0d=await _0x2e6039['getForeignStateAsync'](_0x85556d+_0x3adc2c(0x1ab));if(!_0x542f0d)_0x542f0d=await _0x2e6039[_0x3adc2c(0x194)](_0x85556d+'.forecast.current.temperature');let _0x566a7f=await _0x2e6039['getForeignStateAsync'](_0x85556d+_0x3adc2c(0x1c5));if(!_0x566a7f)_0x566a7f=await _0x2e6039[_0x3adc2c(0x194)](_0x85556d+_0x3adc2c(0x1c6));let _0x1849e8=_0x3adc2c(0x186);const _0x53e9c4=await _0x2e6039[_0x3adc2c(0x194)](_0x85556d+_0x3adc2c(0x19d));if(_0x53e9c4)_0x1849e8=_0x53e9c4[_0x3adc2c(0x1d0)]?_0x3adc2c(0x170):_0x3adc2c(0x1d7);if(_0x542f0d&&_0x566a7f)return _0x542f0d[_0x3adc2c(0x1d0)]+_0x3adc2c(0x19f)+_0x566a7f[_0x3adc2c(0x1d0)]+_0x3adc2c(0x171)+_0x1849e8;}catch(_0x1db975){}return _0x3adc2c(0x1e5);}async function consultButler(_0x43bd15,_0xe61a5b,_0x50688a,_0x2688c3){const _0x1ae148=a0_0x3a9448;if(!_0x43bd15[_0x1ae148(0x1b8)])return{'approved':!![],'reason':_0x1ae148(0x1e0)};const _0x51cc81=Date['now']();if(decisionCache[_0xe61a5b]&&_0x51cc81-decisionCache[_0xe61a5b][_0x1ae148(0x1f3)]<CACHE_TTL_MS){const _0x5851d1=decisionCache[_0xe61a5b][_0x1ae148(0x1ee)];return _0x43bd15[_0x1ae148(0x1ad)][_0x1ae148(0x1b1)](_0x1ae148(0x18f)+_0xe61a5b+_0x1ae148(0x191)+(_0x5851d1[_0x1ae148(0x195)]?'OK':'NO')+'\x20('+_0x5851d1['reason']+')'),_0x5851d1;}if(!canCallApi())return _0x43bd15[_0x1ae148(0x1ad)]['debug'](_0x1ae148(0x1cb)+_0xe61a5b+_0x1ae148(0x167)),{'approved':!![],'reason':_0x1ae148(0x182)};const _0x5b2e17=new Date()[_0x1ae148(0x1c1)](),_0x20fd85=await getWeatherContext(_0x43bd15),_0x3ec38f=PERSONA_MAPPING[_0x43bd15[_0x1ae148(0x185)][_0x1ae148(0x1b5)]||_0x1ae148(0x1b4)],_0x25b012=_0x1ae148(0x173)+_0x5b2e17+_0x1ae148(0x19e)+_0x20fd85+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x2688c3*0x64)[_0x1ae148(0x1e4)](0x0)+'%)\x20nach\x20\x22'+_0xe61a5b+_0x1ae148(0x189)+_0x50688a+_0x1ae148(0x1e3)+_0x3ec38f+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x100c54=await _0x43bd15['geminiModel'][_0x1ae148(0x18e)](_0x25b012),_0x492a6d=_0x100c54['response'][_0x1ae148(0x1b9)]()[_0x1ae148(0x16f)](/```json|```/g,'')['trim'](),_0x24d73d=JSON[_0x1ae148(0x178)](_0x492a6d);return decisionCache[_0xe61a5b]={'decision':_0x24d73d,'timestamp':_0x51cc81},_0x24d73d;}catch(_0x4373d0){return _0x43bd15[_0x1ae148(0x1ad)][_0x1ae148(0x1da)](_0x1ae148(0x1e6)+_0x4373d0[_0x1ae148(0x1a8)]),decisionCache[_0xe61a5b]={'decision':{'approved':!![],'reason':_0x1ae148(0x179)},'timestamp':_0x51cc81-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x1ae148(0x179)};}}async function runGeminiAnalysis(_0x3c834f,_0x28fb04=''){const _0x2baaa2=a0_0x3a9448;if(!_0x3c834f[_0x2baaa2(0x1b8)])return;if(!canCallApi()){_0x3c834f['log']['debug'](_0x2baaa2(0x1af));return;}if(_0x3c834f[_0x2baaa2(0x1ba)][_0x2baaa2(0x1ae)]===0x0)return;const _0x17f94a=_0x3c834f[_0x2baaa2(0x1ba)][_0x2baaa2(0x18d)](0x0,0xf),_0x5c681d=_0x3c834f[_0x2baaa2(0x1bf)],_0x38f431=PERSONA_MAPPING[_0x3c834f['config'][_0x2baaa2(0x1b5)]||_0x2baaa2(0x1b4)],_0x566531=_0x3c834f['config']['livingContext']||_0x2baaa2(0x1e8);let _0x4dcb9e='Unbekannt';try{const _0x8dac=await _0x3c834f[_0x2baaa2(0x1a1)](_0x2baaa2(0x197));if(_0x8dac&&_0x8dac[_0x2baaa2(0x1d0)])_0x4dcb9e=_0x8dac[_0x2baaa2(0x1d0)];}catch(_0xddfc48){}let _0x7f12a=![];try{const _0x2121d7=await _0x3c834f[_0x2baaa2(0x1a1)](_0x2baaa2(0x17a));if(_0x2121d7&&_0x2121d7[_0x2baaa2(0x1d0)])_0x7f12a=!![];}catch(_0x4a8cc8){}const _0x2fb663=_0x2baaa2(0x1cd)+_0x38f431+'.\x20KONTEXT:\x20'+_0x566531+_0x2baaa2(0x1d4)+_0x5c681d+_0x2baaa2(0x1d8)+_0x4dcb9e+'.\x20EVENTS:\x20'+JSON[_0x2baaa2(0x1ef)](_0x17f94a)+_0x2baaa2(0x1dc)+_0x28fb04+_0x2baaa2(0x1e9);try{updateApiTimestamp();const _0x39f69f=await _0x3c834f[_0x2baaa2(0x1b8)][_0x2baaa2(0x18e)](_0x2fb663),_0x1a6a47=JSON[_0x2baaa2(0x178)](_0x39f69f[_0x2baaa2(0x1bb)]['text']()[_0x2baaa2(0x16f)](/```json|```/g,'')[_0x2baaa2(0x1a6)]());await _0x3c834f[_0x2baaa2(0x17c)]('analysis.lastResult',{'val':JSON[_0x2baaa2(0x1ef)](_0x1a6a47),'ack':!![]});if(_0x1a6a47[_0x2baaa2(0x1c7)])await _0x3c834f['setStateAsync']('analysis.activitySummary',{'val':_0x1a6a47[_0x2baaa2(0x1c7)],'ack':!![]});const _0x3f15ac={'timestamp':Date['now'](),'id':Date[_0x2baaa2(0x1b2)]()[_0x2baaa2(0x181)](),'analysis':{'activity':{'summary':_0x1a6a47[_0x2baaa2(0x1c7)],'isAlert':_0x1a6a47['isAlert'],'alertReason':_0x1a6a47[_0x2baaa2(0x1b3)]},'comfort':{'automationProposal':_0x1a6a47[_0x2baaa2(0x188)]}}};_0x3c834f['analysisHistory'][_0x2baaa2(0x1d6)](_0x3f15ac);if(_0x3c834f[_0x2baaa2(0x19b)]['length']>0x32)_0x3c834f[_0x2baaa2(0x19b)][_0x2baaa2(0x190)]();await _0x3c834f[_0x2baaa2(0x17c)](_0x2baaa2(0x1ed),{'val':JSON[_0x2baaa2(0x1ef)](_0x3c834f['analysisHistory']),'ack':!![]});const _0x4a5251=_0x1a6a47['isAlert']||![];_0x4a5251!==_0x3c834f[_0x2baaa2(0x1ea)]&&(await _0x3c834f[_0x2baaa2(0x17c)](_0x2baaa2(0x184),{'val':_0x4a5251,'ack':!![]}),_0x3c834f[_0x2baaa2(0x1ea)]=_0x4a5251,_0x4a5251&&(await _0x3c834f['setStateAsync']('analysis.alertReason',{'val':_0x1a6a47[_0x2baaa2(0x1b3)],'ack':!![]}),setup['sendNotification'](_0x3c834f,_0x2baaa2(0x199)+_0x1a6a47[_0x2baaa2(0x1b3)],![],_0x1a6a47['isEmergency'])));if(_0x1a6a47['automationProposal']&&_0x1a6a47['automationProposal'][_0x2baaa2(0x1e2)]){await _0x3c834f[_0x2baaa2(0x17c)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x3c834f[_0x2baaa2(0x17c)](_0x2baaa2(0x1b7),{'val':_0x1a6a47[_0x2baaa2(0x188)]['description'],'ack':!![]}),await _0x3c834f['setStateAsync']('analysis.automation.targetId',{'val':_0x1a6a47['automationProposal'][_0x2baaa2(0x1f4)],'ack':!![]}),await _0x3c834f['setStateAsync'](_0x2baaa2(0x1c4),{'val':JSON[_0x2baaa2(0x1ef)](_0x1a6a47[_0x2baaa2(0x188)][_0x2baaa2(0x1a3)]),'ack':!![]});if(_0x7f12a)executeAutomationAction(_0x3c834f);}}catch(_0x39b701){_0x3c834f[_0x2baaa2(0x1ad)][_0x2baaa2(0x168)](_0x2baaa2(0x16a)+_0x39b701[_0x2baaa2(0x1a8)]);}}async function createDailyDigest(_0x38ba47,_0x85ab09){const _0x84adda=a0_0x3a9448;if(!_0x38ba47['isProVersion'])return;if(!canCallApi()){await _0x38ba47['setStateAsync'](LTM_DP_STATUS,{'val':_0x84adda(0x174),'ack':!![]});return;}await _0x38ba47['setStateAsync'](LTM_DP_STATUS,{'val':_0x84adda(0x193),'ack':!![]});if(!_0x38ba47[_0x84adda(0x1b8)]||_0x38ba47[_0x84adda(0x1a5)][_0x84adda(0x1ae)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x38ba47[_0x84adda(0x17c)](LTM_DP_STATUS,{'val':_0x84adda(0x1a9),'ack':!![]});return;}const _0x3514fe=JSON[_0x84adda(0x178)](JSON[_0x84adda(0x1ef)](_0x38ba47[_0x84adda(0x1a5)])),_0x454d3b=_0x3514fe[_0x84adda(0x1ae)],_0x237f77=_0x84adda(0x1b0)+JSON[_0x84adda(0x1ef)](_0x3514fe);try{updateApiTimestamp();const _0x908fe6=await _0x38ba47[_0x84adda(0x1b8)][_0x84adda(0x18e)](_0x237f77),_0x455511=JSON[_0x84adda(0x178)](_0x908fe6[_0x84adda(0x1bb)][_0x84adda(0x1b9)]()[_0x84adda(0x16f)](/```json|```/g,'')['trim']()),_0x23bb3f={'timestamp':new Date()['toISOString'](),'eventCount':_0x454d3b,'summary':_0x455511[_0x84adda(0x1c7)]||_0x84adda(0x1c3),'activityLevel':_0x455511[_0x84adda(0x175)]||_0x84adda(0x1c0),'systemMode':_0x38ba47[_0x84adda(0x1bf)]};_0x38ba47[_0x84adda(0x1f0)][_0x84adda(0x176)](_0x23bb3f);const _0x2b2a95=_0x38ba47[_0x84adda(0x185)][_0x84adda(0x187)]||0x3c;_0x38ba47[_0x84adda(0x1f0)][_0x84adda(0x1ae)]>_0x2b2a95&&_0x38ba47[_0x84adda(0x1f0)][_0x84adda(0x17d)](0x0,_0x38ba47[_0x84adda(0x1f0)][_0x84adda(0x1ae)]-_0x2b2a95);await _0x38ba47[_0x84adda(0x17c)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x84adda(0x1ef)](_0x38ba47[_0x84adda(0x1f0)]),'ack':!![]}),_0x38ba47[_0x84adda(0x1a5)]=[],await _0x38ba47[_0x84adda(0x17c)](LTM_DP_RAW_LOG,{'val':JSON[_0x84adda(0x1ef)](_0x38ba47[_0x84adda(0x1a5)]),'ack':!![]}),await _0x38ba47[_0x84adda(0x17c)](LTM_DP_STATUS,{'val':_0x84adda(0x1d3),'ack':!![]});const _0x3bde57=_0x84adda(0x1c8)+_0x455511[_0x84adda(0x1c7)]+_0x84adda(0x169)+_0x455511[_0x84adda(0x175)];setup[_0x84adda(0x18b)](_0x38ba47,_0x3bde57,![],![]);if(_0x38ba47[_0x84adda(0x1a4)]&&_0x85ab09)_0x85ab09['send'](_0x38ba47,_0x84adda(0x16e),{'digest':_0x23bb3f});}catch(_0x5e77aa){_0x38ba47[_0x84adda(0x1ad)][_0x84adda(0x168)](_0x5e77aa[_0x84adda(0x1a8)]);}}async function runBaselineDriftAnalysis(_0x313490){const _0xd423fc=a0_0x3a9448;if(!_0x313490[_0xd423fc(0x1a4)]||!_0x313490[_0xd423fc(0x1b8)])return;if(!canCallApi())return;const _0x21b192=_0x313490[_0xd423fc(0x185)][_0xd423fc(0x1a2)]||0xe;if(_0x313490['dailyDigests'][_0xd423fc(0x1ae)]<_0x21b192+0x7){await _0x313490['setStateAsync'](_0xd423fc(0x192),{'val':_0xd423fc(0x1d2),'ack':!![]});return;}const _0x13187d=_0x313490['dailyDigests'][_0xd423fc(0x18d)](-_0x21b192),_0x1e4009=_0x313490[_0xd423fc(0x1f0)][_0xd423fc(0x18d)](0x0,_0x313490[_0xd423fc(0x1f0)][_0xd423fc(0x1ae)]-_0x21b192),_0x13de21=_0xd423fc(0x1eb)+JSON[_0xd423fc(0x1ef)](_0x1e4009)+_0xd423fc(0x1a7)+JSON[_0xd423fc(0x1ef)](_0x13187d);try{updateApiTimestamp();const _0x28dba7=await _0x313490[_0xd423fc(0x1b8)]['generateContent'](_0x13de21),_0x4cfc0c=JSON[_0xd423fc(0x178)](_0x28dba7[_0xd423fc(0x1bb)][_0xd423fc(0x1b9)]()[_0xd423fc(0x16f)](/```json|```/g,'')[_0xd423fc(0x1a6)]());_0x4cfc0c[_0xd423fc(0x1f1)]&&(await _0x313490[_0xd423fc(0x17c)](_0xd423fc(0x192),{'val':_0x4cfc0c[_0xd423fc(0x1f1)],'ack':!![]}),await _0x313490[_0xd423fc(0x17c)](_0xd423fc(0x17e),{'val':_0x4cfc0c[_0xd423fc(0x1c9)],'ack':!![]}),await _0x313490['setStateAsync'](_0xd423fc(0x17b),{'val':Date[_0xd423fc(0x1b2)](),'ack':!![]}));}catch(_0x5d0ae7){}}async function executeAutomationAction(_0x210ddb){const _0x53dc4d=a0_0x3a9448;try{const _0xe49827=await _0x210ddb['getStateAsync'](_0x53dc4d(0x16d)),_0x59bd98=await _0x210ddb['getStateAsync']('analysis.automation.targetValue');if(_0xe49827&&_0xe49827[_0x53dc4d(0x1d0)]&&_0x59bd98){const _0xc4bdd8=_0xe49827[_0x53dc4d(0x1d0)];let _0x25c1c6=_0x59bd98[_0x53dc4d(0x1d0)];try{_0x25c1c6=JSON[_0x53dc4d(0x178)](_0x25c1c6);}catch(_0x2eada8){}_0x210ddb[_0x53dc4d(0x1ad)][_0x53dc4d(0x1ac)](_0x53dc4d(0x1df)+_0xc4bdd8+_0x53dc4d(0x16c)+_0x25c1c6),await _0x210ddb['setForeignStateAsync'](_0xc4bdd8,_0x25c1c6);}else _0x210ddb[_0x53dc4d(0x1ad)][_0x53dc4d(0x1da)](_0x53dc4d(0x1d9));}catch(_0x511316){_0x210ddb[_0x53dc4d(0x1ad)][_0x53dc4d(0x168)](_0x53dc4d(0x1dd)+_0x511316[_0x53dc4d(0x1a8)]);}}async function sendMorningBriefing(_0x23ba7b){const _0x195bea=a0_0x3a9448;if(!_0x23ba7b[_0x195bea(0x1b8)]){_0x23ba7b[_0x195bea(0x1ad)][_0x195bea(0x1da)](_0x195bea(0x18a));return;}_0x23ba7b['log']['info'](_0x195bea(0x1a0));try{updateApiTimestamp();const _0x47aa93=_0x195bea(0x1e7),_0xa96d2b=await _0x23ba7b[_0x195bea(0x1b8)][_0x195bea(0x18e)](_0x47aa93),_0x392ccb=_0xa96d2b['response'][_0x195bea(0x1b9)]();_0x23ba7b[_0x195bea(0x1ad)][_0x195bea(0x1ac)](_0x195bea(0x177)+_0x392ccb['length']+_0x195bea(0x19a)),setup[_0x195bea(0x18b)](_0x23ba7b,'üåÖ\x20Morning\x20Briefing:\x0a'+_0x392ccb);}catch(_0x5ddee2){_0x23ba7b[_0x195bea(0x1ad)][_0x195bea(0x168)](_0x195bea(0x1e1)+_0x5ddee2['message']);}}module[a0_0x3a9448(0x18c)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};