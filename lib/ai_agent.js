const a0_0x29f209=a0_0x5d07;function a0_0x5d07(_0x3eace,_0x8b4de){const _0x2e4644=a0_0x518d();return a0_0x5d07=function(_0x36865a,_0x11e973){_0x36865a=_0x36865a-0x109;let _0x518d87=_0x2e4644[_0x36865a];return _0x518d87;},a0_0x5d07(_0x3eace,_0x8b4de);}(function(_0x194a86,_0x3ea71c){const _0x119073=a0_0x5d07,_0x4ceaba=_0x194a86();while(!![]){try{const _0x204ab6=-parseInt(_0x119073(0x186))/0x1*(parseInt(_0x119073(0x11c))/0x2)+parseInt(_0x119073(0x10d))/0x3*(-parseInt(_0x119073(0x12e))/0x4)+-parseInt(_0x119073(0x16b))/0x5*(parseInt(_0x119073(0x12f))/0x6)+parseInt(_0x119073(0x125))/0x7+-parseInt(_0x119073(0x14e))/0x8+parseInt(_0x119073(0x124))/0x9+parseInt(_0x119073(0x195))/0xa;if(_0x204ab6===_0x3ea71c)break;else _0x4ceaba['push'](_0x4ceaba['shift']());}catch(_0x524dcd){_0x4ceaba['push'](_0x4ceaba['shift']());}}}(a0_0x518d,0x6e0c2));const a0_0x11e973=(function(){let _0x4228d6=!![];return function(_0x21e71d,_0x448922){const _0x235d4d=_0x4228d6?function(){const _0x26ff27=a0_0x5d07;if(_0x448922){const _0x3b7029=_0x448922[_0x26ff27(0x19c)](_0x21e71d,arguments);return _0x448922=null,_0x3b7029;}}:function(){};return _0x4228d6=![],_0x235d4d;};}()),a0_0x36865a=a0_0x11e973(this,function(){const _0x526bf7=a0_0x5d07;return a0_0x36865a[_0x526bf7(0x156)]()[_0x526bf7(0x17e)]('(((.+)+)+)+$')[_0x526bf7(0x156)]()[_0x526bf7(0x180)](a0_0x36865a)[_0x526bf7(0x17e)](_0x526bf7(0x135));});a0_0x36865a();'use strict';const {GoogleGenerativeAI}=require(a0_0x29f209(0x11d)),setup=require(a0_0x29f209(0x185)),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x29f209(0x121),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x29f209(0x127),'senior_aal':a0_0x29f209(0x16a),'family':a0_0x29f209(0x170),'single_comfort':a0_0x29f209(0x158),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x29f209(0x129)};function canCallApi(){const _0x5bd693=a0_0x29f209,_0x5428cc=Date[_0x5bd693(0x191)]();return _0x5428cc-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x2da368=a0_0x29f209;lastGlobalApiCall=Date[_0x2da368(0x191)]();}async function getWeatherContext(_0x57baff){const _0x3eea12=a0_0x29f209;if(!_0x57baff['config'][_0x3eea12(0x155)]||!_0x57baff[_0x3eea12(0x18a)][_0x3eea12(0x190)])return _0x3eea12(0x120);try{const _0x3551ac=_0x57baff['config'][_0x3eea12(0x190)];let _0x46129d=await _0x57baff[_0x3eea12(0x152)](_0x3551ac+_0x3eea12(0x122));if(!_0x46129d)_0x46129d=await _0x57baff[_0x3eea12(0x152)](_0x3551ac+_0x3eea12(0x188));let _0x146554=await _0x57baff[_0x3eea12(0x152)](_0x3551ac+_0x3eea12(0x14d));if(!_0x146554)_0x146554=await _0x57baff[_0x3eea12(0x152)](_0x3551ac+_0x3eea12(0x14b));let _0x4824da=_0x3eea12(0x1a0);const _0x480d49=await _0x57baff[_0x3eea12(0x152)](_0x3551ac+'.Current.IsNight');if(_0x480d49)_0x4824da=_0x480d49[_0x3eea12(0x1a3)]?_0x3eea12(0x14a):_0x3eea12(0x132);if(_0x46129d&&_0x146554)return _0x46129d[_0x3eea12(0x1a3)]+'Â°C,\x20'+_0x146554[_0x3eea12(0x1a3)]+_0x3eea12(0x161)+_0x4824da;}catch(_0x2e89e7){}return _0x3eea12(0x16d);}async function consultButler(_0x235d73,_0x30a335,_0x1da5f0,_0x4a6e55){const _0x41480c=a0_0x29f209;if(!_0x235d73['geminiModel'])return{'approved':!![],'reason':_0x41480c(0x123)};const _0x5c25dd=Date[_0x41480c(0x191)]();if(decisionCache[_0x30a335]&&_0x5c25dd-decisionCache[_0x30a335][_0x41480c(0x126)]<CACHE_TTL_MS){const _0x4f1353=decisionCache[_0x30a335]['decision'];return _0x235d73[_0x41480c(0x131)]['debug'](_0x41480c(0x12d)+_0x30a335+_0x41480c(0x18b)+(_0x4f1353[_0x41480c(0x15e)]?'OK':'NO')+'\x20('+_0x4f1353[_0x41480c(0x165)]+')'),_0x4f1353;}if(!canCallApi())return _0x235d73[_0x41480c(0x131)][_0x41480c(0x17a)](_0x41480c(0x134)+_0x30a335+'\x20Ã¼bersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x41480c(0x164)};const _0x4fa398=new Date()[_0x41480c(0x172)](),_0x4ea040=await getWeatherContext(_0x235d73),_0x400761=PERSONA_MAPPING[_0x235d73[_0x41480c(0x18a)][_0x41480c(0x153)]||_0x41480c(0x1a8)],_0x1dc036=_0x41480c(0x150)+_0x4fa398+',\x20Wetter:\x20'+_0x4ea040+_0x41480c(0x14f)+(_0x4a6e55*0x64)[_0x41480c(0x10e)](0x0)+_0x41480c(0x133)+_0x30a335+_0x41480c(0x136)+_0x1da5f0+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x400761+_0x41480c(0x179);try{updateApiTimestamp();const _0x4b5b13=await _0x235d73[_0x41480c(0x192)][_0x41480c(0x130)](_0x1dc036),_0xc0b1b0=_0x4b5b13[_0x41480c(0x19b)][_0x41480c(0x160)]()['replace'](/```json|```/g,'')[_0x41480c(0x109)](),_0x436ed6=JSON[_0x41480c(0x117)](_0xc0b1b0);return decisionCache[_0x30a335]={'decision':_0x436ed6,'timestamp':_0x5c25dd},_0x436ed6;}catch(_0x4521d6){return _0x235d73[_0x41480c(0x131)][_0x41480c(0x18e)](_0x41480c(0x18f)+_0x4521d6[_0x41480c(0x157)]),decisionCache[_0x30a335]={'decision':{'approved':!![],'reason':_0x41480c(0x1a4)},'timestamp':_0x5c25dd-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x41480c(0x1a4)};}}async function runGeminiAnalysis(_0x3dfccc,_0xa350cf=''){const _0x3b8ce4=a0_0x29f209;if(!_0x3dfccc[_0x3b8ce4(0x192)])return;if(!canCallApi()){_0x3dfccc[_0x3b8ce4(0x131)][_0x3b8ce4(0x17a)](_0x3b8ce4(0x18c));return;}if(_0x3dfccc['eventHistory'][_0x3b8ce4(0x116)]===0x0)return;const _0x3373b3=_0x3dfccc['eventHistory']['slice'](0x0,0xf),_0x1e4fd1=_0x3dfccc[_0x3b8ce4(0x169)],_0x154543=PERSONA_MAPPING[_0x3dfccc[_0x3b8ce4(0x18a)][_0x3b8ce4(0x153)]||_0x3b8ce4(0x1a8)],_0x55a32c=_0x3dfccc[_0x3b8ce4(0x18a)]['livingContext']||'Keine\x20Details.';let _0x267971=_0x3b8ce4(0x1a0);try{const _0x415fca=await _0x3dfccc[_0x3b8ce4(0x189)]('system.presenceWho');if(_0x415fca&&_0x415fca[_0x3b8ce4(0x1a3)])_0x267971=_0x415fca[_0x3b8ce4(0x1a3)];}catch(_0x32e674){}let _0x44b0e3=![];try{const _0x403c50=await _0x3dfccc[_0x3b8ce4(0x189)](_0x3b8ce4(0x177));if(_0x403c50&&_0x403c50[_0x3b8ce4(0x1a3)])_0x44b0e3=!![];}catch(_0x3542b2){}const _0x492272=_0x3b8ce4(0x145)+_0x154543+_0x3b8ce4(0x128)+_0x55a32c+_0x3b8ce4(0x13d)+_0x1e4fd1+'.\x20ANWESEND:\x20'+_0x267971+_0x3b8ce4(0x181)+JSON[_0x3b8ce4(0x178)](_0x3373b3)+_0x3b8ce4(0x13a)+_0xa350cf+_0x3b8ce4(0x148);try{updateApiTimestamp();const _0x5b3a2e=await _0x3dfccc['geminiModel'][_0x3b8ce4(0x130)](_0x492272),_0x5040d4=JSON['parse'](_0x5b3a2e[_0x3b8ce4(0x19b)][_0x3b8ce4(0x160)]()[_0x3b8ce4(0x11e)](/```json|```/g,'')[_0x3b8ce4(0x109)]());await _0x3dfccc[_0x3b8ce4(0x13b)](_0x3b8ce4(0x12c),{'val':JSON['stringify'](_0x5040d4),'ack':!![]});if(_0x5040d4['summary'])await _0x3dfccc[_0x3b8ce4(0x13b)]('analysis.activitySummary',{'val':_0x5040d4['summary'],'ack':!![]});const _0x45c22d={'timestamp':Date['now'](),'id':Date[_0x3b8ce4(0x191)]()[_0x3b8ce4(0x156)](),'analysis':{'activity':{'summary':_0x5040d4[_0x3b8ce4(0x13f)],'isAlert':_0x5040d4[_0x3b8ce4(0x118)],'alertReason':_0x5040d4['alertReason']},'comfort':{'automationProposal':_0x5040d4[_0x3b8ce4(0x140)]}}};_0x3dfccc['analysisHistory']['unshift'](_0x45c22d);if(_0x3dfccc[_0x3b8ce4(0x175)][_0x3b8ce4(0x116)]>0x32)_0x3dfccc[_0x3b8ce4(0x175)][_0x3b8ce4(0x184)]();await _0x3dfccc[_0x3b8ce4(0x13b)]('analysis.analysisHistory',{'val':JSON[_0x3b8ce4(0x178)](_0x3dfccc[_0x3b8ce4(0x175)]),'ack':!![]});const _0xf20f68=_0x5040d4['isAlert']||![];_0xf20f68!==_0x3dfccc[_0x3b8ce4(0x142)]&&(await _0x3dfccc['setStateAsync']('analysis.isAlert',{'val':_0xf20f68,'ack':!![]}),_0x3dfccc['lastAlertState']=_0xf20f68,_0xf20f68&&(await _0x3dfccc[_0x3b8ce4(0x13b)]('analysis.alertReason',{'val':_0x5040d4[_0x3b8ce4(0x16c)],'ack':!![]}),setup[_0x3b8ce4(0x15a)](_0x3dfccc,_0x3b8ce4(0x14c)+_0x5040d4[_0x3b8ce4(0x16c)],![],_0x5040d4['isEmergency'])));if(_0x5040d4[_0x3b8ce4(0x140)]&&_0x5040d4[_0x3b8ce4(0x140)][_0x3b8ce4(0x16e)]){await _0x3dfccc[_0x3b8ce4(0x13b)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x3dfccc[_0x3b8ce4(0x13b)](_0x3b8ce4(0x144),{'val':_0x5040d4[_0x3b8ce4(0x140)][_0x3b8ce4(0x15d)],'ack':!![]}),await _0x3dfccc[_0x3b8ce4(0x13b)](_0x3b8ce4(0x196),{'val':_0x5040d4[_0x3b8ce4(0x140)][_0x3b8ce4(0x154)],'ack':!![]}),await _0x3dfccc[_0x3b8ce4(0x13b)](_0x3b8ce4(0x19e),{'val':JSON[_0x3b8ce4(0x178)](_0x5040d4['automationProposal'][_0x3b8ce4(0x18d)]),'ack':!![]});if(_0x44b0e3)executeAutomationAction(_0x3dfccc);}}catch(_0x1c50dd){_0x3dfccc[_0x3b8ce4(0x131)][_0x3b8ce4(0x141)](_0x3b8ce4(0x138)+_0x1c50dd[_0x3b8ce4(0x157)]);}}async function createDailyDigest(_0xfe264d,_0x4e4eda){const _0x27c35=a0_0x29f209;if(!_0xfe264d[_0x27c35(0x11a)])return;if(!canCallApi()){await _0xfe264d[_0x27c35(0x13b)](LTM_DP_STATUS,{'val':_0x27c35(0x1a2),'ack':!![]});return;}await _0xfe264d['setStateAsync'](LTM_DP_STATUS,{'val':_0x27c35(0x187),'ack':!![]});if(!_0xfe264d[_0x27c35(0x192)]||_0xfe264d[_0x27c35(0x198)][_0x27c35(0x116)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0xfe264d['setStateAsync'](LTM_DP_STATUS,{'val':_0x27c35(0x174),'ack':!![]});return;}const _0x178339=JSON[_0x27c35(0x117)](JSON[_0x27c35(0x178)](_0xfe264d[_0x27c35(0x198)])),_0x18361c=_0x178339['length'],_0x2c351e=_0x27c35(0x15c)+JSON[_0x27c35(0x178)](_0x178339);try{updateApiTimestamp();const _0x30d24d=await _0xfe264d[_0x27c35(0x192)][_0x27c35(0x130)](_0x2c351e),_0x58739e=JSON[_0x27c35(0x117)](_0x30d24d[_0x27c35(0x19b)][_0x27c35(0x160)]()['replace'](/```json|```/g,'')[_0x27c35(0x109)]()),_0x1ec79b={'timestamp':new Date()[_0x27c35(0x199)](),'eventCount':_0x18361c,'summary':_0x58739e[_0x27c35(0x13f)]||_0x27c35(0x143),'activityLevel':_0x58739e[_0x27c35(0x147)]||'normal','systemMode':_0xfe264d[_0x27c35(0x169)]};_0xfe264d[_0x27c35(0x137)][_0x27c35(0x1a7)](_0x1ec79b);const _0x13fa64=_0xfe264d[_0x27c35(0x18a)]['ltmLtbWindowDays']||0x3c;_0xfe264d[_0x27c35(0x137)][_0x27c35(0x116)]>_0x13fa64&&_0xfe264d[_0x27c35(0x137)][_0x27c35(0x112)](0x0,_0xfe264d['dailyDigests'][_0x27c35(0x116)]-_0x13fa64);await _0xfe264d['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0xfe264d[_0x27c35(0x137)]),'ack':!![]}),_0xfe264d[_0x27c35(0x198)]=[],await _0xfe264d[_0x27c35(0x13b)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0xfe264d[_0x27c35(0x198)]),'ack':!![]}),await _0xfe264d[_0x27c35(0x13b)](LTM_DP_STATUS,{'val':_0x27c35(0x17d),'ack':!![]});const _0x3df68e=_0x27c35(0x167)+_0x58739e['summary']+_0x27c35(0x13c)+_0x58739e[_0x27c35(0x147)];setup[_0x27c35(0x15a)](_0xfe264d,_0x3df68e,![],![]);if(_0xfe264d[_0x27c35(0x11a)]&&_0x4e4eda)_0x4e4eda['send'](_0xfe264d,_0x27c35(0x16f),{'digest':_0x1ec79b});}catch(_0x1625c8){_0xfe264d[_0x27c35(0x131)][_0x27c35(0x141)](_0x1625c8[_0x27c35(0x157)]);}}async function runBaselineDriftAnalysis(_0x22248e){const _0x405ec6=a0_0x29f209;if(!_0x22248e[_0x405ec6(0x11a)]||!_0x22248e['geminiModel'])return;if(!canCallApi())return;const _0x2e151a=_0x22248e[_0x405ec6(0x18a)][_0x405ec6(0x19d)]||0xe;if(_0x22248e[_0x405ec6(0x137)][_0x405ec6(0x116)]<_0x2e151a+0x7){await _0x22248e['setStateAsync'](_0x405ec6(0x10f),{'val':_0x405ec6(0x19f),'ack':!![]});return;}const _0x3142a1=_0x22248e[_0x405ec6(0x137)][_0x405ec6(0x10b)](-_0x2e151a),_0x533e11=_0x22248e['dailyDigests']['slice'](0x0,_0x22248e['dailyDigests']['length']-_0x2e151a),_0x1b727b='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x405ec6(0x178)](_0x533e11)+_0x405ec6(0x13e)+JSON[_0x405ec6(0x178)](_0x3142a1);try{updateApiTimestamp();const _0x16b3bf=await _0x22248e[_0x405ec6(0x192)][_0x405ec6(0x130)](_0x1b727b),_0x400c52=JSON[_0x405ec6(0x117)](_0x16b3bf['response'][_0x405ec6(0x160)]()['replace'](/```json|```/g,'')[_0x405ec6(0x109)]());_0x400c52[_0x405ec6(0x119)]&&(await _0x22248e[_0x405ec6(0x13b)](_0x405ec6(0x10f),{'val':_0x400c52[_0x405ec6(0x119)],'ack':!![]}),await _0x22248e[_0x405ec6(0x13b)](_0x405ec6(0x1a6),{'val':_0x400c52[_0x405ec6(0x110)],'ack':!![]}),await _0x22248e['setStateAsync'](_0x405ec6(0x115),{'val':Date[_0x405ec6(0x191)](),'ack':!![]}));}catch(_0x5e82a5){}}async function executeAutomationAction(_0x4917ff){const _0x34e171=a0_0x29f209;try{const _0x3ca8c9=await _0x4917ff[_0x34e171(0x189)](_0x34e171(0x196)),_0x3f0df4=await _0x4917ff[_0x34e171(0x189)](_0x34e171(0x19e));if(_0x3ca8c9&&_0x3ca8c9[_0x34e171(0x1a3)]&&_0x3f0df4){const _0x3ee9bb=_0x3ca8c9[_0x34e171(0x1a3)];let _0x341ab0=_0x3f0df4[_0x34e171(0x1a3)];try{_0x341ab0=JSON[_0x34e171(0x117)](_0x341ab0);}catch(_0x5697c9){}_0x4917ff[_0x34e171(0x131)][_0x34e171(0x139)](_0x34e171(0x182)+_0x3ee9bb+_0x34e171(0x12a)+_0x341ab0),await _0x4917ff[_0x34e171(0x193)](_0x3ee9bb,_0x341ab0);}else _0x4917ff['log'][_0x34e171(0x18e)](_0x34e171(0x162));}catch(_0x52cc3b){_0x4917ff['log'][_0x34e171(0x141)]('BUTLER\x20Execution\x20Error:\x20'+_0x52cc3b[_0x34e171(0x157)]);}}function a0_0x518d(){const _0x1e0316=['ltmStbWindowDays','analysis.automation.targetValue','N/A\x20(Learning)','Unbekannt','getTime','Skipped\x20(Traffic)','val','KI-Fehler\x20(Fallback)','2-digit','LTM.driftAnalysis.driftDetails','push','generic','trim','analysis.health.geminiNight','slice','ðŸ¤–\x20Health\x20Report\x20(','138avpvqd','toFixed','LTM.driftAnalysis.baselineDrift','driftDetails','NIGHT','splice','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','LTM.driftAnalysis.lastCheck','length','parse','isAlert','baselineDrift','isProVersion',')\x20generated.','54jUMMRH','@google/generative-ai','replace',').\x20Sending\x20notification...','Unbekannt\x20(Kein\x20Sensor)','LTM.processingStatus','.Current.Temperature','KI\x20offline\x20(Fallback)','6981426AKuTkm','3087518iwFiOu','timestamp','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','.\x20KONTEXT:\x20','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','\x20=\x20','setDate','analysis.lastResult','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','73936VRdPzl','3982152awHBMq','generateContent','log','Tag','%)\x20nach\x20\x22','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','(((.+)+)+)+$','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','dailyDigests','Gemini\x20Error:\x20','info','.\x20EMERGENCY:\x20','setStateAsync','\x0aAktivitÃ¤t:\x20','.\x20SYSTEM_MODE:\x20','\x0aSTB:\x20','summary','automationProposal','error','lastAlertState','Digest','analysis.automation.description','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','map','activityLevel','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','exports','Nacht','.forecast.current.state','âš ï¸\x20ALARM:\x20','.Current.WeatherText','3895456QfTBVt','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','getForeignStateAsync','aiPersona','targetId','useWeather','toString','message','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','eventHistory','sendNotification','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','description','approved','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','text',',\x20LichtverhÃ¤ltnisse:\x20','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','Traffic-Schutz\x20(Auto-Approved)','reason','Health\x20Report\x20Error:\x20','ðŸ“…\x20Daily\x20Digest:\x0a','getDate','currentSystemMode','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','5YUqhNX','alertReason','Wetterdaten\x20nicht\x20abrufbar','detected','ANALYZE_HEALTH','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','ðŸŒ…\x20Morning\x20Briefing:\x0a','toLocaleTimeString','analysis.health.geminiDay','Skipped\x20(No\x20AI\x20or\x20Data)','analysisHistory','value','analysis.automation.autoApply','stringify','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','debug','name','setHours','Success','search','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','constructor','.\x20EVENTS:\x20','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','\x0a\x20\x20\x20\x20EVENTS:\x0a','pop','./setup','27009QZHRBw','Started...','.forecast.current.temperature','getStateAsync','config','\x20->\x20','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','targetValue','warn','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','weatherInstance','now','geminiModel','setForeignStateAsync','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','19640970yRGpfw','analysis.automation.targetId','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','rawEventLog','toISOString','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','response','apply'];a0_0x518d=function(){return _0x1e0316;};return a0_0x518d();}async function sendMorningBriefing(_0x1f5de2){const _0x2c02e5=a0_0x29f209;if(!_0x1f5de2[_0x2c02e5(0x192)]){_0x1f5de2[_0x2c02e5(0x131)][_0x2c02e5(0x18e)](_0x2c02e5(0x197));return;}_0x1f5de2[_0x2c02e5(0x131)][_0x2c02e5(0x139)](_0x2c02e5(0x114));try{updateApiTimestamp();const _0x51b892=_0x2c02e5(0x194),_0x388e86=await _0x1f5de2[_0x2c02e5(0x192)][_0x2c02e5(0x130)](_0x51b892),_0xc30985=_0x388e86[_0x2c02e5(0x19b)][_0x2c02e5(0x160)]();_0x1f5de2[_0x2c02e5(0x131)]['info'](_0x2c02e5(0x19a)+_0xc30985[_0x2c02e5(0x116)]+_0x2c02e5(0x11f)),setup[_0x2c02e5(0x15a)](_0x1f5de2,_0x2c02e5(0x171)+_0xc30985);}catch(_0x1471b3){_0x1f5de2[_0x2c02e5(0x131)][_0x2c02e5(0x141)]('Briefing\x20Error:\x20'+_0x1471b3[_0x2c02e5(0x157)]);}}async function generateHealthReport(_0x593078,_0x2033d3){const _0x56c412=a0_0x29f209;if(!_0x593078['geminiModel'])return;const _0x2f6a04=Date[_0x56c412(0x191)]();_0x2f6a04-lastGlobalApiCall<0xbb8&&(_0x593078[_0x56c412(0x131)][_0x56c412(0x17a)]('ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...'),await new Promise(_0x298964=>setTimeout(_0x298964,0x7d0)));const _0xb55e0f=new Date();let _0x4bcd7d=0x0,_0x4e0ad9=_0xb55e0f[_0x56c412(0x1a1)](),_0x1aa5c5='';if(_0x2033d3===_0x56c412(0x111)){const _0x59557d=new Date(_0xb55e0f);_0x59557d[_0x56c412(0x12b)](_0x59557d[_0x56c412(0x168)]()-0x1),_0x59557d[_0x56c412(0x17c)](0x16,0x0,0x0,0x0),_0x4bcd7d=_0x59557d[_0x56c412(0x1a1)]();const _0x5c5510=new Date(_0xb55e0f);_0x5c5510[_0x56c412(0x17c)](0x8,0x0,0x0,0x0),_0x4e0ad9=_0x5c5510[_0x56c412(0x1a1)](),_0x1aa5c5=_0x56c412(0x163);}else{const _0x1783b6=new Date(_0xb55e0f);_0x1783b6[_0x56c412(0x17c)](0x8,0x0,0x0,0x0),_0x4bcd7d=_0x1783b6[_0x56c412(0x1a1)](),_0x1aa5c5=_0x56c412(0x17f);}const _0x24f70d=_0x593078[_0x56c412(0x159)]['filter'](_0x26a519=>_0x26a519['timestamp']>=_0x4bcd7d&&_0x26a519['timestamp']<=_0x4e0ad9);if(_0x24f70d['length']===0x0){const _0xdc5a15=_0x2033d3===_0x56c412(0x111)?_0x56c412(0x151):_0x56c412(0x15b),_0x2b3980=_0x2033d3==='NIGHT'?_0x56c412(0x10a):'analysis.health.geminiDay';await _0x593078[_0x56c412(0x13b)](_0x2b3980,{'val':_0xdc5a15,'ack':!![]});return;}const _0x4dbb73=_0x24f70d[_0x56c412(0x146)](_0x36e349=>new Date(_0x36e349['timestamp'])['toLocaleTimeString']([],{'hour':_0x56c412(0x1a5),'minute':_0x56c412(0x1a5)})+'\x20'+_0x36e349[_0x56c412(0x17b)]+'\x20('+_0x36e349[_0x56c412(0x176)]+')')['join']('\x0a'),_0x2fa9d4=_0x56c412(0x15f)+_0x1aa5c5+_0x56c412(0x183)+_0x4dbb73+_0x56c412(0x113);try{updateApiTimestamp();const _0x12931e=await _0x593078[_0x56c412(0x192)][_0x56c412(0x130)](_0x2fa9d4),_0x353d89=_0x12931e[_0x56c412(0x19b)]['text'](),_0x59e75c=_0x2033d3===_0x56c412(0x111)?_0x56c412(0x10a):_0x56c412(0x173);await _0x593078[_0x56c412(0x13b)](_0x59e75c,{'val':_0x353d89,'ack':!![]}),_0x593078['log'][_0x56c412(0x139)](_0x56c412(0x10c)+_0x2033d3+_0x56c412(0x11b));}catch(_0x232445){_0x593078[_0x56c412(0x131)][_0x56c412(0x141)](_0x56c412(0x166)+_0x232445[_0x56c412(0x157)]);}}module[a0_0x29f209(0x149)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};