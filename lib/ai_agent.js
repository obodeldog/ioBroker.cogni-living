const a0_0x51e942=a0_0xbabe;(function(_0xa35400,_0x3c330f){const _0x2b4731=a0_0xbabe,_0x4346d6=_0xa35400();while(!![]){try{const _0x52a1ce=parseInt(_0x2b4731(0x1b8))/0x1*(parseInt(_0x2b4731(0x14f))/0x2)+-parseInt(_0x2b4731(0x124))/0x3*(-parseInt(_0x2b4731(0x13f))/0x4)+parseInt(_0x2b4731(0x139))/0x5*(-parseInt(_0x2b4731(0x1aa))/0x6)+-parseInt(_0x2b4731(0x18b))/0x7*(parseInt(_0x2b4731(0x171))/0x8)+-parseInt(_0x2b4731(0x172))/0x9*(-parseInt(_0x2b4731(0x184))/0xa)+-parseInt(_0x2b4731(0x15e))/0xb+parseInt(_0x2b4731(0x190))/0xc*(parseInt(_0x2b4731(0x1b0))/0xd);if(_0x52a1ce===_0x3c330f)break;else _0x4346d6['push'](_0x4346d6['shift']());}catch(_0x1b27aa){_0x4346d6['push'](_0x4346d6['shift']());}}}(a0_0x3f9f,0x44234));const a0_0x4dfb14=(function(){let _0x4a28b9=!![];return function(_0x5a92df,_0x2d79a0){const _0x56d74e=_0x4a28b9?function(){const _0x56e084=a0_0xbabe;if(_0x2d79a0){const _0x27e9bd=_0x2d79a0[_0x56e084(0x159)](_0x5a92df,arguments);return _0x2d79a0=null,_0x27e9bd;}}:function(){};return _0x4a28b9=![],_0x56d74e;};}()),a0_0x13e8a5=a0_0x4dfb14(this,function(){const _0x14df31=a0_0xbabe;return a0_0x13e8a5[_0x14df31(0x14a)]()[_0x14df31(0x1b5)](_0x14df31(0x176))['toString']()[_0x14df31(0x192)](a0_0x13e8a5)['search'](_0x14df31(0x176));});a0_0x13e8a5();'use strict';const {GoogleGenerativeAI}=require(a0_0x51e942(0x130)),setup=require(a0_0x51e942(0x17f)),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x51e942(0x11e),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':a0_0x51e942(0x149),'family':a0_0x51e942(0x147),'single_comfort':a0_0x51e942(0x183),'security':a0_0x51e942(0x12f),'energy_saver':a0_0x51e942(0x13e)};function canCallApi(){const _0x381aaf=Date['now']();return _0x381aaf-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x1a7629=a0_0x51e942;lastGlobalApiCall=Date[_0x1a7629(0x15d)]();}async function getWeatherContext(_0x454359){const _0x5c8945=a0_0x51e942;if(!_0x454359[_0x5c8945(0x19d)]['useWeather']||!_0x454359['config'][_0x5c8945(0x162)])return _0x5c8945(0x15a);try{const _0x2ad67f=_0x454359[_0x5c8945(0x19d)][_0x5c8945(0x162)];let _0x42dbf0=await _0x454359[_0x5c8945(0x156)](_0x2ad67f+_0x5c8945(0x175));if(!_0x42dbf0)_0x42dbf0=await _0x454359[_0x5c8945(0x156)](_0x2ad67f+_0x5c8945(0x11f));let _0x3ff369=await _0x454359[_0x5c8945(0x156)](_0x2ad67f+_0x5c8945(0x166));if(!_0x3ff369)_0x3ff369=await _0x454359[_0x5c8945(0x156)](_0x2ad67f+_0x5c8945(0x131));let _0x134bfd=_0x5c8945(0x180);const _0x1b46dc=await _0x454359[_0x5c8945(0x156)](_0x2ad67f+_0x5c8945(0x185));if(_0x1b46dc)_0x134bfd=_0x1b46dc[_0x5c8945(0x151)]?'Nacht':'Tag';if(_0x42dbf0&&_0x3ff369)return _0x42dbf0[_0x5c8945(0x151)]+_0x5c8945(0x18a)+_0x3ff369[_0x5c8945(0x151)]+_0x5c8945(0x165)+_0x134bfd;}catch(_0x273ea1){}return _0x5c8945(0x19c);}async function consultButler(_0x3a6291,_0x352ae7,_0x4cfd06,_0x182ab9){const _0xaa0dc4=a0_0x51e942;if(!_0x3a6291['geminiModel'])return{'approved':!![],'reason':'KI\x20offline\x20(Fallback)'};const _0x5c08cc=Date[_0xaa0dc4(0x15d)]();if(decisionCache[_0x352ae7]&&_0x5c08cc-decisionCache[_0x352ae7]['timestamp']<CACHE_TTL_MS){const _0x56d52a=decisionCache[_0x352ae7][_0xaa0dc4(0x120)];return _0x3a6291[_0xaa0dc4(0x188)][_0xaa0dc4(0x14c)](_0xaa0dc4(0x1ae)+_0x352ae7+_0xaa0dc4(0x12c)+(_0x56d52a[_0xaa0dc4(0x1a7)]?'OK':'NO')+'\x20('+_0x56d52a[_0xaa0dc4(0x127)]+')'),_0x56d52a;}if(!canCallApi())return _0x3a6291[_0xaa0dc4(0x188)][_0xaa0dc4(0x14c)](_0xaa0dc4(0x16a)+_0x352ae7+_0xaa0dc4(0x117)),{'approved':!![],'reason':_0xaa0dc4(0x1af)};const _0x5720da=new Date()[_0xaa0dc4(0x1a1)](),_0x3e84f4=await getWeatherContext(_0x3a6291),_0x168a87=PERSONA_MAPPING[_0x3a6291[_0xaa0dc4(0x19d)][_0xaa0dc4(0x12e)]||_0xaa0dc4(0x123)],_0x2bf02a='\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20'+_0x5720da+_0xaa0dc4(0x17a)+_0x3e84f4+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x182ab9*0x64)[_0xaa0dc4(0x13c)](0x0)+_0xaa0dc4(0x13a)+_0x352ae7+_0xaa0dc4(0x18f)+_0x4cfd06+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x168a87+_0xaa0dc4(0x138);try{updateApiTimestamp();const _0x3a0d7b=await _0x3a6291[_0xaa0dc4(0x148)][_0xaa0dc4(0x19a)](_0x2bf02a),_0x1ee0a5=_0x3a0d7b[_0xaa0dc4(0x161)]['text']()['replace'](/```json|```/g,'')[_0xaa0dc4(0x1b4)](),_0x4ed427=JSON[_0xaa0dc4(0x169)](_0x1ee0a5);return decisionCache[_0x352ae7]={'decision':_0x4ed427,'timestamp':_0x5c08cc},_0x4ed427;}catch(_0x378b64){return _0x3a6291[_0xaa0dc4(0x188)]['warn'](_0xaa0dc4(0x145)+_0x378b64['message']),decisionCache[_0x352ae7]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x5c08cc-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0xaa0dc4(0x158)};}}async function runGeminiAnalysis(_0x333c12,_0x55e98b=''){const _0x326cc8=a0_0x51e942;if(!_0x333c12['geminiModel'])return;if(!canCallApi()){_0x333c12['log'][_0x326cc8(0x14c)](_0x326cc8(0x186));return;}if(_0x333c12['eventHistory'][_0x326cc8(0x19e)]===0x0)return;const _0x4fbd96=_0x333c12[_0x326cc8(0x12d)]['slice'](0x0,0xf),_0x454915=_0x333c12['currentSystemMode'],_0x4e1c00=PERSONA_MAPPING[_0x333c12[_0x326cc8(0x19d)][_0x326cc8(0x12e)]||_0x326cc8(0x123)],_0x3897d2=_0x333c12[_0x326cc8(0x19d)][_0x326cc8(0x11a)]||_0x326cc8(0x136);let _0x5642a1=_0x326cc8(0x180);try{const _0x5a0a2a=await _0x333c12[_0x326cc8(0x198)](_0x326cc8(0x160));if(_0x5a0a2a&&_0x5a0a2a[_0x326cc8(0x151)])_0x5642a1=_0x5a0a2a['val'];}catch(_0x442ff8){}let _0x2946bb=![];try{const _0x1b7664=await _0x333c12['getStateAsync'](_0x326cc8(0x1b6));if(_0x1b7664&&_0x1b7664['val'])_0x2946bb=!![];}catch(_0x2c4e16){}const _0x92032=_0x326cc8(0x157)+_0x4e1c00+_0x326cc8(0x1ac)+_0x3897d2+_0x326cc8(0x181)+_0x454915+_0x326cc8(0x12b)+_0x5642a1+_0x326cc8(0x177)+JSON[_0x326cc8(0x19f)](_0x4fbd96)+_0x326cc8(0x15f)+_0x55e98b+_0x326cc8(0x134);try{updateApiTimestamp();const _0x3718c6=await _0x333c12[_0x326cc8(0x148)]['generateContent'](_0x92032),_0x1e943f=JSON[_0x326cc8(0x169)](_0x3718c6[_0x326cc8(0x161)]['text']()['replace'](/```json|```/g,'')[_0x326cc8(0x1b4)]());await _0x333c12['setStateAsync'](_0x326cc8(0x16e),{'val':JSON[_0x326cc8(0x19f)](_0x1e943f),'ack':!![]});if(_0x1e943f['summary'])await _0x333c12[_0x326cc8(0x1a3)](_0x326cc8(0x168),{'val':_0x1e943f[_0x326cc8(0x1a6)],'ack':!![]});const _0x35d817={'timestamp':Date['now'](),'id':Date['now']()[_0x326cc8(0x14a)](),'analysis':{'activity':{'summary':_0x1e943f[_0x326cc8(0x1a6)],'isAlert':_0x1e943f[_0x326cc8(0x1a9)],'alertReason':_0x1e943f['alertReason']},'comfort':{'automationProposal':_0x1e943f['automationProposal']}}};_0x333c12[_0x326cc8(0x189)]['unshift'](_0x35d817);if(_0x333c12[_0x326cc8(0x189)][_0x326cc8(0x19e)]>0x32)_0x333c12['analysisHistory'][_0x326cc8(0x154)]();await _0x333c12[_0x326cc8(0x1a3)]('analysis.analysisHistory',{'val':JSON[_0x326cc8(0x19f)](_0x333c12['analysisHistory']),'ack':!![]});const _0x3cbf10=_0x1e943f[_0x326cc8(0x1a9)]||![];_0x3cbf10!==_0x333c12['lastAlertState']&&(await _0x333c12['setStateAsync'](_0x326cc8(0x17c),{'val':_0x3cbf10,'ack':!![]}),_0x333c12[_0x326cc8(0x16f)]=_0x3cbf10,_0x3cbf10&&(await _0x333c12['setStateAsync'](_0x326cc8(0x13d),{'val':_0x1e943f[_0x326cc8(0x18e)],'ack':!![]}),setup[_0x326cc8(0x1a0)](_0x333c12,_0x326cc8(0x155)+_0x1e943f[_0x326cc8(0x18e)],![],_0x1e943f[_0x326cc8(0x125)])));if(_0x1e943f['automationProposal']&&_0x1e943f[_0x326cc8(0x143)][_0x326cc8(0x1a5)]){await _0x333c12[_0x326cc8(0x1a3)](_0x326cc8(0x14b),{'val':!![],'ack':!![]}),await _0x333c12[_0x326cc8(0x1a3)]('analysis.automation.description',{'val':_0x1e943f[_0x326cc8(0x143)][_0x326cc8(0x133)],'ack':!![]}),await _0x333c12[_0x326cc8(0x1a3)](_0x326cc8(0x142),{'val':_0x1e943f[_0x326cc8(0x143)][_0x326cc8(0x144)],'ack':!![]}),await _0x333c12['setStateAsync']('analysis.automation.targetValue',{'val':JSON[_0x326cc8(0x19f)](_0x1e943f[_0x326cc8(0x143)]['targetValue']),'ack':!![]});if(_0x2946bb)executeAutomationAction(_0x333c12);}}catch(_0x382f77){_0x333c12['log'][_0x326cc8(0x16c)]('Gemini\x20Error:\x20'+_0x382f77['message']);}}function a0_0x3f9f(){const _0x15ae16=['slice','val','ðŸ¤–\x20Health\x20Report\x20(','analysis.health.geminiDay','pop','âš ï¸\x20ALARM:\x20','getForeignStateAsync','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','KI-Fehler\x20(Fallback)','apply','Unbekannt\x20(Kein\x20Sensor)','\x0a\x20\x20\x20\x20EVENTS:\x0a','warn','now','5910223yzMCZI','.\x20EMERGENCY:\x20','system.presenceWho','response','weatherInstance','analysis.health.geminiNight','send',',\x20LichtverhÃ¤ltnisse:\x20','.Current.WeatherText','getDate','analysis.activitySummary','parse','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','info','error','ltmStbWindowDays','analysis.lastResult','lastAlertState','NIGHT','1776536UeoGkj','795537BLwLxw','\x20=\x20','name','.Current.Temperature','(((.+)+)+)+$','.\x20EVENTS:\x20',').\x20Sending\x20notification...','setForeignStateAsync',',\x20Wetter:\x20','Skipped\x20(Traffic)','analysis.isAlert','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','filter','./setup','Unbekannt','.\x20SYSTEM_MODE:\x20','map','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','60DqIWOE','.Current.IsNight','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','isProVersion','log','analysisHistory','Â°C,\x20','7wqPGPg','Skipped\x20(No\x20AI\x20or\x20Data)','Started...','alertReason','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','12SpIWab','setHours','constructor','ltmLtbWindowDays','text','dailyDigests','message','\x0aAktivitÃ¤t:\x20','getStateAsync','rawEventLog','generateContent','activityLevel','Wetterdaten\x20nicht\x20abrufbar','config','length','stringify','sendNotification','toLocaleTimeString','Briefing\x20Error:\x20','setStateAsync','splice','detected','summary','approved','ðŸ“…\x20Daily\x20Digest:\x0a','isAlert','30gQEBkv','2-digit','.\x20KONTEXT:\x20','LTM.driftAnalysis.baselineDrift','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','Traffic-Schutz\x20(Auto-Approved)','4290520QLVdeh','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','driftDetails','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','trim','search','analysis.automation.autoApply','ANALYZE_HEALTH','77339bsNITZ','\x20Ã¼bersprungen\x20(Auto-Approved).','N/A\x20(Learning)','LTM.driftAnalysis.lastCheck','livingContext','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','exports','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','LTM.dailyDigests','.forecast.current.temperature','decision','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','normal','generic','3cBAJap','isEmergency','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','reason','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','value','timestamp','.\x20ANWESEND:\x20','\x20->\x20','eventHistory','aiPersona','Sicherheit\x20geht\x20vor.','@google/generative-ai','.forecast.current.state','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','description','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','Keine\x20Details.','getTime','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','433945adMEYN','%)\x20nach\x20\x22','join','toFixed','analysis.alertReason','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','901216BLIjbM','replace','baselineDrift','analysis.automation.targetId','automationProposal','targetId','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','geminiModel','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','toString','analysis.automation.patternDetected','debug','setDate',')\x20generated.','10efMNxq'];a0_0x3f9f=function(){return _0x15ae16;};return a0_0x3f9f();}async function createDailyDigest(_0x3e7fff,_0x413edc){const _0x5bff79=a0_0x51e942;if(!_0x3e7fff['isProVersion'])return;if(!canCallApi()){await _0x3e7fff['setStateAsync'](LTM_DP_STATUS,{'val':_0x5bff79(0x17b),'ack':!![]});return;}await _0x3e7fff[_0x5bff79(0x1a3)](LTM_DP_STATUS,{'val':_0x5bff79(0x18d),'ack':!![]});if(!_0x3e7fff[_0x5bff79(0x148)]||_0x3e7fff['rawEventLog'][_0x5bff79(0x19e)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3e7fff['setStateAsync'](LTM_DP_STATUS,{'val':_0x5bff79(0x18c),'ack':!![]});return;}const _0x4e84c2=JSON[_0x5bff79(0x169)](JSON[_0x5bff79(0x19f)](_0x3e7fff[_0x5bff79(0x199)])),_0x4b1aaa=_0x4e84c2[_0x5bff79(0x19e)],_0x3240c1=_0x5bff79(0x128)+JSON[_0x5bff79(0x19f)](_0x4e84c2);try{updateApiTimestamp();const _0x179aa2=await _0x3e7fff['geminiModel'][_0x5bff79(0x19a)](_0x3240c1),_0x454658=JSON[_0x5bff79(0x169)](_0x179aa2['response'][_0x5bff79(0x194)]()[_0x5bff79(0x140)](/```json|```/g,'')[_0x5bff79(0x1b4)]()),_0x2d422a={'timestamp':new Date()['toISOString'](),'eventCount':_0x4b1aaa,'summary':_0x454658['summary']||'Digest','activityLevel':_0x454658[_0x5bff79(0x19b)]||_0x5bff79(0x122),'systemMode':_0x3e7fff['currentSystemMode']};_0x3e7fff[_0x5bff79(0x195)]['push'](_0x2d422a);const _0x2b0a7b=_0x3e7fff['config'][_0x5bff79(0x193)]||0x3c;_0x3e7fff[_0x5bff79(0x195)][_0x5bff79(0x19e)]>_0x2b0a7b&&_0x3e7fff[_0x5bff79(0x195)][_0x5bff79(0x1a4)](0x0,_0x3e7fff[_0x5bff79(0x195)]['length']-_0x2b0a7b);await _0x3e7fff[_0x5bff79(0x1a3)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x3e7fff[_0x5bff79(0x195)]),'ack':!![]}),_0x3e7fff['rawEventLog']=[],await _0x3e7fff[_0x5bff79(0x1a3)](LTM_DP_RAW_LOG,{'val':JSON[_0x5bff79(0x19f)](_0x3e7fff[_0x5bff79(0x199)]),'ack':!![]}),await _0x3e7fff[_0x5bff79(0x1a3)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x201bdb=_0x5bff79(0x1a8)+_0x454658[_0x5bff79(0x1a6)]+_0x5bff79(0x197)+_0x454658[_0x5bff79(0x19b)];setup[_0x5bff79(0x1a0)](_0x3e7fff,_0x201bdb,![],![]);if(_0x3e7fff['isProVersion']&&_0x413edc)_0x413edc[_0x5bff79(0x164)](_0x3e7fff,_0x5bff79(0x1b7),{'digest':_0x2d422a});}catch(_0x10594c){_0x3e7fff[_0x5bff79(0x188)]['error'](_0x10594c[_0x5bff79(0x196)]);}}async function runBaselineDriftAnalysis(_0x5def9e){const _0x214fb3=a0_0x51e942;if(!_0x5def9e[_0x214fb3(0x187)]||!_0x5def9e[_0x214fb3(0x148)])return;if(!canCallApi())return;const _0x17ad3b=_0x5def9e[_0x214fb3(0x19d)][_0x214fb3(0x16d)]||0xe;if(_0x5def9e[_0x214fb3(0x195)]['length']<_0x17ad3b+0x7){await _0x5def9e['setStateAsync']('LTM.driftAnalysis.baselineDrift',{'val':_0x214fb3(0x118),'ack':!![]});return;}const _0x95bcf8=_0x5def9e[_0x214fb3(0x195)][_0x214fb3(0x150)](-_0x17ad3b),_0x53c997=_0x5def9e[_0x214fb3(0x195)][_0x214fb3(0x150)](0x0,_0x5def9e[_0x214fb3(0x195)][_0x214fb3(0x19e)]-_0x17ad3b),_0x3a10f5=_0x214fb3(0x17d)+JSON['stringify'](_0x53c997)+'\x0aSTB:\x20'+JSON[_0x214fb3(0x19f)](_0x95bcf8);try{updateApiTimestamp();const _0x3b0f22=await _0x5def9e[_0x214fb3(0x148)]['generateContent'](_0x3a10f5),_0x17f476=JSON[_0x214fb3(0x169)](_0x3b0f22['response'][_0x214fb3(0x194)]()[_0x214fb3(0x140)](/```json|```/g,'')[_0x214fb3(0x1b4)]());_0x17f476[_0x214fb3(0x141)]&&(await _0x5def9e['setStateAsync'](_0x214fb3(0x1ad),{'val':_0x17f476['baselineDrift'],'ack':!![]}),await _0x5def9e[_0x214fb3(0x1a3)]('LTM.driftAnalysis.driftDetails',{'val':_0x17f476[_0x214fb3(0x1b2)],'ack':!![]}),await _0x5def9e[_0x214fb3(0x1a3)](_0x214fb3(0x119),{'val':Date[_0x214fb3(0x15d)](),'ack':!![]}));}catch(_0x1f9d2f){}}async function executeAutomationAction(_0x163bd7){const _0x10febd=a0_0x51e942;try{const _0x4b38df=await _0x163bd7[_0x10febd(0x198)](_0x10febd(0x142)),_0xb3e78b=await _0x163bd7[_0x10febd(0x198)]('analysis.automation.targetValue');if(_0x4b38df&&_0x4b38df[_0x10febd(0x151)]&&_0xb3e78b){const _0x31a663=_0x4b38df[_0x10febd(0x151)];let _0x5a1048=_0xb3e78b[_0x10febd(0x151)];try{_0x5a1048=JSON[_0x10febd(0x169)](_0x5a1048);}catch(_0x5d54ee){}_0x163bd7['log'][_0x10febd(0x16b)](_0x10febd(0x11b)+_0x31a663+_0x10febd(0x173)+_0x5a1048),await _0x163bd7[_0x10febd(0x179)](_0x31a663,_0x5a1048);}else _0x163bd7[_0x10febd(0x188)][_0x10febd(0x15c)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0xb51062){_0x163bd7[_0x10febd(0x188)][_0x10febd(0x16c)]('BUTLER\x20Execution\x20Error:\x20'+_0xb51062['message']);}}async function sendMorningBriefing(_0x452375){const _0x1d7bd9=a0_0x51e942;if(!_0x452375['geminiModel']){_0x452375[_0x1d7bd9(0x188)]['warn'](_0x1d7bd9(0x135));return;}_0x452375[_0x1d7bd9(0x188)][_0x1d7bd9(0x16b)](_0x1d7bd9(0x132));try{updateApiTimestamp();const _0x3325a9='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x18bab0=await _0x452375[_0x1d7bd9(0x148)][_0x1d7bd9(0x19a)](_0x3325a9),_0x1dc7d7=_0x18bab0[_0x1d7bd9(0x161)][_0x1d7bd9(0x194)]();_0x452375[_0x1d7bd9(0x188)][_0x1d7bd9(0x16b)](_0x1d7bd9(0x1b1)+_0x1dc7d7[_0x1d7bd9(0x19e)]+_0x1d7bd9(0x178)),setup[_0x1d7bd9(0x1a0)](_0x452375,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0x1dc7d7);}catch(_0x56682b){_0x452375[_0x1d7bd9(0x188)][_0x1d7bd9(0x16c)](_0x1d7bd9(0x1a2)+_0x56682b[_0x1d7bd9(0x196)]);}}async function generateHealthReport(_0xcc1b41,_0x109060){const _0x39fa8b=a0_0x51e942;if(!_0xcc1b41[_0x39fa8b(0x148)])return;const _0x1966f9=Date[_0x39fa8b(0x15d)]();_0x1966f9-lastGlobalApiCall<0xbb8&&(_0xcc1b41[_0x39fa8b(0x188)][_0x39fa8b(0x14c)]('ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...'),await new Promise(_0x441a6a=>setTimeout(_0x441a6a,0x7d0)));const _0x15a4cd=new Date();let _0x359725=0x0,_0x1d7b2b=_0x15a4cd['getTime'](),_0x49eaad='';if(_0x109060===_0x39fa8b(0x170)){const _0x32bcc2=new Date(_0x15a4cd);_0x32bcc2[_0x39fa8b(0x14d)](_0x32bcc2[_0x39fa8b(0x167)]()-0x1),_0x32bcc2[_0x39fa8b(0x191)](0x16,0x0,0x0,0x0),_0x359725=_0x32bcc2[_0x39fa8b(0x137)]();const _0x58d169=new Date(_0x15a4cd);_0x58d169[_0x39fa8b(0x191)](0x8,0x0,0x0,0x0),_0x1d7b2b=_0x58d169[_0x39fa8b(0x137)](),_0x49eaad=_0x39fa8b(0x121);}else{const _0xd023b0=new Date(_0x15a4cd);_0xd023b0[_0x39fa8b(0x191)](0x8,0x0,0x0,0x0),_0x359725=_0xd023b0[_0x39fa8b(0x137)](),_0x49eaad=_0x39fa8b(0x1b3);}const _0x5bf95f=_0xcc1b41[_0x39fa8b(0x12d)][_0x39fa8b(0x17e)](_0x3dbd71=>_0x3dbd71[_0x39fa8b(0x12a)]>=_0x359725&&_0x3dbd71['timestamp']<=_0x1d7b2b);if(_0x5bf95f['length']===0x0){const _0x25736c=_0x109060===_0x39fa8b(0x170)?_0x39fa8b(0x126):_0x39fa8b(0x11d),_0x2f37bb=_0x109060===_0x39fa8b(0x170)?'analysis.health.geminiNight':_0x39fa8b(0x153);await _0xcc1b41[_0x39fa8b(0x1a3)](_0x2f37bb,{'val':_0x25736c,'ack':!![]});return;}const _0xd3cdb=_0x5bf95f[_0x39fa8b(0x182)](_0x20b42d=>new Date(_0x20b42d[_0x39fa8b(0x12a)])[_0x39fa8b(0x1a1)]([],{'hour':_0x39fa8b(0x1ab),'minute':_0x39fa8b(0x1ab)})+'\x20'+_0x20b42d[_0x39fa8b(0x174)]+'\x20('+_0x20b42d[_0x39fa8b(0x129)]+')')[_0x39fa8b(0x13b)]('\x0a'),_0x553d88='\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20'+_0x49eaad+_0x39fa8b(0x15b)+_0xd3cdb+_0x39fa8b(0x146);try{updateApiTimestamp();const _0x479329=await _0xcc1b41[_0x39fa8b(0x148)]['generateContent'](_0x553d88),_0x52b1f3=_0x479329['response'][_0x39fa8b(0x194)](),_0x2efb9f=_0x109060===_0x39fa8b(0x170)?_0x39fa8b(0x163):_0x39fa8b(0x153);await _0xcc1b41[_0x39fa8b(0x1a3)](_0x2efb9f,{'val':_0x52b1f3,'ack':!![]}),_0xcc1b41['log'][_0x39fa8b(0x16b)](_0x39fa8b(0x152)+_0x109060+_0x39fa8b(0x14e));}catch(_0x5c3022){_0xcc1b41[_0x39fa8b(0x188)][_0x39fa8b(0x16c)]('Health\x20Report\x20Error:\x20'+_0x5c3022[_0x39fa8b(0x196)]);}}function a0_0xbabe(_0x12f9c1,_0x31cc7b){const _0x38196f=a0_0x3f9f();return a0_0xbabe=function(_0x13e8a5,_0x4dfb14){_0x13e8a5=_0x13e8a5-0x117;let _0x3f9fa9=_0x38196f[_0x13e8a5];return _0x3f9fa9;},a0_0xbabe(_0x12f9c1,_0x31cc7b);}module[a0_0x51e942(0x11c)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};