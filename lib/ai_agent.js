const a0_0x5c01dc=a0_0x1833;(function(_0x37896b,_0x148fc4){const _0x4e086d=a0_0x1833,_0x18536b=_0x37896b();while(!![]){try{const _0x5ec049=-parseInt(_0x4e086d(0x1c9))/0x1*(-parseInt(_0x4e086d(0x155))/0x2)+parseInt(_0x4e086d(0x1c4))/0x3*(-parseInt(_0x4e086d(0x165))/0x4)+-parseInt(_0x4e086d(0x1b6))/0x5+-parseInt(_0x4e086d(0x185))/0x6*(parseInt(_0x4e086d(0x1c5))/0x7)+parseInt(_0x4e086d(0x157))/0x8*(parseInt(_0x4e086d(0x192))/0x9)+-parseInt(_0x4e086d(0x1be))/0xa*(parseInt(_0x4e086d(0x1d6))/0xb)+parseInt(_0x4e086d(0x1ca))/0xc;if(_0x5ec049===_0x148fc4)break;else _0x18536b['push'](_0x18536b['shift']());}catch(_0x595b01){_0x18536b['push'](_0x18536b['shift']());}}}(a0_0x470b,0x8f4a7));const a0_0x1f9f8c=(function(){let _0x567193=!![];return function(_0x3b85c1,_0x3b9b28){const _0xc73684=_0x567193?function(){const _0x31d8df=a0_0x1833;if(_0x3b9b28){const _0x3ffb44=_0x3b9b28[_0x31d8df(0x18f)](_0x3b85c1,arguments);return _0x3b9b28=null,_0x3ffb44;}}:function(){};return _0x567193=![],_0xc73684;};}()),a0_0x2d7708=a0_0x1f9f8c(this,function(){const _0x33eaea=a0_0x1833;return a0_0x2d7708[_0x33eaea(0x1bb)]()[_0x33eaea(0x19a)](_0x33eaea(0x191))[_0x33eaea(0x1bb)]()[_0x33eaea(0x1c7)](a0_0x2d7708)[_0x33eaea(0x19a)](_0x33eaea(0x191));});a0_0x2d7708();'use strict';const {GoogleGenerativeAI}=require(a0_0x5c01dc(0x18c)),setup=require(a0_0x5c01dc(0x152)),GEMINI_MODEL=a0_0x5c01dc(0x1b2),LTM_DP_DAILY_DIGESTS=a0_0x5c01dc(0x181),LTM_DP_STATUS=a0_0x5c01dc(0x1c8),LTM_DP_RAW_LOG=a0_0x5c01dc(0x173),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;function a0_0x1833(_0x562db1,_0xb0a225){const _0x427baa=a0_0x470b();return a0_0x1833=function(_0x2d7708,_0x1f9f8c){_0x2d7708=_0x2d7708-0x152;let _0x470bcc=_0x427baa[_0x2d7708];return _0x470bcc;},a0_0x1833(_0x562db1,_0xb0a225);}let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':'PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':'Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','single_comfort':a0_0x5c01dc(0x175),'security':a0_0x5c01dc(0x1d7),'energy_saver':a0_0x5c01dc(0x1b3)};function canCallApi(){const _0x416662=a0_0x5c01dc,_0x4ed2a8=Date[_0x416662(0x1a0)]();return _0x4ed2a8-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){lastGlobalApiCall=Date['now']();}async function getWeatherContext(_0x378f7e){const _0x588b21=a0_0x5c01dc;if(!_0x378f7e[_0x588b21(0x15c)][_0x588b21(0x16c)]||!_0x378f7e[_0x588b21(0x15c)]['weatherInstance'])return _0x588b21(0x17a);try{const _0x5b12e7=_0x378f7e['config']['weatherInstance'];let _0x2cf8d6=await _0x378f7e['getForeignStateAsync'](_0x5b12e7+_0x588b21(0x1d1));if(!_0x2cf8d6)_0x2cf8d6=await _0x378f7e[_0x588b21(0x187)](_0x5b12e7+_0x588b21(0x17e));let _0x5a6dc2=await _0x378f7e[_0x588b21(0x187)](_0x5b12e7+_0x588b21(0x1ac));if(!_0x5a6dc2)_0x5a6dc2=await _0x378f7e[_0x588b21(0x187)](_0x5b12e7+_0x588b21(0x1d3));let _0x56a000=_0x588b21(0x162);const _0x1d367a=await _0x378f7e[_0x588b21(0x187)](_0x5b12e7+_0x588b21(0x184));if(_0x1d367a)_0x56a000=_0x1d367a['val']?_0x588b21(0x17f):'Tag';if(_0x2cf8d6&&_0x5a6dc2)return _0x2cf8d6[_0x588b21(0x1cb)]+'Â°C,\x20'+_0x5a6dc2[_0x588b21(0x1cb)]+',\x20LichtverhÃ¤ltnisse:\x20'+_0x56a000;}catch(_0x5e87f2){}return'Wetterdaten\x20nicht\x20abrufbar';}async function consultButler(_0x29293d,_0x2fd7d1,_0x53b5f0,_0x2996de){const _0x27643f=a0_0x5c01dc;if(!_0x29293d[_0x27643f(0x1a3)])return{'approved':!![],'reason':_0x27643f(0x1d2)};const _0x252b10=Date[_0x27643f(0x1a0)]();if(decisionCache[_0x2fd7d1]&&_0x252b10-decisionCache[_0x2fd7d1]['timestamp']<CACHE_TTL_MS){const _0x58750b=decisionCache[_0x2fd7d1][_0x27643f(0x1c3)];return _0x29293d[_0x27643f(0x1ab)][_0x27643f(0x1c2)]('ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20'+_0x2fd7d1+_0x27643f(0x154)+(_0x58750b['approved']?'OK':'NO')+'\x20('+_0x58750b[_0x27643f(0x183)]+')'),_0x58750b;}if(!canCallApi())return _0x29293d[_0x27643f(0x1ab)][_0x27643f(0x1c2)](_0x27643f(0x161)+_0x2fd7d1+_0x27643f(0x1a6)),{'approved':!![],'reason':_0x27643f(0x1aa)};const _0x3f160b=new Date()[_0x27643f(0x1a9)](),_0xb8f6d7=await getWeatherContext(_0x29293d),_0x13edaf=PERSONA_MAPPING[_0x29293d[_0x27643f(0x15c)][_0x27643f(0x1b7)]||'generic'],_0x57449a=_0x27643f(0x169)+_0x3f160b+_0x27643f(0x16b)+_0xb8f6d7+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x2996de*0x64)[_0x27643f(0x172)](0x0)+_0x27643f(0x193)+_0x2fd7d1+_0x27643f(0x15b)+_0x53b5f0+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x13edaf+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0xe31e81=await _0x29293d[_0x27643f(0x1a3)][_0x27643f(0x16f)](_0x57449a),_0x3fc612=_0xe31e81['response'][_0x27643f(0x176)]()['replace'](/```json|```/g,'')['trim'](),_0x12ac7d=JSON[_0x27643f(0x1ce)](_0x3fc612);return decisionCache[_0x2fd7d1]={'decision':_0x12ac7d,'timestamp':_0x252b10},_0x12ac7d;}catch(_0x1e2dd8){return _0x29293d['log'][_0x27643f(0x153)](_0x27643f(0x18e)+_0x1e2dd8[_0x27643f(0x178)]),decisionCache[_0x2fd7d1]={'decision':{'approved':!![],'reason':_0x27643f(0x1bf)},'timestamp':_0x252b10-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x27643f(0x1bf)};}}async function runGeminiAnalysis(_0x738718,_0x3411df=''){const _0x1f7dd5=a0_0x5c01dc;if(!_0x738718['geminiModel'])return;if(!canCallApi()){_0x738718[_0x1f7dd5(0x1ab)]['debug'](_0x1f7dd5(0x17d));return;}if(_0x738718['eventHistory'][_0x1f7dd5(0x1cd)]===0x0)return;const _0x16df53=_0x738718['eventHistory'][_0x1f7dd5(0x189)](0x0,0xf),_0x51a321=_0x738718[_0x1f7dd5(0x174)],_0x15efa3=PERSONA_MAPPING[_0x738718[_0x1f7dd5(0x15c)][_0x1f7dd5(0x1b7)]||'generic'],_0x45c914=_0x738718[_0x1f7dd5(0x15c)][_0x1f7dd5(0x1a1)]||'Keine\x20Details.';let _0x111835=_0x1f7dd5(0x162);try{const _0x329ad5=await _0x738718['getStateAsync'](_0x1f7dd5(0x170));if(_0x329ad5&&_0x329ad5[_0x1f7dd5(0x1cb)])_0x111835=_0x329ad5[_0x1f7dd5(0x1cb)];}catch(_0x14c4b6){}let _0x3c42e6=![];try{const _0x446dce=await _0x738718[_0x1f7dd5(0x1c6)](_0x1f7dd5(0x1d0));if(_0x446dce&&_0x446dce[_0x1f7dd5(0x1cb)])_0x3c42e6=!![];}catch(_0x3606f5){}const _0x281837=_0x1f7dd5(0x19d)+_0x15efa3+_0x1f7dd5(0x1b5)+_0x45c914+_0x1f7dd5(0x158)+_0x51a321+_0x1f7dd5(0x156)+_0x111835+_0x1f7dd5(0x18b)+JSON[_0x1f7dd5(0x166)](_0x16df53)+_0x1f7dd5(0x160)+_0x3411df+_0x1f7dd5(0x1b1);try{updateApiTimestamp();const _0x4bf9f4=await _0x738718[_0x1f7dd5(0x1a3)][_0x1f7dd5(0x16f)](_0x281837),_0x1a12f8=JSON[_0x1f7dd5(0x1ce)](_0x4bf9f4[_0x1f7dd5(0x16e)][_0x1f7dd5(0x176)]()[_0x1f7dd5(0x177)](/```json|```/g,'')[_0x1f7dd5(0x1bc)]());await _0x738718[_0x1f7dd5(0x1a5)]('analysis.lastResult',{'val':JSON['stringify'](_0x1a12f8),'ack':!![]});if(_0x1a12f8[_0x1f7dd5(0x1d4)])await _0x738718[_0x1f7dd5(0x1a5)]('analysis.activitySummary',{'val':_0x1a12f8['summary'],'ack':!![]});const _0x1cada0={'timestamp':Date[_0x1f7dd5(0x1a0)](),'id':Date[_0x1f7dd5(0x1a0)]()[_0x1f7dd5(0x1bb)](),'analysis':{'activity':{'summary':_0x1a12f8[_0x1f7dd5(0x1d4)],'isAlert':_0x1a12f8[_0x1f7dd5(0x1ba)],'alertReason':_0x1a12f8[_0x1f7dd5(0x16a)]},'comfort':{'automationProposal':_0x1a12f8[_0x1f7dd5(0x1b9)]}}};_0x738718[_0x1f7dd5(0x1af)]['unshift'](_0x1cada0);if(_0x738718[_0x1f7dd5(0x1af)]['length']>0x32)_0x738718[_0x1f7dd5(0x1af)][_0x1f7dd5(0x182)]();await _0x738718[_0x1f7dd5(0x1a5)](_0x1f7dd5(0x163),{'val':JSON[_0x1f7dd5(0x166)](_0x738718[_0x1f7dd5(0x1af)]),'ack':!![]});const _0x3c6b64=_0x1a12f8[_0x1f7dd5(0x1ba)]||![];_0x3c6b64!==_0x738718[_0x1f7dd5(0x16d)]&&(await _0x738718[_0x1f7dd5(0x1a5)](_0x1f7dd5(0x1a4),{'val':_0x3c6b64,'ack':!![]}),_0x738718['lastAlertState']=_0x3c6b64,_0x3c6b64&&(await _0x738718[_0x1f7dd5(0x1a5)](_0x1f7dd5(0x164),{'val':_0x1a12f8[_0x1f7dd5(0x16a)],'ack':!![]}),setup[_0x1f7dd5(0x1a2)](_0x738718,_0x1f7dd5(0x1d5)+_0x1a12f8['alertReason'],![],_0x1a12f8['isEmergency'])));if(_0x1a12f8[_0x1f7dd5(0x1b9)]&&_0x1a12f8[_0x1f7dd5(0x1b9)][_0x1f7dd5(0x1b4)]){await _0x738718[_0x1f7dd5(0x1a5)](_0x1f7dd5(0x1cc),{'val':!![],'ack':!![]}),await _0x738718[_0x1f7dd5(0x1a5)](_0x1f7dd5(0x1c0),{'val':_0x1a12f8[_0x1f7dd5(0x1b9)][_0x1f7dd5(0x1ae)],'ack':!![]}),await _0x738718[_0x1f7dd5(0x1a5)](_0x1f7dd5(0x198),{'val':_0x1a12f8[_0x1f7dd5(0x1b9)][_0x1f7dd5(0x17c)],'ack':!![]}),await _0x738718['setStateAsync'](_0x1f7dd5(0x159),{'val':JSON['stringify'](_0x1a12f8['automationProposal'][_0x1f7dd5(0x194)]),'ack':!![]});if(_0x3c42e6)executeAutomationAction(_0x738718);}}catch(_0x359d41){_0x738718[_0x1f7dd5(0x1ab)][_0x1f7dd5(0x171)](_0x1f7dd5(0x1cf)+_0x359d41[_0x1f7dd5(0x178)]);}}function a0_0x470b(){const _0x5c0c94=['normal','debug','decision','741tqzzgK','21dgBpDd','getStateAsync','constructor','LTM.processingStatus','46226XbFKso','4760664VTehjz','val','analysis.automation.patternDetected','length','parse','Gemini\x20Error:\x20','analysis.automation.autoApply','.Current.Temperature','KI\x20offline\x20(Fallback)','.forecast.current.state','summary','âš ï¸\x20ALARM:\x20','3150367NMMDvZ','Sicherheit\x20geht\x20vor.','./setup','warn','\x20->\x20','28spOocG','.\x20ANWESEND:\x20','1576daWsFQ','.\x20SYSTEM_MODE:\x20','analysis.automation.targetValue','Skipped\x20(No\x20AI\x20or\x20Data)','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','config','Success','rawEventLog','ðŸŒ…\x20Morning\x20Briefing:\x0a','.\x20EMERGENCY:\x20','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','Unbekannt','analysis.analysisHistory','analysis.alertReason','10172USqyYC','stringify','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','splice','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','alertReason',',\x20Wetter:\x20','useWeather','lastAlertState','response','generateContent','system.presenceWho','error','toFixed','LTM.rawEventLog','currentSystemMode','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','text','replace','message','activityLevel','Unbekannt\x20(Kein\x20Sensor)','info','targetId','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','.forecast.current.temperature','Nacht','exports','LTM.dailyDigests','pop','reason','.Current.IsNight','411054kBGndE','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','getForeignStateAsync','\x20=\x20','slice','dailyDigests','.\x20EVENTS:\x20','@google/generative-ai','Briefing\x20Error:\x20','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','apply','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','(((.+)+)+)+$','51318QYTuMr','%)\x20nach\x20\x22','targetValue','LTM.driftAnalysis.lastCheck','toISOString','Started...','analysis.automation.targetId','\x0aSTB:\x20','search','Digest','baselineDrift','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','Skipped\x20(Traffic)','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','now','livingContext','sendNotification','geminiModel','analysis.isAlert','setStateAsync','\x20Ã¼bersprungen\x20(Auto-Approved).','LTM.driftAnalysis.baselineDrift','isProVersion','toLocaleTimeString','Traffic-Schutz\x20(Auto-Approved)','log','.Current.WeatherText','driftDetails','description','analysisHistory','send','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','models/gemini-flash-latest','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','detected','.\x20KONTEXT:\x20','2301080sgybCn','aiPersona','BUTLER\x20Execution\x20Error:\x20','automationProposal','isAlert','toString','trim','N/A\x20(Learning)','10oYqSnh','KI-Fehler\x20(Fallback)','analysis.automation.description'];a0_0x470b=function(){return _0x5c0c94;};return a0_0x470b();}async function createDailyDigest(_0x2bdd6c,_0xd6036a){const _0x5ba552=a0_0x5c01dc;if(!_0x2bdd6c[_0x5ba552(0x1a8)])return;if(!canCallApi()){await _0x2bdd6c[_0x5ba552(0x1a5)](LTM_DP_STATUS,{'val':_0x5ba552(0x19e),'ack':!![]});return;}await _0x2bdd6c[_0x5ba552(0x1a5)](LTM_DP_STATUS,{'val':_0x5ba552(0x197),'ack':!![]});if(!_0x2bdd6c['geminiModel']||_0x2bdd6c[_0x5ba552(0x15e)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2bdd6c[_0x5ba552(0x1a5)](LTM_DP_STATUS,{'val':_0x5ba552(0x15a),'ack':!![]});return;}const _0x4cbc93=JSON[_0x5ba552(0x1ce)](JSON[_0x5ba552(0x166)](_0x2bdd6c[_0x5ba552(0x15e)])),_0x4aebfa=_0x4cbc93['length'],_0x1b234e='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON['stringify'](_0x4cbc93);try{updateApiTimestamp();const _0x1a70ca=await _0x2bdd6c[_0x5ba552(0x1a3)][_0x5ba552(0x16f)](_0x1b234e),_0x561ca2=JSON[_0x5ba552(0x1ce)](_0x1a70ca[_0x5ba552(0x16e)][_0x5ba552(0x176)]()['replace'](/```json|```/g,'')[_0x5ba552(0x1bc)]()),_0x5675de={'timestamp':new Date()[_0x5ba552(0x196)](),'eventCount':_0x4aebfa,'summary':_0x561ca2[_0x5ba552(0x1d4)]||_0x5ba552(0x19b),'activityLevel':_0x561ca2[_0x5ba552(0x179)]||_0x5ba552(0x1c1),'systemMode':_0x2bdd6c[_0x5ba552(0x174)]};_0x2bdd6c[_0x5ba552(0x18a)]['push'](_0x5675de);const _0xddbe24=_0x2bdd6c['config']['ltmLtbWindowDays']||0x3c;_0x2bdd6c[_0x5ba552(0x18a)][_0x5ba552(0x1cd)]>_0xddbe24&&_0x2bdd6c[_0x5ba552(0x18a)][_0x5ba552(0x168)](0x0,_0x2bdd6c[_0x5ba552(0x18a)][_0x5ba552(0x1cd)]-_0xddbe24);await _0x2bdd6c[_0x5ba552(0x1a5)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5ba552(0x166)](_0x2bdd6c[_0x5ba552(0x18a)]),'ack':!![]}),_0x2bdd6c['rawEventLog']=[],await _0x2bdd6c['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x5ba552(0x166)](_0x2bdd6c['rawEventLog']),'ack':!![]}),await _0x2bdd6c[_0x5ba552(0x1a5)](LTM_DP_STATUS,{'val':_0x5ba552(0x15d),'ack':!![]});if(_0x2bdd6c['isProVersion']&&_0xd6036a)_0xd6036a[_0x5ba552(0x1b0)](_0x2bdd6c,'ANALYZE_HEALTH',{'digest':_0x5675de});}catch(_0x2944ea){_0x2bdd6c[_0x5ba552(0x1ab)]['error'](_0x2944ea[_0x5ba552(0x178)]);}}async function runBaselineDriftAnalysis(_0x4efb0c){const _0x5c3608=a0_0x5c01dc;if(!_0x4efb0c[_0x5c3608(0x1a8)]||!_0x4efb0c['geminiModel'])return;if(!canCallApi())return;const _0x58638b=_0x4efb0c['config']['ltmStbWindowDays']||0xe;if(_0x4efb0c[_0x5c3608(0x18a)][_0x5c3608(0x1cd)]<_0x58638b+0x7){await _0x4efb0c[_0x5c3608(0x1a5)](_0x5c3608(0x1a7),{'val':_0x5c3608(0x1bd),'ack':!![]});return;}const _0x1c1d76=_0x4efb0c['dailyDigests']['slice'](-_0x58638b),_0x19d805=_0x4efb0c[_0x5c3608(0x18a)][_0x5c3608(0x189)](0x0,_0x4efb0c[_0x5c3608(0x18a)][_0x5c3608(0x1cd)]-_0x58638b),_0x58cbad=_0x5c3608(0x19f)+JSON[_0x5c3608(0x166)](_0x19d805)+_0x5c3608(0x199)+JSON[_0x5c3608(0x166)](_0x1c1d76);try{updateApiTimestamp();const _0x218adf=await _0x4efb0c['geminiModel'][_0x5c3608(0x16f)](_0x58cbad),_0x113253=JSON[_0x5c3608(0x1ce)](_0x218adf['response']['text']()[_0x5c3608(0x177)](/```json|```/g,'')[_0x5c3608(0x1bc)]());_0x113253[_0x5c3608(0x19c)]&&(await _0x4efb0c[_0x5c3608(0x1a5)]('LTM.driftAnalysis.baselineDrift',{'val':_0x113253[_0x5c3608(0x19c)],'ack':!![]}),await _0x4efb0c[_0x5c3608(0x1a5)]('LTM.driftAnalysis.driftDetails',{'val':_0x113253[_0x5c3608(0x1ad)],'ack':!![]}),await _0x4efb0c[_0x5c3608(0x1a5)](_0x5c3608(0x195),{'val':Date[_0x5c3608(0x1a0)](),'ack':!![]}));}catch(_0x2a1806){}}async function executeAutomationAction(_0x5106a6){const _0xfe5ffa=a0_0x5c01dc;try{const _0x336a36=await _0x5106a6['getStateAsync'](_0xfe5ffa(0x198)),_0x17bf9c=await _0x5106a6[_0xfe5ffa(0x1c6)](_0xfe5ffa(0x159));if(_0x336a36&&_0x336a36[_0xfe5ffa(0x1cb)]&&_0x17bf9c){const _0x44c9ba=_0x336a36[_0xfe5ffa(0x1cb)];let _0x36a293=_0x17bf9c[_0xfe5ffa(0x1cb)];try{_0x36a293=JSON['parse'](_0x36a293);}catch(_0x28e2b6){}_0x5106a6[_0xfe5ffa(0x1ab)][_0xfe5ffa(0x17b)](_0xfe5ffa(0x186)+_0x44c9ba+_0xfe5ffa(0x188)+_0x36a293),await _0x5106a6['setForeignStateAsync'](_0x44c9ba,_0x36a293);}else _0x5106a6[_0xfe5ffa(0x1ab)][_0xfe5ffa(0x153)](_0xfe5ffa(0x167));}catch(_0x3e6ce5){_0x5106a6['log'][_0xfe5ffa(0x171)](_0xfe5ffa(0x1b8)+_0x3e6ce5[_0xfe5ffa(0x178)]);}}async function sendMorningBriefing(_0x3c0cf1){const _0x51366c=a0_0x5c01dc;if(!_0x3c0cf1['geminiModel'])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x21a53d=_0x51366c(0x190),_0x1aa780=await _0x3c0cf1[_0x51366c(0x1a3)]['generateContent'](_0x21a53d),_0x21aa62=_0x1aa780[_0x51366c(0x16e)][_0x51366c(0x176)]();setup['sendNotification'](_0x3c0cf1,_0x51366c(0x15f)+_0x21aa62);}catch(_0x2aeb6b){_0x3c0cf1[_0x51366c(0x1ab)]['error'](_0x51366c(0x18d)+_0x2aeb6b['message']);}}module[a0_0x5c01dc(0x180)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};