const a0_0x22115a=a0_0x165e;(function(_0x23527c,_0x20add4){const _0x5533d8=a0_0x165e,_0x3ef606=_0x23527c();while(!![]){try{const _0x56378a=-parseInt(_0x5533d8(0x236))/0x1*(parseInt(_0x5533d8(0x22f))/0x2)+-parseInt(_0x5533d8(0x1c6))/0x3+parseInt(_0x5533d8(0x1a5))/0x4+parseInt(_0x5533d8(0x1c0))/0x5+-parseInt(_0x5533d8(0x221))/0x6*(-parseInt(_0x5533d8(0x216))/0x7)+parseInt(_0x5533d8(0x208))/0x8+-parseInt(_0x5533d8(0x1d8))/0x9*(parseInt(_0x5533d8(0x1d3))/0xa);if(_0x56378a===_0x20add4)break;else _0x3ef606['push'](_0x3ef606['shift']());}catch(_0x235e6a){_0x3ef606['push'](_0x3ef606['shift']());}}}(a0_0x3b5c,0x7909f));const a0_0x515496=(function(){let _0x48e84b=!![];return function(_0x399b1b,_0x55099f){const _0x435566=_0x48e84b?function(){const _0x470968=a0_0x165e;if(_0x55099f){const _0x3b952d=_0x55099f[_0x470968(0x22b)](_0x399b1b,arguments);return _0x55099f=null,_0x3b952d;}}:function(){};return _0x48e84b=![],_0x435566;};}()),a0_0x10b5ec=a0_0x515496(this,function(){const _0x2b4cd1=a0_0x165e;return a0_0x10b5ec['toString']()[_0x2b4cd1(0x231)](_0x2b4cd1(0x1a1))[_0x2b4cd1(0x1d7)]()[_0x2b4cd1(0x1d9)](a0_0x10b5ec)['search']('(((.+)+)+)+$');});a0_0x10b5ec();'use strict';const {GoogleGenerativeAI}=require('@google/generative-ai'),setup=require('./setup'),GEMINI_MODEL=a0_0x22115a(0x1be),LTM_DP_DAILY_DIGESTS=a0_0x22115a(0x1d4),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_RAW_LOG=a0_0x22115a(0x211),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x22115a(0x19f),'senior_aal':a0_0x22115a(0x1ea),'family':a0_0x22115a(0x218),'single_comfort':a0_0x22115a(0x1ba),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x22115a(0x234)};function canCallApi(){const _0x15c27b=Date['now']();return _0x15c27b-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x53d4e2=a0_0x22115a;lastGlobalApiCall=Date[_0x53d4e2(0x1d5)]();}async function getWeatherContext(_0x20343b){const _0x37ac64=a0_0x22115a;if(!_0x20343b[_0x37ac64(0x219)]['useWeather']||!_0x20343b[_0x37ac64(0x219)][_0x37ac64(0x213)])return _0x37ac64(0x1e5);try{const _0x473d6b=_0x20343b[_0x37ac64(0x219)]['weatherInstance'];let _0x27f048=await _0x20343b[_0x37ac64(0x1e8)](_0x473d6b+_0x37ac64(0x200));if(!_0x27f048)_0x27f048=await _0x20343b[_0x37ac64(0x1e8)](_0x473d6b+_0x37ac64(0x1ae));let _0x224f10=await _0x20343b[_0x37ac64(0x1e8)](_0x473d6b+_0x37ac64(0x220));if(!_0x224f10)_0x224f10=await _0x20343b[_0x37ac64(0x1e8)](_0x473d6b+_0x37ac64(0x1b3));let _0x532d31=_0x37ac64(0x226);const _0x502e3f=await _0x20343b[_0x37ac64(0x1e8)](_0x473d6b+_0x37ac64(0x1df));if(_0x502e3f)_0x532d31=_0x502e3f[_0x37ac64(0x22c)]?_0x37ac64(0x1c9):_0x37ac64(0x21b);if(_0x27f048&&_0x224f10)return _0x27f048[_0x37ac64(0x22c)]+_0x37ac64(0x1bf)+_0x224f10[_0x37ac64(0x22c)]+_0x37ac64(0x1e2)+_0x532d31;}catch(_0x1fb92f){}return _0x37ac64(0x1bb);}async function consultButler(_0x1fa87f,_0x5a0caf,_0x323b25,_0xa76e95){const _0x247c06=a0_0x22115a;if(!_0x1fa87f[_0x247c06(0x1ab)])return{'approved':!![],'reason':_0x247c06(0x1f8)};const _0x8dc2f8=Date[_0x247c06(0x1d5)]();if(decisionCache[_0x5a0caf]&&_0x8dc2f8-decisionCache[_0x5a0caf][_0x247c06(0x1f7)]<CACHE_TTL_MS){const _0x1bbb91=decisionCache[_0x5a0caf][_0x247c06(0x1f6)];return _0x1fa87f[_0x247c06(0x1d2)]['debug']('ü§ñ\x20Butler\x20Cache\x20Hit:\x20'+_0x5a0caf+_0x247c06(0x1ec)+(_0x1bbb91[_0x247c06(0x20f)]?'OK':'NO')+'\x20('+_0x1bbb91[_0x247c06(0x1cd)]+')'),_0x1bbb91;}if(!canCallApi())return _0x1fa87f[_0x247c06(0x1d2)]['debug'](_0x247c06(0x1c1)+_0x5a0caf+_0x247c06(0x21c)),{'approved':!![],'reason':_0x247c06(0x215)};const _0x1c0598=new Date()[_0x247c06(0x1b9)](),_0x2c20f1=await getWeatherContext(_0x1fa87f),_0x3f2edb=PERSONA_MAPPING[_0x1fa87f[_0x247c06(0x219)][_0x247c06(0x1cf)]||_0x247c06(0x1d6)],_0x21bdda=_0x247c06(0x217)+_0x1c0598+_0x247c06(0x1b4)+_0x2c20f1+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0xa76e95*0x64)[_0x247c06(0x235)](0x0)+'%)\x20nach\x20\x22'+_0x5a0caf+_0x247c06(0x1eb)+_0x323b25+_0x247c06(0x21d)+_0x3f2edb+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x42340b=await _0x1fa87f[_0x247c06(0x1ab)][_0x247c06(0x210)](_0x21bdda),_0x25581a=_0x42340b['response']['text']()['replace'](/```json|```/g,'')['trim'](),_0x38887b=JSON[_0x247c06(0x1f4)](_0x25581a);return decisionCache[_0x5a0caf]={'decision':_0x38887b,'timestamp':_0x8dc2f8},_0x38887b;}catch(_0x11af3e){return _0x1fa87f[_0x247c06(0x1d2)][_0x247c06(0x22a)]('ü§ñ\x20Butler\x20Brain\x20Error:\x20'+_0x11af3e[_0x247c06(0x1a7)]),decisionCache[_0x5a0caf]={'decision':{'approved':!![],'reason':_0x247c06(0x1af)},'timestamp':_0x8dc2f8-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'};}}async function runGeminiAnalysis(_0x3f4602,_0x280605=''){const _0x3c3f78=a0_0x22115a;if(!_0x3f4602[_0x3c3f78(0x1ab)])return;if(!canCallApi()){_0x3f4602[_0x3c3f78(0x1d2)]['debug']('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x3f4602['eventHistory'][_0x3c3f78(0x1f1)]===0x0)return;const _0x315845=_0x3f4602[_0x3c3f78(0x1d0)][_0x3c3f78(0x20b)](0x0,0xf),_0x19d39a=_0x3f4602['currentSystemMode'],_0x2ebc1e=PERSONA_MAPPING[_0x3f4602[_0x3c3f78(0x219)]['aiPersona']||_0x3c3f78(0x1d6)],_0x186914=_0x3f4602[_0x3c3f78(0x219)][_0x3c3f78(0x1fc)]||_0x3c3f78(0x227);let _0x268b4c=_0x3c3f78(0x226);try{const _0x454af1=await _0x3f4602['getStateAsync'](_0x3c3f78(0x1b2));if(_0x454af1&&_0x454af1[_0x3c3f78(0x22c)])_0x268b4c=_0x454af1['val'];}catch(_0x5d4eb9){}let _0x3417c6=![];try{const _0x411bed=await _0x3f4602[_0x3c3f78(0x1dd)]('analysis.automation.autoApply');if(_0x411bed&&_0x411bed[_0x3c3f78(0x22c)])_0x3417c6=!![];}catch(_0x394926){}const _0x2ec090='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x2ebc1e+_0x3c3f78(0x201)+_0x186914+_0x3c3f78(0x22d)+_0x19d39a+_0x3c3f78(0x1c5)+_0x268b4c+_0x3c3f78(0x1c4)+JSON[_0x3c3f78(0x20c)](_0x315845)+_0x3c3f78(0x21e)+_0x280605+_0x3c3f78(0x1ca);try{updateApiTimestamp();const _0x8464df=await _0x3f4602['geminiModel']['generateContent'](_0x2ec090),_0x2fb0c6=JSON[_0x3c3f78(0x1f4)](_0x8464df['response'][_0x3c3f78(0x21a)]()[_0x3c3f78(0x1fe)](/```json|```/g,'')[_0x3c3f78(0x229)]());await _0x3f4602[_0x3c3f78(0x1cc)](_0x3c3f78(0x1da),{'val':JSON[_0x3c3f78(0x20c)](_0x2fb0c6),'ack':!![]});if(_0x2fb0c6[_0x3c3f78(0x1a4)])await _0x3f4602[_0x3c3f78(0x1cc)](_0x3c3f78(0x1f3),{'val':_0x2fb0c6[_0x3c3f78(0x1a4)],'ack':!![]});const _0x27a7d8={'timestamp':Date[_0x3c3f78(0x1d5)](),'id':Date[_0x3c3f78(0x1d5)]()['toString'](),'analysis':{'activity':{'summary':_0x2fb0c6['summary'],'isAlert':_0x2fb0c6[_0x3c3f78(0x1a3)],'alertReason':_0x2fb0c6[_0x3c3f78(0x1c7)]},'comfort':{'automationProposal':_0x2fb0c6[_0x3c3f78(0x1de)]}}};_0x3f4602[_0x3c3f78(0x1ff)][_0x3c3f78(0x1e3)](_0x27a7d8);if(_0x3f4602['analysisHistory'][_0x3c3f78(0x1f1)]>0x32)_0x3f4602[_0x3c3f78(0x1ff)]['pop']();await _0x3f4602[_0x3c3f78(0x1cc)]('analysis.analysisHistory',{'val':JSON[_0x3c3f78(0x20c)](_0x3f4602['analysisHistory']),'ack':!![]});const _0x3cf146=_0x2fb0c6['isAlert']||![];_0x3cf146!==_0x3f4602[_0x3c3f78(0x19c)]&&(await _0x3f4602['setStateAsync'](_0x3c3f78(0x1b0),{'val':_0x3cf146,'ack':!![]}),_0x3f4602[_0x3c3f78(0x19c)]=_0x3cf146,_0x3cf146&&(await _0x3f4602[_0x3c3f78(0x1cc)](_0x3c3f78(0x1e1),{'val':_0x2fb0c6['alertReason'],'ack':!![]}),setup[_0x3c3f78(0x228)](_0x3f4602,_0x3c3f78(0x204)+_0x2fb0c6[_0x3c3f78(0x1c7)],![],_0x2fb0c6[_0x3c3f78(0x1a6)])));if(_0x2fb0c6['automationProposal']&&_0x2fb0c6[_0x3c3f78(0x1de)][_0x3c3f78(0x206)]){await _0x3f4602['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x3f4602[_0x3c3f78(0x1cc)](_0x3c3f78(0x1fb),{'val':_0x2fb0c6['automationProposal'][_0x3c3f78(0x1a9)],'ack':!![]}),await _0x3f4602[_0x3c3f78(0x1cc)](_0x3c3f78(0x202),{'val':_0x2fb0c6[_0x3c3f78(0x1de)]['targetId'],'ack':!![]}),await _0x3f4602[_0x3c3f78(0x1cc)](_0x3c3f78(0x1f0),{'val':JSON[_0x3c3f78(0x20c)](_0x2fb0c6[_0x3c3f78(0x1de)][_0x3c3f78(0x1cb)]),'ack':!![]});if(_0x3417c6)executeAutomationAction(_0x3f4602);}}catch(_0x9dcd48){_0x3f4602[_0x3c3f78(0x1d2)][_0x3c3f78(0x1a2)](_0x3c3f78(0x1ce)+_0x9dcd48['message']);}}async function createDailyDigest(_0x2783f7,_0x4b1ed9){const _0x2dc8c8=a0_0x22115a;if(!_0x2783f7[_0x2dc8c8(0x1c2)])return;if(!canCallApi()){await _0x2783f7[_0x2dc8c8(0x1cc)](LTM_DP_STATUS,{'val':_0x2dc8c8(0x205),'ack':!![]});return;}await _0x2783f7[_0x2dc8c8(0x1cc)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x2783f7[_0x2dc8c8(0x1ab)]||_0x2783f7[_0x2dc8c8(0x1e7)][_0x2dc8c8(0x1f1)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2783f7[_0x2dc8c8(0x1cc)](LTM_DP_STATUS,{'val':_0x2dc8c8(0x1d1),'ack':!![]});return;}const _0x4f0868=JSON[_0x2dc8c8(0x1f4)](JSON[_0x2dc8c8(0x20c)](_0x2783f7[_0x2dc8c8(0x1e7)])),_0x449b4c=_0x4f0868['length'],_0x5aaa11=_0x2dc8c8(0x224)+JSON[_0x2dc8c8(0x20c)](_0x4f0868);try{updateApiTimestamp();const _0x1b194=await _0x2783f7[_0x2dc8c8(0x1ab)][_0x2dc8c8(0x210)](_0x5aaa11),_0xeb7d8d=JSON[_0x2dc8c8(0x1f4)](_0x1b194[_0x2dc8c8(0x222)][_0x2dc8c8(0x21a)]()['replace'](/```json|```/g,'')[_0x2dc8c8(0x229)]()),_0x1105b2={'timestamp':new Date()[_0x2dc8c8(0x1dc)](),'eventCount':_0x449b4c,'summary':_0xeb7d8d[_0x2dc8c8(0x1a4)]||_0x2dc8c8(0x1aa),'activityLevel':_0xeb7d8d[_0x2dc8c8(0x209)]||_0x2dc8c8(0x1b6),'systemMode':_0x2783f7[_0x2dc8c8(0x1a0)]};_0x2783f7['dailyDigests']['push'](_0x1105b2);const _0x36a98a=_0x2783f7['config']['ltmLtbWindowDays']||0x3c;_0x2783f7['dailyDigests'][_0x2dc8c8(0x1f1)]>_0x36a98a&&_0x2783f7[_0x2dc8c8(0x1bc)][_0x2dc8c8(0x1b7)](0x0,_0x2783f7['dailyDigests'][_0x2dc8c8(0x1f1)]-_0x36a98a);await _0x2783f7['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x2783f7[_0x2dc8c8(0x1bc)]),'ack':!![]}),_0x2783f7[_0x2dc8c8(0x1e7)]=[],await _0x2783f7[_0x2dc8c8(0x1cc)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x2783f7[_0x2dc8c8(0x1e7)]),'ack':!![]}),await _0x2783f7[_0x2dc8c8(0x1cc)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x4b1cda=_0x2dc8c8(0x223)+_0xeb7d8d[_0x2dc8c8(0x1a4)]+'\x0aAktivit√§t:\x20'+_0xeb7d8d[_0x2dc8c8(0x209)];setup[_0x2dc8c8(0x228)](_0x2783f7,_0x4b1cda,![],![]);if(_0x2783f7['isProVersion']&&_0x4b1ed9)_0x4b1ed9[_0x2dc8c8(0x232)](_0x2783f7,_0x2dc8c8(0x237),{'digest':_0x1105b2});}catch(_0x1ce3ac){_0x2783f7['log']['error'](_0x1ce3ac[_0x2dc8c8(0x1a7)]);}}function a0_0x165e(_0x3862de,_0x4cadf9){const _0x4f7a4b=a0_0x3b5c();return a0_0x165e=function(_0x10b5ec,_0x515496){_0x10b5ec=_0x10b5ec-0x19b;let _0x3b5c46=_0x4f7a4b[_0x10b5ec];return _0x3b5c46;},a0_0x165e(_0x3862de,_0x4cadf9);}async function runBaselineDriftAnalysis(_0x5743c1){const _0x32f85c=a0_0x22115a;if(!_0x5743c1[_0x32f85c(0x1c2)]||!_0x5743c1['geminiModel'])return;if(!canCallApi())return;const _0x57e323=_0x5743c1[_0x32f85c(0x219)]['ltmStbWindowDays']||0xe;if(_0x5743c1[_0x32f85c(0x1bc)][_0x32f85c(0x1f1)]<_0x57e323+0x7){await _0x5743c1[_0x32f85c(0x1cc)]('LTM.driftAnalysis.baselineDrift',{'val':_0x32f85c(0x214),'ack':!![]});return;}const _0x21a46d=_0x5743c1[_0x32f85c(0x1bc)]['slice'](-_0x57e323),_0x3e2899=_0x5743c1[_0x32f85c(0x1bc)][_0x32f85c(0x20b)](0x0,_0x5743c1['dailyDigests']['length']-_0x57e323),_0x2a43e2=_0x32f85c(0x1fd)+JSON[_0x32f85c(0x20c)](_0x3e2899)+_0x32f85c(0x1e6)+JSON['stringify'](_0x21a46d);try{updateApiTimestamp();const _0x3cb455=await _0x5743c1[_0x32f85c(0x1ab)][_0x32f85c(0x210)](_0x2a43e2),_0x5c1c3f=JSON[_0x32f85c(0x1f4)](_0x3cb455['response'][_0x32f85c(0x21a)]()[_0x32f85c(0x1fe)](/```json|```/g,'')[_0x32f85c(0x229)]());_0x5c1c3f[_0x32f85c(0x230)]&&(await _0x5743c1[_0x32f85c(0x1cc)]('LTM.driftAnalysis.baselineDrift',{'val':_0x5c1c3f[_0x32f85c(0x230)],'ack':!![]}),await _0x5743c1[_0x32f85c(0x1cc)](_0x32f85c(0x1fa),{'val':_0x5c1c3f[_0x32f85c(0x19d)],'ack':!![]}),await _0x5743c1[_0x32f85c(0x1cc)]('LTM.driftAnalysis.lastCheck',{'val':Date[_0x32f85c(0x1d5)](),'ack':!![]}));}catch(_0x446eef){}}async function executeAutomationAction(_0x533d60){const _0x2cdfde=a0_0x22115a;try{const _0x24f012=await _0x533d60[_0x2cdfde(0x1dd)](_0x2cdfde(0x202)),_0x122122=await _0x533d60['getStateAsync'](_0x2cdfde(0x1f0));if(_0x24f012&&_0x24f012['val']&&_0x122122){const _0x2c2665=_0x24f012[_0x2cdfde(0x22c)];let _0x5251d2=_0x122122['val'];try{_0x5251d2=JSON['parse'](_0x5251d2);}catch(_0x2d3642){}_0x533d60[_0x2cdfde(0x1d2)][_0x2cdfde(0x207)](_0x2cdfde(0x1f5)+_0x2c2665+'\x20=\x20'+_0x5251d2),await _0x533d60['setForeignStateAsync'](_0x2c2665,_0x5251d2);}else _0x533d60['log'][_0x2cdfde(0x22a)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x2099c4){_0x533d60[_0x2cdfde(0x1d2)][_0x2cdfde(0x1a2)](_0x2cdfde(0x225)+_0x2099c4['message']);}}async function sendMorningBriefing(_0x46b107){const _0x3e323d=a0_0x22115a;if(!_0x46b107[_0x3e323d(0x1ab)]){_0x46b107['log'][_0x3e323d(0x22a)]('ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x46b107['log'][_0x3e323d(0x207)](_0x3e323d(0x1e4));try{updateApiTimestamp();const _0x1c6d67=_0x3e323d(0x212),_0x29f2d2=await _0x46b107['geminiModel'][_0x3e323d(0x210)](_0x1c6d67),_0x50db0b=_0x29f2d2[_0x3e323d(0x222)][_0x3e323d(0x21a)]();_0x46b107['log'][_0x3e323d(0x207)](_0x3e323d(0x1ed)+_0x50db0b['length']+_0x3e323d(0x1ad)),setup[_0x3e323d(0x228)](_0x46b107,_0x3e323d(0x22e)+_0x50db0b);}catch(_0x2e8ae9){_0x46b107[_0x3e323d(0x1d2)][_0x3e323d(0x1a2)](_0x3e323d(0x1db)+_0x2e8ae9['message']);}}async function generateHealthReport(_0x57474f,_0x427248){const _0x4568e3=a0_0x22115a;if(!_0x57474f['geminiModel'])return;const _0xe79044=Date[_0x4568e3(0x1d5)]();_0xe79044-lastGlobalApiCall<0xbb8&&(_0x57474f['log'][_0x4568e3(0x19e)](_0x4568e3(0x1c8)),await new Promise(_0x392f2e=>setTimeout(_0x392f2e,0x7d0)));const _0x52da09=new Date();let _0x3ba39d=0x0,_0x111e3b=_0x52da09[_0x4568e3(0x1e0)](),_0x349fec='';if(_0x427248===_0x4568e3(0x1b1)){const _0x54cfa3=new Date(_0x52da09);_0x54cfa3[_0x4568e3(0x233)](_0x54cfa3[_0x4568e3(0x1f2)]()-0x1),_0x54cfa3['setHours'](0x16,0x0,0x0,0x0),_0x3ba39d=_0x54cfa3[_0x4568e3(0x1e0)]();const _0x1eb728=new Date(_0x52da09);_0x1eb728[_0x4568e3(0x203)](0x8,0x0,0x0,0x0),_0x111e3b=_0x1eb728[_0x4568e3(0x1e0)](),_0x349fec=_0x4568e3(0x20d);}else{const _0xda1fba=new Date(_0x52da09);_0xda1fba[_0x4568e3(0x203)](0x8,0x0,0x0,0x0),_0x3ba39d=_0xda1fba['getTime'](),_0x349fec=_0x4568e3(0x1a8);}const _0x3eb5e0=_0x57474f[_0x4568e3(0x1d0)][_0x4568e3(0x1ee)](_0x408474=>_0x408474[_0x4568e3(0x1f7)]>=_0x3ba39d&&_0x408474['timestamp']<=_0x111e3b);if(_0x3eb5e0['length']===0x0){const _0x1c1a7f=_0x427248===_0x4568e3(0x1b1)?_0x4568e3(0x21f):'Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.',_0x155976=_0x427248===_0x4568e3(0x1b1)?_0x4568e3(0x1ef):_0x4568e3(0x19b);await _0x57474f[_0x4568e3(0x1cc)](_0x155976,{'val':_0x1c1a7f,'ack':!![]});return;}const _0xd6f320=_0x3eb5e0['map'](_0x4e603c=>new Date(_0x4e603c['timestamp'])[_0x4568e3(0x1b9)]([],{'hour':_0x4568e3(0x1b8),'minute':_0x4568e3(0x1b8)})+'\x20'+_0x4e603c['name']+'\x20('+_0x4e603c[_0x4568e3(0x1ac)]+')')[_0x4568e3(0x1f9)]('\x0a'),_0x1128ad='\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20'+_0x349fec+_0x4568e3(0x1c3)+_0xd6f320+_0x4568e3(0x1b5);try{updateApiTimestamp();const _0x126dfe=await _0x57474f['geminiModel'][_0x4568e3(0x210)](_0x1128ad),_0x3a2bd1=_0x126dfe[_0x4568e3(0x222)][_0x4568e3(0x21a)](),_0x4a19ed=_0x427248===_0x4568e3(0x1b1)?_0x4568e3(0x1ef):_0x4568e3(0x19b);await _0x57474f['setStateAsync'](_0x4a19ed,{'val':_0x3a2bd1,'ack':!![]}),_0x57474f[_0x4568e3(0x1d2)][_0x4568e3(0x207)](_0x4568e3(0x1e9)+_0x427248+_0x4568e3(0x20a));}catch(_0x5743eb){_0x57474f[_0x4568e3(0x1d2)][_0x4568e3(0x1a2)](_0x4568e3(0x1bd)+_0x5743eb[_0x4568e3(0x1a7)]);}}function a0_0x3b5c(){const _0x491c2c=['Gemini\x20Error:\x20','aiPersona','eventHistory','Skipped\x20(No\x20AI\x20or\x20Data)','log','90170QJDEYT','LTM.dailyDigests','now','generic','toString','189lhgEXy','constructor','analysis.lastResult','Briefing\x20Error:\x20','toISOString','getStateAsync','automationProposal','.Current.IsNight','getTime','analysis.alertReason',',\x20Lichtverh√§ltnisse:\x20','unshift','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','Unbekannt\x20(Kein\x20Sensor)','\x0aSTB:\x20','rawEventLog','getForeignStateAsync','ü§ñ\x20Health\x20Report\x20(','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','\x20->\x20','üåÖ\x20Briefing\x20generated\x20(Length:\x20','filter','analysis.health.geminiNight','analysis.automation.targetValue','length','getDate','analysis.activitySummary','parse','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','decision','timestamp','KI\x20offline\x20(Fallback)','join','LTM.driftAnalysis.driftDetails','analysis.automation.description','livingContext','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','replace','analysisHistory','.Current.Temperature','.\x20KONTEXT:\x20','analysis.automation.targetId','setHours','‚ö†Ô∏è\x20ALARM:\x20','Skipped\x20(Traffic)','detected','info','5340376mQZHcm','activityLevel',')\x20generated.','slice','stringify','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','exports','approved','generateContent','LTM.rawEventLog','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','weatherInstance','N/A\x20(Learning)','Traffic-Schutz\x20(Auto-Approved)','7UcODUn','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','config','text','Tag','\x20√ºbersprungen\x20(Auto-Approved).','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','.\x20EMERGENCY:\x20','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','.Current.WeatherText','1170822bixceA','response','üìÖ\x20Daily\x20Digest:\x0a','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','BUTLER\x20Execution\x20Error:\x20','Unbekannt','Keine\x20Details.','sendNotification','trim','warn','apply','val','.\x20SYSTEM_MODE:\x20','üåÖ\x20Morning\x20Briefing:\x0a','4giyQVs','baselineDrift','search','send','setDate','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','toFixed','341701MRFLxo','ANALYZE_HEALTH','analysis.health.geminiDay','lastAlertState','driftDetails','debug','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','currentSystemMode','(((.+)+)+)+$','error','isAlert','summary','2544212TDfPAY','isEmergency','message','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','description','Digest','geminiModel','value',').\x20Sending\x20notification...','.forecast.current.temperature','KI-Fehler\x20(Fallback)','analysis.isAlert','NIGHT','system.presenceWho','.forecast.current.state',',\x20Wetter:\x20','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','normal','splice','2-digit','toLocaleTimeString','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','Wetterdaten\x20nicht\x20abrufbar','dailyDigests','Health\x20Report\x20Error:\x20','models/gemini-flash-latest','¬∞C,\x20','847595uORqUC','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','isProVersion','\x0a\x20\x20\x20\x20EVENTS:\x0a','.\x20EVENTS:\x20','.\x20ANWESEND:\x20','899166rxwAEP','alertReason','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','Nacht','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','targetValue','setStateAsync','reason'];a0_0x3b5c=function(){return _0x491c2c;};return a0_0x3b5c();}module[a0_0x22115a(0x20e)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};