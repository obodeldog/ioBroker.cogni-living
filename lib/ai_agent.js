function a0_0x2ce6(){const _0x5eb114=['targetValue','length','analysis.activitySummary','.Current.Temperature','401682eZKmWK','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','\x0aSTB:\x20','aiPersona','Nacht','NIGHT','492795MuykdW','constructor','exports','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','generic','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','Briefing\x20Error:\x20','Skipped\x20(No\x20AI\x20or\x20Data)','analysis.health.geminiNight','generateContent','debug','toString','detected','error','2-digit','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','text','ANALYZE_HEALTH','baselineDrift','Success','.forecast.current.temperature','dailyDigests','KI\x20offline\x20(Fallback)','currentSystemMode','trim','warn','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','getTime','toFixed','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','1554042zzDzvd','ðŸ¤–\x20Health\x20Report\x20(','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','isAlert',',\x20LichtverhÃ¤ltnisse:\x20','./setup','toLocaleTimeString',').\x20Sending\x20notification...','weatherInstance','geminiModel','analysis.automation.autoApply','log','reason','automationProposal','Gemini\x20Error:\x20','ltmLtbWindowDays','analysis.automation.targetValue','isEmergency','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','.forecast.current.state','Tag','models/gemini-flash-latest','description','response','now','alertReason','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','8lHjViy','decision','%)\x20nach\x20\x22','(((.+)+)+)+$','isProVersion','N/A\x20(Learning)','rawEventLog','LTM.driftAnalysis.lastCheck','\x20=\x20','pop','summary','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','LTM.driftAnalysis.driftDetails','Unbekannt','parse','.\x20EMERGENCY:\x20','Unbekannt\x20(Kein\x20Sensor)','lastAlertState','ðŸŒ…\x20Morning\x20Briefing:\x0a','eventHistory','config','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','approved','4kIJmlK','1848132ZgIgBM','filter','analysis.automation.description','\x20Ã¼bersprungen\x20(Auto-Approved).','.Current.WeatherText','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','unshift','LTM.rawEventLog','Keine\x20Details.','search','analysis.automation.patternDetected','slice','timestamp','analysisHistory','message','Wetterdaten\x20nicht\x20abrufbar','name','Sicherheit\x20geht\x20vor.','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','LTM.dailyDigests','stringify','setStateAsync','replace','map','val','.\x20ANWESEND:\x20','LTM.processingStatus','1304466ehYkVu','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','@google/generative-ai','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','BUTLER\x20Execution\x20Error:\x20','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','Digest',')\x20generated.','âš ï¸\x20ALARM:\x20',',\x20Wetter:\x20','info','LTM.driftAnalysis.baselineDrift','getForeignStateAsync','651666CTnIAT','targetId','analysis.automation.targetId','analysis.health.geminiDay','activityLevel','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','Started...','\x0aAktivitÃ¤t:\x20','analysis.alertReason','617280qgnQPB','analysis.isAlert','Traffic-Schutz\x20(Auto-Approved)','setHours','\x0a\x20\x20\x20\x20EVENTS:\x0a','.\x20EVENTS:\x20','ðŸ“…\x20Daily\x20Digest:\x0a','Health\x20Report\x20Error:\x20','sendNotification','analysis.lastResult','getDate','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','setDate','getStateAsync','value','splice','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).'];a0_0x2ce6=function(){return _0x5eb114;};return a0_0x2ce6();}const a0_0xe3dbac=a0_0x2673;(function(_0x5b1762,_0x153ac8){const _0x2f8e77=a0_0x2673,_0x1bf973=_0x5b1762();while(!![]){try{const _0x3cb194=parseInt(_0x2f8e77(0x149))/0x1+-parseInt(_0x2f8e77(0x129))/0x2+-parseInt(_0x2f8e77(0x132))/0x3+-parseInt(_0x2f8e77(0x1a0))/0x4*(-parseInt(_0x2f8e77(0x14f))/0x5)+parseInt(_0x2f8e77(0x11c))/0x6+parseInt(_0x2f8e77(0x16e))/0x7+parseInt(_0x2f8e77(0x189))/0x8*(-parseInt(_0x2f8e77(0x1a1))/0x9);if(_0x3cb194===_0x153ac8)break;else _0x1bf973['push'](_0x1bf973['shift']());}catch(_0xd6eb2e){_0x1bf973['push'](_0x1bf973['shift']());}}}(a0_0x2ce6,0x317dd));const a0_0x5b873b=(function(){let _0x12d53b=!![];return function(_0x9528f7,_0x5596c9){const _0x4fad40=_0x12d53b?function(){if(_0x5596c9){const _0xde855d=_0x5596c9['apply'](_0x9528f7,arguments);return _0x5596c9=null,_0xde855d;}}:function(){};return _0x12d53b=![],_0x4fad40;};}()),a0_0x37a557=a0_0x5b873b(this,function(){const _0x307f44=a0_0x2673;return a0_0x37a557[_0x307f44(0x15b)]()[_0x307f44(0x1aa)]('(((.+)+)+)+$')[_0x307f44(0x15b)]()[_0x307f44(0x150)](a0_0x37a557)[_0x307f44(0x1aa)](_0x307f44(0x18c));});a0_0x37a557();'use strict';const {GoogleGenerativeAI}=require(a0_0xe3dbac(0x11e)),setup=require(a0_0xe3dbac(0x173)),GEMINI_MODEL=a0_0xe3dbac(0x183),LTM_DP_DAILY_DIGESTS=a0_0xe3dbac(0x114),LTM_DP_STATUS=a0_0xe3dbac(0x11b),LTM_DP_RAW_LOG=a0_0xe3dbac(0x1a8),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0xe3dbac(0x188),'senior_aal':'PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':a0_0xe3dbac(0x11f),'single_comfort':a0_0xe3dbac(0x170),'security':a0_0xe3dbac(0x112),'energy_saver':'PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).'};function canCallApi(){const _0x192e55=a0_0xe3dbac,_0x387738=Date[_0x192e55(0x186)]();return _0x387738-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x47867d=a0_0xe3dbac;lastGlobalApiCall=Date[_0x47867d(0x186)]();}async function getWeatherContext(_0x363614){const _0x3b4384=a0_0xe3dbac;if(!_0x363614[_0x3b4384(0x19d)]['useWeather']||!_0x363614['config'][_0x3b4384(0x176)])return _0x3b4384(0x199);try{const _0x8c82b6=_0x363614['config'][_0x3b4384(0x176)];let _0x14b4ca=await _0x363614[_0x3b4384(0x128)](_0x8c82b6+_0x3b4384(0x148));if(!_0x14b4ca)_0x14b4ca=await _0x363614[_0x3b4384(0x128)](_0x8c82b6+_0x3b4384(0x164));let _0xd846b9=await _0x363614['getForeignStateAsync'](_0x8c82b6+_0x3b4384(0x1a5));if(!_0xd846b9)_0xd846b9=await _0x363614['getForeignStateAsync'](_0x8c82b6+_0x3b4384(0x181));let _0x2123e9='Unbekannt';const _0x4abce4=await _0x363614[_0x3b4384(0x128)](_0x8c82b6+'.Current.IsNight');if(_0x4abce4)_0x2123e9=_0x4abce4['val']?_0x3b4384(0x14d):_0x3b4384(0x182);if(_0x14b4ca&&_0xd846b9)return _0x14b4ca[_0x3b4384(0x119)]+'Â°C,\x20'+_0xd846b9[_0x3b4384(0x119)]+_0x3b4384(0x172)+_0x2123e9;}catch(_0x2cbe82){}return _0x3b4384(0x1b0);}async function consultButler(_0x503f28,_0x35ec7a,_0x2e94fb,_0x43939b){const _0x2c6d6a=a0_0xe3dbac;if(!_0x503f28[_0x2c6d6a(0x177)])return{'approved':!![],'reason':_0x2c6d6a(0x166)};const _0x8e0187=Date[_0x2c6d6a(0x186)]();if(decisionCache[_0x35ec7a]&&_0x8e0187-decisionCache[_0x35ec7a][_0x2c6d6a(0x1ad)]<CACHE_TTL_MS){const _0x524727=decisionCache[_0x35ec7a][_0x2c6d6a(0x18a)];return _0x503f28[_0x2c6d6a(0x179)][_0x2c6d6a(0x15a)](_0x2c6d6a(0x121)+_0x35ec7a+'\x20->\x20'+(_0x524727[_0x2c6d6a(0x19f)]?'OK':'NO')+'\x20('+_0x524727[_0x2c6d6a(0x17a)]+')'),_0x524727;}if(!canCallApi())return _0x503f28[_0x2c6d6a(0x179)]['debug'](_0x2c6d6a(0x14a)+_0x35ec7a+_0x2c6d6a(0x1a4)),{'approved':!![],'reason':_0x2c6d6a(0x134)};const _0x5344a4=new Date()[_0x2c6d6a(0x174)](),_0x4cc180=await getWeatherContext(_0x503f28),_0x5381dc=PERSONA_MAPPING[_0x503f28[_0x2c6d6a(0x19d)]['aiPersona']||_0x2c6d6a(0x153)],_0x4c919f=_0x2c6d6a(0x19e)+_0x5344a4+_0x2c6d6a(0x125)+_0x4cc180+_0x2c6d6a(0x155)+(_0x43939b*0x64)[_0x2c6d6a(0x16c)](0x0)+_0x2c6d6a(0x18b)+_0x35ec7a+_0x2c6d6a(0x143)+_0x2e94fb+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x5381dc+_0x2c6d6a(0x12e);try{updateApiTimestamp();const _0x13da4c=await _0x503f28['geminiModel'][_0x2c6d6a(0x159)](_0x4c919f),_0x4e541f=_0x13da4c[_0x2c6d6a(0x185)]['text']()[_0x2c6d6a(0x117)](/```json|```/g,'')['trim'](),_0x1fa7d2=JSON[_0x2c6d6a(0x197)](_0x4e541f);return decisionCache[_0x35ec7a]={'decision':_0x1fa7d2,'timestamp':_0x8e0187},_0x1fa7d2;}catch(_0x5182d8){return _0x503f28[_0x2c6d6a(0x179)][_0x2c6d6a(0x169)](_0x2c6d6a(0x194)+_0x5182d8[_0x2c6d6a(0x1af)]),decisionCache[_0x35ec7a]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x8e0187-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'};}}async function runGeminiAnalysis(_0x3858ca,_0x1da01a=''){const _0x1caf13=a0_0xe3dbac;if(!_0x3858ca[_0x1caf13(0x177)])return;if(!canCallApi()){_0x3858ca[_0x1caf13(0x179)]['debug'](_0x1caf13(0x144));return;}if(_0x3858ca[_0x1caf13(0x19c)][_0x1caf13(0x146)]===0x0)return;const _0x39fb09=_0x3858ca[_0x1caf13(0x19c)]['slice'](0x0,0xf),_0x5d94b6=_0x3858ca['currentSystemMode'],_0x48fcf3=PERSONA_MAPPING[_0x3858ca['config'][_0x1caf13(0x14c)]||_0x1caf13(0x153)],_0x300552=_0x3858ca[_0x1caf13(0x19d)]['livingContext']||_0x1caf13(0x1a9);let _0x4383a5=_0x1caf13(0x196);try{const _0x3883c0=await _0x3858ca[_0x1caf13(0x13f)]('system.presenceWho');if(_0x3883c0&&_0x3883c0[_0x1caf13(0x119)])_0x4383a5=_0x3883c0[_0x1caf13(0x119)];}catch(_0x2786e2){}let _0x5c30f4=![];try{const _0x595db6=await _0x3858ca[_0x1caf13(0x13f)](_0x1caf13(0x178));if(_0x595db6&&_0x595db6[_0x1caf13(0x119)])_0x5c30f4=!![];}catch(_0x51aeed){}const _0x26d270='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x48fcf3+'.\x20KONTEXT:\x20'+_0x300552+'.\x20SYSTEM_MODE:\x20'+_0x5d94b6+_0x1caf13(0x11a)+_0x4383a5+_0x1caf13(0x137)+JSON[_0x1caf13(0x115)](_0x39fb09)+_0x1caf13(0x198)+_0x1da01a+_0x1caf13(0x1a6);try{updateApiTimestamp();const _0x2cd8d2=await _0x3858ca[_0x1caf13(0x177)]['generateContent'](_0x26d270),_0x2e19d8=JSON['parse'](_0x2cd8d2['response'][_0x1caf13(0x160)]()[_0x1caf13(0x117)](/```json|```/g,'')[_0x1caf13(0x168)]());await _0x3858ca[_0x1caf13(0x116)](_0x1caf13(0x13b),{'val':JSON[_0x1caf13(0x115)](_0x2e19d8),'ack':!![]});if(_0x2e19d8['summary'])await _0x3858ca['setStateAsync'](_0x1caf13(0x147),{'val':_0x2e19d8[_0x1caf13(0x193)],'ack':!![]});const _0x2968fc={'timestamp':Date[_0x1caf13(0x186)](),'id':Date['now']()[_0x1caf13(0x15b)](),'analysis':{'activity':{'summary':_0x2e19d8[_0x1caf13(0x193)],'isAlert':_0x2e19d8[_0x1caf13(0x171)],'alertReason':_0x2e19d8[_0x1caf13(0x187)]},'comfort':{'automationProposal':_0x2e19d8[_0x1caf13(0x17b)]}}};_0x3858ca[_0x1caf13(0x1ae)][_0x1caf13(0x1a7)](_0x2968fc);if(_0x3858ca[_0x1caf13(0x1ae)][_0x1caf13(0x146)]>0x32)_0x3858ca['analysisHistory'][_0x1caf13(0x192)]();await _0x3858ca[_0x1caf13(0x116)]('analysis.analysisHistory',{'val':JSON[_0x1caf13(0x115)](_0x3858ca['analysisHistory']),'ack':!![]});const _0x434f62=_0x2e19d8[_0x1caf13(0x171)]||![];_0x434f62!==_0x3858ca[_0x1caf13(0x19a)]&&(await _0x3858ca[_0x1caf13(0x116)](_0x1caf13(0x133),{'val':_0x434f62,'ack':!![]}),_0x3858ca[_0x1caf13(0x19a)]=_0x434f62,_0x434f62&&(await _0x3858ca[_0x1caf13(0x116)](_0x1caf13(0x131),{'val':_0x2e19d8[_0x1caf13(0x187)],'ack':!![]}),setup[_0x1caf13(0x13a)](_0x3858ca,_0x1caf13(0x124)+_0x2e19d8[_0x1caf13(0x187)],![],_0x2e19d8[_0x1caf13(0x17f)])));if(_0x2e19d8[_0x1caf13(0x17b)]&&_0x2e19d8[_0x1caf13(0x17b)][_0x1caf13(0x15c)]){await _0x3858ca[_0x1caf13(0x116)](_0x1caf13(0x1ab),{'val':!![],'ack':!![]}),await _0x3858ca['setStateAsync'](_0x1caf13(0x1a3),{'val':_0x2e19d8[_0x1caf13(0x17b)][_0x1caf13(0x184)],'ack':!![]}),await _0x3858ca[_0x1caf13(0x116)](_0x1caf13(0x12b),{'val':_0x2e19d8[_0x1caf13(0x17b)][_0x1caf13(0x12a)],'ack':!![]}),await _0x3858ca[_0x1caf13(0x116)](_0x1caf13(0x17e),{'val':JSON[_0x1caf13(0x115)](_0x2e19d8[_0x1caf13(0x17b)][_0x1caf13(0x145)]),'ack':!![]});if(_0x5c30f4)executeAutomationAction(_0x3858ca);}}catch(_0x221b8c){_0x3858ca[_0x1caf13(0x179)][_0x1caf13(0x15d)](_0x1caf13(0x17c)+_0x221b8c['message']);}}async function createDailyDigest(_0x193116,_0x4c1b79){const _0x3437b5=a0_0xe3dbac;if(!_0x193116[_0x3437b5(0x18d)])return;if(!canCallApi()){await _0x193116[_0x3437b5(0x116)](LTM_DP_STATUS,{'val':'Skipped\x20(Traffic)','ack':!![]});return;}await _0x193116['setStateAsync'](LTM_DP_STATUS,{'val':_0x3437b5(0x12f),'ack':!![]});if(!_0x193116[_0x3437b5(0x177)]||_0x193116[_0x3437b5(0x18f)][_0x3437b5(0x146)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x193116['setStateAsync'](LTM_DP_STATUS,{'val':_0x3437b5(0x157),'ack':!![]});return;}const _0x16d25b=JSON[_0x3437b5(0x197)](JSON[_0x3437b5(0x115)](_0x193116['rawEventLog'])),_0xfba0f2=_0x16d25b[_0x3437b5(0x146)],_0x1abfba=_0x3437b5(0x154)+JSON[_0x3437b5(0x115)](_0x16d25b);try{updateApiTimestamp();const _0x323c1d=await _0x193116['geminiModel']['generateContent'](_0x1abfba),_0x4b772a=JSON[_0x3437b5(0x197)](_0x323c1d[_0x3437b5(0x185)][_0x3437b5(0x160)]()['replace'](/```json|```/g,'')[_0x3437b5(0x168)]()),_0x57533d={'timestamp':new Date()['toISOString'](),'eventCount':_0xfba0f2,'summary':_0x4b772a[_0x3437b5(0x193)]||_0x3437b5(0x122),'activityLevel':_0x4b772a[_0x3437b5(0x12d)]||'normal','systemMode':_0x193116[_0x3437b5(0x167)]};_0x193116['dailyDigests']['push'](_0x57533d);const _0x3096f3=_0x193116[_0x3437b5(0x19d)][_0x3437b5(0x17d)]||0x3c;_0x193116[_0x3437b5(0x165)][_0x3437b5(0x146)]>_0x3096f3&&_0x193116[_0x3437b5(0x165)][_0x3437b5(0x141)](0x0,_0x193116['dailyDigests']['length']-_0x3096f3);await _0x193116[_0x3437b5(0x116)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x3437b5(0x115)](_0x193116[_0x3437b5(0x165)]),'ack':!![]}),_0x193116[_0x3437b5(0x18f)]=[],await _0x193116[_0x3437b5(0x116)](LTM_DP_RAW_LOG,{'val':JSON[_0x3437b5(0x115)](_0x193116[_0x3437b5(0x18f)]),'ack':!![]}),await _0x193116['setStateAsync'](LTM_DP_STATUS,{'val':_0x3437b5(0x163),'ack':!![]});const _0x331f55=_0x3437b5(0x138)+_0x4b772a['summary']+_0x3437b5(0x130)+_0x4b772a[_0x3437b5(0x12d)];setup['sendNotification'](_0x193116,_0x331f55,![],![]);if(_0x193116[_0x3437b5(0x18d)]&&_0x4c1b79)_0x4c1b79['send'](_0x193116,_0x3437b5(0x161),{'digest':_0x57533d});}catch(_0x205e5b){_0x193116['log'][_0x3437b5(0x15d)](_0x205e5b[_0x3437b5(0x1af)]);}}async function runBaselineDriftAnalysis(_0x1c4a79){const _0x770fc8=a0_0xe3dbac;if(!_0x1c4a79[_0x770fc8(0x18d)]||!_0x1c4a79[_0x770fc8(0x177)])return;if(!canCallApi())return;const _0x5158c4=_0x1c4a79[_0x770fc8(0x19d)]['ltmStbWindowDays']||0xe;if(_0x1c4a79[_0x770fc8(0x165)]['length']<_0x5158c4+0x7){await _0x1c4a79['setStateAsync'](_0x770fc8(0x127),{'val':_0x770fc8(0x18e),'ack':!![]});return;}const _0xda577b=_0x1c4a79[_0x770fc8(0x165)][_0x770fc8(0x1ac)](-_0x5158c4),_0x23ce8c=_0x1c4a79[_0x770fc8(0x165)][_0x770fc8(0x1ac)](0x0,_0x1c4a79[_0x770fc8(0x165)][_0x770fc8(0x146)]-_0x5158c4),_0x18f62f='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x770fc8(0x115)](_0x23ce8c)+_0x770fc8(0x14b)+JSON[_0x770fc8(0x115)](_0xda577b);try{updateApiTimestamp();const _0x5bd8a6=await _0x1c4a79['geminiModel']['generateContent'](_0x18f62f),_0x57c0f4=JSON[_0x770fc8(0x197)](_0x5bd8a6['response'][_0x770fc8(0x160)]()[_0x770fc8(0x117)](/```json|```/g,'')['trim']());_0x57c0f4[_0x770fc8(0x162)]&&(await _0x1c4a79['setStateAsync'](_0x770fc8(0x127),{'val':_0x57c0f4[_0x770fc8(0x162)],'ack':!![]}),await _0x1c4a79[_0x770fc8(0x116)](_0x770fc8(0x195),{'val':_0x57c0f4['driftDetails'],'ack':!![]}),await _0x1c4a79[_0x770fc8(0x116)](_0x770fc8(0x190),{'val':Date[_0x770fc8(0x186)](),'ack':!![]}));}catch(_0x439266){}}async function executeAutomationAction(_0x57809f){const _0x284c96=a0_0xe3dbac;try{const _0x290c11=await _0x57809f[_0x284c96(0x13f)](_0x284c96(0x12b)),_0xba7f68=await _0x57809f[_0x284c96(0x13f)](_0x284c96(0x17e));if(_0x290c11&&_0x290c11[_0x284c96(0x119)]&&_0xba7f68){const _0xb1ac6f=_0x290c11[_0x284c96(0x119)];let _0x186df6=_0xba7f68[_0x284c96(0x119)];try{_0x186df6=JSON[_0x284c96(0x197)](_0x186df6);}catch(_0x442b0e){}_0x57809f[_0x284c96(0x179)][_0x284c96(0x126)](_0x284c96(0x11d)+_0xb1ac6f+_0x284c96(0x191)+_0x186df6),await _0x57809f['setForeignStateAsync'](_0xb1ac6f,_0x186df6);}else _0x57809f[_0x284c96(0x179)][_0x284c96(0x169)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x19bcc7){_0x57809f['log'][_0x284c96(0x15d)](_0x284c96(0x120)+_0x19bcc7[_0x284c96(0x1af)]);}}async function sendMorningBriefing(_0x4cee23){const _0x40b631=a0_0xe3dbac;if(!_0x4cee23[_0x40b631(0x177)]){_0x4cee23[_0x40b631(0x179)]['warn']('ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x4cee23['log'][_0x40b631(0x126)](_0x40b631(0x142));try{updateApiTimestamp();const _0x5db848='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x30153d=await _0x4cee23[_0x40b631(0x177)][_0x40b631(0x159)](_0x5db848),_0x58b1aa=_0x30153d[_0x40b631(0x185)]['text']();_0x4cee23['log'][_0x40b631(0x126)](_0x40b631(0x16d)+_0x58b1aa[_0x40b631(0x146)]+_0x40b631(0x175)),setup['sendNotification'](_0x4cee23,_0x40b631(0x19b)+_0x58b1aa);}catch(_0x46efa8){_0x4cee23[_0x40b631(0x179)][_0x40b631(0x15d)](_0x40b631(0x156)+_0x46efa8['message']);}}async function generateHealthReport(_0x7925b0,_0xeabb87){const _0xe32209=a0_0xe3dbac;if(!_0x7925b0[_0xe32209(0x177)])return;const _0x3b0a02=Date[_0xe32209(0x186)]();_0x3b0a02-lastGlobalApiCall<0xbb8&&(_0x7925b0['log'][_0xe32209(0x15a)](_0xe32209(0x13d)),await new Promise(_0x2d425b=>setTimeout(_0x2d425b,0x7d0)));const _0x480987=new Date();let _0x16688a=0x0,_0x473c15=_0x480987[_0xe32209(0x16b)](),_0x3041ed='';if(_0xeabb87==='NIGHT'){const _0x2d9810=new Date(_0x480987);_0x2d9810[_0xe32209(0x13e)](_0x2d9810[_0xe32209(0x13c)]()-0x1),_0x2d9810['setHours'](0x16,0x0,0x0,0x0),_0x16688a=_0x2d9810[_0xe32209(0x16b)]();const _0x5cd6d5=new Date(_0x480987);_0x5cd6d5[_0xe32209(0x135)](0x8,0x0,0x0,0x0),_0x473c15=_0x5cd6d5[_0xe32209(0x16b)](),_0x3041ed=_0xe32209(0x15f);}else{const _0x577efd=new Date(_0x480987);_0x577efd['setHours'](0x8,0x0,0x0,0x0),_0x16688a=_0x577efd['getTime'](),_0x3041ed=_0xe32209(0x152);}const _0x1af735=_0x7925b0['eventHistory'][_0xe32209(0x1a2)](_0x1a5118=>_0x1a5118['timestamp']>=_0x16688a&&_0x1a5118[_0xe32209(0x1ad)]<=_0x473c15);if(_0x1af735[_0xe32209(0x146)]===0x0){const _0x2573ca=_0xeabb87==='NIGHT'?_0xe32209(0x180):_0xe32209(0x113),_0x34786d=_0xeabb87==='NIGHT'?_0xe32209(0x158):'analysis.health.geminiDay';await _0x7925b0[_0xe32209(0x116)](_0x34786d,{'val':_0x2573ca,'ack':!![]});return;}const _0x475f66=_0x1af735[_0xe32209(0x118)](_0x431d9a=>new Date(_0x431d9a[_0xe32209(0x1ad)])['toLocaleTimeString']([],{'hour':'2-digit','minute':_0xe32209(0x15e)})+'\x20'+_0x431d9a[_0xe32209(0x111)]+'\x20('+_0x431d9a[_0xe32209(0x140)]+')')['join']('\x0a'),_0x426851=_0xe32209(0x16a)+_0x3041ed+_0xe32209(0x136)+_0x475f66+'\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x3e68db=await _0x7925b0[_0xe32209(0x177)]['generateContent'](_0x426851),_0x3f2489=_0x3e68db['response']['text'](),_0x3f8579=_0xeabb87===_0xe32209(0x14e)?'analysis.health.geminiNight':_0xe32209(0x12c);await _0x7925b0[_0xe32209(0x116)](_0x3f8579,{'val':_0x3f2489,'ack':!![]}),_0x7925b0[_0xe32209(0x179)]['info'](_0xe32209(0x16f)+_0xeabb87+_0xe32209(0x123));}catch(_0x408b95){_0x7925b0['log'][_0xe32209(0x15d)](_0xe32209(0x139)+_0x408b95['message']);}}function a0_0x2673(_0x33dc1a,_0x574fd3){const _0x4a76b6=a0_0x2ce6();return a0_0x2673=function(_0x37a557,_0x5b873b){_0x37a557=_0x37a557-0x111;let _0x2ce6af=_0x4a76b6[_0x37a557];return _0x2ce6af;},a0_0x2673(_0x33dc1a,_0x574fd3);}module[a0_0xe3dbac(0x151)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};