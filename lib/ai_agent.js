const a0_0x355ad8=a0_0x45fa;(function(_0x58ef2e,_0x38dad9){const _0x59e068=a0_0x45fa,_0x27ea64=_0x58ef2e();while(!![]){try{const _0x155d56=parseInt(_0x59e068(0x1d9))/0x1+-parseInt(_0x59e068(0x15a))/0x2+parseInt(_0x59e068(0x1d4))/0x3+parseInt(_0x59e068(0x1c4))/0x4+-parseInt(_0x59e068(0x186))/0x5*(parseInt(_0x59e068(0x1cb))/0x6)+parseInt(_0x59e068(0x1e1))/0x7+parseInt(_0x59e068(0x1ba))/0x8*(-parseInt(_0x59e068(0x1ef))/0x9);if(_0x155d56===_0x38dad9)break;else _0x27ea64['push'](_0x27ea64['shift']());}catch(_0x12ac6d){_0x27ea64['push'](_0x27ea64['shift']());}}}(a0_0x2e27,0x75bc7));const a0_0x3b9f30=(function(){let _0x491c63=!![];return function(_0x314a24,_0x4abbc9){const _0x5bb9ba=_0x491c63?function(){const _0x29d480=a0_0x45fa;if(_0x4abbc9){const _0x27d55e=_0x4abbc9[_0x29d480(0x17d)](_0x314a24,arguments);return _0x4abbc9=null,_0x27d55e;}}:function(){};return _0x491c63=![],_0x5bb9ba;};}()),a0_0x4f5849=a0_0x3b9f30(this,function(){const _0x2f44f7=a0_0x45fa;return a0_0x4f5849[_0x2f44f7(0x1b4)]()[_0x2f44f7(0x1a3)](_0x2f44f7(0x1d8))[_0x2f44f7(0x1b4)]()[_0x2f44f7(0x175)](a0_0x4f5849)['search'](_0x2f44f7(0x1d8));});a0_0x4f5849();function a0_0x2e27(){const _0x1b992b=['%)\x20nach\x20\x22','ðŸŒ…\x20Morning\x20Briefing:\x0a','.Current.Temperature','toString','Success','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','activityLevel','setForeignStateAsync','16KPpBap',',\x20Wetter:\x20','getTime','Skipped\x20(Traffic)','âš ï¸\x20ALARM:\x20','toFixed','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','lastAlertState','push','2074064vNnlOy','setStateAsync','\x20->\x20','ANALYZE_HEALTH','analysis.health.geminiDay','ðŸ¤–\x20Health\x20Report\x20(','log','6hpWMBS','aiPersona','now','baselineDrift','analysis.health.geminiNight','Digest','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.\x20KONTEXT:\x20','replace','590157SBXRdS','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','LTM.processingStatus','KI\x20offline\x20(Fallback)','(((.+)+)+)+$','939591houDSX','toLocaleTimeString','length','\x0aAktivitÃ¤t:\x20','getStateAsync','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','LTM.rawEventLog','filter','1108877LklwWA','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','analysis.activitySummary','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','timestamp','LTM.dailyDigests','summary','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','@google/generative-ai','analysis.automation.targetId','Wetterdaten\x20nicht\x20abrufbar','ltmLtbWindowDays','slice','trim','2612466roJigt','analysis.automation.targetValue','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','name','toISOString','livingContext','val','Briefing\x20Error:\x20','\x0aSTB:\x20','2-digit','Unbekannt\x20(Kein\x20Sensor)','96372yMqtOB','dailyDigests','Sicherheit\x20geht\x20vor.','rawEventLog','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','warn','LTM.driftAnalysis.driftDetails','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','analysisHistory','LTM.driftAnalysis.baselineDrift','./setup','Started...',')\x20generated.','.\x20EVENTS:\x20','getForeignStateAsync','\x20=\x20','targetValue','Â°C,\x20','.\x20ANWESEND:\x20','setHours','targetId','splice','Traffic-Schutz\x20(Auto-Approved)','description','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','weatherInstance','constructor','decision','detected','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','eventHistory','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','debug','config','apply','send','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','info','value','analysis.automation.description','sendNotification','driftDetails','currentSystemMode','3511280liPdZv','useWeather','approved','Health\x20Report\x20Error:\x20','analysis.automation.autoApply','stringify','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','isAlert',',\x20LichtverhÃ¤ltnisse:\x20','Nacht','parse','Unbekannt','isProVersion','models/gemini-flash-latest','map','BUTLER\x20Execution\x20Error:\x20','unshift','KI-Fehler\x20(Fallback)','Skipped\x20(No\x20AI\x20or\x20Data)','LTM.driftAnalysis.lastCheck','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','automationProposal','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','geminiModel','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','alertReason','system.presenceWho','isEmergency','search','analysis.lastResult','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','NIGHT','\x0a\x20\x20\x20\x20EVENTS:\x0a','response','.\x20SYSTEM_MODE:\x20','error','generateContent','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','text','generic','Tag','message'];a0_0x2e27=function(){return _0x1b992b;};return a0_0x2e27();}'use strict';const {GoogleGenerativeAI}=require(a0_0x355ad8(0x1e9)),setup=require(a0_0x355ad8(0x165)),GEMINI_MODEL=a0_0x355ad8(0x193),LTM_DP_DAILY_DIGESTS=a0_0x355ad8(0x1e6),LTM_DP_STATUS=a0_0x355ad8(0x1d6),LTM_DP_RAW_LOG=a0_0x355ad8(0x1df),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x355ad8(0x19d),'senior_aal':a0_0x355ad8(0x173),'family':a0_0x355ad8(0x15e),'single_comfort':a0_0x355ad8(0x1c0),'security':a0_0x355ad8(0x15c),'energy_saver':a0_0x355ad8(0x178)};function canCallApi(){const _0x24f03f=Date['now']();return _0x24f03f-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){lastGlobalApiCall=Date['now']();}async function getWeatherContext(_0x5265d2){const _0x3e71df=a0_0x355ad8;if(!_0x5265d2['config'][_0x3e71df(0x187)]||!_0x5265d2[_0x3e71df(0x17c)][_0x3e71df(0x174)])return _0x3e71df(0x159);try{const _0x5574f4=_0x5265d2[_0x3e71df(0x17c)][_0x3e71df(0x174)];let _0x195f25=await _0x5265d2[_0x3e71df(0x169)](_0x5574f4+_0x3e71df(0x1b3));if(!_0x195f25)_0x195f25=await _0x5265d2['getForeignStateAsync'](_0x5574f4+'.forecast.current.temperature');let _0x11f669=await _0x5265d2[_0x3e71df(0x169)](_0x5574f4+'.Current.WeatherText');if(!_0x11f669)_0x11f669=await _0x5265d2['getForeignStateAsync'](_0x5574f4+'.forecast.current.state');let _0x54c182='Unbekannt';const _0x564a7b=await _0x5265d2[_0x3e71df(0x169)](_0x5574f4+'.Current.IsNight');if(_0x564a7b)_0x54c182=_0x564a7b[_0x3e71df(0x1f5)]?_0x3e71df(0x18f):_0x3e71df(0x1af);if(_0x195f25&&_0x11f669)return _0x195f25[_0x3e71df(0x1f5)]+_0x3e71df(0x16c)+_0x11f669['val']+_0x3e71df(0x18e)+_0x54c182;}catch(_0x14bae8){}return _0x3e71df(0x1eb);}async function consultButler(_0x293a79,_0x5b9410,_0x357f79,_0xa9b4ae){const _0x186f41=a0_0x355ad8;if(!_0x293a79['geminiModel'])return{'approved':!![],'reason':_0x186f41(0x1d7)};const _0x783ba3=Date[_0x186f41(0x1cd)]();if(decisionCache[_0x5b9410]&&_0x783ba3-decisionCache[_0x5b9410][_0x186f41(0x1e5)]<CACHE_TTL_MS){const _0x3bb647=decisionCache[_0x5b9410][_0x186f41(0x176)];return _0x293a79[_0x186f41(0x1ca)][_0x186f41(0x17b)](_0x186f41(0x1de)+_0x5b9410+_0x186f41(0x1c6)+(_0x3bb647[_0x186f41(0x188)]?'OK':'NO')+'\x20('+_0x3bb647['reason']+')'),_0x3bb647;}if(!canCallApi())return _0x293a79[_0x186f41(0x1ca)][_0x186f41(0x17b)](_0x186f41(0x18c)+_0x5b9410+'\x20Ã¼bersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x186f41(0x171)};const _0x895dd9=new Date()[_0x186f41(0x1da)](),_0x1dc874=await getWeatherContext(_0x293a79),_0x45d0cf=PERSONA_MAPPING[_0x293a79[_0x186f41(0x17c)][_0x186f41(0x1cc)]||'generic'],_0x4306ac=_0x186f41(0x1e2)+_0x895dd9+_0x186f41(0x1bb)+_0x1dc874+_0x186f41(0x162)+(_0xa9b4ae*0x64)[_0x186f41(0x1bf)](0x0)+_0x186f41(0x1b1)+_0x5b9410+'\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22'+_0x357f79+_0x186f41(0x19f)+_0x45d0cf+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x47c2fc=await _0x293a79[_0x186f41(0x19e)][_0x186f41(0x1ab)](_0x4306ac),_0x2f47db=_0x47c2fc[_0x186f41(0x1a8)][_0x186f41(0x1ad)]()[_0x186f41(0x1d3)](/```json|```/g,'')[_0x186f41(0x1ee)](),_0xb571a4=JSON[_0x186f41(0x190)](_0x2f47db);return decisionCache[_0x5b9410]={'decision':_0xb571a4,'timestamp':_0x783ba3},_0xb571a4;}catch(_0x54eeb5){return _0x293a79[_0x186f41(0x1ca)][_0x186f41(0x15f)]('ðŸ¤–\x20Butler\x20Brain\x20Error:\x20'+_0x54eeb5['message']),decisionCache[_0x5b9410]={'decision':{'approved':!![],'reason':_0x186f41(0x197)},'timestamp':_0x783ba3-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x186f41(0x197)};}}async function runGeminiAnalysis(_0x872bf,_0xb473a8=''){const _0x5df5d4=a0_0x355ad8;if(!_0x872bf[_0x5df5d4(0x19e)])return;if(!canCallApi()){_0x872bf['log'][_0x5df5d4(0x17b)](_0x5df5d4(0x19b));return;}if(_0x872bf[_0x5df5d4(0x179)]['length']===0x0)return;const _0x4d4634=_0x872bf['eventHistory']['slice'](0x0,0xf),_0x28c8ae=_0x872bf[_0x5df5d4(0x185)],_0x274687=PERSONA_MAPPING[_0x872bf[_0x5df5d4(0x17c)][_0x5df5d4(0x1cc)]||_0x5df5d4(0x1ae)],_0xc00c71=_0x872bf['config'][_0x5df5d4(0x1f4)]||'Keine\x20Details.';let _0x24c87b=_0x5df5d4(0x191);try{const _0x3fe74a=await _0x872bf['getStateAsync'](_0x5df5d4(0x1a1));if(_0x3fe74a&&_0x3fe74a[_0x5df5d4(0x1f5)])_0x24c87b=_0x3fe74a[_0x5df5d4(0x1f5)];}catch(_0x54c27b){}let _0x391158=![];try{const _0x4d1ec4=await _0x872bf['getStateAsync'](_0x5df5d4(0x18a));if(_0x4d1ec4&&_0x4d1ec4[_0x5df5d4(0x1f5)])_0x391158=!![];}catch(_0x19e7f1){}const _0x1d1482=_0x5df5d4(0x1c1)+_0x274687+_0x5df5d4(0x1d2)+_0xc00c71+_0x5df5d4(0x1a9)+_0x28c8ae+_0x5df5d4(0x16d)+_0x24c87b+_0x5df5d4(0x168)+JSON['stringify'](_0x4d4634)+'.\x20EMERGENCY:\x20'+_0xb473a8+_0x5df5d4(0x1e4);try{updateApiTimestamp();const _0x407ac8=await _0x872bf[_0x5df5d4(0x19e)][_0x5df5d4(0x1ab)](_0x1d1482),_0x17acb8=JSON[_0x5df5d4(0x190)](_0x407ac8[_0x5df5d4(0x1a8)][_0x5df5d4(0x1ad)]()[_0x5df5d4(0x1d3)](/```json|```/g,'')[_0x5df5d4(0x1ee)]());await _0x872bf[_0x5df5d4(0x1c5)](_0x5df5d4(0x1a4),{'val':JSON['stringify'](_0x17acb8),'ack':!![]});if(_0x17acb8[_0x5df5d4(0x1e7)])await _0x872bf['setStateAsync'](_0x5df5d4(0x1e3),{'val':_0x17acb8[_0x5df5d4(0x1e7)],'ack':!![]});const _0x386f16={'timestamp':Date['now'](),'id':Date[_0x5df5d4(0x1cd)]()['toString'](),'analysis':{'activity':{'summary':_0x17acb8[_0x5df5d4(0x1e7)],'isAlert':_0x17acb8[_0x5df5d4(0x18d)],'alertReason':_0x17acb8[_0x5df5d4(0x1a0)]},'comfort':{'automationProposal':_0x17acb8['automationProposal']}}};_0x872bf[_0x5df5d4(0x163)][_0x5df5d4(0x196)](_0x386f16);if(_0x872bf['analysisHistory'][_0x5df5d4(0x1db)]>0x32)_0x872bf[_0x5df5d4(0x163)]['pop']();await _0x872bf['setStateAsync']('analysis.analysisHistory',{'val':JSON[_0x5df5d4(0x18b)](_0x872bf['analysisHistory']),'ack':!![]});const _0x846c0b=_0x17acb8[_0x5df5d4(0x18d)]||![];_0x846c0b!==_0x872bf[_0x5df5d4(0x1c2)]&&(await _0x872bf[_0x5df5d4(0x1c5)]('analysis.isAlert',{'val':_0x846c0b,'ack':!![]}),_0x872bf[_0x5df5d4(0x1c2)]=_0x846c0b,_0x846c0b&&(await _0x872bf['setStateAsync']('analysis.alertReason',{'val':_0x17acb8[_0x5df5d4(0x1a0)],'ack':!![]}),setup['sendNotification'](_0x872bf,_0x5df5d4(0x1be)+_0x17acb8[_0x5df5d4(0x1a0)],![],_0x17acb8[_0x5df5d4(0x1a2)])));if(_0x17acb8[_0x5df5d4(0x19c)]&&_0x17acb8['automationProposal'][_0x5df5d4(0x177)]){await _0x872bf[_0x5df5d4(0x1c5)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x872bf[_0x5df5d4(0x1c5)](_0x5df5d4(0x182),{'val':_0x17acb8[_0x5df5d4(0x19c)][_0x5df5d4(0x172)],'ack':!![]}),await _0x872bf['setStateAsync'](_0x5df5d4(0x1ea),{'val':_0x17acb8['automationProposal'][_0x5df5d4(0x16f)],'ack':!![]}),await _0x872bf['setStateAsync'](_0x5df5d4(0x1f0),{'val':JSON[_0x5df5d4(0x18b)](_0x17acb8[_0x5df5d4(0x19c)][_0x5df5d4(0x16b)]),'ack':!![]});if(_0x391158)executeAutomationAction(_0x872bf);}}catch(_0x3dcb9b){_0x872bf[_0x5df5d4(0x1ca)][_0x5df5d4(0x1aa)]('Gemini\x20Error:\x20'+_0x3dcb9b['message']);}}async function createDailyDigest(_0x18f8fb,_0x4abe8f){const _0x5ec6ac=a0_0x355ad8;if(!_0x18f8fb[_0x5ec6ac(0x192)])return;if(!canCallApi()){await _0x18f8fb[_0x5ec6ac(0x1c5)](LTM_DP_STATUS,{'val':_0x5ec6ac(0x1bd),'ack':!![]});return;}await _0x18f8fb[_0x5ec6ac(0x1c5)](LTM_DP_STATUS,{'val':_0x5ec6ac(0x166),'ack':!![]});if(!_0x18f8fb[_0x5ec6ac(0x19e)]||_0x18f8fb[_0x5ec6ac(0x15d)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x18f8fb[_0x5ec6ac(0x1c5)](LTM_DP_STATUS,{'val':_0x5ec6ac(0x198),'ack':!![]});return;}const _0x47e059=JSON[_0x5ec6ac(0x190)](JSON[_0x5ec6ac(0x18b)](_0x18f8fb['rawEventLog'])),_0x266616=_0x47e059['length'],_0xeed934=_0x5ec6ac(0x1d1)+JSON[_0x5ec6ac(0x18b)](_0x47e059);try{updateApiTimestamp();const _0x598cdd=await _0x18f8fb[_0x5ec6ac(0x19e)][_0x5ec6ac(0x1ab)](_0xeed934),_0x3ace38=JSON[_0x5ec6ac(0x190)](_0x598cdd['response'][_0x5ec6ac(0x1ad)]()[_0x5ec6ac(0x1d3)](/```json|```/g,'')['trim']()),_0x1c4070={'timestamp':new Date()[_0x5ec6ac(0x1f3)](),'eventCount':_0x266616,'summary':_0x3ace38[_0x5ec6ac(0x1e7)]||_0x5ec6ac(0x1d0),'activityLevel':_0x3ace38['activityLevel']||'normal','systemMode':_0x18f8fb['currentSystemMode']};_0x18f8fb['dailyDigests'][_0x5ec6ac(0x1c3)](_0x1c4070);const _0x43c594=_0x18f8fb[_0x5ec6ac(0x17c)][_0x5ec6ac(0x1ec)]||0x3c;_0x18f8fb[_0x5ec6ac(0x15b)]['length']>_0x43c594&&_0x18f8fb['dailyDigests'][_0x5ec6ac(0x170)](0x0,_0x18f8fb[_0x5ec6ac(0x15b)][_0x5ec6ac(0x1db)]-_0x43c594);await _0x18f8fb[_0x5ec6ac(0x1c5)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5ec6ac(0x18b)](_0x18f8fb[_0x5ec6ac(0x15b)]),'ack':!![]}),_0x18f8fb[_0x5ec6ac(0x15d)]=[],await _0x18f8fb['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x18f8fb['rawEventLog']),'ack':!![]}),await _0x18f8fb[_0x5ec6ac(0x1c5)](LTM_DP_STATUS,{'val':_0x5ec6ac(0x1b5),'ack':!![]});const _0x847867='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x3ace38[_0x5ec6ac(0x1e7)]+_0x5ec6ac(0x1dc)+_0x3ace38[_0x5ec6ac(0x1b8)];setup[_0x5ec6ac(0x183)](_0x18f8fb,_0x847867,![],![]);if(_0x18f8fb['isProVersion']&&_0x4abe8f)_0x4abe8f[_0x5ec6ac(0x17e)](_0x18f8fb,_0x5ec6ac(0x1c7),{'digest':_0x1c4070});}catch(_0x10a7e7){_0x18f8fb[_0x5ec6ac(0x1ca)][_0x5ec6ac(0x1aa)](_0x10a7e7['message']);}}async function runBaselineDriftAnalysis(_0x5949f9){const _0x10ce27=a0_0x355ad8;if(!_0x5949f9[_0x10ce27(0x192)]||!_0x5949f9['geminiModel'])return;if(!canCallApi())return;const _0x2b9684=_0x5949f9[_0x10ce27(0x17c)]['ltmStbWindowDays']||0xe;if(_0x5949f9[_0x10ce27(0x15b)][_0x10ce27(0x1db)]<_0x2b9684+0x7){await _0x5949f9[_0x10ce27(0x1c5)](_0x10ce27(0x164),{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x4d2561=_0x5949f9['dailyDigests'][_0x10ce27(0x1ed)](-_0x2b9684),_0x742dfb=_0x5949f9[_0x10ce27(0x15b)][_0x10ce27(0x1ed)](0x0,_0x5949f9['dailyDigests']['length']-_0x2b9684),_0x4de0c3=_0x10ce27(0x1e8)+JSON[_0x10ce27(0x18b)](_0x742dfb)+_0x10ce27(0x1f7)+JSON[_0x10ce27(0x18b)](_0x4d2561);try{updateApiTimestamp();const _0x5b56ce=await _0x5949f9[_0x10ce27(0x19e)][_0x10ce27(0x1ab)](_0x4de0c3),_0x2a973f=JSON[_0x10ce27(0x190)](_0x5b56ce['response'][_0x10ce27(0x1ad)]()[_0x10ce27(0x1d3)](/```json|```/g,'')[_0x10ce27(0x1ee)]());_0x2a973f[_0x10ce27(0x1ce)]&&(await _0x5949f9[_0x10ce27(0x1c5)](_0x10ce27(0x164),{'val':_0x2a973f[_0x10ce27(0x1ce)],'ack':!![]}),await _0x5949f9[_0x10ce27(0x1c5)](_0x10ce27(0x160),{'val':_0x2a973f[_0x10ce27(0x184)],'ack':!![]}),await _0x5949f9[_0x10ce27(0x1c5)](_0x10ce27(0x199),{'val':Date[_0x10ce27(0x1cd)](),'ack':!![]}));}catch(_0x44523d){}}async function executeAutomationAction(_0x1f636f){const _0xf39dc8=a0_0x355ad8;try{const _0x488931=await _0x1f636f[_0xf39dc8(0x1dd)](_0xf39dc8(0x1ea)),_0xb62b45=await _0x1f636f[_0xf39dc8(0x1dd)](_0xf39dc8(0x1f0));if(_0x488931&&_0x488931['val']&&_0xb62b45){const _0x1145cc=_0x488931[_0xf39dc8(0x1f5)];let _0x3e3549=_0xb62b45[_0xf39dc8(0x1f5)];try{_0x3e3549=JSON['parse'](_0x3e3549);}catch(_0x588833){}_0x1f636f[_0xf39dc8(0x1ca)]['info'](_0xf39dc8(0x1a5)+_0x1145cc+_0xf39dc8(0x16a)+_0x3e3549),await _0x1f636f[_0xf39dc8(0x1b9)](_0x1145cc,_0x3e3549);}else _0x1f636f[_0xf39dc8(0x1ca)][_0xf39dc8(0x15f)](_0xf39dc8(0x19a));}catch(_0x3776d4){_0x1f636f['log'][_0xf39dc8(0x1aa)](_0xf39dc8(0x195)+_0x3776d4[_0xf39dc8(0x1b0)]);}}function a0_0x45fa(_0x1a7cd1,_0x3feda4){const _0x4c670=a0_0x2e27();return a0_0x45fa=function(_0x4f5849,_0x3b9f30){_0x4f5849=_0x4f5849-0x159;let _0x2e278b=_0x4c670[_0x4f5849];return _0x2e278b;},a0_0x45fa(_0x1a7cd1,_0x3feda4);}async function sendMorningBriefing(_0x4317a9){const _0xe10775=a0_0x355ad8;if(!_0x4317a9['geminiModel']){_0x4317a9[_0xe10775(0x1ca)]['warn'](_0xe10775(0x1b7));return;}_0x4317a9[_0xe10775(0x1ca)][_0xe10775(0x180)]('ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x214ea3='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0xb61d17=await _0x4317a9[_0xe10775(0x19e)]['generateContent'](_0x214ea3),_0x1f3b9a=_0xb61d17[_0xe10775(0x1a8)][_0xe10775(0x1ad)]();_0x4317a9[_0xe10775(0x1ca)][_0xe10775(0x180)](_0xe10775(0x1b6)+_0x1f3b9a[_0xe10775(0x1db)]+').\x20Sending\x20notification...'),setup[_0xe10775(0x183)](_0x4317a9,_0xe10775(0x1b2)+_0x1f3b9a);}catch(_0x5acc10){_0x4317a9[_0xe10775(0x1ca)][_0xe10775(0x1aa)](_0xe10775(0x1f6)+_0x5acc10[_0xe10775(0x1b0)]);}}async function generateHealthReport(_0x3fb822,_0x54a2f3){const _0x2c9cd9=a0_0x355ad8;if(!_0x3fb822['geminiModel'])return;const _0xf2ba07=Date[_0x2c9cd9(0x1cd)]();_0xf2ba07-lastGlobalApiCall<0xbb8&&(_0x3fb822['log'][_0x2c9cd9(0x17b)](_0x2c9cd9(0x161)),await new Promise(_0x4222a7=>setTimeout(_0x4222a7,0x7d0)));const _0x16e2f9=new Date();let _0x5b33b4=0x0,_0xeffde4=_0x16e2f9[_0x2c9cd9(0x1bc)](),_0x2c5daf='';if(_0x54a2f3===_0x2c9cd9(0x1a6)){const _0x3414eb=new Date(_0x16e2f9);_0x3414eb['setDate'](_0x3414eb['getDate']()-0x1),_0x3414eb[_0x2c9cd9(0x16e)](0x16,0x0,0x0,0x0),_0x5b33b4=_0x3414eb[_0x2c9cd9(0x1bc)]();const _0x166739=new Date(_0x16e2f9);_0x166739['setHours'](0x8,0x0,0x0,0x0),_0xeffde4=_0x166739['getTime'](),_0x2c5daf=_0x2c9cd9(0x17a);}else{const _0x5bd22b=new Date(_0x16e2f9);_0x5bd22b[_0x2c9cd9(0x16e)](0x8,0x0,0x0,0x0),_0x5b33b4=_0x5bd22b['getTime'](),_0x2c5daf=_0x2c9cd9(0x17f);}const _0x358365=_0x3fb822[_0x2c9cd9(0x179)][_0x2c9cd9(0x1e0)](_0x2fe953=>_0x2fe953[_0x2c9cd9(0x1e5)]>=_0x5b33b4&&_0x2fe953[_0x2c9cd9(0x1e5)]<=_0xeffde4);if(_0x358365['length']===0x0){const _0x368320=_0x54a2f3===_0x2c9cd9(0x1a6)?_0x2c9cd9(0x1f1):_0x2c9cd9(0x1d5),_0x85641=_0x54a2f3===_0x2c9cd9(0x1a6)?'analysis.health.geminiNight':_0x2c9cd9(0x1c8);await _0x3fb822[_0x2c9cd9(0x1c5)](_0x85641,{'val':_0x368320,'ack':!![]});return;}const _0xc03308=_0x358365[_0x2c9cd9(0x194)](_0x31380a=>new Date(_0x31380a[_0x2c9cd9(0x1e5)])['toLocaleTimeString']([],{'hour':_0x2c9cd9(0x1f8),'minute':'2-digit'})+'\x20'+_0x31380a[_0x2c9cd9(0x1f2)]+'\x20('+_0x31380a[_0x2c9cd9(0x181)]+')')['join']('\x0a'),_0x9a173c='\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20'+_0x2c5daf+_0x2c9cd9(0x1a7)+_0xc03308+_0x2c9cd9(0x1ac);try{updateApiTimestamp();const _0x149a35=await _0x3fb822['geminiModel']['generateContent'](_0x9a173c),_0x2d58ad=_0x149a35[_0x2c9cd9(0x1a8)][_0x2c9cd9(0x1ad)](),_0x545f90=_0x54a2f3==='NIGHT'?_0x2c9cd9(0x1cf):_0x2c9cd9(0x1c8);await _0x3fb822[_0x2c9cd9(0x1c5)](_0x545f90,{'val':_0x2d58ad,'ack':!![]}),_0x3fb822[_0x2c9cd9(0x1ca)][_0x2c9cd9(0x180)](_0x2c9cd9(0x1c9)+_0x54a2f3+_0x2c9cd9(0x167));}catch(_0x7770bd){_0x3fb822[_0x2c9cd9(0x1ca)]['error'](_0x2c9cd9(0x189)+_0x7770bd[_0x2c9cd9(0x1b0)]);}}module['exports']={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};