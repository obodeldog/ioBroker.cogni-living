function a0_0x5f43(){const _0x1a4b2d=['.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','ltmLtbWindowDays','getForeignStateAsync','splice','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','debug','search',',\x20LichtverhÃ¤ltnisse:\x20','val','analysis.health.geminiDay','analysis.automation.patternDetected','Sicherheit\x20geht\x20vor.','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','sendNotification','LTM.driftAnalysis.lastCheck','Wetterdaten\x20nicht\x20abrufbar','BUTLER\x20Execution\x20Error:\x20','analysis.alertReason','currentSystemMode','lastAlertState','getTime','\x0aAktivitÃ¤t:\x20','LTM.rawEventLog','Nacht','(((.+)+)+)+$','NIGHT','.forecast.current.state','push','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','models/gemini-flash-latest','Skipped\x20(Traffic)','rawEventLog','LTM.driftAnalysis.baselineDrift','response','constructor','generateContent','alertReason','110wEFcGV','@google/generative-ai','Traffic-Schutz\x20(Auto-Approved)','analysis.automation.targetValue','automationProposal','8682CzEAPH','KI-Fehler\x20(Fallback)','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','Unbekannt','KI\x20offline\x20(Fallback)','driftDetails','analysis.health.geminiNight','9CtXJlD','analysis.automation.description','trim','setStateAsync','dailyDigests','isAlert','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','unshift','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','analysis.analysisHistory','\x20=\x20','map','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','analysisHistory','toFixed','\x0a\x20\x20\x20\x20EVENTS:\x0a','365388DBlgvI','âš ï¸\x20ALARM:\x20','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','Keine\x20Details.','getStateAsync','.Current.Temperature','summary','Tag','%)\x20nach\x20\x22','system.presenceWho','ANALYZE_HEALTH','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','isEmergency','parse','slice','text','817404vPvwgB','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','ðŸŒ…\x20Morning\x20Briefing:\x0a','send','pop','length','Unbekannt\x20(Kein\x20Sensor)','analysis.lastResult','targetId','ðŸ¤–\x20Health\x20Report\x20(','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','.\x20EMERGENCY:\x20','LTM.dailyDigests','9927QhXqDO','analysis.automation.targetId','.\x20SYSTEM_MODE:\x20','setForeignStateAsync',')\x20generated.','266lZsoHq','stringify','eventHistory','Skipped\x20(No\x20AI\x20or\x20Data)','exports','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','LTM.processingStatus','timestamp','error','warn','Briefing\x20Error:\x20',',\x20Wetter:\x20','\x0aSTB:\x20','2-digit','activityLevel','.forecast.current.temperature','Digest','1173192kIgdiH','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','ltmStbWindowDays','detected','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','weatherInstance','generic','join','Gemini\x20Error:\x20','.\x20EVENTS:\x20','description','config','Â°C,\x20','baselineDrift','535zjtbEC','analysis.activitySummary','log','value','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','aiPersona','normal','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','replace','3142912XpCpPl','reason','apply','info','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','message','filter','toString','useWeather','14eEkUFl','now','name','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','2000860GNcApd','geminiModel','isProVersion','targetValue','.Current.WeatherText',').\x20Sending\x20notification...','setHours','analysis.isAlert','.\x20ANWESEND:\x20','getDate','.\x20KONTEXT:\x20'];a0_0x5f43=function(){return _0x1a4b2d;};return a0_0x5f43();}const a0_0x1b28df=a0_0x5f23;(function(_0x37d803,_0x5acd02){const _0x17107c=a0_0x5f23,_0x570296=_0x37d803();while(!![]){try{const _0x566db4=-parseInt(_0x17107c(0xe3))/0x1+parseInt(_0x17107c(0x106))/0x2*(parseInt(_0x17107c(0x101))/0x3)+parseInt(_0x17107c(0x117))/0x4+-parseInt(_0x17107c(0x125))/0x5*(-parseInt(_0x17107c(0xcb))/0x6)+-parseInt(_0x17107c(0x137))/0x7*(-parseInt(_0x17107c(0x12e))/0x8)+-parseInt(_0x17107c(0xd3))/0x9*(parseInt(_0x17107c(0x13b))/0xa)+parseInt(_0x17107c(0xc6))/0xb*(-parseInt(_0x17107c(0xf4))/0xc);if(_0x566db4===_0x5acd02)break;else _0x570296['push'](_0x570296['shift']());}catch(_0x3f5584){_0x570296['push'](_0x570296['shift']());}}}(a0_0x5f43,0x6852c));const a0_0x4a0e85=(function(){let _0x289400=!![];return function(_0x2267dd,_0x1dd54a){const _0x60a26=_0x289400?function(){const _0x5b8f7e=a0_0x5f23;if(_0x1dd54a){const _0x555523=_0x1dd54a[_0x5b8f7e(0x130)](_0x2267dd,arguments);return _0x1dd54a=null,_0x555523;}}:function(){};return _0x289400=![],_0x60a26;};}()),a0_0x1cd558=a0_0x4a0e85(this,function(){const _0x5e2a13=a0_0x5f23;return a0_0x1cd558[_0x5e2a13(0x135)]()[_0x5e2a13(0x14c)](_0x5e2a13(0xb9))['toString']()[_0x5e2a13(0xc3)](a0_0x1cd558)['search']('(((.+)+)+)+$');});a0_0x1cd558();'use strict';const {GoogleGenerativeAI}=require(a0_0x1b28df(0xc7)),setup=require('./setup'),GEMINI_MODEL=a0_0x1b28df(0xbe),LTM_DP_DAILY_DIGESTS=a0_0x1b28df(0x100),LTM_DP_STATUS=a0_0x1b28df(0x10c),LTM_DP_RAW_LOG=a0_0x1b28df(0xb7),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x1b28df(0x11b),'senior_aal':a0_0x1b28df(0xdb),'family':'Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','single_comfort':'Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','security':a0_0x1b28df(0x151),'energy_saver':a0_0x1b28df(0x13a)};function canCallApi(){const _0x1bef45=a0_0x1b28df,_0x2c68b8=Date[_0x1bef45(0x138)]();return _0x2c68b8-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x39fb9f=a0_0x1b28df;lastGlobalApiCall=Date[_0x39fb9f(0x138)]();}async function getWeatherContext(_0x31cd6b){const _0x388fc1=a0_0x1b28df;if(!_0x31cd6b[_0x388fc1(0x122)][_0x388fc1(0x136)]||!_0x31cd6b[_0x388fc1(0x122)][_0x388fc1(0x11c)])return _0x388fc1(0xfa);try{const _0x4dbf6c=_0x31cd6b[_0x388fc1(0x122)][_0x388fc1(0x11c)];let _0x17f85a=await _0x31cd6b['getForeignStateAsync'](_0x4dbf6c+_0x388fc1(0xe8));if(!_0x17f85a)_0x17f85a=await _0x31cd6b[_0x388fc1(0x148)](_0x4dbf6c+_0x388fc1(0x115));let _0x547fce=await _0x31cd6b[_0x388fc1(0x148)](_0x4dbf6c+_0x388fc1(0x13f));if(!_0x547fce)_0x547fce=await _0x31cd6b[_0x388fc1(0x148)](_0x4dbf6c+_0x388fc1(0xbb));let _0x1733d2=_0x388fc1(0xcf);const _0x417c64=await _0x31cd6b['getForeignStateAsync'](_0x4dbf6c+'.Current.IsNight');if(_0x417c64)_0x1733d2=_0x417c64[_0x388fc1(0x14e)]?_0x388fc1(0xb8):_0x388fc1(0xea);if(_0x17f85a&&_0x547fce)return _0x17f85a[_0x388fc1(0x14e)]+_0x388fc1(0x123)+_0x547fce[_0x388fc1(0x14e)]+_0x388fc1(0x14d)+_0x1733d2;}catch(_0xb51e0a){}return _0x388fc1(0x156);}function a0_0x5f23(_0x5e5fd2,_0x32f175){const _0x31b526=a0_0x5f43();return a0_0x5f23=function(_0x1cd558,_0x4a0e85){_0x1cd558=_0x1cd558-0xb1;let _0x5f43d5=_0x31b526[_0x1cd558];return _0x5f43d5;},a0_0x5f23(_0x5e5fd2,_0x32f175);}async function consultButler(_0x2e3486,_0x21e076,_0xfe365f,_0x5cc4b9){const _0x32aae0=a0_0x1b28df;if(!_0x2e3486['geminiModel'])return{'approved':!![],'reason':_0x32aae0(0xd0)};const _0x594b26=Date[_0x32aae0(0x138)]();if(decisionCache[_0x21e076]&&_0x594b26-decisionCache[_0x21e076][_0x32aae0(0x10d)]<CACHE_TTL_MS){const _0x3bde6d=decisionCache[_0x21e076]['decision'];return _0x2e3486[_0x32aae0(0x127)][_0x32aae0(0x14b)]('ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20'+_0x21e076+'\x20->\x20'+(_0x3bde6d['approved']?'OK':'NO')+'\x20('+_0x3bde6d[_0x32aae0(0x12f)]+')'),_0x3bde6d;}if(!canCallApi())return _0x2e3486[_0x32aae0(0x127)]['debug'](_0x32aae0(0xef)+_0x21e076+'\x20Ã¼bersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x32aae0(0xc8)};const _0x3b6e3d=new Date()['toLocaleTimeString'](),_0x4f596b=await getWeatherContext(_0x2e3486),_0x13e63b=PERSONA_MAPPING[_0x2e3486[_0x32aae0(0x122)][_0x32aae0(0x12a)]||_0x32aae0(0x11d)],_0x5019ce=_0x32aae0(0x12c)+_0x3b6e3d+_0x32aae0(0x111)+_0x4f596b+_0x32aae0(0x146)+(_0x5cc4b9*0x64)[_0x32aae0(0xe1)](0x0)+_0x32aae0(0xeb)+_0x21e076+_0x32aae0(0xdf)+_0xfe365f+_0x32aae0(0x132)+_0x13e63b+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x1259a5=await _0x2e3486[_0x32aae0(0x13c)][_0x32aae0(0xc4)](_0x5019ce),_0x56c658=_0x1259a5[_0x32aae0(0xc2)][_0x32aae0(0xf3)]()[_0x32aae0(0x12d)](/```json|```/g,'')[_0x32aae0(0xd5)](),_0x2bcad5=JSON[_0x32aae0(0xf1)](_0x56c658);return decisionCache[_0x21e076]={'decision':_0x2bcad5,'timestamp':_0x594b26},_0x2bcad5;}catch(_0x398925){return _0x2e3486[_0x32aae0(0x127)][_0x32aae0(0x10f)](_0x32aae0(0x152)+_0x398925['message']),decisionCache[_0x21e076]={'decision':{'approved':!![],'reason':_0x32aae0(0xcc)},'timestamp':_0x594b26-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x32aae0(0xcc)};}}async function runGeminiAnalysis(_0x6e00f0,_0x1dc654=''){const _0xd7dc8e=a0_0x1b28df;if(!_0x6e00f0[_0xd7dc8e(0x13c)])return;if(!canCallApi()){_0x6e00f0[_0xd7dc8e(0x127)][_0xd7dc8e(0x14b)]('ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x6e00f0[_0xd7dc8e(0x108)][_0xd7dc8e(0xf9)]===0x0)return;const _0x5dbf88=_0x6e00f0[_0xd7dc8e(0x108)][_0xd7dc8e(0xf2)](0x0,0xf),_0x4fa827=_0x6e00f0['currentSystemMode'],_0x5df7c8=PERSONA_MAPPING[_0x6e00f0['config'][_0xd7dc8e(0x12a)]||_0xd7dc8e(0x11d)],_0x27f3a3=_0x6e00f0[_0xd7dc8e(0x122)]['livingContext']||_0xd7dc8e(0xe6);let _0x5e032d=_0xd7dc8e(0xcf);try{const _0x4ed27e=await _0x6e00f0['getStateAsync'](_0xd7dc8e(0xec));if(_0x4ed27e&&_0x4ed27e[_0xd7dc8e(0x14e)])_0x5e032d=_0x4ed27e[_0xd7dc8e(0x14e)];}catch(_0x6bc9ad){}let _0x32fd51=![];try{const _0x40dbac=await _0x6e00f0['getStateAsync']('analysis.automation.autoApply');if(_0x40dbac&&_0x40dbac[_0xd7dc8e(0x14e)])_0x32fd51=!![];}catch(_0x5cc9e9){}const _0x5845a7=_0xd7dc8e(0xe5)+_0x5df7c8+_0xd7dc8e(0x145)+_0x27f3a3+_0xd7dc8e(0x103)+_0x4fa827+_0xd7dc8e(0x143)+_0x5e032d+_0xd7dc8e(0x120)+JSON[_0xd7dc8e(0x107)](_0x5dbf88)+_0xd7dc8e(0xff)+_0x1dc654+_0xd7dc8e(0xbd);try{updateApiTimestamp();const _0x416fd2=await _0x6e00f0['geminiModel'][_0xd7dc8e(0xc4)](_0x5845a7),_0x2787b1=JSON['parse'](_0x416fd2[_0xd7dc8e(0xc2)][_0xd7dc8e(0xf3)]()['replace'](/```json|```/g,'')[_0xd7dc8e(0xd5)]());await _0x6e00f0[_0xd7dc8e(0xd6)](_0xd7dc8e(0xfb),{'val':JSON[_0xd7dc8e(0x107)](_0x2787b1),'ack':!![]});if(_0x2787b1[_0xd7dc8e(0xe9)])await _0x6e00f0['setStateAsync'](_0xd7dc8e(0x126),{'val':_0x2787b1[_0xd7dc8e(0xe9)],'ack':!![]});const _0x2455df={'timestamp':Date[_0xd7dc8e(0x138)](),'id':Date['now']()['toString'](),'analysis':{'activity':{'summary':_0x2787b1[_0xd7dc8e(0xe9)],'isAlert':_0x2787b1[_0xd7dc8e(0xd8)],'alertReason':_0x2787b1['alertReason']},'comfort':{'automationProposal':_0x2787b1[_0xd7dc8e(0xca)]}}};_0x6e00f0['analysisHistory'][_0xd7dc8e(0xda)](_0x2455df);if(_0x6e00f0[_0xd7dc8e(0xe0)]['length']>0x32)_0x6e00f0[_0xd7dc8e(0xe0)][_0xd7dc8e(0xf8)]();await _0x6e00f0['setStateAsync'](_0xd7dc8e(0xdc),{'val':JSON['stringify'](_0x6e00f0[_0xd7dc8e(0xe0)]),'ack':!![]});const _0x3c5b72=_0x2787b1[_0xd7dc8e(0xd8)]||![];_0x3c5b72!==_0x6e00f0[_0xd7dc8e(0xb4)]&&(await _0x6e00f0['setStateAsync'](_0xd7dc8e(0x142),{'val':_0x3c5b72,'ack':!![]}),_0x6e00f0[_0xd7dc8e(0xb4)]=_0x3c5b72,_0x3c5b72&&(await _0x6e00f0[_0xd7dc8e(0xd6)](_0xd7dc8e(0xb2),{'val':_0x2787b1[_0xd7dc8e(0xc5)],'ack':!![]}),setup[_0xd7dc8e(0x154)](_0x6e00f0,_0xd7dc8e(0xe4)+_0x2787b1['alertReason'],![],_0x2787b1[_0xd7dc8e(0xf0)])));if(_0x2787b1['automationProposal']&&_0x2787b1[_0xd7dc8e(0xca)][_0xd7dc8e(0x11a)]){await _0x6e00f0['setStateAsync'](_0xd7dc8e(0x150),{'val':!![],'ack':!![]}),await _0x6e00f0[_0xd7dc8e(0xd6)](_0xd7dc8e(0xd4),{'val':_0x2787b1[_0xd7dc8e(0xca)][_0xd7dc8e(0x121)],'ack':!![]}),await _0x6e00f0[_0xd7dc8e(0xd6)]('analysis.automation.targetId',{'val':_0x2787b1['automationProposal'][_0xd7dc8e(0xfc)],'ack':!![]}),await _0x6e00f0[_0xd7dc8e(0xd6)](_0xd7dc8e(0xc9),{'val':JSON[_0xd7dc8e(0x107)](_0x2787b1['automationProposal'][_0xd7dc8e(0x13e)]),'ack':!![]});if(_0x32fd51)executeAutomationAction(_0x6e00f0);}}catch(_0x4e7bf1){_0x6e00f0[_0xd7dc8e(0x127)][_0xd7dc8e(0x10e)](_0xd7dc8e(0x11f)+_0x4e7bf1[_0xd7dc8e(0x133)]);}}async function createDailyDigest(_0x240865,_0x56184e){const _0x141026=a0_0x1b28df;if(!_0x240865['isProVersion'])return;if(!canCallApi()){await _0x240865['setStateAsync'](LTM_DP_STATUS,{'val':_0x141026(0xbf),'ack':!![]});return;}await _0x240865['setStateAsync'](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x240865[_0x141026(0x13c)]||_0x240865[_0x141026(0xc0)][_0x141026(0xf9)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x240865[_0x141026(0xd6)](LTM_DP_STATUS,{'val':_0x141026(0x109),'ack':!![]});return;}const _0x24a2d0=JSON['parse'](JSON[_0x141026(0x107)](_0x240865[_0x141026(0xc0)])),_0x23b6e6=_0x24a2d0['length'],_0x2b6a92='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x141026(0x107)](_0x24a2d0);try{updateApiTimestamp();const _0x5103ed=await _0x240865[_0x141026(0x13c)][_0x141026(0xc4)](_0x2b6a92),_0x33de99=JSON[_0x141026(0xf1)](_0x5103ed['response']['text']()[_0x141026(0x12d)](/```json|```/g,'')['trim']()),_0x4cf35b={'timestamp':new Date()['toISOString'](),'eventCount':_0x23b6e6,'summary':_0x33de99['summary']||_0x141026(0x116),'activityLevel':_0x33de99['activityLevel']||_0x141026(0x12b),'systemMode':_0x240865[_0x141026(0xb3)]};_0x240865[_0x141026(0xd7)][_0x141026(0xbc)](_0x4cf35b);const _0x7ec40b=_0x240865[_0x141026(0x122)][_0x141026(0x147)]||0x3c;_0x240865['dailyDigests'][_0x141026(0xf9)]>_0x7ec40b&&_0x240865[_0x141026(0xd7)][_0x141026(0x149)](0x0,_0x240865[_0x141026(0xd7)]['length']-_0x7ec40b);await _0x240865[_0x141026(0xd6)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x141026(0x107)](_0x240865[_0x141026(0xd7)]),'ack':!![]}),_0x240865[_0x141026(0xc0)]=[],await _0x240865[_0x141026(0xd6)](LTM_DP_RAW_LOG,{'val':JSON[_0x141026(0x107)](_0x240865[_0x141026(0xc0)]),'ack':!![]}),await _0x240865['setStateAsync'](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x2952c3='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x33de99[_0x141026(0xe9)]+_0x141026(0xb6)+_0x33de99[_0x141026(0x114)];setup[_0x141026(0x154)](_0x240865,_0x2952c3,![],![]);if(_0x240865['isProVersion']&&_0x56184e)_0x56184e[_0x141026(0xf7)](_0x240865,_0x141026(0xed),{'digest':_0x4cf35b});}catch(_0x5c58fb){_0x240865['log']['error'](_0x5c58fb[_0x141026(0x133)]);}}async function runBaselineDriftAnalysis(_0x154001){const _0x15a0bd=a0_0x1b28df;if(!_0x154001[_0x15a0bd(0x13d)]||!_0x154001[_0x15a0bd(0x13c)])return;if(!canCallApi())return;const _0x55e0d5=_0x154001['config'][_0x15a0bd(0x119)]||0xe;if(_0x154001[_0x15a0bd(0xd7)][_0x15a0bd(0xf9)]<_0x55e0d5+0x7){await _0x154001[_0x15a0bd(0xd6)](_0x15a0bd(0xc1),{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0xbbe819=_0x154001[_0x15a0bd(0xd7)][_0x15a0bd(0xf2)](-_0x55e0d5),_0xa5b5b3=_0x154001[_0x15a0bd(0xd7)][_0x15a0bd(0xf2)](0x0,_0x154001['dailyDigests']['length']-_0x55e0d5),_0x341513=_0x15a0bd(0x153)+JSON[_0x15a0bd(0x107)](_0xa5b5b3)+_0x15a0bd(0x112)+JSON[_0x15a0bd(0x107)](_0xbbe819);try{updateApiTimestamp();const _0x18896b=await _0x154001[_0x15a0bd(0x13c)][_0x15a0bd(0xc4)](_0x341513),_0x13b70d=JSON[_0x15a0bd(0xf1)](_0x18896b[_0x15a0bd(0xc2)][_0x15a0bd(0xf3)]()['replace'](/```json|```/g,'')[_0x15a0bd(0xd5)]());_0x13b70d[_0x15a0bd(0x124)]&&(await _0x154001[_0x15a0bd(0xd6)](_0x15a0bd(0xc1),{'val':_0x13b70d[_0x15a0bd(0x124)],'ack':!![]}),await _0x154001[_0x15a0bd(0xd6)]('LTM.driftAnalysis.driftDetails',{'val':_0x13b70d[_0x15a0bd(0xd1)],'ack':!![]}),await _0x154001[_0x15a0bd(0xd6)](_0x15a0bd(0x155),{'val':Date[_0x15a0bd(0x138)](),'ack':!![]}));}catch(_0x3eca8b){}}async function executeAutomationAction(_0x10a0d1){const _0x206cc1=a0_0x1b28df;try{const _0x3b0e39=await _0x10a0d1[_0x206cc1(0xe7)](_0x206cc1(0x102)),_0x5009fe=await _0x10a0d1[_0x206cc1(0xe7)]('analysis.automation.targetValue');if(_0x3b0e39&&_0x3b0e39[_0x206cc1(0x14e)]&&_0x5009fe){const _0x22d68b=_0x3b0e39[_0x206cc1(0x14e)];let _0x47061f=_0x5009fe[_0x206cc1(0x14e)];try{_0x47061f=JSON[_0x206cc1(0xf1)](_0x47061f);}catch(_0x42170c){}_0x10a0d1[_0x206cc1(0x127)][_0x206cc1(0x131)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x22d68b+_0x206cc1(0xdd)+_0x47061f),await _0x10a0d1[_0x206cc1(0x104)](_0x22d68b,_0x47061f);}else _0x10a0d1[_0x206cc1(0x127)]['warn'](_0x206cc1(0x14a));}catch(_0x19048e){_0x10a0d1['log'][_0x206cc1(0x10e)](_0x206cc1(0xb1)+_0x19048e[_0x206cc1(0x133)]);}}async function sendMorningBriefing(_0x4c03c6){const _0x230ff2=a0_0x1b28df;if(!_0x4c03c6[_0x230ff2(0x13c)]){_0x4c03c6[_0x230ff2(0x127)][_0x230ff2(0x10f)](_0x230ff2(0xcd));return;}_0x4c03c6[_0x230ff2(0x127)]['info'](_0x230ff2(0x129));try{updateApiTimestamp();const _0x676432=_0x230ff2(0xf5),_0x3c0864=await _0x4c03c6[_0x230ff2(0x13c)]['generateContent'](_0x676432),_0x32618b=_0x3c0864[_0x230ff2(0xc2)][_0x230ff2(0xf3)]();_0x4c03c6['log'][_0x230ff2(0x131)](_0x230ff2(0xfe)+_0x32618b[_0x230ff2(0xf9)]+_0x230ff2(0x140)),setup[_0x230ff2(0x154)](_0x4c03c6,_0x230ff2(0xf6)+_0x32618b);}catch(_0x58061f){_0x4c03c6[_0x230ff2(0x127)][_0x230ff2(0x10e)](_0x230ff2(0x110)+_0x58061f['message']);}}async function generateHealthReport(_0x5b02d0,_0x592aa6){const _0x3a8da0=a0_0x1b28df;if(!_0x5b02d0[_0x3a8da0(0x13c)])return;const _0x26cdf5=Date[_0x3a8da0(0x138)]();_0x26cdf5-lastGlobalApiCall<0xbb8&&(_0x5b02d0['log'][_0x3a8da0(0x14b)](_0x3a8da0(0xce)),await new Promise(_0x3ef8db=>setTimeout(_0x3ef8db,0x7d0)));const _0x599bae=new Date();let _0x2082e9=0x0,_0x3532a0=_0x599bae[_0x3a8da0(0xb5)](),_0x197495='';if(_0x592aa6==='NIGHT'){const _0x466c9f=new Date(_0x599bae);_0x466c9f['setDate'](_0x466c9f[_0x3a8da0(0x144)]()-0x1),_0x466c9f[_0x3a8da0(0x141)](0x16,0x0,0x0,0x0),_0x2082e9=_0x466c9f[_0x3a8da0(0xb5)]();const _0x40439b=new Date(_0x599bae);_0x40439b[_0x3a8da0(0x141)](0x8,0x0,0x0,0x0),_0x3532a0=_0x40439b[_0x3a8da0(0xb5)](),_0x197495='Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).';}else{const _0x48242f=new Date(_0x599bae);_0x48242f[_0x3a8da0(0x141)](0x8,0x0,0x0,0x0),_0x2082e9=_0x48242f[_0x3a8da0(0xb5)](),_0x197495='Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).';}const _0x1411b7=_0x5b02d0[_0x3a8da0(0x108)][_0x3a8da0(0x134)](_0x2794d3=>_0x2794d3['timestamp']>=_0x2082e9&&_0x2794d3[_0x3a8da0(0x10d)]<=_0x3532a0);if(_0x1411b7[_0x3a8da0(0xf9)]===0x0){const _0x52a010=_0x592aa6===_0x3a8da0(0xba)?_0x3a8da0(0x118):_0x3a8da0(0xd9),_0x20484c=_0x592aa6==='NIGHT'?_0x3a8da0(0xd2):_0x3a8da0(0x14f);await _0x5b02d0[_0x3a8da0(0xd6)](_0x20484c,{'val':_0x52a010,'ack':!![]});return;}const _0x185050=_0x1411b7[_0x3a8da0(0xde)](_0x1f06dd=>new Date(_0x1f06dd[_0x3a8da0(0x10d)])['toLocaleTimeString']([],{'hour':_0x3a8da0(0x113),'minute':_0x3a8da0(0x113)})+'\x20'+_0x1f06dd[_0x3a8da0(0x139)]+'\x20('+_0x1f06dd[_0x3a8da0(0x128)]+')')[_0x3a8da0(0x11e)]('\x0a'),_0x2ebcef=_0x3a8da0(0xee)+_0x197495+_0x3a8da0(0xe2)+_0x185050+_0x3a8da0(0x10b);try{updateApiTimestamp();const _0x1aa357=await _0x5b02d0[_0x3a8da0(0x13c)]['generateContent'](_0x2ebcef),_0x2acc10=_0x1aa357[_0x3a8da0(0xc2)][_0x3a8da0(0xf3)](),_0x2f54ce=_0x592aa6===_0x3a8da0(0xba)?_0x3a8da0(0xd2):_0x3a8da0(0x14f);await _0x5b02d0[_0x3a8da0(0xd6)](_0x2f54ce,{'val':_0x2acc10,'ack':!![]}),_0x5b02d0['log'][_0x3a8da0(0x131)](_0x3a8da0(0xfd)+_0x592aa6+_0x3a8da0(0x105));}catch(_0x5970a0){_0x5b02d0[_0x3a8da0(0x127)][_0x3a8da0(0x10e)]('Health\x20Report\x20Error:\x20'+_0x5970a0[_0x3a8da0(0x133)]);}}module[a0_0x1b28df(0x10a)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};