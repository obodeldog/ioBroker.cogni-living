const a0_0x3b2adb=a0_0x136c;(function(_0x34ee4c,_0x6c5c48){const _0x4e32b0=a0_0x136c,_0x433d8a=_0x34ee4c();while(!![]){try{const _0x4d6e00=-parseInt(_0x4e32b0(0x202))/0x1+parseInt(_0x4e32b0(0x1c1))/0x2+parseInt(_0x4e32b0(0x217))/0x3*(-parseInt(_0x4e32b0(0x19f))/0x4)+parseInt(_0x4e32b0(0x1f3))/0x5+-parseInt(_0x4e32b0(0x1e7))/0x6*(-parseInt(_0x4e32b0(0x1b8))/0x7)+-parseInt(_0x4e32b0(0x18f))/0x8+parseInt(_0x4e32b0(0x1fb))/0x9;if(_0x4d6e00===_0x6c5c48)break;else _0x433d8a['push'](_0x433d8a['shift']());}catch(_0x246f20){_0x433d8a['push'](_0x433d8a['shift']());}}}(a0_0x11b3,0xdcf7f));const a0_0x1f17a5=(function(){let _0x1d3a89=!![];return function(_0x465bf8,_0x19190f){const _0x3b6f7e=_0x1d3a89?function(){const _0x272965=a0_0x136c;if(_0x19190f){const _0x244876=_0x19190f[_0x272965(0x1ea)](_0x465bf8,arguments);return _0x19190f=null,_0x244876;}}:function(){};return _0x1d3a89=![],_0x3b6f7e;};}()),a0_0x480283=a0_0x1f17a5(this,function(){const _0x145a10=a0_0x136c;return a0_0x480283[_0x145a10(0x1ce)]()[_0x145a10(0x1a6)](_0x145a10(0x213))[_0x145a10(0x1ce)]()['constructor'](a0_0x480283)[_0x145a10(0x1a6)](_0x145a10(0x213));});a0_0x480283();'use strict';const {GoogleGenerativeAI}=require(a0_0x3b2adb(0x1a3)),setup=require(a0_0x3b2adb(0x1ae)),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x3b2adb(0x1d6),LTM_DP_STATUS=a0_0x3b2adb(0x205),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x3b2adb(0x1e4),'senior_aal':a0_0x3b2adb(0x203),'family':'Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','single_comfort':a0_0x3b2adb(0x192),'security':a0_0x3b2adb(0x1d7),'energy_saver':a0_0x3b2adb(0x1ff)};function canCallApi(){const _0xa2fe76=a0_0x3b2adb,_0x22a5f2=Date[_0xa2fe76(0x1a2)]();return _0x22a5f2-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x108324=a0_0x3b2adb;lastGlobalApiCall=Date[_0x108324(0x1a2)]();}function a0_0x11b3(){const _0xaa4011=['detected','targetValue','Unbekannt','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','4631035gJwjnn','analysis.isAlert','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','ltmLtbWindowDays','parse','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','getStateAsync','timestamp','6173325xFJKZx','eventHistory','geminiModel','.\x20SYSTEM_MODE:\x20','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','analysis.analysisHistory','send','569175acBzxs','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','Skipped\x20(No\x20AI\x20or\x20Data)','LTM.processingStatus','analysis.activitySummary','normal','lastAlertState','useWeather','splice','Wetterdaten\x20nicht\x20abrufbar','config','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','LTM.driftAnalysis.driftDetails','rawEventLog','decision','sendNotification','debug','(((.+)+)+)+$','replace','trim','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','939537IEJTZn','currentSystemMode','BUTLER\x20Execution\x20Error:\x20','9263872SMRjRH','ü§ñ\x20Butler\x20Brain\x20Error:\x20','.\x20EMERGENCY:\x20','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','automationProposal','pop','getForeignStateAsync','Started...','stringify','reason','analysis.lastResult','log','analysisHistory','.Current.IsNight','Tag','analysis.automation.autoApply','4aLTcYP','setStateAsync','üìÖ\x20Daily\x20Digest:\x0a','now','@google/generative-ai','analysis.automation.description','.\x20KONTEXT:\x20','search','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','warn','generateContent','analysis.automation.targetId','LTM.driftAnalysis.baselineDrift','N/A\x20(Learning)','¬∞C,\x20','./setup','val','message','\x20√ºbersprungen\x20(Auto-Approved).','aiPersona','push','toISOString','unshift','Skipped\x20(Traffic)','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','13657KvJNKE','weatherInstance','Traffic-Schutz\x20(Auto-Approved)','slice','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.forecast.current.temperature','activityLevel','.Current.Temperature','isEmergency','641448XqpMKB',',\x20Wetter:\x20','ANALYZE_HEALTH','livingContext','analysis.alertReason','.\x20EVENTS:\x20','error','analysis.automation.targetValue','Digest','baselineDrift','text','length','LTM.driftAnalysis.lastCheck','toString','system.presenceWho','Keine\x20Details.','\x0aSTB:\x20','üåÖ\x20Morning\x20Briefing:\x0a','KI-Fehler\x20(Fallback)','info','üåÖ\x20Briefing\x20generated\x20(Length:\x20','LTM.dailyDigests','Sicherheit\x20geht\x20vor.','description','%)\x20nach\x20\x22','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','analysis.automation.patternDetected','exports','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','summary','generic','‚ö†Ô∏è\x20ALARM:\x20','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.',',\x20Lichtverh√§ltnisse:\x20','isProVersion','3114BAyyWK','dailyDigests','isAlert','apply','\x0aAktivit√§t:\x20','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','response','alertReason'];a0_0x11b3=function(){return _0xaa4011;};return a0_0x11b3();}async function getWeatherContext(_0x10d150){const _0x187a96=a0_0x3b2adb;if(!_0x10d150['config'][_0x187a96(0x209)]||!_0x10d150[_0x187a96(0x20c)][_0x187a96(0x1b9)])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x43d63a=_0x10d150[_0x187a96(0x20c)][_0x187a96(0x1b9)];let _0x5e1dda=await _0x10d150[_0x187a96(0x195)](_0x43d63a+_0x187a96(0x1bf));if(!_0x5e1dda)_0x5e1dda=await _0x10d150[_0x187a96(0x195)](_0x43d63a+_0x187a96(0x1bd));let _0x31c927=await _0x10d150[_0x187a96(0x195)](_0x43d63a+'.Current.WeatherText');if(!_0x31c927)_0x31c927=await _0x10d150[_0x187a96(0x195)](_0x43d63a+'.forecast.current.state');let _0x2f0d39=_0x187a96(0x1f1);const _0x5d9394=await _0x10d150['getForeignStateAsync'](_0x43d63a+_0x187a96(0x19c));if(_0x5d9394)_0x2f0d39=_0x5d9394['val']?'Nacht':_0x187a96(0x19d);if(_0x5e1dda&&_0x31c927)return _0x5e1dda['val']+_0x187a96(0x1ad)+_0x31c927[_0x187a96(0x1af)]+_0x187a96(0x1e5)+_0x2f0d39;}catch(_0x47ce4a){}return _0x187a96(0x20b);}async function consultButler(_0x28b062,_0x8497a6,_0x27a8f3,_0x2c972b){const _0x48efe0=a0_0x3b2adb;if(!_0x28b062[_0x48efe0(0x1fd)])return{'approved':!![],'reason':'KI\x20offline\x20(Fallback)'};const _0x1bca59=Date[_0x48efe0(0x1a2)]();if(decisionCache[_0x8497a6]&&_0x1bca59-decisionCache[_0x8497a6][_0x48efe0(0x1fa)]<CACHE_TTL_MS){const _0x244599=decisionCache[_0x8497a6][_0x48efe0(0x210)];return _0x28b062[_0x48efe0(0x19a)][_0x48efe0(0x212)](_0x48efe0(0x216)+_0x8497a6+'\x20->\x20'+(_0x244599['approved']?'OK':'NO')+'\x20('+_0x244599[_0x48efe0(0x198)]+')'),_0x244599;}if(!canCallApi())return _0x28b062['log']['debug']('ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20'+_0x8497a6+_0x48efe0(0x1b1)),{'approved':!![],'reason':_0x48efe0(0x1ba)};const _0x73fa7d=new Date()['toLocaleTimeString'](),_0x1cf7a3=await getWeatherContext(_0x28b062),_0x401f45=PERSONA_MAPPING[_0x28b062[_0x48efe0(0x20c)][_0x48efe0(0x1b2)]||_0x48efe0(0x1e0)],_0x519ec9=_0x48efe0(0x1e3)+_0x73fa7d+_0x48efe0(0x1c2)+_0x1cf7a3+_0x48efe0(0x20d)+(_0x2c972b*0x64)['toFixed'](0x0)+_0x48efe0(0x1d9)+_0x8497a6+_0x48efe0(0x1f5)+_0x27a8f3+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x401f45+_0x48efe0(0x1da);try{updateApiTimestamp();const _0x262b2a=await _0x28b062[_0x48efe0(0x1fd)][_0x48efe0(0x1a9)](_0x519ec9),_0x1d9d3b=_0x262b2a[_0x48efe0(0x1ed)][_0x48efe0(0x1cb)]()[_0x48efe0(0x214)](/```json|```/g,'')['trim'](),_0x26e8e8=JSON[_0x48efe0(0x1f7)](_0x1d9d3b);return decisionCache[_0x8497a6]={'decision':_0x26e8e8,'timestamp':_0x1bca59},_0x26e8e8;}catch(_0x231421){return _0x28b062['log'][_0x48efe0(0x1a8)](_0x48efe0(0x190)+_0x231421['message']),decisionCache[_0x8497a6]={'decision':{'approved':!![],'reason':_0x48efe0(0x1d3)},'timestamp':_0x1bca59-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x48efe0(0x1d3)};}}async function runGeminiAnalysis(_0xdb804e,_0x1ef9e9=''){const _0x2735aa=a0_0x3b2adb;if(!_0xdb804e[_0x2735aa(0x1fd)])return;if(!canCallApi()){_0xdb804e[_0x2735aa(0x19a)][_0x2735aa(0x212)](_0x2735aa(0x1a7));return;}if(_0xdb804e[_0x2735aa(0x1fc)]['length']===0x0)return;const _0x3d35ca=_0xdb804e['eventHistory']['slice'](0x0,0xf),_0x1afa81=_0xdb804e[_0x2735aa(0x218)],_0xb51982=PERSONA_MAPPING[_0xdb804e[_0x2735aa(0x20c)][_0x2735aa(0x1b2)]||_0x2735aa(0x1e0)],_0x4538d2=_0xdb804e[_0x2735aa(0x20c)][_0x2735aa(0x1c4)]||_0x2735aa(0x1d0);let _0x52a368=_0x2735aa(0x1f1);try{const _0x30d7f9=await _0xdb804e[_0x2735aa(0x1f9)](_0x2735aa(0x1cf));if(_0x30d7f9&&_0x30d7f9[_0x2735aa(0x1af)])_0x52a368=_0x30d7f9['val'];}catch(_0x4ced08){}let _0x4fa294=![];try{const _0x1415fd=await _0xdb804e[_0x2735aa(0x1f9)](_0x2735aa(0x19e));if(_0x1415fd&&_0x1415fd['val'])_0x4fa294=!![];}catch(_0x5ea411){}const _0x31a286=_0x2735aa(0x1f2)+_0xb51982+_0x2735aa(0x1a5)+_0x4538d2+_0x2735aa(0x1fe)+_0x1afa81+'.\x20ANWESEND:\x20'+_0x52a368+_0x2735aa(0x1c6)+JSON['stringify'](_0x3d35ca)+_0x2735aa(0x191)+_0x1ef9e9+_0x2735aa(0x1ec);try{updateApiTimestamp();const _0x52cdb8=await _0xdb804e[_0x2735aa(0x1fd)]['generateContent'](_0x31a286),_0x162737=JSON[_0x2735aa(0x1f7)](_0x52cdb8[_0x2735aa(0x1ed)][_0x2735aa(0x1cb)]()[_0x2735aa(0x214)](/```json|```/g,'')[_0x2735aa(0x215)]());await _0xdb804e['setStateAsync'](_0x2735aa(0x199),{'val':JSON[_0x2735aa(0x197)](_0x162737),'ack':!![]});if(_0x162737[_0x2735aa(0x1df)])await _0xdb804e[_0x2735aa(0x1a0)](_0x2735aa(0x206),{'val':_0x162737[_0x2735aa(0x1df)],'ack':!![]});const _0x5421d3={'timestamp':Date[_0x2735aa(0x1a2)](),'id':Date[_0x2735aa(0x1a2)]()[_0x2735aa(0x1ce)](),'analysis':{'activity':{'summary':_0x162737[_0x2735aa(0x1df)],'isAlert':_0x162737['isAlert'],'alertReason':_0x162737[_0x2735aa(0x1ee)]},'comfort':{'automationProposal':_0x162737['automationProposal']}}};_0xdb804e[_0x2735aa(0x19b)][_0x2735aa(0x1b5)](_0x5421d3);if(_0xdb804e[_0x2735aa(0x19b)][_0x2735aa(0x1cc)]>0x32)_0xdb804e[_0x2735aa(0x19b)][_0x2735aa(0x194)]();await _0xdb804e[_0x2735aa(0x1a0)](_0x2735aa(0x200),{'val':JSON['stringify'](_0xdb804e[_0x2735aa(0x19b)]),'ack':!![]});const _0x550a06=_0x162737[_0x2735aa(0x1e9)]||![];_0x550a06!==_0xdb804e[_0x2735aa(0x208)]&&(await _0xdb804e[_0x2735aa(0x1a0)](_0x2735aa(0x1f4),{'val':_0x550a06,'ack':!![]}),_0xdb804e[_0x2735aa(0x208)]=_0x550a06,_0x550a06&&(await _0xdb804e['setStateAsync'](_0x2735aa(0x1c5),{'val':_0x162737['alertReason'],'ack':!![]}),setup[_0x2735aa(0x211)](_0xdb804e,_0x2735aa(0x1e1)+_0x162737['alertReason'],![],_0x162737[_0x2735aa(0x1c0)])));if(_0x162737[_0x2735aa(0x193)]&&_0x162737[_0x2735aa(0x193)][_0x2735aa(0x1ef)]){await _0xdb804e[_0x2735aa(0x1a0)](_0x2735aa(0x1dc),{'val':!![],'ack':!![]}),await _0xdb804e[_0x2735aa(0x1a0)](_0x2735aa(0x1a4),{'val':_0x162737[_0x2735aa(0x193)][_0x2735aa(0x1d8)],'ack':!![]}),await _0xdb804e['setStateAsync'](_0x2735aa(0x1aa),{'val':_0x162737[_0x2735aa(0x193)]['targetId'],'ack':!![]}),await _0xdb804e[_0x2735aa(0x1a0)](_0x2735aa(0x1c8),{'val':JSON[_0x2735aa(0x197)](_0x162737[_0x2735aa(0x193)][_0x2735aa(0x1f0)]),'ack':!![]});if(_0x4fa294)executeAutomationAction(_0xdb804e);}}catch(_0x259be5){_0xdb804e[_0x2735aa(0x19a)]['error']('Gemini\x20Error:\x20'+_0x259be5[_0x2735aa(0x1b0)]);}}async function createDailyDigest(_0x3d43c3,_0x1f294a){const _0x565907=a0_0x3b2adb;if(!_0x3d43c3[_0x565907(0x1e6)])return;if(!canCallApi()){await _0x3d43c3[_0x565907(0x1a0)](LTM_DP_STATUS,{'val':_0x565907(0x1b6),'ack':!![]});return;}await _0x3d43c3['setStateAsync'](LTM_DP_STATUS,{'val':_0x565907(0x196),'ack':!![]});if(!_0x3d43c3[_0x565907(0x1fd)]||_0x3d43c3['rawEventLog'][_0x565907(0x1cc)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3d43c3[_0x565907(0x1a0)](LTM_DP_STATUS,{'val':_0x565907(0x204),'ack':!![]});return;}const _0x20c4cc=JSON[_0x565907(0x1f7)](JSON[_0x565907(0x197)](_0x3d43c3[_0x565907(0x20f)])),_0x2eaec1=_0x20c4cc[_0x565907(0x1cc)],_0x4f0717=_0x565907(0x1bc)+JSON['stringify'](_0x20c4cc);try{updateApiTimestamp();const _0x4e71d7=await _0x3d43c3['geminiModel'][_0x565907(0x1a9)](_0x4f0717),_0x39819b=JSON[_0x565907(0x1f7)](_0x4e71d7[_0x565907(0x1ed)][_0x565907(0x1cb)]()[_0x565907(0x214)](/```json|```/g,'')[_0x565907(0x215)]()),_0x9994d4={'timestamp':new Date()[_0x565907(0x1b4)](),'eventCount':_0x2eaec1,'summary':_0x39819b[_0x565907(0x1df)]||_0x565907(0x1c9),'activityLevel':_0x39819b[_0x565907(0x1be)]||_0x565907(0x207),'systemMode':_0x3d43c3['currentSystemMode']};_0x3d43c3[_0x565907(0x1e8)][_0x565907(0x1b3)](_0x9994d4);const _0x18a8d2=_0x3d43c3[_0x565907(0x20c)][_0x565907(0x1f6)]||0x3c;_0x3d43c3[_0x565907(0x1e8)][_0x565907(0x1cc)]>_0x18a8d2&&_0x3d43c3['dailyDigests'][_0x565907(0x20a)](0x0,_0x3d43c3[_0x565907(0x1e8)]['length']-_0x18a8d2);await _0x3d43c3[_0x565907(0x1a0)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x565907(0x197)](_0x3d43c3[_0x565907(0x1e8)]),'ack':!![]}),_0x3d43c3[_0x565907(0x20f)]=[],await _0x3d43c3[_0x565907(0x1a0)](LTM_DP_RAW_LOG,{'val':JSON[_0x565907(0x197)](_0x3d43c3[_0x565907(0x20f)]),'ack':!![]}),await _0x3d43c3[_0x565907(0x1a0)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x33e77f=_0x565907(0x1a1)+_0x39819b[_0x565907(0x1df)]+_0x565907(0x1eb)+_0x39819b[_0x565907(0x1be)];setup[_0x565907(0x211)](_0x3d43c3,_0x33e77f,![],![]);if(_0x3d43c3[_0x565907(0x1e6)]&&_0x1f294a)_0x1f294a[_0x565907(0x201)](_0x3d43c3,_0x565907(0x1c3),{'digest':_0x9994d4});}catch(_0x1dad02){_0x3d43c3[_0x565907(0x19a)]['error'](_0x1dad02[_0x565907(0x1b0)]);}}function a0_0x136c(_0x4a9edd,_0x159d5f){const _0x2a8881=a0_0x11b3();return a0_0x136c=function(_0x480283,_0x1f17a5){_0x480283=_0x480283-0x18e;let _0x11b352=_0x2a8881[_0x480283];return _0x11b352;},a0_0x136c(_0x4a9edd,_0x159d5f);}async function runBaselineDriftAnalysis(_0x9990a0){const _0x5f0893=a0_0x3b2adb;if(!_0x9990a0[_0x5f0893(0x1e6)]||!_0x9990a0[_0x5f0893(0x1fd)])return;if(!canCallApi())return;const _0x35b3ff=_0x9990a0[_0x5f0893(0x20c)]['ltmStbWindowDays']||0xe;if(_0x9990a0[_0x5f0893(0x1e8)][_0x5f0893(0x1cc)]<_0x35b3ff+0x7){await _0x9990a0[_0x5f0893(0x1a0)]('LTM.driftAnalysis.baselineDrift',{'val':_0x5f0893(0x1ac),'ack':!![]});return;}const _0x323f4e=_0x9990a0[_0x5f0893(0x1e8)]['slice'](-_0x35b3ff),_0x5e1a61=_0x9990a0[_0x5f0893(0x1e8)][_0x5f0893(0x1bb)](0x0,_0x9990a0[_0x5f0893(0x1e8)][_0x5f0893(0x1cc)]-_0x35b3ff),_0x49f438=_0x5f0893(0x1e2)+JSON['stringify'](_0x5e1a61)+_0x5f0893(0x1d1)+JSON[_0x5f0893(0x197)](_0x323f4e);try{updateApiTimestamp();const _0x2ff856=await _0x9990a0[_0x5f0893(0x1fd)][_0x5f0893(0x1a9)](_0x49f438),_0x29c79f=JSON[_0x5f0893(0x1f7)](_0x2ff856['response'][_0x5f0893(0x1cb)]()[_0x5f0893(0x214)](/```json|```/g,'')[_0x5f0893(0x215)]());_0x29c79f[_0x5f0893(0x1ca)]&&(await _0x9990a0[_0x5f0893(0x1a0)](_0x5f0893(0x1ab),{'val':_0x29c79f[_0x5f0893(0x1ca)],'ack':!![]}),await _0x9990a0[_0x5f0893(0x1a0)](_0x5f0893(0x20e),{'val':_0x29c79f['driftDetails'],'ack':!![]}),await _0x9990a0[_0x5f0893(0x1a0)](_0x5f0893(0x1cd),{'val':Date[_0x5f0893(0x1a2)](),'ack':!![]}));}catch(_0x28cc3a){}}async function executeAutomationAction(_0x30a1fe){const _0x211644=a0_0x3b2adb;try{const _0x306546=await _0x30a1fe['getStateAsync']('analysis.automation.targetId'),_0x3f21e2=await _0x30a1fe[_0x211644(0x1f9)](_0x211644(0x1c8));if(_0x306546&&_0x306546[_0x211644(0x1af)]&&_0x3f21e2){const _0x4a6e2f=_0x306546['val'];let _0x529bc9=_0x3f21e2[_0x211644(0x1af)];try{_0x529bc9=JSON['parse'](_0x529bc9);}catch(_0x377ba6){}_0x30a1fe[_0x211644(0x19a)][_0x211644(0x1d4)](_0x211644(0x1de)+_0x4a6e2f+'\x20=\x20'+_0x529bc9),await _0x30a1fe['setForeignStateAsync'](_0x4a6e2f,_0x529bc9);}else _0x30a1fe[_0x211644(0x19a)]['warn']('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x4de0c5){_0x30a1fe[_0x211644(0x19a)][_0x211644(0x1c7)](_0x211644(0x18e)+_0x4de0c5[_0x211644(0x1b0)]);}}async function sendMorningBriefing(_0x38c057){const _0xa13168=a0_0x3b2adb;if(!_0x38c057[_0xa13168(0x1fd)]){_0x38c057[_0xa13168(0x19a)][_0xa13168(0x1a8)](_0xa13168(0x1f8));return;}_0x38c057[_0xa13168(0x19a)][_0xa13168(0x1d4)](_0xa13168(0x1b7));try{updateApiTimestamp();const _0x22d84d=_0xa13168(0x1db),_0x45fb6f=await _0x38c057[_0xa13168(0x1fd)]['generateContent'](_0x22d84d),_0x5a7dd2=_0x45fb6f[_0xa13168(0x1ed)][_0xa13168(0x1cb)]();_0x38c057[_0xa13168(0x19a)][_0xa13168(0x1d4)](_0xa13168(0x1d5)+_0x5a7dd2[_0xa13168(0x1cc)]+').\x20Sending\x20notification...'),setup[_0xa13168(0x211)](_0x38c057,_0xa13168(0x1d2)+_0x5a7dd2);}catch(_0x12f056){_0x38c057[_0xa13168(0x19a)][_0xa13168(0x1c7)]('Briefing\x20Error:\x20'+_0x12f056[_0xa13168(0x1b0)]);}}module[a0_0x3b2adb(0x1dd)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};