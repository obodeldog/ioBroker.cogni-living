const a0_0x2166d5=a0_0x2ecf;(function(_0x4a462b,_0x195656){const _0x4ef0a1=a0_0x2ecf,_0x982c9=_0x4a462b();while(!![]){try{const _0x168757=-parseInt(_0x4ef0a1(0x1ab))/0x1+-parseInt(_0x4ef0a1(0x155))/0x2*(parseInt(_0x4ef0a1(0x1ad))/0x3)+parseInt(_0x4ef0a1(0x1c8))/0x4+-parseInt(_0x4ef0a1(0x191))/0x5+parseInt(_0x4ef0a1(0x1c7))/0x6*(parseInt(_0x4ef0a1(0x172))/0x7)+-parseInt(_0x4ef0a1(0x1a7))/0x8+-parseInt(_0x4ef0a1(0x195))/0x9*(-parseInt(_0x4ef0a1(0x192))/0xa);if(_0x168757===_0x195656)break;else _0x982c9['push'](_0x982c9['shift']());}catch(_0x407f70){_0x982c9['push'](_0x982c9['shift']());}}}(a0_0x1b0e,0x1ed01));const a0_0x4fca18=(function(){let _0x18cf3c=!![];return function(_0x1fa6b7,_0x4b53ea){const _0x1795d8=_0x18cf3c?function(){if(_0x4b53ea){const _0x283b1f=_0x4b53ea['apply'](_0x1fa6b7,arguments);return _0x4b53ea=null,_0x283b1f;}}:function(){};return _0x18cf3c=![],_0x1795d8;};}()),a0_0xa679de=a0_0x4fca18(this,function(){const _0x4ae65c=a0_0x2ecf;return a0_0xa679de[_0x4ae65c(0x136)]()[_0x4ae65c(0x134)](_0x4ae65c(0x183))[_0x4ae65c(0x136)]()[_0x4ae65c(0x194)](a0_0xa679de)[_0x4ae65c(0x134)](_0x4ae65c(0x183));});a0_0xa679de();function a0_0x2ecf(_0x5ad210,_0x4e4eb1){const _0x577239=a0_0x1b0e();return a0_0x2ecf=function(_0xa679de,_0x4fca18){_0xa679de=_0xa679de-0x12f;let _0x1b0e49=_0x577239[_0xa679de];return _0x1b0e49;},a0_0x2ecf(_0x5ad210,_0x4e4eb1);}'use strict';const {GoogleGenerativeAI}=require('@google/generative-ai'),setup=require('./setup'),GEMINI_MODEL=a0_0x2166d5(0x182),LTM_DP_DAILY_DIGESTS=a0_0x2166d5(0x13d),LTM_DP_STATUS=a0_0x2166d5(0x199),LTM_DP_RAW_LOG=a0_0x2166d5(0x146),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x2166d5(0x17e),'senior_aal':a0_0x2166d5(0x197),'family':a0_0x2166d5(0x165),'single_comfort':a0_0x2166d5(0x1a4),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x2166d5(0x185)};function canCallApi(){const _0x15a6c3=a0_0x2166d5,_0xa3b44a=Date[_0x15a6c3(0x17a)]();return _0xa3b44a-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x5fb32=a0_0x2166d5;lastGlobalApiCall=Date[_0x5fb32(0x17a)]();}async function getWeatherContext(_0x55a6d2){const _0xe77361=a0_0x2166d5;if(!_0x55a6d2[_0xe77361(0x164)][_0xe77361(0x184)]||!_0x55a6d2[_0xe77361(0x164)][_0xe77361(0x1c4)])return _0xe77361(0x1bd);try{const _0x284ee9=_0x55a6d2[_0xe77361(0x164)][_0xe77361(0x1c4)];let _0xb3656b=await _0x55a6d2[_0xe77361(0x1b6)](_0x284ee9+_0xe77361(0x150));if(!_0xb3656b)_0xb3656b=await _0x55a6d2[_0xe77361(0x1b6)](_0x284ee9+'.forecast.current.temperature');let _0x37751d=await _0x55a6d2[_0xe77361(0x1b6)](_0x284ee9+_0xe77361(0x1cc));if(!_0x37751d)_0x37751d=await _0x55a6d2[_0xe77361(0x1b6)](_0x284ee9+_0xe77361(0x1aa));let _0x5c9f0b=_0xe77361(0x13e);const _0x46f514=await _0x55a6d2[_0xe77361(0x1b6)](_0x284ee9+_0xe77361(0x1ac));if(_0x46f514)_0x5c9f0b=_0x46f514[_0xe77361(0x169)]?_0xe77361(0x198):'Tag';if(_0xb3656b&&_0x37751d)return _0xb3656b['val']+_0xe77361(0x16d)+_0x37751d[_0xe77361(0x169)]+',\x20Lichtverh√§ltnisse:\x20'+_0x5c9f0b;}catch(_0x100c13){}return'Wetterdaten\x20nicht\x20abrufbar';}async function consultButler(_0x214b0b,_0x208976,_0x4e35e2,_0x460c58){const _0x47dac5=a0_0x2166d5;if(!_0x214b0b[_0x47dac5(0x16a)])return{'approved':!![],'reason':_0x47dac5(0x1c3)};const _0x17c5bd=Date['now']();if(decisionCache[_0x208976]&&_0x17c5bd-decisionCache[_0x208976][_0x47dac5(0x1c0)]<CACHE_TTL_MS){const _0x959e96=decisionCache[_0x208976]['decision'];return _0x214b0b[_0x47dac5(0x14d)][_0x47dac5(0x148)]('ü§ñ\x20Butler\x20Cache\x20Hit:\x20'+_0x208976+'\x20->\x20'+(_0x959e96[_0x47dac5(0x152)]?'OK':'NO')+'\x20('+_0x959e96[_0x47dac5(0x168)]+')'),_0x959e96;}if(!canCallApi())return _0x214b0b[_0x47dac5(0x14d)][_0x47dac5(0x148)](_0x47dac5(0x160)+_0x208976+_0x47dac5(0x138)),{'approved':!![],'reason':_0x47dac5(0x17c)};const _0x463d77=new Date()['toLocaleTimeString'](),_0x1bb8e2=await getWeatherContext(_0x214b0b),_0x418c84=PERSONA_MAPPING[_0x214b0b[_0x47dac5(0x164)][_0x47dac5(0x1b0)]||'generic'],_0x56819b=_0x47dac5(0x196)+_0x463d77+_0x47dac5(0x18d)+_0x1bb8e2+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x460c58*0x64)[_0x47dac5(0x140)](0x0)+_0x47dac5(0x17b)+_0x208976+_0x47dac5(0x137)+_0x4e35e2+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x418c84+_0x47dac5(0x181);try{updateApiTimestamp();const _0x1b3603=await _0x214b0b['geminiModel']['generateContent'](_0x56819b),_0x34d698=_0x1b3603[_0x47dac5(0x188)][_0x47dac5(0x1a9)]()[_0x47dac5(0x161)](/```json|```/g,'')['trim'](),_0x9e1c94=JSON[_0x47dac5(0x1c5)](_0x34d698);return decisionCache[_0x208976]={'decision':_0x9e1c94,'timestamp':_0x17c5bd},_0x9e1c94;}catch(_0x4c82ea){return _0x214b0b[_0x47dac5(0x14d)][_0x47dac5(0x156)]('ü§ñ\x20Butler\x20Brain\x20Error:\x20'+_0x4c82ea['message']),decisionCache[_0x208976]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x17c5bd-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x47dac5(0x1b9)};}}async function runGeminiAnalysis(_0x6238a5,_0xa80e78=''){const _0x2799ab=a0_0x2166d5;if(!_0x6238a5['geminiModel'])return;if(!canCallApi()){_0x6238a5[_0x2799ab(0x14d)][_0x2799ab(0x148)](_0x2799ab(0x162));return;}if(_0x6238a5[_0x2799ab(0x177)][_0x2799ab(0x144)]===0x0)return;const _0x4bf57f=_0x6238a5[_0x2799ab(0x177)][_0x2799ab(0x133)](0x0,0xf),_0x58dbbb=_0x6238a5[_0x2799ab(0x14e)],_0x5e0f54=PERSONA_MAPPING[_0x6238a5[_0x2799ab(0x164)][_0x2799ab(0x1b0)]||_0x2799ab(0x1b3)],_0x55c0c2=_0x6238a5['config'][_0x2799ab(0x132)]||_0x2799ab(0x1a6);let _0x38a913='Unbekannt';try{const _0x105d83=await _0x6238a5[_0x2799ab(0x130)](_0x2799ab(0x174));if(_0x105d83&&_0x105d83[_0x2799ab(0x169)])_0x38a913=_0x105d83[_0x2799ab(0x169)];}catch(_0x4a1cc6){}let _0x540601=![];try{const _0xfb9399=await _0x6238a5[_0x2799ab(0x130)](_0x2799ab(0x15c));if(_0xfb9399&&_0xfb9399[_0x2799ab(0x169)])_0x540601=!![];}catch(_0x293208){}const _0x2ce32a=_0x2799ab(0x178)+_0x5e0f54+_0x2799ab(0x171)+_0x55c0c2+_0x2799ab(0x143)+_0x58dbbb+_0x2799ab(0x1b7)+_0x38a913+_0x2799ab(0x1bb)+JSON[_0x2799ab(0x1bc)](_0x4bf57f)+_0x2799ab(0x131)+_0xa80e78+_0x2799ab(0x18e);try{updateApiTimestamp();const _0x2be2bd=await _0x6238a5[_0x2799ab(0x16a)]['generateContent'](_0x2ce32a),_0x219a82=JSON[_0x2799ab(0x1c5)](_0x2be2bd[_0x2799ab(0x188)][_0x2799ab(0x1a9)]()['replace'](/```json|```/g,'')[_0x2799ab(0x1a5)]());await _0x6238a5['setStateAsync'](_0x2799ab(0x13c),{'val':JSON[_0x2799ab(0x1bc)](_0x219a82),'ack':!![]});if(_0x219a82[_0x2799ab(0x16f)])await _0x6238a5[_0x2799ab(0x18b)](_0x2799ab(0x170),{'val':_0x219a82[_0x2799ab(0x16f)],'ack':!![]});const _0x21cbd9={'timestamp':Date[_0x2799ab(0x17a)](),'id':Date[_0x2799ab(0x17a)]()[_0x2799ab(0x136)](),'analysis':{'activity':{'summary':_0x219a82[_0x2799ab(0x16f)],'isAlert':_0x219a82['isAlert'],'alertReason':_0x219a82[_0x2799ab(0x19e)]},'comfort':{'automationProposal':_0x219a82[_0x2799ab(0x14b)]}}};_0x6238a5[_0x2799ab(0x1b5)][_0x2799ab(0x1a8)](_0x21cbd9);if(_0x6238a5[_0x2799ab(0x1b5)][_0x2799ab(0x144)]>0x32)_0x6238a5[_0x2799ab(0x1b5)][_0x2799ab(0x1b4)]();await _0x6238a5[_0x2799ab(0x18b)](_0x2799ab(0x1be),{'val':JSON[_0x2799ab(0x1bc)](_0x6238a5[_0x2799ab(0x1b5)]),'ack':!![]});const _0x301995=_0x219a82[_0x2799ab(0x1a3)]||![];_0x301995!==_0x6238a5[_0x2799ab(0x16b)]&&(await _0x6238a5['setStateAsync']('analysis.isAlert',{'val':_0x301995,'ack':!![]}),_0x6238a5[_0x2799ab(0x16b)]=_0x301995,_0x301995&&(await _0x6238a5[_0x2799ab(0x18b)](_0x2799ab(0x167),{'val':_0x219a82[_0x2799ab(0x19e)],'ack':!![]}),setup[_0x2799ab(0x176)](_0x6238a5,'‚ö†Ô∏è\x20ALARM:\x20'+_0x219a82['alertReason'],![],_0x219a82['isEmergency'])));if(_0x219a82['automationProposal']&&_0x219a82[_0x2799ab(0x14b)][_0x2799ab(0x14f)]){await _0x6238a5[_0x2799ab(0x18b)](_0x2799ab(0x1ae),{'val':!![],'ack':!![]}),await _0x6238a5[_0x2799ab(0x18b)](_0x2799ab(0x19d),{'val':_0x219a82['automationProposal'][_0x2799ab(0x14c)],'ack':!![]}),await _0x6238a5[_0x2799ab(0x18b)](_0x2799ab(0x166),{'val':_0x219a82[_0x2799ab(0x14b)][_0x2799ab(0x13f)],'ack':!![]}),await _0x6238a5['setStateAsync'](_0x2799ab(0x1ca),{'val':JSON[_0x2799ab(0x1bc)](_0x219a82[_0x2799ab(0x14b)][_0x2799ab(0x19c)]),'ack':!![]});if(_0x540601)executeAutomationAction(_0x6238a5);}}catch(_0x2e8c9e){_0x6238a5[_0x2799ab(0x14d)][_0x2799ab(0x19f)](_0x2799ab(0x1ba)+_0x2e8c9e['message']);}}async function createDailyDigest(_0x5e4008,_0x10c27b){const _0x5de31c=a0_0x2166d5;if(!_0x5e4008[_0x5de31c(0x12f)])return;if(!canCallApi()){await _0x5e4008[_0x5de31c(0x18b)](LTM_DP_STATUS,{'val':_0x5de31c(0x186),'ack':!![]});return;}await _0x5e4008[_0x5de31c(0x18b)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x5e4008[_0x5de31c(0x16a)]||_0x5e4008[_0x5de31c(0x18c)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x5e4008[_0x5de31c(0x18b)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x56f2dd=JSON[_0x5de31c(0x1c5)](JSON[_0x5de31c(0x1bc)](_0x5e4008[_0x5de31c(0x18c)])),_0x194c30=_0x56f2dd[_0x5de31c(0x144)],_0x15253e=_0x5de31c(0x163)+JSON[_0x5de31c(0x1bc)](_0x56f2dd);try{updateApiTimestamp();const _0x15d1df=await _0x5e4008[_0x5de31c(0x16a)][_0x5de31c(0x153)](_0x15253e),_0x1183ac=JSON['parse'](_0x15d1df[_0x5de31c(0x188)][_0x5de31c(0x1a9)]()[_0x5de31c(0x161)](/```json|```/g,'')['trim']()),_0x1ffd8d={'timestamp':new Date()[_0x5de31c(0x142)](),'eventCount':_0x194c30,'summary':_0x1183ac['summary']||_0x5de31c(0x189),'activityLevel':_0x1183ac[_0x5de31c(0x15d)]||_0x5de31c(0x15b),'systemMode':_0x5e4008[_0x5de31c(0x14e)]};_0x5e4008[_0x5de31c(0x193)][_0x5de31c(0x151)](_0x1ffd8d);const _0x374834=_0x5e4008[_0x5de31c(0x164)][_0x5de31c(0x19b)]||0x3c;_0x5e4008['dailyDigests'][_0x5de31c(0x144)]>_0x374834&&_0x5e4008[_0x5de31c(0x193)]['splice'](0x0,_0x5e4008[_0x5de31c(0x193)][_0x5de31c(0x144)]-_0x374834);await _0x5e4008['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x5e4008['dailyDigests']),'ack':!![]}),_0x5e4008[_0x5de31c(0x18c)]=[],await _0x5e4008[_0x5de31c(0x18b)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x5e4008['rawEventLog']),'ack':!![]}),await _0x5e4008[_0x5de31c(0x18b)](LTM_DP_STATUS,{'val':_0x5de31c(0x1af),'ack':!![]});const _0x300293=_0x5de31c(0x159)+_0x1183ac[_0x5de31c(0x16f)]+_0x5de31c(0x18a)+_0x1183ac['activityLevel'];setup[_0x5de31c(0x176)](_0x5e4008,_0x300293,![],![]);if(_0x5e4008[_0x5de31c(0x12f)]&&_0x10c27b)_0x10c27b[_0x5de31c(0x15a)](_0x5e4008,_0x5de31c(0x1c2),{'digest':_0x1ffd8d});}catch(_0x41cc99){_0x5e4008[_0x5de31c(0x14d)]['error'](_0x41cc99[_0x5de31c(0x1b2)]);}}async function runBaselineDriftAnalysis(_0xc9c8da){const _0x5d9d9f=a0_0x2166d5;if(!_0xc9c8da[_0x5d9d9f(0x12f)]||!_0xc9c8da[_0x5d9d9f(0x16a)])return;if(!canCallApi())return;const _0x35eae8=_0xc9c8da[_0x5d9d9f(0x164)][_0x5d9d9f(0x147)]||0xe;if(_0xc9c8da[_0x5d9d9f(0x193)]['length']<_0x35eae8+0x7){await _0xc9c8da[_0x5d9d9f(0x18b)](_0x5d9d9f(0x16e),{'val':_0x5d9d9f(0x145),'ack':!![]});return;}const _0x5b9955=_0xc9c8da['dailyDigests'][_0x5d9d9f(0x133)](-_0x35eae8),_0x156607=_0xc9c8da[_0x5d9d9f(0x193)][_0x5d9d9f(0x133)](0x0,_0xc9c8da['dailyDigests'][_0x5d9d9f(0x144)]-_0x35eae8),_0xef1572=_0x5d9d9f(0x1bf)+JSON[_0x5d9d9f(0x1bc)](_0x156607)+_0x5d9d9f(0x187)+JSON[_0x5d9d9f(0x1bc)](_0x5b9955);try{updateApiTimestamp();const _0x2d1d71=await _0xc9c8da[_0x5d9d9f(0x16a)][_0x5d9d9f(0x153)](_0xef1572),_0x1e199c=JSON[_0x5d9d9f(0x1c5)](_0x2d1d71[_0x5d9d9f(0x188)][_0x5d9d9f(0x1a9)]()[_0x5d9d9f(0x161)](/```json|```/g,'')[_0x5d9d9f(0x1a5)]());_0x1e199c['baselineDrift']&&(await _0xc9c8da[_0x5d9d9f(0x18b)](_0x5d9d9f(0x16e),{'val':_0x1e199c['baselineDrift'],'ack':!![]}),await _0xc9c8da[_0x5d9d9f(0x18b)]('LTM.driftAnalysis.driftDetails',{'val':_0x1e199c[_0x5d9d9f(0x1cb)],'ack':!![]}),await _0xc9c8da[_0x5d9d9f(0x18b)](_0x5d9d9f(0x15f),{'val':Date[_0x5d9d9f(0x17a)](),'ack':!![]}));}catch(_0x41fdf4){}}async function executeAutomationAction(_0x2ac78b){const _0x373442=a0_0x2166d5;try{const _0x32901c=await _0x2ac78b[_0x373442(0x130)](_0x373442(0x166)),_0x381ef1=await _0x2ac78b['getStateAsync'](_0x373442(0x1ca));if(_0x32901c&&_0x32901c['val']&&_0x381ef1){const _0x23aa4a=_0x32901c[_0x373442(0x169)];let _0xd5792a=_0x381ef1[_0x373442(0x169)];try{_0xd5792a=JSON[_0x373442(0x1c5)](_0xd5792a);}catch(_0x418c83){}_0x2ac78b[_0x373442(0x14d)]['info'](_0x373442(0x1c9)+_0x23aa4a+_0x373442(0x13b)+_0xd5792a),await _0x2ac78b['setForeignStateAsync'](_0x23aa4a,_0xd5792a);}else _0x2ac78b[_0x373442(0x14d)][_0x373442(0x156)](_0x373442(0x158));}catch(_0x231657){_0x2ac78b[_0x373442(0x14d)][_0x373442(0x19f)](_0x373442(0x157)+_0x231657['message']);}}async function sendMorningBriefing(_0x46c7cb){const _0x3a6618=a0_0x2166d5;if(!_0x46c7cb[_0x3a6618(0x16a)]){_0x46c7cb['log'][_0x3a6618(0x156)](_0x3a6618(0x1a2));return;}_0x46c7cb[_0x3a6618(0x14d)][_0x3a6618(0x141)]('üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x3c9831='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x4fa00f=await _0x46c7cb[_0x3a6618(0x16a)][_0x3a6618(0x153)](_0x3c9831),_0x24eaa0=_0x4fa00f[_0x3a6618(0x188)][_0x3a6618(0x1a9)]();_0x46c7cb[_0x3a6618(0x14d)][_0x3a6618(0x141)](_0x3a6618(0x179)+_0x24eaa0[_0x3a6618(0x144)]+_0x3a6618(0x139)),setup[_0x3a6618(0x176)](_0x46c7cb,_0x3a6618(0x13a)+_0x24eaa0);}catch(_0x28260a){_0x46c7cb['log'][_0x3a6618(0x19f)]('Briefing\x20Error:\x20'+_0x28260a['message']);}}async function generateHealthReport(_0x1b22d,_0x51212b){const _0x50804f=a0_0x2166d5;if(!_0x1b22d[_0x50804f(0x16a)])return;const _0x422cbd=Date['now']();_0x422cbd-lastGlobalApiCall<0xbb8&&(_0x1b22d[_0x50804f(0x14d)][_0x50804f(0x148)](_0x50804f(0x16c)),await new Promise(_0x287c96=>setTimeout(_0x287c96,0x7d0)));const _0x411c3d=new Date();let _0x19b817=0x0,_0x15dc2c=_0x411c3d['getTime'](),_0x263ff9='';if(_0x51212b===_0x50804f(0x1a0)){const _0x48c751=new Date(_0x411c3d);_0x48c751[_0x50804f(0x154)](_0x48c751[_0x50804f(0x1c6)]()-0x1),_0x48c751[_0x50804f(0x15e)](0x16,0x0,0x0,0x0),_0x19b817=_0x48c751['getTime']();const _0x596132=new Date(_0x411c3d);_0x596132[_0x50804f(0x15e)](0x8,0x0,0x0,0x0),_0x15dc2c=_0x596132[_0x50804f(0x173)](),_0x263ff9=_0x50804f(0x190);}else{const _0x4a98b3=new Date(_0x411c3d);_0x4a98b3[_0x50804f(0x15e)](0x8,0x0,0x0,0x0),_0x19b817=_0x4a98b3['getTime'](),_0x263ff9=_0x50804f(0x135);}const _0x8deeef=_0x1b22d[_0x50804f(0x177)]['filter'](_0x16431d=>_0x16431d['timestamp']>=_0x19b817&&_0x16431d[_0x50804f(0x1c0)]<=_0x15dc2c);if(_0x8deeef[_0x50804f(0x144)]===0x0){const _0x27828d=_0x51212b==='NIGHT'?_0x50804f(0x17f):'Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.',_0x5cab6d=_0x51212b===_0x50804f(0x1a0)?_0x50804f(0x19a):_0x50804f(0x149);await _0x1b22d[_0x50804f(0x18b)](_0x5cab6d,{'val':_0x27828d,'ack':!![]});return;}const _0x4b071f=_0x8deeef['map'](_0x105972=>new Date(_0x105972[_0x50804f(0x1c0)])['toLocaleTimeString']([],{'hour':_0x50804f(0x1b1),'minute':_0x50804f(0x1b1)})+'\x20'+_0x105972[_0x50804f(0x17d)]+'\x20('+_0x105972[_0x50804f(0x1a1)]+')')[_0x50804f(0x175)]('\x0a'),_0xd37f61=_0x50804f(0x180)+_0x263ff9+_0x50804f(0x1b8)+_0x4b071f+_0x50804f(0x14a);try{updateApiTimestamp();const _0x3d4cd1=await _0x1b22d['geminiModel'][_0x50804f(0x153)](_0xd37f61),_0x5bb569=_0x3d4cd1[_0x50804f(0x188)][_0x50804f(0x1a9)](),_0x70374f=_0x51212b===_0x50804f(0x1a0)?'analysis.health.geminiNight':_0x50804f(0x149);await _0x1b22d[_0x50804f(0x18b)](_0x70374f,{'val':_0x5bb569,'ack':!![]}),_0x1b22d[_0x50804f(0x14d)]['info']('ü§ñ\x20Health\x20Report\x20('+_0x51212b+_0x50804f(0x18f));}catch(_0x3d1e37){_0x1b22d['log'][_0x50804f(0x19f)]('Health\x20Report\x20Error:\x20'+_0x3d1e37[_0x50804f(0x1b2)]);}}function a0_0x1b0e(){const _0x2855b3=['toISOString','.\x20SYSTEM_MODE:\x20','length','N/A\x20(Learning)','LTM.rawEventLog','ltmStbWindowDays','debug','analysis.health.geminiDay','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','automationProposal','description','log','currentSystemMode','detected','.Current.Temperature','push','approved','generateContent','setDate','5374XwEZan','warn','BUTLER\x20Execution\x20Error:\x20','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','üìÖ\x20Daily\x20Digest:\x0a','send','normal','analysis.automation.autoApply','activityLevel','setHours','LTM.driftAnalysis.lastCheck','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','replace','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','config','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','analysis.automation.targetId','analysis.alertReason','reason','val','geminiModel','lastAlertState','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','¬∞C,\x20','LTM.driftAnalysis.baselineDrift','summary','analysis.activitySummary','.\x20KONTEXT:\x20','994XORZkt','getTime','system.presenceWho','join','sendNotification','eventHistory','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','üåÖ\x20Briefing\x20generated\x20(Length:\x20','now','%)\x20nach\x20\x22','Traffic-Schutz\x20(Auto-Approved)','name','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','models/gemini-flash-latest','(((.+)+)+)+$','useWeather','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','Skipped\x20(Traffic)','\x0aSTB:\x20','response','Digest','\x0aAktivit√§t:\x20','setStateAsync','rawEventLog',',\x20Wetter:\x20','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}',')\x20generated.','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','721720JTgKbj','10BBSqFH','dailyDigests','constructor','2113623SZNNsZ','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','Nacht','LTM.processingStatus','analysis.health.geminiNight','ltmLtbWindowDays','targetValue','analysis.automation.description','alertReason','error','NIGHT','value','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','isAlert','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','trim','Keine\x20Details.','581736imgZMd','unshift','text','.forecast.current.state','2988TdoTmo','.Current.IsNight','9cHzroI','analysis.automation.patternDetected','Success','aiPersona','2-digit','message','generic','pop','analysisHistory','getForeignStateAsync','.\x20ANWESEND:\x20','\x0a\x20\x20\x20\x20EVENTS:\x0a','KI-Fehler\x20(Fallback)','Gemini\x20Error:\x20','.\x20EVENTS:\x20','stringify','Unbekannt\x20(Kein\x20Sensor)','analysis.analysisHistory','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','timestamp','exports','ANALYZE_HEALTH','KI\x20offline\x20(Fallback)','weatherInstance','parse','getDate','3444omrlKr','151856sxFlDU','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','analysis.automation.targetValue','driftDetails','.Current.WeatherText','isProVersion','getStateAsync','.\x20EMERGENCY:\x20','livingContext','slice','search','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','toString','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','\x20√ºbersprungen\x20(Auto-Approved).',').\x20Sending\x20notification...','üåÖ\x20Morning\x20Briefing:\x0a','\x20=\x20','analysis.lastResult','LTM.dailyDigests','Unbekannt','targetId','toFixed','info'];a0_0x1b0e=function(){return _0x2855b3;};return a0_0x1b0e();}module[a0_0x2166d5(0x1c1)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};