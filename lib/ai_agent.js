const a0_0x6103de=a0_0x37a3;(function(_0x3d73de,_0x1c0e81){const _0xe0f958=a0_0x37a3,_0x27d06b=_0x3d73de();while(!![]){try{const _0x29c49c=parseInt(_0xe0f958(0xe8))/0x1+-parseInt(_0xe0f958(0xd3))/0x2+-parseInt(_0xe0f958(0xe2))/0x3+parseInt(_0xe0f958(0xa4))/0x4*(-parseInt(_0xe0f958(0xea))/0x5)+-parseInt(_0xe0f958(0x10d))/0x6+parseInt(_0xe0f958(0xb3))/0x7*(parseInt(_0xe0f958(0x9a))/0x8)+-parseInt(_0xe0f958(0x115))/0x9*(-parseInt(_0xe0f958(0xe7))/0xa);if(_0x29c49c===_0x1c0e81)break;else _0x27d06b['push'](_0x27d06b['shift']());}catch(_0x2f7da1){_0x27d06b['push'](_0x27d06b['shift']());}}}(a0_0xa28e,0x34d34));const a0_0x2c3475=(function(){let _0x4af5e3=!![];return function(_0x78d85a,_0xd620a4){const _0x244ea4=_0x4af5e3?function(){const _0x413e42=a0_0x37a3;if(_0xd620a4){const _0x66a01e=_0xd620a4[_0x413e42(0xc7)](_0x78d85a,arguments);return _0xd620a4=null,_0x66a01e;}}:function(){};return _0x4af5e3=![],_0x244ea4;};}()),a0_0x55bfd0=a0_0x2c3475(this,function(){const _0x44e1e6=a0_0x37a3;return a0_0x55bfd0[_0x44e1e6(0x114)]()[_0x44e1e6(0x101)](_0x44e1e6(0x109))['toString']()[_0x44e1e6(0xb0)](a0_0x55bfd0)[_0x44e1e6(0x101)](_0x44e1e6(0x109));});function a0_0x37a3(_0x4e776b,_0xfa6427){const _0x53ca71=a0_0xa28e();return a0_0x37a3=function(_0x55bfd0,_0x2c3475){_0x55bfd0=_0x55bfd0-0x98;let _0xa28e92=_0x53ca71[_0x55bfd0];return _0xa28e92;},a0_0x37a3(_0x4e776b,_0xfa6427);}a0_0x55bfd0();'use strict';const {GoogleGenerativeAI}=require(a0_0x6103de(0x120)),setup=require(a0_0x6103de(0xc0)),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x6103de(0xd8),LTM_DP_STATUS=a0_0x6103de(0xd9),LTM_DP_RAW_LOG=a0_0x6103de(0x105),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':a0_0x6103de(0xdd),'family':a0_0x6103de(0x11b),'single_comfort':a0_0x6103de(0xa2),'security':a0_0x6103de(0xc4),'energy_saver':a0_0x6103de(0xd0)};function canCallApi(){const _0x2a6bd8=a0_0x6103de,_0x38b517=Date[_0x2a6bd8(0xfc)]();return _0x38b517-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x28d5b2=a0_0x6103de;lastGlobalApiCall=Date[_0x28d5b2(0xfc)]();}async function getWeatherContext(_0x5598b7){const _0x2b77dc=a0_0x6103de;if(!_0x5598b7['config']['useWeather']||!_0x5598b7[_0x2b77dc(0xca)][_0x2b77dc(0x108)])return _0x2b77dc(0x119);try{const _0x2b6bef=_0x5598b7['config'][_0x2b77dc(0x108)];let _0x53ed0b=await _0x5598b7[_0x2b77dc(0xb2)](_0x2b6bef+_0x2b77dc(0x10b));if(!_0x53ed0b)_0x53ed0b=await _0x5598b7[_0x2b77dc(0xb2)](_0x2b6bef+_0x2b77dc(0xd5));let _0x1b8483=await _0x5598b7[_0x2b77dc(0xb2)](_0x2b6bef+_0x2b77dc(0xaf));if(!_0x1b8483)_0x1b8483=await _0x5598b7[_0x2b77dc(0xb2)](_0x2b6bef+_0x2b77dc(0x11e));let _0x46af03=_0x2b77dc(0xb5);const _0xbf75a=await _0x5598b7[_0x2b77dc(0xb2)](_0x2b6bef+_0x2b77dc(0x111));if(_0xbf75a)_0x46af03=_0xbf75a[_0x2b77dc(0xe5)]?_0x2b77dc(0x103):_0x2b77dc(0xbc);if(_0x53ed0b&&_0x1b8483)return _0x53ed0b[_0x2b77dc(0xe5)]+'¬∞C,\x20'+_0x1b8483[_0x2b77dc(0xe5)]+_0x2b77dc(0xd2)+_0x46af03;}catch(_0x23267a){}return _0x2b77dc(0xbb);}async function consultButler(_0x504934,_0x5e6685,_0x282878,_0x5daceb){const _0x5c9946=a0_0x6103de;if(!_0x504934['geminiModel'])return{'approved':!![],'reason':_0x5c9946(0xf7)};const _0x3b884c=Date[_0x5c9946(0xfc)]();if(decisionCache[_0x5e6685]&&_0x3b884c-decisionCache[_0x5e6685]['timestamp']<CACHE_TTL_MS){const _0x14d355=decisionCache[_0x5e6685][_0x5c9946(0xfe)];return _0x504934[_0x5c9946(0xdc)][_0x5c9946(0xd7)](_0x5c9946(0xc3)+_0x5e6685+'\x20->\x20'+(_0x14d355['approved']?'OK':'NO')+'\x20('+_0x14d355[_0x5c9946(0xa3)]+')'),_0x14d355;}if(!canCallApi())return _0x504934['log'][_0x5c9946(0xd7)]('ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20'+_0x5e6685+_0x5c9946(0xec)),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x2566b5=new Date()['toLocaleTimeString'](),_0xc2f13a=await getWeatherContext(_0x504934),_0x480ef4=PERSONA_MAPPING[_0x504934[_0x5c9946(0xca)][_0x5c9946(0x112)]||_0x5c9946(0x9f)],_0x32afa9=_0x5c9946(0xef)+_0x2566b5+_0x5c9946(0xf3)+_0xc2f13a+_0x5c9946(0x9e)+(_0x5daceb*0x64)[_0x5c9946(0x11d)](0x0)+_0x5c9946(0xfd)+_0x5e6685+_0x5c9946(0xb4)+_0x282878+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x480ef4+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x248d46=await _0x504934['geminiModel'][_0x5c9946(0x113)](_0x32afa9),_0x11230e=_0x248d46[_0x5c9946(0x106)][_0x5c9946(0xf2)]()[_0x5c9946(0x10c)](/```json|```/g,'')[_0x5c9946(0xed)](),_0x2d07e0=JSON[_0x5c9946(0xac)](_0x11230e);return decisionCache[_0x5e6685]={'decision':_0x2d07e0,'timestamp':_0x3b884c},_0x2d07e0;}catch(_0x3fcaf2){return _0x504934[_0x5c9946(0xdc)]['warn']('ü§ñ\x20Butler\x20Brain\x20Error:\x20'+_0x3fcaf2[_0x5c9946(0xc6)]),decisionCache[_0x5e6685]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x3b884c-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x5c9946(0x11c)};}}async function runGeminiAnalysis(_0x14f1f6,_0x3b9d9d=''){const _0x3ee0de=a0_0x6103de;if(!_0x14f1f6[_0x3ee0de(0x107)])return;if(!canCallApi()){_0x14f1f6['log'][_0x3ee0de(0xd7)]('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x14f1f6[_0x3ee0de(0x11a)]['length']===0x0)return;const _0x404012=_0x14f1f6[_0x3ee0de(0x11a)]['slice'](0x0,0xf),_0x591702=_0x14f1f6['currentSystemMode'],_0x495c65=PERSONA_MAPPING[_0x14f1f6[_0x3ee0de(0xca)][_0x3ee0de(0x112)]||'generic'],_0x5633ef=_0x14f1f6[_0x3ee0de(0xca)][_0x3ee0de(0xeb)]||_0x3ee0de(0xb1);let _0x4cc397=_0x3ee0de(0xb5);try{const _0x3456bf=await _0x14f1f6[_0x3ee0de(0xa1)](_0x3ee0de(0xab));if(_0x3456bf&&_0x3456bf[_0x3ee0de(0xe5)])_0x4cc397=_0x3456bf['val'];}catch(_0x557c2d){}let _0x359eb3=![];try{const _0x35e64e=await _0x14f1f6[_0x3ee0de(0xa1)](_0x3ee0de(0xb7));if(_0x35e64e&&_0x35e64e['val'])_0x359eb3=!![];}catch(_0x2f9a57){}const _0x10adde=_0x3ee0de(0xf4)+_0x495c65+'.\x20KONTEXT:\x20'+_0x5633ef+'.\x20SYSTEM_MODE:\x20'+_0x591702+_0x3ee0de(0xde)+_0x4cc397+_0x3ee0de(0xe4)+JSON['stringify'](_0x404012)+_0x3ee0de(0xdb)+_0x3b9d9d+_0x3ee0de(0x9b);try{updateApiTimestamp();const _0x470759=await _0x14f1f6[_0x3ee0de(0x107)][_0x3ee0de(0x113)](_0x10adde),_0x53285a=JSON[_0x3ee0de(0xac)](_0x470759['response'][_0x3ee0de(0xf2)]()[_0x3ee0de(0x10c)](/```json|```/g,'')['trim']());await _0x14f1f6[_0x3ee0de(0x110)](_0x3ee0de(0xc2),{'val':JSON[_0x3ee0de(0xf1)](_0x53285a),'ack':!![]});if(_0x53285a[_0x3ee0de(0xad)])await _0x14f1f6[_0x3ee0de(0x110)](_0x3ee0de(0xe0),{'val':_0x53285a['summary'],'ack':!![]});const _0x1dcf8d={'timestamp':Date['now'](),'id':Date[_0x3ee0de(0xfc)]()[_0x3ee0de(0x114)](),'analysis':{'activity':{'summary':_0x53285a[_0x3ee0de(0xad)],'isAlert':_0x53285a[_0x3ee0de(0xc8)],'alertReason':_0x53285a[_0x3ee0de(0xcc)]},'comfort':{'automationProposal':_0x53285a[_0x3ee0de(0xfa)]}}};_0x14f1f6['analysisHistory']['unshift'](_0x1dcf8d);if(_0x14f1f6['analysisHistory'][_0x3ee0de(0x104)]>0x32)_0x14f1f6[_0x3ee0de(0x11f)][_0x3ee0de(0x9c)]();await _0x14f1f6['setStateAsync'](_0x3ee0de(0xb6),{'val':JSON[_0x3ee0de(0xf1)](_0x14f1f6[_0x3ee0de(0x11f)]),'ack':!![]});const _0x7d24a9=_0x53285a[_0x3ee0de(0xc8)]||![];_0x7d24a9!==_0x14f1f6[_0x3ee0de(0xf8)]&&(await _0x14f1f6[_0x3ee0de(0x110)](_0x3ee0de(0xee),{'val':_0x7d24a9,'ack':!![]}),_0x14f1f6[_0x3ee0de(0xf8)]=_0x7d24a9,_0x7d24a9&&(await _0x14f1f6[_0x3ee0de(0x110)](_0x3ee0de(0xf0),{'val':_0x53285a[_0x3ee0de(0xcc)],'ack':!![]}),setup[_0x3ee0de(0xcf)](_0x14f1f6,_0x3ee0de(0xbf)+_0x53285a['alertReason'],![],_0x53285a[_0x3ee0de(0xa9)])));if(_0x53285a[_0x3ee0de(0xfa)]&&_0x53285a[_0x3ee0de(0xfa)][_0x3ee0de(0xe9)]){await _0x14f1f6['setStateAsync'](_0x3ee0de(0x9d),{'val':!![],'ack':!![]}),await _0x14f1f6['setStateAsync'](_0x3ee0de(0xa6),{'val':_0x53285a[_0x3ee0de(0xfa)][_0x3ee0de(0x10a)],'ack':!![]}),await _0x14f1f6[_0x3ee0de(0x110)](_0x3ee0de(0x98),{'val':_0x53285a['automationProposal'][_0x3ee0de(0xf5)],'ack':!![]}),await _0x14f1f6[_0x3ee0de(0x110)](_0x3ee0de(0xa7),{'val':JSON[_0x3ee0de(0xf1)](_0x53285a[_0x3ee0de(0xfa)][_0x3ee0de(0xba)]),'ack':!![]});if(_0x359eb3)executeAutomationAction(_0x14f1f6);}}catch(_0x2aa4dc){_0x14f1f6['log'][_0x3ee0de(0xb8)]('Gemini\x20Error:\x20'+_0x2aa4dc[_0x3ee0de(0xc6)]);}}async function createDailyDigest(_0x4a20a8,_0x35d7ce){const _0x2ee9d1=a0_0x6103de;if(!_0x4a20a8['isProVersion'])return;if(!canCallApi()){await _0x4a20a8[_0x2ee9d1(0x110)](LTM_DP_STATUS,{'val':'Skipped\x20(Traffic)','ack':!![]});return;}await _0x4a20a8[_0x2ee9d1(0x110)](LTM_DP_STATUS,{'val':_0x2ee9d1(0xdf),'ack':!![]});if(!_0x4a20a8[_0x2ee9d1(0x107)]||_0x4a20a8[_0x2ee9d1(0xb9)][_0x2ee9d1(0x104)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4a20a8[_0x2ee9d1(0x110)](LTM_DP_STATUS,{'val':_0x2ee9d1(0xce),'ack':!![]});return;}const _0x572d67=JSON[_0x2ee9d1(0xac)](JSON['stringify'](_0x4a20a8[_0x2ee9d1(0xb9)])),_0x295dd3=_0x572d67[_0x2ee9d1(0x104)],_0x5b6fc8=_0x2ee9d1(0xa8)+JSON[_0x2ee9d1(0xf1)](_0x572d67);try{updateApiTimestamp();const _0x336243=await _0x4a20a8[_0x2ee9d1(0x107)][_0x2ee9d1(0x113)](_0x5b6fc8),_0x32db24=JSON[_0x2ee9d1(0xac)](_0x336243[_0x2ee9d1(0x106)][_0x2ee9d1(0xf2)]()['replace'](/```json|```/g,'')[_0x2ee9d1(0xed)]()),_0x40c835={'timestamp':new Date()[_0x2ee9d1(0x100)](),'eventCount':_0x295dd3,'summary':_0x32db24[_0x2ee9d1(0xad)]||_0x2ee9d1(0xbd),'activityLevel':_0x32db24['activityLevel']||_0x2ee9d1(0xf6),'systemMode':_0x4a20a8[_0x2ee9d1(0xa0)]};_0x4a20a8['dailyDigests'][_0x2ee9d1(0xbe)](_0x40c835);const _0x2d86b2=_0x4a20a8[_0x2ee9d1(0xca)]['ltmLtbWindowDays']||0x3c;_0x4a20a8[_0x2ee9d1(0xd4)][_0x2ee9d1(0x104)]>_0x2d86b2&&_0x4a20a8['dailyDigests'][_0x2ee9d1(0xae)](0x0,_0x4a20a8['dailyDigests'][_0x2ee9d1(0x104)]-_0x2d86b2);await _0x4a20a8[_0x2ee9d1(0x110)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2ee9d1(0xf1)](_0x4a20a8[_0x2ee9d1(0xd4)]),'ack':!![]}),_0x4a20a8[_0x2ee9d1(0xb9)]=[],await _0x4a20a8['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x2ee9d1(0xf1)](_0x4a20a8[_0x2ee9d1(0xb9)]),'ack':!![]}),await _0x4a20a8[_0x2ee9d1(0x110)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x8bd066=_0x2ee9d1(0xe6)+_0x32db24[_0x2ee9d1(0xad)]+_0x2ee9d1(0x116)+_0x32db24[_0x2ee9d1(0xcb)];setup[_0x2ee9d1(0xcf)](_0x4a20a8,_0x8bd066,![],![]);if(_0x4a20a8[_0x2ee9d1(0x99)]&&_0x35d7ce)_0x35d7ce[_0x2ee9d1(0xcd)](_0x4a20a8,'ANALYZE_HEALTH',{'digest':_0x40c835});}catch(_0x254f37){_0x4a20a8['log'][_0x2ee9d1(0xb8)](_0x254f37['message']);}}function a0_0xa28e(){const _0x33d71c=['toISOString','search','slice','Nacht','length','LTM.rawEventLog','response','geminiModel','weatherInstance','(((.+)+)+)+$','description','.Current.Temperature','replace','1109790JtuHCU','warn','N/A\x20(Learning)','setStateAsync','.Current.IsNight','aiPersona','generateContent','toString','2366784xMhqTB','\x0aAktivit√§t:\x20','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','LTM.driftAnalysis.baselineDrift','Unbekannt\x20(Kein\x20Sensor)','eventHistory','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','KI-Fehler\x20(Fallback)','toFixed','.forecast.current.state','analysisHistory','@google/generative-ai','analysis.automation.targetId','isProVersion','2792144QSXhTR','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','pop','analysis.automation.patternDetected','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','generic','currentSystemMode','getStateAsync','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','reason','4GNLUBf','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','analysis.automation.description','analysis.automation.targetValue','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','isEmergency','\x0aSTB:\x20','system.presenceWho','parse','summary','splice','.Current.WeatherText','constructor','Keine\x20Details.','getForeignStateAsync','7VWTAql','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','Unbekannt','analysis.analysisHistory','analysis.automation.autoApply','error','rawEventLog','targetValue','Wetterdaten\x20nicht\x20abrufbar','Tag','Digest','push','‚ö†Ô∏è\x20ALARM:\x20','./setup','üåÖ\x20Morning\x20Briefing:\x0a','analysis.lastResult','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','Sicherheit\x20geht\x20vor.','driftDetails','message','apply','isAlert','info','config','activityLevel','alertReason','send','Skipped\x20(No\x20AI\x20or\x20Data)','sendNotification','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','LTM.driftAnalysis.lastCheck',',\x20Lichtverh√§ltnisse:\x20','606100LbKgIp','dailyDigests','.forecast.current.temperature','LTM.driftAnalysis.driftDetails','debug','LTM.dailyDigests','LTM.processingStatus','exports','.\x20EMERGENCY:\x20','log','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','.\x20ANWESEND:\x20','Started...','analysis.activitySummary','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','754314dVHgzY','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','.\x20EVENTS:\x20','val','üìÖ\x20Daily\x20Digest:\x0a','10SaldoS','429738WIEAtm','detected','429535BIFSup','livingContext','\x20√ºbersprungen\x20(Auto-Approved).','trim','analysis.isAlert','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','analysis.alertReason','stringify','text',',\x20Wetter:\x20','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','targetId','normal','KI\x20offline\x20(Fallback)','lastAlertState','Briefing\x20Error:\x20','automationProposal','ltmStbWindowDays','now','%)\x20nach\x20\x22','decision','üåÖ\x20Briefing\x20generated\x20(Length:\x20'];a0_0xa28e=function(){return _0x33d71c;};return a0_0xa28e();}async function runBaselineDriftAnalysis(_0x2a8943){const _0x420556=a0_0x6103de;if(!_0x2a8943[_0x420556(0x99)]||!_0x2a8943[_0x420556(0x107)])return;if(!canCallApi())return;const _0x4792e0=_0x2a8943[_0x420556(0xca)][_0x420556(0xfb)]||0xe;if(_0x2a8943[_0x420556(0xd4)]['length']<_0x4792e0+0x7){await _0x2a8943['setStateAsync'](_0x420556(0x118),{'val':_0x420556(0x10f),'ack':!![]});return;}const _0x9ea475=_0x2a8943[_0x420556(0xd4)][_0x420556(0x102)](-_0x4792e0),_0x29093e=_0x2a8943[_0x420556(0xd4)][_0x420556(0x102)](0x0,_0x2a8943[_0x420556(0xd4)]['length']-_0x4792e0),_0x1a615f=_0x420556(0xe3)+JSON['stringify'](_0x29093e)+_0x420556(0xaa)+JSON[_0x420556(0xf1)](_0x9ea475);try{updateApiTimestamp();const _0x2b1e95=await _0x2a8943[_0x420556(0x107)][_0x420556(0x113)](_0x1a615f),_0x2b66fc=JSON[_0x420556(0xac)](_0x2b1e95[_0x420556(0x106)][_0x420556(0xf2)]()[_0x420556(0x10c)](/```json|```/g,'')[_0x420556(0xed)]());_0x2b66fc['baselineDrift']&&(await _0x2a8943[_0x420556(0x110)](_0x420556(0x118),{'val':_0x2b66fc['baselineDrift'],'ack':!![]}),await _0x2a8943['setStateAsync'](_0x420556(0xd6),{'val':_0x2b66fc[_0x420556(0xc5)],'ack':!![]}),await _0x2a8943['setStateAsync'](_0x420556(0xd1),{'val':Date['now'](),'ack':!![]}));}catch(_0x2bc0e2){}}async function executeAutomationAction(_0x49e981){const _0x5d7669=a0_0x6103de;try{const _0x1399c8=await _0x49e981[_0x5d7669(0xa1)]('analysis.automation.targetId'),_0x4798ce=await _0x49e981['getStateAsync'](_0x5d7669(0xa7));if(_0x1399c8&&_0x1399c8[_0x5d7669(0xe5)]&&_0x4798ce){const _0x4bed33=_0x1399c8[_0x5d7669(0xe5)];let _0x41739b=_0x4798ce[_0x5d7669(0xe5)];try{_0x41739b=JSON['parse'](_0x41739b);}catch(_0x1f4fdf){}_0x49e981[_0x5d7669(0xdc)][_0x5d7669(0xc9)](_0x5d7669(0xa5)+_0x4bed33+'\x20=\x20'+_0x41739b),await _0x49e981['setForeignStateAsync'](_0x4bed33,_0x41739b);}else _0x49e981[_0x5d7669(0xdc)][_0x5d7669(0x10e)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x1583ee){_0x49e981['log'][_0x5d7669(0xb8)]('BUTLER\x20Execution\x20Error:\x20'+_0x1583ee[_0x5d7669(0xc6)]);}}async function sendMorningBriefing(_0x41852d){const _0x13412b=a0_0x6103de;if(!_0x41852d[_0x13412b(0x107)]){_0x41852d[_0x13412b(0xdc)][_0x13412b(0x10e)](_0x13412b(0x117));return;}_0x41852d[_0x13412b(0xdc)][_0x13412b(0xc9)](_0x13412b(0xe1));try{updateApiTimestamp();const _0x2e2b95='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x16cff6=await _0x41852d[_0x13412b(0x107)][_0x13412b(0x113)](_0x2e2b95),_0x5d5ba6=_0x16cff6[_0x13412b(0x106)]['text']();_0x41852d[_0x13412b(0xdc)]['info'](_0x13412b(0xff)+_0x5d5ba6[_0x13412b(0x104)]+').\x20Sending\x20notification...'),setup[_0x13412b(0xcf)](_0x41852d,_0x13412b(0xc1)+_0x5d5ba6);}catch(_0x391b43){_0x41852d['log'][_0x13412b(0xb8)](_0x13412b(0xf9)+_0x391b43[_0x13412b(0xc6)]);}}module[a0_0x6103de(0xda)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};