const a0_0x4114b8=a0_0x49fc;(function(_0x3f3e54,_0x54e238){const _0x135074=a0_0x49fc,_0x4fa4ca=_0x3f3e54();while(!![]){try{const _0x1a718d=-parseInt(_0x135074(0x1b0))/0x1+parseInt(_0x135074(0x221))/0x2+-parseInt(_0x135074(0x205))/0x3+parseInt(_0x135074(0x226))/0x4*(-parseInt(_0x135074(0x1ba))/0x5)+-parseInt(_0x135074(0x1f8))/0x6*(-parseInt(_0x135074(0x1fd))/0x7)+parseInt(_0x135074(0x1eb))/0x8+parseInt(_0x135074(0x1aa))/0x9;if(_0x1a718d===_0x54e238)break;else _0x4fa4ca['push'](_0x4fa4ca['shift']());}catch(_0x31db94){_0x4fa4ca['push'](_0x4fa4ca['shift']());}}}(a0_0x3b87,0xea583));const a0_0x3f66d0=(function(){let _0x5496c3=!![];return function(_0x118484,_0x3cbfb1){const _0x544518=_0x5496c3?function(){const _0x5bfabd=a0_0x49fc;if(_0x3cbfb1){const _0x599c02=_0x3cbfb1[_0x5bfabd(0x214)](_0x118484,arguments);return _0x3cbfb1=null,_0x599c02;}}:function(){};return _0x5496c3=![],_0x544518;};}()),a0_0xa75b7e=a0_0x3f66d0(this,function(){const _0x4a8c0d=a0_0x49fc;return a0_0xa75b7e[_0x4a8c0d(0x1bf)]()[_0x4a8c0d(0x20b)](_0x4a8c0d(0x208))[_0x4a8c0d(0x1bf)]()['constructor'](a0_0xa75b7e)[_0x4a8c0d(0x20b)]('(((.+)+)+)+$');});function a0_0x49fc(_0x31409b,_0x53d831){const _0x2ebf66=a0_0x3b87();return a0_0x49fc=function(_0xa75b7e,_0x3f66d0){_0xa75b7e=_0xa75b7e-0x1a9;let _0x3b87d1=_0x2ebf66[_0xa75b7e];return _0x3b87d1;},a0_0x49fc(_0x31409b,_0x53d831);}a0_0xa75b7e();'use strict';const {GoogleGenerativeAI}=require('@google/generative-ai'),setup=require('./setup'),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x4114b8(0x1c1),LTM_DP_STATUS=a0_0x4114b8(0x1b9),LTM_DP_RAW_LOG=a0_0x4114b8(0x1f4),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x4114b8(0x1d8),'senior_aal':a0_0x4114b8(0x1d7),'family':'Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','single_comfort':a0_0x4114b8(0x1ed),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x4114b8(0x202)};function canCallApi(){const _0x3eef62=Date['now']();return _0x3eef62-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x394926=a0_0x4114b8;lastGlobalApiCall=Date[_0x394926(0x1d0)]();}function a0_0x3b87(){const _0x20c0b7=['Unbekannt\x20(Kein\x20Sensor)','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','generic','KI-Fehler\x20(Fallback)','Skipped\x20(No\x20AI\x20or\x20Data)','livingContext','replace','error','length','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','weatherInstance','currentSystemMode','Briefing\x20Error:\x20','toISOString','activityLevel','push','Skipped\x20(Traffic)','7151608lAwohE','val','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','¬∞C,\x20','üåÖ\x20Morning\x20Briefing:\x0a','getForeignStateAsync','analysis.automation.targetValue','targetValue','config','LTM.rawEventLog','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','analysis.automation.patternDetected','analysis.activitySummary','6fUCtEb','lastAlertState','.Current.Temperature','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','aiPersona','3560879ttMfXj',',\x20Lichtverh√§ltnisse:\x20','Traffic-Schutz\x20(Auto-Approved)','.Current.WeatherText','eventHistory','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','sendNotification','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','2739231eeaUlU','splice','automationProposal','(((.+)+)+)+$','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','stringify','search','analysis.alertReason','analysis.automation.description','Wetterdaten\x20nicht\x20abrufbar','summary','getStateAsync','ANALYZE_HEALTH',',\x20Wetter:\x20','geminiModel','apply','BUTLER\x20Execution\x20Error:\x20','Success','log','detected','toLocaleTimeString','setStateAsync','LTM.driftAnalysis.baselineDrift','system.presenceWho','Keine\x20Details.','message','slice','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','255918worxLF','analysis.automation.targetId','LTM.driftAnalysis.lastCheck','isProVersion','useWeather','4QbpMLI','dailyDigests','alertReason','analysis.analysisHistory','\x20->\x20','.\x20EMERGENCY:\x20','Unbekannt','19614132keZacV','approved','rawEventLog','unshift','reason','\x20=\x20','1267341yrvHMc','decision','.forecast.current.state','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','.\x20ANWESEND:\x20','isEmergency','toFixed','debug','analysisHistory','LTM.processingStatus','2848310esYNby','LTM.driftAnalysis.driftDetails','text','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','warn','toString','N/A\x20(Learning)','LTM.dailyDigests','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','trim','description','response','setForeignStateAsync','baselineDrift','parse','pop','analysis.automation.autoApply','\x0aSTB:\x20','‚ö†Ô∏è\x20ALARM:\x20','normal','now','Tag','.\x20KONTEXT:\x20','Nacht','.\x20EVENTS:\x20','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','generateContent','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).'];a0_0x3b87=function(){return _0x20c0b7;};return a0_0x3b87();}async function getWeatherContext(_0x79ee41){const _0xd50d31=a0_0x4114b8;if(!_0x79ee41[_0xd50d31(0x1f3)][_0xd50d31(0x225)]||!_0x79ee41['config'][_0xd50d31(0x1e4)])return _0xd50d31(0x1da);try{const _0x431ec4=_0x79ee41[_0xd50d31(0x1f3)][_0xd50d31(0x1e4)];let _0x5c9907=await _0x79ee41[_0xd50d31(0x1f0)](_0x431ec4+_0xd50d31(0x1fa));if(!_0x5c9907)_0x5c9907=await _0x79ee41['getForeignStateAsync'](_0x431ec4+'.forecast.current.temperature');let _0x2cd5f5=await _0x79ee41[_0xd50d31(0x1f0)](_0x431ec4+_0xd50d31(0x200));if(!_0x2cd5f5)_0x2cd5f5=await _0x79ee41['getForeignStateAsync'](_0x431ec4+_0xd50d31(0x1b2));let _0x2ffc6c=_0xd50d31(0x1a9);const _0x41f366=await _0x79ee41['getForeignStateAsync'](_0x431ec4+'.Current.IsNight');if(_0x41f366)_0x2ffc6c=_0x41f366[_0xd50d31(0x1ec)]?_0xd50d31(0x1d3):_0xd50d31(0x1d1);if(_0x5c9907&&_0x2cd5f5)return _0x5c9907['val']+_0xd50d31(0x1ee)+_0x2cd5f5[_0xd50d31(0x1ec)]+_0xd50d31(0x1fe)+_0x2ffc6c;}catch(_0x43841b){}return _0xd50d31(0x20e);}async function consultButler(_0x4d4a6b,_0x461deb,_0x3eed18,_0x5174c4){const _0x5c18a6=a0_0x4114b8;if(!_0x4d4a6b[_0x5c18a6(0x213)])return{'approved':!![],'reason':'KI\x20offline\x20(Fallback)'};const _0x9bbd7b=Date['now']();if(decisionCache[_0x461deb]&&_0x9bbd7b-decisionCache[_0x461deb]['timestamp']<CACHE_TTL_MS){const _0x406a1d=decisionCache[_0x461deb][_0x5c18a6(0x1b1)];return _0x4d4a6b[_0x5c18a6(0x217)][_0x5c18a6(0x1b7)](_0x5c18a6(0x1bd)+_0x461deb+_0x5c18a6(0x22a)+(_0x406a1d[_0x5c18a6(0x1ab)]?'OK':'NO')+'\x20('+_0x406a1d[_0x5c18a6(0x1ae)]+')'),_0x406a1d;}if(!canCallApi())return _0x4d4a6b[_0x5c18a6(0x217)]['debug'](_0x5c18a6(0x1c4)+_0x461deb+'\x20√ºbersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x5c18a6(0x1ff)};const _0x34d3da=new Date()[_0x5c18a6(0x219)](),_0x3ad354=await getWeatherContext(_0x4d4a6b),_0x2c32eb=PERSONA_MAPPING[_0x4d4a6b[_0x5c18a6(0x1f3)][_0x5c18a6(0x1fc)]||_0x5c18a6(0x1dc)],_0x3d531f=_0x5c18a6(0x220)+_0x34d3da+_0x5c18a6(0x212)+_0x3ad354+_0x5c18a6(0x1b3)+(_0x5174c4*0x64)[_0x5c18a6(0x1b6)](0x0)+'%)\x20nach\x20\x22'+_0x461deb+_0x5c18a6(0x1fb)+_0x3eed18+_0x5c18a6(0x204)+_0x2c32eb+_0x5c18a6(0x1d5);try{updateApiTimestamp();const _0x1039f8=await _0x4d4a6b[_0x5c18a6(0x213)][_0x5c18a6(0x1d6)](_0x3d531f),_0x5ef409=_0x1039f8[_0x5c18a6(0x1c7)]['text']()[_0x5c18a6(0x1e0)](/```json|```/g,'')['trim'](),_0x153657=JSON['parse'](_0x5ef409);return decisionCache[_0x461deb]={'decision':_0x153657,'timestamp':_0x9bbd7b},_0x153657;}catch(_0x2fe369){return _0x4d4a6b[_0x5c18a6(0x217)][_0x5c18a6(0x1be)]('ü§ñ\x20Butler\x20Brain\x20Error:\x20'+_0x2fe369[_0x5c18a6(0x21e)]),decisionCache[_0x461deb]={'decision':{'approved':!![],'reason':_0x5c18a6(0x1dd)},'timestamp':_0x9bbd7b-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x5c18a6(0x1dd)};}}async function runGeminiAnalysis(_0x4b7e32,_0x14b935=''){const _0x5a26b8=a0_0x4114b8;if(!_0x4b7e32[_0x5a26b8(0x213)])return;if(!canCallApi()){_0x4b7e32['log'][_0x5a26b8(0x1b7)](_0x5a26b8(0x1d9));return;}if(_0x4b7e32[_0x5a26b8(0x201)]['length']===0x0)return;const _0x345257=_0x4b7e32[_0x5a26b8(0x201)][_0x5a26b8(0x21f)](0x0,0xf),_0x57e204=_0x4b7e32['currentSystemMode'],_0x2b42e0=PERSONA_MAPPING[_0x4b7e32['config'][_0x5a26b8(0x1fc)]||_0x5a26b8(0x1dc)],_0xeefd55=_0x4b7e32[_0x5a26b8(0x1f3)][_0x5a26b8(0x1df)]||_0x5a26b8(0x21d);let _0x4c1a6f=_0x5a26b8(0x1a9);try{const _0x345374=await _0x4b7e32[_0x5a26b8(0x210)](_0x5a26b8(0x21c));if(_0x345374&&_0x345374[_0x5a26b8(0x1ec)])_0x4c1a6f=_0x345374[_0x5a26b8(0x1ec)];}catch(_0x443244){}let _0x1371b9=![];try{const _0x81f20e=await _0x4b7e32[_0x5a26b8(0x210)](_0x5a26b8(0x1cc));if(_0x81f20e&&_0x81f20e['val'])_0x1371b9=!![];}catch(_0x57b61f){}const _0x54c368=_0x5a26b8(0x1e3)+_0x2b42e0+_0x5a26b8(0x1d2)+_0xeefd55+'.\x20SYSTEM_MODE:\x20'+_0x57e204+_0x5a26b8(0x1b4)+_0x4c1a6f+_0x5a26b8(0x1d4)+JSON['stringify'](_0x345257)+_0x5a26b8(0x22b)+_0x14b935+_0x5a26b8(0x1c2);try{updateApiTimestamp();const _0x3d691d=await _0x4b7e32[_0x5a26b8(0x213)][_0x5a26b8(0x1d6)](_0x54c368),_0x67eb38=JSON[_0x5a26b8(0x1ca)](_0x3d691d[_0x5a26b8(0x1c7)][_0x5a26b8(0x1bc)]()[_0x5a26b8(0x1e0)](/```json|```/g,'')[_0x5a26b8(0x1c5)]());await _0x4b7e32['setStateAsync']('analysis.lastResult',{'val':JSON['stringify'](_0x67eb38),'ack':!![]});if(_0x67eb38['summary'])await _0x4b7e32[_0x5a26b8(0x21a)](_0x5a26b8(0x1f7),{'val':_0x67eb38[_0x5a26b8(0x20f)],'ack':!![]});const _0x2f4a8b={'timestamp':Date[_0x5a26b8(0x1d0)](),'id':Date[_0x5a26b8(0x1d0)]()[_0x5a26b8(0x1bf)](),'analysis':{'activity':{'summary':_0x67eb38['summary'],'isAlert':_0x67eb38['isAlert'],'alertReason':_0x67eb38[_0x5a26b8(0x228)]},'comfort':{'automationProposal':_0x67eb38[_0x5a26b8(0x207)]}}};_0x4b7e32[_0x5a26b8(0x1b8)][_0x5a26b8(0x1ad)](_0x2f4a8b);if(_0x4b7e32['analysisHistory']['length']>0x32)_0x4b7e32[_0x5a26b8(0x1b8)][_0x5a26b8(0x1cb)]();await _0x4b7e32[_0x5a26b8(0x21a)](_0x5a26b8(0x229),{'val':JSON['stringify'](_0x4b7e32['analysisHistory']),'ack':!![]});const _0x4ec211=_0x67eb38['isAlert']||![];_0x4ec211!==_0x4b7e32['lastAlertState']&&(await _0x4b7e32[_0x5a26b8(0x21a)]('analysis.isAlert',{'val':_0x4ec211,'ack':!![]}),_0x4b7e32[_0x5a26b8(0x1f9)]=_0x4ec211,_0x4ec211&&(await _0x4b7e32[_0x5a26b8(0x21a)](_0x5a26b8(0x20c),{'val':_0x67eb38[_0x5a26b8(0x228)],'ack':!![]}),setup[_0x5a26b8(0x203)](_0x4b7e32,_0x5a26b8(0x1ce)+_0x67eb38[_0x5a26b8(0x228)],![],_0x67eb38[_0x5a26b8(0x1b5)])));if(_0x67eb38['automationProposal']&&_0x67eb38[_0x5a26b8(0x207)][_0x5a26b8(0x218)]){await _0x4b7e32['setStateAsync'](_0x5a26b8(0x1f6),{'val':!![],'ack':!![]}),await _0x4b7e32['setStateAsync'](_0x5a26b8(0x20d),{'val':_0x67eb38[_0x5a26b8(0x207)][_0x5a26b8(0x1c6)],'ack':!![]}),await _0x4b7e32[_0x5a26b8(0x21a)](_0x5a26b8(0x222),{'val':_0x67eb38[_0x5a26b8(0x207)]['targetId'],'ack':!![]}),await _0x4b7e32[_0x5a26b8(0x21a)](_0x5a26b8(0x1f1),{'val':JSON[_0x5a26b8(0x20a)](_0x67eb38[_0x5a26b8(0x207)][_0x5a26b8(0x1f2)]),'ack':!![]});if(_0x1371b9)executeAutomationAction(_0x4b7e32);}}catch(_0x48114b){_0x4b7e32['log'][_0x5a26b8(0x1e1)]('Gemini\x20Error:\x20'+_0x48114b[_0x5a26b8(0x21e)]);}}async function createDailyDigest(_0x3190f1,_0x3a1b16){const _0x475740=a0_0x4114b8;if(!_0x3190f1[_0x475740(0x224)])return;if(!canCallApi()){await _0x3190f1[_0x475740(0x21a)](LTM_DP_STATUS,{'val':_0x475740(0x1ea),'ack':!![]});return;}await _0x3190f1[_0x475740(0x21a)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x3190f1[_0x475740(0x213)]||_0x3190f1[_0x475740(0x1ac)][_0x475740(0x1e2)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3190f1[_0x475740(0x21a)](LTM_DP_STATUS,{'val':_0x475740(0x1de),'ack':!![]});return;}const _0xf46c11=JSON[_0x475740(0x1ca)](JSON[_0x475740(0x20a)](_0x3190f1[_0x475740(0x1ac)])),_0x40ebe6=_0xf46c11[_0x475740(0x1e2)],_0x23a66c=_0x475740(0x1c3)+JSON['stringify'](_0xf46c11);try{updateApiTimestamp();const _0x1733dc=await _0x3190f1[_0x475740(0x213)]['generateContent'](_0x23a66c),_0x5190e8=JSON['parse'](_0x1733dc[_0x475740(0x1c7)][_0x475740(0x1bc)]()['replace'](/```json|```/g,'')[_0x475740(0x1c5)]()),_0x1c2d9f={'timestamp':new Date()[_0x475740(0x1e7)](),'eventCount':_0x40ebe6,'summary':_0x5190e8[_0x475740(0x20f)]||'Digest','activityLevel':_0x5190e8[_0x475740(0x1e8)]||_0x475740(0x1cf),'systemMode':_0x3190f1[_0x475740(0x1e5)]};_0x3190f1['dailyDigests'][_0x475740(0x1e9)](_0x1c2d9f);const _0x108f00=_0x3190f1[_0x475740(0x1f3)]['ltmLtbWindowDays']||0x3c;_0x3190f1[_0x475740(0x227)][_0x475740(0x1e2)]>_0x108f00&&_0x3190f1[_0x475740(0x227)][_0x475740(0x206)](0x0,_0x3190f1[_0x475740(0x227)][_0x475740(0x1e2)]-_0x108f00);await _0x3190f1[_0x475740(0x21a)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x475740(0x20a)](_0x3190f1['dailyDigests']),'ack':!![]}),_0x3190f1[_0x475740(0x1ac)]=[],await _0x3190f1[_0x475740(0x21a)](LTM_DP_RAW_LOG,{'val':JSON[_0x475740(0x20a)](_0x3190f1[_0x475740(0x1ac)]),'ack':!![]}),await _0x3190f1[_0x475740(0x21a)](LTM_DP_STATUS,{'val':_0x475740(0x216),'ack':!![]});if(_0x3190f1[_0x475740(0x224)]&&_0x3a1b16)_0x3a1b16['send'](_0x3190f1,_0x475740(0x211),{'digest':_0x1c2d9f});}catch(_0x57ebd6){_0x3190f1[_0x475740(0x217)][_0x475740(0x1e1)](_0x57ebd6[_0x475740(0x21e)]);}}async function runBaselineDriftAnalysis(_0x2c5fc0){const _0x2d6afd=a0_0x4114b8;if(!_0x2c5fc0[_0x2d6afd(0x224)]||!_0x2c5fc0[_0x2d6afd(0x213)])return;if(!canCallApi())return;const _0x52e3a8=_0x2c5fc0[_0x2d6afd(0x1f3)]['ltmStbWindowDays']||0xe;if(_0x2c5fc0[_0x2d6afd(0x227)][_0x2d6afd(0x1e2)]<_0x52e3a8+0x7){await _0x2c5fc0[_0x2d6afd(0x21a)]('LTM.driftAnalysis.baselineDrift',{'val':_0x2d6afd(0x1c0),'ack':!![]});return;}const _0x95ea4a=_0x2c5fc0[_0x2d6afd(0x227)][_0x2d6afd(0x21f)](-_0x52e3a8),_0x58fa64=_0x2c5fc0[_0x2d6afd(0x227)][_0x2d6afd(0x21f)](0x0,_0x2c5fc0['dailyDigests'][_0x2d6afd(0x1e2)]-_0x52e3a8),_0x1c4ee8=_0x2d6afd(0x1f5)+JSON[_0x2d6afd(0x20a)](_0x58fa64)+_0x2d6afd(0x1cd)+JSON[_0x2d6afd(0x20a)](_0x95ea4a);try{updateApiTimestamp();const _0xb3cc4d=await _0x2c5fc0[_0x2d6afd(0x213)][_0x2d6afd(0x1d6)](_0x1c4ee8),_0x1d1ffc=JSON[_0x2d6afd(0x1ca)](_0xb3cc4d[_0x2d6afd(0x1c7)][_0x2d6afd(0x1bc)]()['replace'](/```json|```/g,'')['trim']());_0x1d1ffc[_0x2d6afd(0x1c9)]&&(await _0x2c5fc0[_0x2d6afd(0x21a)](_0x2d6afd(0x21b),{'val':_0x1d1ffc[_0x2d6afd(0x1c9)],'ack':!![]}),await _0x2c5fc0[_0x2d6afd(0x21a)](_0x2d6afd(0x1bb),{'val':_0x1d1ffc['driftDetails'],'ack':!![]}),await _0x2c5fc0[_0x2d6afd(0x21a)](_0x2d6afd(0x223),{'val':Date[_0x2d6afd(0x1d0)](),'ack':!![]}));}catch(_0x3120fc){}}async function executeAutomationAction(_0x27f827){const _0x1bb06c=a0_0x4114b8;try{const _0x4336df=await _0x27f827['getStateAsync'](_0x1bb06c(0x222)),_0x17b72=await _0x27f827[_0x1bb06c(0x210)]('analysis.automation.targetValue');if(_0x4336df&&_0x4336df[_0x1bb06c(0x1ec)]&&_0x17b72){const _0x166b65=_0x4336df[_0x1bb06c(0x1ec)];let _0x3513d8=_0x17b72[_0x1bb06c(0x1ec)];try{_0x3513d8=JSON['parse'](_0x3513d8);}catch(_0x50bf38){}_0x27f827[_0x1bb06c(0x217)]['info'](_0x1bb06c(0x209)+_0x166b65+_0x1bb06c(0x1af)+_0x3513d8),await _0x27f827[_0x1bb06c(0x1c8)](_0x166b65,_0x3513d8);}else _0x27f827[_0x1bb06c(0x217)][_0x1bb06c(0x1be)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x3c9e30){_0x27f827[_0x1bb06c(0x217)][_0x1bb06c(0x1e1)](_0x1bb06c(0x215)+_0x3c9e30[_0x1bb06c(0x21e)]);}}async function sendMorningBriefing(_0xf5a1a5){const _0x2a40bc=a0_0x4114b8;if(!_0xf5a1a5['geminiModel'])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x128cf3=_0x2a40bc(0x1db),_0x31d0e6=await _0xf5a1a5[_0x2a40bc(0x213)][_0x2a40bc(0x1d6)](_0x128cf3),_0x124fb2=_0x31d0e6[_0x2a40bc(0x1c7)]['text']();setup[_0x2a40bc(0x203)](_0xf5a1a5,_0x2a40bc(0x1ef)+_0x124fb2);}catch(_0x3e0d12){_0xf5a1a5[_0x2a40bc(0x217)]['error'](_0x2a40bc(0x1e6)+_0x3e0d12['message']);}}module['exports']={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};