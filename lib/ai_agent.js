const a0_0xcb9d2c=a0_0x4d0e;(function(_0x2f70b7,_0x4d954c){const _0x26d430=a0_0x4d0e,_0x57e45b=_0x2f70b7();while(!![]){try{const _0x436ac3=parseInt(_0x26d430(0xce))/0x1+-parseInt(_0x26d430(0xfd))/0x2+parseInt(_0x26d430(0xbb))/0x3+parseInt(_0x26d430(0x9e))/0x4+parseInt(_0x26d430(0xd5))/0x5+parseInt(_0x26d430(0xe4))/0x6*(-parseInt(_0x26d430(0xee))/0x7)+-parseInt(_0x26d430(0xf6))/0x8;if(_0x436ac3===_0x4d954c)break;else _0x57e45b['push'](_0x57e45b['shift']());}catch(_0x5763eb){_0x57e45b['push'](_0x57e45b['shift']());}}}(a0_0x6712,0xdccc1));const a0_0x3c073d=(function(){let _0x422fd5=!![];return function(_0x2cf703,_0x24c8be){const _0x22e462=_0x422fd5?function(){const _0x2c1e74=a0_0x4d0e;if(_0x24c8be){const _0x3bd1bb=_0x24c8be[_0x2c1e74(0x100)](_0x2cf703,arguments);return _0x24c8be=null,_0x3bd1bb;}}:function(){};return _0x422fd5=![],_0x22e462;};}()),a0_0x1d17cb=a0_0x3c073d(this,function(){const _0x289069=a0_0x4d0e;return a0_0x1d17cb['toString']()[_0x289069(0xf2)](_0x289069(0xe7))['toString']()[_0x289069(0x10a)](a0_0x1d17cb)[_0x289069(0xf2)](_0x289069(0xe7));});a0_0x1d17cb();'use strict';const {GoogleGenerativeAI}=require(a0_0xcb9d2c(0xa7)),setup=require('./setup'),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0xcb9d2c(0xc1),LTM_DP_RAW_LOG=a0_0xcb9d2c(0xfb),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0xcb9d2c(0xb3),'senior_aal':'PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':a0_0xcb9d2c(0xb8),'single_comfort':a0_0xcb9d2c(0x11a),'security':a0_0xcb9d2c(0xb9),'energy_saver':a0_0xcb9d2c(0x105)};function a0_0x4d0e(_0x1e39c1,_0x15ab29){const _0x53ed95=a0_0x6712();return a0_0x4d0e=function(_0x1d17cb,_0x3c073d){_0x1d17cb=_0x1d17cb-0x9e;let _0x671275=_0x53ed95[_0x1d17cb];return _0x671275;},a0_0x4d0e(_0x1e39c1,_0x15ab29);}function canCallApi(){const _0x58f29d=Date['now']();return _0x58f29d-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x43363d=a0_0xcb9d2c;lastGlobalApiCall=Date[_0x43363d(0xe1)]();}async function getWeatherContext(_0x3d2676){const _0x1b004c=a0_0xcb9d2c;if(!_0x3d2676[_0x1b004c(0xd2)][_0x1b004c(0xa5)]||!_0x3d2676[_0x1b004c(0xd2)]['weatherInstance'])return _0x1b004c(0xd7);try{const _0x348741=_0x3d2676[_0x1b004c(0xd2)][_0x1b004c(0xdb)];let _0x4cb88f=await _0x3d2676[_0x1b004c(0x114)](_0x348741+_0x1b004c(0x11c));if(!_0x4cb88f)_0x4cb88f=await _0x3d2676[_0x1b004c(0x114)](_0x348741+_0x1b004c(0x112));let _0x2056d1=await _0x3d2676['getForeignStateAsync'](_0x348741+_0x1b004c(0xac));if(!_0x2056d1)_0x2056d1=await _0x3d2676[_0x1b004c(0x114)](_0x348741+_0x1b004c(0xe3));let _0xa91ff0=_0x1b004c(0xb7);const _0x1d134f=await _0x3d2676[_0x1b004c(0x114)](_0x348741+_0x1b004c(0x116));if(_0x1d134f)_0xa91ff0=_0x1d134f[_0x1b004c(0x127)]?_0x1b004c(0x121):_0x1b004c(0x104);if(_0x4cb88f&&_0x2056d1)return _0x4cb88f[_0x1b004c(0x127)]+_0x1b004c(0xf4)+_0x2056d1[_0x1b004c(0x127)]+',\x20Lichtverh√§ltnisse:\x20'+_0xa91ff0;}catch(_0x2155c2){}return _0x1b004c(0xda);}async function consultButler(_0x4a9a37,_0x390760,_0x168cb4,_0x407ece){const _0x44a92b=a0_0xcb9d2c;if(!_0x4a9a37['geminiModel'])return{'approved':!![],'reason':_0x44a92b(0xd1)};const _0x5acfb3=Date[_0x44a92b(0xe1)]();if(decisionCache[_0x390760]&&_0x5acfb3-decisionCache[_0x390760][_0x44a92b(0xec)]<CACHE_TTL_MS){const _0x302e38=decisionCache[_0x390760]['decision'];return _0x4a9a37[_0x44a92b(0xfa)][_0x44a92b(0x9f)](_0x44a92b(0xad)+_0x390760+_0x44a92b(0xa1)+(_0x302e38[_0x44a92b(0x124)]?'OK':'NO')+'\x20('+_0x302e38[_0x44a92b(0xa4)]+')'),_0x302e38;}if(!canCallApi())return _0x4a9a37['log'][_0x44a92b(0x9f)](_0x44a92b(0xbf)+_0x390760+'\x20√ºbersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x2818dd=new Date()[_0x44a92b(0x125)](),_0x2e82ed=await getWeatherContext(_0x4a9a37),_0xb7e71d=PERSONA_MAPPING[_0x4a9a37['config'][_0x44a92b(0x120)]||_0x44a92b(0xf0)],_0xdd03e9=_0x44a92b(0xb6)+_0x2818dd+',\x20Wetter:\x20'+_0x2e82ed+_0x44a92b(0xfe)+(_0x407ece*0x64)[_0x44a92b(0x110)](0x0)+'%)\x20nach\x20\x22'+_0x390760+_0x44a92b(0xf7)+_0x168cb4+_0x44a92b(0xf3)+_0xb7e71d+_0x44a92b(0xc5);try{updateApiTimestamp();const _0x876b7d=await _0x4a9a37[_0x44a92b(0xab)][_0x44a92b(0xb5)](_0xdd03e9),_0x4f05db=_0x876b7d['response']['text']()[_0x44a92b(0xdc)](/```json|```/g,'')[_0x44a92b(0x115)](),_0x4bec3c=JSON['parse'](_0x4f05db);return decisionCache[_0x390760]={'decision':_0x4bec3c,'timestamp':_0x5acfb3},_0x4bec3c;}catch(_0x4d9086){return _0x4a9a37[_0x44a92b(0xfa)]['warn']('ü§ñ\x20Butler\x20Brain\x20Error:\x20'+_0x4d9086[_0x44a92b(0xf5)]),decisionCache[_0x390760]={'decision':{'approved':!![],'reason':_0x44a92b(0xc7)},'timestamp':_0x5acfb3-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x44a92b(0xc7)};}}async function runGeminiAnalysis(_0x5d2bc8,_0x464784=''){const _0x45efc1=a0_0xcb9d2c;if(!_0x5d2bc8[_0x45efc1(0xab)])return;if(!canCallApi()){_0x5d2bc8[_0x45efc1(0xfa)][_0x45efc1(0x9f)](_0x45efc1(0xde));return;}if(_0x5d2bc8['eventHistory']['length']===0x0)return;const _0x30975c=_0x5d2bc8[_0x45efc1(0xbe)]['slice'](0x0,0xf),_0x18b3ca=_0x5d2bc8['currentSystemMode'],_0x15c682=PERSONA_MAPPING[_0x5d2bc8[_0x45efc1(0xd2)][_0x45efc1(0x120)]||_0x45efc1(0xf0)],_0x1d98b1=_0x5d2bc8['config'][_0x45efc1(0x118)]||_0x45efc1(0xae);let _0x394318=_0x45efc1(0xb7);try{const _0x697dbc=await _0x5d2bc8[_0x45efc1(0x106)](_0x45efc1(0xa2));if(_0x697dbc&&_0x697dbc['val'])_0x394318=_0x697dbc['val'];}catch(_0xf3eed1){}let _0x6d1eed=![];try{const _0xc0ffe5=await _0x5d2bc8[_0x45efc1(0x106)](_0x45efc1(0xa3));if(_0xc0ffe5&&_0xc0ffe5['val'])_0x6d1eed=!![];}catch(_0x97f03c){}const _0x4f5bef=_0x45efc1(0x108)+_0x15c682+'.\x20KONTEXT:\x20'+_0x1d98b1+_0x45efc1(0xe6)+_0x18b3ca+_0x45efc1(0xf8)+_0x394318+_0x45efc1(0xcc)+JSON[_0x45efc1(0x10d)](_0x30975c)+_0x45efc1(0xa9)+_0x464784+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x201581=await _0x5d2bc8[_0x45efc1(0xab)]['generateContent'](_0x4f5bef),_0x4024c7=JSON[_0x45efc1(0x113)](_0x201581[_0x45efc1(0xa0)][_0x45efc1(0x119)]()['replace'](/```json|```/g,'')['trim']());await _0x5d2bc8[_0x45efc1(0xc9)](_0x45efc1(0xed),{'val':JSON['stringify'](_0x4024c7),'ack':!![]});if(_0x4024c7[_0x45efc1(0xd6)])await _0x5d2bc8[_0x45efc1(0xc9)](_0x45efc1(0x10c),{'val':_0x4024c7[_0x45efc1(0xd6)],'ack':!![]});const _0x42acd9={'timestamp':Date[_0x45efc1(0xe1)](),'id':Date[_0x45efc1(0xe1)]()[_0x45efc1(0xe9)](),'analysis':{'activity':{'summary':_0x4024c7[_0x45efc1(0xd6)],'isAlert':_0x4024c7[_0x45efc1(0x11b)],'alertReason':_0x4024c7['alertReason']},'comfort':{'automationProposal':_0x4024c7[_0x45efc1(0xa8)]}}};_0x5d2bc8[_0x45efc1(0xd8)][_0x45efc1(0xc0)](_0x42acd9);if(_0x5d2bc8['analysisHistory'][_0x45efc1(0xc6)]>0x32)_0x5d2bc8[_0x45efc1(0xd8)][_0x45efc1(0xaf)]();await _0x5d2bc8[_0x45efc1(0xc9)](_0x45efc1(0xba),{'val':JSON[_0x45efc1(0x10d)](_0x5d2bc8['analysisHistory']),'ack':!![]});const _0x3dd11c=_0x4024c7['isAlert']||![];_0x3dd11c!==_0x5d2bc8[_0x45efc1(0x10e)]&&(await _0x5d2bc8[_0x45efc1(0xc9)](_0x45efc1(0xdd),{'val':_0x3dd11c,'ack':!![]}),_0x5d2bc8[_0x45efc1(0x10e)]=_0x3dd11c,_0x3dd11c&&(await _0x5d2bc8[_0x45efc1(0xc9)](_0x45efc1(0xf9),{'val':_0x4024c7[_0x45efc1(0xa6)],'ack':!![]}),setup[_0x45efc1(0xe0)](_0x5d2bc8,'‚ö†Ô∏è\x20ALARM:\x20'+_0x4024c7[_0x45efc1(0xa6)],![],_0x4024c7['isEmergency'])));if(_0x4024c7['automationProposal']&&_0x4024c7[_0x45efc1(0xa8)][_0x45efc1(0xc4)]){await _0x5d2bc8[_0x45efc1(0xc9)](_0x45efc1(0xfc),{'val':!![],'ack':!![]}),await _0x5d2bc8['setStateAsync']('analysis.automation.description',{'val':_0x4024c7[_0x45efc1(0xa8)][_0x45efc1(0x117)],'ack':!![]}),await _0x5d2bc8[_0x45efc1(0xc9)](_0x45efc1(0xb2),{'val':_0x4024c7[_0x45efc1(0xa8)][_0x45efc1(0x103)],'ack':!![]}),await _0x5d2bc8[_0x45efc1(0xc9)](_0x45efc1(0x11e),{'val':JSON[_0x45efc1(0x10d)](_0x4024c7[_0x45efc1(0xa8)][_0x45efc1(0x109)]),'ack':!![]});if(_0x6d1eed)executeAutomationAction(_0x5d2bc8);}}catch(_0x2c03d1){_0x5d2bc8[_0x45efc1(0xfa)][_0x45efc1(0xff)](_0x45efc1(0x10f)+_0x2c03d1['message']);}}async function createDailyDigest(_0x3e1537,_0xbc2994){const _0x422b1b=a0_0xcb9d2c;if(!_0x3e1537[_0x422b1b(0x111)])return;if(!canCallApi()){await _0x3e1537[_0x422b1b(0xc9)](LTM_DP_STATUS,{'val':_0x422b1b(0x11d),'ack':!![]});return;}await _0x3e1537[_0x422b1b(0xc9)](LTM_DP_STATUS,{'val':_0x422b1b(0xcf),'ack':!![]});if(!_0x3e1537['geminiModel']||_0x3e1537[_0x422b1b(0xcb)][_0x422b1b(0xc6)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3e1537[_0x422b1b(0xc9)](LTM_DP_STATUS,{'val':_0x422b1b(0x122),'ack':!![]});return;}const _0x51d7c3=JSON['parse'](JSON[_0x422b1b(0x10d)](_0x3e1537[_0x422b1b(0xcb)])),_0x1bc117=_0x51d7c3[_0x422b1b(0xc6)],_0x23871f=_0x422b1b(0xc2)+JSON[_0x422b1b(0x10d)](_0x51d7c3);try{updateApiTimestamp();const _0x142408=await _0x3e1537[_0x422b1b(0xab)][_0x422b1b(0xb5)](_0x23871f),_0x3c3459=JSON[_0x422b1b(0x113)](_0x142408[_0x422b1b(0xa0)][_0x422b1b(0x119)]()[_0x422b1b(0xdc)](/```json|```/g,'')['trim']()),_0x11ff54={'timestamp':new Date()['toISOString'](),'eventCount':_0x1bc117,'summary':_0x3c3459[_0x422b1b(0xd6)]||'Digest','activityLevel':_0x3c3459[_0x422b1b(0xaa)]||'normal','systemMode':_0x3e1537[_0x422b1b(0xeb)]};_0x3e1537[_0x422b1b(0xe2)][_0x422b1b(0x11f)](_0x11ff54);const _0x1bcac4=_0x3e1537['config'][_0x422b1b(0xe5)]||0x3c;_0x3e1537[_0x422b1b(0xe2)][_0x422b1b(0xc6)]>_0x1bcac4&&_0x3e1537[_0x422b1b(0xe2)][_0x422b1b(0xd9)](0x0,_0x3e1537['dailyDigests'][_0x422b1b(0xc6)]-_0x1bcac4);await _0x3e1537[_0x422b1b(0xc9)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x422b1b(0x10d)](_0x3e1537['dailyDigests']),'ack':!![]}),_0x3e1537['rawEventLog']=[],await _0x3e1537[_0x422b1b(0xc9)](LTM_DP_RAW_LOG,{'val':JSON[_0x422b1b(0x10d)](_0x3e1537['rawEventLog']),'ack':!![]}),await _0x3e1537[_0x422b1b(0xc9)](LTM_DP_STATUS,{'val':_0x422b1b(0xdf),'ack':!![]});if(_0x3e1537[_0x422b1b(0x111)]&&_0xbc2994)_0xbc2994[_0x422b1b(0xbc)](_0x3e1537,_0x422b1b(0xea),{'digest':_0x11ff54});}catch(_0x5a1386){_0x3e1537[_0x422b1b(0xfa)][_0x422b1b(0xff)](_0x5a1386[_0x422b1b(0xf5)]);}}async function runBaselineDriftAnalysis(_0x17622f){const _0x13323b=a0_0xcb9d2c;if(!_0x17622f['isProVersion']||!_0x17622f[_0x13323b(0xab)])return;if(!canCallApi())return;const _0x34a372=_0x17622f[_0x13323b(0xd2)][_0x13323b(0x107)]||0xe;if(_0x17622f[_0x13323b(0xe2)][_0x13323b(0xc6)]<_0x34a372+0x7){await _0x17622f[_0x13323b(0xc9)](_0x13323b(0xe8),{'val':_0x13323b(0xca),'ack':!![]});return;}const _0x3df5a6=_0x17622f[_0x13323b(0xe2)][_0x13323b(0xc3)](-_0x34a372),_0x1eafec=_0x17622f['dailyDigests'][_0x13323b(0xc3)](0x0,_0x17622f['dailyDigests'][_0x13323b(0xc6)]-_0x34a372),_0x4d5365=_0x13323b(0x123)+JSON['stringify'](_0x1eafec)+_0x13323b(0xb0)+JSON[_0x13323b(0x10d)](_0x3df5a6);try{updateApiTimestamp();const _0x4daa2c=await _0x17622f[_0x13323b(0xab)][_0x13323b(0xb5)](_0x4d5365),_0x415031=JSON[_0x13323b(0x113)](_0x4daa2c[_0x13323b(0xa0)][_0x13323b(0x119)]()['replace'](/```json|```/g,'')[_0x13323b(0x115)]());_0x415031[_0x13323b(0xc8)]&&(await _0x17622f['setStateAsync']('LTM.driftAnalysis.baselineDrift',{'val':_0x415031[_0x13323b(0xc8)],'ack':!![]}),await _0x17622f[_0x13323b(0xc9)](_0x13323b(0xbd),{'val':_0x415031[_0x13323b(0xd3)],'ack':!![]}),await _0x17622f[_0x13323b(0xc9)](_0x13323b(0xb1),{'val':Date['now'](),'ack':!![]}));}catch(_0x330b25){}}async function executeAutomationAction(_0x1b7f41){const _0x4f5b00=a0_0xcb9d2c;try{const _0x27cbc3=await _0x1b7f41[_0x4f5b00(0x106)](_0x4f5b00(0xb2)),_0x2ea02f=await _0x1b7f41[_0x4f5b00(0x106)]('analysis.automation.targetValue');if(_0x27cbc3&&_0x27cbc3[_0x4f5b00(0x127)]&&_0x2ea02f){const _0x945c96=_0x27cbc3[_0x4f5b00(0x127)];let _0x3899f1=_0x2ea02f[_0x4f5b00(0x127)];try{_0x3899f1=JSON[_0x4f5b00(0x113)](_0x3899f1);}catch(_0x2fedd3){}_0x1b7f41[_0x4f5b00(0xfa)][_0x4f5b00(0xb4)](_0x4f5b00(0xcd)+_0x945c96+_0x4f5b00(0xef)+_0x3899f1),await _0x1b7f41[_0x4f5b00(0x101)](_0x945c96,_0x3899f1);}else _0x1b7f41[_0x4f5b00(0xfa)][_0x4f5b00(0xd0)](_0x4f5b00(0x10b));}catch(_0x19e6a0){_0x1b7f41[_0x4f5b00(0xfa)]['error'](_0x4f5b00(0xf1)+_0x19e6a0['message']);}}function a0_0x6712(){const _0x289e97=['unshift','LTM.processingStatus','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','slice','detected','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','length','KI-Fehler\x20(Fallback)','baselineDrift','setStateAsync','N/A\x20(Learning)','rawEventLog','.\x20EVENTS:\x20','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','1070144MDVISo','Started...','warn','KI\x20offline\x20(Fallback)','config','driftDetails','exports','3401780DxXvCP','summary','Unbekannt\x20(Kein\x20Sensor)','analysisHistory','splice','Wetterdaten\x20nicht\x20abrufbar','weatherInstance','replace','analysis.isAlert','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','Success','sendNotification','now','dailyDigests','.forecast.current.state','2066430YvxkFt','ltmLtbWindowDays','.\x20SYSTEM_MODE:\x20','(((.+)+)+)+$','LTM.driftAnalysis.baselineDrift','toString','ANALYZE_HEALTH','currentSystemMode','timestamp','analysis.lastResult','35JLLMUh','\x20=\x20','generic','BUTLER\x20Execution\x20Error:\x20','search','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','¬∞C,\x20','message','8820088tlgWbL','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','.\x20ANWESEND:\x20','analysis.alertReason','log','LTM.rawEventLog','analysis.automation.patternDetected','1758862iWQbpZ','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','error','apply','setForeignStateAsync','üåÖ\x20Morning\x20Briefing:\x0a','targetId','Tag','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','getStateAsync','ltmStbWindowDays','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','targetValue','constructor','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','analysis.activitySummary','stringify','lastAlertState','Gemini\x20Error:\x20','toFixed','isProVersion','.forecast.current.temperature','parse','getForeignStateAsync','trim','.Current.IsNight','description','livingContext','text','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','isAlert','.Current.Temperature','Skipped\x20(Traffic)','analysis.automation.targetValue','push','aiPersona','Nacht','Skipped\x20(No\x20AI\x20or\x20Data)','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','approved','toLocaleTimeString','Briefing\x20Error:\x20','val','5681952BLYJTG','debug','response','\x20->\x20','system.presenceWho','analysis.automation.autoApply','reason','useWeather','alertReason','@google/generative-ai','automationProposal','.\x20EMERGENCY:\x20','activityLevel','geminiModel','.Current.WeatherText','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','Keine\x20Details.','pop','\x0aSTB:\x20','LTM.driftAnalysis.lastCheck','analysis.automation.targetId','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','info','generateContent','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','Unbekannt','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','Sicherheit\x20geht\x20vor.','analysis.analysisHistory','4312092BKscdC','send','LTM.driftAnalysis.driftDetails','eventHistory','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20'];a0_0x6712=function(){return _0x289e97;};return a0_0x6712();}async function sendMorningBriefing(_0x283fed){const _0x4df77c=a0_0xcb9d2c;if(!_0x283fed['geminiModel'])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x1b9168='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x3f84bc=await _0x283fed['geminiModel'][_0x4df77c(0xb5)](_0x1b9168),_0x5d3e04=_0x3f84bc[_0x4df77c(0xa0)]['text']();setup[_0x4df77c(0xe0)](_0x283fed,_0x4df77c(0x102)+_0x5d3e04);}catch(_0x53f0cb){_0x283fed[_0x4df77c(0xfa)][_0x4df77c(0xff)](_0x4df77c(0x126)+_0x53f0cb[_0x4df77c(0xf5)]);}}module[a0_0xcb9d2c(0xd4)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};