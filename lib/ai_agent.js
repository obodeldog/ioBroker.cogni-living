const a0_0x2fc6cf=a0_0x4538;(function(_0x80acaa,_0x7c78df){const _0x58f22e=a0_0x4538,_0x353757=_0x80acaa();while(!![]){try{const _0x1d2db0=parseInt(_0x58f22e(0x1d9))/0x1*(-parseInt(_0x58f22e(0x1d5))/0x2)+-parseInt(_0x58f22e(0x23a))/0x3+-parseInt(_0x58f22e(0x235))/0x4+parseInt(_0x58f22e(0x212))/0x5*(-parseInt(_0x58f22e(0x1fc))/0x6)+parseInt(_0x58f22e(0x22b))/0x7*(parseInt(_0x58f22e(0x201))/0x8)+parseInt(_0x58f22e(0x1c1))/0x9*(parseInt(_0x58f22e(0x204))/0xa)+parseInt(_0x58f22e(0x1f6))/0xb*(parseInt(_0x58f22e(0x1ea))/0xc);if(_0x1d2db0===_0x7c78df)break;else _0x353757['push'](_0x353757['shift']());}catch(_0x21ef71){_0x353757['push'](_0x353757['shift']());}}}(a0_0x5a15,0xf417b));const a0_0x5cd1d4=(function(){let _0x2244b9=!![];return function(_0x37bc7d,_0x242ead){const _0x5a99fc=_0x2244b9?function(){const _0x506088=a0_0x4538;if(_0x242ead){const _0x3f54a1=_0x242ead[_0x506088(0x1d6)](_0x37bc7d,arguments);return _0x242ead=null,_0x3f54a1;}}:function(){};return _0x2244b9=![],_0x5a99fc;};}()),a0_0x891fa=a0_0x5cd1d4(this,function(){const _0x4a0f0d=a0_0x4538;return a0_0x891fa[_0x4a0f0d(0x205)]()[_0x4a0f0d(0x20e)](_0x4a0f0d(0x23b))['toString']()[_0x4a0f0d(0x236)](a0_0x891fa)[_0x4a0f0d(0x20e)](_0x4a0f0d(0x23b));});function a0_0x5a15(){const _0xb080d3=['search',',\x20Lichtverh√§ltnisse:\x20','.\x20ANWESEND:\x20','Wetterdaten\x20nicht\x20abrufbar','7089685xeybWG','%)\x20nach\x20\x22','alertReason','stringify',',\x20Wetter:\x20','N/A\x20(Learning)','\x20√ºbersprungen\x20(Auto-Approved).','warn','analysis.isAlert','.\x20SYSTEM_MODE:\x20','Digest','splice','rawEventLog','analysis.automation.description','useWeather','\x20->\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','Started...','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','Skipped\x20(Traffic)','replace','unshift','eventHistory','driftDetails','currentSystemMode','7zdQLWk','aiPersona','setStateAsync','¬∞C,\x20','pop','analysisHistory','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','isProVersion','LTM.processingStatus','LTM.dailyDigests','5947384zjzSXv','constructor','info','summary','analysis.alertReason','3466032zXFsov','(((.+)+)+)+$','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','config','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','weatherInstance','Keine\x20Details.','isAlert','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','generic','50697dogzQG','dailyDigests','LTM.driftAnalysis.lastCheck','üåÖ\x20Morning\x20Briefing:\x0a','text','sendNotification','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','KI\x20offline\x20(Fallback)','log','ltmStbWindowDays','analysis.lastResult','Briefing\x20Error:\x20','exports','baselineDrift','ltmLtbWindowDays','message','parse','.forecast.current.state','.\x20EVENTS:\x20','analysis.analysisHistory','6542GsvkSw','apply','reason','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','399FBmnAG','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','./setup','response','slice','targetValue','LTM.driftAnalysis.baselineDrift','trim','Sicherheit\x20geht\x20vor.','ANALYZE_HEALTH','send','description','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','livingContext','analysis.automation.patternDetected','Gemini\x20Error:\x20','6524268ehDcVH','setForeignStateAsync','automationProposal','.forecast.current.temperature','timestamp','val','now','LTM.rawEventLog','generateContent','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','debug','getStateAsync','99QhWyAA','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','geminiModel','lastAlertState','decision','approved','6nqchqZ','analysis.automation.targetValue','.Current.WeatherText','isEmergency','.Current.IsNight','8845704wNxxKR','KI-Fehler\x20(Fallback)','LTM.driftAnalysis.driftDetails','650BGSFtM','toString','toISOString','error','getForeignStateAsync','analysis.automation.targetId','Unbekannt','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','.\x20KONTEXT:\x20','length'];a0_0x5a15=function(){return _0xb080d3;};return a0_0x5a15();}a0_0x891fa();function a0_0x4538(_0x4bdf88,_0x621c90){const _0x662fcd=a0_0x5a15();return a0_0x4538=function(_0x891fa,_0x5cd1d4){_0x891fa=_0x891fa-0x1bd;let _0x5a159a=_0x662fcd[_0x891fa];return _0x5a159a;},a0_0x4538(_0x4bdf88,_0x621c90);}'use strict';const {GoogleGenerativeAI}=require('@google/generative-ai'),setup=require(a0_0x2fc6cf(0x1dc)),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x2fc6cf(0x234),LTM_DP_STATUS=a0_0x2fc6cf(0x233),LTM_DP_RAW_LOG=a0_0x2fc6cf(0x1f1),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x2fc6cf(0x1c7),'senior_aal':a0_0x2fc6cf(0x23c),'family':a0_0x2fc6cf(0x1d8),'single_comfort':'Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','security':a0_0x2fc6cf(0x1e2),'energy_saver':a0_0x2fc6cf(0x224)};function canCallApi(){const _0x14d00a=a0_0x2fc6cf,_0x12cc19=Date[_0x14d00a(0x1f0)]();return _0x12cc19-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0xc62e3e=a0_0x2fc6cf;lastGlobalApiCall=Date[_0xc62e3e(0x1f0)]();}async function getWeatherContext(_0x489bc9){const _0x5af152=a0_0x2fc6cf;if(!_0x489bc9['config'][_0x5af152(0x220)]||!_0x489bc9[_0x5af152(0x23d)][_0x5af152(0x23f)])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x28132f=_0x489bc9[_0x5af152(0x23d)][_0x5af152(0x23f)];let _0x45ee85=await _0x489bc9[_0x5af152(0x208)](_0x28132f+'.Current.Temperature');if(!_0x45ee85)_0x45ee85=await _0x489bc9[_0x5af152(0x208)](_0x28132f+_0x5af152(0x1ed));let _0x4919fe=await _0x489bc9[_0x5af152(0x208)](_0x28132f+_0x5af152(0x1fe));if(!_0x4919fe)_0x4919fe=await _0x489bc9[_0x5af152(0x208)](_0x28132f+_0x5af152(0x1d2));let _0x316781='Unbekannt';const _0x29ead5=await _0x489bc9[_0x5af152(0x208)](_0x28132f+_0x5af152(0x200));if(_0x29ead5)_0x316781=_0x29ead5[_0x5af152(0x1ef)]?'Nacht':'Tag';if(_0x45ee85&&_0x4919fe)return _0x45ee85[_0x5af152(0x1ef)]+_0x5af152(0x22e)+_0x4919fe['val']+_0x5af152(0x20f)+_0x316781;}catch(_0x12287d){}return _0x5af152(0x211);}async function consultButler(_0x32b545,_0x2d8819,_0x366835,_0x59ddea){const _0x2ea9b9=a0_0x2fc6cf;if(!_0x32b545[_0x2ea9b9(0x1f8)])return{'approved':!![],'reason':_0x2ea9b9(0x1c8)};const _0x4bd1b3=Date[_0x2ea9b9(0x1f0)]();if(decisionCache[_0x2d8819]&&_0x4bd1b3-decisionCache[_0x2d8819][_0x2ea9b9(0x1ee)]<CACHE_TTL_MS){const _0x1dba8e=decisionCache[_0x2d8819][_0x2ea9b9(0x1fa)];return _0x32b545[_0x2ea9b9(0x1c9)][_0x2ea9b9(0x1f4)]('ü§ñ\x20Butler\x20Cache\x20Hit:\x20'+_0x2d8819+_0x2ea9b9(0x221)+(_0x1dba8e[_0x2ea9b9(0x1fb)]?'OK':'NO')+'\x20('+_0x1dba8e[_0x2ea9b9(0x1d7)]+')'),_0x1dba8e;}if(!canCallApi())return _0x32b545[_0x2ea9b9(0x1c9)][_0x2ea9b9(0x1f4)](_0x2ea9b9(0x231)+_0x2d8819+_0x2ea9b9(0x218)),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x28699e=new Date()['toLocaleTimeString'](),_0x449052=await getWeatherContext(_0x32b545),_0x3b5295=PERSONA_MAPPING[_0x32b545[_0x2ea9b9(0x23d)][_0x2ea9b9(0x22c)]||'generic'],_0x1994aa=_0x2ea9b9(0x1bf)+_0x28699e+_0x2ea9b9(0x216)+_0x449052+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x59ddea*0x64)['toFixed'](0x0)+_0x2ea9b9(0x213)+_0x2d8819+_0x2ea9b9(0x1db)+_0x366835+_0x2ea9b9(0x1e6)+_0x3b5295+_0x2ea9b9(0x20b);try{updateApiTimestamp();const _0x3a14d2=await _0x32b545['geminiModel'][_0x2ea9b9(0x1f2)](_0x1994aa),_0x2a38e0=_0x3a14d2[_0x2ea9b9(0x1dd)][_0x2ea9b9(0x1c5)]()[_0x2ea9b9(0x226)](/```json|```/g,'')[_0x2ea9b9(0x1e1)](),_0x1f3fdc=JSON[_0x2ea9b9(0x1d1)](_0x2a38e0);return decisionCache[_0x2d8819]={'decision':_0x1f3fdc,'timestamp':_0x4bd1b3},_0x1f3fdc;}catch(_0x51d5a3){return _0x32b545[_0x2ea9b9(0x1c9)][_0x2ea9b9(0x219)]('ü§ñ\x20Butler\x20Brain\x20Error:\x20'+_0x51d5a3[_0x2ea9b9(0x1d0)]),decisionCache[_0x2d8819]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x4bd1b3-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x2ea9b9(0x202)};}}async function runGeminiAnalysis(_0x196b93,_0x403dbf=''){const _0x1f8bf1=a0_0x2fc6cf;if(!_0x196b93[_0x1f8bf1(0x1f8)])return;if(!canCallApi()){_0x196b93[_0x1f8bf1(0x1c9)][_0x1f8bf1(0x1f4)]('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x196b93['eventHistory'][_0x1f8bf1(0x20d)]===0x0)return;const _0x264a41=_0x196b93[_0x1f8bf1(0x228)]['slice'](0x0,0xf),_0x4faa4b=_0x196b93['currentSystemMode'],_0x64d41e=PERSONA_MAPPING[_0x196b93['config'][_0x1f8bf1(0x22c)]||_0x1f8bf1(0x1c0)],_0x5998e3=_0x196b93[_0x1f8bf1(0x23d)][_0x1f8bf1(0x1e7)]||_0x1f8bf1(0x1bd);let _0x5d5998=_0x1f8bf1(0x20a);try{const _0x4dcb2d=await _0x196b93[_0x1f8bf1(0x1f5)]('system.presenceWho');if(_0x4dcb2d&&_0x4dcb2d[_0x1f8bf1(0x1ef)])_0x5d5998=_0x4dcb2d[_0x1f8bf1(0x1ef)];}catch(_0xc0f058){}let _0x25f651=![];try{const _0x57f25a=await _0x196b93[_0x1f8bf1(0x1f5)]('analysis.automation.autoApply');if(_0x57f25a&&_0x57f25a['val'])_0x25f651=!![];}catch(_0x201398){}const _0x3e6249=_0x1f8bf1(0x23e)+_0x64d41e+_0x1f8bf1(0x20c)+_0x5998e3+_0x1f8bf1(0x21b)+_0x4faa4b+_0x1f8bf1(0x210)+_0x5d5998+_0x1f8bf1(0x1d3)+JSON['stringify'](_0x264a41)+'.\x20EMERGENCY:\x20'+_0x403dbf+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x1096e3=await _0x196b93['geminiModel'][_0x1f8bf1(0x1f2)](_0x3e6249),_0xe58b18=JSON[_0x1f8bf1(0x1d1)](_0x1096e3['response'][_0x1f8bf1(0x1c5)]()[_0x1f8bf1(0x226)](/```json|```/g,'')['trim']());await _0x196b93[_0x1f8bf1(0x22d)](_0x1f8bf1(0x1cb),{'val':JSON[_0x1f8bf1(0x215)](_0xe58b18),'ack':!![]});if(_0xe58b18['summary'])await _0x196b93[_0x1f8bf1(0x22d)]('analysis.activitySummary',{'val':_0xe58b18[_0x1f8bf1(0x238)],'ack':!![]});const _0x1a716b={'timestamp':Date['now'](),'id':Date[_0x1f8bf1(0x1f0)]()[_0x1f8bf1(0x205)](),'analysis':{'activity':{'summary':_0xe58b18[_0x1f8bf1(0x238)],'isAlert':_0xe58b18[_0x1f8bf1(0x1be)],'alertReason':_0xe58b18[_0x1f8bf1(0x214)]},'comfort':{'automationProposal':_0xe58b18[_0x1f8bf1(0x1ec)]}}};_0x196b93[_0x1f8bf1(0x230)][_0x1f8bf1(0x227)](_0x1a716b);if(_0x196b93[_0x1f8bf1(0x230)]['length']>0x32)_0x196b93['analysisHistory'][_0x1f8bf1(0x22f)]();await _0x196b93[_0x1f8bf1(0x22d)](_0x1f8bf1(0x1d4),{'val':JSON[_0x1f8bf1(0x215)](_0x196b93[_0x1f8bf1(0x230)]),'ack':!![]});const _0x5d0e12=_0xe58b18[_0x1f8bf1(0x1be)]||![];_0x5d0e12!==_0x196b93[_0x1f8bf1(0x1f9)]&&(await _0x196b93[_0x1f8bf1(0x22d)](_0x1f8bf1(0x21a),{'val':_0x5d0e12,'ack':!![]}),_0x196b93[_0x1f8bf1(0x1f9)]=_0x5d0e12,_0x5d0e12&&(await _0x196b93['setStateAsync'](_0x1f8bf1(0x239),{'val':_0xe58b18['alertReason'],'ack':!![]}),setup['sendNotification'](_0x196b93,'‚ö†Ô∏è\x20ALARM:\x20'+_0xe58b18[_0x1f8bf1(0x214)],![],_0xe58b18[_0x1f8bf1(0x1ff)])));if(_0xe58b18[_0x1f8bf1(0x1ec)]&&_0xe58b18[_0x1f8bf1(0x1ec)]['detected']){await _0x196b93['setStateAsync'](_0x1f8bf1(0x1e8),{'val':!![],'ack':!![]}),await _0x196b93['setStateAsync'](_0x1f8bf1(0x21f),{'val':_0xe58b18['automationProposal'][_0x1f8bf1(0x1e5)],'ack':!![]}),await _0x196b93[_0x1f8bf1(0x22d)](_0x1f8bf1(0x209),{'val':_0xe58b18['automationProposal']['targetId'],'ack':!![]}),await _0x196b93[_0x1f8bf1(0x22d)](_0x1f8bf1(0x1fd),{'val':JSON[_0x1f8bf1(0x215)](_0xe58b18['automationProposal'][_0x1f8bf1(0x1df)]),'ack':!![]});if(_0x25f651)executeAutomationAction(_0x196b93);}}catch(_0x57b13a){_0x196b93['log'][_0x1f8bf1(0x207)](_0x1f8bf1(0x1e9)+_0x57b13a[_0x1f8bf1(0x1d0)]);}}async function createDailyDigest(_0x3cb0f1,_0x3152c5){const _0x4f9ea0=a0_0x2fc6cf;if(!_0x3cb0f1[_0x4f9ea0(0x232)])return;if(!canCallApi()){await _0x3cb0f1[_0x4f9ea0(0x22d)](LTM_DP_STATUS,{'val':_0x4f9ea0(0x225),'ack':!![]});return;}await _0x3cb0f1[_0x4f9ea0(0x22d)](LTM_DP_STATUS,{'val':_0x4f9ea0(0x223),'ack':!![]});if(!_0x3cb0f1[_0x4f9ea0(0x1f8)]||_0x3cb0f1[_0x4f9ea0(0x21e)][_0x4f9ea0(0x20d)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3cb0f1[_0x4f9ea0(0x22d)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0xdc62e9=JSON[_0x4f9ea0(0x1d1)](JSON[_0x4f9ea0(0x215)](_0x3cb0f1[_0x4f9ea0(0x21e)])),_0x4c8ec3=_0xdc62e9['length'],_0x2cf1c6=_0x4f9ea0(0x222)+JSON[_0x4f9ea0(0x215)](_0xdc62e9);try{updateApiTimestamp();const _0x3b4a5f=await _0x3cb0f1[_0x4f9ea0(0x1f8)][_0x4f9ea0(0x1f2)](_0x2cf1c6),_0xb6472=JSON[_0x4f9ea0(0x1d1)](_0x3b4a5f['response']['text']()[_0x4f9ea0(0x226)](/```json|```/g,'')[_0x4f9ea0(0x1e1)]()),_0x980da2={'timestamp':new Date()[_0x4f9ea0(0x206)](),'eventCount':_0x4c8ec3,'summary':_0xb6472[_0x4f9ea0(0x238)]||_0x4f9ea0(0x21c),'activityLevel':_0xb6472['activityLevel']||'normal','systemMode':_0x3cb0f1[_0x4f9ea0(0x22a)]};_0x3cb0f1['dailyDigests']['push'](_0x980da2);const _0x4f64e5=_0x3cb0f1[_0x4f9ea0(0x23d)][_0x4f9ea0(0x1cf)]||0x3c;_0x3cb0f1[_0x4f9ea0(0x1c2)][_0x4f9ea0(0x20d)]>_0x4f64e5&&_0x3cb0f1[_0x4f9ea0(0x1c2)][_0x4f9ea0(0x21d)](0x0,_0x3cb0f1[_0x4f9ea0(0x1c2)]['length']-_0x4f64e5);await _0x3cb0f1[_0x4f9ea0(0x22d)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x3cb0f1['dailyDigests']),'ack':!![]}),_0x3cb0f1[_0x4f9ea0(0x21e)]=[],await _0x3cb0f1[_0x4f9ea0(0x22d)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x3cb0f1[_0x4f9ea0(0x21e)]),'ack':!![]}),await _0x3cb0f1[_0x4f9ea0(0x22d)](LTM_DP_STATUS,{'val':'Success','ack':!![]});if(_0x3cb0f1[_0x4f9ea0(0x232)]&&_0x3152c5)_0x3152c5[_0x4f9ea0(0x1e4)](_0x3cb0f1,_0x4f9ea0(0x1e3),{'digest':_0x980da2});}catch(_0x419e2f){_0x3cb0f1['log']['error'](_0x419e2f[_0x4f9ea0(0x1d0)]);}}async function runBaselineDriftAnalysis(_0x153923){const _0x376d46=a0_0x2fc6cf;if(!_0x153923[_0x376d46(0x232)]||!_0x153923[_0x376d46(0x1f8)])return;if(!canCallApi())return;const _0x216e5f=_0x153923[_0x376d46(0x23d)][_0x376d46(0x1ca)]||0xe;if(_0x153923[_0x376d46(0x1c2)][_0x376d46(0x20d)]<_0x216e5f+0x7){await _0x153923[_0x376d46(0x22d)](_0x376d46(0x1e0),{'val':_0x376d46(0x217),'ack':!![]});return;}const _0x3924bf=_0x153923[_0x376d46(0x1c2)][_0x376d46(0x1de)](-_0x216e5f),_0x252a13=_0x153923[_0x376d46(0x1c2)][_0x376d46(0x1de)](0x0,_0x153923[_0x376d46(0x1c2)]['length']-_0x216e5f),_0xb5dd6c=_0x376d46(0x1f7)+JSON[_0x376d46(0x215)](_0x252a13)+'\x0aSTB:\x20'+JSON[_0x376d46(0x215)](_0x3924bf);try{updateApiTimestamp();const _0x587e3a=await _0x153923[_0x376d46(0x1f8)][_0x376d46(0x1f2)](_0xb5dd6c),_0x5326a3=JSON[_0x376d46(0x1d1)](_0x587e3a[_0x376d46(0x1dd)][_0x376d46(0x1c5)]()[_0x376d46(0x226)](/```json|```/g,'')[_0x376d46(0x1e1)]());_0x5326a3[_0x376d46(0x1ce)]&&(await _0x153923[_0x376d46(0x22d)](_0x376d46(0x1e0),{'val':_0x5326a3[_0x376d46(0x1ce)],'ack':!![]}),await _0x153923['setStateAsync'](_0x376d46(0x203),{'val':_0x5326a3[_0x376d46(0x229)],'ack':!![]}),await _0x153923[_0x376d46(0x22d)](_0x376d46(0x1c3),{'val':Date[_0x376d46(0x1f0)](),'ack':!![]}));}catch(_0x5ff865){}}async function executeAutomationAction(_0x3c60f0){const _0x2e4066=a0_0x2fc6cf;try{const _0x513487=await _0x3c60f0[_0x2e4066(0x1f5)](_0x2e4066(0x209)),_0x27ffdb=await _0x3c60f0[_0x2e4066(0x1f5)](_0x2e4066(0x1fd));if(_0x513487&&_0x513487['val']&&_0x27ffdb){const _0x616ac9=_0x513487[_0x2e4066(0x1ef)];let _0x225541=_0x27ffdb[_0x2e4066(0x1ef)];try{_0x225541=JSON['parse'](_0x225541);}catch(_0xfce354){}_0x3c60f0[_0x2e4066(0x1c9)][_0x2e4066(0x237)](_0x2e4066(0x1da)+_0x616ac9+'\x20=\x20'+_0x225541),await _0x3c60f0[_0x2e4066(0x1eb)](_0x616ac9,_0x225541);}else _0x3c60f0[_0x2e4066(0x1c9)][_0x2e4066(0x219)](_0x2e4066(0x1f3));}catch(_0x4a06d6){_0x3c60f0[_0x2e4066(0x1c9)][_0x2e4066(0x207)]('BUTLER\x20Execution\x20Error:\x20'+_0x4a06d6[_0x2e4066(0x1d0)]);}}async function sendMorningBriefing(_0xda14a8){const _0xb0d21b=a0_0x2fc6cf;if(!_0xda14a8[_0xb0d21b(0x1f8)])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x2906d3='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x51e06b=await _0xda14a8[_0xb0d21b(0x1f8)][_0xb0d21b(0x1f2)](_0x2906d3),_0x43aea5=_0x51e06b[_0xb0d21b(0x1dd)][_0xb0d21b(0x1c5)]();setup[_0xb0d21b(0x1c6)](_0xda14a8,_0xb0d21b(0x1c4)+_0x43aea5);}catch(_0x5b2c2d){_0xda14a8[_0xb0d21b(0x1c9)]['error'](_0xb0d21b(0x1cc)+_0x5b2c2d[_0xb0d21b(0x1d0)]);}}module[a0_0x2fc6cf(0x1cd)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};