const a0_0x48a28f=a0_0x4b7b;(function(_0x17e91d,_0x54eaf1){const _0x377168=a0_0x4b7b,_0x4af6e4=_0x17e91d();while(!![]){try{const _0x5d8e4d=parseInt(_0x377168(0x164))/0x1+parseInt(_0x377168(0x17c))/0x2+parseInt(_0x377168(0x12c))/0x3+-parseInt(_0x377168(0x131))/0x4+-parseInt(_0x377168(0x14e))/0x5+parseInt(_0x377168(0x116))/0x6+-parseInt(_0x377168(0x175))/0x7;if(_0x5d8e4d===_0x54eaf1)break;else _0x4af6e4['push'](_0x4af6e4['shift']());}catch(_0x371a0a){_0x4af6e4['push'](_0x4af6e4['shift']());}}}(a0_0x1b4f,0x67120));const a0_0x4b67e3=(function(){let _0x4a4449=!![];return function(_0x29fe89,_0x8f4fd1){const _0x1e2195=_0x4a4449?function(){const _0x4e0af3=a0_0x4b7b;if(_0x8f4fd1){const _0x201060=_0x8f4fd1[_0x4e0af3(0x125)](_0x29fe89,arguments);return _0x8f4fd1=null,_0x201060;}}:function(){};return _0x4a4449=![],_0x1e2195;};}()),a0_0x2f1663=a0_0x4b67e3(this,function(){const _0x20046c=a0_0x4b7b;return a0_0x2f1663[_0x20046c(0x128)]()['search'](_0x20046c(0x135))[_0x20046c(0x128)]()[_0x20046c(0x154)](a0_0x2f1663)[_0x20046c(0x156)](_0x20046c(0x135));});function a0_0x4b7b(_0x516bdf,_0x412a98){const _0x52bb84=a0_0x1b4f();return a0_0x4b7b=function(_0x2f1663,_0x4b67e3){_0x2f1663=_0x2f1663-0xf9;let _0x1b4fec=_0x52bb84[_0x2f1663];return _0x1b4fec;},a0_0x4b7b(_0x516bdf,_0x412a98);}a0_0x2f1663();'use strict';const {GoogleGenerativeAI}=require(a0_0x48a28f(0x129)),setup=require(a0_0x48a28f(0x120)),GEMINI_MODEL=a0_0x48a28f(0x176),LTM_DP_DAILY_DIGESTS=a0_0x48a28f(0x14f),LTM_DP_STATUS=a0_0x48a28f(0x13c),LTM_DP_RAW_LOG=a0_0x48a28f(0x171),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x48a28f(0x11f),'senior_aal':'PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':a0_0x48a28f(0x15f),'single_comfort':a0_0x48a28f(0x12b),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x48a28f(0x123)};function canCallApi(){const _0x3fb966=a0_0x48a28f,_0x839aa4=Date[_0x3fb966(0x108)]();return _0x839aa4-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){lastGlobalApiCall=Date['now']();}async function getWeatherContext(_0xda0354){const _0x4fd74a=a0_0x48a28f;if(!_0xda0354[_0x4fd74a(0x15e)]['useWeather']||!_0xda0354[_0x4fd74a(0x15e)]['weatherInstance'])return _0x4fd74a(0x100);try{const _0x3f1b5e=_0xda0354[_0x4fd74a(0x15e)][_0x4fd74a(0x134)];let _0x38416c=await _0xda0354[_0x4fd74a(0x17e)](_0x3f1b5e+_0x4fd74a(0x13e));if(!_0x38416c)_0x38416c=await _0xda0354[_0x4fd74a(0x17e)](_0x3f1b5e+_0x4fd74a(0x16b));let _0x3b5ddd=await _0xda0354[_0x4fd74a(0x17e)](_0x3f1b5e+_0x4fd74a(0x113));if(!_0x3b5ddd)_0x3b5ddd=await _0xda0354[_0x4fd74a(0x17e)](_0x3f1b5e+_0x4fd74a(0x169));let _0xc4a9ac=_0x4fd74a(0x11b);const _0x153a20=await _0xda0354['getForeignStateAsync'](_0x3f1b5e+_0x4fd74a(0x101));if(_0x153a20)_0xc4a9ac=_0x153a20['val']?_0x4fd74a(0x17b):_0x4fd74a(0x103);if(_0x38416c&&_0x3b5ddd)return _0x38416c[_0x4fd74a(0x145)]+_0x4fd74a(0x130)+_0x3b5ddd[_0x4fd74a(0x145)]+_0x4fd74a(0x16c)+_0xc4a9ac;}catch(_0x492d8b){}return _0x4fd74a(0x109);}async function consultButler(_0x17980f,_0x5d3ec9,_0x4ea6e0,_0x3459c2){const _0x5e10e0=a0_0x48a28f;if(!_0x17980f[_0x5e10e0(0x16e)])return{'approved':!![],'reason':'KI\x20offline\x20(Fallback)'};const _0x3c7ae8=Date['now']();if(decisionCache[_0x5d3ec9]&&_0x3c7ae8-decisionCache[_0x5d3ec9]['timestamp']<CACHE_TTL_MS){const _0x264aa6=decisionCache[_0x5d3ec9][_0x5e10e0(0x117)];return _0x17980f[_0x5e10e0(0x17d)][_0x5e10e0(0x178)](_0x5e10e0(0x177)+_0x5d3ec9+_0x5e10e0(0x159)+(_0x264aa6['approved']?'OK':'NO')+'\x20('+_0x264aa6['reason']+')'),_0x264aa6;}if(!canCallApi())return _0x17980f[_0x5e10e0(0x17d)][_0x5e10e0(0x178)](_0x5e10e0(0x110)+_0x5d3ec9+_0x5e10e0(0x172)),{'approved':!![],'reason':_0x5e10e0(0x179)};const _0x19454a=new Date()['toLocaleTimeString'](),_0xac32f0=await getWeatherContext(_0x17980f),_0x51c97f=PERSONA_MAPPING[_0x17980f[_0x5e10e0(0x15e)][_0x5e10e0(0x17f)]||'generic'],_0x495159=_0x5e10e0(0x105)+_0x19454a+_0x5e10e0(0x102)+_0xac32f0+_0x5e10e0(0x15c)+(_0x3459c2*0x64)[_0x5e10e0(0x104)](0x0)+_0x5e10e0(0x180)+_0x5d3ec9+'\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22'+_0x4ea6e0+_0x5e10e0(0x10d)+_0x51c97f+_0x5e10e0(0x142);try{updateApiTimestamp();const _0x2f166f=await _0x17980f[_0x5e10e0(0x16e)][_0x5e10e0(0x12f)](_0x495159),_0x3ad36e=_0x2f166f['response']['text']()['replace'](/```json|```/g,'')[_0x5e10e0(0x13f)](),_0x72a751=JSON['parse'](_0x3ad36e);return decisionCache[_0x5d3ec9]={'decision':_0x72a751,'timestamp':_0x3c7ae8},_0x72a751;}catch(_0x27961a){return _0x17980f[_0x5e10e0(0x17d)][_0x5e10e0(0x17a)]('ðŸ¤–\x20Butler\x20Brain\x20Error:\x20'+_0x27961a[_0x5e10e0(0x14d)]),decisionCache[_0x5d3ec9]={'decision':{'approved':!![],'reason':_0x5e10e0(0x114)},'timestamp':_0x3c7ae8-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x5e10e0(0x114)};}}async function runGeminiAnalysis(_0x27d54b,_0x3651c8=''){const _0x59bfa3=a0_0x48a28f;if(!_0x27d54b[_0x59bfa3(0x16e)])return;if(!canCallApi()){_0x27d54b['log']['debug'](_0x59bfa3(0x140));return;}if(_0x27d54b[_0x59bfa3(0xff)][_0x59bfa3(0xfd)]===0x0)return;const _0x267109=_0x27d54b[_0x59bfa3(0xff)][_0x59bfa3(0x126)](0x0,0xf),_0x5721b3=_0x27d54b[_0x59bfa3(0x111)],_0x36affa=PERSONA_MAPPING[_0x27d54b[_0x59bfa3(0x15e)][_0x59bfa3(0x17f)]||'generic'],_0xbdc3b7=_0x27d54b['config'][_0x59bfa3(0x119)]||_0x59bfa3(0x13a);let _0x366aff=_0x59bfa3(0x11b);try{const _0xf2b4e9=await _0x27d54b['getStateAsync'](_0x59bfa3(0x173));if(_0xf2b4e9&&_0xf2b4e9['val'])_0x366aff=_0xf2b4e9[_0x59bfa3(0x145)];}catch(_0x1ab43b){}let _0x41467c=![];try{const _0xaefacb=await _0x27d54b[_0x59bfa3(0x11d)]('analysis.automation.autoApply');if(_0xaefacb&&_0xaefacb[_0x59bfa3(0x145)])_0x41467c=!![];}catch(_0x6c910b){}const _0x17e30d=_0x59bfa3(0x15b)+_0x36affa+_0x59bfa3(0x11a)+_0xbdc3b7+_0x59bfa3(0x160)+_0x5721b3+_0x59bfa3(0x107)+_0x366aff+_0x59bfa3(0x15d)+JSON['stringify'](_0x267109)+_0x59bfa3(0x133)+_0x3651c8+_0x59bfa3(0x14b);try{updateApiTimestamp();const _0x353bd0=await _0x27d54b[_0x59bfa3(0x16e)][_0x59bfa3(0x12f)](_0x17e30d),_0x51f394=JSON[_0x59bfa3(0x12a)](_0x353bd0[_0x59bfa3(0x115)][_0x59bfa3(0x153)]()[_0x59bfa3(0x138)](/```json|```/g,'')[_0x59bfa3(0x13f)]());await _0x27d54b[_0x59bfa3(0x152)](_0x59bfa3(0x11c),{'val':JSON[_0x59bfa3(0x155)](_0x51f394),'ack':!![]});if(_0x51f394[_0x59bfa3(0xf9)])await _0x27d54b[_0x59bfa3(0x152)](_0x59bfa3(0x151),{'val':_0x51f394[_0x59bfa3(0xf9)],'ack':!![]});const _0x5a9124={'timestamp':Date[_0x59bfa3(0x108)](),'id':Date[_0x59bfa3(0x108)]()[_0x59bfa3(0x128)](),'analysis':{'activity':{'summary':_0x51f394[_0x59bfa3(0xf9)],'isAlert':_0x51f394[_0x59bfa3(0x168)],'alertReason':_0x51f394['alertReason']},'comfort':{'automationProposal':_0x51f394[_0x59bfa3(0x16f)]}}};_0x27d54b[_0x59bfa3(0x10c)][_0x59bfa3(0x10e)](_0x5a9124);if(_0x27d54b[_0x59bfa3(0x10c)][_0x59bfa3(0xfd)]>0x32)_0x27d54b[_0x59bfa3(0x10c)][_0x59bfa3(0x143)]();await _0x27d54b[_0x59bfa3(0x152)](_0x59bfa3(0x15a),{'val':JSON[_0x59bfa3(0x155)](_0x27d54b[_0x59bfa3(0x10c)]),'ack':!![]});const _0x562a32=_0x51f394[_0x59bfa3(0x168)]||![];_0x562a32!==_0x27d54b['lastAlertState']&&(await _0x27d54b['setStateAsync'](_0x59bfa3(0x127),{'val':_0x562a32,'ack':!![]}),_0x27d54b['lastAlertState']=_0x562a32,_0x562a32&&(await _0x27d54b[_0x59bfa3(0x152)](_0x59bfa3(0x167),{'val':_0x51f394['alertReason'],'ack':!![]}),setup[_0x59bfa3(0x122)](_0x27d54b,_0x59bfa3(0x161)+_0x51f394[_0x59bfa3(0x158)],![],_0x51f394[_0x59bfa3(0xfe)])));if(_0x51f394[_0x59bfa3(0x16f)]&&_0x51f394[_0x59bfa3(0x16f)]['detected']){await _0x27d54b[_0x59bfa3(0x152)](_0x59bfa3(0x12e),{'val':!![],'ack':!![]}),await _0x27d54b[_0x59bfa3(0x152)](_0x59bfa3(0x137),{'val':_0x51f394[_0x59bfa3(0x16f)]['description'],'ack':!![]}),await _0x27d54b['setStateAsync'](_0x59bfa3(0x149),{'val':_0x51f394[_0x59bfa3(0x16f)][_0x59bfa3(0x16d)],'ack':!![]}),await _0x27d54b['setStateAsync'](_0x59bfa3(0x121),{'val':JSON[_0x59bfa3(0x155)](_0x51f394[_0x59bfa3(0x16f)][_0x59bfa3(0x150)]),'ack':!![]});if(_0x41467c)executeAutomationAction(_0x27d54b);}}catch(_0x27ee33){_0x27d54b['log'][_0x59bfa3(0x166)](_0x59bfa3(0x14c)+_0x27ee33[_0x59bfa3(0x14d)]);}}async function createDailyDigest(_0x127ebc,_0x34e0e1){const _0x16a852=a0_0x48a28f;if(!_0x127ebc['isProVersion'])return;if(!canCallApi()){await _0x127ebc[_0x16a852(0x152)](LTM_DP_STATUS,{'val':_0x16a852(0x118),'ack':!![]});return;}await _0x127ebc[_0x16a852(0x152)](LTM_DP_STATUS,{'val':_0x16a852(0x13b),'ack':!![]});if(!_0x127ebc[_0x16a852(0x16e)]||_0x127ebc[_0x16a852(0x16a)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x127ebc[_0x16a852(0x152)](LTM_DP_STATUS,{'val':_0x16a852(0x163),'ack':!![]});return;}const _0x59148c=JSON[_0x16a852(0x12a)](JSON[_0x16a852(0x155)](_0x127ebc['rawEventLog'])),_0x35d86c=_0x59148c[_0x16a852(0xfd)],_0xd8810b=_0x16a852(0x124)+JSON['stringify'](_0x59148c);try{updateApiTimestamp();const _0x17a74a=await _0x127ebc['geminiModel'][_0x16a852(0x12f)](_0xd8810b),_0x47d412=JSON[_0x16a852(0x12a)](_0x17a74a[_0x16a852(0x115)][_0x16a852(0x153)]()[_0x16a852(0x138)](/```json|```/g,'')[_0x16a852(0x13f)]()),_0x354344={'timestamp':new Date()[_0x16a852(0xfc)](),'eventCount':_0x35d86c,'summary':_0x47d412[_0x16a852(0xf9)]||_0x16a852(0x162),'activityLevel':_0x47d412[_0x16a852(0x10b)]||_0x16a852(0x132),'systemMode':_0x127ebc[_0x16a852(0x111)]};_0x127ebc[_0x16a852(0x112)][_0x16a852(0x12d)](_0x354344);const _0x4b6783=_0x127ebc[_0x16a852(0x15e)]['ltmLtbWindowDays']||0x3c;_0x127ebc['dailyDigests'][_0x16a852(0xfd)]>_0x4b6783&&_0x127ebc['dailyDigests'][_0x16a852(0x13d)](0x0,_0x127ebc[_0x16a852(0x112)][_0x16a852(0xfd)]-_0x4b6783);await _0x127ebc['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x127ebc[_0x16a852(0x112)]),'ack':!![]}),_0x127ebc[_0x16a852(0x16a)]=[],await _0x127ebc[_0x16a852(0x152)](LTM_DP_RAW_LOG,{'val':JSON[_0x16a852(0x155)](_0x127ebc[_0x16a852(0x16a)]),'ack':!![]}),await _0x127ebc[_0x16a852(0x152)](LTM_DP_STATUS,{'val':'Success','ack':!![]});if(_0x127ebc[_0x16a852(0x11e)]&&_0x34e0e1)_0x34e0e1[_0x16a852(0xfa)](_0x127ebc,_0x16a852(0x147),{'digest':_0x354344});}catch(_0x571941){_0x127ebc[_0x16a852(0x17d)][_0x16a852(0x166)](_0x571941[_0x16a852(0x14d)]);}}async function runBaselineDriftAnalysis(_0x42317a){const _0x4d0ab5=a0_0x48a28f;if(!_0x42317a[_0x4d0ab5(0x11e)]||!_0x42317a[_0x4d0ab5(0x16e)])return;if(!canCallApi())return;const _0x50def6=_0x42317a[_0x4d0ab5(0x15e)][_0x4d0ab5(0x148)]||0xe;if(_0x42317a[_0x4d0ab5(0x112)][_0x4d0ab5(0xfd)]<_0x50def6+0x7){await _0x42317a[_0x4d0ab5(0x152)](_0x4d0ab5(0x165),{'val':_0x4d0ab5(0x139),'ack':!![]});return;}const _0x3da7d3=_0x42317a[_0x4d0ab5(0x112)][_0x4d0ab5(0x126)](-_0x50def6),_0x8b17ac=_0x42317a['dailyDigests'][_0x4d0ab5(0x126)](0x0,_0x42317a['dailyDigests'][_0x4d0ab5(0xfd)]-_0x50def6),_0x29aa32='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x4d0ab5(0x155)](_0x8b17ac)+_0x4d0ab5(0x144)+JSON[_0x4d0ab5(0x155)](_0x3da7d3);try{updateApiTimestamp();const _0x1335d1=await _0x42317a[_0x4d0ab5(0x16e)]['generateContent'](_0x29aa32),_0x380be1=JSON[_0x4d0ab5(0x12a)](_0x1335d1[_0x4d0ab5(0x115)][_0x4d0ab5(0x153)]()[_0x4d0ab5(0x138)](/```json|```/g,'')['trim']());_0x380be1['baselineDrift']&&(await _0x42317a[_0x4d0ab5(0x152)](_0x4d0ab5(0x165),{'val':_0x380be1['baselineDrift'],'ack':!![]}),await _0x42317a[_0x4d0ab5(0x152)](_0x4d0ab5(0x136),{'val':_0x380be1[_0x4d0ab5(0x157)],'ack':!![]}),await _0x42317a[_0x4d0ab5(0x152)]('LTM.driftAnalysis.lastCheck',{'val':Date[_0x4d0ab5(0x108)](),'ack':!![]}));}catch(_0x4a9e8c){}}async function executeAutomationAction(_0x3501d6){const _0x1cd46b=a0_0x48a28f;try{const _0x4e00a2=await _0x3501d6[_0x1cd46b(0x11d)](_0x1cd46b(0x149)),_0x20cc77=await _0x3501d6[_0x1cd46b(0x11d)](_0x1cd46b(0x121));if(_0x4e00a2&&_0x4e00a2['val']&&_0x20cc77){const _0x462860=_0x4e00a2[_0x1cd46b(0x145)];let _0x1caf8e=_0x20cc77[_0x1cd46b(0x145)];try{_0x1caf8e=JSON[_0x1cd46b(0x12a)](_0x1caf8e);}catch(_0x39aa2d){}_0x3501d6[_0x1cd46b(0x17d)][_0x1cd46b(0xfb)](_0x1cd46b(0x106)+_0x462860+_0x1cd46b(0x141)+_0x1caf8e),await _0x3501d6[_0x1cd46b(0x146)](_0x462860,_0x1caf8e);}else _0x3501d6[_0x1cd46b(0x17d)][_0x1cd46b(0x17a)](_0x1cd46b(0x174));}catch(_0x520e1c){_0x3501d6[_0x1cd46b(0x17d)]['error']('BUTLER\x20Execution\x20Error:\x20'+_0x520e1c[_0x1cd46b(0x14d)]);}}function a0_0x1b4f(){const _0x4fb914=['parse','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','82746LZuNxV','push','analysis.automation.patternDetected','generateContent','Â°C,\x20','2441048sGiLPj','normal','.\x20EMERGENCY:\x20','weatherInstance','(((.+)+)+)+$','LTM.driftAnalysis.driftDetails','analysis.automation.description','replace','N/A\x20(Learning)','Keine\x20Details.','Started...','LTM.processingStatus','splice','.Current.Temperature','trim','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','\x20=\x20','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','pop','\x0aSTB:\x20','val','setForeignStateAsync','ANALYZE_HEALTH','ltmStbWindowDays','analysis.automation.targetId','Briefing\x20Error:\x20','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','Gemini\x20Error:\x20','message','563445OphFOL','LTM.dailyDigests','targetValue','analysis.activitySummary','setStateAsync','text','constructor','stringify','search','driftDetails','alertReason','\x20->\x20','analysis.analysisHistory','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','.\x20EVENTS:\x20','config','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','.\x20SYSTEM_MODE:\x20','âš ï¸\x20ALARM:\x20','Digest','Skipped\x20(No\x20AI\x20or\x20Data)','818935CHWFeq','LTM.driftAnalysis.baselineDrift','error','analysis.alertReason','isAlert','.forecast.current.state','rawEventLog','.forecast.current.temperature',',\x20LichtverhÃ¤ltnisse:\x20','targetId','geminiModel','automationProposal','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','LTM.rawEventLog','\x20Ã¼bersprungen\x20(Auto-Approved).','system.presenceWho','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','3119179ydHVjl','models/gemini-flash-latest','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','debug','Traffic-Schutz\x20(Auto-Approved)','warn','Nacht','389006lyJBuP','log','getForeignStateAsync','aiPersona','%)\x20nach\x20\x22','summary','send','info','toISOString','length','isEmergency','eventHistory','Unbekannt\x20(Kein\x20Sensor)','.Current.IsNight',',\x20Wetter:\x20','Tag','toFixed','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','.\x20ANWESEND:\x20','now','Wetterdaten\x20nicht\x20abrufbar','exports','activityLevel','analysisHistory','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','unshift','ðŸŒ…\x20Morning\x20Briefing:\x0a','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','currentSystemMode','dailyDigests','.Current.WeatherText','KI-Fehler\x20(Fallback)','response','3298224PWNZBo','decision','Skipped\x20(Traffic)','livingContext','.\x20KONTEXT:\x20','Unbekannt','analysis.lastResult','getStateAsync','isProVersion','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','./setup','analysis.automation.targetValue','sendNotification','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','apply','slice','analysis.isAlert','toString','@google/generative-ai'];a0_0x1b4f=function(){return _0x4fb914;};return a0_0x1b4f();}async function sendMorningBriefing(_0xe4d079){const _0x557a9b=a0_0x48a28f;if(!_0xe4d079['geminiModel'])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x3e5780=_0x557a9b(0x170),_0x47e8ad=await _0xe4d079[_0x557a9b(0x16e)][_0x557a9b(0x12f)](_0x3e5780),_0x2545d1=_0x47e8ad['response']['text']();setup['sendNotification'](_0xe4d079,_0x557a9b(0x10f)+_0x2545d1);}catch(_0x3870f7){_0xe4d079[_0x557a9b(0x17d)][_0x557a9b(0x166)](_0x557a9b(0x14a)+_0x3870f7['message']);}}module[a0_0x48a28f(0x10a)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};