const a0_0x4a9127=a0_0x17d4;(function(_0x46a994,_0x46fb71){const _0xfc5309=a0_0x17d4,_0xa3d59d=_0x46a994();while(!![]){try{const _0x305220=parseInt(_0xfc5309(0x1ef))/0x1*(-parseInt(_0xfc5309(0x232))/0x2)+parseInt(_0xfc5309(0x1e1))/0x3+parseInt(_0xfc5309(0x214))/0x4*(-parseInt(_0xfc5309(0x1bf))/0x5)+parseInt(_0xfc5309(0x1d6))/0x6*(parseInt(_0xfc5309(0x211))/0x7)+parseInt(_0xfc5309(0x1c4))/0x8*(parseInt(_0xfc5309(0x21a))/0x9)+-parseInt(_0xfc5309(0x1de))/0xa+parseInt(_0xfc5309(0x1cc))/0xb;if(_0x305220===_0x46fb71)break;else _0xa3d59d['push'](_0xa3d59d['shift']());}catch(_0x38e92a){_0xa3d59d['push'](_0xa3d59d['shift']());}}}(a0_0xe817,0x26e23));const a0_0x397fa0=(function(){let _0xae29a3=!![];return function(_0x4ad6a6,_0xddcaa8){const _0x1b82f8=_0xae29a3?function(){const _0x1d5068=a0_0x17d4;if(_0xddcaa8){const _0x51e6e6=_0xddcaa8[_0x1d5068(0x22d)](_0x4ad6a6,arguments);return _0xddcaa8=null,_0x51e6e6;}}:function(){};return _0xae29a3=![],_0x1b82f8;};}()),a0_0x28f8ef=a0_0x397fa0(this,function(){const _0x211e43=a0_0x17d4;return a0_0x28f8ef['toString']()[_0x211e43(0x22b)](_0x211e43(0x200))[_0x211e43(0x1b5)]()[_0x211e43(0x225)](a0_0x28f8ef)['search'](_0x211e43(0x200));});a0_0x28f8ef();'use strict';const {GoogleGenerativeAI}=require('@google/generative-ai'),setup=require(a0_0x4a9127(0x1c0)),GEMINI_MODEL=a0_0x4a9127(0x21c),LTM_DP_DAILY_DIGESTS=a0_0x4a9127(0x201),LTM_DP_STATUS=a0_0x4a9127(0x1e0),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x4a9127(0x1c3),'senior_aal':'PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':'Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','single_comfort':a0_0x4a9127(0x21f),'security':a0_0x4a9127(0x203),'energy_saver':a0_0x4a9127(0x1da)};function canCallApi(){const _0x391662=a0_0x4a9127,_0x2c419d=Date[_0x391662(0x1b0)]();return _0x2c419d-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x3f1e8b=a0_0x4a9127;lastGlobalApiCall=Date[_0x3f1e8b(0x1b0)]();}async function getWeatherContext(_0x395e09){const _0x2d391f=a0_0x4a9127;if(!_0x395e09[_0x2d391f(0x1f3)][_0x2d391f(0x1fc)]||!_0x395e09[_0x2d391f(0x1f3)][_0x2d391f(0x20f)])return _0x2d391f(0x210);try{const _0x5584ef=_0x395e09['config'][_0x2d391f(0x20f)];let _0xf76a1c=await _0x395e09['getForeignStateAsync'](_0x5584ef+_0x2d391f(0x1cd));if(!_0xf76a1c)_0xf76a1c=await _0x395e09[_0x2d391f(0x221)](_0x5584ef+_0x2d391f(0x228));let _0x1a81a1=await _0x395e09[_0x2d391f(0x221)](_0x5584ef+_0x2d391f(0x1d2));if(!_0x1a81a1)_0x1a81a1=await _0x395e09[_0x2d391f(0x221)](_0x5584ef+'.forecast.current.state');let _0x373887=_0x2d391f(0x1d8);const _0x17ef83=await _0x395e09['getForeignStateAsync'](_0x5584ef+'.Current.IsNight');if(_0x17ef83)_0x373887=_0x17ef83[_0x2d391f(0x1ab)]?_0x2d391f(0x233):_0x2d391f(0x1f6);if(_0xf76a1c&&_0x1a81a1)return _0xf76a1c['val']+'Â°C,\x20'+_0x1a81a1['val']+_0x2d391f(0x207)+_0x373887;}catch(_0x1108ef){}return'Wetterdaten\x20nicht\x20abrufbar';}async function consultButler(_0x27484a,_0x529d40,_0x2ddd2a,_0x3c2240){const _0x45b135=a0_0x4a9127;if(!_0x27484a['geminiModel'])return{'approved':!![],'reason':_0x45b135(0x215)};const _0x2e4f37=Date[_0x45b135(0x1b0)]();if(decisionCache[_0x529d40]&&_0x2e4f37-decisionCache[_0x529d40]['timestamp']<CACHE_TTL_MS){const _0x5e157b=decisionCache[_0x529d40][_0x45b135(0x1f8)];return _0x27484a[_0x45b135(0x1b7)]['debug'](_0x45b135(0x1cb)+_0x529d40+'\x20->\x20'+(_0x5e157b['approved']?'OK':'NO')+'\x20('+_0x5e157b[_0x45b135(0x209)]+')'),_0x5e157b;}if(!canCallApi())return _0x27484a[_0x45b135(0x1b7)][_0x45b135(0x1b8)](_0x45b135(0x231)+_0x529d40+_0x45b135(0x22a)),{'approved':!![],'reason':_0x45b135(0x1dd)};const _0x5eb417=new Date()[_0x45b135(0x229)](),_0x3a7788=await getWeatherContext(_0x27484a),_0x556731=PERSONA_MAPPING[_0x27484a['config'][_0x45b135(0x1ba)]||'generic'],_0x4fa065=_0x45b135(0x1b3)+_0x5eb417+',\x20Wetter:\x20'+_0x3a7788+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x3c2240*0x64)['toFixed'](0x0)+_0x45b135(0x1c2)+_0x529d40+_0x45b135(0x223)+_0x2ddd2a+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x556731+_0x45b135(0x21b);try{updateApiTimestamp();const _0x514adb=await _0x27484a['geminiModel'][_0x45b135(0x1fe)](_0x4fa065),_0x1c1584=_0x514adb[_0x45b135(0x1d7)][_0x45b135(0x202)]()[_0x45b135(0x1ea)](/```json|```/g,'')[_0x45b135(0x216)](),_0x16bee3=JSON[_0x45b135(0x1ca)](_0x1c1584);return decisionCache[_0x529d40]={'decision':_0x16bee3,'timestamp':_0x2e4f37},_0x16bee3;}catch(_0xea8ab1){return _0x27484a[_0x45b135(0x1b7)][_0x45b135(0x1f0)](_0x45b135(0x1c1)+_0xea8ab1[_0x45b135(0x230)]),decisionCache[_0x529d40]={'decision':{'approved':!![],'reason':_0x45b135(0x1e8)},'timestamp':_0x2e4f37-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x45b135(0x1e8)};}}function a0_0xe817(){const _0x5e6885=['LTM.driftAnalysis.baselineDrift','currentSystemMode','parse','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','3916616VewDLs','.Current.Temperature','analysis.isAlert','Briefing\x20Error:\x20','driftDetails','unshift','.Current.WeatherText','analysis.activitySummary','pop','normal','37794oSapHG','response','Unbekannt','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','setStateAsync','isProVersion','Traffic-Schutz\x20(Auto-Approved)','1538900NnntRL','exports','LTM.processingStatus','185223qlEuya','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','push','isEmergency','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','.\x20SYSTEM_MODE:\x20','automationProposal','KI-Fehler\x20(Fallback)','activityLevel','replace','.\x20EVENTS:\x20','alertReason','Skipped\x20(No\x20AI\x20or\x20Data)','ðŸ“…\x20Daily\x20Digest:\x0a','47489RONjlU','warn','targetId','analysis.lastResult','config','detected','analysis.automation.targetValue','Tag','.\x20ANWESEND:\x20','decision','baselineDrift','lastAlertState','Skipped\x20(Traffic)','useWeather','stringify','generateContent','error','(((.+)+)+)+$','LTM.dailyDigests','text','Sicherheit\x20geht\x20vor.','Success','.\x20KONTEXT:\x20','analysis.analysisHistory',',\x20LichtverhÃ¤ltnisse:\x20','analysis.automation.description','reason','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','isAlert','LTM.driftAnalysis.driftDetails','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','weatherInstance','Unbekannt\x20(Kein\x20Sensor)','168UjtKTi','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','dailyDigests','884cuWOAK','KI\x20offline\x20(Fallback)','trim','summary','ltmStbWindowDays',').\x20Sending\x20notification...','9RobHDm','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','models/gemini-flash-latest','\x0aAktivitÃ¤t:\x20','analysis.alertReason','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','analysisHistory','getForeignStateAsync','Digest','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','eventHistory','constructor','length','livingContext','.forecast.current.temperature','toLocaleTimeString','\x20Ã¼bersprungen\x20(Auto-Approved).','search','Gemini\x20Error:\x20','apply','BUTLER\x20Execution\x20Error:\x20','info','message','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','4ZPaSpJ','Nacht','analysis.automation.patternDetected','getStateAsync','N/A\x20(Learning)','val','\x0aSTB:\x20','generic','sendNotification','.\x20EMERGENCY:\x20','now','description','slice','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','\x20=\x20','toString','geminiModel','log','debug','rawEventLog','aiPersona','Keine\x20Details.','âš ï¸\x20ALARM:\x20','send','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','6945yflOrw','./setup','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','%)\x20nach\x20\x22','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','1169048iTwBWT','ðŸŒ…\x20Morning\x20Briefing:\x0a','analysis.automation.autoApply','system.presenceWho'];a0_0xe817=function(){return _0x5e6885;};return a0_0xe817();}async function runGeminiAnalysis(_0x5e2b6f,_0x93e8cb=''){const _0x7b7e2e=a0_0x4a9127;if(!_0x5e2b6f[_0x7b7e2e(0x1b6)])return;if(!canCallApi()){_0x5e2b6f['log'][_0x7b7e2e(0x1b8)]('ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x5e2b6f[_0x7b7e2e(0x224)][_0x7b7e2e(0x226)]===0x0)return;const _0x38a2ab=_0x5e2b6f[_0x7b7e2e(0x224)]['slice'](0x0,0xf),_0x16e8f4=_0x5e2b6f[_0x7b7e2e(0x1c9)],_0x5f0d4d=PERSONA_MAPPING[_0x5e2b6f[_0x7b7e2e(0x1f3)][_0x7b7e2e(0x1ba)]||_0x7b7e2e(0x1ad)],_0x3499cd=_0x5e2b6f[_0x7b7e2e(0x1f3)][_0x7b7e2e(0x227)]||_0x7b7e2e(0x1bb);let _0x15da2c=_0x7b7e2e(0x1d8);try{const _0x3ad675=await _0x5e2b6f[_0x7b7e2e(0x1a9)](_0x7b7e2e(0x1c7));if(_0x3ad675&&_0x3ad675[_0x7b7e2e(0x1ab)])_0x15da2c=_0x3ad675[_0x7b7e2e(0x1ab)];}catch(_0x1ec4be){}let _0x5ccbe1=![];try{const _0x23086e=await _0x5e2b6f[_0x7b7e2e(0x1a9)](_0x7b7e2e(0x1c6));if(_0x23086e&&_0x23086e[_0x7b7e2e(0x1ab)])_0x5ccbe1=!![];}catch(_0x3417e5){}const _0x2b2d68=_0x7b7e2e(0x212)+_0x5f0d4d+_0x7b7e2e(0x205)+_0x3499cd+_0x7b7e2e(0x1e6)+_0x16e8f4+_0x7b7e2e(0x1f7)+_0x15da2c+_0x7b7e2e(0x1eb)+JSON[_0x7b7e2e(0x1fd)](_0x38a2ab)+_0x7b7e2e(0x1af)+_0x93e8cb+_0x7b7e2e(0x1d9);try{updateApiTimestamp();const _0x5086da=await _0x5e2b6f[_0x7b7e2e(0x1b6)]['generateContent'](_0x2b2d68),_0x32c5d0=JSON[_0x7b7e2e(0x1ca)](_0x5086da[_0x7b7e2e(0x1d7)][_0x7b7e2e(0x202)]()[_0x7b7e2e(0x1ea)](/```json|```/g,'')['trim']());await _0x5e2b6f['setStateAsync'](_0x7b7e2e(0x1f2),{'val':JSON[_0x7b7e2e(0x1fd)](_0x32c5d0),'ack':!![]});if(_0x32c5d0['summary'])await _0x5e2b6f[_0x7b7e2e(0x1db)](_0x7b7e2e(0x1d3),{'val':_0x32c5d0['summary'],'ack':!![]});const _0x4a20f5={'timestamp':Date['now'](),'id':Date['now']()[_0x7b7e2e(0x1b5)](),'analysis':{'activity':{'summary':_0x32c5d0[_0x7b7e2e(0x217)],'isAlert':_0x32c5d0[_0x7b7e2e(0x20c)],'alertReason':_0x32c5d0[_0x7b7e2e(0x1ec)]},'comfort':{'automationProposal':_0x32c5d0[_0x7b7e2e(0x1e7)]}}};_0x5e2b6f[_0x7b7e2e(0x220)][_0x7b7e2e(0x1d1)](_0x4a20f5);if(_0x5e2b6f[_0x7b7e2e(0x220)][_0x7b7e2e(0x226)]>0x32)_0x5e2b6f[_0x7b7e2e(0x220)][_0x7b7e2e(0x1d4)]();await _0x5e2b6f[_0x7b7e2e(0x1db)](_0x7b7e2e(0x206),{'val':JSON['stringify'](_0x5e2b6f[_0x7b7e2e(0x220)]),'ack':!![]});const _0x3fb7ca=_0x32c5d0[_0x7b7e2e(0x20c)]||![];_0x3fb7ca!==_0x5e2b6f[_0x7b7e2e(0x1fa)]&&(await _0x5e2b6f['setStateAsync'](_0x7b7e2e(0x1ce),{'val':_0x3fb7ca,'ack':!![]}),_0x5e2b6f['lastAlertState']=_0x3fb7ca,_0x3fb7ca&&(await _0x5e2b6f[_0x7b7e2e(0x1db)](_0x7b7e2e(0x21e),{'val':_0x32c5d0[_0x7b7e2e(0x1ec)],'ack':!![]}),setup['sendNotification'](_0x5e2b6f,_0x7b7e2e(0x1bc)+_0x32c5d0[_0x7b7e2e(0x1ec)],![],_0x32c5d0[_0x7b7e2e(0x1e4)])));if(_0x32c5d0[_0x7b7e2e(0x1e7)]&&_0x32c5d0[_0x7b7e2e(0x1e7)][_0x7b7e2e(0x1f4)]){await _0x5e2b6f['setStateAsync'](_0x7b7e2e(0x234),{'val':!![],'ack':!![]}),await _0x5e2b6f[_0x7b7e2e(0x1db)](_0x7b7e2e(0x208),{'val':_0x32c5d0['automationProposal'][_0x7b7e2e(0x1b1)],'ack':!![]}),await _0x5e2b6f[_0x7b7e2e(0x1db)]('analysis.automation.targetId',{'val':_0x32c5d0[_0x7b7e2e(0x1e7)][_0x7b7e2e(0x1f1)],'ack':!![]}),await _0x5e2b6f['setStateAsync'](_0x7b7e2e(0x1f5),{'val':JSON['stringify'](_0x32c5d0['automationProposal']['targetValue']),'ack':!![]});if(_0x5ccbe1)executeAutomationAction(_0x5e2b6f);}}catch(_0x451a80){_0x5e2b6f['log'][_0x7b7e2e(0x1ff)](_0x7b7e2e(0x22c)+_0x451a80[_0x7b7e2e(0x230)]);}}function a0_0x17d4(_0x383d28,_0x36a8b8){const _0x26cf79=a0_0xe817();return a0_0x17d4=function(_0x28f8ef,_0x397fa0){_0x28f8ef=_0x28f8ef-0x1a9;let _0xe81779=_0x26cf79[_0x28f8ef];return _0xe81779;},a0_0x17d4(_0x383d28,_0x36a8b8);}async function createDailyDigest(_0x1075d0,_0x2acafe){const _0x1f7411=a0_0x4a9127;if(!_0x1075d0['isProVersion'])return;if(!canCallApi()){await _0x1075d0[_0x1f7411(0x1db)](LTM_DP_STATUS,{'val':_0x1f7411(0x1fb),'ack':!![]});return;}await _0x1075d0[_0x1f7411(0x1db)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x1075d0['geminiModel']||_0x1075d0[_0x1f7411(0x1b9)][_0x1f7411(0x226)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1075d0[_0x1f7411(0x1db)](LTM_DP_STATUS,{'val':_0x1f7411(0x1ed),'ack':!![]});return;}const _0x12c49e=JSON[_0x1f7411(0x1ca)](JSON[_0x1f7411(0x1fd)](_0x1075d0[_0x1f7411(0x1b9)])),_0x36ccdc=_0x12c49e['length'],_0x1391b6='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x1f7411(0x1fd)](_0x12c49e);try{updateApiTimestamp();const _0x126c7e=await _0x1075d0[_0x1f7411(0x1b6)]['generateContent'](_0x1391b6),_0x2315f4=JSON[_0x1f7411(0x1ca)](_0x126c7e[_0x1f7411(0x1d7)][_0x1f7411(0x202)]()[_0x1f7411(0x1ea)](/```json|```/g,'')[_0x1f7411(0x216)]()),_0x243ed6={'timestamp':new Date()['toISOString'](),'eventCount':_0x36ccdc,'summary':_0x2315f4[_0x1f7411(0x217)]||_0x1f7411(0x222),'activityLevel':_0x2315f4[_0x1f7411(0x1e9)]||_0x1f7411(0x1d5),'systemMode':_0x1075d0['currentSystemMode']};_0x1075d0[_0x1f7411(0x213)][_0x1f7411(0x1e3)](_0x243ed6);const _0x116f19=_0x1075d0[_0x1f7411(0x1f3)]['ltmLtbWindowDays']||0x3c;_0x1075d0[_0x1f7411(0x213)]['length']>_0x116f19&&_0x1075d0['dailyDigests']['splice'](0x0,_0x1075d0['dailyDigests'][_0x1f7411(0x226)]-_0x116f19);await _0x1075d0[_0x1f7411(0x1db)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1f7411(0x1fd)](_0x1075d0['dailyDigests']),'ack':!![]}),_0x1075d0[_0x1f7411(0x1b9)]=[],await _0x1075d0['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x1f7411(0x1fd)](_0x1075d0[_0x1f7411(0x1b9)]),'ack':!![]}),await _0x1075d0[_0x1f7411(0x1db)](LTM_DP_STATUS,{'val':_0x1f7411(0x204),'ack':!![]});const _0x32676f=_0x1f7411(0x1ee)+_0x2315f4[_0x1f7411(0x217)]+_0x1f7411(0x21d)+_0x2315f4[_0x1f7411(0x1e9)];setup[_0x1f7411(0x1ae)](_0x1075d0,_0x32676f,![],![]);if(_0x1075d0[_0x1f7411(0x1dc)]&&_0x2acafe)_0x2acafe[_0x1f7411(0x1bd)](_0x1075d0,'ANALYZE_HEALTH',{'digest':_0x243ed6});}catch(_0x3b4b4d){_0x1075d0[_0x1f7411(0x1b7)][_0x1f7411(0x1ff)](_0x3b4b4d[_0x1f7411(0x230)]);}}async function runBaselineDriftAnalysis(_0xaf4b97){const _0x58157c=a0_0x4a9127;if(!_0xaf4b97[_0x58157c(0x1dc)]||!_0xaf4b97['geminiModel'])return;if(!canCallApi())return;const _0x25f817=_0xaf4b97[_0x58157c(0x1f3)][_0x58157c(0x218)]||0xe;if(_0xaf4b97[_0x58157c(0x213)][_0x58157c(0x226)]<_0x25f817+0x7){await _0xaf4b97[_0x58157c(0x1db)](_0x58157c(0x1c8),{'val':_0x58157c(0x1aa),'ack':!![]});return;}const _0x38c9b6=_0xaf4b97['dailyDigests']['slice'](-_0x25f817),_0x10fcac=_0xaf4b97[_0x58157c(0x213)][_0x58157c(0x1b2)](0x0,_0xaf4b97[_0x58157c(0x213)][_0x58157c(0x226)]-_0x25f817),_0x481526=_0x58157c(0x20a)+JSON[_0x58157c(0x1fd)](_0x10fcac)+_0x58157c(0x1ac)+JSON[_0x58157c(0x1fd)](_0x38c9b6);try{updateApiTimestamp();const _0x8fba8d=await _0xaf4b97[_0x58157c(0x1b6)]['generateContent'](_0x481526),_0x2b1040=JSON[_0x58157c(0x1ca)](_0x8fba8d['response'][_0x58157c(0x202)]()[_0x58157c(0x1ea)](/```json|```/g,'')[_0x58157c(0x216)]());_0x2b1040[_0x58157c(0x1f9)]&&(await _0xaf4b97[_0x58157c(0x1db)](_0x58157c(0x1c8),{'val':_0x2b1040[_0x58157c(0x1f9)],'ack':!![]}),await _0xaf4b97[_0x58157c(0x1db)](_0x58157c(0x20d),{'val':_0x2b1040[_0x58157c(0x1d0)],'ack':!![]}),await _0xaf4b97['setStateAsync']('LTM.driftAnalysis.lastCheck',{'val':Date[_0x58157c(0x1b0)](),'ack':!![]}));}catch(_0x1b269e){}}async function executeAutomationAction(_0x4ea1ae){const _0x48e215=a0_0x4a9127;try{const _0x30d47a=await _0x4ea1ae[_0x48e215(0x1a9)]('analysis.automation.targetId'),_0x3a0a30=await _0x4ea1ae[_0x48e215(0x1a9)](_0x48e215(0x1f5));if(_0x30d47a&&_0x30d47a[_0x48e215(0x1ab)]&&_0x3a0a30){const _0x5b67c6=_0x30d47a[_0x48e215(0x1ab)];let _0x31db4d=_0x3a0a30[_0x48e215(0x1ab)];try{_0x31db4d=JSON['parse'](_0x31db4d);}catch(_0x3b4d56){}_0x4ea1ae[_0x48e215(0x1b7)][_0x48e215(0x22f)](_0x48e215(0x1e5)+_0x5b67c6+_0x48e215(0x1b4)+_0x31db4d),await _0x4ea1ae['setForeignStateAsync'](_0x5b67c6,_0x31db4d);}else _0x4ea1ae[_0x48e215(0x1b7)][_0x48e215(0x1f0)](_0x48e215(0x1e2));}catch(_0x2d0483){_0x4ea1ae[_0x48e215(0x1b7)]['error'](_0x48e215(0x22e)+_0x2d0483[_0x48e215(0x230)]);}}async function sendMorningBriefing(_0x29f11d){const _0x267d18=a0_0x4a9127;if(!_0x29f11d['geminiModel']){_0x29f11d['log']['warn'](_0x267d18(0x20b));return;}_0x29f11d[_0x267d18(0x1b7)]['info']('ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x5c3926=_0x267d18(0x20e),_0x2de7c6=await _0x29f11d[_0x267d18(0x1b6)][_0x267d18(0x1fe)](_0x5c3926),_0x334726=_0x2de7c6[_0x267d18(0x1d7)][_0x267d18(0x202)]();_0x29f11d['log']['info'](_0x267d18(0x1be)+_0x334726['length']+_0x267d18(0x219)),setup['sendNotification'](_0x29f11d,_0x267d18(0x1c5)+_0x334726);}catch(_0x14cbe7){_0x29f11d[_0x267d18(0x1b7)][_0x267d18(0x1ff)](_0x267d18(0x1cf)+_0x14cbe7['message']);}}module[a0_0x4a9127(0x1df)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};