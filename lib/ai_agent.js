const a0_0x3a28c0=a0_0x5a75;(function(_0x460f60,_0x10d46a){const _0x8bcb21=a0_0x5a75,_0x21e613=_0x460f60();while(!![]){try{const _0x16c3d3=parseInt(_0x8bcb21(0x177))/0x1+-parseInt(_0x8bcb21(0x157))/0x2+-parseInt(_0x8bcb21(0x14e))/0x3*(-parseInt(_0x8bcb21(0x185))/0x4)+-parseInt(_0x8bcb21(0x15f))/0x5+-parseInt(_0x8bcb21(0x182))/0x6*(-parseInt(_0x8bcb21(0x14b))/0x7)+parseInt(_0x8bcb21(0x194))/0x8*(-parseInt(_0x8bcb21(0x1c8))/0x9)+parseInt(_0x8bcb21(0x163))/0xa*(-parseInt(_0x8bcb21(0x13f))/0xb);if(_0x16c3d3===_0x10d46a)break;else _0x21e613['push'](_0x21e613['shift']());}catch(_0xef6ce2){_0x21e613['push'](_0x21e613['shift']());}}}(a0_0x25b8,0xb607b));const a0_0x19486e=(function(){let _0x4d627e=!![];return function(_0x33247c,_0x3d709d){const _0x1d44c4=_0x4d627e?function(){const _0x37552d=a0_0x5a75;if(_0x3d709d){const _0x4ff155=_0x3d709d[_0x37552d(0x175)](_0x33247c,arguments);return _0x3d709d=null,_0x4ff155;}}:function(){};return _0x4d627e=![],_0x1d44c4;};}()),a0_0x5b585d=a0_0x19486e(this,function(){const _0x4c0e6f=a0_0x5a75;return a0_0x5b585d[_0x4c0e6f(0x1b4)]()[_0x4c0e6f(0x1ac)](_0x4c0e6f(0x171))['toString']()[_0x4c0e6f(0x191)](a0_0x5b585d)[_0x4c0e6f(0x1ac)](_0x4c0e6f(0x171));});a0_0x5b585d();'use strict';const {GoogleGenerativeAI}=require(a0_0x3a28c0(0x168)),setup=require(a0_0x3a28c0(0x198)),GEMINI_MODEL=a0_0x3a28c0(0x183),LTM_DP_DAILY_DIGESTS=a0_0x3a28c0(0x13a),LTM_DP_STATUS=a0_0x3a28c0(0x18b),LTM_DP_RAW_LOG=a0_0x3a28c0(0x1cd),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;function a0_0x25b8(){const _0x3c5266=['Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','setHours','analysis.automation.targetId','baselineDrift','replace','.Current.Temperature','114RjsFlh','models/gemini-flash-latest','.forecast.current.state','25444PiQYpv','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','stringify','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','warn','analysisHistory','LTM.processingStatus','isProVersion','analysis.health.geminiNight','\x20=\x20','Tag','setDate','constructor','log','getStateAsync','8LUgsMm','BUTLER\x20Execution\x20Error:\x20','val',').\x20Sending\x20notification...','./setup','send','.\x20EVENTS:\x20','analysis.automation.description','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','toISOString','join','analysis.isAlert','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','driftDetails','slice','aiPersona','analysis.lastResult','analysis.health.geminiDay','N/A\x20(Learning)','setStateAsync','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','unshift','search','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','%)\x20nach\x20\x22','ðŸ“…\x20Daily\x20Digest:\x0a','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','LTM.driftAnalysis.baselineDrift','toString','ltmLtbWindowDays','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','ltmStbWindowDays','KI-Fehler\x20(Fallback)','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','isAlert','now','ðŸŒ…\x20Morning\x20Briefing:\x0a','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','Wetterdaten\x20nicht\x20abrufbar','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','\x0aSTB:\x20','automationProposal','Gemini\x20Error:\x20','getForeignStateAsync','name','activityLevel','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','4225887vEWJiV','system.presenceWho','debug','weatherInstance','ðŸ¤–\x20Health\x20Report\x20(','LTM.rawEventLog','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','length','generic','getTime','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','.\x20EMERGENCY:\x20','analysis.automation.targetValue','toLocaleTimeString','isEmergency','splice','info','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','decision','2-digit','alertReason','livingContext','config','timestamp','generateContent','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','LTM.dailyDigests','ANALYZE_HEALTH','geminiModel','useWeather','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','95326MIbMKB','analysis.automation.autoApply','\x20Ã¼bersprungen\x20(Auto-Approved).','dailyDigests','Unbekannt','error','analysis.automation.patternDetected','lastAlertState',',\x20Wetter:\x20','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','eventHistory','trim','531139eUQVkX','NIGHT','Traffic-Schutz\x20(Auto-Approved)','447QqOxor','reason',',\x20LichtverhÃ¤ltnisse:\x20','targetId','Digest','detected','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','push','getDate','727384loxwas','âš ï¸\x20ALARM:\x20','analysis.alertReason','message','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','LTM.driftAnalysis.driftDetails','Nacht','.\x20SYSTEM_MODE:\x20','4471445QdskLD','rawEventLog','Unbekannt\x20(Kein\x20Sensor)','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','1580hmHKfW','.Current.WeatherText','\x0a\x20\x20\x20\x20EVENTS:\x0a','normal','.\x20ANWESEND:\x20','@google/generative-ai','parse','\x20->\x20','description','Success','.Current.IsNight','toFixed','text','response','(((.+)+)+)+$','pop','sendNotification',')\x20generated.','apply','Health\x20Report\x20Error:\x20','1452895CUjSgU','summary','exports','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','targetValue'];a0_0x25b8=function(){return _0x3c5266;};return a0_0x25b8();}const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x3a28c0(0x1b2),'senior_aal':a0_0x3a28c0(0x1b6),'family':a0_0x3a28c0(0x17c),'single_comfort':a0_0x3a28c0(0x186),'security':'Sicherheit\x20geht\x20vor.','energy_saver':'PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).'};function canCallApi(){const _0x172c92=a0_0x3a28c0,_0x4c7af1=Date[_0x172c92(0x1bc)]();return _0x4c7af1-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){lastGlobalApiCall=Date['now']();}async function getWeatherContext(_0x2f6559){const _0x311d13=a0_0x3a28c0;if(!_0x2f6559[_0x311d13(0x136)][_0x311d13(0x13d)]||!_0x2f6559['config'][_0x311d13(0x1cb)])return _0x311d13(0x161);try{const _0x3e3ca2=_0x2f6559['config'][_0x311d13(0x1cb)];let _0x524d42=await _0x2f6559['getForeignStateAsync'](_0x3e3ca2+_0x311d13(0x181));if(!_0x524d42)_0x524d42=await _0x2f6559[_0x311d13(0x1c4)](_0x3e3ca2+'.forecast.current.temperature');let _0x5b98a3=await _0x2f6559['getForeignStateAsync'](_0x3e3ca2+_0x311d13(0x164));if(!_0x5b98a3)_0x5b98a3=await _0x2f6559[_0x311d13(0x1c4)](_0x3e3ca2+_0x311d13(0x184));let _0x5f42ba='Unbekannt';const _0x49946a=await _0x2f6559[_0x311d13(0x1c4)](_0x3e3ca2+_0x311d13(0x16d));if(_0x49946a)_0x5f42ba=_0x49946a[_0x311d13(0x196)]?_0x311d13(0x15d):_0x311d13(0x18f);if(_0x524d42&&_0x5b98a3)return _0x524d42[_0x311d13(0x196)]+'Â°C,\x20'+_0x5b98a3[_0x311d13(0x196)]+_0x311d13(0x150)+_0x5f42ba;}catch(_0x131665){}return _0x311d13(0x1bf);}function a0_0x5a75(_0x2fc247,_0xa0c79f){const _0x541cc8=a0_0x25b8();return a0_0x5a75=function(_0x5b585d,_0x19486e){_0x5b585d=_0x5b585d-0x132;let _0x25b83a=_0x541cc8[_0x5b585d];return _0x25b83a;},a0_0x5a75(_0x2fc247,_0xa0c79f);}async function consultButler(_0x2319ec,_0x294ca8,_0x13a2d9,_0x5693b5){const _0x2aa58b=a0_0x3a28c0;if(!_0x2319ec[_0x2aa58b(0x13c)])return{'approved':!![],'reason':'KI\x20offline\x20(Fallback)'};const _0x292a2c=Date['now']();if(decisionCache[_0x294ca8]&&_0x292a2c-decisionCache[_0x294ca8][_0x2aa58b(0x137)]<CACHE_TTL_MS){const _0x44ae8d=decisionCache[_0x294ca8][_0x2aa58b(0x132)];return _0x2319ec[_0x2aa58b(0x192)][_0x2aa58b(0x1ca)](_0x2aa58b(0x1aa)+_0x294ca8+_0x2aa58b(0x16a)+(_0x44ae8d['approved']?'OK':'NO')+'\x20('+_0x44ae8d[_0x2aa58b(0x14f)]+')'),_0x44ae8d;}if(!canCallApi())return _0x2319ec['log'][_0x2aa58b(0x1ca)](_0x2aa58b(0x1d9)+_0x294ca8+_0x2aa58b(0x141)),{'approved':!![],'reason':_0x2aa58b(0x14d)};const _0x59a539=new Date()[_0x2aa58b(0x1d5)](),_0x7ab75d=await getWeatherContext(_0x2319ec),_0x382926=PERSONA_MAPPING[_0x2319ec[_0x2aa58b(0x136)][_0x2aa58b(0x1a5)]||_0x2aa58b(0x1d0)],_0x140b8f=_0x2aa58b(0x154)+_0x59a539+_0x2aa58b(0x147)+_0x7ab75d+_0x2aa58b(0x162)+(_0x5693b5*0x64)[_0x2aa58b(0x16e)](0x0)+_0x2aa58b(0x1af)+_0x294ca8+_0x2aa58b(0x1c0)+_0x13a2d9+_0x2aa58b(0x1be)+_0x382926+_0x2aa58b(0x15b);try{updateApiTimestamp();const _0x42651b=await _0x2319ec['geminiModel']['generateContent'](_0x140b8f),_0x2b133c=_0x42651b[_0x2aa58b(0x170)][_0x2aa58b(0x16f)]()[_0x2aa58b(0x180)](/```json|```/g,'')['trim'](),_0x1b6805=JSON[_0x2aa58b(0x169)](_0x2b133c);return decisionCache[_0x294ca8]={'decision':_0x1b6805,'timestamp':_0x292a2c},_0x1b6805;}catch(_0xffefa0){return _0x2319ec[_0x2aa58b(0x192)][_0x2aa58b(0x189)](_0x2aa58b(0x1ae)+_0xffefa0[_0x2aa58b(0x15a)]),decisionCache[_0x294ca8]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x292a2c-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x2aa58b(0x1b8)};}}async function runGeminiAnalysis(_0x44877a,_0x4c0e5c=''){const _0x53f2af=a0_0x3a28c0;if(!_0x44877a[_0x53f2af(0x13c)])return;if(!canCallApi()){_0x44877a[_0x53f2af(0x192)][_0x53f2af(0x1ca)](_0x53f2af(0x13e));return;}if(_0x44877a[_0x53f2af(0x149)][_0x53f2af(0x1cf)]===0x0)return;const _0x35a0cc=_0x44877a[_0x53f2af(0x149)][_0x53f2af(0x1a4)](0x0,0xf),_0x2a4353=_0x44877a['currentSystemMode'],_0x594102=PERSONA_MAPPING[_0x44877a[_0x53f2af(0x136)][_0x53f2af(0x1a5)]||_0x53f2af(0x1d0)],_0x33252d=_0x44877a[_0x53f2af(0x136)][_0x53f2af(0x135)]||'Keine\x20Details.';let _0x5c4b6c=_0x53f2af(0x143);try{const _0x2f2ea7=await _0x44877a[_0x53f2af(0x193)](_0x53f2af(0x1c9));if(_0x2f2ea7&&_0x2f2ea7[_0x53f2af(0x196)])_0x5c4b6c=_0x2f2ea7[_0x53f2af(0x196)];}catch(_0x323001){}let _0x297009=![];try{const _0x5d13c0=await _0x44877a[_0x53f2af(0x193)](_0x53f2af(0x140));if(_0x5d13c0&&_0x5d13c0[_0x53f2af(0x196)])_0x297009=!![];}catch(_0x2ff56c){}const _0x28232f=_0x53f2af(0x148)+_0x594102+'.\x20KONTEXT:\x20'+_0x33252d+_0x53f2af(0x15e)+_0x2a4353+_0x53f2af(0x167)+_0x5c4b6c+_0x53f2af(0x19a)+JSON['stringify'](_0x35a0cc)+_0x53f2af(0x1d3)+_0x4c0e5c+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x55d082=await _0x44877a[_0x53f2af(0x13c)]['generateContent'](_0x28232f),_0x484dbd=JSON['parse'](_0x55d082[_0x53f2af(0x170)]['text']()[_0x53f2af(0x180)](/```json|```/g,'')[_0x53f2af(0x14a)]());await _0x44877a[_0x53f2af(0x1a9)](_0x53f2af(0x1a6),{'val':JSON[_0x53f2af(0x187)](_0x484dbd),'ack':!![]});if(_0x484dbd[_0x53f2af(0x178)])await _0x44877a[_0x53f2af(0x1a9)]('analysis.activitySummary',{'val':_0x484dbd[_0x53f2af(0x178)],'ack':!![]});const _0xa35fce={'timestamp':Date[_0x53f2af(0x1bc)](),'id':Date['now']()[_0x53f2af(0x1b4)](),'analysis':{'activity':{'summary':_0x484dbd[_0x53f2af(0x178)],'isAlert':_0x484dbd[_0x53f2af(0x1bb)],'alertReason':_0x484dbd['alertReason']},'comfort':{'automationProposal':_0x484dbd[_0x53f2af(0x1c2)]}}};_0x44877a[_0x53f2af(0x18a)][_0x53f2af(0x1ab)](_0xa35fce);if(_0x44877a[_0x53f2af(0x18a)]['length']>0x32)_0x44877a[_0x53f2af(0x18a)][_0x53f2af(0x172)]();await _0x44877a[_0x53f2af(0x1a9)]('analysis.analysisHistory',{'val':JSON[_0x53f2af(0x187)](_0x44877a[_0x53f2af(0x18a)]),'ack':!![]});const _0x256cc3=_0x484dbd['isAlert']||![];_0x256cc3!==_0x44877a[_0x53f2af(0x146)]&&(await _0x44877a[_0x53f2af(0x1a9)](_0x53f2af(0x1a0),{'val':_0x256cc3,'ack':!![]}),_0x44877a[_0x53f2af(0x146)]=_0x256cc3,_0x256cc3&&(await _0x44877a['setStateAsync'](_0x53f2af(0x159),{'val':_0x484dbd[_0x53f2af(0x134)],'ack':!![]}),setup[_0x53f2af(0x173)](_0x44877a,_0x53f2af(0x158)+_0x484dbd['alertReason'],![],_0x484dbd[_0x53f2af(0x1d6)])));if(_0x484dbd[_0x53f2af(0x1c2)]&&_0x484dbd[_0x53f2af(0x1c2)][_0x53f2af(0x153)]){await _0x44877a[_0x53f2af(0x1a9)](_0x53f2af(0x145),{'val':!![],'ack':!![]}),await _0x44877a['setStateAsync'](_0x53f2af(0x19b),{'val':_0x484dbd['automationProposal'][_0x53f2af(0x16b)],'ack':!![]}),await _0x44877a[_0x53f2af(0x1a9)](_0x53f2af(0x17e),{'val':_0x484dbd[_0x53f2af(0x1c2)][_0x53f2af(0x151)],'ack':!![]}),await _0x44877a[_0x53f2af(0x1a9)](_0x53f2af(0x1d4),{'val':JSON[_0x53f2af(0x187)](_0x484dbd['automationProposal'][_0x53f2af(0x17b)]),'ack':!![]});if(_0x297009)executeAutomationAction(_0x44877a);}}catch(_0xd7180a){_0x44877a[_0x53f2af(0x192)][_0x53f2af(0x144)](_0x53f2af(0x1c3)+_0xd7180a[_0x53f2af(0x15a)]);}}async function createDailyDigest(_0x1d5b86,_0x3a9eec){const _0x4bda20=a0_0x3a28c0;if(!_0x1d5b86['isProVersion'])return;if(!canCallApi()){await _0x1d5b86[_0x4bda20(0x1a9)](LTM_DP_STATUS,{'val':'Skipped\x20(Traffic)','ack':!![]});return;}await _0x1d5b86['setStateAsync'](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x1d5b86[_0x4bda20(0x13c)]||_0x1d5b86[_0x4bda20(0x160)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1d5b86[_0x4bda20(0x1a9)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x2e093f=JSON[_0x4bda20(0x169)](JSON[_0x4bda20(0x187)](_0x1d5b86[_0x4bda20(0x160)])),_0x314735=_0x2e093f[_0x4bda20(0x1cf)],_0x57ff81=_0x4bda20(0x1c7)+JSON[_0x4bda20(0x187)](_0x2e093f);try{updateApiTimestamp();const _0x10eb45=await _0x1d5b86[_0x4bda20(0x13c)][_0x4bda20(0x138)](_0x57ff81),_0x59bfd8=JSON[_0x4bda20(0x169)](_0x10eb45[_0x4bda20(0x170)][_0x4bda20(0x16f)]()[_0x4bda20(0x180)](/```json|```/g,'')['trim']()),_0xb5db91={'timestamp':new Date()[_0x4bda20(0x19e)](),'eventCount':_0x314735,'summary':_0x59bfd8['summary']||_0x4bda20(0x152),'activityLevel':_0x59bfd8[_0x4bda20(0x1c6)]||_0x4bda20(0x166),'systemMode':_0x1d5b86['currentSystemMode']};_0x1d5b86[_0x4bda20(0x142)][_0x4bda20(0x155)](_0xb5db91);const _0x45ae98=_0x1d5b86[_0x4bda20(0x136)][_0x4bda20(0x1b5)]||0x3c;_0x1d5b86[_0x4bda20(0x142)][_0x4bda20(0x1cf)]>_0x45ae98&&_0x1d5b86[_0x4bda20(0x142)][_0x4bda20(0x1d7)](0x0,_0x1d5b86['dailyDigests'][_0x4bda20(0x1cf)]-_0x45ae98);await _0x1d5b86[_0x4bda20(0x1a9)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x4bda20(0x187)](_0x1d5b86['dailyDigests']),'ack':!![]}),_0x1d5b86[_0x4bda20(0x160)]=[],await _0x1d5b86['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x4bda20(0x187)](_0x1d5b86['rawEventLog']),'ack':!![]}),await _0x1d5b86[_0x4bda20(0x1a9)](LTM_DP_STATUS,{'val':_0x4bda20(0x16c),'ack':!![]});const _0x3775b6=_0x4bda20(0x1b0)+_0x59bfd8['summary']+'\x0aAktivitÃ¤t:\x20'+_0x59bfd8['activityLevel'];setup['sendNotification'](_0x1d5b86,_0x3775b6,![],![]);if(_0x1d5b86[_0x4bda20(0x18c)]&&_0x3a9eec)_0x3a9eec[_0x4bda20(0x199)](_0x1d5b86,_0x4bda20(0x13b),{'digest':_0xb5db91});}catch(_0x4f450a){_0x1d5b86[_0x4bda20(0x192)]['error'](_0x4f450a[_0x4bda20(0x15a)]);}}async function runBaselineDriftAnalysis(_0x32851a){const _0x4f8adb=a0_0x3a28c0;if(!_0x32851a[_0x4f8adb(0x18c)]||!_0x32851a[_0x4f8adb(0x13c)])return;if(!canCallApi())return;const _0x214d21=_0x32851a['config'][_0x4f8adb(0x1b7)]||0xe;if(_0x32851a[_0x4f8adb(0x142)][_0x4f8adb(0x1cf)]<_0x214d21+0x7){await _0x32851a[_0x4f8adb(0x1a9)]('LTM.driftAnalysis.baselineDrift',{'val':_0x4f8adb(0x1a8),'ack':!![]});return;}const _0x5e3872=_0x32851a[_0x4f8adb(0x142)][_0x4f8adb(0x1a4)](-_0x214d21),_0x4f8c26=_0x32851a[_0x4f8adb(0x142)][_0x4f8adb(0x1a4)](0x0,_0x32851a[_0x4f8adb(0x142)][_0x4f8adb(0x1cf)]-_0x214d21),_0x3be655=_0x4f8adb(0x1ce)+JSON[_0x4f8adb(0x187)](_0x4f8c26)+_0x4f8adb(0x1c1)+JSON[_0x4f8adb(0x187)](_0x5e3872);try{updateApiTimestamp();const _0x43c75b=await _0x32851a['geminiModel'][_0x4f8adb(0x138)](_0x3be655),_0x5c7667=JSON[_0x4f8adb(0x169)](_0x43c75b[_0x4f8adb(0x170)][_0x4f8adb(0x16f)]()['replace'](/```json|```/g,'')[_0x4f8adb(0x14a)]());_0x5c7667[_0x4f8adb(0x17f)]&&(await _0x32851a[_0x4f8adb(0x1a9)](_0x4f8adb(0x1b3),{'val':_0x5c7667[_0x4f8adb(0x17f)],'ack':!![]}),await _0x32851a[_0x4f8adb(0x1a9)](_0x4f8adb(0x15c),{'val':_0x5c7667[_0x4f8adb(0x1a3)],'ack':!![]}),await _0x32851a[_0x4f8adb(0x1a9)]('LTM.driftAnalysis.lastCheck',{'val':Date[_0x4f8adb(0x1bc)](),'ack':!![]}));}catch(_0x16cb94){}}async function executeAutomationAction(_0x4ec807){const _0x2b1b53=a0_0x3a28c0;try{const _0x4e022c=await _0x4ec807[_0x2b1b53(0x193)](_0x2b1b53(0x17e)),_0x2172de=await _0x4ec807[_0x2b1b53(0x193)](_0x2b1b53(0x1d4));if(_0x4e022c&&_0x4e022c[_0x2b1b53(0x196)]&&_0x2172de){const _0x3b4603=_0x4e022c[_0x2b1b53(0x196)];let _0x36b745=_0x2172de[_0x2b1b53(0x196)];try{_0x36b745=JSON[_0x2b1b53(0x169)](_0x36b745);}catch(_0x22193c){}_0x4ec807[_0x2b1b53(0x192)][_0x2b1b53(0x1d8)](_0x2b1b53(0x1d2)+_0x3b4603+_0x2b1b53(0x18e)+_0x36b745),await _0x4ec807['setForeignStateAsync'](_0x3b4603,_0x36b745);}else _0x4ec807[_0x2b1b53(0x192)][_0x2b1b53(0x189)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x29d7d2){_0x4ec807['log']['error'](_0x2b1b53(0x195)+_0x29d7d2[_0x2b1b53(0x15a)]);}}async function sendMorningBriefing(_0x40c073){const _0x4ce580=a0_0x3a28c0;if(!_0x40c073[_0x4ce580(0x13c)]){_0x40c073[_0x4ce580(0x192)]['warn'](_0x4ce580(0x139));return;}_0x40c073['log']['info'](_0x4ce580(0x19c));try{updateApiTimestamp();const _0x4b92ab=_0x4ce580(0x1ad),_0x4449f2=await _0x40c073[_0x4ce580(0x13c)][_0x4ce580(0x138)](_0x4b92ab),_0x27eaf3=_0x4449f2[_0x4ce580(0x170)]['text']();_0x40c073[_0x4ce580(0x192)]['info'](_0x4ce580(0x19d)+_0x27eaf3['length']+_0x4ce580(0x197)),setup['sendNotification'](_0x40c073,_0x4ce580(0x1bd)+_0x27eaf3);}catch(_0x2df83c){_0x40c073['log']['error']('Briefing\x20Error:\x20'+_0x2df83c[_0x4ce580(0x15a)]);}}async function generateHealthReport(_0x4c7425,_0x57d9cc){const _0x38cef5=a0_0x3a28c0;if(!_0x4c7425[_0x38cef5(0x13c)])return;const _0x17c531=Date['now']();_0x17c531-lastGlobalApiCall<0xbb8&&(_0x4c7425[_0x38cef5(0x192)][_0x38cef5(0x1ca)](_0x38cef5(0x188)),await new Promise(_0x3af9b6=>setTimeout(_0x3af9b6,0x7d0)));const _0x21e92c=new Date();let _0x5b53ee=0x0,_0x27e192=_0x21e92c[_0x38cef5(0x1d1)](),_0xf24293='';if(_0x57d9cc===_0x38cef5(0x14c)){const _0x54c917=new Date(_0x21e92c);_0x54c917[_0x38cef5(0x190)](_0x54c917[_0x38cef5(0x156)]()-0x1),_0x54c917[_0x38cef5(0x17d)](0x16,0x0,0x0,0x0),_0x5b53ee=_0x54c917[_0x38cef5(0x1d1)]();const _0x3b7b18=new Date(_0x21e92c);_0x3b7b18[_0x38cef5(0x17d)](0x8,0x0,0x0,0x0),_0x27e192=_0x3b7b18['getTime'](),_0xf24293=_0x38cef5(0x1b1);}else{const _0x6291ca=new Date(_0x21e92c);_0x6291ca[_0x38cef5(0x17d)](0x8,0x0,0x0,0x0),_0x5b53ee=_0x6291ca[_0x38cef5(0x1d1)](),_0xf24293=_0x38cef5(0x1a2);}const _0xd406fe=_0x4c7425[_0x38cef5(0x149)]['filter'](_0x4dbfe9=>_0x4dbfe9['timestamp']>=_0x5b53ee&&_0x4dbfe9[_0x38cef5(0x137)]<=_0x27e192);if(_0xd406fe[_0x38cef5(0x1cf)]===0x0){const _0x139ee4=_0x57d9cc===_0x38cef5(0x14c)?_0x38cef5(0x1ba):_0x38cef5(0x17a),_0x3d955d=_0x57d9cc===_0x38cef5(0x14c)?_0x38cef5(0x18d):'analysis.health.geminiDay';await _0x4c7425[_0x38cef5(0x1a9)](_0x3d955d,{'val':_0x139ee4,'ack':!![]});return;}const _0x117c34=_0xd406fe['map'](_0x164286=>new Date(_0x164286[_0x38cef5(0x137)])[_0x38cef5(0x1d5)]([],{'hour':_0x38cef5(0x133),'minute':_0x38cef5(0x133)})+'\x20'+_0x164286[_0x38cef5(0x1c5)]+'\x20('+_0x164286['value']+')')[_0x38cef5(0x19f)]('\x0a'),_0x12d433=_0x38cef5(0x1a1)+_0xf24293+_0x38cef5(0x165)+_0x117c34+_0x38cef5(0x1b9);try{updateApiTimestamp();const _0x3a87b4=await _0x4c7425[_0x38cef5(0x13c)]['generateContent'](_0x12d433),_0x7d05b0=_0x3a87b4['response'][_0x38cef5(0x16f)](),_0x22bcd8=_0x57d9cc==='NIGHT'?_0x38cef5(0x18d):_0x38cef5(0x1a7);await _0x4c7425[_0x38cef5(0x1a9)](_0x22bcd8,{'val':_0x7d05b0,'ack':!![]}),_0x4c7425[_0x38cef5(0x192)][_0x38cef5(0x1d8)](_0x38cef5(0x1cc)+_0x57d9cc+_0x38cef5(0x174));}catch(_0x5af876){_0x4c7425['log']['error'](_0x38cef5(0x176)+_0x5af876[_0x38cef5(0x15a)]);}}module[a0_0x3a28c0(0x179)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};