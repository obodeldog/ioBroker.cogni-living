const a0_0x3a75bb=a0_0x2167;(function(_0x190bf5,_0x11fa65){const _0x2f5f0e=a0_0x2167,_0x52e378=_0x190bf5();while(!![]){try{const _0x483eda=-parseInt(_0x2f5f0e(0x17c))/0x1+-parseInt(_0x2f5f0e(0x188))/0x2+parseInt(_0x2f5f0e(0x118))/0x3+-parseInt(_0x2f5f0e(0x1a7))/0x4+parseInt(_0x2f5f0e(0x11f))/0x5*(-parseInt(_0x2f5f0e(0x135))/0x6)+parseInt(_0x2f5f0e(0x16d))/0x7+parseInt(_0x2f5f0e(0x124))/0x8*(parseInt(_0x2f5f0e(0x198))/0x9);if(_0x483eda===_0x11fa65)break;else _0x52e378['push'](_0x52e378['shift']());}catch(_0xa9d3d2){_0x52e378['push'](_0x52e378['shift']());}}}(a0_0x226e,0xebe42));const a0_0xbe440e=(function(){let _0x34563f=!![];return function(_0x133d06,_0x1a431b){const _0xa30de4=_0x34563f?function(){const _0x1236a0=a0_0x2167;if(_0x1a431b){const _0x11fee8=_0x1a431b[_0x1236a0(0x115)](_0x133d06,arguments);return _0x1a431b=null,_0x11fee8;}}:function(){};return _0x34563f=![],_0xa30de4;};}()),a0_0x45264f=a0_0xbe440e(this,function(){const _0x1606ca=a0_0x2167;return a0_0x45264f['toString']()[_0x1606ca(0x121)](_0x1606ca(0x1ae))[_0x1606ca(0x194)]()[_0x1606ca(0x161)](a0_0x45264f)[_0x1606ca(0x121)]('(((.+)+)+)+$');});a0_0x45264f();'use strict';const {GoogleGenerativeAI}=require(a0_0x3a75bb(0x13c)),setup=require(a0_0x3a75bb(0x159)),GEMINI_MODEL=a0_0x3a75bb(0x18b),LTM_DP_DAILY_DIGESTS=a0_0x3a75bb(0x18f),LTM_DP_STATUS=a0_0x3a75bb(0x156),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x3a75bb(0x12a),'senior_aal':a0_0x3a75bb(0x196),'family':'Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','single_comfort':a0_0x3a75bb(0x12b),'security':a0_0x3a75bb(0x1a0),'energy_saver':a0_0x3a75bb(0x138)};function canCallApi(){const _0x4c51c0=a0_0x3a75bb,_0x4941f1=Date[_0x4c51c0(0x141)]();return _0x4941f1-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x58d62b=a0_0x3a75bb;lastGlobalApiCall=Date[_0x58d62b(0x141)]();}async function getWeatherContext(_0x2b6471){const _0x3b88a9=a0_0x3a75bb;if(!_0x2b6471[_0x3b88a9(0x14a)][_0x3b88a9(0x18a)]||!_0x2b6471['config'][_0x3b88a9(0x142)])return _0x3b88a9(0x174);try{const _0x544845=_0x2b6471['config']['weatherInstance'];let _0x4129b8=await _0x2b6471['getForeignStateAsync'](_0x544845+_0x3b88a9(0x197));if(!_0x4129b8)_0x4129b8=await _0x2b6471['getForeignStateAsync'](_0x544845+'.forecast.current.temperature');let _0x406c18=await _0x2b6471[_0x3b88a9(0x199)](_0x544845+_0x3b88a9(0x179));if(!_0x406c18)_0x406c18=await _0x2b6471[_0x3b88a9(0x199)](_0x544845+_0x3b88a9(0x12f));let _0x43bf18='Unbekannt';const _0xa1e38b=await _0x2b6471[_0x3b88a9(0x199)](_0x544845+_0x3b88a9(0x170));if(_0xa1e38b)_0x43bf18=_0xa1e38b['val']?'Nacht':_0x3b88a9(0x182);if(_0x4129b8&&_0x406c18)return _0x4129b8[_0x3b88a9(0x16e)]+'Â°C,\x20'+_0x406c18['val']+_0x3b88a9(0x165)+_0x43bf18;}catch(_0x43de70){}return'Wetterdaten\x20nicht\x20abrufbar';}async function consultButler(_0x275951,_0x1c575b,_0x3544d6,_0x313709){const _0x225270=a0_0x3a75bb;if(!_0x275951['geminiModel'])return{'approved':!![],'reason':_0x225270(0x131)};const _0x2584f4=Date[_0x225270(0x141)]();if(decisionCache[_0x1c575b]&&_0x2584f4-decisionCache[_0x1c575b][_0x225270(0x154)]<CACHE_TTL_MS){const _0x507694=decisionCache[_0x1c575b]['decision'];return _0x275951[_0x225270(0x130)][_0x225270(0x117)](_0x225270(0x1a2)+_0x1c575b+_0x225270(0x143)+(_0x507694['approved']?'OK':'NO')+'\x20('+_0x507694['reason']+')'),_0x507694;}if(!canCallApi())return _0x275951[_0x225270(0x130)][_0x225270(0x117)](_0x225270(0x162)+_0x1c575b+_0x225270(0x160)),{'approved':!![],'reason':_0x225270(0x1af)};const _0x4b612f=new Date()[_0x225270(0x19e)](),_0x326c7b=await getWeatherContext(_0x275951),_0xb3ee1c=PERSONA_MAPPING[_0x275951[_0x225270(0x14a)][_0x225270(0x19a)]||'generic'],_0x57097b=_0x225270(0x1a4)+_0x4b612f+_0x225270(0x13e)+_0x326c7b+_0x225270(0x12c)+(_0x313709*0x64)[_0x225270(0x137)](0x0)+'%)\x20nach\x20\x22'+_0x1c575b+_0x225270(0x15e)+_0x3544d6+_0x225270(0x17e)+_0xb3ee1c+_0x225270(0x184);try{updateApiTimestamp();const _0x48d3c3=await _0x275951[_0x225270(0x169)][_0x225270(0x127)](_0x57097b),_0x4c4430=_0x48d3c3[_0x225270(0x147)]['text']()[_0x225270(0x148)](/```json|```/g,'')['trim'](),_0x1ca4d3=JSON[_0x225270(0x1a8)](_0x4c4430);return decisionCache[_0x1c575b]={'decision':_0x1ca4d3,'timestamp':_0x2584f4},_0x1ca4d3;}catch(_0x3cf1f2){return _0x275951[_0x225270(0x130)][_0x225270(0x18e)]('ðŸ¤–\x20Butler\x20Brain\x20Error:\x20'+_0x3cf1f2['message']),decisionCache[_0x1c575b]={'decision':{'approved':!![],'reason':_0x225270(0x16b)},'timestamp':_0x2584f4-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'};}}async function runGeminiAnalysis(_0x275806,_0x225ffa=''){const _0x563243=a0_0x3a75bb;if(!_0x275806[_0x563243(0x169)])return;if(!canCallApi()){_0x275806[_0x563243(0x130)]['debug'](_0x563243(0x134));return;}if(_0x275806[_0x563243(0x163)][_0x563243(0x15f)]===0x0)return;const _0x45d0b8=_0x275806[_0x563243(0x163)]['slice'](0x0,0xf),_0x34e8b=_0x275806[_0x563243(0x14c)],_0x16f496=PERSONA_MAPPING[_0x275806[_0x563243(0x14a)]['aiPersona']||_0x563243(0x149)],_0x2562a1=_0x275806[_0x563243(0x14a)][_0x563243(0x14e)]||_0x563243(0x1ac);let _0x560a63=_0x563243(0x172);try{const _0x34a74e=await _0x275806[_0x563243(0x16a)]('system.presenceWho');if(_0x34a74e&&_0x34a74e[_0x563243(0x16e)])_0x560a63=_0x34a74e[_0x563243(0x16e)];}catch(_0x25f7d0){}let _0x177e74=![];try{const _0x357202=await _0x275806[_0x563243(0x16a)](_0x563243(0x1a5));if(_0x357202&&_0x357202[_0x563243(0x16e)])_0x177e74=!![];}catch(_0x4b93d0){}const _0x5a5506=_0x563243(0x178)+_0x16f496+_0x563243(0x18d)+_0x2562a1+'.\x20SYSTEM_MODE:\x20'+_0x34e8b+'.\x20ANWESEND:\x20'+_0x560a63+'.\x20EVENTS:\x20'+JSON['stringify'](_0x45d0b8)+'.\x20EMERGENCY:\x20'+_0x225ffa+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x22bb89=await _0x275806[_0x563243(0x169)][_0x563243(0x127)](_0x5a5506),_0x486c61=JSON[_0x563243(0x1a8)](_0x22bb89[_0x563243(0x147)][_0x563243(0x181)]()[_0x563243(0x148)](/```json|```/g,'')[_0x563243(0x189)]());await _0x275806['setStateAsync'](_0x563243(0x186),{'val':JSON[_0x563243(0x1a3)](_0x486c61),'ack':!![]});if(_0x486c61[_0x563243(0x167)])await _0x275806[_0x563243(0x19c)](_0x563243(0x180),{'val':_0x486c61[_0x563243(0x167)],'ack':!![]});const _0x9a764={'timestamp':Date['now'](),'id':Date[_0x563243(0x141)]()[_0x563243(0x194)](),'analysis':{'activity':{'summary':_0x486c61['summary'],'isAlert':_0x486c61['isAlert'],'alertReason':_0x486c61[_0x563243(0x126)]},'comfort':{'automationProposal':_0x486c61[_0x563243(0x150)]}}};_0x275806[_0x563243(0x11d)][_0x563243(0x158)](_0x9a764);if(_0x275806[_0x563243(0x11d)][_0x563243(0x15f)]>0x32)_0x275806['analysisHistory'][_0x563243(0x151)]();await _0x275806['setStateAsync']('analysis.analysisHistory',{'val':JSON[_0x563243(0x1a3)](_0x275806[_0x563243(0x11d)]),'ack':!![]});const _0x4ba18e=_0x486c61[_0x563243(0x11c)]||![];_0x4ba18e!==_0x275806[_0x563243(0x168)]&&(await _0x275806[_0x563243(0x19c)](_0x563243(0x175),{'val':_0x4ba18e,'ack':!![]}),_0x275806[_0x563243(0x168)]=_0x4ba18e,_0x4ba18e&&(await _0x275806[_0x563243(0x19c)](_0x563243(0x136),{'val':_0x486c61[_0x563243(0x126)],'ack':!![]}),setup[_0x563243(0x152)](_0x275806,_0x563243(0x153)+_0x486c61[_0x563243(0x126)],![],_0x486c61[_0x563243(0x14b)])));if(_0x486c61[_0x563243(0x150)]&&_0x486c61['automationProposal']['detected']){await _0x275806[_0x563243(0x19c)](_0x563243(0x171),{'val':!![],'ack':!![]}),await _0x275806[_0x563243(0x19c)](_0x563243(0x17a),{'val':_0x486c61['automationProposal'][_0x563243(0x15c)],'ack':!![]}),await _0x275806[_0x563243(0x19c)]('analysis.automation.targetId',{'val':_0x486c61[_0x563243(0x150)][_0x563243(0x157)],'ack':!![]}),await _0x275806[_0x563243(0x19c)]('analysis.automation.targetValue',{'val':JSON['stringify'](_0x486c61[_0x563243(0x150)][_0x563243(0x17f)]),'ack':!![]});if(_0x177e74)executeAutomationAction(_0x275806);}}catch(_0x3ee9f4){_0x275806[_0x563243(0x130)]['error']('Gemini\x20Error:\x20'+_0x3ee9f4[_0x563243(0x19f)]);}}function a0_0x226e(){const _0x547710=['isAlert','analysisHistory','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','5WQbCSX','LTM.driftAnalysis.baselineDrift','search','getDate','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','652472OcmNgM','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','alertReason','generateContent','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','ltmLtbWindowDays','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','Skipped\x20(Traffic)','.forecast.current.state','log','KI\x20offline\x20(Fallback)','name','dailyDigests','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','1759398CVshas','analysis.alertReason','toFixed','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','analysis.health.geminiNight','Health\x20Report\x20Error:\x20','setHours','@google/generative-ai','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20',',\x20Wetter:\x20','normal','analysis.health.geminiDay','now','weatherInstance','\x20->\x20','ANALYZE_HEALTH','join','ltmStbWindowDays','response','replace','generic','config','isEmergency','currentSystemMode','analysis.automation.targetValue','livingContext','\x20=\x20','automationProposal','pop','sendNotification','âš ï¸\x20ALARM:\x20','timestamp','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','LTM.processingStatus','targetId','unshift','./setup','getTime','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','description','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','length','\x20Ã¼bersprungen\x20(Auto-Approved).','constructor','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','eventHistory','exports',',\x20LichtverhÃ¤ltnisse:\x20','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','summary','lastAlertState','geminiModel','getStateAsync','KI-Fehler\x20(Fallback)','toISOString','10107006jdXzYy','val','Started...','.Current.IsNight','analysis.automation.patternDetected','Unbekannt','2-digit','Unbekannt\x20(Kein\x20Sensor)','analysis.isAlert','error','send','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','.Current.WeatherText','analysis.automation.description',').\x20Sending\x20notification...','1252770qzBPVL','isProVersion','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','targetValue','analysis.activitySummary','text','Tag','analysis.automation.targetId','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','N/A\x20(Learning)','analysis.lastResult','slice','278656uSaWxi','trim','useWeather','models/gemini-flash-latest',')\x20generated.','.\x20KONTEXT:\x20','warn','LTM.dailyDigests','rawEventLog','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','NIGHT','value','toString','ðŸ¤–\x20Health\x20Report\x20(','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','.Current.Temperature','99zlcSVM','getForeignStateAsync','aiPersona','Briefing\x20Error:\x20','setStateAsync','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','toLocaleTimeString','message','Sicherheit\x20geht\x20vor.','Skipped\x20(No\x20AI\x20or\x20Data)','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','stringify','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','analysis.automation.autoApply','\x0aSTB:\x20','1328348fADBpg','parse','\x0aAktivitÃ¤t:\x20','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','setDate','Keine\x20Details.','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','(((.+)+)+)+$','Traffic-Schutz\x20(Auto-Approved)','apply','push','debug','1927863fyHyCR','Digest','setForeignStateAsync','info'];a0_0x226e=function(){return _0x547710;};return a0_0x226e();}async function createDailyDigest(_0x1d7136,_0x2483c9){const _0x2a4d16=a0_0x3a75bb;if(!_0x1d7136[_0x2a4d16(0x17d)])return;if(!canCallApi()){await _0x1d7136['setStateAsync'](LTM_DP_STATUS,{'val':_0x2a4d16(0x12e),'ack':!![]});return;}await _0x1d7136[_0x2a4d16(0x19c)](LTM_DP_STATUS,{'val':_0x2a4d16(0x16f),'ack':!![]});if(!_0x1d7136[_0x2a4d16(0x169)]||_0x1d7136[_0x2a4d16(0x190)][_0x2a4d16(0x15f)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1d7136[_0x2a4d16(0x19c)](LTM_DP_STATUS,{'val':_0x2a4d16(0x1a1),'ack':!![]});return;}const _0x543317=JSON[_0x2a4d16(0x1a8)](JSON[_0x2a4d16(0x1a3)](_0x1d7136['rawEventLog'])),_0x591ef2=_0x543317[_0x2a4d16(0x15f)],_0x69cbfc=_0x2a4d16(0x155)+JSON[_0x2a4d16(0x1a3)](_0x543317);try{updateApiTimestamp();const _0x3e1da1=await _0x1d7136[_0x2a4d16(0x169)][_0x2a4d16(0x127)](_0x69cbfc),_0x5f23ec=JSON[_0x2a4d16(0x1a8)](_0x3e1da1[_0x2a4d16(0x147)][_0x2a4d16(0x181)]()[_0x2a4d16(0x148)](/```json|```/g,'')[_0x2a4d16(0x189)]()),_0x17153b={'timestamp':new Date()[_0x2a4d16(0x16c)](),'eventCount':_0x591ef2,'summary':_0x5f23ec[_0x2a4d16(0x167)]||_0x2a4d16(0x119),'activityLevel':_0x5f23ec['activityLevel']||_0x2a4d16(0x13f),'systemMode':_0x1d7136['currentSystemMode']};_0x1d7136[_0x2a4d16(0x133)][_0x2a4d16(0x116)](_0x17153b);const _0x56708f=_0x1d7136[_0x2a4d16(0x14a)][_0x2a4d16(0x129)]||0x3c;_0x1d7136['dailyDigests']['length']>_0x56708f&&_0x1d7136[_0x2a4d16(0x133)]['splice'](0x0,_0x1d7136[_0x2a4d16(0x133)][_0x2a4d16(0x15f)]-_0x56708f);await _0x1d7136[_0x2a4d16(0x19c)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2a4d16(0x1a3)](_0x1d7136['dailyDigests']),'ack':!![]}),_0x1d7136[_0x2a4d16(0x190)]=[],await _0x1d7136[_0x2a4d16(0x19c)](LTM_DP_RAW_LOG,{'val':JSON[_0x2a4d16(0x1a3)](_0x1d7136[_0x2a4d16(0x190)]),'ack':!![]}),await _0x1d7136[_0x2a4d16(0x19c)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x21fc11='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x5f23ec[_0x2a4d16(0x167)]+_0x2a4d16(0x1a9)+_0x5f23ec['activityLevel'];setup['sendNotification'](_0x1d7136,_0x21fc11,![],![]);if(_0x1d7136[_0x2a4d16(0x17d)]&&_0x2483c9)_0x2483c9[_0x2a4d16(0x177)](_0x1d7136,_0x2a4d16(0x144),{'digest':_0x17153b});}catch(_0x547ea5){_0x1d7136[_0x2a4d16(0x130)][_0x2a4d16(0x176)](_0x547ea5['message']);}}function a0_0x2167(_0x51a9f5,_0x51ba9c){const _0x3cbae8=a0_0x226e();return a0_0x2167=function(_0x45264f,_0xbe440e){_0x45264f=_0x45264f-0x115;let _0x226e99=_0x3cbae8[_0x45264f];return _0x226e99;},a0_0x2167(_0x51a9f5,_0x51ba9c);}async function runBaselineDriftAnalysis(_0x11ae13){const _0x4ae9ea=a0_0x3a75bb;if(!_0x11ae13[_0x4ae9ea(0x17d)]||!_0x11ae13[_0x4ae9ea(0x169)])return;if(!canCallApi())return;const _0x1bf333=_0x11ae13[_0x4ae9ea(0x14a)][_0x4ae9ea(0x146)]||0xe;if(_0x11ae13[_0x4ae9ea(0x133)]['length']<_0x1bf333+0x7){await _0x11ae13['setStateAsync'](_0x4ae9ea(0x120),{'val':_0x4ae9ea(0x185),'ack':!![]});return;}const _0x1d1a7f=_0x11ae13[_0x4ae9ea(0x133)][_0x4ae9ea(0x187)](-_0x1bf333),_0x20d436=_0x11ae13[_0x4ae9ea(0x133)][_0x4ae9ea(0x187)](0x0,_0x11ae13[_0x4ae9ea(0x133)][_0x4ae9ea(0x15f)]-_0x1bf333),_0x155aa4=_0x4ae9ea(0x13d)+JSON[_0x4ae9ea(0x1a3)](_0x20d436)+_0x4ae9ea(0x1a6)+JSON[_0x4ae9ea(0x1a3)](_0x1d1a7f);try{updateApiTimestamp();const _0x49d525=await _0x11ae13[_0x4ae9ea(0x169)][_0x4ae9ea(0x127)](_0x155aa4),_0x342db1=JSON[_0x4ae9ea(0x1a8)](_0x49d525[_0x4ae9ea(0x147)]['text']()[_0x4ae9ea(0x148)](/```json|```/g,'')['trim']());_0x342db1['baselineDrift']&&(await _0x11ae13[_0x4ae9ea(0x19c)]('LTM.driftAnalysis.baselineDrift',{'val':_0x342db1['baselineDrift'],'ack':!![]}),await _0x11ae13[_0x4ae9ea(0x19c)]('LTM.driftAnalysis.driftDetails',{'val':_0x342db1['driftDetails'],'ack':!![]}),await _0x11ae13[_0x4ae9ea(0x19c)]('LTM.driftAnalysis.lastCheck',{'val':Date['now'](),'ack':!![]}));}catch(_0x231107){}}async function executeAutomationAction(_0x3d612f){const _0x19ef86=a0_0x3a75bb;try{const _0x1f31d1=await _0x3d612f['getStateAsync'](_0x19ef86(0x183)),_0x102c32=await _0x3d612f['getStateAsync'](_0x19ef86(0x14d));if(_0x1f31d1&&_0x1f31d1[_0x19ef86(0x16e)]&&_0x102c32){const _0x520d0f=_0x1f31d1[_0x19ef86(0x16e)];let _0x3eb096=_0x102c32[_0x19ef86(0x16e)];try{_0x3eb096=JSON['parse'](_0x3eb096);}catch(_0x2730ea){}_0x3d612f[_0x19ef86(0x130)][_0x19ef86(0x11b)](_0x19ef86(0x1ad)+_0x520d0f+_0x19ef86(0x14f)+_0x3eb096),await _0x3d612f[_0x19ef86(0x11a)](_0x520d0f,_0x3eb096);}else _0x3d612f['log']['warn'](_0x19ef86(0x15b));}catch(_0x4b0c5f){_0x3d612f[_0x19ef86(0x130)][_0x19ef86(0x176)]('BUTLER\x20Execution\x20Error:\x20'+_0x4b0c5f[_0x19ef86(0x19f)]);}}async function sendMorningBriefing(_0xd99224){const _0x580146=a0_0x3a75bb;if(!_0xd99224[_0x580146(0x169)]){_0xd99224[_0x580146(0x130)]['warn'](_0x580146(0x128));return;}_0xd99224[_0x580146(0x130)][_0x580146(0x11b)](_0x580146(0x12d));try{updateApiTimestamp();const _0x546c03=_0x580146(0x166),_0x38a4e5=await _0xd99224[_0x580146(0x169)]['generateContent'](_0x546c03),_0x11fc91=_0x38a4e5[_0x580146(0x147)][_0x580146(0x181)]();_0xd99224[_0x580146(0x130)][_0x580146(0x11b)]('ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20'+_0x11fc91['length']+_0x580146(0x17b)),setup[_0x580146(0x152)](_0xd99224,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0x11fc91);}catch(_0x54f50d){_0xd99224[_0x580146(0x130)][_0x580146(0x176)](_0x580146(0x19b)+_0x54f50d[_0x580146(0x19f)]);}}async function generateHealthReport(_0x4bcbd1,_0x4399c2){const _0x10777c=a0_0x3a75bb;if(!_0x4bcbd1[_0x10777c(0x169)])return;const _0xa04645=Date[_0x10777c(0x141)]();_0xa04645-lastGlobalApiCall<0xbb8&&(_0x4bcbd1['log'][_0x10777c(0x117)](_0x10777c(0x191)),await new Promise(_0x33bc91=>setTimeout(_0x33bc91,0x7d0)));const _0x2c4b5f=new Date();let _0x3b2899=0x0,_0x30682f=_0x2c4b5f[_0x10777c(0x15a)](),_0x39f963='';if(_0x4399c2===_0x10777c(0x192)){const _0x27cfdc=new Date(_0x2c4b5f);_0x27cfdc[_0x10777c(0x1ab)](_0x27cfdc[_0x10777c(0x122)]()-0x1),_0x27cfdc['setHours'](0x16,0x0,0x0,0x0),_0x3b2899=_0x27cfdc[_0x10777c(0x15a)]();const _0x968b7d=new Date(_0x2c4b5f);_0x968b7d[_0x10777c(0x13b)](0x8,0x0,0x0,0x0),_0x30682f=_0x968b7d[_0x10777c(0x15a)](),_0x39f963=_0x10777c(0x1aa);}else{const _0x435656=new Date(_0x2c4b5f);_0x435656[_0x10777c(0x13b)](0x8,0x0,0x0,0x0),_0x3b2899=_0x435656[_0x10777c(0x15a)](),_0x39f963=_0x10777c(0x19d);}const _0x233204=_0x4bcbd1[_0x10777c(0x163)]['filter'](_0x2f644c=>_0x2f644c['timestamp']>=_0x3b2899&&_0x2f644c[_0x10777c(0x154)]<=_0x30682f);if(_0x233204[_0x10777c(0x15f)]===0x0){const _0x212f2f=_0x4399c2===_0x10777c(0x192)?_0x10777c(0x15d):_0x10777c(0x123),_0x427242=_0x4399c2==='NIGHT'?'analysis.health.geminiNight':_0x10777c(0x140);await _0x4bcbd1[_0x10777c(0x19c)](_0x427242,{'val':_0x212f2f,'ack':!![]});return;}const _0x228871=_0x233204['map'](_0xa139df=>new Date(_0xa139df[_0x10777c(0x154)])[_0x10777c(0x19e)]([],{'hour':_0x10777c(0x173),'minute':_0x10777c(0x173)})+'\x20'+_0xa139df[_0x10777c(0x132)]+'\x20('+_0xa139df[_0x10777c(0x193)]+')')[_0x10777c(0x145)]('\x0a'),_0x421778=_0x10777c(0x125)+_0x39f963+'\x0a\x20\x20\x20\x20EVENTS:\x0a'+_0x228871+_0x10777c(0x11e);try{updateApiTimestamp();const _0x522654=await _0x4bcbd1['geminiModel'][_0x10777c(0x127)](_0x421778),_0x573d49=_0x522654[_0x10777c(0x147)]['text'](),_0x311700=_0x4399c2===_0x10777c(0x192)?_0x10777c(0x139):_0x10777c(0x140);await _0x4bcbd1[_0x10777c(0x19c)](_0x311700,{'val':_0x573d49,'ack':!![]}),_0x4bcbd1[_0x10777c(0x130)][_0x10777c(0x11b)](_0x10777c(0x195)+_0x4399c2+_0x10777c(0x18c));}catch(_0x1c0fbc){_0x4bcbd1[_0x10777c(0x130)][_0x10777c(0x176)](_0x10777c(0x13a)+_0x1c0fbc[_0x10777c(0x19f)]);}}module[a0_0x3a75bb(0x164)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};