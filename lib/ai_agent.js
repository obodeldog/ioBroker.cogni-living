const a0_0x49d66f=a0_0x1e35;(function(_0x3f40c2,_0x3423ed){const _0x209449=a0_0x1e35,_0x3a020c=_0x3f40c2();while(!![]){try{const _0x1533bf=-parseInt(_0x209449(0x128))/0x1*(-parseInt(_0x209449(0x142))/0x2)+-parseInt(_0x209449(0x153))/0x3+-parseInt(_0x209449(0x145))/0x4+parseInt(_0x209449(0x172))/0x5*(-parseInt(_0x209449(0x18b))/0x6)+-parseInt(_0x209449(0x178))/0x7+parseInt(_0x209449(0x127))/0x8*(parseInt(_0x209449(0xf0))/0x9)+-parseInt(_0x209449(0x170))/0xa*(parseInt(_0x209449(0x15e))/0xb);if(_0x1533bf===_0x3423ed)break;else _0x3a020c['push'](_0x3a020c['shift']());}catch(_0x588e7c){_0x3a020c['push'](_0x3a020c['shift']());}}}(a0_0x3d1b,0xad6fb));const a0_0x2a931c=(function(){let _0xce6453=!![];return function(_0x5ce57e,_0x25cb5b){const _0x2b04c2=_0xce6453?function(){const _0x99ac18=a0_0x1e35;if(_0x25cb5b){const _0x297b16=_0x25cb5b[_0x99ac18(0x15a)](_0x5ce57e,arguments);return _0x25cb5b=null,_0x297b16;}}:function(){};return _0xce6453=![],_0x2b04c2;};}()),a0_0x2d59b2=a0_0x2a931c(this,function(){const _0x1c3d20=a0_0x1e35;return a0_0x2d59b2['toString']()['search'](_0x1c3d20(0x130))['toString']()[_0x1c3d20(0x15d)](a0_0x2d59b2)[_0x1c3d20(0x102)](_0x1c3d20(0x130));});a0_0x2d59b2();'use strict';const {GoogleGenerativeAI}=require(a0_0x49d66f(0x171)),setup=require(a0_0x49d66f(0x16f)),GEMINI_MODEL=a0_0x49d66f(0x104),LTM_DP_DAILY_DIGESTS=a0_0x49d66f(0xf1),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_RAW_LOG=a0_0x49d66f(0x100),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x49d66f(0x155),'senior_aal':'PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':'Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','single_comfort':'Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','security':'Sicherheit\x20geht\x20vor.','energy_saver':'PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).'};function canCallApi(){const _0x5ba4a6=a0_0x49d66f,_0xb82426=Date[_0x5ba4a6(0xfe)]();return _0xb82426-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x1fb4a1=a0_0x49d66f;lastGlobalApiCall=Date[_0x1fb4a1(0xfe)]();}async function getWeatherContext(_0x3027c5){const _0x533ae7=a0_0x49d66f;if(!_0x3027c5['config'][_0x533ae7(0x165)]||!_0x3027c5[_0x533ae7(0x159)]['weatherInstance'])return _0x533ae7(0x126);try{const _0xbd5da5=_0x3027c5[_0x533ae7(0x159)][_0x533ae7(0x14b)];let _0x5b551a=await _0x3027c5[_0x533ae7(0x189)](_0xbd5da5+_0x533ae7(0x144));if(!_0x5b551a)_0x5b551a=await _0x3027c5[_0x533ae7(0x189)](_0xbd5da5+'.forecast.current.temperature');let _0x47d4fe=await _0x3027c5['getForeignStateAsync'](_0xbd5da5+_0x533ae7(0x105));if(!_0x47d4fe)_0x47d4fe=await _0x3027c5[_0x533ae7(0x189)](_0xbd5da5+_0x533ae7(0xfb));let _0x5dabcd='Unbekannt';const _0x257da1=await _0x3027c5[_0x533ae7(0x189)](_0xbd5da5+'.Current.IsNight');if(_0x257da1)_0x5dabcd=_0x257da1[_0x533ae7(0xf7)]?'Nacht':_0x533ae7(0x12d);if(_0x5b551a&&_0x47d4fe)return _0x5b551a[_0x533ae7(0xf7)]+_0x533ae7(0xf5)+_0x47d4fe['val']+_0x533ae7(0xfd)+_0x5dabcd;}catch(_0x183d47){}return'Wetterdaten\x20nicht\x20abrufbar';}async function consultButler(_0x15aae2,_0x43eb7b,_0x15f8cb,_0x2b9ada){const _0x314a5e=a0_0x49d66f;if(!_0x15aae2[_0x314a5e(0xf9)])return{'approved':!![],'reason':_0x314a5e(0x135)};const _0x5a0b6f=Date[_0x314a5e(0xfe)]();if(decisionCache[_0x43eb7b]&&_0x5a0b6f-decisionCache[_0x43eb7b][_0x314a5e(0xe9)]<CACHE_TTL_MS){const _0x23cf14=decisionCache[_0x43eb7b][_0x314a5e(0x160)];return _0x15aae2[_0x314a5e(0x11a)]['debug'](_0x314a5e(0x15b)+_0x43eb7b+'\x20->\x20'+(_0x23cf14['approved']?'OK':'NO')+'\x20('+_0x23cf14[_0x314a5e(0x117)]+')'),_0x23cf14;}if(!canCallApi())return _0x15aae2[_0x314a5e(0x11a)][_0x314a5e(0x163)](_0x314a5e(0x10f)+_0x43eb7b+_0x314a5e(0x18c)),{'approved':!![],'reason':_0x314a5e(0x150)};const _0xf9b513=new Date()[_0x314a5e(0x12f)](),_0x5ed521=await getWeatherContext(_0x15aae2),_0xe7418=PERSONA_MAPPING[_0x15aae2[_0x314a5e(0x159)][_0x314a5e(0x13f)]||'generic'],_0x22780b=_0x314a5e(0x16a)+_0xf9b513+_0x314a5e(0x10d)+_0x5ed521+_0x314a5e(0x133)+(_0x2b9ada*0x64)['toFixed'](0x0)+_0x314a5e(0x136)+_0x43eb7b+_0x314a5e(0x12b)+_0x15f8cb+_0x314a5e(0x109)+_0xe7418+_0x314a5e(0x111);try{updateApiTimestamp();const _0x5e8efc=await _0x15aae2[_0x314a5e(0xf9)]['generateContent'](_0x22780b),_0x453fbf=_0x5e8efc['response'][_0x314a5e(0x101)]()[_0x314a5e(0x141)](/```json|```/g,'')[_0x314a5e(0x16e)](),_0x537c98=JSON[_0x314a5e(0x177)](_0x453fbf);return decisionCache[_0x43eb7b]={'decision':_0x537c98,'timestamp':_0x5a0b6f},_0x537c98;}catch(_0x5d958b){return _0x15aae2[_0x314a5e(0x11a)][_0x314a5e(0x122)](_0x314a5e(0x116)+_0x5d958b[_0x314a5e(0x175)]),decisionCache[_0x43eb7b]={'decision':{'approved':!![],'reason':_0x314a5e(0x140)},'timestamp':_0x5a0b6f-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x314a5e(0x140)};}}async function runGeminiAnalysis(_0x4ed2e7,_0x13206d=''){const _0xfa3349=a0_0x49d66f;if(!_0x4ed2e7[_0xfa3349(0xf9)])return;if(!canCallApi()){_0x4ed2e7[_0xfa3349(0x11a)][_0xfa3349(0x163)]('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x4ed2e7['eventHistory']['length']===0x0)return;const _0x42dd1e=_0x4ed2e7[_0xfa3349(0x154)][_0xfa3349(0x158)](0x0,0xf),_0x3f1adb=_0x4ed2e7[_0xfa3349(0x14a)],_0x2ece19=PERSONA_MAPPING[_0x4ed2e7[_0xfa3349(0x159)][_0xfa3349(0x13f)]||_0xfa3349(0x132)],_0x31d7ed=_0x4ed2e7['config'][_0xfa3349(0x17e)]||_0xfa3349(0x129);let _0x3d470d=_0xfa3349(0x149);try{const _0x3fcf22=await _0x4ed2e7['getStateAsync'](_0xfa3349(0x12e));if(_0x3fcf22&&_0x3fcf22[_0xfa3349(0xf7)])_0x3d470d=_0x3fcf22['val'];}catch(_0x472c1d){}let _0x3b85f9=![];try{const _0x51cc3d=await _0x4ed2e7['getStateAsync'](_0xfa3349(0x14d));if(_0x51cc3d&&_0x51cc3d[_0xfa3349(0xf7)])_0x3b85f9=!![];}catch(_0x4daaea){}const _0x2fa53c=_0xfa3349(0x125)+_0x2ece19+_0xfa3349(0x11d)+_0x31d7ed+_0xfa3349(0x13b)+_0x3f1adb+_0xfa3349(0x17a)+_0x3d470d+_0xfa3349(0x148)+JSON[_0xfa3349(0x15c)](_0x42dd1e)+_0xfa3349(0x146)+_0x13206d+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x53e920=await _0x4ed2e7['geminiModel'][_0xfa3349(0x108)](_0x2fa53c),_0x40241a=JSON['parse'](_0x53e920[_0xfa3349(0x162)][_0xfa3349(0x101)]()[_0xfa3349(0x141)](/```json|```/g,'')[_0xfa3349(0x16e)]());await _0x4ed2e7[_0xfa3349(0x137)](_0xfa3349(0x151),{'val':JSON['stringify'](_0x40241a),'ack':!![]});if(_0x40241a[_0xfa3349(0x152)])await _0x4ed2e7['setStateAsync']('analysis.activitySummary',{'val':_0x40241a['summary'],'ack':!![]});const _0x22e5a9={'timestamp':Date[_0xfa3349(0xfe)](),'id':Date['now']()[_0xfa3349(0x112)](),'analysis':{'activity':{'summary':_0x40241a[_0xfa3349(0x152)],'isAlert':_0x40241a['isAlert'],'alertReason':_0x40241a[_0xfa3349(0x17c)]},'comfort':{'automationProposal':_0x40241a[_0xfa3349(0x110)]}}};_0x4ed2e7['analysisHistory'][_0xfa3349(0x138)](_0x22e5a9);if(_0x4ed2e7['analysisHistory'][_0xfa3349(0x114)]>0x32)_0x4ed2e7[_0xfa3349(0x183)][_0xfa3349(0x14f)]();await _0x4ed2e7['setStateAsync'](_0xfa3349(0x17d),{'val':JSON['stringify'](_0x4ed2e7[_0xfa3349(0x183)]),'ack':!![]});const _0x14a862=_0x40241a[_0xfa3349(0x115)]||![];_0x14a862!==_0x4ed2e7[_0xfa3349(0x167)]&&(await _0x4ed2e7[_0xfa3349(0x137)](_0xfa3349(0xed),{'val':_0x14a862,'ack':!![]}),_0x4ed2e7[_0xfa3349(0x167)]=_0x14a862,_0x14a862&&(await _0x4ed2e7[_0xfa3349(0x137)]('analysis.alertReason',{'val':_0x40241a[_0xfa3349(0x17c)],'ack':!![]}),setup[_0xfa3349(0x17f)](_0x4ed2e7,_0xfa3349(0x14e)+_0x40241a[_0xfa3349(0x17c)],![],_0x40241a[_0xfa3349(0x15f)])));if(_0x40241a[_0xfa3349(0x110)]&&_0x40241a[_0xfa3349(0x110)][_0xfa3349(0x12c)]){await _0x4ed2e7[_0xfa3349(0x137)](_0xfa3349(0x11e),{'val':!![],'ack':!![]}),await _0x4ed2e7[_0xfa3349(0x137)](_0xfa3349(0x11b),{'val':_0x40241a['automationProposal'][_0xfa3349(0x166)],'ack':!![]}),await _0x4ed2e7['setStateAsync']('analysis.automation.targetId',{'val':_0x40241a['automationProposal'][_0xfa3349(0x12a)],'ack':!![]}),await _0x4ed2e7[_0xfa3349(0x137)]('analysis.automation.targetValue',{'val':JSON[_0xfa3349(0x15c)](_0x40241a[_0xfa3349(0x110)][_0xfa3349(0xf3)]),'ack':!![]});if(_0x3b85f9)executeAutomationAction(_0x4ed2e7);}}catch(_0x1a1d08){_0x4ed2e7[_0xfa3349(0x11a)][_0xfa3349(0x10e)]('Gemini\x20Error:\x20'+_0x1a1d08[_0xfa3349(0x175)]);}}async function createDailyDigest(_0x52e6e4,_0x5cdab6){const _0x25cfdd=a0_0x49d66f;if(!_0x52e6e4['isProVersion'])return;if(!canCallApi()){await _0x52e6e4[_0x25cfdd(0x137)](LTM_DP_STATUS,{'val':_0x25cfdd(0x121),'ack':!![]});return;}await _0x52e6e4[_0x25cfdd(0x137)](LTM_DP_STATUS,{'val':_0x25cfdd(0xf4),'ack':!![]});if(!_0x52e6e4[_0x25cfdd(0xf9)]||_0x52e6e4[_0x25cfdd(0x107)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x52e6e4[_0x25cfdd(0x137)](LTM_DP_STATUS,{'val':_0x25cfdd(0x188),'ack':!![]});return;}const _0x46fbc4=JSON['parse'](JSON[_0x25cfdd(0x15c)](_0x52e6e4[_0x25cfdd(0x107)])),_0x47fe73=_0x46fbc4['length'],_0x5db779=_0x25cfdd(0x181)+JSON[_0x25cfdd(0x15c)](_0x46fbc4);try{updateApiTimestamp();const _0x5e931f=await _0x52e6e4[_0x25cfdd(0xf9)][_0x25cfdd(0x108)](_0x5db779),_0x191b32=JSON[_0x25cfdd(0x177)](_0x5e931f[_0x25cfdd(0x162)][_0x25cfdd(0x101)]()[_0x25cfdd(0x141)](/```json|```/g,'')[_0x25cfdd(0x16e)]()),_0xa72ad6={'timestamp':new Date()['toISOString'](),'eventCount':_0x47fe73,'summary':_0x191b32[_0x25cfdd(0x152)]||_0x25cfdd(0xea),'activityLevel':_0x191b32[_0x25cfdd(0x156)]||'normal','systemMode':_0x52e6e4[_0x25cfdd(0x14a)]};_0x52e6e4[_0x25cfdd(0x123)]['push'](_0xa72ad6);const _0x48ce41=_0x52e6e4[_0x25cfdd(0x159)][_0x25cfdd(0x17b)]||0x3c;_0x52e6e4['dailyDigests'][_0x25cfdd(0x114)]>_0x48ce41&&_0x52e6e4[_0x25cfdd(0x123)][_0x25cfdd(0x179)](0x0,_0x52e6e4[_0x25cfdd(0x123)][_0x25cfdd(0x114)]-_0x48ce41);await _0x52e6e4[_0x25cfdd(0x137)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x25cfdd(0x15c)](_0x52e6e4[_0x25cfdd(0x123)]),'ack':!![]}),_0x52e6e4[_0x25cfdd(0x107)]=[],await _0x52e6e4[_0x25cfdd(0x137)](LTM_DP_RAW_LOG,{'val':JSON[_0x25cfdd(0x15c)](_0x52e6e4['rawEventLog']),'ack':!![]}),await _0x52e6e4[_0x25cfdd(0x137)](LTM_DP_STATUS,{'val':_0x25cfdd(0x139),'ack':!![]});const _0x21a200=_0x25cfdd(0x13d)+_0x191b32[_0x25cfdd(0x152)]+_0x25cfdd(0xee)+_0x191b32[_0x25cfdd(0x156)];setup[_0x25cfdd(0x17f)](_0x52e6e4,_0x21a200,![],![]);if(_0x52e6e4[_0x25cfdd(0x186)]&&_0x5cdab6)_0x5cdab6[_0x25cfdd(0x16c)](_0x52e6e4,_0x25cfdd(0x173),{'digest':_0xa72ad6});}catch(_0x52a155){_0x52e6e4[_0x25cfdd(0x11a)][_0x25cfdd(0x10e)](_0x52a155[_0x25cfdd(0x175)]);}}function a0_0x3d1b(){const _0x431fbe=['Unbekannt\x20(Kein\x20Sensor)','32OiYIjp','7uQXctd','Keine\x20Details.','targetId','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','detected','Tag','system.presenceWho','toLocaleTimeString','(((.+)+)+)+$','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','generic','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','2-digit','KI\x20offline\x20(Fallback)','%)\x20nach\x20\x22','setStateAsync','unshift','Success','\x0a\x20\x20\x20\x20EVENTS:\x0a','.\x20SYSTEM_MODE:\x20','filter','üìÖ\x20Daily\x20Digest:\x0a','ü§ñ\x20Health\x20Report\x20(','aiPersona','KI-Fehler\x20(Fallback)','replace','391606aBIsAX','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','.Current.Temperature','1131284EODltD','.\x20EMERGENCY:\x20','N/A\x20(Learning)','.\x20EVENTS:\x20','Unbekannt','currentSystemMode','weatherInstance','baselineDrift','analysis.automation.autoApply','‚ö†Ô∏è\x20ALARM:\x20','pop','Traffic-Schutz\x20(Auto-Approved)','analysis.lastResult','summary','1117605npAUJK','eventHistory','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','activityLevel','setForeignStateAsync','slice','config','apply','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','stringify','constructor','1847956DsAPPH','isEmergency','decision','getStateAsync','response','debug','analysis.automation.targetId','useWeather','description','lastAlertState','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','NIGHT','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','getTime','send','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','trim','./setup','10iSPodu','@google/generative-ai','295UdqSOd','ANALYZE_HEALTH','Health\x20Report\x20Error:\x20','message',').\x20Sending\x20notification...','parse','5756009iWUbSb','splice','.\x20ANWESEND:\x20','ltmLtbWindowDays','alertReason','analysis.analysisHistory','livingContext','sendNotification','info','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','analysis.health.geminiNight','analysisHistory','üåÖ\x20Briefing\x20generated\x20(Length:\x20','\x0aSTB:\x20','isProVersion','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','Skipped\x20(No\x20AI\x20or\x20Data)','getForeignStateAsync','exports','24870GcaKOa','\x20√ºbersprungen\x20(Auto-Approved).','timestamp','Digest','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','getDate','analysis.isAlert','\x0aAktivit√§t:\x20',')\x20generated.','2767428UsiSnw','LTM.dailyDigests','value','targetValue','Started...','¬∞C,\x20','setDate','val','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','geminiModel','join','.forecast.current.state','map',',\x20Lichtverh√§ltnisse:\x20','now','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','LTM.rawEventLog','text','search','Briefing\x20Error:\x20','models/gemini-flash-latest','.Current.WeatherText','driftDetails','rawEventLog','generateContent','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','ltmStbWindowDays','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','BUTLER\x20Execution\x20Error:\x20',',\x20Wetter:\x20','error','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','automationProposal','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','toString','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','length','isAlert','ü§ñ\x20Butler\x20Brain\x20Error:\x20','reason','LTM.driftAnalysis.driftDetails','setHours','log','analysis.automation.description','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','.\x20KONTEXT:\x20','analysis.automation.patternDetected','LTM.driftAnalysis.baselineDrift','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Skipped\x20(Traffic)','warn','dailyDigests','analysis.health.geminiDay','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'];a0_0x3d1b=function(){return _0x431fbe;};return a0_0x3d1b();}async function runBaselineDriftAnalysis(_0x5c155e){const _0x43ede9=a0_0x49d66f;if(!_0x5c155e['isProVersion']||!_0x5c155e[_0x43ede9(0xf9)])return;if(!canCallApi())return;const _0x694eb4=_0x5c155e[_0x43ede9(0x159)][_0x43ede9(0x10a)]||0xe;if(_0x5c155e[_0x43ede9(0x123)][_0x43ede9(0x114)]<_0x694eb4+0x7){await _0x5c155e[_0x43ede9(0x137)]('LTM.driftAnalysis.baselineDrift',{'val':_0x43ede9(0x147),'ack':!![]});return;}const _0x38d185=_0x5c155e[_0x43ede9(0x123)][_0x43ede9(0x158)](-_0x694eb4),_0xf7d472=_0x5c155e[_0x43ede9(0x123)][_0x43ede9(0x158)](0x0,_0x5c155e[_0x43ede9(0x123)][_0x43ede9(0x114)]-_0x694eb4),_0x576747=_0x43ede9(0x120)+JSON[_0x43ede9(0x15c)](_0xf7d472)+_0x43ede9(0x185)+JSON[_0x43ede9(0x15c)](_0x38d185);try{updateApiTimestamp();const _0x574218=await _0x5c155e[_0x43ede9(0xf9)][_0x43ede9(0x108)](_0x576747),_0xbeee86=JSON[_0x43ede9(0x177)](_0x574218[_0x43ede9(0x162)][_0x43ede9(0x101)]()[_0x43ede9(0x141)](/```json|```/g,'')[_0x43ede9(0x16e)]());_0xbeee86['baselineDrift']&&(await _0x5c155e['setStateAsync'](_0x43ede9(0x11f),{'val':_0xbeee86[_0x43ede9(0x14c)],'ack':!![]}),await _0x5c155e[_0x43ede9(0x137)](_0x43ede9(0x118),{'val':_0xbeee86[_0x43ede9(0x106)],'ack':!![]}),await _0x5c155e['setStateAsync']('LTM.driftAnalysis.lastCheck',{'val':Date[_0x43ede9(0xfe)](),'ack':!![]}));}catch(_0x5e1fe5){}}async function executeAutomationAction(_0xd0550e){const _0x4583d0=a0_0x49d66f;try{const _0x3010f8=await _0xd0550e[_0x4583d0(0x161)](_0x4583d0(0x164)),_0x89a306=await _0xd0550e[_0x4583d0(0x161)]('analysis.automation.targetValue');if(_0x3010f8&&_0x3010f8[_0x4583d0(0xf7)]&&_0x89a306){const _0x319b1e=_0x3010f8[_0x4583d0(0xf7)];let _0x109c0a=_0x89a306[_0x4583d0(0xf7)];try{_0x109c0a=JSON['parse'](_0x109c0a);}catch(_0x18731b){}_0xd0550e[_0x4583d0(0x11a)][_0x4583d0(0x180)](_0x4583d0(0x187)+_0x319b1e+'\x20=\x20'+_0x109c0a),await _0xd0550e[_0x4583d0(0x157)](_0x319b1e,_0x109c0a);}else _0xd0550e['log'][_0x4583d0(0x122)](_0x4583d0(0x168));}catch(_0x3c824f){_0xd0550e[_0x4583d0(0x11a)][_0x4583d0(0x10e)](_0x4583d0(0x10c)+_0x3c824f[_0x4583d0(0x175)]);}}async function sendMorningBriefing(_0x3b41ed){const _0x276dba=a0_0x49d66f;if(!_0x3b41ed['geminiModel']){_0x3b41ed[_0x276dba(0x11a)][_0x276dba(0x122)](_0x276dba(0x10b));return;}_0x3b41ed[_0x276dba(0x11a)][_0x276dba(0x180)](_0x276dba(0xeb));try{updateApiTimestamp();const _0x1f285d=_0x276dba(0xff),_0x374c04=await _0x3b41ed['geminiModel'][_0x276dba(0x108)](_0x1f285d),_0x28a684=_0x374c04[_0x276dba(0x162)][_0x276dba(0x101)]();_0x3b41ed['log'][_0x276dba(0x180)](_0x276dba(0x184)+_0x28a684[_0x276dba(0x114)]+_0x276dba(0x176)),setup['sendNotification'](_0x3b41ed,'üåÖ\x20Morning\x20Briefing:\x0a'+_0x28a684);}catch(_0x24659d){_0x3b41ed[_0x276dba(0x11a)][_0x276dba(0x10e)](_0x276dba(0x103)+_0x24659d[_0x276dba(0x175)]);}}async function generateHealthReport(_0x336cd1,_0x163785){const _0x2b700c=a0_0x49d66f;if(!_0x336cd1[_0x2b700c(0xf9)])return;const _0xaf3199=Date[_0x2b700c(0xfe)]();_0xaf3199-lastGlobalApiCall<0xbb8&&(_0x336cd1[_0x2b700c(0x11a)][_0x2b700c(0x163)]('ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...'),await new Promise(_0x43d0e7=>setTimeout(_0x43d0e7,0x7d0)));const _0x495ca0=new Date();let _0x152fd2=0x0,_0x4d3c4a=_0x495ca0[_0x2b700c(0x16b)](),_0x439f2d='';if(_0x163785==='NIGHT'){const _0x1ecc97=new Date(_0x495ca0);_0x1ecc97[_0x2b700c(0xf6)](_0x1ecc97[_0x2b700c(0xec)]()-0x1),_0x1ecc97[_0x2b700c(0x119)](0x16,0x0,0x0,0x0),_0x152fd2=_0x1ecc97['getTime']();const _0x3f906c=new Date(_0x495ca0);_0x3f906c[_0x2b700c(0x119)](0x8,0x0,0x0,0x0),_0x4d3c4a=_0x3f906c[_0x2b700c(0x16b)](),_0x439f2d=_0x2b700c(0x11c);}else{const _0x57e753=new Date(_0x495ca0);_0x57e753[_0x2b700c(0x119)](0x8,0x0,0x0,0x0),_0x152fd2=_0x57e753[_0x2b700c(0x16b)](),_0x439f2d=_0x2b700c(0x113);}const _0xd284d=_0x336cd1[_0x2b700c(0x154)][_0x2b700c(0x13c)](_0x3b10f8=>_0x3b10f8[_0x2b700c(0xe9)]>=_0x152fd2&&_0x3b10f8[_0x2b700c(0xe9)]<=_0x4d3c4a);if(_0xd284d[_0x2b700c(0x114)]===0x0){const _0x48d504=_0x163785==='NIGHT'?_0x2b700c(0x131):_0x2b700c(0xf8),_0xd3741b=_0x163785===_0x2b700c(0x169)?_0x2b700c(0x182):_0x2b700c(0x124);await _0x336cd1[_0x2b700c(0x137)](_0xd3741b,{'val':_0x48d504,'ack':!![]});return;}const _0x2373c6=_0xd284d[_0x2b700c(0xfc)](_0x3d6577=>new Date(_0x3d6577[_0x2b700c(0xe9)])[_0x2b700c(0x12f)]([],{'hour':_0x2b700c(0x134),'minute':'2-digit'})+'\x20'+_0x3d6577['name']+'\x20('+_0x3d6577[_0x2b700c(0xf2)]+')')[_0x2b700c(0xfa)]('\x0a'),_0xf60c13=_0x2b700c(0x143)+_0x439f2d+_0x2b700c(0x13a)+_0x2373c6+_0x2b700c(0x16d);try{updateApiTimestamp();const _0x1f47a9=await _0x336cd1[_0x2b700c(0xf9)][_0x2b700c(0x108)](_0xf60c13),_0x1f2cfb=_0x1f47a9['response'][_0x2b700c(0x101)](),_0x43566b=_0x163785===_0x2b700c(0x169)?_0x2b700c(0x182):_0x2b700c(0x124);await _0x336cd1[_0x2b700c(0x137)](_0x43566b,{'val':_0x1f2cfb,'ack':!![]}),_0x336cd1['log'][_0x2b700c(0x180)](_0x2b700c(0x13e)+_0x163785+_0x2b700c(0xef));}catch(_0x24ea44){_0x336cd1[_0x2b700c(0x11a)][_0x2b700c(0x10e)](_0x2b700c(0x174)+_0x24ea44[_0x2b700c(0x175)]);}}function a0_0x1e35(_0x178566,_0x12cf2e){const _0x39f83c=a0_0x3d1b();return a0_0x1e35=function(_0x2d59b2,_0x2a931c){_0x2d59b2=_0x2d59b2-0xe9;let _0x3d1bf9=_0x39f83c[_0x2d59b2];return _0x3d1bf9;},a0_0x1e35(_0x178566,_0x12cf2e);}module[a0_0x49d66f(0x18a)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};