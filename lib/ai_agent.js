const a0_0x15dec7=a0_0x34bd;(function(_0x292860,_0x397d46){const _0x145342=a0_0x34bd,_0x533cf6=_0x292860();while(!![]){try{const _0x48ae13=-parseInt(_0x145342(0x1db))/0x1*(-parseInt(_0x145342(0x18c))/0x2)+-parseInt(_0x145342(0x1d6))/0x3*(parseInt(_0x145342(0x183))/0x4)+parseInt(_0x145342(0x1c1))/0x5*(-parseInt(_0x145342(0x1d5))/0x6)+-parseInt(_0x145342(0x165))/0x7*(parseInt(_0x145342(0x1cb))/0x8)+-parseInt(_0x145342(0x1f5))/0x9+parseInt(_0x145342(0x18d))/0xa+-parseInt(_0x145342(0x1bb))/0xb*(-parseInt(_0x145342(0x18e))/0xc);if(_0x48ae13===_0x397d46)break;else _0x533cf6['push'](_0x533cf6['shift']());}catch(_0x38a1ba){_0x533cf6['push'](_0x533cf6['shift']());}}}(a0_0x1f2f,0xe6847));const a0_0x5bd223=(function(){let _0x348e6c=!![];return function(_0x2303a2,_0x16265a){const _0x43d2db=_0x348e6c?function(){const _0x49a632=a0_0x34bd;if(_0x16265a){const _0x3c326f=_0x16265a[_0x49a632(0x1a4)](_0x2303a2,arguments);return _0x16265a=null,_0x3c326f;}}:function(){};return _0x348e6c=![],_0x43d2db;};}()),a0_0x303b33=a0_0x5bd223(this,function(){const _0x153dc8=a0_0x34bd;return a0_0x303b33[_0x153dc8(0x1a0)]()[_0x153dc8(0x1f1)](_0x153dc8(0x1bd))[_0x153dc8(0x1a0)]()[_0x153dc8(0x1f3)](a0_0x303b33)[_0x153dc8(0x1f1)](_0x153dc8(0x1bd));});a0_0x303b33();function a0_0x34bd(_0x3df588,_0x1b2003){const _0x146d1f=a0_0x1f2f();return a0_0x34bd=function(_0x303b33,_0x5bd223){_0x303b33=_0x303b33-0x165;let _0x1f2fca=_0x146d1f[_0x303b33];return _0x1f2fca;},a0_0x34bd(_0x3df588,_0x1b2003);}'use strict';const {GoogleGenerativeAI}=require(a0_0x15dec7(0x1ef)),setup=require(a0_0x15dec7(0x185)),GEMINI_MODEL=a0_0x15dec7(0x19c),LTM_DP_DAILY_DIGESTS=a0_0x15dec7(0x1d2),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_RAW_LOG=a0_0x15dec7(0x1d1),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x15dec7(0x18b),'senior_aal':'PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':a0_0x15dec7(0x1f0),'single_comfort':a0_0x15dec7(0x1c5),'security':a0_0x15dec7(0x176),'energy_saver':a0_0x15dec7(0x1ee)};function canCallApi(){const _0x105e46=Date['now']();return _0x105e46-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x5ba0b1=a0_0x15dec7;lastGlobalApiCall=Date[_0x5ba0b1(0x189)]();}async function getWeatherContext(_0x23651d){const _0x4ba4f6=a0_0x15dec7;if(!_0x23651d[_0x4ba4f6(0x168)][_0x4ba4f6(0x1c3)]||!_0x23651d[_0x4ba4f6(0x168)][_0x4ba4f6(0x187)])return _0x4ba4f6(0x1b7);try{const _0x1fed33=_0x23651d[_0x4ba4f6(0x168)][_0x4ba4f6(0x187)];let _0x1a550b=await _0x23651d[_0x4ba4f6(0x179)](_0x1fed33+_0x4ba4f6(0x19f));if(!_0x1a550b)_0x1a550b=await _0x23651d[_0x4ba4f6(0x179)](_0x1fed33+_0x4ba4f6(0x1b3));let _0x1d5dcc=await _0x23651d[_0x4ba4f6(0x179)](_0x1fed33+_0x4ba4f6(0x1c9));if(!_0x1d5dcc)_0x1d5dcc=await _0x23651d[_0x4ba4f6(0x179)](_0x1fed33+_0x4ba4f6(0x170));let _0x3dae3d='Unbekannt';const _0x1e7971=await _0x23651d[_0x4ba4f6(0x179)](_0x1fed33+_0x4ba4f6(0x1c6));if(_0x1e7971)_0x3dae3d=_0x1e7971[_0x4ba4f6(0x1ba)]?'Nacht':'Tag';if(_0x1a550b&&_0x1d5dcc)return _0x1a550b[_0x4ba4f6(0x1ba)]+_0x4ba4f6(0x172)+_0x1d5dcc[_0x4ba4f6(0x1ba)]+_0x4ba4f6(0x177)+_0x3dae3d;}catch(_0x4b8721){}return _0x4ba4f6(0x192);}async function consultButler(_0x669ac1,_0x293f6c,_0xb77cfe,_0x30d429){const _0x4e2aac=a0_0x15dec7;if(!_0x669ac1['geminiModel'])return{'approved':!![],'reason':_0x4e2aac(0x1ed)};const _0x1224d2=Date[_0x4e2aac(0x189)]();if(decisionCache[_0x293f6c]&&_0x1224d2-decisionCache[_0x293f6c][_0x4e2aac(0x191)]<CACHE_TTL_MS){const _0x2da238=decisionCache[_0x293f6c][_0x4e2aac(0x1e6)];return _0x669ac1[_0x4e2aac(0x1af)][_0x4e2aac(0x1a9)](_0x4e2aac(0x17d)+_0x293f6c+_0x4e2aac(0x198)+(_0x2da238[_0x4e2aac(0x1c8)]?'OK':'NO')+'\x20('+_0x2da238[_0x4e2aac(0x1cd)]+')'),_0x2da238;}if(!canCallApi())return _0x669ac1['log'][_0x4e2aac(0x1a9)](_0x4e2aac(0x19b)+_0x293f6c+_0x4e2aac(0x1ec)),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x5da116=new Date()[_0x4e2aac(0x1ac)](),_0x567ee6=await getWeatherContext(_0x669ac1),_0x1453a8=PERSONA_MAPPING[_0x669ac1[_0x4e2aac(0x168)][_0x4e2aac(0x1b5)]||_0x4e2aac(0x18f)],_0x472c63=_0x4e2aac(0x1ae)+_0x5da116+_0x4e2aac(0x1c2)+_0x567ee6+_0x4e2aac(0x1d4)+(_0x30d429*0x64)[_0x4e2aac(0x1a2)](0x0)+_0x4e2aac(0x1de)+_0x293f6c+_0x4e2aac(0x1d8)+_0xb77cfe+_0x4e2aac(0x1b8)+_0x1453a8+_0x4e2aac(0x17f);try{updateApiTimestamp();const _0x2fdd52=await _0x669ac1[_0x4e2aac(0x1f2)][_0x4e2aac(0x1ad)](_0x472c63),_0x54d3ac=_0x2fdd52[_0x4e2aac(0x186)][_0x4e2aac(0x1e2)]()[_0x4e2aac(0x1a8)](/```json|```/g,'')[_0x4e2aac(0x19e)](),_0x57cb4b=JSON[_0x4e2aac(0x17b)](_0x54d3ac);return decisionCache[_0x293f6c]={'decision':_0x57cb4b,'timestamp':_0x1224d2},_0x57cb4b;}catch(_0x1e440b){return _0x669ac1['log'][_0x4e2aac(0x182)](_0x4e2aac(0x16e)+_0x1e440b[_0x4e2aac(0x16d)]),decisionCache[_0x293f6c]={'decision':{'approved':!![],'reason':_0x4e2aac(0x197)},'timestamp':_0x1224d2-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x4e2aac(0x197)};}}async function runGeminiAnalysis(_0xa20c32,_0x2cfc9e=''){const _0x230809=a0_0x15dec7;if(!_0xa20c32['geminiModel'])return;if(!canCallApi()){_0xa20c32['log'][_0x230809(0x1a9)](_0x230809(0x1e4));return;}if(_0xa20c32['eventHistory'][_0x230809(0x1a6)]===0x0)return;const _0x438461=_0xa20c32[_0x230809(0x1b4)]['slice'](0x0,0xf),_0x3e23ee=_0xa20c32[_0x230809(0x1ab)],_0x339d77=PERSONA_MAPPING[_0xa20c32[_0x230809(0x168)][_0x230809(0x1b5)]||_0x230809(0x18f)],_0x38fed7=_0xa20c32[_0x230809(0x168)][_0x230809(0x1dc)]||_0x230809(0x169);let _0x1178e8=_0x230809(0x1f4);try{const _0x57e729=await _0xa20c32[_0x230809(0x1aa)]('system.presenceWho');if(_0x57e729&&_0x57e729['val'])_0x1178e8=_0x57e729[_0x230809(0x1ba)];}catch(_0x2c311f){}let _0x107ca7=![];try{const _0x5f55b1=await _0xa20c32[_0x230809(0x1aa)]('analysis.automation.autoApply');if(_0x5f55b1&&_0x5f55b1[_0x230809(0x1ba)])_0x107ca7=!![];}catch(_0x1dbc71){}const _0x7adbd7=_0x230809(0x166)+_0x339d77+_0x230809(0x16f)+_0x38fed7+_0x230809(0x19d)+_0x3e23ee+_0x230809(0x196)+_0x1178e8+_0x230809(0x17e)+JSON[_0x230809(0x1a3)](_0x438461)+_0x230809(0x1b2)+_0x2cfc9e+_0x230809(0x1a5);try{updateApiTimestamp();const _0x2c5815=await _0xa20c32['geminiModel'][_0x230809(0x1ad)](_0x7adbd7),_0x3c9e5a=JSON['parse'](_0x2c5815[_0x230809(0x186)][_0x230809(0x1e2)]()[_0x230809(0x1a8)](/```json|```/g,'')[_0x230809(0x19e)]());await _0xa20c32[_0x230809(0x1b9)]('analysis.lastResult',{'val':JSON[_0x230809(0x1a3)](_0x3c9e5a),'ack':!![]});if(_0x3c9e5a[_0x230809(0x1ce)])await _0xa20c32['setStateAsync'](_0x230809(0x174),{'val':_0x3c9e5a[_0x230809(0x1ce)],'ack':!![]});const _0x364a26={'timestamp':Date[_0x230809(0x189)](),'id':Date[_0x230809(0x189)]()[_0x230809(0x1a0)](),'analysis':{'activity':{'summary':_0x3c9e5a[_0x230809(0x1ce)],'isAlert':_0x3c9e5a[_0x230809(0x184)],'alertReason':_0x3c9e5a[_0x230809(0x17c)]},'comfort':{'automationProposal':_0x3c9e5a[_0x230809(0x193)]}}};_0xa20c32['analysisHistory'][_0x230809(0x1b0)](_0x364a26);if(_0xa20c32[_0x230809(0x171)][_0x230809(0x1a6)]>0x32)_0xa20c32['analysisHistory'][_0x230809(0x16c)]();await _0xa20c32[_0x230809(0x1b9)](_0x230809(0x1c4),{'val':JSON['stringify'](_0xa20c32[_0x230809(0x171)]),'ack':!![]});const _0x173111=_0x3c9e5a[_0x230809(0x184)]||![];_0x173111!==_0xa20c32['lastAlertState']&&(await _0xa20c32['setStateAsync'](_0x230809(0x1d7),{'val':_0x173111,'ack':!![]}),_0xa20c32['lastAlertState']=_0x173111,_0x173111&&(await _0xa20c32[_0x230809(0x1b9)](_0x230809(0x194),{'val':_0x3c9e5a[_0x230809(0x17c)],'ack':!![]}),setup[_0x230809(0x1da)](_0xa20c32,_0x230809(0x1e3)+_0x3c9e5a[_0x230809(0x17c)],![],_0x3c9e5a[_0x230809(0x1dd)])));if(_0x3c9e5a[_0x230809(0x193)]&&_0x3c9e5a[_0x230809(0x193)]['detected']){await _0xa20c32[_0x230809(0x1b9)](_0x230809(0x1cc),{'val':!![],'ack':!![]}),await _0xa20c32[_0x230809(0x1b9)](_0x230809(0x175),{'val':_0x3c9e5a[_0x230809(0x193)][_0x230809(0x17a)],'ack':!![]}),await _0xa20c32['setStateAsync'](_0x230809(0x1d3),{'val':_0x3c9e5a[_0x230809(0x193)][_0x230809(0x1a7)],'ack':!![]}),await _0xa20c32['setStateAsync'](_0x230809(0x1ca),{'val':JSON[_0x230809(0x1a3)](_0x3c9e5a['automationProposal'][_0x230809(0x1e7)]),'ack':!![]});if(_0x107ca7)executeAutomationAction(_0xa20c32);}}catch(_0x150265){_0xa20c32[_0x230809(0x1af)][_0x230809(0x1b6)](_0x230809(0x1e8)+_0x150265[_0x230809(0x16d)]);}}function a0_0x1f2f(){const _0x5a3f6d=['LTM.dailyDigests','analysis.automation.targetId','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','2382KUcGUZ','1869111aKEeYS','analysis.isAlert','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','sendNotification','1QImAYL','livingContext','isEmergency','%)\x20nach\x20\x22','info','dailyDigests','splice','text','âš ï¸\x20ALARM:\x20','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','ðŸŒ…\x20Morning\x20Briefing:\x0a','decision','targetValue','Gemini\x20Error:\x20','activityLevel','rawEventLog','exports','\x20Ã¼bersprungen\x20(Auto-Approved).','KI\x20offline\x20(Fallback)','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','@google/generative-ai','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','search','geminiModel','constructor','Unbekannt','6393690XgNyym','2578198XrSPvg','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','Skipped\x20(Traffic)','config','Keine\x20Details.','LTM.driftAnalysis.driftDetails','Briefing\x20Error:\x20','pop','message','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','.\x20KONTEXT:\x20','.forecast.current.state','analysisHistory','Â°C,\x20','Digest','analysis.activitySummary','analysis.automation.description','Sicherheit\x20geht\x20vor.',',\x20LichtverhÃ¤ltnisse:\x20','toISOString','getForeignStateAsync','description','parse','alertReason','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','.\x20EVENTS:\x20','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','isProVersion','LTM.driftAnalysis.baselineDrift','warn','4OQcRFn','isAlert','./setup','response','weatherInstance','driftDetails','now','Success','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','2156914vcApFK','8799350dLtxZZ','3324QeCFYi','generic','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','timestamp','Wetterdaten\x20nicht\x20abrufbar','automationProposal','analysis.alertReason','BUTLER\x20Execution\x20Error:\x20','.\x20ANWESEND:\x20','KI-Fehler\x20(Fallback)','\x20->\x20','ltmStbWindowDays','Started...','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','models/gemini-flash-latest','.\x20SYSTEM_MODE:\x20','trim','.Current.Temperature','toString','push','toFixed','stringify','apply','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','length','targetId','replace','debug','getStateAsync','currentSystemMode','toLocaleTimeString','generateContent','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','log','unshift','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','.\x20EMERGENCY:\x20','.forecast.current.temperature','eventHistory','aiPersona','error','Unbekannt\x20(Kein\x20Sensor)','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','setStateAsync','val','31009zRnQRH','baselineDrift','(((.+)+)+)+$','slice','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','ltmLtbWindowDays','1175jFBMMH',',\x20Wetter:\x20','useWeather','analysis.analysisHistory','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','.Current.IsNight','ANALYZE_HEALTH','approved','.Current.WeatherText','analysis.automation.targetValue','8liBHgl','analysis.automation.patternDetected','reason','summary','setForeignStateAsync','Skipped\x20(No\x20AI\x20or\x20Data)','LTM.rawEventLog'];a0_0x1f2f=function(){return _0x5a3f6d;};return a0_0x1f2f();}async function createDailyDigest(_0x42acf8,_0x45805b){const _0x173337=a0_0x15dec7;if(!_0x42acf8[_0x173337(0x180)])return;if(!canCallApi()){await _0x42acf8[_0x173337(0x1b9)](LTM_DP_STATUS,{'val':_0x173337(0x167),'ack':!![]});return;}await _0x42acf8[_0x173337(0x1b9)](LTM_DP_STATUS,{'val':_0x173337(0x19a),'ack':!![]});if(!_0x42acf8['geminiModel']||_0x42acf8[_0x173337(0x1ea)][_0x173337(0x1a6)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x42acf8[_0x173337(0x1b9)](LTM_DP_STATUS,{'val':_0x173337(0x1d0),'ack':!![]});return;}const _0x45c81c=JSON['parse'](JSON[_0x173337(0x1a3)](_0x42acf8['rawEventLog'])),_0x4d3384=_0x45c81c[_0x173337(0x1a6)],_0x1d8f22=_0x173337(0x190)+JSON['stringify'](_0x45c81c);try{updateApiTimestamp();const _0x2cec8c=await _0x42acf8['geminiModel'][_0x173337(0x1ad)](_0x1d8f22),_0x29e404=JSON[_0x173337(0x17b)](_0x2cec8c[_0x173337(0x186)][_0x173337(0x1e2)]()[_0x173337(0x1a8)](/```json|```/g,'')[_0x173337(0x19e)]()),_0x374343={'timestamp':new Date()[_0x173337(0x178)](),'eventCount':_0x4d3384,'summary':_0x29e404[_0x173337(0x1ce)]||_0x173337(0x173),'activityLevel':_0x29e404[_0x173337(0x1e9)]||'normal','systemMode':_0x42acf8['currentSystemMode']};_0x42acf8[_0x173337(0x1e0)][_0x173337(0x1a1)](_0x374343);const _0x59fce5=_0x42acf8['config'][_0x173337(0x1c0)]||0x3c;_0x42acf8['dailyDigests'][_0x173337(0x1a6)]>_0x59fce5&&_0x42acf8[_0x173337(0x1e0)][_0x173337(0x1e1)](0x0,_0x42acf8[_0x173337(0x1e0)][_0x173337(0x1a6)]-_0x59fce5);await _0x42acf8['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x173337(0x1a3)](_0x42acf8[_0x173337(0x1e0)]),'ack':!![]}),_0x42acf8[_0x173337(0x1ea)]=[],await _0x42acf8['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x42acf8[_0x173337(0x1ea)]),'ack':!![]}),await _0x42acf8[_0x173337(0x1b9)](LTM_DP_STATUS,{'val':_0x173337(0x18a),'ack':!![]});if(_0x42acf8[_0x173337(0x180)]&&_0x45805b)_0x45805b['send'](_0x42acf8,_0x173337(0x1c7),{'digest':_0x374343});}catch(_0x1c262d){_0x42acf8['log'][_0x173337(0x1b6)](_0x1c262d['message']);}}async function runBaselineDriftAnalysis(_0x27105e){const _0x3e0db8=a0_0x15dec7;if(!_0x27105e[_0x3e0db8(0x180)]||!_0x27105e[_0x3e0db8(0x1f2)])return;if(!canCallApi())return;const _0x429f19=_0x27105e['config'][_0x3e0db8(0x199)]||0xe;if(_0x27105e[_0x3e0db8(0x1e0)][_0x3e0db8(0x1a6)]<_0x429f19+0x7){await _0x27105e['setStateAsync'](_0x3e0db8(0x181),{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x136cd4=_0x27105e['dailyDigests'][_0x3e0db8(0x1be)](-_0x429f19),_0x2fe60a=_0x27105e['dailyDigests'][_0x3e0db8(0x1be)](0x0,_0x27105e[_0x3e0db8(0x1e0)][_0x3e0db8(0x1a6)]-_0x429f19),_0x9b5d1=_0x3e0db8(0x1d9)+JSON[_0x3e0db8(0x1a3)](_0x2fe60a)+'\x0aSTB:\x20'+JSON[_0x3e0db8(0x1a3)](_0x136cd4);try{updateApiTimestamp();const _0x10ef5f=await _0x27105e[_0x3e0db8(0x1f2)][_0x3e0db8(0x1ad)](_0x9b5d1),_0x47c772=JSON['parse'](_0x10ef5f['response'][_0x3e0db8(0x1e2)]()[_0x3e0db8(0x1a8)](/```json|```/g,'')[_0x3e0db8(0x19e)]());_0x47c772[_0x3e0db8(0x1bc)]&&(await _0x27105e['setStateAsync'](_0x3e0db8(0x181),{'val':_0x47c772[_0x3e0db8(0x1bc)],'ack':!![]}),await _0x27105e[_0x3e0db8(0x1b9)](_0x3e0db8(0x16a),{'val':_0x47c772[_0x3e0db8(0x188)],'ack':!![]}),await _0x27105e['setStateAsync']('LTM.driftAnalysis.lastCheck',{'val':Date[_0x3e0db8(0x189)](),'ack':!![]}));}catch(_0x2c2426){}}async function executeAutomationAction(_0x1b7bcf){const _0x5496c4=a0_0x15dec7;try{const _0x5bf8e3=await _0x1b7bcf['getStateAsync'](_0x5496c4(0x1d3)),_0x5a4db8=await _0x1b7bcf[_0x5496c4(0x1aa)]('analysis.automation.targetValue');if(_0x5bf8e3&&_0x5bf8e3[_0x5496c4(0x1ba)]&&_0x5a4db8){const _0x19ec84=_0x5bf8e3[_0x5496c4(0x1ba)];let _0x51b00b=_0x5a4db8[_0x5496c4(0x1ba)];try{_0x51b00b=JSON[_0x5496c4(0x17b)](_0x51b00b);}catch(_0x217aef){}_0x1b7bcf[_0x5496c4(0x1af)][_0x5496c4(0x1df)](_0x5496c4(0x1bf)+_0x19ec84+'\x20=\x20'+_0x51b00b),await _0x1b7bcf[_0x5496c4(0x1cf)](_0x19ec84,_0x51b00b);}else _0x1b7bcf[_0x5496c4(0x1af)][_0x5496c4(0x182)](_0x5496c4(0x1b1));}catch(_0x448692){_0x1b7bcf['log'][_0x5496c4(0x1b6)](_0x5496c4(0x195)+_0x448692[_0x5496c4(0x16d)]);}}async function sendMorningBriefing(_0x44b269){const _0xa3d6bc=a0_0x15dec7;if(!_0x44b269['geminiModel'])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x49656c='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x2b2502=await _0x44b269[_0xa3d6bc(0x1f2)][_0xa3d6bc(0x1ad)](_0x49656c),_0xc6b593=_0x2b2502['response'][_0xa3d6bc(0x1e2)]();setup[_0xa3d6bc(0x1da)](_0x44b269,_0xa3d6bc(0x1e5)+_0xc6b593);}catch(_0x52d1df){_0x44b269[_0xa3d6bc(0x1af)][_0xa3d6bc(0x1b6)](_0xa3d6bc(0x16b)+_0x52d1df[_0xa3d6bc(0x16d)]);}}module[a0_0x15dec7(0x1eb)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};