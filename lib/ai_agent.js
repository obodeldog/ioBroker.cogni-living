const a0_0x16dd05=a0_0x5b77;(function(_0x428f7d,_0x1d07e2){const _0x164c56=a0_0x5b77,_0x15b194=_0x428f7d();while(!![]){try{const _0xec7b67=-parseInt(_0x164c56(0x263))/0x1*(-parseInt(_0x164c56(0x1fc))/0x2)+parseInt(_0x164c56(0x229))/0x3+-parseInt(_0x164c56(0x22c))/0x4+parseInt(_0x164c56(0x1e9))/0x5*(parseInt(_0x164c56(0x1f1))/0x6)+parseInt(_0x164c56(0x264))/0x7*(-parseInt(_0x164c56(0x269))/0x8)+parseInt(_0x164c56(0x251))/0x9*(parseInt(_0x164c56(0x1ee))/0xa)+-parseInt(_0x164c56(0x256))/0xb*(parseInt(_0x164c56(0x261))/0xc);if(_0xec7b67===_0x1d07e2)break;else _0x15b194['push'](_0x15b194['shift']());}catch(_0x1baf50){_0x15b194['push'](_0x15b194['shift']());}}}(a0_0x34e3,0x55a9e));const a0_0xd8368b=(function(){let _0x5366c7=!![];return function(_0x4aa205,_0x4bb116){const _0x12d6bb=_0x5366c7?function(){const _0x4a7d71=a0_0x5b77;if(_0x4bb116){const _0x28bf09=_0x4bb116[_0x4a7d71(0x1f3)](_0x4aa205,arguments);return _0x4bb116=null,_0x28bf09;}}:function(){};return _0x5366c7=![],_0x12d6bb;};}()),a0_0x513aee=a0_0xd8368b(this,function(){const _0x3224ee=a0_0x5b77;return a0_0x513aee['toString']()[_0x3224ee(0x203)](_0x3224ee(0x245))[_0x3224ee(0x21f)]()[_0x3224ee(0x211)](a0_0x513aee)[_0x3224ee(0x203)]('(((.+)+)+)+$');});a0_0x513aee();'use strict';function a0_0x34e3(){const _0xb23c0e=['PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','üåÖ\x20Morning\x20Briefing:\x0a',').\x20Sending\x20notification...','Health\x20Report\x20Error:\x20','analysis.automation.description','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','%)\x20nach\x20\x22','splice','toString','analysis.automation.targetId','.Current.IsNight','LTM.dailyDigests','activityLevel','isEmergency','analysis.health.geminiNight','length','.\x20EMERGENCY:\x20','alertReason','347931kpJlEW',',\x20Lichtverh√§ltnisse:\x20','LTM.processingStatus','3408EVmSYm','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','unshift','targetId','analysis.analysisHistory','analysis.automation.targetValue','getTime','Success','ü§ñ\x20Health\x20Report\x20(','description','weatherInstance','analysis.alertReason','automationProposal','analysis.automation.patternDetected','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','Unbekannt','setStateAsync','\x0a\x20\x20\x20\x20EVENTS:\x0a','Skipped\x20(No\x20AI\x20or\x20Data)','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','exports','send','üìÖ\x20Daily\x20Digest:\x0a','now','.\x20EVENTS:\x20','(((.+)+)+)+$','dailyDigests','./setup','¬∞C,\x20','config','ltmLtbWindowDays','analysis.activitySummary','NIGHT','log','setHours','geminiModel','lastAlertState','72dHVwDv','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','aiPersona','LTM.driftAnalysis.driftDetails','timestamp','56969hKGvqu','toLocaleTimeString','analysisHistory','driftDetails','@google/generative-ai','debug','‚ö†Ô∏è\x20ALARM:\x20','generateContent','response','toISOString','Unbekannt\x20(Kein\x20Sensor)','732pMbBqE','detected','1241QrlSZr','539dubRvV','N/A\x20(Learning)','summary','.Current.WeatherText','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','40216xzfmzP','.\x20ANWESEND:\x20','warn','ü§ñ\x20Butler\x20Brain\x20Error:\x20','approved','rawEventLog','stringify','üåÖ\x20Briefing\x20generated\x20(Length:\x20','Briefing\x20Error:\x20','eventHistory','error','map','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','name','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','baselineDrift','replace',',\x20Wetter:\x20','currentSystemMode','message','.Current.Temperature','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','Tag','Keine\x20Details.','val','isAlert','ANALYZE_HEALTH','207070NKkvCg','isProVersion','sendNotification','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','553160iVxZvG','value','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','30CNYeHG','info','apply','.forecast.current.state','normal','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','\x20->\x20','Started...','push','Traffic-Schutz\x20(Auto-Approved)','text','466SmJdEx','LTM.driftAnalysis.baselineDrift','system.presenceWho','analysis.isAlert','.\x20SYSTEM_MODE:\x20','2-digit','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','search','getStateAsync','parse','.\x20KONTEXT:\x20','KI-Fehler\x20(Fallback)','join','decision','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','\x0aSTB:\x20','\x0aAktivit√§t:\x20','LTM.driftAnalysis.lastCheck','getForeignStateAsync','trim','reason','constructor','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','pop','slice','generic','filter'];a0_0x34e3=function(){return _0xb23c0e;};return a0_0x34e3();}const {GoogleGenerativeAI}=require(a0_0x16dd05(0x25a)),setup=require(a0_0x16dd05(0x247)),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x16dd05(0x222),LTM_DP_STATUS=a0_0x16dd05(0x22b),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x16dd05(0x1ed),'senior_aal':a0_0x16dd05(0x217),'family':a0_0x16dd05(0x212),'single_comfort':a0_0x16dd05(0x268),'security':'Sicherheit\x20geht\x20vor.','energy_saver':'PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).'};function canCallApi(){const _0x33be3a=a0_0x16dd05,_0x1c6c26=Date[_0x33be3a(0x243)]();return _0x1c6c26-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){lastGlobalApiCall=Date['now']();}async function getWeatherContext(_0x2f1e2c){const _0x11f0a7=a0_0x16dd05;if(!_0x2f1e2c[_0x11f0a7(0x249)]['useWeather']||!_0x2f1e2c[_0x11f0a7(0x249)][_0x11f0a7(0x236)])return _0x11f0a7(0x260);try{const _0x419f61=_0x2f1e2c[_0x11f0a7(0x249)][_0x11f0a7(0x236)];let _0x25251c=await _0x2f1e2c[_0x11f0a7(0x20e)](_0x419f61+_0x11f0a7(0x1e2));if(!_0x25251c)_0x25251c=await _0x2f1e2c['getForeignStateAsync'](_0x419f61+'.forecast.current.temperature');let _0xaf6195=await _0x2f1e2c[_0x11f0a7(0x20e)](_0x419f61+_0x11f0a7(0x267));if(!_0xaf6195)_0xaf6195=await _0x2f1e2c[_0x11f0a7(0x20e)](_0x419f61+_0x11f0a7(0x1f4));let _0x2d8fc2=_0x11f0a7(0x23b);const _0x27de2b=await _0x2f1e2c['getForeignStateAsync'](_0x419f61+_0x11f0a7(0x221));if(_0x27de2b)_0x2d8fc2=_0x27de2b[_0x11f0a7(0x1e6)]?'Nacht':_0x11f0a7(0x1e4);if(_0x25251c&&_0xaf6195)return _0x25251c[_0x11f0a7(0x1e6)]+_0x11f0a7(0x248)+_0xaf6195[_0x11f0a7(0x1e6)]+_0x11f0a7(0x22a)+_0x2d8fc2;}catch(_0x59fe26){}return'Wetterdaten\x20nicht\x20abrufbar';}async function consultButler(_0x24a59e,_0x12292a,_0x2deaee,_0x1e5e72){const _0x411a4c=a0_0x16dd05;if(!_0x24a59e[_0x411a4c(0x24f)])return{'approved':!![],'reason':'KI\x20offline\x20(Fallback)'};const _0x24c282=Date['now']();if(decisionCache[_0x12292a]&&_0x24c282-decisionCache[_0x12292a][_0x411a4c(0x255)]<CACHE_TTL_MS){const _0x14a732=decisionCache[_0x12292a][_0x411a4c(0x209)];return _0x24a59e[_0x411a4c(0x24d)][_0x411a4c(0x25b)](_0x411a4c(0x20a)+_0x12292a+_0x411a4c(0x1f7)+(_0x14a732[_0x411a4c(0x1d2)]?'OK':'NO')+'\x20('+_0x14a732[_0x411a4c(0x210)]+')'),_0x14a732;}if(!canCallApi())return _0x24a59e['log']['debug'](_0x411a4c(0x1ec)+_0x12292a+'\x20√ºbersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x411a4c(0x1fa)};const _0xa70368=new Date()[_0x411a4c(0x257)](),_0x1f934c=await getWeatherContext(_0x24a59e),_0x2ea683=PERSONA_MAPPING[_0x24a59e[_0x411a4c(0x249)][_0x411a4c(0x253)]||_0x411a4c(0x215)],_0x438324='\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20'+_0xa70368+_0x411a4c(0x1df)+_0x1f934c+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x1e5e72*0x64)['toFixed'](0x0)+_0x411a4c(0x21d)+_0x12292a+_0x411a4c(0x252)+_0x2deaee+_0x411a4c(0x23f)+_0x2ea683+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x5e152d=await _0x24a59e[_0x411a4c(0x24f)][_0x411a4c(0x25d)](_0x438324),_0x4395cf=_0x5e152d[_0x411a4c(0x25e)]['text']()[_0x411a4c(0x1de)](/```json|```/g,'')[_0x411a4c(0x20f)](),_0x108e0f=JSON['parse'](_0x4395cf);return decisionCache[_0x12292a]={'decision':_0x108e0f,'timestamp':_0x24c282},_0x108e0f;}catch(_0x25dc58){return _0x24a59e[_0x411a4c(0x24d)][_0x411a4c(0x26b)](_0x411a4c(0x26c)+_0x25dc58['message']),decisionCache[_0x12292a]={'decision':{'approved':!![],'reason':_0x411a4c(0x207)},'timestamp':_0x24c282-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x411a4c(0x207)};}}async function runGeminiAnalysis(_0xc2ceac,_0x36af3d=''){const _0x472f23=a0_0x16dd05;if(!_0xc2ceac[_0x472f23(0x24f)])return;if(!canCallApi()){_0xc2ceac[_0x472f23(0x24d)]['debug']('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0xc2ceac[_0x472f23(0x1d7)]['length']===0x0)return;const _0x5776fe=_0xc2ceac[_0x472f23(0x1d7)]['slice'](0x0,0xf),_0x5b9034=_0xc2ceac['currentSystemMode'],_0x9e3a6c=PERSONA_MAPPING[_0xc2ceac[_0x472f23(0x249)][_0x472f23(0x253)]||_0x472f23(0x215)],_0x4e32ca=_0xc2ceac['config']['livingContext']||_0x472f23(0x1e5);let _0xe14c54='Unbekannt';try{const _0x12075f=await _0xc2ceac[_0x472f23(0x204)](_0x472f23(0x1fe));if(_0x12075f&&_0x12075f[_0x472f23(0x1e6)])_0xe14c54=_0x12075f[_0x472f23(0x1e6)];}catch(_0x28ab74){}let _0x1768f6=![];try{const _0x341ee9=await _0xc2ceac[_0x472f23(0x204)]('analysis.automation.autoApply');if(_0x341ee9&&_0x341ee9[_0x472f23(0x1e6)])_0x1768f6=!![];}catch(_0x4755ea){}const _0x5770d3='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x9e3a6c+_0x472f23(0x206)+_0x4e32ca+_0x472f23(0x200)+_0x5b9034+_0x472f23(0x26a)+_0xe14c54+_0x472f23(0x244)+JSON[_0x472f23(0x1d4)](_0x5776fe)+_0x472f23(0x227)+_0x36af3d+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x52641c=await _0xc2ceac[_0x472f23(0x24f)][_0x472f23(0x25d)](_0x5770d3),_0x18c251=JSON[_0x472f23(0x205)](_0x52641c[_0x472f23(0x25e)]['text']()[_0x472f23(0x1de)](/```json|```/g,'')[_0x472f23(0x20f)]());await _0xc2ceac[_0x472f23(0x23c)]('analysis.lastResult',{'val':JSON['stringify'](_0x18c251),'ack':!![]});if(_0x18c251[_0x472f23(0x266)])await _0xc2ceac[_0x472f23(0x23c)](_0x472f23(0x24b),{'val':_0x18c251['summary'],'ack':!![]});const _0x4340e7={'timestamp':Date['now'](),'id':Date[_0x472f23(0x243)]()['toString'](),'analysis':{'activity':{'summary':_0x18c251['summary'],'isAlert':_0x18c251[_0x472f23(0x1e7)],'alertReason':_0x18c251[_0x472f23(0x228)]},'comfort':{'automationProposal':_0x18c251[_0x472f23(0x238)]}}};_0xc2ceac[_0x472f23(0x258)][_0x472f23(0x22e)](_0x4340e7);if(_0xc2ceac[_0x472f23(0x258)]['length']>0x32)_0xc2ceac[_0x472f23(0x258)][_0x472f23(0x213)]();await _0xc2ceac[_0x472f23(0x23c)](_0x472f23(0x230),{'val':JSON[_0x472f23(0x1d4)](_0xc2ceac[_0x472f23(0x258)]),'ack':!![]});const _0x34f33e=_0x18c251['isAlert']||![];_0x34f33e!==_0xc2ceac[_0x472f23(0x250)]&&(await _0xc2ceac['setStateAsync'](_0x472f23(0x1ff),{'val':_0x34f33e,'ack':!![]}),_0xc2ceac[_0x472f23(0x250)]=_0x34f33e,_0x34f33e&&(await _0xc2ceac[_0x472f23(0x23c)](_0x472f23(0x237),{'val':_0x18c251[_0x472f23(0x228)],'ack':!![]}),setup[_0x472f23(0x1eb)](_0xc2ceac,_0x472f23(0x25c)+_0x18c251['alertReason'],![],_0x18c251[_0x472f23(0x224)])));if(_0x18c251[_0x472f23(0x238)]&&_0x18c251[_0x472f23(0x238)][_0x472f23(0x262)]){await _0xc2ceac[_0x472f23(0x23c)](_0x472f23(0x239),{'val':!![],'ack':!![]}),await _0xc2ceac[_0x472f23(0x23c)](_0x472f23(0x21b),{'val':_0x18c251[_0x472f23(0x238)][_0x472f23(0x235)],'ack':!![]}),await _0xc2ceac['setStateAsync']('analysis.automation.targetId',{'val':_0x18c251['automationProposal'][_0x472f23(0x22f)],'ack':!![]}),await _0xc2ceac[_0x472f23(0x23c)](_0x472f23(0x231),{'val':JSON[_0x472f23(0x1d4)](_0x18c251[_0x472f23(0x238)]['targetValue']),'ack':!![]});if(_0x1768f6)executeAutomationAction(_0xc2ceac);}}catch(_0x412d24){_0xc2ceac['log'][_0x472f23(0x1d8)]('Gemini\x20Error:\x20'+_0x412d24[_0x472f23(0x1e1)]);}}async function createDailyDigest(_0x2fc5ff,_0x363e6f){const _0x1b534d=a0_0x16dd05;if(!_0x2fc5ff[_0x1b534d(0x1ea)])return;if(!canCallApi()){await _0x2fc5ff[_0x1b534d(0x23c)](LTM_DP_STATUS,{'val':'Skipped\x20(Traffic)','ack':!![]});return;}await _0x2fc5ff[_0x1b534d(0x23c)](LTM_DP_STATUS,{'val':_0x1b534d(0x1f8),'ack':!![]});if(!_0x2fc5ff['geminiModel']||_0x2fc5ff[_0x1b534d(0x1d3)][_0x1b534d(0x226)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2fc5ff[_0x1b534d(0x23c)](LTM_DP_STATUS,{'val':_0x1b534d(0x23e),'ack':!![]});return;}const _0x5a6ab7=JSON['parse'](JSON[_0x1b534d(0x1d4)](_0x2fc5ff[_0x1b534d(0x1d3)])),_0x240841=_0x5a6ab7[_0x1b534d(0x226)],_0x2b9329=_0x1b534d(0x202)+JSON[_0x1b534d(0x1d4)](_0x5a6ab7);try{updateApiTimestamp();const _0x1df29c=await _0x2fc5ff[_0x1b534d(0x24f)][_0x1b534d(0x25d)](_0x2b9329),_0xc29550=JSON[_0x1b534d(0x205)](_0x1df29c[_0x1b534d(0x25e)]['text']()[_0x1b534d(0x1de)](/```json|```/g,'')['trim']()),_0x3ea672={'timestamp':new Date()[_0x1b534d(0x25f)](),'eventCount':_0x240841,'summary':_0xc29550['summary']||'Digest','activityLevel':_0xc29550[_0x1b534d(0x223)]||_0x1b534d(0x1f5),'systemMode':_0x2fc5ff[_0x1b534d(0x1e0)]};_0x2fc5ff[_0x1b534d(0x246)][_0x1b534d(0x1f9)](_0x3ea672);const _0x59ae36=_0x2fc5ff['config'][_0x1b534d(0x24a)]||0x3c;_0x2fc5ff[_0x1b534d(0x246)][_0x1b534d(0x226)]>_0x59ae36&&_0x2fc5ff[_0x1b534d(0x246)][_0x1b534d(0x21e)](0x0,_0x2fc5ff[_0x1b534d(0x246)][_0x1b534d(0x226)]-_0x59ae36);await _0x2fc5ff[_0x1b534d(0x23c)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1b534d(0x1d4)](_0x2fc5ff[_0x1b534d(0x246)]),'ack':!![]}),_0x2fc5ff[_0x1b534d(0x1d3)]=[],await _0x2fc5ff[_0x1b534d(0x23c)](LTM_DP_RAW_LOG,{'val':JSON[_0x1b534d(0x1d4)](_0x2fc5ff[_0x1b534d(0x1d3)]),'ack':!![]}),await _0x2fc5ff['setStateAsync'](LTM_DP_STATUS,{'val':_0x1b534d(0x233),'ack':!![]});const _0x21e5ac=_0x1b534d(0x242)+_0xc29550[_0x1b534d(0x266)]+_0x1b534d(0x20c)+_0xc29550['activityLevel'];setup[_0x1b534d(0x1eb)](_0x2fc5ff,_0x21e5ac,![],![]);if(_0x2fc5ff[_0x1b534d(0x1ea)]&&_0x363e6f)_0x363e6f[_0x1b534d(0x241)](_0x2fc5ff,_0x1b534d(0x1e8),{'digest':_0x3ea672});}catch(_0x444a7b){_0x2fc5ff['log'][_0x1b534d(0x1d8)](_0x444a7b['message']);}}async function runBaselineDriftAnalysis(_0x2d3d3d){const _0x37b38a=a0_0x16dd05;if(!_0x2d3d3d['isProVersion']||!_0x2d3d3d['geminiModel'])return;if(!canCallApi())return;const _0x38d4d1=_0x2d3d3d[_0x37b38a(0x249)]['ltmStbWindowDays']||0xe;if(_0x2d3d3d[_0x37b38a(0x246)][_0x37b38a(0x226)]<_0x38d4d1+0x7){await _0x2d3d3d[_0x37b38a(0x23c)](_0x37b38a(0x1fd),{'val':_0x37b38a(0x265),'ack':!![]});return;}const _0x3ac963=_0x2d3d3d['dailyDigests'][_0x37b38a(0x214)](-_0x38d4d1),_0x22f54b=_0x2d3d3d['dailyDigests'][_0x37b38a(0x214)](0x0,_0x2d3d3d[_0x37b38a(0x246)][_0x37b38a(0x226)]-_0x38d4d1),_0x20de0=_0x37b38a(0x21c)+JSON[_0x37b38a(0x1d4)](_0x22f54b)+_0x37b38a(0x20b)+JSON[_0x37b38a(0x1d4)](_0x3ac963);try{updateApiTimestamp();const _0x2ad29f=await _0x2d3d3d[_0x37b38a(0x24f)][_0x37b38a(0x25d)](_0x20de0),_0x1e7b2f=JSON['parse'](_0x2ad29f[_0x37b38a(0x25e)][_0x37b38a(0x1fb)]()['replace'](/```json|```/g,'')[_0x37b38a(0x20f)]());_0x1e7b2f[_0x37b38a(0x1dd)]&&(await _0x2d3d3d[_0x37b38a(0x23c)](_0x37b38a(0x1fd),{'val':_0x1e7b2f['baselineDrift'],'ack':!![]}),await _0x2d3d3d[_0x37b38a(0x23c)](_0x37b38a(0x254),{'val':_0x1e7b2f[_0x37b38a(0x259)],'ack':!![]}),await _0x2d3d3d['setStateAsync'](_0x37b38a(0x20d),{'val':Date[_0x37b38a(0x243)](),'ack':!![]}));}catch(_0x758335){}}async function executeAutomationAction(_0x7ee6df){const _0x1c8daa=a0_0x16dd05;try{const _0x257b3c=await _0x7ee6df[_0x1c8daa(0x204)](_0x1c8daa(0x220)),_0x5963ac=await _0x7ee6df['getStateAsync']('analysis.automation.targetValue');if(_0x257b3c&&_0x257b3c[_0x1c8daa(0x1e6)]&&_0x5963ac){const _0x339728=_0x257b3c[_0x1c8daa(0x1e6)];let _0x4b5dc0=_0x5963ac['val'];try{_0x4b5dc0=JSON[_0x1c8daa(0x205)](_0x4b5dc0);}catch(_0x5346c5){}_0x7ee6df[_0x1c8daa(0x24d)][_0x1c8daa(0x1f2)](_0x1c8daa(0x1dc)+_0x339728+'\x20=\x20'+_0x4b5dc0),await _0x7ee6df['setForeignStateAsync'](_0x339728,_0x4b5dc0);}else _0x7ee6df['log'][_0x1c8daa(0x26b)](_0x1c8daa(0x22d));}catch(_0x849872){_0x7ee6df[_0x1c8daa(0x24d)][_0x1c8daa(0x1d8)]('BUTLER\x20Execution\x20Error:\x20'+_0x849872[_0x1c8daa(0x1e1)]);}}async function sendMorningBriefing(_0x5d9471){const _0x27f24a=a0_0x16dd05;if(!_0x5d9471['geminiModel']){_0x5d9471['log'][_0x27f24a(0x26b)](_0x27f24a(0x1f0));return;}_0x5d9471[_0x27f24a(0x24d)][_0x27f24a(0x1f2)]('üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x22b357=_0x27f24a(0x1e3),_0x1fdecc=await _0x5d9471[_0x27f24a(0x24f)]['generateContent'](_0x22b357),_0x23eec4=_0x1fdecc[_0x27f24a(0x25e)][_0x27f24a(0x1fb)]();_0x5d9471['log'][_0x27f24a(0x1f2)](_0x27f24a(0x1d5)+_0x23eec4['length']+_0x27f24a(0x219)),setup[_0x27f24a(0x1eb)](_0x5d9471,_0x27f24a(0x218)+_0x23eec4);}catch(_0x2dd666){_0x5d9471[_0x27f24a(0x24d)]['error'](_0x27f24a(0x1d6)+_0x2dd666['message']);}}async function generateHealthReport(_0x50b57a,_0x5d6cce){const _0x2360d0=a0_0x16dd05;if(!_0x50b57a['geminiModel'])return;const _0x4e7bc2=Date[_0x2360d0(0x243)]();_0x4e7bc2-lastGlobalApiCall<0xbb8&&(_0x50b57a[_0x2360d0(0x24d)]['debug']('ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...'),await new Promise(_0x6885d5=>setTimeout(_0x6885d5,0x7d0)));const _0x506012=new Date();let _0x26017d=0x0,_0x562200=_0x506012[_0x2360d0(0x232)](),_0x312bbe='';if(_0x5d6cce===_0x2360d0(0x24c)){const _0xf49620=new Date(_0x506012);_0xf49620['setDate'](_0xf49620['getDate']()-0x1),_0xf49620[_0x2360d0(0x24e)](0x16,0x0,0x0,0x0),_0x26017d=_0xf49620[_0x2360d0(0x232)]();const _0x4776c0=new Date(_0x506012);_0x4776c0[_0x2360d0(0x24e)](0x8,0x0,0x0,0x0),_0x562200=_0x4776c0[_0x2360d0(0x232)](),_0x312bbe=_0x2360d0(0x1f6);}else{const _0x4a7b10=new Date(_0x506012);_0x4a7b10[_0x2360d0(0x24e)](0x8,0x0,0x0,0x0),_0x26017d=_0x4a7b10['getTime'](),_0x312bbe=_0x2360d0(0x23a);}const _0x2c074c=_0x50b57a[_0x2360d0(0x1d7)][_0x2360d0(0x216)](_0x1dcb33=>_0x1dcb33[_0x2360d0(0x255)]>=_0x26017d&&_0x1dcb33[_0x2360d0(0x255)]<=_0x562200);if(_0x2c074c[_0x2360d0(0x226)]===0x0){const _0x14f15d=_0x5d6cce===_0x2360d0(0x24c)?'Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).':_0x2360d0(0x1da),_0xc1ae7e=_0x5d6cce===_0x2360d0(0x24c)?_0x2360d0(0x225):'analysis.health.geminiDay';await _0x50b57a[_0x2360d0(0x23c)](_0xc1ae7e,{'val':_0x14f15d,'ack':!![]});return;}const _0x5c6efc=_0x2c074c[_0x2360d0(0x1d9)](_0x21dda4=>new Date(_0x21dda4[_0x2360d0(0x255)])['toLocaleTimeString']([],{'hour':_0x2360d0(0x201),'minute':_0x2360d0(0x201)})+'\x20'+_0x21dda4[_0x2360d0(0x1db)]+'\x20('+_0x21dda4[_0x2360d0(0x1ef)]+')')[_0x2360d0(0x208)]('\x0a'),_0x47de9f='\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20'+_0x312bbe+_0x2360d0(0x23d)+_0x5c6efc+'\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x52960a=await _0x50b57a[_0x2360d0(0x24f)][_0x2360d0(0x25d)](_0x47de9f),_0x452243=_0x52960a['response'][_0x2360d0(0x1fb)](),_0x274255=_0x5d6cce===_0x2360d0(0x24c)?_0x2360d0(0x225):'analysis.health.geminiDay';await _0x50b57a[_0x2360d0(0x23c)](_0x274255,{'val':_0x452243,'ack':!![]}),_0x50b57a[_0x2360d0(0x24d)][_0x2360d0(0x1f2)](_0x2360d0(0x234)+_0x5d6cce+')\x20generated.');}catch(_0x47b5d5){_0x50b57a[_0x2360d0(0x24d)][_0x2360d0(0x1d8)](_0x2360d0(0x21a)+_0x47b5d5[_0x2360d0(0x1e1)]);}}function a0_0x5b77(_0x2aa606,_0x39146f){const _0x19dbee=a0_0x34e3();return a0_0x5b77=function(_0x513aee,_0xd8368b){_0x513aee=_0x513aee-0x1d2;let _0x34e3ff=_0x19dbee[_0x513aee];return _0x34e3ff;},a0_0x5b77(_0x2aa606,_0x39146f);}module[a0_0x16dd05(0x240)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};