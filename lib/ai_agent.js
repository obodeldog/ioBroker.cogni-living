const a0_0x662825=a0_0x206f;(function(_0xeb8fe1,_0x19ac58){const _0x3507d5=a0_0x206f,_0xc744f1=_0xeb8fe1();while(!![]){try{const _0x1ae4fe=-parseInt(_0x3507d5(0x1d1))/0x1+parseInt(_0x3507d5(0x1e9))/0x2*(parseInt(_0x3507d5(0x1b4))/0x3)+parseInt(_0x3507d5(0x205))/0x4*(-parseInt(_0x3507d5(0x190))/0x5)+-parseInt(_0x3507d5(0x1e2))/0x6+parseInt(_0x3507d5(0x1c5))/0x7*(parseInt(_0x3507d5(0x209))/0x8)+-parseInt(_0x3507d5(0x1cc))/0x9*(parseInt(_0x3507d5(0x187))/0xa)+parseInt(_0x3507d5(0x1ce))/0xb;if(_0x1ae4fe===_0x19ac58)break;else _0xc744f1['push'](_0xc744f1['shift']());}catch(_0x5af8c0){_0xc744f1['push'](_0xc744f1['shift']());}}}(a0_0x270f,0x72bbf));const a0_0x858edd=(function(){let _0x4bba84=!![];return function(_0x12824d,_0x3d03fe){const _0x464adb=_0x4bba84?function(){const _0x2fe768=a0_0x206f;if(_0x3d03fe){const _0x5a7477=_0x3d03fe[_0x2fe768(0x197)](_0x12824d,arguments);return _0x3d03fe=null,_0x5a7477;}}:function(){};return _0x4bba84=![],_0x464adb;};}()),a0_0x153b41=a0_0x858edd(this,function(){const _0x2dfbd0=a0_0x206f;return a0_0x153b41['toString']()[_0x2dfbd0(0x1ba)](_0x2dfbd0(0x1a7))[_0x2dfbd0(0x1ca)]()[_0x2dfbd0(0x192)](a0_0x153b41)[_0x2dfbd0(0x1ba)](_0x2dfbd0(0x1a7));});a0_0x153b41();'use strict';const {GoogleGenerativeAI}=require(a0_0x662825(0x1f2)),setup=require(a0_0x662825(0x1b8)),GEMINI_MODEL=a0_0x662825(0x18d),LTM_DP_DAILY_DIGESTS=a0_0x662825(0x199),LTM_DP_STATUS=a0_0x662825(0x1af),LTM_DP_RAW_LOG=a0_0x662825(0x19a),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x662825(0x1be),'senior_aal':a0_0x662825(0x1f0),'family':a0_0x662825(0x1f8),'single_comfort':'Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x662825(0x1b2)};function canCallApi(){const _0x10e434=Date['now']();return _0x10e434-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x166374=a0_0x662825;lastGlobalApiCall=Date[_0x166374(0x1bb)]();}function a0_0x270f(){const _0x179b61=['push','\x20=\x20','length','Â°C,\x20','models/gemini-flash-latest','log','livingContext','235ZYdtDO','sendNotification','constructor','warn','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','lastAlertState','\x0aAktivitÃ¤t:\x20','apply','info','LTM.dailyDigests','LTM.rawEventLog','analysis.automation.targetValue','baselineDrift','alertReason','debug','weatherInstance','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','BUTLER\x20Execution\x20Error:\x20','stringify','description','analysis.automation.autoApply','N/A\x20(Learning)','toLocaleTimeString','(((.+)+)+)+$','generateContent','\x20Ã¼bersprungen\x20(Auto-Approved).','LTM.driftAnalysis.driftDetails','approved','analysis.lastResult','currentSystemMode','ltmStbWindowDays','LTM.processingStatus','system.presenceWho','detected','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','getForeignStateAsync','453lFRHvn','setStateAsync','dailyDigests',').\x20Sending\x20notification...','./setup','analysisHistory','search','now','toISOString','ðŸŒ…\x20Morning\x20Briefing:\x0a','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','setForeignStateAsync','config','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','âš ï¸\x20ALARM:\x20','driftDetails','.\x20EMERGENCY:\x20','7uwcsxJ','pop','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','splice','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','toString','activityLevel','18WUDjYM','Wetterdaten\x20nicht\x20abrufbar','10690350JqNJQl','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','111649pDAItP','analysis.analysisHistory','\x0aSTB:\x20','.Current.Temperature','analysis.activitySummary','ltmLtbWindowDays','KI-Fehler\x20(Fallback)','targetValue','automationProposal','isAlert','\x20->\x20','Started...','Unbekannt','analysis.alertReason','rawEventLog',',\x20LichtverhÃ¤ltnisse:\x20','LTM.driftAnalysis.lastCheck','1781250LChiGB','Gemini\x20Error:\x20','LTM.driftAnalysis.baselineDrift',',\x20Wetter:\x20','replace','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','Unbekannt\x20(Kein\x20Sensor)','5378eaVxYx','parse','analysis.isAlert','timestamp','.\x20EVENTS:\x20','.\x20ANWESEND:\x20','response','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','Keine\x20Details.','@google/generative-ai','toFixed','Digest','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','Success','isProVersion','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','slice','Skipped\x20(Traffic)','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','val','Briefing\x20Error:\x20','send','aiPersona','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','error','unshift','trim','ANALYZE_HEALTH','79772WlrvZW','isEmergency','text','exports','6653176bcJhYB','analysis.automation.targetId','geminiModel','%)\x20nach\x20\x22','getStateAsync','.\x20KONTEXT:\x20','decision','message','.\x20SYSTEM_MODE:\x20','useWeather','summary','1968700gXhDlt','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22'];a0_0x270f=function(){return _0x179b61;};return a0_0x270f();}async function getWeatherContext(_0x4c5bbe){const _0x383dd2=a0_0x662825;if(!_0x4c5bbe[_0x383dd2(0x1c0)][_0x383dd2(0x185)]||!_0x4c5bbe[_0x383dd2(0x1c0)][_0x383dd2(0x19f)])return _0x383dd2(0x1e8);try{const _0x18b640=_0x4c5bbe[_0x383dd2(0x1c0)][_0x383dd2(0x19f)];let _0x19ba88=await _0x4c5bbe[_0x383dd2(0x1b3)](_0x18b640+_0x383dd2(0x1d4));if(!_0x19ba88)_0x19ba88=await _0x4c5bbe[_0x383dd2(0x1b3)](_0x18b640+'.forecast.current.temperature');let _0x5dad85=await _0x4c5bbe[_0x383dd2(0x1b3)](_0x18b640+'.Current.WeatherText');if(!_0x5dad85)_0x5dad85=await _0x4c5bbe[_0x383dd2(0x1b3)](_0x18b640+'.forecast.current.state');let _0xb8de='Unbekannt';const _0x440d7b=await _0x4c5bbe['getForeignStateAsync'](_0x18b640+'.Current.IsNight');if(_0x440d7b)_0xb8de=_0x440d7b[_0x383dd2(0x1fc)]?'Nacht':'Tag';if(_0x19ba88&&_0x5dad85)return _0x19ba88[_0x383dd2(0x1fc)]+_0x383dd2(0x18c)+_0x5dad85[_0x383dd2(0x1fc)]+_0x383dd2(0x1e0)+_0xb8de;}catch(_0x2dc46a){}return _0x383dd2(0x1cd);}async function consultButler(_0x2fd3a1,_0x3505cc,_0x42671c,_0xa0c945){const _0x5497f6=a0_0x662825;if(!_0x2fd3a1['geminiModel'])return{'approved':!![],'reason':'KI\x20offline\x20(Fallback)'};const _0x530c47=Date[_0x5497f6(0x1bb)]();if(decisionCache[_0x3505cc]&&_0x530c47-decisionCache[_0x3505cc][_0x5497f6(0x1ec)]<CACHE_TTL_MS){const _0x2b6b44=decisionCache[_0x3505cc][_0x5497f6(0x20f)];return _0x2fd3a1[_0x5497f6(0x18e)][_0x5497f6(0x19e)]('ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20'+_0x3505cc+_0x5497f6(0x1db)+(_0x2b6b44[_0x5497f6(0x1ab)]?'OK':'NO')+'\x20('+_0x2b6b44['reason']+')'),_0x2b6b44;}if(!canCallApi())return _0x2fd3a1['log'][_0x5497f6(0x19e)]('ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20'+_0x3505cc+_0x5497f6(0x1a9)),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x151567=new Date()[_0x5497f6(0x1a6)](),_0xc2937f=await getWeatherContext(_0x2fd3a1),_0x4c6117=PERSONA_MAPPING[_0x2fd3a1['config'][_0x5497f6(0x1ff)]||'generic'],_0x30dd58=_0x5497f6(0x1c7)+_0x151567+_0x5497f6(0x1e5)+_0xc2937f+_0x5497f6(0x1f5)+(_0xa0c945*0x64)[_0x5497f6(0x1f3)](0x0)+_0x5497f6(0x20c)+_0x3505cc+_0x5497f6(0x188)+_0x42671c+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x4c6117+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x104510=await _0x2fd3a1[_0x5497f6(0x20b)][_0x5497f6(0x1a8)](_0x30dd58),_0x52100d=_0x104510['response']['text']()['replace'](/```json|```/g,'')[_0x5497f6(0x203)](),_0x14bba8=JSON[_0x5497f6(0x1ea)](_0x52100d);return decisionCache[_0x3505cc]={'decision':_0x14bba8,'timestamp':_0x530c47},_0x14bba8;}catch(_0x496503){return _0x2fd3a1[_0x5497f6(0x18e)][_0x5497f6(0x193)](_0x5497f6(0x1fb)+_0x496503[_0x5497f6(0x183)]),decisionCache[_0x3505cc]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x530c47-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x5497f6(0x1d7)};}}async function runGeminiAnalysis(_0x54112a,_0x5174b5=''){const _0x53e5ab=a0_0x662825;if(!_0x54112a[_0x53e5ab(0x20b)])return;if(!canCallApi()){_0x54112a[_0x53e5ab(0x18e)]['debug'](_0x53e5ab(0x194));return;}if(_0x54112a['eventHistory'][_0x53e5ab(0x18b)]===0x0)return;const _0x194d3e=_0x54112a['eventHistory']['slice'](0x0,0xf),_0x153580=_0x54112a[_0x53e5ab(0x1ad)],_0x2282bf=PERSONA_MAPPING[_0x54112a[_0x53e5ab(0x1c0)][_0x53e5ab(0x1ff)]||'generic'],_0x183f51=_0x54112a[_0x53e5ab(0x1c0)][_0x53e5ab(0x18f)]||_0x53e5ab(0x1f1);let _0x2ea5a1=_0x53e5ab(0x1dd);try{const _0x1f42ea=await _0x54112a['getStateAsync'](_0x53e5ab(0x1b0));if(_0x1f42ea&&_0x1f42ea[_0x53e5ab(0x1fc)])_0x2ea5a1=_0x1f42ea[_0x53e5ab(0x1fc)];}catch(_0x14596b){}let _0x20e35f=![];try{const _0x20cd43=await _0x54112a[_0x53e5ab(0x20d)](_0x53e5ab(0x1a4));if(_0x20cd43&&_0x20cd43['val'])_0x20e35f=!![];}catch(_0x51121d){}const _0x55e584=_0x53e5ab(0x1cf)+_0x2282bf+_0x53e5ab(0x20e)+_0x183f51+_0x53e5ab(0x184)+_0x153580+_0x53e5ab(0x1ee)+_0x2ea5a1+_0x53e5ab(0x1ed)+JSON[_0x53e5ab(0x1a2)](_0x194d3e)+_0x53e5ab(0x1c4)+_0x5174b5+_0x53e5ab(0x1e7);try{updateApiTimestamp();const _0x3e62a6=await _0x54112a['geminiModel'][_0x53e5ab(0x1a8)](_0x55e584),_0x3afebe=JSON[_0x53e5ab(0x1ea)](_0x3e62a6[_0x53e5ab(0x1ef)][_0x53e5ab(0x207)]()[_0x53e5ab(0x1e6)](/```json|```/g,'')[_0x53e5ab(0x203)]());await _0x54112a[_0x53e5ab(0x1b5)](_0x53e5ab(0x1ac),{'val':JSON[_0x53e5ab(0x1a2)](_0x3afebe),'ack':!![]});if(_0x3afebe['summary'])await _0x54112a[_0x53e5ab(0x1b5)](_0x53e5ab(0x1d5),{'val':_0x3afebe[_0x53e5ab(0x186)],'ack':!![]});const _0x25b72e={'timestamp':Date['now'](),'id':Date[_0x53e5ab(0x1bb)]()[_0x53e5ab(0x1ca)](),'analysis':{'activity':{'summary':_0x3afebe[_0x53e5ab(0x186)],'isAlert':_0x3afebe[_0x53e5ab(0x1da)],'alertReason':_0x3afebe[_0x53e5ab(0x19d)]},'comfort':{'automationProposal':_0x3afebe[_0x53e5ab(0x1d9)]}}};_0x54112a[_0x53e5ab(0x1b9)][_0x53e5ab(0x202)](_0x25b72e);if(_0x54112a[_0x53e5ab(0x1b9)][_0x53e5ab(0x18b)]>0x32)_0x54112a['analysisHistory'][_0x53e5ab(0x1c6)]();await _0x54112a[_0x53e5ab(0x1b5)](_0x53e5ab(0x1d2),{'val':JSON[_0x53e5ab(0x1a2)](_0x54112a[_0x53e5ab(0x1b9)]),'ack':!![]});const _0x22ec4c=_0x3afebe[_0x53e5ab(0x1da)]||![];_0x22ec4c!==_0x54112a[_0x53e5ab(0x195)]&&(await _0x54112a[_0x53e5ab(0x1b5)](_0x53e5ab(0x1eb),{'val':_0x22ec4c,'ack':!![]}),_0x54112a[_0x53e5ab(0x195)]=_0x22ec4c,_0x22ec4c&&(await _0x54112a[_0x53e5ab(0x1b5)](_0x53e5ab(0x1de),{'val':_0x3afebe['alertReason'],'ack':!![]}),setup[_0x53e5ab(0x191)](_0x54112a,_0x53e5ab(0x1c2)+_0x3afebe[_0x53e5ab(0x19d)],![],_0x3afebe[_0x53e5ab(0x206)])));if(_0x3afebe[_0x53e5ab(0x1d9)]&&_0x3afebe['automationProposal'][_0x53e5ab(0x1b1)]){await _0x54112a['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x54112a['setStateAsync']('analysis.automation.description',{'val':_0x3afebe[_0x53e5ab(0x1d9)][_0x53e5ab(0x1a3)],'ack':!![]}),await _0x54112a[_0x53e5ab(0x1b5)](_0x53e5ab(0x20a),{'val':_0x3afebe[_0x53e5ab(0x1d9)]['targetId'],'ack':!![]}),await _0x54112a[_0x53e5ab(0x1b5)]('analysis.automation.targetValue',{'val':JSON[_0x53e5ab(0x1a2)](_0x3afebe[_0x53e5ab(0x1d9)][_0x53e5ab(0x1d8)]),'ack':!![]});if(_0x20e35f)executeAutomationAction(_0x54112a);}}catch(_0x1eb1b2){_0x54112a[_0x53e5ab(0x18e)][_0x53e5ab(0x201)](_0x53e5ab(0x1e3)+_0x1eb1b2['message']);}}async function createDailyDigest(_0x14fbe1,_0x4f0940){const _0x702e82=a0_0x662825;if(!_0x14fbe1['isProVersion'])return;if(!canCallApi()){await _0x14fbe1[_0x702e82(0x1b5)](LTM_DP_STATUS,{'val':_0x702e82(0x1fa),'ack':!![]});return;}await _0x14fbe1['setStateAsync'](LTM_DP_STATUS,{'val':_0x702e82(0x1dc),'ack':!![]});if(!_0x14fbe1[_0x702e82(0x20b)]||_0x14fbe1[_0x702e82(0x1df)][_0x702e82(0x18b)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x14fbe1[_0x702e82(0x1b5)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x3ffe39=JSON[_0x702e82(0x1ea)](JSON[_0x702e82(0x1a2)](_0x14fbe1['rawEventLog'])),_0x4447dc=_0x3ffe39['length'],_0x84ae2a=_0x702e82(0x1c9)+JSON[_0x702e82(0x1a2)](_0x3ffe39);try{updateApiTimestamp();const _0x292fea=await _0x14fbe1[_0x702e82(0x20b)][_0x702e82(0x1a8)](_0x84ae2a),_0x2d1f5c=JSON[_0x702e82(0x1ea)](_0x292fea['response'][_0x702e82(0x207)]()[_0x702e82(0x1e6)](/```json|```/g,'')[_0x702e82(0x203)]()),_0x421040={'timestamp':new Date()[_0x702e82(0x1bc)](),'eventCount':_0x4447dc,'summary':_0x2d1f5c['summary']||_0x702e82(0x1f4),'activityLevel':_0x2d1f5c['activityLevel']||'normal','systemMode':_0x14fbe1[_0x702e82(0x1ad)]};_0x14fbe1[_0x702e82(0x1b6)][_0x702e82(0x189)](_0x421040);const _0x3f46a0=_0x14fbe1[_0x702e82(0x1c0)][_0x702e82(0x1d6)]||0x3c;_0x14fbe1[_0x702e82(0x1b6)][_0x702e82(0x18b)]>_0x3f46a0&&_0x14fbe1[_0x702e82(0x1b6)][_0x702e82(0x1c8)](0x0,_0x14fbe1['dailyDigests'][_0x702e82(0x18b)]-_0x3f46a0);await _0x14fbe1[_0x702e82(0x1b5)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x702e82(0x1a2)](_0x14fbe1[_0x702e82(0x1b6)]),'ack':!![]}),_0x14fbe1[_0x702e82(0x1df)]=[],await _0x14fbe1[_0x702e82(0x1b5)](LTM_DP_RAW_LOG,{'val':JSON[_0x702e82(0x1a2)](_0x14fbe1[_0x702e82(0x1df)]),'ack':!![]}),await _0x14fbe1[_0x702e82(0x1b5)](LTM_DP_STATUS,{'val':_0x702e82(0x1f6),'ack':!![]});const _0x9d04b='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x2d1f5c[_0x702e82(0x186)]+_0x702e82(0x196)+_0x2d1f5c[_0x702e82(0x1cb)];setup[_0x702e82(0x191)](_0x14fbe1,_0x9d04b,![],![]);if(_0x14fbe1[_0x702e82(0x1f7)]&&_0x4f0940)_0x4f0940[_0x702e82(0x1fe)](_0x14fbe1,_0x702e82(0x204),{'digest':_0x421040});}catch(_0x3d51de){_0x14fbe1['log'][_0x702e82(0x201)](_0x3d51de['message']);}}function a0_0x206f(_0x45a2a3,_0xef78f3){const _0x31c25a=a0_0x270f();return a0_0x206f=function(_0x153b41,_0x858edd){_0x153b41=_0x153b41-0x183;let _0x270f33=_0x31c25a[_0x153b41];return _0x270f33;},a0_0x206f(_0x45a2a3,_0xef78f3);}async function runBaselineDriftAnalysis(_0x1a781a){const _0x52e3ff=a0_0x662825;if(!_0x1a781a[_0x52e3ff(0x1f7)]||!_0x1a781a[_0x52e3ff(0x20b)])return;if(!canCallApi())return;const _0x7ccae4=_0x1a781a[_0x52e3ff(0x1c0)][_0x52e3ff(0x1ae)]||0xe;if(_0x1a781a['dailyDigests'][_0x52e3ff(0x18b)]<_0x7ccae4+0x7){await _0x1a781a[_0x52e3ff(0x1b5)](_0x52e3ff(0x1e4),{'val':_0x52e3ff(0x1a5),'ack':!![]});return;}const _0x31db14=_0x1a781a['dailyDigests'][_0x52e3ff(0x1f9)](-_0x7ccae4),_0x357f24=_0x1a781a['dailyDigests'][_0x52e3ff(0x1f9)](0x0,_0x1a781a['dailyDigests'][_0x52e3ff(0x18b)]-_0x7ccae4),_0x4338c6='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x52e3ff(0x1a2)](_0x357f24)+_0x52e3ff(0x1d3)+JSON[_0x52e3ff(0x1a2)](_0x31db14);try{updateApiTimestamp();const _0x17d5bf=await _0x1a781a['geminiModel'][_0x52e3ff(0x1a8)](_0x4338c6),_0x340c44=JSON[_0x52e3ff(0x1ea)](_0x17d5bf[_0x52e3ff(0x1ef)]['text']()[_0x52e3ff(0x1e6)](/```json|```/g,'')[_0x52e3ff(0x203)]());_0x340c44[_0x52e3ff(0x19c)]&&(await _0x1a781a[_0x52e3ff(0x1b5)](_0x52e3ff(0x1e4),{'val':_0x340c44[_0x52e3ff(0x19c)],'ack':!![]}),await _0x1a781a[_0x52e3ff(0x1b5)](_0x52e3ff(0x1aa),{'val':_0x340c44[_0x52e3ff(0x1c3)],'ack':!![]}),await _0x1a781a[_0x52e3ff(0x1b5)](_0x52e3ff(0x1e1),{'val':Date[_0x52e3ff(0x1bb)](),'ack':!![]}));}catch(_0x11c04e){}}async function executeAutomationAction(_0x2074d0){const _0x3dfd33=a0_0x662825;try{const _0x41055e=await _0x2074d0[_0x3dfd33(0x20d)]('analysis.automation.targetId'),_0x29cd73=await _0x2074d0['getStateAsync'](_0x3dfd33(0x19b));if(_0x41055e&&_0x41055e['val']&&_0x29cd73){const _0xaeb4cb=_0x41055e[_0x3dfd33(0x1fc)];let _0x451f76=_0x29cd73[_0x3dfd33(0x1fc)];try{_0x451f76=JSON[_0x3dfd33(0x1ea)](_0x451f76);}catch(_0x1c244b){}_0x2074d0[_0x3dfd33(0x18e)][_0x3dfd33(0x198)](_0x3dfd33(0x1c1)+_0xaeb4cb+_0x3dfd33(0x18a)+_0x451f76),await _0x2074d0[_0x3dfd33(0x1bf)](_0xaeb4cb,_0x451f76);}else _0x2074d0['log']['warn'](_0x3dfd33(0x200));}catch(_0x243c3f){_0x2074d0[_0x3dfd33(0x18e)][_0x3dfd33(0x201)](_0x3dfd33(0x1a1)+_0x243c3f[_0x3dfd33(0x183)]);}}async function sendMorningBriefing(_0x30281d){const _0x24896b=a0_0x662825;if(!_0x30281d[_0x24896b(0x20b)]){_0x30281d[_0x24896b(0x18e)]['warn'](_0x24896b(0x1a0));return;}_0x30281d[_0x24896b(0x18e)][_0x24896b(0x198)](_0x24896b(0x1d0));try{updateApiTimestamp();const _0x2f5b48='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x1b0201=await _0x30281d[_0x24896b(0x20b)]['generateContent'](_0x2f5b48),_0x564a4c=_0x1b0201[_0x24896b(0x1ef)][_0x24896b(0x207)]();_0x30281d[_0x24896b(0x18e)][_0x24896b(0x198)]('ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20'+_0x564a4c[_0x24896b(0x18b)]+_0x24896b(0x1b7)),setup[_0x24896b(0x191)](_0x30281d,_0x24896b(0x1bd)+_0x564a4c);}catch(_0x3fdd1c){_0x30281d[_0x24896b(0x18e)][_0x24896b(0x201)](_0x24896b(0x1fd)+_0x3fdd1c[_0x24896b(0x183)]);}}module[a0_0x662825(0x208)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};