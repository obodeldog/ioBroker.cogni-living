const a0_0x3d2d1e=a0_0x90aa;(function(_0x145281,_0x2f613b){const _0x35d8a8=a0_0x90aa,_0x3e157a=_0x145281();while(!![]){try{const _0x1c2557=parseInt(_0x35d8a8(0xc3))/0x1*(-parseInt(_0x35d8a8(0xf5))/0x2)+parseInt(_0x35d8a8(0x106))/0x3*(-parseInt(_0x35d8a8(0x11f))/0x4)+parseInt(_0x35d8a8(0xcf))/0x5+parseInt(_0x35d8a8(0x139))/0x6*(parseInt(_0x35d8a8(0x107))/0x7)+parseInt(_0x35d8a8(0x11c))/0x8*(-parseInt(_0x35d8a8(0x133))/0x9)+-parseInt(_0x35d8a8(0x123))/0xa*(-parseInt(_0x35d8a8(0xde))/0xb)+parseInt(_0x35d8a8(0xe0))/0xc;if(_0x1c2557===_0x2f613b)break;else _0x3e157a['push'](_0x3e157a['shift']());}catch(_0x4e4f2f){_0x3e157a['push'](_0x3e157a['shift']());}}}(a0_0x3fce,0xed74b));const a0_0x4da921=(function(){let _0x54ce56=!![];return function(_0x28ee77,_0x45fe93){const _0x12bc99=_0x54ce56?function(){const _0x1bf77a=a0_0x90aa;if(_0x45fe93){const _0x5501fd=_0x45fe93[_0x1bf77a(0x115)](_0x28ee77,arguments);return _0x45fe93=null,_0x5501fd;}}:function(){};return _0x54ce56=![],_0x12bc99;};}()),a0_0x427cb4=a0_0x4da921(this,function(){const _0x16f490=a0_0x90aa;return a0_0x427cb4[_0x16f490(0x103)]()[_0x16f490(0x137)](_0x16f490(0xc5))['toString']()[_0x16f490(0x119)](a0_0x427cb4)[_0x16f490(0x137)](_0x16f490(0xc5));});a0_0x427cb4();'use strict';const {GoogleGenerativeAI}=require(a0_0x3d2d1e(0xc6)),setup=require(a0_0x3d2d1e(0xbf)),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x3d2d1e(0x129),LTM_DP_STATUS=a0_0x3d2d1e(0xd7),LTM_DP_RAW_LOG=a0_0x3d2d1e(0x142),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x3d2d1e(0x136),'senior_aal':a0_0x3d2d1e(0xe6),'family':a0_0x3d2d1e(0xfd),'single_comfort':a0_0x3d2d1e(0x12a),'security':a0_0x3d2d1e(0xc1),'energy_saver':a0_0x3d2d1e(0x10a)};function canCallApi(){const _0x2da5b5=Date['now']();return _0x2da5b5-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x39501=a0_0x3d2d1e;lastGlobalApiCall=Date[_0x39501(0x125)]();}async function getWeatherContext(_0x3310de){const _0x434501=a0_0x3d2d1e;if(!_0x3310de[_0x434501(0xe5)]['useWeather']||!_0x3310de[_0x434501(0xe5)][_0x434501(0x12b)])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x4e6fdd=_0x3310de[_0x434501(0xe5)]['weatherInstance'];let _0x146a8d=await _0x3310de[_0x434501(0xe9)](_0x4e6fdd+_0x434501(0xe1));if(!_0x146a8d)_0x146a8d=await _0x3310de[_0x434501(0xe9)](_0x4e6fdd+_0x434501(0xf3));let _0x956f38=await _0x3310de['getForeignStateAsync'](_0x4e6fdd+_0x434501(0xc7));if(!_0x956f38)_0x956f38=await _0x3310de['getForeignStateAsync'](_0x4e6fdd+_0x434501(0x124));let _0x45a7b9=_0x434501(0x13a);const _0xeb2359=await _0x3310de[_0x434501(0xe9)](_0x4e6fdd+'.Current.IsNight');if(_0xeb2359)_0x45a7b9=_0xeb2359[_0x434501(0xcb)]?'Nacht':'Tag';if(_0x146a8d&&_0x956f38)return _0x146a8d[_0x434501(0xcb)]+_0x434501(0xed)+_0x956f38[_0x434501(0xcb)]+_0x434501(0xd1)+_0x45a7b9;}catch(_0x2d6368){}return _0x434501(0x120);}function a0_0x90aa(_0x4967ca,_0x581b8b){const _0x326e95=a0_0x3fce();return a0_0x90aa=function(_0x427cb4,_0x4da921){_0x427cb4=_0x427cb4-0xbe;let _0x3fcee6=_0x326e95[_0x427cb4];return _0x3fcee6;},a0_0x90aa(_0x4967ca,_0x581b8b);}async function consultButler(_0x3f71f8,_0x41897a,_0x2b6465,_0x545add){const _0x233dea=a0_0x3d2d1e;if(!_0x3f71f8[_0x233dea(0xdf)])return{'approved':!![],'reason':_0x233dea(0xc4)};const _0x363f81=Date[_0x233dea(0x125)]();if(decisionCache[_0x41897a]&&_0x363f81-decisionCache[_0x41897a][_0x233dea(0xee)]<CACHE_TTL_MS){const _0x2e65d6=decisionCache[_0x41897a][_0x233dea(0x11d)];return _0x3f71f8[_0x233dea(0x108)][_0x233dea(0x13b)](_0x233dea(0xdc)+_0x41897a+_0x233dea(0xeb)+(_0x2e65d6[_0x233dea(0xf0)]?'OK':'NO')+'\x20('+_0x2e65d6[_0x233dea(0x11e)]+')'),_0x2e65d6;}if(!canCallApi())return _0x3f71f8[_0x233dea(0x108)][_0x233dea(0x13b)](_0x233dea(0x141)+_0x41897a+_0x233dea(0x100)),{'approved':!![],'reason':_0x233dea(0x117)};const _0x387179=new Date()['toLocaleTimeString'](),_0x4258c4=await getWeatherContext(_0x3f71f8),_0x44bf17=PERSONA_MAPPING[_0x3f71f8[_0x233dea(0xe5)][_0x233dea(0x146)]||'generic'],_0x269868=_0x233dea(0xc8)+_0x387179+_0x233dea(0x105)+_0x4258c4+_0x233dea(0x109)+(_0x545add*0x64)[_0x233dea(0xc2)](0x0)+'%)\x20nach\x20\x22'+_0x41897a+_0x233dea(0xe2)+_0x2b6465+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x44bf17+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x363c11=await _0x3f71f8[_0x233dea(0xdf)][_0x233dea(0x10b)](_0x269868),_0x21b986=_0x363c11['response']['text']()['replace'](/```json|```/g,'')['trim'](),_0x3cb4fb=JSON['parse'](_0x21b986);return decisionCache[_0x41897a]={'decision':_0x3cb4fb,'timestamp':_0x363f81},_0x3cb4fb;}catch(_0x2706b2){return _0x3f71f8[_0x233dea(0x108)][_0x233dea(0x145)]('ðŸ¤–\x20Butler\x20Brain\x20Error:\x20'+_0x2706b2[_0x233dea(0x11a)]),decisionCache[_0x41897a]={'decision':{'approved':!![],'reason':_0x233dea(0x135)},'timestamp':_0x363f81-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'};}}async function runGeminiAnalysis(_0x2ebc2a,_0x49da2d=''){const _0x58e6ea=a0_0x3d2d1e;if(!_0x2ebc2a[_0x58e6ea(0xdf)])return;if(!canCallApi()){_0x2ebc2a[_0x58e6ea(0x108)]['debug']('ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x2ebc2a['eventHistory'][_0x58e6ea(0xc0)]===0x0)return;const _0x334a89=_0x2ebc2a[_0x58e6ea(0x104)][_0x58e6ea(0xd0)](0x0,0xf),_0x43d468=_0x2ebc2a[_0x58e6ea(0x102)],_0x18ae19=PERSONA_MAPPING[_0x2ebc2a[_0x58e6ea(0xe5)]['aiPersona']||_0x58e6ea(0xc9)],_0x572f3a=_0x2ebc2a[_0x58e6ea(0xe5)]['livingContext']||_0x58e6ea(0xcd);let _0x3e29e7=_0x58e6ea(0x13a);try{const _0x90126f=await _0x2ebc2a[_0x58e6ea(0xe8)]('system.presenceWho');if(_0x90126f&&_0x90126f[_0x58e6ea(0xcb)])_0x3e29e7=_0x90126f[_0x58e6ea(0xcb)];}catch(_0xd0dbcf){}let _0x2ca8d5=![];try{const _0x64a9e4=await _0x2ebc2a[_0x58e6ea(0xe8)](_0x58e6ea(0x116));if(_0x64a9e4&&_0x64a9e4['val'])_0x2ca8d5=!![];}catch(_0xca69c8){}const _0x5504ba=_0x58e6ea(0xea)+_0x18ae19+_0x58e6ea(0x143)+_0x572f3a+_0x58e6ea(0x132)+_0x43d468+_0x58e6ea(0x101)+_0x3e29e7+_0x58e6ea(0xf9)+JSON[_0x58e6ea(0xec)](_0x334a89)+'.\x20EMERGENCY:\x20'+_0x49da2d+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x1bc34a=await _0x2ebc2a['geminiModel'][_0x58e6ea(0x10b)](_0x5504ba),_0xceda78=JSON['parse'](_0x1bc34a[_0x58e6ea(0xf2)]['text']()[_0x58e6ea(0x13e)](/```json|```/g,'')[_0x58e6ea(0x113)]());await _0x2ebc2a[_0x58e6ea(0x131)]('analysis.lastResult',{'val':JSON['stringify'](_0xceda78),'ack':!![]});if(_0xceda78['summary'])await _0x2ebc2a['setStateAsync'](_0x58e6ea(0x13f),{'val':_0xceda78[_0x58e6ea(0xfb)],'ack':!![]});const _0x108631={'timestamp':Date[_0x58e6ea(0x125)](),'id':Date[_0x58e6ea(0x125)]()[_0x58e6ea(0x103)](),'analysis':{'activity':{'summary':_0xceda78[_0x58e6ea(0xfb)],'isAlert':_0xceda78[_0x58e6ea(0x12e)],'alertReason':_0xceda78[_0x58e6ea(0xfc)]},'comfort':{'automationProposal':_0xceda78[_0x58e6ea(0x13c)]}}};_0x2ebc2a[_0x58e6ea(0x10e)][_0x58e6ea(0x138)](_0x108631);if(_0x2ebc2a[_0x58e6ea(0x10e)][_0x58e6ea(0xc0)]>0x32)_0x2ebc2a[_0x58e6ea(0x10e)][_0x58e6ea(0x110)]();await _0x2ebc2a['setStateAsync']('analysis.analysisHistory',{'val':JSON[_0x58e6ea(0xec)](_0x2ebc2a[_0x58e6ea(0x10e)]),'ack':!![]});const _0x4f7259=_0xceda78['isAlert']||![];_0x4f7259!==_0x2ebc2a[_0x58e6ea(0x11b)]&&(await _0x2ebc2a[_0x58e6ea(0x131)]('analysis.isAlert',{'val':_0x4f7259,'ack':!![]}),_0x2ebc2a[_0x58e6ea(0x11b)]=_0x4f7259,_0x4f7259&&(await _0x2ebc2a[_0x58e6ea(0x131)]('analysis.alertReason',{'val':_0xceda78[_0x58e6ea(0xfc)],'ack':!![]}),setup[_0x58e6ea(0x112)](_0x2ebc2a,_0x58e6ea(0x122)+_0xceda78[_0x58e6ea(0xfc)],![],_0xceda78['isEmergency'])));if(_0xceda78[_0x58e6ea(0x13c)]&&_0xceda78[_0x58e6ea(0x13c)][_0x58e6ea(0x127)]){await _0x2ebc2a['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x2ebc2a[_0x58e6ea(0x131)](_0x58e6ea(0xd6),{'val':_0xceda78[_0x58e6ea(0x13c)][_0x58e6ea(0xf8)],'ack':!![]}),await _0x2ebc2a['setStateAsync'](_0x58e6ea(0x130),{'val':_0xceda78[_0x58e6ea(0x13c)][_0x58e6ea(0x10f)],'ack':!![]}),await _0x2ebc2a[_0x58e6ea(0x131)](_0x58e6ea(0xd5),{'val':JSON[_0x58e6ea(0xec)](_0xceda78[_0x58e6ea(0x13c)][_0x58e6ea(0x13d)]),'ack':!![]});if(_0x2ca8d5)executeAutomationAction(_0x2ebc2a);}}catch(_0x292bca){_0x2ebc2a[_0x58e6ea(0x108)]['error'](_0x58e6ea(0x140)+_0x292bca[_0x58e6ea(0x11a)]);}}async function createDailyDigest(_0x54e975,_0xdf737a){const _0x32f35d=a0_0x3d2d1e;if(!_0x54e975['isProVersion'])return;if(!canCallApi()){await _0x54e975['setStateAsync'](LTM_DP_STATUS,{'val':_0x32f35d(0xdd),'ack':!![]});return;}await _0x54e975[_0x32f35d(0x131)](LTM_DP_STATUS,{'val':_0x32f35d(0xf7),'ack':!![]});if(!_0x54e975['geminiModel']||_0x54e975[_0x32f35d(0xff)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x54e975[_0x32f35d(0x131)](LTM_DP_STATUS,{'val':_0x32f35d(0x111),'ack':!![]});return;}const _0x2d139b=JSON[_0x32f35d(0x114)](JSON['stringify'](_0x54e975['rawEventLog'])),_0x397966=_0x2d139b[_0x32f35d(0xc0)],_0x50573f=_0x32f35d(0xe4)+JSON[_0x32f35d(0xec)](_0x2d139b);try{updateApiTimestamp();const _0x53cd5a=await _0x54e975[_0x32f35d(0xdf)]['generateContent'](_0x50573f),_0x207e02=JSON[_0x32f35d(0x114)](_0x53cd5a[_0x32f35d(0xf2)][_0x32f35d(0xdb)]()['replace'](/```json|```/g,'')[_0x32f35d(0x113)]()),_0x153846={'timestamp':new Date()[_0x32f35d(0xd8)](),'eventCount':_0x397966,'summary':_0x207e02[_0x32f35d(0xfb)]||_0x32f35d(0xd9),'activityLevel':_0x207e02[_0x32f35d(0x134)]||_0x32f35d(0xef),'systemMode':_0x54e975[_0x32f35d(0x102)]};_0x54e975[_0x32f35d(0x12d)]['push'](_0x153846);const _0x1140bb=_0x54e975[_0x32f35d(0xe5)][_0x32f35d(0xce)]||0x3c;_0x54e975[_0x32f35d(0x12d)][_0x32f35d(0xc0)]>_0x1140bb&&_0x54e975[_0x32f35d(0x12d)]['splice'](0x0,_0x54e975[_0x32f35d(0x12d)][_0x32f35d(0xc0)]-_0x1140bb);await _0x54e975[_0x32f35d(0x131)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x32f35d(0xec)](_0x54e975[_0x32f35d(0x12d)]),'ack':!![]}),_0x54e975[_0x32f35d(0xff)]=[],await _0x54e975[_0x32f35d(0x131)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x54e975[_0x32f35d(0xff)]),'ack':!![]}),await _0x54e975[_0x32f35d(0x131)](LTM_DP_STATUS,{'val':_0x32f35d(0xca),'ack':!![]});const _0x55912c='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x207e02[_0x32f35d(0xfb)]+_0x32f35d(0xe7)+_0x207e02[_0x32f35d(0x134)];setup[_0x32f35d(0x112)](_0x54e975,_0x55912c,![],![]);if(_0x54e975[_0x32f35d(0xd3)]&&_0xdf737a)_0xdf737a[_0x32f35d(0xd4)](_0x54e975,'ANALYZE_HEALTH',{'digest':_0x153846});}catch(_0x2a9ad8){_0x54e975[_0x32f35d(0x108)]['error'](_0x2a9ad8[_0x32f35d(0x11a)]);}}async function runBaselineDriftAnalysis(_0x5dd78f){const _0x371494=a0_0x3d2d1e;if(!_0x5dd78f['isProVersion']||!_0x5dd78f[_0x371494(0xdf)])return;if(!canCallApi())return;const _0x35d6e3=_0x5dd78f[_0x371494(0xe5)][_0x371494(0xf6)]||0xe;if(_0x5dd78f[_0x371494(0x12d)]['length']<_0x35d6e3+0x7){await _0x5dd78f[_0x371494(0x131)](_0x371494(0xda),{'val':_0x371494(0x10c),'ack':!![]});return;}const _0x18cf37=_0x5dd78f['dailyDigests'][_0x371494(0xd0)](-_0x35d6e3),_0x1f1cca=_0x5dd78f['dailyDigests']['slice'](0x0,_0x5dd78f[_0x371494(0x12d)][_0x371494(0xc0)]-_0x35d6e3),_0x12cc38=_0x371494(0x12c)+JSON[_0x371494(0xec)](_0x1f1cca)+'\x0aSTB:\x20'+JSON[_0x371494(0xec)](_0x18cf37);try{updateApiTimestamp();const _0x3fc34a=await _0x5dd78f[_0x371494(0xdf)][_0x371494(0x10b)](_0x12cc38),_0xc84897=JSON[_0x371494(0x114)](_0x3fc34a[_0x371494(0xf2)][_0x371494(0xdb)]()[_0x371494(0x13e)](/```json|```/g,'')[_0x371494(0x113)]());_0xc84897[_0x371494(0x118)]&&(await _0x5dd78f['setStateAsync'](_0x371494(0xda),{'val':_0xc84897[_0x371494(0x118)],'ack':!![]}),await _0x5dd78f[_0x371494(0x131)](_0x371494(0xfe),{'val':_0xc84897[_0x371494(0x121)],'ack':!![]}),await _0x5dd78f['setStateAsync'](_0x371494(0xf4),{'val':Date[_0x371494(0x125)](),'ack':!![]}));}catch(_0xab0391){}}function a0_0x3fce(){const _0x28f4bc=['Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','LTM.driftAnalysis.driftDetails','rawEventLog','\x20Ã¼bersprungen\x20(Auto-Approved).','.\x20ANWESEND:\x20','currentSystemMode','toString','eventHistory',',\x20Wetter:\x20','1158231GrRjhv','2965263dZndjq','log','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','generateContent','N/A\x20(Learning)','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','analysisHistory','targetId','pop','Skipped\x20(No\x20AI\x20or\x20Data)','sendNotification','trim','parse','apply','analysis.automation.autoApply','Traffic-Schutz\x20(Auto-Approved)','baselineDrift','constructor','message','lastAlertState','168UFriex','decision','reason','4FWYOLf','Wetterdaten\x20nicht\x20abrufbar','driftDetails','âš ï¸\x20ALARM:\x20','27020ZjQaxD','.forecast.current.state','now','error','detected','info','LTM.dailyDigests','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','weatherInstance','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','dailyDigests','isAlert','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','analysis.automation.targetId','setStateAsync','.\x20SYSTEM_MODE:\x20','723402sQuCiQ','activityLevel','KI-Fehler\x20(Fallback)','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','search','unshift','18RvhvUd','Unbekannt','debug','automationProposal','targetValue','replace','analysis.activitySummary','Gemini\x20Error:\x20','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','LTM.rawEventLog','.\x20KONTEXT:\x20','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','warn','aiPersona','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','./setup','length','Sicherheit\x20geht\x20vor.','toFixed','1717273YoKpUa','KI\x20offline\x20(Fallback)','(((.+)+)+)+$','@google/generative-ai','.Current.WeatherText','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','generic','Success','val','\x20=\x20','Keine\x20Details.','ltmLtbWindowDays','8932390kvXUyp','slice',',\x20LichtverhÃ¤ltnisse:\x20','BUTLER\x20Execution\x20Error:\x20','isProVersion','send','analysis.automation.targetValue','analysis.automation.description','LTM.processingStatus','toISOString','Digest','LTM.driftAnalysis.baselineDrift','text','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','Skipped\x20(Traffic)','781cqFmHo','geminiModel','18177120qmyllB','.Current.Temperature','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','Briefing\x20Error:\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','config','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','\x0aAktivitÃ¤t:\x20','getStateAsync','getForeignStateAsync','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','\x20->\x20','stringify','Â°C,\x20','timestamp','normal','approved','setForeignStateAsync','response','.forecast.current.temperature','LTM.driftAnalysis.lastCheck','2yOEeLm','ltmStbWindowDays','Started...','description','.\x20EVENTS:\x20',').\x20Sending\x20notification...','summary','alertReason'];a0_0x3fce=function(){return _0x28f4bc;};return a0_0x3fce();}async function executeAutomationAction(_0x2a9299){const _0x6945a3=a0_0x3d2d1e;try{const _0x279858=await _0x2a9299['getStateAsync'](_0x6945a3(0x130)),_0x2b077a=await _0x2a9299['getStateAsync'](_0x6945a3(0xd5));if(_0x279858&&_0x279858[_0x6945a3(0xcb)]&&_0x2b077a){const _0x30e99a=_0x279858['val'];let _0x31a58c=_0x2b077a['val'];try{_0x31a58c=JSON['parse'](_0x31a58c);}catch(_0x1dac3f){}_0x2a9299[_0x6945a3(0x108)][_0x6945a3(0x128)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x30e99a+_0x6945a3(0xcc)+_0x31a58c),await _0x2a9299[_0x6945a3(0xf1)](_0x30e99a,_0x31a58c);}else _0x2a9299[_0x6945a3(0x108)][_0x6945a3(0x145)](_0x6945a3(0x10d));}catch(_0xcfbbef){_0x2a9299[_0x6945a3(0x108)][_0x6945a3(0x126)](_0x6945a3(0xd2)+_0xcfbbef[_0x6945a3(0x11a)]);}}async function sendMorningBriefing(_0x4ee8ba){const _0x4f804a=a0_0x3d2d1e;if(!_0x4ee8ba[_0x4f804a(0xdf)]){_0x4ee8ba[_0x4f804a(0x108)][_0x4f804a(0x145)](_0x4f804a(0xbe));return;}_0x4ee8ba[_0x4f804a(0x108)][_0x4f804a(0x128)](_0x4f804a(0x12f));try{updateApiTimestamp();const _0x14ff6f='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x3ec78f=await _0x4ee8ba['geminiModel'][_0x4f804a(0x10b)](_0x14ff6f),_0x7b9cd8=_0x3ec78f[_0x4f804a(0xf2)][_0x4f804a(0xdb)]();_0x4ee8ba[_0x4f804a(0x108)][_0x4f804a(0x128)](_0x4f804a(0x144)+_0x7b9cd8[_0x4f804a(0xc0)]+_0x4f804a(0xfa)),setup['sendNotification'](_0x4ee8ba,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0x7b9cd8);}catch(_0x1555af){_0x4ee8ba[_0x4f804a(0x108)][_0x4f804a(0x126)](_0x4f804a(0xe3)+_0x1555af['message']);}}module['exports']={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};