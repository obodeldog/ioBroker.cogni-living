const a0_0x358eeb=a0_0x1395;(function(_0x44fe02,_0x3084e1){const _0x52c07c=a0_0x1395,_0x22811c=_0x44fe02();while(!![]){try{const _0x53e6e8=-parseInt(_0x52c07c(0x1e9))/0x1+-parseInt(_0x52c07c(0x1df))/0x2*(-parseInt(_0x52c07c(0x233))/0x3)+parseInt(_0x52c07c(0x1de))/0x4+parseInt(_0x52c07c(0x1f9))/0x5+parseInt(_0x52c07c(0x227))/0x6*(parseInt(_0x52c07c(0x1fb))/0x7)+-parseInt(_0x52c07c(0x1fd))/0x8+-parseInt(_0x52c07c(0x24a))/0x9*(parseInt(_0x52c07c(0x25c))/0xa);if(_0x53e6e8===_0x3084e1)break;else _0x22811c['push'](_0x22811c['shift']());}catch(_0x489ec7){_0x22811c['push'](_0x22811c['shift']());}}}(a0_0x2737,0xf04d3));const a0_0x517ca0=(function(){let _0x296325=!![];return function(_0x1d6d17,_0x316816){const _0xc9fd79=_0x296325?function(){const _0x16d1b6=a0_0x1395;if(_0x316816){const _0x1a2908=_0x316816[_0x16d1b6(0x234)](_0x1d6d17,arguments);return _0x316816=null,_0x1a2908;}}:function(){};return _0x296325=![],_0xc9fd79;};}()),a0_0x2d746f=a0_0x517ca0(this,function(){const _0x3e1141=a0_0x1395;return a0_0x2d746f[_0x3e1141(0x1e6)]()[_0x3e1141(0x210)](_0x3e1141(0x212))['toString']()[_0x3e1141(0x225)](a0_0x2d746f)['search'](_0x3e1141(0x212));});a0_0x2d746f();'use strict';const {GoogleGenerativeAI}=require(a0_0x358eeb(0x244)),setup=require(a0_0x358eeb(0x209)),GEMINI_MODEL=a0_0x358eeb(0x23f),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x358eeb(0x1dd),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x358eeb(0x1fe),'senior_aal':'PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':'Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','single_comfort':'Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','security':a0_0x358eeb(0x1d8),'energy_saver':'PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).'};function a0_0x1395(_0x4476ac,_0x36730a){const _0x5cba01=a0_0x2737();return a0_0x1395=function(_0x2d746f,_0x517ca0){_0x2d746f=_0x2d746f-0x1d2;let _0x273781=_0x5cba01[_0x2d746f];return _0x273781;},a0_0x1395(_0x4476ac,_0x36730a);}function canCallApi(){const _0x220327=a0_0x358eeb,_0x5021ae=Date[_0x220327(0x259)]();return _0x5021ae-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x39e087=a0_0x358eeb;lastGlobalApiCall=Date[_0x39e087(0x259)]();}async function getWeatherContext(_0x4df993){const _0x537716=a0_0x358eeb;if(!_0x4df993[_0x537716(0x21f)][_0x537716(0x203)]||!_0x4df993[_0x537716(0x21f)]['weatherInstance'])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x699ca9=_0x4df993['config'][_0x537716(0x21a)];let _0x588ed8=await _0x4df993[_0x537716(0x1e7)](_0x699ca9+_0x537716(0x252));if(!_0x588ed8)_0x588ed8=await _0x4df993[_0x537716(0x1e7)](_0x699ca9+'.forecast.current.temperature');let _0x58c241=await _0x4df993[_0x537716(0x1e7)](_0x699ca9+'.Current.WeatherText');if(!_0x58c241)_0x58c241=await _0x4df993[_0x537716(0x1e7)](_0x699ca9+'.forecast.current.state');let _0x4b7feb=_0x537716(0x25a);const _0x26f653=await _0x4df993[_0x537716(0x1e7)](_0x699ca9+_0x537716(0x22a));if(_0x26f653)_0x4b7feb=_0x26f653[_0x537716(0x246)]?_0x537716(0x25f):_0x537716(0x1e8);if(_0x588ed8&&_0x58c241)return _0x588ed8['val']+'¬∞C,\x20'+_0x58c241[_0x537716(0x246)]+_0x537716(0x1d4)+_0x4b7feb;}catch(_0x2ea249){}return _0x537716(0x24f);}async function consultButler(_0x3e10b8,_0x376747,_0x1ccd06,_0x5a7192){const _0x767618=a0_0x358eeb;if(!_0x3e10b8[_0x767618(0x1db)])return{'approved':!![],'reason':_0x767618(0x247)};const _0x193437=Date[_0x767618(0x259)]();if(decisionCache[_0x376747]&&_0x193437-decisionCache[_0x376747][_0x767618(0x21d)]<CACHE_TTL_MS){const _0x5c3df7=decisionCache[_0x376747]['decision'];return _0x3e10b8['log'][_0x767618(0x256)]('ü§ñ\x20Butler\x20Cache\x20Hit:\x20'+_0x376747+_0x767618(0x240)+(_0x5c3df7[_0x767618(0x1d5)]?'OK':'NO')+'\x20('+_0x5c3df7[_0x767618(0x205)]+')'),_0x5c3df7;}if(!canCallApi())return _0x3e10b8[_0x767618(0x218)]['debug']('ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20'+_0x376747+_0x767618(0x220)),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0xdd6f1b=new Date()[_0x767618(0x23b)](),_0x3c5857=await getWeatherContext(_0x3e10b8),_0x1409b4=PERSONA_MAPPING[_0x3e10b8[_0x767618(0x21f)][_0x767618(0x22d)]||'generic'],_0x548fda=_0x767618(0x1e4)+_0xdd6f1b+',\x20Wetter:\x20'+_0x3c5857+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x5a7192*0x64)[_0x767618(0x229)](0x0)+'%)\x20nach\x20\x22'+_0x376747+_0x767618(0x1e3)+_0x1ccd06+_0x767618(0x20d)+_0x1409b4+_0x767618(0x1fa);try{updateApiTimestamp();const _0x55e785=await _0x3e10b8[_0x767618(0x1db)][_0x767618(0x254)](_0x548fda),_0x5632a6=_0x55e785['response'][_0x767618(0x1ea)]()['replace'](/```json|```/g,'')[_0x767618(0x248)](),_0x1b80c7=JSON[_0x767618(0x260)](_0x5632a6);return decisionCache[_0x376747]={'decision':_0x1b80c7,'timestamp':_0x193437},_0x1b80c7;}catch(_0x4b4293){return _0x3e10b8[_0x767618(0x218)]['warn'](_0x767618(0x202)+_0x4b4293['message']),decisionCache[_0x376747]={'decision':{'approved':!![],'reason':_0x767618(0x245)},'timestamp':_0x193437-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x767618(0x245)};}}async function runGeminiAnalysis(_0x295716,_0x3c213c=''){const _0x1d81c7=a0_0x358eeb;if(!_0x295716['geminiModel'])return;if(!canCallApi()){_0x295716[_0x1d81c7(0x218)]['debug'](_0x1d81c7(0x219));return;}if(_0x295716[_0x1d81c7(0x20f)][_0x1d81c7(0x1d6)]===0x0)return;const _0x396fda=_0x295716[_0x1d81c7(0x20f)][_0x1d81c7(0x1ef)](0x0,0xf),_0x52c591=_0x295716['currentSystemMode'],_0x55d56f=PERSONA_MAPPING[_0x295716[_0x1d81c7(0x21f)][_0x1d81c7(0x22d)]||_0x1d81c7(0x206)],_0x555f72=_0x295716['config']['livingContext']||'Keine\x20Details.';let _0x147f4d=_0x1d81c7(0x25a);try{const _0x3ac10b=await _0x295716[_0x1d81c7(0x232)]('system.presenceWho');if(_0x3ac10b&&_0x3ac10b[_0x1d81c7(0x246)])_0x147f4d=_0x3ac10b[_0x1d81c7(0x246)];}catch(_0x38fd3c){}let _0x2922e7=![];try{const _0x151b6a=await _0x295716[_0x1d81c7(0x232)](_0x1d81c7(0x23e));if(_0x151b6a&&_0x151b6a['val'])_0x2922e7=!![];}catch(_0x2cbbd3){}const _0x3908f3=_0x1d81c7(0x237)+_0x55d56f+_0x1d81c7(0x228)+_0x555f72+'.\x20SYSTEM_MODE:\x20'+_0x52c591+_0x1d81c7(0x20c)+_0x147f4d+_0x1d81c7(0x235)+JSON[_0x1d81c7(0x207)](_0x396fda)+_0x1d81c7(0x255)+_0x3c213c+_0x1d81c7(0x261);try{updateApiTimestamp();const _0x3d32a9=await _0x295716[_0x1d81c7(0x1db)][_0x1d81c7(0x254)](_0x3908f3),_0x4f6bb6=JSON['parse'](_0x3d32a9[_0x1d81c7(0x265)]['text']()[_0x1d81c7(0x230)](/```json|```/g,'')[_0x1d81c7(0x248)]());await _0x295716[_0x1d81c7(0x24e)](_0x1d81c7(0x238),{'val':JSON[_0x1d81c7(0x207)](_0x4f6bb6),'ack':!![]});if(_0x4f6bb6['summary'])await _0x295716[_0x1d81c7(0x24e)](_0x1d81c7(0x1fc),{'val':_0x4f6bb6[_0x1d81c7(0x24d)],'ack':!![]});const _0x3e51dd={'timestamp':Date['now'](),'id':Date[_0x1d81c7(0x259)]()[_0x1d81c7(0x1e6)](),'analysis':{'activity':{'summary':_0x4f6bb6[_0x1d81c7(0x24d)],'isAlert':_0x4f6bb6[_0x1d81c7(0x21c)],'alertReason':_0x4f6bb6[_0x1d81c7(0x1f6)]},'comfort':{'automationProposal':_0x4f6bb6[_0x1d81c7(0x208)]}}};_0x295716[_0x1d81c7(0x250)][_0x1d81c7(0x216)](_0x3e51dd);if(_0x295716[_0x1d81c7(0x250)][_0x1d81c7(0x1d6)]>0x32)_0x295716[_0x1d81c7(0x250)][_0x1d81c7(0x1da)]();await _0x295716['setStateAsync'](_0x1d81c7(0x22f),{'val':JSON['stringify'](_0x295716[_0x1d81c7(0x250)]),'ack':!![]});const _0x2d5a19=_0x4f6bb6['isAlert']||![];_0x2d5a19!==_0x295716['lastAlertState']&&(await _0x295716[_0x1d81c7(0x24e)](_0x1d81c7(0x231),{'val':_0x2d5a19,'ack':!![]}),_0x295716[_0x1d81c7(0x215)]=_0x2d5a19,_0x2d5a19&&(await _0x295716[_0x1d81c7(0x24e)](_0x1d81c7(0x1ec),{'val':_0x4f6bb6[_0x1d81c7(0x1f6)],'ack':!![]}),setup[_0x1d81c7(0x22c)](_0x295716,_0x1d81c7(0x236)+_0x4f6bb6[_0x1d81c7(0x1f6)],![],_0x4f6bb6[_0x1d81c7(0x25d)])));if(_0x4f6bb6['automationProposal']&&_0x4f6bb6[_0x1d81c7(0x208)][_0x1d81c7(0x224)]){await _0x295716[_0x1d81c7(0x24e)](_0x1d81c7(0x1e1),{'val':!![],'ack':!![]}),await _0x295716[_0x1d81c7(0x24e)](_0x1d81c7(0x1d7),{'val':_0x4f6bb6[_0x1d81c7(0x208)][_0x1d81c7(0x223)],'ack':!![]}),await _0x295716[_0x1d81c7(0x24e)](_0x1d81c7(0x23a),{'val':_0x4f6bb6[_0x1d81c7(0x208)]['targetId'],'ack':!![]}),await _0x295716[_0x1d81c7(0x24e)](_0x1d81c7(0x22e),{'val':JSON[_0x1d81c7(0x207)](_0x4f6bb6[_0x1d81c7(0x208)][_0x1d81c7(0x257)]),'ack':!![]});if(_0x2922e7)executeAutomationAction(_0x295716);}}catch(_0x5e08f6){_0x295716['log'][_0x1d81c7(0x1f5)](_0x1d81c7(0x264)+_0x5e08f6[_0x1d81c7(0x23c)]);}}async function createDailyDigest(_0xbb6f9,_0x199565){const _0x48537d=a0_0x358eeb;if(!_0xbb6f9[_0x48537d(0x1d9)])return;if(!canCallApi()){await _0xbb6f9[_0x48537d(0x24e)](LTM_DP_STATUS,{'val':_0x48537d(0x20a),'ack':!![]});return;}await _0xbb6f9[_0x48537d(0x24e)](LTM_DP_STATUS,{'val':_0x48537d(0x20e),'ack':!![]});if(!_0xbb6f9['geminiModel']||_0xbb6f9['rawEventLog'][_0x48537d(0x1d6)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0xbb6f9[_0x48537d(0x24e)](LTM_DP_STATUS,{'val':_0x48537d(0x251),'ack':!![]});return;}const _0x16505e=JSON[_0x48537d(0x260)](JSON[_0x48537d(0x207)](_0xbb6f9['rawEventLog'])),_0x402550=_0x16505e['length'],_0x1f8e50=_0x48537d(0x20b)+JSON[_0x48537d(0x207)](_0x16505e);try{updateApiTimestamp();const _0x2c654d=await _0xbb6f9[_0x48537d(0x1db)][_0x48537d(0x254)](_0x1f8e50),_0xe6b3ee=JSON[_0x48537d(0x260)](_0x2c654d[_0x48537d(0x265)][_0x48537d(0x1ea)]()['replace'](/```json|```/g,'')[_0x48537d(0x248)]()),_0x283ba7={'timestamp':new Date()['toISOString'](),'eventCount':_0x402550,'summary':_0xe6b3ee[_0x48537d(0x24d)]||_0x48537d(0x217),'activityLevel':_0xe6b3ee[_0x48537d(0x25e)]||_0x48537d(0x201),'systemMode':_0xbb6f9[_0x48537d(0x241)]};_0xbb6f9[_0x48537d(0x1f7)]['push'](_0x283ba7);const _0x161429=_0xbb6f9['config']['ltmLtbWindowDays']||0x3c;_0xbb6f9['dailyDigests'][_0x48537d(0x1d6)]>_0x161429&&_0xbb6f9[_0x48537d(0x1f7)]['splice'](0x0,_0xbb6f9[_0x48537d(0x1f7)][_0x48537d(0x1d6)]-_0x161429);await _0xbb6f9[_0x48537d(0x24e)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x48537d(0x207)](_0xbb6f9[_0x48537d(0x1f7)]),'ack':!![]}),_0xbb6f9[_0x48537d(0x1e2)]=[],await _0xbb6f9[_0x48537d(0x24e)](LTM_DP_RAW_LOG,{'val':JSON[_0x48537d(0x207)](_0xbb6f9[_0x48537d(0x1e2)]),'ack':!![]}),await _0xbb6f9[_0x48537d(0x24e)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x3c1381=_0x48537d(0x21b)+_0xe6b3ee[_0x48537d(0x24d)]+'\x0aAktivit√§t:\x20'+_0xe6b3ee[_0x48537d(0x25e)];setup['sendNotification'](_0xbb6f9,_0x3c1381,![],![]);if(_0xbb6f9[_0x48537d(0x1d9)]&&_0x199565)_0x199565[_0x48537d(0x1ee)](_0xbb6f9,_0x48537d(0x21e),{'digest':_0x283ba7});}catch(_0x8a9994){_0xbb6f9[_0x48537d(0x218)][_0x48537d(0x1f5)](_0x8a9994[_0x48537d(0x23c)]);}}async function runBaselineDriftAnalysis(_0x4c72cf){const _0x43dca3=a0_0x358eeb;if(!_0x4c72cf[_0x43dca3(0x1d9)]||!_0x4c72cf[_0x43dca3(0x1db)])return;if(!canCallApi())return;const _0x221ab4=_0x4c72cf[_0x43dca3(0x21f)][_0x43dca3(0x211)]||0xe;if(_0x4c72cf[_0x43dca3(0x1f7)]['length']<_0x221ab4+0x7){await _0x4c72cf[_0x43dca3(0x24e)](_0x43dca3(0x1f0),{'val':_0x43dca3(0x200),'ack':!![]});return;}const _0x3f9413=_0x4c72cf[_0x43dca3(0x1f7)]['slice'](-_0x221ab4),_0x510521=_0x4c72cf[_0x43dca3(0x1f7)][_0x43dca3(0x1ef)](0x0,_0x4c72cf[_0x43dca3(0x1f7)]['length']-_0x221ab4),_0x319805=_0x43dca3(0x266)+JSON[_0x43dca3(0x207)](_0x510521)+'\x0aSTB:\x20'+JSON[_0x43dca3(0x207)](_0x3f9413);try{updateApiTimestamp();const _0x2fef9e=await _0x4c72cf[_0x43dca3(0x1db)][_0x43dca3(0x254)](_0x319805),_0xebc89d=JSON[_0x43dca3(0x260)](_0x2fef9e[_0x43dca3(0x265)][_0x43dca3(0x1ea)]()[_0x43dca3(0x230)](/```json|```/g,'')[_0x43dca3(0x248)]());_0xebc89d['baselineDrift']&&(await _0x4c72cf[_0x43dca3(0x24e)](_0x43dca3(0x1f0),{'val':_0xebc89d[_0x43dca3(0x249)],'ack':!![]}),await _0x4c72cf[_0x43dca3(0x24e)](_0x43dca3(0x263),{'val':_0xebc89d['driftDetails'],'ack':!![]}),await _0x4c72cf[_0x43dca3(0x24e)](_0x43dca3(0x221),{'val':Date[_0x43dca3(0x259)](),'ack':!![]}));}catch(_0x320d5a){}}async function executeAutomationAction(_0x3eff6c){const _0x22056a=a0_0x358eeb;try{const _0x11f99b=await _0x3eff6c['getStateAsync'](_0x22056a(0x23a)),_0x1046d4=await _0x3eff6c[_0x22056a(0x232)]('analysis.automation.targetValue');if(_0x11f99b&&_0x11f99b[_0x22056a(0x246)]&&_0x1046d4){const _0x287eff=_0x11f99b[_0x22056a(0x246)];let _0xe7d703=_0x1046d4['val'];try{_0xe7d703=JSON[_0x22056a(0x260)](_0xe7d703);}catch(_0x7c9886){}_0x3eff6c[_0x22056a(0x218)][_0x22056a(0x253)](_0x22056a(0x1f8)+_0x287eff+_0x22056a(0x23d)+_0xe7d703),await _0x3eff6c[_0x22056a(0x262)](_0x287eff,_0xe7d703);}else _0x3eff6c[_0x22056a(0x218)]['warn'](_0x22056a(0x1d2));}catch(_0x259bd2){_0x3eff6c[_0x22056a(0x218)]['error']('BUTLER\x20Execution\x20Error:\x20'+_0x259bd2[_0x22056a(0x23c)]);}}async function sendMorningBriefing(_0x2ca3f6){const _0x182cf2=a0_0x358eeb;if(!_0x2ca3f6['geminiModel']){_0x2ca3f6[_0x182cf2(0x218)][_0x182cf2(0x226)](_0x182cf2(0x239));return;}_0x2ca3f6[_0x182cf2(0x218)][_0x182cf2(0x253)]('üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x46dde5=_0x182cf2(0x213),_0x1b71a4=await _0x2ca3f6[_0x182cf2(0x1db)][_0x182cf2(0x254)](_0x46dde5),_0x39bf13=_0x1b71a4[_0x182cf2(0x265)][_0x182cf2(0x1ea)]();_0x2ca3f6[_0x182cf2(0x218)][_0x182cf2(0x253)](_0x182cf2(0x214)+_0x39bf13[_0x182cf2(0x1d6)]+_0x182cf2(0x1ff)),setup[_0x182cf2(0x22c)](_0x2ca3f6,'üåÖ\x20Morning\x20Briefing:\x0a'+_0x39bf13);}catch(_0x5412af){_0x2ca3f6['log'][_0x182cf2(0x1f5)]('Briefing\x20Error:\x20'+_0x5412af['message']);}}function a0_0x2737(){const _0x312f42=[')\x20generated.','send','slice','LTM.driftAnalysis.baselineDrift','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','getDate','analysis.health.geminiDay','ü§ñ\x20Health\x20Report\x20(','error','alertReason','dailyDigests','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','3241780QYvlkJ','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','1869vTQTJt','analysis.activitySummary','8576584gFeAYw','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.',').\x20Sending\x20notification...','N/A\x20(Learning)','normal','ü§ñ\x20Butler\x20Brain\x20Error:\x20','useWeather','map','reason','generic','stringify','automationProposal','./setup','Skipped\x20(Traffic)','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.\x20ANWESEND:\x20','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','Started...','eventHistory','search','ltmStbWindowDays','(((.+)+)+)+$','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','üåÖ\x20Briefing\x20generated\x20(Length:\x20','lastAlertState','unshift','Digest','log','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','weatherInstance','üìÖ\x20Daily\x20Digest:\x0a','isAlert','timestamp','ANALYZE_HEALTH','config','\x20√ºbersprungen\x20(Auto-Approved).','LTM.driftAnalysis.lastCheck','NIGHT','description','detected','constructor','warn','41478KgFrkY','.\x20KONTEXT:\x20','toFixed','.Current.IsNight','\x0a\x20\x20\x20\x20EVENTS:\x0a','sendNotification','aiPersona','analysis.automation.targetValue','analysis.analysisHistory','replace','analysis.isAlert','getStateAsync','7263OsAXQP','apply','.\x20EVENTS:\x20','‚ö†Ô∏è\x20ALARM:\x20','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','analysis.lastResult','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','analysis.automation.targetId','toLocaleTimeString','message','\x20=\x20','analysis.automation.autoApply','models/gemini-flash-latest','\x20->\x20','currentSystemMode','filter','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','@google/generative-ai','KI-Fehler\x20(Fallback)','val','KI\x20offline\x20(Fallback)','trim','baselineDrift','2331xjlSvV','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','setHours','summary','setStateAsync','Wetterdaten\x20nicht\x20abrufbar','analysisHistory','Skipped\x20(No\x20AI\x20or\x20Data)','.Current.Temperature','info','generateContent','.\x20EMERGENCY:\x20','debug','targetValue','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','now','Unbekannt','getTime','3860tgepoN','isEmergency','activityLevel','Nacht','parse','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','setForeignStateAsync','LTM.driftAnalysis.driftDetails','Gemini\x20Error:\x20','response','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','setDate',',\x20Lichtverh√§ltnisse:\x20','approved','length','analysis.automation.description','Sicherheit\x20geht\x20vor.','isProVersion','pop','geminiModel','Health\x20Report\x20Error:\x20','LTM.processingStatus','705584EeUBbD','612cPGLUz','2-digit','analysis.automation.patternDetected','rawEventLog','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','toString','getForeignStateAsync','Tag','1255027TSDEcO','text','analysis.health.geminiNight','analysis.alertReason'];a0_0x2737=function(){return _0x312f42;};return a0_0x2737();}async function generateHealthReport(_0x5000da,_0x5242df){const _0xeba57c=a0_0x358eeb;if(!_0x5000da['geminiModel'])return;const _0x1c531f=Date[_0xeba57c(0x259)]();_0x1c531f-lastGlobalApiCall<0xbb8&&(_0x5000da[_0xeba57c(0x218)]['debug'](_0xeba57c(0x1e5)),await new Promise(_0x5aff1f=>setTimeout(_0x5aff1f,0x7d0)));const _0x89c66a=new Date();let _0x275852=0x0,_0x1f9369=_0x89c66a['getTime'](),_0x2b5a31='';if(_0x5242df==='NIGHT'){const _0x4d3fcd=new Date(_0x89c66a);_0x4d3fcd[_0xeba57c(0x1d3)](_0x4d3fcd[_0xeba57c(0x1f2)]()-0x1),_0x4d3fcd['setHours'](0x16,0x0,0x0,0x0),_0x275852=_0x4d3fcd[_0xeba57c(0x25b)]();const _0x386815=new Date(_0x89c66a);_0x386815[_0xeba57c(0x24c)](0x8,0x0,0x0,0x0),_0x1f9369=_0x386815[_0xeba57c(0x25b)](),_0x2b5a31=_0xeba57c(0x24b);}else{const _0x309050=new Date(_0x89c66a);_0x309050['setHours'](0x8,0x0,0x0,0x0),_0x275852=_0x309050[_0xeba57c(0x25b)](),_0x2b5a31='Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).';}const _0x1389af=_0x5000da[_0xeba57c(0x20f)][_0xeba57c(0x242)](_0x54720f=>_0x54720f[_0xeba57c(0x21d)]>=_0x275852&&_0x54720f[_0xeba57c(0x21d)]<=_0x1f9369);if(_0x1389af['length']===0x0){const _0x532d53=_0x5242df===_0xeba57c(0x222)?'Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).':_0xeba57c(0x1f1),_0x34b017=_0x5242df===_0xeba57c(0x222)?_0xeba57c(0x1eb):_0xeba57c(0x1f3);await _0x5000da['setStateAsync'](_0x34b017,{'val':_0x532d53,'ack':!![]});return;}const _0x114f45=_0x1389af[_0xeba57c(0x204)](_0x8af7ac=>new Date(_0x8af7ac['timestamp'])['toLocaleTimeString']([],{'hour':_0xeba57c(0x1e0),'minute':_0xeba57c(0x1e0)})+'\x20'+_0x8af7ac['name']+'\x20('+_0x8af7ac['value']+')')['join']('\x0a'),_0x47b29f=_0xeba57c(0x243)+_0x2b5a31+_0xeba57c(0x22b)+_0x114f45+_0xeba57c(0x258);try{updateApiTimestamp();const _0x59a5df=await _0x5000da[_0xeba57c(0x1db)][_0xeba57c(0x254)](_0x47b29f),_0x3f763e=_0x59a5df[_0xeba57c(0x265)][_0xeba57c(0x1ea)](),_0x178c25=_0x5242df===_0xeba57c(0x222)?_0xeba57c(0x1eb):_0xeba57c(0x1f3);await _0x5000da[_0xeba57c(0x24e)](_0x178c25,{'val':_0x3f763e,'ack':!![]}),_0x5000da[_0xeba57c(0x218)]['info'](_0xeba57c(0x1f4)+_0x5242df+_0xeba57c(0x1ed));}catch(_0x3c73d5){_0x5000da[_0xeba57c(0x218)][_0xeba57c(0x1f5)](_0xeba57c(0x1dc)+_0x3c73d5['message']);}}module['exports']={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};