const a0_0x3b24cb=a0_0x3a90;(function(_0x4adbf5,_0x4fe38d){const _0x43d322=a0_0x3a90,_0x36f590=_0x4adbf5();while(!![]){try{const _0x52ed17=-parseInt(_0x43d322(0x253))/0x1+parseInt(_0x43d322(0x219))/0x2*(-parseInt(_0x43d322(0x1d7))/0x3)+-parseInt(_0x43d322(0x1f1))/0x4*(parseInt(_0x43d322(0x1ed))/0x5)+parseInt(_0x43d322(0x218))/0x6+-parseInt(_0x43d322(0x25e))/0x7+-parseInt(_0x43d322(0x1e5))/0x8*(parseInt(_0x43d322(0x24e))/0x9)+parseInt(_0x43d322(0x20a))/0xa;if(_0x52ed17===_0x4fe38d)break;else _0x36f590['push'](_0x36f590['shift']());}catch(_0x335d48){_0x36f590['push'](_0x36f590['shift']());}}}(a0_0x2cd5,0x44a4a));const a0_0x1aa433=(function(){let _0x1cf4c0=!![];return function(_0xae8e4,_0x1842d0){const _0x484887=_0x1cf4c0?function(){const _0x32a5ec=a0_0x3a90;if(_0x1842d0){const _0x79add9=_0x1842d0[_0x32a5ec(0x23b)](_0xae8e4,arguments);return _0x1842d0=null,_0x79add9;}}:function(){};return _0x1cf4c0=![],_0x484887;};}()),a0_0x1e8ca4=a0_0x1aa433(this,function(){const _0x19927c=a0_0x3a90;return a0_0x1e8ca4[_0x19927c(0x1d9)]()[_0x19927c(0x1e8)](_0x19927c(0x1e2))['toString']()[_0x19927c(0x202)](a0_0x1e8ca4)['search'](_0x19927c(0x1e2));});a0_0x1e8ca4();'use strict';const {GoogleGenerativeAI}=require(a0_0x3b24cb(0x1ca)),setup=require('./setup'),GEMINI_MODEL=a0_0x3b24cb(0x228),LTM_DP_DAILY_DIGESTS=a0_0x3b24cb(0x23c),LTM_DP_STATUS=a0_0x3b24cb(0x22e),LTM_DP_RAW_LOG=a0_0x3b24cb(0x212),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':'PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':'Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','single_comfort':a0_0x3b24cb(0x21c),'security':a0_0x3b24cb(0x24c),'energy_saver':'PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).'};function canCallApi(){const _0x1158ea=a0_0x3b24cb,_0x2a905c=Date[_0x1158ea(0x214)]();return _0x2a905c-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x24abfc=a0_0x3b24cb;lastGlobalApiCall=Date[_0x24abfc(0x214)]();}function a0_0x3a90(_0x195d4f,_0x53f80f){const _0x443fc6=a0_0x2cd5();return a0_0x3a90=function(_0x1e8ca4,_0x1aa433){_0x1e8ca4=_0x1e8ca4-0x1c9;let _0x2cd5cb=_0x443fc6[_0x1e8ca4];return _0x2cd5cb;},a0_0x3a90(_0x195d4f,_0x53f80f);}async function getWeatherContext(_0x9d968c){const _0x46f780=a0_0x3b24cb;if(!_0x9d968c[_0x46f780(0x21b)][_0x46f780(0x1fd)]||!_0x9d968c[_0x46f780(0x21b)]['weatherInstance'])return _0x46f780(0x1db);try{const _0x14f974=_0x9d968c[_0x46f780(0x21b)][_0x46f780(0x230)];let _0x5bac8e=await _0x9d968c[_0x46f780(0x240)](_0x14f974+_0x46f780(0x23e));if(!_0x5bac8e)_0x5bac8e=await _0x9d968c[_0x46f780(0x240)](_0x14f974+_0x46f780(0x257));let _0x8cc4b=await _0x9d968c[_0x46f780(0x240)](_0x14f974+'.Current.WeatherText');if(!_0x8cc4b)_0x8cc4b=await _0x9d968c[_0x46f780(0x240)](_0x14f974+_0x46f780(0x225));let _0x7158a0=_0x46f780(0x262);const _0x4b5324=await _0x9d968c[_0x46f780(0x240)](_0x14f974+_0x46f780(0x1f3));if(_0x4b5324)_0x7158a0=_0x4b5324['val']?_0x46f780(0x1f5):_0x46f780(0x21e);if(_0x5bac8e&&_0x8cc4b)return _0x5bac8e[_0x46f780(0x23d)]+_0x46f780(0x217)+_0x8cc4b[_0x46f780(0x23d)]+_0x46f780(0x234)+_0x7158a0;}catch(_0x458d20){}return'Wetterdaten\x20nicht\x20abrufbar';}async function consultButler(_0x592e1c,_0x1cce1e,_0x30975c,_0x34e738){const _0x466dd8=a0_0x3b24cb;if(!_0x592e1c[_0x466dd8(0x1df)])return{'approved':!![],'reason':_0x466dd8(0x1e9)};const _0x5a5e2c=Date[_0x466dd8(0x214)]();if(decisionCache[_0x1cce1e]&&_0x5a5e2c-decisionCache[_0x1cce1e]['timestamp']<CACHE_TTL_MS){const _0x277da1=decisionCache[_0x1cce1e]['decision'];return _0x592e1c[_0x466dd8(0x25d)][_0x466dd8(0x200)](_0x466dd8(0x211)+_0x1cce1e+'\x20->\x20'+(_0x277da1[_0x466dd8(0x1cb)]?'OK':'NO')+'\x20('+_0x277da1[_0x466dd8(0x264)]+')'),_0x277da1;}if(!canCallApi())return _0x592e1c['log'][_0x466dd8(0x200)]('ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20'+_0x1cce1e+'\x20√ºbersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x466dd8(0x20e)};const _0x347048=new Date()['toLocaleTimeString'](),_0x5800be=await getWeatherContext(_0x592e1c),_0x5a8566=PERSONA_MAPPING[_0x592e1c[_0x466dd8(0x21b)]['aiPersona']||_0x466dd8(0x1ff)],_0x4c0204='\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20'+_0x347048+_0x466dd8(0x207)+_0x5800be+_0x466dd8(0x261)+(_0x34e738*0x64)[_0x466dd8(0x216)](0x0)+_0x466dd8(0x265)+_0x1cce1e+_0x466dd8(0x1d1)+_0x30975c+_0x466dd8(0x24b)+_0x5a8566+_0x466dd8(0x1fa);try{updateApiTimestamp();const _0x225596=await _0x592e1c['geminiModel'][_0x466dd8(0x21d)](_0x4c0204),_0x58ed11=_0x225596['response'][_0x466dd8(0x1ef)]()['replace'](/```json|```/g,'')[_0x466dd8(0x259)](),_0x5da18d=JSON[_0x466dd8(0x247)](_0x58ed11);return decisionCache[_0x1cce1e]={'decision':_0x5da18d,'timestamp':_0x5a5e2c},_0x5da18d;}catch(_0x4b6262){return _0x592e1c[_0x466dd8(0x25d)][_0x466dd8(0x1e6)](_0x466dd8(0x24d)+_0x4b6262['message']),decisionCache[_0x1cce1e]={'decision':{'approved':!![],'reason':_0x466dd8(0x252)},'timestamp':_0x5a5e2c-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x466dd8(0x252)};}}async function runGeminiAnalysis(_0x16ff69,_0x31464d=''){const _0x1f0eea=a0_0x3b24cb;if(!_0x16ff69[_0x1f0eea(0x1df)])return;if(!canCallApi()){_0x16ff69[_0x1f0eea(0x25d)]['debug']('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x16ff69['eventHistory'][_0x1f0eea(0x220)]===0x0)return;const _0x39a871=_0x16ff69[_0x1f0eea(0x21f)][_0x1f0eea(0x237)](0x0,0xf),_0x31a964=_0x16ff69[_0x1f0eea(0x24f)],_0x2a71b5=PERSONA_MAPPING[_0x16ff69[_0x1f0eea(0x21b)][_0x1f0eea(0x22d)]||'generic'],_0x41f3c9=_0x16ff69[_0x1f0eea(0x21b)][_0x1f0eea(0x245)]||_0x1f0eea(0x1d5);let _0x3fae21='Unbekannt';try{const _0x4c49c1=await _0x16ff69['getStateAsync'](_0x1f0eea(0x1cd));if(_0x4c49c1&&_0x4c49c1[_0x1f0eea(0x23d)])_0x3fae21=_0x4c49c1[_0x1f0eea(0x23d)];}catch(_0x20981c){}let _0x1165c8=![];try{const _0x44ed65=await _0x16ff69[_0x1f0eea(0x1ea)](_0x1f0eea(0x1e0));if(_0x44ed65&&_0x44ed65[_0x1f0eea(0x23d)])_0x1165c8=!![];}catch(_0x304828){}const _0x185683=_0x1f0eea(0x25c)+_0x2a71b5+'.\x20KONTEXT:\x20'+_0x41f3c9+_0x1f0eea(0x22b)+_0x31a964+_0x1f0eea(0x1e3)+_0x3fae21+_0x1f0eea(0x1d6)+JSON['stringify'](_0x39a871)+'.\x20EMERGENCY:\x20'+_0x31464d+_0x1f0eea(0x1d4);try{updateApiTimestamp();const _0x5800f6=await _0x16ff69[_0x1f0eea(0x1df)][_0x1f0eea(0x21d)](_0x185683),_0x5c2204=JSON['parse'](_0x5800f6[_0x1f0eea(0x1d2)][_0x1f0eea(0x1ef)]()['replace'](/```json|```/g,'')[_0x1f0eea(0x259)]());await _0x16ff69[_0x1f0eea(0x1c9)]('analysis.lastResult',{'val':JSON['stringify'](_0x5c2204),'ack':!![]});if(_0x5c2204[_0x1f0eea(0x235)])await _0x16ff69[_0x1f0eea(0x1c9)](_0x1f0eea(0x213),{'val':_0x5c2204['summary'],'ack':!![]});const _0x20df4e={'timestamp':Date[_0x1f0eea(0x214)](),'id':Date[_0x1f0eea(0x214)]()['toString'](),'analysis':{'activity':{'summary':_0x5c2204[_0x1f0eea(0x235)],'isAlert':_0x5c2204['isAlert'],'alertReason':_0x5c2204[_0x1f0eea(0x1ce)]},'comfort':{'automationProposal':_0x5c2204[_0x1f0eea(0x1fe)]}}};_0x16ff69['analysisHistory'][_0x1f0eea(0x1dd)](_0x20df4e);if(_0x16ff69['analysisHistory'][_0x1f0eea(0x220)]>0x32)_0x16ff69[_0x1f0eea(0x222)][_0x1f0eea(0x256)]();await _0x16ff69[_0x1f0eea(0x1c9)]('analysis.analysisHistory',{'val':JSON['stringify'](_0x16ff69[_0x1f0eea(0x222)]),'ack':!![]});const _0x557668=_0x5c2204[_0x1f0eea(0x24a)]||![];_0x557668!==_0x16ff69[_0x1f0eea(0x1e4)]&&(await _0x16ff69[_0x1f0eea(0x1c9)](_0x1f0eea(0x227),{'val':_0x557668,'ack':!![]}),_0x16ff69[_0x1f0eea(0x1e4)]=_0x557668,_0x557668&&(await _0x16ff69['setStateAsync'](_0x1f0eea(0x233),{'val':_0x5c2204['alertReason'],'ack':!![]}),setup[_0x1f0eea(0x243)](_0x16ff69,'‚ö†Ô∏è\x20ALARM:\x20'+_0x5c2204[_0x1f0eea(0x1ce)],![],_0x5c2204[_0x1f0eea(0x208)])));if(_0x5c2204[_0x1f0eea(0x1fe)]&&_0x5c2204[_0x1f0eea(0x1fe)][_0x1f0eea(0x260)]){await _0x16ff69['setStateAsync'](_0x1f0eea(0x203),{'val':!![],'ack':!![]}),await _0x16ff69[_0x1f0eea(0x1c9)](_0x1f0eea(0x251),{'val':_0x5c2204[_0x1f0eea(0x1fe)][_0x1f0eea(0x226)],'ack':!![]}),await _0x16ff69[_0x1f0eea(0x1c9)](_0x1f0eea(0x242),{'val':_0x5c2204[_0x1f0eea(0x1fe)][_0x1f0eea(0x23f)],'ack':!![]}),await _0x16ff69[_0x1f0eea(0x1c9)](_0x1f0eea(0x1d8),{'val':JSON[_0x1f0eea(0x25a)](_0x5c2204[_0x1f0eea(0x1fe)][_0x1f0eea(0x20f)]),'ack':!![]});if(_0x1165c8)executeAutomationAction(_0x16ff69);}}catch(_0x3ceeff){_0x16ff69[_0x1f0eea(0x25d)][_0x1f0eea(0x1eb)](_0x1f0eea(0x238)+_0x3ceeff[_0x1f0eea(0x1fc)]);}}async function createDailyDigest(_0x440378,_0xbf27c8){const _0x514f57=a0_0x3b24cb;if(!_0x440378[_0x514f57(0x1f0)])return;if(!canCallApi()){await _0x440378['setStateAsync'](LTM_DP_STATUS,{'val':_0x514f57(0x232),'ack':!![]});return;}await _0x440378['setStateAsync'](LTM_DP_STATUS,{'val':_0x514f57(0x210),'ack':!![]});if(!_0x440378[_0x514f57(0x1df)]||_0x440378[_0x514f57(0x1cf)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x440378[_0x514f57(0x1c9)](LTM_DP_STATUS,{'val':_0x514f57(0x209),'ack':!![]});return;}const _0xbaa62b=JSON[_0x514f57(0x247)](JSON[_0x514f57(0x25a)](_0x440378[_0x514f57(0x1cf)])),_0x1ae76e=_0xbaa62b[_0x514f57(0x220)],_0x2aad52=_0x514f57(0x22a)+JSON[_0x514f57(0x25a)](_0xbaa62b);try{updateApiTimestamp();const _0x190af0=await _0x440378[_0x514f57(0x1df)][_0x514f57(0x21d)](_0x2aad52),_0x16d1d0=JSON[_0x514f57(0x247)](_0x190af0[_0x514f57(0x1d2)][_0x514f57(0x1ef)]()[_0x514f57(0x206)](/```json|```/g,'')[_0x514f57(0x259)]()),_0x1998c5={'timestamp':new Date()['toISOString'](),'eventCount':_0x1ae76e,'summary':_0x16d1d0[_0x514f57(0x235)]||'Digest','activityLevel':_0x16d1d0[_0x514f57(0x1f8)]||_0x514f57(0x204),'systemMode':_0x440378[_0x514f57(0x24f)]};_0x440378[_0x514f57(0x201)][_0x514f57(0x25b)](_0x1998c5);const _0x4400f0=_0x440378[_0x514f57(0x21b)]['ltmLtbWindowDays']||0x3c;_0x440378[_0x514f57(0x201)][_0x514f57(0x220)]>_0x4400f0&&_0x440378[_0x514f57(0x201)][_0x514f57(0x215)](0x0,_0x440378[_0x514f57(0x201)]['length']-_0x4400f0);await _0x440378['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x514f57(0x25a)](_0x440378[_0x514f57(0x201)]),'ack':!![]}),_0x440378[_0x514f57(0x1cf)]=[],await _0x440378[_0x514f57(0x1c9)](LTM_DP_RAW_LOG,{'val':JSON[_0x514f57(0x25a)](_0x440378[_0x514f57(0x1cf)]),'ack':!![]}),await _0x440378['setStateAsync'](LTM_DP_STATUS,{'val':_0x514f57(0x22c),'ack':!![]});const _0x65b4f=_0x514f57(0x20d)+_0x16d1d0[_0x514f57(0x235)]+_0x514f57(0x249)+_0x16d1d0[_0x514f57(0x1f8)];setup[_0x514f57(0x243)](_0x440378,_0x65b4f,![],![]);if(_0x440378['isProVersion']&&_0xbf27c8)_0xbf27c8['send'](_0x440378,_0x514f57(0x1de),{'digest':_0x1998c5});}catch(_0x3454c3){_0x440378[_0x514f57(0x25d)][_0x514f57(0x1eb)](_0x3454c3['message']);}}function a0_0x2cd5(){const _0x21376c=['Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.\x20SYSTEM_MODE:\x20','Success','aiPersona','LTM.processingStatus','setDate','weatherInstance','baselineDrift','Skipped\x20(Traffic)','analysis.alertReason',',\x20Lichtverh√§ltnisse:\x20','summary','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','slice','Gemini\x20Error:\x20','\x0aSTB:\x20','BUTLER\x20Execution\x20Error:\x20','apply','LTM.dailyDigests','val','.Current.Temperature','targetId','getForeignStateAsync','LTM.driftAnalysis.driftDetails','analysis.automation.targetId','sendNotification','setForeignStateAsync','livingContext','driftDetails','parse','getDate','\x0aAktivit√§t:\x20','isAlert','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','Sicherheit\x20geht\x20vor.','ü§ñ\x20Butler\x20Brain\x20Error:\x20','9hhAFdQ','currentSystemMode','toLocaleTimeString','analysis.automation.description','KI-Fehler\x20(Fallback)','471312bpFxrD','setHours','2-digit','pop','.forecast.current.temperature','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','trim','stringify','push','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','log','984725fKPsgg','ltmStbWindowDays','detected','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','Unbekannt','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','reason','%)\x20nach\x20\x22','setStateAsync','@google/generative-ai','approved','ü§ñ\x20Health\x20Report\x20(','system.presenceWho','alertReason','rawEventLog','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','response','LTM.driftAnalysis.lastCheck','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','Keine\x20Details.','.\x20EVENTS:\x20','226194hDJluW','analysis.automation.targetValue','toString','LTM.driftAnalysis.baselineDrift','Unbekannt\x20(Kein\x20Sensor)','join','unshift','ANALYZE_HEALTH','geminiModel','analysis.automation.autoApply','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','(((.+)+)+)+$','.\x20ANWESEND:\x20','lastAlertState','3368024rAFwpp','warn','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','search','KI\x20offline\x20(Fallback)','getStateAsync','error','timestamp','285rHYaRv','Briefing\x20Error:\x20','text','isProVersion','31344EpfMTH','\x20=\x20','.Current.IsNight','analysis.health.geminiNight','Nacht','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','NIGHT','activityLevel','üåÖ\x20Briefing\x20generated\x20(Length:\x20','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','analysis.health.geminiDay','message','useWeather','automationProposal','generic','debug','dailyDigests','constructor','analysis.automation.patternDetected','normal','Health\x20Report\x20Error:\x20','replace',',\x20Wetter:\x20','isEmergency','Skipped\x20(No\x20AI\x20or\x20Data)','16795270wqHrSK','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','getTime','üìÖ\x20Daily\x20Digest:\x0a','Traffic-Schutz\x20(Auto-Approved)','targetValue','Started...','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','LTM.rawEventLog','analysis.activitySummary','now','splice','toFixed','¬∞C,\x20','2297214pJEQhl','8NWFuVc','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','config','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','generateContent','Tag','eventHistory','length','üåÖ\x20Morning\x20Briefing:\x0a','analysisHistory','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...',').\x20Sending\x20notification...','.forecast.current.state','description','analysis.isAlert','models/gemini-flash-latest'];a0_0x2cd5=function(){return _0x21376c;};return a0_0x2cd5();}async function runBaselineDriftAnalysis(_0x1f57f0){const _0x152ee2=a0_0x3b24cb;if(!_0x1f57f0[_0x152ee2(0x1f0)]||!_0x1f57f0[_0x152ee2(0x1df)])return;if(!canCallApi())return;const _0x42285c=_0x1f57f0[_0x152ee2(0x21b)][_0x152ee2(0x25f)]||0xe;if(_0x1f57f0[_0x152ee2(0x201)][_0x152ee2(0x220)]<_0x42285c+0x7){await _0x1f57f0[_0x152ee2(0x1c9)]('LTM.driftAnalysis.baselineDrift',{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x5c5776=_0x1f57f0[_0x152ee2(0x201)][_0x152ee2(0x237)](-_0x42285c),_0x11d119=_0x1f57f0[_0x152ee2(0x201)]['slice'](0x0,_0x1f57f0[_0x152ee2(0x201)]['length']-_0x42285c),_0x3a1805=_0x152ee2(0x1e7)+JSON['stringify'](_0x11d119)+_0x152ee2(0x239)+JSON['stringify'](_0x5c5776);try{updateApiTimestamp();const _0x1357e2=await _0x1f57f0[_0x152ee2(0x1df)][_0x152ee2(0x21d)](_0x3a1805),_0xa5bd7e=JSON['parse'](_0x1357e2[_0x152ee2(0x1d2)][_0x152ee2(0x1ef)]()[_0x152ee2(0x206)](/```json|```/g,'')[_0x152ee2(0x259)]());_0xa5bd7e[_0x152ee2(0x231)]&&(await _0x1f57f0[_0x152ee2(0x1c9)](_0x152ee2(0x1da),{'val':_0xa5bd7e[_0x152ee2(0x231)],'ack':!![]}),await _0x1f57f0[_0x152ee2(0x1c9)](_0x152ee2(0x241),{'val':_0xa5bd7e[_0x152ee2(0x246)],'ack':!![]}),await _0x1f57f0[_0x152ee2(0x1c9)](_0x152ee2(0x1d3),{'val':Date[_0x152ee2(0x214)](),'ack':!![]}));}catch(_0x2122dc){}}async function executeAutomationAction(_0x1a0f89){const _0x5db04f=a0_0x3b24cb;try{const _0x12ae0f=await _0x1a0f89[_0x5db04f(0x1ea)](_0x5db04f(0x242)),_0x275e0d=await _0x1a0f89[_0x5db04f(0x1ea)](_0x5db04f(0x1d8));if(_0x12ae0f&&_0x12ae0f['val']&&_0x275e0d){const _0x590ac2=_0x12ae0f[_0x5db04f(0x23d)];let _0x1c2195=_0x275e0d[_0x5db04f(0x23d)];try{_0x1c2195=JSON[_0x5db04f(0x247)](_0x1c2195);}catch(_0x1c7153){}_0x1a0f89[_0x5db04f(0x25d)]['info'](_0x5db04f(0x1e1)+_0x590ac2+_0x5db04f(0x1f2)+_0x1c2195),await _0x1a0f89[_0x5db04f(0x244)](_0x590ac2,_0x1c2195);}else _0x1a0f89['log']['warn'](_0x5db04f(0x263));}catch(_0x47b05e){_0x1a0f89['log']['error'](_0x5db04f(0x23a)+_0x47b05e[_0x5db04f(0x1fc)]);}}async function sendMorningBriefing(_0x20e730){const _0xfd8ad8=a0_0x3b24cb;if(!_0x20e730[_0xfd8ad8(0x1df)]){_0x20e730[_0xfd8ad8(0x25d)][_0xfd8ad8(0x1e6)]('ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x20e730[_0xfd8ad8(0x25d)]['info'](_0xfd8ad8(0x1d0));try{updateApiTimestamp();const _0x2a831e=_0xfd8ad8(0x236),_0x31a3e8=await _0x20e730[_0xfd8ad8(0x1df)]['generateContent'](_0x2a831e),_0x30e3c5=_0x31a3e8['response'][_0xfd8ad8(0x1ef)]();_0x20e730[_0xfd8ad8(0x25d)]['info'](_0xfd8ad8(0x1f9)+_0x30e3c5[_0xfd8ad8(0x220)]+_0xfd8ad8(0x224)),setup[_0xfd8ad8(0x243)](_0x20e730,_0xfd8ad8(0x221)+_0x30e3c5);}catch(_0xf5b0b0){_0x20e730[_0xfd8ad8(0x25d)][_0xfd8ad8(0x1eb)](_0xfd8ad8(0x1ee)+_0xf5b0b0[_0xfd8ad8(0x1fc)]);}}async function generateHealthReport(_0x58a0fc,_0xadb0a1){const _0x159a78=a0_0x3b24cb;if(!_0x58a0fc['geminiModel'])return;const _0x2a785f=Date[_0x159a78(0x214)]();_0x2a785f-lastGlobalApiCall<0xbb8&&(_0x58a0fc[_0x159a78(0x25d)][_0x159a78(0x200)](_0x159a78(0x223)),await new Promise(_0x35ea10=>setTimeout(_0x35ea10,0x7d0)));const _0x5ec7c6=new Date();let _0x423e3c=0x0,_0x1c7ad7=_0x5ec7c6[_0x159a78(0x20c)](),_0x115a55='';if(_0xadb0a1===_0x159a78(0x1f7)){const _0x2f0dbd=new Date(_0x5ec7c6);_0x2f0dbd[_0x159a78(0x22f)](_0x2f0dbd[_0x159a78(0x248)]()-0x1),_0x2f0dbd[_0x159a78(0x254)](0x16,0x0,0x0,0x0),_0x423e3c=_0x2f0dbd[_0x159a78(0x20c)]();const _0x534553=new Date(_0x5ec7c6);_0x534553[_0x159a78(0x254)](0x8,0x0,0x0,0x0),_0x1c7ad7=_0x534553[_0x159a78(0x20c)](),_0x115a55=_0x159a78(0x229);}else{const _0x32a10f=new Date(_0x5ec7c6);_0x32a10f['setHours'](0x8,0x0,0x0,0x0),_0x423e3c=_0x32a10f['getTime'](),_0x115a55='Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).';}const _0x46a63c=_0x58a0fc['eventHistory']['filter'](_0x4471ea=>_0x4471ea[_0x159a78(0x1ec)]>=_0x423e3c&&_0x4471ea[_0x159a78(0x1ec)]<=_0x1c7ad7);if(_0x46a63c[_0x159a78(0x220)]===0x0){const _0x21321b=_0xadb0a1==='NIGHT'?_0x159a78(0x1f6):_0x159a78(0x258),_0x542cde=_0xadb0a1===_0x159a78(0x1f7)?_0x159a78(0x1f4):_0x159a78(0x1fb);await _0x58a0fc[_0x159a78(0x1c9)](_0x542cde,{'val':_0x21321b,'ack':!![]});return;}const _0x49785e=_0x46a63c['map'](_0x2370e7=>new Date(_0x2370e7[_0x159a78(0x1ec)])[_0x159a78(0x250)]([],{'hour':_0x159a78(0x255),'minute':_0x159a78(0x255)})+'\x20'+_0x2370e7['name']+'\x20('+_0x2370e7['value']+')')[_0x159a78(0x1dc)]('\x0a'),_0x3f064d=_0x159a78(0x20b)+_0x115a55+'\x0a\x20\x20\x20\x20EVENTS:\x0a'+_0x49785e+_0x159a78(0x21a);try{updateApiTimestamp();const _0x4bbf74=await _0x58a0fc['geminiModel'][_0x159a78(0x21d)](_0x3f064d),_0x47cd4d=_0x4bbf74['response'][_0x159a78(0x1ef)](),_0x2e323f=_0xadb0a1===_0x159a78(0x1f7)?_0x159a78(0x1f4):_0x159a78(0x1fb);await _0x58a0fc[_0x159a78(0x1c9)](_0x2e323f,{'val':_0x47cd4d,'ack':!![]}),_0x58a0fc[_0x159a78(0x25d)]['info'](_0x159a78(0x1cc)+_0xadb0a1+')\x20generated.');}catch(_0xe91910){_0x58a0fc[_0x159a78(0x25d)][_0x159a78(0x1eb)](_0x159a78(0x205)+_0xe91910[_0x159a78(0x1fc)]);}}module['exports']={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};