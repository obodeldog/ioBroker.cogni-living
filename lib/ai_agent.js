const a0_0x3e5959=a0_0x267e;(function(_0x53b16f,_0xb76199){const _0x56377a=a0_0x267e,_0x21c7b4=_0x53b16f();while(!![]){try{const _0x845f31=-parseInt(_0x56377a(0x119))/0x1+-parseInt(_0x56377a(0x10a))/0x2+parseInt(_0x56377a(0x169))/0x3+parseInt(_0x56377a(0x13b))/0x4*(-parseInt(_0x56377a(0x137))/0x5)+-parseInt(_0x56377a(0x196))/0x6*(-parseInt(_0x56377a(0x10d))/0x7)+parseInt(_0x56377a(0x130))/0x8*(-parseInt(_0x56377a(0x18d))/0x9)+-parseInt(_0x56377a(0x15a))/0xa*(-parseInt(_0x56377a(0x14e))/0xb);if(_0x845f31===_0xb76199)break;else _0x21c7b4['push'](_0x21c7b4['shift']());}catch(_0x5c05be){_0x21c7b4['push'](_0x21c7b4['shift']());}}}(a0_0x2949,0xf2af3));const a0_0x1c9967=(function(){let _0x483d79=!![];return function(_0x6930b3,_0x238619){const _0x5450d9=_0x483d79?function(){const _0x49a0e7=a0_0x267e;if(_0x238619){const _0x41cf27=_0x238619[_0x49a0e7(0x197)](_0x6930b3,arguments);return _0x238619=null,_0x41cf27;}}:function(){};return _0x483d79=![],_0x5450d9;};}()),a0_0x49ee9c=a0_0x1c9967(this,function(){const _0x18f9ca=a0_0x267e;return a0_0x49ee9c['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](a0_0x49ee9c)[_0x18f9ca(0x154)]('(((.+)+)+)+$');});a0_0x49ee9c();function a0_0x267e(_0x487ef9,_0x4f2a7f){const _0x47239f=a0_0x2949();return a0_0x267e=function(_0x49ee9c,_0x1c9967){_0x49ee9c=_0x49ee9c-0x106;let _0x294931=_0x47239f[_0x49ee9c];return _0x294931;},a0_0x267e(_0x487ef9,_0x4f2a7f);}'use strict';const {GoogleGenerativeAI}=require(a0_0x3e5959(0x118)),setup=require(a0_0x3e5959(0x115)),GEMINI_MODEL=a0_0x3e5959(0x128),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x3e5959(0x15d),LTM_DP_RAW_LOG=a0_0x3e5959(0x183),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':'PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':a0_0x3e5959(0x14f),'single_comfort':a0_0x3e5959(0x185),'security':a0_0x3e5959(0x171),'energy_saver':a0_0x3e5959(0x113)};function canCallApi(){const _0x3794ed=Date['now']();return _0x3794ed-lastGlobalApiCall>MIN_API_GAP_MS;}function a0_0x2949(){const _0x2da112=['text','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','LTM.driftAnalysis.lastCheck','âš ï¸\x20ALARM:\x20','444257JYCuJu','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','debug','stringify','KI\x20offline\x20(Fallback)','sendNotification','search','eventHistory','.forecast.current.state','\x0a\x20\x20\x20\x20EVENTS:\x0a','lastAlertState','approved','1150FjtqJt','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','analysis.activitySummary','LTM.processingStatus','system.presenceWho','\x0aSTB:\x20','Started...','getTime','filter','ðŸ¤–\x20Health\x20Report\x20(','analysis.automation.targetValue','splice','analysis.health.geminiNight','Digest','%)\x20nach\x20\x22','1615845tUJgMe','detected','reason','getStateAsync','info',',\x20LichtverhÃ¤ltnisse:\x20','geminiModel','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Sicherheit\x20geht\x20vor.','setDate','analysisHistory','NIGHT','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','rawEventLog','Â°C,\x20','weatherInstance','summary','Nacht','driftDetails','isEmergency','setForeignStateAsync','analysis.alertReason','.forecast.current.temperature','setHours','description',',\x20Wetter:\x20','LTM.rawEventLog','.\x20ANWESEND:\x20','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','toISOString','val','useWeather','analysis.health.geminiDay',')\x20generated.','send','toString','27KykJdl','map','isProVersion','Skipped\x20(Traffic)','alertReason','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','dailyDigests','analysis.isAlert','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','8166LILwDz','apply','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','response','ltmLtbWindowDays','Unbekannt\x20(Kein\x20Sensor)','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','.Current.Temperature','Wetterdaten\x20nicht\x20abrufbar','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','2820690yBUdgz','aiPersona','Traffic-Schutz\x20(Auto-Approved)','1967zkuVsR','parse','warn','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','N/A\x20(Learning)','message','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','ðŸŒ…\x20Morning\x20Briefing:\x0a','./setup','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','log','@google/generative-ai','389051vdbhfl','.\x20SYSTEM_MODE:\x20','toLocaleTimeString','.\x20EMERGENCY:\x20','setStateAsync','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','decision','getForeignStateAsync','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','generic','isAlert','2-digit','error','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','models/gemini-flash-latest',').\x20Sending\x20notification...','Gemini\x20Error:\x20','timestamp','baselineDrift','trim','Unbekannt','Keine\x20Details.','3542288cLzMvL','analysis.automation.autoApply','analysis.automation.targetId','targetId','activityLevel','config','automationProposal','59660rsldaR','\x20->\x20','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','join','484WYMCBN','slice','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','length','LTM.driftAnalysis.baselineDrift','analysis.analysisHistory','replace','\x20=\x20','Health\x20Report\x20Error:\x20','.\x20EVENTS:\x20','analysis.automation.description','now','.Current.IsNight','generateContent'];a0_0x2949=function(){return _0x2da112;};return a0_0x2949();}function updateApiTimestamp(){const _0x56a6a8=a0_0x3e5959;lastGlobalApiCall=Date[_0x56a6a8(0x146)]();}async function getWeatherContext(_0x39dca4){const _0xf36575=a0_0x3e5959;if(!_0x39dca4[_0xf36575(0x135)][_0xf36575(0x188)]||!_0x39dca4[_0xf36575(0x135)][_0xf36575(0x178)])return _0xf36575(0x19b);try{const _0x4520db=_0x39dca4[_0xf36575(0x135)][_0xf36575(0x178)];let _0x3fe937=await _0x39dca4[_0xf36575(0x120)](_0x4520db+_0xf36575(0x107));if(!_0x3fe937)_0x3fe937=await _0x39dca4[_0xf36575(0x120)](_0x4520db+_0xf36575(0x17f));let _0x2ffa28=await _0x39dca4['getForeignStateAsync'](_0x4520db+'.Current.WeatherText');if(!_0x2ffa28)_0x2ffa28=await _0x39dca4[_0xf36575(0x120)](_0x4520db+_0xf36575(0x156));let _0x1fdd2a=_0xf36575(0x12e);const _0xb180e4=await _0x39dca4[_0xf36575(0x120)](_0x4520db+_0xf36575(0x147));if(_0xb180e4)_0x1fdd2a=_0xb180e4[_0xf36575(0x187)]?_0xf36575(0x17a):'Tag';if(_0x3fe937&&_0x2ffa28)return _0x3fe937[_0xf36575(0x187)]+_0xf36575(0x177)+_0x2ffa28[_0xf36575(0x187)]+_0xf36575(0x16e)+_0x1fdd2a;}catch(_0x128d86){}return _0xf36575(0x108);}async function consultButler(_0x3cc58e,_0x2c6e71,_0x161f69,_0x2ef58c){const _0x2fc8c5=a0_0x3e5959;if(!_0x3cc58e['geminiModel'])return{'approved':!![],'reason':_0x2fc8c5(0x152)};const _0x23e2da=Date[_0x2fc8c5(0x146)]();if(decisionCache[_0x2c6e71]&&_0x23e2da-decisionCache[_0x2c6e71]['timestamp']<CACHE_TTL_MS){const _0x5be9f3=decisionCache[_0x2c6e71][_0x2fc8c5(0x11f)];return _0x3cc58e[_0x2fc8c5(0x117)][_0x2fc8c5(0x150)](_0x2fc8c5(0x198)+_0x2c6e71+_0x2fc8c5(0x138)+(_0x5be9f3[_0x2fc8c5(0x159)]?'OK':'NO')+'\x20('+_0x5be9f3[_0x2fc8c5(0x16b)]+')'),_0x5be9f3;}if(!canCallApi())return _0x3cc58e[_0x2fc8c5(0x117)][_0x2fc8c5(0x150)]('ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20'+_0x2c6e71+'\x20Ã¼bersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x2fc8c5(0x10c)};const _0x10fb54=new Date()[_0x2fc8c5(0x11b)](),_0x2351bc=await getWeatherContext(_0x3cc58e),_0x18f192=PERSONA_MAPPING[_0x3cc58e['config'][_0x2fc8c5(0x10b)]||_0x2fc8c5(0x123)],_0x3fdc07=_0x2fc8c5(0x110)+_0x10fb54+_0x2fc8c5(0x182)+_0x2351bc+_0x2fc8c5(0x192)+(_0x2ef58c*0x64)['toFixed'](0x0)+_0x2fc8c5(0x168)+_0x2c6e71+_0x2fc8c5(0x195)+_0x161f69+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x18f192+_0x2fc8c5(0x13d);try{updateApiTimestamp();const _0x255db2=await _0x3cc58e[_0x2fc8c5(0x16f)][_0x2fc8c5(0x148)](_0x3fdc07),_0x5c9498=_0x255db2[_0x2fc8c5(0x199)][_0x2fc8c5(0x149)]()[_0x2fc8c5(0x141)](/```json|```/g,'')[_0x2fc8c5(0x12d)](),_0x194526=JSON[_0x2fc8c5(0x10e)](_0x5c9498);return decisionCache[_0x2c6e71]={'decision':_0x194526,'timestamp':_0x23e2da},_0x194526;}catch(_0x34c429){return _0x3cc58e[_0x2fc8c5(0x117)]['warn'](_0x2fc8c5(0x11e)+_0x34c429['message']),decisionCache[_0x2c6e71]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x23e2da-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'};}}async function runGeminiAnalysis(_0x5abeb3,_0x334374=''){const _0x43353b=a0_0x3e5959;if(!_0x5abeb3[_0x43353b(0x16f)])return;if(!canCallApi()){_0x5abeb3[_0x43353b(0x117)][_0x43353b(0x150)](_0x43353b(0x121));return;}if(_0x5abeb3[_0x43353b(0x155)][_0x43353b(0x13e)]===0x0)return;const _0x342cc5=_0x5abeb3[_0x43353b(0x155)]['slice'](0x0,0xf),_0x478c99=_0x5abeb3['currentSystemMode'],_0x565162=PERSONA_MAPPING[_0x5abeb3[_0x43353b(0x135)][_0x43353b(0x10b)]||_0x43353b(0x123)],_0x56d59f=_0x5abeb3['config']['livingContext']||_0x43353b(0x12f);let _0x10ee63='Unbekannt';try{const _0x2f2977=await _0x5abeb3[_0x43353b(0x16c)](_0x43353b(0x15e));if(_0x2f2977&&_0x2f2977[_0x43353b(0x187)])_0x10ee63=_0x2f2977[_0x43353b(0x187)];}catch(_0x2030de){}let _0xd41d10=![];try{const _0x51a2f2=await _0x5abeb3[_0x43353b(0x16c)](_0x43353b(0x131));if(_0x51a2f2&&_0x51a2f2[_0x43353b(0x187)])_0xd41d10=!![];}catch(_0x16f008){}const _0x205b86=_0x43353b(0x14a)+_0x565162+'.\x20KONTEXT:\x20'+_0x56d59f+_0x43353b(0x11a)+_0x478c99+_0x43353b(0x184)+_0x10ee63+_0x43353b(0x144)+JSON[_0x43353b(0x151)](_0x342cc5)+_0x43353b(0x11c)+_0x334374+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x5318ab=await _0x5abeb3[_0x43353b(0x16f)]['generateContent'](_0x205b86),_0x5195d4=JSON[_0x43353b(0x10e)](_0x5318ab['response'][_0x43353b(0x149)]()[_0x43353b(0x141)](/```json|```/g,'')['trim']());await _0x5abeb3['setStateAsync']('analysis.lastResult',{'val':JSON[_0x43353b(0x151)](_0x5195d4),'ack':!![]});if(_0x5195d4[_0x43353b(0x179)])await _0x5abeb3[_0x43353b(0x11d)](_0x43353b(0x15c),{'val':_0x5195d4[_0x43353b(0x179)],'ack':!![]});const _0x1b088b={'timestamp':Date[_0x43353b(0x146)](),'id':Date[_0x43353b(0x146)]()[_0x43353b(0x18c)](),'analysis':{'activity':{'summary':_0x5195d4[_0x43353b(0x179)],'isAlert':_0x5195d4[_0x43353b(0x124)],'alertReason':_0x5195d4[_0x43353b(0x191)]},'comfort':{'automationProposal':_0x5195d4[_0x43353b(0x136)]}}};_0x5abeb3[_0x43353b(0x173)]['unshift'](_0x1b088b);if(_0x5abeb3[_0x43353b(0x173)]['length']>0x32)_0x5abeb3[_0x43353b(0x173)]['pop']();await _0x5abeb3[_0x43353b(0x11d)](_0x43353b(0x140),{'val':JSON[_0x43353b(0x151)](_0x5abeb3['analysisHistory']),'ack':!![]});const _0x4357fc=_0x5195d4[_0x43353b(0x124)]||![];_0x4357fc!==_0x5abeb3[_0x43353b(0x158)]&&(await _0x5abeb3[_0x43353b(0x11d)](_0x43353b(0x194),{'val':_0x4357fc,'ack':!![]}),_0x5abeb3['lastAlertState']=_0x4357fc,_0x4357fc&&(await _0x5abeb3[_0x43353b(0x11d)](_0x43353b(0x17e),{'val':_0x5195d4[_0x43353b(0x191)],'ack':!![]}),setup['sendNotification'](_0x5abeb3,_0x43353b(0x14d)+_0x5195d4[_0x43353b(0x191)],![],_0x5195d4[_0x43353b(0x17c)])));if(_0x5195d4[_0x43353b(0x136)]&&_0x5195d4[_0x43353b(0x136)][_0x43353b(0x16a)]){await _0x5abeb3['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x5abeb3[_0x43353b(0x11d)](_0x43353b(0x145),{'val':_0x5195d4[_0x43353b(0x136)][_0x43353b(0x181)],'ack':!![]}),await _0x5abeb3[_0x43353b(0x11d)](_0x43353b(0x132),{'val':_0x5195d4[_0x43353b(0x136)][_0x43353b(0x133)],'ack':!![]}),await _0x5abeb3[_0x43353b(0x11d)](_0x43353b(0x164),{'val':JSON[_0x43353b(0x151)](_0x5195d4[_0x43353b(0x136)]['targetValue']),'ack':!![]});if(_0xd41d10)executeAutomationAction(_0x5abeb3);}}catch(_0x337571){_0x5abeb3[_0x43353b(0x117)][_0x43353b(0x126)](_0x43353b(0x12a)+_0x337571[_0x43353b(0x112)]);}}async function createDailyDigest(_0x4edb78,_0x129484){const _0x44ec3d=a0_0x3e5959;if(!_0x4edb78[_0x44ec3d(0x18f)])return;if(!canCallApi()){await _0x4edb78['setStateAsync'](LTM_DP_STATUS,{'val':_0x44ec3d(0x190),'ack':!![]});return;}await _0x4edb78[_0x44ec3d(0x11d)](LTM_DP_STATUS,{'val':_0x44ec3d(0x160),'ack':!![]});if(!_0x4edb78['geminiModel']||_0x4edb78['rawEventLog'][_0x44ec3d(0x13e)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4edb78[_0x44ec3d(0x11d)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x2d9998=JSON[_0x44ec3d(0x10e)](JSON[_0x44ec3d(0x151)](_0x4edb78[_0x44ec3d(0x176)])),_0xe5c596=_0x2d9998[_0x44ec3d(0x13e)],_0x3eff2e=_0x44ec3d(0x175)+JSON[_0x44ec3d(0x151)](_0x2d9998);try{updateApiTimestamp();const _0x59e191=await _0x4edb78[_0x44ec3d(0x16f)]['generateContent'](_0x3eff2e),_0x745ac7=JSON[_0x44ec3d(0x10e)](_0x59e191['response'][_0x44ec3d(0x149)]()[_0x44ec3d(0x141)](/```json|```/g,'')[_0x44ec3d(0x12d)]()),_0x7e4d38={'timestamp':new Date()[_0x44ec3d(0x186)](),'eventCount':_0xe5c596,'summary':_0x745ac7[_0x44ec3d(0x179)]||_0x44ec3d(0x167),'activityLevel':_0x745ac7[_0x44ec3d(0x134)]||'normal','systemMode':_0x4edb78['currentSystemMode']};_0x4edb78['dailyDigests']['push'](_0x7e4d38);const _0x57b313=_0x4edb78['config'][_0x44ec3d(0x19a)]||0x3c;_0x4edb78[_0x44ec3d(0x193)][_0x44ec3d(0x13e)]>_0x57b313&&_0x4edb78[_0x44ec3d(0x193)][_0x44ec3d(0x165)](0x0,_0x4edb78['dailyDigests'][_0x44ec3d(0x13e)]-_0x57b313);await _0x4edb78[_0x44ec3d(0x11d)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x44ec3d(0x151)](_0x4edb78['dailyDigests']),'ack':!![]}),_0x4edb78[_0x44ec3d(0x176)]=[],await _0x4edb78['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x44ec3d(0x151)](_0x4edb78['rawEventLog']),'ack':!![]}),await _0x4edb78[_0x44ec3d(0x11d)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x298d21='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x745ac7['summary']+'\x0aAktivitÃ¤t:\x20'+_0x745ac7[_0x44ec3d(0x134)];setup['sendNotification'](_0x4edb78,_0x298d21,![],![]);if(_0x4edb78[_0x44ec3d(0x18f)]&&_0x129484)_0x129484[_0x44ec3d(0x18b)](_0x4edb78,'ANALYZE_HEALTH',{'digest':_0x7e4d38});}catch(_0x4d45a8){_0x4edb78[_0x44ec3d(0x117)][_0x44ec3d(0x126)](_0x4d45a8[_0x44ec3d(0x112)]);}}async function runBaselineDriftAnalysis(_0x4b29f4){const _0x5daa9d=a0_0x3e5959;if(!_0x4b29f4['isProVersion']||!_0x4b29f4[_0x5daa9d(0x16f)])return;if(!canCallApi())return;const _0x42ceb9=_0x4b29f4['config']['ltmStbWindowDays']||0xe;if(_0x4b29f4[_0x5daa9d(0x193)][_0x5daa9d(0x13e)]<_0x42ceb9+0x7){await _0x4b29f4[_0x5daa9d(0x11d)]('LTM.driftAnalysis.baselineDrift',{'val':_0x5daa9d(0x111),'ack':!![]});return;}const _0x3e844e=_0x4b29f4[_0x5daa9d(0x193)][_0x5daa9d(0x13c)](-_0x42ceb9),_0x1f6e96=_0x4b29f4['dailyDigests'][_0x5daa9d(0x13c)](0x0,_0x4b29f4[_0x5daa9d(0x193)]['length']-_0x42ceb9),_0x38fa58=_0x5daa9d(0x106)+JSON[_0x5daa9d(0x151)](_0x1f6e96)+_0x5daa9d(0x15f)+JSON[_0x5daa9d(0x151)](_0x3e844e);try{updateApiTimestamp();const _0x5175c1=await _0x4b29f4['geminiModel'][_0x5daa9d(0x148)](_0x38fa58),_0x553910=JSON[_0x5daa9d(0x10e)](_0x5175c1['response']['text']()[_0x5daa9d(0x141)](/```json|```/g,'')[_0x5daa9d(0x12d)]());_0x553910[_0x5daa9d(0x12c)]&&(await _0x4b29f4[_0x5daa9d(0x11d)](_0x5daa9d(0x13f),{'val':_0x553910['baselineDrift'],'ack':!![]}),await _0x4b29f4[_0x5daa9d(0x11d)]('LTM.driftAnalysis.driftDetails',{'val':_0x553910[_0x5daa9d(0x17b)],'ack':!![]}),await _0x4b29f4[_0x5daa9d(0x11d)](_0x5daa9d(0x14c),{'val':Date['now'](),'ack':!![]}));}catch(_0x12a0b5){}}async function executeAutomationAction(_0x463de6){const _0x5c1c81=a0_0x3e5959;try{const _0x422360=await _0x463de6[_0x5c1c81(0x16c)](_0x5c1c81(0x132)),_0x330dcc=await _0x463de6[_0x5c1c81(0x16c)](_0x5c1c81(0x164));if(_0x422360&&_0x422360[_0x5c1c81(0x187)]&&_0x330dcc){const _0x406e01=_0x422360[_0x5c1c81(0x187)];let _0x4b1c7e=_0x330dcc[_0x5c1c81(0x187)];try{_0x4b1c7e=JSON['parse'](_0x4b1c7e);}catch(_0x2b38e0){}_0x463de6[_0x5c1c81(0x117)]['info']('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x406e01+_0x5c1c81(0x142)+_0x4b1c7e),await _0x463de6[_0x5c1c81(0x17d)](_0x406e01,_0x4b1c7e);}else _0x463de6[_0x5c1c81(0x117)][_0x5c1c81(0x10f)](_0x5c1c81(0x170));}catch(_0x2a27d4){_0x463de6['log'][_0x5c1c81(0x126)]('BUTLER\x20Execution\x20Error:\x20'+_0x2a27d4[_0x5c1c81(0x112)]);}}async function sendMorningBriefing(_0x425613){const _0x429a80=a0_0x3e5959;if(!_0x425613['geminiModel']){_0x425613[_0x429a80(0x117)][_0x429a80(0x10f)]('ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x425613['log'][_0x429a80(0x16d)]('ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x4a87b2=_0x429a80(0x109),_0x3c6903=await _0x425613[_0x429a80(0x16f)][_0x429a80(0x148)](_0x4a87b2),_0x154d2d=_0x3c6903[_0x429a80(0x199)][_0x429a80(0x149)]();_0x425613[_0x429a80(0x117)][_0x429a80(0x16d)](_0x429a80(0x139)+_0x154d2d['length']+_0x429a80(0x129)),setup[_0x429a80(0x153)](_0x425613,_0x429a80(0x114)+_0x154d2d);}catch(_0x35cdd4){_0x425613[_0x429a80(0x117)][_0x429a80(0x126)]('Briefing\x20Error:\x20'+_0x35cdd4[_0x429a80(0x112)]);}}async function generateHealthReport(_0x5a6a72,_0x1f87ba){const _0x3800a1=a0_0x3e5959;if(!_0x5a6a72[_0x3800a1(0x16f)])return;const _0x4a4528=Date[_0x3800a1(0x146)]();_0x4a4528-lastGlobalApiCall<0xbb8&&(_0x5a6a72[_0x3800a1(0x117)]['debug'](_0x3800a1(0x14b)),await new Promise(_0x18f0a6=>setTimeout(_0x18f0a6,0x7d0)));const _0x49db46=new Date();let _0x505f78=0x0,_0x3fcce0=_0x49db46[_0x3800a1(0x161)](),_0x2a6fda='';if(_0x1f87ba===_0x3800a1(0x174)){const _0x19f11f=new Date(_0x49db46);_0x19f11f[_0x3800a1(0x172)](_0x19f11f['getDate']()-0x1),_0x19f11f['setHours'](0x16,0x0,0x0,0x0),_0x505f78=_0x19f11f[_0x3800a1(0x161)]();const _0x15a1e0=new Date(_0x49db46);_0x15a1e0[_0x3800a1(0x180)](0x8,0x0,0x0,0x0),_0x3fcce0=_0x15a1e0['getTime'](),_0x2a6fda='Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).';}else{const _0x433327=new Date(_0x49db46);_0x433327[_0x3800a1(0x180)](0x8,0x0,0x0,0x0),_0x505f78=_0x433327[_0x3800a1(0x161)](),_0x2a6fda=_0x3800a1(0x15b);}const _0x23e23d=_0x5a6a72[_0x3800a1(0x155)][_0x3800a1(0x162)](_0x47a3b4=>_0x47a3b4[_0x3800a1(0x12b)]>=_0x505f78&&_0x47a3b4[_0x3800a1(0x12b)]<=_0x3fcce0);if(_0x23e23d[_0x3800a1(0x13e)]===0x0){const _0x384f83=_0x1f87ba===_0x3800a1(0x174)?'Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).':_0x3800a1(0x122),_0x4b19a0=_0x1f87ba==='NIGHT'?_0x3800a1(0x166):_0x3800a1(0x189);await _0x5a6a72[_0x3800a1(0x11d)](_0x4b19a0,{'val':_0x384f83,'ack':!![]});return;}const _0x49aa8b=_0x23e23d[_0x3800a1(0x18e)](_0x3d2da9=>new Date(_0x3d2da9[_0x3800a1(0x12b)])[_0x3800a1(0x11b)]([],{'hour':'2-digit','minute':_0x3800a1(0x125)})+'\x20'+_0x3d2da9['name']+'\x20('+_0x3d2da9['value']+')')[_0x3800a1(0x13a)]('\x0a'),_0x31e295=_0x3800a1(0x127)+_0x2a6fda+_0x3800a1(0x157)+_0x49aa8b+_0x3800a1(0x116);try{updateApiTimestamp();const _0x287bc3=await _0x5a6a72[_0x3800a1(0x16f)][_0x3800a1(0x148)](_0x31e295),_0x4f90e7=_0x287bc3[_0x3800a1(0x199)][_0x3800a1(0x149)](),_0x54a056=_0x1f87ba===_0x3800a1(0x174)?_0x3800a1(0x166):_0x3800a1(0x189);await _0x5a6a72[_0x3800a1(0x11d)](_0x54a056,{'val':_0x4f90e7,'ack':!![]}),_0x5a6a72[_0x3800a1(0x117)][_0x3800a1(0x16d)](_0x3800a1(0x163)+_0x1f87ba+_0x3800a1(0x18a));}catch(_0x4c6e85){_0x5a6a72[_0x3800a1(0x117)][_0x3800a1(0x126)](_0x3800a1(0x143)+_0x4c6e85['message']);}}module['exports']={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};