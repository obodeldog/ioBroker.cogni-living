const a0_0x5820cc=a0_0x1d0d;(function(_0x9d3137,_0x5b7efb){const _0x122f6d=a0_0x1d0d,_0x564db2=_0x9d3137();while(!![]){try{const _0x44177f=-parseInt(_0x122f6d(0x156))/0x1+-parseInt(_0x122f6d(0x179))/0x2*(parseInt(_0x122f6d(0x1b7))/0x3)+-parseInt(_0x122f6d(0x159))/0x4+parseInt(_0x122f6d(0x1a1))/0x5+-parseInt(_0x122f6d(0x1a0))/0x6*(parseInt(_0x122f6d(0x162))/0x7)+-parseInt(_0x122f6d(0x144))/0x8+-parseInt(_0x122f6d(0x14a))/0x9*(-parseInt(_0x122f6d(0x13a))/0xa);if(_0x44177f===_0x5b7efb)break;else _0x564db2['push'](_0x564db2['shift']());}catch(_0x469bf7){_0x564db2['push'](_0x564db2['shift']());}}}(a0_0x42f6,0xc4921));function a0_0x42f6(){const _0x30d57c=['NIGHT','./setup','Tag','value','5272640wdDXMC','rawEventLog',',\x20Wetter:\x20','analysis.health.geminiDay','map','error','1251yhdQsH','.\x20KONTEXT:\x20','analysis.automation.targetId','text','Keine\x20Details.','name','\x20√ºbersprungen\x20(Auto-Approved).','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','üåÖ\x20Morning\x20Briefing:\x0a','currentSystemMode','@google/generative-ai','length','122686TqCqKc','useWeather','setHours','5528820VNgFbt','response','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','search','.forecast.current.state','send','replace','now','analysis.activitySummary','1117011EWHYdv','targetValue','analysis.isAlert','val','generic','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','analysis.analysisHistory','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','analysis.automation.autoApply','warn','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','Skipped\x20(No\x20AI\x20or\x20Data)','setStateAsync','\x20->\x20','ANALYZE_HEALTH','\x0aSTB:\x20','analysis.automation.patternDetected','Success','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','toString','Wetterdaten\x20nicht\x20abrufbar','livingContext','LTM.driftAnalysis.lastCheck','6cDIgkG','getForeignStateAsync','üìÖ\x20Daily\x20Digest:\x0a','LTM.rawEventLog','analysisHistory','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','weatherInstance','message','models/gemini-flash-latest','Skipped\x20(Traffic)','analysis.automation.targetValue','‚ö†Ô∏è\x20ALARM:\x20','lastAlertState','eventHistory','LTM.driftAnalysis.baselineDrift','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','¬∞C,\x20','.Current.IsNight','KI\x20offline\x20(Fallback)','2-digit','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','ü§ñ\x20Butler\x20Brain\x20Error:\x20','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','LTM.processingStatus','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','system.presenceWho','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','%)\x20nach\x20\x22','geminiModel','automationProposal','baselineDrift','push','debug','stringify','config','unshift','dailyDigests','60SXVwGC','623725uQTaTY','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','\x0aAktivit√§t:\x20','aiPersona','trim','Unbekannt','ltmLtbWindowDays','N/A\x20(Learning)','BUTLER\x20Execution\x20Error:\x20','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','timestamp','LTM.dailyDigests','log','splice','info','alertReason','parse','ltmStbWindowDays','isProVersion','analysis.health.geminiNight','getTime','slice','1208712gRNSnc','.Current.Temperature','analysis.lastResult','exports','Digest','description','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','summary','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','getStateAsync','toLocaleTimeString','ü§ñ\x20Health\x20Report\x20(','isAlert','KI-Fehler\x20(Fallback)','detected','generateContent',',\x20Lichtverh√§ltnisse:\x20','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','.forecast.current.temperature','sendNotification','.\x20EMERGENCY:\x20','analysis.alertReason','.\x20SYSTEM_MODE:\x20','Traffic-Schutz\x20(Auto-Approved)','406390TyizBe','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','targetId','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','\x0a\x20\x20\x20\x20EVENTS:\x0a'];a0_0x42f6=function(){return _0x30d57c;};return a0_0x42f6();}const a0_0xa753f9=(function(){let _0x4e04ac=!![];return function(_0x1bd134,_0x55c325){const _0x50b7ba=_0x4e04ac?function(){if(_0x55c325){const _0xe07d50=_0x55c325['apply'](_0x1bd134,arguments);return _0x55c325=null,_0xe07d50;}}:function(){};return _0x4e04ac=![],_0x50b7ba;};}()),a0_0x473651=a0_0xa753f9(this,function(){const _0x3235f3=a0_0x1d0d;return a0_0x473651['toString']()['search']('(((.+)+)+)+$')[_0x3235f3(0x175)]()['constructor'](a0_0x473651)[_0x3235f3(0x15c)]('(((.+)+)+)+$');});a0_0x473651();'use strict';const {GoogleGenerativeAI}=require(a0_0x5820cc(0x154)),setup=require(a0_0x5820cc(0x141)),GEMINI_MODEL=a0_0x5820cc(0x183),LTM_DP_DAILY_DIGESTS=a0_0x5820cc(0x1ac),LTM_DP_STATUS=a0_0x5820cc(0x192),LTM_DP_RAW_LOG=a0_0x5820cc(0x17c),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;function a0_0x1d0d(_0xe3d2f8,_0x42d4d9){const _0x4920fb=a0_0x42f6();return a0_0x1d0d=function(_0x473651,_0xa753f9){_0x473651=_0x473651-0x135;let _0x42f6c1=_0x4920fb[_0x473651];return _0x42f6c1;},a0_0x1d0d(_0xe3d2f8,_0x42d4d9);}const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x5820cc(0x1bf),'senior_aal':a0_0x5820cc(0x169),'family':a0_0x5820cc(0x17f),'single_comfort':'Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x5820cc(0x193)};function canCallApi(){const _0xdd5096=a0_0x5820cc,_0x1d32fb=Date[_0xdd5096(0x160)]();return _0x1d32fb-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x43c52d=a0_0x5820cc;lastGlobalApiCall=Date[_0x43c52d(0x160)]();}async function getWeatherContext(_0x4087df){const _0x11a90d=a0_0x5820cc;if(!_0x4087df[_0x11a90d(0x19d)][_0x11a90d(0x157)]||!_0x4087df[_0x11a90d(0x19d)]['weatherInstance'])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x3d4f82=_0x4087df[_0x11a90d(0x19d)][_0x11a90d(0x181)];let _0x458f1f=await _0x4087df[_0x11a90d(0x17a)](_0x3d4f82+_0x11a90d(0x1b8));if(!_0x458f1f)_0x458f1f=await _0x4087df[_0x11a90d(0x17a)](_0x3d4f82+_0x11a90d(0x1c9));let _0x3fa28e=await _0x4087df['getForeignStateAsync'](_0x3d4f82+'.Current.WeatherText');if(!_0x3fa28e)_0x3fa28e=await _0x4087df[_0x11a90d(0x17a)](_0x3d4f82+_0x11a90d(0x15d));let _0x2401ba=_0x11a90d(0x1a6);const _0x119a70=await _0x4087df[_0x11a90d(0x17a)](_0x3d4f82+_0x11a90d(0x18c));if(_0x119a70)_0x2401ba=_0x119a70[_0x11a90d(0x165)]?'Nacht':_0x11a90d(0x142);if(_0x458f1f&&_0x3fa28e)return _0x458f1f['val']+_0x11a90d(0x18b)+_0x3fa28e['val']+_0x11a90d(0x1c7)+_0x2401ba;}catch(_0x579294){}return _0x11a90d(0x176);}async function consultButler(_0x351a8c,_0x3385b2,_0x5d14a3,_0x40cfc0){const _0x12c456=a0_0x5820cc;if(!_0x351a8c[_0x12c456(0x197)])return{'approved':!![],'reason':_0x12c456(0x18d)};const _0x37795f=Date[_0x12c456(0x160)]();if(decisionCache[_0x3385b2]&&_0x37795f-decisionCache[_0x3385b2]['timestamp']<CACHE_TTL_MS){const _0x3e6b6d=decisionCache[_0x3385b2]['decision'];return _0x351a8c[_0x12c456(0x1ad)][_0x12c456(0x19b)]('ü§ñ\x20Butler\x20Cache\x20Hit:\x20'+_0x3385b2+_0x12c456(0x16f)+(_0x3e6b6d['approved']?'OK':'NO')+'\x20('+_0x3e6b6d['reason']+')'),_0x3e6b6d;}if(!canCallApi())return _0x351a8c[_0x12c456(0x1ad)]['debug'](_0x12c456(0x15b)+_0x3385b2+_0x12c456(0x150)),{'approved':!![],'reason':_0x12c456(0x139)};const _0x2edd3c=new Date()['toLocaleTimeString'](),_0x5a97fd=await getWeatherContext(_0x351a8c),_0x599ee2=PERSONA_MAPPING[_0x351a8c[_0x12c456(0x19d)][_0x12c456(0x1a4)]||'generic'],_0x56d099=_0x12c456(0x195)+_0x2edd3c+_0x12c456(0x146)+_0x5a97fd+_0x12c456(0x174)+(_0x40cfc0*0x64)['toFixed'](0x0)+_0x12c456(0x196)+_0x3385b2+_0x12c456(0x1a2)+_0x5d14a3+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x599ee2+_0x12c456(0x18f);try{updateApiTimestamp();const _0x2b731b=await _0x351a8c[_0x12c456(0x197)]['generateContent'](_0x56d099),_0x488d97=_0x2b731b['response'][_0x12c456(0x14d)]()[_0x12c456(0x15f)](/```json|```/g,'')[_0x12c456(0x1a5)](),_0x5e661a=JSON[_0x12c456(0x1b1)](_0x488d97);return decisionCache[_0x3385b2]={'decision':_0x5e661a,'timestamp':_0x37795f},_0x5e661a;}catch(_0x531604){return _0x351a8c[_0x12c456(0x1ad)]['warn'](_0x12c456(0x190)+_0x531604[_0x12c456(0x182)]),decisionCache[_0x3385b2]={'decision':{'approved':!![],'reason':_0x12c456(0x1c4)},'timestamp':_0x37795f-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x12c456(0x1c4)};}}async function runGeminiAnalysis(_0x5874ba,_0x13b799=''){const _0x2c2c72=a0_0x5820cc;if(!_0x5874ba[_0x2c2c72(0x197)])return;if(!canCallApi()){_0x5874ba['log'][_0x2c2c72(0x19b)](_0x2c2c72(0x13d));return;}if(_0x5874ba[_0x2c2c72(0x188)][_0x2c2c72(0x155)]===0x0)return;const _0xcfae53=_0x5874ba['eventHistory']['slice'](0x0,0xf),_0xd270d5=_0x5874ba[_0x2c2c72(0x153)],_0x19a0d7=PERSONA_MAPPING[_0x5874ba[_0x2c2c72(0x19d)]['aiPersona']||_0x2c2c72(0x166)],_0x1718a4=_0x5874ba[_0x2c2c72(0x19d)][_0x2c2c72(0x177)]||_0x2c2c72(0x14e);let _0x274a23='Unbekannt';try{const _0x246a8c=await _0x5874ba[_0x2c2c72(0x1c0)](_0x2c2c72(0x194));if(_0x246a8c&&_0x246a8c['val'])_0x274a23=_0x246a8c[_0x2c2c72(0x165)];}catch(_0x17913d){}let _0x379eaf=![];try{const _0x260815=await _0x5874ba[_0x2c2c72(0x1c0)](_0x2c2c72(0x16a));if(_0x260815&&_0x260815[_0x2c2c72(0x165)])_0x379eaf=!![];}catch(_0x5ef123){}const _0x308dd4=_0x2c2c72(0x16c)+_0x19a0d7+_0x2c2c72(0x14b)+_0x1718a4+_0x2c2c72(0x138)+_0xd270d5+'.\x20ANWESEND:\x20'+_0x274a23+'.\x20EVENTS:\x20'+JSON[_0x2c2c72(0x19c)](_0xcfae53)+_0x2c2c72(0x136)+_0x13b799+_0x2c2c72(0x13b);try{updateApiTimestamp();const _0x41beb5=await _0x5874ba[_0x2c2c72(0x197)][_0x2c2c72(0x1c6)](_0x308dd4),_0x5dbcb0=JSON['parse'](_0x41beb5[_0x2c2c72(0x15a)]['text']()[_0x2c2c72(0x15f)](/```json|```/g,'')[_0x2c2c72(0x1a5)]());await _0x5874ba['setStateAsync'](_0x2c2c72(0x1b9),{'val':JSON[_0x2c2c72(0x19c)](_0x5dbcb0),'ack':!![]});if(_0x5dbcb0[_0x2c2c72(0x1be)])await _0x5874ba[_0x2c2c72(0x16e)](_0x2c2c72(0x161),{'val':_0x5dbcb0[_0x2c2c72(0x1be)],'ack':!![]});const _0x3bfa06={'timestamp':Date['now'](),'id':Date[_0x2c2c72(0x160)]()[_0x2c2c72(0x175)](),'analysis':{'activity':{'summary':_0x5dbcb0[_0x2c2c72(0x1be)],'isAlert':_0x5dbcb0[_0x2c2c72(0x1c3)],'alertReason':_0x5dbcb0[_0x2c2c72(0x1b0)]},'comfort':{'automationProposal':_0x5dbcb0[_0x2c2c72(0x198)]}}};_0x5874ba[_0x2c2c72(0x17d)][_0x2c2c72(0x19e)](_0x3bfa06);if(_0x5874ba[_0x2c2c72(0x17d)][_0x2c2c72(0x155)]>0x32)_0x5874ba[_0x2c2c72(0x17d)]['pop']();await _0x5874ba[_0x2c2c72(0x16e)](_0x2c2c72(0x168),{'val':JSON['stringify'](_0x5874ba[_0x2c2c72(0x17d)]),'ack':!![]});const _0x31de00=_0x5dbcb0[_0x2c2c72(0x1c3)]||![];_0x31de00!==_0x5874ba['lastAlertState']&&(await _0x5874ba[_0x2c2c72(0x16e)](_0x2c2c72(0x164),{'val':_0x31de00,'ack':!![]}),_0x5874ba[_0x2c2c72(0x187)]=_0x31de00,_0x31de00&&(await _0x5874ba[_0x2c2c72(0x16e)](_0x2c2c72(0x137),{'val':_0x5dbcb0[_0x2c2c72(0x1b0)],'ack':!![]}),setup[_0x2c2c72(0x135)](_0x5874ba,_0x2c2c72(0x186)+_0x5dbcb0['alertReason'],![],_0x5dbcb0['isEmergency'])));if(_0x5dbcb0[_0x2c2c72(0x198)]&&_0x5dbcb0[_0x2c2c72(0x198)][_0x2c2c72(0x1c5)]){await _0x5874ba['setStateAsync'](_0x2c2c72(0x172),{'val':!![],'ack':!![]}),await _0x5874ba[_0x2c2c72(0x16e)]('analysis.automation.description',{'val':_0x5dbcb0[_0x2c2c72(0x198)][_0x2c2c72(0x1bc)],'ack':!![]}),await _0x5874ba['setStateAsync'](_0x2c2c72(0x14c),{'val':_0x5dbcb0[_0x2c2c72(0x198)][_0x2c2c72(0x13c)],'ack':!![]}),await _0x5874ba[_0x2c2c72(0x16e)]('analysis.automation.targetValue',{'val':JSON[_0x2c2c72(0x19c)](_0x5dbcb0[_0x2c2c72(0x198)][_0x2c2c72(0x163)]),'ack':!![]});if(_0x379eaf)executeAutomationAction(_0x5874ba);}}catch(_0x18e33c){_0x5874ba[_0x2c2c72(0x1ad)][_0x2c2c72(0x149)]('Gemini\x20Error:\x20'+_0x18e33c[_0x2c2c72(0x182)]);}}async function createDailyDigest(_0x2f0a3b,_0x33a649){const _0x170206=a0_0x5820cc;if(!_0x2f0a3b[_0x170206(0x1b3)])return;if(!canCallApi()){await _0x2f0a3b[_0x170206(0x16e)](LTM_DP_STATUS,{'val':_0x170206(0x184),'ack':!![]});return;}await _0x2f0a3b[_0x170206(0x16e)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x2f0a3b[_0x170206(0x197)]||_0x2f0a3b[_0x170206(0x145)][_0x170206(0x155)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2f0a3b[_0x170206(0x16e)](LTM_DP_STATUS,{'val':_0x170206(0x16d),'ack':!![]});return;}const _0x857919=JSON['parse'](JSON['stringify'](_0x2f0a3b[_0x170206(0x145)])),_0x22f36e=_0x857919[_0x170206(0x155)],_0x952a7f=_0x170206(0x151)+JSON[_0x170206(0x19c)](_0x857919);try{updateApiTimestamp();const _0x319c11=await _0x2f0a3b['geminiModel'][_0x170206(0x1c6)](_0x952a7f),_0x1a530f=JSON['parse'](_0x319c11[_0x170206(0x15a)][_0x170206(0x14d)]()['replace'](/```json|```/g,'')['trim']()),_0x15572f={'timestamp':new Date()['toISOString'](),'eventCount':_0x22f36e,'summary':_0x1a530f['summary']||_0x170206(0x1bb),'activityLevel':_0x1a530f['activityLevel']||'normal','systemMode':_0x2f0a3b[_0x170206(0x153)]};_0x2f0a3b[_0x170206(0x19f)][_0x170206(0x19a)](_0x15572f);const _0x9feb32=_0x2f0a3b[_0x170206(0x19d)][_0x170206(0x1a7)]||0x3c;_0x2f0a3b[_0x170206(0x19f)][_0x170206(0x155)]>_0x9feb32&&_0x2f0a3b[_0x170206(0x19f)][_0x170206(0x1ae)](0x0,_0x2f0a3b[_0x170206(0x19f)][_0x170206(0x155)]-_0x9feb32);await _0x2f0a3b[_0x170206(0x16e)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x170206(0x19c)](_0x2f0a3b[_0x170206(0x19f)]),'ack':!![]}),_0x2f0a3b[_0x170206(0x145)]=[],await _0x2f0a3b[_0x170206(0x16e)](LTM_DP_RAW_LOG,{'val':JSON[_0x170206(0x19c)](_0x2f0a3b[_0x170206(0x145)]),'ack':!![]}),await _0x2f0a3b['setStateAsync'](LTM_DP_STATUS,{'val':_0x170206(0x173),'ack':!![]});const _0x3cb305=_0x170206(0x17b)+_0x1a530f['summary']+_0x170206(0x1a3)+_0x1a530f['activityLevel'];setup[_0x170206(0x135)](_0x2f0a3b,_0x3cb305,![],![]);if(_0x2f0a3b[_0x170206(0x1b3)]&&_0x33a649)_0x33a649[_0x170206(0x15e)](_0x2f0a3b,_0x170206(0x170),{'digest':_0x15572f});}catch(_0x314d5c){_0x2f0a3b[_0x170206(0x1ad)]['error'](_0x314d5c[_0x170206(0x182)]);}}async function runBaselineDriftAnalysis(_0x5da83e){const _0x5e18c7=a0_0x5820cc;if(!_0x5da83e[_0x5e18c7(0x1b3)]||!_0x5da83e[_0x5e18c7(0x197)])return;if(!canCallApi())return;const _0x4e0c14=_0x5da83e['config'][_0x5e18c7(0x1b2)]||0xe;if(_0x5da83e[_0x5e18c7(0x19f)][_0x5e18c7(0x155)]<_0x4e0c14+0x7){await _0x5da83e[_0x5e18c7(0x16e)](_0x5e18c7(0x189),{'val':_0x5e18c7(0x1a8),'ack':!![]});return;}const _0x56249e=_0x5da83e[_0x5e18c7(0x19f)]['slice'](-_0x4e0c14),_0x4196ea=_0x5da83e[_0x5e18c7(0x19f)][_0x5e18c7(0x1b6)](0x0,_0x5da83e[_0x5e18c7(0x19f)]['length']-_0x4e0c14),_0x4c0179=_0x5e18c7(0x167)+JSON[_0x5e18c7(0x19c)](_0x4196ea)+_0x5e18c7(0x171)+JSON[_0x5e18c7(0x19c)](_0x56249e);try{updateApiTimestamp();const _0x1e8a17=await _0x5da83e[_0x5e18c7(0x197)][_0x5e18c7(0x1c6)](_0x4c0179),_0x39c98b=JSON[_0x5e18c7(0x1b1)](_0x1e8a17[_0x5e18c7(0x15a)][_0x5e18c7(0x14d)]()[_0x5e18c7(0x15f)](/```json|```/g,'')[_0x5e18c7(0x1a5)]());_0x39c98b[_0x5e18c7(0x199)]&&(await _0x5da83e[_0x5e18c7(0x16e)]('LTM.driftAnalysis.baselineDrift',{'val':_0x39c98b[_0x5e18c7(0x199)],'ack':!![]}),await _0x5da83e[_0x5e18c7(0x16e)]('LTM.driftAnalysis.driftDetails',{'val':_0x39c98b['driftDetails'],'ack':!![]}),await _0x5da83e['setStateAsync'](_0x5e18c7(0x178),{'val':Date['now'](),'ack':!![]}));}catch(_0x1a4dbe){}}async function executeAutomationAction(_0x3edb56){const _0xdf216d=a0_0x5820cc;try{const _0x151a3c=await _0x3edb56['getStateAsync'](_0xdf216d(0x14c)),_0x3aa7f2=await _0x3edb56[_0xdf216d(0x1c0)](_0xdf216d(0x185));if(_0x151a3c&&_0x151a3c[_0xdf216d(0x165)]&&_0x3aa7f2){const _0x1889e2=_0x151a3c[_0xdf216d(0x165)];let _0x4f0094=_0x3aa7f2[_0xdf216d(0x165)];try{_0x4f0094=JSON[_0xdf216d(0x1b1)](_0x4f0094);}catch(_0x149a9e){}_0x3edb56['log']['info'](_0xdf216d(0x1c8)+_0x1889e2+'\x20=\x20'+_0x4f0094),await _0x3edb56['setForeignStateAsync'](_0x1889e2,_0x4f0094);}else _0x3edb56['log']['warn'](_0xdf216d(0x180));}catch(_0x1576da){_0x3edb56[_0xdf216d(0x1ad)][_0xdf216d(0x149)](_0xdf216d(0x1a9)+_0x1576da[_0xdf216d(0x182)]);}}async function sendMorningBriefing(_0x1bb1e0){const _0x2c2b9c=a0_0x5820cc;if(!_0x1bb1e0['geminiModel']){_0x1bb1e0[_0x2c2b9c(0x1ad)][_0x2c2b9c(0x16b)]('ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x1bb1e0[_0x2c2b9c(0x1ad)]['info'](_0x2c2b9c(0x17e));try{updateApiTimestamp();const _0x5ac118=_0x2c2b9c(0x1aa),_0x4b665f=await _0x1bb1e0[_0x2c2b9c(0x197)]['generateContent'](_0x5ac118),_0x5d440c=_0x4b665f[_0x2c2b9c(0x15a)][_0x2c2b9c(0x14d)]();_0x1bb1e0['log'][_0x2c2b9c(0x1af)]('üåÖ\x20Briefing\x20generated\x20(Length:\x20'+_0x5d440c[_0x2c2b9c(0x155)]+').\x20Sending\x20notification...'),setup[_0x2c2b9c(0x135)](_0x1bb1e0,_0x2c2b9c(0x152)+_0x5d440c);}catch(_0xf56972){_0x1bb1e0[_0x2c2b9c(0x1ad)][_0x2c2b9c(0x149)]('Briefing\x20Error:\x20'+_0xf56972[_0x2c2b9c(0x182)]);}}async function generateHealthReport(_0x5f442f,_0x3b5c65){const _0x444cef=a0_0x5820cc;if(!_0x5f442f[_0x444cef(0x197)])return;const _0x36af6e=Date[_0x444cef(0x160)]();_0x36af6e-lastGlobalApiCall<0xbb8&&(_0x5f442f['log']['debug'](_0x444cef(0x18a)),await new Promise(_0x571637=>setTimeout(_0x571637,0x7d0)));const _0x47e6d4=new Date();let _0x436af9=0x0,_0x33980d=_0x47e6d4[_0x444cef(0x1b5)](),_0x53f587='';if(_0x3b5c65===_0x444cef(0x140)){const _0x59894f=new Date(_0x47e6d4);_0x59894f['setDate'](_0x59894f['getDate']()-0x1),_0x59894f[_0x444cef(0x158)](0x16,0x0,0x0,0x0),_0x436af9=_0x59894f[_0x444cef(0x1b5)]();const _0x3960b8=new Date(_0x47e6d4);_0x3960b8[_0x444cef(0x158)](0x8,0x0,0x0,0x0),_0x33980d=_0x3960b8['getTime'](),_0x53f587='Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).';}else{const _0x42155e=new Date(_0x47e6d4);_0x42155e[_0x444cef(0x158)](0x8,0x0,0x0,0x0),_0x436af9=_0x42155e[_0x444cef(0x1b5)](),_0x53f587='Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).';}const _0x41c1e1=_0x5f442f[_0x444cef(0x188)]['filter'](_0x592f4a=>_0x592f4a[_0x444cef(0x1ab)]>=_0x436af9&&_0x592f4a['timestamp']<=_0x33980d);if(_0x41c1e1[_0x444cef(0x155)]===0x0){const _0x58ea13=_0x3b5c65===_0x444cef(0x140)?_0x444cef(0x191):_0x444cef(0x13e),_0x5641ca=_0x3b5c65===_0x444cef(0x140)?_0x444cef(0x1b4):_0x444cef(0x147);await _0x5f442f[_0x444cef(0x16e)](_0x5641ca,{'val':_0x58ea13,'ack':!![]});return;}const _0x5bbfa9=_0x41c1e1[_0x444cef(0x148)](_0x15e949=>new Date(_0x15e949[_0x444cef(0x1ab)])[_0x444cef(0x1c1)]([],{'hour':'2-digit','minute':_0x444cef(0x18e)})+'\x20'+_0x15e949[_0x444cef(0x14f)]+'\x20('+_0x15e949[_0x444cef(0x143)]+')')['join']('\x0a'),_0x150a5e='\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20'+_0x53f587+_0x444cef(0x13f)+_0x5bbfa9+_0x444cef(0x1bd);try{updateApiTimestamp();const _0x4ceef2=await _0x5f442f[_0x444cef(0x197)][_0x444cef(0x1c6)](_0x150a5e),_0x300960=_0x4ceef2[_0x444cef(0x15a)][_0x444cef(0x14d)](),_0x7f032d=_0x3b5c65===_0x444cef(0x140)?_0x444cef(0x1b4):'analysis.health.geminiDay';await _0x5f442f[_0x444cef(0x16e)](_0x7f032d,{'val':_0x300960,'ack':!![]}),_0x5f442f[_0x444cef(0x1ad)][_0x444cef(0x1af)](_0x444cef(0x1c2)+_0x3b5c65+')\x20generated.');}catch(_0x1aa1ba){_0x5f442f[_0x444cef(0x1ad)][_0x444cef(0x149)]('Health\x20Report\x20Error:\x20'+_0x1aa1ba['message']);}}module[a0_0x5820cc(0x1ba)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};