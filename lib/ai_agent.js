const a0_0x58bb8f=a0_0x4192;(function(_0x481e50,_0x212fda){const _0x160422=a0_0x4192,_0x23af48=_0x481e50();while(!![]){try{const _0x1c3070=parseInt(_0x160422(0x203))/0x1+-parseInt(_0x160422(0x207))/0x2+parseInt(_0x160422(0x1e5))/0x3+parseInt(_0x160422(0x237))/0x4*(-parseInt(_0x160422(0x221))/0x5)+parseInt(_0x160422(0x1dc))/0x6*(-parseInt(_0x160422(0x1d7))/0x7)+parseInt(_0x160422(0x223))/0x8+parseInt(_0x160422(0x20c))/0x9;if(_0x1c3070===_0x212fda)break;else _0x23af48['push'](_0x23af48['shift']());}catch(_0x3944c9){_0x23af48['push'](_0x23af48['shift']());}}}(a0_0x44fe,0xb0c44));function a0_0x4192(_0xc0eab2,_0x4809b5){const _0x322596=a0_0x44fe();return a0_0x4192=function(_0x40e3be,_0x21157c){_0x40e3be=_0x40e3be-0x1c3;let _0x44fe8e=_0x322596[_0x40e3be];return _0x44fe8e;},a0_0x4192(_0xc0eab2,_0x4809b5);}const a0_0x21157c=(function(){let _0x196551=!![];return function(_0x430348,_0x1c76d0){const _0x379612=_0x196551?function(){const _0x5ea8a3=a0_0x4192;if(_0x1c76d0){const _0x4d15aa=_0x1c76d0[_0x5ea8a3(0x1dd)](_0x430348,arguments);return _0x1c76d0=null,_0x4d15aa;}}:function(){};return _0x196551=![],_0x379612;};}()),a0_0x40e3be=a0_0x21157c(this,function(){const _0x22dfaa=a0_0x4192;return a0_0x40e3be[_0x22dfaa(0x1ee)]()[_0x22dfaa(0x1ec)]('(((.+)+)+)+$')[_0x22dfaa(0x1ee)]()['constructor'](a0_0x40e3be)['search']('(((.+)+)+)+$');});a0_0x40e3be();'use strict';const {GoogleGenerativeAI}=require('@google/generative-ai'),setup=require('./setup'),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x58bb8f(0x212),LTM_DP_STATUS=a0_0x58bb8f(0x1f9),LTM_DP_RAW_LOG=a0_0x58bb8f(0x1fa),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x58bb8f(0x1d2),'senior_aal':'PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':a0_0x58bb8f(0x1e3),'single_comfort':a0_0x58bb8f(0x1f3),'security':a0_0x58bb8f(0x1d9),'energy_saver':a0_0x58bb8f(0x240)};function canCallApi(){const _0x5c2683=a0_0x58bb8f,_0x5b2eb6=Date[_0x5c2683(0x214)]();return _0x5b2eb6-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x22b381=a0_0x58bb8f;lastGlobalApiCall=Date[_0x22b381(0x214)]();}async function getWeatherContext(_0xf848a){const _0x45f237=a0_0x58bb8f;if(!_0xf848a[_0x45f237(0x228)][_0x45f237(0x1f0)]||!_0xf848a[_0x45f237(0x228)][_0x45f237(0x1d5)])return _0x45f237(0x1d1);try{const _0x5b8643=_0xf848a[_0x45f237(0x228)][_0x45f237(0x1d5)];let _0x5e4308=await _0xf848a[_0x45f237(0x1c3)](_0x5b8643+_0x45f237(0x234));if(!_0x5e4308)_0x5e4308=await _0xf848a[_0x45f237(0x1c3)](_0x5b8643+_0x45f237(0x227));let _0x160a5d=await _0xf848a[_0x45f237(0x1c3)](_0x5b8643+_0x45f237(0x238));if(!_0x160a5d)_0x160a5d=await _0xf848a['getForeignStateAsync'](_0x5b8643+'.forecast.current.state');let _0x464bf7=_0x45f237(0x1ea);const _0x1ea3b3=await _0xf848a[_0x45f237(0x1c3)](_0x5b8643+_0x45f237(0x22d));if(_0x1ea3b3)_0x464bf7=_0x1ea3b3['val']?_0x45f237(0x233):_0x45f237(0x216);if(_0x5e4308&&_0x160a5d)return _0x5e4308['val']+'Â°C,\x20'+_0x160a5d[_0x45f237(0x245)]+_0x45f237(0x1e2)+_0x464bf7;}catch(_0x4aaba8){}return _0x45f237(0x1e6);}async function consultButler(_0x3b4935,_0x4220f9,_0xea3133,_0x2ef005){const _0x54bd52=a0_0x58bb8f;if(!_0x3b4935['geminiModel'])return{'approved':!![],'reason':_0x54bd52(0x229)};const _0x5e6b59=Date[_0x54bd52(0x214)]();if(decisionCache[_0x4220f9]&&_0x5e6b59-decisionCache[_0x4220f9][_0x54bd52(0x20d)]<CACHE_TTL_MS){const _0x3c43ea=decisionCache[_0x4220f9][_0x54bd52(0x1d0)];return _0x3b4935[_0x54bd52(0x1f5)][_0x54bd52(0x1ed)](_0x54bd52(0x1f7)+_0x4220f9+_0x54bd52(0x222)+(_0x3c43ea[_0x54bd52(0x23c)]?'OK':'NO')+'\x20('+_0x3c43ea[_0x54bd52(0x1c9)]+')'),_0x3c43ea;}if(!canCallApi())return _0x3b4935[_0x54bd52(0x1f5)][_0x54bd52(0x1ed)](_0x54bd52(0x1e4)+_0x4220f9+_0x54bd52(0x22c)),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x3f4383=new Date()[_0x54bd52(0x243)](),_0x31d77a=await getWeatherContext(_0x3b4935),_0x4a55b5=PERSONA_MAPPING[_0x3b4935[_0x54bd52(0x228)][_0x54bd52(0x1fc)]||_0x54bd52(0x22a)],_0x342f56=_0x54bd52(0x220)+_0x3f4383+_0x54bd52(0x1cb)+_0x31d77a+_0x54bd52(0x1df)+(_0x2ef005*0x64)[_0x54bd52(0x20b)](0x0)+_0x54bd52(0x239)+_0x4220f9+'\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22'+_0xea3133+_0x54bd52(0x231)+_0x4a55b5+_0x54bd52(0x21f);try{updateApiTimestamp();const _0x26cabf=await _0x3b4935[_0x54bd52(0x1eb)][_0x54bd52(0x219)](_0x342f56),_0x2301e5=_0x26cabf['response'][_0x54bd52(0x215)]()[_0x54bd52(0x23b)](/```json|```/g,'')[_0x54bd52(0x1e0)](),_0x5d893f=JSON[_0x54bd52(0x1e8)](_0x2301e5);return decisionCache[_0x4220f9]={'decision':_0x5d893f,'timestamp':_0x5e6b59},_0x5d893f;}catch(_0x2d57e5){return _0x3b4935[_0x54bd52(0x1f5)][_0x54bd52(0x20e)]('ðŸ¤–\x20Butler\x20Brain\x20Error:\x20'+_0x2d57e5[_0x54bd52(0x1d3)]),decisionCache[_0x4220f9]={'decision':{'approved':!![],'reason':_0x54bd52(0x204)},'timestamp':_0x5e6b59-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'};}}function a0_0x44fe(){const _0x583ddc=['6KLHzUv','apply','lastAlertState','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','trim','\x20=\x20',',\x20LichtverhÃ¤ltnisse:\x20','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','2720004IabeKL','Wetterdaten\x20nicht\x20abrufbar','LTM.driftAnalysis.driftDetails','parse','activityLevel','Unbekannt','geminiModel','search','debug','toString','analysis.automation.autoApply','useWeather','Skipped\x20(Traffic)','analysis.alertReason','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','Started...','log','system.presenceWho','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','error','LTM.processingStatus','LTM.rawEventLog','toISOString','aiPersona','analysis.analysisHistory','analysisHistory','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','detected','eventHistory','normal','1084284kpPrcV','KI-Fehler\x20(Fallback)','dailyDigests','.\x20SYSTEM_MODE:\x20','2245308Gxhzvk','targetValue','Skipped\x20(No\x20AI\x20or\x20Data)','analysis.automation.patternDetected','toFixed','8154243iSwZeF','timestamp','warn','stringify','Digest','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','LTM.dailyDigests','ltmLtbWindowDays','now','text','Tag','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','targetId','generateContent','push','summary','analysis.automation.description','unshift','alertReason','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','219645acGtNy','\x20->\x20','5229944MybFGw','exports','splice','description','.forecast.current.temperature','config','KI\x20offline\x20(Fallback)','generic','ANALYZE_HEALTH','\x20Ã¼bersprungen\x20(Auto-Approved).','.Current.IsNight','isProVersion','isEmergency','setStateAsync','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','isAlert','Nacht','.Current.Temperature','baselineDrift','livingContext','68AHIzvh','.Current.WeatherText','%)\x20nach\x20\x22','automationProposal','replace','approved','LTM.driftAnalysis.baselineDrift','length','âš ï¸\x20ALARM:\x20','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','analysis.lastResult','LTM.driftAnalysis.lastCheck','toLocaleTimeString','analysis.automation.targetId','val','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','getForeignStateAsync','Success','ðŸŒ…\x20Morning\x20Briefing:\x0a','getStateAsync','response','sendNotification','reason','pop',',\x20Wetter:\x20','rawEventLog','.\x20EVENTS:\x20','analysis.isAlert','BUTLER\x20Execution\x20Error:\x20','decision','Unbekannt\x20(Kein\x20Sensor)','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','message','ltmStbWindowDays','weatherInstance','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','6700673KyAwJo','currentSystemMode','Sicherheit\x20geht\x20vor.','analysis.automation.targetValue','slice'];a0_0x44fe=function(){return _0x583ddc;};return a0_0x44fe();}async function runGeminiAnalysis(_0x32c8df,_0x4cc071=''){const _0xe7825c=a0_0x58bb8f;if(!_0x32c8df['geminiModel'])return;if(!canCallApi()){_0x32c8df[_0xe7825c(0x1f5)][_0xe7825c(0x1ed)](_0xe7825c(0x217));return;}if(_0x32c8df[_0xe7825c(0x201)][_0xe7825c(0x23e)]===0x0)return;const _0x50ddb0=_0x32c8df[_0xe7825c(0x201)][_0xe7825c(0x1db)](0x0,0xf),_0x5ab949=_0x32c8df[_0xe7825c(0x1d8)],_0x3192ff=PERSONA_MAPPING[_0x32c8df[_0xe7825c(0x228)][_0xe7825c(0x1fc)]||_0xe7825c(0x22a)],_0x1b806a=_0x32c8df['config'][_0xe7825c(0x236)]||'Keine\x20Details.';let _0x4beaed=_0xe7825c(0x1ea);try{const _0x2f3688=await _0x32c8df['getStateAsync'](_0xe7825c(0x1f6));if(_0x2f3688&&_0x2f3688[_0xe7825c(0x245)])_0x4beaed=_0x2f3688[_0xe7825c(0x245)];}catch(_0x44c2f8){}let _0x1ab54f=![];try{const _0x4a5b96=await _0x32c8df[_0xe7825c(0x1c6)](_0xe7825c(0x1ef));if(_0x4a5b96&&_0x4a5b96[_0xe7825c(0x245)])_0x1ab54f=!![];}catch(_0x528839){}const _0x283955=_0xe7825c(0x211)+_0x3192ff+'.\x20KONTEXT:\x20'+_0x1b806a+_0xe7825c(0x206)+_0x5ab949+'.\x20ANWESEND:\x20'+_0x4beaed+_0xe7825c(0x1cd)+JSON['stringify'](_0x50ddb0)+'.\x20EMERGENCY:\x20'+_0x4cc071+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x417e31=await _0x32c8df[_0xe7825c(0x1eb)][_0xe7825c(0x219)](_0x283955),_0x13f4e5=JSON[_0xe7825c(0x1e8)](_0x417e31[_0xe7825c(0x1c7)][_0xe7825c(0x215)]()['replace'](/```json|```/g,'')[_0xe7825c(0x1e0)]());await _0x32c8df[_0xe7825c(0x230)](_0xe7825c(0x241),{'val':JSON[_0xe7825c(0x20f)](_0x13f4e5),'ack':!![]});if(_0x13f4e5['summary'])await _0x32c8df['setStateAsync']('analysis.activitySummary',{'val':_0x13f4e5[_0xe7825c(0x21b)],'ack':!![]});const _0x375f85={'timestamp':Date[_0xe7825c(0x214)](),'id':Date[_0xe7825c(0x214)]()['toString'](),'analysis':{'activity':{'summary':_0x13f4e5[_0xe7825c(0x21b)],'isAlert':_0x13f4e5[_0xe7825c(0x232)],'alertReason':_0x13f4e5[_0xe7825c(0x21e)]},'comfort':{'automationProposal':_0x13f4e5[_0xe7825c(0x23a)]}}};_0x32c8df[_0xe7825c(0x1fe)][_0xe7825c(0x21d)](_0x375f85);if(_0x32c8df[_0xe7825c(0x1fe)][_0xe7825c(0x23e)]>0x32)_0x32c8df[_0xe7825c(0x1fe)][_0xe7825c(0x1ca)]();await _0x32c8df[_0xe7825c(0x230)](_0xe7825c(0x1fd),{'val':JSON[_0xe7825c(0x20f)](_0x32c8df['analysisHistory']),'ack':!![]});const _0xc5b816=_0x13f4e5['isAlert']||![];_0xc5b816!==_0x32c8df[_0xe7825c(0x1de)]&&(await _0x32c8df['setStateAsync'](_0xe7825c(0x1ce),{'val':_0xc5b816,'ack':!![]}),_0x32c8df[_0xe7825c(0x1de)]=_0xc5b816,_0xc5b816&&(await _0x32c8df[_0xe7825c(0x230)](_0xe7825c(0x1f2),{'val':_0x13f4e5[_0xe7825c(0x21e)],'ack':!![]}),setup[_0xe7825c(0x1c8)](_0x32c8df,_0xe7825c(0x23f)+_0x13f4e5[_0xe7825c(0x21e)],![],_0x13f4e5[_0xe7825c(0x22f)])));if(_0x13f4e5['automationProposal']&&_0x13f4e5[_0xe7825c(0x23a)][_0xe7825c(0x200)]){await _0x32c8df[_0xe7825c(0x230)](_0xe7825c(0x20a),{'val':!![],'ack':!![]}),await _0x32c8df[_0xe7825c(0x230)](_0xe7825c(0x21c),{'val':_0x13f4e5[_0xe7825c(0x23a)][_0xe7825c(0x226)],'ack':!![]}),await _0x32c8df[_0xe7825c(0x230)](_0xe7825c(0x244),{'val':_0x13f4e5['automationProposal'][_0xe7825c(0x218)],'ack':!![]}),await _0x32c8df[_0xe7825c(0x230)](_0xe7825c(0x1da),{'val':JSON[_0xe7825c(0x20f)](_0x13f4e5['automationProposal'][_0xe7825c(0x208)]),'ack':!![]});if(_0x1ab54f)executeAutomationAction(_0x32c8df);}}catch(_0x3ced2c){_0x32c8df[_0xe7825c(0x1f5)][_0xe7825c(0x1f8)]('Gemini\x20Error:\x20'+_0x3ced2c[_0xe7825c(0x1d3)]);}}async function createDailyDigest(_0x3308f0,_0x2660a4){const _0x1d8433=a0_0x58bb8f;if(!_0x3308f0[_0x1d8433(0x22e)])return;if(!canCallApi()){await _0x3308f0[_0x1d8433(0x230)](LTM_DP_STATUS,{'val':_0x1d8433(0x1f1),'ack':!![]});return;}await _0x3308f0['setStateAsync'](LTM_DP_STATUS,{'val':_0x1d8433(0x1f4),'ack':!![]});if(!_0x3308f0[_0x1d8433(0x1eb)]||_0x3308f0[_0x1d8433(0x1cc)][_0x1d8433(0x23e)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3308f0[_0x1d8433(0x230)](LTM_DP_STATUS,{'val':_0x1d8433(0x209),'ack':!![]});return;}const _0x2d1a88=JSON['parse'](JSON['stringify'](_0x3308f0[_0x1d8433(0x1cc)])),_0x3be763=_0x2d1a88['length'],_0x4917cc=_0x1d8433(0x1d6)+JSON['stringify'](_0x2d1a88);try{updateApiTimestamp();const _0x388f63=await _0x3308f0[_0x1d8433(0x1eb)][_0x1d8433(0x219)](_0x4917cc),_0x15224e=JSON[_0x1d8433(0x1e8)](_0x388f63[_0x1d8433(0x1c7)][_0x1d8433(0x215)]()[_0x1d8433(0x23b)](/```json|```/g,'')['trim']()),_0xe2e775={'timestamp':new Date()[_0x1d8433(0x1fb)](),'eventCount':_0x3be763,'summary':_0x15224e[_0x1d8433(0x21b)]||_0x1d8433(0x210),'activityLevel':_0x15224e[_0x1d8433(0x1e9)]||_0x1d8433(0x202),'systemMode':_0x3308f0['currentSystemMode']};_0x3308f0[_0x1d8433(0x205)][_0x1d8433(0x21a)](_0xe2e775);const _0x339a26=_0x3308f0['config'][_0x1d8433(0x213)]||0x3c;_0x3308f0[_0x1d8433(0x205)][_0x1d8433(0x23e)]>_0x339a26&&_0x3308f0['dailyDigests'][_0x1d8433(0x225)](0x0,_0x3308f0[_0x1d8433(0x205)][_0x1d8433(0x23e)]-_0x339a26);await _0x3308f0[_0x1d8433(0x230)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1d8433(0x20f)](_0x3308f0[_0x1d8433(0x205)]),'ack':!![]}),_0x3308f0[_0x1d8433(0x1cc)]=[],await _0x3308f0[_0x1d8433(0x230)](LTM_DP_RAW_LOG,{'val':JSON[_0x1d8433(0x20f)](_0x3308f0[_0x1d8433(0x1cc)]),'ack':!![]}),await _0x3308f0[_0x1d8433(0x230)](LTM_DP_STATUS,{'val':_0x1d8433(0x1c4),'ack':!![]});if(_0x3308f0[_0x1d8433(0x22e)]&&_0x2660a4)_0x2660a4['send'](_0x3308f0,_0x1d8433(0x22b),{'digest':_0xe2e775});}catch(_0x5201c0){_0x3308f0[_0x1d8433(0x1f5)]['error'](_0x5201c0['message']);}}async function runBaselineDriftAnalysis(_0x37b83f){const _0x4e7567=a0_0x58bb8f;if(!_0x37b83f[_0x4e7567(0x22e)]||!_0x37b83f[_0x4e7567(0x1eb)])return;if(!canCallApi())return;const _0x1e72ca=_0x37b83f[_0x4e7567(0x228)][_0x4e7567(0x1d4)]||0xe;if(_0x37b83f[_0x4e7567(0x205)][_0x4e7567(0x23e)]<_0x1e72ca+0x7){await _0x37b83f['setStateAsync'](_0x4e7567(0x23d),{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x4479ae=_0x37b83f[_0x4e7567(0x205)][_0x4e7567(0x1db)](-_0x1e72ca),_0x5d1b6c=_0x37b83f[_0x4e7567(0x205)][_0x4e7567(0x1db)](0x0,_0x37b83f[_0x4e7567(0x205)][_0x4e7567(0x23e)]-_0x1e72ca),_0xf5c48b='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x4e7567(0x20f)](_0x5d1b6c)+'\x0aSTB:\x20'+JSON[_0x4e7567(0x20f)](_0x4479ae);try{updateApiTimestamp();const _0x13edea=await _0x37b83f[_0x4e7567(0x1eb)][_0x4e7567(0x219)](_0xf5c48b),_0x59d759=JSON[_0x4e7567(0x1e8)](_0x13edea[_0x4e7567(0x1c7)][_0x4e7567(0x215)]()[_0x4e7567(0x23b)](/```json|```/g,'')[_0x4e7567(0x1e0)]());_0x59d759[_0x4e7567(0x235)]&&(await _0x37b83f[_0x4e7567(0x230)](_0x4e7567(0x23d),{'val':_0x59d759[_0x4e7567(0x235)],'ack':!![]}),await _0x37b83f[_0x4e7567(0x230)](_0x4e7567(0x1e7),{'val':_0x59d759['driftDetails'],'ack':!![]}),await _0x37b83f['setStateAsync'](_0x4e7567(0x242),{'val':Date[_0x4e7567(0x214)](),'ack':!![]}));}catch(_0x189183){}}async function executeAutomationAction(_0x25e5a5){const _0x10eedd=a0_0x58bb8f;try{const _0x2c2379=await _0x25e5a5[_0x10eedd(0x1c6)]('analysis.automation.targetId'),_0x1ed522=await _0x25e5a5['getStateAsync']('analysis.automation.targetValue');if(_0x2c2379&&_0x2c2379[_0x10eedd(0x245)]&&_0x1ed522){const _0x5c2400=_0x2c2379[_0x10eedd(0x245)];let _0x2cb068=_0x1ed522[_0x10eedd(0x245)];try{_0x2cb068=JSON['parse'](_0x2cb068);}catch(_0x5050af){}_0x25e5a5[_0x10eedd(0x1f5)]['info']('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x5c2400+_0x10eedd(0x1e1)+_0x2cb068),await _0x25e5a5['setForeignStateAsync'](_0x5c2400,_0x2cb068);}else _0x25e5a5['log'][_0x10eedd(0x20e)](_0x10eedd(0x246));}catch(_0x2b2503){_0x25e5a5[_0x10eedd(0x1f5)][_0x10eedd(0x1f8)](_0x10eedd(0x1cf)+_0x2b2503[_0x10eedd(0x1d3)]);}}async function sendMorningBriefing(_0x5a29bd){const _0x20b941=a0_0x58bb8f;if(!_0x5a29bd[_0x20b941(0x1eb)])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x3d08d1=_0x20b941(0x1ff),_0x247452=await _0x5a29bd[_0x20b941(0x1eb)][_0x20b941(0x219)](_0x3d08d1),_0x4a7dca=_0x247452[_0x20b941(0x1c7)][_0x20b941(0x215)]();setup[_0x20b941(0x1c8)](_0x5a29bd,_0x20b941(0x1c5)+_0x4a7dca);}catch(_0x569168){_0x5a29bd[_0x20b941(0x1f5)]['error']('Briefing\x20Error:\x20'+_0x569168['message']);}}module[a0_0x58bb8f(0x224)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};