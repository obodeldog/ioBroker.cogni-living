const a0_0x491a89=a0_0x3a28;(function(_0x374f8d,_0x1a6dc0){const _0x4c3c2e=a0_0x3a28,_0x12832a=_0x374f8d();while(!![]){try{const _0xb43bc4=-parseInt(_0x4c3c2e(0x1c6))/0x1+-parseInt(_0x4c3c2e(0x22e))/0x2+parseInt(_0x4c3c2e(0x1d5))/0x3+-parseInt(_0x4c3c2e(0x21b))/0x4+parseInt(_0x4c3c2e(0x233))/0x5*(-parseInt(_0x4c3c2e(0x221))/0x6)+-parseInt(_0x4c3c2e(0x1c1))/0x7*(parseInt(_0x4c3c2e(0x1d6))/0x8)+-parseInt(_0x4c3c2e(0x23b))/0x9*(-parseInt(_0x4c3c2e(0x20b))/0xa);if(_0xb43bc4===_0x1a6dc0)break;else _0x12832a['push'](_0x12832a['shift']());}catch(_0x4f0dcd){_0x12832a['push'](_0x12832a['shift']());}}}(a0_0x29de,0xc5bdd));const a0_0x4c636d=(function(){let _0x15806f=!![];return function(_0x580d2b,_0x405b02){const _0x46b996=_0x15806f?function(){const _0x9ab4cb=a0_0x3a28;if(_0x405b02){const _0x3a7ada=_0x405b02[_0x9ab4cb(0x23d)](_0x580d2b,arguments);return _0x405b02=null,_0x3a7ada;}}:function(){};return _0x15806f=![],_0x46b996;};}()),a0_0x33ccf9=a0_0x4c636d(this,function(){const _0x18673f=a0_0x3a28;return a0_0x33ccf9[_0x18673f(0x231)]()[_0x18673f(0x214)]('(((.+)+)+)+$')['toString']()[_0x18673f(0x1ca)](a0_0x33ccf9)[_0x18673f(0x214)]('(((.+)+)+)+$');});a0_0x33ccf9();'use strict';const {GoogleGenerativeAI}=require(a0_0x491a89(0x20e)),setup=require(a0_0x491a89(0x21c)),GEMINI_MODEL=a0_0x491a89(0x234),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x491a89(0x21d),LTM_DP_RAW_LOG=a0_0x491a89(0x1ae),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x491a89(0x208),'senior_aal':a0_0x491a89(0x1fc),'family':a0_0x491a89(0x1a6),'single_comfort':a0_0x491a89(0x239),'security':a0_0x491a89(0x1d3),'energy_saver':a0_0x491a89(0x222)};function canCallApi(){const _0x476b8e=a0_0x491a89,_0x4b7909=Date[_0x476b8e(0x1e7)]();return _0x4b7909-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x1322ee=a0_0x491a89;lastGlobalApiCall=Date[_0x1322ee(0x1e7)]();}function a0_0x29de(){const _0x4e185c=['livingContext','619521RxpSdu','generic','pop','length','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','1214708sgGWYw','getTime','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','analysis.analysisHistory','constructor','slice','Wetterdaten\x20nicht\x20abrufbar','\x20->\x20','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','timestamp','currentSystemMode','.forecast.current.state','analysis.automation.autoApply','Sicherheit\x20geht\x20vor.','summary','3463278kAWfEV','112ZnVkIj','driftDetails','isProVersion','Digest','NIGHT','.\x20KONTEXT:\x20','send','.\x20EVENTS:\x20','system.presenceWho','Unbekannt\x20(Kein\x20Sensor)','detected','analysis.automation.description','\x0aSTB:\x20','stringify','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','toLocaleTimeString','approved','now','eventHistory','setForeignStateAsync','analysis.health.geminiNight','%)\x20nach\x20\x22','Nacht','analysisHistory','response','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','message','KI\x20offline\x20(Fallback)','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','ANALYZE_HEALTH','debug','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','.forecast.current.temperature','generateContent','rawEventLog','analysis.health.geminiDay',').\x20Sending\x20notification...','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','\x0a\x20\x20\x20\x20EVENTS:\x0a','Gemini\x20Error:\x20','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','config','parse','.Current.IsNight','ltmLtbWindowDays','lastAlertState','.Current.Temperature','Keine\x20Details.','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','geminiModel','analysis.automation.targetId','6910ULHrJF','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','filter','@google/generative-ai','replace','unshift','val','weatherInstance','ltmStbWindowDays','search','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','dailyDigests','automationProposal','setHours','info','getStateAsync','4870924chZaBK','./setup','LTM.processingStatus','log','analysis.lastResult','toISOString','6nDLbXj','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','decision','.Current.WeatherText','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','LTM.driftAnalysis.driftDetails','isAlert','targetId','setStateAsync','text','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','¬∞C,\x20','1162376HAiUmb','toFixed','push','toString','analysis.automation.targetValue','7059085enlAQV','models/gemini-flash-latest','LTM.driftAnalysis.baselineDrift','sendNotification','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','üåÖ\x20Morning\x20Briefing:\x0a','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','analysis.automation.patternDetected','69291aaloUd','trim','apply','ü§ñ\x20Butler\x20Brain\x20Error:\x20',')\x20generated.','Unbekannt','Skipped\x20(Traffic)','baselineDrift','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','activityLevel','aiPersona','getForeignStateAsync','name','exports','value','2-digit','LTM.rawEventLog','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','LTM.driftAnalysis.lastCheck','warn','alertReason','ü§ñ\x20Health\x20Report\x20(','.\x20SYSTEM_MODE:\x20','reason','Health\x20Report\x20Error:\x20','Tag','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','KI-Fehler\x20(Fallback)','normal','üìÖ\x20Daily\x20Digest:\x0a','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','error','splice'];a0_0x29de=function(){return _0x4e185c;};return a0_0x29de();}async function getWeatherContext(_0x1a92d4){const _0x30b5c5=a0_0x491a89;if(!_0x1a92d4[_0x30b5c5(0x200)]['useWeather']||!_0x1a92d4['config'][_0x30b5c5(0x212)])return _0x30b5c5(0x1df);try{const _0x589682=_0x1a92d4[_0x30b5c5(0x200)][_0x30b5c5(0x212)];let _0x47159e=await _0x1a92d4[_0x30b5c5(0x1a9)](_0x589682+_0x30b5c5(0x205));if(!_0x47159e)_0x47159e=await _0x1a92d4[_0x30b5c5(0x1a9)](_0x589682+_0x30b5c5(0x1f6));let _0x192127=await _0x1a92d4[_0x30b5c5(0x1a9)](_0x589682+_0x30b5c5(0x224));if(!_0x192127)_0x192127=await _0x1a92d4[_0x30b5c5(0x1a9)](_0x589682+_0x30b5c5(0x1d1));let _0x541250=_0x30b5c5(0x240);const _0x135105=await _0x1a92d4[_0x30b5c5(0x1a9)](_0x589682+_0x30b5c5(0x202));if(_0x135105)_0x541250=_0x135105[_0x30b5c5(0x211)]?_0x30b5c5(0x1ec):_0x30b5c5(0x1b7);if(_0x47159e&&_0x192127)return _0x47159e['val']+_0x30b5c5(0x22d)+_0x192127[_0x30b5c5(0x211)]+',\x20Lichtverh√§ltnisse:\x20'+_0x541250;}catch(_0x36545e){}return _0x30b5c5(0x1cc);}async function consultButler(_0x41d4b8,_0xe0f0b0,_0x384034,_0x2d692c){const _0x257706=a0_0x491a89;if(!_0x41d4b8['geminiModel'])return{'approved':!![],'reason':_0x257706(0x1f1)};const _0x495e78=Date[_0x257706(0x1e7)]();if(decisionCache[_0xe0f0b0]&&_0x495e78-decisionCache[_0xe0f0b0][_0x257706(0x1cf)]<CACHE_TTL_MS){const _0x150e23=decisionCache[_0xe0f0b0][_0x257706(0x223)];return _0x41d4b8[_0x257706(0x21e)][_0x257706(0x1f4)](_0x257706(0x20c)+_0xe0f0b0+_0x257706(0x1cd)+(_0x150e23[_0x257706(0x1e6)]?'OK':'NO')+'\x20('+_0x150e23[_0x257706(0x1b5)]+')'),_0x150e23;}if(!canCallApi())return _0x41d4b8[_0x257706(0x21e)][_0x257706(0x1f4)](_0x257706(0x1c5)+_0xe0f0b0+'\x20√ºbersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x12709d=new Date()['toLocaleTimeString'](),_0x4a5ef0=await getWeatherContext(_0x41d4b8),_0x3ddbdb=PERSONA_MAPPING[_0x41d4b8[_0x257706(0x200)]['aiPersona']||_0x257706(0x1c2)],_0x14a5c5=_0x257706(0x1ff)+_0x12709d+',\x20Wetter:\x20'+_0x4a5ef0+_0x257706(0x237)+(_0x2d692c*0x64)[_0x257706(0x22f)](0x0)+_0x257706(0x1eb)+_0xe0f0b0+_0x257706(0x22c)+_0x384034+_0x257706(0x1fb)+_0x3ddbdb+_0x257706(0x1ce);try{updateApiTimestamp();const _0x12907d=await _0x41d4b8[_0x257706(0x209)][_0x257706(0x1f7)](_0x14a5c5),_0x44377a=_0x12907d[_0x257706(0x1ee)][_0x257706(0x22a)]()[_0x257706(0x20f)](/```json|```/g,'')[_0x257706(0x23c)](),_0x2a69a2=JSON[_0x257706(0x201)](_0x44377a);return decisionCache[_0xe0f0b0]={'decision':_0x2a69a2,'timestamp':_0x495e78},_0x2a69a2;}catch(_0x59a35d){return _0x41d4b8[_0x257706(0x21e)][_0x257706(0x1b1)](_0x257706(0x23e)+_0x59a35d[_0x257706(0x1f0)]),decisionCache[_0xe0f0b0]={'decision':{'approved':!![],'reason':_0x257706(0x1ba)},'timestamp':_0x495e78-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x257706(0x1ba)};}}async function runGeminiAnalysis(_0x307caf,_0x584ff1=''){const _0x2d3f96=a0_0x491a89;if(!_0x307caf['geminiModel'])return;if(!canCallApi()){_0x307caf[_0x2d3f96(0x21e)][_0x2d3f96(0x1f4)]('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x307caf[_0x2d3f96(0x1e8)][_0x2d3f96(0x1c4)]===0x0)return;const _0x591e97=_0x307caf[_0x2d3f96(0x1e8)][_0x2d3f96(0x1cb)](0x0,0xf),_0x295155=_0x307caf[_0x2d3f96(0x1d0)],_0x55b438=PERSONA_MAPPING[_0x307caf[_0x2d3f96(0x200)][_0x2d3f96(0x1a8)]||_0x2d3f96(0x1c2)],_0x32644d=_0x307caf[_0x2d3f96(0x200)][_0x2d3f96(0x1c0)]||_0x2d3f96(0x206);let _0x43df9e=_0x2d3f96(0x240);try{const _0x58e0a7=await _0x307caf[_0x2d3f96(0x21a)](_0x2d3f96(0x1de));if(_0x58e0a7&&_0x58e0a7[_0x2d3f96(0x211)])_0x43df9e=_0x58e0a7[_0x2d3f96(0x211)];}catch(_0x5700d2){}let _0x7ceb5d=![];try{const _0x1da9ad=await _0x307caf[_0x2d3f96(0x21a)](_0x2d3f96(0x1d2));if(_0x1da9ad&&_0x1da9ad['val'])_0x7ceb5d=!![];}catch(_0x2030cc){}const _0x5c3353=_0x2d3f96(0x1f5)+_0x55b438+_0x2d3f96(0x1db)+_0x32644d+_0x2d3f96(0x1b4)+_0x295155+'.\x20ANWESEND:\x20'+_0x43df9e+_0x2d3f96(0x1dd)+JSON[_0x2d3f96(0x1e3)](_0x591e97)+'.\x20EMERGENCY:\x20'+_0x584ff1+_0x2d3f96(0x1b8);try{updateApiTimestamp();const _0x8d804b=await _0x307caf[_0x2d3f96(0x209)][_0x2d3f96(0x1f7)](_0x5c3353),_0x5ad2c0=JSON[_0x2d3f96(0x201)](_0x8d804b['response'][_0x2d3f96(0x22a)]()[_0x2d3f96(0x20f)](/```json|```/g,'')[_0x2d3f96(0x23c)]());await _0x307caf[_0x2d3f96(0x229)](_0x2d3f96(0x21f),{'val':JSON[_0x2d3f96(0x1e3)](_0x5ad2c0),'ack':!![]});if(_0x5ad2c0[_0x2d3f96(0x1d4)])await _0x307caf[_0x2d3f96(0x229)]('analysis.activitySummary',{'val':_0x5ad2c0[_0x2d3f96(0x1d4)],'ack':!![]});const _0x9d5836={'timestamp':Date[_0x2d3f96(0x1e7)](),'id':Date[_0x2d3f96(0x1e7)]()['toString'](),'analysis':{'activity':{'summary':_0x5ad2c0['summary'],'isAlert':_0x5ad2c0[_0x2d3f96(0x227)],'alertReason':_0x5ad2c0[_0x2d3f96(0x1b2)]},'comfort':{'automationProposal':_0x5ad2c0[_0x2d3f96(0x217)]}}};_0x307caf[_0x2d3f96(0x1ed)][_0x2d3f96(0x210)](_0x9d5836);if(_0x307caf[_0x2d3f96(0x1ed)][_0x2d3f96(0x1c4)]>0x32)_0x307caf['analysisHistory'][_0x2d3f96(0x1c3)]();await _0x307caf[_0x2d3f96(0x229)](_0x2d3f96(0x1c9),{'val':JSON[_0x2d3f96(0x1e3)](_0x307caf[_0x2d3f96(0x1ed)]),'ack':!![]});const _0x52be55=_0x5ad2c0[_0x2d3f96(0x227)]||![];_0x52be55!==_0x307caf[_0x2d3f96(0x204)]&&(await _0x307caf[_0x2d3f96(0x229)]('analysis.isAlert',{'val':_0x52be55,'ack':!![]}),_0x307caf['lastAlertState']=_0x52be55,_0x52be55&&(await _0x307caf[_0x2d3f96(0x229)]('analysis.alertReason',{'val':_0x5ad2c0[_0x2d3f96(0x1b2)],'ack':!![]}),setup[_0x2d3f96(0x236)](_0x307caf,'‚ö†Ô∏è\x20ALARM:\x20'+_0x5ad2c0[_0x2d3f96(0x1b2)],![],_0x5ad2c0['isEmergency'])));if(_0x5ad2c0[_0x2d3f96(0x217)]&&_0x5ad2c0[_0x2d3f96(0x217)][_0x2d3f96(0x1e0)]){await _0x307caf[_0x2d3f96(0x229)](_0x2d3f96(0x23a),{'val':!![],'ack':!![]}),await _0x307caf[_0x2d3f96(0x229)](_0x2d3f96(0x1e1),{'val':_0x5ad2c0[_0x2d3f96(0x217)]['description'],'ack':!![]}),await _0x307caf[_0x2d3f96(0x229)]('analysis.automation.targetId',{'val':_0x5ad2c0['automationProposal'][_0x2d3f96(0x228)],'ack':!![]}),await _0x307caf[_0x2d3f96(0x229)](_0x2d3f96(0x232),{'val':JSON[_0x2d3f96(0x1e3)](_0x5ad2c0['automationProposal']['targetValue']),'ack':!![]});if(_0x7ceb5d)executeAutomationAction(_0x307caf);}}catch(_0x544842){_0x307caf[_0x2d3f96(0x21e)][_0x2d3f96(0x1be)](_0x2d3f96(0x1fe)+_0x544842[_0x2d3f96(0x1f0)]);}}async function createDailyDigest(_0x4bd721,_0xa334ea){const _0x3103d4=a0_0x491a89;if(!_0x4bd721['isProVersion'])return;if(!canCallApi()){await _0x4bd721[_0x3103d4(0x229)](LTM_DP_STATUS,{'val':_0x3103d4(0x1a4),'ack':!![]});return;}await _0x4bd721[_0x3103d4(0x229)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x4bd721['geminiModel']||_0x4bd721[_0x3103d4(0x1f8)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4bd721[_0x3103d4(0x229)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x3b5806=JSON[_0x3103d4(0x201)](JSON[_0x3103d4(0x1e3)](_0x4bd721['rawEventLog'])),_0x2dc957=_0x3b5806[_0x3103d4(0x1c4)],_0x2a42b='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON['stringify'](_0x3b5806);try{updateApiTimestamp();const _0x401298=await _0x4bd721[_0x3103d4(0x209)][_0x3103d4(0x1f7)](_0x2a42b),_0x5db090=JSON[_0x3103d4(0x201)](_0x401298[_0x3103d4(0x1ee)][_0x3103d4(0x22a)]()[_0x3103d4(0x20f)](/```json|```/g,'')[_0x3103d4(0x23c)]()),_0x4429df={'timestamp':new Date()[_0x3103d4(0x220)](),'eventCount':_0x2dc957,'summary':_0x5db090[_0x3103d4(0x1d4)]||_0x3103d4(0x1d9),'activityLevel':_0x5db090[_0x3103d4(0x1a7)]||_0x3103d4(0x1bb),'systemMode':_0x4bd721[_0x3103d4(0x1d0)]};_0x4bd721[_0x3103d4(0x216)][_0x3103d4(0x230)](_0x4429df);const _0x196f42=_0x4bd721[_0x3103d4(0x200)][_0x3103d4(0x203)]||0x3c;_0x4bd721[_0x3103d4(0x216)][_0x3103d4(0x1c4)]>_0x196f42&&_0x4bd721['dailyDigests'][_0x3103d4(0x1bf)](0x0,_0x4bd721[_0x3103d4(0x216)][_0x3103d4(0x1c4)]-_0x196f42);await _0x4bd721[_0x3103d4(0x229)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x3103d4(0x1e3)](_0x4bd721[_0x3103d4(0x216)]),'ack':!![]}),_0x4bd721[_0x3103d4(0x1f8)]=[],await _0x4bd721[_0x3103d4(0x229)](LTM_DP_RAW_LOG,{'val':JSON[_0x3103d4(0x1e3)](_0x4bd721[_0x3103d4(0x1f8)]),'ack':!![]}),await _0x4bd721[_0x3103d4(0x229)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x5ce350=_0x3103d4(0x1bc)+_0x5db090[_0x3103d4(0x1d4)]+'\x0aAktivit√§t:\x20'+_0x5db090[_0x3103d4(0x1a7)];setup['sendNotification'](_0x4bd721,_0x5ce350,![],![]);if(_0x4bd721[_0x3103d4(0x1d8)]&&_0xa334ea)_0xa334ea[_0x3103d4(0x1dc)](_0x4bd721,_0x3103d4(0x1f3),{'digest':_0x4429df});}catch(_0x2e1793){_0x4bd721['log'][_0x3103d4(0x1be)](_0x2e1793['message']);}}async function runBaselineDriftAnalysis(_0x5eb416){const _0x5df661=a0_0x491a89;if(!_0x5eb416['isProVersion']||!_0x5eb416['geminiModel'])return;if(!canCallApi())return;const _0x4d074e=_0x5eb416[_0x5df661(0x200)][_0x5df661(0x213)]||0xe;if(_0x5eb416['dailyDigests'][_0x5df661(0x1c4)]<_0x4d074e+0x7){await _0x5eb416[_0x5df661(0x229)](_0x5df661(0x235),{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x973619=_0x5eb416[_0x5df661(0x216)][_0x5df661(0x1cb)](-_0x4d074e),_0x12dd17=_0x5eb416[_0x5df661(0x216)][_0x5df661(0x1cb)](0x0,_0x5eb416[_0x5df661(0x216)][_0x5df661(0x1c4)]-_0x4d074e),_0x5e2d30=_0x5df661(0x1bd)+JSON[_0x5df661(0x1e3)](_0x12dd17)+_0x5df661(0x1e2)+JSON[_0x5df661(0x1e3)](_0x973619);try{updateApiTimestamp();const _0x30f1b9=await _0x5eb416[_0x5df661(0x209)][_0x5df661(0x1f7)](_0x5e2d30),_0x22701c=JSON[_0x5df661(0x201)](_0x30f1b9[_0x5df661(0x1ee)][_0x5df661(0x22a)]()[_0x5df661(0x20f)](/```json|```/g,'')[_0x5df661(0x23c)]());_0x22701c[_0x5df661(0x1a5)]&&(await _0x5eb416[_0x5df661(0x229)]('LTM.driftAnalysis.baselineDrift',{'val':_0x22701c[_0x5df661(0x1a5)],'ack':!![]}),await _0x5eb416['setStateAsync'](_0x5df661(0x226),{'val':_0x22701c[_0x5df661(0x1d7)],'ack':!![]}),await _0x5eb416[_0x5df661(0x229)](_0x5df661(0x1b0),{'val':Date[_0x5df661(0x1e7)](),'ack':!![]}));}catch(_0x1b0b4f){}}async function executeAutomationAction(_0x1fa94e){const _0x4d281=a0_0x491a89;try{const _0x3d28cc=await _0x1fa94e[_0x4d281(0x21a)](_0x4d281(0x20a)),_0x43118c=await _0x1fa94e['getStateAsync']('analysis.automation.targetValue');if(_0x3d28cc&&_0x3d28cc['val']&&_0x43118c){const _0x127959=_0x3d28cc[_0x4d281(0x211)];let _0x464e8c=_0x43118c[_0x4d281(0x211)];try{_0x464e8c=JSON[_0x4d281(0x201)](_0x464e8c);}catch(_0x292a46){}_0x1fa94e['log'][_0x4d281(0x219)](_0x4d281(0x22b)+_0x127959+'\x20=\x20'+_0x464e8c),await _0x1fa94e[_0x4d281(0x1e9)](_0x127959,_0x464e8c);}else _0x1fa94e['log']['warn']('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x5291cd){_0x1fa94e[_0x4d281(0x21e)][_0x4d281(0x1be)]('BUTLER\x20Execution\x20Error:\x20'+_0x5291cd[_0x4d281(0x1f0)]);}}function a0_0x3a28(_0x4c0276,_0x303d4c){const _0x58b6d5=a0_0x29de();return a0_0x3a28=function(_0x33ccf9,_0x4c636d){_0x33ccf9=_0x33ccf9-0x1a4;let _0x29deef=_0x58b6d5[_0x33ccf9];return _0x29deef;},a0_0x3a28(_0x4c0276,_0x303d4c);}async function sendMorningBriefing(_0x476b96){const _0x58a68b=a0_0x491a89;if(!_0x476b96[_0x58a68b(0x209)]){_0x476b96[_0x58a68b(0x21e)][_0x58a68b(0x1b1)](_0x58a68b(0x1b9));return;}_0x476b96[_0x58a68b(0x21e)][_0x58a68b(0x219)](_0x58a68b(0x1ef));try{updateApiTimestamp();const _0x2a5a99='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0xd1b900=await _0x476b96[_0x58a68b(0x209)][_0x58a68b(0x1f7)](_0x2a5a99),_0x284c17=_0xd1b900['response']['text']();_0x476b96[_0x58a68b(0x21e)][_0x58a68b(0x219)]('üåÖ\x20Briefing\x20generated\x20(Length:\x20'+_0x284c17[_0x58a68b(0x1c4)]+_0x58a68b(0x1fa)),setup[_0x58a68b(0x236)](_0x476b96,_0x58a68b(0x238)+_0x284c17);}catch(_0xb9caad){_0x476b96[_0x58a68b(0x21e)]['error']('Briefing\x20Error:\x20'+_0xb9caad[_0x58a68b(0x1f0)]);}}async function generateHealthReport(_0x51c138,_0x20d8de){const _0x3d5080=a0_0x491a89;if(!_0x51c138[_0x3d5080(0x209)])return;const _0x22348f=Date[_0x3d5080(0x1e7)]();_0x22348f-lastGlobalApiCall<0xbb8&&(_0x51c138[_0x3d5080(0x21e)][_0x3d5080(0x1f4)](_0x3d5080(0x215)),await new Promise(_0x2c472d=>setTimeout(_0x2c472d,0x7d0)));const _0x3b5a0f=new Date();let _0x17b153=0x0,_0x1ad139=_0x3b5a0f[_0x3d5080(0x1c7)](),_0x4ecda3='';if(_0x20d8de===_0x3d5080(0x1da)){const _0x35cc8f=new Date(_0x3b5a0f);_0x35cc8f['setDate'](_0x35cc8f['getDate']()-0x1),_0x35cc8f[_0x3d5080(0x218)](0x16,0x0,0x0,0x0),_0x17b153=_0x35cc8f['getTime']();const _0x520d5c=new Date(_0x3b5a0f);_0x520d5c[_0x3d5080(0x218)](0x8,0x0,0x0,0x0),_0x1ad139=_0x520d5c[_0x3d5080(0x1c7)](),_0x4ecda3=_0x3d5080(0x1af);}else{const _0x202ede=new Date(_0x3b5a0f);_0x202ede[_0x3d5080(0x218)](0x8,0x0,0x0,0x0),_0x17b153=_0x202ede[_0x3d5080(0x1c7)](),_0x4ecda3=_0x3d5080(0x207);}const _0xf1b2f5=_0x51c138[_0x3d5080(0x1e8)][_0x3d5080(0x20d)](_0x2ff206=>_0x2ff206[_0x3d5080(0x1cf)]>=_0x17b153&&_0x2ff206[_0x3d5080(0x1cf)]<=_0x1ad139);if(_0xf1b2f5[_0x3d5080(0x1c4)]===0x0){const _0x351118=_0x20d8de===_0x3d5080(0x1da)?_0x3d5080(0x225):_0x3d5080(0x1c8),_0xaf484d=_0x20d8de===_0x3d5080(0x1da)?_0x3d5080(0x1ea):_0x3d5080(0x1f9);await _0x51c138['setStateAsync'](_0xaf484d,{'val':_0x351118,'ack':!![]});return;}const _0x3de929=_0xf1b2f5['map'](_0x58c32e=>new Date(_0x58c32e[_0x3d5080(0x1cf)])[_0x3d5080(0x1e5)]([],{'hour':_0x3d5080(0x1ad),'minute':_0x3d5080(0x1ad)})+'\x20'+_0x58c32e[_0x3d5080(0x1aa)]+'\x20('+_0x58c32e[_0x3d5080(0x1ac)]+')')['join']('\x0a'),_0x721a89=_0x3d5080(0x1e4)+_0x4ecda3+_0x3d5080(0x1fd)+_0x3de929+_0x3d5080(0x1f2);try{updateApiTimestamp();const _0x465681=await _0x51c138[_0x3d5080(0x209)][_0x3d5080(0x1f7)](_0x721a89),_0x502de4=_0x465681[_0x3d5080(0x1ee)]['text'](),_0x2b6bfc=_0x20d8de===_0x3d5080(0x1da)?'analysis.health.geminiNight':'analysis.health.geminiDay';await _0x51c138[_0x3d5080(0x229)](_0x2b6bfc,{'val':_0x502de4,'ack':!![]}),_0x51c138[_0x3d5080(0x21e)][_0x3d5080(0x219)](_0x3d5080(0x1b3)+_0x20d8de+_0x3d5080(0x23f));}catch(_0x56326e){_0x51c138[_0x3d5080(0x21e)][_0x3d5080(0x1be)](_0x3d5080(0x1b6)+_0x56326e[_0x3d5080(0x1f0)]);}}module[a0_0x491a89(0x1ab)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};