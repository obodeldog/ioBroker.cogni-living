const a0_0x58cb92=a0_0x4ae3;(function(_0x4abfe1,_0x41a372){const _0x5184e3=a0_0x4ae3,_0x45baba=_0x4abfe1();while(!![]){try{const _0x3c113e=-parseInt(_0x5184e3(0xff))/0x1*(parseInt(_0x5184e3(0x111))/0x2)+parseInt(_0x5184e3(0x128))/0x3+-parseInt(_0x5184e3(0x13c))/0x4*(-parseInt(_0x5184e3(0x179))/0x5)+parseInt(_0x5184e3(0xe8))/0x6+parseInt(_0x5184e3(0x16e))/0x7*(parseInt(_0x5184e3(0xf0))/0x8)+parseInt(_0x5184e3(0x17b))/0x9+parseInt(_0x5184e3(0x103))/0xa*(-parseInt(_0x5184e3(0x124))/0xb);if(_0x3c113e===_0x41a372)break;else _0x45baba['push'](_0x45baba['shift']());}catch(_0x16ac0b){_0x45baba['push'](_0x45baba['shift']());}}}(a0_0x36f0,0x98d44));const a0_0x1dd317=(function(){let _0x1065a8=!![];return function(_0x5218ee,_0x16f380){const _0x639a5c=_0x1065a8?function(){const _0x47bd58=a0_0x4ae3;if(_0x16f380){const _0x2055d8=_0x16f380[_0x47bd58(0x16f)](_0x5218ee,arguments);return _0x16f380=null,_0x2055d8;}}:function(){};return _0x1065a8=![],_0x639a5c;};}()),a0_0x575ff9=a0_0x1dd317(this,function(){const _0x232045=a0_0x4ae3;return a0_0x575ff9['toString']()[_0x232045(0x14d)](_0x232045(0x11c))[_0x232045(0x117)]()[_0x232045(0xee)](a0_0x575ff9)[_0x232045(0x14d)]('(((.+)+)+)+$');});a0_0x575ff9();'use strict';const {GoogleGenerativeAI}=require(a0_0x58cb92(0x132)),setup=require(a0_0x58cb92(0xe9)),GEMINI_MODEL=a0_0x58cb92(0x142),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x58cb92(0x169),LTM_DP_RAW_LOG=a0_0x58cb92(0x100),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':a0_0x58cb92(0x143),'family':a0_0x58cb92(0x108),'single_comfort':a0_0x58cb92(0x10c),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x58cb92(0x101)};function canCallApi(){const _0x1daa17=a0_0x58cb92,_0x4cff21=Date[_0x1daa17(0x17f)]();return _0x4cff21-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){lastGlobalApiCall=Date['now']();}function a0_0x4ae3(_0x3c3ea8,_0x12e947){const _0x55ec08=a0_0x36f0();return a0_0x4ae3=function(_0x575ff9,_0x1dd317){_0x575ff9=_0x575ff9-0xde;let _0x36f0e1=_0x55ec08[_0x575ff9];return _0x36f0e1;},a0_0x4ae3(_0x3c3ea8,_0x12e947);}async function getWeatherContext(_0x3dffd2){const _0x3a400=a0_0x58cb92;if(!_0x3dffd2[_0x3a400(0x113)][_0x3a400(0xfc)]||!_0x3dffd2['config'][_0x3a400(0x16b)])return _0x3a400(0x146);try{const _0x1c83cf=_0x3dffd2[_0x3a400(0x113)][_0x3a400(0x16b)];let _0x4ef4b7=await _0x3dffd2[_0x3a400(0x148)](_0x1c83cf+_0x3a400(0x160));if(!_0x4ef4b7)_0x4ef4b7=await _0x3dffd2[_0x3a400(0x148)](_0x1c83cf+_0x3a400(0x116));let _0x2c639c=await _0x3dffd2[_0x3a400(0x148)](_0x1c83cf+_0x3a400(0x14f));if(!_0x2c639c)_0x2c639c=await _0x3dffd2[_0x3a400(0x148)](_0x1c83cf+_0x3a400(0xf6));let _0x5ec008=_0x3a400(0x153);const _0x2061a6=await _0x3dffd2[_0x3a400(0x148)](_0x1c83cf+_0x3a400(0x149));if(_0x2061a6)_0x5ec008=_0x2061a6['val']?'Nacht':'Tag';if(_0x4ef4b7&&_0x2c639c)return _0x4ef4b7[_0x3a400(0x133)]+_0x3a400(0x15c)+_0x2c639c[_0x3a400(0x133)]+',\x20Lichtverh√§ltnisse:\x20'+_0x5ec008;}catch(_0x5a754d){}return _0x3a400(0x130);}async function consultButler(_0x4e2c0c,_0x28f063,_0x392706,_0x620004){const _0x3ae297=a0_0x58cb92;if(!_0x4e2c0c[_0x3ae297(0x125)])return{'approved':!![],'reason':_0x3ae297(0x172)};const _0x5132c3=Date['now']();if(decisionCache[_0x28f063]&&_0x5132c3-decisionCache[_0x28f063][_0x3ae297(0xe3)]<CACHE_TTL_MS){const _0x4a5120=decisionCache[_0x28f063][_0x3ae297(0x102)];return _0x4e2c0c[_0x3ae297(0xfd)][_0x3ae297(0x152)](_0x3ae297(0x136)+_0x28f063+_0x3ae297(0x147)+(_0x4a5120['approved']?'OK':'NO')+'\x20('+_0x4a5120[_0x3ae297(0xe4)]+')'),_0x4a5120;}if(!canCallApi())return _0x4e2c0c[_0x3ae297(0xfd)][_0x3ae297(0x152)](_0x3ae297(0x12d)+_0x28f063+_0x3ae297(0x15d)),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x3d54d3=new Date()['toLocaleTimeString'](),_0x181f34=await getWeatherContext(_0x4e2c0c),_0x4dbdb1=PERSONA_MAPPING[_0x4e2c0c[_0x3ae297(0x113)][_0x3ae297(0xf7)]||_0x3ae297(0x17c)],_0x443375=_0x3ae297(0xf2)+_0x3d54d3+_0x3ae297(0x155)+_0x181f34+_0x3ae297(0x14c)+(_0x620004*0x64)[_0x3ae297(0x13f)](0x0)+'%)\x20nach\x20\x22'+_0x28f063+_0x3ae297(0x135)+_0x392706+_0x3ae297(0x17d)+_0x4dbdb1+_0x3ae297(0x150);try{updateApiTimestamp();const _0x13bd5a=await _0x4e2c0c['geminiModel'][_0x3ae297(0x127)](_0x443375),_0x517a79=_0x13bd5a[_0x3ae297(0x175)][_0x3ae297(0x168)]()['replace'](/```json|```/g,'')[_0x3ae297(0x12b)](),_0x28f4b7=JSON['parse'](_0x517a79);return decisionCache[_0x28f063]={'decision':_0x28f4b7,'timestamp':_0x5132c3},_0x28f4b7;}catch(_0x206549){return _0x4e2c0c[_0x3ae297(0xfd)]['warn']('ü§ñ\x20Butler\x20Brain\x20Error:\x20'+_0x206549[_0x3ae297(0x131)]),decisionCache[_0x28f063]={'decision':{'approved':!![],'reason':_0x3ae297(0x162)},'timestamp':_0x5132c3-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x3ae297(0x162)};}}async function runGeminiAnalysis(_0x4329ac,_0x13490a=''){const _0x522a4c=a0_0x58cb92;if(!_0x4329ac[_0x522a4c(0x125)])return;if(!canCallApi()){_0x4329ac[_0x522a4c(0xfd)]['debug']('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x4329ac[_0x522a4c(0x17e)][_0x522a4c(0x13b)]===0x0)return;const _0x4a4ccc=_0x4329ac[_0x522a4c(0x17e)][_0x522a4c(0x119)](0x0,0xf),_0x567f6d=_0x4329ac[_0x522a4c(0x141)],_0x3df588=PERSONA_MAPPING[_0x4329ac[_0x522a4c(0x113)][_0x522a4c(0xf7)]||_0x522a4c(0x17c)],_0x3ec5d2=_0x4329ac[_0x522a4c(0x113)][_0x522a4c(0x104)]||_0x522a4c(0x109);let _0x473193=_0x522a4c(0x153);try{const _0x43b767=await _0x4329ac[_0x522a4c(0xe7)]('system.presenceWho');if(_0x43b767&&_0x43b767[_0x522a4c(0x133)])_0x473193=_0x43b767[_0x522a4c(0x133)];}catch(_0x383417){}let _0x43cd1e=![];try{const _0x37eac6=await _0x4329ac[_0x522a4c(0xe7)](_0x522a4c(0xe6));if(_0x37eac6&&_0x37eac6[_0x522a4c(0x133)])_0x43cd1e=!![];}catch(_0x4ac426){}const _0x35c469=_0x522a4c(0x157)+_0x3df588+_0x522a4c(0x137)+_0x3ec5d2+_0x522a4c(0xec)+_0x567f6d+'.\x20ANWESEND:\x20'+_0x473193+_0x522a4c(0xe2)+JSON['stringify'](_0x4a4ccc)+_0x522a4c(0x126)+_0x13490a+_0x522a4c(0xf5);try{updateApiTimestamp();const _0x44b5a0=await _0x4329ac['geminiModel']['generateContent'](_0x35c469),_0x54cc30=JSON[_0x522a4c(0x166)](_0x44b5a0[_0x522a4c(0x175)][_0x522a4c(0x168)]()['replace'](/```json|```/g,'')[_0x522a4c(0x12b)]());await _0x4329ac[_0x522a4c(0x177)](_0x522a4c(0x16a),{'val':JSON['stringify'](_0x54cc30),'ack':!![]});if(_0x54cc30[_0x522a4c(0x13a)])await _0x4329ac['setStateAsync'](_0x522a4c(0x115),{'val':_0x54cc30['summary'],'ack':!![]});const _0xa1a386={'timestamp':Date[_0x522a4c(0x17f)](),'id':Date['now']()[_0x522a4c(0x117)](),'analysis':{'activity':{'summary':_0x54cc30[_0x522a4c(0x13a)],'isAlert':_0x54cc30[_0x522a4c(0x112)],'alertReason':_0x54cc30[_0x522a4c(0x174)]},'comfort':{'automationProposal':_0x54cc30['automationProposal']}}};_0x4329ac[_0x522a4c(0x159)][_0x522a4c(0x12a)](_0xa1a386);if(_0x4329ac['analysisHistory'][_0x522a4c(0x13b)]>0x32)_0x4329ac['analysisHistory'][_0x522a4c(0x11d)]();await _0x4329ac[_0x522a4c(0x177)](_0x522a4c(0xfe),{'val':JSON['stringify'](_0x4329ac[_0x522a4c(0x159)]),'ack':!![]});const _0x47e604=_0x54cc30['isAlert']||![];_0x47e604!==_0x4329ac['lastAlertState']&&(await _0x4329ac[_0x522a4c(0x177)](_0x522a4c(0xe5),{'val':_0x47e604,'ack':!![]}),_0x4329ac[_0x522a4c(0x171)]=_0x47e604,_0x47e604&&(await _0x4329ac[_0x522a4c(0x177)](_0x522a4c(0x173),{'val':_0x54cc30[_0x522a4c(0x174)],'ack':!![]}),setup[_0x522a4c(0x15f)](_0x4329ac,_0x522a4c(0x123)+_0x54cc30[_0x522a4c(0x174)],![],_0x54cc30[_0x522a4c(0x167)])));if(_0x54cc30[_0x522a4c(0x11b)]&&_0x54cc30['automationProposal'][_0x522a4c(0x114)]){await _0x4329ac[_0x522a4c(0x177)](_0x522a4c(0x121),{'val':!![],'ack':!![]}),await _0x4329ac[_0x522a4c(0x177)](_0x522a4c(0x14b),{'val':_0x54cc30[_0x522a4c(0x11b)]['description'],'ack':!![]}),await _0x4329ac[_0x522a4c(0x177)](_0x522a4c(0x14a),{'val':_0x54cc30[_0x522a4c(0x11b)][_0x522a4c(0x161)],'ack':!![]}),await _0x4329ac[_0x522a4c(0x177)](_0x522a4c(0x154),{'val':JSON[_0x522a4c(0x110)](_0x54cc30[_0x522a4c(0x11b)][_0x522a4c(0x165)]),'ack':!![]});if(_0x43cd1e)executeAutomationAction(_0x4329ac);}}catch(_0x49a603){_0x4329ac[_0x522a4c(0xfd)][_0x522a4c(0x13e)](_0x522a4c(0x105)+_0x49a603[_0x522a4c(0x131)]);}}function a0_0x36f0(){const _0x14a952=['Started...','5759631oBPkMM','generic','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','eventHistory','now','NIGHT','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','filter','LTM.driftAnalysis.lastCheck','.\x20EVENTS:\x20','timestamp','reason','analysis.isAlert','analysis.automation.autoApply','getStateAsync','5900016LcUjeU','./setup','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','Success','.\x20SYSTEM_MODE:\x20','dailyDigests','constructor','getTime','24DgzZHd','üåÖ\x20Morning\x20Briefing:\x0a','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','warn','\x0a\x20\x20\x20\x20EVENTS:\x0a','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','.forecast.current.state','aiPersona','ANALYZE_HEALTH','replace','2-digit','send','useWeather','log','analysis.analysisHistory','249913ugmtps','LTM.rawEventLog','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','decision','60gqQwmn','livingContext','Gemini\x20Error:\x20','setHours','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','Keine\x20Details.','Briefing\x20Error:\x20','toLocaleTimeString','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','info','üåÖ\x20Briefing\x20generated\x20(Length:\x20','\x0aSTB:\x20','stringify','4iHPWKn','isAlert','config','detected','analysis.activitySummary','.forecast.current.temperature','toString','toISOString','slice','map','automationProposal','(((.+)+)+)+$','pop','splice','Digest','Skipped\x20(Traffic)','analysis.automation.patternDetected','ü§ñ\x20Health\x20Report\x20(','‚ö†Ô∏è\x20ALARM:\x20','4983638bbcPIj','geminiModel','.\x20EMERGENCY:\x20','generateContent','1497048MGPbdH','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','unshift','trim','Health\x20Report\x20Error:\x20','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','driftDetails','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Wetterdaten\x20nicht\x20abrufbar','message','@google/generative-ai','val','LTM.driftAnalysis.baselineDrift','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','.\x20KONTEXT:\x20','setDate','activityLevel','summary','length','64tAjwrx','isProVersion','error','toFixed','ltmLtbWindowDays','currentSystemMode','models/gemini-flash-latest','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','value','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','Unbekannt\x20(Kein\x20Sensor)','\x20->\x20','getForeignStateAsync','.Current.IsNight','analysis.automation.targetId','analysis.automation.description','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','search','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','.Current.WeatherText','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20',').\x20Sending\x20notification...','debug','Unbekannt','analysis.automation.targetValue',',\x20Wetter:\x20','rawEventLog','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','BUTLER\x20Execution\x20Error:\x20','analysisHistory','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','üìÖ\x20Daily\x20Digest:\x0a','¬∞C,\x20','\x20√ºbersprungen\x20(Auto-Approved).','ltmStbWindowDays','sendNotification','.Current.Temperature','targetId','KI-Fehler\x20(Fallback)','analysis.health.geminiNight','join','targetValue','parse','isEmergency','text','LTM.processingStatus','analysis.lastResult','weatherInstance','exports','N/A\x20(Learning)','1417311qoQuIp','apply','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','lastAlertState','KI\x20offline\x20(Fallback)','analysis.alertReason','alertReason','response','\x20=\x20','setStateAsync','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','348260tmLmAf'];a0_0x36f0=function(){return _0x14a952;};return a0_0x36f0();}async function createDailyDigest(_0x761ee0,_0xa48278){const _0x3d994c=a0_0x58cb92;if(!_0x761ee0[_0x3d994c(0x13d)])return;if(!canCallApi()){await _0x761ee0[_0x3d994c(0x177)](LTM_DP_STATUS,{'val':_0x3d994c(0x120),'ack':!![]});return;}await _0x761ee0[_0x3d994c(0x177)](LTM_DP_STATUS,{'val':_0x3d994c(0x17a),'ack':!![]});if(!_0x761ee0[_0x3d994c(0x125)]||_0x761ee0[_0x3d994c(0x156)][_0x3d994c(0x13b)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x761ee0[_0x3d994c(0x177)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x18cf8e=JSON['parse'](JSON[_0x3d994c(0x110)](_0x761ee0['rawEventLog'])),_0x245b24=_0x18cf8e['length'],_0x2bfd35=_0x3d994c(0xdf)+JSON[_0x3d994c(0x110)](_0x18cf8e);try{updateApiTimestamp();const _0x43b8b1=await _0x761ee0[_0x3d994c(0x125)][_0x3d994c(0x127)](_0x2bfd35),_0x4f3209=JSON[_0x3d994c(0x166)](_0x43b8b1['response'][_0x3d994c(0x168)]()[_0x3d994c(0xf9)](/```json|```/g,'')['trim']()),_0x243987={'timestamp':new Date()[_0x3d994c(0x118)](),'eventCount':_0x245b24,'summary':_0x4f3209[_0x3d994c(0x13a)]||_0x3d994c(0x11f),'activityLevel':_0x4f3209[_0x3d994c(0x139)]||'normal','systemMode':_0x761ee0[_0x3d994c(0x141)]};_0x761ee0['dailyDigests']['push'](_0x243987);const _0x16ccde=_0x761ee0['config'][_0x3d994c(0x140)]||0x3c;_0x761ee0[_0x3d994c(0xed)][_0x3d994c(0x13b)]>_0x16ccde&&_0x761ee0[_0x3d994c(0xed)][_0x3d994c(0x11e)](0x0,_0x761ee0[_0x3d994c(0xed)][_0x3d994c(0x13b)]-_0x16ccde);await _0x761ee0[_0x3d994c(0x177)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x3d994c(0x110)](_0x761ee0[_0x3d994c(0xed)]),'ack':!![]}),_0x761ee0[_0x3d994c(0x156)]=[],await _0x761ee0[_0x3d994c(0x177)](LTM_DP_RAW_LOG,{'val':JSON[_0x3d994c(0x110)](_0x761ee0['rawEventLog']),'ack':!![]}),await _0x761ee0['setStateAsync'](LTM_DP_STATUS,{'val':_0x3d994c(0xeb),'ack':!![]});const _0x223ddf=_0x3d994c(0x15b)+_0x4f3209[_0x3d994c(0x13a)]+'\x0aAktivit√§t:\x20'+_0x4f3209[_0x3d994c(0x139)];setup['sendNotification'](_0x761ee0,_0x223ddf,![],![]);if(_0x761ee0['isProVersion']&&_0xa48278)_0xa48278[_0x3d994c(0xfb)](_0x761ee0,_0x3d994c(0xf8),{'digest':_0x243987});}catch(_0x4ef3fa){_0x761ee0[_0x3d994c(0xfd)][_0x3d994c(0x13e)](_0x4ef3fa[_0x3d994c(0x131)]);}}async function runBaselineDriftAnalysis(_0x712948){const _0x24b6d2=a0_0x58cb92;if(!_0x712948[_0x24b6d2(0x13d)]||!_0x712948[_0x24b6d2(0x125)])return;if(!canCallApi())return;const _0x375b69=_0x712948['config'][_0x24b6d2(0x15e)]||0xe;if(_0x712948['dailyDigests'][_0x24b6d2(0x13b)]<_0x375b69+0x7){await _0x712948['setStateAsync'](_0x24b6d2(0x134),{'val':_0x24b6d2(0x16d),'ack':!![]});return;}const _0x4cb2e0=_0x712948['dailyDigests'][_0x24b6d2(0x119)](-_0x375b69),_0x1a0f9e=_0x712948[_0x24b6d2(0xed)]['slice'](0x0,_0x712948[_0x24b6d2(0xed)]['length']-_0x375b69),_0x55f6f5=_0x24b6d2(0x12f)+JSON[_0x24b6d2(0x110)](_0x1a0f9e)+_0x24b6d2(0x10f)+JSON[_0x24b6d2(0x110)](_0x4cb2e0);try{updateApiTimestamp();const _0x433f3d=await _0x712948['geminiModel'][_0x24b6d2(0x127)](_0x55f6f5),_0x221208=JSON[_0x24b6d2(0x166)](_0x433f3d[_0x24b6d2(0x175)][_0x24b6d2(0x168)]()[_0x24b6d2(0xf9)](/```json|```/g,'')[_0x24b6d2(0x12b)]());_0x221208['baselineDrift']&&(await _0x712948[_0x24b6d2(0x177)]('LTM.driftAnalysis.baselineDrift',{'val':_0x221208['baselineDrift'],'ack':!![]}),await _0x712948[_0x24b6d2(0x177)]('LTM.driftAnalysis.driftDetails',{'val':_0x221208[_0x24b6d2(0x12e)],'ack':!![]}),await _0x712948[_0x24b6d2(0x177)](_0x24b6d2(0xe1),{'val':Date[_0x24b6d2(0x17f)](),'ack':!![]}));}catch(_0x16abcc){}}async function executeAutomationAction(_0x4f05fe){const _0x180959=a0_0x58cb92;try{const _0x4c91b3=await _0x4f05fe[_0x180959(0xe7)](_0x180959(0x14a)),_0x1b8826=await _0x4f05fe[_0x180959(0xe7)]('analysis.automation.targetValue');if(_0x4c91b3&&_0x4c91b3[_0x180959(0x133)]&&_0x1b8826){const _0x40ce61=_0x4c91b3['val'];let _0x163756=_0x1b8826['val'];try{_0x163756=JSON[_0x180959(0x166)](_0x163756);}catch(_0x4621e1){}_0x4f05fe['log']['info'](_0x180959(0x145)+_0x40ce61+_0x180959(0x176)+_0x163756),await _0x4f05fe['setForeignStateAsync'](_0x40ce61,_0x163756);}else _0x4f05fe['log'][_0x180959(0xf3)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0xd82974){_0x4f05fe[_0x180959(0xfd)][_0x180959(0x13e)](_0x180959(0x158)+_0xd82974[_0x180959(0x131)]);}}async function sendMorningBriefing(_0x4d6929){const _0x56eecc=a0_0x58cb92;if(!_0x4d6929[_0x56eecc(0x125)]){_0x4d6929[_0x56eecc(0xfd)]['warn']('ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x4d6929[_0x56eecc(0xfd)][_0x56eecc(0x10d)]('üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x44614b='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x17931a=await _0x4d6929['geminiModel'][_0x56eecc(0x127)](_0x44614b),_0x38dd14=_0x17931a[_0x56eecc(0x175)][_0x56eecc(0x168)]();_0x4d6929['log']['info'](_0x56eecc(0x10e)+_0x38dd14[_0x56eecc(0x13b)]+_0x56eecc(0x151)),setup['sendNotification'](_0x4d6929,_0x56eecc(0xf1)+_0x38dd14);}catch(_0x3e3571){_0x4d6929[_0x56eecc(0xfd)]['error'](_0x56eecc(0x10a)+_0x3e3571[_0x56eecc(0x131)]);}}async function generateHealthReport(_0x6b5716,_0x1a4857){const _0x368c2a=a0_0x58cb92;if(!_0x6b5716['geminiModel'])return;const _0x4cc472=Date[_0x368c2a(0x17f)]();_0x4cc472-lastGlobalApiCall<0xbb8&&(_0x6b5716[_0x368c2a(0xfd)]['debug'](_0x368c2a(0x15a)),await new Promise(_0xe61b99=>setTimeout(_0xe61b99,0x7d0)));const _0x1d7631=new Date();let _0x4f5e36=0x0,_0xf3aa27=_0x1d7631[_0x368c2a(0xef)](),_0x4dd254='';if(_0x1a4857===_0x368c2a(0xde)){const _0xabc996=new Date(_0x1d7631);_0xabc996[_0x368c2a(0x138)](_0xabc996['getDate']()-0x1),_0xabc996[_0x368c2a(0x106)](0x16,0x0,0x0,0x0),_0x4f5e36=_0xabc996[_0x368c2a(0xef)]();const _0x16f76c=new Date(_0x1d7631);_0x16f76c[_0x368c2a(0x106)](0x8,0x0,0x0,0x0),_0xf3aa27=_0x16f76c[_0x368c2a(0xef)](),_0x4dd254=_0x368c2a(0x129);}else{const _0x2c9c9b=new Date(_0x1d7631);_0x2c9c9b[_0x368c2a(0x106)](0x8,0x0,0x0,0x0),_0x4f5e36=_0x2c9c9b[_0x368c2a(0xef)](),_0x4dd254=_0x368c2a(0x14e);}const _0x30e21b=_0x6b5716['eventHistory'][_0x368c2a(0xe0)](_0x263659=>_0x263659['timestamp']>=_0x4f5e36&&_0x263659[_0x368c2a(0xe3)]<=_0xf3aa27);if(_0x30e21b[_0x368c2a(0x13b)]===0x0){const _0x28996f=_0x1a4857==='NIGHT'?_0x368c2a(0x178):_0x368c2a(0x170),_0x309c1f=_0x1a4857===_0x368c2a(0xde)?_0x368c2a(0x163):'analysis.health.geminiDay';await _0x6b5716['setStateAsync'](_0x309c1f,{'val':_0x28996f,'ack':!![]});return;}const _0x4748b9=_0x30e21b[_0x368c2a(0x11a)](_0x592b6f=>new Date(_0x592b6f[_0x368c2a(0xe3)])[_0x368c2a(0x10b)]([],{'hour':_0x368c2a(0xfa),'minute':_0x368c2a(0xfa)})+'\x20'+_0x592b6f['name']+'\x20('+_0x592b6f[_0x368c2a(0x144)]+')')[_0x368c2a(0x164)]('\x0a'),_0x45766d=_0x368c2a(0x107)+_0x4dd254+_0x368c2a(0xf4)+_0x4748b9+_0x368c2a(0xea);try{updateApiTimestamp();const _0x3768de=await _0x6b5716[_0x368c2a(0x125)][_0x368c2a(0x127)](_0x45766d),_0x52bc2f=_0x3768de[_0x368c2a(0x175)][_0x368c2a(0x168)](),_0x2f13ef=_0x1a4857===_0x368c2a(0xde)?_0x368c2a(0x163):'analysis.health.geminiDay';await _0x6b5716[_0x368c2a(0x177)](_0x2f13ef,{'val':_0x52bc2f,'ack':!![]}),_0x6b5716[_0x368c2a(0xfd)][_0x368c2a(0x10d)](_0x368c2a(0x122)+_0x1a4857+')\x20generated.');}catch(_0x11f39e){_0x6b5716[_0x368c2a(0xfd)][_0x368c2a(0x13e)](_0x368c2a(0x12c)+_0x11f39e[_0x368c2a(0x131)]);}}module[a0_0x58cb92(0x16c)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};