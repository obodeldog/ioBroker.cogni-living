const a0_0xf158ed=a0_0x74d2;(function(_0x4b9751,_0x53d9c0){const _0x121291=a0_0x74d2,_0xee25b7=_0x4b9751();while(!![]){try{const _0x29afac=parseInt(_0x121291(0x1cc))/0x1*(parseInt(_0x121291(0x202))/0x2)+parseInt(_0x121291(0x203))/0x3+-parseInt(_0x121291(0x1c7))/0x4*(-parseInt(_0x121291(0x1ef))/0x5)+parseInt(_0x121291(0x1fb))/0x6*(-parseInt(_0x121291(0x1c1))/0x7)+-parseInt(_0x121291(0x209))/0x8+-parseInt(_0x121291(0x1c5))/0x9*(-parseInt(_0x121291(0x23d))/0xa)+-parseInt(_0x121291(0x20c))/0xb*(parseInt(_0x121291(0x1f5))/0xc);if(_0x29afac===_0x53d9c0)break;else _0xee25b7['push'](_0xee25b7['shift']());}catch(_0x329f47){_0xee25b7['push'](_0xee25b7['shift']());}}}(a0_0x4272,0x406b1));const a0_0x5e2eba=(function(){let _0x158d7c=!![];return function(_0x527d97,_0x2383f9){const _0x3a1d60=_0x158d7c?function(){const _0xf90124=a0_0x74d2;if(_0x2383f9){const _0x18152a=_0x2383f9[_0xf90124(0x212)](_0x527d97,arguments);return _0x2383f9=null,_0x18152a;}}:function(){};return _0x158d7c=![],_0x3a1d60;};}()),a0_0x1081ce=a0_0x5e2eba(this,function(){const _0x215634=a0_0x74d2;return a0_0x1081ce['toString']()[_0x215634(0x1f8)](_0x215634(0x1fe))[_0x215634(0x20b)]()[_0x215634(0x22a)](a0_0x1081ce)[_0x215634(0x1f8)]('(((.+)+)+)+$');});a0_0x1081ce();'use strict';const {GoogleGenerativeAI}=require(a0_0xf158ed(0x220)),setup=require(a0_0xf158ed(0x1e4)),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0xf158ed(0x1c2),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;function a0_0x4272(){const _0x3e2ab2=['¬∞C,\x20','100dBgnHF','setHours','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','Skipped\x20(No\x20AI\x20or\x20Data)',').\x20Sending\x20notification...','map','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','replace','üåÖ\x20Briefing\x20generated\x20(Length:\x20','message','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','üìÖ\x20Daily\x20Digest:\x0a','.\x20EVENTS:\x20','text','setStateAsync','Wetterdaten\x20nicht\x20abrufbar','.Current.WeatherText','\x20->\x20','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','system.presenceWho','weatherInstance','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Nacht','analysis.automation.patternDetected','Traffic-Schutz\x20(Auto-Approved)','\x0a\x20\x20\x20\x20EVENTS:\x0a','setForeignStateAsync','join','ü§ñ\x20Butler\x20Brain\x20Error:\x20','description','filter','useWeather','analysis.health.geminiNight','decision','42wIICLc','LTM.processingStatus','getForeignStateAsync','approved','260757Bfymzr','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','456308YfZBaE','toISOString','analysis.automation.autoApply','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','getStateAsync','131iwdtBw','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','Tag','analysis.health.geminiDay','now','N/A\x20(Learning)','KI\x20offline\x20(Fallback)','exports','lastAlertState','value','eventHistory','\x20=\x20','analysis.automation.targetId','debug','pop','stringify','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','reason','splice','.Current.IsNight','setDate','generateContent','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','normal','./setup','analysis.automation.description','analysis.lastResult','.\x20EMERGENCY:\x20','Health\x20Report\x20Error:\x20','analysisHistory','targetValue','toLocaleTimeString','val','Briefing\x20Error:\x20','isAlert','20JCjaDg','info','Started...','LTM.driftAnalysis.driftDetails','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','response','254964tpUldL','Keine\x20Details.','Digest','search','analysis.analysisHistory','\x0aSTB:\x20','379212oGWvNj','analysis.alertReason','Unbekannt','(((.+)+)+)+$','config','Gemini\x20Error:\x20','getTime','7196miTCzk','1146651ZzhvMK','geminiModel','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','‚ö†Ô∏è\x20ALARM:\x20','warn','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','2722888VMSyIQ','sendNotification','toString','319Ybuvsl','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','2-digit',',\x20Wetter:\x20','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','analysis.isAlert','apply','BUTLER\x20Execution\x20Error:\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a',',\x20Lichtverh√§ltnisse:\x20','KI-Fehler\x20(Fallback)','LTM.driftAnalysis.baselineDrift','activityLevel','\x0aAktivit√§t:\x20','Sicherheit\x20geht\x20vor.','.Current.Temperature','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','targetId','parse','analysis.automation.targetValue','@google/generative-ai','currentSystemMode','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','automationProposal','generic','rawEventLog','ü§ñ\x20Health\x20Report\x20(','isProVersion','detected','dailyDigests','constructor','toFixed','alertReason','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','driftDetails','baselineDrift','error','log','slice','getDate','summary','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','NIGHT','üåÖ\x20Morning\x20Briefing:\x0a','length','timestamp','trim','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.'];a0_0x4272=function(){return _0x3e2ab2;};return a0_0x4272();}let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':a0_0xf158ed(0x1cd),'family':a0_0xf158ed(0x1f3),'single_comfort':a0_0xf158ed(0x205),'security':a0_0xf158ed(0x21a),'energy_saver':'PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).'};function canCallApi(){const _0x3dfa7c=a0_0xf158ed,_0x3463b6=Date[_0x3dfa7c(0x1d0)]();return _0x3463b6-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){lastGlobalApiCall=Date['now']();}async function getWeatherContext(_0x401a22){const _0x154142=a0_0xf158ed;if(!_0x401a22[_0x154142(0x1ff)][_0x154142(0x1be)]||!_0x401a22[_0x154142(0x1ff)][_0x154142(0x251)])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x28e407=_0x401a22[_0x154142(0x1ff)][_0x154142(0x251)];let _0x2945f0=await _0x401a22[_0x154142(0x1c3)](_0x28e407+_0x154142(0x21b));if(!_0x2945f0)_0x2945f0=await _0x401a22['getForeignStateAsync'](_0x28e407+'.forecast.current.temperature');let _0x50ad9f=await _0x401a22[_0x154142(0x1c3)](_0x28e407+_0x154142(0x24d));if(!_0x50ad9f)_0x50ad9f=await _0x401a22['getForeignStateAsync'](_0x28e407+'.forecast.current.state');let _0xb574f7=_0x154142(0x1fd);const _0x278259=await _0x401a22[_0x154142(0x1c3)](_0x28e407+_0x154142(0x1df));if(_0x278259)_0xb574f7=_0x278259[_0x154142(0x1ec)]?_0x154142(0x253):_0x154142(0x1ce);if(_0x2945f0&&_0x50ad9f)return _0x2945f0[_0x154142(0x1ec)]+_0x154142(0x23c)+_0x50ad9f[_0x154142(0x1ec)]+_0x154142(0x215)+_0xb574f7;}catch(_0x21a702){}return _0x154142(0x24c);}function a0_0x74d2(_0x91577f,_0x20c067){const _0x26b052=a0_0x4272();return a0_0x74d2=function(_0x1081ce,_0x5e2eba){_0x1081ce=_0x1081ce-0x1bc;let _0x427222=_0x26b052[_0x1081ce];return _0x427222;},a0_0x74d2(_0x91577f,_0x20c067);}async function consultButler(_0x17b62f,_0x41cb3e,_0x9b73ed,_0x2b4e11){const _0x4a46f8=a0_0xf158ed;if(!_0x17b62f[_0x4a46f8(0x204)])return{'approved':!![],'reason':_0x4a46f8(0x1d2)};const _0x29255a=Date[_0x4a46f8(0x1d0)]();if(decisionCache[_0x41cb3e]&&_0x29255a-decisionCache[_0x41cb3e]['timestamp']<CACHE_TTL_MS){const _0x253ece=decisionCache[_0x41cb3e][_0x4a46f8(0x1c0)];return _0x17b62f[_0x4a46f8(0x231)][_0x4a46f8(0x1d9)](_0x4a46f8(0x23f)+_0x41cb3e+_0x4a46f8(0x24e)+(_0x253ece[_0x4a46f8(0x1c4)]?'OK':'NO')+'\x20('+_0x253ece[_0x4a46f8(0x1dd)]+')'),_0x253ece;}if(!canCallApi())return _0x17b62f[_0x4a46f8(0x231)][_0x4a46f8(0x1d9)](_0x4a46f8(0x235)+_0x41cb3e+'\x20√ºbersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x4a46f8(0x255)};const _0x11a88f=new Date()['toLocaleTimeString'](),_0x532b51=await getWeatherContext(_0x17b62f),_0x43e91c=PERSONA_MAPPING[_0x17b62f[_0x4a46f8(0x1ff)]['aiPersona']||_0x4a46f8(0x224)],_0x6d59d4=_0x4a46f8(0x1c6)+_0x11a88f+_0x4a46f8(0x20f)+_0x532b51+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x2b4e11*0x64)[_0x4a46f8(0x22b)](0x0)+'%)\x20nach\x20\x22'+_0x41cb3e+_0x4a46f8(0x210)+_0x9b73ed+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x43e91c+_0x4a46f8(0x1dc);try{updateApiTimestamp();const _0xf2df4c=await _0x17b62f[_0x4a46f8(0x204)]['generateContent'](_0x6d59d4),_0x141193=_0xf2df4c[_0x4a46f8(0x1f4)]['text']()[_0x4a46f8(0x244)](/```json|```/g,'')[_0x4a46f8(0x23a)](),_0xdada83=JSON[_0x4a46f8(0x21e)](_0x141193);return decisionCache[_0x41cb3e]={'decision':_0xdada83,'timestamp':_0x29255a},_0xdada83;}catch(_0x1ed5d4){return _0x17b62f['log'][_0x4a46f8(0x207)](_0x4a46f8(0x259)+_0x1ed5d4['message']),decisionCache[_0x41cb3e]={'decision':{'approved':!![],'reason':_0x4a46f8(0x216)},'timestamp':_0x29255a-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x4a46f8(0x216)};}}async function runGeminiAnalysis(_0x348167,_0xd7256d=''){const _0x37f7d2=a0_0xf158ed;if(!_0x348167[_0x37f7d2(0x204)])return;if(!canCallApi()){_0x348167[_0x37f7d2(0x231)]['debug'](_0x37f7d2(0x243));return;}if(_0x348167['eventHistory'][_0x37f7d2(0x238)]===0x0)return;const _0x477e64=_0x348167[_0x37f7d2(0x1d6)][_0x37f7d2(0x232)](0x0,0xf),_0x3ae504=_0x348167[_0x37f7d2(0x221)],_0x36ea6b=PERSONA_MAPPING[_0x348167['config']['aiPersona']||'generic'],_0x5bac85=_0x348167[_0x37f7d2(0x1ff)]['livingContext']||_0x37f7d2(0x1f6);let _0x1068e0=_0x37f7d2(0x1fd);try{const _0x4b4c99=await _0x348167['getStateAsync'](_0x37f7d2(0x250));if(_0x4b4c99&&_0x4b4c99[_0x37f7d2(0x1ec)])_0x1068e0=_0x4b4c99['val'];}catch(_0x582687){}let _0x3db1be=![];try{const _0xd329a9=await _0x348167[_0x37f7d2(0x1cb)](_0x37f7d2(0x1c9));if(_0xd329a9&&_0xd329a9[_0x37f7d2(0x1ec)])_0x3db1be=!![];}catch(_0x4e97bf){}const _0x12b6a0=_0x37f7d2(0x24f)+_0x36ea6b+'.\x20KONTEXT:\x20'+_0x5bac85+'.\x20SYSTEM_MODE:\x20'+_0x3ae504+'.\x20ANWESEND:\x20'+_0x1068e0+_0x37f7d2(0x249)+JSON[_0x37f7d2(0x1db)](_0x477e64)+_0x37f7d2(0x1e7)+_0xd7256d+_0x37f7d2(0x20d);try{updateApiTimestamp();const _0x1c2b47=await _0x348167[_0x37f7d2(0x204)][_0x37f7d2(0x1e1)](_0x12b6a0),_0x19ac1e=JSON[_0x37f7d2(0x21e)](_0x1c2b47[_0x37f7d2(0x1f4)][_0x37f7d2(0x24a)]()['replace'](/```json|```/g,'')['trim']());await _0x348167[_0x37f7d2(0x24b)](_0x37f7d2(0x1e6),{'val':JSON[_0x37f7d2(0x1db)](_0x19ac1e),'ack':!![]});if(_0x19ac1e['summary'])await _0x348167[_0x37f7d2(0x24b)]('analysis.activitySummary',{'val':_0x19ac1e[_0x37f7d2(0x234)],'ack':!![]});const _0x4e5a10={'timestamp':Date['now'](),'id':Date[_0x37f7d2(0x1d0)]()[_0x37f7d2(0x20b)](),'analysis':{'activity':{'summary':_0x19ac1e[_0x37f7d2(0x234)],'isAlert':_0x19ac1e[_0x37f7d2(0x1ee)],'alertReason':_0x19ac1e[_0x37f7d2(0x22c)]},'comfort':{'automationProposal':_0x19ac1e[_0x37f7d2(0x223)]}}};_0x348167[_0x37f7d2(0x1e9)]['unshift'](_0x4e5a10);if(_0x348167[_0x37f7d2(0x1e9)][_0x37f7d2(0x238)]>0x32)_0x348167[_0x37f7d2(0x1e9)][_0x37f7d2(0x1da)]();await _0x348167[_0x37f7d2(0x24b)](_0x37f7d2(0x1f9),{'val':JSON[_0x37f7d2(0x1db)](_0x348167[_0x37f7d2(0x1e9)]),'ack':!![]});const _0x399b40=_0x19ac1e['isAlert']||![];_0x399b40!==_0x348167['lastAlertState']&&(await _0x348167[_0x37f7d2(0x24b)](_0x37f7d2(0x211),{'val':_0x399b40,'ack':!![]}),_0x348167[_0x37f7d2(0x1d4)]=_0x399b40,_0x399b40&&(await _0x348167[_0x37f7d2(0x24b)](_0x37f7d2(0x1fc),{'val':_0x19ac1e[_0x37f7d2(0x22c)],'ack':!![]}),setup['sendNotification'](_0x348167,_0x37f7d2(0x206)+_0x19ac1e[_0x37f7d2(0x22c)],![],_0x19ac1e['isEmergency'])));if(_0x19ac1e[_0x37f7d2(0x223)]&&_0x19ac1e[_0x37f7d2(0x223)][_0x37f7d2(0x228)]){await _0x348167[_0x37f7d2(0x24b)](_0x37f7d2(0x254),{'val':!![],'ack':!![]}),await _0x348167['setStateAsync'](_0x37f7d2(0x1e5),{'val':_0x19ac1e[_0x37f7d2(0x223)][_0x37f7d2(0x1bc)],'ack':!![]}),await _0x348167['setStateAsync'](_0x37f7d2(0x1d8),{'val':_0x19ac1e[_0x37f7d2(0x223)][_0x37f7d2(0x21d)],'ack':!![]}),await _0x348167[_0x37f7d2(0x24b)](_0x37f7d2(0x21f),{'val':JSON[_0x37f7d2(0x1db)](_0x19ac1e[_0x37f7d2(0x223)][_0x37f7d2(0x1ea)]),'ack':!![]});if(_0x3db1be)executeAutomationAction(_0x348167);}}catch(_0x5068a0){_0x348167['log'][_0x37f7d2(0x230)](_0x37f7d2(0x200)+_0x5068a0[_0x37f7d2(0x246)]);}}async function createDailyDigest(_0x32ea45,_0x531fa8){const _0x29803b=a0_0xf158ed;if(!_0x32ea45[_0x29803b(0x227)])return;if(!canCallApi()){await _0x32ea45[_0x29803b(0x24b)](LTM_DP_STATUS,{'val':'Skipped\x20(Traffic)','ack':!![]});return;}await _0x32ea45['setStateAsync'](LTM_DP_STATUS,{'val':_0x29803b(0x1f1),'ack':!![]});if(!_0x32ea45[_0x29803b(0x204)]||_0x32ea45[_0x29803b(0x225)][_0x29803b(0x238)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x32ea45[_0x29803b(0x24b)](LTM_DP_STATUS,{'val':_0x29803b(0x240),'ack':!![]});return;}const _0x32d440=JSON['parse'](JSON[_0x29803b(0x1db)](_0x32ea45[_0x29803b(0x225)])),_0x3a1209=_0x32d440[_0x29803b(0x238)],_0x5bae9c=_0x29803b(0x214)+JSON[_0x29803b(0x1db)](_0x32d440);try{updateApiTimestamp();const _0x2aab5e=await _0x32ea45['geminiModel'][_0x29803b(0x1e1)](_0x5bae9c),_0x3aad0f=JSON[_0x29803b(0x21e)](_0x2aab5e['response'][_0x29803b(0x24a)]()[_0x29803b(0x244)](/```json|```/g,'')['trim']()),_0x1ca5ac={'timestamp':new Date()[_0x29803b(0x1c8)](),'eventCount':_0x3a1209,'summary':_0x3aad0f['summary']||_0x29803b(0x1f7),'activityLevel':_0x3aad0f[_0x29803b(0x218)]||_0x29803b(0x1e3),'systemMode':_0x32ea45['currentSystemMode']};_0x32ea45[_0x29803b(0x229)]['push'](_0x1ca5ac);const _0xaa7092=_0x32ea45[_0x29803b(0x1ff)]['ltmLtbWindowDays']||0x3c;_0x32ea45[_0x29803b(0x229)]['length']>_0xaa7092&&_0x32ea45[_0x29803b(0x229)][_0x29803b(0x1de)](0x0,_0x32ea45['dailyDigests'][_0x29803b(0x238)]-_0xaa7092);await _0x32ea45[_0x29803b(0x24b)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x29803b(0x1db)](_0x32ea45[_0x29803b(0x229)]),'ack':!![]}),_0x32ea45[_0x29803b(0x225)]=[],await _0x32ea45[_0x29803b(0x24b)](LTM_DP_RAW_LOG,{'val':JSON[_0x29803b(0x1db)](_0x32ea45[_0x29803b(0x225)]),'ack':!![]}),await _0x32ea45['setStateAsync'](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x260523=_0x29803b(0x248)+_0x3aad0f[_0x29803b(0x234)]+_0x29803b(0x219)+_0x3aad0f[_0x29803b(0x218)];setup[_0x29803b(0x20a)](_0x32ea45,_0x260523,![],![]);if(_0x32ea45[_0x29803b(0x227)]&&_0x531fa8)_0x531fa8['send'](_0x32ea45,'ANALYZE_HEALTH',{'digest':_0x1ca5ac});}catch(_0x433a2c){_0x32ea45[_0x29803b(0x231)][_0x29803b(0x230)](_0x433a2c[_0x29803b(0x246)]);}}async function runBaselineDriftAnalysis(_0x508b66){const _0xf4c806=a0_0xf158ed;if(!_0x508b66[_0xf4c806(0x227)]||!_0x508b66[_0xf4c806(0x204)])return;if(!canCallApi())return;const _0x18a307=_0x508b66[_0xf4c806(0x1ff)]['ltmStbWindowDays']||0xe;if(_0x508b66[_0xf4c806(0x229)][_0xf4c806(0x238)]<_0x18a307+0x7){await _0x508b66[_0xf4c806(0x24b)](_0xf4c806(0x217),{'val':_0xf4c806(0x1d1),'ack':!![]});return;}const _0x46652a=_0x508b66['dailyDigests'][_0xf4c806(0x232)](-_0x18a307),_0x14892a=_0x508b66[_0xf4c806(0x229)][_0xf4c806(0x232)](0x0,_0x508b66['dailyDigests'][_0xf4c806(0x238)]-_0x18a307),_0x51041d=_0xf4c806(0x252)+JSON[_0xf4c806(0x1db)](_0x14892a)+_0xf4c806(0x1fa)+JSON[_0xf4c806(0x1db)](_0x46652a);try{updateApiTimestamp();const _0x49ef04=await _0x508b66['geminiModel'][_0xf4c806(0x1e1)](_0x51041d),_0x5236e4=JSON[_0xf4c806(0x21e)](_0x49ef04['response']['text']()[_0xf4c806(0x244)](/```json|```/g,'')[_0xf4c806(0x23a)]());_0x5236e4[_0xf4c806(0x22f)]&&(await _0x508b66[_0xf4c806(0x24b)]('LTM.driftAnalysis.baselineDrift',{'val':_0x5236e4['baselineDrift'],'ack':!![]}),await _0x508b66[_0xf4c806(0x24b)](_0xf4c806(0x1f2),{'val':_0x5236e4[_0xf4c806(0x22e)],'ack':!![]}),await _0x508b66[_0xf4c806(0x24b)]('LTM.driftAnalysis.lastCheck',{'val':Date['now'](),'ack':!![]}));}catch(_0x787dcc){}}async function executeAutomationAction(_0x595625){const _0x19fecc=a0_0xf158ed;try{const _0x4ff261=await _0x595625[_0x19fecc(0x1cb)](_0x19fecc(0x1d8)),_0x1db180=await _0x595625[_0x19fecc(0x1cb)](_0x19fecc(0x21f));if(_0x4ff261&&_0x4ff261[_0x19fecc(0x1ec)]&&_0x1db180){const _0x4ae0d4=_0x4ff261[_0x19fecc(0x1ec)];let _0x3b0537=_0x1db180['val'];try{_0x3b0537=JSON[_0x19fecc(0x21e)](_0x3b0537);}catch(_0x1edcc5){}_0x595625['log'][_0x19fecc(0x1f0)](_0x19fecc(0x222)+_0x4ae0d4+_0x19fecc(0x1d7)+_0x3b0537),await _0x595625[_0x19fecc(0x257)](_0x4ae0d4,_0x3b0537);}else _0x595625['log'][_0x19fecc(0x207)](_0x19fecc(0x1ca));}catch(_0x245f95){_0x595625[_0x19fecc(0x231)][_0x19fecc(0x230)](_0x19fecc(0x213)+_0x245f95[_0x19fecc(0x246)]);}}async function sendMorningBriefing(_0x20193c){const _0x506356=a0_0xf158ed;if(!_0x20193c[_0x506356(0x204)]){_0x20193c[_0x506356(0x231)][_0x506356(0x207)](_0x506356(0x1e2));return;}_0x20193c['log'][_0x506356(0x1f0)]('üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x5f418c=_0x506356(0x208),_0x37e4a5=await _0x20193c['geminiModel']['generateContent'](_0x5f418c),_0x3ad337=_0x37e4a5[_0x506356(0x1f4)][_0x506356(0x24a)]();_0x20193c[_0x506356(0x231)][_0x506356(0x1f0)](_0x506356(0x245)+_0x3ad337[_0x506356(0x238)]+_0x506356(0x241)),setup['sendNotification'](_0x20193c,_0x506356(0x237)+_0x3ad337);}catch(_0x3bb4c9){_0x20193c[_0x506356(0x231)]['error'](_0x506356(0x1ed)+_0x3bb4c9[_0x506356(0x246)]);}}async function generateHealthReport(_0xe0b165,_0x57ffa4){const _0x2f58d1=a0_0xf158ed;if(!_0xe0b165[_0x2f58d1(0x204)])return;const _0x449c48=Date['now']();_0x449c48-lastGlobalApiCall<0xbb8&&(_0xe0b165[_0x2f58d1(0x231)][_0x2f58d1(0x1d9)](_0x2f58d1(0x247)),await new Promise(_0x464090=>setTimeout(_0x464090,0x7d0)));const _0x44c622=new Date();let _0x29efce=0x0,_0x59c044=_0x44c622['getTime'](),_0x175be4='';if(_0x57ffa4===_0x2f58d1(0x236)){const _0x21af67=new Date(_0x44c622);_0x21af67[_0x2f58d1(0x1e0)](_0x21af67[_0x2f58d1(0x233)]()-0x1),_0x21af67[_0x2f58d1(0x23e)](0x16,0x0,0x0,0x0),_0x29efce=_0x21af67['getTime']();const _0x52c780=new Date(_0x44c622);_0x52c780['setHours'](0x8,0x0,0x0,0x0),_0x59c044=_0x52c780[_0x2f58d1(0x201)](),_0x175be4='Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).';}else{const _0x4e362b=new Date(_0x44c622);_0x4e362b[_0x2f58d1(0x23e)](0x8,0x0,0x0,0x0),_0x29efce=_0x4e362b[_0x2f58d1(0x201)](),_0x175be4=_0x2f58d1(0x21c);}const _0x3b324c=_0xe0b165[_0x2f58d1(0x1d6)][_0x2f58d1(0x1bd)](_0xc6269e=>_0xc6269e[_0x2f58d1(0x239)]>=_0x29efce&&_0xc6269e[_0x2f58d1(0x239)]<=_0x59c044);if(_0x3b324c[_0x2f58d1(0x238)]===0x0){const _0x2bb5d1=_0x57ffa4===_0x2f58d1(0x236)?_0x2f58d1(0x22d):_0x2f58d1(0x23b),_0x2a6f55=_0x57ffa4===_0x2f58d1(0x236)?_0x2f58d1(0x1bf):_0x2f58d1(0x1cf);await _0xe0b165['setStateAsync'](_0x2a6f55,{'val':_0x2bb5d1,'ack':!![]});return;}const _0x200c60=_0x3b324c[_0x2f58d1(0x242)](_0x34ca6a=>new Date(_0x34ca6a['timestamp'])[_0x2f58d1(0x1eb)]([],{'hour':_0x2f58d1(0x20e),'minute':_0x2f58d1(0x20e)})+'\x20'+_0x34ca6a['name']+'\x20('+_0x34ca6a[_0x2f58d1(0x1d5)]+')')[_0x2f58d1(0x258)]('\x0a'),_0xea94cc='\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20'+_0x175be4+_0x2f58d1(0x256)+_0x200c60+'\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x4cc32b=await _0xe0b165[_0x2f58d1(0x204)][_0x2f58d1(0x1e1)](_0xea94cc),_0x120560=_0x4cc32b[_0x2f58d1(0x1f4)][_0x2f58d1(0x24a)](),_0xeb533d=_0x57ffa4===_0x2f58d1(0x236)?_0x2f58d1(0x1bf):_0x2f58d1(0x1cf);await _0xe0b165[_0x2f58d1(0x24b)](_0xeb533d,{'val':_0x120560,'ack':!![]}),_0xe0b165[_0x2f58d1(0x231)][_0x2f58d1(0x1f0)](_0x2f58d1(0x226)+_0x57ffa4+')\x20generated.');}catch(_0x545cc7){_0xe0b165[_0x2f58d1(0x231)][_0x2f58d1(0x230)](_0x2f58d1(0x1e8)+_0x545cc7[_0x2f58d1(0x246)]);}}module[a0_0xf158ed(0x1d3)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};