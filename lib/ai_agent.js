function a0_0x12f6(){const _0x185c35=['info','(((.+)+)+)+$','LTM.driftAnalysis.baselineDrift','N/A\x20(Learning)','alertReason','Skipped\x20(No\x20AI\x20or\x20Data)','%)\x20nach\x20\x22','analysis.automation.targetValue','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','LTM.driftAnalysis.lastCheck','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','decision','Sicherheit\x20geht\x20vor.','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','analysis.automation.description','getStateAsync','now','24RLiuIS','\x20=\x20','lastAlertState','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','.Current.IsNight','setHours','Tag','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','isAlert','reason','BUTLER\x20Execution\x20Error:\x20','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','targetValue','.\x20EMERGENCY:\x20','analysis.health.geminiNight','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','eventHistory','activityLevel','summary','Traffic-Schutz\x20(Auto-Approved)','ANALYZE_HEALTH','analysis.isAlert','targetId',').\x20Sending\x20notification...','toFixed','parse',',\x20Wetter:\x20','text','.\x20KONTEXT:\x20','unshift','Health\x20Report\x20Error:\x20','5008445EqcikD','description','Gemini\x20Error:\x20','isProVersion','\x0a\x20\x20\x20\x20EVENTS:\x0a','normal','setStateAsync','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','trim','âš ï¸\x20ALARM:\x20','stringify','LTM.driftAnalysis.driftDetails','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','currentSystemMode','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.Current.Temperature','Â°C,\x20','log','error','aiPersona','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','geminiModel','418935mFpzAC','2996883ScgSsO','Started...','getTime','analysis.activitySummary','analysis.health.geminiDay','toISOString','ltmStbWindowDays','config','16089920DdpBjT','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','182bVSmaL','\x20Ã¼bersprungen\x20(Auto-Approved).','KI\x20offline\x20(Fallback)','.\x20EVENTS:\x20','\x0aAktivitÃ¤t:\x20','Success','Unbekannt\x20(Kein\x20Sensor)',')\x20generated.','slice','4gZHgOG','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','Unbekannt','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','Skipped\x20(Traffic)','send','KI-Fehler\x20(Fallback)','generic','models/gemini-flash-latest','LTM.dailyDigests','response','ðŸ“…\x20Daily\x20Digest:\x0a','replace','exports','getForeignStateAsync','.Current.WeatherText','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','.forecast.current.temperature','@google/generative-ai','map','length','\x0aSTB:\x20','./setup','2-digit','5450840zPyVRt','constructor','dailyDigests','9423VXqUGk','splice','generateContent','search','system.presenceWho','debug','warn','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','weatherInstance','filter','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','\x20->\x20','170598XRrtoc','val','sendNotification','Wetterdaten\x20nicht\x20abrufbar','502OzrJmj','join','automationProposal','message','analysis.automation.patternDetected','LTM.processingStatus','LTM.rawEventLog','rawEventLog','.\x20SYSTEM_MODE:\x20','baselineDrift','NIGHT','timestamp','Nacht','toString',',\x20LichtverhÃ¤ltnisse:\x20','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','approved','analysisHistory','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','analysis.automation.targetId','analysis.alertReason','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','setDate','livingContext','Briefing\x20Error:\x20'];a0_0x12f6=function(){return _0x185c35;};return a0_0x12f6();}const a0_0x33966a=a0_0x1c7d;(function(_0x15e111,_0x36e3ed){const _0x3754e3=a0_0x1c7d,_0x3b8384=_0x15e111();while(!![]){try{const _0x38b7ec=-parseInt(_0x3754e3(0x235))/0x1+-parseInt(_0x3754e3(0x1d6))/0x2*(-parseInt(_0x3754e3(0x264))/0x3)+parseInt(_0x3754e3(0x249))/0x4*(-parseInt(_0x3754e3(0x21f))/0x5)+-parseInt(_0x3754e3(0x1d2))/0x6*(parseInt(_0x3754e3(0x240))/0x7)+parseInt(_0x3754e3(0x200))/0x8*(parseInt(_0x3754e3(0x236))/0x9)+-parseInt(_0x3754e3(0x261))/0xa+parseInt(_0x3754e3(0x23e))/0xb;if(_0x38b7ec===_0x36e3ed)break;else _0x3b8384['push'](_0x3b8384['shift']());}catch(_0x15277f){_0x3b8384['push'](_0x3b8384['shift']());}}}(a0_0x12f6,0x85152));const a0_0x4d33e5=(function(){let _0x1c6ebe=!![];return function(_0x217fe9,_0xb545db){const _0x699fef=_0x1c6ebe?function(){if(_0xb545db){const _0x3b4c79=_0xb545db['apply'](_0x217fe9,arguments);return _0xb545db=null,_0x3b4c79;}}:function(){};return _0x1c6ebe=![],_0x699fef;};}()),a0_0x1320e6=a0_0x4d33e5(this,function(){const _0x672e2b=a0_0x1c7d;return a0_0x1320e6[_0x672e2b(0x1e3)]()['search'](_0x672e2b(0x1f0))[_0x672e2b(0x1e3)]()[_0x672e2b(0x262)](a0_0x1320e6)[_0x672e2b(0x267)]('(((.+)+)+)+$');});a0_0x1320e6();function a0_0x1c7d(_0x34663d,_0x59d00c){const _0x11913f=a0_0x12f6();return a0_0x1c7d=function(_0x1320e6,_0x4d33e5){_0x1320e6=_0x1320e6-0x1cf;let _0x12f677=_0x11913f[_0x1320e6];return _0x12f677;},a0_0x1c7d(_0x34663d,_0x59d00c);}'use strict';const {GoogleGenerativeAI}=require(a0_0x33966a(0x25b)),setup=require(a0_0x33966a(0x25f)),GEMINI_MODEL=a0_0x33966a(0x251),LTM_DP_DAILY_DIGESTS=a0_0x33966a(0x252),LTM_DP_STATUS=a0_0x33966a(0x1db),LTM_DP_RAW_LOG=a0_0x33966a(0x1dc),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x33966a(0x1f9),'senior_aal':a0_0x33966a(0x24c),'family':a0_0x33966a(0x1eb),'single_comfort':a0_0x33966a(0x233),'security':a0_0x33966a(0x1fb),'energy_saver':a0_0x33966a(0x20b)};function canCallApi(){const _0x2752b5=a0_0x33966a,_0x5d74cb=Date[_0x2752b5(0x1ff)]();return _0x5d74cb-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x3809e3=a0_0x33966a;lastGlobalApiCall=Date[_0x3809e3(0x1ff)]();}async function getWeatherContext(_0x4473d0){const _0xfa6732=a0_0x33966a;if(!_0x4473d0[_0xfa6732(0x23d)]['useWeather']||!_0x4473d0['config'][_0xfa6732(0x26c)])return _0xfa6732(0x246);try{const _0x1f38d=_0x4473d0['config'][_0xfa6732(0x26c)];let _0x51390b=await _0x4473d0['getForeignStateAsync'](_0x1f38d+_0xfa6732(0x22e));if(!_0x51390b)_0x51390b=await _0x4473d0[_0xfa6732(0x257)](_0x1f38d+_0xfa6732(0x25a));let _0x5464c0=await _0x4473d0[_0xfa6732(0x257)](_0x1f38d+_0xfa6732(0x258));if(!_0x5464c0)_0x5464c0=await _0x4473d0[_0xfa6732(0x257)](_0x1f38d+'.forecast.current.state');let _0x29d565=_0xfa6732(0x24b);const _0xbaba5b=await _0x4473d0[_0xfa6732(0x257)](_0x1f38d+_0xfa6732(0x204));if(_0xbaba5b)_0x29d565=_0xbaba5b['val']?_0xfa6732(0x1e2):_0xfa6732(0x206);if(_0x51390b&&_0x5464c0)return _0x51390b[_0xfa6732(0x1d3)]+_0xfa6732(0x22f)+_0x5464c0[_0xfa6732(0x1d3)]+_0xfa6732(0x1e4)+_0x29d565;}catch(_0x54810e){}return _0xfa6732(0x1d5);}async function consultButler(_0x25863d,_0x58557a,_0x26fc0a,_0x42f354){const _0x44a7b6=a0_0x33966a;if(!_0x25863d['geminiModel'])return{'approved':!![],'reason':_0x44a7b6(0x242)};const _0x1f4968=Date[_0x44a7b6(0x1ff)]();if(decisionCache[_0x58557a]&&_0x1f4968-decisionCache[_0x58557a]['timestamp']<CACHE_TTL_MS){const _0x7bc1d=decisionCache[_0x58557a][_0x44a7b6(0x1fa)];return _0x25863d[_0x44a7b6(0x230)][_0x44a7b6(0x269)](_0x44a7b6(0x1fc)+_0x58557a+_0x44a7b6(0x1d1)+(_0x7bc1d[_0x44a7b6(0x1e6)]?'OK':'NO')+'\x20('+_0x7bc1d[_0x44a7b6(0x209)]+')'),_0x7bc1d;}if(!canCallApi())return _0x25863d[_0x44a7b6(0x230)][_0x44a7b6(0x269)]('ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20'+_0x58557a+_0x44a7b6(0x241)),{'approved':!![],'reason':_0x44a7b6(0x213)};const _0x2d993b=new Date()['toLocaleTimeString'](),_0x510481=await getWeatherContext(_0x25863d),_0x2a89f4=PERSONA_MAPPING[_0x25863d['config'][_0x44a7b6(0x232)]||'generic'],_0x297f9f='\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20'+_0x2d993b+_0x44a7b6(0x21a)+_0x510481+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x42f354*0x64)[_0x44a7b6(0x218)](0x0)+_0x44a7b6(0x1f5)+_0x58557a+'\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22'+_0x26fc0a+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x2a89f4+_0x44a7b6(0x207);try{updateApiTimestamp();const _0x293e6e=await _0x25863d[_0x44a7b6(0x234)][_0x44a7b6(0x266)](_0x297f9f),_0x384bc0=_0x293e6e[_0x44a7b6(0x253)][_0x44a7b6(0x21b)]()[_0x44a7b6(0x255)](/```json|```/g,'')[_0x44a7b6(0x227)](),_0x1916f1=JSON[_0x44a7b6(0x219)](_0x384bc0);return decisionCache[_0x58557a]={'decision':_0x1916f1,'timestamp':_0x1f4968},_0x1916f1;}catch(_0x337d41){return _0x25863d[_0x44a7b6(0x230)][_0x44a7b6(0x26a)](_0x44a7b6(0x23f)+_0x337d41[_0x44a7b6(0x1d9)]),decisionCache[_0x58557a]={'decision':{'approved':!![],'reason':_0x44a7b6(0x24f)},'timestamp':_0x1f4968-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'};}}async function runGeminiAnalysis(_0x5f02f8,_0x178bf6=''){const _0x261368=a0_0x33966a;if(!_0x5f02f8[_0x261368(0x234)])return;if(!canCallApi()){_0x5f02f8['log'][_0x261368(0x269)](_0x261368(0x1f7));return;}if(_0x5f02f8['eventHistory'][_0x261368(0x25d)]===0x0)return;const _0xce0826=_0x5f02f8['eventHistory'][_0x261368(0x248)](0x0,0xf),_0x47992e=_0x5f02f8[_0x261368(0x22c)],_0x4b6125=PERSONA_MAPPING[_0x5f02f8[_0x261368(0x23d)][_0x261368(0x232)]||_0x261368(0x250)],_0x463401=_0x5f02f8[_0x261368(0x23d)][_0x261368(0x1ed)]||'Keine\x20Details.';let _0x2cbbfd=_0x261368(0x24b);try{const _0x3cbf63=await _0x5f02f8[_0x261368(0x1fe)](_0x261368(0x268));if(_0x3cbf63&&_0x3cbf63['val'])_0x2cbbfd=_0x3cbf63['val'];}catch(_0x5eb9a8){}let _0x13cf29=![];try{const _0x579982=await _0x5f02f8['getStateAsync']('analysis.automation.autoApply');if(_0x579982&&_0x579982[_0x261368(0x1d3)])_0x13cf29=!![];}catch(_0x4becfd){}const _0x4efca1=_0x261368(0x20f)+_0x4b6125+_0x261368(0x21c)+_0x463401+_0x261368(0x1de)+_0x47992e+'.\x20ANWESEND:\x20'+_0x2cbbfd+_0x261368(0x243)+JSON[_0x261368(0x229)](_0xce0826)+_0x261368(0x20d)+_0x178bf6+_0x261368(0x26b);try{updateApiTimestamp();const _0x2fd8b0=await _0x5f02f8[_0x261368(0x234)][_0x261368(0x266)](_0x4efca1),_0x4e9e8b=JSON[_0x261368(0x219)](_0x2fd8b0[_0x261368(0x253)][_0x261368(0x21b)]()[_0x261368(0x255)](/```json|```/g,'')[_0x261368(0x227)]());await _0x5f02f8[_0x261368(0x225)]('analysis.lastResult',{'val':JSON[_0x261368(0x229)](_0x4e9e8b),'ack':!![]});if(_0x4e9e8b['summary'])await _0x5f02f8[_0x261368(0x225)](_0x261368(0x239),{'val':_0x4e9e8b[_0x261368(0x212)],'ack':!![]});const _0xc8fae6={'timestamp':Date[_0x261368(0x1ff)](),'id':Date[_0x261368(0x1ff)]()[_0x261368(0x1e3)](),'analysis':{'activity':{'summary':_0x4e9e8b[_0x261368(0x212)],'isAlert':_0x4e9e8b[_0x261368(0x208)],'alertReason':_0x4e9e8b[_0x261368(0x1f3)]},'comfort':{'automationProposal':_0x4e9e8b[_0x261368(0x1d8)]}}};_0x5f02f8[_0x261368(0x1e7)][_0x261368(0x21d)](_0xc8fae6);if(_0x5f02f8[_0x261368(0x1e7)]['length']>0x32)_0x5f02f8[_0x261368(0x1e7)]['pop']();await _0x5f02f8[_0x261368(0x225)]('analysis.analysisHistory',{'val':JSON[_0x261368(0x229)](_0x5f02f8[_0x261368(0x1e7)]),'ack':!![]});const _0x25243f=_0x4e9e8b['isAlert']||![];_0x25243f!==_0x5f02f8['lastAlertState']&&(await _0x5f02f8[_0x261368(0x225)](_0x261368(0x215),{'val':_0x25243f,'ack':!![]}),_0x5f02f8[_0x261368(0x202)]=_0x25243f,_0x25243f&&(await _0x5f02f8['setStateAsync'](_0x261368(0x1ea),{'val':_0x4e9e8b[_0x261368(0x1f3)],'ack':!![]}),setup[_0x261368(0x1d4)](_0x5f02f8,_0x261368(0x228)+_0x4e9e8b[_0x261368(0x1f3)],![],_0x4e9e8b['isEmergency'])));if(_0x4e9e8b[_0x261368(0x1d8)]&&_0x4e9e8b[_0x261368(0x1d8)]['detected']){await _0x5f02f8['setStateAsync'](_0x261368(0x1da),{'val':!![],'ack':!![]}),await _0x5f02f8[_0x261368(0x225)](_0x261368(0x1fd),{'val':_0x4e9e8b['automationProposal'][_0x261368(0x220)],'ack':!![]}),await _0x5f02f8[_0x261368(0x225)](_0x261368(0x1e9),{'val':_0x4e9e8b[_0x261368(0x1d8)][_0x261368(0x216)],'ack':!![]}),await _0x5f02f8[_0x261368(0x225)](_0x261368(0x1f6),{'val':JSON[_0x261368(0x229)](_0x4e9e8b[_0x261368(0x1d8)][_0x261368(0x20c)]),'ack':!![]});if(_0x13cf29)executeAutomationAction(_0x5f02f8);}}catch(_0x439e21){_0x5f02f8['log']['error'](_0x261368(0x221)+_0x439e21['message']);}}async function createDailyDigest(_0x2b2115,_0x2b1b60){const _0x224215=a0_0x33966a;if(!_0x2b2115[_0x224215(0x222)])return;if(!canCallApi()){await _0x2b2115[_0x224215(0x225)](LTM_DP_STATUS,{'val':_0x224215(0x24d),'ack':!![]});return;}await _0x2b2115[_0x224215(0x225)](LTM_DP_STATUS,{'val':_0x224215(0x237),'ack':!![]});if(!_0x2b2115['geminiModel']||_0x2b2115[_0x224215(0x1dd)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2b2115[_0x224215(0x225)](LTM_DP_STATUS,{'val':_0x224215(0x1f4),'ack':!![]});return;}const _0x1401c0=JSON[_0x224215(0x219)](JSON[_0x224215(0x229)](_0x2b2115[_0x224215(0x1dd)])),_0x4df03c=_0x1401c0[_0x224215(0x25d)],_0xe7d8c=_0x224215(0x22d)+JSON[_0x224215(0x229)](_0x1401c0);try{updateApiTimestamp();const _0x39696f=await _0x2b2115[_0x224215(0x234)][_0x224215(0x266)](_0xe7d8c),_0x120488=JSON[_0x224215(0x219)](_0x39696f['response'][_0x224215(0x21b)]()['replace'](/```json|```/g,'')['trim']()),_0x3204da={'timestamp':new Date()[_0x224215(0x23b)](),'eventCount':_0x4df03c,'summary':_0x120488[_0x224215(0x212)]||'Digest','activityLevel':_0x120488[_0x224215(0x211)]||_0x224215(0x224),'systemMode':_0x2b2115[_0x224215(0x22c)]};_0x2b2115[_0x224215(0x263)]['push'](_0x3204da);const _0x5c5d2f=_0x2b2115[_0x224215(0x23d)]['ltmLtbWindowDays']||0x3c;_0x2b2115[_0x224215(0x263)]['length']>_0x5c5d2f&&_0x2b2115[_0x224215(0x263)][_0x224215(0x265)](0x0,_0x2b2115['dailyDigests']['length']-_0x5c5d2f);await _0x2b2115['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x224215(0x229)](_0x2b2115[_0x224215(0x263)]),'ack':!![]}),_0x2b2115['rawEventLog']=[],await _0x2b2115[_0x224215(0x225)](LTM_DP_RAW_LOG,{'val':JSON[_0x224215(0x229)](_0x2b2115['rawEventLog']),'ack':!![]}),await _0x2b2115[_0x224215(0x225)](LTM_DP_STATUS,{'val':_0x224215(0x245),'ack':!![]});const _0x565d3c=_0x224215(0x254)+_0x120488[_0x224215(0x212)]+_0x224215(0x244)+_0x120488[_0x224215(0x211)];setup[_0x224215(0x1d4)](_0x2b2115,_0x565d3c,![],![]);if(_0x2b2115[_0x224215(0x222)]&&_0x2b1b60)_0x2b1b60[_0x224215(0x24e)](_0x2b2115,_0x224215(0x214),{'digest':_0x3204da});}catch(_0x208df5){_0x2b2115['log'][_0x224215(0x231)](_0x208df5[_0x224215(0x1d9)]);}}async function runBaselineDriftAnalysis(_0x3ebc30){const _0x531e63=a0_0x33966a;if(!_0x3ebc30['isProVersion']||!_0x3ebc30['geminiModel'])return;if(!canCallApi())return;const _0x5d3946=_0x3ebc30[_0x531e63(0x23d)][_0x531e63(0x23c)]||0xe;if(_0x3ebc30[_0x531e63(0x263)][_0x531e63(0x25d)]<_0x5d3946+0x7){await _0x3ebc30[_0x531e63(0x225)](_0x531e63(0x1f1),{'val':_0x531e63(0x1f2),'ack':!![]});return;}const _0x4400f3=_0x3ebc30[_0x531e63(0x263)]['slice'](-_0x5d3946),_0x307508=_0x3ebc30['dailyDigests']['slice'](0x0,_0x3ebc30[_0x531e63(0x263)][_0x531e63(0x25d)]-_0x5d3946),_0x2ad55a=_0x531e63(0x1e8)+JSON[_0x531e63(0x229)](_0x307508)+_0x531e63(0x25e)+JSON[_0x531e63(0x229)](_0x4400f3);try{updateApiTimestamp();const _0x72e91d=await _0x3ebc30[_0x531e63(0x234)][_0x531e63(0x266)](_0x2ad55a),_0x4cba01=JSON['parse'](_0x72e91d[_0x531e63(0x253)]['text']()[_0x531e63(0x255)](/```json|```/g,'')[_0x531e63(0x227)]());_0x4cba01[_0x531e63(0x1df)]&&(await _0x3ebc30[_0x531e63(0x225)](_0x531e63(0x1f1),{'val':_0x4cba01['baselineDrift'],'ack':!![]}),await _0x3ebc30[_0x531e63(0x225)](_0x531e63(0x22a),{'val':_0x4cba01['driftDetails'],'ack':!![]}),await _0x3ebc30['setStateAsync'](_0x531e63(0x1f8),{'val':Date[_0x531e63(0x1ff)](),'ack':!![]}));}catch(_0x1edeb4){}}async function executeAutomationAction(_0x5e9b12){const _0x312e6f=a0_0x33966a;try{const _0x3bb892=await _0x5e9b12[_0x312e6f(0x1fe)](_0x312e6f(0x1e9)),_0x5ddd45=await _0x5e9b12[_0x312e6f(0x1fe)](_0x312e6f(0x1f6));if(_0x3bb892&&_0x3bb892[_0x312e6f(0x1d3)]&&_0x5ddd45){const _0x2149e4=_0x3bb892['val'];let _0x1090f3=_0x5ddd45[_0x312e6f(0x1d3)];try{_0x1090f3=JSON[_0x312e6f(0x219)](_0x1090f3);}catch(_0x398fa2){}_0x5e9b12[_0x312e6f(0x230)]['info']('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x2149e4+_0x312e6f(0x201)+_0x1090f3),await _0x5e9b12['setForeignStateAsync'](_0x2149e4,_0x1090f3);}else _0x5e9b12['log']['warn'](_0x312e6f(0x203));}catch(_0x1ad86b){_0x5e9b12[_0x312e6f(0x230)]['error'](_0x312e6f(0x20a)+_0x1ad86b[_0x312e6f(0x1d9)]);}}async function sendMorningBriefing(_0xd8ea9a){const _0x376fae=a0_0x33966a;if(!_0xd8ea9a[_0x376fae(0x234)]){_0xd8ea9a[_0x376fae(0x230)]['warn'](_0x376fae(0x226));return;}_0xd8ea9a[_0x376fae(0x230)][_0x376fae(0x1ef)]('ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0xb31f6f='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x15d72c=await _0xd8ea9a['geminiModel'][_0x376fae(0x266)](_0xb31f6f),_0x3892bd=_0x15d72c[_0x376fae(0x253)]['text']();_0xd8ea9a[_0x376fae(0x230)][_0x376fae(0x1ef)](_0x376fae(0x22b)+_0x3892bd[_0x376fae(0x25d)]+_0x376fae(0x217)),setup['sendNotification'](_0xd8ea9a,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0x3892bd);}catch(_0x35f524){_0xd8ea9a['log']['error'](_0x376fae(0x1ee)+_0x35f524[_0x376fae(0x1d9)]);}}async function generateHealthReport(_0x32cf40,_0x2d17e7){const _0x3ad007=a0_0x33966a;if(!_0x32cf40[_0x3ad007(0x234)])return;const _0x3c1269=Date['now']();_0x3c1269-lastGlobalApiCall<0xbb8&&(_0x32cf40[_0x3ad007(0x230)][_0x3ad007(0x269)](_0x3ad007(0x1d0)),await new Promise(_0x477f5b=>setTimeout(_0x477f5b,0x7d0)));const _0xc7ff96=new Date();let _0x28c29d=0x0,_0x5a1616=_0xc7ff96[_0x3ad007(0x238)](),_0x18d7f6='';if(_0x2d17e7===_0x3ad007(0x1e0)){const _0x80a40e=new Date(_0xc7ff96);_0x80a40e[_0x3ad007(0x1ec)](_0x80a40e['getDate']()-0x1),_0x80a40e[_0x3ad007(0x205)](0x16,0x0,0x0,0x0),_0x28c29d=_0x80a40e[_0x3ad007(0x238)]();const _0x2450a4=new Date(_0xc7ff96);_0x2450a4[_0x3ad007(0x205)](0x8,0x0,0x0,0x0),_0x5a1616=_0x2450a4['getTime'](),_0x18d7f6=_0x3ad007(0x1e5);}else{const _0xc7ecc5=new Date(_0xc7ff96);_0xc7ecc5[_0x3ad007(0x205)](0x8,0x0,0x0,0x0),_0x28c29d=_0xc7ecc5[_0x3ad007(0x238)](),_0x18d7f6='Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).';}const _0xea853b=_0x32cf40[_0x3ad007(0x210)][_0x3ad007(0x1cf)](_0x3aa9d8=>_0x3aa9d8[_0x3ad007(0x1e1)]>=_0x28c29d&&_0x3aa9d8['timestamp']<=_0x5a1616);if(_0xea853b[_0x3ad007(0x25d)]===0x0){const _0x45a019=_0x2d17e7===_0x3ad007(0x1e0)?_0x3ad007(0x259):'Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.',_0x231b88=_0x2d17e7==='NIGHT'?_0x3ad007(0x20e):_0x3ad007(0x23a);await _0x32cf40[_0x3ad007(0x225)](_0x231b88,{'val':_0x45a019,'ack':!![]});return;}const _0x15a635=_0xea853b[_0x3ad007(0x25c)](_0x253eaf=>new Date(_0x253eaf[_0x3ad007(0x1e1)])['toLocaleTimeString']([],{'hour':'2-digit','minute':_0x3ad007(0x260)})+'\x20'+_0x253eaf['name']+'\x20('+_0x253eaf['value']+')')[_0x3ad007(0x1d7)]('\x0a'),_0x50a4bd=_0x3ad007(0x24a)+_0x18d7f6+_0x3ad007(0x223)+_0x15a635+'\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x5732b3=await _0x32cf40[_0x3ad007(0x234)][_0x3ad007(0x266)](_0x50a4bd),_0x292636=_0x5732b3[_0x3ad007(0x253)][_0x3ad007(0x21b)](),_0x42a6cf=_0x2d17e7===_0x3ad007(0x1e0)?_0x3ad007(0x20e):_0x3ad007(0x23a);await _0x32cf40['setStateAsync'](_0x42a6cf,{'val':_0x292636,'ack':!![]}),_0x32cf40[_0x3ad007(0x230)]['info']('ðŸ¤–\x20Health\x20Report\x20('+_0x2d17e7+_0x3ad007(0x247));}catch(_0x7e4a12){_0x32cf40['log'][_0x3ad007(0x231)](_0x3ad007(0x21e)+_0x7e4a12['message']);}}module[a0_0x33966a(0x256)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};