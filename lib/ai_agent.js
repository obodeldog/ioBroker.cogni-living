const a0_0x1542ee=a0_0x3398;(function(_0x12b389,_0xfaf14c){const _0x1f2604=a0_0x3398,_0x3be023=_0x12b389();while(!![]){try{const _0x5b0780=-parseInt(_0x1f2604(0x16a))/0x1*(parseInt(_0x1f2604(0x1ca))/0x2)+parseInt(_0x1f2604(0x18d))/0x3*(parseInt(_0x1f2604(0x14b))/0x4)+-parseInt(_0x1f2604(0x18a))/0x5+-parseInt(_0x1f2604(0x19b))/0x6*(-parseInt(_0x1f2604(0x173))/0x7)+parseInt(_0x1f2604(0x167))/0x8+parseInt(_0x1f2604(0x1b7))/0x9+-parseInt(_0x1f2604(0x14f))/0xa;if(_0x5b0780===_0xfaf14c)break;else _0x3be023['push'](_0x3be023['shift']());}catch(_0x385717){_0x3be023['push'](_0x3be023['shift']());}}}(a0_0x1b4c,0x30849));function a0_0x3398(_0x11cbcb,_0x4d71ba){const _0x9fd174=a0_0x1b4c();return a0_0x3398=function(_0x47084e,_0x1a923e){_0x47084e=_0x47084e-0x149;let _0x1b4cc1=_0x9fd174[_0x47084e];return _0x1b4cc1;},a0_0x3398(_0x11cbcb,_0x4d71ba);}const a0_0x1a923e=(function(){let _0x4f4d0e=!![];return function(_0x559b8a,_0x33016d){const _0x4c8d39=_0x4f4d0e?function(){const _0x24b800=a0_0x3398;if(_0x33016d){const _0xc2f7d9=_0x33016d[_0x24b800(0x191)](_0x559b8a,arguments);return _0x33016d=null,_0xc2f7d9;}}:function(){};return _0x4f4d0e=![],_0x4c8d39;};}()),a0_0x47084e=a0_0x1a923e(this,function(){const _0x2cffbe=a0_0x3398;return a0_0x47084e[_0x2cffbe(0x1ab)]()['search']('(((.+)+)+)+$')['toString']()[_0x2cffbe(0x180)](a0_0x47084e)[_0x2cffbe(0x196)]('(((.+)+)+)+$');});a0_0x47084e();'use strict';const {GoogleGenerativeAI}=require(a0_0x1542ee(0x1c2)),setup=require(a0_0x1542ee(0x1d0)),GEMINI_MODEL=a0_0x1542ee(0x176),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x1542ee(0x156),LTM_DP_RAW_LOG=a0_0x1542ee(0x159),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x1542ee(0x1d5),'senior_aal':a0_0x1542ee(0x190),'family':a0_0x1542ee(0x14a),'single_comfort':a0_0x1542ee(0x18f),'security':a0_0x1542ee(0x165),'energy_saver':a0_0x1542ee(0x17f)};function canCallApi(){const _0x5db6ee=Date['now']();return _0x5db6ee-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x40870f=a0_0x1542ee;lastGlobalApiCall=Date[_0x40870f(0x1b5)]();}async function getWeatherContext(_0x12cbdd){const _0x40b387=a0_0x1542ee;if(!_0x12cbdd['config'][_0x40b387(0x1a7)]||!_0x12cbdd[_0x40b387(0x164)][_0x40b387(0x1bc)])return _0x40b387(0x1cc);try{const _0x2a1bfb=_0x12cbdd[_0x40b387(0x164)]['weatherInstance'];let _0x44d181=await _0x12cbdd[_0x40b387(0x19a)](_0x2a1bfb+_0x40b387(0x16b));if(!_0x44d181)_0x44d181=await _0x12cbdd['getForeignStateAsync'](_0x2a1bfb+_0x40b387(0x14c));let _0x473220=await _0x12cbdd['getForeignStateAsync'](_0x2a1bfb+_0x40b387(0x1b1));if(!_0x473220)_0x473220=await _0x12cbdd[_0x40b387(0x19a)](_0x2a1bfb+_0x40b387(0x15a));let _0x6521d1=_0x40b387(0x15f);const _0x21e0f0=await _0x12cbdd[_0x40b387(0x19a)](_0x2a1bfb+_0x40b387(0x178));if(_0x21e0f0)_0x6521d1=_0x21e0f0[_0x40b387(0x187)]?_0x40b387(0x14d):_0x40b387(0x18c);if(_0x44d181&&_0x473220)return _0x44d181[_0x40b387(0x187)]+_0x40b387(0x1b8)+_0x473220[_0x40b387(0x187)]+_0x40b387(0x19f)+_0x6521d1;}catch(_0x5571ee){}return _0x40b387(0x1c5);}async function consultButler(_0x5e7163,_0x2d6feb,_0x38b2e1,_0x51d86b){const _0x210167=a0_0x1542ee;if(!_0x5e7163['geminiModel'])return{'approved':!![],'reason':_0x210167(0x1d2)};const _0x28fa9c=Date[_0x210167(0x1b5)]();if(decisionCache[_0x2d6feb]&&_0x28fa9c-decisionCache[_0x2d6feb][_0x210167(0x1b9)]<CACHE_TTL_MS){const _0x385a6f=decisionCache[_0x2d6feb][_0x210167(0x16f)];return _0x5e7163[_0x210167(0x1c1)][_0x210167(0x162)](_0x210167(0x19e)+_0x2d6feb+_0x210167(0x1c8)+(_0x385a6f['approved']?'OK':'NO')+'\x20('+_0x385a6f[_0x210167(0x177)]+')'),_0x385a6f;}if(!canCallApi())return _0x5e7163['log'][_0x210167(0x162)]('ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20'+_0x2d6feb+'\x20Ã¼bersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':'Traffic-Schutz\x20(Auto-Approved)'};const _0x1f5f0d=new Date()[_0x210167(0x1c0)](),_0x16fb50=await getWeatherContext(_0x5e7163),_0x160f8b=PERSONA_MAPPING[_0x5e7163[_0x210167(0x164)][_0x210167(0x1d1)]||'generic'],_0x54e6fb=_0x210167(0x161)+_0x1f5f0d+_0x210167(0x199)+_0x16fb50+_0x210167(0x183)+(_0x51d86b*0x64)[_0x210167(0x169)](0x0)+_0x210167(0x1a1)+_0x2d6feb+_0x210167(0x194)+_0x38b2e1+_0x210167(0x1ce)+_0x160f8b+_0x210167(0x174);try{updateApiTimestamp();const _0x1a9c49=await _0x5e7163[_0x210167(0x155)][_0x210167(0x151)](_0x54e6fb),_0x8c8c16=_0x1a9c49[_0x210167(0x1d4)]['text']()[_0x210167(0x1b0)](/```json|```/g,'')[_0x210167(0x195)](),_0x3747af=JSON['parse'](_0x8c8c16);return decisionCache[_0x2d6feb]={'decision':_0x3747af,'timestamp':_0x28fa9c},_0x3747af;}catch(_0x39d3e8){return _0x5e7163['log'][_0x210167(0x15d)](_0x210167(0x1cd)+_0x39d3e8[_0x210167(0x1c3)]),decisionCache[_0x2d6feb]={'decision':{'approved':!![],'reason':_0x210167(0x1cb)},'timestamp':_0x28fa9c-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x210167(0x1cb)};}}async function runGeminiAnalysis(_0x5ca95d,_0x533ba7=''){const _0x9dae7d=a0_0x1542ee;if(!_0x5ca95d[_0x9dae7d(0x155)])return;if(!canCallApi()){_0x5ca95d[_0x9dae7d(0x1c1)][_0x9dae7d(0x162)]('ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x5ca95d[_0x9dae7d(0x1a2)][_0x9dae7d(0x16c)]===0x0)return;const _0x43f2af=_0x5ca95d['eventHistory'][_0x9dae7d(0x1a5)](0x0,0xf),_0x2e8084=_0x5ca95d[_0x9dae7d(0x19c)],_0x5f52ad=PERSONA_MAPPING[_0x5ca95d['config']['aiPersona']||_0x9dae7d(0x1d6)],_0x32e0c7=_0x5ca95d[_0x9dae7d(0x164)][_0x9dae7d(0x150)]||_0x9dae7d(0x16d);let _0x40f3af=_0x9dae7d(0x15f);try{const _0x2e5065=await _0x5ca95d[_0x9dae7d(0x15c)](_0x9dae7d(0x170));if(_0x2e5065&&_0x2e5065['val'])_0x40f3af=_0x2e5065[_0x9dae7d(0x187)];}catch(_0xabffe5){}let _0x39b008=![];try{const _0x22049e=await _0x5ca95d['getStateAsync'](_0x9dae7d(0x16e));if(_0x22049e&&_0x22049e[_0x9dae7d(0x187)])_0x39b008=!![];}catch(_0x86638b){}const _0x192555=_0x9dae7d(0x1c6)+_0x5f52ad+_0x9dae7d(0x15e)+_0x32e0c7+_0x9dae7d(0x193)+_0x2e8084+_0x9dae7d(0x1b6)+_0x40f3af+_0x9dae7d(0x1b4)+JSON['stringify'](_0x43f2af)+_0x9dae7d(0x1a3)+_0x533ba7+_0x9dae7d(0x198);try{updateApiTimestamp();const _0x2c85b7=await _0x5ca95d[_0x9dae7d(0x155)][_0x9dae7d(0x151)](_0x192555),_0x5630b7=JSON[_0x9dae7d(0x1be)](_0x2c85b7[_0x9dae7d(0x1d4)][_0x9dae7d(0x189)]()[_0x9dae7d(0x1b0)](/```json|```/g,'')['trim']());await _0x5ca95d['setStateAsync'](_0x9dae7d(0x186),{'val':JSON[_0x9dae7d(0x18e)](_0x5630b7),'ack':!![]});if(_0x5630b7[_0x9dae7d(0x1af)])await _0x5ca95d[_0x9dae7d(0x1bf)](_0x9dae7d(0x1bd),{'val':_0x5630b7[_0x9dae7d(0x1af)],'ack':!![]});const _0x4f5431={'timestamp':Date[_0x9dae7d(0x1b5)](),'id':Date[_0x9dae7d(0x1b5)]()[_0x9dae7d(0x1ab)](),'analysis':{'activity':{'summary':_0x5630b7[_0x9dae7d(0x1af)],'isAlert':_0x5630b7[_0x9dae7d(0x17c)],'alertReason':_0x5630b7[_0x9dae7d(0x179)]},'comfort':{'automationProposal':_0x5630b7['automationProposal']}}};_0x5ca95d[_0x9dae7d(0x1b3)][_0x9dae7d(0x168)](_0x4f5431);if(_0x5ca95d[_0x9dae7d(0x1b3)][_0x9dae7d(0x16c)]>0x32)_0x5ca95d['analysisHistory'][_0x9dae7d(0x1d3)]();await _0x5ca95d[_0x9dae7d(0x1bf)](_0x9dae7d(0x149),{'val':JSON['stringify'](_0x5ca95d[_0x9dae7d(0x1b3)]),'ack':!![]});const _0x3e2bdf=_0x5630b7['isAlert']||![];_0x3e2bdf!==_0x5ca95d['lastAlertState']&&(await _0x5ca95d[_0x9dae7d(0x1bf)](_0x9dae7d(0x1ba),{'val':_0x3e2bdf,'ack':!![]}),_0x5ca95d['lastAlertState']=_0x3e2bdf,_0x3e2bdf&&(await _0x5ca95d[_0x9dae7d(0x1bf)]('analysis.alertReason',{'val':_0x5630b7['alertReason'],'ack':!![]}),setup[_0x9dae7d(0x152)](_0x5ca95d,_0x9dae7d(0x157)+_0x5630b7[_0x9dae7d(0x179)],![],_0x5630b7['isEmergency'])));if(_0x5630b7[_0x9dae7d(0x14e)]&&_0x5630b7[_0x9dae7d(0x14e)][_0x9dae7d(0x1ae)]){await _0x5ca95d[_0x9dae7d(0x1bf)](_0x9dae7d(0x18b),{'val':!![],'ack':!![]}),await _0x5ca95d[_0x9dae7d(0x1bf)]('analysis.automation.description',{'val':_0x5630b7[_0x9dae7d(0x14e)]['description'],'ack':!![]}),await _0x5ca95d[_0x9dae7d(0x1bf)](_0x9dae7d(0x17a),{'val':_0x5630b7[_0x9dae7d(0x14e)][_0x9dae7d(0x1a9)],'ack':!![]}),await _0x5ca95d[_0x9dae7d(0x1bf)](_0x9dae7d(0x171),{'val':JSON[_0x9dae7d(0x18e)](_0x5630b7[_0x9dae7d(0x14e)][_0x9dae7d(0x1b2)]),'ack':!![]});if(_0x39b008)executeAutomationAction(_0x5ca95d);}}catch(_0x3b5c68){_0x5ca95d[_0x9dae7d(0x1c1)][_0x9dae7d(0x181)]('Gemini\x20Error:\x20'+_0x3b5c68[_0x9dae7d(0x1c3)]);}}async function createDailyDigest(_0x1d187c,_0x59de87){const _0x29a941=a0_0x1542ee;if(!_0x1d187c[_0x29a941(0x15b)])return;if(!canCallApi()){await _0x1d187c[_0x29a941(0x1bf)](LTM_DP_STATUS,{'val':_0x29a941(0x166),'ack':!![]});return;}await _0x1d187c[_0x29a941(0x1bf)](LTM_DP_STATUS,{'val':_0x29a941(0x192),'ack':!![]});if(!_0x1d187c[_0x29a941(0x155)]||_0x1d187c[_0x29a941(0x1ad)][_0x29a941(0x16c)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1d187c['setStateAsync'](LTM_DP_STATUS,{'val':_0x29a941(0x1ac),'ack':!![]});return;}const _0x1d1820=JSON[_0x29a941(0x1be)](JSON[_0x29a941(0x18e)](_0x1d187c['rawEventLog'])),_0x746819=_0x1d1820[_0x29a941(0x16c)],_0x6e92be='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x29a941(0x18e)](_0x1d1820);try{updateApiTimestamp();const _0x5e479b=await _0x1d187c['geminiModel'][_0x29a941(0x151)](_0x6e92be),_0x248abf=JSON[_0x29a941(0x1be)](_0x5e479b[_0x29a941(0x1d4)][_0x29a941(0x189)]()[_0x29a941(0x1b0)](/```json|```/g,'')[_0x29a941(0x195)]()),_0x4d3437={'timestamp':new Date()[_0x29a941(0x1d7)](),'eventCount':_0x746819,'summary':_0x248abf[_0x29a941(0x1af)]||_0x29a941(0x19d),'activityLevel':_0x248abf[_0x29a941(0x175)]||_0x29a941(0x182),'systemMode':_0x1d187c[_0x29a941(0x19c)]};_0x1d187c[_0x29a941(0x158)][_0x29a941(0x163)](_0x4d3437);const _0x49f316=_0x1d187c[_0x29a941(0x164)][_0x29a941(0x17d)]||0x3c;_0x1d187c[_0x29a941(0x158)][_0x29a941(0x16c)]>_0x49f316&&_0x1d187c[_0x29a941(0x158)][_0x29a941(0x17e)](0x0,_0x1d187c[_0x29a941(0x158)][_0x29a941(0x16c)]-_0x49f316);await _0x1d187c['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x29a941(0x18e)](_0x1d187c[_0x29a941(0x158)]),'ack':!![]}),_0x1d187c['rawEventLog']=[],await _0x1d187c['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x29a941(0x18e)](_0x1d187c[_0x29a941(0x1ad)]),'ack':!![]}),await _0x1d187c[_0x29a941(0x1bf)](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x344869='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x248abf[_0x29a941(0x1af)]+_0x29a941(0x154)+_0x248abf[_0x29a941(0x175)];setup[_0x29a941(0x152)](_0x1d187c,_0x344869,![],![]);if(_0x1d187c[_0x29a941(0x15b)]&&_0x59de87)_0x59de87[_0x29a941(0x1bb)](_0x1d187c,'ANALYZE_HEALTH',{'digest':_0x4d3437});}catch(_0x4f7912){_0x1d187c['log'][_0x29a941(0x181)](_0x4f7912[_0x29a941(0x1c3)]);}}async function runBaselineDriftAnalysis(_0x44b9e5){const _0xb8e604=a0_0x1542ee;if(!_0x44b9e5['isProVersion']||!_0x44b9e5[_0xb8e604(0x155)])return;if(!canCallApi())return;const _0x12c60d=_0x44b9e5[_0xb8e604(0x164)][_0xb8e604(0x184)]||0xe;if(_0x44b9e5[_0xb8e604(0x158)][_0xb8e604(0x16c)]<_0x12c60d+0x7){await _0x44b9e5[_0xb8e604(0x1bf)](_0xb8e604(0x1cf),{'val':_0xb8e604(0x1a8),'ack':!![]});return;}const _0x5050de=_0x44b9e5[_0xb8e604(0x158)][_0xb8e604(0x1a5)](-_0x12c60d),_0x1ac5ce=_0x44b9e5[_0xb8e604(0x158)]['slice'](0x0,_0x44b9e5['dailyDigests']['length']-_0x12c60d),_0x3ee469=_0xb8e604(0x1c9)+JSON[_0xb8e604(0x18e)](_0x1ac5ce)+_0xb8e604(0x1a6)+JSON[_0xb8e604(0x18e)](_0x5050de);try{updateApiTimestamp();const _0x13bcee=await _0x44b9e5['geminiModel'][_0xb8e604(0x151)](_0x3ee469),_0x18dfe8=JSON[_0xb8e604(0x1be)](_0x13bcee[_0xb8e604(0x1d4)][_0xb8e604(0x189)]()[_0xb8e604(0x1b0)](/```json|```/g,'')[_0xb8e604(0x195)]());_0x18dfe8['baselineDrift']&&(await _0x44b9e5[_0xb8e604(0x1bf)]('LTM.driftAnalysis.baselineDrift',{'val':_0x18dfe8['baselineDrift'],'ack':!![]}),await _0x44b9e5['setStateAsync'](_0xb8e604(0x1c4),{'val':_0x18dfe8['driftDetails'],'ack':!![]}),await _0x44b9e5[_0xb8e604(0x1bf)](_0xb8e604(0x1aa),{'val':Date[_0xb8e604(0x1b5)](),'ack':!![]}));}catch(_0x173f48){}}function a0_0x1b4c(){const _0xe3eb9d=['\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','LTM.driftAnalysis.baselineDrift','./setup','aiPersona','KI\x20offline\x20(Fallback)','pop','response','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','generic','toISOString','analysis.analysisHistory','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','8SdosvO','.forecast.current.temperature','Nacht','automationProposal','4834450IjyWDu','livingContext','generateContent','sendNotification','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','\x0aAktivitÃ¤t:\x20','geminiModel','LTM.processingStatus','âš ï¸\x20ALARM:\x20','dailyDigests','LTM.rawEventLog','.forecast.current.state','isProVersion','getStateAsync','warn','.\x20KONTEXT:\x20','Unbekannt','\x20=\x20','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','debug','push','config','Sicherheit\x20geht\x20vor.','Skipped\x20(Traffic)','560192hRWfnB','unshift','toFixed','46oEjOWN','.Current.Temperature','length','Keine\x20Details.','analysis.automation.autoApply','decision','system.presenceWho','analysis.automation.targetValue','setForeignStateAsync','19887KyxPYI','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','activityLevel','models/gemini-flash-latest','reason','.Current.IsNight','alertReason','analysis.automation.targetId','ðŸŒ…\x20Morning\x20Briefing:\x0a','isAlert','ltmLtbWindowDays','splice','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','constructor','error','normal','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','ltmStbWindowDays','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','analysis.lastResult','val','BUTLER\x20Execution\x20Error:\x20','text','452810tdgNxJ','analysis.automation.patternDetected','Tag','480111mOFndF','stringify','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','apply','Started...','.\x20SYSTEM_MODE:\x20','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','trim','search','info','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}',',\x20Wetter:\x20','getForeignStateAsync','810pJoBWH','currentSystemMode','Digest','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20',',\x20LichtverhÃ¤ltnisse:\x20','exports','%)\x20nach\x20\x22','eventHistory','.\x20EMERGENCY:\x20','Briefing\x20Error:\x20','slice','\x0aSTB:\x20','useWeather','N/A\x20(Learning)','targetId','LTM.driftAnalysis.lastCheck','toString','Skipped\x20(No\x20AI\x20or\x20Data)','rawEventLog','detected','summary','replace','.Current.WeatherText','targetValue','analysisHistory','.\x20EVENTS:\x20','now','.\x20ANWESEND:\x20','799641XOqUbP','Â°C,\x20','timestamp','analysis.isAlert','send','weatherInstance','analysis.activitySummary','parse','setStateAsync','toLocaleTimeString','log','@google/generative-ai','message','LTM.driftAnalysis.driftDetails','Wetterdaten\x20nicht\x20abrufbar','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','\x20->\x20','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','3902tjmVdu','KI-Fehler\x20(Fallback)','Unbekannt\x20(Kein\x20Sensor)','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20'];a0_0x1b4c=function(){return _0xe3eb9d;};return a0_0x1b4c();}async function executeAutomationAction(_0x349166){const _0xc3d21d=a0_0x1542ee;try{const _0x458e8a=await _0x349166[_0xc3d21d(0x15c)](_0xc3d21d(0x17a)),_0x3d5707=await _0x349166[_0xc3d21d(0x15c)](_0xc3d21d(0x171));if(_0x458e8a&&_0x458e8a['val']&&_0x3d5707){const _0x3d3b2d=_0x458e8a['val'];let _0x471de3=_0x3d5707['val'];try{_0x471de3=JSON[_0xc3d21d(0x1be)](_0x471de3);}catch(_0x2372ed){}_0x349166['log'][_0xc3d21d(0x197)](_0xc3d21d(0x1c7)+_0x3d3b2d+_0xc3d21d(0x160)+_0x471de3),await _0x349166[_0xc3d21d(0x172)](_0x3d3b2d,_0x471de3);}else _0x349166[_0xc3d21d(0x1c1)][_0xc3d21d(0x15d)](_0xc3d21d(0x153));}catch(_0x13a48b){_0x349166[_0xc3d21d(0x1c1)][_0xc3d21d(0x181)](_0xc3d21d(0x188)+_0x13a48b[_0xc3d21d(0x1c3)]);}}async function sendMorningBriefing(_0x4486d7){const _0x36981c=a0_0x1542ee;if(!_0x4486d7[_0x36981c(0x155)])return;if(!canCallApi())return;try{updateApiTimestamp();const _0x34d2ee=_0x36981c(0x185),_0x5b54b1=await _0x4486d7[_0x36981c(0x155)]['generateContent'](_0x34d2ee),_0x5f0fc6=_0x5b54b1['response']['text']();setup['sendNotification'](_0x4486d7,_0x36981c(0x17b)+_0x5f0fc6);}catch(_0x12895f){_0x4486d7['log'][_0x36981c(0x181)](_0x36981c(0x1a4)+_0x12895f[_0x36981c(0x1c3)]);}}module[a0_0x1542ee(0x1a0)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler};