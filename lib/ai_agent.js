const a0_0x3bc197=a0_0x187c;(function(_0x26cda6,_0xb523ea){const _0x2ecede=a0_0x187c,_0x43bd19=_0x26cda6();while(!![]){try{const _0x2c848d=-parseInt(_0x2ecede(0x199))/0x1*(-parseInt(_0x2ecede(0x1a4))/0x2)+-parseInt(_0x2ecede(0x192))/0x3*(parseInt(_0x2ecede(0x17f))/0x4)+-parseInt(_0x2ecede(0x198))/0x5*(-parseInt(_0x2ecede(0x155))/0x6)+-parseInt(_0x2ecede(0x11f))/0x7*(parseInt(_0x2ecede(0x186))/0x8)+parseInt(_0x2ecede(0x164))/0x9+-parseInt(_0x2ecede(0x170))/0xa*(-parseInt(_0x2ecede(0x1a0))/0xb)+-parseInt(_0x2ecede(0x120))/0xc;if(_0x2c848d===_0xb523ea)break;else _0x43bd19['push'](_0x43bd19['shift']());}catch(_0x439d77){_0x43bd19['push'](_0x43bd19['shift']());}}}(a0_0x4aa0,0xe08cb));function a0_0x187c(_0x65b275,_0x304d7f){const _0x5b6d39=a0_0x4aa0();return a0_0x187c=function(_0x25b82c,_0x4fe3d1){_0x25b82c=_0x25b82c-0x10b;let _0x4aa0bb=_0x5b6d39[_0x25b82c];return _0x4aa0bb;},a0_0x187c(_0x65b275,_0x304d7f);}const a0_0x4fe3d1=(function(){let _0x5da93d=!![];return function(_0x1df75b,_0x34cbfe){const _0x17e5e4=_0x5da93d?function(){const _0x232243=a0_0x187c;if(_0x34cbfe){const _0x2f2c05=_0x34cbfe[_0x232243(0x189)](_0x1df75b,arguments);return _0x34cbfe=null,_0x2f2c05;}}:function(){};return _0x5da93d=![],_0x17e5e4;};}()),a0_0x25b82c=a0_0x4fe3d1(this,function(){const _0x56506d=a0_0x187c;return a0_0x25b82c[_0x56506d(0x175)]()[_0x56506d(0x153)](_0x56506d(0x112))[_0x56506d(0x175)]()['constructor'](a0_0x25b82c)[_0x56506d(0x153)](_0x56506d(0x112));});a0_0x25b82c();'use strict';const {GoogleGenerativeAI}=require('@google/generative-ai'),setup=require(a0_0x3bc197(0x18e)),GEMINI_MODEL=a0_0x3bc197(0x12d),LTM_DP_DAILY_DIGESTS=a0_0x3bc197(0x18d),LTM_DP_STATUS=a0_0x3bc197(0x1b0),LTM_DP_RAW_LOG=a0_0x3bc197(0x159),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;function a0_0x4aa0(){const _0x1e3248=['LTM.processingStatus','isAlert','LTM.driftAnalysis.driftDetails','Sicherheit\x20geht\x20vor.','value','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','decision','detected','generateContent','(((.+)+)+)+$','error','message','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','targetValue','Success','eventHistory','send','ü§ñ\x20Health\x20Report\x20(','filter','dailyDigests','Traffic-Schutz\x20(Auto-Approved)','151249nqjmqX','10608252JuJMiA','trim','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','Skipped\x20(No\x20AI\x20or\x20Data)','getStateAsync','ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','livingContext','sendNotification','pop','üìÖ\x20Daily\x20Digest:\x0a','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','getForeignStateAsync','splice','models/gemini-flash-latest','Unbekannt','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','currentSystemMode',')\x20generated.','analysis.automation.targetValue','setStateAsync','.\x20EMERGENCY:\x20','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','.forecast.current.state','Skipped\x20(Traffic)','Health\x20Report\x20Error:\x20','generic','debug','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','getDate','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Keine\x20Details.','warn','text','info','log','geminiModel','LTM.driftAnalysis.lastCheck','summary','analysis.health.geminiNight','stringify','KI-Fehler\x20(Fallback)','toFixed','useWeather','analysis.health.geminiDay','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','push','parse','analysisHistory','search','analysis.isAlert','3208176RewynE','Wetterdaten\x20nicht\x20abrufbar','alertReason','toLocaleTimeString','LTM.rawEventLog','analysis.automation.autoApply','rawEventLog','name','.forecast.current.temperature','Tag','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','approved','response','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','automationProposal','9929448AqxTwc','isProVersion','Started...',',\x20Lichtverh√§ltnisse:\x20','ü§ñ\x20Butler\x20Brain\x20Error:\x20','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','KI\x20offline\x20(Fallback)','system.presenceWho','reason','val','analysis.lastResult','2-digit','2460XrIRvt','analysis.analysisHistory','now','LTM.driftAnalysis.baselineDrift','config','toString','analysis.automation.targetId','slice','ANALYZE_HEALTH','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','Nacht','NIGHT','\x0a\x20\x20\x20\x20EVENTS:\x0a','getTime','baselineDrift','326588ZPdKqT','analysis.alertReason','.\x20ANWESEND:\x20','‚ö†Ô∏è\x20ALARM:\x20','analysis.automation.patternDetected','setDate','weatherInstance','672APeZzk','\x20->\x20','ltmLtbWindowDays','apply','analysis.activitySummary','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','driftDetails','LTM.dailyDigests','./setup','.Current.WeatherText','.\x20KONTEXT:\x20','üåÖ\x20Briefing\x20generated\x20(Length:\x20','6BewDwL','join','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','aiPersona','.Current.Temperature',').\x20Sending\x20notification...','5msEZDt','854827TAaMfP','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','setHours','activityLevel','replace','%)\x20nach\x20\x22','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','19426RJXknV','\x0aAktivit√§t:\x20','exports','\x20=\x20','4XklXQi','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','.\x20SYSTEM_MODE:\x20','normal','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','lastAlertState','Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.','Digest','timestamp','length','¬∞C,\x20'];a0_0x4aa0=function(){return _0x1e3248;};return a0_0x4aa0();}const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x3bc197(0x13d),'senior_aal':a0_0x3bc197(0x162),'family':a0_0x3bc197(0x135),'single_comfort':a0_0x3bc197(0x179),'security':a0_0x3bc197(0x10c),'energy_saver':a0_0x3bc197(0x14e)};function canCallApi(){const _0x83aad0=Date['now']();return _0x83aad0-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){lastGlobalApiCall=Date['now']();}async function getWeatherContext(_0x10b459){const _0x3d5de6=a0_0x3bc197;if(!_0x10b459['config'][_0x3d5de6(0x14c)]||!_0x10b459[_0x3d5de6(0x174)][_0x3d5de6(0x185)])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x377f0a=_0x10b459[_0x3d5de6(0x174)][_0x3d5de6(0x185)];let _0x2ade82=await _0x10b459[_0x3d5de6(0x12b)](_0x377f0a+_0x3d5de6(0x196));if(!_0x2ade82)_0x2ade82=await _0x10b459[_0x3d5de6(0x12b)](_0x377f0a+_0x3d5de6(0x15d));let _0xae63c6=await _0x10b459['getForeignStateAsync'](_0x377f0a+_0x3d5de6(0x18f));if(!_0xae63c6)_0xae63c6=await _0x10b459['getForeignStateAsync'](_0x377f0a+_0x3d5de6(0x138));let _0x39f5c9=_0x3d5de6(0x12e);const _0x3517ba=await _0x10b459[_0x3d5de6(0x12b)](_0x377f0a+'.Current.IsNight');if(_0x3517ba)_0x39f5c9=_0x3517ba[_0x3d5de6(0x16d)]?_0x3d5de6(0x17a):_0x3d5de6(0x15e);if(_0x2ade82&&_0xae63c6)return _0x2ade82['val']+_0x3d5de6(0x1af)+_0xae63c6[_0x3d5de6(0x16d)]+_0x3d5de6(0x167)+_0x39f5c9;}catch(_0x27c5a3){}return _0x3d5de6(0x156);}async function consultButler(_0x1dd2c8,_0xaa2395,_0x4e101e,_0x351e75){const _0x5257c9=a0_0x3bc197;if(!_0x1dd2c8[_0x5257c9(0x145)])return{'approved':!![],'reason':_0x5257c9(0x16a)};const _0x3bd17e=Date[_0x5257c9(0x172)]();if(decisionCache[_0xaa2395]&&_0x3bd17e-decisionCache[_0xaa2395][_0x5257c9(0x1ad)]<CACHE_TTL_MS){const _0x37c0fe=decisionCache[_0xaa2395][_0x5257c9(0x10f)];return _0x1dd2c8[_0x5257c9(0x144)]['debug'](_0x5257c9(0x15f)+_0xaa2395+_0x5257c9(0x187)+(_0x37c0fe[_0x5257c9(0x160)]?'OK':'NO')+'\x20('+_0x37c0fe[_0x5257c9(0x16c)]+')'),_0x37c0fe;}if(!canCallApi())return _0x1dd2c8['log']['debug'](_0x5257c9(0x19f)+_0xaa2395+'\x20√ºbersprungen\x20(Auto-Approved).'),{'approved':!![],'reason':_0x5257c9(0x11e)};const _0x70960b=new Date()[_0x5257c9(0x158)](),_0x250616=await getWeatherContext(_0x1dd2c8),_0x155fbc=PERSONA_MAPPING[_0x1dd2c8['config'][_0x5257c9(0x195)]||_0x5257c9(0x13b)],_0x29f152=_0x5257c9(0x12f)+_0x70960b+',\x20Wetter:\x20'+_0x250616+_0x5257c9(0x1a9)+(_0x351e75*0x64)[_0x5257c9(0x14b)](0x0)+_0x5257c9(0x19e)+_0xaa2395+_0x5257c9(0x116)+_0x4e101e+_0x5257c9(0x1a6)+_0x155fbc+_0x5257c9(0x194);try{updateApiTimestamp();const _0x4de135=await _0x1dd2c8[_0x5257c9(0x145)][_0x5257c9(0x111)](_0x29f152),_0x441b69=_0x4de135['response'][_0x5257c9(0x142)]()[_0x5257c9(0x19d)](/```json|```/g,'')['trim'](),_0x5a81bc=JSON[_0x5257c9(0x151)](_0x441b69);return decisionCache[_0xaa2395]={'decision':_0x5a81bc,'timestamp':_0x3bd17e},_0x5a81bc;}catch(_0x438e2d){return _0x1dd2c8[_0x5257c9(0x144)][_0x5257c9(0x141)](_0x5257c9(0x168)+_0x438e2d['message']),decisionCache[_0xaa2395]={'decision':{'approved':!![],'reason':_0x5257c9(0x14a)},'timestamp':_0x3bd17e-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x5257c9(0x14a)};}}async function runGeminiAnalysis(_0x6c7556,_0x2d702b=''){const _0x249f00=a0_0x3bc197;if(!_0x6c7556[_0x249f00(0x145)])return;if(!canCallApi()){_0x6c7556[_0x249f00(0x144)][_0x249f00(0x13c)]('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x6c7556[_0x249f00(0x119)][_0x249f00(0x1ae)]===0x0)return;const _0xd51097=_0x6c7556[_0x249f00(0x119)][_0x249f00(0x177)](0x0,0xf),_0x29eb37=_0x6c7556[_0x249f00(0x130)],_0x5b5008=PERSONA_MAPPING[_0x6c7556[_0x249f00(0x174)][_0x249f00(0x195)]||_0x249f00(0x13b)],_0x5cac05=_0x6c7556[_0x249f00(0x174)][_0x249f00(0x126)]||_0x249f00(0x140);let _0x50db9a=_0x249f00(0x12e);try{const _0x2a23c3=await _0x6c7556[_0x249f00(0x124)](_0x249f00(0x16b));if(_0x2a23c3&&_0x2a23c3[_0x249f00(0x16d)])_0x50db9a=_0x2a23c3[_0x249f00(0x16d)];}catch(_0x232ad0){}let _0x49d0dd=![];try{const _0x286fb1=await _0x6c7556[_0x249f00(0x124)](_0x249f00(0x15a));if(_0x286fb1&&_0x286fb1[_0x249f00(0x16d)])_0x49d0dd=!![];}catch(_0x2d2984){}const _0x4fc6bd='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x5b5008+_0x249f00(0x190)+_0x5cac05+_0x249f00(0x1a7)+_0x29eb37+_0x249f00(0x181)+_0x50db9a+'.\x20EVENTS:\x20'+JSON[_0x249f00(0x149)](_0xd51097)+_0x249f00(0x134)+_0x2d702b+_0x249f00(0x1a5);try{updateApiTimestamp();const _0x202724=await _0x6c7556[_0x249f00(0x145)]['generateContent'](_0x4fc6bd),_0x476a4f=JSON[_0x249f00(0x151)](_0x202724[_0x249f00(0x161)][_0x249f00(0x142)]()['replace'](/```json|```/g,'')[_0x249f00(0x121)]());await _0x6c7556['setStateAsync'](_0x249f00(0x16e),{'val':JSON['stringify'](_0x476a4f),'ack':!![]});if(_0x476a4f[_0x249f00(0x147)])await _0x6c7556[_0x249f00(0x133)](_0x249f00(0x18a),{'val':_0x476a4f[_0x249f00(0x147)],'ack':!![]});const _0x5a2375={'timestamp':Date[_0x249f00(0x172)](),'id':Date[_0x249f00(0x172)]()[_0x249f00(0x175)](),'analysis':{'activity':{'summary':_0x476a4f[_0x249f00(0x147)],'isAlert':_0x476a4f[_0x249f00(0x1b1)],'alertReason':_0x476a4f[_0x249f00(0x157)]},'comfort':{'automationProposal':_0x476a4f[_0x249f00(0x163)]}}};_0x6c7556[_0x249f00(0x152)]['unshift'](_0x5a2375);if(_0x6c7556[_0x249f00(0x152)][_0x249f00(0x1ae)]>0x32)_0x6c7556[_0x249f00(0x152)][_0x249f00(0x128)]();await _0x6c7556[_0x249f00(0x133)](_0x249f00(0x171),{'val':JSON[_0x249f00(0x149)](_0x6c7556['analysisHistory']),'ack':!![]});const _0x4fdccf=_0x476a4f[_0x249f00(0x1b1)]||![];_0x4fdccf!==_0x6c7556[_0x249f00(0x1aa)]&&(await _0x6c7556[_0x249f00(0x133)](_0x249f00(0x154),{'val':_0x4fdccf,'ack':!![]}),_0x6c7556[_0x249f00(0x1aa)]=_0x4fdccf,_0x4fdccf&&(await _0x6c7556['setStateAsync'](_0x249f00(0x180),{'val':_0x476a4f['alertReason'],'ack':!![]}),setup[_0x249f00(0x127)](_0x6c7556,_0x249f00(0x182)+_0x476a4f[_0x249f00(0x157)],![],_0x476a4f['isEmergency'])));if(_0x476a4f[_0x249f00(0x163)]&&_0x476a4f[_0x249f00(0x163)][_0x249f00(0x110)]){await _0x6c7556[_0x249f00(0x133)](_0x249f00(0x183),{'val':!![],'ack':!![]}),await _0x6c7556['setStateAsync']('analysis.automation.description',{'val':_0x476a4f['automationProposal']['description'],'ack':!![]}),await _0x6c7556[_0x249f00(0x133)](_0x249f00(0x176),{'val':_0x476a4f[_0x249f00(0x163)]['targetId'],'ack':!![]}),await _0x6c7556[_0x249f00(0x133)](_0x249f00(0x132),{'val':JSON[_0x249f00(0x149)](_0x476a4f[_0x249f00(0x163)][_0x249f00(0x117)]),'ack':!![]});if(_0x49d0dd)executeAutomationAction(_0x6c7556);}}catch(_0xd4b2f1){_0x6c7556[_0x249f00(0x144)][_0x249f00(0x113)]('Gemini\x20Error:\x20'+_0xd4b2f1['message']);}}async function createDailyDigest(_0x400f0e,_0x4c4d41){const _0x327754=a0_0x3bc197;if(!_0x400f0e['isProVersion'])return;if(!canCallApi()){await _0x400f0e['setStateAsync'](LTM_DP_STATUS,{'val':_0x327754(0x139),'ack':!![]});return;}await _0x400f0e['setStateAsync'](LTM_DP_STATUS,{'val':_0x327754(0x166),'ack':!![]});if(!_0x400f0e[_0x327754(0x145)]||_0x400f0e['rawEventLog'][_0x327754(0x1ae)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x400f0e[_0x327754(0x133)](LTM_DP_STATUS,{'val':_0x327754(0x123),'ack':!![]});return;}const _0x55bcd4=JSON[_0x327754(0x151)](JSON[_0x327754(0x149)](_0x400f0e[_0x327754(0x15b)])),_0x52abf9=_0x55bcd4[_0x327754(0x1ae)],_0x2d1f98=_0x327754(0x12a)+JSON[_0x327754(0x149)](_0x55bcd4);try{updateApiTimestamp();const _0x390276=await _0x400f0e[_0x327754(0x145)][_0x327754(0x111)](_0x2d1f98),_0x32f7ce=JSON[_0x327754(0x151)](_0x390276[_0x327754(0x161)][_0x327754(0x142)]()[_0x327754(0x19d)](/```json|```/g,'')[_0x327754(0x121)]()),_0x3d6900={'timestamp':new Date()['toISOString'](),'eventCount':_0x52abf9,'summary':_0x32f7ce[_0x327754(0x147)]||_0x327754(0x1ac),'activityLevel':_0x32f7ce[_0x327754(0x19c)]||_0x327754(0x1a8),'systemMode':_0x400f0e[_0x327754(0x130)]};_0x400f0e[_0x327754(0x11d)][_0x327754(0x150)](_0x3d6900);const _0x49ad92=_0x400f0e[_0x327754(0x174)][_0x327754(0x188)]||0x3c;_0x400f0e[_0x327754(0x11d)][_0x327754(0x1ae)]>_0x49ad92&&_0x400f0e[_0x327754(0x11d)][_0x327754(0x12c)](0x0,_0x400f0e[_0x327754(0x11d)][_0x327754(0x1ae)]-_0x49ad92);await _0x400f0e[_0x327754(0x133)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x400f0e['dailyDigests']),'ack':!![]}),_0x400f0e[_0x327754(0x15b)]=[],await _0x400f0e[_0x327754(0x133)](LTM_DP_RAW_LOG,{'val':JSON[_0x327754(0x149)](_0x400f0e[_0x327754(0x15b)]),'ack':!![]}),await _0x400f0e[_0x327754(0x133)](LTM_DP_STATUS,{'val':_0x327754(0x118),'ack':!![]});const _0x4d5fc2=_0x327754(0x129)+_0x32f7ce['summary']+_0x327754(0x1a1)+_0x32f7ce[_0x327754(0x19c)];setup['sendNotification'](_0x400f0e,_0x4d5fc2,![],![]);if(_0x400f0e[_0x327754(0x165)]&&_0x4c4d41)_0x4c4d41[_0x327754(0x11a)](_0x400f0e,_0x327754(0x178),{'digest':_0x3d6900});}catch(_0x55d8f3){_0x400f0e[_0x327754(0x144)][_0x327754(0x113)](_0x55d8f3[_0x327754(0x114)]);}}async function runBaselineDriftAnalysis(_0x54d136){const _0x1994f7=a0_0x3bc197;if(!_0x54d136['isProVersion']||!_0x54d136[_0x1994f7(0x145)])return;if(!canCallApi())return;const _0x3466b8=_0x54d136[_0x1994f7(0x174)]['ltmStbWindowDays']||0xe;if(_0x54d136[_0x1994f7(0x11d)][_0x1994f7(0x1ae)]<_0x3466b8+0x7){await _0x54d136[_0x1994f7(0x133)](_0x1994f7(0x173),{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x47f607=_0x54d136[_0x1994f7(0x11d)][_0x1994f7(0x177)](-_0x3466b8),_0x6e4d24=_0x54d136['dailyDigests'][_0x1994f7(0x177)](0x0,_0x54d136[_0x1994f7(0x11d)]['length']-_0x3466b8),_0x3793a0=_0x1994f7(0x19a)+JSON[_0x1994f7(0x149)](_0x6e4d24)+'\x0aSTB:\x20'+JSON[_0x1994f7(0x149)](_0x47f607);try{updateApiTimestamp();const _0x1bbcb9=await _0x54d136[_0x1994f7(0x145)]['generateContent'](_0x3793a0),_0x44a708=JSON[_0x1994f7(0x151)](_0x1bbcb9[_0x1994f7(0x161)][_0x1994f7(0x142)]()['replace'](/```json|```/g,'')[_0x1994f7(0x121)]());_0x44a708[_0x1994f7(0x17e)]&&(await _0x54d136[_0x1994f7(0x133)](_0x1994f7(0x173),{'val':_0x44a708[_0x1994f7(0x17e)],'ack':!![]}),await _0x54d136[_0x1994f7(0x133)](_0x1994f7(0x10b),{'val':_0x44a708[_0x1994f7(0x18c)],'ack':!![]}),await _0x54d136[_0x1994f7(0x133)](_0x1994f7(0x146),{'val':Date[_0x1994f7(0x172)](),'ack':!![]}));}catch(_0x160075){}}async function executeAutomationAction(_0x34ba74){const _0x3e6353=a0_0x3bc197;try{const _0x251361=await _0x34ba74[_0x3e6353(0x124)]('analysis.automation.targetId'),_0x4c6737=await _0x34ba74[_0x3e6353(0x124)](_0x3e6353(0x132));if(_0x251361&&_0x251361[_0x3e6353(0x16d)]&&_0x4c6737){const _0x33be73=_0x251361[_0x3e6353(0x16d)];let _0x53b9d4=_0x4c6737[_0x3e6353(0x16d)];try{_0x53b9d4=JSON[_0x3e6353(0x151)](_0x53b9d4);}catch(_0x3f63ab){}_0x34ba74['log'][_0x3e6353(0x143)](_0x3e6353(0x10e)+_0x33be73+_0x3e6353(0x1a3)+_0x53b9d4),await _0x34ba74['setForeignStateAsync'](_0x33be73,_0x53b9d4);}else _0x34ba74[_0x3e6353(0x144)][_0x3e6353(0x141)](_0x3e6353(0x13f));}catch(_0x1b6cfb){_0x34ba74[_0x3e6353(0x144)][_0x3e6353(0x113)]('BUTLER\x20Execution\x20Error:\x20'+_0x1b6cfb[_0x3e6353(0x114)]);}}async function sendMorningBriefing(_0x4de798){const _0x56fec5=a0_0x3bc197;if(!_0x4de798[_0x56fec5(0x145)]){_0x4de798[_0x56fec5(0x144)][_0x56fec5(0x141)](_0x56fec5(0x125));return;}_0x4de798[_0x56fec5(0x144)][_0x56fec5(0x143)](_0x56fec5(0x18b));try{updateApiTimestamp();const _0x57ddcf=_0x56fec5(0x14f),_0x4dfe57=await _0x4de798[_0x56fec5(0x145)][_0x56fec5(0x111)](_0x57ddcf),_0x209189=_0x4dfe57[_0x56fec5(0x161)][_0x56fec5(0x142)]();_0x4de798[_0x56fec5(0x144)][_0x56fec5(0x143)](_0x56fec5(0x191)+_0x209189[_0x56fec5(0x1ae)]+_0x56fec5(0x197)),setup[_0x56fec5(0x127)](_0x4de798,'üåÖ\x20Morning\x20Briefing:\x0a'+_0x209189);}catch(_0x4ce271){_0x4de798['log'][_0x56fec5(0x113)]('Briefing\x20Error:\x20'+_0x4ce271['message']);}}async function generateHealthReport(_0x1837aa,_0x535d5c){const _0x1c738e=a0_0x3bc197;if(!_0x1837aa[_0x1c738e(0x145)])return;const _0x3e9fbe=Date['now']();_0x3e9fbe-lastGlobalApiCall<0xbb8&&(_0x1837aa[_0x1c738e(0x144)][_0x1c738e(0x13c)](_0x1c738e(0x115)),await new Promise(_0x12e574=>setTimeout(_0x12e574,0x7d0)));const _0x1eb21d=new Date();let _0x2de217=0x0,_0x3413c9=_0x1eb21d[_0x1c738e(0x17d)](),_0x144e03='';if(_0x535d5c===_0x1c738e(0x17b)){const _0x128376=new Date(_0x1eb21d);_0x128376[_0x1c738e(0x184)](_0x128376[_0x1c738e(0x13e)]()-0x1),_0x128376['setHours'](0x16,0x0,0x0,0x0),_0x2de217=_0x128376['getTime']();const _0x1e4ffc=new Date(_0x1eb21d);_0x1e4ffc[_0x1c738e(0x19b)](0x8,0x0,0x0,0x0),_0x3413c9=_0x1e4ffc['getTime'](),_0x144e03=_0x1c738e(0x122);}else{const _0xef5e7a=new Date(_0x1eb21d);_0xef5e7a['setHours'](0x8,0x0,0x0,0x0),_0x2de217=_0xef5e7a[_0x1c738e(0x17d)](),_0x144e03=_0x1c738e(0x137);}const _0x293bad=_0x1837aa[_0x1c738e(0x119)][_0x1c738e(0x11c)](_0x514834=>_0x514834[_0x1c738e(0x1ad)]>=_0x2de217&&_0x514834[_0x1c738e(0x1ad)]<=_0x3413c9);if(_0x293bad[_0x1c738e(0x1ae)]===0x0){const _0x13f7a9=_0x535d5c==='NIGHT'?_0x1c738e(0x136):_0x1c738e(0x1ab),_0x4ad4e8=_0x535d5c===_0x1c738e(0x17b)?_0x1c738e(0x148):_0x1c738e(0x14d);await _0x1837aa[_0x1c738e(0x133)](_0x4ad4e8,{'val':_0x13f7a9,'ack':!![]});return;}const _0xc7a9b9=_0x293bad['map'](_0x3799cc=>new Date(_0x3799cc[_0x1c738e(0x1ad)])[_0x1c738e(0x158)]([],{'hour':_0x1c738e(0x16f),'minute':'2-digit'})+'\x20'+_0x3799cc[_0x1c738e(0x15c)]+'\x20('+_0x3799cc[_0x1c738e(0x10d)]+')')[_0x1c738e(0x193)]('\x0a'),_0x142beb=_0x1c738e(0x169)+_0x144e03+_0x1c738e(0x17c)+_0xc7a9b9+'\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x3a6ba1=await _0x1837aa[_0x1c738e(0x145)][_0x1c738e(0x111)](_0x142beb),_0x2ca0e4=_0x3a6ba1['response'][_0x1c738e(0x142)](),_0x951857=_0x535d5c===_0x1c738e(0x17b)?_0x1c738e(0x148):_0x1c738e(0x14d);await _0x1837aa[_0x1c738e(0x133)](_0x951857,{'val':_0x2ca0e4,'ack':!![]}),_0x1837aa[_0x1c738e(0x144)][_0x1c738e(0x143)](_0x1c738e(0x11b)+_0x535d5c+_0x1c738e(0x131));}catch(_0x67c948){_0x1837aa[_0x1c738e(0x144)][_0x1c738e(0x113)](_0x1c738e(0x13a)+_0x67c948[_0x1c738e(0x114)]);}}module[a0_0x3bc197(0x1a2)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};