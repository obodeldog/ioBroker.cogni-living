const a0_0x2a0417=a0_0x2ead;(function(_0x5319a6,_0x4a7da2){const _0x2c011a=a0_0x2ead,_0x96c603=_0x5319a6();while(!![]){try{const _0x290b14=-parseInt(_0x2c011a(0x187))/0x1*(parseInt(_0x2c011a(0x1b5))/0x2)+-parseInt(_0x2c011a(0x1e3))/0x3*(parseInt(_0x2c011a(0x16c))/0x4)+-parseInt(_0x2c011a(0x1ef))/0x5+parseInt(_0x2c011a(0x1c7))/0x6*(parseInt(_0x2c011a(0x19a))/0x7)+parseInt(_0x2c011a(0x19d))/0x8+parseInt(_0x2c011a(0x19b))/0x9*(-parseInt(_0x2c011a(0x1b3))/0xa)+parseInt(_0x2c011a(0x174))/0xb*(parseInt(_0x2c011a(0x18b))/0xc);if(_0x290b14===_0x4a7da2)break;else _0x96c603['push'](_0x96c603['shift']());}catch(_0x568df8){_0x96c603['push'](_0x96c603['shift']());}}}(a0_0x3f79,0xdccf4));const a0_0x1f88aa=(function(){let _0x328e40=!![];return function(_0xe076a6,_0x5e0f96){const _0x2cd880=_0x328e40?function(){const _0x33adc1=a0_0x2ead;if(_0x5e0f96){const _0xfa91e8=_0x5e0f96[_0x33adc1(0x15d)](_0xe076a6,arguments);return _0x5e0f96=null,_0xfa91e8;}}:function(){};return _0x328e40=![],_0x2cd880;};}()),a0_0x177c1d=a0_0x1f88aa(this,function(){const _0x5a179d=a0_0x2ead;return a0_0x177c1d[_0x5a179d(0x1ba)]()[_0x5a179d(0x170)](_0x5a179d(0x18f))[_0x5a179d(0x1ba)]()[_0x5a179d(0x169)](a0_0x177c1d)[_0x5a179d(0x170)](_0x5a179d(0x18f));});a0_0x177c1d();'use strict';const {GoogleGenerativeAI}=require(a0_0x2a0417(0x1c6)),setup=require(a0_0x2a0417(0x1a9)),GEMINI_MODEL=a0_0x2a0417(0x1df),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS='LTM.processingStatus',LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x2a0417(0x16b),'senior_aal':a0_0x2a0417(0x178),'family':a0_0x2a0417(0x1b0),'single_comfort':'Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','security':a0_0x2a0417(0x173),'energy_saver':a0_0x2a0417(0x1d3)};function canCallApi(){const _0x4a992a=a0_0x2a0417,_0x4fc8a5=Date[_0x4a992a(0x1c5)]();return _0x4fc8a5-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x2092cf=a0_0x2a0417;lastGlobalApiCall=Date[_0x2092cf(0x1c5)]();}async function getWeatherContext(_0x36777d){const _0x4bbee3=a0_0x2a0417;if(!_0x36777d[_0x4bbee3(0x199)][_0x4bbee3(0x167)]||!_0x36777d[_0x4bbee3(0x199)][_0x4bbee3(0x1ca)])return _0x4bbee3(0x1b2);try{const _0x30b6fb=_0x36777d[_0x4bbee3(0x199)][_0x4bbee3(0x1ca)];let _0x3c215c=await _0x36777d['getForeignStateAsync'](_0x30b6fb+_0x4bbee3(0x15e));if(!_0x3c215c)_0x3c215c=await _0x36777d['getForeignStateAsync'](_0x30b6fb+_0x4bbee3(0x1ec));let _0x1f9010=await _0x36777d[_0x4bbee3(0x1d2)](_0x30b6fb+_0x4bbee3(0x1d6));if(!_0x1f9010)_0x1f9010=await _0x36777d[_0x4bbee3(0x1d2)](_0x30b6fb+'.forecast.current.state');let _0x5bbf52=_0x4bbee3(0x1e9);const _0x359e91=await _0x36777d[_0x4bbee3(0x1d2)](_0x30b6fb+_0x4bbee3(0x198));if(_0x359e91)_0x5bbf52=_0x359e91[_0x4bbee3(0x15f)]?_0x4bbee3(0x1db):_0x4bbee3(0x16e);if(_0x3c215c&&_0x1f9010)return _0x3c215c[_0x4bbee3(0x15f)]+'Â°C,\x20'+_0x1f9010[_0x4bbee3(0x15f)]+',\x20LichtverhÃ¤ltnisse:\x20'+_0x5bbf52;}catch(_0x51777e){}return _0x4bbee3(0x1a0);}async function consultButler(_0x50bb8f,_0x123b57,_0x23f8c1,_0x2b30b4){const _0x4b14df=a0_0x2a0417;if(!_0x50bb8f[_0x4b14df(0x17a)])return{'approved':!![],'reason':'KI\x20offline\x20(Fallback)'};const _0x503fec=Date[_0x4b14df(0x1c5)]();if(decisionCache[_0x123b57]&&_0x503fec-decisionCache[_0x123b57][_0x4b14df(0x176)]<CACHE_TTL_MS){const _0x2fc152=decisionCache[_0x123b57]['decision'];return _0x50bb8f[_0x4b14df(0x1bc)][_0x4b14df(0x1d9)](_0x4b14df(0x1f4)+_0x123b57+'\x20->\x20'+(_0x2fc152[_0x4b14df(0x1bd)]?'OK':'NO')+'\x20('+_0x2fc152[_0x4b14df(0x1f2)]+')'),_0x2fc152;}if(!canCallApi())return _0x50bb8f[_0x4b14df(0x1bc)][_0x4b14df(0x1d9)](_0x4b14df(0x1e6)+_0x123b57+_0x4b14df(0x1d1)),{'approved':!![],'reason':_0x4b14df(0x1c9)};const _0x447aa4=new Date()[_0x4b14df(0x172)](),_0x1a25f6=await getWeatherContext(_0x50bb8f),_0x27e58f=PERSONA_MAPPING[_0x50bb8f[_0x4b14df(0x199)][_0x4b14df(0x175)]||_0x4b14df(0x1c2)],_0x45eb50=_0x4b14df(0x1b8)+_0x447aa4+_0x4b14df(0x1b1)+_0x1a25f6+_0x4b14df(0x18d)+(_0x2b30b4*0x64)[_0x4b14df(0x1d7)](0x0)+'%)\x20nach\x20\x22'+_0x123b57+_0x4b14df(0x1d8)+_0x23f8c1+_0x4b14df(0x197)+_0x27e58f+'\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0xfe3545=await _0x50bb8f['geminiModel']['generateContent'](_0x45eb50),_0x39da89=_0xfe3545[_0x4b14df(0x179)][_0x4b14df(0x1cb)]()[_0x4b14df(0x1bf)](/```json|```/g,'')[_0x4b14df(0x19c)](),_0xdd90d5=JSON['parse'](_0x39da89);return decisionCache[_0x123b57]={'decision':_0xdd90d5,'timestamp':_0x503fec},_0xdd90d5;}catch(_0x5af203){return _0x50bb8f[_0x4b14df(0x1bc)]['warn']('ðŸ¤–\x20Butler\x20Brain\x20Error:\x20'+_0x5af203[_0x4b14df(0x1a3)]),decisionCache[_0x123b57]={'decision':{'approved':!![],'reason':_0x4b14df(0x18a)},'timestamp':_0x503fec-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x4b14df(0x18a)};}}function a0_0x3f79(){const _0x219378=['\x20Ã¼bersprungen\x20(Auto-Approved).','getForeignStateAsync','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','dailyDigests','system.presenceWho','.Current.WeatherText','toFixed','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','debug','pop','Nacht','analysis.automation.autoApply','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','lastAlertState','models/gemini-flash-latest','analysisHistory','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','227391pfiRmC','2-digit','.\x20ANWESEND:\x20','ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20','rawEventLog','warn','Unbekannt','getStateAsync','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','.forecast.current.temperature','N/A\x20(Learning)','stringify','384430zTqGEr','ltmLtbWindowDays','alertReason','reason','Health\x20Report\x20Error:\x20','ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','apply','.Current.Temperature','val','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','push','LTM.driftAnalysis.baselineDrift','analysis.automation.targetId',').\x20Sending\x20notification...','\x0aAktivitÃ¤t:\x20','.\x20EMERGENCY:\x20','useWeather','driftDetails','constructor','isProVersion','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','60bMnxOd','LTM.driftAnalysis.lastCheck','Tag','.\x20EVENTS:\x20','search','analysis.lastResult','toLocaleTimeString','Sicherheit\x20geht\x20vor.','407fZjGih','aiPersona','timestamp','ANALYZE_HEALTH','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','response','geminiModel','detected','length','NIGHT','parse','filter','Skipped\x20(Traffic)','currentSystemMode','slice','generateContent','exports','info','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','8403ZGPgoS','baselineDrift','analysis.health.geminiDay','KI-Fehler\x20(Fallback)','647148hVtIhy','name','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','.\x20SYSTEM_MODE:\x20','(((.+)+)+)+$','\x0a\x20\x20\x20\x20EVENTS:\x0a','automationProposal','send','summary','ðŸŒ…\x20Morning\x20Briefing:\x0a','analysis.automation.targetValue','eventHistory','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','.Current.IsNight','config','56dtxVEM','1800054QDZjbG','trim','9679992CYViDX','ðŸ¤–\x20Health\x20Report\x20(','analysis.isAlert','Wetterdaten\x20nicht\x20abrufbar','map','ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','message','\x0aSTB:\x20','LTM.driftAnalysis.driftDetails','targetId','livingContext','ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...','./setup','analysis.analysisHistory','splice','setForeignStateAsync','setHours','setStateAsync',')\x20generated.','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.',',\x20Wetter:\x20','Unbekannt\x20(Kein\x20Sensor)','80IjXNis','getTime','74VeXTvu','Keine\x20Details.','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','error','toString','analysis.health.geminiNight','log','approved','join','replace','ltmStbWindowDays','âš ï¸\x20ALARM:\x20','generic','analysis.automation.patternDetected','analysis.automation.description','now','@google/generative-ai','617898cyrpAr','Success','Traffic-Schutz\x20(Auto-Approved)','weatherInstance','text','sendNotification','targetValue','Gemini\x20Error:\x20','isAlert','setDate'];a0_0x3f79=function(){return _0x219378;};return a0_0x3f79();}async function runGeminiAnalysis(_0x475e4d,_0x52c941=''){const _0x3f821d=a0_0x2a0417;if(!_0x475e4d[_0x3f821d(0x17a)])return;if(!canCallApi()){_0x475e4d['log']['debug'](_0x3f821d(0x1a2));return;}if(_0x475e4d[_0x3f821d(0x196)]['length']===0x0)return;const _0x570176=_0x475e4d[_0x3f821d(0x196)][_0x3f821d(0x182)](0x0,0xf),_0x2f9d1d=_0x475e4d[_0x3f821d(0x181)],_0x5d3f6a=PERSONA_MAPPING[_0x475e4d[_0x3f821d(0x199)][_0x3f821d(0x175)]||_0x3f821d(0x1c2)],_0x38f30c=_0x475e4d[_0x3f821d(0x199)][_0x3f821d(0x1a7)]||_0x3f821d(0x1b6);let _0x3de525=_0x3f821d(0x1e9);try{const _0x49ef98=await _0x475e4d[_0x3f821d(0x1ea)](_0x3f821d(0x1d5));if(_0x49ef98&&_0x49ef98['val'])_0x3de525=_0x49ef98[_0x3f821d(0x15f)];}catch(_0x1e805b){}let _0x4a3bbb=![];try{const _0x5e1b9b=await _0x475e4d[_0x3f821d(0x1ea)](_0x3f821d(0x1dc));if(_0x5e1b9b&&_0x5e1b9b[_0x3f821d(0x15f)])_0x4a3bbb=!![];}catch(_0x5ec087){}const _0x1d9fd6=_0x3f821d(0x1eb)+_0x5d3f6a+'.\x20KONTEXT:\x20'+_0x38f30c+_0x3f821d(0x18e)+_0x2f9d1d+_0x3f821d(0x1e5)+_0x3de525+_0x3f821d(0x16f)+JSON[_0x3f821d(0x1ee)](_0x570176)+_0x3f821d(0x166)+_0x52c941+_0x3f821d(0x1f5);try{updateApiTimestamp();const _0x3ed225=await _0x475e4d[_0x3f821d(0x17a)][_0x3f821d(0x183)](_0x1d9fd6),_0x25644d=JSON[_0x3f821d(0x17e)](_0x3ed225[_0x3f821d(0x179)][_0x3f821d(0x1cb)]()[_0x3f821d(0x1bf)](/```json|```/g,'')[_0x3f821d(0x19c)]());await _0x475e4d['setStateAsync'](_0x3f821d(0x171),{'val':JSON[_0x3f821d(0x1ee)](_0x25644d),'ack':!![]});if(_0x25644d[_0x3f821d(0x193)])await _0x475e4d['setStateAsync']('analysis.activitySummary',{'val':_0x25644d[_0x3f821d(0x193)],'ack':!![]});const _0xe88efc={'timestamp':Date['now'](),'id':Date[_0x3f821d(0x1c5)]()['toString'](),'analysis':{'activity':{'summary':_0x25644d[_0x3f821d(0x193)],'isAlert':_0x25644d[_0x3f821d(0x1cf)],'alertReason':_0x25644d[_0x3f821d(0x1f1)]},'comfort':{'automationProposal':_0x25644d[_0x3f821d(0x191)]}}};_0x475e4d[_0x3f821d(0x1e0)]['unshift'](_0xe88efc);if(_0x475e4d['analysisHistory']['length']>0x32)_0x475e4d[_0x3f821d(0x1e0)][_0x3f821d(0x1da)]();await _0x475e4d[_0x3f821d(0x1ae)](_0x3f821d(0x1aa),{'val':JSON['stringify'](_0x475e4d['analysisHistory']),'ack':!![]});const _0x2f2a88=_0x25644d[_0x3f821d(0x1cf)]||![];_0x2f2a88!==_0x475e4d[_0x3f821d(0x1de)]&&(await _0x475e4d[_0x3f821d(0x1ae)](_0x3f821d(0x19f),{'val':_0x2f2a88,'ack':!![]}),_0x475e4d[_0x3f821d(0x1de)]=_0x2f2a88,_0x2f2a88&&(await _0x475e4d['setStateAsync']('analysis.alertReason',{'val':_0x25644d['alertReason'],'ack':!![]}),setup[_0x3f821d(0x1cc)](_0x475e4d,_0x3f821d(0x1c1)+_0x25644d[_0x3f821d(0x1f1)],![],_0x25644d['isEmergency'])));if(_0x25644d[_0x3f821d(0x191)]&&_0x25644d[_0x3f821d(0x191)][_0x3f821d(0x17b)]){await _0x475e4d[_0x3f821d(0x1ae)](_0x3f821d(0x1c3),{'val':!![],'ack':!![]}),await _0x475e4d['setStateAsync'](_0x3f821d(0x1c4),{'val':_0x25644d[_0x3f821d(0x191)]['description'],'ack':!![]}),await _0x475e4d[_0x3f821d(0x1ae)](_0x3f821d(0x163),{'val':_0x25644d[_0x3f821d(0x191)][_0x3f821d(0x1a6)],'ack':!![]}),await _0x475e4d[_0x3f821d(0x1ae)](_0x3f821d(0x195),{'val':JSON['stringify'](_0x25644d[_0x3f821d(0x191)][_0x3f821d(0x1cd)]),'ack':!![]});if(_0x4a3bbb)executeAutomationAction(_0x475e4d);}}catch(_0x518534){_0x475e4d['log']['error'](_0x3f821d(0x1ce)+_0x518534[_0x3f821d(0x1a3)]);}}async function createDailyDigest(_0x397864,_0x2116ae){const _0x1ed41f=a0_0x2a0417;if(!_0x397864[_0x1ed41f(0x16a)])return;if(!canCallApi()){await _0x397864[_0x1ed41f(0x1ae)](LTM_DP_STATUS,{'val':_0x1ed41f(0x180),'ack':!![]});return;}await _0x397864[_0x1ed41f(0x1ae)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x397864[_0x1ed41f(0x17a)]||_0x397864[_0x1ed41f(0x1e7)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x397864[_0x1ed41f(0x1ae)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x828862=JSON[_0x1ed41f(0x17e)](JSON['stringify'](_0x397864[_0x1ed41f(0x1e7)])),_0x1f6bba=_0x828862[_0x1ed41f(0x17c)],_0x4ef344=_0x1ed41f(0x1e1)+JSON[_0x1ed41f(0x1ee)](_0x828862);try{updateApiTimestamp();const _0x18e3c0=await _0x397864[_0x1ed41f(0x17a)][_0x1ed41f(0x183)](_0x4ef344),_0x183cef=JSON['parse'](_0x18e3c0[_0x1ed41f(0x179)][_0x1ed41f(0x1cb)]()[_0x1ed41f(0x1bf)](/```json|```/g,'')[_0x1ed41f(0x19c)]()),_0x55502d={'timestamp':new Date()['toISOString'](),'eventCount':_0x1f6bba,'summary':_0x183cef['summary']||'Digest','activityLevel':_0x183cef['activityLevel']||'normal','systemMode':_0x397864[_0x1ed41f(0x181)]};_0x397864[_0x1ed41f(0x1d4)][_0x1ed41f(0x161)](_0x55502d);const _0x1d8e06=_0x397864[_0x1ed41f(0x199)][_0x1ed41f(0x1f0)]||0x3c;_0x397864[_0x1ed41f(0x1d4)][_0x1ed41f(0x17c)]>_0x1d8e06&&_0x397864[_0x1ed41f(0x1d4)][_0x1ed41f(0x1ab)](0x0,_0x397864[_0x1ed41f(0x1d4)][_0x1ed41f(0x17c)]-_0x1d8e06);await _0x397864[_0x1ed41f(0x1ae)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x397864[_0x1ed41f(0x1d4)]),'ack':!![]}),_0x397864['rawEventLog']=[],await _0x397864['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x1ed41f(0x1ee)](_0x397864[_0x1ed41f(0x1e7)]),'ack':!![]}),await _0x397864[_0x1ed41f(0x1ae)](LTM_DP_STATUS,{'val':_0x1ed41f(0x1c8),'ack':!![]});const _0x14778a='ðŸ“…\x20Daily\x20Digest:\x0a'+_0x183cef[_0x1ed41f(0x193)]+_0x1ed41f(0x165)+_0x183cef['activityLevel'];setup[_0x1ed41f(0x1cc)](_0x397864,_0x14778a,![],![]);if(_0x397864[_0x1ed41f(0x16a)]&&_0x2116ae)_0x2116ae[_0x1ed41f(0x192)](_0x397864,_0x1ed41f(0x177),{'digest':_0x55502d});}catch(_0x4459be){_0x397864[_0x1ed41f(0x1bc)][_0x1ed41f(0x1b9)](_0x4459be[_0x1ed41f(0x1a3)]);}}async function runBaselineDriftAnalysis(_0x31536){const _0x1f9610=a0_0x2a0417;if(!_0x31536[_0x1f9610(0x16a)]||!_0x31536[_0x1f9610(0x17a)])return;if(!canCallApi())return;const _0x16f44a=_0x31536[_0x1f9610(0x199)][_0x1f9610(0x1c0)]||0xe;if(_0x31536['dailyDigests'][_0x1f9610(0x17c)]<_0x16f44a+0x7){await _0x31536[_0x1f9610(0x1ae)](_0x1f9610(0x162),{'val':_0x1f9610(0x1ed),'ack':!![]});return;}const _0x3c601e=_0x31536[_0x1f9610(0x1d4)][_0x1f9610(0x182)](-_0x16f44a),_0x21c42d=_0x31536[_0x1f9610(0x1d4)][_0x1f9610(0x182)](0x0,_0x31536['dailyDigests'][_0x1f9610(0x17c)]-_0x16f44a),_0xd9f87=_0x1f9610(0x1b7)+JSON[_0x1f9610(0x1ee)](_0x21c42d)+_0x1f9610(0x1a4)+JSON[_0x1f9610(0x1ee)](_0x3c601e);try{updateApiTimestamp();const _0x3306f0=await _0x31536[_0x1f9610(0x17a)][_0x1f9610(0x183)](_0xd9f87),_0x18ff78=JSON[_0x1f9610(0x17e)](_0x3306f0[_0x1f9610(0x179)][_0x1f9610(0x1cb)]()[_0x1f9610(0x1bf)](/```json|```/g,'')[_0x1f9610(0x19c)]());_0x18ff78['baselineDrift']&&(await _0x31536[_0x1f9610(0x1ae)](_0x1f9610(0x162),{'val':_0x18ff78[_0x1f9610(0x188)],'ack':!![]}),await _0x31536[_0x1f9610(0x1ae)](_0x1f9610(0x1a5),{'val':_0x18ff78[_0x1f9610(0x168)],'ack':!![]}),await _0x31536[_0x1f9610(0x1ae)](_0x1f9610(0x16d),{'val':Date[_0x1f9610(0x1c5)](),'ack':!![]}));}catch(_0x463cd1){}}async function executeAutomationAction(_0x7e6d12){const _0x387300=a0_0x2a0417;try{const _0xb247bc=await _0x7e6d12['getStateAsync'](_0x387300(0x163)),_0x1b5547=await _0x7e6d12[_0x387300(0x1ea)](_0x387300(0x195));if(_0xb247bc&&_0xb247bc[_0x387300(0x15f)]&&_0x1b5547){const _0x4510bc=_0xb247bc['val'];let _0x241436=_0x1b5547[_0x387300(0x15f)];try{_0x241436=JSON['parse'](_0x241436);}catch(_0x59fd31){}_0x7e6d12[_0x387300(0x1bc)][_0x387300(0x185)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x4510bc+'\x20=\x20'+_0x241436),await _0x7e6d12[_0x387300(0x1ac)](_0x4510bc,_0x241436);}else _0x7e6d12[_0x387300(0x1bc)][_0x387300(0x1e8)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x30522a){_0x7e6d12[_0x387300(0x1bc)][_0x387300(0x1b9)]('BUTLER\x20Execution\x20Error:\x20'+_0x30522a[_0x387300(0x1a3)]);}}async function sendMorningBriefing(_0x52f342){const _0x4368c2=a0_0x2a0417;if(!_0x52f342[_0x4368c2(0x17a)]){_0x52f342[_0x4368c2(0x1bc)][_0x4368c2(0x1e8)](_0x4368c2(0x186));return;}_0x52f342[_0x4368c2(0x1bc)]['info']('ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x328aa0='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x2bf9c6=await _0x52f342['geminiModel'][_0x4368c2(0x183)](_0x328aa0),_0x8f8bb8=_0x2bf9c6['response']['text']();_0x52f342['log']['info']('ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20'+_0x8f8bb8[_0x4368c2(0x17c)]+_0x4368c2(0x164)),setup[_0x4368c2(0x1cc)](_0x52f342,_0x4368c2(0x194)+_0x8f8bb8);}catch(_0x195cfb){_0x52f342[_0x4368c2(0x1bc)]['error']('Briefing\x20Error:\x20'+_0x195cfb[_0x4368c2(0x1a3)]);}}async function generateHealthReport(_0x35b3c5,_0x19abf9){const _0x48e9bf=a0_0x2a0417;if(!_0x35b3c5['geminiModel'])return;const _0x4f9a23=Date['now']();_0x4f9a23-lastGlobalApiCall<0xbb8&&(_0x35b3c5[_0x48e9bf(0x1bc)][_0x48e9bf(0x1d9)](_0x48e9bf(0x1a8)),await new Promise(_0x1d81d1=>setTimeout(_0x1d81d1,0x7d0)));const _0x1cd711=new Date();let _0x55106e=0x0,_0x430ca7=_0x1cd711[_0x48e9bf(0x1b4)](),_0x3f7578='';if(_0x19abf9==='NIGHT'){const _0x6463c4=new Date(_0x1cd711);_0x6463c4[_0x48e9bf(0x1d0)](_0x6463c4['getDate']()-0x1),_0x6463c4[_0x48e9bf(0x1ad)](0x16,0x0,0x0,0x0),_0x55106e=_0x6463c4[_0x48e9bf(0x1b4)]();const _0x2ec6cc=new Date(_0x1cd711);_0x2ec6cc[_0x48e9bf(0x1ad)](0x8,0x0,0x0,0x0),_0x430ca7=_0x2ec6cc['getTime'](),_0x3f7578=_0x48e9bf(0x160);}else{const _0x51cc93=new Date(_0x1cd711);_0x51cc93[_0x48e9bf(0x1ad)](0x8,0x0,0x0,0x0),_0x55106e=_0x51cc93[_0x48e9bf(0x1b4)](),_0x3f7578=_0x48e9bf(0x1e2);}const _0x3dd60b=_0x35b3c5['eventHistory'][_0x48e9bf(0x17f)](_0x7ed5ff=>_0x7ed5ff['timestamp']>=_0x55106e&&_0x7ed5ff[_0x48e9bf(0x176)]<=_0x430ca7);if(_0x3dd60b[_0x48e9bf(0x17c)]===0x0){const _0x2049ed=_0x19abf9===_0x48e9bf(0x17d)?_0x48e9bf(0x1dd):'Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.',_0x2bd787=_0x19abf9===_0x48e9bf(0x17d)?_0x48e9bf(0x1bb):_0x48e9bf(0x189);await _0x35b3c5[_0x48e9bf(0x1ae)](_0x2bd787,{'val':_0x2049ed,'ack':!![]});return;}const _0x2057d6=_0x3dd60b[_0x48e9bf(0x1a1)](_0x1b811a=>new Date(_0x1b811a[_0x48e9bf(0x176)])['toLocaleTimeString']([],{'hour':_0x48e9bf(0x1e4),'minute':_0x48e9bf(0x1e4)})+'\x20'+_0x1b811a[_0x48e9bf(0x18c)]+'\x20('+_0x1b811a['value']+')')[_0x48e9bf(0x1be)]('\x0a'),_0x193ff0='\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20'+_0x3f7578+_0x48e9bf(0x190)+_0x2057d6+'\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x3ddb20=await _0x35b3c5[_0x48e9bf(0x17a)][_0x48e9bf(0x183)](_0x193ff0),_0x4fbd87=_0x3ddb20[_0x48e9bf(0x179)][_0x48e9bf(0x1cb)](),_0x138233=_0x19abf9==='NIGHT'?'analysis.health.geminiNight':_0x48e9bf(0x189);await _0x35b3c5[_0x48e9bf(0x1ae)](_0x138233,{'val':_0x4fbd87,'ack':!![]}),_0x35b3c5[_0x48e9bf(0x1bc)][_0x48e9bf(0x185)](_0x48e9bf(0x19e)+_0x19abf9+_0x48e9bf(0x1af));}catch(_0x30c5e2){_0x35b3c5[_0x48e9bf(0x1bc)][_0x48e9bf(0x1b9)](_0x48e9bf(0x1f3)+_0x30c5e2[_0x48e9bf(0x1a3)]);}}function a0_0x2ead(_0x3f9389,_0x419414){const _0x368b3c=a0_0x3f79();return a0_0x2ead=function(_0x177c1d,_0x1f88aa){_0x177c1d=_0x177c1d-0x15d;let _0x3f79cd=_0x368b3c[_0x177c1d];return _0x3f79cd;},a0_0x2ead(_0x3f9389,_0x419414);}module[a0_0x2a0417(0x184)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};