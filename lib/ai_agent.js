const a0_0x5aee60=a0_0x4034;(function(_0x131882,_0x17c349){const _0x1fd62b=a0_0x4034,_0x1fb144=_0x131882();while(!![]){try{const _0x5060e5=-parseInt(_0x1fd62b(0x190))/0x1+-parseInt(_0x1fd62b(0x135))/0x2*(parseInt(_0x1fd62b(0x1a9))/0x3)+-parseInt(_0x1fd62b(0x12f))/0x4+parseInt(_0x1fd62b(0x16e))/0x5*(-parseInt(_0x1fd62b(0x172))/0x6)+-parseInt(_0x1fd62b(0x181))/0x7*(-parseInt(_0x1fd62b(0x14f))/0x8)+-parseInt(_0x1fd62b(0x1bc))/0x9+parseInt(_0x1fd62b(0x18c))/0xa;if(_0x5060e5===_0x17c349)break;else _0x1fb144['push'](_0x1fb144['shift']());}catch(_0x492589){_0x1fb144['push'](_0x1fb144['shift']());}}}(a0_0x33d9,0x74970));const a0_0x50ad6f=(function(){let _0x450c21=!![];return function(_0x4c5e55,_0xd28892){const _0xac7354=_0x450c21?function(){const _0x34e725=a0_0x4034;if(_0xd28892){const _0x12d5e0=_0xd28892[_0x34e725(0x18f)](_0x4c5e55,arguments);return _0xd28892=null,_0x12d5e0;}}:function(){};return _0x450c21=![],_0xac7354;};}()),a0_0x488047=a0_0x50ad6f(this,function(){const _0x43c7d5=a0_0x4034;return a0_0x488047[_0x43c7d5(0x185)]()[_0x43c7d5(0x122)](_0x43c7d5(0x130))[_0x43c7d5(0x185)]()[_0x43c7d5(0x15a)](a0_0x488047)[_0x43c7d5(0x122)]('(((.+)+)+)+$');});a0_0x488047();'use strict';const {GoogleGenerativeAI}=require(a0_0x5aee60(0x161)),setup=require(a0_0x5aee60(0x1a7)),GEMINI_MODEL=a0_0x5aee60(0x1af),LTM_DP_DAILY_DIGESTS=a0_0x5aee60(0x1b1),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_RAW_LOG=a0_0x5aee60(0x19f),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':'Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','senior_aal':a0_0x5aee60(0x145),'family':a0_0x5aee60(0x19d),'single_comfort':a0_0x5aee60(0x13f),'security':a0_0x5aee60(0x142),'energy_saver':a0_0x5aee60(0x18d)};function canCallApi(){const _0x19c2f7=Date['now']();return _0x19c2f7-lastGlobalApiCall>MIN_API_GAP_MS;}function a0_0x33d9(){const _0x2507da=['Success','reason','PRIORITÃ„T:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','setDate','Keine\x20Details.','Skipped\x20(No\x20AI\x20or\x20Data)','lastAlertState','analysis.alertReason','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','join','generateContent','LTM.driftAnalysis.lastCheck','5392MqUqnJ','ðŸŒ…\x20Briefing\x20generated\x20(Length:\x20','Keine\x20Daten\x20fÃ¼r\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','.Current.WeatherText','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','analysisHistory','alertReason','send','%)\x20nach\x20\x22','N/A\x20(Learning)','constructor','baselineDrift','val','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20fÃ¼r\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','toLocaleTimeString','toISOString','sendNotification','@google/generative-ai','analysis.automation.autoApply','config','analysis.activitySummary','map','driftDetails','dailyDigests','slice','toFixed','filter','weatherInstance','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20fÃ¼r\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','5auYmln','push','KI\x20offline\x20(Fallback)','eventHistory','2325630wVZDEo','response','exports','getTime','Traffic-Schutz\x20(Auto-Approved)','LTM.driftAnalysis.baselineDrift','targetId','.\x20EMERGENCY:\x20','aiPersona','ðŸŒ…\x20Morning\x20Briefing:\x0a','approved','setHours','analysis.analysisHistory','log','timestamp','4564iHKoyO','pop',')\x20generated.','decision','toString','NIGHT','error','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20BadgÃ¤nge?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','targetValue','\x0aAktivitÃ¤t:\x20','generic','29873840GsDWJP','PRIORITÃ„T:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','rawEventLog','apply','836557rEzkAg','ðŸ¤–\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.','detected','Digest','text','livingContext','analysis.isAlert','message','Gemini\x20Error:\x20','value','âš ï¸\x20ALARM:\x20','ANALYZE_HEALTH','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20prÃ¤zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','Fokus\x20auf\x20Komfort\x20fÃ¼r\x20die\x20Familie.','.forecast.current.state','LTM.rawEventLog','getStateAsync','splice','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','getForeignStateAsync','isProVersion','.forecast.current.temperature','Â°C,\x20','./setup',',\x20Wetter:\x20','6gvMiih','ðŸ¤–\x20Health\x20Report\x20(','analysis.automation.targetValue','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Nacht','ðŸ¤–\x20Butler\x20Brain\x20Error:\x20','models/gemini-flash-latest','\x20->\x20','LTM.dailyDigests','2-digit','.Current.Temperature','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20AktivitÃ¤t?\x20Mahlzeiten?\x20HaustÃ¼r?\x20Antwort\x20kurz\x20fÃ¼r\x20den\x20besorgten\x20Sohn\x20(max\x202\x20SÃ¤tze).','trim','length','\x0a\x20\x20\x20\x20EVENTS:\x0a','getDate','BUTLER\x20Execution\x20Error:\x20','system.presenceWho','.\x20KONTEXT:\x20','3535164XifuFl','analysis.automation.targetId','useWeather','summary','ðŸŒ…\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','Skipped\x20(Traffic)','stringify','Briefing\x20Error:\x20','analysis.health.geminiDay','analysis.automation.description','search','normal','debug','Unbekannt','activityLevel','analysis.automation.patternDetected','Tag','isAlert','parse','currentSystemMode','automationProposal','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','ltmStbWindowDays','3169888OCXqXD','(((.+)+)+)+$','geminiModel','\x20Ã¼bersprungen\x20(Auto-Approved).','isEmergency','.Current.IsNight','539850gNzPlq','replace','KI-Fehler\x20(Fallback)','info','analysis.health.geminiNight','setStateAsync','name','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20',').\x20Sending\x20notification...','warn','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','now','ðŸ“…\x20Daily\x20Digest:\x0a','Sicherheit\x20geht\x20vor.'];a0_0x33d9=function(){return _0x2507da;};return a0_0x33d9();}function updateApiTimestamp(){const _0x54097b=a0_0x5aee60;lastGlobalApiCall=Date[_0x54097b(0x140)]();}async function getWeatherContext(_0x576e7b){const _0x3927fb=a0_0x5aee60;if(!_0x576e7b[_0x3927fb(0x163)][_0x3927fb(0x1be)]||!_0x576e7b[_0x3927fb(0x163)][_0x3927fb(0x16b)])return'Unbekannt\x20(Kein\x20Sensor)';try{const _0x3f3bb1=_0x576e7b['config'][_0x3927fb(0x16b)];let _0x1c5d0c=await _0x576e7b['getForeignStateAsync'](_0x3f3bb1+_0x3927fb(0x1b3));if(!_0x1c5d0c)_0x1c5d0c=await _0x576e7b[_0x3927fb(0x1a3)](_0x3f3bb1+_0x3927fb(0x1a5));let _0x1e5fc3=await _0x576e7b['getForeignStateAsync'](_0x3f3bb1+_0x3927fb(0x153));if(!_0x1e5fc3)_0x1e5fc3=await _0x576e7b[_0x3927fb(0x1a3)](_0x3f3bb1+_0x3927fb(0x19e));let _0x271012=_0x3927fb(0x125);const _0x6e5d8f=await _0x576e7b[_0x3927fb(0x1a3)](_0x3f3bb1+_0x3927fb(0x134));if(_0x6e5d8f)_0x271012=_0x6e5d8f[_0x3927fb(0x15c)]?_0x3927fb(0x1ad):_0x3927fb(0x128);if(_0x1c5d0c&&_0x1e5fc3)return _0x1c5d0c['val']+_0x3927fb(0x1a6)+_0x1e5fc3[_0x3927fb(0x15c)]+',\x20LichtverhÃ¤ltnisse:\x20'+_0x271012;}catch(_0x4c9bfc){}return'Wetterdaten\x20nicht\x20abrufbar';}function a0_0x4034(_0x574e30,_0x1014f3){const _0x428c53=a0_0x33d9();return a0_0x4034=function(_0x488047,_0x50ad6f){_0x488047=_0x488047-0x11b;let _0x33d9ce=_0x428c53[_0x488047];return _0x33d9ce;},a0_0x4034(_0x574e30,_0x1014f3);}async function consultButler(_0x349033,_0x47407c,_0x45561a,_0x41d4dd){const _0x3df843=a0_0x5aee60;if(!_0x349033[_0x3df843(0x131)])return{'approved':!![],'reason':_0x3df843(0x170)};const _0x3287d8=Date[_0x3df843(0x140)]();if(decisionCache[_0x47407c]&&_0x3287d8-decisionCache[_0x47407c]['timestamp']<CACHE_TTL_MS){const _0x267fb3=decisionCache[_0x47407c][_0x3df843(0x184)];return _0x349033[_0x3df843(0x17f)][_0x3df843(0x124)]('ðŸ¤–\x20Butler\x20Cache\x20Hit:\x20'+_0x47407c+_0x3df843(0x1b0)+(_0x267fb3[_0x3df843(0x17c)]?'OK':'NO')+'\x20('+_0x267fb3[_0x3df843(0x144)]+')'),_0x267fb3;}if(!canCallApi())return _0x349033[_0x3df843(0x17f)]['debug']('ðŸ¤–\x20Traffic\x20Schutz:\x20Anfrage\x20fÃ¼r\x20'+_0x47407c+_0x3df843(0x132)),{'approved':!![],'reason':_0x3df843(0x176)};const _0x1750cd=new Date()['toLocaleTimeString'](),_0x1cf738=await getWeatherContext(_0x349033),_0x1d6374=PERSONA_MAPPING[_0x349033[_0x3df843(0x163)][_0x3df843(0x17a)]||_0x3df843(0x18b)],_0x6ce54=_0x3df843(0x154)+_0x1750cd+_0x3df843(0x1a8)+_0x1cf738+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x41d4dd*0x64)[_0x3df843(0x169)](0x0)+_0x3df843(0x158)+_0x47407c+_0x3df843(0x1a2)+_0x45561a+_0x3df843(0x152)+_0x1d6374+_0x3df843(0x16c);try{updateApiTimestamp();const _0x29ef15=await _0x349033['geminiModel'][_0x3df843(0x14d)](_0x6ce54),_0x4f83da=_0x29ef15[_0x3df843(0x173)][_0x3df843(0x194)]()[_0x3df843(0x136)](/```json|```/g,'')['trim'](),_0x3c1f5d=JSON[_0x3df843(0x12a)](_0x4f83da);return decisionCache[_0x47407c]={'decision':_0x3c1f5d,'timestamp':_0x3287d8},_0x3c1f5d;}catch(_0x28ddaa){return _0x349033[_0x3df843(0x17f)][_0x3df843(0x13e)](_0x3df843(0x1ae)+_0x28ddaa[_0x3df843(0x197)]),decisionCache[_0x47407c]={'decision':{'approved':!![],'reason':_0x3df843(0x137)},'timestamp':_0x3287d8-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x3df843(0x137)};}}async function runGeminiAnalysis(_0x2e12e3,_0x3e4afe=''){const _0x181498=a0_0x5aee60;if(!_0x2e12e3['geminiModel'])return;if(!canCallApi()){_0x2e12e3['log'][_0x181498(0x124)]('ðŸ¤–\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x2e12e3[_0x181498(0x171)][_0x181498(0x1b6)]===0x0)return;const _0x3d532a=_0x2e12e3[_0x181498(0x171)][_0x181498(0x168)](0x0,0xf),_0x489dad=_0x2e12e3['currentSystemMode'],_0x5f19fc=PERSONA_MAPPING[_0x2e12e3[_0x181498(0x163)]['aiPersona']||_0x181498(0x18b)],_0x3a80e8=_0x2e12e3['config'][_0x181498(0x195)]||_0x181498(0x147);let _0x319eb5=_0x181498(0x125);try{const _0x1531a4=await _0x2e12e3['getStateAsync'](_0x181498(0x1ba));if(_0x1531a4&&_0x1531a4[_0x181498(0x15c)])_0x319eb5=_0x1531a4[_0x181498(0x15c)];}catch(_0x3763d4){}let _0x4f8e6e=![];try{const _0xa23ab1=await _0x2e12e3[_0x181498(0x1a0)](_0x181498(0x162));if(_0xa23ab1&&_0xa23ab1[_0x181498(0x15c)])_0x4f8e6e=!![];}catch(_0x52b7db){}const _0x3831d3=_0x181498(0x12d)+_0x5f19fc+_0x181498(0x1bb)+_0x3a80e8+'.\x20SYSTEM_MODE:\x20'+_0x489dad+'.\x20ANWESEND:\x20'+_0x319eb5+'.\x20EVENTS:\x20'+JSON[_0x181498(0x11e)](_0x3d532a)+_0x181498(0x179)+_0x3e4afe+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x66781c=await _0x2e12e3[_0x181498(0x131)][_0x181498(0x14d)](_0x3831d3),_0xe16b1d=JSON[_0x181498(0x12a)](_0x66781c[_0x181498(0x173)][_0x181498(0x194)]()['replace'](/```json|```/g,'')[_0x181498(0x1b5)]());await _0x2e12e3[_0x181498(0x13a)]('analysis.lastResult',{'val':JSON['stringify'](_0xe16b1d),'ack':!![]});if(_0xe16b1d[_0x181498(0x11b)])await _0x2e12e3[_0x181498(0x13a)](_0x181498(0x164),{'val':_0xe16b1d[_0x181498(0x11b)],'ack':!![]});const _0x246bdf={'timestamp':Date[_0x181498(0x140)](),'id':Date[_0x181498(0x140)]()[_0x181498(0x185)](),'analysis':{'activity':{'summary':_0xe16b1d['summary'],'isAlert':_0xe16b1d['isAlert'],'alertReason':_0xe16b1d[_0x181498(0x156)]},'comfort':{'automationProposal':_0xe16b1d[_0x181498(0x12c)]}}};_0x2e12e3[_0x181498(0x155)]['unshift'](_0x246bdf);if(_0x2e12e3[_0x181498(0x155)][_0x181498(0x1b6)]>0x32)_0x2e12e3['analysisHistory'][_0x181498(0x182)]();await _0x2e12e3[_0x181498(0x13a)](_0x181498(0x17e),{'val':JSON[_0x181498(0x11e)](_0x2e12e3['analysisHistory']),'ack':!![]});const _0x33cb9d=_0xe16b1d[_0x181498(0x129)]||![];_0x33cb9d!==_0x2e12e3[_0x181498(0x149)]&&(await _0x2e12e3[_0x181498(0x13a)](_0x181498(0x196),{'val':_0x33cb9d,'ack':!![]}),_0x2e12e3[_0x181498(0x149)]=_0x33cb9d,_0x33cb9d&&(await _0x2e12e3[_0x181498(0x13a)](_0x181498(0x14a),{'val':_0xe16b1d[_0x181498(0x156)],'ack':!![]}),setup[_0x181498(0x160)](_0x2e12e3,_0x181498(0x19a)+_0xe16b1d[_0x181498(0x156)],![],_0xe16b1d[_0x181498(0x133)])));if(_0xe16b1d[_0x181498(0x12c)]&&_0xe16b1d[_0x181498(0x12c)][_0x181498(0x192)]){await _0x2e12e3[_0x181498(0x13a)](_0x181498(0x127),{'val':!![],'ack':!![]}),await _0x2e12e3[_0x181498(0x13a)](_0x181498(0x121),{'val':_0xe16b1d[_0x181498(0x12c)]['description'],'ack':!![]}),await _0x2e12e3[_0x181498(0x13a)]('analysis.automation.targetId',{'val':_0xe16b1d[_0x181498(0x12c)][_0x181498(0x178)],'ack':!![]}),await _0x2e12e3['setStateAsync'](_0x181498(0x1ab),{'val':JSON[_0x181498(0x11e)](_0xe16b1d[_0x181498(0x12c)][_0x181498(0x189)]),'ack':!![]});if(_0x4f8e6e)executeAutomationAction(_0x2e12e3);}}catch(_0x308603){_0x2e12e3[_0x181498(0x17f)][_0x181498(0x187)](_0x181498(0x198)+_0x308603['message']);}}async function createDailyDigest(_0x1ca99e,_0x3743a7){const _0x27a2b8=a0_0x5aee60;if(!_0x1ca99e[_0x27a2b8(0x1a4)])return;if(!canCallApi()){await _0x1ca99e['setStateAsync'](LTM_DP_STATUS,{'val':_0x27a2b8(0x11d),'ack':!![]});return;}await _0x1ca99e[_0x27a2b8(0x13a)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x1ca99e[_0x27a2b8(0x131)]||_0x1ca99e[_0x27a2b8(0x18e)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1ca99e['setStateAsync'](LTM_DP_STATUS,{'val':_0x27a2b8(0x148),'ack':!![]});return;}const _0x5c0532=JSON[_0x27a2b8(0x12a)](JSON[_0x27a2b8(0x11e)](_0x1ca99e['rawEventLog'])),_0x447864=_0x5c0532['length'],_0x154f79='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x27a2b8(0x11e)](_0x5c0532);try{updateApiTimestamp();const _0x523505=await _0x1ca99e[_0x27a2b8(0x131)][_0x27a2b8(0x14d)](_0x154f79),_0x1658e8=JSON[_0x27a2b8(0x12a)](_0x523505[_0x27a2b8(0x173)][_0x27a2b8(0x194)]()[_0x27a2b8(0x136)](/```json|```/g,'')[_0x27a2b8(0x1b5)]()),_0x4ce8e9={'timestamp':new Date()[_0x27a2b8(0x15f)](),'eventCount':_0x447864,'summary':_0x1658e8[_0x27a2b8(0x11b)]||_0x27a2b8(0x193),'activityLevel':_0x1658e8[_0x27a2b8(0x126)]||_0x27a2b8(0x123),'systemMode':_0x1ca99e[_0x27a2b8(0x12b)]};_0x1ca99e[_0x27a2b8(0x167)][_0x27a2b8(0x16f)](_0x4ce8e9);const _0x53f3a7=_0x1ca99e[_0x27a2b8(0x163)]['ltmLtbWindowDays']||0x3c;_0x1ca99e[_0x27a2b8(0x167)]['length']>_0x53f3a7&&_0x1ca99e[_0x27a2b8(0x167)][_0x27a2b8(0x1a1)](0x0,_0x1ca99e[_0x27a2b8(0x167)][_0x27a2b8(0x1b6)]-_0x53f3a7);await _0x1ca99e[_0x27a2b8(0x13a)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x27a2b8(0x11e)](_0x1ca99e[_0x27a2b8(0x167)]),'ack':!![]}),_0x1ca99e[_0x27a2b8(0x18e)]=[],await _0x1ca99e[_0x27a2b8(0x13a)](LTM_DP_RAW_LOG,{'val':JSON[_0x27a2b8(0x11e)](_0x1ca99e[_0x27a2b8(0x18e)]),'ack':!![]}),await _0x1ca99e[_0x27a2b8(0x13a)](LTM_DP_STATUS,{'val':_0x27a2b8(0x143),'ack':!![]});const _0x390d16=_0x27a2b8(0x141)+_0x1658e8[_0x27a2b8(0x11b)]+_0x27a2b8(0x18a)+_0x1658e8[_0x27a2b8(0x126)];setup[_0x27a2b8(0x160)](_0x1ca99e,_0x390d16,![],![]);if(_0x1ca99e['isProVersion']&&_0x3743a7)_0x3743a7[_0x27a2b8(0x157)](_0x1ca99e,_0x27a2b8(0x19b),{'digest':_0x4ce8e9});}catch(_0x3af97f){_0x1ca99e[_0x27a2b8(0x17f)][_0x27a2b8(0x187)](_0x3af97f[_0x27a2b8(0x197)]);}}async function runBaselineDriftAnalysis(_0x1b7a31){const _0x1ebced=a0_0x5aee60;if(!_0x1b7a31[_0x1ebced(0x1a4)]||!_0x1b7a31[_0x1ebced(0x131)])return;if(!canCallApi())return;const _0xab805c=_0x1b7a31[_0x1ebced(0x163)][_0x1ebced(0x12e)]||0xe;if(_0x1b7a31[_0x1ebced(0x167)][_0x1ebced(0x1b6)]<_0xab805c+0x7){await _0x1b7a31[_0x1ebced(0x13a)](_0x1ebced(0x177),{'val':_0x1ebced(0x159),'ack':!![]});return;}const _0x479998=_0x1b7a31[_0x1ebced(0x167)]['slice'](-_0xab805c),_0x3771a1=_0x1b7a31['dailyDigests'][_0x1ebced(0x168)](0x0,_0x1b7a31[_0x1ebced(0x167)][_0x1ebced(0x1b6)]-_0xab805c),_0x320012=_0x1ebced(0x14b)+JSON[_0x1ebced(0x11e)](_0x3771a1)+'\x0aSTB:\x20'+JSON[_0x1ebced(0x11e)](_0x479998);try{updateApiTimestamp();const _0xca15c4=await _0x1b7a31['geminiModel'][_0x1ebced(0x14d)](_0x320012),_0xe2a07=JSON[_0x1ebced(0x12a)](_0xca15c4['response'][_0x1ebced(0x194)]()[_0x1ebced(0x136)](/```json|```/g,'')['trim']());_0xe2a07['baselineDrift']&&(await _0x1b7a31[_0x1ebced(0x13a)](_0x1ebced(0x177),{'val':_0xe2a07[_0x1ebced(0x15b)],'ack':!![]}),await _0x1b7a31[_0x1ebced(0x13a)]('LTM.driftAnalysis.driftDetails',{'val':_0xe2a07[_0x1ebced(0x166)],'ack':!![]}),await _0x1b7a31[_0x1ebced(0x13a)](_0x1ebced(0x14e),{'val':Date[_0x1ebced(0x140)](),'ack':!![]}));}catch(_0x5945a7){}}async function executeAutomationAction(_0x25be08){const _0x4e2be7=a0_0x5aee60;try{const _0x359127=await _0x25be08['getStateAsync'](_0x4e2be7(0x1bd)),_0x183aec=await _0x25be08[_0x4e2be7(0x1a0)](_0x4e2be7(0x1ab));if(_0x359127&&_0x359127[_0x4e2be7(0x15c)]&&_0x183aec){const _0x9d59bb=_0x359127[_0x4e2be7(0x15c)];let _0x2bad17=_0x183aec[_0x4e2be7(0x15c)];try{_0x2bad17=JSON[_0x4e2be7(0x12a)](_0x2bad17);}catch(_0x49a60f){}_0x25be08[_0x4e2be7(0x17f)]['info'](_0x4e2be7(0x13c)+_0x9d59bb+'\x20=\x20'+_0x2bad17),await _0x25be08['setForeignStateAsync'](_0x9d59bb,_0x2bad17);}else _0x25be08[_0x4e2be7(0x17f)][_0x4e2be7(0x13e)](_0x4e2be7(0x1ac));}catch(_0xa01441){_0x25be08[_0x4e2be7(0x17f)][_0x4e2be7(0x187)](_0x4e2be7(0x1b9)+_0xa01441['message']);}}async function sendMorningBriefing(_0x27b717){const _0x1a7d65=a0_0x5aee60;if(!_0x27b717[_0x1a7d65(0x131)]){_0x27b717[_0x1a7d65(0x17f)][_0x1a7d65(0x13e)](_0x1a7d65(0x191));return;}_0x27b717[_0x1a7d65(0x17f)][_0x1a7d65(0x138)](_0x1a7d65(0x11c));try{updateApiTimestamp();const _0x485fe2=_0x1a7d65(0x16d),_0x2d8204=await _0x27b717[_0x1a7d65(0x131)][_0x1a7d65(0x14d)](_0x485fe2),_0x3226cf=_0x2d8204[_0x1a7d65(0x173)][_0x1a7d65(0x194)]();_0x27b717[_0x1a7d65(0x17f)][_0x1a7d65(0x138)](_0x1a7d65(0x150)+_0x3226cf[_0x1a7d65(0x1b6)]+_0x1a7d65(0x13d)),setup['sendNotification'](_0x27b717,_0x1a7d65(0x17b)+_0x3226cf);}catch(_0x92f415){_0x27b717['log']['error'](_0x1a7d65(0x11f)+_0x92f415['message']);}}async function generateHealthReport(_0x3e5a31,_0x1a320b){const _0x41ec7a=a0_0x5aee60;if(!_0x3e5a31[_0x41ec7a(0x131)])return;const _0x3307d2=Date[_0x41ec7a(0x140)]();_0x3307d2-lastGlobalApiCall<0xbb8&&(_0x3e5a31[_0x41ec7a(0x17f)][_0x41ec7a(0x124)]('ðŸ¤–\x20API\x20Cooldown.\x20Waiting\x202s...'),await new Promise(_0x476bcc=>setTimeout(_0x476bcc,0x7d0)));const _0x21b1d5=new Date();let _0x25de0d=0x0,_0x2744d4=_0x21b1d5['getTime'](),_0x184908='';if(_0x1a320b===_0x41ec7a(0x186)){const _0x2f504a=new Date(_0x21b1d5);_0x2f504a[_0x41ec7a(0x146)](_0x2f504a[_0x41ec7a(0x1b8)]()-0x1),_0x2f504a[_0x41ec7a(0x17d)](0x16,0x0,0x0,0x0),_0x25de0d=_0x2f504a['getTime']();const _0x646935=new Date(_0x21b1d5);_0x646935[_0x41ec7a(0x17d)](0x8,0x0,0x0,0x0),_0x2744d4=_0x646935[_0x41ec7a(0x175)](),_0x184908=_0x41ec7a(0x188);}else{const _0x18fcf3=new Date(_0x21b1d5);_0x18fcf3[_0x41ec7a(0x17d)](0x8,0x0,0x0,0x0),_0x25de0d=_0x18fcf3[_0x41ec7a(0x175)](),_0x184908=_0x41ec7a(0x1b4);}const _0x2c936e=_0x3e5a31[_0x41ec7a(0x171)][_0x41ec7a(0x16a)](_0x370f3e=>_0x370f3e[_0x41ec7a(0x180)]>=_0x25de0d&&_0x370f3e['timestamp']<=_0x2744d4);if(_0x2c936e[_0x41ec7a(0x1b6)]===0x0){const _0x56aae7=_0x1a320b===_0x41ec7a(0x186)?_0x41ec7a(0x151):'Bisher\x20keine\x20AktivitÃ¤t\x20seit\x2008:00\x20Uhr\x20verzeichnet.',_0xfbaf07=_0x1a320b===_0x41ec7a(0x186)?_0x41ec7a(0x139):_0x41ec7a(0x120);await _0x3e5a31[_0x41ec7a(0x13a)](_0xfbaf07,{'val':_0x56aae7,'ack':!![]});return;}const _0x42df37=_0x2c936e[_0x41ec7a(0x165)](_0x50414d=>new Date(_0x50414d[_0x41ec7a(0x180)])[_0x41ec7a(0x15e)]([],{'hour':_0x41ec7a(0x1b2),'minute':_0x41ec7a(0x1b2)})+'\x20'+_0x50414d[_0x41ec7a(0x13b)]+'\x20('+_0x50414d[_0x41ec7a(0x199)]+')')[_0x41ec7a(0x14c)]('\x0a'),_0x51b12a=_0x41ec7a(0x15d)+_0x184908+_0x41ec7a(0x1b7)+_0x42df37+_0x41ec7a(0x19c);try{updateApiTimestamp();const _0x273e9c=await _0x3e5a31[_0x41ec7a(0x131)][_0x41ec7a(0x14d)](_0x51b12a),_0x5c3c77=_0x273e9c[_0x41ec7a(0x173)][_0x41ec7a(0x194)](),_0x15a3ff=_0x1a320b===_0x41ec7a(0x186)?_0x41ec7a(0x139):_0x41ec7a(0x120);await _0x3e5a31[_0x41ec7a(0x13a)](_0x15a3ff,{'val':_0x5c3c77,'ack':!![]}),_0x3e5a31[_0x41ec7a(0x17f)][_0x41ec7a(0x138)](_0x41ec7a(0x1aa)+_0x1a320b+_0x41ec7a(0x183));}catch(_0xb7fe7){_0x3e5a31[_0x41ec7a(0x17f)][_0x41ec7a(0x187)]('Health\x20Report\x20Error:\x20'+_0xb7fe7[_0x41ec7a(0x197)]);}}module[a0_0x5aee60(0x174)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};