const a0_0x394467=a0_0x5a64;function a0_0x3b0c(){const _0x373dff=['103239Hglkbx','generateContent','dailyDigests','.forecast.current.state','setDate','%)\x20nach\x20\x22','‚ö†Ô∏è\x20ALARM:\x20','log','toISOString','exports','livingContext','Skipped\x20(Traffic)','getForeignStateAsync','Tag','sendNotification','N/A\x20(Learning)','toLocaleTimeString','rawEventLog','info','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','slice','1919430tWjGxt','activityLevel','baselineDrift','@google/generative-ai','error','\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20','.Current.Temperature','targetId','Sicherheit\x20geht\x20vor.','send','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','splice','.\x20EVENTS:\x20','4IZehjo','text','val','Wetterdaten\x20nicht\x20abrufbar','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','analysis.isAlert','11BzsQtt',').\x20Sending\x20notification...','aiPersona',')\x20generated.','reason','./setup','getTime','description','apply','toFixed','stringify','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','ltmStbWindowDays','weatherInstance','Keine\x20Details.','trim','üåÖ\x20Morning\x20Briefing:\x0a','ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).','Nacht','push','Briefing\x20Error:\x20','value','automationProposal','.\x20EMERGENCY:\x20','ü§ñ\x20Butler\x20Brain\x20Error:\x20','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','replace','lastAlertState','approved','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','Health\x20Report\x20Error:\x20','824999LTfQhK','response','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Started...','analysis.automation.patternDetected','length','LTM.driftAnalysis.baselineDrift','map','name','warn','ANALYZE_HEALTH','now','ltmLtbWindowDays','.\x20SYSTEM_MODE:\x20','ü§ñ\x20Butler\x20Cache\x20Hit:\x20','analysis.lastResult','2-digit','search','isAlert','detected','setHours','filter','isProVersion','models/gemini-flash-latest',',\x20Wetter:\x20','\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20','\x20√ºbersprungen\x20(Auto-Approved).','KI-Fehler\x20(Fallback)','isEmergency','setStateAsync','NIGHT','join','analysis.automation.targetId','analysis.health.geminiNight','8cjKifO','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','\x20=\x20','1115188mZMOXK','608870OgKlrY','config',',\x20Lichtverh√§ltnisse:\x20','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','debug','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','KI\x20offline\x20(Fallback)','.Current.IsNight','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','parse','Unbekannt','¬∞C,\x20','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','geminiModel','pop','analysis.activitySummary','targetValue','ü§ñ\x20Health\x20Report\x20(','eventHistory','generic','(((.+)+)+)+$','message','timestamp','summary','currentSystemMode','Unbekannt\x20(Kein\x20Sensor)','Traffic-Schutz\x20(Auto-Approved)','LTM.processingStatus','45UXPFft','constructor','analysis.automation.targetValue','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','LTM.rawEventLog','analysis.health.geminiDay','alertReason','LTM.dailyDigests','LTM.driftAnalysis.driftDetails','6xNVYwr','analysisHistory','üåÖ\x20Briefing\x20generated\x20(Length:\x20','getStateAsync','137325syJMGi','.Current.WeatherText','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','toString','528864DSKaRq','üìÖ\x20Daily\x20Digest:\x0a','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','Success','Gemini\x20Error:\x20','üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...','getDate'];a0_0x3b0c=function(){return _0x373dff;};return a0_0x3b0c();}(function(_0x5a50c7,_0x396843){const _0x454cf3=a0_0x5a64,_0x2f6e1d=_0x5a50c7();while(!![]){try{const _0x29ffa1=parseInt(_0x454cf3(0x1e4))/0x1*(-parseInt(_0x454cf3(0x212))/0x2)+-parseInt(_0x454cf3(0x1f0))/0x3+-parseInt(_0x454cf3(0x25c))/0x4+-parseInt(_0x454cf3(0x205))/0x5*(-parseInt(_0x454cf3(0x1e0))/0x6)+parseInt(_0x454cf3(0x237))/0x7*(parseInt(_0x454cf3(0x259))/0x8)+-parseInt(_0x454cf3(0x1d7))/0x9*(-parseInt(_0x454cf3(0x25d))/0xa)+-parseInt(_0x454cf3(0x218))/0xb*(-parseInt(_0x454cf3(0x1e8))/0xc);if(_0x29ffa1===_0x396843)break;else _0x2f6e1d['push'](_0x2f6e1d['shift']());}catch(_0x10a1c6){_0x2f6e1d['push'](_0x2f6e1d['shift']());}}}(a0_0x3b0c,0x400f6));const a0_0x150e36=(function(){let _0x393ad8=!![];return function(_0x106294,_0x232487){const _0x1a0c1f=_0x393ad8?function(){const _0x507a74=a0_0x5a64;if(_0x232487){const _0x5614b8=_0x232487[_0x507a74(0x220)](_0x106294,arguments);return _0x232487=null,_0x5614b8;}}:function(){};return _0x393ad8=![],_0x1a0c1f;};}()),a0_0x315b6e=a0_0x150e36(this,function(){const _0x245705=a0_0x5a64;return a0_0x315b6e['toString']()[_0x245705(0x248)](_0x245705(0x1cf))[_0x245705(0x1e7)]()[_0x245705(0x1d8)](a0_0x315b6e)['search'](_0x245705(0x1cf));});a0_0x315b6e();function a0_0x5a64(_0xa5ce9f,_0x539b9a){const _0x26269f=a0_0x3b0c();return a0_0x5a64=function(_0x315b6e,_0x150e36){_0x315b6e=_0x315b6e-0x1c9;let _0x3b0c91=_0x26269f[_0x315b6e];return _0x3b0c91;},a0_0x5a64(_0xa5ce9f,_0x539b9a);}'use strict';const {GoogleGenerativeAI}=require(a0_0x394467(0x208)),setup=require(a0_0x394467(0x21d)),GEMINI_MODEL=a0_0x394467(0x24e),LTM_DP_DAILY_DIGESTS=a0_0x394467(0x1de),LTM_DP_STATUS=a0_0x394467(0x1d6),LTM_DP_RAW_LOG=a0_0x394467(0x1db),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x394467(0x25a),'senior_aal':'PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','family':'Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','single_comfort':a0_0x394467(0x1e6),'security':a0_0x394467(0x20d),'energy_saver':a0_0x394467(0x216)};function canCallApi(){const _0x195b1b=a0_0x394467,_0x39a484=Date[_0x195b1b(0x242)]();return _0x39a484-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x5ca198=a0_0x394467;lastGlobalApiCall=Date[_0x5ca198(0x242)]();}async function getWeatherContext(_0x24195e){const _0x129ca8=a0_0x394467;if(!_0x24195e['config']['useWeather']||!_0x24195e[_0x129ca8(0x25e)][_0x129ca8(0x225)])return _0x129ca8(0x1d4);try{const _0x39a122=_0x24195e[_0x129ca8(0x25e)][_0x129ca8(0x225)];let _0x5bd58d=await _0x24195e[_0x129ca8(0x1fc)](_0x39a122+_0x129ca8(0x20b));if(!_0x5bd58d)_0x5bd58d=await _0x24195e[_0x129ca8(0x1fc)](_0x39a122+'.forecast.current.temperature');let _0x459d22=await _0x24195e[_0x129ca8(0x1fc)](_0x39a122+_0x129ca8(0x1e5));if(!_0x459d22)_0x459d22=await _0x24195e[_0x129ca8(0x1fc)](_0x39a122+_0x129ca8(0x1f3));let _0x1c7977=_0x129ca8(0x267);const _0x156365=await _0x24195e[_0x129ca8(0x1fc)](_0x39a122+_0x129ca8(0x264));if(_0x156365)_0x1c7977=_0x156365['val']?_0x129ca8(0x22a):_0x129ca8(0x1fd);if(_0x5bd58d&&_0x459d22)return _0x5bd58d[_0x129ca8(0x214)]+_0x129ca8(0x268)+_0x459d22[_0x129ca8(0x214)]+_0x129ca8(0x25f)+_0x1c7977;}catch(_0x955dbd){}return _0x129ca8(0x215);}async function consultButler(_0x5ea739,_0x485ec4,_0x1dbf27,_0x5af6d8){const _0xe61af=a0_0x394467;if(!_0x5ea739['geminiModel'])return{'approved':!![],'reason':_0xe61af(0x263)};const _0x57fdf4=Date[_0xe61af(0x242)]();if(decisionCache[_0x485ec4]&&_0x57fdf4-decisionCache[_0x485ec4][_0xe61af(0x1d1)]<CACHE_TTL_MS){const _0x4f1c2f=decisionCache[_0x485ec4]['decision'];return _0x5ea739[_0xe61af(0x1f7)][_0xe61af(0x261)](_0xe61af(0x245)+_0x485ec4+'\x20->\x20'+(_0x4f1c2f[_0xe61af(0x234)]?'OK':'NO')+'\x20('+_0x4f1c2f[_0xe61af(0x21c)]+')'),_0x4f1c2f;}if(!canCallApi())return _0x5ea739['log'][_0xe61af(0x261)](_0xe61af(0x262)+_0x485ec4+_0xe61af(0x251)),{'approved':!![],'reason':_0xe61af(0x1d5)};const _0x2179d5=new Date()[_0xe61af(0x200)](),_0x26d402=await getWeatherContext(_0x5ea739),_0x38e7ca=PERSONA_MAPPING[_0x5ea739[_0xe61af(0x25e)][_0xe61af(0x21a)]||_0xe61af(0x1ce)],_0x5492b2=_0xe61af(0x269)+_0x2179d5+_0xe61af(0x24f)+_0x26d402+'.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20('+(_0x5af6d8*0x64)[_0xe61af(0x221)](0x0)+_0xe61af(0x1f5)+_0x485ec4+_0xe61af(0x265)+_0x1dbf27+_0xe61af(0x20a)+_0x38e7ca+_0xe61af(0x223);try{updateApiTimestamp();const _0x27e268=await _0x5ea739[_0xe61af(0x26a)][_0xe61af(0x1f1)](_0x5492b2),_0x2141ed=_0x27e268[_0xe61af(0x238)][_0xe61af(0x213)]()[_0xe61af(0x232)](/```json|```/g,'')[_0xe61af(0x227)](),_0x19946d=JSON[_0xe61af(0x266)](_0x2141ed);return decisionCache[_0x485ec4]={'decision':_0x19946d,'timestamp':_0x57fdf4},_0x19946d;}catch(_0x223308){return _0x5ea739[_0xe61af(0x1f7)]['warn'](_0xe61af(0x230)+_0x223308[_0xe61af(0x1d0)]),decisionCache[_0x485ec4]={'decision':{'approved':!![],'reason':'KI-Fehler\x20(Fallback)'},'timestamp':_0x57fdf4-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0xe61af(0x252)};}}async function runGeminiAnalysis(_0x48ee6a,_0x3a324b=''){const _0x352d3c=a0_0x394467;if(!_0x48ee6a[_0x352d3c(0x26a)])return;if(!canCallApi()){_0x48ee6a[_0x352d3c(0x1f7)][_0x352d3c(0x261)](_0x352d3c(0x229));return;}if(_0x48ee6a['eventHistory'][_0x352d3c(0x23c)]===0x0)return;const _0x585d06=_0x48ee6a[_0x352d3c(0x1cd)][_0x352d3c(0x204)](0x0,0xf),_0xe1404=_0x48ee6a[_0x352d3c(0x1d3)],_0x8d51bc=PERSONA_MAPPING[_0x48ee6a[_0x352d3c(0x25e)][_0x352d3c(0x21a)]||_0x352d3c(0x1ce)],_0x35e98f=_0x48ee6a[_0x352d3c(0x25e)][_0x352d3c(0x1fa)]||_0x352d3c(0x226);let _0x388d1b=_0x352d3c(0x267);try{const _0x4f1c09=await _0x48ee6a[_0x352d3c(0x1e3)]('system.presenceWho');if(_0x4f1c09&&_0x4f1c09[_0x352d3c(0x214)])_0x388d1b=_0x4f1c09[_0x352d3c(0x214)];}catch(_0x33a41){}let _0x1ff976=![];try{const _0x66f10b=await _0x48ee6a[_0x352d3c(0x1e3)]('analysis.automation.autoApply');if(_0x66f10b&&_0x66f10b[_0x352d3c(0x214)])_0x1ff976=!![];}catch(_0x98decc){}const _0x2cebaf=_0x352d3c(0x1da)+_0x8d51bc+'.\x20KONTEXT:\x20'+_0x35e98f+_0x352d3c(0x244)+_0xe1404+'.\x20ANWESEND:\x20'+_0x388d1b+_0x352d3c(0x211)+JSON['stringify'](_0x585d06)+_0x352d3c(0x22f)+_0x3a324b+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{updateApiTimestamp();const _0x2ae6a3=await _0x48ee6a[_0x352d3c(0x26a)][_0x352d3c(0x1f1)](_0x2cebaf),_0x1429fe=JSON[_0x352d3c(0x266)](_0x2ae6a3[_0x352d3c(0x238)]['text']()[_0x352d3c(0x232)](/```json|```/g,'')[_0x352d3c(0x227)]());await _0x48ee6a[_0x352d3c(0x254)](_0x352d3c(0x246),{'val':JSON['stringify'](_0x1429fe),'ack':!![]});if(_0x1429fe[_0x352d3c(0x1d2)])await _0x48ee6a[_0x352d3c(0x254)](_0x352d3c(0x1ca),{'val':_0x1429fe[_0x352d3c(0x1d2)],'ack':!![]});const _0x23e0d0={'timestamp':Date[_0x352d3c(0x242)](),'id':Date['now']()[_0x352d3c(0x1e7)](),'analysis':{'activity':{'summary':_0x1429fe[_0x352d3c(0x1d2)],'isAlert':_0x1429fe[_0x352d3c(0x249)],'alertReason':_0x1429fe[_0x352d3c(0x1dd)]},'comfort':{'automationProposal':_0x1429fe[_0x352d3c(0x22e)]}}};_0x48ee6a[_0x352d3c(0x1e1)]['unshift'](_0x23e0d0);if(_0x48ee6a[_0x352d3c(0x1e1)][_0x352d3c(0x23c)]>0x32)_0x48ee6a['analysisHistory'][_0x352d3c(0x1c9)]();await _0x48ee6a['setStateAsync']('analysis.analysisHistory',{'val':JSON[_0x352d3c(0x222)](_0x48ee6a[_0x352d3c(0x1e1)]),'ack':!![]});const _0x526640=_0x1429fe[_0x352d3c(0x249)]||![];_0x526640!==_0x48ee6a[_0x352d3c(0x233)]&&(await _0x48ee6a['setStateAsync'](_0x352d3c(0x217),{'val':_0x526640,'ack':!![]}),_0x48ee6a[_0x352d3c(0x233)]=_0x526640,_0x526640&&(await _0x48ee6a[_0x352d3c(0x254)]('analysis.alertReason',{'val':_0x1429fe[_0x352d3c(0x1dd)],'ack':!![]}),setup[_0x352d3c(0x1fe)](_0x48ee6a,_0x352d3c(0x1f6)+_0x1429fe['alertReason'],![],_0x1429fe[_0x352d3c(0x253)])));if(_0x1429fe[_0x352d3c(0x22e)]&&_0x1429fe['automationProposal'][_0x352d3c(0x24a)]){await _0x48ee6a['setStateAsync'](_0x352d3c(0x23b),{'val':!![],'ack':!![]}),await _0x48ee6a[_0x352d3c(0x254)]('analysis.automation.description',{'val':_0x1429fe[_0x352d3c(0x22e)][_0x352d3c(0x21f)],'ack':!![]}),await _0x48ee6a[_0x352d3c(0x254)](_0x352d3c(0x257),{'val':_0x1429fe['automationProposal'][_0x352d3c(0x20c)],'ack':!![]}),await _0x48ee6a[_0x352d3c(0x254)](_0x352d3c(0x1d9),{'val':JSON[_0x352d3c(0x222)](_0x1429fe['automationProposal'][_0x352d3c(0x1cb)]),'ack':!![]});if(_0x1ff976)executeAutomationAction(_0x48ee6a);}}catch(_0x47d22f){_0x48ee6a[_0x352d3c(0x1f7)][_0x352d3c(0x209)](_0x352d3c(0x1ed)+_0x47d22f[_0x352d3c(0x1d0)]);}}async function createDailyDigest(_0x3bda68,_0x148aff){const _0x224f73=a0_0x394467;if(!_0x3bda68['isProVersion'])return;if(!canCallApi()){await _0x3bda68[_0x224f73(0x254)](LTM_DP_STATUS,{'val':_0x224f73(0x1fb),'ack':!![]});return;}await _0x3bda68[_0x224f73(0x254)](LTM_DP_STATUS,{'val':_0x224f73(0x23a),'ack':!![]});if(!_0x3bda68[_0x224f73(0x26a)]||_0x3bda68[_0x224f73(0x201)][_0x224f73(0x23c)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3bda68['setStateAsync'](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x590dcd=JSON[_0x224f73(0x266)](JSON['stringify'](_0x3bda68[_0x224f73(0x201)])),_0x2fb3c1=_0x590dcd[_0x224f73(0x23c)],_0xa523e6=_0x224f73(0x1eb)+JSON[_0x224f73(0x222)](_0x590dcd);try{updateApiTimestamp();const _0x4e45bb=await _0x3bda68[_0x224f73(0x26a)][_0x224f73(0x1f1)](_0xa523e6),_0x5c4805=JSON['parse'](_0x4e45bb[_0x224f73(0x238)][_0x224f73(0x213)]()[_0x224f73(0x232)](/```json|```/g,'')[_0x224f73(0x227)]()),_0x927a5b={'timestamp':new Date()[_0x224f73(0x1f8)](),'eventCount':_0x2fb3c1,'summary':_0x5c4805[_0x224f73(0x1d2)]||'Digest','activityLevel':_0x5c4805[_0x224f73(0x206)]||'normal','systemMode':_0x3bda68[_0x224f73(0x1d3)]};_0x3bda68[_0x224f73(0x1f2)][_0x224f73(0x22b)](_0x927a5b);const _0x3be9a8=_0x3bda68[_0x224f73(0x25e)][_0x224f73(0x243)]||0x3c;_0x3bda68[_0x224f73(0x1f2)][_0x224f73(0x23c)]>_0x3be9a8&&_0x3bda68['dailyDigests'][_0x224f73(0x210)](0x0,_0x3bda68['dailyDigests'][_0x224f73(0x23c)]-_0x3be9a8);await _0x3bda68['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x224f73(0x222)](_0x3bda68[_0x224f73(0x1f2)]),'ack':!![]}),_0x3bda68[_0x224f73(0x201)]=[],await _0x3bda68['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x3bda68[_0x224f73(0x201)]),'ack':!![]}),await _0x3bda68[_0x224f73(0x254)](LTM_DP_STATUS,{'val':_0x224f73(0x1ec),'ack':!![]});const _0x57c89f=_0x224f73(0x1e9)+_0x5c4805[_0x224f73(0x1d2)]+'\x0aAktivit√§t:\x20'+_0x5c4805[_0x224f73(0x206)];setup[_0x224f73(0x1fe)](_0x3bda68,_0x57c89f,![],![]);if(_0x3bda68[_0x224f73(0x24d)]&&_0x148aff)_0x148aff[_0x224f73(0x20e)](_0x3bda68,_0x224f73(0x241),{'digest':_0x927a5b});}catch(_0x3889fb){_0x3bda68['log'][_0x224f73(0x209)](_0x3889fb[_0x224f73(0x1d0)]);}}async function runBaselineDriftAnalysis(_0x9eb44c){const _0x32d6f6=a0_0x394467;if(!_0x9eb44c['isProVersion']||!_0x9eb44c[_0x32d6f6(0x26a)])return;if(!canCallApi())return;const _0x2f5dcf=_0x9eb44c[_0x32d6f6(0x25e)][_0x32d6f6(0x224)]||0xe;if(_0x9eb44c['dailyDigests']['length']<_0x2f5dcf+0x7){await _0x9eb44c[_0x32d6f6(0x254)]('LTM.driftAnalysis.baselineDrift',{'val':_0x32d6f6(0x1ff),'ack':!![]});return;}const _0xf60a4a=_0x9eb44c[_0x32d6f6(0x1f2)][_0x32d6f6(0x204)](-_0x2f5dcf),_0x5d350b=_0x9eb44c[_0x32d6f6(0x1f2)][_0x32d6f6(0x204)](0x0,_0x9eb44c[_0x32d6f6(0x1f2)][_0x32d6f6(0x23c)]-_0x2f5dcf),_0x1cf923='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x32d6f6(0x222)](_0x5d350b)+'\x0aSTB:\x20'+JSON[_0x32d6f6(0x222)](_0xf60a4a);try{updateApiTimestamp();const _0x390f9a=await _0x9eb44c['geminiModel'][_0x32d6f6(0x1f1)](_0x1cf923),_0x1131fb=JSON[_0x32d6f6(0x266)](_0x390f9a[_0x32d6f6(0x238)][_0x32d6f6(0x213)]()['replace'](/```json|```/g,'')[_0x32d6f6(0x227)]());_0x1131fb[_0x32d6f6(0x207)]&&(await _0x9eb44c[_0x32d6f6(0x254)](_0x32d6f6(0x23d),{'val':_0x1131fb[_0x32d6f6(0x207)],'ack':!![]}),await _0x9eb44c[_0x32d6f6(0x254)](_0x32d6f6(0x1df),{'val':_0x1131fb['driftDetails'],'ack':!![]}),await _0x9eb44c[_0x32d6f6(0x254)]('LTM.driftAnalysis.lastCheck',{'val':Date[_0x32d6f6(0x242)](),'ack':!![]}));}catch(_0x5ec958){}}async function executeAutomationAction(_0x5a9864){const _0x484080=a0_0x394467;try{const _0x325f17=await _0x5a9864[_0x484080(0x1e3)](_0x484080(0x257)),_0x58d92b=await _0x5a9864[_0x484080(0x1e3)](_0x484080(0x1d9));if(_0x325f17&&_0x325f17[_0x484080(0x214)]&&_0x58d92b){const _0xe664ce=_0x325f17[_0x484080(0x214)];let _0x27b4f0=_0x58d92b[_0x484080(0x214)];try{_0x27b4f0=JSON['parse'](_0x27b4f0);}catch(_0x55a333){}_0x5a9864['log']['info'](_0x484080(0x1ea)+_0xe664ce+_0x484080(0x25b)+_0x27b4f0),await _0x5a9864['setForeignStateAsync'](_0xe664ce,_0x27b4f0);}else _0x5a9864[_0x484080(0x1f7)][_0x484080(0x240)](_0x484080(0x239));}catch(_0x3ad270){_0x5a9864['log']['error']('BUTLER\x20Execution\x20Error:\x20'+_0x3ad270[_0x484080(0x1d0)]);}}async function sendMorningBriefing(_0x2935bc){const _0x6af5df=a0_0x394467;if(!_0x2935bc[_0x6af5df(0x26a)]){_0x2935bc[_0x6af5df(0x1f7)]['warn']('ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x2935bc[_0x6af5df(0x1f7)][_0x6af5df(0x202)](_0x6af5df(0x1ee));try{updateApiTimestamp();const _0x531ab6=_0x6af5df(0x260),_0x3f6e44=await _0x2935bc[_0x6af5df(0x26a)]['generateContent'](_0x531ab6),_0x56f3f8=_0x3f6e44[_0x6af5df(0x238)][_0x6af5df(0x213)]();_0x2935bc[_0x6af5df(0x1f7)][_0x6af5df(0x202)](_0x6af5df(0x1e2)+_0x56f3f8[_0x6af5df(0x23c)]+_0x6af5df(0x219)),setup['sendNotification'](_0x2935bc,_0x6af5df(0x228)+_0x56f3f8);}catch(_0x188122){_0x2935bc[_0x6af5df(0x1f7)]['error'](_0x6af5df(0x22c)+_0x188122[_0x6af5df(0x1d0)]);}}async function generateHealthReport(_0x25ade4,_0x44affc){const _0x396760=a0_0x394467;if(!_0x25ade4[_0x396760(0x26a)])return;const _0x4342fc=Date[_0x396760(0x242)]();_0x4342fc-lastGlobalApiCall<0xbb8&&(_0x25ade4[_0x396760(0x1f7)][_0x396760(0x261)]('ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...'),await new Promise(_0xd9ffc9=>setTimeout(_0xd9ffc9,0x7d0)));const _0x13ad27=new Date();let _0xccb7be=0x0,_0x1e993d=_0x13ad27['getTime'](),_0x3c8047='';if(_0x44affc===_0x396760(0x255)){const _0x46d7d3=new Date(_0x13ad27);_0x46d7d3[_0x396760(0x1f4)](_0x46d7d3[_0x396760(0x1ef)]()-0x1),_0x46d7d3['setHours'](0x16,0x0,0x0,0x0),_0xccb7be=_0x46d7d3['getTime']();const _0x4ede3c=new Date(_0x13ad27);_0x4ede3c[_0x396760(0x24b)](0x8,0x0,0x0,0x0),_0x1e993d=_0x4ede3c[_0x396760(0x21e)](),_0x3c8047=_0x396760(0x203);}else{const _0x1090bb=new Date(_0x13ad27);_0x1090bb['setHours'](0x8,0x0,0x0,0x0),_0xccb7be=_0x1090bb['getTime'](),_0x3c8047=_0x396760(0x20f);}const _0xbd6a90=_0x25ade4[_0x396760(0x1cd)][_0x396760(0x24c)](_0x4c3681=>_0x4c3681[_0x396760(0x1d1)]>=_0xccb7be&&_0x4c3681['timestamp']<=_0x1e993d);if(_0xbd6a90['length']===0x0){const _0x4420a1=_0x44affc===_0x396760(0x255)?_0x396760(0x231):'Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.',_0x2d7062=_0x44affc===_0x396760(0x255)?_0x396760(0x258):_0x396760(0x1dc);await _0x25ade4['setStateAsync'](_0x2d7062,{'val':_0x4420a1,'ack':!![]});return;}const _0x129b44=_0xbd6a90[_0x396760(0x23e)](_0x29ce0c=>new Date(_0x29ce0c[_0x396760(0x1d1)])[_0x396760(0x200)]([],{'hour':_0x396760(0x247),'minute':_0x396760(0x247)})+'\x20'+_0x29ce0c[_0x396760(0x23f)]+'\x20('+_0x29ce0c[_0x396760(0x22d)]+')')[_0x396760(0x256)]('\x0a'),_0x541a9f=_0x396760(0x235)+_0x3c8047+'\x0a\x20\x20\x20\x20EVENTS:\x0a'+_0x129b44+_0x396760(0x250);try{updateApiTimestamp();const _0x291722=await _0x25ade4[_0x396760(0x26a)][_0x396760(0x1f1)](_0x541a9f),_0xbb4e17=_0x291722[_0x396760(0x238)][_0x396760(0x213)](),_0x398c87=_0x44affc==='NIGHT'?'analysis.health.geminiNight':_0x396760(0x1dc);await _0x25ade4[_0x396760(0x254)](_0x398c87,{'val':_0xbb4e17,'ack':!![]}),_0x25ade4[_0x396760(0x1f7)][_0x396760(0x202)](_0x396760(0x1cc)+_0x44affc+_0x396760(0x21b));}catch(_0x18e4a0){_0x25ade4[_0x396760(0x1f7)]['error'](_0x396760(0x236)+_0x18e4a0[_0x396760(0x1d0)]);}}module[a0_0x394467(0x1f9)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};