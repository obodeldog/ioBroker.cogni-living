const a0_0x24a37c=a0_0x17c5;(function(_0x14ba3e,_0x4da159){const _0x26811f=a0_0x17c5,_0x4a8dce=_0x14ba3e();while(!![]){try{const _0x17b1cf=-parseInt(_0x26811f(0x271))/0x1+parseInt(_0x26811f(0x1fb))/0x2*(-parseInt(_0x26811f(0x20f))/0x3)+-parseInt(_0x26811f(0x225))/0x4+parseInt(_0x26811f(0x26f))/0x5+-parseInt(_0x26811f(0x237))/0x6+-parseInt(_0x26811f(0x246))/0x7*(parseInt(_0x26811f(0x211))/0x8)+-parseInt(_0x26811f(0x1da))/0x9*(-parseInt(_0x26811f(0x212))/0xa);if(_0x17b1cf===_0x4da159)break;else _0x4a8dce['push'](_0x4a8dce['shift']());}catch(_0x151791){_0x4a8dce['push'](_0x4a8dce['shift']());}}}(a0_0x365a,0xd48f6));const a0_0x3c4279=(function(){let _0x171a97=!![];return function(_0x3601ec,_0x431756){const _0x39a926=_0x171a97?function(){const _0x62c922=a0_0x17c5;if(_0x431756){const _0x29c57b=_0x431756[_0x62c922(0x20e)](_0x3601ec,arguments);return _0x431756=null,_0x29c57b;}}:function(){};return _0x171a97=![],_0x39a926;};}()),a0_0x48f393=a0_0x3c4279(this,function(){const _0xc58a78=a0_0x17c5;return a0_0x48f393[_0xc58a78(0x20d)]()[_0xc58a78(0x200)]('(((.+)+)+)+$')[_0xc58a78(0x20d)]()['constructor'](a0_0x48f393)['search'](_0xc58a78(0x231));});a0_0x48f393();'use strict';const {GoogleGenerativeAI}=require(a0_0x24a37c(0x268)),setup=require('./setup'),GEMINI_MODEL='models/gemini-flash-latest',LTM_DP_DAILY_DIGESTS=a0_0x24a37c(0x260),LTM_DP_STATUS=a0_0x24a37c(0x1e3),LTM_DP_RAW_LOG=a0_0x24a37c(0x272),LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,MIN_API_GAP_MS=0x4e20;let lastGlobalApiCall=0x0;const decisionCache={},CACHE_TTL_MS=0xf*0x3c*0x3e8,PERSONA_MAPPING={'generic':a0_0x24a37c(0x270),'senior_aal':a0_0x24a37c(0x215),'family':a0_0x24a37c(0x202),'single_comfort':a0_0x24a37c(0x222),'security':'Sicherheit\x20geht\x20vor.','energy_saver':a0_0x24a37c(0x208)};function canCallApi(){const _0x148c73=a0_0x24a37c,_0x5dee97=Date[_0x148c73(0x1d9)]();return _0x5dee97-lastGlobalApiCall>MIN_API_GAP_MS;}function updateApiTimestamp(){const _0x1d27e8=a0_0x24a37c;lastGlobalApiCall=Date[_0x1d27e8(0x1d9)]();}async function getWeatherContext(_0x4cd0f1){const _0xab64f6=a0_0x24a37c;if(!_0x4cd0f1[_0xab64f6(0x264)][_0xab64f6(0x1f8)]||!_0x4cd0f1['config'][_0xab64f6(0x1e8)])return _0xab64f6(0x256);try{const _0x593045=_0x4cd0f1[_0xab64f6(0x264)][_0xab64f6(0x1e8)];let _0x5a3cd7=await _0x4cd0f1[_0xab64f6(0x201)](_0x593045+'.Current.Temperature');if(!_0x5a3cd7)_0x5a3cd7=await _0x4cd0f1[_0xab64f6(0x201)](_0x593045+_0xab64f6(0x1df));let _0x6a3aa0=await _0x4cd0f1['getForeignStateAsync'](_0x593045+_0xab64f6(0x26d));if(!_0x6a3aa0)_0x6a3aa0=await _0x4cd0f1[_0xab64f6(0x201)](_0x593045+_0xab64f6(0x23a));let _0x22b3cc=_0xab64f6(0x216);const _0x1d565b=await _0x4cd0f1[_0xab64f6(0x201)](_0x593045+_0xab64f6(0x214));if(_0x1d565b)_0x22b3cc=_0x1d565b[_0xab64f6(0x1f6)]?_0xab64f6(0x24d):_0xab64f6(0x1dd);if(_0x5a3cd7&&_0x6a3aa0)return _0x5a3cd7[_0xab64f6(0x1f6)]+_0xab64f6(0x234)+_0x6a3aa0['val']+_0xab64f6(0x21d)+_0x22b3cc;}catch(_0x4de755){}return _0xab64f6(0x23d);}function a0_0x17c5(_0x52669f,_0xb73001){const _0xbbb3bb=a0_0x365a();return a0_0x17c5=function(_0x48f393,_0x3c4279){_0x48f393=_0x48f393-0x1d9;let _0x365a91=_0xbbb3bb[_0x48f393];return _0x365a91;},a0_0x17c5(_0x52669f,_0xb73001);}async function consultButler(_0xcde459,_0x27da78,_0x57d6a2,_0x284447){const _0x1380a6=a0_0x24a37c;if(!_0xcde459[_0x1380a6(0x24e)])return{'approved':!![],'reason':_0x1380a6(0x204)};const _0x2d1b03=Date['now']();if(decisionCache[_0x27da78]&&_0x2d1b03-decisionCache[_0x27da78][_0x1380a6(0x207)]<CACHE_TTL_MS){const _0x47612d=decisionCache[_0x27da78]['decision'];return _0xcde459[_0x1380a6(0x232)][_0x1380a6(0x254)]('ü§ñ\x20Butler\x20Cache\x20Hit:\x20'+_0x27da78+'\x20->\x20'+(_0x47612d[_0x1380a6(0x278)]?'OK':'NO')+'\x20('+_0x47612d[_0x1380a6(0x22d)]+')'),_0x47612d;}if(!canCallApi())return _0xcde459[_0x1380a6(0x232)][_0x1380a6(0x254)](_0x1380a6(0x203)+_0x27da78+_0x1380a6(0x24f)),{'approved':!![],'reason':_0x1380a6(0x253)};const _0x46169f=new Date()[_0x1380a6(0x20b)](),_0x507ba6=await getWeatherContext(_0xcde459),_0x57d7e4=PERSONA_MAPPING[_0xcde459[_0x1380a6(0x264)][_0x1380a6(0x26b)]||_0x1380a6(0x1f7)],_0x5b836d=_0x1380a6(0x1e4)+_0x46169f+',\x20Wetter:\x20'+_0x507ba6+_0x1380a6(0x23b)+(_0x284447*0x64)[_0x1380a6(0x25b)](0x0)+'%)\x20nach\x20\x22'+_0x27da78+_0x1380a6(0x213)+_0x57d6a2+'\x22\x20AN.\x0a\x20\x20\x20\x20STRATEGIE:\x20'+_0x57d7e4+_0x1380a6(0x251);try{updateApiTimestamp();const _0xfcfd57=await _0xcde459[_0x1380a6(0x24e)]['generateContent'](_0x5b836d),_0x4d26d6=_0xfcfd57[_0x1380a6(0x247)]['text']()['replace'](/```json|```/g,'')['trim'](),_0x449caa=JSON[_0x1380a6(0x27a)](_0x4d26d6);return decisionCache[_0x27da78]={'decision':_0x449caa,'timestamp':_0x2d1b03},_0x449caa;}catch(_0x31e408){return _0xcde459[_0x1380a6(0x232)][_0x1380a6(0x243)](_0x1380a6(0x22a)+_0x31e408['message']),decisionCache[_0x27da78]={'decision':{'approved':!![],'reason':_0x1380a6(0x255)},'timestamp':_0x2d1b03-(CACHE_TTL_MS-0xea60)},{'approved':!![],'reason':_0x1380a6(0x255)};}}function a0_0x365a(){const _0x4118dc=['normal','.\x20KONTEXT:\x20','üìÖ\x20Daily\x20Digest:\x0a','Keine\x20Daten\x20f√ºr\x20die\x20Nacht\x20aufgezeichnet\x20(Sensoren\x20ruhig).','Nacht','geminiModel','\x20√ºbersprungen\x20(Auto-Approved).','NIGHT','\x0a\x20\x20\x20\x20FRAGE:\x20Ist\x20es\x20dunkel\x20genug\x20f√ºr\x20Licht?\x0a\x20\x20\x20\x20FORMAT:\x20{\x20\x22approved\x22:\x20boolean,\x20\x22reason\x22:\x20\x22kurzer\x20Grund\x22\x20}\x0a\x20\x20\x20\x20','Keine\x20Details.','Traffic-Schutz\x20(Auto-Approved)','debug','KI-Fehler\x20(Fallback)','Unbekannt\x20(Kein\x20Sensor)','N/A\x20(Learning)','Analysiere\x20diese\x20Events\x20der\x20NACHT\x20(22:00-08:00).\x20War\x20der\x20Schlaf\x20ruhig?\x20Gab\x20es\x20Badg√§nge?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','ANALYZE_HEALTH','üåÖ\x20Morning\x20Briefing:\x0a','toFixed',').\x20Sending\x20notification...','message','isProVersion','LTM.driftAnalysis.lastCheck','LTM.dailyDigests','\x0aSTB:\x20','analysis.activitySummary','targetId','config','ltmStbWindowDays','splice','replace','@google/generative-ai','name','lastAlertState','aiPersona','length','.Current.WeatherText','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','4695005anbGfH','Entscheide\x20ausgewogen\x20zwischen\x20Komfort\x20und\x20Energie.','1080610OTXxEu','LTM.rawEventLog','LTM.driftAnalysis.driftDetails','eventHistory','info','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','rawEventLog','approved','pop','parse','now','135yHrDle',')\x20generated.','LTM.driftAnalysis.baselineDrift','Tag','baselineDrift','.forecast.current.temperature','analysis.automation.autoApply','analysis.automation.patternDetected','\x0a\x20\x20\x20\x20EVENTS:\x0a','LTM.processingStatus','\x0a\x20\x20\x20\x20ROLLE:\x20Haus-Butler.\x0a\x20\x20\x20\x20SITUATION:\x20','analysis.health.geminiNight','getTime','stringify','weatherInstance','setStateAsync','toISOString','‚ö†Ô∏è\x20ALARM:\x20','text','setForeignStateAsync','Analysiere\x20diese\x20Events\x20des\x20TAGES\x20(08:00-Jetzt).\x20Aktivit√§t?\x20Mahlzeiten?\x20Haust√ºr?\x20Antwort\x20kurz\x20f√ºr\x20den\x20besorgten\x20Sohn\x20(max\x202\x20S√§tze).','analysis.health.geminiDay','\x0aAktivit√§t:\x20','BUTLER\x20Execution\x20Error:\x20','trim','Briefing\x20Error:\x20','unshift','analysis.automation.targetValue','val','generic','useWeather','activityLevel','currentSystemMode','96FeRLYv','generateContent','summary','analysis.analysisHistory','Skipped\x20(Traffic)','search','getForeignStateAsync','Fokus\x20auf\x20Komfort\x20f√ºr\x20die\x20Familie.','ü§ñ\x20Traffic\x20Schutz:\x20Anfrage\x20f√ºr\x20','KI\x20offline\x20(Fallback)','analysis.lastResult','Health\x20Report\x20Error:\x20','timestamp','PRIORIT√ÑT:\x20Energie\x20sparen.\x20Schalte\x20nur,\x20wenn\x20absolut\x20notwendig\x20(Dunkelheit).','getStateAsync','analysis.automation.targetId','toLocaleTimeString','setDate','toString','apply','82011LSvrpa','sendNotification','360YHxNvM','3397490FITcmI','\x22.\x0a\x20\x20\x20\x20AKTION:\x20Schalte\x20\x22','.Current.IsNight','PRIORIT√ÑT:\x20Sicherheit\x20und\x20Licht.\x20Schalte\x20lieber\x20einmal\x20zu\x20viel\x20als\x20zu\x20wenig.','Unbekannt','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','analysisHistory','push','map','\x20=\x20','isAlert',',\x20Lichtverh√§ltnisse:\x20','.\x20EMERGENCY:\x20','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','getDate','setHours','Maximaler\x20Komfort,\x20Energie\x20ist\x20zweitrangig.','error','ü§ñ\x20API\x20Cooldown.\x20Waiting\x202s...','3955680DltiGE','join','.\x20EVENTS:\x20','exports','description','ü§ñ\x20Butler\x20Brain\x20Error:\x20','system.presenceWho','automationProposal','reason','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','ü§ñ\x20Health\x20Report\x20(','\x0a\x20\x20\x20\x20ROLLE:\x20Medizinischer\x20Assistent\x20f√ºr\x20AAL\x20(Ambient\x20Assisted\x20Living).\x0a\x20\x20\x20\x20AUFGABE:\x20','(((.+)+)+)+$','log','targetValue','¬∞C,\x20','slice','value','487794UQaNLK','.\x20SYSTEM_MODE:\x20','alertReason','.forecast.current.state','.\x0a\x20\x20\x20\x20EVENT:\x20Bewohner\x20geht\x20wahrscheinlich\x20(','üåÖ\x20Briefing\x20generated\x20(Length:\x20','Wetterdaten\x20nicht\x20abrufbar','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','dailyDigests','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','2-digit','Started...','warn','send','filter','264691AqFCBM','response','driftDetails'];a0_0x365a=function(){return _0x4118dc;};return a0_0x365a();}async function runGeminiAnalysis(_0x51abd4,_0x12c7ff=''){const _0x28b5bb=a0_0x24a37c;if(!_0x51abd4[_0x28b5bb(0x24e)])return;if(!canCallApi()){_0x51abd4['log'][_0x28b5bb(0x254)]('ü§ñ\x20Autopilot\x20skipped\x20(Traffic\x20Protection\x20active).');return;}if(_0x51abd4[_0x28b5bb(0x274)][_0x28b5bb(0x26c)]===0x0)return;const _0x3161f5=_0x51abd4[_0x28b5bb(0x274)][_0x28b5bb(0x235)](0x0,0xf),_0x5c98b8=_0x51abd4[_0x28b5bb(0x1fa)],_0x1ef029=PERSONA_MAPPING[_0x51abd4['config'][_0x28b5bb(0x26b)]||'generic'],_0x122691=_0x51abd4[_0x28b5bb(0x264)]['livingContext']||_0x28b5bb(0x252);let _0x1720be=_0x28b5bb(0x216);try{const _0x2fb897=await _0x51abd4['getStateAsync'](_0x28b5bb(0x22b));if(_0x2fb897&&_0x2fb897[_0x28b5bb(0x1f6)])_0x1720be=_0x2fb897[_0x28b5bb(0x1f6)];}catch(_0x254ced){}let _0x46ed48=![];try{const _0x273b16=await _0x51abd4[_0x28b5bb(0x209)](_0x28b5bb(0x1e0));if(_0x273b16&&_0x273b16['val'])_0x46ed48=!![];}catch(_0x49c168){}const _0x5862bc=_0x28b5bb(0x276)+_0x1ef029+_0x28b5bb(0x24a)+_0x122691+_0x28b5bb(0x238)+_0x5c98b8+'.\x20ANWESEND:\x20'+_0x1720be+_0x28b5bb(0x227)+JSON[_0x28b5bb(0x1e7)](_0x3161f5)+_0x28b5bb(0x21e)+_0x12c7ff+_0x28b5bb(0x23e);try{updateApiTimestamp();const _0x2e4ee1=await _0x51abd4[_0x28b5bb(0x24e)][_0x28b5bb(0x1fc)](_0x5862bc),_0x12abe9=JSON['parse'](_0x2e4ee1[_0x28b5bb(0x247)][_0x28b5bb(0x1ec)]()[_0x28b5bb(0x267)](/```json|```/g,'')[_0x28b5bb(0x1f2)]());await _0x51abd4['setStateAsync'](_0x28b5bb(0x205),{'val':JSON[_0x28b5bb(0x1e7)](_0x12abe9),'ack':!![]});if(_0x12abe9[_0x28b5bb(0x1fd)])await _0x51abd4[_0x28b5bb(0x1e9)](_0x28b5bb(0x262),{'val':_0x12abe9[_0x28b5bb(0x1fd)],'ack':!![]});const _0xafae1d={'timestamp':Date[_0x28b5bb(0x1d9)](),'id':Date[_0x28b5bb(0x1d9)]()[_0x28b5bb(0x20d)](),'analysis':{'activity':{'summary':_0x12abe9[_0x28b5bb(0x1fd)],'isAlert':_0x12abe9[_0x28b5bb(0x21c)],'alertReason':_0x12abe9[_0x28b5bb(0x239)]},'comfort':{'automationProposal':_0x12abe9['automationProposal']}}};_0x51abd4[_0x28b5bb(0x218)][_0x28b5bb(0x1f4)](_0xafae1d);if(_0x51abd4['analysisHistory'][_0x28b5bb(0x26c)]>0x32)_0x51abd4[_0x28b5bb(0x218)][_0x28b5bb(0x279)]();await _0x51abd4[_0x28b5bb(0x1e9)](_0x28b5bb(0x1fe),{'val':JSON[_0x28b5bb(0x1e7)](_0x51abd4[_0x28b5bb(0x218)]),'ack':!![]});const _0x4f6c19=_0x12abe9[_0x28b5bb(0x21c)]||![];_0x4f6c19!==_0x51abd4[_0x28b5bb(0x26a)]&&(await _0x51abd4[_0x28b5bb(0x1e9)]('analysis.isAlert',{'val':_0x4f6c19,'ack':!![]}),_0x51abd4[_0x28b5bb(0x26a)]=_0x4f6c19,_0x4f6c19&&(await _0x51abd4[_0x28b5bb(0x1e9)]('analysis.alertReason',{'val':_0x12abe9[_0x28b5bb(0x239)],'ack':!![]}),setup[_0x28b5bb(0x210)](_0x51abd4,_0x28b5bb(0x1eb)+_0x12abe9[_0x28b5bb(0x239)],![],_0x12abe9['isEmergency'])));if(_0x12abe9['automationProposal']&&_0x12abe9[_0x28b5bb(0x22c)]['detected']){await _0x51abd4[_0x28b5bb(0x1e9)](_0x28b5bb(0x1e1),{'val':!![],'ack':!![]}),await _0x51abd4[_0x28b5bb(0x1e9)]('analysis.automation.description',{'val':_0x12abe9[_0x28b5bb(0x22c)][_0x28b5bb(0x229)],'ack':!![]}),await _0x51abd4[_0x28b5bb(0x1e9)](_0x28b5bb(0x20a),{'val':_0x12abe9[_0x28b5bb(0x22c)][_0x28b5bb(0x263)],'ack':!![]}),await _0x51abd4[_0x28b5bb(0x1e9)]('analysis.automation.targetValue',{'val':JSON[_0x28b5bb(0x1e7)](_0x12abe9[_0x28b5bb(0x22c)][_0x28b5bb(0x233)]),'ack':!![]});if(_0x46ed48)executeAutomationAction(_0x51abd4);}}catch(_0x1ff896){_0x51abd4[_0x28b5bb(0x232)][_0x28b5bb(0x223)]('Gemini\x20Error:\x20'+_0x1ff896[_0x28b5bb(0x25d)]);}}async function createDailyDigest(_0x3b960e,_0x4838e6){const _0x50a998=a0_0x24a37c;if(!_0x3b960e[_0x50a998(0x25e)])return;if(!canCallApi()){await _0x3b960e[_0x50a998(0x1e9)](LTM_DP_STATUS,{'val':_0x50a998(0x1ff),'ack':!![]});return;}await _0x3b960e[_0x50a998(0x1e9)](LTM_DP_STATUS,{'val':_0x50a998(0x242),'ack':!![]});if(!_0x3b960e[_0x50a998(0x24e)]||_0x3b960e[_0x50a998(0x277)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3b960e[_0x50a998(0x1e9)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0xf5483b=JSON[_0x50a998(0x27a)](JSON[_0x50a998(0x1e7)](_0x3b960e['rawEventLog'])),_0x2db18f=_0xf5483b['length'],_0x240a23=_0x50a998(0x26e)+JSON[_0x50a998(0x1e7)](_0xf5483b);try{updateApiTimestamp();const _0xaa7496=await _0x3b960e['geminiModel']['generateContent'](_0x240a23),_0x38fcd2=JSON[_0x50a998(0x27a)](_0xaa7496[_0x50a998(0x247)]['text']()[_0x50a998(0x267)](/```json|```/g,'')[_0x50a998(0x1f2)]()),_0x5588e8={'timestamp':new Date()[_0x50a998(0x1ea)](),'eventCount':_0x2db18f,'summary':_0x38fcd2[_0x50a998(0x1fd)]||'Digest','activityLevel':_0x38fcd2[_0x50a998(0x1f9)]||_0x50a998(0x249),'systemMode':_0x3b960e[_0x50a998(0x1fa)]};_0x3b960e['dailyDigests'][_0x50a998(0x219)](_0x5588e8);const _0x5b67f9=_0x3b960e[_0x50a998(0x264)]['ltmLtbWindowDays']||0x3c;_0x3b960e['dailyDigests']['length']>_0x5b67f9&&_0x3b960e['dailyDigests'][_0x50a998(0x266)](0x0,_0x3b960e[_0x50a998(0x23f)][_0x50a998(0x26c)]-_0x5b67f9);await _0x3b960e['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x50a998(0x1e7)](_0x3b960e['dailyDigests']),'ack':!![]}),_0x3b960e[_0x50a998(0x277)]=[],await _0x3b960e[_0x50a998(0x1e9)](LTM_DP_RAW_LOG,{'val':JSON[_0x50a998(0x1e7)](_0x3b960e[_0x50a998(0x277)]),'ack':!![]}),await _0x3b960e['setStateAsync'](LTM_DP_STATUS,{'val':'Success','ack':!![]});const _0x5ded16=_0x50a998(0x24b)+_0x38fcd2[_0x50a998(0x1fd)]+_0x50a998(0x1f0)+_0x38fcd2[_0x50a998(0x1f9)];setup[_0x50a998(0x210)](_0x3b960e,_0x5ded16,![],![]);if(_0x3b960e[_0x50a998(0x25e)]&&_0x4838e6)_0x4838e6[_0x50a998(0x244)](_0x3b960e,_0x50a998(0x259),{'digest':_0x5588e8});}catch(_0x371238){_0x3b960e['log'][_0x50a998(0x223)](_0x371238[_0x50a998(0x25d)]);}}async function runBaselineDriftAnalysis(_0x5782bd){const _0x4009d0=a0_0x24a37c;if(!_0x5782bd[_0x4009d0(0x25e)]||!_0x5782bd[_0x4009d0(0x24e)])return;if(!canCallApi())return;const _0x3371cd=_0x5782bd[_0x4009d0(0x264)][_0x4009d0(0x265)]||0xe;if(_0x5782bd['dailyDigests'][_0x4009d0(0x26c)]<_0x3371cd+0x7){await _0x5782bd[_0x4009d0(0x1e9)](_0x4009d0(0x1dc),{'val':_0x4009d0(0x257),'ack':!![]});return;}const _0x10904b=_0x5782bd[_0x4009d0(0x23f)]['slice'](-_0x3371cd),_0x59717f=_0x5782bd[_0x4009d0(0x23f)][_0x4009d0(0x235)](0x0,_0x5782bd[_0x4009d0(0x23f)][_0x4009d0(0x26c)]-_0x3371cd),_0x28502d=_0x4009d0(0x240)+JSON[_0x4009d0(0x1e7)](_0x59717f)+_0x4009d0(0x261)+JSON[_0x4009d0(0x1e7)](_0x10904b);try{updateApiTimestamp();const _0x137558=await _0x5782bd['geminiModel'][_0x4009d0(0x1fc)](_0x28502d),_0x77fedf=JSON['parse'](_0x137558[_0x4009d0(0x247)][_0x4009d0(0x1ec)]()[_0x4009d0(0x267)](/```json|```/g,'')[_0x4009d0(0x1f2)]());_0x77fedf[_0x4009d0(0x1de)]&&(await _0x5782bd[_0x4009d0(0x1e9)](_0x4009d0(0x1dc),{'val':_0x77fedf['baselineDrift'],'ack':!![]}),await _0x5782bd[_0x4009d0(0x1e9)](_0x4009d0(0x273),{'val':_0x77fedf[_0x4009d0(0x248)],'ack':!![]}),await _0x5782bd[_0x4009d0(0x1e9)](_0x4009d0(0x25f),{'val':Date[_0x4009d0(0x1d9)](),'ack':!![]}));}catch(_0x3d9dff){}}async function executeAutomationAction(_0x5277a2){const _0x32a7d6=a0_0x24a37c;try{const _0x4277d3=await _0x5277a2[_0x32a7d6(0x209)]('analysis.automation.targetId'),_0x4e6b68=await _0x5277a2[_0x32a7d6(0x209)](_0x32a7d6(0x1f5));if(_0x4277d3&&_0x4277d3[_0x32a7d6(0x1f6)]&&_0x4e6b68){const _0x665c64=_0x4277d3['val'];let _0x38eec0=_0x4e6b68[_0x32a7d6(0x1f6)];try{_0x38eec0=JSON[_0x32a7d6(0x27a)](_0x38eec0);}catch(_0x1cef1b){}_0x5277a2[_0x32a7d6(0x232)]['info'](_0x32a7d6(0x21f)+_0x665c64+_0x32a7d6(0x21b)+_0x38eec0),await _0x5277a2[_0x32a7d6(0x1ed)](_0x665c64,_0x38eec0);}else _0x5277a2[_0x32a7d6(0x232)]['warn'](_0x32a7d6(0x217));}catch(_0x2944ea){_0x5277a2[_0x32a7d6(0x232)]['error'](_0x32a7d6(0x1f1)+_0x2944ea[_0x32a7d6(0x25d)]);}}async function sendMorningBriefing(_0x569842){const _0x4ef82f=a0_0x24a37c;if(!_0x569842[_0x4ef82f(0x24e)]){_0x569842['log']['warn']('ü§ñ\x20Morning\x20Briefing\x20skipped:\x20No\x20Gemini\x20Model.');return;}_0x569842[_0x4ef82f(0x232)][_0x4ef82f(0x275)]('üåÖ\x20Starting\x20Morning\x20Briefing\x20sequence\x20(Traffic\x20Check\x20bypassed)...');try{updateApiTimestamp();const _0x35faa1=_0x4ef82f(0x22e),_0x37994c=await _0x569842[_0x4ef82f(0x24e)][_0x4ef82f(0x1fc)](_0x35faa1),_0x18763b=_0x37994c['response'][_0x4ef82f(0x1ec)]();_0x569842[_0x4ef82f(0x232)][_0x4ef82f(0x275)](_0x4ef82f(0x23c)+_0x18763b[_0x4ef82f(0x26c)]+_0x4ef82f(0x25c)),setup[_0x4ef82f(0x210)](_0x569842,_0x4ef82f(0x25a)+_0x18763b);}catch(_0x291528){_0x569842['log'][_0x4ef82f(0x223)](_0x4ef82f(0x1f3)+_0x291528[_0x4ef82f(0x25d)]);}}async function generateHealthReport(_0x48ade6,_0x28a75b){const _0x1597eb=a0_0x24a37c;if(!_0x48ade6[_0x1597eb(0x24e)])return;const _0x69a627=Date[_0x1597eb(0x1d9)]();_0x69a627-lastGlobalApiCall<0xbb8&&(_0x48ade6[_0x1597eb(0x232)][_0x1597eb(0x254)](_0x1597eb(0x224)),await new Promise(_0x46f1fc=>setTimeout(_0x46f1fc,0x7d0)));const _0x3ee99f=new Date();let _0x407d25=0x0,_0x5b1883=_0x3ee99f[_0x1597eb(0x1e6)](),_0x2412d8='';if(_0x28a75b===_0x1597eb(0x250)){const _0x5d6178=new Date(_0x3ee99f);_0x5d6178[_0x1597eb(0x20c)](_0x5d6178[_0x1597eb(0x220)]()-0x1),_0x5d6178['setHours'](0x16,0x0,0x0,0x0),_0x407d25=_0x5d6178['getTime']();const _0x13c2aa=new Date(_0x3ee99f);_0x13c2aa[_0x1597eb(0x221)](0x8,0x0,0x0,0x0),_0x5b1883=_0x13c2aa[_0x1597eb(0x1e6)](),_0x2412d8=_0x1597eb(0x258);}else{const _0x4687c2=new Date(_0x3ee99f);_0x4687c2['setHours'](0x8,0x0,0x0,0x0),_0x407d25=_0x4687c2['getTime'](),_0x2412d8=_0x1597eb(0x1ee);}const _0xce8790=_0x48ade6[_0x1597eb(0x274)][_0x1597eb(0x245)](_0x21e96a=>_0x21e96a[_0x1597eb(0x207)]>=_0x407d25&&_0x21e96a[_0x1597eb(0x207)]<=_0x5b1883);if(_0xce8790[_0x1597eb(0x26c)]===0x0){const _0x51e79a=_0x28a75b==='NIGHT'?_0x1597eb(0x24c):'Bisher\x20keine\x20Aktivit√§t\x20seit\x2008:00\x20Uhr\x20verzeichnet.',_0x2d8f5b=_0x28a75b===_0x1597eb(0x250)?'analysis.health.geminiNight':'analysis.health.geminiDay';await _0x48ade6[_0x1597eb(0x1e9)](_0x2d8f5b,{'val':_0x51e79a,'ack':!![]});return;}const _0xe9ba9d=_0xce8790[_0x1597eb(0x21a)](_0x4c42f2=>new Date(_0x4c42f2['timestamp'])[_0x1597eb(0x20b)]([],{'hour':'2-digit','minute':_0x1597eb(0x241)})+'\x20'+_0x4c42f2[_0x1597eb(0x269)]+'\x20('+_0x4c42f2[_0x1597eb(0x236)]+')')[_0x1597eb(0x226)]('\x0a'),_0x3b8901=_0x1597eb(0x230)+_0x2412d8+_0x1597eb(0x1e2)+_0xe9ba9d+'\x0a\x20\x20\x20\x20ANTWORT-STIL:\x20Sachlich,\x20beruhigend,\x20pr√§zise.\x20Keine\x20Floskeln.\x0a\x20\x20\x20\x20';try{updateApiTimestamp();const _0x3b6608=await _0x48ade6[_0x1597eb(0x24e)][_0x1597eb(0x1fc)](_0x3b8901),_0x5ce40a=_0x3b6608[_0x1597eb(0x247)][_0x1597eb(0x1ec)](),_0x4dc2e9=_0x28a75b==='NIGHT'?_0x1597eb(0x1e5):_0x1597eb(0x1ef);await _0x48ade6[_0x1597eb(0x1e9)](_0x4dc2e9,{'val':_0x5ce40a,'ack':!![]}),_0x48ade6[_0x1597eb(0x232)][_0x1597eb(0x275)](_0x1597eb(0x22f)+_0x28a75b+_0x1597eb(0x1db));}catch(_0x4f53dd){_0x48ade6['log'][_0x1597eb(0x223)](_0x1597eb(0x206)+_0x4f53dd['message']);}}module[a0_0x24a37c(0x228)]={'executeAutomationAction':executeAutomationAction,'createDailyDigest':createDailyDigest,'runBaselineDriftAnalysis':runBaselineDriftAnalysis,'sendMorningBriefing':sendMorningBriefing,'runGeminiAnalysis':runGeminiAnalysis,'consultButler':consultButler,'generateHealthReport':generateHealthReport};