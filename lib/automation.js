(function(_0x57e723,_0x5dd153){const _0x288945=a1_0x181c,_0x3cc4c7=_0x57e723();while(!![]){try{const _0x428c71=-parseInt(_0x288945(0x1f4))/0x1+-parseInt(_0x288945(0x204))/0x2*(-parseInt(_0x288945(0x1e4))/0x3)+-parseInt(_0x288945(0x1e1))/0x4+-parseInt(_0x288945(0x1f1))/0x5*(-parseInt(_0x288945(0x1e6))/0x6)+-parseInt(_0x288945(0x1fb))/0x7+-parseInt(_0x288945(0x203))/0x8+parseInt(_0x288945(0x1e9))/0x9;if(_0x428c71===_0x5dd153)break;else _0x3cc4c7['push'](_0x3cc4c7['shift']());}catch(_0x595e69){_0x3cc4c7['push'](_0x3cc4c7['shift']());}}}(a1_0x166e,0x9189c));function a1_0x166e(){const _0x24bb1d=['\x20->\x20Schalte\x20','dimmer','Unknown','off','57905AkJyKH','ðŸ”\x20Device-Search\x20failed:\x20Predicted\x20\x27','ðŸ‘€\x20SIMULATION:\x20','147248EunOfA','toLowerCase','PrÃ¤diktion:\x20','getStateAsync','setStateAsync','replace','[BLOCKED]\x20','562590MLUoAH','type','search','(((.+)+)+)+$','switch','ðŸ¤–\x20Butler\x20Blocked:\x20','constructor','now','7669752NRJFLm','4TXqgOz','\x27),\x20but\x20found\x20no\x20matching\x20light\x20device.','devices','apply','simulate','\x27\x20(norm:\x20\x27','setForeignStateAsync','getForeignStateAsync','analysis.automation.lastAction','toUpperCase','toString','reason','1521740cwfrRN','info','log','762573ldbKsK','config','582rZzOgm','trim','debug','4780413zgnKmd','val','analysis.automation.mode','\x20->\x20'];a1_0x166e=function(){return _0x24bb1d;};return a1_0x166e();}const a1_0x4b021d=(function(){let _0x58c515=!![];return function(_0x168836,_0x905e3d){const _0x5c966a=_0x58c515?function(){const _0x34ab3f=a1_0x181c;if(_0x905e3d){const _0x46be17=_0x905e3d[_0x34ab3f(0x207)](_0x168836,arguments);return _0x905e3d=null,_0x46be17;}}:function(){};return _0x58c515=![],_0x5c966a;};}()),a1_0x2d1823=a1_0x4b021d(this,function(){const _0x27c7c3=a1_0x181c;return a1_0x2d1823[_0x27c7c3(0x1df)]()['search'](_0x27c7c3(0x1fe))[_0x27c7c3(0x1df)]()[_0x27c7c3(0x201)](a1_0x2d1823)[_0x27c7c3(0x1fd)]('(((.+)+)+)+$');});a1_0x2d1823();'use strict';const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,lastActions={};function normalize(_0x15fe20){const _0x182084=a1_0x181c;if(!_0x15fe20)return'';return _0x15fe20[_0x182084(0x1f5)]()[_0x182084(0x1f9)](/\s+/g,'')[_0x182084(0x1e7)]();}function a1_0x181c(_0x2a476a,_0x4eb225){const _0x3d6081=a1_0x166e();return a1_0x181c=function(_0x2d1823,_0x4b021d){_0x2d1823=_0x2d1823-0x1dd;let _0x166e56=_0x3d6081[_0x2d1823];return _0x166e56;},a1_0x181c(_0x2a476a,_0x4eb225);}async function handlePrediction(_0x8a7ed5,_0x17d0dc,_0x22797b){const _0x2f9a54=a1_0x181c;if(!_0x17d0dc||_0x17d0dc===_0x2f9a54(0x1ef))return;let _0x8df845=_0x2f9a54(0x1f0),_0x8be16f=0.6;try{const _0x242d47=await _0x8a7ed5[_0x2f9a54(0x1f7)](_0x2f9a54(0x1eb));if(_0x242d47&&_0x242d47[_0x2f9a54(0x1ea)])_0x8df845=_0x242d47[_0x2f9a54(0x1ea)];const _0x5ad7df=await _0x8a7ed5['getStateAsync']('analysis.automation.confidenceThreshold');if(_0x5ad7df&&_0x5ad7df[_0x2f9a54(0x1ea)])_0x8be16f=_0x5ad7df[_0x2f9a54(0x1ea)];}catch(_0x515f56){}if(_0x8df845===_0x2f9a54(0x1f0))return;if(_0x22797b<_0x8be16f)return;const _0x2f5270=Date[_0x2f9a54(0x202)]();if(lastActions[_0x17d0dc]&&_0x2f5270-lastActions[_0x17d0dc]<COOLDOWN_MS)return;const _0x1284b6=_0x8a7ed5[_0x2f9a54(0x1e5)][_0x2f9a54(0x206)]||[],_0x27c1ea=normalize(_0x17d0dc),_0x4a51f1=_0x1284b6['find'](_0x30a193=>{const _0x34233a=_0x2f9a54;return normalize(_0x30a193['location'])===_0x27c1ea&&(_0x30a193['type']==='light'||_0x30a193[_0x34233a(0x1fc)]===_0x34233a(0x1ee)||_0x30a193['type']===_0x34233a(0x1ff));});if(!_0x4a51f1){const _0x475949=_0x2f9a54(0x1f2)+_0x17d0dc+_0x2f9a54(0x209)+_0x27c1ea+_0x2f9a54(0x205);_0x8a7ed5[_0x2f9a54(0x1e3)][_0x2f9a54(0x1e8)](_0x475949);return;}const _0x4d5605=await aiAgent['consultButler'](_0x8a7ed5,_0x17d0dc,_0x4a51f1['name'],_0x22797b);if(!_0x4d5605['approved']){_0x8a7ed5[_0x2f9a54(0x1e3)]['debug'](_0x2f9a54(0x200)+_0x17d0dc+_0x2f9a54(0x1ec)+_0x4d5605[_0x2f9a54(0x1e0)]),await _0x8a7ed5[_0x2f9a54(0x1f8)]('analysis.automation.lastAction',{'val':_0x2f9a54(0x1fa)+_0x4d5605[_0x2f9a54(0x1e0)],'ack':!![]});return;}const _0x2e0126=_0x2f9a54(0x1f6)+_0x17d0dc+_0x2f9a54(0x1ed)+_0x4a51f1['name']+'\x20('+_0x4d5605[_0x2f9a54(0x1e0)]+')';await _0x8a7ed5[_0x2f9a54(0x1f8)](_0x2f9a54(0x1dd),{'val':'['+_0x8df845[_0x2f9a54(0x1de)]()+']\x20'+_0x2e0126,'ack':!![]});if(_0x8df845===_0x2f9a54(0x208))_0x8a7ed5['log']['info'](_0x2f9a54(0x1f3)+_0x2e0126);else{if(_0x8df845==='active'){_0x8a7ed5['log'][_0x2f9a54(0x1e2)]('âš¡\x20ACTION:\x20'+_0x2e0126);const _0x47855c=await _0x8a7ed5[_0x2f9a54(0x20b)](_0x4a51f1['id']);if(_0x47855c&&(_0x47855c['val']===!![]||_0x47855c['val']>0x0)){}else await _0x8a7ed5[_0x2f9a54(0x20a)](_0x4a51f1['id'],!![]);lastActions[_0x17d0dc]=_0x2f5270;}}}module['exports']={'handlePrediction':handlePrediction};