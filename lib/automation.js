function a1_0x3356(){const _0x268c83=['valveMapping','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27','setStateAsync','\x20erreicht\x20Limit\x20(','splice','\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.','common','info','¬∞C!\x20(Puffer:\x20','.1.ACTUAL_TEMPERATURE','state','map','abs','default','light','error','25316MBRpmq','valve_position','messwert','message','localeCompare','¬∞C).\x20Entferne\x20Status.','occupied_heating_setpoint','forEach','room','unit','current_heating_setpoint','.4.SET_TEMPERATURE','calendarInstance','¬∞C\x20(via\x20','_date','1305237GhRFSC','¬∞C).\x20Sparmodus\x20beendet!','\x20->\x20','üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20','.data.table','pi_heating_demand','apply','currentSystemMode','getForeignStateAsync','summary','log','üö®\x20[MPC\x20WATCHDOG]\x20','useCalendar','devices','remove','Fehlt','constructor','üßπ\x20[MPC\x20CLEANUP]\x20','Nicht\x20gefunden','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','split','¬∞C\x20->\x20','valve','findIndex','triggerTime','val','617105vmmXnf','temp','actual','getStateAsync','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','analysis.energy.warmupTimes','approved','analysis.energy.rlPenalties','¬∞C\x20(Kalender-Schutz)','sendToPythonWrapper','off','number','8777484yGicSc','\x20->\x20Schalte\x20','add','temperature','analysis.automation.confidenceThreshold','level.valve','PERFECT','exports','\x20min)','analysis.energy.schedulePreview',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','filter','getForeignObjectsAsync','Unbekannt','ACTUAL','getForeignObjectAsync','toString','target_temperature','target','üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','getHours','analysis.energy.mpcActiveInterventions','8xjcobr','indexOf','thermostatMapping','switch','parse','üìÖ\x20[MPC\x20INFO]\x20','toLowerCase','sort','values','wert','Soll','(((.+)+)+)+$','üî•\x20[MPC\x20ACTION]\x20Heize\x20','hm-rpc','push','ACTUAL_TEMPERATURE','date','config','.1.TEMPERATURE','window','score','event','includes','.1.SET_POINT_TEMPERATURE','_meta','string','2Afipnn','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20','_calName','calendarSelection','toUpperCase','too_cold','dimmer','¬∞C.','soll','\x20min).','unshift','\x20gefunden!','\x20auf\x20','write','slice','SET','local_temperature','replace',')\x20aktiv.\x20Heize\x20auf\x20','level','setpoint','value.valve','length','isArray','position','open','5517486ZhXDLj','cal_','search','minutes_safe','ankunft','role','stringify','3256110WwUbNn','stellwert','\x20wurde\x20manuell\x20erh√∂ht.','Ist','warn','[CAL]\x20','¬∞C\x20(nicht\x20','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','name','until','analysis.energy.activeEnforcements','¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20','üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','analysis.energy.warmupTargets','2711821JyKkOa','.4.VALVE_STATE','analysis.automation.mode','analysis.automation.lastAction','location','Enforcement\x20Monitor\x20Error:\x20','getTime','now','thermostat','setForeignStateAsync','üìÖ\x20SMART\x20SCHEDULE\x20[','urlaub\x20ende','join','Pr√§diktion:\x20','.1.LEVEL','Unknown','8QMgXBJ','sensor',']:\x20Raum-Trigger\x20\x27','normal','find','from','Auto-Erkennung','reason','¬∞C\x20<\x20','manual','type','üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','r√ºckkehr','entries','mpc_','[MPC]\x20','rescue_','\x20wieder\x20auf\x20'];a1_0x3356=function(){return _0x268c83;};return a1_0x3356();}const a1_0x532c53=a1_0x3294;(function(_0x53fba3,_0x26976a){const _0x1f7931=a1_0x3294,_0xd130ab=_0x53fba3();while(!![]){try{const _0x41919f=parseInt(_0x1f7931(0x1ae))/0x1*(-parseInt(_0x1f7931(0x20f))/0x2)+parseInt(_0x1f7931(0x21e))/0x3+parseInt(_0x1f7931(0x1ed))/0x4*(parseInt(_0x1f7931(0x172))/0x5)+parseInt(_0x1f7931(0x1c8))/0x6+parseInt(_0x1f7931(0x1dd))/0x7*(-parseInt(_0x1f7931(0x194))/0x8)+-parseInt(_0x1f7931(0x17e))/0x9+parseInt(_0x1f7931(0x1cf))/0xa;if(_0x41919f===_0x26976a)break;else _0xd130ab['push'](_0xd130ab['shift']());}catch(_0x288259){_0xd130ab['push'](_0xd130ab['shift']());}}}(a1_0x3356,0x839ee));const a1_0x1b0f19=(function(){let _0x4ecaf9=!![];return function(_0x556934,_0x1e8a09){const _0x4aa3b8=_0x4ecaf9?function(){const _0x142812=a1_0x3294;if(_0x1e8a09){const _0x2060d3=_0x1e8a09[_0x142812(0x224)](_0x556934,arguments);return _0x1e8a09=null,_0x2060d3;}}:function(){};return _0x4ecaf9=![],_0x4aa3b8;};}()),a1_0x540bcf=a1_0x1b0f19(this,function(){const _0x57c57d=a1_0x3294;return a1_0x540bcf[_0x57c57d(0x18e)]()[_0x57c57d(0x1ca)](_0x57c57d(0x19f))[_0x57c57d(0x18e)]()[_0x57c57d(0x22e)](a1_0x540bcf)['search'](_0x57c57d(0x19f));});a1_0x540bcf();'use strict';const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x42a486){const _0x314a05=a1_0x3294;if(!_0x42a486)return'';return _0x42a486[_0x314a05(0x19a)]()['replace'](/\s+/g,'')['trim']();}function getWarmupRobust(_0x12442e,_0xc11d32){const _0x33f75b=a1_0x3294;if(!_0x12442e||!_0xc11d32)return 0x3c;if(_0x12442e[_0xc11d32]!==undefined)return _0x12442e[_0xc11d32];const _0x50b388=_0xc11d32[_0x33f75b(0x19a)]()[_0x33f75b(0x1bf)](/√§/g,'ae')[_0x33f75b(0x1bf)](/√∂/g,'oe')[_0x33f75b(0x1bf)](/√º/g,'ue')[_0x33f75b(0x1bf)](/√ü/g,'ss')[_0x33f75b(0x1bf)](/\s+/g,'_')['replace'](/[^a-z0-9_]/g,'');if(_0x12442e[_0x50b388]!==undefined)return _0x12442e[_0x50b388];return 0x3c;}async function logAutomationAction(_0x1ee047,_0x1def3c){const _0x46e314=a1_0x3294;await _0x1ee047[_0x46e314(0x201)](_0x46e314(0x1e0),{'val':_0x1def3c,'ack':!![]});try{const _0x4b5fe6='analysis.automation.actionLog',_0x8ee10f=await _0x1ee047['getStateAsync'](_0x4b5fe6);let _0x27f236=[];if(_0x8ee10f&&_0x8ee10f['val'])try{_0x27f236=JSON[_0x46e314(0x198)](_0x8ee10f['val']);}catch(_0x1fd6dc){}_0x27f236[_0x46e314(0x1b8)]({'ts':Date[_0x46e314(0x1e4)](),'msg':_0x1def3c});if(_0x27f236[_0x46e314(0x1c4)]>0x32)_0x27f236=_0x27f236['slice'](0x0,0x32);await _0x1ee047[_0x46e314(0x201)](_0x4b5fe6,{'val':JSON['stringify'](_0x27f236),'ack':!![]});}catch(_0x32896e){}}async function handlePrediction(_0x332430,_0x1a493c,_0x555195){const _0x3e3190=a1_0x3294;if(!_0x1a493c||_0x1a493c===_0x3e3190(0x1ec))return;let _0x3e680=_0x3e3190(0x17c),_0x12e542=0.6;try{const _0x2d4767=await _0x332430[_0x3e3190(0x175)](_0x3e3190(0x1df));if(_0x2d4767&&_0x2d4767['val'])_0x3e680=_0x2d4767[_0x3e3190(0x171)];const _0x1fe55a=await _0x332430[_0x3e3190(0x175)](_0x3e3190(0x182));if(_0x1fe55a&&_0x1fe55a[_0x3e3190(0x171)])_0x12e542=_0x1fe55a[_0x3e3190(0x171)];}catch(_0xac0ee2){}if(_0x3e680===_0x3e3190(0x17c)||_0x555195<_0x12e542)return;const _0x468629=Date['now']();if(lastActions[_0x1a493c]&&_0x468629-lastActions[_0x1a493c]<COOLDOWN_MS)return;const _0x56b2f6=_0x332430['config']['devices']||[],_0x1df9d7=normalize(_0x1a493c),_0x482e70=_0x56b2f6[_0x3e3190(0x1f1)](_0x3dc825=>normalize(_0x3dc825[_0x3e3190(0x1e1)])===_0x1df9d7&&(_0x3dc825[_0x3e3190(0x1f7)]===_0x3e3190(0x20d)||_0x3dc825[_0x3e3190(0x1f7)]===_0x3e3190(0x1b4)||_0x3dc825[_0x3e3190(0x1f7)]===_0x3e3190(0x197)));if(!_0x482e70)return;const _0x2d07ae=await aiAgent['consultButler'](_0x332430,_0x1a493c,_0x482e70[_0x3e3190(0x1d7)],_0x555195);if(!_0x2d07ae[_0x3e3190(0x178)])return;const _0x35f49b=_0x3e3190(0x1ea)+_0x1a493c+_0x3e3190(0x17f)+_0x482e70[_0x3e3190(0x1d7)]+'\x20('+_0x2d07ae[_0x3e3190(0x1f4)]+')';await logAutomationAction(_0x332430,'['+_0x3e680[_0x3e3190(0x1b2)]()+']\x20'+_0x35f49b);if(_0x3e680==='active'){const _0x460fc3=await _0x332430[_0x3e3190(0x226)](_0x482e70['id']);(!_0x460fc3||!_0x460fc3[_0x3e3190(0x171)]&&_0x460fc3[_0x3e3190(0x171)]!==!![])&&await _0x332430['setForeignStateAsync'](_0x482e70['id'],!![]),lastActions[_0x1a493c]=_0x468629;}}async function findRelatedId(_0x4c12d5,_0x49c6f1,_0x3c0bd3=a1_0x532c53(0x1c2)){const _0xf34b1e=a1_0x532c53;if(_0x3c0bd3===_0xf34b1e(0x1c2)&&_0x4c12d5[_0xf34b1e(0x1a5)][_0xf34b1e(0x196)]){let _0xd23e18=_0x4c12d5['config'][_0xf34b1e(0x196)];if(typeof _0xd23e18===_0xf34b1e(0x1ad))try{_0xd23e18=JSON[_0xf34b1e(0x198)](_0xd23e18);}catch(_0x2ae760){}if(_0xd23e18&&_0xd23e18[_0x49c6f1])return _0xd23e18[_0x49c6f1];}if(_0x3c0bd3===_0xf34b1e(0x16e)&&_0x4c12d5['config'][_0xf34b1e(0x1ff)]){let _0x14723f=_0x4c12d5[_0xf34b1e(0x1a5)][_0xf34b1e(0x1ff)];if(typeof _0x14723f===_0xf34b1e(0x1ad))try{_0x14723f=JSON[_0xf34b1e(0x198)](_0x14723f);}catch(_0x5cc760){}if(_0x14723f&&_0x14723f[_0x49c6f1])return _0x14723f[_0x49c6f1];}let _0x2fb40f=[];if(_0x3c0bd3==='setpoint')_0x2fb40f=[{'s':_0xf34b1e(0x208),'t':'.1.SET_POINT_TEMPERATURE'},{'s':'.1.TEMPERATURE','t':_0xf34b1e(0x1ab)},{'s':_0xf34b1e(0x1a6),'t':_0xf34b1e(0x21a)},{'s':_0xf34b1e(0x1a3),'t':'SET_POINT_TEMPERATURE'},{'s':_0xf34b1e(0x1be),'t':_0xf34b1e(0x215)},{'s':_0xf34b1e(0x1be),'t':_0xf34b1e(0x219)},{'s':_0xf34b1e(0x181),'t':_0xf34b1e(0x18f)},{'s':_0xf34b1e(0x18c),'t':_0xf34b1e(0x1bd)},{'s':_0xf34b1e(0x1d2),'t':_0xf34b1e(0x19e)},{'s':_0xf34b1e(0x181),'t':'setpoint'}];else _0x3c0bd3===_0xf34b1e(0x16e)&&(_0x2fb40f=[{'s':_0xf34b1e(0x208),'t':_0xf34b1e(0x1eb)},{'s':'.1.TEMPERATURE','t':_0xf34b1e(0x1eb)},{'s':_0xf34b1e(0x1a6),'t':_0xf34b1e(0x1de)},{'s':_0xf34b1e(0x1be),'t':_0xf34b1e(0x223)},{'s':_0xf34b1e(0x181),'t':_0xf34b1e(0x210)},{'s':_0xf34b1e(0x181),'t':_0xf34b1e(0x1c1)}]);for(const _0x3a4fd5 of _0x2fb40f){if(_0x49c6f1[_0xf34b1e(0x1aa)](_0x3a4fd5['s'])){const _0x5b5839=_0x49c6f1['replace'](_0x3a4fd5['s'],_0x3a4fd5['t']),_0x52a658=await _0x4c12d5[_0xf34b1e(0x18d)](_0x5b5839);if(_0x52a658)return _0x5b5839;}}try{const _0x5d94ac=_0x49c6f1[_0xf34b1e(0x16c)]('.');if(_0x5d94ac[_0xf34b1e(0x1c4)]>0x2){const _0x320d72=_0x5d94ac[_0xf34b1e(0x1bc)](0x0,-0x1)[_0xf34b1e(0x1e9)]('.'),_0x533c26=await _0x4c12d5[_0xf34b1e(0x18a)](_0x320d72+'.*'),_0x3ff124=[],_0x16037e=_0x49c6f1[_0xf34b1e(0x16c)](/[._]+/)['filter'](_0x31b6df=>!['openknx','0',_0xf34b1e(0x1a1),'ist',_0xf34b1e(0x19d),_0xf34b1e(0x181),_0xf34b1e(0x174),_0xf34b1e(0x1ee),_0xf34b1e(0x211),_0xf34b1e(0x209)][_0xf34b1e(0x1aa)](_0x31b6df[_0xf34b1e(0x19a)]()));for(const [_0x5ab586,_0x2db936]of Object[_0xf34b1e(0x1fa)](_0x533c26)){if(_0x5ab586===_0x49c6f1)continue;if(_0x2db936&&_0x2db936['common']){const _0xe67fba=_0x5ab586[_0xf34b1e(0x19a)](),_0x58ae31=(_0x2db936[_0xf34b1e(0x205)][_0xf34b1e(0x1cd)]||'')[_0xf34b1e(0x19a)](),_0x162b6b=(_0x2db936[_0xf34b1e(0x205)][_0xf34b1e(0x218)]||'')['toLowerCase']();let _0x12171c=![];if(_0x3c0bd3==='setpoint'&&_0x2db936[_0xf34b1e(0x205)][_0xf34b1e(0x1bb)]===!![])_0x12171c=_0xe67fba[_0xf34b1e(0x1aa)]('set')||_0xe67fba['includes'](_0xf34b1e(0x1b6))||_0xe67fba[_0xf34b1e(0x1aa)]('target')||_0x58ae31[_0xf34b1e(0x1aa)]('level.temperature')||_0x58ae31['includes']('thermostat.setpoint');else _0x3c0bd3===_0xf34b1e(0x16e)&&(_0x12171c=_0xe67fba[_0xf34b1e(0x1aa)](_0xf34b1e(0x1c1))||_0xe67fba[_0xf34b1e(0x1aa)](_0xf34b1e(0x16e))||_0xe67fba[_0xf34b1e(0x1aa)](_0xf34b1e(0x1d0))||_0xe67fba[_0xf34b1e(0x1aa)](_0xf34b1e(0x1c6))||_0x58ae31[_0xf34b1e(0x1aa)](_0xf34b1e(0x183))||_0x58ae31['includes'](_0xf34b1e(0x1c3))||_0x162b6b['includes']('%'));if(_0x12171c){const _0x413595=_0x5ab586[_0xf34b1e(0x16c)](/[._]+/)[_0xf34b1e(0x20a)](_0x22db9b=>_0x22db9b[_0xf34b1e(0x19a)]());let _0x54b8a2=0x0;_0x16037e[_0xf34b1e(0x216)](_0x5c8426=>{const _0x39d1b1=_0xf34b1e;if(_0x413595[_0x39d1b1(0x1aa)](_0x5c8426[_0x39d1b1(0x19a)]()))_0x54b8a2++;}),_0x3ff124[_0xf34b1e(0x1a2)]({'id':_0x5ab586,'score':_0x54b8a2});}}}if(_0x3ff124[_0xf34b1e(0x1c4)]>0x0){_0x3ff124[_0xf34b1e(0x19b)]((_0x2f4570,_0x1191be)=>_0x1191be[_0xf34b1e(0x1a8)]-_0x2f4570[_0xf34b1e(0x1a8)]);if(_0x3ff124[0x0][_0xf34b1e(0x1a8)]>0x0)return _0x3ff124[0x0]['id'];}}}catch(_0x400137){}return null;}async function scanThermostats(_0x4888de){const _0x3fac0a=a1_0x532c53,_0x3928a7=_0x4888de[_0x3fac0a(0x1a5)][_0x3fac0a(0x22b)]||[],_0x8d9f67=[],_0x1d7321=_0x3928a7[_0x3fac0a(0x189)](_0x3b4be6=>_0x3b4be6['id']&&_0x3b4be6['id'][_0x3fac0a(0x1aa)](_0x3fac0a(0x181))||_0x3b4be6[_0x3fac0a(0x1f7)]&&[_0x3fac0a(0x181),_0x3fac0a(0x1e5),'sensor']['includes'](_0x3b4be6['type'])||_0x3b4be6[_0x3fac0a(0x1d7)]&&_0x3b4be6[_0x3fac0a(0x1d7)][_0x3fac0a(0x19a)]()[_0x3fac0a(0x1aa)](_0x3fac0a(0x173)));for(const _0x446b75 of _0x1d7321){const _0x43c55d=await findRelatedId(_0x4888de,_0x446b75['id'],_0x3fac0a(0x1c2)),_0x4cf8c6=await findRelatedId(_0x4888de,_0x446b75['id'],_0x3fac0a(0x16e));let _0x5c3bbe=_0x3fac0a(0x16a),_0xfa217e=![],_0x314752=_0x4888de['config'][_0x3fac0a(0x196)]||{};if(typeof _0x314752===_0x3fac0a(0x1ad))try{_0x314752=JSON[_0x3fac0a(0x198)](_0x314752);}catch(_0x46150b){}let _0x528889=_0x4888de[_0x3fac0a(0x1a5)][_0x3fac0a(0x1ff)]||{};if(typeof _0x528889==='string')try{_0x528889=JSON[_0x3fac0a(0x198)](_0x528889);}catch(_0x10aac0){}if(_0x314752[_0x446b75['id']]&&_0x314752[_0x446b75['id']]===_0x43c55d||_0x528889[_0x446b75['id']]&&_0x528889[_0x446b75['id']]===_0x4cf8c6)_0x5c3bbe='Manuelles\x20Mapping',_0xfa217e=!![];else(_0x43c55d||_0x4cf8c6)&&(_0x5c3bbe=_0x3fac0a(0x1f3));_0x8d9f67[_0x3fac0a(0x1a2)]({'room':_0x446b75[_0x3fac0a(0x1e1)]||_0x3fac0a(0x18b),'sensorId':_0x446b75['id'],'setpointId':_0x43c55d||'-','valveId':_0x4cf8c6||'-','source':_0x5c3bbe,'isManual':_0xfa217e,'status':_0x43c55d&&_0x4cf8c6?_0x3fac0a(0x184):_0x43c55d?'OK':_0x3fac0a(0x22d)});}return _0x8d9f67[_0x3fac0a(0x19b)]((_0x414dda,_0x2e4754)=>_0x414dda[_0x3fac0a(0x217)][_0x3fac0a(0x213)](_0x2e4754[_0x3fac0a(0x217)]));}async function updateSchedulePreview(_0x4e8260){const _0x1a5e50=a1_0x532c53;if(!_0x4e8260[_0x1a5e50(0x1a5)][_0x1a5e50(0x22a)]||!_0x4e8260[_0x1a5e50(0x1a5)][_0x1a5e50(0x21b)])return;let _0x16e622={};try{const _0x512aff=await _0x4e8260[_0x1a5e50(0x175)]('analysis.energy.warmupTimes');if(_0x512aff&&_0x512aff['val'])_0x16e622=JSON[_0x1a5e50(0x198)](_0x512aff[_0x1a5e50(0x171)]);}catch(_0x20dcb5){}const _0x2e39f4=[],_0x533998=Date[_0x1a5e50(0x1e4)](),_0x11de65=0x30*0x3c*0x3c*0x3e8;try{const _0x543516=await _0x4e8260[_0x1a5e50(0x226)](_0x4e8260[_0x1a5e50(0x1a5)][_0x1a5e50(0x21b)]+_0x1a5e50(0x222));if(!_0x543516||!_0x543516[_0x1a5e50(0x171)])return;const _0x56d58c=JSON[_0x1a5e50(0x198)](_0x543516[_0x1a5e50(0x171)]),_0x4691f6=_0x4e8260['config']['calendarSelection']||[],_0x1c9706=_0x4e8260[_0x1a5e50(0x1a5)]['devices']||[],_0x35c4d6=new Set();_0x1c9706[_0x1a5e50(0x216)](_0x14df3d=>{const _0x2db786=_0x1a5e50;if(_0x14df3d[_0x2db786(0x1e1)])_0x35c4d6[_0x2db786(0x180)](_0x14df3d[_0x2db786(0x1e1)]);});for(const _0x2e3696 of _0x56d58c){if(_0x2e3696['_calName']&&_0x4691f6[_0x1a5e50(0x1c4)]>0x0&&!_0x4691f6[_0x1a5e50(0x1aa)](_0x2e3696[_0x1a5e50(0x1b0)]))continue;const _0x12a490=_0x2e3696[_0x1a5e50(0x21d)]||_0x2e3696['eventStart']||_0x2e3696[_0x1a5e50(0x1a4)];if(!_0x12a490)continue;const _0xb8e342=new Date(_0x12a490),_0x1cc9c9=_0xb8e342[_0x1a5e50(0x1e3)]();if(isNaN(_0x1cc9c9))continue;if(_0x1cc9c9<_0x533998)continue;if(_0x1cc9c9>_0x533998+_0x11de65)continue;const _0x246b6b=(_0x2e3696['event']||_0x2e3696['summary']||'')[_0x1a5e50(0x19a)]();let _0x7ed344=![],_0x326b6a=[],_0x507e9c=_0x2e3696[_0x1a5e50(0x1a9)]||_0x2e3696[_0x1a5e50(0x227)]||'Unbekannt';if(_0x246b6b[_0x1a5e50(0x1aa)](_0x1a5e50(0x1e8))||_0x246b6b[_0x1a5e50(0x1aa)](_0x1a5e50(0x1f9))||_0x246b6b[_0x1a5e50(0x1aa)](_0x1a5e50(0x1cc)))_0x7ed344=!![],_0x326b6a=Array[_0x1a5e50(0x1f2)](_0x35c4d6);else for(const _0x519d72 of _0x35c4d6){if(_0x246b6b[_0x1a5e50(0x1aa)](_0x519d72['toLowerCase']()))_0x326b6a[_0x1a5e50(0x1a2)](_0x519d72);}_0x326b6a['length']>0x0&&_0x326b6a['forEach'](_0x35c4d9=>{const _0x485e3b=_0x1a5e50;let _0x5389f5=0x3c;if(_0x7ed344){let _0x16e7dd=0x0;Object[_0x485e3b(0x19c)](_0x16e622)[_0x485e3b(0x216)](_0x5df9ce=>{if(_0x5df9ce>_0x16e7dd)_0x16e7dd=_0x5df9ce;}),_0x5389f5=_0x16e7dd>0x0?_0x16e7dd:0x78;}else _0x5389f5=getWarmupRobust(_0x16e622,_0x35c4d9);const _0x139958=new Date(_0x1cc9c9-_0x5389f5*0xea60);_0x2e39f4[_0x485e3b(0x1a2)]({'eventTime':_0x1cc9c9,'triggerTime':_0x139958['getTime'](),'room':_0x35c4d9,'minutes':_0x5389f5,'reason':_0x507e9c,'isGlobal':_0x7ed344});});}}catch(_0x387379){}_0x2e39f4[_0x1a5e50(0x19b)]((_0x18aa28,_0x46117a)=>_0x18aa28[_0x1a5e50(0x170)]-_0x46117a[_0x1a5e50(0x170)]);const _0x2d76d0=_0x2e39f4['slice'](0x0,0x1e);await _0x4e8260[_0x1a5e50(0x201)](_0x1a5e50(0x187),{'val':JSON['stringify'](_0x2d76d0),'ack':!![]});}async function monitorEnforcements(_0x15212c){const _0x4fc126=a1_0x532c53;try{const _0x31b74c=_0x4fc126(0x1d9),_0x24a06b=await _0x15212c[_0x4fc126(0x175)](_0x31b74c);if(!_0x24a06b||!_0x24a06b[_0x4fc126(0x171)])return;let _0x49d00a=[];try{_0x49d00a=JSON[_0x4fc126(0x198)](_0x24a06b['val']);}catch(_0x229124){return;}if(!Array[_0x4fc126(0x1c5)](_0x49d00a)||_0x49d00a['length']===0x0)return;const _0x2670c1=Date[_0x4fc126(0x1e4)](),_0x425113=_0x15212c[_0x4fc126(0x1a5)][_0x4fc126(0x22b)]||[];let _0x2b3d33=![];for(let _0x1f32f5=_0x49d00a['length']-0x1;_0x1f32f5>=0x0;_0x1f32f5--){const _0x4e16e0=_0x49d00a[_0x1f32f5];if(_0x2670c1>=_0x4e16e0[_0x4fc126(0x1d8)]){_0x15212c['log'][_0x4fc126(0x206)](_0x4fc126(0x191)+_0x4e16e0[_0x4fc126(0x217)]+'\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.'),_0x49d00a[_0x4fc126(0x203)](_0x1f32f5,0x1),_0x2b3d33=!![];continue;}const _0x3f34c8=_0x425113[_0x4fc126(0x1f1)](_0x479e92=>normalize(_0x479e92[_0x4fc126(0x1e1)])===normalize(_0x4e16e0[_0x4fc126(0x217)])&&(_0x479e92[_0x4fc126(0x1f7)]===_0x4fc126(0x181)||_0x479e92[_0x4fc126(0x1f7)]==='thermostat'));if(_0x3f34c8){const _0xd4f7f9=await findRelatedId(_0x15212c,_0x3f34c8['id'],'setpoint');if(_0xd4f7f9){const _0x4b3004=await _0x15212c[_0x4fc126(0x226)](_0xd4f7f9);_0x4b3004&&typeof _0x4b3004['val']===_0x4fc126(0x17d)&&(_0x4b3004['val']<0xf&&(_0x15212c[_0x4fc126(0x228)]['warn']('üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20'+_0x4e16e0[_0x4fc126(0x217)]+_0x4fc126(0x1ba)+_0x4b3004[_0x4fc126(0x171)]+_0x4fc126(0x1da)+_0x4e16e0[_0x4fc126(0x190)]+_0x4fc126(0x1b5)),await _0x15212c[_0x4fc126(0x1e6)](_0xd4f7f9,_0x4e16e0[_0x4fc126(0x190)]),await logAutomationAction(_0x15212c,'[FORCE]\x20'+_0x4e16e0[_0x4fc126(0x217)]+':\x20'+_0x4b3004['val']+_0x4fc126(0x16d)+_0x4e16e0[_0x4fc126(0x190)]+_0x4fc126(0x17a))));}}}_0x2b3d33&&await _0x15212c[_0x4fc126(0x201)](_0x31b74c,{'val':JSON[_0x4fc126(0x1ce)](_0x49d00a),'ack':!![]});}catch(_0x29e15e){_0x15212c[_0x4fc126(0x228)][_0x4fc126(0x20e)](_0x4fc126(0x1e2)+_0x29e15e['message']);}}function a1_0x3294(_0x43ef8a,_0x2294e0){const _0x33334d=a1_0x3356();return a1_0x3294=function(_0x540bcf,_0x1b0f19){_0x540bcf=_0x540bcf-0x16a;let _0x335659=_0x33334d[_0x540bcf];return _0x335659;},a1_0x3294(_0x43ef8a,_0x2294e0);}async function checkCalendarTriggers(_0x1f9209){const _0x23664a=a1_0x532c53;if(!_0x1f9209[_0x23664a(0x1a5)][_0x23664a(0x22a)]||!_0x1f9209['config']['calendarInstance'])return;await updateSchedulePreview(_0x1f9209);let _0x23ac91={},_0x1a7ede={};try{const _0x15c938=await _0x1f9209[_0x23664a(0x175)](_0x23664a(0x177));if(_0x15c938&&_0x15c938[_0x23664a(0x171)])_0x23ac91=JSON[_0x23664a(0x198)](_0x15c938['val']);const _0xe56e0e=await _0x1f9209[_0x23664a(0x175)]('analysis.energy.warmupSources');if(_0xe56e0e&&_0xe56e0e[_0x23664a(0x171)])_0x1a7ede=JSON[_0x23664a(0x198)](_0xe56e0e[_0x23664a(0x171)]);}catch(_0x3461de){}let _0x20d742={'default':0x15};try{const _0x1a847a=await _0x1f9209[_0x23664a(0x175)](_0x23664a(0x1dc));if(_0x1a847a&&_0x1a847a[_0x23664a(0x171)])_0x20d742=JSON[_0x23664a(0x198)](_0x1a847a['val']);}catch(_0x4e58cf){}let _0x47eb4f=[];try{const _0x261b99=await _0x1f9209[_0x23664a(0x175)]('analysis.energy.activeEnforcements');if(_0x261b99&&_0x261b99[_0x23664a(0x171)])_0x47eb4f=JSON[_0x23664a(0x198)](_0x261b99['val']);}catch(_0xde6f1a){}try{const _0x160ce6=await _0x1f9209[_0x23664a(0x226)](_0x1f9209['config'][_0x23664a(0x21b)]+_0x23664a(0x222));if(!_0x160ce6||!_0x160ce6[_0x23664a(0x171)])return;const _0x2be0e6=JSON[_0x23664a(0x198)](_0x160ce6[_0x23664a(0x171)]),_0x373122=Date[_0x23664a(0x1e4)](),_0x1c2e7f=_0x1f9209['config'][_0x23664a(0x22b)]||[],_0x2b8ce6=_0x1f9209[_0x23664a(0x1a5)][_0x23664a(0x1b1)]||[];let _0x1ade2b=![];for(const _0x41a6e8 of _0x2be0e6){if(_0x41a6e8[_0x23664a(0x1b0)]&&_0x2b8ce6[_0x23664a(0x1c4)]>0x0&&!_0x2b8ce6[_0x23664a(0x1aa)](_0x41a6e8['_calName']))continue;const _0x2a9153=_0x41a6e8[_0x23664a(0x21d)]||_0x41a6e8['eventStart']||_0x41a6e8['date'];if(!_0x2a9153)continue;const _0x4c9bc3=new Date(_0x2a9153);if(isNaN(_0x4c9bc3['getTime']()))continue;const _0x92bcb2=(_0x41a6e8[_0x23664a(0x1a9)]||_0x41a6e8[_0x23664a(0x227)]||'')['toLowerCase']();if(_0x92bcb2[_0x23664a(0x1aa)](_0x23664a(0x1e8))||_0x92bcb2[_0x23664a(0x1aa)](_0x23664a(0x1f9))||_0x92bcb2[_0x23664a(0x1aa)]('ankunft')){let _0x11603c=0x0;Object[_0x23664a(0x19c)](_0x23ac91)[_0x23664a(0x216)](_0x1d0ee8=>{if(_0x1d0ee8>_0x11603c)_0x11603c=_0x1d0ee8;});if(_0x11603c===0x0)_0x11603c=0x78;const _0xb24225=_0x4c9bc3[_0x23664a(0x1e3)]()-_0x11603c*0xea60;_0x373122>=_0xb24225&&_0x373122<_0x4c9bc3[_0x23664a(0x1e3)]()&&(_0x1f9209[_0x23664a(0x225)]!==_0x23664a(0x1f0)&&(_0x1f9209[_0x23664a(0x228)]['info'](_0x23664a(0x176)+_0x11603c+_0x23664a(0x1b7)),await _0x1f9209['setStateAsync']('system.mode',{'val':_0x23664a(0x1f0),'ack':![]})));}for(const _0x2898fe of _0x1c2e7f){if(_0x2898fe[_0x23664a(0x1e1)]){const _0x175bd7=_0x2898fe[_0x23664a(0x1e1)][_0x23664a(0x19a)](),_0x18bf36=(_0x2898fe[_0x23664a(0x1d7)]||'')[_0x23664a(0x19a)]();let _0x5448b1=_0x92bcb2['includes'](_0x175bd7);!_0x5448b1&&_0x18bf36[_0x23664a(0x1c4)]>0x3&&_0x92bcb2[_0x23664a(0x1aa)](_0x18bf36)&&(_0x5448b1=!![]);if(_0x5448b1){const _0x1fbf37=getWarmupRobust(_0x23ac91,_0x2898fe[_0x23664a(0x1e1)]),_0x24767b=_0x1a7ede[_0x2898fe['location']]||'Classic',_0x3ac1bd=_0x4c9bc3[_0x23664a(0x1e3)]()-_0x1fbf37*0xea60;if(_0x373122>=_0x3ac1bd&&_0x373122<_0x4c9bc3[_0x23664a(0x1e3)]()){const _0x70192f=lastActions['cal_'+_0x2898fe[_0x23664a(0x1e1)]];if(_0x70192f&&_0x373122-_0x70192f<CAL_COOLDOWN_MS)continue;const _0x1a6236=await findRelatedId(_0x1f9209,_0x2898fe['id'],_0x23664a(0x1c2));if(_0x1a6236){let _0x23affa=_0x20d742[_0x2898fe[_0x23664a(0x1e1)]];if(_0x23affa===undefined)_0x23affa=_0x20d742['default'];if(_0x23affa===undefined)_0x23affa=0x15;const _0x2b303c=await _0x1f9209[_0x23664a(0x226)](_0x1a6236);if(_0x2b303c&&typeof _0x2b303c[_0x23664a(0x171)]===_0x23664a(0x17d)&&_0x2b303c[_0x23664a(0x171)]<_0x23affa-0.5){_0x1f9209['log']['info'](_0x23664a(0x1e7)+_0x24767b+_0x23664a(0x1ef)+_0x2898fe['location']+'\x27\x20(Match:\x20'+_0x92bcb2+_0x23664a(0x1c0)+_0x23affa+'¬∞C\x20(Vorlauf:\x20'+_0x1fbf37+'\x20min).'),await _0x1f9209['setForeignStateAsync'](_0x1a6236,_0x23affa),await logAutomationAction(_0x1f9209,_0x23664a(0x1d4)+_0x2898fe[_0x23664a(0x1e1)]+_0x23664a(0x220)+_0x23affa+_0x23664a(0x21c)+_0x24767b+')'),lastActions[_0x23664a(0x1c9)+_0x2898fe[_0x23664a(0x1e1)]]=_0x373122;const _0x21a461=_0x47eb4f[_0x23664a(0x16f)](_0x68942=>_0x68942['room']===_0x2898fe[_0x23664a(0x1e1)]);if(_0x21a461!==-0x1)_0x47eb4f[_0x23664a(0x203)](_0x21a461,0x1);_0x47eb4f[_0x23664a(0x1a2)]({'room':_0x2898fe[_0x23664a(0x1e1)],'target':_0x23affa,'until':_0x4c9bc3[_0x23664a(0x1e3)]()}),_0x1ade2b=!![];}}}}}}}_0x1ade2b&&await _0x1f9209[_0x23664a(0x201)](_0x23664a(0x1d9),{'val':JSON[_0x23664a(0x1ce)](_0x47eb4f),'ack':!![]});}catch(_0x457988){_0x1f9209['log']['warn']('Calendar\x20Check\x20Error:\x20'+_0x457988[_0x23664a(0x212)]);}}async function manageMpcIntervention(_0x1e4645,_0x5c9bdc,_0x4a5506){const _0x19ea16=a1_0x532c53;try{const _0x3b7397=_0x19ea16(0x193),_0x354c80=await _0x1e4645[_0x19ea16(0x175)](_0x3b7397);let _0x119281=[];if(_0x354c80&&_0x354c80[_0x19ea16(0x171)])try{_0x119281=JSON['parse'](_0x354c80[_0x19ea16(0x171)]);}catch(_0x3b4828){}const _0x306bb4=_0x119281[_0x19ea16(0x195)](_0x5c9bdc);if(_0x4a5506===_0x19ea16(0x180))_0x306bb4===-0x1&&(_0x119281[_0x19ea16(0x1a2)](_0x5c9bdc),await _0x1e4645[_0x19ea16(0x201)](_0x3b7397,{'val':JSON['stringify'](_0x119281),'ack':!![]}));else _0x4a5506===_0x19ea16(0x22c)&&(_0x306bb4!==-0x1&&(_0x119281[_0x19ea16(0x203)](_0x306bb4,0x1),await _0x1e4645['setStateAsync'](_0x3b7397,{'val':JSON[_0x19ea16(0x1ce)](_0x119281),'ack':!![]})));}catch(_0x3b4c05){}}async function cleanupGhostInterventions(_0x44a4c4){const _0x3a22cd=a1_0x532c53;try{const _0x3e5036=_0x3a22cd(0x193),_0x5ec5c5=await _0x44a4c4[_0x3a22cd(0x175)](_0x3e5036);if(!_0x5ec5c5||!_0x5ec5c5[_0x3a22cd(0x171)])return;const _0x29eb19=JSON[_0x3a22cd(0x198)](_0x5ec5c5[_0x3a22cd(0x171)]);if(!Array['isArray'](_0x29eb19)||_0x29eb19[_0x3a22cd(0x1c4)]===0x0)return;let _0x5f5970={'default':0x15};try{const _0x598ab8=await _0x44a4c4['getStateAsync'](_0x3a22cd(0x1dc));if(_0x598ab8&&_0x598ab8[_0x3a22cd(0x171)])_0x5f5970=JSON['parse'](_0x598ab8[_0x3a22cd(0x171)]);}catch(_0x2ac9e9){}let _0x262d45=[];try{const _0x32dc65=await _0x44a4c4[_0x3a22cd(0x175)]('analysis.energy.ventilationAlerts');if(_0x32dc65&&_0x32dc65['val'])_0x262d45=JSON[_0x3a22cd(0x198)](_0x32dc65[_0x3a22cd(0x171)]);}catch(_0x24b7d5){}let _0x208683={},_0x558e61=![];try{const _0x54668d=await _0x44a4c4[_0x3a22cd(0x175)](_0x3a22cd(0x179));if(_0x54668d&&_0x54668d[_0x3a22cd(0x171)])_0x208683=JSON[_0x3a22cd(0x198)](_0x54668d[_0x3a22cd(0x171)]);}catch(_0x204690){}if(_0x208683[_0x3a22cd(0x1ac)]){const _0x153939=Date[_0x3a22cd(0x1e4)]();for(const [_0x198383,_0x2ecbc5]of Object[_0x3a22cd(0x1fa)](_0x208683[_0x3a22cd(0x1ac)])){_0x153939-_0x2ecbc5>PENALTY_TTL&&(delete _0x208683[_0x198383],delete _0x208683[_0x3a22cd(0x1ac)][_0x198383],_0x558e61=!![],_0x44a4c4[_0x3a22cd(0x228)][_0x3a22cd(0x206)](_0x3a22cd(0x200)+_0x198383+'\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.'));}}const _0x28192c=_0x44a4c4['config']['devices']||[];let _0x50c5da=![];for(let _0xb0d070=_0x29eb19[_0x3a22cd(0x1c4)]-0x1;_0xb0d070>=0x0;_0xb0d070--){const _0x3ddc71=_0x29eb19[_0xb0d070],_0x14b0db=_0x28192c[_0x3a22cd(0x1f1)](_0x16bc4b=>normalize(_0x16bc4b[_0x3a22cd(0x1e1)])===normalize(_0x3ddc71)&&(_0x16bc4b[_0x3a22cd(0x1f7)]===_0x3a22cd(0x181)||_0x16bc4b[_0x3a22cd(0x1f7)]==='thermostat'));if(!_0x14b0db){_0x44a4c4[_0x3a22cd(0x228)][_0x3a22cd(0x1d3)](_0x3a22cd(0x1db)+_0x3ddc71+_0x3a22cd(0x1d6)),_0x29eb19[_0x3a22cd(0x203)](_0xb0d070,0x1),_0x50c5da=!![];continue;}if(_0x14b0db){const _0x1fabba=await findRelatedId(_0x44a4c4,_0x14b0db['id'],_0x3a22cd(0x1c2)),_0x564152=await _0x44a4c4[_0x3a22cd(0x226)](_0x14b0db['id']);if(_0x1fabba){const _0x223f39=await _0x44a4c4[_0x3a22cd(0x226)](_0x1fabba);if(_0x223f39&&typeof _0x223f39[_0x3a22cd(0x171)]===_0x3a22cd(0x17d)){let _0x43d272=![],_0x357da3='';Math[_0x3a22cd(0x20b)](_0x223f39['val']-ECO_TEMP)>0.5&&(_0x43d272=!![],_0x357da3='manual');if(!_0x43d272&&_0x564152&&typeof _0x564152[_0x3a22cd(0x171)]==='number'){const _0x2e1541=_0x5f5970[_0x3ddc71]||_0x5f5970[_0x3a22cd(0x20c)]||0x15;_0x564152[_0x3a22cd(0x171)]<_0x2e1541+0.2&&(_0x43d272=!![],_0x357da3=_0x3a22cd(0x1b3));}if(_0x43d272){if(_0x357da3===_0x3a22cd(0x1f6)){_0x44a4c4[_0x3a22cd(0x228)][_0x3a22cd(0x206)](_0x3a22cd(0x22f)+_0x3ddc71+'\x20ist\x20auf\x20'+_0x223f39['val']+_0x3a22cd(0x1d5)+ECO_TEMP+_0x3a22cd(0x214));const _0x38b664=lastActions[_0x3a22cd(0x1c9)+_0x3ddc71],_0x84cf59=_0x38b664&&Date[_0x3a22cd(0x1e4)]()-_0x38b664<0x2*0x3c*0x3e8;if(!_0x84cf59&&_0x223f39[_0x3a22cd(0x171)]>ECO_TEMP+0.5){_0x44a4c4[_0x3a22cd(0x17b)]&&(_0x44a4c4[_0x3a22cd(0x228)][_0x3a22cd(0x206)](_0x3a22cd(0x1f8)+_0x3ddc71+_0x3a22cd(0x1d1)),_0x44a4c4[_0x3a22cd(0x17b)]('TRAIN_RL_PENALTY',{'room':_0x3ddc71}));const _0x3f7159=_0x3ddc71+'_'+new Date()[_0x3a22cd(0x192)]();if(!_0x208683[_0x3f7159]){_0x208683[_0x3f7159]=0x1;if(!_0x208683['_meta'])_0x208683['_meta']={};_0x208683['_meta'][_0x3f7159]=Date[_0x3a22cd(0x1e4)](),_0x558e61=!![];}}else _0x84cf59&&_0x44a4c4[_0x3a22cd(0x228)]['info'](_0x3a22cd(0x199)+_0x3ddc71+_0x3a22cd(0x204));}else{if(_0x357da3===_0x3a22cd(0x1b3)){let _0xac42c5=![];if(_0x262d45[_0x3a22cd(0x1f1)](_0x3b3539=>_0x3b3539[_0x3a22cd(0x217)]===_0x3ddc71))_0xac42c5=!![];const _0x4e7848=_0x28192c['filter'](_0x419eff=>normalize(_0x419eff['location'])===normalize(_0x3ddc71)&&(_0x419eff[_0x3a22cd(0x1f7)]===_0x3a22cd(0x1a7)||_0x419eff[_0x3a22cd(0x1f7)]===_0x3a22cd(0x1ee)||_0x419eff[_0x3a22cd(0x1f7)]==='contact'));for(const _0x5a9743 of _0x4e7848){try{const _0x5cc5df=await _0x44a4c4[_0x3a22cd(0x226)](_0x5a9743['id']);if(_0x5cc5df&&(_0x5cc5df['val']===!![]||_0x5cc5df[_0x3a22cd(0x171)]===0x1||String(_0x5cc5df['val'])[_0x3a22cd(0x19a)]()===_0x3a22cd(0x1c7)))_0xac42c5=!![];}catch(_0x286584){}}if(_0xac42c5)_0x44a4c4[_0x3a22cd(0x228)][_0x3a22cd(0x206)](_0x3a22cd(0x221)+_0x3ddc71+_0x3a22cd(0x16b));else{const _0x1b5c70=_0x5f5970[_0x3ddc71]||_0x5f5970[_0x3a22cd(0x20c)]||0x15;_0x44a4c4[_0x3a22cd(0x228)]['info'](_0x3a22cd(0x229)+_0x3ddc71+_0x3a22cd(0x202)+_0x564152[_0x3a22cd(0x171)]+_0x3a22cd(0x1f5)+(_0x1b5c70+0.2)+_0x3a22cd(0x21f)),await _0x44a4c4[_0x3a22cd(0x1e6)](_0x1fabba,_0x1b5c70),await logAutomationAction(_0x44a4c4,'[WATCHDOG]\x20'+_0x3ddc71+_0x3a22cd(0x188)+_0x1b5c70+'¬∞C'),lastActions[_0x3a22cd(0x1fd)+_0x3ddc71]=Date[_0x3a22cd(0x1e4)]();}}}_0x29eb19['splice'](_0xb0d070,0x1),_0x50c5da=!![];}}}}}_0x50c5da&&await _0x44a4c4[_0x3a22cd(0x201)](_0x3e5036,{'val':JSON['stringify'](_0x29eb19),'ack':!![]}),_0x558e61&&await _0x44a4c4['setStateAsync'](_0x3a22cd(0x179),{'val':JSON[_0x3a22cd(0x1ce)](_0x208683),'ack':!![]});}catch(_0xf6b64d){}}async function applyEnergySavings(_0x534f1d,_0x5842b9){const _0x46fbc7=a1_0x532c53;await cleanupGhostInterventions(_0x534f1d);if(!_0x5842b9||_0x5842b9[_0x46fbc7(0x1c4)]===0x0)return;const _0x59f4ce=_0x534f1d['config']['devices']||[],_0x40f579=Date[_0x46fbc7(0x1e4)]();for(const _0x4779c2 of _0x5842b9){const _0x2689b1=_0x4779c2[_0x46fbc7(0x217)],_0x431721=_0x4779c2[_0x46fbc7(0x1cb)],_0x54a960=_0x4779c2['target']||0x15;if(lastActions[_0x46fbc7(0x1fd)+_0x2689b1]&&_0x40f579-lastActions['rescue_'+_0x2689b1]<RESCUE_LOCK_MS)continue;const _0x2d6dbd=_0x59f4ce[_0x46fbc7(0x1f1)](_0xce1f3e=>normalize(_0xce1f3e[_0x46fbc7(0x1e1)])===normalize(_0x2689b1)&&(_0xce1f3e[_0x46fbc7(0x1f7)]==='temperature'||_0xce1f3e[_0x46fbc7(0x1f7)]==='thermostat'));if(!_0x2d6dbd)continue;const _0x3c71ae=await findRelatedId(_0x534f1d,_0x2d6dbd['id'],'setpoint');if(_0x3c71ae){if(lastActions['mpc_'+_0x2689b1]&&_0x40f579-lastActions[_0x46fbc7(0x1fb)+_0x2689b1]<0x1e*0x3c*0x3e8)continue;const _0x31e970=await _0x534f1d[_0x46fbc7(0x226)](_0x3c71ae);if(_0x31e970&&typeof _0x31e970['val']==='number'){const _0x5d0cb8=_0x31e970[_0x46fbc7(0x171)];_0x5d0cb8!==ECO_TEMP&&await manageMpcIntervention(_0x534f1d,_0x2689b1,_0x46fbc7(0x22c));if(_0x431721>0x1e)_0x5d0cb8>ECO_TEMP+0.5&&(_0x534f1d[_0x46fbc7(0x228)][_0x46fbc7(0x206)]('üçÉ\x20[MPC\x20ACTION]\x20Senke\x20'+_0x2689b1+_0x46fbc7(0x1ba)+ECO_TEMP+_0x46fbc7(0x207)+_0x431721+_0x46fbc7(0x186)),await _0x534f1d[_0x46fbc7(0x1e6)](_0x3c71ae,ECO_TEMP),await manageMpcIntervention(_0x534f1d,_0x2689b1,'add'),lastActions[_0x46fbc7(0x1fb)+_0x2689b1]=_0x40f579,await logAutomationAction(_0x534f1d,'[MPC]\x20'+_0x2689b1+':\x20Absenkung\x20auf\x20'+ECO_TEMP+'¬∞C'));else _0x431721<=0xf&&(_0x5d0cb8<_0x54a960&&(_0x534f1d['log']['info'](_0x46fbc7(0x1a0)+_0x2689b1+_0x46fbc7(0x1fe)+_0x54a960+'¬∞C!\x20(Puffer\x20leer).'),await _0x534f1d[_0x46fbc7(0x1e6)](_0x3c71ae,_0x54a960),await manageMpcIntervention(_0x534f1d,_0x2689b1,_0x46fbc7(0x22c)),lastActions[_0x46fbc7(0x1fb)+_0x2689b1]=_0x40f579,await logAutomationAction(_0x534f1d,_0x46fbc7(0x1fc)+_0x2689b1+':\x20Aufheizen\x20auf\x20'+_0x54a960+'¬∞C')));}}else _0x534f1d['log'][_0x46fbc7(0x1d3)](_0x46fbc7(0x1af)+_0x2689b1+_0x46fbc7(0x1b9));}}module[a1_0x532c53(0x185)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};