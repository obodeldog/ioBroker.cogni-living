const a1_0xcac93b=a1_0x44e3;(function(_0x2d00e5,_0x211e9a){const _0x2af3cf=a1_0x44e3,_0x3c7cc3=_0x2d00e5();while(!![]){try{const _0x3d7991=-parseInt(_0x2af3cf(0x176))/0x1*(parseInt(_0x2af3cf(0x177))/0x2)+-parseInt(_0x2af3cf(0x19b))/0x3+-parseInt(_0x2af3cf(0x1e1))/0x4+parseInt(_0x2af3cf(0x1df))/0x5+parseInt(_0x2af3cf(0x1c9))/0x6*(-parseInt(_0x2af3cf(0x228))/0x7)+-parseInt(_0x2af3cf(0x1b6))/0x8+parseInt(_0x2af3cf(0x1e8))/0x9;if(_0x3d7991===_0x211e9a)break;else _0x3c7cc3['push'](_0x3c7cc3['shift']());}catch(_0x6e1373){_0x3c7cc3['push'](_0x3c7cc3['shift']());}}}(a1_0x1a0c,0x94da6));const a1_0x513607=(function(){let _0x4cdb3b=!![];return function(_0xb63c5d,_0x29f4be){const _0x1afd85=_0x4cdb3b?function(){const _0x564748=a1_0x44e3;if(_0x29f4be){const _0x36c3a4=_0x29f4be[_0x564748(0x1fe)](_0xb63c5d,arguments);return _0x29f4be=null,_0x36c3a4;}}:function(){};return _0x4cdb3b=![],_0x1afd85;};}()),a1_0x3eaa52=a1_0x513607(this,function(){const _0x208736=a1_0x44e3;return a1_0x3eaa52[_0x208736(0x1d7)]()[_0x208736(0x202)]('(((.+)+)+)+$')[_0x208736(0x1d7)]()['constructor'](a1_0x3eaa52)[_0x208736(0x202)](_0x208736(0x1c0));});a1_0x3eaa52();'use strict';const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x203d70){const _0x4f6ffa=a1_0x44e3;if(!_0x203d70)return'';return _0x203d70[_0x4f6ffa(0x1de)]()['replace'](/\s+/g,'')[_0x4f6ffa(0x1dd)]();}function getWarmupRobust(_0x2bcdf4,_0x513777){const _0x347ed2=a1_0x44e3;if(!_0x2bcdf4||!_0x513777)return 0x3c;if(_0x2bcdf4[_0x513777]!==undefined)return _0x2bcdf4[_0x513777];const _0x4c952a=_0x513777['toLowerCase']()[_0x347ed2(0x174)](/Ã¤/g,'ae')[_0x347ed2(0x174)](/Ã¶/g,'oe')[_0x347ed2(0x174)](/Ã¼/g,'ue')[_0x347ed2(0x174)](/ÃŸ/g,'ss')['replace'](/\s+/g,'_')[_0x347ed2(0x174)](/[^a-z0-9_]/g,'');if(_0x2bcdf4[_0x4c952a]!==undefined)return _0x2bcdf4[_0x4c952a];return 0x3c;}async function logAutomationAction(_0x56702d,_0x3a839a){const _0x8b566d=a1_0x44e3;await _0x56702d[_0x8b566d(0x17e)]('analysis.automation.lastAction',{'val':_0x3a839a,'ack':!![]});try{const _0x58d48d='analysis.automation.actionLog',_0x290080=await _0x56702d[_0x8b566d(0x1ef)](_0x58d48d);let _0x25fb72=[];if(_0x290080&&_0x290080[_0x8b566d(0x1ce)])try{_0x25fb72=JSON[_0x8b566d(0x167)](_0x290080[_0x8b566d(0x1ce)]);}catch(_0x2fe20d){}_0x25fb72[_0x8b566d(0x185)]({'ts':Date['now'](),'msg':_0x3a839a});if(_0x25fb72[_0x8b566d(0x1b9)]>0x32)_0x25fb72=_0x25fb72['slice'](0x0,0x32);await _0x56702d[_0x8b566d(0x17e)](_0x58d48d,{'val':JSON[_0x8b566d(0x195)](_0x25fb72),'ack':!![]});}catch(_0x3fb091){}}function a1_0x44e3(_0x3efb97,_0x441ef9){const _0x1dd130=a1_0x1a0c();return a1_0x44e3=function(_0x3eaa52,_0x513607){_0x3eaa52=_0x3eaa52-0x166;let _0x1a0cce=_0x1dd130[_0x3eaa52];return _0x1a0cce;},a1_0x44e3(_0x3efb97,_0x441ef9);}async function handlePrediction(_0x4f1bdc,_0x40c739,_0x3be73d){const _0x267641=a1_0x44e3;if(!_0x40c739||_0x40c739===_0x267641(0x1b1))return;let _0x5d35bc=_0x267641(0x208),_0x312b3c=0.6;try{const _0x2fbea6=await _0x4f1bdc[_0x267641(0x1ef)]('analysis.automation.mode');if(_0x2fbea6&&_0x2fbea6[_0x267641(0x1ce)])_0x5d35bc=_0x2fbea6['val'];const _0x564d02=await _0x4f1bdc[_0x267641(0x1ef)](_0x267641(0x1c8));if(_0x564d02&&_0x564d02[_0x267641(0x1ce)])_0x312b3c=_0x564d02[_0x267641(0x1ce)];}catch(_0x187dea){}if(_0x5d35bc===_0x267641(0x208)||_0x3be73d<_0x312b3c)return;const _0x1980b4=Date[_0x267641(0x19d)]();if(lastActions[_0x40c739]&&_0x1980b4-lastActions[_0x40c739]<COOLDOWN_MS)return;const _0x216e5d=_0x4f1bdc['config'][_0x267641(0x1d8)]||[],_0x383a65=normalize(_0x40c739),_0x3b89d0=_0x216e5d['find'](_0x487c82=>normalize(_0x487c82[_0x267641(0x1f0)])===_0x383a65&&(_0x487c82[_0x267641(0x1a8)]===_0x267641(0x215)||_0x487c82[_0x267641(0x1a8)]===_0x267641(0x1e6)||_0x487c82['type']===_0x267641(0x1f3)));if(!_0x3b89d0)return;const _0x269e64=await aiAgent['consultButler'](_0x4f1bdc,_0x40c739,_0x3b89d0['name'],_0x3be73d);if(!_0x269e64[_0x267641(0x1cb)])return;const _0x11dbd7=_0x267641(0x1bd)+_0x40c739+_0x267641(0x210)+_0x3b89d0[_0x267641(0x190)]+'\x20('+_0x269e64[_0x267641(0x1ad)]+')';await logAutomationAction(_0x4f1bdc,'['+_0x5d35bc[_0x267641(0x179)]()+']\x20'+_0x11dbd7);if(_0x5d35bc==='active'){const _0x3a0760=await _0x4f1bdc[_0x267641(0x1fc)](_0x3b89d0['id']);(!_0x3a0760||!_0x3a0760[_0x267641(0x1ce)]&&_0x3a0760['val']!==!![])&&await _0x4f1bdc[_0x267641(0x1b0)](_0x3b89d0['id'],!![]),lastActions[_0x40c739]=_0x1980b4;}}async function findRelatedId(_0x2c10a8,_0x2885e2,_0x1fbb84=a1_0xcac93b(0x184)){const _0x1daa29=a1_0xcac93b;if(_0x1fbb84==='setpoint'&&_0x2c10a8[_0x1daa29(0x183)][_0x1daa29(0x169)]){let _0xf58b26=_0x2c10a8[_0x1daa29(0x183)]['thermostatMapping'];if(typeof _0xf58b26==='string')try{_0xf58b26=JSON[_0x1daa29(0x167)](_0xf58b26);}catch(_0x485540){}if(_0xf58b26&&_0xf58b26[_0x2885e2])return _0xf58b26[_0x2885e2];}if(_0x1fbb84===_0x1daa29(0x171)&&_0x2c10a8[_0x1daa29(0x183)]['valveMapping']){let _0x4c11f5=_0x2c10a8['config'][_0x1daa29(0x1a3)];if(typeof _0x4c11f5===_0x1daa29(0x1f2))try{_0x4c11f5=JSON[_0x1daa29(0x167)](_0x4c11f5);}catch(_0x482445){}if(_0x4c11f5&&_0x4c11f5[_0x2885e2])return _0x4c11f5[_0x2885e2];}let _0x48d2b5=[];if(_0x1fbb84===_0x1daa29(0x184))_0x48d2b5=[{'s':_0x1daa29(0x1cc),'t':'.1.SET_POINT_TEMPERATURE'},{'s':_0x1daa29(0x18c),'t':_0x1daa29(0x175)},{'s':_0x1daa29(0x18c),'t':_0x1daa29(0x1a4)},{'s':_0x1daa29(0x204),'t':_0x1daa29(0x20b)},{'s':_0x1daa29(0x1ae),'t':_0x1daa29(0x1fd)},{'s':'local_temperature','t':_0x1daa29(0x1d9)},{'s':_0x1daa29(0x206),'t':_0x1daa29(0x1d1)},{'s':_0x1daa29(0x1c3),'t':_0x1daa29(0x170)},{'s':_0x1daa29(0x1f4),'t':_0x1daa29(0x21d)},{'s':_0x1daa29(0x206),'t':_0x1daa29(0x184)}];else _0x1fbb84===_0x1daa29(0x171)&&(_0x48d2b5=[{'s':_0x1daa29(0x1cc),'t':_0x1daa29(0x1ba)},{'s':_0x1daa29(0x18c),'t':_0x1daa29(0x1ba)},{'s':_0x1daa29(0x18c),'t':_0x1daa29(0x1e3)},{'s':_0x1daa29(0x1ae),'t':_0x1daa29(0x17f)},{'s':_0x1daa29(0x206),'t':'valve_position'},{'s':'temperature','t':_0x1daa29(0x21b)}]);for(const _0x419f19 of _0x48d2b5){if(_0x2885e2[_0x1daa29(0x1ff)](_0x419f19['s'])){const _0xfb69dc=_0x2885e2[_0x1daa29(0x174)](_0x419f19['s'],_0x419f19['t']),_0x183eee=await _0x2c10a8[_0x1daa29(0x1a6)](_0xfb69dc);if(_0x183eee)return _0xfb69dc;}}try{const _0x353058=_0x2885e2[_0x1daa29(0x20d)]('.');if(_0x353058[_0x1daa29(0x1b9)]>0x2){const _0xd423fc=_0x353058[_0x1daa29(0x200)](0x0,-0x1)[_0x1daa29(0x17a)]('.'),_0x539361=await _0x2c10a8[_0x1daa29(0x193)](_0xd423fc+'.*'),_0x3ddfb1=[],_0x26487f=_0x2885e2[_0x1daa29(0x20d)](/[._]+/)[_0x1daa29(0x201)](_0x36cba1=>!['openknx','0','hm-rpc',_0x1daa29(0x16b),_0x1daa29(0x16a),_0x1daa29(0x206),_0x1daa29(0x1db),'sensor',_0x1daa29(0x199),_0x1daa29(0x18a)][_0x1daa29(0x1ff)](_0x36cba1[_0x1daa29(0x1de)]()));for(const [_0x57e4e5,_0x31c283]of Object[_0x1daa29(0x1c2)](_0x539361)){if(_0x57e4e5===_0x2885e2)continue;if(_0x31c283&&_0x31c283[_0x1daa29(0x1bc)]){const _0x5dc405=_0x57e4e5[_0x1daa29(0x1de)](),_0x5bfaea=(_0x31c283[_0x1daa29(0x1bc)][_0x1daa29(0x219)]||'')[_0x1daa29(0x1de)](),_0x49db33=(_0x31c283[_0x1daa29(0x1bc)][_0x1daa29(0x1f6)]||'')[_0x1daa29(0x1de)]();let _0xb4b044=![];if(_0x1fbb84===_0x1daa29(0x184)&&_0x31c283[_0x1daa29(0x1bc)][_0x1daa29(0x17d)]===!![])_0xb4b044=_0x5dc405[_0x1daa29(0x1ff)](_0x1daa29(0x212))||_0x5dc405[_0x1daa29(0x1ff)](_0x1daa29(0x205))||_0x5dc405[_0x1daa29(0x1ff)](_0x1daa29(0x198))||_0x5bfaea[_0x1daa29(0x1ff)](_0x1daa29(0x1b3))||_0x5bfaea[_0x1daa29(0x1ff)](_0x1daa29(0x18d));else _0x1fbb84===_0x1daa29(0x171)&&(_0xb4b044=_0x5dc405[_0x1daa29(0x1ff)]('level')||_0x5dc405[_0x1daa29(0x1ff)]('valve')||_0x5dc405[_0x1daa29(0x1ff)]('stellwert')||_0x5dc405['includes']('position')||_0x5bfaea[_0x1daa29(0x1ff)]('level.valve')||_0x5bfaea[_0x1daa29(0x1ff)](_0x1daa29(0x173))||_0x49db33[_0x1daa29(0x1ff)]('%'));if(_0xb4b044){const _0x2b00fb=_0x57e4e5['split'](/[._]+/)['map'](_0x4068e9=>_0x4068e9[_0x1daa29(0x1de)]());let _0x49b8a0=0x0;_0x26487f[_0x1daa29(0x181)](_0x1e9f66=>{const _0x4813b9=_0x1daa29;if(_0x2b00fb[_0x4813b9(0x1ff)](_0x1e9f66[_0x4813b9(0x1de)]()))_0x49b8a0++;}),_0x3ddfb1['push']({'id':_0x57e4e5,'score':_0x49b8a0});}}}if(_0x3ddfb1[_0x1daa29(0x1b9)]>0x0){_0x3ddfb1[_0x1daa29(0x216)]((_0x481867,_0x3624a3)=>_0x3624a3[_0x1daa29(0x187)]-_0x481867[_0x1daa29(0x187)]);if(_0x3ddfb1[0x0]['score']>0x0)return _0x3ddfb1[0x0]['id'];}}}catch(_0x469c3e){}return null;}function a1_0x1a0c(){const _0x456716=['approved','.1.ACTUAL_TEMPERATURE','urlaub\x20ende','val','ðŸ§¹\x20[MPC\x20CLEANUP]\x20','calendarSelection','target_temperature','ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27','message','\x20erreicht\x20Limit\x20(','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','Calendar\x20Check\x20Error:\x20','toString','devices','current_heating_setpoint','rÃ¼ckkehr','actual','log','trim','toLowerCase','3863935sLsFQw','[MPC]\x20','4345736AQAGQf','too_cold','.4.VALVE_STATE','analysis.energy.warmupTimes','remove','dimmer','localeCompare','15594129heqbPn','getTime','ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','\x20wurde\x20manuell\x20erhÃ¶ht.','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20','isArray','getStateAsync','location','push','string','switch','Ist','Â°C\x20->\x20','unit','\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.','Unbekannt','ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','analysis.energy.warmupSources','PERFECT','getForeignStateAsync','occupied_heating_setpoint','apply','includes','slice','filter','search','analysis.energy.warmupTargets','ACTUAL_TEMPERATURE','soll','temperature','from','off','ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20','Â°C!\x20(Puffer:\x20','SET_POINT_TEMPERATURE',')\x20aktiv.\x20Heize\x20auf\x20','split','eventStart','contact','\x20->\x20Schalte\x20','cal_','set','\x20min).','room','light','sort','Manuelles\x20Mapping','temp','role','sendToPythonWrapper','level','normal','Soll','number','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','Fehlt','error','ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','sensor','\x20gefunden!','Â°C!\x20(Puffer\x20leer).','warn','1800582GvAlhR','_calName','Â°C\x20(nicht\x20','parse','[WATCHDOG]\x20','thermostatMapping','wert','ist','splice','values','Classic','ðŸ“…\x20SMART\x20SCHEDULE\x20[','SET','valve','open','value.valve','replace','.1.SET_POINT_TEMPERATURE','19QumNtO','27256diroNp','Â°C).\x20Entferne\x20Status.','toUpperCase','join','_date','.data.table','write','setStateAsync','pi_heating_demand','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20','forEach','analysis.energy.activeEnforcements','config','setpoint','unshift','thermostat','score',':\x20Absenkung\x20auf\x20','mpc_','state','ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','.1.TEMPERATURE','thermostat.setpoint','Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20','Nicht\x20gefunden','name','default','Â°C\x20(Kalender-Schutz)','getForeignObjectsAsync','ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','stringify','rescue_','\x20wieder\x20auf\x20','target','messwert',']:\x20Raum-Trigger\x20\x27','285789BerLQz','\x20min)','now','TRAIN_RL_PENALTY',':\x20Aufheizen\x20auf\x20','triggerTime','Auto-Erkennung','Enforcement\x20Monitor\x20Error:\x20','valveMapping','.4.SET_TEMPERATURE','add','getForeignObjectAsync','event','type','find','useCalendar','minutes_safe','Â°C\x20(Vorlauf:\x20','reason','local_temperature','calendarInstance','setForeignStateAsync','Unknown','info','level.temperature','exports','Â°C).\x20Sparmodus\x20beendet!','1583288FDLPDT','\x20auf\x20','ankunft','length','.1.LEVEL','date','common','PrÃ¤diktion:\x20','analysis.energy.mpcActiveInterventions','summary','(((.+)+)+)+$','analysis.energy.rlPenalties','entries','ACTUAL','analysis.energy.ventilationAlerts','window','ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20','manual','analysis.automation.confidenceThreshold','6lyJpor','_meta'];a1_0x1a0c=function(){return _0x456716;};return a1_0x1a0c();}async function scanThermostats(_0x581c39){const _0x294986=a1_0xcac93b,_0x18c0ea=_0x581c39[_0x294986(0x183)][_0x294986(0x1d8)]||[],_0x5a7887=[],_0x515b0f=_0x18c0ea[_0x294986(0x201)](_0x778402=>_0x778402['id']&&_0x778402['id'][_0x294986(0x1ff)](_0x294986(0x206))||_0x778402[_0x294986(0x1a8)]&&[_0x294986(0x206),_0x294986(0x186),_0x294986(0x224)][_0x294986(0x1ff)](_0x778402[_0x294986(0x1a8)])||_0x778402[_0x294986(0x190)]&&_0x778402[_0x294986(0x190)][_0x294986(0x1de)]()['includes'](_0x294986(0x218)));for(const _0x40af36 of _0x515b0f){const _0x56de6e=await findRelatedId(_0x581c39,_0x40af36['id'],'setpoint'),_0x354d09=await findRelatedId(_0x581c39,_0x40af36['id'],_0x294986(0x171));let _0x358510=_0x294986(0x18f),_0x5cb337=![],_0x592f91=_0x581c39[_0x294986(0x183)][_0x294986(0x169)]||{};if(typeof _0x592f91==='string')try{_0x592f91=JSON['parse'](_0x592f91);}catch(_0x2df991){}let _0x8b796e=_0x581c39['config'][_0x294986(0x1a3)]||{};if(typeof _0x8b796e===_0x294986(0x1f2))try{_0x8b796e=JSON[_0x294986(0x167)](_0x8b796e);}catch(_0x5f1834){}if(_0x592f91[_0x40af36['id']]&&_0x592f91[_0x40af36['id']]===_0x56de6e||_0x8b796e[_0x40af36['id']]&&_0x8b796e[_0x40af36['id']]===_0x354d09)_0x358510=_0x294986(0x217),_0x5cb337=!![];else(_0x56de6e||_0x354d09)&&(_0x358510=_0x294986(0x1a1));_0x5a7887[_0x294986(0x1f1)]({'room':_0x40af36[_0x294986(0x1f0)]||_0x294986(0x1f8),'sensorId':_0x40af36['id'],'setpointId':_0x56de6e||'-','valveId':_0x354d09||'-','source':_0x358510,'isManual':_0x5cb337,'status':_0x56de6e&&_0x354d09?_0x294986(0x1fb):_0x56de6e?'OK':_0x294986(0x220)});}return _0x5a7887[_0x294986(0x216)]((_0x348449,_0x12aa51)=>_0x348449[_0x294986(0x214)][_0x294986(0x1e7)](_0x12aa51[_0x294986(0x214)]));}async function updateSchedulePreview(_0x5f2b1d){const _0x380b1f=a1_0xcac93b;if(!_0x5f2b1d[_0x380b1f(0x183)][_0x380b1f(0x1aa)]||!_0x5f2b1d[_0x380b1f(0x183)][_0x380b1f(0x1af)])return;let _0x28472f={};try{const _0x56b87b=await _0x5f2b1d[_0x380b1f(0x1ef)](_0x380b1f(0x1e4));if(_0x56b87b&&_0x56b87b[_0x380b1f(0x1ce)])_0x28472f=JSON[_0x380b1f(0x167)](_0x56b87b[_0x380b1f(0x1ce)]);}catch(_0x5eee37){}const _0x524c60=[],_0x356bb3=Date[_0x380b1f(0x19d)](),_0x34ada2=0x30*0x3c*0x3c*0x3e8;try{const _0x176e0a=await _0x5f2b1d[_0x380b1f(0x1fc)](_0x5f2b1d[_0x380b1f(0x183)][_0x380b1f(0x1af)]+_0x380b1f(0x17c));if(!_0x176e0a||!_0x176e0a[_0x380b1f(0x1ce)])return;const _0x5a3231=JSON['parse'](_0x176e0a[_0x380b1f(0x1ce)]),_0x215d2b=_0x5f2b1d[_0x380b1f(0x183)]['calendarSelection']||[],_0x1d2757=_0x5f2b1d[_0x380b1f(0x183)][_0x380b1f(0x1d8)]||[],_0x5bc317=new Set();_0x1d2757[_0x380b1f(0x181)](_0x22e319=>{const _0x3a93d0=_0x380b1f;if(_0x22e319[_0x3a93d0(0x1f0)])_0x5bc317[_0x3a93d0(0x1a5)](_0x22e319['location']);});for(const _0xea9535 of _0x5a3231){if(_0xea9535['_calName']&&_0x215d2b[_0x380b1f(0x1b9)]>0x0&&!_0x215d2b[_0x380b1f(0x1ff)](_0xea9535['_calName']))continue;const _0xe3fa85=_0xea9535[_0x380b1f(0x17b)]||_0xea9535['eventStart']||_0xea9535[_0x380b1f(0x1bb)];if(!_0xe3fa85)continue;const _0x5d1ae8=new Date(_0xe3fa85),_0x1df659=_0x5d1ae8[_0x380b1f(0x1e9)]();if(isNaN(_0x1df659))continue;if(_0x1df659<_0x356bb3)continue;if(_0x1df659>_0x356bb3+_0x34ada2)continue;const _0x41bd2e=(_0xea9535[_0x380b1f(0x1a7)]||_0xea9535[_0x380b1f(0x1bf)]||'')[_0x380b1f(0x1de)]();let _0x5bafe6=![],_0x25ff20=[],_0x56e178=_0xea9535[_0x380b1f(0x1a7)]||_0xea9535[_0x380b1f(0x1bf)]||'Unbekannt';if(_0x41bd2e[_0x380b1f(0x1ff)](_0x380b1f(0x1cd))||_0x41bd2e[_0x380b1f(0x1ff)]('rÃ¼ckkehr')||_0x41bd2e['includes'](_0x380b1f(0x1b8)))_0x5bafe6=!![],_0x25ff20=Array[_0x380b1f(0x207)](_0x5bc317);else for(const _0x3354a7 of _0x5bc317){if(_0x41bd2e['includes'](_0x3354a7[_0x380b1f(0x1de)]()))_0x25ff20['push'](_0x3354a7);}_0x25ff20[_0x380b1f(0x1b9)]>0x0&&_0x25ff20[_0x380b1f(0x181)](_0x56f99b=>{const _0x266e4d=_0x380b1f;let _0x8179c9=0x3c;if(_0x5bafe6){let _0x8b23d3=0x0;Object[_0x266e4d(0x16d)](_0x28472f)[_0x266e4d(0x181)](_0x1b0c1f=>{if(_0x1b0c1f>_0x8b23d3)_0x8b23d3=_0x1b0c1f;}),_0x8179c9=_0x8b23d3>0x0?_0x8b23d3:0x78;}else _0x8179c9=getWarmupRobust(_0x28472f,_0x56f99b);const _0xa46760=new Date(_0x1df659-_0x8179c9*0xea60);_0x524c60[_0x266e4d(0x1f1)]({'eventTime':_0x1df659,'triggerTime':_0xa46760[_0x266e4d(0x1e9)](),'room':_0x56f99b,'minutes':_0x8179c9,'reason':_0x56e178,'isGlobal':_0x5bafe6});});}}catch(_0x18e217){}_0x524c60[_0x380b1f(0x216)]((_0x560ff6,_0x2e6102)=>_0x560ff6[_0x380b1f(0x1a0)]-_0x2e6102['triggerTime']);const _0x12459a=_0x524c60[_0x380b1f(0x200)](0x0,0x1e);await _0x5f2b1d[_0x380b1f(0x17e)]('analysis.energy.schedulePreview',{'val':JSON[_0x380b1f(0x195)](_0x12459a),'ack':!![]});}async function monitorEnforcements(_0x1bd0b4){const _0x39870b=a1_0xcac93b;try{const _0x46d13a=_0x39870b(0x182),_0x1a79f5=await _0x1bd0b4['getStateAsync'](_0x46d13a);if(!_0x1a79f5||!_0x1a79f5[_0x39870b(0x1ce)])return;let _0xb0990a=[];try{_0xb0990a=JSON[_0x39870b(0x167)](_0x1a79f5[_0x39870b(0x1ce)]);}catch(_0x513b5b){return;}if(!Array['isArray'](_0xb0990a)||_0xb0990a['length']===0x0)return;const _0x4ab731=Date[_0x39870b(0x19d)](),_0x325ea5=_0x1bd0b4['config'][_0x39870b(0x1d8)]||[];let _0x4995ca=![];for(let _0x318909=_0xb0990a['length']-0x1;_0x318909>=0x0;_0x318909--){const _0x534fff=_0xb0990a[_0x318909];if(_0x4ab731>=_0x534fff['until']){_0x1bd0b4[_0x39870b(0x1dc)][_0x39870b(0x1b2)](_0x39870b(0x1ea)+_0x534fff[_0x39870b(0x214)]+_0x39870b(0x1ec)),_0xb0990a[_0x39870b(0x16c)](_0x318909,0x1),_0x4995ca=!![];continue;}const _0xc8674d=_0x325ea5['find'](_0x3ee344=>normalize(_0x3ee344[_0x39870b(0x1f0)])===normalize(_0x534fff[_0x39870b(0x214)])&&(_0x3ee344['type']===_0x39870b(0x206)||_0x3ee344['type']===_0x39870b(0x186)));if(_0xc8674d){const _0x5c9d00=await findRelatedId(_0x1bd0b4,_0xc8674d['id'],_0x39870b(0x184));if(_0x5c9d00){const _0x542e3a=await _0x1bd0b4['getForeignStateAsync'](_0x5c9d00);_0x542e3a&&typeof _0x542e3a[_0x39870b(0x1ce)]===_0x39870b(0x21e)&&(_0x542e3a['val']<0xf&&(_0x1bd0b4[_0x39870b(0x1dc)][_0x39870b(0x227)](_0x39870b(0x18b)+_0x534fff[_0x39870b(0x214)]+_0x39870b(0x1b7)+_0x542e3a[_0x39870b(0x1ce)]+_0x39870b(0x18e)+_0x534fff[_0x39870b(0x198)]+'Â°C.'),await _0x1bd0b4[_0x39870b(0x1b0)](_0x5c9d00,_0x534fff[_0x39870b(0x198)]),await logAutomationAction(_0x1bd0b4,'[FORCE]\x20'+_0x534fff['room']+':\x20'+_0x542e3a['val']+_0x39870b(0x1f5)+_0x534fff['target']+_0x39870b(0x192))));}}}_0x4995ca&&await _0x1bd0b4[_0x39870b(0x17e)](_0x46d13a,{'val':JSON[_0x39870b(0x195)](_0xb0990a),'ack':!![]});}catch(_0x3475e7){_0x1bd0b4[_0x39870b(0x1dc)][_0x39870b(0x221)](_0x39870b(0x1a2)+_0x3475e7[_0x39870b(0x1d3)]);}}async function checkCalendarTriggers(_0x338c66){const _0x7c4c30=a1_0xcac93b;if(!_0x338c66[_0x7c4c30(0x183)][_0x7c4c30(0x1aa)]||!_0x338c66['config'][_0x7c4c30(0x1af)])return;await updateSchedulePreview(_0x338c66);let _0x9c1c90={},_0x265d27={};try{const _0x147563=await _0x338c66[_0x7c4c30(0x1ef)]('analysis.energy.warmupTimes');if(_0x147563&&_0x147563['val'])_0x9c1c90=JSON[_0x7c4c30(0x167)](_0x147563[_0x7c4c30(0x1ce)]);const _0x4f7a1d=await _0x338c66['getStateAsync'](_0x7c4c30(0x1fa));if(_0x4f7a1d&&_0x4f7a1d[_0x7c4c30(0x1ce)])_0x265d27=JSON['parse'](_0x4f7a1d[_0x7c4c30(0x1ce)]);}catch(_0x5087dc){}let _0x237793={'default':0x15};try{const _0x542f40=await _0x338c66['getStateAsync']('analysis.energy.warmupTargets');if(_0x542f40&&_0x542f40[_0x7c4c30(0x1ce)])_0x237793=JSON[_0x7c4c30(0x167)](_0x542f40[_0x7c4c30(0x1ce)]);}catch(_0xa50109){}let _0x243972=[];try{const _0x278fa7=await _0x338c66[_0x7c4c30(0x1ef)](_0x7c4c30(0x182));if(_0x278fa7&&_0x278fa7['val'])_0x243972=JSON[_0x7c4c30(0x167)](_0x278fa7[_0x7c4c30(0x1ce)]);}catch(_0x378123){}try{const _0x21f995=await _0x338c66['getForeignStateAsync'](_0x338c66[_0x7c4c30(0x183)][_0x7c4c30(0x1af)]+'.data.table');if(!_0x21f995||!_0x21f995['val'])return;const _0x2d96e2=JSON[_0x7c4c30(0x167)](_0x21f995[_0x7c4c30(0x1ce)]),_0x13d1a6=Date['now'](),_0x5166f5=_0x338c66['config'][_0x7c4c30(0x1d8)]||[],_0x4ad157=_0x338c66[_0x7c4c30(0x183)][_0x7c4c30(0x1d0)]||[];let _0x5150bf=![];for(const _0x36d26b of _0x2d96e2){if(_0x36d26b[_0x7c4c30(0x229)]&&_0x4ad157[_0x7c4c30(0x1b9)]>0x0&&!_0x4ad157['includes'](_0x36d26b[_0x7c4c30(0x229)]))continue;const _0x310759=_0x36d26b[_0x7c4c30(0x17b)]||_0x36d26b[_0x7c4c30(0x20e)]||_0x36d26b[_0x7c4c30(0x1bb)];if(!_0x310759)continue;const _0x19e5e5=new Date(_0x310759);if(isNaN(_0x19e5e5[_0x7c4c30(0x1e9)]()))continue;const _0x55e0dd=(_0x36d26b[_0x7c4c30(0x1a7)]||_0x36d26b[_0x7c4c30(0x1bf)]||'')[_0x7c4c30(0x1de)]();if(_0x55e0dd[_0x7c4c30(0x1ff)](_0x7c4c30(0x1cd))||_0x55e0dd[_0x7c4c30(0x1ff)](_0x7c4c30(0x1da))||_0x55e0dd[_0x7c4c30(0x1ff)](_0x7c4c30(0x1b8))){let _0x3d250e=0x0;Object[_0x7c4c30(0x16d)](_0x9c1c90)[_0x7c4c30(0x181)](_0x115ee8=>{if(_0x115ee8>_0x3d250e)_0x3d250e=_0x115ee8;});if(_0x3d250e===0x0)_0x3d250e=0x78;const _0x2b77fd=_0x19e5e5[_0x7c4c30(0x1e9)]()-_0x3d250e*0xea60;_0x13d1a6>=_0x2b77fd&&_0x13d1a6<_0x19e5e5['getTime']()&&(_0x338c66['currentSystemMode']!=='normal'&&(_0x338c66[_0x7c4c30(0x1dc)]['info'](_0x7c4c30(0x1f9)+_0x3d250e+_0x7c4c30(0x213)),await _0x338c66[_0x7c4c30(0x17e)]('system.mode',{'val':_0x7c4c30(0x21c),'ack':![]})));}for(const _0x30e703 of _0x5166f5){if(_0x30e703[_0x7c4c30(0x1f0)]){const _0xbdde98=_0x30e703[_0x7c4c30(0x1f0)][_0x7c4c30(0x1de)](),_0x26732b=(_0x30e703['name']||'')[_0x7c4c30(0x1de)]();let _0x53df78=_0x55e0dd[_0x7c4c30(0x1ff)](_0xbdde98);!_0x53df78&&_0x26732b[_0x7c4c30(0x1b9)]>0x3&&_0x55e0dd[_0x7c4c30(0x1ff)](_0x26732b)&&(_0x53df78=!![]);if(_0x53df78){const _0x982b14=getWarmupRobust(_0x9c1c90,_0x30e703[_0x7c4c30(0x1f0)]),_0x3efcad=_0x265d27[_0x30e703['location']]||_0x7c4c30(0x16e),_0x3629fa=_0x19e5e5[_0x7c4c30(0x1e9)]()-_0x982b14*0xea60;if(_0x13d1a6>=_0x3629fa&&_0x13d1a6<_0x19e5e5[_0x7c4c30(0x1e9)]()){const _0x382cdd=lastActions[_0x7c4c30(0x211)+_0x30e703[_0x7c4c30(0x1f0)]];if(_0x382cdd&&_0x13d1a6-_0x382cdd<CAL_COOLDOWN_MS)continue;const _0x4625d9=await findRelatedId(_0x338c66,_0x30e703['id'],_0x7c4c30(0x184));if(_0x4625d9){let _0x2c854c=_0x237793[_0x30e703[_0x7c4c30(0x1f0)]];if(_0x2c854c===undefined)_0x2c854c=_0x237793['default'];if(_0x2c854c===undefined)_0x2c854c=0x15;const _0x3844d7=await _0x338c66[_0x7c4c30(0x1fc)](_0x4625d9);if(_0x3844d7&&typeof _0x3844d7['val']===_0x7c4c30(0x21e)&&_0x3844d7[_0x7c4c30(0x1ce)]<_0x2c854c-0.5){_0x338c66[_0x7c4c30(0x1dc)][_0x7c4c30(0x1b2)](_0x7c4c30(0x16f)+_0x3efcad+_0x7c4c30(0x19a)+_0x30e703[_0x7c4c30(0x1f0)]+'\x27\x20(Match:\x20'+_0x55e0dd+_0x7c4c30(0x20c)+_0x2c854c+_0x7c4c30(0x1ac)+_0x982b14+_0x7c4c30(0x213)),await _0x338c66[_0x7c4c30(0x1b0)](_0x4625d9,_0x2c854c),await logAutomationAction(_0x338c66,'[CAL]\x20'+_0x30e703[_0x7c4c30(0x1f0)]+'\x20->\x20'+_0x2c854c+'Â°C\x20(via\x20'+_0x3efcad+')'),lastActions[_0x7c4c30(0x211)+_0x30e703[_0x7c4c30(0x1f0)]]=_0x13d1a6;const _0x36c7b5=_0x243972['findIndex'](_0x3c7333=>_0x3c7333[_0x7c4c30(0x214)]===_0x30e703['location']);if(_0x36c7b5!==-0x1)_0x243972[_0x7c4c30(0x16c)](_0x36c7b5,0x1);_0x243972[_0x7c4c30(0x1f1)]({'room':_0x30e703[_0x7c4c30(0x1f0)],'target':_0x2c854c,'until':_0x19e5e5[_0x7c4c30(0x1e9)]()}),_0x5150bf=!![];}}}}}}}_0x5150bf&&await _0x338c66[_0x7c4c30(0x17e)](_0x7c4c30(0x182),{'val':JSON[_0x7c4c30(0x195)](_0x243972),'ack':!![]});}catch(_0x52a5cc){_0x338c66[_0x7c4c30(0x1dc)][_0x7c4c30(0x227)](_0x7c4c30(0x1d6)+_0x52a5cc[_0x7c4c30(0x1d3)]);}}async function manageMpcIntervention(_0xb4e1b7,_0x206bd0,_0x3f973b){const _0x1d85a1=a1_0xcac93b;try{const _0x34bba7='analysis.energy.mpcActiveInterventions',_0x4b9498=await _0xb4e1b7[_0x1d85a1(0x1ef)](_0x34bba7);let _0x269b73=[];if(_0x4b9498&&_0x4b9498[_0x1d85a1(0x1ce)])try{_0x269b73=JSON[_0x1d85a1(0x167)](_0x4b9498[_0x1d85a1(0x1ce)]);}catch(_0x42f01f){}const _0x65e8a7=_0x269b73['indexOf'](_0x206bd0);if(_0x3f973b===_0x1d85a1(0x1a5))_0x65e8a7===-0x1&&(_0x269b73[_0x1d85a1(0x1f1)](_0x206bd0),await _0xb4e1b7['setStateAsync'](_0x34bba7,{'val':JSON[_0x1d85a1(0x195)](_0x269b73),'ack':!![]}));else _0x3f973b===_0x1d85a1(0x1e5)&&(_0x65e8a7!==-0x1&&(_0x269b73[_0x1d85a1(0x16c)](_0x65e8a7,0x1),await _0xb4e1b7['setStateAsync'](_0x34bba7,{'val':JSON[_0x1d85a1(0x195)](_0x269b73),'ack':!![]})));}catch(_0x299f19){}}async function cleanupGhostInterventions(_0x1916f2){const _0x33b6dd=a1_0xcac93b;try{const _0x3d0a27=_0x33b6dd(0x1be),_0x56ac94=await _0x1916f2[_0x33b6dd(0x1ef)](_0x3d0a27);if(!_0x56ac94||!_0x56ac94[_0x33b6dd(0x1ce)])return;const _0xa81f76=JSON[_0x33b6dd(0x167)](_0x56ac94[_0x33b6dd(0x1ce)]);if(!Array[_0x33b6dd(0x1ee)](_0xa81f76)||_0xa81f76[_0x33b6dd(0x1b9)]===0x0)return;let _0x5b8bbb={'default':0x15};try{const _0x40375b=await _0x1916f2[_0x33b6dd(0x1ef)](_0x33b6dd(0x203));if(_0x40375b&&_0x40375b[_0x33b6dd(0x1ce)])_0x5b8bbb=JSON[_0x33b6dd(0x167)](_0x40375b[_0x33b6dd(0x1ce)]);}catch(_0x1c7fc5){}let _0x1486fd=[];try{const _0x4e0cde=await _0x1916f2[_0x33b6dd(0x1ef)](_0x33b6dd(0x1c4));if(_0x4e0cde&&_0x4e0cde[_0x33b6dd(0x1ce)])_0x1486fd=JSON[_0x33b6dd(0x167)](_0x4e0cde[_0x33b6dd(0x1ce)]);}catch(_0x9b7ecc){}let _0x51f9d8={},_0x38c202=![];try{const _0x46dc7a=await _0x1916f2['getStateAsync'](_0x33b6dd(0x1c1));if(_0x46dc7a&&_0x46dc7a['val'])_0x51f9d8=JSON[_0x33b6dd(0x167)](_0x46dc7a[_0x33b6dd(0x1ce)]);}catch(_0x52ace5){}if(_0x51f9d8[_0x33b6dd(0x1ca)]){const _0x126e01=Date[_0x33b6dd(0x19d)]();for(const [_0x53b98d,_0x4827d1]of Object[_0x33b6dd(0x1c2)](_0x51f9d8[_0x33b6dd(0x1ca)])){_0x126e01-_0x4827d1>PENALTY_TTL&&(delete _0x51f9d8[_0x53b98d],delete _0x51f9d8[_0x33b6dd(0x1ca)][_0x53b98d],_0x38c202=!![],_0x1916f2[_0x33b6dd(0x1dc)][_0x33b6dd(0x1b2)](_0x33b6dd(0x1d2)+_0x53b98d+_0x33b6dd(0x1d5)));}}const _0xe9857b=_0x1916f2[_0x33b6dd(0x183)][_0x33b6dd(0x1d8)]||[];let _0x3df200=![];for(let _0x5c76e8=_0xa81f76[_0x33b6dd(0x1b9)]-0x1;_0x5c76e8>=0x0;_0x5c76e8--){const _0x234652=_0xa81f76[_0x5c76e8],_0x4c7c0d=_0xe9857b[_0x33b6dd(0x1a9)](_0x1a4eef=>normalize(_0x1a4eef[_0x33b6dd(0x1f0)])===normalize(_0x234652)&&(_0x1a4eef[_0x33b6dd(0x1a8)]==='temperature'||_0x1a4eef[_0x33b6dd(0x1a8)]===_0x33b6dd(0x186)));if(!_0x4c7c0d){_0x1916f2[_0x33b6dd(0x1dc)]['warn'](_0x33b6dd(0x194)+_0x234652+_0x33b6dd(0x1f7)),_0xa81f76[_0x33b6dd(0x16c)](_0x5c76e8,0x1),_0x3df200=!![];continue;}if(_0x4c7c0d){const _0x172ca0=await findRelatedId(_0x1916f2,_0x4c7c0d['id'],_0x33b6dd(0x184)),_0x1ee037=await _0x1916f2[_0x33b6dd(0x1fc)](_0x4c7c0d['id']);if(_0x172ca0){const _0x303521=await _0x1916f2[_0x33b6dd(0x1fc)](_0x172ca0);if(_0x303521&&typeof _0x303521[_0x33b6dd(0x1ce)]===_0x33b6dd(0x21e)){let _0x49d442=![],_0x338c22='';Math['abs'](_0x303521[_0x33b6dd(0x1ce)]-ECO_TEMP)>0.5&&(_0x49d442=!![],_0x338c22=_0x33b6dd(0x1c7));if(!_0x49d442&&_0x1ee037&&typeof _0x1ee037[_0x33b6dd(0x1ce)]===_0x33b6dd(0x21e)){const _0x3c245a=_0x5b8bbb[_0x234652]||_0x5b8bbb['default']||0x15;_0x1ee037[_0x33b6dd(0x1ce)]<_0x3c245a+0.2&&(_0x49d442=!![],_0x338c22=_0x33b6dd(0x1e2));}if(_0x49d442){if(_0x338c22===_0x33b6dd(0x1c7)){_0x1916f2[_0x33b6dd(0x1dc)][_0x33b6dd(0x1b2)](_0x33b6dd(0x1cf)+_0x234652+'\x20ist\x20auf\x20'+_0x303521['val']+_0x33b6dd(0x166)+ECO_TEMP+_0x33b6dd(0x178));const _0xf4c8f2=lastActions['cal_'+_0x234652],_0x3bcca2=_0xf4c8f2&&Date['now']()-_0xf4c8f2<0x2*0x3c*0x3e8;if(!_0x3bcca2&&_0x303521[_0x33b6dd(0x1ce)]>ECO_TEMP+0.5){_0x1916f2[_0x33b6dd(0x21a)]&&(_0x1916f2[_0x33b6dd(0x1dc)][_0x33b6dd(0x1b2)](_0x33b6dd(0x222)+_0x234652+_0x33b6dd(0x1eb)),_0x1916f2['sendToPythonWrapper'](_0x33b6dd(0x19e),{'room':_0x234652}));const _0x38ee52=_0x234652+'_'+new Date()['getHours']();if(!_0x51f9d8[_0x38ee52]){_0x51f9d8[_0x38ee52]=0x1;if(!_0x51f9d8[_0x33b6dd(0x1ca)])_0x51f9d8[_0x33b6dd(0x1ca)]={};_0x51f9d8[_0x33b6dd(0x1ca)][_0x38ee52]=Date[_0x33b6dd(0x19d)](),_0x38c202=!![];}}else _0x3bcca2&&_0x1916f2['log'][_0x33b6dd(0x1b2)]('ðŸ“…\x20[MPC\x20INFO]\x20'+_0x234652+'\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.');}else{if(_0x338c22===_0x33b6dd(0x1e2)){let _0x3c4aab=![];if(_0x1486fd[_0x33b6dd(0x1a9)](_0x1bb47e=>_0x1bb47e['room']===_0x234652))_0x3c4aab=!![];const _0x40edce=_0xe9857b['filter'](_0x7ae449=>normalize(_0x7ae449[_0x33b6dd(0x1f0)])===normalize(_0x234652)&&(_0x7ae449[_0x33b6dd(0x1a8)]===_0x33b6dd(0x1c5)||_0x7ae449[_0x33b6dd(0x1a8)]==='sensor'||_0x7ae449['type']===_0x33b6dd(0x20f)));for(const _0x417e06 of _0x40edce){try{const _0x49a8b7=await _0x1916f2[_0x33b6dd(0x1fc)](_0x417e06['id']);if(_0x49a8b7&&(_0x49a8b7[_0x33b6dd(0x1ce)]===!![]||_0x49a8b7['val']===0x1||String(_0x49a8b7[_0x33b6dd(0x1ce)])[_0x33b6dd(0x1de)]()===_0x33b6dd(0x172)))_0x3c4aab=!![];}catch(_0x7014e4){}}if(_0x3c4aab)_0x1916f2[_0x33b6dd(0x1dc)][_0x33b6dd(0x1b2)](_0x33b6dd(0x1c6)+_0x234652+_0x33b6dd(0x223));else{const _0x24c215=_0x5b8bbb[_0x234652]||_0x5b8bbb[_0x33b6dd(0x191)]||0x15;_0x1916f2[_0x33b6dd(0x1dc)][_0x33b6dd(0x1b2)](_0x33b6dd(0x21f)+_0x234652+_0x33b6dd(0x1d4)+_0x1ee037['val']+'Â°C\x20<\x20'+(_0x24c215+0.2)+_0x33b6dd(0x1b5)),await _0x1916f2['setForeignStateAsync'](_0x172ca0,_0x24c215),await logAutomationAction(_0x1916f2,_0x33b6dd(0x168)+_0x234652+':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20'+_0x24c215+'Â°C'),lastActions[_0x33b6dd(0x196)+_0x234652]=Date[_0x33b6dd(0x19d)]();}}}_0xa81f76[_0x33b6dd(0x16c)](_0x5c76e8,0x1),_0x3df200=!![];}}}}}_0x3df200&&await _0x1916f2['setStateAsync'](_0x3d0a27,{'val':JSON[_0x33b6dd(0x195)](_0xa81f76),'ack':!![]}),_0x38c202&&await _0x1916f2[_0x33b6dd(0x17e)](_0x33b6dd(0x1c1),{'val':JSON[_0x33b6dd(0x195)](_0x51f9d8),'ack':!![]});}catch(_0x493ba4){}}async function applyEnergySavings(_0x4f92c1,_0x2f877a){const _0x2c04e2=a1_0xcac93b;await cleanupGhostInterventions(_0x4f92c1);if(!_0x2f877a||_0x2f877a['length']===0x0)return;const _0x445a13=_0x4f92c1[_0x2c04e2(0x183)][_0x2c04e2(0x1d8)]||[],_0x4f7793=Date[_0x2c04e2(0x19d)]();for(const _0x27fe19 of _0x2f877a){const _0x3ae550=_0x27fe19[_0x2c04e2(0x214)],_0x28c440=_0x27fe19[_0x2c04e2(0x1ab)],_0x5717b9=_0x27fe19[_0x2c04e2(0x198)]||0x15;if(lastActions[_0x2c04e2(0x196)+_0x3ae550]&&_0x4f7793-lastActions[_0x2c04e2(0x196)+_0x3ae550]<RESCUE_LOCK_MS)continue;const _0x47c1bf=_0x445a13[_0x2c04e2(0x1a9)](_0x1073cc=>normalize(_0x1073cc[_0x2c04e2(0x1f0)])===normalize(_0x3ae550)&&(_0x1073cc[_0x2c04e2(0x1a8)]===_0x2c04e2(0x206)||_0x1073cc['type']===_0x2c04e2(0x186)));if(!_0x47c1bf)continue;const _0x593e50=await findRelatedId(_0x4f92c1,_0x47c1bf['id'],_0x2c04e2(0x184));if(_0x593e50){if(lastActions[_0x2c04e2(0x189)+_0x3ae550]&&_0x4f7793-lastActions[_0x2c04e2(0x189)+_0x3ae550]<0x1e*0x3c*0x3e8)continue;const _0x2f6e7a=await _0x4f92c1[_0x2c04e2(0x1fc)](_0x593e50);if(_0x2f6e7a&&typeof _0x2f6e7a[_0x2c04e2(0x1ce)]==='number'){const _0x2ae89e=_0x2f6e7a['val'];_0x2ae89e!==ECO_TEMP&&await manageMpcIntervention(_0x4f92c1,_0x3ae550,_0x2c04e2(0x1e5));if(_0x28c440>0x1e)_0x2ae89e>ECO_TEMP+0.5&&(_0x4f92c1['log'][_0x2c04e2(0x1b2)](_0x2c04e2(0x209)+_0x3ae550+'\x20auf\x20'+ECO_TEMP+_0x2c04e2(0x20a)+_0x28c440+_0x2c04e2(0x19c)),await _0x4f92c1[_0x2c04e2(0x1b0)](_0x593e50,ECO_TEMP),await manageMpcIntervention(_0x4f92c1,_0x3ae550,_0x2c04e2(0x1a5)),lastActions[_0x2c04e2(0x189)+_0x3ae550]=_0x4f7793,await logAutomationAction(_0x4f92c1,_0x2c04e2(0x1e0)+_0x3ae550+_0x2c04e2(0x188)+ECO_TEMP+'Â°C'));else _0x28c440<=0xf&&(_0x2ae89e<_0x5717b9&&(_0x4f92c1['log'][_0x2c04e2(0x1b2)](_0x2c04e2(0x1ed)+_0x3ae550+_0x2c04e2(0x197)+_0x5717b9+_0x2c04e2(0x226)),await _0x4f92c1[_0x2c04e2(0x1b0)](_0x593e50,_0x5717b9),await manageMpcIntervention(_0x4f92c1,_0x3ae550,_0x2c04e2(0x1e5)),lastActions[_0x2c04e2(0x189)+_0x3ae550]=_0x4f7793,await logAutomationAction(_0x4f92c1,_0x2c04e2(0x1e0)+_0x3ae550+_0x2c04e2(0x19f)+_0x5717b9+'Â°C')));}}else _0x4f92c1[_0x2c04e2(0x1dc)][_0x2c04e2(0x227)](_0x2c04e2(0x180)+_0x3ae550+_0x2c04e2(0x225));}}module[a1_0xcac93b(0x1b4)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};