const a1_0x30bca8=a1_0x1037;(function(_0x19cb8c,_0x3b4983){const _0x5e7377=a1_0x1037,_0x4b848e=_0x19cb8c();while(!![]){try{const _0x38c2ec=parseInt(_0x5e7377(0x19d))/0x1+parseInt(_0x5e7377(0x1c1))/0x2+parseInt(_0x5e7377(0x1b1))/0x3+-parseInt(_0x5e7377(0x1c7))/0x4*(-parseInt(_0x5e7377(0x1ff))/0x5)+parseInt(_0x5e7377(0x20c))/0x6+parseInt(_0x5e7377(0x21b))/0x7+-parseInt(_0x5e7377(0x1e4))/0x8;if(_0x38c2ec===_0x3b4983)break;else _0x4b848e['push'](_0x4b848e['shift']());}catch(_0x34b962){_0x4b848e['push'](_0x4b848e['shift']());}}}(a1_0x250e,0xd0cae));const a1_0x22d090=(function(){let _0x280f43=!![];return function(_0x20f2a3,_0x3e45a9){const _0x2dda36=_0x280f43?function(){const _0x12cf95=a1_0x1037;if(_0x3e45a9){const _0x250513=_0x3e45a9[_0x12cf95(0x1cd)](_0x20f2a3,arguments);return _0x3e45a9=null,_0x250513;}}:function(){};return _0x280f43=![],_0x2dda36;};}()),a1_0x2470f5=a1_0x22d090(this,function(){const _0x5b94e4=a1_0x1037;return a1_0x2470f5[_0x5b94e4(0x231)]()[_0x5b94e4(0x1c9)]('(((.+)+)+)+$')['toString']()['constructor'](a1_0x2470f5)[_0x5b94e4(0x1c9)](_0x5b94e4(0x22e));});a1_0x2470f5();'use strict';const aiAgent=require(a1_0x30bca8(0x216)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x1ff24e){const _0x4cb26f=a1_0x30bca8;if(!_0x1ff24e)return'';return _0x1ff24e[_0x4cb26f(0x21a)]()[_0x4cb26f(0x23b)](/\s+/g,'')[_0x4cb26f(0x23f)]();}function getWarmupRobust(_0x481b58,_0x13b572){const _0x2a47e5=a1_0x30bca8;if(!_0x481b58||!_0x13b572)return 0x3c;if(_0x481b58[_0x13b572]!==undefined)return _0x481b58[_0x13b572];const _0x20b877=_0x13b572['toLowerCase']()[_0x2a47e5(0x23b)](/Ã¤/g,'ae')[_0x2a47e5(0x23b)](/Ã¶/g,'oe')[_0x2a47e5(0x23b)](/Ã¼/g,'ue')[_0x2a47e5(0x23b)](/ÃŸ/g,'ss')[_0x2a47e5(0x23b)](/\s+/g,'_')[_0x2a47e5(0x23b)](/[^a-z0-9_]/g,'');if(_0x481b58[_0x20b877]!==undefined)return _0x481b58[_0x20b877];return 0x3c;}async function logAutomationAction(_0x2a33f7,_0x84bd1f){const _0x3371ac=a1_0x30bca8;await _0x2a33f7[_0x3371ac(0x238)](_0x3371ac(0x217),{'val':_0x84bd1f,'ack':!![]});try{const _0x67a888=_0x3371ac(0x1e1),_0x142c32=await _0x2a33f7[_0x3371ac(0x1d7)](_0x67a888);let _0x104352=[];if(_0x142c32&&_0x142c32[_0x3371ac(0x1aa)])try{_0x104352=JSON[_0x3371ac(0x1c2)](_0x142c32[_0x3371ac(0x1aa)]);}catch(_0x4bdffe){}_0x104352[_0x3371ac(0x204)]({'ts':Date[_0x3371ac(0x1eb)](),'msg':_0x84bd1f});if(_0x104352['length']>0x32)_0x104352=_0x104352[_0x3371ac(0x1ea)](0x0,0x32);await _0x2a33f7[_0x3371ac(0x238)](_0x67a888,{'val':JSON[_0x3371ac(0x1ca)](_0x104352),'ack':!![]});}catch(_0x227159){}}async function handlePrediction(_0x5a56ac,_0xc27d53,_0x34b584){const _0x20114c=a1_0x30bca8;if(!_0xc27d53||_0xc27d53==='Unknown')return;let _0x4822a1='off',_0x32d376=0.6;try{const _0x46d194=await _0x5a56ac[_0x20114c(0x1d7)]('analysis.automation.mode');if(_0x46d194&&_0x46d194[_0x20114c(0x1aa)])_0x4822a1=_0x46d194[_0x20114c(0x1aa)];const _0xdb9655=await _0x5a56ac[_0x20114c(0x1d7)](_0x20114c(0x1ab));if(_0xdb9655&&_0xdb9655[_0x20114c(0x1aa)])_0x32d376=_0xdb9655[_0x20114c(0x1aa)];}catch(_0x4e1274){}if(_0x4822a1===_0x20114c(0x19f)||_0x34b584<_0x32d376)return;const _0x544966=Date[_0x20114c(0x1eb)]();if(lastActions[_0xc27d53]&&_0x544966-lastActions[_0xc27d53]<COOLDOWN_MS)return;const _0x489e8a=_0x5a56ac['config'][_0x20114c(0x206)]||[],_0x101af8=normalize(_0xc27d53),_0x5be0b6=_0x489e8a[_0x20114c(0x187)](_0xb7c450=>normalize(_0xb7c450[_0x20114c(0x1d0)])===_0x101af8&&(_0xb7c450[_0x20114c(0x184)]===_0x20114c(0x197)||_0xb7c450[_0x20114c(0x184)]===_0x20114c(0x1a1)||_0xb7c450[_0x20114c(0x184)]==='switch'));if(!_0x5be0b6)return;const _0x5f00c3=await aiAgent['consultButler'](_0x5a56ac,_0xc27d53,_0x5be0b6[_0x20114c(0x20f)],_0x34b584);if(!_0x5f00c3['approved'])return;const _0x35f7f0=_0x20114c(0x19a)+_0xc27d53+_0x20114c(0x1b3)+_0x5be0b6[_0x20114c(0x20f)]+'\x20('+_0x5f00c3[_0x20114c(0x235)]+')';await logAutomationAction(_0x5a56ac,'['+_0x4822a1['toUpperCase']()+']\x20'+_0x35f7f0);if(_0x4822a1===_0x20114c(0x20a)){const _0x5483db=await _0x5a56ac[_0x20114c(0x1e3)](_0x5be0b6['id']);(!_0x5483db||!_0x5483db[_0x20114c(0x1aa)]&&_0x5483db['val']!==!![])&&await _0x5a56ac['setForeignStateAsync'](_0x5be0b6['id'],!![]),lastActions[_0xc27d53]=_0x544966;}}function a1_0x1037(_0x4e6ed2,_0x4869c9){const _0x4c2e0b=a1_0x250e();return a1_0x1037=function(_0x2470f5,_0x22d090){_0x2470f5=_0x2470f5-0x17d;let _0x250e67=_0x4c2e0b[_0x2470f5];return _0x250e67;},a1_0x1037(_0x4e6ed2,_0x4869c9);}function a1_0x250e(){const _0x3ec4cc=['forEach','ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20','_date','push','Â°C\x20(via\x20','1547244BXRwgv','log','\x20->\x20Schalte\x20',')\x20aktiv.\x20Heize\x20auf\x20','actual','event','thermostatMapping','set','manual','messwert','wert','soll','number',']:\x20Raum-Trigger\x20\x27','open','analysis.energy.activeEnforcements','243494cuZrtC','parse','isArray','analysis.energy.rlPenalties','role','Â°C).\x20Sparmodus\x20beendet!','2189156qxsJrg','\x20gefunden!','search','stringify','ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','length','apply','ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','\x20min)','location','Â°C).\x20Entferne\x20Status.','Nicht\x20gefunden','local_temperature','room',':\x20Aufheizen\x20auf\x20','ðŸ“…\x20SMART\x20SCHEDULE\x20[','getStateAsync','Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20','Calendar\x20Check\x20Error:\x20','info','.1.ACTUAL_TEMPERATURE','until','message','\x20erreicht\x20Limit\x20(','TRAIN_RL_PENALTY','level','analysis.automation.actionLog','sendToPythonWrapper','getForeignStateAsync','25318840ktljvl','ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20','error','ðŸ“…\x20[MPC\x20INFO]\x20','.1.SET_POINT_TEMPERATURE','getTime','slice','now','analysis.energy.warmupSources','sensor','setForeignStateAsync','add','common','getHours','value.valve','valveMapping','\x20->\x20','setpoint','splice','ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20','_meta','.1.LEVEL','warn','join','window','getForeignObjectsAsync','mpc_','10wKDjPg','Fehlt','Â°C\x20->\x20','valve','ACTUAL','unshift','includes','devices','eventStart','default','\x20ist\x20auf\x20','active','getForeignObjectAsync','8770236yWNryW','score','calendarInstance','name','analysis.energy.mpcActiveInterventions','entries','Â°C\x20(nicht\x20','hm-rpc','current_heating_setpoint','ankunft','./ai_agent','analysis.automation.lastAction','ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','rÃ¼ckkehr','toLowerCase','3066245AkppbW','ðŸ§¹\x20[MPC\x20CLEANUP]\x20','summary','target','analysis.energy.warmupTargets','\x20auf\x20','\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.','sort','too_cold','system.mode','analysis.energy.warmupTimes','filter','string',':\x20Absenkung\x20auf\x20','useCalendar','ist','contact','temperature','[MPC]\x20','(((.+)+)+)+$','SET_POINT_TEMPERATURE','PERFECT','toString','calendarSelection','[CAL]\x20','values','reason','Â°C\x20(Vorlauf:\x20','pi_heating_demand','setStateAsync','SET','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','replace','Classic','.1.TEMPERATURE','rescue_','trim','position','config','analysis.energy.schedulePreview','unit','normal','from','thermostat.setpoint','stellwert','Â°C\x20(Kalender-Schutz)','cal_','valve_position','\x20min).','type','Unbekannt','triggerTime','find','thermostat','map','temp','level.temperature','.4.SET_TEMPERATURE','target_temperature','[FORCE]\x20','occupied_heating_setpoint','Â°C\x20<\x20','currentSystemMode','indexOf','Â°C.','remove','_calName','ACTUAL_TEMPERATURE','light','\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.','localeCompare','PrÃ¤diktion:\x20','urlaub\x20ende','Â°C!\x20(Puffer:\x20','388255KBmymf','date','off','\x20wurde\x20manuell\x20erhÃ¶ht.','dimmer','split','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','analysis.energy.ventilationAlerts','Ist','ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','abs','.data.table','findIndex','val','analysis.automation.confidenceThreshold'];a1_0x250e=function(){return _0x3ec4cc;};return a1_0x250e();}async function findRelatedId(_0x5ca14d,_0x4d9707,_0x47de3d=a1_0x30bca8(0x1f5)){const _0x1e00da=a1_0x30bca8;if(_0x47de3d==='setpoint'&&_0x5ca14d['config'][_0x1e00da(0x1b7)]){let _0x1aa876=_0x5ca14d[_0x1e00da(0x241)][_0x1e00da(0x1b7)];if(typeof _0x1aa876===_0x1e00da(0x227))try{_0x1aa876=JSON[_0x1e00da(0x1c2)](_0x1aa876);}catch(_0x526675){}if(_0x1aa876&&_0x1aa876[_0x4d9707])return _0x1aa876[_0x4d9707];}if(_0x47de3d===_0x1e00da(0x202)&&_0x5ca14d['config'][_0x1e00da(0x1f3)]){let _0x5c88fb=_0x5ca14d[_0x1e00da(0x241)]['valveMapping'];if(typeof _0x5c88fb==='string')try{_0x5c88fb=JSON[_0x1e00da(0x1c2)](_0x5c88fb);}catch(_0x9cb653){}if(_0x5c88fb&&_0x5c88fb[_0x4d9707])return _0x5c88fb[_0x4d9707];}let _0x589a2d=[];if(_0x47de3d===_0x1e00da(0x1f5))_0x589a2d=[{'s':_0x1e00da(0x1db),'t':_0x1e00da(0x1e8)},{'s':'.1.TEMPERATURE','t':_0x1e00da(0x1e8)},{'s':_0x1e00da(0x23d),'t':_0x1e00da(0x18c)},{'s':_0x1e00da(0x196),'t':_0x1e00da(0x22f)},{'s':_0x1e00da(0x1d3),'t':_0x1e00da(0x18f)},{'s':_0x1e00da(0x1d3),'t':_0x1e00da(0x214)},{'s':_0x1e00da(0x22c),'t':_0x1e00da(0x18d)},{'s':_0x1e00da(0x203),'t':_0x1e00da(0x239)},{'s':_0x1e00da(0x1a5),'t':'Soll'},{'s':_0x1e00da(0x22c),'t':_0x1e00da(0x1f5)}];else _0x47de3d===_0x1e00da(0x202)&&(_0x589a2d=[{'s':_0x1e00da(0x1db),'t':'.1.LEVEL'},{'s':'.1.TEMPERATURE','t':_0x1e00da(0x1f9)},{'s':_0x1e00da(0x23d),'t':'.4.VALVE_STATE'},{'s':_0x1e00da(0x1d3),'t':_0x1e00da(0x237)},{'s':_0x1e00da(0x22c),'t':_0x1e00da(0x182)},{'s':_0x1e00da(0x22c),'t':_0x1e00da(0x1e0)}]);for(const _0x336d0e of _0x589a2d){if(_0x4d9707[_0x1e00da(0x205)](_0x336d0e['s'])){const _0x427dc2=_0x4d9707[_0x1e00da(0x23b)](_0x336d0e['s'],_0x336d0e['t']),_0x1b7fe9=await _0x5ca14d[_0x1e00da(0x20b)](_0x427dc2);if(_0x1b7fe9)return _0x427dc2;}}try{const _0x3bf993=_0x4d9707[_0x1e00da(0x1a2)]('.');if(_0x3bf993[_0x1e00da(0x1cc)]>0x2){const _0x5958d7=_0x3bf993[_0x1e00da(0x1ea)](0x0,-0x1)[_0x1e00da(0x1fb)]('.'),_0x2301a7=await _0x5ca14d[_0x1e00da(0x1fd)](_0x5958d7+'.*'),_0x1d8be9=[],_0x253ee4=_0x4d9707[_0x1e00da(0x1a2)](/[._]+/)[_0x1e00da(0x226)](_0x48c4a4=>!['openknx','0',_0x1e00da(0x213),_0x1e00da(0x22a),_0x1e00da(0x1bb),_0x1e00da(0x22c),_0x1e00da(0x1b5),'sensor',_0x1e00da(0x1ba),'state'][_0x1e00da(0x205)](_0x48c4a4[_0x1e00da(0x21a)]()));for(const [_0x28e9c5,_0x103c83]of Object[_0x1e00da(0x211)](_0x2301a7)){if(_0x28e9c5===_0x4d9707)continue;if(_0x103c83&&_0x103c83[_0x1e00da(0x1f0)]){const _0x34d9a8=_0x28e9c5[_0x1e00da(0x21a)](),_0xe6a158=(_0x103c83[_0x1e00da(0x1f0)][_0x1e00da(0x1c5)]||'')['toLowerCase'](),_0x26d0a5=(_0x103c83['common'][_0x1e00da(0x243)]||'')[_0x1e00da(0x21a)]();let _0x1efcaa=![];if(_0x47de3d===_0x1e00da(0x1f5)&&_0x103c83[_0x1e00da(0x1f0)]['write']===!![])_0x1efcaa=_0x34d9a8['includes'](_0x1e00da(0x1b8))||_0x34d9a8[_0x1e00da(0x205)](_0x1e00da(0x1bc))||_0x34d9a8[_0x1e00da(0x205)](_0x1e00da(0x21e))||_0xe6a158['includes'](_0x1e00da(0x18b))||_0xe6a158[_0x1e00da(0x205)](_0x1e00da(0x17e));else _0x47de3d==='valve'&&(_0x1efcaa=_0x34d9a8[_0x1e00da(0x205)](_0x1e00da(0x1e0))||_0x34d9a8['includes'](_0x1e00da(0x202))||_0x34d9a8[_0x1e00da(0x205)](_0x1e00da(0x17f))||_0x34d9a8['includes'](_0x1e00da(0x240))||_0xe6a158['includes']('level.valve')||_0xe6a158[_0x1e00da(0x205)](_0x1e00da(0x1f2))||_0x26d0a5['includes']('%'));if(_0x1efcaa){const _0x4c1722=_0x28e9c5[_0x1e00da(0x1a2)](/[._]+/)[_0x1e00da(0x189)](_0x34a762=>_0x34a762[_0x1e00da(0x21a)]());let _0x1cb68f=0x0;_0x253ee4['forEach'](_0x360071=>{const _0x3a9241=_0x1e00da;if(_0x4c1722[_0x3a9241(0x205)](_0x360071[_0x3a9241(0x21a)]()))_0x1cb68f++;}),_0x1d8be9[_0x1e00da(0x1af)]({'id':_0x28e9c5,'score':_0x1cb68f});}}}if(_0x1d8be9[_0x1e00da(0x1cc)]>0x0){_0x1d8be9[_0x1e00da(0x222)]((_0x13d195,_0x36e755)=>_0x36e755[_0x1e00da(0x20d)]-_0x13d195['score']);if(_0x1d8be9[0x0][_0x1e00da(0x20d)]>0x0)return _0x1d8be9[0x0]['id'];}}}catch(_0x3871b8){}return null;}async function scanThermostats(_0x340ada){const _0x1c0c15=a1_0x30bca8,_0x31b321=_0x340ada[_0x1c0c15(0x241)]['devices']||[],_0x238efb=[],_0x48fba7=_0x31b321[_0x1c0c15(0x226)](_0x2aae7e=>_0x2aae7e['id']&&_0x2aae7e['id'][_0x1c0c15(0x205)](_0x1c0c15(0x22c))||_0x2aae7e['type']&&[_0x1c0c15(0x22c),_0x1c0c15(0x188),_0x1c0c15(0x1ed)]['includes'](_0x2aae7e['type'])||_0x2aae7e[_0x1c0c15(0x20f)]&&_0x2aae7e[_0x1c0c15(0x20f)]['toLowerCase']()['includes'](_0x1c0c15(0x18a)));for(const _0x2fd5f3 of _0x48fba7){const _0x3a6ea8=await findRelatedId(_0x340ada,_0x2fd5f3['id'],_0x1c0c15(0x1f5)),_0x553ba2=await findRelatedId(_0x340ada,_0x2fd5f3['id'],'valve');let _0x328324=_0x1c0c15(0x1d2),_0xb4eefc=![],_0x1988a0=_0x340ada[_0x1c0c15(0x241)][_0x1c0c15(0x1b7)]||{};if(typeof _0x1988a0==='string')try{_0x1988a0=JSON[_0x1c0c15(0x1c2)](_0x1988a0);}catch(_0x4f05a2){}let _0x3f6c80=_0x340ada[_0x1c0c15(0x241)][_0x1c0c15(0x1f3)]||{};if(typeof _0x3f6c80===_0x1c0c15(0x227))try{_0x3f6c80=JSON[_0x1c0c15(0x1c2)](_0x3f6c80);}catch(_0x229fee){}if(_0x1988a0[_0x2fd5f3['id']]&&_0x1988a0[_0x2fd5f3['id']]===_0x3a6ea8||_0x3f6c80[_0x2fd5f3['id']]&&_0x3f6c80[_0x2fd5f3['id']]===_0x553ba2)_0x328324='Manuelles\x20Mapping',_0xb4eefc=!![];else(_0x3a6ea8||_0x553ba2)&&(_0x328324='Auto-Erkennung');_0x238efb[_0x1c0c15(0x1af)]({'room':_0x2fd5f3[_0x1c0c15(0x1d0)]||_0x1c0c15(0x185),'sensorId':_0x2fd5f3['id'],'setpointId':_0x3a6ea8||'-','valveId':_0x553ba2||'-','source':_0x328324,'isManual':_0xb4eefc,'status':_0x3a6ea8&&_0x553ba2?_0x1c0c15(0x230):_0x3a6ea8?'OK':_0x1c0c15(0x200)});}return _0x238efb[_0x1c0c15(0x222)]((_0x41c4d6,_0x9de335)=>_0x41c4d6[_0x1c0c15(0x1d4)][_0x1c0c15(0x199)](_0x9de335['room']));}async function updateSchedulePreview(_0x138d32){const _0x53ff3d=a1_0x30bca8;if(!_0x138d32[_0x53ff3d(0x241)][_0x53ff3d(0x229)]||!_0x138d32[_0x53ff3d(0x241)][_0x53ff3d(0x20e)])return;let _0x3f3c44={};try{const _0x3f56ed=await _0x138d32[_0x53ff3d(0x1d7)]('analysis.energy.warmupTimes');if(_0x3f56ed&&_0x3f56ed['val'])_0x3f3c44=JSON['parse'](_0x3f56ed[_0x53ff3d(0x1aa)]);}catch(_0x5854bb){}const _0xa55e85=[],_0x320343=Date[_0x53ff3d(0x1eb)](),_0x4b36f9=0x30*0x3c*0x3c*0x3e8;try{const _0x27b09b=await _0x138d32[_0x53ff3d(0x1e3)](_0x138d32[_0x53ff3d(0x241)][_0x53ff3d(0x20e)]+_0x53ff3d(0x1a8));if(!_0x27b09b||!_0x27b09b[_0x53ff3d(0x1aa)])return;const _0x23d4b6=JSON['parse'](_0x27b09b[_0x53ff3d(0x1aa)]),_0x4206e1=_0x138d32[_0x53ff3d(0x241)][_0x53ff3d(0x232)]||[],_0x5a251d=_0x138d32[_0x53ff3d(0x241)]['devices']||[],_0x5ea52c=new Set();_0x5a251d['forEach'](_0xd05b7f=>{const _0x1d52a0=_0x53ff3d;if(_0xd05b7f[_0x1d52a0(0x1d0)])_0x5ea52c[_0x1d52a0(0x1ef)](_0xd05b7f['location']);});for(const _0x111180 of _0x23d4b6){if(_0x111180[_0x53ff3d(0x195)]&&_0x4206e1[_0x53ff3d(0x1cc)]>0x0&&!_0x4206e1[_0x53ff3d(0x205)](_0x111180[_0x53ff3d(0x195)]))continue;const _0x111e7a=_0x111180['_date']||_0x111180[_0x53ff3d(0x207)]||_0x111180[_0x53ff3d(0x19e)];if(!_0x111e7a)continue;const _0x311970=new Date(_0x111e7a),_0x5af789=_0x311970[_0x53ff3d(0x1e9)]();if(isNaN(_0x5af789))continue;if(_0x5af789<_0x320343)continue;if(_0x5af789>_0x320343+_0x4b36f9)continue;const _0x59402e=(_0x111180['event']||_0x111180['summary']||'')['toLowerCase']();let _0xcbe5fb=![],_0x2897da=[],_0x3d5eff=_0x111180[_0x53ff3d(0x1b6)]||_0x111180[_0x53ff3d(0x21d)]||'Unbekannt';if(_0x59402e[_0x53ff3d(0x205)](_0x53ff3d(0x19b))||_0x59402e[_0x53ff3d(0x205)](_0x53ff3d(0x219))||_0x59402e[_0x53ff3d(0x205)](_0x53ff3d(0x215)))_0xcbe5fb=!![],_0x2897da=Array[_0x53ff3d(0x17d)](_0x5ea52c);else for(const _0x597cb3 of _0x5ea52c){if(_0x59402e[_0x53ff3d(0x205)](_0x597cb3[_0x53ff3d(0x21a)]()))_0x2897da['push'](_0x597cb3);}_0x2897da[_0x53ff3d(0x1cc)]>0x0&&_0x2897da[_0x53ff3d(0x1ac)](_0x2f7c3c=>{const _0x226f23=_0x53ff3d;let _0x3bbd38=0x3c;if(_0xcbe5fb){let _0x290109=0x0;Object['values'](_0x3f3c44)[_0x226f23(0x1ac)](_0x27fb67=>{if(_0x27fb67>_0x290109)_0x290109=_0x27fb67;}),_0x3bbd38=_0x290109>0x0?_0x290109:0x78;}else _0x3bbd38=getWarmupRobust(_0x3f3c44,_0x2f7c3c);const _0x3b9e63=new Date(_0x5af789-_0x3bbd38*0xea60);_0xa55e85[_0x226f23(0x1af)]({'eventTime':_0x5af789,'triggerTime':_0x3b9e63[_0x226f23(0x1e9)](),'room':_0x2f7c3c,'minutes':_0x3bbd38,'reason':_0x3d5eff,'isGlobal':_0xcbe5fb});});}}catch(_0x4bb23a){}_0xa55e85[_0x53ff3d(0x222)]((_0x34af37,_0x9d1786)=>_0x34af37['triggerTime']-_0x9d1786[_0x53ff3d(0x186)]);const _0x18f105=_0xa55e85['slice'](0x0,0x5);await _0x138d32['setStateAsync'](_0x53ff3d(0x242),{'val':JSON['stringify'](_0x18f105),'ack':!![]});}async function monitorEnforcements(_0x177152){const _0x587e81=a1_0x30bca8;try{const _0x431de8=_0x587e81(0x1c0),_0x351266=await _0x177152['getStateAsync'](_0x431de8);if(!_0x351266||!_0x351266[_0x587e81(0x1aa)])return;let _0x137416=[];try{_0x137416=JSON[_0x587e81(0x1c2)](_0x351266['val']);}catch(_0x46ad21){return;}if(!Array[_0x587e81(0x1c3)](_0x137416)||_0x137416['length']===0x0)return;const _0x225fc9=Date[_0x587e81(0x1eb)](),_0x1bbc97=_0x177152[_0x587e81(0x241)][_0x587e81(0x206)]||[];let _0x2c57b0=![];for(let _0x4b46a3=_0x137416[_0x587e81(0x1cc)]-0x1;_0x4b46a3>=0x0;_0x4b46a3--){const _0x521548=_0x137416[_0x4b46a3];if(_0x225fc9>=_0x521548[_0x587e81(0x1dc)]){_0x177152[_0x587e81(0x1b2)][_0x587e81(0x1da)](_0x587e81(0x1cb)+_0x521548[_0x587e81(0x1d4)]+'\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.'),_0x137416[_0x587e81(0x1f6)](_0x4b46a3,0x1),_0x2c57b0=!![];continue;}const _0x4bd858=_0x1bbc97[_0x587e81(0x187)](_0x195c16=>normalize(_0x195c16['location'])===normalize(_0x521548[_0x587e81(0x1d4)])&&(_0x195c16[_0x587e81(0x184)]===_0x587e81(0x22c)||_0x195c16[_0x587e81(0x184)]===_0x587e81(0x188)));if(_0x4bd858){const _0x4b35f3=await findRelatedId(_0x177152,_0x4bd858['id'],_0x587e81(0x1f5));if(_0x4b35f3){const _0x294915=await _0x177152['getForeignStateAsync'](_0x4b35f3);_0x294915&&typeof _0x294915[_0x587e81(0x1aa)]===_0x587e81(0x1bd)&&(_0x294915[_0x587e81(0x1aa)]<0xf&&(_0x177152[_0x587e81(0x1b2)][_0x587e81(0x1fa)](_0x587e81(0x1ce)+_0x521548[_0x587e81(0x1d4)]+'\x20auf\x20'+_0x294915[_0x587e81(0x1aa)]+_0x587e81(0x1d8)+_0x521548['target']+_0x587e81(0x193)),await _0x177152[_0x587e81(0x1ee)](_0x4b35f3,_0x521548['target']),await logAutomationAction(_0x177152,_0x587e81(0x18e)+_0x521548[_0x587e81(0x1d4)]+':\x20'+_0x294915['val']+_0x587e81(0x201)+_0x521548[_0x587e81(0x21e)]+_0x587e81(0x180))));}}}_0x2c57b0&&await _0x177152[_0x587e81(0x238)](_0x431de8,{'val':JSON[_0x587e81(0x1ca)](_0x137416),'ack':!![]});}catch(_0x246037){_0x177152[_0x587e81(0x1b2)][_0x587e81(0x1e6)]('Enforcement\x20Monitor\x20Error:\x20'+_0x246037['message']);}}async function checkCalendarTriggers(_0x34b6de){const _0x573f71=a1_0x30bca8;if(!_0x34b6de[_0x573f71(0x241)][_0x573f71(0x229)]||!_0x34b6de[_0x573f71(0x241)][_0x573f71(0x20e)])return;await updateSchedulePreview(_0x34b6de);let _0x434e08={},_0x15981b={};try{const _0x1453bc=await _0x34b6de[_0x573f71(0x1d7)](_0x573f71(0x225));if(_0x1453bc&&_0x1453bc['val'])_0x434e08=JSON[_0x573f71(0x1c2)](_0x1453bc[_0x573f71(0x1aa)]);const _0x5ee7e0=await _0x34b6de[_0x573f71(0x1d7)](_0x573f71(0x1ec));if(_0x5ee7e0&&_0x5ee7e0[_0x573f71(0x1aa)])_0x15981b=JSON[_0x573f71(0x1c2)](_0x5ee7e0['val']);}catch(_0xdc865c){}let _0x3906b0={'default':0x15};try{const _0x2c7f96=await _0x34b6de['getStateAsync'](_0x573f71(0x21f));if(_0x2c7f96&&_0x2c7f96['val'])_0x3906b0=JSON[_0x573f71(0x1c2)](_0x2c7f96['val']);}catch(_0x23a751){}let _0x1e512a=[];try{const _0x7277d8=await _0x34b6de[_0x573f71(0x1d7)](_0x573f71(0x1c0));if(_0x7277d8&&_0x7277d8[_0x573f71(0x1aa)])_0x1e512a=JSON['parse'](_0x7277d8[_0x573f71(0x1aa)]);}catch(_0x386067){}try{const _0x5007a9=await _0x34b6de[_0x573f71(0x1e3)](_0x34b6de[_0x573f71(0x241)][_0x573f71(0x20e)]+_0x573f71(0x1a8));if(!_0x5007a9||!_0x5007a9['val'])return;const _0x38e711=JSON[_0x573f71(0x1c2)](_0x5007a9['val']),_0x39d545=Date['now'](),_0x5e66d0=_0x34b6de[_0x573f71(0x241)][_0x573f71(0x206)]||[],_0x2e6f6b=_0x34b6de[_0x573f71(0x241)][_0x573f71(0x232)]||[];let _0xc08d8b=![];for(const _0x97b65b of _0x38e711){if(_0x97b65b[_0x573f71(0x195)]&&_0x2e6f6b[_0x573f71(0x1cc)]>0x0&&!_0x2e6f6b[_0x573f71(0x205)](_0x97b65b[_0x573f71(0x195)]))continue;const _0x351ca6=_0x97b65b[_0x573f71(0x1ae)]||_0x97b65b[_0x573f71(0x207)]||_0x97b65b[_0x573f71(0x19e)];if(!_0x351ca6)continue;const _0x4a0bc9=new Date(_0x351ca6);if(isNaN(_0x4a0bc9[_0x573f71(0x1e9)]()))continue;const _0xb2b7e3=(_0x97b65b[_0x573f71(0x1b6)]||_0x97b65b[_0x573f71(0x21d)]||'')[_0x573f71(0x21a)]();if(_0xb2b7e3[_0x573f71(0x205)]('urlaub\x20ende')||_0xb2b7e3[_0x573f71(0x205)](_0x573f71(0x219))||_0xb2b7e3[_0x573f71(0x205)](_0x573f71(0x215))){let _0x523a19=0x0;Object[_0x573f71(0x234)](_0x434e08)[_0x573f71(0x1ac)](_0x2a2c20=>{if(_0x2a2c20>_0x523a19)_0x523a19=_0x2a2c20;});if(_0x523a19===0x0)_0x523a19=0x78;const _0x59b273=_0x4a0bc9[_0x573f71(0x1e9)]()-_0x523a19*0xea60;_0x39d545>=_0x59b273&&_0x39d545<_0x4a0bc9['getTime']()&&(_0x34b6de[_0x573f71(0x191)]!=='normal'&&(_0x34b6de[_0x573f71(0x1b2)][_0x573f71(0x1da)](_0x573f71(0x1a6)+_0x523a19+_0x573f71(0x183)),await _0x34b6de['setStateAsync'](_0x573f71(0x224),{'val':_0x573f71(0x244),'ack':![]})));}for(const _0x321e42 of _0x5e66d0){if(_0x321e42['location']){const _0x25c978=_0x321e42[_0x573f71(0x1d0)][_0x573f71(0x21a)](),_0x582af8=(_0x321e42[_0x573f71(0x20f)]||'')[_0x573f71(0x21a)]();let _0x1091e5=_0xb2b7e3[_0x573f71(0x205)](_0x25c978);!_0x1091e5&&_0x582af8['length']>0x3&&_0xb2b7e3[_0x573f71(0x205)](_0x582af8)&&(_0x1091e5=!![]);if(_0x1091e5){const _0x238673=getWarmupRobust(_0x434e08,_0x321e42['location']),_0x1d7237=_0x15981b[_0x321e42[_0x573f71(0x1d0)]]||_0x573f71(0x23c),_0x2f42b9=_0x4a0bc9[_0x573f71(0x1e9)]()-_0x238673*0xea60;if(_0x39d545>=_0x2f42b9&&_0x39d545<_0x4a0bc9[_0x573f71(0x1e9)]()){const _0x10ff7c=lastActions['cal_'+_0x321e42['location']];if(_0x10ff7c&&_0x39d545-_0x10ff7c<CAL_COOLDOWN_MS)continue;const _0x3439d0=await findRelatedId(_0x34b6de,_0x321e42['id'],_0x573f71(0x1f5));if(_0x3439d0){let _0x2feabf=_0x3906b0[_0x321e42['location']];if(_0x2feabf===undefined)_0x2feabf=_0x3906b0[_0x573f71(0x208)];if(_0x2feabf===undefined)_0x2feabf=0x15;const _0x212c3d=await _0x34b6de['getForeignStateAsync'](_0x3439d0);if(_0x212c3d&&typeof _0x212c3d['val']===_0x573f71(0x1bd)&&_0x212c3d[_0x573f71(0x1aa)]<_0x2feabf-0.5){_0x34b6de[_0x573f71(0x1b2)][_0x573f71(0x1da)](_0x573f71(0x1d6)+_0x1d7237+_0x573f71(0x1be)+_0x321e42[_0x573f71(0x1d0)]+'\x27\x20(Match:\x20'+_0xb2b7e3+_0x573f71(0x1b4)+_0x2feabf+_0x573f71(0x236)+_0x238673+_0x573f71(0x183)),await _0x34b6de['setForeignStateAsync'](_0x3439d0,_0x2feabf),await logAutomationAction(_0x34b6de,_0x573f71(0x233)+_0x321e42['location']+_0x573f71(0x1f4)+_0x2feabf+_0x573f71(0x1b0)+_0x1d7237+')'),lastActions['cal_'+_0x321e42['location']]=_0x39d545;const _0x127e66=_0x1e512a[_0x573f71(0x1a9)](_0x5e70f9=>_0x5e70f9['room']===_0x321e42[_0x573f71(0x1d0)]);if(_0x127e66!==-0x1)_0x1e512a[_0x573f71(0x1f6)](_0x127e66,0x1);_0x1e512a['push']({'room':_0x321e42[_0x573f71(0x1d0)],'target':_0x2feabf,'until':_0x4a0bc9[_0x573f71(0x1e9)]()}),_0xc08d8b=!![];}}}}}}}_0xc08d8b&&await _0x34b6de['setStateAsync']('analysis.energy.activeEnforcements',{'val':JSON[_0x573f71(0x1ca)](_0x1e512a),'ack':!![]});}catch(_0x600087){_0x34b6de['log'][_0x573f71(0x1fa)](_0x573f71(0x1d9)+_0x600087[_0x573f71(0x1dd)]);}}async function manageMpcIntervention(_0x82523d,_0x4fab9a,_0x926df5){const _0x4ab55e=a1_0x30bca8;try{const _0x25e813=_0x4ab55e(0x210),_0x14b110=await _0x82523d['getStateAsync'](_0x25e813);let _0x398a22=[];if(_0x14b110&&_0x14b110[_0x4ab55e(0x1aa)])try{_0x398a22=JSON[_0x4ab55e(0x1c2)](_0x14b110[_0x4ab55e(0x1aa)]);}catch(_0x5e6bfd){}const _0x2717f4=_0x398a22[_0x4ab55e(0x192)](_0x4fab9a);if(_0x926df5===_0x4ab55e(0x1ef))_0x2717f4===-0x1&&(_0x398a22[_0x4ab55e(0x1af)](_0x4fab9a),await _0x82523d['setStateAsync'](_0x25e813,{'val':JSON[_0x4ab55e(0x1ca)](_0x398a22),'ack':!![]}));else _0x926df5===_0x4ab55e(0x194)&&(_0x2717f4!==-0x1&&(_0x398a22[_0x4ab55e(0x1f6)](_0x2717f4,0x1),await _0x82523d[_0x4ab55e(0x238)](_0x25e813,{'val':JSON[_0x4ab55e(0x1ca)](_0x398a22),'ack':!![]})));}catch(_0x4b0761){}}async function cleanupGhostInterventions(_0x4163ac){const _0x5a51b6=a1_0x30bca8;try{const _0x46b5bf='analysis.energy.mpcActiveInterventions',_0x514a83=await _0x4163ac['getStateAsync'](_0x46b5bf);if(!_0x514a83||!_0x514a83[_0x5a51b6(0x1aa)])return;const _0x1be733=JSON['parse'](_0x514a83[_0x5a51b6(0x1aa)]);if(!Array[_0x5a51b6(0x1c3)](_0x1be733)||_0x1be733[_0x5a51b6(0x1cc)]===0x0)return;let _0x2393ed={'default':0x15};try{const _0x502a2f=await _0x4163ac[_0x5a51b6(0x1d7)](_0x5a51b6(0x21f));if(_0x502a2f&&_0x502a2f['val'])_0x2393ed=JSON[_0x5a51b6(0x1c2)](_0x502a2f['val']);}catch(_0x4123e1){}let _0x8cf94b=[];try{const _0x5f32fc=await _0x4163ac[_0x5a51b6(0x1d7)](_0x5a51b6(0x1a4));if(_0x5f32fc&&_0x5f32fc[_0x5a51b6(0x1aa)])_0x8cf94b=JSON[_0x5a51b6(0x1c2)](_0x5f32fc[_0x5a51b6(0x1aa)]);}catch(_0x1411c3){}let _0x3cbee2={},_0x54491e=![];try{const _0x159b6c=await _0x4163ac[_0x5a51b6(0x1d7)]('analysis.energy.rlPenalties');if(_0x159b6c&&_0x159b6c['val'])_0x3cbee2=JSON[_0x5a51b6(0x1c2)](_0x159b6c['val']);}catch(_0x49fec0){}if(_0x3cbee2[_0x5a51b6(0x1f8)]){const _0x370b0b=Date[_0x5a51b6(0x1eb)]();for(const [_0x30109b,_0x2aef42]of Object[_0x5a51b6(0x211)](_0x3cbee2['_meta'])){_0x370b0b-_0x2aef42>PENALTY_TTL&&(delete _0x3cbee2[_0x30109b],delete _0x3cbee2[_0x5a51b6(0x1f8)][_0x30109b],_0x54491e=!![],_0x4163ac['log'][_0x5a51b6(0x1da)]('ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27'+_0x30109b+_0x5a51b6(0x1a3)));}}const _0x398f4e=_0x4163ac[_0x5a51b6(0x241)][_0x5a51b6(0x206)]||[];let _0x1add4d=![];for(let _0x5a4299=_0x1be733[_0x5a51b6(0x1cc)]-0x1;_0x5a4299>=0x0;_0x5a4299--){const _0x4a1650=_0x1be733[_0x5a4299],_0x174ae9=_0x398f4e[_0x5a51b6(0x187)](_0x361c4e=>normalize(_0x361c4e[_0x5a51b6(0x1d0)])===normalize(_0x4a1650)&&(_0x361c4e[_0x5a51b6(0x184)]===_0x5a51b6(0x22c)||_0x361c4e['type']==='thermostat'));if(!_0x174ae9){_0x4163ac[_0x5a51b6(0x1b2)][_0x5a51b6(0x1fa)]('ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27'+_0x4a1650+_0x5a51b6(0x221)),_0x1be733[_0x5a51b6(0x1f6)](_0x5a4299,0x1),_0x1add4d=!![];continue;}if(_0x174ae9){const _0x4fa843=await findRelatedId(_0x4163ac,_0x174ae9['id'],_0x5a51b6(0x1f5)),_0x16ca5b=await _0x4163ac[_0x5a51b6(0x1e3)](_0x174ae9['id']);if(_0x4fa843){const _0x2a5c64=await _0x4163ac[_0x5a51b6(0x1e3)](_0x4fa843);if(_0x2a5c64&&typeof _0x2a5c64[_0x5a51b6(0x1aa)]===_0x5a51b6(0x1bd)){let _0x1bb51c=![],_0xe43b1a='';Math[_0x5a51b6(0x1a7)](_0x2a5c64['val']-ECO_TEMP)>0.5&&(_0x1bb51c=!![],_0xe43b1a=_0x5a51b6(0x1b9));if(!_0x1bb51c&&_0x16ca5b&&typeof _0x16ca5b['val']===_0x5a51b6(0x1bd)){const _0x102b0a=_0x2393ed[_0x4a1650]||_0x2393ed[_0x5a51b6(0x208)]||0x15;_0x16ca5b[_0x5a51b6(0x1aa)]<_0x102b0a+0.2&&(_0x1bb51c=!![],_0xe43b1a=_0x5a51b6(0x223));}if(_0x1bb51c){if(_0xe43b1a===_0x5a51b6(0x1b9)){_0x4163ac['log'][_0x5a51b6(0x1da)](_0x5a51b6(0x21c)+_0x4a1650+_0x5a51b6(0x209)+_0x2a5c64['val']+_0x5a51b6(0x212)+ECO_TEMP+_0x5a51b6(0x1d1));const _0xc7c29f=lastActions[_0x5a51b6(0x181)+_0x4a1650],_0x25cbe1=_0xc7c29f&&Date[_0x5a51b6(0x1eb)]()-_0xc7c29f<0x2*0x3c*0x3e8;if(!_0x25cbe1&&_0x2a5c64['val']>ECO_TEMP+0.5){_0x4163ac[_0x5a51b6(0x1e2)]&&(_0x4163ac['log'][_0x5a51b6(0x1da)](_0x5a51b6(0x218)+_0x4a1650+_0x5a51b6(0x1a0)),_0x4163ac[_0x5a51b6(0x1e2)](_0x5a51b6(0x1df),{'room':_0x4a1650}));const _0x50beb1=_0x4a1650+'_'+new Date()[_0x5a51b6(0x1f1)]();if(!_0x3cbee2[_0x50beb1]){_0x3cbee2[_0x50beb1]=0x1;if(!_0x3cbee2[_0x5a51b6(0x1f8)])_0x3cbee2[_0x5a51b6(0x1f8)]={};_0x3cbee2['_meta'][_0x50beb1]=Date[_0x5a51b6(0x1eb)](),_0x54491e=!![];}}else _0x25cbe1&&_0x4163ac['log'][_0x5a51b6(0x1da)](_0x5a51b6(0x1e7)+_0x4a1650+_0x5a51b6(0x198));}else{if(_0xe43b1a===_0x5a51b6(0x223)){let _0x53c6d5=![];if(_0x8cf94b[_0x5a51b6(0x187)](_0x5903d3=>_0x5903d3[_0x5a51b6(0x1d4)]===_0x4a1650))_0x53c6d5=!![];const _0x4a88ce=_0x398f4e[_0x5a51b6(0x226)](_0x31a13c=>normalize(_0x31a13c['location'])===normalize(_0x4a1650)&&(_0x31a13c['type']===_0x5a51b6(0x1fc)||_0x31a13c[_0x5a51b6(0x184)]===_0x5a51b6(0x1ed)||_0x31a13c[_0x5a51b6(0x184)]===_0x5a51b6(0x22b)));for(const _0x9055c7 of _0x4a88ce){try{const _0x35c2fd=await _0x4163ac[_0x5a51b6(0x1e3)](_0x9055c7['id']);if(_0x35c2fd&&(_0x35c2fd[_0x5a51b6(0x1aa)]===!![]||_0x35c2fd[_0x5a51b6(0x1aa)]===0x1||String(_0x35c2fd[_0x5a51b6(0x1aa)])['toLowerCase']()===_0x5a51b6(0x1bf)))_0x53c6d5=!![];}catch(_0x373720){}}if(_0x53c6d5)_0x4163ac[_0x5a51b6(0x1b2)][_0x5a51b6(0x1da)](_0x5a51b6(0x1e5)+_0x4a1650+'\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.');else{const _0x9cbf4a=_0x2393ed[_0x4a1650]||_0x2393ed[_0x5a51b6(0x208)]||0x15;_0x4163ac['log'][_0x5a51b6(0x1da)](_0x5a51b6(0x23a)+_0x4a1650+_0x5a51b6(0x1de)+_0x16ca5b['val']+_0x5a51b6(0x190)+(_0x9cbf4a+0.2)+_0x5a51b6(0x1c6)),await _0x4163ac[_0x5a51b6(0x1ee)](_0x4fa843,_0x9cbf4a),await logAutomationAction(_0x4163ac,'[WATCHDOG]\x20'+_0x4a1650+':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20'+_0x9cbf4a+'Â°C'),lastActions[_0x5a51b6(0x23e)+_0x4a1650]=Date['now']();}}}_0x1be733[_0x5a51b6(0x1f6)](_0x5a4299,0x1),_0x1add4d=!![];}}}}}_0x1add4d&&await _0x4163ac[_0x5a51b6(0x238)](_0x46b5bf,{'val':JSON['stringify'](_0x1be733),'ack':!![]}),_0x54491e&&await _0x4163ac[_0x5a51b6(0x238)](_0x5a51b6(0x1c4),{'val':JSON['stringify'](_0x3cbee2),'ack':!![]});}catch(_0xe1e605){}}async function applyEnergySavings(_0x215eb1,_0x1a105d){const _0xb18e79=a1_0x30bca8;await cleanupGhostInterventions(_0x215eb1);if(!_0x1a105d||_0x1a105d[_0xb18e79(0x1cc)]===0x0)return;const _0x3cddd1=_0x215eb1[_0xb18e79(0x241)][_0xb18e79(0x206)]||[],_0x8b1102=Date['now']();for(const _0xc0debc of _0x1a105d){const _0x55ea9b=_0xc0debc[_0xb18e79(0x1d4)],_0x2cb14c=_0xc0debc['minutes_safe'],_0x52c42a=_0xc0debc[_0xb18e79(0x21e)]||0x15;if(lastActions[_0xb18e79(0x23e)+_0x55ea9b]&&_0x8b1102-lastActions[_0xb18e79(0x23e)+_0x55ea9b]<RESCUE_LOCK_MS)continue;const _0x39fcff=_0x3cddd1['find'](_0x19ac0c=>normalize(_0x19ac0c['location'])===normalize(_0x55ea9b)&&(_0x19ac0c[_0xb18e79(0x184)]==='temperature'||_0x19ac0c[_0xb18e79(0x184)]==='thermostat'));if(!_0x39fcff)continue;const _0x24375a=await findRelatedId(_0x215eb1,_0x39fcff['id'],_0xb18e79(0x1f5));if(_0x24375a){if(lastActions['mpc_'+_0x55ea9b]&&_0x8b1102-lastActions[_0xb18e79(0x1fe)+_0x55ea9b]<0x1e*0x3c*0x3e8)continue;const _0x28ad4c=await _0x215eb1['getForeignStateAsync'](_0x24375a);if(_0x28ad4c&&typeof _0x28ad4c[_0xb18e79(0x1aa)]===_0xb18e79(0x1bd)){const _0x56e388=_0x28ad4c['val'];_0x56e388!==ECO_TEMP&&await manageMpcIntervention(_0x215eb1,_0x55ea9b,_0xb18e79(0x194));if(_0x2cb14c>0x1e)_0x56e388>ECO_TEMP+0.5&&(_0x215eb1[_0xb18e79(0x1b2)][_0xb18e79(0x1da)](_0xb18e79(0x1ad)+_0x55ea9b+_0xb18e79(0x220)+ECO_TEMP+_0xb18e79(0x19c)+_0x2cb14c+_0xb18e79(0x1cf)),await _0x215eb1[_0xb18e79(0x1ee)](_0x24375a,ECO_TEMP),await manageMpcIntervention(_0x215eb1,_0x55ea9b,_0xb18e79(0x1ef)),lastActions[_0xb18e79(0x1fe)+_0x55ea9b]=_0x8b1102,await logAutomationAction(_0x215eb1,_0xb18e79(0x22d)+_0x55ea9b+_0xb18e79(0x228)+ECO_TEMP+'Â°C'));else _0x2cb14c<=0xf&&(_0x56e388<_0x52c42a&&(_0x215eb1[_0xb18e79(0x1b2)][_0xb18e79(0x1da)](_0xb18e79(0x1f7)+_0x55ea9b+'\x20wieder\x20auf\x20'+_0x52c42a+'Â°C!\x20(Puffer\x20leer).'),await _0x215eb1[_0xb18e79(0x1ee)](_0x24375a,_0x52c42a),await manageMpcIntervention(_0x215eb1,_0x55ea9b,_0xb18e79(0x194)),lastActions['mpc_'+_0x55ea9b]=_0x8b1102,await logAutomationAction(_0x215eb1,_0xb18e79(0x22d)+_0x55ea9b+_0xb18e79(0x1d5)+_0x52c42a+'Â°C')));}}else _0x215eb1[_0xb18e79(0x1b2)][_0xb18e79(0x1fa)]('[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20'+_0x55ea9b+_0xb18e79(0x1c8));}}module['exports']={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};