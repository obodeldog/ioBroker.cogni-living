const a1_0x3c79b0=a1_0x4f19;(function(_0x36518b,_0x4d43f1){const _0x457c21=a1_0x4f19,_0x120c97=_0x36518b();while(!![]){try{const _0x3f826e=parseInt(_0x457c21(0x1e3))/0x1+-parseInt(_0x457c21(0x203))/0x2*(parseInt(_0x457c21(0x1ee))/0x3)+-parseInt(_0x457c21(0x211))/0x4*(-parseInt(_0x457c21(0x1e4))/0x5)+parseInt(_0x457c21(0x25d))/0x6+parseInt(_0x457c21(0x250))/0x7+-parseInt(_0x457c21(0x1e9))/0x8*(parseInt(_0x457c21(0x1b0))/0x9)+-parseInt(_0x457c21(0x236))/0xa;if(_0x3f826e===_0x4d43f1)break;else _0x120c97['push'](_0x120c97['shift']());}catch(_0x53c9de){_0x120c97['push'](_0x120c97['shift']());}}}(a1_0xa5b8,0x3b2fe));const a1_0xcc196f=(function(){let _0x5422a6=!![];return function(_0x2d5f53,_0x36271a){const _0x1b5e31=_0x5422a6?function(){const _0x9c3c95=a1_0x4f19;if(_0x36271a){const _0x560437=_0x36271a[_0x9c3c95(0x1fb)](_0x2d5f53,arguments);return _0x36271a=null,_0x560437;}}:function(){};return _0x5422a6=![],_0x1b5e31;};}()),a1_0x220bd1=a1_0xcc196f(this,function(){const _0x4fc307=a1_0x4f19;return a1_0x220bd1[_0x4fc307(0x1dc)]()[_0x4fc307(0x252)](_0x4fc307(0x1e0))[_0x4fc307(0x1dc)]()[_0x4fc307(0x1f9)](a1_0x220bd1)[_0x4fc307(0x252)](_0x4fc307(0x1e0));});a1_0x220bd1();'use strict';const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x375a95){const _0x459e91=a1_0x4f19;if(!_0x375a95)return'';return _0x375a95['toLowerCase']()['replace'](/\s+/g,'')[_0x459e91(0x1f4)]();}function getWarmupRobust(_0x54fe4a,_0x465af9){const _0x1a6acb=a1_0x4f19;if(!_0x54fe4a||!_0x465af9)return 0x3c;if(_0x54fe4a[_0x465af9]!==undefined)return _0x54fe4a[_0x465af9];const _0x1206fe=_0x465af9[_0x1a6acb(0x233)]()[_0x1a6acb(0x225)](/√§/g,'ae')['replace'](/√∂/g,'oe')[_0x1a6acb(0x225)](/√º/g,'ue')[_0x1a6acb(0x225)](/√ü/g,'ss')[_0x1a6acb(0x225)](/\s+/g,'_')[_0x1a6acb(0x225)](/[^a-z0-9_]/g,'');if(_0x54fe4a[_0x1206fe]!==undefined)return _0x54fe4a[_0x1206fe];return 0x3c;}function a1_0x4f19(_0x3a364f,_0x4c398e){const _0x35c57b=a1_0xa5b8();return a1_0x4f19=function(_0x220bd1,_0xcc196f){_0x220bd1=_0x220bd1-0x1a8;let _0xa5b803=_0x35c57b[_0x220bd1];return _0xa5b803;},a1_0x4f19(_0x3a364f,_0x4c398e);}async function logAutomationAction(_0x547017,_0x26c2d5){const _0x2c006b=a1_0x4f19;await _0x547017[_0x2c006b(0x1cc)](_0x2c006b(0x1af),{'val':_0x26c2d5,'ack':!![]});try{const _0x16a261=_0x2c006b(0x202),_0x3de3c4=await _0x547017[_0x2c006b(0x222)](_0x16a261);let _0xf2dbc9=[];if(_0x3de3c4&&_0x3de3c4[_0x2c006b(0x234)])try{_0xf2dbc9=JSON[_0x2c006b(0x22e)](_0x3de3c4[_0x2c006b(0x234)]);}catch(_0x3defa3){}_0xf2dbc9[_0x2c006b(0x1f8)]({'ts':Date[_0x2c006b(0x267)](),'msg':_0x26c2d5});if(_0xf2dbc9[_0x2c006b(0x216)]>0x32)_0xf2dbc9=_0xf2dbc9[_0x2c006b(0x213)](0x0,0x32);await _0x547017['setStateAsync'](_0x16a261,{'val':JSON[_0x2c006b(0x25b)](_0xf2dbc9),'ack':!![]});}catch(_0x309525){}}async function handlePrediction(_0x222161,_0x4243f6,_0x10d5c5){const _0x2bcdbd=a1_0x4f19;if(!_0x4243f6||_0x4243f6===_0x2bcdbd(0x1ef))return;let _0x485c63=_0x2bcdbd(0x1b8),_0x2abd71=0.6;try{const _0x4fcd15=await _0x222161[_0x2bcdbd(0x222)](_0x2bcdbd(0x215));if(_0x4fcd15&&_0x4fcd15[_0x2bcdbd(0x234)])_0x485c63=_0x4fcd15[_0x2bcdbd(0x234)];const _0x491891=await _0x222161[_0x2bcdbd(0x222)](_0x2bcdbd(0x226));if(_0x491891&&_0x491891[_0x2bcdbd(0x234)])_0x2abd71=_0x491891[_0x2bcdbd(0x234)];}catch(_0x530767){}if(_0x485c63===_0x2bcdbd(0x1b8)||_0x10d5c5<_0x2abd71)return;const _0x4b8ead=Date[_0x2bcdbd(0x267)]();if(lastActions[_0x4243f6]&&_0x4b8ead-lastActions[_0x4243f6]<COOLDOWN_MS)return;const _0x2610e8=_0x222161[_0x2bcdbd(0x224)][_0x2bcdbd(0x1ac)]||[],_0x548f27=normalize(_0x4243f6),_0x375454=_0x2610e8[_0x2bcdbd(0x20e)](_0x1707fc=>normalize(_0x1707fc[_0x2bcdbd(0x1cb)])===_0x548f27&&(_0x1707fc['type']==='light'||_0x1707fc[_0x2bcdbd(0x1d6)]===_0x2bcdbd(0x1d9)||_0x1707fc[_0x2bcdbd(0x1d6)]===_0x2bcdbd(0x22a)));if(!_0x375454)return;const _0x2ac5b1=await aiAgent['consultButler'](_0x222161,_0x4243f6,_0x375454[_0x2bcdbd(0x1be)],_0x10d5c5);if(!_0x2ac5b1[_0x2bcdbd(0x1f7)])return;const _0x2d0933=_0x2bcdbd(0x1c2)+_0x4243f6+'\x20->\x20Schalte\x20'+_0x375454[_0x2bcdbd(0x1be)]+'\x20('+_0x2ac5b1['reason']+')';await logAutomationAction(_0x222161,'['+_0x485c63['toUpperCase']()+']\x20'+_0x2d0933);if(_0x485c63===_0x2bcdbd(0x25f)){const _0x49fc52=await _0x222161['getForeignStateAsync'](_0x375454['id']);(!_0x49fc52||!_0x49fc52[_0x2bcdbd(0x234)]&&_0x49fc52[_0x2bcdbd(0x234)]!==!![])&&await _0x222161[_0x2bcdbd(0x1b4)](_0x375454['id'],!![]),lastActions[_0x4243f6]=_0x4b8ead;}}async function findRelatedId(_0xef811c,_0x52fabb,_0x2117a8='setpoint'){const _0x4f8c3a=a1_0x4f19;if(_0x2117a8==='setpoint'&&_0xef811c['config'][_0x4f8c3a(0x208)]){let _0x349b78=_0xef811c[_0x4f8c3a(0x224)][_0x4f8c3a(0x208)];if(typeof _0x349b78===_0x4f8c3a(0x1b7))try{_0x349b78=JSON[_0x4f8c3a(0x22e)](_0x349b78);}catch(_0x5e96a8){}if(_0x349b78&&_0x349b78[_0x52fabb])return _0x349b78[_0x52fabb];}if(_0x2117a8==='valve'&&_0xef811c[_0x4f8c3a(0x224)]['valveMapping']){let _0x309020=_0xef811c['config'][_0x4f8c3a(0x21f)];if(typeof _0x309020===_0x4f8c3a(0x1b7))try{_0x309020=JSON[_0x4f8c3a(0x22e)](_0x309020);}catch(_0x379158){}if(_0x309020&&_0x309020[_0x52fabb])return _0x309020[_0x52fabb];}let _0x26e346=[];if(_0x2117a8===_0x4f8c3a(0x257))_0x26e346=[{'s':_0x4f8c3a(0x23d),'t':_0x4f8c3a(0x1b2)},{'s':_0x4f8c3a(0x268),'t':_0x4f8c3a(0x1b2)},{'s':_0x4f8c3a(0x268),'t':_0x4f8c3a(0x230)},{'s':_0x4f8c3a(0x1c7),'t':_0x4f8c3a(0x1b1)},{'s':_0x4f8c3a(0x243),'t':_0x4f8c3a(0x1ec)},{'s':_0x4f8c3a(0x243),'t':_0x4f8c3a(0x1d3)},{'s':_0x4f8c3a(0x21b),'t':_0x4f8c3a(0x1bf)},{'s':'ACTUAL','t':_0x4f8c3a(0x1d1)},{'s':_0x4f8c3a(0x1cd),'t':'Soll'},{'s':_0x4f8c3a(0x21b),'t':_0x4f8c3a(0x257)}];else _0x2117a8===_0x4f8c3a(0x237)&&(_0x26e346=[{'s':_0x4f8c3a(0x23d),'t':_0x4f8c3a(0x1fc)},{'s':'.1.TEMPERATURE','t':_0x4f8c3a(0x1fc)},{'s':_0x4f8c3a(0x268),'t':_0x4f8c3a(0x1c9)},{'s':_0x4f8c3a(0x243),'t':_0x4f8c3a(0x235)},{'s':_0x4f8c3a(0x21b),'t':_0x4f8c3a(0x23f)},{'s':_0x4f8c3a(0x21b),'t':_0x4f8c3a(0x24c)}]);for(const _0x5426f8 of _0x26e346){if(_0x52fabb[_0x4f8c3a(0x251)](_0x5426f8['s'])){const _0x418f31=_0x52fabb['replace'](_0x5426f8['s'],_0x5426f8['t']),_0x715327=await _0xef811c[_0x4f8c3a(0x1fa)](_0x418f31);if(_0x715327)return _0x418f31;}}try{const _0x2a7ef3=_0x52fabb[_0x4f8c3a(0x247)]('.');if(_0x2a7ef3[_0x4f8c3a(0x216)]>0x2){const _0x5192d1=_0x2a7ef3[_0x4f8c3a(0x213)](0x0,-0x1)[_0x4f8c3a(0x223)]('.'),_0x48801e=await _0xef811c['getForeignObjectsAsync'](_0x5192d1+'.*'),_0x50d4c7=[],_0x417005=_0x52fabb['split'](/[._]+/)['filter'](_0x2689b2=>![_0x4f8c3a(0x265),'0',_0x4f8c3a(0x23e),_0x4f8c3a(0x21e),_0x4f8c3a(0x1bd),'temperature',_0x4f8c3a(0x25c),'sensor',_0x4f8c3a(0x1c1),'state']['includes'](_0x2689b2[_0x4f8c3a(0x233)]()));for(const [_0x50804e,_0x22d27c]of Object[_0x4f8c3a(0x240)](_0x48801e)){if(_0x50804e===_0x52fabb)continue;if(_0x22d27c&&_0x22d27c['common']){const _0x27a0d2=_0x50804e[_0x4f8c3a(0x233)](),_0x4f9333=(_0x22d27c[_0x4f8c3a(0x231)][_0x4f8c3a(0x21d)]||'')[_0x4f8c3a(0x233)](),_0x40cb11=(_0x22d27c[_0x4f8c3a(0x231)]['unit']||'')[_0x4f8c3a(0x233)]();let _0x2c66b7=![];if(_0x2117a8===_0x4f8c3a(0x257)&&_0x22d27c[_0x4f8c3a(0x231)][_0x4f8c3a(0x22d)]===!![])_0x2c66b7=_0x27a0d2[_0x4f8c3a(0x251)](_0x4f8c3a(0x209))||_0x27a0d2[_0x4f8c3a(0x251)](_0x4f8c3a(0x24e))||_0x27a0d2[_0x4f8c3a(0x251)](_0x4f8c3a(0x254))||_0x4f9333['includes']('level.temperature')||_0x4f9333['includes'](_0x4f8c3a(0x1b3));else _0x2117a8==='valve'&&(_0x2c66b7=_0x27a0d2[_0x4f8c3a(0x251)]('level')||_0x27a0d2['includes'](_0x4f8c3a(0x237))||_0x27a0d2[_0x4f8c3a(0x251)](_0x4f8c3a(0x248))||_0x27a0d2[_0x4f8c3a(0x251)](_0x4f8c3a(0x219))||_0x4f9333[_0x4f8c3a(0x251)]('level.valve')||_0x4f9333['includes'](_0x4f8c3a(0x1ff))||_0x40cb11[_0x4f8c3a(0x251)]('%'));if(_0x2c66b7){const _0x291bce=_0x50804e[_0x4f8c3a(0x247)](/[._]+/)['map'](_0x278b24=>_0x278b24[_0x4f8c3a(0x233)]());let _0x245c74=0x0;_0x417005[_0x4f8c3a(0x218)](_0x444800=>{const _0x53ea28=_0x4f8c3a;if(_0x291bce['includes'](_0x444800[_0x53ea28(0x233)]()))_0x245c74++;}),_0x50d4c7['push']({'id':_0x50804e,'score':_0x245c74});}}}if(_0x50d4c7[_0x4f8c3a(0x216)]>0x0){_0x50d4c7[_0x4f8c3a(0x21c)]((_0xdb8210,_0x55fed8)=>_0x55fed8[_0x4f8c3a(0x24f)]-_0xdb8210[_0x4f8c3a(0x24f)]);if(_0x50d4c7[0x0][_0x4f8c3a(0x24f)]>0x0)return _0x50d4c7[0x0]['id'];}}}catch(_0x4274f6){}return null;}async function scanThermostats(_0x3875db){const _0x3fbfed=a1_0x4f19,_0x24c015=_0x3875db[_0x3fbfed(0x224)][_0x3fbfed(0x1ac)]||[],_0x4ebd04=[],_0x2283bc=_0x24c015[_0x3fbfed(0x20a)](_0x59151c=>_0x59151c['id']&&_0x59151c['id'][_0x3fbfed(0x251)](_0x3fbfed(0x21b))||_0x59151c[_0x3fbfed(0x1d6)]&&[_0x3fbfed(0x21b),_0x3fbfed(0x25e),_0x3fbfed(0x1bb)]['includes'](_0x59151c[_0x3fbfed(0x1d6)])||_0x59151c[_0x3fbfed(0x1be)]&&_0x59151c[_0x3fbfed(0x1be)][_0x3fbfed(0x233)]()['includes']('temp'));for(const _0x5da42f of _0x2283bc){const _0x5a2f43=await findRelatedId(_0x3875db,_0x5da42f['id'],'setpoint'),_0x11d073=await findRelatedId(_0x3875db,_0x5da42f['id'],_0x3fbfed(0x237));let _0x4e8c17=_0x3fbfed(0x23c),_0x1f4be4=![],_0xccd34=_0x3875db['config'][_0x3fbfed(0x208)]||{};if(typeof _0xccd34===_0x3fbfed(0x1b7))try{_0xccd34=JSON['parse'](_0xccd34);}catch(_0x310b12){}let _0x3c63bf=_0x3875db[_0x3fbfed(0x224)][_0x3fbfed(0x21f)]||{};if(typeof _0x3c63bf===_0x3fbfed(0x1b7))try{_0x3c63bf=JSON['parse'](_0x3c63bf);}catch(_0x41c517){}if(_0xccd34[_0x5da42f['id']]&&_0xccd34[_0x5da42f['id']]===_0x5a2f43||_0x3c63bf[_0x5da42f['id']]&&_0x3c63bf[_0x5da42f['id']]===_0x11d073)_0x4e8c17=_0x3fbfed(0x1c0),_0x1f4be4=!![];else(_0x5a2f43||_0x11d073)&&(_0x4e8c17=_0x3fbfed(0x20c));_0x4ebd04[_0x3fbfed(0x263)]({'room':_0x5da42f[_0x3fbfed(0x1cb)]||_0x3fbfed(0x1c8),'sensorId':_0x5da42f['id'],'setpointId':_0x5a2f43||'-','valveId':_0x11d073||'-','source':_0x4e8c17,'isManual':_0x1f4be4,'status':_0x5a2f43&&_0x11d073?'PERFECT':_0x5a2f43?'OK':_0x3fbfed(0x221)});}return _0x4ebd04[_0x3fbfed(0x21c)]((_0x112174,_0x559dd7)=>_0x112174[_0x3fbfed(0x1e6)]['localeCompare'](_0x559dd7[_0x3fbfed(0x1e6)]));}async function updateSchedulePreview(_0x395d7d){const _0x3d4fac=a1_0x4f19;if(!_0x395d7d[_0x3d4fac(0x224)][_0x3d4fac(0x1f6)]||!_0x395d7d[_0x3d4fac(0x224)]['calendarInstance'])return;let _0x6f71e9={};try{const _0x16ba73=await _0x395d7d['getStateAsync'](_0x3d4fac(0x1e5));if(_0x16ba73&&_0x16ba73[_0x3d4fac(0x234)])_0x6f71e9=JSON[_0x3d4fac(0x22e)](_0x16ba73[_0x3d4fac(0x234)]);}catch(_0x160f9d){}const _0x440bcc=[],_0x44f6db=Date[_0x3d4fac(0x267)](),_0x9b104a=0x30*0x3c*0x3c*0x3e8;try{const _0x325a57=await _0x395d7d[_0x3d4fac(0x1d7)](_0x395d7d['config']['calendarInstance']+'.data.table');if(!_0x325a57||!_0x325a57[_0x3d4fac(0x234)])return;const _0x196d56=JSON[_0x3d4fac(0x22e)](_0x325a57['val']),_0x35b365=_0x395d7d[_0x3d4fac(0x224)][_0x3d4fac(0x1ad)]||[],_0x107e1e=_0x395d7d['config'][_0x3d4fac(0x1ac)]||[],_0x2fff2b=new Set();_0x107e1e[_0x3d4fac(0x218)](_0x4c65da=>{const _0x1b1214=_0x3d4fac;if(_0x4c65da[_0x1b1214(0x1cb)])_0x2fff2b['add'](_0x4c65da[_0x1b1214(0x1cb)]);});for(const _0x41af2c of _0x196d56){if(_0x41af2c[_0x3d4fac(0x228)]&&_0x35b365[_0x3d4fac(0x216)]>0x0&&!_0x35b365[_0x3d4fac(0x251)](_0x41af2c[_0x3d4fac(0x228)]))continue;const _0x752f49=_0x41af2c[_0x3d4fac(0x1f0)]||_0x41af2c[_0x3d4fac(0x1f1)]||_0x41af2c[_0x3d4fac(0x1db)];if(!_0x752f49)continue;const _0x3ad82c=new Date(_0x752f49),_0x1db890=_0x3ad82c['getTime']();if(isNaN(_0x1db890))continue;if(_0x1db890<_0x44f6db)continue;if(_0x1db890>_0x44f6db+_0x9b104a)continue;const _0x20b7aa=(_0x41af2c[_0x3d4fac(0x244)]||_0x41af2c[_0x3d4fac(0x1e2)]||'')['toLowerCase']();let _0x17bb27=![],_0x343716=[],_0x1324e5=_0x41af2c[_0x3d4fac(0x244)]||_0x41af2c[_0x3d4fac(0x1e2)]||_0x3d4fac(0x1c8);if(_0x20b7aa[_0x3d4fac(0x251)](_0x3d4fac(0x239))||_0x20b7aa[_0x3d4fac(0x251)](_0x3d4fac(0x1c6))||_0x20b7aa['includes']('ankunft'))_0x17bb27=!![],_0x343716=Array[_0x3d4fac(0x227)](_0x2fff2b);else for(const _0x442498 of _0x2fff2b){if(_0x20b7aa['includes'](_0x442498[_0x3d4fac(0x233)]()))_0x343716[_0x3d4fac(0x263)](_0x442498);}_0x343716[_0x3d4fac(0x216)]>0x0&&_0x343716[_0x3d4fac(0x218)](_0x11df06=>{const _0x966ed9=_0x3d4fac;let _0x1bd89f=0x3c;if(_0x17bb27){let _0x384414=0x0;Object['values'](_0x6f71e9)[_0x966ed9(0x218)](_0xf95f36=>{if(_0xf95f36>_0x384414)_0x384414=_0xf95f36;}),_0x1bd89f=_0x384414>0x0?_0x384414:0x78;}else _0x1bd89f=getWarmupRobust(_0x6f71e9,_0x11df06);const _0x461c35=new Date(_0x1db890-_0x1bd89f*0xea60);_0x440bcc[_0x966ed9(0x263)]({'eventTime':_0x1db890,'triggerTime':_0x461c35[_0x966ed9(0x1f2)](),'room':_0x11df06,'minutes':_0x1bd89f,'reason':_0x1324e5,'isGlobal':_0x17bb27});});}}catch(_0x2ea4e4){}_0x440bcc[_0x3d4fac(0x21c)]((_0x527ec4,_0x4a849a)=>_0x527ec4['triggerTime']-_0x4a849a[_0x3d4fac(0x21a)]);const _0x30bcd1=_0x440bcc['slice'](0x0,0x1e);await _0x395d7d['setStateAsync']('analysis.energy.schedulePreview',{'val':JSON[_0x3d4fac(0x25b)](_0x30bcd1),'ack':!![]});}function a1_0xa5b8(){const _0x1480be=['339216uFcciJ','thermostat','active','_meta','currentSystemMode','¬∞C!\x20(Puffer:\x20','push','¬∞C).\x20Entferne\x20Status.','openknx','\x20wieder\x20auf\x20','now','.1.TEMPERATURE','splice','TRAIN_RL_PENALTY','calendarInstance','cal_','devices','calendarSelection','Enforcement\x20Monitor\x20Error:\x20','analysis.automation.lastAction','196740Gazsij','SET_POINT_TEMPERATURE','.1.SET_POINT_TEMPERATURE','thermostat.setpoint','setForeignStateAsync','message','mpc_','string','off','open','remove','sensor','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','wert','name','target_temperature','Manuelles\x20Mapping','messwert','Pr√§diktion:\x20','number','üìÖ\x20[MPC\x20INFO]\x20','\x20min)','r√ºckkehr','ACTUAL_TEMPERATURE','Unbekannt','.4.VALVE_STATE',':\x20Absenkung\x20auf\x20','location','setStateAsync','Ist','exports','¬∞C\x20(Vorlauf:\x20','sendToPythonWrapper','SET','system.mode','current_heating_setpoint','too_cold','¬∞C!\x20(Puffer\x20leer).','type','getForeignStateAsync','analysis.energy.activeEnforcements','dimmer','\x20ist\x20auf\x20','date','toString','isArray','\x20wurde\x20manuell\x20erh√∂ht.','manual','(((.+)+)+)+$','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20','summary','375258cnSBXz','681005KgbhlN','analysis.energy.warmupTimes','room','¬∞C).\x20Sparmodus\x20beendet!','Calendar\x20Check\x20Error:\x20','104nUPxUi','\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.','abs','occupied_heating_setpoint','üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','34233aIMzoH','Unknown','_date','eventStart','getTime','¬∞C\x20(nicht\x20','trim','minutes_safe','useCalendar','approved','unshift','constructor','getForeignObjectAsync','apply','.1.LEVEL','üî•\x20[MPC\x20ACTION]\x20Heize\x20','info','value.valve','\x27\x20(Match:\x20','analysis.energy.warmupTargets','analysis.automation.actionLog','66VWpQEb','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','[MPC]\x20','üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20','analysis.energy.rlPenalties','thermostatMapping','set','filter',')\x20aktiv.\x20Heize\x20auf\x20','Auto-Erkennung','üö®\x20[MPC\x20WATCHDOG]\x20','find','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','add','12ivwRPT','default','slice','[WATCHDOG]\x20','analysis.automation.mode','length','\x20->\x20','forEach','position','triggerTime','temperature','sort','role','ist','valveMapping','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27','Fehlt','getStateAsync','join','config','replace','analysis.automation.confidenceThreshold','from','_calName','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','switch','¬∞C.',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','write','parse','\x20gefunden!','.4.SET_TEMPERATURE','common',']:\x20Raum-Trigger\x20\x27','toLowerCase','val','pi_heating_demand','1854600bYjYSc','valve','üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','urlaub\x20ende','\x20auf\x20','getHours','Nicht\x20gefunden','.1.ACTUAL_TEMPERATURE','hm-rpc','valve_position','entries','üìÖ\x20SMART\x20SCHEDULE\x20[','log','local_temperature','event','üßπ\x20[MPC\x20CLEANUP]\x20',':\x20Aufheizen\x20auf\x20','split','stellwert','¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20','\x20erreicht\x20Limit\x20(','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','level','normal','soll','score','1737652fETVfP','includes','search','\x20min).','target','[FORCE]\x20','¬∞C\x20<\x20','setpoint','warn','rescue_','Classic','stringify','actual'];a1_0xa5b8=function(){return _0x1480be;};return a1_0xa5b8();}async function monitorEnforcements(_0x145a32){const _0x104c8e=a1_0x4f19;try{const _0x503402=_0x104c8e(0x1d8),_0x1553ed=await _0x145a32[_0x104c8e(0x222)](_0x503402);if(!_0x1553ed||!_0x1553ed[_0x104c8e(0x234)])return;let _0x3dec76=[];try{_0x3dec76=JSON[_0x104c8e(0x22e)](_0x1553ed[_0x104c8e(0x234)]);}catch(_0x3636bd){return;}if(!Array[_0x104c8e(0x1dd)](_0x3dec76)||_0x3dec76[_0x104c8e(0x216)]===0x0)return;const _0x226ec7=Date['now'](),_0x30941e=_0x145a32[_0x104c8e(0x224)][_0x104c8e(0x1ac)]||[];let _0x1b1791=![];for(let _0x2995f5=_0x3dec76['length']-0x1;_0x2995f5>=0x0;_0x2995f5--){const _0x51d3be=_0x3dec76[_0x2995f5];if(_0x226ec7>=_0x51d3be['until']){_0x145a32['log']['info'](_0x104c8e(0x238)+_0x51d3be[_0x104c8e(0x1e6)]+_0x104c8e(0x20f)),_0x3dec76[_0x104c8e(0x1a8)](_0x2995f5,0x1),_0x1b1791=!![];continue;}const _0x28938a=_0x30941e['find'](_0x17c56f=>normalize(_0x17c56f['location'])===normalize(_0x51d3be[_0x104c8e(0x1e6)])&&(_0x17c56f['type']===_0x104c8e(0x21b)||_0x17c56f['type']===_0x104c8e(0x25e)));if(_0x28938a){const _0x534f44=await findRelatedId(_0x145a32,_0x28938a['id'],_0x104c8e(0x257));if(_0x534f44){const _0x5286f4=await _0x145a32[_0x104c8e(0x1d7)](_0x534f44);_0x5286f4&&typeof _0x5286f4[_0x104c8e(0x234)]==='number'&&(_0x5286f4[_0x104c8e(0x234)]<0xf&&(_0x145a32[_0x104c8e(0x242)][_0x104c8e(0x258)]('üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20'+_0x51d3be[_0x104c8e(0x1e6)]+_0x104c8e(0x23a)+_0x5286f4[_0x104c8e(0x234)]+_0x104c8e(0x249)+_0x51d3be['target']+_0x104c8e(0x22b)),await _0x145a32[_0x104c8e(0x1b4)](_0x534f44,_0x51d3be[_0x104c8e(0x254)]),await logAutomationAction(_0x145a32,_0x104c8e(0x255)+_0x51d3be[_0x104c8e(0x1e6)]+':\x20'+_0x5286f4[_0x104c8e(0x234)]+'¬∞C\x20->\x20'+_0x51d3be[_0x104c8e(0x254)]+'¬∞C\x20(Kalender-Schutz)')));}}}_0x1b1791&&await _0x145a32[_0x104c8e(0x1cc)](_0x503402,{'val':JSON[_0x104c8e(0x25b)](_0x3dec76),'ack':!![]});}catch(_0x5bca29){_0x145a32[_0x104c8e(0x242)]['error'](_0x104c8e(0x1ae)+_0x5bca29[_0x104c8e(0x1b5)]);}}async function checkCalendarTriggers(_0x52c3a2){const _0x5e19ee=a1_0x4f19;if(!_0x52c3a2[_0x5e19ee(0x224)]['useCalendar']||!_0x52c3a2[_0x5e19ee(0x224)][_0x5e19ee(0x1aa)])return;await updateSchedulePreview(_0x52c3a2);let _0x57c183={},_0x1d27fb={};try{const _0x428fb8=await _0x52c3a2[_0x5e19ee(0x222)](_0x5e19ee(0x1e5));if(_0x428fb8&&_0x428fb8['val'])_0x57c183=JSON[_0x5e19ee(0x22e)](_0x428fb8[_0x5e19ee(0x234)]);const _0x5e4f0f=await _0x52c3a2[_0x5e19ee(0x222)]('analysis.energy.warmupSources');if(_0x5e4f0f&&_0x5e4f0f[_0x5e19ee(0x234)])_0x1d27fb=JSON['parse'](_0x5e4f0f['val']);}catch(_0x987a91){}let _0x29f2d7={'default':0x15};try{const _0x1badd5=await _0x52c3a2['getStateAsync'](_0x5e19ee(0x201));if(_0x1badd5&&_0x1badd5['val'])_0x29f2d7=JSON[_0x5e19ee(0x22e)](_0x1badd5[_0x5e19ee(0x234)]);}catch(_0x53c624){}let _0x2dd314=[];try{const _0x247c33=await _0x52c3a2[_0x5e19ee(0x222)]('analysis.energy.activeEnforcements');if(_0x247c33&&_0x247c33[_0x5e19ee(0x234)])_0x2dd314=JSON[_0x5e19ee(0x22e)](_0x247c33['val']);}catch(_0xd65e08){}try{const _0x4fbe5e=await _0x52c3a2['getForeignStateAsync'](_0x52c3a2[_0x5e19ee(0x224)]['calendarInstance']+'.data.table');if(!_0x4fbe5e||!_0x4fbe5e[_0x5e19ee(0x234)])return;const _0x3dbf69=JSON[_0x5e19ee(0x22e)](_0x4fbe5e[_0x5e19ee(0x234)]),_0x30634b=Date['now'](),_0x9de1f4=_0x52c3a2['config'][_0x5e19ee(0x1ac)]||[],_0x125915=_0x52c3a2['config']['calendarSelection']||[];let _0x281679=![];for(const _0xc4c18 of _0x3dbf69){if(_0xc4c18['_calName']&&_0x125915[_0x5e19ee(0x216)]>0x0&&!_0x125915['includes'](_0xc4c18[_0x5e19ee(0x228)]))continue;const _0x42a09f=_0xc4c18[_0x5e19ee(0x1f0)]||_0xc4c18['eventStart']||_0xc4c18[_0x5e19ee(0x1db)];if(!_0x42a09f)continue;const _0x4b5267=new Date(_0x42a09f);if(isNaN(_0x4b5267[_0x5e19ee(0x1f2)]()))continue;const _0x35ab46=(_0xc4c18[_0x5e19ee(0x244)]||_0xc4c18[_0x5e19ee(0x1e2)]||'')[_0x5e19ee(0x233)]();if(_0x35ab46['includes'](_0x5e19ee(0x239))||_0x35ab46[_0x5e19ee(0x251)](_0x5e19ee(0x1c6))||_0x35ab46[_0x5e19ee(0x251)]('ankunft')){let _0x45357c=0x0;Object['values'](_0x57c183)['forEach'](_0x1bdc88=>{if(_0x1bdc88>_0x45357c)_0x45357c=_0x1bdc88;});if(_0x45357c===0x0)_0x45357c=0x78;const _0x556df1=_0x4b5267['getTime']()-_0x45357c*0xea60;_0x30634b>=_0x556df1&&_0x30634b<_0x4b5267[_0x5e19ee(0x1f2)]()&&(_0x52c3a2[_0x5e19ee(0x261)]!==_0x5e19ee(0x24d)&&(_0x52c3a2[_0x5e19ee(0x242)][_0x5e19ee(0x1fe)](_0x5e19ee(0x204)+_0x45357c+_0x5e19ee(0x253)),await _0x52c3a2[_0x5e19ee(0x1cc)](_0x5e19ee(0x1d2),{'val':_0x5e19ee(0x24d),'ack':![]})));}for(const _0x3be24a of _0x9de1f4){if(_0x3be24a[_0x5e19ee(0x1cb)]){const _0x11ccf4=_0x3be24a['location']['toLowerCase'](),_0x42d421=(_0x3be24a[_0x5e19ee(0x1be)]||'')[_0x5e19ee(0x233)]();let _0x435434=_0x35ab46[_0x5e19ee(0x251)](_0x11ccf4);!_0x435434&&_0x42d421['length']>0x3&&_0x35ab46[_0x5e19ee(0x251)](_0x42d421)&&(_0x435434=!![]);if(_0x435434){const _0x512616=getWarmupRobust(_0x57c183,_0x3be24a[_0x5e19ee(0x1cb)]),_0x45dc96=_0x1d27fb[_0x3be24a['location']]||_0x5e19ee(0x25a),_0x592197=_0x4b5267[_0x5e19ee(0x1f2)]()-_0x512616*0xea60;if(_0x30634b>=_0x592197&&_0x30634b<_0x4b5267[_0x5e19ee(0x1f2)]()){const _0x53b2b9=lastActions[_0x5e19ee(0x1ab)+_0x3be24a[_0x5e19ee(0x1cb)]];if(_0x53b2b9&&_0x30634b-_0x53b2b9<CAL_COOLDOWN_MS)continue;const _0x50288b=await findRelatedId(_0x52c3a2,_0x3be24a['id'],_0x5e19ee(0x257));if(_0x50288b){let _0x2dd3f3=_0x29f2d7[_0x3be24a['location']];if(_0x2dd3f3===undefined)_0x2dd3f3=_0x29f2d7['default'];if(_0x2dd3f3===undefined)_0x2dd3f3=0x15;const _0xaaf381=await _0x52c3a2[_0x5e19ee(0x1d7)](_0x50288b);if(_0xaaf381&&typeof _0xaaf381[_0x5e19ee(0x234)]===_0x5e19ee(0x1c3)&&_0xaaf381[_0x5e19ee(0x234)]<_0x2dd3f3-0.5){_0x52c3a2[_0x5e19ee(0x242)]['info'](_0x5e19ee(0x241)+_0x45dc96+_0x5e19ee(0x232)+_0x3be24a[_0x5e19ee(0x1cb)]+_0x5e19ee(0x200)+_0x35ab46+_0x5e19ee(0x20b)+_0x2dd3f3+_0x5e19ee(0x1cf)+_0x512616+'\x20min).'),await _0x52c3a2[_0x5e19ee(0x1b4)](_0x50288b,_0x2dd3f3),await logAutomationAction(_0x52c3a2,'[CAL]\x20'+_0x3be24a[_0x5e19ee(0x1cb)]+_0x5e19ee(0x217)+_0x2dd3f3+'¬∞C\x20(via\x20'+_0x45dc96+')'),lastActions['cal_'+_0x3be24a[_0x5e19ee(0x1cb)]]=_0x30634b;const _0x5935c3=_0x2dd314['findIndex'](_0x1d3768=>_0x1d3768[_0x5e19ee(0x1e6)]===_0x3be24a['location']);if(_0x5935c3!==-0x1)_0x2dd314[_0x5e19ee(0x1a8)](_0x5935c3,0x1);_0x2dd314[_0x5e19ee(0x263)]({'room':_0x3be24a[_0x5e19ee(0x1cb)],'target':_0x2dd3f3,'until':_0x4b5267[_0x5e19ee(0x1f2)]()}),_0x281679=!![];}}}}}}}_0x281679&&await _0x52c3a2['setStateAsync'](_0x5e19ee(0x1d8),{'val':JSON['stringify'](_0x2dd314),'ack':!![]});}catch(_0x4dd6ac){_0x52c3a2[_0x5e19ee(0x242)][_0x5e19ee(0x258)](_0x5e19ee(0x1e8)+_0x4dd6ac[_0x5e19ee(0x1b5)]);}}async function manageMpcIntervention(_0x41f068,_0x352414,_0x3a604d){const _0x13641f=a1_0x4f19;try{const _0xe44650='analysis.energy.mpcActiveInterventions',_0x1c95cc=await _0x41f068['getStateAsync'](_0xe44650);let _0xb4f492=[];if(_0x1c95cc&&_0x1c95cc[_0x13641f(0x234)])try{_0xb4f492=JSON['parse'](_0x1c95cc[_0x13641f(0x234)]);}catch(_0xad56d1){}const _0x320b1f=_0xb4f492['indexOf'](_0x352414);if(_0x3a604d===_0x13641f(0x210))_0x320b1f===-0x1&&(_0xb4f492[_0x13641f(0x263)](_0x352414),await _0x41f068[_0x13641f(0x1cc)](_0xe44650,{'val':JSON[_0x13641f(0x25b)](_0xb4f492),'ack':!![]}));else _0x3a604d===_0x13641f(0x1ba)&&(_0x320b1f!==-0x1&&(_0xb4f492[_0x13641f(0x1a8)](_0x320b1f,0x1),await _0x41f068[_0x13641f(0x1cc)](_0xe44650,{'val':JSON[_0x13641f(0x25b)](_0xb4f492),'ack':!![]})));}catch(_0x3ccefe){}}async function cleanupGhostInterventions(_0x1105d4){const _0x292d6f=a1_0x4f19;try{const _0x46484f='analysis.energy.mpcActiveInterventions',_0x1f88a7=await _0x1105d4[_0x292d6f(0x222)](_0x46484f);if(!_0x1f88a7||!_0x1f88a7[_0x292d6f(0x234)])return;const _0x59e72b=JSON[_0x292d6f(0x22e)](_0x1f88a7[_0x292d6f(0x234)]);if(!Array['isArray'](_0x59e72b)||_0x59e72b['length']===0x0)return;let _0x22e33c={'default':0x15};try{const _0x1b766b=await _0x1105d4[_0x292d6f(0x222)](_0x292d6f(0x201));if(_0x1b766b&&_0x1b766b[_0x292d6f(0x234)])_0x22e33c=JSON['parse'](_0x1b766b[_0x292d6f(0x234)]);}catch(_0x5bd011){}let _0x342e6f=[];try{const _0x48979d=await _0x1105d4[_0x292d6f(0x222)]('analysis.energy.ventilationAlerts');if(_0x48979d&&_0x48979d[_0x292d6f(0x234)])_0x342e6f=JSON[_0x292d6f(0x22e)](_0x48979d[_0x292d6f(0x234)]);}catch(_0x4d2432){}let _0x13691a={},_0x1193bd=![];try{const _0x3d6313=await _0x1105d4[_0x292d6f(0x222)]('analysis.energy.rlPenalties');if(_0x3d6313&&_0x3d6313[_0x292d6f(0x234)])_0x13691a=JSON[_0x292d6f(0x22e)](_0x3d6313['val']);}catch(_0x56e1bb){}if(_0x13691a[_0x292d6f(0x260)]){const _0x26d649=Date[_0x292d6f(0x267)]();for(const [_0xc88dd0,_0x673a2e]of Object[_0x292d6f(0x240)](_0x13691a[_0x292d6f(0x260)])){_0x26d649-_0x673a2e>PENALTY_TTL&&(delete _0x13691a[_0xc88dd0],delete _0x13691a['_meta'][_0xc88dd0],_0x1193bd=!![],_0x1105d4[_0x292d6f(0x242)][_0x292d6f(0x1fe)](_0x292d6f(0x220)+_0xc88dd0+_0x292d6f(0x229)));}}const _0x2abee4=_0x1105d4[_0x292d6f(0x224)][_0x292d6f(0x1ac)]||[];let _0x867e24=![];for(let _0x136a35=_0x59e72b['length']-0x1;_0x136a35>=0x0;_0x136a35--){const _0x44b7e8=_0x59e72b[_0x136a35],_0x26dea0=_0x2abee4['find'](_0x2e9c4c=>normalize(_0x2e9c4c[_0x292d6f(0x1cb)])===normalize(_0x44b7e8)&&(_0x2e9c4c[_0x292d6f(0x1d6)]===_0x292d6f(0x21b)||_0x2e9c4c['type']===_0x292d6f(0x25e)));if(!_0x26dea0){_0x1105d4[_0x292d6f(0x242)][_0x292d6f(0x258)]('üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27'+_0x44b7e8+_0x292d6f(0x1bc)),_0x59e72b[_0x292d6f(0x1a8)](_0x136a35,0x1),_0x867e24=!![];continue;}if(_0x26dea0){const _0x276d61=await findRelatedId(_0x1105d4,_0x26dea0['id'],_0x292d6f(0x257)),_0x300196=await _0x1105d4[_0x292d6f(0x1d7)](_0x26dea0['id']);if(_0x276d61){const _0x24fd4c=await _0x1105d4[_0x292d6f(0x1d7)](_0x276d61);if(_0x24fd4c&&typeof _0x24fd4c[_0x292d6f(0x234)]===_0x292d6f(0x1c3)){let _0x366c14=![],_0x32bfd5='';Math[_0x292d6f(0x1eb)](_0x24fd4c[_0x292d6f(0x234)]-ECO_TEMP)>0.5&&(_0x366c14=!![],_0x32bfd5=_0x292d6f(0x1df));if(!_0x366c14&&_0x300196&&typeof _0x300196[_0x292d6f(0x234)]===_0x292d6f(0x1c3)){const _0x311abe=_0x22e33c[_0x44b7e8]||_0x22e33c[_0x292d6f(0x212)]||0x15;_0x300196['val']<_0x311abe+0.2&&(_0x366c14=!![],_0x32bfd5=_0x292d6f(0x1d4));}if(_0x366c14){if(_0x32bfd5===_0x292d6f(0x1df)){_0x1105d4[_0x292d6f(0x242)][_0x292d6f(0x1fe)](_0x292d6f(0x245)+_0x44b7e8+_0x292d6f(0x1da)+_0x24fd4c[_0x292d6f(0x234)]+_0x292d6f(0x1f3)+ECO_TEMP+_0x292d6f(0x264));const _0x4137f0=lastActions[_0x292d6f(0x1ab)+_0x44b7e8],_0x3598bf=_0x4137f0&&Date['now']()-_0x4137f0<0x2*0x3c*0x3e8;if(!_0x3598bf&&_0x24fd4c[_0x292d6f(0x234)]>ECO_TEMP+0.5){_0x1105d4[_0x292d6f(0x1d0)]&&(_0x1105d4[_0x292d6f(0x242)][_0x292d6f(0x1fe)](_0x292d6f(0x1ed)+_0x44b7e8+_0x292d6f(0x1de)),_0x1105d4[_0x292d6f(0x1d0)](_0x292d6f(0x1a9),{'room':_0x44b7e8}));const _0x43f1a3=_0x44b7e8+'_'+new Date()[_0x292d6f(0x23b)]();if(!_0x13691a[_0x43f1a3]){_0x13691a[_0x43f1a3]=0x1;if(!_0x13691a[_0x292d6f(0x260)])_0x13691a[_0x292d6f(0x260)]={};_0x13691a[_0x292d6f(0x260)][_0x43f1a3]=Date[_0x292d6f(0x267)](),_0x1193bd=!![];}}else _0x3598bf&&_0x1105d4[_0x292d6f(0x242)][_0x292d6f(0x1fe)](_0x292d6f(0x1c4)+_0x44b7e8+_0x292d6f(0x1ea));}else{if(_0x32bfd5===_0x292d6f(0x1d4)){let _0x2a39e6=![];if(_0x342e6f[_0x292d6f(0x20e)](_0x4aa090=>_0x4aa090[_0x292d6f(0x1e6)]===_0x44b7e8))_0x2a39e6=!![];const _0x1b8a7a=_0x2abee4[_0x292d6f(0x20a)](_0x23da1a=>normalize(_0x23da1a[_0x292d6f(0x1cb)])===normalize(_0x44b7e8)&&(_0x23da1a['type']==='window'||_0x23da1a[_0x292d6f(0x1d6)]==='sensor'||_0x23da1a['type']==='contact'));for(const _0xdc86ed of _0x1b8a7a){try{const _0x417110=await _0x1105d4['getForeignStateAsync'](_0xdc86ed['id']);if(_0x417110&&(_0x417110['val']===!![]||_0x417110[_0x292d6f(0x234)]===0x1||String(_0x417110[_0x292d6f(0x234)])[_0x292d6f(0x233)]()===_0x292d6f(0x1b9)))_0x2a39e6=!![];}catch(_0xaaf429){}}if(_0x2a39e6)_0x1105d4[_0x292d6f(0x242)][_0x292d6f(0x1fe)](_0x292d6f(0x206)+_0x44b7e8+_0x292d6f(0x24b));else{const _0x36a90a=_0x22e33c[_0x44b7e8]||_0x22e33c[_0x292d6f(0x212)]||0x15;_0x1105d4[_0x292d6f(0x242)][_0x292d6f(0x1fe)](_0x292d6f(0x20d)+_0x44b7e8+_0x292d6f(0x24a)+_0x300196['val']+_0x292d6f(0x256)+(_0x36a90a+0.2)+_0x292d6f(0x1e7)),await _0x1105d4[_0x292d6f(0x1b4)](_0x276d61,_0x36a90a),await logAutomationAction(_0x1105d4,_0x292d6f(0x214)+_0x44b7e8+_0x292d6f(0x22c)+_0x36a90a+'¬∞C'),lastActions[_0x292d6f(0x259)+_0x44b7e8]=Date[_0x292d6f(0x267)]();}}}_0x59e72b[_0x292d6f(0x1a8)](_0x136a35,0x1),_0x867e24=!![];}}}}}_0x867e24&&await _0x1105d4[_0x292d6f(0x1cc)](_0x46484f,{'val':JSON[_0x292d6f(0x25b)](_0x59e72b),'ack':!![]}),_0x1193bd&&await _0x1105d4[_0x292d6f(0x1cc)](_0x292d6f(0x207),{'val':JSON['stringify'](_0x13691a),'ack':!![]});}catch(_0x45ee3b){}}async function applyEnergySavings(_0x2eb112,_0x2c51ca){const _0x152008=a1_0x4f19;await cleanupGhostInterventions(_0x2eb112);if(!_0x2c51ca||_0x2c51ca[_0x152008(0x216)]===0x0)return;const _0x5cc7e9=_0x2eb112[_0x152008(0x224)][_0x152008(0x1ac)]||[],_0x1ae6e4=Date[_0x152008(0x267)]();for(const _0x10964a of _0x2c51ca){const _0x147c61=_0x10964a[_0x152008(0x1e6)],_0xf9b47c=_0x10964a[_0x152008(0x1f5)],_0xcc0909=_0x10964a[_0x152008(0x254)]||0x15;if(lastActions[_0x152008(0x259)+_0x147c61]&&_0x1ae6e4-lastActions[_0x152008(0x259)+_0x147c61]<RESCUE_LOCK_MS)continue;const _0x4d1860=_0x5cc7e9[_0x152008(0x20e)](_0x48b6a1=>normalize(_0x48b6a1['location'])===normalize(_0x147c61)&&(_0x48b6a1['type']==='temperature'||_0x48b6a1['type']===_0x152008(0x25e)));if(!_0x4d1860)continue;const _0x2bacd8=await findRelatedId(_0x2eb112,_0x4d1860['id'],_0x152008(0x257));if(_0x2bacd8){if(lastActions[_0x152008(0x1b6)+_0x147c61]&&_0x1ae6e4-lastActions['mpc_'+_0x147c61]<0x1e*0x3c*0x3e8)continue;const _0x27b429=await _0x2eb112['getForeignStateAsync'](_0x2bacd8);if(_0x27b429&&typeof _0x27b429[_0x152008(0x234)]===_0x152008(0x1c3)){const _0x366d53=_0x27b429[_0x152008(0x234)];_0x366d53!==ECO_TEMP&&await manageMpcIntervention(_0x2eb112,_0x147c61,'remove');if(_0xf9b47c>0x1e)_0x366d53>ECO_TEMP+0.5&&(_0x2eb112[_0x152008(0x242)]['info']('üçÉ\x20[MPC\x20ACTION]\x20Senke\x20'+_0x147c61+_0x152008(0x23a)+ECO_TEMP+_0x152008(0x262)+_0xf9b47c+_0x152008(0x1c5)),await _0x2eb112[_0x152008(0x1b4)](_0x2bacd8,ECO_TEMP),await manageMpcIntervention(_0x2eb112,_0x147c61,_0x152008(0x210)),lastActions[_0x152008(0x1b6)+_0x147c61]=_0x1ae6e4,await logAutomationAction(_0x2eb112,_0x152008(0x205)+_0x147c61+_0x152008(0x1ca)+ECO_TEMP+'¬∞C'));else _0xf9b47c<=0xf&&(_0x366d53<_0xcc0909&&(_0x2eb112[_0x152008(0x242)]['info'](_0x152008(0x1fd)+_0x147c61+_0x152008(0x266)+_0xcc0909+_0x152008(0x1d5)),await _0x2eb112['setForeignStateAsync'](_0x2bacd8,_0xcc0909),await manageMpcIntervention(_0x2eb112,_0x147c61,'remove'),lastActions[_0x152008(0x1b6)+_0x147c61]=_0x1ae6e4,await logAutomationAction(_0x2eb112,_0x152008(0x205)+_0x147c61+_0x152008(0x246)+_0xcc0909+'¬∞C')));}}else _0x2eb112['log'][_0x152008(0x258)](_0x152008(0x1e1)+_0x147c61+_0x152008(0x22f));}}module[a1_0x3c79b0(0x1ce)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};