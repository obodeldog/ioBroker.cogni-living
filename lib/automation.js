const a1_0xbd6d87=a1_0x40ed;(function(_0x2fae2f,_0x2f8b00){const _0x2614ab=a1_0x40ed,_0x107d0e=_0x2fae2f();while(!![]){try{const _0x55a501=-parseInt(_0x2614ab(0x1f4))/0x1+-parseInt(_0x2614ab(0x244))/0x2+-parseInt(_0x2614ab(0x245))/0x3*(parseInt(_0x2614ab(0x24e))/0x4)+-parseInt(_0x2614ab(0x287))/0x5*(-parseInt(_0x2614ab(0x1ee))/0x6)+-parseInt(_0x2614ab(0x282))/0x7*(-parseInt(_0x2614ab(0x24a))/0x8)+-parseInt(_0x2614ab(0x21c))/0x9+parseInt(_0x2614ab(0x233))/0xa;if(_0x55a501===_0x2f8b00)break;else _0x107d0e['push'](_0x107d0e['shift']());}catch(_0x46b4d2){_0x107d0e['push'](_0x107d0e['shift']());}}}(a1_0x4069,0x2f7b1));const a1_0xfc0651=(function(){let _0x275af7=!![];return function(_0x72ed4b,_0x2e313d){const _0x4ff78a=_0x275af7?function(){const _0x3d2d3a=a1_0x40ed;if(_0x2e313d){const _0x1e5b1f=_0x2e313d[_0x3d2d3a(0x283)](_0x72ed4b,arguments);return _0x2e313d=null,_0x1e5b1f;}}:function(){};return _0x275af7=![],_0x4ff78a;};}()),a1_0x3d0293=a1_0xfc0651(this,function(){const _0x579722=a1_0x40ed;return a1_0x3d0293[_0x579722(0x28e)]()[_0x579722(0x273)]('(((.+)+)+)+$')[_0x579722(0x28e)]()[_0x579722(0x279)](a1_0x3d0293)[_0x579722(0x273)](_0x579722(0x1eb));});a1_0x3d0293();'use strict';const aiAgent=require(a1_0xbd6d87(0x206)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x5eaef6){if(!_0x5eaef6)return'';return _0x5eaef6['toLowerCase']()['replace'](/\s+/g,'')['trim']();}function getWarmupRobust(_0x334d3d,_0x3070d6){const _0x20c06e=a1_0xbd6d87;if(!_0x334d3d||!_0x3070d6)return 0x3c;if(_0x334d3d[_0x3070d6]!==undefined)return _0x334d3d[_0x3070d6];const _0x5a7189=_0x3070d6[_0x20c06e(0x259)]()[_0x20c06e(0x202)](/Ã¤/g,'ae')[_0x20c06e(0x202)](/Ã¶/g,'oe')[_0x20c06e(0x202)](/Ã¼/g,'ue')[_0x20c06e(0x202)](/ÃŸ/g,'ss')[_0x20c06e(0x202)](/\s+/g,'_')['replace'](/[^a-z0-9_]/g,'');if(_0x334d3d[_0x5a7189]!==undefined)return _0x334d3d[_0x5a7189];return 0x3c;}function a1_0x40ed(_0x1e2bb1,_0x56ba2b){const _0x51448b=a1_0x4069();return a1_0x40ed=function(_0x3d0293,_0xfc0651){_0x3d0293=_0x3d0293-0x1e2;let _0x406906=_0x51448b[_0x3d0293];return _0x406906;},a1_0x40ed(_0x1e2bb1,_0x56ba2b);}async function logAutomationAction(_0xd7f491,_0x102d21){const _0x2b5d69=a1_0xbd6d87;await _0xd7f491[_0x2b5d69(0x1f3)](_0x2b5d69(0x225),{'val':_0x102d21,'ack':!![]});try{const _0x27cae9='analysis.automation.actionLog',_0xcb061f=await _0xd7f491[_0x2b5d69(0x1f0)](_0x27cae9);let _0x2c5fa8=[];if(_0xcb061f&&_0xcb061f[_0x2b5d69(0x1ed)])try{_0x2c5fa8=JSON[_0x2b5d69(0x261)](_0xcb061f[_0x2b5d69(0x1ed)]);}catch(_0x77221f){}_0x2c5fa8[_0x2b5d69(0x280)]({'ts':Date[_0x2b5d69(0x27b)](),'msg':_0x102d21});if(_0x2c5fa8[_0x2b5d69(0x213)]>0x32)_0x2c5fa8=_0x2c5fa8[_0x2b5d69(0x250)](0x0,0x32);await _0xd7f491[_0x2b5d69(0x1f3)](_0x27cae9,{'val':JSON['stringify'](_0x2c5fa8),'ack':!![]});}catch(_0x1b117c){}}async function handlePrediction(_0x58e194,_0x156b3b,_0x42d213){const _0x44170a=a1_0xbd6d87;if(!_0x156b3b||_0x156b3b===_0x44170a(0x220))return;let _0x20e41d=_0x44170a(0x281),_0x537d4f=0.6;try{const _0x887bf1=await _0x58e194[_0x44170a(0x1f0)](_0x44170a(0x2a7));if(_0x887bf1&&_0x887bf1['val'])_0x20e41d=_0x887bf1[_0x44170a(0x1ed)];const _0x1881e3=await _0x58e194[_0x44170a(0x1f0)](_0x44170a(0x236));if(_0x1881e3&&_0x1881e3[_0x44170a(0x1ed)])_0x537d4f=_0x1881e3[_0x44170a(0x1ed)];}catch(_0x16f39f){}if(_0x20e41d===_0x44170a(0x281)||_0x42d213<_0x537d4f)return;const _0x459dc0=Date[_0x44170a(0x27b)]();if(lastActions[_0x156b3b]&&_0x459dc0-lastActions[_0x156b3b]<COOLDOWN_MS)return;const _0x5b1878=_0x58e194[_0x44170a(0x288)][_0x44170a(0x237)]||[],_0x43fdaa=normalize(_0x156b3b),_0x567c1a=_0x5b1878['find'](_0x32f157=>normalize(_0x32f157['location'])===_0x43fdaa&&(_0x32f157[_0x44170a(0x264)]===_0x44170a(0x26a)||_0x32f157['type']===_0x44170a(0x26c)||_0x32f157[_0x44170a(0x264)]===_0x44170a(0x234)));if(!_0x567c1a)return;const _0x4a0506=await aiAgent[_0x44170a(0x2a1)](_0x58e194,_0x156b3b,_0x567c1a['name'],_0x42d213);if(!_0x4a0506[_0x44170a(0x218)])return;const _0xaac869=_0x44170a(0x23c)+_0x156b3b+_0x44170a(0x211)+_0x567c1a['name']+'\x20('+_0x4a0506[_0x44170a(0x26e)]+')';await logAutomationAction(_0x58e194,'['+_0x20e41d['toUpperCase']()+']\x20'+_0xaac869);if(_0x20e41d==='active'){const _0x22cf43=await _0x58e194[_0x44170a(0x289)](_0x567c1a['id']);(!_0x22cf43||!_0x22cf43[_0x44170a(0x1ed)]&&_0x22cf43[_0x44170a(0x1ed)]!==!![])&&await _0x58e194['setForeignStateAsync'](_0x567c1a['id'],!![]),lastActions[_0x156b3b]=_0x459dc0;}}async function findRelatedId(_0x2ed322,_0x46ca02,_0x5ea16b='setpoint'){const _0x24e2d4=a1_0xbd6d87;if(_0x5ea16b==='setpoint'&&_0x2ed322['config'][_0x24e2d4(0x208)]){let _0xdf30cc=_0x2ed322[_0x24e2d4(0x288)][_0x24e2d4(0x208)];if(typeof _0xdf30cc==='string')try{_0xdf30cc=JSON[_0x24e2d4(0x261)](_0xdf30cc);}catch(_0x386671){}if(_0xdf30cc&&_0xdf30cc[_0x46ca02])return _0xdf30cc[_0x46ca02];}if(_0x5ea16b===_0x24e2d4(0x227)&&_0x2ed322[_0x24e2d4(0x288)][_0x24e2d4(0x2a5)]){let _0x597cda=_0x2ed322[_0x24e2d4(0x288)]['valveMapping'];if(typeof _0x597cda===_0x24e2d4(0x278))try{_0x597cda=JSON['parse'](_0x597cda);}catch(_0x11d1d3){}if(_0x597cda&&_0x597cda[_0x46ca02])return _0x597cda[_0x46ca02];}let _0x4627a5=[];if(_0x5ea16b==='setpoint')_0x4627a5=[{'s':'.1.ACTUAL_TEMPERATURE','t':_0x24e2d4(0x21a)},{'s':_0x24e2d4(0x25c),'t':_0x24e2d4(0x21a)},{'s':_0x24e2d4(0x25c),'t':_0x24e2d4(0x270)},{'s':_0x24e2d4(0x20b),'t':_0x24e2d4(0x28a)},{'s':'local_temperature','t':_0x24e2d4(0x25f)},{'s':_0x24e2d4(0x285),'t':_0x24e2d4(0x200)},{'s':_0x24e2d4(0x299),'t':_0x24e2d4(0x1e5)},{'s':_0x24e2d4(0x1f5),'t':_0x24e2d4(0x2a2)},{'s':'Ist','t':_0x24e2d4(0x262)},{'s':'temperature','t':'setpoint'}];else _0x5ea16b===_0x24e2d4(0x227)&&(_0x4627a5=[{'s':_0x24e2d4(0x203),'t':_0x24e2d4(0x1e9)},{'s':_0x24e2d4(0x25c),'t':_0x24e2d4(0x1e9)},{'s':_0x24e2d4(0x25c),'t':_0x24e2d4(0x25a)},{'s':_0x24e2d4(0x285),'t':'pi_heating_demand'},{'s':_0x24e2d4(0x299),'t':'valve_position'},{'s':_0x24e2d4(0x299),'t':_0x24e2d4(0x1f2)}]);for(const _0x84b379 of _0x4627a5){if(_0x46ca02[_0x24e2d4(0x1ef)](_0x84b379['s'])){const _0x171956=_0x46ca02[_0x24e2d4(0x202)](_0x84b379['s'],_0x84b379['t']),_0x4cedc2=await _0x2ed322['getForeignObjectAsync'](_0x171956);if(_0x4cedc2)return _0x171956;}}try{const _0x505b22=_0x46ca02[_0x24e2d4(0x1ff)]('.');if(_0x505b22[_0x24e2d4(0x213)]>0x2){const _0x261fe8=_0x505b22[_0x24e2d4(0x250)](0x0,-0x1)[_0x24e2d4(0x22f)]('.'),_0x2a8167=await _0x2ed322[_0x24e2d4(0x226)](_0x261fe8+'.*'),_0x36e116=[],_0x6796e5=_0x46ca02['split'](/[._]+/)['filter'](_0x4dd47a=>![_0x24e2d4(0x20f),'0',_0x24e2d4(0x1e4),_0x24e2d4(0x265),_0x24e2d4(0x266),_0x24e2d4(0x299),_0x24e2d4(0x255),'sensor','messwert','state'][_0x24e2d4(0x1ef)](_0x4dd47a[_0x24e2d4(0x259)]()));for(const [_0x1955e9,_0x45ed77]of Object[_0x24e2d4(0x292)](_0x2a8167)){if(_0x1955e9===_0x46ca02)continue;if(_0x45ed77&&_0x45ed77[_0x24e2d4(0x24c)]){const _0x33bb16=_0x1955e9['toLowerCase'](),_0x11d4e7=(_0x45ed77['common'][_0x24e2d4(0x223)]||'')[_0x24e2d4(0x259)](),_0x15675c=(_0x45ed77[_0x24e2d4(0x24c)][_0x24e2d4(0x25b)]||'')[_0x24e2d4(0x259)]();let _0x1706d4=![];if(_0x5ea16b===_0x24e2d4(0x2a6)&&_0x45ed77[_0x24e2d4(0x24c)][_0x24e2d4(0x249)]===!![])_0x1706d4=_0x33bb16['includes'](_0x24e2d4(0x210))||_0x33bb16['includes'](_0x24e2d4(0x22e))||_0x33bb16[_0x24e2d4(0x1ef)](_0x24e2d4(0x295))||_0x11d4e7['includes']('level.temperature')||_0x11d4e7[_0x24e2d4(0x1ef)]('thermostat.setpoint');else _0x5ea16b==='valve'&&(_0x1706d4=_0x33bb16[_0x24e2d4(0x1ef)](_0x24e2d4(0x1f2))||_0x33bb16[_0x24e2d4(0x1ef)](_0x24e2d4(0x227))||_0x33bb16[_0x24e2d4(0x1ef)](_0x24e2d4(0x21f))||_0x33bb16['includes'](_0x24e2d4(0x20c))||_0x11d4e7['includes'](_0x24e2d4(0x27e))||_0x11d4e7[_0x24e2d4(0x1ef)](_0x24e2d4(0x1e6))||_0x15675c[_0x24e2d4(0x1ef)]('%'));if(_0x1706d4){const _0x34366f=_0x1955e9[_0x24e2d4(0x1ff)](/[._]+/)[_0x24e2d4(0x21b)](_0xf53281=>_0xf53281[_0x24e2d4(0x259)]());let _0x41de67=0x0;_0x6796e5[_0x24e2d4(0x258)](_0x480d70=>{const _0x4798b5=_0x24e2d4;if(_0x34366f[_0x4798b5(0x1ef)](_0x480d70[_0x4798b5(0x259)]()))_0x41de67++;}),_0x36e116[_0x24e2d4(0x1e2)]({'id':_0x1955e9,'score':_0x41de67});}}}if(_0x36e116[_0x24e2d4(0x213)]>0x0){_0x36e116['sort']((_0x44a2cc,_0x396646)=>_0x396646[_0x24e2d4(0x2ab)]-_0x44a2cc[_0x24e2d4(0x2ab)]);if(_0x36e116[0x0][_0x24e2d4(0x2ab)]>0x0)return _0x36e116[0x0]['id'];}}}catch(_0x408087){}return null;}async function scanThermostats(_0x571bb1){const _0x10b357=a1_0xbd6d87,_0x747554=_0x571bb1[_0x10b357(0x288)][_0x10b357(0x237)]||[],_0x6098e3=[],_0x581fbe=_0x747554[_0x10b357(0x205)](_0xa3634a=>_0xa3634a['id']&&_0xa3634a['id']['includes'](_0x10b357(0x299))||_0xa3634a[_0x10b357(0x264)]&&[_0x10b357(0x299),_0x10b357(0x298),_0x10b357(0x239)][_0x10b357(0x1ef)](_0xa3634a['type'])||_0xa3634a[_0x10b357(0x29b)]&&_0xa3634a[_0x10b357(0x29b)][_0x10b357(0x259)]()[_0x10b357(0x1ef)]('temp'));for(const _0x499387 of _0x581fbe){const _0x57227a=await findRelatedId(_0x571bb1,_0x499387['id'],_0x10b357(0x2a6)),_0x4ef8e5=await findRelatedId(_0x571bb1,_0x499387['id'],'valve');let _0x39405d=_0x10b357(0x29f),_0x22e391=![],_0xa8254=_0x571bb1[_0x10b357(0x288)][_0x10b357(0x208)]||{};if(typeof _0xa8254===_0x10b357(0x278))try{_0xa8254=JSON[_0x10b357(0x261)](_0xa8254);}catch(_0x54715b){}let _0x5a09ff=_0x571bb1[_0x10b357(0x288)]['valveMapping']||{};if(typeof _0x5a09ff===_0x10b357(0x278))try{_0x5a09ff=JSON[_0x10b357(0x261)](_0x5a09ff);}catch(_0x39b2c8){}if(_0xa8254[_0x499387['id']]&&_0xa8254[_0x499387['id']]===_0x57227a||_0x5a09ff[_0x499387['id']]&&_0x5a09ff[_0x499387['id']]===_0x4ef8e5)_0x39405d=_0x10b357(0x209),_0x22e391=!![];else(_0x57227a||_0x4ef8e5)&&(_0x39405d='Auto-Erkennung');_0x6098e3[_0x10b357(0x1e2)]({'room':_0x499387['location']||_0x10b357(0x23d),'sensorId':_0x499387['id'],'setpointId':_0x57227a||'-','valveId':_0x4ef8e5||'-','source':_0x39405d,'isManual':_0x22e391,'status':_0x57227a&&_0x4ef8e5?_0x10b357(0x1f9):_0x57227a?'OK':_0x10b357(0x221)});}return _0x6098e3[_0x10b357(0x269)]((_0x42e952,_0x222713)=>_0x42e952['room'][_0x10b357(0x1fd)](_0x222713['room']));}async function updateSchedulePreview(_0x51b3ed){const _0x1d4ef1=a1_0xbd6d87;if(!_0x51b3ed[_0x1d4ef1(0x288)][_0x1d4ef1(0x1e8)]||!_0x51b3ed['config'][_0x1d4ef1(0x28c)])return;let _0x158557={};try{const _0x2b81f1=await _0x51b3ed[_0x1d4ef1(0x1f0)](_0x1d4ef1(0x204));if(_0x2b81f1&&_0x2b81f1[_0x1d4ef1(0x1ed)])_0x158557=JSON[_0x1d4ef1(0x261)](_0x2b81f1['val']);}catch(_0xb102f2){}const _0x501723=[],_0x5af5f1=Date[_0x1d4ef1(0x27b)](),_0x1b66eb=0x30*0x3c*0x3c*0x3e8;try{const _0x148fe0=await _0x51b3ed[_0x1d4ef1(0x289)](_0x51b3ed[_0x1d4ef1(0x288)][_0x1d4ef1(0x28c)]+_0x1d4ef1(0x21d));if(!_0x148fe0||!_0x148fe0[_0x1d4ef1(0x1ed)])return;const _0x25f90f=JSON['parse'](_0x148fe0[_0x1d4ef1(0x1ed)]),_0x4ea9c9=_0x51b3ed['config'][_0x1d4ef1(0x215)]||[],_0x35aaec=_0x51b3ed[_0x1d4ef1(0x288)]['devices']||[],_0x12d9d1=new Set();_0x35aaec[_0x1d4ef1(0x258)](_0x577046=>{const _0x495528=_0x1d4ef1;if(_0x577046[_0x495528(0x212)])_0x12d9d1[_0x495528(0x22c)](_0x577046[_0x495528(0x212)]);});for(const _0x37b27a of _0x25f90f){if(_0x37b27a[_0x1d4ef1(0x224)]&&_0x4ea9c9[_0x1d4ef1(0x213)]>0x0&&!_0x4ea9c9[_0x1d4ef1(0x1ef)](_0x37b27a[_0x1d4ef1(0x224)]))continue;const _0x38b5ea=_0x37b27a['_date']||_0x37b27a[_0x1d4ef1(0x1f7)]||_0x37b27a[_0x1d4ef1(0x254)];if(!_0x38b5ea)continue;const _0x4fc2a8=new Date(_0x38b5ea),_0x8d53c5=_0x4fc2a8['getTime']();if(isNaN(_0x8d53c5))continue;if(_0x8d53c5<_0x5af5f1)continue;if(_0x8d53c5>_0x5af5f1+_0x1b66eb)continue;const _0xbdc027=(_0x37b27a[_0x1d4ef1(0x257)]||_0x37b27a[_0x1d4ef1(0x284)]||'')[_0x1d4ef1(0x259)]();let _0x167e77=![],_0x4b43b9=[],_0x1860df=_0x37b27a['event']||_0x37b27a[_0x1d4ef1(0x284)]||_0x1d4ef1(0x23d);if(_0xbdc027[_0x1d4ef1(0x1ef)](_0x1d4ef1(0x29c))||_0xbdc027[_0x1d4ef1(0x1ef)]('rÃ¼ckkehr')||_0xbdc027[_0x1d4ef1(0x1ef)](_0x1d4ef1(0x1fa)))_0x167e77=!![],_0x4b43b9=Array[_0x1d4ef1(0x29a)](_0x12d9d1);else for(const _0x19ad20 of _0x12d9d1){if(_0xbdc027[_0x1d4ef1(0x1ef)](_0x19ad20['toLowerCase']()))_0x4b43b9[_0x1d4ef1(0x1e2)](_0x19ad20);}_0x4b43b9['length']>0x0&&_0x4b43b9[_0x1d4ef1(0x258)](_0x188e2a=>{const _0x50988a=_0x1d4ef1;let _0x2f33fa=0x3c;if(_0x167e77){let _0x5a1418=0x0;Object[_0x50988a(0x1fb)](_0x158557)[_0x50988a(0x258)](_0x1e11cb=>{if(_0x1e11cb>_0x5a1418)_0x5a1418=_0x1e11cb;}),_0x2f33fa=_0x5a1418>0x0?_0x5a1418:0x78;}else _0x2f33fa=getWarmupRobust(_0x158557,_0x188e2a);const _0x480de9=new Date(_0x8d53c5-_0x2f33fa*0xea60);_0x501723[_0x50988a(0x1e2)]({'eventTime':_0x8d53c5,'triggerTime':_0x480de9['getTime'](),'room':_0x188e2a,'minutes':_0x2f33fa,'reason':_0x1860df,'isGlobal':_0x167e77});});}}catch(_0x4543d4){}_0x501723[_0x1d4ef1(0x269)]((_0x2ea56e,_0x5f0d64)=>_0x2ea56e[_0x1d4ef1(0x2a8)]-_0x5f0d64[_0x1d4ef1(0x2a8)]);const _0x3e94d1=_0x501723[_0x1d4ef1(0x250)](0x0,0x5);await _0x51b3ed[_0x1d4ef1(0x1f3)]('analysis.energy.schedulePreview',{'val':JSON[_0x1d4ef1(0x231)](_0x3e94d1),'ack':!![]});}async function monitorEnforcements(_0x52b55c){const _0x25580f=a1_0xbd6d87;try{const _0x9537de=_0x25580f(0x26d),_0x595e94=await _0x52b55c[_0x25580f(0x1f0)](_0x9537de);if(!_0x595e94||!_0x595e94[_0x25580f(0x1ed)])return;let _0x381684=[];try{_0x381684=JSON[_0x25580f(0x261)](_0x595e94[_0x25580f(0x1ed)]);}catch(_0x4bdf48){return;}if(!Array[_0x25580f(0x267)](_0x381684)||_0x381684[_0x25580f(0x213)]===0x0)return;const _0x4d13c4=Date['now'](),_0x3328d7=_0x52b55c[_0x25580f(0x288)][_0x25580f(0x237)]||[];let _0x22f321=![];for(let _0x598680=_0x381684['length']-0x1;_0x598680>=0x0;_0x598680--){const _0x572c1d=_0x381684[_0x598680];if(_0x4d13c4>=_0x572c1d[_0x25580f(0x2aa)]){_0x52b55c[_0x25580f(0x1f8)][_0x25580f(0x21e)](_0x25580f(0x248)+_0x572c1d['room']+_0x25580f(0x24b)),_0x381684['splice'](_0x598680,0x1),_0x22f321=!![];continue;}const _0x53c2dd=_0x3328d7[_0x25580f(0x2a0)](_0xbce03b=>normalize(_0xbce03b[_0x25580f(0x212)])===normalize(_0x572c1d['room'])&&(_0xbce03b['type']===_0x25580f(0x299)||_0xbce03b[_0x25580f(0x264)]===_0x25580f(0x298)));if(_0x53c2dd){const _0x58cbc9=await findRelatedId(_0x52b55c,_0x53c2dd['id'],_0x25580f(0x2a6));if(_0x58cbc9){const _0x519406=await _0x52b55c[_0x25580f(0x289)](_0x58cbc9);_0x519406&&typeof _0x519406[_0x25580f(0x1ed)]==='number'&&(_0x519406['val']<0xf&&(_0x52b55c[_0x25580f(0x1f8)][_0x25580f(0x22d)](_0x25580f(0x25e)+_0x572c1d[_0x25580f(0x216)]+'\x20auf\x20'+_0x519406[_0x25580f(0x1ed)]+_0x25580f(0x275)+_0x572c1d[_0x25580f(0x295)]+_0x25580f(0x2a3)),await _0x52b55c[_0x25580f(0x27c)](_0x58cbc9,_0x572c1d['target']),await logAutomationAction(_0x52b55c,_0x25580f(0x1e3)+_0x572c1d[_0x25580f(0x216)]+':\x20'+_0x519406[_0x25580f(0x1ed)]+'Â°C\x20->\x20'+_0x572c1d[_0x25580f(0x295)]+_0x25580f(0x229))));}}}_0x22f321&&await _0x52b55c[_0x25580f(0x1f3)](_0x9537de,{'val':JSON[_0x25580f(0x231)](_0x381684),'ack':!![]});}catch(_0x31e178){_0x52b55c[_0x25580f(0x1f8)][_0x25580f(0x28f)](_0x25580f(0x268)+_0x31e178[_0x25580f(0x243)]);}}function a1_0x4069(){const _0x372f05=['\x20->\x20','eventStart','log','PERFECT','ankunft','values','number','localeCompare',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','split','current_heating_setpoint','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','replace','.1.ACTUAL_TEMPERATURE','analysis.energy.warmupTimes','filter','./ai_agent','Â°C\x20<\x20','thermostatMapping','Manuelles\x20Mapping','_date','ACTUAL_TEMPERATURE','position','analysis.energy.warmupSources','_meta','openknx','set','\x20->\x20Schalte\x20','location','length','\x20min)','calendarSelection','room','getTime','approved','getHours','.1.SET_POINT_TEMPERATURE','map','131211qNsLvb','.data.table','info','stellwert','Unknown','Fehlt','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20','role','_calName','analysis.automation.lastAction','getForeignObjectsAsync','valve','ðŸ§¹\x20[MPC\x20CLEANUP]\x20','Â°C\x20(Kalender-Schutz)','ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20','mpc_','add','warn','soll','join',':\x20Aufheizen\x20auf\x20','stringify','Â°C).\x20Sparmodus\x20beendet!','1314660leaavg','switch','Classic','analysis.automation.confidenceThreshold','devices',']:\x20Raum-Trigger\x20\x27','sensor','abs','ðŸ“…\x20SMART\x20SCHEDULE\x20[','PrÃ¤diktion:\x20','Unbekannt','\x20erreicht\x20Limit\x20(','Calendar\x20Check\x20Error:\x20','ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27','ðŸ“…\x20[MPC\x20INFO]\x20','\x20wieder\x20auf\x20','message','138222DqtRIN','154221puihBx','analysis.energy.mpcActiveInterventions','exports','ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','write','2152GJtwZc','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','common','Â°C).\x20Entferne\x20Status.','4HIZyXA','splice','slice','remove','Â°C\x20(via\x20','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','date','actual','\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.','event','forEach','toLowerCase','.4.VALVE_STATE','unit','.1.TEMPERATURE','\x20ist\x20auf\x20','ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','occupied_heating_setpoint',':\x20Absenkung\x20auf\x20','parse','Soll','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','type','ist','wert','isArray','Enforcement\x20Monitor\x20Error:\x20','sort','light','ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','dimmer','analysis.energy.activeEnforcements','reason','analysis.energy.rlPenalties','.4.SET_TEMPERATURE','default','contact','search','rescue_','Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20','normal','analysis.energy.warmupTargets','string','constructor','currentSystemMode','now','setForeignStateAsync','cal_','level.valve','analysis.energy.ventilationAlerts','unshift','off','6237VnERCm','apply','summary','local_temperature','\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.','501015mQUjXZ','config','getForeignStateAsync','SET_POINT_TEMPERATURE','ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20','calendarInstance','minutes_safe','toString','error','[WATCHDOG]\x20','open','entries','window','system.mode','target','findIndex','ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','thermostat','temperature','from','name','urlaub\x20ende',')\x20aktiv.\x20Heize\x20auf\x20','Â°C!\x20(Puffer:\x20','Nicht\x20gefunden','find','consultButler','SET','Â°C.','manual','valveMapping','setpoint','analysis.automation.mode','triggerTime','too_cold','until','score','TRAIN_RL_PENALTY','\x20gefunden!','push','[FORCE]\x20','hm-rpc','target_temperature','value.valve','[CAL]\x20','useCalendar','.1.LEVEL','ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20','(((.+)+)+)+$','\x20wurde\x20manuell\x20erhÃ¶ht.','val','6qakYIF','includes','getStateAsync','sendToPythonWrapper','level','setStateAsync','141770RlfyEU','ACTUAL'];a1_0x4069=function(){return _0x372f05;};return a1_0x4069();}async function checkCalendarTriggers(_0x38780c){const _0x1f3cd0=a1_0xbd6d87;if(!_0x38780c[_0x1f3cd0(0x288)][_0x1f3cd0(0x1e8)]||!_0x38780c[_0x1f3cd0(0x288)][_0x1f3cd0(0x28c)])return;await updateSchedulePreview(_0x38780c);let _0x6660d={},_0x5aa84d={};try{const _0xbae932=await _0x38780c[_0x1f3cd0(0x1f0)](_0x1f3cd0(0x204));if(_0xbae932&&_0xbae932[_0x1f3cd0(0x1ed)])_0x6660d=JSON[_0x1f3cd0(0x261)](_0xbae932['val']);const _0x2d3644=await _0x38780c['getStateAsync'](_0x1f3cd0(0x20d));if(_0x2d3644&&_0x2d3644['val'])_0x5aa84d=JSON['parse'](_0x2d3644['val']);}catch(_0xab3410){}let _0x2adeab={'default':0x15};try{const _0x48d7da=await _0x38780c[_0x1f3cd0(0x1f0)](_0x1f3cd0(0x277));if(_0x48d7da&&_0x48d7da[_0x1f3cd0(0x1ed)])_0x2adeab=JSON[_0x1f3cd0(0x261)](_0x48d7da[_0x1f3cd0(0x1ed)]);}catch(_0x5c925){}let _0x15c413=[];try{const _0x190c6a=await _0x38780c[_0x1f3cd0(0x1f0)]('analysis.energy.activeEnforcements');if(_0x190c6a&&_0x190c6a[_0x1f3cd0(0x1ed)])_0x15c413=JSON[_0x1f3cd0(0x261)](_0x190c6a['val']);}catch(_0x15a2e4){}try{const _0x4f9865=await _0x38780c[_0x1f3cd0(0x289)](_0x38780c['config'][_0x1f3cd0(0x28c)]+_0x1f3cd0(0x21d));if(!_0x4f9865||!_0x4f9865['val'])return;const _0x30f75f=JSON[_0x1f3cd0(0x261)](_0x4f9865[_0x1f3cd0(0x1ed)]),_0xbe2963=Date[_0x1f3cd0(0x27b)](),_0x21e99d=_0x38780c[_0x1f3cd0(0x288)][_0x1f3cd0(0x237)]||[],_0xdfed3=_0x38780c[_0x1f3cd0(0x288)][_0x1f3cd0(0x215)]||[];let _0x55caca=![];for(const _0x27dbe9 of _0x30f75f){if(_0x27dbe9[_0x1f3cd0(0x224)]&&_0xdfed3['length']>0x0&&!_0xdfed3[_0x1f3cd0(0x1ef)](_0x27dbe9[_0x1f3cd0(0x224)]))continue;const _0x9da40f=_0x27dbe9[_0x1f3cd0(0x20a)]||_0x27dbe9[_0x1f3cd0(0x1f7)]||_0x27dbe9[_0x1f3cd0(0x254)];if(!_0x9da40f)continue;const _0x1dca9c=new Date(_0x9da40f);if(isNaN(_0x1dca9c[_0x1f3cd0(0x217)]()))continue;const _0x548183=(_0x27dbe9['event']||_0x27dbe9['summary']||'')[_0x1f3cd0(0x259)]();if(_0x548183['includes'](_0x1f3cd0(0x29c))||_0x548183[_0x1f3cd0(0x1ef)]('rÃ¼ckkehr')||_0x548183['includes'](_0x1f3cd0(0x1fa))){let _0x461c9f=0x0;Object[_0x1f3cd0(0x1fb)](_0x6660d)['forEach'](_0x3311d9=>{if(_0x3311d9>_0x461c9f)_0x461c9f=_0x3311d9;});if(_0x461c9f===0x0)_0x461c9f=0x78;const _0x391da4=_0x1dca9c['getTime']()-_0x461c9f*0xea60;_0xbe2963>=_0x391da4&&_0xbe2963<_0x1dca9c['getTime']()&&(_0x38780c[_0x1f3cd0(0x27a)]!=='normal'&&(_0x38780c[_0x1f3cd0(0x1f8)]['info'](_0x1f3cd0(0x297)+_0x461c9f+'\x20min).'),await _0x38780c[_0x1f3cd0(0x1f3)](_0x1f3cd0(0x294),{'val':_0x1f3cd0(0x276),'ack':![]})));}for(const _0x3fa70d of _0x21e99d){if(_0x3fa70d[_0x1f3cd0(0x212)]){const _0x500ba1=_0x3fa70d[_0x1f3cd0(0x212)][_0x1f3cd0(0x259)](),_0x206924=(_0x3fa70d[_0x1f3cd0(0x29b)]||'')[_0x1f3cd0(0x259)]();let _0x354cbd=_0x548183[_0x1f3cd0(0x1ef)](_0x500ba1);!_0x354cbd&&_0x206924[_0x1f3cd0(0x213)]>0x3&&_0x548183[_0x1f3cd0(0x1ef)](_0x206924)&&(_0x354cbd=!![]);if(_0x354cbd){const _0x4a9a1e=getWarmupRobust(_0x6660d,_0x3fa70d['location']),_0x53d7a1=_0x5aa84d[_0x3fa70d['location']]||_0x1f3cd0(0x235),_0xf956af=_0x1dca9c[_0x1f3cd0(0x217)]()-_0x4a9a1e*0xea60;if(_0xbe2963>=_0xf956af&&_0xbe2963<_0x1dca9c['getTime']()){const _0xcbec98=lastActions[_0x1f3cd0(0x27d)+_0x3fa70d[_0x1f3cd0(0x212)]];if(_0xcbec98&&_0xbe2963-_0xcbec98<CAL_COOLDOWN_MS)continue;const _0x4491e5=await findRelatedId(_0x38780c,_0x3fa70d['id'],_0x1f3cd0(0x2a6));if(_0x4491e5){let _0x1cd00e=_0x2adeab[_0x3fa70d[_0x1f3cd0(0x212)]];if(_0x1cd00e===undefined)_0x1cd00e=_0x2adeab[_0x1f3cd0(0x271)];if(_0x1cd00e===undefined)_0x1cd00e=0x15;const _0x4f8131=await _0x38780c[_0x1f3cd0(0x289)](_0x4491e5);if(_0x4f8131&&typeof _0x4f8131['val']===_0x1f3cd0(0x1fc)&&_0x4f8131['val']<_0x1cd00e-0.5){_0x38780c['log']['info'](_0x1f3cd0(0x23b)+_0x53d7a1+_0x1f3cd0(0x238)+_0x3fa70d[_0x1f3cd0(0x212)]+'\x27\x20(Match:\x20'+_0x548183+_0x1f3cd0(0x29d)+_0x1cd00e+'Â°C\x20(Vorlauf:\x20'+_0x4a9a1e+'\x20min).'),await _0x38780c['setForeignStateAsync'](_0x4491e5,_0x1cd00e),await logAutomationAction(_0x38780c,_0x1f3cd0(0x1e7)+_0x3fa70d['location']+_0x1f3cd0(0x1f6)+_0x1cd00e+_0x1f3cd0(0x252)+_0x53d7a1+')'),lastActions[_0x1f3cd0(0x27d)+_0x3fa70d[_0x1f3cd0(0x212)]]=_0xbe2963;const _0x4301ee=_0x15c413[_0x1f3cd0(0x296)](_0x162fb1=>_0x162fb1[_0x1f3cd0(0x216)]===_0x3fa70d[_0x1f3cd0(0x212)]);if(_0x4301ee!==-0x1)_0x15c413[_0x1f3cd0(0x24f)](_0x4301ee,0x1);_0x15c413[_0x1f3cd0(0x1e2)]({'room':_0x3fa70d[_0x1f3cd0(0x212)],'target':_0x1cd00e,'until':_0x1dca9c[_0x1f3cd0(0x217)]()}),_0x55caca=!![];}}}}}}}_0x55caca&&await _0x38780c[_0x1f3cd0(0x1f3)](_0x1f3cd0(0x26d),{'val':JSON[_0x1f3cd0(0x231)](_0x15c413),'ack':!![]});}catch(_0x46c709){_0x38780c[_0x1f3cd0(0x1f8)][_0x1f3cd0(0x22d)](_0x1f3cd0(0x23f)+_0x46c709['message']);}}async function manageMpcIntervention(_0x2fbe42,_0x29ba1f,_0x53dc8b){const _0x22b03b=a1_0xbd6d87;try{const _0x2be63e=_0x22b03b(0x246),_0x2e2e15=await _0x2fbe42[_0x22b03b(0x1f0)](_0x2be63e);let _0x4a4bfe=[];if(_0x2e2e15&&_0x2e2e15['val'])try{_0x4a4bfe=JSON['parse'](_0x2e2e15['val']);}catch(_0x391c3c){}const _0x1cc994=_0x4a4bfe['indexOf'](_0x29ba1f);if(_0x53dc8b==='add')_0x1cc994===-0x1&&(_0x4a4bfe[_0x22b03b(0x1e2)](_0x29ba1f),await _0x2fbe42[_0x22b03b(0x1f3)](_0x2be63e,{'val':JSON[_0x22b03b(0x231)](_0x4a4bfe),'ack':!![]}));else _0x53dc8b===_0x22b03b(0x251)&&(_0x1cc994!==-0x1&&(_0x4a4bfe['splice'](_0x1cc994,0x1),await _0x2fbe42['setStateAsync'](_0x2be63e,{'val':JSON['stringify'](_0x4a4bfe),'ack':!![]})));}catch(_0x314080){}}async function cleanupGhostInterventions(_0x500f3b){const _0x15b036=a1_0xbd6d87;try{const _0x3a00cf=_0x15b036(0x246),_0xaff068=await _0x500f3b[_0x15b036(0x1f0)](_0x3a00cf);if(!_0xaff068||!_0xaff068['val'])return;const _0x1e80cf=JSON[_0x15b036(0x261)](_0xaff068[_0x15b036(0x1ed)]);if(!Array[_0x15b036(0x267)](_0x1e80cf)||_0x1e80cf[_0x15b036(0x213)]===0x0)return;let _0x5291fa={'default':0x15};try{const _0xa5f9d4=await _0x500f3b[_0x15b036(0x1f0)](_0x15b036(0x277));if(_0xa5f9d4&&_0xa5f9d4[_0x15b036(0x1ed)])_0x5291fa=JSON[_0x15b036(0x261)](_0xa5f9d4[_0x15b036(0x1ed)]);}catch(_0x4a6110){}let _0x4cefcf=[];try{const _0x79541c=await _0x500f3b['getStateAsync'](_0x15b036(0x27f));if(_0x79541c&&_0x79541c[_0x15b036(0x1ed)])_0x4cefcf=JSON[_0x15b036(0x261)](_0x79541c[_0x15b036(0x1ed)]);}catch(_0x3cc4cf){}let _0x45ea50={},_0x9e2f53=![];try{const _0x40eaac=await _0x500f3b[_0x15b036(0x1f0)](_0x15b036(0x26f));if(_0x40eaac&&_0x40eaac[_0x15b036(0x1ed)])_0x45ea50=JSON['parse'](_0x40eaac[_0x15b036(0x1ed)]);}catch(_0x1ea7f0){}if(_0x45ea50[_0x15b036(0x20e)]){const _0x5db54d=Date[_0x15b036(0x27b)]();for(const [_0x25a6c6,_0x16160d]of Object[_0x15b036(0x292)](_0x45ea50[_0x15b036(0x20e)])){_0x5db54d-_0x16160d>PENALTY_TTL&&(delete _0x45ea50[_0x25a6c6],delete _0x45ea50[_0x15b036(0x20e)][_0x25a6c6],_0x9e2f53=!![],_0x500f3b[_0x15b036(0x1f8)][_0x15b036(0x21e)](_0x15b036(0x240)+_0x25a6c6+_0x15b036(0x201)));}}const _0x3063d0=_0x500f3b[_0x15b036(0x288)][_0x15b036(0x237)]||[];let _0x18d612=![];for(let _0x2b017d=_0x1e80cf['length']-0x1;_0x2b017d>=0x0;_0x2b017d--){const _0x5c6e1c=_0x1e80cf[_0x2b017d],_0x3ec4a5=_0x3063d0[_0x15b036(0x2a0)](_0x5969ae=>normalize(_0x5969ae[_0x15b036(0x212)])===normalize(_0x5c6e1c)&&(_0x5969ae[_0x15b036(0x264)]===_0x15b036(0x299)||_0x5969ae[_0x15b036(0x264)]===_0x15b036(0x298)));if(!_0x3ec4a5){_0x500f3b[_0x15b036(0x1f8)][_0x15b036(0x22d)](_0x15b036(0x26b)+_0x5c6e1c+_0x15b036(0x286)),_0x1e80cf[_0x15b036(0x24f)](_0x2b017d,0x1),_0x18d612=!![];continue;}if(_0x3ec4a5){const _0x3ac46a=await findRelatedId(_0x500f3b,_0x3ec4a5['id'],_0x15b036(0x2a6)),_0x4cb276=await _0x500f3b['getForeignStateAsync'](_0x3ec4a5['id']);if(_0x3ac46a){const _0x450630=await _0x500f3b['getForeignStateAsync'](_0x3ac46a);if(_0x450630&&typeof _0x450630[_0x15b036(0x1ed)]===_0x15b036(0x1fc)){let _0x42b4a7=![],_0x6b5f5c='';Math[_0x15b036(0x23a)](_0x450630[_0x15b036(0x1ed)]-ECO_TEMP)>0.5&&(_0x42b4a7=!![],_0x6b5f5c=_0x15b036(0x2a4));if(!_0x42b4a7&&_0x4cb276&&typeof _0x4cb276[_0x15b036(0x1ed)]===_0x15b036(0x1fc)){const _0x499724=_0x5291fa[_0x5c6e1c]||_0x5291fa[_0x15b036(0x271)]||0x15;_0x4cb276[_0x15b036(0x1ed)]<_0x499724+0.2&&(_0x42b4a7=!![],_0x6b5f5c=_0x15b036(0x2a9));}if(_0x42b4a7){if(_0x6b5f5c===_0x15b036(0x2a4)){_0x500f3b['log'][_0x15b036(0x21e)](_0x15b036(0x228)+_0x5c6e1c+_0x15b036(0x25d)+_0x450630[_0x15b036(0x1ed)]+'Â°C\x20(nicht\x20'+ECO_TEMP+_0x15b036(0x24d));const _0x5e4ad1=lastActions[_0x15b036(0x27d)+_0x5c6e1c],_0x3b6f54=_0x5e4ad1&&Date['now']()-_0x5e4ad1<0x2*0x3c*0x3e8;if(!_0x3b6f54&&_0x450630['val']>ECO_TEMP+0.5){_0x500f3b[_0x15b036(0x1f1)]&&(_0x500f3b[_0x15b036(0x1f8)][_0x15b036(0x21e)]('ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20'+_0x5c6e1c+_0x15b036(0x1ec)),_0x500f3b[_0x15b036(0x1f1)](_0x15b036(0x2ac),{'room':_0x5c6e1c}));const _0x4ced03=_0x5c6e1c+'_'+new Date()[_0x15b036(0x219)]();if(!_0x45ea50[_0x4ced03]){_0x45ea50[_0x4ced03]=0x1;if(!_0x45ea50[_0x15b036(0x20e)])_0x45ea50[_0x15b036(0x20e)]={};_0x45ea50['_meta'][_0x4ced03]=Date['now'](),_0x9e2f53=!![];}}else _0x3b6f54&&_0x500f3b['log'][_0x15b036(0x21e)](_0x15b036(0x241)+_0x5c6e1c+_0x15b036(0x256));}else{if(_0x6b5f5c===_0x15b036(0x2a9)){let _0x2a6ded=![];if(_0x4cefcf[_0x15b036(0x2a0)](_0x3df562=>_0x3df562['room']===_0x5c6e1c))_0x2a6ded=!![];const _0x275755=_0x3063d0[_0x15b036(0x205)](_0x29f366=>normalize(_0x29f366[_0x15b036(0x212)])===normalize(_0x5c6e1c)&&(_0x29f366[_0x15b036(0x264)]===_0x15b036(0x293)||_0x29f366[_0x15b036(0x264)]===_0x15b036(0x239)||_0x29f366[_0x15b036(0x264)]===_0x15b036(0x272)));for(const _0x1b5b72 of _0x275755){try{const _0x1c2835=await _0x500f3b[_0x15b036(0x289)](_0x1b5b72['id']);if(_0x1c2835&&(_0x1c2835[_0x15b036(0x1ed)]===!![]||_0x1c2835[_0x15b036(0x1ed)]===0x1||String(_0x1c2835[_0x15b036(0x1ed)])[_0x15b036(0x259)]()===_0x15b036(0x291)))_0x2a6ded=!![];}catch(_0x309d42){}}if(_0x2a6ded)_0x500f3b['log'][_0x15b036(0x21e)](_0x15b036(0x22a)+_0x5c6e1c+_0x15b036(0x253));else{const _0x210fac=_0x5291fa[_0x5c6e1c]||_0x5291fa['default']||0x15;_0x500f3b[_0x15b036(0x1f8)]['info'](_0x15b036(0x263)+_0x5c6e1c+_0x15b036(0x23e)+_0x4cb276['val']+_0x15b036(0x207)+(_0x210fac+0.2)+_0x15b036(0x232)),await _0x500f3b[_0x15b036(0x27c)](_0x3ac46a,_0x210fac),await logAutomationAction(_0x500f3b,_0x15b036(0x290)+_0x5c6e1c+_0x15b036(0x1fe)+_0x210fac+'Â°C'),lastActions['rescue_'+_0x5c6e1c]=Date[_0x15b036(0x27b)]();}}}_0x1e80cf['splice'](_0x2b017d,0x1),_0x18d612=!![];}}}}}_0x18d612&&await _0x500f3b[_0x15b036(0x1f3)](_0x3a00cf,{'val':JSON[_0x15b036(0x231)](_0x1e80cf),'ack':!![]}),_0x9e2f53&&await _0x500f3b[_0x15b036(0x1f3)]('analysis.energy.rlPenalties',{'val':JSON[_0x15b036(0x231)](_0x45ea50),'ack':!![]});}catch(_0x1012ed){}}async function applyEnergySavings(_0x2d074d,_0xb2261c){const _0x34c5a5=a1_0xbd6d87;await cleanupGhostInterventions(_0x2d074d);if(!_0xb2261c||_0xb2261c[_0x34c5a5(0x213)]===0x0)return;const _0x2263c3=_0x2d074d[_0x34c5a5(0x288)][_0x34c5a5(0x237)]||[],_0x1cca05=Date[_0x34c5a5(0x27b)]();for(const _0x413913 of _0xb2261c){const _0x5b693c=_0x413913[_0x34c5a5(0x216)],_0x5c17bc=_0x413913[_0x34c5a5(0x28d)],_0x184100=_0x413913[_0x34c5a5(0x295)]||0x15;if(lastActions[_0x34c5a5(0x274)+_0x5b693c]&&_0x1cca05-lastActions['rescue_'+_0x5b693c]<RESCUE_LOCK_MS)continue;const _0x1fc40c=_0x2263c3['find'](_0xc4dbb1=>normalize(_0xc4dbb1['location'])===normalize(_0x5b693c)&&(_0xc4dbb1[_0x34c5a5(0x264)]===_0x34c5a5(0x299)||_0xc4dbb1[_0x34c5a5(0x264)]==='thermostat'));if(!_0x1fc40c)continue;const _0x3e9b7e=await findRelatedId(_0x2d074d,_0x1fc40c['id'],'setpoint');if(_0x3e9b7e){if(lastActions[_0x34c5a5(0x22b)+_0x5b693c]&&_0x1cca05-lastActions[_0x34c5a5(0x22b)+_0x5b693c]<0x1e*0x3c*0x3e8)continue;const _0x4f6886=await _0x2d074d[_0x34c5a5(0x289)](_0x3e9b7e);if(_0x4f6886&&typeof _0x4f6886[_0x34c5a5(0x1ed)]===_0x34c5a5(0x1fc)){const _0x7f62ea=_0x4f6886['val'];_0x7f62ea!==ECO_TEMP&&await manageMpcIntervention(_0x2d074d,_0x5b693c,_0x34c5a5(0x251));if(_0x5c17bc>0x1e)_0x7f62ea>ECO_TEMP+0.5&&(_0x2d074d[_0x34c5a5(0x1f8)][_0x34c5a5(0x21e)](_0x34c5a5(0x1ea)+_0x5b693c+'\x20auf\x20'+ECO_TEMP+_0x34c5a5(0x29e)+_0x5c17bc+_0x34c5a5(0x214)),await _0x2d074d[_0x34c5a5(0x27c)](_0x3e9b7e,ECO_TEMP),await manageMpcIntervention(_0x2d074d,_0x5b693c,_0x34c5a5(0x22c)),lastActions[_0x34c5a5(0x22b)+_0x5b693c]=_0x1cca05,await logAutomationAction(_0x2d074d,'[MPC]\x20'+_0x5b693c+_0x34c5a5(0x260)+ECO_TEMP+'Â°C'));else _0x5c17bc<=0xf&&(_0x7f62ea<_0x184100&&(_0x2d074d[_0x34c5a5(0x1f8)][_0x34c5a5(0x21e)](_0x34c5a5(0x28b)+_0x5b693c+_0x34c5a5(0x242)+_0x184100+'Â°C!\x20(Puffer\x20leer).'),await _0x2d074d[_0x34c5a5(0x27c)](_0x3e9b7e,_0x184100),await manageMpcIntervention(_0x2d074d,_0x5b693c,_0x34c5a5(0x251)),lastActions[_0x34c5a5(0x22b)+_0x5b693c]=_0x1cca05,await logAutomationAction(_0x2d074d,'[MPC]\x20'+_0x5b693c+_0x34c5a5(0x230)+_0x184100+'Â°C')));}}else _0x2d074d[_0x34c5a5(0x1f8)][_0x34c5a5(0x22d)](_0x34c5a5(0x222)+_0x5b693c+_0x34c5a5(0x2ad));}}module[a1_0xbd6d87(0x247)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};