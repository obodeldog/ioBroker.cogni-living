const a1_0x36fbab=a1_0x48ce;(function(_0x164d92,_0x9445ed){const _0x2e41ee=a1_0x48ce,_0x36a4aa=_0x164d92();while(!![]){try{const _0x392750=-parseInt(_0x2e41ee(0x1da))/0x1*(-parseInt(_0x2e41ee(0x1f2))/0x2)+-parseInt(_0x2e41ee(0x1cb))/0x3+-parseInt(_0x2e41ee(0x233))/0x4*(-parseInt(_0x2e41ee(0x1b5))/0x5)+parseInt(_0x2e41ee(0x224))/0x6+-parseInt(_0x2e41ee(0x1be))/0x7*(-parseInt(_0x2e41ee(0x1ff))/0x8)+-parseInt(_0x2e41ee(0x254))/0x9*(parseInt(_0x2e41ee(0x25e))/0xa)+parseInt(_0x2e41ee(0x1f6))/0xb*(-parseInt(_0x2e41ee(0x1e2))/0xc);if(_0x392750===_0x9445ed)break;else _0x36a4aa['push'](_0x36a4aa['shift']());}catch(_0x5152d2){_0x36a4aa['push'](_0x36a4aa['shift']());}}}(a1_0x43f2,0xd0818));const a1_0x312ca4=(function(){let _0x3ea2b4=!![];return function(_0x44968c,_0x27edc7){const _0x2aced8=_0x3ea2b4?function(){if(_0x27edc7){const _0x5bfc73=_0x27edc7['apply'](_0x44968c,arguments);return _0x27edc7=null,_0x5bfc73;}}:function(){};return _0x3ea2b4=![],_0x2aced8;};}()),a1_0x4bb9e5=a1_0x312ca4(this,function(){const _0x5840b2=a1_0x48ce;return a1_0x4bb9e5[_0x5840b2(0x256)]()[_0x5840b2(0x20f)]('(((.+)+)+)+$')[_0x5840b2(0x256)]()[_0x5840b2(0x1c1)](a1_0x4bb9e5)[_0x5840b2(0x20f)](_0x5840b2(0x222));});function a1_0x48ce(_0x100236,_0x51d1fe){const _0x1893c6=a1_0x43f2();return a1_0x48ce=function(_0x4bb9e5,_0x312ca4){_0x4bb9e5=_0x4bb9e5-0x19f;let _0x43f2a2=_0x1893c6[_0x4bb9e5];return _0x43f2a2;},a1_0x48ce(_0x100236,_0x51d1fe);}function a1_0x43f2(){const _0x4d1dc4=['8912LmUbna','analysis.energy.activeEnforcements','occupied_heating_setpoint','temp','target_temperature','\x20->\x20Schalte\x20','urlaub\x20ende','exports','Unbekannt','remove','calendarSelection','temperature','[MPC]\x20','type','until','summary','forEach','Ist','entries','Fehlt','getHours','analysis.automation.lastAction','common','\x20gefunden!','useCalendar','includes','current_heating_setpoint','PERFECT','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','Auto-Erkennung','\x20ist\x20auf\x20','valveMapping','3555QGVwHO','sensor','toString',']:\x20Raum-Trigger\x20\x27','analysis.energy.mpcActiveInterventions','ACTUAL_TEMPERATURE','too_cold','devices','.1.SET_POINT_TEMPERATURE','openknx','42890QRChUs','\x20min).','level.temperature','.4.SET_TEMPERATURE',')\x20aktiv.\x20Heize\x20auf\x20','abs','TRAIN_RL_PENALTY','analysis.energy.warmupTimes','room','¬∞C\x20(nicht\x20','thermostat','stringify','\x20->\x20','target','\x20min)','[WATCHDOG]\x20','approved','setStateAsync','slice','üìÖ\x20SMART\x20SCHEDULE\x20[','message','warn','[CAL]\x20','push','value.valve','setpoint','switch','number','analysis.energy.rlPenalties','.1.TEMPERATURE','SET','valve_position','string','position','üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','3780MZVpCO','r√ºckkehr','replace','_date','localeCompare','light','from','length','splice','14sGPfrz','unit','info','constructor','üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','_calName','mpc_','toLowerCase','Classic','üìÖ\x20[MPC\x20INFO]\x20','\x20wieder\x20auf\x20','¬∞C\x20(Kalender-Schutz)','SET_POINT_TEMPERATURE','823494wMPqZt','split','ist','\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.','open','level','off','¬∞C\x20<\x20','getForeignStateAsync','unshift','name','.data.table','sort','getStateAsync','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','1623yFKyZQ','\x27\x20(Match:\x20','config',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','ankunft','date','üö®\x20[MPC\x20WATCHDOG]\x20','\x20auf\x20','648eJjPYY','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','Nicht\x20gefunden','¬∞C!\x20(Puffer:\x20','add','Soll','dimmer','trim','toUpperCase','üßπ\x20[MPC\x20CLEANUP]\x20','pi_heating_demand','thermostat.setpoint','write','find','sendToPythonWrapper','join','116kzLtKv','üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','analysis.automation.confidenceThreshold','getTime','163075BYCjEl','eventStart','¬∞C\x20(Vorlauf:\x20','rescue_','analysis.automation.actionLog','valve','triggerTime','normal','setForeignStateAsync','1534912NAYkhd','val','thermostatMapping','\x20erreicht\x20Limit\x20(','cal_','_meta','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','findIndex','log','getForeignObjectsAsync','system.mode','ACTUAL','.1.ACTUAL_TEMPERATURE','./ai_agent','event','minutes_safe','search','isArray','local_temperature','Unknown','.4.VALVE_STATE','now','manual','analysis.energy.ventilationAlerts','üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','level.valve','set','score','Manuelles\x20Mapping','parse','üî•\x20[MPC\x20ACTION]\x20Heize\x20','calendarInstance','default','soll','¬∞C\x20(via\x20','(((.+)+)+)+$','error','8766078FnlGbH','¬∞C.','getForeignObjectAsync','¬∞C).\x20Entferne\x20Status.','analysis.energy.warmupTargets','values','location','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27','\x20wurde\x20manuell\x20erh√∂ht.','filter','¬∞C\x20->\x20','active','.1.LEVEL','indexOf','Enforcement\x20Monitor\x20Error:\x20'];a1_0x43f2=function(){return _0x4d1dc4;};return a1_0x43f2();}a1_0x4bb9e5();'use strict';const aiAgent=require(a1_0x36fbab(0x20c)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x27d33a){const _0x49246d=a1_0x36fbab;if(!_0x27d33a)return'';return _0x27d33a[_0x49246d(0x1c5)]()[_0x49246d(0x1b7)](/\s+/g,'')[_0x49246d(0x1e9)]();}function getWarmupRobust(_0x536480,_0x240a9c){const _0x28b3f4=a1_0x36fbab;if(!_0x536480||!_0x240a9c)return 0x3c;if(_0x536480[_0x240a9c]!==undefined)return _0x536480[_0x240a9c];const _0x329cf8=_0x240a9c['toLowerCase']()[_0x28b3f4(0x1b7)](/√§/g,'ae')[_0x28b3f4(0x1b7)](/√∂/g,'oe')[_0x28b3f4(0x1b7)](/√º/g,'ue')[_0x28b3f4(0x1b7)](/√ü/g,'ss')[_0x28b3f4(0x1b7)](/\s+/g,'_')[_0x28b3f4(0x1b7)](/[^a-z0-9_]/g,'');if(_0x536480[_0x329cf8]!==undefined)return _0x536480[_0x329cf8];return 0x3c;}async function logAutomationAction(_0x431220,_0x535970){const _0x38ea1e=a1_0x36fbab;await _0x431220[_0x38ea1e(0x1a3)](_0x38ea1e(0x248),{'val':_0x535970,'ack':!![]});try{const _0x2ee4f1=_0x38ea1e(0x1fa),_0x12afd2=await _0x431220['getStateAsync'](_0x2ee4f1);let _0x367f47=[];if(_0x12afd2&&_0x12afd2['val'])try{_0x367f47=JSON[_0x38ea1e(0x21c)](_0x12afd2[_0x38ea1e(0x200)]);}catch(_0x16aef4){}_0x367f47[_0x38ea1e(0x1d4)]({'ts':Date['now'](),'msg':_0x535970});if(_0x367f47[_0x38ea1e(0x1bc)]>0x32)_0x367f47=_0x367f47['slice'](0x0,0x32);await _0x431220[_0x38ea1e(0x1a3)](_0x2ee4f1,{'val':JSON[_0x38ea1e(0x269)](_0x367f47),'ack':!![]});}catch(_0xba544){}}async function handlePrediction(_0x3ed6df,_0xef8cf0,_0x314aa2){const _0x19a789=a1_0x36fbab;if(!_0xef8cf0||_0xef8cf0===_0x19a789(0x212))return;let _0x370e31=_0x19a789(0x1d1),_0x48c878=0.6;try{const _0x3740fc=await _0x3ed6df[_0x19a789(0x1d8)]('analysis.automation.mode');if(_0x3740fc&&_0x3740fc['val'])_0x370e31=_0x3740fc['val'];const _0x12fba1=await _0x3ed6df['getStateAsync'](_0x19a789(0x1f4));if(_0x12fba1&&_0x12fba1[_0x19a789(0x200)])_0x48c878=_0x12fba1[_0x19a789(0x200)];}catch(_0x187b94){}if(_0x370e31===_0x19a789(0x1d1)||_0x314aa2<_0x48c878)return;const _0x29ff66=Date[_0x19a789(0x214)]();if(lastActions[_0xef8cf0]&&_0x29ff66-lastActions[_0xef8cf0]<COOLDOWN_MS)return;const _0x1beb76=_0x3ed6df['config'][_0x19a789(0x25b)]||[],_0x476536=normalize(_0xef8cf0),_0x3ece3a=_0x1beb76[_0x19a789(0x1ef)](_0x4fbadf=>normalize(_0x4fbadf['location'])===_0x476536&&(_0x4fbadf['type']===_0x19a789(0x1ba)||_0x4fbadf['type']===_0x19a789(0x1e8)||_0x4fbadf[_0x19a789(0x240)]===_0x19a789(0x1ac)));if(!_0x3ece3a)return;const _0x66a26a=await aiAgent['consultButler'](_0x3ed6df,_0xef8cf0,_0x3ece3a['name'],_0x314aa2);if(!_0x66a26a[_0x19a789(0x1a2)])return;const _0x3d26e8='Pr√§diktion:\x20'+_0xef8cf0+_0x19a789(0x238)+_0x3ece3a[_0x19a789(0x1d5)]+'\x20('+_0x66a26a['reason']+')';await logAutomationAction(_0x3ed6df,'['+_0x370e31[_0x19a789(0x1ea)]()+']\x20'+_0x3d26e8);if(_0x370e31===_0x19a789(0x22f)){const _0x429286=await _0x3ed6df[_0x19a789(0x1d3)](_0x3ece3a['id']);(!_0x429286||!_0x429286[_0x19a789(0x200)]&&_0x429286['val']!==!![])&&await _0x3ed6df['setForeignStateAsync'](_0x3ece3a['id'],!![]),lastActions[_0xef8cf0]=_0x29ff66;}}async function findRelatedId(_0xf801ab,_0x13db88,_0x1e2958='setpoint'){const _0x14e6a0=a1_0x36fbab;if(_0x1e2958===_0x14e6a0(0x1ab)&&_0xf801ab[_0x14e6a0(0x1dc)][_0x14e6a0(0x201)]){let _0x5e0663=_0xf801ab['config']['thermostatMapping'];if(typeof _0x5e0663===_0x14e6a0(0x1b2))try{_0x5e0663=JSON[_0x14e6a0(0x21c)](_0x5e0663);}catch(_0x10359f){}if(_0x5e0663&&_0x5e0663[_0x13db88])return _0x5e0663[_0x13db88];}if(_0x1e2958===_0x14e6a0(0x1fb)&&_0xf801ab[_0x14e6a0(0x1dc)][_0x14e6a0(0x253)]){let _0x36c7ab=_0xf801ab['config'][_0x14e6a0(0x253)];if(typeof _0x36c7ab==='string')try{_0x36c7ab=JSON[_0x14e6a0(0x21c)](_0x36c7ab);}catch(_0x7bb709){}if(_0x36c7ab&&_0x36c7ab[_0x13db88])return _0x36c7ab[_0x13db88];}let _0x3b465a=[];if(_0x1e2958===_0x14e6a0(0x1ab))_0x3b465a=[{'s':_0x14e6a0(0x20b),'t':_0x14e6a0(0x25c)},{'s':_0x14e6a0(0x1af),'t':_0x14e6a0(0x25c)},{'s':_0x14e6a0(0x1af),'t':_0x14e6a0(0x261)},{'s':_0x14e6a0(0x259),'t':_0x14e6a0(0x1ca)},{'s':_0x14e6a0(0x211),'t':_0x14e6a0(0x235)},{'s':_0x14e6a0(0x211),'t':_0x14e6a0(0x24d)},{'s':'temperature','t':_0x14e6a0(0x237)},{'s':_0x14e6a0(0x20a),'t':_0x14e6a0(0x1b0)},{'s':_0x14e6a0(0x244),'t':_0x14e6a0(0x1e7)},{'s':_0x14e6a0(0x23e),'t':'setpoint'}];else _0x1e2958===_0x14e6a0(0x1fb)&&(_0x3b465a=[{'s':_0x14e6a0(0x20b),'t':'.1.LEVEL'},{'s':_0x14e6a0(0x1af),'t':_0x14e6a0(0x230)},{'s':'.1.TEMPERATURE','t':_0x14e6a0(0x213)},{'s':_0x14e6a0(0x211),'t':_0x14e6a0(0x1ec)},{'s':'temperature','t':_0x14e6a0(0x1b1)},{'s':_0x14e6a0(0x23e),'t':_0x14e6a0(0x1d0)}]);for(const _0x2d6cec of _0x3b465a){if(_0x13db88['includes'](_0x2d6cec['s'])){const _0x502e96=_0x13db88[_0x14e6a0(0x1b7)](_0x2d6cec['s'],_0x2d6cec['t']),_0x4e78ff=await _0xf801ab[_0x14e6a0(0x226)](_0x502e96);if(_0x4e78ff)return _0x502e96;}}try{const _0x6068f=_0x13db88[_0x14e6a0(0x1cc)]('.');if(_0x6068f[_0x14e6a0(0x1bc)]>0x2){const _0x2695fe=_0x6068f[_0x14e6a0(0x1a4)](0x0,-0x1)[_0x14e6a0(0x1f1)]('.'),_0xe4d766=await _0xf801ab[_0x14e6a0(0x208)](_0x2695fe+'.*'),_0x5045db=[],_0x292d50=_0x13db88[_0x14e6a0(0x1cc)](/[._]+/)[_0x14e6a0(0x22d)](_0xe6b3ab=>![_0x14e6a0(0x25d),'0','hm-rpc',_0x14e6a0(0x1cd),'wert',_0x14e6a0(0x23e),'actual','sensor','messwert','state'][_0x14e6a0(0x24c)](_0xe6b3ab['toLowerCase']()));for(const [_0xdf27cd,_0x59e863]of Object[_0x14e6a0(0x245)](_0xe4d766)){if(_0xdf27cd===_0x13db88)continue;if(_0x59e863&&_0x59e863['common']){const _0x45816d=_0xdf27cd[_0x14e6a0(0x1c5)](),_0x37966d=(_0x59e863['common']['role']||'')[_0x14e6a0(0x1c5)](),_0x1e87b0=(_0x59e863[_0x14e6a0(0x249)][_0x14e6a0(0x1bf)]||'')[_0x14e6a0(0x1c5)]();let _0x27411b=![];if(_0x1e2958===_0x14e6a0(0x1ab)&&_0x59e863[_0x14e6a0(0x249)][_0x14e6a0(0x1ee)]===!![])_0x27411b=_0x45816d['includes'](_0x14e6a0(0x219))||_0x45816d[_0x14e6a0(0x24c)](_0x14e6a0(0x220))||_0x45816d[_0x14e6a0(0x24c)]('target')||_0x37966d[_0x14e6a0(0x24c)](_0x14e6a0(0x260))||_0x37966d[_0x14e6a0(0x24c)](_0x14e6a0(0x1ed));else _0x1e2958===_0x14e6a0(0x1fb)&&(_0x27411b=_0x45816d[_0x14e6a0(0x24c)]('level')||_0x45816d[_0x14e6a0(0x24c)](_0x14e6a0(0x1fb))||_0x45816d[_0x14e6a0(0x24c)]('stellwert')||_0x45816d[_0x14e6a0(0x24c)](_0x14e6a0(0x1b3))||_0x37966d[_0x14e6a0(0x24c)](_0x14e6a0(0x218))||_0x37966d[_0x14e6a0(0x24c)](_0x14e6a0(0x1aa))||_0x1e87b0[_0x14e6a0(0x24c)]('%'));if(_0x27411b){const _0x630151=_0xdf27cd[_0x14e6a0(0x1cc)](/[._]+/)['map'](_0xd27d6b=>_0xd27d6b[_0x14e6a0(0x1c5)]());let _0x5bb6c4=0x0;_0x292d50[_0x14e6a0(0x243)](_0x5d777e=>{const _0x305342=_0x14e6a0;if(_0x630151[_0x305342(0x24c)](_0x5d777e['toLowerCase']()))_0x5bb6c4++;}),_0x5045db['push']({'id':_0xdf27cd,'score':_0x5bb6c4});}}}if(_0x5045db[_0x14e6a0(0x1bc)]>0x0){_0x5045db[_0x14e6a0(0x1d7)]((_0x5590af,_0x255186)=>_0x255186[_0x14e6a0(0x21a)]-_0x5590af[_0x14e6a0(0x21a)]);if(_0x5045db[0x0]['score']>0x0)return _0x5045db[0x0]['id'];}}}catch(_0x3e177e){}return null;}async function scanThermostats(_0x1330b3){const _0x144dca=a1_0x36fbab,_0x24e545=_0x1330b3[_0x144dca(0x1dc)][_0x144dca(0x25b)]||[],_0xb53592=[],_0x3eddb4=_0x24e545[_0x144dca(0x22d)](_0x196e06=>_0x196e06['id']&&_0x196e06['id'][_0x144dca(0x24c)](_0x144dca(0x23e))||_0x196e06[_0x144dca(0x240)]&&['temperature',_0x144dca(0x268),_0x144dca(0x255)]['includes'](_0x196e06[_0x144dca(0x240)])||_0x196e06[_0x144dca(0x1d5)]&&_0x196e06[_0x144dca(0x1d5)][_0x144dca(0x1c5)]()['includes'](_0x144dca(0x236)));for(const _0xfdc41c of _0x3eddb4){const _0x182295=await findRelatedId(_0x1330b3,_0xfdc41c['id'],_0x144dca(0x1ab)),_0x2329f3=await findRelatedId(_0x1330b3,_0xfdc41c['id'],_0x144dca(0x1fb));let _0x439068=_0x144dca(0x1e4),_0x365887=![],_0x138aef=_0x1330b3['config']['thermostatMapping']||{};if(typeof _0x138aef===_0x144dca(0x1b2))try{_0x138aef=JSON['parse'](_0x138aef);}catch(_0x4b55b6){}let _0x3be58e=_0x1330b3[_0x144dca(0x1dc)][_0x144dca(0x253)]||{};if(typeof _0x3be58e===_0x144dca(0x1b2))try{_0x3be58e=JSON[_0x144dca(0x21c)](_0x3be58e);}catch(_0x19e9be){}if(_0x138aef[_0xfdc41c['id']]&&_0x138aef[_0xfdc41c['id']]===_0x182295||_0x3be58e[_0xfdc41c['id']]&&_0x3be58e[_0xfdc41c['id']]===_0x2329f3)_0x439068=_0x144dca(0x21b),_0x365887=!![];else(_0x182295||_0x2329f3)&&(_0x439068=_0x144dca(0x251));_0xb53592[_0x144dca(0x1a9)]({'room':_0xfdc41c[_0x144dca(0x22a)]||_0x144dca(0x23b),'sensorId':_0xfdc41c['id'],'setpointId':_0x182295||'-','valveId':_0x2329f3||'-','source':_0x439068,'isManual':_0x365887,'status':_0x182295&&_0x2329f3?_0x144dca(0x24e):_0x182295?'OK':_0x144dca(0x246)});}return _0xb53592[_0x144dca(0x1d7)]((_0xcb3c64,_0x1cabdf)=>_0xcb3c64[_0x144dca(0x266)][_0x144dca(0x1b9)](_0x1cabdf[_0x144dca(0x266)]));}async function updateSchedulePreview(_0x1241e0){const _0x16eba5=a1_0x36fbab;if(!_0x1241e0[_0x16eba5(0x1dc)][_0x16eba5(0x24b)]||!_0x1241e0['config'][_0x16eba5(0x21e)])return;let _0x4fcfa2={};try{const _0x473c51=await _0x1241e0['getStateAsync'](_0x16eba5(0x265));if(_0x473c51&&_0x473c51['val'])_0x4fcfa2=JSON['parse'](_0x473c51['val']);}catch(_0x24998c){}const _0x489211=[],_0x41c8e2=Date[_0x16eba5(0x214)](),_0x45798d=0x30*0x3c*0x3c*0x3e8;try{const _0x176653=await _0x1241e0[_0x16eba5(0x1d3)](_0x1241e0[_0x16eba5(0x1dc)][_0x16eba5(0x21e)]+_0x16eba5(0x1d6));if(!_0x176653||!_0x176653[_0x16eba5(0x200)])return;const _0x503d53=JSON[_0x16eba5(0x21c)](_0x176653[_0x16eba5(0x200)]),_0x4922d0=_0x1241e0['config'][_0x16eba5(0x23d)]||[],_0x2911ed=_0x1241e0[_0x16eba5(0x1dc)][_0x16eba5(0x25b)]||[],_0x220275=new Set();_0x2911ed[_0x16eba5(0x243)](_0x364a2e=>{const _0x504130=_0x16eba5;if(_0x364a2e[_0x504130(0x22a)])_0x220275[_0x504130(0x1e6)](_0x364a2e[_0x504130(0x22a)]);});for(const _0x2c18ee of _0x503d53){if(_0x2c18ee['_calName']&&_0x4922d0['length']>0x0&&!_0x4922d0[_0x16eba5(0x24c)](_0x2c18ee[_0x16eba5(0x1c3)]))continue;const _0x35922f=_0x2c18ee[_0x16eba5(0x1b8)]||_0x2c18ee[_0x16eba5(0x1f7)]||_0x2c18ee[_0x16eba5(0x1df)];if(!_0x35922f)continue;const _0x6ac0b4=new Date(_0x35922f),_0x5e4182=_0x6ac0b4[_0x16eba5(0x1f5)]();if(isNaN(_0x5e4182))continue;if(_0x5e4182<_0x41c8e2)continue;if(_0x5e4182>_0x41c8e2+_0x45798d)continue;const _0x1fbc4a=(_0x2c18ee[_0x16eba5(0x20d)]||_0x2c18ee['summary']||'')['toLowerCase']();let _0xb58b6e=![],_0x47e94d=[],_0x4fb8f2=_0x2c18ee[_0x16eba5(0x20d)]||_0x2c18ee[_0x16eba5(0x242)]||_0x16eba5(0x23b);if(_0x1fbc4a['includes'](_0x16eba5(0x239))||_0x1fbc4a[_0x16eba5(0x24c)]('r√ºckkehr')||_0x1fbc4a['includes']('ankunft'))_0xb58b6e=!![],_0x47e94d=Array[_0x16eba5(0x1bb)](_0x220275);else for(const _0x2b56dd of _0x220275){if(_0x1fbc4a[_0x16eba5(0x24c)](_0x2b56dd['toLowerCase']()))_0x47e94d[_0x16eba5(0x1a9)](_0x2b56dd);}_0x47e94d['length']>0x0&&_0x47e94d[_0x16eba5(0x243)](_0x83480f=>{const _0x436179=_0x16eba5;let _0x381933=0x3c;if(_0xb58b6e){let _0x35381f=0x0;Object[_0x436179(0x229)](_0x4fcfa2)[_0x436179(0x243)](_0x4ab398=>{if(_0x4ab398>_0x35381f)_0x35381f=_0x4ab398;}),_0x381933=_0x35381f>0x0?_0x35381f:0x78;}else _0x381933=getWarmupRobust(_0x4fcfa2,_0x83480f);const _0x49aef4=new Date(_0x5e4182-_0x381933*0xea60);_0x489211[_0x436179(0x1a9)]({'eventTime':_0x5e4182,'triggerTime':_0x49aef4[_0x436179(0x1f5)](),'room':_0x83480f,'minutes':_0x381933,'reason':_0x4fb8f2,'isGlobal':_0xb58b6e});});}}catch(_0x31e704){}_0x489211['sort']((_0x30b387,_0x31e1cd)=>_0x30b387[_0x16eba5(0x1fc)]-_0x31e1cd[_0x16eba5(0x1fc)]);const _0x453da0=_0x489211['slice'](0x0,0x5);await _0x1241e0[_0x16eba5(0x1a3)]('analysis.energy.schedulePreview',{'val':JSON['stringify'](_0x453da0),'ack':!![]});}async function monitorEnforcements(_0x2e9f38){const _0x275bfa=a1_0x36fbab;try{const _0x155bcc=_0x275bfa(0x234),_0x200ecc=await _0x2e9f38['getStateAsync'](_0x155bcc);if(!_0x200ecc||!_0x200ecc[_0x275bfa(0x200)])return;let _0x1d5af1=[];try{_0x1d5af1=JSON[_0x275bfa(0x21c)](_0x200ecc[_0x275bfa(0x200)]);}catch(_0x2401e9){return;}if(!Array['isArray'](_0x1d5af1)||_0x1d5af1[_0x275bfa(0x1bc)]===0x0)return;const _0xbf3889=Date[_0x275bfa(0x214)](),_0x4fb3cc=_0x2e9f38[_0x275bfa(0x1dc)][_0x275bfa(0x25b)]||[];let _0x44ee91=![];for(let _0x461e86=_0x1d5af1[_0x275bfa(0x1bc)]-0x1;_0x461e86>=0x0;_0x461e86--){const _0x91f3a=_0x1d5af1[_0x461e86];if(_0xbf3889>=_0x91f3a[_0x275bfa(0x241)]){_0x2e9f38[_0x275bfa(0x207)][_0x275bfa(0x1c0)](_0x275bfa(0x217)+_0x91f3a[_0x275bfa(0x266)]+_0x275bfa(0x205)),_0x1d5af1[_0x275bfa(0x1bd)](_0x461e86,0x1),_0x44ee91=!![];continue;}const _0x30104d=_0x4fb3cc['find'](_0x36dc97=>normalize(_0x36dc97[_0x275bfa(0x22a)])===normalize(_0x91f3a[_0x275bfa(0x266)])&&(_0x36dc97[_0x275bfa(0x240)]===_0x275bfa(0x23e)||_0x36dc97[_0x275bfa(0x240)]===_0x275bfa(0x268)));if(_0x30104d){const _0x515d50=await findRelatedId(_0x2e9f38,_0x30104d['id'],_0x275bfa(0x1ab));if(_0x515d50){const _0x748906=await _0x2e9f38[_0x275bfa(0x1d3)](_0x515d50);_0x748906&&typeof _0x748906[_0x275bfa(0x200)]==='number'&&(_0x748906['val']<0xf&&(_0x2e9f38[_0x275bfa(0x207)][_0x275bfa(0x1a7)](_0x275bfa(0x1f3)+_0x91f3a[_0x275bfa(0x266)]+_0x275bfa(0x1e1)+_0x748906[_0x275bfa(0x200)]+'¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20'+_0x91f3a['target']+_0x275bfa(0x225)),await _0x2e9f38['setForeignStateAsync'](_0x515d50,_0x91f3a[_0x275bfa(0x19f)]),await logAutomationAction(_0x2e9f38,'[FORCE]\x20'+_0x91f3a[_0x275bfa(0x266)]+':\x20'+_0x748906[_0x275bfa(0x200)]+_0x275bfa(0x22e)+_0x91f3a[_0x275bfa(0x19f)]+_0x275bfa(0x1c9))));}}}_0x44ee91&&await _0x2e9f38['setStateAsync'](_0x155bcc,{'val':JSON[_0x275bfa(0x269)](_0x1d5af1),'ack':!![]});}catch(_0x3bf8c8){_0x2e9f38[_0x275bfa(0x207)][_0x275bfa(0x223)](_0x275bfa(0x232)+_0x3bf8c8[_0x275bfa(0x1a6)]);}}async function checkCalendarTriggers(_0x2a9a45){const _0x4e967d=a1_0x36fbab;if(!_0x2a9a45[_0x4e967d(0x1dc)][_0x4e967d(0x24b)]||!_0x2a9a45[_0x4e967d(0x1dc)][_0x4e967d(0x21e)])return;await updateSchedulePreview(_0x2a9a45);let _0x18a289={},_0xdeb52d={};try{const _0x53f089=await _0x2a9a45['getStateAsync'](_0x4e967d(0x265));if(_0x53f089&&_0x53f089[_0x4e967d(0x200)])_0x18a289=JSON[_0x4e967d(0x21c)](_0x53f089['val']);const _0x3ef637=await _0x2a9a45[_0x4e967d(0x1d8)]('analysis.energy.warmupSources');if(_0x3ef637&&_0x3ef637[_0x4e967d(0x200)])_0xdeb52d=JSON[_0x4e967d(0x21c)](_0x3ef637[_0x4e967d(0x200)]);}catch(_0x2afcd6){}let _0xba5353={'default':0x15};try{const _0x3360b2=await _0x2a9a45[_0x4e967d(0x1d8)](_0x4e967d(0x228));if(_0x3360b2&&_0x3360b2[_0x4e967d(0x200)])_0xba5353=JSON[_0x4e967d(0x21c)](_0x3360b2[_0x4e967d(0x200)]);}catch(_0x2812fe){}let _0x425737=[];try{const _0x3cee68=await _0x2a9a45[_0x4e967d(0x1d8)](_0x4e967d(0x234));if(_0x3cee68&&_0x3cee68[_0x4e967d(0x200)])_0x425737=JSON[_0x4e967d(0x21c)](_0x3cee68[_0x4e967d(0x200)]);}catch(_0x57a05c){}try{const _0x2acdd5=await _0x2a9a45[_0x4e967d(0x1d3)](_0x2a9a45[_0x4e967d(0x1dc)][_0x4e967d(0x21e)]+_0x4e967d(0x1d6));if(!_0x2acdd5||!_0x2acdd5[_0x4e967d(0x200)])return;const _0x218f14=JSON[_0x4e967d(0x21c)](_0x2acdd5['val']),_0x3282f8=Date[_0x4e967d(0x214)](),_0x4efc57=_0x2a9a45['config'][_0x4e967d(0x25b)]||[],_0x9ad88a=_0x2a9a45[_0x4e967d(0x1dc)][_0x4e967d(0x23d)]||[];let _0x389cc3=![];for(const _0x31f307 of _0x218f14){if(_0x31f307['_calName']&&_0x9ad88a['length']>0x0&&!_0x9ad88a[_0x4e967d(0x24c)](_0x31f307[_0x4e967d(0x1c3)]))continue;const _0x9ce6df=_0x31f307[_0x4e967d(0x1b8)]||_0x31f307[_0x4e967d(0x1f7)]||_0x31f307[_0x4e967d(0x1df)];if(!_0x9ce6df)continue;const _0x398c01=new Date(_0x9ce6df);if(isNaN(_0x398c01['getTime']()))continue;const _0x21820c=(_0x31f307[_0x4e967d(0x20d)]||_0x31f307[_0x4e967d(0x242)]||'')[_0x4e967d(0x1c5)]();if(_0x21820c[_0x4e967d(0x24c)](_0x4e967d(0x239))||_0x21820c['includes'](_0x4e967d(0x1b6))||_0x21820c[_0x4e967d(0x24c)](_0x4e967d(0x1de))){let _0x95173d=0x0;Object['values'](_0x18a289)[_0x4e967d(0x243)](_0x2d8abd=>{if(_0x2d8abd>_0x95173d)_0x95173d=_0x2d8abd;});if(_0x95173d===0x0)_0x95173d=0x78;const _0x7bb7b=_0x398c01['getTime']()-_0x95173d*0xea60;_0x3282f8>=_0x7bb7b&&_0x3282f8<_0x398c01['getTime']()&&(_0x2a9a45['currentSystemMode']!==_0x4e967d(0x1fd)&&(_0x2a9a45[_0x4e967d(0x207)][_0x4e967d(0x1c0)](_0x4e967d(0x24f)+_0x95173d+_0x4e967d(0x25f)),await _0x2a9a45[_0x4e967d(0x1a3)](_0x4e967d(0x209),{'val':_0x4e967d(0x1fd),'ack':![]})));}for(const _0x4ea8b3 of _0x4efc57){if(_0x4ea8b3[_0x4e967d(0x22a)]){const _0x21a4cf=_0x4ea8b3[_0x4e967d(0x22a)]['toLowerCase'](),_0xdadf0=(_0x4ea8b3[_0x4e967d(0x1d5)]||'')[_0x4e967d(0x1c5)]();let _0x111a29=_0x21820c[_0x4e967d(0x24c)](_0x21a4cf);!_0x111a29&&_0xdadf0[_0x4e967d(0x1bc)]>0x3&&_0x21820c[_0x4e967d(0x24c)](_0xdadf0)&&(_0x111a29=!![]);if(_0x111a29){const _0x399bdb=getWarmupRobust(_0x18a289,_0x4ea8b3[_0x4e967d(0x22a)]),_0x3bd5f6=_0xdeb52d[_0x4ea8b3[_0x4e967d(0x22a)]]||_0x4e967d(0x1c6),_0x372899=_0x398c01[_0x4e967d(0x1f5)]()-_0x399bdb*0xea60;if(_0x3282f8>=_0x372899&&_0x3282f8<_0x398c01['getTime']()){const _0x1fa3b8=lastActions[_0x4e967d(0x203)+_0x4ea8b3[_0x4e967d(0x22a)]];if(_0x1fa3b8&&_0x3282f8-_0x1fa3b8<CAL_COOLDOWN_MS)continue;const _0x321c51=await findRelatedId(_0x2a9a45,_0x4ea8b3['id'],_0x4e967d(0x1ab));if(_0x321c51){let _0x2e8946=_0xba5353[_0x4ea8b3[_0x4e967d(0x22a)]];if(_0x2e8946===undefined)_0x2e8946=_0xba5353[_0x4e967d(0x21f)];if(_0x2e8946===undefined)_0x2e8946=0x15;const _0x2beec2=await _0x2a9a45[_0x4e967d(0x1d3)](_0x321c51);if(_0x2beec2&&typeof _0x2beec2[_0x4e967d(0x200)]===_0x4e967d(0x1ad)&&_0x2beec2[_0x4e967d(0x200)]<_0x2e8946-0.5){_0x2a9a45[_0x4e967d(0x207)][_0x4e967d(0x1c0)](_0x4e967d(0x1a5)+_0x3bd5f6+_0x4e967d(0x257)+_0x4ea8b3[_0x4e967d(0x22a)]+_0x4e967d(0x1db)+_0x21820c+_0x4e967d(0x262)+_0x2e8946+_0x4e967d(0x1f8)+_0x399bdb+_0x4e967d(0x25f)),await _0x2a9a45[_0x4e967d(0x1fe)](_0x321c51,_0x2e8946),await logAutomationAction(_0x2a9a45,_0x4e967d(0x1a8)+_0x4ea8b3['location']+_0x4e967d(0x26a)+_0x2e8946+_0x4e967d(0x221)+_0x3bd5f6+')'),lastActions[_0x4e967d(0x203)+_0x4ea8b3[_0x4e967d(0x22a)]]=_0x3282f8;const _0x41e232=_0x425737[_0x4e967d(0x206)](_0xf71af6=>_0xf71af6[_0x4e967d(0x266)]===_0x4ea8b3[_0x4e967d(0x22a)]);if(_0x41e232!==-0x1)_0x425737[_0x4e967d(0x1bd)](_0x41e232,0x1);_0x425737[_0x4e967d(0x1a9)]({'room':_0x4ea8b3[_0x4e967d(0x22a)],'target':_0x2e8946,'until':_0x398c01[_0x4e967d(0x1f5)]()}),_0x389cc3=!![];}}}}}}}_0x389cc3&&await _0x2a9a45[_0x4e967d(0x1a3)](_0x4e967d(0x234),{'val':JSON[_0x4e967d(0x269)](_0x425737),'ack':!![]});}catch(_0x251e5c){_0x2a9a45['log'][_0x4e967d(0x1a7)]('Calendar\x20Check\x20Error:\x20'+_0x251e5c[_0x4e967d(0x1a6)]);}}async function manageMpcIntervention(_0x37895f,_0x4503f0,_0x26bbef){const _0x10c1fb=a1_0x36fbab;try{const _0x552d84=_0x10c1fb(0x258),_0x4f1c44=await _0x37895f[_0x10c1fb(0x1d8)](_0x552d84);let _0x11ddc9=[];if(_0x4f1c44&&_0x4f1c44[_0x10c1fb(0x200)])try{_0x11ddc9=JSON[_0x10c1fb(0x21c)](_0x4f1c44[_0x10c1fb(0x200)]);}catch(_0x38acf9){}const _0x41c685=_0x11ddc9[_0x10c1fb(0x231)](_0x4503f0);if(_0x26bbef===_0x10c1fb(0x1e6))_0x41c685===-0x1&&(_0x11ddc9[_0x10c1fb(0x1a9)](_0x4503f0),await _0x37895f['setStateAsync'](_0x552d84,{'val':JSON['stringify'](_0x11ddc9),'ack':!![]}));else _0x26bbef===_0x10c1fb(0x23c)&&(_0x41c685!==-0x1&&(_0x11ddc9['splice'](_0x41c685,0x1),await _0x37895f[_0x10c1fb(0x1a3)](_0x552d84,{'val':JSON[_0x10c1fb(0x269)](_0x11ddc9),'ack':!![]})));}catch(_0x3ebafb){}}async function cleanupGhostInterventions(_0x563964){const _0x38f8aa=a1_0x36fbab;try{const _0x40606c=_0x38f8aa(0x258),_0x5aa3d3=await _0x563964['getStateAsync'](_0x40606c);if(!_0x5aa3d3||!_0x5aa3d3[_0x38f8aa(0x200)])return;const _0xd59cb9=JSON[_0x38f8aa(0x21c)](_0x5aa3d3[_0x38f8aa(0x200)]);if(!Array[_0x38f8aa(0x210)](_0xd59cb9)||_0xd59cb9[_0x38f8aa(0x1bc)]===0x0)return;let _0x36849f={'default':0x15};try{const _0x5d097f=await _0x563964[_0x38f8aa(0x1d8)](_0x38f8aa(0x228));if(_0x5d097f&&_0x5d097f[_0x38f8aa(0x200)])_0x36849f=JSON[_0x38f8aa(0x21c)](_0x5d097f[_0x38f8aa(0x200)]);}catch(_0x2a4a15){}let _0x230bb7=[];try{const _0x5868e3=await _0x563964[_0x38f8aa(0x1d8)](_0x38f8aa(0x216));if(_0x5868e3&&_0x5868e3[_0x38f8aa(0x200)])_0x230bb7=JSON[_0x38f8aa(0x21c)](_0x5868e3[_0x38f8aa(0x200)]);}catch(_0x4ffed9){}let _0x3392f3={},_0x48ac95=![];try{const _0x391f45=await _0x563964[_0x38f8aa(0x1d8)]('analysis.energy.rlPenalties');if(_0x391f45&&_0x391f45['val'])_0x3392f3=JSON['parse'](_0x391f45[_0x38f8aa(0x200)]);}catch(_0xa9d5bf){}if(_0x3392f3[_0x38f8aa(0x204)]){const _0x234f88=Date[_0x38f8aa(0x214)]();for(const [_0x355b85,_0x4e512]of Object[_0x38f8aa(0x245)](_0x3392f3[_0x38f8aa(0x204)])){_0x234f88-_0x4e512>PENALTY_TTL&&(delete _0x3392f3[_0x355b85],delete _0x3392f3[_0x38f8aa(0x204)][_0x355b85],_0x48ac95=!![],_0x563964[_0x38f8aa(0x207)]['info'](_0x38f8aa(0x22b)+_0x355b85+_0x38f8aa(0x1e3)));}}const _0x5ab0e1=_0x563964['config'][_0x38f8aa(0x25b)]||[];let _0x4b080c=![];for(let _0x2f4fb6=_0xd59cb9['length']-0x1;_0x2f4fb6>=0x0;_0x2f4fb6--){const _0x56d497=_0xd59cb9[_0x2f4fb6],_0x1a71c6=_0x5ab0e1[_0x38f8aa(0x1ef)](_0xe9ad17=>normalize(_0xe9ad17[_0x38f8aa(0x22a)])===normalize(_0x56d497)&&(_0xe9ad17[_0x38f8aa(0x240)]==='temperature'||_0xe9ad17[_0x38f8aa(0x240)]===_0x38f8aa(0x268)));if(!_0x1a71c6){_0x563964[_0x38f8aa(0x207)][_0x38f8aa(0x1a7)](_0x38f8aa(0x1b4)+_0x56d497+_0x38f8aa(0x1d9)),_0xd59cb9['splice'](_0x2f4fb6,0x1),_0x4b080c=!![];continue;}if(_0x1a71c6){const _0x207cdd=await findRelatedId(_0x563964,_0x1a71c6['id'],_0x38f8aa(0x1ab)),_0x2b0496=await _0x563964[_0x38f8aa(0x1d3)](_0x1a71c6['id']);if(_0x207cdd){const _0x4d5b89=await _0x563964['getForeignStateAsync'](_0x207cdd);if(_0x4d5b89&&typeof _0x4d5b89['val']===_0x38f8aa(0x1ad)){let _0x192791=![],_0x4514fb='';Math[_0x38f8aa(0x263)](_0x4d5b89[_0x38f8aa(0x200)]-ECO_TEMP)>0.5&&(_0x192791=!![],_0x4514fb=_0x38f8aa(0x215));if(!_0x192791&&_0x2b0496&&typeof _0x2b0496['val']===_0x38f8aa(0x1ad)){const _0x181118=_0x36849f[_0x56d497]||_0x36849f[_0x38f8aa(0x21f)]||0x15;_0x2b0496['val']<_0x181118+0.2&&(_0x192791=!![],_0x4514fb='too_cold');}if(_0x192791){if(_0x4514fb===_0x38f8aa(0x215)){_0x563964[_0x38f8aa(0x207)][_0x38f8aa(0x1c0)](_0x38f8aa(0x1eb)+_0x56d497+_0x38f8aa(0x252)+_0x4d5b89[_0x38f8aa(0x200)]+_0x38f8aa(0x267)+ECO_TEMP+_0x38f8aa(0x227));const _0x10072f=lastActions[_0x38f8aa(0x203)+_0x56d497],_0x3096db=_0x10072f&&Date[_0x38f8aa(0x214)]()-_0x10072f<0x2*0x3c*0x3e8;if(!_0x3096db&&_0x4d5b89[_0x38f8aa(0x200)]>ECO_TEMP+0.5){_0x563964[_0x38f8aa(0x1f0)]&&(_0x563964[_0x38f8aa(0x207)][_0x38f8aa(0x1c0)](_0x38f8aa(0x1c2)+_0x56d497+_0x38f8aa(0x22c)),_0x563964[_0x38f8aa(0x1f0)](_0x38f8aa(0x264),{'room':_0x56d497}));const _0x4fdc85=_0x56d497+'_'+new Date()[_0x38f8aa(0x247)]();if(!_0x3392f3[_0x4fdc85]){_0x3392f3[_0x4fdc85]=0x1;if(!_0x3392f3[_0x38f8aa(0x204)])_0x3392f3['_meta']={};_0x3392f3['_meta'][_0x4fdc85]=Date[_0x38f8aa(0x214)](),_0x48ac95=!![];}}else _0x3096db&&_0x563964['log'][_0x38f8aa(0x1c0)](_0x38f8aa(0x1c7)+_0x56d497+_0x38f8aa(0x1ce));}else{if(_0x4514fb===_0x38f8aa(0x25a)){let _0x6aea76=![];if(_0x230bb7[_0x38f8aa(0x1ef)](_0x141657=>_0x141657[_0x38f8aa(0x266)]===_0x56d497))_0x6aea76=!![];const _0x2e0138=_0x5ab0e1[_0x38f8aa(0x22d)](_0x12ad14=>normalize(_0x12ad14[_0x38f8aa(0x22a)])===normalize(_0x56d497)&&(_0x12ad14['type']==='window'||_0x12ad14['type']===_0x38f8aa(0x255)||_0x12ad14[_0x38f8aa(0x240)]==='contact'));for(const _0x3d4a13 of _0x2e0138){try{const _0xd072b1=await _0x563964[_0x38f8aa(0x1d3)](_0x3d4a13['id']);if(_0xd072b1&&(_0xd072b1[_0x38f8aa(0x200)]===!![]||_0xd072b1['val']===0x1||String(_0xd072b1[_0x38f8aa(0x200)])[_0x38f8aa(0x1c5)]()===_0x38f8aa(0x1cf)))_0x6aea76=!![];}catch(_0x170198){}}if(_0x6aea76)_0x563964['log'][_0x38f8aa(0x1c0)]('üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20'+_0x56d497+_0x38f8aa(0x250));else{const _0x4e5670=_0x36849f[_0x56d497]||_0x36849f[_0x38f8aa(0x21f)]||0x15;_0x563964['log'][_0x38f8aa(0x1c0)](_0x38f8aa(0x1e0)+_0x56d497+_0x38f8aa(0x202)+_0x2b0496[_0x38f8aa(0x200)]+_0x38f8aa(0x1d2)+(_0x4e5670+0.2)+'¬∞C).\x20Sparmodus\x20beendet!'),await _0x563964[_0x38f8aa(0x1fe)](_0x207cdd,_0x4e5670),await logAutomationAction(_0x563964,_0x38f8aa(0x1a1)+_0x56d497+_0x38f8aa(0x1dd)+_0x4e5670+'¬∞C'),lastActions[_0x38f8aa(0x1f9)+_0x56d497]=Date['now']();}}}_0xd59cb9[_0x38f8aa(0x1bd)](_0x2f4fb6,0x1),_0x4b080c=!![];}}}}}_0x4b080c&&await _0x563964[_0x38f8aa(0x1a3)](_0x40606c,{'val':JSON[_0x38f8aa(0x269)](_0xd59cb9),'ack':!![]}),_0x48ac95&&await _0x563964[_0x38f8aa(0x1a3)](_0x38f8aa(0x1ae),{'val':JSON[_0x38f8aa(0x269)](_0x3392f3),'ack':!![]});}catch(_0x3f1bdf){}}async function applyEnergySavings(_0x12b4f9,_0xe6ab1c){const _0x252915=a1_0x36fbab;await cleanupGhostInterventions(_0x12b4f9);if(!_0xe6ab1c||_0xe6ab1c[_0x252915(0x1bc)]===0x0)return;const _0xf462fa=_0x12b4f9['config'][_0x252915(0x25b)]||[],_0x991c9f=Date[_0x252915(0x214)]();for(const _0x2db7e1 of _0xe6ab1c){const _0xe977e2=_0x2db7e1['room'],_0x4612d0=_0x2db7e1[_0x252915(0x20e)],_0x78f892=_0x2db7e1[_0x252915(0x19f)]||0x15;if(lastActions[_0x252915(0x1f9)+_0xe977e2]&&_0x991c9f-lastActions[_0x252915(0x1f9)+_0xe977e2]<RESCUE_LOCK_MS)continue;const _0x2f0a49=_0xf462fa[_0x252915(0x1ef)](_0x44df0b=>normalize(_0x44df0b[_0x252915(0x22a)])===normalize(_0xe977e2)&&(_0x44df0b[_0x252915(0x240)]===_0x252915(0x23e)||_0x44df0b[_0x252915(0x240)]==='thermostat'));if(!_0x2f0a49)continue;const _0x17c2bc=await findRelatedId(_0x12b4f9,_0x2f0a49['id'],_0x252915(0x1ab));if(_0x17c2bc){if(lastActions[_0x252915(0x1c4)+_0xe977e2]&&_0x991c9f-lastActions[_0x252915(0x1c4)+_0xe977e2]<0x1e*0x3c*0x3e8)continue;const _0x359f3e=await _0x12b4f9[_0x252915(0x1d3)](_0x17c2bc);if(_0x359f3e&&typeof _0x359f3e[_0x252915(0x200)]===_0x252915(0x1ad)){const _0x40092c=_0x359f3e[_0x252915(0x200)];_0x40092c!==ECO_TEMP&&await manageMpcIntervention(_0x12b4f9,_0xe977e2,'remove');if(_0x4612d0>0x1e)_0x40092c>ECO_TEMP+0.5&&(_0x12b4f9[_0x252915(0x207)][_0x252915(0x1c0)]('üçÉ\x20[MPC\x20ACTION]\x20Senke\x20'+_0xe977e2+_0x252915(0x1e1)+ECO_TEMP+_0x252915(0x1e5)+_0x4612d0+_0x252915(0x1a0)),await _0x12b4f9[_0x252915(0x1fe)](_0x17c2bc,ECO_TEMP),await manageMpcIntervention(_0x12b4f9,_0xe977e2,_0x252915(0x1e6)),lastActions[_0x252915(0x1c4)+_0xe977e2]=_0x991c9f,await logAutomationAction(_0x12b4f9,_0x252915(0x23f)+_0xe977e2+':\x20Absenkung\x20auf\x20'+ECO_TEMP+'¬∞C'));else _0x4612d0<=0xf&&(_0x40092c<_0x78f892&&(_0x12b4f9[_0x252915(0x207)][_0x252915(0x1c0)](_0x252915(0x21d)+_0xe977e2+_0x252915(0x1c8)+_0x78f892+'¬∞C!\x20(Puffer\x20leer).'),await _0x12b4f9['setForeignStateAsync'](_0x17c2bc,_0x78f892),await manageMpcIntervention(_0x12b4f9,_0xe977e2,_0x252915(0x23c)),lastActions[_0x252915(0x1c4)+_0xe977e2]=_0x991c9f,await logAutomationAction(_0x12b4f9,_0x252915(0x23f)+_0xe977e2+':\x20Aufheizen\x20auf\x20'+_0x78f892+'¬∞C')));}}else _0x12b4f9[_0x252915(0x207)][_0x252915(0x1a7)]('[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20'+_0xe977e2+_0x252915(0x24a));}}module[a1_0x36fbab(0x23a)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};