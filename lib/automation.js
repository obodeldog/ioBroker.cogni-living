const a1_0x490c1f=a1_0x503a;(function(_0x2a8602,_0x5e5682){const _0x5530fc=a1_0x503a,_0x436dd9=_0x2a8602();while(!![]){try{const _0x41c320=-parseInt(_0x5530fc(0x157))/0x1*(-parseInt(_0x5530fc(0x112))/0x2)+parseInt(_0x5530fc(0x15b))/0x3+-parseInt(_0x5530fc(0x16e))/0x4+parseInt(_0x5530fc(0x129))/0x5*(-parseInt(_0x5530fc(0x155))/0x6)+-parseInt(_0x5530fc(0x13c))/0x7+parseInt(_0x5530fc(0x11a))/0x8*(parseInt(_0x5530fc(0x11b))/0x9)+parseInt(_0x5530fc(0x15a))/0xa*(parseInt(_0x5530fc(0x174))/0xb);if(_0x41c320===_0x5e5682)break;else _0x436dd9['push'](_0x436dd9['shift']());}catch(_0x538716){_0x436dd9['push'](_0x436dd9['shift']());}}}(a1_0x374b,0xd0c2d));const a1_0x5dd80d=(function(){let _0xaaa3d2=!![];return function(_0x4f0904,_0x13cc7c){const _0x55c3d9=_0xaaa3d2?function(){if(_0x13cc7c){const _0xf3884e=_0x13cc7c['apply'](_0x4f0904,arguments);return _0x13cc7c=null,_0xf3884e;}}:function(){};return _0xaaa3d2=![],_0x55c3d9;};}()),a1_0x55daac=a1_0x5dd80d(this,function(){const _0x1da05e=a1_0x503a;return a1_0x55daac[_0x1da05e(0x118)]()[_0x1da05e(0x10f)]('(((.+)+)+)+$')[_0x1da05e(0x118)]()[_0x1da05e(0x13f)](a1_0x55daac)[_0x1da05e(0x10f)](_0x1da05e(0x172));});a1_0x55daac();'use strict';const aiAgent=require(a1_0x490c1f(0x15c)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x1478e7){const _0x180b9f=a1_0x490c1f;if(!_0x1478e7)return'';return _0x1478e7['toLowerCase']()[_0x180b9f(0x187)](/\s+/g,'')[_0x180b9f(0x173)]();}function getWarmupRobust(_0x268f77,_0x3727e9){const _0x1c8c45=a1_0x490c1f;if(!_0x268f77||!_0x3727e9)return 0x3c;if(_0x268f77[_0x3727e9]!==undefined)return _0x268f77[_0x3727e9];const _0x4bf76b=_0x3727e9[_0x1c8c45(0x1c5)]()[_0x1c8c45(0x187)](/√§/g,'ae')['replace'](/√∂/g,'oe')[_0x1c8c45(0x187)](/√º/g,'ue')[_0x1c8c45(0x187)](/√ü/g,'ss')[_0x1c8c45(0x187)](/\s+/g,'_')[_0x1c8c45(0x187)](/[^a-z0-9_]/g,'');if(_0x268f77[_0x4bf76b]!==undefined)return _0x268f77[_0x4bf76b];return 0x3c;}async function logAutomationAction(_0x4e3177,_0x49148a){const _0xcf83fa=a1_0x490c1f;await _0x4e3177[_0xcf83fa(0x168)](_0xcf83fa(0x135),{'val':_0x49148a,'ack':!![]});try{const _0x5a5651=_0xcf83fa(0x1aa),_0x5abf58=await _0x4e3177['getStateAsync'](_0x5a5651);let _0x375c15=[];if(_0x5abf58&&_0x5abf58[_0xcf83fa(0x127)])try{_0x375c15=JSON[_0xcf83fa(0x11f)](_0x5abf58[_0xcf83fa(0x127)]);}catch(_0x1ad17c){}_0x375c15[_0xcf83fa(0x198)]({'ts':Date['now'](),'msg':_0x49148a});if(_0x375c15['length']>0x32)_0x375c15=_0x375c15['slice'](0x0,0x32);await _0x4e3177[_0xcf83fa(0x168)](_0x5a5651,{'val':JSON[_0xcf83fa(0x109)](_0x375c15),'ack':!![]});}catch(_0x321141){}}function a1_0x374b(){const _0x54facd=['.1.TEMPERATURE','isArray','val','üìÖ\x20SMART\x20SCHEDULE\x20[','5YZIurP','üßπ\x20[MPC\x20CLEANUP]\x20','getHours','getStateAsync','common','thermostatMapping','ist','unit','manual','\x20wieder\x20auf\x20','Unbekannt','devices','analysis.automation.lastAction','ankunft','\x20min)','target','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27','error','\x20ist\x20auf\x20','1967063YtREiO','mpc_','date','constructor','until','reason','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','switch','.1.SET_POINT_TEMPERATURE','\x27\x20(Match:\x20','¬∞C\x20(nicht\x20','config','thermostat.setpoint','¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','Nicht\x20gefunden','filter','minutes_safe','abs','urlaub\x20ende','contact','getForeignObjectsAsync','eventStart','Unknown','8974698ZSFKwc','setForeignStateAsync','183GddxjF','find','map','38732930CpvEHH','234966vhKmNS','./ai_agent','stellwert','\x20->\x20','off','Enforcement\x20Monitor\x20Error:\x20','entries','window','number','[CAL]\x20','Calendar\x20Check\x20Error:\x20','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20','current_heating_setpoint','setStateAsync',':\x20Aufheizen\x20auf\x20','warn','too_cold','string','localeCompare','6436124IJKsRY','from','useCalendar','splice','(((.+)+)+)+$','trim','11VFIbLj','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','valve','\x20gefunden!','join','üö®\x20[MPC\x20WATCHDOG]\x20','consultButler','sort','value.valve','location','analysis.energy.schedulePreview','sendToPythonWrapper','Ist','local_temperature','getForeignObjectAsync','room','¬∞C!\x20(Puffer\x20leer).','üìÖ\x20[MPC\x20INFO]\x20','length','replace','TRAIN_RL_PENALTY','r√ºckkehr','pi_heating_demand','¬∞C).\x20Entferne\x20Status.','calendarSelection','forEach','soll','level.temperature','setpoint','üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','_calName','level','SET_POINT_TEMPERATURE','¬∞C\x20(via\x20','message','analysis.energy.activeEnforcements','unshift','analysis.energy.warmupSources','position','event','getForeignStateAsync','\x20erreicht\x20Limit\x20(','analysis.energy.warmupTargets','ACTUAL_TEMPERATURE','slice','actual','remove','openknx','wert','analysis.energy.ventilationAlerts','\x20wurde\x20manuell\x20erh√∂ht.','\x20min).','\x20auf\x20','ACTUAL','analysis.automation.actionLog','includes','\x20->\x20Schalte\x20','temperature','analysis.energy.rlPenalties',')\x20aktiv.\x20Heize\x20auf\x20','occupied_heating_setpoint','_date','analysis.energy.warmupTimes','role','triggerTime','add','.1.LEVEL','valve_position','hm-rpc','¬∞C\x20(Kalender-Schutz)','analysis.automation.mode','split','üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20','now','¬∞C\x20(Vorlauf:\x20','indexOf','.1.ACTUAL_TEMPERATURE','cal_','sensor','.4.SET_TEMPERATURE','¬∞C\x20->\x20','toLowerCase','set','.data.table','state','rescue_','SET','üî•\x20[MPC\x20ACTION]\x20Heize\x20','findIndex','¬∞C).\x20Sparmodus\x20beendet!','system.mode','Pr√§diktion:\x20','getTime','stringify','calendarInstance','_meta','default','push','open','search','normal','PERFECT','28dJKhEe','values','currentSystemMode','type','toUpperCase','üçÉ\x20[MPC\x20ACTION]\x20Senke\x20','toString','thermostat','72ORdVXp','286731xSnMLz','valveMapping','name','¬∞C.','parse','log','analysis.energy.mpcActiveInterventions','score','summary','info'];a1_0x374b=function(){return _0x54facd;};return a1_0x374b();}async function handlePrediction(_0x10c5d8,_0x4b2f4c,_0x190821){const _0x21d74c=a1_0x490c1f;if(!_0x4b2f4c||_0x4b2f4c===_0x21d74c(0x154))return;let _0x42eb5c='off',_0x1c51d2=0.6;try{const _0x2c5bc7=await _0x10c5d8[_0x21d74c(0x12c)](_0x21d74c(0x1ba));if(_0x2c5bc7&&_0x2c5bc7['val'])_0x42eb5c=_0x2c5bc7[_0x21d74c(0x127)];const _0x5ef2a=await _0x10c5d8[_0x21d74c(0x12c)]('analysis.automation.confidenceThreshold');if(_0x5ef2a&&_0x5ef2a[_0x21d74c(0x127)])_0x1c51d2=_0x5ef2a[_0x21d74c(0x127)];}catch(_0x39d6d8){}if(_0x42eb5c===_0x21d74c(0x15f)||_0x190821<_0x1c51d2)return;const _0xe6d182=Date[_0x21d74c(0x1bd)]();if(lastActions[_0x4b2f4c]&&_0xe6d182-lastActions[_0x4b2f4c]<COOLDOWN_MS)return;const _0x26ba26=_0x10c5d8[_0x21d74c(0x148)][_0x21d74c(0x134)]||[],_0x2e0bbe=normalize(_0x4b2f4c),_0x2ee6f8=_0x26ba26[_0x21d74c(0x158)](_0x30e3e3=>normalize(_0x30e3e3[_0x21d74c(0x17d)])===_0x2e0bbe&&(_0x30e3e3[_0x21d74c(0x115)]==='light'||_0x30e3e3['type']==='dimmer'||_0x30e3e3[_0x21d74c(0x115)]===_0x21d74c(0x144)));if(!_0x2ee6f8)return;const _0xb48e40=await aiAgent[_0x21d74c(0x17a)](_0x10c5d8,_0x4b2f4c,_0x2ee6f8[_0x21d74c(0x11d)],_0x190821);if(!_0xb48e40['approved'])return;const _0x151512=_0x21d74c(0x107)+_0x4b2f4c+_0x21d74c(0x1ac)+_0x2ee6f8[_0x21d74c(0x11d)]+'\x20('+_0xb48e40[_0x21d74c(0x141)]+')';await logAutomationAction(_0x10c5d8,'['+_0x42eb5c[_0x21d74c(0x116)]()+']\x20'+_0x151512);if(_0x42eb5c==='active'){const _0x2d8282=await _0x10c5d8[_0x21d74c(0x19c)](_0x2ee6f8['id']);(!_0x2d8282||!_0x2d8282[_0x21d74c(0x127)]&&_0x2d8282[_0x21d74c(0x127)]!==!![])&&await _0x10c5d8['setForeignStateAsync'](_0x2ee6f8['id'],!![]),lastActions[_0x4b2f4c]=_0xe6d182;}}async function findRelatedId(_0x2dae0e,_0x2ced5c,_0x1c66f7=a1_0x490c1f(0x190)){const _0x46308f=a1_0x490c1f;if(_0x1c66f7===_0x46308f(0x190)&&_0x2dae0e[_0x46308f(0x148)][_0x46308f(0x12e)]){let _0x3eef17=_0x2dae0e[_0x46308f(0x148)]['thermostatMapping'];if(typeof _0x3eef17===_0x46308f(0x16c))try{_0x3eef17=JSON['parse'](_0x3eef17);}catch(_0x56825d){}if(_0x3eef17&&_0x3eef17[_0x2ced5c])return _0x3eef17[_0x2ced5c];}if(_0x1c66f7===_0x46308f(0x176)&&_0x2dae0e[_0x46308f(0x148)]['valveMapping']){let _0x3b5b39=_0x2dae0e[_0x46308f(0x148)][_0x46308f(0x11c)];if(typeof _0x3b5b39===_0x46308f(0x16c))try{_0x3b5b39=JSON['parse'](_0x3b5b39);}catch(_0x18f9a0){}if(_0x3b5b39&&_0x3b5b39[_0x2ced5c])return _0x3b5b39[_0x2ced5c];}let _0x185bab=[];if(_0x1c66f7===_0x46308f(0x190))_0x185bab=[{'s':'.1.ACTUAL_TEMPERATURE','t':_0x46308f(0x145)},{'s':_0x46308f(0x125),'t':_0x46308f(0x145)},{'s':'.1.TEMPERATURE','t':_0x46308f(0x1c3)},{'s':_0x46308f(0x19f),'t':_0x46308f(0x194)},{'s':'local_temperature','t':_0x46308f(0x1b0)},{'s':_0x46308f(0x181),'t':_0x46308f(0x167)},{'s':'temperature','t':'target_temperature'},{'s':_0x46308f(0x1a9),'t':_0x46308f(0x1ca)},{'s':_0x46308f(0x180),'t':'Soll'},{'s':_0x46308f(0x1ad),'t':_0x46308f(0x190)}];else _0x1c66f7==='valve'&&(_0x185bab=[{'s':_0x46308f(0x1c0),'t':'.1.LEVEL'},{'s':_0x46308f(0x125),'t':_0x46308f(0x1b6)},{'s':_0x46308f(0x125),'t':'.4.VALVE_STATE'},{'s':_0x46308f(0x181),'t':_0x46308f(0x18a)},{'s':_0x46308f(0x1ad),'t':_0x46308f(0x1b7)},{'s':_0x46308f(0x1ad),'t':_0x46308f(0x193)}]);for(const _0x58478c of _0x185bab){if(_0x2ced5c[_0x46308f(0x1ab)](_0x58478c['s'])){const _0x5f4955=_0x2ced5c['replace'](_0x58478c['s'],_0x58478c['t']),_0x5bcd44=await _0x2dae0e[_0x46308f(0x182)](_0x5f4955);if(_0x5bcd44)return _0x5f4955;}}try{const _0x1c2d66=_0x2ced5c[_0x46308f(0x1bb)]('.');if(_0x1c2d66[_0x46308f(0x186)]>0x2){const _0x263cdf=_0x1c2d66[_0x46308f(0x1a0)](0x0,-0x1)[_0x46308f(0x178)]('.'),_0x5b07f1=await _0x2dae0e[_0x46308f(0x152)](_0x263cdf+'.*'),_0x4fa413=[],_0xcdde16=_0x2ced5c['split'](/[._]+/)[_0x46308f(0x14d)](_0x40e7b1=>![_0x46308f(0x1a3),'0',_0x46308f(0x1b8),_0x46308f(0x12f),_0x46308f(0x1a4),_0x46308f(0x1ad),_0x46308f(0x1a1),'sensor','messwert',_0x46308f(0x1c8)]['includes'](_0x40e7b1[_0x46308f(0x1c5)]()));for(const [_0x2d3b9d,_0x2d28c2]of Object[_0x46308f(0x161)](_0x5b07f1)){if(_0x2d3b9d===_0x2ced5c)continue;if(_0x2d28c2&&_0x2d28c2[_0x46308f(0x12d)]){const _0x58582d=_0x2d3b9d[_0x46308f(0x1c5)](),_0x47abf9=(_0x2d28c2[_0x46308f(0x12d)][_0x46308f(0x1b3)]||'')[_0x46308f(0x1c5)](),_0x4d84d1=(_0x2d28c2[_0x46308f(0x12d)][_0x46308f(0x130)]||'')[_0x46308f(0x1c5)]();let _0x2d77c5=![];if(_0x1c66f7===_0x46308f(0x190)&&_0x2d28c2[_0x46308f(0x12d)]['write']===!![])_0x2d77c5=_0x58582d[_0x46308f(0x1ab)](_0x46308f(0x1c6))||_0x58582d[_0x46308f(0x1ab)](_0x46308f(0x18e))||_0x58582d[_0x46308f(0x1ab)](_0x46308f(0x138))||_0x47abf9['includes'](_0x46308f(0x18f))||_0x47abf9[_0x46308f(0x1ab)](_0x46308f(0x149));else _0x1c66f7==='valve'&&(_0x2d77c5=_0x58582d[_0x46308f(0x1ab)](_0x46308f(0x193))||_0x58582d[_0x46308f(0x1ab)]('valve')||_0x58582d['includes'](_0x46308f(0x15d))||_0x58582d[_0x46308f(0x1ab)](_0x46308f(0x19a))||_0x47abf9[_0x46308f(0x1ab)]('level.valve')||_0x47abf9[_0x46308f(0x1ab)](_0x46308f(0x17c))||_0x4d84d1[_0x46308f(0x1ab)]('%'));if(_0x2d77c5){const _0x2b76cc=_0x2d3b9d['split'](/[._]+/)[_0x46308f(0x159)](_0xe6bfad=>_0xe6bfad['toLowerCase']());let _0x4f4ec1=0x0;_0xcdde16[_0x46308f(0x18d)](_0x15fa97=>{const _0x4fcf11=_0x46308f;if(_0x2b76cc[_0x4fcf11(0x1ab)](_0x15fa97['toLowerCase']()))_0x4f4ec1++;}),_0x4fa413[_0x46308f(0x10d)]({'id':_0x2d3b9d,'score':_0x4f4ec1});}}}if(_0x4fa413[_0x46308f(0x186)]>0x0){_0x4fa413[_0x46308f(0x17b)]((_0x47af19,_0x9ba684)=>_0x9ba684[_0x46308f(0x122)]-_0x47af19[_0x46308f(0x122)]);if(_0x4fa413[0x0][_0x46308f(0x122)]>0x0)return _0x4fa413[0x0]['id'];}}}catch(_0xed1736){}return null;}async function scanThermostats(_0x47ddc9){const _0x42fd9f=a1_0x490c1f,_0x4ebf6b=_0x47ddc9[_0x42fd9f(0x148)][_0x42fd9f(0x134)]||[],_0x5a1747=[],_0x2c7816=_0x4ebf6b['filter'](_0x5f2f2d=>_0x5f2f2d['id']&&_0x5f2f2d['id']['includes'](_0x42fd9f(0x1ad))||_0x5f2f2d[_0x42fd9f(0x115)]&&[_0x42fd9f(0x1ad),_0x42fd9f(0x119),_0x42fd9f(0x1c2)][_0x42fd9f(0x1ab)](_0x5f2f2d['type'])||_0x5f2f2d['name']&&_0x5f2f2d[_0x42fd9f(0x11d)]['toLowerCase']()[_0x42fd9f(0x1ab)]('temp'));for(const _0x1f06ca of _0x2c7816){const _0x4cb15a=await findRelatedId(_0x47ddc9,_0x1f06ca['id'],_0x42fd9f(0x190)),_0x168868=await findRelatedId(_0x47ddc9,_0x1f06ca['id'],_0x42fd9f(0x176));let _0x37a812=_0x42fd9f(0x14c),_0x3bd06e=![],_0x1d96d5=_0x47ddc9[_0x42fd9f(0x148)][_0x42fd9f(0x12e)]||{};if(typeof _0x1d96d5==='string')try{_0x1d96d5=JSON[_0x42fd9f(0x11f)](_0x1d96d5);}catch(_0x4d552a){}let _0x125e71=_0x47ddc9[_0x42fd9f(0x148)][_0x42fd9f(0x11c)]||{};if(typeof _0x125e71===_0x42fd9f(0x16c))try{_0x125e71=JSON[_0x42fd9f(0x11f)](_0x125e71);}catch(_0x68a77d){}if(_0x1d96d5[_0x1f06ca['id']]&&_0x1d96d5[_0x1f06ca['id']]===_0x4cb15a||_0x125e71[_0x1f06ca['id']]&&_0x125e71[_0x1f06ca['id']]===_0x168868)_0x37a812='Manuelles\x20Mapping',_0x3bd06e=!![];else(_0x4cb15a||_0x168868)&&(_0x37a812='Auto-Erkennung');_0x5a1747[_0x42fd9f(0x10d)]({'room':_0x1f06ca[_0x42fd9f(0x17d)]||_0x42fd9f(0x133),'sensorId':_0x1f06ca['id'],'setpointId':_0x4cb15a||'-','valveId':_0x168868||'-','source':_0x37a812,'isManual':_0x3bd06e,'status':_0x4cb15a&&_0x168868?_0x42fd9f(0x111):_0x4cb15a?'OK':'Fehlt'});}return _0x5a1747[_0x42fd9f(0x17b)]((_0x182e51,_0x6f283b)=>_0x182e51['room'][_0x42fd9f(0x16d)](_0x6f283b[_0x42fd9f(0x183)]));}async function updateSchedulePreview(_0x58a964){const _0x1dde0e=a1_0x490c1f;if(!_0x58a964['config'][_0x1dde0e(0x170)]||!_0x58a964[_0x1dde0e(0x148)]['calendarInstance'])return;let _0xdcb54c={};try{const _0x1564ab=await _0x58a964['getStateAsync']('analysis.energy.warmupTimes');if(_0x1564ab&&_0x1564ab['val'])_0xdcb54c=JSON[_0x1dde0e(0x11f)](_0x1564ab['val']);}catch(_0x3351f1){}const _0x35705f=[],_0x46ccca=Date[_0x1dde0e(0x1bd)](),_0x9cf180=0x30*0x3c*0x3c*0x3e8;try{const _0x3c52f4=await _0x58a964[_0x1dde0e(0x19c)](_0x58a964['config'][_0x1dde0e(0x10a)]+_0x1dde0e(0x1c7));if(!_0x3c52f4||!_0x3c52f4['val'])return;const _0x5cb94f=JSON[_0x1dde0e(0x11f)](_0x3c52f4[_0x1dde0e(0x127)]),_0x3b0e8b=_0x58a964[_0x1dde0e(0x148)][_0x1dde0e(0x18c)]||[],_0x186279=_0x58a964[_0x1dde0e(0x148)]['devices']||[],_0x21570f=new Set();_0x186279[_0x1dde0e(0x18d)](_0x525c8a=>{const _0x1f8a38=_0x1dde0e;if(_0x525c8a[_0x1f8a38(0x17d)])_0x21570f[_0x1f8a38(0x1b5)](_0x525c8a[_0x1f8a38(0x17d)]);});for(const _0x10bbb9 of _0x5cb94f){if(_0x10bbb9[_0x1dde0e(0x192)]&&_0x3b0e8b[_0x1dde0e(0x186)]>0x0&&!_0x3b0e8b[_0x1dde0e(0x1ab)](_0x10bbb9[_0x1dde0e(0x192)]))continue;const _0x4e3ba5=_0x10bbb9[_0x1dde0e(0x1b1)]||_0x10bbb9[_0x1dde0e(0x153)]||_0x10bbb9['date'];if(!_0x4e3ba5)continue;const _0x387576=new Date(_0x4e3ba5),_0x3a03db=_0x387576[_0x1dde0e(0x108)]();if(isNaN(_0x3a03db))continue;if(_0x3a03db<_0x46ccca)continue;if(_0x3a03db>_0x46ccca+_0x9cf180)continue;const _0x18b45f=(_0x10bbb9['event']||_0x10bbb9[_0x1dde0e(0x123)]||'')[_0x1dde0e(0x1c5)]();let _0x3a0baf=![],_0xc17732=[],_0x4965ce=_0x10bbb9[_0x1dde0e(0x19b)]||_0x10bbb9[_0x1dde0e(0x123)]||_0x1dde0e(0x133);if(_0x18b45f[_0x1dde0e(0x1ab)]('urlaub\x20ende')||_0x18b45f[_0x1dde0e(0x1ab)](_0x1dde0e(0x189))||_0x18b45f[_0x1dde0e(0x1ab)](_0x1dde0e(0x136)))_0x3a0baf=!![],_0xc17732=Array[_0x1dde0e(0x16f)](_0x21570f);else for(const _0x5c6055 of _0x21570f){if(_0x18b45f[_0x1dde0e(0x1ab)](_0x5c6055[_0x1dde0e(0x1c5)]()))_0xc17732[_0x1dde0e(0x10d)](_0x5c6055);}_0xc17732[_0x1dde0e(0x186)]>0x0&&_0xc17732[_0x1dde0e(0x18d)](_0x28f4e0=>{const _0x1cb9ef=_0x1dde0e;let _0x29abd8=0x3c;if(_0x3a0baf){let _0x2ae691=0x0;Object[_0x1cb9ef(0x113)](_0xdcb54c)[_0x1cb9ef(0x18d)](_0x24814d=>{if(_0x24814d>_0x2ae691)_0x2ae691=_0x24814d;}),_0x29abd8=_0x2ae691>0x0?_0x2ae691:0x78;}else _0x29abd8=getWarmupRobust(_0xdcb54c,_0x28f4e0);const _0x300be6=new Date(_0x3a03db-_0x29abd8*0xea60);_0x35705f['push']({'eventTime':_0x3a03db,'triggerTime':_0x300be6[_0x1cb9ef(0x108)](),'room':_0x28f4e0,'minutes':_0x29abd8,'reason':_0x4965ce,'isGlobal':_0x3a0baf});});}}catch(_0x13236b){}_0x35705f[_0x1dde0e(0x17b)]((_0x568be9,_0x535e0f)=>_0x568be9[_0x1dde0e(0x1b4)]-_0x535e0f[_0x1dde0e(0x1b4)]);const _0x2758af=_0x35705f['slice'](0x0,0x5);await _0x58a964[_0x1dde0e(0x168)](_0x1dde0e(0x17e),{'val':JSON[_0x1dde0e(0x109)](_0x2758af),'ack':!![]});}function a1_0x503a(_0x507dff,_0x150427){const _0x296871=a1_0x374b();return a1_0x503a=function(_0x55daac,_0x5dd80d){_0x55daac=_0x55daac-0x105;let _0x374bf3=_0x296871[_0x55daac];return _0x374bf3;},a1_0x503a(_0x507dff,_0x150427);}async function monitorEnforcements(_0xce3be3){const _0x4896cb=a1_0x490c1f;try{const _0x7c8f2d=_0x4896cb(0x197),_0x1db7e8=await _0xce3be3[_0x4896cb(0x12c)](_0x7c8f2d);if(!_0x1db7e8||!_0x1db7e8[_0x4896cb(0x127)])return;let _0x5e63cd=[];try{_0x5e63cd=JSON[_0x4896cb(0x11f)](_0x1db7e8[_0x4896cb(0x127)]);}catch(_0x4c51c8){return;}if(!Array[_0x4896cb(0x126)](_0x5e63cd)||_0x5e63cd[_0x4896cb(0x186)]===0x0)return;const _0x497258=Date[_0x4896cb(0x1bd)](),_0x384286=_0xce3be3[_0x4896cb(0x148)]['devices']||[];let _0xe684fd=![];for(let _0x54b941=_0x5e63cd[_0x4896cb(0x186)]-0x1;_0x54b941>=0x0;_0x54b941--){const _0x50ac77=_0x5e63cd[_0x54b941];if(_0x497258>=_0x50ac77[_0x4896cb(0x140)]){_0xce3be3[_0x4896cb(0x120)]['info']('üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20'+_0x50ac77[_0x4896cb(0x183)]+'\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.'),_0x5e63cd['splice'](_0x54b941,0x1),_0xe684fd=!![];continue;}const _0x218bdd=_0x384286[_0x4896cb(0x158)](_0x127ea8=>normalize(_0x127ea8[_0x4896cb(0x17d)])===normalize(_0x50ac77['room'])&&(_0x127ea8['type']===_0x4896cb(0x1ad)||_0x127ea8['type']===_0x4896cb(0x119)));if(_0x218bdd){const _0x59f2f4=await findRelatedId(_0xce3be3,_0x218bdd['id'],_0x4896cb(0x190));if(_0x59f2f4){const _0x1971ad=await _0xce3be3[_0x4896cb(0x19c)](_0x59f2f4);_0x1971ad&&typeof _0x1971ad[_0x4896cb(0x127)]==='number'&&(_0x1971ad['val']<0xf&&(_0xce3be3[_0x4896cb(0x120)]['warn']('üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20'+_0x50ac77[_0x4896cb(0x183)]+_0x4896cb(0x1a8)+_0x1971ad['val']+_0x4896cb(0x14a)+_0x50ac77[_0x4896cb(0x138)]+_0x4896cb(0x11e)),await _0xce3be3[_0x4896cb(0x156)](_0x59f2f4,_0x50ac77[_0x4896cb(0x138)]),await logAutomationAction(_0xce3be3,'[FORCE]\x20'+_0x50ac77[_0x4896cb(0x183)]+':\x20'+_0x1971ad['val']+_0x4896cb(0x1c4)+_0x50ac77[_0x4896cb(0x138)]+_0x4896cb(0x1b9))));}}}_0xe684fd&&await _0xce3be3[_0x4896cb(0x168)](_0x7c8f2d,{'val':JSON['stringify'](_0x5e63cd),'ack':!![]});}catch(_0x4f7aa8){_0xce3be3[_0x4896cb(0x120)][_0x4896cb(0x13a)](_0x4896cb(0x160)+_0x4f7aa8[_0x4896cb(0x196)]);}}async function checkCalendarTriggers(_0x5699af){const _0xdcac3c=a1_0x490c1f;if(!_0x5699af[_0xdcac3c(0x148)]['useCalendar']||!_0x5699af['config'][_0xdcac3c(0x10a)])return;await updateSchedulePreview(_0x5699af);let _0x143d64={},_0x1fecb1={};try{const _0x53fb31=await _0x5699af[_0xdcac3c(0x12c)](_0xdcac3c(0x1b2));if(_0x53fb31&&_0x53fb31[_0xdcac3c(0x127)])_0x143d64=JSON[_0xdcac3c(0x11f)](_0x53fb31[_0xdcac3c(0x127)]);const _0x4e5bdc=await _0x5699af[_0xdcac3c(0x12c)](_0xdcac3c(0x199));if(_0x4e5bdc&&_0x4e5bdc[_0xdcac3c(0x127)])_0x1fecb1=JSON[_0xdcac3c(0x11f)](_0x4e5bdc['val']);}catch(_0xd28f3e){}let _0x5d9311={'default':0x15};try{const _0x4efafb=await _0x5699af[_0xdcac3c(0x12c)](_0xdcac3c(0x19e));if(_0x4efafb&&_0x4efafb[_0xdcac3c(0x127)])_0x5d9311=JSON[_0xdcac3c(0x11f)](_0x4efafb[_0xdcac3c(0x127)]);}catch(_0x25a797){}let _0x2d1e8c=[];try{const _0x313717=await _0x5699af[_0xdcac3c(0x12c)](_0xdcac3c(0x197));if(_0x313717&&_0x313717[_0xdcac3c(0x127)])_0x2d1e8c=JSON['parse'](_0x313717[_0xdcac3c(0x127)]);}catch(_0x109b41){}try{const _0x2a5299=await _0x5699af[_0xdcac3c(0x19c)](_0x5699af[_0xdcac3c(0x148)][_0xdcac3c(0x10a)]+_0xdcac3c(0x1c7));if(!_0x2a5299||!_0x2a5299[_0xdcac3c(0x127)])return;const _0x37e787=JSON[_0xdcac3c(0x11f)](_0x2a5299[_0xdcac3c(0x127)]),_0x166257=Date[_0xdcac3c(0x1bd)](),_0x1c6ad0=_0x5699af[_0xdcac3c(0x148)][_0xdcac3c(0x134)]||[],_0x5b316c=_0x5699af['config'][_0xdcac3c(0x18c)]||[];let _0x98e86d=![];for(const _0x124f5f of _0x37e787){if(_0x124f5f[_0xdcac3c(0x192)]&&_0x5b316c[_0xdcac3c(0x186)]>0x0&&!_0x5b316c[_0xdcac3c(0x1ab)](_0x124f5f[_0xdcac3c(0x192)]))continue;const _0x463d03=_0x124f5f[_0xdcac3c(0x1b1)]||_0x124f5f[_0xdcac3c(0x153)]||_0x124f5f[_0xdcac3c(0x13e)];if(!_0x463d03)continue;const _0x5f0188=new Date(_0x463d03);if(isNaN(_0x5f0188[_0xdcac3c(0x108)]()))continue;const _0x32a1e8=(_0x124f5f[_0xdcac3c(0x19b)]||_0x124f5f['summary']||'')[_0xdcac3c(0x1c5)]();if(_0x32a1e8[_0xdcac3c(0x1ab)](_0xdcac3c(0x150))||_0x32a1e8[_0xdcac3c(0x1ab)](_0xdcac3c(0x189))||_0x32a1e8[_0xdcac3c(0x1ab)](_0xdcac3c(0x136))){let _0x306a50=0x0;Object['values'](_0x143d64)[_0xdcac3c(0x18d)](_0x459d06=>{if(_0x459d06>_0x306a50)_0x306a50=_0x459d06;});if(_0x306a50===0x0)_0x306a50=0x78;const _0x1a2cc9=_0x5f0188[_0xdcac3c(0x108)]()-_0x306a50*0xea60;_0x166257>=_0x1a2cc9&&_0x166257<_0x5f0188[_0xdcac3c(0x108)]()&&(_0x5699af[_0xdcac3c(0x114)]!==_0xdcac3c(0x110)&&(_0x5699af[_0xdcac3c(0x120)][_0xdcac3c(0x124)](_0xdcac3c(0x175)+_0x306a50+_0xdcac3c(0x1a7)),await _0x5699af[_0xdcac3c(0x168)](_0xdcac3c(0x106),{'val':_0xdcac3c(0x110),'ack':![]})));}for(const _0x4a92ea of _0x1c6ad0){if(_0x4a92ea[_0xdcac3c(0x17d)]){const _0x460364=_0x4a92ea[_0xdcac3c(0x17d)][_0xdcac3c(0x1c5)](),_0x327e58=(_0x4a92ea[_0xdcac3c(0x11d)]||'')['toLowerCase']();let _0x50ca95=_0x32a1e8[_0xdcac3c(0x1ab)](_0x460364);!_0x50ca95&&_0x327e58[_0xdcac3c(0x186)]>0x3&&_0x32a1e8[_0xdcac3c(0x1ab)](_0x327e58)&&(_0x50ca95=!![]);if(_0x50ca95){const _0x12f701=getWarmupRobust(_0x143d64,_0x4a92ea['location']),_0x2fd5e9=_0x1fecb1[_0x4a92ea[_0xdcac3c(0x17d)]]||'Classic',_0x1f0575=_0x5f0188[_0xdcac3c(0x108)]()-_0x12f701*0xea60;if(_0x166257>=_0x1f0575&&_0x166257<_0x5f0188[_0xdcac3c(0x108)]()){const _0x18c44d=lastActions[_0xdcac3c(0x1c1)+_0x4a92ea['location']];if(_0x18c44d&&_0x166257-_0x18c44d<CAL_COOLDOWN_MS)continue;const _0x18a5a4=await findRelatedId(_0x5699af,_0x4a92ea['id'],'setpoint');if(_0x18a5a4){let _0x253c49=_0x5d9311[_0x4a92ea[_0xdcac3c(0x17d)]];if(_0x253c49===undefined)_0x253c49=_0x5d9311[_0xdcac3c(0x10c)];if(_0x253c49===undefined)_0x253c49=0x15;const _0x37c60f=await _0x5699af[_0xdcac3c(0x19c)](_0x18a5a4);if(_0x37c60f&&typeof _0x37c60f[_0xdcac3c(0x127)]===_0xdcac3c(0x163)&&_0x37c60f[_0xdcac3c(0x127)]<_0x253c49-0.5){_0x5699af[_0xdcac3c(0x120)][_0xdcac3c(0x124)](_0xdcac3c(0x128)+_0x2fd5e9+']:\x20Raum-Trigger\x20\x27'+_0x4a92ea[_0xdcac3c(0x17d)]+_0xdcac3c(0x146)+_0x32a1e8+_0xdcac3c(0x1af)+_0x253c49+_0xdcac3c(0x1be)+_0x12f701+_0xdcac3c(0x1a7)),await _0x5699af[_0xdcac3c(0x156)](_0x18a5a4,_0x253c49),await logAutomationAction(_0x5699af,_0xdcac3c(0x164)+_0x4a92ea[_0xdcac3c(0x17d)]+_0xdcac3c(0x15e)+_0x253c49+_0xdcac3c(0x195)+_0x2fd5e9+')'),lastActions[_0xdcac3c(0x1c1)+_0x4a92ea[_0xdcac3c(0x17d)]]=_0x166257;const _0x5a58e4=_0x2d1e8c[_0xdcac3c(0x1cc)](_0x1cd393=>_0x1cd393[_0xdcac3c(0x183)]===_0x4a92ea[_0xdcac3c(0x17d)]);if(_0x5a58e4!==-0x1)_0x2d1e8c['splice'](_0x5a58e4,0x1);_0x2d1e8c[_0xdcac3c(0x10d)]({'room':_0x4a92ea['location'],'target':_0x253c49,'until':_0x5f0188['getTime']()}),_0x98e86d=!![];}}}}}}}_0x98e86d&&await _0x5699af[_0xdcac3c(0x168)](_0xdcac3c(0x197),{'val':JSON[_0xdcac3c(0x109)](_0x2d1e8c),'ack':!![]});}catch(_0x4d142b){_0x5699af[_0xdcac3c(0x120)][_0xdcac3c(0x16a)](_0xdcac3c(0x165)+_0x4d142b['message']);}}async function manageMpcIntervention(_0x3e4959,_0x22cdaa,_0x4f0e2b){const _0x424be8=a1_0x490c1f;try{const _0x4acfad='analysis.energy.mpcActiveInterventions',_0xfe2b95=await _0x3e4959[_0x424be8(0x12c)](_0x4acfad);let _0x2f4c47=[];if(_0xfe2b95&&_0xfe2b95['val'])try{_0x2f4c47=JSON[_0x424be8(0x11f)](_0xfe2b95[_0x424be8(0x127)]);}catch(_0x27e7de){}const _0x542654=_0x2f4c47[_0x424be8(0x1bf)](_0x22cdaa);if(_0x4f0e2b===_0x424be8(0x1b5))_0x542654===-0x1&&(_0x2f4c47[_0x424be8(0x10d)](_0x22cdaa),await _0x3e4959['setStateAsync'](_0x4acfad,{'val':JSON['stringify'](_0x2f4c47),'ack':!![]}));else _0x4f0e2b==='remove'&&(_0x542654!==-0x1&&(_0x2f4c47[_0x424be8(0x171)](_0x542654,0x1),await _0x3e4959['setStateAsync'](_0x4acfad,{'val':JSON[_0x424be8(0x109)](_0x2f4c47),'ack':!![]})));}catch(_0x388a9e){}}async function cleanupGhostInterventions(_0xc91580){const _0x357dd5=a1_0x490c1f;try{const _0xc0fca=_0x357dd5(0x121),_0x1aa7c0=await _0xc91580[_0x357dd5(0x12c)](_0xc0fca);if(!_0x1aa7c0||!_0x1aa7c0[_0x357dd5(0x127)])return;const _0x484aa8=JSON[_0x357dd5(0x11f)](_0x1aa7c0[_0x357dd5(0x127)]);if(!Array[_0x357dd5(0x126)](_0x484aa8)||_0x484aa8[_0x357dd5(0x186)]===0x0)return;let _0x2849f0={'default':0x15};try{const _0x68f0d0=await _0xc91580[_0x357dd5(0x12c)]('analysis.energy.warmupTargets');if(_0x68f0d0&&_0x68f0d0[_0x357dd5(0x127)])_0x2849f0=JSON[_0x357dd5(0x11f)](_0x68f0d0['val']);}catch(_0x528552){}let _0x1d4a38=[];try{const _0x2e1e1f=await _0xc91580['getStateAsync'](_0x357dd5(0x1a5));if(_0x2e1e1f&&_0x2e1e1f['val'])_0x1d4a38=JSON[_0x357dd5(0x11f)](_0x2e1e1f['val']);}catch(_0x4dd8c1){}let _0x40bd7d={},_0x4f360d=![];try{const _0x3c01c6=await _0xc91580[_0x357dd5(0x12c)](_0x357dd5(0x1ae));if(_0x3c01c6&&_0x3c01c6['val'])_0x40bd7d=JSON['parse'](_0x3c01c6[_0x357dd5(0x127)]);}catch(_0x3d5d13){}if(_0x40bd7d[_0x357dd5(0x10b)]){const _0x227a2f=Date[_0x357dd5(0x1bd)]();for(const [_0x415c8d,_0x3dfabf]of Object['entries'](_0x40bd7d[_0x357dd5(0x10b)])){_0x227a2f-_0x3dfabf>PENALTY_TTL&&(delete _0x40bd7d[_0x415c8d],delete _0x40bd7d[_0x357dd5(0x10b)][_0x415c8d],_0x4f360d=!![],_0xc91580['log'][_0x357dd5(0x124)](_0x357dd5(0x139)+_0x415c8d+'\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.'));}}const _0xf615b7=_0xc91580[_0x357dd5(0x148)][_0x357dd5(0x134)]||[];let _0x1df311=![];for(let _0x1ae279=_0x484aa8[_0x357dd5(0x186)]-0x1;_0x1ae279>=0x0;_0x1ae279--){const _0x35fcb=_0x484aa8[_0x1ae279],_0x5a5b7d=_0xf615b7['find'](_0x5f289c=>normalize(_0x5f289c[_0x357dd5(0x17d)])===normalize(_0x35fcb)&&(_0x5f289c['type']===_0x357dd5(0x1ad)||_0x5f289c[_0x357dd5(0x115)]===_0x357dd5(0x119)));if(!_0x5a5b7d){_0xc91580[_0x357dd5(0x120)][_0x357dd5(0x16a)](_0x357dd5(0x191)+_0x35fcb+_0x357dd5(0x143)),_0x484aa8[_0x357dd5(0x171)](_0x1ae279,0x1),_0x1df311=!![];continue;}if(_0x5a5b7d){const _0xd2f049=await findRelatedId(_0xc91580,_0x5a5b7d['id'],_0x357dd5(0x190)),_0x2cbe42=await _0xc91580['getForeignStateAsync'](_0x5a5b7d['id']);if(_0xd2f049){const _0x3199f7=await _0xc91580[_0x357dd5(0x19c)](_0xd2f049);if(_0x3199f7&&typeof _0x3199f7[_0x357dd5(0x127)]===_0x357dd5(0x163)){let _0x3a09f7=![],_0x1b8c57='';Math[_0x357dd5(0x14f)](_0x3199f7[_0x357dd5(0x127)]-ECO_TEMP)>0.5&&(_0x3a09f7=!![],_0x1b8c57=_0x357dd5(0x131));if(!_0x3a09f7&&_0x2cbe42&&typeof _0x2cbe42[_0x357dd5(0x127)]===_0x357dd5(0x163)){const _0x3539b1=_0x2849f0[_0x35fcb]||_0x2849f0[_0x357dd5(0x10c)]||0x15;_0x2cbe42[_0x357dd5(0x127)]<_0x3539b1+0.2&&(_0x3a09f7=!![],_0x1b8c57='too_cold');}if(_0x3a09f7){if(_0x1b8c57===_0x357dd5(0x131)){_0xc91580[_0x357dd5(0x120)][_0x357dd5(0x124)](_0x357dd5(0x12a)+_0x35fcb+_0x357dd5(0x13b)+_0x3199f7[_0x357dd5(0x127)]+_0x357dd5(0x147)+ECO_TEMP+_0x357dd5(0x18b));const _0x3c3326=lastActions[_0x357dd5(0x1c1)+_0x35fcb],_0x55c693=_0x3c3326&&Date[_0x357dd5(0x1bd)]()-_0x3c3326<0x2*0x3c*0x3e8;if(!_0x55c693&&_0x3199f7['val']>ECO_TEMP+0.5){_0xc91580['sendToPythonWrapper']&&(_0xc91580['log']['info']('üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20'+_0x35fcb+_0x357dd5(0x1a6)),_0xc91580[_0x357dd5(0x17f)](_0x357dd5(0x188),{'room':_0x35fcb}));const _0xdf28e7=_0x35fcb+'_'+new Date()[_0x357dd5(0x12b)]();if(!_0x40bd7d[_0xdf28e7]){_0x40bd7d[_0xdf28e7]=0x1;if(!_0x40bd7d[_0x357dd5(0x10b)])_0x40bd7d['_meta']={};_0x40bd7d['_meta'][_0xdf28e7]=Date[_0x357dd5(0x1bd)](),_0x4f360d=!![];}}else _0x55c693&&_0xc91580[_0x357dd5(0x120)]['info'](_0x357dd5(0x185)+_0x35fcb+'\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.');}else{if(_0x1b8c57===_0x357dd5(0x16b)){let _0x2d4b3d=![];if(_0x1d4a38[_0x357dd5(0x158)](_0x345b7f=>_0x345b7f['room']===_0x35fcb))_0x2d4b3d=!![];const _0x420eb1=_0xf615b7[_0x357dd5(0x14d)](_0x28e4f3=>normalize(_0x28e4f3[_0x357dd5(0x17d)])===normalize(_0x35fcb)&&(_0x28e4f3[_0x357dd5(0x115)]===_0x357dd5(0x162)||_0x28e4f3[_0x357dd5(0x115)]===_0x357dd5(0x1c2)||_0x28e4f3[_0x357dd5(0x115)]===_0x357dd5(0x151)));for(const _0xcd7c2f of _0x420eb1){try{const _0x3ee626=await _0xc91580[_0x357dd5(0x19c)](_0xcd7c2f['id']);if(_0x3ee626&&(_0x3ee626[_0x357dd5(0x127)]===!![]||_0x3ee626[_0x357dd5(0x127)]===0x1||String(_0x3ee626['val'])[_0x357dd5(0x1c5)]()===_0x357dd5(0x10e)))_0x2d4b3d=!![];}catch(_0x2eee7b){}}if(_0x2d4b3d)_0xc91580[_0x357dd5(0x120)]['info'](_0x357dd5(0x1bc)+_0x35fcb+_0x357dd5(0x142));else{const _0x175377=_0x2849f0[_0x35fcb]||_0x2849f0[_0x357dd5(0x10c)]||0x15;_0xc91580[_0x357dd5(0x120)][_0x357dd5(0x124)](_0x357dd5(0x179)+_0x35fcb+_0x357dd5(0x19d)+_0x2cbe42[_0x357dd5(0x127)]+'¬∞C\x20<\x20'+(_0x175377+0.2)+_0x357dd5(0x105)),await _0xc91580[_0x357dd5(0x156)](_0xd2f049,_0x175377),await logAutomationAction(_0xc91580,'[WATCHDOG]\x20'+_0x35fcb+_0x357dd5(0x14b)+_0x175377+'¬∞C'),lastActions[_0x357dd5(0x1c9)+_0x35fcb]=Date[_0x357dd5(0x1bd)]();}}}_0x484aa8[_0x357dd5(0x171)](_0x1ae279,0x1),_0x1df311=!![];}}}}}_0x1df311&&await _0xc91580[_0x357dd5(0x168)](_0xc0fca,{'val':JSON[_0x357dd5(0x109)](_0x484aa8),'ack':!![]}),_0x4f360d&&await _0xc91580['setStateAsync'](_0x357dd5(0x1ae),{'val':JSON[_0x357dd5(0x109)](_0x40bd7d),'ack':!![]});}catch(_0x2c154d){}}async function applyEnergySavings(_0x7d4dd4,_0x3d47b5){const _0x1f7db5=a1_0x490c1f;await cleanupGhostInterventions(_0x7d4dd4);if(!_0x3d47b5||_0x3d47b5['length']===0x0)return;const _0x40a962=_0x7d4dd4[_0x1f7db5(0x148)]['devices']||[],_0x2d74ba=Date[_0x1f7db5(0x1bd)]();for(const _0x2e855c of _0x3d47b5){const _0x1ef16c=_0x2e855c[_0x1f7db5(0x183)],_0x356dd8=_0x2e855c[_0x1f7db5(0x14e)],_0x51b2b8=_0x2e855c[_0x1f7db5(0x138)]||0x15;if(lastActions[_0x1f7db5(0x1c9)+_0x1ef16c]&&_0x2d74ba-lastActions[_0x1f7db5(0x1c9)+_0x1ef16c]<RESCUE_LOCK_MS)continue;const _0xebef6d=_0x40a962[_0x1f7db5(0x158)](_0xe1f58b=>normalize(_0xe1f58b[_0x1f7db5(0x17d)])===normalize(_0x1ef16c)&&(_0xe1f58b[_0x1f7db5(0x115)]==='temperature'||_0xe1f58b['type']==='thermostat'));if(!_0xebef6d)continue;const _0x2d1591=await findRelatedId(_0x7d4dd4,_0xebef6d['id'],_0x1f7db5(0x190));if(_0x2d1591){if(lastActions[_0x1f7db5(0x13d)+_0x1ef16c]&&_0x2d74ba-lastActions[_0x1f7db5(0x13d)+_0x1ef16c]<0x1e*0x3c*0x3e8)continue;const _0x80652a=await _0x7d4dd4['getForeignStateAsync'](_0x2d1591);if(_0x80652a&&typeof _0x80652a[_0x1f7db5(0x127)]===_0x1f7db5(0x163)){const _0x2b0931=_0x80652a[_0x1f7db5(0x127)];_0x2b0931!==ECO_TEMP&&await manageMpcIntervention(_0x7d4dd4,_0x1ef16c,_0x1f7db5(0x1a2));if(_0x356dd8>0x1e)_0x2b0931>ECO_TEMP+0.5&&(_0x7d4dd4['log'][_0x1f7db5(0x124)](_0x1f7db5(0x117)+_0x1ef16c+'\x20auf\x20'+ECO_TEMP+'¬∞C!\x20(Puffer:\x20'+_0x356dd8+_0x1f7db5(0x137)),await _0x7d4dd4['setForeignStateAsync'](_0x2d1591,ECO_TEMP),await manageMpcIntervention(_0x7d4dd4,_0x1ef16c,_0x1f7db5(0x1b5)),lastActions['mpc_'+_0x1ef16c]=_0x2d74ba,await logAutomationAction(_0x7d4dd4,'[MPC]\x20'+_0x1ef16c+':\x20Absenkung\x20auf\x20'+ECO_TEMP+'¬∞C'));else _0x356dd8<=0xf&&(_0x2b0931<_0x51b2b8&&(_0x7d4dd4[_0x1f7db5(0x120)][_0x1f7db5(0x124)](_0x1f7db5(0x1cb)+_0x1ef16c+_0x1f7db5(0x132)+_0x51b2b8+_0x1f7db5(0x184)),await _0x7d4dd4[_0x1f7db5(0x156)](_0x2d1591,_0x51b2b8),await manageMpcIntervention(_0x7d4dd4,_0x1ef16c,'remove'),lastActions['mpc_'+_0x1ef16c]=_0x2d74ba,await logAutomationAction(_0x7d4dd4,'[MPC]\x20'+_0x1ef16c+_0x1f7db5(0x169)+_0x51b2b8+'¬∞C')));}}else _0x7d4dd4[_0x1f7db5(0x120)][_0x1f7db5(0x16a)](_0x1f7db5(0x166)+_0x1ef16c+_0x1f7db5(0x177));}}module['exports']={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};