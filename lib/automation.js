function a1_0x1970(_0x25900e,_0x35e580){const _0x4a80e8=a1_0x3aba();return a1_0x1970=function(_0xc00b7e,_0x3dac21){_0xc00b7e=_0xc00b7e-0x183;let _0x3aba26=_0x4a80e8[_0xc00b7e];return _0x3aba26;},a1_0x1970(_0x25900e,_0x35e580);}const a1_0x3ca4d2=a1_0x1970;function a1_0x3aba(){const _0x32802f=['üö®\x20[MPC\x20WATCHDOG]\x20','value.valve','set','localeCompare','eventStart','733656elTONq','thermostat','temp','8AFfbOt','hm-rpc','getForeignStateAsync','\x20min).','exports','¬∞C).\x20Sparmodus\x20beendet!','message','Ist','(((.+)+)+)+$','abs','üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','summary','üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20','entries','./ai_agent','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','remove','config','rescue_','3803976BtLCKm','warn','\x20wieder\x20auf\x20','toUpperCase','stringify','sort','valve','join','¬∞C\x20(Vorlauf:\x20','findIndex','level','calendarInstance','filter','temperature','_calName','thermostatMapping','level.valve','üçÉ\x20[MPC\x20ACTION]\x20Senke\x20','analysis.energy.warmupSources','r√ºckkehr','isArray','¬∞C\x20<\x20','local_temperature','number','event','location','ACTUAL','¬∞C\x20(via\x20','pi_heating_demand','toString','reason','soll','üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','_meta','üìÖ\x20SMART\x20SCHEDULE\x20[','split','switch','name','openknx','replace','manual','getStateAsync','constructor','Unknown','setStateAsync','indexOf','¬∞C.','thermostat.setpoint','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','approved','\x20->\x20Schalte\x20','splice','push','common','1069415yCPcWQ','valveMapping','analysis.automation.lastAction',':\x20Aufheizen\x20auf\x20','.1.TEMPERATURE','wert','too_cold','trim','minutes_safe','analysis.automation.actionLog','urlaub\x20ende','.4.SET_TEMPERATURE','val','\x20auf\x20','calendarSelection','normal','2848584AjUCuT','date','stellwert','Unbekannt','error','forEach','getTime','target_temperature','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.',']:\x20Raum-Trigger\x20\x27','light','map','cal_','[FORCE]\x20','Calendar\x20Check\x20Error:\x20','setForeignStateAsync','analysis.energy.warmupTargets','\x20->\x20','currentSystemMode','analysis.energy.rlPenalties','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','Nicht\x20gefunden','score','_date','.1.SET_POINT_TEMPERATURE','13390290SlmeLc','state','string','¬∞C).\x20Entferne\x20Status.','unit','search','sendToPythonWrapper','getForeignObjectsAsync','toLowerCase','default','2SBxWRY','¬∞C!\x20(Puffer:\x20','info','devices','ankunft','current_heating_setpoint','add','[MPC]\x20','üìÖ\x20[MPC\x20INFO]\x20','üî•\x20[MPC\x20ACTION]\x20Heize\x20','.4.VALVE_STATE','analysis.energy.activeEnforcements','11rbxcbz','.1.LEVEL','sensor','length','¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20','7EknrwF','¬∞C\x20->\x20','Manuelles\x20Mapping','triggerTime','analysis.energy.warmupTimes','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20','find','analysis.automation.confidenceThreshold','1089756krgkRz','from','includes','write','\x20ist\x20auf\x20','mpc_','room','\x20min)','type','\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.','target','useCalendar','values','parse','off',':\x20Absenkung\x20auf\x20','\x20wurde\x20manuell\x20erh√∂ht.','.1.ACTUAL_TEMPERATURE','analysis.energy.ventilationAlerts','system.mode','¬∞C!\x20(Puffer\x20leer).','open','TRAIN_RL_PENALTY','setpoint','232833IiPQQy','active','slice','now','log','.data.table','ist','dimmer','ACTUAL_TEMPERATURE','Pr√§diktion:\x20','getForeignObjectAsync','[WATCHDOG]\x20','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27'];a1_0x3aba=function(){return _0x32802f;};return a1_0x3aba();}(function(_0x5baa99,_0x3725f9){const _0x4fa20c=a1_0x1970,_0x788a3d=_0x5baa99();while(!![]){try{const _0x15d5f4=-parseInt(_0x4fa20c(0x1dc))/0x1+-parseInt(_0x4fa20c(0x1ab))/0x2*(parseInt(_0x4fa20c(0x1c4))/0x3)+parseInt(_0x4fa20c(0x1f1))/0x4*(-parseInt(_0x4fa20c(0x23a))/0x5)+parseInt(_0x4fa20c(0x1ee))/0x6+parseInt(_0x4fa20c(0x1bc))/0x7*(parseInt(_0x4fa20c(0x188))/0x8)+-parseInt(_0x4fa20c(0x204))/0x9+-parseInt(_0x4fa20c(0x1a1))/0xa*(-parseInt(_0x4fa20c(0x1b7))/0xb);if(_0x15d5f4===_0x3725f9)break;else _0x788a3d['push'](_0x788a3d['shift']());}catch(_0x5927bf){_0x788a3d['push'](_0x788a3d['shift']());}}}(a1_0x3aba,0x5a8af));const a1_0x3dac21=(function(){let _0x1c3297=!![];return function(_0x43fb3c,_0x54bc71){const _0x1fcd35=_0x1c3297?function(){if(_0x54bc71){const _0x4b8b58=_0x54bc71['apply'](_0x43fb3c,arguments);return _0x54bc71=null,_0x4b8b58;}}:function(){};return _0x1c3297=![],_0x1fcd35;};}()),a1_0xc00b7e=a1_0x3dac21(this,function(){const _0x3db07e=a1_0x1970;return a1_0xc00b7e[_0x3db07e(0x221)]()[_0x3db07e(0x1a6)](_0x3db07e(0x1f9))[_0x3db07e(0x221)]()[_0x3db07e(0x22e)](a1_0xc00b7e)['search']('(((.+)+)+)+$');});a1_0xc00b7e();'use strict';const aiAgent=require(a1_0x3ca4d2(0x1ff)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x5153ee){const _0x3fa0c3=a1_0x3ca4d2;if(!_0x5153ee)return'';return _0x5153ee[_0x3fa0c3(0x1a9)]()['replace'](/\s+/g,'')[_0x3fa0c3(0x241)]();}function getWarmupRobust(_0x24c4ad,_0x424325){const _0x3afcc4=a1_0x3ca4d2;if(!_0x24c4ad||!_0x424325)return 0x3c;if(_0x24c4ad[_0x424325]!==undefined)return _0x24c4ad[_0x424325];const _0x228602=_0x424325['toLowerCase']()['replace'](/√§/g,'ae')[_0x3afcc4(0x22b)](/√∂/g,'oe')[_0x3afcc4(0x22b)](/√º/g,'ue')[_0x3afcc4(0x22b)](/√ü/g,'ss')[_0x3afcc4(0x22b)](/\s+/g,'_')[_0x3afcc4(0x22b)](/[^a-z0-9_]/g,'');if(_0x24c4ad[_0x228602]!==undefined)return _0x24c4ad[_0x228602];return 0x3c;}async function logAutomationAction(_0x4b9913,_0x437404){const _0x2b04ed=a1_0x3ca4d2;await _0x4b9913[_0x2b04ed(0x230)](_0x2b04ed(0x23c),{'val':_0x437404,'ack':!![]});try{const _0x16a608=_0x2b04ed(0x243),_0x145973=await _0x4b9913[_0x2b04ed(0x22d)](_0x16a608);let _0x30b426=[];if(_0x145973&&_0x145973[_0x2b04ed(0x184)])try{_0x30b426=JSON['parse'](_0x145973[_0x2b04ed(0x184)]);}catch(_0x4013dc){}_0x30b426['unshift']({'ts':Date[_0x2b04ed(0x1df)](),'msg':_0x437404});if(_0x30b426['length']>0x32)_0x30b426=_0x30b426[_0x2b04ed(0x1de)](0x0,0x32);await _0x4b9913[_0x2b04ed(0x230)](_0x16a608,{'val':JSON['stringify'](_0x30b426),'ack':!![]});}catch(_0x29a71f){}}async function handlePrediction(_0xe3bba0,_0x25e2f4,_0x6bc88b){const _0x189f2f=a1_0x3ca4d2;if(!_0x25e2f4||_0x25e2f4===_0x189f2f(0x22f))return;let _0x4e2173=_0x189f2f(0x1d2),_0x1c3c68=0.6;try{const _0x1e30c0=await _0xe3bba0[_0x189f2f(0x22d)]('analysis.automation.mode');if(_0x1e30c0&&_0x1e30c0[_0x189f2f(0x184)])_0x4e2173=_0x1e30c0[_0x189f2f(0x184)];const _0x1c9480=await _0xe3bba0['getStateAsync'](_0x189f2f(0x1c3));if(_0x1c9480&&_0x1c9480[_0x189f2f(0x184)])_0x1c3c68=_0x1c9480['val'];}catch(_0x1cbe47){}if(_0x4e2173==='off'||_0x6bc88b<_0x1c3c68)return;const _0x2b41ef=Date[_0x189f2f(0x1df)]();if(lastActions[_0x25e2f4]&&_0x2b41ef-lastActions[_0x25e2f4]<COOLDOWN_MS)return;const _0x1c8da3=_0xe3bba0['config'][_0x189f2f(0x1ae)]||[],_0x350f1b=normalize(_0x25e2f4),_0x2723a9=_0x1c8da3[_0x189f2f(0x1c2)](_0x180964=>normalize(_0x180964[_0x189f2f(0x21d)])===_0x350f1b&&(_0x180964[_0x189f2f(0x1cc)]===_0x189f2f(0x192)||_0x180964[_0x189f2f(0x1cc)]===_0x189f2f(0x1e3)||_0x180964[_0x189f2f(0x1cc)]===_0x189f2f(0x228)));if(!_0x2723a9)return;const _0x125703=await aiAgent['consultButler'](_0xe3bba0,_0x25e2f4,_0x2723a9[_0x189f2f(0x229)],_0x6bc88b);if(!_0x125703[_0x189f2f(0x235)])return;const _0x35fe60=_0x189f2f(0x1e5)+_0x25e2f4+_0x189f2f(0x236)+_0x2723a9[_0x189f2f(0x229)]+'\x20('+_0x125703[_0x189f2f(0x222)]+')';await logAutomationAction(_0xe3bba0,'['+_0x4e2173[_0x189f2f(0x207)]()+']\x20'+_0x35fe60);if(_0x4e2173===_0x189f2f(0x1dd)){const _0x1e73d5=await _0xe3bba0[_0x189f2f(0x1f3)](_0x2723a9['id']);(!_0x1e73d5||!_0x1e73d5[_0x189f2f(0x184)]&&_0x1e73d5['val']!==!![])&&await _0xe3bba0[_0x189f2f(0x197)](_0x2723a9['id'],!![]),lastActions[_0x25e2f4]=_0x2b41ef;}}async function findRelatedId(_0x34fb47,_0x29bbed,_0x39be65=a1_0x3ca4d2(0x1db)){const _0x49baac=a1_0x3ca4d2;if(_0x39be65===_0x49baac(0x1db)&&_0x34fb47[_0x49baac(0x202)][_0x49baac(0x213)]){let _0x54d94e=_0x34fb47[_0x49baac(0x202)][_0x49baac(0x213)];if(typeof _0x54d94e==='string')try{_0x54d94e=JSON[_0x49baac(0x1d1)](_0x54d94e);}catch(_0x3b4ddc){}if(_0x54d94e&&_0x54d94e[_0x29bbed])return _0x54d94e[_0x29bbed];}if(_0x39be65===_0x49baac(0x20a)&&_0x34fb47[_0x49baac(0x202)]['valveMapping']){let _0x199640=_0x34fb47[_0x49baac(0x202)][_0x49baac(0x23b)];if(typeof _0x199640==='string')try{_0x199640=JSON[_0x49baac(0x1d1)](_0x199640);}catch(_0xf32ece){}if(_0x199640&&_0x199640[_0x29bbed])return _0x199640[_0x29bbed];}let _0x33ecbe=[];if(_0x39be65==='setpoint')_0x33ecbe=[{'s':_0x49baac(0x1d5),'t':_0x49baac(0x1a0)},{'s':_0x49baac(0x23e),'t':'.1.SET_POINT_TEMPERATURE'},{'s':_0x49baac(0x23e),'t':_0x49baac(0x183)},{'s':_0x49baac(0x1e4),'t':'SET_POINT_TEMPERATURE'},{'s':'local_temperature','t':'occupied_heating_setpoint'},{'s':_0x49baac(0x21a),'t':_0x49baac(0x1b0)},{'s':'temperature','t':_0x49baac(0x18f)},{'s':_0x49baac(0x21e),'t':'SET'},{'s':_0x49baac(0x1f8),'t':'Soll'},{'s':_0x49baac(0x211),'t':_0x49baac(0x1db)}];else _0x39be65===_0x49baac(0x20a)&&(_0x33ecbe=[{'s':_0x49baac(0x1d5),'t':_0x49baac(0x1b8)},{'s':'.1.TEMPERATURE','t':_0x49baac(0x1b8)},{'s':'.1.TEMPERATURE','t':_0x49baac(0x1b5)},{'s':_0x49baac(0x21a),'t':_0x49baac(0x220)},{'s':_0x49baac(0x211),'t':'valve_position'},{'s':_0x49baac(0x211),'t':_0x49baac(0x20e)}]);for(const _0x141f5b of _0x33ecbe){if(_0x29bbed[_0x49baac(0x1c6)](_0x141f5b['s'])){const _0x562aa0=_0x29bbed[_0x49baac(0x22b)](_0x141f5b['s'],_0x141f5b['t']),_0x83002d=await _0x34fb47[_0x49baac(0x1e6)](_0x562aa0);if(_0x83002d)return _0x562aa0;}}try{const _0xdada8d=_0x29bbed[_0x49baac(0x227)]('.');if(_0xdada8d[_0x49baac(0x1ba)]>0x2){const _0x5cc04f=_0xdada8d['slice'](0x0,-0x1)[_0x49baac(0x20b)]('.'),_0x54f001=await _0x34fb47[_0x49baac(0x1a8)](_0x5cc04f+'.*'),_0x5b769d=[],_0x22905b=_0x29bbed['split'](/[._]+/)['filter'](_0x42bbb1=>![_0x49baac(0x22a),'0',_0x49baac(0x1f2),_0x49baac(0x1e2),_0x49baac(0x23f),_0x49baac(0x211),'actual',_0x49baac(0x1b9),'messwert',_0x49baac(0x1a2)][_0x49baac(0x1c6)](_0x42bbb1[_0x49baac(0x1a9)]()));for(const [_0x36ba91,_0x107620]of Object[_0x49baac(0x1fe)](_0x54f001)){if(_0x36ba91===_0x29bbed)continue;if(_0x107620&&_0x107620['common']){const _0x108ce0=_0x36ba91['toLowerCase'](),_0x217ee7=(_0x107620[_0x49baac(0x239)]['role']||'')[_0x49baac(0x1a9)](),_0x2a19f7=(_0x107620[_0x49baac(0x239)][_0x49baac(0x1a5)]||'')[_0x49baac(0x1a9)]();let _0x3a7ef3=![];if(_0x39be65===_0x49baac(0x1db)&&_0x107620['common'][_0x49baac(0x1c7)]===!![])_0x3a7ef3=_0x108ce0[_0x49baac(0x1c6)](_0x49baac(0x1eb))||_0x108ce0[_0x49baac(0x1c6)](_0x49baac(0x223))||_0x108ce0[_0x49baac(0x1c6)]('target')||_0x217ee7[_0x49baac(0x1c6)]('level.temperature')||_0x217ee7['includes'](_0x49baac(0x233));else _0x39be65===_0x49baac(0x20a)&&(_0x3a7ef3=_0x108ce0[_0x49baac(0x1c6)](_0x49baac(0x20e))||_0x108ce0[_0x49baac(0x1c6)]('valve')||_0x108ce0[_0x49baac(0x1c6)](_0x49baac(0x18a))||_0x108ce0[_0x49baac(0x1c6)]('position')||_0x217ee7[_0x49baac(0x1c6)](_0x49baac(0x214))||_0x217ee7[_0x49baac(0x1c6)](_0x49baac(0x1ea))||_0x2a19f7['includes']('%'));if(_0x3a7ef3){const _0x52a7e5=_0x36ba91[_0x49baac(0x227)](/[._]+/)[_0x49baac(0x193)](_0x1710b4=>_0x1710b4[_0x49baac(0x1a9)]());let _0x2a1765=0x0;_0x22905b[_0x49baac(0x18d)](_0x5cbff8=>{const _0xe7ee3b=_0x49baac;if(_0x52a7e5[_0xe7ee3b(0x1c6)](_0x5cbff8['toLowerCase']()))_0x2a1765++;}),_0x5b769d[_0x49baac(0x238)]({'id':_0x36ba91,'score':_0x2a1765});}}}if(_0x5b769d[_0x49baac(0x1ba)]>0x0){_0x5b769d['sort']((_0x544ef9,_0x265b01)=>_0x265b01[_0x49baac(0x19e)]-_0x544ef9[_0x49baac(0x19e)]);if(_0x5b769d[0x0][_0x49baac(0x19e)]>0x0)return _0x5b769d[0x0]['id'];}}}catch(_0x1f84e0){}return null;}async function scanThermostats(_0x13efda){const _0x5981aa=a1_0x3ca4d2,_0x208cc5=_0x13efda[_0x5981aa(0x202)][_0x5981aa(0x1ae)]||[],_0xb3af05=[],_0x242c5c=_0x208cc5[_0x5981aa(0x210)](_0x5af023=>_0x5af023['id']&&_0x5af023['id'][_0x5981aa(0x1c6)](_0x5981aa(0x211))||_0x5af023[_0x5981aa(0x1cc)]&&[_0x5981aa(0x211),_0x5981aa(0x1ef),_0x5981aa(0x1b9)][_0x5981aa(0x1c6)](_0x5af023[_0x5981aa(0x1cc)])||_0x5af023[_0x5981aa(0x229)]&&_0x5af023[_0x5981aa(0x229)][_0x5981aa(0x1a9)]()[_0x5981aa(0x1c6)](_0x5981aa(0x1f0)));for(const _0x373e1c of _0x242c5c){const _0x2e016d=await findRelatedId(_0x13efda,_0x373e1c['id'],_0x5981aa(0x1db)),_0x5b82a9=await findRelatedId(_0x13efda,_0x373e1c['id'],_0x5981aa(0x20a));let _0x3b65ed=_0x5981aa(0x19d),_0x2c9253=![],_0x143442=_0x13efda[_0x5981aa(0x202)][_0x5981aa(0x213)]||{};if(typeof _0x143442==='string')try{_0x143442=JSON[_0x5981aa(0x1d1)](_0x143442);}catch(_0x9efd45){}let _0x5b14de=_0x13efda[_0x5981aa(0x202)]['valveMapping']||{};if(typeof _0x5b14de===_0x5981aa(0x1a3))try{_0x5b14de=JSON[_0x5981aa(0x1d1)](_0x5b14de);}catch(_0x3d8078){}if(_0x143442[_0x373e1c['id']]&&_0x143442[_0x373e1c['id']]===_0x2e016d||_0x5b14de[_0x373e1c['id']]&&_0x5b14de[_0x373e1c['id']]===_0x5b82a9)_0x3b65ed=_0x5981aa(0x1be),_0x2c9253=!![];else(_0x2e016d||_0x5b82a9)&&(_0x3b65ed='Auto-Erkennung');_0xb3af05[_0x5981aa(0x238)]({'room':_0x373e1c[_0x5981aa(0x21d)]||_0x5981aa(0x18b),'sensorId':_0x373e1c['id'],'setpointId':_0x2e016d||'-','valveId':_0x5b82a9||'-','source':_0x3b65ed,'isManual':_0x2c9253,'status':_0x2e016d&&_0x5b82a9?'PERFECT':_0x2e016d?'OK':'Fehlt'});}return _0xb3af05[_0x5981aa(0x209)]((_0x220fa9,_0x5f5142)=>_0x220fa9[_0x5981aa(0x1ca)][_0x5981aa(0x1ec)](_0x5f5142[_0x5981aa(0x1ca)]));}async function updateSchedulePreview(_0x24ff22){const _0x1ef31a=a1_0x3ca4d2;if(!_0x24ff22[_0x1ef31a(0x202)][_0x1ef31a(0x1cf)]||!_0x24ff22[_0x1ef31a(0x202)][_0x1ef31a(0x20f)])return;let _0x28ec23={};try{const _0x2040ef=await _0x24ff22[_0x1ef31a(0x22d)](_0x1ef31a(0x1c0));if(_0x2040ef&&_0x2040ef[_0x1ef31a(0x184)])_0x28ec23=JSON[_0x1ef31a(0x1d1)](_0x2040ef[_0x1ef31a(0x184)]);}catch(_0xf0b268){}const _0x5ebe2f=[],_0xb5bf1a=Date['now'](),_0x634378=0x30*0x3c*0x3c*0x3e8;try{const _0x10af92=await _0x24ff22[_0x1ef31a(0x1f3)](_0x24ff22[_0x1ef31a(0x202)][_0x1ef31a(0x20f)]+'.data.table');if(!_0x10af92||!_0x10af92[_0x1ef31a(0x184)])return;const _0x17bdd0=JSON[_0x1ef31a(0x1d1)](_0x10af92[_0x1ef31a(0x184)]),_0xa1cf5d=_0x24ff22[_0x1ef31a(0x202)][_0x1ef31a(0x186)]||[],_0x271fc6=_0x24ff22[_0x1ef31a(0x202)][_0x1ef31a(0x1ae)]||[],_0x53877a=new Set();_0x271fc6[_0x1ef31a(0x18d)](_0x324c5c=>{const _0x5cd2f1=_0x1ef31a;if(_0x324c5c[_0x5cd2f1(0x21d)])_0x53877a['add'](_0x324c5c[_0x5cd2f1(0x21d)]);});for(const _0x5ca2c8 of _0x17bdd0){if(_0x5ca2c8[_0x1ef31a(0x212)]&&_0xa1cf5d[_0x1ef31a(0x1ba)]>0x0&&!_0xa1cf5d[_0x1ef31a(0x1c6)](_0x5ca2c8[_0x1ef31a(0x212)]))continue;const _0x52cd07=_0x5ca2c8[_0x1ef31a(0x19f)]||_0x5ca2c8[_0x1ef31a(0x1ed)]||_0x5ca2c8['date'];if(!_0x52cd07)continue;const _0x8a224b=new Date(_0x52cd07),_0x32066b=_0x8a224b['getTime']();if(isNaN(_0x32066b))continue;if(_0x32066b<_0xb5bf1a)continue;if(_0x32066b>_0xb5bf1a+_0x634378)continue;const _0x1beafc=(_0x5ca2c8[_0x1ef31a(0x21c)]||_0x5ca2c8[_0x1ef31a(0x1fc)]||'')[_0x1ef31a(0x1a9)]();let _0x47e7b8=![],_0x5a9d8a=[],_0x3bc09a=_0x5ca2c8[_0x1ef31a(0x21c)]||_0x5ca2c8['summary']||_0x1ef31a(0x18b);if(_0x1beafc[_0x1ef31a(0x1c6)](_0x1ef31a(0x244))||_0x1beafc['includes'](_0x1ef31a(0x217))||_0x1beafc[_0x1ef31a(0x1c6)]('ankunft'))_0x47e7b8=!![],_0x5a9d8a=Array[_0x1ef31a(0x1c5)](_0x53877a);else for(const _0x20659c of _0x53877a){if(_0x1beafc[_0x1ef31a(0x1c6)](_0x20659c[_0x1ef31a(0x1a9)]()))_0x5a9d8a[_0x1ef31a(0x238)](_0x20659c);}_0x5a9d8a[_0x1ef31a(0x1ba)]>0x0&&_0x5a9d8a[_0x1ef31a(0x18d)](_0x397d62=>{const _0x597498=_0x1ef31a;let _0x20a868=0x3c;if(_0x47e7b8){let _0x29a110=0x0;Object[_0x597498(0x1d0)](_0x28ec23)[_0x597498(0x18d)](_0x1ef474=>{if(_0x1ef474>_0x29a110)_0x29a110=_0x1ef474;}),_0x20a868=_0x29a110>0x0?_0x29a110:0x78;}else _0x20a868=getWarmupRobust(_0x28ec23,_0x397d62);const _0x362fbb=new Date(_0x32066b-_0x20a868*0xea60);_0x5ebe2f['push']({'eventTime':_0x32066b,'triggerTime':_0x362fbb[_0x597498(0x18e)](),'room':_0x397d62,'minutes':_0x20a868,'reason':_0x3bc09a,'isGlobal':_0x47e7b8});});}}catch(_0x1b9c90){}_0x5ebe2f['sort']((_0x52dd9c,_0x2fabef)=>_0x52dd9c[_0x1ef31a(0x1bf)]-_0x2fabef[_0x1ef31a(0x1bf)]);const _0x2247f9=_0x5ebe2f[_0x1ef31a(0x1de)](0x0,0x5);await _0x24ff22['setStateAsync']('analysis.energy.schedulePreview',{'val':JSON['stringify'](_0x2247f9),'ack':!![]});}async function monitorEnforcements(_0x2734b4){const _0x556a47=a1_0x3ca4d2;try{const _0x1d7301=_0x556a47(0x1b6),_0x5999aa=await _0x2734b4[_0x556a47(0x22d)](_0x1d7301);if(!_0x5999aa||!_0x5999aa[_0x556a47(0x184)])return;let _0x382094=[];try{_0x382094=JSON[_0x556a47(0x1d1)](_0x5999aa[_0x556a47(0x184)]);}catch(_0x186ea7){return;}if(!Array[_0x556a47(0x218)](_0x382094)||_0x382094[_0x556a47(0x1ba)]===0x0)return;const _0x5be6cb=Date[_0x556a47(0x1df)](),_0x25ec81=_0x2734b4[_0x556a47(0x202)]['devices']||[];let _0x26cd86=![];for(let _0x15e6f8=_0x382094[_0x556a47(0x1ba)]-0x1;_0x15e6f8>=0x0;_0x15e6f8--){const _0x3a4cfa=_0x382094[_0x15e6f8];if(_0x5be6cb>=_0x3a4cfa['until']){_0x2734b4[_0x556a47(0x1e0)]['info'](_0x556a47(0x1fb)+_0x3a4cfa[_0x556a47(0x1ca)]+'\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.'),_0x382094['splice'](_0x15e6f8,0x1),_0x26cd86=!![];continue;}const _0x4457df=_0x25ec81[_0x556a47(0x1c2)](_0x1a816a=>normalize(_0x1a816a[_0x556a47(0x21d)])===normalize(_0x3a4cfa[_0x556a47(0x1ca)])&&(_0x1a816a[_0x556a47(0x1cc)]===_0x556a47(0x211)||_0x1a816a[_0x556a47(0x1cc)]===_0x556a47(0x1ef)));if(_0x4457df){const _0x5cc8ae=await findRelatedId(_0x2734b4,_0x4457df['id'],_0x556a47(0x1db));if(_0x5cc8ae){const _0x58d1ca=await _0x2734b4[_0x556a47(0x1f3)](_0x5cc8ae);_0x58d1ca&&typeof _0x58d1ca['val']==='number'&&(_0x58d1ca[_0x556a47(0x184)]<0xf&&(_0x2734b4[_0x556a47(0x1e0)][_0x556a47(0x205)]('üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20'+_0x3a4cfa[_0x556a47(0x1ca)]+_0x556a47(0x185)+_0x58d1ca[_0x556a47(0x184)]+_0x556a47(0x1bb)+_0x3a4cfa['target']+_0x556a47(0x232)),await _0x2734b4['setForeignStateAsync'](_0x5cc8ae,_0x3a4cfa[_0x556a47(0x1ce)]),await logAutomationAction(_0x2734b4,_0x556a47(0x195)+_0x3a4cfa[_0x556a47(0x1ca)]+':\x20'+_0x58d1ca[_0x556a47(0x184)]+_0x556a47(0x1bd)+_0x3a4cfa[_0x556a47(0x1ce)]+'¬∞C\x20(Kalender-Schutz)')));}}}_0x26cd86&&await _0x2734b4[_0x556a47(0x230)](_0x1d7301,{'val':JSON[_0x556a47(0x208)](_0x382094),'ack':!![]});}catch(_0x2cde33){_0x2734b4[_0x556a47(0x1e0)][_0x556a47(0x18c)]('Enforcement\x20Monitor\x20Error:\x20'+_0x2cde33[_0x556a47(0x1f7)]);}}async function checkCalendarTriggers(_0x360cb7){const _0x1acac7=a1_0x3ca4d2;if(!_0x360cb7[_0x1acac7(0x202)][_0x1acac7(0x1cf)]||!_0x360cb7[_0x1acac7(0x202)][_0x1acac7(0x20f)])return;await updateSchedulePreview(_0x360cb7);let _0x101d21={},_0x5ae0a5={};try{const _0x338785=await _0x360cb7[_0x1acac7(0x22d)](_0x1acac7(0x1c0));if(_0x338785&&_0x338785['val'])_0x101d21=JSON['parse'](_0x338785[_0x1acac7(0x184)]);const _0x521c60=await _0x360cb7[_0x1acac7(0x22d)](_0x1acac7(0x216));if(_0x521c60&&_0x521c60[_0x1acac7(0x184)])_0x5ae0a5=JSON[_0x1acac7(0x1d1)](_0x521c60[_0x1acac7(0x184)]);}catch(_0xaef4ce){}let _0x553fea={'default':0x15};try{const _0x97cf32=await _0x360cb7[_0x1acac7(0x22d)]('analysis.energy.warmupTargets');if(_0x97cf32&&_0x97cf32[_0x1acac7(0x184)])_0x553fea=JSON[_0x1acac7(0x1d1)](_0x97cf32[_0x1acac7(0x184)]);}catch(_0x3fbe34){}let _0x250e66=[];try{const _0x3906ce=await _0x360cb7['getStateAsync'](_0x1acac7(0x1b6));if(_0x3906ce&&_0x3906ce[_0x1acac7(0x184)])_0x250e66=JSON[_0x1acac7(0x1d1)](_0x3906ce[_0x1acac7(0x184)]);}catch(_0x37c511){}try{const _0x5ea1fd=await _0x360cb7[_0x1acac7(0x1f3)](_0x360cb7[_0x1acac7(0x202)][_0x1acac7(0x20f)]+_0x1acac7(0x1e1));if(!_0x5ea1fd||!_0x5ea1fd[_0x1acac7(0x184)])return;const _0x49a75f=JSON['parse'](_0x5ea1fd[_0x1acac7(0x184)]),_0x2251cd=Date[_0x1acac7(0x1df)](),_0x3a47f2=_0x360cb7[_0x1acac7(0x202)][_0x1acac7(0x1ae)]||[],_0xd751e=_0x360cb7['config'][_0x1acac7(0x186)]||[];let _0x59fc3b=![];for(const _0x5726e3 of _0x49a75f){if(_0x5726e3[_0x1acac7(0x212)]&&_0xd751e[_0x1acac7(0x1ba)]>0x0&&!_0xd751e[_0x1acac7(0x1c6)](_0x5726e3[_0x1acac7(0x212)]))continue;const _0x10121f=_0x5726e3[_0x1acac7(0x19f)]||_0x5726e3[_0x1acac7(0x1ed)]||_0x5726e3[_0x1acac7(0x189)];if(!_0x10121f)continue;const _0x42af67=new Date(_0x10121f);if(isNaN(_0x42af67['getTime']()))continue;const _0x507685=(_0x5726e3[_0x1acac7(0x21c)]||_0x5726e3[_0x1acac7(0x1fc)]||'')[_0x1acac7(0x1a9)]();if(_0x507685[_0x1acac7(0x1c6)](_0x1acac7(0x244))||_0x507685[_0x1acac7(0x1c6)](_0x1acac7(0x217))||_0x507685['includes'](_0x1acac7(0x1af))){let _0x2cabfb=0x0;Object['values'](_0x101d21)['forEach'](_0x4541a8=>{if(_0x4541a8>_0x2cabfb)_0x2cabfb=_0x4541a8;});if(_0x2cabfb===0x0)_0x2cabfb=0x78;const _0x8fda8f=_0x42af67[_0x1acac7(0x18e)]()-_0x2cabfb*0xea60;_0x2251cd>=_0x8fda8f&&_0x2251cd<_0x42af67[_0x1acac7(0x18e)]()&&(_0x360cb7[_0x1acac7(0x19a)]!==_0x1acac7(0x187)&&(_0x360cb7[_0x1acac7(0x1e0)]['info'](_0x1acac7(0x234)+_0x2cabfb+_0x1acac7(0x1f4)),await _0x360cb7[_0x1acac7(0x230)](_0x1acac7(0x1d7),{'val':_0x1acac7(0x187),'ack':![]})));}for(const _0x4bf0be of _0x3a47f2){if(_0x4bf0be[_0x1acac7(0x21d)]){const _0x5a2730=_0x4bf0be[_0x1acac7(0x21d)]['toLowerCase'](),_0x1b03a2=(_0x4bf0be[_0x1acac7(0x229)]||'')[_0x1acac7(0x1a9)]();let _0x45cb85=_0x507685[_0x1acac7(0x1c6)](_0x5a2730);!_0x45cb85&&_0x1b03a2['length']>0x3&&_0x507685[_0x1acac7(0x1c6)](_0x1b03a2)&&(_0x45cb85=!![]);if(_0x45cb85){const _0x5dd4b0=getWarmupRobust(_0x101d21,_0x4bf0be[_0x1acac7(0x21d)]),_0xec0ece=_0x5ae0a5[_0x4bf0be[_0x1acac7(0x21d)]]||'Classic',_0xd39b17=_0x42af67['getTime']()-_0x5dd4b0*0xea60;if(_0x2251cd>=_0xd39b17&&_0x2251cd<_0x42af67[_0x1acac7(0x18e)]()){const _0x233534=lastActions[_0x1acac7(0x194)+_0x4bf0be[_0x1acac7(0x21d)]];if(_0x233534&&_0x2251cd-_0x233534<CAL_COOLDOWN_MS)continue;const _0x3fcd59=await findRelatedId(_0x360cb7,_0x4bf0be['id'],_0x1acac7(0x1db));if(_0x3fcd59){let _0x5e5454=_0x553fea[_0x4bf0be['location']];if(_0x5e5454===undefined)_0x5e5454=_0x553fea['default'];if(_0x5e5454===undefined)_0x5e5454=0x15;const _0x425e61=await _0x360cb7['getForeignStateAsync'](_0x3fcd59);if(_0x425e61&&typeof _0x425e61[_0x1acac7(0x184)]===_0x1acac7(0x21b)&&_0x425e61[_0x1acac7(0x184)]<_0x5e5454-0.5){_0x360cb7[_0x1acac7(0x1e0)][_0x1acac7(0x1ad)](_0x1acac7(0x226)+_0xec0ece+_0x1acac7(0x191)+_0x4bf0be[_0x1acac7(0x21d)]+'\x27\x20(Match:\x20'+_0x507685+')\x20aktiv.\x20Heize\x20auf\x20'+_0x5e5454+_0x1acac7(0x20c)+_0x5dd4b0+_0x1acac7(0x1f4)),await _0x360cb7[_0x1acac7(0x197)](_0x3fcd59,_0x5e5454),await logAutomationAction(_0x360cb7,'[CAL]\x20'+_0x4bf0be[_0x1acac7(0x21d)]+_0x1acac7(0x199)+_0x5e5454+_0x1acac7(0x21f)+_0xec0ece+')'),lastActions[_0x1acac7(0x194)+_0x4bf0be[_0x1acac7(0x21d)]]=_0x2251cd;const _0x15918d=_0x250e66[_0x1acac7(0x20d)](_0x440dea=>_0x440dea[_0x1acac7(0x1ca)]===_0x4bf0be[_0x1acac7(0x21d)]);if(_0x15918d!==-0x1)_0x250e66['splice'](_0x15918d,0x1);_0x250e66[_0x1acac7(0x238)]({'room':_0x4bf0be['location'],'target':_0x5e5454,'until':_0x42af67[_0x1acac7(0x18e)]()}),_0x59fc3b=!![];}}}}}}}_0x59fc3b&&await _0x360cb7[_0x1acac7(0x230)]('analysis.energy.activeEnforcements',{'val':JSON[_0x1acac7(0x208)](_0x250e66),'ack':!![]});}catch(_0x57cbc0){_0x360cb7['log'][_0x1acac7(0x205)](_0x1acac7(0x196)+_0x57cbc0['message']);}}async function manageMpcIntervention(_0x562f66,_0x28058a,_0x1d3cb3){const _0x1940f2=a1_0x3ca4d2;try{const _0x42dfbd='analysis.energy.mpcActiveInterventions',_0x204507=await _0x562f66[_0x1940f2(0x22d)](_0x42dfbd);let _0x5389c6=[];if(_0x204507&&_0x204507[_0x1940f2(0x184)])try{_0x5389c6=JSON[_0x1940f2(0x1d1)](_0x204507[_0x1940f2(0x184)]);}catch(_0x31d0e7){}const _0x2d8507=_0x5389c6[_0x1940f2(0x231)](_0x28058a);if(_0x1d3cb3===_0x1940f2(0x1b1))_0x2d8507===-0x1&&(_0x5389c6[_0x1940f2(0x238)](_0x28058a),await _0x562f66[_0x1940f2(0x230)](_0x42dfbd,{'val':JSON[_0x1940f2(0x208)](_0x5389c6),'ack':!![]}));else _0x1d3cb3===_0x1940f2(0x201)&&(_0x2d8507!==-0x1&&(_0x5389c6[_0x1940f2(0x237)](_0x2d8507,0x1),await _0x562f66[_0x1940f2(0x230)](_0x42dfbd,{'val':JSON[_0x1940f2(0x208)](_0x5389c6),'ack':!![]})));}catch(_0x205c95){}}async function cleanupGhostInterventions(_0x419b0b){const _0x7829bc=a1_0x3ca4d2;try{const _0x5e7da6='analysis.energy.mpcActiveInterventions',_0x47f5a9=await _0x419b0b['getStateAsync'](_0x5e7da6);if(!_0x47f5a9||!_0x47f5a9[_0x7829bc(0x184)])return;const _0x47ea65=JSON['parse'](_0x47f5a9['val']);if(!Array[_0x7829bc(0x218)](_0x47ea65)||_0x47ea65[_0x7829bc(0x1ba)]===0x0)return;let _0x2390e0={'default':0x15};try{const _0x3281a4=await _0x419b0b[_0x7829bc(0x22d)](_0x7829bc(0x198));if(_0x3281a4&&_0x3281a4[_0x7829bc(0x184)])_0x2390e0=JSON[_0x7829bc(0x1d1)](_0x3281a4[_0x7829bc(0x184)]);}catch(_0x11e176){}let _0x52126e=[];try{const _0x55439c=await _0x419b0b[_0x7829bc(0x22d)](_0x7829bc(0x1d6));if(_0x55439c&&_0x55439c[_0x7829bc(0x184)])_0x52126e=JSON['parse'](_0x55439c['val']);}catch(_0x4bd67f){}let _0x4925a1={},_0x4a1986=![];try{const _0x28ca62=await _0x419b0b[_0x7829bc(0x22d)]('analysis.energy.rlPenalties');if(_0x28ca62&&_0x28ca62['val'])_0x4925a1=JSON[_0x7829bc(0x1d1)](_0x28ca62[_0x7829bc(0x184)]);}catch(_0x3d225f){}if(_0x4925a1[_0x7829bc(0x225)]){const _0x494b65=Date['now']();for(const [_0x5e7168,_0x13b6f2]of Object[_0x7829bc(0x1fe)](_0x4925a1[_0x7829bc(0x225)])){_0x494b65-_0x13b6f2>PENALTY_TTL&&(delete _0x4925a1[_0x5e7168],delete _0x4925a1[_0x7829bc(0x225)][_0x5e7168],_0x4a1986=!![],_0x419b0b[_0x7829bc(0x1e0)][_0x7829bc(0x1ad)](_0x7829bc(0x1e8)+_0x5e7168+_0x7829bc(0x200)));}}const _0x3d8afe=_0x419b0b[_0x7829bc(0x202)][_0x7829bc(0x1ae)]||[];let _0x36ecdb=![];for(let _0x364532=_0x47ea65[_0x7829bc(0x1ba)]-0x1;_0x364532>=0x0;_0x364532--){const _0x28cd7c=_0x47ea65[_0x364532],_0x36e86f=_0x3d8afe[_0x7829bc(0x1c2)](_0x4373f0=>normalize(_0x4373f0[_0x7829bc(0x21d)])===normalize(_0x28cd7c)&&(_0x4373f0[_0x7829bc(0x1cc)]===_0x7829bc(0x211)||_0x4373f0[_0x7829bc(0x1cc)]==='thermostat'));if(!_0x36e86f){_0x419b0b['log'][_0x7829bc(0x205)](_0x7829bc(0x224)+_0x28cd7c+_0x7829bc(0x19c)),_0x47ea65[_0x7829bc(0x237)](_0x364532,0x1),_0x36ecdb=!![];continue;}if(_0x36e86f){const _0x772243=await findRelatedId(_0x419b0b,_0x36e86f['id'],'setpoint'),_0x4dcd66=await _0x419b0b['getForeignStateAsync'](_0x36e86f['id']);if(_0x772243){const _0x1c4bde=await _0x419b0b[_0x7829bc(0x1f3)](_0x772243);if(_0x1c4bde&&typeof _0x1c4bde[_0x7829bc(0x184)]===_0x7829bc(0x21b)){let _0x4c5069=![],_0x27858d='';Math[_0x7829bc(0x1fa)](_0x1c4bde[_0x7829bc(0x184)]-ECO_TEMP)>0.5&&(_0x4c5069=!![],_0x27858d=_0x7829bc(0x22c));if(!_0x4c5069&&_0x4dcd66&&typeof _0x4dcd66[_0x7829bc(0x184)]===_0x7829bc(0x21b)){const _0x29b3bd=_0x2390e0[_0x28cd7c]||_0x2390e0[_0x7829bc(0x1aa)]||0x15;_0x4dcd66['val']<_0x29b3bd+0.2&&(_0x4c5069=!![],_0x27858d=_0x7829bc(0x240));}if(_0x4c5069){if(_0x27858d==='manual'){_0x419b0b['log'][_0x7829bc(0x1ad)]('üßπ\x20[MPC\x20CLEANUP]\x20'+_0x28cd7c+_0x7829bc(0x1c8)+_0x1c4bde[_0x7829bc(0x184)]+'¬∞C\x20(nicht\x20'+ECO_TEMP+_0x7829bc(0x1a4));const _0x35fe75=lastActions[_0x7829bc(0x194)+_0x28cd7c],_0xb5ac02=_0x35fe75&&Date[_0x7829bc(0x1df)]()-_0x35fe75<0x2*0x3c*0x3e8;if(!_0xb5ac02&&_0x1c4bde['val']>ECO_TEMP+0.5){_0x419b0b[_0x7829bc(0x1a7)]&&(_0x419b0b[_0x7829bc(0x1e0)][_0x7829bc(0x1ad)]('üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20'+_0x28cd7c+_0x7829bc(0x1d4)),_0x419b0b[_0x7829bc(0x1a7)](_0x7829bc(0x1da),{'room':_0x28cd7c}));const _0x30569e=_0x28cd7c+'_'+new Date()['getHours']();if(!_0x4925a1[_0x30569e]){_0x4925a1[_0x30569e]=0x1;if(!_0x4925a1[_0x7829bc(0x225)])_0x4925a1[_0x7829bc(0x225)]={};_0x4925a1['_meta'][_0x30569e]=Date['now'](),_0x4a1986=!![];}}else _0xb5ac02&&_0x419b0b[_0x7829bc(0x1e0)][_0x7829bc(0x1ad)](_0x7829bc(0x1b3)+_0x28cd7c+_0x7829bc(0x1cd));}else{if(_0x27858d===_0x7829bc(0x240)){let _0x44224c=![];if(_0x52126e[_0x7829bc(0x1c2)](_0x194484=>_0x194484['room']===_0x28cd7c))_0x44224c=!![];const _0x5bfb98=_0x3d8afe[_0x7829bc(0x210)](_0x5439f2=>normalize(_0x5439f2['location'])===normalize(_0x28cd7c)&&(_0x5439f2['type']==='window'||_0x5439f2['type']==='sensor'||_0x5439f2[_0x7829bc(0x1cc)]==='contact'));for(const _0x1a3932 of _0x5bfb98){try{const _0x8cef37=await _0x419b0b[_0x7829bc(0x1f3)](_0x1a3932['id']);if(_0x8cef37&&(_0x8cef37['val']===!![]||_0x8cef37[_0x7829bc(0x184)]===0x1||String(_0x8cef37[_0x7829bc(0x184)])[_0x7829bc(0x1a9)]()===_0x7829bc(0x1d9)))_0x44224c=!![];}catch(_0x393ae4){}}if(_0x44224c)_0x419b0b['log'][_0x7829bc(0x1ad)](_0x7829bc(0x1fd)+_0x28cd7c+_0x7829bc(0x190));else{const _0x379818=_0x2390e0[_0x28cd7c]||_0x2390e0[_0x7829bc(0x1aa)]||0x15;_0x419b0b[_0x7829bc(0x1e0)]['info'](_0x7829bc(0x1e9)+_0x28cd7c+'\x20erreicht\x20Limit\x20('+_0x4dcd66[_0x7829bc(0x184)]+_0x7829bc(0x219)+(_0x379818+0.2)+_0x7829bc(0x1f6)),await _0x419b0b[_0x7829bc(0x197)](_0x772243,_0x379818),await logAutomationAction(_0x419b0b,_0x7829bc(0x1e7)+_0x28cd7c+':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20'+_0x379818+'¬∞C'),lastActions[_0x7829bc(0x203)+_0x28cd7c]=Date[_0x7829bc(0x1df)]();}}}_0x47ea65['splice'](_0x364532,0x1),_0x36ecdb=!![];}}}}}_0x36ecdb&&await _0x419b0b[_0x7829bc(0x230)](_0x5e7da6,{'val':JSON[_0x7829bc(0x208)](_0x47ea65),'ack':!![]}),_0x4a1986&&await _0x419b0b[_0x7829bc(0x230)](_0x7829bc(0x19b),{'val':JSON[_0x7829bc(0x208)](_0x4925a1),'ack':!![]});}catch(_0x2b37e0){}}async function applyEnergySavings(_0x525156,_0x295d2c){const _0x5ab6cd=a1_0x3ca4d2;await cleanupGhostInterventions(_0x525156);if(!_0x295d2c||_0x295d2c[_0x5ab6cd(0x1ba)]===0x0)return;const _0x3a0b52=_0x525156[_0x5ab6cd(0x202)][_0x5ab6cd(0x1ae)]||[],_0xc5fa70=Date['now']();for(const _0x23b0e5 of _0x295d2c){const _0x4b34c1=_0x23b0e5['room'],_0x279df1=_0x23b0e5[_0x5ab6cd(0x242)],_0x4cb60e=_0x23b0e5[_0x5ab6cd(0x1ce)]||0x15;if(lastActions[_0x5ab6cd(0x203)+_0x4b34c1]&&_0xc5fa70-lastActions[_0x5ab6cd(0x203)+_0x4b34c1]<RESCUE_LOCK_MS)continue;const _0x2b36d9=_0x3a0b52[_0x5ab6cd(0x1c2)](_0x161323=>normalize(_0x161323[_0x5ab6cd(0x21d)])===normalize(_0x4b34c1)&&(_0x161323[_0x5ab6cd(0x1cc)]===_0x5ab6cd(0x211)||_0x161323['type']==='thermostat'));if(!_0x2b36d9)continue;const _0x3e2b96=await findRelatedId(_0x525156,_0x2b36d9['id'],'setpoint');if(_0x3e2b96){if(lastActions['mpc_'+_0x4b34c1]&&_0xc5fa70-lastActions[_0x5ab6cd(0x1c9)+_0x4b34c1]<0x1e*0x3c*0x3e8)continue;const _0x393c42=await _0x525156[_0x5ab6cd(0x1f3)](_0x3e2b96);if(_0x393c42&&typeof _0x393c42['val']===_0x5ab6cd(0x21b)){const _0xae5ade=_0x393c42['val'];_0xae5ade!==ECO_TEMP&&await manageMpcIntervention(_0x525156,_0x4b34c1,_0x5ab6cd(0x201));if(_0x279df1>0x1e)_0xae5ade>ECO_TEMP+0.5&&(_0x525156[_0x5ab6cd(0x1e0)]['info'](_0x5ab6cd(0x215)+_0x4b34c1+_0x5ab6cd(0x185)+ECO_TEMP+_0x5ab6cd(0x1ac)+_0x279df1+_0x5ab6cd(0x1cb)),await _0x525156['setForeignStateAsync'](_0x3e2b96,ECO_TEMP),await manageMpcIntervention(_0x525156,_0x4b34c1,_0x5ab6cd(0x1b1)),lastActions[_0x5ab6cd(0x1c9)+_0x4b34c1]=_0xc5fa70,await logAutomationAction(_0x525156,'[MPC]\x20'+_0x4b34c1+_0x5ab6cd(0x1d3)+ECO_TEMP+'¬∞C'));else _0x279df1<=0xf&&(_0xae5ade<_0x4cb60e&&(_0x525156[_0x5ab6cd(0x1e0)]['info'](_0x5ab6cd(0x1b4)+_0x4b34c1+_0x5ab6cd(0x206)+_0x4cb60e+_0x5ab6cd(0x1d8)),await _0x525156[_0x5ab6cd(0x197)](_0x3e2b96,_0x4cb60e),await manageMpcIntervention(_0x525156,_0x4b34c1,'remove'),lastActions[_0x5ab6cd(0x1c9)+_0x4b34c1]=_0xc5fa70,await logAutomationAction(_0x525156,_0x5ab6cd(0x1b2)+_0x4b34c1+_0x5ab6cd(0x23d)+_0x4cb60e+'¬∞C')));}}else _0x525156[_0x5ab6cd(0x1e0)][_0x5ab6cd(0x205)](_0x5ab6cd(0x1c1)+_0x4b34c1+'\x20gefunden!');}}module[a1_0x3ca4d2(0x1f5)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};