const a1_0x482120=a1_0x2224;(function(_0x358597,_0x438976){const _0x329cec=a1_0x2224,_0xf363cc=_0x358597();while(!![]){try{const _0x3567d2=-parseInt(_0x329cec(0x17e))/0x1+-parseInt(_0x329cec(0x19c))/0x2*(-parseInt(_0x329cec(0x131))/0x3)+parseInt(_0x329cec(0x1a1))/0x4+-parseInt(_0x329cec(0x156))/0x5*(parseInt(_0x329cec(0x13e))/0x6)+parseInt(_0x329cec(0x19a))/0x7*(parseInt(_0x329cec(0x16a))/0x8)+-parseInt(_0x329cec(0x15d))/0x9+-parseInt(_0x329cec(0x118))/0xa*(-parseInt(_0x329cec(0x158))/0xb);if(_0x3567d2===_0x438976)break;else _0xf363cc['push'](_0xf363cc['shift']());}catch(_0x814163){_0xf363cc['push'](_0xf363cc['shift']());}}}(a1_0x4fec,0xc35c5));const a1_0x1c0ee7=(function(){let _0x3006a4=!![];return function(_0x5455e1,_0x340756){const _0x7d1bfd=_0x3006a4?function(){const _0x3a7a80=a1_0x2224;if(_0x340756){const _0x1adfdb=_0x340756[_0x3a7a80(0x145)](_0x5455e1,arguments);return _0x340756=null,_0x1adfdb;}}:function(){};return _0x3006a4=![],_0x7d1bfd;};}()),a1_0x434a26=a1_0x1c0ee7(this,function(){const _0x19913c=a1_0x2224;return a1_0x434a26['toString']()[_0x19913c(0x147)](_0x19913c(0x174))[_0x19913c(0x14e)]()[_0x19913c(0x108)](a1_0x434a26)[_0x19913c(0x147)]('(((.+)+)+)+$');});a1_0x434a26();function a1_0x2224(_0xe584,_0x361332){const _0x401dcd=a1_0x4fec();return a1_0x2224=function(_0x434a26,_0x1c0ee7){_0x434a26=_0x434a26-0xfa;let _0x4fec6f=_0x401dcd[_0x434a26];return _0x4fec6f;},a1_0x2224(_0xe584,_0x361332);}'use strict';const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x33e1a8){const _0x20135f=a1_0x2224;if(!_0x33e1a8)return'';return _0x33e1a8[_0x20135f(0x144)]()[_0x20135f(0x16d)](/\s+/g,'')['trim']();}function getWarmupRobust(_0x31a90a,_0x26856c){const _0x4db15a=a1_0x2224;if(!_0x31a90a||!_0x26856c)return 0x3c;if(_0x31a90a[_0x26856c]!==undefined)return _0x31a90a[_0x26856c];const _0x3202d8=_0x26856c[_0x4db15a(0x144)]()[_0x4db15a(0x16d)](/√§/g,'ae')[_0x4db15a(0x16d)](/√∂/g,'oe')['replace'](/√º/g,'ue')[_0x4db15a(0x16d)](/√ü/g,'ss')[_0x4db15a(0x16d)](/\s+/g,'_')['replace'](/[^a-z0-9_]/g,'');if(_0x31a90a[_0x3202d8]!==undefined)return _0x31a90a[_0x3202d8];return 0x3c;}async function logAutomationAction(_0x1ccf5a,_0x312cbc){const _0x3bac55=a1_0x2224;await _0x1ccf5a[_0x3bac55(0x10a)](_0x3bac55(0x13b),{'val':_0x312cbc,'ack':!![]});try{const _0x16825b=_0x3bac55(0x11b),_0x795927=await _0x1ccf5a[_0x3bac55(0x11e)](_0x16825b);let _0x5c6993=[];if(_0x795927&&_0x795927[_0x3bac55(0x13a)])try{_0x5c6993=JSON[_0x3bac55(0x125)](_0x795927[_0x3bac55(0x13a)]);}catch(_0x43af3c){}_0x5c6993['unshift']({'ts':Date['now'](),'msg':_0x312cbc});if(_0x5c6993[_0x3bac55(0x103)]>0x32)_0x5c6993=_0x5c6993['slice'](0x0,0x32);await _0x1ccf5a[_0x3bac55(0x10a)](_0x16825b,{'val':JSON['stringify'](_0x5c6993),'ack':!![]});}catch(_0x4251c5){}}async function handlePrediction(_0x1bccf0,_0x3ab809,_0x135e4c){const _0xb54049=a1_0x2224;if(!_0x3ab809||_0x3ab809===_0xb54049(0x18f))return;let _0x5bc910='off',_0x24b7e8=0.6;try{const _0x274330=await _0x1bccf0['getStateAsync'](_0xb54049(0x154));if(_0x274330&&_0x274330['val'])_0x5bc910=_0x274330['val'];const _0x4b09c8=await _0x1bccf0[_0xb54049(0x11e)]('analysis.automation.confidenceThreshold');if(_0x4b09c8&&_0x4b09c8[_0xb54049(0x13a)])_0x24b7e8=_0x4b09c8[_0xb54049(0x13a)];}catch(_0x119645){}if(_0x5bc910===_0xb54049(0x181)||_0x135e4c<_0x24b7e8)return;const _0x330c96=Date[_0xb54049(0x106)]();if(lastActions[_0x3ab809]&&_0x330c96-lastActions[_0x3ab809]<COOLDOWN_MS)return;const _0x910ea8=_0x1bccf0['config'][_0xb54049(0x15b)]||[],_0x4b88ad=normalize(_0x3ab809),_0xf4a8a0=_0x910ea8[_0xb54049(0x113)](_0x2b19d9=>normalize(_0x2b19d9[_0xb54049(0x19f)])===_0x4b88ad&&(_0x2b19d9[_0xb54049(0x1b0)]===_0xb54049(0x105)||_0x2b19d9[_0xb54049(0x1b0)]===_0xb54049(0x17b)||_0x2b19d9[_0xb54049(0x1b0)]===_0xb54049(0x160)));if(!_0xf4a8a0)return;const _0x270e75=await aiAgent[_0xb54049(0x16f)](_0x1bccf0,_0x3ab809,_0xf4a8a0[_0xb54049(0x18b)],_0x135e4c);if(!_0x270e75[_0xb54049(0x143)])return;const _0x288f95=_0xb54049(0x14c)+_0x3ab809+_0xb54049(0x192)+_0xf4a8a0['name']+'\x20('+_0x270e75[_0xb54049(0x182)]+')';await logAutomationAction(_0x1bccf0,'['+_0x5bc910['toUpperCase']()+']\x20'+_0x288f95);if(_0x5bc910===_0xb54049(0x18d)){const _0x5106e6=await _0x1bccf0[_0xb54049(0x12e)](_0xf4a8a0['id']);(!_0x5106e6||!_0x5106e6[_0xb54049(0x13a)]&&_0x5106e6[_0xb54049(0x13a)]!==!![])&&await _0x1bccf0['setForeignStateAsync'](_0xf4a8a0['id'],!![]),lastActions[_0x3ab809]=_0x330c96;}}async function findRelatedId(_0x15e4bc,_0x208462,_0x328bab=a1_0x482120(0x102)){const _0xfd2257=a1_0x482120;if(_0x328bab===_0xfd2257(0x102)&&_0x15e4bc['config'][_0xfd2257(0x163)]){let _0x31136f=_0x15e4bc[_0xfd2257(0xfa)]['thermostatMapping'];if(typeof _0x31136f==='string')try{_0x31136f=JSON[_0xfd2257(0x125)](_0x31136f);}catch(_0x34cc7d){}if(_0x31136f&&_0x31136f[_0x208462])return _0x31136f[_0x208462];}if(_0x328bab==='valve'&&_0x15e4bc[_0xfd2257(0xfa)][_0xfd2257(0x11a)]){let _0x37383f=_0x15e4bc[_0xfd2257(0xfa)][_0xfd2257(0x11a)];if(typeof _0x37383f===_0xfd2257(0x109))try{_0x37383f=JSON[_0xfd2257(0x125)](_0x37383f);}catch(_0x5a08c7){}if(_0x37383f&&_0x37383f[_0x208462])return _0x37383f[_0x208462];}let _0xe724d9=[];if(_0x328bab===_0xfd2257(0x102))_0xe724d9=[{'s':_0xfd2257(0x17f),'t':_0xfd2257(0x115)},{'s':_0xfd2257(0x12f),'t':'.1.SET_POINT_TEMPERATURE'},{'s':_0xfd2257(0x12f),'t':_0xfd2257(0x10d)},{'s':'ACTUAL_TEMPERATURE','t':_0xfd2257(0x104)},{'s':_0xfd2257(0x148),'t':_0xfd2257(0x176)},{'s':_0xfd2257(0x148),'t':'current_heating_setpoint'},{'s':_0xfd2257(0x187),'t':_0xfd2257(0x1a4)},{'s':'ACTUAL','t':_0xfd2257(0x12d)},{'s':_0xfd2257(0x198),'t':_0xfd2257(0x101)},{'s':_0xfd2257(0x187),'t':_0xfd2257(0x102)}];else _0x328bab===_0xfd2257(0x1b4)&&(_0xe724d9=[{'s':'.1.ACTUAL_TEMPERATURE','t':'.1.LEVEL'},{'s':_0xfd2257(0x12f),'t':'.1.LEVEL'},{'s':_0xfd2257(0x12f),'t':'.4.VALVE_STATE'},{'s':'local_temperature','t':_0xfd2257(0x197)},{'s':'temperature','t':_0xfd2257(0x1ab)},{'s':_0xfd2257(0x187),'t':_0xfd2257(0x128)}]);for(const _0x33593f of _0xe724d9){if(_0x208462[_0xfd2257(0x16c)](_0x33593f['s'])){const _0x2f40d6=_0x208462['replace'](_0x33593f['s'],_0x33593f['t']),_0x1584c3=await _0x15e4bc['getForeignObjectAsync'](_0x2f40d6);if(_0x1584c3)return _0x2f40d6;}}try{const _0x26f806=_0x208462[_0xfd2257(0x12b)]('.');if(_0x26f806[_0xfd2257(0x103)]>0x2){const _0x1238c8=_0x26f806['slice'](0x0,-0x1)[_0xfd2257(0x171)]('.'),_0x1ef5e4=await _0x15e4bc['getForeignObjectsAsync'](_0x1238c8+'.*'),_0x2e20f4=[],_0x45ae5f=_0x208462[_0xfd2257(0x12b)](/[._]+/)[_0xfd2257(0x16e)](_0xa0d762=>!['openknx','0',_0xfd2257(0x152),'ist',_0xfd2257(0x166),'temperature','actual',_0xfd2257(0xfb),_0xfd2257(0x146),_0xfd2257(0x179)][_0xfd2257(0x16c)](_0xa0d762[_0xfd2257(0x144)]()));for(const [_0x50de45,_0x3e7262]of Object[_0xfd2257(0x180)](_0x1ef5e4)){if(_0x50de45===_0x208462)continue;if(_0x3e7262&&_0x3e7262['common']){const _0x4d11ec=_0x50de45[_0xfd2257(0x144)](),_0x2df320=(_0x3e7262['common'][_0xfd2257(0x18a)]||'')[_0xfd2257(0x144)](),_0x483f45=(_0x3e7262['common'][_0xfd2257(0x195)]||'')[_0xfd2257(0x144)]();let _0x1fd981=![];if(_0x328bab===_0xfd2257(0x102)&&_0x3e7262[_0xfd2257(0x190)][_0xfd2257(0x19d)]===!![])_0x1fd981=_0x4d11ec['includes']('set')||_0x4d11ec['includes'](_0xfd2257(0x165))||_0x4d11ec[_0xfd2257(0x16c)](_0xfd2257(0x199))||_0x2df320[_0xfd2257(0x16c)]('level.temperature')||_0x2df320[_0xfd2257(0x16c)]('thermostat.setpoint');else _0x328bab===_0xfd2257(0x1b4)&&(_0x1fd981=_0x4d11ec[_0xfd2257(0x16c)]('level')||_0x4d11ec[_0xfd2257(0x16c)](_0xfd2257(0x1b4))||_0x4d11ec['includes'](_0xfd2257(0x18e))||_0x4d11ec['includes'](_0xfd2257(0x13d))||_0x2df320[_0xfd2257(0x16c)]('level.valve')||_0x2df320['includes']('value.valve')||_0x483f45[_0xfd2257(0x16c)]('%'));if(_0x1fd981){const _0x14af3e=_0x50de45[_0xfd2257(0x12b)](/[._]+/)[_0xfd2257(0x1af)](_0x3e9c9d=>_0x3e9c9d[_0xfd2257(0x144)]());let _0x4db2bc=0x0;_0x45ae5f[_0xfd2257(0x151)](_0x2d622f=>{const _0x144433=_0xfd2257;if(_0x14af3e[_0x144433(0x16c)](_0x2d622f[_0x144433(0x144)]()))_0x4db2bc++;}),_0x2e20f4[_0xfd2257(0x14a)]({'id':_0x50de45,'score':_0x4db2bc});}}}if(_0x2e20f4[_0xfd2257(0x103)]>0x0){_0x2e20f4[_0xfd2257(0x18c)]((_0x11fbfa,_0x481914)=>_0x481914['score']-_0x11fbfa[_0xfd2257(0x194)]);if(_0x2e20f4[0x0]['score']>0x0)return _0x2e20f4[0x0]['id'];}}}catch(_0x318278){}return null;}async function scanThermostats(_0x44bc58){const _0x92ca72=a1_0x482120,_0x37cdc1=_0x44bc58[_0x92ca72(0xfa)]['devices']||[],_0x235876=[],_0x21b1d0=_0x37cdc1[_0x92ca72(0x16e)](_0x511ff5=>_0x511ff5['id']&&_0x511ff5['id'][_0x92ca72(0x16c)](_0x92ca72(0x187))||_0x511ff5[_0x92ca72(0x1b0)]&&[_0x92ca72(0x187),_0x92ca72(0x129),_0x92ca72(0xfb)]['includes'](_0x511ff5['type'])||_0x511ff5[_0x92ca72(0x18b)]&&_0x511ff5['name'][_0x92ca72(0x144)]()[_0x92ca72(0x16c)]('temp'));for(const _0x27367e of _0x21b1d0){const _0x1b2706=await findRelatedId(_0x44bc58,_0x27367e['id'],_0x92ca72(0x102)),_0x49ecaf=await findRelatedId(_0x44bc58,_0x27367e['id'],'valve');let _0x25b921='Nicht\x20gefunden',_0x305727=![],_0x5ed804=_0x44bc58['config'][_0x92ca72(0x163)]||{};if(typeof _0x5ed804==='string')try{_0x5ed804=JSON['parse'](_0x5ed804);}catch(_0x31ca80){}let _0x57fd3d=_0x44bc58[_0x92ca72(0xfa)]['valveMapping']||{};if(typeof _0x57fd3d==='string')try{_0x57fd3d=JSON[_0x92ca72(0x125)](_0x57fd3d);}catch(_0x4de224){}if(_0x5ed804[_0x27367e['id']]&&_0x5ed804[_0x27367e['id']]===_0x1b2706||_0x57fd3d[_0x27367e['id']]&&_0x57fd3d[_0x27367e['id']]===_0x49ecaf)_0x25b921='Manuelles\x20Mapping',_0x305727=!![];else(_0x1b2706||_0x49ecaf)&&(_0x25b921=_0x92ca72(0x1a9));_0x235876[_0x92ca72(0x14a)]({'room':_0x27367e[_0x92ca72(0x19f)]||'Unbekannt','sensorId':_0x27367e['id'],'setpointId':_0x1b2706||'-','valveId':_0x49ecaf||'-','source':_0x25b921,'isManual':_0x305727,'status':_0x1b2706&&_0x49ecaf?_0x92ca72(0x149):_0x1b2706?'OK':'Fehlt'});}return _0x235876[_0x92ca72(0x18c)]((_0x5398bf,_0x24ff8b)=>_0x5398bf[_0x92ca72(0x11c)][_0x92ca72(0x183)](_0x24ff8b[_0x92ca72(0x11c)]));}async function updateSchedulePreview(_0x24232a){const _0x5f586b=a1_0x482120;if(!_0x24232a['config'][_0x5f586b(0x17d)]||!_0x24232a[_0x5f586b(0xfa)][_0x5f586b(0x169)])return;let _0x262a33={};try{const _0x4ff934=await _0x24232a[_0x5f586b(0x11e)](_0x5f586b(0x1a6));if(_0x4ff934&&_0x4ff934[_0x5f586b(0x13a)])_0x262a33=JSON[_0x5f586b(0x125)](_0x4ff934[_0x5f586b(0x13a)]);}catch(_0x71d75a){}const _0x3bef1f=[],_0x8b54a5=Date[_0x5f586b(0x106)](),_0x277ac9=0x30*0x3c*0x3c*0x3e8;try{const _0x27dd75=await _0x24232a[_0x5f586b(0x12e)](_0x24232a[_0x5f586b(0xfa)][_0x5f586b(0x169)]+_0x5f586b(0x161));if(!_0x27dd75||!_0x27dd75['val'])return;const _0x4a5ff5=JSON['parse'](_0x27dd75[_0x5f586b(0x13a)]),_0x2f19b8=_0x24232a['config'][_0x5f586b(0x1a2)]||[],_0x518b88=_0x24232a[_0x5f586b(0xfa)][_0x5f586b(0x15b)]||[],_0x18c537=new Set();_0x518b88[_0x5f586b(0x151)](_0x3c1c3d=>{const _0x23ba41=_0x5f586b;if(_0x3c1c3d[_0x23ba41(0x19f)])_0x18c537[_0x23ba41(0x100)](_0x3c1c3d[_0x23ba41(0x19f)]);});for(const _0x3e4c10 of _0x4a5ff5){if(_0x3e4c10[_0x5f586b(0x1ae)]&&_0x2f19b8[_0x5f586b(0x103)]>0x0&&!_0x2f19b8[_0x5f586b(0x16c)](_0x3e4c10[_0x5f586b(0x1ae)]))continue;const _0x375738=_0x3e4c10[_0x5f586b(0x184)]||_0x3e4c10[_0x5f586b(0x1a5)]||_0x3e4c10['date'];if(!_0x375738)continue;const _0x3cfc6d=new Date(_0x375738),_0x25f33e=_0x3cfc6d[_0x5f586b(0xfc)]();if(isNaN(_0x25f33e))continue;if(_0x25f33e<_0x8b54a5)continue;if(_0x25f33e>_0x8b54a5+_0x277ac9)continue;const _0x4005e0=(_0x3e4c10[_0x5f586b(0x157)]||_0x3e4c10[_0x5f586b(0x112)]||'')[_0x5f586b(0x144)]();let _0x22f270=![],_0x19351d=[],_0x66474=_0x3e4c10[_0x5f586b(0x157)]||_0x3e4c10[_0x5f586b(0x112)]||_0x5f586b(0x13c);if(_0x4005e0[_0x5f586b(0x16c)](_0x5f586b(0x124))||_0x4005e0[_0x5f586b(0x16c)](_0x5f586b(0x10e))||_0x4005e0[_0x5f586b(0x16c)]('ankunft'))_0x22f270=!![],_0x19351d=Array[_0x5f586b(0x136)](_0x18c537);else for(const _0xfdf736 of _0x18c537){if(_0x4005e0[_0x5f586b(0x16c)](_0xfdf736[_0x5f586b(0x144)]()))_0x19351d[_0x5f586b(0x14a)](_0xfdf736);}_0x19351d[_0x5f586b(0x103)]>0x0&&_0x19351d[_0x5f586b(0x151)](_0x37c07d=>{const _0x53937e=_0x5f586b;let _0x259a5e=0x3c;if(_0x22f270){let _0x21d0e3=0x0;Object[_0x53937e(0x159)](_0x262a33)[_0x53937e(0x151)](_0x51e18b=>{if(_0x51e18b>_0x21d0e3)_0x21d0e3=_0x51e18b;}),_0x259a5e=_0x21d0e3>0x0?_0x21d0e3:0x78;}else _0x259a5e=getWarmupRobust(_0x262a33,_0x37c07d);const _0x20ac44=new Date(_0x25f33e-_0x259a5e*0xea60);_0x3bef1f[_0x53937e(0x14a)]({'eventTime':_0x25f33e,'triggerTime':_0x20ac44[_0x53937e(0xfc)](),'room':_0x37c07d,'minutes':_0x259a5e,'reason':_0x66474,'isGlobal':_0x22f270});});}}catch(_0x3f0bda){}_0x3bef1f[_0x5f586b(0x18c)]((_0x4d8f15,_0x489837)=>_0x4d8f15[_0x5f586b(0x185)]-_0x489837['triggerTime']);const _0x1d43ea=_0x3bef1f[_0x5f586b(0x1a0)](0x0,0x5);await _0x24232a[_0x5f586b(0x10a)](_0x5f586b(0x12c),{'val':JSON[_0x5f586b(0x123)](_0x1d43ea),'ack':!![]});}async function monitorEnforcements(_0x2574b7){const _0x6b9679=a1_0x482120;try{const _0x196523='analysis.energy.activeEnforcements',_0x332849=await _0x2574b7['getStateAsync'](_0x196523);if(!_0x332849||!_0x332849[_0x6b9679(0x13a)])return;let _0x595dfd=[];try{_0x595dfd=JSON[_0x6b9679(0x125)](_0x332849[_0x6b9679(0x13a)]);}catch(_0x480421){return;}if(!Array['isArray'](_0x595dfd)||_0x595dfd[_0x6b9679(0x103)]===0x0)return;const _0x42481c=Date[_0x6b9679(0x106)](),_0x5d2426=_0x2574b7[_0x6b9679(0xfa)][_0x6b9679(0x15b)]||[];let _0x1d95e3=![];for(let _0x584444=_0x595dfd[_0x6b9679(0x103)]-0x1;_0x584444>=0x0;_0x584444--){const _0x213abd=_0x595dfd[_0x584444];if(_0x42481c>=_0x213abd[_0x6b9679(0x117)]){_0x2574b7[_0x6b9679(0x175)][_0x6b9679(0x19e)]('üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20'+_0x213abd[_0x6b9679(0x11c)]+'\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.'),_0x595dfd[_0x6b9679(0x130)](_0x584444,0x1),_0x1d95e3=!![];continue;}const _0x567bf0=_0x5d2426[_0x6b9679(0x113)](_0x5d2dbd=>normalize(_0x5d2dbd[_0x6b9679(0x19f)])===normalize(_0x213abd[_0x6b9679(0x11c)])&&(_0x5d2dbd[_0x6b9679(0x1b0)]===_0x6b9679(0x187)||_0x5d2dbd[_0x6b9679(0x1b0)]===_0x6b9679(0x129)));if(_0x567bf0){const _0x59ee7e=await findRelatedId(_0x2574b7,_0x567bf0['id'],_0x6b9679(0x102));if(_0x59ee7e){const _0x56076a=await _0x2574b7['getForeignStateAsync'](_0x59ee7e);_0x56076a&&typeof _0x56076a[_0x6b9679(0x13a)]===_0x6b9679(0x150)&&(_0x56076a[_0x6b9679(0x13a)]<0xf&&(_0x2574b7[_0x6b9679(0x175)]['warn'](_0x6b9679(0x10f)+_0x213abd[_0x6b9679(0x11c)]+_0x6b9679(0x12a)+_0x56076a['val']+_0x6b9679(0x168)+_0x213abd[_0x6b9679(0x199)]+_0x6b9679(0x142)),await _0x2574b7['setForeignStateAsync'](_0x59ee7e,_0x213abd[_0x6b9679(0x199)]),await logAutomationAction(_0x2574b7,_0x6b9679(0x196)+_0x213abd[_0x6b9679(0x11c)]+':\x20'+_0x56076a[_0x6b9679(0x13a)]+'¬∞C\x20->\x20'+_0x213abd[_0x6b9679(0x199)]+_0x6b9679(0x1b3))));}}}_0x1d95e3&&await _0x2574b7[_0x6b9679(0x10a)](_0x196523,{'val':JSON[_0x6b9679(0x123)](_0x595dfd),'ack':!![]});}catch(_0x51d864){_0x2574b7[_0x6b9679(0x175)][_0x6b9679(0x122)](_0x6b9679(0xfe)+_0x51d864['message']);}}async function checkCalendarTriggers(_0x362e70){const _0x3d6a02=a1_0x482120;if(!_0x362e70['config'][_0x3d6a02(0x17d)]||!_0x362e70[_0x3d6a02(0xfa)]['calendarInstance'])return;await updateSchedulePreview(_0x362e70);let _0xf89ba={},_0x30cfe6={};try{const _0x43bd2a=await _0x362e70['getStateAsync']('analysis.energy.warmupTimes');if(_0x43bd2a&&_0x43bd2a[_0x3d6a02(0x13a)])_0xf89ba=JSON['parse'](_0x43bd2a[_0x3d6a02(0x13a)]);const _0x1b6ca3=await _0x362e70[_0x3d6a02(0x11e)](_0x3d6a02(0x162));if(_0x1b6ca3&&_0x1b6ca3[_0x3d6a02(0x13a)])_0x30cfe6=JSON['parse'](_0x1b6ca3[_0x3d6a02(0x13a)]);}catch(_0x2c9202){}let _0x29e5ac={'default':0x15};try{const _0x17e427=await _0x362e70[_0x3d6a02(0x11e)]('analysis.energy.warmupTargets');if(_0x17e427&&_0x17e427['val'])_0x29e5ac=JSON[_0x3d6a02(0x125)](_0x17e427[_0x3d6a02(0x13a)]);}catch(_0x3dca53){}let _0x97644c=[];try{const _0x5892e9=await _0x362e70[_0x3d6a02(0x11e)](_0x3d6a02(0x177));if(_0x5892e9&&_0x5892e9[_0x3d6a02(0x13a)])_0x97644c=JSON[_0x3d6a02(0x125)](_0x5892e9[_0x3d6a02(0x13a)]);}catch(_0xa4e7ed){}try{const _0x1761c5=await _0x362e70['getForeignStateAsync'](_0x362e70[_0x3d6a02(0xfa)]['calendarInstance']+_0x3d6a02(0x161));if(!_0x1761c5||!_0x1761c5[_0x3d6a02(0x13a)])return;const _0x576ce0=JSON[_0x3d6a02(0x125)](_0x1761c5[_0x3d6a02(0x13a)]),_0x5b1d43=Date[_0x3d6a02(0x106)](),_0x4d0515=_0x362e70[_0x3d6a02(0xfa)][_0x3d6a02(0x15b)]||[],_0x83e724=_0x362e70[_0x3d6a02(0xfa)][_0x3d6a02(0x1a2)]||[];let _0x3cee80=![];for(const _0x914670 of _0x576ce0){if(_0x914670[_0x3d6a02(0x1ae)]&&_0x83e724[_0x3d6a02(0x103)]>0x0&&!_0x83e724['includes'](_0x914670[_0x3d6a02(0x1ae)]))continue;const _0x547df2=_0x914670['_date']||_0x914670[_0x3d6a02(0x1a5)]||_0x914670[_0x3d6a02(0x1b5)];if(!_0x547df2)continue;const _0xb69985=new Date(_0x547df2);if(isNaN(_0xb69985[_0x3d6a02(0xfc)]()))continue;const _0x153577=(_0x914670['event']||_0x914670[_0x3d6a02(0x112)]||'')['toLowerCase']();if(_0x153577['includes'](_0x3d6a02(0x124))||_0x153577['includes'](_0x3d6a02(0x10e))||_0x153577['includes'](_0x3d6a02(0x170))){let _0x5830f1=0x0;Object['values'](_0xf89ba)[_0x3d6a02(0x151)](_0x55c2d7=>{if(_0x55c2d7>_0x5830f1)_0x5830f1=_0x55c2d7;});if(_0x5830f1===0x0)_0x5830f1=0x78;const _0x503684=_0xb69985[_0x3d6a02(0xfc)]()-_0x5830f1*0xea60;_0x5b1d43>=_0x503684&&_0x5b1d43<_0xb69985[_0x3d6a02(0xfc)]()&&(_0x362e70[_0x3d6a02(0x1b1)]!==_0x3d6a02(0x189)&&(_0x362e70[_0x3d6a02(0x175)][_0x3d6a02(0x19e)](_0x3d6a02(0xff)+_0x5830f1+_0x3d6a02(0x14f)),await _0x362e70['setStateAsync'](_0x3d6a02(0x139),{'val':_0x3d6a02(0x189),'ack':![]})));}for(const _0x36b95b of _0x4d0515){if(_0x36b95b[_0x3d6a02(0x19f)]){const _0x3e7295=_0x36b95b[_0x3d6a02(0x19f)][_0x3d6a02(0x144)](),_0x5b402d=(_0x36b95b[_0x3d6a02(0x18b)]||'')['toLowerCase']();let _0x99876a=_0x153577[_0x3d6a02(0x16c)](_0x3e7295);!_0x99876a&&_0x5b402d[_0x3d6a02(0x103)]>0x3&&_0x153577[_0x3d6a02(0x16c)](_0x5b402d)&&(_0x99876a=!![]);if(_0x99876a){const _0x17fee2=getWarmupRobust(_0xf89ba,_0x36b95b[_0x3d6a02(0x19f)]),_0x34e381=_0x30cfe6[_0x36b95b[_0x3d6a02(0x19f)]]||_0x3d6a02(0x110),_0x5b41c7=_0xb69985[_0x3d6a02(0xfc)]()-_0x17fee2*0xea60;if(_0x5b1d43>=_0x5b41c7&&_0x5b1d43<_0xb69985[_0x3d6a02(0xfc)]()){const _0xc239f=lastActions[_0x3d6a02(0x155)+_0x36b95b[_0x3d6a02(0x19f)]];if(_0xc239f&&_0x5b1d43-_0xc239f<CAL_COOLDOWN_MS)continue;const _0x141502=await findRelatedId(_0x362e70,_0x36b95b['id'],_0x3d6a02(0x102));if(_0x141502){let _0x3cf752=_0x29e5ac[_0x36b95b[_0x3d6a02(0x19f)]];if(_0x3cf752===undefined)_0x3cf752=_0x29e5ac['default'];if(_0x3cf752===undefined)_0x3cf752=0x15;const _0x34e364=await _0x362e70[_0x3d6a02(0x12e)](_0x141502);if(_0x34e364&&typeof _0x34e364[_0x3d6a02(0x13a)]===_0x3d6a02(0x150)&&_0x34e364[_0x3d6a02(0x13a)]<_0x3cf752-0.5){_0x362e70[_0x3d6a02(0x175)][_0x3d6a02(0x19e)](_0x3d6a02(0x137)+_0x34e381+']:\x20Raum-Trigger\x20\x27'+_0x36b95b[_0x3d6a02(0x19f)]+_0x3d6a02(0x11f)+_0x153577+_0x3d6a02(0x119)+_0x3cf752+'¬∞C\x20(Vorlauf:\x20'+_0x17fee2+'\x20min).'),await _0x362e70[_0x3d6a02(0x173)](_0x141502,_0x3cf752),await logAutomationAction(_0x362e70,_0x3d6a02(0x10c)+_0x36b95b[_0x3d6a02(0x19f)]+'\x20->\x20'+_0x3cf752+_0x3d6a02(0x121)+_0x34e381+')'),lastActions[_0x3d6a02(0x155)+_0x36b95b[_0x3d6a02(0x19f)]]=_0x5b1d43;const _0x2eb703=_0x97644c[_0x3d6a02(0x1ac)](_0x41ac89=>_0x41ac89[_0x3d6a02(0x11c)]===_0x36b95b[_0x3d6a02(0x19f)]);if(_0x2eb703!==-0x1)_0x97644c[_0x3d6a02(0x130)](_0x2eb703,0x1);_0x97644c[_0x3d6a02(0x14a)]({'room':_0x36b95b['location'],'target':_0x3cf752,'until':_0xb69985[_0x3d6a02(0xfc)]()}),_0x3cee80=!![];}}}}}}}_0x3cee80&&await _0x362e70['setStateAsync'](_0x3d6a02(0x177),{'val':JSON['stringify'](_0x97644c),'ack':!![]});}catch(_0x5d1fe4){_0x362e70['log'][_0x3d6a02(0x120)](_0x3d6a02(0x135)+_0x5d1fe4[_0x3d6a02(0x126)]);}}async function manageMpcIntervention(_0x4e1081,_0x337da8,_0x245977){const _0x2e3f9f=a1_0x482120;try{const _0x2d5916=_0x2e3f9f(0x172),_0x19c992=await _0x4e1081[_0x2e3f9f(0x11e)](_0x2d5916);let _0x53cd03=[];if(_0x19c992&&_0x19c992['val'])try{_0x53cd03=JSON[_0x2e3f9f(0x125)](_0x19c992[_0x2e3f9f(0x13a)]);}catch(_0x1e0ebf){}const _0x2fd764=_0x53cd03[_0x2e3f9f(0x15a)](_0x337da8);if(_0x245977===_0x2e3f9f(0x100))_0x2fd764===-0x1&&(_0x53cd03[_0x2e3f9f(0x14a)](_0x337da8),await _0x4e1081['setStateAsync'](_0x2d5916,{'val':JSON[_0x2e3f9f(0x123)](_0x53cd03),'ack':!![]}));else _0x245977===_0x2e3f9f(0x186)&&(_0x2fd764!==-0x1&&(_0x53cd03[_0x2e3f9f(0x130)](_0x2fd764,0x1),await _0x4e1081[_0x2e3f9f(0x10a)](_0x2d5916,{'val':JSON[_0x2e3f9f(0x123)](_0x53cd03),'ack':!![]})));}catch(_0x55a99e){}}async function cleanupGhostInterventions(_0x4f75b9){const _0x30b5db=a1_0x482120;try{const _0x7ed421='analysis.energy.mpcActiveInterventions',_0x2b0fb7=await _0x4f75b9['getStateAsync'](_0x7ed421);if(!_0x2b0fb7||!_0x2b0fb7[_0x30b5db(0x13a)])return;const _0x4dbde2=JSON[_0x30b5db(0x125)](_0x2b0fb7[_0x30b5db(0x13a)]);if(!Array[_0x30b5db(0x19b)](_0x4dbde2)||_0x4dbde2[_0x30b5db(0x103)]===0x0)return;let _0x53a182={'default':0x15};try{const _0x238bbe=await _0x4f75b9['getStateAsync'](_0x30b5db(0x11d));if(_0x238bbe&&_0x238bbe[_0x30b5db(0x13a)])_0x53a182=JSON['parse'](_0x238bbe[_0x30b5db(0x13a)]);}catch(_0x22aeac){}let _0x3d8a04=[];try{const _0x247d68=await _0x4f75b9['getStateAsync'](_0x30b5db(0x1b2));if(_0x247d68&&_0x247d68[_0x30b5db(0x13a)])_0x3d8a04=JSON['parse'](_0x247d68[_0x30b5db(0x13a)]);}catch(_0x3905f7){}let _0x2f6734={},_0x260d89=![];try{const _0x4c5bee=await _0x4f75b9['getStateAsync'](_0x30b5db(0x127));if(_0x4c5bee&&_0x4c5bee[_0x30b5db(0x13a)])_0x2f6734=JSON['parse'](_0x4c5bee[_0x30b5db(0x13a)]);}catch(_0x571a56){}if(_0x2f6734[_0x30b5db(0x114)]){const _0x3fc2b7=Date[_0x30b5db(0x106)]();for(const [_0x17170f,_0x469f6d]of Object[_0x30b5db(0x180)](_0x2f6734[_0x30b5db(0x114)])){_0x3fc2b7-_0x469f6d>PENALTY_TTL&&(delete _0x2f6734[_0x17170f],delete _0x2f6734[_0x30b5db(0x114)][_0x17170f],_0x260d89=!![],_0x4f75b9[_0x30b5db(0x175)][_0x30b5db(0x19e)](_0x30b5db(0x1a7)+_0x17170f+_0x30b5db(0x1aa)));}}const _0x2eef1d=_0x4f75b9[_0x30b5db(0xfa)][_0x30b5db(0x15b)]||[];let _0x5c9aaa=![];for(let _0x26d642=_0x4dbde2[_0x30b5db(0x103)]-0x1;_0x26d642>=0x0;_0x26d642--){const _0x61477d=_0x4dbde2[_0x26d642],_0x33a8b1=_0x2eef1d['find'](_0x1b80c3=>normalize(_0x1b80c3[_0x30b5db(0x19f)])===normalize(_0x61477d)&&(_0x1b80c3['type']===_0x30b5db(0x187)||_0x1b80c3[_0x30b5db(0x1b0)]===_0x30b5db(0x129)));if(!_0x33a8b1){_0x4f75b9['log'][_0x30b5db(0x120)](_0x30b5db(0x1a3)+_0x61477d+_0x30b5db(0x134)),_0x4dbde2[_0x30b5db(0x130)](_0x26d642,0x1),_0x5c9aaa=!![];continue;}if(_0x33a8b1){const _0x19cb1a=await findRelatedId(_0x4f75b9,_0x33a8b1['id'],_0x30b5db(0x102)),_0x29e0b9=await _0x4f75b9['getForeignStateAsync'](_0x33a8b1['id']);if(_0x19cb1a){const _0x58dd35=await _0x4f75b9['getForeignStateAsync'](_0x19cb1a);if(_0x58dd35&&typeof _0x58dd35[_0x30b5db(0x13a)]==='number'){let _0x515d12=![],_0x52013f='';Math[_0x30b5db(0x13f)](_0x58dd35[_0x30b5db(0x13a)]-ECO_TEMP)>0.5&&(_0x515d12=!![],_0x52013f=_0x30b5db(0x132));if(!_0x515d12&&_0x29e0b9&&typeof _0x29e0b9['val']===_0x30b5db(0x150)){const _0x3d6365=_0x53a182[_0x61477d]||_0x53a182[_0x30b5db(0x153)]||0x15;_0x29e0b9[_0x30b5db(0x13a)]<_0x3d6365+0.2&&(_0x515d12=!![],_0x52013f=_0x30b5db(0x167));}if(_0x515d12){if(_0x52013f===_0x30b5db(0x132)){_0x4f75b9[_0x30b5db(0x175)][_0x30b5db(0x19e)]('üßπ\x20[MPC\x20CLEANUP]\x20'+_0x61477d+'\x20ist\x20auf\x20'+_0x58dd35[_0x30b5db(0x13a)]+_0x30b5db(0x17c)+ECO_TEMP+_0x30b5db(0x14b));const _0x5199aa=lastActions[_0x30b5db(0x155)+_0x61477d],_0x3842d9=_0x5199aa&&Date[_0x30b5db(0x106)]()-_0x5199aa<0x2*0x3c*0x3e8;if(!_0x3842d9&&_0x58dd35[_0x30b5db(0x13a)]>ECO_TEMP+0.5){_0x4f75b9['sendToPythonWrapper']&&(_0x4f75b9[_0x30b5db(0x175)][_0x30b5db(0x19e)]('üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20'+_0x61477d+'\x20wurde\x20manuell\x20erh√∂ht.'),_0x4f75b9['sendToPythonWrapper'](_0x30b5db(0x141),{'room':_0x61477d}));const _0x9785d9=_0x61477d+'_'+new Date()['getHours']();if(!_0x2f6734[_0x9785d9]){_0x2f6734[_0x9785d9]=0x1;if(!_0x2f6734[_0x30b5db(0x114)])_0x2f6734[_0x30b5db(0x114)]={};_0x2f6734['_meta'][_0x9785d9]=Date['now'](),_0x260d89=!![];}}else _0x3842d9&&_0x4f75b9[_0x30b5db(0x175)][_0x30b5db(0x19e)](_0x30b5db(0x10b)+_0x61477d+_0x30b5db(0x178));}else{if(_0x52013f===_0x30b5db(0x167)){let _0x5ec68c=![];if(_0x3d8a04[_0x30b5db(0x113)](_0x18bb64=>_0x18bb64[_0x30b5db(0x11c)]===_0x61477d))_0x5ec68c=!![];const _0x58402d=_0x2eef1d['filter'](_0x1c2945=>normalize(_0x1c2945['location'])===normalize(_0x61477d)&&(_0x1c2945[_0x30b5db(0x1b0)]===_0x30b5db(0x15e)||_0x1c2945['type']===_0x30b5db(0xfb)||_0x1c2945[_0x30b5db(0x1b0)]==='contact'));for(const _0x58f8fd of _0x58402d){try{const _0x4ed5e9=await _0x4f75b9[_0x30b5db(0x12e)](_0x58f8fd['id']);if(_0x4ed5e9&&(_0x4ed5e9[_0x30b5db(0x13a)]===!![]||_0x4ed5e9[_0x30b5db(0x13a)]===0x1||String(_0x4ed5e9[_0x30b5db(0x13a)])['toLowerCase']()===_0x30b5db(0x15c)))_0x5ec68c=!![];}catch(_0x465523){}}if(_0x5ec68c)_0x4f75b9[_0x30b5db(0x175)][_0x30b5db(0x19e)]('üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20'+_0x61477d+_0x30b5db(0x138));else{const _0x24e0e3=_0x53a182[_0x61477d]||_0x53a182[_0x30b5db(0x153)]||0x15;_0x4f75b9[_0x30b5db(0x175)]['info'](_0x30b5db(0x164)+_0x61477d+_0x30b5db(0x1ad)+_0x29e0b9['val']+_0x30b5db(0x133)+(_0x24e0e3+0.2)+_0x30b5db(0x16b)),await _0x4f75b9[_0x30b5db(0x173)](_0x19cb1a,_0x24e0e3),await logAutomationAction(_0x4f75b9,_0x30b5db(0x140)+_0x61477d+_0x30b5db(0x193)+_0x24e0e3+'¬∞C'),lastActions[_0x30b5db(0x15f)+_0x61477d]=Date[_0x30b5db(0x106)]();}}}_0x4dbde2['splice'](_0x26d642,0x1),_0x5c9aaa=!![];}}}}}_0x5c9aaa&&await _0x4f75b9['setStateAsync'](_0x7ed421,{'val':JSON[_0x30b5db(0x123)](_0x4dbde2),'ack':!![]}),_0x260d89&&await _0x4f75b9[_0x30b5db(0x10a)]('analysis.energy.rlPenalties',{'val':JSON[_0x30b5db(0x123)](_0x2f6734),'ack':!![]});}catch(_0x57b0a6){}}function a1_0x4fec(){const _0x594179=['Ist','target','7asOVxA','isArray','30VsnTYx','write','info','location','slice','962440dqAHPY','calendarSelection','üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','target_temperature','eventStart','analysis.energy.warmupTimes','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27','\x20min)','Auto-Erkennung','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','valve_position','findIndex','\x20erreicht\x20Limit\x20(','_calName','map','type','currentSystemMode','analysis.energy.ventilationAlerts','¬∞C\x20(Kalender-Schutz)','valve','date','config','sensor','getTime','¬∞C!\x20(Puffer\x20leer).','Enforcement\x20Monitor\x20Error:\x20','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','add','Soll','setpoint','length','SET_POINT_TEMPERATURE','light','now','[MPC]\x20','constructor','string','setStateAsync','üìÖ\x20[MPC\x20INFO]\x20','[CAL]\x20','.4.SET_TEMPERATURE','r√ºckkehr','üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','Classic','exports','summary','find','_meta','.1.SET_POINT_TEMPERATURE','üî•\x20[MPC\x20ACTION]\x20Heize\x20','until','12174270YGtTFZ',')\x20aktiv.\x20Heize\x20auf\x20','valveMapping','analysis.automation.actionLog','room','analysis.energy.warmupTargets','getStateAsync','\x27\x20(Match:\x20','warn','¬∞C\x20(via\x20','error','stringify','urlaub\x20ende','parse','message','analysis.energy.rlPenalties','level','thermostat','\x20auf\x20','split','analysis.energy.schedulePreview','SET','getForeignStateAsync','.1.TEMPERATURE','splice','197598GbcUYH','manual','¬∞C\x20<\x20','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','Calendar\x20Check\x20Error:\x20','from','üìÖ\x20SMART\x20SCHEDULE\x20[','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','system.mode','val','analysis.automation.lastAction','Unbekannt','position','18XDZBTQ','abs','[WATCHDOG]\x20','TRAIN_RL_PENALTY','¬∞C.','approved','toLowerCase','apply','messwert','search','local_temperature','PERFECT','push','¬∞C).\x20Entferne\x20Status.','Pr√§diktion:\x20','mpc_','toString','\x20min).','number','forEach','hm-rpc','default','analysis.automation.mode','cal_','1054135prGJzl','event','11VWsVxb','values','indexOf','devices','open','9271755tASOgU','window','rescue_','switch','.data.table','analysis.energy.warmupSources','thermostatMapping','üö®\x20[MPC\x20WATCHDOG]\x20','soll','wert','too_cold','¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20','calendarInstance','1562480alslAR','¬∞C).\x20Sparmodus\x20beendet!','includes','replace','filter','consultButler','ankunft','join','analysis.energy.mpcActiveInterventions','setForeignStateAsync','(((.+)+)+)+$','log','occupied_heating_setpoint','analysis.energy.activeEnforcements','\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.','state','¬∞C!\x20(Puffer:\x20','dimmer','¬∞C\x20(nicht\x20','useCalendar','178464SrMFIq','.1.ACTUAL_TEMPERATURE','entries','off','reason','localeCompare','_date','triggerTime','remove','temperature','\x20wieder\x20auf\x20','normal','role','name','sort','active','stellwert','Unknown','common',':\x20Aufheizen\x20auf\x20','\x20->\x20Schalte\x20',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','score','unit','[FORCE]\x20','pi_heating_demand'];a1_0x4fec=function(){return _0x594179;};return a1_0x4fec();}async function applyEnergySavings(_0x2b972c,_0x2f7a92){const _0x3e6f8e=a1_0x482120;await cleanupGhostInterventions(_0x2b972c);if(!_0x2f7a92||_0x2f7a92[_0x3e6f8e(0x103)]===0x0)return;const _0x2a0507=_0x2b972c[_0x3e6f8e(0xfa)][_0x3e6f8e(0x15b)]||[],_0x3a3e01=Date['now']();for(const _0x4a6406 of _0x2f7a92){const _0x305d23=_0x4a6406[_0x3e6f8e(0x11c)],_0xafd049=_0x4a6406['minutes_safe'],_0x380511=_0x4a6406[_0x3e6f8e(0x199)]||0x15;if(lastActions[_0x3e6f8e(0x15f)+_0x305d23]&&_0x3a3e01-lastActions[_0x3e6f8e(0x15f)+_0x305d23]<RESCUE_LOCK_MS)continue;const _0x5cada2=_0x2a0507[_0x3e6f8e(0x113)](_0x934f18=>normalize(_0x934f18['location'])===normalize(_0x305d23)&&(_0x934f18[_0x3e6f8e(0x1b0)]===_0x3e6f8e(0x187)||_0x934f18['type']===_0x3e6f8e(0x129)));if(!_0x5cada2)continue;const _0x51cb0a=await findRelatedId(_0x2b972c,_0x5cada2['id'],_0x3e6f8e(0x102));if(_0x51cb0a){if(lastActions[_0x3e6f8e(0x14d)+_0x305d23]&&_0x3a3e01-lastActions[_0x3e6f8e(0x14d)+_0x305d23]<0x1e*0x3c*0x3e8)continue;const _0xc9f396=await _0x2b972c[_0x3e6f8e(0x12e)](_0x51cb0a);if(_0xc9f396&&typeof _0xc9f396[_0x3e6f8e(0x13a)]==='number'){const _0x19ba1b=_0xc9f396[_0x3e6f8e(0x13a)];_0x19ba1b!==ECO_TEMP&&await manageMpcIntervention(_0x2b972c,_0x305d23,_0x3e6f8e(0x186));if(_0xafd049>0x1e)_0x19ba1b>ECO_TEMP+0.5&&(_0x2b972c[_0x3e6f8e(0x175)][_0x3e6f8e(0x19e)]('üçÉ\x20[MPC\x20ACTION]\x20Senke\x20'+_0x305d23+'\x20auf\x20'+ECO_TEMP+_0x3e6f8e(0x17a)+_0xafd049+_0x3e6f8e(0x1a8)),await _0x2b972c[_0x3e6f8e(0x173)](_0x51cb0a,ECO_TEMP),await manageMpcIntervention(_0x2b972c,_0x305d23,_0x3e6f8e(0x100)),lastActions[_0x3e6f8e(0x14d)+_0x305d23]=_0x3a3e01,await logAutomationAction(_0x2b972c,_0x3e6f8e(0x107)+_0x305d23+':\x20Absenkung\x20auf\x20'+ECO_TEMP+'¬∞C'));else _0xafd049<=0xf&&(_0x19ba1b<_0x380511&&(_0x2b972c[_0x3e6f8e(0x175)][_0x3e6f8e(0x19e)](_0x3e6f8e(0x116)+_0x305d23+_0x3e6f8e(0x188)+_0x380511+_0x3e6f8e(0xfd)),await _0x2b972c['setForeignStateAsync'](_0x51cb0a,_0x380511),await manageMpcIntervention(_0x2b972c,_0x305d23,'remove'),lastActions[_0x3e6f8e(0x14d)+_0x305d23]=_0x3a3e01,await logAutomationAction(_0x2b972c,_0x3e6f8e(0x107)+_0x305d23+_0x3e6f8e(0x191)+_0x380511+'¬∞C')));}}else _0x2b972c[_0x3e6f8e(0x175)][_0x3e6f8e(0x120)]('[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20'+_0x305d23+'\x20gefunden!');}}module[a1_0x482120(0x111)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};