const a1_0x392085=a1_0x1122;(function(_0x40b4a1,_0x18b99a){const _0x5a692d=a1_0x1122,_0x2f1246=_0x40b4a1();while(!![]){try{const _0x380b23=-parseInt(_0x5a692d(0x17b))/0x1*(parseInt(_0x5a692d(0x192))/0x2)+-parseInt(_0x5a692d(0x1f6))/0x3+-parseInt(_0x5a692d(0x214))/0x4+-parseInt(_0x5a692d(0x227))/0x5*(parseInt(_0x5a692d(0x21e))/0x6)+-parseInt(_0x5a692d(0x1af))/0x7+-parseInt(_0x5a692d(0x1d3))/0x8+parseInt(_0x5a692d(0x177))/0x9*(parseInt(_0x5a692d(0x1ad))/0xa);if(_0x380b23===_0x18b99a)break;else _0x2f1246['push'](_0x2f1246['shift']());}catch(_0x28635d){_0x2f1246['push'](_0x2f1246['shift']());}}}(a1_0x3691,0xe0c5a));const a1_0x5f53e8=(function(){let _0x2380d9=!![];return function(_0x952ba6,_0x3677c2){const _0x1915e1=_0x2380d9?function(){const _0x4a5f10=a1_0x1122;if(_0x3677c2){const _0x17c24c=_0x3677c2[_0x4a5f10(0x1c9)](_0x952ba6,arguments);return _0x3677c2=null,_0x17c24c;}}:function(){};return _0x2380d9=![],_0x1915e1;};}()),a1_0x1a8ceb=a1_0x5f53e8(this,function(){const _0x27ab28=a1_0x1122;return a1_0x1a8ceb['toString']()[_0x27ab28(0x1f2)](_0x27ab28(0x21c))[_0x27ab28(0x1a2)]()[_0x27ab28(0x1ae)](a1_0x1a8ceb)[_0x27ab28(0x1f2)](_0x27ab28(0x21c));});a1_0x1a8ceb();'use strict';function a1_0x3691(){const _0x471055=['exports','[FORCE]\x20','useCalendar','analysis.energy.warmupTargets','_calName','analysis.automation.confidenceThreshold','length','until','ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','setpoint','error','search','\x20auf\x20','switch','Calendar\x20Check\x20Error:\x20','465648ipvIHH','abs','ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20','\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.','dimmer','\x20ist\x20auf\x20','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20','valve','rÃ¼ckkehr','level','_date','find','sort','ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','analysis.energy.ventilationAlerts','analysis.energy.warmupSources','ist','name','triggerTime','hm-rpc','target_temperature','.1.ACTUAL_TEMPERATURE','config','sensor','unit','splice','type','analysis.energy.warmupTimes','Â°C\x20(nicht\x20','parse','179088DXWYTr','analysis.energy.schedulePreview','write','ðŸ“…\x20SMART\x20SCHEDULE\x20[','state','ACTUAL','.4.VALVE_STATE','warn','(((.+)+)+)+$','getTime','9583482FTJneF',')\x20aktiv.\x20Heize\x20auf\x20','mpc_','isArray','Nicht\x20gefunden','calendarInstance','calendarSelection','common','analysis.energy.mpcActiveInterventions','5XIKLne','remove','getForeignStateAsync','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','pi_heating_demand','score','findIndex','default','entries','[CAL]\x20','analysis.automation.lastAction','\x27\x20(Match:\x20','string','cal_','ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27','sendToPythonWrapper','1500489PDZlXE','Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','Manuelles\x20Mapping','7mvZVOh','log','Ist','\x20min)','stringify','\x20wieder\x20auf\x20','urlaub\x20ende','includes','wert','thermostatMapping','forEach','valveMapping','.1.TEMPERATURE','localeCompare','Â°C!\x20(Puffer:\x20','\x20erreicht\x20Limit\x20(','indexOf','\x20wurde\x20manuell\x20erhÃ¶ht.','now','level.valve','getStateAsync','\x20gefunden!','too_cold','317336VTrVtE','ankunft','val','date','info','Â°C).\x20Sparmodus\x20beendet!','Â°C\x20(Vorlauf:\x20','analysis.energy.rlPenalties','analysis.automation.actionLog','summary','active','Unknown',']:\x20Raum-Trigger\x20\x27','off','Â°C).\x20Entferne\x20Status.','add','toString','contact','SET_POINT_TEMPERATURE','_meta','TRAIN_RL_PENALTY','target','local_temperature','Auto-Erkennung','open','split','valve_position','290rerPvo','constructor','2293942kjtieU','manual','temperature','rescue_','ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20','.data.table','event','slice','values','room','Classic','actual','toLowerCase','thermostat',':\x20Absenkung\x20auf\x20','ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','join','.4.SET_TEMPERATURE','[WATCHDOG]\x20','unshift','filter','normal','level.temperature','devices','Â°C\x20(via\x20','ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','apply','analysis.energy.activeEnforcements','setStateAsync','[MPC]\x20','getHours','consultButler','Â°C!\x20(Puffer\x20leer).','ACTUAL_TEMPERATURE','./ai_agent','PrÃ¤diktion:\x20','5429008DBhhoU','set','map','setForeignStateAsync','value.valve','role','currentSystemMode',':\x20Aufheizen\x20auf\x20','number','\x20min).','eventStart','ðŸ“…\x20[MPC\x20INFO]\x20','.1.LEVEL','message','push','SET','.1.SET_POINT_TEMPERATURE','Unbekannt','thermostat.setpoint','location'];a1_0x3691=function(){return _0x471055;};return a1_0x3691();}const aiAgent=require(a1_0x392085(0x1d1)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x11a310){const _0x23e21d=a1_0x392085;if(!_0x11a310)return'';return _0x11a310[_0x23e21d(0x1bb)]()['replace'](/\s+/g,'')['trim']();}async function logAutomationAction(_0x4a56bd,_0x36e765){const _0x8bee15=a1_0x392085;await _0x4a56bd['setStateAsync'](_0x8bee15(0x231),{'val':_0x36e765,'ack':!![]});try{const _0x203274=_0x8bee15(0x19a),_0x5cd45c=await _0x4a56bd[_0x8bee15(0x18f)](_0x203274);let _0x382460=[];if(_0x5cd45c&&_0x5cd45c['val'])try{_0x382460=JSON[_0x8bee15(0x213)](_0x5cd45c[_0x8bee15(0x194)]);}catch(_0x2f1a87){}_0x382460[_0x8bee15(0x1c2)]({'ts':Date[_0x8bee15(0x18d)](),'msg':_0x36e765});if(_0x382460[_0x8bee15(0x1ed)]>0x32)_0x382460=_0x382460[_0x8bee15(0x1b6)](0x0,0x32);await _0x4a56bd[_0x8bee15(0x1cb)](_0x203274,{'val':JSON[_0x8bee15(0x17f)](_0x382460),'ack':!![]});}catch(_0xc38b56){}}function a1_0x1122(_0x23adae,_0x260763){const _0x3ef6ca=a1_0x3691();return a1_0x1122=function(_0x1a8ceb,_0x5f53e8){_0x1a8ceb=_0x1a8ceb-0x173;let _0x3691bb=_0x3ef6ca[_0x1a8ceb];return _0x3691bb;},a1_0x1122(_0x23adae,_0x260763);}async function handlePrediction(_0x2e86a4,_0x5c4c83,_0x2a3b3e){const _0x4a9561=a1_0x392085;if(!_0x5c4c83||_0x5c4c83===_0x4a9561(0x19d))return;let _0x54afb1='off',_0xd6a64e=0.6;try{const _0x27a9f8=await _0x2e86a4['getStateAsync']('analysis.automation.mode');if(_0x27a9f8&&_0x27a9f8['val'])_0x54afb1=_0x27a9f8['val'];const _0x42b272=await _0x2e86a4[_0x4a9561(0x18f)](_0x4a9561(0x1ec));if(_0x42b272&&_0x42b272[_0x4a9561(0x194)])_0xd6a64e=_0x42b272[_0x4a9561(0x194)];}catch(_0x1f53c){}if(_0x54afb1===_0x4a9561(0x19f)||_0x2a3b3e<_0xd6a64e)return;const _0x2c6725=Date[_0x4a9561(0x18d)]();if(lastActions[_0x5c4c83]&&_0x2c6725-lastActions[_0x5c4c83]<COOLDOWN_MS)return;const _0x2a5ecb=_0x2e86a4[_0x4a9561(0x20c)][_0x4a9561(0x1c6)]||[],_0x5aaa0b=normalize(_0x5c4c83),_0x3617ee=_0x2a5ecb['find'](_0x5a7259=>normalize(_0x5a7259['location'])===_0x5aaa0b&&(_0x5a7259[_0x4a9561(0x210)]==='light'||_0x5a7259[_0x4a9561(0x210)]===_0x4a9561(0x1fa)||_0x5a7259['type']===_0x4a9561(0x1f4)));if(!_0x3617ee)return;const _0x36b0ce=await aiAgent[_0x4a9561(0x1ce)](_0x2e86a4,_0x5c4c83,_0x3617ee[_0x4a9561(0x207)],_0x2a3b3e);if(!_0x36b0ce['approved'])return;const _0x5728e2=_0x4a9561(0x1d2)+_0x5c4c83+'\x20->\x20Schalte\x20'+_0x3617ee[_0x4a9561(0x207)]+'\x20('+_0x36b0ce['reason']+')';await logAutomationAction(_0x2e86a4,'['+_0x54afb1['toUpperCase']()+']\x20'+_0x5728e2);if(_0x54afb1===_0x4a9561(0x19c)){const _0x5aad3f=await _0x2e86a4[_0x4a9561(0x229)](_0x3617ee['id']);(!_0x5aad3f||!_0x5aad3f[_0x4a9561(0x194)]&&_0x5aad3f[_0x4a9561(0x194)]!==!![])&&await _0x2e86a4[_0x4a9561(0x1d6)](_0x3617ee['id'],!![]),lastActions[_0x5c4c83]=_0x2c6725;}}async function findRelatedId(_0x4a77ce,_0x227594,_0x1e1d24='setpoint'){const _0x4ffa06=a1_0x392085;if(_0x1e1d24==='setpoint'&&_0x4a77ce[_0x4ffa06(0x20c)][_0x4ffa06(0x184)]){let _0x5a60f4=_0x4a77ce[_0x4ffa06(0x20c)][_0x4ffa06(0x184)];if(typeof _0x5a60f4===_0x4ffa06(0x173))try{_0x5a60f4=JSON[_0x4ffa06(0x213)](_0x5a60f4);}catch(_0x2ed833){}if(_0x5a60f4&&_0x5a60f4[_0x227594])return _0x5a60f4[_0x227594];}if(_0x1e1d24===_0x4ffa06(0x1fd)&&_0x4a77ce['config'][_0x4ffa06(0x186)]){let _0x43dfde=_0x4a77ce[_0x4ffa06(0x20c)][_0x4ffa06(0x186)];if(typeof _0x43dfde===_0x4ffa06(0x173))try{_0x43dfde=JSON['parse'](_0x43dfde);}catch(_0x1a5381){}if(_0x43dfde&&_0x43dfde[_0x227594])return _0x43dfde[_0x227594];}let _0x3c7db3=[];if(_0x1e1d24===_0x4ffa06(0x1f0))_0x3c7db3=[{'s':_0x4ffa06(0x20b),'t':_0x4ffa06(0x1e3)},{'s':'.1.TEMPERATURE','t':_0x4ffa06(0x1e3)},{'s':'.1.TEMPERATURE','t':_0x4ffa06(0x1c0)},{'s':_0x4ffa06(0x1d0),'t':_0x4ffa06(0x1a4)},{'s':'local_temperature','t':'occupied_heating_setpoint'},{'s':_0x4ffa06(0x1a8),'t':'current_heating_setpoint'},{'s':_0x4ffa06(0x1b1),'t':_0x4ffa06(0x20a)},{'s':_0x4ffa06(0x219),'t':_0x4ffa06(0x1e2)},{'s':_0x4ffa06(0x17d),'t':'Soll'},{'s':_0x4ffa06(0x1b1),'t':_0x4ffa06(0x1f0)}];else _0x1e1d24===_0x4ffa06(0x1fd)&&(_0x3c7db3=[{'s':_0x4ffa06(0x20b),'t':_0x4ffa06(0x1df)},{'s':_0x4ffa06(0x187),'t':_0x4ffa06(0x1df)},{'s':_0x4ffa06(0x187),'t':_0x4ffa06(0x21a)},{'s':'local_temperature','t':_0x4ffa06(0x22b)},{'s':_0x4ffa06(0x1b1),'t':_0x4ffa06(0x1ac)},{'s':_0x4ffa06(0x1b1),'t':_0x4ffa06(0x1ff)}]);for(const _0x2ad5c3 of _0x3c7db3){if(_0x227594[_0x4ffa06(0x182)](_0x2ad5c3['s'])){const _0x3d37fd=_0x227594['replace'](_0x2ad5c3['s'],_0x2ad5c3['t']),_0x4af549=await _0x4a77ce['getForeignObjectAsync'](_0x3d37fd);if(_0x4af549)return _0x3d37fd;}}try{const _0xf2c592=_0x227594[_0x4ffa06(0x1ab)]('.');if(_0xf2c592[_0x4ffa06(0x1ed)]>0x2){const _0x5b2839=_0xf2c592[_0x4ffa06(0x1b6)](0x0,-0x1)[_0x4ffa06(0x1bf)]('.'),_0x1af598=await _0x4a77ce['getForeignObjectsAsync'](_0x5b2839+'.*'),_0x5a12ec=[],_0x101283=_0x227594[_0x4ffa06(0x1ab)](/[._]+/)[_0x4ffa06(0x1c3)](_0xe6b64=>!['openknx','0',_0x4ffa06(0x209),_0x4ffa06(0x206),_0x4ffa06(0x183),_0x4ffa06(0x1b1),_0x4ffa06(0x1ba),_0x4ffa06(0x20d),'messwert',_0x4ffa06(0x218)]['includes'](_0xe6b64[_0x4ffa06(0x1bb)]()));for(const [_0x204aad,_0x18a40c]of Object['entries'](_0x1af598)){if(_0x204aad===_0x227594)continue;if(_0x18a40c&&_0x18a40c['common']){const _0x54297d=_0x204aad[_0x4ffa06(0x1bb)](),_0x13e797=(_0x18a40c['common'][_0x4ffa06(0x1d8)]||'')[_0x4ffa06(0x1bb)](),_0x5bd9a4=(_0x18a40c[_0x4ffa06(0x225)][_0x4ffa06(0x20e)]||'')[_0x4ffa06(0x1bb)]();let _0x4e82ab=![];if(_0x1e1d24==='setpoint'&&_0x18a40c[_0x4ffa06(0x225)][_0x4ffa06(0x216)]===!![])_0x4e82ab=_0x54297d[_0x4ffa06(0x182)](_0x4ffa06(0x1d4))||_0x54297d[_0x4ffa06(0x182)]('soll')||_0x54297d['includes'](_0x4ffa06(0x1a7))||_0x13e797['includes'](_0x4ffa06(0x1c5))||_0x13e797[_0x4ffa06(0x182)](_0x4ffa06(0x1e5));else _0x1e1d24===_0x4ffa06(0x1fd)&&(_0x4e82ab=_0x54297d[_0x4ffa06(0x182)](_0x4ffa06(0x1ff))||_0x54297d[_0x4ffa06(0x182)](_0x4ffa06(0x1fd))||_0x54297d['includes']('stellwert')||_0x54297d[_0x4ffa06(0x182)]('position')||_0x13e797[_0x4ffa06(0x182)](_0x4ffa06(0x18e))||_0x13e797[_0x4ffa06(0x182)](_0x4ffa06(0x1d7))||_0x5bd9a4[_0x4ffa06(0x182)]('%'));if(_0x4e82ab){const _0x589f8e=_0x204aad[_0x4ffa06(0x1ab)](/[._]+/)[_0x4ffa06(0x1d5)](_0x59ef69=>_0x59ef69[_0x4ffa06(0x1bb)]());let _0x1927c6=0x0;_0x101283[_0x4ffa06(0x185)](_0x6aafa3=>{const _0x4f4a3b=_0x4ffa06;if(_0x589f8e['includes'](_0x6aafa3[_0x4f4a3b(0x1bb)]()))_0x1927c6++;}),_0x5a12ec['push']({'id':_0x204aad,'score':_0x1927c6});}}}if(_0x5a12ec[_0x4ffa06(0x1ed)]>0x0){_0x5a12ec[_0x4ffa06(0x202)]((_0x62c97b,_0x429816)=>_0x429816[_0x4ffa06(0x22c)]-_0x62c97b[_0x4ffa06(0x22c)]);if(_0x5a12ec[0x0][_0x4ffa06(0x22c)]>0x0)return _0x5a12ec[0x0]['id'];}}}catch(_0x2bc224){}return null;}async function scanThermostats(_0x25c620){const _0x459154=a1_0x392085,_0x16c540=_0x25c620[_0x459154(0x20c)][_0x459154(0x1c6)]||[],_0x27b806=[],_0x79f456=_0x16c540[_0x459154(0x1c3)](_0x221dfa=>_0x221dfa['id']&&_0x221dfa['id']['includes'](_0x459154(0x1b1))||_0x221dfa['type']&&[_0x459154(0x1b1),_0x459154(0x1bc),_0x459154(0x20d)][_0x459154(0x182)](_0x221dfa[_0x459154(0x210)])||_0x221dfa[_0x459154(0x207)]&&_0x221dfa['name'][_0x459154(0x1bb)]()[_0x459154(0x182)]('temp'));for(const _0x26297f of _0x79f456){const _0x2c9ca2=await findRelatedId(_0x25c620,_0x26297f['id'],_0x459154(0x1f0)),_0x4c9df1=await findRelatedId(_0x25c620,_0x26297f['id'],_0x459154(0x1fd));let _0x292741=_0x459154(0x222),_0x2bf5d7=![],_0x2203f0=_0x25c620[_0x459154(0x20c)][_0x459154(0x184)]||{};if(typeof _0x2203f0===_0x459154(0x173))try{_0x2203f0=JSON['parse'](_0x2203f0);}catch(_0x1bb3b4){}let _0x5da384=_0x25c620[_0x459154(0x20c)][_0x459154(0x186)]||{};if(typeof _0x5da384===_0x459154(0x173))try{_0x5da384=JSON[_0x459154(0x213)](_0x5da384);}catch(_0x3e9dc6){}if(_0x2203f0[_0x26297f['id']]&&_0x2203f0[_0x26297f['id']]===_0x2c9ca2||_0x5da384[_0x26297f['id']]&&_0x5da384[_0x26297f['id']]===_0x4c9df1)_0x292741=_0x459154(0x17a),_0x2bf5d7=!![];else(_0x2c9ca2||_0x4c9df1)&&(_0x292741=_0x459154(0x1a9));_0x27b806[_0x459154(0x1e1)]({'room':_0x26297f[_0x459154(0x1e6)]||_0x459154(0x1e4),'sensorId':_0x26297f['id'],'setpointId':_0x2c9ca2||'-','valveId':_0x4c9df1||'-','source':_0x292741,'isManual':_0x2bf5d7,'status':_0x2c9ca2&&_0x4c9df1?'PERFECT':_0x2c9ca2?'OK':'Fehlt'});}return _0x27b806[_0x459154(0x202)]((_0x56f6a7,_0x3a73e2)=>_0x56f6a7['room'][_0x459154(0x188)](_0x3a73e2[_0x459154(0x1b8)]));}async function updateSchedulePreview(_0x227127){const _0x170608=a1_0x392085;if(!_0x227127[_0x170608(0x20c)]['useCalendar']||!_0x227127[_0x170608(0x20c)][_0x170608(0x223)])return;let _0x61aea4={};try{const _0x2388c1=await _0x227127[_0x170608(0x18f)](_0x170608(0x211));if(_0x2388c1&&_0x2388c1[_0x170608(0x194)])_0x61aea4=JSON[_0x170608(0x213)](_0x2388c1['val']);}catch(_0x4c518c){}const _0x3ae15d=[],_0x4f840a=Date[_0x170608(0x18d)](),_0x3d2c4f=0x30*0x3c*0x3c*0x3e8;try{const _0xbc9faf=await _0x227127[_0x170608(0x229)](_0x227127[_0x170608(0x20c)][_0x170608(0x223)]+_0x170608(0x1b4));if(!_0xbc9faf||!_0xbc9faf['val'])return;const _0x10b5b1=JSON[_0x170608(0x213)](_0xbc9faf[_0x170608(0x194)]),_0x59cbf2=_0x227127['config'][_0x170608(0x224)]||[],_0x2b8b91=_0x227127[_0x170608(0x20c)]['devices']||[],_0x3dfc5a=new Set();_0x2b8b91[_0x170608(0x185)](_0x59c513=>{const _0x4bf7ab=_0x170608;if(_0x59c513[_0x4bf7ab(0x1e6)])_0x3dfc5a[_0x4bf7ab(0x1a1)](_0x59c513[_0x4bf7ab(0x1e6)]);});for(const _0x4c829c of _0x10b5b1){if(_0x4c829c[_0x170608(0x1eb)]&&_0x59cbf2['length']>0x0&&!_0x59cbf2[_0x170608(0x182)](_0x4c829c[_0x170608(0x1eb)]))continue;const _0x20ee91=_0x4c829c[_0x170608(0x200)]||_0x4c829c[_0x170608(0x1dd)]||_0x4c829c[_0x170608(0x195)];if(!_0x20ee91)continue;const _0x982f73=new Date(_0x20ee91),_0x4b6b62=_0x982f73[_0x170608(0x21d)]();if(isNaN(_0x4b6b62))continue;if(_0x4b6b62<_0x4f840a)continue;if(_0x4b6b62>_0x4f840a+_0x3d2c4f)continue;const _0x4e88a=(_0x4c829c[_0x170608(0x1b5)]||_0x4c829c[_0x170608(0x19b)]||'')[_0x170608(0x1bb)]();let _0x19ef81=![],_0x5a4c9f=[],_0x56d56e=_0x4c829c[_0x170608(0x1b5)]||_0x4c829c[_0x170608(0x19b)]||_0x170608(0x1e4);if(_0x4e88a[_0x170608(0x182)](_0x170608(0x181))||_0x4e88a[_0x170608(0x182)](_0x170608(0x1fe))||_0x4e88a[_0x170608(0x182)](_0x170608(0x193)))_0x19ef81=!![],_0x5a4c9f=Array['from'](_0x3dfc5a);else for(const _0x24c489 of _0x3dfc5a){if(_0x4e88a[_0x170608(0x182)](_0x24c489[_0x170608(0x1bb)]()))_0x5a4c9f['push'](_0x24c489);}_0x5a4c9f[_0x170608(0x1ed)]>0x0&&_0x5a4c9f['forEach'](_0xec128d=>{const _0x25bbe0=_0x170608;let _0x3b81f3=0x3c;if(_0x19ef81){let _0x134700=0x0;Object[_0x25bbe0(0x1b7)](_0x61aea4)[_0x25bbe0(0x185)](_0x1fc94f=>{if(_0x1fc94f>_0x134700)_0x134700=_0x1fc94f;}),_0x3b81f3=_0x134700>0x0?_0x134700:0x78;}else _0x3b81f3=_0x61aea4[_0xec128d]||0x3c;const _0x546abd=new Date(_0x4b6b62-_0x3b81f3*0xea60);_0x3ae15d[_0x25bbe0(0x1e1)]({'eventTime':_0x4b6b62,'triggerTime':_0x546abd['getTime'](),'room':_0xec128d,'minutes':_0x3b81f3,'reason':_0x56d56e,'isGlobal':_0x19ef81});});}}catch(_0x207a0a){}_0x3ae15d[_0x170608(0x202)]((_0x4d55c5,_0x2452b4)=>_0x4d55c5[_0x170608(0x208)]-_0x2452b4[_0x170608(0x208)]);const _0x278b5f=_0x3ae15d[_0x170608(0x1b6)](0x0,0x5);await _0x227127['setStateAsync'](_0x170608(0x215),{'val':JSON[_0x170608(0x17f)](_0x278b5f),'ack':!![]});}async function monitorEnforcements(_0x151dd7){const _0x578d5e=a1_0x392085;try{const _0x35e97f=_0x578d5e(0x1ca),_0x121574=await _0x151dd7['getStateAsync'](_0x35e97f);if(!_0x121574||!_0x121574[_0x578d5e(0x194)])return;let _0x134131=[];try{_0x134131=JSON[_0x578d5e(0x213)](_0x121574[_0x578d5e(0x194)]);}catch(_0x57eb89){return;}if(!Array[_0x578d5e(0x221)](_0x134131)||_0x134131[_0x578d5e(0x1ed)]===0x0)return;const _0xe750ec=Date[_0x578d5e(0x18d)](),_0x31cde0=_0x151dd7[_0x578d5e(0x20c)]['devices']||[];let _0x1250d6=![];for(let _0x4ac737=_0x134131[_0x578d5e(0x1ed)]-0x1;_0x4ac737>=0x0;_0x4ac737--){const _0x29480d=_0x134131[_0x4ac737];if(_0xe750ec>=_0x29480d[_0x578d5e(0x1ee)]){_0x151dd7[_0x578d5e(0x17c)][_0x578d5e(0x196)](_0x578d5e(0x1ef)+_0x29480d[_0x578d5e(0x1b8)]+'\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.'),_0x134131[_0x578d5e(0x20f)](_0x4ac737,0x1),_0x1250d6=!![];continue;}const _0x30c1fd=_0x31cde0[_0x578d5e(0x201)](_0x476c0e=>normalize(_0x476c0e[_0x578d5e(0x1e6)])===normalize(_0x29480d[_0x578d5e(0x1b8)])&&(_0x476c0e[_0x578d5e(0x210)]===_0x578d5e(0x1b1)||_0x476c0e[_0x578d5e(0x210)]===_0x578d5e(0x1bc)));if(_0x30c1fd){const _0xd28680=await findRelatedId(_0x151dd7,_0x30c1fd['id'],_0x578d5e(0x1f0));if(_0xd28680){const _0x44a1e6=await _0x151dd7[_0x578d5e(0x229)](_0xd28680);_0x44a1e6&&typeof _0x44a1e6[_0x578d5e(0x194)]==='number'&&(_0x44a1e6[_0x578d5e(0x194)]<0xf&&(_0x151dd7['log'][_0x578d5e(0x21b)](_0x578d5e(0x1c8)+_0x29480d['room']+_0x578d5e(0x1f3)+_0x44a1e6['val']+_0x578d5e(0x178)+_0x29480d['target']+'Â°C.'),await _0x151dd7[_0x578d5e(0x1d6)](_0xd28680,_0x29480d[_0x578d5e(0x1a7)]),await logAutomationAction(_0x151dd7,_0x578d5e(0x1e8)+_0x29480d[_0x578d5e(0x1b8)]+':\x20'+_0x44a1e6['val']+'Â°C\x20->\x20'+_0x29480d[_0x578d5e(0x1a7)]+'Â°C\x20(Kalender-Schutz)')));}}}_0x1250d6&&await _0x151dd7[_0x578d5e(0x1cb)](_0x35e97f,{'val':JSON[_0x578d5e(0x17f)](_0x134131),'ack':!![]});}catch(_0x4f2406){_0x151dd7[_0x578d5e(0x17c)][_0x578d5e(0x1f1)]('Enforcement\x20Monitor\x20Error:\x20'+_0x4f2406[_0x578d5e(0x1e0)]);}}async function checkCalendarTriggers(_0x40c9ac){const _0x16fdb3=a1_0x392085;if(!_0x40c9ac['config'][_0x16fdb3(0x1e9)]||!_0x40c9ac[_0x16fdb3(0x20c)][_0x16fdb3(0x223)])return;await updateSchedulePreview(_0x40c9ac);let _0x1d2e40={},_0x4737d0={};try{const _0x2ca1ae=await _0x40c9ac[_0x16fdb3(0x18f)](_0x16fdb3(0x211));if(_0x2ca1ae&&_0x2ca1ae[_0x16fdb3(0x194)])_0x1d2e40=JSON['parse'](_0x2ca1ae[_0x16fdb3(0x194)]);const _0x521b6f=await _0x40c9ac[_0x16fdb3(0x18f)](_0x16fdb3(0x205));if(_0x521b6f&&_0x521b6f[_0x16fdb3(0x194)])_0x4737d0=JSON[_0x16fdb3(0x213)](_0x521b6f[_0x16fdb3(0x194)]);}catch(_0x5bb5b6){}let _0x5ec031={'default':0x15};try{const _0x252e99=await _0x40c9ac[_0x16fdb3(0x18f)](_0x16fdb3(0x1ea));if(_0x252e99&&_0x252e99[_0x16fdb3(0x194)])_0x5ec031=JSON[_0x16fdb3(0x213)](_0x252e99[_0x16fdb3(0x194)]);}catch(_0x1eceee){}let _0x207f69=[];try{const _0x33f306=await _0x40c9ac['getStateAsync'](_0x16fdb3(0x1ca));if(_0x33f306&&_0x33f306['val'])_0x207f69=JSON[_0x16fdb3(0x213)](_0x33f306[_0x16fdb3(0x194)]);}catch(_0x4850c8){}try{const _0x1e6af7=await _0x40c9ac['getForeignStateAsync'](_0x40c9ac[_0x16fdb3(0x20c)][_0x16fdb3(0x223)]+_0x16fdb3(0x1b4));if(!_0x1e6af7||!_0x1e6af7[_0x16fdb3(0x194)])return;const _0x5525f1=JSON[_0x16fdb3(0x213)](_0x1e6af7[_0x16fdb3(0x194)]),_0x561dd3=Date[_0x16fdb3(0x18d)](),_0xb1ba53=_0x40c9ac[_0x16fdb3(0x20c)][_0x16fdb3(0x1c6)]||[],_0xc3cbd1=_0x40c9ac['config'][_0x16fdb3(0x224)]||[];let _0x5460ab=![];for(const _0xa69ce7 of _0x5525f1){if(_0xa69ce7[_0x16fdb3(0x1eb)]&&_0xc3cbd1[_0x16fdb3(0x1ed)]>0x0&&!_0xc3cbd1[_0x16fdb3(0x182)](_0xa69ce7['_calName']))continue;const _0x505af4=_0xa69ce7[_0x16fdb3(0x200)]||_0xa69ce7[_0x16fdb3(0x1dd)]||_0xa69ce7[_0x16fdb3(0x195)];if(!_0x505af4)continue;const _0x49e16a=new Date(_0x505af4);if(isNaN(_0x49e16a[_0x16fdb3(0x21d)]()))continue;const _0x984530=(_0xa69ce7[_0x16fdb3(0x1b5)]||_0xa69ce7[_0x16fdb3(0x19b)]||'')[_0x16fdb3(0x1bb)]();if(_0x984530[_0x16fdb3(0x182)](_0x16fdb3(0x181))||_0x984530[_0x16fdb3(0x182)]('rÃ¼ckkehr')||_0x984530[_0x16fdb3(0x182)]('ankunft')){let _0x54b1f2=0x0;Object[_0x16fdb3(0x1b7)](_0x1d2e40)['forEach'](_0x28b3c2=>{if(_0x28b3c2>_0x54b1f2)_0x54b1f2=_0x28b3c2;});if(_0x54b1f2===0x0)_0x54b1f2=0x78;const _0x301528=_0x49e16a[_0x16fdb3(0x21d)]()-_0x54b1f2*0xea60;_0x561dd3>=_0x301528&&_0x561dd3<_0x49e16a['getTime']()&&(_0x40c9ac[_0x16fdb3(0x1d9)]!==_0x16fdb3(0x1c4)&&(_0x40c9ac[_0x16fdb3(0x17c)][_0x16fdb3(0x196)]('ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20'+_0x54b1f2+_0x16fdb3(0x1dc)),await _0x40c9ac[_0x16fdb3(0x1cb)]('system.mode',{'val':_0x16fdb3(0x1c4),'ack':![]})));}for(const _0xd71437 of _0xb1ba53){if(_0xd71437[_0x16fdb3(0x1e6)]){const _0xd71c52=_0xd71437[_0x16fdb3(0x1e6)][_0x16fdb3(0x1bb)](),_0x5acaa2=(_0xd71437[_0x16fdb3(0x207)]||'')[_0x16fdb3(0x1bb)]();let _0x3b8c53=_0x984530[_0x16fdb3(0x182)](_0xd71c52);!_0x3b8c53&&_0x5acaa2['length']>0x3&&_0x984530['includes'](_0x5acaa2)&&(_0x3b8c53=!![]);if(_0x3b8c53){const _0x453ccb=_0x1d2e40[_0xd71437[_0x16fdb3(0x1e6)]]||0x3c,_0x35c669=_0x4737d0[_0xd71437[_0x16fdb3(0x1e6)]]||_0x16fdb3(0x1b9),_0x292344=_0x49e16a[_0x16fdb3(0x21d)]()-_0x453ccb*0xea60;if(_0x561dd3>=_0x292344&&_0x561dd3<_0x49e16a['getTime']()){const _0x4a1d43=lastActions['cal_'+_0xd71437[_0x16fdb3(0x1e6)]];if(_0x4a1d43&&_0x561dd3-_0x4a1d43<CAL_COOLDOWN_MS)continue;const _0x5d9b1b=await findRelatedId(_0x40c9ac,_0xd71437['id'],'setpoint');if(_0x5d9b1b){let _0x5bea34=_0x5ec031[_0xd71437[_0x16fdb3(0x1e6)]];if(_0x5bea34===undefined)_0x5bea34=_0x5ec031[_0x16fdb3(0x22e)];if(_0x5bea34===undefined)_0x5bea34=0x15;const _0x277db7=await _0x40c9ac['getForeignStateAsync'](_0x5d9b1b);if(_0x277db7&&typeof _0x277db7[_0x16fdb3(0x194)]===_0x16fdb3(0x1db)&&_0x277db7[_0x16fdb3(0x194)]<_0x5bea34-0.5){_0x40c9ac['log'][_0x16fdb3(0x196)](_0x16fdb3(0x217)+_0x35c669+_0x16fdb3(0x19e)+_0xd71437['location']+_0x16fdb3(0x232)+_0x984530+_0x16fdb3(0x21f)+_0x5bea34+_0x16fdb3(0x198)+_0x453ccb+_0x16fdb3(0x1dc)),await _0x40c9ac[_0x16fdb3(0x1d6)](_0x5d9b1b,_0x5bea34),await logAutomationAction(_0x40c9ac,_0x16fdb3(0x230)+_0xd71437[_0x16fdb3(0x1e6)]+'\x20->\x20'+_0x5bea34+_0x16fdb3(0x1c7)+_0x35c669+')'),lastActions[_0x16fdb3(0x174)+_0xd71437[_0x16fdb3(0x1e6)]]=_0x561dd3;const _0x1b1e83=_0x207f69[_0x16fdb3(0x22d)](_0x2aba15=>_0x2aba15[_0x16fdb3(0x1b8)]===_0xd71437[_0x16fdb3(0x1e6)]);if(_0x1b1e83!==-0x1)_0x207f69[_0x16fdb3(0x20f)](_0x1b1e83,0x1);_0x207f69[_0x16fdb3(0x1e1)]({'room':_0xd71437[_0x16fdb3(0x1e6)],'target':_0x5bea34,'until':_0x49e16a['getTime']()}),_0x5460ab=!![];}}}}}}}_0x5460ab&&await _0x40c9ac[_0x16fdb3(0x1cb)]('analysis.energy.activeEnforcements',{'val':JSON[_0x16fdb3(0x17f)](_0x207f69),'ack':!![]});}catch(_0x5beef6){_0x40c9ac['log']['warn'](_0x16fdb3(0x1f5)+_0x5beef6[_0x16fdb3(0x1e0)]);}}async function manageMpcIntervention(_0x60c216,_0x4976de,_0x5af0e1){const _0x2fca2e=a1_0x392085;try{const _0x2b22a0=_0x2fca2e(0x226),_0x2a4997=await _0x60c216[_0x2fca2e(0x18f)](_0x2b22a0);let _0x521e0e=[];if(_0x2a4997&&_0x2a4997[_0x2fca2e(0x194)])try{_0x521e0e=JSON[_0x2fca2e(0x213)](_0x2a4997[_0x2fca2e(0x194)]);}catch(_0x3ba991){}const _0x4a5b49=_0x521e0e[_0x2fca2e(0x18b)](_0x4976de);if(_0x5af0e1==='add')_0x4a5b49===-0x1&&(_0x521e0e[_0x2fca2e(0x1e1)](_0x4976de),await _0x60c216[_0x2fca2e(0x1cb)](_0x2b22a0,{'val':JSON['stringify'](_0x521e0e),'ack':!![]}));else _0x5af0e1===_0x2fca2e(0x228)&&(_0x4a5b49!==-0x1&&(_0x521e0e[_0x2fca2e(0x20f)](_0x4a5b49,0x1),await _0x60c216[_0x2fca2e(0x1cb)](_0x2b22a0,{'val':JSON[_0x2fca2e(0x17f)](_0x521e0e),'ack':!![]})));}catch(_0x21ddd0){}}async function cleanupGhostInterventions(_0x1a7aab){const _0x5ca1f3=a1_0x392085;try{const _0x3b3c73=_0x5ca1f3(0x226),_0x1da823=await _0x1a7aab[_0x5ca1f3(0x18f)](_0x3b3c73);if(!_0x1da823||!_0x1da823[_0x5ca1f3(0x194)])return;const _0x5e8561=JSON[_0x5ca1f3(0x213)](_0x1da823[_0x5ca1f3(0x194)]);if(!Array[_0x5ca1f3(0x221)](_0x5e8561)||_0x5e8561['length']===0x0)return;let _0x301cd6={'default':0x15};try{const _0x42a1ae=await _0x1a7aab[_0x5ca1f3(0x18f)](_0x5ca1f3(0x1ea));if(_0x42a1ae&&_0x42a1ae[_0x5ca1f3(0x194)])_0x301cd6=JSON['parse'](_0x42a1ae[_0x5ca1f3(0x194)]);}catch(_0x5c5a94){}let _0x4b511a=[];try{const _0x36c255=await _0x1a7aab['getStateAsync'](_0x5ca1f3(0x204));if(_0x36c255&&_0x36c255[_0x5ca1f3(0x194)])_0x4b511a=JSON[_0x5ca1f3(0x213)](_0x36c255[_0x5ca1f3(0x194)]);}catch(_0x1339f1){}let _0x442442={},_0x1093f7=![];try{const _0x49f95f=await _0x1a7aab[_0x5ca1f3(0x18f)](_0x5ca1f3(0x199));if(_0x49f95f&&_0x49f95f['val'])_0x442442=JSON[_0x5ca1f3(0x213)](_0x49f95f[_0x5ca1f3(0x194)]);}catch(_0x866309){}if(_0x442442[_0x5ca1f3(0x1a5)]){const _0x38f90f=Date[_0x5ca1f3(0x18d)]();for(const [_0x41b91e,_0x1fcfb0]of Object[_0x5ca1f3(0x22f)](_0x442442[_0x5ca1f3(0x1a5)])){_0x38f90f-_0x1fcfb0>PENALTY_TTL&&(delete _0x442442[_0x41b91e],delete _0x442442['_meta'][_0x41b91e],_0x1093f7=!![],_0x1a7aab[_0x5ca1f3(0x17c)][_0x5ca1f3(0x196)](_0x5ca1f3(0x175)+_0x41b91e+'\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.'));}}const _0x2175ca=_0x1a7aab[_0x5ca1f3(0x20c)]['devices']||[];let _0x504ca7=![];for(let _0x2e4277=_0x5e8561[_0x5ca1f3(0x1ed)]-0x1;_0x2e4277>=0x0;_0x2e4277--){const _0x127825=_0x5e8561[_0x2e4277],_0x3018c3=_0x2175ca[_0x5ca1f3(0x201)](_0x9d1811=>normalize(_0x9d1811[_0x5ca1f3(0x1e6)])===normalize(_0x127825)&&(_0x9d1811[_0x5ca1f3(0x210)]===_0x5ca1f3(0x1b1)||_0x9d1811[_0x5ca1f3(0x210)]==='thermostat'));if(!_0x3018c3){_0x1a7aab[_0x5ca1f3(0x17c)][_0x5ca1f3(0x21b)](_0x5ca1f3(0x1be)+_0x127825+'\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.'),_0x5e8561[_0x5ca1f3(0x20f)](_0x2e4277,0x1),_0x504ca7=!![];continue;}if(_0x3018c3){const _0x5b3a5c=await findRelatedId(_0x1a7aab,_0x3018c3['id'],_0x5ca1f3(0x1f0)),_0x46baf1=await _0x1a7aab[_0x5ca1f3(0x229)](_0x3018c3['id']);if(_0x5b3a5c){const _0x20a14a=await _0x1a7aab[_0x5ca1f3(0x229)](_0x5b3a5c);if(_0x20a14a&&typeof _0x20a14a['val']===_0x5ca1f3(0x1db)){let _0x33c0b2=![],_0x53437d='';Math[_0x5ca1f3(0x1f7)](_0x20a14a[_0x5ca1f3(0x194)]-ECO_TEMP)>0.5&&(_0x33c0b2=!![],_0x53437d=_0x5ca1f3(0x1b0));if(!_0x33c0b2&&_0x46baf1&&typeof _0x46baf1[_0x5ca1f3(0x194)]===_0x5ca1f3(0x1db)){const _0x2c7e95=_0x301cd6[_0x127825]||_0x301cd6[_0x5ca1f3(0x22e)]||0x15;_0x46baf1[_0x5ca1f3(0x194)]<_0x2c7e95+0.2&&(_0x33c0b2=!![],_0x53437d=_0x5ca1f3(0x191));}if(_0x33c0b2){if(_0x53437d===_0x5ca1f3(0x1b0)){_0x1a7aab['log'][_0x5ca1f3(0x196)]('ðŸ§¹\x20[MPC\x20CLEANUP]\x20'+_0x127825+_0x5ca1f3(0x1fb)+_0x20a14a[_0x5ca1f3(0x194)]+_0x5ca1f3(0x212)+ECO_TEMP+_0x5ca1f3(0x1a0));const _0xc3dd8d=lastActions[_0x5ca1f3(0x174)+_0x127825],_0x3566a8=_0xc3dd8d&&Date['now']()-_0xc3dd8d<0x2*0x3c*0x3e8;if(!_0x3566a8&&_0x20a14a[_0x5ca1f3(0x194)]>ECO_TEMP+0.5){_0x1a7aab['sendToPythonWrapper']&&(_0x1a7aab[_0x5ca1f3(0x17c)][_0x5ca1f3(0x196)](_0x5ca1f3(0x203)+_0x127825+_0x5ca1f3(0x18c)),_0x1a7aab[_0x5ca1f3(0x176)](_0x5ca1f3(0x1a6),{'room':_0x127825}));const _0x569316=_0x127825+'_'+new Date()[_0x5ca1f3(0x1cd)]();if(!_0x442442[_0x569316]){_0x442442[_0x569316]=0x1;if(!_0x442442['_meta'])_0x442442[_0x5ca1f3(0x1a5)]={};_0x442442[_0x5ca1f3(0x1a5)][_0x569316]=Date[_0x5ca1f3(0x18d)](),_0x1093f7=!![];}}else _0x3566a8&&_0x1a7aab[_0x5ca1f3(0x17c)][_0x5ca1f3(0x196)](_0x5ca1f3(0x1de)+_0x127825+_0x5ca1f3(0x1f9));}else{if(_0x53437d===_0x5ca1f3(0x191)){let _0x3f90a6=![];if(_0x4b511a[_0x5ca1f3(0x201)](_0x1c255a=>_0x1c255a[_0x5ca1f3(0x1b8)]===_0x127825))_0x3f90a6=!![];const _0x34f8f3=_0x2175ca[_0x5ca1f3(0x1c3)](_0x3c741e=>normalize(_0x3c741e[_0x5ca1f3(0x1e6)])===normalize(_0x127825)&&(_0x3c741e[_0x5ca1f3(0x210)]==='window'||_0x3c741e['type']===_0x5ca1f3(0x20d)||_0x3c741e[_0x5ca1f3(0x210)]===_0x5ca1f3(0x1a3)));for(const _0xda45f1 of _0x34f8f3){try{const _0x5dec7e=await _0x1a7aab[_0x5ca1f3(0x229)](_0xda45f1['id']);if(_0x5dec7e&&(_0x5dec7e[_0x5ca1f3(0x194)]===!![]||_0x5dec7e[_0x5ca1f3(0x194)]===0x1||String(_0x5dec7e[_0x5ca1f3(0x194)])['toLowerCase']()===_0x5ca1f3(0x1aa)))_0x3f90a6=!![];}catch(_0x2bb383){}}if(_0x3f90a6)_0x1a7aab[_0x5ca1f3(0x17c)][_0x5ca1f3(0x196)](_0x5ca1f3(0x1f8)+_0x127825+'\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.');else{const _0x38a3ef=_0x301cd6[_0x127825]||_0x301cd6[_0x5ca1f3(0x22e)]||0x15;_0x1a7aab['log'][_0x5ca1f3(0x196)](_0x5ca1f3(0x22a)+_0x127825+_0x5ca1f3(0x18a)+_0x46baf1[_0x5ca1f3(0x194)]+'Â°C\x20<\x20'+(_0x38a3ef+0.2)+_0x5ca1f3(0x197)),await _0x1a7aab[_0x5ca1f3(0x1d6)](_0x5b3a5c,_0x38a3ef),await logAutomationAction(_0x1a7aab,_0x5ca1f3(0x1c1)+_0x127825+_0x5ca1f3(0x179)+_0x38a3ef+'Â°C'),lastActions[_0x5ca1f3(0x1b2)+_0x127825]=Date['now']();}}}_0x5e8561[_0x5ca1f3(0x20f)](_0x2e4277,0x1),_0x504ca7=!![];}}}}}_0x504ca7&&await _0x1a7aab[_0x5ca1f3(0x1cb)](_0x3b3c73,{'val':JSON['stringify'](_0x5e8561),'ack':!![]}),_0x1093f7&&await _0x1a7aab[_0x5ca1f3(0x1cb)](_0x5ca1f3(0x199),{'val':JSON[_0x5ca1f3(0x17f)](_0x442442),'ack':!![]});}catch(_0x3e64fd){}}async function applyEnergySavings(_0x14e218,_0x3adff9){const _0x5d49cf=a1_0x392085;await cleanupGhostInterventions(_0x14e218);if(!_0x3adff9||_0x3adff9['length']===0x0)return;const _0x5d9d75=_0x14e218['config'][_0x5d49cf(0x1c6)]||[],_0xdb36b8=Date[_0x5d49cf(0x18d)]();for(const _0xbfce5a of _0x3adff9){const _0x452150=_0xbfce5a['room'],_0x4fe48c=_0xbfce5a['minutes_safe'],_0x3b5ef8=_0xbfce5a['target']||0x15;if(lastActions[_0x5d49cf(0x1b2)+_0x452150]&&_0xdb36b8-lastActions[_0x5d49cf(0x1b2)+_0x452150]<RESCUE_LOCK_MS)continue;const _0x1e4ff5=_0x5d9d75[_0x5d49cf(0x201)](_0x388fa7=>normalize(_0x388fa7[_0x5d49cf(0x1e6)])===normalize(_0x452150)&&(_0x388fa7[_0x5d49cf(0x210)]===_0x5d49cf(0x1b1)||_0x388fa7[_0x5d49cf(0x210)]===_0x5d49cf(0x1bc)));if(!_0x1e4ff5)continue;const _0x3a2f26=await findRelatedId(_0x14e218,_0x1e4ff5['id'],_0x5d49cf(0x1f0));if(_0x3a2f26){if(lastActions[_0x5d49cf(0x220)+_0x452150]&&_0xdb36b8-lastActions[_0x5d49cf(0x220)+_0x452150]<0x1e*0x3c*0x3e8)continue;const _0x89987f=await _0x14e218['getForeignStateAsync'](_0x3a2f26);if(_0x89987f&&typeof _0x89987f[_0x5d49cf(0x194)]===_0x5d49cf(0x1db)){const _0x18db6d=_0x89987f[_0x5d49cf(0x194)];_0x18db6d!==ECO_TEMP&&await manageMpcIntervention(_0x14e218,_0x452150,'remove');if(_0x4fe48c>0x1e)_0x18db6d>ECO_TEMP+0.5&&(_0x14e218[_0x5d49cf(0x17c)][_0x5d49cf(0x196)](_0x5d49cf(0x1b3)+_0x452150+_0x5d49cf(0x1f3)+ECO_TEMP+_0x5d49cf(0x189)+_0x4fe48c+_0x5d49cf(0x17e)),await _0x14e218[_0x5d49cf(0x1d6)](_0x3a2f26,ECO_TEMP),await manageMpcIntervention(_0x14e218,_0x452150,_0x5d49cf(0x1a1)),lastActions[_0x5d49cf(0x220)+_0x452150]=_0xdb36b8,await logAutomationAction(_0x14e218,_0x5d49cf(0x1cc)+_0x452150+_0x5d49cf(0x1bd)+ECO_TEMP+'Â°C'));else _0x4fe48c<=0xf&&(_0x18db6d<_0x3b5ef8&&(_0x14e218[_0x5d49cf(0x17c)][_0x5d49cf(0x196)]('ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20'+_0x452150+_0x5d49cf(0x180)+_0x3b5ef8+_0x5d49cf(0x1cf)),await _0x14e218[_0x5d49cf(0x1d6)](_0x3a2f26,_0x3b5ef8),await manageMpcIntervention(_0x14e218,_0x452150,_0x5d49cf(0x228)),lastActions[_0x5d49cf(0x220)+_0x452150]=_0xdb36b8,await logAutomationAction(_0x14e218,_0x5d49cf(0x1cc)+_0x452150+_0x5d49cf(0x1da)+_0x3b5ef8+'Â°C')));}}else _0x14e218['log'][_0x5d49cf(0x21b)](_0x5d49cf(0x1fc)+_0x452150+_0x5d49cf(0x190));}}module[a1_0x392085(0x1e7)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};