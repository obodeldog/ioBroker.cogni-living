function a1_0x152b(){const _0x1dc9c4=['102410YnKQys','trim','802594NgpzxI','setForeignStateAsync','877029wNPKLo','213464EzytRN','active','approved','dimmer','reason','\x20->\x20','ü§ñ\x20Butler\x20Blocked:\x20','(((.+)+)+)+$','\x20->\x20Schalte\x20','Unknown','now','10320066uShBET','setStateAsync','log','type','search','getStateAsync','3949lbSBxs','off','4hetRFT','location','üëÄ\x20SIMULATION:\x20','debug','toString','85ZbGXyU','üîç\x20Device-Search\x20failed:\x20Predicted\x20\x27','light','[BLOCKED]\x20','Pr√§diktion:\x20','replace','3285531yDQtJG','config','val','info','simulate','apply','consultButler','21zGCkKl','\x27),\x20but\x20found\x20no\x20matching\x20light\x20device.','10512fqHTgf'];a1_0x152b=function(){return _0x1dc9c4;};return a1_0x152b();}(function(_0x4a84d5,_0x67425d){const _0x2abc8f=a1_0x220c,_0x19dc92=_0x4a84d5();while(!![]){try{const _0x50927c=-parseInt(_0x2abc8f(0x151))/0x1+parseInt(_0x2abc8f(0x14f))/0x2+parseInt(_0x2abc8f(0x143))/0x3*(-parseInt(_0x2abc8f(0x138))/0x4)+parseInt(_0x2abc8f(0x13d))/0x5*(-parseInt(_0x2abc8f(0x14c))/0x6)+parseInt(_0x2abc8f(0x14a))/0x7*(-parseInt(_0x2abc8f(0x152))/0x8)+-parseInt(_0x2abc8f(0x130))/0x9+parseInt(_0x2abc8f(0x14d))/0xa*(parseInt(_0x2abc8f(0x136))/0xb);if(_0x50927c===_0x67425d)break;else _0x19dc92['push'](_0x19dc92['shift']());}catch(_0x3d4f21){_0x19dc92['push'](_0x19dc92['shift']());}}}(a1_0x152b,0xcf4cf));function a1_0x220c(_0xf33c6a,_0x36ee83){const _0x41d662=a1_0x152b();return a1_0x220c=function(_0x429e00,_0x5c9fdc){_0x429e00=_0x429e00-0x130;let _0x152b80=_0x41d662[_0x429e00];return _0x152b80;},a1_0x220c(_0xf33c6a,_0x36ee83);}const a1_0x5c9fdc=(function(){let _0x4b3fb1=!![];return function(_0x2bac42,_0x1aca6c){const _0x50b017=_0x4b3fb1?function(){const _0x4783cb=a1_0x220c;if(_0x1aca6c){const _0x4a3994=_0x1aca6c[_0x4783cb(0x148)](_0x2bac42,arguments);return _0x1aca6c=null,_0x4a3994;}}:function(){};return _0x4b3fb1=![],_0x50b017;};}()),a1_0x429e00=a1_0x5c9fdc(this,function(){const _0x5c39d6=a1_0x220c;return a1_0x429e00[_0x5c39d6(0x13c)]()[_0x5c39d6(0x134)](_0x5c39d6(0x159))[_0x5c39d6(0x13c)]()['constructor'](a1_0x429e00)['search'](_0x5c39d6(0x159));});a1_0x429e00();'use strict';const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,lastActions={};function normalize(_0x216c0d){const _0x4e7e48=a1_0x220c;if(!_0x216c0d)return'';return _0x216c0d['toLowerCase']()[_0x4e7e48(0x142)](/\s+/g,'')[_0x4e7e48(0x14e)]();}async function handlePrediction(_0x15462b,_0x29705a,_0x3af299){const _0x55fefb=a1_0x220c;if(!_0x29705a||_0x29705a===_0x55fefb(0x15b))return;let _0x1d3bc9=_0x55fefb(0x137),_0x349367=0.6;try{const _0x8c565c=await _0x15462b[_0x55fefb(0x135)]('analysis.automation.mode');if(_0x8c565c&&_0x8c565c[_0x55fefb(0x145)])_0x1d3bc9=_0x8c565c['val'];const _0x1f9cf9=await _0x15462b['getStateAsync']('analysis.automation.confidenceThreshold');if(_0x1f9cf9&&_0x1f9cf9[_0x55fefb(0x145)])_0x349367=_0x1f9cf9['val'];}catch(_0x2dce2e){}if(_0x1d3bc9===_0x55fefb(0x137))return;if(_0x3af299<_0x349367)return;const _0x177ec2=Date[_0x55fefb(0x15c)]();if(lastActions[_0x29705a]&&_0x177ec2-lastActions[_0x29705a]<COOLDOWN_MS)return;const _0x33ffb1=_0x15462b[_0x55fefb(0x144)]['devices']||[],_0x27ed7f=normalize(_0x29705a),_0x273e0d=_0x33ffb1['find'](_0x227bc8=>{const _0x2e0531=_0x55fefb;return normalize(_0x227bc8[_0x2e0531(0x139)])===_0x27ed7f&&(_0x227bc8[_0x2e0531(0x133)]===_0x2e0531(0x13f)||_0x227bc8[_0x2e0531(0x133)]===_0x2e0531(0x155)||_0x227bc8['type']==='switch');});if(!_0x273e0d){const _0x223e97=_0x55fefb(0x13e)+_0x29705a+'\x27\x20(norm:\x20\x27'+_0x27ed7f+_0x55fefb(0x14b);_0x15462b[_0x55fefb(0x132)][_0x55fefb(0x13b)](_0x223e97);return;}const _0x39c879=await aiAgent[_0x55fefb(0x149)](_0x15462b,_0x29705a,_0x273e0d['name'],_0x3af299);if(!_0x39c879[_0x55fefb(0x154)]){_0x15462b['log']['debug'](_0x55fefb(0x158)+_0x29705a+_0x55fefb(0x157)+_0x39c879[_0x55fefb(0x156)]),await _0x15462b[_0x55fefb(0x131)]('analysis.automation.lastAction',{'val':_0x55fefb(0x140)+_0x39c879['reason'],'ack':!![]});return;}const _0x13cecd=_0x55fefb(0x141)+_0x29705a+_0x55fefb(0x15a)+_0x273e0d['name']+'\x20('+_0x39c879['reason']+')';await _0x15462b[_0x55fefb(0x131)]('analysis.automation.lastAction',{'val':'['+_0x1d3bc9['toUpperCase']()+']\x20'+_0x13cecd,'ack':!![]});if(_0x1d3bc9===_0x55fefb(0x147))_0x15462b[_0x55fefb(0x132)]['info'](_0x55fefb(0x13a)+_0x13cecd);else{if(_0x1d3bc9===_0x55fefb(0x153)){_0x15462b[_0x55fefb(0x132)][_0x55fefb(0x146)]('‚ö°\x20ACTION:\x20'+_0x13cecd);const _0x26194a=await _0x15462b['getForeignStateAsync'](_0x273e0d['id']);if(_0x26194a&&(_0x26194a[_0x55fefb(0x145)]===!![]||_0x26194a[_0x55fefb(0x145)]>0x0)){}else await _0x15462b[_0x55fefb(0x150)](_0x273e0d['id'],!![]);lastActions[_0x29705a]=_0x177ec2;}}}module['exports']={'handlePrediction':handlePrediction};