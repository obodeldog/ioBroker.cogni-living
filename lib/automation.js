const a1_0x56bf63=a1_0x4903;(function(_0x5a82a9,_0x38ccf9){const _0x17b221=a1_0x4903,_0x168262=_0x5a82a9();while(!![]){try{const _0x11d713=-parseInt(_0x17b221(0x1f6))/0x1*(parseInt(_0x17b221(0x182))/0x2)+parseInt(_0x17b221(0x1c2))/0x3+parseInt(_0x17b221(0x1dd))/0x4+parseInt(_0x17b221(0x1cc))/0x5+parseInt(_0x17b221(0x1de))/0x6+-parseInt(_0x17b221(0x214))/0x7+-parseInt(_0x17b221(0x232))/0x8;if(_0x11d713===_0x38ccf9)break;else _0x168262['push'](_0x168262['shift']());}catch(_0x44dad5){_0x168262['push'](_0x168262['shift']());}}}(a1_0x5ceb,0xc73fe));const a1_0x56f35e=(function(){let _0x396172=!![];return function(_0x13cae9,_0x31ff97){const _0x1d26c4=_0x396172?function(){if(_0x31ff97){const _0x4f76b5=_0x31ff97['apply'](_0x13cae9,arguments);return _0x31ff97=null,_0x4f76b5;}}:function(){};return _0x396172=![],_0x1d26c4;};}()),a1_0x467695=a1_0x56f35e(this,function(){const _0x267925=a1_0x4903;return a1_0x467695[_0x267925(0x1d1)]()[_0x267925(0x1ec)](_0x267925(0x186))[_0x267925(0x1d1)]()[_0x267925(0x23a)](a1_0x467695)['search']('(((.+)+)+)+$');});a1_0x467695();'use strict';function a1_0x4903(_0xf1cfb0,_0x59f490){const _0x1eedc9=a1_0x5ceb();return a1_0x4903=function(_0x467695,_0x56f35e){_0x467695=_0x467695-0x181;let _0x5ceb2b=_0x1eedc9[_0x467695];return _0x5ceb2b;},a1_0x4903(_0xf1cfb0,_0x59f490);}const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x12050d){const _0x5ab034=a1_0x4903;if(!_0x12050d)return'';return _0x12050d[_0x5ab034(0x231)]()[_0x5ab034(0x211)](/\s+/g,'')[_0x5ab034(0x1d4)]();}function getWarmupRobust(_0x46bd6e,_0x12725f){const _0xed31a1=a1_0x4903;if(!_0x46bd6e||!_0x12725f)return 0x3c;if(_0x46bd6e[_0x12725f]!==undefined)return _0x46bd6e[_0x12725f];const _0xe674d1=_0x12725f[_0xed31a1(0x231)]()['replace'](/√§/g,'ae')['replace'](/√∂/g,'oe')[_0xed31a1(0x211)](/√º/g,'ue')[_0xed31a1(0x211)](/√ü/g,'ss')[_0xed31a1(0x211)](/\s+/g,'_')['replace'](/[^a-z0-9_]/g,'');if(_0x46bd6e[_0xe674d1]!==undefined)return _0x46bd6e[_0xe674d1];return 0x3c;}async function logAutomationAction(_0x1e6c77,_0x514f7e){const _0xa2e4c3=a1_0x4903;await _0x1e6c77[_0xa2e4c3(0x227)](_0xa2e4c3(0x1f9),{'val':_0x514f7e,'ack':!![]});try{const _0x4f7156=_0xa2e4c3(0x209),_0x5086bd=await _0x1e6c77[_0xa2e4c3(0x1fd)](_0x4f7156);let _0x12fa56=[];if(_0x5086bd&&_0x5086bd[_0xa2e4c3(0x1cb)])try{_0x12fa56=JSON[_0xa2e4c3(0x1f0)](_0x5086bd[_0xa2e4c3(0x1cb)]);}catch(_0x5b1179){}_0x12fa56[_0xa2e4c3(0x1c7)]({'ts':Date['now'](),'msg':_0x514f7e});if(_0x12fa56[_0xa2e4c3(0x184)]>0x32)_0x12fa56=_0x12fa56['slice'](0x0,0x32);await _0x1e6c77[_0xa2e4c3(0x227)](_0x4f7156,{'val':JSON['stringify'](_0x12fa56),'ack':!![]});}catch(_0x100754){}}async function handlePrediction(_0x27085c,_0x603f93,_0x48624d){const _0x37383e=a1_0x4903;if(!_0x603f93||_0x603f93===_0x37383e(0x18a))return;let _0x45c478='off',_0x19fef8=0.6;try{const _0x553223=await _0x27085c['getStateAsync'](_0x37383e(0x1a6));if(_0x553223&&_0x553223[_0x37383e(0x1cb)])_0x45c478=_0x553223['val'];const _0x4d5a3e=await _0x27085c['getStateAsync']('analysis.automation.confidenceThreshold');if(_0x4d5a3e&&_0x4d5a3e[_0x37383e(0x1cb)])_0x19fef8=_0x4d5a3e[_0x37383e(0x1cb)];}catch(_0xb13071){}if(_0x45c478==='off'||_0x48624d<_0x19fef8)return;const _0x209e3f=Date[_0x37383e(0x1ac)]();if(lastActions[_0x603f93]&&_0x209e3f-lastActions[_0x603f93]<COOLDOWN_MS)return;const _0x18d8e7=_0x27085c['config']['devices']||[],_0x22cb3d=normalize(_0x603f93),_0x4aae20=_0x18d8e7[_0x37383e(0x18c)](_0x2ba75e=>normalize(_0x2ba75e[_0x37383e(0x1b7)])===_0x22cb3d&&(_0x2ba75e[_0x37383e(0x1f7)]===_0x37383e(0x1c6)||_0x2ba75e['type']===_0x37383e(0x183)||_0x2ba75e[_0x37383e(0x1f7)]===_0x37383e(0x198)));if(!_0x4aae20)return;const _0x4953a6=await aiAgent[_0x37383e(0x189)](_0x27085c,_0x603f93,_0x4aae20[_0x37383e(0x223)],_0x48624d);if(!_0x4953a6[_0x37383e(0x1d9)])return;const _0x159a05='Pr√§diktion:\x20'+_0x603f93+'\x20->\x20Schalte\x20'+_0x4aae20[_0x37383e(0x223)]+'\x20('+_0x4953a6[_0x37383e(0x22d)]+')';await logAutomationAction(_0x27085c,'['+_0x45c478['toUpperCase']()+']\x20'+_0x159a05);if(_0x45c478===_0x37383e(0x1a0)){const _0x3a2e16=await _0x27085c[_0x37383e(0x1fe)](_0x4aae20['id']);(!_0x3a2e16||!_0x3a2e16['val']&&_0x3a2e16['val']!==!![])&&await _0x27085c['setForeignStateAsync'](_0x4aae20['id'],!![]),lastActions[_0x603f93]=_0x209e3f;}}async function findRelatedId(_0x199731,_0x4caf48,_0x53827b=a1_0x56bf63(0x203)){const _0x130d59=a1_0x56bf63;if(_0x53827b===_0x130d59(0x203)&&_0x199731['config'][_0x130d59(0x20d)]){let _0x111dd8=_0x199731[_0x130d59(0x185)][_0x130d59(0x20d)];if(typeof _0x111dd8===_0x130d59(0x1db))try{_0x111dd8=JSON[_0x130d59(0x1f0)](_0x111dd8);}catch(_0x4f7c82){}if(_0x111dd8&&_0x111dd8[_0x4caf48])return _0x111dd8[_0x4caf48];}if(_0x53827b===_0x130d59(0x18e)&&_0x199731[_0x130d59(0x185)]['valveMapping']){let _0x38bf4c=_0x199731[_0x130d59(0x185)][_0x130d59(0x239)];if(typeof _0x38bf4c===_0x130d59(0x1db))try{_0x38bf4c=JSON[_0x130d59(0x1f0)](_0x38bf4c);}catch(_0x4d0b57){}if(_0x38bf4c&&_0x38bf4c[_0x4caf48])return _0x38bf4c[_0x4caf48];}let _0x4bd5a6=[];if(_0x53827b===_0x130d59(0x203))_0x4bd5a6=[{'s':_0x130d59(0x1fa),'t':_0x130d59(0x1ba)},{'s':_0x130d59(0x1a1),'t':_0x130d59(0x1ba)},{'s':_0x130d59(0x1a1),'t':_0x130d59(0x1eb)},{'s':_0x130d59(0x1a9),'t':_0x130d59(0x210)},{'s':_0x130d59(0x208),'t':'occupied_heating_setpoint'},{'s':_0x130d59(0x208),'t':_0x130d59(0x1b6)},{'s':_0x130d59(0x1c5),'t':_0x130d59(0x1f5)},{'s':_0x130d59(0x197),'t':_0x130d59(0x1e0)},{'s':_0x130d59(0x1c0),'t':_0x130d59(0x243)},{'s':_0x130d59(0x1c5),'t':_0x130d59(0x203)}];else _0x53827b===_0x130d59(0x18e)&&(_0x4bd5a6=[{'s':'.1.ACTUAL_TEMPERATURE','t':'.1.LEVEL'},{'s':_0x130d59(0x1a1),'t':_0x130d59(0x1c9)},{'s':_0x130d59(0x1a1),'t':_0x130d59(0x19e)},{'s':_0x130d59(0x208),'t':_0x130d59(0x23e)},{'s':_0x130d59(0x1c5),'t':_0x130d59(0x1b0)},{'s':_0x130d59(0x1c5),'t':_0x130d59(0x181)}]);for(const _0x121775 of _0x4bd5a6){if(_0x4caf48[_0x130d59(0x1a3)](_0x121775['s'])){const _0x43e6e1=_0x4caf48[_0x130d59(0x211)](_0x121775['s'],_0x121775['t']),_0x389387=await _0x199731[_0x130d59(0x213)](_0x43e6e1);if(_0x389387)return _0x43e6e1;}}try{const _0x23b81a=_0x4caf48['split']('.');if(_0x23b81a[_0x130d59(0x184)]>0x2){const _0x42a117=_0x23b81a[_0x130d59(0x1e4)](0x0,-0x1)[_0x130d59(0x23c)]('.'),_0x599fd6=await _0x199731[_0x130d59(0x201)](_0x42a117+'.*'),_0x1edcb2=[],_0xcfa0e9=_0x4caf48['split'](/[._]+/)[_0x130d59(0x1e1)](_0xb7d803=>![_0x130d59(0x21b),'0',_0x130d59(0x233),'ist',_0x130d59(0x228),_0x130d59(0x1c5),'actual',_0x130d59(0x1d2),'messwert',_0x130d59(0x1d8)][_0x130d59(0x1a3)](_0xb7d803[_0x130d59(0x231)]()));for(const [_0x52e698,_0x5e6d9b]of Object['entries'](_0x599fd6)){if(_0x52e698===_0x4caf48)continue;if(_0x5e6d9b&&_0x5e6d9b[_0x130d59(0x1e9)]){const _0xe396a9=_0x52e698[_0x130d59(0x231)](),_0x20082b=(_0x5e6d9b[_0x130d59(0x1e9)][_0x130d59(0x23b)]||'')[_0x130d59(0x231)](),_0x5e719c=(_0x5e6d9b['common']['unit']||'')[_0x130d59(0x231)]();let _0x4a6d1b=![];if(_0x53827b===_0x130d59(0x203)&&_0x5e6d9b[_0x130d59(0x1e9)][_0x130d59(0x1bb)]===!![])_0x4a6d1b=_0xe396a9['includes'](_0x130d59(0x1ee))||_0xe396a9[_0x130d59(0x1a3)](_0x130d59(0x1ae))||_0xe396a9[_0x130d59(0x1a3)](_0x130d59(0x1c4))||_0x20082b[_0x130d59(0x1a3)](_0x130d59(0x1cf))||_0x20082b['includes'](_0x130d59(0x226));else _0x53827b==='valve'&&(_0x4a6d1b=_0xe396a9[_0x130d59(0x1a3)](_0x130d59(0x181))||_0xe396a9['includes'](_0x130d59(0x18e))||_0xe396a9[_0x130d59(0x1a3)](_0x130d59(0x222))||_0xe396a9['includes'](_0x130d59(0x193))||_0x20082b['includes'](_0x130d59(0x1e8))||_0x20082b[_0x130d59(0x1a3)](_0x130d59(0x218))||_0x5e719c[_0x130d59(0x1a3)]('%'));if(_0x4a6d1b){const _0x598207=_0x52e698[_0x130d59(0x1bf)](/[._]+/)['map'](_0x47b365=>_0x47b365[_0x130d59(0x231)]());let _0x5140f9=0x0;_0xcfa0e9[_0x130d59(0x1bd)](_0x293aac=>{const _0x2eeada=_0x130d59;if(_0x598207[_0x2eeada(0x1a3)](_0x293aac['toLowerCase']()))_0x5140f9++;}),_0x1edcb2[_0x130d59(0x1ca)]({'id':_0x52e698,'score':_0x5140f9});}}}if(_0x1edcb2[_0x130d59(0x184)]>0x0){_0x1edcb2[_0x130d59(0x18b)]((_0x3e3961,_0x1776e5)=>_0x1776e5[_0x130d59(0x1b2)]-_0x3e3961[_0x130d59(0x1b2)]);if(_0x1edcb2[0x0]['score']>0x0)return _0x1edcb2[0x0]['id'];}}}catch(_0x1ff79e){}return null;}async function scanThermostats(_0x480cc8){const _0x10af77=a1_0x56bf63,_0x33a9a2=_0x480cc8[_0x10af77(0x185)][_0x10af77(0x1df)]||[],_0x5180f6=[],_0xa51c4c=_0x33a9a2[_0x10af77(0x1e1)](_0x3fb5ee=>_0x3fb5ee['id']&&_0x3fb5ee['id'][_0x10af77(0x1a3)]('temperature')||_0x3fb5ee[_0x10af77(0x1f7)]&&[_0x10af77(0x1c5),_0x10af77(0x1e3),'sensor'][_0x10af77(0x1a3)](_0x3fb5ee[_0x10af77(0x1f7)])||_0x3fb5ee[_0x10af77(0x223)]&&_0x3fb5ee[_0x10af77(0x223)]['toLowerCase']()[_0x10af77(0x1a3)](_0x10af77(0x1ea)));for(const _0x376507 of _0xa51c4c){const _0x9ef8e6=await findRelatedId(_0x480cc8,_0x376507['id'],_0x10af77(0x203)),_0x4dffb7=await findRelatedId(_0x480cc8,_0x376507['id'],_0x10af77(0x18e));let _0x19a202=_0x10af77(0x217),_0x4dc7cc=![],_0x1cac01=_0x480cc8[_0x10af77(0x185)][_0x10af77(0x20d)]||{};if(typeof _0x1cac01===_0x10af77(0x1db))try{_0x1cac01=JSON[_0x10af77(0x1f0)](_0x1cac01);}catch(_0x38155a){}let _0x1bb140=_0x480cc8['config'][_0x10af77(0x239)]||{};if(typeof _0x1bb140==='string')try{_0x1bb140=JSON[_0x10af77(0x1f0)](_0x1bb140);}catch(_0x27473c){}if(_0x1cac01[_0x376507['id']]&&_0x1cac01[_0x376507['id']]===_0x9ef8e6||_0x1bb140[_0x376507['id']]&&_0x1bb140[_0x376507['id']]===_0x4dffb7)_0x19a202=_0x10af77(0x19b),_0x4dc7cc=!![];else(_0x9ef8e6||_0x4dffb7)&&(_0x19a202=_0x10af77(0x22a));_0x5180f6[_0x10af77(0x1ca)]({'room':_0x376507['location']||_0x10af77(0x18f),'sensorId':_0x376507['id'],'setpointId':_0x9ef8e6||'-','valveId':_0x4dffb7||'-','source':_0x19a202,'isManual':_0x4dc7cc,'status':_0x9ef8e6&&_0x4dffb7?'PERFECT':_0x9ef8e6?'OK':_0x10af77(0x21f)});}return _0x5180f6[_0x10af77(0x18b)]((_0x5ce043,_0x176b34)=>_0x5ce043[_0x10af77(0x1c1)]['localeCompare'](_0x176b34['room']));}async function updateSchedulePreview(_0x56dbdc){const _0x51fc8c=a1_0x56bf63;if(!_0x56dbdc[_0x51fc8c(0x185)]['useCalendar']||!_0x56dbdc[_0x51fc8c(0x185)]['calendarInstance'])return;let _0x2189e6={};try{const _0x3ac7ea=await _0x56dbdc[_0x51fc8c(0x1fd)]('analysis.energy.warmupTimes');if(_0x3ac7ea&&_0x3ac7ea[_0x51fc8c(0x1cb)])_0x2189e6=JSON[_0x51fc8c(0x1f0)](_0x3ac7ea['val']);}catch(_0x24a79b){}const _0x405990=[],_0x2f3d72=Date[_0x51fc8c(0x1ac)](),_0x3d029e=0x30*0x3c*0x3c*0x3e8;try{const _0x3ad2a7=await _0x56dbdc[_0x51fc8c(0x1fe)](_0x56dbdc['config']['calendarInstance']+_0x51fc8c(0x23d));if(!_0x3ad2a7||!_0x3ad2a7[_0x51fc8c(0x1cb)])return;const _0x967af6=JSON[_0x51fc8c(0x1f0)](_0x3ad2a7[_0x51fc8c(0x1cb)]),_0x1f578a=_0x56dbdc['config'][_0x51fc8c(0x1f1)]||[],_0x3ab9c5=_0x56dbdc['config'][_0x51fc8c(0x1df)]||[],_0x3b465b=new Set();_0x3ab9c5['forEach'](_0x5a83d7=>{const _0x5af2d8=_0x51fc8c;if(_0x5a83d7[_0x5af2d8(0x1b7)])_0x3b465b[_0x5af2d8(0x190)](_0x5a83d7['location']);});for(const _0x1b6808 of _0x967af6){if(_0x1b6808[_0x51fc8c(0x1b1)]&&_0x1f578a[_0x51fc8c(0x184)]>0x0&&!_0x1f578a[_0x51fc8c(0x1a3)](_0x1b6808[_0x51fc8c(0x1b1)]))continue;const _0x396f53=_0x1b6808[_0x51fc8c(0x199)]||_0x1b6808[_0x51fc8c(0x1d0)]||_0x1b6808[_0x51fc8c(0x1ed)];if(!_0x396f53)continue;const _0x2b94c9=new Date(_0x396f53),_0x12acc6=_0x2b94c9[_0x51fc8c(0x238)]();if(isNaN(_0x12acc6))continue;if(_0x12acc6<_0x2f3d72)continue;if(_0x12acc6>_0x2f3d72+_0x3d029e)continue;const _0x4d4b93=(_0x1b6808[_0x51fc8c(0x221)]||_0x1b6808[_0x51fc8c(0x22b)]||'')[_0x51fc8c(0x231)]();let _0x1cb657=![],_0x3790b2=[],_0x59c18a=_0x1b6808[_0x51fc8c(0x221)]||_0x1b6808[_0x51fc8c(0x22b)]||_0x51fc8c(0x18f);if(_0x4d4b93[_0x51fc8c(0x1a3)](_0x51fc8c(0x19f))||_0x4d4b93[_0x51fc8c(0x1a3)](_0x51fc8c(0x234))||_0x4d4b93[_0x51fc8c(0x1a3)](_0x51fc8c(0x204)))_0x1cb657=!![],_0x3790b2=Array[_0x51fc8c(0x236)](_0x3b465b);else for(const _0x52cdb6 of _0x3b465b){if(_0x4d4b93[_0x51fc8c(0x1a3)](_0x52cdb6[_0x51fc8c(0x231)]()))_0x3790b2[_0x51fc8c(0x1ca)](_0x52cdb6);}_0x3790b2[_0x51fc8c(0x184)]>0x0&&_0x3790b2[_0x51fc8c(0x1bd)](_0x59fb3e=>{const _0x1ced76=_0x51fc8c;let _0x1c60f5=0x3c;if(_0x1cb657){let _0x553390=0x0;Object[_0x1ced76(0x1f4)](_0x2189e6)['forEach'](_0x27f45e=>{if(_0x27f45e>_0x553390)_0x553390=_0x27f45e;}),_0x1c60f5=_0x553390>0x0?_0x553390:0x78;}else _0x1c60f5=getWarmupRobust(_0x2189e6,_0x59fb3e);const _0x23b063=new Date(_0x12acc6-_0x1c60f5*0xea60);_0x405990[_0x1ced76(0x1ca)]({'eventTime':_0x12acc6,'triggerTime':_0x23b063['getTime'](),'room':_0x59fb3e,'minutes':_0x1c60f5,'reason':_0x59c18a,'isGlobal':_0x1cb657});});}}catch(_0x5dc64e){}_0x405990[_0x51fc8c(0x18b)]((_0x36db2b,_0x4ffa0a)=>_0x36db2b[_0x51fc8c(0x23f)]-_0x4ffa0a[_0x51fc8c(0x23f)]);const _0x5025a6=_0x405990[_0x51fc8c(0x1e4)](0x0,0x5);await _0x56dbdc[_0x51fc8c(0x227)](_0x51fc8c(0x1c8),{'val':JSON[_0x51fc8c(0x1ad)](_0x5025a6),'ack':!![]});}async function monitorEnforcements(_0xe4571d){const _0xb9de7f=a1_0x56bf63;try{const _0x4302dc=_0xb9de7f(0x1da),_0x3d86c2=await _0xe4571d[_0xb9de7f(0x1fd)](_0x4302dc);if(!_0x3d86c2||!_0x3d86c2[_0xb9de7f(0x1cb)])return;let _0x254d46=[];try{_0x254d46=JSON['parse'](_0x3d86c2[_0xb9de7f(0x1cb)]);}catch(_0x4d92ab){return;}if(!Array['isArray'](_0x254d46)||_0x254d46[_0xb9de7f(0x184)]===0x0)return;const _0x6c4706=Date['now'](),_0x535be4=_0xe4571d[_0xb9de7f(0x185)][_0xb9de7f(0x1df)]||[];let _0x5eac64=![];for(let _0x256c24=_0x254d46[_0xb9de7f(0x184)]-0x1;_0x256c24>=0x0;_0x256c24--){const _0x524fda=_0x254d46[_0x256c24];if(_0x6c4706>=_0x524fda[_0xb9de7f(0x241)]){_0xe4571d[_0xb9de7f(0x1ef)][_0xb9de7f(0x1af)](_0xb9de7f(0x1dc)+_0x524fda[_0xb9de7f(0x1c1)]+'\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.'),_0x254d46[_0xb9de7f(0x1c3)](_0x256c24,0x1),_0x5eac64=!![];continue;}const _0x24e332=_0x535be4['find'](_0x528a9f=>normalize(_0x528a9f[_0xb9de7f(0x1b7)])===normalize(_0x524fda[_0xb9de7f(0x1c1)])&&(_0x528a9f['type']===_0xb9de7f(0x1c5)||_0x528a9f[_0xb9de7f(0x1f7)]===_0xb9de7f(0x1e3)));if(_0x24e332){const _0x2f443d=await findRelatedId(_0xe4571d,_0x24e332['id'],'setpoint');if(_0x2f443d){const _0x48ad12=await _0xe4571d[_0xb9de7f(0x1fe)](_0x2f443d);_0x48ad12&&typeof _0x48ad12[_0xb9de7f(0x1cb)]==='number'&&(_0x48ad12['val']<0xf&&(_0xe4571d['log'][_0xb9de7f(0x20f)](_0xb9de7f(0x19d)+_0x524fda[_0xb9de7f(0x1c1)]+'\x20auf\x20'+_0x48ad12[_0xb9de7f(0x1cb)]+'¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20'+_0x524fda[_0xb9de7f(0x1c4)]+_0xb9de7f(0x219)),await _0xe4571d[_0xb9de7f(0x1ce)](_0x2f443d,_0x524fda[_0xb9de7f(0x1c4)]),await logAutomationAction(_0xe4571d,'[FORCE]\x20'+_0x524fda[_0xb9de7f(0x1c1)]+':\x20'+_0x48ad12[_0xb9de7f(0x1cb)]+_0xb9de7f(0x206)+_0x524fda[_0xb9de7f(0x1c4)]+_0xb9de7f(0x220))));}}}_0x5eac64&&await _0xe4571d['setStateAsync'](_0x4302dc,{'val':JSON['stringify'](_0x254d46),'ack':!![]});}catch(_0x310805){_0xe4571d[_0xb9de7f(0x1ef)]['error']('Enforcement\x20Monitor\x20Error:\x20'+_0x310805[_0xb9de7f(0x1a7)]);}}async function checkCalendarTriggers(_0x1dffec){const _0x3dc7a3=a1_0x56bf63;if(!_0x1dffec[_0x3dc7a3(0x185)]['useCalendar']||!_0x1dffec[_0x3dc7a3(0x185)][_0x3dc7a3(0x22c)])return;await updateSchedulePreview(_0x1dffec);let _0xb4ee03={},_0x48e44c={};try{const _0x35f508=await _0x1dffec[_0x3dc7a3(0x1fd)](_0x3dc7a3(0x194));if(_0x35f508&&_0x35f508[_0x3dc7a3(0x1cb)])_0xb4ee03=JSON[_0x3dc7a3(0x1f0)](_0x35f508['val']);const _0x50f595=await _0x1dffec[_0x3dc7a3(0x1fd)](_0x3dc7a3(0x22f));if(_0x50f595&&_0x50f595['val'])_0x48e44c=JSON[_0x3dc7a3(0x1f0)](_0x50f595['val']);}catch(_0x3075b0){}let _0x1f277f={'default':0x15};try{const _0x24afdf=await _0x1dffec['getStateAsync'](_0x3dc7a3(0x1e2));if(_0x24afdf&&_0x24afdf[_0x3dc7a3(0x1cb)])_0x1f277f=JSON[_0x3dc7a3(0x1f0)](_0x24afdf['val']);}catch(_0x3b03b6){}let _0x518860=[];try{const _0x556bae=await _0x1dffec['getStateAsync'](_0x3dc7a3(0x1da));if(_0x556bae&&_0x556bae[_0x3dc7a3(0x1cb)])_0x518860=JSON[_0x3dc7a3(0x1f0)](_0x556bae['val']);}catch(_0x57c388){}try{const _0x467045=await _0x1dffec['getForeignStateAsync'](_0x1dffec[_0x3dc7a3(0x185)][_0x3dc7a3(0x22c)]+_0x3dc7a3(0x23d));if(!_0x467045||!_0x467045['val'])return;const _0x38ee01=JSON[_0x3dc7a3(0x1f0)](_0x467045[_0x3dc7a3(0x1cb)]),_0x11d398=Date[_0x3dc7a3(0x1ac)](),_0x3937d6=_0x1dffec['config'][_0x3dc7a3(0x1df)]||[],_0x59626b=_0x1dffec[_0x3dc7a3(0x185)][_0x3dc7a3(0x1f1)]||[];let _0x11b0bf=![];for(const _0x5920f1 of _0x38ee01){if(_0x5920f1[_0x3dc7a3(0x1b1)]&&_0x59626b[_0x3dc7a3(0x184)]>0x0&&!_0x59626b[_0x3dc7a3(0x1a3)](_0x5920f1[_0x3dc7a3(0x1b1)]))continue;const _0x12bca5=_0x5920f1[_0x3dc7a3(0x199)]||_0x5920f1[_0x3dc7a3(0x1d0)]||_0x5920f1[_0x3dc7a3(0x1ed)];if(!_0x12bca5)continue;const _0x52025e=new Date(_0x12bca5);if(isNaN(_0x52025e[_0x3dc7a3(0x238)]()))continue;const _0x26344e=(_0x5920f1[_0x3dc7a3(0x221)]||_0x5920f1[_0x3dc7a3(0x22b)]||'')[_0x3dc7a3(0x231)]();if(_0x26344e[_0x3dc7a3(0x1a3)]('urlaub\x20ende')||_0x26344e[_0x3dc7a3(0x1a3)](_0x3dc7a3(0x234))||_0x26344e['includes'](_0x3dc7a3(0x204))){let _0x5afc92=0x0;Object[_0x3dc7a3(0x1f4)](_0xb4ee03)[_0x3dc7a3(0x1bd)](_0x3ef0fb=>{if(_0x3ef0fb>_0x5afc92)_0x5afc92=_0x3ef0fb;});if(_0x5afc92===0x0)_0x5afc92=0x78;const _0x3ae5fd=_0x52025e[_0x3dc7a3(0x238)]()-_0x5afc92*0xea60;_0x11d398>=_0x3ae5fd&&_0x11d398<_0x52025e[_0x3dc7a3(0x238)]()&&(_0x1dffec['currentSystemMode']!==_0x3dc7a3(0x1f2)&&(_0x1dffec[_0x3dc7a3(0x1ef)]['info'](_0x3dc7a3(0x195)+_0x5afc92+_0x3dc7a3(0x207)),await _0x1dffec[_0x3dc7a3(0x227)](_0x3dc7a3(0x1a4),{'val':'normal','ack':![]})));}for(const _0x429309 of _0x3937d6){if(_0x429309[_0x3dc7a3(0x1b7)]){const _0x5d4b55=_0x429309[_0x3dc7a3(0x1b7)]['toLowerCase'](),_0x4f7e7a=(_0x429309['name']||'')['toLowerCase']();let _0x38b604=_0x26344e[_0x3dc7a3(0x1a3)](_0x5d4b55);!_0x38b604&&_0x4f7e7a[_0x3dc7a3(0x184)]>0x3&&_0x26344e[_0x3dc7a3(0x1a3)](_0x4f7e7a)&&(_0x38b604=!![]);if(_0x38b604){const _0x387814=getWarmupRobust(_0xb4ee03,_0x429309[_0x3dc7a3(0x1b7)]),_0x28703a=_0x48e44c[_0x429309[_0x3dc7a3(0x1b7)]]||_0x3dc7a3(0x1b9),_0x5c0227=_0x52025e['getTime']()-_0x387814*0xea60;if(_0x11d398>=_0x5c0227&&_0x11d398<_0x52025e[_0x3dc7a3(0x238)]()){const _0x4e927f=lastActions[_0x3dc7a3(0x1fb)+_0x429309['location']];if(_0x4e927f&&_0x11d398-_0x4e927f<CAL_COOLDOWN_MS)continue;const _0x30f0cf=await findRelatedId(_0x1dffec,_0x429309['id'],_0x3dc7a3(0x203));if(_0x30f0cf){let _0x307558=_0x1f277f[_0x429309['location']];if(_0x307558===undefined)_0x307558=_0x1f277f[_0x3dc7a3(0x1f8)];if(_0x307558===undefined)_0x307558=0x15;const _0x8c5190=await _0x1dffec['getForeignStateAsync'](_0x30f0cf);if(_0x8c5190&&typeof _0x8c5190[_0x3dc7a3(0x1cb)]===_0x3dc7a3(0x192)&&_0x8c5190[_0x3dc7a3(0x1cb)]<_0x307558-0.5){_0x1dffec[_0x3dc7a3(0x1ef)][_0x3dc7a3(0x1af)](_0x3dc7a3(0x20b)+_0x28703a+']:\x20Raum-Trigger\x20\x27'+_0x429309[_0x3dc7a3(0x1b7)]+'\x27\x20(Match:\x20'+_0x26344e+_0x3dc7a3(0x1d3)+_0x307558+_0x3dc7a3(0x1cd)+_0x387814+_0x3dc7a3(0x207)),await _0x1dffec[_0x3dc7a3(0x1ce)](_0x30f0cf,_0x307558),await logAutomationAction(_0x1dffec,_0x3dc7a3(0x19c)+_0x429309['location']+_0x3dc7a3(0x216)+_0x307558+_0x3dc7a3(0x1b8)+_0x28703a+')'),lastActions[_0x3dc7a3(0x1fb)+_0x429309[_0x3dc7a3(0x1b7)]]=_0x11d398;const _0x47fc96=_0x518860[_0x3dc7a3(0x202)](_0x2f15b4=>_0x2f15b4[_0x3dc7a3(0x1c1)]===_0x429309['location']);if(_0x47fc96!==-0x1)_0x518860[_0x3dc7a3(0x1c3)](_0x47fc96,0x1);_0x518860[_0x3dc7a3(0x1ca)]({'room':_0x429309[_0x3dc7a3(0x1b7)],'target':_0x307558,'until':_0x52025e[_0x3dc7a3(0x238)]()}),_0x11b0bf=!![];}}}}}}}_0x11b0bf&&await _0x1dffec[_0x3dc7a3(0x227)]('analysis.energy.activeEnforcements',{'val':JSON[_0x3dc7a3(0x1ad)](_0x518860),'ack':!![]});}catch(_0x1599ae){_0x1dffec[_0x3dc7a3(0x1ef)][_0x3dc7a3(0x20f)](_0x3dc7a3(0x1aa)+_0x1599ae['message']);}}async function manageMpcIntervention(_0x39a4b9,_0x240dda,_0x1c3d86){const _0x3c5826=a1_0x56bf63;try{const _0x1c2af1=_0x3c5826(0x1ab),_0x441b41=await _0x39a4b9[_0x3c5826(0x1fd)](_0x1c2af1);let _0x30091f=[];if(_0x441b41&&_0x441b41['val'])try{_0x30091f=JSON[_0x3c5826(0x1f0)](_0x441b41['val']);}catch(_0x52d54f){}const _0x30045f=_0x30091f[_0x3c5826(0x1b5)](_0x240dda);if(_0x1c3d86===_0x3c5826(0x190))_0x30045f===-0x1&&(_0x30091f['push'](_0x240dda),await _0x39a4b9[_0x3c5826(0x227)](_0x1c2af1,{'val':JSON[_0x3c5826(0x1ad)](_0x30091f),'ack':!![]}));else _0x1c3d86===_0x3c5826(0x237)&&(_0x30045f!==-0x1&&(_0x30091f['splice'](_0x30045f,0x1),await _0x39a4b9[_0x3c5826(0x227)](_0x1c2af1,{'val':JSON[_0x3c5826(0x1ad)](_0x30091f),'ack':!![]})));}catch(_0x17704d){}}function a1_0x5ceb(){const _0x213740=['toLowerCase','10199512mxoTWd','hm-rpc','r√ºckkehr','mpc_','from','remove','getTime','valveMapping','constructor','role','join','.data.table','pi_heating_demand','triggerTime','\x20ist\x20auf\x20','until','\x20wieder\x20auf\x20','Soll','level','2KuIHkf','dimmer','length','config','(((.+)+)+)+$','[MPC]\x20','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','consultButler','Unknown','sort','find','üî•\x20[MPC\x20ACTION]\x20Heize\x20','valve','Unbekannt','add','üìÖ\x20[MPC\x20INFO]\x20','number','position','analysis.energy.warmupTimes','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','contact','ACTUAL','switch','_date','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','Manuelles\x20Mapping','[CAL]\x20','üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','.4.VALVE_STATE','urlaub\x20ende','active','.1.TEMPERATURE','TRAIN_RL_PENALTY','includes','system.mode',':\x20Absenkung\x20auf\x20','analysis.automation.mode','message','rescue_','ACTUAL_TEMPERATURE','Calendar\x20Check\x20Error:\x20','analysis.energy.mpcActiveInterventions','now','stringify','soll','info','valve_position','_calName','score','manual','¬∞C\x20(nicht\x20','indexOf','current_heating_setpoint','location','¬∞C\x20(via\x20','Classic','.1.SET_POINT_TEMPERATURE','write','¬∞C\x20<\x20','forEach','\x20gefunden!','split','Ist','room','1995441EoxGwu','splice','target','temperature','light','unshift','analysis.energy.schedulePreview','.1.LEVEL','push','val','4184860FfCxwb','¬∞C\x20(Vorlauf:\x20','setForeignStateAsync','level.temperature','eventStart','toString','sensor',')\x20aktiv.\x20Heize\x20auf\x20','trim','open','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27','üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','state','approved','analysis.energy.activeEnforcements','string','üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','5249972UiQzEq','3295698kiIcvT','devices','SET','filter','analysis.energy.warmupTargets','thermostat','slice','üßπ\x20[MPC\x20CLEANUP]\x20','¬∞C).\x20Entferne\x20Status.','\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.','level.valve','common','temp','.4.SET_TEMPERATURE','search','date','set','log','parse','calendarSelection','normal','_meta','values','target_temperature','423299FZFVsf','type','default','analysis.automation.lastAction','.1.ACTUAL_TEMPERATURE','cal_','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20','getStateAsync','getForeignStateAsync',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','\x20auf\x20','getForeignObjectsAsync','findIndex','setpoint','ankunft','[WATCHDOG]\x20','¬∞C\x20->\x20','\x20min).','local_temperature','analysis.automation.actionLog','analysis.energy.rlPenalties','üìÖ\x20SMART\x20SCHEDULE\x20[','üö®\x20[MPC\x20WATCHDOG]\x20','thermostatMapping','minutes_safe','warn','SET_POINT_TEMPERATURE','replace','\x20min)','getForeignObjectAsync','5946717ibNagm','\x20wurde\x20manuell\x20erh√∂ht.','\x20->\x20','Nicht\x20gefunden','value.valve','¬∞C.','¬∞C).\x20Sparmodus\x20beendet!','openknx','\x20erreicht\x20Limit\x20(','sendToPythonWrapper','¬∞C!\x20(Puffer\x20leer).','Fehlt','¬∞C\x20(Kalender-Schutz)','event','stellwert','name','exports','too_cold','thermostat.setpoint','setStateAsync','wert','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','Auto-Erkennung','summary','calendarInstance','reason','¬∞C!\x20(Puffer:\x20','analysis.energy.warmupSources','üçÉ\x20[MPC\x20ACTION]\x20Senke\x20'];a1_0x5ceb=function(){return _0x213740;};return a1_0x5ceb();}async function cleanupGhostInterventions(_0x48a2f0){const _0x4766bf=a1_0x56bf63;try{const _0x1bc83c=_0x4766bf(0x1ab),_0x41ddf1=await _0x48a2f0[_0x4766bf(0x1fd)](_0x1bc83c);if(!_0x41ddf1||!_0x41ddf1[_0x4766bf(0x1cb)])return;const _0x5970d0=JSON['parse'](_0x41ddf1[_0x4766bf(0x1cb)]);if(!Array['isArray'](_0x5970d0)||_0x5970d0[_0x4766bf(0x184)]===0x0)return;let _0x30f01c={'default':0x15};try{const _0x1e7120=await _0x48a2f0[_0x4766bf(0x1fd)](_0x4766bf(0x1e2));if(_0x1e7120&&_0x1e7120[_0x4766bf(0x1cb)])_0x30f01c=JSON[_0x4766bf(0x1f0)](_0x1e7120[_0x4766bf(0x1cb)]);}catch(_0x1ebab4){}let _0xc6af37=[];try{const _0x4476ba=await _0x48a2f0[_0x4766bf(0x1fd)]('analysis.energy.ventilationAlerts');if(_0x4476ba&&_0x4476ba[_0x4766bf(0x1cb)])_0xc6af37=JSON['parse'](_0x4476ba[_0x4766bf(0x1cb)]);}catch(_0x496924){}let _0x439ffa={},_0x49b8a9=![];try{const _0x2a5a46=await _0x48a2f0[_0x4766bf(0x1fd)](_0x4766bf(0x20a));if(_0x2a5a46&&_0x2a5a46[_0x4766bf(0x1cb)])_0x439ffa=JSON[_0x4766bf(0x1f0)](_0x2a5a46[_0x4766bf(0x1cb)]);}catch(_0x514463){}if(_0x439ffa[_0x4766bf(0x1f3)]){const _0x225852=Date[_0x4766bf(0x1ac)]();for(const [_0x2e093d,_0x60a94b]of Object['entries'](_0x439ffa[_0x4766bf(0x1f3)])){_0x225852-_0x60a94b>PENALTY_TTL&&(delete _0x439ffa[_0x2e093d],delete _0x439ffa[_0x4766bf(0x1f3)][_0x2e093d],_0x49b8a9=!![],_0x48a2f0['log'][_0x4766bf(0x1af)](_0x4766bf(0x1d6)+_0x2e093d+_0x4766bf(0x188)));}}const _0x422e52=_0x48a2f0[_0x4766bf(0x185)][_0x4766bf(0x1df)]||[];let _0x5cdb71=![];for(let _0x7e6433=_0x5970d0[_0x4766bf(0x184)]-0x1;_0x7e6433>=0x0;_0x7e6433--){const _0x33bdc2=_0x5970d0[_0x7e6433],_0x2e1667=_0x422e52[_0x4766bf(0x18c)](_0x42bb2f=>normalize(_0x42bb2f['location'])===normalize(_0x33bdc2)&&(_0x42bb2f[_0x4766bf(0x1f7)]==='temperature'||_0x42bb2f[_0x4766bf(0x1f7)]===_0x4766bf(0x1e3)));if(!_0x2e1667){_0x48a2f0[_0x4766bf(0x1ef)][_0x4766bf(0x20f)](_0x4766bf(0x1d7)+_0x33bdc2+_0x4766bf(0x19a)),_0x5970d0[_0x4766bf(0x1c3)](_0x7e6433,0x1),_0x5cdb71=!![];continue;}if(_0x2e1667){const _0x3a36f1=await findRelatedId(_0x48a2f0,_0x2e1667['id'],_0x4766bf(0x203)),_0x430f2c=await _0x48a2f0[_0x4766bf(0x1fe)](_0x2e1667['id']);if(_0x3a36f1){const _0x1afed0=await _0x48a2f0[_0x4766bf(0x1fe)](_0x3a36f1);if(_0x1afed0&&typeof _0x1afed0['val']===_0x4766bf(0x192)){let _0x18b4b2=![],_0x1d2ca6='';Math['abs'](_0x1afed0[_0x4766bf(0x1cb)]-ECO_TEMP)>0.5&&(_0x18b4b2=!![],_0x1d2ca6=_0x4766bf(0x1b3));if(!_0x18b4b2&&_0x430f2c&&typeof _0x430f2c[_0x4766bf(0x1cb)]===_0x4766bf(0x192)){const _0x13c4c9=_0x30f01c[_0x33bdc2]||_0x30f01c['default']||0x15;_0x430f2c['val']<_0x13c4c9+0.2&&(_0x18b4b2=!![],_0x1d2ca6=_0x4766bf(0x225));}if(_0x18b4b2){if(_0x1d2ca6===_0x4766bf(0x1b3)){_0x48a2f0[_0x4766bf(0x1ef)][_0x4766bf(0x1af)](_0x4766bf(0x1e5)+_0x33bdc2+_0x4766bf(0x240)+_0x1afed0[_0x4766bf(0x1cb)]+_0x4766bf(0x1b4)+ECO_TEMP+_0x4766bf(0x1e6));const _0x48cc39=lastActions['cal_'+_0x33bdc2],_0x4c9e57=_0x48cc39&&Date[_0x4766bf(0x1ac)]()-_0x48cc39<0x2*0x3c*0x3e8;if(!_0x4c9e57&&_0x1afed0[_0x4766bf(0x1cb)]>ECO_TEMP+0.5){_0x48a2f0[_0x4766bf(0x21d)]&&(_0x48a2f0[_0x4766bf(0x1ef)][_0x4766bf(0x1af)]('üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20'+_0x33bdc2+_0x4766bf(0x215)),_0x48a2f0[_0x4766bf(0x21d)](_0x4766bf(0x1a2),{'room':_0x33bdc2}));const _0xfde7f8=_0x33bdc2+'_'+new Date()['getHours']();if(!_0x439ffa[_0xfde7f8]){_0x439ffa[_0xfde7f8]=0x1;if(!_0x439ffa[_0x4766bf(0x1f3)])_0x439ffa[_0x4766bf(0x1f3)]={};_0x439ffa[_0x4766bf(0x1f3)][_0xfde7f8]=Date[_0x4766bf(0x1ac)](),_0x49b8a9=!![];}}else _0x4c9e57&&_0x48a2f0[_0x4766bf(0x1ef)]['info'](_0x4766bf(0x191)+_0x33bdc2+_0x4766bf(0x1e7));}else{if(_0x1d2ca6==='too_cold'){let _0x486b65=![];if(_0xc6af37[_0x4766bf(0x18c)](_0x3f95d8=>_0x3f95d8[_0x4766bf(0x1c1)]===_0x33bdc2))_0x486b65=!![];const _0xdb1447=_0x422e52[_0x4766bf(0x1e1)](_0x5aae71=>normalize(_0x5aae71[_0x4766bf(0x1b7)])===normalize(_0x33bdc2)&&(_0x5aae71[_0x4766bf(0x1f7)]==='window'||_0x5aae71['type']===_0x4766bf(0x1d2)||_0x5aae71[_0x4766bf(0x1f7)]===_0x4766bf(0x196)));for(const _0xa2cfed of _0xdb1447){try{const _0x1f37ba=await _0x48a2f0[_0x4766bf(0x1fe)](_0xa2cfed['id']);if(_0x1f37ba&&(_0x1f37ba['val']===!![]||_0x1f37ba[_0x4766bf(0x1cb)]===0x1||String(_0x1f37ba['val'])['toLowerCase']()===_0x4766bf(0x1d5)))_0x486b65=!![];}catch(_0x32ea8b){}}if(_0x486b65)_0x48a2f0[_0x4766bf(0x1ef)][_0x4766bf(0x1af)]('üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20'+_0x33bdc2+_0x4766bf(0x229));else{const _0x4c06b2=_0x30f01c[_0x33bdc2]||_0x30f01c[_0x4766bf(0x1f8)]||0x15;_0x48a2f0[_0x4766bf(0x1ef)][_0x4766bf(0x1af)](_0x4766bf(0x20c)+_0x33bdc2+_0x4766bf(0x21c)+_0x430f2c[_0x4766bf(0x1cb)]+_0x4766bf(0x1bc)+(_0x4c06b2+0.2)+_0x4766bf(0x21a)),await _0x48a2f0[_0x4766bf(0x1ce)](_0x3a36f1,_0x4c06b2),await logAutomationAction(_0x48a2f0,_0x4766bf(0x205)+_0x33bdc2+_0x4766bf(0x1ff)+_0x4c06b2+'¬∞C'),lastActions[_0x4766bf(0x1a8)+_0x33bdc2]=Date[_0x4766bf(0x1ac)]();}}}_0x5970d0[_0x4766bf(0x1c3)](_0x7e6433,0x1),_0x5cdb71=!![];}}}}}_0x5cdb71&&await _0x48a2f0['setStateAsync'](_0x1bc83c,{'val':JSON['stringify'](_0x5970d0),'ack':!![]}),_0x49b8a9&&await _0x48a2f0[_0x4766bf(0x227)](_0x4766bf(0x20a),{'val':JSON[_0x4766bf(0x1ad)](_0x439ffa),'ack':!![]});}catch(_0x56d426){}}async function applyEnergySavings(_0x5b2c65,_0x43d9ca){const _0x18e67e=a1_0x56bf63;await cleanupGhostInterventions(_0x5b2c65);if(!_0x43d9ca||_0x43d9ca[_0x18e67e(0x184)]===0x0)return;const _0x1fec65=_0x5b2c65[_0x18e67e(0x185)]['devices']||[],_0x3a6603=Date[_0x18e67e(0x1ac)]();for(const _0x1b3b53 of _0x43d9ca){const _0x29201d=_0x1b3b53[_0x18e67e(0x1c1)],_0x4757ae=_0x1b3b53[_0x18e67e(0x20e)],_0xb8f398=_0x1b3b53[_0x18e67e(0x1c4)]||0x15;if(lastActions[_0x18e67e(0x1a8)+_0x29201d]&&_0x3a6603-lastActions['rescue_'+_0x29201d]<RESCUE_LOCK_MS)continue;const _0x3e9ac0=_0x1fec65['find'](_0x294a3b=>normalize(_0x294a3b[_0x18e67e(0x1b7)])===normalize(_0x29201d)&&(_0x294a3b[_0x18e67e(0x1f7)]===_0x18e67e(0x1c5)||_0x294a3b['type']===_0x18e67e(0x1e3)));if(!_0x3e9ac0)continue;const _0x51c820=await findRelatedId(_0x5b2c65,_0x3e9ac0['id'],_0x18e67e(0x203));if(_0x51c820){if(lastActions['mpc_'+_0x29201d]&&_0x3a6603-lastActions[_0x18e67e(0x235)+_0x29201d]<0x1e*0x3c*0x3e8)continue;const _0x22effc=await _0x5b2c65[_0x18e67e(0x1fe)](_0x51c820);if(_0x22effc&&typeof _0x22effc[_0x18e67e(0x1cb)]===_0x18e67e(0x192)){const _0x597996=_0x22effc[_0x18e67e(0x1cb)];_0x597996!==ECO_TEMP&&await manageMpcIntervention(_0x5b2c65,_0x29201d,_0x18e67e(0x237));if(_0x4757ae>0x1e)_0x597996>ECO_TEMP+0.5&&(_0x5b2c65['log'][_0x18e67e(0x1af)](_0x18e67e(0x230)+_0x29201d+_0x18e67e(0x200)+ECO_TEMP+_0x18e67e(0x22e)+_0x4757ae+_0x18e67e(0x212)),await _0x5b2c65[_0x18e67e(0x1ce)](_0x51c820,ECO_TEMP),await manageMpcIntervention(_0x5b2c65,_0x29201d,_0x18e67e(0x190)),lastActions[_0x18e67e(0x235)+_0x29201d]=_0x3a6603,await logAutomationAction(_0x5b2c65,_0x18e67e(0x187)+_0x29201d+_0x18e67e(0x1a5)+ECO_TEMP+'¬∞C'));else _0x4757ae<=0xf&&(_0x597996<_0xb8f398&&(_0x5b2c65[_0x18e67e(0x1ef)]['info'](_0x18e67e(0x18d)+_0x29201d+_0x18e67e(0x242)+_0xb8f398+_0x18e67e(0x21e)),await _0x5b2c65['setForeignStateAsync'](_0x51c820,_0xb8f398),await manageMpcIntervention(_0x5b2c65,_0x29201d,_0x18e67e(0x237)),lastActions[_0x18e67e(0x235)+_0x29201d]=_0x3a6603,await logAutomationAction(_0x5b2c65,'[MPC]\x20'+_0x29201d+':\x20Aufheizen\x20auf\x20'+_0xb8f398+'¬∞C')));}}else _0x5b2c65[_0x18e67e(0x1ef)][_0x18e67e(0x20f)](_0x18e67e(0x1fc)+_0x29201d+_0x18e67e(0x1be));}}module[a1_0x56bf63(0x224)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};