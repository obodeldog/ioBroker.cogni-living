const a1_0x1902b4=a1_0x1833;(function(_0x181eb4,_0x1e798e){const _0x21987b=a1_0x1833,_0x11a542=_0x181eb4();while(!![]){try{const _0x1491e1=-parseInt(_0x21987b(0x19e))/0x1+-parseInt(_0x21987b(0x1b3))/0x2*(parseInt(_0x21987b(0x225))/0x3)+-parseInt(_0x21987b(0x24f))/0x4*(-parseInt(_0x21987b(0x25b))/0x5)+-parseInt(_0x21987b(0x1c4))/0x6+-parseInt(_0x21987b(0x25c))/0x7+parseInt(_0x21987b(0x1f3))/0x8+-parseInt(_0x21987b(0x19f))/0x9;if(_0x1491e1===_0x1e798e)break;else _0x11a542['push'](_0x11a542['shift']());}catch(_0x576b53){_0x11a542['push'](_0x11a542['shift']());}}}(a1_0x2e7c,0xda42e));const a1_0x646122=(function(){let _0x5a5ced=!![];return function(_0x1a87ef,_0x3d1ba2){const _0x39c1e0=_0x5a5ced?function(){if(_0x3d1ba2){const _0x30b9ee=_0x3d1ba2['apply'](_0x1a87ef,arguments);return _0x3d1ba2=null,_0x30b9ee;}}:function(){};return _0x5a5ced=![],_0x39c1e0;};}()),a1_0x230095=a1_0x646122(this,function(){const _0x49c829=a1_0x1833;return a1_0x230095[_0x49c829(0x22a)]()['search'](_0x49c829(0x23e))[_0x49c829(0x22a)]()['constructor'](a1_0x230095)[_0x49c829(0x217)](_0x49c829(0x23e));});a1_0x230095();'use strict';const aiAgent=require(a1_0x1902b4(0x202)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x332350){const _0x13800b=a1_0x1902b4;if(!_0x332350)return'';return _0x332350[_0x13800b(0x21b)]()[_0x13800b(0x243)](/\s+/g,'')[_0x13800b(0x1bf)]();}function getWarmupRobust(_0x530b3e,_0x514285){const _0x4db0ff=a1_0x1902b4;if(!_0x530b3e||!_0x514285)return 0x3c;if(_0x530b3e[_0x514285]!==undefined)return _0x530b3e[_0x514285];const _0xc87ef5=_0x514285['toLowerCase']()[_0x4db0ff(0x243)](/√§/g,'ae')[_0x4db0ff(0x243)](/√∂/g,'oe')['replace'](/√º/g,'ue')['replace'](/√ü/g,'ss')[_0x4db0ff(0x243)](/\s+/g,'_')[_0x4db0ff(0x243)](/[^a-z0-9_]/g,'');if(_0x530b3e[_0xc87ef5]!==undefined)return _0x530b3e[_0xc87ef5];return 0x3c;}async function logAutomationAction(_0x4a699c,_0x18226b){const _0x52a501=a1_0x1902b4;await _0x4a699c[_0x52a501(0x201)]('analysis.automation.lastAction',{'val':_0x18226b,'ack':!![]});try{const _0x2c3b4d=_0x52a501(0x1f5),_0x5afabc=await _0x4a699c[_0x52a501(0x24c)](_0x2c3b4d);let _0x3f12df=[];if(_0x5afabc&&_0x5afabc[_0x52a501(0x24e)])try{_0x3f12df=JSON[_0x52a501(0x1d7)](_0x5afabc[_0x52a501(0x24e)]);}catch(_0x4f0518){}_0x3f12df['unshift']({'ts':Date[_0x52a501(0x1ed)](),'msg':_0x18226b});if(_0x3f12df['length']>0x32)_0x3f12df=_0x3f12df[_0x52a501(0x1e9)](0x0,0x32);await _0x4a699c[_0x52a501(0x201)](_0x2c3b4d,{'val':JSON[_0x52a501(0x22e)](_0x3f12df),'ack':!![]});}catch(_0x402d5c){}}function a1_0x2e7c(){const _0x3f8a0d=['106803ETQSge','\x20gefunden!','remove','üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','target_temperature','cal_','map','system.mode','\x20min).','error','Unbekannt','value.valve','ACTUAL','thermostat','.1.TEMPERATURE','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','thermostat.setpoint','¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','string','2HMtYMt',']:\x20Raum-Trigger\x20\x27','[FORCE]\x20','¬∞C\x20<\x20','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','analysis.energy.warmupTimes','SET','eventStart','Auto-Erkennung','too_cold','filter','Ist','trim','state','room','Enforcement\x20Monitor\x20Error:\x20','active','403314vzPvOh','setForeignStateAsync','includes','analysis.energy.schedulePreview','date','off','add','r√ºckkehr','¬∞C.','¬∞C).\x20Sparmodus\x20beendet!','push','level','¬∞C\x20(Kalender-Schutz)','open','info',':\x20Absenkung\x20auf\x20',':\x20Aufheizen\x20auf\x20','position','rescue_','parse','analysis.automation.mode','Soll','stellwert','Manuelles\x20Mapping','\x20erreicht\x20Limit\x20(','getForeignObjectsAsync','üö®\x20[MPC\x20WATCHDOG]\x20','Pr√§diktion:\x20','.1.LEVEL','wert','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20','isArray','approved','warn','getForeignStateAsync','.1.SET_POINT_TEMPERATURE','calendarInstance','slice','number','valve_position','[CAL]\x20','now','PERFECT','analysis.energy.warmupTargets','.4.VALVE_STATE','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','\x20->\x20Schalte\x20','13644624cYNsyV','set','analysis.automation.actionLog','[WATCHDOG]\x20','name','analysis.energy.activeEnforcements','write','¬∞C!\x20(Puffer:\x20','message','valve','triggerTime',')\x20aktiv.\x20Heize\x20auf\x20','from','Nicht\x20gefunden','setStateAsync','./ai_agent','mpc_','find','consultButler','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','type','temperature','level.temperature','Calendar\x20Check\x20Error:\x20','indexOf','analysis.energy.mpcActiveInterventions','üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','score','calendarSelection','üçÉ\x20[MPC\x20ACTION]\x20Senke\x20','analysis.energy.rlPenalties','openknx','join','toUpperCase','_calName','¬∞C\x20(Vorlauf:\x20','search','log','devices','soll','toLowerCase','.data.table','common','sendToPythonWrapper','level.valve','_meta','setpoint','target','ist','analysis.automation.confidenceThreshold','1014501vmagBI','event','ACTUAL_TEMPERATURE','currentSystemMode','üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','toString','default','üî•\x20[MPC\x20ACTION]\x20Heize\x20','split','stringify','useCalendar','findIndex','splice','üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','getForeignObjectAsync','\x27\x20(Match:\x20','thermostatMapping','.1.ACTUAL_TEMPERATURE','entries','localeCompare','urlaub\x20ende','messwert','\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27','window','(((.+)+)+)+$','forEach','contact','¬∞C\x20(nicht\x20','exports','replace','length','dimmer','sensor','values','\x20min)','getHours','temp','¬∞C!\x20(Puffer\x20leer).','getStateAsync','local_temperature','val','4SVZjEH','manual','pi_heating_demand','\x20wieder\x20auf\x20','sort','role','getTime','analysis.energy.ventilationAlerts','occupied_heating_setpoint','light','switch','valveMapping','8779615PHFWZJ','4066342VaDPEv','minutes_safe','config','summary','_date','Classic','location','TRAIN_RL_PENALTY','1569344GGDPhX'];a1_0x2e7c=function(){return _0x3f8a0d;};return a1_0x2e7c();}async function handlePrediction(_0x189c47,_0x417e61,_0x245770){const _0x12f4e8=a1_0x1902b4;if(!_0x417e61||_0x417e61==='Unknown')return;let _0x1876ef=_0x12f4e8(0x1c9),_0x57cef1=0.6;try{const _0x3c3236=await _0x189c47[_0x12f4e8(0x24c)](_0x12f4e8(0x1d8));if(_0x3c3236&&_0x3c3236['val'])_0x1876ef=_0x3c3236[_0x12f4e8(0x24e)];const _0x2f2d7b=await _0x189c47['getStateAsync'](_0x12f4e8(0x224));if(_0x2f2d7b&&_0x2f2d7b[_0x12f4e8(0x24e)])_0x57cef1=_0x2f2d7b[_0x12f4e8(0x24e)];}catch(_0x59a5da){}if(_0x1876ef===_0x12f4e8(0x1c9)||_0x245770<_0x57cef1)return;const _0x3b1331=Date[_0x12f4e8(0x1ed)]();if(lastActions[_0x417e61]&&_0x3b1331-lastActions[_0x417e61]<COOLDOWN_MS)return;const _0x46ff95=_0x189c47[_0x12f4e8(0x25e)][_0x12f4e8(0x219)]||[],_0x3a6849=normalize(_0x417e61),_0x1638ab=_0x46ff95[_0x12f4e8(0x204)](_0x4d9f98=>normalize(_0x4d9f98['location'])===_0x3a6849&&(_0x4d9f98[_0x12f4e8(0x207)]===_0x12f4e8(0x258)||_0x4d9f98[_0x12f4e8(0x207)]===_0x12f4e8(0x245)||_0x4d9f98['type']===_0x12f4e8(0x259)));if(!_0x1638ab)return;const _0x209c80=await aiAgent[_0x12f4e8(0x205)](_0x189c47,_0x417e61,_0x1638ab[_0x12f4e8(0x1f7)],_0x245770);if(!_0x209c80[_0x12f4e8(0x1e4)])return;const _0x1bf448=_0x12f4e8(0x1df)+_0x417e61+_0x12f4e8(0x1f2)+_0x1638ab[_0x12f4e8(0x1f7)]+'\x20('+_0x209c80['reason']+')';await logAutomationAction(_0x189c47,'['+_0x1876ef[_0x12f4e8(0x214)]()+']\x20'+_0x1bf448);if(_0x1876ef===_0x12f4e8(0x1c3)){const _0x441b9f=await _0x189c47['getForeignStateAsync'](_0x1638ab['id']);(!_0x441b9f||!_0x441b9f[_0x12f4e8(0x24e)]&&_0x441b9f[_0x12f4e8(0x24e)]!==!![])&&await _0x189c47[_0x12f4e8(0x1c5)](_0x1638ab['id'],!![]),lastActions[_0x417e61]=_0x3b1331;}}function a1_0x1833(_0x31ebdf,_0x3f19f8){const _0x5e0743=a1_0x2e7c();return a1_0x1833=function(_0x230095,_0x646122){_0x230095=_0x230095-0x19b;let _0x2e7c7c=_0x5e0743[_0x230095];return _0x2e7c7c;},a1_0x1833(_0x31ebdf,_0x3f19f8);}async function findRelatedId(_0x4de0f1,_0x2f97fd,_0x1417bd=a1_0x1902b4(0x221)){const _0x3f4135=a1_0x1902b4;if(_0x1417bd===_0x3f4135(0x221)&&_0x4de0f1[_0x3f4135(0x25e)][_0x3f4135(0x235)]){let _0x2c440b=_0x4de0f1[_0x3f4135(0x25e)][_0x3f4135(0x235)];if(typeof _0x2c440b===_0x3f4135(0x1b2))try{_0x2c440b=JSON[_0x3f4135(0x1d7)](_0x2c440b);}catch(_0x4affc1){}if(_0x2c440b&&_0x2c440b[_0x2f97fd])return _0x2c440b[_0x2f97fd];}if(_0x1417bd===_0x3f4135(0x1fc)&&_0x4de0f1['config']['valveMapping']){let _0x5caa6e=_0x4de0f1[_0x3f4135(0x25e)][_0x3f4135(0x25a)];if(typeof _0x5caa6e==='string')try{_0x5caa6e=JSON[_0x3f4135(0x1d7)](_0x5caa6e);}catch(_0x17c9c2){}if(_0x5caa6e&&_0x5caa6e[_0x2f97fd])return _0x5caa6e[_0x2f97fd];}let _0x1c8aa8=[];if(_0x1417bd==='setpoint')_0x1c8aa8=[{'s':_0x3f4135(0x236),'t':_0x3f4135(0x1e7)},{'s':_0x3f4135(0x1ad),'t':_0x3f4135(0x1e7)},{'s':_0x3f4135(0x1ad),'t':'.4.SET_TEMPERATURE'},{'s':_0x3f4135(0x227),'t':'SET_POINT_TEMPERATURE'},{'s':_0x3f4135(0x24d),'t':_0x3f4135(0x257)},{'s':_0x3f4135(0x24d),'t':'current_heating_setpoint'},{'s':'temperature','t':_0x3f4135(0x1a3)},{'s':_0x3f4135(0x1ab),'t':_0x3f4135(0x1b9)},{'s':_0x3f4135(0x1be),'t':_0x3f4135(0x1d9)},{'s':'temperature','t':_0x3f4135(0x221)}];else _0x1417bd===_0x3f4135(0x1fc)&&(_0x1c8aa8=[{'s':_0x3f4135(0x236),'t':_0x3f4135(0x1e0)},{'s':_0x3f4135(0x1ad),'t':'.1.LEVEL'},{'s':'.1.TEMPERATURE','t':_0x3f4135(0x1f0)},{'s':_0x3f4135(0x24d),'t':_0x3f4135(0x251)},{'s':'temperature','t':_0x3f4135(0x1eb)},{'s':_0x3f4135(0x208),'t':'level'}]);for(const _0x56f5a6 of _0x1c8aa8){if(_0x2f97fd[_0x3f4135(0x1c6)](_0x56f5a6['s'])){const _0x4f1a23=_0x2f97fd[_0x3f4135(0x243)](_0x56f5a6['s'],_0x56f5a6['t']),_0x4fa4fc=await _0x4de0f1[_0x3f4135(0x233)](_0x4f1a23);if(_0x4fa4fc)return _0x4f1a23;}}try{const _0x1bff6b=_0x2f97fd[_0x3f4135(0x22d)]('.');if(_0x1bff6b['length']>0x2){const _0x212cea=_0x1bff6b[_0x3f4135(0x1e9)](0x0,-0x1)[_0x3f4135(0x213)]('.'),_0x1dd566=await _0x4de0f1[_0x3f4135(0x1dd)](_0x212cea+'.*'),_0xde1b04=[],_0xfb8af0=_0x2f97fd['split'](/[._]+/)['filter'](_0x5ee2ad=>![_0x3f4135(0x212),'0','hm-rpc',_0x3f4135(0x223),_0x3f4135(0x1e1),_0x3f4135(0x208),'actual',_0x3f4135(0x246),_0x3f4135(0x23a),_0x3f4135(0x1c0)][_0x3f4135(0x1c6)](_0x5ee2ad[_0x3f4135(0x21b)]()));for(const [_0x49b5df,_0x11c795]of Object[_0x3f4135(0x237)](_0x1dd566)){if(_0x49b5df===_0x2f97fd)continue;if(_0x11c795&&_0x11c795[_0x3f4135(0x21d)]){const _0x27f72e=_0x49b5df['toLowerCase'](),_0x18d233=(_0x11c795[_0x3f4135(0x21d)][_0x3f4135(0x254)]||'')[_0x3f4135(0x21b)](),_0x2b5cc3=(_0x11c795['common']['unit']||'')[_0x3f4135(0x21b)]();let _0x9f420e=![];if(_0x1417bd===_0x3f4135(0x221)&&_0x11c795[_0x3f4135(0x21d)][_0x3f4135(0x1f9)]===!![])_0x9f420e=_0x27f72e[_0x3f4135(0x1c6)](_0x3f4135(0x1f4))||_0x27f72e[_0x3f4135(0x1c6)](_0x3f4135(0x21a))||_0x27f72e[_0x3f4135(0x1c6)](_0x3f4135(0x222))||_0x18d233[_0x3f4135(0x1c6)](_0x3f4135(0x209))||_0x18d233[_0x3f4135(0x1c6)](_0x3f4135(0x1af));else _0x1417bd===_0x3f4135(0x1fc)&&(_0x9f420e=_0x27f72e[_0x3f4135(0x1c6)](_0x3f4135(0x1cf))||_0x27f72e[_0x3f4135(0x1c6)](_0x3f4135(0x1fc))||_0x27f72e['includes'](_0x3f4135(0x1da))||_0x27f72e['includes'](_0x3f4135(0x1d5))||_0x18d233[_0x3f4135(0x1c6)](_0x3f4135(0x21f))||_0x18d233[_0x3f4135(0x1c6)](_0x3f4135(0x1aa))||_0x2b5cc3[_0x3f4135(0x1c6)]('%'));if(_0x9f420e){const _0x321942=_0x49b5df[_0x3f4135(0x22d)](/[._]+/)[_0x3f4135(0x1a5)](_0x58c157=>_0x58c157[_0x3f4135(0x21b)]());let _0x3df78d=0x0;_0xfb8af0[_0x3f4135(0x23f)](_0x21ffb5=>{const _0x2c1faf=_0x3f4135;if(_0x321942[_0x2c1faf(0x1c6)](_0x21ffb5[_0x2c1faf(0x21b)]()))_0x3df78d++;}),_0xde1b04[_0x3f4135(0x1ce)]({'id':_0x49b5df,'score':_0x3df78d});}}}if(_0xde1b04[_0x3f4135(0x244)]>0x0){_0xde1b04[_0x3f4135(0x253)]((_0xaf44b5,_0x4c083c)=>_0x4c083c[_0x3f4135(0x20e)]-_0xaf44b5[_0x3f4135(0x20e)]);if(_0xde1b04[0x0][_0x3f4135(0x20e)]>0x0)return _0xde1b04[0x0]['id'];}}}catch(_0x144b3d){}return null;}async function scanThermostats(_0x1c74af){const _0x4b352f=a1_0x1902b4,_0x5379b4=_0x1c74af[_0x4b352f(0x25e)][_0x4b352f(0x219)]||[],_0x5cc812=[],_0x18cc0c=_0x5379b4[_0x4b352f(0x1bd)](_0x3096fe=>_0x3096fe['id']&&_0x3096fe['id'][_0x4b352f(0x1c6)](_0x4b352f(0x208))||_0x3096fe[_0x4b352f(0x207)]&&[_0x4b352f(0x208),_0x4b352f(0x1ac),_0x4b352f(0x246)][_0x4b352f(0x1c6)](_0x3096fe['type'])||_0x3096fe[_0x4b352f(0x1f7)]&&_0x3096fe[_0x4b352f(0x1f7)]['toLowerCase']()[_0x4b352f(0x1c6)](_0x4b352f(0x24a)));for(const _0x5aa15b of _0x18cc0c){const _0x154c70=await findRelatedId(_0x1c74af,_0x5aa15b['id'],_0x4b352f(0x221)),_0x2a9687=await findRelatedId(_0x1c74af,_0x5aa15b['id'],_0x4b352f(0x1fc));let _0x840ff6=_0x4b352f(0x200),_0x41c26f=![],_0x35cc81=_0x1c74af[_0x4b352f(0x25e)]['thermostatMapping']||{};if(typeof _0x35cc81==='string')try{_0x35cc81=JSON[_0x4b352f(0x1d7)](_0x35cc81);}catch(_0x1d74ad){}let _0x14ac53=_0x1c74af['config'][_0x4b352f(0x25a)]||{};if(typeof _0x14ac53==='string')try{_0x14ac53=JSON[_0x4b352f(0x1d7)](_0x14ac53);}catch(_0x3f6f3a){}if(_0x35cc81[_0x5aa15b['id']]&&_0x35cc81[_0x5aa15b['id']]===_0x154c70||_0x14ac53[_0x5aa15b['id']]&&_0x14ac53[_0x5aa15b['id']]===_0x2a9687)_0x840ff6=_0x4b352f(0x1db),_0x41c26f=!![];else(_0x154c70||_0x2a9687)&&(_0x840ff6=_0x4b352f(0x1bb));_0x5cc812[_0x4b352f(0x1ce)]({'room':_0x5aa15b[_0x4b352f(0x19c)]||_0x4b352f(0x1a9),'sensorId':_0x5aa15b['id'],'setpointId':_0x154c70||'-','valveId':_0x2a9687||'-','source':_0x840ff6,'isManual':_0x41c26f,'status':_0x154c70&&_0x2a9687?_0x4b352f(0x1ee):_0x154c70?'OK':'Fehlt'});}return _0x5cc812['sort']((_0x204eeb,_0x11c807)=>_0x204eeb[_0x4b352f(0x1c1)][_0x4b352f(0x238)](_0x11c807[_0x4b352f(0x1c1)]));}async function updateSchedulePreview(_0x3e6ba6){const _0xa5569a=a1_0x1902b4;if(!_0x3e6ba6[_0xa5569a(0x25e)][_0xa5569a(0x22f)]||!_0x3e6ba6[_0xa5569a(0x25e)]['calendarInstance'])return;let _0x27e52a={};try{const _0x16b989=await _0x3e6ba6[_0xa5569a(0x24c)]('analysis.energy.warmupTimes');if(_0x16b989&&_0x16b989['val'])_0x27e52a=JSON[_0xa5569a(0x1d7)](_0x16b989[_0xa5569a(0x24e)]);}catch(_0x1c4719){}const _0x4054ea=[],_0x401e2f=Date['now'](),_0x3015a0=0x30*0x3c*0x3c*0x3e8;try{const _0x4deaf5=await _0x3e6ba6['getForeignStateAsync'](_0x3e6ba6[_0xa5569a(0x25e)][_0xa5569a(0x1e8)]+_0xa5569a(0x21c));if(!_0x4deaf5||!_0x4deaf5['val'])return;const _0x761fa1=JSON[_0xa5569a(0x1d7)](_0x4deaf5[_0xa5569a(0x24e)]),_0x46e945=_0x3e6ba6['config']['calendarSelection']||[],_0x3ce542=_0x3e6ba6[_0xa5569a(0x25e)][_0xa5569a(0x219)]||[],_0x13dae7=new Set();_0x3ce542[_0xa5569a(0x23f)](_0x4f0d3d=>{const _0x2b0427=_0xa5569a;if(_0x4f0d3d['location'])_0x13dae7['add'](_0x4f0d3d[_0x2b0427(0x19c)]);});for(const _0x165c9f of _0x761fa1){if(_0x165c9f['_calName']&&_0x46e945[_0xa5569a(0x244)]>0x0&&!_0x46e945['includes'](_0x165c9f['_calName']))continue;const _0x5b4426=_0x165c9f[_0xa5569a(0x260)]||_0x165c9f[_0xa5569a(0x1ba)]||_0x165c9f['date'];if(!_0x5b4426)continue;const _0x4dda93=new Date(_0x5b4426),_0x3247ce=_0x4dda93[_0xa5569a(0x255)]();if(isNaN(_0x3247ce))continue;if(_0x3247ce<_0x401e2f)continue;if(_0x3247ce>_0x401e2f+_0x3015a0)continue;const _0x1585f2=(_0x165c9f['event']||_0x165c9f[_0xa5569a(0x25f)]||'')[_0xa5569a(0x21b)]();let _0x1667c4=![],_0x3e7360=[],_0xd26ddf=_0x165c9f[_0xa5569a(0x226)]||_0x165c9f[_0xa5569a(0x25f)]||_0xa5569a(0x1a9);if(_0x1585f2['includes'](_0xa5569a(0x239))||_0x1585f2['includes'](_0xa5569a(0x1cb))||_0x1585f2[_0xa5569a(0x1c6)]('ankunft'))_0x1667c4=!![],_0x3e7360=Array[_0xa5569a(0x1ff)](_0x13dae7);else for(const _0x57ae8a of _0x13dae7){if(_0x1585f2[_0xa5569a(0x1c6)](_0x57ae8a[_0xa5569a(0x21b)]()))_0x3e7360[_0xa5569a(0x1ce)](_0x57ae8a);}_0x3e7360['length']>0x0&&_0x3e7360['forEach'](_0x46e1d8=>{const _0x3ff104=_0xa5569a;let _0x4f6c35=0x3c;if(_0x1667c4){let _0x329e91=0x0;Object['values'](_0x27e52a)['forEach'](_0x499345=>{if(_0x499345>_0x329e91)_0x329e91=_0x499345;}),_0x4f6c35=_0x329e91>0x0?_0x329e91:0x78;}else _0x4f6c35=getWarmupRobust(_0x27e52a,_0x46e1d8);const _0x3f874e=new Date(_0x3247ce-_0x4f6c35*0xea60);_0x4054ea[_0x3ff104(0x1ce)]({'eventTime':_0x3247ce,'triggerTime':_0x3f874e[_0x3ff104(0x255)](),'room':_0x46e1d8,'minutes':_0x4f6c35,'reason':_0xd26ddf,'isGlobal':_0x1667c4});});}}catch(_0x4263a3){}_0x4054ea['sort']((_0x467681,_0x294ea5)=>_0x467681[_0xa5569a(0x1fd)]-_0x294ea5[_0xa5569a(0x1fd)]);const _0x202afd=_0x4054ea[_0xa5569a(0x1e9)](0x0,0x5);await _0x3e6ba6['setStateAsync'](_0xa5569a(0x1c7),{'val':JSON[_0xa5569a(0x22e)](_0x202afd),'ack':!![]});}async function monitorEnforcements(_0x35b7ab){const _0x3ba252=a1_0x1902b4;try{const _0x596708=_0x3ba252(0x1f8),_0x1eb26c=await _0x35b7ab[_0x3ba252(0x24c)](_0x596708);if(!_0x1eb26c||!_0x1eb26c[_0x3ba252(0x24e)])return;let _0x4d6988=[];try{_0x4d6988=JSON[_0x3ba252(0x1d7)](_0x1eb26c[_0x3ba252(0x24e)]);}catch(_0x1054a8){return;}if(!Array['isArray'](_0x4d6988)||_0x4d6988[_0x3ba252(0x244)]===0x0)return;const _0x364ff8=Date['now'](),_0x565667=_0x35b7ab[_0x3ba252(0x25e)][_0x3ba252(0x219)]||[];let _0x238a82=![];for(let _0xf5b67b=_0x4d6988['length']-0x1;_0xf5b67b>=0x0;_0xf5b67b--){const _0x312964=_0x4d6988[_0xf5b67b];if(_0x364ff8>=_0x312964['until']){_0x35b7ab['log'][_0x3ba252(0x1d2)](_0x3ba252(0x232)+_0x312964[_0x3ba252(0x1c1)]+_0x3ba252(0x1f1)),_0x4d6988['splice'](_0xf5b67b,0x1),_0x238a82=!![];continue;}const _0x157841=_0x565667[_0x3ba252(0x204)](_0x22a52e=>normalize(_0x22a52e[_0x3ba252(0x19c)])===normalize(_0x312964['room'])&&(_0x22a52e[_0x3ba252(0x207)]===_0x3ba252(0x208)||_0x22a52e['type']===_0x3ba252(0x1ac)));if(_0x157841){const _0x3e9b70=await findRelatedId(_0x35b7ab,_0x157841['id'],_0x3ba252(0x221));if(_0x3e9b70){const _0x1e3c5c=await _0x35b7ab['getForeignStateAsync'](_0x3e9b70);_0x1e3c5c&&typeof _0x1e3c5c[_0x3ba252(0x24e)]===_0x3ba252(0x1ea)&&(_0x1e3c5c[_0x3ba252(0x24e)]<0xf&&(_0x35b7ab[_0x3ba252(0x218)][_0x3ba252(0x1e5)](_0x3ba252(0x1a2)+_0x312964[_0x3ba252(0x1c1)]+'\x20auf\x20'+_0x1e3c5c[_0x3ba252(0x24e)]+_0x3ba252(0x1b0)+_0x312964[_0x3ba252(0x222)]+_0x3ba252(0x1cc)),await _0x35b7ab[_0x3ba252(0x1c5)](_0x3e9b70,_0x312964[_0x3ba252(0x222)]),await logAutomationAction(_0x35b7ab,_0x3ba252(0x1b5)+_0x312964[_0x3ba252(0x1c1)]+':\x20'+_0x1e3c5c[_0x3ba252(0x24e)]+'¬∞C\x20->\x20'+_0x312964[_0x3ba252(0x222)]+_0x3ba252(0x1d0))));}}}_0x238a82&&await _0x35b7ab['setStateAsync'](_0x596708,{'val':JSON[_0x3ba252(0x22e)](_0x4d6988),'ack':!![]});}catch(_0x2d4739){_0x35b7ab['log'][_0x3ba252(0x1a8)](_0x3ba252(0x1c2)+_0x2d4739[_0x3ba252(0x1fb)]);}}async function checkCalendarTriggers(_0x343d44){const _0xfda75e=a1_0x1902b4;if(!_0x343d44[_0xfda75e(0x25e)][_0xfda75e(0x22f)]||!_0x343d44[_0xfda75e(0x25e)][_0xfda75e(0x1e8)])return;await updateSchedulePreview(_0x343d44);let _0x30d1f2={},_0x32c8c8={};try{const _0x2317e1=await _0x343d44[_0xfda75e(0x24c)](_0xfda75e(0x1b8));if(_0x2317e1&&_0x2317e1[_0xfda75e(0x24e)])_0x30d1f2=JSON[_0xfda75e(0x1d7)](_0x2317e1[_0xfda75e(0x24e)]);const _0x4618c9=await _0x343d44['getStateAsync']('analysis.energy.warmupSources');if(_0x4618c9&&_0x4618c9[_0xfda75e(0x24e)])_0x32c8c8=JSON[_0xfda75e(0x1d7)](_0x4618c9['val']);}catch(_0x2b95f7){}let _0x546a1e={'default':0x15};try{const _0x25a3d2=await _0x343d44[_0xfda75e(0x24c)](_0xfda75e(0x1ef));if(_0x25a3d2&&_0x25a3d2[_0xfda75e(0x24e)])_0x546a1e=JSON['parse'](_0x25a3d2[_0xfda75e(0x24e)]);}catch(_0x333ae6){}let _0x753851=[];try{const _0x20202b=await _0x343d44[_0xfda75e(0x24c)](_0xfda75e(0x1f8));if(_0x20202b&&_0x20202b[_0xfda75e(0x24e)])_0x753851=JSON[_0xfda75e(0x1d7)](_0x20202b['val']);}catch(_0x5966bc){}try{const _0x1fc341=await _0x343d44[_0xfda75e(0x1e6)](_0x343d44[_0xfda75e(0x25e)][_0xfda75e(0x1e8)]+_0xfda75e(0x21c));if(!_0x1fc341||!_0x1fc341[_0xfda75e(0x24e)])return;const _0x23fb63=JSON['parse'](_0x1fc341[_0xfda75e(0x24e)]),_0x78ab57=Date[_0xfda75e(0x1ed)](),_0x3fce48=_0x343d44[_0xfda75e(0x25e)][_0xfda75e(0x219)]||[],_0x1a0cb3=_0x343d44[_0xfda75e(0x25e)][_0xfda75e(0x20f)]||[];let _0x1ae9be=![];for(const _0x4a5e1b of _0x23fb63){if(_0x4a5e1b[_0xfda75e(0x215)]&&_0x1a0cb3[_0xfda75e(0x244)]>0x0&&!_0x1a0cb3['includes'](_0x4a5e1b[_0xfda75e(0x215)]))continue;const _0x348cce=_0x4a5e1b[_0xfda75e(0x260)]||_0x4a5e1b['eventStart']||_0x4a5e1b[_0xfda75e(0x1c8)];if(!_0x348cce)continue;const _0x3a4a13=new Date(_0x348cce);if(isNaN(_0x3a4a13['getTime']()))continue;const _0x5a64f9=(_0x4a5e1b[_0xfda75e(0x226)]||_0x4a5e1b['summary']||'')['toLowerCase']();if(_0x5a64f9['includes']('urlaub\x20ende')||_0x5a64f9[_0xfda75e(0x1c6)](_0xfda75e(0x1cb))||_0x5a64f9[_0xfda75e(0x1c6)]('ankunft')){let _0x29ba64=0x0;Object[_0xfda75e(0x247)](_0x30d1f2)[_0xfda75e(0x23f)](_0x34b4dc=>{if(_0x34b4dc>_0x29ba64)_0x29ba64=_0x34b4dc;});if(_0x29ba64===0x0)_0x29ba64=0x78;const _0x23ee8e=_0x3a4a13['getTime']()-_0x29ba64*0xea60;_0x78ab57>=_0x23ee8e&&_0x78ab57<_0x3a4a13[_0xfda75e(0x255)]()&&(_0x343d44[_0xfda75e(0x228)]!=='normal'&&(_0x343d44[_0xfda75e(0x218)][_0xfda75e(0x1d2)](_0xfda75e(0x1ae)+_0x29ba64+_0xfda75e(0x1a7)),await _0x343d44[_0xfda75e(0x201)](_0xfda75e(0x1a6),{'val':'normal','ack':![]})));}for(const _0x336876 of _0x3fce48){if(_0x336876['location']){const _0x1a10a5=_0x336876[_0xfda75e(0x19c)][_0xfda75e(0x21b)](),_0x243f63=(_0x336876['name']||'')[_0xfda75e(0x21b)]();let _0x4db5e5=_0x5a64f9[_0xfda75e(0x1c6)](_0x1a10a5);!_0x4db5e5&&_0x243f63[_0xfda75e(0x244)]>0x3&&_0x5a64f9['includes'](_0x243f63)&&(_0x4db5e5=!![]);if(_0x4db5e5){const _0x216828=getWarmupRobust(_0x30d1f2,_0x336876[_0xfda75e(0x19c)]),_0x4503d5=_0x32c8c8[_0x336876[_0xfda75e(0x19c)]]||_0xfda75e(0x19b),_0x5712b3=_0x3a4a13[_0xfda75e(0x255)]()-_0x216828*0xea60;if(_0x78ab57>=_0x5712b3&&_0x78ab57<_0x3a4a13['getTime']()){const _0x3de3b7=lastActions[_0xfda75e(0x1a4)+_0x336876[_0xfda75e(0x19c)]];if(_0x3de3b7&&_0x78ab57-_0x3de3b7<CAL_COOLDOWN_MS)continue;const _0x7482fc=await findRelatedId(_0x343d44,_0x336876['id'],'setpoint');if(_0x7482fc){let _0x5d2bfe=_0x546a1e[_0x336876['location']];if(_0x5d2bfe===undefined)_0x5d2bfe=_0x546a1e[_0xfda75e(0x22b)];if(_0x5d2bfe===undefined)_0x5d2bfe=0x15;const _0x41ead6=await _0x343d44[_0xfda75e(0x1e6)](_0x7482fc);if(_0x41ead6&&typeof _0x41ead6[_0xfda75e(0x24e)]==='number'&&_0x41ead6[_0xfda75e(0x24e)]<_0x5d2bfe-0.5){_0x343d44[_0xfda75e(0x218)][_0xfda75e(0x1d2)]('üìÖ\x20SMART\x20SCHEDULE\x20['+_0x4503d5+_0xfda75e(0x1b4)+_0x336876[_0xfda75e(0x19c)]+_0xfda75e(0x234)+_0x5a64f9+_0xfda75e(0x1fe)+_0x5d2bfe+_0xfda75e(0x216)+_0x216828+_0xfda75e(0x1a7)),await _0x343d44[_0xfda75e(0x1c5)](_0x7482fc,_0x5d2bfe),await logAutomationAction(_0x343d44,_0xfda75e(0x1ec)+_0x336876[_0xfda75e(0x19c)]+'\x20->\x20'+_0x5d2bfe+'¬∞C\x20(via\x20'+_0x4503d5+')'),lastActions[_0xfda75e(0x1a4)+_0x336876['location']]=_0x78ab57;const _0x58f51d=_0x753851[_0xfda75e(0x230)](_0x422e40=>_0x422e40[_0xfda75e(0x1c1)]===_0x336876[_0xfda75e(0x19c)]);if(_0x58f51d!==-0x1)_0x753851[_0xfda75e(0x231)](_0x58f51d,0x1);_0x753851[_0xfda75e(0x1ce)]({'room':_0x336876['location'],'target':_0x5d2bfe,'until':_0x3a4a13[_0xfda75e(0x255)]()}),_0x1ae9be=!![];}}}}}}}_0x1ae9be&&await _0x343d44[_0xfda75e(0x201)](_0xfda75e(0x1f8),{'val':JSON['stringify'](_0x753851),'ack':!![]});}catch(_0x716fcb){_0x343d44[_0xfda75e(0x218)][_0xfda75e(0x1e5)](_0xfda75e(0x20a)+_0x716fcb[_0xfda75e(0x1fb)]);}}async function manageMpcIntervention(_0x2a4872,_0x47f98f,_0x2d4baf){const _0x4dc6b6=a1_0x1902b4;try{const _0x3e1a08=_0x4dc6b6(0x20c),_0x98e1db=await _0x2a4872['getStateAsync'](_0x3e1a08);let _0x49acd7=[];if(_0x98e1db&&_0x98e1db['val'])try{_0x49acd7=JSON[_0x4dc6b6(0x1d7)](_0x98e1db[_0x4dc6b6(0x24e)]);}catch(_0x377011){}const _0x366ec3=_0x49acd7[_0x4dc6b6(0x20b)](_0x47f98f);if(_0x2d4baf===_0x4dc6b6(0x1ca))_0x366ec3===-0x1&&(_0x49acd7[_0x4dc6b6(0x1ce)](_0x47f98f),await _0x2a4872['setStateAsync'](_0x3e1a08,{'val':JSON[_0x4dc6b6(0x22e)](_0x49acd7),'ack':!![]}));else _0x2d4baf===_0x4dc6b6(0x1a1)&&(_0x366ec3!==-0x1&&(_0x49acd7[_0x4dc6b6(0x231)](_0x366ec3,0x1),await _0x2a4872[_0x4dc6b6(0x201)](_0x3e1a08,{'val':JSON[_0x4dc6b6(0x22e)](_0x49acd7),'ack':!![]})));}catch(_0x4db947){}}async function cleanupGhostInterventions(_0x4ed18a){const _0x2c4c5b=a1_0x1902b4;try{const _0x3f89df=_0x2c4c5b(0x20c),_0x337796=await _0x4ed18a['getStateAsync'](_0x3f89df);if(!_0x337796||!_0x337796[_0x2c4c5b(0x24e)])return;const _0x1f5f2e=JSON[_0x2c4c5b(0x1d7)](_0x337796[_0x2c4c5b(0x24e)]);if(!Array[_0x2c4c5b(0x1e3)](_0x1f5f2e)||_0x1f5f2e[_0x2c4c5b(0x244)]===0x0)return;let _0x24a8ad={'default':0x15};try{const _0x44c408=await _0x4ed18a[_0x2c4c5b(0x24c)]('analysis.energy.warmupTargets');if(_0x44c408&&_0x44c408[_0x2c4c5b(0x24e)])_0x24a8ad=JSON['parse'](_0x44c408[_0x2c4c5b(0x24e)]);}catch(_0x5c3dcd){}let _0x5893fe=[];try{const _0x4b12ee=await _0x4ed18a['getStateAsync'](_0x2c4c5b(0x256));if(_0x4b12ee&&_0x4b12ee[_0x2c4c5b(0x24e)])_0x5893fe=JSON[_0x2c4c5b(0x1d7)](_0x4b12ee[_0x2c4c5b(0x24e)]);}catch(_0x10f861){}let _0x159bc0={},_0x473152=![];try{const _0x4ce966=await _0x4ed18a[_0x2c4c5b(0x24c)]('analysis.energy.rlPenalties');if(_0x4ce966&&_0x4ce966['val'])_0x159bc0=JSON['parse'](_0x4ce966[_0x2c4c5b(0x24e)]);}catch(_0x27fa84){}if(_0x159bc0[_0x2c4c5b(0x220)]){const _0x5adb6a=Date['now']();for(const [_0x10323b,_0x2e5e70]of Object[_0x2c4c5b(0x237)](_0x159bc0[_0x2c4c5b(0x220)])){_0x5adb6a-_0x2e5e70>PENALTY_TTL&&(delete _0x159bc0[_0x10323b],delete _0x159bc0[_0x2c4c5b(0x220)][_0x10323b],_0x473152=!![],_0x4ed18a[_0x2c4c5b(0x218)][_0x2c4c5b(0x1d2)](_0x2c4c5b(0x23c)+_0x10323b+'\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.'));}}const _0x35fb6a=_0x4ed18a[_0x2c4c5b(0x25e)][_0x2c4c5b(0x219)]||[];let _0x2c8da3=![];for(let _0x35ff4b=_0x1f5f2e[_0x2c4c5b(0x244)]-0x1;_0x35ff4b>=0x0;_0x35ff4b--){const _0x1dcd12=_0x1f5f2e[_0x35ff4b],_0x31dd1b=_0x35fb6a[_0x2c4c5b(0x204)](_0x1b2413=>normalize(_0x1b2413[_0x2c4c5b(0x19c)])===normalize(_0x1dcd12)&&(_0x1b2413['type']===_0x2c4c5b(0x208)||_0x1b2413['type']===_0x2c4c5b(0x1ac)));if(!_0x31dd1b){_0x4ed18a['log'][_0x2c4c5b(0x1e5)](_0x2c4c5b(0x229)+_0x1dcd12+_0x2c4c5b(0x206)),_0x1f5f2e['splice'](_0x35ff4b,0x1),_0x2c8da3=!![];continue;}if(_0x31dd1b){const _0x509f71=await findRelatedId(_0x4ed18a,_0x31dd1b['id'],'setpoint'),_0x1b1c9d=await _0x4ed18a['getForeignStateAsync'](_0x31dd1b['id']);if(_0x509f71){const _0x33e0e6=await _0x4ed18a[_0x2c4c5b(0x1e6)](_0x509f71);if(_0x33e0e6&&typeof _0x33e0e6[_0x2c4c5b(0x24e)]==='number'){let _0x4f39ea=![],_0x20af9d='';Math['abs'](_0x33e0e6[_0x2c4c5b(0x24e)]-ECO_TEMP)>0.5&&(_0x4f39ea=!![],_0x20af9d='manual');if(!_0x4f39ea&&_0x1b1c9d&&typeof _0x1b1c9d[_0x2c4c5b(0x24e)]===_0x2c4c5b(0x1ea)){const _0x4fb9d9=_0x24a8ad[_0x1dcd12]||_0x24a8ad['default']||0x15;_0x1b1c9d['val']<_0x4fb9d9+0.2&&(_0x4f39ea=!![],_0x20af9d='too_cold');}if(_0x4f39ea){if(_0x20af9d===_0x2c4c5b(0x250)){_0x4ed18a[_0x2c4c5b(0x218)]['info']('üßπ\x20[MPC\x20CLEANUP]\x20'+_0x1dcd12+'\x20ist\x20auf\x20'+_0x33e0e6['val']+_0x2c4c5b(0x241)+ECO_TEMP+'¬∞C).\x20Entferne\x20Status.');const _0x39fa59=lastActions[_0x2c4c5b(0x1a4)+_0x1dcd12],_0x3f1409=_0x39fa59&&Date[_0x2c4c5b(0x1ed)]()-_0x39fa59<0x2*0x3c*0x3e8;if(!_0x3f1409&&_0x33e0e6[_0x2c4c5b(0x24e)]>ECO_TEMP+0.5){_0x4ed18a[_0x2c4c5b(0x21e)]&&(_0x4ed18a[_0x2c4c5b(0x218)]['info'](_0x2c4c5b(0x20d)+_0x1dcd12+'\x20wurde\x20manuell\x20erh√∂ht.'),_0x4ed18a[_0x2c4c5b(0x21e)](_0x2c4c5b(0x19d),{'room':_0x1dcd12}));const _0x16f488=_0x1dcd12+'_'+new Date()[_0x2c4c5b(0x249)]();if(!_0x159bc0[_0x16f488]){_0x159bc0[_0x16f488]=0x1;if(!_0x159bc0[_0x2c4c5b(0x220)])_0x159bc0[_0x2c4c5b(0x220)]={};_0x159bc0['_meta'][_0x16f488]=Date[_0x2c4c5b(0x1ed)](),_0x473152=!![];}}else _0x3f1409&&_0x4ed18a[_0x2c4c5b(0x218)]['info']('üìÖ\x20[MPC\x20INFO]\x20'+_0x1dcd12+_0x2c4c5b(0x23b));}else{if(_0x20af9d===_0x2c4c5b(0x1bc)){let _0x25e9af=![];if(_0x5893fe['find'](_0x9c14d0=>_0x9c14d0[_0x2c4c5b(0x1c1)]===_0x1dcd12))_0x25e9af=!![];const _0x375747=_0x35fb6a[_0x2c4c5b(0x1bd)](_0x180ee1=>normalize(_0x180ee1[_0x2c4c5b(0x19c)])===normalize(_0x1dcd12)&&(_0x180ee1[_0x2c4c5b(0x207)]===_0x2c4c5b(0x23d)||_0x180ee1[_0x2c4c5b(0x207)]===_0x2c4c5b(0x246)||_0x180ee1[_0x2c4c5b(0x207)]===_0x2c4c5b(0x240)));for(const _0x19af77 of _0x375747){try{const _0x1cbaf1=await _0x4ed18a[_0x2c4c5b(0x1e6)](_0x19af77['id']);if(_0x1cbaf1&&(_0x1cbaf1[_0x2c4c5b(0x24e)]===!![]||_0x1cbaf1[_0x2c4c5b(0x24e)]===0x1||String(_0x1cbaf1[_0x2c4c5b(0x24e)])[_0x2c4c5b(0x21b)]()===_0x2c4c5b(0x1d1)))_0x25e9af=!![];}catch(_0x444ce2){}}if(_0x25e9af)_0x4ed18a[_0x2c4c5b(0x218)][_0x2c4c5b(0x1d2)]('üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20'+_0x1dcd12+_0x2c4c5b(0x1b7));else{const _0x491f9d=_0x24a8ad[_0x1dcd12]||_0x24a8ad[_0x2c4c5b(0x22b)]||0x15;_0x4ed18a[_0x2c4c5b(0x218)][_0x2c4c5b(0x1d2)](_0x2c4c5b(0x1de)+_0x1dcd12+_0x2c4c5b(0x1dc)+_0x1b1c9d['val']+_0x2c4c5b(0x1b6)+(_0x491f9d+0.2)+_0x2c4c5b(0x1cd)),await _0x4ed18a[_0x2c4c5b(0x1c5)](_0x509f71,_0x491f9d),await logAutomationAction(_0x4ed18a,_0x2c4c5b(0x1f6)+_0x1dcd12+_0x2c4c5b(0x1b1)+_0x491f9d+'¬∞C'),lastActions[_0x2c4c5b(0x1d6)+_0x1dcd12]=Date[_0x2c4c5b(0x1ed)]();}}}_0x1f5f2e[_0x2c4c5b(0x231)](_0x35ff4b,0x1),_0x2c8da3=!![];}}}}}_0x2c8da3&&await _0x4ed18a[_0x2c4c5b(0x201)](_0x3f89df,{'val':JSON[_0x2c4c5b(0x22e)](_0x1f5f2e),'ack':!![]}),_0x473152&&await _0x4ed18a[_0x2c4c5b(0x201)](_0x2c4c5b(0x211),{'val':JSON['stringify'](_0x159bc0),'ack':!![]});}catch(_0x5e7998){}}async function applyEnergySavings(_0x5eb3d8,_0xbc5442){const _0x398bb9=a1_0x1902b4;await cleanupGhostInterventions(_0x5eb3d8);if(!_0xbc5442||_0xbc5442[_0x398bb9(0x244)]===0x0)return;const _0x1aa3c4=_0x5eb3d8[_0x398bb9(0x25e)][_0x398bb9(0x219)]||[],_0x7ef72c=Date['now']();for(const _0x1f2ab2 of _0xbc5442){const _0x253f22=_0x1f2ab2[_0x398bb9(0x1c1)],_0x1e2e20=_0x1f2ab2[_0x398bb9(0x25d)],_0x55a74=_0x1f2ab2[_0x398bb9(0x222)]||0x15;if(lastActions[_0x398bb9(0x1d6)+_0x253f22]&&_0x7ef72c-lastActions['rescue_'+_0x253f22]<RESCUE_LOCK_MS)continue;const _0x39f71a=_0x1aa3c4[_0x398bb9(0x204)](_0x44927a=>normalize(_0x44927a[_0x398bb9(0x19c)])===normalize(_0x253f22)&&(_0x44927a['type']===_0x398bb9(0x208)||_0x44927a[_0x398bb9(0x207)]==='thermostat'));if(!_0x39f71a)continue;const _0x1e07ab=await findRelatedId(_0x5eb3d8,_0x39f71a['id'],'setpoint');if(_0x1e07ab){if(lastActions[_0x398bb9(0x203)+_0x253f22]&&_0x7ef72c-lastActions[_0x398bb9(0x203)+_0x253f22]<0x1e*0x3c*0x3e8)continue;const _0x1d14a1=await _0x5eb3d8[_0x398bb9(0x1e6)](_0x1e07ab);if(_0x1d14a1&&typeof _0x1d14a1['val']===_0x398bb9(0x1ea)){const _0x2f53f9=_0x1d14a1['val'];_0x2f53f9!==ECO_TEMP&&await manageMpcIntervention(_0x5eb3d8,_0x253f22,_0x398bb9(0x1a1));if(_0x1e2e20>0x1e)_0x2f53f9>ECO_TEMP+0.5&&(_0x5eb3d8[_0x398bb9(0x218)]['info'](_0x398bb9(0x210)+_0x253f22+'\x20auf\x20'+ECO_TEMP+_0x398bb9(0x1fa)+_0x1e2e20+_0x398bb9(0x248)),await _0x5eb3d8[_0x398bb9(0x1c5)](_0x1e07ab,ECO_TEMP),await manageMpcIntervention(_0x5eb3d8,_0x253f22,_0x398bb9(0x1ca)),lastActions[_0x398bb9(0x203)+_0x253f22]=_0x7ef72c,await logAutomationAction(_0x5eb3d8,'[MPC]\x20'+_0x253f22+_0x398bb9(0x1d3)+ECO_TEMP+'¬∞C'));else _0x1e2e20<=0xf&&(_0x2f53f9<_0x55a74&&(_0x5eb3d8[_0x398bb9(0x218)][_0x398bb9(0x1d2)](_0x398bb9(0x22c)+_0x253f22+_0x398bb9(0x252)+_0x55a74+_0x398bb9(0x24b)),await _0x5eb3d8[_0x398bb9(0x1c5)](_0x1e07ab,_0x55a74),await manageMpcIntervention(_0x5eb3d8,_0x253f22,_0x398bb9(0x1a1)),lastActions[_0x398bb9(0x203)+_0x253f22]=_0x7ef72c,await logAutomationAction(_0x5eb3d8,'[MPC]\x20'+_0x253f22+_0x398bb9(0x1d4)+_0x55a74+'¬∞C')));}}else _0x5eb3d8[_0x398bb9(0x218)][_0x398bb9(0x1e5)](_0x398bb9(0x1e2)+_0x253f22+_0x398bb9(0x1a0));}}module[a1_0x1902b4(0x242)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};