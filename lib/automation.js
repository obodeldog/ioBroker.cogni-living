const a1_0x5000c2=a1_0x4376;(function(_0x54d255,_0x538732){const _0x2550e9=a1_0x4376,_0x1fae7c=_0x54d255();while(!![]){try{const _0x7a32aa=parseInt(_0x2550e9(0xf8))/0x1*(parseInt(_0x2550e9(0x161))/0x2)+-parseInt(_0x2550e9(0x120))/0x3+parseInt(_0x2550e9(0x182))/0x4*(parseInt(_0x2550e9(0x141))/0x5)+-parseInt(_0x2550e9(0x143))/0x6+-parseInt(_0x2550e9(0x145))/0x7+parseInt(_0x2550e9(0x10a))/0x8*(parseInt(_0x2550e9(0x14e))/0x9)+parseInt(_0x2550e9(0x148))/0xa;if(_0x7a32aa===_0x538732)break;else _0x1fae7c['push'](_0x1fae7c['shift']());}catch(_0x20b4f8){_0x1fae7c['push'](_0x1fae7c['shift']());}}}(a1_0x18c8,0x952f3));function a1_0x18c8(){const _0x473385=['type',':\x20Aufheizen\x20auf\x20','r√ºckkehr','\x27\x20erkannt\x20(','¬∞C!\x20(Puffer\x20leer).\x20->\x20ID:\x20','.1.LEVEL','level.temperature','push','date','summary','messwert','current_heating_setpoint','.data.table','filter','valve','replace','warn','2054928RGMeBc','parse','soll','urlaub\x20ende','analysis.energy.warmupTimes','write','state','info','eventStart','stellwert','light','includes','val','localeCompare','config','.1.SET_POINT_TEMPERATURE','string','SET','getStateAsync','setStateAsync','log','toLowerCase','\x20min).','thermostat','constructor','position','openknx','hm-rpc','üìÖ\x20SMART\x20SCHEDULE:\x20Raum-Trigger\x20\x27','.1.ACTUAL_TEMPERATURE','common','stringify','system.mode','24495ORhqxG','devices','3981900zYDEGJ','switch','7022673vFFlQP','unit','\x20->\x20Schalte\x20','16404750lYpFIA','./ai_agent','sensor','getForeignObjectsAsync','Manuelles\x20Mapping','mpc_','9288mYUoaB','Calendar\x20Check\x20Error:\x20','[MPC]\x20','approved','location','analysis.automation.lastAction','local_temperature','add','¬∞C!\x20(Aktuell:\x20','target','split','map','consultButler','getForeignStateAsync','_date','find','apply','.4.SET_TEMPERATURE','ankunft','421786GPbZMe','üçÉ\x20[MPC\x20ACTION]\x20Senke\x20','set','Unbekannt','sort','join','temperature','\x20gefunden!\x20Bitte\x20\x27System\x27\x20Tab\x20pr√ºfen.','active','forEach','minutes_safe','calendarSelection','\x20wieder\x20auf\x20','off','.4.VALVE_STATE','slice','getTime','level.valve','setpoint','SET_POINT_TEMPERATURE','dimmer','name','toString','event','Soll','Pr√§diktion:\x20','thermostatMapping','target_temperature','ACTUAL','length','üî•\x20[MPC\x20ACTION]\x20Heize\x20','ist','useCalendar','20HjUAro','reason','entries','[CAL]\x20','valveMapping','\x20auf\x20','analysis.energy.schedulePreview','exports','number','calendarInstance','valve_position',').\x20Heize\x20auf\x2021¬∞C\x20(Vorlauf:\x20','wert','room','2PfVNSS','toUpperCase','Nicht\x20gefunden','temp','_calName','from','now','analysis.automation.mode','search','PERFECT','Unknown','actual','trim','(((.+)+)+)+$','values','level','score','triggerTime','6792KiUjBu','thermostat.setpoint','.1.TEMPERATURE','normal','setForeignStateAsync'];a1_0x18c8=function(){return _0x473385;};return a1_0x18c8();}const a1_0x29d830=(function(){let _0x35e9f3=!![];return function(_0x55dac4,_0xe09f4a){const _0x485c40=_0x35e9f3?function(){const _0x4ea100=a1_0x4376;if(_0xe09f4a){const _0x253183=_0xe09f4a[_0x4ea100(0x15e)](_0x55dac4,arguments);return _0xe09f4a=null,_0x253183;}}:function(){};return _0x35e9f3=![],_0x485c40;};}()),a1_0x626c41=a1_0x29d830(this,function(){const _0xa69ea9=a1_0x4376;return a1_0x626c41[_0xa69ea9(0x177)]()[_0xa69ea9(0x100)](_0xa69ea9(0x105))[_0xa69ea9(0x177)]()[_0xa69ea9(0x138)](a1_0x626c41)[_0xa69ea9(0x100)](_0xa69ea9(0x105));});a1_0x626c41();'use strict';const aiAgent=require(a1_0x5000c2(0x149)),COOLDOWN_MS=0x3c*0x3e8,ECO_TEMP=0x11,lastActions={};function normalize(_0x53fa8b){const _0x564b18=a1_0x5000c2;if(!_0x53fa8b)return'';return _0x53fa8b[_0x564b18(0x135)]()[_0x564b18(0x11e)](/\s+/g,'')[_0x564b18(0x104)]();}async function handlePrediction(_0x1cbece,_0x17fd84,_0x40c8cc){const _0x2204dd=a1_0x5000c2;if(!_0x17fd84||_0x17fd84===_0x2204dd(0x102))return;let _0x4e67aa=_0x2204dd(0x16e),_0x52309b=0.6;try{const _0x5e80e1=await _0x1cbece[_0x2204dd(0x132)](_0x2204dd(0xff));if(_0x5e80e1&&_0x5e80e1[_0x2204dd(0x12c)])_0x4e67aa=_0x5e80e1[_0x2204dd(0x12c)];const _0x2150ec=await _0x1cbece[_0x2204dd(0x132)]('analysis.automation.confidenceThreshold');if(_0x2150ec&&_0x2150ec[_0x2204dd(0x12c)])_0x52309b=_0x2150ec[_0x2204dd(0x12c)];}catch(_0x5ab58b){}if(_0x4e67aa===_0x2204dd(0x16e)||_0x40c8cc<_0x52309b)return;const _0x47cc5b=Date['now']();if(lastActions[_0x17fd84]&&_0x47cc5b-lastActions[_0x17fd84]<COOLDOWN_MS)return;const _0x17ab4c=_0x1cbece['config'][_0x2204dd(0x142)]||[],_0x3cdcec=normalize(_0x17fd84),_0x403b18=_0x17ab4c[_0x2204dd(0x15d)](_0x3c7719=>normalize(_0x3c7719[_0x2204dd(0x152)])===_0x3cdcec&&(_0x3c7719[_0x2204dd(0x10f)]===_0x2204dd(0x12a)||_0x3c7719[_0x2204dd(0x10f)]===_0x2204dd(0x175)||_0x3c7719[_0x2204dd(0x10f)]===_0x2204dd(0x144)));if(!_0x403b18)return;const _0x5ea2e8=await aiAgent[_0x2204dd(0x15a)](_0x1cbece,_0x17fd84,_0x403b18[_0x2204dd(0x176)],_0x40c8cc);if(!_0x5ea2e8[_0x2204dd(0x151)])return;const _0x165a7a=_0x2204dd(0x17a)+_0x17fd84+_0x2204dd(0x147)+_0x403b18['name']+'\x20('+_0x5ea2e8[_0x2204dd(0x183)]+')';await _0x1cbece[_0x2204dd(0x133)](_0x2204dd(0x153),{'val':'['+_0x4e67aa[_0x2204dd(0xf9)]()+']\x20'+_0x165a7a,'ack':!![]});if(_0x4e67aa===_0x2204dd(0x169)){const _0x3886b7=await _0x1cbece[_0x2204dd(0x15b)](_0x403b18['id']);(!_0x3886b7||!_0x3886b7[_0x2204dd(0x12c)]&&_0x3886b7[_0x2204dd(0x12c)]!==!![])&&await _0x1cbece['setForeignStateAsync'](_0x403b18['id'],!![]),lastActions[_0x17fd84]=_0x47cc5b;}}function a1_0x4376(_0x5ba866,_0x38fd26){const _0x2e7d68=a1_0x18c8();return a1_0x4376=function(_0x626c41,_0x29d830){_0x626c41=_0x626c41-0xf2;let _0x18c8cf=_0x2e7d68[_0x626c41];return _0x18c8cf;},a1_0x4376(_0x5ba866,_0x38fd26);}async function findRelatedId(_0x221f97,_0x288ee3,_0x50ed40='setpoint'){const _0x1124cf=a1_0x5000c2;if(_0x50ed40==='setpoint'&&_0x221f97['config']['thermostatMapping']){let _0x4b93a5=_0x221f97[_0x1124cf(0x12e)][_0x1124cf(0x17b)];if(typeof _0x4b93a5===_0x1124cf(0x130))try{_0x4b93a5=JSON['parse'](_0x4b93a5);}catch(_0x2d17c9){}if(_0x4b93a5&&_0x4b93a5[_0x288ee3])return _0x4b93a5[_0x288ee3];}if(_0x50ed40===_0x1124cf(0x11d)&&_0x221f97[_0x1124cf(0x12e)][_0x1124cf(0x186)]){let _0x4678db=_0x221f97[_0x1124cf(0x12e)]['valveMapping'];if(typeof _0x4678db==='string')try{_0x4678db=JSON[_0x1124cf(0x121)](_0x4678db);}catch(_0x4fd6a8){}if(_0x4678db&&_0x4678db[_0x288ee3])return _0x4678db[_0x288ee3];}let _0x2f0a70=[];if(_0x50ed40==='setpoint')_0x2f0a70=[{'s':_0x1124cf(0x13d),'t':_0x1124cf(0x12f)},{'s':_0x1124cf(0x10c),'t':_0x1124cf(0x12f)},{'s':_0x1124cf(0x10c),'t':_0x1124cf(0x15f)},{'s':'ACTUAL_TEMPERATURE','t':_0x1124cf(0x174)},{'s':_0x1124cf(0x154),'t':'occupied_heating_setpoint'},{'s':'local_temperature','t':_0x1124cf(0x11a)},{'s':'temperature','t':_0x1124cf(0x17c)},{'s':_0x1124cf(0x17d),'t':_0x1124cf(0x131)},{'s':'Ist','t':_0x1124cf(0x179)},{'s':_0x1124cf(0x167),'t':_0x1124cf(0x173)}];else _0x50ed40===_0x1124cf(0x11d)&&(_0x2f0a70=[{'s':_0x1124cf(0x13d),'t':_0x1124cf(0x114)},{'s':_0x1124cf(0x10c),'t':_0x1124cf(0x114)},{'s':'.1.TEMPERATURE','t':_0x1124cf(0x16f)},{'s':'local_temperature','t':'pi_heating_demand'},{'s':'temperature','t':_0x1124cf(0xf4)},{'s':_0x1124cf(0x167),'t':'level'}]);for(const _0x46a760 of _0x2f0a70){if(_0x288ee3[_0x1124cf(0x12b)](_0x46a760['s'])){const _0x4f7550=_0x288ee3[_0x1124cf(0x11e)](_0x46a760['s'],_0x46a760['t']),_0xd0f4c2=await _0x221f97['getForeignObjectAsync'](_0x4f7550);if(_0xd0f4c2)return _0x4f7550;}}try{const _0x539070=_0x288ee3[_0x1124cf(0x158)]('.');if(_0x539070['length']>0x2){const _0x2741d7=_0x539070[_0x1124cf(0x170)](0x0,-0x1)[_0x1124cf(0x166)]('.'),_0xdddf53=await _0x221f97[_0x1124cf(0x14b)](_0x2741d7+'.*'),_0x3313d0=[],_0xc4f23b=_0x288ee3['split'](/[._]+/)[_0x1124cf(0x11c)](_0x42206b=>![_0x1124cf(0x13a),'0',_0x1124cf(0x13b),_0x1124cf(0x180),_0x1124cf(0xf6),_0x1124cf(0x167),_0x1124cf(0x103),_0x1124cf(0x14a),_0x1124cf(0x119),_0x1124cf(0x126)][_0x1124cf(0x12b)](_0x42206b['toLowerCase']()));for(const [_0x2f6104,_0x2f6e46]of Object[_0x1124cf(0x184)](_0xdddf53)){if(_0x2f6104===_0x288ee3)continue;if(_0x2f6e46&&_0x2f6e46['common']){const _0x3dc1fb=_0x2f6104[_0x1124cf(0x135)](),_0x3b321c=(_0x2f6e46[_0x1124cf(0x13e)]['role']||'')[_0x1124cf(0x135)](),_0xdf79d1=(_0x2f6e46[_0x1124cf(0x13e)][_0x1124cf(0x146)]||'')[_0x1124cf(0x135)]();let _0xf2238d=![];if(_0x50ed40===_0x1124cf(0x173)&&_0x2f6e46['common'][_0x1124cf(0x125)]===!![])_0xf2238d=_0x3dc1fb[_0x1124cf(0x12b)](_0x1124cf(0x163))||_0x3dc1fb[_0x1124cf(0x12b)](_0x1124cf(0x122))||_0x3dc1fb[_0x1124cf(0x12b)](_0x1124cf(0x157))||_0x3b321c[_0x1124cf(0x12b)](_0x1124cf(0x115))||_0x3b321c['includes'](_0x1124cf(0x10b));else _0x50ed40===_0x1124cf(0x11d)&&(_0xf2238d=_0x3dc1fb[_0x1124cf(0x12b)](_0x1124cf(0x107))||_0x3dc1fb[_0x1124cf(0x12b)](_0x1124cf(0x11d))||_0x3dc1fb[_0x1124cf(0x12b)](_0x1124cf(0x129))||_0x3dc1fb[_0x1124cf(0x12b)](_0x1124cf(0x139))||_0x3b321c['includes'](_0x1124cf(0x172))||_0x3b321c['includes']('value.valve')||_0xdf79d1[_0x1124cf(0x12b)]('%'));if(_0xf2238d){const _0x20450e=_0x2f6104[_0x1124cf(0x158)](/[._]+/)[_0x1124cf(0x159)](_0x532201=>_0x532201['toLowerCase']());let _0x93099e=0x0;_0xc4f23b[_0x1124cf(0x16a)](_0x30ab0c=>{const _0x28b974=_0x1124cf;if(_0x20450e[_0x28b974(0x12b)](_0x30ab0c[_0x28b974(0x135)]()))_0x93099e++;}),_0x3313d0['push']({'id':_0x2f6104,'score':_0x93099e});}}}if(_0x3313d0[_0x1124cf(0x17e)]>0x0){_0x3313d0[_0x1124cf(0x165)]((_0x32c93c,_0x5cd122)=>_0x5cd122[_0x1124cf(0x108)]-_0x32c93c['score']);if(_0x3313d0[0x0][_0x1124cf(0x108)]>0x0)return _0x3313d0[0x0]['id'];}}}catch(_0x1efa93){}return null;}async function scanThermostats(_0x2df1c2){const _0x241f1f=a1_0x5000c2,_0x521424=_0x2df1c2['config'][_0x241f1f(0x142)]||[],_0x54b51a=[],_0x209cee=_0x521424['filter'](_0x2afecb=>_0x2afecb['id']&&_0x2afecb['id'][_0x241f1f(0x12b)](_0x241f1f(0x167))||_0x2afecb[_0x241f1f(0x10f)]&&[_0x241f1f(0x167),_0x241f1f(0x137),_0x241f1f(0x14a)][_0x241f1f(0x12b)](_0x2afecb['type'])||_0x2afecb[_0x241f1f(0x176)]&&_0x2afecb['name'][_0x241f1f(0x135)]()[_0x241f1f(0x12b)](_0x241f1f(0xfb)));for(const _0xe69d24 of _0x209cee){const _0x698bc9=await findRelatedId(_0x2df1c2,_0xe69d24['id'],'setpoint'),_0x466254=await findRelatedId(_0x2df1c2,_0xe69d24['id'],_0x241f1f(0x11d));let _0x261c75=_0x241f1f(0xfa),_0x58a38c=![],_0x31a745=_0x2df1c2[_0x241f1f(0x12e)][_0x241f1f(0x17b)]||{};if(typeof _0x31a745===_0x241f1f(0x130))try{_0x31a745=JSON[_0x241f1f(0x121)](_0x31a745);}catch(_0x18793c){}let _0x5b7c3c=_0x2df1c2['config'][_0x241f1f(0x186)]||{};if(typeof _0x5b7c3c==='string')try{_0x5b7c3c=JSON[_0x241f1f(0x121)](_0x5b7c3c);}catch(_0x5293f9){}if(_0x31a745[_0xe69d24['id']]&&_0x31a745[_0xe69d24['id']]===_0x698bc9||_0x5b7c3c[_0xe69d24['id']]&&_0x5b7c3c[_0xe69d24['id']]===_0x466254)_0x261c75=_0x241f1f(0x14c),_0x58a38c=!![];else(_0x698bc9||_0x466254)&&(_0x261c75='Auto-Erkennung');_0x54b51a[_0x241f1f(0x116)]({'room':_0xe69d24[_0x241f1f(0x152)]||_0x241f1f(0x164),'sensorId':_0xe69d24['id'],'setpointId':_0x698bc9||'-','valveId':_0x466254||'-','source':_0x261c75,'isManual':_0x58a38c,'status':_0x698bc9&&_0x466254?_0x241f1f(0x101):_0x698bc9?'OK':'Fehlt'});}return _0x54b51a[_0x241f1f(0x165)]((_0x5a603b,_0x5a3a0c)=>_0x5a603b[_0x241f1f(0xf7)][_0x241f1f(0x12d)](_0x5a3a0c[_0x241f1f(0xf7)]));}async function updateSchedulePreview(_0x2acd5c){const _0x392846=a1_0x5000c2;if(!_0x2acd5c['config']['useCalendar']||!_0x2acd5c['config'][_0x392846(0xf3)])return;let _0x54be15={};try{const _0x41b0b4=await _0x2acd5c[_0x392846(0x132)](_0x392846(0x124));if(_0x41b0b4&&_0x41b0b4['val'])_0x54be15=JSON[_0x392846(0x121)](_0x41b0b4[_0x392846(0x12c)]);}catch(_0xf9356c){}const _0x7393d=[],_0x1ab199=Date['now'](),_0x447054=0x30*0x3c*0x3c*0x3e8;try{const _0x47fb27=await _0x2acd5c[_0x392846(0x15b)](_0x2acd5c[_0x392846(0x12e)][_0x392846(0xf3)]+_0x392846(0x11b));if(!_0x47fb27||!_0x47fb27[_0x392846(0x12c)])return;const _0x471aa1=JSON[_0x392846(0x121)](_0x47fb27[_0x392846(0x12c)]),_0x25fd12=_0x2acd5c[_0x392846(0x12e)][_0x392846(0x16c)]||[],_0x24cfae=_0x2acd5c[_0x392846(0x12e)][_0x392846(0x142)]||[],_0x4aab54=new Set();_0x24cfae['forEach'](_0x5ed616=>{const _0x1bb058=_0x392846;if(_0x5ed616['location'])_0x4aab54[_0x1bb058(0x155)](_0x5ed616[_0x1bb058(0x152)]);});for(const _0xf2e2e6 of _0x471aa1){if(_0xf2e2e6[_0x392846(0xfc)]&&_0x25fd12['length']>0x0&&!_0x25fd12['includes'](_0xf2e2e6[_0x392846(0xfc)]))continue;const _0x6c27ee=_0xf2e2e6[_0x392846(0x15c)]||_0xf2e2e6[_0x392846(0x128)]||_0xf2e2e6[_0x392846(0x117)];if(!_0x6c27ee)continue;const _0xc26080=new Date(_0x6c27ee),_0x35a195=_0xc26080[_0x392846(0x171)]();if(isNaN(_0x35a195))continue;if(_0x35a195<_0x1ab199)continue;if(_0x35a195>_0x1ab199+_0x447054)continue;const _0xff81c0=(_0xf2e2e6[_0x392846(0x178)]||_0xf2e2e6[_0x392846(0x118)]||'')[_0x392846(0x135)]();let _0x3a1cf4=![],_0xdc8571=[],_0x43bd0c=_0xf2e2e6[_0x392846(0x178)]||_0xf2e2e6[_0x392846(0x118)]||_0x392846(0x164);if(_0xff81c0['includes'](_0x392846(0x123))||_0xff81c0[_0x392846(0x12b)](_0x392846(0x111))||_0xff81c0[_0x392846(0x12b)](_0x392846(0x160)))_0x3a1cf4=!![],_0xdc8571=Array[_0x392846(0xfd)](_0x4aab54);else for(const _0x2bf10f of _0x4aab54){_0xff81c0['includes'](_0x2bf10f[_0x392846(0x135)]())&&_0xdc8571['push'](_0x2bf10f);}_0xdc8571[_0x392846(0x17e)]>0x0&&_0xdc8571[_0x392846(0x16a)](_0x8f0ad6=>{const _0x731073=_0x392846;let _0x331cec=0x3c;if(_0x3a1cf4){let _0x39f3e3=0x0;Object['values'](_0x54be15)[_0x731073(0x16a)](_0x481c2a=>{if(_0x481c2a>_0x39f3e3)_0x39f3e3=_0x481c2a;}),_0x331cec=_0x39f3e3>0x0?_0x39f3e3:0x78;}else _0x331cec=_0x54be15[_0x8f0ad6]||0x3c;const _0x27f080=new Date(_0x35a195-_0x331cec*0xea60);_0x7393d[_0x731073(0x116)]({'eventTime':_0x35a195,'triggerTime':_0x27f080[_0x731073(0x171)](),'room':_0x8f0ad6,'minutes':_0x331cec,'reason':_0x43bd0c,'isGlobal':_0x3a1cf4});});}}catch(_0xf21573){}_0x7393d[_0x392846(0x165)]((_0xc2a826,_0x3e1c28)=>_0xc2a826['triggerTime']-_0x3e1c28[_0x392846(0x109)]);const _0x92d1b5=_0x7393d[_0x392846(0x170)](0x0,0x5);await _0x2acd5c[_0x392846(0x133)](_0x392846(0x188),{'val':JSON[_0x392846(0x13f)](_0x92d1b5),'ack':!![]});}async function checkCalendarTriggers(_0xf7742a){const _0x1fb993=a1_0x5000c2;if(!_0xf7742a[_0x1fb993(0x12e)][_0x1fb993(0x181)]||!_0xf7742a['config'][_0x1fb993(0xf3)])return;await updateSchedulePreview(_0xf7742a);let _0x58dd56={};try{const _0x4dd11f=await _0xf7742a['getStateAsync'](_0x1fb993(0x124));if(_0x4dd11f&&_0x4dd11f[_0x1fb993(0x12c)])_0x58dd56=JSON[_0x1fb993(0x121)](_0x4dd11f[_0x1fb993(0x12c)]);}catch(_0x207bde){}try{const _0x38f9b8=await _0xf7742a[_0x1fb993(0x15b)](_0xf7742a['config'][_0x1fb993(0xf3)]+_0x1fb993(0x11b));if(!_0x38f9b8||!_0x38f9b8[_0x1fb993(0x12c)])return;const _0x5d2235=JSON[_0x1fb993(0x121)](_0x38f9b8[_0x1fb993(0x12c)]),_0x19cc9b=new Date(),_0x346bf1=_0xf7742a[_0x1fb993(0x12e)][_0x1fb993(0x142)]||[],_0x288da4=_0xf7742a[_0x1fb993(0x12e)]['calendarSelection']||[];for(const _0x420b7d of _0x5d2235){if(_0x420b7d['_calName']&&_0x288da4[_0x1fb993(0x17e)]>0x0&&!_0x288da4[_0x1fb993(0x12b)](_0x420b7d[_0x1fb993(0xfc)]))continue;const _0x1a7636=_0x420b7d[_0x1fb993(0x15c)]||_0x420b7d[_0x1fb993(0x128)]||_0x420b7d[_0x1fb993(0x117)];if(!_0x1a7636)continue;const _0x4e9244=new Date(_0x1a7636);if(isNaN(_0x4e9244[_0x1fb993(0x171)]()))continue;const _0x1dcf0b=(_0x420b7d[_0x1fb993(0x178)]||_0x420b7d[_0x1fb993(0x118)]||'')['toLowerCase']();if(_0x1dcf0b['includes'](_0x1fb993(0x123))||_0x1dcf0b[_0x1fb993(0x12b)](_0x1fb993(0x111))||_0x1dcf0b[_0x1fb993(0x12b)](_0x1fb993(0x160))){let _0x3a2ec7=0x0;Object[_0x1fb993(0x106)](_0x58dd56)['forEach'](_0x3fb7ec=>{if(_0x3fb7ec>_0x3a2ec7)_0x3a2ec7=_0x3fb7ec;});if(_0x3a2ec7===0x0)_0x3a2ec7=0x78;const _0x1df60f=new Date(_0x4e9244[_0x1fb993(0x171)]()-_0x3a2ec7*0xea60),_0x4c28b2=_0x19cc9b[_0x1fb993(0x171)]()-_0x1df60f['getTime']();_0x4c28b2>=0x0&&_0x4c28b2<0x3c*0xea60&&(_0xf7742a['currentSystemMode']!==_0x1fb993(0x10d)&&(_0xf7742a[_0x1fb993(0x134)][_0x1fb993(0x127)]('üìÖ\x20SMART\x20SCHEDULE:\x20\x27Globaler\x20Start\x27\x20erkannt\x20('+_0x420b7d['event']+').\x20Heize\x20ganzes\x20Haus\x20auf\x20(Vorlauf:\x20'+_0x3a2ec7+'\x20min).'),await _0xf7742a['setStateAsync'](_0x1fb993(0x140),{'val':_0x1fb993(0x10d),'ack':![]})));}for(const _0x38efcf of _0x346bf1){if(_0x38efcf[_0x1fb993(0x152)]){const _0x1b31d4=_0x38efcf[_0x1fb993(0x152)][_0x1fb993(0x135)]();if(_0x1dcf0b[_0x1fb993(0x12b)](_0x1b31d4)){const _0x213c09=_0x58dd56[_0x38efcf[_0x1fb993(0x152)]]||0x3c,_0x152776=new Date(_0x4e9244['getTime']()-_0x213c09*0xea60),_0x244f0d=_0x19cc9b[_0x1fb993(0x171)]()-_0x152776[_0x1fb993(0x171)]();if(_0x244f0d>=0x0&&_0x244f0d<0x3c*0xea60){const _0x3fc21c=await findRelatedId(_0xf7742a,_0x38efcf['id'],_0x1fb993(0x173));if(_0x3fc21c){const _0x33bf82=await _0xf7742a['getForeignStateAsync'](_0x3fc21c);_0x33bf82&&typeof _0x33bf82['val']===_0x1fb993(0xf2)&&_0x33bf82[_0x1fb993(0x12c)]<20.5&&(_0xf7742a['log'][_0x1fb993(0x127)](_0x1fb993(0x13c)+_0x38efcf[_0x1fb993(0x152)]+_0x1fb993(0x112)+_0x420b7d[_0x1fb993(0x178)]+_0x1fb993(0xf5)+_0x213c09+_0x1fb993(0x136)),await _0xf7742a[_0x1fb993(0x10e)](_0x3fc21c,0x15),await _0xf7742a['setStateAsync']('analysis.automation.lastAction',{'val':_0x1fb993(0x185)+_0x38efcf['location']+'\x20->\x2021¬∞C','ack':!![]}));}}}}}}}catch(_0x48ee7d){_0xf7742a[_0x1fb993(0x134)][_0x1fb993(0x11f)](_0x1fb993(0x14f)+_0x48ee7d['message']);}}async function applyEnergySavings(_0x2e49c4,_0x9bb15d){const _0x28ed70=a1_0x5000c2;if(!_0x9bb15d||_0x9bb15d[_0x28ed70(0x17e)]===0x0)return;const _0x414cbb=_0x2e49c4[_0x28ed70(0x12e)][_0x28ed70(0x142)]||[],_0x2514c4=Date[_0x28ed70(0xfe)]();for(const _0x34e97f of _0x9bb15d){const _0x3ed44f=_0x34e97f[_0x28ed70(0xf7)],_0x3d4c3f=_0x34e97f[_0x28ed70(0x16b)],_0x269e3f=_0x34e97f['target']||0x15,_0x56f347=_0x414cbb[_0x28ed70(0x15d)](_0x40cdbe=>normalize(_0x40cdbe[_0x28ed70(0x152)])===normalize(_0x3ed44f)&&(_0x40cdbe[_0x28ed70(0x10f)]===_0x28ed70(0x167)||_0x40cdbe['type']===_0x28ed70(0x137)));if(!_0x56f347)continue;const _0x5ec77a=await findRelatedId(_0x2e49c4,_0x56f347['id'],_0x28ed70(0x173));if(_0x5ec77a){if(lastActions[_0x28ed70(0x14d)+_0x3ed44f]&&_0x2514c4-lastActions[_0x28ed70(0x14d)+_0x3ed44f]<0x1e*0x3c*0x3e8)continue;const _0x4efda5=await _0x2e49c4['getForeignStateAsync'](_0x5ec77a);if(_0x4efda5&&typeof _0x4efda5[_0x28ed70(0x12c)]==='number'){const _0x5b8a5d=_0x4efda5[_0x28ed70(0x12c)];if(_0x3d4c3f>0x1e)_0x5b8a5d>ECO_TEMP+0.5&&(_0x2e49c4[_0x28ed70(0x134)][_0x28ed70(0x127)](_0x28ed70(0x162)+_0x3ed44f+_0x28ed70(0x187)+ECO_TEMP+_0x28ed70(0x156)+_0x5b8a5d+'¬∞C,\x20Puffer:\x20'+_0x3d4c3f+'\x20min)\x20->\x20ID:\x20'+_0x5ec77a),await _0x2e49c4[_0x28ed70(0x10e)](_0x5ec77a,ECO_TEMP),lastActions[_0x28ed70(0x14d)+_0x3ed44f]=_0x2514c4,await _0x2e49c4[_0x28ed70(0x133)](_0x28ed70(0x153),{'val':_0x28ed70(0x150)+_0x3ed44f+':\x20Absenkung\x20auf\x20'+ECO_TEMP+'¬∞C','ack':!![]}));else _0x3d4c3f<=0xf&&(_0x5b8a5d<_0x269e3f&&(_0x2e49c4[_0x28ed70(0x134)][_0x28ed70(0x127)](_0x28ed70(0x17f)+_0x3ed44f+_0x28ed70(0x16d)+_0x269e3f+_0x28ed70(0x113)+_0x5ec77a),await _0x2e49c4[_0x28ed70(0x10e)](_0x5ec77a,_0x269e3f),lastActions[_0x28ed70(0x14d)+_0x3ed44f]=_0x2514c4,await _0x2e49c4[_0x28ed70(0x133)](_0x28ed70(0x153),{'val':_0x28ed70(0x150)+_0x3ed44f+_0x28ed70(0x110)+_0x269e3f+'¬∞C','ack':!![]})));}}else _0x2e49c4[_0x28ed70(0x134)][_0x28ed70(0x11f)]('[MPC\x20WARNING]\x20Kein\x20Setpoint\x20(Soll-Temp)\x20f√ºr\x20'+_0x3ed44f+_0x28ed70(0x168));}}module[a1_0x5000c2(0x189)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'updateSchedulePreview':updateSchedulePreview};