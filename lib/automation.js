const a1_0x5e6a7b=a1_0x3f07;function a1_0x4bf3(){const _0x3a12bb=['toString','parse','openknx','ðŸ“…\x20SMART\x20SCHEDULE:\x20Raum-Trigger\x20\x27','val','eventStart','Â°C,\x20Puffer:\x20','normal','includes','Fehlt','string','.1.LEVEL','setForeignStateAsync','forEach','exports','PrÃ¤diktion:\x20','Calendar\x20Check\x20Error:\x20','toLowerCase','4528IbRbOK','values','getStateAsync','level.valve','add','58854gCWzst',':\x20Absenkung\x20auf\x20','search','find','setpoint','rÃ¼ckkehr','analysis.automation.lastAction','common','analysis.energy.schedulePreview','getTime','now','summary','triggerTime','filter','messwert','getForeignStateAsync','analysis.automation.confidenceThreshold','write','PERFECT','Auto-Erkennung','system.mode','room','target','Unbekannt','.1.ACTUAL_TEMPERATURE','toUpperCase','from','wert','message','length','.4.SET_TEMPERATURE','set','Â°C!\x20(Puffer\x20leer).\x20->\x20ID:\x20','analysis.energy.warmupTimes','1125278NKkYdC','type','map','name','push','\x27\x20erkannt\x20(','actual','365AFDHgq','calendarSelection','_date','getForeignObjectAsync','7447365nCBHBk','location','off','.4.VALVE_STATE','mpc_','join','thermostatMapping','getForeignObjectsAsync','split','light','warn','Unknown','\x20min).','config','minutes_safe','date','number','[CAL]\x20','57444jLVXHS','.data.table','slice','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20(Soll-Temp)\x20fÃ¼r\x20','role','.1.TEMPERATURE','609603NAMNZp','state','ankunft','./ai_agent','local_temperature','value.valve','102ofDEYY','urlaub\x20ende','log','apply','_calName','level.temperature','.1.SET_POINT_TEMPERATURE','(((.+)+)+)+$','sensor','active','dimmer','level','setStateAsync','temperature','unit',').\x20Heize\x20ganzes\x20Haus\x20auf\x20(Vorlauf:\x20','ACTUAL_TEMPERATURE','4970KsORxs','SET_POINT_TEMPERATURE','info','approved','switch','\x20gefunden!\x20Bitte\x20\x27System\x27\x20Tab\x20prÃ¼fen.','devices','Ist','thermostat','consultButler','hm-rpc','reason','position','5381220NOyPYW','\x20auf\x20','calendarInstance','ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20','valveMapping','temp','\x20wieder\x20auf\x20','target_temperature','occupied_heating_setpoint','soll','score','ACTUAL','useCalendar','sort','SET','event','ist',':\x20Aufheizen\x20auf\x20','valve','replace','\x20->\x2021Â°C','\x20->\x20Schalte\x20'];a1_0x4bf3=function(){return _0x3a12bb;};return a1_0x4bf3();}(function(_0x2333ef,_0x31c1f7){const _0xff8a14=a1_0x3f07,_0x2b8086=_0x2333ef();while(!![]){try{const _0x6ad9a5=parseInt(_0xff8a14(0x232))/0x1+parseInt(_0xff8a14(0x20f))/0x2+parseInt(_0xff8a14(0x238))/0x3*(-parseInt(_0xff8a14(0x22c))/0x4)+parseInt(_0xff8a14(0x216))/0x5*(parseInt(_0xff8a14(0x1ed))/0x6)+parseInt(_0xff8a14(0x249))/0x7*(parseInt(_0xff8a14(0x1e8))/0x8)+-parseInt(_0xff8a14(0x21a))/0x9+-parseInt(_0xff8a14(0x256))/0xa;if(_0x6ad9a5===_0x31c1f7)break;else _0x2b8086['push'](_0x2b8086['shift']());}catch(_0x5bca8d){_0x2b8086['push'](_0x2b8086['shift']());}}}(a1_0x4bf3,0x6a836));const a1_0x31285e=(function(){let _0x5ddca0=!![];return function(_0x57120e,_0x3d4db5){const _0x37d13b=_0x5ddca0?function(){const _0x1c18d5=a1_0x3f07;if(_0x3d4db5){const _0x5478f9=_0x3d4db5[_0x1c18d5(0x23b)](_0x57120e,arguments);return _0x3d4db5=null,_0x5478f9;}}:function(){};return _0x5ddca0=![],_0x37d13b;};}()),a1_0x1a62c5=a1_0x31285e(this,function(){const _0x1e79d9=a1_0x3f07;return a1_0x1a62c5[_0x1e79d9(0x1d6)]()[_0x1e79d9(0x1ef)](_0x1e79d9(0x23f))['toString']()['constructor'](a1_0x1a62c5)[_0x1e79d9(0x1ef)]('(((.+)+)+)+$');});a1_0x1a62c5();'use strict';const aiAgent=require(a1_0x5e6a7b(0x235)),COOLDOWN_MS=0x3c*0x3e8,ECO_TEMP=0x11,lastActions={};function normalize(_0x4cdd60){const _0x52267c=a1_0x5e6a7b;if(!_0x4cdd60)return'';return _0x4cdd60[_0x52267c(0x1e7)]()[_0x52267c(0x1d3)](/\s+/g,'')['trim']();}async function handlePrediction(_0x3877c2,_0x74571,_0xc05bf1){const _0x427067=a1_0x5e6a7b;if(!_0x74571||_0x74571===_0x427067(0x225))return;let _0x598d1f=_0x427067(0x21c),_0x1eb8f2=0.6;try{const _0x465777=await _0x3877c2['getStateAsync']('analysis.automation.mode');if(_0x465777&&_0x465777[_0x427067(0x1da)])_0x598d1f=_0x465777[_0x427067(0x1da)];const _0x401583=await _0x3877c2[_0x427067(0x1ea)](_0x427067(0x1fd));if(_0x401583&&_0x401583[_0x427067(0x1da)])_0x1eb8f2=_0x401583['val'];}catch(_0x2ede44){}if(_0x598d1f==='off'||_0xc05bf1<_0x1eb8f2)return;const _0x204352=Date[_0x427067(0x1f7)]();if(lastActions[_0x74571]&&_0x204352-lastActions[_0x74571]<COOLDOWN_MS)return;const _0x8884f5=_0x3877c2[_0x427067(0x227)][_0x427067(0x24f)]||[],_0x1058d4=normalize(_0x74571),_0x4a0e2a=_0x8884f5[_0x427067(0x1f0)](_0x72dfeb=>normalize(_0x72dfeb['location'])===_0x1058d4&&(_0x72dfeb[_0x427067(0x210)]===_0x427067(0x223)||_0x72dfeb[_0x427067(0x210)]===_0x427067(0x242)||_0x72dfeb[_0x427067(0x210)]===_0x427067(0x24d)));if(!_0x4a0e2a)return;const _0x1a533a=await aiAgent[_0x427067(0x252)](_0x3877c2,_0x74571,_0x4a0e2a[_0x427067(0x212)],_0xc05bf1);if(!_0x1a533a[_0x427067(0x24c)])return;const _0x180064=_0x427067(0x1e5)+_0x74571+_0x427067(0x1d5)+_0x4a0e2a[_0x427067(0x212)]+'\x20('+_0x1a533a[_0x427067(0x254)]+')';await _0x3877c2[_0x427067(0x244)](_0x427067(0x1f3),{'val':'['+_0x598d1f[_0x427067(0x206)]()+']\x20'+_0x180064,'ack':!![]});if(_0x598d1f===_0x427067(0x241)){const _0x2b851b=await _0x3877c2[_0x427067(0x1fc)](_0x4a0e2a['id']);(!_0x2b851b||!_0x2b851b[_0x427067(0x1da)]&&_0x2b851b[_0x427067(0x1da)]!==!![])&&await _0x3877c2[_0x427067(0x1e2)](_0x4a0e2a['id'],!![]),lastActions[_0x74571]=_0x204352;}}function a1_0x3f07(_0x139025,_0x2339d6){const _0xfc99f5=a1_0x4bf3();return a1_0x3f07=function(_0x1a62c5,_0x31285e){_0x1a62c5=_0x1a62c5-0x1ce;let _0x4bf333=_0xfc99f5[_0x1a62c5];return _0x4bf333;},a1_0x3f07(_0x139025,_0x2339d6);}async function findRelatedId(_0x486cca,_0xcd81ab,_0x5df37d=a1_0x5e6a7b(0x1f1)){const _0xa25178=a1_0x5e6a7b;if(_0x5df37d==='setpoint'&&_0x486cca['config'][_0xa25178(0x220)]){let _0x97adaf=_0x486cca[_0xa25178(0x227)][_0xa25178(0x220)];if(typeof _0x97adaf===_0xa25178(0x1e0))try{_0x97adaf=JSON[_0xa25178(0x1d7)](_0x97adaf);}catch(_0x1a063e){}if(_0x97adaf&&_0x97adaf[_0xcd81ab])return _0x97adaf[_0xcd81ab];}if(_0x5df37d===_0xa25178(0x1d2)&&_0x486cca[_0xa25178(0x227)][_0xa25178(0x25a)]){let _0x238ac4=_0x486cca[_0xa25178(0x227)][_0xa25178(0x25a)];if(typeof _0x238ac4===_0xa25178(0x1e0))try{_0x238ac4=JSON['parse'](_0x238ac4);}catch(_0x1c0b16){}if(_0x238ac4&&_0x238ac4[_0xcd81ab])return _0x238ac4[_0xcd81ab];}let _0x15631d=[];if(_0x5df37d==='setpoint')_0x15631d=[{'s':_0xa25178(0x205),'t':_0xa25178(0x23e)},{'s':_0xa25178(0x231),'t':_0xa25178(0x23e)},{'s':_0xa25178(0x231),'t':_0xa25178(0x20b)},{'s':_0xa25178(0x248),'t':_0xa25178(0x24a)},{'s':_0xa25178(0x236),'t':_0xa25178(0x25e)},{'s':_0xa25178(0x236),'t':'current_heating_setpoint'},{'s':_0xa25178(0x245),'t':_0xa25178(0x25d)},{'s':_0xa25178(0x261),'t':_0xa25178(0x1ce)},{'s':_0xa25178(0x250),'t':'Soll'},{'s':'temperature','t':'setpoint'}];else _0x5df37d===_0xa25178(0x1d2)&&(_0x15631d=[{'s':'.1.ACTUAL_TEMPERATURE','t':_0xa25178(0x1e1)},{'s':_0xa25178(0x231),'t':'.1.LEVEL'},{'s':_0xa25178(0x231),'t':_0xa25178(0x21d)},{'s':_0xa25178(0x236),'t':'pi_heating_demand'},{'s':_0xa25178(0x245),'t':'valve_position'},{'s':'temperature','t':_0xa25178(0x243)}]);for(const _0x3ad7a5 of _0x15631d){if(_0xcd81ab[_0xa25178(0x1de)](_0x3ad7a5['s'])){const _0x14ec4f=_0xcd81ab[_0xa25178(0x1d3)](_0x3ad7a5['s'],_0x3ad7a5['t']),_0x664159=await _0x486cca[_0xa25178(0x219)](_0x14ec4f);if(_0x664159)return _0x14ec4f;}}try{const _0x21c33a=_0xcd81ab['split']('.');if(_0x21c33a[_0xa25178(0x20a)]>0x2){const _0x51bcc6=_0x21c33a[_0xa25178(0x22e)](0x0,-0x1)[_0xa25178(0x21f)]('.'),_0x2a859=await _0x486cca[_0xa25178(0x221)](_0x51bcc6+'.*'),_0x4f982f=[],_0x5be9e3=_0xcd81ab[_0xa25178(0x222)](/[._]+/)['filter'](_0x550920=>![_0xa25178(0x1d8),'0',_0xa25178(0x253),_0xa25178(0x1d0),_0xa25178(0x208),_0xa25178(0x245),_0xa25178(0x215),_0xa25178(0x240),_0xa25178(0x1fb),_0xa25178(0x233)]['includes'](_0x550920['toLowerCase']()));for(const [_0x30b044,_0x154af9]of Object['entries'](_0x2a859)){if(_0x30b044===_0xcd81ab)continue;if(_0x154af9&&_0x154af9[_0xa25178(0x1f4)]){const _0x4f718d=_0x30b044[_0xa25178(0x1e7)](),_0x124374=(_0x154af9[_0xa25178(0x1f4)][_0xa25178(0x230)]||'')[_0xa25178(0x1e7)](),_0x456af0=(_0x154af9[_0xa25178(0x1f4)][_0xa25178(0x246)]||'')[_0xa25178(0x1e7)]();let _0x4e4c03=![];if(_0x5df37d===_0xa25178(0x1f1)&&_0x154af9['common'][_0xa25178(0x1fe)]===!![])_0x4e4c03=_0x4f718d[_0xa25178(0x1de)](_0xa25178(0x20c))||_0x4f718d[_0xa25178(0x1de)](_0xa25178(0x25f))||_0x4f718d['includes'](_0xa25178(0x203))||_0x124374[_0xa25178(0x1de)](_0xa25178(0x23d))||_0x124374['includes']('thermostat.setpoint');else _0x5df37d===_0xa25178(0x1d2)&&(_0x4e4c03=_0x4f718d[_0xa25178(0x1de)](_0xa25178(0x243))||_0x4f718d['includes'](_0xa25178(0x1d2))||_0x4f718d['includes']('stellwert')||_0x4f718d[_0xa25178(0x1de)](_0xa25178(0x255))||_0x124374[_0xa25178(0x1de)](_0xa25178(0x1eb))||_0x124374[_0xa25178(0x1de)](_0xa25178(0x237))||_0x456af0['includes']('%'));if(_0x4e4c03){const _0x3cc40d=_0x30b044[_0xa25178(0x222)](/[._]+/)[_0xa25178(0x211)](_0x378a90=>_0x378a90[_0xa25178(0x1e7)]());let _0x54c13b=0x0;_0x5be9e3[_0xa25178(0x1e3)](_0x49adbc=>{const _0x5b2f98=_0xa25178;if(_0x3cc40d[_0x5b2f98(0x1de)](_0x49adbc[_0x5b2f98(0x1e7)]()))_0x54c13b++;}),_0x4f982f[_0xa25178(0x213)]({'id':_0x30b044,'score':_0x54c13b});}}}if(_0x4f982f[_0xa25178(0x20a)]>0x0){_0x4f982f[_0xa25178(0x263)]((_0x135ce5,_0x29f069)=>_0x29f069[_0xa25178(0x260)]-_0x135ce5['score']);if(_0x4f982f[0x0]['score']>0x0)return _0x4f982f[0x0]['id'];}}}catch(_0x3445f9){}return null;}async function scanThermostats(_0x560960){const _0x2f84f4=a1_0x5e6a7b,_0x33dd5e=_0x560960['config'][_0x2f84f4(0x24f)]||[],_0x311711=[],_0x4669f5=_0x33dd5e[_0x2f84f4(0x1fa)](_0x1a4972=>_0x1a4972['id']&&_0x1a4972['id'][_0x2f84f4(0x1de)](_0x2f84f4(0x245))||_0x1a4972[_0x2f84f4(0x210)]&&[_0x2f84f4(0x245),_0x2f84f4(0x251),_0x2f84f4(0x240)][_0x2f84f4(0x1de)](_0x1a4972['type'])||_0x1a4972[_0x2f84f4(0x212)]&&_0x1a4972[_0x2f84f4(0x212)][_0x2f84f4(0x1e7)]()[_0x2f84f4(0x1de)](_0x2f84f4(0x25b)));for(const _0x407dae of _0x4669f5){const _0x3c0f0c=await findRelatedId(_0x560960,_0x407dae['id'],_0x2f84f4(0x1f1)),_0x5b858e=await findRelatedId(_0x560960,_0x407dae['id'],_0x2f84f4(0x1d2));let _0x3c4519='Nicht\x20gefunden',_0x7a4bf6=![],_0xa40505=_0x560960['config'][_0x2f84f4(0x220)]||{};if(typeof _0xa40505===_0x2f84f4(0x1e0))try{_0xa40505=JSON[_0x2f84f4(0x1d7)](_0xa40505);}catch(_0x533513){}let _0xc777c=_0x560960[_0x2f84f4(0x227)][_0x2f84f4(0x25a)]||{};if(typeof _0xc777c===_0x2f84f4(0x1e0))try{_0xc777c=JSON[_0x2f84f4(0x1d7)](_0xc777c);}catch(_0x57cf39){}if(_0xa40505[_0x407dae['id']]&&_0xa40505[_0x407dae['id']]===_0x3c0f0c||_0xc777c[_0x407dae['id']]&&_0xc777c[_0x407dae['id']]===_0x5b858e)_0x3c4519='Manuelles\x20Mapping',_0x7a4bf6=!![];else(_0x3c0f0c||_0x5b858e)&&(_0x3c4519=_0x2f84f4(0x200));_0x311711['push']({'room':_0x407dae[_0x2f84f4(0x21b)]||_0x2f84f4(0x204),'sensorId':_0x407dae['id'],'setpointId':_0x3c0f0c||'-','valveId':_0x5b858e||'-','source':_0x3c4519,'isManual':_0x7a4bf6,'status':_0x3c0f0c&&_0x5b858e?_0x2f84f4(0x1ff):_0x3c0f0c?'OK':_0x2f84f4(0x1df)});}return _0x311711[_0x2f84f4(0x263)]((_0x28372c,_0x24e5c6)=>_0x28372c[_0x2f84f4(0x202)]['localeCompare'](_0x24e5c6[_0x2f84f4(0x202)]));}async function updateSchedulePreview(_0x5409c1){const _0x210d82=a1_0x5e6a7b;if(!_0x5409c1['config'][_0x210d82(0x262)]||!_0x5409c1[_0x210d82(0x227)][_0x210d82(0x258)])return;let _0x155adf={};try{const _0x2ae560=await _0x5409c1[_0x210d82(0x1ea)](_0x210d82(0x20e));if(_0x2ae560&&_0x2ae560['val'])_0x155adf=JSON[_0x210d82(0x1d7)](_0x2ae560[_0x210d82(0x1da)]);}catch(_0x48e002){}const _0x182f26=[],_0x457c00=Date[_0x210d82(0x1f7)](),_0x268514=0x30*0x3c*0x3c*0x3e8;try{const _0x2646f8=await _0x5409c1['getForeignStateAsync'](_0x5409c1[_0x210d82(0x227)][_0x210d82(0x258)]+_0x210d82(0x22d));if(!_0x2646f8||!_0x2646f8[_0x210d82(0x1da)])return;const _0x12cfe6=JSON[_0x210d82(0x1d7)](_0x2646f8[_0x210d82(0x1da)]),_0x5b9df5=_0x5409c1[_0x210d82(0x227)][_0x210d82(0x217)]||[],_0x2d7a04=_0x5409c1[_0x210d82(0x227)][_0x210d82(0x24f)]||[],_0xf473de=new Set();_0x2d7a04[_0x210d82(0x1e3)](_0x44f8fb=>{const _0x47d44a=_0x210d82;if(_0x44f8fb['location'])_0xf473de[_0x47d44a(0x1ec)](_0x44f8fb[_0x47d44a(0x21b)]);});for(const _0x3699e5 of _0x12cfe6){if(_0x3699e5[_0x210d82(0x23c)]&&_0x5b9df5['length']>0x0&&!_0x5b9df5[_0x210d82(0x1de)](_0x3699e5[_0x210d82(0x23c)]))continue;const _0x36e093=_0x3699e5[_0x210d82(0x218)]||_0x3699e5[_0x210d82(0x1db)]||_0x3699e5[_0x210d82(0x229)];if(!_0x36e093)continue;const _0x25c6fd=new Date(_0x36e093),_0x40b98f=_0x25c6fd['getTime']();if(isNaN(_0x40b98f))continue;if(_0x40b98f<_0x457c00)continue;if(_0x40b98f>_0x457c00+_0x268514)continue;const _0x2d5c8b=(_0x3699e5[_0x210d82(0x1cf)]||_0x3699e5['summary']||'')[_0x210d82(0x1e7)]();let _0x4502c6=![],_0x3b60b7=[],_0x4275db=_0x3699e5[_0x210d82(0x1cf)]||_0x3699e5[_0x210d82(0x1f8)]||_0x210d82(0x204);if(_0x2d5c8b[_0x210d82(0x1de)](_0x210d82(0x239))||_0x2d5c8b[_0x210d82(0x1de)](_0x210d82(0x1f2))||_0x2d5c8b[_0x210d82(0x1de)](_0x210d82(0x234)))_0x4502c6=!![],_0x3b60b7=Array[_0x210d82(0x207)](_0xf473de);else for(const _0x6db43c of _0xf473de){_0x2d5c8b[_0x210d82(0x1de)](_0x6db43c['toLowerCase']())&&_0x3b60b7[_0x210d82(0x213)](_0x6db43c);}_0x3b60b7[_0x210d82(0x20a)]>0x0&&_0x3b60b7[_0x210d82(0x1e3)](_0x11dbec=>{const _0x501c7b=_0x210d82;let _0x2bc11a=0x3c;if(_0x4502c6){let _0x186383=0x0;Object[_0x501c7b(0x1e9)](_0x155adf)[_0x501c7b(0x1e3)](_0x54cfb9=>{if(_0x54cfb9>_0x186383)_0x186383=_0x54cfb9;}),_0x2bc11a=_0x186383>0x0?_0x186383:0x78;}else _0x2bc11a=_0x155adf[_0x11dbec]||0x3c;const _0xd7587f=new Date(_0x40b98f-_0x2bc11a*0xea60);_0x182f26['push']({'eventTime':_0x40b98f,'triggerTime':_0xd7587f[_0x501c7b(0x1f6)](),'room':_0x11dbec,'minutes':_0x2bc11a,'reason':_0x4275db,'isGlobal':_0x4502c6});});}}catch(_0x3df81a){}_0x182f26[_0x210d82(0x263)]((_0x92292d,_0x627389)=>_0x92292d[_0x210d82(0x1f9)]-_0x627389[_0x210d82(0x1f9)]);const _0x20e941=_0x182f26[_0x210d82(0x22e)](0x0,0x5);await _0x5409c1['setStateAsync'](_0x210d82(0x1f5),{'val':JSON['stringify'](_0x20e941),'ack':!![]});}async function checkCalendarTriggers(_0x3b6344){const _0x90f585=a1_0x5e6a7b;if(!_0x3b6344[_0x90f585(0x227)][_0x90f585(0x262)]||!_0x3b6344[_0x90f585(0x227)]['calendarInstance'])return;await updateSchedulePreview(_0x3b6344);let _0x20e9b1={};try{const _0x37e11d=await _0x3b6344[_0x90f585(0x1ea)](_0x90f585(0x20e));if(_0x37e11d&&_0x37e11d[_0x90f585(0x1da)])_0x20e9b1=JSON[_0x90f585(0x1d7)](_0x37e11d[_0x90f585(0x1da)]);}catch(_0x32da07){}try{const _0x4571a3=await _0x3b6344[_0x90f585(0x1fc)](_0x3b6344[_0x90f585(0x227)][_0x90f585(0x258)]+'.data.table');if(!_0x4571a3||!_0x4571a3[_0x90f585(0x1da)])return;const _0x3837bb=JSON[_0x90f585(0x1d7)](_0x4571a3[_0x90f585(0x1da)]),_0x2fb626=new Date(),_0x4dc6e0=_0x3b6344[_0x90f585(0x227)][_0x90f585(0x24f)]||[],_0x5452fe=_0x3b6344[_0x90f585(0x227)][_0x90f585(0x217)]||[];for(const _0xbf4011 of _0x3837bb){if(_0xbf4011[_0x90f585(0x23c)]&&_0x5452fe[_0x90f585(0x20a)]>0x0&&!_0x5452fe[_0x90f585(0x1de)](_0xbf4011[_0x90f585(0x23c)]))continue;const _0x3c43dc=_0xbf4011[_0x90f585(0x218)]||_0xbf4011[_0x90f585(0x1db)]||_0xbf4011['date'];if(!_0x3c43dc)continue;const _0x23b1a0=new Date(_0x3c43dc);if(isNaN(_0x23b1a0[_0x90f585(0x1f6)]()))continue;const _0xb69022=(_0xbf4011['event']||_0xbf4011[_0x90f585(0x1f8)]||'')[_0x90f585(0x1e7)]();if(_0xb69022['includes'](_0x90f585(0x239))||_0xb69022['includes'](_0x90f585(0x1f2))||_0xb69022['includes']('ankunft')){let _0x1ee129=0x0;Object['values'](_0x20e9b1)[_0x90f585(0x1e3)](_0x10ea3b=>{if(_0x10ea3b>_0x1ee129)_0x1ee129=_0x10ea3b;});if(_0x1ee129===0x0)_0x1ee129=0x78;const _0x19ead6=new Date(_0x23b1a0['getTime']()-_0x1ee129*0xea60),_0x4f7f2c=_0x2fb626[_0x90f585(0x1f6)]()-_0x19ead6[_0x90f585(0x1f6)]();_0x4f7f2c>=0x0&&_0x4f7f2c<0xf*0xea60&&(_0x3b6344[_0x90f585(0x23a)][_0x90f585(0x24b)]('ðŸ“…\x20SMART\x20SCHEDULE:\x20\x27Globaler\x20Start\x27\x20erkannt\x20('+_0xbf4011[_0x90f585(0x1cf)]+_0x90f585(0x247)+_0x1ee129+_0x90f585(0x226)),await _0x3b6344['setStateAsync'](_0x90f585(0x201),{'val':_0x90f585(0x1dd),'ack':![]}));}for(const _0xe4d01d of _0x4dc6e0){if(_0xe4d01d['location']){const _0x412872=_0xe4d01d[_0x90f585(0x21b)][_0x90f585(0x1e7)]();if(_0xb69022[_0x90f585(0x1de)](_0x412872)){const _0x39322c=_0x20e9b1[_0xe4d01d[_0x90f585(0x21b)]]||0x3c,_0x3bc65c=new Date(_0x23b1a0[_0x90f585(0x1f6)]()-_0x39322c*0xea60),_0x214f83=_0x2fb626['getTime']()-_0x3bc65c[_0x90f585(0x1f6)]();if(_0x214f83>=0x0&&_0x214f83<0xf*0xea60){const _0x5eb7ee=await findRelatedId(_0x3b6344,_0xe4d01d['id'],_0x90f585(0x1f1));_0x5eb7ee&&(_0x3b6344[_0x90f585(0x23a)]['info'](_0x90f585(0x1d9)+_0xe4d01d[_0x90f585(0x21b)]+_0x90f585(0x214)+_0xbf4011['event']+').\x20Heize\x20auf\x2021Â°C\x20(Vorlauf:\x20'+_0x39322c+_0x90f585(0x226)),await _0x3b6344[_0x90f585(0x1e2)](_0x5eb7ee,0x15),await _0x3b6344['setStateAsync']('analysis.automation.lastAction',{'val':_0x90f585(0x22b)+_0xe4d01d[_0x90f585(0x21b)]+_0x90f585(0x1d4),'ack':!![]}));}}}}}}catch(_0x43ffab){_0x3b6344[_0x90f585(0x23a)][_0x90f585(0x224)](_0x90f585(0x1e6)+_0x43ffab[_0x90f585(0x209)]);}}async function applyEnergySavings(_0x2eaa24,_0x5541e1){const _0x338709=a1_0x5e6a7b;if(!_0x5541e1||_0x5541e1[_0x338709(0x20a)]===0x0)return;const _0x5e4646=_0x2eaa24[_0x338709(0x227)][_0x338709(0x24f)]||[],_0x4ecc6a=Date[_0x338709(0x1f7)]();for(const _0x3a78ab of _0x5541e1){const _0x4991f4=_0x3a78ab[_0x338709(0x202)],_0x4befb4=_0x3a78ab[_0x338709(0x228)],_0x150206=_0x3a78ab['target']||0x15,_0x3e32bb=_0x5e4646[_0x338709(0x1f0)](_0xe16364=>normalize(_0xe16364[_0x338709(0x21b)])===normalize(_0x4991f4)&&(_0xe16364[_0x338709(0x210)]===_0x338709(0x245)||_0xe16364[_0x338709(0x210)]===_0x338709(0x251)));if(!_0x3e32bb)continue;const _0x30fcca=await findRelatedId(_0x2eaa24,_0x3e32bb['id'],_0x338709(0x1f1));if(_0x30fcca){if(lastActions[_0x338709(0x21e)+_0x4991f4]&&_0x4ecc6a-lastActions[_0x338709(0x21e)+_0x4991f4]<0x1e*0x3c*0x3e8)continue;const _0x3f0a77=await _0x2eaa24[_0x338709(0x1fc)](_0x30fcca);if(_0x3f0a77&&typeof _0x3f0a77[_0x338709(0x1da)]===_0x338709(0x22a)){const _0x5bc558=_0x3f0a77[_0x338709(0x1da)];if(_0x4befb4>0x1e)_0x5bc558>ECO_TEMP+0.5&&(_0x2eaa24[_0x338709(0x23a)][_0x338709(0x24b)]('ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20'+_0x4991f4+_0x338709(0x257)+ECO_TEMP+'Â°C!\x20(Aktuell:\x20'+_0x5bc558+_0x338709(0x1dc)+_0x4befb4+'\x20min)\x20->\x20ID:\x20'+_0x30fcca),await _0x2eaa24['setForeignStateAsync'](_0x30fcca,ECO_TEMP),lastActions['mpc_'+_0x4991f4]=_0x4ecc6a,await _0x2eaa24['setStateAsync']('analysis.automation.lastAction',{'val':'[MPC]\x20'+_0x4991f4+_0x338709(0x1ee)+ECO_TEMP+'Â°C','ack':!![]}));else _0x4befb4<=0xf&&(_0x5bc558<_0x150206&&(_0x2eaa24['log'][_0x338709(0x24b)](_0x338709(0x259)+_0x4991f4+_0x338709(0x25c)+_0x150206+_0x338709(0x20d)+_0x30fcca),await _0x2eaa24[_0x338709(0x1e2)](_0x30fcca,_0x150206),lastActions[_0x338709(0x21e)+_0x4991f4]=_0x4ecc6a,await _0x2eaa24[_0x338709(0x244)](_0x338709(0x1f3),{'val':'[MPC]\x20'+_0x4991f4+_0x338709(0x1d1)+_0x150206+'Â°C','ack':!![]})));}}else _0x2eaa24['log'][_0x338709(0x224)](_0x338709(0x22f)+_0x4991f4+_0x338709(0x24e));}}module[a1_0x5e6a7b(0x1e4)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'updateSchedulePreview':updateSchedulePreview};