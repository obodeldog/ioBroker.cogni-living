const a1_0x2f7943=a1_0x247e;(function(_0x26b34e,_0x5ed1fa){const _0x1d42e3=a1_0x247e,_0x41a1aa=_0x26b34e();while(!![]){try{const _0x3cf129=-parseInt(_0x1d42e3(0x168))/0x1*(parseInt(_0x1d42e3(0x1a7))/0x2)+-parseInt(_0x1d42e3(0x13c))/0x3*(-parseInt(_0x1d42e3(0x1d9))/0x4)+parseInt(_0x1d42e3(0x131))/0x5+-parseInt(_0x1d42e3(0x14a))/0x6*(-parseInt(_0x1d42e3(0x1e4))/0x7)+-parseInt(_0x1d42e3(0x157))/0x8*(parseInt(_0x1d42e3(0x1cc))/0x9)+-parseInt(_0x1d42e3(0x1d1))/0xa+parseInt(_0x1d42e3(0x188))/0xb;if(_0x3cf129===_0x5ed1fa)break;else _0x41a1aa['push'](_0x41a1aa['shift']());}catch(_0x3adc2d){_0x41a1aa['push'](_0x41a1aa['shift']());}}}(a1_0x1c73,0xa598f));const a1_0x103c10=(function(){let _0xf9829d=!![];return function(_0x5acbf8,_0xe4d160){const _0x3b39bc=_0xf9829d?function(){const _0x164056=a1_0x247e;if(_0xe4d160){const _0x50a065=_0xe4d160[_0x164056(0x17f)](_0x5acbf8,arguments);return _0xe4d160=null,_0x50a065;}}:function(){};return _0xf9829d=![],_0x3b39bc;};}()),a1_0x35396c=a1_0x103c10(this,function(){const _0x598554=a1_0x247e;return a1_0x35396c[_0x598554(0x1b0)]()[_0x598554(0x172)](_0x598554(0x170))[_0x598554(0x1b0)]()[_0x598554(0x1c3)](a1_0x35396c)['search'](_0x598554(0x170));});a1_0x35396c();'use strict';const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x1c292c){const _0x54ca8e=a1_0x247e;if(!_0x1c292c)return'';return _0x1c292c[_0x54ca8e(0x142)]()[_0x54ca8e(0x1c4)](/\s+/g,'')[_0x54ca8e(0x128)]();}function getWarmupRobust(_0x585c99,_0x441e6f){const _0x1fce43=a1_0x247e;if(!_0x585c99||!_0x441e6f)return 0x3c;if(_0x585c99[_0x441e6f]!==undefined)return _0x585c99[_0x441e6f];const _0x329eea=_0x441e6f[_0x1fce43(0x142)]()[_0x1fce43(0x1c4)](/Ã¤/g,'ae')[_0x1fce43(0x1c4)](/Ã¶/g,'oe')['replace'](/Ã¼/g,'ue')[_0x1fce43(0x1c4)](/ÃŸ/g,'ss')[_0x1fce43(0x1c4)](/\s+/g,'_')[_0x1fce43(0x1c4)](/[^a-z0-9_]/g,'');if(_0x585c99[_0x329eea]!==undefined)return _0x585c99[_0x329eea];return 0x3c;}async function logAutomationAction(_0x1846b4,_0x4de681){const _0x2eca17=a1_0x247e;await _0x1846b4[_0x2eca17(0x1e0)](_0x2eca17(0x1b7),{'val':_0x4de681,'ack':!![]});try{const _0xf6f29d='analysis.automation.actionLog',_0x4b328a=await _0x1846b4[_0x2eca17(0x1db)](_0xf6f29d);let _0xa37763=[];if(_0x4b328a&&_0x4b328a['val'])try{_0xa37763=JSON[_0x2eca17(0x154)](_0x4b328a[_0x2eca17(0x1ad)]);}catch(_0x4d42c8){}_0xa37763[_0x2eca17(0x1b3)]({'ts':Date[_0x2eca17(0x1d8)](),'msg':_0x4de681});if(_0xa37763[_0x2eca17(0x15b)]>0x32)_0xa37763=_0xa37763[_0x2eca17(0x1c2)](0x0,0x32);await _0x1846b4[_0x2eca17(0x1e0)](_0xf6f29d,{'val':JSON[_0x2eca17(0x1b6)](_0xa37763),'ack':!![]});}catch(_0x248fb3){}}function a1_0x1c73(){const _0x1a8979=[':\x20Absenkung\x20auf\x20','_meta','getForeignStateAsync','Ist','currentSystemMode','ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','slice','constructor','replace','\x20erreicht\x20Limit\x20(',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','valveMapping','occupied_heating_setpoint',']:\x20Raum-Trigger\x20\x27','analysis.energy.warmupSources','Â°C).\x20Sparmodus\x20beendet!','4338PYGRjq','message','\x20gefunden!','.1.SET_POINT_TEMPERATURE','[MPC]\x20','8166270rXeoln','minutes_safe','temperature','ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','active','ACTUAL','sensor','now','788036lThEnW','state','getStateAsync','soll','filter','thermostat.setpoint','sendToPythonWrapper','setStateAsync','analysis.energy.mpcActiveInterventions','\x20wurde\x20manuell\x20erhÃ¶ht.','mpc_','80374HmVnwG','Unbekannt','ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27','analysis.energy.rlPenalties','calendarSelection','[WATCHDOG]\x20','log','room','summary','Â°C\x20(Vorlauf:\x20','config','getHours','abs','manual','trim','analysis.automation.mode','setForeignStateAsync','\x20wieder\x20auf\x20','ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','from','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','date','Â°C\x20->\x20','1135550VhjDji','consultButler','\x20->\x20Schalte\x20','info','getTime','.4.SET_TEMPERATURE','values','_calName','off','ACTUAL_TEMPERATURE','analysis.energy.warmupTimes','9MzwwXm','thermostat','find','contact','.1.TEMPERATURE','normal','toLowerCase','valve_position','Â°C\x20<\x20','level','warn','PERFECT','\x20auf\x20','urlaub\x20ende','12yPmgVO','location','Â°C\x20(Kalender-Schutz)','sort','.4.VALVE_STATE',':\x20Aufheizen\x20auf\x20','hm-rpc','_date','rÃ¼ckkehr','analysis.automation.confidenceThreshold','parse','Classic','eventStart','14968wLyZVL','approved','Â°C.','pi_heating_demand','length','thermostatMapping','forEach','window','Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20','calendarInstance','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20',')\x20aktiv.\x20Heize\x20auf\x20','remove','dimmer','default','analysis.energy.schedulePreview','Â°C\x20(nicht\x20','536532vZxkMb','set','error','rescue_','setpoint','Manuelles\x20Mapping','too_cold','valve','(((.+)+)+)+$','.data.table','search','ðŸ“…\x20SMART\x20SCHEDULE\x20[','splice','current_heating_setpoint','ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20','Â°C).\x20Entferne\x20Status.','Nicht\x20gefunden','common','findIndex','Unknown','name','type','analysis.energy.activeEnforcements','apply','messwert','Â°C\x20(via\x20','SET_POINT_TEMPERATURE','[CAL]\x20','Fehlt','score','ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','useCalendar','28915689xzndpM','devices','triggerTime','split','system.mode','Enforcement\x20Monitor\x20Error:\x20','open','\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.','getForeignObjectAsync','cal_','add','localeCompare','target','ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20','level.valve','ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','Â°C!\x20(Puffer:\x20','ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20','\x20ist\x20auf\x20','getForeignObjectsAsync','string','push','toUpperCase','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','light','.1.LEVEL','local_temperature','PrÃ¤diktion:\x20','write','\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.','\x27\x20(Match:\x20','4ZiGpLd','switch','event','analysis.energy.warmupTargets','includes','isArray','val','number','stellwert','toString','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','\x20->\x20','unshift','position','[FORCE]\x20','stringify','analysis.automation.lastAction','entries','Soll','analysis.energy.ventilationAlerts','\x20min)'];a1_0x1c73=function(){return _0x1a8979;};return a1_0x1c73();}async function handlePrediction(_0x58b349,_0x3535ee,_0x46df2f){const _0x4c4fc5=a1_0x247e;if(!_0x3535ee||_0x3535ee===_0x4c4fc5(0x17b))return;let _0xf3e25='off',_0x2a19fe=0.6;try{const _0x33d292=await _0x58b349[_0x4c4fc5(0x1db)](_0x4c4fc5(0x129));if(_0x33d292&&_0x33d292[_0x4c4fc5(0x1ad)])_0xf3e25=_0x33d292['val'];const _0x4e3cef=await _0x58b349[_0x4c4fc5(0x1db)](_0x4c4fc5(0x153));if(_0x4e3cef&&_0x4e3cef[_0x4c4fc5(0x1ad)])_0x2a19fe=_0x4e3cef['val'];}catch(_0x1eba7c){}if(_0xf3e25===_0x4c4fc5(0x139)||_0x46df2f<_0x2a19fe)return;const _0x3f00ab=Date[_0x4c4fc5(0x1d8)]();if(lastActions[_0x3535ee]&&_0x3f00ab-lastActions[_0x3535ee]<COOLDOWN_MS)return;const _0x1ec277=_0x58b349['config'][_0x4c4fc5(0x189)]||[],_0x34273d=normalize(_0x3535ee),_0x55cea9=_0x1ec277[_0x4c4fc5(0x13e)](_0x532646=>normalize(_0x532646[_0x4c4fc5(0x14b)])===_0x34273d&&(_0x532646[_0x4c4fc5(0x17d)]===_0x4c4fc5(0x1a0)||_0x532646[_0x4c4fc5(0x17d)]===_0x4c4fc5(0x164)||_0x532646[_0x4c4fc5(0x17d)]===_0x4c4fc5(0x1a8)));if(!_0x55cea9)return;const _0x198bc6=await aiAgent[_0x4c4fc5(0x132)](_0x58b349,_0x3535ee,_0x55cea9['name'],_0x46df2f);if(!_0x198bc6[_0x4c4fc5(0x158)])return;const _0x1b1030=_0x4c4fc5(0x1a3)+_0x3535ee+_0x4c4fc5(0x133)+_0x55cea9[_0x4c4fc5(0x17c)]+'\x20('+_0x198bc6['reason']+')';await logAutomationAction(_0x58b349,'['+_0xf3e25[_0x4c4fc5(0x19e)]()+']\x20'+_0x1b1030);if(_0xf3e25===_0x4c4fc5(0x1d5)){const _0x2a80a2=await _0x58b349[_0x4c4fc5(0x1be)](_0x55cea9['id']);(!_0x2a80a2||!_0x2a80a2[_0x4c4fc5(0x1ad)]&&_0x2a80a2[_0x4c4fc5(0x1ad)]!==!![])&&await _0x58b349[_0x4c4fc5(0x12a)](_0x55cea9['id'],!![]),lastActions[_0x3535ee]=_0x3f00ab;}}async function findRelatedId(_0x344881,_0x41793a,_0x4ad932=a1_0x2f7943(0x16c)){const _0xc1cc87=a1_0x2f7943;if(_0x4ad932===_0xc1cc87(0x16c)&&_0x344881[_0xc1cc87(0x124)][_0xc1cc87(0x15c)]){let _0x379d17=_0x344881['config'][_0xc1cc87(0x15c)];if(typeof _0x379d17===_0xc1cc87(0x19c))try{_0x379d17=JSON[_0xc1cc87(0x154)](_0x379d17);}catch(_0x26ad70){}if(_0x379d17&&_0x379d17[_0x41793a])return _0x379d17[_0x41793a];}if(_0x4ad932===_0xc1cc87(0x16f)&&_0x344881[_0xc1cc87(0x124)]['valveMapping']){let _0x5dca14=_0x344881[_0xc1cc87(0x124)][_0xc1cc87(0x1c7)];if(typeof _0x5dca14===_0xc1cc87(0x19c))try{_0x5dca14=JSON[_0xc1cc87(0x154)](_0x5dca14);}catch(_0x37635b){}if(_0x5dca14&&_0x5dca14[_0x41793a])return _0x5dca14[_0x41793a];}let _0x1eb361=[];if(_0x4ad932===_0xc1cc87(0x16c))_0x1eb361=[{'s':'.1.ACTUAL_TEMPERATURE','t':_0xc1cc87(0x1cf)},{'s':_0xc1cc87(0x140),'t':_0xc1cc87(0x1cf)},{'s':_0xc1cc87(0x140),'t':_0xc1cc87(0x136)},{'s':_0xc1cc87(0x13a),'t':_0xc1cc87(0x182)},{'s':_0xc1cc87(0x1a2),'t':_0xc1cc87(0x1c8)},{'s':_0xc1cc87(0x1a2),'t':_0xc1cc87(0x175)},{'s':'temperature','t':'target_temperature'},{'s':_0xc1cc87(0x1d6),'t':'SET'},{'s':_0xc1cc87(0x1bf),'t':_0xc1cc87(0x1b9)},{'s':_0xc1cc87(0x1d3),'t':_0xc1cc87(0x16c)}];else _0x4ad932==='valve'&&(_0x1eb361=[{'s':'.1.ACTUAL_TEMPERATURE','t':'.1.LEVEL'},{'s':_0xc1cc87(0x140),'t':_0xc1cc87(0x1a1)},{'s':'.1.TEMPERATURE','t':_0xc1cc87(0x14e)},{'s':'local_temperature','t':_0xc1cc87(0x15a)},{'s':_0xc1cc87(0x1d3),'t':_0xc1cc87(0x143)},{'s':'temperature','t':_0xc1cc87(0x145)}]);for(const _0x1d0c3a of _0x1eb361){if(_0x41793a['includes'](_0x1d0c3a['s'])){const _0x52cceb=_0x41793a[_0xc1cc87(0x1c4)](_0x1d0c3a['s'],_0x1d0c3a['t']),_0xc19812=await _0x344881[_0xc1cc87(0x190)](_0x52cceb);if(_0xc19812)return _0x52cceb;}}try{const _0x2e534c=_0x41793a['split']('.');if(_0x2e534c['length']>0x2){const _0x2da00d=_0x2e534c[_0xc1cc87(0x1c2)](0x0,-0x1)['join']('.'),_0x26cf4f=await _0x344881[_0xc1cc87(0x19b)](_0x2da00d+'.*'),_0x5d72d8=[],_0x31806d=_0x41793a[_0xc1cc87(0x18b)](/[._]+/)['filter'](_0x938743=>!['openknx','0',_0xc1cc87(0x150),'ist','wert',_0xc1cc87(0x1d3),'actual',_0xc1cc87(0x1d7),_0xc1cc87(0x180),_0xc1cc87(0x1da)][_0xc1cc87(0x1ab)](_0x938743[_0xc1cc87(0x142)]()));for(const [_0x209bed,_0x39a5ee]of Object[_0xc1cc87(0x1b8)](_0x26cf4f)){if(_0x209bed===_0x41793a)continue;if(_0x39a5ee&&_0x39a5ee['common']){const _0x5c8cee=_0x209bed[_0xc1cc87(0x142)](),_0x4c43a3=(_0x39a5ee['common']['role']||'')[_0xc1cc87(0x142)](),_0xbb228f=(_0x39a5ee['common']['unit']||'')['toLowerCase']();let _0x1610b3=![];if(_0x4ad932===_0xc1cc87(0x16c)&&_0x39a5ee[_0xc1cc87(0x179)][_0xc1cc87(0x1a4)]===!![])_0x1610b3=_0x5c8cee[_0xc1cc87(0x1ab)](_0xc1cc87(0x169))||_0x5c8cee[_0xc1cc87(0x1ab)](_0xc1cc87(0x1dc))||_0x5c8cee[_0xc1cc87(0x1ab)](_0xc1cc87(0x194))||_0x4c43a3['includes']('level.temperature')||_0x4c43a3['includes'](_0xc1cc87(0x1de));else _0x4ad932===_0xc1cc87(0x16f)&&(_0x1610b3=_0x5c8cee['includes'](_0xc1cc87(0x145))||_0x5c8cee[_0xc1cc87(0x1ab)](_0xc1cc87(0x16f))||_0x5c8cee[_0xc1cc87(0x1ab)](_0xc1cc87(0x1af))||_0x5c8cee[_0xc1cc87(0x1ab)](_0xc1cc87(0x1b4))||_0x4c43a3[_0xc1cc87(0x1ab)](_0xc1cc87(0x196))||_0x4c43a3[_0xc1cc87(0x1ab)]('value.valve')||_0xbb228f[_0xc1cc87(0x1ab)]('%'));if(_0x1610b3){const _0x2e74ca=_0x209bed[_0xc1cc87(0x18b)](/[._]+/)['map'](_0x956289=>_0x956289[_0xc1cc87(0x142)]());let _0x281043=0x0;_0x31806d[_0xc1cc87(0x15d)](_0x46be90=>{const _0x504fc4=_0xc1cc87;if(_0x2e74ca['includes'](_0x46be90[_0x504fc4(0x142)]()))_0x281043++;}),_0x5d72d8[_0xc1cc87(0x19d)]({'id':_0x209bed,'score':_0x281043});}}}if(_0x5d72d8[_0xc1cc87(0x15b)]>0x0){_0x5d72d8[_0xc1cc87(0x14d)]((_0x250f58,_0x2a679a)=>_0x2a679a['score']-_0x250f58['score']);if(_0x5d72d8[0x0][_0xc1cc87(0x185)]>0x0)return _0x5d72d8[0x0]['id'];}}}catch(_0x510851){}return null;}async function scanThermostats(_0x18ab20){const _0x15d32d=a1_0x2f7943,_0x42d593=_0x18ab20[_0x15d32d(0x124)][_0x15d32d(0x189)]||[],_0x2046c6=[],_0x3b612c=_0x42d593['filter'](_0x1fc362=>_0x1fc362['id']&&_0x1fc362['id'][_0x15d32d(0x1ab)](_0x15d32d(0x1d3))||_0x1fc362[_0x15d32d(0x17d)]&&[_0x15d32d(0x1d3),'thermostat',_0x15d32d(0x1d7)][_0x15d32d(0x1ab)](_0x1fc362[_0x15d32d(0x17d)])||_0x1fc362[_0x15d32d(0x17c)]&&_0x1fc362['name'][_0x15d32d(0x142)]()[_0x15d32d(0x1ab)]('temp'));for(const _0x2aad1f of _0x3b612c){const _0xbc6eb=await findRelatedId(_0x18ab20,_0x2aad1f['id'],_0x15d32d(0x16c)),_0x48d90b=await findRelatedId(_0x18ab20,_0x2aad1f['id'],_0x15d32d(0x16f));let _0x591220=_0x15d32d(0x178),_0x2c2ace=![],_0x4228c9=_0x18ab20['config'][_0x15d32d(0x15c)]||{};if(typeof _0x4228c9===_0x15d32d(0x19c))try{_0x4228c9=JSON['parse'](_0x4228c9);}catch(_0x5f481c){}let _0x36b7cb=_0x18ab20[_0x15d32d(0x124)]['valveMapping']||{};if(typeof _0x36b7cb===_0x15d32d(0x19c))try{_0x36b7cb=JSON[_0x15d32d(0x154)](_0x36b7cb);}catch(_0x2d73ec){}if(_0x4228c9[_0x2aad1f['id']]&&_0x4228c9[_0x2aad1f['id']]===_0xbc6eb||_0x36b7cb[_0x2aad1f['id']]&&_0x36b7cb[_0x2aad1f['id']]===_0x48d90b)_0x591220=_0x15d32d(0x16d),_0x2c2ace=!![];else(_0xbc6eb||_0x48d90b)&&(_0x591220='Auto-Erkennung');_0x2046c6[_0x15d32d(0x19d)]({'room':_0x2aad1f[_0x15d32d(0x14b)]||_0x15d32d(0x1e5),'sensorId':_0x2aad1f['id'],'setpointId':_0xbc6eb||'-','valveId':_0x48d90b||'-','source':_0x591220,'isManual':_0x2c2ace,'status':_0xbc6eb&&_0x48d90b?_0x15d32d(0x147):_0xbc6eb?'OK':_0x15d32d(0x184)});}return _0x2046c6[_0x15d32d(0x14d)]((_0x164ce5,_0x3e792b)=>_0x164ce5[_0x15d32d(0x1eb)][_0x15d32d(0x193)](_0x3e792b[_0x15d32d(0x1eb)]));}async function updateSchedulePreview(_0x2862f2){const _0x3a6bbb=a1_0x2f7943;if(!_0x2862f2[_0x3a6bbb(0x124)][_0x3a6bbb(0x187)]||!_0x2862f2['config'][_0x3a6bbb(0x160)])return;let _0x16caa2={};try{const _0x478dcc=await _0x2862f2[_0x3a6bbb(0x1db)]('analysis.energy.warmupTimes');if(_0x478dcc&&_0x478dcc[_0x3a6bbb(0x1ad)])_0x16caa2=JSON[_0x3a6bbb(0x154)](_0x478dcc[_0x3a6bbb(0x1ad)]);}catch(_0x1ce432){}const _0x5979a6=[],_0x3ca32a=Date['now'](),_0x10a689=0x30*0x3c*0x3c*0x3e8;try{const _0x568198=await _0x2862f2[_0x3a6bbb(0x1be)](_0x2862f2[_0x3a6bbb(0x124)][_0x3a6bbb(0x160)]+_0x3a6bbb(0x171));if(!_0x568198||!_0x568198['val'])return;const _0x30e43f=JSON[_0x3a6bbb(0x154)](_0x568198[_0x3a6bbb(0x1ad)]),_0x2a4856=_0x2862f2[_0x3a6bbb(0x124)][_0x3a6bbb(0x1e8)]||[],_0x5dce34=_0x2862f2[_0x3a6bbb(0x124)][_0x3a6bbb(0x189)]||[],_0x4b3127=new Set();_0x5dce34[_0x3a6bbb(0x15d)](_0x3bf276=>{const _0xbd80ed=_0x3a6bbb;if(_0x3bf276[_0xbd80ed(0x14b)])_0x4b3127[_0xbd80ed(0x192)](_0x3bf276['location']);});for(const _0x316550 of _0x30e43f){if(_0x316550[_0x3a6bbb(0x138)]&&_0x2a4856[_0x3a6bbb(0x15b)]>0x0&&!_0x2a4856[_0x3a6bbb(0x1ab)](_0x316550[_0x3a6bbb(0x138)]))continue;const _0x353177=_0x316550[_0x3a6bbb(0x151)]||_0x316550['eventStart']||_0x316550['date'];if(!_0x353177)continue;const _0x4e2db4=new Date(_0x353177),_0x36638d=_0x4e2db4[_0x3a6bbb(0x135)]();if(isNaN(_0x36638d))continue;if(_0x36638d<_0x3ca32a)continue;if(_0x36638d>_0x3ca32a+_0x10a689)continue;const _0x2a500f=(_0x316550[_0x3a6bbb(0x1a9)]||_0x316550[_0x3a6bbb(0x122)]||'')['toLowerCase']();let _0x23581c=![],_0x39a806=[],_0x15e9f3=_0x316550[_0x3a6bbb(0x1a9)]||_0x316550['summary']||_0x3a6bbb(0x1e5);if(_0x2a500f[_0x3a6bbb(0x1ab)](_0x3a6bbb(0x149))||_0x2a500f[_0x3a6bbb(0x1ab)](_0x3a6bbb(0x152))||_0x2a500f['includes']('ankunft'))_0x23581c=!![],_0x39a806=Array[_0x3a6bbb(0x12d)](_0x4b3127);else for(const _0x1e621a of _0x4b3127){if(_0x2a500f['includes'](_0x1e621a[_0x3a6bbb(0x142)]()))_0x39a806['push'](_0x1e621a);}_0x39a806['length']>0x0&&_0x39a806['forEach'](_0x486267=>{const _0x46cfab=_0x3a6bbb;let _0x57a203=0x3c;if(_0x23581c){let _0x2b99ea=0x0;Object[_0x46cfab(0x137)](_0x16caa2)['forEach'](_0x401dc4=>{if(_0x401dc4>_0x2b99ea)_0x2b99ea=_0x401dc4;}),_0x57a203=_0x2b99ea>0x0?_0x2b99ea:0x78;}else _0x57a203=getWarmupRobust(_0x16caa2,_0x486267);const _0x3a000d=new Date(_0x36638d-_0x57a203*0xea60);_0x5979a6[_0x46cfab(0x19d)]({'eventTime':_0x36638d,'triggerTime':_0x3a000d[_0x46cfab(0x135)](),'room':_0x486267,'minutes':_0x57a203,'reason':_0x15e9f3,'isGlobal':_0x23581c});});}}catch(_0x563780){}_0x5979a6[_0x3a6bbb(0x14d)]((_0x5263ad,_0x356c9a)=>_0x5263ad[_0x3a6bbb(0x18a)]-_0x356c9a[_0x3a6bbb(0x18a)]);const _0x53043d=_0x5979a6['slice'](0x0,0x1e);await _0x2862f2[_0x3a6bbb(0x1e0)](_0x3a6bbb(0x166),{'val':JSON['stringify'](_0x53043d),'ack':!![]});}async function monitorEnforcements(_0x581479){const _0x5a749a=a1_0x2f7943;try{const _0x3f98d4=_0x5a749a(0x17e),_0x191894=await _0x581479[_0x5a749a(0x1db)](_0x3f98d4);if(!_0x191894||!_0x191894[_0x5a749a(0x1ad)])return;let _0x119f78=[];try{_0x119f78=JSON[_0x5a749a(0x154)](_0x191894[_0x5a749a(0x1ad)]);}catch(_0x3e65be){return;}if(!Array[_0x5a749a(0x1ac)](_0x119f78)||_0x119f78[_0x5a749a(0x15b)]===0x0)return;const _0x154bde=Date[_0x5a749a(0x1d8)](),_0x1007c2=_0x581479[_0x5a749a(0x124)][_0x5a749a(0x189)]||[];let _0x516cce=![];for(let _0x4e9e29=_0x119f78[_0x5a749a(0x15b)]-0x1;_0x4e9e29>=0x0;_0x4e9e29--){const _0x240df7=_0x119f78[_0x4e9e29];if(_0x154bde>=_0x240df7['until']){_0x581479[_0x5a749a(0x1ea)][_0x5a749a(0x134)](_0x5a749a(0x197)+_0x240df7['room']+_0x5a749a(0x19f)),_0x119f78['splice'](_0x4e9e29,0x1),_0x516cce=!![];continue;}const _0x4b650e=_0x1007c2[_0x5a749a(0x13e)](_0x5dfade=>normalize(_0x5dfade[_0x5a749a(0x14b)])===normalize(_0x240df7[_0x5a749a(0x1eb)])&&(_0x5dfade[_0x5a749a(0x17d)]===_0x5a749a(0x1d3)||_0x5dfade[_0x5a749a(0x17d)]===_0x5a749a(0x13d)));if(_0x4b650e){const _0x3ce35e=await findRelatedId(_0x581479,_0x4b650e['id'],_0x5a749a(0x16c));if(_0x3ce35e){const _0xdb10ba=await _0x581479[_0x5a749a(0x1be)](_0x3ce35e);_0xdb10ba&&typeof _0xdb10ba[_0x5a749a(0x1ad)]==='number'&&(_0xdb10ba['val']<0xf&&(_0x581479[_0x5a749a(0x1ea)][_0x5a749a(0x146)](_0x5a749a(0x1d4)+_0x240df7[_0x5a749a(0x1eb)]+_0x5a749a(0x148)+_0xdb10ba[_0x5a749a(0x1ad)]+_0x5a749a(0x15f)+_0x240df7[_0x5a749a(0x194)]+_0x5a749a(0x159)),await _0x581479[_0x5a749a(0x12a)](_0x3ce35e,_0x240df7[_0x5a749a(0x194)]),await logAutomationAction(_0x581479,_0x5a749a(0x1b5)+_0x240df7[_0x5a749a(0x1eb)]+':\x20'+_0xdb10ba['val']+_0x5a749a(0x130)+_0x240df7[_0x5a749a(0x194)]+_0x5a749a(0x14c))));}}}_0x516cce&&await _0x581479['setStateAsync'](_0x3f98d4,{'val':JSON[_0x5a749a(0x1b6)](_0x119f78),'ack':!![]});}catch(_0x8105bd){_0x581479[_0x5a749a(0x1ea)][_0x5a749a(0x16a)](_0x5a749a(0x18d)+_0x8105bd[_0x5a749a(0x1cd)]);}}async function checkCalendarTriggers(_0x2f8d31){const _0x27c3ab=a1_0x2f7943;if(!_0x2f8d31[_0x27c3ab(0x124)][_0x27c3ab(0x187)]||!_0x2f8d31['config'][_0x27c3ab(0x160)])return;await updateSchedulePreview(_0x2f8d31);let _0x21305d={},_0x49fd32={};try{const _0x5ccc06=await _0x2f8d31[_0x27c3ab(0x1db)](_0x27c3ab(0x13b));if(_0x5ccc06&&_0x5ccc06[_0x27c3ab(0x1ad)])_0x21305d=JSON[_0x27c3ab(0x154)](_0x5ccc06[_0x27c3ab(0x1ad)]);const _0xf0c865=await _0x2f8d31['getStateAsync'](_0x27c3ab(0x1ca));if(_0xf0c865&&_0xf0c865[_0x27c3ab(0x1ad)])_0x49fd32=JSON[_0x27c3ab(0x154)](_0xf0c865[_0x27c3ab(0x1ad)]);}catch(_0xddd811){}let _0x51a272={'default':0x15};try{const _0x4e5ca6=await _0x2f8d31[_0x27c3ab(0x1db)](_0x27c3ab(0x1aa));if(_0x4e5ca6&&_0x4e5ca6[_0x27c3ab(0x1ad)])_0x51a272=JSON[_0x27c3ab(0x154)](_0x4e5ca6['val']);}catch(_0x424477){}let _0x412130=[];try{const _0x4d41f7=await _0x2f8d31[_0x27c3ab(0x1db)](_0x27c3ab(0x17e));if(_0x4d41f7&&_0x4d41f7[_0x27c3ab(0x1ad)])_0x412130=JSON[_0x27c3ab(0x154)](_0x4d41f7['val']);}catch(_0x433fc5){}try{const _0x2a1ce1=await _0x2f8d31[_0x27c3ab(0x1be)](_0x2f8d31[_0x27c3ab(0x124)]['calendarInstance']+_0x27c3ab(0x171));if(!_0x2a1ce1||!_0x2a1ce1[_0x27c3ab(0x1ad)])return;const _0xc4dece=JSON[_0x27c3ab(0x154)](_0x2a1ce1[_0x27c3ab(0x1ad)]),_0x328845=Date[_0x27c3ab(0x1d8)](),_0x2b2c49=_0x2f8d31[_0x27c3ab(0x124)]['devices']||[],_0x2a15fd=_0x2f8d31[_0x27c3ab(0x124)][_0x27c3ab(0x1e8)]||[];let _0x233c16=![];for(const _0x2ee46b of _0xc4dece){if(_0x2ee46b[_0x27c3ab(0x138)]&&_0x2a15fd[_0x27c3ab(0x15b)]>0x0&&!_0x2a15fd['includes'](_0x2ee46b[_0x27c3ab(0x138)]))continue;const _0x5005f2=_0x2ee46b[_0x27c3ab(0x151)]||_0x2ee46b[_0x27c3ab(0x156)]||_0x2ee46b[_0x27c3ab(0x12f)];if(!_0x5005f2)continue;const _0x3d6a8a=new Date(_0x5005f2);if(isNaN(_0x3d6a8a['getTime']()))continue;const _0x34c6be=(_0x2ee46b[_0x27c3ab(0x1a9)]||_0x2ee46b[_0x27c3ab(0x122)]||'')[_0x27c3ab(0x142)]();if(_0x34c6be[_0x27c3ab(0x1ab)](_0x27c3ab(0x149))||_0x34c6be[_0x27c3ab(0x1ab)](_0x27c3ab(0x152))||_0x34c6be[_0x27c3ab(0x1ab)]('ankunft')){let _0x272bd7=0x0;Object['values'](_0x21305d)[_0x27c3ab(0x15d)](_0x53da50=>{if(_0x53da50>_0x272bd7)_0x272bd7=_0x53da50;});if(_0x272bd7===0x0)_0x272bd7=0x78;const _0x1884c9=_0x3d6a8a[_0x27c3ab(0x135)]()-_0x272bd7*0xea60;_0x328845>=_0x1884c9&&_0x328845<_0x3d6a8a[_0x27c3ab(0x135)]()&&(_0x2f8d31[_0x27c3ab(0x1c0)]!==_0x27c3ab(0x141)&&(_0x2f8d31[_0x27c3ab(0x1ea)][_0x27c3ab(0x134)](_0x27c3ab(0x12c)+_0x272bd7+'\x20min).'),await _0x2f8d31[_0x27c3ab(0x1e0)](_0x27c3ab(0x18c),{'val':_0x27c3ab(0x141),'ack':![]})));}for(const _0x3772a2 of _0x2b2c49){if(_0x3772a2[_0x27c3ab(0x14b)]){const _0x363eec=_0x3772a2[_0x27c3ab(0x14b)][_0x27c3ab(0x142)](),_0x316f8d=(_0x3772a2[_0x27c3ab(0x17c)]||'')[_0x27c3ab(0x142)]();let _0x52959b=_0x34c6be[_0x27c3ab(0x1ab)](_0x363eec);!_0x52959b&&_0x316f8d[_0x27c3ab(0x15b)]>0x3&&_0x34c6be[_0x27c3ab(0x1ab)](_0x316f8d)&&(_0x52959b=!![]);if(_0x52959b){const _0x22ce48=getWarmupRobust(_0x21305d,_0x3772a2[_0x27c3ab(0x14b)]),_0x148ed7=_0x49fd32[_0x3772a2[_0x27c3ab(0x14b)]]||_0x27c3ab(0x155),_0x37d80b=_0x3d6a8a['getTime']()-_0x22ce48*0xea60;if(_0x328845>=_0x37d80b&&_0x328845<_0x3d6a8a[_0x27c3ab(0x135)]()){const _0x12301e=lastActions[_0x27c3ab(0x191)+_0x3772a2[_0x27c3ab(0x14b)]];if(_0x12301e&&_0x328845-_0x12301e<CAL_COOLDOWN_MS)continue;const _0xcb407e=await findRelatedId(_0x2f8d31,_0x3772a2['id'],'setpoint');if(_0xcb407e){let _0x269df6=_0x51a272[_0x3772a2['location']];if(_0x269df6===undefined)_0x269df6=_0x51a272[_0x27c3ab(0x165)];if(_0x269df6===undefined)_0x269df6=0x15;const _0x732f27=await _0x2f8d31['getForeignStateAsync'](_0xcb407e);if(_0x732f27&&typeof _0x732f27[_0x27c3ab(0x1ad)]===_0x27c3ab(0x1ae)&&_0x732f27[_0x27c3ab(0x1ad)]<_0x269df6-0.5){_0x2f8d31['log'][_0x27c3ab(0x134)](_0x27c3ab(0x173)+_0x148ed7+_0x27c3ab(0x1c9)+_0x3772a2[_0x27c3ab(0x14b)]+_0x27c3ab(0x1a6)+_0x34c6be+_0x27c3ab(0x162)+_0x269df6+_0x27c3ab(0x123)+_0x22ce48+'\x20min).'),await _0x2f8d31[_0x27c3ab(0x12a)](_0xcb407e,_0x269df6),await logAutomationAction(_0x2f8d31,_0x27c3ab(0x183)+_0x3772a2['location']+_0x27c3ab(0x1b2)+_0x269df6+_0x27c3ab(0x181)+_0x148ed7+')'),lastActions[_0x27c3ab(0x191)+_0x3772a2['location']]=_0x328845;const _0x307a9f=_0x412130[_0x27c3ab(0x17a)](_0x5a27b2=>_0x5a27b2[_0x27c3ab(0x1eb)]===_0x3772a2['location']);if(_0x307a9f!==-0x1)_0x412130[_0x27c3ab(0x174)](_0x307a9f,0x1);_0x412130[_0x27c3ab(0x19d)]({'room':_0x3772a2[_0x27c3ab(0x14b)],'target':_0x269df6,'until':_0x3d6a8a['getTime']()}),_0x233c16=!![];}}}}}}}_0x233c16&&await _0x2f8d31[_0x27c3ab(0x1e0)](_0x27c3ab(0x17e),{'val':JSON['stringify'](_0x412130),'ack':!![]});}catch(_0x265e46){_0x2f8d31[_0x27c3ab(0x1ea)][_0x27c3ab(0x146)]('Calendar\x20Check\x20Error:\x20'+_0x265e46[_0x27c3ab(0x1cd)]);}}async function manageMpcIntervention(_0x2866ab,_0x42e547,_0x38a4ce){const _0x406124=a1_0x2f7943;try{const _0x1cf000=_0x406124(0x1e1),_0x54b792=await _0x2866ab[_0x406124(0x1db)](_0x1cf000);let _0x550922=[];if(_0x54b792&&_0x54b792['val'])try{_0x550922=JSON[_0x406124(0x154)](_0x54b792['val']);}catch(_0x203d7a){}const _0xeca54a=_0x550922['indexOf'](_0x42e547);if(_0x38a4ce===_0x406124(0x192))_0xeca54a===-0x1&&(_0x550922['push'](_0x42e547),await _0x2866ab[_0x406124(0x1e0)](_0x1cf000,{'val':JSON['stringify'](_0x550922),'ack':!![]}));else _0x38a4ce==='remove'&&(_0xeca54a!==-0x1&&(_0x550922[_0x406124(0x174)](_0xeca54a,0x1),await _0x2866ab[_0x406124(0x1e0)](_0x1cf000,{'val':JSON[_0x406124(0x1b6)](_0x550922),'ack':!![]})));}catch(_0x27b2cb){}}function a1_0x247e(_0x1abf69,_0x5106ef){const _0x1a01c7=a1_0x1c73();return a1_0x247e=function(_0x35396c,_0x103c10){_0x35396c=_0x35396c-0x122;let _0x1c73c1=_0x1a01c7[_0x35396c];return _0x1c73c1;},a1_0x247e(_0x1abf69,_0x5106ef);}async function cleanupGhostInterventions(_0x9fa4a2){const _0x13cbfa=a1_0x2f7943;try{const _0x3f6187=_0x13cbfa(0x1e1),_0x3a3464=await _0x9fa4a2[_0x13cbfa(0x1db)](_0x3f6187);if(!_0x3a3464||!_0x3a3464['val'])return;const _0x54c5fc=JSON[_0x13cbfa(0x154)](_0x3a3464['val']);if(!Array['isArray'](_0x54c5fc)||_0x54c5fc[_0x13cbfa(0x15b)]===0x0)return;let _0x3bfaaf={'default':0x15};try{const _0x2a6efc=await _0x9fa4a2[_0x13cbfa(0x1db)](_0x13cbfa(0x1aa));if(_0x2a6efc&&_0x2a6efc[_0x13cbfa(0x1ad)])_0x3bfaaf=JSON[_0x13cbfa(0x154)](_0x2a6efc[_0x13cbfa(0x1ad)]);}catch(_0x42199e){}let _0x119150=[];try{const _0x44a4bf=await _0x9fa4a2[_0x13cbfa(0x1db)](_0x13cbfa(0x1ba));if(_0x44a4bf&&_0x44a4bf[_0x13cbfa(0x1ad)])_0x119150=JSON[_0x13cbfa(0x154)](_0x44a4bf['val']);}catch(_0x2cd4d2){}let _0x4f0268={},_0x5010b6=![];try{const _0x5197dc=await _0x9fa4a2['getStateAsync'](_0x13cbfa(0x1e7));if(_0x5197dc&&_0x5197dc[_0x13cbfa(0x1ad)])_0x4f0268=JSON[_0x13cbfa(0x154)](_0x5197dc[_0x13cbfa(0x1ad)]);}catch(_0x5544c8){}if(_0x4f0268[_0x13cbfa(0x1bd)]){const _0x4544d1=Date[_0x13cbfa(0x1d8)]();for(const [_0x4ccde7,_0x27aa6f]of Object['entries'](_0x4f0268[_0x13cbfa(0x1bd)])){_0x4544d1-_0x27aa6f>PENALTY_TTL&&(delete _0x4f0268[_0x4ccde7],delete _0x4f0268[_0x13cbfa(0x1bd)][_0x4ccde7],_0x5010b6=!![],_0x9fa4a2[_0x13cbfa(0x1ea)][_0x13cbfa(0x134)](_0x13cbfa(0x1e6)+_0x4ccde7+'\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.'));}}const _0x3e7b90=_0x9fa4a2['config'][_0x13cbfa(0x189)]||[];let _0x24aae5=![];for(let _0x4a2ccd=_0x54c5fc['length']-0x1;_0x4a2ccd>=0x0;_0x4a2ccd--){const _0x321485=_0x54c5fc[_0x4a2ccd],_0x654c2a=_0x3e7b90['find'](_0x2c5dbb=>normalize(_0x2c5dbb[_0x13cbfa(0x14b)])===normalize(_0x321485)&&(_0x2c5dbb[_0x13cbfa(0x17d)]==='temperature'||_0x2c5dbb['type']===_0x13cbfa(0x13d)));if(!_0x654c2a){_0x9fa4a2['log'][_0x13cbfa(0x146)](_0x13cbfa(0x1c1)+_0x321485+_0x13cbfa(0x1a5)),_0x54c5fc[_0x13cbfa(0x174)](_0x4a2ccd,0x1),_0x24aae5=!![];continue;}if(_0x654c2a){const _0x3fe246=await findRelatedId(_0x9fa4a2,_0x654c2a['id'],_0x13cbfa(0x16c)),_0x3bbf8a=await _0x9fa4a2[_0x13cbfa(0x1be)](_0x654c2a['id']);if(_0x3fe246){const _0x127816=await _0x9fa4a2[_0x13cbfa(0x1be)](_0x3fe246);if(_0x127816&&typeof _0x127816[_0x13cbfa(0x1ad)]===_0x13cbfa(0x1ae)){let _0x8756c2=![],_0x25fa4a='';Math[_0x13cbfa(0x126)](_0x127816['val']-ECO_TEMP)>0.5&&(_0x8756c2=!![],_0x25fa4a=_0x13cbfa(0x127));if(!_0x8756c2&&_0x3bbf8a&&typeof _0x3bbf8a[_0x13cbfa(0x1ad)]===_0x13cbfa(0x1ae)){const _0x1d87ed=_0x3bfaaf[_0x321485]||_0x3bfaaf[_0x13cbfa(0x165)]||0x15;_0x3bbf8a[_0x13cbfa(0x1ad)]<_0x1d87ed+0.2&&(_0x8756c2=!![],_0x25fa4a='too_cold');}if(_0x8756c2){if(_0x25fa4a==='manual'){_0x9fa4a2['log'][_0x13cbfa(0x134)]('ðŸ§¹\x20[MPC\x20CLEANUP]\x20'+_0x321485+_0x13cbfa(0x19a)+_0x127816[_0x13cbfa(0x1ad)]+_0x13cbfa(0x167)+ECO_TEMP+_0x13cbfa(0x177));const _0x281f15=lastActions[_0x13cbfa(0x191)+_0x321485],_0x51789a=_0x281f15&&Date['now']()-_0x281f15<0x2*0x3c*0x3e8;if(!_0x51789a&&_0x127816['val']>ECO_TEMP+0.5){_0x9fa4a2[_0x13cbfa(0x1df)]&&(_0x9fa4a2[_0x13cbfa(0x1ea)][_0x13cbfa(0x134)](_0x13cbfa(0x186)+_0x321485+_0x13cbfa(0x1e2)),_0x9fa4a2['sendToPythonWrapper']('TRAIN_RL_PENALTY',{'room':_0x321485}));const _0x545ad4=_0x321485+'_'+new Date()[_0x13cbfa(0x125)]();if(!_0x4f0268[_0x545ad4]){_0x4f0268[_0x545ad4]=0x1;if(!_0x4f0268[_0x13cbfa(0x1bd)])_0x4f0268['_meta']={};_0x4f0268[_0x13cbfa(0x1bd)][_0x545ad4]=Date[_0x13cbfa(0x1d8)](),_0x5010b6=!![];}}else _0x51789a&&_0x9fa4a2['log'][_0x13cbfa(0x134)]('ðŸ“…\x20[MPC\x20INFO]\x20'+_0x321485+_0x13cbfa(0x18f));}else{if(_0x25fa4a===_0x13cbfa(0x16e)){let _0x5c6ff7=![];if(_0x119150[_0x13cbfa(0x13e)](_0x247a60=>_0x247a60[_0x13cbfa(0x1eb)]===_0x321485))_0x5c6ff7=!![];const _0x3cec09=_0x3e7b90[_0x13cbfa(0x1dd)](_0xe1fc6e=>normalize(_0xe1fc6e[_0x13cbfa(0x14b)])===normalize(_0x321485)&&(_0xe1fc6e['type']===_0x13cbfa(0x15e)||_0xe1fc6e[_0x13cbfa(0x17d)]==='sensor'||_0xe1fc6e[_0x13cbfa(0x17d)]===_0x13cbfa(0x13f)));for(const _0x2e22dc of _0x3cec09){try{const _0x1b45cb=await _0x9fa4a2[_0x13cbfa(0x1be)](_0x2e22dc['id']);if(_0x1b45cb&&(_0x1b45cb['val']===!![]||_0x1b45cb[_0x13cbfa(0x1ad)]===0x1||String(_0x1b45cb[_0x13cbfa(0x1ad)])['toLowerCase']()===_0x13cbfa(0x18e)))_0x5c6ff7=!![];}catch(_0x28dd71){}}if(_0x5c6ff7)_0x9fa4a2[_0x13cbfa(0x1ea)][_0x13cbfa(0x134)](_0x13cbfa(0x195)+_0x321485+_0x13cbfa(0x12e));else{const _0x2c0d45=_0x3bfaaf[_0x321485]||_0x3bfaaf[_0x13cbfa(0x165)]||0x15;_0x9fa4a2[_0x13cbfa(0x1ea)][_0x13cbfa(0x134)](_0x13cbfa(0x1b1)+_0x321485+_0x13cbfa(0x1c5)+_0x3bbf8a['val']+_0x13cbfa(0x144)+(_0x2c0d45+0.2)+_0x13cbfa(0x1cb)),await _0x9fa4a2[_0x13cbfa(0x12a)](_0x3fe246,_0x2c0d45),await logAutomationAction(_0x9fa4a2,_0x13cbfa(0x1e9)+_0x321485+_0x13cbfa(0x1c6)+_0x2c0d45+'Â°C'),lastActions[_0x13cbfa(0x16b)+_0x321485]=Date[_0x13cbfa(0x1d8)]();}}}_0x54c5fc[_0x13cbfa(0x174)](_0x4a2ccd,0x1),_0x24aae5=!![];}}}}}_0x24aae5&&await _0x9fa4a2[_0x13cbfa(0x1e0)](_0x3f6187,{'val':JSON[_0x13cbfa(0x1b6)](_0x54c5fc),'ack':!![]}),_0x5010b6&&await _0x9fa4a2[_0x13cbfa(0x1e0)](_0x13cbfa(0x1e7),{'val':JSON[_0x13cbfa(0x1b6)](_0x4f0268),'ack':!![]});}catch(_0x2cc7e9){}}async function applyEnergySavings(_0x2d1f05,_0x513c0b){const _0x349d3f=a1_0x2f7943;await cleanupGhostInterventions(_0x2d1f05);if(!_0x513c0b||_0x513c0b[_0x349d3f(0x15b)]===0x0)return;const _0x3677d7=_0x2d1f05['config']['devices']||[],_0x58f1b6=Date['now']();for(const _0x4f2a17 of _0x513c0b){const _0x5101c3=_0x4f2a17['room'],_0x3346ab=_0x4f2a17[_0x349d3f(0x1d2)],_0x18bb5b=_0x4f2a17[_0x349d3f(0x194)]||0x15;if(lastActions[_0x349d3f(0x16b)+_0x5101c3]&&_0x58f1b6-lastActions[_0x349d3f(0x16b)+_0x5101c3]<RESCUE_LOCK_MS)continue;const _0x460206=_0x3677d7['find'](_0x5c2de7=>normalize(_0x5c2de7[_0x349d3f(0x14b)])===normalize(_0x5101c3)&&(_0x5c2de7[_0x349d3f(0x17d)]===_0x349d3f(0x1d3)||_0x5c2de7[_0x349d3f(0x17d)]===_0x349d3f(0x13d)));if(!_0x460206)continue;const _0xe24bff=await findRelatedId(_0x2d1f05,_0x460206['id'],'setpoint');if(_0xe24bff){if(lastActions[_0x349d3f(0x1e3)+_0x5101c3]&&_0x58f1b6-lastActions['mpc_'+_0x5101c3]<0x1e*0x3c*0x3e8)continue;const _0x1de18a=await _0x2d1f05['getForeignStateAsync'](_0xe24bff);if(_0x1de18a&&typeof _0x1de18a[_0x349d3f(0x1ad)]===_0x349d3f(0x1ae)){const _0x21b9bb=_0x1de18a['val'];_0x21b9bb!==ECO_TEMP&&await manageMpcIntervention(_0x2d1f05,_0x5101c3,_0x349d3f(0x163));if(_0x3346ab>0x1e)_0x21b9bb>ECO_TEMP+0.5&&(_0x2d1f05[_0x349d3f(0x1ea)][_0x349d3f(0x134)](_0x349d3f(0x176)+_0x5101c3+_0x349d3f(0x148)+ECO_TEMP+_0x349d3f(0x198)+_0x3346ab+_0x349d3f(0x1bb)),await _0x2d1f05[_0x349d3f(0x12a)](_0xe24bff,ECO_TEMP),await manageMpcIntervention(_0x2d1f05,_0x5101c3,'add'),lastActions[_0x349d3f(0x1e3)+_0x5101c3]=_0x58f1b6,await logAutomationAction(_0x2d1f05,_0x349d3f(0x1d0)+_0x5101c3+_0x349d3f(0x1bc)+ECO_TEMP+'Â°C'));else _0x3346ab<=0xf&&(_0x21b9bb<_0x18bb5b&&(_0x2d1f05[_0x349d3f(0x1ea)][_0x349d3f(0x134)](_0x349d3f(0x199)+_0x5101c3+_0x349d3f(0x12b)+_0x18bb5b+'Â°C!\x20(Puffer\x20leer).'),await _0x2d1f05[_0x349d3f(0x12a)](_0xe24bff,_0x18bb5b),await manageMpcIntervention(_0x2d1f05,_0x5101c3,_0x349d3f(0x163)),lastActions[_0x349d3f(0x1e3)+_0x5101c3]=_0x58f1b6,await logAutomationAction(_0x2d1f05,_0x349d3f(0x1d0)+_0x5101c3+_0x349d3f(0x14f)+_0x18bb5b+'Â°C')));}}else _0x2d1f05[_0x349d3f(0x1ea)][_0x349d3f(0x146)](_0x349d3f(0x161)+_0x5101c3+_0x349d3f(0x1ce));}}module['exports']={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};