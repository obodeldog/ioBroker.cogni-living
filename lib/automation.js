const a1_0x20249a=a1_0x5384;(function(_0x20b759,_0x4804eb){const _0x563e3e=a1_0x5384,_0x48aec2=_0x20b759();while(!![]){try{const _0x81bd78=-parseInt(_0x563e3e(0x1a8))/0x1+-parseInt(_0x563e3e(0x1a5))/0x2+-parseInt(_0x563e3e(0x163))/0x3+-parseInt(_0x563e3e(0x139))/0x4+parseInt(_0x563e3e(0x1d5))/0x5+-parseInt(_0x563e3e(0x143))/0x6+parseInt(_0x563e3e(0x18e))/0x7;if(_0x81bd78===_0x4804eb)break;else _0x48aec2['push'](_0x48aec2['shift']());}catch(_0xe063de){_0x48aec2['push'](_0x48aec2['shift']());}}}(a1_0x30c6,0x6941f));const a1_0x420c29=(function(){let _0x363698=!![];return function(_0x2eacab,_0x49e762){const _0x5df9f9=_0x363698?function(){if(_0x49e762){const _0x24800d=_0x49e762['apply'](_0x2eacab,arguments);return _0x49e762=null,_0x24800d;}}:function(){};return _0x363698=![],_0x5df9f9;};}()),a1_0x4593ad=a1_0x420c29(this,function(){const _0x22abf0=a1_0x5384;return a1_0x4593ad[_0x22abf0(0x16c)]()[_0x22abf0(0x16f)](_0x22abf0(0x170))[_0x22abf0(0x16c)]()['constructor'](a1_0x4593ad)['search'](_0x22abf0(0x170));});a1_0x4593ad();'use strict';function a1_0x30c6(){const _0x1f4af=['Ist','wert','normal','location','.1.SET_POINT_TEMPERATURE','switch','thermostat','getHours','getTime','ðŸ§¹\x20[MPC\x20CLEANUP]\x20','level.valve','getForeignStateAsync',')\x20aktiv.\x20Heize\x20auf\x20','too_cold','analysis.energy.ventilationAlerts','length','stringify','splice','getStateAsync','ist','state','findIndex','replace','common','[FORCE]\x20','join','open','1353612PymCrO','isArray','openknx','sort','ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','role','event',']:\x20Raum-Trigger\x20\x27','temperature','.4.VALVE_STATE','271134NXmpwg','.1.TEMPERATURE','dimmer','position','.data.table','mpc_','warn','analysis.energy.activeEnforcements','reason','currentSystemMode','indexOf','ðŸ“…\x20SMART\x20SCHEDULE\x20[','Classic','Unknown','Â°C\x20(Kalender-Schutz)','ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20','trim','\x20min).','SET','useCalendar','\x20min)','analysis.energy.warmupTimes','local_temperature','valveMapping','\x20->\x20Schalte\x20','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20','_meta','Â°C).\x20Entferne\x20Status.','Â°C\x20(nicht\x20','ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27','analysis.energy.rlPenalties','1450533ljKiMr','set','ankunft','Calendar\x20Check\x20Error:\x20','unit','analysis.automation.lastAction','window','Â°C\x20(Vorlauf:\x20','ðŸ“…\x20[MPC\x20INFO]\x20','toString','getForeignObjectsAsync','values','search','(((.+)+)+)+$','Â°C!\x20(Puffer\x20leer).','ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','forEach','split','devices','value.valve','add','light','analysis.energy.warmupSources','urlaub\x20ende','rescue_','default','Auto-Erkennung','Enforcement\x20Monitor\x20Error:\x20','message','Â°C!\x20(Puffer:\x20','target_temperature','[MPC]\x20','\x20->\x20','calendarInstance','sendToPythonWrapper','ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20','rÃ¼ckkehr','abs','.1.LEVEL','map','parse','setpoint','exports','11729837pCqkJF','string',':\x20Absenkung\x20auf\x20','find','Soll','analysis.energy.warmupTargets','calendarSelection','PrÃ¤diktion:\x20','level','manual','remove','active','occupied_heating_setpoint','type','Unbekannt','entries','Â°C\x20<\x20','ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','ACTUAL_TEMPERATURE','includes','\x20auf\x20','eventStart','until','575864UvGOsM','_calName','getForeignObjectAsync','491062kDCDBI','filter','sensor','[CAL]\x20','room','TRAIN_RL_PENALTY','valve','analysis.automation.mode','setForeignStateAsync','score','name','SET_POINT_TEMPERATURE','cal_','setStateAsync','\x20wieder\x20auf\x20','actual','analysis.energy.mpcActiveInterventions','log','date','now','toLowerCase','approved','messwert','slice','\x27\x20(Match:\x20','triggerTime','info','hm-rpc','number','current_heating_setpoint','ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','Â°C).\x20Sparmodus\x20beendet!','.4.SET_TEMPERATURE','Fehlt','push','minutes_safe','toUpperCase','val','summary','target','thermostatMapping','_date','system.mode','Â°C\x20(via\x20',':\x20Aufheizen\x20auf\x20','2007705DBQkPT','config','.1.ACTUAL_TEMPERATURE'];a1_0x30c6=function(){return _0x1f4af;};return a1_0x30c6();}const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x30d653){const _0x429d0a=a1_0x5384;if(!_0x30d653)return'';return _0x30d653[_0x429d0a(0x1bc)]()[_0x429d0a(0x134)](/\s+/g,'')[_0x429d0a(0x153)]();}function getWarmupRobust(_0x58c2d6,_0x47bc4e){const _0x16ed1a=a1_0x5384;if(!_0x58c2d6||!_0x47bc4e)return 0x3c;if(_0x58c2d6[_0x47bc4e]!==undefined)return _0x58c2d6[_0x47bc4e];const _0x5fef2=_0x47bc4e[_0x16ed1a(0x1bc)]()[_0x16ed1a(0x134)](/Ã¤/g,'ae')['replace'](/Ã¶/g,'oe')[_0x16ed1a(0x134)](/Ã¼/g,'ue')['replace'](/ÃŸ/g,'ss')[_0x16ed1a(0x134)](/\s+/g,'_')[_0x16ed1a(0x134)](/[^a-z0-9_]/g,'');if(_0x58c2d6[_0x5fef2]!==undefined)return _0x58c2d6[_0x5fef2];return 0x3c;}async function logAutomationAction(_0x2eeec5,_0x5270de){const _0x415f57=a1_0x5384;await _0x2eeec5[_0x415f57(0x1b5)](_0x415f57(0x168),{'val':_0x5270de,'ack':!![]});try{const _0x5571d9='analysis.automation.actionLog',_0x4121cc=await _0x2eeec5[_0x415f57(0x130)](_0x5571d9);let _0x100533=[];if(_0x4121cc&&_0x4121cc[_0x415f57(0x1cd)])try{_0x100533=JSON['parse'](_0x4121cc[_0x415f57(0x1cd)]);}catch(_0x327835){}_0x100533['unshift']({'ts':Date[_0x415f57(0x1bb)](),'msg':_0x5270de});if(_0x100533[_0x415f57(0x12d)]>0x32)_0x100533=_0x100533[_0x415f57(0x1bf)](0x0,0x32);await _0x2eeec5[_0x415f57(0x1b5)](_0x5571d9,{'val':JSON[_0x415f57(0x12e)](_0x100533),'ack':!![]});}catch(_0x1b3d4c){}}async function handlePrediction(_0x49059f,_0x2dc0f9,_0x17f5a6){const _0x26bf31=a1_0x5384;if(!_0x2dc0f9||_0x2dc0f9===_0x26bf31(0x150))return;let _0x26b73a='off',_0xd3c198=0.6;try{const _0x20f277=await _0x49059f[_0x26bf31(0x130)](_0x26bf31(0x1af));if(_0x20f277&&_0x20f277[_0x26bf31(0x1cd)])_0x26b73a=_0x20f277['val'];const _0x121ebe=await _0x49059f[_0x26bf31(0x130)]('analysis.automation.confidenceThreshold');if(_0x121ebe&&_0x121ebe[_0x26bf31(0x1cd)])_0xd3c198=_0x121ebe[_0x26bf31(0x1cd)];}catch(_0x189f1b){}if(_0x26b73a==='off'||_0x17f5a6<_0xd3c198)return;const _0x48e71c=Date[_0x26bf31(0x1bb)]();if(lastActions[_0x2dc0f9]&&_0x48e71c-lastActions[_0x2dc0f9]<COOLDOWN_MS)return;const _0x15c5fc=_0x49059f[_0x26bf31(0x1d6)][_0x26bf31(0x175)]||[],_0x29cf01=normalize(_0x2dc0f9),_0x1f39f7=_0x15c5fc[_0x26bf31(0x191)](_0x30101d=>normalize(_0x30101d['location'])===_0x29cf01&&(_0x30101d['type']===_0x26bf31(0x178)||_0x30101d['type']===_0x26bf31(0x145)||_0x30101d[_0x26bf31(0x19b)]===_0x26bf31(0x123)));if(!_0x1f39f7)return;const _0x27af92=await aiAgent['consultButler'](_0x49059f,_0x2dc0f9,_0x1f39f7[_0x26bf31(0x1b2)],_0x17f5a6);if(!_0x27af92[_0x26bf31(0x1bd)])return;const _0x59d878=_0x26bf31(0x195)+_0x2dc0f9+_0x26bf31(0x15b)+_0x1f39f7[_0x26bf31(0x1b2)]+'\x20('+_0x27af92[_0x26bf31(0x14b)]+')';await logAutomationAction(_0x49059f,'['+_0x26b73a[_0x26bf31(0x1cc)]()+']\x20'+_0x59d878);if(_0x26b73a===_0x26bf31(0x199)){const _0x9068a6=await _0x49059f[_0x26bf31(0x129)](_0x1f39f7['id']);(!_0x9068a6||!_0x9068a6[_0x26bf31(0x1cd)]&&_0x9068a6['val']!==!![])&&await _0x49059f[_0x26bf31(0x1b0)](_0x1f39f7['id'],!![]),lastActions[_0x2dc0f9]=_0x48e71c;}}async function findRelatedId(_0x4003f9,_0x28e55d,_0xffa0c0=a1_0x20249a(0x18c)){const _0x590595=a1_0x20249a;if(_0xffa0c0===_0x590595(0x18c)&&_0x4003f9['config'][_0x590595(0x1d0)]){let _0x947836=_0x4003f9[_0x590595(0x1d6)]['thermostatMapping'];if(typeof _0x947836===_0x590595(0x18f))try{_0x947836=JSON[_0x590595(0x18b)](_0x947836);}catch(_0x4853c5){}if(_0x947836&&_0x947836[_0x28e55d])return _0x947836[_0x28e55d];}if(_0xffa0c0===_0x590595(0x1ae)&&_0x4003f9['config'][_0x590595(0x15a)]){let _0x29d7fa=_0x4003f9[_0x590595(0x1d6)][_0x590595(0x15a)];if(typeof _0x29d7fa===_0x590595(0x18f))try{_0x29d7fa=JSON[_0x590595(0x18b)](_0x29d7fa);}catch(_0x476d06){}if(_0x29d7fa&&_0x29d7fa[_0x28e55d])return _0x29d7fa[_0x28e55d];}let _0x16fa11=[];if(_0xffa0c0===_0x590595(0x18c))_0x16fa11=[{'s':_0x590595(0x1d7),'t':_0x590595(0x122)},{'s':_0x590595(0x144),'t':_0x590595(0x122)},{'s':_0x590595(0x144),'t':_0x590595(0x1c8)},{'s':_0x590595(0x1a0),'t':_0x590595(0x1b3)},{'s':_0x590595(0x159),'t':_0x590595(0x19a)},{'s':'local_temperature','t':_0x590595(0x1c5)},{'s':_0x590595(0x141),'t':_0x590595(0x181)},{'s':'ACTUAL','t':_0x590595(0x155)},{'s':_0x590595(0x1d8),'t':_0x590595(0x192)},{'s':'temperature','t':_0x590595(0x18c)}];else _0xffa0c0===_0x590595(0x1ae)&&(_0x16fa11=[{'s':_0x590595(0x1d7),'t':'.1.LEVEL'},{'s':_0x590595(0x144),'t':_0x590595(0x189)},{'s':_0x590595(0x144),'t':_0x590595(0x142)},{'s':_0x590595(0x159),'t':'pi_heating_demand'},{'s':_0x590595(0x141),'t':'valve_position'},{'s':_0x590595(0x141),'t':'level'}]);for(const _0x26ca06 of _0x16fa11){if(_0x28e55d[_0x590595(0x1a1)](_0x26ca06['s'])){const _0x319fb9=_0x28e55d[_0x590595(0x134)](_0x26ca06['s'],_0x26ca06['t']),_0x2f3b00=await _0x4003f9[_0x590595(0x1a7)](_0x319fb9);if(_0x2f3b00)return _0x319fb9;}}try{const _0xf5cf0d=_0x28e55d[_0x590595(0x174)]('.');if(_0xf5cf0d['length']>0x2){const _0xb0a8fa=_0xf5cf0d[_0x590595(0x1bf)](0x0,-0x1)[_0x590595(0x137)]('.'),_0x954e8c=await _0x4003f9[_0x590595(0x16d)](_0xb0a8fa+'.*'),_0x4978eb=[],_0x206468=_0x28e55d[_0x590595(0x174)](/[._]+/)['filter'](_0x3f3e69=>![_0x590595(0x13b),'0',_0x590595(0x1c3),_0x590595(0x131),_0x590595(0x11f),_0x590595(0x141),_0x590595(0x1b7),_0x590595(0x1aa),_0x590595(0x1be),_0x590595(0x132)]['includes'](_0x3f3e69['toLowerCase']()));for(const [_0x1ed6ba,_0x2ed5ed]of Object['entries'](_0x954e8c)){if(_0x1ed6ba===_0x28e55d)continue;if(_0x2ed5ed&&_0x2ed5ed[_0x590595(0x135)]){const _0x4916cc=_0x1ed6ba[_0x590595(0x1bc)](),_0x118784=(_0x2ed5ed['common'][_0x590595(0x13e)]||'')[_0x590595(0x1bc)](),_0x54d61c=(_0x2ed5ed['common'][_0x590595(0x167)]||'')[_0x590595(0x1bc)]();let _0x15a09b=![];if(_0xffa0c0===_0x590595(0x18c)&&_0x2ed5ed[_0x590595(0x135)]['write']===!![])_0x15a09b=_0x4916cc[_0x590595(0x1a1)](_0x590595(0x164))||_0x4916cc[_0x590595(0x1a1)]('soll')||_0x4916cc[_0x590595(0x1a1)](_0x590595(0x1cf))||_0x118784[_0x590595(0x1a1)]('level.temperature')||_0x118784[_0x590595(0x1a1)]('thermostat.setpoint');else _0xffa0c0==='valve'&&(_0x15a09b=_0x4916cc['includes'](_0x590595(0x196))||_0x4916cc['includes'](_0x590595(0x1ae))||_0x4916cc[_0x590595(0x1a1)]('stellwert')||_0x4916cc[_0x590595(0x1a1)](_0x590595(0x146))||_0x118784[_0x590595(0x1a1)](_0x590595(0x128))||_0x118784[_0x590595(0x1a1)](_0x590595(0x176))||_0x54d61c['includes']('%'));if(_0x15a09b){const _0x1d74c7=_0x1ed6ba[_0x590595(0x174)](/[._]+/)[_0x590595(0x18a)](_0x4bc98a=>_0x4bc98a['toLowerCase']());let _0x409557=0x0;_0x206468[_0x590595(0x173)](_0x1bea6f=>{const _0x3e8045=_0x590595;if(_0x1d74c7[_0x3e8045(0x1a1)](_0x1bea6f[_0x3e8045(0x1bc)]()))_0x409557++;}),_0x4978eb[_0x590595(0x1ca)]({'id':_0x1ed6ba,'score':_0x409557});}}}if(_0x4978eb[_0x590595(0x12d)]>0x0){_0x4978eb[_0x590595(0x13c)]((_0x4ed8c0,_0x275335)=>_0x275335['score']-_0x4ed8c0[_0x590595(0x1b1)]);if(_0x4978eb[0x0][_0x590595(0x1b1)]>0x0)return _0x4978eb[0x0]['id'];}}}catch(_0x572fe3){}return null;}async function scanThermostats(_0x14a406){const _0x329d6b=a1_0x20249a,_0xcc845c=_0x14a406['config'][_0x329d6b(0x175)]||[],_0x1730db=[],_0xc6d74b=_0xcc845c[_0x329d6b(0x1a9)](_0x40cef3=>_0x40cef3['id']&&_0x40cef3['id'][_0x329d6b(0x1a1)](_0x329d6b(0x141))||_0x40cef3[_0x329d6b(0x19b)]&&['temperature',_0x329d6b(0x124),_0x329d6b(0x1aa)][_0x329d6b(0x1a1)](_0x40cef3[_0x329d6b(0x19b)])||_0x40cef3[_0x329d6b(0x1b2)]&&_0x40cef3[_0x329d6b(0x1b2)]['toLowerCase']()[_0x329d6b(0x1a1)]('temp'));for(const _0x528302 of _0xc6d74b){const _0x37005a=await findRelatedId(_0x14a406,_0x528302['id'],'setpoint'),_0x2996ba=await findRelatedId(_0x14a406,_0x528302['id'],_0x329d6b(0x1ae));let _0x409b04='Nicht\x20gefunden',_0x4db1a5=![],_0x277bae=_0x14a406[_0x329d6b(0x1d6)][_0x329d6b(0x1d0)]||{};if(typeof _0x277bae===_0x329d6b(0x18f))try{_0x277bae=JSON['parse'](_0x277bae);}catch(_0x1e524f){}let _0x3d0434=_0x14a406[_0x329d6b(0x1d6)]['valveMapping']||{};if(typeof _0x3d0434===_0x329d6b(0x18f))try{_0x3d0434=JSON[_0x329d6b(0x18b)](_0x3d0434);}catch(_0x148fa1){}if(_0x277bae[_0x528302['id']]&&_0x277bae[_0x528302['id']]===_0x37005a||_0x3d0434[_0x528302['id']]&&_0x3d0434[_0x528302['id']]===_0x2996ba)_0x409b04='Manuelles\x20Mapping',_0x4db1a5=!![];else(_0x37005a||_0x2996ba)&&(_0x409b04=_0x329d6b(0x17d));_0x1730db[_0x329d6b(0x1ca)]({'room':_0x528302['location']||_0x329d6b(0x19c),'sensorId':_0x528302['id'],'setpointId':_0x37005a||'-','valveId':_0x2996ba||'-','source':_0x409b04,'isManual':_0x4db1a5,'status':_0x37005a&&_0x2996ba?'PERFECT':_0x37005a?'OK':_0x329d6b(0x1c9)});}return _0x1730db[_0x329d6b(0x13c)]((_0x1b49e8,_0x4818c5)=>_0x1b49e8[_0x329d6b(0x1ac)]['localeCompare'](_0x4818c5[_0x329d6b(0x1ac)]));}async function updateSchedulePreview(_0x59e011){const _0x4d7ebd=a1_0x20249a;if(!_0x59e011['config'][_0x4d7ebd(0x156)]||!_0x59e011[_0x4d7ebd(0x1d6)]['calendarInstance'])return;let _0x212f68={};try{const _0x5d4218=await _0x59e011['getStateAsync']('analysis.energy.warmupTimes');if(_0x5d4218&&_0x5d4218[_0x4d7ebd(0x1cd)])_0x212f68=JSON[_0x4d7ebd(0x18b)](_0x5d4218[_0x4d7ebd(0x1cd)]);}catch(_0x42d305){}const _0x347ed9=[],_0x31d3cb=Date[_0x4d7ebd(0x1bb)](),_0x5ea417=0x30*0x3c*0x3c*0x3e8;try{const _0x74534f=await _0x59e011[_0x4d7ebd(0x129)](_0x59e011[_0x4d7ebd(0x1d6)][_0x4d7ebd(0x184)]+'.data.table');if(!_0x74534f||!_0x74534f[_0x4d7ebd(0x1cd)])return;const _0x5c48d7=JSON[_0x4d7ebd(0x18b)](_0x74534f[_0x4d7ebd(0x1cd)]),_0x5c54bf=_0x59e011[_0x4d7ebd(0x1d6)][_0x4d7ebd(0x194)]||[],_0x1465e7=_0x59e011[_0x4d7ebd(0x1d6)][_0x4d7ebd(0x175)]||[],_0x17a271=new Set();_0x1465e7[_0x4d7ebd(0x173)](_0x45af4d=>{const _0xde6e7a=_0x4d7ebd;if(_0x45af4d['location'])_0x17a271['add'](_0x45af4d[_0xde6e7a(0x121)]);});for(const _0x3ee730 of _0x5c48d7){if(_0x3ee730[_0x4d7ebd(0x1a6)]&&_0x5c54bf[_0x4d7ebd(0x12d)]>0x0&&!_0x5c54bf[_0x4d7ebd(0x1a1)](_0x3ee730[_0x4d7ebd(0x1a6)]))continue;const _0x57e5da=_0x3ee730[_0x4d7ebd(0x1d1)]||_0x3ee730['eventStart']||_0x3ee730[_0x4d7ebd(0x1ba)];if(!_0x57e5da)continue;const _0x102349=new Date(_0x57e5da),_0x2cf22a=_0x102349[_0x4d7ebd(0x126)]();if(isNaN(_0x2cf22a))continue;if(_0x2cf22a<_0x31d3cb)continue;if(_0x2cf22a>_0x31d3cb+_0x5ea417)continue;const _0x44a3d8=(_0x3ee730[_0x4d7ebd(0x13f)]||_0x3ee730[_0x4d7ebd(0x1ce)]||'')[_0x4d7ebd(0x1bc)]();let _0x528807=![],_0x4d8e33=[],_0x15641e=_0x3ee730['event']||_0x3ee730[_0x4d7ebd(0x1ce)]||'Unbekannt';if(_0x44a3d8['includes'](_0x4d7ebd(0x17a))||_0x44a3d8[_0x4d7ebd(0x1a1)](_0x4d7ebd(0x187))||_0x44a3d8['includes']('ankunft'))_0x528807=!![],_0x4d8e33=Array['from'](_0x17a271);else for(const _0x40fdca of _0x17a271){if(_0x44a3d8[_0x4d7ebd(0x1a1)](_0x40fdca['toLowerCase']()))_0x4d8e33[_0x4d7ebd(0x1ca)](_0x40fdca);}_0x4d8e33[_0x4d7ebd(0x12d)]>0x0&&_0x4d8e33[_0x4d7ebd(0x173)](_0x9c2384=>{const _0x394472=_0x4d7ebd;let _0x2cb08c=0x3c;if(_0x528807){let _0x171b6d=0x0;Object[_0x394472(0x16e)](_0x212f68)[_0x394472(0x173)](_0x15a228=>{if(_0x15a228>_0x171b6d)_0x171b6d=_0x15a228;}),_0x2cb08c=_0x171b6d>0x0?_0x171b6d:0x78;}else _0x2cb08c=getWarmupRobust(_0x212f68,_0x9c2384);const _0x5b7a93=new Date(_0x2cf22a-_0x2cb08c*0xea60);_0x347ed9[_0x394472(0x1ca)]({'eventTime':_0x2cf22a,'triggerTime':_0x5b7a93[_0x394472(0x126)](),'room':_0x9c2384,'minutes':_0x2cb08c,'reason':_0x15641e,'isGlobal':_0x528807});});}}catch(_0x1d53f3){}_0x347ed9['sort']((_0x2eeec9,_0x349647)=>_0x2eeec9[_0x4d7ebd(0x1c1)]-_0x349647[_0x4d7ebd(0x1c1)]);const _0x2bdd4d=_0x347ed9['slice'](0x0,0x5);await _0x59e011['setStateAsync']('analysis.energy.schedulePreview',{'val':JSON['stringify'](_0x2bdd4d),'ack':!![]});}function a1_0x5384(_0x1a8cab,_0x19b7e3){const _0xedb54c=a1_0x30c6();return a1_0x5384=function(_0x4593ad,_0x420c29){_0x4593ad=_0x4593ad-0x11f;let _0x30c647=_0xedb54c[_0x4593ad];return _0x30c647;},a1_0x5384(_0x1a8cab,_0x19b7e3);}async function monitorEnforcements(_0x4bb65f){const _0x2d7d48=a1_0x20249a;try{const _0x2a14d5=_0x2d7d48(0x14a),_0x1cde8e=await _0x4bb65f[_0x2d7d48(0x130)](_0x2a14d5);if(!_0x1cde8e||!_0x1cde8e[_0x2d7d48(0x1cd)])return;let _0x1e05ba=[];try{_0x1e05ba=JSON[_0x2d7d48(0x18b)](_0x1cde8e[_0x2d7d48(0x1cd)]);}catch(_0x3215ac){return;}if(!Array[_0x2d7d48(0x13a)](_0x1e05ba)||_0x1e05ba['length']===0x0)return;const _0x39bec9=Date['now'](),_0x190dc0=_0x4bb65f[_0x2d7d48(0x1d6)]['devices']||[];let _0x3a3668=![];for(let _0x524b28=_0x1e05ba[_0x2d7d48(0x12d)]-0x1;_0x524b28>=0x0;_0x524b28--){const _0x259f4f=_0x1e05ba[_0x524b28];if(_0x39bec9>=_0x259f4f[_0x2d7d48(0x1a4)]){_0x4bb65f[_0x2d7d48(0x1b9)][_0x2d7d48(0x1c2)](_0x2d7d48(0x1c6)+_0x259f4f['room']+'\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.'),_0x1e05ba['splice'](_0x524b28,0x1),_0x3a3668=!![];continue;}const _0x3fc377=_0x190dc0[_0x2d7d48(0x191)](_0x4e22b1=>normalize(_0x4e22b1['location'])===normalize(_0x259f4f[_0x2d7d48(0x1ac)])&&(_0x4e22b1['type']===_0x2d7d48(0x141)||_0x4e22b1['type']===_0x2d7d48(0x124)));if(_0x3fc377){const _0x40f3e3=await findRelatedId(_0x4bb65f,_0x3fc377['id'],_0x2d7d48(0x18c));if(_0x40f3e3){const _0x1345cb=await _0x4bb65f[_0x2d7d48(0x129)](_0x40f3e3);_0x1345cb&&typeof _0x1345cb[_0x2d7d48(0x1cd)]===_0x2d7d48(0x1c4)&&(_0x1345cb['val']<0xf&&(_0x4bb65f[_0x2d7d48(0x1b9)][_0x2d7d48(0x149)](_0x2d7d48(0x19f)+_0x259f4f['room']+_0x2d7d48(0x1a2)+_0x1345cb[_0x2d7d48(0x1cd)]+'Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20'+_0x259f4f['target']+'Â°C.'),await _0x4bb65f[_0x2d7d48(0x1b0)](_0x40f3e3,_0x259f4f[_0x2d7d48(0x1cf)]),await logAutomationAction(_0x4bb65f,_0x2d7d48(0x136)+_0x259f4f[_0x2d7d48(0x1ac)]+':\x20'+_0x1345cb[_0x2d7d48(0x1cd)]+'Â°C\x20->\x20'+_0x259f4f[_0x2d7d48(0x1cf)]+_0x2d7d48(0x151))));}}}_0x3a3668&&await _0x4bb65f['setStateAsync'](_0x2a14d5,{'val':JSON['stringify'](_0x1e05ba),'ack':!![]});}catch(_0x4eefce){_0x4bb65f[_0x2d7d48(0x1b9)]['error'](_0x2d7d48(0x17e)+_0x4eefce['message']);}}async function checkCalendarTriggers(_0x17aa1b){const _0x1277eb=a1_0x20249a;if(!_0x17aa1b[_0x1277eb(0x1d6)][_0x1277eb(0x156)]||!_0x17aa1b[_0x1277eb(0x1d6)][_0x1277eb(0x184)])return;await updateSchedulePreview(_0x17aa1b);let _0x3c2d59={},_0xa77f29={};try{const _0x19fed5=await _0x17aa1b['getStateAsync'](_0x1277eb(0x158));if(_0x19fed5&&_0x19fed5[_0x1277eb(0x1cd)])_0x3c2d59=JSON['parse'](_0x19fed5[_0x1277eb(0x1cd)]);const _0x432b99=await _0x17aa1b[_0x1277eb(0x130)](_0x1277eb(0x179));if(_0x432b99&&_0x432b99[_0x1277eb(0x1cd)])_0xa77f29=JSON[_0x1277eb(0x18b)](_0x432b99[_0x1277eb(0x1cd)]);}catch(_0x31c840){}let _0x5b504a={'default':0x15};try{const _0x3c9d88=await _0x17aa1b['getStateAsync'](_0x1277eb(0x193));if(_0x3c9d88&&_0x3c9d88['val'])_0x5b504a=JSON[_0x1277eb(0x18b)](_0x3c9d88[_0x1277eb(0x1cd)]);}catch(_0x4c04e3){}let _0x47e46c=[];try{const _0x3705b0=await _0x17aa1b['getStateAsync'](_0x1277eb(0x14a));if(_0x3705b0&&_0x3705b0[_0x1277eb(0x1cd)])_0x47e46c=JSON[_0x1277eb(0x18b)](_0x3705b0[_0x1277eb(0x1cd)]);}catch(_0x491fc7){}try{const _0x1fbbb1=await _0x17aa1b[_0x1277eb(0x129)](_0x17aa1b[_0x1277eb(0x1d6)][_0x1277eb(0x184)]+_0x1277eb(0x147));if(!_0x1fbbb1||!_0x1fbbb1[_0x1277eb(0x1cd)])return;const _0x5cc318=JSON[_0x1277eb(0x18b)](_0x1fbbb1[_0x1277eb(0x1cd)]),_0x1162e4=Date[_0x1277eb(0x1bb)](),_0x454590=_0x17aa1b['config'][_0x1277eb(0x175)]||[],_0x5bde36=_0x17aa1b[_0x1277eb(0x1d6)][_0x1277eb(0x194)]||[];let _0xe8c68=![];for(const _0x24dd64 of _0x5cc318){if(_0x24dd64[_0x1277eb(0x1a6)]&&_0x5bde36[_0x1277eb(0x12d)]>0x0&&!_0x5bde36[_0x1277eb(0x1a1)](_0x24dd64[_0x1277eb(0x1a6)]))continue;const _0x364ab4=_0x24dd64['_date']||_0x24dd64[_0x1277eb(0x1a3)]||_0x24dd64['date'];if(!_0x364ab4)continue;const _0xca7605=new Date(_0x364ab4);if(isNaN(_0xca7605['getTime']()))continue;const _0x50a288=(_0x24dd64[_0x1277eb(0x13f)]||_0x24dd64[_0x1277eb(0x1ce)]||'')[_0x1277eb(0x1bc)]();if(_0x50a288[_0x1277eb(0x1a1)](_0x1277eb(0x17a))||_0x50a288[_0x1277eb(0x1a1)](_0x1277eb(0x187))||_0x50a288[_0x1277eb(0x1a1)](_0x1277eb(0x165))){let _0x285f5c=0x0;Object['values'](_0x3c2d59)[_0x1277eb(0x173)](_0x3dc461=>{if(_0x3dc461>_0x285f5c)_0x285f5c=_0x3dc461;});if(_0x285f5c===0x0)_0x285f5c=0x78;const _0x552827=_0xca7605[_0x1277eb(0x126)]()-_0x285f5c*0xea60;_0x1162e4>=_0x552827&&_0x1162e4<_0xca7605[_0x1277eb(0x126)]()&&(_0x17aa1b[_0x1277eb(0x14c)]!=='normal'&&(_0x17aa1b['log'][_0x1277eb(0x1c2)](_0x1277eb(0x13d)+_0x285f5c+_0x1277eb(0x154)),await _0x17aa1b[_0x1277eb(0x1b5)](_0x1277eb(0x1d2),{'val':_0x1277eb(0x120),'ack':![]})));}for(const _0x16d89a of _0x454590){if(_0x16d89a[_0x1277eb(0x121)]){const _0x102fbc=_0x16d89a[_0x1277eb(0x121)][_0x1277eb(0x1bc)](),_0x834ebd=(_0x16d89a['name']||'')[_0x1277eb(0x1bc)]();let _0xfbffbf=_0x50a288['includes'](_0x102fbc);!_0xfbffbf&&_0x834ebd['length']>0x3&&_0x50a288[_0x1277eb(0x1a1)](_0x834ebd)&&(_0xfbffbf=!![]);if(_0xfbffbf){const _0x352403=getWarmupRobust(_0x3c2d59,_0x16d89a['location']),_0x155d63=_0xa77f29[_0x16d89a[_0x1277eb(0x121)]]||_0x1277eb(0x14f),_0x86c2d=_0xca7605['getTime']()-_0x352403*0xea60;if(_0x1162e4>=_0x86c2d&&_0x1162e4<_0xca7605['getTime']()){const _0x57a5f2=lastActions[_0x1277eb(0x1b4)+_0x16d89a[_0x1277eb(0x121)]];if(_0x57a5f2&&_0x1162e4-_0x57a5f2<CAL_COOLDOWN_MS)continue;const _0x2f67af=await findRelatedId(_0x17aa1b,_0x16d89a['id'],_0x1277eb(0x18c));if(_0x2f67af){let _0x29c74e=_0x5b504a[_0x16d89a[_0x1277eb(0x121)]];if(_0x29c74e===undefined)_0x29c74e=_0x5b504a[_0x1277eb(0x17c)];if(_0x29c74e===undefined)_0x29c74e=0x15;const _0x2b95db=await _0x17aa1b[_0x1277eb(0x129)](_0x2f67af);if(_0x2b95db&&typeof _0x2b95db[_0x1277eb(0x1cd)]===_0x1277eb(0x1c4)&&_0x2b95db[_0x1277eb(0x1cd)]<_0x29c74e-0.5){_0x17aa1b[_0x1277eb(0x1b9)][_0x1277eb(0x1c2)](_0x1277eb(0x14e)+_0x155d63+_0x1277eb(0x140)+_0x16d89a['location']+_0x1277eb(0x1c0)+_0x50a288+_0x1277eb(0x12a)+_0x29c74e+_0x1277eb(0x16a)+_0x352403+_0x1277eb(0x154)),await _0x17aa1b[_0x1277eb(0x1b0)](_0x2f67af,_0x29c74e),await logAutomationAction(_0x17aa1b,_0x1277eb(0x1ab)+_0x16d89a[_0x1277eb(0x121)]+_0x1277eb(0x183)+_0x29c74e+_0x1277eb(0x1d3)+_0x155d63+')'),lastActions[_0x1277eb(0x1b4)+_0x16d89a[_0x1277eb(0x121)]]=_0x1162e4;const _0x31258a=_0x47e46c[_0x1277eb(0x133)](_0x2d0a0c=>_0x2d0a0c['room']===_0x16d89a[_0x1277eb(0x121)]);if(_0x31258a!==-0x1)_0x47e46c[_0x1277eb(0x12f)](_0x31258a,0x1);_0x47e46c[_0x1277eb(0x1ca)]({'room':_0x16d89a[_0x1277eb(0x121)],'target':_0x29c74e,'until':_0xca7605[_0x1277eb(0x126)]()}),_0xe8c68=!![];}}}}}}}_0xe8c68&&await _0x17aa1b[_0x1277eb(0x1b5)](_0x1277eb(0x14a),{'val':JSON[_0x1277eb(0x12e)](_0x47e46c),'ack':!![]});}catch(_0x1d2fb4){_0x17aa1b[_0x1277eb(0x1b9)][_0x1277eb(0x149)](_0x1277eb(0x166)+_0x1d2fb4[_0x1277eb(0x17f)]);}}async function manageMpcIntervention(_0x485896,_0x5423e6,_0x28a95e){const _0x49e94c=a1_0x20249a;try{const _0x5a326a=_0x49e94c(0x1b8),_0x269a8f=await _0x485896['getStateAsync'](_0x5a326a);let _0x815b5c=[];if(_0x269a8f&&_0x269a8f[_0x49e94c(0x1cd)])try{_0x815b5c=JSON[_0x49e94c(0x18b)](_0x269a8f[_0x49e94c(0x1cd)]);}catch(_0x236bf5){}const _0xb1169d=_0x815b5c[_0x49e94c(0x14d)](_0x5423e6);if(_0x28a95e===_0x49e94c(0x177))_0xb1169d===-0x1&&(_0x815b5c[_0x49e94c(0x1ca)](_0x5423e6),await _0x485896['setStateAsync'](_0x5a326a,{'val':JSON['stringify'](_0x815b5c),'ack':!![]}));else _0x28a95e===_0x49e94c(0x198)&&(_0xb1169d!==-0x1&&(_0x815b5c[_0x49e94c(0x12f)](_0xb1169d,0x1),await _0x485896['setStateAsync'](_0x5a326a,{'val':JSON[_0x49e94c(0x12e)](_0x815b5c),'ack':!![]})));}catch(_0x5295e0){}}async function cleanupGhostInterventions(_0x266aaf){const _0x11a12a=a1_0x20249a;try{const _0x207908=_0x11a12a(0x1b8),_0x46cd61=await _0x266aaf[_0x11a12a(0x130)](_0x207908);if(!_0x46cd61||!_0x46cd61[_0x11a12a(0x1cd)])return;const _0x458429=JSON[_0x11a12a(0x18b)](_0x46cd61[_0x11a12a(0x1cd)]);if(!Array[_0x11a12a(0x13a)](_0x458429)||_0x458429[_0x11a12a(0x12d)]===0x0)return;let _0x387ffb={'default':0x15};try{const _0x50b185=await _0x266aaf['getStateAsync'](_0x11a12a(0x193));if(_0x50b185&&_0x50b185[_0x11a12a(0x1cd)])_0x387ffb=JSON[_0x11a12a(0x18b)](_0x50b185['val']);}catch(_0x5c6c4c){}let _0x280b02=[];try{const _0x1b3380=await _0x266aaf[_0x11a12a(0x130)](_0x11a12a(0x12c));if(_0x1b3380&&_0x1b3380[_0x11a12a(0x1cd)])_0x280b02=JSON[_0x11a12a(0x18b)](_0x1b3380[_0x11a12a(0x1cd)]);}catch(_0x1f8cdf){}let _0x42b1b5={},_0x5169da=![];try{const _0x352f7a=await _0x266aaf[_0x11a12a(0x130)](_0x11a12a(0x162));if(_0x352f7a&&_0x352f7a[_0x11a12a(0x1cd)])_0x42b1b5=JSON['parse'](_0x352f7a['val']);}catch(_0xc66124){}if(_0x42b1b5['_meta']){const _0x17e24d=Date['now']();for(const [_0x1ab454,_0x3f2087]of Object[_0x11a12a(0x19d)](_0x42b1b5[_0x11a12a(0x15e)])){_0x17e24d-_0x3f2087>PENALTY_TTL&&(delete _0x42b1b5[_0x1ab454],delete _0x42b1b5[_0x11a12a(0x15e)][_0x1ab454],_0x5169da=!![],_0x266aaf['log'][_0x11a12a(0x1c2)](_0x11a12a(0x161)+_0x1ab454+'\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.'));}}const _0x35978a=_0x266aaf[_0x11a12a(0x1d6)]['devices']||[];let _0x369932=![];for(let _0x4b7f7b=_0x458429[_0x11a12a(0x12d)]-0x1;_0x4b7f7b>=0x0;_0x4b7f7b--){const _0x486683=_0x458429[_0x4b7f7b],_0x275e24=_0x35978a[_0x11a12a(0x191)](_0x2bf8d9=>normalize(_0x2bf8d9[_0x11a12a(0x121)])===normalize(_0x486683)&&(_0x2bf8d9[_0x11a12a(0x19b)]===_0x11a12a(0x141)||_0x2bf8d9[_0x11a12a(0x19b)]===_0x11a12a(0x124)));if(!_0x275e24){_0x266aaf[_0x11a12a(0x1b9)][_0x11a12a(0x149)]('ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27'+_0x486683+'\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.'),_0x458429[_0x11a12a(0x12f)](_0x4b7f7b,0x1),_0x369932=!![];continue;}if(_0x275e24){const _0x2c14a4=await findRelatedId(_0x266aaf,_0x275e24['id'],_0x11a12a(0x18c)),_0x2d6205=await _0x266aaf[_0x11a12a(0x129)](_0x275e24['id']);if(_0x2c14a4){const _0x20fab2=await _0x266aaf[_0x11a12a(0x129)](_0x2c14a4);if(_0x20fab2&&typeof _0x20fab2['val']===_0x11a12a(0x1c4)){let _0x5a8e6d=![],_0x23c57f='';Math[_0x11a12a(0x188)](_0x20fab2['val']-ECO_TEMP)>0.5&&(_0x5a8e6d=!![],_0x23c57f=_0x11a12a(0x197));if(!_0x5a8e6d&&_0x2d6205&&typeof _0x2d6205[_0x11a12a(0x1cd)]===_0x11a12a(0x1c4)){const _0x3c1244=_0x387ffb[_0x486683]||_0x387ffb['default']||0x15;_0x2d6205[_0x11a12a(0x1cd)]<_0x3c1244+0.2&&(_0x5a8e6d=!![],_0x23c57f=_0x11a12a(0x12b));}if(_0x5a8e6d){if(_0x23c57f===_0x11a12a(0x197)){_0x266aaf[_0x11a12a(0x1b9)][_0x11a12a(0x1c2)](_0x11a12a(0x127)+_0x486683+'\x20ist\x20auf\x20'+_0x20fab2[_0x11a12a(0x1cd)]+_0x11a12a(0x160)+ECO_TEMP+_0x11a12a(0x15f));const _0x4aea5=lastActions['cal_'+_0x486683],_0x5394c3=_0x4aea5&&Date[_0x11a12a(0x1bb)]()-_0x4aea5<0x2*0x3c*0x3e8;if(!_0x5394c3&&_0x20fab2['val']>ECO_TEMP+0.5){_0x266aaf[_0x11a12a(0x185)]&&(_0x266aaf[_0x11a12a(0x1b9)][_0x11a12a(0x1c2)](_0x11a12a(0x172)+_0x486683+'\x20wurde\x20manuell\x20erhÃ¶ht.'),_0x266aaf[_0x11a12a(0x185)](_0x11a12a(0x1ad),{'room':_0x486683}));const _0x546ba5=_0x486683+'_'+new Date()[_0x11a12a(0x125)]();if(!_0x42b1b5[_0x546ba5]){_0x42b1b5[_0x546ba5]=0x1;if(!_0x42b1b5[_0x11a12a(0x15e)])_0x42b1b5[_0x11a12a(0x15e)]={};_0x42b1b5[_0x11a12a(0x15e)][_0x546ba5]=Date[_0x11a12a(0x1bb)](),_0x5169da=!![];}}else _0x5394c3&&_0x266aaf[_0x11a12a(0x1b9)][_0x11a12a(0x1c2)](_0x11a12a(0x16b)+_0x486683+'\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.');}else{if(_0x23c57f===_0x11a12a(0x12b)){let _0x1322da=![];if(_0x280b02[_0x11a12a(0x191)](_0x4a4243=>_0x4a4243['room']===_0x486683))_0x1322da=!![];const _0x24553c=_0x35978a[_0x11a12a(0x1a9)](_0xae192e=>normalize(_0xae192e[_0x11a12a(0x121)])===normalize(_0x486683)&&(_0xae192e['type']===_0x11a12a(0x169)||_0xae192e[_0x11a12a(0x19b)]===_0x11a12a(0x1aa)||_0xae192e[_0x11a12a(0x19b)]==='contact'));for(const _0x59350d of _0x24553c){try{const _0x63f898=await _0x266aaf[_0x11a12a(0x129)](_0x59350d['id']);if(_0x63f898&&(_0x63f898[_0x11a12a(0x1cd)]===!![]||_0x63f898[_0x11a12a(0x1cd)]===0x1||String(_0x63f898[_0x11a12a(0x1cd)])[_0x11a12a(0x1bc)]()===_0x11a12a(0x138)))_0x1322da=!![];}catch(_0x15dc3f){}}if(_0x1322da)_0x266aaf['log'][_0x11a12a(0x1c2)](_0x11a12a(0x152)+_0x486683+'\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.');else{const _0x3df8bb=_0x387ffb[_0x486683]||_0x387ffb[_0x11a12a(0x17c)]||0x15;_0x266aaf[_0x11a12a(0x1b9)][_0x11a12a(0x1c2)](_0x11a12a(0x15c)+_0x486683+'\x20erreicht\x20Limit\x20('+_0x2d6205[_0x11a12a(0x1cd)]+_0x11a12a(0x19e)+(_0x3df8bb+0.2)+_0x11a12a(0x1c7)),await _0x266aaf[_0x11a12a(0x1b0)](_0x2c14a4,_0x3df8bb),await logAutomationAction(_0x266aaf,'[WATCHDOG]\x20'+_0x486683+':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20'+_0x3df8bb+'Â°C'),lastActions[_0x11a12a(0x17b)+_0x486683]=Date[_0x11a12a(0x1bb)]();}}}_0x458429[_0x11a12a(0x12f)](_0x4b7f7b,0x1),_0x369932=!![];}}}}}_0x369932&&await _0x266aaf['setStateAsync'](_0x207908,{'val':JSON[_0x11a12a(0x12e)](_0x458429),'ack':!![]}),_0x5169da&&await _0x266aaf[_0x11a12a(0x1b5)]('analysis.energy.rlPenalties',{'val':JSON[_0x11a12a(0x12e)](_0x42b1b5),'ack':!![]});}catch(_0x159490){}}async function applyEnergySavings(_0x4460b2,_0xe52b14){const _0x29bb3e=a1_0x20249a;await cleanupGhostInterventions(_0x4460b2);if(!_0xe52b14||_0xe52b14[_0x29bb3e(0x12d)]===0x0)return;const _0x357235=_0x4460b2['config'][_0x29bb3e(0x175)]||[],_0x5ad2d6=Date['now']();for(const _0x5a9c5d of _0xe52b14){const _0x191a9c=_0x5a9c5d['room'],_0x299276=_0x5a9c5d[_0x29bb3e(0x1cb)],_0x4828dd=_0x5a9c5d[_0x29bb3e(0x1cf)]||0x15;if(lastActions[_0x29bb3e(0x17b)+_0x191a9c]&&_0x5ad2d6-lastActions[_0x29bb3e(0x17b)+_0x191a9c]<RESCUE_LOCK_MS)continue;const _0x12ac40=_0x357235[_0x29bb3e(0x191)](_0x164c7d=>normalize(_0x164c7d[_0x29bb3e(0x121)])===normalize(_0x191a9c)&&(_0x164c7d['type']===_0x29bb3e(0x141)||_0x164c7d[_0x29bb3e(0x19b)]==='thermostat'));if(!_0x12ac40)continue;const _0x34ecf2=await findRelatedId(_0x4460b2,_0x12ac40['id'],_0x29bb3e(0x18c));if(_0x34ecf2){if(lastActions['mpc_'+_0x191a9c]&&_0x5ad2d6-lastActions[_0x29bb3e(0x148)+_0x191a9c]<0x1e*0x3c*0x3e8)continue;const _0x47a4b3=await _0x4460b2[_0x29bb3e(0x129)](_0x34ecf2);if(_0x47a4b3&&typeof _0x47a4b3[_0x29bb3e(0x1cd)]===_0x29bb3e(0x1c4)){const _0xd6b642=_0x47a4b3[_0x29bb3e(0x1cd)];_0xd6b642!==ECO_TEMP&&await manageMpcIntervention(_0x4460b2,_0x191a9c,'remove');if(_0x299276>0x1e)_0xd6b642>ECO_TEMP+0.5&&(_0x4460b2[_0x29bb3e(0x1b9)][_0x29bb3e(0x1c2)](_0x29bb3e(0x15d)+_0x191a9c+'\x20auf\x20'+ECO_TEMP+_0x29bb3e(0x180)+_0x299276+_0x29bb3e(0x157)),await _0x4460b2['setForeignStateAsync'](_0x34ecf2,ECO_TEMP),await manageMpcIntervention(_0x4460b2,_0x191a9c,_0x29bb3e(0x177)),lastActions['mpc_'+_0x191a9c]=_0x5ad2d6,await logAutomationAction(_0x4460b2,_0x29bb3e(0x182)+_0x191a9c+_0x29bb3e(0x190)+ECO_TEMP+'Â°C'));else _0x299276<=0xf&&(_0xd6b642<_0x4828dd&&(_0x4460b2[_0x29bb3e(0x1b9)][_0x29bb3e(0x1c2)](_0x29bb3e(0x186)+_0x191a9c+_0x29bb3e(0x1b6)+_0x4828dd+_0x29bb3e(0x171)),await _0x4460b2[_0x29bb3e(0x1b0)](_0x34ecf2,_0x4828dd),await manageMpcIntervention(_0x4460b2,_0x191a9c,_0x29bb3e(0x198)),lastActions['mpc_'+_0x191a9c]=_0x5ad2d6,await logAutomationAction(_0x4460b2,'[MPC]\x20'+_0x191a9c+_0x29bb3e(0x1d4)+_0x4828dd+'Â°C')));}}else _0x4460b2[_0x29bb3e(0x1b9)][_0x29bb3e(0x149)]('[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20'+_0x191a9c+'\x20gefunden!');}}module[a1_0x20249a(0x18d)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};