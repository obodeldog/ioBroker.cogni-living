const a1_0xe4dcb5=a1_0x5858;(function(_0x7c8633,_0x54bb39){const _0x378c6f=a1_0x5858,_0x59fda9=_0x7c8633();while(!![]){try{const _0x526607=parseInt(_0x378c6f(0x21a))/0x1+parseInt(_0x378c6f(0x1bd))/0x2*(-parseInt(_0x378c6f(0x25b))/0x3)+parseInt(_0x378c6f(0x23b))/0x4+-parseInt(_0x378c6f(0x1d6))/0x5*(parseInt(_0x378c6f(0x1f2))/0x6)+parseInt(_0x378c6f(0x1c4))/0x7+-parseInt(_0x378c6f(0x1cb))/0x8*(parseInt(_0x378c6f(0x1b9))/0x9)+parseInt(_0x378c6f(0x1da))/0xa*(-parseInt(_0x378c6f(0x1db))/0xb);if(_0x526607===_0x54bb39)break;else _0x59fda9['push'](_0x59fda9['shift']());}catch(_0x429620){_0x59fda9['push'](_0x59fda9['shift']());}}}(a1_0x51b9,0x5f702));const a1_0x482c52=(function(){let _0x4eb790=!![];return function(_0x4841d0,_0x526d55){const _0x1a86b2=_0x4eb790?function(){if(_0x526d55){const _0x456af2=_0x526d55['apply'](_0x4841d0,arguments);return _0x526d55=null,_0x456af2;}}:function(){};return _0x4eb790=![],_0x1a86b2;};}()),a1_0x24dd73=a1_0x482c52(this,function(){const _0x3dfbed=a1_0x5858;return a1_0x24dd73[_0x3dfbed(0x265)]()[_0x3dfbed(0x1f9)](_0x3dfbed(0x249))[_0x3dfbed(0x265)]()['constructor'](a1_0x24dd73)[_0x3dfbed(0x1f9)](_0x3dfbed(0x249));});a1_0x24dd73();'use strict';const aiAgent=require(a1_0xe4dcb5(0x1ba)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0xaec5bc){const _0x368625=a1_0xe4dcb5;if(!_0xaec5bc)return'';return _0xaec5bc['toLowerCase']()[_0x368625(0x23a)](/\s+/g,'')[_0x368625(0x24c)]();}function getWarmupRobust(_0x10d1da,_0x3d6dac){const _0x180204=a1_0xe4dcb5;if(!_0x10d1da||!_0x3d6dac)return 0x3c;if(_0x10d1da[_0x3d6dac]!==undefined)return _0x10d1da[_0x3d6dac];const _0x273eb0=_0x3d6dac[_0x180204(0x1fe)]()[_0x180204(0x23a)](/√§/g,'ae')['replace'](/√∂/g,'oe')[_0x180204(0x23a)](/√º/g,'ue')['replace'](/√ü/g,'ss')[_0x180204(0x23a)](/\s+/g,'_')['replace'](/[^a-z0-9_]/g,'');if(_0x10d1da[_0x273eb0]!==undefined)return _0x10d1da[_0x273eb0];return 0x3c;}async function logAutomationAction(_0x5728a4,_0xec869c){const _0x213362=a1_0xe4dcb5;await _0x5728a4['setStateAsync'](_0x213362(0x21c),{'val':_0xec869c,'ack':!![]});try{const _0x5eb686='analysis.automation.actionLog',_0x2017ef=await _0x5728a4['getStateAsync'](_0x5eb686);let _0x2e836c=[];if(_0x2017ef&&_0x2017ef[_0x213362(0x1fa)])try{_0x2e836c=JSON['parse'](_0x2017ef['val']);}catch(_0x5e4b97){}_0x2e836c['unshift']({'ts':Date[_0x213362(0x1e9)](),'msg':_0xec869c});if(_0x2e836c[_0x213362(0x233)]>0x32)_0x2e836c=_0x2e836c[_0x213362(0x20e)](0x0,0x32);await _0x5728a4[_0x213362(0x1e3)](_0x5eb686,{'val':JSON[_0x213362(0x1f3)](_0x2e836c),'ack':!![]});}catch(_0x2a4388){}}async function handlePrediction(_0x35b6d0,_0x31c3e6,_0x5aa5fc){const _0x20ff7a=a1_0xe4dcb5;if(!_0x31c3e6||_0x31c3e6==='Unknown')return;let _0x5769bf=_0x20ff7a(0x237),_0x7ba00a=0.6;try{const _0x312a0e=await _0x35b6d0['getStateAsync'](_0x20ff7a(0x22b));if(_0x312a0e&&_0x312a0e[_0x20ff7a(0x1fa)])_0x5769bf=_0x312a0e[_0x20ff7a(0x1fa)];const _0x192e60=await _0x35b6d0[_0x20ff7a(0x24b)](_0x20ff7a(0x234));if(_0x192e60&&_0x192e60[_0x20ff7a(0x1fa)])_0x7ba00a=_0x192e60[_0x20ff7a(0x1fa)];}catch(_0x1bc2e9){}if(_0x5769bf===_0x20ff7a(0x237)||_0x5aa5fc<_0x7ba00a)return;const _0x468926=Date[_0x20ff7a(0x1e9)]();if(lastActions[_0x31c3e6]&&_0x468926-lastActions[_0x31c3e6]<COOLDOWN_MS)return;const _0x5bdb3f=_0x35b6d0[_0x20ff7a(0x1d7)][_0x20ff7a(0x21d)]||[],_0x1d8b15=normalize(_0x31c3e6),_0x4ba1b0=_0x5bdb3f[_0x20ff7a(0x23d)](_0x1ac433=>normalize(_0x1ac433[_0x20ff7a(0x240)])===_0x1d8b15&&(_0x1ac433[_0x20ff7a(0x251)]==='light'||_0x1ac433[_0x20ff7a(0x251)]===_0x20ff7a(0x1cf)||_0x1ac433[_0x20ff7a(0x251)]==='switch'));if(!_0x4ba1b0)return;const _0x30bbfb=await aiAgent[_0x20ff7a(0x236)](_0x35b6d0,_0x31c3e6,_0x4ba1b0['name'],_0x5aa5fc);if(!_0x30bbfb['approved'])return;const _0x19e727=_0x20ff7a(0x24a)+_0x31c3e6+_0x20ff7a(0x1c1)+_0x4ba1b0[_0x20ff7a(0x220)]+'\x20('+_0x30bbfb['reason']+')';await logAutomationAction(_0x35b6d0,'['+_0x5769bf['toUpperCase']()+']\x20'+_0x19e727);if(_0x5769bf===_0x20ff7a(0x1c2)){const _0x13c042=await _0x35b6d0[_0x20ff7a(0x1fb)](_0x4ba1b0['id']);(!_0x13c042||!_0x13c042[_0x20ff7a(0x1fa)]&&_0x13c042[_0x20ff7a(0x1fa)]!==!![])&&await _0x35b6d0[_0x20ff7a(0x228)](_0x4ba1b0['id'],!![]),lastActions[_0x31c3e6]=_0x468926;}}async function findRelatedId(_0x5727fd,_0x5d5655,_0x40163f=a1_0xe4dcb5(0x221)){const _0x2fefbb=a1_0xe4dcb5;if(_0x40163f===_0x2fefbb(0x221)&&_0x5727fd[_0x2fefbb(0x1d7)][_0x2fefbb(0x1df)]){let _0x367333=_0x5727fd['config']['thermostatMapping'];if(typeof _0x367333===_0x2fefbb(0x258))try{_0x367333=JSON[_0x2fefbb(0x239)](_0x367333);}catch(_0x5cb651){}if(_0x367333&&_0x367333[_0x5d5655])return _0x367333[_0x5d5655];}if(_0x40163f===_0x2fefbb(0x26a)&&_0x5727fd[_0x2fefbb(0x1d7)][_0x2fefbb(0x217)]){let _0xc6a2bd=_0x5727fd['config'][_0x2fefbb(0x217)];if(typeof _0xc6a2bd==='string')try{_0xc6a2bd=JSON[_0x2fefbb(0x239)](_0xc6a2bd);}catch(_0xe5b8ec){}if(_0xc6a2bd&&_0xc6a2bd[_0x5d5655])return _0xc6a2bd[_0x5d5655];}let _0x46a926=[];if(_0x40163f===_0x2fefbb(0x221))_0x46a926=[{'s':_0x2fefbb(0x1f5),'t':_0x2fefbb(0x1ff)},{'s':_0x2fefbb(0x1d8),'t':_0x2fefbb(0x1ff)},{'s':'.1.TEMPERATURE','t':_0x2fefbb(0x1dd)},{'s':_0x2fefbb(0x218),'t':'SET_POINT_TEMPERATURE'},{'s':_0x2fefbb(0x1b8),'t':_0x2fefbb(0x1ea)},{'s':'local_temperature','t':_0x2fefbb(0x1c8)},{'s':_0x2fefbb(0x246),'t':'target_temperature'},{'s':_0x2fefbb(0x22a),'t':_0x2fefbb(0x227)},{'s':'Ist','t':_0x2fefbb(0x223)},{'s':_0x2fefbb(0x246),'t':_0x2fefbb(0x221)}];else _0x40163f===_0x2fefbb(0x26a)&&(_0x46a926=[{'s':_0x2fefbb(0x1f5),'t':_0x2fefbb(0x229)},{'s':_0x2fefbb(0x1d8),'t':_0x2fefbb(0x229)},{'s':_0x2fefbb(0x1d8),'t':_0x2fefbb(0x1c6)},{'s':'local_temperature','t':_0x2fefbb(0x1b1)},{'s':_0x2fefbb(0x246),'t':'valve_position'},{'s':_0x2fefbb(0x246),'t':_0x2fefbb(0x268)}]);for(const _0x3a84d4 of _0x46a926){if(_0x5d5655[_0x2fefbb(0x252)](_0x3a84d4['s'])){const _0x22ac73=_0x5d5655['replace'](_0x3a84d4['s'],_0x3a84d4['t']),_0x473295=await _0x5727fd[_0x2fefbb(0x211)](_0x22ac73);if(_0x473295)return _0x22ac73;}}try{const _0x109074=_0x5d5655[_0x2fefbb(0x255)]('.');if(_0x109074[_0x2fefbb(0x233)]>0x2){const _0xcc3cce=_0x109074[_0x2fefbb(0x20e)](0x0,-0x1)[_0x2fefbb(0x25c)]('.'),_0x718062=await _0x5727fd[_0x2fefbb(0x230)](_0xcc3cce+'.*'),_0x5414c2=[],_0x2a1b1f=_0x5d5655['split'](/[._]+/)[_0x2fefbb(0x262)](_0x993d2d=>!['openknx','0',_0x2fefbb(0x250),_0x2fefbb(0x1e4),_0x2fefbb(0x215),_0x2fefbb(0x246),_0x2fefbb(0x1d2),_0x2fefbb(0x259),_0x2fefbb(0x263),_0x2fefbb(0x1f8)]['includes'](_0x993d2d['toLowerCase']()));for(const [_0xc96d27,_0x429ab0]of Object['entries'](_0x718062)){if(_0xc96d27===_0x5d5655)continue;if(_0x429ab0&&_0x429ab0[_0x2fefbb(0x201)]){const _0x2212f5=_0xc96d27[_0x2fefbb(0x1fe)](),_0x1113a2=(_0x429ab0[_0x2fefbb(0x201)][_0x2fefbb(0x1ca)]||'')[_0x2fefbb(0x1fe)](),_0x283851=(_0x429ab0['common'][_0x2fefbb(0x1b3)]||'')[_0x2fefbb(0x1fe)]();let _0x474d2f=![];if(_0x40163f===_0x2fefbb(0x221)&&_0x429ab0[_0x2fefbb(0x201)][_0x2fefbb(0x1dc)]===!![])_0x474d2f=_0x2212f5[_0x2fefbb(0x252)](_0x2fefbb(0x22c))||_0x2212f5['includes']('soll')||_0x2212f5[_0x2fefbb(0x252)](_0x2fefbb(0x261))||_0x1113a2[_0x2fefbb(0x252)](_0x2fefbb(0x1b4))||_0x1113a2['includes']('thermostat.setpoint');else _0x40163f==='valve'&&(_0x474d2f=_0x2212f5['includes'](_0x2fefbb(0x268))||_0x2212f5[_0x2fefbb(0x252)](_0x2fefbb(0x26a))||_0x2212f5[_0x2fefbb(0x252)](_0x2fefbb(0x23f))||_0x2212f5[_0x2fefbb(0x252)](_0x2fefbb(0x232))||_0x1113a2[_0x2fefbb(0x252)](_0x2fefbb(0x212))||_0x1113a2['includes'](_0x2fefbb(0x225))||_0x283851[_0x2fefbb(0x252)]('%'));if(_0x474d2f){const _0x5a3498=_0xc96d27['split'](/[._]+/)['map'](_0x2a6819=>_0x2a6819[_0x2fefbb(0x1fe)]());let _0x55056c=0x0;_0x2a1b1f[_0x2fefbb(0x1d9)](_0x1a2280=>{const _0x350559=_0x2fefbb;if(_0x5a3498[_0x350559(0x252)](_0x1a2280[_0x350559(0x1fe)]()))_0x55056c++;}),_0x5414c2['push']({'id':_0xc96d27,'score':_0x55056c});}}}if(_0x5414c2['length']>0x0){_0x5414c2['sort']((_0x22d10a,_0x3af7e2)=>_0x3af7e2['score']-_0x22d10a[_0x2fefbb(0x1f6)]);if(_0x5414c2[0x0][_0x2fefbb(0x1f6)]>0x0)return _0x5414c2[0x0]['id'];}}}catch(_0x472fe0){}return null;}function a1_0x51b9(){const _0x4c6743=['¬∞C\x20(via\x20','local_temperature','9wAgMvI','./ai_agent','abs',')\x20aktiv.\x20Heize\x20auf\x20','119602jZmShh','\x20min).','contact','[MPC]\x20','\x20->\x20Schalte\x20','active','summary','4097597gMfCUZ','\x20wieder\x20auf\x20','.4.VALVE_STATE','¬∞C).\x20Sparmodus\x20beendet!','current_heating_setpoint','analysis.energy.ventilationAlerts','role','2168728cjgNkv','\x20auf\x20','date','useCalendar','dimmer','add','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','actual','_meta','isArray','getHours','120ezaLNz','config','.1.TEMPERATURE','forEach','1534940nWqclg','33DUftVM','write','.4.SET_TEMPERATURE','analysis.energy.warmupTargets','thermostatMapping','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','splice','setStateAsync','ist','values','üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','exports','r√ºckkehr','now','occupied_heating_setpoint','findIndex','Calendar\x20Check\x20Error:\x20','[FORCE]\x20','Fehlt','warn','temp','Classic','170358aOoFFj','stringify',':\x20Aufheizen\x20auf\x20','.1.ACTUAL_TEMPERATURE','score','¬∞C\x20(Kalender-Schutz)','state','search','val','getForeignStateAsync','\x20ist\x20auf\x20','¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20','toLowerCase','.1.SET_POINT_TEMPERATURE','too_cold','common','\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.','getTime','¬∞C\x20(nicht\x20','thermostat','\x20wurde\x20manuell\x20erh√∂ht.','Unbekannt','\x20gefunden!','\x20->\x20','üö®\x20[MPC\x20WATCHDOG]\x20','calendarInstance','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20','slice','analysis.energy.warmupTimes','push','getForeignObjectAsync','level.valve','¬∞C!\x20(Puffer:\x20','log','wert','from','valveMapping','ACTUAL_TEMPERATURE','cal_','729244TqIquF','analysis.energy.activeEnforcements','analysis.automation.lastAction','devices','¬∞C).\x20Entferne\x20Status.','default','name','setpoint','PERFECT','Soll','minutes_safe','value.valve','Enforcement\x20Monitor\x20Error:\x20','SET','setForeignStateAsync','.1.LEVEL','ACTUAL','analysis.automation.mode','set','[WATCHDOG]\x20','üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','triggerTime','getForeignObjectsAsync','normal','position','length','analysis.automation.confidenceThreshold','message','consultButler','off','sort','parse','replace','2435624UeeBXa','¬∞C\x20(Vorlauf:\x20','find','_calName','stellwert','location','¬∞C\x20<\x20',':\x20Absenkung\x20auf\x20','eventStart','[CAL]\x20','localeCompare','temperature','\x20erreicht\x20Limit\x20(','open','(((.+)+)+)+$','Pr√§diktion:\x20','getStateAsync','trim','manual','until','calendarSelection','hm-rpc','type','includes','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','mpc_','split','üìÖ\x20SMART\x20SCHEDULE\x20[','event','string','sensor','üìÖ\x20[MPC\x20INFO]\x20','6MRDlNw','join','_date','room','number','.data.table','target','filter','messwert','remove','toString','¬∞C.','urlaub\x20ende','level','entries','valve','sendToPythonWrapper','info',']:\x20Raum-Trigger\x20\x27','pi_heating_demand','Manuelles\x20Mapping','unit','level.temperature','ankunft','rescue_'];a1_0x51b9=function(){return _0x4c6743;};return a1_0x51b9();}async function scanThermostats(_0x48278f){const _0x45c8e7=a1_0xe4dcb5,_0x944b25=_0x48278f[_0x45c8e7(0x1d7)]['devices']||[],_0x43e77a=[],_0x3643f8=_0x944b25['filter'](_0x563397=>_0x563397['id']&&_0x563397['id'][_0x45c8e7(0x252)](_0x45c8e7(0x246))||_0x563397[_0x45c8e7(0x251)]&&[_0x45c8e7(0x246),'thermostat','sensor'][_0x45c8e7(0x252)](_0x563397[_0x45c8e7(0x251)])||_0x563397[_0x45c8e7(0x220)]&&_0x563397[_0x45c8e7(0x220)][_0x45c8e7(0x1fe)]()[_0x45c8e7(0x252)](_0x45c8e7(0x1f0)));for(const _0x5e26d1 of _0x3643f8){const _0x29fdfa=await findRelatedId(_0x48278f,_0x5e26d1['id'],'setpoint'),_0xa35fcd=await findRelatedId(_0x48278f,_0x5e26d1['id'],_0x45c8e7(0x26a));let _0x24cf45='Nicht\x20gefunden',_0x4aafc0=![],_0x3ae412=_0x48278f[_0x45c8e7(0x1d7)][_0x45c8e7(0x1df)]||{};if(typeof _0x3ae412===_0x45c8e7(0x258))try{_0x3ae412=JSON['parse'](_0x3ae412);}catch(_0x7ebc4c){}let _0x1ce7b1=_0x48278f[_0x45c8e7(0x1d7)][_0x45c8e7(0x217)]||{};if(typeof _0x1ce7b1==='string')try{_0x1ce7b1=JSON[_0x45c8e7(0x239)](_0x1ce7b1);}catch(_0x27a772){}if(_0x3ae412[_0x5e26d1['id']]&&_0x3ae412[_0x5e26d1['id']]===_0x29fdfa||_0x1ce7b1[_0x5e26d1['id']]&&_0x1ce7b1[_0x5e26d1['id']]===_0xa35fcd)_0x24cf45=_0x45c8e7(0x1b2),_0x4aafc0=!![];else(_0x29fdfa||_0xa35fcd)&&(_0x24cf45='Auto-Erkennung');_0x43e77a['push']({'room':_0x5e26d1[_0x45c8e7(0x240)]||_0x45c8e7(0x207),'sensorId':_0x5e26d1['id'],'setpointId':_0x29fdfa||'-','valveId':_0xa35fcd||'-','source':_0x24cf45,'isManual':_0x4aafc0,'status':_0x29fdfa&&_0xa35fcd?_0x45c8e7(0x222):_0x29fdfa?'OK':_0x45c8e7(0x1ee)});}return _0x43e77a['sort']((_0x3cabdd,_0x410c2b)=>_0x3cabdd[_0x45c8e7(0x25e)][_0x45c8e7(0x245)](_0x410c2b['room']));}function a1_0x5858(_0x177dda,_0x5efa66){const _0x341c60=a1_0x51b9();return a1_0x5858=function(_0x24dd73,_0x482c52){_0x24dd73=_0x24dd73-0x1b1;let _0x51b984=_0x341c60[_0x24dd73];return _0x51b984;},a1_0x5858(_0x177dda,_0x5efa66);}async function updateSchedulePreview(_0x4091d6){const _0x5e0221=a1_0xe4dcb5;if(!_0x4091d6[_0x5e0221(0x1d7)]['useCalendar']||!_0x4091d6['config']['calendarInstance'])return;let _0x5465b1={};try{const _0x27b615=await _0x4091d6[_0x5e0221(0x24b)](_0x5e0221(0x20f));if(_0x27b615&&_0x27b615[_0x5e0221(0x1fa)])_0x5465b1=JSON[_0x5e0221(0x239)](_0x27b615[_0x5e0221(0x1fa)]);}catch(_0x421d75){}const _0x6bf6e=[],_0x107c3c=Date['now'](),_0x1f8c82=0x30*0x3c*0x3c*0x3e8;try{const _0x4aa3c8=await _0x4091d6['getForeignStateAsync'](_0x4091d6[_0x5e0221(0x1d7)][_0x5e0221(0x20b)]+'.data.table');if(!_0x4aa3c8||!_0x4aa3c8[_0x5e0221(0x1fa)])return;const _0x30dfab=JSON[_0x5e0221(0x239)](_0x4aa3c8['val']),_0x8b560d=_0x4091d6[_0x5e0221(0x1d7)][_0x5e0221(0x24f)]||[],_0x1e3a92=_0x4091d6['config']['devices']||[],_0xa95973=new Set();_0x1e3a92[_0x5e0221(0x1d9)](_0x49094d=>{const _0x313f91=_0x5e0221;if(_0x49094d[_0x313f91(0x240)])_0xa95973[_0x313f91(0x1d0)](_0x49094d[_0x313f91(0x240)]);});for(const _0x297e7c of _0x30dfab){if(_0x297e7c[_0x5e0221(0x23e)]&&_0x8b560d[_0x5e0221(0x233)]>0x0&&!_0x8b560d['includes'](_0x297e7c[_0x5e0221(0x23e)]))continue;const _0x3b9699=_0x297e7c[_0x5e0221(0x25d)]||_0x297e7c['eventStart']||_0x297e7c['date'];if(!_0x3b9699)continue;const _0x56ed8b=new Date(_0x3b9699),_0xbafdee=_0x56ed8b[_0x5e0221(0x203)]();if(isNaN(_0xbafdee))continue;if(_0xbafdee<_0x107c3c)continue;if(_0xbafdee>_0x107c3c+_0x1f8c82)continue;const _0x13e8d5=(_0x297e7c['event']||_0x297e7c['summary']||'')['toLowerCase']();let _0x31f646=![],_0xb112cd=[],_0x15105d=_0x297e7c['event']||_0x297e7c[_0x5e0221(0x1c3)]||_0x5e0221(0x207);if(_0x13e8d5['includes'](_0x5e0221(0x267))||_0x13e8d5['includes'](_0x5e0221(0x1e8))||_0x13e8d5[_0x5e0221(0x252)](_0x5e0221(0x1b5)))_0x31f646=!![],_0xb112cd=Array[_0x5e0221(0x216)](_0xa95973);else for(const _0x23dc6d of _0xa95973){if(_0x13e8d5[_0x5e0221(0x252)](_0x23dc6d[_0x5e0221(0x1fe)]()))_0xb112cd[_0x5e0221(0x210)](_0x23dc6d);}_0xb112cd['length']>0x0&&_0xb112cd[_0x5e0221(0x1d9)](_0x50fa68=>{const _0x131796=_0x5e0221;let _0x5bc107=0x3c;if(_0x31f646){let _0x3bc069=0x0;Object['values'](_0x5465b1)[_0x131796(0x1d9)](_0x59155b=>{if(_0x59155b>_0x3bc069)_0x3bc069=_0x59155b;}),_0x5bc107=_0x3bc069>0x0?_0x3bc069:0x78;}else _0x5bc107=getWarmupRobust(_0x5465b1,_0x50fa68);const _0x4139fc=new Date(_0xbafdee-_0x5bc107*0xea60);_0x6bf6e[_0x131796(0x210)]({'eventTime':_0xbafdee,'triggerTime':_0x4139fc['getTime'](),'room':_0x50fa68,'minutes':_0x5bc107,'reason':_0x15105d,'isGlobal':_0x31f646});});}}catch(_0x4b7521){}_0x6bf6e[_0x5e0221(0x238)]((_0x1ac252,_0x2f9798)=>_0x1ac252[_0x5e0221(0x22f)]-_0x2f9798[_0x5e0221(0x22f)]);const _0x487b66=_0x6bf6e[_0x5e0221(0x20e)](0x0,0x1e);await _0x4091d6['setStateAsync']('analysis.energy.schedulePreview',{'val':JSON[_0x5e0221(0x1f3)](_0x487b66),'ack':!![]});}async function monitorEnforcements(_0x5c0f0e){const _0x3f8500=a1_0xe4dcb5;try{const _0x54a723='analysis.energy.activeEnforcements',_0x37fcf0=await _0x5c0f0e[_0x3f8500(0x24b)](_0x54a723);if(!_0x37fcf0||!_0x37fcf0['val'])return;let _0x869445=[];try{_0x869445=JSON['parse'](_0x37fcf0[_0x3f8500(0x1fa)]);}catch(_0x496bf4){return;}if(!Array[_0x3f8500(0x1d4)](_0x869445)||_0x869445[_0x3f8500(0x233)]===0x0)return;const _0x4caad9=Date[_0x3f8500(0x1e9)](),_0x4b2af3=_0x5c0f0e[_0x3f8500(0x1d7)][_0x3f8500(0x21d)]||[];let _0x2726cd=![];for(let _0x949e5c=_0x869445['length']-0x1;_0x949e5c>=0x0;_0x949e5c--){const _0x57701e=_0x869445[_0x949e5c];if(_0x4caad9>=_0x57701e[_0x3f8500(0x24e)]){_0x5c0f0e[_0x3f8500(0x214)][_0x3f8500(0x26c)](_0x3f8500(0x1e6)+_0x57701e[_0x3f8500(0x25e)]+_0x3f8500(0x1d1)),_0x869445[_0x3f8500(0x1e2)](_0x949e5c,0x1),_0x2726cd=!![];continue;}const _0x4137a4=_0x4b2af3[_0x3f8500(0x23d)](_0x2d5600=>normalize(_0x2d5600[_0x3f8500(0x240)])===normalize(_0x57701e[_0x3f8500(0x25e)])&&(_0x2d5600[_0x3f8500(0x251)]===_0x3f8500(0x246)||_0x2d5600[_0x3f8500(0x251)]===_0x3f8500(0x205)));if(_0x4137a4){const _0x22650e=await findRelatedId(_0x5c0f0e,_0x4137a4['id'],_0x3f8500(0x221));if(_0x22650e){const _0x38ef5f=await _0x5c0f0e['getForeignStateAsync'](_0x22650e);_0x38ef5f&&typeof _0x38ef5f[_0x3f8500(0x1fa)]==='number'&&(_0x38ef5f[_0x3f8500(0x1fa)]<0xf&&(_0x5c0f0e[_0x3f8500(0x214)][_0x3f8500(0x1ef)]('üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20'+_0x57701e[_0x3f8500(0x25e)]+_0x3f8500(0x1cc)+_0x38ef5f[_0x3f8500(0x1fa)]+_0x3f8500(0x1fd)+_0x57701e['target']+_0x3f8500(0x266)),await _0x5c0f0e['setForeignStateAsync'](_0x22650e,_0x57701e['target']),await logAutomationAction(_0x5c0f0e,_0x3f8500(0x1ed)+_0x57701e[_0x3f8500(0x25e)]+':\x20'+_0x38ef5f[_0x3f8500(0x1fa)]+'¬∞C\x20->\x20'+_0x57701e[_0x3f8500(0x261)]+_0x3f8500(0x1f7))));}}}_0x2726cd&&await _0x5c0f0e[_0x3f8500(0x1e3)](_0x54a723,{'val':JSON['stringify'](_0x869445),'ack':!![]});}catch(_0x41b37c){_0x5c0f0e[_0x3f8500(0x214)]['error'](_0x3f8500(0x226)+_0x41b37c[_0x3f8500(0x235)]);}}async function checkCalendarTriggers(_0x4cb135){const _0x5c8b28=a1_0xe4dcb5;if(!_0x4cb135[_0x5c8b28(0x1d7)][_0x5c8b28(0x1ce)]||!_0x4cb135[_0x5c8b28(0x1d7)][_0x5c8b28(0x20b)])return;await updateSchedulePreview(_0x4cb135);let _0x4dc7fa={},_0x11986d={};try{const _0x1783e1=await _0x4cb135[_0x5c8b28(0x24b)](_0x5c8b28(0x20f));if(_0x1783e1&&_0x1783e1[_0x5c8b28(0x1fa)])_0x4dc7fa=JSON[_0x5c8b28(0x239)](_0x1783e1[_0x5c8b28(0x1fa)]);const _0x5aa821=await _0x4cb135[_0x5c8b28(0x24b)]('analysis.energy.warmupSources');if(_0x5aa821&&_0x5aa821[_0x5c8b28(0x1fa)])_0x11986d=JSON['parse'](_0x5aa821[_0x5c8b28(0x1fa)]);}catch(_0x19a5b7){}let _0x15e0d3={'default':0x15};try{const _0x1b9565=await _0x4cb135[_0x5c8b28(0x24b)](_0x5c8b28(0x1de));if(_0x1b9565&&_0x1b9565[_0x5c8b28(0x1fa)])_0x15e0d3=JSON[_0x5c8b28(0x239)](_0x1b9565['val']);}catch(_0x249d1f){}let _0x539aab=[];try{const _0xf21ee9=await _0x4cb135['getStateAsync'](_0x5c8b28(0x21b));if(_0xf21ee9&&_0xf21ee9[_0x5c8b28(0x1fa)])_0x539aab=JSON[_0x5c8b28(0x239)](_0xf21ee9[_0x5c8b28(0x1fa)]);}catch(_0x4cd471){}try{const _0x14a379=await _0x4cb135['getForeignStateAsync'](_0x4cb135[_0x5c8b28(0x1d7)][_0x5c8b28(0x20b)]+_0x5c8b28(0x260));if(!_0x14a379||!_0x14a379[_0x5c8b28(0x1fa)])return;const _0x182e4e=JSON[_0x5c8b28(0x239)](_0x14a379['val']),_0xa600f8=Date['now'](),_0x29e3db=_0x4cb135[_0x5c8b28(0x1d7)]['devices']||[],_0x3b8019=_0x4cb135[_0x5c8b28(0x1d7)][_0x5c8b28(0x24f)]||[];let _0x81a7df=![];for(const _0x161747 of _0x182e4e){if(_0x161747[_0x5c8b28(0x23e)]&&_0x3b8019[_0x5c8b28(0x233)]>0x0&&!_0x3b8019[_0x5c8b28(0x252)](_0x161747['_calName']))continue;const _0x5e654e=_0x161747[_0x5c8b28(0x25d)]||_0x161747[_0x5c8b28(0x243)]||_0x161747[_0x5c8b28(0x1cd)];if(!_0x5e654e)continue;const _0x191909=new Date(_0x5e654e);if(isNaN(_0x191909[_0x5c8b28(0x203)]()))continue;const _0x5b471b=(_0x161747[_0x5c8b28(0x257)]||_0x161747['summary']||'')[_0x5c8b28(0x1fe)]();if(_0x5b471b[_0x5c8b28(0x252)](_0x5c8b28(0x267))||_0x5b471b[_0x5c8b28(0x252)]('r√ºckkehr')||_0x5b471b[_0x5c8b28(0x252)](_0x5c8b28(0x1b5))){let _0x38e3eb=0x0;Object[_0x5c8b28(0x1e5)](_0x4dc7fa)['forEach'](_0x194c79=>{if(_0x194c79>_0x38e3eb)_0x38e3eb=_0x194c79;});if(_0x38e3eb===0x0)_0x38e3eb=0x78;const _0x438a70=_0x191909[_0x5c8b28(0x203)]()-_0x38e3eb*0xea60;_0xa600f8>=_0x438a70&&_0xa600f8<_0x191909[_0x5c8b28(0x203)]()&&(_0x4cb135['currentSystemMode']!==_0x5c8b28(0x231)&&(_0x4cb135[_0x5c8b28(0x214)][_0x5c8b28(0x26c)](_0x5c8b28(0x253)+_0x38e3eb+_0x5c8b28(0x1be)),await _0x4cb135['setStateAsync']('system.mode',{'val':_0x5c8b28(0x231),'ack':![]})));}for(const _0x2a3d5f of _0x29e3db){if(_0x2a3d5f[_0x5c8b28(0x240)]){const _0x15ce2c=_0x2a3d5f[_0x5c8b28(0x240)][_0x5c8b28(0x1fe)](),_0xfae2d=(_0x2a3d5f[_0x5c8b28(0x220)]||'')[_0x5c8b28(0x1fe)]();let _0x2cda21=_0x5b471b[_0x5c8b28(0x252)](_0x15ce2c);!_0x2cda21&&_0xfae2d[_0x5c8b28(0x233)]>0x3&&_0x5b471b[_0x5c8b28(0x252)](_0xfae2d)&&(_0x2cda21=!![]);if(_0x2cda21){const _0x4d62a7=getWarmupRobust(_0x4dc7fa,_0x2a3d5f['location']),_0x28aa0c=_0x11986d[_0x2a3d5f[_0x5c8b28(0x240)]]||_0x5c8b28(0x1f1),_0x379ca5=_0x191909[_0x5c8b28(0x203)]()-_0x4d62a7*0xea60;if(_0xa600f8>=_0x379ca5&&_0xa600f8<_0x191909[_0x5c8b28(0x203)]()){const _0x4bae87=lastActions[_0x5c8b28(0x219)+_0x2a3d5f[_0x5c8b28(0x240)]];if(_0x4bae87&&_0xa600f8-_0x4bae87<CAL_COOLDOWN_MS)continue;const _0x94b93=await findRelatedId(_0x4cb135,_0x2a3d5f['id'],'setpoint');if(_0x94b93){let _0x4031fb=_0x15e0d3[_0x2a3d5f[_0x5c8b28(0x240)]];if(_0x4031fb===undefined)_0x4031fb=_0x15e0d3[_0x5c8b28(0x21f)];if(_0x4031fb===undefined)_0x4031fb=0x15;const _0x4369b1=await _0x4cb135[_0x5c8b28(0x1fb)](_0x94b93);if(_0x4369b1&&typeof _0x4369b1[_0x5c8b28(0x1fa)]===_0x5c8b28(0x25f)&&_0x4369b1['val']<_0x4031fb-0.5){_0x4cb135['log'][_0x5c8b28(0x26c)](_0x5c8b28(0x256)+_0x28aa0c+_0x5c8b28(0x26d)+_0x2a3d5f[_0x5c8b28(0x240)]+'\x27\x20(Match:\x20'+_0x5b471b+_0x5c8b28(0x1bc)+_0x4031fb+_0x5c8b28(0x23c)+_0x4d62a7+_0x5c8b28(0x1be)),await _0x4cb135[_0x5c8b28(0x228)](_0x94b93,_0x4031fb),await logAutomationAction(_0x4cb135,_0x5c8b28(0x244)+_0x2a3d5f['location']+_0x5c8b28(0x209)+_0x4031fb+_0x5c8b28(0x1b7)+_0x28aa0c+')'),lastActions[_0x5c8b28(0x219)+_0x2a3d5f[_0x5c8b28(0x240)]]=_0xa600f8;const _0x58809=_0x539aab[_0x5c8b28(0x1eb)](_0x534b0d=>_0x534b0d[_0x5c8b28(0x25e)]===_0x2a3d5f[_0x5c8b28(0x240)]);if(_0x58809!==-0x1)_0x539aab['splice'](_0x58809,0x1);_0x539aab[_0x5c8b28(0x210)]({'room':_0x2a3d5f[_0x5c8b28(0x240)],'target':_0x4031fb,'until':_0x191909[_0x5c8b28(0x203)]()}),_0x81a7df=!![];}}}}}}}_0x81a7df&&await _0x4cb135[_0x5c8b28(0x1e3)](_0x5c8b28(0x21b),{'val':JSON[_0x5c8b28(0x1f3)](_0x539aab),'ack':!![]});}catch(_0x397726){_0x4cb135[_0x5c8b28(0x214)][_0x5c8b28(0x1ef)](_0x5c8b28(0x1ec)+_0x397726[_0x5c8b28(0x235)]);}}async function manageMpcIntervention(_0x28a645,_0x19fabd,_0x29f6fa){const _0x520183=a1_0xe4dcb5;try{const _0x394e3a='analysis.energy.mpcActiveInterventions',_0x47e9f3=await _0x28a645[_0x520183(0x24b)](_0x394e3a);let _0x32493c=[];if(_0x47e9f3&&_0x47e9f3['val'])try{_0x32493c=JSON[_0x520183(0x239)](_0x47e9f3['val']);}catch(_0x48f947){}const _0x5d3fd5=_0x32493c['indexOf'](_0x19fabd);if(_0x29f6fa===_0x520183(0x1d0))_0x5d3fd5===-0x1&&(_0x32493c[_0x520183(0x210)](_0x19fabd),await _0x28a645[_0x520183(0x1e3)](_0x394e3a,{'val':JSON['stringify'](_0x32493c),'ack':!![]}));else _0x29f6fa==='remove'&&(_0x5d3fd5!==-0x1&&(_0x32493c['splice'](_0x5d3fd5,0x1),await _0x28a645['setStateAsync'](_0x394e3a,{'val':JSON['stringify'](_0x32493c),'ack':!![]})));}catch(_0x387902){}}async function cleanupGhostInterventions(_0x27e79e){const _0x3b0e51=a1_0xe4dcb5;try{const _0x1fbbc7='analysis.energy.mpcActiveInterventions',_0x3e2eac=await _0x27e79e[_0x3b0e51(0x24b)](_0x1fbbc7);if(!_0x3e2eac||!_0x3e2eac[_0x3b0e51(0x1fa)])return;const _0x120a94=JSON[_0x3b0e51(0x239)](_0x3e2eac[_0x3b0e51(0x1fa)]);if(!Array[_0x3b0e51(0x1d4)](_0x120a94)||_0x120a94['length']===0x0)return;let _0x50335a={'default':0x15};try{const _0x5bef8e=await _0x27e79e['getStateAsync'](_0x3b0e51(0x1de));if(_0x5bef8e&&_0x5bef8e['val'])_0x50335a=JSON[_0x3b0e51(0x239)](_0x5bef8e[_0x3b0e51(0x1fa)]);}catch(_0x215420){}let _0x51b328=[];try{const _0x33bd4b=await _0x27e79e[_0x3b0e51(0x24b)](_0x3b0e51(0x1c9));if(_0x33bd4b&&_0x33bd4b[_0x3b0e51(0x1fa)])_0x51b328=JSON['parse'](_0x33bd4b['val']);}catch(_0x117f23){}let _0x126f5c={},_0x4d73c5=![];try{const _0x110049=await _0x27e79e[_0x3b0e51(0x24b)]('analysis.energy.rlPenalties');if(_0x110049&&_0x110049[_0x3b0e51(0x1fa)])_0x126f5c=JSON['parse'](_0x110049[_0x3b0e51(0x1fa)]);}catch(_0x4f03bf){}if(_0x126f5c[_0x3b0e51(0x1d3)]){const _0x43c551=Date[_0x3b0e51(0x1e9)]();for(const [_0x43c5d1,_0x3e7634]of Object[_0x3b0e51(0x269)](_0x126f5c[_0x3b0e51(0x1d3)])){_0x43c551-_0x3e7634>PENALTY_TTL&&(delete _0x126f5c[_0x43c5d1],delete _0x126f5c[_0x3b0e51(0x1d3)][_0x43c5d1],_0x4d73c5=!![],_0x27e79e[_0x3b0e51(0x214)][_0x3b0e51(0x26c)](_0x3b0e51(0x1e0)+_0x43c5d1+'\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.'));}}const _0x5603f8=_0x27e79e[_0x3b0e51(0x1d7)]['devices']||[];let _0x4fd406=![];for(let _0xb60a49=_0x120a94[_0x3b0e51(0x233)]-0x1;_0xb60a49>=0x0;_0xb60a49--){const _0x399ff9=_0x120a94[_0xb60a49],_0x243af3=_0x5603f8[_0x3b0e51(0x23d)](_0x56e79d=>normalize(_0x56e79d['location'])===normalize(_0x399ff9)&&(_0x56e79d[_0x3b0e51(0x251)]===_0x3b0e51(0x246)||_0x56e79d[_0x3b0e51(0x251)]===_0x3b0e51(0x205)));if(!_0x243af3){_0x27e79e[_0x3b0e51(0x214)][_0x3b0e51(0x1ef)]('üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27'+_0x399ff9+'\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.'),_0x120a94['splice'](_0xb60a49,0x1),_0x4fd406=!![];continue;}if(_0x243af3){const _0x248e3a=await findRelatedId(_0x27e79e,_0x243af3['id'],'setpoint'),_0x8f48ff=await _0x27e79e[_0x3b0e51(0x1fb)](_0x243af3['id']);if(_0x248e3a){const _0x158719=await _0x27e79e['getForeignStateAsync'](_0x248e3a);if(_0x158719&&typeof _0x158719[_0x3b0e51(0x1fa)]===_0x3b0e51(0x25f)){let _0x1d93de=![],_0x2fbde7='';Math[_0x3b0e51(0x1bb)](_0x158719['val']-ECO_TEMP)>0.5&&(_0x1d93de=!![],_0x2fbde7=_0x3b0e51(0x24d));if(!_0x1d93de&&_0x8f48ff&&typeof _0x8f48ff[_0x3b0e51(0x1fa)]===_0x3b0e51(0x25f)){const _0x5ea749=_0x50335a[_0x399ff9]||_0x50335a[_0x3b0e51(0x21f)]||0x15;_0x8f48ff[_0x3b0e51(0x1fa)]<_0x5ea749+0.2&&(_0x1d93de=!![],_0x2fbde7='too_cold');}if(_0x1d93de){if(_0x2fbde7===_0x3b0e51(0x24d)){_0x27e79e[_0x3b0e51(0x214)][_0x3b0e51(0x26c)]('üßπ\x20[MPC\x20CLEANUP]\x20'+_0x399ff9+_0x3b0e51(0x1fc)+_0x158719['val']+_0x3b0e51(0x204)+ECO_TEMP+_0x3b0e51(0x21e));const _0x1900c8=lastActions['cal_'+_0x399ff9],_0x4769cd=_0x1900c8&&Date['now']()-_0x1900c8<0x2*0x3c*0x3e8;if(!_0x4769cd&&_0x158719[_0x3b0e51(0x1fa)]>ECO_TEMP+0.5){_0x27e79e[_0x3b0e51(0x26b)]&&(_0x27e79e[_0x3b0e51(0x214)][_0x3b0e51(0x26c)](_0x3b0e51(0x22e)+_0x399ff9+_0x3b0e51(0x206)),_0x27e79e[_0x3b0e51(0x26b)]('TRAIN_RL_PENALTY',{'room':_0x399ff9}));const _0x1bcd33=_0x399ff9+'_'+new Date()[_0x3b0e51(0x1d5)]();if(!_0x126f5c[_0x1bcd33]){_0x126f5c[_0x1bcd33]=0x1;if(!_0x126f5c[_0x3b0e51(0x1d3)])_0x126f5c[_0x3b0e51(0x1d3)]={};_0x126f5c[_0x3b0e51(0x1d3)][_0x1bcd33]=Date[_0x3b0e51(0x1e9)](),_0x4d73c5=!![];}}else _0x4769cd&&_0x27e79e[_0x3b0e51(0x214)][_0x3b0e51(0x26c)](_0x3b0e51(0x25a)+_0x399ff9+_0x3b0e51(0x202));}else{if(_0x2fbde7===_0x3b0e51(0x200)){let _0x2b4ebe=![];if(_0x51b328['find'](_0x2946cc=>_0x2946cc['room']===_0x399ff9))_0x2b4ebe=!![];const _0xe92a05=_0x5603f8[_0x3b0e51(0x262)](_0x1e9b77=>normalize(_0x1e9b77['location'])===normalize(_0x399ff9)&&(_0x1e9b77[_0x3b0e51(0x251)]==='window'||_0x1e9b77[_0x3b0e51(0x251)]==='sensor'||_0x1e9b77[_0x3b0e51(0x251)]===_0x3b0e51(0x1bf)));for(const _0x503e4c of _0xe92a05){try{const _0x48e14b=await _0x27e79e['getForeignStateAsync'](_0x503e4c['id']);if(_0x48e14b&&(_0x48e14b['val']===!![]||_0x48e14b[_0x3b0e51(0x1fa)]===0x1||String(_0x48e14b[_0x3b0e51(0x1fa)])[_0x3b0e51(0x1fe)]()===_0x3b0e51(0x248)))_0x2b4ebe=!![];}catch(_0x2d6be9){}}if(_0x2b4ebe)_0x27e79e[_0x3b0e51(0x214)][_0x3b0e51(0x26c)](_0x3b0e51(0x20d)+_0x399ff9+_0x3b0e51(0x20c));else{const _0x5d1fb4=_0x50335a[_0x399ff9]||_0x50335a[_0x3b0e51(0x21f)]||0x15;_0x27e79e['log']['info'](_0x3b0e51(0x20a)+_0x399ff9+_0x3b0e51(0x247)+_0x8f48ff[_0x3b0e51(0x1fa)]+_0x3b0e51(0x241)+(_0x5d1fb4+0.2)+_0x3b0e51(0x1c7)),await _0x27e79e[_0x3b0e51(0x228)](_0x248e3a,_0x5d1fb4),await logAutomationAction(_0x27e79e,_0x3b0e51(0x22d)+_0x399ff9+_0x3b0e51(0x1e1)+_0x5d1fb4+'¬∞C'),lastActions['rescue_'+_0x399ff9]=Date[_0x3b0e51(0x1e9)]();}}}_0x120a94[_0x3b0e51(0x1e2)](_0xb60a49,0x1),_0x4fd406=!![];}}}}}_0x4fd406&&await _0x27e79e[_0x3b0e51(0x1e3)](_0x1fbbc7,{'val':JSON[_0x3b0e51(0x1f3)](_0x120a94),'ack':!![]}),_0x4d73c5&&await _0x27e79e[_0x3b0e51(0x1e3)]('analysis.energy.rlPenalties',{'val':JSON[_0x3b0e51(0x1f3)](_0x126f5c),'ack':!![]});}catch(_0x186813){}}async function applyEnergySavings(_0x4b3048,_0x118685){const _0x17fe4d=a1_0xe4dcb5;await cleanupGhostInterventions(_0x4b3048);if(!_0x118685||_0x118685['length']===0x0)return;const _0x577161=_0x4b3048[_0x17fe4d(0x1d7)]['devices']||[],_0x364587=Date[_0x17fe4d(0x1e9)]();for(const _0x4e82b2 of _0x118685){const _0x1ab86d=_0x4e82b2[_0x17fe4d(0x25e)],_0x11a45b=_0x4e82b2[_0x17fe4d(0x224)],_0x4d0e53=_0x4e82b2[_0x17fe4d(0x261)]||0x15;if(lastActions['rescue_'+_0x1ab86d]&&_0x364587-lastActions[_0x17fe4d(0x1b6)+_0x1ab86d]<RESCUE_LOCK_MS)continue;const _0x12be63=_0x577161[_0x17fe4d(0x23d)](_0x319c34=>normalize(_0x319c34[_0x17fe4d(0x240)])===normalize(_0x1ab86d)&&(_0x319c34['type']===_0x17fe4d(0x246)||_0x319c34['type']===_0x17fe4d(0x205)));if(!_0x12be63)continue;const _0x2a01ab=await findRelatedId(_0x4b3048,_0x12be63['id'],'setpoint');if(_0x2a01ab){if(lastActions['mpc_'+_0x1ab86d]&&_0x364587-lastActions[_0x17fe4d(0x254)+_0x1ab86d]<0x1e*0x3c*0x3e8)continue;const _0x22a644=await _0x4b3048[_0x17fe4d(0x1fb)](_0x2a01ab);if(_0x22a644&&typeof _0x22a644['val']==='number'){const _0x383d78=_0x22a644[_0x17fe4d(0x1fa)];_0x383d78!==ECO_TEMP&&await manageMpcIntervention(_0x4b3048,_0x1ab86d,_0x17fe4d(0x264));if(_0x11a45b>0x1e)_0x383d78>ECO_TEMP+0.5&&(_0x4b3048['log'][_0x17fe4d(0x26c)]('üçÉ\x20[MPC\x20ACTION]\x20Senke\x20'+_0x1ab86d+'\x20auf\x20'+ECO_TEMP+_0x17fe4d(0x213)+_0x11a45b+'\x20min)'),await _0x4b3048[_0x17fe4d(0x228)](_0x2a01ab,ECO_TEMP),await manageMpcIntervention(_0x4b3048,_0x1ab86d,_0x17fe4d(0x1d0)),lastActions['mpc_'+_0x1ab86d]=_0x364587,await logAutomationAction(_0x4b3048,'[MPC]\x20'+_0x1ab86d+_0x17fe4d(0x242)+ECO_TEMP+'¬∞C'));else _0x11a45b<=0xf&&(_0x383d78<_0x4d0e53&&(_0x4b3048[_0x17fe4d(0x214)][_0x17fe4d(0x26c)]('üî•\x20[MPC\x20ACTION]\x20Heize\x20'+_0x1ab86d+_0x17fe4d(0x1c5)+_0x4d0e53+'¬∞C!\x20(Puffer\x20leer).'),await _0x4b3048[_0x17fe4d(0x228)](_0x2a01ab,_0x4d0e53),await manageMpcIntervention(_0x4b3048,_0x1ab86d,_0x17fe4d(0x264)),lastActions[_0x17fe4d(0x254)+_0x1ab86d]=_0x364587,await logAutomationAction(_0x4b3048,_0x17fe4d(0x1c0)+_0x1ab86d+_0x17fe4d(0x1f4)+_0x4d0e53+'¬∞C')));}}else _0x4b3048[_0x17fe4d(0x214)][_0x17fe4d(0x1ef)]('[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20'+_0x1ab86d+_0x17fe4d(0x208));}}module[a1_0xe4dcb5(0x1e7)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};