const a1_0x34a2ed=a1_0x5d88;(function(_0x4fc771,_0x548274){const _0x251193=a1_0x5d88,_0x300c04=_0x4fc771();while(!![]){try{const _0x55b556=parseInt(_0x251193(0x113))/0x1+parseInt(_0x251193(0xf7))/0x2*(parseInt(_0x251193(0xc6))/0x3)+-parseInt(_0x251193(0xb5))/0x4*(-parseInt(_0x251193(0xa4))/0x5)+-parseInt(_0x251193(0xaf))/0x6*(-parseInt(_0x251193(0xf4))/0x7)+parseInt(_0x251193(0xcc))/0x8+parseInt(_0x251193(0xe6))/0x9+-parseInt(_0x251193(0x12a))/0xa*(parseInt(_0x251193(0x121))/0xb);if(_0x55b556===_0x548274)break;else _0x300c04['push'](_0x300c04['shift']());}catch(_0x1ffda6){_0x300c04['push'](_0x300c04['shift']());}}}(a1_0x4763,0x485d2));const a1_0x1e9af8=(function(){let _0x417df6=!![];return function(_0x26a50b,_0x2bc2d0){const _0x27ea03=_0x417df6?function(){if(_0x2bc2d0){const _0x291a8b=_0x2bc2d0['apply'](_0x26a50b,arguments);return _0x2bc2d0=null,_0x291a8b;}}:function(){};return _0x417df6=![],_0x27ea03;};}()),a1_0x4573f9=a1_0x1e9af8(this,function(){const _0x5c290b=a1_0x5d88;return a1_0x4573f9[_0x5c290b(0x11d)]()[_0x5c290b(0x12f)](_0x5c290b(0x7e))['toString']()[_0x5c290b(0xff)](a1_0x4573f9)[_0x5c290b(0x12f)](_0x5c290b(0x7e));});a1_0x4573f9();'use strict';const aiAgent=require(a1_0x34a2ed(0xac)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x333f42){const _0x4015ed=a1_0x34a2ed;if(!_0x333f42)return'';return _0x333f42[_0x4015ed(0xd6)]()[_0x4015ed(0xf8)](/\s+/g,'')['trim']();}function getWarmupRobust(_0x117ca1,_0x5c7e9e){const _0x3fcd35=a1_0x34a2ed;if(!_0x117ca1||!_0x5c7e9e)return 0x3c;if(_0x117ca1[_0x5c7e9e]!==undefined)return _0x117ca1[_0x5c7e9e];const _0x4dd3b9=_0x5c7e9e[_0x3fcd35(0xd6)]()['replace'](/Ã¤/g,'ae')[_0x3fcd35(0xf8)](/Ã¶/g,'oe')[_0x3fcd35(0xf8)](/Ã¼/g,'ue')[_0x3fcd35(0xf8)](/ÃŸ/g,'ss')['replace'](/\s+/g,'_')[_0x3fcd35(0xf8)](/[^a-z0-9_]/g,'');if(_0x117ca1[_0x4dd3b9]!==undefined)return _0x117ca1[_0x4dd3b9];return 0x3c;}async function logAutomationAction(_0x4ab8ce,_0x4cb01b){const _0x32aad7=a1_0x34a2ed;await _0x4ab8ce[_0x32aad7(0xaa)](_0x32aad7(0x109),{'val':_0x4cb01b,'ack':!![]});try{const _0x44bcfb=_0x32aad7(0x83),_0x4ffc63=await _0x4ab8ce[_0x32aad7(0x8b)](_0x44bcfb);let _0x2903ec=[];if(_0x4ffc63&&_0x4ffc63['val'])try{_0x2903ec=JSON[_0x32aad7(0xb3)](_0x4ffc63['val']);}catch(_0xcb3c4c){}_0x2903ec['unshift']({'ts':Date[_0x32aad7(0x139)](),'msg':_0x4cb01b});if(_0x2903ec[_0x32aad7(0xd9)]>0x32)_0x2903ec=_0x2903ec[_0x32aad7(0xa3)](0x0,0x32);await _0x4ab8ce['setStateAsync'](_0x44bcfb,{'val':JSON['stringify'](_0x2903ec),'ack':!![]});}catch(_0x1804fe){}}async function handlePrediction(_0x25188a,_0x30bb84,_0x403ddd){const _0x172dd0=a1_0x34a2ed;if(!_0x30bb84||_0x30bb84===_0x172dd0(0x102))return;let _0x506d56=_0x172dd0(0x12e),_0x2d5f67=0.6;try{const _0x4cb416=await _0x25188a[_0x172dd0(0x8b)](_0x172dd0(0xe8));if(_0x4cb416&&_0x4cb416[_0x172dd0(0x123)])_0x506d56=_0x4cb416[_0x172dd0(0x123)];const _0x1778fc=await _0x25188a[_0x172dd0(0x8b)](_0x172dd0(0xab));if(_0x1778fc&&_0x1778fc[_0x172dd0(0x123)])_0x2d5f67=_0x1778fc[_0x172dd0(0x123)];}catch(_0xfa5332){}if(_0x506d56==='off'||_0x403ddd<_0x2d5f67)return;const _0xa968b9=Date['now']();if(lastActions[_0x30bb84]&&_0xa968b9-lastActions[_0x30bb84]<COOLDOWN_MS)return;const _0x1e1be6=_0x25188a[_0x172dd0(0xdd)][_0x172dd0(0x8f)]||[],_0x43e721=normalize(_0x30bb84),_0x3209c0=_0x1e1be6[_0x172dd0(0x89)](_0xe733e5=>normalize(_0xe733e5['location'])===_0x43e721&&(_0xe733e5[_0x172dd0(0x115)]===_0x172dd0(0x99)||_0xe733e5[_0x172dd0(0x115)]===_0x172dd0(0x11b)||_0xe733e5[_0x172dd0(0x115)]==='switch'));if(!_0x3209c0)return;const _0x158eb4=await aiAgent['consultButler'](_0x25188a,_0x30bb84,_0x3209c0['name'],_0x403ddd);if(!_0x158eb4['approved'])return;const _0x21f10a=_0x172dd0(0x88)+_0x30bb84+_0x172dd0(0xee)+_0x3209c0[_0x172dd0(0xdc)]+'\x20('+_0x158eb4['reason']+')';await logAutomationAction(_0x25188a,'['+_0x506d56[_0x172dd0(0x91)]()+']\x20'+_0x21f10a);if(_0x506d56==='active'){const _0x10fb0d=await _0x25188a['getForeignStateAsync'](_0x3209c0['id']);(!_0x10fb0d||!_0x10fb0d[_0x172dd0(0x123)]&&_0x10fb0d['val']!==!![])&&await _0x25188a['setForeignStateAsync'](_0x3209c0['id'],!![]),lastActions[_0x30bb84]=_0xa968b9;}}function a1_0x5d88(_0x19c716,_0x54b4de){const _0x1bb867=a1_0x4763();return a1_0x5d88=function(_0x4573f9,_0x1e9af8){_0x4573f9=_0x4573f9-0x7e;let _0x47637c=_0x1bb867[_0x4573f9];return _0x47637c;},a1_0x5d88(_0x19c716,_0x54b4de);}async function findRelatedId(_0x3e7e42,_0x2c85fa,_0x4ffa3d=a1_0x34a2ed(0xf9)){const _0x5ede0c=a1_0x34a2ed;if(_0x4ffa3d===_0x5ede0c(0xf9)&&_0x3e7e42[_0x5ede0c(0xdd)][_0x5ede0c(0x130)]){let _0x3d2a6c=_0x3e7e42[_0x5ede0c(0xdd)][_0x5ede0c(0x130)];if(typeof _0x3d2a6c===_0x5ede0c(0x93))try{_0x3d2a6c=JSON[_0x5ede0c(0xb3)](_0x3d2a6c);}catch(_0x4f0891){}if(_0x3d2a6c&&_0x3d2a6c[_0x2c85fa])return _0x3d2a6c[_0x2c85fa];}if(_0x4ffa3d===_0x5ede0c(0x126)&&_0x3e7e42[_0x5ede0c(0xdd)]['valveMapping']){let _0x46a898=_0x3e7e42[_0x5ede0c(0xdd)][_0x5ede0c(0xf3)];if(typeof _0x46a898==='string')try{_0x46a898=JSON[_0x5ede0c(0xb3)](_0x46a898);}catch(_0x2be0ce){}if(_0x46a898&&_0x46a898[_0x2c85fa])return _0x46a898[_0x2c85fa];}let _0x1ebba3=[];if(_0x4ffa3d===_0x5ede0c(0xf9))_0x1ebba3=[{'s':_0x5ede0c(0xcf),'t':_0x5ede0c(0xc4)},{'s':_0x5ede0c(0xf2),'t':_0x5ede0c(0xc4)},{'s':_0x5ede0c(0xf2),'t':_0x5ede0c(0x10b)},{'s':_0x5ede0c(0x100),'t':_0x5ede0c(0x9d)},{'s':'local_temperature','t':_0x5ede0c(0xfd)},{'s':_0x5ede0c(0xa7),'t':_0x5ede0c(0xf0)},{'s':_0x5ede0c(0xb0),'t':_0x5ede0c(0x138)},{'s':_0x5ede0c(0xb7),'t':_0x5ede0c(0xae)},{'s':'Ist','t':_0x5ede0c(0x13a)},{'s':_0x5ede0c(0xb0),'t':'setpoint'}];else _0x4ffa3d==='valve'&&(_0x1ebba3=[{'s':_0x5ede0c(0xcf),'t':_0x5ede0c(0xd2)},{'s':_0x5ede0c(0xf2),'t':_0x5ede0c(0xd2)},{'s':_0x5ede0c(0xf2),'t':_0x5ede0c(0xa5)},{'s':_0x5ede0c(0xa7),'t':_0x5ede0c(0x101)},{'s':'temperature','t':_0x5ede0c(0x114)},{'s':_0x5ede0c(0xb0),'t':_0x5ede0c(0x13e)}]);for(const _0x21d51d of _0x1ebba3){if(_0x2c85fa[_0x5ede0c(0xc0)](_0x21d51d['s'])){const _0x40a25b=_0x2c85fa[_0x5ede0c(0xf8)](_0x21d51d['s'],_0x21d51d['t']),_0x5432e8=await _0x3e7e42['getForeignObjectAsync'](_0x40a25b);if(_0x5432e8)return _0x40a25b;}}try{const _0x24e488=_0x2c85fa['split']('.');if(_0x24e488[_0x5ede0c(0xd9)]>0x2){const _0x4203f1=_0x24e488[_0x5ede0c(0xa3)](0x0,-0x1)[_0x5ede0c(0xe9)]('.'),_0x54d855=await _0x3e7e42[_0x5ede0c(0x11e)](_0x4203f1+'.*'),_0x1ce1b6=[],_0x1ea665=_0x2c85fa[_0x5ede0c(0xc7)](/[._]+/)['filter'](_0x1321c7=>![_0x5ede0c(0xb2),'0',_0x5ede0c(0x9b),_0x5ede0c(0x129),'wert','temperature','actual',_0x5ede0c(0xbd),_0x5ede0c(0x8c),'state'][_0x5ede0c(0xc0)](_0x1321c7[_0x5ede0c(0xd6)]()));for(const [_0xc7e95c,_0x2ba996]of Object['entries'](_0x54d855)){if(_0xc7e95c===_0x2c85fa)continue;if(_0x2ba996&&_0x2ba996[_0x5ede0c(0xa2)]){const _0x21375b=_0xc7e95c[_0x5ede0c(0xd6)](),_0x16f2e5=(_0x2ba996['common'][_0x5ede0c(0xa6)]||'')['toLowerCase'](),_0x892cd8=(_0x2ba996['common'][_0x5ede0c(0x13f)]||'')['toLowerCase']();let _0x15c89e=![];if(_0x4ffa3d===_0x5ede0c(0xf9)&&_0x2ba996['common']['write']===!![])_0x15c89e=_0x21375b[_0x5ede0c(0xc0)](_0x5ede0c(0xcb))||_0x21375b[_0x5ede0c(0xc0)]('soll')||_0x21375b[_0x5ede0c(0xc0)](_0x5ede0c(0x142))||_0x16f2e5[_0x5ede0c(0xc0)](_0x5ede0c(0xc5))||_0x16f2e5[_0x5ede0c(0xc0)](_0x5ede0c(0x7f));else _0x4ffa3d==='valve'&&(_0x15c89e=_0x21375b[_0x5ede0c(0xc0)](_0x5ede0c(0x13e))||_0x21375b[_0x5ede0c(0xc0)](_0x5ede0c(0x126))||_0x21375b[_0x5ede0c(0xc0)](_0x5ede0c(0x117))||_0x21375b['includes'](_0x5ede0c(0x13c))||_0x16f2e5[_0x5ede0c(0xc0)](_0x5ede0c(0x96))||_0x16f2e5[_0x5ede0c(0xc0)](_0x5ede0c(0x10e))||_0x892cd8[_0x5ede0c(0xc0)]('%'));if(_0x15c89e){const _0x276460=_0xc7e95c[_0x5ede0c(0xc7)](/[._]+/)['map'](_0x18df9e=>_0x18df9e[_0x5ede0c(0xd6)]());let _0x26c543=0x0;_0x1ea665[_0x5ede0c(0xc2)](_0x23854c=>{const _0x3acd9f=_0x5ede0c;if(_0x276460[_0x3acd9f(0xc0)](_0x23854c['toLowerCase']()))_0x26c543++;}),_0x1ce1b6[_0x5ede0c(0x124)]({'id':_0xc7e95c,'score':_0x26c543});}}}if(_0x1ce1b6['length']>0x0){_0x1ce1b6['sort']((_0x1fe5ce,_0x47c03)=>_0x47c03[_0x5ede0c(0xb6)]-_0x1fe5ce[_0x5ede0c(0xb6)]);if(_0x1ce1b6[0x0][_0x5ede0c(0xb6)]>0x0)return _0x1ce1b6[0x0]['id'];}}}catch(_0x2f82fa){}return null;}async function scanThermostats(_0x12a22f){const _0x12e36f=a1_0x34a2ed,_0x3664ae=_0x12a22f[_0x12e36f(0xdd)][_0x12e36f(0x8f)]||[],_0x2d391c=[],_0x12263c=_0x3664ae['filter'](_0x2ea69e=>_0x2ea69e['id']&&_0x2ea69e['id'][_0x12e36f(0xc0)](_0x12e36f(0xb0))||_0x2ea69e[_0x12e36f(0x115)]&&[_0x12e36f(0xb0),_0x12e36f(0xc3),_0x12e36f(0xbd)][_0x12e36f(0xc0)](_0x2ea69e[_0x12e36f(0x115)])||_0x2ea69e['name']&&_0x2ea69e[_0x12e36f(0xdc)][_0x12e36f(0xd6)]()[_0x12e36f(0xc0)](_0x12e36f(0xd4)));for(const _0x45c4b5 of _0x12263c){const _0x4111ae=await findRelatedId(_0x12a22f,_0x45c4b5['id'],_0x12e36f(0xf9)),_0xf2ac34=await findRelatedId(_0x12a22f,_0x45c4b5['id'],'valve');let _0x6ad7a2=_0x12e36f(0x11c),_0x3974d3=![],_0xf1ca5e=_0x12a22f[_0x12e36f(0xdd)][_0x12e36f(0x130)]||{};if(typeof _0xf1ca5e===_0x12e36f(0x93))try{_0xf1ca5e=JSON['parse'](_0xf1ca5e);}catch(_0x312bc5){}let _0x57ab48=_0x12a22f[_0x12e36f(0xdd)]['valveMapping']||{};if(typeof _0x57ab48===_0x12e36f(0x93))try{_0x57ab48=JSON[_0x12e36f(0xb3)](_0x57ab48);}catch(_0x554989){}if(_0xf1ca5e[_0x45c4b5['id']]&&_0xf1ca5e[_0x45c4b5['id']]===_0x4111ae||_0x57ab48[_0x45c4b5['id']]&&_0x57ab48[_0x45c4b5['id']]===_0xf2ac34)_0x6ad7a2=_0x12e36f(0xc1),_0x3974d3=!![];else(_0x4111ae||_0xf2ac34)&&(_0x6ad7a2=_0x12e36f(0x119));_0x2d391c['push']({'room':_0x45c4b5[_0x12e36f(0xce)]||'Unbekannt','sensorId':_0x45c4b5['id'],'setpointId':_0x4111ae||'-','valveId':_0xf2ac34||'-','source':_0x6ad7a2,'isManual':_0x3974d3,'status':_0x4111ae&&_0xf2ac34?_0x12e36f(0x81):_0x4111ae?'OK':'Fehlt'});}return _0x2d391c[_0x12e36f(0x13d)]((_0x386c59,_0x4377c2)=>_0x386c59[_0x12e36f(0x104)][_0x12e36f(0xe0)](_0x4377c2['room']));}async function updateSchedulePreview(_0x1b4f78){const _0x1d53f2=a1_0x34a2ed;if(!_0x1b4f78['config'][_0x1d53f2(0xe2)]||!_0x1b4f78[_0x1d53f2(0xdd)][_0x1d53f2(0x116)])return;let _0x265d9e={};try{const _0x5db2c5=await _0x1b4f78[_0x1d53f2(0x8b)]('analysis.energy.warmupTimes');if(_0x5db2c5&&_0x5db2c5[_0x1d53f2(0x123)])_0x265d9e=JSON[_0x1d53f2(0xb3)](_0x5db2c5[_0x1d53f2(0x123)]);}catch(_0x489513){}const _0x22444d=[],_0x15b9aa=Date[_0x1d53f2(0x139)](),_0x30a3bb=0x30*0x3c*0x3c*0x3e8;try{const _0xa45e23=await _0x1b4f78[_0x1d53f2(0x10c)](_0x1b4f78['config']['calendarInstance']+_0x1d53f2(0x108));if(!_0xa45e23||!_0xa45e23[_0x1d53f2(0x123)])return;const _0x73acbe=JSON[_0x1d53f2(0xb3)](_0xa45e23[_0x1d53f2(0x123)]),_0x4178b4=_0x1b4f78[_0x1d53f2(0xdd)][_0x1d53f2(0x140)]||[],_0x536314=_0x1b4f78[_0x1d53f2(0xdd)]['devices']||[],_0x1cf143=new Set();_0x536314['forEach'](_0x45cd5a=>{const _0x281faa=_0x1d53f2;if(_0x45cd5a['location'])_0x1cf143[_0x281faa(0xbb)](_0x45cd5a['location']);});for(const _0x55f51b of _0x73acbe){if(_0x55f51b[_0x1d53f2(0xed)]&&_0x4178b4[_0x1d53f2(0xd9)]>0x0&&!_0x4178b4[_0x1d53f2(0xc0)](_0x55f51b[_0x1d53f2(0xed)]))continue;const _0xd2d6f6=_0x55f51b['_date']||_0x55f51b[_0x1d53f2(0xea)]||_0x55f51b[_0x1d53f2(0x107)];if(!_0xd2d6f6)continue;const _0x2021be=new Date(_0xd2d6f6),_0x1841ff=_0x2021be[_0x1d53f2(0x8d)]();if(isNaN(_0x1841ff))continue;if(_0x1841ff<_0x15b9aa)continue;if(_0x1841ff>_0x15b9aa+_0x30a3bb)continue;const _0x15e71c=(_0x55f51b[_0x1d53f2(0xec)]||_0x55f51b[_0x1d53f2(0xfc)]||'')[_0x1d53f2(0xd6)]();let _0x3a814e=![],_0x5b2818=[],_0x506aae=_0x55f51b[_0x1d53f2(0xec)]||_0x55f51b['summary']||_0x1d53f2(0x10d);if(_0x15e71c[_0x1d53f2(0xc0)]('urlaub\x20ende')||_0x15e71c[_0x1d53f2(0xc0)]('rÃ¼ckkehr')||_0x15e71c['includes'](_0x1d53f2(0xa0)))_0x3a814e=!![],_0x5b2818=Array[_0x1d53f2(0x94)](_0x1cf143);else for(const _0x3305ee of _0x1cf143){if(_0x15e71c[_0x1d53f2(0xc0)](_0x3305ee[_0x1d53f2(0xd6)]()))_0x5b2818[_0x1d53f2(0x124)](_0x3305ee);}_0x5b2818['length']>0x0&&_0x5b2818[_0x1d53f2(0xc2)](_0x56cae8=>{const _0x248ca5=_0x1d53f2;let _0x32dc0f=0x3c;if(_0x3a814e){let _0x5a1632=0x0;Object['values'](_0x265d9e)[_0x248ca5(0xc2)](_0x4f308a=>{if(_0x4f308a>_0x5a1632)_0x5a1632=_0x4f308a;}),_0x32dc0f=_0x5a1632>0x0?_0x5a1632:0x78;}else _0x32dc0f=getWarmupRobust(_0x265d9e,_0x56cae8);const _0x39329b=new Date(_0x1841ff-_0x32dc0f*0xea60);_0x22444d['push']({'eventTime':_0x1841ff,'triggerTime':_0x39329b[_0x248ca5(0x8d)](),'room':_0x56cae8,'minutes':_0x32dc0f,'reason':_0x506aae,'isGlobal':_0x3a814e});});}}catch(_0x30c219){}_0x22444d[_0x1d53f2(0x13d)]((_0x40ff94,_0x132aa4)=>_0x40ff94['triggerTime']-_0x132aa4[_0x1d53f2(0xe7)]);const _0x2dad48=_0x22444d['slice'](0x0,0x1e);await _0x1b4f78[_0x1d53f2(0xaa)](_0x1d53f2(0xda),{'val':JSON['stringify'](_0x2dad48),'ack':!![]});}function a1_0x4763(){const _0x1ee346=['ankunft','\x20min).','common','slice','2741095XuaPYg','.4.VALVE_STATE','role','local_temperature',':\x20Absenkung\x20auf\x20','Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20','setStateAsync','analysis.automation.confidenceThreshold','./ai_agent','abs','SET','24RTYuCi','temperature','analysis.energy.warmupTargets','openknx','parse','[WATCHDOG]\x20','4jfXucS','score','ACTUAL','warn','\x20auf\x20','currentSystemMode','add','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','sensor','setForeignStateAsync','Â°C!\x20(Puffer\x20leer).','includes','Manuelles\x20Mapping','forEach','thermostat','.1.SET_POINT_TEMPERATURE','level.temperature','396579LbhpUA','split','ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20',')\x20aktiv.\x20Heize\x20auf\x20','Â°C\x20<\x20','set','1969680epkOJH','rescue_','location','.1.ACTUAL_TEMPERATURE','values','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','.1.LEVEL','window','temp','_meta','toLowerCase','\x27\x20(Match:\x20','ðŸ“…\x20SMART\x20SCHEDULE\x20[','length','analysis.energy.schedulePreview','[CAL]\x20','name','config','ðŸ§¹\x20[MPC\x20CLEANUP]\x20','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','localeCompare','\x20erreicht\x20Limit\x20(','useCalendar','Â°C!\x20(Puffer:\x20','getHours','Â°C).\x20Sparmodus\x20beendet!','1225341CXhHwH','triggerTime','analysis.automation.mode','join','eventStart','too_cold','event','_calName','\x20->\x20Schalte\x20','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20','current_heating_setpoint','analysis.energy.mpcActiveInterventions','.1.TEMPERATURE','valveMapping','869589pyVEYC','manual','entries','8bciNnn','replace','setpoint','message','Calendar\x20Check\x20Error:\x20','summary','occupied_heating_setpoint','Â°C\x20->\x20','constructor','ACTUAL_TEMPERATURE','pi_heating_demand','Unknown','until','room','Â°C\x20(nicht\x20','Classic','date','.data.table','analysis.automation.lastAction','stringify','.4.SET_TEMPERATURE','getForeignStateAsync','Unbekannt','value.valve','splice','ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20','\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.','indexOf','276764URZPYS','valve_position','type','calendarInstance','stellwert','_date','Auto-Erkennung','ðŸ“…\x20[MPC\x20INFO]\x20','dimmer','Nicht\x20gefunden','toString','getForeignObjectsAsync','ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','minutes_safe','1775235FMIGBL','Â°C).\x20Entferne\x20Status.','val','push','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','valve','urlaub\x20ende','analysis.energy.ventilationAlerts','ist','120fUwvYl','\x20wurde\x20manuell\x20erhÃ¶ht.','default','[FORCE]\x20','off','search','thermostatMapping','[MPC]\x20','remove','ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','TRAIN_RL_PENALTY','\x20min)',':\x20Aufheizen\x20auf\x20','findIndex','target_temperature','now','Soll','log','position','sort','level','unit','calendarSelection','analysis.energy.activeEnforcements','target','(((.+)+)+)+$','thermostat.setpoint','system.mode','PERFECT','mpc_','analysis.automation.actionLog','contact','number',']:\x20Raum-Trigger\x20\x27','Â°C\x20(Vorlauf:\x20','PrÃ¤diktion:\x20','find','cal_','getStateAsync','messwert','getTime','ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20','devices','isArray','toUpperCase','ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20','string','from','normal','level.valve','info',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','light','analysis.energy.warmupTimes','hm-rpc','\x20->\x20','SET_POINT_TEMPERATURE','analysis.energy.rlPenalties','\x20ist\x20auf\x20'];a1_0x4763=function(){return _0x1ee346;};return a1_0x4763();}async function monitorEnforcements(_0x59adee){const _0x12cf30=a1_0x34a2ed;try{const _0x1eba11=_0x12cf30(0x141),_0x19f90e=await _0x59adee[_0x12cf30(0x8b)](_0x1eba11);if(!_0x19f90e||!_0x19f90e[_0x12cf30(0x123)])return;let _0x13c8d3=[];try{_0x13c8d3=JSON['parse'](_0x19f90e[_0x12cf30(0x123)]);}catch(_0x3abac4){return;}if(!Array[_0x12cf30(0x90)](_0x13c8d3)||_0x13c8d3[_0x12cf30(0xd9)]===0x0)return;const _0x4d3738=Date[_0x12cf30(0x139)](),_0xa1d344=_0x59adee[_0x12cf30(0xdd)][_0x12cf30(0x8f)]||[];let _0xc7ddd8=![];for(let _0x697cfc=_0x13c8d3[_0x12cf30(0xd9)]-0x1;_0x697cfc>=0x0;_0x697cfc--){const _0x198f53=_0x13c8d3[_0x697cfc];if(_0x4d3738>=_0x198f53[_0x12cf30(0x103)]){_0x59adee[_0x12cf30(0x13b)][_0x12cf30(0x97)]('ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20'+_0x198f53[_0x12cf30(0x104)]+_0x12cf30(0x125)),_0x13c8d3[_0x12cf30(0x10f)](_0x697cfc,0x1),_0xc7ddd8=!![];continue;}const _0x8a8ff5=_0xa1d344['find'](_0x55bcd6=>normalize(_0x55bcd6[_0x12cf30(0xce)])===normalize(_0x198f53[_0x12cf30(0x104)])&&(_0x55bcd6[_0x12cf30(0x115)]===_0x12cf30(0xb0)||_0x55bcd6[_0x12cf30(0x115)]===_0x12cf30(0xc3)));if(_0x8a8ff5){const _0x1aa407=await findRelatedId(_0x59adee,_0x8a8ff5['id'],'setpoint');if(_0x1aa407){const _0xa0cd7e=await _0x59adee['getForeignStateAsync'](_0x1aa407);_0xa0cd7e&&typeof _0xa0cd7e[_0x12cf30(0x123)]===_0x12cf30(0x85)&&(_0xa0cd7e[_0x12cf30(0x123)]<0xf&&(_0x59adee['log'][_0x12cf30(0xb8)](_0x12cf30(0xc8)+_0x198f53[_0x12cf30(0x104)]+_0x12cf30(0xb9)+_0xa0cd7e[_0x12cf30(0x123)]+_0x12cf30(0xa9)+_0x198f53[_0x12cf30(0x142)]+'Â°C.'),await _0x59adee['setForeignStateAsync'](_0x1aa407,_0x198f53['target']),await logAutomationAction(_0x59adee,_0x12cf30(0x12d)+_0x198f53[_0x12cf30(0x104)]+':\x20'+_0xa0cd7e[_0x12cf30(0x123)]+_0x12cf30(0xfe)+_0x198f53['target']+'Â°C\x20(Kalender-Schutz)')));}}}_0xc7ddd8&&await _0x59adee[_0x12cf30(0xaa)](_0x1eba11,{'val':JSON[_0x12cf30(0x10a)](_0x13c8d3),'ack':!![]});}catch(_0xca6f0a){_0x59adee[_0x12cf30(0x13b)]['error']('Enforcement\x20Monitor\x20Error:\x20'+_0xca6f0a[_0x12cf30(0xfa)]);}}async function checkCalendarTriggers(_0x5843b7){const _0x5c6140=a1_0x34a2ed;if(!_0x5843b7[_0x5c6140(0xdd)][_0x5c6140(0xe2)]||!_0x5843b7[_0x5c6140(0xdd)][_0x5c6140(0x116)])return;await updateSchedulePreview(_0x5843b7);let _0xdfe35a={},_0x197721={};try{const _0x21a3f0=await _0x5843b7[_0x5c6140(0x8b)](_0x5c6140(0x9a));if(_0x21a3f0&&_0x21a3f0[_0x5c6140(0x123)])_0xdfe35a=JSON[_0x5c6140(0xb3)](_0x21a3f0['val']);const _0x34f92d=await _0x5843b7[_0x5c6140(0x8b)]('analysis.energy.warmupSources');if(_0x34f92d&&_0x34f92d[_0x5c6140(0x123)])_0x197721=JSON[_0x5c6140(0xb3)](_0x34f92d[_0x5c6140(0x123)]);}catch(_0x1136f0){}let _0x3ea916={'default':0x15};try{const _0x20953e=await _0x5843b7[_0x5c6140(0x8b)]('analysis.energy.warmupTargets');if(_0x20953e&&_0x20953e[_0x5c6140(0x123)])_0x3ea916=JSON['parse'](_0x20953e[_0x5c6140(0x123)]);}catch(_0x395347){}let _0x5cb89c=[];try{const _0x1f0363=await _0x5843b7[_0x5c6140(0x8b)](_0x5c6140(0x141));if(_0x1f0363&&_0x1f0363[_0x5c6140(0x123)])_0x5cb89c=JSON[_0x5c6140(0xb3)](_0x1f0363['val']);}catch(_0x242736){}try{const _0x194731=await _0x5843b7['getForeignStateAsync'](_0x5843b7['config']['calendarInstance']+_0x5c6140(0x108));if(!_0x194731||!_0x194731[_0x5c6140(0x123)])return;const _0x3dc4cf=JSON[_0x5c6140(0xb3)](_0x194731['val']),_0x34a03f=Date[_0x5c6140(0x139)](),_0x39d7d1=_0x5843b7['config'][_0x5c6140(0x8f)]||[],_0x3d4bc2=_0x5843b7[_0x5c6140(0xdd)][_0x5c6140(0x140)]||[];let _0x39dbb4=![];for(const _0x222c30 of _0x3dc4cf){if(_0x222c30[_0x5c6140(0xed)]&&_0x3d4bc2[_0x5c6140(0xd9)]>0x0&&!_0x3d4bc2[_0x5c6140(0xc0)](_0x222c30['_calName']))continue;const _0x58927a=_0x222c30[_0x5c6140(0x118)]||_0x222c30[_0x5c6140(0xea)]||_0x222c30[_0x5c6140(0x107)];if(!_0x58927a)continue;const _0x346b11=new Date(_0x58927a);if(isNaN(_0x346b11[_0x5c6140(0x8d)]()))continue;const _0x52d6db=(_0x222c30['event']||_0x222c30[_0x5c6140(0xfc)]||'')['toLowerCase']();if(_0x52d6db[_0x5c6140(0xc0)](_0x5c6140(0x127))||_0x52d6db[_0x5c6140(0xc0)]('rÃ¼ckkehr')||_0x52d6db[_0x5c6140(0xc0)]('ankunft')){let _0xd65009=0x0;Object[_0x5c6140(0xd0)](_0xdfe35a)[_0x5c6140(0xc2)](_0x36114f=>{if(_0x36114f>_0xd65009)_0xd65009=_0x36114f;});if(_0xd65009===0x0)_0xd65009=0x78;const _0x1045aa=_0x346b11['getTime']()-_0xd65009*0xea60;_0x34a03f>=_0x1045aa&&_0x34a03f<_0x346b11[_0x5c6140(0x8d)]()&&(_0x5843b7[_0x5c6140(0xba)]!==_0x5c6140(0x95)&&(_0x5843b7['log'][_0x5c6140(0x97)](_0x5c6140(0x133)+_0xd65009+_0x5c6140(0xa1)),await _0x5843b7[_0x5c6140(0xaa)](_0x5c6140(0x80),{'val':_0x5c6140(0x95),'ack':![]})));}for(const _0x2ea977 of _0x39d7d1){if(_0x2ea977[_0x5c6140(0xce)]){const _0x6a050c=_0x2ea977[_0x5c6140(0xce)][_0x5c6140(0xd6)](),_0x130bfc=(_0x2ea977[_0x5c6140(0xdc)]||'')[_0x5c6140(0xd6)]();let _0x53a032=_0x52d6db[_0x5c6140(0xc0)](_0x6a050c);!_0x53a032&&_0x130bfc[_0x5c6140(0xd9)]>0x3&&_0x52d6db[_0x5c6140(0xc0)](_0x130bfc)&&(_0x53a032=!![]);if(_0x53a032){const _0x381529=getWarmupRobust(_0xdfe35a,_0x2ea977[_0x5c6140(0xce)]),_0x43299b=_0x197721[_0x2ea977[_0x5c6140(0xce)]]||_0x5c6140(0x106),_0xd27bed=_0x346b11[_0x5c6140(0x8d)]()-_0x381529*0xea60;if(_0x34a03f>=_0xd27bed&&_0x34a03f<_0x346b11[_0x5c6140(0x8d)]()){const _0x4add78=lastActions[_0x5c6140(0x8a)+_0x2ea977[_0x5c6140(0xce)]];if(_0x4add78&&_0x34a03f-_0x4add78<CAL_COOLDOWN_MS)continue;const _0x23c54b=await findRelatedId(_0x5843b7,_0x2ea977['id'],_0x5c6140(0xf9));if(_0x23c54b){let _0x4031b4=_0x3ea916[_0x2ea977[_0x5c6140(0xce)]];if(_0x4031b4===undefined)_0x4031b4=_0x3ea916[_0x5c6140(0x12c)];if(_0x4031b4===undefined)_0x4031b4=0x15;const _0x39d28e=await _0x5843b7[_0x5c6140(0x10c)](_0x23c54b);if(_0x39d28e&&typeof _0x39d28e[_0x5c6140(0x123)]===_0x5c6140(0x85)&&_0x39d28e[_0x5c6140(0x123)]<_0x4031b4-0.5){_0x5843b7[_0x5c6140(0x13b)][_0x5c6140(0x97)](_0x5c6140(0xd8)+_0x43299b+_0x5c6140(0x86)+_0x2ea977[_0x5c6140(0xce)]+_0x5c6140(0xd7)+_0x52d6db+_0x5c6140(0xc9)+_0x4031b4+_0x5c6140(0x87)+_0x381529+_0x5c6140(0xa1)),await _0x5843b7[_0x5c6140(0xbe)](_0x23c54b,_0x4031b4),await logAutomationAction(_0x5843b7,_0x5c6140(0xdb)+_0x2ea977[_0x5c6140(0xce)]+_0x5c6140(0x9c)+_0x4031b4+'Â°C\x20(via\x20'+_0x43299b+')'),lastActions[_0x5c6140(0x8a)+_0x2ea977['location']]=_0x34a03f;const _0x971fd=_0x5cb89c[_0x5c6140(0x137)](_0xa3382b=>_0xa3382b[_0x5c6140(0x104)]===_0x2ea977[_0x5c6140(0xce)]);if(_0x971fd!==-0x1)_0x5cb89c[_0x5c6140(0x10f)](_0x971fd,0x1);_0x5cb89c[_0x5c6140(0x124)]({'room':_0x2ea977[_0x5c6140(0xce)],'target':_0x4031b4,'until':_0x346b11[_0x5c6140(0x8d)]()}),_0x39dbb4=!![];}}}}}}}_0x39dbb4&&await _0x5843b7[_0x5c6140(0xaa)]('analysis.energy.activeEnforcements',{'val':JSON['stringify'](_0x5cb89c),'ack':!![]});}catch(_0x17f1e1){_0x5843b7['log'][_0x5c6140(0xb8)](_0x5c6140(0xfb)+_0x17f1e1[_0x5c6140(0xfa)]);}}async function manageMpcIntervention(_0x3b35a5,_0xb793d9,_0x3abd5f){const _0x3d7c04=a1_0x34a2ed;try{const _0x4218bf=_0x3d7c04(0xf1),_0xb36a5e=await _0x3b35a5['getStateAsync'](_0x4218bf);let _0x37d268=[];if(_0xb36a5e&&_0xb36a5e[_0x3d7c04(0x123)])try{_0x37d268=JSON[_0x3d7c04(0xb3)](_0xb36a5e[_0x3d7c04(0x123)]);}catch(_0x2a1006){}const _0x43e00f=_0x37d268[_0x3d7c04(0x112)](_0xb793d9);if(_0x3abd5f===_0x3d7c04(0xbb))_0x43e00f===-0x1&&(_0x37d268[_0x3d7c04(0x124)](_0xb793d9),await _0x3b35a5[_0x3d7c04(0xaa)](_0x4218bf,{'val':JSON['stringify'](_0x37d268),'ack':!![]}));else _0x3abd5f===_0x3d7c04(0x132)&&(_0x43e00f!==-0x1&&(_0x37d268[_0x3d7c04(0x10f)](_0x43e00f,0x1),await _0x3b35a5['setStateAsync'](_0x4218bf,{'val':JSON[_0x3d7c04(0x10a)](_0x37d268),'ack':!![]})));}catch(_0x13e978){}}async function cleanupGhostInterventions(_0x29fdb5){const _0x6b7900=a1_0x34a2ed;try{const _0x1e7407=_0x6b7900(0xf1),_0x5dc9bd=await _0x29fdb5[_0x6b7900(0x8b)](_0x1e7407);if(!_0x5dc9bd||!_0x5dc9bd[_0x6b7900(0x123)])return;const _0x5378b1=JSON[_0x6b7900(0xb3)](_0x5dc9bd[_0x6b7900(0x123)]);if(!Array[_0x6b7900(0x90)](_0x5378b1)||_0x5378b1['length']===0x0)return;let _0x263433={'default':0x15};try{const _0x1d46f6=await _0x29fdb5['getStateAsync'](_0x6b7900(0xb1));if(_0x1d46f6&&_0x1d46f6['val'])_0x263433=JSON[_0x6b7900(0xb3)](_0x1d46f6[_0x6b7900(0x123)]);}catch(_0x35993e){}let _0x486dd2=[];try{const _0x275dca=await _0x29fdb5[_0x6b7900(0x8b)](_0x6b7900(0x128));if(_0x275dca&&_0x275dca[_0x6b7900(0x123)])_0x486dd2=JSON[_0x6b7900(0xb3)](_0x275dca[_0x6b7900(0x123)]);}catch(_0x48740a){}let _0x367ed4={},_0x4fa755=![];try{const _0x527db3=await _0x29fdb5[_0x6b7900(0x8b)](_0x6b7900(0x9e));if(_0x527db3&&_0x527db3[_0x6b7900(0x123)])_0x367ed4=JSON[_0x6b7900(0xb3)](_0x527db3[_0x6b7900(0x123)]);}catch(_0x4c423d){}if(_0x367ed4[_0x6b7900(0xd5)]){const _0x527c2e=Date['now']();for(const [_0x4e4c30,_0x4f5dd6]of Object[_0x6b7900(0xf6)](_0x367ed4[_0x6b7900(0xd5)])){_0x527c2e-_0x4f5dd6>PENALTY_TTL&&(delete _0x367ed4[_0x4e4c30],delete _0x367ed4[_0x6b7900(0xd5)][_0x4e4c30],_0x4fa755=!![],_0x29fdb5[_0x6b7900(0x13b)]['info']('ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27'+_0x4e4c30+_0x6b7900(0xd1)));}}const _0x2632c7=_0x29fdb5['config']['devices']||[];let _0x3f539e=![];for(let _0x1bdd82=_0x5378b1[_0x6b7900(0xd9)]-0x1;_0x1bdd82>=0x0;_0x1bdd82--){const _0x12aa69=_0x5378b1[_0x1bdd82],_0x541d87=_0x2632c7[_0x6b7900(0x89)](_0x20a590=>normalize(_0x20a590[_0x6b7900(0xce)])===normalize(_0x12aa69)&&(_0x20a590[_0x6b7900(0x115)]===_0x6b7900(0xb0)||_0x20a590[_0x6b7900(0x115)]===_0x6b7900(0xc3)));if(!_0x541d87){_0x29fdb5['log'][_0x6b7900(0xb8)]('ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27'+_0x12aa69+'\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.'),_0x5378b1[_0x6b7900(0x10f)](_0x1bdd82,0x1),_0x3f539e=!![];continue;}if(_0x541d87){const _0x364732=await findRelatedId(_0x29fdb5,_0x541d87['id'],_0x6b7900(0xf9)),_0x101f91=await _0x29fdb5['getForeignStateAsync'](_0x541d87['id']);if(_0x364732){const _0x5525a5=await _0x29fdb5[_0x6b7900(0x10c)](_0x364732);if(_0x5525a5&&typeof _0x5525a5[_0x6b7900(0x123)]==='number'){let _0x12ea87=![],_0x10d2fc='';Math[_0x6b7900(0xad)](_0x5525a5[_0x6b7900(0x123)]-ECO_TEMP)>0.5&&(_0x12ea87=!![],_0x10d2fc='manual');if(!_0x12ea87&&_0x101f91&&typeof _0x101f91[_0x6b7900(0x123)]==='number'){const _0x3ad1b0=_0x263433[_0x12aa69]||_0x263433[_0x6b7900(0x12c)]||0x15;_0x101f91[_0x6b7900(0x123)]<_0x3ad1b0+0.2&&(_0x12ea87=!![],_0x10d2fc=_0x6b7900(0xeb));}if(_0x12ea87){if(_0x10d2fc===_0x6b7900(0xf5)){_0x29fdb5[_0x6b7900(0x13b)][_0x6b7900(0x97)](_0x6b7900(0xde)+_0x12aa69+_0x6b7900(0x9f)+_0x5525a5[_0x6b7900(0x123)]+_0x6b7900(0x105)+ECO_TEMP+_0x6b7900(0x122));const _0x4aaab1=lastActions[_0x6b7900(0x8a)+_0x12aa69],_0x3a6f64=_0x4aaab1&&Date[_0x6b7900(0x139)]()-_0x4aaab1<0x2*0x3c*0x3e8;if(!_0x3a6f64&&_0x5525a5[_0x6b7900(0x123)]>ECO_TEMP+0.5){_0x29fdb5['sendToPythonWrapper']&&(_0x29fdb5[_0x6b7900(0x13b)][_0x6b7900(0x97)](_0x6b7900(0x11f)+_0x12aa69+_0x6b7900(0x12b)),_0x29fdb5['sendToPythonWrapper'](_0x6b7900(0x134),{'room':_0x12aa69}));const _0x12e7e4=_0x12aa69+'_'+new Date()[_0x6b7900(0xe4)]();if(!_0x367ed4[_0x12e7e4]){_0x367ed4[_0x12e7e4]=0x1;if(!_0x367ed4[_0x6b7900(0xd5)])_0x367ed4['_meta']={};_0x367ed4[_0x6b7900(0xd5)][_0x12e7e4]=Date[_0x6b7900(0x139)](),_0x4fa755=!![];}}else _0x3a6f64&&_0x29fdb5['log'][_0x6b7900(0x97)](_0x6b7900(0x11a)+_0x12aa69+_0x6b7900(0x111));}else{if(_0x10d2fc===_0x6b7900(0xeb)){let _0x22a638=![];if(_0x486dd2[_0x6b7900(0x89)](_0x4d55f7=>_0x4d55f7['room']===_0x12aa69))_0x22a638=!![];const _0x5e977c=_0x2632c7['filter'](_0x537cd4=>normalize(_0x537cd4[_0x6b7900(0xce)])===normalize(_0x12aa69)&&(_0x537cd4[_0x6b7900(0x115)]===_0x6b7900(0xd3)||_0x537cd4[_0x6b7900(0x115)]===_0x6b7900(0xbd)||_0x537cd4[_0x6b7900(0x115)]===_0x6b7900(0x84)));for(const _0x215a78 of _0x5e977c){try{const _0x45588d=await _0x29fdb5[_0x6b7900(0x10c)](_0x215a78['id']);if(_0x45588d&&(_0x45588d[_0x6b7900(0x123)]===!![]||_0x45588d['val']===0x1||String(_0x45588d['val'])[_0x6b7900(0xd6)]()==='open'))_0x22a638=!![];}catch(_0x4f5b62){}}if(_0x22a638)_0x29fdb5['log']['info'](_0x6b7900(0x110)+_0x12aa69+_0x6b7900(0xbc));else{const _0x1b021b=_0x263433[_0x12aa69]||_0x263433[_0x6b7900(0x12c)]||0x15;_0x29fdb5[_0x6b7900(0x13b)][_0x6b7900(0x97)](_0x6b7900(0xdf)+_0x12aa69+_0x6b7900(0xe1)+_0x101f91[_0x6b7900(0x123)]+_0x6b7900(0xca)+(_0x1b021b+0.2)+_0x6b7900(0xe5)),await _0x29fdb5[_0x6b7900(0xbe)](_0x364732,_0x1b021b),await logAutomationAction(_0x29fdb5,_0x6b7900(0xb4)+_0x12aa69+_0x6b7900(0x98)+_0x1b021b+'Â°C'),lastActions[_0x6b7900(0xcd)+_0x12aa69]=Date[_0x6b7900(0x139)]();}}}_0x5378b1['splice'](_0x1bdd82,0x1),_0x3f539e=!![];}}}}}_0x3f539e&&await _0x29fdb5['setStateAsync'](_0x1e7407,{'val':JSON[_0x6b7900(0x10a)](_0x5378b1),'ack':!![]}),_0x4fa755&&await _0x29fdb5['setStateAsync'](_0x6b7900(0x9e),{'val':JSON['stringify'](_0x367ed4),'ack':!![]});}catch(_0x19959a){}}async function applyEnergySavings(_0x360393,_0x4e78c9){const _0x52ff8d=a1_0x34a2ed;await cleanupGhostInterventions(_0x360393);if(!_0x4e78c9||_0x4e78c9[_0x52ff8d(0xd9)]===0x0)return;const _0x5a9856=_0x360393[_0x52ff8d(0xdd)][_0x52ff8d(0x8f)]||[],_0x1cb78d=Date[_0x52ff8d(0x139)]();for(const _0x3918fb of _0x4e78c9){const _0x5a216d=_0x3918fb['room'],_0x4aa0a8=_0x3918fb[_0x52ff8d(0x120)],_0x4f0550=_0x3918fb['target']||0x15;if(lastActions[_0x52ff8d(0xcd)+_0x5a216d]&&_0x1cb78d-lastActions[_0x52ff8d(0xcd)+_0x5a216d]<RESCUE_LOCK_MS)continue;const _0x53319d=_0x5a9856['find'](_0x5cd179=>normalize(_0x5cd179[_0x52ff8d(0xce)])===normalize(_0x5a216d)&&(_0x5cd179['type']===_0x52ff8d(0xb0)||_0x5cd179['type']==='thermostat'));if(!_0x53319d)continue;const _0x53838d=await findRelatedId(_0x360393,_0x53319d['id'],'setpoint');if(_0x53838d){if(lastActions[_0x52ff8d(0x82)+_0x5a216d]&&_0x1cb78d-lastActions[_0x52ff8d(0x82)+_0x5a216d]<0x1e*0x3c*0x3e8)continue;const _0x5b714c=await _0x360393[_0x52ff8d(0x10c)](_0x53838d);if(_0x5b714c&&typeof _0x5b714c['val']===_0x52ff8d(0x85)){const _0x275a9e=_0x5b714c['val'];_0x275a9e!==ECO_TEMP&&await manageMpcIntervention(_0x360393,_0x5a216d,_0x52ff8d(0x132));if(_0x4aa0a8>0x1e)_0x275a9e>ECO_TEMP+0.5&&(_0x360393[_0x52ff8d(0x13b)][_0x52ff8d(0x97)](_0x52ff8d(0x8e)+_0x5a216d+_0x52ff8d(0xb9)+ECO_TEMP+_0x52ff8d(0xe3)+_0x4aa0a8+_0x52ff8d(0x135)),await _0x360393['setForeignStateAsync'](_0x53838d,ECO_TEMP),await manageMpcIntervention(_0x360393,_0x5a216d,_0x52ff8d(0xbb)),lastActions['mpc_'+_0x5a216d]=_0x1cb78d,await logAutomationAction(_0x360393,_0x52ff8d(0x131)+_0x5a216d+_0x52ff8d(0xa8)+ECO_TEMP+'Â°C'));else _0x4aa0a8<=0xf&&(_0x275a9e<_0x4f0550&&(_0x360393['log'][_0x52ff8d(0x97)](_0x52ff8d(0x92)+_0x5a216d+'\x20wieder\x20auf\x20'+_0x4f0550+_0x52ff8d(0xbf)),await _0x360393[_0x52ff8d(0xbe)](_0x53838d,_0x4f0550),await manageMpcIntervention(_0x360393,_0x5a216d,'remove'),lastActions[_0x52ff8d(0x82)+_0x5a216d]=_0x1cb78d,await logAutomationAction(_0x360393,_0x52ff8d(0x131)+_0x5a216d+_0x52ff8d(0x136)+_0x4f0550+'Â°C')));}}else _0x360393[_0x52ff8d(0x13b)][_0x52ff8d(0xb8)](_0x52ff8d(0xef)+_0x5a216d+'\x20gefunden!');}}module['exports']={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};