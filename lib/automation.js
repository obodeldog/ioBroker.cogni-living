const a1_0x5008f=a1_0x5041;(function(_0x490dff,_0x25ed74){const _0x592877=a1_0x5041,_0x2dd811=_0x490dff();while(!![]){try{const _0x1c2cf7=-parseInt(_0x592877(0x136))/0x1*(parseInt(_0x592877(0x1a5))/0x2)+parseInt(_0x592877(0x1b5))/0x3*(-parseInt(_0x592877(0x177))/0x4)+-parseInt(_0x592877(0x156))/0x5+parseInt(_0x592877(0x168))/0x6*(parseInt(_0x592877(0x199))/0x7)+parseInt(_0x592877(0x17f))/0x8+-parseInt(_0x592877(0x116))/0x9*(parseInt(_0x592877(0x11b))/0xa)+-parseInt(_0x592877(0x1b7))/0xb*(-parseInt(_0x592877(0x14c))/0xc);if(_0x1c2cf7===_0x25ed74)break;else _0x2dd811['push'](_0x2dd811['shift']());}catch(_0x362753){_0x2dd811['push'](_0x2dd811['shift']());}}}(a1_0x5153,0x65650));const a1_0x54d901=(function(){let _0x5db803=!![];return function(_0x5e6b25,_0x118225){const _0x291dcb=_0x5db803?function(){const _0x166d0e=a1_0x5041;if(_0x118225){const _0x36ebf5=_0x118225[_0x166d0e(0x1b3)](_0x5e6b25,arguments);return _0x118225=null,_0x36ebf5;}}:function(){};return _0x5db803=![],_0x291dcb;};}()),a1_0x3c0cda=a1_0x54d901(this,function(){const _0x5700da=a1_0x5041;return a1_0x3c0cda[_0x5700da(0x13c)]()[_0x5700da(0x110)](_0x5700da(0x158))['toString']()[_0x5700da(0x11e)](a1_0x3c0cda)['search']('(((.+)+)+)+$');});a1_0x3c0cda();'use strict';const aiAgent=require('./ai_agent'),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x15124c){const _0x2ac4af=a1_0x5041;if(!_0x15124c)return'';return _0x15124c['toLowerCase']()[_0x2ac4af(0x152)](/\s+/g,'')['trim']();}function getWarmupRobust(_0x59582b,_0x503b24){const _0x5d79e7=a1_0x5041;if(!_0x59582b||!_0x503b24)return 0x3c;if(_0x59582b[_0x503b24]!==undefined)return _0x59582b[_0x503b24];const _0x17ca0f=_0x503b24[_0x5d79e7(0x1cf)]()[_0x5d79e7(0x152)](/√§/g,'ae')[_0x5d79e7(0x152)](/√∂/g,'oe')[_0x5d79e7(0x152)](/√º/g,'ue')[_0x5d79e7(0x152)](/√ü/g,'ss')[_0x5d79e7(0x152)](/\s+/g,'_')['replace'](/[^a-z0-9_]/g,'');if(_0x59582b[_0x17ca0f]!==undefined)return _0x59582b[_0x17ca0f];return 0x3c;}async function logAutomationAction(_0x225611,_0x488713){const _0x38a12d=a1_0x5041;await _0x225611[_0x38a12d(0x1c4)](_0x38a12d(0x10f),{'val':_0x488713,'ack':!![]});try{const _0x2aefd0=_0x38a12d(0x166),_0x47b6fc=await _0x225611[_0x38a12d(0x1a2)](_0x2aefd0);let _0x2dbb70=[];if(_0x47b6fc&&_0x47b6fc[_0x38a12d(0x14f)])try{_0x2dbb70=JSON[_0x38a12d(0x188)](_0x47b6fc[_0x38a12d(0x14f)]);}catch(_0xb2e760){}_0x2dbb70[_0x38a12d(0x1d1)]({'ts':Date['now'](),'msg':_0x488713});if(_0x2dbb70[_0x38a12d(0x192)]>0x32)_0x2dbb70=_0x2dbb70[_0x38a12d(0x1af)](0x0,0x32);await _0x225611[_0x38a12d(0x1c4)](_0x2aefd0,{'val':JSON[_0x38a12d(0x1a6)](_0x2dbb70),'ack':!![]});}catch(_0xb72d4a){}}function a1_0x5153(){const _0x1fba4e=['analysis.energy.ventilationAlerts','minutes_safe','analysis.automation.confidenceThreshold','current_heating_setpoint','indexOf','remove','score','getForeignStateAsync','\x20min).','local_temperature','setStateAsync','contact','push','split','forEach','üçÉ\x20[MPC\x20ACTION]\x20Senke\x20','analysis.energy.rlPenalties','analysis.energy.mpcActiveInterventions','set','actual','stellwert','toLowerCase','Fehlt','unshift','üö®\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','üßπ\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','_meta','from','analysis.automation.lastAction','search','\x20wurde\x20manuell\x20erh√∂ht.','rescue_','analysis.energy.warmupSources','event','occupied_heating_setpoint','4113hRMvyC','.1.TEMPERATURE','¬∞C\x20abgesenkt!\x20Zwinge\x20zur√ºck\x20auf\x20','SET_POINT_TEMPERATURE','Soll','6820ABXxyd',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','sensor','constructor','message','getTime','openknx','common','values','find','map','sort','too_cold','TRAIN_RL_PENALTY','toUpperCase','calendarInstance','devices','\x20->\x20','info','¬∞C!\x20(Puffer:\x20','date','.4.SET_TEMPERATURE',':\x20Absenkung\x20auf\x20','setForeignStateAsync','Classic','open','level.valve','596436uqfRQZ','type','level.temperature','soll','Pr√§diktion:\x20','currentSystemMode','toString','¬∞C!\x20(Puffer\x20leer).','consultButler','[MPC]\x20','\x20auf\x20','Unknown',')\x20aktiv.\x20Heize\x20auf\x20','join','manual','PERFECT','¬∞C\x20(Vorlauf:\x20','ACTUAL','\x27\x20(Match:\x20','üßπ\x20[MPC\x20CLEANUP]\x20','getForeignObjectsAsync','urlaub\x20ende','953232AACdvC','üìÖ\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','thermostat.setpoint','val','room','Enforcement\x20Monitor\x20Error:\x20','replace','normal','useCalendar','temp','2576165iaBtSL','number','(((.+)+)+)+$','isArray','name','analysis.energy.warmupTargets','eventStart','analysis.energy.warmupTimes','[FORCE]\x20','sendToPythonWrapper','wert','cal_','Manuelles\x20Mapping','reason','error','getHours','analysis.automation.actionLog','location','654erPLZI','\x20gefunden!','üéì\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','üõ°Ô∏è\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20f√ºr\x20\x27','Unbekannt','r√ºckkehr','level','includes','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20f√ºr\x20','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/L√ºftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','triggerTime','mpc_','default','calendarSelection','now','304156GvAZya','until',']:\x20Raum-Trigger\x20\x27','.1.LEVEL','off','valveMapping','¬∞C\x20(via\x20','messwert','1799240GVZIJI','config','position','target','abs','add','analysis.automation.mode','window','üå¨Ô∏è\x20[MPC\x20WATCHDOG]\x20','parse','_date','temperature','hm-rpc','[CAL]\x20',':\x20Aufheizen\x20auf\x20','¬∞C\x20<\x20','summary','\x27\x20hat\x20kein\x20Ger√§t\x20mehr.\x20L√∂sche\x20Eintrag.','pi_heating_demand','length','thermostat','Auto-Erkennung','unit','.1.SET_POINT_TEMPERATURE','valve','string','25151iljKjn','¬∞C\x20(nicht\x20','entries','state','analysis.energy.activeEnforcements','setpoint','.1.ACTUAL_TEMPERATURE','localeCompare','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','getStateAsync','log','.data.table','2xSiIoT','stringify','\x20min)','üìÖ\x20SMART\x20SCHEDULE\x20[','üî•\x20[MPC\x20ACTION]\x20Heize\x20','Nicht\x20gefunden','analysis.energy.schedulePreview','\x20erreicht\x20Limit\x20(','_calName','¬∞C.','slice','findIndex','approved','\x20->\x20Schalte\x20','apply','filter','27NdGTsg','warn','264OGMupN','splice','thermostatMapping'];a1_0x5153=function(){return _0x1fba4e;};return a1_0x5153();}async function handlePrediction(_0x2e3526,_0x176fda,_0x17b615){const _0x58add8=a1_0x5041;if(!_0x176fda||_0x176fda===_0x58add8(0x141))return;let _0x43f8db=_0x58add8(0x17b),_0x428aaa=0.6;try{const _0x353ace=await _0x2e3526[_0x58add8(0x1a2)](_0x58add8(0x185));if(_0x353ace&&_0x353ace['val'])_0x43f8db=_0x353ace[_0x58add8(0x14f)];const _0x3d219c=await _0x2e3526['getStateAsync'](_0x58add8(0x1bc));if(_0x3d219c&&_0x3d219c[_0x58add8(0x14f)])_0x428aaa=_0x3d219c['val'];}catch(_0x32d6b1){}if(_0x43f8db===_0x58add8(0x17b)||_0x17b615<_0x428aaa)return;const _0x447cb7=Date[_0x58add8(0x176)]();if(lastActions[_0x176fda]&&_0x447cb7-lastActions[_0x176fda]<COOLDOWN_MS)return;const _0xf2b7c6=_0x2e3526[_0x58add8(0x180)][_0x58add8(0x12b)]||[],_0x27d550=normalize(_0x176fda),_0x316362=_0xf2b7c6['find'](_0x3508da=>normalize(_0x3508da[_0x58add8(0x167)])===_0x27d550&&(_0x3508da[_0x58add8(0x137)]==='light'||_0x3508da['type']==='dimmer'||_0x3508da[_0x58add8(0x137)]==='switch'));if(!_0x316362)return;const _0x28fb29=await aiAgent[_0x58add8(0x13e)](_0x2e3526,_0x176fda,_0x316362[_0x58add8(0x15a)],_0x17b615);if(!_0x28fb29[_0x58add8(0x1b1)])return;const _0x4b04c7=_0x58add8(0x13a)+_0x176fda+_0x58add8(0x1b2)+_0x316362[_0x58add8(0x15a)]+'\x20('+_0x28fb29[_0x58add8(0x163)]+')';await logAutomationAction(_0x2e3526,'['+_0x43f8db[_0x58add8(0x129)]()+']\x20'+_0x4b04c7);if(_0x43f8db==='active'){const _0x7ce256=await _0x2e3526[_0x58add8(0x1c1)](_0x316362['id']);(!_0x7ce256||!_0x7ce256[_0x58add8(0x14f)]&&_0x7ce256[_0x58add8(0x14f)]!==!![])&&await _0x2e3526[_0x58add8(0x132)](_0x316362['id'],!![]),lastActions[_0x176fda]=_0x447cb7;}}async function findRelatedId(_0x3de4e2,_0x50a06f,_0xd1a6ee=a1_0x5008f(0x19e)){const _0xe001f7=a1_0x5008f;if(_0xd1a6ee===_0xe001f7(0x19e)&&_0x3de4e2[_0xe001f7(0x180)]['thermostatMapping']){let _0x5da482=_0x3de4e2['config'][_0xe001f7(0x1b9)];if(typeof _0x5da482==='string')try{_0x5da482=JSON['parse'](_0x5da482);}catch(_0x123b10){}if(_0x5da482&&_0x5da482[_0x50a06f])return _0x5da482[_0x50a06f];}if(_0xd1a6ee==='valve'&&_0x3de4e2['config'][_0xe001f7(0x17c)]){let _0x2ef3e3=_0x3de4e2['config'][_0xe001f7(0x17c)];if(typeof _0x2ef3e3==='string')try{_0x2ef3e3=JSON[_0xe001f7(0x188)](_0x2ef3e3);}catch(_0x388a53){}if(_0x2ef3e3&&_0x2ef3e3[_0x50a06f])return _0x2ef3e3[_0x50a06f];}let _0x18a881=[];if(_0xd1a6ee==='setpoint')_0x18a881=[{'s':_0xe001f7(0x19f),'t':_0xe001f7(0x196)},{'s':_0xe001f7(0x117),'t':'.1.SET_POINT_TEMPERATURE'},{'s':_0xe001f7(0x117),'t':_0xe001f7(0x130)},{'s':'ACTUAL_TEMPERATURE','t':_0xe001f7(0x119)},{'s':'local_temperature','t':_0xe001f7(0x115)},{'s':'local_temperature','t':_0xe001f7(0x1bd)},{'s':'temperature','t':'target_temperature'},{'s':_0xe001f7(0x147),'t':'SET'},{'s':'Ist','t':_0xe001f7(0x11a)},{'s':_0xe001f7(0x18a),'t':_0xe001f7(0x19e)}];else _0xd1a6ee===_0xe001f7(0x197)&&(_0x18a881=[{'s':_0xe001f7(0x19f),'t':_0xe001f7(0x17a)},{'s':'.1.TEMPERATURE','t':'.1.LEVEL'},{'s':_0xe001f7(0x117),'t':'.4.VALVE_STATE'},{'s':_0xe001f7(0x1c3),'t':_0xe001f7(0x191)},{'s':_0xe001f7(0x18a),'t':'valve_position'},{'s':_0xe001f7(0x18a),'t':_0xe001f7(0x16e)}]);for(const _0x4fafcc of _0x18a881){if(_0x50a06f[_0xe001f7(0x16f)](_0x4fafcc['s'])){const _0x2b9684=_0x50a06f['replace'](_0x4fafcc['s'],_0x4fafcc['t']),_0xa8d496=await _0x3de4e2['getForeignObjectAsync'](_0x2b9684);if(_0xa8d496)return _0x2b9684;}}try{const _0x5592bc=_0x50a06f[_0xe001f7(0x1c7)]('.');if(_0x5592bc[_0xe001f7(0x192)]>0x2){const _0x1eea8b=_0x5592bc[_0xe001f7(0x1af)](0x0,-0x1)[_0xe001f7(0x143)]('.'),_0x2b3110=await _0x3de4e2[_0xe001f7(0x14a)](_0x1eea8b+'.*'),_0x4ccaca=[],_0xa69def=_0x50a06f[_0xe001f7(0x1c7)](/[._]+/)[_0xe001f7(0x1b4)](_0x1d9e63=>![_0xe001f7(0x121),'0',_0xe001f7(0x18b),'ist',_0xe001f7(0x160),'temperature',_0xe001f7(0x1cd),_0xe001f7(0x11d),_0xe001f7(0x17e),_0xe001f7(0x19c)][_0xe001f7(0x16f)](_0x1d9e63[_0xe001f7(0x1cf)]()));for(const [_0x273c03,_0x372b06]of Object[_0xe001f7(0x19b)](_0x2b3110)){if(_0x273c03===_0x50a06f)continue;if(_0x372b06&&_0x372b06[_0xe001f7(0x122)]){const _0x4fa4e0=_0x273c03[_0xe001f7(0x1cf)](),_0x1892ef=(_0x372b06[_0xe001f7(0x122)]['role']||'')[_0xe001f7(0x1cf)](),_0x1f8972=(_0x372b06[_0xe001f7(0x122)][_0xe001f7(0x195)]||'')['toLowerCase']();let _0x34b77a=![];if(_0xd1a6ee===_0xe001f7(0x19e)&&_0x372b06[_0xe001f7(0x122)]['write']===!![])_0x34b77a=_0x4fa4e0[_0xe001f7(0x16f)](_0xe001f7(0x1cc))||_0x4fa4e0[_0xe001f7(0x16f)](_0xe001f7(0x139))||_0x4fa4e0[_0xe001f7(0x16f)](_0xe001f7(0x182))||_0x1892ef[_0xe001f7(0x16f)](_0xe001f7(0x138))||_0x1892ef[_0xe001f7(0x16f)](_0xe001f7(0x14e));else _0xd1a6ee==='valve'&&(_0x34b77a=_0x4fa4e0['includes'](_0xe001f7(0x16e))||_0x4fa4e0[_0xe001f7(0x16f)](_0xe001f7(0x197))||_0x4fa4e0[_0xe001f7(0x16f)](_0xe001f7(0x1ce))||_0x4fa4e0[_0xe001f7(0x16f)](_0xe001f7(0x181))||_0x1892ef[_0xe001f7(0x16f)](_0xe001f7(0x135))||_0x1892ef[_0xe001f7(0x16f)]('value.valve')||_0x1f8972[_0xe001f7(0x16f)]('%'));if(_0x34b77a){const _0x31ce91=_0x273c03[_0xe001f7(0x1c7)](/[._]+/)[_0xe001f7(0x125)](_0x20227f=>_0x20227f[_0xe001f7(0x1cf)]());let _0x5a5301=0x0;_0xa69def[_0xe001f7(0x1c8)](_0x312f1b=>{const _0x531ff9=_0xe001f7;if(_0x31ce91['includes'](_0x312f1b[_0x531ff9(0x1cf)]()))_0x5a5301++;}),_0x4ccaca[_0xe001f7(0x1c6)]({'id':_0x273c03,'score':_0x5a5301});}}}if(_0x4ccaca['length']>0x0){_0x4ccaca[_0xe001f7(0x126)]((_0x1b1982,_0x3f624a)=>_0x3f624a['score']-_0x1b1982[_0xe001f7(0x1c0)]);if(_0x4ccaca[0x0]['score']>0x0)return _0x4ccaca[0x0]['id'];}}}catch(_0x383a40){}return null;}async function scanThermostats(_0x3a68df){const _0x20e8e1=a1_0x5008f,_0x486192=_0x3a68df[_0x20e8e1(0x180)][_0x20e8e1(0x12b)]||[],_0x1d7136=[],_0xf4e0c5=_0x486192[_0x20e8e1(0x1b4)](_0x6ae8ab=>_0x6ae8ab['id']&&_0x6ae8ab['id']['includes'](_0x20e8e1(0x18a))||_0x6ae8ab[_0x20e8e1(0x137)]&&[_0x20e8e1(0x18a),_0x20e8e1(0x193),_0x20e8e1(0x11d)][_0x20e8e1(0x16f)](_0x6ae8ab['type'])||_0x6ae8ab[_0x20e8e1(0x15a)]&&_0x6ae8ab[_0x20e8e1(0x15a)][_0x20e8e1(0x1cf)]()[_0x20e8e1(0x16f)](_0x20e8e1(0x155)));for(const _0x50393c of _0xf4e0c5){const _0x3c7b72=await findRelatedId(_0x3a68df,_0x50393c['id'],_0x20e8e1(0x19e)),_0x458698=await findRelatedId(_0x3a68df,_0x50393c['id'],'valve');let _0x4bb415=_0x20e8e1(0x1aa),_0x38a9e5=![],_0x33a947=_0x3a68df['config'][_0x20e8e1(0x1b9)]||{};if(typeof _0x33a947===_0x20e8e1(0x198))try{_0x33a947=JSON[_0x20e8e1(0x188)](_0x33a947);}catch(_0x24e758){}let _0x42f8a3=_0x3a68df['config'][_0x20e8e1(0x17c)]||{};if(typeof _0x42f8a3===_0x20e8e1(0x198))try{_0x42f8a3=JSON[_0x20e8e1(0x188)](_0x42f8a3);}catch(_0x1f82e5){}if(_0x33a947[_0x50393c['id']]&&_0x33a947[_0x50393c['id']]===_0x3c7b72||_0x42f8a3[_0x50393c['id']]&&_0x42f8a3[_0x50393c['id']]===_0x458698)_0x4bb415=_0x20e8e1(0x162),_0x38a9e5=!![];else(_0x3c7b72||_0x458698)&&(_0x4bb415=_0x20e8e1(0x194));_0x1d7136[_0x20e8e1(0x1c6)]({'room':_0x50393c[_0x20e8e1(0x167)]||_0x20e8e1(0x16c),'sensorId':_0x50393c['id'],'setpointId':_0x3c7b72||'-','valveId':_0x458698||'-','source':_0x4bb415,'isManual':_0x38a9e5,'status':_0x3c7b72&&_0x458698?_0x20e8e1(0x145):_0x3c7b72?'OK':_0x20e8e1(0x1d0)});}return _0x1d7136[_0x20e8e1(0x126)]((_0x489a2c,_0x11b566)=>_0x489a2c[_0x20e8e1(0x150)][_0x20e8e1(0x1a0)](_0x11b566[_0x20e8e1(0x150)]));}function a1_0x5041(_0x236dc2,_0x383324){const _0x7aa920=a1_0x5153();return a1_0x5041=function(_0x3c0cda,_0x54d901){_0x3c0cda=_0x3c0cda-0x10f;let _0x5153b8=_0x7aa920[_0x3c0cda];return _0x5153b8;},a1_0x5041(_0x236dc2,_0x383324);}async function updateSchedulePreview(_0x3b81f3){const _0x25d7b0=a1_0x5008f;if(!_0x3b81f3[_0x25d7b0(0x180)][_0x25d7b0(0x154)]||!_0x3b81f3[_0x25d7b0(0x180)][_0x25d7b0(0x12a)])return;let _0x2a850e={};try{const _0x3ef7f8=await _0x3b81f3[_0x25d7b0(0x1a2)](_0x25d7b0(0x15d));if(_0x3ef7f8&&_0x3ef7f8[_0x25d7b0(0x14f)])_0x2a850e=JSON[_0x25d7b0(0x188)](_0x3ef7f8[_0x25d7b0(0x14f)]);}catch(_0x557e70){}const _0x4a9f27=[],_0x2e2e45=Date[_0x25d7b0(0x176)](),_0x3f7d25=0x30*0x3c*0x3c*0x3e8;try{const _0xab4494=await _0x3b81f3[_0x25d7b0(0x1c1)](_0x3b81f3['config']['calendarInstance']+_0x25d7b0(0x1a4));if(!_0xab4494||!_0xab4494['val'])return;const _0x1577bd=JSON['parse'](_0xab4494[_0x25d7b0(0x14f)]),_0x28da88=_0x3b81f3['config'][_0x25d7b0(0x175)]||[],_0x25cc09=_0x3b81f3[_0x25d7b0(0x180)][_0x25d7b0(0x12b)]||[],_0x383666=new Set();_0x25cc09[_0x25d7b0(0x1c8)](_0x31bc89=>{const _0x32a55c=_0x25d7b0;if(_0x31bc89[_0x32a55c(0x167)])_0x383666[_0x32a55c(0x184)](_0x31bc89[_0x32a55c(0x167)]);});for(const _0x40d82b of _0x1577bd){if(_0x40d82b[_0x25d7b0(0x1ad)]&&_0x28da88[_0x25d7b0(0x192)]>0x0&&!_0x28da88[_0x25d7b0(0x16f)](_0x40d82b[_0x25d7b0(0x1ad)]))continue;const _0x5045ae=_0x40d82b[_0x25d7b0(0x189)]||_0x40d82b[_0x25d7b0(0x15c)]||_0x40d82b['date'];if(!_0x5045ae)continue;const _0x56a45e=new Date(_0x5045ae),_0x72238=_0x56a45e[_0x25d7b0(0x120)]();if(isNaN(_0x72238))continue;if(_0x72238<_0x2e2e45)continue;if(_0x72238>_0x2e2e45+_0x3f7d25)continue;const _0x7f27d=(_0x40d82b[_0x25d7b0(0x114)]||_0x40d82b[_0x25d7b0(0x18f)]||'')[_0x25d7b0(0x1cf)]();let _0x588e3a=![],_0x3b8f00=[],_0x3a8643=_0x40d82b[_0x25d7b0(0x114)]||_0x40d82b['summary']||_0x25d7b0(0x16c);if(_0x7f27d[_0x25d7b0(0x16f)](_0x25d7b0(0x14b))||_0x7f27d[_0x25d7b0(0x16f)](_0x25d7b0(0x16d))||_0x7f27d[_0x25d7b0(0x16f)]('ankunft'))_0x588e3a=!![],_0x3b8f00=Array[_0x25d7b0(0x1d5)](_0x383666);else for(const _0x388ab9 of _0x383666){if(_0x7f27d[_0x25d7b0(0x16f)](_0x388ab9[_0x25d7b0(0x1cf)]()))_0x3b8f00[_0x25d7b0(0x1c6)](_0x388ab9);}_0x3b8f00[_0x25d7b0(0x192)]>0x0&&_0x3b8f00[_0x25d7b0(0x1c8)](_0x1407d0=>{const _0x2d4ec9=_0x25d7b0;let _0x432873=0x3c;if(_0x588e3a){let _0x3e2fad=0x0;Object[_0x2d4ec9(0x123)](_0x2a850e)[_0x2d4ec9(0x1c8)](_0xf659c7=>{if(_0xf659c7>_0x3e2fad)_0x3e2fad=_0xf659c7;}),_0x432873=_0x3e2fad>0x0?_0x3e2fad:0x78;}else _0x432873=getWarmupRobust(_0x2a850e,_0x1407d0);const _0x37e912=new Date(_0x72238-_0x432873*0xea60);_0x4a9f27[_0x2d4ec9(0x1c6)]({'eventTime':_0x72238,'triggerTime':_0x37e912['getTime'](),'room':_0x1407d0,'minutes':_0x432873,'reason':_0x3a8643,'isGlobal':_0x588e3a});});}}catch(_0x1bc591){}_0x4a9f27['sort']((_0x4e06b0,_0x2dc7b1)=>_0x4e06b0['triggerTime']-_0x2dc7b1[_0x25d7b0(0x172)]);const _0x27b1c1=_0x4a9f27['slice'](0x0,0x5);await _0x3b81f3[_0x25d7b0(0x1c4)](_0x25d7b0(0x1ab),{'val':JSON[_0x25d7b0(0x1a6)](_0x27b1c1),'ack':!![]});}async function monitorEnforcements(_0x4780eb){const _0x1b70ae=a1_0x5008f;try{const _0x387ed8=_0x1b70ae(0x19d),_0x519c6b=await _0x4780eb[_0x1b70ae(0x1a2)](_0x387ed8);if(!_0x519c6b||!_0x519c6b['val'])return;let _0x1d5715=[];try{_0x1d5715=JSON['parse'](_0x519c6b[_0x1b70ae(0x14f)]);}catch(_0x1954d4){return;}if(!Array[_0x1b70ae(0x159)](_0x1d5715)||_0x1d5715[_0x1b70ae(0x192)]===0x0)return;const _0x451a47=Date[_0x1b70ae(0x176)](),_0x4324e6=_0x4780eb[_0x1b70ae(0x180)][_0x1b70ae(0x12b)]||[];let _0x2e3358=![];for(let _0x411541=_0x1d5715[_0x1b70ae(0x192)]-0x1;_0x411541>=0x0;_0x411541--){const _0x187f2c=_0x1d5715[_0x411541];if(_0x451a47>=_0x187f2c[_0x1b70ae(0x178)]){_0x4780eb[_0x1b70ae(0x1a3)][_0x1b70ae(0x12d)]('üìÖ\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20'+_0x187f2c[_0x1b70ae(0x150)]+_0x1b70ae(0x1a1)),_0x1d5715[_0x1b70ae(0x1b8)](_0x411541,0x1),_0x2e3358=!![];continue;}const _0x30e0f8=_0x4324e6['find'](_0x460c07=>normalize(_0x460c07[_0x1b70ae(0x167)])===normalize(_0x187f2c[_0x1b70ae(0x150)])&&(_0x460c07[_0x1b70ae(0x137)]===_0x1b70ae(0x18a)||_0x460c07['type']===_0x1b70ae(0x193)));if(_0x30e0f8){const _0xac4be8=await findRelatedId(_0x4780eb,_0x30e0f8['id'],_0x1b70ae(0x19e));if(_0xac4be8){const _0x97f94a=await _0x4780eb[_0x1b70ae(0x1c1)](_0xac4be8);_0x97f94a&&typeof _0x97f94a[_0x1b70ae(0x14f)]===_0x1b70ae(0x157)&&(_0x97f94a[_0x1b70ae(0x14f)]<0xf&&(_0x4780eb['log']['warn'](_0x1b70ae(0x1d2)+_0x187f2c[_0x1b70ae(0x150)]+_0x1b70ae(0x140)+_0x97f94a[_0x1b70ae(0x14f)]+_0x1b70ae(0x118)+_0x187f2c['target']+_0x1b70ae(0x1ae)),await _0x4780eb[_0x1b70ae(0x132)](_0xac4be8,_0x187f2c[_0x1b70ae(0x182)]),await logAutomationAction(_0x4780eb,_0x1b70ae(0x15e)+_0x187f2c[_0x1b70ae(0x150)]+':\x20'+_0x97f94a[_0x1b70ae(0x14f)]+'¬∞C\x20->\x20'+_0x187f2c[_0x1b70ae(0x182)]+'¬∞C\x20(Kalender-Schutz)')));}}}_0x2e3358&&await _0x4780eb[_0x1b70ae(0x1c4)](_0x387ed8,{'val':JSON[_0x1b70ae(0x1a6)](_0x1d5715),'ack':!![]});}catch(_0x19eebc){_0x4780eb['log'][_0x1b70ae(0x164)](_0x1b70ae(0x151)+_0x19eebc[_0x1b70ae(0x11f)]);}}async function checkCalendarTriggers(_0x35a708){const _0x2fab83=a1_0x5008f;if(!_0x35a708[_0x2fab83(0x180)][_0x2fab83(0x154)]||!_0x35a708[_0x2fab83(0x180)][_0x2fab83(0x12a)])return;await updateSchedulePreview(_0x35a708);let _0x2bfb1f={},_0x36b137={};try{const _0x4d33ba=await _0x35a708[_0x2fab83(0x1a2)]('analysis.energy.warmupTimes');if(_0x4d33ba&&_0x4d33ba[_0x2fab83(0x14f)])_0x2bfb1f=JSON[_0x2fab83(0x188)](_0x4d33ba[_0x2fab83(0x14f)]);const _0x2eb551=await _0x35a708[_0x2fab83(0x1a2)](_0x2fab83(0x113));if(_0x2eb551&&_0x2eb551[_0x2fab83(0x14f)])_0x36b137=JSON[_0x2fab83(0x188)](_0x2eb551[_0x2fab83(0x14f)]);}catch(_0x46d992){}let _0x7abdc3={'default':0x15};try{const _0x2d5935=await _0x35a708[_0x2fab83(0x1a2)](_0x2fab83(0x15b));if(_0x2d5935&&_0x2d5935[_0x2fab83(0x14f)])_0x7abdc3=JSON[_0x2fab83(0x188)](_0x2d5935[_0x2fab83(0x14f)]);}catch(_0x4f4a85){}let _0x4140d1=[];try{const _0x1ac0c1=await _0x35a708[_0x2fab83(0x1a2)](_0x2fab83(0x19d));if(_0x1ac0c1&&_0x1ac0c1['val'])_0x4140d1=JSON[_0x2fab83(0x188)](_0x1ac0c1[_0x2fab83(0x14f)]);}catch(_0x357e21){}try{const _0x45ea36=await _0x35a708[_0x2fab83(0x1c1)](_0x35a708[_0x2fab83(0x180)][_0x2fab83(0x12a)]+_0x2fab83(0x1a4));if(!_0x45ea36||!_0x45ea36['val'])return;const _0x11c823=JSON[_0x2fab83(0x188)](_0x45ea36[_0x2fab83(0x14f)]),_0xf4f58b=Date['now'](),_0x4e5654=_0x35a708[_0x2fab83(0x180)][_0x2fab83(0x12b)]||[],_0x29c1b8=_0x35a708[_0x2fab83(0x180)][_0x2fab83(0x175)]||[];let _0x159425=![];for(const _0x203543 of _0x11c823){if(_0x203543['_calName']&&_0x29c1b8[_0x2fab83(0x192)]>0x0&&!_0x29c1b8[_0x2fab83(0x16f)](_0x203543[_0x2fab83(0x1ad)]))continue;const _0x2cbcea=_0x203543['_date']||_0x203543[_0x2fab83(0x15c)]||_0x203543[_0x2fab83(0x12f)];if(!_0x2cbcea)continue;const _0x3aa759=new Date(_0x2cbcea);if(isNaN(_0x3aa759[_0x2fab83(0x120)]()))continue;const _0x537230=(_0x203543['event']||_0x203543[_0x2fab83(0x18f)]||'')[_0x2fab83(0x1cf)]();if(_0x537230[_0x2fab83(0x16f)]('urlaub\x20ende')||_0x537230[_0x2fab83(0x16f)](_0x2fab83(0x16d))||_0x537230[_0x2fab83(0x16f)]('ankunft')){let _0x5322da=0x0;Object[_0x2fab83(0x123)](_0x2bfb1f)[_0x2fab83(0x1c8)](_0x5ed585=>{if(_0x5ed585>_0x5322da)_0x5322da=_0x5ed585;});if(_0x5322da===0x0)_0x5322da=0x78;const _0x1fb2f6=_0x3aa759[_0x2fab83(0x120)]()-_0x5322da*0xea60;_0xf4f58b>=_0x1fb2f6&&_0xf4f58b<_0x3aa759[_0x2fab83(0x120)]()&&(_0x35a708[_0x2fab83(0x13b)]!==_0x2fab83(0x153)&&(_0x35a708[_0x2fab83(0x1a3)][_0x2fab83(0x12d)](_0x2fab83(0x14d)+_0x5322da+_0x2fab83(0x1c2)),await _0x35a708[_0x2fab83(0x1c4)]('system.mode',{'val':_0x2fab83(0x153),'ack':![]})));}for(const _0x2f7c53 of _0x4e5654){if(_0x2f7c53['location']){const _0x361641=_0x2f7c53[_0x2fab83(0x167)][_0x2fab83(0x1cf)](),_0x13a84c=(_0x2f7c53[_0x2fab83(0x15a)]||'')[_0x2fab83(0x1cf)]();let _0xbd8edd=_0x537230[_0x2fab83(0x16f)](_0x361641);!_0xbd8edd&&_0x13a84c[_0x2fab83(0x192)]>0x3&&_0x537230[_0x2fab83(0x16f)](_0x13a84c)&&(_0xbd8edd=!![]);if(_0xbd8edd){const _0x29912c=getWarmupRobust(_0x2bfb1f,_0x2f7c53[_0x2fab83(0x167)]),_0x9a17c6=_0x36b137[_0x2f7c53['location']]||_0x2fab83(0x133),_0x5613cc=_0x3aa759['getTime']()-_0x29912c*0xea60;if(_0xf4f58b>=_0x5613cc&&_0xf4f58b<_0x3aa759[_0x2fab83(0x120)]()){const _0x380416=lastActions[_0x2fab83(0x161)+_0x2f7c53[_0x2fab83(0x167)]];if(_0x380416&&_0xf4f58b-_0x380416<CAL_COOLDOWN_MS)continue;const _0x3913e5=await findRelatedId(_0x35a708,_0x2f7c53['id'],'setpoint');if(_0x3913e5){let _0x10ce4e=_0x7abdc3[_0x2f7c53[_0x2fab83(0x167)]];if(_0x10ce4e===undefined)_0x10ce4e=_0x7abdc3[_0x2fab83(0x174)];if(_0x10ce4e===undefined)_0x10ce4e=0x15;const _0x3cf99b=await _0x35a708[_0x2fab83(0x1c1)](_0x3913e5);if(_0x3cf99b&&typeof _0x3cf99b[_0x2fab83(0x14f)]===_0x2fab83(0x157)&&_0x3cf99b[_0x2fab83(0x14f)]<_0x10ce4e-0.5){_0x35a708[_0x2fab83(0x1a3)]['info'](_0x2fab83(0x1a8)+_0x9a17c6+_0x2fab83(0x179)+_0x2f7c53[_0x2fab83(0x167)]+_0x2fab83(0x148)+_0x537230+_0x2fab83(0x142)+_0x10ce4e+_0x2fab83(0x146)+_0x29912c+'\x20min).'),await _0x35a708['setForeignStateAsync'](_0x3913e5,_0x10ce4e),await logAutomationAction(_0x35a708,_0x2fab83(0x18c)+_0x2f7c53[_0x2fab83(0x167)]+_0x2fab83(0x12c)+_0x10ce4e+_0x2fab83(0x17d)+_0x9a17c6+')'),lastActions[_0x2fab83(0x161)+_0x2f7c53[_0x2fab83(0x167)]]=_0xf4f58b;const _0x3b7cf0=_0x4140d1[_0x2fab83(0x1b0)](_0x58c8d3=>_0x58c8d3[_0x2fab83(0x150)]===_0x2f7c53[_0x2fab83(0x167)]);if(_0x3b7cf0!==-0x1)_0x4140d1[_0x2fab83(0x1b8)](_0x3b7cf0,0x1);_0x4140d1[_0x2fab83(0x1c6)]({'room':_0x2f7c53[_0x2fab83(0x167)],'target':_0x10ce4e,'until':_0x3aa759[_0x2fab83(0x120)]()}),_0x159425=!![];}}}}}}}_0x159425&&await _0x35a708[_0x2fab83(0x1c4)](_0x2fab83(0x19d),{'val':JSON[_0x2fab83(0x1a6)](_0x4140d1),'ack':!![]});}catch(_0x403977){_0x35a708['log'][_0x2fab83(0x1b6)]('Calendar\x20Check\x20Error:\x20'+_0x403977[_0x2fab83(0x11f)]);}}async function manageMpcIntervention(_0x58c13c,_0xef5c2e,_0x27d3dc){const _0x54f72d=a1_0x5008f;try{const _0x35f211=_0x54f72d(0x1cb),_0x1b5f1c=await _0x58c13c[_0x54f72d(0x1a2)](_0x35f211);let _0x533b61=[];if(_0x1b5f1c&&_0x1b5f1c['val'])try{_0x533b61=JSON[_0x54f72d(0x188)](_0x1b5f1c[_0x54f72d(0x14f)]);}catch(_0x3ef077){}const _0x456809=_0x533b61[_0x54f72d(0x1be)](_0xef5c2e);if(_0x27d3dc===_0x54f72d(0x184))_0x456809===-0x1&&(_0x533b61[_0x54f72d(0x1c6)](_0xef5c2e),await _0x58c13c[_0x54f72d(0x1c4)](_0x35f211,{'val':JSON[_0x54f72d(0x1a6)](_0x533b61),'ack':!![]}));else _0x27d3dc===_0x54f72d(0x1bf)&&(_0x456809!==-0x1&&(_0x533b61[_0x54f72d(0x1b8)](_0x456809,0x1),await _0x58c13c['setStateAsync'](_0x35f211,{'val':JSON[_0x54f72d(0x1a6)](_0x533b61),'ack':!![]})));}catch(_0x2b6da6){}}async function cleanupGhostInterventions(_0x4c1823){const _0x32d38b=a1_0x5008f;try{const _0x2c362f=_0x32d38b(0x1cb),_0x44ae46=await _0x4c1823['getStateAsync'](_0x2c362f);if(!_0x44ae46||!_0x44ae46[_0x32d38b(0x14f)])return;const _0x3de51c=JSON[_0x32d38b(0x188)](_0x44ae46['val']);if(!Array[_0x32d38b(0x159)](_0x3de51c)||_0x3de51c[_0x32d38b(0x192)]===0x0)return;let _0x2f37e7={'default':0x15};try{const _0x30d649=await _0x4c1823[_0x32d38b(0x1a2)]('analysis.energy.warmupTargets');if(_0x30d649&&_0x30d649[_0x32d38b(0x14f)])_0x2f37e7=JSON[_0x32d38b(0x188)](_0x30d649['val']);}catch(_0x5af655){}let _0x2e380c=[];try{const _0x371794=await _0x4c1823[_0x32d38b(0x1a2)](_0x32d38b(0x1ba));if(_0x371794&&_0x371794[_0x32d38b(0x14f)])_0x2e380c=JSON[_0x32d38b(0x188)](_0x371794[_0x32d38b(0x14f)]);}catch(_0x159fe9){}let _0x5d4ffa={},_0xe79d29=![];try{const _0x8896ab=await _0x4c1823[_0x32d38b(0x1a2)](_0x32d38b(0x1ca));if(_0x8896ab&&_0x8896ab[_0x32d38b(0x14f)])_0x5d4ffa=JSON[_0x32d38b(0x188)](_0x8896ab[_0x32d38b(0x14f)]);}catch(_0x3629cd){}if(_0x5d4ffa[_0x32d38b(0x1d4)]){const _0x169b77=Date[_0x32d38b(0x176)]();for(const [_0x2f3765,_0x22170c]of Object[_0x32d38b(0x19b)](_0x5d4ffa['_meta'])){_0x169b77-_0x22170c>PENALTY_TTL&&(delete _0x5d4ffa[_0x2f3765],delete _0x5d4ffa[_0x32d38b(0x1d4)][_0x2f3765],_0xe79d29=!![],_0x4c1823['log'][_0x32d38b(0x12d)](_0x32d38b(0x16b)+_0x2f3765+'\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.'));}}const _0x28e0d2=_0x4c1823[_0x32d38b(0x180)][_0x32d38b(0x12b)]||[];let _0xd88d3f=![];for(let _0x386800=_0x3de51c[_0x32d38b(0x192)]-0x1;_0x386800>=0x0;_0x386800--){const _0x9ca18b=_0x3de51c[_0x386800],_0x13d54c=_0x28e0d2[_0x32d38b(0x124)](_0x475dac=>normalize(_0x475dac['location'])===normalize(_0x9ca18b)&&(_0x475dac[_0x32d38b(0x137)]===_0x32d38b(0x18a)||_0x475dac[_0x32d38b(0x137)]===_0x32d38b(0x193)));if(!_0x13d54c){_0x4c1823[_0x32d38b(0x1a3)][_0x32d38b(0x1b6)](_0x32d38b(0x1d3)+_0x9ca18b+_0x32d38b(0x190)),_0x3de51c[_0x32d38b(0x1b8)](_0x386800,0x1),_0xd88d3f=!![];continue;}if(_0x13d54c){const _0x3afa22=await findRelatedId(_0x4c1823,_0x13d54c['id'],'setpoint'),_0x10b747=await _0x4c1823[_0x32d38b(0x1c1)](_0x13d54c['id']);if(_0x3afa22){const _0x274b14=await _0x4c1823[_0x32d38b(0x1c1)](_0x3afa22);if(_0x274b14&&typeof _0x274b14['val']===_0x32d38b(0x157)){let _0x24b94e=![],_0x8b3b8='';Math[_0x32d38b(0x183)](_0x274b14[_0x32d38b(0x14f)]-ECO_TEMP)>0.5&&(_0x24b94e=!![],_0x8b3b8='manual');if(!_0x24b94e&&_0x10b747&&typeof _0x10b747[_0x32d38b(0x14f)]===_0x32d38b(0x157)){const _0x1dd41d=_0x2f37e7[_0x9ca18b]||_0x2f37e7['default']||0x15;_0x10b747[_0x32d38b(0x14f)]<_0x1dd41d+0.2&&(_0x24b94e=!![],_0x8b3b8=_0x32d38b(0x127));}if(_0x24b94e){if(_0x8b3b8===_0x32d38b(0x144)){_0x4c1823[_0x32d38b(0x1a3)]['info'](_0x32d38b(0x149)+_0x9ca18b+'\x20ist\x20auf\x20'+_0x274b14[_0x32d38b(0x14f)]+_0x32d38b(0x19a)+ECO_TEMP+'¬∞C).\x20Entferne\x20Status.');const _0x7667bd=lastActions[_0x32d38b(0x161)+_0x9ca18b],_0x52c3ca=_0x7667bd&&Date[_0x32d38b(0x176)]()-_0x7667bd<0x2*0x3c*0x3e8;if(!_0x52c3ca&&_0x274b14['val']>ECO_TEMP+0.5){_0x4c1823['sendToPythonWrapper']&&(_0x4c1823['log'][_0x32d38b(0x12d)](_0x32d38b(0x16a)+_0x9ca18b+_0x32d38b(0x111)),_0x4c1823[_0x32d38b(0x15f)](_0x32d38b(0x128),{'room':_0x9ca18b}));const _0x13a875=_0x9ca18b+'_'+new Date()[_0x32d38b(0x165)]();if(!_0x5d4ffa[_0x13a875]){_0x5d4ffa[_0x13a875]=0x1;if(!_0x5d4ffa[_0x32d38b(0x1d4)])_0x5d4ffa['_meta']={};_0x5d4ffa['_meta'][_0x13a875]=Date[_0x32d38b(0x176)](),_0xe79d29=!![];}}else _0x52c3ca&&_0x4c1823[_0x32d38b(0x1a3)]['info']('üìÖ\x20[MPC\x20INFO]\x20'+_0x9ca18b+'\x20durch\x20Kalender\x20ge√§ndert.\x20Keine\x20RL-Strafe.');}else{if(_0x8b3b8==='too_cold'){let _0x3ae3e5=![];if(_0x2e380c['find'](_0x2a405d=>_0x2a405d['room']===_0x9ca18b))_0x3ae3e5=!![];const _0x23d6a3=_0x28e0d2['filter'](_0x61c6d5=>normalize(_0x61c6d5[_0x32d38b(0x167)])===normalize(_0x9ca18b)&&(_0x61c6d5[_0x32d38b(0x137)]===_0x32d38b(0x186)||_0x61c6d5[_0x32d38b(0x137)]===_0x32d38b(0x11d)||_0x61c6d5[_0x32d38b(0x137)]===_0x32d38b(0x1c5)));for(const _0x5d150d of _0x23d6a3){try{const _0x1ecbd7=await _0x4c1823['getForeignStateAsync'](_0x5d150d['id']);if(_0x1ecbd7&&(_0x1ecbd7[_0x32d38b(0x14f)]===!![]||_0x1ecbd7[_0x32d38b(0x14f)]===0x1||String(_0x1ecbd7['val'])['toLowerCase']()===_0x32d38b(0x134)))_0x3ae3e5=!![];}catch(_0x379558){}}if(_0x3ae3e5)_0x4c1823[_0x32d38b(0x1a3)][_0x32d38b(0x12d)](_0x32d38b(0x187)+_0x9ca18b+_0x32d38b(0x171));else{const _0x38299c=_0x2f37e7[_0x9ca18b]||_0x2f37e7[_0x32d38b(0x174)]||0x15;_0x4c1823[_0x32d38b(0x1a3)][_0x32d38b(0x12d)]('üö®\x20[MPC\x20WATCHDOG]\x20'+_0x9ca18b+_0x32d38b(0x1ac)+_0x10b747[_0x32d38b(0x14f)]+_0x32d38b(0x18e)+(_0x38299c+0.2)+'¬∞C).\x20Sparmodus\x20beendet!'),await _0x4c1823[_0x32d38b(0x132)](_0x3afa22,_0x38299c),await logAutomationAction(_0x4c1823,'[WATCHDOG]\x20'+_0x9ca18b+_0x32d38b(0x11c)+_0x38299c+'¬∞C'),lastActions[_0x32d38b(0x112)+_0x9ca18b]=Date[_0x32d38b(0x176)]();}}}_0x3de51c[_0x32d38b(0x1b8)](_0x386800,0x1),_0xd88d3f=!![];}}}}}_0xd88d3f&&await _0x4c1823[_0x32d38b(0x1c4)](_0x2c362f,{'val':JSON[_0x32d38b(0x1a6)](_0x3de51c),'ack':!![]}),_0xe79d29&&await _0x4c1823['setStateAsync'](_0x32d38b(0x1ca),{'val':JSON[_0x32d38b(0x1a6)](_0x5d4ffa),'ack':!![]});}catch(_0x316864){}}async function applyEnergySavings(_0x556c99,_0x227d85){const _0x3d840a=a1_0x5008f;await cleanupGhostInterventions(_0x556c99);if(!_0x227d85||_0x227d85[_0x3d840a(0x192)]===0x0)return;const _0xc59f9a=_0x556c99['config'][_0x3d840a(0x12b)]||[],_0x25e983=Date['now']();for(const _0x35c66d of _0x227d85){const _0x472463=_0x35c66d['room'],_0x55853a=_0x35c66d[_0x3d840a(0x1bb)],_0x1db0eb=_0x35c66d[_0x3d840a(0x182)]||0x15;if(lastActions[_0x3d840a(0x112)+_0x472463]&&_0x25e983-lastActions[_0x3d840a(0x112)+_0x472463]<RESCUE_LOCK_MS)continue;const _0x33dc1f=_0xc59f9a[_0x3d840a(0x124)](_0x134e01=>normalize(_0x134e01[_0x3d840a(0x167)])===normalize(_0x472463)&&(_0x134e01[_0x3d840a(0x137)]===_0x3d840a(0x18a)||_0x134e01['type']==='thermostat'));if(!_0x33dc1f)continue;const _0x58d64a=await findRelatedId(_0x556c99,_0x33dc1f['id'],'setpoint');if(_0x58d64a){if(lastActions[_0x3d840a(0x173)+_0x472463]&&_0x25e983-lastActions['mpc_'+_0x472463]<0x1e*0x3c*0x3e8)continue;const _0x57b169=await _0x556c99[_0x3d840a(0x1c1)](_0x58d64a);if(_0x57b169&&typeof _0x57b169[_0x3d840a(0x14f)]===_0x3d840a(0x157)){const _0x291447=_0x57b169[_0x3d840a(0x14f)];_0x291447!==ECO_TEMP&&await manageMpcIntervention(_0x556c99,_0x472463,_0x3d840a(0x1bf));if(_0x55853a>0x1e)_0x291447>ECO_TEMP+0.5&&(_0x556c99['log']['info'](_0x3d840a(0x1c9)+_0x472463+_0x3d840a(0x140)+ECO_TEMP+_0x3d840a(0x12e)+_0x55853a+_0x3d840a(0x1a7)),await _0x556c99['setForeignStateAsync'](_0x58d64a,ECO_TEMP),await manageMpcIntervention(_0x556c99,_0x472463,'add'),lastActions['mpc_'+_0x472463]=_0x25e983,await logAutomationAction(_0x556c99,_0x3d840a(0x13f)+_0x472463+_0x3d840a(0x131)+ECO_TEMP+'¬∞C'));else _0x55853a<=0xf&&(_0x291447<_0x1db0eb&&(_0x556c99[_0x3d840a(0x1a3)][_0x3d840a(0x12d)](_0x3d840a(0x1a9)+_0x472463+'\x20wieder\x20auf\x20'+_0x1db0eb+_0x3d840a(0x13d)),await _0x556c99[_0x3d840a(0x132)](_0x58d64a,_0x1db0eb),await manageMpcIntervention(_0x556c99,_0x472463,_0x3d840a(0x1bf)),lastActions[_0x3d840a(0x173)+_0x472463]=_0x25e983,await logAutomationAction(_0x556c99,_0x3d840a(0x13f)+_0x472463+_0x3d840a(0x18d)+_0x1db0eb+'¬∞C')));}}else _0x556c99[_0x3d840a(0x1a3)][_0x3d840a(0x1b6)](_0x3d840a(0x170)+_0x472463+_0x3d840a(0x169));}}module['exports']={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};