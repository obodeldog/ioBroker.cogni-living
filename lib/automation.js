const a1_0xc166f9=a1_0x4af8;(function(_0x12aec,_0x1dc87f){const _0x3a9ae8=a1_0x4af8,_0x2fc96c=_0x12aec();while(!![]){try{const _0x354331=parseInt(_0x3a9ae8(0x1df))/0x1+parseInt(_0x3a9ae8(0x211))/0x2+parseInt(_0x3a9ae8(0x1e1))/0x3*(-parseInt(_0x3a9ae8(0x19e))/0x4)+parseInt(_0x3a9ae8(0x1d0))/0x5+parseInt(_0x3a9ae8(0x220))/0x6+parseInt(_0x3a9ae8(0x1d7))/0x7*(-parseInt(_0x3a9ae8(0x1f5))/0x8)+parseInt(_0x3a9ae8(0x1c0))/0x9;if(_0x354331===_0x1dc87f)break;else _0x2fc96c['push'](_0x2fc96c['shift']());}catch(_0x10677d){_0x2fc96c['push'](_0x2fc96c['shift']());}}}(a1_0x5f0e,0x78ff8));const a1_0x11d6b1=(function(){let _0x274f74=!![];return function(_0x4e51cc,_0x54c511){const _0xbde31f=_0x274f74?function(){const _0x3ab09b=a1_0x4af8;if(_0x54c511){const _0x31b6ae=_0x54c511[_0x3ab09b(0x1b3)](_0x4e51cc,arguments);return _0x54c511=null,_0x31b6ae;}}:function(){};return _0x274f74=![],_0xbde31f;};}()),a1_0x1b02c0=a1_0x11d6b1(this,function(){const _0x40b409=a1_0x4af8;return a1_0x1b02c0['toString']()[_0x40b409(0x244)](_0x40b409(0x190))[_0x40b409(0x1c6)]()[_0x40b409(0x1ca)](a1_0x1b02c0)[_0x40b409(0x244)]('(((.+)+)+)+$');});a1_0x1b02c0();'use strict';const aiAgent=require(a1_0xc166f9(0x1ce)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x37e6a1){const _0x4c6fa1=a1_0xc166f9;if(!_0x37e6a1)return'';return _0x37e6a1[_0x4c6fa1(0x214)]()[_0x4c6fa1(0x223)](/\s+/g,'')['trim']();}function a1_0x5f0e(){const _0x43f121=['ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20','119227hDYbOP','system.mode','33486XAUMDZ','ðŸ§¹\x20[MPC\x20CLEANUP]\x20','cal_','\x20erreicht\x20Limit\x20(','\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.','triggerTime','getStateAsync','.1.SET_POINT_TEMPERATURE','analysis.energy.rlPenalties','calendarInstance','ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27','valve','location','[WATCHDOG]\x20','date','forEach','message','stringify','abs','setpoint','73864uSByCG','localeCompare','string','.1.LEVEL','rÃ¼ckkehr','urlaub\x20ende','ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20','add','getForeignObjectsAsync','manual','event','setForeignStateAsync','devices','light','too_cold','name','includes','Ist','remove','role','log','calendarSelection','switch','parse','Auto-Erkennung','length','analysis.energy.mpcActiveInterventions','error','54512VkZAhH','exports','set','toLowerCase','hm-rpc','analysis.energy.warmupTimes','ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','off','Unbekannt','toUpperCase','Calendar\x20Check\x20Error:\x20','filter','Enforcement\x20Monitor\x20Error:\x20','getHours','.4.SET_TEMPERATURE','3881550ePqeuD','config','Â°C\x20->\x20','replace','setStateAsync','\x20min).','now','Nicht\x20gefunden','[FORCE]\x20','position','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.',':\x20Aufheizen\x20auf\x20','room','normal','analysis.energy.warmupSources','SET_POINT_TEMPERATURE','Manuelles\x20Mapping','from','ACTUAL_TEMPERATURE','mpc_','unshift','PrÃ¤diktion:\x20','target','consultButler','ist','analysis.automation.actionLog',')\x20aktiv.\x20Heize\x20auf\x20','Unknown','default','values','_calName','level.temperature','approved','temp','value.valve','useCalendar','search','level','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','write','analysis.automation.lastAction','ðŸ“…\x20[MPC\x20INFO]\x20','window','getForeignObjectAsync','\x20auf\x20','(((.+)+)+)+$','entries','join','findIndex','push','getForeignStateAsync','sensor','\x20gefunden!','ðŸ“…\x20SMART\x20SCHEDULE\x20[','info','\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.','ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27','summary','val','164kgPdEG','contact','thermostatMapping','_meta','number','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','actual','temperature','Â°C!\x20(Puffer\x20leer).','_date','current_heating_setpoint','find','PERFECT','[MPC]\x20','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20','rescue_','openknx','score','dimmer','pi_heating_demand','Â°C\x20(nicht\x20','apply','getTime','valveMapping','analysis.energy.schedulePreview','local_temperature','eventStart',']:\x20Raum-Trigger\x20\x27','\x20wurde\x20manuell\x20erhÃ¶ht.','SET','until','level.valve','Â°C\x20<\x20','sendToPythonWrapper','8369685VZHhOF','analysis.energy.warmupTargets','ankunft','open','Â°C!\x20(Puffer:\x20','slice','toString','splice','ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','unit','constructor','common','warn','Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20','./ai_agent','type','73410EIACEH','thermostat.setpoint','Â°C\x20(Kalender-Schutz)','split','analysis.energy.activeEnforcements','.data.table','analysis.automation.mode','595qzdIRi','valve_position','\x20min)','thermostat','Â°C).\x20Sparmodus\x20beendet!','.1.TEMPERATURE','wert'];a1_0x5f0e=function(){return _0x43f121;};return a1_0x5f0e();}function getWarmupRobust(_0x52ed0b,_0x56f561){const _0x4739ca=a1_0xc166f9;if(!_0x52ed0b||!_0x56f561)return 0x3c;if(_0x52ed0b[_0x56f561]!==undefined)return _0x52ed0b[_0x56f561];const _0x2aa7df=_0x56f561[_0x4739ca(0x214)]()['replace'](/Ã¤/g,'ae')[_0x4739ca(0x223)](/Ã¶/g,'oe')[_0x4739ca(0x223)](/Ã¼/g,'ue')['replace'](/ÃŸ/g,'ss')[_0x4739ca(0x223)](/\s+/g,'_')[_0x4739ca(0x223)](/[^a-z0-9_]/g,'');if(_0x52ed0b[_0x2aa7df]!==undefined)return _0x52ed0b[_0x2aa7df];return 0x3c;}async function logAutomationAction(_0x44366e,_0x12c47c){const _0x24ffdb=a1_0xc166f9;await _0x44366e[_0x24ffdb(0x224)](_0x24ffdb(0x18b),{'val':_0x12c47c,'ack':!![]});try{const _0x48347c=_0x24ffdb(0x239),_0x207a83=await _0x44366e['getStateAsync'](_0x48347c);let _0x40b6eb=[];if(_0x207a83&&_0x207a83['val'])try{_0x40b6eb=JSON[_0x24ffdb(0x20c)](_0x207a83[_0x24ffdb(0x19d)]);}catch(_0x2804f3){}_0x40b6eb[_0x24ffdb(0x234)]({'ts':Date[_0x24ffdb(0x226)](),'msg':_0x12c47c});if(_0x40b6eb[_0x24ffdb(0x20e)]>0x32)_0x40b6eb=_0x40b6eb[_0x24ffdb(0x1c5)](0x0,0x32);await _0x44366e[_0x24ffdb(0x224)](_0x48347c,{'val':JSON[_0x24ffdb(0x1f2)](_0x40b6eb),'ack':!![]});}catch(_0x41e7ee){}}async function handlePrediction(_0x251034,_0x3e6df3,_0x278d19){const _0xaff356=a1_0xc166f9;if(!_0x3e6df3||_0x3e6df3===_0xaff356(0x23b))return;let _0x19e2bb=_0xaff356(0x218),_0x2785e8=0.6;try{const _0x25da0e=await _0x251034[_0xaff356(0x1e7)](_0xaff356(0x1d6));if(_0x25da0e&&_0x25da0e['val'])_0x19e2bb=_0x25da0e[_0xaff356(0x19d)];const _0x3976f0=await _0x251034[_0xaff356(0x1e7)]('analysis.automation.confidenceThreshold');if(_0x3976f0&&_0x3976f0[_0xaff356(0x19d)])_0x2785e8=_0x3976f0[_0xaff356(0x19d)];}catch(_0x45e9e8){}if(_0x19e2bb===_0xaff356(0x218)||_0x278d19<_0x2785e8)return;const _0x11b220=Date[_0xaff356(0x226)]();if(lastActions[_0x3e6df3]&&_0x11b220-lastActions[_0x3e6df3]<COOLDOWN_MS)return;const _0x33ddc4=_0x251034[_0xaff356(0x221)][_0xaff356(0x201)]||[],_0x1ac210=normalize(_0x3e6df3),_0x75a8f5=_0x33ddc4[_0xaff356(0x1a9)](_0x46247e=>normalize(_0x46247e[_0xaff356(0x1ed)])===_0x1ac210&&(_0x46247e['type']===_0xaff356(0x202)||_0x46247e[_0xaff356(0x1cf)]===_0xaff356(0x1b0)||_0x46247e[_0xaff356(0x1cf)]===_0xaff356(0x20b)));if(!_0x75a8f5)return;const _0x477d41=await aiAgent[_0xaff356(0x237)](_0x251034,_0x3e6df3,_0x75a8f5[_0xaff356(0x204)],_0x278d19);if(!_0x477d41[_0xaff356(0x240)])return;const _0x407179=_0xaff356(0x235)+_0x3e6df3+'\x20->\x20Schalte\x20'+_0x75a8f5['name']+'\x20('+_0x477d41['reason']+')';await logAutomationAction(_0x251034,'['+_0x19e2bb[_0xaff356(0x21a)]()+']\x20'+_0x407179);if(_0x19e2bb==='active'){const _0x4e0bbb=await _0x251034['getForeignStateAsync'](_0x75a8f5['id']);(!_0x4e0bbb||!_0x4e0bbb['val']&&_0x4e0bbb[_0xaff356(0x19d)]!==!![])&&await _0x251034[_0xaff356(0x200)](_0x75a8f5['id'],!![]),lastActions[_0x3e6df3]=_0x11b220;}}async function findRelatedId(_0x59a29e,_0x35a443,_0x2f3a05=a1_0xc166f9(0x1f4)){const _0xb84c11=a1_0xc166f9;if(_0x2f3a05===_0xb84c11(0x1f4)&&_0x59a29e[_0xb84c11(0x221)][_0xb84c11(0x1a0)]){let _0x3fad03=_0x59a29e['config'][_0xb84c11(0x1a0)];if(typeof _0x3fad03==='string')try{_0x3fad03=JSON['parse'](_0x3fad03);}catch(_0x5e7144){}if(_0x3fad03&&_0x3fad03[_0x35a443])return _0x3fad03[_0x35a443];}if(_0x2f3a05===_0xb84c11(0x1ec)&&_0x59a29e[_0xb84c11(0x221)][_0xb84c11(0x1b5)]){let _0x18faf0=_0x59a29e[_0xb84c11(0x221)][_0xb84c11(0x1b5)];if(typeof _0x18faf0===_0xb84c11(0x1f7))try{_0x18faf0=JSON[_0xb84c11(0x20c)](_0x18faf0);}catch(_0x3c8fb4){}if(_0x18faf0&&_0x18faf0[_0x35a443])return _0x18faf0[_0x35a443];}let _0xd74754=[];if(_0x2f3a05===_0xb84c11(0x1f4))_0xd74754=[{'s':'.1.ACTUAL_TEMPERATURE','t':'.1.SET_POINT_TEMPERATURE'},{'s':'.1.TEMPERATURE','t':_0xb84c11(0x1e8)},{'s':_0xb84c11(0x1dc),'t':_0xb84c11(0x21f)},{'s':_0xb84c11(0x232),'t':_0xb84c11(0x22f)},{'s':_0xb84c11(0x1b7),'t':'occupied_heating_setpoint'},{'s':_0xb84c11(0x1b7),'t':_0xb84c11(0x1a8)},{'s':_0xb84c11(0x1a5),'t':'target_temperature'},{'s':'ACTUAL','t':_0xb84c11(0x1bb)},{'s':_0xb84c11(0x206),'t':'Soll'},{'s':_0xb84c11(0x1a5),'t':'setpoint'}];else _0x2f3a05===_0xb84c11(0x1ec)&&(_0xd74754=[{'s':'.1.ACTUAL_TEMPERATURE','t':_0xb84c11(0x1f8)},{'s':_0xb84c11(0x1dc),'t':'.1.LEVEL'},{'s':'.1.TEMPERATURE','t':'.4.VALVE_STATE'},{'s':'local_temperature','t':_0xb84c11(0x1b1)},{'s':_0xb84c11(0x1a5),'t':_0xb84c11(0x1d8)},{'s':_0xb84c11(0x1a5),'t':_0xb84c11(0x188)}]);for(const _0x267725 of _0xd74754){if(_0x35a443[_0xb84c11(0x205)](_0x267725['s'])){const _0x375564=_0x35a443[_0xb84c11(0x223)](_0x267725['s'],_0x267725['t']),_0x18dd5e=await _0x59a29e[_0xb84c11(0x18e)](_0x375564);if(_0x18dd5e)return _0x375564;}}try{const _0x2c0b1b=_0x35a443[_0xb84c11(0x1d3)]('.');if(_0x2c0b1b[_0xb84c11(0x20e)]>0x2){const _0x456b34=_0x2c0b1b['slice'](0x0,-0x1)[_0xb84c11(0x192)]('.'),_0x18ca9f=await _0x59a29e[_0xb84c11(0x1fd)](_0x456b34+'.*'),_0x2563f5=[],_0x5c33d8=_0x35a443['split'](/[._]+/)[_0xb84c11(0x21c)](_0x4762d2=>![_0xb84c11(0x1ae),'0',_0xb84c11(0x215),_0xb84c11(0x238),_0xb84c11(0x1dd),'temperature',_0xb84c11(0x1a4),_0xb84c11(0x196),'messwert','state'][_0xb84c11(0x205)](_0x4762d2[_0xb84c11(0x214)]()));for(const [_0x4067d5,_0x1f3e6f]of Object[_0xb84c11(0x191)](_0x18ca9f)){if(_0x4067d5===_0x35a443)continue;if(_0x1f3e6f&&_0x1f3e6f[_0xb84c11(0x1cb)]){const _0x158864=_0x4067d5[_0xb84c11(0x214)](),_0x3640e6=(_0x1f3e6f[_0xb84c11(0x1cb)][_0xb84c11(0x208)]||'')[_0xb84c11(0x214)](),_0x4d1928=(_0x1f3e6f[_0xb84c11(0x1cb)][_0xb84c11(0x1c9)]||'')[_0xb84c11(0x214)]();let _0xc4886b=![];if(_0x2f3a05===_0xb84c11(0x1f4)&&_0x1f3e6f['common'][_0xb84c11(0x18a)]===!![])_0xc4886b=_0x158864[_0xb84c11(0x205)](_0xb84c11(0x213))||_0x158864[_0xb84c11(0x205)]('soll')||_0x158864['includes']('target')||_0x3640e6['includes'](_0xb84c11(0x23f))||_0x3640e6[_0xb84c11(0x205)](_0xb84c11(0x1d1));else _0x2f3a05===_0xb84c11(0x1ec)&&(_0xc4886b=_0x158864[_0xb84c11(0x205)](_0xb84c11(0x188))||_0x158864[_0xb84c11(0x205)]('valve')||_0x158864['includes']('stellwert')||_0x158864['includes'](_0xb84c11(0x229))||_0x3640e6[_0xb84c11(0x205)](_0xb84c11(0x1bd))||_0x3640e6['includes'](_0xb84c11(0x242))||_0x4d1928[_0xb84c11(0x205)]('%'));if(_0xc4886b){const _0x4ecf17=_0x4067d5[_0xb84c11(0x1d3)](/[._]+/)['map'](_0x38a88a=>_0x38a88a['toLowerCase']());let _0x3b7edf=0x0;_0x5c33d8[_0xb84c11(0x1f0)](_0x3b8a5a=>{const _0x18b38b=_0xb84c11;if(_0x4ecf17[_0x18b38b(0x205)](_0x3b8a5a[_0x18b38b(0x214)]()))_0x3b7edf++;}),_0x2563f5['push']({'id':_0x4067d5,'score':_0x3b7edf});}}}if(_0x2563f5[_0xb84c11(0x20e)]>0x0){_0x2563f5['sort']((_0x3ff352,_0x42be43)=>_0x42be43[_0xb84c11(0x1af)]-_0x3ff352[_0xb84c11(0x1af)]);if(_0x2563f5[0x0]['score']>0x0)return _0x2563f5[0x0]['id'];}}}catch(_0x15ad19){}return null;}async function scanThermostats(_0x432eae){const _0x91fab9=a1_0xc166f9,_0x5d7ed9=_0x432eae[_0x91fab9(0x221)]['devices']||[],_0x58390f=[],_0x5c89fa=_0x5d7ed9[_0x91fab9(0x21c)](_0x5da01f=>_0x5da01f['id']&&_0x5da01f['id'][_0x91fab9(0x205)](_0x91fab9(0x1a5))||_0x5da01f[_0x91fab9(0x1cf)]&&['temperature',_0x91fab9(0x1da),_0x91fab9(0x196)][_0x91fab9(0x205)](_0x5da01f['type'])||_0x5da01f['name']&&_0x5da01f[_0x91fab9(0x204)]['toLowerCase']()[_0x91fab9(0x205)](_0x91fab9(0x241)));for(const _0x16f8cc of _0x5c89fa){const _0xe05d0f=await findRelatedId(_0x432eae,_0x16f8cc['id'],_0x91fab9(0x1f4)),_0x2e7a1a=await findRelatedId(_0x432eae,_0x16f8cc['id'],_0x91fab9(0x1ec));let _0x4b9220=_0x91fab9(0x227),_0x3e4f5b=![],_0x3544e3=_0x432eae['config'][_0x91fab9(0x1a0)]||{};if(typeof _0x3544e3===_0x91fab9(0x1f7))try{_0x3544e3=JSON[_0x91fab9(0x20c)](_0x3544e3);}catch(_0x2a4d21){}let _0x3c6736=_0x432eae['config'][_0x91fab9(0x1b5)]||{};if(typeof _0x3c6736===_0x91fab9(0x1f7))try{_0x3c6736=JSON[_0x91fab9(0x20c)](_0x3c6736);}catch(_0xa29f67){}if(_0x3544e3[_0x16f8cc['id']]&&_0x3544e3[_0x16f8cc['id']]===_0xe05d0f||_0x3c6736[_0x16f8cc['id']]&&_0x3c6736[_0x16f8cc['id']]===_0x2e7a1a)_0x4b9220=_0x91fab9(0x230),_0x3e4f5b=!![];else(_0xe05d0f||_0x2e7a1a)&&(_0x4b9220=_0x91fab9(0x20d));_0x58390f[_0x91fab9(0x194)]({'room':_0x16f8cc[_0x91fab9(0x1ed)]||'Unbekannt','sensorId':_0x16f8cc['id'],'setpointId':_0xe05d0f||'-','valveId':_0x2e7a1a||'-','source':_0x4b9220,'isManual':_0x3e4f5b,'status':_0xe05d0f&&_0x2e7a1a?_0x91fab9(0x1aa):_0xe05d0f?'OK':'Fehlt'});}return _0x58390f['sort']((_0x5a0a2b,_0x42bea3)=>_0x5a0a2b[_0x91fab9(0x22c)][_0x91fab9(0x1f6)](_0x42bea3['room']));}function a1_0x4af8(_0x93d0d1,_0x44d3c1){const _0x10def7=a1_0x5f0e();return a1_0x4af8=function(_0x1b02c0,_0x11d6b1){_0x1b02c0=_0x1b02c0-0x188;let _0x5f0ec4=_0x10def7[_0x1b02c0];return _0x5f0ec4;},a1_0x4af8(_0x93d0d1,_0x44d3c1);}async function updateSchedulePreview(_0x10f9f2){const _0xaf5094=a1_0xc166f9;if(!_0x10f9f2[_0xaf5094(0x221)][_0xaf5094(0x243)]||!_0x10f9f2[_0xaf5094(0x221)][_0xaf5094(0x1ea)])return;let _0x12f615={};try{const _0x3ce31f=await _0x10f9f2['getStateAsync']('analysis.energy.warmupTimes');if(_0x3ce31f&&_0x3ce31f['val'])_0x12f615=JSON['parse'](_0x3ce31f['val']);}catch(_0x3ddcb7){}const _0x26cf1b=[],_0x3f066c=Date['now'](),_0x19cec1=0x30*0x3c*0x3c*0x3e8;try{const _0x2defaf=await _0x10f9f2['getForeignStateAsync'](_0x10f9f2[_0xaf5094(0x221)][_0xaf5094(0x1ea)]+_0xaf5094(0x1d5));if(!_0x2defaf||!_0x2defaf[_0xaf5094(0x19d)])return;const _0x2d10d2=JSON[_0xaf5094(0x20c)](_0x2defaf[_0xaf5094(0x19d)]),_0x15d426=_0x10f9f2['config'][_0xaf5094(0x20a)]||[],_0x1f0cfe=_0x10f9f2['config'][_0xaf5094(0x201)]||[],_0x1d2ee2=new Set();_0x1f0cfe['forEach'](_0x2719fa=>{const _0x5ec013=_0xaf5094;if(_0x2719fa['location'])_0x1d2ee2[_0x5ec013(0x1fc)](_0x2719fa[_0x5ec013(0x1ed)]);});for(const _0x23fd37 of _0x2d10d2){if(_0x23fd37['_calName']&&_0x15d426[_0xaf5094(0x20e)]>0x0&&!_0x15d426['includes'](_0x23fd37[_0xaf5094(0x23e)]))continue;const _0x5bcc64=_0x23fd37[_0xaf5094(0x1a7)]||_0x23fd37[_0xaf5094(0x1b8)]||_0x23fd37[_0xaf5094(0x1ef)];if(!_0x5bcc64)continue;const _0x2947ae=new Date(_0x5bcc64),_0x5a8143=_0x2947ae['getTime']();if(isNaN(_0x5a8143))continue;if(_0x5a8143<_0x3f066c)continue;if(_0x5a8143>_0x3f066c+_0x19cec1)continue;const _0x4d05ec=(_0x23fd37[_0xaf5094(0x1ff)]||_0x23fd37['summary']||'')[_0xaf5094(0x214)]();let _0x5befa5=![],_0x5f55a3=[],_0x54bf29=_0x23fd37['event']||_0x23fd37[_0xaf5094(0x19c)]||_0xaf5094(0x219);if(_0x4d05ec[_0xaf5094(0x205)](_0xaf5094(0x1fa))||_0x4d05ec[_0xaf5094(0x205)](_0xaf5094(0x1f9))||_0x4d05ec[_0xaf5094(0x205)](_0xaf5094(0x1c2)))_0x5befa5=!![],_0x5f55a3=Array[_0xaf5094(0x231)](_0x1d2ee2);else for(const _0x440dde of _0x1d2ee2){if(_0x4d05ec[_0xaf5094(0x205)](_0x440dde[_0xaf5094(0x214)]()))_0x5f55a3[_0xaf5094(0x194)](_0x440dde);}_0x5f55a3['length']>0x0&&_0x5f55a3[_0xaf5094(0x1f0)](_0x5b4116=>{const _0x24c7a1=_0xaf5094;let _0x3ebf2c=0x3c;if(_0x5befa5){let _0x28ba75=0x0;Object[_0x24c7a1(0x23d)](_0x12f615)['forEach'](_0x15fe9f=>{if(_0x15fe9f>_0x28ba75)_0x28ba75=_0x15fe9f;}),_0x3ebf2c=_0x28ba75>0x0?_0x28ba75:0x78;}else _0x3ebf2c=getWarmupRobust(_0x12f615,_0x5b4116);const _0xe66b52=new Date(_0x5a8143-_0x3ebf2c*0xea60);_0x26cf1b['push']({'eventTime':_0x5a8143,'triggerTime':_0xe66b52['getTime'](),'room':_0x5b4116,'minutes':_0x3ebf2c,'reason':_0x54bf29,'isGlobal':_0x5befa5});});}}catch(_0x5e5120){}_0x26cf1b['sort']((_0x17f413,_0x2d12bc)=>_0x17f413[_0xaf5094(0x1e6)]-_0x2d12bc[_0xaf5094(0x1e6)]);const _0x43cf66=_0x26cf1b[_0xaf5094(0x1c5)](0x0,0x1e);await _0x10f9f2[_0xaf5094(0x224)](_0xaf5094(0x1b6),{'val':JSON[_0xaf5094(0x1f2)](_0x43cf66),'ack':!![]});}async function monitorEnforcements(_0x3ec82b){const _0x3ae30a=a1_0xc166f9;try{const _0xc8dcef=_0x3ae30a(0x1d4),_0x10612d=await _0x3ec82b['getStateAsync'](_0xc8dcef);if(!_0x10612d||!_0x10612d[_0x3ae30a(0x19d)])return;let _0x20730a=[];try{_0x20730a=JSON[_0x3ae30a(0x20c)](_0x10612d[_0x3ae30a(0x19d)]);}catch(_0x55dd94){return;}if(!Array['isArray'](_0x20730a)||_0x20730a[_0x3ae30a(0x20e)]===0x0)return;const _0x4c64e3=Date[_0x3ae30a(0x226)](),_0x18f5f7=_0x3ec82b[_0x3ae30a(0x221)][_0x3ae30a(0x201)]||[];let _0x379ca4=![];for(let _0x280af1=_0x20730a[_0x3ae30a(0x20e)]-0x1;_0x280af1>=0x0;_0x280af1--){const _0x1b60e8=_0x20730a[_0x280af1];if(_0x4c64e3>=_0x1b60e8[_0x3ae30a(0x1bc)]){_0x3ec82b['log']['info'](_0x3ae30a(0x217)+_0x1b60e8[_0x3ae30a(0x22c)]+_0x3ae30a(0x189)),_0x20730a[_0x3ae30a(0x1c7)](_0x280af1,0x1),_0x379ca4=!![];continue;}const _0x5a6cd9=_0x18f5f7[_0x3ae30a(0x1a9)](_0x3c9f7e=>normalize(_0x3c9f7e[_0x3ae30a(0x1ed)])===normalize(_0x1b60e8[_0x3ae30a(0x22c)])&&(_0x3c9f7e[_0x3ae30a(0x1cf)]==='temperature'||_0x3c9f7e[_0x3ae30a(0x1cf)]==='thermostat'));if(_0x5a6cd9){const _0x4d8df0=await findRelatedId(_0x3ec82b,_0x5a6cd9['id'],_0x3ae30a(0x1f4));if(_0x4d8df0){const _0x401990=await _0x3ec82b[_0x3ae30a(0x195)](_0x4d8df0);_0x401990&&typeof _0x401990[_0x3ae30a(0x19d)]===_0x3ae30a(0x1a2)&&(_0x401990[_0x3ae30a(0x19d)]<0xf&&(_0x3ec82b[_0x3ae30a(0x209)]['warn']('ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20'+_0x1b60e8[_0x3ae30a(0x22c)]+_0x3ae30a(0x18f)+_0x401990[_0x3ae30a(0x19d)]+_0x3ae30a(0x1cd)+_0x1b60e8[_0x3ae30a(0x236)]+'Â°C.'),await _0x3ec82b['setForeignStateAsync'](_0x4d8df0,_0x1b60e8['target']),await logAutomationAction(_0x3ec82b,_0x3ae30a(0x228)+_0x1b60e8[_0x3ae30a(0x22c)]+':\x20'+_0x401990[_0x3ae30a(0x19d)]+_0x3ae30a(0x222)+_0x1b60e8[_0x3ae30a(0x236)]+_0x3ae30a(0x1d2))));}}}_0x379ca4&&await _0x3ec82b[_0x3ae30a(0x224)](_0xc8dcef,{'val':JSON['stringify'](_0x20730a),'ack':!![]});}catch(_0x40036c){_0x3ec82b[_0x3ae30a(0x209)][_0x3ae30a(0x210)](_0x3ae30a(0x21d)+_0x40036c[_0x3ae30a(0x1f1)]);}}async function checkCalendarTriggers(_0x110ecf){const _0x2af05e=a1_0xc166f9;if(!_0x110ecf['config']['useCalendar']||!_0x110ecf[_0x2af05e(0x221)][_0x2af05e(0x1ea)])return;await updateSchedulePreview(_0x110ecf);let _0x1ce6cc={},_0x15df98={};try{const _0xb13f=await _0x110ecf[_0x2af05e(0x1e7)](_0x2af05e(0x216));if(_0xb13f&&_0xb13f[_0x2af05e(0x19d)])_0x1ce6cc=JSON[_0x2af05e(0x20c)](_0xb13f[_0x2af05e(0x19d)]);const _0x1d54a6=await _0x110ecf['getStateAsync'](_0x2af05e(0x22e));if(_0x1d54a6&&_0x1d54a6[_0x2af05e(0x19d)])_0x15df98=JSON[_0x2af05e(0x20c)](_0x1d54a6[_0x2af05e(0x19d)]);}catch(_0x27f37c){}let _0x9283ba={'default':0x15};try{const _0xd99168=await _0x110ecf['getStateAsync'](_0x2af05e(0x1c1));if(_0xd99168&&_0xd99168['val'])_0x9283ba=JSON[_0x2af05e(0x20c)](_0xd99168[_0x2af05e(0x19d)]);}catch(_0x537d8e){}let _0x3ba8db=[];try{const _0x319482=await _0x110ecf['getStateAsync']('analysis.energy.activeEnforcements');if(_0x319482&&_0x319482[_0x2af05e(0x19d)])_0x3ba8db=JSON[_0x2af05e(0x20c)](_0x319482[_0x2af05e(0x19d)]);}catch(_0x283797){}try{const _0x2bf8bc=await _0x110ecf[_0x2af05e(0x195)](_0x110ecf[_0x2af05e(0x221)][_0x2af05e(0x1ea)]+'.data.table');if(!_0x2bf8bc||!_0x2bf8bc['val'])return;const _0x4883da=JSON['parse'](_0x2bf8bc[_0x2af05e(0x19d)]),_0x1963c7=Date[_0x2af05e(0x226)](),_0x17649d=_0x110ecf[_0x2af05e(0x221)][_0x2af05e(0x201)]||[],_0x1ab9b6=_0x110ecf[_0x2af05e(0x221)][_0x2af05e(0x20a)]||[];let _0x106b14=![];for(const _0x38baf7 of _0x4883da){if(_0x38baf7[_0x2af05e(0x23e)]&&_0x1ab9b6[_0x2af05e(0x20e)]>0x0&&!_0x1ab9b6[_0x2af05e(0x205)](_0x38baf7[_0x2af05e(0x23e)]))continue;const _0x58667f=_0x38baf7[_0x2af05e(0x1a7)]||_0x38baf7['eventStart']||_0x38baf7[_0x2af05e(0x1ef)];if(!_0x58667f)continue;const _0x2225ab=new Date(_0x58667f);if(isNaN(_0x2225ab['getTime']()))continue;const _0x13cdbd=(_0x38baf7[_0x2af05e(0x1ff)]||_0x38baf7[_0x2af05e(0x19c)]||'')['toLowerCase']();if(_0x13cdbd[_0x2af05e(0x205)]('urlaub\x20ende')||_0x13cdbd[_0x2af05e(0x205)](_0x2af05e(0x1f9))||_0x13cdbd[_0x2af05e(0x205)](_0x2af05e(0x1c2))){let _0x586f22=0x0;Object['values'](_0x1ce6cc)[_0x2af05e(0x1f0)](_0x34c6c1=>{if(_0x34c6c1>_0x586f22)_0x586f22=_0x34c6c1;});if(_0x586f22===0x0)_0x586f22=0x78;const _0x598a40=_0x2225ab[_0x2af05e(0x1b4)]()-_0x586f22*0xea60;_0x1963c7>=_0x598a40&&_0x1963c7<_0x2225ab[_0x2af05e(0x1b4)]()&&(_0x110ecf['currentSystemMode']!==_0x2af05e(0x22d)&&(_0x110ecf['log']['info'](_0x2af05e(0x1fb)+_0x586f22+_0x2af05e(0x225)),await _0x110ecf[_0x2af05e(0x224)](_0x2af05e(0x1e0),{'val':_0x2af05e(0x22d),'ack':![]})));}for(const _0x5ca290 of _0x17649d){if(_0x5ca290[_0x2af05e(0x1ed)]){const _0x55f85f=_0x5ca290[_0x2af05e(0x1ed)][_0x2af05e(0x214)](),_0x250de6=(_0x5ca290[_0x2af05e(0x204)]||'')[_0x2af05e(0x214)]();let _0x3dd07e=_0x13cdbd[_0x2af05e(0x205)](_0x55f85f);!_0x3dd07e&&_0x250de6['length']>0x3&&_0x13cdbd['includes'](_0x250de6)&&(_0x3dd07e=!![]);if(_0x3dd07e){const _0x1b9b76=getWarmupRobust(_0x1ce6cc,_0x5ca290['location']),_0xee88d4=_0x15df98[_0x5ca290[_0x2af05e(0x1ed)]]||'Classic',_0x49e412=_0x2225ab[_0x2af05e(0x1b4)]()-_0x1b9b76*0xea60;if(_0x1963c7>=_0x49e412&&_0x1963c7<_0x2225ab[_0x2af05e(0x1b4)]()){const _0xf4c07c=lastActions[_0x2af05e(0x1e3)+_0x5ca290['location']];if(_0xf4c07c&&_0x1963c7-_0xf4c07c<CAL_COOLDOWN_MS)continue;const _0x3a0faf=await findRelatedId(_0x110ecf,_0x5ca290['id'],'setpoint');if(_0x3a0faf){let _0x21e326=_0x9283ba[_0x5ca290[_0x2af05e(0x1ed)]];if(_0x21e326===undefined)_0x21e326=_0x9283ba['default'];if(_0x21e326===undefined)_0x21e326=0x15;const _0x2e9eac=await _0x110ecf[_0x2af05e(0x195)](_0x3a0faf);if(_0x2e9eac&&typeof _0x2e9eac[_0x2af05e(0x19d)]==='number'&&_0x2e9eac['val']<_0x21e326-0.5){_0x110ecf[_0x2af05e(0x209)][_0x2af05e(0x199)](_0x2af05e(0x198)+_0xee88d4+_0x2af05e(0x1b9)+_0x5ca290[_0x2af05e(0x1ed)]+'\x27\x20(Match:\x20'+_0x13cdbd+_0x2af05e(0x23a)+_0x21e326+'Â°C\x20(Vorlauf:\x20'+_0x1b9b76+_0x2af05e(0x225)),await _0x110ecf[_0x2af05e(0x200)](_0x3a0faf,_0x21e326),await logAutomationAction(_0x110ecf,'[CAL]\x20'+_0x5ca290[_0x2af05e(0x1ed)]+'\x20->\x20'+_0x21e326+'Â°C\x20(via\x20'+_0xee88d4+')'),lastActions[_0x2af05e(0x1e3)+_0x5ca290[_0x2af05e(0x1ed)]]=_0x1963c7;const _0x4f44db=_0x3ba8db[_0x2af05e(0x193)](_0x1b7935=>_0x1b7935[_0x2af05e(0x22c)]===_0x5ca290[_0x2af05e(0x1ed)]);if(_0x4f44db!==-0x1)_0x3ba8db[_0x2af05e(0x1c7)](_0x4f44db,0x1);_0x3ba8db[_0x2af05e(0x194)]({'room':_0x5ca290[_0x2af05e(0x1ed)],'target':_0x21e326,'until':_0x2225ab[_0x2af05e(0x1b4)]()}),_0x106b14=!![];}}}}}}}_0x106b14&&await _0x110ecf[_0x2af05e(0x224)](_0x2af05e(0x1d4),{'val':JSON['stringify'](_0x3ba8db),'ack':!![]});}catch(_0x269368){_0x110ecf[_0x2af05e(0x209)][_0x2af05e(0x1cc)](_0x2af05e(0x21b)+_0x269368[_0x2af05e(0x1f1)]);}}async function manageMpcIntervention(_0x539197,_0x282891,_0x31fcec){const _0x1af0a1=a1_0xc166f9;try{const _0x645615=_0x1af0a1(0x20f),_0x23ed7d=await _0x539197[_0x1af0a1(0x1e7)](_0x645615);let _0x495c75=[];if(_0x23ed7d&&_0x23ed7d[_0x1af0a1(0x19d)])try{_0x495c75=JSON['parse'](_0x23ed7d[_0x1af0a1(0x19d)]);}catch(_0x59fc21){}const _0x38f622=_0x495c75['indexOf'](_0x282891);if(_0x31fcec==='add')_0x38f622===-0x1&&(_0x495c75[_0x1af0a1(0x194)](_0x282891),await _0x539197[_0x1af0a1(0x224)](_0x645615,{'val':JSON[_0x1af0a1(0x1f2)](_0x495c75),'ack':!![]}));else _0x31fcec===_0x1af0a1(0x207)&&(_0x38f622!==-0x1&&(_0x495c75[_0x1af0a1(0x1c7)](_0x38f622,0x1),await _0x539197[_0x1af0a1(0x224)](_0x645615,{'val':JSON['stringify'](_0x495c75),'ack':!![]})));}catch(_0x461c81){}}async function cleanupGhostInterventions(_0x559b60){const _0x39dcc0=a1_0xc166f9;try{const _0x1527b2=_0x39dcc0(0x20f),_0x3fec5d=await _0x559b60[_0x39dcc0(0x1e7)](_0x1527b2);if(!_0x3fec5d||!_0x3fec5d[_0x39dcc0(0x19d)])return;const _0x167ada=JSON[_0x39dcc0(0x20c)](_0x3fec5d[_0x39dcc0(0x19d)]);if(!Array['isArray'](_0x167ada)||_0x167ada[_0x39dcc0(0x20e)]===0x0)return;let _0x5d8671={'default':0x15};try{const _0x2df9ec=await _0x559b60[_0x39dcc0(0x1e7)]('analysis.energy.warmupTargets');if(_0x2df9ec&&_0x2df9ec[_0x39dcc0(0x19d)])_0x5d8671=JSON['parse'](_0x2df9ec['val']);}catch(_0x31ade6){}let _0x401ada=[];try{const _0xda84d9=await _0x559b60[_0x39dcc0(0x1e7)]('analysis.energy.ventilationAlerts');if(_0xda84d9&&_0xda84d9[_0x39dcc0(0x19d)])_0x401ada=JSON[_0x39dcc0(0x20c)](_0xda84d9[_0x39dcc0(0x19d)]);}catch(_0x3ce84a){}let _0x259037={},_0x32a4e4=![];try{const _0x550d3b=await _0x559b60[_0x39dcc0(0x1e7)](_0x39dcc0(0x1e9));if(_0x550d3b&&_0x550d3b[_0x39dcc0(0x19d)])_0x259037=JSON[_0x39dcc0(0x20c)](_0x550d3b[_0x39dcc0(0x19d)]);}catch(_0x328d2a){}if(_0x259037[_0x39dcc0(0x1a1)]){const _0x19af2d=Date[_0x39dcc0(0x226)]();for(const [_0x2df3cb,_0x307afe]of Object[_0x39dcc0(0x191)](_0x259037['_meta'])){_0x19af2d-_0x307afe>PENALTY_TTL&&(delete _0x259037[_0x2df3cb],delete _0x259037[_0x39dcc0(0x1a1)][_0x2df3cb],_0x32a4e4=!![],_0x559b60[_0x39dcc0(0x209)][_0x39dcc0(0x199)](_0x39dcc0(0x1eb)+_0x2df3cb+_0x39dcc0(0x22a)));}}const _0x2c2abb=_0x559b60['config'][_0x39dcc0(0x201)]||[];let _0x241545=![];for(let _0x26cb5b=_0x167ada[_0x39dcc0(0x20e)]-0x1;_0x26cb5b>=0x0;_0x26cb5b--){const _0x3d5cf9=_0x167ada[_0x26cb5b],_0x5da9b3=_0x2c2abb[_0x39dcc0(0x1a9)](_0x41d952=>normalize(_0x41d952[_0x39dcc0(0x1ed)])===normalize(_0x3d5cf9)&&(_0x41d952['type']===_0x39dcc0(0x1a5)||_0x41d952['type']==='thermostat'));if(!_0x5da9b3){_0x559b60[_0x39dcc0(0x209)][_0x39dcc0(0x1cc)](_0x39dcc0(0x19b)+_0x3d5cf9+'\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.'),_0x167ada[_0x39dcc0(0x1c7)](_0x26cb5b,0x1),_0x241545=!![];continue;}if(_0x5da9b3){const _0x1cc263=await findRelatedId(_0x559b60,_0x5da9b3['id'],_0x39dcc0(0x1f4)),_0x2d6a12=await _0x559b60[_0x39dcc0(0x195)](_0x5da9b3['id']);if(_0x1cc263){const _0x446afc=await _0x559b60['getForeignStateAsync'](_0x1cc263);if(_0x446afc&&typeof _0x446afc['val']==='number'){let _0xff775d=![],_0x3d84fc='';Math[_0x39dcc0(0x1f3)](_0x446afc[_0x39dcc0(0x19d)]-ECO_TEMP)>0.5&&(_0xff775d=!![],_0x3d84fc=_0x39dcc0(0x1fe));if(!_0xff775d&&_0x2d6a12&&typeof _0x2d6a12[_0x39dcc0(0x19d)]===_0x39dcc0(0x1a2)){const _0x13b305=_0x5d8671[_0x3d5cf9]||_0x5d8671['default']||0x15;_0x2d6a12['val']<_0x13b305+0.2&&(_0xff775d=!![],_0x3d84fc=_0x39dcc0(0x203));}if(_0xff775d){if(_0x3d84fc===_0x39dcc0(0x1fe)){_0x559b60[_0x39dcc0(0x209)][_0x39dcc0(0x199)](_0x39dcc0(0x1e2)+_0x3d5cf9+'\x20ist\x20auf\x20'+_0x446afc[_0x39dcc0(0x19d)]+_0x39dcc0(0x1b2)+ECO_TEMP+'Â°C).\x20Entferne\x20Status.');const _0x3a21ac=lastActions[_0x39dcc0(0x1e3)+_0x3d5cf9],_0x5b280a=_0x3a21ac&&Date['now']()-_0x3a21ac<0x2*0x3c*0x3e8;if(!_0x5b280a&&_0x446afc[_0x39dcc0(0x19d)]>ECO_TEMP+0.5){_0x559b60[_0x39dcc0(0x1bf)]&&(_0x559b60[_0x39dcc0(0x209)][_0x39dcc0(0x199)](_0x39dcc0(0x1c8)+_0x3d5cf9+_0x39dcc0(0x1ba)),_0x559b60['sendToPythonWrapper']('TRAIN_RL_PENALTY',{'room':_0x3d5cf9}));const _0x234018=_0x3d5cf9+'_'+new Date()[_0x39dcc0(0x21e)]();if(!_0x259037[_0x234018]){_0x259037[_0x234018]=0x1;if(!_0x259037[_0x39dcc0(0x1a1)])_0x259037[_0x39dcc0(0x1a1)]={};_0x259037[_0x39dcc0(0x1a1)][_0x234018]=Date['now'](),_0x32a4e4=!![];}}else _0x5b280a&&_0x559b60[_0x39dcc0(0x209)]['info'](_0x39dcc0(0x18c)+_0x3d5cf9+_0x39dcc0(0x19a));}else{if(_0x3d84fc===_0x39dcc0(0x203)){let _0x377a28=![];if(_0x401ada[_0x39dcc0(0x1a9)](_0x15efb9=>_0x15efb9[_0x39dcc0(0x22c)]===_0x3d5cf9))_0x377a28=!![];const _0x591a0f=_0x2c2abb[_0x39dcc0(0x21c)](_0x3446ea=>normalize(_0x3446ea[_0x39dcc0(0x1ed)])===normalize(_0x3d5cf9)&&(_0x3446ea[_0x39dcc0(0x1cf)]===_0x39dcc0(0x18d)||_0x3446ea[_0x39dcc0(0x1cf)]===_0x39dcc0(0x196)||_0x3446ea[_0x39dcc0(0x1cf)]===_0x39dcc0(0x19f)));for(const _0x526766 of _0x591a0f){try{const _0x5efd22=await _0x559b60[_0x39dcc0(0x195)](_0x526766['id']);if(_0x5efd22&&(_0x5efd22[_0x39dcc0(0x19d)]===!![]||_0x5efd22['val']===0x1||String(_0x5efd22[_0x39dcc0(0x19d)])[_0x39dcc0(0x214)]()===_0x39dcc0(0x1c3)))_0x377a28=!![];}catch(_0x9db166){}}if(_0x377a28)_0x559b60['log'][_0x39dcc0(0x199)]('ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20'+_0x3d5cf9+_0x39dcc0(0x1e5));else{const _0x16a4c2=_0x5d8671[_0x3d5cf9]||_0x5d8671[_0x39dcc0(0x23c)]||0x15;_0x559b60[_0x39dcc0(0x209)][_0x39dcc0(0x199)](_0x39dcc0(0x1a3)+_0x3d5cf9+_0x39dcc0(0x1e4)+_0x2d6a12[_0x39dcc0(0x19d)]+_0x39dcc0(0x1be)+(_0x16a4c2+0.2)+_0x39dcc0(0x1db)),await _0x559b60['setForeignStateAsync'](_0x1cc263,_0x16a4c2),await logAutomationAction(_0x559b60,_0x39dcc0(0x1ee)+_0x3d5cf9+':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20'+_0x16a4c2+'Â°C'),lastActions['rescue_'+_0x3d5cf9]=Date[_0x39dcc0(0x226)]();}}}_0x167ada['splice'](_0x26cb5b,0x1),_0x241545=!![];}}}}}_0x241545&&await _0x559b60[_0x39dcc0(0x224)](_0x1527b2,{'val':JSON[_0x39dcc0(0x1f2)](_0x167ada),'ack':!![]}),_0x32a4e4&&await _0x559b60['setStateAsync'](_0x39dcc0(0x1e9),{'val':JSON[_0x39dcc0(0x1f2)](_0x259037),'ack':!![]});}catch(_0x157ee3){}}async function applyEnergySavings(_0x172f4f,_0xd2bf08){const _0x4f7dcc=a1_0xc166f9;await cleanupGhostInterventions(_0x172f4f);if(!_0xd2bf08||_0xd2bf08['length']===0x0)return;const _0x577b95=_0x172f4f[_0x4f7dcc(0x221)][_0x4f7dcc(0x201)]||[],_0x576844=Date[_0x4f7dcc(0x226)]();for(const _0x4d0f37 of _0xd2bf08){const _0x50de25=_0x4d0f37[_0x4f7dcc(0x22c)],_0x4a0398=_0x4d0f37['minutes_safe'],_0x53dbc8=_0x4d0f37[_0x4f7dcc(0x236)]||0x15;if(lastActions['rescue_'+_0x50de25]&&_0x576844-lastActions[_0x4f7dcc(0x1ad)+_0x50de25]<RESCUE_LOCK_MS)continue;const _0x234ba0=_0x577b95[_0x4f7dcc(0x1a9)](_0x49d339=>normalize(_0x49d339[_0x4f7dcc(0x1ed)])===normalize(_0x50de25)&&(_0x49d339[_0x4f7dcc(0x1cf)]===_0x4f7dcc(0x1a5)||_0x49d339['type']===_0x4f7dcc(0x1da)));if(!_0x234ba0)continue;const _0x27ed7a=await findRelatedId(_0x172f4f,_0x234ba0['id'],_0x4f7dcc(0x1f4));if(_0x27ed7a){if(lastActions['mpc_'+_0x50de25]&&_0x576844-lastActions[_0x4f7dcc(0x233)+_0x50de25]<0x1e*0x3c*0x3e8)continue;const _0x3be3f5=await _0x172f4f['getForeignStateAsync'](_0x27ed7a);if(_0x3be3f5&&typeof _0x3be3f5[_0x4f7dcc(0x19d)]===_0x4f7dcc(0x1a2)){const _0x2783be=_0x3be3f5[_0x4f7dcc(0x19d)];_0x2783be!==ECO_TEMP&&await manageMpcIntervention(_0x172f4f,_0x50de25,'remove');if(_0x4a0398>0x1e)_0x2783be>ECO_TEMP+0.5&&(_0x172f4f[_0x4f7dcc(0x209)][_0x4f7dcc(0x199)](_0x4f7dcc(0x1de)+_0x50de25+_0x4f7dcc(0x18f)+ECO_TEMP+_0x4f7dcc(0x1c4)+_0x4a0398+_0x4f7dcc(0x1d9)),await _0x172f4f[_0x4f7dcc(0x200)](_0x27ed7a,ECO_TEMP),await manageMpcIntervention(_0x172f4f,_0x50de25,'add'),lastActions['mpc_'+_0x50de25]=_0x576844,await logAutomationAction(_0x172f4f,_0x4f7dcc(0x1ab)+_0x50de25+':\x20Absenkung\x20auf\x20'+ECO_TEMP+'Â°C'));else _0x4a0398<=0xf&&(_0x2783be<_0x53dbc8&&(_0x172f4f[_0x4f7dcc(0x209)]['info']('ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20'+_0x50de25+'\x20wieder\x20auf\x20'+_0x53dbc8+_0x4f7dcc(0x1a6)),await _0x172f4f['setForeignStateAsync'](_0x27ed7a,_0x53dbc8),await manageMpcIntervention(_0x172f4f,_0x50de25,_0x4f7dcc(0x207)),lastActions[_0x4f7dcc(0x233)+_0x50de25]=_0x576844,await logAutomationAction(_0x172f4f,'[MPC]\x20'+_0x50de25+_0x4f7dcc(0x22b)+_0x53dbc8+'Â°C')));}}else _0x172f4f['log']['warn'](_0x4f7dcc(0x1ac)+_0x50de25+_0x4f7dcc(0x197));}}module[a1_0xc166f9(0x212)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};