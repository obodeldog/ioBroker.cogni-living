const a1_0x46b2ca=a1_0x3b3d;(function(_0x316839,_0x4c3fde){const _0x14584d=a1_0x3b3d,_0x34190b=_0x316839();while(!![]){try{const _0x5a2b4a=parseInt(_0x14584d(0x1cf))/0x1+parseInt(_0x14584d(0x1b0))/0x2+parseInt(_0x14584d(0x18d))/0x3+parseInt(_0x14584d(0x17a))/0x4+parseInt(_0x14584d(0x215))/0x5+-parseInt(_0x14584d(0x199))/0x6+parseInt(_0x14584d(0x1ab))/0x7*(-parseInt(_0x14584d(0x228))/0x8);if(_0x5a2b4a===_0x4c3fde)break;else _0x34190b['push'](_0x34190b['shift']());}catch(_0x3c3257){_0x34190b['push'](_0x34190b['shift']());}}}(a1_0xcc8d,0xc2687));const a1_0x1320ed=(function(){let _0x1756c5=!![];return function(_0x535c96,_0x113644){const _0x233649=_0x1756c5?function(){const _0x8589fd=a1_0x3b3d;if(_0x113644){const _0x1d4e5f=_0x113644[_0x8589fd(0x236)](_0x535c96,arguments);return _0x113644=null,_0x1d4e5f;}}:function(){};return _0x1756c5=![],_0x233649;};}()),a1_0x2de9e9=a1_0x1320ed(this,function(){const _0x12fcfd=a1_0x3b3d;return a1_0x2de9e9['toString']()[_0x12fcfd(0x1e5)](_0x12fcfd(0x18e))[_0x12fcfd(0x193)]()['constructor'](a1_0x2de9e9)['search'](_0x12fcfd(0x18e));});a1_0x2de9e9();'use strict';const aiAgent=require(a1_0x46b2ca(0x1d7)),COOLDOWN_MS=0x3c*0x3e8,CAL_COOLDOWN_MS=0x5a*0x3c*0x3e8,RESCUE_LOCK_MS=0x78*0x3c*0x3e8,ECO_TEMP=0x11,PENALTY_TTL=0x3*0x18*0x3c*0x3c*0x3e8,lastActions={};function normalize(_0x6dc8d5){const _0x3d068d=a1_0x46b2ca;if(!_0x6dc8d5)return'';return _0x6dc8d5[_0x3d068d(0x235)]()[_0x3d068d(0x21f)](/\s+/g,'')[_0x3d068d(0x1e6)]();}function a1_0xcc8d(){const _0x40d2a7=['sort','Â°C).\x20Entferne\x20Status.','\x20erreicht\x20Limit\x20(','urlaub\x20ende','SET_POINT_TEMPERATURE','[MPC\x20WARNING]\x20Kein\x20Setpoint\x20fÃ¼r\x20','ðŸš¨\x20[MPC\x20WATCHDOG]\x20','Â°C.','\x20->\x20Schalte\x20',':\x20Aufheizen\x20auf\x20','pi_heating_demand','\x20->\x20','off','localeCompare','ðŸŒ¬ï¸\x20[MPC\x20WATCHDOG]\x20','until','.1.SET_POINT_TEMPERATURE','\x27\x20nach\x203\x20Tagen\x20abgelaufen.\x20System\x20darf\x20wieder\x20sparen.','summary','light','system.mode','getStateAsync','.1.TEMPERATURE','room','.1.ACTUAL_TEMPERATURE','values','1192215HCjnKQ','value.valve','ðŸ“…\x20SMART\x20SCHEDULE\x20[','analysis.automation.mode','ðŸš¨\x20[ENFORCEMENT]\x20Hardware-Profil\x20hat\x20','ðŸŽ“\x20[RL-FEEDBACK]\x20Lerne\x20aus\x20Fehler:\x20','default','findIndex','temperature','calendarSelection','replace','splice','cal_','useCalendar','string','\x20durch\x20Kalender\x20geÃ¤ndert.\x20Keine\x20RL-Strafe.','setForeignStateAsync','set','too_cold','2480PqiYGS','stellwert',':\x20Puffer\x20leer\x20->\x20Heizen\x20auf\x20','Â°C).\x20Sparmodus\x20beendet!','sendToPythonWrapper','ACTUAL_TEMPERATURE','analysis.energy.mpcActiveInterventions','_meta','Â°C\x20<\x20','\x27\x20(Match:\x20','val','getHours','sensor','toLowerCase','apply','parse','\x20min)','ðŸ“…\x20[ENFORCEMENT]\x20Kalender-Event\x20in\x20','isArray','openknx','[WATCHDOG]\x20','Â°C\x20(Kalender-Schutz)','5131508HvPKGw','\x20auf\x20','[MPC]\x20','active','getForeignObjectsAsync','unit','analysis.automation.actionLog','Â°C!\x20(Puffer\x20leer).','Â°C\x20(via\x20','exports','join','ankunft','find','entries','.4.VALVE_STATE','.1.LEVEL','role','ðŸ“…\x20[MPC\x20INFO]\x20','log','1507653uqoSuP','(((.+)+)+)+$','[FORCE]\x20','triggerTime','ðŸ§¹\x20[MPC\x20CLEANUP]\x20','warn','toString','TRAIN_RL_PENALTY','currentSystemMode','\x20gefunden!','Manuelles\x20Mapping','local_temperature','6629082GlFoKV','calendarInstance','temp','hm-rpc','soll',':\x20Absenkung\x20auf\x20','state','abs','event','Soll','valve_position','Ist','setStateAsync','location','thermostatMapping','split','\x20wurde\x20manuell\x20erhÃ¶ht.','analysis.energy.warmupTargets','58639RUIBox','length','type','ist','analysis.energy.warmupSources','2963500ZbkSDU','wert','Unbekannt','_calName','Â°C\x20(nicht\x20','analysis.energy.warmupTimes','name','position','common','message','analysis.automation.lastAction','rÃ¼ckkehr','number','Calendar\x20Check\x20Error:\x20','Â°C\x20(Vorlauf:\x20','score','.4.SET_TEMPERATURE','approved','Fehlt','actual','analysis.automation.confidenceThreshold',']:\x20Raum-Trigger\x20\x27','Â°C\x20->\x20','now','normal','dimmer','Enforcement\x20Monitor\x20Error:\x20','reason','manual','valve','.data.table','992391iOMSef','\x20min).','Auto-Erkennung','getForeignStateAsync','slice','rescue_','valveMapping','PrÃ¤diktion:\x20','./ai_agent','Â°C!\x20(Puffer:\x20','analysis.energy.rlPenalties','Classic','analysis.energy.activeEnforcements','includes','contact','\x20gestartet/vorbei.\x20Gebe\x20Raum\x20frei.','forEach','target','write','getTime','level.valve','stringify','search','trim','[CAL]\x20','filter','Nicht\x20gefunden','mpc_','ðŸƒ\x20[MPC\x20ACTION]\x20Senke\x20',')\x20aktiv.\x20Heize\x20auf\x20','config','info','SET','setpoint','date','add','remove','unshift','from','level','push','eventStart','devices','thermostat'];a1_0xcc8d=function(){return _0x40d2a7;};return a1_0xcc8d();}function getWarmupRobust(_0x31111b,_0x180789){const _0x245c6b=a1_0x46b2ca;if(!_0x31111b||!_0x180789)return 0x3c;if(_0x31111b[_0x180789]!==undefined)return _0x31111b[_0x180789];const _0x1bfa88=_0x180789[_0x245c6b(0x235)]()[_0x245c6b(0x21f)](/Ã¤/g,'ae')['replace'](/Ã¶/g,'oe')[_0x245c6b(0x21f)](/Ã¼/g,'ue')[_0x245c6b(0x21f)](/ÃŸ/g,'ss')['replace'](/\s+/g,'_')[_0x245c6b(0x21f)](/[^a-z0-9_]/g,'');if(_0x31111b[_0x1bfa88]!==undefined)return _0x31111b[_0x1bfa88];return 0x3c;}async function logAutomationAction(_0x4a61dc,_0x396909){const _0x45c2c9=a1_0x46b2ca;await _0x4a61dc[_0x45c2c9(0x1a5)](_0x45c2c9(0x1ba),{'val':_0x396909,'ack':!![]});try{const _0x4bf554=_0x45c2c9(0x180),_0x30c7c9=await _0x4a61dc['getStateAsync'](_0x4bf554);let _0x3637e1=[];if(_0x30c7c9&&_0x30c7c9[_0x45c2c9(0x232)])try{_0x3637e1=JSON[_0x45c2c9(0x237)](_0x30c7c9['val']);}catch(_0x436f45){}_0x3637e1[_0x45c2c9(0x1f4)]({'ts':Date[_0x45c2c9(0x1c7)](),'msg':_0x396909});if(_0x3637e1[_0x45c2c9(0x1ac)]>0x32)_0x3637e1=_0x3637e1[_0x45c2c9(0x1d3)](0x0,0x32);await _0x4a61dc[_0x45c2c9(0x1a5)](_0x4bf554,{'val':JSON['stringify'](_0x3637e1),'ack':!![]});}catch(_0x3a0ee2){}}async function handlePrediction(_0x4aca5b,_0x12eda9,_0x493122){const _0x28c34a=a1_0x46b2ca;if(!_0x12eda9||_0x12eda9==='Unknown')return;let _0x4d258b=_0x28c34a(0x207),_0x436a89=0.6;try{const _0xeb8b50=await _0x4aca5b[_0x28c34a(0x210)](_0x28c34a(0x218));if(_0xeb8b50&&_0xeb8b50[_0x28c34a(0x232)])_0x4d258b=_0xeb8b50[_0x28c34a(0x232)];const _0x4f8bd8=await _0x4aca5b['getStateAsync'](_0x28c34a(0x1c4));if(_0x4f8bd8&&_0x4f8bd8[_0x28c34a(0x232)])_0x436a89=_0x4f8bd8[_0x28c34a(0x232)];}catch(_0x5dafb1){}if(_0x4d258b===_0x28c34a(0x207)||_0x493122<_0x436a89)return;const _0xd690f3=Date[_0x28c34a(0x1c7)]();if(lastActions[_0x12eda9]&&_0xd690f3-lastActions[_0x12eda9]<COOLDOWN_MS)return;const _0x5082bf=_0x4aca5b[_0x28c34a(0x1ed)][_0x28c34a(0x1f9)]||[],_0x41d8a0=normalize(_0x12eda9),_0x32251c=_0x5082bf[_0x28c34a(0x186)](_0x29a15d=>normalize(_0x29a15d['location'])===_0x41d8a0&&(_0x29a15d[_0x28c34a(0x1ad)]===_0x28c34a(0x20e)||_0x29a15d[_0x28c34a(0x1ad)]===_0x28c34a(0x1c9)||_0x29a15d['type']==='switch'));if(!_0x32251c)return;const _0x11932f=await aiAgent['consultButler'](_0x4aca5b,_0x12eda9,_0x32251c[_0x28c34a(0x1b6)],_0x493122);if(!_0x11932f[_0x28c34a(0x1c1)])return;const _0x2a2bf1=_0x28c34a(0x1d6)+_0x12eda9+_0x28c34a(0x203)+_0x32251c[_0x28c34a(0x1b6)]+'\x20('+_0x11932f[_0x28c34a(0x1cb)]+')';await logAutomationAction(_0x4aca5b,'['+_0x4d258b['toUpperCase']()+']\x20'+_0x2a2bf1);if(_0x4d258b===_0x28c34a(0x17d)){const _0x384408=await _0x4aca5b[_0x28c34a(0x1d2)](_0x32251c['id']);(!_0x384408||!_0x384408['val']&&_0x384408[_0x28c34a(0x232)]!==!![])&&await _0x4aca5b[_0x28c34a(0x225)](_0x32251c['id'],!![]),lastActions[_0x12eda9]=_0xd690f3;}}async function findRelatedId(_0x15b201,_0x287f12,_0x67d11c='setpoint'){const _0x52a3a9=a1_0x46b2ca;if(_0x67d11c===_0x52a3a9(0x1f0)&&_0x15b201['config'][_0x52a3a9(0x1a7)]){let _0x42e79c=_0x15b201['config'][_0x52a3a9(0x1a7)];if(typeof _0x42e79c===_0x52a3a9(0x223))try{_0x42e79c=JSON[_0x52a3a9(0x237)](_0x42e79c);}catch(_0x362a2d){}if(_0x42e79c&&_0x42e79c[_0x287f12])return _0x42e79c[_0x287f12];}if(_0x67d11c==='valve'&&_0x15b201[_0x52a3a9(0x1ed)][_0x52a3a9(0x1d5)]){let _0x280a2d=_0x15b201[_0x52a3a9(0x1ed)][_0x52a3a9(0x1d5)];if(typeof _0x280a2d===_0x52a3a9(0x223))try{_0x280a2d=JSON[_0x52a3a9(0x237)](_0x280a2d);}catch(_0x1df784){}if(_0x280a2d&&_0x280a2d[_0x287f12])return _0x280a2d[_0x287f12];}let _0x2bcae4=[];if(_0x67d11c===_0x52a3a9(0x1f0))_0x2bcae4=[{'s':_0x52a3a9(0x213),'t':_0x52a3a9(0x20b)},{'s':_0x52a3a9(0x211),'t':_0x52a3a9(0x20b)},{'s':_0x52a3a9(0x211),'t':_0x52a3a9(0x1c0)},{'s':_0x52a3a9(0x22d),'t':_0x52a3a9(0x1ff)},{'s':_0x52a3a9(0x198),'t':'occupied_heating_setpoint'},{'s':'local_temperature','t':'current_heating_setpoint'},{'s':_0x52a3a9(0x21d),'t':'target_temperature'},{'s':'ACTUAL','t':_0x52a3a9(0x1ef)},{'s':_0x52a3a9(0x1a4),'t':_0x52a3a9(0x1a2)},{'s':_0x52a3a9(0x21d),'t':'setpoint'}];else _0x67d11c===_0x52a3a9(0x1cd)&&(_0x2bcae4=[{'s':_0x52a3a9(0x213),'t':_0x52a3a9(0x189)},{'s':_0x52a3a9(0x211),'t':'.1.LEVEL'},{'s':_0x52a3a9(0x211),'t':_0x52a3a9(0x188)},{'s':_0x52a3a9(0x198),'t':_0x52a3a9(0x205)},{'s':_0x52a3a9(0x21d),'t':_0x52a3a9(0x1a3)},{'s':_0x52a3a9(0x21d),'t':_0x52a3a9(0x1f6)}]);for(const _0x49512f of _0x2bcae4){if(_0x287f12[_0x52a3a9(0x1dc)](_0x49512f['s'])){const _0x11a167=_0x287f12[_0x52a3a9(0x21f)](_0x49512f['s'],_0x49512f['t']),_0x2ffc5c=await _0x15b201['getForeignObjectAsync'](_0x11a167);if(_0x2ffc5c)return _0x11a167;}}try{const _0x4cafb8=_0x287f12['split']('.');if(_0x4cafb8[_0x52a3a9(0x1ac)]>0x2){const _0x57300b=_0x4cafb8[_0x52a3a9(0x1d3)](0x0,-0x1)[_0x52a3a9(0x184)]('.'),_0x467ff3=await _0x15b201[_0x52a3a9(0x17e)](_0x57300b+'.*'),_0x1c6e74=[],_0xc97711=_0x287f12['split'](/[._]+/)[_0x52a3a9(0x1e8)](_0x3f88d0=>![_0x52a3a9(0x23b),'0',_0x52a3a9(0x19c),_0x52a3a9(0x1ae),_0x52a3a9(0x1b1),'temperature',_0x52a3a9(0x1c3),_0x52a3a9(0x234),'messwert',_0x52a3a9(0x19f)][_0x52a3a9(0x1dc)](_0x3f88d0[_0x52a3a9(0x235)]()));for(const [_0x2f6039,_0x27dcdb]of Object['entries'](_0x467ff3)){if(_0x2f6039===_0x287f12)continue;if(_0x27dcdb&&_0x27dcdb[_0x52a3a9(0x1b8)]){const _0xbbb064=_0x2f6039['toLowerCase'](),_0x484c46=(_0x27dcdb['common'][_0x52a3a9(0x18a)]||'')[_0x52a3a9(0x235)](),_0x2bc3b=(_0x27dcdb[_0x52a3a9(0x1b8)][_0x52a3a9(0x17f)]||'')[_0x52a3a9(0x235)]();let _0x433cbd=![];if(_0x67d11c===_0x52a3a9(0x1f0)&&_0x27dcdb[_0x52a3a9(0x1b8)][_0x52a3a9(0x1e1)]===!![])_0x433cbd=_0xbbb064[_0x52a3a9(0x1dc)](_0x52a3a9(0x226))||_0xbbb064[_0x52a3a9(0x1dc)](_0x52a3a9(0x19d))||_0xbbb064[_0x52a3a9(0x1dc)](_0x52a3a9(0x1e0))||_0x484c46[_0x52a3a9(0x1dc)]('level.temperature')||_0x484c46['includes']('thermostat.setpoint');else _0x67d11c===_0x52a3a9(0x1cd)&&(_0x433cbd=_0xbbb064['includes'](_0x52a3a9(0x1f6))||_0xbbb064['includes']('valve')||_0xbbb064[_0x52a3a9(0x1dc)](_0x52a3a9(0x229))||_0xbbb064[_0x52a3a9(0x1dc)](_0x52a3a9(0x1b7))||_0x484c46['includes'](_0x52a3a9(0x1e3))||_0x484c46[_0x52a3a9(0x1dc)](_0x52a3a9(0x216))||_0x2bc3b[_0x52a3a9(0x1dc)]('%'));if(_0x433cbd){const _0x1db1d1=_0x2f6039[_0x52a3a9(0x1a8)](/[._]+/)['map'](_0x13f8b3=>_0x13f8b3[_0x52a3a9(0x235)]());let _0x278234=0x0;_0xc97711[_0x52a3a9(0x1df)](_0x4de9b7=>{const _0x1ff24c=_0x52a3a9;if(_0x1db1d1[_0x1ff24c(0x1dc)](_0x4de9b7['toLowerCase']()))_0x278234++;}),_0x1c6e74['push']({'id':_0x2f6039,'score':_0x278234});}}}if(_0x1c6e74[_0x52a3a9(0x1ac)]>0x0){_0x1c6e74[_0x52a3a9(0x1fb)]((_0x5e2624,_0x347e62)=>_0x347e62['score']-_0x5e2624[_0x52a3a9(0x1bf)]);if(_0x1c6e74[0x0][_0x52a3a9(0x1bf)]>0x0)return _0x1c6e74[0x0]['id'];}}}catch(_0x1d58d4){}return null;}function a1_0x3b3d(_0x4fd993,_0x26feaa){const _0xf0a8d3=a1_0xcc8d();return a1_0x3b3d=function(_0x2de9e9,_0x1320ed){_0x2de9e9=_0x2de9e9-0x179;let _0xcc8dcd=_0xf0a8d3[_0x2de9e9];return _0xcc8dcd;},a1_0x3b3d(_0x4fd993,_0x26feaa);}async function scanThermostats(_0x426c70){const _0x1c4198=a1_0x46b2ca,_0x1de03f=_0x426c70[_0x1c4198(0x1ed)]['devices']||[],_0x345791=[],_0x5e2c74=_0x1de03f['filter'](_0x58c7e6=>_0x58c7e6['id']&&_0x58c7e6['id']['includes'](_0x1c4198(0x21d))||_0x58c7e6[_0x1c4198(0x1ad)]&&[_0x1c4198(0x21d),'thermostat',_0x1c4198(0x234)][_0x1c4198(0x1dc)](_0x58c7e6[_0x1c4198(0x1ad)])||_0x58c7e6[_0x1c4198(0x1b6)]&&_0x58c7e6[_0x1c4198(0x1b6)][_0x1c4198(0x235)]()[_0x1c4198(0x1dc)](_0x1c4198(0x19b)));for(const _0x3bc79c of _0x5e2c74){const _0x3fe316=await findRelatedId(_0x426c70,_0x3bc79c['id'],_0x1c4198(0x1f0)),_0x42bed8=await findRelatedId(_0x426c70,_0x3bc79c['id'],_0x1c4198(0x1cd));let _0x32aa57=_0x1c4198(0x1e9),_0x213e21=![],_0x1cd7b9=_0x426c70[_0x1c4198(0x1ed)]['thermostatMapping']||{};if(typeof _0x1cd7b9===_0x1c4198(0x223))try{_0x1cd7b9=JSON[_0x1c4198(0x237)](_0x1cd7b9);}catch(_0x12e083){}let _0x41e062=_0x426c70[_0x1c4198(0x1ed)]['valveMapping']||{};if(typeof _0x41e062===_0x1c4198(0x223))try{_0x41e062=JSON[_0x1c4198(0x237)](_0x41e062);}catch(_0x3d5af4){}if(_0x1cd7b9[_0x3bc79c['id']]&&_0x1cd7b9[_0x3bc79c['id']]===_0x3fe316||_0x41e062[_0x3bc79c['id']]&&_0x41e062[_0x3bc79c['id']]===_0x42bed8)_0x32aa57=_0x1c4198(0x197),_0x213e21=!![];else(_0x3fe316||_0x42bed8)&&(_0x32aa57=_0x1c4198(0x1d1));_0x345791[_0x1c4198(0x1f7)]({'room':_0x3bc79c[_0x1c4198(0x1a6)]||'Unbekannt','sensorId':_0x3bc79c['id'],'setpointId':_0x3fe316||'-','valveId':_0x42bed8||'-','source':_0x32aa57,'isManual':_0x213e21,'status':_0x3fe316&&_0x42bed8?'PERFECT':_0x3fe316?'OK':_0x1c4198(0x1c2)});}return _0x345791[_0x1c4198(0x1fb)]((_0x1b62cd,_0x416e2b)=>_0x1b62cd[_0x1c4198(0x212)][_0x1c4198(0x208)](_0x416e2b[_0x1c4198(0x212)]));}async function updateSchedulePreview(_0x5aaa9d){const _0x345db8=a1_0x46b2ca;if(!_0x5aaa9d['config']['useCalendar']||!_0x5aaa9d['config'][_0x345db8(0x19a)])return;let _0x2969f4={};try{const _0x14341f=await _0x5aaa9d['getStateAsync'](_0x345db8(0x1b5));if(_0x14341f&&_0x14341f[_0x345db8(0x232)])_0x2969f4=JSON[_0x345db8(0x237)](_0x14341f[_0x345db8(0x232)]);}catch(_0x1b0491){}const _0x20177e=[],_0x5c7e4e=Date['now'](),_0x57429d=0x30*0x3c*0x3c*0x3e8;try{const _0x3a90e5=await _0x5aaa9d[_0x345db8(0x1d2)](_0x5aaa9d['config']['calendarInstance']+_0x345db8(0x1ce));if(!_0x3a90e5||!_0x3a90e5[_0x345db8(0x232)])return;const _0x4216b7=JSON['parse'](_0x3a90e5[_0x345db8(0x232)]),_0x3dc6c1=_0x5aaa9d[_0x345db8(0x1ed)][_0x345db8(0x21e)]||[],_0x4dae9f=_0x5aaa9d['config'][_0x345db8(0x1f9)]||[],_0xff55b5=new Set();_0x4dae9f[_0x345db8(0x1df)](_0x2b03d4=>{const _0x305b67=_0x345db8;if(_0x2b03d4[_0x305b67(0x1a6)])_0xff55b5[_0x305b67(0x1f2)](_0x2b03d4[_0x305b67(0x1a6)]);});for(const _0x3d0fc4 of _0x4216b7){if(_0x3d0fc4[_0x345db8(0x1b3)]&&_0x3dc6c1[_0x345db8(0x1ac)]>0x0&&!_0x3dc6c1['includes'](_0x3d0fc4['_calName']))continue;const _0xfdf59f=_0x3d0fc4['_date']||_0x3d0fc4['eventStart']||_0x3d0fc4['date'];if(!_0xfdf59f)continue;const _0x1a04a0=new Date(_0xfdf59f),_0x2ca9d9=_0x1a04a0[_0x345db8(0x1e2)]();if(isNaN(_0x2ca9d9))continue;if(_0x2ca9d9<_0x5c7e4e)continue;if(_0x2ca9d9>_0x5c7e4e+_0x57429d)continue;const _0xca557e=(_0x3d0fc4[_0x345db8(0x1a1)]||_0x3d0fc4[_0x345db8(0x20d)]||'')[_0x345db8(0x235)]();let _0x2f12e0=![],_0x4d11aa=[],_0x5c18a2=_0x3d0fc4[_0x345db8(0x1a1)]||_0x3d0fc4[_0x345db8(0x20d)]||_0x345db8(0x1b2);if(_0xca557e[_0x345db8(0x1dc)](_0x345db8(0x1fe))||_0xca557e[_0x345db8(0x1dc)](_0x345db8(0x1bb))||_0xca557e[_0x345db8(0x1dc)](_0x345db8(0x185)))_0x2f12e0=!![],_0x4d11aa=Array[_0x345db8(0x1f5)](_0xff55b5);else for(const _0x54b127 of _0xff55b5){if(_0xca557e[_0x345db8(0x1dc)](_0x54b127['toLowerCase']()))_0x4d11aa['push'](_0x54b127);}_0x4d11aa[_0x345db8(0x1ac)]>0x0&&_0x4d11aa[_0x345db8(0x1df)](_0x306001=>{const _0x4e7ec0=_0x345db8;let _0x3e761a=0x3c;if(_0x2f12e0){let _0x59be17=0x0;Object[_0x4e7ec0(0x214)](_0x2969f4)[_0x4e7ec0(0x1df)](_0x3dc22e=>{if(_0x3dc22e>_0x59be17)_0x59be17=_0x3dc22e;}),_0x3e761a=_0x59be17>0x0?_0x59be17:0x78;}else _0x3e761a=getWarmupRobust(_0x2969f4,_0x306001);const _0x148b99=new Date(_0x2ca9d9-_0x3e761a*0xea60);_0x20177e[_0x4e7ec0(0x1f7)]({'eventTime':_0x2ca9d9,'triggerTime':_0x148b99[_0x4e7ec0(0x1e2)](),'room':_0x306001,'minutes':_0x3e761a,'reason':_0x5c18a2,'isGlobal':_0x2f12e0});});}}catch(_0x235193){}_0x20177e[_0x345db8(0x1fb)]((_0x54f65b,_0x5e3d13)=>_0x54f65b['triggerTime']-_0x5e3d13[_0x345db8(0x190)]);const _0x46e36c=_0x20177e[_0x345db8(0x1d3)](0x0,0x1e);await _0x5aaa9d[_0x345db8(0x1a5)]('analysis.energy.schedulePreview',{'val':JSON['stringify'](_0x46e36c),'ack':!![]});}async function monitorEnforcements(_0x2e26e6){const _0x5359a6=a1_0x46b2ca;try{const _0x31cda6=_0x5359a6(0x1db),_0x59c856=await _0x2e26e6[_0x5359a6(0x210)](_0x31cda6);if(!_0x59c856||!_0x59c856[_0x5359a6(0x232)])return;let _0x4526bc=[];try{_0x4526bc=JSON[_0x5359a6(0x237)](_0x59c856[_0x5359a6(0x232)]);}catch(_0x4eb227){return;}if(!Array[_0x5359a6(0x23a)](_0x4526bc)||_0x4526bc[_0x5359a6(0x1ac)]===0x0)return;const _0x1fc94d=Date[_0x5359a6(0x1c7)](),_0x2957f5=_0x2e26e6[_0x5359a6(0x1ed)][_0x5359a6(0x1f9)]||[];let _0x329a07=![];for(let _0x3c8c86=_0x4526bc[_0x5359a6(0x1ac)]-0x1;_0x3c8c86>=0x0;_0x3c8c86--){const _0x31eb38=_0x4526bc[_0x3c8c86];if(_0x1fc94d>=_0x31eb38[_0x5359a6(0x20a)]){_0x2e26e6['log'][_0x5359a6(0x1ee)](_0x5359a6(0x239)+_0x31eb38['room']+_0x5359a6(0x1de)),_0x4526bc[_0x5359a6(0x220)](_0x3c8c86,0x1),_0x329a07=!![];continue;}const _0x1b965a=_0x2957f5[_0x5359a6(0x186)](_0x35e96d=>normalize(_0x35e96d[_0x5359a6(0x1a6)])===normalize(_0x31eb38['room'])&&(_0x35e96d[_0x5359a6(0x1ad)]===_0x5359a6(0x21d)||_0x35e96d['type']===_0x5359a6(0x1fa)));if(_0x1b965a){const _0x154771=await findRelatedId(_0x2e26e6,_0x1b965a['id'],_0x5359a6(0x1f0));if(_0x154771){const _0x9959a2=await _0x2e26e6[_0x5359a6(0x1d2)](_0x154771);_0x9959a2&&typeof _0x9959a2[_0x5359a6(0x232)]===_0x5359a6(0x1bc)&&(_0x9959a2['val']<0xf&&(_0x2e26e6[_0x5359a6(0x18c)][_0x5359a6(0x192)](_0x5359a6(0x219)+_0x31eb38['room']+_0x5359a6(0x17b)+_0x9959a2[_0x5359a6(0x232)]+'Â°C\x20abgesenkt!\x20Zwinge\x20zurÃ¼ck\x20auf\x20'+_0x31eb38[_0x5359a6(0x1e0)]+_0x5359a6(0x202)),await _0x2e26e6[_0x5359a6(0x225)](_0x154771,_0x31eb38[_0x5359a6(0x1e0)]),await logAutomationAction(_0x2e26e6,_0x5359a6(0x18f)+_0x31eb38[_0x5359a6(0x212)]+':\x20'+_0x9959a2[_0x5359a6(0x232)]+_0x5359a6(0x1c6)+_0x31eb38[_0x5359a6(0x1e0)]+_0x5359a6(0x179))));}}}_0x329a07&&await _0x2e26e6[_0x5359a6(0x1a5)](_0x31cda6,{'val':JSON[_0x5359a6(0x1e4)](_0x4526bc),'ack':!![]});}catch(_0x4a42fb){_0x2e26e6['log']['error'](_0x5359a6(0x1ca)+_0x4a42fb[_0x5359a6(0x1b9)]);}}async function checkCalendarTriggers(_0x50ba2a){const _0x3f8584=a1_0x46b2ca;if(!_0x50ba2a[_0x3f8584(0x1ed)][_0x3f8584(0x222)]||!_0x50ba2a['config'][_0x3f8584(0x19a)])return;await updateSchedulePreview(_0x50ba2a);let _0x470b4b={},_0x2fd112={};try{const _0x67c289=await _0x50ba2a[_0x3f8584(0x210)]('analysis.energy.warmupTimes');if(_0x67c289&&_0x67c289[_0x3f8584(0x232)])_0x470b4b=JSON[_0x3f8584(0x237)](_0x67c289[_0x3f8584(0x232)]);const _0x46e0b7=await _0x50ba2a[_0x3f8584(0x210)](_0x3f8584(0x1af));if(_0x46e0b7&&_0x46e0b7[_0x3f8584(0x232)])_0x2fd112=JSON[_0x3f8584(0x237)](_0x46e0b7['val']);}catch(_0x1be85f){}let _0x5d1b45={'default':0x15};try{const _0x4725da=await _0x50ba2a['getStateAsync'](_0x3f8584(0x1aa));if(_0x4725da&&_0x4725da[_0x3f8584(0x232)])_0x5d1b45=JSON[_0x3f8584(0x237)](_0x4725da[_0x3f8584(0x232)]);}catch(_0x50afef){}let _0x5ccfae=[];try{const _0x1f1b71=await _0x50ba2a[_0x3f8584(0x210)]('analysis.energy.activeEnforcements');if(_0x1f1b71&&_0x1f1b71[_0x3f8584(0x232)])_0x5ccfae=JSON[_0x3f8584(0x237)](_0x1f1b71[_0x3f8584(0x232)]);}catch(_0x25bdd1){}try{const _0x401a8e=await _0x50ba2a[_0x3f8584(0x1d2)](_0x50ba2a['config'][_0x3f8584(0x19a)]+'.data.table');if(!_0x401a8e||!_0x401a8e[_0x3f8584(0x232)])return;const _0x28a034=JSON[_0x3f8584(0x237)](_0x401a8e[_0x3f8584(0x232)]),_0x25cb22=Date[_0x3f8584(0x1c7)](),_0x15deab=_0x50ba2a[_0x3f8584(0x1ed)][_0x3f8584(0x1f9)]||[],_0x44748d=_0x50ba2a[_0x3f8584(0x1ed)][_0x3f8584(0x21e)]||[];let _0x3da2be=![];for(const _0x981663 of _0x28a034){if(_0x981663['_calName']&&_0x44748d[_0x3f8584(0x1ac)]>0x0&&!_0x44748d['includes'](_0x981663['_calName']))continue;const _0x39e80e=_0x981663['_date']||_0x981663[_0x3f8584(0x1f8)]||_0x981663[_0x3f8584(0x1f1)];if(!_0x39e80e)continue;const _0x22e154=new Date(_0x39e80e);if(isNaN(_0x22e154[_0x3f8584(0x1e2)]()))continue;const _0x4efbe3=(_0x981663[_0x3f8584(0x1a1)]||_0x981663[_0x3f8584(0x20d)]||'')[_0x3f8584(0x235)]();if(_0x4efbe3['includes']('urlaub\x20ende')||_0x4efbe3[_0x3f8584(0x1dc)](_0x3f8584(0x1bb))||_0x4efbe3[_0x3f8584(0x1dc)]('ankunft')){let _0x42051f=0x0;Object[_0x3f8584(0x214)](_0x470b4b)[_0x3f8584(0x1df)](_0xfb64ee=>{if(_0xfb64ee>_0x42051f)_0x42051f=_0xfb64ee;});if(_0x42051f===0x0)_0x42051f=0x78;const _0x445a3e=_0x22e154[_0x3f8584(0x1e2)]()-_0x42051f*0xea60;_0x25cb22>=_0x445a3e&&_0x25cb22<_0x22e154['getTime']()&&(_0x50ba2a[_0x3f8584(0x195)]!==_0x3f8584(0x1c8)&&(_0x50ba2a[_0x3f8584(0x18c)][_0x3f8584(0x1ee)]('ðŸ“…\x20SMART\x20SCHEDULE\x20(Phase):\x20\x27Globaler\x20Start\x27\x20erkannt.\x20Heize\x20Haus\x20auf\x20(Vorlauf:\x20'+_0x42051f+_0x3f8584(0x1d0)),await _0x50ba2a[_0x3f8584(0x1a5)](_0x3f8584(0x20f),{'val':_0x3f8584(0x1c8),'ack':![]})));}for(const _0x59877f of _0x15deab){if(_0x59877f['location']){const _0x471008=_0x59877f[_0x3f8584(0x1a6)][_0x3f8584(0x235)](),_0x27b7a6=(_0x59877f['name']||'')[_0x3f8584(0x235)]();let _0x343c51=_0x4efbe3[_0x3f8584(0x1dc)](_0x471008);!_0x343c51&&_0x27b7a6[_0x3f8584(0x1ac)]>0x3&&_0x4efbe3[_0x3f8584(0x1dc)](_0x27b7a6)&&(_0x343c51=!![]);if(_0x343c51){const _0x4dadbd=getWarmupRobust(_0x470b4b,_0x59877f[_0x3f8584(0x1a6)]),_0x37eb81=_0x2fd112[_0x59877f[_0x3f8584(0x1a6)]]||_0x3f8584(0x1da),_0x547e95=_0x22e154['getTime']()-_0x4dadbd*0xea60;if(_0x25cb22>=_0x547e95&&_0x25cb22<_0x22e154[_0x3f8584(0x1e2)]()){const _0x6398f2=lastActions[_0x3f8584(0x221)+_0x59877f[_0x3f8584(0x1a6)]];if(_0x6398f2&&_0x25cb22-_0x6398f2<CAL_COOLDOWN_MS)continue;const _0x15e2c4=await findRelatedId(_0x50ba2a,_0x59877f['id'],_0x3f8584(0x1f0));if(_0x15e2c4){let _0x2b047b=_0x5d1b45[_0x59877f['location']];if(_0x2b047b===undefined)_0x2b047b=_0x5d1b45[_0x3f8584(0x21b)];if(_0x2b047b===undefined)_0x2b047b=0x15;const _0x3918a4=await _0x50ba2a['getForeignStateAsync'](_0x15e2c4);if(_0x3918a4&&typeof _0x3918a4[_0x3f8584(0x232)]===_0x3f8584(0x1bc)&&_0x3918a4[_0x3f8584(0x232)]<_0x2b047b-0.5){_0x50ba2a[_0x3f8584(0x18c)][_0x3f8584(0x1ee)](_0x3f8584(0x217)+_0x37eb81+_0x3f8584(0x1c5)+_0x59877f[_0x3f8584(0x1a6)]+_0x3f8584(0x231)+_0x4efbe3+_0x3f8584(0x1ec)+_0x2b047b+_0x3f8584(0x1be)+_0x4dadbd+_0x3f8584(0x1d0)),await _0x50ba2a['setForeignStateAsync'](_0x15e2c4,_0x2b047b),await logAutomationAction(_0x50ba2a,_0x3f8584(0x1e7)+_0x59877f[_0x3f8584(0x1a6)]+_0x3f8584(0x206)+_0x2b047b+_0x3f8584(0x182)+_0x37eb81+')'),lastActions[_0x3f8584(0x221)+_0x59877f[_0x3f8584(0x1a6)]]=_0x25cb22;const _0x4d910a=_0x5ccfae[_0x3f8584(0x21c)](_0x533643=>_0x533643[_0x3f8584(0x212)]===_0x59877f[_0x3f8584(0x1a6)]);if(_0x4d910a!==-0x1)_0x5ccfae['splice'](_0x4d910a,0x1);_0x5ccfae['push']({'room':_0x59877f['location'],'target':_0x2b047b,'until':_0x22e154[_0x3f8584(0x1e2)]()}),_0x3da2be=!![];}}}}}}}_0x3da2be&&await _0x50ba2a['setStateAsync'](_0x3f8584(0x1db),{'val':JSON[_0x3f8584(0x1e4)](_0x5ccfae),'ack':!![]});}catch(_0x5c45d5){_0x50ba2a[_0x3f8584(0x18c)][_0x3f8584(0x192)](_0x3f8584(0x1bd)+_0x5c45d5['message']);}}async function manageMpcIntervention(_0x30a009,_0x7e3265,_0x5b07e3){const _0x49f559=a1_0x46b2ca;try{const _0x9cf60b='analysis.energy.mpcActiveInterventions',_0x46b8e9=await _0x30a009[_0x49f559(0x210)](_0x9cf60b);let _0x3f8cdd=[];if(_0x46b8e9&&_0x46b8e9[_0x49f559(0x232)])try{_0x3f8cdd=JSON['parse'](_0x46b8e9[_0x49f559(0x232)]);}catch(_0x44ff22){}const _0x4407de=_0x3f8cdd['indexOf'](_0x7e3265);if(_0x5b07e3==='add')_0x4407de===-0x1&&(_0x3f8cdd[_0x49f559(0x1f7)](_0x7e3265),await _0x30a009[_0x49f559(0x1a5)](_0x9cf60b,{'val':JSON[_0x49f559(0x1e4)](_0x3f8cdd),'ack':!![]}));else _0x5b07e3===_0x49f559(0x1f3)&&(_0x4407de!==-0x1&&(_0x3f8cdd['splice'](_0x4407de,0x1),await _0x30a009[_0x49f559(0x1a5)](_0x9cf60b,{'val':JSON[_0x49f559(0x1e4)](_0x3f8cdd),'ack':!![]})));}catch(_0x4a4902){}}async function cleanupGhostInterventions(_0x4a3b03){const _0x18db6e=a1_0x46b2ca;try{const _0x5c2845=_0x18db6e(0x22e),_0x5e7a24=await _0x4a3b03[_0x18db6e(0x210)](_0x5c2845);if(!_0x5e7a24||!_0x5e7a24['val'])return;const _0x9bd769=JSON[_0x18db6e(0x237)](_0x5e7a24[_0x18db6e(0x232)]);if(!Array[_0x18db6e(0x23a)](_0x9bd769)||_0x9bd769['length']===0x0)return;let _0x10f249={'default':0x15};try{const _0x101d56=await _0x4a3b03[_0x18db6e(0x210)](_0x18db6e(0x1aa));if(_0x101d56&&_0x101d56[_0x18db6e(0x232)])_0x10f249=JSON[_0x18db6e(0x237)](_0x101d56[_0x18db6e(0x232)]);}catch(_0x5bc284){}let _0x3bd47d=[];try{const _0x3416cd=await _0x4a3b03['getStateAsync']('analysis.energy.ventilationAlerts');if(_0x3416cd&&_0x3416cd[_0x18db6e(0x232)])_0x3bd47d=JSON['parse'](_0x3416cd[_0x18db6e(0x232)]);}catch(_0x42bb63){}let _0x1c0d53={},_0x46bef6=![];try{const _0x767d11=await _0x4a3b03[_0x18db6e(0x210)]('analysis.energy.rlPenalties');if(_0x767d11&&_0x767d11[_0x18db6e(0x232)])_0x1c0d53=JSON[_0x18db6e(0x237)](_0x767d11[_0x18db6e(0x232)]);}catch(_0x452857){}if(_0x1c0d53['_meta']){const _0x13af46=Date[_0x18db6e(0x1c7)]();for(const [_0x20d57c,_0x31a4f6]of Object[_0x18db6e(0x187)](_0x1c0d53[_0x18db6e(0x22f)])){_0x13af46-_0x31a4f6>PENALTY_TTL&&(delete _0x1c0d53[_0x20d57c],delete _0x1c0d53['_meta'][_0x20d57c],_0x46bef6=!![],_0x4a3b03[_0x18db6e(0x18c)]['info']('ðŸ›¡ï¸\x20[PENALTY\x20EXPIRED]\x20Lern-Schutz\x20fÃ¼r\x20\x27'+_0x20d57c+_0x18db6e(0x20c)));}}const _0x2c833f=_0x4a3b03[_0x18db6e(0x1ed)][_0x18db6e(0x1f9)]||[];let _0x57ef65=![];for(let _0x2b70fa=_0x9bd769[_0x18db6e(0x1ac)]-0x1;_0x2b70fa>=0x0;_0x2b70fa--){const _0x16b46c=_0x9bd769[_0x2b70fa],_0x2c4ec3=_0x2c833f[_0x18db6e(0x186)](_0x49e64a=>normalize(_0x49e64a[_0x18db6e(0x1a6)])===normalize(_0x16b46c)&&(_0x49e64a[_0x18db6e(0x1ad)]===_0x18db6e(0x21d)||_0x49e64a[_0x18db6e(0x1ad)]===_0x18db6e(0x1fa)));if(!_0x2c4ec3){_0x4a3b03[_0x18db6e(0x18c)]['warn']('ðŸ§¹\x20[MPC\x20CLEANUP]\x20Raum\x20\x27'+_0x16b46c+'\x27\x20hat\x20kein\x20GerÃ¤t\x20mehr.\x20LÃ¶sche\x20Eintrag.'),_0x9bd769[_0x18db6e(0x220)](_0x2b70fa,0x1),_0x57ef65=!![];continue;}if(_0x2c4ec3){const _0xaac17c=await findRelatedId(_0x4a3b03,_0x2c4ec3['id'],_0x18db6e(0x1f0)),_0x28e293=await _0x4a3b03['getForeignStateAsync'](_0x2c4ec3['id']);if(_0xaac17c){const _0x50eb73=await _0x4a3b03[_0x18db6e(0x1d2)](_0xaac17c);if(_0x50eb73&&typeof _0x50eb73['val']==='number'){let _0x405314=![],_0x33dd42='';Math[_0x18db6e(0x1a0)](_0x50eb73[_0x18db6e(0x232)]-ECO_TEMP)>0.5&&(_0x405314=!![],_0x33dd42='manual');if(!_0x405314&&_0x28e293&&typeof _0x28e293[_0x18db6e(0x232)]===_0x18db6e(0x1bc)){const _0x4aa2a0=_0x10f249[_0x16b46c]||_0x10f249[_0x18db6e(0x21b)]||0x15;_0x28e293[_0x18db6e(0x232)]<_0x4aa2a0+0.2&&(_0x405314=!![],_0x33dd42='too_cold');}if(_0x405314){if(_0x33dd42===_0x18db6e(0x1cc)){_0x4a3b03[_0x18db6e(0x18c)][_0x18db6e(0x1ee)](_0x18db6e(0x191)+_0x16b46c+'\x20ist\x20auf\x20'+_0x50eb73[_0x18db6e(0x232)]+_0x18db6e(0x1b4)+ECO_TEMP+_0x18db6e(0x1fc));const _0x221ddd=lastActions[_0x18db6e(0x221)+_0x16b46c],_0x38117e=_0x221ddd&&Date[_0x18db6e(0x1c7)]()-_0x221ddd<0x2*0x3c*0x3e8;if(!_0x38117e&&_0x50eb73[_0x18db6e(0x232)]>ECO_TEMP+0.5){_0x4a3b03[_0x18db6e(0x22c)]&&(_0x4a3b03['log'][_0x18db6e(0x1ee)](_0x18db6e(0x21a)+_0x16b46c+_0x18db6e(0x1a9)),_0x4a3b03[_0x18db6e(0x22c)](_0x18db6e(0x194),{'room':_0x16b46c}));const _0x42c4b9=_0x16b46c+'_'+new Date()[_0x18db6e(0x233)]();if(!_0x1c0d53[_0x42c4b9]){_0x1c0d53[_0x42c4b9]=0x1;if(!_0x1c0d53[_0x18db6e(0x22f)])_0x1c0d53[_0x18db6e(0x22f)]={};_0x1c0d53[_0x18db6e(0x22f)][_0x42c4b9]=Date[_0x18db6e(0x1c7)](),_0x46bef6=!![];}}else _0x38117e&&_0x4a3b03[_0x18db6e(0x18c)][_0x18db6e(0x1ee)](_0x18db6e(0x18b)+_0x16b46c+_0x18db6e(0x224));}else{if(_0x33dd42===_0x18db6e(0x227)){let _0x4f8280=![];if(_0x3bd47d[_0x18db6e(0x186)](_0x27232a=>_0x27232a[_0x18db6e(0x212)]===_0x16b46c))_0x4f8280=!![];const _0x332b96=_0x2c833f[_0x18db6e(0x1e8)](_0x3b5ee4=>normalize(_0x3b5ee4[_0x18db6e(0x1a6)])===normalize(_0x16b46c)&&(_0x3b5ee4['type']==='window'||_0x3b5ee4['type']===_0x18db6e(0x234)||_0x3b5ee4[_0x18db6e(0x1ad)]===_0x18db6e(0x1dd)));for(const _0x381f22 of _0x332b96){try{const _0x3b4d44=await _0x4a3b03['getForeignStateAsync'](_0x381f22['id']);if(_0x3b4d44&&(_0x3b4d44[_0x18db6e(0x232)]===!![]||_0x3b4d44[_0x18db6e(0x232)]===0x1||String(_0x3b4d44[_0x18db6e(0x232)])['toLowerCase']()==='open'))_0x4f8280=!![];}catch(_0x10f823){}}if(_0x4f8280)_0x4a3b03[_0x18db6e(0x18c)][_0x18db6e(0x1ee)](_0x18db6e(0x209)+_0x16b46c+'\x20ist\x20zu\x20kalt,\x20ABER\x20Fenster\x20offen/LÃ¼ftung\x20erkannt.\x20Heize\x20NICHT,\x20entferne\x20nur\x20Status.');else{const _0x490911=_0x10f249[_0x16b46c]||_0x10f249[_0x18db6e(0x21b)]||0x15;_0x4a3b03[_0x18db6e(0x18c)][_0x18db6e(0x1ee)](_0x18db6e(0x201)+_0x16b46c+_0x18db6e(0x1fd)+_0x28e293[_0x18db6e(0x232)]+_0x18db6e(0x230)+(_0x490911+0.2)+_0x18db6e(0x22b)),await _0x4a3b03['setForeignStateAsync'](_0xaac17c,_0x490911),await logAutomationAction(_0x4a3b03,_0x18db6e(0x23c)+_0x16b46c+_0x18db6e(0x22a)+_0x490911+'Â°C'),lastActions['rescue_'+_0x16b46c]=Date['now']();}}}_0x9bd769[_0x18db6e(0x220)](_0x2b70fa,0x1),_0x57ef65=!![];}}}}}_0x57ef65&&await _0x4a3b03[_0x18db6e(0x1a5)](_0x5c2845,{'val':JSON[_0x18db6e(0x1e4)](_0x9bd769),'ack':!![]}),_0x46bef6&&await _0x4a3b03[_0x18db6e(0x1a5)](_0x18db6e(0x1d9),{'val':JSON['stringify'](_0x1c0d53),'ack':!![]});}catch(_0x3116a9){}}async function applyEnergySavings(_0x19ea1a,_0x430cc7){const _0x326875=a1_0x46b2ca;await cleanupGhostInterventions(_0x19ea1a);if(!_0x430cc7||_0x430cc7[_0x326875(0x1ac)]===0x0)return;const _0x86e58e=_0x19ea1a[_0x326875(0x1ed)][_0x326875(0x1f9)]||[],_0x16d3b2=Date['now']();for(const _0xb9d02a of _0x430cc7){const _0x253ee4=_0xb9d02a[_0x326875(0x212)],_0x5e67e5=_0xb9d02a['minutes_safe'],_0x177899=_0xb9d02a[_0x326875(0x1e0)]||0x15;if(lastActions[_0x326875(0x1d4)+_0x253ee4]&&_0x16d3b2-lastActions[_0x326875(0x1d4)+_0x253ee4]<RESCUE_LOCK_MS)continue;const _0x4c709b=_0x86e58e[_0x326875(0x186)](_0x1b5d43=>normalize(_0x1b5d43[_0x326875(0x1a6)])===normalize(_0x253ee4)&&(_0x1b5d43[_0x326875(0x1ad)]==='temperature'||_0x1b5d43[_0x326875(0x1ad)]===_0x326875(0x1fa)));if(!_0x4c709b)continue;const _0xe94bac=await findRelatedId(_0x19ea1a,_0x4c709b['id'],_0x326875(0x1f0));if(_0xe94bac){if(lastActions[_0x326875(0x1ea)+_0x253ee4]&&_0x16d3b2-lastActions['mpc_'+_0x253ee4]<0x1e*0x3c*0x3e8)continue;const _0x1871fb=await _0x19ea1a['getForeignStateAsync'](_0xe94bac);if(_0x1871fb&&typeof _0x1871fb[_0x326875(0x232)]===_0x326875(0x1bc)){const _0x5709ff=_0x1871fb['val'];_0x5709ff!==ECO_TEMP&&await manageMpcIntervention(_0x19ea1a,_0x253ee4,_0x326875(0x1f3));if(_0x5e67e5>0x1e)_0x5709ff>ECO_TEMP+0.5&&(_0x19ea1a[_0x326875(0x18c)][_0x326875(0x1ee)](_0x326875(0x1eb)+_0x253ee4+_0x326875(0x17b)+ECO_TEMP+_0x326875(0x1d8)+_0x5e67e5+_0x326875(0x238)),await _0x19ea1a[_0x326875(0x225)](_0xe94bac,ECO_TEMP),await manageMpcIntervention(_0x19ea1a,_0x253ee4,_0x326875(0x1f2)),lastActions[_0x326875(0x1ea)+_0x253ee4]=_0x16d3b2,await logAutomationAction(_0x19ea1a,_0x326875(0x17c)+_0x253ee4+_0x326875(0x19e)+ECO_TEMP+'Â°C'));else _0x5e67e5<=0xf&&(_0x5709ff<_0x177899&&(_0x19ea1a[_0x326875(0x18c)][_0x326875(0x1ee)]('ðŸ”¥\x20[MPC\x20ACTION]\x20Heize\x20'+_0x253ee4+'\x20wieder\x20auf\x20'+_0x177899+_0x326875(0x181)),await _0x19ea1a['setForeignStateAsync'](_0xe94bac,_0x177899),await manageMpcIntervention(_0x19ea1a,_0x253ee4,_0x326875(0x1f3)),lastActions[_0x326875(0x1ea)+_0x253ee4]=_0x16d3b2,await logAutomationAction(_0x19ea1a,_0x326875(0x17c)+_0x253ee4+_0x326875(0x204)+_0x177899+'Â°C')));}}else _0x19ea1a['log'][_0x326875(0x192)](_0x326875(0x200)+_0x253ee4+_0x326875(0x196));}}module[a1_0x46b2ca(0x183)]={'handlePrediction':handlePrediction,'applyEnergySavings':applyEnergySavings,'scanThermostats':scanThermostats,'checkCalendarTriggers':checkCalendarTriggers,'monitorEnforcements':monitorEnforcements,'updateSchedulePreview':updateSchedulePreview,'cleanupGhostInterventions':cleanupGhostInterventions};