const a5_0xc6c1c3=a5_0x2fe6;(function(_0x7f02f1,_0x340c46){const _0x78eb48=a5_0x2fe6,_0x1ccbbb=_0x7f02f1();while(!![]){try{const _0x1fe4c6=-parseInt(_0x78eb48(0xfd))/0x1*(-parseInt(_0x78eb48(0xf0))/0x2)+parseInt(_0x78eb48(0xbd))/0x3*(parseInt(_0x78eb48(0xc1))/0x4)+-parseInt(_0x78eb48(0x103))/0x5+-parseInt(_0x78eb48(0xf4))/0x6+parseInt(_0x78eb48(0xd9))/0x7*(-parseInt(_0x78eb48(0xea))/0x8)+-parseInt(_0x78eb48(0xcd))/0x9+parseInt(_0x78eb48(0x107))/0xa;if(_0x1fe4c6===_0x340c46)break;else _0x1ccbbb['push'](_0x1ccbbb['shift']());}catch(_0x5c1959){_0x1ccbbb['push'](_0x1ccbbb['shift']());}}}(a5_0x2cf8,0x37c9e));const a5_0x2979b1=(function(){let _0x404079=!![];return function(_0x133ca0,_0x56692a){const _0x2c5291=_0x404079?function(){if(_0x56692a){const _0x459d0d=_0x56692a['apply'](_0x133ca0,arguments);return _0x56692a=null,_0x459d0d;}}:function(){};return _0x404079=![],_0x2c5291;};}()),a5_0x2ebffd=a5_0x2979b1(this,function(){const _0x1180d8=a5_0x2fe6;return a5_0x2ebffd[_0x1180d8(0xce)]()[_0x1180d8(0x108)](_0x1180d8(0xaf))[_0x1180d8(0xce)]()[_0x1180d8(0xfc)](a5_0x2ebffd)[_0x1180d8(0x108)]('(((.+)+)+)+$');});a5_0x2ebffd();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x18fe84){const _0x3e79ac=a5_0x2fe6;if(_0x18fe84[_0x3e79ac(0xb2)][_0x3e79ac(0xf2)])try{const _0x10ec27=await _0x18fe84[_0x3e79ac(0xc8)](_0x18fe84[_0x3e79ac(0xb2)][_0x3e79ac(0xf2)]);if(_0x10ec27&&_0x10ec27[_0x3e79ac(0xd0)]!==undefined&&_0x10ec27['val']!==null)return parseFloat(_0x10ec27[_0x3e79ac(0xd0)]);}catch(_0x4756cc){}const _0x474f32=_0x18fe84[_0x3e79ac(0xb2)][_0x3e79ac(0xf3)];if(!_0x18fe84['config'][_0x3e79ac(0xc7)]||!_0x474f32)return null;try{let _0x2a8455='';if(_0x474f32[_0x3e79ac(0xe0)]('accuweather'))_0x2a8455=_0x474f32+_0x3e79ac(0xb5);else{if(_0x474f32[_0x3e79ac(0xe0)](_0x3e79ac(0xd3)))_0x2a8455=_0x474f32+_0x3e79ac(0xa9);else{if(_0x474f32[_0x3e79ac(0xe0)](_0x3e79ac(0xa0)))_0x2a8455=_0x474f32+'.forecast.current.temperature';else{if(_0x474f32[_0x3e79ac(0xe0)](_0x3e79ac(0xbe)))_0x2a8455=_0x474f32+_0x3e79ac(0xaa);}}}if(_0x2a8455){const _0x448906=await _0x18fe84[_0x3e79ac(0xc8)](_0x2a8455);if(_0x448906&&_0x448906[_0x3e79ac(0xd0)]!==undefined&&_0x448906[_0x3e79ac(0xd0)]!==null)return parseFloat(_0x448906[_0x3e79ac(0xd0)]);}}catch(_0x51743c){}return null;}function a5_0x2cf8(){const _0x4361b7=['outdoorSensorId','weatherInstance','1873260pNVnhV','isExit','.1.LEVEL','valveMapping','now','t체r','level','length','constructor','677DGikXX','.1.ACTUAL_TEMPERATURE','light','currentSystemMode','error','licht','1565550mSLMgz','isGracePeriodActive','switch','.1.VALVE_STATE','3196570LMSvdc','search','shift','thermostat','lastTrackerEventTime','sendToPythonWrapper','openweathermap','temperatur','motion','handle','pr채senz','lampe','temperature','stringify','TRACK_EVENT','.NextHours.Location_1.Day_1.current.temp_value','.forecast.current.temp','\x20from\x20','eventHistory','LTM.rawEventLog','setStateAsync','(((.+)+)+)+$','location','unshift','config','exports','isProVersion','.Current.Temperature','STATUS','pop','klima','.4.VALVE_STATE','log','fenster','Valve','374565ZVoVGX','weatherunderground','message','occupancy','12RzeVrb','heizung','Unknown','getStateAsync','door','type','useWeather','getForeignStateAsync','events.lastEvent','bewegung','presence','LTM.trainingData.sequences','552717oAvpFc','toString','exitTimer','val','schalter','toISOString','daswetter','[RECORDER]\x20Error:\x20','number','push','rawEventLog','debug','49VjHSDC','dimmer','parse','.LEVEL','from','string','schloss','includes','LEVEL','kontakt','loc','toLowerCase','.1.TEMPERATURE','getHours','exitGraceTimer','round','isPresent','46832QfDlfO','window','splice','logDuplicates','lock','normal','774YjlWav','some'];a5_0x2cf8=function(){return _0x4361b7;};return a5_0x2cf8();}async function recordThermodynamics(_0x12245a,_0x5b55af,_0x4df3bc,_0x34654a){const _0x59a577=a5_0x2fe6,_0x5c32e3=await getOutsideTemperatureNumeric(_0x12245a);if(_0x5c32e3===null)return;let _0x24185a=0x0,_0xa0422c=![];if(_0x12245a[_0x59a577(0xb2)][_0x59a577(0xf7)])try{let _0xd9693c=_0x12245a[_0x59a577(0xb2)][_0x59a577(0xf7)];if(typeof _0xd9693c===_0x59a577(0xde))_0xd9693c=JSON['parse'](_0xd9693c);if(_0xd9693c[_0x5b55af]){const _0x209b76=_0xd9693c[_0x5b55af],_0x523040=await _0x12245a[_0x59a577(0xc8)](_0x209b76);if(_0x523040&&_0x523040['val']!==null&&_0x523040['val']!==undefined){let _0x171efa=Number(_0x523040[_0x59a577(0xd0)]);if(_0x171efa<=1.05&&!_0x209b76[_0x59a577(0xe0)](_0x59a577(0xb6))&&!_0x209b76[_0x59a577(0xe0)]('STATE'))_0x171efa=_0x171efa*0x64;_0x24185a=Math[_0x59a577(0xe8)](_0x171efa),_0xa0422c=!![];}}}catch(_0x2f239f){}if(!_0xa0422c){const _0x55d6fe=[{'from':_0x59a577(0xfe),'to':_0x59a577(0xf6)},{'from':'.1.ACTUAL_TEMPERATURE','to':_0x59a577(0x106)},{'from':_0x59a577(0xe5),'to':_0x59a577(0xb9)},{'from':'.ACTUAL_TEMPERATURE','to':_0x59a577(0xdc)},{'from':_0x59a577(0xa6),'to':_0x59a577(0xfa)},{'from':'Temperature','to':_0x59a577(0xbc)}];for(const _0x34a095 of _0x55d6fe){if(_0x5b55af[_0x59a577(0xe0)](_0x34a095[_0x59a577(0xdd)])){const _0x1a1e00=_0x5b55af['replace'](_0x34a095[_0x59a577(0xdd)],_0x34a095['to']);try{const _0x299d3e=await _0x12245a[_0x59a577(0xc8)](_0x1a1e00);if(_0x299d3e&&_0x299d3e[_0x59a577(0xd0)]!==null&&_0x299d3e[_0x59a577(0xd0)]!==undefined){let _0x30cd89=Number(_0x299d3e[_0x59a577(0xd0)]);if(typeof _0x30cd89===_0x59a577(0xd5)){if(_0x30cd89<=1.05&&_0x34a095['to'][_0x59a577(0xe0)](_0x59a577(0xe1)))_0x30cd89=_0x30cd89*0x64;_0x24185a=Math['round'](_0x30cd89),_0xa0422c=!![];break;}}}catch(_0x4a0d43){}}}}const _0x14bd44=await _0x12245a['getStateAsync']('LTM.trainingData.thermodynamics');let _0x4e5058=[];if(_0x14bd44&&_0x14bd44[_0x59a577(0xd0)])try{_0x4e5058=JSON[_0x59a577(0xdb)](_0x14bd44[_0x59a577(0xd0)]);}catch(_0x54b0f9){}_0x4e5058[_0x59a577(0xd6)]({'ts':Date['now'](),'room':_0x34654a||_0x59a577(0xc3),'t_in':_0x4df3bc,'t_out':_0x5c32e3,'valve':_0x24185a});if(_0x4e5058[_0x59a577(0xfb)]>THERMO_LOG_SIZE)_0x4e5058[_0x59a577(0x109)]();await _0x12245a[_0x59a577(0xae)]('LTM.trainingData.thermodynamics',{'val':JSON[_0x59a577(0xa7)](_0x4e5058),'ack':!![]});}function a5_0x2fe6(_0x388a4f,_0x214f86){const _0x47e110=a5_0x2cf8();return a5_0x2fe6=function(_0x2ebffd,_0x2979b1){_0x2ebffd=_0x2ebffd-0x9e;let _0x2cf8b9=_0x47e110[_0x2ebffd];return _0x2cf8b9;},a5_0x2fe6(_0x388a4f,_0x214f86);}async function saveCompletedSequence(_0x479da0){const _0x13bf86=a5_0x2fe6;try{const _0x169ac1=await _0x479da0[_0x13bf86(0xc4)](_0x13bf86(0xcc));let _0x25bff2=[];if(_0x169ac1&&_0x169ac1[_0x13bf86(0xd0)])try{_0x25bff2=JSON[_0x13bf86(0xdb)](_0x169ac1[_0x13bf86(0xd0)]);}catch(_0x5dad6e){}const _0x5684ac=activeSequence[0x0]['ts'],_0xc2df89=activeSequence['map'](_0x3d9301=>({'loc':_0x3d9301[_0x13bf86(0xe3)],'t_delta':Math['round']((_0x3d9301['ts']-_0x5684ac)/0x3e8)})),_0xc9f795={'timestamp':new Date(_0x5684ac)[_0x13bf86(0xd2)](),'steps':_0xc2df89,'duration':Math[_0x13bf86(0xe8)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x5684ac)/0x3e8),'daytime':new Date(_0x5684ac)[_0x13bf86(0xe6)]()};_0x25bff2[_0x13bf86(0xd6)](_0xc9f795);if(_0x25bff2[_0x13bf86(0xfb)]>MAX_TRAINING_SET_SIZE)_0x25bff2[_0x13bf86(0x109)]();await _0x479da0[_0x13bf86(0xae)](_0x13bf86(0xcc),{'val':JSON['stringify'](_0x25bff2),'ack':!![]}),_0x479da0[_0x13bf86(0xb4)]&&_0x479da0[_0x13bf86(0x9f)]&&_0x479da0['sendToPythonWrapper']('ANALYZE_SEQUENCE',{'sequence':_0xc9f795});}catch(_0x5c5c3f){_0x479da0[_0x13bf86(0xba)][_0x13bf86(0x101)](_0x13bf86(0xd4)+_0x5c5c3f[_0x13bf86(0xbf)]);}}async function recordSequence(_0x5bd8bf,_0x2a0d97){const _0x458fb5=a5_0x2fe6,_0x45bdb6=(_0x2a0d97['type']||'')[_0x458fb5(0xe4)](),_0x3596ea=['motion',_0x458fb5(0xca),_0x458fb5(0xa4),_0x458fb5(0xcb),_0x458fb5(0xc0),_0x458fb5(0xc5),_0x458fb5(0xf9),_0x458fb5(0xeb),_0x458fb5(0xbb),'contact',_0x458fb5(0xe2),'light',_0x458fb5(0x102),_0x458fb5(0x105),_0x458fb5(0xd1),'dimmer',_0x458fb5(0xa5)];if(!_0x3596ea[_0x458fb5(0xf1)](_0x92601f=>_0x45bdb6['includes'](_0x92601f)))return;if(!_0x2a0d97['value'])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x458fb5(0xd6)]({'loc':_0x2a0d97[_0x458fb5(0xb0)]||_0x458fb5(0xc3),'id':_0x2a0d97['id'],'ts':Date[_0x458fb5(0xf8)]()}),sequenceTimer=setTimeout(async()=>{const _0x3d005a=_0x458fb5;if(activeSequence[_0x3d005a(0xfb)]>0x1)await saveCompletedSequence(_0x5bd8bf);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0x27161d){const _0x524f90=a5_0x2fe6;abortExitTimer(_0x27161d),_0x27161d[_0x524f90(0x104)]=!![],_0x27161d[_0x524f90(0xe7)]=setTimeout(()=>{const _0x39a45a=_0x524f90;_0x27161d[_0x39a45a(0x104)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x27161d[_0x524f90(0xcf)]=setTimeout(()=>{const _0x5e5c1a=_0x524f90;setPresence(_0x27161d,![]),_0x27161d[_0x5e5c1a(0xcf)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x499ca1){const _0x2f69b0=a5_0x2fe6;if(_0x499ca1['exitTimer'])clearTimeout(_0x499ca1[_0x2f69b0(0xcf)]);if(_0x499ca1[_0x2f69b0(0xe7)])clearTimeout(_0x499ca1['exitGraceTimer']);_0x499ca1[_0x2f69b0(0xcf)]=null,_0x499ca1[_0x2f69b0(0xe7)]=null,_0x499ca1[_0x2f69b0(0x104)]=![];}async function setPresence(_0x6d744d,_0x2c4c1d){const _0x6873ff=a5_0x2fe6;if(_0x6d744d['isPresent']===_0x2c4c1d)return;_0x6d744d[_0x6873ff(0xe9)]=_0x2c4c1d,await _0x6d744d[_0x6873ff(0xae)]('system.isPresent',{'val':_0x2c4c1d,'ack':!![]});}async function processSensorEvent(_0x270e38,_0x47bee8,_0x5cffd0,_0x56948e){const _0x1a1df8=a5_0x2fe6;if(!_0x56948e)return null;const _0x28b05e=_0x5cffd0['val'],_0x13fb59=Date[_0x1a1df8(0xf8)](),_0x4e8ed9=_0x270e38['sensorLastValues'][_0x47bee8],_0x5821fc=(_0x56948e[_0x1a1df8(0xc6)]||'')['toLowerCase'](),_0x54a45e=_0x5821fc[_0x1a1df8(0xe0)](_0x1a1df8(0xa6))||_0x5821fc[_0x1a1df8(0xe0)](_0x1a1df8(0xa1))||_0x5821fc[_0x1a1df8(0xe0)](_0x1a1df8(0xb8))||_0x5821fc[_0x1a1df8(0xe0)](_0x1a1df8(0xc2))||_0x5821fc[_0x1a1df8(0xe0)](_0x1a1df8(0x10a));if(_0x54a45e&&typeof _0x28b05e===_0x1a1df8(0xd5)){if(_0x28b05e>0x50||_0x28b05e<-0x32)return _0x270e38[_0x1a1df8(0xba)][_0x1a1df8(0xd8)]('[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20'+_0x28b05e+_0x1a1df8(0xab)+_0x47bee8),null;}_0x270e38['sensorLastValues'][_0x47bee8]=_0x28b05e;if(!_0x56948e[_0x1a1df8(0xed)]&&_0x4e8ed9!=undefined&&_0x4e8ed9==_0x28b05e)return null;_0x270e38['isProVersion']&&_0x54a45e&&recordThermodynamics(_0x270e38,_0x47bee8,_0x28b05e,_0x56948e[_0x1a1df8(0xb0)]);const _0x8f95b6={'timestamp':_0x13fb59,'id':_0x47bee8,'name':_0x56948e['name'],'type':_0x56948e[_0x1a1df8(0xc6)],'location':_0x56948e[_0x1a1df8(0xb0)],'value':_0x28b05e};_0x270e38['eventHistory'][_0x1a1df8(0xb1)](_0x8f95b6);if(_0x270e38['eventHistory'][_0x1a1df8(0xfb)]>HISTORY_MAX_SIZE)_0x270e38[_0x1a1df8(0xac)][_0x1a1df8(0xb7)]();await _0x270e38[_0x1a1df8(0xae)](_0x1a1df8(0xc9),{'val':JSON[_0x1a1df8(0xa7)](_0x8f95b6),'ack':!![]}),await _0x270e38[_0x1a1df8(0xae)]('events.history',{'val':JSON[_0x1a1df8(0xa7)](_0x270e38[_0x1a1df8(0xac)]),'ack':!![]});if(_0x270e38['isProVersion']){_0x270e38[_0x1a1df8(0xd7)][_0x1a1df8(0xd6)](_0x8f95b6);if(_0x270e38['rawEventLog'][_0x1a1df8(0xfb)]>RAW_LOG_MAX_SIZE)_0x270e38[_0x1a1df8(0xd7)][_0x1a1df8(0xec)](0x0,_0x270e38['rawEventLog'][_0x1a1df8(0xfb)]-RAW_LOG_MAX_SIZE);await _0x270e38[_0x1a1df8(0xae)](_0x1a1df8(0xad),{'val':JSON[_0x1a1df8(0xa7)](_0x270e38[_0x1a1df8(0xd7)]),'ack':!![]}),recordSequence(_0x270e38,_0x8f95b6);}if(_0x56948e[_0x1a1df8(0xf5)]&&_0x28b05e===!![]){if(_0x270e38[_0x1a1df8(0xe9)]&&!_0x270e38[_0x1a1df8(0x104)])startExitTimer(_0x270e38);else{if(!_0x270e38['isPresent'])setPresence(_0x270e38,!![]);}}else{if(_0x56948e[_0x1a1df8(0xc6)]===_0x1a1df8(0xa2)&&_0x28b05e===!![]){if(_0x270e38['exitTimer'])abortExitTimer(_0x270e38);if(!_0x270e38['isPresent']&&_0x270e38[_0x1a1df8(0x100)]===_0x1a1df8(0xef))setPresence(_0x270e38,!![]);}}if(_0x270e38['isProVersion']&&_0x270e38['sendToPythonWrapper']){_0x56948e[_0x1a1df8(0xc6)]===_0x1a1df8(0xa2)&&_0x28b05e===!![]&&_0x56948e['location']&&_0x270e38[_0x1a1df8(0x9f)]('SIMULATE_SIGNAL',{'room':_0x56948e['location']});const _0x1d2b1f=['door','t체r',_0x1a1df8(0xeb),_0x1a1df8(0xbb),'griff',_0x1a1df8(0xa3),_0x1a1df8(0xee),_0x1a1df8(0xdf)][_0x1a1df8(0xf1)](_0x2270d4=>_0x5821fc[_0x1a1df8(0xe0)](_0x2270d4)),_0x13d43b=[_0x1a1df8(0xff),_0x1a1df8(0x102),_0x1a1df8(0x105),_0x1a1df8(0xd1),_0x1a1df8(0xda),'lampe'][_0x1a1df8(0xf1)](_0x2208d1=>_0x5821fc[_0x1a1df8(0xe0)](_0x2208d1)),_0x3775bd=[_0x1a1df8(0xa2),_0x1a1df8(0xca),'pr채senz',_0x1a1df8(0xcb),'occupancy'][_0x1a1df8(0xf1)](_0x54148d=>_0x5821fc[_0x1a1df8(0xe0)](_0x54148d));if(_0x56948e['location']&&(_0x1d2b1f||_0x13d43b||_0x3775bd)){const _0x218874=_0x28b05e===!![]||typeof _0x28b05e===_0x1a1df8(0xd5)&&_0x28b05e>0x0,_0x5b0ae3=_0x1d2b1f&&!_0x218874&&_0x4e8ed9!==undefined&&_0x4e8ed9!=_0x28b05e;if(_0x218874||_0x5b0ae3){const _0x3e05a4=_0x270e38[_0x1a1df8(0x9e)]||_0x13fb59,_0x339af4=(_0x13fb59-_0x3e05a4)/0x3e8;_0x270e38[_0x1a1df8(0x9e)]=_0x13fb59,_0x270e38[_0x1a1df8(0x9f)](_0x1a1df8(0xa8),{'room':_0x56948e[_0x1a1df8(0xb0)],'dt':_0x339af4});}}}return _0x8f95b6;}module[a5_0xc6c1c3(0xb3)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};