function a5_0x5842(_0x519128,_0x19fb30){const _0x3e53c5=a5_0x5094();return a5_0x5842=function(_0x382b8d,_0x441e62){_0x382b8d=_0x382b8d-0xc3;let _0x5094c6=_0x3e53c5[_0x382b8d];return _0x5094c6;},a5_0x5842(_0x519128,_0x19fb30);}const a5_0x290cd2=a5_0x5842;(function(_0x174a33,_0x307a7e){const _0x384887=a5_0x5842,_0x47ee34=_0x174a33();while(!![]){try{const _0x954bb=-parseInt(_0x384887(0xd9))/0x1*(-parseInt(_0x384887(0x128))/0x2)+parseInt(_0x384887(0x112))/0x3*(parseInt(_0x384887(0x12e))/0x4)+-parseInt(_0x384887(0xf5))/0x5+parseInt(_0x384887(0x132))/0x6*(-parseInt(_0x384887(0xd5))/0x7)+parseInt(_0x384887(0xf9))/0x8*(parseInt(_0x384887(0x107))/0x9)+parseInt(_0x384887(0x120))/0xa+parseInt(_0x384887(0xeb))/0xb*(-parseInt(_0x384887(0x100))/0xc);if(_0x954bb===_0x307a7e)break;else _0x47ee34['push'](_0x47ee34['shift']());}catch(_0x6d9e9b){_0x47ee34['push'](_0x47ee34['shift']());}}}(a5_0x5094,0x75e42));const a5_0x441e62=(function(){let _0x33ced0=!![];return function(_0x2c33ae,_0x59e6df){const _0x24fca2=_0x33ced0?function(){const _0x535a44=a5_0x5842;if(_0x59e6df){const _0x27dc18=_0x59e6df[_0x535a44(0x12a)](_0x2c33ae,arguments);return _0x59e6df=null,_0x27dc18;}}:function(){};return _0x33ced0=![],_0x24fca2;};}()),a5_0x382b8d=a5_0x441e62(this,function(){const _0x438298=a5_0x5842;return a5_0x382b8d[_0x438298(0x127)]()[_0x438298(0xf1)]('(((.+)+)+)+$')[_0x438298(0x127)]()['constructor'](a5_0x382b8d)[_0x438298(0xf1)](_0x438298(0xcf));});a5_0x382b8d();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x23d7db){const _0x1d53bb=a5_0x5842;if(_0x23d7db[_0x1d53bb(0x11d)][_0x1d53bb(0xfd)])try{const _0x436999=await _0x23d7db[_0x1d53bb(0xcb)](_0x23d7db[_0x1d53bb(0x11d)][_0x1d53bb(0xfd)]);if(_0x436999&&_0x436999['val']!==undefined&&_0x436999[_0x1d53bb(0x115)]!==null)return parseFloat(_0x436999[_0x1d53bb(0x115)]);}catch(_0x29439f){}const _0x4decc8=_0x23d7db[_0x1d53bb(0x11d)][_0x1d53bb(0x135)];if(!_0x23d7db[_0x1d53bb(0x11d)][_0x1d53bb(0xcc)]||!_0x4decc8)return null;try{let _0xbc998e='';if(_0x4decc8[_0x1d53bb(0xc9)](_0x1d53bb(0x126)))_0xbc998e=_0x4decc8+'.Current.Temperature';else{if(_0x4decc8['includes'](_0x1d53bb(0x130)))_0xbc998e=_0x4decc8+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x4decc8[_0x1d53bb(0xc9)](_0x1d53bb(0xef)))_0xbc998e=_0x4decc8+_0x1d53bb(0x125);else{if(_0x4decc8[_0x1d53bb(0xc9)](_0x1d53bb(0x121)))_0xbc998e=_0x4decc8+'.forecast.current.temp';}}}if(_0xbc998e){const _0xe3880c=await _0x23d7db[_0x1d53bb(0xcb)](_0xbc998e);if(_0xe3880c&&_0xe3880c[_0x1d53bb(0x115)]!==undefined&&_0xe3880c[_0x1d53bb(0x115)]!==null)return parseFloat(_0xe3880c[_0x1d53bb(0x115)]);}}catch(_0x20c31f){}return null;}async function recordThermodynamics(_0x4b2d10,_0x3224f9,_0x5e6c6f,_0x9720e1){const _0x506225=a5_0x5842,_0x50396d=await getOutsideTemperatureNumeric(_0x4b2d10);if(_0x50396d===null)return;let _0x1954bb=0x0,_0x4a21d8=![];if(_0x4b2d10['config'][_0x506225(0x101)])try{let _0x5553bb=_0x4b2d10[_0x506225(0x11d)][_0x506225(0x101)];if(typeof _0x5553bb===_0x506225(0xdb))_0x5553bb=JSON[_0x506225(0x108)](_0x5553bb);if(_0x5553bb[_0x3224f9]){const _0x25ec49=_0x5553bb[_0x3224f9],_0x3369cb=await _0x4b2d10[_0x506225(0xcb)](_0x25ec49);if(_0x3369cb&&_0x3369cb['val']!==null&&_0x3369cb['val']!==undefined){let _0x4d6e68=Number(_0x3369cb[_0x506225(0x115)]);if(_0x4d6e68<=1.05&&!_0x25ec49[_0x506225(0xc9)](_0x506225(0xd0))&&!_0x25ec49[_0x506225(0xc9)](_0x506225(0xe8)))_0x4d6e68=_0x4d6e68*0x64;_0x1954bb=Math[_0x506225(0xd4)](_0x4d6e68),_0x4a21d8=!![];}}}catch(_0x513fb5){}if(!_0x4a21d8){const _0x57c841=[{'from':'.1.ACTUAL_TEMPERATURE','to':_0x506225(0xe3)},{'from':_0x506225(0xdc),'to':'.1.VALVE_STATE'},{'from':_0x506225(0xcd),'to':_0x506225(0xe6)},{'from':_0x506225(0xf6),'to':'.LEVEL'},{'from':_0x506225(0xfb),'to':_0x506225(0x11e)},{'from':_0x506225(0x10e),'to':_0x506225(0x122)}];for(const _0x21996e of _0x57c841){if(_0x3224f9[_0x506225(0xc9)](_0x21996e[_0x506225(0x103)])){const _0x36a5b7=_0x3224f9[_0x506225(0xe0)](_0x21996e[_0x506225(0x103)],_0x21996e['to']);try{const _0x4d56b7=await _0x4b2d10[_0x506225(0xcb)](_0x36a5b7);if(_0x4d56b7&&_0x4d56b7[_0x506225(0x115)]!==null&&_0x4d56b7[_0x506225(0x115)]!==undefined){let _0x75696a=Number(_0x4d56b7['val']);if(typeof _0x75696a==='number'){if(_0x75696a<=1.05&&_0x21996e['to'][_0x506225(0xc9)](_0x506225(0xce)))_0x75696a=_0x75696a*0x64;_0x1954bb=Math[_0x506225(0xd4)](_0x75696a),_0x4a21d8=!![];break;}}}catch(_0x17a4bb){}}}}const _0x18faf5=await _0x4b2d10[_0x506225(0xd6)](_0x506225(0xe9));let _0x254ee0=[];if(_0x18faf5&&_0x18faf5[_0x506225(0x115)])try{_0x254ee0=JSON[_0x506225(0x108)](_0x18faf5[_0x506225(0x115)]);}catch(_0x3da2d9){}_0x254ee0[_0x506225(0x11f)]({'ts':Date['now'](),'room':_0x9720e1||'Unknown','t_in':_0x5e6c6f,'t_out':_0x50396d,'valve':_0x1954bb});if(_0x254ee0[_0x506225(0xde)]>THERMO_LOG_SIZE)_0x254ee0[_0x506225(0xc4)]();await _0x4b2d10['setStateAsync'](_0x506225(0xe9),{'val':JSON[_0x506225(0xd8)](_0x254ee0),'ack':!![]});}async function saveCompletedSequence(_0x4ec9a8){const _0x2c60f9=a5_0x5842;try{const _0xbf6316=await _0x4ec9a8[_0x2c60f9(0xd6)](_0x2c60f9(0xf8));let _0x249826=[];if(_0xbf6316&&_0xbf6316[_0x2c60f9(0x115)])try{_0x249826=JSON[_0x2c60f9(0x108)](_0xbf6316[_0x2c60f9(0x115)]);}catch(_0x2ffa1f){}const _0x4fd31f=activeSequence[0x0]['ts'],_0x296b0f=activeSequence[_0x2c60f9(0x113)](_0x596d40=>({'loc':_0x596d40[_0x2c60f9(0x11a)],'t_delta':Math[_0x2c60f9(0xd4)]((_0x596d40['ts']-_0x4fd31f)/0x3e8)})),_0x766177={'timestamp':new Date(_0x4fd31f)[_0x2c60f9(0xe4)](),'steps':_0x296b0f,'duration':Math[_0x2c60f9(0xd4)]((activeSequence[activeSequence[_0x2c60f9(0xde)]-0x1]['ts']-_0x4fd31f)/0x3e8),'daytime':new Date(_0x4fd31f)[_0x2c60f9(0xd2)]()};_0x249826[_0x2c60f9(0x11f)](_0x766177);if(_0x249826[_0x2c60f9(0xde)]>MAX_TRAINING_SET_SIZE)_0x249826['shift']();await _0x4ec9a8[_0x2c60f9(0xdd)](_0x2c60f9(0xf8),{'val':JSON['stringify'](_0x249826),'ack':!![]}),_0x4ec9a8[_0x2c60f9(0xe1)]&&_0x4ec9a8['sendToPythonWrapper']&&_0x4ec9a8[_0x2c60f9(0xd7)](_0x2c60f9(0xdf),{'sequence':_0x766177});}catch(_0x281286){_0x4ec9a8['log'][_0x2c60f9(0xd3)](_0x2c60f9(0x105)+_0x281286[_0x2c60f9(0x10b)]);}}async function recordSequence(_0x481802,_0x91bbfb){const _0x390528=a5_0x5842,_0x4221f2=(_0x91bbfb[_0x390528(0x133)]||'')[_0x390528(0x12b)](),_0x49f827=[_0x390528(0x106),_0x390528(0xc8),_0x390528(0xd1),_0x390528(0x123),_0x390528(0xda),_0x390528(0x131),_0x390528(0x10f),'window',_0x390528(0x117),_0x390528(0xc3),_0x390528(0x114),_0x390528(0xe5),_0x390528(0x109),_0x390528(0xe2),_0x390528(0xfa),_0x390528(0x12d),_0x390528(0x118)];if(!_0x49f827[_0x390528(0xc6)](_0x42ce77=>_0x4221f2['includes'](_0x42ce77)))return;if(!_0x91bbfb['value'])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x390528(0x11f)]({'loc':_0x91bbfb[_0x390528(0xf7)]||_0x390528(0xc5),'id':_0x91bbfb['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{const _0x8ce4ab=_0x390528;if(activeSequence[_0x8ce4ab(0xde)]>0x1)await saveCompletedSequence(_0x481802);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0xf927ef){const _0x3a27ad=a5_0x5842;abortExitTimer(_0xf927ef),_0xf927ef[_0x3a27ad(0xf2)]=!![],_0xf927ef[_0x3a27ad(0x119)]=setTimeout(()=>{const _0x7f3af4=_0x3a27ad;_0xf927ef[_0x7f3af4(0xf2)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0xf927ef[_0x3a27ad(0x104)]=setTimeout(()=>{const _0x1a8f70=_0x3a27ad;setPresence(_0xf927ef,![]),_0xf927ef[_0x1a8f70(0x104)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function a5_0x5094(){const _0x322479=['lampe','exitGraceTimer','loc','isExit','currentSystemMode','config','level','push','2430830Hpyyqo','weatherunderground','Valve','presence','rawEventLog','.forecast.current.temperature','accuweather','toString','1231278nZWQEa','handle','apply','toLowerCase','thermostat','dimmer','20xBCtTI','eventHistory','daswetter','door','236922BGTwBx','type','isPresent','weatherInstance','contact','shift','Unknown','some','now','bewegung','includes','name','getForeignStateAsync','useWeather','.1.TEMPERATURE','LEVEL','(((.+)+)+)+$','STATUS','pr채senz','getHours','error','round','91blslZq','getStateAsync','sendToPythonWrapper','stringify','1zByTsD','occupancy','string','.1.ACTUAL_TEMPERATURE','setStateAsync','length','ANALYZE_SEQUENCE','replace','isProVersion','switch','.1.LEVEL','toISOString','light','.4.VALVE_STATE','events.lastEvent','STATE','LTM.trainingData.thermodynamics','heizung','101233MDkFgv','temperatur','klima','events.history','openweathermap','griff','search','isGracePeriodActive','lock','LTM.rawEventLog','2120140hhFvcr','.ACTUAL_TEMPERATURE','location','LTM.trainingData.sequences','8WTEovy','schalter','temperature','exports','outdoorSensorId','normal','pop','132MhpSlO','valveMapping','number','from','exitTimer','[RECORDER]\x20Error:\x20','motion','3785103VdVEJT','parse','licht','lastTrackerEventTime','message','schloss','splice','Temperature','t체r','TRACK_EVENT','sensorLastValues','145311LUMthg','map','kontakt','val','system.isPresent','fenster'];a5_0x5094=function(){return _0x322479;};return a5_0x5094();}function abortExitTimer(_0x34192e){const _0x2c2ca6=a5_0x5842;if(_0x34192e[_0x2c2ca6(0x104)])clearTimeout(_0x34192e['exitTimer']);if(_0x34192e[_0x2c2ca6(0x119)])clearTimeout(_0x34192e['exitGraceTimer']);_0x34192e[_0x2c2ca6(0x104)]=null,_0x34192e[_0x2c2ca6(0x119)]=null,_0x34192e[_0x2c2ca6(0xf2)]=![];}async function setPresence(_0x17a068,_0x286e91){const _0x3da3af=a5_0x5842;if(_0x17a068[_0x3da3af(0x134)]===_0x286e91)return;_0x17a068[_0x3da3af(0x134)]=_0x286e91,await _0x17a068[_0x3da3af(0xdd)](_0x3da3af(0x116),{'val':_0x286e91,'ack':!![]});}async function processSensorEvent(_0xb91d6c,_0x1f8355,_0x407195,_0x1938d5){const _0x30fa39=a5_0x5842;if(!_0x1938d5)return null;const _0x5a82ac=_0x407195['val'],_0x284308=Date[_0x30fa39(0xc7)](),_0x4e50ea=_0xb91d6c[_0x30fa39(0x111)][_0x1f8355],_0x4c9609=(_0x1938d5[_0x30fa39(0x133)]||'')[_0x30fa39(0x12b)](),_0x351b20=_0x4c9609[_0x30fa39(0xc9)](_0x30fa39(0xfb))||_0x4c9609[_0x30fa39(0xc9)](_0x30fa39(0xec))||_0x4c9609[_0x30fa39(0xc9)](_0x30fa39(0xed))||_0x4c9609[_0x30fa39(0xc9)](_0x30fa39(0xea))||_0x4c9609['includes'](_0x30fa39(0x12c));if(_0x351b20&&typeof _0x5a82ac==='number'){if(_0x5a82ac>0x50||_0x5a82ac<-0x32)return _0xb91d6c['log']['debug']('[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20'+_0x5a82ac+'\x20from\x20'+_0x1f8355),null;}_0xb91d6c['sensorLastValues'][_0x1f8355]=_0x5a82ac;if(!_0x1938d5['logDuplicates']&&_0x4e50ea!=undefined&&_0x4e50ea==_0x5a82ac)return null;_0xb91d6c[_0x30fa39(0xe1)]&&_0x351b20&&recordThermodynamics(_0xb91d6c,_0x1f8355,_0x5a82ac,_0x1938d5['location']);const _0x4d3a21={'timestamp':_0x284308,'id':_0x1f8355,'name':_0x1938d5[_0x30fa39(0xca)],'type':_0x1938d5[_0x30fa39(0x133)],'location':_0x1938d5[_0x30fa39(0xf7)],'value':_0x5a82ac};_0xb91d6c[_0x30fa39(0x12f)]['unshift'](_0x4d3a21);if(_0xb91d6c[_0x30fa39(0x12f)][_0x30fa39(0xde)]>HISTORY_MAX_SIZE)_0xb91d6c[_0x30fa39(0x12f)][_0x30fa39(0xff)]();await _0xb91d6c[_0x30fa39(0xdd)](_0x30fa39(0xe7),{'val':JSON[_0x30fa39(0xd8)](_0x4d3a21),'ack':!![]}),await _0xb91d6c['setStateAsync'](_0x30fa39(0xee),{'val':JSON['stringify'](_0xb91d6c['eventHistory']),'ack':!![]});if(_0xb91d6c['isProVersion']){_0xb91d6c[_0x30fa39(0x124)][_0x30fa39(0x11f)](_0x4d3a21);if(_0xb91d6c[_0x30fa39(0x124)][_0x30fa39(0xde)]>RAW_LOG_MAX_SIZE)_0xb91d6c[_0x30fa39(0x124)][_0x30fa39(0x10d)](0x0,_0xb91d6c[_0x30fa39(0x124)]['length']-RAW_LOG_MAX_SIZE);await _0xb91d6c[_0x30fa39(0xdd)](_0x30fa39(0xf4),{'val':JSON[_0x30fa39(0xd8)](_0xb91d6c[_0x30fa39(0x124)]),'ack':!![]}),recordSequence(_0xb91d6c,_0x4d3a21);}if(_0x1938d5[_0x30fa39(0x11b)]&&_0x5a82ac===!![]){if(_0xb91d6c[_0x30fa39(0x134)]&&!_0xb91d6c[_0x30fa39(0xf2)])startExitTimer(_0xb91d6c);else{if(!_0xb91d6c[_0x30fa39(0x134)])setPresence(_0xb91d6c,!![]);}}else{if(_0x1938d5[_0x30fa39(0x133)]==='motion'&&_0x5a82ac===!![]){if(_0xb91d6c[_0x30fa39(0x104)])abortExitTimer(_0xb91d6c);if(!_0xb91d6c['isPresent']&&_0xb91d6c[_0x30fa39(0x11c)]===_0x30fa39(0xfe))setPresence(_0xb91d6c,!![]);}}if(_0xb91d6c[_0x30fa39(0xe1)]&&_0xb91d6c[_0x30fa39(0xd7)]){_0x1938d5[_0x30fa39(0x133)]===_0x30fa39(0x106)&&_0x5a82ac===!![]&&_0x1938d5[_0x30fa39(0xf7)]&&_0xb91d6c[_0x30fa39(0xd7)]('SIMULATE_SIGNAL',{'room':_0x1938d5['location']});const _0x193a0c=['door','t체r','window',_0x30fa39(0x117),_0x30fa39(0xf0),_0x30fa39(0x129),_0x30fa39(0xf3),_0x30fa39(0x10c)][_0x30fa39(0xc6)](_0x10da38=>_0x4c9609[_0x30fa39(0xc9)](_0x10da38)),_0x35fb79=[_0x30fa39(0xe5),'licht',_0x30fa39(0xe2),_0x30fa39(0xfa),_0x30fa39(0x12d),_0x30fa39(0x118)][_0x30fa39(0xc6)](_0x4d5dc6=>_0x4c9609[_0x30fa39(0xc9)](_0x4d5dc6)),_0x47a1f0=[_0x30fa39(0x106),_0x30fa39(0xc8),'pr채senz','presence',_0x30fa39(0xda)][_0x30fa39(0xc6)](_0x4532d9=>_0x4c9609[_0x30fa39(0xc9)](_0x4532d9));if(_0x1938d5[_0x30fa39(0xf7)]&&(_0x193a0c||_0x35fb79||_0x47a1f0)){const _0x338a4f=_0x5a82ac===!![]||typeof _0x5a82ac===_0x30fa39(0x102)&&_0x5a82ac>0x0,_0x208d31=_0x193a0c&&!_0x338a4f&&_0x4e50ea!==undefined&&_0x4e50ea!=_0x5a82ac;if(_0x338a4f||_0x208d31){const _0x4a228d=_0xb91d6c[_0x30fa39(0x10a)]||_0x284308,_0x4a36f5=(_0x284308-_0x4a228d)/0x3e8;_0xb91d6c[_0x30fa39(0x10a)]=_0x284308,_0xb91d6c[_0x30fa39(0xd7)](_0x30fa39(0x110),{'room':_0x1938d5[_0x30fa39(0xf7)],'dt':_0x4a36f5});}}}return _0x4d3a21;}module[a5_0x290cd2(0xfc)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};