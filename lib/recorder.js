function a5_0x4f00(_0x27645e,_0xa99b6f){const _0x36cff3=a5_0xd69a();return a5_0x4f00=function(_0x1645cc,_0x281b9a){_0x1645cc=_0x1645cc-0x171;let _0xd69ab4=_0x36cff3[_0x1645cc];return _0xd69ab4;},a5_0x4f00(_0x27645e,_0xa99b6f);}const a5_0xf1f0d6=a5_0x4f00;(function(_0x4f03f3,_0x749c9){const _0x17ed63=a5_0x4f00,_0x27859d=_0x4f03f3();while(!![]){try{const _0x503d2b=-parseInt(_0x17ed63(0x17b))/0x1+-parseInt(_0x17ed63(0x1d5))/0x2+parseInt(_0x17ed63(0x1ad))/0x3+parseInt(_0x17ed63(0x19a))/0x4*(parseInt(_0x17ed63(0x1a4))/0x5)+parseInt(_0x17ed63(0x1cc))/0x6+-parseInt(_0x17ed63(0x194))/0x7+-parseInt(_0x17ed63(0x1bb))/0x8*(-parseInt(_0x17ed63(0x189))/0x9);if(_0x503d2b===_0x749c9)break;else _0x27859d['push'](_0x27859d['shift']());}catch(_0x5ee986){_0x27859d['push'](_0x27859d['shift']());}}}(a5_0xd69a,0x5bc9d));const a5_0x281b9a=(function(){let _0xc1768e=!![];return function(_0x1ca4b8,_0x496303){const _0x5ae2d2=_0xc1768e?function(){const _0x4e30e5=a5_0x4f00;if(_0x496303){const _0x4d52b=_0x496303[_0x4e30e5(0x1b0)](_0x1ca4b8,arguments);return _0x496303=null,_0x4d52b;}}:function(){};return _0xc1768e=![],_0x5ae2d2;};}()),a5_0x1645cc=a5_0x281b9a(this,function(){const _0xbc4b16=a5_0x4f00;return a5_0x1645cc['toString']()[_0xbc4b16(0x187)](_0xbc4b16(0x1cd))['toString']()[_0xbc4b16(0x178)](a5_0x1645cc)[_0xbc4b16(0x187)](_0xbc4b16(0x1cd));});a5_0x1645cc();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x426127){const _0x15fe51=a5_0x4f00;if(_0x426127[_0x15fe51(0x177)]['outdoorSensorId'])try{const _0x54edf6=await _0x426127[_0x15fe51(0x172)](_0x426127['config']['outdoorSensorId']);if(_0x54edf6&&_0x54edf6[_0x15fe51(0x1a2)]!==undefined&&_0x54edf6[_0x15fe51(0x1a2)]!==null)return parseFloat(_0x54edf6[_0x15fe51(0x1a2)]);}catch(_0x5152e9){}const _0x2d993e=_0x426127[_0x15fe51(0x177)][_0x15fe51(0x191)];if(!_0x426127[_0x15fe51(0x177)][_0x15fe51(0x171)]||!_0x2d993e)return null;try{let _0x41ab28='';if(_0x2d993e[_0x15fe51(0x1aa)](_0x15fe51(0x1d3)))_0x41ab28=_0x2d993e+_0x15fe51(0x1c5);else{if(_0x2d993e[_0x15fe51(0x1aa)](_0x15fe51(0x1b1)))_0x41ab28=_0x2d993e+_0x15fe51(0x182);else{if(_0x2d993e['includes']('openweathermap'))_0x41ab28=_0x2d993e+'.forecast.current.temperature';else{if(_0x2d993e['includes'](_0x15fe51(0x1cb)))_0x41ab28=_0x2d993e+_0x15fe51(0x1bd);}}}if(_0x41ab28){const _0x162fdb=await _0x426127[_0x15fe51(0x172)](_0x41ab28);if(_0x162fdb&&_0x162fdb[_0x15fe51(0x1a2)]!==undefined&&_0x162fdb[_0x15fe51(0x1a2)]!==null)return parseFloat(_0x162fdb[_0x15fe51(0x1a2)]);}}catch(_0x44163d){}return null;}async function recordThermodynamics(_0x1fe45e,_0x2a27d6,_0x3c32fd,_0x1d9956){const _0x495eb6=a5_0x4f00,_0x137d16=await getOutsideTemperatureNumeric(_0x1fe45e);if(_0x137d16===null)return;let _0x8c4dad=0x0,_0xaf5f56=![];if(_0x1fe45e[_0x495eb6(0x177)]['valveMapping'])try{let _0x14d91d=_0x1fe45e[_0x495eb6(0x177)][_0x495eb6(0x1bf)];if(typeof _0x14d91d===_0x495eb6(0x197))_0x14d91d=JSON[_0x495eb6(0x1af)](_0x14d91d);if(_0x14d91d[_0x2a27d6]){const _0x475ade=_0x14d91d[_0x2a27d6],_0x3b84b2=await _0x1fe45e[_0x495eb6(0x172)](_0x475ade);if(_0x3b84b2&&_0x3b84b2[_0x495eb6(0x1a2)]!==null&&_0x3b84b2[_0x495eb6(0x1a2)]!==undefined){let _0x595bb3=Number(_0x3b84b2['val']);if(_0x595bb3<=1.05&&!_0x475ade['includes'](_0x495eb6(0x181))&&!_0x475ade[_0x495eb6(0x1aa)](_0x495eb6(0x1a5)))_0x595bb3=_0x595bb3*0x64;_0x8c4dad=Math[_0x495eb6(0x19d)](_0x595bb3),_0xaf5f56=!![];}}}catch(_0x58a09d){}if(!_0xaf5f56){const _0x327e6d=[{'from':'.1.ACTUAL_TEMPERATURE','to':'.1.LEVEL'},{'from':_0x495eb6(0x1a0),'to':_0x495eb6(0x1b3)},{'from':'.1.TEMPERATURE','to':_0x495eb6(0x18a)},{'from':_0x495eb6(0x1b4),'to':_0x495eb6(0x1d9)},{'from':_0x495eb6(0x1c1),'to':_0x495eb6(0x1ba)},{'from':_0x495eb6(0x17e),'to':_0x495eb6(0x186)}];for(const _0x4268b4 of _0x327e6d){if(_0x2a27d6[_0x495eb6(0x1aa)](_0x4268b4[_0x495eb6(0x1d7)])){const _0x569a3d=_0x2a27d6['replace'](_0x4268b4[_0x495eb6(0x1d7)],_0x4268b4['to']);try{const _0x64446c=await _0x1fe45e['getForeignStateAsync'](_0x569a3d);if(_0x64446c&&_0x64446c[_0x495eb6(0x1a2)]!==null&&_0x64446c['val']!==undefined){let _0x45d055=Number(_0x64446c['val']);if(typeof _0x45d055===_0x495eb6(0x1b7)){if(_0x45d055<=1.05&&_0x4268b4['to'][_0x495eb6(0x1aa)](_0x495eb6(0x1c3)))_0x45d055=_0x45d055*0x64;_0x8c4dad=Math['round'](_0x45d055),_0xaf5f56=!![];break;}}}catch(_0x3935d9){}}}}const _0x53ca7a=await _0x1fe45e['getStateAsync']('LTM.trainingData.thermodynamics');let _0xb047f8=[];if(_0x53ca7a&&_0x53ca7a[_0x495eb6(0x1a2)])try{_0xb047f8=JSON[_0x495eb6(0x1af)](_0x53ca7a[_0x495eb6(0x1a2)]);}catch(_0x24cd9){}_0xb047f8[_0x495eb6(0x192)]({'ts':Date[_0x495eb6(0x1d2)](),'room':_0x1d9956||_0x495eb6(0x18b),'t_in':_0x3c32fd,'t_out':_0x137d16,'valve':_0x8c4dad});if(_0xb047f8[_0x495eb6(0x1be)]>THERMO_LOG_SIZE)_0xb047f8[_0x495eb6(0x193)]();await _0x1fe45e['setStateAsync'](_0x495eb6(0x17c),{'val':JSON[_0x495eb6(0x1da)](_0xb047f8),'ack':!![]});}async function saveCompletedSequence(_0x313896){const _0x1bee89=a5_0x4f00;try{const _0x39ed26=await _0x313896[_0x1bee89(0x1ce)](_0x1bee89(0x185));let _0xf09cdb=[];if(_0x39ed26&&_0x39ed26[_0x1bee89(0x1a2)])try{_0xf09cdb=JSON[_0x1bee89(0x1af)](_0x39ed26['val']);}catch(_0x4fb0ac){}const _0x5bb22a=activeSequence[0x0]['ts'],_0x59989e=activeSequence['map'](_0x418391=>({'loc':_0x418391[_0x1bee89(0x176)],'t_delta':Math[_0x1bee89(0x19d)]((_0x418391['ts']-_0x5bb22a)/0x3e8)})),_0x596443={'timestamp':new Date(_0x5bb22a)['toISOString'](),'steps':_0x59989e,'duration':Math['round']((activeSequence[activeSequence[_0x1bee89(0x1be)]-0x1]['ts']-_0x5bb22a)/0x3e8),'daytime':new Date(_0x5bb22a)[_0x1bee89(0x190)]()};_0xf09cdb['push'](_0x596443);if(_0xf09cdb[_0x1bee89(0x1be)]>MAX_TRAINING_SET_SIZE)_0xf09cdb[_0x1bee89(0x193)]();await _0x313896['setStateAsync']('LTM.trainingData.sequences',{'val':JSON[_0x1bee89(0x1da)](_0xf09cdb),'ack':!![]}),_0x313896['isProVersion']&&_0x313896[_0x1bee89(0x1c6)]&&_0x313896[_0x1bee89(0x1c6)]('ANALYZE_SEQUENCE',{'sequence':_0x596443});}catch(_0x12cbcc){_0x313896['log'][_0x1bee89(0x1ae)](_0x1bee89(0x183)+_0x12cbcc[_0x1bee89(0x19f)]);}}async function recordSequence(_0x1fd1f9,_0x3b1b4b){const _0x401f0a=a5_0x4f00,_0x3fd08f=(_0x3b1b4b[_0x401f0a(0x17a)]||'')[_0x401f0a(0x18e)](),_0x443130=[_0x401f0a(0x1a3),'bewegung',_0x401f0a(0x19b),_0x401f0a(0x19c),_0x401f0a(0x1a1),_0x401f0a(0x1d0),'t체r',_0x401f0a(0x1ab),'fenster',_0x401f0a(0x173),_0x401f0a(0x1d6),_0x401f0a(0x180),_0x401f0a(0x1c7),_0x401f0a(0x1c8),_0x401f0a(0x198),'dimmer','lampe'];if(!_0x443130[_0x401f0a(0x1bc)](_0x323b73=>_0x3fd08f['includes'](_0x323b73)))return;if(!_0x3b1b4b[_0x401f0a(0x1c2)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x401f0a(0x192)]({'loc':_0x3b1b4b[_0x401f0a(0x175)]||_0x401f0a(0x18b),'id':_0x3b1b4b['id'],'ts':Date[_0x401f0a(0x1d2)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x1fd1f9);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0x2eb882){const _0x2d4af4=a5_0x4f00;abortExitTimer(_0x2eb882),_0x2eb882[_0x2d4af4(0x1cf)]=!![],_0x2eb882['exitGraceTimer']=setTimeout(()=>{const _0x3a2cd8=_0x2d4af4;_0x2eb882[_0x3a2cd8(0x1cf)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x2eb882[_0x2d4af4(0x1a9)]=setTimeout(()=>{const _0x38a2b9=_0x2d4af4;setPresence(_0x2eb882,![]),_0x2eb882[_0x38a2b9(0x1a9)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x4cf5fc){const _0x1d8cf5=a5_0x4f00;if(_0x4cf5fc[_0x1d8cf5(0x1a9)])clearTimeout(_0x4cf5fc[_0x1d8cf5(0x1a9)]);if(_0x4cf5fc['exitGraceTimer'])clearTimeout(_0x4cf5fc[_0x1d8cf5(0x18d)]);_0x4cf5fc[_0x1d8cf5(0x1a9)]=null,_0x4cf5fc[_0x1d8cf5(0x18d)]=null,_0x4cf5fc[_0x1d8cf5(0x1cf)]=![];}async function setPresence(_0x4a412f,_0x571f13){const _0x58312d=a5_0x4f00;if(_0x4a412f['isPresent']===_0x571f13)return;_0x4a412f[_0x58312d(0x18c)]=_0x571f13,await _0x4a412f[_0x58312d(0x196)](_0x58312d(0x199),{'val':_0x571f13,'ack':!![]});}async function processSensorEvent(_0x26b42c,_0x1f20d5,_0x132a30,_0x295c6f){const _0x2bc051=a5_0x4f00;if(!_0x295c6f)return null;const _0x2a5c3f=_0x132a30[_0x2bc051(0x1a2)],_0xda4fe2=Date[_0x2bc051(0x1d2)](),_0x4d00f1=_0x26b42c[_0x2bc051(0x1d8)][_0x1f20d5],_0x180575=(_0x295c6f[_0x2bc051(0x17a)]||'')[_0x2bc051(0x18e)](),_0x588090=_0x180575['includes']('temperature')||_0x180575['includes'](_0x2bc051(0x1c9))||_0x180575[_0x2bc051(0x1aa)](_0x2bc051(0x17f))||_0x180575['includes'](_0x2bc051(0x17d))||_0x180575[_0x2bc051(0x1aa)](_0x2bc051(0x195));if(_0x588090&&typeof _0x2a5c3f==='number'){if(_0x2a5c3f>0x50||_0x2a5c3f<-0x32)return _0x26b42c[_0x2bc051(0x1c4)]['debug']('[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20'+_0x2a5c3f+_0x2bc051(0x1a8)+_0x1f20d5),null;}_0x26b42c[_0x2bc051(0x1d8)][_0x1f20d5]=_0x2a5c3f;if(!_0x295c6f[_0x2bc051(0x1c0)]&&_0x4d00f1!=undefined&&_0x4d00f1==_0x2a5c3f)return null;_0x26b42c['isProVersion']&&_0x588090&&recordThermodynamics(_0x26b42c,_0x1f20d5,_0x2a5c3f,_0x295c6f[_0x2bc051(0x175)]);const _0x35402b={'timestamp':_0xda4fe2,'id':_0x1f20d5,'name':_0x295c6f['name'],'type':_0x295c6f[_0x2bc051(0x17a)],'location':_0x295c6f['location'],'value':_0x2a5c3f};_0x26b42c[_0x2bc051(0x1a6)]['unshift'](_0x35402b);if(_0x26b42c[_0x2bc051(0x1a6)]['length']>HISTORY_MAX_SIZE)_0x26b42c['eventHistory'][_0x2bc051(0x188)]();await _0x26b42c[_0x2bc051(0x196)](_0x2bc051(0x1b5),{'val':JSON[_0x2bc051(0x1da)](_0x35402b),'ack':!![]}),await _0x26b42c[_0x2bc051(0x196)](_0x2bc051(0x1ca),{'val':JSON['stringify'](_0x26b42c[_0x2bc051(0x1a6)]),'ack':!![]});if(_0x26b42c[_0x2bc051(0x18f)]){_0x26b42c[_0x2bc051(0x1b9)][_0x2bc051(0x192)](_0x35402b);if(_0x26b42c[_0x2bc051(0x1b9)][_0x2bc051(0x1be)]>RAW_LOG_MAX_SIZE)_0x26b42c[_0x2bc051(0x1b9)]['splice'](0x0,_0x26b42c[_0x2bc051(0x1b9)][_0x2bc051(0x1be)]-RAW_LOG_MAX_SIZE);await _0x26b42c[_0x2bc051(0x196)](_0x2bc051(0x179),{'val':JSON[_0x2bc051(0x1da)](_0x26b42c['rawEventLog']),'ack':!![]}),recordSequence(_0x26b42c,_0x35402b);}if(_0x295c6f['isExit']&&_0x2a5c3f===!![]){if(_0x26b42c[_0x2bc051(0x18c)]&&!_0x26b42c[_0x2bc051(0x1cf)])startExitTimer(_0x26b42c);else{if(!_0x26b42c['isPresent'])setPresence(_0x26b42c,!![]);}}else{if(_0x295c6f[_0x2bc051(0x17a)]==='motion'&&_0x2a5c3f===!![]){if(_0x26b42c[_0x2bc051(0x1a9)])abortExitTimer(_0x26b42c);if(!_0x26b42c[_0x2bc051(0x18c)]&&_0x26b42c['currentSystemMode']===_0x2bc051(0x19e))setPresence(_0x26b42c,!![]);}}if(_0x26b42c[_0x2bc051(0x18f)]&&_0x26b42c[_0x2bc051(0x1c6)]){_0x295c6f[_0x2bc051(0x17a)]===_0x2bc051(0x1a3)&&_0x2a5c3f===!![]&&_0x295c6f[_0x2bc051(0x175)]&&_0x26b42c[_0x2bc051(0x1c6)](_0x2bc051(0x174),{'room':_0x295c6f[_0x2bc051(0x175)]});const _0x3d50b1=[_0x2bc051(0x1d0),'t체r',_0x2bc051(0x1ab),_0x2bc051(0x1ac),'griff',_0x2bc051(0x1b2),_0x2bc051(0x1a7),_0x2bc051(0x1b6)][_0x2bc051(0x1bc)](_0x18c7ba=>_0x180575[_0x2bc051(0x1aa)](_0x18c7ba)),_0x4fd38f=[_0x2bc051(0x180),_0x2bc051(0x1c7),_0x2bc051(0x1c8),_0x2bc051(0x198),'dimmer',_0x2bc051(0x1d1)][_0x2bc051(0x1bc)](_0x26517a=>_0x180575['includes'](_0x26517a)),_0x1d4815=[_0x2bc051(0x1a3),_0x2bc051(0x1d4),'pr채senz',_0x2bc051(0x19c),_0x2bc051(0x1a1)][_0x2bc051(0x1bc)](_0x41fa6c=>_0x180575[_0x2bc051(0x1aa)](_0x41fa6c));if(_0x295c6f[_0x2bc051(0x175)]&&(_0x3d50b1||_0x4fd38f||_0x1d4815)){const _0x5d3054=_0x2a5c3f===!![]||typeof _0x2a5c3f===_0x2bc051(0x1b7)&&_0x2a5c3f>0x0,_0x221222=_0x3d50b1&&!_0x5d3054&&_0x4d00f1!==undefined&&_0x4d00f1!=_0x2a5c3f;if(_0x5d3054||_0x221222){const _0x2ec8df=_0x26b42c[_0x2bc051(0x1b8)]||_0xda4fe2,_0x390bd8=(_0xda4fe2-_0x2ec8df)/0x3e8;_0x26b42c[_0x2bc051(0x1b8)]=_0xda4fe2,_0x26b42c[_0x2bc051(0x1c6)]('TRACK_EVENT',{'room':_0x295c6f[_0x2bc051(0x175)],'dt':_0x390bd8});}}}return _0x35402b;}function a5_0xd69a(){const _0x35013b=['contact','SIMULATE_SIGNAL','location','loc','config','constructor','LTM.rawEventLog','type','745644eAibtA','LTM.trainingData.thermodynamics','heizung','Temperature','klima','light','STATUS','.NextHours.Location_1.Day_1.current.temp_value','[RECORDER]\x20Error:\x20','exports','LTM.trainingData.sequences','Valve','search','pop','189AzqeDi','.4.VALVE_STATE','Unknown','isPresent','exitGraceTimer','toLowerCase','isProVersion','getHours','weatherInstance','push','shift','4372004TDyOny','thermostat','setStateAsync','string','schalter','system.isPresent','1626124ZrDjky','pr채senz','presence','round','normal','message','.1.ACTUAL_TEMPERATURE','occupancy','val','motion','5MUsKUJ','STATE','eventHistory','lock','\x20from\x20','exitTimer','includes','window','fenster','1882131fmKWJe','error','parse','apply','daswetter','handle','.1.VALVE_STATE','.ACTUAL_TEMPERATURE','events.lastEvent','schloss','number','lastTrackerEventTime','rawEventLog','level','280008CmGMyJ','some','.forecast.current.temp','length','valveMapping','logDuplicates','temperature','value','LEVEL','log','.Current.Temperature','sendToPythonWrapper','licht','switch','temperatur','events.history','weatherunderground','1674834fgaWeB','(((.+)+)+)+$','getStateAsync','isGracePeriodActive','door','lampe','now','accuweather','bewegung','603774IEnADz','kontakt','from','sensorLastValues','.LEVEL','stringify','useWeather','getForeignStateAsync'];a5_0xd69a=function(){return _0x35013b;};return a5_0xd69a();}module[a5_0xf1f0d6(0x184)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};