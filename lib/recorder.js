const a5_0x15c24d=a5_0xf1a1;(function(_0x2fa576,_0x24a825){const _0x2abf7a=a5_0xf1a1,_0x139846=_0x2fa576();while(!![]){try{const _0x25385d=parseInt(_0x2abf7a(0x117))/0x1+parseInt(_0x2abf7a(0x11f))/0x2*(parseInt(_0x2abf7a(0x12f))/0x3)+parseInt(_0x2abf7a(0x154))/0x4+-parseInt(_0x2abf7a(0x169))/0x5+parseInt(_0x2abf7a(0x162))/0x6+parseInt(_0x2abf7a(0x138))/0x7*(-parseInt(_0x2abf7a(0x168))/0x8)+-parseInt(_0x2abf7a(0x14f))/0x9*(parseInt(_0x2abf7a(0x11c))/0xa);if(_0x25385d===_0x24a825)break;else _0x139846['push'](_0x139846['shift']());}catch(_0x252aec){_0x139846['push'](_0x139846['shift']());}}}(a5_0x2fe3,0x28dcc));const a5_0x127a01=(function(){let _0x12619b=!![];return function(_0x4890ce,_0x556c7e){const _0x3bee8c=_0x12619b?function(){const _0x421a2e=a5_0xf1a1;if(_0x556c7e){const _0x4a5775=_0x556c7e[_0x421a2e(0x148)](_0x4890ce,arguments);return _0x556c7e=null,_0x4a5775;}}:function(){};return _0x12619b=![],_0x3bee8c;};}()),a5_0x1abd14=a5_0x127a01(this,function(){const _0x427e61=a5_0xf1a1;return a5_0x1abd14[_0x427e61(0x124)]()[_0x427e61(0x105)]('(((.+)+)+)+$')['toString']()[_0x427e61(0x145)](a5_0x1abd14)['search'](_0x427e61(0x110));});a5_0x1abd14();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x15816f){const _0x28fbe2=a5_0xf1a1;if(_0x15816f[_0x28fbe2(0x131)][_0x28fbe2(0x164)])try{const _0x25d62c=await _0x15816f[_0x28fbe2(0x15b)](_0x15816f[_0x28fbe2(0x131)][_0x28fbe2(0x164)]);if(_0x25d62c&&_0x25d62c[_0x28fbe2(0x125)]!==undefined&&_0x25d62c[_0x28fbe2(0x125)]!==null)return parseFloat(_0x25d62c['val']);}catch(_0x12f655){}const _0x3604f4=_0x15816f[_0x28fbe2(0x131)]['weatherInstance'];if(!_0x15816f[_0x28fbe2(0x131)][_0x28fbe2(0x13d)]||!_0x3604f4)return null;try{let _0x222c7c='';if(_0x3604f4[_0x28fbe2(0x107)]('accuweather'))_0x222c7c=_0x3604f4+_0x28fbe2(0x15a);else{if(_0x3604f4[_0x28fbe2(0x107)](_0x28fbe2(0x146)))_0x222c7c=_0x3604f4+_0x28fbe2(0x142);else{if(_0x3604f4[_0x28fbe2(0x107)]('openweathermap'))_0x222c7c=_0x3604f4+'.forecast.current.temperature';else{if(_0x3604f4[_0x28fbe2(0x107)](_0x28fbe2(0x140)))_0x222c7c=_0x3604f4+_0x28fbe2(0x10c);}}}if(_0x222c7c){const _0x419d5f=await _0x15816f['getForeignStateAsync'](_0x222c7c);if(_0x419d5f&&_0x419d5f[_0x28fbe2(0x125)]!==undefined&&_0x419d5f['val']!==null)return parseFloat(_0x419d5f[_0x28fbe2(0x125)]);}}catch(_0x1e4fb9){}return null;}async function recordThermodynamics(_0x13fe2a,_0x38b50c,_0x4c7e82,_0x59f265){const _0xaeb744=a5_0xf1a1,_0x1b0c7d=await getOutsideTemperatureNumeric(_0x13fe2a);if(_0x1b0c7d===null)return;let _0x379433=0x0,_0x586d30=![];if(_0x13fe2a[_0xaeb744(0x131)][_0xaeb744(0x120)])try{let _0x34208b=_0x13fe2a[_0xaeb744(0x131)][_0xaeb744(0x120)];if(typeof _0x34208b===_0xaeb744(0x11e))_0x34208b=JSON[_0xaeb744(0x14d)](_0x34208b);if(_0x34208b[_0x38b50c]){const _0x464005=_0x34208b[_0x38b50c],_0x14a07a=await _0x13fe2a['getForeignStateAsync'](_0x464005);if(_0x14a07a&&_0x14a07a[_0xaeb744(0x125)]!==null&&_0x14a07a[_0xaeb744(0x125)]!==undefined){let _0x636b34=Number(_0x14a07a[_0xaeb744(0x125)]);if(_0x636b34<=1.05&&!_0x464005[_0xaeb744(0x107)]('STATUS')&&!_0x464005['includes'](_0xaeb744(0x13a)))_0x636b34=_0x636b34*0x64;_0x379433=Math['round'](_0x636b34),_0x586d30=!![];}}}catch(_0x2721f0){}if(!_0x586d30){const _0x15e6b0=[{'from':_0xaeb744(0x12b),'to':'.1.LEVEL'},{'from':_0xaeb744(0x12b),'to':_0xaeb744(0x111)},{'from':_0xaeb744(0x119),'to':'.4.VALVE_STATE'},{'from':'.ACTUAL_TEMPERATURE','to':'.LEVEL'},{'from':_0xaeb744(0x134),'to':'level'},{'from':_0xaeb744(0x163),'to':_0xaeb744(0x123)}];for(const _0xe8eb26 of _0x15e6b0){if(_0x38b50c[_0xaeb744(0x107)](_0xe8eb26[_0xaeb744(0x10e)])){const _0x213a6b=_0x38b50c[_0xaeb744(0x15f)](_0xe8eb26[_0xaeb744(0x10e)],_0xe8eb26['to']);try{const _0x50c7e2=await _0x13fe2a[_0xaeb744(0x15b)](_0x213a6b);if(_0x50c7e2&&_0x50c7e2[_0xaeb744(0x125)]!==null&&_0x50c7e2[_0xaeb744(0x125)]!==undefined){let _0x4d0746=Number(_0x50c7e2[_0xaeb744(0x125)]);if(typeof _0x4d0746===_0xaeb744(0x135)){if(_0x4d0746<=1.05&&_0xe8eb26['to'][_0xaeb744(0x107)](_0xaeb744(0x10b)))_0x4d0746=_0x4d0746*0x64;_0x379433=Math[_0xaeb744(0x143)](_0x4d0746),_0x586d30=!![];break;}}}catch(_0x1f7487){}}}}const _0x29060d=await _0x13fe2a['getStateAsync']('LTM.trainingData.thermodynamics');let _0xe5d48b=[];if(_0x29060d&&_0x29060d['val'])try{_0xe5d48b=JSON['parse'](_0x29060d[_0xaeb744(0x125)]);}catch(_0x34abf0){}_0xe5d48b[_0xaeb744(0x161)]({'ts':Date[_0xaeb744(0x106)](),'room':_0x59f265||'Unknown','t_in':_0x4c7e82,'t_out':_0x1b0c7d,'valve':_0x379433});if(_0xe5d48b[_0xaeb744(0x11a)]>THERMO_LOG_SIZE)_0xe5d48b[_0xaeb744(0x13c)]();await _0x13fe2a[_0xaeb744(0x12d)]('LTM.trainingData.thermodynamics',{'val':JSON['stringify'](_0xe5d48b),'ack':!![]});}async function saveCompletedSequence(_0x2396cf){const _0x3b1fe5=a5_0xf1a1;try{const _0x2711e6=await _0x2396cf[_0x3b1fe5(0x147)](_0x3b1fe5(0x137));let _0x4c2c34=[];if(_0x2711e6&&_0x2711e6['val'])try{_0x4c2c34=JSON[_0x3b1fe5(0x14d)](_0x2711e6[_0x3b1fe5(0x125)]);}catch(_0x321529){}const _0x1c0427=activeSequence[0x0]['ts'],_0x48bdd3=activeSequence[_0x3b1fe5(0x12e)](_0x50a8e8=>({'loc':_0x50a8e8['loc'],'t_delta':Math[_0x3b1fe5(0x143)]((_0x50a8e8['ts']-_0x1c0427)/0x3e8)})),_0x5160fc={'timestamp':new Date(_0x1c0427)[_0x3b1fe5(0x114)](),'steps':_0x48bdd3,'duration':Math[_0x3b1fe5(0x143)]((activeSequence[activeSequence[_0x3b1fe5(0x11a)]-0x1]['ts']-_0x1c0427)/0x3e8),'daytime':new Date(_0x1c0427)['getHours']()};_0x4c2c34[_0x3b1fe5(0x161)](_0x5160fc);if(_0x4c2c34[_0x3b1fe5(0x11a)]>MAX_TRAINING_SET_SIZE)_0x4c2c34[_0x3b1fe5(0x13c)]();await _0x2396cf[_0x3b1fe5(0x12d)](_0x3b1fe5(0x137),{'val':JSON[_0x3b1fe5(0x13f)](_0x4c2c34),'ack':!![]}),_0x2396cf[_0x3b1fe5(0x127)]&&_0x2396cf[_0x3b1fe5(0x167)]&&_0x2396cf[_0x3b1fe5(0x167)]('ANALYZE_SEQUENCE',{'sequence':_0x5160fc});}catch(_0x16e74c){_0x2396cf[_0x3b1fe5(0x113)][_0x3b1fe5(0x121)](_0x3b1fe5(0x157)+_0x16e74c[_0x3b1fe5(0x136)]);}}async function recordSequence(_0x5f5c07,_0x27062e){const _0x1f7609=a5_0xf1a1,_0x7f6995=(_0x27062e['type']||'')[_0x1f7609(0x149)](),_0x582891=['motion',_0x1f7609(0xff),_0x1f7609(0x160),'presence',_0x1f7609(0x11d),_0x1f7609(0x100),_0x1f7609(0x12c),'window',_0x1f7609(0x10f),_0x1f7609(0x13e),_0x1f7609(0x155),_0x1f7609(0x11b),_0x1f7609(0x128),_0x1f7609(0x101),_0x1f7609(0x141),_0x1f7609(0x158),_0x1f7609(0x116)];if(!_0x582891[_0x1f7609(0x14c)](_0x3a55c7=>_0x7f6995['includes'](_0x3a55c7)))return;if(!_0x27062e[_0x1f7609(0x13b)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x27062e[_0x1f7609(0x151)]||_0x1f7609(0x14b),'id':_0x27062e['id'],'ts':Date[_0x1f7609(0x106)]()}),sequenceTimer=setTimeout(async()=>{const _0x1cf477=_0x1f7609;if(activeSequence[_0x1cf477(0x11a)]>0x1)await saveCompletedSequence(_0x5f5c07);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function a5_0x2fe3(){const _0x35271d=['contact','stringify','weatherunderground','schalter','.NextHours.Location_1.Day_1.current.temp_value','round','exitTimer','constructor','daswetter','getStateAsync','apply','toLowerCase','klima','Unknown','some','parse','sensorLastValues','2492271fabyGg','TRACK_EVENT','location','isPresent','[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20','1337164XMBgkw','kontakt','unshift','[RECORDER]\x20Error:\x20','dimmer','exports','.Current.Temperature','getForeignStateAsync','eventHistory','temperatur','window','replace','pr채senz','push','430752HZOnCx','Temperature','outdoorSensorId','type','name','sendToPythonWrapper','8DfvJUM','1337790HYRQNA','bewegung','door','switch','motion','SIMULATE_SIGNAL','isExit','search','now','includes','system.isPresent','rawEventLog','normal','LEVEL','.forecast.current.temp','splice','from','fenster','(((.+)+)+)+$','.1.VALVE_STATE','handle','log','toISOString','events.lastEvent','lampe','50280TKhurW','lastTrackerEventTime','.1.TEMPERATURE','length','light','10SpJpgK','occupancy','string','2nRrPqp','valveMapping','error','schloss','Valve','toString','val','LTM.rawEventLog','isProVersion','licht','pop','debug','.1.ACTUAL_TEMPERATURE','t체r','setStateAsync','map','896586pAWCCT','presence','config','exitGraceTimer','lock','temperature','number','message','LTM.trainingData.sequences','303632dxnuOn','isGracePeriodActive','STATE','value','shift','useWeather'];a5_0x2fe3=function(){return _0x35271d;};return a5_0x2fe3();}function a5_0xf1a1(_0x4e635d,_0x5820f3){const _0x15e8e4=a5_0x2fe3();return a5_0xf1a1=function(_0x1abd14,_0x127a01){_0x1abd14=_0x1abd14-0xff;let _0x2fe312=_0x15e8e4[_0x1abd14];return _0x2fe312;},a5_0xf1a1(_0x4e635d,_0x5820f3);}function startExitTimer(_0x1ad6ae){const _0x1088aa=a5_0xf1a1;abortExitTimer(_0x1ad6ae),_0x1ad6ae[_0x1088aa(0x139)]=!![],_0x1ad6ae[_0x1088aa(0x132)]=setTimeout(()=>{const _0x91b355=_0x1088aa;_0x1ad6ae[_0x91b355(0x139)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x1ad6ae['exitTimer']=setTimeout(()=>{const _0xf5795d=_0x1088aa;setPresence(_0x1ad6ae,![]),_0x1ad6ae[_0xf5795d(0x144)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x279475){const _0x417ccd=a5_0xf1a1;if(_0x279475['exitTimer'])clearTimeout(_0x279475[_0x417ccd(0x144)]);if(_0x279475[_0x417ccd(0x132)])clearTimeout(_0x279475['exitGraceTimer']);_0x279475[_0x417ccd(0x144)]=null,_0x279475['exitGraceTimer']=null,_0x279475[_0x417ccd(0x139)]=![];}async function setPresence(_0x51e427,_0x2ffb70){const _0x1cb243=a5_0xf1a1;if(_0x51e427[_0x1cb243(0x152)]===_0x2ffb70)return;_0x51e427[_0x1cb243(0x152)]=_0x2ffb70,await _0x51e427[_0x1cb243(0x12d)](_0x1cb243(0x108),{'val':_0x2ffb70,'ack':!![]});}async function processSensorEvent(_0x1b9f1b,_0x521d9e,_0x22c682,_0x4fd0d9){const _0x56922d=a5_0xf1a1;if(!_0x4fd0d9)return null;const _0x1c9035=_0x22c682[_0x56922d(0x125)],_0x2d0a4f=Date['now'](),_0x3335db=_0x1b9f1b[_0x56922d(0x14e)][_0x521d9e],_0x41921d=(_0x4fd0d9['type']||'')[_0x56922d(0x149)](),_0xb4b7f5=_0x41921d[_0x56922d(0x107)](_0x56922d(0x134))||_0x41921d[_0x56922d(0x107)](_0x56922d(0x15d))||_0x41921d[_0x56922d(0x107)](_0x56922d(0x14a))||_0x41921d[_0x56922d(0x107)]('heizung')||_0x41921d[_0x56922d(0x107)]('thermostat');if(_0xb4b7f5&&typeof _0x1c9035==='number'){if(_0x1c9035>0x50||_0x1c9035<-0x32)return _0x1b9f1b[_0x56922d(0x113)][_0x56922d(0x12a)](_0x56922d(0x153)+_0x1c9035+'\x20from\x20'+_0x521d9e),null;}_0x1b9f1b['sensorLastValues'][_0x521d9e]=_0x1c9035;if(!_0x4fd0d9['logDuplicates']&&_0x3335db!=undefined&&_0x3335db==_0x1c9035)return null;_0x1b9f1b[_0x56922d(0x127)]&&_0xb4b7f5&&recordThermodynamics(_0x1b9f1b,_0x521d9e,_0x1c9035,_0x4fd0d9['location']);const _0x66d7d8={'timestamp':_0x2d0a4f,'id':_0x521d9e,'name':_0x4fd0d9[_0x56922d(0x166)],'type':_0x4fd0d9[_0x56922d(0x165)],'location':_0x4fd0d9[_0x56922d(0x151)],'value':_0x1c9035};_0x1b9f1b['eventHistory'][_0x56922d(0x156)](_0x66d7d8);if(_0x1b9f1b[_0x56922d(0x15c)]['length']>HISTORY_MAX_SIZE)_0x1b9f1b['eventHistory'][_0x56922d(0x129)]();await _0x1b9f1b[_0x56922d(0x12d)](_0x56922d(0x115),{'val':JSON[_0x56922d(0x13f)](_0x66d7d8),'ack':!![]}),await _0x1b9f1b[_0x56922d(0x12d)]('events.history',{'val':JSON[_0x56922d(0x13f)](_0x1b9f1b['eventHistory']),'ack':!![]});if(_0x1b9f1b[_0x56922d(0x127)]){_0x1b9f1b[_0x56922d(0x109)]['push'](_0x66d7d8);if(_0x1b9f1b[_0x56922d(0x109)]['length']>RAW_LOG_MAX_SIZE)_0x1b9f1b[_0x56922d(0x109)][_0x56922d(0x10d)](0x0,_0x1b9f1b[_0x56922d(0x109)][_0x56922d(0x11a)]-RAW_LOG_MAX_SIZE);await _0x1b9f1b[_0x56922d(0x12d)](_0x56922d(0x126),{'val':JSON[_0x56922d(0x13f)](_0x1b9f1b['rawEventLog']),'ack':!![]}),recordSequence(_0x1b9f1b,_0x66d7d8);}if(_0x4fd0d9[_0x56922d(0x104)]&&_0x1c9035===!![]){if(_0x1b9f1b['isPresent']&&!_0x1b9f1b['isGracePeriodActive'])startExitTimer(_0x1b9f1b);else{if(!_0x1b9f1b[_0x56922d(0x152)])setPresence(_0x1b9f1b,!![]);}}else{if(_0x4fd0d9[_0x56922d(0x165)]==='motion'&&_0x1c9035===!![]){if(_0x1b9f1b[_0x56922d(0x144)])abortExitTimer(_0x1b9f1b);if(!_0x1b9f1b[_0x56922d(0x152)]&&_0x1b9f1b['currentSystemMode']===_0x56922d(0x10a))setPresence(_0x1b9f1b,!![]);}}if(_0x1b9f1b[_0x56922d(0x127)]&&_0x1b9f1b[_0x56922d(0x167)]){_0x4fd0d9[_0x56922d(0x165)]===_0x56922d(0x102)&&_0x1c9035===!![]&&_0x4fd0d9[_0x56922d(0x151)]&&_0x1b9f1b[_0x56922d(0x167)](_0x56922d(0x103),{'room':_0x4fd0d9[_0x56922d(0x151)]});const _0x3d3899=['door','t체r',_0x56922d(0x15e),_0x56922d(0x10f),'griff',_0x56922d(0x112),_0x56922d(0x133),_0x56922d(0x122)]['some'](_0x228b40=>_0x41921d[_0x56922d(0x107)](_0x228b40)),_0x1521aa=[_0x56922d(0x11b),_0x56922d(0x128),_0x56922d(0x101),_0x56922d(0x141),'dimmer','lampe'][_0x56922d(0x14c)](_0x21c918=>_0x41921d[_0x56922d(0x107)](_0x21c918)),_0x9bd744=[_0x56922d(0x102),_0x56922d(0xff),'pr채senz',_0x56922d(0x130),_0x56922d(0x11d)][_0x56922d(0x14c)](_0x1df4f7=>_0x41921d['includes'](_0x1df4f7));if(_0x4fd0d9[_0x56922d(0x151)]&&(_0x3d3899||_0x1521aa||_0x9bd744)){const _0x219786=_0x1c9035===!![]||typeof _0x1c9035===_0x56922d(0x135)&&_0x1c9035>0x0,_0x56712e=_0x3d3899&&!_0x219786&&_0x3335db!==undefined&&_0x3335db!=_0x1c9035;if(_0x219786||_0x56712e){const _0x1488a2=_0x1b9f1b['lastTrackerEventTime']||_0x2d0a4f,_0x5a19e5=(_0x2d0a4f-_0x1488a2)/0x3e8;_0x1b9f1b[_0x56922d(0x118)]=_0x2d0a4f,_0x1b9f1b[_0x56922d(0x167)](_0x56922d(0x150),{'room':_0x4fd0d9['location'],'dt':_0x5a19e5});}}}return _0x66d7d8;}module[a5_0x15c24d(0x159)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};