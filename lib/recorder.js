const a5_0x1fd31d=a5_0x5d23;(function(_0x19b16c,_0x2c99ef){const _0x4ffb65=a5_0x5d23,_0x12925b=_0x19b16c();while(!![]){try{const _0x14799f=parseInt(_0x4ffb65(0x113))/0x1+-parseInt(_0x4ffb65(0xf6))/0x2*(-parseInt(_0x4ffb65(0x11d))/0x3)+parseInt(_0x4ffb65(0xf1))/0x4+parseInt(_0x4ffb65(0x138))/0x5+parseInt(_0x4ffb65(0xed))/0x6*(-parseInt(_0x4ffb65(0xfc))/0x7)+-parseInt(_0x4ffb65(0x144))/0x8+-parseInt(_0x4ffb65(0x13a))/0x9*(parseInt(_0x4ffb65(0x124))/0xa);if(_0x14799f===_0x2c99ef)break;else _0x12925b['push'](_0x12925b['shift']());}catch(_0x19c8af){_0x12925b['push'](_0x12925b['shift']());}}}(a5_0x295e,0x36668));const a5_0x55f55=(function(){let _0x1324f5=!![];return function(_0x235db6,_0x4f19e2){const _0x35004c=_0x1324f5?function(){if(_0x4f19e2){const _0x5d6eb4=_0x4f19e2['apply'](_0x235db6,arguments);return _0x4f19e2=null,_0x5d6eb4;}}:function(){};return _0x1324f5=![],_0x35004c;};}()),a5_0x253f30=a5_0x55f55(this,function(){const _0x2535ba=a5_0x5d23;return a5_0x253f30[_0x2535ba(0x156)]()[_0x2535ba(0x107)](_0x2535ba(0x117))['toString']()['constructor'](a5_0x253f30)[_0x2535ba(0x107)]('(((.+)+)+)+$');});a5_0x253f30();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;function a5_0x295e(){const _0x2821a4=['pop','includes','setStateAsync','handle','.ACTUAL_TEMPERATURE','lampe','message','.4.VALVE_STATE','.1.VALVE_STATE','exports','push','317834JEUoZP','dimmer','LTM.trainingData.sequences','exitGraceTimer','(((.+)+)+)+$','ANALYZE_SEQUENCE','Unknown','location','[RECORDER]\x20Error:\x20','Temperature','3SYSnte','valveMapping','eventHistory','config','openweathermap','replace','val','10RJoffw','outdoorSensorId','contact','string','stringify','map','window','toISOString','log','.forecast.current.temperature','.1.TEMPERATURE','TRACK_EVENT','motion','thermostat','isProVersion','kontakt','parse','unshift','.1.ACTUAL_TEMPERATURE','error','489380qvIlmI','number','4154751vZCkMm','some','occupancy','currentSystemMode','splice','temperature','.1.LEVEL','weatherunderground','round','getStateAsync','1058992mkZieg','klima','.LEVEL','logDuplicates','schloss','system.isPresent','shift','LTM.trainingData.thermodynamics','fenster','SIMULATE_SIGNAL','rawEventLog','\x20from\x20','value','pr채senz','level','.NextHours.Location_1.Day_1.current.temp_value','switch','type','toString','lastTrackerEventTime','events.history','events.lastEvent','normal','exitTimer','6rqHDul','sendToPythonWrapper','length','getHours','1439512KAZBeO','heizung','temperatur','t체r','.Current.Temperature','787974fgNLfG','presence','lock','griff','debug','isGracePeriodActive','2469166bhYgNo','licht','isExit','sensorLastValues','from','now','getForeignStateAsync','door','isPresent','.forecast.current.temp','daswetter','search'];a5_0x295e=function(){return _0x2821a4;};return a5_0x295e();}let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x28086f){const _0x17854b=a5_0x5d23;if(_0x28086f['config'][_0x17854b(0x125)])try{const _0x33a07e=await _0x28086f[_0x17854b(0x102)](_0x28086f[_0x17854b(0x120)]['outdoorSensorId']);if(_0x33a07e&&_0x33a07e[_0x17854b(0x123)]!==undefined&&_0x33a07e[_0x17854b(0x123)]!==null)return parseFloat(_0x33a07e[_0x17854b(0x123)]);}catch(_0x61fbba){}const _0x37b06f=_0x28086f['config']['weatherInstance'];if(!_0x28086f[_0x17854b(0x120)]['useWeather']||!_0x37b06f)return null;try{let _0x1bde02='';if(_0x37b06f[_0x17854b(0x109)]('accuweather'))_0x1bde02=_0x37b06f+_0x17854b(0xf5);else{if(_0x37b06f[_0x17854b(0x109)](_0x17854b(0x106)))_0x1bde02=_0x37b06f+_0x17854b(0x153);else{if(_0x37b06f[_0x17854b(0x109)](_0x17854b(0x121)))_0x1bde02=_0x37b06f+_0x17854b(0x12d);else{if(_0x37b06f[_0x17854b(0x109)](_0x17854b(0x141)))_0x1bde02=_0x37b06f+_0x17854b(0x105);}}}if(_0x1bde02){const _0x3b45c3=await _0x28086f[_0x17854b(0x102)](_0x1bde02);if(_0x3b45c3&&_0x3b45c3['val']!==undefined&&_0x3b45c3[_0x17854b(0x123)]!==null)return parseFloat(_0x3b45c3[_0x17854b(0x123)]);}}catch(_0x57cbac){}return null;}async function recordThermodynamics(_0x56e6cc,_0x4ebada,_0x4f0ccc,_0x1f734c){const _0x5a168e=a5_0x5d23,_0x4e3309=await getOutsideTemperatureNumeric(_0x56e6cc);if(_0x4e3309===null)return;let _0x30e057=0x0,_0x15e2e6=![];if(_0x56e6cc[_0x5a168e(0x120)][_0x5a168e(0x11e)])try{let _0x398f4a=_0x56e6cc[_0x5a168e(0x120)][_0x5a168e(0x11e)];if(typeof _0x398f4a===_0x5a168e(0x127))_0x398f4a=JSON[_0x5a168e(0x134)](_0x398f4a);if(_0x398f4a[_0x4ebada]){const _0x3df9b2=_0x398f4a[_0x4ebada],_0x27b78e=await _0x56e6cc[_0x5a168e(0x102)](_0x3df9b2);if(_0x27b78e&&_0x27b78e[_0x5a168e(0x123)]!==null&&_0x27b78e[_0x5a168e(0x123)]!==undefined){let _0xf9e24e=Number(_0x27b78e[_0x5a168e(0x123)]);if(_0xf9e24e<=1.05&&!_0x3df9b2['includes']('STATUS')&&!_0x3df9b2[_0x5a168e(0x109)]('STATE'))_0xf9e24e=_0xf9e24e*0x64;_0x30e057=Math['round'](_0xf9e24e),_0x15e2e6=!![];}}}catch(_0x26aec9){}if(!_0x15e2e6){const _0x377fb7=[{'from':'.1.ACTUAL_TEMPERATURE','to':_0x5a168e(0x140)},{'from':_0x5a168e(0x136),'to':_0x5a168e(0x110)},{'from':_0x5a168e(0x12e),'to':_0x5a168e(0x10f)},{'from':_0x5a168e(0x10c),'to':_0x5a168e(0x146)},{'from':_0x5a168e(0x13f),'to':_0x5a168e(0x152)},{'from':_0x5a168e(0x11c),'to':'Valve'}];for(const _0x48a133 of _0x377fb7){if(_0x4ebada['includes'](_0x48a133['from'])){const _0xf370d6=_0x4ebada[_0x5a168e(0x122)](_0x48a133[_0x5a168e(0x100)],_0x48a133['to']);try{const _0x4bd4e9=await _0x56e6cc[_0x5a168e(0x102)](_0xf370d6);if(_0x4bd4e9&&_0x4bd4e9['val']!==null&&_0x4bd4e9[_0x5a168e(0x123)]!==undefined){let _0x21dbbb=Number(_0x4bd4e9[_0x5a168e(0x123)]);if(typeof _0x21dbbb===_0x5a168e(0x139)){if(_0x21dbbb<=1.05&&_0x48a133['to'][_0x5a168e(0x109)]('LEVEL'))_0x21dbbb=_0x21dbbb*0x64;_0x30e057=Math[_0x5a168e(0x142)](_0x21dbbb),_0x15e2e6=!![];break;}}}catch(_0x779273){}}}}const _0x19f728=await _0x56e6cc[_0x5a168e(0x143)](_0x5a168e(0x14b));let _0x3a6be5=[];if(_0x19f728&&_0x19f728['val'])try{_0x3a6be5=JSON['parse'](_0x19f728[_0x5a168e(0x123)]);}catch(_0x4c199f){}_0x3a6be5['push']({'ts':Date[_0x5a168e(0x101)](),'room':_0x1f734c||_0x5a168e(0x119),'t_in':_0x4f0ccc,'t_out':_0x4e3309,'valve':_0x30e057});if(_0x3a6be5[_0x5a168e(0xef)]>THERMO_LOG_SIZE)_0x3a6be5[_0x5a168e(0x14a)]();await _0x56e6cc['setStateAsync'](_0x5a168e(0x14b),{'val':JSON[_0x5a168e(0x128)](_0x3a6be5),'ack':!![]});}async function saveCompletedSequence(_0x18cea7){const _0x22e320=a5_0x5d23;try{const _0x5bceee=await _0x18cea7['getStateAsync'](_0x22e320(0x115));let _0x1ad89a=[];if(_0x5bceee&&_0x5bceee[_0x22e320(0x123)])try{_0x1ad89a=JSON[_0x22e320(0x134)](_0x5bceee[_0x22e320(0x123)]);}catch(_0x38c9ba){}const _0x2880ad=activeSequence[0x0]['ts'],_0x41ba02=activeSequence[_0x22e320(0x129)](_0x10c305=>({'loc':_0x10c305['loc'],'t_delta':Math[_0x22e320(0x142)]((_0x10c305['ts']-_0x2880ad)/0x3e8)})),_0xbc2ef4={'timestamp':new Date(_0x2880ad)[_0x22e320(0x12b)](),'steps':_0x41ba02,'duration':Math[_0x22e320(0x142)]((activeSequence[activeSequence[_0x22e320(0xef)]-0x1]['ts']-_0x2880ad)/0x3e8),'daytime':new Date(_0x2880ad)[_0x22e320(0xf0)]()};_0x1ad89a[_0x22e320(0x112)](_0xbc2ef4);if(_0x1ad89a[_0x22e320(0xef)]>MAX_TRAINING_SET_SIZE)_0x1ad89a[_0x22e320(0x14a)]();await _0x18cea7[_0x22e320(0x10a)]('LTM.trainingData.sequences',{'val':JSON[_0x22e320(0x128)](_0x1ad89a),'ack':!![]}),_0x18cea7['isProVersion']&&_0x18cea7[_0x22e320(0xee)]&&_0x18cea7[_0x22e320(0xee)](_0x22e320(0x118),{'sequence':_0xbc2ef4});}catch(_0x275e15){_0x18cea7[_0x22e320(0x12c)][_0x22e320(0x137)](_0x22e320(0x11b)+_0x275e15[_0x22e320(0x10e)]);}}async function recordSequence(_0x4c5b15,_0x5d9f4e){const _0x5cc6b5=a5_0x5d23,_0xc3fc5e=(_0x5d9f4e[_0x5cc6b5(0x155)]||'')['toLowerCase'](),_0x30c357=[_0x5cc6b5(0x130),'bewegung','pr채senz',_0x5cc6b5(0xf7),_0x5cc6b5(0x13c),_0x5cc6b5(0x103),_0x5cc6b5(0xf4),_0x5cc6b5(0x12a),_0x5cc6b5(0x14c),_0x5cc6b5(0x126),_0x5cc6b5(0x133),'light',_0x5cc6b5(0xfd),_0x5cc6b5(0x154),'schalter',_0x5cc6b5(0x114),_0x5cc6b5(0x10d)];if(!_0x30c357[_0x5cc6b5(0x13b)](_0x46bb22=>_0xc3fc5e['includes'](_0x46bb22)))return;if(!_0x5d9f4e[_0x5cc6b5(0x150)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x5cc6b5(0x112)]({'loc':_0x5d9f4e[_0x5cc6b5(0x11a)]||_0x5cc6b5(0x119),'id':_0x5d9f4e['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{const _0x406ce2=_0x5cc6b5;if(activeSequence[_0x406ce2(0xef)]>0x1)await saveCompletedSequence(_0x4c5b15);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0x3f3e90){const _0x3a0468=a5_0x5d23;abortExitTimer(_0x3f3e90),_0x3f3e90[_0x3a0468(0xfb)]=!![],_0x3f3e90[_0x3a0468(0x116)]=setTimeout(()=>{const _0x5f2338=_0x3a0468;_0x3f3e90[_0x5f2338(0xfb)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x3f3e90[_0x3a0468(0xec)]=setTimeout(()=>{setPresence(_0x3f3e90,![]),_0x3f3e90['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x2359f5){const _0x4b87f9=a5_0x5d23;if(_0x2359f5[_0x4b87f9(0xec)])clearTimeout(_0x2359f5[_0x4b87f9(0xec)]);if(_0x2359f5[_0x4b87f9(0x116)])clearTimeout(_0x2359f5[_0x4b87f9(0x116)]);_0x2359f5[_0x4b87f9(0xec)]=null,_0x2359f5[_0x4b87f9(0x116)]=null,_0x2359f5[_0x4b87f9(0xfb)]=![];}async function setPresence(_0x2af021,_0x56af99){const _0x3560f7=a5_0x5d23;if(_0x2af021[_0x3560f7(0x104)]===_0x56af99)return;_0x2af021[_0x3560f7(0x104)]=_0x56af99,await _0x2af021[_0x3560f7(0x10a)](_0x3560f7(0x149),{'val':_0x56af99,'ack':!![]});}async function processSensorEvent(_0x4d363,_0x26a8ec,_0x867d52,_0x1b5916){const _0x290646=a5_0x5d23;if(!_0x1b5916)return null;const _0x52b0c1=_0x867d52[_0x290646(0x123)],_0x3575e4=Date[_0x290646(0x101)](),_0x3dd6df=_0x4d363[_0x290646(0xff)][_0x26a8ec],_0x5f4f8e=(_0x1b5916[_0x290646(0x155)]||'')['toLowerCase'](),_0x112294=_0x5f4f8e[_0x290646(0x109)](_0x290646(0x13f))||_0x5f4f8e[_0x290646(0x109)](_0x290646(0xf3))||_0x5f4f8e[_0x290646(0x109)](_0x290646(0x145))||_0x5f4f8e['includes'](_0x290646(0xf2))||_0x5f4f8e['includes'](_0x290646(0x131));if(_0x112294&&typeof _0x52b0c1==='number'){if(_0x52b0c1>0x50||_0x52b0c1<-0x32)return _0x4d363[_0x290646(0x12c)][_0x290646(0xfa)]('[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20'+_0x52b0c1+_0x290646(0x14f)+_0x26a8ec),null;}_0x4d363[_0x290646(0xff)][_0x26a8ec]=_0x52b0c1;if(!_0x1b5916[_0x290646(0x147)]&&_0x3dd6df!=undefined&&_0x3dd6df==_0x52b0c1)return null;_0x4d363[_0x290646(0x132)]&&_0x112294&&recordThermodynamics(_0x4d363,_0x26a8ec,_0x52b0c1,_0x1b5916['location']);const _0x4ba714={'timestamp':_0x3575e4,'id':_0x26a8ec,'name':_0x1b5916['name'],'type':_0x1b5916[_0x290646(0x155)],'location':_0x1b5916[_0x290646(0x11a)],'value':_0x52b0c1};_0x4d363[_0x290646(0x11f)][_0x290646(0x135)](_0x4ba714);if(_0x4d363['eventHistory']['length']>HISTORY_MAX_SIZE)_0x4d363['eventHistory'][_0x290646(0x108)]();await _0x4d363['setStateAsync'](_0x290646(0x159),{'val':JSON[_0x290646(0x128)](_0x4ba714),'ack':!![]}),await _0x4d363[_0x290646(0x10a)](_0x290646(0x158),{'val':JSON[_0x290646(0x128)](_0x4d363['eventHistory']),'ack':!![]});if(_0x4d363[_0x290646(0x132)]){_0x4d363[_0x290646(0x14e)][_0x290646(0x112)](_0x4ba714);if(_0x4d363[_0x290646(0x14e)][_0x290646(0xef)]>RAW_LOG_MAX_SIZE)_0x4d363[_0x290646(0x14e)][_0x290646(0x13e)](0x0,_0x4d363[_0x290646(0x14e)][_0x290646(0xef)]-RAW_LOG_MAX_SIZE);await _0x4d363[_0x290646(0x10a)]('LTM.rawEventLog',{'val':JSON[_0x290646(0x128)](_0x4d363[_0x290646(0x14e)]),'ack':!![]}),recordSequence(_0x4d363,_0x4ba714);}if(_0x1b5916[_0x290646(0xfe)]&&_0x52b0c1===!![]){if(_0x4d363[_0x290646(0x104)]&&!_0x4d363['isGracePeriodActive'])startExitTimer(_0x4d363);else{if(!_0x4d363[_0x290646(0x104)])setPresence(_0x4d363,!![]);}}else{if(_0x1b5916[_0x290646(0x155)]===_0x290646(0x130)&&_0x52b0c1===!![]){if(_0x4d363[_0x290646(0xec)])abortExitTimer(_0x4d363);if(!_0x4d363['isPresent']&&_0x4d363[_0x290646(0x13d)]===_0x290646(0x15a))setPresence(_0x4d363,!![]);}}if(_0x4d363['isProVersion']&&_0x4d363[_0x290646(0xee)]){_0x1b5916['type']===_0x290646(0x130)&&_0x52b0c1===!![]&&_0x1b5916['location']&&_0x4d363[_0x290646(0xee)](_0x290646(0x14d),{'room':_0x1b5916[_0x290646(0x11a)]});const _0x1ed565=['door','t체r',_0x290646(0x12a),_0x290646(0x14c),_0x290646(0xf9),_0x290646(0x10b),_0x290646(0xf8),_0x290646(0x148)][_0x290646(0x13b)](_0x3f1d00=>_0x5f4f8e['includes'](_0x3f1d00)),_0x125e2a=['light',_0x290646(0xfd),_0x290646(0x154),'schalter',_0x290646(0x114),'lampe'][_0x290646(0x13b)](_0x2288a9=>_0x5f4f8e[_0x290646(0x109)](_0x2288a9)),_0x2af909=[_0x290646(0x130),'bewegung',_0x290646(0x151),_0x290646(0xf7),_0x290646(0x13c)][_0x290646(0x13b)](_0x401e5b=>_0x5f4f8e['includes'](_0x401e5b));if(_0x1b5916[_0x290646(0x11a)]&&(_0x1ed565||_0x125e2a||_0x2af909)){const _0x296447=_0x52b0c1===!![]||typeof _0x52b0c1===_0x290646(0x139)&&_0x52b0c1>0x0,_0x356cc2=_0x1ed565&&!_0x296447&&_0x3dd6df!==undefined&&_0x3dd6df!=_0x52b0c1;if(_0x296447||_0x356cc2){const _0x3d79ff=_0x4d363['lastTrackerEventTime']||_0x3575e4,_0x4f759a=(_0x3575e4-_0x3d79ff)/0x3e8;_0x4d363[_0x290646(0x157)]=_0x3575e4,_0x4d363[_0x290646(0xee)](_0x290646(0x12f),{'room':_0x1b5916[_0x290646(0x11a)],'dt':_0x4f759a});}}}return _0x4ba714;}function a5_0x5d23(_0x3b15b8,_0x33274f){const _0x1f2b67=a5_0x295e();return a5_0x5d23=function(_0x253f30,_0x55f55){_0x253f30=_0x253f30-0xec;let _0x295eca=_0x1f2b67[_0x253f30];return _0x295eca;},a5_0x5d23(_0x3b15b8,_0x33274f);}module[a5_0x1fd31d(0x111)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};