const a5_0x19bc34=a5_0x5af4;(function(_0x6ac01d,_0x32014d){const _0x26d243=a5_0x5af4,_0xaac7c8=_0x6ac01d();while(!![]){try{const _0x3623b0=parseInt(_0x26d243(0x11b))/0x1+parseInt(_0x26d243(0x175))/0x2+-parseInt(_0x26d243(0x155))/0x3+parseInt(_0x26d243(0x139))/0x4*(parseInt(_0x26d243(0x130))/0x5)+parseInt(_0x26d243(0x179))/0x6*(parseInt(_0x26d243(0x126))/0x7)+parseInt(_0x26d243(0x138))/0x8*(parseInt(_0x26d243(0x141))/0x9)+-parseInt(_0x26d243(0x15d))/0xa*(parseInt(_0x26d243(0x13d))/0xb);if(_0x3623b0===_0x32014d)break;else _0xaac7c8['push'](_0xaac7c8['shift']());}catch(_0x2c994e){_0xaac7c8['push'](_0xaac7c8['shift']());}}}(a5_0x4512,0x8ab85));const a5_0x4ba545=(function(){let _0x42cdae=!![];return function(_0x573b5b,_0x22484f){const _0xacbba6=_0x42cdae?function(){const _0x5dab43=a5_0x5af4;if(_0x22484f){const _0x363507=_0x22484f[_0x5dab43(0x150)](_0x573b5b,arguments);return _0x22484f=null,_0x363507;}}:function(){};return _0x42cdae=![],_0xacbba6;};}()),a5_0x14f98d=a5_0x4ba545(this,function(){const _0x540db8=a5_0x5af4;return a5_0x14f98d[_0x540db8(0x11e)]()[_0x540db8(0x14f)]('(((.+)+)+)+$')['toString']()[_0x540db8(0x14b)](a5_0x14f98d)[_0x540db8(0x14f)](_0x540db8(0x160));});a5_0x14f98d();function a5_0x5af4(_0x1e34d4,_0x4462f8){const _0x27157a=a5_0x4512();return a5_0x5af4=function(_0x14f98d,_0x4ba545){_0x14f98d=_0x14f98d-0x11a;let _0x45125a=_0x27157a[_0x14f98d];return _0x45125a;},a5_0x5af4(_0x1e34d4,_0x4462f8);}'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x2c5ca6){const _0x1f1abb=a5_0x5af4;if(_0x2c5ca6[_0x1f1abb(0x147)][_0x1f1abb(0x13c)])try{const _0x1525e7=await _0x2c5ca6['getForeignStateAsync'](_0x2c5ca6[_0x1f1abb(0x147)]['outdoorSensorId']);if(_0x1525e7&&_0x1525e7['val']!==undefined&&_0x1525e7[_0x1f1abb(0x164)]!==null)return parseFloat(_0x1525e7[_0x1f1abb(0x164)]);}catch(_0x16a78a){}const _0xb38f6c=_0x2c5ca6['config']['weatherInstance'];if(!_0x2c5ca6[_0x1f1abb(0x147)][_0x1f1abb(0x146)]||!_0xb38f6c)return null;try{let _0x1d470e='';if(_0xb38f6c[_0x1f1abb(0x145)](_0x1f1abb(0x159)))_0x1d470e=_0xb38f6c+_0x1f1abb(0x184);else{if(_0xb38f6c[_0x1f1abb(0x145)](_0x1f1abb(0x121)))_0x1d470e=_0xb38f6c+_0x1f1abb(0x137);else{if(_0xb38f6c[_0x1f1abb(0x145)](_0x1f1abb(0x11d)))_0x1d470e=_0xb38f6c+_0x1f1abb(0x165);else{if(_0xb38f6c[_0x1f1abb(0x145)](_0x1f1abb(0x140)))_0x1d470e=_0xb38f6c+_0x1f1abb(0x11c);}}}if(_0x1d470e){const _0xf57880=await _0x2c5ca6['getForeignStateAsync'](_0x1d470e);if(_0xf57880&&_0xf57880[_0x1f1abb(0x164)]!==undefined&&_0xf57880[_0x1f1abb(0x164)]!==null)return parseFloat(_0xf57880['val']);}}catch(_0x3e9fe7){}return null;}async function recordThermodynamics(_0xf4e873,_0x1e94a7,_0x119098,_0x321d7e){const _0x1535bb=a5_0x5af4,_0x39f499=await getOutsideTemperatureNumeric(_0xf4e873);if(_0x39f499===null)return;let _0x4d70e5=0x0,_0x2bf2b3=![];if(_0xf4e873[_0x1535bb(0x147)][_0x1535bb(0x13e)])try{let _0x5687f4=_0xf4e873[_0x1535bb(0x147)][_0x1535bb(0x13e)];if(typeof _0x5687f4===_0x1535bb(0x161))_0x5687f4=JSON[_0x1535bb(0x15e)](_0x5687f4);if(_0x5687f4[_0x1e94a7]){const _0x596dbe=_0x5687f4[_0x1e94a7],_0x60e33c=await _0xf4e873[_0x1535bb(0x16e)](_0x596dbe);if(_0x60e33c&&_0x60e33c[_0x1535bb(0x164)]!==null&&_0x60e33c[_0x1535bb(0x164)]!==undefined){let _0x48343c=Number(_0x60e33c[_0x1535bb(0x164)]);if(_0x48343c<=1.05&&!_0x596dbe[_0x1535bb(0x145)](_0x1535bb(0x156))&&!_0x596dbe[_0x1535bb(0x145)]('STATE'))_0x48343c=_0x48343c*0x64;_0x4d70e5=Math['round'](_0x48343c),_0x2bf2b3=!![];}}}catch(_0x3ab755){}if(!_0x2bf2b3){const _0x464638=[{'from':'.1.ACTUAL_TEMPERATURE','to':_0x1535bb(0x166)},{'from':_0x1535bb(0x172),'to':_0x1535bb(0x16a)},{'from':_0x1535bb(0x16d),'to':_0x1535bb(0x17f)},{'from':_0x1535bb(0x180),'to':_0x1535bb(0x14c)},{'from':_0x1535bb(0x177),'to':_0x1535bb(0x168)},{'from':'Temperature','to':_0x1535bb(0x15a)}];for(const _0x24c501 of _0x464638){if(_0x1e94a7['includes'](_0x24c501['from'])){const _0x3e3045=_0x1e94a7['replace'](_0x24c501[_0x1535bb(0x11f)],_0x24c501['to']);try{const _0x1baa12=await _0xf4e873[_0x1535bb(0x16e)](_0x3e3045);if(_0x1baa12&&_0x1baa12[_0x1535bb(0x164)]!==null&&_0x1baa12[_0x1535bb(0x164)]!==undefined){let _0x1c6a03=Number(_0x1baa12['val']);if(typeof _0x1c6a03==='number'){if(_0x1c6a03<=1.05&&_0x24c501['to'][_0x1535bb(0x145)]('LEVEL'))_0x1c6a03=_0x1c6a03*0x64;_0x4d70e5=Math[_0x1535bb(0x148)](_0x1c6a03),_0x2bf2b3=!![];break;}}}catch(_0x329a86){}}}}const _0x2b5304=await _0xf4e873[_0x1535bb(0x149)](_0x1535bb(0x136));let _0x51fec0=[];if(_0x2b5304&&_0x2b5304[_0x1535bb(0x164)])try{_0x51fec0=JSON[_0x1535bb(0x15e)](_0x2b5304[_0x1535bb(0x164)]);}catch(_0x83272){}_0x51fec0[_0x1535bb(0x15c)]({'ts':Date[_0x1535bb(0x14d)](),'room':_0x321d7e||_0x1535bb(0x13a),'t_in':_0x119098,'t_out':_0x39f499,'valve':_0x4d70e5});if(_0x51fec0['length']>THERMO_LOG_SIZE)_0x51fec0['shift']();await _0xf4e873[_0x1535bb(0x178)](_0x1535bb(0x136),{'val':JSON['stringify'](_0x51fec0),'ack':!![]});}async function saveCompletedSequence(_0x3b8171){const _0x51153c=a5_0x5af4;try{const _0x4442ae=await _0x3b8171[_0x51153c(0x149)](_0x51153c(0x188));let _0x1690a7=[];if(_0x4442ae&&_0x4442ae['val'])try{_0x1690a7=JSON[_0x51153c(0x15e)](_0x4442ae['val']);}catch(_0x2feb74){}const _0x50ae5d=activeSequence[0x0]['ts'],_0x4ccb97=activeSequence[_0x51153c(0x135)](_0x293bfc=>({'loc':_0x293bfc[_0x51153c(0x158)],'t_delta':Math[_0x51153c(0x148)]((_0x293bfc['ts']-_0x50ae5d)/0x3e8)})),_0x3f4c53={'timestamp':new Date(_0x50ae5d)['toISOString'](),'steps':_0x4ccb97,'duration':Math[_0x51153c(0x148)]((activeSequence[activeSequence[_0x51153c(0x16f)]-0x1]['ts']-_0x50ae5d)/0x3e8),'daytime':new Date(_0x50ae5d)['getHours']()};_0x1690a7[_0x51153c(0x15c)](_0x3f4c53);if(_0x1690a7['length']>MAX_TRAINING_SET_SIZE)_0x1690a7[_0x51153c(0x12e)]();await _0x3b8171[_0x51153c(0x178)](_0x51153c(0x188),{'val':JSON['stringify'](_0x1690a7),'ack':!![]}),_0x3b8171['isProVersion']&&_0x3b8171[_0x51153c(0x153)]&&_0x3b8171[_0x51153c(0x153)]('ANALYZE_SEQUENCE',{'sequence':_0x3f4c53});}catch(_0x3d8cc9){_0x3b8171[_0x51153c(0x15f)]['error'](_0x51153c(0x163)+_0x3d8cc9['message']);}}async function recordSequence(_0x43a367,_0x42365c){const _0x2dd8df=a5_0x5af4,_0x280ba4=(_0x42365c[_0x2dd8df(0x17a)]||'')[_0x2dd8df(0x183)](),_0x3deda2=[_0x2dd8df(0x134),'bewegung',_0x2dd8df(0x187),_0x2dd8df(0x16c),'occupancy','door',_0x2dd8df(0x181),_0x2dd8df(0x15b),_0x2dd8df(0x176),_0x2dd8df(0x186),_0x2dd8df(0x17c),'light',_0x2dd8df(0x143),_0x2dd8df(0x171),_0x2dd8df(0x12c),_0x2dd8df(0x173),_0x2dd8df(0x17d)];if(!_0x3deda2[_0x2dd8df(0x12b)](_0x1631e0=>_0x280ba4[_0x2dd8df(0x145)](_0x1631e0)))return;if(!_0x42365c[_0x2dd8df(0x132)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x42365c[_0x2dd8df(0x157)]||_0x2dd8df(0x13a),'id':_0x42365c['id'],'ts':Date[_0x2dd8df(0x14d)]()}),sequenceTimer=setTimeout(async()=>{const _0x1efdea=_0x2dd8df;if(activeSequence[_0x1efdea(0x16f)]>0x1)await saveCompletedSequence(_0x43a367);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0x134303){const _0x3e8814=a5_0x5af4;abortExitTimer(_0x134303),_0x134303[_0x3e8814(0x12a)]=!![],_0x134303['exitGraceTimer']=setTimeout(()=>{const _0x4cdd5d=_0x3e8814;_0x134303[_0x4cdd5d(0x12a)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x134303[_0x3e8814(0x13b)]=setTimeout(()=>{const _0xe29b9a=_0x3e8814;setPresence(_0x134303,![]),_0x134303[_0xe29b9a(0x13b)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x460c31){const _0x5a8293=a5_0x5af4;if(_0x460c31[_0x5a8293(0x13b)])clearTimeout(_0x460c31[_0x5a8293(0x13b)]);if(_0x460c31[_0x5a8293(0x122)])clearTimeout(_0x460c31[_0x5a8293(0x122)]);_0x460c31['exitTimer']=null,_0x460c31[_0x5a8293(0x122)]=null,_0x460c31[_0x5a8293(0x12a)]=![];}async function setPresence(_0x4f102b,_0x41cd6c){const _0x4f00f3=a5_0x5af4;if(_0x4f102b['isPresent']===_0x41cd6c)return;_0x4f102b[_0x4f00f3(0x167)]=_0x41cd6c,await _0x4f102b[_0x4f00f3(0x178)](_0x4f00f3(0x174),{'val':_0x41cd6c,'ack':!![]});}async function processSensorEvent(_0x165289,_0x86f065,_0x27d90d,_0x4b0dd2){const _0x212e43=a5_0x5af4;if(!_0x4b0dd2)return null;const _0xe4384=_0x27d90d[_0x212e43(0x164)],_0x51189c=Date[_0x212e43(0x14d)](),_0x43166f=_0x165289[_0x212e43(0x129)][_0x86f065];_0x165289[_0x212e43(0x129)][_0x86f065]=_0xe4384;if(!_0x4b0dd2[_0x212e43(0x162)]&&_0x43166f!=undefined&&_0x43166f==_0xe4384)return null;const _0x3f3be4=(_0x4b0dd2[_0x212e43(0x17a)]||'')[_0x212e43(0x183)](),_0x3afdd1=_0x3f3be4[_0x212e43(0x145)](_0x212e43(0x177))||_0x3f3be4['includes'](_0x212e43(0x128))||_0x3f3be4[_0x212e43(0x145)](_0x212e43(0x124))||_0x3f3be4[_0x212e43(0x145)]('heizung')||_0x3f3be4[_0x212e43(0x145)](_0x212e43(0x151));if(_0x3afdd1&&typeof _0xe4384==='number'){if(_0xe4384>0x50||_0xe4384<-0x32)return _0x165289[_0x212e43(0x15f)]['debug'](_0x212e43(0x142)+_0xe4384+'째C\x20from\x20'+_0x86f065),null;}_0x165289['isProVersion']&&_0x3afdd1&&recordThermodynamics(_0x165289,_0x86f065,_0xe4384,_0x4b0dd2[_0x212e43(0x157)]);const _0x2b0782={'timestamp':_0x51189c,'id':_0x86f065,'name':_0x4b0dd2[_0x212e43(0x127)],'type':_0x4b0dd2[_0x212e43(0x17a)],'location':_0x4b0dd2['location'],'value':_0xe4384};_0x165289[_0x212e43(0x14a)][_0x212e43(0x120)](_0x2b0782);if(_0x165289[_0x212e43(0x14a)][_0x212e43(0x16f)]>HISTORY_MAX_SIZE)_0x165289[_0x212e43(0x14a)][_0x212e43(0x169)]();await _0x165289[_0x212e43(0x178)]('events.lastEvent',{'val':JSON[_0x212e43(0x12d)](_0x2b0782),'ack':!![]}),await _0x165289[_0x212e43(0x178)](_0x212e43(0x11a),{'val':JSON[_0x212e43(0x12d)](_0x165289[_0x212e43(0x14a)]),'ack':!![]});if(_0x165289['isProVersion']){_0x165289[_0x212e43(0x123)][_0x212e43(0x15c)](_0x2b0782);if(_0x165289[_0x212e43(0x123)][_0x212e43(0x16f)]>RAW_LOG_MAX_SIZE)_0x165289['rawEventLog'][_0x212e43(0x13f)](0x0,_0x165289['rawEventLog'][_0x212e43(0x16f)]-RAW_LOG_MAX_SIZE);await _0x165289[_0x212e43(0x178)](_0x212e43(0x170),{'val':JSON[_0x212e43(0x12d)](_0x165289[_0x212e43(0x123)]),'ack':!![]}),recordSequence(_0x165289,_0x2b0782);}if(_0x4b0dd2[_0x212e43(0x17e)]&&_0xe4384===!![]){if(_0x165289[_0x212e43(0x167)]&&!_0x165289[_0x212e43(0x12a)])startExitTimer(_0x165289);else{if(!_0x165289[_0x212e43(0x167)])setPresence(_0x165289,!![]);}}else{if(_0x4b0dd2['type']===_0x212e43(0x134)&&_0xe4384===!![]){if(_0x165289['exitTimer'])abortExitTimer(_0x165289);if(!_0x165289['isPresent']&&_0x165289[_0x212e43(0x16b)]==='normal')setPresence(_0x165289,!![]);}}if(_0x165289[_0x212e43(0x154)]&&_0x165289[_0x212e43(0x153)]){_0x4b0dd2['type']===_0x212e43(0x134)&&_0xe4384===!![]&&_0x4b0dd2[_0x212e43(0x157)]&&_0x165289[_0x212e43(0x153)]('SIMULATE_SIGNAL',{'room':_0x4b0dd2['location']});const _0x5099c0=['door','t체r',_0x212e43(0x15b),_0x212e43(0x176),'griff',_0x212e43(0x152),_0x212e43(0x14e),_0x212e43(0x12f)][_0x212e43(0x12b)](_0xbb42cc=>_0x3f3be4[_0x212e43(0x145)](_0xbb42cc)),_0x2a1d31=[_0x212e43(0x185),_0x212e43(0x143),'switch',_0x212e43(0x12c),_0x212e43(0x173),_0x212e43(0x17d)][_0x212e43(0x12b)](_0x288a78=>_0x3f3be4[_0x212e43(0x145)](_0x288a78)),_0x550b98=['motion',_0x212e43(0x17b),_0x212e43(0x187),_0x212e43(0x16c),_0x212e43(0x144)][_0x212e43(0x12b)](_0x406118=>_0x3f3be4[_0x212e43(0x145)](_0x406118));if(_0x4b0dd2[_0x212e43(0x157)]&&(_0x5099c0||_0x2a1d31||_0x550b98)){const _0x508e0b=_0xe4384===!![]||typeof _0xe4384===_0x212e43(0x131)&&_0xe4384>0x0,_0x26827f=_0x5099c0&&!_0x508e0b&&_0x43166f!==undefined&&_0x43166f!=_0xe4384;if(_0x508e0b||_0x26827f){const _0x266e1e=_0x165289[_0x212e43(0x133)]||_0x51189c,_0x3f2eea=(_0x51189c-_0x266e1e)/0x3e8;_0x165289[_0x212e43(0x133)]=_0x51189c,_0x165289[_0x212e43(0x153)](_0x212e43(0x182),{'room':_0x4b0dd2[_0x212e43(0x157)],'dt':_0x3f2eea});}}}return _0x2b0782;}module[a5_0x19bc34(0x125)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};function a5_0x4512(){const _0x3d3cfe=['temperatur','sensorLastValues','isGracePeriodActive','some','schalter','stringify','shift','schloss','2290bRphMO','number','value','lastTrackerEventTime','motion','map','LTM.trainingData.thermodynamics','.NextHours.Location_1.Day_1.current.temp_value','6608776DKVrjN','6724BMYlXH','Unknown','exitTimer','outdoorSensorId','28744837HCmQCe','valveMapping','splice','weatherunderground','9YMoPHz','[RECORDER]\x20Ignored\x20implausible\x20temperature\x20value:\x20','licht','occupancy','includes','useWeather','config','round','getStateAsync','eventHistory','constructor','.LEVEL','now','lock','search','apply','thermostat','handle','sendToPythonWrapper','isProVersion','3382638uMSfqQ','STATUS','location','loc','accuweather','Valve','window','push','10PYQlsu','parse','log','(((.+)+)+)+$','string','logDuplicates','[RECORDER]\x20Error:\x20','val','.forecast.current.temperature','.1.LEVEL','isPresent','level','pop','.1.VALVE_STATE','currentSystemMode','presence','.1.TEMPERATURE','getForeignStateAsync','length','LTM.rawEventLog','switch','.1.ACTUAL_TEMPERATURE','dimmer','system.isPresent','1418908OedivB','fenster','temperature','setStateAsync','1188BBtZxK','type','bewegung','kontakt','lampe','isExit','.4.VALVE_STATE','.ACTUAL_TEMPERATURE','t체r','TRACK_EVENT','toLowerCase','.Current.Temperature','light','contact','pr채senz','LTM.trainingData.sequences','events.history','902581mNrKvI','.forecast.current.temp','openweathermap','toString','from','unshift','daswetter','exitGraceTimer','rawEventLog','klima','exports','38920fxQAkv','name'];a5_0x4512=function(){return _0x3d3cfe;};return a5_0x4512();}