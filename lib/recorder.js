const a5_0x41e9a3=a5_0x556e;(function(_0x166e4b,_0x199a73){const _0x3eae87=a5_0x556e,_0x29c1a9=_0x166e4b();while(!![]){try{const _0x46af39=parseInt(_0x3eae87(0x150))/0x1+-parseInt(_0x3eae87(0x124))/0x2*(parseInt(_0x3eae87(0x113))/0x3)+parseInt(_0x3eae87(0x141))/0x4+-parseInt(_0x3eae87(0x15f))/0x5*(parseInt(_0x3eae87(0x15c))/0x6)+-parseInt(_0x3eae87(0x154))/0x7+parseInt(_0x3eae87(0x126))/0x8*(parseInt(_0x3eae87(0x169))/0x9)+parseInt(_0x3eae87(0x155))/0xa;if(_0x46af39===_0x199a73)break;else _0x29c1a9['push'](_0x29c1a9['shift']());}catch(_0x58fb69){_0x29c1a9['push'](_0x29c1a9['shift']());}}}(a5_0x23ad,0xd5c8b));const a5_0x15a8b5=(function(){let _0x4d42c1=!![];return function(_0x1c2503,_0x4869aa){const _0x24c89f=_0x4d42c1?function(){const _0x5715a9=a5_0x556e;if(_0x4869aa){const _0x31dfb5=_0x4869aa[_0x5715a9(0x130)](_0x1c2503,arguments);return _0x4869aa=null,_0x31dfb5;}}:function(){};return _0x4d42c1=![],_0x24c89f;};}()),a5_0x180870=a5_0x15a8b5(this,function(){const _0x926f1=a5_0x556e;return a5_0x180870[_0x926f1(0x118)]()[_0x926f1(0x10f)](_0x926f1(0xfb))[_0x926f1(0x118)]()[_0x926f1(0x10a)](a5_0x180870)[_0x926f1(0x10f)]('(((.+)+)+)+$');});a5_0x180870();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;function a5_0x556e(_0x2c1f87,_0x5b03af){const _0x4c27e5=a5_0x23ad();return a5_0x556e=function(_0x180870,_0x15a8b5){_0x180870=_0x180870-0xf6;let _0x23ad6c=_0x4c27e5[_0x180870];return _0x23ad6c;},a5_0x556e(_0x2c1f87,_0x5b03af);}async function getOutsideTemperatureNumeric(_0x3a49a9){const _0x2c5e2d=a5_0x556e;if(_0x3a49a9[_0x2c5e2d(0x104)][_0x2c5e2d(0x161)])try{const _0x3a836d=await _0x3a49a9[_0x2c5e2d(0x165)](_0x3a49a9['config'][_0x2c5e2d(0x161)]);if(_0x3a836d&&_0x3a836d[_0x2c5e2d(0xfa)]!==undefined&&_0x3a836d[_0x2c5e2d(0xfa)]!==null)return parseFloat(_0x3a836d['val']);}catch(_0x15584b){}const _0x95cece=_0x3a49a9[_0x2c5e2d(0x104)][_0x2c5e2d(0x143)];if(!_0x3a49a9[_0x2c5e2d(0x104)][_0x2c5e2d(0x108)]||!_0x95cece)return null;try{let _0x409472='';if(_0x95cece['includes'](_0x2c5e2d(0x102)))_0x409472=_0x95cece+_0x2c5e2d(0x13d);else{if(_0x95cece[_0x2c5e2d(0x10c)](_0x2c5e2d(0x11a)))_0x409472=_0x95cece+_0x2c5e2d(0x109);else{if(_0x95cece['includes'](_0x2c5e2d(0x162)))_0x409472=_0x95cece+_0x2c5e2d(0x152);else{if(_0x95cece[_0x2c5e2d(0x10c)]('weatherunderground'))_0x409472=_0x95cece+_0x2c5e2d(0x13a);}}}if(_0x409472){const _0x289322=await _0x3a49a9['getForeignStateAsync'](_0x409472);if(_0x289322&&_0x289322[_0x2c5e2d(0xfa)]!==undefined&&_0x289322[_0x2c5e2d(0xfa)]!==null)return parseFloat(_0x289322['val']);}}catch(_0x3ba744){}return null;}async function recordThermodynamics(_0x1b5843,_0x4072e0,_0x44d8f7,_0x3fa56b){const _0x521b15=a5_0x556e,_0x35736c=await getOutsideTemperatureNumeric(_0x1b5843);if(_0x35736c===null)return;let _0xf65c18=0x0,_0x5c0e71=![];if(_0x1b5843[_0x521b15(0x104)][_0x521b15(0x128)])try{let _0x579a85=_0x1b5843['config']['valveMapping'];if(typeof _0x579a85===_0x521b15(0x12c))_0x579a85=JSON['parse'](_0x579a85);if(_0x579a85[_0x4072e0]){const _0x572613=_0x579a85[_0x4072e0],_0x4a26c7=await _0x1b5843[_0x521b15(0x165)](_0x572613);if(_0x4a26c7&&_0x4a26c7[_0x521b15(0xfa)]!==null&&_0x4a26c7['val']!==undefined){let _0x367c0b=Number(_0x4a26c7['val']);if(_0x367c0b<=1.05&&!_0x572613['includes']('STATUS')&&!_0x572613['includes']('STATE'))_0x367c0b=_0x367c0b*0x64;_0xf65c18=Math[_0x521b15(0x121)](_0x367c0b),_0x5c0e71=!![];}}}catch(_0x1d4d80){}if(!_0x5c0e71){const _0x20f300=[{'from':_0x521b15(0x13e),'to':'.1.LEVEL'},{'from':_0x521b15(0x13e),'to':_0x521b15(0x148)},{'from':_0x521b15(0x158),'to':_0x521b15(0x14c)},{'from':_0x521b15(0x168),'to':_0x521b15(0x139)},{'from':'temperature','to':_0x521b15(0x157)},{'from':'Temperature','to':_0x521b15(0xfc)}];for(const _0xe00615 of _0x20f300){if(_0x4072e0[_0x521b15(0x10c)](_0xe00615['from'])){const _0x2369b1=_0x4072e0[_0x521b15(0x12a)](_0xe00615['from'],_0xe00615['to']);try{const _0x43492c=await _0x1b5843[_0x521b15(0x165)](_0x2369b1);if(_0x43492c&&_0x43492c['val']!==null&&_0x43492c[_0x521b15(0xfa)]!==undefined){let _0x9a7f26=Number(_0x43492c['val']);if(typeof _0x9a7f26===_0x521b15(0x144)){if(_0x9a7f26<=1.05&&_0xe00615['to'][_0x521b15(0x10c)](_0x521b15(0x11e)))_0x9a7f26=_0x9a7f26*0x64;_0xf65c18=Math[_0x521b15(0x121)](_0x9a7f26),_0x5c0e71=!![];break;}}}catch(_0x4b8cee){}}}}const _0x2a49ea=await _0x1b5843['getStateAsync'](_0x521b15(0x116));let _0x3de507=[];if(_0x2a49ea&&_0x2a49ea[_0x521b15(0xfa)])try{_0x3de507=JSON['parse'](_0x2a49ea[_0x521b15(0xfa)]);}catch(_0x1988e8){}_0x3de507['push']({'ts':Date[_0x521b15(0x11b)](),'room':_0x3fa56b||_0x521b15(0x12d),'t_in':_0x44d8f7,'t_out':_0x35736c,'valve':_0xf65c18});if(_0x3de507[_0x521b15(0x131)]>THERMO_LOG_SIZE)_0x3de507[_0x521b15(0x11c)]();await _0x1b5843['setStateAsync'](_0x521b15(0x116),{'val':JSON['stringify'](_0x3de507),'ack':!![]});}function a5_0x23ad(){const _0x3c2c69=['isPresent','eventHistory','some','val','(((.+)+)+)+$','Valve','sendToPythonWrapper','lock','normal','push','splice','accuweather','exports','config','griff','door','loc','useWeather','.NextHours.Location_1.Day_1.current.temp_value','constructor','pop','includes','bewegung','window','search','isProVersion','getDate','fill','3659151pydmqF','heizung','light','LTM.trainingData.thermodynamics','lastTrackerEventTime','toString','system.isPresent','daswetter','now','shift','lampe','LEVEL','[RECORDER]\x20Error:\x20','getHours','round','stringify','occupancy','2oZSPBZ','pr채senz','571016SrcxpR','temperature','valveMapping','thermostat','replace','events.lastEvent','string','Unknown','type','motion','apply','length','TRACK_EVENT','isGracePeriodActive','name','LTM.trainingData.sequences','logDuplicates','schalter','location','.LEVEL','.forecast.current.temp','events.history','error','.Current.Temperature','.1.ACTUAL_TEMPERATURE','setStateAsync','schloss','3605836TDZBkV','t체r','weatherInstance','number','temperatur','LTM.rawEventLog','debug','.1.VALVE_STATE','switch','dimmer','rawEventLog','.4.VALVE_STATE','licht','klima','exitGraceTimer','965186LxLLiP','fenster','.forecast.current.temperature','unshift','10501050nuMthY','11678140KvqdCM','ANALYZE_SEQUENCE','level','.1.TEMPERATURE','map','toLowerCase','contact','2538uZEHaQ','handle','getStateAsync','1805ZNOzMf','presence','outdoorSensorId','openweathermap','log','exitTimer','getForeignStateAsync','parse','sensorLastValues','.ACTUAL_TEMPERATURE','90WdZABe','analysis.health.todayVector'];a5_0x23ad=function(){return _0x3c2c69;};return a5_0x23ad();}async function saveCompletedSequence(_0x381168){const _0x109d03=a5_0x556e;try{const _0x3e5dd9=await _0x381168[_0x109d03(0x15e)](_0x109d03(0x135));let _0x4e8cf1=[];if(_0x3e5dd9&&_0x3e5dd9['val'])try{_0x4e8cf1=JSON[_0x109d03(0x166)](_0x3e5dd9['val']);}catch(_0x5ba490){}const _0x5a606c=activeSequence[0x0]['ts'],_0x38ef2a=activeSequence[_0x109d03(0x159)](_0x5b2c36=>({'loc':_0x5b2c36[_0x109d03(0x107)],'t_delta':Math[_0x109d03(0x121)]((_0x5b2c36['ts']-_0x5a606c)/0x3e8)})),_0x23638a={'timestamp':new Date(_0x5a606c)['toISOString'](),'steps':_0x38ef2a,'duration':Math[_0x109d03(0x121)]((activeSequence[activeSequence[_0x109d03(0x131)]-0x1]['ts']-_0x5a606c)/0x3e8),'daytime':new Date(_0x5a606c)[_0x109d03(0x120)]()};_0x4e8cf1[_0x109d03(0x100)](_0x23638a);if(_0x4e8cf1[_0x109d03(0x131)]>MAX_TRAINING_SET_SIZE)_0x4e8cf1[_0x109d03(0x11c)]();await _0x381168[_0x109d03(0x13f)](_0x109d03(0x135),{'val':JSON[_0x109d03(0x122)](_0x4e8cf1),'ack':!![]}),_0x381168[_0x109d03(0x110)]&&_0x381168[_0x109d03(0xfd)]&&_0x381168[_0x109d03(0xfd)](_0x109d03(0x156),{'sequence':_0x23638a});}catch(_0x4288ee){_0x381168[_0x109d03(0x163)][_0x109d03(0x13c)](_0x109d03(0x11f)+_0x4288ee['message']);}}async function recordSequence(_0x4b0117,_0x1bbdc1){const _0x4cf3a4=a5_0x556e,_0x9e004d=(_0x1bbdc1[_0x4cf3a4(0x12e)]||'')[_0x4cf3a4(0x15a)](),_0x3b8c16=[_0x4cf3a4(0x12f),_0x4cf3a4(0x10d),_0x4cf3a4(0x125),_0x4cf3a4(0x160),'occupancy',_0x4cf3a4(0x106),_0x4cf3a4(0x142),_0x4cf3a4(0x10e),'fenster',_0x4cf3a4(0x15b),'kontakt','light',_0x4cf3a4(0x14d),_0x4cf3a4(0x149),'schalter',_0x4cf3a4(0x14a),_0x4cf3a4(0x11d)];if(!_0x3b8c16[_0x4cf3a4(0xf9)](_0x1acdea=>_0x9e004d[_0x4cf3a4(0x10c)](_0x1acdea)))return;if(!_0x1bbdc1['value'])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x4cf3a4(0x100)]({'loc':_0x1bbdc1['location']||_0x4cf3a4(0x12d),'id':_0x1bbdc1['id'],'ts':Date[_0x4cf3a4(0x11b)]()}),sequenceTimer=setTimeout(async()=>{const _0x35d5ff=_0x4cf3a4;if(activeSequence[_0x35d5ff(0x131)]>0x1)await saveCompletedSequence(_0x4b0117);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0x39a62a){const _0x5e8642=a5_0x556e;abortExitTimer(_0x39a62a),_0x39a62a['isGracePeriodActive']=!![],_0x39a62a[_0x5e8642(0x14f)]=setTimeout(()=>{const _0x471aec=_0x5e8642;_0x39a62a[_0x471aec(0x133)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x39a62a['exitTimer']=setTimeout(()=>{const _0x205a69=_0x5e8642;setPresence(_0x39a62a,![]),_0x39a62a[_0x205a69(0x164)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x1b7477){const _0xbf5afc=a5_0x556e;if(_0x1b7477['exitTimer'])clearTimeout(_0x1b7477['exitTimer']);if(_0x1b7477[_0xbf5afc(0x14f)])clearTimeout(_0x1b7477[_0xbf5afc(0x14f)]);_0x1b7477[_0xbf5afc(0x164)]=null,_0x1b7477['exitGraceTimer']=null,_0x1b7477[_0xbf5afc(0x133)]=![];}async function setPresence(_0x141ce8,_0x15fc3d){const _0x2172e8=a5_0x556e;if(_0x141ce8[_0x2172e8(0xf7)]===_0x15fc3d)return;_0x141ce8[_0x2172e8(0xf7)]=_0x15fc3d,await _0x141ce8['setStateAsync'](_0x2172e8(0x119),{'val':_0x15fc3d,'ack':!![]});}async function updateHourlyActivity(_0x356dde){const _0x79dbdf=a5_0x556e;let _0x8c6525=new Array(0x18)[_0x79dbdf(0x112)](0x0),_0x561cea=0x0;try{const _0x10e5db=await _0x356dde[_0x79dbdf(0x15e)](_0x79dbdf(0xf6));_0x10e5db&&_0x10e5db[_0x79dbdf(0xfa)]&&(_0x8c6525=JSON[_0x79dbdf(0x166)](_0x10e5db[_0x79dbdf(0xfa)]),_0x561cea=_0x10e5db['ts']);}catch(_0x35b4b1){}const _0x310124=new Date(_0x561cea),_0x288e6b=new Date();_0x310124[_0x79dbdf(0x111)]()!==_0x288e6b[_0x79dbdf(0x111)]()&&(_0x8c6525=new Array(0x18)[_0x79dbdf(0x112)](0x0));const _0x511eb6=_0x288e6b[_0x79dbdf(0x120)]();if(_0x8c6525[_0x511eb6]===undefined)_0x8c6525[_0x511eb6]=0x0;_0x8c6525[_0x511eb6]++,await _0x356dde['setStateAsync'](_0x79dbdf(0xf6),{'val':JSON[_0x79dbdf(0x122)](_0x8c6525),'ack':!![]});}async function processSensorEvent(_0x172b71,_0x554035,_0x1a42b5,_0x48a497){const _0x676cf7=a5_0x556e;if(!_0x48a497)return null;const _0x36764d=_0x1a42b5['val'],_0x49c866=Date['now'](),_0x3d940b=_0x172b71['sensorLastValues'][_0x554035],_0xddac0e=(_0x48a497[_0x676cf7(0x12e)]||'')[_0x676cf7(0x15a)](),_0x14c636=_0xddac0e[_0x676cf7(0x10c)](_0x676cf7(0x127))||_0xddac0e[_0x676cf7(0x10c)](_0x676cf7(0x145))||_0xddac0e[_0x676cf7(0x10c)](_0x676cf7(0x14e))||_0xddac0e[_0x676cf7(0x10c)](_0x676cf7(0x114))||_0xddac0e[_0x676cf7(0x10c)](_0x676cf7(0x129));if(_0x14c636&&typeof _0x36764d===_0x676cf7(0x144)){if(_0x36764d>0x50||_0x36764d<-0x32)return _0x172b71[_0x676cf7(0x163)][_0x676cf7(0x147)]('[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20'+_0x36764d+'\x20from\x20'+_0x554035),null;}_0x172b71[_0x676cf7(0x167)][_0x554035]=_0x36764d;if(!_0x48a497[_0x676cf7(0x136)]&&_0x3d940b!=undefined&&_0x3d940b==_0x36764d)return null;_0x172b71[_0x676cf7(0x110)]&&_0x14c636&&recordThermodynamics(_0x172b71,_0x554035,_0x36764d,_0x48a497[_0x676cf7(0x138)]);const _0x3f2db4={'timestamp':_0x49c866,'id':_0x554035,'name':_0x48a497[_0x676cf7(0x134)],'type':_0x48a497[_0x676cf7(0x12e)],'location':_0x48a497[_0x676cf7(0x138)],'value':_0x36764d};_0x172b71[_0x676cf7(0xf8)][_0x676cf7(0x153)](_0x3f2db4);if(_0x172b71[_0x676cf7(0xf8)][_0x676cf7(0x131)]>HISTORY_MAX_SIZE)_0x172b71[_0x676cf7(0xf8)][_0x676cf7(0x10b)]();await _0x172b71[_0x676cf7(0x13f)](_0x676cf7(0x12b),{'val':JSON[_0x676cf7(0x122)](_0x3f2db4),'ack':!![]}),await _0x172b71['setStateAsync'](_0x676cf7(0x13b),{'val':JSON['stringify'](_0x172b71[_0x676cf7(0xf8)]),'ack':!![]}),await updateHourlyActivity(_0x172b71);if(_0x172b71[_0x676cf7(0x110)]){_0x172b71[_0x676cf7(0x14b)][_0x676cf7(0x100)](_0x3f2db4);if(_0x172b71[_0x676cf7(0x14b)]['length']>RAW_LOG_MAX_SIZE)_0x172b71[_0x676cf7(0x14b)][_0x676cf7(0x101)](0x0,_0x172b71[_0x676cf7(0x14b)][_0x676cf7(0x131)]-RAW_LOG_MAX_SIZE);await _0x172b71[_0x676cf7(0x13f)](_0x676cf7(0x146),{'val':JSON['stringify'](_0x172b71[_0x676cf7(0x14b)]),'ack':!![]}),recordSequence(_0x172b71,_0x3f2db4);}if(_0x48a497['isExit']&&_0x36764d===!![]){if(_0x172b71[_0x676cf7(0xf7)]&&!_0x172b71[_0x676cf7(0x133)])startExitTimer(_0x172b71);else{if(!_0x172b71['isPresent'])setPresence(_0x172b71,!![]);}}else{if(_0x48a497['type']==='motion'&&_0x36764d===!![]){if(_0x172b71[_0x676cf7(0x164)])abortExitTimer(_0x172b71);if(!_0x172b71[_0x676cf7(0xf7)]&&_0x172b71['currentSystemMode']===_0x676cf7(0xff))setPresence(_0x172b71,!![]);}}if(_0x172b71[_0x676cf7(0x110)]&&_0x172b71['sendToPythonWrapper']){_0x48a497['type']===_0x676cf7(0x12f)&&_0x36764d===!![]&&_0x48a497['location']&&_0x172b71[_0x676cf7(0xfd)]('SIMULATE_SIGNAL',{'room':_0x48a497['location']});const _0xbeefff=[_0x676cf7(0x106),'t체r',_0x676cf7(0x10e),_0x676cf7(0x151),_0x676cf7(0x105),_0x676cf7(0x15d),_0x676cf7(0xfe),_0x676cf7(0x140)][_0x676cf7(0xf9)](_0x2db50c=>_0xddac0e[_0x676cf7(0x10c)](_0x2db50c)),_0x20490b=[_0x676cf7(0x115),_0x676cf7(0x14d),_0x676cf7(0x149),_0x676cf7(0x137),_0x676cf7(0x14a),'lampe'][_0x676cf7(0xf9)](_0x48d7d3=>_0xddac0e['includes'](_0x48d7d3)),_0x892886=[_0x676cf7(0x12f),_0x676cf7(0x10d),'pr채senz',_0x676cf7(0x160),_0x676cf7(0x123)][_0x676cf7(0xf9)](_0x16f350=>_0xddac0e[_0x676cf7(0x10c)](_0x16f350));if(_0x48a497[_0x676cf7(0x138)]&&(_0xbeefff||_0x20490b||_0x892886)){const _0x1a84e4=_0x36764d===!![]||typeof _0x36764d===_0x676cf7(0x144)&&_0x36764d>0x0,_0x560bdb=_0xbeefff&&!_0x1a84e4&&_0x3d940b!==undefined&&_0x3d940b!=_0x36764d;if(_0x1a84e4||_0x560bdb){const _0x308482=_0x172b71['lastTrackerEventTime']||_0x49c866,_0xa6a56e=(_0x49c866-_0x308482)/0x3e8;_0x172b71[_0x676cf7(0x117)]=_0x49c866,_0x172b71[_0x676cf7(0xfd)](_0x676cf7(0x132),{'room':_0x48a497[_0x676cf7(0x138)],'dt':_0xa6a56e});}}}return _0x3f2db4;}module[a5_0x41e9a3(0x103)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};