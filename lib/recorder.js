const a5_0x44d948=a5_0x44d2;(function(_0x157f36,_0x2fab13){const _0x206546=a5_0x44d2,_0x54b095=_0x157f36();while(!![]){try{const _0x469018=parseInt(_0x206546(0x1e7))/0x1*(parseInt(_0x206546(0x1c0))/0x2)+parseInt(_0x206546(0x19d))/0x3*(-parseInt(_0x206546(0x18c))/0x4)+-parseInt(_0x206546(0x1be))/0x5*(parseInt(_0x206546(0x1cc))/0x6)+parseInt(_0x206546(0x1ea))/0x7*(parseInt(_0x206546(0x1ca))/0x8)+parseInt(_0x206546(0x1b1))/0x9*(-parseInt(_0x206546(0x1a3))/0xa)+-parseInt(_0x206546(0x1a5))/0xb+-parseInt(_0x206546(0x197))/0xc*(-parseInt(_0x206546(0x1ba))/0xd);if(_0x469018===_0x2fab13)break;else _0x54b095['push'](_0x54b095['shift']());}catch(_0x10aa62){_0x54b095['push'](_0x54b095['shift']());}}}(a5_0x3ee7,0x39a28));const a5_0x4dc66f=(function(){let _0x516d44=!![];return function(_0x963e1b,_0x36e396){const _0x51927b=_0x516d44?function(){const _0x247f67=a5_0x44d2;if(_0x36e396){const _0x89f511=_0x36e396[_0x247f67(0x1dc)](_0x963e1b,arguments);return _0x36e396=null,_0x89f511;}}:function(){};return _0x516d44=![],_0x51927b;};}()),a5_0x2987a9=a5_0x4dc66f(this,function(){const _0x424012=a5_0x44d2;return a5_0x2987a9[_0x424012(0x1c3)]()['search'](_0x424012(0x1a6))['toString']()[_0x424012(0x1cf)](a5_0x2987a9)[_0x424012(0x1bd)](_0x424012(0x1a6));});a5_0x2987a9();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x386226){const _0x5c8f3c=a5_0x44d2;if(_0x386226[_0x5c8f3c(0x1b6)][_0x5c8f3c(0x1b5)])try{const _0x29993f=await _0x386226['getForeignStateAsync'](_0x386226[_0x5c8f3c(0x1b6)][_0x5c8f3c(0x1b5)]);if(_0x29993f&&_0x29993f[_0x5c8f3c(0x1f0)]!==undefined&&_0x29993f[_0x5c8f3c(0x1f0)]!==null)return parseFloat(_0x29993f[_0x5c8f3c(0x1f0)]);}catch(_0x1369c2){}const _0x357d12=_0x386226[_0x5c8f3c(0x1b6)]['weatherInstance'];if(!_0x386226[_0x5c8f3c(0x1b6)][_0x5c8f3c(0x188)]||!_0x357d12)return null;try{let _0x427312='';if(_0x357d12[_0x5c8f3c(0x1af)]('accuweather'))_0x427312=_0x357d12+_0x5c8f3c(0x1ae);else{if(_0x357d12[_0x5c8f3c(0x1af)](_0x5c8f3c(0x1e1)))_0x427312=_0x357d12+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x357d12[_0x5c8f3c(0x1af)]('openweathermap'))_0x427312=_0x357d12+_0x5c8f3c(0x1ce);else{if(_0x357d12[_0x5c8f3c(0x1af)](_0x5c8f3c(0x1a8)))_0x427312=_0x357d12+_0x5c8f3c(0x1eb);}}}if(_0x427312){const _0x1bfd06=await _0x386226[_0x5c8f3c(0x1f7)](_0x427312);if(_0x1bfd06&&_0x1bfd06[_0x5c8f3c(0x1f0)]!==undefined&&_0x1bfd06[_0x5c8f3c(0x1f0)]!==null)return parseFloat(_0x1bfd06['val']);}}catch(_0x33c7f9){}return null;}function a5_0x44d2(_0x461bac,_0x250878){const _0x31f9d4=a5_0x3ee7();return a5_0x44d2=function(_0x2987a9,_0x4dc66f){_0x2987a9=_0x2987a9-0x186;let _0x3ee787=_0x31f9d4[_0x2987a9];return _0x3ee787;},a5_0x44d2(_0x461bac,_0x250878);}async function recordThermodynamics(_0x39f4df,_0x1cb11c,_0x2ae7b0,_0x25c86a){const _0x16d0d5=a5_0x44d2,_0x2a117f=await getOutsideTemperatureNumeric(_0x39f4df);if(_0x2a117f===null)return;let _0x3e6700=0x0,_0x24c35c=![];if(_0x39f4df[_0x16d0d5(0x1b6)][_0x16d0d5(0x18f)])try{let _0x5d8216=_0x39f4df[_0x16d0d5(0x1b6)][_0x16d0d5(0x18f)];if(typeof _0x5d8216===_0x16d0d5(0x1c6))_0x5d8216=JSON['parse'](_0x5d8216);if(_0x5d8216[_0x1cb11c]){const _0xa37d2f=_0x5d8216[_0x1cb11c],_0x32c13b=await _0x39f4df[_0x16d0d5(0x1f7)](_0xa37d2f);if(_0x32c13b&&_0x32c13b[_0x16d0d5(0x1f0)]!==null&&_0x32c13b[_0x16d0d5(0x1f0)]!==undefined){let _0x1e9cc3=Number(_0x32c13b[_0x16d0d5(0x1f0)]);if(_0x1e9cc3<=1.05&&!_0xa37d2f[_0x16d0d5(0x1af)](_0x16d0d5(0x196))&&!_0xa37d2f['includes'](_0x16d0d5(0x1c8)))_0x1e9cc3=_0x1e9cc3*0x64;_0x3e6700=Math[_0x16d0d5(0x1a7)](_0x1e9cc3),_0x24c35c=!![];}}}catch(_0x58b309){}if(!_0x24c35c){const _0x42ce0f=[{'from':_0x16d0d5(0x1e0),'to':_0x16d0d5(0x1f1)},{'from':'.1.ACTUAL_TEMPERATURE','to':_0x16d0d5(0x193)},{'from':_0x16d0d5(0x187),'to':_0x16d0d5(0x19b)},{'from':_0x16d0d5(0x1a1),'to':_0x16d0d5(0x1ac)},{'from':_0x16d0d5(0x1f5),'to':'level'},{'from':_0x16d0d5(0x1e8),'to':'Valve'}];for(const _0xb81292 of _0x42ce0f){if(_0x1cb11c['includes'](_0xb81292[_0x16d0d5(0x190)])){const _0x1dec00=_0x1cb11c[_0x16d0d5(0x1d8)](_0xb81292['from'],_0xb81292['to']);try{const _0x260a7c=await _0x39f4df['getForeignStateAsync'](_0x1dec00);if(_0x260a7c&&_0x260a7c[_0x16d0d5(0x1f0)]!==null&&_0x260a7c[_0x16d0d5(0x1f0)]!==undefined){let _0xd3f20b=Number(_0x260a7c['val']);if(typeof _0xd3f20b===_0x16d0d5(0x1bc)){if(_0xd3f20b<=1.05&&_0xb81292['to']['includes']('LEVEL'))_0xd3f20b=_0xd3f20b*0x64;_0x3e6700=Math['round'](_0xd3f20b),_0x24c35c=!![];break;}}}catch(_0x2e738b){}}}}const _0x4a4b56=await _0x39f4df['getStateAsync'](_0x16d0d5(0x1ad));let _0x2b171a=[];if(_0x4a4b56&&_0x4a4b56[_0x16d0d5(0x1f0)])try{_0x2b171a=JSON['parse'](_0x4a4b56['val']);}catch(_0x1f6e01){}_0x2b171a[_0x16d0d5(0x1ef)]({'ts':Date[_0x16d0d5(0x186)](),'room':_0x25c86a||_0x16d0d5(0x1e4),'t_in':_0x2ae7b0,'t_out':_0x2a117f,'valve':_0x3e6700});if(_0x2b171a[_0x16d0d5(0x19a)]>THERMO_LOG_SIZE)_0x2b171a['shift']();await _0x39f4df[_0x16d0d5(0x1db)](_0x16d0d5(0x1ad),{'val':JSON['stringify'](_0x2b171a),'ack':!![]});}async function saveCompletedSequence(_0x2cae9f){const _0x15be2b=a5_0x44d2;try{const _0x12ea99=await _0x2cae9f[_0x15be2b(0x19f)](_0x15be2b(0x1c7));let _0x31d14d=[];if(_0x12ea99&&_0x12ea99['val'])try{_0x31d14d=JSON[_0x15be2b(0x1bf)](_0x12ea99['val']);}catch(_0x168df7){}const _0x208f57=activeSequence[0x0]['ts'],_0x4b4396=activeSequence[_0x15be2b(0x1c9)](_0x64f8=>({'loc':_0x64f8[_0x15be2b(0x1c4)],'t_delta':Math['round']((_0x64f8['ts']-_0x208f57)/0x3e8)})),_0x533e6c={'timestamp':new Date(_0x208f57)[_0x15be2b(0x18b)](),'steps':_0x4b4396,'duration':Math[_0x15be2b(0x1a7)]((activeSequence[activeSequence[_0x15be2b(0x19a)]-0x1]['ts']-_0x208f57)/0x3e8),'daytime':new Date(_0x208f57)[_0x15be2b(0x1d6)]()};_0x31d14d[_0x15be2b(0x1ef)](_0x533e6c);if(_0x31d14d[_0x15be2b(0x19a)]>MAX_TRAINING_SET_SIZE)_0x31d14d[_0x15be2b(0x1b8)]();await _0x2cae9f['setStateAsync'](_0x15be2b(0x1c7),{'val':JSON['stringify'](_0x31d14d),'ack':!![]}),_0x2cae9f[_0x15be2b(0x1f8)]&&_0x2cae9f[_0x15be2b(0x1c1)]&&_0x2cae9f['sendToPythonWrapper'](_0x15be2b(0x1fa),{'sequence':_0x533e6c});}catch(_0x3f91a6){_0x2cae9f[_0x15be2b(0x1c2)][_0x15be2b(0x1b7)](_0x15be2b(0x1c5)+_0x3f91a6[_0x15be2b(0x1e2)]);}}function a5_0x3ee7(){const _0x1bda7e=['tür','4068tGCfzv','thermostat','switch','\x20from\x20','outdoorSensorId','config','error','shift','LTM.rawEventLog','13jBgTnb','light','number','search','10YYOzSZ','parse','2ivjAqy','sendToPythonWrapper','log','toString','loc','[RECORDER]\x20Error:\x20','string','LTM.trainingData.sequences','STATE','map','80dmnBYn','system.isPresent','225102WJHePe','debug','.forecast.current.temperature','constructor','presence','rawEventLog','lock','events.lastEvent','sensorLastValues','toLowerCase','getHours','lampe','replace','location','SIMULATE_SIGNAL','setStateAsync','apply','value','name','kontakt','.1.ACTUAL_TEMPERATURE','daswetter','message','lastTrackerEventTime','Unknown','exports','normal','57767PSjSLH','Temperature','dimmer','151116MoldIu','.forecast.current.temp','schalter','currentSystemMode','handle','push','val','.1.LEVEL','[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20','klima','TRACK_EVENT','temperature','motion','getForeignStateAsync','isProVersion','heizung','ANALYZE_SEQUENCE','now','.1.TEMPERATURE','useWeather','isPresent','window','toISOString','314660tpJuJi','eventHistory','präsenz','valveMapping','from','pop','exitTimer','.1.VALVE_STATE','fenster','isExit','STATUS','12968268AWZUtI','stringify','licht','length','.4.VALVE_STATE','temperatur','18fSXOJS','type','getStateAsync','splice','.ACTUAL_TEMPERATURE','isGracePeriodActive','2440NqHWaU','exitGraceTimer','5070472IvXiMG','(((.+)+)+)+$','round','weatherunderground','events.history','bewegung','some','.LEVEL','LTM.trainingData.thermodynamics','.Current.Temperature','includes'];a5_0x3ee7=function(){return _0x1bda7e;};return a5_0x3ee7();}async function recordSequence(_0x1e86b6,_0x2c3dd4){const _0x4aface=a5_0x44d2,_0x291ad9=(_0x2c3dd4[_0x4aface(0x19e)]||'')[_0x4aface(0x1d5)](),_0x4a67ff=[_0x4aface(0x1f6),'bewegung',_0x4aface(0x18e),_0x4aface(0x1d0),'occupancy','door','tür','window',_0x4aface(0x194),'contact',_0x4aface(0x1df),'light',_0x4aface(0x199),_0x4aface(0x1b3),_0x4aface(0x1ec),_0x4aface(0x1e9),_0x4aface(0x1d7)];if(!_0x4a67ff[_0x4aface(0x1ab)](_0x2f0a94=>_0x291ad9['includes'](_0x2f0a94)))return;if(!_0x2c3dd4[_0x4aface(0x1dd)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x4aface(0x1ef)]({'loc':_0x2c3dd4[_0x4aface(0x1d9)]||_0x4aface(0x1e4),'id':_0x2c3dd4['id'],'ts':Date[_0x4aface(0x186)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x1e86b6);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0x302682){const _0x68438e=a5_0x44d2;abortExitTimer(_0x302682),_0x302682[_0x68438e(0x1a2)]=!![],_0x302682[_0x68438e(0x1a4)]=setTimeout(()=>{_0x302682['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x302682[_0x68438e(0x192)]=setTimeout(()=>{const _0x3a314f=_0x68438e;setPresence(_0x302682,![]),_0x302682[_0x3a314f(0x192)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0xc9c194){const _0x5557e2=a5_0x44d2;if(_0xc9c194[_0x5557e2(0x192)])clearTimeout(_0xc9c194[_0x5557e2(0x192)]);if(_0xc9c194[_0x5557e2(0x1a4)])clearTimeout(_0xc9c194[_0x5557e2(0x1a4)]);_0xc9c194['exitTimer']=null,_0xc9c194['exitGraceTimer']=null,_0xc9c194[_0x5557e2(0x1a2)]=![];}async function setPresence(_0x1f7cbf,_0x575102){const _0x54d806=a5_0x44d2;if(_0x1f7cbf[_0x54d806(0x189)]===_0x575102)return;_0x1f7cbf[_0x54d806(0x189)]=_0x575102,await _0x1f7cbf[_0x54d806(0x1db)](_0x54d806(0x1cb),{'val':_0x575102,'ack':!![]});}async function processSensorEvent(_0x4047f4,_0x20bcf2,_0x59913c,_0x31dadc){const _0x76bf04=a5_0x44d2;if(!_0x31dadc)return null;const _0x1b12dd=_0x59913c[_0x76bf04(0x1f0)],_0x6d10dc=Date['now'](),_0x493df=_0x4047f4[_0x76bf04(0x1d4)][_0x20bcf2],_0x2004ec=(_0x31dadc[_0x76bf04(0x19e)]||'')[_0x76bf04(0x1d5)](),_0x5d6dee=_0x2004ec['includes'](_0x76bf04(0x1f5))||_0x2004ec[_0x76bf04(0x1af)](_0x76bf04(0x19c))||_0x2004ec['includes'](_0x76bf04(0x1f3))||_0x2004ec[_0x76bf04(0x1af)](_0x76bf04(0x1f9))||_0x2004ec['includes'](_0x76bf04(0x1b2));if(_0x5d6dee&&typeof _0x1b12dd===_0x76bf04(0x1bc)){if(_0x1b12dd>0x50||_0x1b12dd<-0x32)return _0x4047f4[_0x76bf04(0x1c2)][_0x76bf04(0x1cd)](_0x76bf04(0x1f2)+_0x1b12dd+_0x76bf04(0x1b4)+_0x20bcf2),null;}_0x4047f4[_0x76bf04(0x1d4)][_0x20bcf2]=_0x1b12dd;if(!_0x31dadc['logDuplicates']&&_0x493df!=undefined&&_0x493df==_0x1b12dd)return null;_0x4047f4['isProVersion']&&_0x5d6dee&&recordThermodynamics(_0x4047f4,_0x20bcf2,_0x1b12dd,_0x31dadc[_0x76bf04(0x1d9)]);const _0x333552={'timestamp':_0x6d10dc,'id':_0x20bcf2,'name':_0x31dadc[_0x76bf04(0x1de)],'type':_0x31dadc[_0x76bf04(0x19e)],'location':_0x31dadc[_0x76bf04(0x1d9)],'value':_0x1b12dd};_0x4047f4['eventHistory']['unshift'](_0x333552);if(_0x4047f4['eventHistory'][_0x76bf04(0x19a)]>HISTORY_MAX_SIZE)_0x4047f4[_0x76bf04(0x18d)][_0x76bf04(0x191)]();await _0x4047f4['setStateAsync'](_0x76bf04(0x1d3),{'val':JSON['stringify'](_0x333552),'ack':!![]}),await _0x4047f4[_0x76bf04(0x1db)](_0x76bf04(0x1a9),{'val':JSON['stringify'](_0x4047f4[_0x76bf04(0x18d)]),'ack':!![]});if(_0x4047f4[_0x76bf04(0x1f8)]){_0x4047f4[_0x76bf04(0x1d1)]['push'](_0x333552);if(_0x4047f4[_0x76bf04(0x1d1)][_0x76bf04(0x19a)]>RAW_LOG_MAX_SIZE)_0x4047f4[_0x76bf04(0x1d1)][_0x76bf04(0x1a0)](0x0,_0x4047f4[_0x76bf04(0x1d1)][_0x76bf04(0x19a)]-RAW_LOG_MAX_SIZE);await _0x4047f4[_0x76bf04(0x1db)](_0x76bf04(0x1b9),{'val':JSON[_0x76bf04(0x198)](_0x4047f4[_0x76bf04(0x1d1)]),'ack':!![]}),recordSequence(_0x4047f4,_0x333552);}if(_0x31dadc[_0x76bf04(0x195)]&&_0x1b12dd===!![]){if(_0x4047f4[_0x76bf04(0x189)]&&!_0x4047f4[_0x76bf04(0x1a2)])startExitTimer(_0x4047f4);else{if(!_0x4047f4[_0x76bf04(0x189)])setPresence(_0x4047f4,!![]);}}else{if(_0x31dadc[_0x76bf04(0x19e)]==='motion'&&_0x1b12dd===!![]){if(_0x4047f4['exitTimer'])abortExitTimer(_0x4047f4);if(!_0x4047f4['isPresent']&&_0x4047f4[_0x76bf04(0x1ed)]===_0x76bf04(0x1e6))setPresence(_0x4047f4,!![]);}}if(_0x4047f4[_0x76bf04(0x1f8)]&&_0x4047f4[_0x76bf04(0x1c1)]){_0x31dadc[_0x76bf04(0x19e)]===_0x76bf04(0x1f6)&&_0x1b12dd===!![]&&_0x31dadc[_0x76bf04(0x1d9)]&&_0x4047f4[_0x76bf04(0x1c1)](_0x76bf04(0x1da),{'room':_0x31dadc['location']});const _0x115cdb=['door',_0x76bf04(0x1b0),_0x76bf04(0x18a),_0x76bf04(0x194),'griff',_0x76bf04(0x1ee),_0x76bf04(0x1d2),'schloss']['some'](_0x38e0c0=>_0x2004ec[_0x76bf04(0x1af)](_0x38e0c0)),_0x4c17ea=[_0x76bf04(0x1bb),'licht','switch','schalter',_0x76bf04(0x1e9),_0x76bf04(0x1d7)][_0x76bf04(0x1ab)](_0x176ea0=>_0x2004ec[_0x76bf04(0x1af)](_0x176ea0)),_0x393a29=[_0x76bf04(0x1f6),_0x76bf04(0x1aa),_0x76bf04(0x18e),_0x76bf04(0x1d0),'occupancy'][_0x76bf04(0x1ab)](_0x1af6c7=>_0x2004ec['includes'](_0x1af6c7));if(_0x31dadc[_0x76bf04(0x1d9)]&&(_0x115cdb||_0x4c17ea||_0x393a29)){const _0x4904a8=_0x1b12dd===!![]||typeof _0x1b12dd==='number'&&_0x1b12dd>0x0,_0x2eacdd=_0x115cdb&&!_0x4904a8&&_0x493df!==undefined&&_0x493df!=_0x1b12dd;if(_0x4904a8||_0x2eacdd){const _0x54f853=_0x4047f4[_0x76bf04(0x1e3)]||_0x6d10dc,_0x5a9779=(_0x6d10dc-_0x54f853)/0x3e8;_0x4047f4[_0x76bf04(0x1e3)]=_0x6d10dc,_0x4047f4['sendToPythonWrapper'](_0x76bf04(0x1f4),{'room':_0x31dadc[_0x76bf04(0x1d9)],'dt':_0x5a9779});}}}return _0x333552;}module[a5_0x44d948(0x1e5)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};