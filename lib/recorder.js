(function(_0x27cae9,_0x3482ac){const _0x5e4eb1=a5_0x2dbd,_0x28ea7b=_0x27cae9();while(!![]){try{const _0xdcc38e=parseInt(_0x5e4eb1(0x8f))/0x1*(parseInt(_0x5e4eb1(0xcb))/0x2)+parseInt(_0x5e4eb1(0xcf))/0x3+parseInt(_0x5e4eb1(0xe1))/0x4*(parseInt(_0x5e4eb1(0xed))/0x5)+parseInt(_0x5e4eb1(0x95))/0x6+-parseInt(_0x5e4eb1(0xda))/0x7+parseInt(_0x5e4eb1(0xe7))/0x8+parseInt(_0x5e4eb1(0xc3))/0x9*(-parseInt(_0x5e4eb1(0x89))/0xa);if(_0xdcc38e===_0x3482ac)break;else _0x28ea7b['push'](_0x28ea7b['shift']());}catch(_0xb7ae3c){_0x28ea7b['push'](_0x28ea7b['shift']());}}}(a5_0x4a20,0xea73c));function a5_0x2dbd(_0x83fbd7,_0x568693){const _0x250d17=a5_0x4a20();return a5_0x2dbd=function(_0x1d1f51,_0x3715c4){_0x1d1f51=_0x1d1f51-0x7c;let _0x4a2073=_0x250d17[_0x1d1f51];return _0x4a2073;},a5_0x2dbd(_0x83fbd7,_0x568693);}const a5_0x3715c4=(function(){let _0x56cf2e=!![];return function(_0x5cbcdb,_0x1fb8bf){const _0xf1a7fd=_0x56cf2e?function(){if(_0x1fb8bf){const _0x56fb98=_0x1fb8bf['apply'](_0x5cbcdb,arguments);return _0x1fb8bf=null,_0x56fb98;}}:function(){};return _0x56cf2e=![],_0xf1a7fd;};}()),a5_0x1d1f51=a5_0x3715c4(this,function(){const _0x440238=a5_0x2dbd;return a5_0x1d1f51[_0x440238(0xbd)]()['search']('(((.+)+)+)+$')[_0x440238(0xbd)]()[_0x440238(0xd0)](a5_0x1d1f51)[_0x440238(0xe9)]('(((.+)+)+)+$');});a5_0x1d1f51();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;function a5_0x4a20(){const _0x52d657=['LTM.trainingData.thermodynamics','accuweather','getStateAsync','weatherInstance','.Current.Temperature','currentSystemMode','system.isPresent','map','.1.VALVE_STATE','length','valveMapping','debug','switch','STATUS','from','useWeather','motion','temperature','occupancy','log','[RECORDER]\x20Error:\x20','Valve','outdoorSensorId','door','sendToPythonWrapper','LTM.trainingData.sequences','weatherunderground','getHours','round','lastTrackerEventTime','toString','push','heizung','fill','.1.LEVEL','pr채senz','41020029SuAKQC','config','toLowerCase','lampe','.4.VALVE_STATE','handle','isExit','schloss','4670CVmynQ','openweathermap','stringify','number','617148powRFD','constructor','[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20','klima','.forecast.current.temp','bewegung','loc','type','value','kontakt','licht','4867961aKdCLa','sensorLastValues','isGracePeriodActive','toISOString','replace','SIMULATE_SIGNAL','dimmer','7650712iRPzIC','presence','eventHistory','name','.NextHours.Location_1.Day_1.current.temp_value','LTM.rawEventLog','8455328kROFgI','daswetter','search','splice','unshift','.forecast.current.temperature','5KXeKhg','isPresent','analysis.health.todayVector','includes','exitGraceTimer','rawEventLog','val','.ACTUAL_TEMPERATURE','t체r','location','TRACK_EVENT','ANALYZE_SEQUENCE','normal','parse','LEVEL','10yxzWHM','string','fenster','setStateAsync','Unknown','schalter','498PHiKzE','isProVersion','shift','window','some','getDate','11252280SRFGdS','.LEVEL','griff','exitTimer','now','getForeignStateAsync','level','light','events.lastEvent','.1.ACTUAL_TEMPERATURE'];a5_0x4a20=function(){return _0x52d657;};return a5_0x4a20();}async function getOutsideTemperatureNumeric(_0x4e6f2d){const _0x39269b=a5_0x2dbd;if(_0x4e6f2d['config']['outdoorSensorId'])try{const _0x49f3c6=await _0x4e6f2d[_0x39269b(0x9a)](_0x4e6f2d[_0x39269b(0xc4)][_0x39269b(0xb5)]);if(_0x49f3c6&&_0x49f3c6[_0x39269b(0x80)]!==undefined&&_0x49f3c6['val']!==null)return parseFloat(_0x49f3c6[_0x39269b(0x80)]);}catch(_0x4e55fa){}const _0x5a2bc7=_0x4e6f2d[_0x39269b(0xc4)][_0x39269b(0xa2)];if(!_0x4e6f2d['config'][_0x39269b(0xae)]||!_0x5a2bc7)return null;try{let _0x56425d='';if(_0x5a2bc7[_0x39269b(0x7d)](_0x39269b(0xa0)))_0x56425d=_0x5a2bc7+_0x39269b(0xa3);else{if(_0x5a2bc7[_0x39269b(0x7d)](_0x39269b(0xe8)))_0x56425d=_0x5a2bc7+_0x39269b(0xe5);else{if(_0x5a2bc7[_0x39269b(0x7d)](_0x39269b(0xcc)))_0x56425d=_0x5a2bc7+_0x39269b(0xec);else{if(_0x5a2bc7[_0x39269b(0x7d)](_0x39269b(0xb9)))_0x56425d=_0x5a2bc7+_0x39269b(0xd3);}}}if(_0x56425d){const _0x127ec5=await _0x4e6f2d['getForeignStateAsync'](_0x56425d);if(_0x127ec5&&_0x127ec5[_0x39269b(0x80)]!==undefined&&_0x127ec5['val']!==null)return parseFloat(_0x127ec5[_0x39269b(0x80)]);}}catch(_0x11de16){}return null;}async function recordThermodynamics(_0x1a9b68,_0x12b413,_0x39e00f,_0x44ef68){const _0x2f016e=a5_0x2dbd,_0x58f99f=await getOutsideTemperatureNumeric(_0x1a9b68);if(_0x58f99f===null)return;let _0x254ebf=0x0,_0x3a084b=![];if(_0x1a9b68['config'][_0x2f016e(0xa9)])try{let _0x545c8a=_0x1a9b68['config'][_0x2f016e(0xa9)];if(typeof _0x545c8a===_0x2f016e(0x8a))_0x545c8a=JSON[_0x2f016e(0x87)](_0x545c8a);if(_0x545c8a[_0x12b413]){const _0xf7ef64=_0x545c8a[_0x12b413],_0x33dfab=await _0x1a9b68[_0x2f016e(0x9a)](_0xf7ef64);if(_0x33dfab&&_0x33dfab[_0x2f016e(0x80)]!==null&&_0x33dfab[_0x2f016e(0x80)]!==undefined){let _0x484889=Number(_0x33dfab[_0x2f016e(0x80)]);if(_0x484889<=1.05&&!_0xf7ef64[_0x2f016e(0x7d)](_0x2f016e(0xac))&&!_0xf7ef64[_0x2f016e(0x7d)]('STATE'))_0x484889=_0x484889*0x64;_0x254ebf=Math['round'](_0x484889),_0x3a084b=!![];}}}catch(_0x522af2){}if(!_0x3a084b){const _0x4373a5=[{'from':_0x2f016e(0x9e),'to':_0x2f016e(0xc1)},{'from':_0x2f016e(0x9e),'to':_0x2f016e(0xa7)},{'from':'.1.TEMPERATURE','to':_0x2f016e(0xc7)},{'from':_0x2f016e(0x81),'to':_0x2f016e(0x96)},{'from':_0x2f016e(0xb0),'to':_0x2f016e(0x9b)},{'from':'Temperature','to':_0x2f016e(0xb4)}];for(const _0x4cda02 of _0x4373a5){if(_0x12b413['includes'](_0x4cda02[_0x2f016e(0xad)])){const _0x54b3b7=_0x12b413[_0x2f016e(0xde)](_0x4cda02[_0x2f016e(0xad)],_0x4cda02['to']);try{const _0x29d52b=await _0x1a9b68['getForeignStateAsync'](_0x54b3b7);if(_0x29d52b&&_0x29d52b[_0x2f016e(0x80)]!==null&&_0x29d52b['val']!==undefined){let _0x90f3ea=Number(_0x29d52b[_0x2f016e(0x80)]);if(typeof _0x90f3ea===_0x2f016e(0xce)){if(_0x90f3ea<=1.05&&_0x4cda02['to'][_0x2f016e(0x7d)](_0x2f016e(0x88)))_0x90f3ea=_0x90f3ea*0x64;_0x254ebf=Math[_0x2f016e(0xbb)](_0x90f3ea),_0x3a084b=!![];break;}}}catch(_0x2ab096){}}}}const _0x581cf0=await _0x1a9b68[_0x2f016e(0xa1)](_0x2f016e(0x9f));let _0x12186b=[];if(_0x581cf0&&_0x581cf0[_0x2f016e(0x80)])try{_0x12186b=JSON[_0x2f016e(0x87)](_0x581cf0['val']);}catch(_0x2c4bb5){}_0x12186b[_0x2f016e(0xbe)]({'ts':Date[_0x2f016e(0x99)](),'room':_0x44ef68||_0x2f016e(0x8d),'t_in':_0x39e00f,'t_out':_0x58f99f,'valve':_0x254ebf});if(_0x12186b['length']>THERMO_LOG_SIZE)_0x12186b[_0x2f016e(0x91)]();await _0x1a9b68['setStateAsync'](_0x2f016e(0x9f),{'val':JSON[_0x2f016e(0xcd)](_0x12186b),'ack':!![]});}async function saveCompletedSequence(_0x108a84){const _0x51a700=a5_0x2dbd;try{const _0x1283fa=await _0x108a84[_0x51a700(0xa1)]('LTM.trainingData.sequences');let _0x6c745f=[];if(_0x1283fa&&_0x1283fa['val'])try{_0x6c745f=JSON[_0x51a700(0x87)](_0x1283fa[_0x51a700(0x80)]);}catch(_0x7bfb61){}const _0xeb2266=activeSequence[0x0]['ts'],_0x25c694=activeSequence[_0x51a700(0xa6)](_0x206fc6=>({'loc':_0x206fc6[_0x51a700(0xd5)],'t_delta':Math[_0x51a700(0xbb)]((_0x206fc6['ts']-_0xeb2266)/0x3e8)})),_0x52af08={'timestamp':new Date(_0xeb2266)[_0x51a700(0xdd)](),'steps':_0x25c694,'duration':Math['round']((activeSequence[activeSequence[_0x51a700(0xa8)]-0x1]['ts']-_0xeb2266)/0x3e8),'daytime':new Date(_0xeb2266)['getHours']()};_0x6c745f[_0x51a700(0xbe)](_0x52af08);if(_0x6c745f[_0x51a700(0xa8)]>MAX_TRAINING_SET_SIZE)_0x6c745f[_0x51a700(0x91)]();await _0x108a84[_0x51a700(0x8c)](_0x51a700(0xb8),{'val':JSON[_0x51a700(0xcd)](_0x6c745f),'ack':!![]}),_0x108a84[_0x51a700(0x90)]&&_0x108a84['sendToPythonWrapper']&&_0x108a84['sendToPythonWrapper'](_0x51a700(0x85),{'sequence':_0x52af08});}catch(_0x51f807){_0x108a84[_0x51a700(0xb2)]['error'](_0x51a700(0xb3)+_0x51f807['message']);}}async function recordSequence(_0x53dbdf,_0x2d2406){const _0x3be523=a5_0x2dbd,_0x4b1614=(_0x2d2406[_0x3be523(0xd6)]||'')['toLowerCase'](),_0x574502=['motion',_0x3be523(0xd4),_0x3be523(0xc2),'presence',_0x3be523(0xb1),_0x3be523(0xb6),_0x3be523(0x82),_0x3be523(0x92),_0x3be523(0x8b),'contact',_0x3be523(0xd8),_0x3be523(0x9c),_0x3be523(0xd9),_0x3be523(0xab),_0x3be523(0x8e),_0x3be523(0xe0),_0x3be523(0xc6)];if(!_0x574502[_0x3be523(0x93)](_0x2ad151=>_0x4b1614[_0x3be523(0x7d)](_0x2ad151)))return;if(!_0x2d2406[_0x3be523(0xd7)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x3be523(0xbe)]({'loc':_0x2d2406[_0x3be523(0x83)]||'Unknown','id':_0x2d2406['id'],'ts':Date[_0x3be523(0x99)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x53dbdf);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0x205341){const _0x4f3524=a5_0x2dbd;abortExitTimer(_0x205341),_0x205341[_0x4f3524(0xdc)]=!![],_0x205341[_0x4f3524(0x7e)]=setTimeout(()=>{const _0x2a031c=_0x4f3524;_0x205341[_0x2a031c(0xdc)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x205341[_0x4f3524(0x98)]=setTimeout(()=>{const _0x236012=_0x4f3524;setPresence(_0x205341,![]),_0x205341[_0x236012(0x98)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x2391c7){const _0x38877c=a5_0x2dbd;if(_0x2391c7[_0x38877c(0x98)])clearTimeout(_0x2391c7[_0x38877c(0x98)]);if(_0x2391c7[_0x38877c(0x7e)])clearTimeout(_0x2391c7[_0x38877c(0x7e)]);_0x2391c7[_0x38877c(0x98)]=null,_0x2391c7[_0x38877c(0x7e)]=null,_0x2391c7[_0x38877c(0xdc)]=![];}async function setPresence(_0x4c321a,_0x52f16f){const _0x41dae3=a5_0x2dbd;if(_0x4c321a[_0x41dae3(0xee)]===_0x52f16f)return;_0x4c321a[_0x41dae3(0xee)]=_0x52f16f,await _0x4c321a[_0x41dae3(0x8c)](_0x41dae3(0xa5),{'val':_0x52f16f,'ack':!![]});}async function updateHourlyActivity(_0x2dc2d6){const _0x2243e=a5_0x2dbd;let _0x2eaec6=new Array(0x18)[_0x2243e(0xc0)](0x0),_0x35dddf=0x0;try{const _0x23365d=await _0x2dc2d6[_0x2243e(0xa1)](_0x2243e(0x7c));_0x23365d&&_0x23365d['val']&&(_0x2eaec6=JSON['parse'](_0x23365d[_0x2243e(0x80)]),_0x35dddf=_0x23365d['ts']);}catch(_0x32901b){}const _0x5d707b=new Date(_0x35dddf),_0x118b89=new Date();_0x5d707b['getDate']()!==_0x118b89[_0x2243e(0x94)]()&&(_0x2eaec6=new Array(0x18)['fill'](0x0));const _0x56f2e1=_0x118b89[_0x2243e(0xba)]();if(_0x2eaec6[_0x56f2e1]===undefined)_0x2eaec6[_0x56f2e1]=0x0;_0x2eaec6[_0x56f2e1]++,await _0x2dc2d6[_0x2243e(0x8c)](_0x2243e(0x7c),{'val':JSON[_0x2243e(0xcd)](_0x2eaec6),'ack':!![]});}async function processSensorEvent(_0x2490b6,_0x41eb2c,_0x10e240,_0x102fcb){const _0x21c29d=a5_0x2dbd;if(!_0x102fcb)return null;const _0x21668d=_0x10e240['val'],_0x49d5c1=Date['now'](),_0x331608=_0x2490b6[_0x21c29d(0xdb)][_0x41eb2c],_0x54ece3=(_0x102fcb[_0x21c29d(0xd6)]||'')[_0x21c29d(0xc5)](),_0x54b5b5=_0x54ece3[_0x21c29d(0x7d)](_0x21c29d(0xb0))||_0x54ece3[_0x21c29d(0x7d)]('temperatur')||_0x54ece3['includes'](_0x21c29d(0xd2))||_0x54ece3[_0x21c29d(0x7d)](_0x21c29d(0xbf))||_0x54ece3[_0x21c29d(0x7d)]('thermostat');if(_0x54b5b5&&typeof _0x21668d===_0x21c29d(0xce)){if(_0x21668d>0x50||_0x21668d<-0x32)return _0x2490b6[_0x21c29d(0xb2)][_0x21c29d(0xaa)](_0x21c29d(0xd1)+_0x21668d+'\x20from\x20'+_0x41eb2c),null;}_0x2490b6[_0x21c29d(0xdb)][_0x41eb2c]=_0x21668d;if(!_0x102fcb['logDuplicates']&&_0x331608!=undefined&&_0x331608==_0x21668d)return null;_0x2490b6[_0x21c29d(0x90)]&&_0x54b5b5&&recordThermodynamics(_0x2490b6,_0x41eb2c,_0x21668d,_0x102fcb[_0x21c29d(0x83)]);const _0x4c8b12={'timestamp':_0x49d5c1,'id':_0x41eb2c,'name':_0x102fcb[_0x21c29d(0xe4)],'type':_0x102fcb[_0x21c29d(0xd6)],'location':_0x102fcb['location'],'value':_0x21668d};_0x2490b6[_0x21c29d(0xe3)][_0x21c29d(0xeb)](_0x4c8b12);if(_0x2490b6[_0x21c29d(0xe3)][_0x21c29d(0xa8)]>HISTORY_MAX_SIZE)_0x2490b6[_0x21c29d(0xe3)]['pop']();await _0x2490b6[_0x21c29d(0x8c)](_0x21c29d(0x9d),{'val':JSON[_0x21c29d(0xcd)](_0x4c8b12),'ack':!![]}),await _0x2490b6['setStateAsync']('events.history',{'val':JSON[_0x21c29d(0xcd)](_0x2490b6['eventHistory']),'ack':!![]}),await updateHourlyActivity(_0x2490b6);if(_0x2490b6[_0x21c29d(0x90)]){_0x2490b6[_0x21c29d(0x7f)][_0x21c29d(0xbe)](_0x4c8b12);if(_0x2490b6[_0x21c29d(0x7f)][_0x21c29d(0xa8)]>RAW_LOG_MAX_SIZE)_0x2490b6[_0x21c29d(0x7f)][_0x21c29d(0xea)](0x0,_0x2490b6['rawEventLog'][_0x21c29d(0xa8)]-RAW_LOG_MAX_SIZE);await _0x2490b6[_0x21c29d(0x8c)](_0x21c29d(0xe6),{'val':JSON['stringify'](_0x2490b6[_0x21c29d(0x7f)]),'ack':!![]}),recordSequence(_0x2490b6,_0x4c8b12);}if(_0x102fcb[_0x21c29d(0xc9)]&&_0x21668d===!![]){if(_0x2490b6['isPresent']&&!_0x2490b6[_0x21c29d(0xdc)])startExitTimer(_0x2490b6);else{if(!_0x2490b6[_0x21c29d(0xee)])setPresence(_0x2490b6,!![]);}}else{if(_0x102fcb['type']===_0x21c29d(0xaf)&&_0x21668d===!![]){if(_0x2490b6[_0x21c29d(0x98)])abortExitTimer(_0x2490b6);if(!_0x2490b6[_0x21c29d(0xee)]&&_0x2490b6[_0x21c29d(0xa4)]===_0x21c29d(0x86))setPresence(_0x2490b6,!![]);}}if(_0x2490b6[_0x21c29d(0x90)]&&_0x2490b6['sendToPythonWrapper']){_0x102fcb[_0x21c29d(0xd6)]==='motion'&&_0x21668d===!![]&&_0x102fcb['location']&&_0x2490b6['sendToPythonWrapper'](_0x21c29d(0xdf),{'room':_0x102fcb[_0x21c29d(0x83)]});const _0x1ae108=['door','t체r',_0x21c29d(0x92),_0x21c29d(0x8b),_0x21c29d(0x97),_0x21c29d(0xc8),'lock',_0x21c29d(0xca)]['some'](_0x47b401=>_0x54ece3[_0x21c29d(0x7d)](_0x47b401)),_0x4a35fb=[_0x21c29d(0x9c),_0x21c29d(0xd9),_0x21c29d(0xab),_0x21c29d(0x8e),_0x21c29d(0xe0),'lampe']['some'](_0x32d34d=>_0x54ece3[_0x21c29d(0x7d)](_0x32d34d)),_0x56e20e=[_0x21c29d(0xaf),_0x21c29d(0xd4),'pr채senz',_0x21c29d(0xe2),_0x21c29d(0xb1)][_0x21c29d(0x93)](_0x44f9b3=>_0x54ece3[_0x21c29d(0x7d)](_0x44f9b3));if(_0x102fcb[_0x21c29d(0x83)]&&(_0x1ae108||_0x4a35fb||_0x56e20e)){const _0x100239=_0x21668d===!![]||typeof _0x21668d===_0x21c29d(0xce)&&_0x21668d>0x0,_0x2ded54=_0x1ae108&&!_0x100239&&_0x331608!==undefined&&_0x331608!=_0x21668d;if(_0x100239||_0x2ded54){const _0x1a787d=_0x2490b6[_0x21c29d(0xbc)]||_0x49d5c1,_0x1cf5df=(_0x49d5c1-_0x1a787d)/0x3e8;_0x2490b6[_0x21c29d(0xbc)]=_0x49d5c1,_0x2490b6[_0x21c29d(0xb7)](_0x21c29d(0x84),{'room':_0x102fcb[_0x21c29d(0x83)],'dt':_0x1cf5df});}}}return _0x4c8b12;}module['exports']={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};