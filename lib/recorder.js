function a5_0x1ed5(_0x3db4b2,_0x5dbbca){const _0x61d641=a5_0x1089();return a5_0x1ed5=function(_0x2a3488,_0x2d0856){_0x2a3488=_0x2a3488-0x158;let _0x1089f0=_0x61d641[_0x2a3488];return _0x1089f0;},a5_0x1ed5(_0x3db4b2,_0x5dbbca);}const a5_0x5b5860=a5_0x1ed5;(function(_0x56d9fc,_0x24be3f){const _0x4d7ab9=a5_0x1ed5,_0x38883b=_0x56d9fc();while(!![]){try{const _0x5d95b1=parseInt(_0x4d7ab9(0x19e))/0x1*(-parseInt(_0x4d7ab9(0x16b))/0x2)+parseInt(_0x4d7ab9(0x181))/0x3+parseInt(_0x4d7ab9(0x16d))/0x4+parseInt(_0x4d7ab9(0x190))/0x5*(parseInt(_0x4d7ab9(0x173))/0x6)+-parseInt(_0x4d7ab9(0x1ba))/0x7*(-parseInt(_0x4d7ab9(0x162))/0x8)+parseInt(_0x4d7ab9(0x195))/0x9+-parseInt(_0x4d7ab9(0x196))/0xa*(parseInt(_0x4d7ab9(0x197))/0xb);if(_0x5d95b1===_0x24be3f)break;else _0x38883b['push'](_0x38883b['shift']());}catch(_0x54f415){_0x38883b['push'](_0x38883b['shift']());}}}(a5_0x1089,0x44130));const a5_0x2d0856=(function(){let _0x54ec0f=!![];return function(_0x504898,_0x5c2f77){const _0x96afed=_0x54ec0f?function(){const _0x4bec2b=a5_0x1ed5;if(_0x5c2f77){const _0x57f56b=_0x5c2f77[_0x4bec2b(0x16e)](_0x504898,arguments);return _0x5c2f77=null,_0x57f56b;}}:function(){};return _0x54ec0f=![],_0x96afed;};}()),a5_0x2a3488=a5_0x2d0856(this,function(){const _0x389d33=a5_0x1ed5;return a5_0x2a3488[_0x389d33(0x1ac)]()[_0x389d33(0x169)](_0x389d33(0x15e))[_0x389d33(0x1ac)]()[_0x389d33(0x194)](a5_0x2a3488)['search'](_0x389d33(0x15e));});a5_0x2a3488();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x1261c1){const _0x15b1fb=a5_0x1ed5;if(_0x1261c1[_0x15b1fb(0x15a)][_0x15b1fb(0x166)])try{const _0x32df8d=await _0x1261c1[_0x15b1fb(0x1bc)](_0x1261c1[_0x15b1fb(0x15a)]['outdoorSensorId']);if(_0x32df8d&&_0x32df8d[_0x15b1fb(0x171)]!==undefined&&_0x32df8d['val']!==null)return parseFloat(_0x32df8d[_0x15b1fb(0x171)]);}catch(_0x541f83){}const _0x1bd42f=_0x1261c1[_0x15b1fb(0x15a)][_0x15b1fb(0x186)];if(!_0x1261c1[_0x15b1fb(0x15a)][_0x15b1fb(0x18d)]||!_0x1bd42f)return null;try{let _0x2e135d='';if(_0x1bd42f[_0x15b1fb(0x170)]('accuweather'))_0x2e135d=_0x1bd42f+_0x15b1fb(0x15c);else{if(_0x1bd42f[_0x15b1fb(0x170)](_0x15b1fb(0x1c2)))_0x2e135d=_0x1bd42f+_0x15b1fb(0x192);else{if(_0x1bd42f[_0x15b1fb(0x170)](_0x15b1fb(0x1b7)))_0x2e135d=_0x1bd42f+_0x15b1fb(0x17b);else{if(_0x1bd42f[_0x15b1fb(0x170)](_0x15b1fb(0x1c8)))_0x2e135d=_0x1bd42f+_0x15b1fb(0x1b8);}}}if(_0x2e135d){const _0x48d2e8=await _0x1261c1[_0x15b1fb(0x1bc)](_0x2e135d);if(_0x48d2e8&&_0x48d2e8[_0x15b1fb(0x171)]!==undefined&&_0x48d2e8['val']!==null)return parseFloat(_0x48d2e8['val']);}}catch(_0x484aa5){}return null;}async function recordThermodynamics(_0x5d92d9,_0x45630e,_0x1dcea4,_0x50ea99){const _0x4d0ce7=a5_0x1ed5,_0x3f365e=await getOutsideTemperatureNumeric(_0x5d92d9);if(_0x3f365e===null)return;let _0x168afd=0x0,_0xd1349f=![];if(_0x5d92d9[_0x4d0ce7(0x15a)][_0x4d0ce7(0x183)])try{let _0x4fc93c=_0x5d92d9[_0x4d0ce7(0x15a)][_0x4d0ce7(0x183)];if(typeof _0x4fc93c===_0x4d0ce7(0x187))_0x4fc93c=JSON[_0x4d0ce7(0x1c5)](_0x4fc93c);if(_0x4fc93c[_0x45630e]){const _0x497ae8=_0x4fc93c[_0x45630e],_0x2c2677=await _0x5d92d9[_0x4d0ce7(0x1bc)](_0x497ae8);if(_0x2c2677&&_0x2c2677['val']!==null&&_0x2c2677[_0x4d0ce7(0x171)]!==undefined){let _0x176765=Number(_0x2c2677[_0x4d0ce7(0x171)]);if(_0x176765<=1.05&&!_0x497ae8[_0x4d0ce7(0x170)](_0x4d0ce7(0x1a5))&&!_0x497ae8[_0x4d0ce7(0x170)]('STATE'))_0x176765=_0x176765*0x64;_0x168afd=Math[_0x4d0ce7(0x168)](_0x176765),_0xd1349f=!![];}}}catch(_0xfca58d){}if(!_0xd1349f){const _0x151aa8=[{'from':_0x4d0ce7(0x1aa),'to':_0x4d0ce7(0x199)},{'from':_0x4d0ce7(0x1aa),'to':'.1.VALVE_STATE'},{'from':_0x4d0ce7(0x176),'to':'.4.VALVE_STATE'},{'from':_0x4d0ce7(0x1c7),'to':_0x4d0ce7(0x1a6)},{'from':'temperature','to':'level'},{'from':_0x4d0ce7(0x164),'to':_0x4d0ce7(0x1af)}];for(const _0x33bdb0 of _0x151aa8){if(_0x45630e[_0x4d0ce7(0x170)](_0x33bdb0[_0x4d0ce7(0x191)])){const _0x13cc1a=_0x45630e[_0x4d0ce7(0x1b5)](_0x33bdb0[_0x4d0ce7(0x191)],_0x33bdb0['to']);try{const _0x2a89ab=await _0x5d92d9[_0x4d0ce7(0x1bc)](_0x13cc1a);if(_0x2a89ab&&_0x2a89ab[_0x4d0ce7(0x171)]!==null&&_0x2a89ab['val']!==undefined){let _0x32752d=Number(_0x2a89ab[_0x4d0ce7(0x171)]);if(typeof _0x32752d===_0x4d0ce7(0x1a7)){if(_0x32752d<=1.05&&_0x33bdb0['to'][_0x4d0ce7(0x170)](_0x4d0ce7(0x1ad)))_0x32752d=_0x32752d*0x64;_0x168afd=Math['round'](_0x32752d),_0xd1349f=!![];break;}}}catch(_0x16ce18){}}}}const _0x19325b=await _0x5d92d9[_0x4d0ce7(0x1c6)](_0x4d0ce7(0x18e));let _0xd99b60=[];if(_0x19325b&&_0x19325b['val'])try{_0xd99b60=JSON[_0x4d0ce7(0x1c5)](_0x19325b[_0x4d0ce7(0x171)]);}catch(_0x201ff8){}_0xd99b60[_0x4d0ce7(0x15d)]({'ts':Date[_0x4d0ce7(0x177)](),'room':_0x50ea99||_0x4d0ce7(0x19b),'t_in':_0x1dcea4,'t_out':_0x3f365e,'valve':_0x168afd});if(_0xd99b60[_0x4d0ce7(0x1b9)]>THERMO_LOG_SIZE)_0xd99b60['shift']();await _0x5d92d9[_0x4d0ce7(0x1b0)](_0x4d0ce7(0x18e),{'val':JSON[_0x4d0ce7(0x1ae)](_0xd99b60),'ack':!![]});}async function saveCompletedSequence(_0x5c5855){const _0x2686ce=a5_0x1ed5;try{const _0x1c01f9=await _0x5c5855[_0x2686ce(0x1c6)](_0x2686ce(0x172));let _0xbfbb29=[];if(_0x1c01f9&&_0x1c01f9[_0x2686ce(0x171)])try{_0xbfbb29=JSON[_0x2686ce(0x1c5)](_0x1c01f9[_0x2686ce(0x171)]);}catch(_0x4cad3e){}const _0x500f73=activeSequence[0x0]['ts'],_0x15edf9=activeSequence[_0x2686ce(0x159)](_0x22c9a3=>({'loc':_0x22c9a3[_0x2686ce(0x161)],'t_delta':Math[_0x2686ce(0x168)]((_0x22c9a3['ts']-_0x500f73)/0x3e8)})),_0x24f9bc={'timestamp':new Date(_0x500f73)[_0x2686ce(0x1bb)](),'steps':_0x15edf9,'duration':Math['round']((activeSequence[activeSequence['length']-0x1]['ts']-_0x500f73)/0x3e8),'daytime':new Date(_0x500f73)['getHours']()};_0xbfbb29['push'](_0x24f9bc);if(_0xbfbb29[_0x2686ce(0x1b9)]>MAX_TRAINING_SET_SIZE)_0xbfbb29['shift']();await _0x5c5855[_0x2686ce(0x1b0)](_0x2686ce(0x172),{'val':JSON[_0x2686ce(0x1ae)](_0xbfbb29),'ack':!![]}),_0x5c5855[_0x2686ce(0x18b)]&&_0x5c5855[_0x2686ce(0x185)]&&_0x5c5855['sendToPythonWrapper']('ANALYZE_SEQUENCE',{'sequence':_0x24f9bc});}catch(_0x510265){_0x5c5855[_0x2686ce(0x19f)]['error']('[RECORDER]\x20Error:\x20'+_0x510265[_0x2686ce(0x182)]);}}async function recordSequence(_0x5b5936,_0x332d14){const _0x346ba2=a5_0x1ed5,_0x590ff1=(_0x332d14[_0x346ba2(0x17c)]||'')[_0x346ba2(0x158)](),_0x151801=['motion',_0x346ba2(0x15b),_0x346ba2(0x1c3),_0x346ba2(0x1b3),_0x346ba2(0x18c),_0x346ba2(0x163),_0x346ba2(0x1c4),'window','fenster',_0x346ba2(0x1a2),_0x346ba2(0x1a0),_0x346ba2(0x174),_0x346ba2(0x16f),_0x346ba2(0x1bf),'schalter',_0x346ba2(0x1a9),'lampe'];if(!_0x151801[_0x346ba2(0x18a)](_0x26147e=>_0x590ff1['includes'](_0x26147e)))return;if(!_0x332d14[_0x346ba2(0x175)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x346ba2(0x15d)]({'loc':_0x332d14[_0x346ba2(0x198)]||_0x346ba2(0x19b),'id':_0x332d14['id'],'ts':Date[_0x346ba2(0x177)]()}),sequenceTimer=setTimeout(async()=>{const _0x5a7cbc=_0x346ba2;if(activeSequence[_0x5a7cbc(0x1b9)]>0x1)await saveCompletedSequence(_0x5b5936);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function startExitTimer(_0x47ce27){const _0x2ffd15=a5_0x1ed5;abortExitTimer(_0x47ce27),_0x47ce27[_0x2ffd15(0x1bd)]=!![],_0x47ce27['exitGraceTimer']=setTimeout(()=>{const _0x2ef7a0=_0x2ffd15;_0x47ce27[_0x2ef7a0(0x1bd)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x47ce27[_0x2ffd15(0x1a4)]=setTimeout(()=>{const _0x4fbcc8=_0x2ffd15;setPresence(_0x47ce27,![]),_0x47ce27[_0x4fbcc8(0x1a4)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x37da3a){const _0x19b053=a5_0x1ed5;if(_0x37da3a[_0x19b053(0x1a4)])clearTimeout(_0x37da3a[_0x19b053(0x1a4)]);if(_0x37da3a['exitGraceTimer'])clearTimeout(_0x37da3a[_0x19b053(0x1b2)]);_0x37da3a[_0x19b053(0x1a4)]=null,_0x37da3a[_0x19b053(0x1b2)]=null,_0x37da3a[_0x19b053(0x1bd)]=![];}async function setPresence(_0x2217ba,_0x386860){const _0x2bffa1=a5_0x1ed5;if(_0x2217ba[_0x2bffa1(0x17a)]===_0x386860)return;_0x2217ba[_0x2bffa1(0x17a)]=_0x386860,await _0x2217ba[_0x2bffa1(0x1b0)](_0x2bffa1(0x193),{'val':_0x386860,'ack':!![]});}function a5_0x1089(){const _0x30329d=['setStateAsync','events.history','exitGraceTimer','presence','eventHistory','replace','TRACK_EVENT','openweathermap','.forecast.current.temp','length','1463MFeDbm','toISOString','getForeignStateAsync','isGracePeriodActive','temperatur','switch','fenster','window','daswetter','präsenz','tür','parse','getStateAsync','.ACTUAL_TEMPERATURE','weatherunderground','toLowerCase','map','config','bewegung','.Current.Temperature','push','(((.+)+)+)+$','lampe','rawEventLog','loc','10544YzfZgU','door','Temperature','isExit','outdoorSensorId','[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20','round','search','events.lastEvent','44266dnKHnE','motion','929064bJVoSu','apply','licht','includes','val','LTM.trainingData.sequences','1356930kqEHet','light','value','.1.TEMPERATURE','now','LTM.rawEventLog','heizung','isPresent','.forecast.current.temperature','type','exports','lock','\x20from\x20','temperature','608769fTNJpP','message','valveMapping','normal','sendToPythonWrapper','weatherInstance','string','pop','schalter','some','isProVersion','occupancy','useWeather','LTM.trainingData.thermodynamics','unshift','5XboGfM','from','.NextHours.Location_1.Day_1.current.temp_value','system.isPresent','constructor','4740534bnHYHr','10740350jcOWAY','11lSKdCW','location','.1.LEVEL','griff','Unknown','debug','currentSystemMode','5YYHRnQ','log','kontakt','lastTrackerEventTime','contact','handle','exitTimer','STATUS','.LEVEL','number','splice','dimmer','.1.ACTUAL_TEMPERATURE','name','toString','LEVEL','stringify','Valve'];a5_0x1089=function(){return _0x30329d;};return a5_0x1089();}async function processSensorEvent(_0x3bf9e3,_0x1e9ed8,_0x18ab39,_0x44ffac){const _0x556939=a5_0x1ed5;if(!_0x44ffac)return null;const _0x41bb58=_0x18ab39[_0x556939(0x171)],_0x52ea8d=Date['now'](),_0xe67e3e=_0x3bf9e3['sensorLastValues'][_0x1e9ed8],_0x13e0ac=(_0x44ffac[_0x556939(0x17c)]||'')[_0x556939(0x158)](),_0x2014fd=_0x13e0ac[_0x556939(0x170)](_0x556939(0x180))||_0x13e0ac[_0x556939(0x170)](_0x556939(0x1be))||_0x13e0ac['includes']('klima')||_0x13e0ac['includes'](_0x556939(0x179))||_0x13e0ac[_0x556939(0x170)]('thermostat');if(_0x2014fd&&typeof _0x41bb58===_0x556939(0x1a7)){if(_0x41bb58>0x50||_0x41bb58<-0x32)return _0x3bf9e3[_0x556939(0x19f)][_0x556939(0x19c)](_0x556939(0x167)+_0x41bb58+_0x556939(0x17f)+_0x1e9ed8),null;}_0x3bf9e3['sensorLastValues'][_0x1e9ed8]=_0x41bb58;if(!_0x44ffac['logDuplicates']&&_0xe67e3e!=undefined&&_0xe67e3e==_0x41bb58)return null;_0x3bf9e3[_0x556939(0x18b)]&&_0x2014fd&&recordThermodynamics(_0x3bf9e3,_0x1e9ed8,_0x41bb58,_0x44ffac[_0x556939(0x198)]);const _0x4487e5={'timestamp':_0x52ea8d,'id':_0x1e9ed8,'name':_0x44ffac[_0x556939(0x1ab)],'type':_0x44ffac[_0x556939(0x17c)],'location':_0x44ffac[_0x556939(0x198)],'value':_0x41bb58};_0x3bf9e3[_0x556939(0x1b4)][_0x556939(0x18f)](_0x4487e5);if(_0x3bf9e3['eventHistory'][_0x556939(0x1b9)]>HISTORY_MAX_SIZE)_0x3bf9e3[_0x556939(0x1b4)][_0x556939(0x188)]();await _0x3bf9e3['setStateAsync'](_0x556939(0x16a),{'val':JSON[_0x556939(0x1ae)](_0x4487e5),'ack':!![]}),await _0x3bf9e3[_0x556939(0x1b0)](_0x556939(0x1b1),{'val':JSON['stringify'](_0x3bf9e3[_0x556939(0x1b4)]),'ack':!![]});if(_0x3bf9e3['isProVersion']){_0x3bf9e3[_0x556939(0x160)][_0x556939(0x15d)](_0x4487e5);if(_0x3bf9e3[_0x556939(0x160)][_0x556939(0x1b9)]>RAW_LOG_MAX_SIZE)_0x3bf9e3[_0x556939(0x160)][_0x556939(0x1a8)](0x0,_0x3bf9e3[_0x556939(0x160)]['length']-RAW_LOG_MAX_SIZE);await _0x3bf9e3[_0x556939(0x1b0)](_0x556939(0x178),{'val':JSON[_0x556939(0x1ae)](_0x3bf9e3[_0x556939(0x160)]),'ack':!![]}),recordSequence(_0x3bf9e3,_0x4487e5);}if(_0x44ffac[_0x556939(0x165)]&&_0x41bb58===!![]){if(_0x3bf9e3[_0x556939(0x17a)]&&!_0x3bf9e3['isGracePeriodActive'])startExitTimer(_0x3bf9e3);else{if(!_0x3bf9e3['isPresent'])setPresence(_0x3bf9e3,!![]);}}else{if(_0x44ffac[_0x556939(0x17c)]===_0x556939(0x16c)&&_0x41bb58===!![]){if(_0x3bf9e3['exitTimer'])abortExitTimer(_0x3bf9e3);if(!_0x3bf9e3[_0x556939(0x17a)]&&_0x3bf9e3[_0x556939(0x19d)]===_0x556939(0x184))setPresence(_0x3bf9e3,!![]);}}if(_0x3bf9e3[_0x556939(0x18b)]&&_0x3bf9e3[_0x556939(0x185)]){_0x44ffac[_0x556939(0x17c)]==='motion'&&_0x41bb58===!![]&&_0x44ffac[_0x556939(0x198)]&&_0x3bf9e3['sendToPythonWrapper']('SIMULATE_SIGNAL',{'room':_0x44ffac[_0x556939(0x198)]});const _0x18fe77=[_0x556939(0x163),_0x556939(0x1c4),_0x556939(0x1c1),_0x556939(0x1c0),_0x556939(0x19a),_0x556939(0x1a3),_0x556939(0x17e),'schloss'][_0x556939(0x18a)](_0x4e20f2=>_0x13e0ac[_0x556939(0x170)](_0x4e20f2)),_0x4dd9a6=[_0x556939(0x174),_0x556939(0x16f),_0x556939(0x1bf),_0x556939(0x189),_0x556939(0x1a9),_0x556939(0x15f)][_0x556939(0x18a)](_0x1390d0=>_0x13e0ac[_0x556939(0x170)](_0x1390d0)),_0x3f18c7=[_0x556939(0x16c),'bewegung',_0x556939(0x1c3),_0x556939(0x1b3),_0x556939(0x18c)]['some'](_0xa7e82d=>_0x13e0ac['includes'](_0xa7e82d));if(_0x44ffac[_0x556939(0x198)]&&(_0x18fe77||_0x4dd9a6||_0x3f18c7)){const _0x4c49f2=_0x41bb58===!![]||typeof _0x41bb58===_0x556939(0x1a7)&&_0x41bb58>0x0,_0x120404=_0x18fe77&&!_0x4c49f2&&_0xe67e3e!==undefined&&_0xe67e3e!=_0x41bb58;if(_0x4c49f2||_0x120404){const _0x48a100=_0x3bf9e3[_0x556939(0x1a1)]||_0x52ea8d,_0x223ab5=(_0x52ea8d-_0x48a100)/0x3e8;_0x3bf9e3[_0x556939(0x1a1)]=_0x52ea8d,_0x3bf9e3[_0x556939(0x185)](_0x556939(0x1b6),{'room':_0x44ffac[_0x556939(0x198)],'dt':_0x223ab5});}}}return _0x4487e5;}module[a5_0x5b5860(0x17d)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};