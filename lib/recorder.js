function a5_0x1ff1(){const _0x3c546c=['switch','rawEventLog','valveMapping','system.isPresent','useWeather','openweathermap','Valve','accuweather','schalter','parse','sensorLastValues','Temperature','(((.+)+)+)+$','isGracePeriodActive','some','events.lastEvent','[RECORDER]\x20Error:\x20','klima','events.history','handle','1509395YPwsGg','window','.Current.Temperature','presence','val','pr채senz','daswetter','search','message','32703LhNMGg','includes','door','isProVersion','string','.NextHours.Location_1.Day_1.current.temp_value','.ACTUAL_TEMPERATURE','setStateAsync','LTM.trainingData.thermodynamics','type','lampe','2199756amPZdW','dimmer','toISOString','motion','LTM.trainingData.sequences','exitTimer','log','toString','Unknown','temperature','.1.LEVEL','.forecast.current.temp','now','5271416ODbVgS','outdoorSensorId','stringify','constructor','apply','LEVEL','push','from','48czbaEE','round','contact','loc','.1.ACTUAL_TEMPERATURE','light','normal','pop','exitGraceTimer','STATE','licht','getForeignStateAsync','LTM.rawEventLog','isPresent','bewegung','length','shift','logDuplicates','sendToPythonWrapper','\x20from\x20','config','.LEVEL','weatherInstance','.1.VALVE_STATE','exports','2840950UHSmBX','eventHistory','ANALYZE_SEQUENCE','value','STATUS','name','toLowerCase','206rshlyc','1290213uMjNyO','fenster','lastTrackerEventTime','number','thermostat','.forecast.current.temperature','807401pwYddj','getHours','location','griff','getStateAsync','SIMULATE_SIGNAL'];a5_0x1ff1=function(){return _0x3c546c;};return a5_0x1ff1();}const a5_0xf0d2a4=a5_0x1ac9;(function(_0x24dd2c,_0x1af005){const _0xc496a7=a5_0x1ac9,_0x78ea6a=_0x24dd2c();while(!![]){try{const _0x272b84=parseInt(_0xc496a7(0x1ac))/0x1+parseInt(_0xc496a7(0x1f5))/0x2*(parseInt(_0xc496a7(0x1b5))/0x3)+-parseInt(_0xc496a7(0x1c0))/0x4+parseInt(_0xc496a7(0x1ee))/0x5+-parseInt(_0xc496a7(0x1d5))/0x6*(parseInt(_0xc496a7(0x1fc))/0x7)+-parseInt(_0xc496a7(0x1cd))/0x8+-parseInt(_0xc496a7(0x1f6))/0x9;if(_0x272b84===_0x1af005)break;else _0x78ea6a['push'](_0x78ea6a['shift']());}catch(_0x2ee806){_0x78ea6a['push'](_0x78ea6a['shift']());}}}(a5_0x1ff1,0xe1eed));const a5_0x490af1=(function(){let _0x14bc4f=!![];return function(_0x58280d,_0xcc6d8e){const _0x2fe534=_0x14bc4f?function(){const _0x11dcd5=a5_0x1ac9;if(_0xcc6d8e){const _0xedce94=_0xcc6d8e[_0x11dcd5(0x1d1)](_0x58280d,arguments);return _0xcc6d8e=null,_0xedce94;}}:function(){};return _0x14bc4f=![],_0x2fe534;};}()),a5_0x55810d=a5_0x490af1(this,function(){const _0x3b37ae=a5_0x1ac9;return a5_0x55810d[_0x3b37ae(0x1c7)]()[_0x3b37ae(0x1b3)](_0x3b37ae(0x1a4))[_0x3b37ae(0x1c7)]()[_0x3b37ae(0x1d0)](a5_0x55810d)['search'](_0x3b37ae(0x1a4));});a5_0x55810d();'use strict';const HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,THERMO_LOG_SIZE=0x3e8,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e;let activeSequence=[],sequenceTimer=null;async function getOutsideTemperatureNumeric(_0x32d9ee){const _0x10b74e=a5_0x1ac9;if(_0x32d9ee['config'][_0x10b74e(0x1ce)])try{const _0x739fef=await _0x32d9ee['getForeignStateAsync'](_0x32d9ee['config'][_0x10b74e(0x1ce)]);if(_0x739fef&&_0x739fef['val']!==undefined&&_0x739fef[_0x10b74e(0x1b0)]!==null)return parseFloat(_0x739fef[_0x10b74e(0x1b0)]);}catch(_0x2eb060){}const _0x6fef08=_0x32d9ee[_0x10b74e(0x1e9)][_0x10b74e(0x1eb)];if(!_0x32d9ee[_0x10b74e(0x1e9)][_0x10b74e(0x19c)]||!_0x6fef08)return null;try{let _0x1e0594='';if(_0x6fef08['includes'](_0x10b74e(0x19f)))_0x1e0594=_0x6fef08+_0x10b74e(0x1ae);else{if(_0x6fef08[_0x10b74e(0x1b6)](_0x10b74e(0x1b2)))_0x1e0594=_0x6fef08+_0x10b74e(0x1ba);else{if(_0x6fef08['includes'](_0x10b74e(0x19d)))_0x1e0594=_0x6fef08+_0x10b74e(0x1fb);else{if(_0x6fef08[_0x10b74e(0x1b6)]('weatherunderground'))_0x1e0594=_0x6fef08+_0x10b74e(0x1cb);}}}if(_0x1e0594){const _0xe3d180=await _0x32d9ee[_0x10b74e(0x1e0)](_0x1e0594);if(_0xe3d180&&_0xe3d180[_0x10b74e(0x1b0)]!==undefined&&_0xe3d180[_0x10b74e(0x1b0)]!==null)return parseFloat(_0xe3d180['val']);}}catch(_0x49b21f){}return null;}async function recordThermodynamics(_0x3b11c0,_0x24aae9,_0x2826a4,_0x4cae40){const _0x2f6dee=a5_0x1ac9,_0x162168=await getOutsideTemperatureNumeric(_0x3b11c0);if(_0x162168===null)return;let _0x127c5f=0x0,_0x3310af=![];if(_0x3b11c0[_0x2f6dee(0x1e9)][_0x2f6dee(0x19a)])try{let _0x2510d7=_0x3b11c0[_0x2f6dee(0x1e9)][_0x2f6dee(0x19a)];if(typeof _0x2510d7===_0x2f6dee(0x1b9))_0x2510d7=JSON[_0x2f6dee(0x1a1)](_0x2510d7);if(_0x2510d7[_0x24aae9]){const _0xcfb01f=_0x2510d7[_0x24aae9],_0x5f4087=await _0x3b11c0[_0x2f6dee(0x1e0)](_0xcfb01f);if(_0x5f4087&&_0x5f4087[_0x2f6dee(0x1b0)]!==null&&_0x5f4087[_0x2f6dee(0x1b0)]!==undefined){let _0x52203f=Number(_0x5f4087[_0x2f6dee(0x1b0)]);if(_0x52203f<=1.05&&!_0xcfb01f[_0x2f6dee(0x1b6)](_0x2f6dee(0x1f2))&&!_0xcfb01f['includes'](_0x2f6dee(0x1de)))_0x52203f=_0x52203f*0x64;_0x127c5f=Math[_0x2f6dee(0x1d6)](_0x52203f),_0x3310af=!![];}}}catch(_0x581a00){}if(!_0x3310af){const _0x50507f=[{'from':_0x2f6dee(0x1d9),'to':_0x2f6dee(0x1ca)},{'from':_0x2f6dee(0x1d9),'to':_0x2f6dee(0x1ec)},{'from':'.1.TEMPERATURE','to':'.4.VALVE_STATE'},{'from':_0x2f6dee(0x1bb),'to':_0x2f6dee(0x1ea)},{'from':'temperature','to':'level'},{'from':_0x2f6dee(0x1a3),'to':_0x2f6dee(0x19e)}];for(const _0x77dd3f of _0x50507f){if(_0x24aae9[_0x2f6dee(0x1b6)](_0x77dd3f[_0x2f6dee(0x1d4)])){const _0x4e8eb1=_0x24aae9['replace'](_0x77dd3f[_0x2f6dee(0x1d4)],_0x77dd3f['to']);try{const _0x20a845=await _0x3b11c0[_0x2f6dee(0x1e0)](_0x4e8eb1);if(_0x20a845&&_0x20a845[_0x2f6dee(0x1b0)]!==null&&_0x20a845[_0x2f6dee(0x1b0)]!==undefined){let _0x1cf444=Number(_0x20a845[_0x2f6dee(0x1b0)]);if(typeof _0x1cf444===_0x2f6dee(0x1f9)){if(_0x1cf444<=1.05&&_0x77dd3f['to']['includes'](_0x2f6dee(0x1d2)))_0x1cf444=_0x1cf444*0x64;_0x127c5f=Math[_0x2f6dee(0x1d6)](_0x1cf444),_0x3310af=!![];break;}}}catch(_0x87e9cc){}}}}const _0x3bfec4=await _0x3b11c0['getStateAsync'](_0x2f6dee(0x1bd));let _0x5447da=[];if(_0x3bfec4&&_0x3bfec4[_0x2f6dee(0x1b0)])try{_0x5447da=JSON[_0x2f6dee(0x1a1)](_0x3bfec4[_0x2f6dee(0x1b0)]);}catch(_0x4bc3ba){}_0x5447da[_0x2f6dee(0x1d3)]({'ts':Date[_0x2f6dee(0x1cc)](),'room':_0x4cae40||_0x2f6dee(0x1c8),'t_in':_0x2826a4,'t_out':_0x162168,'valve':_0x127c5f});if(_0x5447da[_0x2f6dee(0x1e4)]>THERMO_LOG_SIZE)_0x5447da[_0x2f6dee(0x1e5)]();await _0x3b11c0[_0x2f6dee(0x1bc)](_0x2f6dee(0x1bd),{'val':JSON[_0x2f6dee(0x1cf)](_0x5447da),'ack':!![]});}async function saveCompletedSequence(_0x13be4b){const _0x2cbb3d=a5_0x1ac9;try{const _0x59f516=await _0x13be4b[_0x2cbb3d(0x200)](_0x2cbb3d(0x1c4));let _0x3889c5=[];if(_0x59f516&&_0x59f516[_0x2cbb3d(0x1b0)])try{_0x3889c5=JSON[_0x2cbb3d(0x1a1)](_0x59f516['val']);}catch(_0xf645ae){}const _0x4b59f1=activeSequence[0x0]['ts'],_0x3bd3d7=activeSequence['map'](_0x2cf584=>({'loc':_0x2cf584[_0x2cbb3d(0x1d8)],'t_delta':Math[_0x2cbb3d(0x1d6)]((_0x2cf584['ts']-_0x4b59f1)/0x3e8)})),_0x5bd440={'timestamp':new Date(_0x4b59f1)[_0x2cbb3d(0x1c2)](),'steps':_0x3bd3d7,'duration':Math[_0x2cbb3d(0x1d6)]((activeSequence[activeSequence[_0x2cbb3d(0x1e4)]-0x1]['ts']-_0x4b59f1)/0x3e8),'daytime':new Date(_0x4b59f1)[_0x2cbb3d(0x1fd)]()};_0x3889c5[_0x2cbb3d(0x1d3)](_0x5bd440);if(_0x3889c5['length']>MAX_TRAINING_SET_SIZE)_0x3889c5['shift']();await _0x13be4b[_0x2cbb3d(0x1bc)]('LTM.trainingData.sequences',{'val':JSON[_0x2cbb3d(0x1cf)](_0x3889c5),'ack':!![]}),_0x13be4b[_0x2cbb3d(0x1b8)]&&_0x13be4b[_0x2cbb3d(0x1e7)]&&_0x13be4b[_0x2cbb3d(0x1e7)](_0x2cbb3d(0x1f0),{'sequence':_0x5bd440});}catch(_0x596487){_0x13be4b[_0x2cbb3d(0x1c6)]['error'](_0x2cbb3d(0x1a8)+_0x596487[_0x2cbb3d(0x1b4)]);}}async function recordSequence(_0x36d5a9,_0x1ecc58){const _0x511f35=a5_0x1ac9,_0x7d830d=(_0x1ecc58[_0x511f35(0x1be)]||'')[_0x511f35(0x1f4)](),_0x55daf8=[_0x511f35(0x1c3),_0x511f35(0x1e3),_0x511f35(0x1b1),_0x511f35(0x1af),'occupancy',_0x511f35(0x1b7),'t체r',_0x511f35(0x1ad),_0x511f35(0x1f7),_0x511f35(0x1d7),'kontakt','light',_0x511f35(0x1df),_0x511f35(0x202),_0x511f35(0x1a0),'dimmer',_0x511f35(0x1bf)];if(!_0x55daf8[_0x511f35(0x1a6)](_0xca35d=>_0x7d830d[_0x511f35(0x1b6)](_0xca35d)))return;if(!_0x1ecc58[_0x511f35(0x1f1)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x1ecc58[_0x511f35(0x1fe)]||_0x511f35(0x1c8),'id':_0x1ecc58['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{const _0x4b5c09=_0x511f35;if(activeSequence[_0x4b5c09(0x1e4)]>0x1)await saveCompletedSequence(_0x36d5a9);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}function a5_0x1ac9(_0x5b55c8,_0x10ae8d){const _0x30b86b=a5_0x1ff1();return a5_0x1ac9=function(_0x55810d,_0x490af1){_0x55810d=_0x55810d-0x199;let _0x1ff1a5=_0x30b86b[_0x55810d];return _0x1ff1a5;},a5_0x1ac9(_0x5b55c8,_0x10ae8d);}function startExitTimer(_0x4268a8){const _0x314263=a5_0x1ac9;abortExitTimer(_0x4268a8),_0x4268a8['isGracePeriodActive']=!![],_0x4268a8[_0x314263(0x1dd)]=setTimeout(()=>{const _0x310c5d=_0x314263;_0x4268a8[_0x310c5d(0x1a5)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4268a8[_0x314263(0x1c5)]=setTimeout(()=>{const _0x45d16a=_0x314263;setPresence(_0x4268a8,![]),_0x4268a8[_0x45d16a(0x1c5)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x13f0fd){const _0x241557=a5_0x1ac9;if(_0x13f0fd[_0x241557(0x1c5)])clearTimeout(_0x13f0fd['exitTimer']);if(_0x13f0fd[_0x241557(0x1dd)])clearTimeout(_0x13f0fd['exitGraceTimer']);_0x13f0fd['exitTimer']=null,_0x13f0fd[_0x241557(0x1dd)]=null,_0x13f0fd[_0x241557(0x1a5)]=![];}async function setPresence(_0x1e6a9b,_0x32392a){const _0x5a411d=a5_0x1ac9;if(_0x1e6a9b['isPresent']===_0x32392a)return;_0x1e6a9b['isPresent']=_0x32392a,await _0x1e6a9b[_0x5a411d(0x1bc)](_0x5a411d(0x19b),{'val':_0x32392a,'ack':!![]});}async function processSensorEvent(_0x6a090c,_0x5a411a,_0x1fcd7a,_0x2d407e){const _0x131f40=a5_0x1ac9;if(!_0x2d407e)return null;const _0x28a40b=_0x1fcd7a[_0x131f40(0x1b0)],_0x171b3a=Date['now'](),_0x5b27fd=_0x6a090c['sensorLastValues'][_0x5a411a],_0x3beef5=(_0x2d407e[_0x131f40(0x1be)]||'')[_0x131f40(0x1f4)](),_0x3ba6f6=_0x3beef5[_0x131f40(0x1b6)](_0x131f40(0x1c9))||_0x3beef5['includes']('temperatur')||_0x3beef5[_0x131f40(0x1b6)](_0x131f40(0x1a9))||_0x3beef5[_0x131f40(0x1b6)]('heizung')||_0x3beef5[_0x131f40(0x1b6)](_0x131f40(0x1fa));if(_0x3ba6f6&&typeof _0x28a40b===_0x131f40(0x1f9)){if(_0x28a40b>0x50||_0x28a40b<-0x32)return _0x6a090c[_0x131f40(0x1c6)]['debug']('[RECORDER]\x20Ignored\x20implausible\x20temperature:\x20'+_0x28a40b+_0x131f40(0x1e8)+_0x5a411a),null;}_0x6a090c[_0x131f40(0x1a2)][_0x5a411a]=_0x28a40b;if(!_0x2d407e[_0x131f40(0x1e6)]&&_0x5b27fd!=undefined&&_0x5b27fd==_0x28a40b)return null;_0x6a090c[_0x131f40(0x1b8)]&&_0x3ba6f6&&recordThermodynamics(_0x6a090c,_0x5a411a,_0x28a40b,_0x2d407e[_0x131f40(0x1fe)]);const _0x4bf205={'timestamp':_0x171b3a,'id':_0x5a411a,'name':_0x2d407e[_0x131f40(0x1f3)],'type':_0x2d407e[_0x131f40(0x1be)],'location':_0x2d407e[_0x131f40(0x1fe)],'value':_0x28a40b};_0x6a090c['eventHistory']['unshift'](_0x4bf205);if(_0x6a090c[_0x131f40(0x1ef)][_0x131f40(0x1e4)]>HISTORY_MAX_SIZE)_0x6a090c['eventHistory'][_0x131f40(0x1dc)]();await _0x6a090c[_0x131f40(0x1bc)](_0x131f40(0x1a7),{'val':JSON[_0x131f40(0x1cf)](_0x4bf205),'ack':!![]}),await _0x6a090c['setStateAsync'](_0x131f40(0x1aa),{'val':JSON[_0x131f40(0x1cf)](_0x6a090c[_0x131f40(0x1ef)]),'ack':!![]});if(_0x6a090c[_0x131f40(0x1b8)]){_0x6a090c[_0x131f40(0x199)][_0x131f40(0x1d3)](_0x4bf205);if(_0x6a090c[_0x131f40(0x199)]['length']>RAW_LOG_MAX_SIZE)_0x6a090c[_0x131f40(0x199)]['splice'](0x0,_0x6a090c[_0x131f40(0x199)]['length']-RAW_LOG_MAX_SIZE);await _0x6a090c[_0x131f40(0x1bc)](_0x131f40(0x1e1),{'val':JSON['stringify'](_0x6a090c['rawEventLog']),'ack':!![]}),recordSequence(_0x6a090c,_0x4bf205);}if(_0x2d407e['isExit']&&_0x28a40b===!![]){if(_0x6a090c[_0x131f40(0x1e2)]&&!_0x6a090c[_0x131f40(0x1a5)])startExitTimer(_0x6a090c);else{if(!_0x6a090c[_0x131f40(0x1e2)])setPresence(_0x6a090c,!![]);}}else{if(_0x2d407e['type']==='motion'&&_0x28a40b===!![]){if(_0x6a090c['exitTimer'])abortExitTimer(_0x6a090c);if(!_0x6a090c[_0x131f40(0x1e2)]&&_0x6a090c['currentSystemMode']===_0x131f40(0x1db))setPresence(_0x6a090c,!![]);}}if(_0x6a090c[_0x131f40(0x1b8)]&&_0x6a090c[_0x131f40(0x1e7)]){_0x2d407e[_0x131f40(0x1be)]===_0x131f40(0x1c3)&&_0x28a40b===!![]&&_0x2d407e[_0x131f40(0x1fe)]&&_0x6a090c[_0x131f40(0x1e7)](_0x131f40(0x201),{'room':_0x2d407e[_0x131f40(0x1fe)]});const _0x15a23c=[_0x131f40(0x1b7),'t체r',_0x131f40(0x1ad),_0x131f40(0x1f7),_0x131f40(0x1ff),_0x131f40(0x1ab),'lock','schloss']['some'](_0x13c142=>_0x3beef5['includes'](_0x13c142)),_0x1242bb=[_0x131f40(0x1da),_0x131f40(0x1df),_0x131f40(0x202),_0x131f40(0x1a0),_0x131f40(0x1c1),_0x131f40(0x1bf)][_0x131f40(0x1a6)](_0x3285e1=>_0x3beef5[_0x131f40(0x1b6)](_0x3285e1)),_0xce0e11=[_0x131f40(0x1c3),_0x131f40(0x1e3),'pr채senz',_0x131f40(0x1af),'occupancy'][_0x131f40(0x1a6)](_0x25fe6b=>_0x3beef5[_0x131f40(0x1b6)](_0x25fe6b));if(_0x2d407e['location']&&(_0x15a23c||_0x1242bb||_0xce0e11)){const _0xb6b389=_0x28a40b===!![]||typeof _0x28a40b===_0x131f40(0x1f9)&&_0x28a40b>0x0,_0x113568=_0x15a23c&&!_0xb6b389&&_0x5b27fd!==undefined&&_0x5b27fd!=_0x28a40b;if(_0xb6b389||_0x113568){const _0x2ea742=_0x6a090c[_0x131f40(0x1f8)]||_0x171b3a,_0x85f6a3=(_0x171b3a-_0x2ea742)/0x3e8;_0x6a090c[_0x131f40(0x1f8)]=_0x171b3a,_0x6a090c[_0x131f40(0x1e7)]('TRACK_EVENT',{'room':_0x2d407e[_0x131f40(0x1fe)],'dt':_0x85f6a3});}}}return _0x4bf205;}module[a5_0xf0d2a4(0x1ed)]={'processSensorEvent':processSensorEvent,'getOutsideTemperatureNumeric':getOutsideTemperatureNumeric,'setPresence':setPresence,'abortExitTimer':abortExitTimer,'startExitTimer':startExitTimer};