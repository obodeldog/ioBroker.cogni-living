function a2_0x4ab5(_0x1f0765,_0x46cd23){const _0x9c5c65=a2_0x8335();return a2_0x4ab5=function(_0x98337,_0x1d8da4){_0x98337=_0x98337-0x1af;let _0x833503=_0x9c5c65[_0x98337];return _0x833503;},a2_0x4ab5(_0x1f0765,_0x46cd23);}const a2_0x5a38df=a2_0x4ab5;(function(_0x44a5fb,_0x2de916){const _0x16e822=a2_0x4ab5,_0x3e59c1=_0x44a5fb();while(!![]){try{const _0x580499=-parseInt(_0x16e822(0x1d2))/0x1*(parseInt(_0x16e822(0x1c2))/0x2)+-parseInt(_0x16e822(0x1d7))/0x3*(parseInt(_0x16e822(0x1b8))/0x4)+parseInt(_0x16e822(0x1c5))/0x5*(-parseInt(_0x16e822(0x1c0))/0x6)+-parseInt(_0x16e822(0x1af))/0x7*(parseInt(_0x16e822(0x1d8))/0x8)+-parseInt(_0x16e822(0x1be))/0x9*(-parseInt(_0x16e822(0x1b1))/0xa)+-parseInt(_0x16e822(0x1b9))/0xb+parseInt(_0x16e822(0x1b6))/0xc;if(_0x580499===_0x2de916)break;else _0x3e59c1['push'](_0x3e59c1['shift']());}catch(_0x2b615c){_0x3e59c1['push'](_0x3e59c1['shift']());}}}(a2_0x8335,0xd194a));const a2_0x1d8da4=(function(){let _0x783686=!![];return function(_0x1d75a2,_0x290108){const _0x150c3c=_0x783686?function(){const _0x1e64e2=a2_0x4ab5;if(_0x290108){const _0x24b2cf=_0x290108[_0x1e64e2(0x1d3)](_0x1d75a2,arguments);return _0x290108=null,_0x24b2cf;}}:function(){};return _0x783686=![],_0x150c3c;};}()),a2_0x98337=a2_0x1d8da4(this,function(){const _0x4e6cc6=a2_0x4ab5;return a2_0x98337['toString']()[_0x4e6cc6(0x1e3)](_0x4e6cc6(0x1da))['toString']()['constructor'](a2_0x98337)[_0x4e6cc6(0x1e3)](_0x4e6cc6(0x1da));});a2_0x98337();'use strict';const setup=require(a2_0x5a38df(0x1dd));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x8335(){const _0x50e539=['analysis.safety.deadMan.alarmState','21150urVYNz','setStateAsync','732LvkJZG','%).\x20VerlÃ¤ngere\x20Timer\x20fÃ¼r\x20','wohn','2285xoPcPr','sendNotification','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','stringify','getHours','analysis.safety.deadMan.currentRoom','warn','[DeadMan]\x20','Unknown','toLowerCase','now','toFixed','alarm','4499snzPoI','apply','living','default','info','39723ERSGGn','632CDNLIH','exports','(((.+)+)+)+$','pre_warn','analysis.safety.deadMan.config','./setup','parse','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','val','analysis.safety.deadMan.lastIgnored','includes','search','message','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','replace','111538AfYoQo','.\x20Alles\x20in\x20Ordnung?','523280qhJdIm','\x20fÃ¼r\x20','analysis.safety.deadMan.napProbability','getStateAsync','log','66499968InWxyu','schlaf','20UzqbkI','17800024VzkcKF','indexOf','analysis.safety.deadMan.smartSleep','\x20Min.','analysis.topology.structure','261bQAMJM'];a2_0x8335=function(){return _0x50e539;};return a2_0x8335();}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};function getTimeoutRobust(_0x23ea1a,_0x25e08a){const _0x501dc9=a2_0x5a38df;if(!_0x23ea1a||!_0x25e08a)return undefined;if(_0x23ea1a[_0x25e08a])return _0x23ea1a[_0x25e08a];const _0x26f7d6=_0x25e08a[_0x501dc9(0x1ce)]()[_0x501dc9(0x1e6)](/[^a-z0-9]/g,'');for(const _0xc45aa9 in _0x23ea1a){const _0x2c1db7=_0xc45aa9[_0x501dc9(0x1ce)]()['replace'](/[^a-z0-9]/g,'');if(_0x2c1db7===_0x26f7d6)return _0x23ea1a[_0xc45aa9];}const _0x562845=_0x25e08a[_0x501dc9(0x1ce)]();if(_0x23ea1a[_0x562845])return _0x23ea1a[_0x562845];return undefined;}async function loadConfig(_0x502b10){const _0x24627c=a2_0x5a38df;try{const _0x255d6e=await _0x502b10[_0x24627c(0x1b4)](_0x24627c(0x1dc));if(_0x255d6e&&_0x255d6e['val'])return JSON[_0x24627c(0x1de)](_0x255d6e[_0x24627c(0x1e0)]);}catch(_0x21c524){}return{};}async function isActive(_0x2aa3ae){try{const _0x55214e=await _0x2aa3ae['getStateAsync']('analysis.safety.deadMan.active');return _0x55214e&&_0x55214e['val'];}catch(_0x434761){return![];}}async function areRoomsConnected(_0x127538,_0x558e2d,_0x2b6381){const _0x1dcf9b=a2_0x5a38df;try{const _0x5eb5e1=await _0x127538[_0x1dcf9b(0x1b4)](_0x1dcf9b(0x1bd));if(!_0x5eb5e1||!_0x5eb5e1[_0x1dcf9b(0x1e0)])return!![];const _0x44db31=JSON[_0x1dcf9b(0x1de)](_0x5eb5e1[_0x1dcf9b(0x1e0)]),{rooms:_0x30ab16,matrix:_0x3a840e}=_0x44db31;if(!_0x30ab16||!_0x3a840e)return!![];const _0x14a124=_0x30ab16[_0x1dcf9b(0x1ba)](_0x558e2d),_0x1fab9e=_0x30ab16['indexOf'](_0x2b6381);if(_0x14a124===-0x1||_0x1fab9e===-0x1)return!![];const _0x2ff7ea=_0x3a840e[_0x14a124][_0x1fab9e]>0x0||_0x3a840e[_0x1fab9e][_0x14a124]>0x0;return _0x2ff7ea;}catch(_0x4a5280){return _0x127538[_0x1dcf9b(0x1b5)][_0x1dcf9b(0x1cb)]('[DeadMan]\x20Topology\x20check\x20failed:\x20'+_0x4a5280[_0x1dcf9b(0x1e4)]),!![];}}function calculateSleepProbability(_0x524297){const _0x3b1b4f=a2_0x5a38df,_0x50fe61=new Date(),_0x3889b8=_0x50fe61[_0x3b1b4f(0x1c9)](),_0x455e0c=_0x524297[_0x3b1b4f(0x1ce)]();let _0x131275=0.1;if(_0x3889b8>=0x17||_0x3889b8<=0x6)_0x131275=0x1;else{if(_0x3889b8>=0xd&&_0x3889b8<=0xf)_0x131275=0.8;else{if(_0x3889b8>=0x14&&_0x3889b8<=0x17)_0x131275=0.4;}}let _0x499c53=0.1;if(_0x455e0c[_0x3b1b4f(0x1e2)](_0x3b1b4f(0x1b7))||_0x455e0c[_0x3b1b4f(0x1e2)]('bed'))_0x499c53=0x1;else{if(_0x455e0c[_0x3b1b4f(0x1e2)](_0x3b1b4f(0x1c4))||_0x455e0c[_0x3b1b4f(0x1e2)](_0x3b1b4f(0x1d4))||_0x455e0c[_0x3b1b4f(0x1e2)]('sofa'))_0x499c53=0.6;else{if(_0x455e0c[_0x3b1b4f(0x1e2)]('bad')||_0x455e0c[_0x3b1b4f(0x1e2)]('wc'))_0x499c53=0.05;}}let _0x120e93=0.5;const _0x1bc410=_0x499c53*0.5+_0x131275*0.3+_0x120e93*0.2;return parseFloat(_0x1bc410[_0x3b1b4f(0x1d0)](0x2));}async function updateLocation(_0xe78866,_0x81a140){const _0x1da89f=a2_0x5a38df;if(!_0x81a140||_0x81a140===_0x1da89f(0x1cd))return;if(!await isActive(_0xe78866)){resetTimer(_0xe78866);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x81a140){const _0x5979e1=await areRoomsConnected(_0xe78866,currentMonitoredRoom,_0x81a140);if(!_0x5979e1){const _0x3865b6='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x81a140+_0x1da89f(0x1c7)+currentMonitoredRoom+'\x27.';_0xe78866['log']['info']('[DeadMan]\x20'+_0x3865b6+'\x20(Multi-Person\x20Filter)'),await _0xe78866[_0x1da89f(0x1c1)](_0x1da89f(0x1e1),{'val':JSON[_0x1da89f(0x1c8)]({'room':_0x81a140,'reason':_0x3865b6,'timestamp':Date[_0x1da89f(0x1cf)]()}),'ack':!![]});return;}resetTimer(_0xe78866);}if(!currentMonitoredRoom){await _0xe78866[_0x1da89f(0x1c1)](_0x1da89f(0x1ca),{'val':_0x81a140,'ack':!![]});const _0x521a7b=await loadConfig(_0xe78866);let _0x27b7bc=getTimeoutRobust(_0x521a7b,_0x81a140);const _0x16c129=_0x81a140['toLowerCase']();if(!_0x27b7bc)for(const _0x5c63c6 in DEFAULT_TIMEOUTS){if(_0x16c129[_0x1da89f(0x1e2)](_0x5c63c6)){_0x27b7bc=DEFAULT_TIMEOUTS[_0x5c63c6];break;}}if(!_0x27b7bc&&_0x521a7b[_0x1da89f(0x1d5)])_0x27b7bc=_0x521a7b[_0x1da89f(0x1d5)];if(!_0x27b7bc)return;currentMonitoredRoom=_0x81a140,startTimer(_0xe78866,_0x27b7bc,_0x81a140);}}function startTimer(_0x9240a3,_0x1b14fd,_0x46de53){const _0x5b0ead=a2_0x5a38df;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x1b14fd*0x3c*0x3e8,startTime=Date[_0x5b0ead(0x1cf)](),alarmStage=0x0;const _0x18589c=calculateSleepProbability(_0x46de53||currentMonitoredRoom),_0x1d6e36=_0x18589c>0.65;_0x1d6e36?(timeoutMs+=0x5a*0x3c*0x3e8,_0x9240a3[_0x5b0ead(0x1b5)][_0x5b0ead(0x1d6)]('ðŸ’¤\x20Smart\x20Sleep\x20erkannt\x20('+(_0x18589c*0x64)[_0x5b0ead(0x1d0)](0x0)+_0x5b0ead(0x1c3)+currentMonitoredRoom+'\x20um\x2090\x20Min.'),_0x9240a3[_0x5b0ead(0x1c1)](_0x5b0ead(0x1bb),{'val':!![],'ack':!![]})):_0x9240a3['setStateAsync']('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0x9240a3['setStateAsync'](_0x5b0ead(0x1b3),{'val':_0x18589c,'ack':!![]}),_0x9240a3['log'][_0x5b0ead(0x1d6)]('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+_0x5b0ead(0x1b2)+_0x1b14fd+_0x5b0ead(0x1bc)),_0x9240a3[_0x5b0ead(0x1c1)](_0x5b0ead(0x1bf),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x9240a3),timeoutMs);}function resetTimer(_0x348fbf){const _0x974b78=a2_0x5a38df;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x348fbf['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),_0x348fbf[_0x974b78(0x1c1)](_0x974b78(0x1bb),{'val':![],'ack':!![]}),_0x348fbf[_0x974b78(0x1c1)](_0x974b78(0x1b3),{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x1eab0d){const _0x2fd461=a2_0x5a38df;alarmStage=0x1,await _0x1eab0d[_0x2fd461(0x1c1)]('analysis.safety.deadMan.alarmState',{'val':_0x2fd461(0x1db),'ack':!![]});const _0x1c03ed=_0x2fd461(0x1df)+currentMonitoredRoom+_0x2fd461(0x1b0);_0x1eab0d['log'][_0x2fd461(0x1cb)](_0x2fd461(0x1cc)+_0x1c03ed),await setup[_0x2fd461(0x1c6)](_0x1eab0d,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x1c03ed),activeTimer=setTimeout(()=>triggerAlarm(_0x1eab0d),0x5*0x3c*0x3e8);}async function triggerAlarm(_0xa6f26e){const _0x1efd7d=a2_0x5a38df;alarmStage=0x2,await _0xa6f26e[_0x1efd7d(0x1c1)]('analysis.safety.deadMan.alarmState',{'val':_0x1efd7d(0x1d1),'ack':!![]});const _0x2fe421=_0x1efd7d(0x1e5)+currentMonitoredRoom+'!';_0xa6f26e[_0x1efd7d(0x1b5)]['error'](_0x1efd7d(0x1cc)+_0x2fe421),await setup[_0x1efd7d(0x1c6)](_0xa6f26e,_0x2fe421,![],!![]);}module[a2_0x5a38df(0x1d9)]={'updateLocation':updateLocation};