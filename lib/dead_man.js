function a2_0x3b08(_0x1c4bc4,_0x1ec479){const _0x4af79a=a2_0x7526();return a2_0x3b08=function(_0x58de75,_0x254a7a){_0x58de75=_0x58de75-0x1e1;let _0x75263=_0x4af79a[_0x58de75];return _0x75263;},a2_0x3b08(_0x1c4bc4,_0x1ec479);}const a2_0xf88072=a2_0x3b08;(function(_0x2075d5,_0xf7be27){const _0x486a5c=a2_0x3b08,_0x21423c=_0x2075d5();while(!![]){try{const _0x3e3cbd=parseInt(_0x486a5c(0x207))/0x1*(-parseInt(_0x486a5c(0x1e7))/0x2)+parseInt(_0x486a5c(0x1e2))/0x3*(-parseInt(_0x486a5c(0x1f7))/0x4)+parseInt(_0x486a5c(0x1e8))/0x5+parseInt(_0x486a5c(0x20e))/0x6*(-parseInt(_0x486a5c(0x1e4))/0x7)+-parseInt(_0x486a5c(0x1eb))/0x8+parseInt(_0x486a5c(0x1ef))/0x9*(parseInt(_0x486a5c(0x1ea))/0xa)+-parseInt(_0x486a5c(0x1ee))/0xb*(-parseInt(_0x486a5c(0x200))/0xc);if(_0x3e3cbd===_0xf7be27)break;else _0x21423c['push'](_0x21423c['shift']());}catch(_0x44e938){_0x21423c['push'](_0x21423c['shift']());}}}(a2_0x7526,0x62bb0));const a2_0x254a7a=(function(){let _0x276807=!![];return function(_0x10714e,_0x12db52){const _0x12096d=_0x276807?function(){const _0x14480e=a2_0x3b08;if(_0x12db52){const _0xd24466=_0x12db52[_0x14480e(0x1fe)](_0x10714e,arguments);return _0x12db52=null,_0xd24466;}}:function(){};return _0x276807=![],_0x12096d;};}()),a2_0x58de75=a2_0x254a7a(this,function(){const _0x203067=a2_0x3b08;return a2_0x58de75[_0x203067(0x205)]()[_0x203067(0x1ec)]('(((.+)+)+)+$')[_0x203067(0x205)]()[_0x203067(0x20b)](a2_0x58de75)[_0x203067(0x1ec)](_0x203067(0x1f2));});a2_0x58de75();'use strict';const setup=require(a2_0xf88072(0x206));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x7526(){const _0x32dd89=['Ignoriere\x20Bewegung\x20in\x20\x27','\x20(Multi-Person\x20Filter)','exports','getStateAsync','setStateAsync','analysis.safety.deadMan.alarmState','apply','message','204rVNKAn','warn','analysis.safety.deadMan.active','ðŸ‘¼\x20Schutzengel-Frage:\x20','sendNotification','toString','./setup','1BWkCRq','val','analysis.topology.structure','now','constructor','info','[DeadMan]\x20','90tVijZO','indexOf','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','15kPRfXz','toLowerCase','332647OTCDLe','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','analysis.safety.deadMan.currentRoom','521974GUcUWS','3416610IleseU','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','62080bOpmeG','1453400tWfEbE','search','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','302412NshsJI','648gAmEYe','analysis.safety.deadMan.lastIgnored','error','(((.+)+)+)+$','log','[DeadMan]\x20Topology\x20check\x20failed:\x20','.\x20Alles\x20in\x20Ordnung?','default','30228vIABBD'];a2_0x7526=function(){return _0x32dd89;};return a2_0x7526();}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x4a71f3){const _0x3e9917=a2_0xf88072;try{const _0x310741=await _0x4a71f3['getStateAsync']('analysis.safety.deadMan.config');if(_0x310741&&_0x310741[_0x3e9917(0x208)])return JSON['parse'](_0x310741[_0x3e9917(0x208)]);}catch(_0x35f00b){}return{};}async function isActive(_0x33fd5f){const _0x43d58e=a2_0xf88072;try{const _0x100e06=await _0x33fd5f['getStateAsync'](_0x43d58e(0x202));return _0x100e06&&_0x100e06['val'];}catch(_0x582c8a){return![];}}async function areRoomsConnected(_0x2c843f,_0x467a8a,_0x2d4e72){const _0x4dbb21=a2_0xf88072;try{const _0xfcf20a=await _0x2c843f[_0x4dbb21(0x1fb)](_0x4dbb21(0x209));if(!_0xfcf20a||!_0xfcf20a[_0x4dbb21(0x208)])return!![];const _0xdf33bc=JSON['parse'](_0xfcf20a[_0x4dbb21(0x208)]),{rooms:_0x43d925,matrix:_0x131f96}=_0xdf33bc;if(!_0x43d925||!_0x131f96)return!![];const _0x3afd06=_0x43d925[_0x4dbb21(0x20f)](_0x467a8a),_0x3a7e79=_0x43d925[_0x4dbb21(0x20f)](_0x2d4e72);if(_0x3afd06===-0x1||_0x3a7e79===-0x1)return!![];const _0x431b18=_0x131f96[_0x3afd06][_0x3a7e79]>0x0||_0x131f96[_0x3a7e79][_0x3afd06]>0x0;return _0x431b18;}catch(_0x529b2f){return _0x2c843f['log'][_0x4dbb21(0x201)](_0x4dbb21(0x1f4)+_0x529b2f[_0x4dbb21(0x1ff)]),!![];}}async function updateLocation(_0x1bfd86,_0x58fd03){const _0x4b8668=a2_0xf88072;if(!_0x58fd03||_0x58fd03==='Unknown')return;if(!await isActive(_0x1bfd86)){resetTimer(_0x1bfd86);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x58fd03){const _0x5509ed=await areRoomsConnected(_0x1bfd86,currentMonitoredRoom,_0x58fd03);if(!_0x5509ed){const _0x385e1e=_0x4b8668(0x1f8)+_0x58fd03+_0x4b8668(0x1e1)+currentMonitoredRoom+'\x27.';_0x1bfd86[_0x4b8668(0x1f3)][_0x4b8668(0x20c)](_0x4b8668(0x20d)+_0x385e1e+_0x4b8668(0x1f9)),await _0x1bfd86['setStateAsync'](_0x4b8668(0x1f0),{'val':JSON['stringify']({'room':_0x58fd03,'reason':_0x385e1e,'timestamp':Date[_0x4b8668(0x20a)]()}),'ack':!![]});return;}resetTimer(_0x1bfd86);}if(!currentMonitoredRoom){await _0x1bfd86[_0x4b8668(0x1fc)](_0x4b8668(0x1e6),{'val':_0x58fd03,'ack':!![]});const _0x54a924=await loadConfig(_0x1bfd86),_0x233479=_0x58fd03[_0x4b8668(0x1e3)]();let _0x20614f=_0x54a924[_0x58fd03]||_0x54a924[_0x233479];if(!_0x20614f)for(const _0x11186a in DEFAULT_TIMEOUTS){if(_0x233479['includes'](_0x11186a)){_0x20614f=DEFAULT_TIMEOUTS[_0x11186a];break;}}if(!_0x20614f&&_0x54a924['default'])_0x20614f=_0x54a924[_0x4b8668(0x1f6)];if(!_0x20614f)return;currentMonitoredRoom=_0x58fd03,startTimer(_0x1bfd86,_0x20614f);}}function startTimer(_0x17b4cd,_0x4edc82){const _0x3dd0d9=a2_0xf88072;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x4edc82*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0,_0x17b4cd[_0x3dd0d9(0x1f3)][_0x3dd0d9(0x20c)](_0x3dd0d9(0x1e5)+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0x4edc82+'\x20Min.'),_0x17b4cd['setStateAsync'](_0x3dd0d9(0x1fd),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x17b4cd),timeoutMs);}function resetTimer(_0x288475){const _0x122765=a2_0xf88072;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x288475[_0x122765(0x1fc)](_0x122765(0x1fd),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x19c766){const _0x30b8ec=a2_0xf88072;alarmStage=0x1,await _0x19c766[_0x30b8ec(0x1fc)]('analysis.safety.deadMan.alarmState',{'val':'pre_warn','ack':!![]});const _0x2ad8e7=_0x30b8ec(0x1ed)+currentMonitoredRoom+_0x30b8ec(0x1f5);_0x19c766[_0x30b8ec(0x1f3)][_0x30b8ec(0x201)](_0x30b8ec(0x20d)+_0x2ad8e7),await setup[_0x30b8ec(0x204)](_0x19c766,_0x30b8ec(0x203)+_0x2ad8e7),activeTimer=setTimeout(()=>triggerAlarm(_0x19c766),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x4342e5){const _0x555ccb=a2_0xf88072;alarmStage=0x2,await _0x4342e5[_0x555ccb(0x1fc)](_0x555ccb(0x1fd),{'val':'alarm','ack':!![]});const _0x15775e=_0x555ccb(0x1e9)+currentMonitoredRoom+'!';_0x4342e5[_0x555ccb(0x1f3)][_0x555ccb(0x1f1)](_0x555ccb(0x20d)+_0x15775e),await setup[_0x555ccb(0x204)](_0x4342e5,_0x15775e,![],!![]);}module[a2_0xf88072(0x1fa)]={'updateLocation':updateLocation};