const a2_0x451340=a2_0x461c;(function(_0x74468a,_0x5535a1){const _0x2d3870=a2_0x461c,_0x4af3c0=_0x74468a();while(!![]){try{const _0x13189e=-parseInt(_0x2d3870(0x9a))/0x1*(-parseInt(_0x2d3870(0xa3))/0x2)+-parseInt(_0x2d3870(0x85))/0x3+-parseInt(_0x2d3870(0x7a))/0x4*(parseInt(_0x2d3870(0x8f))/0x5)+-parseInt(_0x2d3870(0x7d))/0x6*(-parseInt(_0x2d3870(0x96))/0x7)+parseInt(_0x2d3870(0x9e))/0x8*(-parseInt(_0x2d3870(0x80))/0x9)+-parseInt(_0x2d3870(0x88))/0xa+parseInt(_0x2d3870(0x81))/0xb;if(_0x13189e===_0x5535a1)break;else _0x4af3c0['push'](_0x4af3c0['shift']());}catch(_0x34f0a7){_0x4af3c0['push'](_0x4af3c0['shift']());}}}(a2_0x437e,0xe30f8));const a2_0x22d9b9=(function(){let _0x7a1c60=!![];return function(_0x189ea6,_0x90fd0d){const _0x5b77fe=_0x7a1c60?function(){const _0x59252b=a2_0x461c;if(_0x90fd0d){const _0xa665a6=_0x90fd0d[_0x59252b(0x95)](_0x189ea6,arguments);return _0x90fd0d=null,_0xa665a6;}}:function(){};return _0x7a1c60=![],_0x5b77fe;};}()),a2_0x51d572=a2_0x22d9b9(this,function(){const _0x591f23=a2_0x461c;return a2_0x51d572['toString']()[_0x591f23(0x76)](_0x591f23(0xa0))[_0x591f23(0x7e)]()[_0x591f23(0x99)](a2_0x51d572)[_0x591f23(0x76)](_0x591f23(0xa0));});a2_0x51d572();'use strict';function a2_0x437e(){const _0x1a1e0c=['\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','3251208hrnBPZ','includes','(((.+)+)+)+$','toLowerCase','analysis.safety.deadMan.config','2RacGPc','analysis.safety.deadMan.currentRoom','search','\x20Min.','default','message','3044sjxzuo','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','66gnlcFe','toString','now','9adYVUk','28136020joNTIF','pre_warn','Unknown','val','3944022gONZXE','\x20fÃ¼r\x20','[DeadMan]\x20Topology\x20check\x20failed:\x20','1464870QURHZV','alarm','setStateAsync','error','[DeadMan]\x20','log','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','8180WUiVTd','analysis.safety.deadMan.alarmState','sendNotification','parse','./setup','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','apply','923874RBYriQ','warn','.\x20Alles\x20in\x20Ordnung?','constructor','32976KFIUky','info','getStateAsync'];a2_0x437e=function(){return _0x1a1e0c;};return a2_0x437e();}function a2_0x461c(_0x4ad47d,_0x40029a){const _0x21d4b3=a2_0x437e();return a2_0x461c=function(_0x51d572,_0x22d9b9){_0x51d572=_0x51d572-0x75;let _0x437e20=_0x21d4b3[_0x51d572];return _0x437e20;},a2_0x461c(_0x4ad47d,_0x40029a);}const setup=require(a2_0x451340(0x93));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x32b1b1){const _0x394966=a2_0x451340;try{const _0x34bff2=await _0x32b1b1[_0x394966(0x9c)](_0x394966(0xa2));if(_0x34bff2&&_0x34bff2[_0x394966(0x84)])return JSON[_0x394966(0x92)](_0x34bff2[_0x394966(0x84)]);}catch(_0xff4a28){}return{};}async function isActive(_0x148760){try{const _0xc5c02=await _0x148760['getStateAsync']('analysis.safety.deadMan.active');return _0xc5c02&&_0xc5c02['val'];}catch(_0x44c32c){return![];}}async function areRoomsConnected(_0x222bb6,_0x1ffd1d,_0x2576c1){const _0x298099=a2_0x451340;try{const _0x3038a1=await _0x222bb6['getStateAsync']('analysis.topology.structure');if(!_0x3038a1||!_0x3038a1[_0x298099(0x84)])return!![];const _0x326e1b=JSON[_0x298099(0x92)](_0x3038a1[_0x298099(0x84)]),{rooms:_0x127cfa,matrix:_0x35cb9c}=_0x326e1b;if(!_0x127cfa||!_0x35cb9c)return!![];const _0x3a326d=_0x127cfa['indexOf'](_0x1ffd1d),_0x3c01d3=_0x127cfa['indexOf'](_0x2576c1);if(_0x3a326d===-0x1||_0x3c01d3===-0x1)return!![];const _0xf7ee5f=_0x35cb9c[_0x3a326d][_0x3c01d3]>0x0||_0x35cb9c[_0x3c01d3][_0x3a326d]>0x0;return _0xf7ee5f;}catch(_0x3824c8){return _0x222bb6[_0x298099(0x8d)][_0x298099(0x97)](_0x298099(0x87)+_0x3824c8[_0x298099(0x79)]),!![];}}async function updateLocation(_0x3dea31,_0x310733){const _0x23e679=a2_0x451340;if(!_0x310733||_0x310733===_0x23e679(0x83))return;if(!await isActive(_0x3dea31)){resetTimer(_0x3dea31);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x310733){const _0x5ec434=await areRoomsConnected(_0x3dea31,currentMonitoredRoom,_0x310733);if(!_0x5ec434){_0x3dea31[_0x23e679(0x8d)]['info'](_0x23e679(0x8e)+_0x310733+_0x23e679(0x9d)+currentMonitoredRoom+'\x27.\x20(Multi-Person\x20Filter)');return;}resetTimer(_0x3dea31);}if(!currentMonitoredRoom){await _0x3dea31[_0x23e679(0x8a)](_0x23e679(0x75),{'val':_0x310733,'ack':!![]});const _0x4455fd=await loadConfig(_0x3dea31),_0x412514=_0x310733[_0x23e679(0xa1)]();let _0x2530a4=_0x4455fd[_0x310733]||_0x4455fd[_0x412514];if(!_0x2530a4)for(const _0x5ac764 in DEFAULT_TIMEOUTS){if(_0x412514[_0x23e679(0x9f)](_0x5ac764)){_0x2530a4=DEFAULT_TIMEOUTS[_0x5ac764];break;}}if(!_0x2530a4&&_0x4455fd[_0x23e679(0x78)])_0x2530a4=_0x4455fd[_0x23e679(0x78)];if(!_0x2530a4)return;currentMonitoredRoom=_0x310733,startTimer(_0x3dea31,_0x2530a4);}}function startTimer(_0x5c825b,_0x51f4ff){const _0x3718f2=a2_0x451340;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x51f4ff*0x3c*0x3e8,startTime=Date[_0x3718f2(0x7f)](),alarmStage=0x0,_0x5c825b[_0x3718f2(0x8d)][_0x3718f2(0x9b)](_0x3718f2(0x94)+currentMonitoredRoom+_0x3718f2(0x86)+_0x51f4ff+_0x3718f2(0x77)),_0x5c825b[_0x3718f2(0x8a)](_0x3718f2(0x90),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x5c825b),timeoutMs);}function resetTimer(_0x3350aa){const _0x52a1c4=a2_0x451340;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x3350aa[_0x52a1c4(0x8a)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x1a27ea){const _0x578e08=a2_0x451340;alarmStage=0x1,await _0x1a27ea[_0x578e08(0x8a)](_0x578e08(0x90),{'val':_0x578e08(0x82),'ack':!![]});const _0x1a7c33=_0x578e08(0x7b)+currentMonitoredRoom+_0x578e08(0x98);_0x1a27ea['log'][_0x578e08(0x97)](_0x578e08(0x8c)+_0x1a7c33),await setup[_0x578e08(0x91)](_0x1a27ea,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x1a7c33),activeTimer=setTimeout(()=>triggerAlarm(_0x1a27ea),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x53c7ea){const _0x4e56fa=a2_0x451340;alarmStage=0x2,await _0x53c7ea[_0x4e56fa(0x8a)](_0x4e56fa(0x90),{'val':_0x4e56fa(0x89),'ack':!![]});const _0xed14fc=_0x4e56fa(0x7c)+currentMonitoredRoom+'!';_0x53c7ea['log'][_0x4e56fa(0x8b)](_0x4e56fa(0x8c)+_0xed14fc),await setup[_0x4e56fa(0x91)](_0x53c7ea,_0xed14fc,![],!![]);}module['exports']={'updateLocation':updateLocation};