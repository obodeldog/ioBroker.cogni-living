function a2_0x581b(_0x57b618,_0x51ce0a){const _0x421a55=a2_0x143e();return a2_0x581b=function(_0x3a8a9c,_0x142dc1){_0x3a8a9c=_0x3a8a9c-0x112;let _0x143e0c=_0x421a55[_0x3a8a9c];return _0x143e0c;},a2_0x581b(_0x57b618,_0x51ce0a);}const a2_0x483e32=a2_0x581b;(function(_0x383859,_0x4037bc){const _0x38728a=a2_0x581b,_0x4b8dee=_0x383859();while(!![]){try{const _0x20ef6b=-parseInt(_0x38728a(0x132))/0x1*(parseInt(_0x38728a(0x133))/0x2)+parseInt(_0x38728a(0x12e))/0x3+-parseInt(_0x38728a(0x112))/0x4+parseInt(_0x38728a(0x113))/0x5*(-parseInt(_0x38728a(0x125))/0x6)+parseInt(_0x38728a(0x135))/0x7+parseInt(_0x38728a(0x138))/0x8*(-parseInt(_0x38728a(0x136))/0x9)+-parseInt(_0x38728a(0x13d))/0xa*(-parseInt(_0x38728a(0x131))/0xb);if(_0x20ef6b===_0x4037bc)break;else _0x4b8dee['push'](_0x4b8dee['shift']());}catch(_0x549b83){_0x4b8dee['push'](_0x4b8dee['shift']());}}}(a2_0x143e,0xd9dc4));const a2_0x142dc1=(function(){let _0x512cb4=!![];return function(_0x1b9928,_0x13e001){const _0x1c85bb=_0x512cb4?function(){const _0x37cdb0=a2_0x581b;if(_0x13e001){const _0x153295=_0x13e001[_0x37cdb0(0x12b)](_0x1b9928,arguments);return _0x13e001=null,_0x153295;}}:function(){};return _0x512cb4=![],_0x1c85bb;};}()),a2_0x3a8a9c=a2_0x142dc1(this,function(){const _0x10f176=a2_0x581b;return a2_0x3a8a9c['toString']()['search'](_0x10f176(0x11c))['toString']()['constructor'](a2_0x3a8a9c)[_0x10f176(0x119)](_0x10f176(0x11c));});a2_0x3a8a9c();'use strict';const setup=require(a2_0x483e32(0x11e));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x53e461){const _0x5741a1=a2_0x483e32;try{const _0x28fbf0=await _0x53e461['getStateAsync'](_0x5741a1(0x116));if(_0x28fbf0&&_0x28fbf0[_0x5741a1(0x13f)])return JSON[_0x5741a1(0x12c)](_0x28fbf0[_0x5741a1(0x13f)]);}catch(_0x2b2c85){}return{};}async function isActive(_0x456818){const _0x4a02cc=a2_0x483e32;try{const _0x3045b1=await _0x456818[_0x4a02cc(0x117)](_0x4a02cc(0x140));return _0x3045b1&&_0x3045b1['val'];}catch(_0x2e87bb){return![];}}function a2_0x143e(){const _0x21425b=['now','(((.+)+)+)+$','alarm','./setup','\x20Min.','sendNotification','log','default','analysis.safety.deadMan.lastIgnored','warn','34836QxbNYB','Unknown','[DeadMan]\x20','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','includes','pre_warn','apply','parse','indexOf','3110931RqvedF','toLowerCase','exports','23202421fvPBGU','862048wYCyAb','4kZvyfi','error','5686275FeuUaI','551997qTsDlC','setStateAsync','56UDTnKc','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','stringify','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','info','20yCfcqz','\x20fÃ¼r\x20','val','analysis.safety.deadMan.active','[DeadMan]\x20Topology\x20check\x20failed:\x20','6119996PeGpRi','1285pbTILn','.\x20Alles\x20in\x20Ordnung?','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','analysis.safety.deadMan.config','getStateAsync','analysis.safety.deadMan.alarmState','search','analysis.safety.deadMan.currentRoom'];a2_0x143e=function(){return _0x21425b;};return a2_0x143e();}async function areRoomsConnected(_0x45f8c3,_0x5f02ea,_0x43b900){const _0x5736dc=a2_0x483e32;try{const _0x51d40b=await _0x45f8c3[_0x5736dc(0x117)]('analysis.topology.structure');if(!_0x51d40b||!_0x51d40b[_0x5736dc(0x13f)])return!![];const _0x4586a1=JSON[_0x5736dc(0x12c)](_0x51d40b['val']),{rooms:_0x293bad,matrix:_0x449529}=_0x4586a1;if(!_0x293bad||!_0x449529)return!![];const _0x182097=_0x293bad[_0x5736dc(0x12d)](_0x5f02ea),_0x5545cd=_0x293bad[_0x5736dc(0x12d)](_0x43b900);if(_0x182097===-0x1||_0x5545cd===-0x1)return!![];const _0x56f3b0=_0x449529[_0x182097][_0x5545cd]>0x0||_0x449529[_0x5545cd][_0x182097]>0x0;return _0x56f3b0;}catch(_0x15cd39){return _0x45f8c3[_0x5736dc(0x121)]['warn'](_0x5736dc(0x141)+_0x15cd39['message']),!![];}}async function updateLocation(_0x56aab5,_0x48ea3f){const _0x5a71c7=a2_0x483e32;if(!_0x48ea3f||_0x48ea3f===_0x5a71c7(0x126))return;if(!await isActive(_0x56aab5)){resetTimer(_0x56aab5);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x48ea3f){const _0x7abf27=await areRoomsConnected(_0x56aab5,currentMonitoredRoom,_0x48ea3f);if(!_0x7abf27){const _0x3aa22c='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x48ea3f+_0x5a71c7(0x115)+currentMonitoredRoom+'\x27.';_0x56aab5[_0x5a71c7(0x121)][_0x5a71c7(0x13c)](_0x5a71c7(0x127)+_0x3aa22c+'\x20(Multi-Person\x20Filter)'),await _0x56aab5[_0x5a71c7(0x137)](_0x5a71c7(0x123),{'val':JSON[_0x5a71c7(0x13a)]({'room':_0x48ea3f,'reason':_0x3aa22c,'timestamp':Date[_0x5a71c7(0x11b)]()}),'ack':!![]});return;}resetTimer(_0x56aab5);}if(!currentMonitoredRoom){await _0x56aab5[_0x5a71c7(0x137)](_0x5a71c7(0x11a),{'val':_0x48ea3f,'ack':!![]});const _0x1692ba=await loadConfig(_0x56aab5),_0x95c847=_0x48ea3f[_0x5a71c7(0x12f)]();let _0xf2d5f=_0x1692ba[_0x48ea3f]||_0x1692ba[_0x95c847];if(!_0xf2d5f)for(const _0x3ff97b in DEFAULT_TIMEOUTS){if(_0x95c847[_0x5a71c7(0x129)](_0x3ff97b)){_0xf2d5f=DEFAULT_TIMEOUTS[_0x3ff97b];break;}}if(!_0xf2d5f&&_0x1692ba[_0x5a71c7(0x122)])_0xf2d5f=_0x1692ba[_0x5a71c7(0x122)];if(!_0xf2d5f)return;currentMonitoredRoom=_0x48ea3f,startTimer(_0x56aab5,_0xf2d5f);}}function startTimer(_0x5d49c4,_0x5a874c){const _0x139510=a2_0x483e32;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x5a874c*0x3c*0x3e8,startTime=Date[_0x139510(0x11b)](),alarmStage=0x0,_0x5d49c4[_0x139510(0x121)][_0x139510(0x13c)](_0x139510(0x128)+currentMonitoredRoom+_0x139510(0x13e)+_0x5a874c+_0x139510(0x11f)),_0x5d49c4['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x5d49c4),timeoutMs);}function resetTimer(_0x3249ff){if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x3249ff['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x454328){const _0x2276ed=a2_0x483e32;alarmStage=0x1,await _0x454328[_0x2276ed(0x137)](_0x2276ed(0x118),{'val':_0x2276ed(0x12a),'ack':!![]});const _0x48a34b=_0x2276ed(0x13b)+currentMonitoredRoom+_0x2276ed(0x114);_0x454328['log'][_0x2276ed(0x124)](_0x2276ed(0x127)+_0x48a34b),await setup[_0x2276ed(0x120)](_0x454328,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x48a34b),activeTimer=setTimeout(()=>triggerAlarm(_0x454328),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x305dc9){const _0x4a65ac=a2_0x483e32;alarmStage=0x2,await _0x305dc9[_0x4a65ac(0x137)](_0x4a65ac(0x118),{'val':_0x4a65ac(0x11d),'ack':!![]});const _0x56940f=_0x4a65ac(0x139)+currentMonitoredRoom+'!';_0x305dc9['log'][_0x4a65ac(0x134)](_0x4a65ac(0x127)+_0x56940f),await setup['sendNotification'](_0x305dc9,_0x56940f,![],!![]);}module[a2_0x483e32(0x130)]={'updateLocation':updateLocation};