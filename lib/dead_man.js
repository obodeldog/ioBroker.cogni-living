function a2_0x54d6(){const _0x5e8ea5=['273874wWZCsn','analysis.safety.deadMan.napProbability','594102THxAfz','8987344hBVAhv','getStateAsync','replace','analysis.safety.deadMan.smartSleep','[DeadMan]\x20','\x20(Multi-Person\x20Filter)','default','constructor','43938NqqkKl','sofa','exports','./setup','Ignoriere\x20Bewegung\x20in\x20\x27','message','sendNotification','(((.+)+)+)+$','warn','analysis.safety.deadMan.active','log','search','Unknown','includes','pre_warn','bad','apply','analysis.safety.deadMan.currentRoom','\x20um\x2090\x20Min.','error','analysis.safety.deadMan.lastIgnored','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','now','setStateAsync','%).\x20VerlÃ¤ngere\x20Timer\x20fÃ¼r\x20','toLowerCase','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','analysis.topology.structure','indexOf','[DeadMan]\x20Topology\x20check\x20failed:\x20','info','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','toString','schlaf','analysis.safety.deadMan.alarmState','stringify','val','parse','1906800uOtnkk','bed','getHours','\x20fÃ¼r\x20','48Aeojdf','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','130905HgBxCE','toFixed','1662342umHHkF','ðŸ’¤\x20Smart\x20Sleep\x20erkannt\x20('];a2_0x54d6=function(){return _0x5e8ea5;};return a2_0x54d6();}const a2_0xd4c07a=a2_0x3fc7;function a2_0x3fc7(_0x3110cc,_0x25aa08){const _0x2422ff=a2_0x54d6();return a2_0x3fc7=function(_0x473939,_0x436a75){_0x473939=_0x473939-0x118;let _0x54d600=_0x2422ff[_0x473939];return _0x54d600;},a2_0x3fc7(_0x3110cc,_0x25aa08);}(function(_0x5d7605,_0x117082){const _0x314813=a2_0x3fc7,_0x217197=_0x5d7605();while(!![]){try{const _0x2db4be=-parseInt(_0x314813(0x143))/0x1+-parseInt(_0x314813(0x14e))/0x2+parseInt(_0x314813(0x145))/0x3+parseInt(_0x314813(0x13d))/0x4*(-parseInt(_0x314813(0x13f))/0x5)+-parseInt(_0x314813(0x141))/0x6+-parseInt(_0x314813(0x139))/0x7+parseInt(_0x314813(0x146))/0x8;if(_0x2db4be===_0x117082)break;else _0x217197['push'](_0x217197['shift']());}catch(_0x1ac3f3){_0x217197['push'](_0x217197['shift']());}}}(a2_0x54d6,0x278bc));const a2_0x436a75=(function(){let _0x4c09f2=!![];return function(_0x330c78,_0x3b617c){const _0x4fc168=_0x4c09f2?function(){const _0x45f0f0=a2_0x3fc7;if(_0x3b617c){const _0x3880be=_0x3b617c[_0x45f0f0(0x123)](_0x330c78,arguments);return _0x3b617c=null,_0x3880be;}}:function(){};return _0x4c09f2=![],_0x4fc168;};}()),a2_0x473939=a2_0x436a75(this,function(){const _0x249cf0=a2_0x3fc7;return a2_0x473939[_0x249cf0(0x133)]()[_0x249cf0(0x11e)](_0x249cf0(0x11a))[_0x249cf0(0x133)]()[_0x249cf0(0x14d)](a2_0x473939)['search'](_0x249cf0(0x11a));});a2_0x473939();'use strict';const setup=require(a2_0xd4c07a(0x151));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};function getTimeoutRobust(_0x3a7abf,_0x5cd4f0){const _0x13320c=a2_0xd4c07a;if(!_0x3a7abf||!_0x5cd4f0)return undefined;if(_0x3a7abf[_0x5cd4f0])return _0x3a7abf[_0x5cd4f0];const _0x2a5a39=_0x5cd4f0[_0x13320c(0x12c)]()[_0x13320c(0x148)](/[^a-z0-9]/g,'');for(const _0x121fe4 in _0x3a7abf){const _0x3d7fd0=_0x121fe4[_0x13320c(0x12c)]()['replace'](/[^a-z0-9]/g,'');if(_0x3d7fd0===_0x2a5a39)return _0x3a7abf[_0x121fe4];}const _0xc6067=_0x5cd4f0[_0x13320c(0x12c)]();if(_0x3a7abf[_0xc6067])return _0x3a7abf[_0xc6067];return undefined;}async function loadConfig(_0x191e67){const _0x30ec19=a2_0xd4c07a;try{const _0x59ea26=await _0x191e67[_0x30ec19(0x147)]('analysis.safety.deadMan.config');if(_0x59ea26&&_0x59ea26[_0x30ec19(0x137)])return JSON[_0x30ec19(0x138)](_0x59ea26[_0x30ec19(0x137)]);}catch(_0x1cad43){}return{};}async function isActive(_0x165847){const _0x5b36cd=a2_0xd4c07a;try{const _0x532bf2=await _0x165847[_0x5b36cd(0x147)](_0x5b36cd(0x11c));return _0x532bf2&&_0x532bf2['val'];}catch(_0x7372aa){return![];}}async function areRoomsConnected(_0x5882c6,_0x5b569d,_0x49ff54){const _0x5f2921=a2_0xd4c07a;try{const _0x2b3b2d=await _0x5882c6[_0x5f2921(0x147)](_0x5f2921(0x12e));if(!_0x2b3b2d||!_0x2b3b2d[_0x5f2921(0x137)])return!![];const _0x23ded8=JSON['parse'](_0x2b3b2d[_0x5f2921(0x137)]),{rooms:_0x527695,matrix:_0x49a815}=_0x23ded8;if(!_0x527695||!_0x49a815)return!![];const _0x366658=_0x527695[_0x5f2921(0x12f)](_0x5b569d),_0x13fcbc=_0x527695[_0x5f2921(0x12f)](_0x49ff54);if(_0x366658===-0x1||_0x13fcbc===-0x1)return!![];const _0x64f53c=_0x49a815[_0x366658][_0x13fcbc]>0x0||_0x49a815[_0x13fcbc][_0x366658]>0x0;return _0x64f53c;}catch(_0x4b3946){return _0x5882c6[_0x5f2921(0x11d)][_0x5f2921(0x11b)](_0x5f2921(0x130)+_0x4b3946[_0x5f2921(0x118)]),!![];}}function calculateSleepProbability(_0x28aa14){const _0x1b144b=a2_0xd4c07a,_0x4d27b5=new Date(),_0x2631e1=_0x4d27b5[_0x1b144b(0x13b)](),_0x561211=_0x28aa14[_0x1b144b(0x12c)]();let _0x106884=0.1;if(_0x2631e1>=0x17||_0x2631e1<=0x6)_0x106884=0x1;else{if(_0x2631e1>=0xd&&_0x2631e1<=0xf)_0x106884=0.8;else{if(_0x2631e1>=0x14&&_0x2631e1<=0x17)_0x106884=0.4;}}let _0x569b71=0.1;if(_0x561211[_0x1b144b(0x120)](_0x1b144b(0x134))||_0x561211['includes'](_0x1b144b(0x13a)))_0x569b71=0x1;else{if(_0x561211[_0x1b144b(0x120)]('wohn')||_0x561211[_0x1b144b(0x120)]('living')||_0x561211[_0x1b144b(0x120)](_0x1b144b(0x14f)))_0x569b71=0.6;else{if(_0x561211['includes'](_0x1b144b(0x122))||_0x561211[_0x1b144b(0x120)]('wc'))_0x569b71=0.05;}}let _0x13266f=0.5;const _0x170e30=_0x569b71*0.5+_0x106884*0.3+_0x13266f*0.2;return parseFloat(_0x170e30['toFixed'](0x2));}async function updateLocation(_0xa60402,_0x200eae){const _0x40526c=a2_0xd4c07a;if(!_0x200eae||_0x200eae===_0x40526c(0x11f))return;if(!await isActive(_0xa60402)){resetTimer(_0xa60402);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x200eae){const _0x4c32f4=await areRoomsConnected(_0xa60402,currentMonitoredRoom,_0x200eae);if(!_0x4c32f4){const _0xfc6c00=_0x40526c(0x152)+_0x200eae+_0x40526c(0x128)+currentMonitoredRoom+'\x27.';_0xa60402['log'][_0x40526c(0x131)](_0x40526c(0x14a)+_0xfc6c00+_0x40526c(0x14b)),await _0xa60402['setStateAsync'](_0x40526c(0x127),{'val':JSON[_0x40526c(0x136)]({'room':_0x200eae,'reason':_0xfc6c00,'timestamp':Date[_0x40526c(0x129)]()}),'ack':!![]});return;}resetTimer(_0xa60402);}if(!currentMonitoredRoom){await _0xa60402['setStateAsync'](_0x40526c(0x124),{'val':_0x200eae,'ack':!![]});const _0x4b14de=await loadConfig(_0xa60402);let _0x5258eb=getTimeoutRobust(_0x4b14de,_0x200eae);const _0x1e6c2b=_0x200eae[_0x40526c(0x12c)]();if(!_0x5258eb)for(const _0x5444f3 in DEFAULT_TIMEOUTS){if(_0x1e6c2b[_0x40526c(0x120)](_0x5444f3)){_0x5258eb=DEFAULT_TIMEOUTS[_0x5444f3];break;}}if(!_0x5258eb&&_0x4b14de[_0x40526c(0x14c)])_0x5258eb=_0x4b14de['default'];if(!_0x5258eb)return;currentMonitoredRoom=_0x200eae,startTimer(_0xa60402,_0x5258eb,_0x200eae);}}function startTimer(_0x1118fb,_0xa8ebe0,_0x55088f){const _0x521b4d=a2_0xd4c07a;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0xa8ebe0*0x3c*0x3e8,startTime=Date[_0x521b4d(0x129)](),alarmStage=0x0;const _0x196db2=calculateSleepProbability(_0x55088f||currentMonitoredRoom),_0x51a1f9=_0x196db2>0.65;_0x51a1f9?(timeoutMs+=0x5a*0x3c*0x3e8,_0x1118fb[_0x521b4d(0x11d)][_0x521b4d(0x131)](_0x521b4d(0x142)+(_0x196db2*0x64)[_0x521b4d(0x140)](0x0)+_0x521b4d(0x12b)+currentMonitoredRoom+_0x521b4d(0x125)),_0x1118fb['setStateAsync'](_0x521b4d(0x149),{'val':!![],'ack':!![]})):_0x1118fb[_0x521b4d(0x12a)]('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0x1118fb[_0x521b4d(0x12a)]('analysis.safety.deadMan.napProbability',{'val':_0x196db2,'ack':!![]}),_0x1118fb[_0x521b4d(0x11d)]['info'](_0x521b4d(0x13e)+currentMonitoredRoom+_0x521b4d(0x13c)+_0xa8ebe0+'\x20Min.'),_0x1118fb[_0x521b4d(0x12a)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x1118fb),timeoutMs);}function resetTimer(_0x428a85){const _0x1cfd66=a2_0xd4c07a;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x428a85[_0x1cfd66(0x12a)](_0x1cfd66(0x135),{'val':'ok','ack':!![]}),_0x428a85[_0x1cfd66(0x12a)]('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0x428a85[_0x1cfd66(0x12a)](_0x1cfd66(0x144),{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x2b27e6){const _0xf99502=a2_0xd4c07a;alarmStage=0x1,await _0x2b27e6[_0xf99502(0x12a)]('analysis.safety.deadMan.alarmState',{'val':_0xf99502(0x121),'ack':!![]});const _0x44a0e5=_0xf99502(0x12d)+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x2b27e6[_0xf99502(0x11d)][_0xf99502(0x11b)](_0xf99502(0x14a)+_0x44a0e5),await setup[_0xf99502(0x119)](_0x2b27e6,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x44a0e5),activeTimer=setTimeout(()=>triggerAlarm(_0x2b27e6),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x3e3c02){const _0x48cc59=a2_0xd4c07a;alarmStage=0x2,await _0x3e3c02[_0x48cc59(0x12a)](_0x48cc59(0x135),{'val':'alarm','ack':!![]});const _0x450672=_0x48cc59(0x132)+currentMonitoredRoom+'!';_0x3e3c02[_0x48cc59(0x11d)][_0x48cc59(0x126)](_0x48cc59(0x14a)+_0x450672),await setup[_0x48cc59(0x119)](_0x3e3c02,_0x450672,![],!![]);}module[a2_0xd4c07a(0x150)]={'updateLocation':updateLocation};