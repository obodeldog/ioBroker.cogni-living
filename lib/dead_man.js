const a2_0xefba1e=a2_0x91ed;function a2_0x344f(){const _0x1a5a4e=['.\x20Alles\x20in\x20Ordnung?','27709rmElky','5tOmDGD','sendNotification','getStateAsync','analysis.topology.structure','analysis.safety.deadMan.alarmState','580YSIlZl','constructor','588vvrRUt','1777888dyPBpl','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','info','3582lxbYCj','\x20Min.','pre_warn','36BabRKX','val','7656OFwxaf','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','[DeadMan]\x20','./setup','49296RxHqsK','\x27.\x20(Multi-Person\x20Filter)','(((.+)+)+)+$','1995860eLbVZX','7428qNaeZJ','\x20fÃ¼r\x20','toString','now','indexOf','parse','log','default','analysis.safety.deadMan.active','ðŸ‘¼\x20Schutzengel-Frage:\x20','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','6839QfXHdb','alarm','[DeadMan]\x20Topology\x20check\x20failed:\x20','setStateAsync','search'];a2_0x344f=function(){return _0x1a5a4e;};return a2_0x344f();}(function(_0x4c2151,_0x143f3e){const _0x220c5d=a2_0x91ed,_0x592406=_0x4c2151();while(!![]){try{const _0x4b839b=-parseInt(_0x220c5d(0x8a))/0x1+parseInt(_0x220c5d(0xa7))/0x2*(parseInt(_0x220c5d(0x81))/0x3)+-parseInt(_0x220c5d(0xa5))/0x4*(-parseInt(_0x220c5d(0xa0))/0x5)+-parseInt(_0x220c5d(0x86))/0x6*(-parseInt(_0x220c5d(0x99))/0x7)+parseInt(_0x220c5d(0x7e))/0x8*(parseInt(_0x220c5d(0x84))/0x9)+-parseInt(_0x220c5d(0x8d))/0xa+parseInt(_0x220c5d(0x9f))/0xb*(-parseInt(_0x220c5d(0x8e))/0xc);if(_0x4b839b===_0x143f3e)break;else _0x592406['push'](_0x592406['shift']());}catch(_0x2515ff){_0x592406['push'](_0x592406['shift']());}}}(a2_0x344f,0xa5aea));const a2_0x43a3f5=(function(){let _0x3ec296=!![];return function(_0x4ddc03,_0x1d7139){const _0x1d6675=_0x3ec296?function(){if(_0x1d7139){const _0x2b63ac=_0x1d7139['apply'](_0x4ddc03,arguments);return _0x1d7139=null,_0x2b63ac;}}:function(){};return _0x3ec296=![],_0x1d6675;};}()),a2_0x26396b=a2_0x43a3f5(this,function(){const _0x190cd5=a2_0x91ed;return a2_0x26396b[_0x190cd5(0x90)]()[_0x190cd5(0x9d)](_0x190cd5(0x8c))[_0x190cd5(0x90)]()[_0x190cd5(0xa6)](a2_0x26396b)[_0x190cd5(0x9d)](_0x190cd5(0x8c));});a2_0x26396b();'use strict';const setup=require(a2_0xefba1e(0x89));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0xfa7908){const _0x3b0523=a2_0xefba1e;try{const _0x3a672f=await _0xfa7908[_0x3b0523(0xa2)]('analysis.safety.deadMan.config');if(_0x3a672f&&_0x3a672f[_0x3b0523(0x85)])return JSON[_0x3b0523(0x93)](_0x3a672f[_0x3b0523(0x85)]);}catch(_0x464749){}return{};}function a2_0x91ed(_0x2f4d20,_0x2d2bc4){const _0x12b655=a2_0x344f();return a2_0x91ed=function(_0x26396b,_0x43a3f5){_0x26396b=_0x26396b-0x7e;let _0x344f45=_0x12b655[_0x26396b];return _0x344f45;},a2_0x91ed(_0x2f4d20,_0x2d2bc4);}async function isActive(_0x541ca3){const _0x5eb2e4=a2_0xefba1e;try{const _0xf26c8b=await _0x541ca3[_0x5eb2e4(0xa2)](_0x5eb2e4(0x96));return _0xf26c8b&&_0xf26c8b[_0x5eb2e4(0x85)];}catch(_0x45b483){return![];}}async function areRoomsConnected(_0x2dab60,_0x5c318d,_0x4391de){const _0x5e3e2d=a2_0xefba1e;try{const _0x166bf4=await _0x2dab60[_0x5e3e2d(0xa2)](_0x5e3e2d(0xa3));if(!_0x166bf4||!_0x166bf4[_0x5e3e2d(0x85)])return!![];const _0x111ae9=JSON[_0x5e3e2d(0x93)](_0x166bf4[_0x5e3e2d(0x85)]),{rooms:_0x170f7c,matrix:_0x4e0440}=_0x111ae9;if(!_0x170f7c||!_0x4e0440)return!![];const _0x18d1b9=_0x170f7c[_0x5e3e2d(0x92)](_0x5c318d),_0x29636d=_0x170f7c['indexOf'](_0x4391de);if(_0x18d1b9===-0x1||_0x29636d===-0x1)return!![];const _0x38834f=_0x4e0440[_0x18d1b9][_0x29636d]>0x0||_0x4e0440[_0x29636d][_0x18d1b9]>0x0;return _0x38834f;}catch(_0x469d74){return _0x2dab60['log']['warn'](_0x5e3e2d(0x9b)+_0x469d74['message']),!![];}}async function updateLocation(_0xe1974d,_0x3420b5){const _0xe5f426=a2_0xefba1e;if(!_0x3420b5||_0x3420b5==='Unknown')return;if(!await isActive(_0xe1974d)){resetTimer(_0xe1974d);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x3420b5){const _0x1d3c06=await areRoomsConnected(_0xe1974d,currentMonitoredRoom,_0x3420b5);if(!_0x1d3c06){_0xe1974d[_0xe5f426(0x94)][_0xe5f426(0x80)](_0xe5f426(0x7f)+_0x3420b5+_0xe5f426(0x87)+currentMonitoredRoom+_0xe5f426(0x8b));return;}resetTimer(_0xe1974d);}if(!currentMonitoredRoom){await _0xe1974d[_0xe5f426(0x9c)]('analysis.safety.deadMan.currentRoom',{'val':_0x3420b5,'ack':!![]});const _0x2394f3=await loadConfig(_0xe1974d),_0x3a01d5=_0x3420b5['toLowerCase']();let _0x2d3b4c=_0x2394f3[_0x3420b5]||_0x2394f3[_0x3a01d5];if(!_0x2d3b4c)for(const _0x5803cf in DEFAULT_TIMEOUTS){if(_0x3a01d5['includes'](_0x5803cf)){_0x2d3b4c=DEFAULT_TIMEOUTS[_0x5803cf];break;}}if(!_0x2d3b4c&&_0x2394f3[_0xe5f426(0x95)])_0x2d3b4c=_0x2394f3[_0xe5f426(0x95)];if(!_0x2d3b4c)return;currentMonitoredRoom=_0x3420b5,startTimer(_0xe1974d,_0x2d3b4c);}}function startTimer(_0x20a188,_0xc38134){const _0x542cc7=a2_0xefba1e;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0xc38134*0x3c*0x3e8,startTime=Date[_0x542cc7(0x91)](),alarmStage=0x0,_0x20a188[_0x542cc7(0x94)][_0x542cc7(0x80)](_0x542cc7(0x98)+currentMonitoredRoom+_0x542cc7(0x8f)+_0xc38134+_0x542cc7(0x82)),_0x20a188[_0x542cc7(0x9c)](_0x542cc7(0xa4),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x20a188),timeoutMs);}function resetTimer(_0x31c3d8){const _0x3f0802=a2_0xefba1e;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x31c3d8[_0x3f0802(0x9c)](_0x3f0802(0xa4),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x3129bf){const _0x5c4bd4=a2_0xefba1e;alarmStage=0x1,await _0x3129bf[_0x5c4bd4(0x9c)](_0x5c4bd4(0xa4),{'val':_0x5c4bd4(0x83),'ack':!![]});const _0x8e3633='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x5c4bd4(0x9e);_0x3129bf[_0x5c4bd4(0x94)]['warn'](_0x5c4bd4(0x88)+_0x8e3633),await setup[_0x5c4bd4(0xa1)](_0x3129bf,_0x5c4bd4(0x97)+_0x8e3633),activeTimer=setTimeout(()=>triggerAlarm(_0x3129bf),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x1dafbd){const _0x3a7412=a2_0xefba1e;alarmStage=0x2,await _0x1dafbd[_0x3a7412(0x9c)](_0x3a7412(0xa4),{'val':_0x3a7412(0x9a),'ack':!![]});const _0x278033='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x1dafbd[_0x3a7412(0x94)]['error']('[DeadMan]\x20'+_0x278033),await setup[_0x3a7412(0xa1)](_0x1dafbd,_0x278033,![],!![]);}module['exports']={'updateLocation':updateLocation};