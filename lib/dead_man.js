const a2_0x1a57d0=a2_0x4a0c;(function(_0x3c6365,_0x5b410a){const _0x51cbeb=a2_0x4a0c,_0x263a11=_0x3c6365();while(!![]){try{const _0x2c77d5=parseInt(_0x51cbeb(0x1da))/0x1*(-parseInt(_0x51cbeb(0x1d5))/0x2)+-parseInt(_0x51cbeb(0x1d7))/0x3+-parseInt(_0x51cbeb(0x1dd))/0x4+parseInt(_0x51cbeb(0x1f0))/0x5+parseInt(_0x51cbeb(0x1e8))/0x6+-parseInt(_0x51cbeb(0x1e9))/0x7*(-parseInt(_0x51cbeb(0x1e3))/0x8)+-parseInt(_0x51cbeb(0x1d1))/0x9;if(_0x2c77d5===_0x5b410a)break;else _0x263a11['push'](_0x263a11['shift']());}catch(_0x48cdfb){_0x263a11['push'](_0x263a11['shift']());}}}(a2_0x8261,0x88bdb));const a2_0x32e6d2=(function(){let _0x9dd99d=!![];return function(_0x474eb4,_0x2011fa){const _0x5c0a61=_0x9dd99d?function(){if(_0x2011fa){const _0x18458d=_0x2011fa['apply'](_0x474eb4,arguments);return _0x2011fa=null,_0x18458d;}}:function(){};return _0x9dd99d=![],_0x5c0a61;};}()),a2_0x489bdf=a2_0x32e6d2(this,function(){const _0x32c949=a2_0x4a0c;return a2_0x489bdf['toString']()[_0x32c949(0x1e4)](_0x32c949(0x1ed))[_0x32c949(0x1ee)]()['constructor'](a2_0x489bdf)[_0x32c949(0x1e4)]('(((.+)+)+)+$');});a2_0x489bdf();'use strict';const setup=require('./setup');function a2_0x8261(){const _0x528985=['ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','analysis.safety.deadMan.active','(((.+)+)+)+$','toString','\x20fÃ¼r\x20','5055460fUNUUJ','indexOf','\x27.\x20(Multi-Person\x20Filter)','analysis.safety.deadMan.currentRoom','val','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','includes','setStateAsync','sendNotification','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','info','.\x20Alles\x20in\x20Ordnung?','5558877CucOoV','log','Unknown','analysis.safety.deadMan.config','122WFBztm','analysis.safety.deadMan.alarmState','949233ytDbbh','default','ðŸ‘¼\x20Schutzengel-Frage:\x20','7827IdwkXS','[DeadMan]\x20','warn','1491320TootvF','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','exports','message','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','parse','45952evNJOQ','search','pre_warn','[DeadMan]\x20Topology\x20check\x20failed:\x20','now','1727592QkwNeg','1274ZefPQA','getStateAsync'];a2_0x8261=function(){return _0x528985;};return a2_0x8261();}let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x4a0c(_0x31e564,_0x2996dc){const _0x2a3d2d=a2_0x8261();return a2_0x4a0c=function(_0x489bdf,_0x32e6d2){_0x489bdf=_0x489bdf-0x1ce;let _0x826182=_0x2a3d2d[_0x489bdf];return _0x826182;},a2_0x4a0c(_0x31e564,_0x2996dc);}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x8a638f){const _0x2f990c=a2_0x4a0c;try{const _0x9498f5=await _0x8a638f[_0x2f990c(0x1ea)](_0x2f990c(0x1d4));if(_0x9498f5&&_0x9498f5[_0x2f990c(0x1f4)])return JSON[_0x2f990c(0x1e2)](_0x9498f5[_0x2f990c(0x1f4)]);}catch(_0x2acd32){}return{};}async function isActive(_0x570dd3){const _0x2eca28=a2_0x4a0c;try{const _0x320b00=await _0x570dd3['getStateAsync'](_0x2eca28(0x1ec));return _0x320b00&&_0x320b00[_0x2eca28(0x1f4)];}catch(_0x14e3c4){return![];}}async function areRoomsConnected(_0x54ac2b,_0x35e75d,_0x17c17e){const _0x223ac2=a2_0x4a0c;try{const _0x140372=await _0x54ac2b[_0x223ac2(0x1ea)]('analysis.topology.structure');if(!_0x140372||!_0x140372[_0x223ac2(0x1f4)])return!![];const _0x5d11d1=JSON[_0x223ac2(0x1e2)](_0x140372[_0x223ac2(0x1f4)]),{rooms:_0x297a11,matrix:_0x5cce28}=_0x5d11d1;if(!_0x297a11||!_0x5cce28)return!![];const _0x498413=_0x297a11[_0x223ac2(0x1f1)](_0x35e75d),_0xfa9afb=_0x297a11[_0x223ac2(0x1f1)](_0x17c17e);if(_0x498413===-0x1||_0xfa9afb===-0x1)return!![];const _0xd37eb0=_0x5cce28[_0x498413][_0xfa9afb]>0x0||_0x5cce28[_0xfa9afb][_0x498413]>0x0;return _0xd37eb0;}catch(_0x714f9a){return _0x54ac2b[_0x223ac2(0x1d2)]['warn'](_0x223ac2(0x1e6)+_0x714f9a[_0x223ac2(0x1e0)]),!![];}}async function updateLocation(_0x1cdfb5,_0x5e4951){const _0x35912d=a2_0x4a0c;if(!_0x5e4951||_0x5e4951===_0x35912d(0x1d3))return;if(!await isActive(_0x1cdfb5)){resetTimer(_0x1cdfb5);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x5e4951){const _0x55bcbf=await areRoomsConnected(_0x1cdfb5,currentMonitoredRoom,_0x5e4951);if(!_0x55bcbf){_0x1cdfb5[_0x35912d(0x1d2)][_0x35912d(0x1cf)](_0x35912d(0x1ce)+_0x5e4951+_0x35912d(0x1e1)+currentMonitoredRoom+_0x35912d(0x1f2));return;}resetTimer(_0x1cdfb5);}if(!currentMonitoredRoom){await _0x1cdfb5['setStateAsync'](_0x35912d(0x1f3),{'val':_0x5e4951,'ack':!![]});const _0x5e2b31=await loadConfig(_0x1cdfb5),_0x3211b1=_0x5e4951['toLowerCase']();let _0xf79c9=_0x5e2b31[_0x5e4951]||_0x5e2b31[_0x3211b1];if(!_0xf79c9)for(const _0x2847bf in DEFAULT_TIMEOUTS){if(_0x3211b1[_0x35912d(0x1f6)](_0x2847bf)){_0xf79c9=DEFAULT_TIMEOUTS[_0x2847bf];break;}}if(!_0xf79c9&&_0x5e2b31[_0x35912d(0x1d8)])_0xf79c9=_0x5e2b31[_0x35912d(0x1d8)];if(!_0xf79c9)return;currentMonitoredRoom=_0x5e4951,startTimer(_0x1cdfb5,_0xf79c9);}}function startTimer(_0x302b60,_0x4ffcaf){const _0x4fb835=a2_0x4a0c;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x4ffcaf*0x3c*0x3e8,startTime=Date[_0x4fb835(0x1e7)](),alarmStage=0x0,_0x302b60[_0x4fb835(0x1d2)][_0x4fb835(0x1cf)](_0x4fb835(0x1eb)+currentMonitoredRoom+_0x4fb835(0x1ef)+_0x4ffcaf+'\x20Min.'),_0x302b60['setStateAsync'](_0x4fb835(0x1d6),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x302b60),timeoutMs);}function resetTimer(_0x117e53){const _0x4f90e3=a2_0x4a0c;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x117e53['setStateAsync'](_0x4f90e3(0x1d6),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x39124b){const _0x247f68=a2_0x4a0c;alarmStage=0x1,await _0x39124b[_0x247f68(0x1f7)]('analysis.safety.deadMan.alarmState',{'val':_0x247f68(0x1e5),'ack':!![]});const _0x348c42=_0x247f68(0x1de)+currentMonitoredRoom+_0x247f68(0x1d0);_0x39124b[_0x247f68(0x1d2)][_0x247f68(0x1dc)](_0x247f68(0x1db)+_0x348c42),await setup[_0x247f68(0x1f8)](_0x39124b,_0x247f68(0x1d9)+_0x348c42),activeTimer=setTimeout(()=>triggerAlarm(_0x39124b),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x333a26){const _0x257444=a2_0x4a0c;alarmStage=0x2,await _0x333a26[_0x257444(0x1f7)]('analysis.safety.deadMan.alarmState',{'val':'alarm','ack':!![]});const _0x1fd3f6=_0x257444(0x1f5)+currentMonitoredRoom+'!';_0x333a26[_0x257444(0x1d2)]['error'](_0x257444(0x1db)+_0x1fd3f6),await setup[_0x257444(0x1f8)](_0x333a26,_0x1fd3f6,![],!![]);}module[a2_0x1a57d0(0x1df)]={'updateLocation':updateLocation};