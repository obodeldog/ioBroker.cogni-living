const a2_0x5eb4ac=a2_0x25b0;function a2_0x25b0(_0x217db0,_0x53dd0d){const _0x27bab0=a2_0x1125();return a2_0x25b0=function(_0x479b62,_0x425f59){_0x479b62=_0x479b62-0x109;let _0x1125cf=_0x27bab0[_0x479b62];return _0x1125cf;},a2_0x25b0(_0x217db0,_0x53dd0d);}(function(_0x23acf9,_0x21850c){const _0x57967c=a2_0x25b0,_0x500f08=_0x23acf9();while(!![]){try{const _0x50d61f=-parseInt(_0x57967c(0x10c))/0x1*(parseInt(_0x57967c(0x135))/0x2)+parseInt(_0x57967c(0x12d))/0x3+-parseInt(_0x57967c(0x112))/0x4+-parseInt(_0x57967c(0x125))/0x5*(-parseInt(_0x57967c(0x129))/0x6)+-parseInt(_0x57967c(0x10a))/0x7+parseInt(_0x57967c(0x123))/0x8+-parseInt(_0x57967c(0x12b))/0x9;if(_0x50d61f===_0x21850c)break;else _0x500f08['push'](_0x500f08['shift']());}catch(_0x50355b){_0x500f08['push'](_0x500f08['shift']());}}}(a2_0x1125,0x3caef));const a2_0x425f59=(function(){let _0x16c19a=!![];return function(_0xcd3d5a,_0x5da9fb){const _0x3b9e51=_0x16c19a?function(){if(_0x5da9fb){const _0xed4da0=_0x5da9fb['apply'](_0xcd3d5a,arguments);return _0x5da9fb=null,_0xed4da0;}}:function(){};return _0x16c19a=![],_0x3b9e51;};}()),a2_0x479b62=a2_0x425f59(this,function(){const _0x234061=a2_0x25b0;return a2_0x479b62[_0x234061(0x115)]()['search'](_0x234061(0x120))['toString']()['constructor'](a2_0x479b62)[_0x234061(0x10d)](_0x234061(0x120));});a2_0x479b62();'use strict';const setup=require(a2_0x5eb4ac(0x110));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x5d1bb9){const _0x1a3eb3=a2_0x5eb4ac;try{const _0x166106=await _0x5d1bb9[_0x1a3eb3(0x127)](_0x1a3eb3(0x11f));if(_0x166106&&_0x166106[_0x1a3eb3(0x131)])return JSON[_0x1a3eb3(0x128)](_0x166106[_0x1a3eb3(0x131)]);}catch(_0x4be8fe){}return{};}function a2_0x1125(){const _0x4e2edc=['analysis.topology.structure','analysis.safety.deadMan.config','(((.+)+)+)+$','analysis.safety.deadMan.alarmState','message','3464680Hqnzry','analysis.safety.deadMan.lastIgnored','5ocSYtb','ðŸ‘¼\x20Schutzengel-Frage:\x20','getStateAsync','parse','911418ChrSdx','setStateAsync','3999123KjhuWu','Unknown','1488918svAZCI','stringify','default','analysis.safety.deadMan.active','val','warn','analysis.safety.deadMan.currentRoom','\x20Min.','4024knLAuI','[DeadMan]\x20','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','\x20(Multi-Person\x20Filter)','149387WVqKAc','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','154VQxXiJ','search','indexOf','Ignoriere\x20Bewegung\x20in\x20\x27','./setup','toLowerCase','228796gyUtVs','exports','log','toString','info','now','sendNotification','.\x20Alles\x20in\x20Ordnung?','includes','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','[DeadMan]\x20Topology\x20check\x20failed:\x20','\x20fÃ¼r\x20'];a2_0x1125=function(){return _0x4e2edc;};return a2_0x1125();}async function isActive(_0x49f407){const _0x24f97e=a2_0x5eb4ac;try{const _0x470b44=await _0x49f407['getStateAsync'](_0x24f97e(0x130));return _0x470b44&&_0x470b44[_0x24f97e(0x131)];}catch(_0xec3791){return![];}}async function areRoomsConnected(_0xee85ce,_0x40f35f,_0x4043e0){const _0x4c973e=a2_0x5eb4ac;try{const _0x6a5531=await _0xee85ce[_0x4c973e(0x127)](_0x4c973e(0x11e));if(!_0x6a5531||!_0x6a5531[_0x4c973e(0x131)])return!![];const _0x560d93=JSON[_0x4c973e(0x128)](_0x6a5531[_0x4c973e(0x131)]),{rooms:_0x4cc13b,matrix:_0x413448}=_0x560d93;if(!_0x4cc13b||!_0x413448)return!![];const _0x3aebfb=_0x4cc13b[_0x4c973e(0x10e)](_0x40f35f),_0x4f8ec4=_0x4cc13b[_0x4c973e(0x10e)](_0x4043e0);if(_0x3aebfb===-0x1||_0x4f8ec4===-0x1)return!![];const _0x27a23d=_0x413448[_0x3aebfb][_0x4f8ec4]>0x0||_0x413448[_0x4f8ec4][_0x3aebfb]>0x0;return _0x27a23d;}catch(_0xdd7ea7){return _0xee85ce[_0x4c973e(0x114)][_0x4c973e(0x132)](_0x4c973e(0x11c)+_0xdd7ea7[_0x4c973e(0x122)]),!![];}}async function updateLocation(_0x521b34,_0x226a03){const _0xe75d2f=a2_0x5eb4ac;if(!_0x226a03||_0x226a03===_0xe75d2f(0x12c))return;if(!await isActive(_0x521b34)){resetTimer(_0x521b34);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x226a03){const _0x45337b=await areRoomsConnected(_0x521b34,currentMonitoredRoom,_0x226a03);if(!_0x45337b){const _0x3ffc2c=_0xe75d2f(0x10f)+_0x226a03+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0x521b34[_0xe75d2f(0x114)][_0xe75d2f(0x116)](_0xe75d2f(0x136)+_0x3ffc2c+_0xe75d2f(0x109)),await _0x521b34[_0xe75d2f(0x12a)](_0xe75d2f(0x124),{'val':JSON[_0xe75d2f(0x12e)]({'room':_0x226a03,'reason':_0x3ffc2c,'timestamp':Date[_0xe75d2f(0x117)]()}),'ack':!![]});return;}resetTimer(_0x521b34);}if(!currentMonitoredRoom){await _0x521b34['setStateAsync'](_0xe75d2f(0x133),{'val':_0x226a03,'ack':!![]});const _0x5cbfc4=await loadConfig(_0x521b34),_0x3a5555=_0x226a03[_0xe75d2f(0x111)]();let _0xcf5845=_0x5cbfc4[_0x226a03]||_0x5cbfc4[_0x3a5555];if(!_0xcf5845)for(const _0x705325 in DEFAULT_TIMEOUTS){if(_0x3a5555[_0xe75d2f(0x11a)](_0x705325)){_0xcf5845=DEFAULT_TIMEOUTS[_0x705325];break;}}if(!_0xcf5845&&_0x5cbfc4['default'])_0xcf5845=_0x5cbfc4[_0xe75d2f(0x12f)];if(!_0xcf5845)return;currentMonitoredRoom=_0x226a03,startTimer(_0x521b34,_0xcf5845);}}function startTimer(_0x5c1b19,_0xade4a6){const _0x3b59c9=a2_0x5eb4ac;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0xade4a6*0x3c*0x3e8,startTime=Date[_0x3b59c9(0x117)](),alarmStage=0x0,_0x5c1b19[_0x3b59c9(0x114)][_0x3b59c9(0x116)](_0x3b59c9(0x137)+currentMonitoredRoom+_0x3b59c9(0x11d)+_0xade4a6+_0x3b59c9(0x134)),_0x5c1b19[_0x3b59c9(0x12a)](_0x3b59c9(0x121),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x5c1b19),timeoutMs);}function resetTimer(_0x4ae80f){const _0x294851=a2_0x5eb4ac;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x4ae80f[_0x294851(0x12a)](_0x294851(0x121),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x520205){const _0x2de463=a2_0x5eb4ac;alarmStage=0x1,await _0x520205[_0x2de463(0x12a)](_0x2de463(0x121),{'val':'pre_warn','ack':!![]});const _0x2ad299=_0x2de463(0x10b)+currentMonitoredRoom+_0x2de463(0x119);_0x520205['log']['warn'](_0x2de463(0x136)+_0x2ad299),await setup[_0x2de463(0x118)](_0x520205,_0x2de463(0x126)+_0x2ad299),activeTimer=setTimeout(()=>triggerAlarm(_0x520205),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x29acd2){const _0x117612=a2_0x5eb4ac;alarmStage=0x2,await _0x29acd2[_0x117612(0x12a)](_0x117612(0x121),{'val':'alarm','ack':!![]});const _0x1a4264=_0x117612(0x11b)+currentMonitoredRoom+'!';_0x29acd2[_0x117612(0x114)]['error'](_0x117612(0x136)+_0x1a4264),await setup[_0x117612(0x118)](_0x29acd2,_0x1a4264,![],!![]);}module[a2_0x5eb4ac(0x113)]={'updateLocation':updateLocation};