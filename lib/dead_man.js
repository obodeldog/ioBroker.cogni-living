const a2_0xb9fa57=a2_0xb4c4;(function(_0xeb6501,_0x260a35){const _0x227544=a2_0xb4c4,_0x18c690=_0xeb6501();while(!![]){try{const _0x3db0ef=-parseInt(_0x227544(0xf6))/0x1+parseInt(_0x227544(0x112))/0x2*(-parseInt(_0x227544(0x101))/0x3)+parseInt(_0x227544(0x107))/0x4*(-parseInt(_0x227544(0xfa))/0x5)+-parseInt(_0x227544(0x10b))/0x6+-parseInt(_0x227544(0x113))/0x7+-parseInt(_0x227544(0x106))/0x8*(parseInt(_0x227544(0xf8))/0x9)+parseInt(_0x227544(0x103))/0xa;if(_0x3db0ef===_0x260a35)break;else _0x18c690['push'](_0x18c690['shift']());}catch(_0x191cf7){_0x18c690['push'](_0x18c690['shift']());}}}(a2_0x7bdc,0xc6d78));const a2_0x4dacfc=(function(){let _0x3b00c7=!![];return function(_0x2ed38a,_0x42cfb0){const _0x15c382=_0x3b00c7?function(){if(_0x42cfb0){const _0x765a95=_0x42cfb0['apply'](_0x2ed38a,arguments);return _0x42cfb0=null,_0x765a95;}}:function(){};return _0x3b00c7=![],_0x15c382;};}()),a2_0x55a098=a2_0x4dacfc(this,function(){const _0x3c5f8e=a2_0xb4c4;return a2_0x55a098[_0x3c5f8e(0xf5)]()['search']('(((.+)+)+)+$')['toString']()['constructor'](a2_0x55a098)['search'](_0x3c5f8e(0x105));});function a2_0xb4c4(_0xcee941,_0x1aadd7){const _0x20d87a=a2_0x7bdc();return a2_0xb4c4=function(_0x55a098,_0x4dacfc){_0x55a098=_0x55a098-0xf1;let _0x7bdc17=_0x20d87a[_0x55a098];return _0x7bdc17;},a2_0xb4c4(_0xcee941,_0x1aadd7);}a2_0x55a098();'use strict';const setup=require('./setup');let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};function a2_0x7bdc(){const _0x4a5a8a=['toLowerCase','.\x20Alles\x20in\x20Ordnung?','[DeadMan]\x20','Ignoriere\x20Bewegung\x20in\x20\x27','includes','val','exports','toString','528105YgSqyA','default','2620161dQrgvv','alarm','623845qAozxR','ðŸ‘¼\x20Schutzengel-Frage:\x20','error','warn','analysis.topology.structure','analysis.safety.deadMan.lastIgnored','analysis.safety.deadMan.active','7218JLbKZS','sendNotification','52191780CsKjXq','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','(((.+)+)+)+$','8zatMKd','8PuCEnr','setStateAsync','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','parse','8672406jjxJMk','[DeadMan]\x20Topology\x20check\x20failed:\x20','Unknown','log','stringify','\x20(Multi-Person\x20Filter)','info','1206kLXNtb','3078117iCSqhr','analysis.safety.deadMan.config','getStateAsync','analysis.safety.deadMan.alarmState','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','analysis.safety.deadMan.currentRoom','indexOf','\x20fÃ¼r\x20','pre_warn','\x20Min.','now'];a2_0x7bdc=function(){return _0x4a5a8a;};return a2_0x7bdc();}async function loadConfig(_0x59200d){const _0x4e2b40=a2_0xb4c4;try{const _0x2d7aed=await _0x59200d[_0x4e2b40(0x115)](_0x4e2b40(0x114));if(_0x2d7aed&&_0x2d7aed[_0x4e2b40(0xf3)])return JSON[_0x4e2b40(0x10a)](_0x2d7aed['val']);}catch(_0x27ed3c){}return{};}async function isActive(_0x53fa7c){const _0x1bcf65=a2_0xb4c4;try{const _0x4967a4=await _0x53fa7c[_0x1bcf65(0x115)](_0x1bcf65(0x100));return _0x4967a4&&_0x4967a4[_0x1bcf65(0xf3)];}catch(_0x2bf1fa){return![];}}async function areRoomsConnected(_0x315a1f,_0x23acca,_0x543594){const _0x3f20b4=a2_0xb4c4;try{const _0x38ad13=await _0x315a1f[_0x3f20b4(0x115)](_0x3f20b4(0xfe));if(!_0x38ad13||!_0x38ad13[_0x3f20b4(0xf3)])return!![];const _0x2f2c79=JSON[_0x3f20b4(0x10a)](_0x38ad13[_0x3f20b4(0xf3)]),{rooms:_0x37c7ba,matrix:_0x217ce7}=_0x2f2c79;if(!_0x37c7ba||!_0x217ce7)return!![];const _0x40f513=_0x37c7ba[_0x3f20b4(0x119)](_0x23acca),_0x39204c=_0x37c7ba[_0x3f20b4(0x119)](_0x543594);if(_0x40f513===-0x1||_0x39204c===-0x1)return!![];const _0x3f2f12=_0x217ce7[_0x40f513][_0x39204c]>0x0||_0x217ce7[_0x39204c][_0x40f513]>0x0;return _0x3f2f12;}catch(_0x332618){return _0x315a1f['log'][_0x3f20b4(0xfd)](_0x3f20b4(0x10c)+_0x332618['message']),!![];}}async function updateLocation(_0x229f27,_0x5a79ee){const _0x38db94=a2_0xb4c4;if(!_0x5a79ee||_0x5a79ee===_0x38db94(0x10d))return;if(!await isActive(_0x229f27)){resetTimer(_0x229f27);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x5a79ee){const _0x20a30f=await areRoomsConnected(_0x229f27,currentMonitoredRoom,_0x5a79ee);if(!_0x20a30f){const _0x4d774d=_0x38db94(0xf1)+_0x5a79ee+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0x229f27[_0x38db94(0x10e)][_0x38db94(0x111)](_0x38db94(0x120)+_0x4d774d+_0x38db94(0x110)),await _0x229f27[_0x38db94(0x108)](_0x38db94(0xff),{'val':JSON[_0x38db94(0x10f)]({'room':_0x5a79ee,'reason':_0x4d774d,'timestamp':Date['now']()}),'ack':!![]});return;}resetTimer(_0x229f27);}if(!currentMonitoredRoom){await _0x229f27[_0x38db94(0x108)](_0x38db94(0x118),{'val':_0x5a79ee,'ack':!![]});const _0x55c74c=await loadConfig(_0x229f27),_0x55a697=_0x5a79ee[_0x38db94(0x11e)]();let _0x13b98f=_0x55c74c[_0x5a79ee]||_0x55c74c[_0x55a697];if(!_0x13b98f)for(const _0x2b3494 in DEFAULT_TIMEOUTS){if(_0x55a697[_0x38db94(0xf2)](_0x2b3494)){_0x13b98f=DEFAULT_TIMEOUTS[_0x2b3494];break;}}if(!_0x13b98f&&_0x55c74c['default'])_0x13b98f=_0x55c74c[_0x38db94(0xf7)];if(!_0x13b98f)return;currentMonitoredRoom=_0x5a79ee,startTimer(_0x229f27,_0x13b98f);}}function startTimer(_0x4ff271,_0x44c9bc){const _0x1a3f9f=a2_0xb4c4;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x44c9bc*0x3c*0x3e8,startTime=Date[_0x1a3f9f(0x11d)](),alarmStage=0x0,_0x4ff271[_0x1a3f9f(0x10e)][_0x1a3f9f(0x111)](_0x1a3f9f(0x104)+currentMonitoredRoom+_0x1a3f9f(0x11a)+_0x44c9bc+_0x1a3f9f(0x11c)),_0x4ff271[_0x1a3f9f(0x108)](_0x1a3f9f(0x116),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x4ff271),timeoutMs);}function resetTimer(_0x4f9793){const _0x2c74ec=a2_0xb4c4;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x4f9793[_0x2c74ec(0x108)](_0x2c74ec(0x116),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x42102d){const _0x10eb5c=a2_0xb4c4;alarmStage=0x1,await _0x42102d[_0x10eb5c(0x108)](_0x10eb5c(0x116),{'val':_0x10eb5c(0x11b),'ack':!![]});const _0x5e3c4f=_0x10eb5c(0x109)+currentMonitoredRoom+_0x10eb5c(0x11f);_0x42102d[_0x10eb5c(0x10e)][_0x10eb5c(0xfd)]('[DeadMan]\x20'+_0x5e3c4f),await setup['sendNotification'](_0x42102d,_0x10eb5c(0xfb)+_0x5e3c4f),activeTimer=setTimeout(()=>triggerAlarm(_0x42102d),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x308285){const _0x556b1c=a2_0xb4c4;alarmStage=0x2,await _0x308285['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':_0x556b1c(0xf9),'ack':!![]});const _0x395af3=_0x556b1c(0x117)+currentMonitoredRoom+'!';_0x308285[_0x556b1c(0x10e)][_0x556b1c(0xfc)]('[DeadMan]\x20'+_0x395af3),await setup[_0x556b1c(0x102)](_0x308285,_0x395af3,![],!![]);}module[a2_0xb9fa57(0xf4)]={'updateLocation':updateLocation};