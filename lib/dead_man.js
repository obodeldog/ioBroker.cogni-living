function a2_0x3992(_0x26e265,_0x3bfbbb){const _0x55f4bd=a2_0x30c7();return a2_0x3992=function(_0x17fa56,_0x35bc1e){_0x17fa56=_0x17fa56-0x9d;let _0x30c7c6=_0x55f4bd[_0x17fa56];return _0x30c7c6;},a2_0x3992(_0x26e265,_0x3bfbbb);}const a2_0x1fbf14=a2_0x3992;(function(_0x55fd5c,_0x45b5dd){const _0x3d7849=a2_0x3992,_0x5ddb66=_0x55fd5c();while(!![]){try{const _0x52d3b1=parseInt(_0x3d7849(0xc8))/0x1*(-parseInt(_0x3d7849(0xaa))/0x2)+-parseInt(_0x3d7849(0xbc))/0x3*(-parseInt(_0x3d7849(0xa6))/0x4)+-parseInt(_0x3d7849(0xcc))/0x5+parseInt(_0x3d7849(0xb8))/0x6+-parseInt(_0x3d7849(0xb3))/0x7*(parseInt(_0x3d7849(0xba))/0x8)+-parseInt(_0x3d7849(0xb0))/0x9*(-parseInt(_0x3d7849(0xc0))/0xa)+parseInt(_0x3d7849(0xd2))/0xb;if(_0x52d3b1===_0x45b5dd)break;else _0x5ddb66['push'](_0x5ddb66['shift']());}catch(_0x3fa59c){_0x5ddb66['push'](_0x5ddb66['shift']());}}}(a2_0x30c7,0x65ed4));const a2_0x35bc1e=(function(){let _0x803ece=!![];return function(_0x409c38,_0xffadc9){const _0x217179=_0x803ece?function(){const _0x500321=a2_0x3992;if(_0xffadc9){const _0x391004=_0xffadc9[_0x500321(0xca)](_0x409c38,arguments);return _0xffadc9=null,_0x391004;}}:function(){};return _0x803ece=![],_0x217179;};}()),a2_0x17fa56=a2_0x35bc1e(this,function(){const _0x5e4404=a2_0x3992;return a2_0x17fa56[_0x5e4404(0xc9)]()[_0x5e4404(0xb7)](_0x5e4404(0xbd))['toString']()[_0x5e4404(0xa0)](a2_0x17fa56)[_0x5e4404(0xb7)]('(((.+)+)+)+$');});a2_0x17fa56();'use strict';const setup=require(a2_0x1fbf14(0xc5));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};function a2_0x30c7(){const _0x2bc3ce=['Ignoriere\x20Bewegung\x20in\x20\x27','bad','alarm','2SodyjL','includes','\x20Min.','.\x20Alles\x20in\x20Ordnung?','sofa','now','27pzCuzP','\x20(Multi-Person\x20Filter)','getStateAsync','21CjKDwt','info','sendNotification','analysis.safety.deadMan.smartSleep','search','902628blcKVK','toFixed','210888dhLpQl','stringify','12PduTaw','(((.+)+)+)+$','analysis.safety.deadMan.config','[DeadMan]\x20Topology\x20check\x20failed:\x20','1095770zdckVR','setStateAsync','pre_warn','analysis.safety.deadMan.currentRoom','[DeadMan]\x20','./setup','log','analysis.topology.structure','325297FMUkPr','toString','apply','error','2499225tinQPI','schlaf','analysis.safety.deadMan.alarmState','warn','exports','default','234476SNQNwH','analysis.safety.deadMan.lastIgnored','\x20fÃ¼r\x20','val','wohn','\x20um\x2090\x20Min.','replace','analysis.safety.deadMan.napProbability','indexOf','analysis.safety.deadMan.active','toLowerCase','constructor','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','living','Unknown','ðŸ’¤\x20Smart\x20Sleep\x20erkannt\x20(','parse','821232crfOEK'];a2_0x30c7=function(){return _0x2bc3ce;};return a2_0x30c7();}function getTimeoutRobust(_0xb5c30c,_0x2da6cb){const _0x3c50b5=a2_0x1fbf14;if(!_0xb5c30c||!_0x2da6cb)return undefined;if(_0xb5c30c[_0x2da6cb])return _0xb5c30c[_0x2da6cb];const _0x18047c=_0x2da6cb[_0x3c50b5(0x9f)]()[_0x3c50b5(0xd8)](/[^a-z0-9]/g,'');for(const _0x21c4c2 in _0xb5c30c){const _0x398f7b=_0x21c4c2[_0x3c50b5(0x9f)]()[_0x3c50b5(0xd8)](/[^a-z0-9]/g,'');if(_0x398f7b===_0x18047c)return _0xb5c30c[_0x21c4c2];}const _0x5eee8d=_0x2da6cb[_0x3c50b5(0x9f)]();if(_0xb5c30c[_0x5eee8d])return _0xb5c30c[_0x5eee8d];return undefined;}async function loadConfig(_0x3d6104){const _0x34e454=a2_0x1fbf14;try{const _0x396cf3=await _0x3d6104[_0x34e454(0xb2)](_0x34e454(0xbe));if(_0x396cf3&&_0x396cf3[_0x34e454(0xd5)])return JSON[_0x34e454(0xa5)](_0x396cf3[_0x34e454(0xd5)]);}catch(_0x33aa61){}return{};}async function isActive(_0x25c28d){const _0x1a1838=a2_0x1fbf14;try{const _0xced98a=await _0x25c28d[_0x1a1838(0xb2)](_0x1a1838(0x9e));return _0xced98a&&_0xced98a[_0x1a1838(0xd5)];}catch(_0xafd7e2){return![];}}async function areRoomsConnected(_0x55b1a9,_0x439a37,_0x30bd83){const _0x4bf0f1=a2_0x1fbf14;try{const _0x200b4b=await _0x55b1a9[_0x4bf0f1(0xb2)](_0x4bf0f1(0xc7));if(!_0x200b4b||!_0x200b4b[_0x4bf0f1(0xd5)])return!![];const _0x42539b=JSON[_0x4bf0f1(0xa5)](_0x200b4b[_0x4bf0f1(0xd5)]),{rooms:_0x5a208d,matrix:_0x37ae9}=_0x42539b;if(!_0x5a208d||!_0x37ae9)return!![];const _0x499682=_0x5a208d[_0x4bf0f1(0x9d)](_0x439a37),_0x22ba2f=_0x5a208d['indexOf'](_0x30bd83);if(_0x499682===-0x1||_0x22ba2f===-0x1)return!![];const _0x8f1538=_0x37ae9[_0x499682][_0x22ba2f]>0x0||_0x37ae9[_0x22ba2f][_0x499682]>0x0;return _0x8f1538;}catch(_0x3d60c3){return _0x55b1a9[_0x4bf0f1(0xc6)]['warn'](_0x4bf0f1(0xbf)+_0x3d60c3['message']),!![];}}function calculateSleepProbability(_0x458158){const _0x43ec01=a2_0x1fbf14,_0x553def=new Date(),_0x12d71b=_0x553def['getHours'](),_0x21538e=_0x458158[_0x43ec01(0x9f)]();let _0x4de1fd=0.1;if(_0x12d71b>=0x17||_0x12d71b<=0x6)_0x4de1fd=0x1;else{if(_0x12d71b>=0xd&&_0x12d71b<=0xf)_0x4de1fd=0.8;else{if(_0x12d71b>=0x14&&_0x12d71b<=0x17)_0x4de1fd=0.4;}}let _0x394837=0.1;if(_0x21538e['includes'](_0x43ec01(0xcd))||_0x21538e[_0x43ec01(0xab)]('bed'))_0x394837=0x1;else{if(_0x21538e[_0x43ec01(0xab)](_0x43ec01(0xd6))||_0x21538e[_0x43ec01(0xab)](_0x43ec01(0xa2))||_0x21538e[_0x43ec01(0xab)](_0x43ec01(0xae)))_0x394837=0.6;else{if(_0x21538e[_0x43ec01(0xab)](_0x43ec01(0xa8))||_0x21538e[_0x43ec01(0xab)]('wc'))_0x394837=0.05;}}let _0x12257f=0.5;const _0x46ed33=_0x394837*0.5+_0x4de1fd*0.3+_0x12257f*0.2;return parseFloat(_0x46ed33[_0x43ec01(0xb9)](0x2));}async function updateLocation(_0x4f65f8,_0x4760a3){const _0x3907aa=a2_0x1fbf14;if(!_0x4760a3||_0x4760a3===_0x3907aa(0xa3))return;if(!await isActive(_0x4f65f8)){resetTimer(_0x4f65f8);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x4760a3){const _0x28436f=await areRoomsConnected(_0x4f65f8,currentMonitoredRoom,_0x4760a3);if(!_0x28436f){const _0x5140f2=_0x3907aa(0xa7)+_0x4760a3+_0x3907aa(0xa1)+currentMonitoredRoom+'\x27.';_0x4f65f8['log'][_0x3907aa(0xb4)](_0x3907aa(0xc4)+_0x5140f2+_0x3907aa(0xb1)),await _0x4f65f8[_0x3907aa(0xc1)](_0x3907aa(0xd3),{'val':JSON[_0x3907aa(0xbb)]({'room':_0x4760a3,'reason':_0x5140f2,'timestamp':Date[_0x3907aa(0xaf)]()}),'ack':!![]});return;}resetTimer(_0x4f65f8);}if(!currentMonitoredRoom){await _0x4f65f8[_0x3907aa(0xc1)](_0x3907aa(0xc3),{'val':_0x4760a3,'ack':!![]});const _0x5769a8=await loadConfig(_0x4f65f8);let _0x350528=getTimeoutRobust(_0x5769a8,_0x4760a3);const _0x1e6cd6=_0x4760a3[_0x3907aa(0x9f)]();if(!_0x350528)for(const _0xd01637 in DEFAULT_TIMEOUTS){if(_0x1e6cd6[_0x3907aa(0xab)](_0xd01637)){_0x350528=DEFAULT_TIMEOUTS[_0xd01637];break;}}if(!_0x350528&&_0x5769a8[_0x3907aa(0xd1)])_0x350528=_0x5769a8[_0x3907aa(0xd1)];if(!_0x350528)return;currentMonitoredRoom=_0x4760a3,startTimer(_0x4f65f8,_0x350528,_0x4760a3);}}function startTimer(_0x2eb7d4,_0x4d0031,_0x35741e){const _0x2ee87d=a2_0x1fbf14;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x4d0031*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0;const _0x549e2e=calculateSleepProbability(_0x35741e||currentMonitoredRoom),_0x4b0f1d=_0x549e2e>0.65;_0x4b0f1d?(timeoutMs+=0x5a*0x3c*0x3e8,_0x2eb7d4[_0x2ee87d(0xc6)][_0x2ee87d(0xb4)](_0x2ee87d(0xa4)+(_0x549e2e*0x64)[_0x2ee87d(0xb9)](0x0)+'%).\x20VerlÃ¤ngere\x20Timer\x20fÃ¼r\x20'+currentMonitoredRoom+_0x2ee87d(0xd7)),_0x2eb7d4[_0x2ee87d(0xc1)](_0x2ee87d(0xb6),{'val':!![],'ack':!![]})):_0x2eb7d4[_0x2ee87d(0xc1)](_0x2ee87d(0xb6),{'val':![],'ack':!![]}),_0x2eb7d4[_0x2ee87d(0xc1)]('analysis.safety.deadMan.napProbability',{'val':_0x549e2e,'ack':!![]}),_0x2eb7d4[_0x2ee87d(0xc6)][_0x2ee87d(0xb4)]('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+_0x2ee87d(0xd4)+_0x4d0031+_0x2ee87d(0xac)),_0x2eb7d4[_0x2ee87d(0xc1)](_0x2ee87d(0xce),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x2eb7d4),timeoutMs);}function resetTimer(_0x3eb03d){const _0x316eae=a2_0x1fbf14;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x3eb03d[_0x316eae(0xc1)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),_0x3eb03d[_0x316eae(0xc1)](_0x316eae(0xb6),{'val':![],'ack':!![]}),_0x3eb03d['setStateAsync'](_0x316eae(0xd9),{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x483e7e){const _0xe37abd=a2_0x1fbf14;alarmStage=0x1,await _0x483e7e[_0xe37abd(0xc1)]('analysis.safety.deadMan.alarmState',{'val':_0xe37abd(0xc2),'ack':!![]});const _0xc3d1e5='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0xe37abd(0xad);_0x483e7e[_0xe37abd(0xc6)][_0xe37abd(0xcf)](_0xe37abd(0xc4)+_0xc3d1e5),await setup['sendNotification'](_0x483e7e,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0xc3d1e5),activeTimer=setTimeout(()=>triggerAlarm(_0x483e7e),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x122ca8){const _0x3eacdc=a2_0x1fbf14;alarmStage=0x2,await _0x122ca8[_0x3eacdc(0xc1)](_0x3eacdc(0xce),{'val':_0x3eacdc(0xa9),'ack':!![]});const _0x2e8611='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x122ca8[_0x3eacdc(0xc6)][_0x3eacdc(0xcb)](_0x3eacdc(0xc4)+_0x2e8611),await setup[_0x3eacdc(0xb5)](_0x122ca8,_0x2e8611,![],!![]);}module[a2_0x1fbf14(0xd0)]={'updateLocation':updateLocation};