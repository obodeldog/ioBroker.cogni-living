const a2_0x7aa7fb=a2_0xbc8d;function a2_0x5c8a(){const _0x129ae1=['206740TYvXMg','24NxGhoT','4zLiKJd','531DwYkHj','info','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','(((.+)+)+)+$','[DeadMan]\x20Topology\x20check\x20failed:\x20','analysis.topology.structure','Unknown','parse','log','toString','alarm','val','analysis.safety.deadMan.config','17416rOKpuQ','analysis.safety.deadMan.currentRoom','824727FfKdnk','constructor','\x20Min.','setStateAsync','default','\x20fÃ¼r\x20','analysis.safety.deadMan.active','toLowerCase','[DeadMan]\x20','\x27.\x20(Multi-Person\x20Filter)','1708590dMxbJS','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','apply','88mueKZg','getStateAsync','indexOf','980777VEWOwA','search','703215oTbpoj','13122bIsyuz','pre_warn','now','includes','analysis.safety.deadMan.alarmState','message','sendNotification','exports','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','warn'];a2_0x5c8a=function(){return _0x129ae1;};return a2_0x5c8a();}(function(_0x1de793,_0x4cffa8){const _0xaec4c8=a2_0xbc8d,_0x1931b1=_0x1de793();while(!![]){try{const _0x205e6f=parseInt(_0xaec4c8(0x91))/0x1*(-parseInt(_0xaec4c8(0x86))/0x2)+-parseInt(_0xaec4c8(0x73))/0x3*(parseInt(_0xaec4c8(0x92))/0x4)+-parseInt(_0xaec4c8(0x85))/0x5+parseInt(_0xaec4c8(0x7d))/0x6+parseInt(_0xaec4c8(0x83))/0x7+-parseInt(_0xaec4c8(0x71))/0x8*(-parseInt(_0xaec4c8(0x93))/0x9)+parseInt(_0xaec4c8(0x90))/0xa*(parseInt(_0xaec4c8(0x80))/0xb);if(_0x205e6f===_0x4cffa8)break;else _0x1931b1['push'](_0x1931b1['shift']());}catch(_0x3691ee){_0x1931b1['push'](_0x1931b1['shift']());}}}(a2_0x5c8a,0x2391f));const a2_0x5dbf9f=(function(){let _0x2b6d37=!![];return function(_0x628aed,_0x48ec8a){const _0x261f19=_0x2b6d37?function(){const _0x81dc13=a2_0xbc8d;if(_0x48ec8a){const _0x369795=_0x48ec8a[_0x81dc13(0x7f)](_0x628aed,arguments);return _0x48ec8a=null,_0x369795;}}:function(){};return _0x2b6d37=![],_0x261f19;};}()),a2_0x30e3eb=a2_0x5dbf9f(this,function(){const _0x284fb2=a2_0xbc8d;return a2_0x30e3eb['toString']()['search'](_0x284fb2(0x96))[_0x284fb2(0x6d)]()[_0x284fb2(0x74)](a2_0x30e3eb)[_0x284fb2(0x84)](_0x284fb2(0x96));});a2_0x30e3eb();'use strict';const setup=require('./setup');let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x118e41){const _0x3e2066=a2_0xbc8d;try{const _0x4f2d55=await _0x118e41['getStateAsync'](_0x3e2066(0x70));if(_0x4f2d55&&_0x4f2d55[_0x3e2066(0x6f)])return JSON['parse'](_0x4f2d55['val']);}catch(_0x4c6d7a){}return{};}async function isActive(_0x464830){const _0xf1db8c=a2_0xbc8d;try{const _0x76f925=await _0x464830[_0xf1db8c(0x81)](_0xf1db8c(0x79));return _0x76f925&&_0x76f925['val'];}catch(_0xfee9c6){return![];}}function a2_0xbc8d(_0x7589c4,_0x1dbd9e){const _0x2f08ee=a2_0x5c8a();return a2_0xbc8d=function(_0x30e3eb,_0x5dbf9f){_0x30e3eb=_0x30e3eb-0x6d;let _0x5c8ab6=_0x2f08ee[_0x30e3eb];return _0x5c8ab6;},a2_0xbc8d(_0x7589c4,_0x1dbd9e);}async function areRoomsConnected(_0x6722ab,_0x1cdaf7,_0x39c74e){const _0x2180ca=a2_0xbc8d;try{const _0x476d1e=await _0x6722ab[_0x2180ca(0x81)](_0x2180ca(0x98));if(!_0x476d1e||!_0x476d1e[_0x2180ca(0x6f)])return!![];const _0x372bbc=JSON[_0x2180ca(0x9a)](_0x476d1e['val']),{rooms:_0x382d10,matrix:_0xd7888f}=_0x372bbc;if(!_0x382d10||!_0xd7888f)return!![];const _0x1f60a6=_0x382d10[_0x2180ca(0x82)](_0x1cdaf7),_0x570a53=_0x382d10[_0x2180ca(0x82)](_0x39c74e);if(_0x1f60a6===-0x1||_0x570a53===-0x1)return!![];const _0x39c44f=_0xd7888f[_0x1f60a6][_0x570a53]>0x0||_0xd7888f[_0x570a53][_0x1f60a6]>0x0;return _0x39c44f;}catch(_0x59efd1){return _0x6722ab[_0x2180ca(0x9b)][_0x2180ca(0x8f)](_0x2180ca(0x97)+_0x59efd1[_0x2180ca(0x8b)]),!![];}}async function updateLocation(_0xfac0b7,_0x4284fb){const _0xd0649d=a2_0xbc8d;if(!_0x4284fb||_0x4284fb===_0xd0649d(0x99))return;if(!await isActive(_0xfac0b7)){resetTimer(_0xfac0b7);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x4284fb){const _0x397859=await areRoomsConnected(_0xfac0b7,currentMonitoredRoom,_0x4284fb);if(!_0x397859){_0xfac0b7['log'][_0xd0649d(0x94)](_0xd0649d(0x7e)+_0x4284fb+_0xd0649d(0x8e)+currentMonitoredRoom+_0xd0649d(0x7c));return;}resetTimer(_0xfac0b7);}if(!currentMonitoredRoom){await _0xfac0b7['setStateAsync'](_0xd0649d(0x72),{'val':_0x4284fb,'ack':!![]});const _0x15834d=await loadConfig(_0xfac0b7),_0x4b0a76=_0x4284fb[_0xd0649d(0x7a)]();let _0xc1e447=_0x15834d[_0x4284fb]||_0x15834d[_0x4b0a76];if(!_0xc1e447)for(const _0x2e3470 in DEFAULT_TIMEOUTS){if(_0x4b0a76[_0xd0649d(0x89)](_0x2e3470)){_0xc1e447=DEFAULT_TIMEOUTS[_0x2e3470];break;}}if(!_0xc1e447&&_0x15834d[_0xd0649d(0x77)])_0xc1e447=_0x15834d[_0xd0649d(0x77)];if(!_0xc1e447)return;currentMonitoredRoom=_0x4284fb,startTimer(_0xfac0b7,_0xc1e447);}}function startTimer(_0x539522,_0x3759ca){const _0xec9e56=a2_0xbc8d;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3759ca*0x3c*0x3e8,startTime=Date[_0xec9e56(0x88)](),alarmStage=0x0,_0x539522[_0xec9e56(0x9b)][_0xec9e56(0x94)]('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+_0xec9e56(0x78)+_0x3759ca+_0xec9e56(0x75)),_0x539522['setStateAsync'](_0xec9e56(0x8a),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x539522),timeoutMs);}function resetTimer(_0x1368e3){const _0x1fe3e5=a2_0xbc8d;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x1368e3[_0x1fe3e5(0x76)](_0x1fe3e5(0x8a),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x8e7ffa){const _0x432f48=a2_0xbc8d;alarmStage=0x1,await _0x8e7ffa[_0x432f48(0x76)](_0x432f48(0x8a),{'val':_0x432f48(0x87),'ack':!![]});const _0x4f7a2b=_0x432f48(0x95)+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x8e7ffa[_0x432f48(0x9b)]['warn'](_0x432f48(0x7b)+_0x4f7a2b),await setup[_0x432f48(0x8c)](_0x8e7ffa,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x4f7a2b),activeTimer=setTimeout(()=>triggerAlarm(_0x8e7ffa),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x3be321){const _0x4b2494=a2_0xbc8d;alarmStage=0x2,await _0x3be321[_0x4b2494(0x76)](_0x4b2494(0x8a),{'val':_0x4b2494(0x6e),'ack':!![]});const _0x55b4d4='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x3be321[_0x4b2494(0x9b)]['error'](_0x4b2494(0x7b)+_0x55b4d4),await setup['sendNotification'](_0x3be321,_0x55b4d4,![],!![]);}module[a2_0x7aa7fb(0x8d)]={'updateLocation':updateLocation};