const a2_0x3ff0c3=a2_0x3f57;(function(_0xdab097,_0x370b4b){const _0x4c5062=a2_0x3f57,_0x272ce4=_0xdab097();while(!![]){try{const _0x1620a6=parseInt(_0x4c5062(0x1ce))/0x1+parseInt(_0x4c5062(0x1b3))/0x2*(parseInt(_0x4c5062(0x1c9))/0x3)+-parseInt(_0x4c5062(0x1bd))/0x4*(-parseInt(_0x4c5062(0x1b8))/0x5)+parseInt(_0x4c5062(0x1dc))/0x6+-parseInt(_0x4c5062(0x1d6))/0x7*(parseInt(_0x4c5062(0x1d2))/0x8)+parseInt(_0x4c5062(0x1d7))/0x9*(parseInt(_0x4c5062(0x1b5))/0xa)+-parseInt(_0x4c5062(0x1c2))/0xb;if(_0x1620a6===_0x370b4b)break;else _0x272ce4['push'](_0x272ce4['shift']());}catch(_0x1a5078){_0x272ce4['push'](_0x272ce4['shift']());}}}(a2_0x4521,0x9ac30));const a2_0x19f54f=(function(){let _0x556d20=!![];return function(_0x249f29,_0x5d5ad2){const _0xff45df=_0x556d20?function(){const _0x285cf2=a2_0x3f57;if(_0x5d5ad2){const _0x4ab606=_0x5d5ad2[_0x285cf2(0x1d0)](_0x249f29,arguments);return _0x5d5ad2=null,_0x4ab606;}}:function(){};return _0x556d20=![],_0xff45df;};}()),a2_0x394978=a2_0x19f54f(this,function(){const _0x16e512=a2_0x3f57;return a2_0x394978[_0x16e512(0x1c4)]()['search']('(((.+)+)+)+$')['toString']()[_0x16e512(0x1e0)](a2_0x394978)[_0x16e512(0x1da)](_0x16e512(0x1c0));});a2_0x394978();'use strict';function a2_0x3f57(_0x56a79c,_0x4da262){const _0x5919dd=a2_0x4521();return a2_0x3f57=function(_0x394978,_0x19f54f){_0x394978=_0x394978-0x1b3;let _0x4521bb=_0x5919dd[_0x394978];return _0x4521bb;},a2_0x3f57(_0x56a79c,_0x4da262);}const setup=require(a2_0x3ff0c3(0x1d1));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x4521(){const _0x2352e1=['38164hrqRQO','info','Unknown','(((.+)+)+)+$','message','16905196lzRKhB','exports','toString','sendNotification','.\x20Alles\x20in\x20Ordnung?','getStateAsync','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','60861sxRUzW','\x27.\x20(Multi-Person\x20Filter)','log','analysis.safety.deadMan.config','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','595154RTJzdu','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','apply','./setup','4477288ccSSPZ','indexOf','now','\x20fÃ¼r\x20','14vvYpkx','9vJvDnn','default','[DeadMan]\x20Topology\x20check\x20failed:\x20','search','analysis.safety.deadMan.alarmState','1719588OnzftP','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','[DeadMan]\x20','error','constructor','parse','80KYBSzl','val','4423690lfqtUS','setStateAsync','analysis.safety.deadMan.currentRoom','605iKxgGd','warn','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','ðŸ‘¼\x20Schutzengel-Frage:\x20','alarm'];a2_0x4521=function(){return _0x2352e1;};return a2_0x4521();}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x572478){const _0xe32efb=a2_0x3ff0c3;try{const _0x4d0fde=await _0x572478[_0xe32efb(0x1c7)](_0xe32efb(0x1cc));if(_0x4d0fde&&_0x4d0fde['val'])return JSON[_0xe32efb(0x1e1)](_0x4d0fde[_0xe32efb(0x1b4)]);}catch(_0x5edf95){}return{};}async function isActive(_0x10b35d){const _0x5a0fab=a2_0x3ff0c3;try{const _0x48eabc=await _0x10b35d[_0x5a0fab(0x1c7)]('analysis.safety.deadMan.active');return _0x48eabc&&_0x48eabc['val'];}catch(_0x1ea7e1){return![];}}async function areRoomsConnected(_0x3f0580,_0x416624,_0xe24756){const _0x3ccfa8=a2_0x3ff0c3;try{const _0x4c4c29=await _0x3f0580['getStateAsync']('analysis.topology.structure');if(!_0x4c4c29||!_0x4c4c29[_0x3ccfa8(0x1b4)])return!![];const _0x203389=JSON[_0x3ccfa8(0x1e1)](_0x4c4c29[_0x3ccfa8(0x1b4)]),{rooms:_0x2cd3c8,matrix:_0x227084}=_0x203389;if(!_0x2cd3c8||!_0x227084)return!![];const _0x1cb2fc=_0x2cd3c8[_0x3ccfa8(0x1d3)](_0x416624),_0x47e4fd=_0x2cd3c8[_0x3ccfa8(0x1d3)](_0xe24756);if(_0x1cb2fc===-0x1||_0x47e4fd===-0x1)return!![];const _0x228bdd=_0x227084[_0x1cb2fc][_0x47e4fd]>0x0||_0x227084[_0x47e4fd][_0x1cb2fc]>0x0;return _0x228bdd;}catch(_0x3927da){return _0x3f0580[_0x3ccfa8(0x1cb)][_0x3ccfa8(0x1b9)](_0x3ccfa8(0x1d9)+_0x3927da[_0x3ccfa8(0x1c1)]),!![];}}async function updateLocation(_0x2a77fc,_0x390b8f){const _0x5acb07=a2_0x3ff0c3;if(!_0x390b8f||_0x390b8f===_0x5acb07(0x1bf))return;if(!await isActive(_0x2a77fc)){resetTimer(_0x2a77fc);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x390b8f){const _0x246168=await areRoomsConnected(_0x2a77fc,currentMonitoredRoom,_0x390b8f);if(!_0x246168){_0x2a77fc[_0x5acb07(0x1cb)][_0x5acb07(0x1be)](_0x5acb07(0x1dd)+_0x390b8f+_0x5acb07(0x1c8)+currentMonitoredRoom+_0x5acb07(0x1ca));return;}resetTimer(_0x2a77fc);}if(!currentMonitoredRoom){await _0x2a77fc['setStateAsync'](_0x5acb07(0x1b7),{'val':_0x390b8f,'ack':!![]});const _0x187a5e=await loadConfig(_0x2a77fc),_0x5a7824=_0x390b8f['toLowerCase']();let _0x3ba685=_0x187a5e[_0x390b8f]||_0x187a5e[_0x5a7824];if(!_0x3ba685)for(const _0x36ba26 in DEFAULT_TIMEOUTS){if(_0x5a7824['includes'](_0x36ba26)){_0x3ba685=DEFAULT_TIMEOUTS[_0x36ba26];break;}}if(!_0x3ba685&&_0x187a5e[_0x5acb07(0x1d8)])_0x3ba685=_0x187a5e[_0x5acb07(0x1d8)];if(!_0x3ba685)return;currentMonitoredRoom=_0x390b8f,startTimer(_0x2a77fc,_0x3ba685);}}function startTimer(_0x40ddb7,_0x27f503){const _0x51e4f8=a2_0x3ff0c3;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x27f503*0x3c*0x3e8,startTime=Date[_0x51e4f8(0x1d4)](),alarmStage=0x0,_0x40ddb7[_0x51e4f8(0x1cb)][_0x51e4f8(0x1be)](_0x51e4f8(0x1ba)+currentMonitoredRoom+_0x51e4f8(0x1d5)+_0x27f503+'\x20Min.'),_0x40ddb7[_0x51e4f8(0x1b6)](_0x51e4f8(0x1db),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x40ddb7),timeoutMs);}function resetTimer(_0xa89b77){const _0x2212bf=a2_0x3ff0c3;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0xa89b77['setStateAsync'](_0x2212bf(0x1db),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x595464){const _0x98b454=a2_0x3ff0c3;alarmStage=0x1,await _0x595464[_0x98b454(0x1b6)](_0x98b454(0x1db),{'val':'pre_warn','ack':!![]});const _0xf78911=_0x98b454(0x1cd)+currentMonitoredRoom+_0x98b454(0x1c6);_0x595464[_0x98b454(0x1cb)][_0x98b454(0x1b9)](_0x98b454(0x1de)+_0xf78911),await setup[_0x98b454(0x1c5)](_0x595464,_0x98b454(0x1bb)+_0xf78911),activeTimer=setTimeout(()=>triggerAlarm(_0x595464),0x5*0x3c*0x3e8);}async function triggerAlarm(_0xbacfd7){const _0x594367=a2_0x3ff0c3;alarmStage=0x2,await _0xbacfd7[_0x594367(0x1b6)](_0x594367(0x1db),{'val':_0x594367(0x1bc),'ack':!![]});const _0x2bd134=_0x594367(0x1cf)+currentMonitoredRoom+'!';_0xbacfd7['log'][_0x594367(0x1df)](_0x594367(0x1de)+_0x2bd134),await setup[_0x594367(0x1c5)](_0xbacfd7,_0x2bd134,![],!![]);}module[a2_0x3ff0c3(0x1c3)]={'updateLocation':updateLocation};