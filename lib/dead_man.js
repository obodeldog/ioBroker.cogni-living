const a2_0x524cc0=a2_0x36e8;(function(_0x44dacf,_0x51a9c5){const _0x59ff05=a2_0x36e8,_0x13df95=_0x44dacf();while(!![]){try{const _0x4d4ed1=-parseInt(_0x59ff05(0x15e))/0x1*(parseInt(_0x59ff05(0x162))/0x2)+parseInt(_0x59ff05(0x178))/0x3*(parseInt(_0x59ff05(0x17b))/0x4)+parseInt(_0x59ff05(0x17f))/0x5+parseInt(_0x59ff05(0x155))/0x6+parseInt(_0x59ff05(0x17a))/0x7+parseInt(_0x59ff05(0x170))/0x8*(parseInt(_0x59ff05(0x154))/0x9)+-parseInt(_0x59ff05(0x164))/0xa*(parseInt(_0x59ff05(0x17d))/0xb);if(_0x4d4ed1===_0x51a9c5)break;else _0x13df95['push'](_0x13df95['shift']());}catch(_0x51a3a5){_0x13df95['push'](_0x13df95['shift']());}}}(a2_0xc5ce,0xc59dd));function a2_0xc5ce(){const _0x47a39a=['log','toString','(((.+)+)+)+$','parse','now','toLowerCase','message','469784nCSeUB','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','analysis.safety.deadMan.alarmState','pre_warn','getStateAsync','sendNotification','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','analysis.safety.deadMan.active','3bMlWKD','alarm','9223809QadwGj','393268qLEfEP','ðŸ‘¼\x20Schutzengel-Frage:\x20','3223hYnKCg','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','93730gNTnzF','\x20Min.','setStateAsync','.\x20Alles\x20in\x20Ordnung?','153oqMxUa','5998938wqjzWk','error','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','apply','./setup','analysis.safety.deadMan.currentRoom','analysis.safety.deadMan.config','constructor','[DeadMan]\x20','258331cjmjsb','includes','default','search','2fzFDVE','warn','80720NyKHQc','val','info','[DeadMan]\x20Topology\x20check\x20failed:\x20','indexOf'];a2_0xc5ce=function(){return _0x47a39a;};return a2_0xc5ce();}const a2_0x2d28d0=(function(){let _0x135e33=!![];return function(_0x33ba26,_0x37457c){const _0x1dd78b=_0x135e33?function(){const _0x4ea6b2=a2_0x36e8;if(_0x37457c){const _0x3f7caf=_0x37457c[_0x4ea6b2(0x158)](_0x33ba26,arguments);return _0x37457c=null,_0x3f7caf;}}:function(){};return _0x135e33=![],_0x1dd78b;};}()),a2_0xddb89a=a2_0x2d28d0(this,function(){const _0x2b7102=a2_0x36e8;return a2_0xddb89a[_0x2b7102(0x16a)]()[_0x2b7102(0x161)](_0x2b7102(0x16b))[_0x2b7102(0x16a)]()[_0x2b7102(0x15c)](a2_0xddb89a)[_0x2b7102(0x161)](_0x2b7102(0x16b));});a2_0xddb89a();'use strict';const setup=require(a2_0x524cc0(0x159));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x36e8(_0x58e538,_0x772167){const _0x171f05=a2_0xc5ce();return a2_0x36e8=function(_0xddb89a,_0x2d28d0){_0xddb89a=_0xddb89a-0x151;let _0xc5ce63=_0x171f05[_0xddb89a];return _0xc5ce63;},a2_0x36e8(_0x58e538,_0x772167);}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x1d3e1c){const _0x95c7dc=a2_0x524cc0;try{const _0x308504=await _0x1d3e1c[_0x95c7dc(0x174)](_0x95c7dc(0x15b));if(_0x308504&&_0x308504[_0x95c7dc(0x165)])return JSON['parse'](_0x308504[_0x95c7dc(0x165)]);}catch(_0x557269){}return{};}async function isActive(_0x5a73bc){const _0x28a612=a2_0x524cc0;try{const _0x26cac7=await _0x5a73bc[_0x28a612(0x174)](_0x28a612(0x177));return _0x26cac7&&_0x26cac7[_0x28a612(0x165)];}catch(_0x1e2986){return![];}}async function areRoomsConnected(_0x4b32f1,_0x239099,_0x4440a2){const _0x565019=a2_0x524cc0;try{const _0x1708ea=await _0x4b32f1[_0x565019(0x174)]('analysis.topology.structure');if(!_0x1708ea||!_0x1708ea[_0x565019(0x165)])return!![];const _0x448bd1=JSON[_0x565019(0x16c)](_0x1708ea[_0x565019(0x165)]),{rooms:_0x709c6c,matrix:_0x24d8c7}=_0x448bd1;if(!_0x709c6c||!_0x24d8c7)return!![];const _0x895a8f=_0x709c6c[_0x565019(0x168)](_0x239099),_0x1f357b=_0x709c6c[_0x565019(0x168)](_0x4440a2);if(_0x895a8f===-0x1||_0x1f357b===-0x1)return!![];const _0x281ec2=_0x24d8c7[_0x895a8f][_0x1f357b]>0x0||_0x24d8c7[_0x1f357b][_0x895a8f]>0x0;return _0x281ec2;}catch(_0x1bcbd9){return _0x4b32f1['log'][_0x565019(0x163)](_0x565019(0x167)+_0x1bcbd9[_0x565019(0x16f)]),!![];}}async function updateLocation(_0x263afc,_0x6a3928){const _0x353666=a2_0x524cc0;if(!_0x6a3928||_0x6a3928==='Unknown')return;if(!await isActive(_0x263afc)){resetTimer(_0x263afc);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x6a3928){const _0x2cf55e=await areRoomsConnected(_0x263afc,currentMonitoredRoom,_0x6a3928);if(!_0x2cf55e){_0x263afc[_0x353666(0x169)][_0x353666(0x166)](_0x353666(0x17e)+_0x6a3928+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.\x20(Multi-Person\x20Filter)');return;}resetTimer(_0x263afc);}if(!currentMonitoredRoom){await _0x263afc['setStateAsync'](_0x353666(0x15a),{'val':_0x6a3928,'ack':!![]});const _0x584f41=await loadConfig(_0x263afc),_0x14c800=_0x6a3928[_0x353666(0x16e)]();let _0x3d8c54=_0x584f41[_0x6a3928]||_0x584f41[_0x14c800];if(!_0x3d8c54)for(const _0x452242 in DEFAULT_TIMEOUTS){if(_0x14c800[_0x353666(0x15f)](_0x452242)){_0x3d8c54=DEFAULT_TIMEOUTS[_0x452242];break;}}if(!_0x3d8c54&&_0x584f41[_0x353666(0x160)])_0x3d8c54=_0x584f41[_0x353666(0x160)];if(!_0x3d8c54)return;currentMonitoredRoom=_0x6a3928,startTimer(_0x263afc,_0x3d8c54);}}function startTimer(_0x2d673b,_0x32e17a){const _0x55aae3=a2_0x524cc0;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x32e17a*0x3c*0x3e8,startTime=Date[_0x55aae3(0x16d)](),alarmStage=0x0,_0x2d673b['log']['info'](_0x55aae3(0x171)+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0x32e17a+_0x55aae3(0x151)),_0x2d673b[_0x55aae3(0x152)](_0x55aae3(0x172),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x2d673b),timeoutMs);}function resetTimer(_0x24c666){const _0x5791e5=a2_0x524cc0;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x24c666[_0x5791e5(0x152)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x3ee4fc){const _0x507b32=a2_0x524cc0;alarmStage=0x1,await _0x3ee4fc['setStateAsync'](_0x507b32(0x172),{'val':_0x507b32(0x173),'ack':!![]});const _0x350d5d=_0x507b32(0x176)+currentMonitoredRoom+_0x507b32(0x153);_0x3ee4fc['log'][_0x507b32(0x163)](_0x507b32(0x15d)+_0x350d5d),await setup[_0x507b32(0x175)](_0x3ee4fc,_0x507b32(0x17c)+_0x350d5d),activeTimer=setTimeout(()=>triggerAlarm(_0x3ee4fc),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x5ee015){const _0x4b7a85=a2_0x524cc0;alarmStage=0x2,await _0x5ee015[_0x4b7a85(0x152)](_0x4b7a85(0x172),{'val':_0x4b7a85(0x179),'ack':!![]});const _0x2faf3d=_0x4b7a85(0x157)+currentMonitoredRoom+'!';_0x5ee015['log'][_0x4b7a85(0x156)](_0x4b7a85(0x15d)+_0x2faf3d),await setup['sendNotification'](_0x5ee015,_0x2faf3d,![],!![]);}module['exports']={'updateLocation':updateLocation};