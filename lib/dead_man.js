const a2_0x25590e=a2_0x54a9;(function(_0x466af0,_0x34bc07){const _0x5d493c=a2_0x54a9,_0x56ba81=_0x466af0();while(!![]){try{const _0x1c0dd6=parseInt(_0x5d493c(0x167))/0x1+parseInt(_0x5d493c(0x185))/0x2+-parseInt(_0x5d493c(0x173))/0x3*(parseInt(_0x5d493c(0x18a))/0x4)+parseInt(_0x5d493c(0x16c))/0x5+parseInt(_0x5d493c(0x15f))/0x6+parseInt(_0x5d493c(0x163))/0x7+-parseInt(_0x5d493c(0x162))/0x8*(parseInt(_0x5d493c(0x189))/0x9);if(_0x1c0dd6===_0x34bc07)break;else _0x56ba81['push'](_0x56ba81['shift']());}catch(_0x515790){_0x56ba81['push'](_0x56ba81['shift']());}}}(a2_0x8925,0x4f1bc));const a2_0x3f908f=(function(){let _0x1b9e76=!![];return function(_0x374d78,_0x26283f){const _0x250dc2=_0x1b9e76?function(){const _0x3cfb50=a2_0x54a9;if(_0x26283f){const _0x1d546c=_0x26283f[_0x3cfb50(0x16d)](_0x374d78,arguments);return _0x26283f=null,_0x1d546c;}}:function(){};return _0x1b9e76=![],_0x250dc2;};}()),a2_0x1ae5e2=a2_0x3f908f(this,function(){const _0x52842a=a2_0x54a9;return a2_0x1ae5e2[_0x52842a(0x176)]()[_0x52842a(0x16b)]('(((.+)+)+)+$')[_0x52842a(0x176)]()[_0x52842a(0x17b)](a2_0x1ae5e2)[_0x52842a(0x16b)](_0x52842a(0x17c));});a2_0x1ae5e2();'use strict';const setup=require('./setup');let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x57a0f8){const _0x432f3f=a2_0x54a9;try{const _0x2c0fc9=await _0x57a0f8[_0x432f3f(0x166)](_0x432f3f(0x182));if(_0x2c0fc9&&_0x2c0fc9[_0x432f3f(0x17d)])return JSON[_0x432f3f(0x186)](_0x2c0fc9[_0x432f3f(0x17d)]);}catch(_0x346cde){}return{};}function a2_0x8925(){const _0x5c168c=['pre_warn','search','2280435NdkGDf','apply','message','analysis.safety.deadMan.active','[DeadMan]\x20','\x20Min.','\x20(Multi-Person\x20Filter)','166218SbPbNU','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','alarm','toString','log','analysis.safety.deadMan.currentRoom','setStateAsync','toLowerCase','constructor','(((.+)+)+)+$','val','[DeadMan]\x20Topology\x20check\x20failed:\x20','indexOf','includes','analysis.safety.deadMan.lastIgnored','analysis.safety.deadMan.config','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','info','377034RmvgDu','parse','default','ðŸ‘¼\x20Schutzengel-Frage:\x20','9046017kqUqxW','28sGvMDz','\x20fÃ¼r\x20','1213458JuiYDs','analysis.safety.deadMan.alarmState','now','8MtMpgm','2869741ofLtdj','sendNotification','exports','getStateAsync','460173yAkdQA','stringify','analysis.topology.structure'];a2_0x8925=function(){return _0x5c168c;};return a2_0x8925();}async function isActive(_0x518283){const _0x270d28=a2_0x54a9;try{const _0x8a87e5=await _0x518283[_0x270d28(0x166)](_0x270d28(0x16f));return _0x8a87e5&&_0x8a87e5['val'];}catch(_0x6ceca){return![];}}async function areRoomsConnected(_0x4c9ff4,_0x1825c0,_0x36b403){const _0x16888c=a2_0x54a9;try{const _0x905d97=await _0x4c9ff4[_0x16888c(0x166)](_0x16888c(0x169));if(!_0x905d97||!_0x905d97['val'])return!![];const _0x5eb29c=JSON[_0x16888c(0x186)](_0x905d97['val']),{rooms:_0x15c3f3,matrix:_0xcd017b}=_0x5eb29c;if(!_0x15c3f3||!_0xcd017b)return!![];const _0x5ee2af=_0x15c3f3[_0x16888c(0x17f)](_0x1825c0),_0x411935=_0x15c3f3[_0x16888c(0x17f)](_0x36b403);if(_0x5ee2af===-0x1||_0x411935===-0x1)return!![];const _0x189874=_0xcd017b[_0x5ee2af][_0x411935]>0x0||_0xcd017b[_0x411935][_0x5ee2af]>0x0;return _0x189874;}catch(_0x44b26f){return _0x4c9ff4[_0x16888c(0x177)]['warn'](_0x16888c(0x17e)+_0x44b26f[_0x16888c(0x16e)]),!![];}}async function updateLocation(_0x427da9,_0x167e84){const _0x48e33f=a2_0x54a9;if(!_0x167e84||_0x167e84==='Unknown')return;if(!await isActive(_0x427da9)){resetTimer(_0x427da9);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x167e84){const _0x40c578=await areRoomsConnected(_0x427da9,currentMonitoredRoom,_0x167e84);if(!_0x40c578){const _0x5d93ab='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x167e84+_0x48e33f(0x174)+currentMonitoredRoom+'\x27.';_0x427da9[_0x48e33f(0x177)][_0x48e33f(0x184)]('[DeadMan]\x20'+_0x5d93ab+_0x48e33f(0x172)),await _0x427da9['setStateAsync'](_0x48e33f(0x181),{'val':JSON[_0x48e33f(0x168)]({'room':_0x167e84,'reason':_0x5d93ab,'timestamp':Date['now']()}),'ack':!![]});return;}resetTimer(_0x427da9);}if(!currentMonitoredRoom){await _0x427da9[_0x48e33f(0x179)](_0x48e33f(0x178),{'val':_0x167e84,'ack':!![]});const _0x29fbaa=await loadConfig(_0x427da9),_0x809ad5=_0x167e84[_0x48e33f(0x17a)]();let _0x3ba2bb=_0x29fbaa[_0x167e84]||_0x29fbaa[_0x809ad5];if(!_0x3ba2bb)for(const _0x968dfb in DEFAULT_TIMEOUTS){if(_0x809ad5[_0x48e33f(0x180)](_0x968dfb)){_0x3ba2bb=DEFAULT_TIMEOUTS[_0x968dfb];break;}}if(!_0x3ba2bb&&_0x29fbaa[_0x48e33f(0x187)])_0x3ba2bb=_0x29fbaa[_0x48e33f(0x187)];if(!_0x3ba2bb)return;currentMonitoredRoom=_0x167e84,startTimer(_0x427da9,_0x3ba2bb);}}function startTimer(_0x4d9152,_0x5b1621){const _0x36fc75=a2_0x54a9;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x5b1621*0x3c*0x3e8,startTime=Date[_0x36fc75(0x161)](),alarmStage=0x0,_0x4d9152[_0x36fc75(0x177)][_0x36fc75(0x184)](_0x36fc75(0x183)+currentMonitoredRoom+_0x36fc75(0x18b)+_0x5b1621+_0x36fc75(0x171)),_0x4d9152[_0x36fc75(0x179)](_0x36fc75(0x160),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x4d9152),timeoutMs);}function resetTimer(_0x6938f8){const _0x4df203=a2_0x54a9;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x6938f8[_0x4df203(0x179)](_0x4df203(0x160),{'val':'ok','ack':!![]});}function a2_0x54a9(_0x1ae399,_0x357a02){const _0x4aeadc=a2_0x8925();return a2_0x54a9=function(_0x1ae5e2,_0x3f908f){_0x1ae5e2=_0x1ae5e2-0x15f;let _0x8925f9=_0x4aeadc[_0x1ae5e2];return _0x8925f9;},a2_0x54a9(_0x1ae399,_0x357a02);}async function triggerPreWarn(_0x51ab81){const _0x5efe53=a2_0x54a9;alarmStage=0x1,await _0x51ab81[_0x5efe53(0x179)](_0x5efe53(0x160),{'val':_0x5efe53(0x16a),'ack':!![]});const _0x58a71b='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x51ab81[_0x5efe53(0x177)]['warn']('[DeadMan]\x20'+_0x58a71b),await setup[_0x5efe53(0x164)](_0x51ab81,_0x5efe53(0x188)+_0x58a71b),activeTimer=setTimeout(()=>triggerAlarm(_0x51ab81),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x1d9202){const _0x377823=a2_0x54a9;alarmStage=0x2,await _0x1d9202[_0x377823(0x179)]('analysis.safety.deadMan.alarmState',{'val':_0x377823(0x175),'ack':!![]});const _0x23ea9f='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x1d9202[_0x377823(0x177)]['error'](_0x377823(0x170)+_0x23ea9f),await setup[_0x377823(0x164)](_0x1d9202,_0x23ea9f,![],!![]);}module[a2_0x25590e(0x165)]={'updateLocation':updateLocation};