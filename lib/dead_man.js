const a2_0x19ee5c=a2_0x546b;(function(_0x5700f5,_0x32b4c3){const _0x480a6a=a2_0x546b,_0x4e53f7=_0x5700f5();while(!![]){try{const _0x49f49d=parseInt(_0x480a6a(0x1f5))/0x1+parseInt(_0x480a6a(0x1d9))/0x2*(-parseInt(_0x480a6a(0x1f9))/0x3)+-parseInt(_0x480a6a(0x1e4))/0x4+parseInt(_0x480a6a(0x1ff))/0x5*(-parseInt(_0x480a6a(0x1f0))/0x6)+-parseInt(_0x480a6a(0x1e1))/0x7*(-parseInt(_0x480a6a(0x1ec))/0x8)+parseInt(_0x480a6a(0x1eb))/0x9+parseInt(_0x480a6a(0x1f7))/0xa;if(_0x49f49d===_0x32b4c3)break;else _0x4e53f7['push'](_0x4e53f7['shift']());}catch(_0x544f46){_0x4e53f7['push'](_0x4e53f7['shift']());}}}(a2_0x5b12,0x7ff81));const a2_0x4c91ed=(function(){let _0x27e0d0=!![];return function(_0x30d3bc,_0x1c3ce1){const _0x20ce01=_0x27e0d0?function(){const _0xe41d5a=a2_0x546b;if(_0x1c3ce1){const _0x2501c4=_0x1c3ce1[_0xe41d5a(0x1e0)](_0x30d3bc,arguments);return _0x1c3ce1=null,_0x2501c4;}}:function(){};return _0x27e0d0=![],_0x20ce01;};}()),a2_0x48a689=a2_0x4c91ed(this,function(){const _0x2cfe5=a2_0x546b;return a2_0x48a689[_0x2cfe5(0x1db)]()[_0x2cfe5(0x1fa)](_0x2cfe5(0x1e7))[_0x2cfe5(0x1db)]()['constructor'](a2_0x48a689)[_0x2cfe5(0x1fa)](_0x2cfe5(0x1e7));});a2_0x48a689();'use strict';const setup=require(a2_0x19ee5c(0x1f2));function a2_0x546b(_0x31292a,_0x549816){const _0x40b959=a2_0x5b12();return a2_0x546b=function(_0x48a689,_0x4c91ed){_0x48a689=_0x48a689-0x1d8;let _0x5b12bb=_0x40b959[_0x48a689];return _0x5b12bb;},a2_0x546b(_0x31292a,_0x549816);}let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x353031){const _0x208dcc=a2_0x19ee5c;try{const _0x5e49d1=await _0x353031[_0x208dcc(0x1e6)](_0x208dcc(0x1de));if(_0x5e49d1&&_0x5e49d1['val'])return JSON[_0x208dcc(0x1da)](_0x5e49d1[_0x208dcc(0x1e3)]);}catch(_0x2e7a13){}return{};}async function isActive(_0x48b1dd){const _0xc348b9=a2_0x19ee5c;try{const _0x31d789=await _0x48b1dd['getStateAsync'](_0xc348b9(0x1fb));return _0x31d789&&_0x31d789[_0xc348b9(0x1e3)];}catch(_0x4cca65){return![];}}function a2_0x5b12(){const _0x1bbf74=['14BhHakp','parse','toString','default','alarm','analysis.safety.deadMan.config','exports','apply','8855DyYTsp','includes','val','1270304FPNxqS','analysis.safety.deadMan.currentRoom','getStateAsync','(((.+)+)+)+$','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','indexOf','analysis.safety.deadMan.alarmState','7740135pTdDjf','3736likQcB','sendNotification','now','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','5488302uDBoXs','ðŸ‘¼\x20Schutzengel-Frage:\x20','./setup','setStateAsync','[DeadMan]\x20','621242LqjPwY','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','1546250ZacVuZ','analysis.topology.structure','201507hXVyHb','search','analysis.safety.deadMan.active','info','log','\x20Min.','5xgXthV','\x20fÃ¼r\x20','pre_warn','message'];a2_0x5b12=function(){return _0x1bbf74;};return a2_0x5b12();}async function areRoomsConnected(_0x3f76d7,_0x6bedd1,_0x2979f9){const _0x481c7f=a2_0x19ee5c;try{const _0x320916=await _0x3f76d7[_0x481c7f(0x1e6)](_0x481c7f(0x1f8));if(!_0x320916||!_0x320916[_0x481c7f(0x1e3)])return!![];const _0x2199ca=JSON['parse'](_0x320916[_0x481c7f(0x1e3)]),{rooms:_0x5c17c2,matrix:_0xca4498}=_0x2199ca;if(!_0x5c17c2||!_0xca4498)return!![];const _0x5a1af0=_0x5c17c2[_0x481c7f(0x1e9)](_0x6bedd1),_0x2c3533=_0x5c17c2['indexOf'](_0x2979f9);if(_0x5a1af0===-0x1||_0x2c3533===-0x1)return!![];const _0x1cdaa5=_0xca4498[_0x5a1af0][_0x2c3533]>0x0||_0xca4498[_0x2c3533][_0x5a1af0]>0x0;return _0x1cdaa5;}catch(_0x8ebe26){return _0x3f76d7[_0x481c7f(0x1fd)]['warn']('[DeadMan]\x20Topology\x20check\x20failed:\x20'+_0x8ebe26[_0x481c7f(0x1d8)]),!![];}}async function updateLocation(_0x27b335,_0x55a65c){const _0x108d24=a2_0x19ee5c;if(!_0x55a65c||_0x55a65c==='Unknown')return;if(!await isActive(_0x27b335)){resetTimer(_0x27b335);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x55a65c){const _0x10d14a=await areRoomsConnected(_0x27b335,currentMonitoredRoom,_0x55a65c);if(!_0x10d14a){_0x27b335[_0x108d24(0x1fd)][_0x108d24(0x1fc)](_0x108d24(0x1f6)+_0x55a65c+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.\x20(Multi-Person\x20Filter)');return;}resetTimer(_0x27b335);}if(!currentMonitoredRoom){await _0x27b335[_0x108d24(0x1f3)](_0x108d24(0x1e5),{'val':_0x55a65c,'ack':!![]});const _0x5d9a4e=await loadConfig(_0x27b335),_0x227859=_0x55a65c['toLowerCase']();let _0x5e108b=_0x5d9a4e[_0x55a65c]||_0x5d9a4e[_0x227859];if(!_0x5e108b)for(const _0x2e8f60 in DEFAULT_TIMEOUTS){if(_0x227859[_0x108d24(0x1e2)](_0x2e8f60)){_0x5e108b=DEFAULT_TIMEOUTS[_0x2e8f60];break;}}if(!_0x5e108b&&_0x5d9a4e['default'])_0x5e108b=_0x5d9a4e[_0x108d24(0x1dc)];if(!_0x5e108b)return;currentMonitoredRoom=_0x55a65c,startTimer(_0x27b335,_0x5e108b);}}function startTimer(_0x705924,_0x3b33c0){const _0x3de036=a2_0x19ee5c;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3b33c0*0x3c*0x3e8,startTime=Date[_0x3de036(0x1ee)](),alarmStage=0x0,_0x705924[_0x3de036(0x1fd)][_0x3de036(0x1fc)](_0x3de036(0x1ef)+currentMonitoredRoom+_0x3de036(0x200)+_0x3b33c0+_0x3de036(0x1fe)),_0x705924[_0x3de036(0x1f3)](_0x3de036(0x1ea),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x705924),timeoutMs);}function resetTimer(_0x12cf28){const _0x237521=a2_0x19ee5c;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x12cf28['setStateAsync'](_0x237521(0x1ea),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x28e16c){const _0x2c27f6=a2_0x19ee5c;alarmStage=0x1,await _0x28e16c[_0x2c27f6(0x1f3)](_0x2c27f6(0x1ea),{'val':_0x2c27f6(0x201),'ack':!![]});const _0x4b3d8e='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x28e16c[_0x2c27f6(0x1fd)]['warn'](_0x2c27f6(0x1f4)+_0x4b3d8e),await setup['sendNotification'](_0x28e16c,_0x2c27f6(0x1f1)+_0x4b3d8e),activeTimer=setTimeout(()=>triggerAlarm(_0x28e16c),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x1cb0ca){const _0xd38659=a2_0x19ee5c;alarmStage=0x2,await _0x1cb0ca['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':_0xd38659(0x1dd),'ack':!![]});const _0x5e3e01=_0xd38659(0x1e8)+currentMonitoredRoom+'!';_0x1cb0ca['log']['error'](_0xd38659(0x1f4)+_0x5e3e01),await setup[_0xd38659(0x1ed)](_0x1cb0ca,_0x5e3e01,![],!![]);}module[a2_0x19ee5c(0x1df)]={'updateLocation':updateLocation};