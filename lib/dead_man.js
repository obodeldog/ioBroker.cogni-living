const a2_0x16ca80=a2_0x50ec;(function(_0x39efdf,_0x1ee3e4){const _0x5364a3=a2_0x50ec,_0xe17608=_0x39efdf();while(!![]){try{const _0x326a26=parseInt(_0x5364a3(0x1cc))/0x1*(parseInt(_0x5364a3(0x1c8))/0x2)+-parseInt(_0x5364a3(0x1d2))/0x3*(-parseInt(_0x5364a3(0x1c7))/0x4)+-parseInt(_0x5364a3(0x1d5))/0x5*(-parseInt(_0x5364a3(0x1d6))/0x6)+parseInt(_0x5364a3(0x1bc))/0x7+parseInt(_0x5364a3(0x1d3))/0x8+parseInt(_0x5364a3(0x1b9))/0x9+-parseInt(_0x5364a3(0x1d4))/0xa;if(_0x326a26===_0x1ee3e4)break;else _0xe17608['push'](_0xe17608['shift']());}catch(_0x2e40d8){_0xe17608['push'](_0xe17608['shift']());}}}(a2_0x14d7,0x45113));const a2_0x5543a9=(function(){let _0x429ac1=!![];return function(_0x2f62d4,_0x30cc8f){const _0x212f2a=_0x429ac1?function(){const _0x5db239=a2_0x50ec;if(_0x30cc8f){const _0x40d165=_0x30cc8f[_0x5db239(0x1ab)](_0x2f62d4,arguments);return _0x30cc8f=null,_0x40d165;}}:function(){};return _0x429ac1=![],_0x212f2a;};}()),a2_0x31916c=a2_0x5543a9(this,function(){const _0x40a155=a2_0x50ec;return a2_0x31916c['toString']()[_0x40a155(0x1aa)](_0x40a155(0x1b1))[_0x40a155(0x1c0)]()[_0x40a155(0x1b0)](a2_0x31916c)[_0x40a155(0x1aa)](_0x40a155(0x1b1));});a2_0x31916c();'use strict';const setup=require(a2_0x16ca80(0x1b5));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x1ea076){const _0xe99372=a2_0x16ca80;try{const _0x461c54=await _0x1ea076[_0xe99372(0x1a9)](_0xe99372(0x1ce));if(_0x461c54&&_0x461c54[_0xe99372(0x1be)])return JSON[_0xe99372(0x1d1)](_0x461c54['val']);}catch(_0x5a5d36){}return{};}function a2_0x14d7(){const _0xc10f80=['Ignoriere\x20Bewegung\x20in\x20\x27','.\x20Alles\x20in\x20Ordnung?','\x20(Multi-Person\x20Filter)','analysis.safety.deadMan.lastIgnored','constructor','(((.+)+)+)+$','indexOf','analysis.safety.deadMan.alarmState','toLowerCase','./setup','error','Unknown','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','438381gBRfuo','exports','warn','136213awvuap','analysis.topology.structure','val','message','toString','default','[DeadMan]\x20','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','[DeadMan]\x20Topology\x20check\x20failed:\x20','analysis.safety.deadMan.active','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','12qYEroZ','26dpQHIY','ðŸ‘¼\x20Schutzengel-Frage:\x20','log','sendNotification','27187NdGEmg','now','analysis.safety.deadMan.config','info','analysis.safety.deadMan.currentRoom','parse','2751zCQwlN','2835232mhdhoD','6626970zdFyyq','92690doURVJ','54hzfubz','setStateAsync','getStateAsync','search','apply'];a2_0x14d7=function(){return _0xc10f80;};return a2_0x14d7();}async function isActive(_0x41e8b7){const _0x3ef6b4=a2_0x16ca80;try{const _0x2d5f4f=await _0x41e8b7['getStateAsync'](_0x3ef6b4(0x1c5));return _0x2d5f4f&&_0x2d5f4f['val'];}catch(_0x15d263){return![];}}async function areRoomsConnected(_0x510130,_0x17b6a6,_0x51f6e0){const _0x3975f3=a2_0x16ca80;try{const _0x27da10=await _0x510130[_0x3975f3(0x1a9)](_0x3975f3(0x1bd));if(!_0x27da10||!_0x27da10[_0x3975f3(0x1be)])return!![];const _0x212c22=JSON['parse'](_0x27da10['val']),{rooms:_0x3084fc,matrix:_0x5ba7bd}=_0x212c22;if(!_0x3084fc||!_0x5ba7bd)return!![];const _0x2285b4=_0x3084fc['indexOf'](_0x17b6a6),_0x762345=_0x3084fc[_0x3975f3(0x1b2)](_0x51f6e0);if(_0x2285b4===-0x1||_0x762345===-0x1)return!![];const _0x2c0cf6=_0x5ba7bd[_0x2285b4][_0x762345]>0x0||_0x5ba7bd[_0x762345][_0x2285b4]>0x0;return _0x2c0cf6;}catch(_0x5d99a8){return _0x510130[_0x3975f3(0x1ca)]['warn'](_0x3975f3(0x1c4)+_0x5d99a8[_0x3975f3(0x1bf)]),!![];}}async function updateLocation(_0x5543c8,_0x15d4fb){const _0x59f032=a2_0x16ca80;if(!_0x15d4fb||_0x15d4fb===_0x59f032(0x1b7))return;if(!await isActive(_0x5543c8)){resetTimer(_0x5543c8);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x15d4fb){const _0x3bf4e5=await areRoomsConnected(_0x5543c8,currentMonitoredRoom,_0x15d4fb);if(!_0x3bf4e5){const _0x1e8326=_0x59f032(0x1ac)+_0x15d4fb+_0x59f032(0x1c3)+currentMonitoredRoom+'\x27.';_0x5543c8[_0x59f032(0x1ca)][_0x59f032(0x1cf)](_0x59f032(0x1c2)+_0x1e8326+_0x59f032(0x1ae)),await _0x5543c8[_0x59f032(0x1a8)](_0x59f032(0x1af),{'val':JSON['stringify']({'room':_0x15d4fb,'reason':_0x1e8326,'timestamp':Date[_0x59f032(0x1cd)]()}),'ack':!![]});return;}resetTimer(_0x5543c8);}if(!currentMonitoredRoom){await _0x5543c8[_0x59f032(0x1a8)](_0x59f032(0x1d0),{'val':_0x15d4fb,'ack':!![]});const _0x445c11=await loadConfig(_0x5543c8),_0x574919=_0x15d4fb[_0x59f032(0x1b4)]();let _0x5e769b=_0x445c11[_0x15d4fb]||_0x445c11[_0x574919];if(!_0x5e769b)for(const _0x5dcecf in DEFAULT_TIMEOUTS){if(_0x574919['includes'](_0x5dcecf)){_0x5e769b=DEFAULT_TIMEOUTS[_0x5dcecf];break;}}if(!_0x5e769b&&_0x445c11[_0x59f032(0x1c1)])_0x5e769b=_0x445c11['default'];if(!_0x5e769b)return;currentMonitoredRoom=_0x15d4fb,startTimer(_0x5543c8,_0x5e769b);}}function startTimer(_0x14c86a,_0x507c99){const _0x5090c0=a2_0x16ca80;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x507c99*0x3c*0x3e8,startTime=Date[_0x5090c0(0x1cd)](),alarmStage=0x0,_0x14c86a[_0x5090c0(0x1ca)][_0x5090c0(0x1cf)]('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0x507c99+'\x20Min.'),_0x14c86a['setStateAsync'](_0x5090c0(0x1b3),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x14c86a),timeoutMs);}function resetTimer(_0x5d6b82){const _0x448982=a2_0x16ca80;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x5d6b82[_0x448982(0x1a8)](_0x448982(0x1b3),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x4cc6cb){const _0x3aa90f=a2_0x16ca80;alarmStage=0x1,await _0x4cc6cb[_0x3aa90f(0x1a8)]('analysis.safety.deadMan.alarmState',{'val':'pre_warn','ack':!![]});const _0x2eefeb=_0x3aa90f(0x1b8)+currentMonitoredRoom+_0x3aa90f(0x1ad);_0x4cc6cb['log'][_0x3aa90f(0x1bb)](_0x3aa90f(0x1c2)+_0x2eefeb),await setup[_0x3aa90f(0x1cb)](_0x4cc6cb,_0x3aa90f(0x1c9)+_0x2eefeb),activeTimer=setTimeout(()=>triggerAlarm(_0x4cc6cb),0x5*0x3c*0x3e8);}function a2_0x50ec(_0xd7c41b,_0x4c0117){const _0x3a4a59=a2_0x14d7();return a2_0x50ec=function(_0x31916c,_0x5543a9){_0x31916c=_0x31916c-0x1a8;let _0x14d7c4=_0x3a4a59[_0x31916c];return _0x14d7c4;},a2_0x50ec(_0xd7c41b,_0x4c0117);}async function triggerAlarm(_0x9e96f5){const _0x57092a=a2_0x16ca80;alarmStage=0x2,await _0x9e96f5[_0x57092a(0x1a8)](_0x57092a(0x1b3),{'val':'alarm','ack':!![]});const _0x464754=_0x57092a(0x1c6)+currentMonitoredRoom+'!';_0x9e96f5[_0x57092a(0x1ca)][_0x57092a(0x1b6)](_0x57092a(0x1c2)+_0x464754),await setup[_0x57092a(0x1cb)](_0x9e96f5,_0x464754,![],!![]);}module[a2_0x16ca80(0x1ba)]={'updateLocation':updateLocation};