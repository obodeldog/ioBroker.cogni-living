const a2_0x48a8e1=a2_0x4567;(function(_0x5b3d85,_0x52350a){const _0x3e0db7=a2_0x4567,_0x827bd0=_0x5b3d85();while(!![]){try{const _0x6ec7ca=-parseInt(_0x3e0db7(0x1a3))/0x1*(-parseInt(_0x3e0db7(0x1af))/0x2)+-parseInt(_0x3e0db7(0x1a2))/0x3+parseInt(_0x3e0db7(0x1bf))/0x4*(parseInt(_0x3e0db7(0x196))/0x5)+parseInt(_0x3e0db7(0x1b6))/0x6*(parseInt(_0x3e0db7(0x1aa))/0x7)+-parseInt(_0x3e0db7(0x1ab))/0x8+-parseInt(_0x3e0db7(0x199))/0x9+-parseInt(_0x3e0db7(0x1a5))/0xa*(parseInt(_0x3e0db7(0x1b9))/0xb);if(_0x6ec7ca===_0x52350a)break;else _0x827bd0['push'](_0x827bd0['shift']());}catch(_0x2f03f7){_0x827bd0['push'](_0x827bd0['shift']());}}}(a2_0x5e46,0x96c54));const a2_0x5dee3a=(function(){let _0x5c04ce=!![];return function(_0x3fe91d,_0x52ccb7){const _0x326233=_0x5c04ce?function(){const _0x1b2ba2=a2_0x4567;if(_0x52ccb7){const _0x4ac40e=_0x52ccb7[_0x1b2ba2(0x1a8)](_0x3fe91d,arguments);return _0x52ccb7=null,_0x4ac40e;}}:function(){};return _0x5c04ce=![],_0x326233;};}()),a2_0xc638e5=a2_0x5dee3a(this,function(){const _0x54c6d5=a2_0x4567;return a2_0xc638e5[_0x54c6d5(0x1bb)]()[_0x54c6d5(0x1a1)](_0x54c6d5(0x194))[_0x54c6d5(0x1bb)]()[_0x54c6d5(0x1ad)](a2_0xc638e5)[_0x54c6d5(0x1a1)](_0x54c6d5(0x194));});a2_0xc638e5();function a2_0x5e46(){const _0x10d633=['[DeadMan]\x20','includes','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','4SGokNB','toLowerCase','indexOf','getStateAsync','(((.+)+)+)+$','default','2708105HTkvxY','Unknown','Ignoriere\x20Bewegung\x20in\x20\x27','1247202MHVvne','.\x20Alles\x20in\x20Ordnung?','stringify','sendNotification','analysis.safety.deadMan.config','warn','exports','val','search','587253zmntMi','39887krGmhp','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','250fZDGji','analysis.safety.deadMan.alarmState','error','apply','\x20fÃ¼r\x20','7HtYtUI','7406432lfIsLX','[DeadMan]\x20Topology\x20check\x20failed:\x20','constructor','analysis.safety.deadMan.lastIgnored','50FDhhaJ','analysis.safety.deadMan.currentRoom','now','./setup','setStateAsync','analysis.safety.deadMan.active','log','6141108WUzyFo','parse','alarm','301235lfKjuB','pre_warn','toString'];a2_0x5e46=function(){return _0x10d633;};return a2_0x5e46();}'use strict';const setup=require(a2_0x48a8e1(0x1b2));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x4567(_0x1ddaa3,_0xe90ccc){const _0x52723c=a2_0x5e46();return a2_0x4567=function(_0xc638e5,_0x5dee3a){_0xc638e5=_0xc638e5-0x193;let _0x5e46b1=_0x52723c[_0xc638e5];return _0x5e46b1;},a2_0x4567(_0x1ddaa3,_0xe90ccc);}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x4ef0af){const _0x375360=a2_0x48a8e1;try{const _0x128bba=await _0x4ef0af['getStateAsync'](_0x375360(0x19d));if(_0x128bba&&_0x128bba[_0x375360(0x1a0)])return JSON[_0x375360(0x1b7)](_0x128bba[_0x375360(0x1a0)]);}catch(_0x17943c){}return{};}async function isActive(_0x2260de){const _0x33cd09=a2_0x48a8e1;try{const _0x320f89=await _0x2260de[_0x33cd09(0x193)](_0x33cd09(0x1b4));return _0x320f89&&_0x320f89['val'];}catch(_0x511d63){return![];}}async function areRoomsConnected(_0x5f49a5,_0x4be5d9,_0x5bfa3a){const _0x4de59b=a2_0x48a8e1;try{const _0x5be85d=await _0x5f49a5['getStateAsync']('analysis.topology.structure');if(!_0x5be85d||!_0x5be85d[_0x4de59b(0x1a0)])return!![];const _0x5ee0c7=JSON[_0x4de59b(0x1b7)](_0x5be85d[_0x4de59b(0x1a0)]),{rooms:_0x54017e,matrix:_0x30dfa2}=_0x5ee0c7;if(!_0x54017e||!_0x30dfa2)return!![];const _0x37f3cd=_0x54017e[_0x4de59b(0x1c1)](_0x4be5d9),_0x525769=_0x54017e[_0x4de59b(0x1c1)](_0x5bfa3a);if(_0x37f3cd===-0x1||_0x525769===-0x1)return!![];const _0x1eccc9=_0x30dfa2[_0x37f3cd][_0x525769]>0x0||_0x30dfa2[_0x525769][_0x37f3cd]>0x0;return _0x1eccc9;}catch(_0x7deb9a){return _0x5f49a5[_0x4de59b(0x1b5)]['warn'](_0x4de59b(0x1ac)+_0x7deb9a['message']),!![];}}async function updateLocation(_0x3bad07,_0x33dd2f){const _0x2b6018=a2_0x48a8e1;if(!_0x33dd2f||_0x33dd2f===_0x2b6018(0x197))return;if(!await isActive(_0x3bad07)){resetTimer(_0x3bad07);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x33dd2f){const _0x40e26f=await areRoomsConnected(_0x3bad07,currentMonitoredRoom,_0x33dd2f);if(!_0x40e26f){const _0x3e471b=_0x2b6018(0x198)+_0x33dd2f+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0x3bad07[_0x2b6018(0x1b5)]['info'](_0x2b6018(0x1bc)+_0x3e471b+'\x20(Multi-Person\x20Filter)'),await _0x3bad07['setStateAsync'](_0x2b6018(0x1ae),{'val':JSON[_0x2b6018(0x19b)]({'room':_0x33dd2f,'reason':_0x3e471b,'timestamp':Date['now']()}),'ack':!![]});return;}resetTimer(_0x3bad07);}if(!currentMonitoredRoom){await _0x3bad07['setStateAsync'](_0x2b6018(0x1b0),{'val':_0x33dd2f,'ack':!![]});const _0x467ddc=await loadConfig(_0x3bad07),_0x3cdeeb=_0x33dd2f[_0x2b6018(0x1c0)]();let _0x2f0dfc=_0x467ddc[_0x33dd2f]||_0x467ddc[_0x3cdeeb];if(!_0x2f0dfc)for(const _0x4aefe9 in DEFAULT_TIMEOUTS){if(_0x3cdeeb[_0x2b6018(0x1bd)](_0x4aefe9)){_0x2f0dfc=DEFAULT_TIMEOUTS[_0x4aefe9];break;}}if(!_0x2f0dfc&&_0x467ddc['default'])_0x2f0dfc=_0x467ddc[_0x2b6018(0x195)];if(!_0x2f0dfc)return;currentMonitoredRoom=_0x33dd2f,startTimer(_0x3bad07,_0x2f0dfc);}}function startTimer(_0x263493,_0x2c8263){const _0x37e83f=a2_0x48a8e1;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x2c8263*0x3c*0x3e8,startTime=Date[_0x37e83f(0x1b1)](),alarmStage=0x0,_0x263493[_0x37e83f(0x1b5)]['info'](_0x37e83f(0x1a4)+currentMonitoredRoom+_0x37e83f(0x1a9)+_0x2c8263+'\x20Min.'),_0x263493[_0x37e83f(0x1b3)](_0x37e83f(0x1a6),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x263493),timeoutMs);}function resetTimer(_0x1b37c7){const _0x40a10b=a2_0x48a8e1;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x1b37c7[_0x40a10b(0x1b3)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x13d369){const _0x2cd163=a2_0x48a8e1;alarmStage=0x1,await _0x13d369['setStateAsync'](_0x2cd163(0x1a6),{'val':_0x2cd163(0x1ba),'ack':!![]});const _0xa601a4=_0x2cd163(0x1be)+currentMonitoredRoom+_0x2cd163(0x19a);_0x13d369['log'][_0x2cd163(0x19e)](_0x2cd163(0x1bc)+_0xa601a4),await setup[_0x2cd163(0x19c)](_0x13d369,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0xa601a4),activeTimer=setTimeout(()=>triggerAlarm(_0x13d369),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x2454ce){const _0x15df17=a2_0x48a8e1;alarmStage=0x2,await _0x2454ce[_0x15df17(0x1b3)](_0x15df17(0x1a6),{'val':_0x15df17(0x1b8),'ack':!![]});const _0x4a1f45='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x2454ce['log'][_0x15df17(0x1a7)](_0x15df17(0x1bc)+_0x4a1f45),await setup[_0x15df17(0x19c)](_0x2454ce,_0x4a1f45,![],!![]);}module[a2_0x48a8e1(0x19f)]={'updateLocation':updateLocation};