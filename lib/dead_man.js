const a2_0xcac44e=a2_0x3d65;(function(_0x24afac,_0x1fb1f1){const _0x22467e=a2_0x3d65,_0x4321a3=_0x24afac();while(!![]){try{const _0x441560=parseInt(_0x22467e(0xad))/0x1+parseInt(_0x22467e(0x81))/0x2+parseInt(_0x22467e(0xa3))/0x3*(parseInt(_0x22467e(0x8b))/0x4)+parseInt(_0x22467e(0x8a))/0x5*(-parseInt(_0x22467e(0x84))/0x6)+-parseInt(_0x22467e(0xb0))/0x7*(parseInt(_0x22467e(0x82))/0x8)+parseInt(_0x22467e(0xaa))/0x9*(-parseInt(_0x22467e(0x9d))/0xa)+parseInt(_0x22467e(0x8d))/0xb;if(_0x441560===_0x1fb1f1)break;else _0x4321a3['push'](_0x4321a3['shift']());}catch(_0x41d711){_0x4321a3['push'](_0x4321a3['shift']());}}}(a2_0x28ee,0xc2ab4));const a2_0x5c4b2e=(function(){let _0x134501=!![];return function(_0x3d1ca1,_0x389ae3){const _0x41e309=_0x134501?function(){const _0x2ef6e4=a2_0x3d65;if(_0x389ae3){const _0x59df4b=_0x389ae3[_0x2ef6e4(0xac)](_0x3d1ca1,arguments);return _0x389ae3=null,_0x59df4b;}}:function(){};return _0x134501=![],_0x41e309;};}()),a2_0x1424f5=a2_0x5c4b2e(this,function(){const _0x161ef6=a2_0x3d65;return a2_0x1424f5[_0x161ef6(0x9c)]()[_0x161ef6(0x88)](_0x161ef6(0x7f))[_0x161ef6(0x9c)]()['constructor'](a2_0x1424f5)[_0x161ef6(0x88)]('(((.+)+)+)+$');});a2_0x1424f5();'use strict';const setup=require(a2_0xcac44e(0xa9));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x3d65(_0x4d6a73,_0x5e4464){const _0x2537fc=a2_0x28ee();return a2_0x3d65=function(_0x1424f5,_0x5c4b2e){_0x1424f5=_0x1424f5-0x77;let _0x28ee1f=_0x2537fc[_0x1424f5];return _0x28ee1f;},a2_0x3d65(_0x4d6a73,_0x5e4464);}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};function getTimeoutRobust(_0x295430,_0x57b268){const _0x387c54=a2_0xcac44e;if(!_0x295430||!_0x57b268)return undefined;if(_0x295430[_0x57b268])return _0x295430[_0x57b268];const _0x44e9f5=_0x57b268[_0x387c54(0x9f)]()[_0x387c54(0xb2)](/[^a-z0-9]/g,'');for(const _0x52c39a in _0x295430){const _0x257963=_0x52c39a[_0x387c54(0x9f)]()[_0x387c54(0xb2)](/[^a-z0-9]/g,'');if(_0x257963===_0x44e9f5)return _0x295430[_0x52c39a];}const _0x266277=_0x57b268[_0x387c54(0x9f)]();if(_0x295430[_0x266277])return _0x295430[_0x266277];return undefined;}async function loadConfig(_0x53084b){const _0xaf94b4=a2_0xcac44e;try{const _0x33c79c=await _0x53084b[_0xaf94b4(0x77)](_0xaf94b4(0xa5));if(_0x33c79c&&_0x33c79c['val'])return JSON['parse'](_0x33c79c[_0xaf94b4(0x87)]);}catch(_0xcd6a25){}return{};}async function isActive(_0x3a7b8d){const _0x4e37c5=a2_0xcac44e;try{const _0x180cd5=await _0x3a7b8d[_0x4e37c5(0x77)](_0x4e37c5(0x79));return _0x180cd5&&_0x180cd5[_0x4e37c5(0x87)];}catch(_0x54a313){return![];}}async function areRoomsConnected(_0x576642,_0x3797ca,_0x4d8b67){const _0x513fd5=a2_0xcac44e;try{const _0x4c09a8=await _0x576642[_0x513fd5(0x77)](_0x513fd5(0x7e));if(!_0x4c09a8||!_0x4c09a8[_0x513fd5(0x87)])return!![];const _0x377e99=JSON[_0x513fd5(0x90)](_0x4c09a8[_0x513fd5(0x87)]),{rooms:_0x112b64,matrix:_0x4995cb}=_0x377e99;if(!_0x112b64||!_0x4995cb)return!![];const _0x3062c0=_0x112b64['indexOf'](_0x3797ca),_0x28db4c=_0x112b64[_0x513fd5(0x94)](_0x4d8b67);if(_0x3062c0===-0x1||_0x28db4c===-0x1)return!![];const _0x3a68b9=_0x4995cb[_0x3062c0][_0x28db4c]>0x0||_0x4995cb[_0x28db4c][_0x3062c0]>0x0;return _0x3a68b9;}catch(_0xa51254){return _0x576642[_0x513fd5(0x93)][_0x513fd5(0x99)](_0x513fd5(0x78)+_0xa51254['message']),!![];}}function calculateSleepProbability(_0x27fb95){const _0x4af37f=a2_0xcac44e,_0x385e32=new Date(),_0x191e19=_0x385e32[_0x4af37f(0x80)](),_0x289f25=_0x27fb95['toLowerCase']();let _0x1579d8=0.1;if(_0x191e19>=0x17||_0x191e19<=0x6)_0x1579d8=0x1;else{if(_0x191e19>=0xd&&_0x191e19<=0xf)_0x1579d8=0.8;else{if(_0x191e19>=0x14&&_0x191e19<=0x17)_0x1579d8=0.4;}}let _0x23d8b5=0.1;if(_0x289f25[_0x4af37f(0xa0)](_0x4af37f(0x8c))||_0x289f25[_0x4af37f(0xa0)]('bed'))_0x23d8b5=0x1;else{if(_0x289f25[_0x4af37f(0xa0)](_0x4af37f(0x9a))||_0x289f25[_0x4af37f(0xa0)](_0x4af37f(0x7b))||_0x289f25[_0x4af37f(0xa0)](_0x4af37f(0x9b)))_0x23d8b5=0.6;else{if(_0x289f25['includes'](_0x4af37f(0x8e))||_0x289f25['includes']('wc'))_0x23d8b5=0.05;}}let _0x261678=0.5;const _0x4c89a6=_0x23d8b5*0.5+_0x1579d8*0.3+_0x261678*0.2;return parseFloat(_0x4c89a6[_0x4af37f(0xb1)](0x2));}async function updateLocation(_0x4c7a18,_0x45ce36){const _0x2a5de6=a2_0xcac44e;if(!_0x45ce36||_0x45ce36===_0x2a5de6(0xae))return;if(!await isActive(_0x4c7a18)){resetTimer(_0x4c7a18);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x45ce36){const _0x3d2e59=await areRoomsConnected(_0x4c7a18,currentMonitoredRoom,_0x45ce36);if(!_0x3d2e59){const _0x5c5be8='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x45ce36+_0x2a5de6(0xab)+currentMonitoredRoom+'\x27.';_0x4c7a18['log']['info'](_0x2a5de6(0xa8)+_0x5c5be8+_0x2a5de6(0xaf)),await _0x4c7a18['setStateAsync'](_0x2a5de6(0x85),{'val':JSON[_0x2a5de6(0xa4)]({'room':_0x45ce36,'reason':_0x5c5be8,'timestamp':Date[_0x2a5de6(0x98)]()}),'ack':!![]});return;}resetTimer(_0x4c7a18);}if(!currentMonitoredRoom){await _0x4c7a18[_0x2a5de6(0x92)](_0x2a5de6(0x7a),{'val':_0x45ce36,'ack':!![]});const _0x108963=await loadConfig(_0x4c7a18);let _0xa64f3c=getTimeoutRobust(_0x108963,_0x45ce36);const _0x37269b=_0x45ce36[_0x2a5de6(0x9f)]();if(!_0xa64f3c)for(const _0x36c9ad in DEFAULT_TIMEOUTS){if(_0x37269b['includes'](_0x36c9ad)){_0xa64f3c=DEFAULT_TIMEOUTS[_0x36c9ad];break;}}if(!_0xa64f3c&&_0x108963[_0x2a5de6(0x86)])_0xa64f3c=_0x108963[_0x2a5de6(0x86)];if(!_0xa64f3c)return;currentMonitoredRoom=_0x45ce36,startTimer(_0x4c7a18,_0xa64f3c,_0x45ce36);}}function a2_0x28ee(){const _0x504db0=['val','search','analysis.safety.deadMan.smartSleep','5fLdiwk','5435996apvTuS','schlaf','16555396wBXzvx','bad','analysis.safety.deadMan.alarmState','parse','ðŸ‘¼\x20Schutzengel-Frage:\x20','setStateAsync','log','indexOf','info','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','alarm','now','warn','wohn','sofa','toString','14077330ZpXJnM','\x20fÃ¼r\x20','toLowerCase','includes','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','\x20Min.','3mKiSnZ','stringify','analysis.safety.deadMan.config','analysis.safety.deadMan.napProbability','exports','[DeadMan]\x20','./setup','9BqvAHk','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','apply','438790EbGiFt','Unknown','\x20(Multi-Person\x20Filter)','5107144zVfsTX','toFixed','replace','getStateAsync','[DeadMan]\x20Topology\x20check\x20failed:\x20','analysis.safety.deadMan.active','analysis.safety.deadMan.currentRoom','living','sendNotification','.\x20Alles\x20in\x20Ordnung?','analysis.topology.structure','(((.+)+)+)+$','getHours','1929088MYVmho','16wGedtt','error','3618528UQOWIA','analysis.safety.deadMan.lastIgnored','default'];a2_0x28ee=function(){return _0x504db0;};return a2_0x28ee();}function startTimer(_0x550ea2,_0xcdff07,_0x5221ca){const _0x4b366e=a2_0xcac44e;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0xcdff07*0x3c*0x3e8,startTime=Date[_0x4b366e(0x98)](),alarmStage=0x0;const _0x43439b=calculateSleepProbability(_0x5221ca||currentMonitoredRoom),_0xbfc886=_0x43439b>0.65;_0xbfc886?(timeoutMs+=0x5a*0x3c*0x3e8,_0x550ea2[_0x4b366e(0x93)][_0x4b366e(0x95)]('ðŸ’¤\x20Smart\x20Sleep\x20erkannt\x20('+(_0x43439b*0x64)['toFixed'](0x0)+'%).\x20VerlÃ¤ngere\x20Timer\x20fÃ¼r\x20'+currentMonitoredRoom+'\x20um\x2090\x20Min.'),_0x550ea2[_0x4b366e(0x92)](_0x4b366e(0x89),{'val':!![],'ack':!![]})):_0x550ea2[_0x4b366e(0x92)](_0x4b366e(0x89),{'val':![],'ack':!![]}),_0x550ea2[_0x4b366e(0x92)](_0x4b366e(0xa6),{'val':_0x43439b,'ack':!![]}),_0x550ea2[_0x4b366e(0x93)][_0x4b366e(0x95)](_0x4b366e(0x96)+currentMonitoredRoom+_0x4b366e(0x9e)+_0xcdff07+_0x4b366e(0xa2)),_0x550ea2['setStateAsync'](_0x4b366e(0x8f),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x550ea2),timeoutMs);}function resetTimer(_0x2e856d){const _0x357263=a2_0xcac44e;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x2e856d[_0x357263(0x92)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),_0x2e856d[_0x357263(0x92)]('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0x2e856d[_0x357263(0x92)](_0x357263(0xa6),{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x3fdf45){const _0x149f53=a2_0xcac44e;alarmStage=0x1,await _0x3fdf45[_0x149f53(0x92)](_0x149f53(0x8f),{'val':'pre_warn','ack':!![]});const _0x511092='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x149f53(0x7d);_0x3fdf45[_0x149f53(0x93)][_0x149f53(0x99)](_0x149f53(0xa8)+_0x511092),await setup[_0x149f53(0x7c)](_0x3fdf45,_0x149f53(0x91)+_0x511092),activeTimer=setTimeout(()=>triggerAlarm(_0x3fdf45),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x2704fb){const _0x217705=a2_0xcac44e;alarmStage=0x2,await _0x2704fb['setStateAsync'](_0x217705(0x8f),{'val':_0x217705(0x97),'ack':!![]});const _0x1a1cdc=_0x217705(0xa1)+currentMonitoredRoom+'!';_0x2704fb['log'][_0x217705(0x83)](_0x217705(0xa8)+_0x1a1cdc),await setup[_0x217705(0x7c)](_0x2704fb,_0x1a1cdc,![],!![]);}module[a2_0xcac44e(0xa7)]={'updateLocation':updateLocation};