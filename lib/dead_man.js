function a2_0x7557(){const _0x41e75e=['3WPcyYy','908082eScWth','pre_warn','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','indexOf','apply','.\x20Alles\x20in\x20Ordnung?','10fYugde','[DeadMan]\x20Topology\x20check\x20failed:\x20','toString','analysis.safety.deadMan.active','analysis.safety.deadMan.config','search','constructor','error','41824wHTHFF','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','parse','2298756yVXNDa','default','exports','\x20fÃ¼r\x20','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','alarm','sendNotification','3909536MiCzjU','analysis.safety.deadMan.alarmState','17894256JKemjW','warn','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','10YntpkC','setStateAsync','1YRXYVF','getStateAsync','info','includes','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','val','1743PrVaEj','analysis.safety.deadMan.currentRoom','message','toLowerCase','\x20Min.','log','ðŸ‘¼\x20Schutzengel-Frage:\x20','[DeadMan]\x20','3845734MMLVkW','(((.+)+)+)+$','15786804IZtRKx','now'];a2_0x7557=function(){return _0x41e75e;};return a2_0x7557();}const a2_0x29c3ed=a2_0x1e20;(function(_0x3b63fa,_0x2acff0){const _0x5824d0=a2_0x1e20,_0x13ccf7=_0x3b63fa();while(!![]){try{const _0x50e895=-parseInt(_0x5824d0(0x105))/0x1*(-parseInt(_0x5824d0(0x113))/0x2)+-parseInt(_0x5824d0(0x117))/0x3*(-parseInt(_0x5824d0(0x130))/0x4)+-parseInt(_0x5824d0(0x103))/0x5*(parseInt(_0x5824d0(0x129))/0x6)+parseInt(_0x5824d0(0x10b))/0x7*(-parseInt(_0x5824d0(0x126))/0x8)+-parseInt(_0x5824d0(0x118))/0x9*(-parseInt(_0x5824d0(0x11e))/0xa)+-parseInt(_0x5824d0(0x115))/0xb+parseInt(_0x5824d0(0x132))/0xc;if(_0x50e895===_0x2acff0)break;else _0x13ccf7['push'](_0x13ccf7['shift']());}catch(_0x53c882){_0x13ccf7['push'](_0x13ccf7['shift']());}}}(a2_0x7557,0xf17dd));const a2_0x89ed7e=(function(){let _0x4a8d5e=!![];return function(_0x54e791,_0x237012){const _0x37ac3e=_0x4a8d5e?function(){const _0x2b9635=a2_0x1e20;if(_0x237012){const _0x4016d1=_0x237012[_0x2b9635(0x11c)](_0x54e791,arguments);return _0x237012=null,_0x4016d1;}}:function(){};return _0x4a8d5e=![],_0x37ac3e;};}()),a2_0x30cc4e=a2_0x89ed7e(this,function(){const _0x41d510=a2_0x1e20;return a2_0x30cc4e[_0x41d510(0x120)]()[_0x41d510(0x123)](_0x41d510(0x114))[_0x41d510(0x120)]()[_0x41d510(0x124)](a2_0x30cc4e)[_0x41d510(0x123)](_0x41d510(0x114));});a2_0x30cc4e();'use strict';const setup=require('./setup');let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};function a2_0x1e20(_0x418de6,_0x3d8a04){const _0x5690f5=a2_0x7557();return a2_0x1e20=function(_0x30cc4e,_0x89ed7e){_0x30cc4e=_0x30cc4e-0x101;let _0x755730=_0x5690f5[_0x30cc4e];return _0x755730;},a2_0x1e20(_0x418de6,_0x3d8a04);}async function loadConfig(_0x4e9035){const _0x55cb4b=a2_0x1e20;try{const _0x319434=await _0x4e9035[_0x55cb4b(0x106)](_0x55cb4b(0x122));if(_0x319434&&_0x319434[_0x55cb4b(0x10a)])return JSON[_0x55cb4b(0x128)](_0x319434['val']);}catch(_0x34dcca){}return{};}async function isActive(_0x50ab5e){const _0x4e87fa=a2_0x1e20;try{const _0x1ca81c=await _0x50ab5e[_0x4e87fa(0x106)](_0x4e87fa(0x121));return _0x1ca81c&&_0x1ca81c['val'];}catch(_0x568a49){return![];}}async function areRoomsConnected(_0x238ad1,_0x2ac942,_0xfe5090){const _0x1e176b=a2_0x1e20;try{const _0x3eea76=await _0x238ad1['getStateAsync']('analysis.topology.structure');if(!_0x3eea76||!_0x3eea76[_0x1e176b(0x10a)])return!![];const _0x274c6f=JSON[_0x1e176b(0x128)](_0x3eea76['val']),{rooms:_0x4d969c,matrix:_0xa1762}=_0x274c6f;if(!_0x4d969c||!_0xa1762)return!![];const _0x3dec94=_0x4d969c[_0x1e176b(0x11b)](_0x2ac942),_0x332226=_0x4d969c[_0x1e176b(0x11b)](_0xfe5090);if(_0x3dec94===-0x1||_0x332226===-0x1)return!![];const _0x2c4e73=_0xa1762[_0x3dec94][_0x332226]>0x0||_0xa1762[_0x332226][_0x3dec94]>0x0;return _0x2c4e73;}catch(_0x25eccb){return _0x238ad1[_0x1e176b(0x110)][_0x1e176b(0x101)](_0x1e176b(0x11f)+_0x25eccb[_0x1e176b(0x10d)]),!![];}}async function updateLocation(_0x3599fe,_0xc047ae){const _0x150c66=a2_0x1e20;if(!_0xc047ae||_0xc047ae==='Unknown')return;if(!await isActive(_0x3599fe)){resetTimer(_0x3599fe);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0xc047ae){const _0xe49d3a=await areRoomsConnected(_0x3599fe,currentMonitoredRoom,_0xc047ae);if(!_0xe49d3a){_0x3599fe['log'][_0x150c66(0x107)](_0x150c66(0x102)+_0xc047ae+_0x150c66(0x109)+currentMonitoredRoom+'\x27.\x20(Multi-Person\x20Filter)');return;}resetTimer(_0x3599fe);}if(!currentMonitoredRoom){await _0x3599fe[_0x150c66(0x104)](_0x150c66(0x10c),{'val':_0xc047ae,'ack':!![]});const _0x22ab4b=await loadConfig(_0x3599fe),_0x6202db=_0xc047ae[_0x150c66(0x10e)]();let _0x3f093f=_0x22ab4b[_0xc047ae]||_0x22ab4b[_0x6202db];if(!_0x3f093f)for(const _0x399d55 in DEFAULT_TIMEOUTS){if(_0x6202db[_0x150c66(0x108)](_0x399d55)){_0x3f093f=DEFAULT_TIMEOUTS[_0x399d55];break;}}if(!_0x3f093f&&_0x22ab4b[_0x150c66(0x12a)])_0x3f093f=_0x22ab4b[_0x150c66(0x12a)];if(!_0x3f093f)return;currentMonitoredRoom=_0xc047ae,startTimer(_0x3599fe,_0x3f093f);}}function startTimer(_0x51e50d,_0x88b181){const _0x50da8c=a2_0x1e20;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x88b181*0x3c*0x3e8,startTime=Date[_0x50da8c(0x116)](),alarmStage=0x0,_0x51e50d[_0x50da8c(0x110)][_0x50da8c(0x107)](_0x50da8c(0x11a)+currentMonitoredRoom+_0x50da8c(0x12c)+_0x88b181+_0x50da8c(0x10f)),_0x51e50d[_0x50da8c(0x104)](_0x50da8c(0x131),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x51e50d),timeoutMs);}function resetTimer(_0x170335){const _0x234d79=a2_0x1e20;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x170335[_0x234d79(0x104)](_0x234d79(0x131),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x1d2660){const _0x574f89=a2_0x1e20;alarmStage=0x1,await _0x1d2660[_0x574f89(0x104)](_0x574f89(0x131),{'val':_0x574f89(0x119),'ack':!![]});const _0x11e4e4=_0x574f89(0x12d)+currentMonitoredRoom+_0x574f89(0x11d);_0x1d2660[_0x574f89(0x110)][_0x574f89(0x101)](_0x574f89(0x112)+_0x11e4e4),await setup[_0x574f89(0x12f)](_0x1d2660,_0x574f89(0x111)+_0x11e4e4),activeTimer=setTimeout(()=>triggerAlarm(_0x1d2660),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x1a8225){const _0x16fbf5=a2_0x1e20;alarmStage=0x2,await _0x1a8225[_0x16fbf5(0x104)](_0x16fbf5(0x131),{'val':_0x16fbf5(0x12e),'ack':!![]});const _0x119ffa=_0x16fbf5(0x127)+currentMonitoredRoom+'!';_0x1a8225[_0x16fbf5(0x110)][_0x16fbf5(0x125)](_0x16fbf5(0x112)+_0x119ffa),await setup[_0x16fbf5(0x12f)](_0x1a8225,_0x119ffa,![],!![]);}module[a2_0x29c3ed(0x12b)]={'updateLocation':updateLocation};