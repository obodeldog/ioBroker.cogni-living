function a2_0x19f7(_0x26e1ef,_0x513337){const _0x3837a4=a2_0x246b();return a2_0x19f7=function(_0x4eb3c3,_0x1a4a10){_0x4eb3c3=_0x4eb3c3-0xe9;let _0x246b9c=_0x3837a4[_0x4eb3c3];return _0x246b9c;},a2_0x19f7(_0x26e1ef,_0x513337);}const a2_0x1afb37=a2_0x19f7;(function(_0x259272,_0x159171){const _0x5f1be1=a2_0x19f7,_0x2180be=_0x259272();while(!![]){try{const _0x186879=-parseInt(_0x5f1be1(0xee))/0x1+parseInt(_0x5f1be1(0xeb))/0x2*(parseInt(_0x5f1be1(0x100))/0x3)+parseInt(_0x5f1be1(0xed))/0x4*(parseInt(_0x5f1be1(0x102))/0x5)+-parseInt(_0x5f1be1(0x115))/0x6*(-parseInt(_0x5f1be1(0xfd))/0x7)+parseInt(_0x5f1be1(0x127))/0x8*(parseInt(_0x5f1be1(0x118))/0x9)+parseInt(_0x5f1be1(0xf9))/0xa*(-parseInt(_0x5f1be1(0x129))/0xb)+parseInt(_0x5f1be1(0x11d))/0xc*(-parseInt(_0x5f1be1(0xfc))/0xd);if(_0x186879===_0x159171)break;else _0x2180be['push'](_0x2180be['shift']());}catch(_0x141637){_0x2180be['push'](_0x2180be['shift']());}}}(a2_0x246b,0xaf9a5));const a2_0x1a4a10=(function(){let _0x42ba18=!![];return function(_0x2ca774,_0x4e07ce){const _0x52b439=_0x42ba18?function(){const _0x17825f=a2_0x19f7;if(_0x4e07ce){const _0x9c49a1=_0x4e07ce[_0x17825f(0x107)](_0x2ca774,arguments);return _0x4e07ce=null,_0x9c49a1;}}:function(){};return _0x42ba18=![],_0x52b439;};}()),a2_0x4eb3c3=a2_0x1a4a10(this,function(){const _0x5b5d3a=a2_0x19f7;return a2_0x4eb3c3[_0x5b5d3a(0xf5)]()[_0x5b5d3a(0x11e)]('(((.+)+)+)+$')[_0x5b5d3a(0xf5)]()[_0x5b5d3a(0xea)](a2_0x4eb3c3)['search'](_0x5b5d3a(0x112));});a2_0x4eb3c3();'use strict';const setup=require(a2_0x1afb37(0x11b));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};function getTimeoutRobust(_0x5c9562,_0xfd34eb){const _0x1dc726=a2_0x1afb37;if(!_0x5c9562||!_0xfd34eb)return undefined;if(_0x5c9562[_0xfd34eb])return _0x5c9562[_0xfd34eb];const _0x56f1ec=_0xfd34eb[_0x1dc726(0x123)]()[_0x1dc726(0x10a)](/[^a-z0-9]/g,'');for(const _0x461752 in _0x5c9562){const _0x2afee7=_0x461752[_0x1dc726(0x123)]()[_0x1dc726(0x10a)](/[^a-z0-9]/g,'');if(_0x2afee7===_0x56f1ec)return _0x5c9562[_0x461752];}const _0x1599f9=_0xfd34eb[_0x1dc726(0x123)]();if(_0x5c9562[_0x1599f9])return _0x5c9562[_0x1599f9];return undefined;}async function loadConfig(_0x33d4d9){const _0x36fa2b=a2_0x1afb37;try{const _0x153560=await _0x33d4d9[_0x36fa2b(0xec)](_0x36fa2b(0xfb));if(_0x153560&&_0x153560[_0x36fa2b(0x11a)])return JSON[_0x36fa2b(0x122)](_0x153560['val']);}catch(_0x5acaa5){}return{};}async function isActive(_0x1aab65){const _0x33c744=a2_0x1afb37;try{const _0x39ae29=await _0x1aab65['getStateAsync'](_0x33c744(0xf3));return _0x39ae29&&_0x39ae29[_0x33c744(0x11a)];}catch(_0x2461dd){return![];}}async function areRoomsConnected(_0x539f8c,_0x50d24d,_0x5da68f){const _0xd7ca64=a2_0x1afb37;try{const _0x1ec10c=await _0x539f8c[_0xd7ca64(0xec)](_0xd7ca64(0x10f));if(!_0x1ec10c||!_0x1ec10c[_0xd7ca64(0x11a)])return!![];const _0xa1d30=JSON[_0xd7ca64(0x122)](_0x1ec10c[_0xd7ca64(0x11a)]),{rooms:_0x30874c,matrix:_0x66c13e}=_0xa1d30;if(!_0x30874c||!_0x66c13e)return!![];const _0x375846=_0x30874c['indexOf'](_0x50d24d),_0x47cfd=_0x30874c[_0xd7ca64(0xef)](_0x5da68f);if(_0x375846===-0x1||_0x47cfd===-0x1)return!![];const _0x1c9dec=_0x66c13e[_0x375846][_0x47cfd]>0x0||_0x66c13e[_0x47cfd][_0x375846]>0x0;return _0x1c9dec;}catch(_0x55f458){return _0x539f8c['log']['warn'](_0xd7ca64(0xfe)+_0x55f458['message']),!![];}}function calculateSleepProbability(_0x39350a){const _0x4f59ec=a2_0x1afb37,_0x31aff9=new Date(),_0x562400=_0x31aff9[_0x4f59ec(0x109)](),_0x5ee5e5=_0x39350a['toLowerCase']();let _0x2bb756=0.1;if(_0x562400>=0x17||_0x562400<=0x6)_0x2bb756=0x1;else{if(_0x562400>=0xd&&_0x562400<=0xf)_0x2bb756=0.8;else{if(_0x562400>=0x14&&_0x562400<=0x17)_0x2bb756=0.4;}}let _0xd7f602=0.1;if(_0x5ee5e5[_0x4f59ec(0x10e)](_0x4f59ec(0xff))||_0x5ee5e5[_0x4f59ec(0x10e)](_0x4f59ec(0x126)))_0xd7f602=0x1;else{if(_0x5ee5e5['includes']('wohn')||_0x5ee5e5[_0x4f59ec(0x10e)](_0x4f59ec(0xf7))||_0x5ee5e5[_0x4f59ec(0x10e)](_0x4f59ec(0x119)))_0xd7f602=0.6;else{if(_0x5ee5e5['includes']('bad')||_0x5ee5e5[_0x4f59ec(0x10e)]('wc'))_0xd7f602=0.05;}}let _0x59e28d=0.5;const _0x2c0398=_0xd7f602*0.5+_0x2bb756*0.3+_0x59e28d*0.2;return parseFloat(_0x2c0398[_0x4f59ec(0x117)](0x2));}async function updateLocation(_0x168a0c,_0x3b9378){const _0x1fc5f8=a2_0x1afb37;if(!_0x3b9378||_0x3b9378===_0x1fc5f8(0xf6))return;if(!await isActive(_0x168a0c)){resetTimer(_0x168a0c);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x3b9378){const _0x54c09b=await areRoomsConnected(_0x168a0c,currentMonitoredRoom,_0x3b9378);if(!_0x54c09b){const _0xc2d616=_0x1fc5f8(0xfa)+_0x3b9378+_0x1fc5f8(0x11c)+currentMonitoredRoom+'\x27.';_0x168a0c[_0x1fc5f8(0xf8)]['info'](_0x1fc5f8(0x128)+_0xc2d616+_0x1fc5f8(0x110)),await _0x168a0c[_0x1fc5f8(0x120)](_0x1fc5f8(0x104),{'val':JSON[_0x1fc5f8(0xf4)]({'room':_0x3b9378,'reason':_0xc2d616,'timestamp':Date[_0x1fc5f8(0xf1)]()}),'ack':!![]});return;}resetTimer(_0x168a0c);}if(!currentMonitoredRoom){await _0x168a0c[_0x1fc5f8(0x120)]('analysis.safety.deadMan.currentRoom',{'val':_0x3b9378,'ack':!![]});const _0x27c5a8=await loadConfig(_0x168a0c);let _0x203dad=getTimeoutRobust(_0x27c5a8,_0x3b9378);const _0x11057e=_0x3b9378['toLowerCase']();if(!_0x203dad)for(const _0x49ad2a in DEFAULT_TIMEOUTS){if(_0x11057e[_0x1fc5f8(0x10e)](_0x49ad2a)){_0x203dad=DEFAULT_TIMEOUTS[_0x49ad2a];break;}}if(!_0x203dad&&_0x27c5a8[_0x1fc5f8(0x10b)])_0x203dad=_0x27c5a8[_0x1fc5f8(0x10b)];if(!_0x203dad)return;currentMonitoredRoom=_0x3b9378,startTimer(_0x168a0c,_0x203dad,_0x3b9378);}}function startTimer(_0x4e9137,_0x9f2e45,_0x3c63a0){const _0x518557=a2_0x1afb37;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x9f2e45*0x3c*0x3e8,startTime=Date[_0x518557(0xf1)](),alarmStage=0x0;const _0x284d6d=calculateSleepProbability(_0x3c63a0||currentMonitoredRoom),_0x3ec04f=_0x284d6d>0.65;_0x3ec04f?(timeoutMs+=0x5a*0x3c*0x3e8,_0x4e9137[_0x518557(0xf8)]['info'](_0x518557(0xe9)+(_0x284d6d*0x64)['toFixed'](0x0)+_0x518557(0x111)+currentMonitoredRoom+_0x518557(0xf0)),_0x4e9137[_0x518557(0x120)](_0x518557(0x103),{'val':!![],'ack':!![]})):_0x4e9137[_0x518557(0x120)](_0x518557(0x103),{'val':![],'ack':!![]}),_0x4e9137['setStateAsync'](_0x518557(0x114),{'val':_0x284d6d,'ack':!![]}),_0x4e9137[_0x518557(0xf8)][_0x518557(0x11f)](_0x518557(0x108)+currentMonitoredRoom+_0x518557(0x124)+_0x9f2e45+_0x518557(0x10c)),_0x4e9137['setStateAsync'](_0x518557(0x121),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x4e9137),timeoutMs);}function resetTimer(_0xec3ef2){const _0x23deb1=a2_0x1afb37;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0xec3ef2['setStateAsync'](_0x23deb1(0x121),{'val':'ok','ack':!![]}),_0xec3ef2['setStateAsync']('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0xec3ef2[_0x23deb1(0x120)]('analysis.safety.deadMan.napProbability',{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x5332aa){const _0x532fa1=a2_0x1afb37;alarmStage=0x1,await _0x5332aa['setStateAsync'](_0x532fa1(0x121),{'val':_0x532fa1(0x125),'ack':!![]});const _0xd3b344=_0x532fa1(0x105)+currentMonitoredRoom+_0x532fa1(0x116);_0x5332aa[_0x532fa1(0xf8)][_0x532fa1(0x113)](_0x532fa1(0x128)+_0xd3b344),await setup[_0x532fa1(0x101)](_0x5332aa,'üëº\x20Schutzengel-Frage:\x20'+_0xd3b344),activeTimer=setTimeout(()=>triggerAlarm(_0x5332aa),0x5*0x3c*0x3e8);}async function triggerAlarm(_0xf80fca){const _0x322154=a2_0x1afb37;alarmStage=0x2,await _0xf80fca[_0x322154(0x120)](_0x322154(0x121),{'val':'alarm','ack':!![]});const _0x26796c=_0x322154(0xf2)+currentMonitoredRoom+'!';_0xf80fca[_0x322154(0xf8)][_0x322154(0x10d)]('[DeadMan]\x20'+_0x26796c),await setup[_0x322154(0x101)](_0xf80fca,_0x26796c,![],!![]);}module[a2_0x1afb37(0x106)]={'updateLocation':updateLocation};function a2_0x246b(){const _0x182496=['65nonVmb','5464781gJJkFo','[DeadMan]\x20Topology\x20check\x20failed:\x20','schlaf','591LovKcP','sendNotification','5ncdREH','analysis.safety.deadMan.smartSleep','analysis.safety.deadMan.lastIgnored','‚è≥\x20ACHTUNG:\x20Ungew√∂hnlich\x20lange\x20Inaktivit√§t\x20in\x20','exports','apply','üëº\x20Schutzengel:\x20√úberwache\x20','getHours','replace','default','\x20Min.','error','includes','analysis.topology.structure','\x20(Multi-Person\x20Filter)','%).\x20Verl√§ngere\x20Timer\x20f√ºr\x20','(((.+)+)+)+$','warn','analysis.safety.deadMan.napProbability','6zPfKLS','.\x20Alles\x20in\x20Ordnung?','toFixed','75042rnGLYw','sofa','val','./setup','\x27.\x20Nicht\x20verbunden\x20mit\x20√ºberwachtem\x20\x27','938796oFBhWi','search','info','setStateAsync','analysis.safety.deadMan.alarmState','parse','toLowerCase','\x20f√ºr\x20','pre_warn','bed','24euJsxg','[DeadMan]\x20','605haPOpr','üí§\x20Smart\x20Sleep\x20erkannt\x20(','constructor','10018IPpICB','getStateAsync','3391856IWCPor','1125420pRJSsE','indexOf','\x20um\x2090\x20Min.','now','üö®\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','analysis.safety.deadMan.active','stringify','toString','Unknown','living','log','73560oGVFis','Ignoriere\x20Bewegung\x20in\x20\x27','analysis.safety.deadMan.config'];a2_0x246b=function(){return _0x182496;};return a2_0x246b();}