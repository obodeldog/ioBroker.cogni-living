const a2_0x257151=a2_0x2db5;(function(_0x430842,_0x8243c9){const _0x310a11=a2_0x2db5,_0x330a9f=_0x430842();while(!![]){try{const _0x5945c3=parseInt(_0x310a11(0x138))/0x1+-parseInt(_0x310a11(0x132))/0x2*(parseInt(_0x310a11(0x10c))/0x3)+-parseInt(_0x310a11(0x114))/0x4+-parseInt(_0x310a11(0x119))/0x5*(-parseInt(_0x310a11(0x12d))/0x6)+parseInt(_0x310a11(0x135))/0x7*(-parseInt(_0x310a11(0x130))/0x8)+parseInt(_0x310a11(0x110))/0x9*(parseInt(_0x310a11(0x136))/0xa)+parseInt(_0x310a11(0x133))/0xb;if(_0x5945c3===_0x8243c9)break;else _0x330a9f['push'](_0x330a9f['shift']());}catch(_0x373879){_0x330a9f['push'](_0x330a9f['shift']());}}}(a2_0x3cc4,0x2dae6));function a2_0x3cc4(){const _0x282841=['stringify','constructor','toLowerCase','analysis.safety.deadMan.currentRoom','toString','sendNotification','val','exports','search','12HOfkom','analysis.topology.structure','./setup','32FjgRdB','pre_warn','121288EzMKnS','1775906zRTGrf','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','419825YnqgEQ','110410kQQeYt','analysis.safety.deadMan.lastIgnored','230112BEwSnR','analysis.safety.deadMan.config','.\x20Alles\x20in\x20Ordnung?','[DeadMan]\x20Topology\x20check\x20failed:\x20','(((.+)+)+)+$','Ignoriere\x20Bewegung\x20in\x20\x27','6kFbYVj','\x20Min.','\x20fÃ¼r\x20','indexOf','9IMMzuT','ðŸ‘¼\x20Schutzengel-Frage:\x20','getStateAsync','log','745948xmcpmk','parse','Unknown','analysis.safety.deadMan.alarmState','setStateAsync','830465guADuX','now','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','apply','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','default','warn','analysis.safety.deadMan.active','info','alarm'];a2_0x3cc4=function(){return _0x282841;};return a2_0x3cc4();}const a2_0x283a0d=(function(){let _0x11cf23=!![];return function(_0x4a0e02,_0x464a8c){const _0x34945b=_0x11cf23?function(){const _0x5153c1=a2_0x2db5;if(_0x464a8c){const _0x3b7f38=_0x464a8c[_0x5153c1(0x11d)](_0x4a0e02,arguments);return _0x464a8c=null,_0x3b7f38;}}:function(){};return _0x11cf23=![],_0x34945b;};}()),a2_0x7032ab=a2_0x283a0d(this,function(){const _0x35eac3=a2_0x2db5;return a2_0x7032ab['toString']()[_0x35eac3(0x12c)](_0x35eac3(0x10a))[_0x35eac3(0x128)]()[_0x35eac3(0x125)](a2_0x7032ab)[_0x35eac3(0x12c)](_0x35eac3(0x10a));});a2_0x7032ab();'use strict';function a2_0x2db5(_0x28bb57,_0x554411){const _0x7fb37b=a2_0x3cc4();return a2_0x2db5=function(_0x7032ab,_0x283a0d){_0x7032ab=_0x7032ab-0x108;let _0x3cc4a6=_0x7fb37b[_0x7032ab];return _0x3cc4a6;},a2_0x2db5(_0x28bb57,_0x554411);}const setup=require(a2_0x257151(0x12f));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x36b967){const _0x553914=a2_0x257151;try{const _0xdd51bc=await _0x36b967['getStateAsync'](_0x553914(0x139));if(_0xdd51bc&&_0xdd51bc[_0x553914(0x12a)])return JSON[_0x553914(0x115)](_0xdd51bc[_0x553914(0x12a)]);}catch(_0x19965c){}return{};}async function isActive(_0x40bea9){const _0x58ccfc=a2_0x257151;try{const _0x38bab3=await _0x40bea9[_0x58ccfc(0x112)](_0x58ccfc(0x121));return _0x38bab3&&_0x38bab3['val'];}catch(_0x1cb49f){return![];}}async function areRoomsConnected(_0xe81741,_0x223d43,_0x58326a){const _0x44030c=a2_0x257151;try{const _0x545b98=await _0xe81741[_0x44030c(0x112)](_0x44030c(0x12e));if(!_0x545b98||!_0x545b98[_0x44030c(0x12a)])return!![];const _0x2f7be9=JSON[_0x44030c(0x115)](_0x545b98[_0x44030c(0x12a)]),{rooms:_0x25b2fb,matrix:_0x2527b4}=_0x2f7be9;if(!_0x25b2fb||!_0x2527b4)return!![];const _0x1d1bc0=_0x25b2fb[_0x44030c(0x10f)](_0x223d43),_0x37bc1d=_0x25b2fb['indexOf'](_0x58326a);if(_0x1d1bc0===-0x1||_0x37bc1d===-0x1)return!![];const _0x2680ad=_0x2527b4[_0x1d1bc0][_0x37bc1d]>0x0||_0x2527b4[_0x37bc1d][_0x1d1bc0]>0x0;return _0x2680ad;}catch(_0x1c1618){return _0xe81741[_0x44030c(0x113)][_0x44030c(0x120)](_0x44030c(0x109)+_0x1c1618['message']),!![];}}async function updateLocation(_0x3f8eda,_0x16683c){const _0x66cf6b=a2_0x257151;if(!_0x16683c||_0x16683c===_0x66cf6b(0x116))return;if(!await isActive(_0x3f8eda)){resetTimer(_0x3f8eda);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x16683c){const _0x29bc56=await areRoomsConnected(_0x3f8eda,currentMonitoredRoom,_0x16683c);if(!_0x29bc56){const _0x42ff97=_0x66cf6b(0x10b)+_0x16683c+_0x66cf6b(0x11b)+currentMonitoredRoom+'\x27.';_0x3f8eda[_0x66cf6b(0x113)][_0x66cf6b(0x122)]('[DeadMan]\x20'+_0x42ff97+'\x20(Multi-Person\x20Filter)'),await _0x3f8eda[_0x66cf6b(0x118)](_0x66cf6b(0x137),{'val':JSON[_0x66cf6b(0x124)]({'room':_0x16683c,'reason':_0x42ff97,'timestamp':Date[_0x66cf6b(0x11a)]()}),'ack':!![]});return;}resetTimer(_0x3f8eda);}if(!currentMonitoredRoom){await _0x3f8eda[_0x66cf6b(0x118)](_0x66cf6b(0x127),{'val':_0x16683c,'ack':!![]});const _0x54b89e=await loadConfig(_0x3f8eda),_0x31f150=_0x16683c[_0x66cf6b(0x126)]();let _0x4a8541=_0x54b89e[_0x16683c]||_0x54b89e[_0x31f150];if(!_0x4a8541)for(const _0x39ca0d in DEFAULT_TIMEOUTS){if(_0x31f150['includes'](_0x39ca0d)){_0x4a8541=DEFAULT_TIMEOUTS[_0x39ca0d];break;}}if(!_0x4a8541&&_0x54b89e['default'])_0x4a8541=_0x54b89e[_0x66cf6b(0x11f)];if(!_0x4a8541)return;currentMonitoredRoom=_0x16683c,startTimer(_0x3f8eda,_0x4a8541);}}function startTimer(_0x61b5a7,_0x35f24c){const _0x4ac6d0=a2_0x257151;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x35f24c*0x3c*0x3e8,startTime=Date[_0x4ac6d0(0x11a)](),alarmStage=0x0,_0x61b5a7['log'][_0x4ac6d0(0x122)](_0x4ac6d0(0x11c)+currentMonitoredRoom+_0x4ac6d0(0x10e)+_0x35f24c+_0x4ac6d0(0x10d)),_0x61b5a7[_0x4ac6d0(0x118)](_0x4ac6d0(0x117),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x61b5a7),timeoutMs);}function resetTimer(_0x5796fe){const _0x504bd1=a2_0x257151;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x5796fe['setStateAsync'](_0x504bd1(0x117),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x209ee9){const _0x3f358e=a2_0x257151;alarmStage=0x1,await _0x209ee9['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':_0x3f358e(0x131),'ack':!![]});const _0x4728a8=_0x3f358e(0x134)+currentMonitoredRoom+_0x3f358e(0x108);_0x209ee9['log'][_0x3f358e(0x120)]('[DeadMan]\x20'+_0x4728a8),await setup[_0x3f358e(0x129)](_0x209ee9,_0x3f358e(0x111)+_0x4728a8),activeTimer=setTimeout(()=>triggerAlarm(_0x209ee9),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x363770){const _0x52325a=a2_0x257151;alarmStage=0x2,await _0x363770[_0x52325a(0x118)](_0x52325a(0x117),{'val':_0x52325a(0x123),'ack':!![]});const _0x246fdf=_0x52325a(0x11e)+currentMonitoredRoom+'!';_0x363770[_0x52325a(0x113)]['error']('[DeadMan]\x20'+_0x246fdf),await setup[_0x52325a(0x129)](_0x363770,_0x246fdf,![],!![]);}module[a2_0x257151(0x12b)]={'updateLocation':updateLocation};