const a2_0x124064=a2_0x1fe0;(function(_0x55f7c1,_0x590606){const _0x2a2556=a2_0x1fe0,_0x37ae94=_0x55f7c1();while(!![]){try{const _0x585277=parseInt(_0x2a2556(0x1f1))/0x1+parseInt(_0x2a2556(0x1ed))/0x2*(parseInt(_0x2a2556(0x1f6))/0x3)+parseInt(_0x2a2556(0x1f8))/0x4*(parseInt(_0x2a2556(0x1ff))/0x5)+-parseInt(_0x2a2556(0x204))/0x6*(-parseInt(_0x2a2556(0x1f5))/0x7)+parseInt(_0x2a2556(0x1e5))/0x8+-parseInt(_0x2a2556(0x207))/0x9+parseInt(_0x2a2556(0x1ec))/0xa*(-parseInt(_0x2a2556(0x1ee))/0xb);if(_0x585277===_0x590606)break;else _0x37ae94['push'](_0x37ae94['shift']());}catch(_0x29c991){_0x37ae94['push'](_0x37ae94['shift']());}}}(a2_0x2b6e,0x50301));const a2_0x295e79=(function(){let _0x9e0e2e=!![];return function(_0x57c67b,_0x35a0d8){const _0x16378d=_0x9e0e2e?function(){if(_0x35a0d8){const _0x47dce8=_0x35a0d8['apply'](_0x57c67b,arguments);return _0x35a0d8=null,_0x47dce8;}}:function(){};return _0x9e0e2e=![],_0x16378d;};}()),a2_0x2d9339=a2_0x295e79(this,function(){const _0x1233c6=a2_0x1fe0;return a2_0x2d9339['toString']()['search'](_0x1233c6(0x1df))[_0x1233c6(0x1e3)]()[_0x1233c6(0x1dd)](a2_0x2d9339)['search']('(((.+)+)+)+$');});a2_0x2d9339();'use strict';function a2_0x1fe0(_0x23123c,_0x58e5c6){const _0x5c129c=a2_0x2b6e();return a2_0x1fe0=function(_0x2d9339,_0x295e79){_0x2d9339=_0x2d9339-0x1dc;let _0x2b6e49=_0x5c129c[_0x2d9339];return _0x2b6e49;},a2_0x1fe0(_0x23123c,_0x58e5c6);}const setup=require(a2_0x124064(0x1f9));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x11e1c9){const _0x275228=a2_0x124064;try{const _0xc62630=await _0x11e1c9[_0x275228(0x1de)](_0x275228(0x1e8));if(_0xc62630&&_0xc62630[_0x275228(0x1fa)])return JSON[_0x275228(0x1f3)](_0xc62630['val']);}catch(_0x1916b8){}return{};}function a2_0x2b6e(){const _0x3eadf8=['95tevKem','[DeadMan]\x20Topology\x20check\x20failed:\x20','indexOf','\x20fÃ¼r\x20','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','18hiLkDV','setStateAsync','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','5497164ptlafY','.\x20Alles\x20in\x20Ordnung?','toLowerCase','error','now','constructor','getStateAsync','(((.+)+)+)+$','analysis.safety.deadMan.lastIgnored','\x20(Multi-Person\x20Filter)','warn','toString','log','1243144NQuUYT','info','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','analysis.safety.deadMan.config','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','message','exports','883910jTrnBG','12ZFvUPl','11gBHWDM','\x20Min.','includes','65751sKImRv','analysis.topology.structure','parse','Ignoriere\x20Bewegung\x20in\x20\x27','730163sxWbAm','71232limMJv','sendNotification','73916WmUiWa','./setup','val','default','analysis.safety.deadMan.active','[DeadMan]\x20','pre_warn'];a2_0x2b6e=function(){return _0x3eadf8;};return a2_0x2b6e();}async function isActive(_0x53889d){const _0xf1ed72=a2_0x124064;try{const _0x4149c9=await _0x53889d[_0xf1ed72(0x1de)](_0xf1ed72(0x1fc));return _0x4149c9&&_0x4149c9[_0xf1ed72(0x1fa)];}catch(_0x513b4f){return![];}}async function areRoomsConnected(_0x5dbd7e,_0xdda06b,_0x372ac0){const _0x492c31=a2_0x124064;try{const _0x529ad9=await _0x5dbd7e['getStateAsync'](_0x492c31(0x1f2));if(!_0x529ad9||!_0x529ad9[_0x492c31(0x1fa)])return!![];const _0x532ed7=JSON[_0x492c31(0x1f3)](_0x529ad9[_0x492c31(0x1fa)]),{rooms:_0x3dac74,matrix:_0x2ef534}=_0x532ed7;if(!_0x3dac74||!_0x2ef534)return!![];const _0x41f4df=_0x3dac74[_0x492c31(0x201)](_0xdda06b),_0x174f39=_0x3dac74[_0x492c31(0x201)](_0x372ac0);if(_0x41f4df===-0x1||_0x174f39===-0x1)return!![];const _0x57ef77=_0x2ef534[_0x41f4df][_0x174f39]>0x0||_0x2ef534[_0x174f39][_0x41f4df]>0x0;return _0x57ef77;}catch(_0x21c88c){return _0x5dbd7e[_0x492c31(0x1e4)][_0x492c31(0x1e2)](_0x492c31(0x200)+_0x21c88c[_0x492c31(0x1ea)]),!![];}}async function updateLocation(_0xcc13fb,_0x90e833){const _0x4b6d1e=a2_0x124064;if(!_0x90e833||_0x90e833==='Unknown')return;if(!await isActive(_0xcc13fb)){resetTimer(_0xcc13fb);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x90e833){const _0xdff609=await areRoomsConnected(_0xcc13fb,currentMonitoredRoom,_0x90e833);if(!_0xdff609){const _0x54f0f6=_0x4b6d1e(0x1f4)+_0x90e833+_0x4b6d1e(0x1e9)+currentMonitoredRoom+'\x27.';_0xcc13fb['log'][_0x4b6d1e(0x1e6)](_0x4b6d1e(0x1fd)+_0x54f0f6+_0x4b6d1e(0x1e1)),await _0xcc13fb[_0x4b6d1e(0x205)](_0x4b6d1e(0x1e0),{'val':JSON['stringify']({'room':_0x90e833,'reason':_0x54f0f6,'timestamp':Date[_0x4b6d1e(0x1dc)]()}),'ack':!![]});return;}resetTimer(_0xcc13fb);}if(!currentMonitoredRoom){await _0xcc13fb['setStateAsync']('analysis.safety.deadMan.currentRoom',{'val':_0x90e833,'ack':!![]});const _0x13f307=await loadConfig(_0xcc13fb),_0x408b16=_0x90e833[_0x4b6d1e(0x209)]();let _0x4335b7=_0x13f307[_0x90e833]||_0x13f307[_0x408b16];if(!_0x4335b7)for(const _0x6956a3 in DEFAULT_TIMEOUTS){if(_0x408b16[_0x4b6d1e(0x1f0)](_0x6956a3)){_0x4335b7=DEFAULT_TIMEOUTS[_0x6956a3];break;}}if(!_0x4335b7&&_0x13f307[_0x4b6d1e(0x1fb)])_0x4335b7=_0x13f307['default'];if(!_0x4335b7)return;currentMonitoredRoom=_0x90e833,startTimer(_0xcc13fb,_0x4335b7);}}function startTimer(_0x176802,_0x9975c3){const _0x442a91=a2_0x124064;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x9975c3*0x3c*0x3e8,startTime=Date[_0x442a91(0x1dc)](),alarmStage=0x0,_0x176802[_0x442a91(0x1e4)][_0x442a91(0x1e6)](_0x442a91(0x206)+currentMonitoredRoom+_0x442a91(0x202)+_0x9975c3+_0x442a91(0x1ef)),_0x176802[_0x442a91(0x205)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x176802),timeoutMs);}function resetTimer(_0x9f55ad){if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x9f55ad['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x420c1c){const _0xe454e2=a2_0x124064;alarmStage=0x1,await _0x420c1c[_0xe454e2(0x205)]('analysis.safety.deadMan.alarmState',{'val':_0xe454e2(0x1fe),'ack':!![]});const _0x34e3eb=_0xe454e2(0x203)+currentMonitoredRoom+_0xe454e2(0x208);_0x420c1c['log'][_0xe454e2(0x1e2)](_0xe454e2(0x1fd)+_0x34e3eb),await setup[_0xe454e2(0x1f7)](_0x420c1c,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x34e3eb),activeTimer=setTimeout(()=>triggerAlarm(_0x420c1c),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x2cb5ed){const _0xf38a9=a2_0x124064;alarmStage=0x2,await _0x2cb5ed[_0xf38a9(0x205)]('analysis.safety.deadMan.alarmState',{'val':'alarm','ack':!![]});const _0x4b19ab=_0xf38a9(0x1e7)+currentMonitoredRoom+'!';_0x2cb5ed[_0xf38a9(0x1e4)][_0xf38a9(0x20a)](_0xf38a9(0x1fd)+_0x4b19ab),await setup[_0xf38a9(0x1f7)](_0x2cb5ed,_0x4b19ab,![],!![]);}module[a2_0x124064(0x1eb)]={'updateLocation':updateLocation};