const a2_0x20a760=a2_0x55e8;(function(_0x2b4716,_0x44b236){const _0x13d404=a2_0x55e8,_0x520bfe=_0x2b4716();while(!![]){try{const _0x54cf6a=-parseInt(_0x13d404(0x15d))/0x1*(parseInt(_0x13d404(0x175))/0x2)+parseInt(_0x13d404(0x160))/0x3*(parseInt(_0x13d404(0x151))/0x4)+parseInt(_0x13d404(0x156))/0x5+-parseInt(_0x13d404(0x153))/0x6+parseInt(_0x13d404(0x170))/0x7*(parseInt(_0x13d404(0x154))/0x8)+parseInt(_0x13d404(0x16b))/0x9*(-parseInt(_0x13d404(0x157))/0xa)+parseInt(_0x13d404(0x171))/0xb;if(_0x54cf6a===_0x44b236)break;else _0x520bfe['push'](_0x520bfe['shift']());}catch(_0x56e849){_0x520bfe['push'](_0x520bfe['shift']());}}}(a2_0x50a8,0x85d5d));const a2_0x3d9e29=(function(){let _0x5a801c=!![];return function(_0x3e5954,_0x3923d9){const _0x5c8642=_0x5a801c?function(){const _0x276ea2=a2_0x55e8;if(_0x3923d9){const _0x5c58c7=_0x3923d9[_0x276ea2(0x152)](_0x3e5954,arguments);return _0x3923d9=null,_0x5c58c7;}}:function(){};return _0x5a801c=![],_0x5c8642;};}()),a2_0x7a69d9=a2_0x3d9e29(this,function(){const _0x2155df=a2_0x55e8;return a2_0x7a69d9[_0x2155df(0x169)]()[_0x2155df(0x16c)](_0x2155df(0x168))[_0x2155df(0x169)]()[_0x2155df(0x14e)](a2_0x7a69d9)['search'](_0x2155df(0x168));});a2_0x7a69d9();'use strict';function a2_0x55e8(_0x592ad5,_0x1f0fad){const _0x365762=a2_0x50a8();return a2_0x55e8=function(_0x7a69d9,_0x3d9e29){_0x7a69d9=_0x7a69d9-0x14b;let _0x50a8b2=_0x365762[_0x7a69d9];return _0x50a8b2;},a2_0x55e8(_0x592ad5,_0x1f0fad);}const setup=require('./setup');let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x1740bb){const _0x531041=a2_0x55e8;try{const _0x45c283=await _0x1740bb[_0x531041(0x173)](_0x531041(0x163));if(_0x45c283&&_0x45c283[_0x531041(0x16a)])return JSON[_0x531041(0x174)](_0x45c283[_0x531041(0x16a)]);}catch(_0x279ab6){}return{};}async function isActive(_0xe25a74){const _0x570d50=a2_0x55e8;try{const _0x24926f=await _0xe25a74[_0x570d50(0x173)](_0x570d50(0x162));return _0x24926f&&_0x24926f[_0x570d50(0x16a)];}catch(_0x175a1e){return![];}}async function areRoomsConnected(_0xb44979,_0x91e42c,_0x255e44){const _0x3b3867=a2_0x55e8;try{const _0x5af138=await _0xb44979['getStateAsync'](_0x3b3867(0x172));if(!_0x5af138||!_0x5af138['val'])return!![];const _0x4ee272=JSON['parse'](_0x5af138['val']),{rooms:_0x1f5dbd,matrix:_0x36cb38}=_0x4ee272;if(!_0x1f5dbd||!_0x36cb38)return!![];const _0x360171=_0x1f5dbd[_0x3b3867(0x167)](_0x91e42c),_0x21dee1=_0x1f5dbd[_0x3b3867(0x167)](_0x255e44);if(_0x360171===-0x1||_0x21dee1===-0x1)return!![];const _0x5d9006=_0x36cb38[_0x360171][_0x21dee1]>0x0||_0x36cb38[_0x21dee1][_0x360171]>0x0;return _0x5d9006;}catch(_0x2c3b3d){return _0xb44979[_0x3b3867(0x14d)]['warn'](_0x3b3867(0x14b)+_0x2c3b3d['message']),!![];}}async function updateLocation(_0x3d4239,_0x13ef02){const _0x59219c=a2_0x55e8;if(!_0x13ef02||_0x13ef02===_0x59219c(0x150))return;if(!await isActive(_0x3d4239)){resetTimer(_0x3d4239);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x13ef02){const _0x25b2b3=await areRoomsConnected(_0x3d4239,currentMonitoredRoom,_0x13ef02);if(!_0x25b2b3){const _0x58f69a='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x13ef02+'\x27.\x20Nicht\x20verbunden\x20mit\x20√ºberwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0x3d4239[_0x59219c(0x14d)][_0x59219c(0x16e)](_0x59219c(0x161)+_0x58f69a+_0x59219c(0x15b)),await _0x3d4239[_0x59219c(0x158)](_0x59219c(0x15a),{'val':JSON['stringify']({'room':_0x13ef02,'reason':_0x58f69a,'timestamp':Date['now']()}),'ack':!![]});return;}resetTimer(_0x3d4239);}if(!currentMonitoredRoom){await _0x3d4239[_0x59219c(0x158)]('analysis.safety.deadMan.currentRoom',{'val':_0x13ef02,'ack':!![]});const _0x5a00e3=await loadConfig(_0x3d4239),_0x4d5576=_0x13ef02[_0x59219c(0x15f)]();let _0x20c915=_0x5a00e3[_0x13ef02]||_0x5a00e3[_0x4d5576];if(!_0x20c915)for(const _0x2b8b11 in DEFAULT_TIMEOUTS){if(_0x4d5576['includes'](_0x2b8b11)){_0x20c915=DEFAULT_TIMEOUTS[_0x2b8b11];break;}}if(!_0x20c915&&_0x5a00e3[_0x59219c(0x159)])_0x20c915=_0x5a00e3['default'];if(!_0x20c915)return;currentMonitoredRoom=_0x13ef02,startTimer(_0x3d4239,_0x20c915);}}function startTimer(_0x4c375e,_0x3ac242){const _0x3d995f=a2_0x55e8;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3ac242*0x3c*0x3e8,startTime=Date[_0x3d995f(0x155)](),alarmStage=0x0,_0x4c375e[_0x3d995f(0x14d)][_0x3d995f(0x16e)]('üëº\x20Schutzengel:\x20√úberwache\x20'+currentMonitoredRoom+_0x3d995f(0x16d)+_0x3ac242+_0x3d995f(0x16f)),_0x4c375e[_0x3d995f(0x158)](_0x3d995f(0x165),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x4c375e),timeoutMs);}function resetTimer(_0x5f4148){const _0x82c6a4=a2_0x55e8;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x5f4148['setStateAsync'](_0x82c6a4(0x165),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x1bf343){const _0x5693a8=a2_0x55e8;alarmStage=0x1,await _0x1bf343['setStateAsync'](_0x5693a8(0x165),{'val':'pre_warn','ack':!![]});const _0x30e09d=_0x5693a8(0x14c)+currentMonitoredRoom+_0x5693a8(0x15c);_0x1bf343[_0x5693a8(0x14d)]['warn'](_0x5693a8(0x161)+_0x30e09d),await setup['sendNotification'](_0x1bf343,'üëº\x20Schutzengel-Frage:\x20'+_0x30e09d),activeTimer=setTimeout(()=>triggerAlarm(_0x1bf343),0x5*0x3c*0x3e8);}function a2_0x50a8(){const _0x278ab9=['info','\x20Min.','49njcahs','6920078bEoqeo','analysis.topology.structure','getStateAsync','parse','45032vioPLX','[DeadMan]\x20Topology\x20check\x20failed:\x20','‚è≥\x20ACHTUNG:\x20Ungew√∂hnlich\x20lange\x20Inaktivit√§t\x20in\x20','log','constructor','üö®\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','Unknown','400936ilcVnT','apply','1726356NUNLVp','180792ZDYWNr','now','3655170QoTIDS','5226220UYjMtw','setStateAsync','default','analysis.safety.deadMan.lastIgnored','\x20(Multi-Person\x20Filter)','.\x20Alles\x20in\x20Ordnung?','16LLHlqX','alarm','toLowerCase','6ZhIokq','[DeadMan]\x20','analysis.safety.deadMan.active','analysis.safety.deadMan.config','exports','analysis.safety.deadMan.alarmState','sendNotification','indexOf','(((.+)+)+)+$','toString','val','9QsbfBW','search','\x20f√ºr\x20'];a2_0x50a8=function(){return _0x278ab9;};return a2_0x50a8();}async function triggerAlarm(_0x3a2e86){const _0x5f25e9=a2_0x55e8;alarmStage=0x2,await _0x3a2e86[_0x5f25e9(0x158)](_0x5f25e9(0x165),{'val':_0x5f25e9(0x15e),'ack':!![]});const _0x22b1e8=_0x5f25e9(0x14f)+currentMonitoredRoom+'!';_0x3a2e86[_0x5f25e9(0x14d)]['error'](_0x5f25e9(0x161)+_0x22b1e8),await setup[_0x5f25e9(0x166)](_0x3a2e86,_0x22b1e8,![],!![]);}module[a2_0x20a760(0x164)]={'updateLocation':updateLocation};