const a2_0x52c4d6=a2_0x4eed;(function(_0x4d117b,_0x41c853){const _0x8d5696=a2_0x4eed,_0x2cfc61=_0x4d117b();while(!![]){try{const _0x3ed537=parseInt(_0x8d5696(0x1f9))/0x1+-parseInt(_0x8d5696(0x201))/0x2*(parseInt(_0x8d5696(0x1da))/0x3)+-parseInt(_0x8d5696(0x1f2))/0x4+-parseInt(_0x8d5696(0x1fa))/0x5*(-parseInt(_0x8d5696(0x1dc))/0x6)+-parseInt(_0x8d5696(0x1ec))/0x7+-parseInt(_0x8d5696(0x1ed))/0x8+parseInt(_0x8d5696(0x205))/0x9;if(_0x3ed537===_0x41c853)break;else _0x2cfc61['push'](_0x2cfc61['shift']());}catch(_0x3d7388){_0x2cfc61['push'](_0x2cfc61['shift']());}}}(a2_0x1c44,0x78fde));const a2_0xfa48c4=(function(){let _0x4d2c4c=!![];return function(_0x109fe7,_0x161065){const _0x357295=_0x4d2c4c?function(){const _0x2fe36c=a2_0x4eed;if(_0x161065){const _0xfe1dd5=_0x161065[_0x2fe36c(0x1fe)](_0x109fe7,arguments);return _0x161065=null,_0xfe1dd5;}}:function(){};return _0x4d2c4c=![],_0x357295;};}()),a2_0x31014e=a2_0xfa48c4(this,function(){const _0x5f2c5e=a2_0x4eed;return a2_0x31014e[_0x5f2c5e(0x1e2)]()[_0x5f2c5e(0x1e0)](_0x5f2c5e(0x1f5))[_0x5f2c5e(0x1e2)]()[_0x5f2c5e(0x1d9)](a2_0x31014e)[_0x5f2c5e(0x1e0)](_0x5f2c5e(0x1f5));});a2_0x31014e();'use strict';const setup=require(a2_0x52c4d6(0x1f0));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x5dd930){const _0x242cde=a2_0x52c4d6;try{const _0x1bf5f5=await _0x5dd930[_0x242cde(0x1fc)](_0x242cde(0x1ff));if(_0x1bf5f5&&_0x1bf5f5[_0x242cde(0x1fd)])return JSON[_0x242cde(0x1de)](_0x1bf5f5[_0x242cde(0x1fd)]);}catch(_0x39c833){}return{};}async function isActive(_0x3dee43){const _0x1d3c30=a2_0x52c4d6;try{const _0x34b2aa=await _0x3dee43[_0x1d3c30(0x1fc)](_0x1d3c30(0x1f7));return _0x34b2aa&&_0x34b2aa[_0x1d3c30(0x1fd)];}catch(_0x17b979){return![];}}async function areRoomsConnected(_0x19e53d,_0x516c12,_0x41f4df){const _0x2be8bb=a2_0x52c4d6;try{const _0x1bc96f=await _0x19e53d[_0x2be8bb(0x1fc)](_0x2be8bb(0x1ea));if(!_0x1bc96f||!_0x1bc96f['val'])return!![];const _0xb85899=JSON[_0x2be8bb(0x1de)](_0x1bc96f['val']),{rooms:_0x4602f3,matrix:_0x4c60d7}=_0xb85899;if(!_0x4602f3||!_0x4c60d7)return!![];const _0x4d6020=_0x4602f3['indexOf'](_0x516c12),_0x1561bc=_0x4602f3[_0x2be8bb(0x203)](_0x41f4df);if(_0x4d6020===-0x1||_0x1561bc===-0x1)return!![];const _0x25eaaa=_0x4c60d7[_0x4d6020][_0x1561bc]>0x0||_0x4c60d7[_0x1561bc][_0x4d6020]>0x0;return _0x25eaaa;}catch(_0x399318){return _0x19e53d[_0x2be8bb(0x1e5)][_0x2be8bb(0x1e9)](_0x2be8bb(0x1e6)+_0x399318[_0x2be8bb(0x1d8)]),!![];}}async function updateLocation(_0x3ed5bb,_0x43a3d1){const _0x3b594e=a2_0x52c4d6;if(!_0x43a3d1||_0x43a3d1===_0x3b594e(0x1e1))return;if(!await isActive(_0x3ed5bb)){resetTimer(_0x3ed5bb);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x43a3d1){const _0x10d3ce=await areRoomsConnected(_0x3ed5bb,currentMonitoredRoom,_0x43a3d1);if(!_0x10d3ce){_0x3ed5bb[_0x3b594e(0x1e5)][_0x3b594e(0x1e7)](_0x3b594e(0x1eb)+_0x43a3d1+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+_0x3b594e(0x1d7));return;}resetTimer(_0x3ed5bb);}if(!currentMonitoredRoom){await _0x3ed5bb[_0x3b594e(0x1f4)](_0x3b594e(0x1e3),{'val':_0x43a3d1,'ack':!![]});const _0x55c042=await loadConfig(_0x3ed5bb),_0x307e14=_0x43a3d1[_0x3b594e(0x1f8)]();let _0x283baf=_0x55c042[_0x43a3d1]||_0x55c042[_0x307e14];if(!_0x283baf)for(const _0x561f7e in DEFAULT_TIMEOUTS){if(_0x307e14[_0x3b594e(0x1dd)](_0x561f7e)){_0x283baf=DEFAULT_TIMEOUTS[_0x561f7e];break;}}if(!_0x283baf&&_0x55c042[_0x3b594e(0x1ee)])_0x283baf=_0x55c042[_0x3b594e(0x1ee)];if(!_0x283baf)return;currentMonitoredRoom=_0x43a3d1,startTimer(_0x3ed5bb,_0x283baf);}}function startTimer(_0x36434d,_0x425f2f){const _0x115231=a2_0x52c4d6;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x425f2f*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0,_0x36434d['log'][_0x115231(0x1e7)](_0x115231(0x204)+currentMonitoredRoom+_0x115231(0x1e4)+_0x425f2f+_0x115231(0x200)),_0x36434d['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x36434d),timeoutMs);}function resetTimer(_0x1e37b5){const _0x1b1f26=a2_0x52c4d6;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x1e37b5[_0x1b1f26(0x1f4)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}function a2_0x1c44(){const _0x5e764f=['analysis.safety.deadMan.active','toLowerCase','276105QBAkDO','4145Xwpblx','.\x20Alles\x20in\x20Ordnung?','getStateAsync','val','apply','analysis.safety.deadMan.config','\x20Min.','34Bjsppy','sendNotification','indexOf','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','12636531EsWSNc','\x27.\x20(Multi-Person\x20Filter)','message','constructor','24621uEfssH','ðŸ‘¼\x20Schutzengel-Frage:\x20','2466qYRocq','includes','parse','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','search','Unknown','toString','analysis.safety.deadMan.currentRoom','\x20fÃ¼r\x20','log','[DeadMan]\x20Topology\x20check\x20failed:\x20','info','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','warn','analysis.topology.structure','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','3838233exHACP','3310120STymkd','default','analysis.safety.deadMan.alarmState','./setup','error','1694792ZivkQu','[DeadMan]\x20','setStateAsync','(((.+)+)+)+$','pre_warn'];a2_0x1c44=function(){return _0x5e764f;};return a2_0x1c44();}async function triggerPreWarn(_0x1d0f04){const _0x54eb0b=a2_0x52c4d6;alarmStage=0x1,await _0x1d0f04[_0x54eb0b(0x1f4)](_0x54eb0b(0x1ef),{'val':_0x54eb0b(0x1f6),'ack':!![]});const _0x1c895c=_0x54eb0b(0x1df)+currentMonitoredRoom+_0x54eb0b(0x1fb);_0x1d0f04[_0x54eb0b(0x1e5)]['warn'](_0x54eb0b(0x1f3)+_0x1c895c),await setup[_0x54eb0b(0x202)](_0x1d0f04,_0x54eb0b(0x1db)+_0x1c895c),activeTimer=setTimeout(()=>triggerAlarm(_0x1d0f04),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x2edae5){const _0xdee6a3=a2_0x52c4d6;alarmStage=0x2,await _0x2edae5['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'alarm','ack':!![]});const _0x53f5ac=_0xdee6a3(0x1e8)+currentMonitoredRoom+'!';_0x2edae5['log'][_0xdee6a3(0x1f1)]('[DeadMan]\x20'+_0x53f5ac),await setup[_0xdee6a3(0x202)](_0x2edae5,_0x53f5ac,![],!![]);}function a2_0x4eed(_0x397dda,_0x24fdc9){const _0x355049=a2_0x1c44();return a2_0x4eed=function(_0x31014e,_0xfa48c4){_0x31014e=_0x31014e-0x1d7;let _0x1c445b=_0x355049[_0x31014e];return _0x1c445b;},a2_0x4eed(_0x397dda,_0x24fdc9);}module['exports']={'updateLocation':updateLocation};