const a2_0x480796=a2_0x2bad;(function(_0x56b81c,_0x2a53b2){const _0x521aa1=a2_0x2bad,_0xd9197c=_0x56b81c();while(!![]){try{const _0x5115ba=parseInt(_0x521aa1(0x147))/0x1*(-parseInt(_0x521aa1(0x135))/0x2)+-parseInt(_0x521aa1(0x13c))/0x3+-parseInt(_0x521aa1(0x12e))/0x4+-parseInt(_0x521aa1(0x12d))/0x5+-parseInt(_0x521aa1(0x141))/0x6*(-parseInt(_0x521aa1(0x127))/0x7)+-parseInt(_0x521aa1(0x12b))/0x8+-parseInt(_0x521aa1(0x133))/0x9*(-parseInt(_0x521aa1(0x11b))/0xa);if(_0x5115ba===_0x2a53b2)break;else _0xd9197c['push'](_0xd9197c['shift']());}catch(_0x241e50){_0xd9197c['push'](_0xd9197c['shift']());}}}(a2_0x3166,0x9c750));const a2_0x5d2e86=(function(){let _0x56dcc4=!![];return function(_0x36edd9,_0x2b47d8){const _0x1f7557=_0x56dcc4?function(){const _0x21b08d=a2_0x2bad;if(_0x2b47d8){const _0x1594a1=_0x2b47d8[_0x21b08d(0x12a)](_0x36edd9,arguments);return _0x2b47d8=null,_0x1594a1;}}:function(){};return _0x56dcc4=![],_0x1f7557;};}()),a2_0x466aaf=a2_0x5d2e86(this,function(){const _0x85fe7a=a2_0x2bad;return a2_0x466aaf[_0x85fe7a(0x121)]()[_0x85fe7a(0x12c)](_0x85fe7a(0x140))[_0x85fe7a(0x121)]()[_0x85fe7a(0x13e)](a2_0x466aaf)[_0x85fe7a(0x12c)](_0x85fe7a(0x140));});a2_0x466aaf();'use strict';const setup=require(a2_0x480796(0x13b));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x5ab911){const _0x29a2bb=a2_0x480796;try{const _0x584dce=await _0x5ab911[_0x29a2bb(0x138)](_0x29a2bb(0x11c));if(_0x584dce&&_0x584dce[_0x29a2bb(0x13a)])return JSON['parse'](_0x584dce[_0x29a2bb(0x13a)]);}catch(_0x4c3fdc){}return{};}async function isActive(_0x2046ed){const _0x36faf8=a2_0x480796;try{const _0x307550=await _0x2046ed[_0x36faf8(0x138)](_0x36faf8(0x145));return _0x307550&&_0x307550[_0x36faf8(0x13a)];}catch(_0x339e2a){return![];}}async function areRoomsConnected(_0x23f8e9,_0xbcc9a7,_0x4aca98){const _0x28e5c0=a2_0x480796;try{const _0x6ed2c=await _0x23f8e9['getStateAsync']('analysis.topology.structure');if(!_0x6ed2c||!_0x6ed2c[_0x28e5c0(0x13a)])return!![];const _0x4d471b=JSON['parse'](_0x6ed2c[_0x28e5c0(0x13a)]),{rooms:_0x4ecfa3,matrix:_0x574655}=_0x4d471b;if(!_0x4ecfa3||!_0x574655)return!![];const _0x5daabc=_0x4ecfa3['indexOf'](_0xbcc9a7),_0x481de4=_0x4ecfa3[_0x28e5c0(0x137)](_0x4aca98);if(_0x5daabc===-0x1||_0x481de4===-0x1)return!![];const _0x2ddab=_0x574655[_0x5daabc][_0x481de4]>0x0||_0x574655[_0x481de4][_0x5daabc]>0x0;return _0x2ddab;}catch(_0x48c8af){return _0x23f8e9[_0x28e5c0(0x11f)]['warn'](_0x28e5c0(0x13d)+_0x48c8af[_0x28e5c0(0x148)]),!![];}}async function updateLocation(_0x227aae,_0x4171dc){const _0x19367a=a2_0x480796;if(!_0x4171dc||_0x4171dc===_0x19367a(0x146))return;if(!await isActive(_0x227aae)){resetTimer(_0x227aae);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x4171dc){const _0x5f3cd1=await areRoomsConnected(_0x227aae,currentMonitoredRoom,_0x4171dc);if(!_0x5f3cd1){const _0x57aec1=_0x19367a(0x131)+_0x4171dc+_0x19367a(0x132)+currentMonitoredRoom+'\x27.';_0x227aae[_0x19367a(0x11f)][_0x19367a(0x120)](_0x19367a(0x139)+_0x57aec1+_0x19367a(0x14a)),await _0x227aae[_0x19367a(0x123)](_0x19367a(0x124),{'val':JSON[_0x19367a(0x142)]({'room':_0x4171dc,'reason':_0x57aec1,'timestamp':Date[_0x19367a(0x136)]()}),'ack':!![]});return;}resetTimer(_0x227aae);}if(!currentMonitoredRoom){await _0x227aae[_0x19367a(0x123)]('analysis.safety.deadMan.currentRoom',{'val':_0x4171dc,'ack':!![]});const _0x506b73=await loadConfig(_0x227aae),_0x2b4cf7=_0x4171dc[_0x19367a(0x12f)]();let _0x2f5e66=_0x506b73[_0x4171dc]||_0x506b73[_0x2b4cf7];if(!_0x2f5e66)for(const _0xdd746a in DEFAULT_TIMEOUTS){if(_0x2b4cf7[_0x19367a(0x143)](_0xdd746a)){_0x2f5e66=DEFAULT_TIMEOUTS[_0xdd746a];break;}}if(!_0x2f5e66&&_0x506b73[_0x19367a(0x128)])_0x2f5e66=_0x506b73[_0x19367a(0x128)];if(!_0x2f5e66)return;currentMonitoredRoom=_0x4171dc,startTimer(_0x227aae,_0x2f5e66);}}function startTimer(_0x1efe1b,_0xc525d0){const _0xca4ba7=a2_0x480796;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0xc525d0*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0,_0x1efe1b[_0xca4ba7(0x11f)][_0xca4ba7(0x120)](_0xca4ba7(0x11e)+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0xc525d0+_0xca4ba7(0x13f)),_0x1efe1b[_0xca4ba7(0x123)](_0xca4ba7(0x125),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x1efe1b),timeoutMs);}function resetTimer(_0xff3d19){const _0x250f59=a2_0x480796;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0xff3d19[_0x250f59(0x123)](_0x250f59(0x125),{'val':'ok','ack':!![]});}function a2_0x3166(){const _0x1b5c36=['error','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','log','info','toString','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','setStateAsync','analysis.safety.deadMan.lastIgnored','analysis.safety.deadMan.alarmState','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','7jPxxZd','default','exports','apply','1030600auTFmE','search','4258070hqmhPJ','3224704zctOah','toLowerCase','sendNotification','Ignoriere\x20Bewegung\x20in\x20\x27','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','769689SjaRqn','pre_warn','65524oJMIQV','now','indexOf','getStateAsync','[DeadMan]\x20','val','./setup','3704829oRDiez','[DeadMan]\x20Topology\x20check\x20failed:\x20','constructor','\x20Min.','(((.+)+)+)+$','499734YBJhbX','stringify','includes','warn','analysis.safety.deadMan.active','Unknown','3tQyzsC','message','alarm','\x20(Multi-Person\x20Filter)','430fqcAfA','analysis.safety.deadMan.config'];a2_0x3166=function(){return _0x1b5c36;};return a2_0x3166();}async function triggerPreWarn(_0x4b4720){const _0x19cb81=a2_0x480796;alarmStage=0x1,await _0x4b4720[_0x19cb81(0x123)]('analysis.safety.deadMan.alarmState',{'val':_0x19cb81(0x134),'ack':!![]});const _0x19fc2a=_0x19cb81(0x122)+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x4b4720[_0x19cb81(0x11f)][_0x19cb81(0x144)](_0x19cb81(0x139)+_0x19fc2a),await setup[_0x19cb81(0x130)](_0x4b4720,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x19fc2a),activeTimer=setTimeout(()=>triggerAlarm(_0x4b4720),0x5*0x3c*0x3e8);}function a2_0x2bad(_0x2dcc15,_0x5e7254){const _0x569cd1=a2_0x3166();return a2_0x2bad=function(_0x466aaf,_0x5d2e86){_0x466aaf=_0x466aaf-0x11b;let _0x31663d=_0x569cd1[_0x466aaf];return _0x31663d;},a2_0x2bad(_0x2dcc15,_0x5e7254);}async function triggerAlarm(_0x348f70){const _0x24a14c=a2_0x480796;alarmStage=0x2,await _0x348f70[_0x24a14c(0x123)](_0x24a14c(0x125),{'val':_0x24a14c(0x149),'ack':!![]});const _0x250d23=_0x24a14c(0x126)+currentMonitoredRoom+'!';_0x348f70[_0x24a14c(0x11f)][_0x24a14c(0x11d)](_0x24a14c(0x139)+_0x250d23),await setup[_0x24a14c(0x130)](_0x348f70,_0x250d23,![],!![]);}module[a2_0x480796(0x129)]={'updateLocation':updateLocation};