function a2_0x3e61(){const _0x2d1521=['ðŸ‘¼\x20Schutzengel-Frage:\x20','analysis.topology.structure','getStateAsync','./setup','sendNotification','2932760aBnWIP','val','12HqSjCm','analysis.safety.deadMan.active','9777HMOorU','analysis.safety.deadMan.config','1904214RpWcXf','20777580TOccKd','45516BpAydf','alarm','parse','indexOf','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','stringify','warn','[DeadMan]\x20','\x20Min.','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','search','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','3205230cwFpvb','Unknown','.\x20Alles\x20in\x20Ordnung?','setStateAsync','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','[DeadMan]\x20Topology\x20check\x20failed:\x20','exports','apply','analysis.safety.deadMan.alarmState','includes','3577059dyBioQ','now','8qGZzOP','default','\x20fÃ¼r\x20','log','344jgPtdO','(((.+)+)+)+$','analysis.safety.deadMan.lastIgnored','Ignoriere\x20Bewegung\x20in\x20\x27','\x20(Multi-Person\x20Filter)','toString','info'];a2_0x3e61=function(){return _0x2d1521;};return a2_0x3e61();}const a2_0x31faea=a2_0x7a40;(function(_0xff30b,_0x5de8e1){const _0x4e5793=a2_0x7a40,_0x2875ed=_0xff30b();while(!![]){try{const _0x23fcec=parseInt(_0x4e5793(0x1c0))/0x1*(parseInt(_0x4e5793(0x1c6))/0x2)+parseInt(_0x4e5793(0x1c2))/0x3*(-parseInt(_0x4e5793(0x1b2))/0x4)+-parseInt(_0x4e5793(0x1be))/0x5+-parseInt(_0x4e5793(0x1c4))/0x6+-parseInt(_0x4e5793(0x1a2))/0x7+parseInt(_0x4e5793(0x1ae))/0x8*(-parseInt(_0x4e5793(0x1ac))/0x9)+parseInt(_0x4e5793(0x1c5))/0xa;if(_0x23fcec===_0x5de8e1)break;else _0x2875ed['push'](_0x2875ed['shift']());}catch(_0x4b9384){_0x2875ed['push'](_0x2875ed['shift']());}}}(a2_0x3e61,0x4c016));const a2_0x25a17e=(function(){let _0x586de3=!![];return function(_0x5f2af9,_0x304574){const _0x1aa6c5=_0x586de3?function(){const _0x511b53=a2_0x7a40;if(_0x304574){const _0x508cf7=_0x304574[_0x511b53(0x1a9)](_0x5f2af9,arguments);return _0x304574=null,_0x508cf7;}}:function(){};return _0x586de3=![],_0x1aa6c5;};}()),a2_0x359754=a2_0x25a17e(this,function(){const _0x37f5e7=a2_0x7a40;return a2_0x359754[_0x37f5e7(0x1b7)]()[_0x37f5e7(0x1a0)](_0x37f5e7(0x1b3))[_0x37f5e7(0x1b7)]()['constructor'](a2_0x359754)[_0x37f5e7(0x1a0)](_0x37f5e7(0x1b3));});a2_0x359754();'use strict';const setup=require(a2_0x31faea(0x1bc));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x7a40(_0x315904,_0x49e045){const _0x2870b6=a2_0x3e61();return a2_0x7a40=function(_0x359754,_0x25a17e){_0x359754=_0x359754-0x199;let _0x3e61c8=_0x2870b6[_0x359754];return _0x3e61c8;},a2_0x7a40(_0x315904,_0x49e045);}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x4367df){const _0x428608=a2_0x31faea;try{const _0x528136=await _0x4367df['getStateAsync'](_0x428608(0x1c3));if(_0x528136&&_0x528136[_0x428608(0x1bf)])return JSON[_0x428608(0x1c8)](_0x528136[_0x428608(0x1bf)]);}catch(_0x4214b3){}return{};}async function isActive(_0x4ae197){const _0x161dad=a2_0x31faea;try{const _0x44ab25=await _0x4ae197[_0x161dad(0x1bb)](_0x161dad(0x1c1));return _0x44ab25&&_0x44ab25[_0x161dad(0x1bf)];}catch(_0x1ca8f0){return![];}}async function areRoomsConnected(_0x268846,_0x2474c5,_0x1a7533){const _0x354f89=a2_0x31faea;try{const _0x33e54d=await _0x268846['getStateAsync'](_0x354f89(0x1ba));if(!_0x33e54d||!_0x33e54d[_0x354f89(0x1bf)])return!![];const _0x28d18b=JSON[_0x354f89(0x1c8)](_0x33e54d['val']),{rooms:_0x393108,matrix:_0x47c28c}=_0x28d18b;if(!_0x393108||!_0x47c28c)return!![];const _0x395d5f=_0x393108[_0x354f89(0x199)](_0x2474c5),_0x4a6978=_0x393108[_0x354f89(0x199)](_0x1a7533);if(_0x395d5f===-0x1||_0x4a6978===-0x1)return!![];const _0x4750d9=_0x47c28c[_0x395d5f][_0x4a6978]>0x0||_0x47c28c[_0x4a6978][_0x395d5f]>0x0;return _0x4750d9;}catch(_0x495bc5){return _0x268846[_0x354f89(0x1b1)][_0x354f89(0x19c)](_0x354f89(0x1a7)+_0x495bc5['message']),!![];}}async function updateLocation(_0x40218a,_0x438d57){const _0x194deb=a2_0x31faea;if(!_0x438d57||_0x438d57===_0x194deb(0x1a3))return;if(!await isActive(_0x40218a)){resetTimer(_0x40218a);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x438d57){const _0x5c191a=await areRoomsConnected(_0x40218a,currentMonitoredRoom,_0x438d57);if(!_0x5c191a){const _0x28b2ee=_0x194deb(0x1b5)+_0x438d57+_0x194deb(0x1a6)+currentMonitoredRoom+'\x27.';_0x40218a[_0x194deb(0x1b1)]['info'](_0x194deb(0x19d)+_0x28b2ee+_0x194deb(0x1b6)),await _0x40218a['setStateAsync'](_0x194deb(0x1b4),{'val':JSON[_0x194deb(0x19b)]({'room':_0x438d57,'reason':_0x28b2ee,'timestamp':Date[_0x194deb(0x1ad)]()}),'ack':!![]});return;}resetTimer(_0x40218a);}if(!currentMonitoredRoom){await _0x40218a[_0x194deb(0x1a5)]('analysis.safety.deadMan.currentRoom',{'val':_0x438d57,'ack':!![]});const _0x49b877=await loadConfig(_0x40218a),_0x2e7f9e=_0x438d57['toLowerCase']();let _0x4b4b2b=_0x49b877[_0x438d57]||_0x49b877[_0x2e7f9e];if(!_0x4b4b2b)for(const _0x517afe in DEFAULT_TIMEOUTS){if(_0x2e7f9e[_0x194deb(0x1ab)](_0x517afe)){_0x4b4b2b=DEFAULT_TIMEOUTS[_0x517afe];break;}}if(!_0x4b4b2b&&_0x49b877[_0x194deb(0x1af)])_0x4b4b2b=_0x49b877[_0x194deb(0x1af)];if(!_0x4b4b2b)return;currentMonitoredRoom=_0x438d57,startTimer(_0x40218a,_0x4b4b2b);}}function startTimer(_0x25109a,_0x555d6f){const _0x3a7706=a2_0x31faea;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x555d6f*0x3c*0x3e8,startTime=Date[_0x3a7706(0x1ad)](),alarmStage=0x0,_0x25109a[_0x3a7706(0x1b1)][_0x3a7706(0x1b8)](_0x3a7706(0x19a)+currentMonitoredRoom+_0x3a7706(0x1b0)+_0x555d6f+_0x3a7706(0x19e)),_0x25109a[_0x3a7706(0x1a5)](_0x3a7706(0x1aa),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x25109a),timeoutMs);}function resetTimer(_0xd52131){const _0x21d89e=a2_0x31faea;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0xd52131[_0x21d89e(0x1a5)](_0x21d89e(0x1aa),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0xa47abe){const _0x28df4e=a2_0x31faea;alarmStage=0x1,await _0xa47abe[_0x28df4e(0x1a5)]('analysis.safety.deadMan.alarmState',{'val':'pre_warn','ack':!![]});const _0x17fb3f=_0x28df4e(0x1a1)+currentMonitoredRoom+_0x28df4e(0x1a4);_0xa47abe[_0x28df4e(0x1b1)][_0x28df4e(0x19c)](_0x28df4e(0x19d)+_0x17fb3f),await setup[_0x28df4e(0x1bd)](_0xa47abe,_0x28df4e(0x1b9)+_0x17fb3f),activeTimer=setTimeout(()=>triggerAlarm(_0xa47abe),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x37896c){const _0x1cf393=a2_0x31faea;alarmStage=0x2,await _0x37896c[_0x1cf393(0x1a5)](_0x1cf393(0x1aa),{'val':_0x1cf393(0x1c7),'ack':!![]});const _0x10ca4f=_0x1cf393(0x19f)+currentMonitoredRoom+'!';_0x37896c[_0x1cf393(0x1b1)]['error']('[DeadMan]\x20'+_0x10ca4f),await setup[_0x1cf393(0x1bd)](_0x37896c,_0x10ca4f,![],!![]);}module[a2_0x31faea(0x1a8)]={'updateLocation':updateLocation};