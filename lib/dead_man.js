const a2_0xd25706=a2_0x464c;(function(_0x9a110e,_0x40380b){const _0x2c8be9=a2_0x464c,_0x233f14=_0x9a110e();while(!![]){try{const _0x297627=-parseInt(_0x2c8be9(0xac))/0x1+parseInt(_0x2c8be9(0xc3))/0x2+parseInt(_0x2c8be9(0xd8))/0x3+-parseInt(_0x2c8be9(0xd4))/0x4+-parseInt(_0x2c8be9(0xb9))/0x5*(-parseInt(_0x2c8be9(0xdd))/0x6)+parseInt(_0x2c8be9(0xce))/0x7*(-parseInt(_0x2c8be9(0xc5))/0x8)+parseInt(_0x2c8be9(0xca))/0x9;if(_0x297627===_0x40380b)break;else _0x233f14['push'](_0x233f14['shift']());}catch(_0x4da3c3){_0x233f14['push'](_0x233f14['shift']());}}}(a2_0x2e12,0x9f1e7));const a2_0x10f3f5=(function(){let _0x35a319=!![];return function(_0x31d1b6,_0x542c91){const _0x95c826=_0x35a319?function(){const _0x52fb1f=a2_0x464c;if(_0x542c91){const _0x3bdf3d=_0x542c91[_0x52fb1f(0xb7)](_0x31d1b6,arguments);return _0x542c91=null,_0x3bdf3d;}}:function(){};return _0x35a319=![],_0x95c826;};}()),a2_0x3af30d=a2_0x10f3f5(this,function(){const _0x1aad66=a2_0x464c;return a2_0x3af30d[_0x1aad66(0xae)]()[_0x1aad66(0xc4)](_0x1aad66(0xaa))[_0x1aad66(0xae)]()['constructor'](a2_0x3af30d)[_0x1aad66(0xc4)](_0x1aad66(0xaa));});a2_0x3af30d();'use strict';const setup=require(a2_0xd25706(0xe0));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};async function loadConfig(_0x2d9e9d){const _0x121733=a2_0xd25706;try{const _0xf33cb2=await _0x2d9e9d[_0x121733(0xc0)]('analysis.safety.deadMan.config');if(_0xf33cb2&&_0xf33cb2[_0x121733(0xaf)])return JSON[_0x121733(0xdb)](_0xf33cb2[_0x121733(0xaf)]);}catch(_0x2a7f38){}return{};}function a2_0x2e12(){const _0x33088e=['now','(((.+)+)+)+$','sofa','774287VxOXTk','analysis.safety.deadMan.alarmState','toString','val','log','indexOf','sendNotification','alarm','exports','[DeadMan]\x20Topology\x20check\x20failed:\x20','warn','apply','Unknown','2155AmjzZJ','\x20fÃ¼r\x20','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','analysis.safety.deadMan.napProbability','\x20Min.','bed','ðŸ‘¼\x20Schutzengel-Frage:\x20','getStateAsync','[DeadMan]\x20','.\x20Alles\x20in\x20Ordnung?','1508020fnMXTC','search','4898488JHbmap','info','error','%).\x20VerlÃ¤ngere\x20Timer\x20fÃ¼r\x20','ðŸ’¤\x20Smart\x20Sleep\x20erkannt\x20(','2351592KFkHYw','getHours','bad','toLowerCase','7mglfrH','setStateAsync','analysis.safety.deadMan.smartSleep','message','analysis.safety.deadMan.currentRoom','analysis.safety.deadMan.lastIgnored','51152cDQyYo','includes','living','stringify','506001WyEbFH','pre_warn','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','parse','toFixed','12072fsFokV','analysis.safety.deadMan.active','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','./setup'];a2_0x2e12=function(){return _0x33088e;};return a2_0x2e12();}async function isActive(_0x1321fb){const _0xac8eae=a2_0xd25706;try{const _0x535b3a=await _0x1321fb[_0xac8eae(0xc0)](_0xac8eae(0xde));return _0x535b3a&&_0x535b3a['val'];}catch(_0x511ee4){return![];}}async function areRoomsConnected(_0x17f41e,_0x51d80f,_0x4f3318){const _0x3747a6=a2_0xd25706;try{const _0x5b121f=await _0x17f41e[_0x3747a6(0xc0)]('analysis.topology.structure');if(!_0x5b121f||!_0x5b121f['val'])return!![];const _0x1ac79e=JSON[_0x3747a6(0xdb)](_0x5b121f[_0x3747a6(0xaf)]),{rooms:_0x4f7e8a,matrix:_0x32b803}=_0x1ac79e;if(!_0x4f7e8a||!_0x32b803)return!![];const _0xc4733c=_0x4f7e8a[_0x3747a6(0xb1)](_0x51d80f),_0x45b909=_0x4f7e8a[_0x3747a6(0xb1)](_0x4f3318);if(_0xc4733c===-0x1||_0x45b909===-0x1)return!![];const _0x2a8c9e=_0x32b803[_0xc4733c][_0x45b909]>0x0||_0x32b803[_0x45b909][_0xc4733c]>0x0;return _0x2a8c9e;}catch(_0x5ea753){return _0x17f41e['log']['warn'](_0x3747a6(0xb5)+_0x5ea753[_0x3747a6(0xd1)]),!![];}}function calculateSleepProbability(_0x5ec79d){const _0x50ac90=a2_0xd25706,_0x3c3b35=new Date(),_0x2502df=_0x3c3b35[_0x50ac90(0xcb)](),_0x51fc3f=_0x5ec79d[_0x50ac90(0xcd)]();let _0x4e4207=0.1;if(_0x2502df>=0x17||_0x2502df<=0x6)_0x4e4207=0x1;else{if(_0x2502df>=0xd&&_0x2502df<=0xf)_0x4e4207=0.8;else{if(_0x2502df>=0x14&&_0x2502df<=0x17)_0x4e4207=0.4;}}let _0x1e2614=0.1;if(_0x51fc3f['includes']('schlaf')||_0x51fc3f[_0x50ac90(0xd5)](_0x50ac90(0xbe)))_0x1e2614=0x1;else{if(_0x51fc3f[_0x50ac90(0xd5)]('wohn')||_0x51fc3f[_0x50ac90(0xd5)](_0x50ac90(0xd6))||_0x51fc3f[_0x50ac90(0xd5)](_0x50ac90(0xab)))_0x1e2614=0.6;else{if(_0x51fc3f[_0x50ac90(0xd5)](_0x50ac90(0xcc))||_0x51fc3f['includes']('wc'))_0x1e2614=0.05;}}let _0x167109=0.5;const _0x50cf51=_0x1e2614*0.5+_0x4e4207*0.3+_0x167109*0.2;return parseFloat(_0x50cf51[_0x50ac90(0xdc)](0x2));}async function updateLocation(_0x1d2ff6,_0x39c707){const _0x34bef7=a2_0xd25706;if(!_0x39c707||_0x39c707===_0x34bef7(0xb8))return;if(!await isActive(_0x1d2ff6)){resetTimer(_0x1d2ff6);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x39c707){const _0x17b431=await areRoomsConnected(_0x1d2ff6,currentMonitoredRoom,_0x39c707);if(!_0x17b431){const _0x1e69ef='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x39c707+_0x34bef7(0xbb)+currentMonitoredRoom+'\x27.';_0x1d2ff6[_0x34bef7(0xb0)][_0x34bef7(0xc6)](_0x34bef7(0xc1)+_0x1e69ef+'\x20(Multi-Person\x20Filter)'),await _0x1d2ff6[_0x34bef7(0xcf)](_0x34bef7(0xd3),{'val':JSON[_0x34bef7(0xd7)]({'room':_0x39c707,'reason':_0x1e69ef,'timestamp':Date[_0x34bef7(0xa9)]()}),'ack':!![]});return;}resetTimer(_0x1d2ff6);}if(!currentMonitoredRoom){await _0x1d2ff6[_0x34bef7(0xcf)](_0x34bef7(0xd2),{'val':_0x39c707,'ack':!![]});const _0x5223a7=await loadConfig(_0x1d2ff6),_0x2154ae=_0x39c707[_0x34bef7(0xcd)]();let _0x5f1dff=_0x5223a7[_0x39c707]||_0x5223a7[_0x2154ae];if(!_0x5f1dff)for(const _0x1af784 in DEFAULT_TIMEOUTS){if(_0x2154ae[_0x34bef7(0xd5)](_0x1af784)){_0x5f1dff=DEFAULT_TIMEOUTS[_0x1af784];break;}}if(!_0x5f1dff&&_0x5223a7['default'])_0x5f1dff=_0x5223a7['default'];if(!_0x5f1dff)return;currentMonitoredRoom=_0x39c707,startTimer(_0x1d2ff6,_0x5f1dff,_0x39c707);}}function startTimer(_0x41713a,_0x46db62,_0x337124){const _0x453360=a2_0xd25706;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x46db62*0x3c*0x3e8,startTime=Date[_0x453360(0xa9)](),alarmStage=0x0;const _0x1b8afc=calculateSleepProbability(_0x337124||currentMonitoredRoom),_0x14d1ab=_0x1b8afc>0.65;_0x14d1ab?(timeoutMs+=0x5a*0x3c*0x3e8,_0x41713a[_0x453360(0xb0)][_0x453360(0xc6)](_0x453360(0xc9)+(_0x1b8afc*0x64)[_0x453360(0xdc)](0x0)+_0x453360(0xc8)+currentMonitoredRoom+'\x20um\x2090\x20Min.'),_0x41713a[_0x453360(0xcf)](_0x453360(0xd0),{'val':!![],'ack':!![]})):_0x41713a['setStateAsync']('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0x41713a[_0x453360(0xcf)](_0x453360(0xbc),{'val':_0x1b8afc,'ack':!![]}),_0x41713a[_0x453360(0xb0)][_0x453360(0xc6)](_0x453360(0xda)+currentMonitoredRoom+_0x453360(0xba)+_0x46db62+_0x453360(0xbd)),_0x41713a[_0x453360(0xcf)](_0x453360(0xad),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x41713a),timeoutMs);}function resetTimer(_0x513aff){const _0x7bee79=a2_0xd25706;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x513aff['setStateAsync'](_0x7bee79(0xad),{'val':'ok','ack':!![]}),_0x513aff[_0x7bee79(0xcf)]('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0x513aff[_0x7bee79(0xcf)](_0x7bee79(0xbc),{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x1eabb8){const _0x517743=a2_0xd25706;alarmStage=0x1,await _0x1eabb8[_0x517743(0xcf)](_0x517743(0xad),{'val':_0x517743(0xd9),'ack':!![]});const _0x457fa4='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x517743(0xc2);_0x1eabb8[_0x517743(0xb0)][_0x517743(0xb6)](_0x517743(0xc1)+_0x457fa4),await setup[_0x517743(0xb2)](_0x1eabb8,_0x517743(0xbf)+_0x457fa4),activeTimer=setTimeout(()=>triggerAlarm(_0x1eabb8),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x3f8359){const _0x1f9cfc=a2_0xd25706;alarmStage=0x2,await _0x3f8359[_0x1f9cfc(0xcf)]('analysis.safety.deadMan.alarmState',{'val':_0x1f9cfc(0xb3),'ack':!![]});const _0x516601=_0x1f9cfc(0xdf)+currentMonitoredRoom+'!';_0x3f8359['log'][_0x1f9cfc(0xc7)]('[DeadMan]\x20'+_0x516601),await setup[_0x1f9cfc(0xb2)](_0x3f8359,_0x516601,![],!![]);}function a2_0x464c(_0x27ab2e,_0x5d6e98){const _0x7847c2=a2_0x2e12();return a2_0x464c=function(_0x3af30d,_0x10f3f5){_0x3af30d=_0x3af30d-0xa9;let _0x2e12d1=_0x7847c2[_0x3af30d];return _0x2e12d1;},a2_0x464c(_0x27ab2e,_0x5d6e98);}module[a2_0xd25706(0xb4)]={'updateLocation':updateLocation};