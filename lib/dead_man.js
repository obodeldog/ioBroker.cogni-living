const a2_0x243b1e=a2_0x1026;(function(_0x48345a,_0x1d0812){const _0x4a86db=a2_0x1026,_0x4c2057=_0x48345a();while(!![]){try{const _0x361086=-parseInt(_0x4a86db(0x201))/0x1*(parseInt(_0x4a86db(0x1db))/0x2)+parseInt(_0x4a86db(0x204))/0x3*(-parseInt(_0x4a86db(0x1ea))/0x4)+parseInt(_0x4a86db(0x1df))/0x5+-parseInt(_0x4a86db(0x1f4))/0x6*(parseInt(_0x4a86db(0x1f0))/0x7)+parseInt(_0x4a86db(0x1e4))/0x8+parseInt(_0x4a86db(0x202))/0x9+parseInt(_0x4a86db(0x1ee))/0xa;if(_0x361086===_0x1d0812)break;else _0x4c2057['push'](_0x4c2057['shift']());}catch(_0x4d66c3){_0x4c2057['push'](_0x4c2057['shift']());}}}(a2_0x1226,0x9db8e));const a2_0x3968a6=(function(){let _0x2ebdf0=!![];return function(_0x47ffc8,_0x36f4e0){const _0x134f1a=_0x2ebdf0?function(){if(_0x36f4e0){const _0x34a447=_0x36f4e0['apply'](_0x47ffc8,arguments);return _0x36f4e0=null,_0x34a447;}}:function(){};return _0x2ebdf0=![],_0x134f1a;};}()),a2_0x485018=a2_0x3968a6(this,function(){const _0x4a07f5=a2_0x1026;return a2_0x485018[_0x4a07f5(0x200)]()[_0x4a07f5(0x1fc)](_0x4a07f5(0x1e1))[_0x4a07f5(0x200)]()[_0x4a07f5(0x1ef)](a2_0x485018)[_0x4a07f5(0x1fc)]('(((.+)+)+)+$');});a2_0x485018();'use strict';function a2_0x1226(){const _0x3dffbf=['3578808UujCha','getStateAsync','Unknown','Ignoriere\x20Bewegung\x20in\x20\x27','default','analysis.safety.deadMan.active','412vfEXzS','includes','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','val','6032530pHuFUO','constructor','28NLwRXC','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','setStateAsync','1212126qGBENH','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','alarm','now','log','parse','error','indexOf','search','[DeadMan]\x20','analysis.safety.deadMan.currentRoom','.\x20Alles\x20in\x20Ordnung?','toString','1041533wbMpth','4298184SnxfcP','stringify','5871VLOZOw','analysis.safety.deadMan.config','./setup','pre_warn','\x20fÃ¼r\x20','info','2ifQDhM','analysis.safety.deadMan.alarmState','[DeadMan]\x20Topology\x20check\x20failed:\x20','warn','5845190PSvEDS','exports','(((.+)+)+)+$','toLowerCase','sendNotification'];a2_0x1226=function(){return _0x3dffbf;};return a2_0x1226();}const setup=require(a2_0x243b1e(0x1d7));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};function a2_0x1026(_0x4989d2,_0x4086f6){const _0x292a11=a2_0x1226();return a2_0x1026=function(_0x485018,_0x3968a6){_0x485018=_0x485018-0x1d6;let _0x12263e=_0x292a11[_0x485018];return _0x12263e;},a2_0x1026(_0x4989d2,_0x4086f6);}async function loadConfig(_0x55a31f){const _0xef9096=a2_0x243b1e;try{const _0x7e475a=await _0x55a31f['getStateAsync'](_0xef9096(0x1d6));if(_0x7e475a&&_0x7e475a[_0xef9096(0x1ed)])return JSON[_0xef9096(0x1f9)](_0x7e475a[_0xef9096(0x1ed)]);}catch(_0x3700f7){}return{};}async function isActive(_0x20fb4e){const _0xf75726=a2_0x243b1e;try{const _0x4f6a83=await _0x20fb4e[_0xf75726(0x1e5)](_0xf75726(0x1e9));return _0x4f6a83&&_0x4f6a83[_0xf75726(0x1ed)];}catch(_0x31e68d){return![];}}async function areRoomsConnected(_0x2c9bb3,_0x104d06,_0x112b7e){const _0x227e92=a2_0x243b1e;try{const _0xef50f9=await _0x2c9bb3[_0x227e92(0x1e5)]('analysis.topology.structure');if(!_0xef50f9||!_0xef50f9[_0x227e92(0x1ed)])return!![];const _0x5e73cb=JSON[_0x227e92(0x1f9)](_0xef50f9['val']),{rooms:_0x197037,matrix:_0x107e02}=_0x5e73cb;if(!_0x197037||!_0x107e02)return!![];const _0x431a8d=_0x197037[_0x227e92(0x1fb)](_0x104d06),_0xe38339=_0x197037[_0x227e92(0x1fb)](_0x112b7e);if(_0x431a8d===-0x1||_0xe38339===-0x1)return!![];const _0x597219=_0x107e02[_0x431a8d][_0xe38339]>0x0||_0x107e02[_0xe38339][_0x431a8d]>0x0;return _0x597219;}catch(_0xecd3){return _0x2c9bb3[_0x227e92(0x1f8)][_0x227e92(0x1de)](_0x227e92(0x1dd)+_0xecd3['message']),!![];}}async function updateLocation(_0x216ad4,_0x199717){const _0x270143=a2_0x243b1e;if(!_0x199717||_0x199717===_0x270143(0x1e6))return;if(!await isActive(_0x216ad4)){resetTimer(_0x216ad4);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x199717){const _0x195b11=await areRoomsConnected(_0x216ad4,currentMonitoredRoom,_0x199717);if(!_0x195b11){const _0x576806=_0x270143(0x1e7)+_0x199717+_0x270143(0x1f5)+currentMonitoredRoom+'\x27.';_0x216ad4[_0x270143(0x1f8)]['info'](_0x270143(0x1fd)+_0x576806+'\x20(Multi-Person\x20Filter)'),await _0x216ad4[_0x270143(0x1f3)]('analysis.safety.deadMan.lastIgnored',{'val':JSON[_0x270143(0x203)]({'room':_0x199717,'reason':_0x576806,'timestamp':Date[_0x270143(0x1f7)]()}),'ack':!![]});return;}resetTimer(_0x216ad4);}if(!currentMonitoredRoom){await _0x216ad4[_0x270143(0x1f3)](_0x270143(0x1fe),{'val':_0x199717,'ack':!![]});const _0xb1b80a=await loadConfig(_0x216ad4),_0x73aff9=_0x199717[_0x270143(0x1e2)]();let _0x50044c=_0xb1b80a[_0x199717]||_0xb1b80a[_0x73aff9];if(!_0x50044c)for(const _0x266176 in DEFAULT_TIMEOUTS){if(_0x73aff9[_0x270143(0x1eb)](_0x266176)){_0x50044c=DEFAULT_TIMEOUTS[_0x266176];break;}}if(!_0x50044c&&_0xb1b80a['default'])_0x50044c=_0xb1b80a[_0x270143(0x1e8)];if(!_0x50044c)return;currentMonitoredRoom=_0x199717,startTimer(_0x216ad4,_0x50044c);}}function startTimer(_0x5419cf,_0x2290a4){const _0x550132=a2_0x243b1e;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x2290a4*0x3c*0x3e8,startTime=Date[_0x550132(0x1f7)](),alarmStage=0x0,_0x5419cf[_0x550132(0x1f8)][_0x550132(0x1da)](_0x550132(0x1ec)+currentMonitoredRoom+_0x550132(0x1d9)+_0x2290a4+'\x20Min.'),_0x5419cf['setStateAsync'](_0x550132(0x1dc),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x5419cf),timeoutMs);}function resetTimer(_0x48ee79){const _0x46cd4b=a2_0x243b1e;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x48ee79[_0x46cd4b(0x1f3)](_0x46cd4b(0x1dc),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0xdb7229){const _0x2f740b=a2_0x243b1e;alarmStage=0x1,await _0xdb7229[_0x2f740b(0x1f3)]('analysis.safety.deadMan.alarmState',{'val':_0x2f740b(0x1d8),'ack':!![]});const _0x2feafa=_0x2f740b(0x1f2)+currentMonitoredRoom+_0x2f740b(0x1ff);_0xdb7229[_0x2f740b(0x1f8)][_0x2f740b(0x1de)]('[DeadMan]\x20'+_0x2feafa),await setup['sendNotification'](_0xdb7229,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x2feafa),activeTimer=setTimeout(()=>triggerAlarm(_0xdb7229),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x568932){const _0x40883e=a2_0x243b1e;alarmStage=0x2,await _0x568932['setStateAsync'](_0x40883e(0x1dc),{'val':_0x40883e(0x1f6),'ack':!![]});const _0x55aaab=_0x40883e(0x1f1)+currentMonitoredRoom+'!';_0x568932['log'][_0x40883e(0x1fa)](_0x40883e(0x1fd)+_0x55aaab),await setup[_0x40883e(0x1e3)](_0x568932,_0x55aaab,![],!![]);}module[a2_0x243b1e(0x1e0)]={'updateLocation':updateLocation};