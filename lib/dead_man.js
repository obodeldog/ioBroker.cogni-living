const a2_0x26b0e7=a2_0x33c6;(function(_0x287f6d,_0x4c9451){const _0x3e1eef=a2_0x33c6,_0x3f669d=_0x287f6d();while(!![]){try{const _0x4137ed=parseInt(_0x3e1eef(0x106))/0x1+parseInt(_0x3e1eef(0xdc))/0x2*(-parseInt(_0x3e1eef(0xf1))/0x3)+-parseInt(_0x3e1eef(0xf7))/0x4*(-parseInt(_0x3e1eef(0xe7))/0x5)+parseInt(_0x3e1eef(0xe2))/0x6*(-parseInt(_0x3e1eef(0x104))/0x7)+-parseInt(_0x3e1eef(0xf0))/0x8*(-parseInt(_0x3e1eef(0xf5))/0x9)+parseInt(_0x3e1eef(0xe1))/0xa*(-parseInt(_0x3e1eef(0xfd))/0xb)+-parseInt(_0x3e1eef(0x105))/0xc*(-parseInt(_0x3e1eef(0xeb))/0xd);if(_0x4137ed===_0x4c9451)break;else _0x3f669d['push'](_0x3f669d['shift']());}catch(_0x20a79f){_0x3f669d['push'](_0x3f669d['shift']());}}}(a2_0x12c1,0x25358));const a2_0x4c96b1=(function(){let _0x22b0bb=!![];return function(_0x5ec256,_0x250d7d){const _0x2e31ec=_0x22b0bb?function(){if(_0x250d7d){const _0x9e8238=_0x250d7d['apply'](_0x5ec256,arguments);return _0x250d7d=null,_0x9e8238;}}:function(){};return _0x22b0bb=![],_0x2e31ec;};}()),a2_0x238b82=a2_0x4c96b1(this,function(){const _0x36ad48=a2_0x33c6;return a2_0x238b82['toString']()[_0x36ad48(0xe9)](_0x36ad48(0xfe))[_0x36ad48(0xde)]()[_0x36ad48(0xf8)](a2_0x238b82)[_0x36ad48(0xe9)](_0x36ad48(0xfe));});a2_0x238b82();'use strict';function a2_0x33c6(_0x4a4946,_0x24bbd2){const _0x1fd151=a2_0x12c1();return a2_0x33c6=function(_0x238b82,_0x4c96b1){_0x238b82=_0x238b82-0xd9;let _0x12c1c1=_0x1fd151[_0x238b82];return _0x12c1c1;},a2_0x33c6(_0x4a4946,_0x24bbd2);}const setup=require(a2_0x26b0e7(0xed));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x81dab8){const _0x378b4c=a2_0x26b0e7;try{const _0x105cfd=await _0x81dab8[_0x378b4c(0xe3)](_0x378b4c(0xf3));if(_0x105cfd&&_0x105cfd[_0x378b4c(0x102)])return JSON[_0x378b4c(0xfc)](_0x105cfd[_0x378b4c(0x102)]);}catch(_0x6b7808){}return{};}async function isActive(_0x30e886){const _0x3fd868=a2_0x26b0e7;try{const _0xa7a8a7=await _0x30e886[_0x3fd868(0xe3)](_0x3fd868(0xda));return _0xa7a8a7&&_0xa7a8a7['val'];}catch(_0x1e050b){return![];}}async function areRoomsConnected(_0x4016cf,_0x10231a,_0x5bdaa2){const _0x334acc=a2_0x26b0e7;try{const _0x17a60b=await _0x4016cf['getStateAsync']('analysis.topology.structure');if(!_0x17a60b||!_0x17a60b[_0x334acc(0x102)])return!![];const _0x2be03a=JSON[_0x334acc(0xfc)](_0x17a60b[_0x334acc(0x102)]),{rooms:_0xc0ddc0,matrix:_0x3c1c8b}=_0x2be03a;if(!_0xc0ddc0||!_0x3c1c8b)return!![];const _0x261558=_0xc0ddc0[_0x334acc(0xe4)](_0x10231a),_0xa04f84=_0xc0ddc0['indexOf'](_0x5bdaa2);if(_0x261558===-0x1||_0xa04f84===-0x1)return!![];const _0x4c9984=_0x3c1c8b[_0x261558][_0xa04f84]>0x0||_0x3c1c8b[_0xa04f84][_0x261558]>0x0;return _0x4c9984;}catch(_0x37a9df){return _0x4016cf[_0x334acc(0xd9)][_0x334acc(0xdb)](_0x334acc(0xf2)+_0x37a9df[_0x334acc(0xea)]),!![];}}function a2_0x12c1(){const _0x271b75=['parse','2387OteTBi','(((.+)+)+)+$','default','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','now','val','sendNotification','1673RrbvlR','1740zzXqeN','78620cjRegj','log','analysis.safety.deadMan.active','warn','10JDqIMI','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','toString','\x27.\x20(Multi-Person\x20Filter)','\x20Min.','390utzNYt','354mICErt','getStateAsync','indexOf','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','analysis.safety.deadMan.currentRoom','1515EaKqlp','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','search','message','7735DRFtiN','ðŸ‘¼\x20Schutzengel-Frage:\x20','./setup','analysis.safety.deadMan.alarmState','info','8rrBvKe','47991fuTQJE','[DeadMan]\x20Topology\x20check\x20failed:\x20','analysis.safety.deadMan.config','\x20fÃ¼r\x20','420597mddPTK','.\x20Alles\x20in\x20Ordnung?','572tQoCXV','constructor','setStateAsync','[DeadMan]\x20','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'];a2_0x12c1=function(){return _0x271b75;};return a2_0x12c1();}async function updateLocation(_0x58a7e1,_0x4f908f){const _0x211f66=a2_0x26b0e7;if(!_0x4f908f||_0x4f908f==='Unknown')return;if(!await isActive(_0x58a7e1)){resetTimer(_0x58a7e1);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x4f908f){const _0x439375=await areRoomsConnected(_0x58a7e1,currentMonitoredRoom,_0x4f908f);if(!_0x439375){_0x58a7e1['log'][_0x211f66(0xef)](_0x211f66(0xe5)+_0x4f908f+_0x211f66(0xdd)+currentMonitoredRoom+_0x211f66(0xdf));return;}resetTimer(_0x58a7e1);}if(!currentMonitoredRoom){await _0x58a7e1[_0x211f66(0xf9)](_0x211f66(0xe6),{'val':_0x4f908f,'ack':!![]});const _0x476cc8=await loadConfig(_0x58a7e1),_0xd1e9d8=_0x4f908f['toLowerCase']();let _0x4003c3=_0x476cc8[_0x4f908f]||_0x476cc8[_0xd1e9d8];if(!_0x4003c3)for(const _0x4586af in DEFAULT_TIMEOUTS){if(_0xd1e9d8['includes'](_0x4586af)){_0x4003c3=DEFAULT_TIMEOUTS[_0x4586af];break;}}if(!_0x4003c3&&_0x476cc8[_0x211f66(0xff)])_0x4003c3=_0x476cc8[_0x211f66(0xff)];if(!_0x4003c3)return;currentMonitoredRoom=_0x4f908f,startTimer(_0x58a7e1,_0x4003c3);}}function startTimer(_0xec1344,_0x4055a9){const _0x3e5d89=a2_0x26b0e7;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x4055a9*0x3c*0x3e8,startTime=Date[_0x3e5d89(0x101)](),alarmStage=0x0,_0xec1344['log'][_0x3e5d89(0xef)](_0x3e5d89(0x100)+currentMonitoredRoom+_0x3e5d89(0xf4)+_0x4055a9+_0x3e5d89(0xe0)),_0xec1344['setStateAsync'](_0x3e5d89(0xee),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0xec1344),timeoutMs);}function resetTimer(_0xeba8cc){const _0x396d83=a2_0x26b0e7;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0xeba8cc[_0x396d83(0xf9)](_0x396d83(0xee),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x206955){const _0x2329a8=a2_0x26b0e7;alarmStage=0x1,await _0x206955[_0x2329a8(0xf9)]('analysis.safety.deadMan.alarmState',{'val':'pre_warn','ack':!![]});const _0x4b2db0=_0x2329a8(0xfb)+currentMonitoredRoom+_0x2329a8(0xf6);_0x206955['log'][_0x2329a8(0xdb)](_0x2329a8(0xfa)+_0x4b2db0),await setup[_0x2329a8(0x103)](_0x206955,_0x2329a8(0xec)+_0x4b2db0),activeTimer=setTimeout(()=>triggerAlarm(_0x206955),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x1efafa){const _0x37f0ef=a2_0x26b0e7;alarmStage=0x2,await _0x1efafa[_0x37f0ef(0xf9)](_0x37f0ef(0xee),{'val':'alarm','ack':!![]});const _0x6ad659=_0x37f0ef(0xe8)+currentMonitoredRoom+'!';_0x1efafa[_0x37f0ef(0xd9)]['error'](_0x37f0ef(0xfa)+_0x6ad659),await setup[_0x37f0ef(0x103)](_0x1efafa,_0x6ad659,![],!![]);}module['exports']={'updateLocation':updateLocation};