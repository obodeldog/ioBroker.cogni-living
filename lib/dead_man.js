const a2_0x56eb05=a2_0x1ecc;(function(_0x21e1f3,_0x3e0d18){const _0x42b782=a2_0x1ecc,_0x1964b2=_0x21e1f3();while(!![]){try{const _0x29a390=parseInt(_0x42b782(0x94))/0x1*(parseInt(_0x42b782(0x91))/0x2)+parseInt(_0x42b782(0x8e))/0x3+-parseInt(_0x42b782(0x66))/0x4*(-parseInt(_0x42b782(0x65))/0x5)+-parseInt(_0x42b782(0x84))/0x6*(-parseInt(_0x42b782(0x85))/0x7)+parseInt(_0x42b782(0x73))/0x8+parseInt(_0x42b782(0x92))/0x9+-parseInt(_0x42b782(0x89))/0xa*(parseInt(_0x42b782(0x78))/0xb);if(_0x29a390===_0x3e0d18)break;else _0x1964b2['push'](_0x1964b2['shift']());}catch(_0x3b60bc){_0x1964b2['push'](_0x1964b2['shift']());}}}(a2_0x30fe,0x330b7));const a2_0x2b44c0=(function(){let _0x3c5ce4=!![];return function(_0x57214e,_0xfe3cbb){const _0x2dcc1c=_0x3c5ce4?function(){const _0x2b2f9b=a2_0x1ecc;if(_0xfe3cbb){const _0x43d86f=_0xfe3cbb[_0x2b2f9b(0x8b)](_0x57214e,arguments);return _0xfe3cbb=null,_0x43d86f;}}:function(){};return _0x3c5ce4=![],_0x2dcc1c;};}()),a2_0x3a03d3=a2_0x2b44c0(this,function(){const _0x536d3c=a2_0x1ecc;return a2_0x3a03d3[_0x536d3c(0x8d)]()[_0x536d3c(0x7a)]('(((.+)+)+)+$')[_0x536d3c(0x8d)]()[_0x536d3c(0x8a)](a2_0x3a03d3)[_0x536d3c(0x7a)]('(((.+)+)+)+$');});a2_0x3a03d3();'use strict';const setup=require(a2_0x56eb05(0x79));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x7aeb1f){const _0x58189d=a2_0x56eb05;try{const _0x3a449c=await _0x7aeb1f[_0x58189d(0x8c)](_0x58189d(0x93));if(_0x3a449c&&_0x3a449c['val'])return JSON[_0x58189d(0x6a)](_0x3a449c[_0x58189d(0x81)]);}catch(_0x1a71c8){}return{};}async function isActive(_0x579545){const _0x38103c=a2_0x56eb05;try{const _0x3adb22=await _0x579545[_0x38103c(0x8c)]('analysis.safety.deadMan.active');return _0x3adb22&&_0x3adb22[_0x38103c(0x81)];}catch(_0x3a5473){return![];}}async function areRoomsConnected(_0xd93eea,_0x1ee736,_0x2c3109){const _0x39a108=a2_0x56eb05;try{const _0x252b3d=await _0xd93eea[_0x39a108(0x8c)]('analysis.topology.structure');if(!_0x252b3d||!_0x252b3d['val'])return!![];const _0x1ed9d0=JSON[_0x39a108(0x6a)](_0x252b3d[_0x39a108(0x81)]),{rooms:_0x2a8a05,matrix:_0x3ee7bf}=_0x1ed9d0;if(!_0x2a8a05||!_0x3ee7bf)return!![];const _0x1d2262=_0x2a8a05['indexOf'](_0x1ee736),_0x44a229=_0x2a8a05[_0x39a108(0x87)](_0x2c3109);if(_0x1d2262===-0x1||_0x44a229===-0x1)return!![];const _0x5edcf6=_0x3ee7bf[_0x1d2262][_0x44a229]>0x0||_0x3ee7bf[_0x44a229][_0x1d2262]>0x0;return _0x5edcf6;}catch(_0x1a4721){return _0xd93eea[_0x39a108(0x7e)][_0x39a108(0x69)](_0x39a108(0x6d)+_0x1a4721[_0x39a108(0x7d)]),!![];}}async function updateLocation(_0x3e92b7,_0xed03b9){const _0x5c637b=a2_0x56eb05;if(!_0xed03b9||_0xed03b9===_0x5c637b(0x6f))return;if(!await isActive(_0x3e92b7)){resetTimer(_0x3e92b7);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0xed03b9){const _0x15de4c=await areRoomsConnected(_0x3e92b7,currentMonitoredRoom,_0xed03b9);if(!_0x15de4c){const _0x50cf9c=_0x5c637b(0x72)+_0xed03b9+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0x3e92b7['log'][_0x5c637b(0x6c)](_0x5c637b(0x80)+_0x50cf9c+'\x20(Multi-Person\x20Filter)'),await _0x3e92b7[_0x5c637b(0x83)](_0x5c637b(0x88),{'val':JSON[_0x5c637b(0x6b)]({'room':_0xed03b9,'reason':_0x50cf9c,'timestamp':Date['now']()}),'ack':!![]});return;}resetTimer(_0x3e92b7);}if(!currentMonitoredRoom){await _0x3e92b7[_0x5c637b(0x83)](_0x5c637b(0x86),{'val':_0xed03b9,'ack':!![]});const _0x2225c9=await loadConfig(_0x3e92b7),_0x2bb8ca=_0xed03b9[_0x5c637b(0x6e)]();let _0x24e8d7=_0x2225c9[_0xed03b9]||_0x2225c9[_0x2bb8ca];if(!_0x24e8d7)for(const _0x29faf4 in DEFAULT_TIMEOUTS){if(_0x2bb8ca[_0x5c637b(0x7c)](_0x29faf4)){_0x24e8d7=DEFAULT_TIMEOUTS[_0x29faf4];break;}}if(!_0x24e8d7&&_0x2225c9[_0x5c637b(0x7b)])_0x24e8d7=_0x2225c9['default'];if(!_0x24e8d7)return;currentMonitoredRoom=_0xed03b9,startTimer(_0x3e92b7,_0x24e8d7);}}function startTimer(_0x2cac08,_0x11c77c){const _0x598f9e=a2_0x56eb05;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x11c77c*0x3c*0x3e8,startTime=Date[_0x598f9e(0x90)](),alarmStage=0x0,_0x2cac08[_0x598f9e(0x7e)]['info'](_0x598f9e(0x82)+currentMonitoredRoom+_0x598f9e(0x76)+_0x11c77c+_0x598f9e(0x74)),_0x2cac08['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x2cac08),timeoutMs);}function a2_0x30fe(){const _0x35f44a=['Unknown','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','pre_warn','Ignoriere\x20Bewegung\x20in\x20\x27','2281672DnxhPY','\x20Min.','analysis.safety.deadMan.alarmState','\x20fÃ¼r\x20','alarm','891341bcosjs','./setup','search','default','includes','message','log','error','[DeadMan]\x20','val','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','setStateAsync','948942nzmrJz','14Ibmael','analysis.safety.deadMan.currentRoom','indexOf','analysis.safety.deadMan.lastIgnored','130rwUyDo','constructor','apply','getStateAsync','toString','1012692CvCYaq','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','now','34PjJRLY','865800NZJLFG','analysis.safety.deadMan.config','7669kJxNxS','44010TSAQsR','44fxxAjy','.\x20Alles\x20in\x20Ordnung?','exports','warn','parse','stringify','info','[DeadMan]\x20Topology\x20check\x20failed:\x20','toLowerCase'];a2_0x30fe=function(){return _0x35f44a;};return a2_0x30fe();}function resetTimer(_0x40cac2){const _0x26821e=a2_0x56eb05;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x40cac2[_0x26821e(0x83)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x50930f){const _0x2b48b0=a2_0x56eb05;alarmStage=0x1,await _0x50930f[_0x2b48b0(0x83)](_0x2b48b0(0x75),{'val':_0x2b48b0(0x71),'ack':!![]});const _0xa1d680=_0x2b48b0(0x8f)+currentMonitoredRoom+_0x2b48b0(0x67);_0x50930f[_0x2b48b0(0x7e)][_0x2b48b0(0x69)](_0x2b48b0(0x80)+_0xa1d680),await setup['sendNotification'](_0x50930f,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0xa1d680),activeTimer=setTimeout(()=>triggerAlarm(_0x50930f),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x581a16){const _0x414d73=a2_0x56eb05;alarmStage=0x2,await _0x581a16['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':_0x414d73(0x77),'ack':!![]});const _0x1d529a=_0x414d73(0x70)+currentMonitoredRoom+'!';_0x581a16['log'][_0x414d73(0x7f)](_0x414d73(0x80)+_0x1d529a),await setup['sendNotification'](_0x581a16,_0x1d529a,![],!![]);}function a2_0x1ecc(_0xe5a902,_0x312c2d){const _0x217cb8=a2_0x30fe();return a2_0x1ecc=function(_0x3a03d3,_0x2b44c0){_0x3a03d3=_0x3a03d3-0x65;let _0x30feea=_0x217cb8[_0x3a03d3];return _0x30feea;},a2_0x1ecc(_0xe5a902,_0x312c2d);}module[a2_0x56eb05(0x68)]={'updateLocation':updateLocation};