const a2_0x2ba386=a2_0x3105;function a2_0x3105(_0x472b9c,_0x5a051e){const _0x4cf3ea=a2_0x5dff();return a2_0x3105=function(_0x27f172,_0x2e7382){_0x27f172=_0x27f172-0xb4;let _0x5dff16=_0x4cf3ea[_0x27f172];return _0x5dff16;},a2_0x3105(_0x472b9c,_0x5a051e);}(function(_0x1ee686,_0x161601){const _0x4c311d=a2_0x3105,_0x13993e=_0x1ee686();while(!![]){try{const _0x1ee715=-parseInt(_0x4c311d(0xe0))/0x1+parseInt(_0x4c311d(0xd3))/0x2+parseInt(_0x4c311d(0xb6))/0x3+parseInt(_0x4c311d(0xc9))/0x4*(parseInt(_0x4c311d(0xd0))/0x5)+-parseInt(_0x4c311d(0xb9))/0x6+parseInt(_0x4c311d(0xd2))/0x7+-parseInt(_0x4c311d(0xca))/0x8;if(_0x1ee715===_0x161601)break;else _0x13993e['push'](_0x13993e['shift']());}catch(_0x4f3f1e){_0x13993e['push'](_0x13993e['shift']());}}}(a2_0x5dff,0x4d941));const a2_0x2e7382=(function(){let _0xe533d=!![];return function(_0x14635a,_0x27ed02){const _0x4d3485=_0xe533d?function(){const _0x29ca30=a2_0x3105;if(_0x27ed02){const _0x4b2191=_0x27ed02[_0x29ca30(0xd6)](_0x14635a,arguments);return _0x27ed02=null,_0x4b2191;}}:function(){};return _0xe533d=![],_0x4d3485;};}()),a2_0x27f172=a2_0x2e7382(this,function(){const _0x2e918b=a2_0x3105;return a2_0x27f172[_0x2e918b(0xc4)]()[_0x2e918b(0xbb)](_0x2e918b(0xd8))[_0x2e918b(0xc4)]()[_0x2e918b(0xc1)](a2_0x27f172)[_0x2e918b(0xbb)](_0x2e918b(0xd8));});a2_0x27f172();'use strict';const setup=require(a2_0x2ba386(0xcd));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x201b83){const _0x36bb18=a2_0x2ba386;try{const _0x2ab713=await _0x201b83[_0x36bb18(0xd9)](_0x36bb18(0xd1));if(_0x2ab713&&_0x2ab713[_0x36bb18(0xcc)])return JSON[_0x36bb18(0xc3)](_0x2ab713[_0x36bb18(0xcc)]);}catch(_0x5b5e41){}return{};}async function isActive(_0x259c5f){const _0x56548f=a2_0x2ba386;try{const _0x51b472=await _0x259c5f['getStateAsync'](_0x56548f(0xb5));return _0x51b472&&_0x51b472[_0x56548f(0xcc)];}catch(_0x3b8484){return![];}}async function areRoomsConnected(_0x4e8dae,_0x2c2d39,_0x150293){const _0x29a95b=a2_0x2ba386;try{const _0x53517e=await _0x4e8dae['getStateAsync'](_0x29a95b(0xbd));if(!_0x53517e||!_0x53517e[_0x29a95b(0xcc)])return!![];const _0x13ca18=JSON[_0x29a95b(0xc3)](_0x53517e['val']),{rooms:_0x31e8a6,matrix:_0x1d23ed}=_0x13ca18;if(!_0x31e8a6||!_0x1d23ed)return!![];const _0x4fd350=_0x31e8a6[_0x29a95b(0xc7)](_0x2c2d39),_0x487053=_0x31e8a6['indexOf'](_0x150293);if(_0x4fd350===-0x1||_0x487053===-0x1)return!![];const _0x37b983=_0x1d23ed[_0x4fd350][_0x487053]>0x0||_0x1d23ed[_0x487053][_0x4fd350]>0x0;return _0x37b983;}catch(_0x2e0f77){return _0x4e8dae[_0x29a95b(0xda)]['warn'](_0x29a95b(0xc5)+_0x2e0f77[_0x29a95b(0xbf)]),!![];}}async function updateLocation(_0x2837c1,_0xdd6fb6){const _0x1a43a8=a2_0x2ba386;if(!_0xdd6fb6||_0xdd6fb6===_0x1a43a8(0xde))return;if(!await isActive(_0x2837c1)){resetTimer(_0x2837c1);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0xdd6fb6){const _0x593389=await areRoomsConnected(_0x2837c1,currentMonitoredRoom,_0xdd6fb6);if(!_0x593389){const _0x1df502=_0x1a43a8(0xe2)+_0xdd6fb6+_0x1a43a8(0xd4)+currentMonitoredRoom+'\x27.';_0x2837c1[_0x1a43a8(0xda)]['info'](_0x1a43a8(0xd5)+_0x1df502+_0x1a43a8(0xc6)),await _0x2837c1[_0x1a43a8(0xcf)](_0x1a43a8(0xc0),{'val':JSON[_0x1a43a8(0xb7)]({'room':_0xdd6fb6,'reason':_0x1df502,'timestamp':Date[_0x1a43a8(0xdf)]()}),'ack':!![]});return;}resetTimer(_0x2837c1);}if(!currentMonitoredRoom){await _0x2837c1[_0x1a43a8(0xcf)](_0x1a43a8(0xdc),{'val':_0xdd6fb6,'ack':!![]});const _0x151b35=await loadConfig(_0x2837c1),_0x37855a=_0xdd6fb6['toLowerCase']();let _0x5ee005=_0x151b35[_0xdd6fb6]||_0x151b35[_0x37855a];if(!_0x5ee005)for(const _0x5e29cd in DEFAULT_TIMEOUTS){if(_0x37855a[_0x1a43a8(0xbc)](_0x5e29cd)){_0x5ee005=DEFAULT_TIMEOUTS[_0x5e29cd];break;}}if(!_0x5ee005&&_0x151b35['default'])_0x5ee005=_0x151b35[_0x1a43a8(0xcb)];if(!_0x5ee005)return;currentMonitoredRoom=_0xdd6fb6,startTimer(_0x2837c1,_0x5ee005);}}function startTimer(_0x56137f,_0x33155f){const _0x218092=a2_0x2ba386;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x33155f*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0,_0x56137f[_0x218092(0xda)]['info'](_0x218092(0xe1)+currentMonitoredRoom+_0x218092(0xba)+_0x33155f+'\x20Min.'),_0x56137f[_0x218092(0xcf)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x56137f),timeoutMs);}function resetTimer(_0x39b3ef){const _0x275dda=a2_0x2ba386;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x39b3ef[_0x275dda(0xcf)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x1d8719){const _0x185479=a2_0x2ba386;alarmStage=0x1,await _0x1d8719[_0x185479(0xcf)](_0x185479(0xce),{'val':'pre_warn','ack':!![]});const _0x3b823e='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x185479(0xb4);_0x1d8719[_0x185479(0xda)][_0x185479(0xdb)](_0x185479(0xd5)+_0x3b823e),await setup[_0x185479(0xc8)](_0x1d8719,_0x185479(0xdd)+_0x3b823e),activeTimer=setTimeout(()=>triggerAlarm(_0x1d8719),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x41a9c0){const _0x26af85=a2_0x2ba386;alarmStage=0x2,await _0x41a9c0[_0x26af85(0xcf)]('analysis.safety.deadMan.alarmState',{'val':_0x26af85(0xd7),'ack':!![]});const _0x8fe696=_0x26af85(0xb8)+currentMonitoredRoom+'!';_0x41a9c0[_0x26af85(0xda)][_0x26af85(0xbe)](_0x26af85(0xd5)+_0x8fe696),await setup[_0x26af85(0xc8)](_0x41a9c0,_0x8fe696,![],!![]);}function a2_0x5dff(){const _0x50725c=['analysis.safety.deadMan.alarmState','setStateAsync','215WEnZiY','analysis.safety.deadMan.config','359849yFDIaK','909176SWewtu','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','[DeadMan]\x20','apply','alarm','(((.+)+)+)+$','getStateAsync','log','warn','analysis.safety.deadMan.currentRoom','ðŸ‘¼\x20Schutzengel-Frage:\x20','Unknown','now','249706slBajO','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','Ignoriere\x20Bewegung\x20in\x20\x27','.\x20Alles\x20in\x20Ordnung?','analysis.safety.deadMan.active','1131870BDbSXr','stringify','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','2321610VDbNKm','\x20fÃ¼r\x20','search','includes','analysis.topology.structure','error','message','analysis.safety.deadMan.lastIgnored','constructor','exports','parse','toString','[DeadMan]\x20Topology\x20check\x20failed:\x20','\x20(Multi-Person\x20Filter)','indexOf','sendNotification','41516jERzIg','3001440ZZwNSE','default','val','./setup'];a2_0x5dff=function(){return _0x50725c;};return a2_0x5dff();}module[a2_0x2ba386(0xc2)]={'updateLocation':updateLocation};