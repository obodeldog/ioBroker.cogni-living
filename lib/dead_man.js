const a2_0x132020=a2_0x46ef;(function(_0x1dbd61,_0x44321a){const _0x214ba2=a2_0x46ef,_0x1f1e0f=_0x1dbd61();while(!![]){try{const _0x401fec=-parseInt(_0x214ba2(0xee))/0x1*(-parseInt(_0x214ba2(0xe7))/0x2)+-parseInt(_0x214ba2(0xd3))/0x3*(parseInt(_0x214ba2(0xcc))/0x4)+-parseInt(_0x214ba2(0xd1))/0x5+parseInt(_0x214ba2(0xdb))/0x6+parseInt(_0x214ba2(0xc8))/0x7+parseInt(_0x214ba2(0xc4))/0x8*(parseInt(_0x214ba2(0xcb))/0x9)+parseInt(_0x214ba2(0xc6))/0xa*(-parseInt(_0x214ba2(0xb3))/0xb);if(_0x401fec===_0x44321a)break;else _0x1f1e0f['push'](_0x1f1e0f['shift']());}catch(_0x3c3742){_0x1f1e0f['push'](_0x1f1e0f['shift']());}}}(a2_0x5796,0x51d56));const a2_0x486e47=(function(){let _0x29180d=!![];return function(_0x5170aa,_0x10a674){const _0xdc90d6=_0x29180d?function(){const _0x154cf1=a2_0x46ef;if(_0x10a674){const _0x51eadd=_0x10a674[_0x154cf1(0xc1)](_0x5170aa,arguments);return _0x10a674=null,_0x51eadd;}}:function(){};return _0x29180d=![],_0xdc90d6;};}()),a2_0x5659cd=a2_0x486e47(this,function(){const _0x32a771=a2_0x46ef;return a2_0x5659cd[_0x32a771(0xeb)]()[_0x32a771(0xe3)](_0x32a771(0xb5))[_0x32a771(0xeb)]()[_0x32a771(0xc7)](a2_0x5659cd)[_0x32a771(0xe3)]('(((.+)+)+)+$');});a2_0x5659cd();'use strict';const setup=require(a2_0x132020(0xc0));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};async function loadConfig(_0x5eb249){const _0xd47d4e=a2_0x132020;try{const _0x4323a6=await _0x5eb249[_0xd47d4e(0xe8)]('analysis.safety.deadMan.config');if(_0x4323a6&&_0x4323a6[_0xd47d4e(0xed)])return JSON[_0xd47d4e(0xcf)](_0x4323a6[_0xd47d4e(0xed)]);}catch(_0x49b056){}return{};}async function isActive(_0x4fd72b){const _0x54a08b=a2_0x132020;try{const _0x26febf=await _0x4fd72b[_0x54a08b(0xe8)](_0x54a08b(0xb7));return _0x26febf&&_0x26febf[_0x54a08b(0xed)];}catch(_0x2ad796){return![];}}async function areRoomsConnected(_0x9f2758,_0x544f11,_0x4a6af9){const _0x44326f=a2_0x132020;try{const _0x38f782=await _0x9f2758[_0x44326f(0xe8)](_0x44326f(0xbc));if(!_0x38f782||!_0x38f782[_0x44326f(0xed)])return!![];const _0x374780=JSON[_0x44326f(0xcf)](_0x38f782[_0x44326f(0xed)]),{rooms:_0x138b21,matrix:_0x1a6d49}=_0x374780;if(!_0x138b21||!_0x1a6d49)return!![];const _0x1bec72=_0x138b21[_0x44326f(0xb4)](_0x544f11),_0x458275=_0x138b21[_0x44326f(0xb4)](_0x4a6af9);if(_0x1bec72===-0x1||_0x458275===-0x1)return!![];const _0x579114=_0x1a6d49[_0x1bec72][_0x458275]>0x0||_0x1a6d49[_0x458275][_0x1bec72]>0x0;return _0x579114;}catch(_0x4aaf18){return _0x9f2758[_0x44326f(0xe5)]['warn'](_0x44326f(0xe9)+_0x4aaf18[_0x44326f(0xca)]),!![];}}function calculateSleepProbability(_0x12fe3b){const _0xdf1c92=a2_0x132020,_0x238b64=new Date(),_0x44c45a=_0x238b64[_0xdf1c92(0xe6)](),_0x2b1df8=_0x12fe3b[_0xdf1c92(0xdf)]();let _0x57d5ed=0.1;if(_0x44c45a>=0x17||_0x44c45a<=0x6)_0x57d5ed=0x1;else{if(_0x44c45a>=0xd&&_0x44c45a<=0xf)_0x57d5ed=0.8;else{if(_0x44c45a>=0x14&&_0x44c45a<=0x17)_0x57d5ed=0.4;}}let _0x3be9ff=0.1;if(_0x2b1df8[_0xdf1c92(0xe1)](_0xdf1c92(0xb2))||_0x2b1df8[_0xdf1c92(0xe1)](_0xdf1c92(0xd6)))_0x3be9ff=0x1;else{if(_0x2b1df8[_0xdf1c92(0xe1)](_0xdf1c92(0xce))||_0x2b1df8[_0xdf1c92(0xe1)](_0xdf1c92(0xda))||_0x2b1df8[_0xdf1c92(0xe1)](_0xdf1c92(0xb8)))_0x3be9ff=0.6;else{if(_0x2b1df8[_0xdf1c92(0xe1)](_0xdf1c92(0xd0))||_0x2b1df8[_0xdf1c92(0xe1)]('wc'))_0x3be9ff=0.05;}}let _0x52704a=0.5;const _0x19aee9=_0x3be9ff*0.5+_0x57d5ed*0.3+_0x52704a*0.2;return parseFloat(_0x19aee9['toFixed'](0x2));}async function updateLocation(_0x2ab906,_0xc33889){const _0x3c065e=a2_0x132020;if(!_0xc33889||_0xc33889===_0x3c065e(0xbf))return;if(!await isActive(_0x2ab906)){resetTimer(_0x2ab906);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0xc33889){const _0xa36c16=await areRoomsConnected(_0x2ab906,currentMonitoredRoom,_0xc33889);if(!_0xa36c16){const _0x1af10b=_0x3c065e(0xb9)+_0xc33889+_0x3c065e(0xde)+currentMonitoredRoom+'\x27.';_0x2ab906[_0x3c065e(0xe5)]['info'](_0x3c065e(0xd8)+_0x1af10b+_0x3c065e(0xd7)),await _0x2ab906[_0x3c065e(0xe4)]('analysis.safety.deadMan.lastIgnored',{'val':JSON['stringify']({'room':_0xc33889,'reason':_0x1af10b,'timestamp':Date[_0x3c065e(0xea)]()}),'ack':!![]});return;}resetTimer(_0x2ab906);}if(!currentMonitoredRoom){await _0x2ab906[_0x3c065e(0xe4)]('analysis.safety.deadMan.currentRoom',{'val':_0xc33889,'ack':!![]});const _0x595500=await loadConfig(_0x2ab906),_0x3b4871=_0xc33889[_0x3c065e(0xdf)]();let _0x200d8a=_0x595500[_0xc33889]||_0x595500[_0x3b4871];if(!_0x200d8a)for(const _0x44df5 in DEFAULT_TIMEOUTS){if(_0x3b4871[_0x3c065e(0xe1)](_0x44df5)){_0x200d8a=DEFAULT_TIMEOUTS[_0x44df5];break;}}if(!_0x200d8a&&_0x595500[_0x3c065e(0xd9)])_0x200d8a=_0x595500['default'];if(!_0x200d8a)return;currentMonitoredRoom=_0xc33889,startTimer(_0x2ab906,_0x200d8a,_0xc33889);}}function a2_0x5796(){const _0x306989=['message','9dXovAQ','80znseug','\x20Min.','wohn','parse','bad','1797375ikqIvG','error','44445swnmGk','analysis.safety.deadMan.smartSleep','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','bed','\x20(Multi-Person\x20Filter)','[DeadMan]\x20','default','living','1816362rULbuv','\x20um\x2090\x20Min.','exports','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','toLowerCase','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','includes','.\x20Alles\x20in\x20Ordnung?','search','setStateAsync','log','getHours','215564lyNBWP','getStateAsync','[DeadMan]\x20Topology\x20check\x20failed:\x20','now','toString','ðŸ’¤\x20Smart\x20Sleep\x20erkannt\x20(','val','6lnUhVn','toFixed','schlaf','5368484ikGDtY','indexOf','(((.+)+)+)+$','analysis.safety.deadMan.napProbability','analysis.safety.deadMan.active','sofa','Ignoriere\x20Bewegung\x20in\x20\x27','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','alarm','analysis.topology.structure','ðŸ‘¼\x20Schutzengel-Frage:\x20','%).\x20VerlÃ¤ngere\x20Timer\x20fÃ¼r\x20','Unknown','./setup','apply','analysis.safety.deadMan.alarmState','info','734792OsfXrX','warn','10kjdros','constructor','3064187EDmKOk','sendNotification'];a2_0x5796=function(){return _0x306989;};return a2_0x5796();}function startTimer(_0x30dfbd,_0x380db3,_0x123ba3){const _0x620ae1=a2_0x132020;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x380db3*0x3c*0x3e8,startTime=Date[_0x620ae1(0xea)](),alarmStage=0x0;const _0x41e47b=calculateSleepProbability(_0x123ba3||currentMonitoredRoom),_0xe528a6=_0x41e47b>0.65;_0xe528a6?(timeoutMs+=0x5a*0x3c*0x3e8,_0x30dfbd['log'][_0x620ae1(0xc3)](_0x620ae1(0xec)+(_0x41e47b*0x64)[_0x620ae1(0xb1)](0x0)+_0x620ae1(0xbe)+currentMonitoredRoom+_0x620ae1(0xdc)),_0x30dfbd['setStateAsync'](_0x620ae1(0xd4),{'val':!![],'ack':!![]})):_0x30dfbd[_0x620ae1(0xe4)]('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0x30dfbd[_0x620ae1(0xe4)](_0x620ae1(0xb6),{'val':_0x41e47b,'ack':!![]}),_0x30dfbd['log'][_0x620ae1(0xc3)](_0x620ae1(0xe0)+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0x380db3+_0x620ae1(0xcd)),_0x30dfbd[_0x620ae1(0xe4)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x30dfbd),timeoutMs);}function resetTimer(_0x553d87){const _0x4956e1=a2_0x132020;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x553d87[_0x4956e1(0xe4)](_0x4956e1(0xc2),{'val':'ok','ack':!![]}),_0x553d87['setStateAsync'](_0x4956e1(0xd4),{'val':![],'ack':!![]}),_0x553d87[_0x4956e1(0xe4)](_0x4956e1(0xb6),{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x444461){const _0x433d5e=a2_0x132020;alarmStage=0x1,await _0x444461[_0x433d5e(0xe4)](_0x433d5e(0xc2),{'val':'pre_warn','ack':!![]});const _0x5a7e00=_0x433d5e(0xd5)+currentMonitoredRoom+_0x433d5e(0xe2);_0x444461[_0x433d5e(0xe5)][_0x433d5e(0xc5)](_0x433d5e(0xd8)+_0x5a7e00),await setup[_0x433d5e(0xc9)](_0x444461,_0x433d5e(0xbd)+_0x5a7e00),activeTimer=setTimeout(()=>triggerAlarm(_0x444461),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x51a025){const _0x5d74b5=a2_0x132020;alarmStage=0x2,await _0x51a025[_0x5d74b5(0xe4)](_0x5d74b5(0xc2),{'val':_0x5d74b5(0xbb),'ack':!![]});const _0x2d22cc=_0x5d74b5(0xba)+currentMonitoredRoom+'!';_0x51a025['log'][_0x5d74b5(0xd2)](_0x5d74b5(0xd8)+_0x2d22cc),await setup[_0x5d74b5(0xc9)](_0x51a025,_0x2d22cc,![],!![]);}function a2_0x46ef(_0xcee198,_0x183458){const _0x181d17=a2_0x5796();return a2_0x46ef=function(_0x5659cd,_0x486e47){_0x5659cd=_0x5659cd-0xb1;let _0x57962b=_0x181d17[_0x5659cd];return _0x57962b;},a2_0x46ef(_0xcee198,_0x183458);}module[a2_0x132020(0xdd)]={'updateLocation':updateLocation};