function a2_0x5eb2(_0x2953d5,_0x3e222e){const _0x1471ab=a2_0x1842();return a2_0x5eb2=function(_0x254ed4,_0x3ce7b0){_0x254ed4=_0x254ed4-0x156;let _0x1842df=_0x1471ab[_0x254ed4];return _0x1842df;},a2_0x5eb2(_0x2953d5,_0x3e222e);}const a2_0x11c627=a2_0x5eb2;(function(_0x33103b,_0x1390be){const _0x129c78=a2_0x5eb2,_0x101a29=_0x33103b();while(!![]){try{const _0x18af77=parseInt(_0x129c78(0x180))/0x1*(-parseInt(_0x129c78(0x17b))/0x2)+parseInt(_0x129c78(0x15c))/0x3*(-parseInt(_0x129c78(0x172))/0x4)+parseInt(_0x129c78(0x18e))/0x5+-parseInt(_0x129c78(0x18d))/0x6*(parseInt(_0x129c78(0x16e))/0x7)+-parseInt(_0x129c78(0x185))/0x8+-parseInt(_0x129c78(0x160))/0x9*(-parseInt(_0x129c78(0x184))/0xa)+parseInt(_0x129c78(0x168))/0xb*(parseInt(_0x129c78(0x175))/0xc);if(_0x18af77===_0x1390be)break;else _0x101a29['push'](_0x101a29['shift']());}catch(_0x50eb6c){_0x101a29['push'](_0x101a29['shift']());}}}(a2_0x1842,0xa17f9));const a2_0x3ce7b0=(function(){let _0x17e813=!![];return function(_0x365d45,_0x275a95){const _0x408ddf=_0x17e813?function(){const _0x220052=a2_0x5eb2;if(_0x275a95){const _0x9eaa17=_0x275a95[_0x220052(0x159)](_0x365d45,arguments);return _0x275a95=null,_0x9eaa17;}}:function(){};return _0x17e813=![],_0x408ddf;};}()),a2_0x254ed4=a2_0x3ce7b0(this,function(){const _0x222aac=a2_0x5eb2;return a2_0x254ed4[_0x222aac(0x17f)]()['search'](_0x222aac(0x158))['toString']()[_0x222aac(0x176)](a2_0x254ed4)[_0x222aac(0x161)](_0x222aac(0x158));});a2_0x254ed4();'use strict';const setup=require(a2_0x11c627(0x16b));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};function getTimeoutRobust(_0x5f441e,_0x54dbd0){const _0x312846=a2_0x11c627;if(!_0x5f441e||!_0x54dbd0)return undefined;if(_0x5f441e[_0x54dbd0])return _0x5f441e[_0x54dbd0];const _0x4334d0=_0x54dbd0[_0x312846(0x15d)]()[_0x312846(0x189)](/[^a-z0-9]/g,'');for(const _0x3e3ecb in _0x5f441e){const _0x4d69b9=_0x3e3ecb[_0x312846(0x15d)]()['replace'](/[^a-z0-9]/g,'');if(_0x4d69b9===_0x4334d0)return _0x5f441e[_0x3e3ecb];}const _0x586296=_0x54dbd0[_0x312846(0x15d)]();if(_0x5f441e[_0x586296])return _0x5f441e[_0x586296];return undefined;}async function loadConfig(_0x25bc5e){const _0x3ec0a6=a2_0x11c627;try{const _0x452b3e=await _0x25bc5e[_0x3ec0a6(0x16d)](_0x3ec0a6(0x178));if(_0x452b3e&&_0x452b3e[_0x3ec0a6(0x16c)])return JSON['parse'](_0x452b3e[_0x3ec0a6(0x16c)]);}catch(_0x4e719c){}return{};}async function isActive(_0x5896c5){const _0x37684a=a2_0x11c627;try{const _0xd37746=await _0x5896c5[_0x37684a(0x16d)](_0x37684a(0x179));return _0xd37746&&_0xd37746[_0x37684a(0x16c)];}catch(_0x3edd58){return![];}}async function areRoomsConnected(_0x15bac6,_0x586159,_0x3edd74){const _0x1386be=a2_0x11c627;try{const _0x30116d=await _0x15bac6['getStateAsync']('analysis.topology.structure');if(!_0x30116d||!_0x30116d[_0x1386be(0x16c)])return!![];const _0x352f60=JSON[_0x1386be(0x181)](_0x30116d[_0x1386be(0x16c)]),{rooms:_0x44c9fd,matrix:_0x1e75fe}=_0x352f60;if(!_0x44c9fd||!_0x1e75fe)return!![];const _0x424fc8=_0x44c9fd[_0x1386be(0x170)](_0x586159),_0x1c63bf=_0x44c9fd[_0x1386be(0x170)](_0x3edd74);if(_0x424fc8===-0x1||_0x1c63bf===-0x1)return!![];const _0x341847=_0x1e75fe[_0x424fc8][_0x1c63bf]>0x0||_0x1e75fe[_0x1c63bf][_0x424fc8]>0x0;return _0x341847;}catch(_0x4d35b3){return _0x15bac6[_0x1386be(0x187)][_0x1386be(0x18a)]('[DeadMan]\x20Topology\x20check\x20failed:\x20'+_0x4d35b3[_0x1386be(0x18b)]),!![];}}function calculateSleepProbability(_0x2bff8d){const _0x342373=a2_0x11c627,_0x51fc81=new Date(),_0x5bb0e0=_0x51fc81[_0x342373(0x182)](),_0x44fe4c=_0x2bff8d[_0x342373(0x15d)]();let _0xd94f66=0.1;if(_0x5bb0e0>=0x17||_0x5bb0e0<=0x6)_0xd94f66=0x1;else{if(_0x5bb0e0>=0xd&&_0x5bb0e0<=0xf)_0xd94f66=0.8;else{if(_0x5bb0e0>=0x14&&_0x5bb0e0<=0x17)_0xd94f66=0.4;}}let _0x5a16a2=0.1;if(_0x44fe4c[_0x342373(0x169)]('schlaf')||_0x44fe4c[_0x342373(0x169)]('bed'))_0x5a16a2=0x1;else{if(_0x44fe4c[_0x342373(0x169)](_0x342373(0x163))||_0x44fe4c[_0x342373(0x169)](_0x342373(0x17a))||_0x44fe4c[_0x342373(0x169)](_0x342373(0x162)))_0x5a16a2=0.6;else{if(_0x44fe4c[_0x342373(0x169)](_0x342373(0x188))||_0x44fe4c[_0x342373(0x169)]('wc'))_0x5a16a2=0.05;}}let _0xb6c3c6=0.5;const _0xfdbd7c=_0x5a16a2*0.5+_0xd94f66*0.3+_0xb6c3c6*0.2;return parseFloat(_0xfdbd7c[_0x342373(0x156)](0x2));}async function updateLocation(_0x217e23,_0x1d7852){const _0x3e0c2b=a2_0x11c627;if(!_0x1d7852||_0x1d7852===_0x3e0c2b(0x173))return;if(!await isActive(_0x217e23)){resetTimer(_0x217e23);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x1d7852){const _0x4b4ef3=await areRoomsConnected(_0x217e23,currentMonitoredRoom,_0x1d7852);if(!_0x4b4ef3){const _0x3cd7a6='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x1d7852+'\x27.\x20Nicht\x20verbunden\x20mit\x20√ºberwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0x217e23['log'][_0x3e0c2b(0x177)](_0x3e0c2b(0x15b)+_0x3cd7a6+_0x3e0c2b(0x171)),await _0x217e23['setStateAsync'](_0x3e0c2b(0x16a),{'val':JSON[_0x3e0c2b(0x174)]({'room':_0x1d7852,'reason':_0x3cd7a6,'timestamp':Date[_0x3e0c2b(0x186)]()}),'ack':!![]});return;}resetTimer(_0x217e23);}if(!currentMonitoredRoom){await _0x217e23[_0x3e0c2b(0x16f)]('analysis.safety.deadMan.currentRoom',{'val':_0x1d7852,'ack':!![]});const _0x46d3c0=await loadConfig(_0x217e23);let _0xf9f0e2=getTimeoutRobust(_0x46d3c0,_0x1d7852);const _0x7877d6=_0x1d7852[_0x3e0c2b(0x15d)]();if(!_0xf9f0e2)for(const _0xd47ad6 in DEFAULT_TIMEOUTS){if(_0x7877d6[_0x3e0c2b(0x169)](_0xd47ad6)){_0xf9f0e2=DEFAULT_TIMEOUTS[_0xd47ad6];break;}}if(!_0xf9f0e2&&_0x46d3c0[_0x3e0c2b(0x18c)])_0xf9f0e2=_0x46d3c0[_0x3e0c2b(0x18c)];if(!_0xf9f0e2)return;currentMonitoredRoom=_0x1d7852,startTimer(_0x217e23,_0xf9f0e2,_0x1d7852);}}function startTimer(_0x31cb69,_0xb679b9,_0x3fe0ee){const _0x5d9eeb=a2_0x11c627;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0xb679b9*0x3c*0x3e8,startTime=Date[_0x5d9eeb(0x186)](),alarmStage=0x0;const _0x87abcf=calculateSleepProbability(_0x3fe0ee||currentMonitoredRoom),_0xc26818=_0x87abcf>0.65;_0xc26818?(timeoutMs+=0x5a*0x3c*0x3e8,_0x31cb69[_0x5d9eeb(0x187)][_0x5d9eeb(0x177)]('üí§\x20Smart\x20Sleep\x20erkannt\x20('+(_0x87abcf*0x64)[_0x5d9eeb(0x156)](0x0)+_0x5d9eeb(0x15e)+currentMonitoredRoom+_0x5d9eeb(0x17d)),_0x31cb69[_0x5d9eeb(0x16f)](_0x5d9eeb(0x166),{'val':!![],'ack':!![]})):_0x31cb69[_0x5d9eeb(0x16f)]('analysis.safety.deadMan.smartSleep',{'val':![],'ack':!![]}),_0x31cb69['setStateAsync'](_0x5d9eeb(0x17e),{'val':_0x87abcf,'ack':!![]}),_0x31cb69[_0x5d9eeb(0x187)][_0x5d9eeb(0x177)]('üëº\x20Schutzengel:\x20√úberwache\x20'+currentMonitoredRoom+_0x5d9eeb(0x17c)+_0xb679b9+'\x20Min.'),_0x31cb69[_0x5d9eeb(0x16f)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x31cb69),timeoutMs);}function resetTimer(_0x1ddb12){const _0x4fb2f7=a2_0x11c627;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x1ddb12[_0x4fb2f7(0x16f)](_0x4fb2f7(0x183),{'val':'ok','ack':!![]}),_0x1ddb12[_0x4fb2f7(0x16f)](_0x4fb2f7(0x166),{'val':![],'ack':!![]}),_0x1ddb12[_0x4fb2f7(0x16f)](_0x4fb2f7(0x17e),{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x587da7){const _0x1fe62b=a2_0x11c627;alarmStage=0x1,await _0x587da7[_0x1fe62b(0x16f)]('analysis.safety.deadMan.alarmState',{'val':_0x1fe62b(0x167),'ack':!![]});const _0x49193d=_0x1fe62b(0x165)+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x587da7['log'][_0x1fe62b(0x18a)](_0x1fe62b(0x15b)+_0x49193d),await setup[_0x1fe62b(0x15a)](_0x587da7,_0x1fe62b(0x15f)+_0x49193d),activeTimer=setTimeout(()=>triggerAlarm(_0x587da7),0x5*0x3c*0x3e8);}function a2_0x1842(){const _0x4018c2=['toLowerCase','%).\x20Verl√§ngere\x20Timer\x20f√ºr\x20','üëº\x20Schutzengel-Frage:\x20','423GTLIof','search','sofa','wohn','üö®\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','‚è≥\x20ACHTUNG:\x20Ungew√∂hnlich\x20lange\x20Inaktivit√§t\x20in\x20','analysis.safety.deadMan.smartSleep','pre_warn','2578521MqNwXx','includes','analysis.safety.deadMan.lastIgnored','./setup','val','getStateAsync','14mZcmBw','setStateAsync','indexOf','\x20(Multi-Person\x20Filter)','32oZzDDW','Unknown','stringify','84pIYyoT','constructor','info','analysis.safety.deadMan.config','analysis.safety.deadMan.active','living','2hXkFnr','\x20f√ºr\x20','\x20um\x2090\x20Min.','analysis.safety.deadMan.napProbability','toString','1008059SsRjJB','parse','getHours','analysis.safety.deadMan.alarmState','188030dUYmag','5097216LyFSKq','now','log','bad','replace','warn','message','default','1677786ttaebQ','6486800BBCOnl','error','toFixed','exports','(((.+)+)+)+$','apply','sendNotification','[DeadMan]\x20','358503KNApKb'];a2_0x1842=function(){return _0x4018c2;};return a2_0x1842();}async function triggerAlarm(_0x5a09f5){const _0x29dca3=a2_0x11c627;alarmStage=0x2,await _0x5a09f5[_0x29dca3(0x16f)](_0x29dca3(0x183),{'val':'alarm','ack':!![]});const _0x2b4a92=_0x29dca3(0x164)+currentMonitoredRoom+'!';_0x5a09f5['log'][_0x29dca3(0x18f)](_0x29dca3(0x15b)+_0x2b4a92),await setup[_0x29dca3(0x15a)](_0x5a09f5,_0x2b4a92,![],!![]);}module[a2_0x11c627(0x157)]={'updateLocation':updateLocation};