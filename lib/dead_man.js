const a2_0x7b23bf=a2_0x2828;(function(_0x413889,_0x9f927f){const _0x5b8a0f=a2_0x2828,_0x10614a=_0x413889();while(!![]){try{const _0x494f9a=parseInt(_0x5b8a0f(0x11c))/0x1+parseInt(_0x5b8a0f(0x11b))/0x2+-parseInt(_0x5b8a0f(0x116))/0x3*(-parseInt(_0x5b8a0f(0x124))/0x4)+-parseInt(_0x5b8a0f(0x112))/0x5+-parseInt(_0x5b8a0f(0x111))/0x6*(parseInt(_0x5b8a0f(0x118))/0x7)+-parseInt(_0x5b8a0f(0x130))/0x8*(-parseInt(_0x5b8a0f(0x12f))/0x9)+-parseInt(_0x5b8a0f(0x10e))/0xa;if(_0x494f9a===_0x9f927f)break;else _0x10614a['push'](_0x10614a['shift']());}catch(_0x23e824){_0x10614a['push'](_0x10614a['shift']());}}}(a2_0x1bdb,0x3629b));function a2_0x1bdb(){const _0x52e324=['constructor','search','3rsmUbd','getStateAsync','245OLxjQi','alarm','./setup','151584PWnoCo','228081HhFNoo','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','Unknown','warn','sendNotification','analysis.safety.deadMan.alarmState','pre_warn','exports','1081364pNwuTQ','toString','error','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','default','includes','info','\x20Min.','now','(((.+)+)+)+$','val','933516sFihjN','32iitcsr','indexOf','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','log','\x27.\x20(Multi-Person\x20Filter)','analysis.topology.structure','setStateAsync','apply','analysis.safety.deadMan.currentRoom','5597090VEXdBj','analysis.safety.deadMan.active','parse','4242YPXvAb','914025ELYepz','[DeadMan]\x20'];a2_0x1bdb=function(){return _0x52e324;};return a2_0x1bdb();}const a2_0x562de3=(function(){let _0x32a316=!![];return function(_0x28392f,_0x150055){const _0x4ecc21=_0x32a316?function(){const _0x347c1e=a2_0x2828;if(_0x150055){const _0x58a3e3=_0x150055[_0x347c1e(0x10c)](_0x28392f,arguments);return _0x150055=null,_0x58a3e3;}}:function(){};return _0x32a316=![],_0x4ecc21;};}()),a2_0x2f3e31=a2_0x562de3(this,function(){const _0x2604d5=a2_0x2828;return a2_0x2f3e31[_0x2604d5(0x125)]()['search'](_0x2604d5(0x12d))['toString']()[_0x2604d5(0x114)](a2_0x2f3e31)[_0x2604d5(0x115)](_0x2604d5(0x12d));});a2_0x2f3e31();'use strict';const setup=require(a2_0x7b23bf(0x11a));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x35f003){const _0x3f04e7=a2_0x7b23bf;try{const _0x5cd05c=await _0x35f003[_0x3f04e7(0x117)]('analysis.safety.deadMan.config');if(_0x5cd05c&&_0x5cd05c['val'])return JSON[_0x3f04e7(0x110)](_0x5cd05c['val']);}catch(_0x310a55){}return{};}async function isActive(_0x934cc3){const _0x3dad82=a2_0x7b23bf;try{const _0x47c6fe=await _0x934cc3[_0x3dad82(0x117)](_0x3dad82(0x10f));return _0x47c6fe&&_0x47c6fe[_0x3dad82(0x12e)];}catch(_0x486bb4){return![];}}async function areRoomsConnected(_0x4b9afa,_0x3cef19,_0x2a7382){const _0x591a2a=a2_0x7b23bf;try{const _0x3dbec3=await _0x4b9afa[_0x591a2a(0x117)](_0x591a2a(0x136));if(!_0x3dbec3||!_0x3dbec3[_0x591a2a(0x12e)])return!![];const _0x6a3c63=JSON[_0x591a2a(0x110)](_0x3dbec3['val']),{rooms:_0x4fa67f,matrix:_0x4324ea}=_0x6a3c63;if(!_0x4fa67f||!_0x4324ea)return!![];const _0x1eec52=_0x4fa67f[_0x591a2a(0x131)](_0x3cef19),_0x2b0e23=_0x4fa67f['indexOf'](_0x2a7382);if(_0x1eec52===-0x1||_0x2b0e23===-0x1)return!![];const _0x4c1535=_0x4324ea[_0x1eec52][_0x2b0e23]>0x0||_0x4324ea[_0x2b0e23][_0x1eec52]>0x0;return _0x4c1535;}catch(_0x4f79b4){return _0x4b9afa[_0x591a2a(0x134)]['warn']('[DeadMan]\x20Topology\x20check\x20failed:\x20'+_0x4f79b4['message']),!![];}}async function updateLocation(_0x487de5,_0xbb6f75){const _0x20e52a=a2_0x7b23bf;if(!_0xbb6f75||_0xbb6f75===_0x20e52a(0x11e))return;if(!await isActive(_0x487de5)){resetTimer(_0x487de5);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0xbb6f75){const _0x3dbcb3=await areRoomsConnected(_0x487de5,currentMonitoredRoom,_0xbb6f75);if(!_0x3dbcb3){_0x487de5[_0x20e52a(0x134)][_0x20e52a(0x12a)](_0x20e52a(0x132)+_0xbb6f75+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+_0x20e52a(0x135));return;}resetTimer(_0x487de5);}if(!currentMonitoredRoom){await _0x487de5[_0x20e52a(0x137)](_0x20e52a(0x10d),{'val':_0xbb6f75,'ack':!![]});const _0x482748=await loadConfig(_0x487de5),_0x5f47ef=_0xbb6f75['toLowerCase']();let _0xb71f10=_0x482748[_0xbb6f75]||_0x482748[_0x5f47ef];if(!_0xb71f10)for(const _0x482213 in DEFAULT_TIMEOUTS){if(_0x5f47ef[_0x20e52a(0x129)](_0x482213)){_0xb71f10=DEFAULT_TIMEOUTS[_0x482213];break;}}if(!_0xb71f10&&_0x482748['default'])_0xb71f10=_0x482748[_0x20e52a(0x128)];if(!_0xb71f10)return;currentMonitoredRoom=_0xbb6f75,startTimer(_0x487de5,_0xb71f10);}}function startTimer(_0x24bf53,_0x3f09b7){const _0x234211=a2_0x7b23bf;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3f09b7*0x3c*0x3e8,startTime=Date[_0x234211(0x12c)](),alarmStage=0x0,_0x24bf53[_0x234211(0x134)]['info'](_0x234211(0x11d)+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0x3f09b7+_0x234211(0x12b)),_0x24bf53[_0x234211(0x137)](_0x234211(0x121),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x24bf53),timeoutMs);}function resetTimer(_0x45f0d6){const _0x174917=a2_0x7b23bf;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x45f0d6[_0x174917(0x137)](_0x174917(0x121),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x321f60){const _0x53d699=a2_0x7b23bf;alarmStage=0x1,await _0x321f60[_0x53d699(0x137)]('analysis.safety.deadMan.alarmState',{'val':_0x53d699(0x122),'ack':!![]});const _0xbaa83e=_0x53d699(0x133)+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x321f60[_0x53d699(0x134)][_0x53d699(0x11f)](_0x53d699(0x113)+_0xbaa83e),await setup[_0x53d699(0x120)](_0x321f60,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0xbaa83e),activeTimer=setTimeout(()=>triggerAlarm(_0x321f60),0x5*0x3c*0x3e8);}function a2_0x2828(_0x14a706,_0x4f3135){const _0x19c9ed=a2_0x1bdb();return a2_0x2828=function(_0x2f3e31,_0x562de3){_0x2f3e31=_0x2f3e31-0x10c;let _0x1bdb2f=_0x19c9ed[_0x2f3e31];return _0x1bdb2f;},a2_0x2828(_0x14a706,_0x4f3135);}async function triggerAlarm(_0x4144c8){const _0x1736a5=a2_0x7b23bf;alarmStage=0x2,await _0x4144c8[_0x1736a5(0x137)](_0x1736a5(0x121),{'val':_0x1736a5(0x119),'ack':!![]});const _0x164265=_0x1736a5(0x127)+currentMonitoredRoom+'!';_0x4144c8[_0x1736a5(0x134)][_0x1736a5(0x126)](_0x1736a5(0x113)+_0x164265),await setup['sendNotification'](_0x4144c8,_0x164265,![],!![]);}module[a2_0x7b23bf(0x123)]={'updateLocation':updateLocation};