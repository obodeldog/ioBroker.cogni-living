const a2_0x3b27d3=a2_0x18a4;(function(_0x46976a,_0x332c38){const _0x2d949e=a2_0x18a4,_0x384b11=_0x46976a();while(!![]){try{const _0x43bcac=-parseInt(_0x2d949e(0x120))/0x1*(parseInt(_0x2d949e(0x13b))/0x2)+parseInt(_0x2d949e(0x138))/0x3+parseInt(_0x2d949e(0x127))/0x4+-parseInt(_0x2d949e(0x11f))/0x5+parseInt(_0x2d949e(0x135))/0x6+parseInt(_0x2d949e(0x136))/0x7+-parseInt(_0x2d949e(0x137))/0x8;if(_0x43bcac===_0x332c38)break;else _0x384b11['push'](_0x384b11['shift']());}catch(_0x147d73){_0x384b11['push'](_0x384b11['shift']());}}}(a2_0x5e62,0x6e344));const a2_0xfd078=(function(){let _0x442b7a=!![];return function(_0x52c465,_0x5b094b){const _0x5703a6=_0x442b7a?function(){const _0x1a8a65=a2_0x18a4;if(_0x5b094b){const _0x2c4ac8=_0x5b094b[_0x1a8a65(0x124)](_0x52c465,arguments);return _0x5b094b=null,_0x2c4ac8;}}:function(){};return _0x442b7a=![],_0x5703a6;};}()),a2_0x105462=a2_0xfd078(this,function(){const _0x5c3a15=a2_0x18a4;return a2_0x105462['toString']()[_0x5c3a15(0x126)]('(((.+)+)+)+$')[_0x5c3a15(0x139)]()[_0x5c3a15(0x140)](a2_0x105462)[_0x5c3a15(0x126)](_0x5c3a15(0x143));});a2_0x105462();'use strict';const setup=require(a2_0x3b27d3(0x133));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x255134){const _0x14470a=a2_0x3b27d3;try{const _0x2fa681=await _0x255134[_0x14470a(0x12f)](_0x14470a(0x11a));if(_0x2fa681&&_0x2fa681[_0x14470a(0x11d)])return JSON[_0x14470a(0x131)](_0x2fa681[_0x14470a(0x11d)]);}catch(_0x3daf04){}return{};}async function isActive(_0x5540d9){const _0x3afccd=a2_0x3b27d3;try{const _0x2529ce=await _0x5540d9[_0x3afccd(0x12f)](_0x3afccd(0x13e));return _0x2529ce&&_0x2529ce[_0x3afccd(0x11d)];}catch(_0x57a4b8){return![];}}async function areRoomsConnected(_0x1419a1,_0x3037a5,_0x214fd9){const _0x2c7295=a2_0x3b27d3;try{const _0x694c82=await _0x1419a1[_0x2c7295(0x12f)](_0x2c7295(0x11e));if(!_0x694c82||!_0x694c82[_0x2c7295(0x11d)])return!![];const _0x7c9ee4=JSON['parse'](_0x694c82[_0x2c7295(0x11d)]),{rooms:_0x2f4da6,matrix:_0x4a1cb6}=_0x7c9ee4;if(!_0x2f4da6||!_0x4a1cb6)return!![];const _0xd05494=_0x2f4da6[_0x2c7295(0x134)](_0x3037a5),_0x27ca37=_0x2f4da6[_0x2c7295(0x134)](_0x214fd9);if(_0xd05494===-0x1||_0x27ca37===-0x1)return!![];const _0x58d12d=_0x4a1cb6[_0xd05494][_0x27ca37]>0x0||_0x4a1cb6[_0x27ca37][_0xd05494]>0x0;return _0x58d12d;}catch(_0x1d2f45){return _0x1419a1['log'][_0x2c7295(0x13c)](_0x2c7295(0x11c)+_0x1d2f45[_0x2c7295(0x128)]),!![];}}async function updateLocation(_0x307d23,_0x5e635b){const _0x30feef=a2_0x3b27d3;if(!_0x5e635b||_0x5e635b==='Unknown')return;if(!await isActive(_0x307d23)){resetTimer(_0x307d23);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x5e635b){const _0xd1fab1=await areRoomsConnected(_0x307d23,currentMonitoredRoom,_0x5e635b);if(!_0xd1fab1){const _0x192249=_0x30feef(0x12e)+_0x5e635b+_0x30feef(0x118)+currentMonitoredRoom+'\x27.';_0x307d23['log'][_0x30feef(0x12d)](_0x30feef(0x13a)+_0x192249+_0x30feef(0x145)),await _0x307d23[_0x30feef(0x12b)]('analysis.safety.deadMan.lastIgnored',{'val':JSON[_0x30feef(0x121)]({'room':_0x5e635b,'reason':_0x192249,'timestamp':Date[_0x30feef(0x11b)]()}),'ack':!![]});return;}resetTimer(_0x307d23);}if(!currentMonitoredRoom){await _0x307d23[_0x30feef(0x12b)](_0x30feef(0x12c),{'val':_0x5e635b,'ack':!![]});const _0x4ffccd=await loadConfig(_0x307d23),_0x5f3feb=_0x5e635b[_0x30feef(0x117)]();let _0x245ff9=_0x4ffccd[_0x5e635b]||_0x4ffccd[_0x5f3feb];if(!_0x245ff9)for(const _0x268fa6 in DEFAULT_TIMEOUTS){if(_0x5f3feb[_0x30feef(0x146)](_0x268fa6)){_0x245ff9=DEFAULT_TIMEOUTS[_0x268fa6];break;}}if(!_0x245ff9&&_0x4ffccd[_0x30feef(0x13f)])_0x245ff9=_0x4ffccd[_0x30feef(0x13f)];if(!_0x245ff9)return;currentMonitoredRoom=_0x5e635b,startTimer(_0x307d23,_0x245ff9);}}function a2_0x5e62(){const _0x5d5a7e=['val','analysis.topology.structure','914500TDZbpI','39vHrvDx','stringify','ðŸ‘¼\x20Schutzengel-Frage:\x20','analysis.safety.deadMan.alarmState','apply','\x20fÃ¼r\x20','search','77428QiyLlg','message','error','.\x20Alles\x20in\x20Ordnung?','setStateAsync','analysis.safety.deadMan.currentRoom','info','Ignoriere\x20Bewegung\x20in\x20\x27','getStateAsync','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','parse','sendNotification','./setup','indexOf','2518464wZfJIb','5951638jrdDCF','9098376ARFtyU','1508901ZNeezq','toString','[DeadMan]\x20','1062uPZYkP','warn','log','analysis.safety.deadMan.active','default','constructor','alarm','exports','(((.+)+)+)+$','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','\x20(Multi-Person\x20Filter)','includes','toLowerCase','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','analysis.safety.deadMan.config','now','[DeadMan]\x20Topology\x20check\x20failed:\x20'];a2_0x5e62=function(){return _0x5d5a7e;};return a2_0x5e62();}function startTimer(_0x538ce2,_0x566341){const _0x48607f=a2_0x3b27d3;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x566341*0x3c*0x3e8,startTime=Date[_0x48607f(0x11b)](),alarmStage=0x0,_0x538ce2[_0x48607f(0x13d)]['info'](_0x48607f(0x130)+currentMonitoredRoom+_0x48607f(0x125)+_0x566341+'\x20Min.'),_0x538ce2[_0x48607f(0x12b)](_0x48607f(0x123),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x538ce2),timeoutMs);}function resetTimer(_0x53b88a){const _0x23dac7=a2_0x3b27d3;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x53b88a[_0x23dac7(0x12b)](_0x23dac7(0x123),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x4e60a0){const _0xc33569=a2_0x3b27d3;alarmStage=0x1,await _0x4e60a0[_0xc33569(0x12b)](_0xc33569(0x123),{'val':'pre_warn','ack':!![]});const _0x3e0cc3=_0xc33569(0x119)+currentMonitoredRoom+_0xc33569(0x12a);_0x4e60a0[_0xc33569(0x13d)]['warn'](_0xc33569(0x13a)+_0x3e0cc3),await setup[_0xc33569(0x132)](_0x4e60a0,_0xc33569(0x122)+_0x3e0cc3),activeTimer=setTimeout(()=>triggerAlarm(_0x4e60a0),0x5*0x3c*0x3e8);}async function triggerAlarm(_0xa2537){const _0x1209c2=a2_0x3b27d3;alarmStage=0x2,await _0xa2537[_0x1209c2(0x12b)](_0x1209c2(0x123),{'val':_0x1209c2(0x141),'ack':!![]});const _0x43054d=_0x1209c2(0x144)+currentMonitoredRoom+'!';_0xa2537[_0x1209c2(0x13d)][_0x1209c2(0x129)](_0x1209c2(0x13a)+_0x43054d),await setup[_0x1209c2(0x132)](_0xa2537,_0x43054d,![],!![]);}function a2_0x18a4(_0x4abaeb,_0x3919e0){const _0x4089b4=a2_0x5e62();return a2_0x18a4=function(_0x105462,_0xfd078){_0x105462=_0x105462-0x117;let _0x5e6207=_0x4089b4[_0x105462];return _0x5e6207;},a2_0x18a4(_0x4abaeb,_0x3919e0);}module[a2_0x3b27d3(0x142)]={'updateLocation':updateLocation};