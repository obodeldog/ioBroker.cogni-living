(function(_0x339d75,_0x731919){const _0xdad15=a2_0x1db5,_0x31a9f3=_0x339d75();while(!![]){try{const _0x14f497=-parseInt(_0xdad15(0x20d))/0x1+parseInt(_0xdad15(0x1f2))/0x2+parseInt(_0xdad15(0x1f6))/0x3*(parseInt(_0xdad15(0x1f1))/0x4)+parseInt(_0xdad15(0x1f3))/0x5*(parseInt(_0xdad15(0x209))/0x6)+parseInt(_0xdad15(0x1eb))/0x7*(-parseInt(_0xdad15(0x1ee))/0x8)+-parseInt(_0xdad15(0x1ea))/0x9+parseInt(_0xdad15(0x1e9))/0xa;if(_0x14f497===_0x731919)break;else _0x31a9f3['push'](_0x31a9f3['shift']());}catch(_0x2231a7){_0x31a9f3['push'](_0x31a9f3['shift']());}}}(a2_0x14df,0x57f2a));const a2_0x5e74b4=(function(){let _0x448df0=!![];return function(_0x46f67b,_0x2c0bb2){const _0x51847c=_0x448df0?function(){if(_0x2c0bb2){const _0x57e6d4=_0x2c0bb2['apply'](_0x46f67b,arguments);return _0x2c0bb2=null,_0x57e6d4;}}:function(){};return _0x448df0=![],_0x51847c;};}()),a2_0x4d3901=a2_0x5e74b4(this,function(){const _0x3cfa20=a2_0x1db5;return a2_0x4d3901[_0x3cfa20(0x1f0)]()[_0x3cfa20(0x207)](_0x3cfa20(0x206))[_0x3cfa20(0x1f0)]()[_0x3cfa20(0x208)](a2_0x4d3901)[_0x3cfa20(0x207)](_0x3cfa20(0x206));});a2_0x4d3901();'use strict';const setup=require('./setup');let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;function a2_0x1db5(_0x187fd5,_0x312586){const _0x238261=a2_0x14df();return a2_0x1db5=function(_0x4d3901,_0x5e74b4){_0x4d3901=_0x4d3901-0x1e8;let _0x14df4f=_0x238261[_0x4d3901];return _0x14df4f;},a2_0x1db5(_0x187fd5,_0x312586);}const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'default':0x78};function a2_0x14df(){const _0x303e71=['(((.+)+)+)+$','search','constructor','6yAkSNI','analysis.safety.deadMan.active','alarm','setStateAsync','371500jbBlOt','Unknown','ðŸ‘¼\x20Schutzengel-Frage:\x20','\x20Min.','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','4733750gHVpWH','2044539XDkFkQ','10598YOyhgc','analysis.safety.deadMan.config','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','3416GwCaiu','pre_warn','toString','2358104wtaiBz','559658ZjaERf','1313265XCOFyX','[DeadMan]\x20','\x20(Ignoriert)','3wZKots','default','analysis.safety.deadMan.alarmState','val','warn','toLowerCase','getStateAsync','sendNotification','analysis.safety.deadMan.currentRoom','now','parse','\x20fÃ¼r\x20','log','.\x20Alles\x20in\x20Ordnung?','debug','info'];a2_0x14df=function(){return _0x303e71;};return a2_0x14df();}async function loadConfig(_0x1c9020){const _0x138dbf=a2_0x1db5;try{const _0x190d53=await _0x1c9020[_0x138dbf(0x1fc)](_0x138dbf(0x1ec));if(_0x190d53&&_0x190d53[_0x138dbf(0x1f9)])return JSON[_0x138dbf(0x200)](_0x190d53['val']);}catch(_0x5e85d1){}return{};}async function isActive(_0x2440c5){const _0x2c2ee6=a2_0x1db5;try{const _0x5d84bc=await _0x2440c5['getStateAsync'](_0x2c2ee6(0x20a));return _0x5d84bc&&_0x5d84bc[_0x2c2ee6(0x1f9)];}catch(_0x4deff6){return![];}}async function updateLocation(_0x335624,_0x473578){const _0x1b5d05=a2_0x1db5;if(!_0x473578||_0x473578===_0x1b5d05(0x20e))return;if(!await isActive(_0x335624)){resetTimer(_0x335624);return;}const _0x52a36c=await loadConfig(_0x335624),_0x24fdb8=_0x473578[_0x1b5d05(0x1fb)]();if(currentMonitoredRoom!==_0x473578){resetTimer(_0x335624),currentMonitoredRoom=_0x473578,await _0x335624[_0x1b5d05(0x20c)](_0x1b5d05(0x1fe),{'val':_0x473578,'ack':!![]});let _0x112f2c=_0x52a36c[_0x473578]||_0x52a36c[_0x24fdb8];if(!_0x112f2c)for(const _0x5b3310 in DEFAULT_TIMEOUTS){if(_0x24fdb8['includes'](_0x5b3310)){_0x112f2c=DEFAULT_TIMEOUTS[_0x5b3310];break;}}if(!_0x112f2c&&!_0x52a36c[_0x1b5d05(0x1f7)]){_0x335624['log'][_0x1b5d05(0x204)]('[DeadMan]\x20Kein\x20Timer\x20fÃ¼r\x20'+_0x473578+_0x1b5d05(0x1f5));return;}_0x112f2c=_0x112f2c||DEFAULT_TIMEOUTS[_0x1b5d05(0x1f7)],startTimer(_0x335624,_0x112f2c);}else{}}function startTimer(_0x19e564,_0x3f0a48){const _0x33ead6=a2_0x1db5;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3f0a48*0x3c*0x3e8,startTime=Date[_0x33ead6(0x1ff)](),alarmStage=0x0,_0x19e564[_0x33ead6(0x202)][_0x33ead6(0x205)]('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+_0x33ead6(0x201)+_0x3f0a48+_0x33ead6(0x210)),_0x19e564[_0x33ead6(0x20c)](_0x33ead6(0x1f8),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x19e564),timeoutMs);}function resetTimer(_0x5cb09f){const _0x4b9a2d=a2_0x1db5;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x5cb09f[_0x4b9a2d(0x20c)](_0x4b9a2d(0x1f8),{'val':'ok','ack':!![]}),_0x5cb09f[_0x4b9a2d(0x20c)](_0x4b9a2d(0x1fe),{'val':'','ack':!![]});}async function triggerPreWarn(_0x16a7ed){const _0x26318a=a2_0x1db5;alarmStage=0x1,await _0x16a7ed[_0x26318a(0x20c)](_0x26318a(0x1f8),{'val':_0x26318a(0x1ef),'ack':!![]});const _0x165e67=_0x26318a(0x1e8)+currentMonitoredRoom+_0x26318a(0x203);_0x16a7ed[_0x26318a(0x202)][_0x26318a(0x1fa)](_0x26318a(0x1f4)+_0x165e67),setup[_0x26318a(0x1fd)](_0x16a7ed,_0x26318a(0x20f)+_0x165e67),activeTimer=setTimeout(()=>triggerAlarm(_0x16a7ed),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x283348){const _0x588c44=a2_0x1db5;alarmStage=0x2,await _0x283348[_0x588c44(0x20c)]('analysis.safety.deadMan.alarmState',{'val':_0x588c44(0x20b),'ack':!![]});const _0x85c485=_0x588c44(0x1ed)+currentMonitoredRoom+'!';_0x283348['log']['error'](_0x588c44(0x1f4)+_0x85c485),setup['sendNotification'](_0x283348,_0x85c485,![],!![]);}module['exports']={'updateLocation':updateLocation};