const a2_0x3ceacc=a2_0xb123;(function(_0x28b0b0,_0x5ecb8c){const _0x56b9d4=a2_0xb123,_0x59094c=_0x28b0b0();while(!![]){try{const _0x54957c=parseInt(_0x56b9d4(0x1f7))/0x1*(-parseInt(_0x56b9d4(0x1ec))/0x2)+parseInt(_0x56b9d4(0x1ef))/0x3+-parseInt(_0x56b9d4(0x1eb))/0x4+-parseInt(_0x56b9d4(0x201))/0x5*(-parseInt(_0x56b9d4(0x1e8))/0x6)+parseInt(_0x56b9d4(0x1ea))/0x7*(-parseInt(_0x56b9d4(0x1f1))/0x8)+-parseInt(_0x56b9d4(0x20b))/0x9*(parseInt(_0x56b9d4(0x208))/0xa)+parseInt(_0x56b9d4(0x210))/0xb;if(_0x54957c===_0x5ecb8c)break;else _0x59094c['push'](_0x59094c['shift']());}catch(_0x1dc7e0){_0x59094c['push'](_0x59094c['shift']());}}}(a2_0x4dd9,0x66bef));const a2_0x50dc97=(function(){let _0xf9bf9d=!![];return function(_0x458141,_0x6e8812){const _0x1a2b85=_0xf9bf9d?function(){const _0x2478e5=a2_0xb123;if(_0x6e8812){const _0x29443f=_0x6e8812[_0x2478e5(0x200)](_0x458141,arguments);return _0x6e8812=null,_0x29443f;}}:function(){};return _0xf9bf9d=![],_0x1a2b85;};}()),a2_0x4355e7=a2_0x50dc97(this,function(){const _0x391a90=a2_0xb123;return a2_0x4355e7[_0x391a90(0x204)]()[_0x391a90(0x1f6)](_0x391a90(0x1fa))[_0x391a90(0x204)]()[_0x391a90(0x202)](a2_0x4355e7)['search'](_0x391a90(0x1fa));});a2_0x4355e7();'use strict';const setup=require(a2_0x3ceacc(0x212));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0xa62782){const _0xf8387f=a2_0x3ceacc;try{const _0x2cf81d=await _0xa62782[_0xf8387f(0x1ed)](_0xf8387f(0x1e7));if(_0x2cf81d&&_0x2cf81d[_0xf8387f(0x20c)])return JSON[_0xf8387f(0x1e6)](_0x2cf81d[_0xf8387f(0x20c)]);}catch(_0x46afd7){}return{};}async function isActive(_0x54b8da){const _0x1179dc=a2_0x3ceacc;try{const _0x3b32ac=await _0x54b8da[_0x1179dc(0x1ed)](_0x1179dc(0x1e4));return _0x3b32ac&&_0x3b32ac[_0x1179dc(0x20c)];}catch(_0x286af1){return![];}}function a2_0x4dd9(){const _0x44b3c3=['setStateAsync','sendNotification','analysis.safety.deadMan.active','message','parse','analysis.safety.deadMan.config','370842DVyHRf','info','7XePfrh','1173560FfOYFu','30egUAhI','getStateAsync','\x20Min.','999777mrfJQx','[DeadMan]\x20Topology\x20check\x20failed:\x20','3232904LGVpuj','\x27.\x20(Multi-Person\x20Filter)','analysis.topology.structure','toLowerCase','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','search','53168nLxmZq','includes','analysis.safety.deadMan.alarmState','(((.+)+)+)+$','.\x20Alles\x20in\x20Ordnung?','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','analysis.safety.deadMan.currentRoom','indexOf','apply','30qXknIy','constructor','now','toString','default','warn','exports','1855670jUZsrl','Unknown','alarm','9sUIXxr','val','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','ðŸ‘¼\x20Schutzengel-Frage:\x20','[DeadMan]\x20','15370696hBSfPl','log','./setup'];a2_0x4dd9=function(){return _0x44b3c3;};return a2_0x4dd9();}async function areRoomsConnected(_0x23cc76,_0x2bb1e1,_0x497e47){const _0x28c1f=a2_0x3ceacc;try{const _0x3915c6=await _0x23cc76[_0x28c1f(0x1ed)](_0x28c1f(0x1f3));if(!_0x3915c6||!_0x3915c6[_0x28c1f(0x20c)])return!![];const _0xcea745=JSON[_0x28c1f(0x1e6)](_0x3915c6['val']),{rooms:_0x2676fa,matrix:_0x2f3fdd}=_0xcea745;if(!_0x2676fa||!_0x2f3fdd)return!![];const _0x27419c=_0x2676fa['indexOf'](_0x2bb1e1),_0x2a5383=_0x2676fa[_0x28c1f(0x1ff)](_0x497e47);if(_0x27419c===-0x1||_0x2a5383===-0x1)return!![];const _0x2cc4aa=_0x2f3fdd[_0x27419c][_0x2a5383]>0x0||_0x2f3fdd[_0x2a5383][_0x27419c]>0x0;return _0x2cc4aa;}catch(_0x23c874){return _0x23cc76[_0x28c1f(0x211)][_0x28c1f(0x206)](_0x28c1f(0x1f0)+_0x23c874[_0x28c1f(0x1e5)]),!![];}}async function updateLocation(_0x4fd9d7,_0x28e2af){const _0x59bd14=a2_0x3ceacc;if(!_0x28e2af||_0x28e2af===_0x59bd14(0x209))return;if(!await isActive(_0x4fd9d7)){resetTimer(_0x4fd9d7);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x28e2af){const _0xa4ff61=await areRoomsConnected(_0x4fd9d7,currentMonitoredRoom,_0x28e2af);if(!_0xa4ff61){_0x4fd9d7['log']['info']('[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27'+_0x28e2af+_0x59bd14(0x1f5)+currentMonitoredRoom+_0x59bd14(0x1f2));return;}resetTimer(_0x4fd9d7);}if(!currentMonitoredRoom){await _0x4fd9d7[_0x59bd14(0x213)](_0x59bd14(0x1fe),{'val':_0x28e2af,'ack':!![]});const _0x51c2c8=await loadConfig(_0x4fd9d7),_0x42ee58=_0x28e2af[_0x59bd14(0x1f4)]();let _0x482447=_0x51c2c8[_0x28e2af]||_0x51c2c8[_0x42ee58];if(!_0x482447)for(const _0x1bd718 in DEFAULT_TIMEOUTS){if(_0x42ee58[_0x59bd14(0x1f8)](_0x1bd718)){_0x482447=DEFAULT_TIMEOUTS[_0x1bd718];break;}}if(!_0x482447&&_0x51c2c8[_0x59bd14(0x205)])_0x482447=_0x51c2c8[_0x59bd14(0x205)];if(!_0x482447)return;currentMonitoredRoom=_0x28e2af,startTimer(_0x4fd9d7,_0x482447);}}function startTimer(_0x48674b,_0x2a151e){const _0x514bcd=a2_0x3ceacc;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x2a151e*0x3c*0x3e8,startTime=Date[_0x514bcd(0x203)](),alarmStage=0x0,_0x48674b[_0x514bcd(0x211)][_0x514bcd(0x1e9)](_0x514bcd(0x1fc)+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0x2a151e+_0x514bcd(0x1ee)),_0x48674b[_0x514bcd(0x213)](_0x514bcd(0x1f9),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x48674b),timeoutMs);}function resetTimer(_0xc7b8c4){const _0x58617e=a2_0x3ceacc;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0xc7b8c4[_0x58617e(0x213)](_0x58617e(0x1f9),{'val':'ok','ack':!![]});}function a2_0xb123(_0xc1f201,_0x94a87d){const _0xa06c7e=a2_0x4dd9();return a2_0xb123=function(_0x4355e7,_0x50dc97){_0x4355e7=_0x4355e7-0x1e4;let _0x4dd905=_0xa06c7e[_0x4355e7];return _0x4dd905;},a2_0xb123(_0xc1f201,_0x94a87d);}async function triggerPreWarn(_0x59e0d5){const _0x8492b5=a2_0x3ceacc;alarmStage=0x1,await _0x59e0d5[_0x8492b5(0x213)](_0x8492b5(0x1f9),{'val':'pre_warn','ack':!![]});const _0x35f945=_0x8492b5(0x20d)+currentMonitoredRoom+_0x8492b5(0x1fb);_0x59e0d5[_0x8492b5(0x211)]['warn'](_0x8492b5(0x20f)+_0x35f945),await setup[_0x8492b5(0x214)](_0x59e0d5,_0x8492b5(0x20e)+_0x35f945),activeTimer=setTimeout(()=>triggerAlarm(_0x59e0d5),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x4aca9e){const _0x2764e2=a2_0x3ceacc;alarmStage=0x2,await _0x4aca9e['setStateAsync'](_0x2764e2(0x1f9),{'val':_0x2764e2(0x20a),'ack':!![]});const _0x509957=_0x2764e2(0x1fd)+currentMonitoredRoom+'!';_0x4aca9e[_0x2764e2(0x211)]['error'](_0x2764e2(0x20f)+_0x509957),await setup[_0x2764e2(0x214)](_0x4aca9e,_0x509957,![],!![]);}module[a2_0x3ceacc(0x207)]={'updateLocation':updateLocation};