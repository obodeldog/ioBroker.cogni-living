const a2_0x2674b9=a2_0x4e48;(function(_0x48c75b,_0x52d7ed){const _0x47f614=a2_0x4e48,_0xac4b52=_0x48c75b();while(!![]){try{const _0x34582d=parseInt(_0x47f614(0x18d))/0x1*(parseInt(_0x47f614(0x192))/0x2)+-parseInt(_0x47f614(0x190))/0x3*(parseInt(_0x47f614(0x185))/0x4)+parseInt(_0x47f614(0x168))/0x5*(parseInt(_0x47f614(0x191))/0x6)+-parseInt(_0x47f614(0x172))/0x7*(-parseInt(_0x47f614(0x16d))/0x8)+parseInt(_0x47f614(0x17e))/0x9*(parseInt(_0x47f614(0x177))/0xa)+parseInt(_0x47f614(0x179))/0xb+-parseInt(_0x47f614(0x180))/0xc;if(_0x34582d===_0x52d7ed)break;else _0xac4b52['push'](_0xac4b52['shift']());}catch(_0x34c7a1){_0xac4b52['push'](_0xac4b52['shift']());}}}(a2_0x4ed6,0x561f1));const a2_0x2eb80d=(function(){let _0xb531b1=!![];return function(_0x20aeb7,_0x3d2d6e){const _0x134d88=_0xb531b1?function(){const _0x93ad44=a2_0x4e48;if(_0x3d2d6e){const _0x7998f0=_0x3d2d6e[_0x93ad44(0x176)](_0x20aeb7,arguments);return _0x3d2d6e=null,_0x7998f0;}}:function(){};return _0xb531b1=![],_0x134d88;};}()),a2_0x2327d9=a2_0x2eb80d(this,function(){const _0x22ae82=a2_0x4e48;return a2_0x2327d9[_0x22ae82(0x181)]()[_0x22ae82(0x16e)](_0x22ae82(0x183))[_0x22ae82(0x181)]()[_0x22ae82(0x186)](a2_0x2327d9)[_0x22ae82(0x16e)](_0x22ae82(0x183));});function a2_0x4ed6(){const _0x1d07bc=['.\x20Alles\x20in\x20Ordnung?','471090gFTvbl','analysis.safety.deadMan.alarmState','indexOf','analysis.topology.structure','ðŸ‘¼\x20Schutzengel-Frage:\x20','2696qTUFRh','search','error','sendNotification','exports','4144HQSBhm','message','analysis.safety.deadMan.active','parse','apply','1461890hAkPzQ','setStateAsync','2096710LodlYW','analysis.safety.deadMan.config','[DeadMan]\x20Topology\x20check\x20failed:\x20','pre_warn','log','18FhvCHc','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','2152572pyHHKo','toString','Unknown','(((.+)+)+)+$','default','3764dVeJYT','constructor','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','getStateAsync','\x27.\x20(Multi-Person\x20Filter)','\x20Min.','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','includes','8317qRKFNY','[DeadMan]\x20','val','1407gieDGs','18UXYdhs','2rqhsgS','\x20fÃ¼r\x20','info','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'];a2_0x4ed6=function(){return _0x1d07bc;};return a2_0x4ed6();}a2_0x2327d9();'use strict';const setup=require('./setup');let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x165934){const _0x4b2443=a2_0x4e48;try{const _0x2b0657=await _0x165934[_0x4b2443(0x188)](_0x4b2443(0x17a));if(_0x2b0657&&_0x2b0657[_0x4b2443(0x18f)])return JSON[_0x4b2443(0x175)](_0x2b0657[_0x4b2443(0x18f)]);}catch(_0x465071){}return{};}async function isActive(_0xa3d3a3){const _0x437174=a2_0x4e48;try{const _0xc35c68=await _0xa3d3a3[_0x437174(0x188)](_0x437174(0x174));return _0xc35c68&&_0xc35c68['val'];}catch(_0x3a6d0b){return![];}}function a2_0x4e48(_0x54cfe2,_0x51c2d4){const _0x3223af=a2_0x4ed6();return a2_0x4e48=function(_0x2327d9,_0x2eb80d){_0x2327d9=_0x2327d9-0x164;let _0x4ed6cf=_0x3223af[_0x2327d9];return _0x4ed6cf;},a2_0x4e48(_0x54cfe2,_0x51c2d4);}async function areRoomsConnected(_0x6c5c9a,_0x195856,_0x5e45ef){const _0x1a10d9=a2_0x4e48;try{const _0xfba6b0=await _0x6c5c9a[_0x1a10d9(0x188)](_0x1a10d9(0x16b));if(!_0xfba6b0||!_0xfba6b0[_0x1a10d9(0x18f)])return!![];const _0x36dea1=JSON[_0x1a10d9(0x175)](_0xfba6b0[_0x1a10d9(0x18f)]),{rooms:_0x1a8f56,matrix:_0x42e5ad}=_0x36dea1;if(!_0x1a8f56||!_0x42e5ad)return!![];const _0x2e8f73=_0x1a8f56['indexOf'](_0x195856),_0x462d29=_0x1a8f56[_0x1a10d9(0x16a)](_0x5e45ef);if(_0x2e8f73===-0x1||_0x462d29===-0x1)return!![];const _0x34a545=_0x42e5ad[_0x2e8f73][_0x462d29]>0x0||_0x42e5ad[_0x462d29][_0x2e8f73]>0x0;return _0x34a545;}catch(_0x9e77f6){return _0x6c5c9a[_0x1a10d9(0x17d)]['warn'](_0x1a10d9(0x17b)+_0x9e77f6[_0x1a10d9(0x173)]),!![];}}async function updateLocation(_0x8350d,_0x221a87){const _0x35a801=a2_0x4e48;if(!_0x221a87||_0x221a87===_0x35a801(0x182))return;if(!await isActive(_0x8350d)){resetTimer(_0x8350d);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x221a87){const _0x294896=await areRoomsConnected(_0x8350d,currentMonitoredRoom,_0x221a87);if(!_0x294896){_0x8350d[_0x35a801(0x17d)][_0x35a801(0x165)](_0x35a801(0x17f)+_0x221a87+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+_0x35a801(0x189));return;}resetTimer(_0x8350d);}if(!currentMonitoredRoom){await _0x8350d[_0x35a801(0x178)]('analysis.safety.deadMan.currentRoom',{'val':_0x221a87,'ack':!![]});const _0x40d5af=await loadConfig(_0x8350d),_0x4831e2=_0x221a87['toLowerCase']();let _0x332646=_0x40d5af[_0x221a87]||_0x40d5af[_0x4831e2];if(!_0x332646)for(const _0x1a4e01 in DEFAULT_TIMEOUTS){if(_0x4831e2[_0x35a801(0x18c)](_0x1a4e01)){_0x332646=DEFAULT_TIMEOUTS[_0x1a4e01];break;}}if(!_0x332646&&_0x40d5af['default'])_0x332646=_0x40d5af[_0x35a801(0x184)];if(!_0x332646)return;currentMonitoredRoom=_0x221a87,startTimer(_0x8350d,_0x332646);}}function startTimer(_0x8428a,_0x3465f8){const _0xb07049=a2_0x4e48;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3465f8*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0,_0x8428a[_0xb07049(0x17d)][_0xb07049(0x165)](_0xb07049(0x18b)+currentMonitoredRoom+_0xb07049(0x164)+_0x3465f8+_0xb07049(0x18a)),_0x8428a['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x8428a),timeoutMs);}function resetTimer(_0x1c075f){const _0x3d5485=a2_0x4e48;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x1c075f[_0x3d5485(0x178)](_0x3d5485(0x169),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x180338){const _0x50c8b5=a2_0x4e48;alarmStage=0x1,await _0x180338[_0x50c8b5(0x178)]('analysis.safety.deadMan.alarmState',{'val':_0x50c8b5(0x17c),'ack':!![]});const _0x38605b=_0x50c8b5(0x166)+currentMonitoredRoom+_0x50c8b5(0x167);_0x180338[_0x50c8b5(0x17d)]['warn'](_0x50c8b5(0x18e)+_0x38605b),await setup['sendNotification'](_0x180338,_0x50c8b5(0x16c)+_0x38605b),activeTimer=setTimeout(()=>triggerAlarm(_0x180338),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x12be43){const _0x4d7626=a2_0x4e48;alarmStage=0x2,await _0x12be43[_0x4d7626(0x178)](_0x4d7626(0x169),{'val':'alarm','ack':!![]});const _0xa5f044=_0x4d7626(0x187)+currentMonitoredRoom+'!';_0x12be43[_0x4d7626(0x17d)][_0x4d7626(0x16f)](_0x4d7626(0x18e)+_0xa5f044),await setup[_0x4d7626(0x170)](_0x12be43,_0xa5f044,![],!![]);}module[a2_0x2674b9(0x171)]={'updateLocation':updateLocation};