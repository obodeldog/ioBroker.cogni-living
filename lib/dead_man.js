const a2_0x27cffe=a2_0x28af;(function(_0x26257c,_0x587c75){const _0x419615=a2_0x28af,_0x5011be=_0x26257c();while(!![]){try{const _0xbc0e5b=-parseInt(_0x419615(0x1d3))/0x1+parseInt(_0x419615(0x1d6))/0x2+-parseInt(_0x419615(0x1f5))/0x3+-parseInt(_0x419615(0x1d7))/0x4+-parseInt(_0x419615(0x1fb))/0x5*(-parseInt(_0x419615(0x1f9))/0x6)+parseInt(_0x419615(0x1d4))/0x7+parseInt(_0x419615(0x1f3))/0x8*(parseInt(_0x419615(0x1ec))/0x9);if(_0xbc0e5b===_0x587c75)break;else _0x5011be['push'](_0x5011be['shift']());}catch(_0x4a2732){_0x5011be['push'](_0x5011be['shift']());}}}(a2_0x1113,0x70ab4));function a2_0x28af(_0x51b65d,_0x240d8f){const _0x154fa1=a2_0x1113();return a2_0x28af=function(_0x220cb1,_0x3e1033){_0x220cb1=_0x220cb1-0x1d3;let _0x1113d7=_0x154fa1[_0x220cb1];return _0x1113d7;},a2_0x28af(_0x51b65d,_0x240d8f);}const a2_0x3e1033=(function(){let _0x104df0=!![];return function(_0x522943,_0x2153a7){const _0x3cb174=_0x104df0?function(){const _0x552561=a2_0x28af;if(_0x2153a7){const _0x3cc68c=_0x2153a7[_0x552561(0x1e0)](_0x522943,arguments);return _0x2153a7=null,_0x3cc68c;}}:function(){};return _0x104df0=![],_0x3cb174;};}()),a2_0x220cb1=a2_0x3e1033(this,function(){const _0x3b09b1=a2_0x28af;return a2_0x220cb1[_0x3b09b1(0x1ea)]()[_0x3b09b1(0x1f6)](_0x3b09b1(0x1dd))[_0x3b09b1(0x1ea)]()[_0x3b09b1(0x1fc)](a2_0x220cb1)[_0x3b09b1(0x1f6)](_0x3b09b1(0x1dd));});a2_0x220cb1();'use strict';const setup=require(a2_0x27cffe(0x1db));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x57a4a7){const _0x1416cf=a2_0x27cffe;try{const _0x5c0550=await _0x57a4a7[_0x1416cf(0x1e8)](_0x1416cf(0x1f8));if(_0x5c0550&&_0x5c0550[_0x1416cf(0x1f1)])return JSON[_0x1416cf(0x1ee)](_0x5c0550[_0x1416cf(0x1f1)]);}catch(_0x4087b8){}return{};}async function isActive(_0x302ca5){const _0x4430f1=a2_0x27cffe;try{const _0x36aa54=await _0x302ca5[_0x4430f1(0x1e8)](_0x4430f1(0x1fa));return _0x36aa54&&_0x36aa54['val'];}catch(_0x37ae45){return![];}}async function areRoomsConnected(_0x30104b,_0x50462a,_0x26ffb3){const _0x225231=a2_0x27cffe;try{const _0x44cb6b=await _0x30104b[_0x225231(0x1e8)](_0x225231(0x1df));if(!_0x44cb6b||!_0x44cb6b[_0x225231(0x1f1)])return!![];const _0x41c6d3=JSON[_0x225231(0x1ee)](_0x44cb6b[_0x225231(0x1f1)]),{rooms:_0x5748cf,matrix:_0x2e17d9}=_0x41c6d3;if(!_0x5748cf||!_0x2e17d9)return!![];const _0x4d24aa=_0x5748cf[_0x225231(0x1e4)](_0x50462a),_0x426baf=_0x5748cf[_0x225231(0x1e4)](_0x26ffb3);if(_0x4d24aa===-0x1||_0x426baf===-0x1)return!![];const _0x10d9bf=_0x2e17d9[_0x4d24aa][_0x426baf]>0x0||_0x2e17d9[_0x426baf][_0x4d24aa]>0x0;return _0x10d9bf;}catch(_0x5028a6){return _0x30104b[_0x225231(0x1de)][_0x225231(0x1e5)](_0x225231(0x1f2)+_0x5028a6['message']),!![];}}function a2_0x1113(){const _0x4f50d4=['default','789453gCaadS','search','\x20fÃ¼r\x20','analysis.safety.deadMan.config','147966BTWKUN','analysis.safety.deadMan.active','15rqGAXc','constructor','analysis.safety.deadMan.alarmState','setStateAsync','.\x20Alles\x20in\x20Ordnung?','810000mSvAdS','4075218rHwQpm','stringify','1106680JVYwJK','3372828KgmTxW','ðŸ‘¼\x20Schutzengel-Frage:\x20','\x20(Multi-Person\x20Filter)','alarm','./setup','pre_warn','(((.+)+)+)+$','log','analysis.topology.structure','apply','now','\x20Min.','sendNotification','indexOf','warn','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','[DeadMan]\x20','getStateAsync','toLowerCase','toString','Unknown','9eLLMLJ','info','parse','Ignoriere\x20Bewegung\x20in\x20\x27','analysis.safety.deadMan.lastIgnored','val','[DeadMan]\x20Topology\x20check\x20failed:\x20','9346824JHHcEV'];a2_0x1113=function(){return _0x4f50d4;};return a2_0x1113();}async function updateLocation(_0x2322dd,_0x515de7){const _0x393432=a2_0x27cffe;if(!_0x515de7||_0x515de7===_0x393432(0x1eb))return;if(!await isActive(_0x2322dd)){resetTimer(_0x2322dd);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x515de7){const _0xd65535=await areRoomsConnected(_0x2322dd,currentMonitoredRoom,_0x515de7);if(!_0xd65535){const _0x255a28=_0x393432(0x1ef)+_0x515de7+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0x2322dd['log'][_0x393432(0x1ed)](_0x393432(0x1e7)+_0x255a28+_0x393432(0x1d9)),await _0x2322dd[_0x393432(0x1fe)](_0x393432(0x1f0),{'val':JSON[_0x393432(0x1d5)]({'room':_0x515de7,'reason':_0x255a28,'timestamp':Date[_0x393432(0x1e1)]()}),'ack':!![]});return;}resetTimer(_0x2322dd);}if(!currentMonitoredRoom){await _0x2322dd[_0x393432(0x1fe)]('analysis.safety.deadMan.currentRoom',{'val':_0x515de7,'ack':!![]});const _0x674b9=await loadConfig(_0x2322dd),_0x557f89=_0x515de7[_0x393432(0x1e9)]();let _0x16beba=_0x674b9[_0x515de7]||_0x674b9[_0x557f89];if(!_0x16beba)for(const _0x1088be in DEFAULT_TIMEOUTS){if(_0x557f89['includes'](_0x1088be)){_0x16beba=DEFAULT_TIMEOUTS[_0x1088be];break;}}if(!_0x16beba&&_0x674b9[_0x393432(0x1f4)])_0x16beba=_0x674b9[_0x393432(0x1f4)];if(!_0x16beba)return;currentMonitoredRoom=_0x515de7,startTimer(_0x2322dd,_0x16beba);}}function startTimer(_0x36d6a9,_0x5531f6){const _0x2e4773=a2_0x27cffe;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x5531f6*0x3c*0x3e8,startTime=Date[_0x2e4773(0x1e1)](),alarmStage=0x0,_0x36d6a9[_0x2e4773(0x1de)][_0x2e4773(0x1ed)](_0x2e4773(0x1e6)+currentMonitoredRoom+_0x2e4773(0x1f7)+_0x5531f6+_0x2e4773(0x1e2)),_0x36d6a9[_0x2e4773(0x1fe)](_0x2e4773(0x1fd),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x36d6a9),timeoutMs);}function resetTimer(_0x4942b5){const _0xbc1c28=a2_0x27cffe;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x4942b5[_0xbc1c28(0x1fe)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x4c92aa){const _0x4f1570=a2_0x27cffe;alarmStage=0x1,await _0x4c92aa[_0x4f1570(0x1fe)](_0x4f1570(0x1fd),{'val':_0x4f1570(0x1dc),'ack':!![]});const _0x391c12='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x4f1570(0x1ff);_0x4c92aa[_0x4f1570(0x1de)][_0x4f1570(0x1e5)](_0x4f1570(0x1e7)+_0x391c12),await setup[_0x4f1570(0x1e3)](_0x4c92aa,_0x4f1570(0x1d8)+_0x391c12),activeTimer=setTimeout(()=>triggerAlarm(_0x4c92aa),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x8b4b18){const _0xdd4d2c=a2_0x27cffe;alarmStage=0x2,await _0x8b4b18['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':_0xdd4d2c(0x1da),'ack':!![]});const _0x4e4fae='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x8b4b18[_0xdd4d2c(0x1de)]['error']('[DeadMan]\x20'+_0x4e4fae),await setup[_0xdd4d2c(0x1e3)](_0x8b4b18,_0x4e4fae,![],!![]);}module['exports']={'updateLocation':updateLocation};