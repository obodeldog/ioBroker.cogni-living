const a2_0x397141=a2_0xefc9;(function(_0x151033,_0x21e837){const _0x17ca67=a2_0xefc9,_0x53a7e3=_0x151033();while(!![]){try{const _0x2d4d89=parseInt(_0x17ca67(0xa8))/0x1*(-parseInt(_0x17ca67(0x87))/0x2)+-parseInt(_0x17ca67(0xae))/0x3*(-parseInt(_0x17ca67(0xb0))/0x4)+parseInt(_0x17ca67(0xa9))/0x5+-parseInt(_0x17ca67(0x8d))/0x6+-parseInt(_0x17ca67(0xa3))/0x7*(parseInt(_0x17ca67(0x88))/0x8)+-parseInt(_0x17ca67(0xa6))/0x9*(-parseInt(_0x17ca67(0x9d))/0xa)+parseInt(_0x17ca67(0x9e))/0xb;if(_0x2d4d89===_0x21e837)break;else _0x53a7e3['push'](_0x53a7e3['shift']());}catch(_0x234e8c){_0x53a7e3['push'](_0x53a7e3['shift']());}}}(a2_0x342c,0x30357));const a2_0x1c0f95=(function(){let _0x3fcc2d=!![];return function(_0x1eb2f7,_0x555054){const _0x32536a=_0x3fcc2d?function(){const _0x1e3a0c=a2_0xefc9;if(_0x555054){const _0x41b24f=_0x555054[_0x1e3a0c(0xb1)](_0x1eb2f7,arguments);return _0x555054=null,_0x41b24f;}}:function(){};return _0x3fcc2d=![],_0x32536a;};}()),a2_0x48a2b9=a2_0x1c0f95(this,function(){const _0x34199d=a2_0xefc9;return a2_0x48a2b9[_0x34199d(0x98)]()[_0x34199d(0xad)](_0x34199d(0x9a))['toString']()['constructor'](a2_0x48a2b9)[_0x34199d(0xad)](_0x34199d(0x9a));});a2_0x48a2b9();'use strict';function a2_0x342c(){const _0x353344=['\x27.\x20(Multi-Person\x20Filter)','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','[DeadMan]\x20Topology\x20check\x20failed:\x20','482292jPMPHB','alarm','pre_warn','log','now','analysis.topology.structure','val','error','info','getStateAsync','sendNotification','toString','\x20Min.','(((.+)+)+)+$','\x20fÃ¼r\x20','setStateAsync','385720PLIkfY','651849OsvxNk','toLowerCase','./setup','exports','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','769636mrVShn','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','[DeadMan]\x20','9NwKqjx','analysis.safety.deadMan.currentRoom','8lnXdBx','1410765BsxCXH','analysis.safety.deadMan.alarmState','analysis.safety.deadMan.active','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','search','955659jiiuLA','default','4tdiKIu','apply','indexOf','includes','parse','77686OVfAEm','8UaUeou'];a2_0x342c=function(){return _0x353344;};return a2_0x342c();}const setup=require(a2_0x397141(0xa0));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x43c8e4){const _0x33e685=a2_0x397141;try{const _0x77a099=await _0x43c8e4[_0x33e685(0x96)]('analysis.safety.deadMan.config');if(_0x77a099&&_0x77a099[_0x33e685(0x93)])return JSON[_0x33e685(0x86)](_0x77a099[_0x33e685(0x93)]);}catch(_0x5187cb){}return{};}function a2_0xefc9(_0x429d7e,_0x36c932){const _0x116b04=a2_0x342c();return a2_0xefc9=function(_0x48a2b9,_0x1c0f95){_0x48a2b9=_0x48a2b9-0x86;let _0x342cc8=_0x116b04[_0x48a2b9];return _0x342cc8;},a2_0xefc9(_0x429d7e,_0x36c932);}async function isActive(_0x49887f){const _0x54dab6=a2_0x397141;try{const _0xae1949=await _0x49887f[_0x54dab6(0x96)](_0x54dab6(0xab));return _0xae1949&&_0xae1949['val'];}catch(_0x3b2fe3){return![];}}async function areRoomsConnected(_0x526ea1,_0x45a1ba,_0x3bf208){const _0x25e5db=a2_0x397141;try{const _0x10aa3e=await _0x526ea1[_0x25e5db(0x96)](_0x25e5db(0x92));if(!_0x10aa3e||!_0x10aa3e[_0x25e5db(0x93)])return!![];const _0x136fc9=JSON[_0x25e5db(0x86)](_0x10aa3e[_0x25e5db(0x93)]),{rooms:_0x55721,matrix:_0x486a24}=_0x136fc9;if(!_0x55721||!_0x486a24)return!![];const _0x399df4=_0x55721[_0x25e5db(0xb2)](_0x45a1ba),_0x56ab57=_0x55721['indexOf'](_0x3bf208);if(_0x399df4===-0x1||_0x56ab57===-0x1)return!![];const _0xdbd625=_0x486a24[_0x399df4][_0x56ab57]>0x0||_0x486a24[_0x56ab57][_0x399df4]>0x0;return _0xdbd625;}catch(_0xb6aeb8){return _0x526ea1[_0x25e5db(0x90)]['warn'](_0x25e5db(0x8c)+_0xb6aeb8['message']),!![];}}async function updateLocation(_0x1fecd2,_0x27ee61){const _0x589038=a2_0x397141;if(!_0x27ee61||_0x27ee61==='Unknown')return;if(!await isActive(_0x1fecd2)){resetTimer(_0x1fecd2);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x27ee61){const _0x3585e6=await areRoomsConnected(_0x1fecd2,currentMonitoredRoom,_0x27ee61);if(!_0x3585e6){_0x1fecd2[_0x589038(0x90)][_0x589038(0x95)](_0x589038(0x8a)+_0x27ee61+_0x589038(0xac)+currentMonitoredRoom+_0x589038(0x89));return;}resetTimer(_0x1fecd2);}if(!currentMonitoredRoom){await _0x1fecd2['setStateAsync'](_0x589038(0xa7),{'val':_0x27ee61,'ack':!![]});const _0xcd3281=await loadConfig(_0x1fecd2),_0x2ab2be=_0x27ee61[_0x589038(0x9f)]();let _0x27728f=_0xcd3281[_0x27ee61]||_0xcd3281[_0x2ab2be];if(!_0x27728f)for(const _0x4d0464 in DEFAULT_TIMEOUTS){if(_0x2ab2be[_0x589038(0xb3)](_0x4d0464)){_0x27728f=DEFAULT_TIMEOUTS[_0x4d0464];break;}}if(!_0x27728f&&_0xcd3281[_0x589038(0xaf)])_0x27728f=_0xcd3281[_0x589038(0xaf)];if(!_0x27728f)return;currentMonitoredRoom=_0x27ee61,startTimer(_0x1fecd2,_0x27728f);}}function startTimer(_0x32ac2c,_0x59837b){const _0x3bfc36=a2_0x397141;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x59837b*0x3c*0x3e8,startTime=Date[_0x3bfc36(0x91)](),alarmStage=0x0,_0x32ac2c['log']['info'](_0x3bfc36(0xa4)+currentMonitoredRoom+_0x3bfc36(0x9b)+_0x59837b+_0x3bfc36(0x99)),_0x32ac2c[_0x3bfc36(0x9c)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x32ac2c),timeoutMs);}function resetTimer(_0x2675ca){const _0x4d1973=a2_0x397141;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x2675ca['setStateAsync'](_0x4d1973(0xaa),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x156cf3){const _0x2b8ab9=a2_0x397141;alarmStage=0x1,await _0x156cf3[_0x2b8ab9(0x9c)](_0x2b8ab9(0xaa),{'val':_0x2b8ab9(0x8f),'ack':!![]});const _0x4457f9=_0x2b8ab9(0xa2)+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x156cf3[_0x2b8ab9(0x90)]['warn'](_0x2b8ab9(0xa5)+_0x4457f9),await setup[_0x2b8ab9(0x97)](_0x156cf3,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x4457f9),activeTimer=setTimeout(()=>triggerAlarm(_0x156cf3),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x2f68e2){const _0x1c774a=a2_0x397141;alarmStage=0x2,await _0x2f68e2[_0x1c774a(0x9c)](_0x1c774a(0xaa),{'val':_0x1c774a(0x8e),'ack':!![]});const _0xd6f54b=_0x1c774a(0x8b)+currentMonitoredRoom+'!';_0x2f68e2[_0x1c774a(0x90)][_0x1c774a(0x94)](_0x1c774a(0xa5)+_0xd6f54b),await setup[_0x1c774a(0x97)](_0x2f68e2,_0xd6f54b,![],!![]);}module[a2_0x397141(0xa1)]={'updateLocation':updateLocation};