const a2_0x70afef=a2_0x2a00;(function(_0x2bc6e3,_0xd295a){const _0x57a640=a2_0x2a00,_0x51c267=_0x2bc6e3();while(!![]){try{const _0x681cd6=parseInt(_0x57a640(0x1d8))/0x1*(-parseInt(_0x57a640(0x1e5))/0x2)+parseInt(_0x57a640(0x1f7))/0x3*(-parseInt(_0x57a640(0x204))/0x4)+parseInt(_0x57a640(0x201))/0x5+-parseInt(_0x57a640(0x1ee))/0x6*(parseInt(_0x57a640(0x1f4))/0x7)+parseInt(_0x57a640(0x1fd))/0x8*(parseInt(_0x57a640(0x1e8))/0x9)+parseInt(_0x57a640(0x1f8))/0xa*(parseInt(_0x57a640(0x1f2))/0xb)+parseInt(_0x57a640(0x202))/0xc*(parseInt(_0x57a640(0x1dc))/0xd);if(_0x681cd6===_0xd295a)break;else _0x51c267['push'](_0x51c267['shift']());}catch(_0x443018){_0x51c267['push'](_0x51c267['shift']());}}}(a2_0x4f16,0xa7d21));const a2_0x3e3ee3=(function(){let _0x143f81=!![];return function(_0x21c177,_0x2b853d){const _0x3dce88=_0x143f81?function(){const _0x391d17=a2_0x2a00;if(_0x2b853d){const _0x46cf96=_0x2b853d[_0x391d17(0x1e3)](_0x21c177,arguments);return _0x2b853d=null,_0x46cf96;}}:function(){};return _0x143f81=![],_0x3dce88;};}()),a2_0x1c3638=a2_0x3e3ee3(this,function(){const _0x37a46c=a2_0x2a00;return a2_0x1c3638[_0x37a46c(0x1fe)]()[_0x37a46c(0x1da)](_0x37a46c(0x1dd))[_0x37a46c(0x1fe)]()[_0x37a46c(0x1e2)](a2_0x1c3638)[_0x37a46c(0x1da)](_0x37a46c(0x1dd));});a2_0x1c3638();function a2_0x2a00(_0x56ddb1,_0xa6ff59){const _0x34e4a3=a2_0x4f16();return a2_0x2a00=function(_0x1c3638,_0x3e3ee3){_0x1c3638=_0x1c3638-0x1d5;let _0x4f16e5=_0x34e4a3[_0x1c3638];return _0x4f16e5;},a2_0x2a00(_0x56ddb1,_0xa6ff59);}'use strict';const setup=require(a2_0x70afef(0x1ec));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0xdc2b0b){const _0x4b64b7=a2_0x70afef;try{const _0x50fa41=await _0xdc2b0b[_0x4b64b7(0x1e7)]('analysis.safety.deadMan.config');if(_0x50fa41&&_0x50fa41[_0x4b64b7(0x200)])return JSON[_0x4b64b7(0x1f6)](_0x50fa41[_0x4b64b7(0x200)]);}catch(_0xcee7c2){}return{};}async function isActive(_0x243c03){const _0x3b4e56=a2_0x70afef;try{const _0x3aa4e4=await _0x243c03[_0x3b4e56(0x1e7)](_0x3b4e56(0x1f1));return _0x3aa4e4&&_0x3aa4e4[_0x3b4e56(0x200)];}catch(_0x2fb5af){return![];}}async function areRoomsConnected(_0x28fb36,_0x2640f5,_0x413d9d){const _0xa6044b=a2_0x70afef;try{const _0x2812cc=await _0x28fb36[_0xa6044b(0x1e7)](_0xa6044b(0x1e6));if(!_0x2812cc||!_0x2812cc['val'])return!![];const _0x356514=JSON[_0xa6044b(0x1f6)](_0x2812cc[_0xa6044b(0x200)]),{rooms:_0x1e6e1f,matrix:_0x2bf51a}=_0x356514;if(!_0x1e6e1f||!_0x2bf51a)return!![];const _0x40137e=_0x1e6e1f[_0xa6044b(0x1e1)](_0x2640f5),_0x5b6948=_0x1e6e1f[_0xa6044b(0x1e1)](_0x413d9d);if(_0x40137e===-0x1||_0x5b6948===-0x1)return!![];const _0x116393=_0x2bf51a[_0x40137e][_0x5b6948]>0x0||_0x2bf51a[_0x5b6948][_0x40137e]>0x0;return _0x116393;}catch(_0xd12bc){return _0x28fb36[_0xa6044b(0x1f5)]['warn']('[DeadMan]\x20Topology\x20check\x20failed:\x20'+_0xd12bc[_0xa6044b(0x1ef)]),!![];}}async function updateLocation(_0x420f27,_0xa62ed8){const _0x4b4abd=a2_0x70afef;if(!_0xa62ed8||_0xa62ed8===_0x4b4abd(0x1ed))return;if(!await isActive(_0x420f27)){resetTimer(_0x420f27);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0xa62ed8){const _0x27b2fb=await areRoomsConnected(_0x420f27,currentMonitoredRoom,_0xa62ed8);if(!_0x27b2fb){_0x420f27[_0x4b4abd(0x1f5)][_0x4b4abd(0x1fb)](_0x4b4abd(0x1fa)+_0xa62ed8+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+_0x4b4abd(0x1e9));return;}resetTimer(_0x420f27);}if(!currentMonitoredRoom){await _0x420f27[_0x4b4abd(0x1d6)](_0x4b4abd(0x1ea),{'val':_0xa62ed8,'ack':!![]});const _0x1a8321=await loadConfig(_0x420f27),_0x9bd1c4=_0xa62ed8[_0x4b4abd(0x1f0)]();let _0x7be773=_0x1a8321[_0xa62ed8]||_0x1a8321[_0x9bd1c4];if(!_0x7be773)for(const _0x91d26d in DEFAULT_TIMEOUTS){if(_0x9bd1c4[_0x4b4abd(0x1e4)](_0x91d26d)){_0x7be773=DEFAULT_TIMEOUTS[_0x91d26d];break;}}if(!_0x7be773&&_0x1a8321['default'])_0x7be773=_0x1a8321[_0x4b4abd(0x1d9)];if(!_0x7be773)return;currentMonitoredRoom=_0xa62ed8,startTimer(_0x420f27,_0x7be773);}}function startTimer(_0x45ea9a,_0x3e4226){const _0x24cddf=a2_0x70afef;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3e4226*0x3c*0x3e8,startTime=Date[_0x24cddf(0x1de)](),alarmStage=0x0,_0x45ea9a[_0x24cddf(0x1f5)]['info'](_0x24cddf(0x1e0)+currentMonitoredRoom+_0x24cddf(0x1f3)+_0x3e4226+_0x24cddf(0x1f9)),_0x45ea9a[_0x24cddf(0x1d6)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x45ea9a),timeoutMs);}function resetTimer(_0x291449){const _0x792245=a2_0x70afef;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x291449[_0x792245(0x1d6)](_0x792245(0x1d7),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x3406a5){const _0x318ff5=a2_0x70afef;alarmStage=0x1,await _0x3406a5['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'pre_warn','ack':!![]});const _0x3960c6='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x318ff5(0x1ff);_0x3406a5['log']['warn'](_0x318ff5(0x1eb)+_0x3960c6),await setup[_0x318ff5(0x1df)](_0x3406a5,_0x318ff5(0x1db)+_0x3960c6),activeTimer=setTimeout(()=>triggerAlarm(_0x3406a5),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x2e7acb){const _0x38aa84=a2_0x70afef;alarmStage=0x2,await _0x2e7acb[_0x38aa84(0x1d6)]('analysis.safety.deadMan.alarmState',{'val':_0x38aa84(0x203),'ack':!![]});const _0x2b374a=_0x38aa84(0x1fc)+currentMonitoredRoom+'!';_0x2e7acb[_0x38aa84(0x1f5)][_0x38aa84(0x1d5)](_0x38aa84(0x1eb)+_0x2b374a),await setup[_0x38aa84(0x1df)](_0x2e7acb,_0x2b374a,![],!![]);}function a2_0x4f16(){const _0x366c0e=['val','4081385BhtAin','12ONqOFN','alarm','24UWDupG','error','setStateAsync','analysis.safety.deadMan.alarmState','145537wxzMfY','default','search','ðŸ‘¼\x20Schutzengel-Frage:\x20','5039671rVGPDd','(((.+)+)+)+$','now','sendNotification','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','indexOf','constructor','apply','includes','6vTNNas','analysis.topology.structure','getStateAsync','5823NmrtsS','\x27.\x20(Multi-Person\x20Filter)','analysis.safety.deadMan.currentRoom','[DeadMan]\x20','./setup','Unknown','6138XgKVQF','message','toLowerCase','analysis.safety.deadMan.active','3654673aDoKwo','\x20fÃ¼r\x20','91LjOjZB','log','parse','216264OIpaHm','10YGdRnN','\x20Min.','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','info','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','416MRuXZx','toString','.\x20Alles\x20in\x20Ordnung?'];a2_0x4f16=function(){return _0x366c0e;};return a2_0x4f16();}module['exports']={'updateLocation':updateLocation};