const a2_0x3d5de5=a2_0x3230;(function(_0x24b77f,_0x2d89c2){const _0x4c892b=a2_0x3230,_0x596374=_0x24b77f();while(!![]){try{const _0x307c5d=parseInt(_0x4c892b(0xcc))/0x1*(-parseInt(_0x4c892b(0xbd))/0x2)+-parseInt(_0x4c892b(0xd2))/0x3*(-parseInt(_0x4c892b(0xe6))/0x4)+parseInt(_0x4c892b(0xd3))/0x5*(parseInt(_0x4c892b(0xdd))/0x6)+parseInt(_0x4c892b(0xca))/0x7+-parseInt(_0x4c892b(0xc5))/0x8*(-parseInt(_0x4c892b(0xe1))/0x9)+-parseInt(_0x4c892b(0xc3))/0xa*(-parseInt(_0x4c892b(0xeb))/0xb)+-parseInt(_0x4c892b(0xc7))/0xc;if(_0x307c5d===_0x2d89c2)break;else _0x596374['push'](_0x596374['shift']());}catch(_0xe74a3f){_0x596374['push'](_0x596374['shift']());}}}(a2_0xb922,0xecf96));const a2_0x45ee2b=(function(){let _0x40e822=!![];return function(_0x3b5678,_0x27104a){const _0x3804a0=_0x40e822?function(){const _0x3429f2=a2_0x3230;if(_0x27104a){const _0x174805=_0x27104a[_0x3429f2(0xd9)](_0x3b5678,arguments);return _0x27104a=null,_0x174805;}}:function(){};return _0x40e822=![],_0x3804a0;};}()),a2_0x4e5f02=a2_0x45ee2b(this,function(){const _0x2fe0fa=a2_0x3230;return a2_0x4e5f02[_0x2fe0fa(0xdc)]()[_0x2fe0fa(0xd8)](_0x2fe0fa(0xd4))[_0x2fe0fa(0xdc)]()[_0x2fe0fa(0xde)](a2_0x4e5f02)[_0x2fe0fa(0xd8)]('(((.+)+)+)+$');});function a2_0xb922(){const _0x1b13ce=['\x20fÃ¼r\x20','analysis.safety.deadMan.currentRoom','7331860UecdKL','indexOf','29768bNrtOF','message','30808080eevBJu','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','Unknown','7039186NmeKsG','parse','713voQGDL','log','now','.\x20Alles\x20in\x20Ordnung?','analysis.safety.deadMan.lastIgnored','setStateAsync','753smsJCe','1103395aDvPiL','(((.+)+)+)+$','analysis.safety.deadMan.alarmState','exports','includes','search','apply','[DeadMan]\x20Topology\x20check\x20failed:\x20','error','toString','30sByzYq','constructor','toLowerCase','Ignoriere\x20Bewegung\x20in\x20\x27','639PIvcYm','./setup','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','info','getStateAsync','8560bjrbXp','sendNotification','stringify','[DeadMan]\x20','val','11trNwbO','296XOEGQI','default','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','\x20(Multi-Person\x20Filter)'];a2_0xb922=function(){return _0x1b13ce;};return a2_0xb922();}a2_0x4e5f02();'use strict';const setup=require(a2_0x3d5de5(0xe2));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x1a0525){const _0x447cf6=a2_0x3d5de5;try{const _0x53cd24=await _0x1a0525[_0x447cf6(0xe5)]('analysis.safety.deadMan.config');if(_0x53cd24&&_0x53cd24['val'])return JSON[_0x447cf6(0xcb)](_0x53cd24[_0x447cf6(0xea)]);}catch(_0x215ce5){}return{};}async function isActive(_0x267fd2){const _0x974025=a2_0x3d5de5;try{const _0x30d0cc=await _0x267fd2[_0x974025(0xe5)]('analysis.safety.deadMan.active');return _0x30d0cc&&_0x30d0cc['val'];}catch(_0x3dc0c1){return![];}}async function areRoomsConnected(_0x1ee7e8,_0x29b330,_0x8107b5){const _0x2e5036=a2_0x3d5de5;try{const _0x22ddb2=await _0x1ee7e8[_0x2e5036(0xe5)]('analysis.topology.structure');if(!_0x22ddb2||!_0x22ddb2[_0x2e5036(0xea)])return!![];const _0x431995=JSON[_0x2e5036(0xcb)](_0x22ddb2[_0x2e5036(0xea)]),{rooms:_0xcc32fa,matrix:_0x10dcd7}=_0x431995;if(!_0xcc32fa||!_0x10dcd7)return!![];const _0xe03acd=_0xcc32fa[_0x2e5036(0xc4)](_0x29b330),_0x31f841=_0xcc32fa[_0x2e5036(0xc4)](_0x8107b5);if(_0xe03acd===-0x1||_0x31f841===-0x1)return!![];const _0x6d0f3c=_0x10dcd7[_0xe03acd][_0x31f841]>0x0||_0x10dcd7[_0x31f841][_0xe03acd]>0x0;return _0x6d0f3c;}catch(_0x40364e){return _0x1ee7e8[_0x2e5036(0xcd)]['warn'](_0x2e5036(0xda)+_0x40364e[_0x2e5036(0xc6)]),!![];}}async function updateLocation(_0x32a7df,_0x4a9854){const _0xbf9ccd=a2_0x3d5de5;if(!_0x4a9854||_0x4a9854===_0xbf9ccd(0xc9))return;if(!await isActive(_0x32a7df)){resetTimer(_0x32a7df);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x4a9854){const _0x17c85b=await areRoomsConnected(_0x32a7df,currentMonitoredRoom,_0x4a9854);if(!_0x17c85b){const _0x2248d5=_0xbf9ccd(0xe0)+_0x4a9854+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0x32a7df[_0xbf9ccd(0xcd)][_0xbf9ccd(0xe4)](_0xbf9ccd(0xe9)+_0x2248d5+_0xbf9ccd(0xc0)),await _0x32a7df[_0xbf9ccd(0xd1)](_0xbf9ccd(0xd0),{'val':JSON[_0xbf9ccd(0xe8)]({'room':_0x4a9854,'reason':_0x2248d5,'timestamp':Date['now']()}),'ack':!![]});return;}resetTimer(_0x32a7df);}if(!currentMonitoredRoom){await _0x32a7df[_0xbf9ccd(0xd1)](_0xbf9ccd(0xc2),{'val':_0x4a9854,'ack':!![]});const _0x19f791=await loadConfig(_0x32a7df),_0x959bfe=_0x4a9854[_0xbf9ccd(0xdf)]();let _0xb507f3=_0x19f791[_0x4a9854]||_0x19f791[_0x959bfe];if(!_0xb507f3)for(const _0x547176 in DEFAULT_TIMEOUTS){if(_0x959bfe[_0xbf9ccd(0xd7)](_0x547176)){_0xb507f3=DEFAULT_TIMEOUTS[_0x547176];break;}}if(!_0xb507f3&&_0x19f791['default'])_0xb507f3=_0x19f791[_0xbf9ccd(0xbe)];if(!_0xb507f3)return;currentMonitoredRoom=_0x4a9854,startTimer(_0x32a7df,_0xb507f3);}}function a2_0x3230(_0x43d376,_0x29ed9e){const _0x3bf267=a2_0xb922();return a2_0x3230=function(_0x4e5f02,_0x45ee2b){_0x4e5f02=_0x4e5f02-0xbd;let _0xb922f6=_0x3bf267[_0x4e5f02];return _0xb922f6;},a2_0x3230(_0x43d376,_0x29ed9e);}function startTimer(_0x959b80,_0x12d1a6){const _0x49eb72=a2_0x3d5de5;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x12d1a6*0x3c*0x3e8,startTime=Date[_0x49eb72(0xce)](),alarmStage=0x0,_0x959b80['log'][_0x49eb72(0xe4)](_0x49eb72(0xbf)+currentMonitoredRoom+_0x49eb72(0xc1)+_0x12d1a6+'\x20Min.'),_0x959b80['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x959b80),timeoutMs);}function resetTimer(_0x1df350){const _0x18c822=a2_0x3d5de5;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x1df350[_0x18c822(0xd1)](_0x18c822(0xd5),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x38aead){const _0xe72197=a2_0x3d5de5;alarmStage=0x1,await _0x38aead[_0xe72197(0xd1)]('analysis.safety.deadMan.alarmState',{'val':'pre_warn','ack':!![]});const _0x3760b9=_0xe72197(0xc8)+currentMonitoredRoom+_0xe72197(0xcf);_0x38aead[_0xe72197(0xcd)]['warn'](_0xe72197(0xe9)+_0x3760b9),await setup[_0xe72197(0xe7)](_0x38aead,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x3760b9),activeTimer=setTimeout(()=>triggerAlarm(_0x38aead),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x10cc81){const _0x536fe5=a2_0x3d5de5;alarmStage=0x2,await _0x10cc81[_0x536fe5(0xd1)]('analysis.safety.deadMan.alarmState',{'val':'alarm','ack':!![]});const _0x2ea329=_0x536fe5(0xe3)+currentMonitoredRoom+'!';_0x10cc81[_0x536fe5(0xcd)][_0x536fe5(0xdb)](_0x536fe5(0xe9)+_0x2ea329),await setup[_0x536fe5(0xe7)](_0x10cc81,_0x2ea329,![],!![]);}module[a2_0x3d5de5(0xd6)]={'updateLocation':updateLocation};