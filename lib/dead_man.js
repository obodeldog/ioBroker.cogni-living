function a2_0x4f84(_0x2d9866,_0x4f67b5){const _0x21706e=a2_0x480c();return a2_0x4f84=function(_0x421e16,_0x5809da){_0x421e16=_0x421e16-0x15f;let _0x480c3f=_0x21706e[_0x421e16];return _0x480c3f;},a2_0x4f84(_0x2d9866,_0x4f67b5);}const a2_0x2b871f=a2_0x4f84;(function(_0xd882d5,_0x1ee362){const _0x4018e2=a2_0x4f84,_0x3fdecb=_0xd882d5();while(!![]){try{const _0x565a36=-parseInt(_0x4018e2(0x181))/0x1+parseInt(_0x4018e2(0x166))/0x2*(-parseInt(_0x4018e2(0x18e))/0x3)+parseInt(_0x4018e2(0x182))/0x4+-parseInt(_0x4018e2(0x17d))/0x5*(parseInt(_0x4018e2(0x17b))/0x6)+-parseInt(_0x4018e2(0x161))/0x7*(-parseInt(_0x4018e2(0x177))/0x8)+-parseInt(_0x4018e2(0x185))/0x9*(-parseInt(_0x4018e2(0x170))/0xa)+-parseInt(_0x4018e2(0x16c))/0xb;if(_0x565a36===_0x1ee362)break;else _0x3fdecb['push'](_0x3fdecb['shift']());}catch(_0x515744){_0x3fdecb['push'](_0x3fdecb['shift']());}}}(a2_0x480c,0xb987b));const a2_0x5809da=(function(){let _0x5050a4=!![];return function(_0x1e1f26,_0x5ee1dd){const _0x35e48d=_0x5050a4?function(){if(_0x5ee1dd){const _0x2668a1=_0x5ee1dd['apply'](_0x1e1f26,arguments);return _0x5ee1dd=null,_0x2668a1;}}:function(){};return _0x5050a4=![],_0x35e48d;};}()),a2_0x421e16=a2_0x5809da(this,function(){const _0x546ea0=a2_0x4f84;return a2_0x421e16[_0x546ea0(0x162)]()[_0x546ea0(0x172)](_0x546ea0(0x167))[_0x546ea0(0x162)]()[_0x546ea0(0x18f)](a2_0x421e16)[_0x546ea0(0x172)]('(((.+)+)+)+$');});a2_0x421e16();'use strict';const setup=require(a2_0x2b871f(0x18a));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x3f600a){const _0x446d46=a2_0x2b871f;try{const _0x5cbe73=await _0x3f600a[_0x446d46(0x174)](_0x446d46(0x160));if(_0x5cbe73&&_0x5cbe73[_0x446d46(0x165)])return JSON[_0x446d46(0x16b)](_0x5cbe73[_0x446d46(0x165)]);}catch(_0x27bce8){}return{};}async function isActive(_0x154920){const _0x3886af=a2_0x2b871f;try{const _0x5bcb8a=await _0x154920[_0x3886af(0x174)](_0x3886af(0x183));return _0x5bcb8a&&_0x5bcb8a[_0x3886af(0x165)];}catch(_0x13e5e7){return![];}}async function areRoomsConnected(_0x5c7c1f,_0x1bc08d,_0x4255c7){const _0x42a92d=a2_0x2b871f;try{const _0x346bf4=await _0x5c7c1f[_0x42a92d(0x174)](_0x42a92d(0x187));if(!_0x346bf4||!_0x346bf4[_0x42a92d(0x165)])return!![];const _0x5c0995=JSON[_0x42a92d(0x16b)](_0x346bf4[_0x42a92d(0x165)]),{rooms:_0x4703ba,matrix:_0x145a46}=_0x5c0995;if(!_0x4703ba||!_0x145a46)return!![];const _0x3eb153=_0x4703ba[_0x42a92d(0x188)](_0x1bc08d),_0x2cd37f=_0x4703ba[_0x42a92d(0x188)](_0x4255c7);if(_0x3eb153===-0x1||_0x2cd37f===-0x1)return!![];const _0x22e719=_0x145a46[_0x3eb153][_0x2cd37f]>0x0||_0x145a46[_0x2cd37f][_0x3eb153]>0x0;return _0x22e719;}catch(_0x162714){return _0x5c7c1f[_0x42a92d(0x15f)][_0x42a92d(0x16d)](_0x42a92d(0x169)+_0x162714[_0x42a92d(0x180)]),!![];}}async function updateLocation(_0x9e4a3d,_0x4a0337){const _0x1b2087=a2_0x2b871f;if(!_0x4a0337||_0x4a0337==='Unknown')return;if(!await isActive(_0x9e4a3d)){resetTimer(_0x9e4a3d);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x4a0337){const _0x5dd708=await areRoomsConnected(_0x9e4a3d,currentMonitoredRoom,_0x4a0337);if(!_0x5dd708){const _0x1f0a7b=_0x1b2087(0x17a)+_0x4a0337+_0x1b2087(0x171)+currentMonitoredRoom+'\x27.';_0x9e4a3d[_0x1b2087(0x15f)][_0x1b2087(0x18c)](_0x1b2087(0x17c)+_0x1f0a7b+_0x1b2087(0x168)),await _0x9e4a3d[_0x1b2087(0x16a)](_0x1b2087(0x164),{'val':JSON['stringify']({'room':_0x4a0337,'reason':_0x1f0a7b,'timestamp':Date[_0x1b2087(0x184)]()}),'ack':!![]});return;}resetTimer(_0x9e4a3d);}if(!currentMonitoredRoom){await _0x9e4a3d[_0x1b2087(0x16a)](_0x1b2087(0x17e),{'val':_0x4a0337,'ack':!![]});const _0x908146=await loadConfig(_0x9e4a3d),_0x4cf3dc=_0x4a0337['toLowerCase']();let _0x9af769=_0x908146[_0x4a0337]||_0x908146[_0x4cf3dc];if(!_0x9af769)for(const _0x119833 in DEFAULT_TIMEOUTS){if(_0x4cf3dc[_0x1b2087(0x186)](_0x119833)){_0x9af769=DEFAULT_TIMEOUTS[_0x119833];break;}}if(!_0x9af769&&_0x908146[_0x1b2087(0x175)])_0x9af769=_0x908146[_0x1b2087(0x175)];if(!_0x9af769)return;currentMonitoredRoom=_0x4a0337,startTimer(_0x9e4a3d,_0x9af769);}}function startTimer(_0x4dba23,_0x3460d0){const _0x59c7f4=a2_0x2b871f;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3460d0*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0,_0x4dba23[_0x59c7f4(0x15f)]['info'](_0x59c7f4(0x176)+currentMonitoredRoom+_0x59c7f4(0x17f)+_0x3460d0+'\x20Min.'),_0x4dba23[_0x59c7f4(0x16a)](_0x59c7f4(0x179),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x4dba23),timeoutMs);}function resetTimer(_0xa7a5de){const _0x73a95e=a2_0x2b871f;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0xa7a5de['setStateAsync'](_0x73a95e(0x179),{'val':'ok','ack':!![]});}function a2_0x480c(){const _0x2d1f70=['7cTajbO','toString','sendNotification','analysis.safety.deadMan.lastIgnored','val','6462GqyGmn','(((.+)+)+)+$','\x20(Multi-Person\x20Filter)','[DeadMan]\x20Topology\x20check\x20failed:\x20','setStateAsync','parse','6688165rXohJf','warn','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','.\x20Alles\x20in\x20Ordnung?','329870PDJbQs','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','search','alarm','getStateAsync','default','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','9376072BmVwJx','pre_warn','analysis.safety.deadMan.alarmState','Ignoriere\x20Bewegung\x20in\x20\x27','2262dsOUIK','[DeadMan]\x20','8630dPXCvN','analysis.safety.deadMan.currentRoom','\x20fÃ¼r\x20','message','321784htdLHa','3520376hEdljO','analysis.safety.deadMan.active','now','225VXNWax','includes','analysis.topology.structure','indexOf','error','./setup','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','info','ðŸ‘¼\x20Schutzengel-Frage:\x20','498OHyzRM','constructor','log','analysis.safety.deadMan.config'];a2_0x480c=function(){return _0x2d1f70;};return a2_0x480c();}async function triggerPreWarn(_0x801a23){const _0x1fd37d=a2_0x2b871f;alarmStage=0x1,await _0x801a23[_0x1fd37d(0x16a)](_0x1fd37d(0x179),{'val':_0x1fd37d(0x178),'ack':!![]});const _0x5274f1=_0x1fd37d(0x18b)+currentMonitoredRoom+_0x1fd37d(0x16f);_0x801a23[_0x1fd37d(0x15f)]['warn'](_0x1fd37d(0x17c)+_0x5274f1),await setup[_0x1fd37d(0x163)](_0x801a23,_0x1fd37d(0x18d)+_0x5274f1),activeTimer=setTimeout(()=>triggerAlarm(_0x801a23),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x4ca119){const _0x4897e9=a2_0x2b871f;alarmStage=0x2,await _0x4ca119[_0x4897e9(0x16a)](_0x4897e9(0x179),{'val':_0x4897e9(0x173),'ack':!![]});const _0x29765c=_0x4897e9(0x16e)+currentMonitoredRoom+'!';_0x4ca119[_0x4897e9(0x15f)][_0x4897e9(0x189)](_0x4897e9(0x17c)+_0x29765c),await setup[_0x4897e9(0x163)](_0x4ca119,_0x29765c,![],!![]);}module['exports']={'updateLocation':updateLocation};