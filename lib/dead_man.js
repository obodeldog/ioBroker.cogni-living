const a2_0x5b10fb=a2_0x317c;(function(_0xbb17ca,_0x3480c8){const _0x848d40=a2_0x317c,_0x4ff7be=_0xbb17ca();while(!![]){try{const _0x3a8b75=parseInt(_0x848d40(0xc9))/0x1+-parseInt(_0x848d40(0xe9))/0x2*(-parseInt(_0x848d40(0xea))/0x3)+parseInt(_0x848d40(0xd5))/0x4*(-parseInt(_0x848d40(0xcd))/0x5)+parseInt(_0x848d40(0xbf))/0x6*(-parseInt(_0x848d40(0xd8))/0x7)+-parseInt(_0x848d40(0xed))/0x8*(parseInt(_0x848d40(0xc5))/0x9)+-parseInt(_0x848d40(0xee))/0xa*(parseInt(_0x848d40(0xc6))/0xb)+-parseInt(_0x848d40(0xe1))/0xc*(-parseInt(_0x848d40(0xc3))/0xd);if(_0x3a8b75===_0x3480c8)break;else _0x4ff7be['push'](_0x4ff7be['shift']());}catch(_0xb8d34a){_0x4ff7be['push'](_0x4ff7be['shift']());}}}(a2_0x5919,0x497ce));const a2_0x291674=(function(){let _0x3e0994=!![];return function(_0x12f81a,_0x1d5c69){const _0x5b1da8=_0x3e0994?function(){if(_0x1d5c69){const _0x3e4b4d=_0x1d5c69['apply'](_0x12f81a,arguments);return _0x1d5c69=null,_0x3e4b4d;}}:function(){};return _0x3e0994=![],_0x5b1da8;};}()),a2_0x3749bb=a2_0x291674(this,function(){const _0x49bd5e=a2_0x317c;return a2_0x3749bb[_0x49bd5e(0xd9)]()[_0x49bd5e(0xca)](_0x49bd5e(0xce))[_0x49bd5e(0xd9)]()[_0x49bd5e(0xd3)](a2_0x3749bb)[_0x49bd5e(0xca)](_0x49bd5e(0xce));});a2_0x3749bb();'use strict';const setup=require(a2_0x5b10fb(0xc1));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};function a2_0x5919(){const _0x5d99ff=['parse','warn','setStateAsync','analysis.safety.deadMan.currentRoom','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','\x20(Multi-Person\x20Filter)','val','70lYdaLT','16701DvbFzd','getStateAsync','log','24ObZkQg','76790tioQUC','\x20Min.','12IKqxur','.\x20Alles\x20in\x20Ordnung?','./setup','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','247GSfCkw','error','1236528nWOcqe','671KFOqPi','analysis.safety.deadMan.config','stringify','141819vircMV','search','analysis.safety.deadMan.alarmState','alarm','1915Ddntnh','(((.+)+)+)+$','Ignoriere\x20Bewegung\x20in\x20\x27','info','[DeadMan]\x20Topology\x20check\x20failed:\x20','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','constructor','indexOf','5436uxXKJa','now','default','2086042SILBuO','toString','sendNotification','toLowerCase','[DeadMan]\x20','includes','exports','analysis.topology.structure','pre_warn','1238808EHTSPl'];a2_0x5919=function(){return _0x5d99ff;};return a2_0x5919();}async function loadConfig(_0x381dcb){const _0x5c96ed=a2_0x5b10fb;try{const _0x42883c=await _0x381dcb[_0x5c96ed(0xeb)](_0x5c96ed(0xc7));if(_0x42883c&&_0x42883c['val'])return JSON[_0x5c96ed(0xe2)](_0x42883c[_0x5c96ed(0xe8)]);}catch(_0x170817){}return{};}async function isActive(_0x4cff8d){const _0x54c601=a2_0x5b10fb;try{const _0x5ba39d=await _0x4cff8d[_0x54c601(0xeb)]('analysis.safety.deadMan.active');return _0x5ba39d&&_0x5ba39d[_0x54c601(0xe8)];}catch(_0x39f5b5){return![];}}async function areRoomsConnected(_0x50ca18,_0x228639,_0x51a240){const _0x3c8d64=a2_0x5b10fb;try{const _0x592831=await _0x50ca18[_0x3c8d64(0xeb)](_0x3c8d64(0xdf));if(!_0x592831||!_0x592831[_0x3c8d64(0xe8)])return!![];const _0x5af2a9=JSON[_0x3c8d64(0xe2)](_0x592831[_0x3c8d64(0xe8)]),{rooms:_0x66c7ea,matrix:_0x4db6b8}=_0x5af2a9;if(!_0x66c7ea||!_0x4db6b8)return!![];const _0xd3173f=_0x66c7ea[_0x3c8d64(0xd4)](_0x228639),_0x44e9d6=_0x66c7ea[_0x3c8d64(0xd4)](_0x51a240);if(_0xd3173f===-0x1||_0x44e9d6===-0x1)return!![];const _0x2cc522=_0x4db6b8[_0xd3173f][_0x44e9d6]>0x0||_0x4db6b8[_0x44e9d6][_0xd3173f]>0x0;return _0x2cc522;}catch(_0x4701bc){return _0x50ca18[_0x3c8d64(0xec)][_0x3c8d64(0xe3)](_0x3c8d64(0xd1)+_0x4701bc['message']),!![];}}async function updateLocation(_0x1e2487,_0x1c9963){const _0x443bc6=a2_0x5b10fb;if(!_0x1c9963||_0x1c9963==='Unknown')return;if(!await isActive(_0x1e2487)){resetTimer(_0x1e2487);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x1c9963){const _0x37f0e3=await areRoomsConnected(_0x1e2487,currentMonitoredRoom,_0x1c9963);if(!_0x37f0e3){const _0x4df9bc=_0x443bc6(0xcf)+_0x1c9963+_0x443bc6(0xe6)+currentMonitoredRoom+'\x27.';_0x1e2487[_0x443bc6(0xec)][_0x443bc6(0xd0)](_0x443bc6(0xdc)+_0x4df9bc+_0x443bc6(0xe7)),await _0x1e2487[_0x443bc6(0xe4)]('analysis.safety.deadMan.lastIgnored',{'val':JSON[_0x443bc6(0xc8)]({'room':_0x1c9963,'reason':_0x4df9bc,'timestamp':Date[_0x443bc6(0xd6)]()}),'ack':!![]});return;}resetTimer(_0x1e2487);}if(!currentMonitoredRoom){await _0x1e2487[_0x443bc6(0xe4)](_0x443bc6(0xe5),{'val':_0x1c9963,'ack':!![]});const _0x4d9901=await loadConfig(_0x1e2487),_0x2099fa=_0x1c9963[_0x443bc6(0xdb)]();let _0x57499e=_0x4d9901[_0x1c9963]||_0x4d9901[_0x2099fa];if(!_0x57499e)for(const _0x45e289 in DEFAULT_TIMEOUTS){if(_0x2099fa[_0x443bc6(0xdd)](_0x45e289)){_0x57499e=DEFAULT_TIMEOUTS[_0x45e289];break;}}if(!_0x57499e&&_0x4d9901[_0x443bc6(0xd7)])_0x57499e=_0x4d9901[_0x443bc6(0xd7)];if(!_0x57499e)return;currentMonitoredRoom=_0x1c9963,startTimer(_0x1e2487,_0x57499e);}}function startTimer(_0x53862c,_0x52b591){const _0x425b21=a2_0x5b10fb;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x52b591*0x3c*0x3e8,startTime=Date[_0x425b21(0xd6)](),alarmStage=0x0,_0x53862c[_0x425b21(0xec)][_0x425b21(0xd0)]('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0x52b591+_0x425b21(0xef)),_0x53862c[_0x425b21(0xe4)](_0x425b21(0xcb),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x53862c),timeoutMs);}function resetTimer(_0x4233b7){const _0x4fc21c=a2_0x5b10fb;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x4233b7[_0x4fc21c(0xe4)](_0x4fc21c(0xcb),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0xda44f2){const _0x1cc8b0=a2_0x5b10fb;alarmStage=0x1,await _0xda44f2[_0x1cc8b0(0xe4)](_0x1cc8b0(0xcb),{'val':_0x1cc8b0(0xe0),'ack':!![]});const _0xb44223=_0x1cc8b0(0xc2)+currentMonitoredRoom+_0x1cc8b0(0xc0);_0xda44f2['log'][_0x1cc8b0(0xe3)](_0x1cc8b0(0xdc)+_0xb44223),await setup[_0x1cc8b0(0xda)](_0xda44f2,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0xb44223),activeTimer=setTimeout(()=>triggerAlarm(_0xda44f2),0x5*0x3c*0x3e8);}function a2_0x317c(_0x263dfc,_0xb0bc5b){const _0xb07c73=a2_0x5919();return a2_0x317c=function(_0x3749bb,_0x291674){_0x3749bb=_0x3749bb-0xbf;let _0x59196f=_0xb07c73[_0x3749bb];return _0x59196f;},a2_0x317c(_0x263dfc,_0xb0bc5b);}async function triggerAlarm(_0x2ff95a){const _0x3062cb=a2_0x5b10fb;alarmStage=0x2,await _0x2ff95a[_0x3062cb(0xe4)](_0x3062cb(0xcb),{'val':_0x3062cb(0xcc),'ack':!![]});const _0x48cb84=_0x3062cb(0xd2)+currentMonitoredRoom+'!';_0x2ff95a[_0x3062cb(0xec)][_0x3062cb(0xc4)]('[DeadMan]\x20'+_0x48cb84),await setup[_0x3062cb(0xda)](_0x2ff95a,_0x48cb84,![],!![]);}module[a2_0x5b10fb(0xde)]={'updateLocation':updateLocation};