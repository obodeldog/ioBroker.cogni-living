const a2_0x126896=a2_0x45dc;(function(_0x4c0212,_0x4c2621){const _0x579b95=a2_0x45dc,_0x4535b2=_0x4c0212();while(!![]){try{const _0x39cc50=parseInt(_0x579b95(0xdd))/0x1+parseInt(_0x579b95(0xd7))/0x2+parseInt(_0x579b95(0xbe))/0x3+-parseInt(_0x579b95(0xd6))/0x4*(-parseInt(_0x579b95(0xc8))/0x5)+parseInt(_0x579b95(0xcd))/0x6+parseInt(_0x579b95(0xc5))/0x7*(-parseInt(_0x579b95(0xc2))/0x8)+-parseInt(_0x579b95(0xe2))/0x9;if(_0x39cc50===_0x4c2621)break;else _0x4535b2['push'](_0x4535b2['shift']());}catch(_0x2b3185){_0x4535b2['push'](_0x4535b2['shift']());}}}(a2_0x493b,0xc85b5));const a2_0x1d654a=(function(){let _0x3ed191=!![];return function(_0x93a84,_0x418b21){const _0x4dbb0f=_0x3ed191?function(){if(_0x418b21){const _0x3578f9=_0x418b21['apply'](_0x93a84,arguments);return _0x418b21=null,_0x3578f9;}}:function(){};return _0x3ed191=![],_0x4dbb0f;};}()),a2_0x59f18d=a2_0x1d654a(this,function(){const _0x5aa32a=a2_0x45dc;return a2_0x59f18d['toString']()[_0x5aa32a(0xda)](_0x5aa32a(0xbd))['toString']()[_0x5aa32a(0xc6)](a2_0x59f18d)[_0x5aa32a(0xda)](_0x5aa32a(0xbd));});a2_0x59f18d();'use strict';const setup=require(a2_0x126896(0xc3));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x3561bb){const _0x4dcd12=a2_0x126896;try{const _0x539815=await _0x3561bb[_0x4dcd12(0xe1)](_0x4dcd12(0xc0));if(_0x539815&&_0x539815[_0x4dcd12(0xd3)])return JSON[_0x4dcd12(0xdf)](_0x539815['val']);}catch(_0x5e52a1){}return{};}async function isActive(_0x5cfa2f){const _0x586909=a2_0x126896;try{const _0x291b2b=await _0x5cfa2f[_0x586909(0xe1)](_0x586909(0xd5));return _0x291b2b&&_0x291b2b[_0x586909(0xd3)];}catch(_0x15d223){return![];}}function a2_0x493b(){const _0x9bbe12=['includes','search','analysis.safety.deadMan.alarmState','sendNotification','894433KDxQoG','default','parse','\x20(Multi-Person\x20Filter)','getStateAsync','9054684EZPoTR','log','[DeadMan]\x20','[DeadMan]\x20Topology\x20check\x20failed:\x20','analysis.safety.deadMan.lastIgnored','Unknown','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','now','setStateAsync','(((.+)+)+)+$','738780ziSncE','info','analysis.safety.deadMan.config','ðŸ‘¼\x20Schutzengel-Frage:\x20','1300064JvRpBr','./setup','analysis.safety.deadMan.currentRoom','35nasQWE','constructor','message','70255NZSLiW','error','exports','stringify','analysis.topology.structure','4933374CgwukM','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','indexOf','\x20fÃ¼r\x20','warn','.\x20Alles\x20in\x20Ordnung?','val','Ignoriere\x20Bewegung\x20in\x20\x27','analysis.safety.deadMan.active','128uwdInG','453446dGCglW','toLowerCase'];a2_0x493b=function(){return _0x9bbe12;};return a2_0x493b();}async function areRoomsConnected(_0xd64209,_0x138502,_0x28f386){const _0x2cecf5=a2_0x126896;try{const _0x30c7c4=await _0xd64209[_0x2cecf5(0xe1)](_0x2cecf5(0xcc));if(!_0x30c7c4||!_0x30c7c4[_0x2cecf5(0xd3)])return!![];const _0xdf25d0=JSON[_0x2cecf5(0xdf)](_0x30c7c4['val']),{rooms:_0x59ffa9,matrix:_0x227c66}=_0xdf25d0;if(!_0x59ffa9||!_0x227c66)return!![];const _0x3e250e=_0x59ffa9[_0x2cecf5(0xcf)](_0x138502),_0xe036db=_0x59ffa9[_0x2cecf5(0xcf)](_0x28f386);if(_0x3e250e===-0x1||_0xe036db===-0x1)return!![];const _0x33bcbd=_0x227c66[_0x3e250e][_0xe036db]>0x0||_0x227c66[_0xe036db][_0x3e250e]>0x0;return _0x33bcbd;}catch(_0x37afd4){return _0xd64209['log']['warn'](_0x2cecf5(0xe5)+_0x37afd4[_0x2cecf5(0xc7)]),!![];}}async function updateLocation(_0xac2791,_0x3cda16){const _0x118ce8=a2_0x126896;if(!_0x3cda16||_0x3cda16===_0x118ce8(0xe7))return;if(!await isActive(_0xac2791)){resetTimer(_0xac2791);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x3cda16){const _0x13cbfd=await areRoomsConnected(_0xac2791,currentMonitoredRoom,_0x3cda16);if(!_0x13cbfd){const _0x64fed9=_0x118ce8(0xd4)+_0x3cda16+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.';_0xac2791['log'][_0x118ce8(0xbf)]('[DeadMan]\x20'+_0x64fed9+_0x118ce8(0xe0)),await _0xac2791[_0x118ce8(0xbc)](_0x118ce8(0xe6),{'val':JSON[_0x118ce8(0xcb)]({'room':_0x3cda16,'reason':_0x64fed9,'timestamp':Date[_0x118ce8(0xbb)]()}),'ack':!![]});return;}resetTimer(_0xac2791);}if(!currentMonitoredRoom){await _0xac2791[_0x118ce8(0xbc)](_0x118ce8(0xc4),{'val':_0x3cda16,'ack':!![]});const _0x19f2b9=await loadConfig(_0xac2791),_0x1309c8=_0x3cda16[_0x118ce8(0xd8)]();let _0x55ca35=_0x19f2b9[_0x3cda16]||_0x19f2b9[_0x1309c8];if(!_0x55ca35)for(const _0x3670a5 in DEFAULT_TIMEOUTS){if(_0x1309c8[_0x118ce8(0xd9)](_0x3670a5)){_0x55ca35=DEFAULT_TIMEOUTS[_0x3670a5];break;}}if(!_0x55ca35&&_0x19f2b9[_0x118ce8(0xde)])_0x55ca35=_0x19f2b9[_0x118ce8(0xde)];if(!_0x55ca35)return;currentMonitoredRoom=_0x3cda16,startTimer(_0xac2791,_0x55ca35);}}function startTimer(_0x471d76,_0x56f3d4){const _0x522cd8=a2_0x126896;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x56f3d4*0x3c*0x3e8,startTime=Date[_0x522cd8(0xbb)](),alarmStage=0x0,_0x471d76[_0x522cd8(0xe3)][_0x522cd8(0xbf)](_0x522cd8(0xba)+currentMonitoredRoom+_0x522cd8(0xd0)+_0x56f3d4+'\x20Min.'),_0x471d76[_0x522cd8(0xbc)](_0x522cd8(0xdb),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x471d76),timeoutMs);}function a2_0x45dc(_0x4b3265,_0x2e5cb3){const _0x25da32=a2_0x493b();return a2_0x45dc=function(_0x59f18d,_0x1d654a){_0x59f18d=_0x59f18d-0xba;let _0x493b3e=_0x25da32[_0x59f18d];return _0x493b3e;},a2_0x45dc(_0x4b3265,_0x2e5cb3);}function resetTimer(_0x50d933){const _0x817eeb=a2_0x126896;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x50d933[_0x817eeb(0xbc)](_0x817eeb(0xdb),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x2cae8e){const _0x225cef=a2_0x126896;alarmStage=0x1,await _0x2cae8e[_0x225cef(0xbc)](_0x225cef(0xdb),{'val':'pre_warn','ack':!![]});const _0x35b41c=_0x225cef(0xce)+currentMonitoredRoom+_0x225cef(0xd2);_0x2cae8e[_0x225cef(0xe3)][_0x225cef(0xd1)](_0x225cef(0xe4)+_0x35b41c),await setup['sendNotification'](_0x2cae8e,_0x225cef(0xc1)+_0x35b41c),activeTimer=setTimeout(()=>triggerAlarm(_0x2cae8e),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x556b81){const _0x24fbc6=a2_0x126896;alarmStage=0x2,await _0x556b81[_0x24fbc6(0xbc)](_0x24fbc6(0xdb),{'val':'alarm','ack':!![]});const _0x549107='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x556b81[_0x24fbc6(0xe3)][_0x24fbc6(0xc9)](_0x24fbc6(0xe4)+_0x549107),await setup[_0x24fbc6(0xdc)](_0x556b81,_0x549107,![],!![]);}module[a2_0x126896(0xca)]={'updateLocation':updateLocation};