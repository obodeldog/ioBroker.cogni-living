const a2_0x181dff=a2_0x3232;(function(_0x591ded,_0xa9bbc6){const _0x3e98bc=a2_0x3232,_0x24c84b=_0x591ded();while(!![]){try{const _0xe1da86=-parseInt(_0x3e98bc(0xad))/0x1+-parseInt(_0x3e98bc(0xab))/0x2+-parseInt(_0x3e98bc(0xd3))/0x3+-parseInt(_0x3e98bc(0xcb))/0x4*(parseInt(_0x3e98bc(0xce))/0x5)+parseInt(_0x3e98bc(0xc5))/0x6*(parseInt(_0x3e98bc(0xb3))/0x7)+parseInt(_0x3e98bc(0xa9))/0x8*(parseInt(_0x3e98bc(0xb4))/0x9)+-parseInt(_0x3e98bc(0xc2))/0xa*(-parseInt(_0x3e98bc(0xbd))/0xb);if(_0xe1da86===_0xa9bbc6)break;else _0x24c84b['push'](_0x24c84b['shift']());}catch(_0x386265){_0x24c84b['push'](_0x24c84b['shift']());}}}(a2_0x462a,0xb6118));function a2_0x462a(){const _0x31fc24=['val','indexOf','77PEknzU','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','constructor','analysis.safety.deadMan.active','apply','3950300SRLCpi','message','\x20fÃ¼r\x20','2238bUtKQd','toLowerCase','log','[DeadMan]\x20','warn','ðŸ‘¼\x20Schutzengel-Frage:\x20','8rTqHil','includes','sendNotification','3302065ifCglf','Unknown','analysis.safety.deadMan.config','./setup','exports','1068297CQnpeR','getStateAsync','setStateAsync','[DeadMan]\x20Topology\x20check\x20failed:\x20','analysis.safety.deadMan.alarmState','analysis.safety.deadMan.lastIgnored','.\x20Alles\x20in\x20Ordnung?','info','10008YIDmGu','pre_warn','2958638sKBOqj','(((.+)+)+)+$','948348RugovO','stringify','error','default','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','now','20279jOnHgb','7227hCCbUp','parse','analysis.safety.deadMan.currentRoom','analysis.topology.structure','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','search','toString'];a2_0x462a=function(){return _0x31fc24;};return a2_0x462a();}const a2_0x5f4fb8=(function(){let _0x56901d=!![];return function(_0x66a33f,_0x1be672){const _0x4eef45=_0x56901d?function(){const _0x5da2ed=a2_0x3232;if(_0x1be672){const _0x3c027b=_0x1be672[_0x5da2ed(0xc1)](_0x66a33f,arguments);return _0x1be672=null,_0x3c027b;}}:function(){};return _0x56901d=![],_0x4eef45;};}()),a2_0x49a518=a2_0x5f4fb8(this,function(){const _0x1199e7=a2_0x3232;return a2_0x49a518[_0x1199e7(0xba)]()[_0x1199e7(0xb9)](_0x1199e7(0xac))[_0x1199e7(0xba)]()[_0x1199e7(0xbf)](a2_0x49a518)[_0x1199e7(0xb9)](_0x1199e7(0xac));});function a2_0x3232(_0xf3ba4f,_0x5f535c){const _0x5a2524=a2_0x462a();return a2_0x3232=function(_0x49a518,_0x5f4fb8){_0x49a518=_0x49a518-0xa9;let _0x462acf=_0x5a2524[_0x49a518];return _0x462acf;},a2_0x3232(_0xf3ba4f,_0x5f535c);}a2_0x49a518();'use strict';const setup=require(a2_0x181dff(0xd1));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0xb349b6){const _0x242a61=a2_0x181dff;try{const _0xdfe6d7=await _0xb349b6[_0x242a61(0xd4)](_0x242a61(0xd0));if(_0xdfe6d7&&_0xdfe6d7['val'])return JSON['parse'](_0xdfe6d7[_0x242a61(0xbb)]);}catch(_0x331268){}return{};}async function isActive(_0xe7a77c){const _0x498a70=a2_0x181dff;try{const _0x2d55b9=await _0xe7a77c[_0x498a70(0xd4)](_0x498a70(0xc0));return _0x2d55b9&&_0x2d55b9[_0x498a70(0xbb)];}catch(_0x19b028){return![];}}async function areRoomsConnected(_0x290dc3,_0x59e6bd,_0x24632e){const _0x17d48e=a2_0x181dff;try{const _0x44a84f=await _0x290dc3[_0x17d48e(0xd4)](_0x17d48e(0xb7));if(!_0x44a84f||!_0x44a84f[_0x17d48e(0xbb)])return!![];const _0x35b533=JSON[_0x17d48e(0xb5)](_0x44a84f[_0x17d48e(0xbb)]),{rooms:_0x4f4d97,matrix:_0x21c8a9}=_0x35b533;if(!_0x4f4d97||!_0x21c8a9)return!![];const _0xa2b1b4=_0x4f4d97[_0x17d48e(0xbc)](_0x59e6bd),_0x3792b0=_0x4f4d97[_0x17d48e(0xbc)](_0x24632e);if(_0xa2b1b4===-0x1||_0x3792b0===-0x1)return!![];const _0x39327d=_0x21c8a9[_0xa2b1b4][_0x3792b0]>0x0||_0x21c8a9[_0x3792b0][_0xa2b1b4]>0x0;return _0x39327d;}catch(_0x330cdc){return _0x290dc3['log'][_0x17d48e(0xc9)](_0x17d48e(0xd6)+_0x330cdc[_0x17d48e(0xc3)]),!![];}}async function updateLocation(_0x372b9b,_0x10ec5a){const _0x362bf7=a2_0x181dff;if(!_0x10ec5a||_0x10ec5a===_0x362bf7(0xcf))return;if(!await isActive(_0x372b9b)){resetTimer(_0x372b9b);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x10ec5a){const _0x5a5032=await areRoomsConnected(_0x372b9b,currentMonitoredRoom,_0x10ec5a);if(!_0x5a5032){const _0x55ebf0='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x10ec5a+_0x362bf7(0xb8)+currentMonitoredRoom+'\x27.';_0x372b9b[_0x362bf7(0xc7)][_0x362bf7(0xda)]('[DeadMan]\x20'+_0x55ebf0+'\x20(Multi-Person\x20Filter)'),await _0x372b9b[_0x362bf7(0xd5)](_0x362bf7(0xd8),{'val':JSON[_0x362bf7(0xae)]({'room':_0x10ec5a,'reason':_0x55ebf0,'timestamp':Date['now']()}),'ack':!![]});return;}resetTimer(_0x372b9b);}if(!currentMonitoredRoom){await _0x372b9b[_0x362bf7(0xd5)](_0x362bf7(0xb6),{'val':_0x10ec5a,'ack':!![]});const _0x40772e=await loadConfig(_0x372b9b),_0x1bec3a=_0x10ec5a[_0x362bf7(0xc6)]();let _0x5f2a9f=_0x40772e[_0x10ec5a]||_0x40772e[_0x1bec3a];if(!_0x5f2a9f)for(const _0x52f03d in DEFAULT_TIMEOUTS){if(_0x1bec3a[_0x362bf7(0xcc)](_0x52f03d)){_0x5f2a9f=DEFAULT_TIMEOUTS[_0x52f03d];break;}}if(!_0x5f2a9f&&_0x40772e[_0x362bf7(0xb0)])_0x5f2a9f=_0x40772e[_0x362bf7(0xb0)];if(!_0x5f2a9f)return;currentMonitoredRoom=_0x10ec5a,startTimer(_0x372b9b,_0x5f2a9f);}}function startTimer(_0x2563ab,_0x587d65){const _0x270eee=a2_0x181dff;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x587d65*0x3c*0x3e8,startTime=Date[_0x270eee(0xb2)](),alarmStage=0x0,_0x2563ab[_0x270eee(0xc7)][_0x270eee(0xda)](_0x270eee(0xbe)+currentMonitoredRoom+_0x270eee(0xc4)+_0x587d65+'\x20Min.'),_0x2563ab[_0x270eee(0xd5)](_0x270eee(0xd7),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x2563ab),timeoutMs);}function resetTimer(_0x48c5e3){const _0x33340d=a2_0x181dff;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x48c5e3[_0x33340d(0xd5)](_0x33340d(0xd7),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x58fd92){const _0x56ba64=a2_0x181dff;alarmStage=0x1,await _0x58fd92[_0x56ba64(0xd5)](_0x56ba64(0xd7),{'val':_0x56ba64(0xaa),'ack':!![]});const _0x58b79d='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x56ba64(0xd9);_0x58fd92[_0x56ba64(0xc7)][_0x56ba64(0xc9)]('[DeadMan]\x20'+_0x58b79d),await setup[_0x56ba64(0xcd)](_0x58fd92,_0x56ba64(0xca)+_0x58b79d),activeTimer=setTimeout(()=>triggerAlarm(_0x58fd92),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x332a8c){const _0x564f7e=a2_0x181dff;alarmStage=0x2,await _0x332a8c['setStateAsync'](_0x564f7e(0xd7),{'val':'alarm','ack':!![]});const _0x14a558=_0x564f7e(0xb1)+currentMonitoredRoom+'!';_0x332a8c[_0x564f7e(0xc7)][_0x564f7e(0xaf)](_0x564f7e(0xc8)+_0x14a558),await setup[_0x564f7e(0xcd)](_0x332a8c,_0x14a558,![],!![]);}module[a2_0x181dff(0xd2)]={'updateLocation':updateLocation};