const a2_0x486f25=a2_0x34ef;(function(_0x3059b2,_0x55bdc0){const _0x1ea992=a2_0x34ef,_0x5ed9fc=_0x3059b2();while(!![]){try{const _0xfcce52=parseInt(_0x1ea992(0x1b7))/0x1*(parseInt(_0x1ea992(0x1b4))/0x2)+-parseInt(_0x1ea992(0x18a))/0x3+parseInt(_0x1ea992(0x1bb))/0x4+-parseInt(_0x1ea992(0x1a5))/0x5+parseInt(_0x1ea992(0x1b9))/0x6+parseInt(_0x1ea992(0x1a4))/0x7+parseInt(_0x1ea992(0x1a8))/0x8*(-parseInt(_0x1ea992(0x1a6))/0x9);if(_0xfcce52===_0x55bdc0)break;else _0x5ed9fc['push'](_0x5ed9fc['shift']());}catch(_0x5347e){_0x5ed9fc['push'](_0x5ed9fc['shift']());}}}(a2_0x242c,0x48cd9));const a2_0x82fcb9=(function(){let _0x4618e6=!![];return function(_0x5842f7,_0x2fcf58){const _0x1e836a=_0x4618e6?function(){const _0x4cba02=a2_0x34ef;if(_0x2fcf58){const _0x5f5cbb=_0x2fcf58[_0x4cba02(0x1a3)](_0x5842f7,arguments);return _0x2fcf58=null,_0x5f5cbb;}}:function(){};return _0x4618e6=![],_0x1e836a;};}()),a2_0x348f60=a2_0x82fcb9(this,function(){const _0x4c0796=a2_0x34ef;return a2_0x348f60[_0x4c0796(0x190)]()[_0x4c0796(0x197)](_0x4c0796(0x194))[_0x4c0796(0x190)]()[_0x4c0796(0x18b)](a2_0x348f60)[_0x4c0796(0x197)](_0x4c0796(0x194));});a2_0x348f60();'use strict';const setup=require(a2_0x486f25(0x192));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c,'schlaf':0x78,'bed':0x78,'guest':0x5a,'gast':0x5a};function getTimeoutRobust(_0x390b68,_0x2c4dc4){const _0x91f0c2=a2_0x486f25;if(!_0x390b68||!_0x2c4dc4)return undefined;if(_0x390b68[_0x2c4dc4])return _0x390b68[_0x2c4dc4];const _0x356cd7=_0x2c4dc4[_0x91f0c2(0x196)]()[_0x91f0c2(0x1a9)](/[^a-z0-9]/g,'');for(const _0x4ba91f in _0x390b68){const _0x199ebd=_0x4ba91f[_0x91f0c2(0x196)]()['replace'](/[^a-z0-9]/g,'');if(_0x199ebd===_0x356cd7)return _0x390b68[_0x4ba91f];}const _0x49cefb=_0x2c4dc4[_0x91f0c2(0x196)]();if(_0x390b68[_0x49cefb])return _0x390b68[_0x49cefb];return undefined;}function a2_0x34ef(_0x4727ab,_0x5e4166){const _0x38c5f1=a2_0x242c();return a2_0x34ef=function(_0x348f60,_0x82fcb9){_0x348f60=_0x348f60-0x183;let _0x242cab=_0x38c5f1[_0x348f60];return _0x242cab;},a2_0x34ef(_0x4727ab,_0x5e4166);}async function loadConfig(_0x52558b){const _0x3341f4=a2_0x486f25;try{const _0x281969=await _0x52558b[_0x3341f4(0x1b8)](_0x3341f4(0x191));if(_0x281969&&_0x281969[_0x3341f4(0x1a2)])return JSON[_0x3341f4(0x1ad)](_0x281969[_0x3341f4(0x1a2)]);}catch(_0x150c13){}return{};}async function isActive(_0x2bd3f7){const _0x3f8e35=a2_0x486f25;try{const _0x39a59b=await _0x2bd3f7[_0x3f8e35(0x1b8)](_0x3f8e35(0x189));return _0x39a59b&&_0x39a59b['val'];}catch(_0x29e44c){return![];}}async function areRoomsConnected(_0x212cb7,_0x43531a,_0x28e113){const _0x200669=a2_0x486f25;try{const _0x454af7=await _0x212cb7[_0x200669(0x1b8)](_0x200669(0x19d));if(!_0x454af7||!_0x454af7[_0x200669(0x1a2)])return!![];const _0x490d43=JSON['parse'](_0x454af7[_0x200669(0x1a2)]),{rooms:_0x3dd697,matrix:_0x55d97a}=_0x490d43;if(!_0x3dd697||!_0x55d97a)return!![];const _0x529ec1=_0x3dd697[_0x200669(0x1b0)](_0x43531a),_0x857c52=_0x3dd697[_0x200669(0x1b0)](_0x28e113);if(_0x529ec1===-0x1||_0x857c52===-0x1)return!![];const _0x526b0b=_0x55d97a[_0x529ec1][_0x857c52]>0x0||_0x55d97a[_0x857c52][_0x529ec1]>0x0;return _0x526b0b;}catch(_0x5adeaf){return _0x212cb7[_0x200669(0x18d)][_0x200669(0x1ba)](_0x200669(0x18e)+_0x5adeaf[_0x200669(0x19c)]),!![];}}function calculateSleepProbability(_0x242d7e){const _0x2614dc=a2_0x486f25,_0x255744=new Date(),_0x5dce20=_0x255744[_0x2614dc(0x19a)](),_0x1a1ae6=_0x242d7e[_0x2614dc(0x196)]();let _0x2acf8e=0.1;if(_0x5dce20>=0x17||_0x5dce20<=0x6)_0x2acf8e=0x1;else{if(_0x5dce20>=0xd&&_0x5dce20<=0xf)_0x2acf8e=0.8;else{if(_0x5dce20>=0x14&&_0x5dce20<=0x17)_0x2acf8e=0.4;}}let _0x2e80be=0.1;if(_0x1a1ae6[_0x2614dc(0x185)]('schlaf')||_0x1a1ae6[_0x2614dc(0x185)]('bed'))_0x2e80be=0x1;else{if(_0x1a1ae6['includes'](_0x2614dc(0x1ae))||_0x1a1ae6[_0x2614dc(0x185)]('living')||_0x1a1ae6[_0x2614dc(0x185)]('sofa'))_0x2e80be=0.6;else{if(_0x1a1ae6[_0x2614dc(0x185)]('bad')||_0x1a1ae6[_0x2614dc(0x185)]('wc'))_0x2e80be=0.05;}}let _0x10bea4=0.5;const _0x3626d1=_0x2e80be*0.5+_0x2acf8e*0.3+_0x10bea4*0.2;return parseFloat(_0x3626d1['toFixed'](0x2));}async function updateLocation(_0x4cc94d,_0x5c4625){const _0x307b14=a2_0x486f25;if(!_0x5c4625||_0x5c4625===_0x307b14(0x1b6))return;if(!await isActive(_0x4cc94d)){resetTimer(_0x4cc94d);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x5c4625){const _0x5311c9=await areRoomsConnected(_0x4cc94d,currentMonitoredRoom,_0x5c4625);if(!_0x5311c9){const _0x4aec09='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x5c4625+_0x307b14(0x186)+currentMonitoredRoom+'\x27.';_0x4cc94d[_0x307b14(0x18d)]['info'](_0x307b14(0x195)+_0x4aec09+_0x307b14(0x18f)),await _0x4cc94d[_0x307b14(0x1b1)](_0x307b14(0x1a0),{'val':JSON[_0x307b14(0x1a7)]({'room':_0x5c4625,'reason':_0x4aec09,'timestamp':Date['now']()}),'ack':!![]});return;}resetTimer(_0x4cc94d);}if(!currentMonitoredRoom){await _0x4cc94d[_0x307b14(0x1b1)](_0x307b14(0x19f),{'val':_0x5c4625,'ack':!![]});const _0x253304=await loadConfig(_0x4cc94d);let _0x27b5e4=getTimeoutRobust(_0x253304,_0x5c4625);const _0x20bb73=_0x5c4625[_0x307b14(0x196)]();if(!_0x27b5e4)for(const _0xc064d9 in DEFAULT_TIMEOUTS){if(_0x20bb73[_0x307b14(0x185)](_0xc064d9)){_0x27b5e4=DEFAULT_TIMEOUTS[_0xc064d9];break;}}if(!_0x27b5e4&&_0x253304[_0x307b14(0x184)])_0x27b5e4=_0x253304[_0x307b14(0x184)];if(!_0x27b5e4)return;currentMonitoredRoom=_0x5c4625,startTimer(_0x4cc94d,_0x27b5e4,_0x5c4625);}}function startTimer(_0x3dbb73,_0x5c6ad2,_0x2dd797){const _0x3b3564=a2_0x486f25;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x5c6ad2*0x3c*0x3e8,startTime=Date[_0x3b3564(0x1bc)](),alarmStage=0x0;const _0x21d2b8=calculateSleepProbability(_0x2dd797||currentMonitoredRoom),_0x551098=_0x21d2b8>0.65;_0x551098?(timeoutMs+=0x5a*0x3c*0x3e8,_0x3dbb73['log'][_0x3b3564(0x18c)](_0x3b3564(0x1b2)+(_0x21d2b8*0x64)[_0x3b3564(0x19b)](0x0)+'%).\x20Verl√§ngere\x20Timer\x20f√ºr\x20'+currentMonitoredRoom+_0x3b3564(0x1b5)),_0x3dbb73['setStateAsync'](_0x3b3564(0x1b3),{'val':!![],'ack':!![]})):_0x3dbb73[_0x3b3564(0x1b1)](_0x3b3564(0x1b3),{'val':![],'ack':!![]}),_0x3dbb73[_0x3b3564(0x1b1)](_0x3b3564(0x1a1),{'val':_0x21d2b8,'ack':!![]}),_0x3dbb73[_0x3b3564(0x18d)][_0x3b3564(0x18c)](_0x3b3564(0x187)+currentMonitoredRoom+_0x3b3564(0x199)+_0x5c6ad2+'\x20Min.'),_0x3dbb73[_0x3b3564(0x1b1)](_0x3b3564(0x1af),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x3dbb73),timeoutMs);}function resetTimer(_0x2c588b){const _0x2fd493=a2_0x486f25;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x2c588b[_0x2fd493(0x1b1)](_0x2fd493(0x1af),{'val':'ok','ack':!![]}),_0x2c588b[_0x2fd493(0x1b1)](_0x2fd493(0x1b3),{'val':![],'ack':!![]}),_0x2c588b[_0x2fd493(0x1b1)](_0x2fd493(0x1a1),{'val':0x0,'ack':!![]});}async function triggerPreWarn(_0x24d648){const _0x551ac4=a2_0x486f25;alarmStage=0x1,await _0x24d648[_0x551ac4(0x1b1)](_0x551ac4(0x1af),{'val':_0x551ac4(0x1ac),'ack':!![]});const _0x30cbf0=_0x551ac4(0x1aa)+currentMonitoredRoom+_0x551ac4(0x188);_0x24d648[_0x551ac4(0x18d)][_0x551ac4(0x1ba)](_0x551ac4(0x195)+_0x30cbf0),await setup['sendNotification'](_0x24d648,_0x551ac4(0x193)+_0x30cbf0),activeTimer=setTimeout(()=>triggerAlarm(_0x24d648),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x34a0b3){const _0x4e7ac0=a2_0x486f25;alarmStage=0x2,await _0x34a0b3[_0x4e7ac0(0x1b1)](_0x4e7ac0(0x1af),{'val':_0x4e7ac0(0x1ab),'ack':!![]});const _0x382962='üö®\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x34a0b3[_0x4e7ac0(0x18d)][_0x4e7ac0(0x198)](_0x4e7ac0(0x195)+_0x382962),await setup[_0x4e7ac0(0x19e)](_0x34a0b3,_0x382962,![],!![]);}function a2_0x242c(){const _0x4d0e67=['./setup','üëº\x20Schutzengel-Frage:\x20','(((.+)+)+)+$','[DeadMan]\x20','toLowerCase','search','error','\x20f√ºr\x20','getHours','toFixed','message','analysis.topology.structure','sendNotification','analysis.safety.deadMan.currentRoom','analysis.safety.deadMan.lastIgnored','analysis.safety.deadMan.napProbability','val','apply','3555258PVNApa','785065YupDHx','6641937umDFMo','stringify','8RfSvRw','replace','‚è≥\x20ACHTUNG:\x20Ungew√∂hnlich\x20lange\x20Inaktivit√§t\x20in\x20','alarm','pre_warn','parse','wohn','analysis.safety.deadMan.alarmState','indexOf','setStateAsync','üí§\x20Smart\x20Sleep\x20erkannt\x20(','analysis.safety.deadMan.smartSleep','388fauBlF','\x20um\x2090\x20Min.','Unknown','1624SqmOSL','getStateAsync','2646288sNGxxw','warn','1470616kBvaPc','now','exports','default','includes','\x27.\x20Nicht\x20verbunden\x20mit\x20√ºberwachtem\x20\x27','üëº\x20Schutzengel:\x20√úberwache\x20','.\x20Alles\x20in\x20Ordnung?','analysis.safety.deadMan.active','1315335roxigh','constructor','info','log','[DeadMan]\x20Topology\x20check\x20failed:\x20','\x20(Multi-Person\x20Filter)','toString','analysis.safety.deadMan.config'];a2_0x242c=function(){return _0x4d0e67;};return a2_0x242c();}module[a2_0x486f25(0x183)]={'updateLocation':updateLocation};