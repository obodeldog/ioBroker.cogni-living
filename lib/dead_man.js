const a2_0xa70744=a2_0x3946;(function(_0x547e8f,_0x34f07d){const _0x41ff9e=a2_0x3946,_0x465306=_0x547e8f();while(!![]){try{const _0x5761c7=-parseInt(_0x41ff9e(0x20b))/0x1*(-parseInt(_0x41ff9e(0x1ff))/0x2)+parseInt(_0x41ff9e(0x1fc))/0x3+-parseInt(_0x41ff9e(0x201))/0x4*(-parseInt(_0x41ff9e(0x1fb))/0x5)+-parseInt(_0x41ff9e(0x20a))/0x6+-parseInt(_0x41ff9e(0x1ef))/0x7+-parseInt(_0x41ff9e(0x20d))/0x8*(parseInt(_0x41ff9e(0x200))/0x9)+parseInt(_0x41ff9e(0x1e8))/0xa;if(_0x5761c7===_0x34f07d)break;else _0x465306['push'](_0x465306['shift']());}catch(_0x5764af){_0x465306['push'](_0x465306['shift']());}}}(a2_0x2ef8,0xa6b62));const a2_0x12b471=(function(){let _0x223b48=!![];return function(_0x2232a8,_0x2f8060){const _0x3a8ad0=_0x223b48?function(){if(_0x2f8060){const _0x3e17a4=_0x2f8060['apply'](_0x2232a8,arguments);return _0x2f8060=null,_0x3e17a4;}}:function(){};return _0x223b48=![],_0x3a8ad0;};}()),a2_0xf2f248=a2_0x12b471(this,function(){const _0x228561=a2_0x3946;return a2_0xf2f248[_0x228561(0x1fe)]()['search']('(((.+)+)+)+$')[_0x228561(0x1fe)]()[_0x228561(0x1f6)](a2_0xf2f248)[_0x228561(0x1f9)](_0x228561(0x1f3));});a2_0xf2f248();'use strict';const setup=require('./setup');let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x2af03f){const _0x4adb74=a2_0x3946;try{const _0x4281b5=await _0x2af03f[_0x4adb74(0x202)](_0x4adb74(0x1eb));if(_0x4281b5&&_0x4281b5[_0x4adb74(0x1f4)])return JSON[_0x4adb74(0x205)](_0x4281b5[_0x4adb74(0x1f4)]);}catch(_0x246790){}return{};}async function isActive(_0x5a4e56){const _0x7b8af0=a2_0x3946;try{const _0x2e6f34=await _0x5a4e56[_0x7b8af0(0x202)]('analysis.safety.deadMan.active');return _0x2e6f34&&_0x2e6f34['val'];}catch(_0x3e5199){return![];}}function a2_0x3946(_0x55b4d9,_0x1349dc){const _0x3352cd=a2_0x2ef8();return a2_0x3946=function(_0xf2f248,_0x12b471){_0xf2f248=_0xf2f248-0x1e5;let _0x2ef8ba=_0x3352cd[_0xf2f248];return _0x2ef8ba;},a2_0x3946(_0x55b4d9,_0x1349dc);}async function areRoomsConnected(_0x40c6d4,_0x28c9cc,_0x3f6a66){const _0x9aeffb=a2_0x3946;try{const _0x1416f0=await _0x40c6d4[_0x9aeffb(0x202)](_0x9aeffb(0x210));if(!_0x1416f0||!_0x1416f0['val'])return!![];const _0x91b2f9=JSON[_0x9aeffb(0x205)](_0x1416f0[_0x9aeffb(0x1f4)]),{rooms:_0x385c82,matrix:_0x2cd43a}=_0x91b2f9;if(!_0x385c82||!_0x2cd43a)return!![];const _0x34c368=_0x385c82[_0x9aeffb(0x1f8)](_0x28c9cc),_0x34251a=_0x385c82[_0x9aeffb(0x1f8)](_0x3f6a66);if(_0x34c368===-0x1||_0x34251a===-0x1)return!![];const _0x131532=_0x2cd43a[_0x34c368][_0x34251a]>0x0||_0x2cd43a[_0x34251a][_0x34c368]>0x0;return _0x131532;}catch(_0x16dc41){return _0x40c6d4[_0x9aeffb(0x1e9)]['warn'](_0x9aeffb(0x1ea)+_0x16dc41[_0x9aeffb(0x203)]),!![];}}function a2_0x2ef8(){const _0x466112=['[DeadMan]\x20Topology\x20check\x20failed:\x20','analysis.safety.deadMan.config','toLowerCase','now','ðŸ‘¼\x20Schutzengel-Frage:\x20','7005117ZgFCou','analysis.safety.deadMan.alarmState','setStateAsync','analysis.safety.deadMan.currentRoom','(((.+)+)+)+$','val','pre_warn','constructor','info','indexOf','search','.\x20Alles\x20in\x20Ordnung?','268115sXJThb','1157001TAicCA','warn','toString','64PLeyHx','2214PcBHhj','8YpqcLw','getStateAsync','message','\x27.\x20(Multi-Person\x20Filter)','parse','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','Unknown','default','[DeadMan]\x20','3294516JysvtA','14729ccVopG','error','2920Lpudgj','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','alarm','analysis.topology.structure','includes','\x20fÃ¼r\x20','exports','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','sendNotification','13582160XqwSUj','log'];a2_0x2ef8=function(){return _0x466112;};return a2_0x2ef8();}async function updateLocation(_0x1746bb,_0x202e70){const _0x50a52f=a2_0x3946;if(!_0x202e70||_0x202e70===_0x50a52f(0x207))return;if(!await isActive(_0x1746bb)){resetTimer(_0x1746bb);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x202e70){const _0x4a0a8a=await areRoomsConnected(_0x1746bb,currentMonitoredRoom,_0x202e70);if(!_0x4a0a8a){_0x1746bb[_0x50a52f(0x1e9)]['info'](_0x50a52f(0x206)+_0x202e70+_0x50a52f(0x20e)+currentMonitoredRoom+_0x50a52f(0x204));return;}resetTimer(_0x1746bb);}if(!currentMonitoredRoom){await _0x1746bb[_0x50a52f(0x1f1)](_0x50a52f(0x1f2),{'val':_0x202e70,'ack':!![]});const _0x39402f=await loadConfig(_0x1746bb),_0x169fe3=_0x202e70[_0x50a52f(0x1ec)]();let _0x16902e=_0x39402f[_0x202e70]||_0x39402f[_0x169fe3];if(!_0x16902e)for(const _0x1afb6f in DEFAULT_TIMEOUTS){if(_0x169fe3[_0x50a52f(0x211)](_0x1afb6f)){_0x16902e=DEFAULT_TIMEOUTS[_0x1afb6f];break;}}if(!_0x16902e&&_0x39402f[_0x50a52f(0x208)])_0x16902e=_0x39402f[_0x50a52f(0x208)];if(!_0x16902e)return;currentMonitoredRoom=_0x202e70,startTimer(_0x1746bb,_0x16902e);}}function startTimer(_0xd5a592,_0x1cb979){const _0x24e4e3=a2_0x3946;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x1cb979*0x3c*0x3e8,startTime=Date[_0x24e4e3(0x1ed)](),alarmStage=0x0,_0xd5a592[_0x24e4e3(0x1e9)][_0x24e4e3(0x1f7)]('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+_0x24e4e3(0x212)+_0x1cb979+'\x20Min.'),_0xd5a592[_0x24e4e3(0x1f1)](_0x24e4e3(0x1f0),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0xd5a592),timeoutMs);}function resetTimer(_0x580b26){const _0x15dc49=a2_0x3946;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x580b26[_0x15dc49(0x1f1)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x569087){const _0x38c434=a2_0x3946;alarmStage=0x1,await _0x569087[_0x38c434(0x1f1)](_0x38c434(0x1f0),{'val':_0x38c434(0x1f5),'ack':!![]});const _0x5deeb8=_0x38c434(0x1e6)+currentMonitoredRoom+_0x38c434(0x1fa);_0x569087['log'][_0x38c434(0x1fd)](_0x38c434(0x209)+_0x5deeb8),await setup[_0x38c434(0x1e7)](_0x569087,_0x38c434(0x1ee)+_0x5deeb8),activeTimer=setTimeout(()=>triggerAlarm(_0x569087),0x5*0x3c*0x3e8);}async function triggerAlarm(_0xf8c5a2){const _0x52a049=a2_0x3946;alarmStage=0x2,await _0xf8c5a2[_0x52a049(0x1f1)](_0x52a049(0x1f0),{'val':_0x52a049(0x20f),'ack':!![]});const _0x56f383='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0xf8c5a2[_0x52a049(0x1e9)][_0x52a049(0x20c)]('[DeadMan]\x20'+_0x56f383),await setup[_0x52a049(0x1e7)](_0xf8c5a2,_0x56f383,![],!![]);}module[a2_0xa70744(0x1e5)]={'updateLocation':updateLocation};