const a2_0x4bdfc9=a2_0x47df;(function(_0x312cfc,_0x530abe){const _0x58d958=a2_0x47df,_0x2ac9b6=_0x312cfc();while(!![]){try{const _0x7e8950=-parseInt(_0x58d958(0xd4))/0x1+-parseInt(_0x58d958(0xea))/0x2*(parseInt(_0x58d958(0xe9))/0x3)+-parseInt(_0x58d958(0xe4))/0x4+parseInt(_0x58d958(0xdc))/0x5+parseInt(_0x58d958(0xd1))/0x6*(parseInt(_0x58d958(0xed))/0x7)+parseInt(_0x58d958(0xf0))/0x8*(parseInt(_0x58d958(0xde))/0x9)+parseInt(_0x58d958(0xfa))/0xa;if(_0x7e8950===_0x530abe)break;else _0x2ac9b6['push'](_0x2ac9b6['shift']());}catch(_0x266479){_0x2ac9b6['push'](_0x2ac9b6['shift']());}}}(a2_0x2a02,0xf0184));const a2_0x55e4d9=(function(){let _0x2a478c=!![];return function(_0x1a2316,_0x35ffe4){const _0x2d224e=_0x2a478c?function(){if(_0x35ffe4){const _0x18125c=_0x35ffe4['apply'](_0x1a2316,arguments);return _0x35ffe4=null,_0x18125c;}}:function(){};return _0x2a478c=![],_0x2d224e;};}()),a2_0x271c24=a2_0x55e4d9(this,function(){const _0x3d9c03=a2_0x47df;return a2_0x271c24['toString']()['search']('(((.+)+)+)+$')[_0x3d9c03(0xd5)]()[_0x3d9c03(0xe5)](a2_0x271c24)['search'](_0x3d9c03(0xf1));});function a2_0x2a02(){const _0x245d78=['warn','includes','409767tDhVds','22fgDWsd','parse','analysis.safety.deadMan.active','679Dteyvp','exports','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','881896fVhMVc','(((.+)+)+)+$','.\x20Alles\x20in\x20Ordnung?','analysis.safety.deadMan.alarmState','\x20fÃ¼r\x20','alarm','analysis.safety.deadMan.config','sendNotification','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','val','7844960UTftoF','default','error','57990Udptmz','analysis.safety.deadMan.currentRoom','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','655356AwEfPM','toString','analysis.topology.structure','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','pre_warn','setStateAsync','./setup','Unknown','9764435aSWOAP','indexOf','72hSZzHE','getStateAsync','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','[DeadMan]\x20Topology\x20check\x20failed:\x20','info','[DeadMan]\x20','5662084KwwCkA','constructor','log'];a2_0x2a02=function(){return _0x245d78;};return a2_0x2a02();}a2_0x271c24();'use strict';const setup=require(a2_0x4bdfc9(0xda));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x4f2745){const _0x5d3db2=a2_0x4bdfc9;try{const _0x58bc9f=await _0x4f2745[_0x5d3db2(0xdf)](_0x5d3db2(0xf6));if(_0x58bc9f&&_0x58bc9f[_0x5d3db2(0xf9)])return JSON[_0x5d3db2(0xeb)](_0x58bc9f[_0x5d3db2(0xf9)]);}catch(_0x27f478){}return{};}async function isActive(_0x112bd6){const _0x33b943=a2_0x4bdfc9;try{const _0x8238ed=await _0x112bd6[_0x33b943(0xdf)](_0x33b943(0xec));return _0x8238ed&&_0x8238ed[_0x33b943(0xf9)];}catch(_0x34f3cd){return![];}}async function areRoomsConnected(_0x25dfc5,_0x1c46c4,_0x50e4e2){const _0x293c84=a2_0x4bdfc9;try{const _0x3425b9=await _0x25dfc5[_0x293c84(0xdf)](_0x293c84(0xd6));if(!_0x3425b9||!_0x3425b9[_0x293c84(0xf9)])return!![];const _0x573c45=JSON[_0x293c84(0xeb)](_0x3425b9[_0x293c84(0xf9)]),{rooms:_0xd1a70f,matrix:_0x32890e}=_0x573c45;if(!_0xd1a70f||!_0x32890e)return!![];const _0x2b6933=_0xd1a70f[_0x293c84(0xdd)](_0x1c46c4),_0x1cf27a=_0xd1a70f[_0x293c84(0xdd)](_0x50e4e2);if(_0x2b6933===-0x1||_0x1cf27a===-0x1)return!![];const _0x5ea08d=_0x32890e[_0x2b6933][_0x1cf27a]>0x0||_0x32890e[_0x1cf27a][_0x2b6933]>0x0;return _0x5ea08d;}catch(_0x2b3987){return _0x25dfc5[_0x293c84(0xe6)][_0x293c84(0xe7)](_0x293c84(0xe1)+_0x2b3987['message']),!![];}}async function updateLocation(_0x478a24,_0x1c3488){const _0x373f42=a2_0x4bdfc9;if(!_0x1c3488||_0x1c3488===_0x373f42(0xdb))return;if(!await isActive(_0x478a24)){resetTimer(_0x478a24);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x1c3488){const _0x45d708=await areRoomsConnected(_0x478a24,currentMonitoredRoom,_0x1c3488);if(!_0x45d708){_0x478a24[_0x373f42(0xe6)][_0x373f42(0xe2)](_0x373f42(0xd7)+_0x1c3488+_0x373f42(0xef)+currentMonitoredRoom+'\x27.\x20(Multi-Person\x20Filter)');return;}resetTimer(_0x478a24);}if(!currentMonitoredRoom){await _0x478a24[_0x373f42(0xd9)](_0x373f42(0xd2),{'val':_0x1c3488,'ack':!![]});const _0x30958c=await loadConfig(_0x478a24),_0x8617e0=_0x1c3488['toLowerCase']();let _0x152dfa=_0x30958c[_0x1c3488]||_0x30958c[_0x8617e0];if(!_0x152dfa)for(const _0x5eabf7 in DEFAULT_TIMEOUTS){if(_0x8617e0[_0x373f42(0xe8)](_0x5eabf7)){_0x152dfa=DEFAULT_TIMEOUTS[_0x5eabf7];break;}}if(!_0x152dfa&&_0x30958c['default'])_0x152dfa=_0x30958c[_0x373f42(0xfb)];if(!_0x152dfa)return;currentMonitoredRoom=_0x1c3488,startTimer(_0x478a24,_0x152dfa);}}function startTimer(_0x3b572e,_0x147f8f){const _0x1377f1=a2_0x4bdfc9;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x147f8f*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0,_0x3b572e[_0x1377f1(0xe6)][_0x1377f1(0xe2)](_0x1377f1(0xd3)+currentMonitoredRoom+_0x1377f1(0xf4)+_0x147f8f+'\x20Min.'),_0x3b572e[_0x1377f1(0xd9)](_0x1377f1(0xf3),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x3b572e),timeoutMs);}function resetTimer(_0x623d7a){const _0x5d574c=a2_0x4bdfc9;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x623d7a[_0x5d574c(0xd9)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x20b859){const _0x27a74b=a2_0x4bdfc9;alarmStage=0x1,await _0x20b859[_0x27a74b(0xd9)](_0x27a74b(0xf3),{'val':_0x27a74b(0xd8),'ack':!![]});const _0x227164=_0x27a74b(0xe0)+currentMonitoredRoom+_0x27a74b(0xf2);_0x20b859[_0x27a74b(0xe6)]['warn'](_0x27a74b(0xe3)+_0x227164),await setup['sendNotification'](_0x20b859,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x227164),activeTimer=setTimeout(()=>triggerAlarm(_0x20b859),0x5*0x3c*0x3e8);}function a2_0x47df(_0x5e1959,_0x39b3f4){const _0x295c22=a2_0x2a02();return a2_0x47df=function(_0x271c24,_0x55e4d9){_0x271c24=_0x271c24-0xd1;let _0x2a0250=_0x295c22[_0x271c24];return _0x2a0250;},a2_0x47df(_0x5e1959,_0x39b3f4);}async function triggerAlarm(_0x26e982){const _0xbb790c=a2_0x4bdfc9;alarmStage=0x2,await _0x26e982[_0xbb790c(0xd9)](_0xbb790c(0xf3),{'val':_0xbb790c(0xf5),'ack':!![]});const _0x43bcf9=_0xbb790c(0xf8)+currentMonitoredRoom+'!';_0x26e982[_0xbb790c(0xe6)][_0xbb790c(0xfc)](_0xbb790c(0xe3)+_0x43bcf9),await setup[_0xbb790c(0xf7)](_0x26e982,_0x43bcf9,![],!![]);}module[a2_0x4bdfc9(0xee)]={'updateLocation':updateLocation};