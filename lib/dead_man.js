const a2_0x5238f1=a2_0x34de;(function(_0x5987e0,_0x3ff52c){const _0x3e1e1a=a2_0x34de,_0x7f36bf=_0x5987e0();while(!![]){try{const _0x6ff62e=parseInt(_0x3e1e1a(0x145))/0x1*(parseInt(_0x3e1e1a(0x11b))/0x2)+-parseInt(_0x3e1e1a(0x139))/0x3*(-parseInt(_0x3e1e1a(0x142))/0x4)+parseInt(_0x3e1e1a(0x123))/0x5*(parseInt(_0x3e1e1a(0x130))/0x6)+-parseInt(_0x3e1e1a(0x13e))/0x7*(parseInt(_0x3e1e1a(0x12e))/0x8)+-parseInt(_0x3e1e1a(0x143))/0x9+-parseInt(_0x3e1e1a(0x116))/0xa+parseInt(_0x3e1e1a(0x125))/0xb;if(_0x6ff62e===_0x3ff52c)break;else _0x7f36bf['push'](_0x7f36bf['shift']());}catch(_0x313f27){_0x7f36bf['push'](_0x7f36bf['shift']());}}}(a2_0x1015,0x54789));const a2_0x39f84d=(function(){let _0x1c864e=!![];return function(_0x703684,_0x4a098d){const _0x1847d6=_0x1c864e?function(){const _0x1dbe40=a2_0x34de;if(_0x4a098d){const _0x465801=_0x4a098d[_0x1dbe40(0x12c)](_0x703684,arguments);return _0x4a098d=null,_0x465801;}}:function(){};return _0x1c864e=![],_0x1847d6;};}()),a2_0x3e141e=a2_0x39f84d(this,function(){const _0x1f0acd=a2_0x34de;return a2_0x3e141e[_0x1f0acd(0x128)]()['search']('(((.+)+)+)+$')[_0x1f0acd(0x128)]()[_0x1f0acd(0x138)](a2_0x3e141e)[_0x1f0acd(0x136)](_0x1f0acd(0x126));});a2_0x3e141e();function a2_0x1015(){const _0x33803e=['analysis.safety.deadMan.alarmState','toString','Unknown','default','info','apply','exports','3970784hliFja','.\x20Alles\x20in\x20Ordnung?','3449802tZkfYC','log','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','[DeadMan]\x20Topology\x20check\x20failed:\x20','toLowerCase','search','\x20fÃ¼r\x20','constructor','9pHqZeF','getStateAsync','ðŸ‘¼\x20Schutzengel-Frage:\x20','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','setStateAsync','7rAbaTM','val','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','[DeadMan]\x20','114888iPeQxY','4295151XIIAwV','now','3CphkQV','indexOf','3901300EmRwMZ','warn','analysis.safety.deadMan.currentRoom','\x27.\x20(Multi-Person\x20Filter)','./setup','145258RXYWxB','sendNotification','parse','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','analysis.safety.deadMan.config','message','analysis.safety.deadMan.active','alarm','5NSSjSE','pre_warn','9137590vkmQGa','(((.+)+)+)+$'];a2_0x1015=function(){return _0x33803e;};return a2_0x1015();}function a2_0x34de(_0x3fe61c,_0x493430){const _0x107205=a2_0x1015();return a2_0x34de=function(_0x3e141e,_0x39f84d){_0x3e141e=_0x3e141e-0x115;let _0x10152d=_0x107205[_0x3e141e];return _0x10152d;},a2_0x34de(_0x3fe61c,_0x493430);}'use strict';const setup=require(a2_0x5238f1(0x11a));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x1ecd95){const _0x92e12e=a2_0x5238f1;try{const _0x1b747c=await _0x1ecd95[_0x92e12e(0x13a)](_0x92e12e(0x11f));if(_0x1b747c&&_0x1b747c['val'])return JSON[_0x92e12e(0x11d)](_0x1b747c['val']);}catch(_0x9531d1){}return{};}async function isActive(_0xb2620f){const _0x340584=a2_0x5238f1;try{const _0x44b84f=await _0xb2620f[_0x340584(0x13a)](_0x340584(0x121));return _0x44b84f&&_0x44b84f[_0x340584(0x13f)];}catch(_0x13919c){return![];}}async function areRoomsConnected(_0x21616b,_0x3081c2,_0x2dc7e1){const _0x3a3ac2=a2_0x5238f1;try{const _0x202b72=await _0x21616b[_0x3a3ac2(0x13a)]('analysis.topology.structure');if(!_0x202b72||!_0x202b72[_0x3a3ac2(0x13f)])return!![];const _0xb6c3d=JSON['parse'](_0x202b72[_0x3a3ac2(0x13f)]),{rooms:_0xec451e,matrix:_0x5db6fb}=_0xb6c3d;if(!_0xec451e||!_0x5db6fb)return!![];const _0x203e2b=_0xec451e[_0x3a3ac2(0x115)](_0x3081c2),_0x3d8b16=_0xec451e[_0x3a3ac2(0x115)](_0x2dc7e1);if(_0x203e2b===-0x1||_0x3d8b16===-0x1)return!![];const _0x446280=_0x5db6fb[_0x203e2b][_0x3d8b16]>0x0||_0x5db6fb[_0x3d8b16][_0x203e2b]>0x0;return _0x446280;}catch(_0x4b1ea6){return _0x21616b[_0x3a3ac2(0x131)][_0x3a3ac2(0x117)](_0x3a3ac2(0x134)+_0x4b1ea6[_0x3a3ac2(0x120)]),!![];}}async function updateLocation(_0x40f4e8,_0x22adc7){const _0x76f34a=a2_0x5238f1;if(!_0x22adc7||_0x22adc7===_0x76f34a(0x129))return;if(!await isActive(_0x40f4e8)){resetTimer(_0x40f4e8);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x22adc7){const _0x4831f0=await areRoomsConnected(_0x40f4e8,currentMonitoredRoom,_0x22adc7);if(!_0x4831f0){_0x40f4e8[_0x76f34a(0x131)][_0x76f34a(0x12b)](_0x76f34a(0x140)+_0x22adc7+_0x76f34a(0x11e)+currentMonitoredRoom+_0x76f34a(0x119));return;}resetTimer(_0x40f4e8);}if(!currentMonitoredRoom){await _0x40f4e8['setStateAsync'](_0x76f34a(0x118),{'val':_0x22adc7,'ack':!![]});const _0x7d784c=await loadConfig(_0x40f4e8),_0x452c8b=_0x22adc7[_0x76f34a(0x135)]();let _0x2e885f=_0x7d784c[_0x22adc7]||_0x7d784c[_0x452c8b];if(!_0x2e885f)for(const _0xab3b58 in DEFAULT_TIMEOUTS){if(_0x452c8b['includes'](_0xab3b58)){_0x2e885f=DEFAULT_TIMEOUTS[_0xab3b58];break;}}if(!_0x2e885f&&_0x7d784c[_0x76f34a(0x12a)])_0x2e885f=_0x7d784c[_0x76f34a(0x12a)];if(!_0x2e885f)return;currentMonitoredRoom=_0x22adc7,startTimer(_0x40f4e8,_0x2e885f);}}function startTimer(_0x3ca519,_0x2e84f0){const _0x48adb0=a2_0x5238f1;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x2e84f0*0x3c*0x3e8,startTime=Date[_0x48adb0(0x144)](),alarmStage=0x0,_0x3ca519[_0x48adb0(0x131)][_0x48adb0(0x12b)](_0x48adb0(0x13c)+currentMonitoredRoom+_0x48adb0(0x137)+_0x2e84f0+'\x20Min.'),_0x3ca519[_0x48adb0(0x13d)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x3ca519),timeoutMs);}function resetTimer(_0x2731aa){const _0x1f2892=a2_0x5238f1;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x2731aa['setStateAsync'](_0x1f2892(0x127),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x438455){const _0x519710=a2_0x5238f1;alarmStage=0x1,await _0x438455[_0x519710(0x13d)](_0x519710(0x127),{'val':_0x519710(0x124),'ack':!![]});const _0x18bfbb=_0x519710(0x132)+currentMonitoredRoom+_0x519710(0x12f);_0x438455[_0x519710(0x131)][_0x519710(0x117)](_0x519710(0x141)+_0x18bfbb),await setup[_0x519710(0x11c)](_0x438455,_0x519710(0x13b)+_0x18bfbb),activeTimer=setTimeout(()=>triggerAlarm(_0x438455),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x1425d0){const _0xef0260=a2_0x5238f1;alarmStage=0x2,await _0x1425d0[_0xef0260(0x13d)]('analysis.safety.deadMan.alarmState',{'val':_0xef0260(0x122),'ack':!![]});const _0x76bd32=_0xef0260(0x133)+currentMonitoredRoom+'!';_0x1425d0['log']['error'](_0xef0260(0x141)+_0x76bd32),await setup['sendNotification'](_0x1425d0,_0x76bd32,![],!![]);}module[a2_0x5238f1(0x12d)]={'updateLocation':updateLocation};