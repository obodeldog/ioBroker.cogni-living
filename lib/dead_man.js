const a2_0x59c93e=a2_0x5e7c;(function(_0x19d596,_0x48cbc5){const _0x3c5d53=a2_0x5e7c,_0x28caf2=_0x19d596();while(!![]){try{const _0x1f3346=-parseInt(_0x3c5d53(0x194))/0x1*(parseInt(_0x3c5d53(0x19a))/0x2)+-parseInt(_0x3c5d53(0x197))/0x3*(-parseInt(_0x3c5d53(0x183))/0x4)+-parseInt(_0x3c5d53(0x185))/0x5+-parseInt(_0x3c5d53(0x1a4))/0x6+parseInt(_0x3c5d53(0x18e))/0x7+parseInt(_0x3c5d53(0x187))/0x8*(-parseInt(_0x3c5d53(0x17a))/0x9)+-parseInt(_0x3c5d53(0x189))/0xa*(-parseInt(_0x3c5d53(0x19f))/0xb);if(_0x1f3346===_0x48cbc5)break;else _0x28caf2['push'](_0x28caf2['shift']());}catch(_0x195447){_0x28caf2['push'](_0x28caf2['shift']());}}}(a2_0x2e33,0xeac70));const a2_0x4ffdf9=(function(){let _0x152109=!![];return function(_0x59b51a,_0x4d2613){const _0x4d8ca1=_0x152109?function(){const _0x259be7=a2_0x5e7c;if(_0x4d2613){const _0x24d345=_0x4d2613[_0x259be7(0x19d)](_0x59b51a,arguments);return _0x4d2613=null,_0x24d345;}}:function(){};return _0x152109=![],_0x4d8ca1;};}()),a2_0x55f99b=a2_0x4ffdf9(this,function(){const _0x4409e1=a2_0x5e7c;return a2_0x55f99b[_0x4409e1(0x1a0)]()[_0x4409e1(0x18d)](_0x4409e1(0x1a3))[_0x4409e1(0x1a0)]()[_0x4409e1(0x18c)](a2_0x55f99b)[_0x4409e1(0x18d)]('(((.+)+)+)+$');});a2_0x55f99b();'use strict';const setup=require(a2_0x59c93e(0x17e));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x440c5b){const _0x1e9df4=a2_0x59c93e;try{const _0x507a8a=await _0x440c5b[_0x1e9df4(0x1a9)](_0x1e9df4(0x1a7));if(_0x507a8a&&_0x507a8a['val'])return JSON[_0x1e9df4(0x1a8)](_0x507a8a[_0x1e9df4(0x182)]);}catch(_0x31692f){}return{};}async function isActive(_0x5911aa){const _0x5df5aa=a2_0x59c93e;try{const _0x275bc9=await _0x5911aa[_0x5df5aa(0x1a9)](_0x5df5aa(0x17f));return _0x275bc9&&_0x275bc9[_0x5df5aa(0x182)];}catch(_0x3aae7a){return![];}}function a2_0x2e33(){const _0x3ba158=['4328jrLXnR','sendNotification','40cESMrm','pre_warn','error','constructor','search','5138840YtjNMu','ðŸ‘¼\x20Schutzengel-Frage:\x20','analysis.safety.deadMan.alarmState','exports','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','alarm','1536619KoLihh','log','info','3rQyIJM','indexOf','warn','2AAgZZE','[DeadMan]\x20Topology\x20check\x20failed:\x20','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','apply','.\x20Alles\x20in\x20Ordnung?','9192931cMnewa','toString','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','toLowerCase','(((.+)+)+)+$','1525326rxcIYJ','default','\x20(Multi-Person\x20Filter)','analysis.safety.deadMan.config','parse','getStateAsync','includes','21753nEKBxQ','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','\x20fÃ¼r\x20','analysis.safety.deadMan.lastIgnored','./setup','analysis.safety.deadMan.active','setStateAsync','now','val','7398368Nnyftj','Ignoriere\x20Bewegung\x20in\x20\x27','9332555graPsU','[DeadMan]\x20'];a2_0x2e33=function(){return _0x3ba158;};return a2_0x2e33();}async function areRoomsConnected(_0x4c64a4,_0x2d2f92,_0x73f7b8){const _0x3452a2=a2_0x59c93e;try{const _0x5aa3c7=await _0x4c64a4[_0x3452a2(0x1a9)]('analysis.topology.structure');if(!_0x5aa3c7||!_0x5aa3c7[_0x3452a2(0x182)])return!![];const _0xa5ecb1=JSON[_0x3452a2(0x1a8)](_0x5aa3c7[_0x3452a2(0x182)]),{rooms:_0x481e41,matrix:_0x3e932c}=_0xa5ecb1;if(!_0x481e41||!_0x3e932c)return!![];const _0x107e3a=_0x481e41[_0x3452a2(0x198)](_0x2d2f92),_0x337a66=_0x481e41['indexOf'](_0x73f7b8);if(_0x107e3a===-0x1||_0x337a66===-0x1)return!![];const _0x171f59=_0x3e932c[_0x107e3a][_0x337a66]>0x0||_0x3e932c[_0x337a66][_0x107e3a]>0x0;return _0x171f59;}catch(_0x365bc9){return _0x4c64a4[_0x3452a2(0x195)]['warn'](_0x3452a2(0x19b)+_0x365bc9['message']),!![];}}async function updateLocation(_0x3fb424,_0x580272){const _0x3bfc27=a2_0x59c93e;if(!_0x580272||_0x580272==='Unknown')return;if(!await isActive(_0x3fb424)){resetTimer(_0x3fb424);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x580272){const _0x4bce31=await areRoomsConnected(_0x3fb424,currentMonitoredRoom,_0x580272);if(!_0x4bce31){const _0x280d97=_0x3bfc27(0x184)+_0x580272+_0x3bfc27(0x17b)+currentMonitoredRoom+'\x27.';_0x3fb424['log'][_0x3bfc27(0x196)](_0x3bfc27(0x186)+_0x280d97+_0x3bfc27(0x1a6)),await _0x3fb424['setStateAsync'](_0x3bfc27(0x17d),{'val':JSON['stringify']({'room':_0x580272,'reason':_0x280d97,'timestamp':Date[_0x3bfc27(0x181)]()}),'ack':!![]});return;}resetTimer(_0x3fb424);}if(!currentMonitoredRoom){await _0x3fb424[_0x3bfc27(0x180)]('analysis.safety.deadMan.currentRoom',{'val':_0x580272,'ack':!![]});const _0x4a99b7=await loadConfig(_0x3fb424),_0x4fa782=_0x580272[_0x3bfc27(0x1a2)]();let _0x18529d=_0x4a99b7[_0x580272]||_0x4a99b7[_0x4fa782];if(!_0x18529d)for(const _0x3d5aad in DEFAULT_TIMEOUTS){if(_0x4fa782[_0x3bfc27(0x179)](_0x3d5aad)){_0x18529d=DEFAULT_TIMEOUTS[_0x3d5aad];break;}}if(!_0x18529d&&_0x4a99b7[_0x3bfc27(0x1a5)])_0x18529d=_0x4a99b7['default'];if(!_0x18529d)return;currentMonitoredRoom=_0x580272,startTimer(_0x3fb424,_0x18529d);}}function startTimer(_0xf4c1e7,_0x1b8279){const _0x16c4ff=a2_0x59c93e;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x1b8279*0x3c*0x3e8,startTime=Date[_0x16c4ff(0x181)](),alarmStage=0x0,_0xf4c1e7[_0x16c4ff(0x195)][_0x16c4ff(0x196)](_0x16c4ff(0x19c)+currentMonitoredRoom+_0x16c4ff(0x17c)+_0x1b8279+'\x20Min.'),_0xf4c1e7[_0x16c4ff(0x180)](_0x16c4ff(0x190),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0xf4c1e7),timeoutMs);}function resetTimer(_0x37d45b){const _0x14d1bd=a2_0x59c93e;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x37d45b['setStateAsync'](_0x14d1bd(0x190),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x4d4b7a){const _0x2a4f10=a2_0x59c93e;alarmStage=0x1,await _0x4d4b7a['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':_0x2a4f10(0x18a),'ack':!![]});const _0x1d32bb=_0x2a4f10(0x1a1)+currentMonitoredRoom+_0x2a4f10(0x19e);_0x4d4b7a[_0x2a4f10(0x195)][_0x2a4f10(0x199)](_0x2a4f10(0x186)+_0x1d32bb),await setup['sendNotification'](_0x4d4b7a,_0x2a4f10(0x18f)+_0x1d32bb),activeTimer=setTimeout(()=>triggerAlarm(_0x4d4b7a),0x5*0x3c*0x3e8);}async function triggerAlarm(_0xd2a06b){const _0x476415=a2_0x59c93e;alarmStage=0x2,await _0xd2a06b['setStateAsync'](_0x476415(0x190),{'val':_0x476415(0x193),'ack':!![]});const _0x5b9347=_0x476415(0x192)+currentMonitoredRoom+'!';_0xd2a06b[_0x476415(0x195)][_0x476415(0x18b)]('[DeadMan]\x20'+_0x5b9347),await setup[_0x476415(0x188)](_0xd2a06b,_0x5b9347,![],!![]);}function a2_0x5e7c(_0x439bff,_0x1c4da6){const _0x404485=a2_0x2e33();return a2_0x5e7c=function(_0x55f99b,_0x4ffdf9){_0x55f99b=_0x55f99b-0x179;let _0x2e33f8=_0x404485[_0x55f99b];return _0x2e33f8;},a2_0x5e7c(_0x439bff,_0x1c4da6);}module[a2_0x59c93e(0x191)]={'updateLocation':updateLocation};