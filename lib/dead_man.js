const a2_0x3582c9=a2_0x52f2;(function(_0x271dcb,_0x5453c2){const _0xc52648=a2_0x52f2,_0x5661f9=_0x271dcb();while(!![]){try{const _0x3e0f87=parseInt(_0xc52648(0xe6))/0x1+parseInt(_0xc52648(0xe4))/0x2+-parseInt(_0xc52648(0xff))/0x3*(parseInt(_0xc52648(0xf9))/0x4)+-parseInt(_0xc52648(0xed))/0x5*(parseInt(_0xc52648(0xe7))/0x6)+parseInt(_0xc52648(0xde))/0x7*(-parseInt(_0xc52648(0x103))/0x8)+-parseInt(_0xc52648(0xf1))/0x9*(parseInt(_0xc52648(0xf5))/0xa)+parseInt(_0xc52648(0xe9))/0xb;if(_0x3e0f87===_0x5453c2)break;else _0x5661f9['push'](_0x5661f9['shift']());}catch(_0x839e8d){_0x5661f9['push'](_0x5661f9['shift']());}}}(a2_0x48fa,0xee967));const a2_0x575197=(function(){let _0x5130fe=!![];return function(_0xcca345,_0x3526df){const _0x2d869c=_0x5130fe?function(){if(_0x3526df){const _0x2bb0a1=_0x3526df['apply'](_0xcca345,arguments);return _0x3526df=null,_0x2bb0a1;}}:function(){};return _0x5130fe=![],_0x2d869c;};}()),a2_0x66d557=a2_0x575197(this,function(){const _0x3ec6de=a2_0x52f2;return a2_0x66d557[_0x3ec6de(0xdb)]()['search'](_0x3ec6de(0xfb))[_0x3ec6de(0xdb)]()[_0x3ec6de(0x101)](a2_0x66d557)[_0x3ec6de(0x107)](_0x3ec6de(0xfb));});function a2_0x48fa(){const _0x5f2ade=['parse','11478071oOaLxj','analysis.safety.deadMan.alarmState','getStateAsync','warn','15EVwqsy','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','indexOf','[DeadMan]\x20','9FBktwK','val','analysis.topology.structure','.\x20Alles\x20in\x20Ordnung?','7783900lYXVVZ','sendNotification','pre_warn','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','14552OfzpLg','analysis.safety.deadMan.currentRoom','(((.+)+)+)+$','\x20fÃ¼r\x20','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','Unknown','1098kYjHga','\x20Min.','constructor','info','1280AQQLfQ','now','./setup','alarm','search','default','exports','toString','setStateAsync','message','21308wTUIJC','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','analysis.safety.deadMan.active','ðŸ‘¼\x20Schutzengel-Frage:\x20','toLowerCase','includes','3605584LezmgU','log','1346216XiYJsu','1236552PsPdWO'];a2_0x48fa=function(){return _0x5f2ade;};return a2_0x48fa();}a2_0x66d557();function a2_0x52f2(_0x5c5486,_0x4fd1c6){const _0x16834f=a2_0x48fa();return a2_0x52f2=function(_0x66d557,_0x575197){_0x66d557=_0x66d557-0xda;let _0x48fab0=_0x16834f[_0x66d557];return _0x48fab0;},a2_0x52f2(_0x5c5486,_0x4fd1c6);}'use strict';const setup=require(a2_0x3582c9(0x105));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x18aa41){const _0x426d16=a2_0x3582c9;try{const _0xeb333f=await _0x18aa41[_0x426d16(0xeb)]('analysis.safety.deadMan.config');if(_0xeb333f&&_0xeb333f[_0x426d16(0xf2)])return JSON[_0x426d16(0xe8)](_0xeb333f[_0x426d16(0xf2)]);}catch(_0x587502){}return{};}async function isActive(_0x512768){const _0x14aca6=a2_0x3582c9;try{const _0x319017=await _0x512768[_0x14aca6(0xeb)](_0x14aca6(0xe0));return _0x319017&&_0x319017[_0x14aca6(0xf2)];}catch(_0x2a4cd){return![];}}async function areRoomsConnected(_0x4b9fc1,_0x5c191d,_0x39df8f){const _0x18e88f=a2_0x3582c9;try{const _0x94a377=await _0x4b9fc1[_0x18e88f(0xeb)](_0x18e88f(0xf3));if(!_0x94a377||!_0x94a377[_0x18e88f(0xf2)])return!![];const _0x5c1698=JSON[_0x18e88f(0xe8)](_0x94a377['val']),{rooms:_0x10e9cf,matrix:_0xaf67f2}=_0x5c1698;if(!_0x10e9cf||!_0xaf67f2)return!![];const _0x49464c=_0x10e9cf['indexOf'](_0x5c191d),_0x24e25d=_0x10e9cf[_0x18e88f(0xef)](_0x39df8f);if(_0x49464c===-0x1||_0x24e25d===-0x1)return!![];const _0x1f4baf=_0xaf67f2[_0x49464c][_0x24e25d]>0x0||_0xaf67f2[_0x24e25d][_0x49464c]>0x0;return _0x1f4baf;}catch(_0x3fbe0c){return _0x4b9fc1[_0x18e88f(0xe5)][_0x18e88f(0xec)]('[DeadMan]\x20Topology\x20check\x20failed:\x20'+_0x3fbe0c[_0x18e88f(0xdd)]),!![];}}async function updateLocation(_0x3b323d,_0x41118e){const _0x5a4558=a2_0x3582c9;if(!_0x41118e||_0x41118e===_0x5a4558(0xfe))return;if(!await isActive(_0x3b323d)){resetTimer(_0x3b323d);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x41118e){const _0x1965ad=await areRoomsConnected(_0x3b323d,currentMonitoredRoom,_0x41118e);if(!_0x1965ad){_0x3b323d[_0x5a4558(0xe5)][_0x5a4558(0x102)](_0x5a4558(0xee)+_0x41118e+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+'\x27.\x20(Multi-Person\x20Filter)');return;}resetTimer(_0x3b323d);}if(!currentMonitoredRoom){await _0x3b323d[_0x5a4558(0xdc)](_0x5a4558(0xfa),{'val':_0x41118e,'ack':!![]});const _0x4c9d09=await loadConfig(_0x3b323d),_0x5e9007=_0x41118e[_0x5a4558(0xe2)]();let _0x2c0716=_0x4c9d09[_0x41118e]||_0x4c9d09[_0x5e9007];if(!_0x2c0716)for(const _0x48d7b8 in DEFAULT_TIMEOUTS){if(_0x5e9007[_0x5a4558(0xe3)](_0x48d7b8)){_0x2c0716=DEFAULT_TIMEOUTS[_0x48d7b8];break;}}if(!_0x2c0716&&_0x4c9d09[_0x5a4558(0x108)])_0x2c0716=_0x4c9d09['default'];if(!_0x2c0716)return;currentMonitoredRoom=_0x41118e,startTimer(_0x3b323d,_0x2c0716);}}function startTimer(_0x566f6d,_0x419ed7){const _0x11fde6=a2_0x3582c9;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x419ed7*0x3c*0x3e8,startTime=Date[_0x11fde6(0x104)](),alarmStage=0x0,_0x566f6d[_0x11fde6(0xe5)][_0x11fde6(0x102)](_0x11fde6(0xf8)+currentMonitoredRoom+_0x11fde6(0xfc)+_0x419ed7+_0x11fde6(0x100)),_0x566f6d[_0x11fde6(0xdc)](_0x11fde6(0xea),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x566f6d),timeoutMs);}function resetTimer(_0x553d40){const _0x5688a4=a2_0x3582c9;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x553d40[_0x5688a4(0xdc)](_0x5688a4(0xea),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x48678a){const _0x445270=a2_0x3582c9;alarmStage=0x1,await _0x48678a['setStateAsync'](_0x445270(0xea),{'val':_0x445270(0xf7),'ack':!![]});const _0x136aba=_0x445270(0xfd)+currentMonitoredRoom+_0x445270(0xf4);_0x48678a['log'][_0x445270(0xec)](_0x445270(0xf0)+_0x136aba),await setup[_0x445270(0xf6)](_0x48678a,_0x445270(0xe1)+_0x136aba),activeTimer=setTimeout(()=>triggerAlarm(_0x48678a),0x5*0x3c*0x3e8);}async function triggerAlarm(_0xb0fdfd){const _0x211851=a2_0x3582c9;alarmStage=0x2,await _0xb0fdfd[_0x211851(0xdc)](_0x211851(0xea),{'val':_0x211851(0x106),'ack':!![]});const _0x2816c4=_0x211851(0xdf)+currentMonitoredRoom+'!';_0xb0fdfd[_0x211851(0xe5)]['error'](_0x211851(0xf0)+_0x2816c4),await setup[_0x211851(0xf6)](_0xb0fdfd,_0x2816c4,![],!![]);}module[a2_0x3582c9(0xda)]={'updateLocation':updateLocation};