const a2_0x57e36b=a2_0x285f;function a2_0x285f(_0x1b8c24,_0x316e77){const _0x2f4db7=a2_0x2724();return a2_0x285f=function(_0x3ee4a5,_0x4657bb){_0x3ee4a5=_0x3ee4a5-0x1f2;let _0x27248c=_0x2f4db7[_0x3ee4a5];return _0x27248c;},a2_0x285f(_0x1b8c24,_0x316e77);}(function(_0x1b1470,_0xe664e2){const _0x299aa8=a2_0x285f,_0xf5816e=_0x1b1470();while(!![]){try{const _0x55f880=parseInt(_0x299aa8(0x1f3))/0x1+-parseInt(_0x299aa8(0x20e))/0x2+parseInt(_0x299aa8(0x1f9))/0x3*(parseInt(_0x299aa8(0x201))/0x4)+-parseInt(_0x299aa8(0x1fc))/0x5+parseInt(_0x299aa8(0x1f2))/0x6+-parseInt(_0x299aa8(0x202))/0x7+parseInt(_0x299aa8(0x20a))/0x8*(-parseInt(_0x299aa8(0x216))/0x9);if(_0x55f880===_0xe664e2)break;else _0xf5816e['push'](_0xf5816e['shift']());}catch(_0x64c1c3){_0xf5816e['push'](_0xf5816e['shift']());}}}(a2_0x2724,0x75123));const a2_0x4657bb=(function(){let _0x5a3aff=!![];return function(_0x4acebd,_0x583c65){const _0x4d21b4=_0x5a3aff?function(){const _0x53d218=a2_0x285f;if(_0x583c65){const _0x1b3c58=_0x583c65[_0x53d218(0x20d)](_0x4acebd,arguments);return _0x583c65=null,_0x1b3c58;}}:function(){};return _0x5a3aff=![],_0x4d21b4;};}()),a2_0x3ee4a5=a2_0x4657bb(this,function(){const _0xf32d0=a2_0x285f;return a2_0x3ee4a5[_0xf32d0(0x212)]()[_0xf32d0(0x218)]('(((.+)+)+)+$')['toString']()[_0xf32d0(0x1fa)](a2_0x3ee4a5)[_0xf32d0(0x218)](_0xf32d0(0x213));});a2_0x3ee4a5();'use strict';const setup=require(a2_0x57e36b(0x1f4));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x103e15){const _0x2d4fc8=a2_0x57e36b;try{const _0x9efc21=await _0x103e15[_0x2d4fc8(0x204)]('analysis.safety.deadMan.config');if(_0x9efc21&&_0x9efc21[_0x2d4fc8(0x217)])return JSON[_0x2d4fc8(0x20b)](_0x9efc21['val']);}catch(_0x3fa11f){}return{};}async function isActive(_0x31c9f9){const _0x25d032=a2_0x57e36b;try{const _0x200247=await _0x31c9f9[_0x25d032(0x204)](_0x25d032(0x1fe));return _0x200247&&_0x200247[_0x25d032(0x217)];}catch(_0x508696){return![];}}async function areRoomsConnected(_0x42cc44,_0x5002a6,_0x546d23){const _0x2daf0b=a2_0x57e36b;try{const _0x582341=await _0x42cc44[_0x2daf0b(0x204)](_0x2daf0b(0x1f8));if(!_0x582341||!_0x582341[_0x2daf0b(0x217)])return!![];const _0x1ac380=JSON[_0x2daf0b(0x20b)](_0x582341['val']),{rooms:_0x407bf4,matrix:_0x4335d0}=_0x1ac380;if(!_0x407bf4||!_0x4335d0)return!![];const _0x25fc25=_0x407bf4[_0x2daf0b(0x21c)](_0x5002a6),_0x373c76=_0x407bf4[_0x2daf0b(0x21c)](_0x546d23);if(_0x25fc25===-0x1||_0x373c76===-0x1)return!![];const _0x510ea1=_0x4335d0[_0x25fc25][_0x373c76]>0x0||_0x4335d0[_0x373c76][_0x25fc25]>0x0;return _0x510ea1;}catch(_0x5496b9){return _0x42cc44[_0x2daf0b(0x20f)]['warn'](_0x2daf0b(0x206)+_0x5496b9[_0x2daf0b(0x214)]),!![];}}async function updateLocation(_0x58294b,_0x42d358){const _0x4dd643=a2_0x57e36b;if(!_0x42d358||_0x42d358===_0x4dd643(0x219))return;if(!await isActive(_0x58294b)){resetTimer(_0x58294b);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x42d358){const _0x45f4c1=await areRoomsConnected(_0x58294b,currentMonitoredRoom,_0x42d358);if(!_0x45f4c1){_0x58294b[_0x4dd643(0x20f)][_0x4dd643(0x21b)]('[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27'+_0x42d358+_0x4dd643(0x205)+currentMonitoredRoom+_0x4dd643(0x21a));return;}resetTimer(_0x58294b);}if(!currentMonitoredRoom){await _0x58294b[_0x4dd643(0x1ff)](_0x4dd643(0x211),{'val':_0x42d358,'ack':!![]});const _0x30b15e=await loadConfig(_0x58294b),_0x42aaca=_0x42d358[_0x4dd643(0x215)]();let _0x53f947=_0x30b15e[_0x42d358]||_0x30b15e[_0x42aaca];if(!_0x53f947)for(const _0x451b27 in DEFAULT_TIMEOUTS){if(_0x42aaca[_0x4dd643(0x1f5)](_0x451b27)){_0x53f947=DEFAULT_TIMEOUTS[_0x451b27];break;}}if(!_0x53f947&&_0x30b15e[_0x4dd643(0x20c)])_0x53f947=_0x30b15e[_0x4dd643(0x20c)];if(!_0x53f947)return;currentMonitoredRoom=_0x42d358,startTimer(_0x58294b,_0x53f947);}}function startTimer(_0x36f965,_0x1e49b5){const _0x31d677=a2_0x57e36b;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x1e49b5*0x3c*0x3e8,startTime=Date['now'](),alarmStage=0x0,_0x36f965[_0x31d677(0x20f)]['info'](_0x31d677(0x1f6)+currentMonitoredRoom+'\x20f√ºr\x20'+_0x1e49b5+_0x31d677(0x207)),_0x36f965[_0x31d677(0x1ff)](_0x31d677(0x203),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x36f965),timeoutMs);}function resetTimer(_0x4064d9){if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x4064d9['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x38054d){const _0x3a06c3=a2_0x57e36b;alarmStage=0x1,await _0x38054d[_0x3a06c3(0x1ff)](_0x3a06c3(0x203),{'val':_0x3a06c3(0x1fd),'ack':!![]});const _0x59125b=_0x3a06c3(0x1fb)+currentMonitoredRoom+_0x3a06c3(0x210);_0x38054d[_0x3a06c3(0x20f)][_0x3a06c3(0x208)]('[DeadMan]\x20'+_0x59125b),await setup['sendNotification'](_0x38054d,'üëº\x20Schutzengel-Frage:\x20'+_0x59125b),activeTimer=setTimeout(()=>triggerAlarm(_0x38054d),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x58ef60){const _0x4223d3=a2_0x57e36b;alarmStage=0x2,await _0x58ef60[_0x4223d3(0x1ff)](_0x4223d3(0x203),{'val':_0x4223d3(0x209),'ack':!![]});const _0x3ac37a='üö®\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x58ef60['log'][_0x4223d3(0x1f7)]('[DeadMan]\x20'+_0x3ac37a),await setup['sendNotification'](_0x58ef60,_0x3ac37a,![],!![]);}function a2_0x2724(){const _0x234f41=['\x27.\x20(Multi-Person\x20Filter)','info','indexOf','888606GTnASv','708117mVcUbP','./setup','includes','üëº\x20Schutzengel:\x20√úberwache\x20','error','analysis.topology.structure','1389RtCAdJ','constructor','‚è≥\x20ACHTUNG:\x20Ungew√∂hnlich\x20lange\x20Inaktivit√§t\x20in\x20','1725125cXynPA','pre_warn','analysis.safety.deadMan.active','setStateAsync','exports','6900oYqPoP','3874584QCdeiN','analysis.safety.deadMan.alarmState','getStateAsync','\x27.\x20Nicht\x20verbunden\x20mit\x20√ºberwachtem\x20\x27','[DeadMan]\x20Topology\x20check\x20failed:\x20','\x20Min.','warn','alarm','1107856RBTCjP','parse','default','apply','276702cmHHic','log','.\x20Alles\x20in\x20Ordnung?','analysis.safety.deadMan.currentRoom','toString','(((.+)+)+)+$','message','toLowerCase','9gzMYpm','val','search','Unknown'];a2_0x2724=function(){return _0x234f41;};return a2_0x2724();}module[a2_0x57e36b(0x200)]={'updateLocation':updateLocation};