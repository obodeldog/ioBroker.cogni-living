const a2_0x159998=a2_0x51e0;(function(_0xef3c6d,_0x21928d){const _0x31aee5=a2_0x51e0,_0x3b7ad6=_0xef3c6d();while(!![]){try{const _0x2c15ad=parseInt(_0x31aee5(0x107))/0x1*(parseInt(_0x31aee5(0xe4))/0x2)+parseInt(_0x31aee5(0x109))/0x3*(-parseInt(_0x31aee5(0x103))/0x4)+parseInt(_0x31aee5(0xf7))/0x5+parseInt(_0x31aee5(0xfc))/0x6*(parseInt(_0x31aee5(0xec))/0x7)+-parseInt(_0x31aee5(0xf9))/0x8+parseInt(_0x31aee5(0xf6))/0x9+parseInt(_0x31aee5(0x102))/0xa*(-parseInt(_0x31aee5(0xfa))/0xb);if(_0x2c15ad===_0x21928d)break;else _0x3b7ad6['push'](_0x3b7ad6['shift']());}catch(_0x23bd92){_0x3b7ad6['push'](_0x3b7ad6['shift']());}}}(a2_0xd262,0xe0845));const a2_0x2f1c54=(function(){let _0x2c6a00=!![];return function(_0x163340,_0xf25b28){const _0x109043=_0x2c6a00?function(){const _0x6d8cfc=a2_0x51e0;if(_0xf25b28){const _0x652998=_0xf25b28[_0x6d8cfc(0xf1)](_0x163340,arguments);return _0xf25b28=null,_0x652998;}}:function(){};return _0x2c6a00=![],_0x109043;};}()),a2_0x19b265=a2_0x2f1c54(this,function(){const _0x4f853d=a2_0x51e0;return a2_0x19b265[_0x4f853d(0xef)]()[_0x4f853d(0xfd)]('(((.+)+)+)+$')['toString']()[_0x4f853d(0x105)](a2_0x19b265)['search'](_0x4f853d(0x108));});a2_0x19b265();'use strict';function a2_0xd262(){const _0x3e1ae3=['ðŸ‘¼\x20Schutzengel-Frage:\x20','apply','.\x20Alles\x20in\x20Ordnung?','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','warn','analysis.safety.deadMan.config','13260321gNFVYN','4728465eQqdiC','sendNotification','11644872vnFBdg','11zTbdhe','analysis.safety.deadMan.currentRoom','180hZmvwT','search','info','[DeadMan]\x20','alarm','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','4413070GgGHbL','4aIdDYX','analysis.safety.deadMan.alarmState','constructor','parse','1037EIFWmw','(((.+)+)+)+$','4079604adTxnz','val','error','toLowerCase','618zLczJo','log','setStateAsync','analysis.safety.deadMan.active','getStateAsync','pre_warn','debug','now','335279SxeUCr','./setup','includes','toString'];a2_0xd262=function(){return _0x3e1ae3;};return a2_0xd262();}const setup=require(a2_0x159998(0xed));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x35a3bc){const _0x2e4065=a2_0x159998;try{const _0x4d41ca=await _0x35a3bc[_0x2e4065(0xe8)](_0x2e4065(0xf5));if(_0x4d41ca&&_0x4d41ca['val'])return JSON[_0x2e4065(0x106)](_0x4d41ca[_0x2e4065(0xe1)]);}catch(_0x4bd83e){}return{};}async function isActive(_0x4165c3){const _0x57e5a8=a2_0x159998;try{const _0x2b8a83=await _0x4165c3['getStateAsync'](_0x57e5a8(0xe7));return _0x2b8a83&&_0x2b8a83['val'];}catch(_0x22267d){return![];}}async function updateLocation(_0x2b8117,_0x4a0280){const _0x79aa9=a2_0x159998;if(!_0x4a0280||_0x4a0280==='Unknown')return;if(!await isActive(_0x2b8117)){resetTimer(_0x2b8117);return;}if(currentMonitoredRoom!==_0x4a0280){resetTimer(_0x2b8117),await _0x2b8117[_0x79aa9(0xe6)](_0x79aa9(0xfb),{'val':_0x4a0280,'ack':!![]});const _0x4f29fa=await loadConfig(_0x2b8117),_0x6f727c=_0x4a0280[_0x79aa9(0xe3)]();let _0x2cc5fc=_0x4f29fa[_0x4a0280]||_0x4f29fa[_0x6f727c];if(!_0x2cc5fc)for(const _0x9c715a in DEFAULT_TIMEOUTS){if(_0x6f727c[_0x79aa9(0xee)](_0x9c715a)){_0x2cc5fc=DEFAULT_TIMEOUTS[_0x9c715a];break;}}!_0x2cc5fc&&_0x4f29fa['default']&&(_0x2cc5fc=_0x4f29fa['default']);if(!_0x2cc5fc){_0x2b8117['log'][_0x79aa9(0xea)](_0x79aa9(0xff)+_0x4a0280+'\x20ist\x20sicher\x20(Kein\x20Timer).\x20Ãœberwachung\x20pausiert.');return;}currentMonitoredRoom=_0x4a0280,startTimer(_0x2b8117,_0x2cc5fc);}}function startTimer(_0x383e4e,_0x47cada){const _0x5aa56e=a2_0x159998;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x47cada*0x3c*0x3e8,startTime=Date[_0x5aa56e(0xeb)](),alarmStage=0x0,_0x383e4e[_0x5aa56e(0xe5)][_0x5aa56e(0xfe)](_0x5aa56e(0xf3)+currentMonitoredRoom+'\x20fÃ¼r\x20'+_0x47cada+'\x20Min.'),_0x383e4e['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x383e4e),timeoutMs);}function resetTimer(_0x7c0b30){const _0x18f358=a2_0x159998;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x7c0b30['setStateAsync'](_0x18f358(0x104),{'val':'ok','ack':!![]});}function a2_0x51e0(_0x3fe0e2,_0x129571){const _0x4c758e=a2_0xd262();return a2_0x51e0=function(_0x19b265,_0x2f1c54){_0x19b265=_0x19b265-0xe1;let _0xd2626b=_0x4c758e[_0x19b265];return _0xd2626b;},a2_0x51e0(_0x3fe0e2,_0x129571);}async function triggerPreWarn(_0x4ea32c){const _0x2333ad=a2_0x159998;alarmStage=0x1,await _0x4ea32c[_0x2333ad(0xe6)](_0x2333ad(0x104),{'val':_0x2333ad(0xe9),'ack':!![]});const _0x12a468=_0x2333ad(0x101)+currentMonitoredRoom+_0x2333ad(0xf2);_0x4ea32c['log'][_0x2333ad(0xf4)]('[DeadMan]\x20'+_0x12a468),await setup['sendNotification'](_0x4ea32c,_0x2333ad(0xf0)+_0x12a468),activeTimer=setTimeout(()=>triggerAlarm(_0x4ea32c),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x2dfd78){const _0x19794f=a2_0x159998;alarmStage=0x2,await _0x2dfd78[_0x19794f(0xe6)](_0x19794f(0x104),{'val':_0x19794f(0x100),'ack':!![]});const _0xf7f280='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x2dfd78[_0x19794f(0xe5)][_0x19794f(0xe2)](_0x19794f(0xff)+_0xf7f280),await setup[_0x19794f(0xf8)](_0x2dfd78,_0xf7f280,![],!![]);}module['exports']={'updateLocation':updateLocation};