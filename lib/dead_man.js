const a2_0x448826=a2_0x5472;(function(_0x277a51,_0x524a8f){const _0x4e9139=a2_0x5472,_0x31636d=_0x277a51();while(!![]){try{const _0x28b3e0=-parseInt(_0x4e9139(0x204))/0x1*(-parseInt(_0x4e9139(0x1f4))/0x2)+parseInt(_0x4e9139(0x20f))/0x3*(-parseInt(_0x4e9139(0x1ef))/0x4)+parseInt(_0x4e9139(0x201))/0x5+-parseInt(_0x4e9139(0x1fd))/0x6+parseInt(_0x4e9139(0x1f7))/0x7+parseInt(_0x4e9139(0x1ff))/0x8*(-parseInt(_0x4e9139(0x20a))/0x9)+-parseInt(_0x4e9139(0x208))/0xa;if(_0x28b3e0===_0x524a8f)break;else _0x31636d['push'](_0x31636d['shift']());}catch(_0x5706e8){_0x31636d['push'](_0x31636d['shift']());}}}(a2_0x1d12,0x1f240));const a2_0x328376=(function(){let _0x3be34e=!![];return function(_0x51e1e9,_0x3b2f8d){const _0x502063=_0x3be34e?function(){const _0x1d2c34=a2_0x5472;if(_0x3b2f8d){const _0x5c9e5f=_0x3b2f8d[_0x1d2c34(0x1f5)](_0x51e1e9,arguments);return _0x3b2f8d=null,_0x5c9e5f;}}:function(){};return _0x3be34e=![],_0x502063;};}()),a2_0x398869=a2_0x328376(this,function(){const _0xb5a89b=a2_0x5472;return a2_0x398869[_0xb5a89b(0x215)]()[_0xb5a89b(0x21b)](_0xb5a89b(0x218))[_0xb5a89b(0x215)]()[_0xb5a89b(0x200)](a2_0x398869)['search']('(((.+)+)+)+$');});function a2_0x1d12(){const _0x522751=['info','ðŸ‘¼\x20Schutzengel-Frage:\x20','analysis.topology.structure','setStateAsync','warn','toString','getStateAsync','error','(((.+)+)+)+$','toLowerCase','Unknown','search','752ydbnUK','exports','./setup','analysis.safety.deadMan.alarmState','\x20fÃ¼r\x20','2wLtIKu','apply','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','1062264seSZnE','[DeadMan]\x20','\x20Min.','analysis.safety.deadMan.currentRoom','sendNotification','alarm','1119504fMtate','[DeadMan]\x20Topology\x20check\x20failed:\x20','232crLWzH','constructor','1209350lPjAuS','val','\x27.\x20(Multi-Person\x20Filter)','249955ovNuaZ','parse','log','message','1749340mFwIgj','now','6759RbwNQe','analysis.safety.deadMan.active','default','.\x20Alles\x20in\x20Ordnung?','analysis.safety.deadMan.config','2118fZxGKm'];a2_0x1d12=function(){return _0x522751;};return a2_0x1d12();}a2_0x398869();'use strict';const setup=require(a2_0x448826(0x1f1));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x4a7561){const _0x263d4e=a2_0x448826;try{const _0x2ac166=await _0x4a7561[_0x263d4e(0x216)](_0x263d4e(0x20e));if(_0x2ac166&&_0x2ac166['val'])return JSON[_0x263d4e(0x205)](_0x2ac166[_0x263d4e(0x202)]);}catch(_0x388532){}return{};}async function isActive(_0x37ba41){const _0x2c691a=a2_0x448826;try{const _0x4770bd=await _0x37ba41['getStateAsync'](_0x2c691a(0x20b));return _0x4770bd&&_0x4770bd[_0x2c691a(0x202)];}catch(_0x1bff8e){return![];}}async function areRoomsConnected(_0x1fe79b,_0x70d2b9,_0x4e6f49){const _0x537407=a2_0x448826;try{const _0x2ebfd5=await _0x1fe79b[_0x537407(0x216)](_0x537407(0x212));if(!_0x2ebfd5||!_0x2ebfd5[_0x537407(0x202)])return!![];const _0x90b700=JSON['parse'](_0x2ebfd5[_0x537407(0x202)]),{rooms:_0x230540,matrix:_0xc64a4d}=_0x90b700;if(!_0x230540||!_0xc64a4d)return!![];const _0x1983a1=_0x230540['indexOf'](_0x70d2b9),_0x33b270=_0x230540['indexOf'](_0x4e6f49);if(_0x1983a1===-0x1||_0x33b270===-0x1)return!![];const _0x36ce4c=_0xc64a4d[_0x1983a1][_0x33b270]>0x0||_0xc64a4d[_0x33b270][_0x1983a1]>0x0;return _0x36ce4c;}catch(_0x4d6cbf){return _0x1fe79b[_0x537407(0x206)][_0x537407(0x214)](_0x537407(0x1fe)+_0x4d6cbf[_0x537407(0x207)]),!![];}}async function updateLocation(_0xeaaed9,_0x45412f){const _0x189c24=a2_0x448826;if(!_0x45412f||_0x45412f===_0x189c24(0x21a))return;if(!await isActive(_0xeaaed9)){resetTimer(_0xeaaed9);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x45412f){const _0x1f5468=await areRoomsConnected(_0xeaaed9,currentMonitoredRoom,_0x45412f);if(!_0x1f5468){_0xeaaed9[_0x189c24(0x206)][_0x189c24(0x210)]('[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27'+_0x45412f+'\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27'+currentMonitoredRoom+_0x189c24(0x203));return;}resetTimer(_0xeaaed9);}if(!currentMonitoredRoom){await _0xeaaed9['setStateAsync'](_0x189c24(0x1fa),{'val':_0x45412f,'ack':!![]});const _0x215471=await loadConfig(_0xeaaed9),_0x269c3c=_0x45412f[_0x189c24(0x219)]();let _0x1f1253=_0x215471[_0x45412f]||_0x215471[_0x269c3c];if(!_0x1f1253)for(const _0x4438b1 in DEFAULT_TIMEOUTS){if(_0x269c3c['includes'](_0x4438b1)){_0x1f1253=DEFAULT_TIMEOUTS[_0x4438b1];break;}}if(!_0x1f1253&&_0x215471[_0x189c24(0x20c)])_0x1f1253=_0x215471[_0x189c24(0x20c)];if(!_0x1f1253)return;currentMonitoredRoom=_0x45412f,startTimer(_0xeaaed9,_0x1f1253);}}function startTimer(_0x2ad612,_0x17a945){const _0x83f54a=a2_0x448826;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x17a945*0x3c*0x3e8,startTime=Date[_0x83f54a(0x209)](),alarmStage=0x0,_0x2ad612[_0x83f54a(0x206)][_0x83f54a(0x210)]('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+_0x83f54a(0x1f3)+_0x17a945+_0x83f54a(0x1f9)),_0x2ad612[_0x83f54a(0x213)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x2ad612),timeoutMs);}function a2_0x5472(_0x5214be,_0x4626b9){const _0x27fcf0=a2_0x1d12();return a2_0x5472=function(_0x398869,_0x328376){_0x398869=_0x398869-0x1ef;let _0x1d1295=_0x27fcf0[_0x398869];return _0x1d1295;},a2_0x5472(_0x5214be,_0x4626b9);}function resetTimer(_0x42c3a8){const _0x430ef4=a2_0x448826;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x42c3a8[_0x430ef4(0x213)](_0x430ef4(0x1f2),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x99de9f){const _0x1d296b=a2_0x448826;alarmStage=0x1,await _0x99de9f[_0x1d296b(0x213)](_0x1d296b(0x1f2),{'val':'pre_warn','ack':!![]});const _0x263abb='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x1d296b(0x20d);_0x99de9f['log'][_0x1d296b(0x214)](_0x1d296b(0x1f8)+_0x263abb),await setup['sendNotification'](_0x99de9f,_0x1d296b(0x211)+_0x263abb),activeTimer=setTimeout(()=>triggerAlarm(_0x99de9f),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x85580f){const _0x4eec82=a2_0x448826;alarmStage=0x2,await _0x85580f[_0x4eec82(0x213)](_0x4eec82(0x1f2),{'val':_0x4eec82(0x1fc),'ack':!![]});const _0x4d5752=_0x4eec82(0x1f6)+currentMonitoredRoom+'!';_0x85580f[_0x4eec82(0x206)][_0x4eec82(0x217)](_0x4eec82(0x1f8)+_0x4d5752),await setup[_0x4eec82(0x1fb)](_0x85580f,_0x4d5752,![],!![]);}module[a2_0x448826(0x1f0)]={'updateLocation':updateLocation};