const a2_0x154322=a2_0x4a90;function a2_0x4a90(_0x3408de,_0x3047c8){const _0x2e765d=a2_0x1459();return a2_0x4a90=function(_0x285939,_0x29a073){_0x285939=_0x285939-0xbb;let _0x1459f9=_0x2e765d[_0x285939];return _0x1459f9;},a2_0x4a90(_0x3408de,_0x3047c8);}(function(_0x4dc1bf,_0x5319c3){const _0x2c29a2=a2_0x4a90,_0x28b4ed=_0x4dc1bf();while(!![]){try{const _0x2fc0e3=-parseInt(_0x2c29a2(0xcd))/0x1*(parseInt(_0x2c29a2(0xc6))/0x2)+-parseInt(_0x2c29a2(0xca))/0x3*(parseInt(_0x2c29a2(0xc0))/0x4)+-parseInt(_0x2c29a2(0xc9))/0x5+parseInt(_0x2c29a2(0xce))/0x6*(-parseInt(_0x2c29a2(0xe4))/0x7)+parseInt(_0x2c29a2(0xbd))/0x8+-parseInt(_0x2c29a2(0xbb))/0x9+parseInt(_0x2c29a2(0xeb))/0xa*(parseInt(_0x2c29a2(0xdc))/0xb);if(_0x2fc0e3===_0x5319c3)break;else _0x28b4ed['push'](_0x28b4ed['shift']());}catch(_0xb82c4f){_0x28b4ed['push'](_0x28b4ed['shift']());}}}(a2_0x1459,0xdf4c4));const a2_0x29a073=(function(){let _0xf76f91=!![];return function(_0x5aa35c,_0x279ce){const _0x1c89b6=_0xf76f91?function(){const _0x59a565=a2_0x4a90;if(_0x279ce){const _0x203908=_0x279ce[_0x59a565(0xdf)](_0x5aa35c,arguments);return _0x279ce=null,_0x203908;}}:function(){};return _0xf76f91=![],_0x1c89b6;};}()),a2_0x285939=a2_0x29a073(this,function(){const _0x23fa13=a2_0x4a90;return a2_0x285939[_0x23fa13(0xe7)]()['search'](_0x23fa13(0xd9))[_0x23fa13(0xe7)]()[_0x23fa13(0xcf)](a2_0x285939)[_0x23fa13(0xea)](_0x23fa13(0xd9));});a2_0x285939();'use strict';const setup=require(a2_0x154322(0xc7));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x1125ec){const _0x56728b=a2_0x154322;try{const _0x5c1902=await _0x1125ec[_0x56728b(0xe2)](_0x56728b(0xcb));if(_0x5c1902&&_0x5c1902[_0x56728b(0xd5)])return JSON[_0x56728b(0xe8)](_0x5c1902[_0x56728b(0xd5)]);}catch(_0x19d1f9){}return{};}async function isActive(_0x33a4ad){const _0x2340e2=a2_0x154322;try{const _0x28613b=await _0x33a4ad['getStateAsync'](_0x2340e2(0xe1));return _0x28613b&&_0x28613b['val'];}catch(_0xbf6a6a){return![];}}async function areRoomsConnected(_0x47d63e,_0x19f429,_0x173167){const _0x2e37bd=a2_0x154322;try{const _0x2a9aef=await _0x47d63e[_0x2e37bd(0xe2)](_0x2e37bd(0xd1));if(!_0x2a9aef||!_0x2a9aef['val'])return!![];const _0x907ad8=JSON[_0x2e37bd(0xe8)](_0x2a9aef[_0x2e37bd(0xd5)]),{rooms:_0x44b8da,matrix:_0x5a3123}=_0x907ad8;if(!_0x44b8da||!_0x5a3123)return!![];const _0x481a3b=_0x44b8da[_0x2e37bd(0xde)](_0x19f429),_0x520819=_0x44b8da['indexOf'](_0x173167);if(_0x481a3b===-0x1||_0x520819===-0x1)return!![];const _0x512de2=_0x5a3123[_0x481a3b][_0x520819]>0x0||_0x5a3123[_0x520819][_0x481a3b]>0x0;return _0x512de2;}catch(_0xde2266){return _0x47d63e[_0x2e37bd(0xe6)][_0x2e37bd(0xe3)](_0x2e37bd(0xd6)+_0xde2266[_0x2e37bd(0xd7)]),!![];}}function a2_0x1459(){const _0x6d9a8b=['analysis.safety.deadMan.config','ðŸ‘¼\x20Schutzengel-Frage:\x20','13DDufqd','8631654DsEHfK','constructor','analysis.safety.deadMan.lastIgnored','analysis.topology.structure','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','Ignoriere\x20Bewegung\x20in\x20\x27','exports','val','[DeadMan]\x20Topology\x20check\x20failed:\x20','message','default','(((.+)+)+)+$','\x20fÃ¼r\x20','sendNotification','441782yZmiVc','analysis.safety.deadMan.currentRoom','indexOf','apply','[DeadMan]\x20','analysis.safety.deadMan.active','getStateAsync','warn','7NYQiCF','toLowerCase','log','toString','parse','\x20Min.','search','1140gYBktl','Unknown','9425376qKXKul','setStateAsync','9823848ygadxx','pre_warn','analysis.safety.deadMan.alarmState','16EXQRbE','info','error','now','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','includes','18916hYAYNE','./setup','\x20(Multi-Person\x20Filter)','7443490zNWqsW','595722aWIKMc'];a2_0x1459=function(){return _0x6d9a8b;};return a2_0x1459();}async function updateLocation(_0x36020c,_0x14663d){const _0x3b06fa=a2_0x154322;if(!_0x14663d||_0x14663d===_0x3b06fa(0xec))return;if(!await isActive(_0x36020c)){resetTimer(_0x36020c);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x14663d){const _0x319ad5=await areRoomsConnected(_0x36020c,currentMonitoredRoom,_0x14663d);if(!_0x319ad5){const _0x43f1d=_0x3b06fa(0xd3)+_0x14663d+_0x3b06fa(0xd2)+currentMonitoredRoom+'\x27.';_0x36020c[_0x3b06fa(0xe6)][_0x3b06fa(0xc1)](_0x3b06fa(0xe0)+_0x43f1d+_0x3b06fa(0xc8)),await _0x36020c['setStateAsync'](_0x3b06fa(0xd0),{'val':JSON['stringify']({'room':_0x14663d,'reason':_0x43f1d,'timestamp':Date[_0x3b06fa(0xc3)]()}),'ack':!![]});return;}resetTimer(_0x36020c);}if(!currentMonitoredRoom){await _0x36020c['setStateAsync'](_0x3b06fa(0xdd),{'val':_0x14663d,'ack':!![]});const _0x20b420=await loadConfig(_0x36020c),_0x1f7aec=_0x14663d[_0x3b06fa(0xe5)]();let _0x257671=_0x20b420[_0x14663d]||_0x20b420[_0x1f7aec];if(!_0x257671)for(const _0xe49962 in DEFAULT_TIMEOUTS){if(_0x1f7aec[_0x3b06fa(0xc5)](_0xe49962)){_0x257671=DEFAULT_TIMEOUTS[_0xe49962];break;}}if(!_0x257671&&_0x20b420[_0x3b06fa(0xd8)])_0x257671=_0x20b420[_0x3b06fa(0xd8)];if(!_0x257671)return;currentMonitoredRoom=_0x14663d,startTimer(_0x36020c,_0x257671);}}function startTimer(_0x108a19,_0x43516a){const _0x398365=a2_0x154322;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x43516a*0x3c*0x3e8,startTime=Date[_0x398365(0xc3)](),alarmStage=0x0,_0x108a19['log']['info']('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+_0x398365(0xda)+_0x43516a+_0x398365(0xe9)),_0x108a19[_0x398365(0xbc)]('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x108a19),timeoutMs);}function resetTimer(_0x4783ce){const _0x180872=a2_0x154322;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x4783ce[_0x180872(0xbc)](_0x180872(0xbf),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x383d18){const _0x28ab65=a2_0x154322;alarmStage=0x1,await _0x383d18[_0x28ab65(0xbc)](_0x28ab65(0xbf),{'val':_0x28ab65(0xbe),'ack':!![]});const _0x47c33a=_0x28ab65(0xc4)+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x383d18[_0x28ab65(0xe6)][_0x28ab65(0xe3)](_0x28ab65(0xe0)+_0x47c33a),await setup['sendNotification'](_0x383d18,_0x28ab65(0xcc)+_0x47c33a),activeTimer=setTimeout(()=>triggerAlarm(_0x383d18),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x40612e){const _0x468e9b=a2_0x154322;alarmStage=0x2,await _0x40612e[_0x468e9b(0xbc)](_0x468e9b(0xbf),{'val':'alarm','ack':!![]});const _0x12da2c='ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20'+currentMonitoredRoom+'!';_0x40612e[_0x468e9b(0xe6)][_0x468e9b(0xc2)](_0x468e9b(0xe0)+_0x12da2c),await setup[_0x468e9b(0xdb)](_0x40612e,_0x12da2c,![],!![]);}module[a2_0x154322(0xd4)]={'updateLocation':updateLocation};