const a2_0x14dc21=a2_0x12bf;function a2_0x12bf(_0x5f0799,_0x54e02e){const _0x31f427=a2_0x5320();return a2_0x12bf=function(_0x2b60aa,_0x2d9d01){_0x2b60aa=_0x2b60aa-0x113;let _0x5320fb=_0x31f427[_0x2b60aa];return _0x5320fb;},a2_0x12bf(_0x5f0799,_0x54e02e);}(function(_0x13c16b,_0x36d6e9){const _0x594793=a2_0x12bf,_0x131730=_0x13c16b();while(!![]){try{const _0x577f4e=-parseInt(_0x594793(0x13f))/0x1+-parseInt(_0x594793(0x118))/0x2+parseInt(_0x594793(0x129))/0x3+-parseInt(_0x594793(0x132))/0x4*(-parseInt(_0x594793(0x13a))/0x5)+parseInt(_0x594793(0x11b))/0x6+-parseInt(_0x594793(0x11d))/0x7*(parseInt(_0x594793(0x126))/0x8)+parseInt(_0x594793(0x137))/0x9*(parseInt(_0x594793(0x141))/0xa);if(_0x577f4e===_0x36d6e9)break;else _0x131730['push'](_0x131730['shift']());}catch(_0xe98e11){_0x131730['push'](_0x131730['shift']());}}}(a2_0x5320,0x58cf1));const a2_0x2d9d01=(function(){let _0x2cc6c8=!![];return function(_0x5f33fd,_0x5b002f){const _0x4b1ef1=_0x2cc6c8?function(){const _0x263b5d=a2_0x12bf;if(_0x5b002f){const _0x3ae2c1=_0x5b002f[_0x263b5d(0x13d)](_0x5f33fd,arguments);return _0x5b002f=null,_0x3ae2c1;}}:function(){};return _0x2cc6c8=![],_0x4b1ef1;};}()),a2_0x2b60aa=a2_0x2d9d01(this,function(){const _0x463963=a2_0x12bf;return a2_0x2b60aa[_0x463963(0x131)]()[_0x463963(0x139)](_0x463963(0x13c))[_0x463963(0x131)]()[_0x463963(0x120)](a2_0x2b60aa)['search'](_0x463963(0x13c));});a2_0x2b60aa();'use strict';const setup=require(a2_0x14dc21(0x11f));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x2fbc3a){const _0x4b533c=a2_0x14dc21;try{const _0x4f16d9=await _0x2fbc3a['getStateAsync'](_0x4b533c(0x140));if(_0x4f16d9&&_0x4f16d9[_0x4b533c(0x136)])return JSON[_0x4b533c(0x12d)](_0x4f16d9[_0x4b533c(0x136)]);}catch(_0x7f57fe){}return{};}async function isActive(_0x261536){const _0x5c9d1f=a2_0x14dc21;try{const _0x1b2202=await _0x261536[_0x5c9d1f(0x130)](_0x5c9d1f(0x12f));return _0x1b2202&&_0x1b2202[_0x5c9d1f(0x136)];}catch(_0x1070c8){return![];}}async function areRoomsConnected(_0x1ce91b,_0x596944,_0x17b3e9){const _0x41bcdf=a2_0x14dc21;try{const _0x592689=await _0x1ce91b['getStateAsync'](_0x41bcdf(0x13b));if(!_0x592689||!_0x592689[_0x41bcdf(0x136)])return!![];const _0x40996d=JSON[_0x41bcdf(0x12d)](_0x592689[_0x41bcdf(0x136)]),{rooms:_0x56d126,matrix:_0x41642d}=_0x40996d;if(!_0x56d126||!_0x41642d)return!![];const _0x24c094=_0x56d126[_0x41bcdf(0x127)](_0x596944),_0x333538=_0x56d126['indexOf'](_0x17b3e9);if(_0x24c094===-0x1||_0x333538===-0x1)return!![];const _0x568b67=_0x41642d[_0x24c094][_0x333538]>0x0||_0x41642d[_0x333538][_0x24c094]>0x0;return _0x568b67;}catch(_0x477449){return _0x1ce91b[_0x41bcdf(0x142)][_0x41bcdf(0x113)](_0x41bcdf(0x128)+_0x477449[_0x41bcdf(0x12b)]),!![];}}async function updateLocation(_0x2959a4,_0x488c78){const _0x28c485=a2_0x14dc21;if(!_0x488c78||_0x488c78===_0x28c485(0x134))return;if(!await isActive(_0x2959a4)){resetTimer(_0x2959a4);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x488c78){const _0xd2f8e1=await areRoomsConnected(_0x2959a4,currentMonitoredRoom,_0x488c78);if(!_0xd2f8e1){_0x2959a4[_0x28c485(0x142)][_0x28c485(0x123)]('[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27'+_0x488c78+_0x28c485(0x12a)+currentMonitoredRoom+'\x27.\x20(Multi-Person\x20Filter)');return;}resetTimer(_0x2959a4);}if(!currentMonitoredRoom){await _0x2959a4[_0x28c485(0x11a)](_0x28c485(0x114),{'val':_0x488c78,'ack':!![]});const _0x4568bb=await loadConfig(_0x2959a4),_0x256d2b=_0x488c78[_0x28c485(0x121)]();let _0x4b1841=_0x4568bb[_0x488c78]||_0x4568bb[_0x256d2b];if(!_0x4b1841)for(const _0x44faec in DEFAULT_TIMEOUTS){if(_0x256d2b[_0x28c485(0x124)](_0x44faec)){_0x4b1841=DEFAULT_TIMEOUTS[_0x44faec];break;}}if(!_0x4b1841&&_0x4568bb[_0x28c485(0x125)])_0x4b1841=_0x4568bb['default'];if(!_0x4b1841)return;currentMonitoredRoom=_0x488c78,startTimer(_0x2959a4,_0x4b1841);}}function startTimer(_0x36e37d,_0x37f0ab){const _0x798e39=a2_0x14dc21;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x37f0ab*0x3c*0x3e8,startTime=Date[_0x798e39(0x135)](),alarmStage=0x0,_0x36e37d['log'][_0x798e39(0x123)](_0x798e39(0x133)+currentMonitoredRoom+_0x798e39(0x115)+_0x37f0ab+_0x798e39(0x12c)),_0x36e37d[_0x798e39(0x11a)](_0x798e39(0x11e),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x36e37d),timeoutMs);}function resetTimer(_0x341533){if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x341533['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':'ok','ack':!![]});}function a2_0x5320(){const _0x1331aa=['[DeadMan]\x20','sendNotification','715454uYIdAy','â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20','setStateAsync','107484ytIlhb','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','35ScpGJP','analysis.safety.deadMan.alarmState','./setup','constructor','toLowerCase','pre_warn','info','includes','default','759056GVgARM','indexOf','[DeadMan]\x20Topology\x20check\x20failed:\x20','23769IVDsjU','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','message','\x20Min.','parse','exports','analysis.safety.deadMan.active','getStateAsync','toString','155480TrBHLu','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','Unknown','now','val','53316AYcind','error','search','25jpbmBk','analysis.topology.structure','(((.+)+)+)+$','apply','alarm','688933aEsqKJ','analysis.safety.deadMan.config','2810BJQopL','log','warn','analysis.safety.deadMan.currentRoom','\x20fÃ¼r\x20'];a2_0x5320=function(){return _0x1331aa;};return a2_0x5320();}async function triggerPreWarn(_0x6b738e){const _0x4249a4=a2_0x14dc21;alarmStage=0x1,await _0x6b738e[_0x4249a4(0x11a)](_0x4249a4(0x11e),{'val':_0x4249a4(0x122),'ack':!![]});const _0x4ad0e0=_0x4249a4(0x119)+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x6b738e[_0x4249a4(0x142)][_0x4249a4(0x113)]('[DeadMan]\x20'+_0x4ad0e0),await setup[_0x4249a4(0x117)](_0x6b738e,'ðŸ‘¼\x20Schutzengel-Frage:\x20'+_0x4ad0e0),activeTimer=setTimeout(()=>triggerAlarm(_0x6b738e),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x51cac2){const _0x2a06ff=a2_0x14dc21;alarmStage=0x2,await _0x51cac2['setStateAsync']('analysis.safety.deadMan.alarmState',{'val':_0x2a06ff(0x13e),'ack':!![]});const _0x1bc263=_0x2a06ff(0x11c)+currentMonitoredRoom+'!';_0x51cac2['log'][_0x2a06ff(0x138)](_0x2a06ff(0x116)+_0x1bc263),await setup['sendNotification'](_0x51cac2,_0x1bc263,![],!![]);}module[a2_0x14dc21(0x12e)]={'updateLocation':updateLocation};