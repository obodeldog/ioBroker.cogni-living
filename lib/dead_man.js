function a2_0x6aed(_0x23e7cd,_0x27e014){const _0x416896=a2_0x3167();return a2_0x6aed=function(_0x34de31,_0x39287b){_0x34de31=_0x34de31-0xb0;let _0x31678a=_0x416896[_0x34de31];return _0x31678a;},a2_0x6aed(_0x23e7cd,_0x27e014);}const a2_0x10eed6=a2_0x6aed;(function(_0x43aa5e,_0x185006){const _0x5b8ba2=a2_0x6aed,_0x59921e=_0x43aa5e();while(!![]){try{const _0x3dca82=-parseInt(_0x5b8ba2(0xca))/0x1+-parseInt(_0x5b8ba2(0xbf))/0x2+-parseInt(_0x5b8ba2(0xb0))/0x3+-parseInt(_0x5b8ba2(0xd2))/0x4+parseInt(_0x5b8ba2(0xc4))/0x5*(parseInt(_0x5b8ba2(0xd0))/0x6)+parseInt(_0x5b8ba2(0xcc))/0x7*(parseInt(_0x5b8ba2(0xcd))/0x8)+parseInt(_0x5b8ba2(0xc9))/0x9;if(_0x3dca82===_0x185006)break;else _0x59921e['push'](_0x59921e['shift']());}catch(_0x2f929){_0x59921e['push'](_0x59921e['shift']());}}}(a2_0x3167,0x87a97));const a2_0x39287b=(function(){let _0x1d1109=!![];return function(_0x1b0705,_0x55df2b){const _0x598253=_0x1d1109?function(){const _0x587135=a2_0x6aed;if(_0x55df2b){const _0x1cef7b=_0x55df2b[_0x587135(0xba)](_0x1b0705,arguments);return _0x55df2b=null,_0x1cef7b;}}:function(){};return _0x1d1109=![],_0x598253;};}()),a2_0x34de31=a2_0x39287b(this,function(){const _0x3254d3=a2_0x6aed;return a2_0x34de31[_0x3254d3(0xd8)]()[_0x3254d3(0xc0)](_0x3254d3(0xcf))['toString']()['constructor'](a2_0x34de31)[_0x3254d3(0xc0)](_0x3254d3(0xcf));});a2_0x34de31();'use strict';const setup=require(a2_0x10eed6(0xc6));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x46740b){const _0x494a70=a2_0x10eed6;try{const _0x171203=await _0x46740b[_0x494a70(0xce)](_0x494a70(0xb5));if(_0x171203&&_0x171203[_0x494a70(0xc2)])return JSON[_0x494a70(0xb7)](_0x171203[_0x494a70(0xc2)]);}catch(_0x49c131){}return{};}async function isActive(_0x2f6521){const _0x55b30c=a2_0x10eed6;try{const _0x2a60e5=await _0x2f6521[_0x55b30c(0xce)](_0x55b30c(0xd6));return _0x2a60e5&&_0x2a60e5[_0x55b30c(0xc2)];}catch(_0x5252f0){return![];}}function a2_0x3167(){const _0x2e3e56=['message','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','Unknown','pre_warn','2080862dNLRvr','search','now','val','[DeadMan]\x20','4753205pxLDSe','info','./setup','setStateAsync','.\x20Alles\x20in\x20Ordnung?','12719970pgurxL','478504YiPLVB','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','4483458UXcSfE','8ZynxIY','getStateAsync','(((.+)+)+)+$','6ejaHkn','indexOf','3182212SnZpXr','default','warn','sendNotification','analysis.safety.deadMan.active','alarm','toString','402918XYHCFm','stringify','analysis.safety.deadMan.alarmState','\x20fÃ¼r\x20','includes','analysis.safety.deadMan.config','log','parse','ðŸ‘¼\x20Schutzengel-Frage:\x20','[DeadMan]\x20Topology\x20check\x20failed:\x20','apply'];a2_0x3167=function(){return _0x2e3e56;};return a2_0x3167();}async function areRoomsConnected(_0x28ef02,_0x9997d8,_0x3d1171){const _0x4f210d=a2_0x10eed6;try{const _0x2f1ba3=await _0x28ef02[_0x4f210d(0xce)]('analysis.topology.structure');if(!_0x2f1ba3||!_0x2f1ba3['val'])return!![];const _0x4e40ca=JSON[_0x4f210d(0xb7)](_0x2f1ba3[_0x4f210d(0xc2)]),{rooms:_0x33e32e,matrix:_0x5d163b}=_0x4e40ca;if(!_0x33e32e||!_0x5d163b)return!![];const _0x5e1787=_0x33e32e[_0x4f210d(0xd1)](_0x9997d8),_0xa9ec0e=_0x33e32e['indexOf'](_0x3d1171);if(_0x5e1787===-0x1||_0xa9ec0e===-0x1)return!![];const _0x40f35c=_0x5d163b[_0x5e1787][_0xa9ec0e]>0x0||_0x5d163b[_0xa9ec0e][_0x5e1787]>0x0;return _0x40f35c;}catch(_0x1a3a19){return _0x28ef02[_0x4f210d(0xb6)][_0x4f210d(0xd4)](_0x4f210d(0xb9)+_0x1a3a19[_0x4f210d(0xbb)]),!![];}}async function updateLocation(_0x48b7d1,_0x511a16){const _0x9b71f3=a2_0x10eed6;if(!_0x511a16||_0x511a16===_0x9b71f3(0xbd))return;if(!await isActive(_0x48b7d1)){resetTimer(_0x48b7d1);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x511a16){const _0x2a4f18=await areRoomsConnected(_0x48b7d1,currentMonitoredRoom,_0x511a16);if(!_0x2a4f18){const _0x161a9d='Ignoriere\x20Bewegung\x20in\x20\x27'+_0x511a16+_0x9b71f3(0xcb)+currentMonitoredRoom+'\x27.';_0x48b7d1['log'][_0x9b71f3(0xc5)](_0x9b71f3(0xc3)+_0x161a9d+'\x20(Multi-Person\x20Filter)'),await _0x48b7d1[_0x9b71f3(0xc7)]('analysis.safety.deadMan.lastIgnored',{'val':JSON[_0x9b71f3(0xb1)]({'room':_0x511a16,'reason':_0x161a9d,'timestamp':Date[_0x9b71f3(0xc1)]()}),'ack':!![]});return;}resetTimer(_0x48b7d1);}if(!currentMonitoredRoom){await _0x48b7d1[_0x9b71f3(0xc7)]('analysis.safety.deadMan.currentRoom',{'val':_0x511a16,'ack':!![]});const _0x5be206=await loadConfig(_0x48b7d1),_0x30cc51=_0x511a16['toLowerCase']();let _0xd529bd=_0x5be206[_0x511a16]||_0x5be206[_0x30cc51];if(!_0xd529bd)for(const _0x371c1c in DEFAULT_TIMEOUTS){if(_0x30cc51[_0x9b71f3(0xb4)](_0x371c1c)){_0xd529bd=DEFAULT_TIMEOUTS[_0x371c1c];break;}}if(!_0xd529bd&&_0x5be206[_0x9b71f3(0xd3)])_0xd529bd=_0x5be206[_0x9b71f3(0xd3)];if(!_0xd529bd)return;currentMonitoredRoom=_0x511a16,startTimer(_0x48b7d1,_0xd529bd);}}function startTimer(_0x5f44f0,_0x3169e3){const _0x19eb9d=a2_0x10eed6;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x3169e3*0x3c*0x3e8,startTime=Date[_0x19eb9d(0xc1)](),alarmStage=0x0,_0x5f44f0[_0x19eb9d(0xb6)]['info']('ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20'+currentMonitoredRoom+_0x19eb9d(0xb3)+_0x3169e3+'\x20Min.'),_0x5f44f0[_0x19eb9d(0xc7)](_0x19eb9d(0xb2),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x5f44f0),timeoutMs);}function resetTimer(_0x32772e){const _0x5f0a4f=a2_0x10eed6;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x32772e[_0x5f0a4f(0xc7)](_0x5f0a4f(0xb2),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x22d80d){const _0x4f4757=a2_0x10eed6;alarmStage=0x1,await _0x22d80d[_0x4f4757(0xc7)](_0x4f4757(0xb2),{'val':_0x4f4757(0xbe),'ack':!![]});const _0xe6916d='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+_0x4f4757(0xc8);_0x22d80d[_0x4f4757(0xb6)][_0x4f4757(0xd4)](_0x4f4757(0xc3)+_0xe6916d),await setup[_0x4f4757(0xd5)](_0x22d80d,_0x4f4757(0xb8)+_0xe6916d),activeTimer=setTimeout(()=>triggerAlarm(_0x22d80d),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x1fd017){const _0x16de85=a2_0x10eed6;alarmStage=0x2,await _0x1fd017['setStateAsync'](_0x16de85(0xb2),{'val':_0x16de85(0xd7),'ack':!![]});const _0x2b6e93=_0x16de85(0xbc)+currentMonitoredRoom+'!';_0x1fd017['log']['error']('[DeadMan]\x20'+_0x2b6e93),await setup[_0x16de85(0xd5)](_0x1fd017,_0x2b6e93,![],!![]);}module['exports']={'updateLocation':updateLocation};