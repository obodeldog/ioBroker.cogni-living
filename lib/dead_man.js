const a2_0x53d223=a2_0xd451;(function(_0x55ad79,_0x35d888){const _0x3d9a39=a2_0xd451,_0x5019b4=_0x55ad79();while(!![]){try{const _0x39c123=-parseInt(_0x3d9a39(0x1b0))/0x1*(parseInt(_0x3d9a39(0x1bf))/0x2)+-parseInt(_0x3d9a39(0x1a3))/0x3*(-parseInt(_0x3d9a39(0x1b1))/0x4)+-parseInt(_0x3d9a39(0x1b2))/0x5+parseInt(_0x3d9a39(0x1c0))/0x6+-parseInt(_0x3d9a39(0x198))/0x7+parseInt(_0x3d9a39(0x1b5))/0x8*(parseInt(_0x3d9a39(0x1be))/0x9)+parseInt(_0x3d9a39(0x1b3))/0xa;if(_0x39c123===_0x35d888)break;else _0x5019b4['push'](_0x5019b4['shift']());}catch(_0x4b4b23){_0x5019b4['push'](_0x5019b4['shift']());}}}(a2_0x21fe,0xe28e5));function a2_0x21fe(){const _0x4ba061=['(((.+)+)+)+$','indexOf','\x20fÃ¼r\x20','[DeadMan]\x20','includes','114MQdtDK','./setup','\x27.\x20Nicht\x20verbunden\x20mit\x20Ã¼berwachtem\x20\x27','constructor','Unknown','now','analysis.topology.structure','toString','getStateAsync','analysis.safety.deadMan.config','\x27.\x20(Multi-Person\x20Filter)','parse','setStateAsync','1465957jqoYjf','164704JwquHD','4049775GThJpC','3575270vpDRvs','[DeadMan]\x20Ignoriere\x20Bewegung\x20in\x20\x27','3257288CWyLsa','analysis.safety.deadMan.currentRoom','ðŸ‘¼\x20Schutzengel-Frage:\x20','warn','default','message','pre_warn','ðŸš¨\x20NOTFALL-ALARM:\x20Person\x20reagiert\x20nicht\x20in\x20','error','18POkAHa','2odEwVG','6776160hUMLYH','\x20Min.','val','toLowerCase','search','4634084ylIGke','ðŸ‘¼\x20Schutzengel:\x20Ãœberwache\x20','sendNotification','analysis.safety.deadMan.alarmState','info','log'];a2_0x21fe=function(){return _0x4ba061;};return a2_0x21fe();}const a2_0x1f57d2=(function(){let _0x41fd99=!![];return function(_0x36b127,_0xc9875d){const _0x18d116=_0x41fd99?function(){if(_0xc9875d){const _0x39baaa=_0xc9875d['apply'](_0x36b127,arguments);return _0xc9875d=null,_0x39baaa;}}:function(){};return _0x41fd99=![],_0x18d116;};}()),a2_0x14a940=a2_0x1f57d2(this,function(){const _0x44bad8=a2_0xd451;return a2_0x14a940[_0x44bad8(0x1aa)]()[_0x44bad8(0x197)](_0x44bad8(0x19e))[_0x44bad8(0x1aa)]()[_0x44bad8(0x1a6)](a2_0x14a940)[_0x44bad8(0x197)]('(((.+)+)+)+$');});a2_0x14a940();'use strict';const setup=require(a2_0x53d223(0x1a4));let activeTimer=null,currentMonitoredRoom=null,timeoutMs=0x0,startTime=0x0,alarmStage=0x0;const DEFAULT_TIMEOUTS={'bad':0x2d,'bath':0x2d,'toilet':0x1e,'wc':0x1e,'keller':0x3c};async function loadConfig(_0x1f4124){const _0x3cd525=a2_0x53d223;try{const _0x3414ce=await _0x1f4124[_0x3cd525(0x1ab)](_0x3cd525(0x1ac));if(_0x3414ce&&_0x3414ce[_0x3cd525(0x1c2)])return JSON[_0x3cd525(0x1ae)](_0x3414ce[_0x3cd525(0x1c2)]);}catch(_0x4dcf57){}return{};}async function isActive(_0x26a922){const _0x251760=a2_0x53d223;try{const _0x5918d4=await _0x26a922[_0x251760(0x1ab)]('analysis.safety.deadMan.active');return _0x5918d4&&_0x5918d4['val'];}catch(_0x255414){return![];}}async function areRoomsConnected(_0x1a0b64,_0x1df997,_0x46299d){const _0x582fea=a2_0x53d223;try{const _0x52a018=await _0x1a0b64[_0x582fea(0x1ab)](_0x582fea(0x1a9));if(!_0x52a018||!_0x52a018['val'])return!![];const _0x147a9b=JSON[_0x582fea(0x1ae)](_0x52a018[_0x582fea(0x1c2)]),{rooms:_0x3934c6,matrix:_0x394fdf}=_0x147a9b;if(!_0x3934c6||!_0x394fdf)return!![];const _0x3d9ad9=_0x3934c6[_0x582fea(0x19f)](_0x1df997),_0x5a25f1=_0x3934c6['indexOf'](_0x46299d);if(_0x3d9ad9===-0x1||_0x5a25f1===-0x1)return!![];const _0x483156=_0x394fdf[_0x3d9ad9][_0x5a25f1]>0x0||_0x394fdf[_0x5a25f1][_0x3d9ad9]>0x0;return _0x483156;}catch(_0x1515f0){return _0x1a0b64[_0x582fea(0x19d)][_0x582fea(0x1b8)]('[DeadMan]\x20Topology\x20check\x20failed:\x20'+_0x1515f0[_0x582fea(0x1ba)]),!![];}}function a2_0xd451(_0x1ce4a9,_0x13b7c3){const _0x182937=a2_0x21fe();return a2_0xd451=function(_0x14a940,_0x1f57d2){_0x14a940=_0x14a940-0x196;let _0x21fea4=_0x182937[_0x14a940];return _0x21fea4;},a2_0xd451(_0x1ce4a9,_0x13b7c3);}async function updateLocation(_0x2a1614,_0x3f5179){const _0x1e66a6=a2_0x53d223;if(!_0x3f5179||_0x3f5179===_0x1e66a6(0x1a7))return;if(!await isActive(_0x2a1614)){resetTimer(_0x2a1614);return;}if(currentMonitoredRoom&&currentMonitoredRoom!==_0x3f5179){const _0xb75454=await areRoomsConnected(_0x2a1614,currentMonitoredRoom,_0x3f5179);if(!_0xb75454){_0x2a1614[_0x1e66a6(0x19d)][_0x1e66a6(0x19c)](_0x1e66a6(0x1b4)+_0x3f5179+_0x1e66a6(0x1a5)+currentMonitoredRoom+_0x1e66a6(0x1ad));return;}resetTimer(_0x2a1614);}if(!currentMonitoredRoom){await _0x2a1614[_0x1e66a6(0x1af)](_0x1e66a6(0x1b6),{'val':_0x3f5179,'ack':!![]});const _0x10ea4b=await loadConfig(_0x2a1614),_0xf131b0=_0x3f5179[_0x1e66a6(0x196)]();let _0xdf4415=_0x10ea4b[_0x3f5179]||_0x10ea4b[_0xf131b0];if(!_0xdf4415)for(const _0x1b9e13 in DEFAULT_TIMEOUTS){if(_0xf131b0[_0x1e66a6(0x1a2)](_0x1b9e13)){_0xdf4415=DEFAULT_TIMEOUTS[_0x1b9e13];break;}}if(!_0xdf4415&&_0x10ea4b[_0x1e66a6(0x1b9)])_0xdf4415=_0x10ea4b[_0x1e66a6(0x1b9)];if(!_0xdf4415)return;currentMonitoredRoom=_0x3f5179,startTimer(_0x2a1614,_0xdf4415);}}function startTimer(_0x177fee,_0x470c63){const _0xdac69a=a2_0x53d223;if(activeTimer)clearTimeout(activeTimer);timeoutMs=_0x470c63*0x3c*0x3e8,startTime=Date[_0xdac69a(0x1a8)](),alarmStage=0x0,_0x177fee[_0xdac69a(0x19d)][_0xdac69a(0x19c)](_0xdac69a(0x199)+currentMonitoredRoom+_0xdac69a(0x1a0)+_0x470c63+_0xdac69a(0x1c1)),_0x177fee[_0xdac69a(0x1af)](_0xdac69a(0x19b),{'val':'ok','ack':!![]}),activeTimer=setTimeout(()=>triggerPreWarn(_0x177fee),timeoutMs);}function resetTimer(_0x33d453){const _0x208393=a2_0x53d223;if(activeTimer)clearTimeout(activeTimer);activeTimer=null,currentMonitoredRoom=null,alarmStage=0x0,_0x33d453['setStateAsync'](_0x208393(0x19b),{'val':'ok','ack':!![]});}async function triggerPreWarn(_0x230ca4){const _0x2edbb8=a2_0x53d223;alarmStage=0x1,await _0x230ca4[_0x2edbb8(0x1af)](_0x2edbb8(0x19b),{'val':_0x2edbb8(0x1bb),'ack':!![]});const _0x531aae='â³\x20ACHTUNG:\x20UngewÃ¶hnlich\x20lange\x20InaktivitÃ¤t\x20in\x20'+currentMonitoredRoom+'.\x20Alles\x20in\x20Ordnung?';_0x230ca4[_0x2edbb8(0x19d)][_0x2edbb8(0x1b8)]('[DeadMan]\x20'+_0x531aae),await setup[_0x2edbb8(0x19a)](_0x230ca4,_0x2edbb8(0x1b7)+_0x531aae),activeTimer=setTimeout(()=>triggerAlarm(_0x230ca4),0x5*0x3c*0x3e8);}async function triggerAlarm(_0x208d3f){const _0x3276c1=a2_0x53d223;alarmStage=0x2,await _0x208d3f[_0x3276c1(0x1af)](_0x3276c1(0x19b),{'val':'alarm','ack':!![]});const _0x21c167=_0x3276c1(0x1bc)+currentMonitoredRoom+'!';_0x208d3f[_0x3276c1(0x19d)][_0x3276c1(0x1bd)](_0x3276c1(0x1a1)+_0x21c167),await setup['sendNotification'](_0x208d3f,_0x21c167,![],!![]);}module['exports']={'updateLocation':updateLocation};