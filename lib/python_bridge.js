const a4_0x44407f=a4_0x5a10;(function(_0x42ed23,_0x1d94da){const _0x45b377=a4_0x5a10,_0x2b02d1=_0x42ed23();while(!![]){try{const _0x2544d9=-parseInt(_0x45b377(0x1b1))/0x1+parseInt(_0x45b377(0x1c5))/0x2+-parseInt(_0x45b377(0x1aa))/0x3*(-parseInt(_0x45b377(0x1a1))/0x4)+parseInt(_0x45b377(0x1d3))/0x5+-parseInt(_0x45b377(0x1cb))/0x6+-parseInt(_0x45b377(0x1a9))/0x7+parseInt(_0x45b377(0x1b3))/0x8;if(_0x2544d9===_0x1d94da)break;else _0x2b02d1['push'](_0x2b02d1['shift']());}catch(_0x3c25cf){_0x2b02d1['push'](_0x2b02d1['shift']());}}}(a4_0x482c,0x354f1));const a4_0x57931e=(function(){let _0x3aa832=!![];return function(_0x4aa7dc,_0x57e21e){const _0x10d5d6=_0x3aa832?function(){const _0x538c7c=a4_0x5a10;if(_0x57e21e){const _0x479ad1=_0x57e21e[_0x538c7c(0x1b2)](_0x4aa7dc,arguments);return _0x57e21e=null,_0x479ad1;}}:function(){};return _0x3aa832=![],_0x10d5d6;};}()),a4_0x1751ca=a4_0x57931e(this,function(){const _0x5ae17b=a4_0x5a10;return a4_0x1751ca[_0x5ae17b(0x18d)]()[_0x5ae17b(0x180)](_0x5ae17b(0x1c0))['toString']()[_0x5ae17b(0x1ad)](a4_0x1751ca)[_0x5ae17b(0x180)](_0x5ae17b(0x1c0));});function a4_0x5a10(_0x2acf42,_0x428b0e){const _0x43f9c8=a4_0x482c();return a4_0x5a10=function(_0x1751ca,_0x57931e){_0x1751ca=_0x1751ca-0x17a;let _0x482c98=_0x43f9c8[_0x1751ca];return _0x482c98;},a4_0x5a10(_0x2acf42,_0x428b0e);}a4_0x1751ca();'use strict';const {spawn}=require(a4_0x44407f(0x193)),path=require(a4_0x44407f(0x1d0)),fs=require('fs'),setup=require(a4_0x44407f(0x1d6)),automation=require('./automation');let pythonProcess=null;function send(_0x5691ca,_0x33c111,_0x52cb4e={}){const _0x26be3e=a4_0x44407f;if(!pythonProcess||!pythonProcess[_0x26be3e(0x1c2)][_0x26be3e(0x188)])return;const _0x1e4a97=JSON[_0x26be3e(0x1c7)]({'command':_0x33c111,..._0x52cb4e});try{pythonProcess[_0x26be3e(0x1c2)]['write'](_0x1e4a97+'\x0a');}catch(_0x2bc82e){}}function handleResult(_0x3f69aa,_0x1dcf90){const _0x5e40d8=a4_0x44407f;if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x18e))_0x3f69aa[_0x5e40d8(0x199)][_0x5e40d8(0x1b0)](_0x5e40d8(0x198));else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x189)){const {anomaly_score:_0x42bf94,is_anomaly:_0x553a25,threshold:_0x25ea3c,explanation:_0x2f06ef}=_0x1dcf90[_0x5e40d8(0x1a8)];_0x3f69aa['log'][_0x5e40d8(0x1ce)](_0x5e40d8(0x197)+_0x42bf94[_0x5e40d8(0x1b7)](0x5)+'\x20->\x20'+(_0x553a25?_0x5e40d8(0x1bf):'OK')),_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x1d2),{'val':_0x42bf94,'ack':!![]}),_0x3f69aa['setStateAsync'](_0x5e40d8(0x17b),{'val':new Date()[_0x5e40d8(0x1a7)](),'ack':!![]});if(_0x25ea3c)_0x3f69aa['setStateAsync'](_0x5e40d8(0x1af),{'val':_0x25ea3c,'ack':!![]});if(_0x553a25){let _0x327ffc=_0x5e40d8(0x18b)+_0x42bf94[_0x5e40d8(0x1b7)](0x4)+')';if(_0x2f06ef&&_0x2f06ef!==_0x5e40d8(0x1be))_0x327ffc+='\x0aGrund:\x20'+_0x2f06ef;_0x3f69aa[_0x5e40d8(0x19b)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x3f69aa['setStateAsync'](_0x5e40d8(0x19d),{'val':_0x327ffc,'ack':!![]}),setup[_0x5e40d8(0x1a3)](_0x3f69aa,'‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20'+_0x327ffc,![],!![]);}}else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x185)){const _0xf57bf4=_0x1dcf90['payload'][_0x5e40d8(0x1cf)]||'',_0x12f259=_0x1dcf90[_0x5e40d8(0x1a8)][_0x5e40d8(0x17f)],_0x5e29c7=_0x1dcf90[_0x5e40d8(0x1a8)]['success']?_0x5e40d8(0x1c9)+new Date()['toLocaleTimeString']()+'\x20('+_0xf57bf4+')':_0x5e40d8(0x19a)+_0x1dcf90[_0x5e40d8(0x1a8)][_0x5e40d8(0x1a5)];_0x3f69aa['setStateAsync'](_0x5e40d8(0x17d),{'val':_0x5e29c7,'ack':!![]});if(_0x1dcf90[_0x5e40d8(0x1a8)][_0x5e40d8(0x184)]&&_0x12f259)_0x3f69aa['setStateAsync'](_0x5e40d8(0x1af),{'val':_0x12f259,'ack':!![]});}else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x191)){const {patterns:_0x20a92f}=_0x1dcf90['payload'];if(_0x20a92f&&_0x20a92f[_0x5e40d8(0x1d5)]>0x0){_0x3f69aa[_0x5e40d8(0x199)]['info'](_0x5e40d8(0x1a0)+_0x20a92f['length']+_0x5e40d8(0x19e)),_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x1c4),{'val':JSON[_0x5e40d8(0x1c7)](_0x20a92f),'ack':!![]});const _0x4d9b87=_0x20a92f[0x0],_0x403244=_0x5e40d8(0x1c1)+_0x4d9b87[_0x5e40d8(0x181)]+'\x20('+(_0x4d9b87[_0x5e40d8(0x1a6)]*0x64)['toFixed'](0x0)+'%)';_0x3f69aa[_0x5e40d8(0x19b)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x17e),{'val':_0x403244,'ack':!![]});}else _0x3f69aa['log']['info']('üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x195),{'val':![],'ack':!![]}),_0x3f69aa[_0x5e40d8(0x19b)]('analysis.automation.detectedPatterns',{'val':'[]','ack':!![]});}else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x1d4)){if(_0x1dcf90['payload'][_0x5e40d8(0x184)])try{const _0x34ab01=JSON[_0x5e40d8(0x1cc)](_0x1dcf90[_0x5e40d8(0x1a8)][_0x5e40d8(0x1cf)]);if(_0x34ab01[_0x5e40d8(0x17a)])_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x1bb),{'val':JSON['stringify'](_0x34ab01[_0x5e40d8(0x17a)]),'ack':!![]});if(_0x34ab01[_0x5e40d8(0x19c)])_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x1d7),{'val':JSON[_0x5e40d8(0x1c7)](_0x34ab01[_0x5e40d8(0x19c)]),'ack':!![]});}catch(_0x498250){}}else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x1a4)){if(_0x1dcf90['payload'][_0x5e40d8(0x184)])_0x3f69aa[_0x5e40d8(0x199)][_0x5e40d8(0x1ce)](_0x5e40d8(0x1bd));}else{if(_0x1dcf90[_0x5e40d8(0x1d9)]==='HEALTH_RESULT')_0x3f69aa['setStateAsync'](_0x5e40d8(0x1b8),{'val':new Date()[_0x5e40d8(0x1a7)](),'ack':!![]}),_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x1ba),{'val':_0x1dcf90[_0x5e40d8(0x1a8)][_0x5e40d8(0x17c)],'ack':!![]});else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x18c))_0x3f69aa['setStateAsync'](_0x5e40d8(0x1ac),{'val':_0x1dcf90[_0x5e40d8(0x1a8)][_0x5e40d8(0x1da)],'ack':!![]}),_0x3f69aa[_0x5e40d8(0x19b)]('analysis.health.trendValue',{'val':_0x1dcf90[_0x5e40d8(0x1a8)]['change_percent'],'ack':!![]});else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x1c3)){const {speed_trend:_0x58bc08}=_0x1dcf90[_0x5e40d8(0x1a8)];if(_0x58bc08!==undefined)_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x18f),{'val':_0x58bc08,'ack':!![]});}else{if(_0x1dcf90['type']===_0x5e40d8(0x1b6)){const {forecast:_0x28dd99}=_0x1dcf90['payload'];if(_0x28dd99)_0x3f69aa['setStateAsync'](_0x5e40d8(0x1b5),{'val':JSON[_0x5e40d8(0x1c7)](_0x28dd99),'ack':!![]});}else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x19f)){const {data:_0x5c9c8d}=_0x1dcf90['payload'];_0x5c9c8d&&(_0x3f69aa[_0x5e40d8(0x199)][_0x5e40d8(0x1ce)]('üï∏Ô∏è\x20Topology\x20Map\x20updated\x20by\x20Python.'),_0x3f69aa[_0x5e40d8(0x19b)]('analysis.security.topologyMatrix',{'val':JSON[_0x5e40d8(0x1c7)](_0x5c9c8d),'ack':!![]}));}else{if(_0x1dcf90[_0x5e40d8(0x1d9)]===_0x5e40d8(0x194))_0x3f69aa[_0x5e40d8(0x199)][_0x5e40d8(0x1b0)]('üêç\x20Python\x20confirmed\x20new\x20topology.');else{if(_0x1dcf90[_0x5e40d8(0x1d9)]==='SIGNAL_RESULT'){const {room:_0x144eb7,propagation:_0x267824}=_0x1dcf90[_0x5e40d8(0x1a8)];let _0x5b2ac3='Unknown',_0x57f517=0x0;if(_0x267824){const _0x319ddb=Object[_0x5e40d8(0x1ae)](_0x267824);_0x319ddb[_0x5e40d8(0x1d5)]>0x0&&(_0x5b2ac3=_0x319ddb[0x0][0x0],_0x57f517=_0x319ddb[0x0][0x1]);}_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x1d8),{'val':_0x5b2ac3,'ack':!![]}),_0x3f69aa[_0x5e40d8(0x19b)](_0x5e40d8(0x1b4),{'val':_0x57f517,'ack':!![]}),_0x57f517>0.4&&_0x3f69aa[_0x5e40d8(0x199)][_0x5e40d8(0x1b0)](_0x5e40d8(0x1cd)+_0x144eb7+_0x5e40d8(0x1c6)+_0x5b2ac3+'\x20('+(_0x57f517*0x64)['toFixed'](0x0)+'%)'),automation[_0x5e40d8(0x1ca)](_0x3f69aa,_0x5b2ac3,_0x57f517);}}}}}}}}}}}}}}function startService(_0x3f1ab3,_0x260c21){const _0x4b2053=a4_0x44407f;let _0x3b6948='python3';if(fs[_0x4b2053(0x196)](_0x260c21))_0x3b6948=_0x260c21;try{const _0x1ce2e2=path[_0x4b2053(0x183)](__dirname,'..','python_service',_0x4b2053(0x1bc));pythonProcess=spawn(_0x3b6948,[_0x1ce2e2]),pythonProcess[_0x4b2053(0x18a)]['on'](_0x4b2053(0x190),_0x45701b=>{const _0x165381=_0x4b2053,_0x892b3e=_0x45701b['toString']()['split']('\x0a');_0x892b3e[_0x165381(0x1a2)](_0x518591=>{const _0x17f2dd=_0x165381,_0x5b4b8b=_0x518591[_0x17f2dd(0x192)]();if(!_0x5b4b8b)return;if(_0x5b4b8b[_0x17f2dd(0x1d1)]('[LOG]'))_0x3f1ab3[_0x17f2dd(0x199)][_0x17f2dd(0x1b0)]('[PYTHON]\x20'+_0x5b4b8b['substring'](0x5)['trim']());else{if(_0x5b4b8b[_0x17f2dd(0x1d1)]('[RESULT]'))try{const _0x3299d7=JSON[_0x17f2dd(0x1cc)](_0x5b4b8b[_0x17f2dd(0x186)](0x8)[_0x17f2dd(0x192)]());handleResult(_0x3f1ab3,_0x3299d7);}catch(_0x20576f){}}});}),pythonProcess['on'](_0x4b2053(0x187),_0x217f60=>{pythonProcess=null;}),_0x3f1ab3[_0x4b2053(0x1b9)]=(_0x279b42,_0x536d32)=>send(_0x3f1ab3,_0x279b42,_0x536d32);}catch(_0x13d250){_0x3f1ab3[_0x4b2053(0x199)][_0x4b2053(0x182)](_0x4b2053(0x1c8)+_0x13d250[_0x4b2053(0x1ab)]);}}function a4_0x482c(){const _0xa5b911=['87608tatrxU','forEach','sendNotification','HEALTH_TRAIN_RESULT','reason','confidence','toISOString','payload','2777887NxWmGa','27ztYiMs','message','analysis.health.trendDiagnosis','constructor','entries','analysis.security.currentThreshold','debug','376419RLTyPe','apply','3533200TGKweT','analysis.prediction.confidence','analysis.energy.forecast','ENERGY_PREDICT_RESULT','toFixed','analysis.health.lastCheck','sendToPythonWrapper','analysis.health.isAnomaly','analysis.energy.insulationScore','service.py','‚úÖ\x20HEALTH\x20TRAINED.','Unknown','ANOMALY','(((.+)+)+)+$','Regel\x20erkannt:\x20','stdin','GAIT_RESULT','analysis.automation.detectedPatterns','425238AGwcLN','\x20->\x20Likely\x20','stringify','Error\x20launching\x20Python:\x20','Success:\x20','handlePrediction','1382640FLLqgs','parse','üîÆ\x20Prediction:\x20From\x20','info','details','path','startsWith','analysis.security.lastScore','1853330HfIBpJ','ENERGY_TRAIN_RESULT','length','./setup','analysis.energy.heatingScore','analysis.prediction.nextRoom','type','diagnosis','insulation','analysis.security.lastCheck','is_anomaly','analysis.training.status','analysis.automation.description','threshold','search','rule','error','join','success','TRAINING_COMPLETE','substring','close','writable','SECURITY_RESULT','stdout','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','TREND_RESULT','toString','PONG','analysis.health.gaitSpeed','data','COMFORT_RESULT','trim','child_process','TOPOLOGY_ACK','analysis.automation.patternDetected','existsSync','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','üêç\x20Python\x20Pong','log','Failed:\x20','setStateAsync','heating','analysis.alertReason','\x20new\x20patterns.','TOPOLOGY_RESULT','üõãÔ∏è\x20BUTLER:\x20Found\x20'];a4_0x482c=function(){return _0xa5b911;};return a4_0x482c();}function stopService(_0x401506){if(pythonProcess){try{pythonProcess['kill']();}catch(_0x18da47){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};