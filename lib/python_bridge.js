const a4_0x57329a=a4_0x3041;(function(_0x4bc9cd,_0x3c9612){const _0x12b07d=a4_0x3041,_0x4855c6=_0x4bc9cd();while(!![]){try{const _0x5705f8=parseInt(_0x12b07d(0xc0))/0x1+parseInt(_0x12b07d(0xe5))/0x2+-parseInt(_0x12b07d(0x117))/0x3*(parseInt(_0x12b07d(0xc5))/0x4)+parseInt(_0x12b07d(0xc8))/0x5*(-parseInt(_0x12b07d(0x124))/0x6)+-parseInt(_0x12b07d(0x11b))/0x7+parseInt(_0x12b07d(0x100))/0x8+parseInt(_0x12b07d(0xf4))/0x9*(parseInt(_0x12b07d(0xe8))/0xa);if(_0x5705f8===_0x3c9612)break;else _0x4855c6['push'](_0x4855c6['shift']());}catch(_0x187522){_0x4855c6['push'](_0x4855c6['shift']());}}}(a4_0x2201,0xc53a2));const a4_0x41332a=(function(){let _0x504d9e=!![];return function(_0x2fce84,_0x5d5e68){const _0x58b218=_0x504d9e?function(){const _0x1dcc9e=a4_0x3041;if(_0x5d5e68){const _0xd0d70a=_0x5d5e68[_0x1dcc9e(0x10e)](_0x2fce84,arguments);return _0x5d5e68=null,_0xd0d70a;}}:function(){};return _0x504d9e=![],_0x58b218;};}()),a4_0x34e5b4=a4_0x41332a(this,function(){const _0x1eda0f=a4_0x3041;return a4_0x34e5b4['toString']()[_0x1eda0f(0xfa)](_0x1eda0f(0x110))[_0x1eda0f(0xcb)]()[_0x1eda0f(0xd1)](a4_0x34e5b4)['search'](_0x1eda0f(0x110));});a4_0x34e5b4();'use strict';const {spawn}=require(a4_0x57329a(0x113)),path=require(a4_0x57329a(0xd5)),fs=require('fs'),setup=require(a4_0x57329a(0x102)),automation=require('./automation');function a4_0x2201(){const _0x297751=['exports','analysis.energy.warmupSources','analysis.security.lastScore','analysis.health.lastCheck','entries','error','2555754lsegyO','val','Unknown','20glPnjU','type','payload','[LOG]','service.py','analysis.energy.insulationScore','heating','is_anomaly','Success:\x20','analysis.security.currentThreshold','short','setStateAsync','9374193Jyrapo','keys','TRAINING_COMPLETE','message','analysis.energy.rlPenalties','analysis.energy.heatingScore','search','existsSync','âš ï¸\x20SECURITY\x20ALARM:\x20','join','analysis.training.status','kill','1237384eXaCsJ','RL_PENALTY_UPDATE','./setup','trim','sendToPythonWrapper','stdin','analysis.energy.warmupTimes','GAIT_RESULT','.\x20Please\x20create\x20this\x20file!','debug','analysis.prediction.trackerTopRoom','HEALTH_TREND_RESULT','toLocaleDateString','analysis.prediction.nextRoom','apply','2-digit','(((.+)+)+)+$','details','[PYTHON]\x20','child_process','toFixed','split','SIGNAL_RESULT','3297081quAcWG','handlePrediction','\x0aGrund:\x20','Failed:\x20','6229461gyBiCJ','COMFORT_RESULT','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','ENERGY_PREDICT_RESULT','analysis.security.lastCheck','analysis.health.isAnomaly','success','SECURITY_RESULT','applyEnergySavings','60EztKEU','python_service','de-DE','startsWith','530348muaQUF','forEach','write','analysis.health.gaitSpeed','stringify','4omcadF','substring','\x20AND\x20','624630yzIplh','reason','insulation','toString','stderr','PINN_PREDICT_RESULT','length','sendNotification','Error\x20launching\x20Python:\x20','constructor','TRACKER_RESULT','âœ…\x20HEALTH\x20TRAINED.','analysis.alertReason','path','analysis.prediction.trackerConfidence','analysis.automation.detectedPatterns','VENTILATION_ALERT','warn','data','toISOString','log','parse','analysis.energy.forecast'];a4_0x2201=function(){return _0x297751;};return a4_0x2201();}let pythonProcess=null;function a4_0x3041(_0x336dc3,_0x3ba3e2){const _0x1745ee=a4_0x2201();return a4_0x3041=function(_0x34e5b4,_0x41332a){_0x34e5b4=_0x34e5b4-0xbd;let _0x220129=_0x1745ee[_0x34e5b4];return _0x220129;},a4_0x3041(_0x336dc3,_0x3ba3e2);}function send(_0x31a0e2,_0x2ac036,_0x9f565c={}){const _0x47ce6d=a4_0x57329a;if(!pythonProcess||!pythonProcess[_0x47ce6d(0x105)]['writable'])return;const _0x55492f=JSON[_0x47ce6d(0xc4)]({'command':_0x2ac036,..._0x9f565c});try{pythonProcess[_0x47ce6d(0x105)][_0x47ce6d(0xc2)](_0x55492f+'\x0a');}catch(_0x3441a6){}}function handleResult(_0x4cac66,_0x59c5f5){const _0x859726=a4_0x57329a;if(_0x59c5f5[_0x859726(0xe9)]==='PONG')_0x4cac66['log'][_0x859726(0x109)]('ðŸ\x20Python\x20Pong');else{if(_0x59c5f5[_0x859726(0xe9)]===_0x859726(0x122)){const {anomaly_score:_0x412d01,is_anomaly:_0x1b74c6,threshold:_0x195bb7,explanation:_0x270ea6}=_0x59c5f5[_0x859726(0xea)];_0x4cac66[_0x859726(0xf3)](_0x859726(0xe1),{'val':_0x412d01,'ack':!![]}),_0x4cac66[_0x859726(0xf3)](_0x859726(0x11f),{'val':new Date()[_0x859726(0xdb)](),'ack':!![]});if(_0x195bb7)_0x4cac66[_0x859726(0xf3)]('analysis.security.currentThreshold',{'val':_0x195bb7,'ack':!![]});if(_0x1b74c6){let _0x4c5936=_0x859726(0x11d)+_0x412d01[_0x859726(0x114)](0x4)+')';if(_0x270ea6&&_0x270ea6!==_0x859726(0xe7))_0x4c5936+=_0x859726(0x119)+_0x270ea6;_0x4cac66[_0x859726(0xf3)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x4cac66[_0x859726(0xf3)](_0x859726(0xd4),{'val':_0x4c5936,'ack':!![]}),setup[_0x859726(0xcf)](_0x4cac66,_0x859726(0xfc)+_0x4c5936,![],!![]);}}else{if(_0x59c5f5[_0x859726(0xe9)]===_0x859726(0xf6)){const _0x2ee24e=_0x59c5f5[_0x859726(0xea)][_0x859726(0x111)]||'',_0xe8dce=_0x59c5f5[_0x859726(0xea)]['threshold'],_0x2c100f=_0x59c5f5[_0x859726(0xea)]['success']?_0x859726(0xf0)+new Date()['toLocaleTimeString']()+'\x20('+_0x2ee24e+')':_0x859726(0x11a)+_0x59c5f5['payload'][_0x859726(0xc9)];_0x4cac66[_0x859726(0xf3)](_0x859726(0xfe),{'val':_0x2c100f,'ack':!![]});if(_0x59c5f5[_0x859726(0xea)][_0x859726(0x121)]&&_0xe8dce)_0x4cac66[_0x859726(0xf3)](_0x859726(0xf1),{'val':_0xe8dce,'ack':!![]});}else{if(_0x59c5f5[_0x859726(0xe9)]==='ENERGY_TRAIN_RESULT'){if(_0x59c5f5[_0x859726(0xea)][_0x859726(0x121)])try{const _0x501639=JSON[_0x859726(0xdd)](_0x59c5f5[_0x859726(0xea)][_0x859726(0x111)]);if(_0x501639[_0x859726(0xca)])_0x4cac66[_0x859726(0xf3)](_0x859726(0xed),{'val':JSON['stringify'](_0x501639[_0x859726(0xca)]),'ack':!![]});if(_0x501639['heating'])_0x4cac66[_0x859726(0xf3)](_0x859726(0xf9),{'val':JSON['stringify'](_0x501639[_0x859726(0xee)]),'ack':!![]});}catch(_0x41f346){}}else{if(_0x59c5f5[_0x859726(0xe9)]==='HEALTH_TRAIN_RESULT'){if(_0x59c5f5[_0x859726(0xea)][_0x859726(0x121)]){_0x4cac66['log']['info'](_0x859726(0xd3));const _0x17e53c=new Date(),_0x41640b=_0x17e53c[_0x859726(0x10c)]('de-DE',{'day':'2-digit','month':'short','hour':_0x859726(0x10f),'minute':_0x859726(0x10f)});_0x4cac66[_0x859726(0xf3)]('analysis.health.lastCheck',{'val':_0x41640b,'ack':!![]});}}else{if(_0x59c5f5[_0x859726(0xe9)]==='HEALTH_RESULT'){const _0x4a90d5=new Date(),_0x1c981c=_0x4a90d5[_0x859726(0x10c)]('de-DE',{'day':_0x859726(0x10f),'month':_0x859726(0xf2),'hour':_0x859726(0x10f),'minute':_0x859726(0x10f)});_0x4cac66[_0x859726(0xf3)](_0x859726(0xe2),{'val':_0x1c981c,'ack':!![]}),_0x4cac66[_0x859726(0xf3)](_0x859726(0x120),{'val':_0x59c5f5[_0x859726(0xea)][_0x859726(0xef)],'ack':!![]});}else{if(_0x59c5f5['type']===_0x859726(0x10b)){const {trend_percent:_0x4b9a4c,details:_0x42fd54}=_0x59c5f5[_0x859726(0xea)],_0x4b5ebc=new Date(),_0x405a4c=_0x4b5ebc[_0x859726(0x10c)](_0x859726(0xbe),{'day':_0x859726(0x10f),'month':'short','hour':_0x859726(0x10f),'minute':_0x859726(0x10f)});_0x4cac66['setStateAsync'](_0x859726(0xe2),{'val':_0x405a4c,'ack':!![]}),_0x4cac66['setStateAsync'](_0x859726(0xc3),{'val':_0x4b9a4c,'ack':!![]}),_0x4cac66[_0x859726(0xdc)]['info']('ðŸ“ˆ\x20Health\x20Trend:\x20'+_0x42fd54);}else{if(_0x59c5f5[_0x859726(0xe9)]===_0x859726(0x107)){const {speed_trend:_0x12c6a9}=_0x59c5f5[_0x859726(0xea)];if(_0x12c6a9!==undefined)_0x4cac66[_0x859726(0xf3)](_0x859726(0xc3),{'val':_0x12c6a9,'ack':!![]});}else{if(_0x59c5f5[_0x859726(0xe9)]===_0x859726(0x11e)){const {forecast:_0x14dff7}=_0x59c5f5['payload'];if(_0x14dff7)_0x4cac66['setStateAsync'](_0x859726(0xde),{'val':JSON[_0x859726(0xc4)](_0x14dff7),'ack':!![]});}else{if(_0x59c5f5[_0x859726(0xe9)]==='WARMUP_RESULT'){const {times:_0x1c4965,sources:_0x504bef,details:_0x5b9bf8}=_0x59c5f5[_0x859726(0xea)];if(_0x1c4965)_0x4cac66[_0x859726(0xf3)](_0x859726(0x106),{'val':JSON[_0x859726(0xc4)](_0x1c4965),'ack':!![]});if(_0x504bef)_0x4cac66[_0x859726(0xf3)](_0x859726(0xe0),{'val':JSON[_0x859726(0xc4)](_0x504bef),'ack':!![]});if(_0x5b9bf8)_0x4cac66[_0x859726(0xf3)]('analysis.energy.warmupDetails',{'val':JSON[_0x859726(0xc4)](_0x5b9bf8),'ack':!![]});}else{if(_0x59c5f5[_0x859726(0xe9)]===_0x859726(0x101)){const {penalties:_0x5923cc}=_0x59c5f5['payload'];if(_0x5923cc)_0x4cac66[_0x859726(0xf3)](_0x859726(0xf8),{'val':JSON['stringify'](_0x5923cc),'ack':!![]});}else{if(_0x59c5f5[_0x859726(0xe9)]===_0x859726(0xcd)){const {forecast:_0x1e4ff9}=_0x59c5f5[_0x859726(0xea)];if(_0x1e4ff9)_0x4cac66[_0x859726(0xf3)]('analysis.energy.pinnForecast',{'val':JSON[_0x859726(0xc4)](_0x1e4ff9),'ack':!![]});}else{if(_0x59c5f5[_0x859726(0xe9)]===_0x859726(0xd8)){const {alerts:_0x2f1f1e}=_0x59c5f5[_0x859726(0xea)];if(_0x2f1f1e)_0x4cac66[_0x859726(0xf3)]('analysis.energy.ventilationAlerts',{'val':JSON[_0x859726(0xc4)](_0x2f1f1e),'ack':!![]});}else{if(_0x59c5f5[_0x859726(0xe9)]==='ENERGY_OPTIMIZE_RESULT'){const {proposals:_0x361c30}=_0x59c5f5[_0x859726(0xea)];_0x4cac66['getState']('analysis.energy.mpcActive',(_0x79ead4,_0x1f3582)=>{const _0x1f0faa=_0x859726;_0x1f3582&&_0x1f3582[_0x1f0faa(0xe6)]===!![]&&_0x361c30&&_0x361c30[_0x1f0faa(0xce)]>0x0&&automation[_0x1f0faa(0x123)](_0x4cac66,_0x361c30);});}else{if(_0x59c5f5[_0x859726(0xe9)]===_0x859726(0x116)){const {room:_0x378498,propagation:_0x114c49}=_0x59c5f5[_0x859726(0xea)];let _0x3f91bd=_0x859726(0xe7),_0x20b4b0=0x0;if(_0x114c49){const _0x1eb6e5=Object[_0x859726(0xe3)](_0x114c49);_0x1eb6e5[_0x859726(0xce)]>0x0&&(_0x3f91bd=_0x1eb6e5[0x0][0x0],_0x20b4b0=_0x1eb6e5[0x0][0x1]);}_0x4cac66[_0x859726(0xf3)](_0x859726(0x10d),{'val':_0x3f91bd,'ack':!![]}),_0x4cac66['setStateAsync']('analysis.prediction.confidence',{'val':_0x20b4b0,'ack':!![]}),automation[_0x859726(0x118)](_0x4cac66,_0x3f91bd,_0x20b4b0);}else{if(_0x59c5f5['type']===_0x859726(0xd2)){const {probabilities:_0x5c1ba8}=_0x59c5f5[_0x859726(0xea)];if(_0x5c1ba8){_0x4cac66[_0x859726(0xf3)]('analysis.prediction.trackerState',{'val':JSON[_0x859726(0xc4)](_0x5c1ba8),'ack':!![]});const _0x548a9c=Object[_0x859726(0xf5)](_0x5c1ba8);if(_0x548a9c[_0x859726(0xce)]>0x0){const _0x4ba0f8=_0x548a9c[0x0],_0x29798c=_0x5c1ba8[_0x4ba0f8];_0x4cac66[_0x859726(0xf3)](_0x859726(0x10a),{'val':_0x4ba0f8,'ack':!![]}),_0x4cac66[_0x859726(0xf3)](_0x859726(0xd6),{'val':_0x29798c,'ack':!![]});}}}else{if(_0x59c5f5['type']===_0x859726(0x11c)){const {patterns:_0x4f579d}=_0x59c5f5[_0x859726(0xea)];if(_0x4f579d&&_0x4f579d[_0x859726(0xce)]>0x0)_0x4cac66[_0x859726(0xf3)](_0x859726(0xd7),{'val':JSON[_0x859726(0xc4)](_0x4f579d),'ack':!![]});}}}}}}}}}}}}}}}}}}function startService(_0x768e7a,_0x19aeb5){const _0x551580=a4_0x57329a;let _0xdcf959='python3';if(fs[_0x551580(0xfb)](_0x19aeb5))_0xdcf959=_0x19aeb5;const _0x2472c5=path['join'](__dirname,'..',_0x551580(0xec)),_0x2310c5=path[_0x551580(0xfd)](__dirname,'..',_0x551580(0xbd),_0x551580(0xec));let _0xb3e111='';if(fs[_0x551580(0xfb)](_0x2472c5))_0xb3e111=_0x2472c5;else{if(fs[_0x551580(0xfb)](_0x2310c5))_0xb3e111=_0x2310c5;else{_0x768e7a['log'][_0x551580(0xe4)]('âŒ\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!\x20Checked:\x20'+_0x2472c5+_0x551580(0xc7)+_0x2310c5+_0x551580(0x108));return;}}try{_0x768e7a[_0x551580(0xdc)]['info']('ðŸš€\x20Starting\x20Python\x20Bridge\x20using:\x20'+_0xdcf959+'\x20'+_0xb3e111),pythonProcess=spawn(_0xdcf959,[_0xb3e111]),pythonProcess['stdout']['on'](_0x551580(0xda),_0x41e3db=>{const _0x133737=_0x551580,_0x3875d3=_0x41e3db['toString']()[_0x133737(0x115)]('\x0a');_0x3875d3[_0x133737(0xc1)](_0x7cb050=>{const _0x596e56=_0x133737,_0x26a0a0=_0x7cb050[_0x596e56(0x103)]();if(!_0x26a0a0)return;if(_0x26a0a0[_0x596e56(0xbf)](_0x596e56(0xeb)))_0x768e7a['log'][_0x596e56(0x109)](_0x596e56(0x112)+_0x26a0a0[_0x596e56(0xc6)](0x5)['trim']());else{if(_0x26a0a0[_0x596e56(0xbf)]('[RESULT]'))try{const _0x5242b3=JSON[_0x596e56(0xdd)](_0x26a0a0[_0x596e56(0xc6)](0x8)['trim']());handleResult(_0x768e7a,_0x5242b3);}catch(_0x414303){}}});}),pythonProcess[_0x551580(0xcc)]['on'](_0x551580(0xda),_0x122730=>{const _0x5bbf84=_0x551580;_0x768e7a[_0x5bbf84(0xdc)][_0x5bbf84(0xe4)]('[PYTHON\x20ERR]\x20'+_0x122730[_0x5bbf84(0xcb)]()['trim']());}),pythonProcess['on']('close',_0x3f10d4=>{const _0x398de2=_0x551580;_0x768e7a[_0x398de2(0xdc)][_0x398de2(0xd9)]('Python\x20process\x20exited\x20with\x20code\x20'+_0x3f10d4),pythonProcess=null;}),_0x768e7a[_0x551580(0x104)]=(_0x2a6139,_0x2b01e0)=>send(_0x768e7a,_0x2a6139,_0x2b01e0);}catch(_0x214e7c){_0x768e7a[_0x551580(0xdc)][_0x551580(0xe4)](_0x551580(0xd0)+_0x214e7c[_0x551580(0xf7)]);}}function stopService(_0x2f0685){const _0x5cd742=a4_0x57329a;if(pythonProcess){try{pythonProcess[_0x5cd742(0xff)]();}catch(_0x1fac1d){}pythonProcess=null;}}module[a4_0x57329a(0xdf)]={'startService':startService,'stopService':stopService,'send':send};