const a4_0x2db712=a4_0x12dc;(function(_0x22140b,_0x509889){const _0x2e519f=a4_0x12dc,_0x27717f=_0x22140b();while(!![]){try{const _0x1ff273=parseInt(_0x2e519f(0x1a7))/0x1+-parseInt(_0x2e519f(0x1a6))/0x2+parseInt(_0x2e519f(0x191))/0x3+-parseInt(_0x2e519f(0x19f))/0x4+parseInt(_0x2e519f(0x188))/0x5+parseInt(_0x2e519f(0x1c0))/0x6*(parseInt(_0x2e519f(0x18b))/0x7)+-parseInt(_0x2e519f(0x1cc))/0x8;if(_0x1ff273===_0x509889)break;else _0x27717f['push'](_0x27717f['shift']());}catch(_0x1d888e){_0x27717f['push'](_0x27717f['shift']());}}}(a4_0x56c0,0xa5878));const a4_0x4ac4f7=(function(){let _0xafd40=!![];return function(_0x43f2d1,_0x3220fb){const _0x58b13f=_0xafd40?function(){const _0x49355c=a4_0x12dc;if(_0x3220fb){const _0xb782d9=_0x3220fb[_0x49355c(0x192)](_0x43f2d1,arguments);return _0x3220fb=null,_0xb782d9;}}:function(){};return _0xafd40=![],_0x58b13f;};}()),a4_0xebbdd5=a4_0x4ac4f7(this,function(){const _0x49a1f9=a4_0x12dc;return a4_0xebbdd5[_0x49a1f9(0x1c1)]()[_0x49a1f9(0x1d2)]('(((.+)+)+)+$')['toString']()['constructor'](a4_0xebbdd5)['search'](_0x49a1f9(0x1b9));});a4_0xebbdd5();'use strict';const {spawn}=require(a4_0x2db712(0x1ce)),path=require(a4_0x2db712(0x1d3)),fs=require('fs'),setup=require(a4_0x2db712(0x1cf)),automation=require(a4_0x2db712(0x1d8));function a4_0x56c0(){const _0x242888=['âš ï¸\x20SECURITY\x20ALARM:\x20','Error\x20launching\x20Python:\x20','ANOMALY','is_anomaly','kill','(((.+)+)+)+$','change_percent','toFixed','[PYTHON]\x20','info','stdout','analysis.health.trendValue','50574TPiEBq','toString','debug','details','SIGNAL_RESULT','existsSync','Success:\x20','diagnosis','analysis.prediction.confidence','TREND_RESULT','analysis.energy.forecast','log','5867864iByjJB','ðŸ”®\x20Prediction:\x20From\x20','child_process','./setup','startsWith','âœ…\x20HEALTH\x20TRAINED.','search','path','forEach','analysis.automation.detectedPatterns','stringify','GAIT_RESULT','./automation','\x20->\x20','stdin','analysis.health.lastCheck','COMFORT_RESULT','toLocaleTimeString','HEALTH_TRAIN_RESULT','analysis.health.gaitSpeed','ENERGY_TRAIN_RESULT','data','analysis.health.trendDiagnosis','writable','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','Unknown','PONG','join','analysis.security.currentThreshold','insulation','sendToPythonWrapper','analysis.energy.heatingScore','[LOG]','close','sendNotification','2001555UKiErH','rule','\x20new\x20patterns.','133DJcKvJ','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','service.py','handlePrediction','Regel\x20erkannt:\x20','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','3909579QWsXcg','apply','analysis.prediction.nextRoom','analysis.isAlert','message','analysis.health.isAnomaly','TRAINING_COMPLETE','length','confidence','HEALTH_RESULT','\x20->\x20Likely\x20','setStateAsync','\x0aGrund:\x20','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','5154320TuwrES','python_service','payload','analysis.security.lastScore','substring','trim','analysis.automation.patternDetected','747680iXYcGW','1210256nnoDtL','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','ðŸ\x20Python\x20confirmed\x20new\x20topology.','type','toISOString','analysis.training.status','TOPOLOGY_ACK','heating','reason','split','Failed:\x20','ENERGY_PREDICT_RESULT','success'];a4_0x56c0=function(){return _0x242888;};return a4_0x56c0();}let pythonProcess=null;function send(_0x4eae58,_0x512983,_0x43d1b0={}){const _0x1b3c2e=a4_0x2db712;if(!pythonProcess||!pythonProcess[_0x1b3c2e(0x1da)][_0x1b3c2e(0x1e3)])return;const _0x224e8e=JSON['stringify']({'command':_0x512983,..._0x43d1b0});try{pythonProcess['stdin']['write'](_0x224e8e+'\x0a');}catch(_0x73c659){}}function handleResult(_0x2ebc06,_0x18decc){const _0x571d57=a4_0x2db712;if(_0x18decc['type']===_0x571d57(0x1e6))_0x2ebc06[_0x571d57(0x1cb)]['debug']('ðŸ\x20Python\x20Pong');else{if(_0x18decc[_0x571d57(0x1aa)]==='SECURITY_RESULT'){const {anomaly_score:_0x401751,is_anomaly:_0x4b33fb,threshold:_0x502c13,explanation:_0x11ed09}=_0x18decc[_0x571d57(0x1a1)];_0x2ebc06[_0x571d57(0x1cb)][_0x571d57(0x1bd)](_0x571d57(0x19e)+_0x401751[_0x571d57(0x1bb)](0x5)+_0x571d57(0x1d9)+(_0x4b33fb?_0x571d57(0x1b6):'OK')),_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x1a2),{'val':_0x401751,'ack':!![]}),_0x2ebc06[_0x571d57(0x19c)]('analysis.security.lastCheck',{'val':new Date()['toISOString'](),'ack':!![]});if(_0x502c13)_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x181),{'val':_0x502c13,'ack':!![]});if(_0x4b33fb){let _0x12efd6=_0x571d57(0x190)+_0x401751[_0x571d57(0x1bb)](0x4)+')';if(_0x11ed09&&_0x11ed09!==_0x571d57(0x1e5))_0x12efd6+=_0x571d57(0x19d)+_0x11ed09;_0x2ebc06['setStateAsync'](_0x571d57(0x194),{'val':!![],'ack':!![]}),_0x2ebc06[_0x571d57(0x19c)]('analysis.alertReason',{'val':_0x12efd6,'ack':!![]}),setup[_0x571d57(0x187)](_0x2ebc06,_0x571d57(0x1b4)+_0x12efd6,![],!![]);}}else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x197)){const _0x1e8b8d=_0x18decc['payload'][_0x571d57(0x1c3)]||'',_0x4516ca=_0x18decc['payload']['threshold'],_0x2b0524=_0x18decc['payload'][_0x571d57(0x1b3)]?_0x571d57(0x1c6)+new Date()[_0x571d57(0x1dd)]()+'\x20('+_0x1e8b8d+')':_0x571d57(0x1b1)+_0x18decc[_0x571d57(0x1a1)][_0x571d57(0x1af)];_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x1ac),{'val':_0x2b0524,'ack':!![]});if(_0x18decc['payload'][_0x571d57(0x1b3)]&&_0x4516ca)_0x2ebc06[_0x571d57(0x19c)]('analysis.security.currentThreshold',{'val':_0x4516ca,'ack':!![]});}else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x1dc)){const {patterns:_0x3c90d0}=_0x18decc[_0x571d57(0x1a1)];if(_0x3c90d0&&_0x3c90d0[_0x571d57(0x198)]>0x0){_0x2ebc06[_0x571d57(0x1cb)]['info'](_0x571d57(0x18c)+_0x3c90d0[_0x571d57(0x198)]+_0x571d57(0x18a)),_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x1d5),{'val':JSON['stringify'](_0x3c90d0),'ack':!![]});const _0x37ad96=_0x3c90d0[0x0],_0x10a297=_0x571d57(0x18f)+_0x37ad96[_0x571d57(0x189)]+'\x20('+(_0x37ad96[_0x571d57(0x199)]*0x64)['toFixed'](0x0)+'%)';_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x1a5),{'val':!![],'ack':!![]}),_0x2ebc06[_0x571d57(0x19c)]('analysis.automation.description',{'val':_0x10a297,'ack':!![]});}else _0x2ebc06[_0x571d57(0x1cb)][_0x571d57(0x1bd)](_0x571d57(0x1a8)),_0x2ebc06['setStateAsync']('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x1d5),{'val':'[]','ack':!![]});}else{if(_0x18decc['type']===_0x571d57(0x1e0)){if(_0x18decc['payload']['success'])try{const _0x54310f=JSON['parse'](_0x18decc[_0x571d57(0x1a1)][_0x571d57(0x1c3)]);if(_0x54310f[_0x571d57(0x182)])_0x2ebc06['setStateAsync']('analysis.energy.insulationScore',{'val':JSON[_0x571d57(0x1d6)](_0x54310f[_0x571d57(0x182)]),'ack':!![]});if(_0x54310f[_0x571d57(0x1ae)])_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x184),{'val':JSON['stringify'](_0x54310f[_0x571d57(0x1ae)]),'ack':!![]});}catch(_0x3c3cd0){}}else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x1de)){if(_0x18decc[_0x571d57(0x1a1)]['success'])_0x2ebc06['log'][_0x571d57(0x1bd)](_0x571d57(0x1d1));}else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x19a))_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x1db),{'val':new Date()[_0x571d57(0x1ab)](),'ack':!![]}),_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x196),{'val':_0x18decc[_0x571d57(0x1a1)][_0x571d57(0x1b7)],'ack':!![]});else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x1c9))_0x2ebc06['setStateAsync'](_0x571d57(0x1e2),{'val':_0x18decc[_0x571d57(0x1a1)][_0x571d57(0x1c7)],'ack':!![]}),_0x2ebc06[_0x571d57(0x19c)](_0x571d57(0x1bf),{'val':_0x18decc[_0x571d57(0x1a1)][_0x571d57(0x1ba)],'ack':!![]});else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x1d7)){const {speed_trend:_0x2cc9a9}=_0x18decc[_0x571d57(0x1a1)];if(_0x2cc9a9!==undefined)_0x2ebc06['setStateAsync'](_0x571d57(0x1df),{'val':_0x2cc9a9,'ack':!![]});}else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x1b2)){const {forecast:_0x224994}=_0x18decc[_0x571d57(0x1a1)];if(_0x224994)_0x2ebc06['setStateAsync'](_0x571d57(0x1ca),{'val':JSON[_0x571d57(0x1d6)](_0x224994),'ack':!![]});}else{if(_0x18decc[_0x571d57(0x1aa)]==='TOPOLOGY_RESULT'){const {data:_0x20af70}=_0x18decc[_0x571d57(0x1a1)];_0x20af70&&(_0x2ebc06[_0x571d57(0x1cb)][_0x571d57(0x1bd)](_0x571d57(0x1e4)),_0x2ebc06[_0x571d57(0x19c)]('analysis.security.topologyMatrix',{'val':JSON[_0x571d57(0x1d6)](_0x20af70),'ack':!![]}));}else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x1ad))_0x2ebc06[_0x571d57(0x1cb)][_0x571d57(0x1c2)](_0x571d57(0x1a9));else{if(_0x18decc[_0x571d57(0x1aa)]===_0x571d57(0x1c4)){const {room:_0x594a4c,propagation:_0x40883b}=_0x18decc[_0x571d57(0x1a1)];let _0x4abc6a='Unknown',_0x5abe06=0x0;if(_0x40883b){const _0x4f0a35=Object['entries'](_0x40883b);_0x4f0a35[_0x571d57(0x198)]>0x0&&(_0x4abc6a=_0x4f0a35[0x0][0x0],_0x5abe06=_0x4f0a35[0x0][0x1]);}_0x2ebc06['setStateAsync'](_0x571d57(0x193),{'val':_0x4abc6a,'ack':!![]}),_0x2ebc06['setStateAsync'](_0x571d57(0x1c8),{'val':_0x5abe06,'ack':!![]}),_0x5abe06>0.4&&_0x2ebc06[_0x571d57(0x1cb)][_0x571d57(0x1c2)](_0x571d57(0x1cd)+_0x594a4c+_0x571d57(0x19b)+_0x4abc6a+'\x20('+(_0x5abe06*0x64)[_0x571d57(0x1bb)](0x0)+'%)'),automation[_0x571d57(0x18e)](_0x2ebc06,_0x4abc6a,_0x5abe06);}}}}}}}}}}}}}}function startService(_0x8c1914,_0x3e3368){const _0x4abaea=a4_0x2db712;let _0x189ff4='python3';if(fs[_0x4abaea(0x1c5)](_0x3e3368))_0x189ff4=_0x3e3368;try{const _0x1b4a86=path[_0x4abaea(0x1e7)](__dirname,'..',_0x4abaea(0x1a0),_0x4abaea(0x18d));pythonProcess=spawn(_0x189ff4,[_0x1b4a86]),pythonProcess[_0x4abaea(0x1be)]['on'](_0x4abaea(0x1e1),_0x19f339=>{const _0x4cc7a2=_0x4abaea,_0x24a1cf=_0x19f339[_0x4cc7a2(0x1c1)]()[_0x4cc7a2(0x1b0)]('\x0a');_0x24a1cf[_0x4cc7a2(0x1d4)](_0x22ad8c=>{const _0x38296e=_0x4cc7a2,_0x5700ca=_0x22ad8c[_0x38296e(0x1a4)]();if(!_0x5700ca)return;if(_0x5700ca['startsWith'](_0x38296e(0x185)))_0x8c1914['log'][_0x38296e(0x1c2)](_0x38296e(0x1bc)+_0x5700ca[_0x38296e(0x1a3)](0x5)[_0x38296e(0x1a4)]());else{if(_0x5700ca[_0x38296e(0x1d0)]('[RESULT]'))try{const _0x2d2c35=JSON['parse'](_0x5700ca[_0x38296e(0x1a3)](0x8)['trim']());handleResult(_0x8c1914,_0x2d2c35);}catch(_0x251e1e){}}});}),pythonProcess['on'](_0x4abaea(0x186),_0xa1a762=>{pythonProcess=null;}),_0x8c1914[_0x4abaea(0x183)]=(_0x3ab5d8,_0x14be1b)=>send(_0x8c1914,_0x3ab5d8,_0x14be1b);}catch(_0x5002ed){_0x8c1914[_0x4abaea(0x1cb)]['error'](_0x4abaea(0x1b5)+_0x5002ed[_0x4abaea(0x195)]);}}function a4_0x12dc(_0x2c63b6,_0x5d58ab){const _0x3308ed=a4_0x56c0();return a4_0x12dc=function(_0xebbdd5,_0x4ac4f7){_0xebbdd5=_0xebbdd5-0x181;let _0x56c00d=_0x3308ed[_0xebbdd5];return _0x56c00d;},a4_0x12dc(_0x2c63b6,_0x5d58ab);}function stopService(_0x561a85){const _0x202ad2=a4_0x2db712;if(pythonProcess){try{pythonProcess[_0x202ad2(0x1b8)]();}catch(_0x4350f9){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};