const a4_0x149126=a4_0x4655;(function(_0x58898e,_0x493a80){const _0x535736=a4_0x4655,_0x1f1601=_0x58898e();while(!![]){try{const _0x442f4f=parseInt(_0x535736(0x19a))/0x1*(-parseInt(_0x535736(0x1de))/0x2)+-parseInt(_0x535736(0x1db))/0x3+parseInt(_0x535736(0x1a8))/0x4+parseInt(_0x535736(0x19c))/0x5*(parseInt(_0x535736(0x1d6))/0x6)+parseInt(_0x535736(0x1e3))/0x7+-parseInt(_0x535736(0x1ab))/0x8*(parseInt(_0x535736(0x193))/0x9)+parseInt(_0x535736(0x1d8))/0xa*(parseInt(_0x535736(0x1ac))/0xb);if(_0x442f4f===_0x493a80)break;else _0x1f1601['push'](_0x1f1601['shift']());}catch(_0x340b6c){_0x1f1601['push'](_0x1f1601['shift']());}}}(a4_0x22e7,0x8a016));const a4_0x55d39f=(function(){let _0x2c91d9=!![];return function(_0xb48bce,_0x437fa4){const _0x20f7ff=_0x2c91d9?function(){if(_0x437fa4){const _0x3a6418=_0x437fa4['apply'](_0xb48bce,arguments);return _0x437fa4=null,_0x3a6418;}}:function(){};return _0x2c91d9=![],_0x20f7ff;};}()),a4_0x81544=a4_0x55d39f(this,function(){const _0x1e986e=a4_0x4655;return a4_0x81544[_0x1e986e(0x1b5)]()[_0x1e986e(0x1e2)](_0x1e986e(0x1ba))[_0x1e986e(0x1b5)]()['constructor'](a4_0x81544)[_0x1e986e(0x1e2)](_0x1e986e(0x1ba));});a4_0x81544();'use strict';const {spawn}=require(a4_0x149126(0x1a1)),path=require(a4_0x149126(0x195)),fs=require('fs'),setup=require(a4_0x149126(0x197)),automation=require('./automation');let pythonProcess=null;function send(_0x43f82e,_0x3db871,_0x1e37d8={}){const _0x491a79=a4_0x149126;if(!pythonProcess||!pythonProcess[_0x491a79(0x18d)][_0x491a79(0x1a9)])return;const _0x4c3f36=JSON[_0x491a79(0x196)]({'command':_0x3db871,..._0x1e37d8});try{pythonProcess[_0x491a79(0x18d)][_0x491a79(0x1a4)](_0x4c3f36+'\x0a');}catch(_0x387db6){}}function handleResult(_0x16f05b,_0x255462){const _0x44a9c1=a4_0x149126;if(_0x255462[_0x44a9c1(0x1c1)]===_0x44a9c1(0x19b))_0x16f05b[_0x44a9c1(0x194)][_0x44a9c1(0x1aa)](_0x44a9c1(0x1a2));else{if(_0x255462[_0x44a9c1(0x1c1)]===_0x44a9c1(0x1cb)){const {anomaly_score:_0x1d900c,is_anomaly:_0x383c04,threshold:_0x44694d,explanation:_0x57b719}=_0x255462[_0x44a9c1(0x1da)];_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x1a5),{'val':_0x1d900c,'ack':!![]}),_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x1b4),{'val':new Date()[_0x44a9c1(0x1d9)](),'ack':!![]});if(_0x44694d)_0x16f05b[_0x44a9c1(0x18b)]('analysis.security.currentThreshold',{'val':_0x44694d,'ack':!![]});if(_0x383c04){let _0x57369e=_0x44a9c1(0x1bf)+_0x1d900c[_0x44a9c1(0x198)](0x4)+')';if(_0x57b719&&_0x57b719!==_0x44a9c1(0x1b6))_0x57369e+=_0x44a9c1(0x1ae)+_0x57b719;_0x16f05b['setStateAsync'](_0x44a9c1(0x1d4),{'val':!![],'ack':!![]}),_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x1c7),{'val':_0x57369e,'ack':!![]}),setup[_0x44a9c1(0x1dd)](_0x16f05b,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x57369e,![],!![]);}}else{if(_0x255462[_0x44a9c1(0x1c1)]===_0x44a9c1(0x1c6)){const _0x4289b4=_0x255462[_0x44a9c1(0x1da)][_0x44a9c1(0x1c4)]||'',_0x31839e=_0x255462['payload'][_0x44a9c1(0x1df)],_0x54b0f8=_0x255462[_0x44a9c1(0x1da)][_0x44a9c1(0x191)]?'Success:\x20'+new Date()['toLocaleTimeString']()+'\x20('+_0x4289b4+')':_0x44a9c1(0x1ca)+_0x255462[_0x44a9c1(0x1da)][_0x44a9c1(0x1b7)];_0x16f05b['setStateAsync']('analysis.training.status',{'val':_0x54b0f8,'ack':!![]});if(_0x255462[_0x44a9c1(0x1da)][_0x44a9c1(0x191)]&&_0x31839e)_0x16f05b[_0x44a9c1(0x18b)]('analysis.security.currentThreshold',{'val':_0x31839e,'ack':!![]});}else{if(_0x255462[_0x44a9c1(0x1c1)]===_0x44a9c1(0x1d2)){if(_0x255462[_0x44a9c1(0x1da)][_0x44a9c1(0x191)])try{const _0x107339=JSON[_0x44a9c1(0x18f)](_0x255462[_0x44a9c1(0x1da)][_0x44a9c1(0x1c4)]);if(_0x107339['insulation'])_0x16f05b['setStateAsync'](_0x44a9c1(0x1ad),{'val':JSON[_0x44a9c1(0x196)](_0x107339[_0x44a9c1(0x1bb)]),'ack':!![]});if(_0x107339[_0x44a9c1(0x1a7)])_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x19f),{'val':JSON[_0x44a9c1(0x196)](_0x107339[_0x44a9c1(0x1a7)]),'ack':!![]});}catch(_0x42bf2c){}}else{if(_0x255462[_0x44a9c1(0x1c1)]==='HEALTH_TRAIN_RESULT'){if(_0x255462['payload'][_0x44a9c1(0x191)])_0x16f05b['log']['info'](_0x44a9c1(0x18e));}else{if(_0x255462[_0x44a9c1(0x1c1)]===_0x44a9c1(0x1a3))_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x1e1),{'val':new Date()[_0x44a9c1(0x1d9)](),'ack':!![]}),_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x18c),{'val':_0x255462['payload']['is_anomaly'],'ack':!![]});else{if(_0x255462['type']===_0x44a9c1(0x1b2)){const {speed_trend:_0x472530}=_0x255462[_0x44a9c1(0x1da)];if(_0x472530!==undefined)_0x16f05b['setStateAsync'](_0x44a9c1(0x1c0),{'val':_0x472530,'ack':!![]});}else{if(_0x255462['type']===_0x44a9c1(0x1a6)){const {forecast:_0x436778}=_0x255462[_0x44a9c1(0x1da)];if(_0x436778)_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x192),{'val':JSON['stringify'](_0x436778),'ack':!![]});}else{if(_0x255462[_0x44a9c1(0x1c1)]===_0x44a9c1(0x1cd)){const {times:_0x1f6bce,sources:_0x13e53d,details:_0x36efea}=_0x255462[_0x44a9c1(0x1da)];if(_0x1f6bce)_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x1b1),{'val':JSON['stringify'](_0x1f6bce),'ack':!![]});if(_0x13e53d)_0x16f05b[_0x44a9c1(0x18b)]('analysis.energy.warmupSources',{'val':JSON['stringify'](_0x13e53d),'ack':!![]});if(_0x36efea)_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x1b3),{'val':JSON[_0x44a9c1(0x196)](_0x36efea),'ack':!![]});}else{if(_0x255462[_0x44a9c1(0x1c1)]==='RL_PENALTY_UPDATE'){const {penalties:_0x371906}=_0x255462[_0x44a9c1(0x1da)];if(_0x371906)_0x16f05b['setStateAsync'](_0x44a9c1(0x1d3),{'val':JSON[_0x44a9c1(0x196)](_0x371906),'ack':!![]});}else{if(_0x255462[_0x44a9c1(0x1c1)]===_0x44a9c1(0x1cc)){const {forecast:_0x3d2b6f}=_0x255462['payload'];if(_0x3d2b6f)_0x16f05b['setStateAsync'](_0x44a9c1(0x1be),{'val':JSON['stringify'](_0x3d2b6f),'ack':!![]});}else{if(_0x255462[_0x44a9c1(0x1c1)]==='VENTILATION_ALERT'){const {alerts:_0x134ff1}=_0x255462[_0x44a9c1(0x1da)];if(_0x134ff1)_0x16f05b[_0x44a9c1(0x18b)]('analysis.energy.ventilationAlerts',{'val':JSON[_0x44a9c1(0x196)](_0x134ff1),'ack':!![]});}else{if(_0x255462[_0x44a9c1(0x1c1)]==='ENERGY_OPTIMIZE_RESULT'){const {proposals:_0x29c51a}=_0x255462[_0x44a9c1(0x1da)];_0x16f05b[_0x44a9c1(0x1b9)](_0x44a9c1(0x199),(_0x53fb3a,_0x18e9ed)=>{const _0x515b27=_0x44a9c1;_0x18e9ed&&_0x18e9ed[_0x515b27(0x1d0)]===!![]&&_0x29c51a&&_0x29c51a[_0x515b27(0x1a0)]>0x0&&automation[_0x515b27(0x1d5)](_0x16f05b,_0x29c51a);});}else{if(_0x255462['type']===_0x44a9c1(0x1e0)){const {room:_0x36281f,propagation:_0xef5b29}=_0x255462['payload'];let _0x1e8af4=_0x44a9c1(0x1b6),_0x47d5ca=0x0;if(_0xef5b29){const _0x331613=Object['entries'](_0xef5b29);_0x331613[_0x44a9c1(0x1a0)]>0x0&&(_0x1e8af4=_0x331613[0x0][0x0],_0x47d5ca=_0x331613[0x0][0x1]);}_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x1af),{'val':_0x1e8af4,'ack':!![]}),_0x16f05b['setStateAsync'](_0x44a9c1(0x1cf),{'val':_0x47d5ca,'ack':!![]}),automation[_0x44a9c1(0x190)](_0x16f05b,_0x1e8af4,_0x47d5ca);}else{if(_0x255462['type']==='TRACKER_RESULT'){const {probabilities:_0x588863}=_0x255462[_0x44a9c1(0x1da)];if(_0x588863){_0x16f05b[_0x44a9c1(0x18b)]('analysis.prediction.trackerState',{'val':JSON[_0x44a9c1(0x196)](_0x588863),'ack':!![]});const _0x1d79f0=Object['keys'](_0x588863);if(_0x1d79f0[_0x44a9c1(0x1a0)]>0x0){const _0x27a1f8=_0x1d79f0[0x0],_0x3d3533=_0x588863[_0x27a1f8];_0x16f05b[_0x44a9c1(0x18b)]('analysis.prediction.trackerTopRoom',{'val':_0x27a1f8,'ack':!![]}),_0x16f05b['setStateAsync']('analysis.prediction.trackerConfidence',{'val':_0x3d3533,'ack':!![]});}}}else{if(_0x255462[_0x44a9c1(0x1c1)]==='COMFORT_RESULT'){const {patterns:_0x189f98}=_0x255462[_0x44a9c1(0x1da)];if(_0x189f98&&_0x189f98['length']>0x0)_0x16f05b[_0x44a9c1(0x18b)](_0x44a9c1(0x1d7),{'val':JSON['stringify'](_0x189f98),'ack':!![]});}}}}}}}}}}}}}}}}}function a4_0x22e7(){const _0x35bb0d=['analysis.security.lastCheck','toString','Unknown','reason','close','getState','(((.+)+)+)+$','insulation','forEach','[RESULT]','analysis.energy.pinnForecast','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','analysis.health.gaitSpeed','type','split','startsWith','details','python3','TRAINING_COMPLETE','analysis.alertReason','service.py','sendToPythonWrapper','Failed:\x20','SECURITY_RESULT','PINN_PREDICT_RESULT','WARMUP_RESULT','stdout','analysis.prediction.confidence','val','kill','ENERGY_TRAIN_RESULT','analysis.energy.rlPenalties','analysis.isAlert','applyEnergySavings','588deqPvT','analysis.automation.detectedPatterns','1103290rSWtbZ','toISOString','payload','1063512xwurqs','data','sendNotification','15838nocCda','threshold','SIGNAL_RESULT','analysis.health.lastCheck','search','3835475pYxrbl','trim','substring','setStateAsync','analysis.health.isAnomaly','stdin','âœ…\x20HEALTH\x20TRAINED.','parse','handlePrediction','success','analysis.energy.forecast','232074BLTFMp','log','path','stringify','./setup','toFixed','analysis.energy.mpcActive','41SGpUTI','PONG','14015AjpMGI','python_service','[LOG]','analysis.energy.heatingScore','length','child_process','ðŸ\x20Python\x20Pong','HEALTH_RESULT','write','analysis.security.lastScore','ENERGY_PREDICT_RESULT','heating','128360qfYHnv','writable','debug','16chziYR','44mONBoM','analysis.energy.insulationScore','\x0aGrund:\x20','analysis.prediction.nextRoom','existsSync','analysis.energy.warmupTimes','GAIT_RESULT','analysis.energy.warmupDetails'];a4_0x22e7=function(){return _0x35bb0d;};return a4_0x22e7();}function startService(_0x1c0d72,_0x229a1d){const _0x5d5e61=a4_0x149126;let _0x3dc2ba=_0x5d5e61(0x1c5);if(fs[_0x5d5e61(0x1b0)](_0x229a1d))_0x3dc2ba=_0x229a1d;try{const _0x241896=path['join'](__dirname,'..',_0x5d5e61(0x19d),_0x5d5e61(0x1c8));pythonProcess=spawn(_0x3dc2ba,[_0x241896]),pythonProcess[_0x5d5e61(0x1ce)]['on'](_0x5d5e61(0x1dc),_0x16dfdc=>{const _0x3fa7fe=_0x5d5e61,_0x296d94=_0x16dfdc[_0x3fa7fe(0x1b5)]()[_0x3fa7fe(0x1c2)]('\x0a');_0x296d94[_0x3fa7fe(0x1bc)](_0x25da70=>{const _0x40f5a6=_0x3fa7fe,_0x2bb377=_0x25da70[_0x40f5a6(0x1e4)]();if(!_0x2bb377)return;if(_0x2bb377['startsWith'](_0x40f5a6(0x19e)))_0x1c0d72[_0x40f5a6(0x194)][_0x40f5a6(0x1aa)]('[PYTHON]\x20'+_0x2bb377[_0x40f5a6(0x1e5)](0x5)[_0x40f5a6(0x1e4)]());else{if(_0x2bb377[_0x40f5a6(0x1c3)](_0x40f5a6(0x1bd)))try{const _0x11f5dd=JSON[_0x40f5a6(0x18f)](_0x2bb377[_0x40f5a6(0x1e5)](0x8)[_0x40f5a6(0x1e4)]());handleResult(_0x1c0d72,_0x11f5dd);}catch(_0x4b4abd){}}});}),pythonProcess['on'](_0x5d5e61(0x1b8),_0x31034c=>{pythonProcess=null;}),_0x1c0d72[_0x5d5e61(0x1c9)]=(_0x172234,_0x203cdc)=>send(_0x1c0d72,_0x172234,_0x203cdc);}catch(_0x2365b1){_0x1c0d72['log']['error']('Error\x20launching\x20Python:\x20'+_0x2365b1['message']);}}function a4_0x4655(_0x46955a,_0x42e349){const _0x10784c=a4_0x22e7();return a4_0x4655=function(_0x81544,_0x55d39f){_0x81544=_0x81544-0x18b;let _0x22e768=_0x10784c[_0x81544];return _0x22e768;},a4_0x4655(_0x46955a,_0x42e349);}function stopService(_0x4b9c94){const _0xe7e6f2=a4_0x149126;if(pythonProcess){try{pythonProcess[_0xe7e6f2(0x1d1)]();}catch(_0x50aa9f){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};