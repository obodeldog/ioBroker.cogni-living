const a4_0x3671f6=a4_0x5c81;function a4_0x3cf8(){const _0x5b3015=['analysis.health.gaitDebug','split','analysis.energy.rlPenalties','analysis.energy.pinnForecast','toLocaleTimeString','analysis.energy.forecast','analysis.training.status','length','apply','de-DE','2-digit','WARMUP_RESULT','trim','log','info','analysis.automation.detectedPatterns','val','Failed:\x20','parse','8HMugvs','Success:\x20','short','analysis.prediction.nextRoom','âŒ\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!\x20Checked:\x20','toFixed','toLocaleDateString','toString','analysis.prediction.trackerConfidence','analysis.energy.mpcActive','existsSync','analysis.security.currentThreshold','exports','sendToPythonWrapper','26296ELiLlf','write','search','writable','keys','substring','insulation','stdout','stringify','4563370PUUThq','toISOString','analysis.isAlert','entries','Error\x20launching\x20Python:\x20','VENTILATION_ALERT','error','11119RDluBY','warn','23331893WiBiVh','HEALTH_RESULT','analysis.health.isAnomaly','[RESULT]','12dsYbZr','354WvoPUB','25HKimQA','details','[PYTHON]\x20','is_anomaly','type','Python\x20process\x20exited\x20with\x20code\x20','[LOG]','analysis.alertReason','data','HEALTH_TREND_RESULT','analysis.health.gaitSpeed','analysis.prediction.trackerState','COMFORT_RESULT','analysis.health.gaitSensors','ðŸš€\x20Starting\x20Python\x20Bridge\x20using:\x20','reason','TRACKER_RESULT','8ZSyNuT','heating','23441QeSzdD','close','6761079vqhCym','payload','analysis.energy.insulationScore','threshold','\x20AND\x20','ENERGY_TRAIN_RESULT','stderr','handlePrediction','kill','SECURITY_RESULT','ðŸ“ˆ\x20Health\x20Trend:\x20','join','[PYTHON\x20ERR]\x20','266448SrInGQ','.\x20Please\x20create\x20this\x20file!','2950cnfHxS','analysis.energy.ventilationAlerts','\x0aGrund:\x20','service.py','(((.+)+)+)+$','âœ…\x20HEALTH\x20TRAINED.','analysis.energy.warmupSources','setStateAsync','success','analysis.health.activityTrend'];a4_0x3cf8=function(){return _0x5b3015;};return a4_0x3cf8();}(function(_0xeea926,_0x3a62ff){const _0xb1f3d8=a4_0x5c81,_0x5a70df=_0xeea926();while(!![]){try{const _0x341fed=parseInt(_0xb1f3d8(0x15a))/0x1*(-parseInt(_0xb1f3d8(0x13c))/0x2)+parseInt(_0xb1f3d8(0x161))/0x3*(-parseInt(_0xb1f3d8(0x14a))/0x4)+-parseInt(_0xb1f3d8(0x162))/0x5*(-parseInt(_0xb1f3d8(0x11d))/0x6)+-parseInt(_0xb1f3d8(0x153))/0x7+-parseInt(_0xb1f3d8(0x173))/0x8*(parseInt(_0xb1f3d8(0x110))/0x9)+-parseInt(_0xb1f3d8(0x11f))/0xa*(-parseInt(_0xb1f3d8(0x175))/0xb)+-parseInt(_0xb1f3d8(0x160))/0xc*(-parseInt(_0xb1f3d8(0x15c))/0xd);if(_0x341fed===_0x3a62ff)break;else _0x5a70df['push'](_0x5a70df['shift']());}catch(_0x3d762b){_0x5a70df['push'](_0x5a70df['shift']());}}}(a4_0x3cf8,0x670d1));function a4_0x5c81(_0x2cec79,_0x59dde9){const _0x1d85d0=a4_0x3cf8();return a4_0x5c81=function(_0x339e97,_0x5866df){_0x339e97=_0x339e97-0x10f;let _0x3cf8ff=_0x1d85d0[_0x339e97];return _0x3cf8ff;},a4_0x5c81(_0x2cec79,_0x59dde9);}const a4_0x5866df=(function(){let _0x10c17c=!![];return function(_0x3c8dcd,_0x466aa8){const _0x31f1d4=_0x10c17c?function(){const _0x4789e6=a4_0x5c81;if(_0x466aa8){const _0x436a3c=_0x466aa8[_0x4789e6(0x131)](_0x3c8dcd,arguments);return _0x466aa8=null,_0x436a3c;}}:function(){};return _0x10c17c=![],_0x31f1d4;};}()),a4_0x339e97=a4_0x5866df(this,function(){const _0x2729e5=a4_0x5c81;return a4_0x339e97[_0x2729e5(0x143)]()['search'](_0x2729e5(0x123))[_0x2729e5(0x143)]()['constructor'](a4_0x339e97)[_0x2729e5(0x14c)](_0x2729e5(0x123));});a4_0x339e97();'use strict';const {spawn}=require('child_process'),path=require('path'),fs=require('fs'),setup=require('./setup'),automation=require('./automation');let pythonProcess=null;function send(_0x29ba54,_0x41cc4c,_0x541308={}){const _0x1b181b=a4_0x5c81;if(!pythonProcess||!pythonProcess['stdin'][_0x1b181b(0x14d)])return;const _0x23d78a=JSON[_0x1b181b(0x152)]({'command':_0x41cc4c,..._0x541308});try{pythonProcess['stdin'][_0x1b181b(0x14b)](_0x23d78a+'\x0a');}catch(_0x169237){}}function handleResult(_0x5716ec,_0x4de0fa){const _0x9bc073=a4_0x5c81;if(_0x4de0fa[_0x9bc073(0x166)]==='PONG')_0x5716ec[_0x9bc073(0x136)]['debug']('ðŸ\x20Python\x20Pong');else{if(_0x4de0fa[_0x9bc073(0x166)]===_0x9bc073(0x119)){const {anomaly_score:_0x2aaf4d,is_anomaly:_0xaf595b,threshold:_0x187013,explanation:_0x50a68c}=_0x4de0fa[_0x9bc073(0x111)];_0x5716ec['setStateAsync']('analysis.security.lastScore',{'val':_0x2aaf4d,'ack':!![]}),_0x5716ec[_0x9bc073(0x126)]('analysis.security.lastCheck',{'val':new Date()[_0x9bc073(0x154)](),'ack':!![]});if(_0x187013)_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x147),{'val':_0x187013,'ack':!![]});if(_0xaf595b){let _0x2ef177='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x2aaf4d[_0x9bc073(0x141)](0x4)+')';if(_0x50a68c&&_0x50a68c!=='Unknown')_0x2ef177+=_0x9bc073(0x121)+_0x50a68c;_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x155),{'val':!![],'ack':!![]}),_0x5716ec['setStateAsync'](_0x9bc073(0x169),{'val':_0x2ef177,'ack':!![]}),setup['sendNotification'](_0x5716ec,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x2ef177,![],!![]);}}else{if(_0x4de0fa[_0x9bc073(0x166)]==='TRAINING_COMPLETE'){const _0x2b6831=_0x4de0fa[_0x9bc073(0x111)][_0x9bc073(0x163)]||'',_0x361953=_0x4de0fa[_0x9bc073(0x111)][_0x9bc073(0x113)],_0x5ad67b=_0x4de0fa[_0x9bc073(0x111)][_0x9bc073(0x127)]?_0x9bc073(0x13d)+new Date()[_0x9bc073(0x12d)]()+'\x20('+_0x2b6831+')':_0x9bc073(0x13a)+_0x4de0fa[_0x9bc073(0x111)][_0x9bc073(0x171)];_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x12f),{'val':_0x5ad67b,'ack':!![]});if(_0x4de0fa[_0x9bc073(0x111)]['success']&&_0x361953)_0x5716ec['setStateAsync'](_0x9bc073(0x147),{'val':_0x361953,'ack':!![]});}else{if(_0x4de0fa['type']===_0x9bc073(0x115)){if(_0x4de0fa[_0x9bc073(0x111)][_0x9bc073(0x127)])try{const _0x40a5c3=JSON[_0x9bc073(0x13b)](_0x4de0fa['payload'][_0x9bc073(0x163)]);if(_0x40a5c3[_0x9bc073(0x150)])_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x112),{'val':JSON[_0x9bc073(0x152)](_0x40a5c3['insulation']),'ack':!![]});if(_0x40a5c3[_0x9bc073(0x174)])_0x5716ec[_0x9bc073(0x126)]('analysis.energy.heatingScore',{'val':JSON[_0x9bc073(0x152)](_0x40a5c3[_0x9bc073(0x174)]),'ack':!![]});}catch(_0x16261a){}}else{if(_0x4de0fa[_0x9bc073(0x166)]==='HEALTH_TRAIN_RESULT'){if(_0x4de0fa[_0x9bc073(0x111)]['success']){_0x5716ec[_0x9bc073(0x136)][_0x9bc073(0x137)](_0x9bc073(0x124));const _0x595aea=new Date(),_0xeb667d=_0x595aea['toLocaleDateString']('de-DE',{'day':_0x9bc073(0x133),'month':_0x9bc073(0x13e),'hour':'2-digit','minute':_0x9bc073(0x133)});_0x5716ec['setStateAsync']('analysis.health.lastCheck',{'val':_0xeb667d,'ack':!![]});}}else{if(_0x4de0fa[_0x9bc073(0x166)]===_0x9bc073(0x15d)){const _0x43824f=new Date(),_0x58e709=_0x43824f[_0x9bc073(0x142)]('de-DE',{'day':_0x9bc073(0x133),'month':_0x9bc073(0x13e),'hour':_0x9bc073(0x133),'minute':_0x9bc073(0x133)});_0x5716ec[_0x9bc073(0x126)]('analysis.health.lastCheck',{'val':_0x58e709,'ack':!![]}),_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x15e),{'val':_0x4de0fa[_0x9bc073(0x111)][_0x9bc073(0x165)],'ack':!![]});}else{if(_0x4de0fa[_0x9bc073(0x166)]===_0x9bc073(0x16b)){const {trend_percent:_0x1f6203,details:_0x5f5c43}=_0x4de0fa[_0x9bc073(0x111)],_0x374f21=new Date(),_0x24aac7=_0x374f21[_0x9bc073(0x142)](_0x9bc073(0x132),{'day':'2-digit','month':_0x9bc073(0x13e),'hour':'2-digit','minute':_0x9bc073(0x133)});_0x5716ec[_0x9bc073(0x126)]('analysis.health.lastCheck',{'val':_0x24aac7,'ack':!![]}),_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x128),{'val':_0x1f6203,'ack':!![]}),_0x5716ec['log']['info'](_0x9bc073(0x11a)+_0x5f5c43);}else{if(_0x4de0fa['type']==='GAIT_RESULT'){const {speed_trend:_0x3448d4,sensors:_0x20d830,proof:_0x4867b2}=_0x4de0fa[_0x9bc073(0x111)];if(_0x3448d4!==undefined)_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x16c),{'val':_0x3448d4,'ack':!![]});if(_0x20d830&&Array['isArray'](_0x20d830))_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x16f),{'val':_0x20d830[_0x9bc073(0x11b)](',\x20'),'ack':!![]});if(_0x4867b2)_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x129),{'val':_0x4867b2,'ack':!![]});}else{if(_0x4de0fa[_0x9bc073(0x166)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x41559e}=_0x4de0fa[_0x9bc073(0x111)];if(_0x41559e)_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x12e),{'val':JSON['stringify'](_0x41559e),'ack':!![]});}else{if(_0x4de0fa['type']===_0x9bc073(0x134)){const {times:_0xf0baac,sources:_0x270ef7,details:_0x71d248}=_0x4de0fa[_0x9bc073(0x111)];if(_0xf0baac)_0x5716ec[_0x9bc073(0x126)]('analysis.energy.warmupTimes',{'val':JSON['stringify'](_0xf0baac),'ack':!![]});if(_0x270ef7)_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x125),{'val':JSON[_0x9bc073(0x152)](_0x270ef7),'ack':!![]});if(_0x71d248)_0x5716ec[_0x9bc073(0x126)]('analysis.energy.warmupDetails',{'val':JSON[_0x9bc073(0x152)](_0x71d248),'ack':!![]});}else{if(_0x4de0fa['type']==='RL_PENALTY_UPDATE'){const {penalties:_0x27dd6d}=_0x4de0fa[_0x9bc073(0x111)];if(_0x27dd6d)_0x5716ec['setStateAsync'](_0x9bc073(0x12b),{'val':JSON[_0x9bc073(0x152)](_0x27dd6d),'ack':!![]});}else{if(_0x4de0fa['type']==='PINN_PREDICT_RESULT'){const {forecast:_0x3efec9}=_0x4de0fa[_0x9bc073(0x111)];if(_0x3efec9)_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x12c),{'val':JSON[_0x9bc073(0x152)](_0x3efec9),'ack':!![]});}else{if(_0x4de0fa['type']===_0x9bc073(0x158)){const {alerts:_0xceb608}=_0x4de0fa[_0x9bc073(0x111)];if(_0xceb608)_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x120),{'val':JSON['stringify'](_0xceb608),'ack':!![]});}else{if(_0x4de0fa[_0x9bc073(0x166)]==='ENERGY_OPTIMIZE_RESULT'){const {proposals:_0x759848}=_0x4de0fa['payload'];_0x5716ec['getState'](_0x9bc073(0x145),(_0x330b7f,_0xe73c9a)=>{const _0x439e5f=_0x9bc073;_0xe73c9a&&_0xe73c9a[_0x439e5f(0x139)]===!![]&&_0x759848&&_0x759848[_0x439e5f(0x130)]>0x0&&automation['applyEnergySavings'](_0x5716ec,_0x759848);});}else{if(_0x4de0fa[_0x9bc073(0x166)]==='SIGNAL_RESULT'){const {room:_0x5b7d7e,propagation:_0x13cb57}=_0x4de0fa[_0x9bc073(0x111)];let _0xa7ae75='Unknown',_0x2a2c9d=0x0;if(_0x13cb57){const _0x33c768=Object[_0x9bc073(0x156)](_0x13cb57);_0x33c768[_0x9bc073(0x130)]>0x0&&(_0xa7ae75=_0x33c768[0x0][0x0],_0x2a2c9d=_0x33c768[0x0][0x1]);}_0x5716ec['setStateAsync'](_0x9bc073(0x13f),{'val':_0xa7ae75,'ack':!![]}),_0x5716ec[_0x9bc073(0x126)]('analysis.prediction.confidence',{'val':_0x2a2c9d,'ack':!![]}),automation[_0x9bc073(0x117)](_0x5716ec,_0xa7ae75,_0x2a2c9d);}else{if(_0x4de0fa['type']===_0x9bc073(0x172)){const {probabilities:_0xfc8e7e}=_0x4de0fa[_0x9bc073(0x111)];if(_0xfc8e7e){_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x16d),{'val':JSON[_0x9bc073(0x152)](_0xfc8e7e),'ack':!![]});const _0x2c61d3=Object[_0x9bc073(0x14e)](_0xfc8e7e);if(_0x2c61d3[_0x9bc073(0x130)]>0x0){const _0x17f258=_0x2c61d3[0x0],_0x15ed39=_0xfc8e7e[_0x17f258];_0x5716ec[_0x9bc073(0x126)]('analysis.prediction.trackerTopRoom',{'val':_0x17f258,'ack':!![]}),_0x5716ec['setStateAsync'](_0x9bc073(0x144),{'val':_0x15ed39,'ack':!![]});}}}else{if(_0x4de0fa['type']===_0x9bc073(0x16e)){const {patterns:_0x4e633a}=_0x4de0fa[_0x9bc073(0x111)];if(_0x4e633a&&_0x4e633a[_0x9bc073(0x130)]>0x0)_0x5716ec[_0x9bc073(0x126)](_0x9bc073(0x138),{'val':JSON[_0x9bc073(0x152)](_0x4e633a),'ack':!![]});}}}}}}}}}}}}}}}}}}function startService(_0x52f9c9,_0x468c44){const _0x1a05fe=a4_0x5c81;let _0x20e3e9='python3';if(fs[_0x1a05fe(0x146)](_0x468c44))_0x20e3e9=_0x468c44;const _0x5a9bf7=path[_0x1a05fe(0x11b)](__dirname,'..',_0x1a05fe(0x122)),_0x19c1bc=path[_0x1a05fe(0x11b)](__dirname,'..','python_service','service.py');let _0x481cba='';if(fs[_0x1a05fe(0x146)](_0x5a9bf7))_0x481cba=_0x5a9bf7;else{if(fs['existsSync'](_0x19c1bc))_0x481cba=_0x19c1bc;else{_0x52f9c9[_0x1a05fe(0x136)][_0x1a05fe(0x159)](_0x1a05fe(0x140)+_0x5a9bf7+_0x1a05fe(0x114)+_0x19c1bc+_0x1a05fe(0x11e));return;}}try{_0x52f9c9[_0x1a05fe(0x136)]['info'](_0x1a05fe(0x170)+_0x20e3e9+'\x20'+_0x481cba),pythonProcess=spawn(_0x20e3e9,[_0x481cba]),pythonProcess[_0x1a05fe(0x151)]['on'](_0x1a05fe(0x16a),_0x43cddf=>{const _0x52fddb=_0x1a05fe,_0xf2c59d=_0x43cddf[_0x52fddb(0x143)]()[_0x52fddb(0x12a)]('\x0a');_0xf2c59d['forEach'](_0xe52740=>{const _0x37118e=_0x52fddb,_0x2465b6=_0xe52740[_0x37118e(0x135)]();if(!_0x2465b6)return;if(_0x2465b6['startsWith'](_0x37118e(0x168)))_0x52f9c9[_0x37118e(0x136)]['debug'](_0x37118e(0x164)+_0x2465b6['substring'](0x5)['trim']());else{if(_0x2465b6['startsWith'](_0x37118e(0x15f)))try{const _0x9a1f84=JSON[_0x37118e(0x13b)](_0x2465b6[_0x37118e(0x14f)](0x8)['trim']());handleResult(_0x52f9c9,_0x9a1f84);}catch(_0x37b4a6){}}});}),pythonProcess[_0x1a05fe(0x116)]['on']('data',_0x4ee6dd=>{const _0x11c028=_0x1a05fe;_0x52f9c9[_0x11c028(0x136)][_0x11c028(0x159)](_0x11c028(0x11c)+_0x4ee6dd[_0x11c028(0x143)]()[_0x11c028(0x135)]());}),pythonProcess['on'](_0x1a05fe(0x10f),_0x3bc744=>{const _0x4238f0=_0x1a05fe;_0x52f9c9[_0x4238f0(0x136)][_0x4238f0(0x15b)](_0x4238f0(0x167)+_0x3bc744),pythonProcess=null;}),_0x52f9c9[_0x1a05fe(0x149)]=(_0xe2d63f,_0x53ab0d)=>send(_0x52f9c9,_0xe2d63f,_0x53ab0d);}catch(_0x259dec){_0x52f9c9['log'][_0x1a05fe(0x159)](_0x1a05fe(0x157)+_0x259dec['message']);}}function stopService(_0x497538){const _0x2bfa72=a4_0x5c81;if(pythonProcess){try{pythonProcess[_0x2bfa72(0x118)]();}catch(_0x421e17){}pythonProcess=null;}}module[a4_0x3671f6(0x148)]={'startService':startService,'stopService':stopService,'send':send};