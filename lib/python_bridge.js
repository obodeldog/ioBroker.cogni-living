const a4_0x4b008c=a4_0x21dc;function a4_0x5271(){const _0x45ffae=['sendNotification','analysis.energy.warmupTimes','startsWith','toISOString','stdout','[RESULT]','Error\x20launching\x20Python:\x20','threshold','stderr','analysis.security.lastCheck','TRAINING_COMPLETE','message','analysis.security.currentThreshold','COMFORT_RESULT','heating','68jMzqAU','analysis.energy.pinnForecast','child_process','data','setStateAsync','analysis.health.gaitSensors','[LOG]','\x0aGrund:\x20','applyEnergySavings','ðŸš€\x20Starting\x20Python\x20Bridge\x20using:\x20','analysis.automation.detectedPatterns','type','de-DE','447325HMPrZe','python3','analysis.health.activityTrend','Success:\x20','.\x20Please\x20create\x20this\x20file!','âš ï¸\x20SECURITY\x20ALARM:\x20','TRACKER_RESULT','analysis.energy.warmupSources','details','GAIT_RESULT','is_anomaly','writable','ENERGY_OPTIMIZE_RESULT','toString','HEALTH_TREND_RESULT','SIGNAL_RESULT','analysis.energy.insulationScore','service.py','19336QICiXr','(((.+)+)+)+$','150xCcedR','VENTILATION_ALERT','parse','trim','substring','analysis.energy.warmupDetails','toLocaleDateString','ðŸ\x20Python\x20Pong','HEALTH_TRAIN_RESULT','analysis.energy.forecast','payload','analysis.health.isAnomaly','stringify','val','Python\x20process\x20exited\x20with\x20code\x20','analysis.security.lastScore','write','reason','kill','warn','join','PONG','7JFdgBp','SECURITY_RESULT','Failed:\x20','close','1023996OMbtZJ','analysis.health.lastCheck','insulation','ENERGY_TRAIN_RESULT','sendToPythonWrapper','analysis.energy.ventilationAlerts','2-digit','keys','existsSync','89416CDZRco','ENERGY_PREDICT_RESULT','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','analysis.health.gaitSpeed','info','split','\x20AND\x20','7203295dVpSeq','success','WARMUP_RESULT','analysis.prediction.trackerTopRoom','log','[PYTHON\x20ERR]\x20','198500NDvqoW','âœ…\x20HEALTH\x20TRAINED.','Unknown','short','63spiOPY','analysis.prediction.nextRoom','âŒ\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!\x20Checked:\x20','ðŸ“ˆ\x20Health\x20Trend:\x20','length','1658OnGqUT'];a4_0x5271=function(){return _0x45ffae;};return a4_0x5271();}(function(_0x909202,_0x56e334){const _0x143ba9=a4_0x21dc,_0x39f26d=_0x909202();while(!![]){try{const _0x19f178=parseInt(_0x143ba9(0xde))/0x1*(-parseInt(_0x143ba9(0xee))/0x2)+-parseInt(_0x143ba9(0x10f))/0x3*(parseInt(_0x143ba9(0x10d))/0x4)+parseInt(_0x143ba9(0xfb))/0x5+-parseInt(_0x143ba9(0xbf))/0x6+-parseInt(_0x143ba9(0xbb))/0x7*(parseInt(_0x143ba9(0xc8))/0x8)+-parseInt(_0x143ba9(0xd9))/0x9*(parseInt(_0x143ba9(0xd5))/0xa)+parseInt(_0x143ba9(0xcf))/0xb;if(_0x19f178===_0x56e334)break;else _0x39f26d['push'](_0x39f26d['shift']());}catch(_0x1b320e){_0x39f26d['push'](_0x39f26d['shift']());}}}(a4_0x5271,0x1ea05));const a4_0x145990=(function(){let _0x4d56f5=!![];return function(_0x2623ee,_0x535b15){const _0x4e8b27=_0x4d56f5?function(){if(_0x535b15){const _0x3b69da=_0x535b15['apply'](_0x2623ee,arguments);return _0x535b15=null,_0x3b69da;}}:function(){};return _0x4d56f5=![],_0x4e8b27;};}()),a4_0x2cc4ea=a4_0x145990(this,function(){const _0x22bc70=a4_0x21dc;return a4_0x2cc4ea[_0x22bc70(0x108)]()['search'](_0x22bc70(0x10e))[_0x22bc70(0x108)]()['constructor'](a4_0x2cc4ea)['search'](_0x22bc70(0x10e));});a4_0x2cc4ea();'use strict';const {spawn}=require(a4_0x4b008c(0xf0)),path=require('path'),fs=require('fs'),setup=require('./setup'),automation=require('./automation');let pythonProcess=null;function send(_0x52da75,_0x120d97,_0x4fefe0={}){const _0x38b1e9=a4_0x4b008c;if(!pythonProcess||!pythonProcess['stdin'][_0x38b1e9(0x106)])return;const _0x5487a3=JSON['stringify']({'command':_0x120d97,..._0x4fefe0});try{pythonProcess['stdin'][_0x38b1e9(0xb5)](_0x5487a3+'\x0a');}catch(_0x1423e2){}}function handleResult(_0x56c53,_0x501f6c){const _0x5c5dfa=a4_0x4b008c;if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0xba))_0x56c53[_0x5c5dfa(0xd3)]['debug'](_0x5c5dfa(0x116));else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0xbc)){const {anomaly_score:_0x332f22,is_anomaly:_0x30a27c,threshold:_0x334e1b,explanation:_0x180785}=_0x501f6c['payload'];_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0x11e),{'val':_0x332f22,'ack':!![]}),_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xe8),{'val':new Date()[_0x5c5dfa(0xe2)](),'ack':!![]});if(_0x334e1b)_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xeb),{'val':_0x334e1b,'ack':!![]});if(_0x30a27c){let _0x18b5d9=_0x5c5dfa(0xca)+_0x332f22['toFixed'](0x4)+')';if(_0x180785&&_0x180785!=='Unknown')_0x18b5d9+=_0x5c5dfa(0xf5)+_0x180785;_0x56c53[_0x5c5dfa(0xf2)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x56c53[_0x5c5dfa(0xf2)]('analysis.alertReason',{'val':_0x18b5d9,'ack':!![]}),setup[_0x5c5dfa(0xdf)](_0x56c53,_0x5c5dfa(0x100)+_0x18b5d9,![],!![]);}}else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0xe9)){const _0x123dd7=_0x501f6c[_0x5c5dfa(0x119)][_0x5c5dfa(0x103)]||'',_0x10cb25=_0x501f6c['payload'][_0x5c5dfa(0xe6)],_0x3076f1=_0x501f6c[_0x5c5dfa(0x119)][_0x5c5dfa(0xd0)]?_0x5c5dfa(0xfe)+new Date()['toLocaleTimeString']()+'\x20('+_0x123dd7+')':_0x5c5dfa(0xbd)+_0x501f6c['payload'][_0x5c5dfa(0xb6)];_0x56c53[_0x5c5dfa(0xf2)]('analysis.training.status',{'val':_0x3076f1,'ack':!![]});if(_0x501f6c[_0x5c5dfa(0x119)][_0x5c5dfa(0xd0)]&&_0x10cb25)_0x56c53[_0x5c5dfa(0xf2)]('analysis.security.currentThreshold',{'val':_0x10cb25,'ack':!![]});}else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0xc2)){if(_0x501f6c['payload'][_0x5c5dfa(0xd0)])try{const _0x6221ee=JSON[_0x5c5dfa(0x111)](_0x501f6c[_0x5c5dfa(0x119)]['details']);if(_0x6221ee[_0x5c5dfa(0xc1)])_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0x10b),{'val':JSON['stringify'](_0x6221ee[_0x5c5dfa(0xc1)]),'ack':!![]});if(_0x6221ee[_0x5c5dfa(0xed)])_0x56c53[_0x5c5dfa(0xf2)]('analysis.energy.heatingScore',{'val':JSON[_0x5c5dfa(0x11b)](_0x6221ee['heating']),'ack':!![]});}catch(_0x553c8e){}}else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0x117)){if(_0x501f6c['payload']['success']){_0x56c53[_0x5c5dfa(0xd3)][_0x5c5dfa(0xcc)](_0x5c5dfa(0xd6));const _0x542d20=new Date(),_0x2fa06d=_0x542d20['toLocaleDateString'](_0x5c5dfa(0xfa),{'day':_0x5c5dfa(0xc5),'month':_0x5c5dfa(0xd8),'hour':_0x5c5dfa(0xc5),'minute':'2-digit'});_0x56c53['setStateAsync'](_0x5c5dfa(0xc0),{'val':_0x2fa06d,'ack':!![]});}}else{if(_0x501f6c[_0x5c5dfa(0xf9)]==='HEALTH_RESULT'){const _0x27e742=new Date(),_0x2cecac=_0x27e742[_0x5c5dfa(0x115)](_0x5c5dfa(0xfa),{'day':_0x5c5dfa(0xc5),'month':_0x5c5dfa(0xd8),'hour':_0x5c5dfa(0xc5),'minute':_0x5c5dfa(0xc5)});_0x56c53['setStateAsync'](_0x5c5dfa(0xc0),{'val':_0x2cecac,'ack':!![]}),_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0x11a),{'val':_0x501f6c[_0x5c5dfa(0x119)][_0x5c5dfa(0x105)],'ack':!![]});}else{if(_0x501f6c['type']===_0x5c5dfa(0x109)){const {trend_percent:_0x4ad045,details:_0x44ac5f}=_0x501f6c[_0x5c5dfa(0x119)],_0x2404c0=new Date(),_0x111ee2=_0x2404c0[_0x5c5dfa(0x115)](_0x5c5dfa(0xfa),{'day':_0x5c5dfa(0xc5),'month':'short','hour':_0x5c5dfa(0xc5),'minute':'2-digit'});_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xc0),{'val':_0x111ee2,'ack':!![]}),_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xfd),{'val':_0x4ad045,'ack':!![]}),_0x56c53[_0x5c5dfa(0xd3)][_0x5c5dfa(0xcc)](_0x5c5dfa(0xdc)+_0x44ac5f);}else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0x104)){const {speed_trend:_0x6bf3d4,sensors:_0x29cb66}=_0x501f6c['payload'];if(_0x6bf3d4!==undefined)_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xcb),{'val':_0x6bf3d4,'ack':!![]});_0x29cb66&&Array['isArray'](_0x29cb66)&&_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xf3),{'val':_0x29cb66['join'](',\x20'),'ack':!![]});}else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0xc9)){const {forecast:_0x1a356d}=_0x501f6c['payload'];if(_0x1a356d)_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0x118),{'val':JSON['stringify'](_0x1a356d),'ack':!![]});}else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0xd1)){const {times:_0x3f822a,sources:_0x3eab89,details:_0x37c74b}=_0x501f6c['payload'];if(_0x3f822a)_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xe0),{'val':JSON[_0x5c5dfa(0x11b)](_0x3f822a),'ack':!![]});if(_0x3eab89)_0x56c53['setStateAsync'](_0x5c5dfa(0x102),{'val':JSON['stringify'](_0x3eab89),'ack':!![]});if(_0x37c74b)_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0x114),{'val':JSON[_0x5c5dfa(0x11b)](_0x37c74b),'ack':!![]});}else{if(_0x501f6c[_0x5c5dfa(0xf9)]==='RL_PENALTY_UPDATE'){const {penalties:_0x43b18}=_0x501f6c[_0x5c5dfa(0x119)];if(_0x43b18)_0x56c53[_0x5c5dfa(0xf2)]('analysis.energy.rlPenalties',{'val':JSON[_0x5c5dfa(0x11b)](_0x43b18),'ack':!![]});}else{if(_0x501f6c[_0x5c5dfa(0xf9)]==='PINN_PREDICT_RESULT'){const {forecast:_0x5db784}=_0x501f6c[_0x5c5dfa(0x119)];if(_0x5db784)_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xef),{'val':JSON[_0x5c5dfa(0x11b)](_0x5db784),'ack':!![]});}else{if(_0x501f6c['type']===_0x5c5dfa(0x110)){const {alerts:_0x5620d6}=_0x501f6c['payload'];if(_0x5620d6)_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xc4),{'val':JSON[_0x5c5dfa(0x11b)](_0x5620d6),'ack':!![]});}else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0x107)){const {proposals:_0x2a2f4b}=_0x501f6c[_0x5c5dfa(0x119)];_0x56c53['getState']('analysis.energy.mpcActive',(_0x47162d,_0x46929e)=>{const _0x4705ee=_0x5c5dfa;_0x46929e&&_0x46929e[_0x4705ee(0x11c)]===!![]&&_0x2a2f4b&&_0x2a2f4b[_0x4705ee(0xdd)]>0x0&&automation[_0x4705ee(0xf6)](_0x56c53,_0x2a2f4b);});}else{if(_0x501f6c[_0x5c5dfa(0xf9)]===_0x5c5dfa(0x10a)){const {room:_0x4f7277,propagation:_0x37eb19}=_0x501f6c[_0x5c5dfa(0x119)];let _0x1e7dfa=_0x5c5dfa(0xd7),_0x2d05d2=0x0;if(_0x37eb19){const _0x40e2c6=Object['entries'](_0x37eb19);_0x40e2c6[_0x5c5dfa(0xdd)]>0x0&&(_0x1e7dfa=_0x40e2c6[0x0][0x0],_0x2d05d2=_0x40e2c6[0x0][0x1]);}_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xda),{'val':_0x1e7dfa,'ack':!![]}),_0x56c53[_0x5c5dfa(0xf2)]('analysis.prediction.confidence',{'val':_0x2d05d2,'ack':!![]}),automation['handlePrediction'](_0x56c53,_0x1e7dfa,_0x2d05d2);}else{if(_0x501f6c['type']===_0x5c5dfa(0x101)){const {probabilities:_0x27a8ee}=_0x501f6c[_0x5c5dfa(0x119)];if(_0x27a8ee){_0x56c53[_0x5c5dfa(0xf2)]('analysis.prediction.trackerState',{'val':JSON[_0x5c5dfa(0x11b)](_0x27a8ee),'ack':!![]});const _0x144643=Object[_0x5c5dfa(0xc6)](_0x27a8ee);if(_0x144643[_0x5c5dfa(0xdd)]>0x0){const _0x12c347=_0x144643[0x0],_0x11aebc=_0x27a8ee[_0x12c347];_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xd2),{'val':_0x12c347,'ack':!![]}),_0x56c53[_0x5c5dfa(0xf2)]('analysis.prediction.trackerConfidence',{'val':_0x11aebc,'ack':!![]});}}}else{if(_0x501f6c['type']===_0x5c5dfa(0xec)){const {patterns:_0x380aaf}=_0x501f6c[_0x5c5dfa(0x119)];if(_0x380aaf&&_0x380aaf[_0x5c5dfa(0xdd)]>0x0)_0x56c53[_0x5c5dfa(0xf2)](_0x5c5dfa(0xf8),{'val':JSON[_0x5c5dfa(0x11b)](_0x380aaf),'ack':!![]});}}}}}}}}}}}}}}}}}}function startService(_0x5c8a04,_0x523c60){const _0x5923fa=a4_0x4b008c;let _0x38f452=_0x5923fa(0xfc);if(fs[_0x5923fa(0xc7)](_0x523c60))_0x38f452=_0x523c60;const _0x1849fc=path[_0x5923fa(0xb9)](__dirname,'..',_0x5923fa(0x10c)),_0x1e72e2=path[_0x5923fa(0xb9)](__dirname,'..','python_service',_0x5923fa(0x10c));let _0x1ced34='';if(fs[_0x5923fa(0xc7)](_0x1849fc))_0x1ced34=_0x1849fc;else{if(fs[_0x5923fa(0xc7)](_0x1e72e2))_0x1ced34=_0x1e72e2;else{_0x5c8a04['log']['error'](_0x5923fa(0xdb)+_0x1849fc+_0x5923fa(0xce)+_0x1e72e2+_0x5923fa(0xff));return;}}try{_0x5c8a04['log']['info'](_0x5923fa(0xf7)+_0x38f452+'\x20'+_0x1ced34),pythonProcess=spawn(_0x38f452,[_0x1ced34]),pythonProcess[_0x5923fa(0xe3)]['on'](_0x5923fa(0xf1),_0x20f611=>{const _0x753ec6=_0x5923fa,_0x5247f6=_0x20f611['toString']()[_0x753ec6(0xcd)]('\x0a');_0x5247f6['forEach'](_0x30873d=>{const _0x3e82ab=_0x753ec6,_0x48b92a=_0x30873d[_0x3e82ab(0x112)]();if(!_0x48b92a)return;if(_0x48b92a[_0x3e82ab(0xe1)](_0x3e82ab(0xf4)))_0x5c8a04['log']['debug']('[PYTHON]\x20'+_0x48b92a[_0x3e82ab(0x113)](0x5)[_0x3e82ab(0x112)]());else{if(_0x48b92a[_0x3e82ab(0xe1)](_0x3e82ab(0xe4)))try{const _0x39ae0d=JSON[_0x3e82ab(0x111)](_0x48b92a[_0x3e82ab(0x113)](0x8)[_0x3e82ab(0x112)]());handleResult(_0x5c8a04,_0x39ae0d);}catch(_0x1a3a0c){}}});}),pythonProcess[_0x5923fa(0xe7)]['on'](_0x5923fa(0xf1),_0x44eff9=>{const _0x1d2443=_0x5923fa;_0x5c8a04[_0x1d2443(0xd3)]['error'](_0x1d2443(0xd4)+_0x44eff9[_0x1d2443(0x108)]()[_0x1d2443(0x112)]());}),pythonProcess['on'](_0x5923fa(0xbe),_0x3895f6=>{const _0x2cb955=_0x5923fa;_0x5c8a04[_0x2cb955(0xd3)][_0x2cb955(0xb8)](_0x2cb955(0x11d)+_0x3895f6),pythonProcess=null;}),_0x5c8a04[_0x5923fa(0xc3)]=(_0x410dc2,_0x407517)=>send(_0x5c8a04,_0x410dc2,_0x407517);}catch(_0x8b1c02){_0x5c8a04['log']['error'](_0x5923fa(0xe5)+_0x8b1c02[_0x5923fa(0xea)]);}}function a4_0x21dc(_0x33c859,_0x33279b){const _0x55548b=a4_0x5271();return a4_0x21dc=function(_0x2cc4ea,_0x145990){_0x2cc4ea=_0x2cc4ea-0xb5;let _0x5271f0=_0x55548b[_0x2cc4ea];return _0x5271f0;},a4_0x21dc(_0x33c859,_0x33279b);}function stopService(_0x3ac9a8){const _0xf70335=a4_0x4b008c;if(pythonProcess){try{pythonProcess[_0xf70335(0xb7)]();}catch(_0x4490df){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};