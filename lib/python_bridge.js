const a4_0x674cdb=a4_0x510b;(function(_0x3408ef,_0xe8dfff){const _0xe3c9fb=a4_0x510b,_0x12bbb0=_0x3408ef();while(!![]){try{const _0x44416a=-parseInt(_0xe3c9fb(0x193))/0x1+parseInt(_0xe3c9fb(0x158))/0x2+-parseInt(_0xe3c9fb(0x16a))/0x3+parseInt(_0xe3c9fb(0x167))/0x4*(-parseInt(_0xe3c9fb(0x16b))/0x5)+parseInt(_0xe3c9fb(0x13c))/0x6*(-parseInt(_0xe3c9fb(0x18a))/0x7)+parseInt(_0xe3c9fb(0x14b))/0x8+-parseInt(_0xe3c9fb(0x169))/0x9*(-parseInt(_0xe3c9fb(0x15b))/0xa);if(_0x44416a===_0xe8dfff)break;else _0x12bbb0['push'](_0x12bbb0['shift']());}catch(_0x2f5ddd){_0x12bbb0['push'](_0x12bbb0['shift']());}}}(a4_0x3550,0x31b76));function a4_0x510b(_0x210796,_0xe23e74){const _0x1adba6=a4_0x3550();return a4_0x510b=function(_0x2a0e24,_0x1abcd2){_0x2a0e24=_0x2a0e24-0x136;let _0x3550f2=_0x1adba6[_0x2a0e24];return _0x3550f2;},a4_0x510b(_0x210796,_0xe23e74);}const a4_0x1abcd2=(function(){let _0x409ac1=!![];return function(_0x41149a,_0x1aa493){const _0x256fcf=_0x409ac1?function(){const _0x452c18=a4_0x510b;if(_0x1aa493){const _0x31c9df=_0x1aa493[_0x452c18(0x144)](_0x41149a,arguments);return _0x1aa493=null,_0x31c9df;}}:function(){};return _0x409ac1=![],_0x256fcf;};}()),a4_0x2a0e24=a4_0x1abcd2(this,function(){const _0x3ae8ac=a4_0x510b;return a4_0x2a0e24[_0x3ae8ac(0x182)]()[_0x3ae8ac(0x192)]('(((.+)+)+)+$')['toString']()['constructor'](a4_0x2a0e24)[_0x3ae8ac(0x192)](_0x3ae8ac(0x15f));});a4_0x2a0e24();'use strict';const {spawn}=require(a4_0x674cdb(0x15c)),path=require('path'),fs=require('fs'),setup=require(a4_0x674cdb(0x162)),automation=require(a4_0x674cdb(0x186));let pythonProcess=null;function send(_0x5b2a92,_0x46f794,_0x444524={}){const _0x4bd747=a4_0x674cdb;if(!pythonProcess||!pythonProcess[_0x4bd747(0x175)][_0x4bd747(0x179)])return;const _0x377b9d=JSON['stringify']({'command':_0x46f794,..._0x444524});try{pythonProcess[_0x4bd747(0x175)][_0x4bd747(0x145)](_0x377b9d+'\x0a');}catch(_0x34d164){}}function handleResult(_0x576a26,_0x4fde81){const _0x4c2b5b=a4_0x674cdb;if(_0x4fde81['type']===_0x4c2b5b(0x153))_0x576a26[_0x4c2b5b(0x170)]['debug'](_0x4c2b5b(0x178));else{if(_0x4fde81[_0x4c2b5b(0x137)]==='SECURITY_RESULT'){const {anomaly_score:_0x10218a,is_anomaly:_0x29d8e2,threshold:_0x49978e,explanation:_0x5d772d}=_0x4fde81[_0x4c2b5b(0x176)];_0x576a26[_0x4c2b5b(0x170)][_0x4c2b5b(0x160)](_0x4c2b5b(0x157)+_0x10218a[_0x4c2b5b(0x180)](0x5)+_0x4c2b5b(0x16f)+(_0x29d8e2?_0x4c2b5b(0x151):'OK')),_0x576a26['setStateAsync'](_0x4c2b5b(0x147),{'val':_0x10218a,'ack':!![]}),_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x17b),{'val':new Date()[_0x4c2b5b(0x181)](),'ack':!![]});if(_0x49978e)_0x576a26[_0x4c2b5b(0x187)]('analysis.security.currentThreshold',{'val':_0x49978e,'ack':!![]});if(_0x29d8e2){let _0x404e45=_0x4c2b5b(0x18e)+_0x10218a[_0x4c2b5b(0x180)](0x4)+')';if(_0x5d772d&&_0x5d772d!==_0x4c2b5b(0x185))_0x404e45+='\x0aGrund:\x20'+_0x5d772d;_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x172),{'val':!![],'ack':!![]}),_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x184),{'val':_0x404e45,'ack':!![]}),setup[_0x4c2b5b(0x15a)](_0x576a26,_0x4c2b5b(0x154)+_0x404e45,![],!![]);}}else{if(_0x4fde81['type']==='TRAINING_COMPLETE'){const _0x1bbd84=_0x4fde81[_0x4c2b5b(0x176)][_0x4c2b5b(0x13b)]||'',_0x45cccd=_0x4fde81[_0x4c2b5b(0x176)][_0x4c2b5b(0x13f)],_0x24ba9f=_0x4fde81[_0x4c2b5b(0x176)]['success']?_0x4c2b5b(0x142)+new Date()[_0x4c2b5b(0x15e)]()+'\x20('+_0x1bbd84+')':_0x4c2b5b(0x152)+_0x4fde81[_0x4c2b5b(0x176)][_0x4c2b5b(0x14f)];_0x576a26['setStateAsync']('analysis.training.status',{'val':_0x24ba9f,'ack':!![]});if(_0x4fde81['payload'][_0x4c2b5b(0x159)]&&_0x45cccd)_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x14e),{'val':_0x45cccd,'ack':!![]});}else{if(_0x4fde81['type']==='COMFORT_RESULT'){const {patterns:_0xc91ab8}=_0x4fde81[_0x4c2b5b(0x176)];if(_0xc91ab8&&_0xc91ab8['length']>0x0){_0x576a26[_0x4c2b5b(0x170)]['info'](_0x4c2b5b(0x143)+_0xc91ab8['length']+'\x20new\x20patterns.'),_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x17d),{'val':JSON[_0x4c2b5b(0x168)](_0xc91ab8),'ack':!![]});const _0x11b437=_0xc91ab8[0x0],_0x161ff4=_0x4c2b5b(0x139)+_0x11b437[_0x4c2b5b(0x190)]+'\x20('+(_0x11b437['confidence']*0x64)['toFixed'](0x0)+'%)';_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x14a),{'val':!![],'ack':!![]}),_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x17c),{'val':_0x161ff4,'ack':!![]});}else _0x576a26['log'][_0x4c2b5b(0x160)](_0x4c2b5b(0x18f)),_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x14a),{'val':![],'ack':!![]}),_0x576a26[_0x4c2b5b(0x187)]('analysis.automation.detectedPatterns',{'val':'[]','ack':!![]});}else{if(_0x4fde81[_0x4c2b5b(0x137)]==='ENERGY_TRAIN_RESULT'){if(_0x4fde81[_0x4c2b5b(0x176)]['success'])try{const _0x54ff9c=JSON[_0x4c2b5b(0x18d)](_0x4fde81[_0x4c2b5b(0x176)][_0x4c2b5b(0x13b)]);if(_0x54ff9c['insulation'])_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x171),{'val':JSON[_0x4c2b5b(0x168)](_0x54ff9c['insulation']),'ack':!![]});if(_0x54ff9c[_0x4c2b5b(0x189)])_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x191),{'val':JSON[_0x4c2b5b(0x168)](_0x54ff9c[_0x4c2b5b(0x189)]),'ack':!![]});}catch(_0x4a5395){}}else{if(_0x4fde81['type']===_0x4c2b5b(0x14c)){if(_0x4fde81[_0x4c2b5b(0x176)]['success'])_0x576a26[_0x4c2b5b(0x170)]['info'](_0x4c2b5b(0x140));}else{if(_0x4fde81['type']==='HEALTH_RESULT')_0x576a26[_0x4c2b5b(0x187)]('analysis.health.lastCheck',{'val':new Date()[_0x4c2b5b(0x181)](),'ack':!![]}),_0x576a26['setStateAsync'](_0x4c2b5b(0x141),{'val':_0x4fde81[_0x4c2b5b(0x176)][_0x4c2b5b(0x183)],'ack':!![]});else{if(_0x4fde81[_0x4c2b5b(0x137)]===_0x4c2b5b(0x16e))_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x16d),{'val':_0x4fde81[_0x4c2b5b(0x176)][_0x4c2b5b(0x150)],'ack':!![]}),_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x136),{'val':_0x4fde81[_0x4c2b5b(0x176)]['change_percent'],'ack':!![]});else{if(_0x4fde81[_0x4c2b5b(0x137)]===_0x4c2b5b(0x156)){const {speed_trend:_0x5e10b0}=_0x4fde81['payload'];if(_0x5e10b0!==undefined)_0x576a26[_0x4c2b5b(0x187)]('analysis.health.gaitSpeed',{'val':_0x5e10b0,'ack':!![]});}else{if(_0x4fde81['type']===_0x4c2b5b(0x17f)){const {forecast:_0x5e8837}=_0x4fde81[_0x4c2b5b(0x176)];if(_0x5e8837)_0x576a26[_0x4c2b5b(0x187)]('analysis.energy.forecast',{'val':JSON[_0x4c2b5b(0x168)](_0x5e8837),'ack':!![]});}else{if(_0x4fde81[_0x4c2b5b(0x137)]===_0x4c2b5b(0x149)){const {data:_0x315043}=_0x4fde81['payload'];_0x315043&&(_0x576a26['log'][_0x4c2b5b(0x160)]('ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.'),_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x188),{'val':JSON[_0x4c2b5b(0x168)](_0x315043),'ack':!![]}));}else{if(_0x4fde81['type']==='TOPOLOGY_ACK')_0x576a26[_0x4c2b5b(0x170)][_0x4c2b5b(0x138)](_0x4c2b5b(0x164));else{if(_0x4fde81[_0x4c2b5b(0x137)]===_0x4c2b5b(0x17a)){const {room:_0x29d424,propagation:_0x1a2134}=_0x4fde81[_0x4c2b5b(0x176)];let _0x216b2e=_0x4c2b5b(0x185),_0x15390c=0x0;if(_0x1a2134){const _0x9b1103=Object['entries'](_0x1a2134);_0x9b1103[_0x4c2b5b(0x146)]>0x0&&(_0x216b2e=_0x9b1103[0x0][0x0],_0x15390c=_0x9b1103[0x0][0x1]);}_0x576a26['setStateAsync'](_0x4c2b5b(0x18b),{'val':_0x216b2e,'ack':!![]}),_0x576a26[_0x4c2b5b(0x187)](_0x4c2b5b(0x173),{'val':_0x15390c,'ack':!![]}),_0x15390c>0.4&&_0x576a26[_0x4c2b5b(0x170)]['debug']('ðŸ”®\x20Prediction:\x20From\x20'+_0x29d424+_0x4c2b5b(0x13d)+_0x216b2e+'\x20('+(_0x15390c*0x64)[_0x4c2b5b(0x180)](0x0)+'%)'),automation[_0x4c2b5b(0x15d)](_0x576a26,_0x216b2e,_0x15390c);}}}}}}}}}}}}}}function a4_0x3550(){const _0x1d488c=['heating','35UFtaxB','analysis.prediction.nextRoom','existsSync','parse','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','rule','analysis.energy.heatingScore','search','199483iOPUrj','Error\x20launching\x20Python:\x20','analysis.health.trendValue','type','debug','Regel\x20erkannt:\x20','error','details','251844Nwqefs','\x20->\x20Likely\x20','data','threshold','âœ…\x20HEALTH\x20TRAINED.','analysis.health.isAnomaly','Success:\x20','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','apply','write','length','analysis.security.lastScore','forEach','TOPOLOGY_RESULT','analysis.automation.patternDetected','798768zoPSdB','HEALTH_TRAIN_RESULT','trim','analysis.security.currentThreshold','reason','diagnosis','ANOMALY','Failed:\x20','PONG','âš ï¸\x20SECURITY\x20ALARM:\x20','exports','GAIT_RESULT','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','147752lKcBeF','success','sendNotification','10aISovF','child_process','handlePrediction','toLocaleTimeString','(((.+)+)+)+$','info','service.py','./setup','split','ðŸ\x20Python\x20confirmed\x20new\x20topology.','[PYTHON]\x20','startsWith','8bHVqAM','stringify','9262827WvNjAn','876768xpopmn','744195EkoFmJ','kill','analysis.health.trendDiagnosis','TREND_RESULT','\x20->\x20','log','analysis.energy.insulationScore','analysis.isAlert','analysis.prediction.confidence','join','stdin','payload','sendToPythonWrapper','ðŸ\x20Python\x20Pong','writable','SIGNAL_RESULT','analysis.security.lastCheck','analysis.automation.description','analysis.automation.detectedPatterns','substring','ENERGY_PREDICT_RESULT','toFixed','toISOString','toString','is_anomaly','analysis.alertReason','Unknown','./automation','setStateAsync','analysis.security.topologyMatrix'];a4_0x3550=function(){return _0x1d488c;};return a4_0x3550();}function startService(_0x1b8cc6,_0x1a428a){const _0x5a1fd1=a4_0x674cdb;let _0x36b9fa='python3';if(fs[_0x5a1fd1(0x18c)](_0x1a428a))_0x36b9fa=_0x1a428a;try{const _0x3d79a7=path[_0x5a1fd1(0x174)](__dirname,'..','python_service',_0x5a1fd1(0x161));pythonProcess=spawn(_0x36b9fa,[_0x3d79a7]),pythonProcess['stdout']['on'](_0x5a1fd1(0x13e),_0x58f4ce=>{const _0x453443=_0x5a1fd1,_0x154424=_0x58f4ce['toString']()[_0x453443(0x163)]('\x0a');_0x154424[_0x453443(0x148)](_0x457e2c=>{const _0x5ec0ff=_0x453443,_0x2cd7bc=_0x457e2c[_0x5ec0ff(0x14d)]();if(!_0x2cd7bc)return;if(_0x2cd7bc[_0x5ec0ff(0x166)]('[LOG]'))_0x1b8cc6[_0x5ec0ff(0x170)][_0x5ec0ff(0x138)](_0x5ec0ff(0x165)+_0x2cd7bc['substring'](0x5)[_0x5ec0ff(0x14d)]());else{if(_0x2cd7bc[_0x5ec0ff(0x166)]('[RESULT]'))try{const _0x58b906=JSON[_0x5ec0ff(0x18d)](_0x2cd7bc[_0x5ec0ff(0x17e)](0x8)[_0x5ec0ff(0x14d)]());handleResult(_0x1b8cc6,_0x58b906);}catch(_0xeb87c9){}}});}),pythonProcess['on']('close',_0x198ad9=>{pythonProcess=null;}),_0x1b8cc6[_0x5a1fd1(0x177)]=(_0x633673,_0x5874c4)=>send(_0x1b8cc6,_0x633673,_0x5874c4);}catch(_0x4fbbc5){_0x1b8cc6[_0x5a1fd1(0x170)][_0x5a1fd1(0x13a)](_0x5a1fd1(0x194)+_0x4fbbc5['message']);}}function stopService(_0x479236){const _0x30da62=a4_0x674cdb;if(pythonProcess){try{pythonProcess[_0x30da62(0x16c)]();}catch(_0x407779){}pythonProcess=null;}}module[a4_0x674cdb(0x155)]={'startService':startService,'stopService':stopService,'send':send};