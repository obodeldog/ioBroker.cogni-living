const a3_0x3f80d3=a3_0x3802;(function(_0x11584d,_0x590824){const _0x3b4cc2=a3_0x3802,_0x2bf0ba=_0x11584d();while(!![]){try{const _0x395b95=parseInt(_0x3b4cc2(0x184))/0x1*(-parseInt(_0x3b4cc2(0x1ae))/0x2)+-parseInt(_0x3b4cc2(0x19f))/0x3+-parseInt(_0x3b4cc2(0x179))/0x4*(-parseInt(_0x3b4cc2(0x188))/0x5)+parseInt(_0x3b4cc2(0x1a5))/0x6+parseInt(_0x3b4cc2(0x163))/0x7+parseInt(_0x3b4cc2(0x1a7))/0x8*(parseInt(_0x3b4cc2(0x168))/0x9)+-parseInt(_0x3b4cc2(0x194))/0xa;if(_0x395b95===_0x590824)break;else _0x2bf0ba['push'](_0x2bf0ba['shift']());}catch(_0x225371){_0x2bf0ba['push'](_0x2bf0ba['shift']());}}}(a3_0x2033,0x9d1b2));const a3_0x2c3724=(function(){let _0x5b1cdc=!![];return function(_0x5da564,_0x54e0f5){const _0x40f1e9=_0x5b1cdc?function(){const _0x4671d0=a3_0x3802;if(_0x54e0f5){const _0x12a10c=_0x54e0f5[_0x4671d0(0x1b8)](_0x5da564,arguments);return _0x54e0f5=null,_0x12a10c;}}:function(){};return _0x5b1cdc=![],_0x40f1e9;};}()),a3_0x3fad30=a3_0x2c3724(this,function(){const _0x1f5926=a3_0x3802;return a3_0x3fad30['toString']()[_0x1f5926(0x15c)](_0x1f5926(0x18b))[_0x1f5926(0x18f)]()[_0x1f5926(0x15d)](a3_0x3fad30)[_0x1f5926(0x15c)](_0x1f5926(0x18b));});a3_0x3fad30();'use strict';const {spawn}=require(a3_0x3f80d3(0x183)),path=require('path'),fs=require('fs'),setup=require(a3_0x3f80d3(0x17b)),automation=require(a3_0x3f80d3(0x1ab));function a3_0x3802(_0x37e3bb,_0x3bb3c5){const _0x35e061=a3_0x2033();return a3_0x3802=function(_0x3fad30,_0x2c3724){_0x3fad30=_0x3fad30-0x15a;let _0x203323=_0x35e061[_0x3fad30];return _0x203323;},a3_0x3802(_0x37e3bb,_0x3bb3c5);}let pythonProcess=null;function send(_0x403137,_0x2c160e,_0x36874f={}){const _0x2ace58=a3_0x3f80d3;if(!pythonProcess||!pythonProcess['stdin'][_0x2ace58(0x190)])return;const _0x33259d=JSON[_0x2ace58(0x19b)]({'command':_0x2c160e,..._0x36874f});try{pythonProcess[_0x2ace58(0x1a0)][_0x2ace58(0x176)](_0x33259d+'\x0a');}catch(_0x5ae33d){}}function handleResult(_0x3ada70,_0x30d8de){const _0x3ce5fb=a3_0x3f80d3;if(_0x30d8de[_0x3ce5fb(0x178)]==='PONG')_0x3ada70[_0x3ce5fb(0x171)][_0x3ce5fb(0x16b)]('ðŸ\x20Python\x20Pong');else{if(_0x30d8de[_0x3ce5fb(0x178)]==='SECURITY_RESULT'){const {anomaly_score:_0x321cc6,is_anomaly:_0x1db86a,threshold:_0x270d9b,explanation:_0x3fa1a6}=_0x30d8de[_0x3ce5fb(0x164)];_0x3ada70['log']['info'](_0x3ce5fb(0x177)+_0x321cc6[_0x3ce5fb(0x1a3)](0x5)+_0x3ce5fb(0x17d)+(_0x1db86a?'ANOMALY':'OK')),_0x3ada70['setStateAsync'](_0x3ce5fb(0x189),{'val':_0x321cc6,'ack':!![]}),_0x3ada70['setStateAsync'](_0x3ce5fb(0x1aa),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x270d9b)_0x3ada70['setStateAsync'](_0x3ce5fb(0x167),{'val':_0x270d9b,'ack':!![]});if(_0x1db86a){let _0x38e0a1=_0x3ce5fb(0x1b7)+_0x321cc6[_0x3ce5fb(0x1a3)](0x4)+')';if(_0x3fa1a6&&_0x3fa1a6!=='Unknown')_0x38e0a1+=_0x3ce5fb(0x1a4)+_0x3fa1a6;_0x3ada70[_0x3ce5fb(0x16c)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x3ada70['setStateAsync'](_0x3ce5fb(0x1b6),{'val':_0x38e0a1,'ack':!![]}),setup['sendNotification'](_0x3ada70,_0x3ce5fb(0x19a)+_0x38e0a1,![],!![]);}}else{if(_0x30d8de['type']===_0x3ce5fb(0x165)){const _0x384198=_0x30d8de[_0x3ce5fb(0x164)]['details']||'',_0x360c29=_0x30d8de[_0x3ce5fb(0x164)][_0x3ce5fb(0x16a)],_0x56649e=_0x30d8de[_0x3ce5fb(0x164)][_0x3ce5fb(0x1b1)]?_0x3ce5fb(0x185)+new Date()[_0x3ce5fb(0x174)]()+'\x20('+_0x384198+')':_0x3ce5fb(0x1b4)+_0x30d8de[_0x3ce5fb(0x164)]['reason'];_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x19e),{'val':_0x56649e,'ack':!![]});if(_0x30d8de[_0x3ce5fb(0x164)][_0x3ce5fb(0x1b1)]&&_0x360c29)_0x3ada70['setStateAsync'](_0x3ce5fb(0x167),{'val':_0x360c29,'ack':!![]});}else{if(_0x30d8de['type']===_0x3ce5fb(0x1a2)){const {patterns:_0x33f0a8}=_0x30d8de[_0x3ce5fb(0x164)];if(_0x33f0a8&&_0x33f0a8[_0x3ce5fb(0x187)]>0x0){_0x3ada70[_0x3ce5fb(0x171)][_0x3ce5fb(0x16d)](_0x3ce5fb(0x193)+_0x33f0a8[_0x3ce5fb(0x187)]+_0x3ce5fb(0x16f)),_0x3ada70['setStateAsync']('analysis.automation.detectedPatterns',{'val':JSON['stringify'](_0x33f0a8),'ack':!![]});const _0x3ceabc=_0x33f0a8[0x0],_0x2dc45a=_0x3ce5fb(0x18a)+_0x3ceabc[_0x3ce5fb(0x1ac)]+'\x20('+(_0x3ceabc[_0x3ce5fb(0x191)]*0x64)['toFixed'](0x0)+'%)';_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x1b3),{'val':!![],'ack':!![]}),_0x3ada70[_0x3ce5fb(0x16c)]('analysis.automation.description',{'val':_0x2dc45a,'ack':!![]});}else _0x3ada70[_0x3ce5fb(0x171)][_0x3ce5fb(0x16d)](_0x3ce5fb(0x198)),_0x3ada70[_0x3ce5fb(0x16c)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x3ada70[_0x3ce5fb(0x16c)]('analysis.automation.detectedPatterns',{'val':'[]','ack':!![]});}else{if(_0x30d8de[_0x3ce5fb(0x178)]===_0x3ce5fb(0x180)){if(_0x30d8de[_0x3ce5fb(0x164)][_0x3ce5fb(0x1b1)])try{const _0x3d2f87=JSON[_0x3ce5fb(0x1ad)](_0x30d8de['payload'][_0x3ce5fb(0x195)]);if(_0x3d2f87[_0x3ce5fb(0x16e)])_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x15a),{'val':JSON[_0x3ce5fb(0x19b)](_0x3d2f87[_0x3ce5fb(0x16e)]),'ack':!![]});if(_0x3d2f87[_0x3ce5fb(0x161)])_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x1a8),{'val':JSON[_0x3ce5fb(0x19b)](_0x3d2f87['heating']),'ack':!![]});}catch(_0x1ae45c){}}else{if(_0x30d8de['type']===_0x3ce5fb(0x186)){if(_0x30d8de['payload'][_0x3ce5fb(0x1b1)])_0x3ada70['log'][_0x3ce5fb(0x16d)](_0x3ce5fb(0x15f));}else{if(_0x30d8de['type']==='HEALTH_RESULT')_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x17a),{'val':new Date()['toISOString'](),'ack':!![]}),_0x3ada70[_0x3ce5fb(0x16c)]('analysis.health.isAnomaly',{'val':_0x30d8de[_0x3ce5fb(0x164)][_0x3ce5fb(0x18d)],'ack':!![]});else{if(_0x30d8de[_0x3ce5fb(0x178)]==='TREND_RESULT')_0x3ada70['setStateAsync'](_0x3ce5fb(0x182),{'val':_0x30d8de['payload']['diagnosis'],'ack':!![]}),_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x181),{'val':_0x30d8de[_0x3ce5fb(0x164)]['change_percent'],'ack':!![]});else{if(_0x30d8de[_0x3ce5fb(0x178)]===_0x3ce5fb(0x170)){const {speed_trend:_0x12e537}=_0x30d8de[_0x3ce5fb(0x164)];if(_0x12e537!==undefined)_0x3ada70['setStateAsync'](_0x3ce5fb(0x15e),{'val':_0x12e537,'ack':!![]});}else{if(_0x30d8de[_0x3ce5fb(0x178)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x44afc1}=_0x30d8de[_0x3ce5fb(0x164)];if(_0x44afc1)_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x17e),{'val':JSON[_0x3ce5fb(0x19b)](_0x44afc1),'ack':!![]});}else{if(_0x30d8de['type']==='TOPOLOGY_RESULT'){const {data:_0x2fb993}=_0x30d8de['payload'];_0x2fb993&&(_0x3ada70[_0x3ce5fb(0x171)][_0x3ce5fb(0x16d)](_0x3ce5fb(0x196)),_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x172),{'val':JSON[_0x3ce5fb(0x19b)](_0x2fb993),'ack':!![]}));}else{if(_0x30d8de['type']==='TOPOLOGY_ACK')_0x3ada70[_0x3ce5fb(0x171)][_0x3ce5fb(0x16b)](_0x3ce5fb(0x1b2));else{if(_0x30d8de[_0x3ce5fb(0x178)]===_0x3ce5fb(0x17f)){const {room:_0x46bf3a,propagation:_0x5d934b}=_0x30d8de[_0x3ce5fb(0x164)];let _0x51dfeb=_0x3ce5fb(0x1a9),_0x2ed196=0x0;if(_0x5d934b){const _0x5d169b=Object[_0x3ce5fb(0x19d)](_0x5d934b);_0x5d169b[_0x3ce5fb(0x187)]>0x0&&(_0x51dfeb=_0x5d169b[0x0][0x0],_0x2ed196=_0x5d169b[0x0][0x1]);}_0x3ada70['setStateAsync']('analysis.prediction.nextRoom',{'val':_0x51dfeb,'ack':!![]}),_0x3ada70[_0x3ce5fb(0x16c)](_0x3ce5fb(0x192),{'val':_0x2ed196,'ack':!![]}),_0x2ed196>0.4&&_0x3ada70[_0x3ce5fb(0x171)][_0x3ce5fb(0x16b)](_0x3ce5fb(0x166)+_0x46bf3a+_0x3ce5fb(0x17c)+_0x51dfeb+'\x20('+(_0x2ed196*0x64)[_0x3ce5fb(0x1a3)](0x0)+'%)'),automation['handlePrediction'](_0x3ada70,_0x51dfeb,_0x2ed196);}}}}}}}}}}}}}}function a3_0x2033(){const _0x2f4dab=['success','ðŸ\x20Python\x20confirmed\x20new\x20topology.','analysis.automation.patternDetected','Failed:\x20','join','analysis.alertReason','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','apply','analysis.energy.insulationScore','trim','search','constructor','analysis.health.gaitSpeed','âœ…\x20HEALTH\x20TRAINED.','sendToPythonWrapper','heating','exports','744744xMbkGo','payload','TRAINING_COMPLETE','ðŸ”®\x20Prediction:\x20From\x20','analysis.security.currentThreshold','63XWffKT','error','threshold','debug','setStateAsync','info','insulation','\x20new\x20patterns.','GAIT_RESULT','log','analysis.security.topologyMatrix','substring','toLocaleTimeString','[RESULT]','write','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','type','1519324QDiZbE','analysis.health.lastCheck','./setup','\x20->\x20Likely\x20','\x20->\x20','analysis.energy.forecast','SIGNAL_RESULT','ENERGY_TRAIN_RESULT','analysis.health.trendValue','analysis.health.trendDiagnosis','child_process','5JRxFap','Success:\x20','HEALTH_TRAIN_RESULT','length','15jsNFxJ','analysis.security.lastScore','Regel\x20erkannt:\x20','(((.+)+)+)+$','[PYTHON]\x20','is_anomaly','service.py','toString','writable','confidence','analysis.prediction.confidence','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','2419520lSyRGC','details','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','split','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','close','âš ï¸\x20SECURITY\x20ALARM:\x20','stringify','data','entries','analysis.training.status','43614EQWTCn','stdin','forEach','COMFORT_RESULT','toFixed','\x0aGrund:\x20','4556754vkwtbc','existsSync','164328PesULi','analysis.energy.heatingScore','Unknown','analysis.security.lastCheck','./automation','rule','parse','499654ddmNqh','stdout','startsWith'];a3_0x2033=function(){return _0x2f4dab;};return a3_0x2033();}function startService(_0x439132,_0x55b3a0){const _0x2e4e14=a3_0x3f80d3;let _0x396ece='python3';if(fs[_0x2e4e14(0x1a6)](_0x55b3a0))_0x396ece=_0x55b3a0;try{const _0x56888b=path[_0x2e4e14(0x1b5)](__dirname,'..','python_service',_0x2e4e14(0x18e));pythonProcess=spawn(_0x396ece,[_0x56888b]),pythonProcess[_0x2e4e14(0x1af)]['on'](_0x2e4e14(0x19c),_0xe4c449=>{const _0x317388=_0x2e4e14,_0x1d5260=_0xe4c449[_0x317388(0x18f)]()[_0x317388(0x197)]('\x0a');_0x1d5260[_0x317388(0x1a1)](_0x43da56=>{const _0x3b478b=_0x317388,_0xfd672b=_0x43da56[_0x3b478b(0x15b)]();if(!_0xfd672b)return;if(_0xfd672b[_0x3b478b(0x1b0)]('[LOG]'))_0x439132[_0x3b478b(0x171)][_0x3b478b(0x16b)](_0x3b478b(0x18c)+_0xfd672b[_0x3b478b(0x173)](0x5)[_0x3b478b(0x15b)]());else{if(_0xfd672b['startsWith'](_0x3b478b(0x175)))try{const _0x289c2f=JSON[_0x3b478b(0x1ad)](_0xfd672b[_0x3b478b(0x173)](0x8)[_0x3b478b(0x15b)]());handleResult(_0x439132,_0x289c2f);}catch(_0x1d3aed){}}});}),pythonProcess['on'](_0x2e4e14(0x199),_0x5d63f8=>{pythonProcess=null;}),_0x439132[_0x2e4e14(0x160)]=(_0x18a038,_0x1a3e5e)=>send(_0x439132,_0x18a038,_0x1a3e5e);}catch(_0x334f3f){_0x439132[_0x2e4e14(0x171)][_0x2e4e14(0x169)]('Error\x20launching\x20Python:\x20'+_0x334f3f['message']);}}function stopService(_0x47cb73){if(pythonProcess){try{pythonProcess['kill']();}catch(_0x2cb74d){}pythonProcess=null;}}module[a3_0x3f80d3(0x162)]={'startService':startService,'stopService':stopService,'send':send};