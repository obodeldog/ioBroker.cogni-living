const a4_0x336d6b=a4_0x4e5b;(function(_0x3e13d3,_0x32edb5){const _0x346c26=a4_0x4e5b,_0x397e49=_0x3e13d3();while(!![]){try{const _0x3912cf=parseInt(_0x346c26(0x212))/0x1*(parseInt(_0x346c26(0x21f))/0x2)+parseInt(_0x346c26(0x1fa))/0x3+-parseInt(_0x346c26(0x201))/0x4+-parseInt(_0x346c26(0x23f))/0x5*(parseInt(_0x346c26(0x209))/0x6)+-parseInt(_0x346c26(0x23b))/0x7+-parseInt(_0x346c26(0x242))/0x8*(-parseInt(_0x346c26(0x215))/0x9)+-parseInt(_0x346c26(0x23d))/0xa*(-parseInt(_0x346c26(0x21d))/0xb);if(_0x3912cf===_0x32edb5)break;else _0x397e49['push'](_0x397e49['shift']());}catch(_0x40edc2){_0x397e49['push'](_0x397e49['shift']());}}}(a4_0x664b,0x818fc));const a4_0x4504a3=(function(){let _0x1087cd=!![];return function(_0xfa3ff5,_0x3e9ed6){const _0x48fbd5=_0x1087cd?function(){const _0x2f4083=a4_0x4e5b;if(_0x3e9ed6){const _0x26858a=_0x3e9ed6[_0x2f4083(0x20e)](_0xfa3ff5,arguments);return _0x3e9ed6=null,_0x26858a;}}:function(){};return _0x1087cd=![],_0x48fbd5;};}()),a4_0x788945=a4_0x4504a3(this,function(){const _0x1cbbc7=a4_0x4e5b;return a4_0x788945[_0x1cbbc7(0x248)]()[_0x1cbbc7(0x234)](_0x1cbbc7(0x1f9))[_0x1cbbc7(0x248)]()[_0x1cbbc7(0x228)](a4_0x788945)[_0x1cbbc7(0x234)](_0x1cbbc7(0x1f9));});a4_0x788945();function a4_0x4e5b(_0x366eef,_0x39bbfa){const _0x34e516=a4_0x664b();return a4_0x4e5b=function(_0x788945,_0x4504a3){_0x788945=_0x788945-0x1f1;let _0x664bb5=_0x34e516[_0x788945];return _0x664bb5;},a4_0x4e5b(_0x366eef,_0x39bbfa);}'use strict';const {spawn}=require('child_process'),path=require(a4_0x336d6b(0x24a)),fs=require('fs'),setup=require('./setup'),automation=require('./automation');let pythonProcess=null;function send(_0x49f54a,_0x2f60b5,_0x134ea0={}){const _0xa1e4ef=a4_0x336d6b;if(!pythonProcess||!pythonProcess[_0xa1e4ef(0x22a)][_0xa1e4ef(0x232)])return;const _0x27b8a3=JSON[_0xa1e4ef(0x1fb)]({'command':_0x2f60b5,..._0x134ea0});try{pythonProcess['stdin'][_0xa1e4ef(0x1f4)](_0x27b8a3+'\x0a');}catch(_0x2722c9){}}function handleResult(_0x2349d1,_0x3837dc){const _0x55d3f5=a4_0x336d6b;if(_0x3837dc[_0x55d3f5(0x214)]===_0x55d3f5(0x249))_0x2349d1[_0x55d3f5(0x23a)][_0x55d3f5(0x1f5)](_0x55d3f5(0x246));else{if(_0x3837dc[_0x55d3f5(0x214)]==='SECURITY_RESULT'){const {anomaly_score:_0x2e3cbb,is_anomaly:_0x206af0,threshold:_0x1d7e81,explanation:_0x19a17d}=_0x3837dc[_0x55d3f5(0x202)];_0x2349d1['setStateAsync'](_0x55d3f5(0x220),{'val':_0x2e3cbb,'ack':!![]}),_0x2349d1['setStateAsync']('analysis.security.lastCheck',{'val':new Date()[_0x55d3f5(0x1f7)](),'ack':!![]});if(_0x1d7e81)_0x2349d1['setStateAsync'](_0x55d3f5(0x247),{'val':_0x1d7e81,'ack':!![]});if(_0x206af0){let _0x21a771=_0x55d3f5(0x210)+_0x2e3cbb['toFixed'](0x4)+')';if(_0x19a17d&&_0x19a17d!==_0x55d3f5(0x24e))_0x21a771+='\x0aGrund:\x20'+_0x19a17d;_0x2349d1[_0x55d3f5(0x231)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x23c),{'val':_0x21a771,'ack':!![]}),setup[_0x55d3f5(0x226)](_0x2349d1,_0x55d3f5(0x217)+_0x21a771,![],!![]);}}else{if(_0x3837dc[_0x55d3f5(0x214)]===_0x55d3f5(0x200)){const _0x5e5442=_0x3837dc['payload'][_0x55d3f5(0x23e)]||'',_0x4a572f=_0x3837dc[_0x55d3f5(0x202)][_0x55d3f5(0x238)],_0x275b9f=_0x3837dc[_0x55d3f5(0x202)][_0x55d3f5(0x20a)]?_0x55d3f5(0x24c)+new Date()[_0x55d3f5(0x239)]()+'\x20('+_0x5e5442+')':'Failed:\x20'+_0x3837dc[_0x55d3f5(0x202)][_0x55d3f5(0x219)];_0x2349d1['setStateAsync'](_0x55d3f5(0x244),{'val':_0x275b9f,'ack':!![]});if(_0x3837dc[_0x55d3f5(0x202)][_0x55d3f5(0x20a)]&&_0x4a572f)_0x2349d1[_0x55d3f5(0x231)]('analysis.security.currentThreshold',{'val':_0x4a572f,'ack':!![]});}else{if(_0x3837dc[_0x55d3f5(0x214)]===_0x55d3f5(0x223)){if(_0x3837dc[_0x55d3f5(0x202)][_0x55d3f5(0x20a)])try{const _0x2688bc=JSON['parse'](_0x3837dc[_0x55d3f5(0x202)][_0x55d3f5(0x23e)]);if(_0x2688bc[_0x55d3f5(0x211)])_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x243),{'val':JSON[_0x55d3f5(0x1fb)](_0x2688bc['insulation']),'ack':!![]});if(_0x2688bc['heating'])_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x230),{'val':JSON['stringify'](_0x2688bc[_0x55d3f5(0x221)]),'ack':!![]});}catch(_0x554ced){}}else{if(_0x3837dc[_0x55d3f5(0x214)]===_0x55d3f5(0x22b)){if(_0x3837dc[_0x55d3f5(0x202)]['success'])_0x2349d1[_0x55d3f5(0x23a)][_0x55d3f5(0x218)](_0x55d3f5(0x203));}else{if(_0x3837dc[_0x55d3f5(0x214)]==='HEALTH_RESULT')_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x235),{'val':new Date()['toISOString'](),'ack':!![]}),_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x20d),{'val':_0x3837dc['payload'][_0x55d3f5(0x20f)],'ack':!![]});else{if(_0x3837dc[_0x55d3f5(0x214)]===_0x55d3f5(0x20c)){const {speed_trend:_0x370356}=_0x3837dc[_0x55d3f5(0x202)];if(_0x370356!==undefined)_0x2349d1['setStateAsync']('analysis.health.gaitSpeed',{'val':_0x370356,'ack':!![]});}else{if(_0x3837dc['type']===_0x55d3f5(0x1ff)){const {forecast:_0x2e47ac}=_0x3837dc[_0x55d3f5(0x202)];if(_0x2e47ac)_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x22f),{'val':JSON['stringify'](_0x2e47ac),'ack':!![]});}else{if(_0x3837dc[_0x55d3f5(0x214)]==='WARMUP_RESULT'){const {times:_0x430ec3,sources:_0x562e20,details:_0x1d45a5}=_0x3837dc['payload'];if(_0x430ec3)_0x2349d1[_0x55d3f5(0x231)]('analysis.energy.warmupTimes',{'val':JSON[_0x55d3f5(0x1fb)](_0x430ec3),'ack':!![]});if(_0x562e20)_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x222),{'val':JSON['stringify'](_0x562e20),'ack':!![]});if(_0x1d45a5)_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x245),{'val':JSON[_0x55d3f5(0x1fb)](_0x1d45a5),'ack':!![]});}else{if(_0x3837dc[_0x55d3f5(0x214)]===_0x55d3f5(0x227)){const {forecast:_0x58d43e}=_0x3837dc[_0x55d3f5(0x202)];if(_0x58d43e)_0x2349d1['setStateAsync'](_0x55d3f5(0x1f6),{'val':JSON[_0x55d3f5(0x1fb)](_0x58d43e),'ack':!![]});}else{if(_0x3837dc['type']==='VENTILATION_ALERT'){const {alerts:_0x1f1534}=_0x3837dc[_0x55d3f5(0x202)];if(_0x1f1534)_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x1fc),{'val':JSON['stringify'](_0x1f1534),'ack':!![]});}else{if(_0x3837dc[_0x55d3f5(0x214)]==='ENERGY_OPTIMIZE_RESULT'){const {proposals:_0x485c5d}=_0x3837dc[_0x55d3f5(0x202)];_0x2349d1['getState'](_0x55d3f5(0x233),(_0x271279,_0x30b49c)=>{const _0xcd05b=_0x55d3f5;_0x30b49c&&_0x30b49c[_0xcd05b(0x1fd)]===!![]&&_0x485c5d&&_0x485c5d['length']>0x0&&automation[_0xcd05b(0x22d)](_0x2349d1,_0x485c5d);});}else{if(_0x3837dc[_0x55d3f5(0x214)]==='SIGNAL_RESULT'){const {room:_0x20988b,propagation:_0x3c0bcd}=_0x3837dc[_0x55d3f5(0x202)];let _0x784e62='Unknown',_0x55e3b2=0x0;if(_0x3c0bcd){const _0x577aef=Object[_0x55d3f5(0x1f8)](_0x3c0bcd);_0x577aef[_0x55d3f5(0x206)]>0x0&&(_0x784e62=_0x577aef[0x0][0x0],_0x55e3b2=_0x577aef[0x0][0x1]);}_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x241),{'val':_0x784e62,'ack':!![]}),_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x21b),{'val':_0x55e3b2,'ack':!![]}),automation['handlePrediction'](_0x2349d1,_0x784e62,_0x55e3b2);}else{if(_0x3837dc[_0x55d3f5(0x214)]==='TRACKER_RESULT'){const {probabilities:_0x11c4a6}=_0x3837dc['payload'];if(_0x11c4a6){_0x2349d1['setStateAsync'](_0x55d3f5(0x1f3),{'val':JSON['stringify'](_0x11c4a6),'ack':!![]});const _0x4ee5b2=Object[_0x55d3f5(0x225)](_0x11c4a6);if(_0x4ee5b2[_0x55d3f5(0x206)]>0x0){const _0x3758df=_0x4ee5b2[0x0],_0x38acd1=_0x11c4a6[_0x3758df];_0x2349d1[_0x55d3f5(0x231)]('analysis.prediction.trackerTopRoom',{'val':_0x3758df,'ack':!![]}),_0x2349d1[_0x55d3f5(0x231)](_0x55d3f5(0x205),{'val':_0x38acd1,'ack':!![]});}}}else{if(_0x3837dc[_0x55d3f5(0x214)]===_0x55d3f5(0x20b)){const {patterns:_0x451602}=_0x3837dc['payload'];if(_0x451602&&_0x451602[_0x55d3f5(0x206)]>0x0)_0x2349d1['setStateAsync']('analysis.automation.detectedPatterns',{'val':JSON[_0x55d3f5(0x1fb)](_0x451602),'ack':!![]});}}}}}}}}}}}}}}}}function a4_0x664b(){const _0x23ae97=['ENERGY_TRAIN_RESULT','[PYTHON]\x20','keys','sendNotification','PINN_PREDICT_RESULT','constructor','message','stdin','HEALTH_TRAIN_RESULT','split','applyEnergySavings','close','analysis.energy.forecast','analysis.energy.heatingScore','setStateAsync','writable','analysis.energy.mpcActive','search','analysis.health.lastCheck','[RESULT]','exports','threshold','toLocaleTimeString','log','1977696lfsreX','analysis.alertReason','58110lEYLwx','details','5cMQEZZ','forEach','analysis.prediction.nextRoom','568STzQlG','analysis.energy.insulationScore','analysis.training.status','analysis.energy.warmupDetails','ðŸ\x20Python\x20Pong','analysis.security.currentThreshold','toString','PONG','path','startsWith','Success:\x20','python_service','Unknown','trim','Error\x20launching\x20Python:\x20','analysis.prediction.trackerState','write','debug','analysis.energy.pinnForecast','toISOString','entries','(((.+)+)+)+$','351429irOyNl','stringify','analysis.energy.ventilationAlerts','val','existsSync','ENERGY_PREDICT_RESULT','TRAINING_COMPLETE','3724284lDiBXs','payload','âœ…\x20HEALTH\x20TRAINED.','service.py','analysis.prediction.trackerConfidence','length','substring','[LOG]','3800880KDfeWD','success','COMFORT_RESULT','GAIT_RESULT','analysis.health.isAnomaly','apply','is_anomaly','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','insulation','75687zNDWGS','stdout','type','27108glZnVO','error','âš ï¸\x20SECURITY\x20ALARM:\x20','info','reason','data','analysis.prediction.confidence','kill','2585JcAXrQ','sendToPythonWrapper','18QRZqMI','analysis.security.lastScore','heating','analysis.energy.warmupSources'];a4_0x664b=function(){return _0x23ae97;};return a4_0x664b();}function startService(_0x283dd8,_0x362273){const _0x437701=a4_0x336d6b;let _0x504fc3='python3';if(fs[_0x437701(0x1fe)](_0x362273))_0x504fc3=_0x362273;try{const _0x3dd60b=path['join'](__dirname,'..',_0x437701(0x24d),_0x437701(0x204));pythonProcess=spawn(_0x504fc3,[_0x3dd60b]),pythonProcess[_0x437701(0x213)]['on'](_0x437701(0x21a),_0x1a877b=>{const _0x3aec16=_0x437701,_0x21658b=_0x1a877b[_0x3aec16(0x248)]()[_0x3aec16(0x22c)]('\x0a');_0x21658b[_0x3aec16(0x240)](_0x46db6a=>{const _0x5c78a9=_0x3aec16,_0x3f3d94=_0x46db6a['trim']();if(!_0x3f3d94)return;if(_0x3f3d94[_0x5c78a9(0x24b)](_0x5c78a9(0x208)))_0x283dd8[_0x5c78a9(0x23a)][_0x5c78a9(0x1f5)](_0x5c78a9(0x224)+_0x3f3d94[_0x5c78a9(0x207)](0x5)['trim']());else{if(_0x3f3d94[_0x5c78a9(0x24b)](_0x5c78a9(0x236)))try{const _0x5c3979=JSON['parse'](_0x3f3d94['substring'](0x8)[_0x5c78a9(0x1f1)]());handleResult(_0x283dd8,_0x5c3979);}catch(_0x4a65d4){}}});}),pythonProcess['on'](_0x437701(0x22e),_0x93d1d9=>{pythonProcess=null;}),_0x283dd8[_0x437701(0x21e)]=(_0x54f8b9,_0x3162b4)=>send(_0x283dd8,_0x54f8b9,_0x3162b4);}catch(_0x509050){_0x283dd8[_0x437701(0x23a)][_0x437701(0x216)](_0x437701(0x1f2)+_0x509050[_0x437701(0x229)]);}}function stopService(_0x313e9f){const _0x4b88e1=a4_0x336d6b;if(pythonProcess){try{pythonProcess[_0x4b88e1(0x21c)]();}catch(_0x184c3c){}pythonProcess=null;}}module[a4_0x336d6b(0x237)]={'startService':startService,'stopService':stopService,'send':send};