const a4_0x1f723e=a4_0x2bcc;(function(_0x412f6d,_0xc16981){const _0x5efb91=a4_0x2bcc,_0x4b8f14=_0x412f6d();while(!![]){try{const _0x1b99bd=-parseInt(_0x5efb91(0xff))/0x1+parseInt(_0x5efb91(0xb0))/0x2*(-parseInt(_0x5efb91(0xd4))/0x3)+parseInt(_0x5efb91(0xf4))/0x4+-parseInt(_0x5efb91(0xfc))/0x5*(-parseInt(_0x5efb91(0xd1))/0x6)+parseInt(_0x5efb91(0x99))/0x7*(-parseInt(_0x5efb91(0xb8))/0x8)+-parseInt(_0x5efb91(0xfe))/0x9*(parseInt(_0x5efb91(0xdc))/0xa)+-parseInt(_0x5efb91(0xe0))/0xb*(-parseInt(_0x5efb91(0xa4))/0xc);if(_0x1b99bd===_0xc16981)break;else _0x4b8f14['push'](_0x4b8f14['shift']());}catch(_0x2933ac){_0x4b8f14['push'](_0x4b8f14['shift']());}}}(a4_0x38d3,0xcf86a));const a4_0x4174ce=(function(){let _0xe6b396=!![];return function(_0x1853ac,_0x49c2fe){const _0x164149=_0xe6b396?function(){const _0x171203=a4_0x2bcc;if(_0x49c2fe){const _0x306c5f=_0x49c2fe[_0x171203(0x101)](_0x1853ac,arguments);return _0x49c2fe=null,_0x306c5f;}}:function(){};return _0xe6b396=![],_0x164149;};}()),a4_0x55b692=a4_0x4174ce(this,function(){const _0x589c00=a4_0x2bcc;return a4_0x55b692[_0x589c00(0x103)]()[_0x589c00(0xd3)](_0x589c00(0xf9))[_0x589c00(0x103)]()[_0x589c00(0xda)](a4_0x55b692)['search'](_0x589c00(0xf9));});a4_0x55b692();'use strict';const {spawn}=require(a4_0x1f723e(0x97)),path=require('path'),fs=require('fs'),setup=require(a4_0x1f723e(0xc3)),automation=require(a4_0x1f723e(0xc1));let pythonProcess=null;function send(_0x3faa7b,_0xf8fc71,_0x47d213={}){const _0x1cb7c6=a4_0x1f723e;if(!pythonProcess||!pythonProcess['stdin'][_0x1cb7c6(0xbb)])return;const _0x7c144f=JSON[_0x1cb7c6(0xf2)]({'command':_0xf8fc71,..._0x47d213});try{pythonProcess[_0x1cb7c6(0xf8)][_0x1cb7c6(0xe1)](_0x7c144f+'\x0a');}catch(_0x14a128){}}function a4_0x2bcc(_0x3ca5d8,_0x5e142f){const _0x1cd334=a4_0x38d3();return a4_0x2bcc=function(_0x55b692,_0x4174ce){_0x55b692=_0x55b692-0x97;let _0x38d356=_0x1cd334[_0x55b692];return _0x38d356;},a4_0x2bcc(_0x3ca5d8,_0x5e142f);}function handleResult(_0x160308,_0xb6a7d){const _0x2d5831=a4_0x1f723e;if(_0xb6a7d[_0x2d5831(0x100)]===_0x2d5831(0x98))_0x160308[_0x2d5831(0xcf)][_0x2d5831(0xfa)](_0x2d5831(0x9b));else{if(_0xb6a7d['type']===_0x2d5831(0xa5)){const {anomaly_score:_0x4d5cdb,is_anomaly:_0x195166,threshold:_0x4210b6,explanation:_0x4f8230}=_0xb6a7d[_0x2d5831(0xa2)];_0x160308[_0x2d5831(0xcf)][_0x2d5831(0xe9)](_0x2d5831(0xb1)+_0x4d5cdb[_0x2d5831(0xab)](0x5)+_0x2d5831(0xc8)+(_0x195166?_0x2d5831(0xb9):'OK')),_0x160308[_0x2d5831(0xa0)]('analysis.security.lastScore',{'val':_0x4d5cdb,'ack':!![]}),_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xec),{'val':new Date()[_0x2d5831(0xae)](),'ack':!![]});if(_0x4210b6)_0x160308[_0x2d5831(0xa0)]('analysis.security.currentThreshold',{'val':_0x4210b6,'ack':!![]});if(_0x195166){let _0x5a0015=_0x2d5831(0xeb)+_0x4d5cdb[_0x2d5831(0xab)](0x4)+')';if(_0x4f8230&&_0x4f8230!==_0x2d5831(0xe5))_0x5a0015+=_0x2d5831(0xc7)+_0x4f8230;_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xbe),{'val':!![],'ack':!![]}),_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xfb),{'val':_0x5a0015,'ack':!![]}),setup[_0x2d5831(0xaf)](_0x160308,'‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20'+_0x5a0015,![],!![]);}}else{if(_0xb6a7d['type']===_0x2d5831(0xcb)){const _0x4aa326=_0xb6a7d['payload'][_0x2d5831(0xe2)]||'',_0x459658=_0xb6a7d[_0x2d5831(0xa2)]['threshold'],_0x8d252b=_0xb6a7d['payload'][_0x2d5831(0xb5)]?_0x2d5831(0x102)+new Date()[_0x2d5831(0x9c)]()+'\x20('+_0x4aa326+')':_0x2d5831(0xf3)+_0xb6a7d[_0x2d5831(0xa2)][_0x2d5831(0xd0)];_0x160308['setStateAsync']('analysis.training.status',{'val':_0x8d252b,'ack':!![]});if(_0xb6a7d[_0x2d5831(0xa2)][_0x2d5831(0xb5)]&&_0x459658)_0x160308['setStateAsync'](_0x2d5831(0xe6),{'val':_0x459658,'ack':!![]});}else{if(_0xb6a7d[_0x2d5831(0x100)]===_0x2d5831(0xd2)){const {patterns:_0x4d336e}=_0xb6a7d[_0x2d5831(0xa2)];if(_0x4d336e&&_0x4d336e['length']>0x0){_0x160308['log'][_0x2d5831(0xe9)](_0x2d5831(0xef)+_0x4d336e['length']+_0x2d5831(0x9a)),_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xb4),{'val':JSON[_0x2d5831(0xf2)](_0x4d336e),'ack':!![]});const _0x35afe7=_0x4d336e[0x0],_0x12d8d1=_0x2d5831(0xde)+_0x35afe7[_0x2d5831(0xcc)]+'\x20('+(_0x35afe7[_0x2d5831(0xf7)]*0x64)[_0x2d5831(0xab)](0x0)+'%)';_0x160308['setStateAsync'](_0x2d5831(0xcd),{'val':!![],'ack':!![]}),_0x160308['setStateAsync']('analysis.automation.description',{'val':_0x12d8d1,'ack':!![]});}else _0x160308[_0x2d5831(0xcf)][_0x2d5831(0xe9)](_0x2d5831(0xb3)),_0x160308[_0x2d5831(0xa0)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xb4),{'val':'[]','ack':!![]});}else{if(_0xb6a7d[_0x2d5831(0x100)]===_0x2d5831(0xa7)){if(_0xb6a7d['payload'][_0x2d5831(0xb5)])try{const _0xe036ee=JSON[_0x2d5831(0xd7)](_0xb6a7d[_0x2d5831(0xa2)][_0x2d5831(0xe2)]);if(_0xe036ee[_0x2d5831(0xc6)])_0x160308['setStateAsync'](_0x2d5831(0xc5),{'val':JSON[_0x2d5831(0xf2)](_0xe036ee['insulation']),'ack':!![]});if(_0xe036ee[_0x2d5831(0xc9)])_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xb6),{'val':JSON['stringify'](_0xe036ee['heating']),'ack':!![]});}catch(_0x2f24c7){}}else{if(_0xb6a7d[_0x2d5831(0x100)]===_0x2d5831(0xe7)){if(_0xb6a7d[_0x2d5831(0xa2)][_0x2d5831(0xb5)])_0x160308['log'][_0x2d5831(0xe9)](_0x2d5831(0x9f));}else{if(_0xb6a7d[_0x2d5831(0x100)]===_0x2d5831(0xc0))_0x160308[_0x2d5831(0xa0)]('analysis.health.lastCheck',{'val':new Date()[_0x2d5831(0xae)](),'ack':!![]}),_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xa6),{'val':_0xb6a7d['payload'][_0x2d5831(0xaa)],'ack':!![]});else{if(_0xb6a7d[_0x2d5831(0x100)]===_0x2d5831(0xad))_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xdb),{'val':_0xb6a7d[_0x2d5831(0xa2)][_0x2d5831(0xba)],'ack':!![]}),_0x160308['setStateAsync'](_0x2d5831(0xe8),{'val':_0xb6a7d[_0x2d5831(0xa2)][_0x2d5831(0xd5)],'ack':!![]});else{if(_0xb6a7d[_0x2d5831(0x100)]===_0x2d5831(0xd9)){const {speed_trend:_0x4dbf91}=_0xb6a7d[_0x2d5831(0xa2)];if(_0x4dbf91!==undefined)_0x160308['setStateAsync'](_0x2d5831(0xbd),{'val':_0x4dbf91,'ack':!![]});}else{if(_0xb6a7d['type']===_0x2d5831(0xac)){const {forecast:_0x6ad737}=_0xb6a7d[_0x2d5831(0xa2)];if(_0x6ad737)_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xe4),{'val':JSON[_0x2d5831(0xf2)](_0x6ad737),'ack':!![]});}else{if(_0xb6a7d['type']===_0x2d5831(0x9e)){const {data:_0x4697cb}=_0xb6a7d[_0x2d5831(0xa2)];_0x4697cb&&(_0x160308[_0x2d5831(0xcf)][_0x2d5831(0xe9)](_0x2d5831(0xa1)),_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xf6),{'val':JSON[_0x2d5831(0xf2)](_0x4697cb),'ack':!![]}));}else{if(_0xb6a7d[_0x2d5831(0x100)]==='TOPOLOGY_ACK')_0x160308[_0x2d5831(0xcf)]['debug'](_0x2d5831(0xf1));else{if(_0xb6a7d[_0x2d5831(0x100)]===_0x2d5831(0xbc)){const {room:_0x127457,propagation:_0x28081d}=_0xb6a7d[_0x2d5831(0xa2)];let _0x1ffe91='Unknown',_0x19be4f=0x0;if(_0x28081d){const _0x12bb1d=Object[_0x2d5831(0xc2)](_0x28081d);_0x12bb1d['length']>0x0&&(_0x1ffe91=_0x12bb1d[0x0][0x0],_0x19be4f=_0x12bb1d[0x0][0x1]);}_0x160308[_0x2d5831(0xa0)](_0x2d5831(0xbf),{'val':_0x1ffe91,'ack':!![]}),_0x160308[_0x2d5831(0xa0)]('analysis.prediction.confidence',{'val':_0x19be4f,'ack':!![]}),_0x19be4f>0.4&&_0x160308[_0x2d5831(0xcf)][_0x2d5831(0xfa)](_0x2d5831(0xc4)+_0x127457+_0x2d5831(0xb7)+_0x1ffe91+'\x20('+(_0x19be4f*0x64)[_0x2d5831(0xab)](0x0)+'%)'),automation[_0x2d5831(0xdd)](_0x160308,_0x1ffe91,_0x19be4f);}}}}}}}}}}}}}}function startService(_0x3e8f05,_0x400c35){const _0x4d0c51=a4_0x1f723e;let _0xe15e54='python3';if(fs[_0x4d0c51(0xa3)](_0x400c35))_0xe15e54=_0x400c35;try{const _0x8055cf=path[_0x4d0c51(0xed)](__dirname,'..','python_service',_0x4d0c51(0x9d));pythonProcess=spawn(_0xe15e54,[_0x8055cf]),pythonProcess['stdout']['on'](_0x4d0c51(0xca),_0x1f1710=>{const _0x201f2e=_0x4d0c51,_0x354bc5=_0x1f1710[_0x201f2e(0x103)]()['split']('\x0a');_0x354bc5[_0x201f2e(0xe3)](_0x41945b=>{const _0x373378=_0x201f2e,_0x51cc0c=_0x41945b[_0x373378(0xa8)]();if(!_0x51cc0c)return;if(_0x51cc0c[_0x373378(0xf5)]('[LOG]'))_0x3e8f05['log']['debug'](_0x373378(0xa9)+_0x51cc0c[_0x373378(0xd8)](0x5)[_0x373378(0xa8)]());else{if(_0x51cc0c[_0x373378(0xf5)](_0x373378(0xdf)))try{const _0x2f89ed=JSON[_0x373378(0xd7)](_0x51cc0c['substring'](0x8)[_0x373378(0xa8)]());handleResult(_0x3e8f05,_0x2f89ed);}catch(_0x3116ec){}}});}),pythonProcess['on'](_0x4d0c51(0xb2),_0x4732bd=>{pythonProcess=null;}),_0x3e8f05[_0x4d0c51(0xea)]=(_0x2b55df,_0x48db2f)=>send(_0x3e8f05,_0x2b55df,_0x48db2f);}catch(_0xaa1856){_0x3e8f05[_0x4d0c51(0xcf)][_0x4d0c51(0xee)](_0x4d0c51(0xf0)+_0xaa1856[_0x4d0c51(0xd6)]);}}function stopService(_0x30535f){const _0x28b716=a4_0x1f723e;if(pythonProcess){try{pythonProcess[_0x28b716(0xfd)]();}catch(_0x14163c){}pythonProcess=null;}}module[a4_0x1f723e(0xce)]={'startService':startService,'stopService':stopService,'send':send};function a4_0x38d3(){const _0x133b47=['üï∏Ô∏è\x20Topology\x20Map\x20updated\x20by\x20Python.','payload','existsSync','6564cYZfwp','SECURITY_RESULT','analysis.health.isAnomaly','ENERGY_TRAIN_RESULT','trim','[PYTHON]\x20','is_anomaly','toFixed','ENERGY_PREDICT_RESULT','TREND_RESULT','toISOString','sendNotification','284044RIaTsX','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','close','üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','analysis.automation.detectedPatterns','success','analysis.energy.heatingScore','\x20->\x20Likely\x20','88MlEWon','ANOMALY','diagnosis','writable','SIGNAL_RESULT','analysis.health.gaitSpeed','analysis.isAlert','analysis.prediction.nextRoom','HEALTH_RESULT','./automation','entries','./setup','üîÆ\x20Prediction:\x20From\x20','analysis.energy.insulationScore','insulation','\x0aGrund:\x20','\x20->\x20','heating','data','TRAINING_COMPLETE','rule','analysis.automation.patternDetected','exports','log','reason','18TNGtls','COMFORT_RESULT','search','6gPohIJ','change_percent','message','parse','substring','GAIT_RESULT','constructor','analysis.health.trendDiagnosis','24190SHWGXT','handlePrediction','Regel\x20erkannt:\x20','[RESULT]','48070CvdBoZ','write','details','forEach','analysis.energy.forecast','Unknown','analysis.security.currentThreshold','HEALTH_TRAIN_RESULT','analysis.health.trendValue','info','sendToPythonWrapper','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','analysis.security.lastCheck','join','error','üõãÔ∏è\x20BUTLER:\x20Found\x20','Error\x20launching\x20Python:\x20','üêç\x20Python\x20confirmed\x20new\x20topology.','stringify','Failed:\x20','5533176KZgJLH','startsWith','analysis.security.topologyMatrix','confidence','stdin','(((.+)+)+)+$','debug','analysis.alertReason','278195mrZGbu','kill','4707rLIujZ','826713yqyQNQ','type','apply','Success:\x20','toString','child_process','PONG','454797Jblkyd','\x20new\x20patterns.','üêç\x20Python\x20Pong','toLocaleTimeString','service.py','TOPOLOGY_RESULT','‚úÖ\x20HEALTH\x20TRAINED.','setStateAsync'];a4_0x38d3=function(){return _0x133b47;};return a4_0x38d3();}