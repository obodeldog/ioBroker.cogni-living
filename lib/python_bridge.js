const a4_0x32ff57=a4_0x52e3;(function(_0x1b097b,_0x570c2f){const _0x481627=a4_0x52e3,_0x789a84=_0x1b097b();while(!![]){try{const _0x35724b=parseInt(_0x481627(0x1f5))/0x1*(parseInt(_0x481627(0x1d9))/0x2)+-parseInt(_0x481627(0x206))/0x3+-parseInt(_0x481627(0x202))/0x4+-parseInt(_0x481627(0x20b))/0x5+-parseInt(_0x481627(0x1f8))/0x6+parseInt(_0x481627(0x20c))/0x7+parseInt(_0x481627(0x204))/0x8;if(_0x35724b===_0x570c2f)break;else _0x789a84['push'](_0x789a84['shift']());}catch(_0x488ec5){_0x789a84['push'](_0x789a84['shift']());}}}(a4_0x1055,0x3bce2));const a4_0x2e5ba5=(function(){let _0x54fef5=!![];return function(_0xd7d14a,_0x2a3d60){const _0x48f097=_0x54fef5?function(){const _0xa88c6c=a4_0x52e3;if(_0x2a3d60){const _0x55fd71=_0x2a3d60[_0xa88c6c(0x1d3)](_0xd7d14a,arguments);return _0x2a3d60=null,_0x55fd71;}}:function(){};return _0x54fef5=![],_0x48f097;};}()),a4_0x219ac8=a4_0x2e5ba5(this,function(){const _0x301808=a4_0x52e3;return a4_0x219ac8[_0x301808(0x1d2)]()[_0x301808(0x1da)](_0x301808(0x20e))[_0x301808(0x1d2)]()[_0x301808(0x224)](a4_0x219ac8)[_0x301808(0x1da)](_0x301808(0x20e));});function a4_0x52e3(_0xdb0136,_0x55ac64){const _0x23feea=a4_0x1055();return a4_0x52e3=function(_0x219ac8,_0x2e5ba5){_0x219ac8=_0x219ac8-0x1d2;let _0x1055c4=_0x23feea[_0x219ac8];return _0x1055c4;},a4_0x52e3(_0xdb0136,_0x55ac64);}a4_0x219ac8();'use strict';const {spawn}=require('child_process'),path=require(a4_0x32ff57(0x1ed)),fs=require('fs'),setup=require('./setup'),automation=require('./automation');let pythonProcess=null;function send(_0x452ea3,_0x59d2fd,_0x591cba={}){const _0x850045=a4_0x32ff57;if(!pythonProcess||!pythonProcess['stdin']['writable'])return;const _0x4a78e9=JSON[_0x850045(0x1d5)]({'command':_0x59d2fd,..._0x591cba});try{pythonProcess['stdin'][_0x850045(0x226)](_0x4a78e9+'\x0a');}catch(_0x435352){}}function handleResult(_0x5a9f4f,_0x4e3f32){const _0x58a466=a4_0x32ff57;if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x21d))_0x5a9f4f[_0x58a466(0x1fc)][_0x58a466(0x201)]('üêç\x20Python\x20Pong');else{if(_0x4e3f32['type']===_0x58a466(0x1eb)){const {anomaly_score:_0x1fac27,is_anomaly:_0x56efe6,threshold:_0x36b401,explanation:_0x214657}=_0x4e3f32['payload'];_0x5a9f4f['setStateAsync']('analysis.security.lastScore',{'val':_0x1fac27,'ack':!![]}),_0x5a9f4f['setStateAsync']('analysis.security.lastCheck',{'val':new Date()[_0x58a466(0x1ec)](),'ack':!![]});if(_0x36b401)_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x216),{'val':_0x36b401,'ack':!![]});if(_0x56efe6){let _0x3ef21b='Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x1fac27[_0x58a466(0x20d)](0x4)+')';if(_0x214657&&_0x214657!==_0x58a466(0x205))_0x3ef21b+=_0x58a466(0x200)+_0x214657;_0x5a9f4f[_0x58a466(0x1de)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x5a9f4f[_0x58a466(0x1de)]('analysis.alertReason',{'val':_0x3ef21b,'ack':!![]}),setup[_0x58a466(0x1e8)](_0x5a9f4f,_0x58a466(0x212)+_0x3ef21b,![],!![]);}}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x223)){const _0x1241ff=_0x4e3f32[_0x58a466(0x1df)][_0x58a466(0x1fa)]||'',_0x5bd519=_0x4e3f32[_0x58a466(0x1df)][_0x58a466(0x219)],_0x354100=_0x4e3f32[_0x58a466(0x1df)][_0x58a466(0x1fb)]?_0x58a466(0x20f)+new Date()[_0x58a466(0x1e6)]()+'\x20('+_0x1241ff+')':_0x58a466(0x1f2)+_0x4e3f32[_0x58a466(0x1df)][_0x58a466(0x1e2)];_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x215),{'val':_0x354100,'ack':!![]});if(_0x4e3f32[_0x58a466(0x1df)][_0x58a466(0x1fb)]&&_0x5bd519)_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x216),{'val':_0x5bd519,'ack':!![]});}else{if(_0x4e3f32['type']===_0x58a466(0x1d8)){if(_0x4e3f32[_0x58a466(0x1df)][_0x58a466(0x1fb)])try{const _0x1b8a3e=JSON[_0x58a466(0x221)](_0x4e3f32[_0x58a466(0x1df)][_0x58a466(0x1fa)]);if(_0x1b8a3e[_0x58a466(0x1e4)])_0x5a9f4f[_0x58a466(0x1de)]('analysis.energy.insulationScore',{'val':JSON[_0x58a466(0x1d5)](_0x1b8a3e[_0x58a466(0x1e4)]),'ack':!![]});if(_0x1b8a3e[_0x58a466(0x1e5)])_0x5a9f4f['setStateAsync'](_0x58a466(0x220),{'val':JSON['stringify'](_0x1b8a3e[_0x58a466(0x1e5)]),'ack':!![]});}catch(_0x5c3562){}}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x1e9)){if(_0x4e3f32['payload'][_0x58a466(0x1fb)])_0x5a9f4f[_0x58a466(0x1fc)][_0x58a466(0x1dd)]('‚úÖ\x20HEALTH\x20TRAINED.');}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x21b))_0x5a9f4f['setStateAsync'](_0x58a466(0x1ee),{'val':new Date()['toISOString'](),'ack':!![]}),_0x5a9f4f['setStateAsync'](_0x58a466(0x229),{'val':_0x4e3f32[_0x58a466(0x1df)]['is_anomaly'],'ack':!![]});else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x1d7)){const {speed_trend:_0xa152e3}=_0x4e3f32['payload'];if(_0xa152e3!==undefined)_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x228),{'val':_0xa152e3,'ack':!![]});}else{if(_0x4e3f32[_0x58a466(0x21a)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x56b271}=_0x4e3f32[_0x58a466(0x1df)];if(_0x56b271)_0x5a9f4f['setStateAsync'](_0x58a466(0x1f0),{'val':JSON[_0x58a466(0x1d5)](_0x56b271),'ack':!![]});}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x203)){const {times:_0x28dd9d}=_0x4e3f32['payload'];if(_0x28dd9d)_0x5a9f4f[_0x58a466(0x1de)]('analysis.energy.warmupTimes',{'val':JSON[_0x58a466(0x1d5)](_0x28dd9d),'ack':!![]});}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x227)){const {forecast:_0x1ce7e4}=_0x4e3f32[_0x58a466(0x1df)];if(_0x1ce7e4)_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x21f),{'val':JSON[_0x58a466(0x1d5)](_0x1ce7e4),'ack':!![]});}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x1db)){const {alerts:_0x497765}=_0x4e3f32['payload'];if(_0x497765)_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x207),{'val':JSON[_0x58a466(0x1d5)](_0x497765),'ack':!![]});}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x1e3)){const {proposals:_0x50738c}=_0x4e3f32[_0x58a466(0x1df)];_0x5a9f4f['getState'](_0x58a466(0x208),(_0x568f7a,_0x55fc56)=>{const _0x4fa11b=_0x58a466;_0x55fc56&&_0x55fc56['val']===!![]&&_0x50738c&&_0x50738c[_0x4fa11b(0x222)]>0x0&&automation[_0x4fa11b(0x1ff)](_0x5a9f4f,_0x50738c);});}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x217)){const {room:_0x12b5a5,propagation:_0x1fa71f}=_0x4e3f32[_0x58a466(0x1df)];let _0x16a2eb='Unknown',_0x434597=0x0;if(_0x1fa71f){const _0x3737ef=Object['entries'](_0x1fa71f);_0x3737ef[_0x58a466(0x222)]>0x0&&(_0x16a2eb=_0x3737ef[0x0][0x0],_0x434597=_0x3737ef[0x0][0x1]);}_0x5a9f4f[_0x58a466(0x1de)]('analysis.prediction.nextRoom',{'val':_0x16a2eb,'ack':!![]}),_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x1ef),{'val':_0x434597,'ack':!![]}),automation['handlePrediction'](_0x5a9f4f,_0x16a2eb,_0x434597);}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x1e0)){const {probabilities:_0x409fc8}=_0x4e3f32[_0x58a466(0x1df)];if(_0x409fc8){_0x5a9f4f['setStateAsync'](_0x58a466(0x1d4),{'val':JSON['stringify'](_0x409fc8),'ack':!![]});const _0x5b6166=Object[_0x58a466(0x20a)](_0x409fc8);if(_0x5b6166[_0x58a466(0x222)]>0x0){const _0x58cfb=_0x5b6166[0x0],_0x1eef5f=_0x409fc8[_0x58cfb];_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x214),{'val':_0x58cfb,'ack':!![]}),_0x5a9f4f[_0x58a466(0x1de)](_0x58a466(0x1fd),{'val':_0x1eef5f,'ack':!![]});}}}else{if(_0x4e3f32[_0x58a466(0x21a)]===_0x58a466(0x1ea)){const {patterns:_0x3f4cde}=_0x4e3f32[_0x58a466(0x1df)];if(_0x3f4cde&&_0x3f4cde[_0x58a466(0x222)]>0x0)_0x5a9f4f['setStateAsync']('analysis.automation.detectedPatterns',{'val':JSON['stringify'](_0x3f4cde),'ack':!![]});}}}}}}}}}}}}}}}}function startService(_0x456e12,_0x4aabf5){const _0x4ea1b0=a4_0x32ff57;let _0x11e1c6=_0x4ea1b0(0x21c);if(fs[_0x4ea1b0(0x21e)](_0x4aabf5))_0x11e1c6=_0x4aabf5;try{const _0x109d48=path[_0x4ea1b0(0x1f9)](__dirname,'..',_0x4ea1b0(0x1fe),_0x4ea1b0(0x1d6));pythonProcess=spawn(_0x11e1c6,[_0x109d48]),pythonProcess[_0x4ea1b0(0x1dc)]['on'](_0x4ea1b0(0x1f7),_0xc1925e=>{const _0x470dac=_0x4ea1b0,_0x43ceeb=_0xc1925e[_0x470dac(0x1d2)]()['split']('\x0a');_0x43ceeb[_0x470dac(0x213)](_0x234d6d=>{const _0x5e3b02=_0x470dac,_0x110041=_0x234d6d['trim']();if(!_0x110041)return;if(_0x110041['startsWith']('[LOG]'))_0x456e12[_0x5e3b02(0x1fc)][_0x5e3b02(0x201)]('[PYTHON]\x20'+_0x110041[_0x5e3b02(0x1f1)](0x5)[_0x5e3b02(0x1f6)]());else{if(_0x110041[_0x5e3b02(0x211)](_0x5e3b02(0x209)))try{const _0x24021d=JSON['parse'](_0x110041[_0x5e3b02(0x1f1)](0x8)[_0x5e3b02(0x1f6)]());handleResult(_0x456e12,_0x24021d);}catch(_0x49e8ef){}}});}),pythonProcess['on'](_0x4ea1b0(0x1e7),_0x1f5119=>{pythonProcess=null;}),_0x456e12[_0x4ea1b0(0x225)]=(_0x3ecfad,_0x5ec471)=>send(_0x456e12,_0x3ecfad,_0x5ec471);}catch(_0x5509f4){_0x456e12[_0x4ea1b0(0x1fc)][_0x4ea1b0(0x218)](_0x4ea1b0(0x210)+_0x5509f4[_0x4ea1b0(0x1f4)]);}}function stopService(_0x5f27a4){const _0x325a7c=a4_0x32ff57;if(pythonProcess){try{pythonProcess[_0x325a7c(0x1f3)]();}catch(_0x4edc59){}pythonProcess=null;}}function a4_0x1055(){const _0x5bb0c9=['close','sendNotification','HEALTH_TRAIN_RESULT','COMFORT_RESULT','SECURITY_RESULT','toISOString','path','analysis.health.lastCheck','analysis.prediction.confidence','analysis.energy.forecast','substring','Failed:\x20','kill','message','451249zGrnbL','trim','data','94170EbdmGD','join','details','success','log','analysis.prediction.trackerConfidence','python_service','applyEnergySavings','\x0aGrund:\x20','debug','167044vByvih','WARMUP_RESULT','621680GvvmBS','Unknown','655779gxPKcw','analysis.energy.ventilationAlerts','analysis.energy.mpcActive','[RESULT]','keys','1806590IVskda','2473590YsPAmY','toFixed','(((.+)+)+)+$','Success:\x20','Error\x20launching\x20Python:\x20','startsWith','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','forEach','analysis.prediction.trackerTopRoom','analysis.training.status','analysis.security.currentThreshold','SIGNAL_RESULT','error','threshold','type','HEALTH_RESULT','python3','PONG','existsSync','analysis.energy.pinnForecast','analysis.energy.heatingScore','parse','length','TRAINING_COMPLETE','constructor','sendToPythonWrapper','write','PINN_PREDICT_RESULT','analysis.health.gaitSpeed','analysis.health.isAnomaly','toString','apply','analysis.prediction.trackerState','stringify','service.py','GAIT_RESULT','ENERGY_TRAIN_RESULT','2EvrsXl','search','VENTILATION_ALERT','stdout','info','setStateAsync','payload','TRACKER_RESULT','exports','reason','ENERGY_OPTIMIZE_RESULT','insulation','heating','toLocaleTimeString'];a4_0x1055=function(){return _0x5bb0c9;};return a4_0x1055();}module[a4_0x32ff57(0x1e1)]={'startService':startService,'stopService':stopService,'send':send};