const a4_0x1cef20=a4_0x5e50;(function(_0x367bf6,_0x4461cb){const _0x433f11=a4_0x5e50,_0x23fa64=_0x367bf6();while(!![]){try{const _0x63eac=parseInt(_0x433f11(0x18c))/0x1+-parseInt(_0x433f11(0x126))/0x2*(parseInt(_0x433f11(0x169))/0x3)+parseInt(_0x433f11(0x17b))/0x4*(-parseInt(_0x433f11(0x151))/0x5)+-parseInt(_0x433f11(0x124))/0x6+parseInt(_0x433f11(0x159))/0x7*(-parseInt(_0x433f11(0x156))/0x8)+-parseInt(_0x433f11(0x148))/0x9*(-parseInt(_0x433f11(0x133))/0xa)+parseInt(_0x433f11(0x176))/0xb*(parseInt(_0x433f11(0x128))/0xc);if(_0x63eac===_0x4461cb)break;else _0x23fa64['push'](_0x23fa64['shift']());}catch(_0x4a9f04){_0x23fa64['push'](_0x23fa64['shift']());}}}(a4_0x2d24,0xd3e0f));const a4_0x238896=(function(){let _0x202c06=!![];return function(_0x55d53e,_0x35b3d6){const _0x4d17ee=_0x202c06?function(){const _0x4e0acd=a4_0x5e50;if(_0x35b3d6){const _0x4245b0=_0x35b3d6[_0x4e0acd(0x16e)](_0x55d53e,arguments);return _0x35b3d6=null,_0x4245b0;}}:function(){};return _0x202c06=![],_0x4d17ee;};}()),a4_0xf58e3b=a4_0x238896(this,function(){const _0x31fdc8=a4_0x5e50;return a4_0xf58e3b[_0x31fdc8(0x163)]()[_0x31fdc8(0x17e)](_0x31fdc8(0x165))[_0x31fdc8(0x163)]()[_0x31fdc8(0x164)](a4_0xf58e3b)[_0x31fdc8(0x17e)](_0x31fdc8(0x165));});function a4_0x5e50(_0x19554c,_0x92e03a){const _0x2a2883=a4_0x2d24();return a4_0x5e50=function(_0xf58e3b,_0x238896){_0xf58e3b=_0xf58e3b-0x124;let _0x2d24d8=_0x2a2883[_0xf58e3b];return _0x2d24d8;},a4_0x5e50(_0x19554c,_0x92e03a);}a4_0xf58e3b();'use strict';function a4_0x2d24(){const _0x3f7189=['threshold','toLocaleTimeString','setStateAsync','apply','HEALTH_RESULT','SECURITY_RESULT','length','error','GAIT_RESULT','COMFORT_RESULT','analysis.security.topologyMatrix','156662mhKizw','analysis.training.status','\x20->\x20','analysis.energy.insulationScore','ðŸ\x20Python\x20Pong','72sVHHkm','confidence','TOPOLOGY_ACK','search','\x20->\x20Likely\x20','trim','analysis.health.gaitSpeed','debug','toFixed','Unknown','heating','analysis.health.lastCheck','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','success','write','ðŸ\x20Python\x20confirmed\x20new\x20topology.','analysis.health.isAnomaly','373777MMrdsP','existsSync','8445288wgBUjU','close','1584958egnODM','TRAINING_COMPLETE','3516kSjGfN','analysis.prediction.confidence','join','handlePrediction','ENERGY_PREDICT_RESULT','[PYTHON]\x20','[RESULT]','message','analysis.isAlert','kill','entries','90STsvNp','analysis.automation.detectedPatterns','analysis.security.lastCheck','analysis.prediction.nextRoom','analysis.security.lastScore','analysis.health.trendDiagnosis','details','TREND_RESULT','\x0aGrund:\x20','python_service','[LOG]','stdout','ðŸ”®\x20Prediction:\x20From\x20','sendNotification','analysis.automation.description','âš ï¸\x20SECURITY\x20ALARM:\x20','startsWith','substring','analysis.security.currentThreshold','is_anomaly','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','347211qANDYp','stringify','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','forEach','data','exports','analysis.automation.patternDetected','type','275195mZYRqx','log','analysis.energy.forecast','./automation','writable','72wRLypX','toISOString','Success:\x20','33313eEkbNK','analysis.alertReason','parse','insulation','./setup','SIGNAL_RESULT','âœ…\x20HEALTH\x20TRAINED.','python3','info','HEALTH_TRAIN_RESULT','toString','constructor','(((.+)+)+)+$','Regel\x20erkannt:\x20','sendToPythonWrapper','stdin','6eMimPl','payload'];a4_0x2d24=function(){return _0x3f7189;};return a4_0x2d24();}const {spawn}=require('child_process'),path=require('path'),fs=require('fs'),setup=require(a4_0x1cef20(0x15d)),automation=require(a4_0x1cef20(0x154));let pythonProcess=null;function send(_0x594580,_0x47ca82,_0xc548ef={}){const _0x3a7402=a4_0x1cef20;if(!pythonProcess||!pythonProcess[_0x3a7402(0x168)][_0x3a7402(0x155)])return;const _0x153667=JSON[_0x3a7402(0x149)]({'command':_0x47ca82,..._0xc548ef});try{pythonProcess[_0x3a7402(0x168)][_0x3a7402(0x189)](_0x153667+'\x0a');}catch(_0x2cdcde){}}function handleResult(_0x1fd20c,_0x22a908){const _0x2d9a0e=a4_0x1cef20;if(_0x22a908[_0x2d9a0e(0x150)]==='PONG')_0x1fd20c['log']['debug'](_0x2d9a0e(0x17a));else{if(_0x22a908[_0x2d9a0e(0x150)]===_0x2d9a0e(0x170)){const {anomaly_score:_0x2886cd,is_anomaly:_0x38e8c3,threshold:_0x282ed6,explanation:_0x385aeb}=_0x22a908[_0x2d9a0e(0x16a)];_0x1fd20c[_0x2d9a0e(0x152)][_0x2d9a0e(0x161)](_0x2d9a0e(0x187)+_0x2886cd[_0x2d9a0e(0x183)](0x5)+_0x2d9a0e(0x178)+(_0x38e8c3?'ANOMALY':'OK')),_0x1fd20c['setStateAsync'](_0x2d9a0e(0x137),{'val':_0x2886cd,'ack':!![]}),_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x135),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x282ed6)_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x145),{'val':_0x282ed6,'ack':!![]});if(_0x38e8c3){let _0x3f8fba=_0x2d9a0e(0x147)+_0x2886cd[_0x2d9a0e(0x183)](0x4)+')';if(_0x385aeb&&_0x385aeb!==_0x2d9a0e(0x184))_0x3f8fba+=_0x2d9a0e(0x13b)+_0x385aeb;_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x130),{'val':!![],'ack':!![]}),_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x15a),{'val':_0x3f8fba,'ack':!![]}),setup[_0x2d9a0e(0x140)](_0x1fd20c,_0x2d9a0e(0x142)+_0x3f8fba,![],!![]);}}else{if(_0x22a908['type']===_0x2d9a0e(0x127)){const _0x2019df=_0x22a908[_0x2d9a0e(0x16a)][_0x2d9a0e(0x139)]||'',_0x56cada=_0x22a908[_0x2d9a0e(0x16a)][_0x2d9a0e(0x16b)],_0x4eba04=_0x22a908[_0x2d9a0e(0x16a)][_0x2d9a0e(0x188)]?_0x2d9a0e(0x158)+new Date()[_0x2d9a0e(0x16c)]()+'\x20('+_0x2019df+')':'Failed:\x20'+_0x22a908['payload']['reason'];_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x177),{'val':_0x4eba04,'ack':!![]});if(_0x22a908[_0x2d9a0e(0x16a)][_0x2d9a0e(0x188)]&&_0x56cada)_0x1fd20c[_0x2d9a0e(0x16d)]('analysis.security.currentThreshold',{'val':_0x56cada,'ack':!![]});}else{if(_0x22a908[_0x2d9a0e(0x150)]===_0x2d9a0e(0x174)){const {patterns:_0x43966c}=_0x22a908['payload'];if(_0x43966c&&_0x43966c['length']>0x0){_0x1fd20c[_0x2d9a0e(0x152)]['info'](_0x2d9a0e(0x14a)+_0x43966c['length']+'\x20new\x20patterns.'),_0x1fd20c['setStateAsync'](_0x2d9a0e(0x134),{'val':JSON['stringify'](_0x43966c),'ack':!![]});const _0x459a0a=_0x43966c[0x0],_0x2468ab=_0x2d9a0e(0x166)+_0x459a0a['rule']+'\x20('+(_0x459a0a[_0x2d9a0e(0x17c)]*0x64)[_0x2d9a0e(0x183)](0x0)+'%)';_0x1fd20c[_0x2d9a0e(0x16d)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),_0x1fd20c['setStateAsync'](_0x2d9a0e(0x141),{'val':_0x2468ab,'ack':!![]});}else _0x1fd20c['log'][_0x2d9a0e(0x161)]('ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x14f),{'val':![],'ack':!![]}),_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x134),{'val':'[]','ack':!![]});}else{if(_0x22a908[_0x2d9a0e(0x150)]==='ENERGY_TRAIN_RESULT'){if(_0x22a908['payload'][_0x2d9a0e(0x188)])try{const _0x486b44=JSON[_0x2d9a0e(0x15b)](_0x22a908[_0x2d9a0e(0x16a)][_0x2d9a0e(0x139)]);if(_0x486b44[_0x2d9a0e(0x15c)])_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x179),{'val':JSON['stringify'](_0x486b44['insulation']),'ack':!![]});if(_0x486b44[_0x2d9a0e(0x185)])_0x1fd20c['setStateAsync']('analysis.energy.heatingScore',{'val':JSON[_0x2d9a0e(0x149)](_0x486b44[_0x2d9a0e(0x185)]),'ack':!![]});}catch(_0x4932da){}}else{if(_0x22a908[_0x2d9a0e(0x150)]===_0x2d9a0e(0x162)){if(_0x22a908[_0x2d9a0e(0x16a)][_0x2d9a0e(0x188)])_0x1fd20c['log'][_0x2d9a0e(0x161)](_0x2d9a0e(0x15f));}else{if(_0x22a908[_0x2d9a0e(0x150)]===_0x2d9a0e(0x16f))_0x1fd20c['setStateAsync'](_0x2d9a0e(0x186),{'val':new Date()[_0x2d9a0e(0x157)](),'ack':!![]}),_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x18b),{'val':_0x22a908[_0x2d9a0e(0x16a)][_0x2d9a0e(0x146)],'ack':!![]});else{if(_0x22a908[_0x2d9a0e(0x150)]===_0x2d9a0e(0x13a))_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x138),{'val':_0x22a908['payload']['diagnosis'],'ack':!![]}),_0x1fd20c[_0x2d9a0e(0x16d)]('analysis.health.trendValue',{'val':_0x22a908[_0x2d9a0e(0x16a)]['change_percent'],'ack':!![]});else{if(_0x22a908[_0x2d9a0e(0x150)]===_0x2d9a0e(0x173)){const {speed_trend:_0x5895ac}=_0x22a908[_0x2d9a0e(0x16a)];if(_0x5895ac!==undefined)_0x1fd20c['setStateAsync'](_0x2d9a0e(0x181),{'val':_0x5895ac,'ack':!![]});}else{if(_0x22a908[_0x2d9a0e(0x150)]===_0x2d9a0e(0x12c)){const {forecast:_0x1cbc25}=_0x22a908[_0x2d9a0e(0x16a)];if(_0x1cbc25)_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x153),{'val':JSON[_0x2d9a0e(0x149)](_0x1cbc25),'ack':!![]});}else{if(_0x22a908[_0x2d9a0e(0x150)]==='TOPOLOGY_RESULT'){const {data:_0x19217e}=_0x22a908[_0x2d9a0e(0x16a)];_0x19217e&&(_0x1fd20c['log'][_0x2d9a0e(0x161)](_0x2d9a0e(0x14b)),_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x175),{'val':JSON[_0x2d9a0e(0x149)](_0x19217e),'ack':!![]}));}else{if(_0x22a908[_0x2d9a0e(0x150)]===_0x2d9a0e(0x17d))_0x1fd20c[_0x2d9a0e(0x152)][_0x2d9a0e(0x182)](_0x2d9a0e(0x18a));else{if(_0x22a908['type']===_0x2d9a0e(0x15e)){const {room:_0x4e2586,propagation:_0x34196a}=_0x22a908['payload'];let _0x220162='Unknown',_0x4c83ae=0x0;if(_0x34196a){const _0x2736ef=Object[_0x2d9a0e(0x132)](_0x34196a);_0x2736ef[_0x2d9a0e(0x171)]>0x0&&(_0x220162=_0x2736ef[0x0][0x0],_0x4c83ae=_0x2736ef[0x0][0x1]);}_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x136),{'val':_0x220162,'ack':!![]}),_0x1fd20c[_0x2d9a0e(0x16d)](_0x2d9a0e(0x129),{'val':_0x4c83ae,'ack':!![]}),_0x4c83ae>0.4&&_0x1fd20c[_0x2d9a0e(0x152)]['debug'](_0x2d9a0e(0x13f)+_0x4e2586+_0x2d9a0e(0x17f)+_0x220162+'\x20('+(_0x4c83ae*0x64)['toFixed'](0x0)+'%)'),automation[_0x2d9a0e(0x12b)](_0x1fd20c,_0x220162,_0x4c83ae);}}}}}}}}}}}}}}function startService(_0x4dbcfb,_0x369673){const _0x19c697=a4_0x1cef20;let _0x1fd99c=_0x19c697(0x160);if(fs[_0x19c697(0x18d)](_0x369673))_0x1fd99c=_0x369673;try{const _0x55af3a=path[_0x19c697(0x12a)](__dirname,'..',_0x19c697(0x13c),'service.py');pythonProcess=spawn(_0x1fd99c,[_0x55af3a]),pythonProcess[_0x19c697(0x13e)]['on'](_0x19c697(0x14d),_0x3284fb=>{const _0x415c13=_0x19c697,_0x41cc96=_0x3284fb[_0x415c13(0x163)]()['split']('\x0a');_0x41cc96[_0x415c13(0x14c)](_0x10b92a=>{const _0x5c9240=_0x415c13,_0xb87890=_0x10b92a[_0x5c9240(0x180)]();if(!_0xb87890)return;if(_0xb87890['startsWith'](_0x5c9240(0x13d)))_0x4dbcfb['log'][_0x5c9240(0x182)](_0x5c9240(0x12d)+_0xb87890[_0x5c9240(0x144)](0x5)[_0x5c9240(0x180)]());else{if(_0xb87890[_0x5c9240(0x143)](_0x5c9240(0x12e)))try{const _0x308aa6=JSON[_0x5c9240(0x15b)](_0xb87890[_0x5c9240(0x144)](0x8)[_0x5c9240(0x180)]());handleResult(_0x4dbcfb,_0x308aa6);}catch(_0x3c8b7a){}}});}),pythonProcess['on'](_0x19c697(0x125),_0x517503=>{pythonProcess=null;}),_0x4dbcfb[_0x19c697(0x167)]=(_0x28dec4,_0x2d2a0e)=>send(_0x4dbcfb,_0x28dec4,_0x2d2a0e);}catch(_0x42054b){_0x4dbcfb[_0x19c697(0x152)][_0x19c697(0x172)]('Error\x20launching\x20Python:\x20'+_0x42054b[_0x19c697(0x12f)]);}}function stopService(_0x2505a0){const _0x1d457e=a4_0x1cef20;if(pythonProcess){try{pythonProcess[_0x1d457e(0x131)]();}catch(_0xafb220){}pythonProcess=null;}}module[a4_0x1cef20(0x14e)]={'startService':startService,'stopService':stopService,'send':send};