const a4_0xe757c4=a4_0x16f0;(function(_0x4032c7,_0x5194e0){const _0x3bb059=a4_0x16f0,_0x41bdfb=_0x4032c7();while(!![]){try{const _0x2a7b94=parseInt(_0x3bb059(0x8c))/0x1*(-parseInt(_0x3bb059(0x8a))/0x2)+-parseInt(_0x3bb059(0xd7))/0x3+-parseInt(_0x3bb059(0x7b))/0x4*(parseInt(_0x3bb059(0xa9))/0x5)+parseInt(_0x3bb059(0xc6))/0x6+parseInt(_0x3bb059(0xa2))/0x7*(parseInt(_0x3bb059(0xab))/0x8)+parseInt(_0x3bb059(0x99))/0x9*(-parseInt(_0x3bb059(0xbd))/0xa)+-parseInt(_0x3bb059(0x76))/0xb*(-parseInt(_0x3bb059(0xbe))/0xc);if(_0x2a7b94===_0x5194e0)break;else _0x41bdfb['push'](_0x41bdfb['shift']());}catch(_0x31c521){_0x41bdfb['push'](_0x41bdfb['shift']());}}}(a4_0x1246,0xca877));const a4_0x585b5a=(function(){let _0x29947a=!![];return function(_0x2c8226,_0x2f4d90){const _0x1888b6=_0x29947a?function(){const _0x1b73e6=a4_0x16f0;if(_0x2f4d90){const _0x423e13=_0x2f4d90[_0x1b73e6(0xb4)](_0x2c8226,arguments);return _0x2f4d90=null,_0x423e13;}}:function(){};return _0x29947a=![],_0x1888b6;};}()),a4_0x1bd52d=a4_0x585b5a(this,function(){const _0x44baef=a4_0x16f0;return a4_0x1bd52d[_0x44baef(0xd5)]()[_0x44baef(0x7c)](_0x44baef(0xb6))[_0x44baef(0xd5)]()[_0x44baef(0xd9)](a4_0x1bd52d)[_0x44baef(0x7c)](_0x44baef(0xb6));});a4_0x1bd52d();'use strict';const {spawn}=require(a4_0xe757c4(0xae)),path=require(a4_0xe757c4(0xba)),fs=require('fs'),setup=require(a4_0xe757c4(0x95)),automation=require('./automation');function a4_0x1246(){const _0x69ec62=['diagnosis','analysis.energy.heatingScore','debug','5080458LxUMyb','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','heating','trim','insulation','analysis.security.lastScore','python3','is_anomaly','handlePrediction','writable','Failed:\x20','python_service','[PYTHON]\x20','length','ðŸ”®\x20Prediction:\x20From\x20','toString','type','650751IYInVA','analysis.health.trendDiagnosis','constructor','SECURITY_RESULT','analysis.alertReason','383735NtBKDm','analysis.energy.insulationScore','ANOMALY','data','entries','1553932hyvzAt','search','GAIT_RESULT','existsSync','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','payload','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','reason','kill','analysis.security.lastCheck','analysis.automation.detectedPatterns','Regel\x20erkannt:\x20','sendNotification','PONG','analysis.prediction.confidence','2jDvGOA','analysis.automation.patternDetected','294659jFikUu','SIGNAL_RESULT','success','parse','confidence','change_percent','analysis.automation.description','toISOString','\x20->\x20','./setup','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','message','info','9xyzShz','join','analysis.security.currentThreshold','ðŸ\x20Python\x20confirmed\x20new\x20topology.','substring','analysis.health.gaitSpeed','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','split','ENERGY_TRAIN_RESULT','660709FgWFWH','Error\x20launching\x20Python:\x20','forEach','threshold','analysis.health.lastCheck','startsWith','analysis.training.status','20MpLCDN','write','72jSrTTt','\x20->\x20Likely\x20','âš ï¸\x20SECURITY\x20ALARM:\x20','child_process','analysis.health.isAnomaly','TOPOLOGY_RESULT','log','rule','sendToPythonWrapper','apply','ENERGY_PREDICT_RESULT','(((.+)+)+)+$','\x20new\x20patterns.','âœ…\x20HEALTH\x20TRAINED.','stdin','path','setStateAsync','stringify','4058690MwSlAf','552xzDrtA','service.py','details','[RESULT]','toFixed'];a4_0x1246=function(){return _0x69ec62;};return a4_0x1246();}let pythonProcess=null;function send(_0x126151,_0x2a4497,_0x2224bb={}){const _0x41d885=a4_0xe757c4;if(!pythonProcess||!pythonProcess[_0x41d885(0xb9)][_0x41d885(0xcf)])return;const _0x1344c0=JSON['stringify']({'command':_0x2a4497,..._0x2224bb});try{pythonProcess[_0x41d885(0xb9)][_0x41d885(0xaa)](_0x1344c0+'\x0a');}catch(_0x580b24){}}function handleResult(_0x2a80a8,_0x19bb09){const _0x5559bf=a4_0xe757c4;if(_0x19bb09[_0x5559bf(0xd6)]===_0x5559bf(0x88))_0x2a80a8['log'][_0x5559bf(0xc5)]('ðŸ\x20Python\x20Pong');else{if(_0x19bb09['type']===_0x5559bf(0x74)){const {anomaly_score:_0x35873b,is_anomaly:_0xbc1de9,threshold:_0x1265f9,explanation:_0x4c3b75}=_0x19bb09['payload'];_0x2a80a8['log'][_0x5559bf(0x98)](_0x5559bf(0x96)+_0x35873b[_0x5559bf(0xc2)](0x5)+_0x5559bf(0x94)+(_0xbc1de9?_0x5559bf(0x78):'OK')),_0x2a80a8['setStateAsync'](_0x5559bf(0xcb),{'val':_0x35873b,'ack':!![]}),_0x2a80a8['setStateAsync'](_0x5559bf(0x84),{'val':new Date()[_0x5559bf(0x93)](),'ack':!![]});if(_0x1265f9)_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x9b),{'val':_0x1265f9,'ack':!![]});if(_0xbc1de9){let _0x3f3e2c=_0x5559bf(0xc7)+_0x35873b['toFixed'](0x4)+')';if(_0x4c3b75&&_0x4c3b75!=='Unknown')_0x3f3e2c+='\x0aGrund:\x20'+_0x4c3b75;_0x2a80a8['setStateAsync']('analysis.isAlert',{'val':!![],'ack':!![]}),_0x2a80a8['setStateAsync'](_0x5559bf(0x75),{'val':_0x3f3e2c,'ack':!![]}),setup[_0x5559bf(0x87)](_0x2a80a8,_0x5559bf(0xad)+_0x3f3e2c,![],!![]);}}else{if(_0x19bb09[_0x5559bf(0xd6)]==='TRAINING_COMPLETE'){const _0x393d90=_0x19bb09[_0x5559bf(0x80)][_0x5559bf(0xc0)]||'',_0x81ad18=_0x19bb09['payload'][_0x5559bf(0xa5)],_0x8bf664=_0x19bb09[_0x5559bf(0x80)][_0x5559bf(0x8e)]?'Success:\x20'+new Date()['toLocaleTimeString']()+'\x20('+_0x393d90+')':_0x5559bf(0xd0)+_0x19bb09['payload'][_0x5559bf(0x82)];_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0xa8),{'val':_0x8bf664,'ack':!![]});if(_0x19bb09[_0x5559bf(0x80)][_0x5559bf(0x8e)]&&_0x81ad18)_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x9b),{'val':_0x81ad18,'ack':!![]});}else{if(_0x19bb09['type']==='COMFORT_RESULT'){const {patterns:_0x244ca5}=_0x19bb09['payload'];if(_0x244ca5&&_0x244ca5[_0x5559bf(0xd3)]>0x0){_0x2a80a8['log'][_0x5559bf(0x98)](_0x5559bf(0x7f)+_0x244ca5[_0x5559bf(0xd3)]+_0x5559bf(0xb7)),_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x85),{'val':JSON[_0x5559bf(0xbc)](_0x244ca5),'ack':!![]});const _0x321941=_0x244ca5[0x0],_0x406a6d=_0x5559bf(0x86)+_0x321941[_0x5559bf(0xb2)]+'\x20('+(_0x321941[_0x5559bf(0x90)]*0x64)[_0x5559bf(0xc2)](0x0)+'%)';_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x8b),{'val':!![],'ack':!![]}),_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x92),{'val':_0x406a6d,'ack':!![]});}else _0x2a80a8[_0x5559bf(0xb1)][_0x5559bf(0x98)](_0x5559bf(0x81)),_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x8b),{'val':![],'ack':!![]}),_0x2a80a8['setStateAsync'](_0x5559bf(0x85),{'val':'[]','ack':!![]});}else{if(_0x19bb09['type']===_0x5559bf(0xa1)){if(_0x19bb09[_0x5559bf(0x80)]['success'])try{const _0x45336f=JSON[_0x5559bf(0x8f)](_0x19bb09[_0x5559bf(0x80)][_0x5559bf(0xc0)]);if(_0x45336f[_0x5559bf(0xca)])_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x77),{'val':JSON['stringify'](_0x45336f[_0x5559bf(0xca)]),'ack':!![]});if(_0x45336f[_0x5559bf(0xc8)])_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0xc4),{'val':JSON['stringify'](_0x45336f[_0x5559bf(0xc8)]),'ack':!![]});}catch(_0x554bb8){}}else{if(_0x19bb09[_0x5559bf(0xd6)]==='HEALTH_TRAIN_RESULT'){if(_0x19bb09[_0x5559bf(0x80)][_0x5559bf(0x8e)])_0x2a80a8['log'][_0x5559bf(0x98)](_0x5559bf(0xb8));}else{if(_0x19bb09[_0x5559bf(0xd6)]==='HEALTH_RESULT')_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0xa6),{'val':new Date()[_0x5559bf(0x93)](),'ack':!![]}),_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0xaf),{'val':_0x19bb09[_0x5559bf(0x80)][_0x5559bf(0xcd)],'ack':!![]});else{if(_0x19bb09['type']==='TREND_RESULT')_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0xd8),{'val':_0x19bb09['payload'][_0x5559bf(0xc3)],'ack':!![]}),_0x2a80a8[_0x5559bf(0xbb)]('analysis.health.trendValue',{'val':_0x19bb09['payload'][_0x5559bf(0x91)],'ack':!![]});else{if(_0x19bb09['type']===_0x5559bf(0x7d)){const {speed_trend:_0x140f87}=_0x19bb09[_0x5559bf(0x80)];if(_0x140f87!==undefined)_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x9e),{'val':_0x140f87,'ack':!![]});}else{if(_0x19bb09[_0x5559bf(0xd6)]===_0x5559bf(0xb5)){const {forecast:_0x309612}=_0x19bb09[_0x5559bf(0x80)];if(_0x309612)_0x2a80a8[_0x5559bf(0xbb)]('analysis.energy.forecast',{'val':JSON[_0x5559bf(0xbc)](_0x309612),'ack':!![]});}else{if(_0x19bb09[_0x5559bf(0xd6)]===_0x5559bf(0xb0)){const {data:_0x14513a}=_0x19bb09['payload'];_0x14513a&&(_0x2a80a8[_0x5559bf(0xb1)][_0x5559bf(0x98)](_0x5559bf(0x9f)),_0x2a80a8[_0x5559bf(0xbb)]('analysis.security.topologyMatrix',{'val':JSON[_0x5559bf(0xbc)](_0x14513a),'ack':!![]}));}else{if(_0x19bb09['type']==='TOPOLOGY_ACK')_0x2a80a8[_0x5559bf(0xb1)][_0x5559bf(0xc5)](_0x5559bf(0x9c));else{if(_0x19bb09[_0x5559bf(0xd6)]===_0x5559bf(0x8d)){const {room:_0x4529e7,propagation:_0x424905}=_0x19bb09[_0x5559bf(0x80)];let _0x3dabdc='Unknown',_0x4fb018=0x0;if(_0x424905){const _0x10f15b=Object[_0x5559bf(0x7a)](_0x424905);_0x10f15b[_0x5559bf(0xd3)]>0x0&&(_0x3dabdc=_0x10f15b[0x0][0x0],_0x4fb018=_0x10f15b[0x0][0x1]);}_0x2a80a8[_0x5559bf(0xbb)]('analysis.prediction.nextRoom',{'val':_0x3dabdc,'ack':!![]}),_0x2a80a8[_0x5559bf(0xbb)](_0x5559bf(0x89),{'val':_0x4fb018,'ack':!![]}),_0x4fb018>0.4&&_0x2a80a8['log'][_0x5559bf(0xc5)](_0x5559bf(0xd4)+_0x4529e7+_0x5559bf(0xac)+_0x3dabdc+'\x20('+(_0x4fb018*0x64)[_0x5559bf(0xc2)](0x0)+'%)'),automation[_0x5559bf(0xce)](_0x2a80a8,_0x3dabdc,_0x4fb018);}}}}}}}}}}}}}}function startService(_0x1dcb3c,_0x17513a){const _0x325ce7=a4_0xe757c4;let _0x47fd4e=_0x325ce7(0xcc);if(fs[_0x325ce7(0x7e)](_0x17513a))_0x47fd4e=_0x17513a;try{const _0x698dd7=path[_0x325ce7(0x9a)](__dirname,'..',_0x325ce7(0xd1),_0x325ce7(0xbf));pythonProcess=spawn(_0x47fd4e,[_0x698dd7]),pythonProcess['stdout']['on'](_0x325ce7(0x79),_0x2d45bd=>{const _0x44626d=_0x325ce7,_0x280b68=_0x2d45bd[_0x44626d(0xd5)]()[_0x44626d(0xa0)]('\x0a');_0x280b68[_0x44626d(0xa4)](_0x49eabb=>{const _0x59e61e=_0x44626d,_0x498b94=_0x49eabb[_0x59e61e(0xc9)]();if(!_0x498b94)return;if(_0x498b94['startsWith']('[LOG]'))_0x1dcb3c['log'][_0x59e61e(0xc5)](_0x59e61e(0xd2)+_0x498b94[_0x59e61e(0x9d)](0x5)[_0x59e61e(0xc9)]());else{if(_0x498b94[_0x59e61e(0xa7)](_0x59e61e(0xc1)))try{const _0x506d13=JSON['parse'](_0x498b94[_0x59e61e(0x9d)](0x8)[_0x59e61e(0xc9)]());handleResult(_0x1dcb3c,_0x506d13);}catch(_0x541d2a){}}});}),pythonProcess['on']('close',_0x4e318d=>{pythonProcess=null;}),_0x1dcb3c[_0x325ce7(0xb3)]=(_0x31853b,_0x5ba64b)=>send(_0x1dcb3c,_0x31853b,_0x5ba64b);}catch(_0x504071){_0x1dcb3c['log']['error'](_0x325ce7(0xa3)+_0x504071[_0x325ce7(0x97)]);}}function a4_0x16f0(_0x1bd1a1,_0x3a997c){const _0x52b042=a4_0x1246();return a4_0x16f0=function(_0x1bd52d,_0x585b5a){_0x1bd52d=_0x1bd52d-0x74;let _0x124601=_0x52b042[_0x1bd52d];return _0x124601;},a4_0x16f0(_0x1bd1a1,_0x3a997c);}function stopService(_0x2b4658){const _0x2b8e18=a4_0xe757c4;if(pythonProcess){try{pythonProcess[_0x2b8e18(0x83)]();}catch(_0xe0938f){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};