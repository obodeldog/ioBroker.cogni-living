const a4_0xcb7daf=a4_0x54b8;function a4_0x54b8(_0x2c019b,_0x3687e6){const _0x3c3972=a4_0x389b();return a4_0x54b8=function(_0x5df5cf,_0x54d14d){_0x5df5cf=_0x5df5cf-0xc8;let _0x389b14=_0x3c3972[_0x5df5cf];return _0x389b14;},a4_0x54b8(_0x2c019b,_0x3687e6);}function a4_0x389b(){const _0x45f37c=['substring','python_service','search','PINN_PREDICT_RESULT','reason','setStateAsync','is_anomaly','analysis.energy.mpcActive','type','ðŸ\x20Python\x20Pong','250rFUSol','stdin','TRAINING_COMPLETE','error','ENERGY_TRAIN_RESULT','data','(((.+)+)+)+$','HEALTH_RESULT','path','analysis.energy.forecast','analysis.security.lastScore','stdout','sendToPythonWrapper','join','analysis.isAlert','constructor','ENERGY_PREDICT_RESULT','776690RkwmcV','applyEnergySavings','getState','Failed:\x20','toLocaleTimeString','writable','31468382WPQWyk','HEALTH_TRAIN_RESULT','analysis.prediction.confidence','analysis.prediction.nextRoom','156195BaaqGj','insulation','stringify','1162235bWRBGX','./setup','toISOString','9wWetJN','8DYSYqz','service.py','split','trim','apply','analysis.health.isAnomaly','payload','analysis.health.gaitSpeed','entries','val','length','write','analysis.training.status','711340HvqnmQ','444165xCFOcu','message','3608906aHaMPr','Success:\x20','forEach','toString','analysis.energy.insulationScore','toFixed','log','threshold','debug','kill','6XllikD','Error\x20launching\x20Python:\x20','analysis.automation.detectedPatterns','existsSync','success','info','./automation','[LOG]','analysis.health.lastCheck','Unknown','parse','startsWith'];a4_0x389b=function(){return _0x45f37c;};return a4_0x389b();}(function(_0x186d57,_0x384acd){const _0x3b08be=a4_0x54b8,_0xb08593=_0x186d57();while(!![]){try{const _0x4e139d=-parseInt(_0x3b08be(0xdd))/0x1+-parseInt(_0x3b08be(0x110))/0x2+parseInt(_0x3b08be(0xce))/0x3*(-parseInt(_0x3b08be(0xdc))/0x4)+parseInt(_0x3b08be(0xcb))/0x5*(-parseInt(_0x3b08be(0xe9))/0x6)+parseInt(_0x3b08be(0xdf))/0x7*(-parseInt(_0x3b08be(0xcf))/0x8)+-parseInt(_0x3b08be(0xc8))/0x9*(parseInt(_0x3b08be(0xff))/0xa)+parseInt(_0x3b08be(0x116))/0xb;if(_0x4e139d===_0x384acd)break;else _0xb08593['push'](_0xb08593['shift']());}catch(_0x579eb5){_0xb08593['push'](_0xb08593['shift']());}}}(a4_0x389b,0x4c623));const a4_0x54d14d=(function(){let _0x1a4984=!![];return function(_0x40375b,_0x60d686){const _0x13dc33=_0x1a4984?function(){const _0x1eac96=a4_0x54b8;if(_0x60d686){const _0x13d848=_0x60d686[_0x1eac96(0xd3)](_0x40375b,arguments);return _0x60d686=null,_0x13d848;}}:function(){};return _0x1a4984=![],_0x13dc33;};}()),a4_0x5df5cf=a4_0x54d14d(this,function(){const _0xd0e257=a4_0x54b8;return a4_0x5df5cf[_0xd0e257(0xe2)]()[_0xd0e257(0xf7)](_0xd0e257(0x105))[_0xd0e257(0xe2)]()[_0xd0e257(0x10e)](a4_0x5df5cf)[_0xd0e257(0xf7)](_0xd0e257(0x105));});a4_0x5df5cf();'use strict';const {spawn}=require('child_process'),path=require(a4_0xcb7daf(0x107)),fs=require('fs'),setup=require(a4_0xcb7daf(0xcc)),automation=require(a4_0xcb7daf(0xef));let pythonProcess=null;function send(_0x3a823a,_0xc18206,_0x2e0b87={}){const _0x5f1a5b=a4_0xcb7daf;if(!pythonProcess||!pythonProcess[_0x5f1a5b(0x100)][_0x5f1a5b(0x115)])return;const _0x3e551f=JSON['stringify']({'command':_0xc18206,..._0x2e0b87});try{pythonProcess[_0x5f1a5b(0x100)][_0x5f1a5b(0xda)](_0x3e551f+'\x0a');}catch(_0xb887fc){}}function handleResult(_0x4b8988,_0x5a2eca){const _0x28101a=a4_0xcb7daf;if(_0x5a2eca[_0x28101a(0xfd)]==='PONG')_0x4b8988['log']['debug'](_0x28101a(0xfe));else{if(_0x5a2eca[_0x28101a(0xfd)]==='SECURITY_RESULT'){const {anomaly_score:_0x3eced2,is_anomaly:_0x121abb,threshold:_0x380dda,explanation:_0x3f78b0}=_0x5a2eca[_0x28101a(0xd5)];_0x4b8988[_0x28101a(0xfa)](_0x28101a(0x109),{'val':_0x3eced2,'ack':!![]}),_0x4b8988[_0x28101a(0xfa)]('analysis.security.lastCheck',{'val':new Date()[_0x28101a(0xcd)](),'ack':!![]});if(_0x380dda)_0x4b8988[_0x28101a(0xfa)]('analysis.security.currentThreshold',{'val':_0x380dda,'ack':!![]});if(_0x121abb){let _0x410ebd='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x3eced2[_0x28101a(0xe4)](0x4)+')';if(_0x3f78b0&&_0x3f78b0!==_0x28101a(0xf2))_0x410ebd+='\x0aGrund:\x20'+_0x3f78b0;_0x4b8988[_0x28101a(0xfa)](_0x28101a(0x10d),{'val':!![],'ack':!![]}),_0x4b8988[_0x28101a(0xfa)]('analysis.alertReason',{'val':_0x410ebd,'ack':!![]}),setup['sendNotification'](_0x4b8988,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x410ebd,![],!![]);}}else{if(_0x5a2eca[_0x28101a(0xfd)]===_0x28101a(0x101)){const _0x22690c=_0x5a2eca[_0x28101a(0xd5)]['details']||'',_0x4e70a9=_0x5a2eca[_0x28101a(0xd5)][_0x28101a(0xe6)],_0x1899a8=_0x5a2eca[_0x28101a(0xd5)][_0x28101a(0xed)]?_0x28101a(0xe0)+new Date()[_0x28101a(0x114)]()+'\x20('+_0x22690c+')':_0x28101a(0x113)+_0x5a2eca[_0x28101a(0xd5)][_0x28101a(0xf9)];_0x4b8988[_0x28101a(0xfa)](_0x28101a(0xdb),{'val':_0x1899a8,'ack':!![]});if(_0x5a2eca[_0x28101a(0xd5)][_0x28101a(0xed)]&&_0x4e70a9)_0x4b8988[_0x28101a(0xfa)]('analysis.security.currentThreshold',{'val':_0x4e70a9,'ack':!![]});}else{if(_0x5a2eca['type']===_0x28101a(0x103)){if(_0x5a2eca[_0x28101a(0xd5)][_0x28101a(0xed)])try{const _0x518a8c=JSON[_0x28101a(0xf3)](_0x5a2eca['payload']['details']);if(_0x518a8c[_0x28101a(0xc9)])_0x4b8988[_0x28101a(0xfa)](_0x28101a(0xe3),{'val':JSON[_0x28101a(0xca)](_0x518a8c['insulation']),'ack':!![]});if(_0x518a8c['heating'])_0x4b8988['setStateAsync']('analysis.energy.heatingScore',{'val':JSON[_0x28101a(0xca)](_0x518a8c['heating']),'ack':!![]});}catch(_0x4bd447){}}else{if(_0x5a2eca[_0x28101a(0xfd)]===_0x28101a(0x117)){if(_0x5a2eca[_0x28101a(0xd5)]['success'])_0x4b8988['log'][_0x28101a(0xee)]('âœ…\x20HEALTH\x20TRAINED.');}else{if(_0x5a2eca[_0x28101a(0xfd)]===_0x28101a(0x106))_0x4b8988['setStateAsync'](_0x28101a(0xf1),{'val':new Date()['toISOString'](),'ack':!![]}),_0x4b8988[_0x28101a(0xfa)](_0x28101a(0xd4),{'val':_0x5a2eca[_0x28101a(0xd5)][_0x28101a(0xfb)],'ack':!![]});else{if(_0x5a2eca[_0x28101a(0xfd)]==='GAIT_RESULT'){const {speed_trend:_0x1cfa7d}=_0x5a2eca[_0x28101a(0xd5)];if(_0x1cfa7d!==undefined)_0x4b8988[_0x28101a(0xfa)](_0x28101a(0xd6),{'val':_0x1cfa7d,'ack':!![]});}else{if(_0x5a2eca['type']===_0x28101a(0x10f)){const {forecast:_0x59e448}=_0x5a2eca[_0x28101a(0xd5)];if(_0x59e448)_0x4b8988[_0x28101a(0xfa)](_0x28101a(0x108),{'val':JSON[_0x28101a(0xca)](_0x59e448),'ack':!![]});}else{if(_0x5a2eca['type']===_0x28101a(0xf8)){const {forecast:_0x241380}=_0x5a2eca[_0x28101a(0xd5)];if(_0x241380)_0x4b8988[_0x28101a(0xfa)]('analysis.energy.pinnForecast',{'val':JSON['stringify'](_0x241380),'ack':!![]});}else{if(_0x5a2eca[_0x28101a(0xfd)]==='ENERGY_OPTIMIZE_RESULT'){const {proposals:_0x53ab8a}=_0x5a2eca[_0x28101a(0xd5)];_0x4b8988[_0x28101a(0x112)](_0x28101a(0xfc),(_0xc49cc,_0x4794a7)=>{const _0x2daef1=_0x28101a;_0x4794a7&&_0x4794a7[_0x2daef1(0xd8)]===!![]&&_0x53ab8a&&_0x53ab8a[_0x2daef1(0xd9)]>0x0&&automation[_0x2daef1(0x111)](_0x4b8988,_0x53ab8a);});}else{if(_0x5a2eca[_0x28101a(0xfd)]==='SIGNAL_RESULT'){const {room:_0x64dc93,propagation:_0x428e36}=_0x5a2eca['payload'];let _0x5b7336=_0x28101a(0xf2),_0xe1a125=0x0;if(_0x428e36){const _0x2f51e6=Object[_0x28101a(0xd7)](_0x428e36);_0x2f51e6[_0x28101a(0xd9)]>0x0&&(_0x5b7336=_0x2f51e6[0x0][0x0],_0xe1a125=_0x2f51e6[0x0][0x1]);}_0x4b8988['setStateAsync'](_0x28101a(0x119),{'val':_0x5b7336,'ack':!![]}),_0x4b8988[_0x28101a(0xfa)](_0x28101a(0x118),{'val':_0xe1a125,'ack':!![]}),automation['handlePrediction'](_0x4b8988,_0x5b7336,_0xe1a125);}else{if(_0x5a2eca[_0x28101a(0xfd)]==='COMFORT_RESULT'){const {patterns:_0x50f945}=_0x5a2eca[_0x28101a(0xd5)];if(_0x50f945&&_0x50f945[_0x28101a(0xd9)]>0x0)_0x4b8988[_0x28101a(0xfa)](_0x28101a(0xeb),{'val':JSON[_0x28101a(0xca)](_0x50f945),'ack':!![]});}}}}}}}}}}}}}function startService(_0x14d6aa,_0x4b298e){const _0x4afc9b=a4_0xcb7daf;let _0xb21039='python3';if(fs[_0x4afc9b(0xec)](_0x4b298e))_0xb21039=_0x4b298e;try{const _0x49453a=path[_0x4afc9b(0x10c)](__dirname,'..',_0x4afc9b(0xf6),_0x4afc9b(0xd0));pythonProcess=spawn(_0xb21039,[_0x49453a]),pythonProcess[_0x4afc9b(0x10a)]['on'](_0x4afc9b(0x104),_0x5511b9=>{const _0x4170b5=_0x4afc9b,_0x17285a=_0x5511b9[_0x4170b5(0xe2)]()[_0x4170b5(0xd1)]('\x0a');_0x17285a[_0x4170b5(0xe1)](_0x51bce0=>{const _0xad3049=_0x4170b5,_0x4fb6b4=_0x51bce0[_0xad3049(0xd2)]();if(!_0x4fb6b4)return;if(_0x4fb6b4[_0xad3049(0xf4)](_0xad3049(0xf0)))_0x14d6aa['log'][_0xad3049(0xe7)]('[PYTHON]\x20'+_0x4fb6b4[_0xad3049(0xf5)](0x5)[_0xad3049(0xd2)]());else{if(_0x4fb6b4['startsWith']('[RESULT]'))try{const _0x23e43c=JSON[_0xad3049(0xf3)](_0x4fb6b4['substring'](0x8)[_0xad3049(0xd2)]());handleResult(_0x14d6aa,_0x23e43c);}catch(_0x39d108){}}});}),pythonProcess['on']('close',_0x52d848=>{pythonProcess=null;}),_0x14d6aa[_0x4afc9b(0x10b)]=(_0xe7f6fc,_0x8625ee)=>send(_0x14d6aa,_0xe7f6fc,_0x8625ee);}catch(_0x501aa8){_0x14d6aa[_0x4afc9b(0xe5)][_0x4afc9b(0x102)](_0x4afc9b(0xea)+_0x501aa8[_0x4afc9b(0xde)]);}}function stopService(_0x1e69d7){const _0x568e4f=a4_0xcb7daf;if(pythonProcess){try{pythonProcess[_0x568e4f(0xe8)]();}catch(_0xc799da){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};