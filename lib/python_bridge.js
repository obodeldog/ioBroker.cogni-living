const a4_0x36afd6=a4_0xb2e7;function a4_0x4373(){const _0x4a63b3=['1461704KcVAAU','./automation','analysis.energy.heatingScore','TOPOLOGY_ACK','ðŸ”®\x20Prediction:\x20From\x20','info','Success:\x20','split','toString','toFixed','heating','handlePrediction','message','insulation','length','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','analysis.security.currentThreshold','python_service','is_anomaly','analysis.health.isAnomaly','Regel\x20erkannt:\x20','Unknown','search','COMFORT_RESULT','parse','TRAINING_COMPLETE','(((.+)+)+)+$','681021giKPFr','analysis.automation.detectedPatterns','rule','service.py','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','45hzbCBR','SECURITY_RESULT','GAIT_RESULT','Failed:\x20','1918815UtixEa','analysis.prediction.nextRoom','path','analysis.automation.description','join','exports','2oDbzAu','\x20new\x20patterns.','toLocaleTimeString','stdout','âœ…\x20HEALTH\x20TRAINED.','HEALTH_TRAIN_RESULT','[RESULT]','689790laQXoe','payload','write','ðŸ\x20Python\x20Pong','analysis.security.lastCheck','SIGNAL_RESULT','setStateAsync','[PYTHON]\x20','TREND_RESULT','TOPOLOGY_RESULT','\x20->\x20Likely\x20','sendNotification','apply','Error\x20launching\x20Python:\x20','âš ï¸\x20SECURITY\x20ALARM:\x20','analysis.security.topologyMatrix','sendToPythonWrapper','change_percent','error','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','stringify','toISOString','startsWith','5752115iRanlx','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','diagnosis','14329367ZFMsJe','data','log','substring','14aAUsQb','12qzpjMG','type','success','child_process','details','[LOG]','debug','analysis.automation.patternDetected','entries','analysis.prediction.confidence','constructor','analysis.health.trendDiagnosis','288530BOUFGS','close','forEach','reason','trim','analysis.energy.insulationScore','70ZdtuMw','4FmqJZL'];a4_0x4373=function(){return _0x4a63b3;};return a4_0x4373();}(function(_0x3b5033,_0x31cf6f){const _0x20c9aa=a4_0xb2e7,_0x2f935f=_0x3b5033();while(!![]){try{const _0x14781f=-parseInt(_0x20c9aa(0xb8))/0x1+parseInt(_0x20c9aa(0xea))/0x2*(-parseInt(_0x20c9aa(0xe4))/0x3)+parseInt(_0x20c9aa(0xbf))/0x4*(parseInt(_0x20c9aa(0x108))/0x5)+parseInt(_0x20c9aa(0xf1))/0x6*(-parseInt(_0x20c9aa(0xab))/0x7)+-parseInt(_0x20c9aa(0xc0))/0x8*(parseInt(_0x20c9aa(0xe0))/0x9)+parseInt(_0x20c9aa(0xbe))/0xa*(parseInt(_0x20c9aa(0xdb))/0xb)+parseInt(_0x20c9aa(0xac))/0xc*(parseInt(_0x20c9aa(0xa7))/0xd);if(_0x14781f===_0x31cf6f)break;else _0x2f935f['push'](_0x2f935f['shift']());}catch(_0x32998b){_0x2f935f['push'](_0x2f935f['shift']());}}}(a4_0x4373,0x9601d));const a4_0x1cb76e=(function(){let _0x1e873d=!![];return function(_0x3d4024,_0x4cb896){const _0x16f206=_0x1e873d?function(){const _0x1f2f55=a4_0xb2e7;if(_0x4cb896){const _0x27451e=_0x4cb896[_0x1f2f55(0xfd)](_0x3d4024,arguments);return _0x4cb896=null,_0x27451e;}}:function(){};return _0x1e873d=![],_0x16f206;};}()),a4_0x47e86e=a4_0x1cb76e(this,function(){const _0x5d112b=a4_0xb2e7;return a4_0x47e86e[_0x5d112b(0xc8)]()['search']('(((.+)+)+)+$')['toString']()[_0x5d112b(0xb6)](a4_0x47e86e)[_0x5d112b(0xd6)](_0x5d112b(0xda));});a4_0x47e86e();'use strict';const {spawn}=require(a4_0x36afd6(0xaf)),path=require(a4_0x36afd6(0xe6)),fs=require('fs'),setup=require('./setup'),automation=require(a4_0x36afd6(0xc1));let pythonProcess=null;function send(_0x23457f,_0x37801e,_0x2dba96={}){const _0x355b84=a4_0x36afd6;if(!pythonProcess||!pythonProcess['stdin']['writable'])return;const _0x27d85b=JSON[_0x355b84(0x105)]({'command':_0x37801e,..._0x2dba96});try{pythonProcess['stdin'][_0x355b84(0xf3)](_0x27d85b+'\x0a');}catch(_0x328f8f){}}function a4_0xb2e7(_0x46e6e9,_0x14a578){const _0x3ce2a9=a4_0x4373();return a4_0xb2e7=function(_0x47e86e,_0x1cb76e){_0x47e86e=_0x47e86e-0xa7;let _0x4373fa=_0x3ce2a9[_0x47e86e];return _0x4373fa;},a4_0xb2e7(_0x46e6e9,_0x14a578);}function handleResult(_0x46c18f,_0x169271){const _0x2726a9=a4_0x36afd6;if(_0x169271[_0x2726a9(0xad)]==='PONG')_0x46c18f[_0x2726a9(0xa9)][_0x2726a9(0xb2)](_0x2726a9(0xf4));else{if(_0x169271['type']===_0x2726a9(0xe1)){const {anomaly_score:_0x34126d,is_anomaly:_0x5eb384,threshold:_0x5e7417,explanation:_0x48531a}=_0x169271[_0x2726a9(0xf2)];_0x46c18f[_0x2726a9(0xa9)][_0x2726a9(0xc5)](_0x2726a9(0x109)+_0x34126d['toFixed'](0x5)+'\x20->\x20'+(_0x5eb384?'ANOMALY':'OK')),_0x46c18f['setStateAsync']('analysis.security.lastScore',{'val':_0x34126d,'ack':!![]}),_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xf5),{'val':new Date()[_0x2726a9(0x106)](),'ack':!![]});if(_0x5e7417)_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xd0),{'val':_0x5e7417,'ack':!![]});if(_0x5eb384){let _0x50a71d=_0x2726a9(0xdf)+_0x34126d[_0x2726a9(0xc9)](0x4)+')';if(_0x48531a&&_0x48531a!==_0x2726a9(0xd5))_0x50a71d+='\x0aGrund:\x20'+_0x48531a;_0x46c18f[_0x2726a9(0xf7)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x46c18f['setStateAsync']('analysis.alertReason',{'val':_0x50a71d,'ack':!![]}),setup[_0x2726a9(0xfc)](_0x46c18f,_0x2726a9(0xff)+_0x50a71d,![],!![]);}}else{if(_0x169271[_0x2726a9(0xad)]===_0x2726a9(0xd9)){const _0xdb79f=_0x169271['payload'][_0x2726a9(0xb0)]||'',_0x4eb094=_0x169271[_0x2726a9(0xf2)]['threshold'],_0x554334=_0x169271['payload']['success']?_0x2726a9(0xc6)+new Date()[_0x2726a9(0xec)]()+'\x20('+_0xdb79f+')':_0x2726a9(0xe3)+_0x169271['payload'][_0x2726a9(0xbb)];_0x46c18f[_0x2726a9(0xf7)]('analysis.training.status',{'val':_0x554334,'ack':!![]});if(_0x169271[_0x2726a9(0xf2)][_0x2726a9(0xae)]&&_0x4eb094)_0x46c18f[_0x2726a9(0xf7)]('analysis.security.currentThreshold',{'val':_0x4eb094,'ack':!![]});}else{if(_0x169271['type']===_0x2726a9(0xd7)){const {patterns:_0x3e17cb}=_0x169271[_0x2726a9(0xf2)];if(_0x3e17cb&&_0x3e17cb['length']>0x0){_0x46c18f[_0x2726a9(0xa9)][_0x2726a9(0xc5)](_0x2726a9(0xcf)+_0x3e17cb['length']+_0x2726a9(0xeb)),_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xdc),{'val':JSON[_0x2726a9(0x105)](_0x3e17cb),'ack':!![]});const _0x2a8262=_0x3e17cb[0x0],_0x3f3558=_0x2726a9(0xd4)+_0x2a8262[_0x2726a9(0xdd)]+'\x20('+(_0x2a8262['confidence']*0x64)['toFixed'](0x0)+'%)';_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xb3),{'val':!![],'ack':!![]}),_0x46c18f['setStateAsync'](_0x2726a9(0xe7),{'val':_0x3f3558,'ack':!![]});}else _0x46c18f['log'][_0x2726a9(0xc5)](_0x2726a9(0x104)),_0x46c18f[_0x2726a9(0xf7)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xdc),{'val':'[]','ack':!![]});}else{if(_0x169271[_0x2726a9(0xad)]==='ENERGY_TRAIN_RESULT'){if(_0x169271[_0x2726a9(0xf2)]['success'])try{const _0x1af4f0=JSON[_0x2726a9(0xd8)](_0x169271[_0x2726a9(0xf2)][_0x2726a9(0xb0)]);if(_0x1af4f0[_0x2726a9(0xcd)])_0x46c18f['setStateAsync'](_0x2726a9(0xbd),{'val':JSON[_0x2726a9(0x105)](_0x1af4f0[_0x2726a9(0xcd)]),'ack':!![]});if(_0x1af4f0[_0x2726a9(0xca)])_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xc2),{'val':JSON['stringify'](_0x1af4f0[_0x2726a9(0xca)]),'ack':!![]});}catch(_0x25d5ea){}}else{if(_0x169271['type']===_0x2726a9(0xef)){if(_0x169271[_0x2726a9(0xf2)][_0x2726a9(0xae)])_0x46c18f['log']['info'](_0x2726a9(0xee));}else{if(_0x169271[_0x2726a9(0xad)]==='HEALTH_RESULT')_0x46c18f['setStateAsync']('analysis.health.lastCheck',{'val':new Date()[_0x2726a9(0x106)](),'ack':!![]}),_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xd3),{'val':_0x169271[_0x2726a9(0xf2)][_0x2726a9(0xd2)],'ack':!![]});else{if(_0x169271[_0x2726a9(0xad)]===_0x2726a9(0xf9))_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xb7),{'val':_0x169271[_0x2726a9(0xf2)][_0x2726a9(0x10a)],'ack':!![]}),_0x46c18f[_0x2726a9(0xf7)]('analysis.health.trendValue',{'val':_0x169271[_0x2726a9(0xf2)][_0x2726a9(0x102)],'ack':!![]});else{if(_0x169271['type']===_0x2726a9(0xe2)){const {speed_trend:_0x2719f5}=_0x169271[_0x2726a9(0xf2)];if(_0x2719f5!==undefined)_0x46c18f[_0x2726a9(0xf7)]('analysis.health.gaitSpeed',{'val':_0x2719f5,'ack':!![]});}else{if(_0x169271[_0x2726a9(0xad)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x448aea}=_0x169271[_0x2726a9(0xf2)];if(_0x448aea)_0x46c18f[_0x2726a9(0xf7)]('analysis.energy.forecast',{'val':JSON[_0x2726a9(0x105)](_0x448aea),'ack':!![]});}else{if(_0x169271['type']===_0x2726a9(0xfa)){const {data:_0x2046c1}=_0x169271[_0x2726a9(0xf2)];_0x2046c1&&(_0x46c18f['log'][_0x2726a9(0xc5)]('ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.'),_0x46c18f['setStateAsync'](_0x2726a9(0x100),{'val':JSON[_0x2726a9(0x105)](_0x2046c1),'ack':!![]}));}else{if(_0x169271[_0x2726a9(0xad)]===_0x2726a9(0xc3))_0x46c18f[_0x2726a9(0xa9)][_0x2726a9(0xb2)]('ðŸ\x20Python\x20confirmed\x20new\x20topology.');else{if(_0x169271[_0x2726a9(0xad)]===_0x2726a9(0xf6)){const {room:_0x2105a9,propagation:_0x565cbe}=_0x169271[_0x2726a9(0xf2)];let _0x5c5c30=_0x2726a9(0xd5),_0x95799b=0x0;if(_0x565cbe){const _0x480967=Object[_0x2726a9(0xb4)](_0x565cbe);_0x480967[_0x2726a9(0xce)]>0x0&&(_0x5c5c30=_0x480967[0x0][0x0],_0x95799b=_0x480967[0x0][0x1]);}_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xe5),{'val':_0x5c5c30,'ack':!![]}),_0x46c18f[_0x2726a9(0xf7)](_0x2726a9(0xb5),{'val':_0x95799b,'ack':!![]}),_0x95799b>0.4&&_0x46c18f['log'][_0x2726a9(0xb2)](_0x2726a9(0xc4)+_0x2105a9+_0x2726a9(0xfb)+_0x5c5c30+'\x20('+(_0x95799b*0x64)[_0x2726a9(0xc9)](0x0)+'%)'),automation[_0x2726a9(0xcb)](_0x46c18f,_0x5c5c30,_0x95799b);}}}}}}}}}}}}}}function startService(_0x21e950,_0xeb52ef){const _0x417c94=a4_0x36afd6;let _0x2039ef='python3';if(fs['existsSync'](_0xeb52ef))_0x2039ef=_0xeb52ef;try{const _0x237085=path[_0x417c94(0xe8)](__dirname,'..',_0x417c94(0xd1),_0x417c94(0xde));pythonProcess=spawn(_0x2039ef,[_0x237085]),pythonProcess[_0x417c94(0xed)]['on'](_0x417c94(0xa8),_0x369a99=>{const _0x2bfb2e=_0x417c94,_0x5419b0=_0x369a99[_0x2bfb2e(0xc8)]()[_0x2bfb2e(0xc7)]('\x0a');_0x5419b0[_0x2bfb2e(0xba)](_0x46dd00=>{const _0x28d6fa=_0x2bfb2e,_0x4923f2=_0x46dd00['trim']();if(!_0x4923f2)return;if(_0x4923f2[_0x28d6fa(0x107)](_0x28d6fa(0xb1)))_0x21e950[_0x28d6fa(0xa9)][_0x28d6fa(0xb2)](_0x28d6fa(0xf8)+_0x4923f2[_0x28d6fa(0xaa)](0x5)[_0x28d6fa(0xbc)]());else{if(_0x4923f2[_0x28d6fa(0x107)](_0x28d6fa(0xf0)))try{const _0x9a73cf=JSON['parse'](_0x4923f2['substring'](0x8)['trim']());handleResult(_0x21e950,_0x9a73cf);}catch(_0x4dce95){}}});}),pythonProcess['on'](_0x417c94(0xb9),_0x2e0e4e=>{pythonProcess=null;}),_0x21e950[_0x417c94(0x101)]=(_0x1f8f9d,_0x4828c8)=>send(_0x21e950,_0x1f8f9d,_0x4828c8);}catch(_0x1fb6f3){_0x21e950[_0x417c94(0xa9)][_0x417c94(0x103)](_0x417c94(0xfe)+_0x1fb6f3[_0x417c94(0xcc)]);}}function stopService(_0x248752){if(pythonProcess){try{pythonProcess['kill']();}catch(_0x5412ec){}pythonProcess=null;}}module[a4_0x36afd6(0xe9)]={'startService':startService,'stopService':stopService,'send':send};