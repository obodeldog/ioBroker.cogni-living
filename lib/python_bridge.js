const a4_0x2e322d=a4_0xbc98;(function(_0x10dff8,_0x3f3530){const _0x393cc1=a4_0xbc98,_0x224b46=_0x10dff8();while(!![]){try{const _0x241d89=-parseInt(_0x393cc1(0x20c))/0x1+-parseInt(_0x393cc1(0x21b))/0x2*(parseInt(_0x393cc1(0x222))/0x3)+-parseInt(_0x393cc1(0x219))/0x4*(-parseInt(_0x393cc1(0x1e8))/0x5)+-parseInt(_0x393cc1(0x24a))/0x6*(parseInt(_0x393cc1(0x25f))/0x7)+-parseInt(_0x393cc1(0x23a))/0x8+parseInt(_0x393cc1(0x237))/0x9*(-parseInt(_0x393cc1(0x25c))/0xa)+parseInt(_0x393cc1(0x26d))/0xb;if(_0x241d89===_0x3f3530)break;else _0x224b46['push'](_0x224b46['shift']());}catch(_0x501bc6){_0x224b46['push'](_0x224b46['shift']());}}}(a4_0x125f,0x6204c));const a4_0x4ed0be=(function(){let _0x2461b2=!![];return function(_0x1e0888,_0x56f3d7){const _0x371a74=_0x2461b2?function(){if(_0x56f3d7){const _0x3d9b18=_0x56f3d7['apply'](_0x1e0888,arguments);return _0x56f3d7=null,_0x3d9b18;}}:function(){};return _0x2461b2=![],_0x371a74;};}()),a4_0x588bfc=a4_0x4ed0be(this,function(){const _0x6513f1=a4_0xbc98;return a4_0x588bfc[_0x6513f1(0x1fd)]()[_0x6513f1(0x1e7)](_0x6513f1(0x24c))[_0x6513f1(0x1fd)]()[_0x6513f1(0x236)](a4_0x588bfc)['search'](_0x6513f1(0x24c));});a4_0x588bfc();'use strict';const {spawn}=require(a4_0x2e322d(0x232)),path=require(a4_0x2e322d(0x20e)),fs=require('fs'),setup=require('./setup'),automation=require(a4_0x2e322d(0x22e));function a4_0xbc98(_0x48f358,_0x51354e){const _0x557a45=a4_0x125f();return a4_0xbc98=function(_0x588bfc,_0x4ed0be){_0x588bfc=_0x588bfc-0x1e4;let _0x125f59=_0x557a45[_0x588bfc];return _0x125f59;},a4_0xbc98(_0x48f358,_0x51354e);}let pythonProcess=null;function send(_0x8cdf27,_0x289994,_0x282f06={}){const _0x377fad=a4_0x2e322d;if(!pythonProcess||!pythonProcess['stdin'][_0x377fad(0x226)])return;if(_0x289994===_0x377fad(0x20b)){const _0xf395ac=JSON[_0x377fad(0x210)](JSON[_0x377fad(0x1e6)](_0x282f06));_0xf395ac[_0x377fad(0x243)]&&Array[_0x377fad(0x252)](_0xf395ac[_0x377fad(0x243)])&&(_0xf395ac['rooms']=_0xf395ac[_0x377fad(0x243)][_0x377fad(0x1ef)](_0x2d04bf=>setup[_0x377fad(0x22c)](_0x2d04bf)),_0x8cdf27[_0x377fad(0x22d)][_0x377fad(0x250)](_0x377fad(0x269)+_0xf395ac[_0x377fad(0x243)][_0x377fad(0x260)](0x0,0x3)[_0x377fad(0x231)](',\x20')+_0x377fad(0x1fb))),_0xf395ac[_0x377fad(0x23c)]&&Array['isArray'](_0xf395ac[_0x377fad(0x23c)])&&(_0xf395ac['monitored']=_0xf395ac['monitored'][_0x377fad(0x1ef)](_0x115ee6=>setup[_0x377fad(0x22c)](_0x115ee6))),_0x282f06=_0xf395ac;}if((_0x289994==='TRAIN_TOPOLOGY'||_0x289994==='TRAIN_SECURITY')&&_0x282f06[_0x377fad(0x268)]){if(Array['isArray'](_0x282f06[_0x377fad(0x268)]))try{_0x282f06[_0x377fad(0x268)]['length']>0x0&&_0x8cdf27[_0x377fad(0x22d)][_0x377fad(0x1f7)](_0x377fad(0x256)+JSON['stringify'](_0x282f06['sequences'][0x0])[_0x377fad(0x225)](0x0,0x64)+_0x377fad(0x1fb)),_0x282f06['sequences']=_0x282f06['sequences']['map'](_0x1f16a1=>{const _0x99768d=_0x377fad;if(_0x1f16a1&&_0x1f16a1[_0x99768d(0x1f4)]&&Array[_0x99768d(0x252)](_0x1f16a1['steps']))return _0x1f16a1[_0x99768d(0x1f4)][_0x99768d(0x1ef)](_0x1a605b=>{const _0x3e0aa0=_0x1a605b['loc']||_0x1a605b['location']||_0x1a605b;return setup['normalizeRoomId'](_0x3e0aa0);});else{if(Array[_0x99768d(0x252)](_0x1f16a1))return _0x1f16a1['map'](_0x16be51=>setup[_0x99768d(0x22c)](_0x16be51));}return[];}),_0x282f06[_0x377fad(0x268)][_0x377fad(0x24b)]>0x0&&_0x8cdf27['log'][_0x377fad(0x250)](_0x377fad(0x228)+JSON[_0x377fad(0x1e6)](_0x282f06[_0x377fad(0x268)][0x0]));}catch(_0xbf7c8e){_0x8cdf27[_0x377fad(0x22d)][_0x377fad(0x242)]('Gateway\x20Unpack\x20Error:\x20'+_0xbf7c8e['message']),_0x282f06[_0x377fad(0x268)]=[];}else _0x282f06[_0x377fad(0x268)]=[];}_0x282f06['room']&&typeof _0x282f06[_0x377fad(0x26a)]===_0x377fad(0x207)&&(_0x282f06['room']=setup[_0x377fad(0x22c)](_0x282f06[_0x377fad(0x26a)]));if(_0x282f06[_0x377fad(0x224)]&&typeof _0x282f06[_0x377fad(0x224)]===_0x377fad(0x25b)){const _0x11a123={};for(const [_0x2c3a3d,_0x7d653b]of Object[_0x377fad(0x217)](_0x282f06[_0x377fad(0x224)]))_0x11a123[setup['normalizeRoomId'](_0x2c3a3d)]=_0x7d653b;_0x282f06[_0x377fad(0x224)]=_0x11a123;}const _0x431d9a=JSON[_0x377fad(0x1e6)]({'command':_0x289994,..._0x282f06});try{pythonProcess[_0x377fad(0x261)][_0x377fad(0x230)](_0x431d9a+'\x0a');}catch(_0x435235){}}function handleResult(_0x1d9c96,_0x5e92b1){const _0x55910b=a4_0x2e322d;if(_0x5e92b1['type']===_0x55910b(0x244))_0x1d9c96[_0x55910b(0x22d)][_0x55910b(0x1f7)](_0x55910b(0x22f));else{if(_0x5e92b1[_0x55910b(0x1f6)]==='SECURITY_RESULT'){const {anomaly_score:_0x138bda,is_anomaly:_0x422785,threshold:_0x1609bd,explanation:_0x13ac46}=_0x5e92b1[_0x55910b(0x22b)];_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x257),{'val':_0x138bda,'ack':!![]}),_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x229),{'val':new Date()[_0x55910b(0x216)](),'ack':!![]});if(_0x1609bd)_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x251),{'val':_0x1609bd,'ack':!![]});if(_0x422785){let _0x2e2103=_0x55910b(0x264)+_0x138bda[_0x55910b(0x22a)](0x4)+')';if(_0x13ac46&&_0x13ac46!=='Unknown')_0x2e2103+='\x0aGrund:\x20'+_0x13ac46;_0x1d9c96['setStateAsync'](_0x55910b(0x262),{'val':!![],'ack':!![]}),_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x227),{'val':_0x2e2103,'ack':!![]}),setup['sendNotification'](_0x1d9c96,_0x55910b(0x24d)+_0x2e2103,![],!![]);}}else{if(_0x5e92b1['type']===_0x55910b(0x245)){const _0x585d8d=_0x5e92b1[_0x55910b(0x22b)]['details']||'',_0x13f10b=_0x5e92b1[_0x55910b(0x22b)]['threshold'],_0x1acb2f=_0x5e92b1['payload']['success']?_0x55910b(0x1f1)+new Date()[_0x55910b(0x1f2)]()+'\x20('+_0x585d8d+')':_0x55910b(0x21e)+_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x200)];_0x1d9c96['setStateAsync'](_0x55910b(0x255),{'val':_0x1acb2f,'ack':!![]});if(_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x23e)]&&_0x13f10b)_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x251),{'val':_0x13f10b,'ack':!![]});}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x24f)){const _0x2140a1=_0x55910b(0x20d)+_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x243)]['length']+_0x55910b(0x25a);_0x1d9c96[_0x55910b(0x204)]('analysis.training.status',{'val':_0x2140a1,'ack':!![]}),_0x5e92b1[_0x55910b(0x22b)]['matrix']&&_0x5e92b1[_0x55910b(0x22b)]['rooms']&&_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x258),{'val':JSON[_0x55910b(0x1e6)](_0x5e92b1['payload']),'ack':!![]});}else{if(_0x5e92b1['type']==='ENERGY_TRAIN_RESULT'){if(_0x5e92b1[_0x55910b(0x22b)]['success'])try{const _0x3a76=JSON['parse'](_0x5e92b1[_0x55910b(0x22b)]['details']);if(_0x3a76['insulation'])_0x1d9c96[_0x55910b(0x204)]('analysis.energy.insulationScore',{'val':JSON[_0x55910b(0x1e6)](_0x3a76['insulation']),'ack':!![]});if(_0x3a76[_0x55910b(0x240)])_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x239),{'val':JSON[_0x55910b(0x1e6)](_0x3a76[_0x55910b(0x240)]),'ack':!![]});}catch(_0x3b6077){}}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x211))_0x1d9c96['log'][_0x55910b(0x250)](_0x55910b(0x1f8)),_0x1d9c96['setStateAsync'](_0x55910b(0x24e),{'val':new Date()[_0x55910b(0x1eb)](),'ack':!![]});else{if(_0x5e92b1[_0x55910b(0x1f6)]==='HEALTH_RESULT')_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x1f0),{'val':_0x5e92b1['payload']['is_anomaly'],'ack':!![]});else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x203))_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x213),{'val':_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x259)],'ack':!![]}),_0x1d9c96[_0x55910b(0x22d)][_0x55910b(0x250)](_0x55910b(0x247)+_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x1fa)]);else{if(_0x5e92b1[_0x55910b(0x1f6)]==='GAIT_RESULT'){if(_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x1e5)]!==undefined)_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x21f),{'val':_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x1e5)],'ack':!![]});if(_0x5e92b1['payload'][_0x55910b(0x212)])_0x1d9c96['setStateAsync'](_0x55910b(0x265),{'val':_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x212)][_0x55910b(0x231)](',\x20'),'ack':!![]});if(_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x1ec)])_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x1ed),{'val':_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x1ec)],'ack':!![]});}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x23d)){if(_0x5e92b1['payload'][_0x55910b(0x249)])_0x1d9c96[_0x55910b(0x204)]('analysis.energy.forecast',{'val':JSON[_0x55910b(0x1e6)](_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x249)]),'ack':!![]});}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x21c)){if(_0x5e92b1['payload'][_0x55910b(0x1f3)])_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x26c),{'val':JSON[_0x55910b(0x1e6)](_0x5e92b1['payload']['times']),'ack':!![]});if(_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x263)])_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x214),{'val':JSON[_0x55910b(0x1e6)](_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x263)]),'ack':!![]});if(_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x1fa)])_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x20f),{'val':JSON[_0x55910b(0x1e6)](_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x1fa)]),'ack':!![]});}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x253)){if(_0x5e92b1['payload'][_0x55910b(0x221)])_0x1d9c96['setStateAsync'](_0x55910b(0x1ff),{'val':JSON[_0x55910b(0x1e6)](_0x5e92b1[_0x55910b(0x22b)]['penalties']),'ack':!![]});}else{if(_0x5e92b1['type']===_0x55910b(0x206)){if(_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x249)])_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x266),{'val':JSON['stringify'](_0x5e92b1['payload'][_0x55910b(0x249)]),'ack':!![]});}else{if(_0x5e92b1[_0x55910b(0x1f6)]==='VENTILATION_ALERT'){if(_0x5e92b1[_0x55910b(0x22b)]['alerts'])_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x1f5),{'val':JSON[_0x55910b(0x1e6)](_0x5e92b1[_0x55910b(0x22b)]['alerts']),'ack':!![]});}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x1e9)){const {proposals:_0x2e9e8f}=_0x5e92b1[_0x55910b(0x22b)];_0x1d9c96[_0x55910b(0x209)](_0x55910b(0x205),(_0x43237f,_0x19edf5)=>{const _0x34f607=_0x55910b;if(_0x19edf5&&_0x19edf5[_0x34f607(0x25d)]===!![]&&_0x2e9e8f&&_0x2e9e8f['length']>0x0)automation[_0x34f607(0x215)](_0x1d9c96,_0x2e9e8f);});}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x254)){const {propagation:_0x277b93}=_0x5e92b1[_0x55910b(0x22b)];let _0x8de735='Unknown',_0xfb8f70=0x0;if(_0x277b93){const _0x38dc96=Object['entries'](_0x277b93);_0x38dc96[_0x55910b(0x24b)]>0x0&&(_0x8de735=_0x38dc96[0x0][0x0],_0xfb8f70=_0x38dc96[0x0][0x1]);}_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x1f9),{'val':_0x8de735,'ack':!![]}),_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x233),{'val':_0xfb8f70,'ack':!![]}),automation['handlePrediction'](_0x1d9c96,_0x8de735,_0xfb8f70);}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x235)){const {probabilities:_0x10b1a6}=_0x5e92b1[_0x55910b(0x22b)];if(_0x10b1a6){_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x1ea),{'val':JSON[_0x55910b(0x1e6)](_0x10b1a6),'ack':!![]});const _0x42934e=Object['keys'](_0x10b1a6);_0x42934e[_0x55910b(0x24b)]>0x0&&(_0x1d9c96[_0x55910b(0x204)](_0x55910b(0x218),{'val':_0x42934e[0x0],'ack':!![]}),_0x1d9c96['setStateAsync'](_0x55910b(0x246),{'val':_0x10b1a6[_0x42934e[0x0]],'ack':!![]}));}}else{if(_0x5e92b1[_0x55910b(0x1f6)]===_0x55910b(0x1e4)){if(_0x5e92b1[_0x55910b(0x22b)][_0x55910b(0x220)])_0x1d9c96[_0x55910b(0x204)]('analysis.automation.detectedPatterns',{'val':JSON['stringify'](_0x5e92b1['payload'][_0x55910b(0x220)]),'ack':!![]});}}}}}}}}}}}}}}}}}}}function startService(_0x5d511c,_0x375720){const _0x3eeebc=a4_0x2e322d;let _0x408640='python3';if(fs[_0x3eeebc(0x202)](_0x375720))_0x408640=_0x375720;const _0x2bb98b=path['join'](__dirname,'..',_0x3eeebc(0x21d)),_0x55f8a5=path[_0x3eeebc(0x231)](__dirname,'..','python_service',_0x3eeebc(0x21d));let _0x423cc0=fs['existsSync'](_0x2bb98b)?_0x2bb98b:fs['existsSync'](_0x55f8a5)?_0x55f8a5:null;if(!_0x423cc0){_0x5d511c[_0x3eeebc(0x22d)][_0x3eeebc(0x21a)](_0x3eeebc(0x208));return;}try{_0x5d511c['log'][_0x3eeebc(0x250)](_0x3eeebc(0x1fe)+_0x408640+'\x20'+_0x423cc0),pythonProcess=spawn(_0x408640,[_0x423cc0]),pythonProcess[_0x3eeebc(0x267)]['on']('data',_0x5ac509=>{const _0x292ef1=_0x3eeebc,_0x92ef6d=_0x5ac509[_0x292ef1(0x1fd)]()[_0x292ef1(0x1ee)]('\x0a');_0x92ef6d[_0x292ef1(0x234)](_0x4101d4=>{const _0x1174d7=_0x292ef1,_0x17037a=_0x4101d4['trim']();if(!_0x17037a)return;if(_0x17037a['startsWith'](_0x1174d7(0x23b)))_0x5d511c[_0x1174d7(0x22d)][_0x1174d7(0x1f7)](_0x1174d7(0x238)+_0x17037a[_0x1174d7(0x225)](0x5)['trim']());else{if(_0x17037a['startsWith'](_0x1174d7(0x26b)))try{const _0x4f67c9=JSON[_0x1174d7(0x210)](_0x17037a['substring'](0x8)[_0x1174d7(0x20a)]());handleResult(_0x5d511c,_0x4f67c9);}catch(_0x1e7b7e){}}});}),pythonProcess['stderr']['on'](_0x3eeebc(0x223),_0x7770cf=>{const _0x5a3ad5=_0x3eeebc;_0x5d511c['log'][_0x5a3ad5(0x21a)](_0x5a3ad5(0x241)+_0x7770cf[_0x5a3ad5(0x1fd)]()[_0x5a3ad5(0x20a)]());}),pythonProcess['on'](_0x3eeebc(0x1fc),_0x29c0da=>{const _0x3b65f0=_0x3eeebc;_0x5d511c[_0x3b65f0(0x22d)]['warn'](_0x3b65f0(0x248)+_0x29c0da),pythonProcess=null;}),_0x5d511c[_0x3eeebc(0x201)]=(_0xfabce8,_0x5c3c7b)=>send(_0x5d511c,_0xfabce8,_0x5c3c7b);}catch(_0x51bf84){_0x5d511c[_0x3eeebc(0x22d)][_0x3eeebc(0x21a)](_0x3eeebc(0x23f)+_0x51bf84[_0x3eeebc(0x25e)]);}}function stopService(_0x7efe04){if(pythonProcess){try{pythonProcess['kill']();}catch(_0x46f68d){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};function a4_0x125f(){const _0x94d20b=['250456juPvsI','[LOG]','monitored','ENERGY_PREDICT_RESULT','success','Error\x20launching\x20Python:\x20','heating','[PYTHON\x20ERR]\x20','warn','rooms','PONG','TRAINING_COMPLETE','analysis.prediction.trackerConfidence','üìà\x20Health\x20Trend:\x20','Python\x20process\x20exited\x20with\x20code\x20','forecast','18fhzmyD','length','(((.+)+)+)+$','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','analysis.health.lastCheck','GRAPH_TRAINED','info','analysis.security.currentThreshold','isArray','RL_PENALTY_UPDATE','SIGNAL_RESULT','analysis.training.status','[Bridge-Debug]\x20Raw\x20Sequence\x20[0]:\x20','analysis.security.lastScore','analysis.security.topologyMatrix','trend_percent','\x20Rooms)','object','2623990HKkcgo','val','message','793121weLGga','slice','stdin','analysis.isAlert','sources','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','analysis.health.gaitSensors','analysis.energy.pinnForecast','stdout','sequences','[Bridge-Debug]\x20Setting\x20Topology\x20Rooms\x20(Sample):\x20','room','[RESULT]','analysis.energy.warmupTimes','19301293seQZor','COMFORT_RESULT','speed_trend','stringify','search','5OLaiPz','ENERGY_OPTIMIZE_RESULT','analysis.prediction.trackerState','toLocaleDateString','proof','analysis.health.gaitDebug','split','map','analysis.health.isAnomaly','Success:\x20','toLocaleTimeString','times','steps','analysis.energy.ventilationAlerts','type','debug','‚úÖ\x20HEALTH\x20TRAINED.','analysis.prediction.nextRoom','details','...','close','toString','üöÄ\x20Starting\x20Python\x20Bridge\x20using:\x20','analysis.energy.rlPenalties','reason','sendToPythonWrapper','existsSync','HEALTH_TREND_RESULT','setStateAsync','analysis.energy.mpcActive','PINN_PREDICT_RESULT','string','‚ùå\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!','getState','trim','SET_TOPOLOGY','329801esaEzM','Graph\x20Updated\x20(','path','analysis.energy.warmupDetails','parse','HEALTH_TRAIN_RESULT','sensors','analysis.health.activityTrend','analysis.energy.warmupSources','applyEnergySavings','toISOString','entries','analysis.prediction.trackerTopRoom','1580860PycEnx','error','4Bdcpcx','WARMUP_RESULT','service.py','Failed:\x20','analysis.health.gaitSpeed','patterns','penalties','1177467QzTmnA','data','current_temps','substring','writable','analysis.alertReason','[Bridge-Debug]\x20Normalized\x20Sequence\x20[0]\x20(Unpacked):\x20','analysis.security.lastCheck','toFixed','payload','normalizeRoomId','log','./automation','üêç\x20Python\x20Pong','write','join','child_process','analysis.prediction.confidence','forEach','TRACKER_RESULT','constructor','9nkvMzR','[PYTHON]\x20','analysis.energy.heatingScore'];a4_0x125f=function(){return _0x94d20b;};return a4_0x125f();}