const a3_0x52941a=a3_0x4e35;(function(_0x249e69,_0x3f6d7f){const _0x1dc5ab=a3_0x4e35,_0x26913b=_0x249e69();while(!![]){try{const _0x2450f3=-parseInt(_0x1dc5ab(0x183))/0x1+-parseInt(_0x1dc5ab(0x147))/0x2*(-parseInt(_0x1dc5ab(0x15c))/0x3)+-parseInt(_0x1dc5ab(0x19a))/0x4*(parseInt(_0x1dc5ab(0x140))/0x5)+-parseInt(_0x1dc5ab(0x149))/0x6*(-parseInt(_0x1dc5ab(0x16a))/0x7)+parseInt(_0x1dc5ab(0x14e))/0x8+parseInt(_0x1dc5ab(0x197))/0x9+-parseInt(_0x1dc5ab(0x17b))/0xa*(parseInt(_0x1dc5ab(0x193))/0xb);if(_0x2450f3===_0x3f6d7f)break;else _0x26913b['push'](_0x26913b['shift']());}catch(_0x36a666){_0x26913b['push'](_0x26913b['shift']());}}}(a3_0x3418,0xd080d));const a3_0x3519c5=(function(){let _0x52d12c=!![];return function(_0x45375a,_0x5eacc6){const _0x1d3efd=_0x52d12c?function(){if(_0x5eacc6){const _0x56d2c2=_0x5eacc6['apply'](_0x45375a,arguments);return _0x5eacc6=null,_0x56d2c2;}}:function(){};return _0x52d12c=![],_0x1d3efd;};}()),a3_0xd0c779=a3_0x3519c5(this,function(){const _0xcbf7da=a3_0x4e35;return a3_0xd0c779[_0xcbf7da(0x15e)]()['search']('(((.+)+)+)+$')[_0xcbf7da(0x15e)]()[_0xcbf7da(0x174)](a3_0xd0c779)[_0xcbf7da(0x19e)]('(((.+)+)+)+$');});function a3_0x3418(){const _0x415c78=['SECURITY_RESULT','setStateAsync','analysis.isAlert','GAIT_RESULT','constructor','analysis.automation.detectedPatterns','heating','length','sendNotification','diagnosis','change_percent','1401350aXmqKA','handlePrediction','data','toISOString','analysis.security.lastCheck','ðŸ\x20Python\x20Pong','toLocaleTimeString','\x20->\x20','1051334zSBpPR','analysis.energy.forecast','ENERGY_TRAIN_RESULT','TOPOLOGY_ACK','python_service','message','close','ðŸ”®\x20Prediction:\x20From\x20','analysis.health.gaitSpeed','join','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','threshold','analysis.health.trendValue','substring','details','toFixed','55lQlozL','sendToPythonWrapper','exports','analysis.security.lastScore','13874850SGVhUY','payload','analysis.health.isAnomaly','268vwjArX','type','success','âœ…\x20HEALTH\x20TRAINED.','search','forEach','116245KoYtCl','analysis.security.currentThreshold','python3','PONG','child_process','[PYTHON]\x20','\x20->\x20Likely\x20','2jEVxwo','error','12iHqlmP','stdin','Unknown','analysis.automation.patternDetected','SIGNAL_RESULT','13026768gXcDqT','info','analysis.health.lastCheck','trim','[LOG]','analysis.prediction.nextRoom','insulation','HEALTH_RESULT','existsSync','write','startsWith','Success:\x20','Failed:\x20','stringify','2710101UlnIbt','path','toString','analysis.energy.insulationScore','writable','split','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','ANOMALY','TOPOLOGY_RESULT','confidence','./setup','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','analysis.health.trendDiagnosis','analysis.prediction.confidence','316253GJsxeR','âš ï¸\x20SECURITY\x20ALARM:\x20','analysis.training.status','log','debug','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'];a3_0x3418=function(){return _0x415c78;};return a3_0x3418();}a3_0xd0c779();'use strict';function a3_0x4e35(_0x2be394,_0x80ecb9){const _0x4dc609=a3_0x3418();return a3_0x4e35=function(_0xd0c779,_0x3519c5){_0xd0c779=_0xd0c779-0x13f;let _0x341819=_0x4dc609[_0xd0c779];return _0x341819;},a3_0x4e35(_0x2be394,_0x80ecb9);}const {spawn}=require(a3_0x52941a(0x144)),path=require(a3_0x52941a(0x15d)),fs=require('fs'),setup=require(a3_0x52941a(0x166)),automation=require('./automation');let pythonProcess=null;function send(_0x18a561,_0x109965,_0x98732a={}){const _0x2d0d7a=a3_0x52941a;if(!pythonProcess||!pythonProcess['stdin'][_0x2d0d7a(0x160)])return;const _0x11c683=JSON['stringify']({'command':_0x109965,..._0x98732a});try{pythonProcess[_0x2d0d7a(0x14a)][_0x2d0d7a(0x157)](_0x11c683+'\x0a');}catch(_0x72d7ff){}}function handleResult(_0x58a9fe,_0x102acf){const _0x5e0d6c=a3_0x52941a;if(_0x102acf[_0x5e0d6c(0x19b)]===_0x5e0d6c(0x143))_0x58a9fe[_0x5e0d6c(0x16d)][_0x5e0d6c(0x16e)](_0x5e0d6c(0x180));else{if(_0x102acf[_0x5e0d6c(0x19b)]===_0x5e0d6c(0x170)){const {anomaly_score:_0x32c697,is_anomaly:_0x234e2c,threshold:_0x101dfd,explanation:_0x1b09c6}=_0x102acf[_0x5e0d6c(0x198)];_0x58a9fe['log'][_0x5e0d6c(0x14f)](_0x5e0d6c(0x162)+_0x32c697['toFixed'](0x5)+_0x5e0d6c(0x182)+(_0x234e2c?_0x5e0d6c(0x163):'OK')),_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x196),{'val':_0x32c697,'ack':!![]}),_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x17f),{'val':new Date()[_0x5e0d6c(0x17e)](),'ack':!![]});if(_0x101dfd)_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x141),{'val':_0x101dfd,'ack':!![]});if(_0x234e2c){let _0x299e3e=_0x5e0d6c(0x16f)+_0x32c697[_0x5e0d6c(0x192)](0x4)+')';if(_0x1b09c6&&_0x1b09c6!==_0x5e0d6c(0x14b))_0x299e3e+='\x0aGrund:\x20'+_0x1b09c6;_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x172),{'val':!![],'ack':!![]}),_0x58a9fe[_0x5e0d6c(0x171)]('analysis.alertReason',{'val':_0x299e3e,'ack':!![]}),setup[_0x5e0d6c(0x178)](_0x58a9fe,_0x5e0d6c(0x16b)+_0x299e3e,![],!![]);}}else{if(_0x102acf[_0x5e0d6c(0x19b)]==='TRAINING_COMPLETE'){const _0x5d8127=_0x102acf['payload']['details']||'',_0x57936c=_0x102acf[_0x5e0d6c(0x198)][_0x5e0d6c(0x18e)],_0x2b1e17=_0x102acf[_0x5e0d6c(0x198)][_0x5e0d6c(0x19c)]?_0x5e0d6c(0x159)+new Date()[_0x5e0d6c(0x181)]()+'\x20('+_0x5d8127+')':_0x5e0d6c(0x15a)+_0x102acf[_0x5e0d6c(0x198)]['reason'];_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x16c),{'val':_0x2b1e17,'ack':!![]});if(_0x102acf[_0x5e0d6c(0x198)]['success']&&_0x57936c)_0x58a9fe['setStateAsync']('analysis.security.currentThreshold',{'val':_0x57936c,'ack':!![]});}else{if(_0x102acf[_0x5e0d6c(0x19b)]==='COMFORT_RESULT'){const {patterns:_0x10f100}=_0x102acf[_0x5e0d6c(0x198)];if(_0x10f100&&_0x10f100[_0x5e0d6c(0x177)]>0x0){_0x58a9fe[_0x5e0d6c(0x16d)][_0x5e0d6c(0x14f)](_0x5e0d6c(0x18d)+_0x10f100[_0x5e0d6c(0x177)]+'\x20new\x20patterns.'),_0x58a9fe[_0x5e0d6c(0x171)]('analysis.automation.detectedPatterns',{'val':JSON[_0x5e0d6c(0x15b)](_0x10f100),'ack':!![]});const _0x331336=_0x10f100[0x0],_0x48df74='Regel\x20erkannt:\x20'+_0x331336['rule']+'\x20('+(_0x331336[_0x5e0d6c(0x165)]*0x64)[_0x5e0d6c(0x192)](0x0)+'%)';_0x58a9fe['setStateAsync'](_0x5e0d6c(0x14c),{'val':!![],'ack':!![]}),_0x58a9fe['setStateAsync']('analysis.automation.description',{'val':_0x48df74,'ack':!![]});}else _0x58a9fe['log'][_0x5e0d6c(0x14f)]('ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x58a9fe['setStateAsync'](_0x5e0d6c(0x14c),{'val':![],'ack':!![]}),_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x175),{'val':'[]','ack':!![]});}else{if(_0x102acf['type']===_0x5e0d6c(0x185)){if(_0x102acf[_0x5e0d6c(0x198)][_0x5e0d6c(0x19c)])try{const _0x467c94=JSON['parse'](_0x102acf['payload'][_0x5e0d6c(0x191)]);if(_0x467c94[_0x5e0d6c(0x154)])_0x58a9fe['setStateAsync'](_0x5e0d6c(0x15f),{'val':JSON[_0x5e0d6c(0x15b)](_0x467c94['insulation']),'ack':!![]});if(_0x467c94[_0x5e0d6c(0x176)])_0x58a9fe['setStateAsync']('analysis.energy.heatingScore',{'val':JSON[_0x5e0d6c(0x15b)](_0x467c94['heating']),'ack':!![]});}catch(_0x2186be){}}else{if(_0x102acf[_0x5e0d6c(0x19b)]==='HEALTH_TRAIN_RESULT'){if(_0x102acf[_0x5e0d6c(0x198)][_0x5e0d6c(0x19c)])_0x58a9fe['log'][_0x5e0d6c(0x14f)](_0x5e0d6c(0x19d));}else{if(_0x102acf[_0x5e0d6c(0x19b)]===_0x5e0d6c(0x155))_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x150),{'val':new Date()[_0x5e0d6c(0x17e)](),'ack':!![]}),_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x199),{'val':_0x102acf['payload']['is_anomaly'],'ack':!![]});else{if(_0x102acf[_0x5e0d6c(0x19b)]==='TREND_RESULT')_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x168),{'val':_0x102acf[_0x5e0d6c(0x198)][_0x5e0d6c(0x179)],'ack':!![]}),_0x58a9fe['setStateAsync'](_0x5e0d6c(0x18f),{'val':_0x102acf[_0x5e0d6c(0x198)][_0x5e0d6c(0x17a)],'ack':!![]});else{if(_0x102acf[_0x5e0d6c(0x19b)]===_0x5e0d6c(0x173)){const {speed_trend:_0x577d94}=_0x102acf['payload'];if(_0x577d94!==undefined)_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x18b),{'val':_0x577d94,'ack':!![]});}else{if(_0x102acf[_0x5e0d6c(0x19b)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x269ec0}=_0x102acf['payload'];if(_0x269ec0)_0x58a9fe['setStateAsync'](_0x5e0d6c(0x184),{'val':JSON[_0x5e0d6c(0x15b)](_0x269ec0),'ack':!![]});}else{if(_0x102acf['type']===_0x5e0d6c(0x164)){const {data:_0x5bb5e7}=_0x102acf['payload'];_0x5bb5e7&&(_0x58a9fe[_0x5e0d6c(0x16d)][_0x5e0d6c(0x14f)](_0x5e0d6c(0x167)),_0x58a9fe[_0x5e0d6c(0x171)]('analysis.security.topologyMatrix',{'val':JSON[_0x5e0d6c(0x15b)](_0x5bb5e7),'ack':!![]}));}else{if(_0x102acf[_0x5e0d6c(0x19b)]===_0x5e0d6c(0x186))_0x58a9fe[_0x5e0d6c(0x16d)][_0x5e0d6c(0x16e)]('ðŸ\x20Python\x20confirmed\x20new\x20topology.');else{if(_0x102acf[_0x5e0d6c(0x19b)]===_0x5e0d6c(0x14d)){const {room:_0x16c43c,propagation:_0x2a5e5f}=_0x102acf['payload'];let _0x542523='Unknown',_0x2c9dfe=0x0;if(_0x2a5e5f){const _0x515ac2=Object['entries'](_0x2a5e5f);_0x515ac2[_0x5e0d6c(0x177)]>0x0&&(_0x542523=_0x515ac2[0x0][0x0],_0x2c9dfe=_0x515ac2[0x0][0x1]);}_0x58a9fe[_0x5e0d6c(0x171)](_0x5e0d6c(0x153),{'val':_0x542523,'ack':!![]}),_0x58a9fe['setStateAsync'](_0x5e0d6c(0x169),{'val':_0x2c9dfe,'ack':!![]}),_0x2c9dfe>0.4&&_0x58a9fe['log'][_0x5e0d6c(0x16e)](_0x5e0d6c(0x18a)+_0x16c43c+_0x5e0d6c(0x146)+_0x542523+'\x20('+(_0x2c9dfe*0x64)[_0x5e0d6c(0x192)](0x0)+'%)'),automation[_0x5e0d6c(0x17c)](_0x58a9fe,_0x542523,_0x2c9dfe);}}}}}}}}}}}}}}function startService(_0x490b35,_0x574cbc){const _0x2a4f3b=a3_0x52941a;let _0x2c6406=_0x2a4f3b(0x142);if(fs[_0x2a4f3b(0x156)](_0x574cbc))_0x2c6406=_0x574cbc;try{const _0x582603=path[_0x2a4f3b(0x18c)](__dirname,'..',_0x2a4f3b(0x187),'service.py');pythonProcess=spawn(_0x2c6406,[_0x582603]),pythonProcess['stdout']['on'](_0x2a4f3b(0x17d),_0x5e9c4b=>{const _0x1ff396=_0x2a4f3b,_0x3e580b=_0x5e9c4b[_0x1ff396(0x15e)]()[_0x1ff396(0x161)]('\x0a');_0x3e580b[_0x1ff396(0x13f)](_0x2cf42e=>{const _0x26ac01=_0x1ff396,_0x5c35f7=_0x2cf42e[_0x26ac01(0x151)]();if(!_0x5c35f7)return;if(_0x5c35f7['startsWith'](_0x26ac01(0x152)))_0x490b35[_0x26ac01(0x16d)][_0x26ac01(0x16e)](_0x26ac01(0x145)+_0x5c35f7[_0x26ac01(0x190)](0x5)[_0x26ac01(0x151)]());else{if(_0x5c35f7[_0x26ac01(0x158)]('[RESULT]'))try{const _0x4bb66f=JSON['parse'](_0x5c35f7[_0x26ac01(0x190)](0x8)[_0x26ac01(0x151)]());handleResult(_0x490b35,_0x4bb66f);}catch(_0x251c94){}}});}),pythonProcess['on'](_0x2a4f3b(0x189),_0x4dc98c=>{pythonProcess=null;}),_0x490b35[_0x2a4f3b(0x194)]=(_0x3be55b,_0x5ca0e1)=>send(_0x490b35,_0x3be55b,_0x5ca0e1);}catch(_0x5f2e55){_0x490b35[_0x2a4f3b(0x16d)][_0x2a4f3b(0x148)]('Error\x20launching\x20Python:\x20'+_0x5f2e55[_0x2a4f3b(0x188)]);}}function stopService(_0x45ae73){if(pythonProcess){try{pythonProcess['kill']();}catch(_0x40bfac){}pythonProcess=null;}}module[a3_0x52941a(0x195)]={'startService':startService,'stopService':stopService,'send':send};