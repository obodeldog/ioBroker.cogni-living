const a4_0x29f063=a4_0x825e;(function(_0x335522,_0x516b05){const _0x16d739=a4_0x825e,_0x4d58e3=_0x335522();while(!![]){try{const _0x5819c5=parseInt(_0x16d739(0x1cc))/0x1+-parseInt(_0x16d739(0x1cd))/0x2+parseInt(_0x16d739(0x220))/0x3+-parseInt(_0x16d739(0x1e9))/0x4+-parseInt(_0x16d739(0x21d))/0x5*(parseInt(_0x16d739(0x1f3))/0x6)+-parseInt(_0x16d739(0x1f4))/0x7*(-parseInt(_0x16d739(0x1ec))/0x8)+-parseInt(_0x16d739(0x1d4))/0x9*(parseInt(_0x16d739(0x1d7))/0xa);if(_0x5819c5===_0x516b05)break;else _0x4d58e3['push'](_0x4d58e3['shift']());}catch(_0x48ffa8){_0x4d58e3['push'](_0x4d58e3['shift']());}}}(a4_0x4361,0x86c0e));function a4_0x825e(_0x4dbcbc,_0x461aa3){const _0x1cc5ca=a4_0x4361();return a4_0x825e=function(_0x7fb76e,_0x29fa03){_0x7fb76e=_0x7fb76e-0x1c4;let _0x4361d4=_0x1cc5ca[_0x7fb76e];return _0x4361d4;},a4_0x825e(_0x4dbcbc,_0x461aa3);}const a4_0x29fa03=(function(){let _0x5a34ef=!![];return function(_0x155aac,_0x1e5baf){const _0x3c6514=_0x5a34ef?function(){if(_0x1e5baf){const _0x46768f=_0x1e5baf['apply'](_0x155aac,arguments);return _0x1e5baf=null,_0x46768f;}}:function(){};return _0x5a34ef=![],_0x3c6514;};}()),a4_0x7fb76e=a4_0x29fa03(this,function(){const _0x559bf2=a4_0x825e;return a4_0x7fb76e[_0x559bf2(0x1e6)]()[_0x559bf2(0x1de)](_0x559bf2(0x205))[_0x559bf2(0x1e6)]()['constructor'](a4_0x7fb76e)['search'](_0x559bf2(0x205));});a4_0x7fb76e();'use strict';const {spawn}=require(a4_0x29f063(0x1d5)),path=require(a4_0x29f063(0x206)),fs=require('fs'),setup=require('./setup'),automation=require(a4_0x29f063(0x1e7));let pythonProcess=null;function send(_0x1bc101,_0x375065,_0x31a08e={}){const _0x3b6e80=a4_0x29f063;if(!pythonProcess||!pythonProcess['stdin'][_0x3b6e80(0x1d1)])return;const _0x57d2c9=JSON[_0x3b6e80(0x1e4)]({'command':_0x375065,..._0x31a08e});try{pythonProcess['stdin'][_0x3b6e80(0x209)](_0x57d2c9+'\x0a');}catch(_0x3d9352){}}function a4_0x4361(){const _0x494303=['python_service','analysis.health.isAnomaly','success','parse','length','payload','SIGNAL_RESULT','analysis.prediction.confidence','join','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','analysis.security.lastScore','analysis.automation.detectedPatterns','close','ðŸ\x20Python\x20confirmed\x20new\x20topology.','trim','(((.+)+)+)+$','path','startsWith','Unknown','write','GAIT_RESULT','insulation','[RESULT]','details','kill','SECURITY_RESULT','ðŸ\x20Python\x20Pong','analysis.alertReason','handlePrediction','rule','analysis.security.currentThreshold','ENERGY_TRAIN_RESULT','service.py','[PYTHON]\x20','analysis.health.gaitSpeed','COMFORT_RESULT','TREND_RESULT','Regel\x20erkannt:\x20','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','90yhCjHf','type','analysis.automation.patternDetected','1103868XZiErZ','debug','analysis.automation.description','reason','sendNotification','analysis.security.lastCheck','\x20new\x20patterns.','python3','split','1035461IGPpSR','65094aHZEGb','ENERGY_PREDICT_RESULT','toFixed','analysis.health.trendDiagnosis','writable','analysis.energy.heatingScore','Failed:\x20','9pdCdix','child_process','ANOMALY','8194990ljLoNZ','error','\x20->\x20Likely\x20','heating','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','confidence','âš ï¸\x20SECURITY\x20ALARM:\x20','search','forEach','message','substring','Error\x20launching\x20Python:\x20','setStateAsync','stringify','HEALTH_TRAIN_RESULT','toString','./automation','âœ…\x20HEALTH\x20TRAINED.','59304yycJoM','log','HEALTH_RESULT','20904myNOzH','diagnosis','analysis.training.status','analysis.security.topologyMatrix','entries','toISOString','info','41028bPZlCH','371XvSaPP','PONG'];a4_0x4361=function(){return _0x494303;};return a4_0x4361();}function handleResult(_0x5ccca3,_0x59dbb0){const _0x5750cb=a4_0x29f063;if(_0x59dbb0[_0x5750cb(0x21e)]===_0x5750cb(0x1f5))_0x5ccca3[_0x5750cb(0x1ea)][_0x5750cb(0x1c4)](_0x5750cb(0x210));else{if(_0x59dbb0[_0x5750cb(0x21e)]===_0x5750cb(0x20f)){const {anomaly_score:_0x534f72,is_anomaly:_0x3abf14,threshold:_0x554c4b,explanation:_0x2f3df3}=_0x59dbb0[_0x5750cb(0x1fb)];_0x5ccca3['log'][_0x5750cb(0x1f2)](_0x5750cb(0x1db)+_0x534f72[_0x5750cb(0x1cf)](0x5)+'\x20->\x20'+(_0x3abf14?_0x5750cb(0x1d6):'OK')),_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x200),{'val':_0x534f72,'ack':!![]}),_0x5ccca3['setStateAsync'](_0x5750cb(0x1c8),{'val':new Date()[_0x5750cb(0x1f1)](),'ack':!![]});if(_0x554c4b)_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x214),{'val':_0x554c4b,'ack':!![]});if(_0x3abf14){let _0x3d54ff=_0x5750cb(0x21c)+_0x534f72['toFixed'](0x4)+')';if(_0x2f3df3&&_0x2f3df3!==_0x5750cb(0x208))_0x3d54ff+='\x0aGrund:\x20'+_0x2f3df3;_0x5ccca3[_0x5750cb(0x1e3)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x5ccca3['setStateAsync'](_0x5750cb(0x211),{'val':_0x3d54ff,'ack':!![]}),setup[_0x5750cb(0x1c7)](_0x5ccca3,_0x5750cb(0x1dd)+_0x3d54ff,![],!![]);}}else{if(_0x59dbb0[_0x5750cb(0x21e)]==='TRAINING_COMPLETE'){const _0x5bf12d=_0x59dbb0['payload']['details']||'',_0x442db1=_0x59dbb0[_0x5750cb(0x1fb)]['threshold'],_0x489b48=_0x59dbb0[_0x5750cb(0x1fb)][_0x5750cb(0x1f8)]?'Success:\x20'+new Date()['toLocaleTimeString']()+'\x20('+_0x5bf12d+')':_0x5750cb(0x1d3)+_0x59dbb0[_0x5750cb(0x1fb)][_0x5750cb(0x1c6)];_0x5ccca3['setStateAsync'](_0x5750cb(0x1ee),{'val':_0x489b48,'ack':!![]});if(_0x59dbb0[_0x5750cb(0x1fb)][_0x5750cb(0x1f8)]&&_0x442db1)_0x5ccca3['setStateAsync'](_0x5750cb(0x214),{'val':_0x442db1,'ack':!![]});}else{if(_0x59dbb0['type']===_0x5750cb(0x219)){const {patterns:_0x3978b5}=_0x59dbb0[_0x5750cb(0x1fb)];if(_0x3978b5&&_0x3978b5['length']>0x0){_0x5ccca3[_0x5750cb(0x1ea)][_0x5750cb(0x1f2)](_0x5750cb(0x1ff)+_0x3978b5[_0x5750cb(0x1fa)]+_0x5750cb(0x1c9)),_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x201),{'val':JSON['stringify'](_0x3978b5),'ack':!![]});const _0x3a920b=_0x3978b5[0x0],_0x57473d=_0x5750cb(0x21b)+_0x3a920b[_0x5750cb(0x213)]+'\x20('+(_0x3a920b[_0x5750cb(0x1dc)]*0x64)[_0x5750cb(0x1cf)](0x0)+'%)';_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x21f),{'val':!![],'ack':!![]}),_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x1c5),{'val':_0x57473d,'ack':!![]});}else _0x5ccca3[_0x5750cb(0x1ea)][_0x5750cb(0x1f2)]('ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x21f),{'val':![],'ack':!![]}),_0x5ccca3[_0x5750cb(0x1e3)]('analysis.automation.detectedPatterns',{'val':'[]','ack':!![]});}else{if(_0x59dbb0[_0x5750cb(0x21e)]===_0x5750cb(0x215)){if(_0x59dbb0[_0x5750cb(0x1fb)][_0x5750cb(0x1f8)])try{const _0x1bcf8b=JSON[_0x5750cb(0x1f9)](_0x59dbb0['payload'][_0x5750cb(0x20d)]);if(_0x1bcf8b[_0x5750cb(0x20b)])_0x5ccca3[_0x5750cb(0x1e3)]('analysis.energy.insulationScore',{'val':JSON[_0x5750cb(0x1e4)](_0x1bcf8b[_0x5750cb(0x20b)]),'ack':!![]});if(_0x1bcf8b[_0x5750cb(0x1da)])_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x1d2),{'val':JSON[_0x5750cb(0x1e4)](_0x1bcf8b['heating']),'ack':!![]});}catch(_0x5875dd){}}else{if(_0x59dbb0[_0x5750cb(0x21e)]===_0x5750cb(0x1e5)){if(_0x59dbb0[_0x5750cb(0x1fb)][_0x5750cb(0x1f8)])_0x5ccca3[_0x5750cb(0x1ea)][_0x5750cb(0x1f2)](_0x5750cb(0x1e8));}else{if(_0x59dbb0[_0x5750cb(0x21e)]===_0x5750cb(0x1eb))_0x5ccca3['setStateAsync']('analysis.health.lastCheck',{'val':new Date()[_0x5750cb(0x1f1)](),'ack':!![]}),_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x1f7),{'val':_0x59dbb0[_0x5750cb(0x1fb)]['is_anomaly'],'ack':!![]});else{if(_0x59dbb0[_0x5750cb(0x21e)]===_0x5750cb(0x21a))_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x1d0),{'val':_0x59dbb0[_0x5750cb(0x1fb)][_0x5750cb(0x1ed)],'ack':!![]}),_0x5ccca3[_0x5750cb(0x1e3)]('analysis.health.trendValue',{'val':_0x59dbb0[_0x5750cb(0x1fb)]['change_percent'],'ack':!![]});else{if(_0x59dbb0['type']===_0x5750cb(0x20a)){const {speed_trend:_0x477554}=_0x59dbb0[_0x5750cb(0x1fb)];if(_0x477554!==undefined)_0x5ccca3['setStateAsync'](_0x5750cb(0x218),{'val':_0x477554,'ack':!![]});}else{if(_0x59dbb0[_0x5750cb(0x21e)]===_0x5750cb(0x1ce)){const {forecast:_0x287735}=_0x59dbb0['payload'];if(_0x287735)_0x5ccca3[_0x5750cb(0x1e3)]('analysis.energy.forecast',{'val':JSON[_0x5750cb(0x1e4)](_0x287735),'ack':!![]});}else{if(_0x59dbb0[_0x5750cb(0x21e)]==='TOPOLOGY_RESULT'){const {data:_0x387525}=_0x59dbb0['payload'];_0x387525&&(_0x5ccca3[_0x5750cb(0x1ea)]['info']('ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.'),_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x1ef),{'val':JSON['stringify'](_0x387525),'ack':!![]}));}else{if(_0x59dbb0[_0x5750cb(0x21e)]==='TOPOLOGY_ACK')_0x5ccca3[_0x5750cb(0x1ea)][_0x5750cb(0x1c4)](_0x5750cb(0x203));else{if(_0x59dbb0[_0x5750cb(0x21e)]===_0x5750cb(0x1fc)){const {room:_0x18ddcc,propagation:_0x377503}=_0x59dbb0[_0x5750cb(0x1fb)];let _0x55865c=_0x5750cb(0x208),_0x5cf1ee=0x0;if(_0x377503){const _0x34855a=Object[_0x5750cb(0x1f0)](_0x377503);_0x34855a[_0x5750cb(0x1fa)]>0x0&&(_0x55865c=_0x34855a[0x0][0x0],_0x5cf1ee=_0x34855a[0x0][0x1]);}_0x5ccca3[_0x5750cb(0x1e3)]('analysis.prediction.nextRoom',{'val':_0x55865c,'ack':!![]}),_0x5ccca3[_0x5750cb(0x1e3)](_0x5750cb(0x1fd),{'val':_0x5cf1ee,'ack':!![]}),_0x5cf1ee>0.4&&_0x5ccca3[_0x5750cb(0x1ea)][_0x5750cb(0x1c4)]('ðŸ”®\x20Prediction:\x20From\x20'+_0x18ddcc+_0x5750cb(0x1d9)+_0x55865c+'\x20('+(_0x5cf1ee*0x64)[_0x5750cb(0x1cf)](0x0)+'%)'),automation[_0x5750cb(0x212)](_0x5ccca3,_0x55865c,_0x5cf1ee);}}}}}}}}}}}}}}function startService(_0x533bf1,_0x2d367a){const _0x47d8f4=a4_0x29f063;let _0x1e3cf3=_0x47d8f4(0x1ca);if(fs['existsSync'](_0x2d367a))_0x1e3cf3=_0x2d367a;try{const _0x1afb9f=path[_0x47d8f4(0x1fe)](__dirname,'..',_0x47d8f4(0x1f6),_0x47d8f4(0x216));pythonProcess=spawn(_0x1e3cf3,[_0x1afb9f]),pythonProcess['stdout']['on']('data',_0x53663a=>{const _0x39a43f=_0x47d8f4,_0x597e7c=_0x53663a[_0x39a43f(0x1e6)]()[_0x39a43f(0x1cb)]('\x0a');_0x597e7c[_0x39a43f(0x1df)](_0x1249fc=>{const _0x51fd20=_0x39a43f,_0x2e23b7=_0x1249fc[_0x51fd20(0x204)]();if(!_0x2e23b7)return;if(_0x2e23b7[_0x51fd20(0x207)]('[LOG]'))_0x533bf1[_0x51fd20(0x1ea)][_0x51fd20(0x1c4)](_0x51fd20(0x217)+_0x2e23b7['substring'](0x5)[_0x51fd20(0x204)]());else{if(_0x2e23b7[_0x51fd20(0x207)](_0x51fd20(0x20c)))try{const _0x122101=JSON['parse'](_0x2e23b7[_0x51fd20(0x1e1)](0x8)[_0x51fd20(0x204)]());handleResult(_0x533bf1,_0x122101);}catch(_0x28b299){}}});}),pythonProcess['on'](_0x47d8f4(0x202),_0x4d8191=>{pythonProcess=null;}),_0x533bf1['sendToPythonWrapper']=(_0x420096,_0x4d23f2)=>send(_0x533bf1,_0x420096,_0x4d23f2);}catch(_0x20ee89){_0x533bf1[_0x47d8f4(0x1ea)][_0x47d8f4(0x1d8)](_0x47d8f4(0x1e2)+_0x20ee89[_0x47d8f4(0x1e0)]);}}function stopService(_0x44d8d0){const _0xcd3623=a4_0x29f063;if(pythonProcess){try{pythonProcess[_0xcd3623(0x20e)]();}catch(_0x565f47){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};