const a4_0x7e1550=a4_0x20d1;(function(_0x373ac3,_0xbcba1c){const _0x214f85=a4_0x20d1,_0x1fea3a=_0x373ac3();while(!![]){try{const _0x344cf1=parseInt(_0x214f85(0xdd))/0x1+parseInt(_0x214f85(0xec))/0x2*(-parseInt(_0x214f85(0xe0))/0x3)+parseInt(_0x214f85(0x9d))/0x4+-parseInt(_0x214f85(0xb6))/0x5+-parseInt(_0x214f85(0xcf))/0x6*(parseInt(_0x214f85(0xc5))/0x7)+parseInt(_0x214f85(0xca))/0x8*(-parseInt(_0x214f85(0xcd))/0x9)+-parseInt(_0x214f85(0xdc))/0xa*(-parseInt(_0x214f85(0xa8))/0xb);if(_0x344cf1===_0xbcba1c)break;else _0x1fea3a['push'](_0x1fea3a['shift']());}catch(_0x3d2fce){_0x1fea3a['push'](_0x1fea3a['shift']());}}}(a4_0x46d4,0x96913));const a4_0x156431=(function(){let _0x374e58=!![];return function(_0x3aca70,_0x1778ec){const _0x164c3e=_0x374e58?function(){const _0x57891f=a4_0x20d1;if(_0x1778ec){const _0x645348=_0x1778ec[_0x57891f(0xb2)](_0x3aca70,arguments);return _0x1778ec=null,_0x645348;}}:function(){};return _0x374e58=![],_0x164c3e;};}()),a4_0xc67448=a4_0x156431(this,function(){const _0x114fda=a4_0x20d1;return a4_0xc67448[_0x114fda(0xeb)]()[_0x114fda(0xd3)](_0x114fda(0xbc))['toString']()['constructor'](a4_0xc67448)['search'](_0x114fda(0xbc));});a4_0xc67448();'use strict';const {spawn}=require(a4_0x7e1550(0xc0)),path=require(a4_0x7e1550(0xe9)),fs=require('fs'),setup=require('./setup'),automation=require('./automation');let pythonProcess=null;function a4_0x20d1(_0x22574b,_0x42d1c0){const _0x350a0c=a4_0x46d4();return a4_0x20d1=function(_0xc67448,_0x156431){_0xc67448=_0xc67448-0x98;let _0x46d40a=_0x350a0c[_0xc67448];return _0x46d40a;},a4_0x20d1(_0x22574b,_0x42d1c0);}function send(_0x15c66c,_0x4b7f3e,_0x396897={}){const _0xd8ca06=a4_0x7e1550;if(!pythonProcess||!pythonProcess[_0xd8ca06(0xbb)][_0xd8ca06(0xc7)])return;const _0x216902=JSON[_0xd8ca06(0x9e)]({'command':_0x4b7f3e,..._0x396897});try{pythonProcess[_0xd8ca06(0xbb)]['write'](_0x216902+'\x0a');}catch(_0x575166){}}function handleResult(_0x1a3738,_0x285125){const _0x325b73=a4_0x7e1550;if(_0x285125[_0x325b73(0xbe)]===_0x325b73(0xa7))_0x1a3738[_0x325b73(0xbd)][_0x325b73(0xd5)](_0x325b73(0xb9));else{if(_0x285125[_0x325b73(0xbe)]==='SECURITY_RESULT'){const {anomaly_score:_0x592d98,is_anomaly:_0x40935b,threshold:_0x2105c2,explanation:_0x4d8f06}=_0x285125[_0x325b73(0xd6)];_0x1a3738[_0x325b73(0xc3)]('analysis.security.lastScore',{'val':_0x592d98,'ack':!![]}),_0x1a3738[_0x325b73(0xc3)](_0x325b73(0xc1),{'val':new Date()[_0x325b73(0xe4)](),'ack':!![]});if(_0x2105c2)_0x1a3738['setStateAsync'](_0x325b73(0xa3),{'val':_0x2105c2,'ack':!![]});if(_0x40935b){let _0x313114='Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x592d98[_0x325b73(0xd8)](0x4)+')';if(_0x4d8f06&&_0x4d8f06!==_0x325b73(0xc6))_0x313114+=_0x325b73(0xaa)+_0x4d8f06;_0x1a3738[_0x325b73(0xc3)](_0x325b73(0xe6),{'val':!![],'ack':!![]}),_0x1a3738[_0x325b73(0xc3)](_0x325b73(0x98),{'val':_0x313114,'ack':!![]}),setup[_0x325b73(0x9b)](_0x1a3738,_0x325b73(0xb3)+_0x313114,![],!![]);}}else{if(_0x285125[_0x325b73(0xbe)]==='TRAINING_COMPLETE'){const _0x3187ab=_0x285125[_0x325b73(0xd6)][_0x325b73(0xc2)]||'',_0x2a2728=_0x285125[_0x325b73(0xd6)][_0x325b73(0xd9)],_0x39228f=_0x285125[_0x325b73(0xd6)][_0x325b73(0xcb)]?_0x325b73(0xb8)+new Date()['toLocaleTimeString']()+'\x20('+_0x3187ab+')':_0x325b73(0xde)+_0x285125[_0x325b73(0xd6)]['reason'];_0x1a3738[_0x325b73(0xc3)](_0x325b73(0xe3),{'val':_0x39228f,'ack':!![]});if(_0x285125[_0x325b73(0xd6)][_0x325b73(0xcb)]&&_0x2a2728)_0x1a3738['setStateAsync'](_0x325b73(0xa3),{'val':_0x2a2728,'ack':!![]});}else{if(_0x285125[_0x325b73(0xbe)]==='ENERGY_TRAIN_RESULT'){if(_0x285125['payload']['success'])try{const _0x10df48=JSON[_0x325b73(0xda)](_0x285125[_0x325b73(0xd6)][_0x325b73(0xc2)]);if(_0x10df48['insulation'])_0x1a3738[_0x325b73(0xc3)](_0x325b73(0xad),{'val':JSON[_0x325b73(0x9e)](_0x10df48[_0x325b73(0xd0)]),'ack':!![]});if(_0x10df48[_0x325b73(0xe2)])_0x1a3738[_0x325b73(0xc3)](_0x325b73(0xa4),{'val':JSON[_0x325b73(0x9e)](_0x10df48[_0x325b73(0xe2)]),'ack':!![]});}catch(_0x4692a1){}}else{if(_0x285125[_0x325b73(0xbe)]===_0x325b73(0xe1)){if(_0x285125['payload'][_0x325b73(0xcb)])_0x1a3738[_0x325b73(0xbd)]['info']('‚úÖ\x20HEALTH\x20TRAINED.');}else{if(_0x285125[_0x325b73(0xbe)]===_0x325b73(0xd1))_0x1a3738[_0x325b73(0xc3)](_0x325b73(0xc8),{'val':new Date()[_0x325b73(0xe4)](),'ack':!![]}),_0x1a3738[_0x325b73(0xc3)](_0x325b73(0xa6),{'val':_0x285125['payload'][_0x325b73(0xea)],'ack':!![]});else{if(_0x285125[_0x325b73(0xbe)]===_0x325b73(0xb5)){const {speed_trend:_0x50cf22}=_0x285125[_0x325b73(0xd6)];if(_0x50cf22!==undefined)_0x1a3738[_0x325b73(0xc3)]('analysis.health.gaitSpeed',{'val':_0x50cf22,'ack':!![]});}else{if(_0x285125['type']===_0x325b73(0xcc)){const {forecast:_0x410af1}=_0x285125[_0x325b73(0xd6)];if(_0x410af1)_0x1a3738[_0x325b73(0xc3)]('analysis.energy.forecast',{'val':JSON[_0x325b73(0x9e)](_0x410af1),'ack':!![]});}else{if(_0x285125['type']===_0x325b73(0xe8)){const {proposals:_0x3917a7}=_0x285125[_0x325b73(0xd6)];_0x1a3738['getState'](_0x325b73(0xe5),(_0x4efbd0,_0x39894d)=>{const _0xca8804=_0x325b73;_0x39894d&&_0x39894d['val']===!![]&&_0x3917a7&&_0x3917a7[_0xca8804(0xb4)]>0x0&&automation[_0xca8804(0x9a)](_0x1a3738,_0x3917a7);});}else{if(_0x285125['type']===_0x325b73(0xb7)){const {room:_0x4cf20c,propagation:_0x9b0d5b}=_0x285125[_0x325b73(0xd6)];let _0x5787d2=_0x325b73(0xc6),_0x43fcf8=0x0;if(_0x9b0d5b){const _0x5f48b7=Object[_0x325b73(0xa1)](_0x9b0d5b);_0x5f48b7[_0x325b73(0xb4)]>0x0&&(_0x5787d2=_0x5f48b7[0x0][0x0],_0x43fcf8=_0x5f48b7[0x0][0x1]);}_0x1a3738['setStateAsync'](_0x325b73(0xa5),{'val':_0x5787d2,'ack':!![]}),_0x1a3738[_0x325b73(0xc3)]('analysis.prediction.confidence',{'val':_0x43fcf8,'ack':!![]}),automation[_0x325b73(0xac)](_0x1a3738,_0x5787d2,_0x43fcf8);}else{if(_0x285125[_0x325b73(0xbe)]===_0x325b73(0x9f)){const {patterns:_0x503b2b}=_0x285125['payload'];if(_0x503b2b&&_0x503b2b[_0x325b73(0xb4)]>0x0)_0x1a3738['setStateAsync'](_0x325b73(0xdf),{'val':JSON[_0x325b73(0x9e)](_0x503b2b),'ack':!![]});}}}}}}}}}}}}function startService(_0x2789bc,_0x2b15f6){const _0x36ae0a=a4_0x7e1550;let _0x1100fb=_0x36ae0a(0xba);if(fs[_0x36ae0a(0xbf)](_0x2b15f6))_0x1100fb=_0x2b15f6;try{const _0xb59136=path[_0x36ae0a(0x99)](__dirname,'..','python_service',_0x36ae0a(0xc9));pythonProcess=spawn(_0x1100fb,[_0xb59136]),pythonProcess[_0x36ae0a(0xa2)]['on'](_0x36ae0a(0xdb),_0x418a2c=>{const _0x27f0bb=_0x36ae0a,_0x2a9fe3=_0x418a2c[_0x27f0bb(0xeb)]()[_0x27f0bb(0xc4)]('\x0a');_0x2a9fe3[_0x27f0bb(0x9c)](_0x339cf4=>{const _0x2f69cd=_0x27f0bb,_0x5b802e=_0x339cf4[_0x2f69cd(0xd2)]();if(!_0x5b802e)return;if(_0x5b802e[_0x2f69cd(0xb0)]('[LOG]'))_0x2789bc[_0x2f69cd(0xbd)][_0x2f69cd(0xd5)](_0x2f69cd(0xb1)+_0x5b802e[_0x2f69cd(0xe7)](0x5)['trim']());else{if(_0x5b802e[_0x2f69cd(0xb0)](_0x2f69cd(0xaf)))try{const _0x4593db=JSON[_0x2f69cd(0xda)](_0x5b802e[_0x2f69cd(0xe7)](0x8)['trim']());handleResult(_0x2789bc,_0x4593db);}catch(_0x2e52cd){}}});}),pythonProcess['on'](_0x36ae0a(0xce),_0x100ac5=>{pythonProcess=null;}),_0x2789bc[_0x36ae0a(0xa0)]=(_0x583e8d,_0x10344f)=>send(_0x2789bc,_0x583e8d,_0x10344f);}catch(_0x8d424b){_0x2789bc[_0x36ae0a(0xbd)][_0x36ae0a(0xab)](_0x36ae0a(0xa9)+_0x8d424b[_0x36ae0a(0xae)]);}}function stopService(_0x1b0e5c){const _0x8cf57b=a4_0x7e1550;if(pythonProcess){try{pythonProcess[_0x8cf57b(0xd4)]();}catch(_0x3ba242){}pythonProcess=null;}}function a4_0x46d4(){const _0x3c75a0=['threshold','parse','data','39070hJSDpK','948396eWEEGj','Failed:\x20','analysis.automation.detectedPatterns','711435LBXpAp','HEALTH_TRAIN_RESULT','heating','analysis.training.status','toISOString','analysis.energy.mpcActive','analysis.isAlert','substring','ENERGY_OPTIMIZE_RESULT','path','is_anomaly','toString','6kgqLJK','analysis.alertReason','join','applyEnergySavings','sendNotification','forEach','866768szwmmB','stringify','COMFORT_RESULT','sendToPythonWrapper','entries','stdout','analysis.security.currentThreshold','analysis.energy.heatingScore','analysis.prediction.nextRoom','analysis.health.isAnomaly','PONG','5929pgRzpd','Error\x20launching\x20Python:\x20','\x0aGrund:\x20','error','handlePrediction','analysis.energy.insulationScore','message','[RESULT]','startsWith','[PYTHON]\x20','apply','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','length','GAIT_RESULT','4662300WcFXcc','SIGNAL_RESULT','Success:\x20','üêç\x20Python\x20Pong','python3','stdin','(((.+)+)+)+$','log','type','existsSync','child_process','analysis.security.lastCheck','details','setStateAsync','split','65919UgDqvK','Unknown','writable','analysis.health.lastCheck','service.py','48EwtgEN','success','ENERGY_PREDICT_RESULT','1444887RZkGRL','close','30mqMYxf','insulation','HEALTH_RESULT','trim','search','kill','debug','payload','exports','toFixed'];a4_0x46d4=function(){return _0x3c75a0;};return a4_0x46d4();}module[a4_0x7e1550(0xd7)]={'startService':startService,'stopService':stopService,'send':send};