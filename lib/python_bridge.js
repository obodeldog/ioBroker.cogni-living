const a4_0x1ed921=a4_0x1b90;(function(_0x4b42c3,_0x57f93c){const _0x31dd63=a4_0x1b90,_0x33cad8=_0x4b42c3();while(!![]){try{const _0x4f2a73=-parseInt(_0x31dd63(0xe9))/0x1+-parseInt(_0x31dd63(0xea))/0x2+parseInt(_0x31dd63(0x148))/0x3+parseInt(_0x31dd63(0x113))/0x4+-parseInt(_0x31dd63(0x11f))/0x5*(parseInt(_0x31dd63(0x11a))/0x6)+-parseInt(_0x31dd63(0x14b))/0x7+parseInt(_0x31dd63(0xf2))/0x8*(parseInt(_0x31dd63(0x162))/0x9);if(_0x4f2a73===_0x57f93c)break;else _0x33cad8['push'](_0x33cad8['shift']());}catch(_0x1eca85){_0x33cad8['push'](_0x33cad8['shift']());}}}(a4_0x4def,0x74048));const a4_0x4869b9=(function(){let _0x2df235=!![];return function(_0x335785,_0xe02c36){const _0x56688f=_0x2df235?function(){const _0x10face=a4_0x1b90;if(_0xe02c36){const _0x4e21d1=_0xe02c36[_0x10face(0x119)](_0x335785,arguments);return _0xe02c36=null,_0x4e21d1;}}:function(){};return _0x2df235=![],_0x56688f;};}()),a4_0x33c4f9=a4_0x4869b9(this,function(){const _0x4f80f2=a4_0x1b90;return a4_0x33c4f9[_0x4f80f2(0xe1)]()['search'](_0x4f80f2(0xe6))[_0x4f80f2(0xe1)]()[_0x4f80f2(0x105)](a4_0x33c4f9)[_0x4f80f2(0x11d)](_0x4f80f2(0xe6));});function a4_0x4def(){const _0x5dabd2=['VENTILATION_ALERT','error','penalties','is_anomaly','[PYTHON]\x20','normalizeRoomId','proof','startsWith','close','Error\x20launching\x20Python:\x20','reason','[Bridge-Debug]\x20Setting\x20Topology\x20Rooms\x20(Sample):\x20','PONG','debug','message','location','Success:\x20','type','GRAPH_TRAINED','insulation','SECURITY_RESULT','info','speed_trend','WARMUP_RESULT','monitored','sensors','SET_TOPOLOGY','analysis.prediction.trackerTopRoom','toLocaleTimeString','sources','path','ENERGY_OPTIMIZE_RESULT','PINN_PREDICT_RESULT','handlePrediction','1330305YjoEOR','[Bridge-Debug]\x20Raw\x20Sequence\x20[0]:\x20','write','5683559dnrmuE','analysis.prediction.confidence','rooms','heating','analysis.isAlert','analysis.energy.forecast','Failed:\x20','analysis.security.currentThreshold','service.py','log','TRAIN_SECURITY','isArray','room','[PYTHON\x20ERR]\x20','setStateAsync','string','analysis.health.gaitSpeed','stdin','HEALTH_TREND_RESULT','map','SIGNAL_RESULT','analysis.alertReason','parse','19956879zCmlMD','kill','analysis.health.activityTrend','sequences','writable','exports','stringify','success','analysis.energy.pinnForecast','val','Unknown','toString','substring','analysis.energy.warmupSources','./automation','analysis.prediction.nextRoom','(((.+)+)+)+$','\x0aGrund:\x20','entries','518650dsLRGr','1629520sONKrI','ðŸš€\x20Starting\x20Python\x20Bridge\x20using:\x20','alerts','HEALTH_TRAIN_RESULT','TRAINING_COMPLETE','ðŸ“ˆ\x20Health\x20Trend:\x20','\x20Rooms)','âŒ\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!','8zDzKMa','loc','applyEnergySavings','ðŸ\x20Python\x20Pong','analysis.health.isAnomaly','RL_PENALTY_UPDATE','COMFORT_RESULT','âš ï¸\x20SECURITY\x20ALARM:\x20','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','current_temps','child_process','warn','split','payload','analysis.energy.heatingScore','forecast','length','analysis.training.status','join','constructor','analysis.energy.warmupTimes','analysis.prediction.trackerConfidence','times','matrix','toFixed','existsSync','stderr','patterns','forEach','sendToPythonWrapper','details','stdout','analysis.security.topologyMatrix','1158220LbXGiF','ENERGY_TRAIN_RESULT','analysis.energy.ventilationAlerts','analysis.energy.warmupDetails','[LOG]','trim','apply','606pWDRZI','sendNotification','analysis.security.lastScore','search','...','16330VKAHVh','analysis.automation.detectedPatterns','analysis.security.lastCheck','TRAIN_TOPOLOGY','analysis.energy.mpcActive','[Bridge-Debug]\x20Normalized\x20Sequence\x20[0]\x20(Unpacked):\x20','HEALTH_RESULT'];a4_0x4def=function(){return _0x5dabd2;};return a4_0x4def();}function a4_0x1b90(_0x1feebe,_0x58c3a0){const _0x366913=a4_0x4def();return a4_0x1b90=function(_0x33c4f9,_0x4869b9){_0x33c4f9=_0x33c4f9-0xda;let _0x4def9c=_0x366913[_0x33c4f9];return _0x4def9c;},a4_0x1b90(_0x1feebe,_0x58c3a0);}a4_0x33c4f9();'use strict';const {spawn}=require(a4_0x1ed921(0xfc)),path=require(a4_0x1ed921(0x144)),fs=require('fs'),setup=require('./setup'),automation=require(a4_0x1ed921(0xe4));let pythonProcess=null;function send(_0x9e65a6,_0x455fd6,_0x1d90c4={}){const _0x54de15=a4_0x1ed921;if(!pythonProcess||!pythonProcess[_0x54de15(0x15c)][_0x54de15(0xda)])return;if(_0x455fd6===_0x54de15(0x140)){const _0x1d620b=JSON['parse'](JSON[_0x54de15(0xdc)](_0x1d90c4));_0x1d620b[_0x54de15(0x14d)]&&Array['isArray'](_0x1d620b['rooms'])&&(_0x1d620b[_0x54de15(0x14d)]=_0x1d620b[_0x54de15(0x14d)][_0x54de15(0x15e)](_0x4d7db8=>setup['normalizeRoomId'](_0x4d7db8)),_0x9e65a6[_0x54de15(0x154)]['info'](_0x54de15(0x131)+_0x1d620b['rooms']['slice'](0x0,0x3)[_0x54de15(0x104)](',\x20')+_0x54de15(0x11e))),_0x1d620b[_0x54de15(0x13e)]&&Array[_0x54de15(0x156)](_0x1d620b['monitored'])&&(_0x1d620b['monitored']=_0x1d620b[_0x54de15(0x13e)][_0x54de15(0x15e)](_0x3275ce=>setup['normalizeRoomId'](_0x3275ce))),_0x1d90c4=_0x1d620b;}if((_0x455fd6===_0x54de15(0x122)||_0x455fd6===_0x54de15(0x155))&&_0x1d90c4[_0x54de15(0x165)]){if(Array['isArray'](_0x1d90c4[_0x54de15(0x165)]))try{_0x1d90c4[_0x54de15(0x165)][_0x54de15(0x102)]>0x0&&_0x9e65a6[_0x54de15(0x154)]['debug'](_0x54de15(0x149)+JSON['stringify'](_0x1d90c4[_0x54de15(0x165)][0x0])[_0x54de15(0xe2)](0x0,0x64)+_0x54de15(0x11e)),_0x1d90c4[_0x54de15(0x165)]=_0x1d90c4[_0x54de15(0x165)][_0x54de15(0x15e)](_0x49e753=>{const _0x10d21e=_0x54de15;if(_0x49e753&&_0x49e753['steps']&&Array[_0x10d21e(0x156)](_0x49e753['steps']))return _0x49e753['steps'][_0x10d21e(0x15e)](_0x49b182=>{const _0xfdc1d2=_0x10d21e,_0x2a4f22=_0x49b182[_0xfdc1d2(0xf3)]||_0x49b182[_0xfdc1d2(0x135)]||_0x49b182;return setup[_0xfdc1d2(0x12b)](_0x2a4f22);});else{if(Array['isArray'](_0x49e753))return _0x49e753[_0x10d21e(0x15e)](_0x3ca374=>setup['normalizeRoomId'](_0x3ca374));}return[];}),_0x1d90c4[_0x54de15(0x165)][_0x54de15(0x102)]>0x0&&_0x9e65a6[_0x54de15(0x154)][_0x54de15(0x13b)](_0x54de15(0x124)+JSON[_0x54de15(0xdc)](_0x1d90c4[_0x54de15(0x165)][0x0]));}catch(_0x4d2196){_0x9e65a6[_0x54de15(0x154)][_0x54de15(0xfd)]('Gateway\x20Unpack\x20Error:\x20'+_0x4d2196[_0x54de15(0x134)]),_0x1d90c4[_0x54de15(0x165)]=[];}else _0x1d90c4[_0x54de15(0x165)]=[];}_0x1d90c4[_0x54de15(0x157)]&&typeof _0x1d90c4[_0x54de15(0x157)]===_0x54de15(0x15a)&&(_0x1d90c4['room']=setup['normalizeRoomId'](_0x1d90c4['room']));if(_0x1d90c4['current_temps']&&typeof _0x1d90c4[_0x54de15(0xfb)]==='object'){const _0x21321f={};for(const [_0x4622b7,_0x1b1a41]of Object[_0x54de15(0xe8)](_0x1d90c4['current_temps']))_0x21321f[setup['normalizeRoomId'](_0x4622b7)]=_0x1b1a41;_0x1d90c4[_0x54de15(0xfb)]=_0x21321f;}const _0x21d4f1=JSON['stringify']({'command':_0x455fd6,..._0x1d90c4});try{pythonProcess[_0x54de15(0x15c)][_0x54de15(0x14a)](_0x21d4f1+'\x0a');}catch(_0x5a4789){}}function handleResult(_0x407735,_0x15264c){const _0xa135ef=a4_0x1ed921;if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x132))_0x407735[_0xa135ef(0x154)][_0xa135ef(0x133)](_0xa135ef(0xf5));else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x13a)){const {anomaly_score:_0x1e8eaf,is_anomaly:_0x30c251,threshold:_0x20a8ac,explanation:_0x3c02f9}=_0x15264c[_0xa135ef(0xff)];_0x407735[_0xa135ef(0x159)](_0xa135ef(0x11c),{'val':_0x1e8eaf,'ack':!![]}),_0x407735[_0xa135ef(0x159)](_0xa135ef(0x121),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x20a8ac)_0x407735[_0xa135ef(0x159)](_0xa135ef(0x152),{'val':_0x20a8ac,'ack':!![]});if(_0x30c251){let _0x332ce4=_0xa135ef(0xfa)+_0x1e8eaf[_0xa135ef(0x10a)](0x4)+')';if(_0x3c02f9&&_0x3c02f9!==_0xa135ef(0xe0))_0x332ce4+=_0xa135ef(0xe7)+_0x3c02f9;_0x407735[_0xa135ef(0x159)](_0xa135ef(0x14f),{'val':!![],'ack':!![]}),_0x407735[_0xa135ef(0x159)](_0xa135ef(0x160),{'val':_0x332ce4,'ack':!![]}),setup[_0xa135ef(0x11b)](_0x407735,_0xa135ef(0xf9)+_0x332ce4,![],!![]);}}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0xee)){const _0x589118=_0x15264c[_0xa135ef(0xff)]['details']||'',_0x40d786=_0x15264c['payload']['threshold'],_0x9219ac=_0x15264c[_0xa135ef(0xff)][_0xa135ef(0xdd)]?_0xa135ef(0x136)+new Date()[_0xa135ef(0x142)]()+'\x20('+_0x589118+')':_0xa135ef(0x151)+_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x130)];_0x407735[_0xa135ef(0x159)](_0xa135ef(0x103),{'val':_0x9219ac,'ack':!![]});if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0xdd)]&&_0x40d786)_0x407735[_0xa135ef(0x159)](_0xa135ef(0x152),{'val':_0x40d786,'ack':!![]});}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x138)){const _0x5f1d6a='Graph\x20Updated\x20('+_0x15264c['payload'][_0xa135ef(0x14d)][_0xa135ef(0x102)]+_0xa135ef(0xf0);_0x407735[_0xa135ef(0x159)]('analysis.training.status',{'val':_0x5f1d6a,'ack':!![]}),_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x109)]&&_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x14d)]&&_0x407735[_0xa135ef(0x159)](_0xa135ef(0x112),{'val':JSON[_0xa135ef(0xdc)](_0x15264c[_0xa135ef(0xff)]),'ack':!![]});}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x114)){if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0xdd)])try{const _0x3251ca=JSON[_0xa135ef(0x161)](_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x110)]);if(_0x3251ca[_0xa135ef(0x139)])_0x407735[_0xa135ef(0x159)]('analysis.energy.insulationScore',{'val':JSON['stringify'](_0x3251ca[_0xa135ef(0x139)]),'ack':!![]});if(_0x3251ca[_0xa135ef(0x14e)])_0x407735[_0xa135ef(0x159)](_0xa135ef(0x100),{'val':JSON[_0xa135ef(0xdc)](_0x3251ca['heating']),'ack':!![]});}catch(_0x2074fc){}}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0xed))_0x407735['log'][_0xa135ef(0x13b)]('âœ…\x20HEALTH\x20TRAINED.'),_0x407735['setStateAsync']('analysis.health.lastCheck',{'val':new Date()['toLocaleDateString'](),'ack':!![]});else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x125))_0x407735[_0xa135ef(0x159)](_0xa135ef(0xf6),{'val':_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x129)],'ack':!![]});else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x15d))_0x407735[_0xa135ef(0x159)](_0xa135ef(0x164),{'val':_0x15264c[_0xa135ef(0xff)]['trend_percent'],'ack':!![]}),_0x407735[_0xa135ef(0x154)]['info'](_0xa135ef(0xef)+_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x110)]);else{if(_0x15264c[_0xa135ef(0x137)]==='GAIT_RESULT'){if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x13c)]!==undefined)_0x407735[_0xa135ef(0x159)](_0xa135ef(0x15b),{'val':_0x15264c['payload']['speed_trend'],'ack':!![]});if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x13f)])_0x407735['setStateAsync']('analysis.health.gaitSensors',{'val':_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x13f)][_0xa135ef(0x104)](',\x20'),'ack':!![]});if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x12c)])_0x407735['setStateAsync']('analysis.health.gaitDebug',{'val':_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x12c)],'ack':!![]});}else{if(_0x15264c[_0xa135ef(0x137)]==='ENERGY_PREDICT_RESULT'){if(_0x15264c[_0xa135ef(0xff)]['forecast'])_0x407735[_0xa135ef(0x159)](_0xa135ef(0x150),{'val':JSON['stringify'](_0x15264c[_0xa135ef(0xff)]['forecast']),'ack':!![]});}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x13d)){if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x108)])_0x407735[_0xa135ef(0x159)](_0xa135ef(0x106),{'val':JSON[_0xa135ef(0xdc)](_0x15264c[_0xa135ef(0xff)]['times']),'ack':!![]});if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x143)])_0x407735[_0xa135ef(0x159)](_0xa135ef(0xe3),{'val':JSON[_0xa135ef(0xdc)](_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x143)]),'ack':!![]});if(_0x15264c[_0xa135ef(0xff)]['details'])_0x407735[_0xa135ef(0x159)](_0xa135ef(0x116),{'val':JSON[_0xa135ef(0xdc)](_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x110)]),'ack':!![]});}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0xf7)){if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x128)])_0x407735[_0xa135ef(0x159)]('analysis.energy.rlPenalties',{'val':JSON[_0xa135ef(0xdc)](_0x15264c['payload']['penalties']),'ack':!![]});}else{if(_0x15264c['type']===_0xa135ef(0x146)){if(_0x15264c[_0xa135ef(0xff)]['forecast'])_0x407735[_0xa135ef(0x159)](_0xa135ef(0xde),{'val':JSON['stringify'](_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x101)]),'ack':!![]});}else{if(_0x15264c['type']===_0xa135ef(0x126)){if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0xec)])_0x407735[_0xa135ef(0x159)](_0xa135ef(0x115),{'val':JSON[_0xa135ef(0xdc)](_0x15264c[_0xa135ef(0xff)][_0xa135ef(0xec)]),'ack':!![]});}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x145)){const {proposals:_0x4e09b6}=_0x15264c[_0xa135ef(0xff)];_0x407735['getState'](_0xa135ef(0x123),(_0x2ccf5e,_0x163b31)=>{const _0x9c12b3=_0xa135ef;if(_0x163b31&&_0x163b31[_0x9c12b3(0xdf)]===!![]&&_0x4e09b6&&_0x4e09b6['length']>0x0)automation[_0x9c12b3(0xf4)](_0x407735,_0x4e09b6);});}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0x15f)){const {propagation:_0x5f0760}=_0x15264c[_0xa135ef(0xff)];let _0xaefc84='Unknown',_0x545bc8=0x0;if(_0x5f0760){const _0x535798=Object[_0xa135ef(0xe8)](_0x5f0760);_0x535798[_0xa135ef(0x102)]>0x0&&(_0xaefc84=_0x535798[0x0][0x0],_0x545bc8=_0x535798[0x0][0x1]);}_0x407735[_0xa135ef(0x159)](_0xa135ef(0xe5),{'val':_0xaefc84,'ack':!![]}),_0x407735[_0xa135ef(0x159)](_0xa135ef(0x14c),{'val':_0x545bc8,'ack':!![]}),automation[_0xa135ef(0x147)](_0x407735,_0xaefc84,_0x545bc8);}else{if(_0x15264c[_0xa135ef(0x137)]==='TRACKER_RESULT'){const {probabilities:_0xc752a6}=_0x15264c[_0xa135ef(0xff)];if(_0xc752a6){_0x407735[_0xa135ef(0x159)]('analysis.prediction.trackerState',{'val':JSON[_0xa135ef(0xdc)](_0xc752a6),'ack':!![]});const _0x4f652d=Object['keys'](_0xc752a6);_0x4f652d[_0xa135ef(0x102)]>0x0&&(_0x407735[_0xa135ef(0x159)](_0xa135ef(0x141),{'val':_0x4f652d[0x0],'ack':!![]}),_0x407735[_0xa135ef(0x159)](_0xa135ef(0x107),{'val':_0xc752a6[_0x4f652d[0x0]],'ack':!![]}));}}else{if(_0x15264c[_0xa135ef(0x137)]===_0xa135ef(0xf8)){if(_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x10d)])_0x407735['setStateAsync'](_0xa135ef(0x120),{'val':JSON[_0xa135ef(0xdc)](_0x15264c[_0xa135ef(0xff)][_0xa135ef(0x10d)]),'ack':!![]});}}}}}}}}}}}}}}}}}}}function startService(_0x583153,_0x503460){const _0x421695=a4_0x1ed921;let _0x2a795a='python3';if(fs[_0x421695(0x10b)](_0x503460))_0x2a795a=_0x503460;const _0x5bdc0e=path['join'](__dirname,'..',_0x421695(0x153)),_0xfa8834=path[_0x421695(0x104)](__dirname,'..','python_service',_0x421695(0x153));let _0x4f423e=fs['existsSync'](_0x5bdc0e)?_0x5bdc0e:fs['existsSync'](_0xfa8834)?_0xfa8834:null;if(!_0x4f423e){_0x583153[_0x421695(0x154)][_0x421695(0x127)](_0x421695(0xf1));return;}try{_0x583153['log'][_0x421695(0x13b)](_0x421695(0xeb)+_0x2a795a+'\x20'+_0x4f423e),pythonProcess=spawn(_0x2a795a,[_0x4f423e]),pythonProcess[_0x421695(0x111)]['on']('data',_0x2dc259=>{const _0x2e0b98=_0x421695,_0x55b257=_0x2dc259['toString']()[_0x2e0b98(0xfe)]('\x0a');_0x55b257[_0x2e0b98(0x10e)](_0x2cb8f6=>{const _0x4c464b=_0x2e0b98,_0x35573b=_0x2cb8f6['trim']();if(!_0x35573b)return;if(_0x35573b[_0x4c464b(0x12d)](_0x4c464b(0x117)))_0x583153[_0x4c464b(0x154)][_0x4c464b(0x133)](_0x4c464b(0x12a)+_0x35573b[_0x4c464b(0xe2)](0x5)[_0x4c464b(0x118)]());else{if(_0x35573b['startsWith']('[RESULT]'))try{const _0xab8e50=JSON[_0x4c464b(0x161)](_0x35573b[_0x4c464b(0xe2)](0x8)['trim']());handleResult(_0x583153,_0xab8e50);}catch(_0x1f1759){}}});}),pythonProcess[_0x421695(0x10c)]['on']('data',_0x173d46=>{const _0x28400a=_0x421695;_0x583153[_0x28400a(0x154)][_0x28400a(0x127)](_0x28400a(0x158)+_0x173d46[_0x28400a(0xe1)]()[_0x28400a(0x118)]());}),pythonProcess['on'](_0x421695(0x12e),_0x194a7c=>{const _0x9a0c8c=_0x421695;_0x583153[_0x9a0c8c(0x154)][_0x9a0c8c(0xfd)]('Python\x20process\x20exited\x20with\x20code\x20'+_0x194a7c),pythonProcess=null;}),_0x583153[_0x421695(0x10f)]=(_0x56bfbc,_0x1be7f2)=>send(_0x583153,_0x56bfbc,_0x1be7f2);}catch(_0x5049c4){_0x583153[_0x421695(0x154)][_0x421695(0x127)](_0x421695(0x12f)+_0x5049c4['message']);}}function stopService(_0x5c6d1c){const _0x3d5a8e=a4_0x1ed921;if(pythonProcess){try{pythonProcess[_0x3d5a8e(0x163)]();}catch(_0x323275){}pythonProcess=null;}}module[a4_0x1ed921(0xdb)]={'startService':startService,'stopService':stopService,'send':send};