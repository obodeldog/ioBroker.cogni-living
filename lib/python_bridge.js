const a4_0x3d3cbc=a4_0x2abc;(function(_0x51f40b,_0x8e03ac){const _0x249bb7=a4_0x2abc,_0x37b6d8=_0x51f40b();while(!![]){try{const _0x101d9d=parseInt(_0x249bb7(0x1d5))/0x1+-parseInt(_0x249bb7(0x228))/0x2*(parseInt(_0x249bb7(0x1e7))/0x3)+-parseInt(_0x249bb7(0x1f1))/0x4*(parseInt(_0x249bb7(0x1e2))/0x5)+-parseInt(_0x249bb7(0x1cf))/0x6+-parseInt(_0x249bb7(0x1f0))/0x7*(parseInt(_0x249bb7(0x218))/0x8)+-parseInt(_0x249bb7(0x1ff))/0x9+parseInt(_0x249bb7(0x222))/0xa;if(_0x101d9d===_0x8e03ac)break;else _0x37b6d8['push'](_0x37b6d8['shift']());}catch(_0x5c5e51){_0x37b6d8['push'](_0x37b6d8['shift']());}}}(a4_0x4ba4,0x84459));const a4_0xa4de3b=(function(){let _0x19fa35=!![];return function(_0x2c34ce,_0x1c5145){const _0x2f0ef5=_0x19fa35?function(){const _0x3a18ec=a4_0x2abc;if(_0x1c5145){const _0x5e443b=_0x1c5145[_0x3a18ec(0x215)](_0x2c34ce,arguments);return _0x1c5145=null,_0x5e443b;}}:function(){};return _0x19fa35=![],_0x2f0ef5;};}()),a4_0x38cff4=a4_0xa4de3b(this,function(){const _0xf610a2=a4_0x2abc;return a4_0x38cff4[_0xf610a2(0x21a)]()[_0xf610a2(0x1c7)](_0xf610a2(0x1dd))[_0xf610a2(0x21a)]()[_0xf610a2(0x22a)](a4_0x38cff4)[_0xf610a2(0x1c7)](_0xf610a2(0x1dd));});a4_0x38cff4();'use strict';const {spawn}=require('child_process'),path=require('path'),fs=require('fs'),setup=require(a4_0x3d3cbc(0x1f7)),automation=require(a4_0x3d3cbc(0x1ce));let pythonProcess=null;function send(_0x104579,_0x886810,_0x15f57c={}){const _0x33eb50=a4_0x3d3cbc;if(!pythonProcess||!pythonProcess[_0x33eb50(0x201)][_0x33eb50(0x214)])return;const _0x8b28cd=JSON['stringify']({'command':_0x886810,..._0x15f57c});try{pythonProcess[_0x33eb50(0x201)]['write'](_0x8b28cd+'\x0a');}catch(_0x3dcca2){}}function handleResult(_0x5e3b32,_0x48ae27){const _0x419497=a4_0x3d3cbc;if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x1db))_0x5e3b32[_0x419497(0x1f2)]['debug'](_0x419497(0x210));else{if(_0x48ae27[_0x419497(0x1d2)]==='SECURITY_RESULT'){const {anomaly_score:_0x231936,is_anomaly:_0x1bd781,threshold:_0x3b8fb2,explanation:_0xe4023b}=_0x48ae27[_0x419497(0x1f9)];_0x5e3b32['setStateAsync'](_0x419497(0x1c8),{'val':_0x231936,'ack':!![]}),_0x5e3b32[_0x419497(0x22c)](_0x419497(0x227),{'val':new Date()[_0x419497(0x1d6)](),'ack':!![]});if(_0x3b8fb2)_0x5e3b32[_0x419497(0x22c)](_0x419497(0x211),{'val':_0x3b8fb2,'ack':!![]});if(_0x1bd781){let _0x76e9bf=_0x419497(0x1e9)+_0x231936[_0x419497(0x1ea)](0x4)+')';if(_0xe4023b&&_0xe4023b!=='Unknown')_0x76e9bf+='\x0aGrund:\x20'+_0xe4023b;_0x5e3b32[_0x419497(0x22c)](_0x419497(0x22b),{'val':!![],'ack':!![]}),_0x5e3b32[_0x419497(0x22c)](_0x419497(0x216),{'val':_0x76e9bf,'ack':!![]}),setup[_0x419497(0x200)](_0x5e3b32,_0x419497(0x231)+_0x76e9bf,![],!![]);}}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x1fa)){const _0x1e1e1e=_0x48ae27['payload'][_0x419497(0x232)]||'',_0x56dce3=_0x48ae27[_0x419497(0x1f9)]['threshold'],_0x231ee7=_0x48ae27[_0x419497(0x1f9)][_0x419497(0x1c9)]?_0x419497(0x225)+new Date()[_0x419497(0x1d7)]()+'\x20('+_0x1e1e1e+')':_0x419497(0x1fe)+_0x48ae27[_0x419497(0x1f9)][_0x419497(0x22f)];_0x5e3b32['setStateAsync']('analysis.training.status',{'val':_0x231ee7,'ack':!![]});if(_0x48ae27[_0x419497(0x1f9)][_0x419497(0x1c9)]&&_0x56dce3)_0x5e3b32['setStateAsync']('analysis.security.currentThreshold',{'val':_0x56dce3,'ack':!![]});}else{if(_0x48ae27['type']===_0x419497(0x21e)){if(_0x48ae27[_0x419497(0x1f9)][_0x419497(0x1c9)])try{const _0xa50cd7=JSON[_0x419497(0x1ec)](_0x48ae27['payload'][_0x419497(0x232)]);if(_0xa50cd7[_0x419497(0x235)])_0x5e3b32['setStateAsync'](_0x419497(0x1d4),{'val':JSON[_0x419497(0x230)](_0xa50cd7[_0x419497(0x235)]),'ack':!![]});if(_0xa50cd7[_0x419497(0x1f6)])_0x5e3b32[_0x419497(0x22c)](_0x419497(0x236),{'val':JSON[_0x419497(0x230)](_0xa50cd7[_0x419497(0x1f6)]),'ack':!![]});}catch(_0x4b0edc){}}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x1d0)){if(_0x48ae27[_0x419497(0x1f9)][_0x419497(0x1c9)]){_0x5e3b32['log'][_0x419497(0x1f3)](_0x419497(0x21b));const _0x5ddba2=new Date(),_0xb3372a=_0x5ddba2[_0x419497(0x229)](_0x419497(0x203),{'day':_0x419497(0x21d),'month':_0x419497(0x224),'hour':_0x419497(0x21d),'minute':_0x419497(0x21d)});_0x5e3b32[_0x419497(0x22c)](_0x419497(0x1d9),{'val':_0xb3372a,'ack':!![]});}}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x1df)){const _0x393edf=new Date(),_0x35a325=_0x393edf[_0x419497(0x229)](_0x419497(0x203),{'day':_0x419497(0x21d),'month':_0x419497(0x224),'hour':'2-digit','minute':'2-digit'});_0x5e3b32[_0x419497(0x22c)](_0x419497(0x1d9),{'val':_0x35a325,'ack':!![]}),_0x5e3b32[_0x419497(0x22c)](_0x419497(0x220),{'val':_0x48ae27[_0x419497(0x1f9)][_0x419497(0x207)],'ack':!![]});}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x204)){const {trend_percent:_0x2458f8,details:_0x1ed776}=_0x48ae27[_0x419497(0x1f9)],_0x1e2ec5=new Date(),_0x35a542=_0x1e2ec5['toLocaleDateString']('de-DE',{'day':_0x419497(0x21d),'month':_0x419497(0x224),'hour':_0x419497(0x21d),'minute':_0x419497(0x21d)});_0x5e3b32[_0x419497(0x22c)](_0x419497(0x1d9),{'val':_0x35a542,'ack':!![]}),_0x5e3b32[_0x419497(0x22c)]('analysis.health.activityTrend',{'val':_0x2458f8,'ack':!![]}),_0x5e3b32[_0x419497(0x1f2)][_0x419497(0x1f3)]('üìà\x20Health\x20Trend:\x20'+_0x1ed776);}else{if(_0x48ae27['type']==='GAIT_RESULT'){const {speed_trend:_0x219c2c,sensors:_0x211664,proof:_0x392ecc}=_0x48ae27['payload'];if(_0x219c2c!==undefined)_0x5e3b32['setStateAsync'](_0x419497(0x1e8),{'val':_0x219c2c,'ack':!![]});if(_0x211664&&Array[_0x419497(0x1cc)](_0x211664))_0x5e3b32[_0x419497(0x22c)]('analysis.health.gaitSensors',{'val':_0x211664[_0x419497(0x209)](',\x20'),'ack':!![]});if(_0x392ecc)_0x5e3b32[_0x419497(0x22c)]('analysis.health.gaitDebug',{'val':_0x392ecc,'ack':!![]});}else{if(_0x48ae27['type']==='ENERGY_PREDICT_RESULT'){const {forecast:_0x19b537}=_0x48ae27[_0x419497(0x1f9)];if(_0x19b537)_0x5e3b32[_0x419497(0x22c)](_0x419497(0x1e6),{'val':JSON[_0x419497(0x230)](_0x19b537),'ack':!![]});}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x206)){const {times:_0x49084f,sources:_0x1a4a76,details:_0x2312fc}=_0x48ae27[_0x419497(0x1f9)];if(_0x49084f)_0x5e3b32['setStateAsync'](_0x419497(0x20f),{'val':JSON[_0x419497(0x230)](_0x49084f),'ack':!![]});if(_0x1a4a76)_0x5e3b32[_0x419497(0x22c)](_0x419497(0x21c),{'val':JSON['stringify'](_0x1a4a76),'ack':!![]});if(_0x2312fc)_0x5e3b32[_0x419497(0x22c)](_0x419497(0x1f8),{'val':JSON[_0x419497(0x230)](_0x2312fc),'ack':!![]});}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x20e)){const {penalties:_0x21b021}=_0x48ae27['payload'];if(_0x21b021)_0x5e3b32[_0x419497(0x22c)](_0x419497(0x221),{'val':JSON[_0x419497(0x230)](_0x21b021),'ack':!![]});}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x1f4)){const {forecast:_0x259191}=_0x48ae27[_0x419497(0x1f9)];if(_0x259191)_0x5e3b32[_0x419497(0x22c)](_0x419497(0x20a),{'val':JSON[_0x419497(0x230)](_0x259191),'ack':!![]});}else{if(_0x48ae27[_0x419497(0x1d2)]==='VENTILATION_ALERT'){const {alerts:_0xdf1b46}=_0x48ae27[_0x419497(0x1f9)];if(_0xdf1b46)_0x5e3b32[_0x419497(0x22c)](_0x419497(0x1ee),{'val':JSON['stringify'](_0xdf1b46),'ack':!![]});}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x20d)){const {proposals:_0x453cc7}=_0x48ae27[_0x419497(0x1f9)];_0x5e3b32[_0x419497(0x1ed)](_0x419497(0x226),(_0x1114cd,_0x178789)=>{const _0x5a1d9a=_0x419497;_0x178789&&_0x178789[_0x5a1d9a(0x21f)]===!![]&&_0x453cc7&&_0x453cc7[_0x5a1d9a(0x213)]>0x0&&automation['applyEnergySavings'](_0x5e3b32,_0x453cc7);});}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x1fc)){const {room:_0x4cd6b1,propagation:_0x509e07}=_0x48ae27[_0x419497(0x1f9)];let _0x35cb30='Unknown',_0x555fbb=0x0;if(_0x509e07){const _0x10a9b1=Object['entries'](_0x509e07);_0x10a9b1[_0x419497(0x213)]>0x0&&(_0x35cb30=_0x10a9b1[0x0][0x0],_0x555fbb=_0x10a9b1[0x0][0x1]);}_0x5e3b32[_0x419497(0x22c)](_0x419497(0x20b),{'val':_0x35cb30,'ack':!![]}),_0x5e3b32[_0x419497(0x22c)](_0x419497(0x1ef),{'val':_0x555fbb,'ack':!![]}),automation['handlePrediction'](_0x5e3b32,_0x35cb30,_0x555fbb);}else{if(_0x48ae27['type']===_0x419497(0x1fb)){const {probabilities:_0x18c784}=_0x48ae27[_0x419497(0x1f9)];if(_0x18c784){_0x5e3b32[_0x419497(0x22c)](_0x419497(0x205),{'val':JSON[_0x419497(0x230)](_0x18c784),'ack':!![]});const _0x3df561=Object[_0x419497(0x1e0)](_0x18c784);if(_0x3df561[_0x419497(0x213)]>0x0){const _0x4c0a95=_0x3df561[0x0],_0x591086=_0x18c784[_0x4c0a95];_0x5e3b32[_0x419497(0x22c)](_0x419497(0x1e3),{'val':_0x4c0a95,'ack':!![]}),_0x5e3b32[_0x419497(0x22c)](_0x419497(0x217),{'val':_0x591086,'ack':!![]});}}}else{if(_0x48ae27[_0x419497(0x1d2)]===_0x419497(0x208)){const {patterns:_0x599ba1}=_0x48ae27[_0x419497(0x1f9)];if(_0x599ba1&&_0x599ba1['length']>0x0)_0x5e3b32['setStateAsync'](_0x419497(0x1da),{'val':JSON['stringify'](_0x599ba1),'ack':!![]});}}}}}}}}}}}}}}}}}}function startService(_0x54f8ec,_0x1244a7){const _0x414be0=a4_0x3d3cbc;let _0x53a6c9=_0x414be0(0x212);if(fs[_0x414be0(0x22e)](_0x1244a7))_0x53a6c9=_0x1244a7;const _0x730ac1=path[_0x414be0(0x209)](__dirname,'..',_0x414be0(0x223)),_0x2d2752=path[_0x414be0(0x209)](__dirname,'..','python_service',_0x414be0(0x223));let _0x4813bb='';if(fs[_0x414be0(0x22e)](_0x730ac1))_0x4813bb=_0x730ac1;else{if(fs[_0x414be0(0x22e)](_0x2d2752))_0x4813bb=_0x2d2752;else{_0x54f8ec['log'][_0x414be0(0x1e5)](_0x414be0(0x202)+_0x730ac1+'\x20AND\x20'+_0x2d2752+_0x414be0(0x219));return;}}try{_0x54f8ec['log']['info'](_0x414be0(0x20c)+_0x53a6c9+'\x20'+_0x4813bb),pythonProcess=spawn(_0x53a6c9,[_0x4813bb]),pythonProcess[_0x414be0(0x1e1)]['on'](_0x414be0(0x1de),_0x4736c8=>{const _0x42a538=_0x414be0,_0xc38765=_0x4736c8[_0x42a538(0x21a)]()[_0x42a538(0x1cd)]('\x0a');_0xc38765[_0x42a538(0x234)](_0x3da1e3=>{const _0x35e3c1=_0x42a538,_0x4c07e2=_0x3da1e3['trim']();if(!_0x4c07e2)return;if(_0x4c07e2[_0x35e3c1(0x22d)](_0x35e3c1(0x1d3)))_0x54f8ec[_0x35e3c1(0x1f2)][_0x35e3c1(0x1d8)](_0x35e3c1(0x1dc)+_0x4c07e2[_0x35e3c1(0x1ca)](0x5)[_0x35e3c1(0x1f5)]());else{if(_0x4c07e2[_0x35e3c1(0x22d)]('[RESULT]'))try{const _0x935148=JSON[_0x35e3c1(0x1ec)](_0x4c07e2[_0x35e3c1(0x1ca)](0x8)['trim']());handleResult(_0x54f8ec,_0x935148);}catch(_0x3d735d){}}});}),pythonProcess[_0x414be0(0x1d1)]['on'](_0x414be0(0x1de),_0x59c4d3=>{const _0x38111b=_0x414be0;_0x54f8ec[_0x38111b(0x1f2)][_0x38111b(0x1e5)]('[PYTHON\x20ERR]\x20'+_0x59c4d3['toString']()[_0x38111b(0x1f5)]());}),pythonProcess['on']('close',_0x5cbe6d=>{const _0x5a1d3f=_0x414be0;_0x54f8ec['log'][_0x5a1d3f(0x1e4)](_0x5a1d3f(0x1eb)+_0x5cbe6d),pythonProcess=null;}),_0x54f8ec[_0x414be0(0x233)]=(_0x236915,_0x68f45b)=>send(_0x54f8ec,_0x236915,_0x68f45b);}catch(_0x150d1a){_0x54f8ec[_0x414be0(0x1f2)][_0x414be0(0x1e5)]('Error\x20launching\x20Python:\x20'+_0x150d1a[_0x414be0(0x1cb)]);}}function a4_0x2abc(_0xd612ee,_0x9aee2a){const _0x9e8611=a4_0x4ba4();return a4_0x2abc=function(_0x38cff4,_0xa4de3b){_0x38cff4=_0x38cff4-0x1c7;let _0x4ba482=_0x9e8611[_0x38cff4];return _0x4ba482;},a4_0x2abc(_0xd612ee,_0x9aee2a);}function a4_0x4ba4(){const _0x1941f3=['length','writable','apply','analysis.alertReason','analysis.prediction.trackerConfidence','24JJIGcV','.\x20Please\x20create\x20this\x20file!','toString','‚úÖ\x20HEALTH\x20TRAINED.','analysis.energy.warmupSources','2-digit','ENERGY_TRAIN_RESULT','val','analysis.health.isAnomaly','analysis.energy.rlPenalties','28060110iYNaot','service.py','short','Success:\x20','analysis.energy.mpcActive','analysis.security.lastCheck','35166plCzUI','toLocaleDateString','constructor','analysis.isAlert','setStateAsync','startsWith','existsSync','reason','stringify','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','details','sendToPythonWrapper','forEach','insulation','analysis.energy.heatingScore','search','analysis.security.lastScore','success','substring','message','isArray','split','./automation','2195886RUAGGH','HEALTH_TRAIN_RESULT','stderr','type','[LOG]','analysis.energy.insulationScore','483831wJXdud','toISOString','toLocaleTimeString','debug','analysis.health.lastCheck','analysis.automation.detectedPatterns','PONG','[PYTHON]\x20','(((.+)+)+)+$','data','HEALTH_RESULT','keys','stdout','5259605eQxJgb','analysis.prediction.trackerTopRoom','warn','error','analysis.energy.forecast','33NiAsKI','analysis.health.gaitSpeed','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','toFixed','Python\x20process\x20exited\x20with\x20code\x20','parse','getState','analysis.energy.ventilationAlerts','analysis.prediction.confidence','2202914mnuKIN','4RSetww','log','info','PINN_PREDICT_RESULT','trim','heating','./setup','analysis.energy.warmupDetails','payload','TRAINING_COMPLETE','TRACKER_RESULT','SIGNAL_RESULT','kill','Failed:\x20','1733724iZnsNt','sendNotification','stdin','‚ùå\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!\x20Checked:\x20','de-DE','HEALTH_TREND_RESULT','analysis.prediction.trackerState','WARMUP_RESULT','is_anomaly','COMFORT_RESULT','join','analysis.energy.pinnForecast','analysis.prediction.nextRoom','üöÄ\x20Starting\x20Python\x20Bridge\x20using:\x20','ENERGY_OPTIMIZE_RESULT','RL_PENALTY_UPDATE','analysis.energy.warmupTimes','üêç\x20Python\x20Pong','analysis.security.currentThreshold','python3'];a4_0x4ba4=function(){return _0x1941f3;};return a4_0x4ba4();}function stopService(_0x627c39){const _0x29bdc5=a4_0x3d3cbc;if(pythonProcess){try{pythonProcess[_0x29bdc5(0x1fd)]();}catch(_0x2cdcd2){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};