const a4_0x4b801b=a4_0xb67f;(function(_0x290c0d,_0x2be3c5){const _0x4e9d0c=a4_0xb67f,_0x5778ae=_0x290c0d();while(!![]){try{const _0x3f7a61=-parseInt(_0x4e9d0c(0x1e0))/0x1+-parseInt(_0x4e9d0c(0x200))/0x2*(parseInt(_0x4e9d0c(0x1cf))/0x3)+parseInt(_0x4e9d0c(0x20a))/0x4*(parseInt(_0x4e9d0c(0x1f9))/0x5)+-parseInt(_0x4e9d0c(0x1f7))/0x6*(parseInt(_0x4e9d0c(0x214))/0x7)+parseInt(_0x4e9d0c(0x1cb))/0x8*(-parseInt(_0x4e9d0c(0x1f5))/0x9)+parseInt(_0x4e9d0c(0x1f4))/0xa*(-parseInt(_0x4e9d0c(0x20e))/0xb)+parseInt(_0x4e9d0c(0x1f1))/0xc;if(_0x3f7a61===_0x2be3c5)break;else _0x5778ae['push'](_0x5778ae['shift']());}catch(_0xb735ec){_0x5778ae['push'](_0x5778ae['shift']());}}}(a4_0x1172,0x9bcce));const a4_0x5b7467=(function(){let _0x3bf952=!![];return function(_0x254245,_0x30ae14){const _0x4fac1d=_0x3bf952?function(){const _0x46e2dc=a4_0xb67f;if(_0x30ae14){const _0x56d159=_0x30ae14[_0x46e2dc(0x1ea)](_0x254245,arguments);return _0x30ae14=null,_0x56d159;}}:function(){};return _0x3bf952=![],_0x4fac1d;};}()),a4_0x547144=a4_0x5b7467(this,function(){const _0x5e4ebd=a4_0xb67f;return a4_0x547144['toString']()[_0x5e4ebd(0x207)](_0x5e4ebd(0x1db))[_0x5e4ebd(0x1c9)]()[_0x5e4ebd(0x1fd)](a4_0x547144)[_0x5e4ebd(0x207)](_0x5e4ebd(0x1db));});a4_0x547144();function a4_0x1172(){const _0x2590bf=['analysis.prediction.nextRoom','stringify','getState','analysis.health.isAnomaly','search','python3','type','8yZmsNg','toLocaleTimeString','[RESULT]','toISOString','11SHfHcW','substring','Error\x20launching\x20Python:\x20','analysis.health.gaitSpeed','analysis.health.lastCheck','existsSync','14kgDsIe','child_process','python_service','trim','toString','analysis.security.currentThreshold','32AESwjj','handlePrediction','length','stdin','929484aOohJb','join','ENERGY_TRAIN_RESULT','reason','forEach','ðŸ\x20Python\x20Pong','âœ…\x20HEALTH\x20TRAINED.','data','analysis.energy.forecast','Success:\x20','analysis.prediction.confidence','entries','(((.+)+)+)+$','[LOG]','info','heating','success','1113814bwiDDw','SECURITY_RESULT','split','\x0aGrund:\x20','sendNotification','toFixed','Unknown','setStateAsync','kill','SIGNAL_RESULT','apply','log','threshold','parse','analysis.training.status','payload','service.py','58306332msrqZc','startsWith','insulation','9397070yLmhAg','1400346BtdyxP','val','2780934cCpsyv','details','1553710BRfaxO','GAIT_RESULT','analysis.automation.detectedPatterns','Failed:\x20','constructor','[PYTHON]\x20','exports','8pxWubW','ENERGY_OPTIMIZE_RESULT','analysis.energy.insulationScore'];a4_0x1172=function(){return _0x2590bf;};return a4_0x1172();}'use strict';const {spawn}=require(a4_0x4b801b(0x215)),path=require('path'),fs=require('fs'),setup=require('./setup'),automation=require('./automation');let pythonProcess=null;function send(_0x56c020,_0x21545e,_0x53896b={}){const _0xa86c3b=a4_0x4b801b;if(!pythonProcess||!pythonProcess[_0xa86c3b(0x1ce)]['writable'])return;const _0x5c0498=JSON[_0xa86c3b(0x204)]({'command':_0x21545e,..._0x53896b});try{pythonProcess[_0xa86c3b(0x1ce)]['write'](_0x5c0498+'\x0a');}catch(_0x519bc2){}}function handleResult(_0xd37c8d,_0x479200){const _0xd8161e=a4_0x4b801b;if(_0x479200[_0xd8161e(0x209)]==='PONG')_0xd37c8d['log']['debug'](_0xd8161e(0x1d4));else{if(_0x479200[_0xd8161e(0x209)]===_0xd8161e(0x1e1)){const {anomaly_score:_0x5dffa2,is_anomaly:_0x81ed5d,threshold:_0x20be22,explanation:_0x6ed35f}=_0x479200[_0xd8161e(0x1ef)];_0xd37c8d['setStateAsync']('analysis.security.lastScore',{'val':_0x5dffa2,'ack':!![]}),_0xd37c8d[_0xd8161e(0x1e7)]('analysis.security.lastCheck',{'val':new Date()[_0xd8161e(0x20d)](),'ack':!![]});if(_0x20be22)_0xd37c8d['setStateAsync'](_0xd8161e(0x1ca),{'val':_0x20be22,'ack':!![]});if(_0x81ed5d){let _0x3878f8='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x5dffa2[_0xd8161e(0x1e5)](0x4)+')';if(_0x6ed35f&&_0x6ed35f!=='Unknown')_0x3878f8+=_0xd8161e(0x1e3)+_0x6ed35f;_0xd37c8d[_0xd8161e(0x1e7)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0xd37c8d[_0xd8161e(0x1e7)]('analysis.alertReason',{'val':_0x3878f8,'ack':!![]}),setup[_0xd8161e(0x1e4)](_0xd37c8d,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x3878f8,![],!![]);}}else{if(_0x479200[_0xd8161e(0x209)]==='TRAINING_COMPLETE'){const _0x505c59=_0x479200[_0xd8161e(0x1ef)][_0xd8161e(0x1f8)]||'',_0x4223f8=_0x479200[_0xd8161e(0x1ef)][_0xd8161e(0x1ec)],_0x59271d=_0x479200['payload'][_0xd8161e(0x1df)]?_0xd8161e(0x1d8)+new Date()[_0xd8161e(0x20b)]()+'\x20('+_0x505c59+')':_0xd8161e(0x1fc)+_0x479200[_0xd8161e(0x1ef)][_0xd8161e(0x1d2)];_0xd37c8d['setStateAsync'](_0xd8161e(0x1ee),{'val':_0x59271d,'ack':!![]});if(_0x479200['payload'][_0xd8161e(0x1df)]&&_0x4223f8)_0xd37c8d[_0xd8161e(0x1e7)](_0xd8161e(0x1ca),{'val':_0x4223f8,'ack':!![]});}else{if(_0x479200[_0xd8161e(0x209)]===_0xd8161e(0x1d1)){if(_0x479200[_0xd8161e(0x1ef)][_0xd8161e(0x1df)])try{const _0x3abbc1=JSON['parse'](_0x479200[_0xd8161e(0x1ef)][_0xd8161e(0x1f8)]);if(_0x3abbc1[_0xd8161e(0x1f3)])_0xd37c8d['setStateAsync'](_0xd8161e(0x202),{'val':JSON['stringify'](_0x3abbc1[_0xd8161e(0x1f3)]),'ack':!![]});if(_0x3abbc1[_0xd8161e(0x1de)])_0xd37c8d[_0xd8161e(0x1e7)]('analysis.energy.heatingScore',{'val':JSON[_0xd8161e(0x204)](_0x3abbc1[_0xd8161e(0x1de)]),'ack':!![]});}catch(_0x42daed){}}else{if(_0x479200[_0xd8161e(0x209)]==='HEALTH_TRAIN_RESULT'){if(_0x479200[_0xd8161e(0x1ef)][_0xd8161e(0x1df)])_0xd37c8d['log'][_0xd8161e(0x1dd)](_0xd8161e(0x1d5));}else{if(_0x479200[_0xd8161e(0x209)]==='HEALTH_RESULT')_0xd37c8d[_0xd8161e(0x1e7)](_0xd8161e(0x212),{'val':new Date()['toISOString'](),'ack':!![]}),_0xd37c8d['setStateAsync'](_0xd8161e(0x206),{'val':_0x479200[_0xd8161e(0x1ef)]['is_anomaly'],'ack':!![]});else{if(_0x479200[_0xd8161e(0x209)]===_0xd8161e(0x1fa)){const {speed_trend:_0x3a3f68}=_0x479200[_0xd8161e(0x1ef)];if(_0x3a3f68!==undefined)_0xd37c8d[_0xd8161e(0x1e7)](_0xd8161e(0x211),{'val':_0x3a3f68,'ack':!![]});}else{if(_0x479200[_0xd8161e(0x209)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x4945c6}=_0x479200[_0xd8161e(0x1ef)];if(_0x4945c6)_0xd37c8d[_0xd8161e(0x1e7)](_0xd8161e(0x1d7),{'val':JSON['stringify'](_0x4945c6),'ack':!![]});}else{if(_0x479200[_0xd8161e(0x209)]===_0xd8161e(0x201)){const {proposals:_0x192c38}=_0x479200['payload'];_0xd37c8d[_0xd8161e(0x205)]('analysis.energy.mpcActive',(_0x3c05f9,_0x973976)=>{const _0x1dca83=_0xd8161e;_0x973976&&_0x973976[_0x1dca83(0x1f6)]===!![]&&_0x192c38&&_0x192c38[_0x1dca83(0x1cd)]>0x0&&automation['applyEnergySavings'](_0xd37c8d,_0x192c38);});}else{if(_0x479200['type']===_0xd8161e(0x1e9)){const {room:_0x1523fa,propagation:_0x515f25}=_0x479200['payload'];let _0x4f6f75=_0xd8161e(0x1e6),_0x53075b=0x0;if(_0x515f25){const _0x4e17b3=Object[_0xd8161e(0x1da)](_0x515f25);_0x4e17b3[_0xd8161e(0x1cd)]>0x0&&(_0x4f6f75=_0x4e17b3[0x0][0x0],_0x53075b=_0x4e17b3[0x0][0x1]);}_0xd37c8d[_0xd8161e(0x1e7)](_0xd8161e(0x203),{'val':_0x4f6f75,'ack':!![]}),_0xd37c8d['setStateAsync'](_0xd8161e(0x1d9),{'val':_0x53075b,'ack':!![]}),automation[_0xd8161e(0x1cc)](_0xd37c8d,_0x4f6f75,_0x53075b);}else{if(_0x479200[_0xd8161e(0x209)]==='COMFORT_RESULT'){const {patterns:_0x158749}=_0x479200[_0xd8161e(0x1ef)];if(_0x158749&&_0x158749[_0xd8161e(0x1cd)]>0x0)_0xd37c8d['setStateAsync'](_0xd8161e(0x1fb),{'val':JSON['stringify'](_0x158749),'ack':!![]});}}}}}}}}}}}}function startService(_0x19f5aa,_0x3799ee){const _0x3dbd4c=a4_0x4b801b;let _0x1dce49=_0x3dbd4c(0x208);if(fs[_0x3dbd4c(0x213)](_0x3799ee))_0x1dce49=_0x3799ee;try{const _0x1a8eb4=path[_0x3dbd4c(0x1d0)](__dirname,'..',_0x3dbd4c(0x216),_0x3dbd4c(0x1f0));pythonProcess=spawn(_0x1dce49,[_0x1a8eb4]),pythonProcess['stdout']['on'](_0x3dbd4c(0x1d6),_0x3c5f00=>{const _0x145be3=_0x3dbd4c,_0x580f6d=_0x3c5f00[_0x145be3(0x1c9)]()[_0x145be3(0x1e2)]('\x0a');_0x580f6d[_0x145be3(0x1d3)](_0x531aa5=>{const _0x5092e8=_0x145be3,_0x43e1bd=_0x531aa5[_0x5092e8(0x217)]();if(!_0x43e1bd)return;if(_0x43e1bd['startsWith'](_0x5092e8(0x1dc)))_0x19f5aa['log']['debug'](_0x5092e8(0x1fe)+_0x43e1bd[_0x5092e8(0x20f)](0x5)[_0x5092e8(0x217)]());else{if(_0x43e1bd[_0x5092e8(0x1f2)](_0x5092e8(0x20c)))try{const _0x4a1771=JSON[_0x5092e8(0x1ed)](_0x43e1bd[_0x5092e8(0x20f)](0x8)['trim']());handleResult(_0x19f5aa,_0x4a1771);}catch(_0x4f674c){}}});}),pythonProcess['on']('close',_0x110447=>{pythonProcess=null;}),_0x19f5aa['sendToPythonWrapper']=(_0x50bbee,_0xcce9d5)=>send(_0x19f5aa,_0x50bbee,_0xcce9d5);}catch(_0x5d8db1){_0x19f5aa[_0x3dbd4c(0x1eb)]['error'](_0x3dbd4c(0x210)+_0x5d8db1['message']);}}function a4_0xb67f(_0x4b6bce,_0x4d3e4f){const _0x581890=a4_0x1172();return a4_0xb67f=function(_0x547144,_0x5b7467){_0x547144=_0x547144-0x1c9;let _0x1172c9=_0x581890[_0x547144];return _0x1172c9;},a4_0xb67f(_0x4b6bce,_0x4d3e4f);}function stopService(_0x4b8118){const _0x54325f=a4_0x4b801b;if(pythonProcess){try{pythonProcess[_0x54325f(0x1e8)]();}catch(_0x1b588d){}pythonProcess=null;}}module[a4_0x4b801b(0x1ff)]={'startService':startService,'stopService':stopService,'send':send};