const a4_0x311ff4=a4_0x4c26;(function(_0x489457,_0x22069b){const _0xf1dcb2=a4_0x4c26,_0x2c8a11=_0x489457();while(!![]){try{const _0x158904=parseInt(_0xf1dcb2(0x17a))/0x1+parseInt(_0xf1dcb2(0x16e))/0x2*(parseInt(_0xf1dcb2(0x18e))/0x3)+parseInt(_0xf1dcb2(0x15e))/0x4*(parseInt(_0xf1dcb2(0x142))/0x5)+-parseInt(_0xf1dcb2(0x189))/0x6+parseInt(_0xf1dcb2(0x166))/0x7+-parseInt(_0xf1dcb2(0x14f))/0x8+-parseInt(_0xf1dcb2(0x17d))/0x9;if(_0x158904===_0x22069b)break;else _0x2c8a11['push'](_0x2c8a11['shift']());}catch(_0x48385){_0x2c8a11['push'](_0x2c8a11['shift']());}}}(a4_0x1822,0xa0549));const a4_0x4bf174=(function(){let _0x36d208=!![];return function(_0x468ece,_0x402da9){const _0x5906c2=_0x36d208?function(){const _0xa251f0=a4_0x4c26;if(_0x402da9){const _0x3aad1e=_0x402da9[_0xa251f0(0x155)](_0x468ece,arguments);return _0x402da9=null,_0x3aad1e;}}:function(){};return _0x36d208=![],_0x5906c2;};}()),a4_0x2fe4de=a4_0x4bf174(this,function(){const _0x12d556=a4_0x4c26;return a4_0x2fe4de[_0x12d556(0x15c)]()['search'](_0x12d556(0x148))[_0x12d556(0x15c)]()[_0x12d556(0x16a)](a4_0x2fe4de)[_0x12d556(0x14b)](_0x12d556(0x148));});a4_0x2fe4de();function a4_0x4c26(_0x169ce6,_0x286a86){const _0xc0fd70=a4_0x1822();return a4_0x4c26=function(_0x2fe4de,_0x4bf174){_0x2fe4de=_0x2fe4de-0x13e;let _0x182293=_0xc0fd70[_0x2fe4de];return _0x182293;},a4_0x4c26(_0x169ce6,_0x286a86);}'use strict';const {spawn}=require(a4_0x311ff4(0x197)),path=require('path'),fs=require('fs'),setup=require('./setup'),automation=require(a4_0x311ff4(0x16b));let pythonProcess=null;function send(_0x247fed,_0x1e3188,_0x3b5eea={}){const _0x5643d8=a4_0x311ff4;if(!pythonProcess||!pythonProcess[_0x5643d8(0x144)]['writable'])return;const _0x10703d=JSON['stringify']({'command':_0x1e3188,..._0x3b5eea});try{pythonProcess[_0x5643d8(0x144)][_0x5643d8(0x156)](_0x10703d+'\x0a');}catch(_0x2cef0d){}}function a4_0x1822(){const _0x2a5464=['analysis.prediction.trackerTopRoom','analysis.health.lastCheck','constructor','./automation','val','data','52nuFkFo','Error\x20launching\x20Python:\x20','HEALTH_RESULT','VENTILATION_ALERT','sendNotification','analysis.isAlert','is_anomaly','COMFORT_RESULT','PINN_PREDICT_RESULT','toLocaleTimeString','analysis.energy.warmupTimes','log','443292QjMESK','analysis.energy.heatingScore','substring','2894940vJSmeW','details','entries','analysis.health.isAnomaly','python3','analysis.energy.forecast','HEALTH_TRAIN_RESULT','forEach','existsSync','analysis.energy.pinnForecast','type','analysis.alertReason','6943422OBmgcb','GAIT_RESULT','âœ…\x20HEALTH\x20TRAINED.','message','startsWith','57069WbceIP','split','success','setStateAsync','analysis.prediction.trackerState','[RESULT]','kill','analysis.energy.mpcActive','trim','child_process','Failed:\x20','TRACKER_RESULT','stdout','ENERGY_OPTIMIZE_RESULT','117105GpDIED','SECURITY_RESULT','stdin','analysis.prediction.nextRoom','analysis.prediction.confidence','python_service','(((.+)+)+)+$','reason','analysis.security.lastScore','search','threshold','analysis.security.currentThreshold','close','5256880mSHMpz','length','ENERGY_PREDICT_RESULT','toFixed','payload','info','apply','write','analysis.security.lastCheck','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','toISOString','parse','analysis.training.status','toString','keys','124WMMIyJ','stringify','PONG','[PYTHON]\x20','Unknown','analysis.energy.ventilationAlerts','debug','âš ï¸\x20SECURITY\x20ALARM:\x20','7901453EdZmfY','handlePrediction'];a4_0x1822=function(){return _0x2a5464;};return a4_0x1822();}function handleResult(_0x1a118c,_0x397a55){const _0x2f3a2d=a4_0x311ff4;if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x160))_0x1a118c[_0x2f3a2d(0x179)]['debug']('ðŸ\x20Python\x20Pong');else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x143)){const {anomaly_score:_0xe0ca6d,is_anomaly:_0x38cb43,threshold:_0x11474c,explanation:_0x1b9bbe}=_0x397a55['payload'];_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x14a),{'val':_0xe0ca6d,'ack':!![]}),_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x157),{'val':new Date()[_0x2f3a2d(0x159)](),'ack':!![]});if(_0x11474c)_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x14d),{'val':_0x11474c,'ack':!![]});if(_0x38cb43){let _0x10edae=_0x2f3a2d(0x158)+_0xe0ca6d[_0x2f3a2d(0x152)](0x4)+')';if(_0x1b9bbe&&_0x1b9bbe!=='Unknown')_0x10edae+='\x0aGrund:\x20'+_0x1b9bbe;_0x1a118c['setStateAsync'](_0x2f3a2d(0x173),{'val':!![],'ack':!![]}),_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x188),{'val':_0x10edae,'ack':!![]}),setup[_0x2f3a2d(0x172)](_0x1a118c,_0x2f3a2d(0x165)+_0x10edae,![],!![]);}}else{if(_0x397a55[_0x2f3a2d(0x187)]==='TRAINING_COMPLETE'){const _0x4268ce=_0x397a55[_0x2f3a2d(0x153)]['details']||'',_0x4be556=_0x397a55[_0x2f3a2d(0x153)][_0x2f3a2d(0x14c)],_0x40bdfd=_0x397a55['payload'][_0x2f3a2d(0x190)]?'Success:\x20'+new Date()[_0x2f3a2d(0x177)]()+'\x20('+_0x4268ce+')':_0x2f3a2d(0x13e)+_0x397a55[_0x2f3a2d(0x153)][_0x2f3a2d(0x149)];_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x15b),{'val':_0x40bdfd,'ack':!![]});if(_0x397a55[_0x2f3a2d(0x153)][_0x2f3a2d(0x190)]&&_0x4be556)_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x14d),{'val':_0x4be556,'ack':!![]});}else{if(_0x397a55[_0x2f3a2d(0x187)]==='ENERGY_TRAIN_RESULT'){if(_0x397a55['payload'][_0x2f3a2d(0x190)])try{const _0x29ef11=JSON['parse'](_0x397a55[_0x2f3a2d(0x153)][_0x2f3a2d(0x17e)]);if(_0x29ef11['insulation'])_0x1a118c['setStateAsync']('analysis.energy.insulationScore',{'val':JSON[_0x2f3a2d(0x15f)](_0x29ef11['insulation']),'ack':!![]});if(_0x29ef11['heating'])_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x17b),{'val':JSON[_0x2f3a2d(0x15f)](_0x29ef11['heating']),'ack':!![]});}catch(_0x13538f){}}else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x183)){if(_0x397a55[_0x2f3a2d(0x153)]['success'])_0x1a118c[_0x2f3a2d(0x179)][_0x2f3a2d(0x154)](_0x2f3a2d(0x18b));}else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x170))_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x169),{'val':new Date()[_0x2f3a2d(0x159)](),'ack':!![]}),_0x1a118c['setStateAsync'](_0x2f3a2d(0x180),{'val':_0x397a55[_0x2f3a2d(0x153)][_0x2f3a2d(0x174)],'ack':!![]});else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x18a)){const {speed_trend:_0x4f25e6}=_0x397a55['payload'];if(_0x4f25e6!==undefined)_0x1a118c[_0x2f3a2d(0x191)]('analysis.health.gaitSpeed',{'val':_0x4f25e6,'ack':!![]});}else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x151)){const {forecast:_0x891d5d}=_0x397a55[_0x2f3a2d(0x153)];if(_0x891d5d)_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x182),{'val':JSON[_0x2f3a2d(0x15f)](_0x891d5d),'ack':!![]});}else{if(_0x397a55[_0x2f3a2d(0x187)]==='WARMUP_RESULT'){const {times:_0x48efaa}=_0x397a55[_0x2f3a2d(0x153)];if(_0x48efaa)_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x178),{'val':JSON[_0x2f3a2d(0x15f)](_0x48efaa),'ack':!![]});}else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x176)){const {forecast:_0x26e2ac}=_0x397a55[_0x2f3a2d(0x153)];if(_0x26e2ac)_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x186),{'val':JSON[_0x2f3a2d(0x15f)](_0x26e2ac),'ack':!![]});}else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x171)){const {alerts:_0x4fd45b}=_0x397a55[_0x2f3a2d(0x153)];if(_0x4fd45b)_0x1a118c['setStateAsync'](_0x2f3a2d(0x163),{'val':JSON[_0x2f3a2d(0x15f)](_0x4fd45b),'ack':!![]});}else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x141)){const {proposals:_0x25df68}=_0x397a55[_0x2f3a2d(0x153)];_0x1a118c['getState'](_0x2f3a2d(0x195),(_0x10c38b,_0x4f13f3)=>{const _0x212449=_0x2f3a2d;_0x4f13f3&&_0x4f13f3[_0x212449(0x16c)]===!![]&&_0x25df68&&_0x25df68[_0x212449(0x150)]>0x0&&automation['applyEnergySavings'](_0x1a118c,_0x25df68);});}else{if(_0x397a55['type']==='SIGNAL_RESULT'){const {room:_0x117ae6,propagation:_0x532e2b}=_0x397a55[_0x2f3a2d(0x153)];let _0xf8ed17=_0x2f3a2d(0x162),_0x17c896=0x0;if(_0x532e2b){const _0x47115d=Object[_0x2f3a2d(0x17f)](_0x532e2b);_0x47115d['length']>0x0&&(_0xf8ed17=_0x47115d[0x0][0x0],_0x17c896=_0x47115d[0x0][0x1]);}_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x145),{'val':_0xf8ed17,'ack':!![]}),_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x146),{'val':_0x17c896,'ack':!![]}),automation[_0x2f3a2d(0x167)](_0x1a118c,_0xf8ed17,_0x17c896);}else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x13f)){const {probabilities:_0x20c73a}=_0x397a55[_0x2f3a2d(0x153)];if(_0x20c73a){_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x192),{'val':JSON[_0x2f3a2d(0x15f)](_0x20c73a),'ack':!![]});const _0x41a3fe=Object[_0x2f3a2d(0x15d)](_0x20c73a);if(_0x41a3fe['length']>0x0){const _0x5de33a=_0x41a3fe[0x0],_0x6eae73=_0x20c73a[_0x5de33a];_0x1a118c[_0x2f3a2d(0x191)](_0x2f3a2d(0x168),{'val':_0x5de33a,'ack':!![]}),_0x1a118c[_0x2f3a2d(0x191)]('analysis.prediction.trackerConfidence',{'val':_0x6eae73,'ack':!![]});}}}else{if(_0x397a55[_0x2f3a2d(0x187)]===_0x2f3a2d(0x175)){const {patterns:_0x3beb33}=_0x397a55[_0x2f3a2d(0x153)];if(_0x3beb33&&_0x3beb33[_0x2f3a2d(0x150)]>0x0)_0x1a118c[_0x2f3a2d(0x191)]('analysis.automation.detectedPatterns',{'val':JSON[_0x2f3a2d(0x15f)](_0x3beb33),'ack':!![]});}}}}}}}}}}}}}}}}function startService(_0x462c2f,_0xad59fc){const _0x4653df=a4_0x311ff4;let _0x598d43=_0x4653df(0x181);if(fs[_0x4653df(0x185)](_0xad59fc))_0x598d43=_0xad59fc;try{const _0x9c02e7=path['join'](__dirname,'..',_0x4653df(0x147),'service.py');pythonProcess=spawn(_0x598d43,[_0x9c02e7]),pythonProcess[_0x4653df(0x140)]['on'](_0x4653df(0x16d),_0x20facd=>{const _0x5c4e70=_0x4653df,_0x395bbd=_0x20facd[_0x5c4e70(0x15c)]()[_0x5c4e70(0x18f)]('\x0a');_0x395bbd[_0x5c4e70(0x184)](_0x3e8c85=>{const _0x5bdc2b=_0x5c4e70,_0x1ca7fc=_0x3e8c85[_0x5bdc2b(0x196)]();if(!_0x1ca7fc)return;if(_0x1ca7fc[_0x5bdc2b(0x18d)]('[LOG]'))_0x462c2f[_0x5bdc2b(0x179)][_0x5bdc2b(0x164)](_0x5bdc2b(0x161)+_0x1ca7fc[_0x5bdc2b(0x17c)](0x5)['trim']());else{if(_0x1ca7fc['startsWith'](_0x5bdc2b(0x193)))try{const _0xa03e44=JSON[_0x5bdc2b(0x15a)](_0x1ca7fc[_0x5bdc2b(0x17c)](0x8)['trim']());handleResult(_0x462c2f,_0xa03e44);}catch(_0x38bd52){}}});}),pythonProcess['on'](_0x4653df(0x14e),_0x4b4ba7=>{pythonProcess=null;}),_0x462c2f['sendToPythonWrapper']=(_0x7eaa1a,_0x1f446f)=>send(_0x462c2f,_0x7eaa1a,_0x1f446f);}catch(_0x4a5180){_0x462c2f['log']['error'](_0x4653df(0x16f)+_0x4a5180[_0x4653df(0x18c)]);}}function stopService(_0x2540a9){const _0x1f6991=a4_0x311ff4;if(pythonProcess){try{pythonProcess[_0x1f6991(0x194)]();}catch(_0x2163b6){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};