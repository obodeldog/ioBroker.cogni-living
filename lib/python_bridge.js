const a4_0x3b13c5=a4_0xf97e;(function(_0x250ce5,_0x5ecb5b){const _0x58d675=a4_0xf97e,_0x54f85e=_0x250ce5();while(!![]){try{const _0x43240a=-parseInt(_0x58d675(0x106))/0x1+parseInt(_0x58d675(0x142))/0x2*(parseInt(_0x58d675(0x114))/0x3)+parseInt(_0x58d675(0x132))/0x4+parseInt(_0x58d675(0xfa))/0x5+-parseInt(_0x58d675(0x126))/0x6+parseInt(_0x58d675(0xf6))/0x7+parseInt(_0x58d675(0x115))/0x8*(-parseInt(_0x58d675(0x12b))/0x9);if(_0x43240a===_0x5ecb5b)break;else _0x54f85e['push'](_0x54f85e['shift']());}catch(_0x3ea4f6){_0x54f85e['push'](_0x54f85e['shift']());}}}(a4_0x1155,0x47c25));const a4_0x289c39=(function(){let _0x44367c=!![];return function(_0x5ef366,_0x337077){const _0x4bbd3d=_0x44367c?function(){const _0x5f53ba=a4_0xf97e;if(_0x337077){const _0xe0bd95=_0x337077[_0x5f53ba(0x11a)](_0x5ef366,arguments);return _0x337077=null,_0xe0bd95;}}:function(){};return _0x44367c=![],_0x4bbd3d;};}()),a4_0x4c2176=a4_0x289c39(this,function(){const _0x5f5475=a4_0xf97e;return a4_0x4c2176[_0x5f5475(0x121)]()['search'](_0x5f5475(0x127))[_0x5f5475(0x121)]()[_0x5f5475(0x111)](a4_0x4c2176)[_0x5f5475(0x143)](_0x5f5475(0x127));});a4_0x4c2176();'use strict';function a4_0x1155(){const _0x2b991e=['reason','stringify','length','kill','toISOString','./automation','existsSync','SIGNAL_RESULT','TRACKER_RESULT','COMFORT_RESULT','2ydUEgy','search','log','type','analysis.training.status','stdin','forEach','heating','trim','info','getState','keys','ENERGY_PREDICT_RESULT','PINN_PREDICT_RESULT','âš ï¸\x20SECURITY\x20ALARM:\x20','2189110DhEYXJ','analysis.security.lastCheck','analysis.prediction.nextRoom','Error\x20launching\x20Python:\x20','145280mWmMQX','analysis.automation.detectedPatterns','analysis.security.currentThreshold','message','analysis.security.lastScore','analysis.health.isAnomaly','ENERGY_TRAIN_RESULT','analysis.energy.mpcActive','setStateAsync','analysis.prediction.trackerTopRoom','debug','[RESULT]','302530rlecGA','threshold','stdout','analysis.health.gaitSpeed','analysis.prediction.confidence','PONG','SECURITY_RESULT','analysis.energy.warmupTimes','data','write','Unknown','constructor','analysis.alertReason','analysis.energy.insulationScore','1230597TamFBu','208tOdTiq','HEALTH_RESULT','analysis.energy.pinnForecast','success','substring','apply','[PYTHON]\x20','applyEnergySavings','[LOG]','child_process','payload','analysis.energy.ventilationAlerts','toString','service.py','is_anomaly','analysis.prediction.trackerState','GAIT_RESULT','1060014UQXqyD','(((.+)+)+)+$','details','analysis.isAlert','join','12735XyoREi','WARMUP_RESULT','HEALTH_TRAIN_RESULT','path','VENTILATION_ALERT','âœ…\x20HEALTH\x20TRAINED.','exports','231716XnysXH','python3','analysis.energy.heatingScore','Failed:\x20','parse','sendNotification'];a4_0x1155=function(){return _0x2b991e;};return a4_0x1155();}const {spawn}=require(a4_0x3b13c5(0x11e)),path=require(a4_0x3b13c5(0x12e)),fs=require('fs'),setup=require('./setup'),automation=require(a4_0x3b13c5(0x13d));let pythonProcess=null;function a4_0xf97e(_0x4f6210,_0x3934ef){const _0x10b98b=a4_0x1155();return a4_0xf97e=function(_0x4c2176,_0x289c39){_0x4c2176=_0x4c2176-0xf2;let _0x11558a=_0x10b98b[_0x4c2176];return _0x11558a;},a4_0xf97e(_0x4f6210,_0x3934ef);}function send(_0x28d121,_0x32bd8a,_0x5a0af0={}){const _0x1a6b6b=a4_0x3b13c5;if(!pythonProcess||!pythonProcess[_0x1a6b6b(0x147)]['writable'])return;const _0x294a6c=JSON['stringify']({'command':_0x32bd8a,..._0x5a0af0});try{pythonProcess[_0x1a6b6b(0x147)][_0x1a6b6b(0x10f)](_0x294a6c+'\x0a');}catch(_0x20998){}}function handleResult(_0x17d5cf,_0x3c0800){const _0x3eedbc=a4_0x3b13c5;if(_0x3c0800['type']===_0x3eedbc(0x10b))_0x17d5cf['log']['debug']('ðŸ\x20Python\x20Pong');else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0x10c)){const {anomaly_score:_0x4428b5,is_anomaly:_0x427694,threshold:_0x175261,explanation:_0x59cf34}=_0x3c0800['payload'];_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0xfe),{'val':_0x4428b5,'ack':!![]}),_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0xf7),{'val':new Date()[_0x3eedbc(0x13c)](),'ack':!![]});if(_0x175261)_0x17d5cf[_0x3eedbc(0x102)]('analysis.security.currentThreshold',{'val':_0x175261,'ack':!![]});if(_0x427694){let _0x4f3d20='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x4428b5['toFixed'](0x4)+')';if(_0x59cf34&&_0x59cf34!==_0x3eedbc(0x110))_0x4f3d20+='\x0aGrund:\x20'+_0x59cf34;_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x129),{'val':!![],'ack':!![]}),_0x17d5cf['setStateAsync'](_0x3eedbc(0x112),{'val':_0x4f3d20,'ack':!![]}),setup[_0x3eedbc(0x137)](_0x17d5cf,_0x3eedbc(0xf5)+_0x4f3d20,![],!![]);}}else{if(_0x3c0800[_0x3eedbc(0x145)]==='TRAINING_COMPLETE'){const _0x477aad=_0x3c0800[_0x3eedbc(0x11f)][_0x3eedbc(0x128)]||'',_0x428955=_0x3c0800[_0x3eedbc(0x11f)][_0x3eedbc(0x107)],_0x58f785=_0x3c0800[_0x3eedbc(0x11f)][_0x3eedbc(0x118)]?'Success:\x20'+new Date()['toLocaleTimeString']()+'\x20('+_0x477aad+')':_0x3eedbc(0x135)+_0x3c0800[_0x3eedbc(0x11f)][_0x3eedbc(0x138)];_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x146),{'val':_0x58f785,'ack':!![]});if(_0x3c0800[_0x3eedbc(0x11f)][_0x3eedbc(0x118)]&&_0x428955)_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0xfc),{'val':_0x428955,'ack':!![]});}else{if(_0x3c0800['type']===_0x3eedbc(0x100)){if(_0x3c0800[_0x3eedbc(0x11f)][_0x3eedbc(0x118)])try{const _0x48c525=JSON[_0x3eedbc(0x136)](_0x3c0800[_0x3eedbc(0x11f)]['details']);if(_0x48c525['insulation'])_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x113),{'val':JSON[_0x3eedbc(0x139)](_0x48c525['insulation']),'ack':!![]});if(_0x48c525[_0x3eedbc(0x149)])_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x134),{'val':JSON[_0x3eedbc(0x139)](_0x48c525[_0x3eedbc(0x149)]),'ack':!![]});}catch(_0x13e832){}}else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0x12d)){if(_0x3c0800[_0x3eedbc(0x11f)][_0x3eedbc(0x118)])_0x17d5cf['log'][_0x3eedbc(0x14b)](_0x3eedbc(0x130));}else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0x116))_0x17d5cf['setStateAsync']('analysis.health.lastCheck',{'val':new Date()[_0x3eedbc(0x13c)](),'ack':!![]}),_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0xff),{'val':_0x3c0800[_0x3eedbc(0x11f)][_0x3eedbc(0x123)],'ack':!![]});else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0x125)){const {speed_trend:_0x2f1f94}=_0x3c0800[_0x3eedbc(0x11f)];if(_0x2f1f94!==undefined)_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x109),{'val':_0x2f1f94,'ack':!![]});}else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0xf3)){const {forecast:_0x5e81c6}=_0x3c0800[_0x3eedbc(0x11f)];if(_0x5e81c6)_0x17d5cf[_0x3eedbc(0x102)]('analysis.energy.forecast',{'val':JSON[_0x3eedbc(0x139)](_0x5e81c6),'ack':!![]});}else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0x12c)){const {times:_0x2b8847}=_0x3c0800[_0x3eedbc(0x11f)];if(_0x2b8847)_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x10d),{'val':JSON[_0x3eedbc(0x139)](_0x2b8847),'ack':!![]});}else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0xf4)){const {forecast:_0x400bef}=_0x3c0800['payload'];if(_0x400bef)_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x117),{'val':JSON[_0x3eedbc(0x139)](_0x400bef),'ack':!![]});}else{if(_0x3c0800['type']===_0x3eedbc(0x12f)){const {alerts:_0x2c6b26}=_0x3c0800[_0x3eedbc(0x11f)];if(_0x2c6b26)_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x120),{'val':JSON[_0x3eedbc(0x139)](_0x2c6b26),'ack':!![]});}else{if(_0x3c0800['type']==='ENERGY_OPTIMIZE_RESULT'){const {proposals:_0x384b8b}=_0x3c0800[_0x3eedbc(0x11f)];_0x17d5cf[_0x3eedbc(0x14c)](_0x3eedbc(0x101),(_0x320bb,_0x415c73)=>{const _0x327f7e=_0x3eedbc;_0x415c73&&_0x415c73['val']===!![]&&_0x384b8b&&_0x384b8b[_0x327f7e(0x13a)]>0x0&&automation[_0x327f7e(0x11c)](_0x17d5cf,_0x384b8b);});}else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0x13f)){const {room:_0x3e7900,propagation:_0x15d8ac}=_0x3c0800['payload'];let _0xc9ae75='Unknown',_0x3896ad=0x0;if(_0x15d8ac){const _0x351db5=Object['entries'](_0x15d8ac);_0x351db5[_0x3eedbc(0x13a)]>0x0&&(_0xc9ae75=_0x351db5[0x0][0x0],_0x3896ad=_0x351db5[0x0][0x1]);}_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0xf8),{'val':_0xc9ae75,'ack':!![]}),_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x10a),{'val':_0x3896ad,'ack':!![]}),automation['handlePrediction'](_0x17d5cf,_0xc9ae75,_0x3896ad);}else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0x140)){const {probabilities:_0x56f7fa}=_0x3c0800['payload'];if(_0x56f7fa){_0x17d5cf['setStateAsync'](_0x3eedbc(0x124),{'val':JSON[_0x3eedbc(0x139)](_0x56f7fa),'ack':!![]});const _0x2a23c7=Object[_0x3eedbc(0xf2)](_0x56f7fa);if(_0x2a23c7[_0x3eedbc(0x13a)]>0x0){const _0x4d42b3=_0x2a23c7[0x0],_0x513fd1=_0x56f7fa[_0x4d42b3];_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0x103),{'val':_0x4d42b3,'ack':!![]}),_0x17d5cf[_0x3eedbc(0x102)]('analysis.prediction.trackerConfidence',{'val':_0x513fd1,'ack':!![]});}}}else{if(_0x3c0800[_0x3eedbc(0x145)]===_0x3eedbc(0x141)){const {patterns:_0x5ab348}=_0x3c0800[_0x3eedbc(0x11f)];if(_0x5ab348&&_0x5ab348[_0x3eedbc(0x13a)]>0x0)_0x17d5cf[_0x3eedbc(0x102)](_0x3eedbc(0xfb),{'val':JSON[_0x3eedbc(0x139)](_0x5ab348),'ack':!![]});}}}}}}}}}}}}}}}}function startService(_0x201bc2,_0x201ffd){const _0x229fa1=a4_0x3b13c5;let _0x577085=_0x229fa1(0x133);if(fs[_0x229fa1(0x13e)](_0x201ffd))_0x577085=_0x201ffd;try{const _0x469fc0=path[_0x229fa1(0x12a)](__dirname,'..','python_service',_0x229fa1(0x122));pythonProcess=spawn(_0x577085,[_0x469fc0]),pythonProcess[_0x229fa1(0x108)]['on'](_0x229fa1(0x10e),_0x21ba7f=>{const _0x325038=_0x229fa1,_0x24ab3b=_0x21ba7f[_0x325038(0x121)]()['split']('\x0a');_0x24ab3b[_0x325038(0x148)](_0x27a225=>{const _0x592558=_0x325038,_0x22fcd5=_0x27a225[_0x592558(0x14a)]();if(!_0x22fcd5)return;if(_0x22fcd5['startsWith'](_0x592558(0x11d)))_0x201bc2[_0x592558(0x144)][_0x592558(0x104)](_0x592558(0x11b)+_0x22fcd5[_0x592558(0x119)](0x5)[_0x592558(0x14a)]());else{if(_0x22fcd5['startsWith'](_0x592558(0x105)))try{const _0x8c9237=JSON['parse'](_0x22fcd5['substring'](0x8)['trim']());handleResult(_0x201bc2,_0x8c9237);}catch(_0x1450e5){}}});}),pythonProcess['on']('close',_0x505fac=>{pythonProcess=null;}),_0x201bc2['sendToPythonWrapper']=(_0x3db971,_0x2f72ac)=>send(_0x201bc2,_0x3db971,_0x2f72ac);}catch(_0x387992){_0x201bc2[_0x229fa1(0x144)]['error'](_0x229fa1(0xf9)+_0x387992[_0x229fa1(0xfd)]);}}function stopService(_0x523dba){const _0x14c63d=a4_0x3b13c5;if(pythonProcess){try{pythonProcess[_0x14c63d(0x13b)]();}catch(_0x40f66c){}pythonProcess=null;}}module[a4_0x3b13c5(0x131)]={'startService':startService,'stopService':stopService,'send':send};