const a4_0x2958a1=a4_0x4cc8;function a4_0x4cc8(_0x30dec5,_0x2c139f){const _0xac0c5c=a4_0x390a();return a4_0x4cc8=function(_0x49c412,_0x2a3279){_0x49c412=_0x49c412-0x16d;let _0x390ada=_0xac0c5c[_0x49c412];return _0x390ada;},a4_0x4cc8(_0x30dec5,_0x2c139f);}(function(_0x20408d,_0x37aa5d){const _0x5ba2f5=a4_0x4cc8,_0x2d70fb=_0x20408d();while(!![]){try{const _0x551c2c=-parseInt(_0x5ba2f5(0x187))/0x1+parseInt(_0x5ba2f5(0x1a0))/0x2*(-parseInt(_0x5ba2f5(0x189))/0x3)+parseInt(_0x5ba2f5(0x1c8))/0x4+parseInt(_0x5ba2f5(0x1b6))/0x5+parseInt(_0x5ba2f5(0x17f))/0x6+-parseInt(_0x5ba2f5(0x1b7))/0x7*(parseInt(_0x5ba2f5(0x1b1))/0x8)+-parseInt(_0x5ba2f5(0x1c3))/0x9*(-parseInt(_0x5ba2f5(0x18f))/0xa);if(_0x551c2c===_0x37aa5d)break;else _0x2d70fb['push'](_0x2d70fb['shift']());}catch(_0x5f1feb){_0x2d70fb['push'](_0x2d70fb['shift']());}}}(a4_0x390a,0x997da));function a4_0x390a(){const _0x1b510e=['existsSync','analysis.health.isAnomaly','path','sendNotification','substring','TRAINING_COMPLETE','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','\x20->\x20Likely\x20','Unknown','constructor','analysis.isAlert','change_percent','analysis.energy.heatingScore','child_process','\x20->\x20','toFixed','TREND_RESULT','analysis.automation.description','TOPOLOGY_RESULT','Error\x20launching\x20Python:\x20','python_service','2592882KxblvU','\x0aGrund:\x20','search','exports','analysis.automation.detectedPatterns','debug','heating','(((.+)+)+)+$','714510uHSkgf','analysis.health.gaitSpeed','3FawmmC','trim','sendToPythonWrapper','ðŸ\x20Python\x20Pong','[PYTHON]\x20','threshold','14780aNDHoz','ANOMALY','toISOString','ðŸ\x20Python\x20confirmed\x20new\x20topology.','success','log','error','writable','write','join','âš ï¸\x20SECURITY\x20ALARM:\x20','is_anomaly','reason','startsWith','data','analysis.automation.patternDetected','\x20new\x20patterns.','1641730XzIXNg','analysis.energy.forecast','rule','Failed:\x20','parse','[LOG]','COMFORT_RESULT','âœ…\x20HEALTH\x20TRAINED.','analysis.alertReason','handlePrediction','analysis.security.topologyMatrix','entries','HEALTH_RESULT','forEach','analysis.security.lastCheck','analysis.energy.insulationScore','stdin','471248WQxUff','[RESULT]','payload','setStateAsync','Success:\x20','3591190VtyGHE','21MeGpfx','PONG','analysis.security.currentThreshold','message','./automation','analysis.health.lastCheck','toString','SECURITY_RESULT','ENERGY_TRAIN_RESULT','analysis.prediction.confidence','apply','stringify','2097rPjdmj','ENERGY_PREDICT_RESULT','HEALTH_TRAIN_RESULT','Regel\x20erkannt:\x20','type','3384128ZSuRoR','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','length','ðŸ”®\x20Prediction:\x20From\x20','insulation','info','close','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','python3','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','SIGNAL_RESULT'];a4_0x390a=function(){return _0x1b510e;};return a4_0x390a();}const a4_0x2a3279=(function(){let _0x4d6d6d=!![];return function(_0x3b8940,_0x49c8ac){const _0x57f3f9=_0x4d6d6d?function(){const _0x19ade5=a4_0x4cc8;if(_0x49c8ac){const _0xb5e1=_0x49c8ac[_0x19ade5(0x1c1)](_0x3b8940,arguments);return _0x49c8ac=null,_0xb5e1;}}:function(){};return _0x4d6d6d=![],_0x57f3f9;};}()),a4_0x49c412=a4_0x2a3279(this,function(){const _0xaa5bc=a4_0x4cc8;return a4_0x49c412[_0xaa5bc(0x1bd)]()[_0xaa5bc(0x181)](_0xaa5bc(0x186))[_0xaa5bc(0x1bd)]()[_0xaa5bc(0x173)](a4_0x49c412)['search'](_0xaa5bc(0x186));});a4_0x49c412();'use strict';const {spawn}=require(a4_0x2958a1(0x177)),path=require(a4_0x2958a1(0x1d5)),fs=require('fs'),setup=require('./setup'),automation=require(a4_0x2958a1(0x1bb));let pythonProcess=null;function send(_0x5d8270,_0x5af5a6,_0x4a0feb={}){const _0x2d5dab=a4_0x2958a1;if(!pythonProcess||!pythonProcess['stdin'][_0x2d5dab(0x196)])return;const _0xcb53b0=JSON[_0x2d5dab(0x1c2)]({'command':_0x5af5a6,..._0x4a0feb});try{pythonProcess[_0x2d5dab(0x1b0)][_0x2d5dab(0x197)](_0xcb53b0+'\x0a');}catch(_0x2dd54e){}}function handleResult(_0x3cb14c,_0x50630a){const _0x57052a=a4_0x2958a1;if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x1b8))_0x3cb14c['log'][_0x57052a(0x184)](_0x57052a(0x18c));else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x1be)){const {anomaly_score:_0x351b80,is_anomaly:_0x16c86c,threshold:_0x333d54,explanation:_0x489edf}=_0x50630a[_0x57052a(0x1b3)];_0x3cb14c['log']['info'](_0x57052a(0x1cf)+_0x351b80['toFixed'](0x5)+_0x57052a(0x178)+(_0x16c86c?_0x57052a(0x190):'OK')),_0x3cb14c[_0x57052a(0x1b4)]('analysis.security.lastScore',{'val':_0x351b80,'ack':!![]}),_0x3cb14c['setStateAsync'](_0x57052a(0x1ae),{'val':new Date()[_0x57052a(0x191)](),'ack':!![]});if(_0x333d54)_0x3cb14c['setStateAsync'](_0x57052a(0x1b9),{'val':_0x333d54,'ack':!![]});if(_0x16c86c){let _0x4327b6=_0x57052a(0x170)+_0x351b80[_0x57052a(0x179)](0x4)+')';if(_0x489edf&&_0x489edf!==_0x57052a(0x172))_0x4327b6+=_0x57052a(0x180)+_0x489edf;_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x174),{'val':!![],'ack':!![]}),_0x3cb14c['setStateAsync'](_0x57052a(0x1a8),{'val':_0x4327b6,'ack':!![]}),setup[_0x57052a(0x16d)](_0x3cb14c,_0x57052a(0x199)+_0x4327b6,![],!![]);}}else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x16f)){const _0x230041=_0x50630a[_0x57052a(0x1b3)]['details']||'',_0x3e7941=_0x50630a['payload'][_0x57052a(0x18e)],_0x32081f=_0x50630a[_0x57052a(0x1b3)][_0x57052a(0x193)]?_0x57052a(0x1b5)+new Date()['toLocaleTimeString']()+'\x20('+_0x230041+')':_0x57052a(0x1a3)+_0x50630a[_0x57052a(0x1b3)][_0x57052a(0x19b)];_0x3cb14c['setStateAsync']('analysis.training.status',{'val':_0x32081f,'ack':!![]});if(_0x50630a['payload']['success']&&_0x3e7941)_0x3cb14c['setStateAsync'](_0x57052a(0x1b9),{'val':_0x3e7941,'ack':!![]});}else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x1a6)){const {patterns:_0x3434a4}=_0x50630a[_0x57052a(0x1b3)];if(_0x3434a4&&_0x3434a4[_0x57052a(0x1ca)]>0x0){_0x3cb14c[_0x57052a(0x194)][_0x57052a(0x1cd)](_0x57052a(0x1c9)+_0x3434a4[_0x57052a(0x1ca)]+_0x57052a(0x19f)),_0x3cb14c['setStateAsync'](_0x57052a(0x183),{'val':JSON[_0x57052a(0x1c2)](_0x3434a4),'ack':!![]});const _0x7e567f=_0x3434a4[0x0],_0x41eba2=_0x57052a(0x1c6)+_0x7e567f[_0x57052a(0x1a2)]+'\x20('+(_0x7e567f['confidence']*0x64)[_0x57052a(0x179)](0x0)+'%)';_0x3cb14c[_0x57052a(0x1b4)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),_0x3cb14c['setStateAsync'](_0x57052a(0x17b),{'val':_0x41eba2,'ack':!![]});}else _0x3cb14c[_0x57052a(0x194)]['info']('ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x19e),{'val':![],'ack':!![]}),_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x183),{'val':'[]','ack':!![]});}else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x1bf)){if(_0x50630a[_0x57052a(0x1b3)][_0x57052a(0x193)])try{const _0x3fab35=JSON[_0x57052a(0x1a4)](_0x50630a[_0x57052a(0x1b3)]['details']);if(_0x3fab35[_0x57052a(0x1cc)])_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x1af),{'val':JSON[_0x57052a(0x1c2)](_0x3fab35['insulation']),'ack':!![]});if(_0x3fab35[_0x57052a(0x185)])_0x3cb14c['setStateAsync'](_0x57052a(0x176),{'val':JSON[_0x57052a(0x1c2)](_0x3fab35[_0x57052a(0x185)]),'ack':!![]});}catch(_0x46d2b5){}}else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x1c5)){if(_0x50630a['payload'][_0x57052a(0x193)])_0x3cb14c['log'][_0x57052a(0x1cd)](_0x57052a(0x1a7));}else{if(_0x50630a['type']===_0x57052a(0x1ac))_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x1bc),{'val':new Date()['toISOString'](),'ack':!![]}),_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x1d4),{'val':_0x50630a[_0x57052a(0x1b3)][_0x57052a(0x19a)],'ack':!![]});else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x17a))_0x3cb14c[_0x57052a(0x1b4)]('analysis.health.trendDiagnosis',{'val':_0x50630a[_0x57052a(0x1b3)]['diagnosis'],'ack':!![]}),_0x3cb14c[_0x57052a(0x1b4)]('analysis.health.trendValue',{'val':_0x50630a[_0x57052a(0x1b3)][_0x57052a(0x175)],'ack':!![]});else{if(_0x50630a['type']==='GAIT_RESULT'){const {speed_trend:_0x211800}=_0x50630a[_0x57052a(0x1b3)];if(_0x211800!==undefined)_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x188),{'val':_0x211800,'ack':!![]});}else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x1c4)){const {forecast:_0x4bfffe}=_0x50630a['payload'];if(_0x4bfffe)_0x3cb14c['setStateAsync'](_0x57052a(0x1a1),{'val':JSON[_0x57052a(0x1c2)](_0x4bfffe),'ack':!![]});}else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x17c)){const {data:_0x163248}=_0x50630a['payload'];_0x163248&&(_0x3cb14c['log'][_0x57052a(0x1cd)](_0x57052a(0x1d1)),_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x1aa),{'val':JSON[_0x57052a(0x1c2)](_0x163248),'ack':!![]}));}else{if(_0x50630a['type']==='TOPOLOGY_ACK')_0x3cb14c[_0x57052a(0x194)][_0x57052a(0x184)](_0x57052a(0x192));else{if(_0x50630a[_0x57052a(0x1c7)]===_0x57052a(0x1d2)){const {room:_0x3330ec,propagation:_0x458663}=_0x50630a[_0x57052a(0x1b3)];let _0x48a77c='Unknown',_0x5cd47b=0x0;if(_0x458663){const _0x781edf=Object[_0x57052a(0x1ab)](_0x458663);_0x781edf[_0x57052a(0x1ca)]>0x0&&(_0x48a77c=_0x781edf[0x0][0x0],_0x5cd47b=_0x781edf[0x0][0x1]);}_0x3cb14c['setStateAsync']('analysis.prediction.nextRoom',{'val':_0x48a77c,'ack':!![]}),_0x3cb14c[_0x57052a(0x1b4)](_0x57052a(0x1c0),{'val':_0x5cd47b,'ack':!![]}),_0x5cd47b>0.4&&_0x3cb14c[_0x57052a(0x194)][_0x57052a(0x184)](_0x57052a(0x1cb)+_0x3330ec+_0x57052a(0x171)+_0x48a77c+'\x20('+(_0x5cd47b*0x64)[_0x57052a(0x179)](0x0)+'%)'),automation[_0x57052a(0x1a9)](_0x3cb14c,_0x48a77c,_0x5cd47b);}}}}}}}}}}}}}}function startService(_0x13c27c,_0x58e1e5){const _0x44690c=a4_0x2958a1;let _0x237cea=_0x44690c(0x1d0);if(fs[_0x44690c(0x1d3)](_0x58e1e5))_0x237cea=_0x58e1e5;try{const _0x48136a=path[_0x44690c(0x198)](__dirname,'..',_0x44690c(0x17e),'service.py');pythonProcess=spawn(_0x237cea,[_0x48136a]),pythonProcess['stdout']['on'](_0x44690c(0x19d),_0xa38edd=>{const _0x4a47f8=_0x44690c,_0x46e60b=_0xa38edd[_0x4a47f8(0x1bd)]()['split']('\x0a');_0x46e60b[_0x4a47f8(0x1ad)](_0x142379=>{const _0x3e22fa=_0x4a47f8,_0x125c93=_0x142379[_0x3e22fa(0x18a)]();if(!_0x125c93)return;if(_0x125c93[_0x3e22fa(0x19c)](_0x3e22fa(0x1a5)))_0x13c27c['log'][_0x3e22fa(0x184)](_0x3e22fa(0x18d)+_0x125c93[_0x3e22fa(0x16e)](0x5)['trim']());else{if(_0x125c93[_0x3e22fa(0x19c)](_0x3e22fa(0x1b2)))try{const _0xb3769f=JSON[_0x3e22fa(0x1a4)](_0x125c93['substring'](0x8)[_0x3e22fa(0x18a)]());handleResult(_0x13c27c,_0xb3769f);}catch(_0x38bd51){}}});}),pythonProcess['on'](_0x44690c(0x1ce),_0x262a2b=>{pythonProcess=null;}),_0x13c27c[_0x44690c(0x18b)]=(_0x1db2e8,_0x78cc7a)=>send(_0x13c27c,_0x1db2e8,_0x78cc7a);}catch(_0x542656){_0x13c27c[_0x44690c(0x194)][_0x44690c(0x195)](_0x44690c(0x17d)+_0x542656[_0x44690c(0x1ba)]);}}function stopService(_0x20a63b){if(pythonProcess){try{pythonProcess['kill']();}catch(_0x5f4367){}pythonProcess=null;}}module[a4_0x2958a1(0x182)]={'startService':startService,'stopService':stopService,'send':send};