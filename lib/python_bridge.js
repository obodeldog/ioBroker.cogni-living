const a3_0x210d10=a3_0x1bc3;(function(_0x4d5494,_0x1f5faa){const _0x117672=a3_0x1bc3,_0x486e36=_0x4d5494();while(!![]){try{const _0x41eb56=-parseInt(_0x117672(0x188))/0x1*(parseInt(_0x117672(0x173))/0x2)+-parseInt(_0x117672(0x18e))/0x3*(parseInt(_0x117672(0x1ab))/0x4)+-parseInt(_0x117672(0x198))/0x5*(-parseInt(_0x117672(0x1c0))/0x6)+parseInt(_0x117672(0x1c6))/0x7*(parseInt(_0x117672(0x175))/0x8)+-parseInt(_0x117672(0x192))/0x9*(-parseInt(_0x117672(0x1a8))/0xa)+parseInt(_0x117672(0x19b))/0xb*(-parseInt(_0x117672(0x1cb))/0xc)+-parseInt(_0x117672(0x1c7))/0xd;if(_0x41eb56===_0x1f5faa)break;else _0x486e36['push'](_0x486e36['shift']());}catch(_0x9c722d){_0x486e36['push'](_0x486e36['shift']());}}}(a3_0x6965,0x6377b));const a3_0x5452a6=(function(){let _0x230da1=!![];return function(_0x571338,_0x4b09be){const _0x3ed4cd=_0x230da1?function(){if(_0x4b09be){const _0x13da91=_0x4b09be['apply'](_0x571338,arguments);return _0x4b09be=null,_0x13da91;}}:function(){};return _0x230da1=![],_0x3ed4cd;};}()),a3_0x3413bd=a3_0x5452a6(this,function(){const _0x1ae842=a3_0x1bc3;return a3_0x3413bd[_0x1ae842(0x17c)]()[_0x1ae842(0x1db)](_0x1ae842(0x1b8))[_0x1ae842(0x17c)]()[_0x1ae842(0x18b)](a3_0x3413bd)['search'](_0x1ae842(0x1b8));});a3_0x3413bd();function a3_0x1bc3(_0x5d71e4,_0x45c060){const _0x235f6a=a3_0x6965();return a3_0x1bc3=function(_0x3413bd,_0x5452a6){_0x3413bd=_0x3413bd-0x171;let _0x6965a9=_0x235f6a[_0x3413bd];return _0x6965a9;},a3_0x1bc3(_0x5d71e4,_0x45c060);}'use strict';const {spawn}=require(a3_0x210d10(0x194)),path=require(a3_0x210d10(0x17f)),fs=require('fs'),setup=require('./setup'),automation=require(a3_0x210d10(0x184));let pythonProcess=null;function send(_0x440e0d,_0xe06a37,_0x51b9fe={}){const _0x48e793=a3_0x210d10;if(!pythonProcess||!pythonProcess[_0x48e793(0x183)][_0x48e793(0x179)])return;const _0x19d07a=JSON[_0x48e793(0x19d)]({'command':_0xe06a37,..._0x51b9fe});try{pythonProcess['stdin']['write'](_0x19d07a+'\x0a');}catch(_0x3d607f){}}function handleResult(_0x5ec334,_0x38f9c6){const _0x430856=a3_0x210d10;if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x1b0))_0x5ec334[_0x430856(0x1c8)][_0x430856(0x1a7)]('ðŸ\x20Python\x20Pong');else{if(_0x38f9c6['type']===_0x430856(0x1d7)){const {anomaly_score:_0xfa5099,is_anomaly:_0x4fea02,threshold:_0x5b23b1,explanation:_0x46a3b6}=_0x38f9c6[_0x430856(0x185)];_0x5ec334[_0x430856(0x1c8)][_0x430856(0x190)](_0x430856(0x1aa)+_0xfa5099['toFixed'](0x5)+_0x430856(0x1d3)+(_0x4fea02?_0x430856(0x1d8):'OK')),_0x5ec334[_0x430856(0x182)]('analysis.security.lastScore',{'val':_0xfa5099,'ack':!![]}),_0x5ec334[_0x430856(0x182)](_0x430856(0x1b1),{'val':new Date()[_0x430856(0x1bd)](),'ack':!![]});if(_0x5b23b1)_0x5ec334[_0x430856(0x182)](_0x430856(0x1c4),{'val':_0x5b23b1,'ack':!![]});if(_0x4fea02){let _0x37d290='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0xfa5099[_0x430856(0x1a0)](0x4)+')';if(_0x46a3b6&&_0x46a3b6!==_0x430856(0x1d1))_0x37d290+=_0x430856(0x1ba)+_0x46a3b6;_0x5ec334[_0x430856(0x182)](_0x430856(0x1c9),{'val':!![],'ack':!![]}),_0x5ec334[_0x430856(0x182)](_0x430856(0x193),{'val':_0x37d290,'ack':!![]}),setup[_0x430856(0x1af)](_0x5ec334,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x37d290,![],!![]);}}else{if(_0x38f9c6[_0x430856(0x1a4)]==='TRAINING_COMPLETE'){const _0x3130e2=_0x38f9c6['payload'][_0x430856(0x1c3)]||'',_0x56cada=_0x38f9c6['payload'][_0x430856(0x196)],_0x263cb1=_0x38f9c6[_0x430856(0x185)][_0x430856(0x1ca)]?_0x430856(0x19a)+new Date()[_0x430856(0x1d5)]()+'\x20('+_0x3130e2+')':_0x430856(0x186)+_0x38f9c6['payload']['reason'];_0x5ec334['setStateAsync'](_0x430856(0x17a),{'val':_0x263cb1,'ack':!![]});if(_0x38f9c6[_0x430856(0x185)]['success']&&_0x56cada)_0x5ec334[_0x430856(0x182)](_0x430856(0x1c4),{'val':_0x56cada,'ack':!![]});}else{if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x1cd)){const {patterns:_0x101b6a}=_0x38f9c6['payload'];if(_0x101b6a&&_0x101b6a['length']>0x0){_0x5ec334[_0x430856(0x1c8)][_0x430856(0x190)]('ðŸ›‹ï¸\x20BUTLER:\x20Found\x20'+_0x101b6a['length']+_0x430856(0x1b2)),_0x5ec334['setStateAsync']('analysis.automation.detectedPatterns',{'val':JSON[_0x430856(0x19d)](_0x101b6a),'ack':!![]});const _0x245ee2=_0x101b6a[0x0],_0x3670cf=_0x430856(0x180)+_0x245ee2[_0x430856(0x17b)]+'\x20('+(_0x245ee2[_0x430856(0x1a5)]*0x64)[_0x430856(0x1a0)](0x0)+'%)';_0x5ec334['setStateAsync'](_0x430856(0x1b7),{'val':!![],'ack':!![]}),_0x5ec334[_0x430856(0x182)](_0x430856(0x1bf),{'val':_0x3670cf,'ack':!![]});}else _0x5ec334['log'][_0x430856(0x190)](_0x430856(0x1be)),_0x5ec334[_0x430856(0x182)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x5ec334[_0x430856(0x182)](_0x430856(0x1bc),{'val':'[]','ack':!![]});}else{if(_0x38f9c6[_0x430856(0x1a4)]==='ENERGY_TRAIN_RESULT'){if(_0x38f9c6['payload']['success'])try{const _0x4d31b=JSON[_0x430856(0x177)](_0x38f9c6[_0x430856(0x185)]['details']);if(_0x4d31b[_0x430856(0x1b5)])_0x5ec334[_0x430856(0x182)](_0x430856(0x17e),{'val':JSON[_0x430856(0x19d)](_0x4d31b['insulation']),'ack':!![]});if(_0x4d31b[_0x430856(0x18a)])_0x5ec334['setStateAsync'](_0x430856(0x19e),{'val':JSON[_0x430856(0x19d)](_0x4d31b['heating']),'ack':!![]});}catch(_0x3fe865){}}else{if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x1a3)){if(_0x38f9c6['payload'][_0x430856(0x1ca)])_0x5ec334['log'][_0x430856(0x190)]('âœ…\x20HEALTH\x20TRAINED.');}else{if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x1d2))_0x5ec334[_0x430856(0x182)](_0x430856(0x189),{'val':new Date()[_0x430856(0x1bd)](),'ack':!![]}),_0x5ec334[_0x430856(0x182)]('analysis.health.isAnomaly',{'val':_0x38f9c6[_0x430856(0x185)][_0x430856(0x191)],'ack':!![]});else{if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x1d9))_0x5ec334[_0x430856(0x182)](_0x430856(0x19f),{'val':_0x38f9c6[_0x430856(0x185)][_0x430856(0x197)],'ack':!![]}),_0x5ec334[_0x430856(0x182)](_0x430856(0x1a1),{'val':_0x38f9c6[_0x430856(0x185)][_0x430856(0x1b3)],'ack':!![]});else{if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x1dc)){const {speed_trend:_0x5039c9}=_0x38f9c6[_0x430856(0x185)];if(_0x5039c9!==undefined)_0x5ec334[_0x430856(0x182)](_0x430856(0x178),{'val':_0x5039c9,'ack':!![]});}else{if(_0x38f9c6['type']===_0x430856(0x1d4)){const {forecast:_0x411c93}=_0x38f9c6[_0x430856(0x185)];if(_0x411c93)_0x5ec334[_0x430856(0x182)](_0x430856(0x174),{'val':JSON[_0x430856(0x19d)](_0x411c93),'ack':!![]});}else{if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x1ac)){const {data:_0x20262f}=_0x38f9c6[_0x430856(0x185)];_0x20262f&&(_0x5ec334[_0x430856(0x1c8)][_0x430856(0x190)](_0x430856(0x172)),_0x5ec334[_0x430856(0x182)]('analysis.security.topologyMatrix',{'val':JSON[_0x430856(0x19d)](_0x20262f),'ack':!![]}));}else{if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x181))_0x5ec334[_0x430856(0x1c8)]['debug'](_0x430856(0x1a2));else{if(_0x38f9c6[_0x430856(0x1a4)]===_0x430856(0x1b9)){const {room:_0x9d8dc5,propagation:_0x29e5d5}=_0x38f9c6[_0x430856(0x185)];let _0x4c34b3=_0x430856(0x1d1),_0x3e9141=0x0;if(_0x29e5d5){const _0xc02807=Object[_0x430856(0x1b4)](_0x29e5d5);_0xc02807[_0x430856(0x1d6)]>0x0&&(_0x4c34b3=_0xc02807[0x0][0x0],_0x3e9141=_0xc02807[0x0][0x1]);}_0x5ec334[_0x430856(0x182)](_0x430856(0x18f),{'val':_0x4c34b3,'ack':!![]}),_0x5ec334['setStateAsync'](_0x430856(0x1ad),{'val':_0x3e9141,'ack':!![]}),_0x3e9141>0.4&&_0x5ec334[_0x430856(0x1c8)]['debug'](_0x430856(0x1d0)+_0x9d8dc5+_0x430856(0x1c1)+_0x4c34b3+'\x20('+(_0x3e9141*0x64)[_0x430856(0x1a0)](0x0)+'%)'),automation[_0x430856(0x1ce)](_0x5ec334,_0x4c34b3,_0x3e9141);}}}}}}}}}}}}}}function a3_0x6965(){const _0x188f92=['\x20->\x20','ENERGY_PREDICT_RESULT','toLocaleTimeString','length','SECURITY_RESULT','ANOMALY','TREND_RESULT','Error\x20launching\x20Python:\x20','search','GAIT_RESULT','message','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','142unNCGB','analysis.energy.forecast','4753176KNrjbt','service.py','parse','analysis.health.gaitSpeed','writable','analysis.training.status','rule','toString','close','analysis.energy.insulationScore','path','Regel\x20erkannt:\x20','TOPOLOGY_ACK','setStateAsync','stdin','./automation','payload','Failed:\x20','[LOG]','491KTlGQu','analysis.health.lastCheck','heating','constructor','error','stdout','1437TaOOab','analysis.prediction.nextRoom','info','is_anomaly','621ScdhVN','analysis.alertReason','child_process','python3','threshold','diagnosis','5bApBwf','startsWith','Success:\x20','6342985HFVHhR','existsSync','stringify','analysis.energy.heatingScore','analysis.health.trendDiagnosis','toFixed','analysis.health.trendValue','ðŸ\x20Python\x20confirmed\x20new\x20topology.','HEALTH_TRAIN_RESULT','type','confidence','[PYTHON]\x20','debug','49690yObUNL','split','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','5036pKHTSr','TOPOLOGY_RESULT','analysis.prediction.confidence','kill','sendNotification','PONG','analysis.security.lastCheck','\x20new\x20patterns.','change_percent','entries','insulation','substring','analysis.automation.patternDetected','(((.+)+)+)+$','SIGNAL_RESULT','\x0aGrund:\x20','forEach','analysis.automation.detectedPatterns','toISOString','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','analysis.automation.description','4787526koGCYz','\x20->\x20Likely\x20','trim','details','analysis.security.currentThreshold','[RESULT]','7IRlzsE','1468389QTHOQk','log','analysis.isAlert','success','12jhfHwC','exports','COMFORT_RESULT','handlePrediction','data','ðŸ”®\x20Prediction:\x20From\x20','Unknown','HEALTH_RESULT'];a3_0x6965=function(){return _0x188f92;};return a3_0x6965();}function startService(_0x2dcb73,_0x51496b){const _0x4c2935=a3_0x210d10;let _0x6e1fa7=_0x4c2935(0x195);if(fs[_0x4c2935(0x19c)](_0x51496b))_0x6e1fa7=_0x51496b;try{const _0xbf4da0=path['join'](__dirname,'..','python_service',_0x4c2935(0x176));pythonProcess=spawn(_0x6e1fa7,[_0xbf4da0]),pythonProcess[_0x4c2935(0x18d)]['on'](_0x4c2935(0x1cf),_0x18323f=>{const _0x546bcf=_0x4c2935,_0x2db74f=_0x18323f[_0x546bcf(0x17c)]()[_0x546bcf(0x1a9)]('\x0a');_0x2db74f[_0x546bcf(0x1bb)](_0x242c98=>{const _0x2e56eb=_0x546bcf,_0x4112ba=_0x242c98[_0x2e56eb(0x1c2)]();if(!_0x4112ba)return;if(_0x4112ba[_0x2e56eb(0x199)](_0x2e56eb(0x187)))_0x2dcb73['log']['debug'](_0x2e56eb(0x1a6)+_0x4112ba[_0x2e56eb(0x1b6)](0x5)['trim']());else{if(_0x4112ba[_0x2e56eb(0x199)](_0x2e56eb(0x1c5)))try{const _0x38697f=JSON[_0x2e56eb(0x177)](_0x4112ba[_0x2e56eb(0x1b6)](0x8)[_0x2e56eb(0x1c2)]());handleResult(_0x2dcb73,_0x38697f);}catch(_0x169d8c){}}});}),pythonProcess['on'](_0x4c2935(0x17d),_0x3bcbf6=>{pythonProcess=null;}),_0x2dcb73['sendToPythonWrapper']=(_0x200ea7,_0x52766f)=>send(_0x2dcb73,_0x200ea7,_0x52766f);}catch(_0x26580e){_0x2dcb73[_0x4c2935(0x1c8)][_0x4c2935(0x18c)](_0x4c2935(0x1da)+_0x26580e[_0x4c2935(0x171)]);}}function stopService(_0xe988e2){const _0x518212=a3_0x210d10;if(pythonProcess){try{pythonProcess[_0x518212(0x1ae)]();}catch(_0x39809e){}pythonProcess=null;}}module[a3_0x210d10(0x1cc)]={'startService':startService,'stopService':stopService,'send':send};