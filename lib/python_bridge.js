const a4_0x45e67c=a4_0x14bc;(function(_0x471680,_0x6083e4){const _0x28b5cb=a4_0x14bc,_0x43298b=_0x471680();while(!![]){try{const _0x181fe7=parseInt(_0x28b5cb(0xd6))/0x1+parseInt(_0x28b5cb(0xee))/0x2*(-parseInt(_0x28b5cb(0xa7))/0x3)+-parseInt(_0x28b5cb(0xed))/0x4*(-parseInt(_0x28b5cb(0xbf))/0x5)+-parseInt(_0x28b5cb(0xd0))/0x6+parseInt(_0x28b5cb(0xc0))/0x7*(parseInt(_0x28b5cb(0xbb))/0x8)+-parseInt(_0x28b5cb(0x89))/0x9*(parseInt(_0x28b5cb(0xd3))/0xa)+parseInt(_0x28b5cb(0xcf))/0xb;if(_0x181fe7===_0x6083e4)break;else _0x43298b['push'](_0x43298b['shift']());}catch(_0x348564){_0x43298b['push'](_0x43298b['shift']());}}}(a4_0x4c6d,0x51300));const a4_0x1f2efd=(function(){let _0x4e7356=!![];return function(_0x4f80be,_0x5f47b2){const _0x272d62=_0x4e7356?function(){const _0x51bbd3=a4_0x14bc;if(_0x5f47b2){const _0x4c6352=_0x5f47b2[_0x51bbd3(0xf5)](_0x4f80be,arguments);return _0x5f47b2=null,_0x4c6352;}}:function(){};return _0x4e7356=![],_0x272d62;};}()),a4_0x178e00=a4_0x1f2efd(this,function(){const _0x56f999=a4_0x14bc;return a4_0x178e00[_0x56f999(0x75)]()['search']('(((.+)+)+)+$')[_0x56f999(0x75)]()['constructor'](a4_0x178e00)[_0x56f999(0xc6)](_0x56f999(0xa3));});function a4_0x14bc(_0x152ddd,_0x4807b9){const _0x7c3aec=a4_0x4c6d();return a4_0x14bc=function(_0x178e00,_0x1f2efd){_0x178e00=_0x178e00-0x69;let _0x4c6dfb=_0x7c3aec[_0x178e00];return _0x4c6dfb;},a4_0x14bc(_0x152ddd,_0x4807b9);}a4_0x178e00();'use strict';const {spawn}=require(a4_0x45e67c(0xe0)),path=require(a4_0x45e67c(0xcb)),fs=require('fs'),setup=require(a4_0x45e67c(0xf6)),automation=require(a4_0x45e67c(0xef));let pythonProcess=null;function send(_0xb6b2b7,_0xf64e50,_0xc89e63={}){const _0x2958b2=a4_0x45e67c;if(!pythonProcess||!pythonProcess['stdin'][_0x2958b2(0x70)])return;if(_0xf64e50===_0x2958b2(0xe3)){const _0x59f7d7=JSON[_0x2958b2(0x6c)](JSON['stringify'](_0xc89e63));_0x59f7d7['rooms']&&Array[_0x2958b2(0xe6)](_0x59f7d7[_0x2958b2(0x8f)])&&(_0x59f7d7[_0x2958b2(0x8f)]=_0x59f7d7[_0x2958b2(0x8f)][_0x2958b2(0xca)](_0x33ef68=>setup[_0x2958b2(0xc4)](_0x33ef68)),_0xb6b2b7['log'][_0x2958b2(0x93)](_0x2958b2(0xcd)+_0x59f7d7['rooms'][_0x2958b2(0x71)](0x0,0x3)[_0x2958b2(0x8a)](',\x20')+'...')),_0x59f7d7[_0x2958b2(0x78)]&&Array['isArray'](_0x59f7d7[_0x2958b2(0x78)])&&(_0x59f7d7[_0x2958b2(0x78)]=_0x59f7d7[_0x2958b2(0x78)][_0x2958b2(0xca)](_0x1c11e7=>setup[_0x2958b2(0xc4)](_0x1c11e7))),_0xc89e63=_0x59f7d7;}if((_0xf64e50==='TRAIN_TOPOLOGY'||_0xf64e50==='TRAIN_SECURITY')&&_0xc89e63[_0x2958b2(0x87)]){if(Array['isArray'](_0xc89e63[_0x2958b2(0x87)]))try{_0xc89e63[_0x2958b2(0x87)][_0x2958b2(0xf4)]>0x0&&_0xb6b2b7[_0x2958b2(0xe2)][_0x2958b2(0x93)]('[Bridge-Debug]\x20Raw\x20Sequence\x20[0]:\x20'+JSON['stringify'](_0xc89e63[_0x2958b2(0x87)][0x0])),_0xc89e63[_0x2958b2(0x87)]=_0xc89e63[_0x2958b2(0x87)][_0x2958b2(0xca)](_0x4bdfc7=>{const _0x5e629d=_0x2958b2;if(Array[_0x5e629d(0xe6)](_0x4bdfc7))return _0x4bdfc7[_0x5e629d(0xca)](_0x480a70=>setup['normalizeRoomId'](_0x480a70));return[];}),_0xc89e63[_0x2958b2(0x87)]['length']>0x0&&_0xb6b2b7[_0x2958b2(0xe2)]['info']('[Bridge-Debug]\x20Normalized\x20Sequence\x20[0]:\x20'+JSON[_0x2958b2(0xbc)](_0xc89e63[_0x2958b2(0x87)][0x0]));}catch(_0x29e353){_0xb6b2b7[_0x2958b2(0xe2)][_0x2958b2(0x8c)](_0x2958b2(0xf1)+_0x29e353[_0x2958b2(0x77)]),_0xc89e63['sequences']=[];}else _0xc89e63[_0x2958b2(0x87)]=[];}_0xc89e63[_0x2958b2(0xd2)]&&typeof _0xc89e63[_0x2958b2(0xd2)]==='string'&&(_0xc89e63['room']=setup[_0x2958b2(0xc4)](_0xc89e63[_0x2958b2(0xd2)]));if(_0xc89e63[_0x2958b2(0x6f)]&&typeof _0xc89e63['current_temps']===_0x2958b2(0xc9)){const _0x299e2c={};for(const [_0x2c7e0c,_0x371a40]of Object[_0x2958b2(0xb9)](_0xc89e63['current_temps']))_0x299e2c[setup[_0x2958b2(0xc4)](_0x2c7e0c)]=_0x371a40;_0xc89e63[_0x2958b2(0x6f)]=_0x299e2c;}const _0x50f50e=JSON[_0x2958b2(0xbc)]({'command':_0xf64e50,..._0xc89e63});try{pythonProcess[_0x2958b2(0xa4)][_0x2958b2(0xdf)](_0x50f50e+'\x0a');}catch(_0x3a0094){}}function handleResult(_0x21b18c,_0x1446f3){const _0x465e09=a4_0x45e67c;if(_0x1446f3[_0x465e09(0xae)]==='PONG')_0x21b18c[_0x465e09(0xe2)][_0x465e09(0x9a)](_0x465e09(0xa6));else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0xda)){const {anomaly_score:_0x341b43,is_anomaly:_0x1d972b,threshold:_0x3defab,explanation:_0x2b6517}=_0x1446f3[_0x465e09(0xec)];_0x21b18c[_0x465e09(0xad)]('analysis.security.lastScore',{'val':_0x341b43,'ack':!![]}),_0x21b18c[_0x465e09(0xad)](_0x465e09(0xf3),{'val':new Date()[_0x465e09(0xc7)](),'ack':!![]});if(_0x3defab)_0x21b18c['setStateAsync'](_0x465e09(0xc5),{'val':_0x3defab,'ack':!![]});if(_0x1d972b){let _0x25a63d=_0x465e09(0x97)+_0x341b43[_0x465e09(0xb7)](0x4)+')';if(_0x2b6517&&_0x2b6517!==_0x465e09(0x84))_0x25a63d+=_0x465e09(0xb3)+_0x2b6517;_0x21b18c[_0x465e09(0xad)](_0x465e09(0x7e),{'val':!![],'ack':!![]}),_0x21b18c[_0x465e09(0xad)](_0x465e09(0xe9),{'val':_0x25a63d,'ack':!![]}),setup['sendNotification'](_0x21b18c,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x25a63d,![],!![]);}}else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0x8d)){const _0x533f6d=_0x1446f3[_0x465e09(0xec)][_0x465e09(0x9d)]||'',_0x151fc1=_0x1446f3['payload'][_0x465e09(0x85)],_0x3792ac=_0x1446f3[_0x465e09(0xec)][_0x465e09(0x7c)]?_0x465e09(0xdd)+new Date()[_0x465e09(0xb0)]()+'\x20('+_0x533f6d+')':_0x465e09(0xce)+_0x1446f3[_0x465e09(0xec)]['reason'];_0x21b18c[_0x465e09(0xad)](_0x465e09(0xa8),{'val':_0x3792ac,'ack':!![]});if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0x7c)]&&_0x151fc1)_0x21b18c[_0x465e09(0xad)](_0x465e09(0xc5),{'val':_0x151fc1,'ack':!![]});}else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0xa1)){const _0x2d432e=_0x465e09(0x7d)+_0x1446f3[_0x465e09(0xec)]['rooms']['length']+_0x465e09(0x6d);_0x21b18c['setStateAsync']('analysis.training.status',{'val':_0x2d432e,'ack':!![]});}else{if(_0x1446f3[_0x465e09(0xae)]==='ENERGY_TRAIN_RESULT'){if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0x7c)])try{const _0x39ab11=JSON[_0x465e09(0x6c)](_0x1446f3['payload'][_0x465e09(0x9d)]);if(_0x39ab11[_0x465e09(0x92)])_0x21b18c[_0x465e09(0xad)](_0x465e09(0xba),{'val':JSON[_0x465e09(0xbc)](_0x39ab11[_0x465e09(0x92)]),'ack':!![]});if(_0x39ab11[_0x465e09(0xaa)])_0x21b18c[_0x465e09(0xad)](_0x465e09(0x9f),{'val':JSON[_0x465e09(0xbc)](_0x39ab11[_0x465e09(0xaa)]),'ack':!![]});}catch(_0x250cea){}}else{if(_0x1446f3['type']===_0x465e09(0xde))_0x21b18c['log'][_0x465e09(0x93)](_0x465e09(0xb8)),_0x21b18c[_0x465e09(0xad)]('analysis.health.lastCheck',{'val':new Date()[_0x465e09(0x72)](),'ack':!![]});else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0x96))_0x21b18c[_0x465e09(0xad)](_0x465e09(0xd1),{'val':_0x1446f3[_0x465e09(0xec)][_0x465e09(0xa5)],'ack':!![]});else{if(_0x1446f3[_0x465e09(0xae)]==='HEALTH_TREND_RESULT')_0x21b18c[_0x465e09(0xad)](_0x465e09(0xd9),{'val':_0x1446f3[_0x465e09(0xec)][_0x465e09(0x94)],'ack':!![]}),_0x21b18c['log']['info'](_0x465e09(0x7a)+_0x1446f3[_0x465e09(0xec)][_0x465e09(0x9d)]);else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0xe7)){if(_0x1446f3[_0x465e09(0xec)]['speed_trend']!==undefined)_0x21b18c[_0x465e09(0xad)]('analysis.health.gaitSpeed',{'val':_0x1446f3[_0x465e09(0xec)][_0x465e09(0xbe)],'ack':!![]});if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0x69)])_0x21b18c[_0x465e09(0xad)](_0x465e09(0xbd),{'val':_0x1446f3[_0x465e09(0xec)][_0x465e09(0x69)][_0x465e09(0x8a)](',\x20'),'ack':!![]});if(_0x1446f3['payload'][_0x465e09(0xe8)])_0x21b18c[_0x465e09(0xad)](_0x465e09(0xeb),{'val':_0x1446f3[_0x465e09(0xec)][_0x465e09(0xe8)],'ack':!![]});}else{if(_0x1446f3['type']===_0x465e09(0x95)){if(_0x1446f3[_0x465e09(0xec)]['forecast'])_0x21b18c[_0x465e09(0xad)](_0x465e09(0x86),{'val':JSON[_0x465e09(0xbc)](_0x1446f3[_0x465e09(0xec)][_0x465e09(0xdc)]),'ack':!![]});}else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0xb2)){if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0xb1)])_0x21b18c[_0x465e09(0xad)](_0x465e09(0xa2),{'val':JSON[_0x465e09(0xbc)](_0x1446f3[_0x465e09(0xec)][_0x465e09(0xb1)]),'ack':!![]});if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0xd4)])_0x21b18c['setStateAsync'](_0x465e09(0xe4),{'val':JSON[_0x465e09(0xbc)](_0x1446f3['payload'][_0x465e09(0xd4)]),'ack':!![]});if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0x9d)])_0x21b18c[_0x465e09(0xad)](_0x465e09(0x73),{'val':JSON[_0x465e09(0xbc)](_0x1446f3[_0x465e09(0xec)][_0x465e09(0x9d)]),'ack':!![]});}else{if(_0x1446f3[_0x465e09(0xae)]==='RL_PENALTY_UPDATE'){if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0xf2)])_0x21b18c[_0x465e09(0xad)](_0x465e09(0xa9),{'val':JSON[_0x465e09(0xbc)](_0x1446f3['payload'][_0x465e09(0xf2)]),'ack':!![]});}else{if(_0x1446f3['type']===_0x465e09(0x6a)){if(_0x1446f3['payload']['forecast'])_0x21b18c[_0x465e09(0xad)](_0x465e09(0x9e),{'val':JSON[_0x465e09(0xbc)](_0x1446f3[_0x465e09(0xec)]['forecast']),'ack':!![]});}else{if(_0x1446f3[_0x465e09(0xae)]==='VENTILATION_ALERT'){if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0x9c)])_0x21b18c[_0x465e09(0xad)](_0x465e09(0x9b),{'val':JSON['stringify'](_0x1446f3[_0x465e09(0xec)][_0x465e09(0x9c)]),'ack':!![]});}else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0x7b)){const {proposals:_0x336932}=_0x1446f3[_0x465e09(0xec)];_0x21b18c[_0x465e09(0x8b)](_0x465e09(0xac),(_0x10f9d3,_0x388420)=>{const _0x2ef90e=_0x465e09;if(_0x388420&&_0x388420[_0x2ef90e(0xb6)]===!![]&&_0x336932&&_0x336932[_0x2ef90e(0xf4)]>0x0)automation[_0x2ef90e(0x7f)](_0x21b18c,_0x336932);});}else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0x82)){const {propagation:_0x358ea1}=_0x1446f3[_0x465e09(0xec)];let _0x5f197c=_0x465e09(0x84),_0x5829d3=0x0;if(_0x358ea1){const _0x156edc=Object[_0x465e09(0xb9)](_0x358ea1);_0x156edc[_0x465e09(0xf4)]>0x0&&(_0x5f197c=_0x156edc[0x0][0x0],_0x5829d3=_0x156edc[0x0][0x1]);}_0x21b18c[_0x465e09(0xad)]('analysis.prediction.nextRoom',{'val':_0x5f197c,'ack':!![]}),_0x21b18c[_0x465e09(0xad)](_0x465e09(0xcc),{'val':_0x5829d3,'ack':!![]}),automation['handlePrediction'](_0x21b18c,_0x5f197c,_0x5829d3);}else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0x6e)){const {probabilities:_0xb21f83}=_0x1446f3[_0x465e09(0xec)];if(_0xb21f83){_0x21b18c['setStateAsync']('analysis.prediction.trackerState',{'val':JSON['stringify'](_0xb21f83),'ack':!![]});const _0x4f2b70=Object[_0x465e09(0xe1)](_0xb21f83);_0x4f2b70[_0x465e09(0xf4)]>0x0&&(_0x21b18c[_0x465e09(0xad)](_0x465e09(0x90),{'val':_0x4f2b70[0x0],'ack':!![]}),_0x21b18c[_0x465e09(0xad)](_0x465e09(0xc8),{'val':_0xb21f83[_0x4f2b70[0x0]],'ack':!![]}));}}else{if(_0x1446f3[_0x465e09(0xae)]===_0x465e09(0x91)){if(_0x1446f3[_0x465e09(0xec)][_0x465e09(0x80)])_0x21b18c[_0x465e09(0xad)]('analysis.automation.detectedPatterns',{'val':JSON[_0x465e09(0xbc)](_0x1446f3['payload']['patterns']),'ack':!![]});}}}}}}}}}}}}}}}}}}}function a4_0x4c6d(){const _0x5844ac=['length','apply','./setup','sensors','PINN_PREDICT_RESULT','error','parse','\x20Rooms)','TRACKER_RESULT','current_temps','writable','slice','toLocaleDateString','analysis.energy.warmupDetails','split','toString','kill','message','monitored','stdout','ðŸ“ˆ\x20Health\x20Trend:\x20','ENERGY_OPTIMIZE_RESULT','success','Graph\x20Updated\x20(','analysis.isAlert','applyEnergySavings','patterns','close','SIGNAL_RESULT','[RESULT]','Unknown','threshold','analysis.energy.forecast','sequences','Python\x20process\x20exited\x20with\x20code\x20','1935405XijpZC','join','getState','warn','TRAINING_COMPLETE','service.py','rooms','analysis.prediction.trackerTopRoom','COMFORT_RESULT','insulation','info','trend_percent','ENERGY_PREDICT_RESULT','HEALTH_RESULT','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','[PYTHON\x20ERR]\x20','python_service','debug','analysis.energy.ventilationAlerts','alerts','details','analysis.energy.pinnForecast','analysis.energy.heatingScore','ðŸš€\x20Starting\x20Python\x20Bridge\x20using:\x20','GRAPH_TRAINED','analysis.energy.warmupTimes','(((.+)+)+)+$','stdin','is_anomaly','ðŸ\x20Python\x20Pong','34062iSCBJg','analysis.training.status','analysis.energy.rlPenalties','heating','Error\x20launching\x20Python:\x20','analysis.energy.mpcActive','setStateAsync','type','startsWith','toLocaleTimeString','times','WARMUP_RESULT','\x0aGrund:\x20','forEach','data','val','toFixed','âœ…\x20HEALTH\x20TRAINED.','entries','analysis.energy.insulationScore','8GQlAtW','stringify','analysis.health.gaitSensors','speed_trend','7415wCtgnW','1446494FjjUkA','stderr','trim','[LOG]','normalizeRoomId','analysis.security.currentThreshold','search','toISOString','analysis.prediction.trackerConfidence','object','map','path','analysis.prediction.confidence','[Bridge-Debug]\x20Setting\x20Topology\x20Rooms\x20(Sample):\x20','Failed:\x20','4084080lFWEhO','1406370WdsFrz','analysis.health.isAnomaly','room','20hDiObg','sources','sendToPythonWrapper','376878AsqamO','python3','[PYTHON]\x20','analysis.health.activityTrend','SECURITY_RESULT','âŒ\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!','forecast','Success:\x20','HEALTH_TRAIN_RESULT','write','child_process','keys','log','SET_TOPOLOGY','analysis.energy.warmupSources','existsSync','isArray','GAIT_RESULT','proof','analysis.alertReason','exports','analysis.health.gaitDebug','payload','1492dhAKsW','90cmKapO','./automation','substring','Gateway\x20Error:\x20','penalties','analysis.security.lastCheck'];a4_0x4c6d=function(){return _0x5844ac;};return a4_0x4c6d();}function startService(_0x1dc62a,_0x2bcbd2){const _0x5f376b=a4_0x45e67c;let _0x124aad=_0x5f376b(0xd7);if(fs['existsSync'](_0x2bcbd2))_0x124aad=_0x2bcbd2;const _0x18bb0d=path[_0x5f376b(0x8a)](__dirname,'..',_0x5f376b(0x8e)),_0x2f13f4=path['join'](__dirname,'..',_0x5f376b(0x99),_0x5f376b(0x8e));let _0x27476b=fs[_0x5f376b(0xe5)](_0x18bb0d)?_0x18bb0d:fs[_0x5f376b(0xe5)](_0x2f13f4)?_0x2f13f4:null;if(!_0x27476b){_0x1dc62a[_0x5f376b(0xe2)][_0x5f376b(0x6b)](_0x5f376b(0xdb));return;}try{_0x1dc62a[_0x5f376b(0xe2)][_0x5f376b(0x93)](_0x5f376b(0xa0)+_0x124aad+'\x20'+_0x27476b),pythonProcess=spawn(_0x124aad,[_0x27476b]),pythonProcess[_0x5f376b(0x79)]['on'](_0x5f376b(0xb5),_0x58607e=>{const _0x6cecde=_0x5f376b,_0x4f8e58=_0x58607e[_0x6cecde(0x75)]()[_0x6cecde(0x74)]('\x0a');_0x4f8e58[_0x6cecde(0xb4)](_0x146bb8=>{const _0x22c271=_0x6cecde,_0x50dc45=_0x146bb8[_0x22c271(0xc2)]();if(!_0x50dc45)return;if(_0x50dc45[_0x22c271(0xaf)](_0x22c271(0xc3)))_0x1dc62a[_0x22c271(0xe2)]['debug'](_0x22c271(0xd8)+_0x50dc45['substring'](0x5)[_0x22c271(0xc2)]());else{if(_0x50dc45[_0x22c271(0xaf)](_0x22c271(0x83)))try{const _0x9bca0c=JSON[_0x22c271(0x6c)](_0x50dc45[_0x22c271(0xf0)](0x8)['trim']());handleResult(_0x1dc62a,_0x9bca0c);}catch(_0x48c334){}}});}),pythonProcess[_0x5f376b(0xc1)]['on'](_0x5f376b(0xb5),_0x212402=>{const _0x51642f=_0x5f376b;_0x1dc62a[_0x51642f(0xe2)][_0x51642f(0x6b)](_0x51642f(0x98)+_0x212402['toString']()[_0x51642f(0xc2)]());}),pythonProcess['on'](_0x5f376b(0x81),_0x3c6cd1=>{const _0x7fee19=_0x5f376b;_0x1dc62a[_0x7fee19(0xe2)][_0x7fee19(0x8c)](_0x7fee19(0x88)+_0x3c6cd1),pythonProcess=null;}),_0x1dc62a[_0x5f376b(0xd5)]=(_0x816b09,_0xe78d93)=>send(_0x1dc62a,_0x816b09,_0xe78d93);}catch(_0x26aa5a){_0x1dc62a[_0x5f376b(0xe2)]['error'](_0x5f376b(0xab)+_0x26aa5a[_0x5f376b(0x77)]);}}function stopService(_0x2363e5){const _0x38e802=a4_0x45e67c;if(pythonProcess){try{pythonProcess[_0x38e802(0x76)]();}catch(_0x3c0a9f){}pythonProcess=null;}}module[a4_0x45e67c(0xea)]={'startService':startService,'stopService':stopService,'send':send};