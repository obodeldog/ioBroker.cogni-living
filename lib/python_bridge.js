const a4_0xc10fc3=a4_0x34b4;(function(_0x442140,_0x5f964b){const _0x340a9c=a4_0x34b4,_0x4d75a0=_0x442140();while(!![]){try{const _0x4e2307=-parseInt(_0x340a9c(0xd3))/0x1+-parseInt(_0x340a9c(0x78))/0x2*(parseInt(_0x340a9c(0x6e))/0x3)+-parseInt(_0x340a9c(0xe0))/0x4+-parseInt(_0x340a9c(0xb0))/0x5*(parseInt(_0x340a9c(0xd1))/0x6)+-parseInt(_0x340a9c(0xe3))/0x7+parseInt(_0x340a9c(0x77))/0x8+parseInt(_0x340a9c(0x6f))/0x9*(parseInt(_0x340a9c(0x79))/0xa);if(_0x4e2307===_0x5f964b)break;else _0x4d75a0['push'](_0x4d75a0['shift']());}catch(_0x1d9f22){_0x4d75a0['push'](_0x4d75a0['shift']());}}}(a4_0x5482,0x30685));const a4_0x473d5a=(function(){let _0x1b6c8f=!![];return function(_0x23065b,_0x4365ee){const _0x4222fd=_0x1b6c8f?function(){if(_0x4365ee){const _0x5e8bdd=_0x4365ee['apply'](_0x23065b,arguments);return _0x4365ee=null,_0x5e8bdd;}}:function(){};return _0x1b6c8f=![],_0x4222fd;};}()),a4_0x376abd=a4_0x473d5a(this,function(){const _0x450466=a4_0x34b4;return a4_0x376abd[_0x450466(0xdd)]()[_0x450466(0xbb)](_0x450466(0xb2))[_0x450466(0xdd)]()[_0x450466(0xce)](a4_0x376abd)[_0x450466(0xbb)]('(((.+)+)+)+$');});a4_0x376abd();'use strict';const {spawn}=require(a4_0xc10fc3(0x89)),path=require('path'),fs=require('fs'),setup=require('./setup'),automation=require('./automation');function a4_0x34b4(_0x153f72,_0x2c5c8b){const _0x2232e4=a4_0x5482();return a4_0x34b4=function(_0x376abd,_0x473d5a){_0x376abd=_0x376abd-0x68;let _0x548285=_0x2232e4[_0x376abd];return _0x548285;},a4_0x34b4(_0x153f72,_0x2c5c8b);}let pythonProcess=null;function a4_0x5482(){const _0x32d114=['monitored','search','TRACKER_RESULT','analysis.security.lastCheck','ðŸ“ˆ\x20Health\x20Trend:\x20','Python\x20process\x20exited\x20with\x20code\x20','isArray','analysis.energy.warmupDetails','analysis.health.gaitDebug','alerts','analysis.automation.detectedPatterns','Failed:\x20','analysis.health.activityTrend','speed_trend','stdin','string','HEALTH_RESULT','PONG','stdout','analysis.energy.pinnForecast','constructor','error','payload','6QoKDff','success','282599JhIFHK','analysis.energy.heatingScore','close','analysis.prediction.trackerConfidence','substring','times','existsSync','python3','trim','analysis.energy.rlPenalties','toString','normalizeRoomId','patterns','1523768IoUUgy','sendToPythonWrapper','WARMUP_RESULT','2044644hcZgPT','join','forEach','Unknown','SET_TOPOLOGY','ENERGY_OPTIMIZE_RESULT','analysis.energy.insulationScore','info','1212loiUeD','13168809uJwYee','ðŸš€\x20Starting\x20Python\x20Bridge\x20using:\x20','analysis.health.isAnomaly','type','analysis.security.currentThreshold','message','val','âŒ\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!','557528ICdeGc','926wPFCSL','10kgbiRW','length','applyEnergySavings','service.py','ENERGY_TRAIN_RESULT','threshold','[RESULT]','Error\x20launching\x20Python:\x20','sensors','forecast','TRAIN_SECURITY','startsWith','room','analysis.isAlert','log','parse','child_process','âœ…\x20HEALTH\x20TRAINED.','debug','entries','sequences','Gateway\x20Error:\x20','kill','analysis.security.lastScore','split','penalties','details','warn','analysis.energy.mpcActive','proof','analysis.prediction.nextRoom','heating','SIGNAL_RESULT','HEALTH_TRAIN_RESULT','setStateAsync','stringify','handlePrediction','analysis.prediction.trackerState','GRAPH_TRAINED','rooms','reason','GAIT_RESULT','ðŸ\x20Python\x20Pong','[LOG]','ENERGY_PREDICT_RESULT','object','is_anomaly','analysis.alertReason','PINN_PREDICT_RESULT','map','analysis.health.lastCheck','[PYTHON\x20ERR]\x20','analysis.training.status','stderr','\x20Rooms)','959650MWWGqw','HEALTH_TREND_RESULT','(((.+)+)+)+$','insulation','RL_PENALTY_UPDATE','sources','TRAINING_COMPLETE','TRAIN_TOPOLOGY','Graph\x20Updated\x20(','current_temps'];a4_0x5482=function(){return _0x32d114;};return a4_0x5482();}function send(_0x48c2b1,_0x5ca0f0,_0x3f7fab={}){const _0x268301=a4_0xc10fc3;if(!pythonProcess||!pythonProcess[_0x268301(0xc8)]['writable'])return;if(_0x5ca0f0===_0x268301(0x6a)){const _0x3d635b=JSON[_0x268301(0x88)](JSON[_0x268301(0x9c)](_0x3f7fab));_0x3d635b[_0x268301(0xa0)]&&Array[_0x268301(0xc0)](_0x3d635b[_0x268301(0xa0)])&&(_0x3d635b[_0x268301(0xa0)]=_0x3d635b['rooms'][_0x268301(0xaa)](_0x321ad5=>setup[_0x268301(0xde)](_0x321ad5))),_0x3d635b[_0x268301(0xba)]&&Array['isArray'](_0x3d635b[_0x268301(0xba)])&&(_0x3d635b[_0x268301(0xba)]=_0x3d635b['monitored'][_0x268301(0xaa)](_0x4e9b55=>setup[_0x268301(0xde)](_0x4e9b55))),_0x3f7fab=_0x3d635b;}if((_0x5ca0f0===_0x268301(0xb7)||_0x5ca0f0===_0x268301(0x83))&&_0x3f7fab[_0x268301(0x8d)]){if(Array['isArray'](_0x3f7fab[_0x268301(0x8d)]))try{_0x3f7fab[_0x268301(0x8d)]=_0x3f7fab[_0x268301(0x8d)][_0x268301(0xaa)](_0x31caef=>{const _0x3fe382=_0x268301;if(Array[_0x3fe382(0xc0)](_0x31caef))return _0x31caef[_0x3fe382(0xaa)](_0x4fd5f3=>setup[_0x3fe382(0xde)](_0x4fd5f3));return[];});}catch(_0x234e46){_0x48c2b1[_0x268301(0x87)]['warn'](_0x268301(0x8e)+_0x234e46['message']),_0x3f7fab[_0x268301(0x8d)]=[];}else _0x3f7fab[_0x268301(0x8d)]=[];}_0x3f7fab[_0x268301(0x85)]&&typeof _0x3f7fab[_0x268301(0x85)]===_0x268301(0xc9)&&(_0x3f7fab[_0x268301(0x85)]=setup[_0x268301(0xde)](_0x3f7fab[_0x268301(0x85)]));if(_0x3f7fab[_0x268301(0xb9)]&&typeof _0x3f7fab[_0x268301(0xb9)]===_0x268301(0xa6)){const _0x3ba634={};for(const [_0x53e958,_0x28c939]of Object[_0x268301(0x8c)](_0x3f7fab[_0x268301(0xb9)]))_0x3ba634[setup[_0x268301(0xde)](_0x53e958)]=_0x28c939;_0x3f7fab[_0x268301(0xb9)]=_0x3ba634;}const _0x58e8e4=JSON[_0x268301(0x9c)]({'command':_0x5ca0f0,..._0x3f7fab});try{pythonProcess[_0x268301(0xc8)]['write'](_0x58e8e4+'\x0a');}catch(_0x134c58){}}function handleResult(_0x26cfa7,_0x54fa53){const _0x450462=a4_0xc10fc3;if(_0x54fa53[_0x450462(0x72)]===_0x450462(0xcb))_0x26cfa7['log'][_0x450462(0x8b)](_0x450462(0xa3));else{if(_0x54fa53[_0x450462(0x72)]==='SECURITY_RESULT'){const {anomaly_score:_0x5aa82f,is_anomaly:_0x233406,threshold:_0x405053,explanation:_0x3a96bb}=_0x54fa53['payload'];_0x26cfa7['setStateAsync'](_0x450462(0x90),{'val':_0x5aa82f,'ack':!![]}),_0x26cfa7[_0x450462(0x9b)](_0x450462(0xbd),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x405053)_0x26cfa7[_0x450462(0x9b)]('analysis.security.currentThreshold',{'val':_0x405053,'ack':!![]});if(_0x233406){let _0x164fa0='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x5aa82f['toFixed'](0x4)+')';if(_0x3a96bb&&_0x3a96bb!==_0x450462(0x69))_0x164fa0+='\x0aGrund:\x20'+_0x3a96bb;_0x26cfa7['setStateAsync'](_0x450462(0x86),{'val':!![],'ack':!![]}),_0x26cfa7[_0x450462(0x9b)](_0x450462(0xa8),{'val':_0x164fa0,'ack':!![]}),setup['sendNotification'](_0x26cfa7,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x164fa0,![],!![]);}}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0xb6)){const _0x4fd24a=_0x54fa53[_0x450462(0xd0)][_0x450462(0x93)]||'',_0x500881=_0x54fa53[_0x450462(0xd0)][_0x450462(0x7e)],_0x5e1414=_0x54fa53[_0x450462(0xd0)][_0x450462(0xd2)]?'Success:\x20'+new Date()['toLocaleTimeString']()+'\x20('+_0x4fd24a+')':_0x450462(0xc5)+_0x54fa53[_0x450462(0xd0)][_0x450462(0xa1)];_0x26cfa7[_0x450462(0x9b)](_0x450462(0xad),{'val':_0x5e1414,'ack':!![]});if(_0x54fa53[_0x450462(0xd0)]['success']&&_0x500881)_0x26cfa7[_0x450462(0x9b)](_0x450462(0x73),{'val':_0x500881,'ack':!![]});}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0x9f)){const _0x19bbc8=_0x450462(0xb8)+_0x54fa53['payload'][_0x450462(0xa0)][_0x450462(0x7a)]+_0x450462(0xaf);_0x26cfa7[_0x450462(0x9b)]('analysis.training.status',{'val':_0x19bbc8,'ack':!![]});}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0x7d)){if(_0x54fa53[_0x450462(0xd0)][_0x450462(0xd2)])try{const _0x50005e=JSON[_0x450462(0x88)](_0x54fa53[_0x450462(0xd0)][_0x450462(0x93)]);if(_0x50005e[_0x450462(0xb3)])_0x26cfa7[_0x450462(0x9b)](_0x450462(0x6c),{'val':JSON[_0x450462(0x9c)](_0x50005e[_0x450462(0xb3)]),'ack':!![]});if(_0x50005e[_0x450462(0x98)])_0x26cfa7[_0x450462(0x9b)](_0x450462(0xd4),{'val':JSON[_0x450462(0x9c)](_0x50005e[_0x450462(0x98)]),'ack':!![]});}catch(_0x80b067){}}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0x9a))_0x26cfa7[_0x450462(0x87)][_0x450462(0x6d)](_0x450462(0x8a)),_0x26cfa7[_0x450462(0x9b)](_0x450462(0xab),{'val':new Date()['toLocaleDateString'](),'ack':!![]});else{if(_0x54fa53['type']===_0x450462(0xca))_0x26cfa7['setStateAsync'](_0x450462(0x71),{'val':_0x54fa53['payload'][_0x450462(0xa7)],'ack':!![]});else{if(_0x54fa53['type']===_0x450462(0xb1))_0x26cfa7[_0x450462(0x9b)](_0x450462(0xc6),{'val':_0x54fa53['payload']['trend_percent'],'ack':!![]}),_0x26cfa7[_0x450462(0x87)]['info'](_0x450462(0xbe)+_0x54fa53['payload'][_0x450462(0x93)]);else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0xa2)){if(_0x54fa53[_0x450462(0xd0)][_0x450462(0xc7)]!==undefined)_0x26cfa7[_0x450462(0x9b)]('analysis.health.gaitSpeed',{'val':_0x54fa53['payload'][_0x450462(0xc7)],'ack':!![]});if(_0x54fa53[_0x450462(0xd0)][_0x450462(0x81)])_0x26cfa7[_0x450462(0x9b)]('analysis.health.gaitSensors',{'val':_0x54fa53[_0x450462(0xd0)]['sensors'][_0x450462(0xe4)](',\x20'),'ack':!![]});if(_0x54fa53[_0x450462(0xd0)][_0x450462(0x96)])_0x26cfa7['setStateAsync'](_0x450462(0xc2),{'val':_0x54fa53['payload'][_0x450462(0x96)],'ack':!![]});}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0xa5)){if(_0x54fa53['payload'][_0x450462(0x82)])_0x26cfa7[_0x450462(0x9b)]('analysis.energy.forecast',{'val':JSON['stringify'](_0x54fa53[_0x450462(0xd0)][_0x450462(0x82)]),'ack':!![]});}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0xe2)){if(_0x54fa53[_0x450462(0xd0)][_0x450462(0xd8)])_0x26cfa7[_0x450462(0x9b)]('analysis.energy.warmupTimes',{'val':JSON[_0x450462(0x9c)](_0x54fa53[_0x450462(0xd0)]['times']),'ack':!![]});if(_0x54fa53[_0x450462(0xd0)][_0x450462(0xb5)])_0x26cfa7[_0x450462(0x9b)]('analysis.energy.warmupSources',{'val':JSON[_0x450462(0x9c)](_0x54fa53[_0x450462(0xd0)][_0x450462(0xb5)]),'ack':!![]});if(_0x54fa53[_0x450462(0xd0)][_0x450462(0x93)])_0x26cfa7['setStateAsync'](_0x450462(0xc1),{'val':JSON[_0x450462(0x9c)](_0x54fa53[_0x450462(0xd0)][_0x450462(0x93)]),'ack':!![]});}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0xb4)){if(_0x54fa53[_0x450462(0xd0)][_0x450462(0x92)])_0x26cfa7[_0x450462(0x9b)](_0x450462(0xdc),{'val':JSON[_0x450462(0x9c)](_0x54fa53[_0x450462(0xd0)][_0x450462(0x92)]),'ack':!![]});}else{if(_0x54fa53['type']===_0x450462(0xa9)){if(_0x54fa53[_0x450462(0xd0)][_0x450462(0x82)])_0x26cfa7['setStateAsync'](_0x450462(0xcd),{'val':JSON[_0x450462(0x9c)](_0x54fa53[_0x450462(0xd0)][_0x450462(0x82)]),'ack':!![]});}else{if(_0x54fa53[_0x450462(0x72)]==='VENTILATION_ALERT'){if(_0x54fa53[_0x450462(0xd0)][_0x450462(0xc3)])_0x26cfa7[_0x450462(0x9b)]('analysis.energy.ventilationAlerts',{'val':JSON[_0x450462(0x9c)](_0x54fa53[_0x450462(0xd0)][_0x450462(0xc3)]),'ack':!![]});}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0x6b)){const {proposals:_0x377dd3}=_0x54fa53[_0x450462(0xd0)];_0x26cfa7['getState'](_0x450462(0x95),(_0x5efc32,_0x349085)=>{const _0x5b5287=_0x450462;if(_0x349085&&_0x349085[_0x5b5287(0x75)]===!![]&&_0x377dd3&&_0x377dd3[_0x5b5287(0x7a)]>0x0)automation[_0x5b5287(0x7b)](_0x26cfa7,_0x377dd3);});}else{if(_0x54fa53[_0x450462(0x72)]===_0x450462(0x99)){const {propagation:_0x5b9f70}=_0x54fa53['payload'];let _0x2e54a7=_0x450462(0x69),_0x1e8809=0x0;if(_0x5b9f70){const _0x1fb01f=Object['entries'](_0x5b9f70);_0x1fb01f[_0x450462(0x7a)]>0x0&&(_0x2e54a7=_0x1fb01f[0x0][0x0],_0x1e8809=_0x1fb01f[0x0][0x1]);}_0x26cfa7['setStateAsync'](_0x450462(0x97),{'val':_0x2e54a7,'ack':!![]}),_0x26cfa7[_0x450462(0x9b)]('analysis.prediction.confidence',{'val':_0x1e8809,'ack':!![]}),automation[_0x450462(0x9d)](_0x26cfa7,_0x2e54a7,_0x1e8809);}else{if(_0x54fa53['type']===_0x450462(0xbc)){const {probabilities:_0x1772e0}=_0x54fa53[_0x450462(0xd0)];if(_0x1772e0){_0x26cfa7[_0x450462(0x9b)](_0x450462(0x9e),{'val':JSON[_0x450462(0x9c)](_0x1772e0),'ack':!![]});const _0x59b871=Object['keys'](_0x1772e0);_0x59b871['length']>0x0&&(_0x26cfa7[_0x450462(0x9b)]('analysis.prediction.trackerTopRoom',{'val':_0x59b871[0x0],'ack':!![]}),_0x26cfa7[_0x450462(0x9b)](_0x450462(0xd6),{'val':_0x1772e0[_0x59b871[0x0]],'ack':!![]}));}}else{if(_0x54fa53[_0x450462(0x72)]==='COMFORT_RESULT'){if(_0x54fa53[_0x450462(0xd0)][_0x450462(0xdf)])_0x26cfa7[_0x450462(0x9b)](_0x450462(0xc4),{'val':JSON[_0x450462(0x9c)](_0x54fa53[_0x450462(0xd0)][_0x450462(0xdf)]),'ack':!![]});}}}}}}}}}}}}}}}}}}}function startService(_0x56057c,_0x51e553){const _0x102c8b=a4_0xc10fc3;let _0x1a8444=_0x102c8b(0xda);if(fs[_0x102c8b(0xd9)](_0x51e553))_0x1a8444=_0x51e553;const _0x486fa5=path[_0x102c8b(0xe4)](__dirname,'..',_0x102c8b(0x7c)),_0x5ce938=path[_0x102c8b(0xe4)](__dirname,'..','python_service',_0x102c8b(0x7c));let _0x195f0b=fs['existsSync'](_0x486fa5)?_0x486fa5:fs[_0x102c8b(0xd9)](_0x5ce938)?_0x5ce938:null;if(!_0x195f0b){_0x56057c[_0x102c8b(0x87)][_0x102c8b(0xcf)](_0x102c8b(0x76));return;}try{_0x56057c[_0x102c8b(0x87)]['info'](_0x102c8b(0x70)+_0x1a8444+'\x20'+_0x195f0b),pythonProcess=spawn(_0x1a8444,[_0x195f0b]),pythonProcess[_0x102c8b(0xcc)]['on']('data',_0x227e73=>{const _0x549303=_0x102c8b,_0x51f715=_0x227e73[_0x549303(0xdd)]()[_0x549303(0x91)]('\x0a');_0x51f715[_0x549303(0x68)](_0x20cad2=>{const _0x4ca8c7=_0x549303,_0x51460a=_0x20cad2[_0x4ca8c7(0xdb)]();if(!_0x51460a)return;if(_0x51460a[_0x4ca8c7(0x84)](_0x4ca8c7(0xa4)))_0x56057c[_0x4ca8c7(0x87)][_0x4ca8c7(0x8b)]('[PYTHON]\x20'+_0x51460a['substring'](0x5)['trim']());else{if(_0x51460a[_0x4ca8c7(0x84)](_0x4ca8c7(0x7f)))try{const _0x3caa08=JSON['parse'](_0x51460a[_0x4ca8c7(0xd7)](0x8)[_0x4ca8c7(0xdb)]());handleResult(_0x56057c,_0x3caa08);}catch(_0x56fb26){}}});}),pythonProcess[_0x102c8b(0xae)]['on']('data',_0x2a0ebd=>{const _0x112ec6=_0x102c8b;_0x56057c[_0x112ec6(0x87)][_0x112ec6(0xcf)](_0x112ec6(0xac)+_0x2a0ebd[_0x112ec6(0xdd)]()[_0x112ec6(0xdb)]());}),pythonProcess['on'](_0x102c8b(0xd5),_0x361e57=>{const _0x2bc7d9=_0x102c8b;_0x56057c[_0x2bc7d9(0x87)][_0x2bc7d9(0x94)](_0x2bc7d9(0xbf)+_0x361e57),pythonProcess=null;}),_0x56057c[_0x102c8b(0xe1)]=(_0x3b5fbb,_0x3507df)=>send(_0x56057c,_0x3b5fbb,_0x3507df);}catch(_0x451bb6){_0x56057c['log'][_0x102c8b(0xcf)](_0x102c8b(0x80)+_0x451bb6[_0x102c8b(0x74)]);}}function stopService(_0x58c489){const _0x1e35d1=a4_0xc10fc3;if(pythonProcess){try{pythonProcess[_0x1e35d1(0x8f)]();}catch(_0x453ede){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};