const a4_0x3b02f3=a4_0x4d65;(function(_0x4e3eaf,_0x677fcd){const _0xe12da5=a4_0x4d65,_0x1633d5=_0x4e3eaf();while(!![]){try{const _0x42e7e6=-parseInt(_0xe12da5(0x19b))/0x1+-parseInt(_0xe12da5(0x175))/0x2+parseInt(_0xe12da5(0x17c))/0x3+-parseInt(_0xe12da5(0x1b0))/0x4+-parseInt(_0xe12da5(0x191))/0x5+parseInt(_0xe12da5(0x169))/0x6*(parseInt(_0xe12da5(0x19a))/0x7)+parseInt(_0xe12da5(0x187))/0x8*(parseInt(_0xe12da5(0x185))/0x9);if(_0x42e7e6===_0x677fcd)break;else _0x1633d5['push'](_0x1633d5['shift']());}catch(_0x261546){_0x1633d5['push'](_0x1633d5['shift']());}}}(a4_0x536a,0x2427e));const a4_0x5ec6d5=(function(){let _0x101fc4=!![];return function(_0xa78adc,_0x5433b7){const _0x2806d3=_0x101fc4?function(){if(_0x5433b7){const _0x245ef5=_0x5433b7['apply'](_0xa78adc,arguments);return _0x5433b7=null,_0x245ef5;}}:function(){};return _0x101fc4=![],_0x2806d3;};}()),a4_0xd9e4cd=a4_0x5ec6d5(this,function(){const _0x146a52=a4_0x4d65;return a4_0xd9e4cd[_0x146a52(0x19e)]()[_0x146a52(0x1c0)](_0x146a52(0x1a1))['toString']()[_0x146a52(0x165)](a4_0xd9e4cd)[_0x146a52(0x1c0)](_0x146a52(0x1a1));});a4_0xd9e4cd();function a4_0x536a(){const _0x252c5b=['reason','849900UyyIBC','analysis.health.trendDiagnosis','analysis.health.lastCheck','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','python_service','error','insulation','setStateAsync','success','57150WBUzQp','ENERGY_TRAIN_RESULT','200LRYJdw','kill','stdin','SIGNAL_RESULT','PONG','[PYTHON]\x20','analysis.security.currentThreshold','trim','âš ï¸\x20SECURITY\x20ALARM:\x20','length','205625TAAdWe','analysis.automation.detectedPatterns','change_percent','rule','sendToPythonWrapper','payload','existsSync','analysis.security.topologyMatrix','type','6454ZvkcOD','106137YzrBXR','Success:\x20','TRAINING_COMPLETE','toString','\x0aGrund:\x20','\x20->\x20','(((.+)+)+)+$','substring','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','path','analysis.health.gaitSpeed','toLocaleTimeString','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','message','confidence','handlePrediction','stringify','Regel\x20erkannt:\x20','startsWith','is_anomaly','analysis.health.trendValue','51468MKeEoi','split','threshold','analysis.automation.description','stdout','debug','analysis.security.lastCheck','heating','forEach','python3','analysis.prediction.nextRoom','writable','âœ…\x20HEALTH\x20TRAINED.','info','details','write','search','analysis.health.isAnomaly','analysis.automation.patternDetected','[LOG]','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','analysis.training.status','constructor','TOPOLOGY_ACK','entries','./setup','426hkKchS','join','Error\x20launching\x20Python:\x20','toFixed','./automation','TREND_RESULT','ANOMALY','analysis.energy.heatingScore','analysis.security.lastScore','ðŸ\x20Python\x20Pong','sendNotification','GAIT_RESULT','398578invJbP','toISOString','Unknown','diagnosis','exports','log'];a4_0x536a=function(){return _0x252c5b;};return a4_0x536a();}'use strict';const {spawn}=require('child_process'),path=require(a4_0x3b02f3(0x1a4)),fs=require('fs'),setup=require(a4_0x3b02f3(0x168)),automation=require(a4_0x3b02f3(0x16d));let pythonProcess=null;function send(_0x3b5b97,_0x4e3ec2,_0x310d7={}){const _0x12abdd=a4_0x3b02f3;if(!pythonProcess||!pythonProcess[_0x12abdd(0x189)][_0x12abdd(0x1bb)])return;const _0x11236e=JSON[_0x12abdd(0x1ab)]({'command':_0x4e3ec2,..._0x310d7});try{pythonProcess[_0x12abdd(0x189)][_0x12abdd(0x1bf)](_0x11236e+'\x0a');}catch(_0x35970e){}}function a4_0x4d65(_0x1ba672,_0x2bfa3b){const _0x819a85=a4_0x536a();return a4_0x4d65=function(_0xd9e4cd,_0x5ec6d5){_0xd9e4cd=_0xd9e4cd-0x163;let _0x536ac1=_0x819a85[_0xd9e4cd];return _0x536ac1;},a4_0x4d65(_0x1ba672,_0x2bfa3b);}function handleResult(_0x207e2c,_0x39acf2){const _0x5a24c4=a4_0x3b02f3;if(_0x39acf2[_0x5a24c4(0x199)]===_0x5a24c4(0x18b))_0x207e2c['log'][_0x5a24c4(0x1b5)](_0x5a24c4(0x172));else{if(_0x39acf2[_0x5a24c4(0x199)]==='SECURITY_RESULT'){const {anomaly_score:_0x4ad029,is_anomaly:_0x436580,threshold:_0x458843,explanation:_0x15f6c6}=_0x39acf2[_0x5a24c4(0x196)];_0x207e2c[_0x5a24c4(0x17a)][_0x5a24c4(0x1bd)](_0x5a24c4(0x1a7)+_0x4ad029[_0x5a24c4(0x16c)](0x5)+_0x5a24c4(0x1a0)+(_0x436580?_0x5a24c4(0x16f):'OK')),_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x171),{'val':_0x4ad029,'ack':!![]}),_0x207e2c['setStateAsync'](_0x5a24c4(0x1b6),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x458843)_0x207e2c[_0x5a24c4(0x183)]('analysis.security.currentThreshold',{'val':_0x458843,'ack':!![]});if(_0x436580){let _0x90e070='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x4ad029[_0x5a24c4(0x16c)](0x4)+')';if(_0x15f6c6&&_0x15f6c6!=='Unknown')_0x90e070+=_0x5a24c4(0x19f)+_0x15f6c6;_0x207e2c[_0x5a24c4(0x183)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x207e2c[_0x5a24c4(0x183)]('analysis.alertReason',{'val':_0x90e070,'ack':!![]}),setup[_0x5a24c4(0x173)](_0x207e2c,_0x5a24c4(0x18f)+_0x90e070,![],!![]);}}else{if(_0x39acf2[_0x5a24c4(0x199)]===_0x5a24c4(0x19d)){const _0x486b9d=_0x39acf2[_0x5a24c4(0x196)][_0x5a24c4(0x1be)]||'',_0x3b2db7=_0x39acf2['payload'][_0x5a24c4(0x1b2)],_0x124fa4=_0x39acf2[_0x5a24c4(0x196)][_0x5a24c4(0x184)]?_0x5a24c4(0x19c)+new Date()[_0x5a24c4(0x1a6)]()+'\x20('+_0x486b9d+')':'Failed:\x20'+_0x39acf2[_0x5a24c4(0x196)][_0x5a24c4(0x17b)];_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x164),{'val':_0x124fa4,'ack':!![]});if(_0x39acf2[_0x5a24c4(0x196)]['success']&&_0x3b2db7)_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x18d),{'val':_0x3b2db7,'ack':!![]});}else{if(_0x39acf2['type']==='COMFORT_RESULT'){const {patterns:_0x245d2e}=_0x39acf2[_0x5a24c4(0x196)];if(_0x245d2e&&_0x245d2e[_0x5a24c4(0x190)]>0x0){_0x207e2c['log'][_0x5a24c4(0x1bd)](_0x5a24c4(0x1a3)+_0x245d2e[_0x5a24c4(0x190)]+'\x20new\x20patterns.'),_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x192),{'val':JSON[_0x5a24c4(0x1ab)](_0x245d2e),'ack':!![]});const _0x20220d=_0x245d2e[0x0],_0x183c58=_0x5a24c4(0x1ac)+_0x20220d[_0x5a24c4(0x194)]+'\x20('+(_0x20220d[_0x5a24c4(0x1a9)]*0x64)['toFixed'](0x0)+'%)';_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x1c2),{'val':!![],'ack':!![]}),_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x1b3),{'val':_0x183c58,'ack':!![]});}else _0x207e2c[_0x5a24c4(0x17a)][_0x5a24c4(0x1bd)](_0x5a24c4(0x17f)),_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x1c2),{'val':![],'ack':!![]}),_0x207e2c[_0x5a24c4(0x183)]('analysis.automation.detectedPatterns',{'val':'[]','ack':!![]});}else{if(_0x39acf2[_0x5a24c4(0x199)]===_0x5a24c4(0x186)){if(_0x39acf2['payload'][_0x5a24c4(0x184)])try{const _0x14fd7a=JSON['parse'](_0x39acf2[_0x5a24c4(0x196)][_0x5a24c4(0x1be)]);if(_0x14fd7a[_0x5a24c4(0x182)])_0x207e2c[_0x5a24c4(0x183)]('analysis.energy.insulationScore',{'val':JSON['stringify'](_0x14fd7a[_0x5a24c4(0x182)]),'ack':!![]});if(_0x14fd7a[_0x5a24c4(0x1b7)])_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x170),{'val':JSON[_0x5a24c4(0x1ab)](_0x14fd7a[_0x5a24c4(0x1b7)]),'ack':!![]});}catch(_0x2ddf43){}}else{if(_0x39acf2[_0x5a24c4(0x199)]==='HEALTH_TRAIN_RESULT'){if(_0x39acf2[_0x5a24c4(0x196)][_0x5a24c4(0x184)])_0x207e2c[_0x5a24c4(0x17a)][_0x5a24c4(0x1bd)](_0x5a24c4(0x1bc));}else{if(_0x39acf2[_0x5a24c4(0x199)]==='HEALTH_RESULT')_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x17e),{'val':new Date()[_0x5a24c4(0x176)](),'ack':!![]}),_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x1c1),{'val':_0x39acf2[_0x5a24c4(0x196)][_0x5a24c4(0x1ae)],'ack':!![]});else{if(_0x39acf2[_0x5a24c4(0x199)]===_0x5a24c4(0x16e))_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x17d),{'val':_0x39acf2[_0x5a24c4(0x196)][_0x5a24c4(0x178)],'ack':!![]}),_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x1af),{'val':_0x39acf2[_0x5a24c4(0x196)][_0x5a24c4(0x193)],'ack':!![]});else{if(_0x39acf2[_0x5a24c4(0x199)]===_0x5a24c4(0x174)){const {speed_trend:_0x50ae3d}=_0x39acf2[_0x5a24c4(0x196)];if(_0x50ae3d!==undefined)_0x207e2c['setStateAsync'](_0x5a24c4(0x1a5),{'val':_0x50ae3d,'ack':!![]});}else{if(_0x39acf2[_0x5a24c4(0x199)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x4c837b}=_0x39acf2[_0x5a24c4(0x196)];if(_0x4c837b)_0x207e2c[_0x5a24c4(0x183)]('analysis.energy.forecast',{'val':JSON[_0x5a24c4(0x1ab)](_0x4c837b),'ack':!![]});}else{if(_0x39acf2[_0x5a24c4(0x199)]==='TOPOLOGY_RESULT'){const {data:_0x42f128}=_0x39acf2[_0x5a24c4(0x196)];_0x42f128&&(_0x207e2c[_0x5a24c4(0x17a)][_0x5a24c4(0x1bd)](_0x5a24c4(0x163)),_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x198),{'val':JSON[_0x5a24c4(0x1ab)](_0x42f128),'ack':!![]}));}else{if(_0x39acf2[_0x5a24c4(0x199)]===_0x5a24c4(0x166))_0x207e2c[_0x5a24c4(0x17a)][_0x5a24c4(0x1b5)]('ðŸ\x20Python\x20confirmed\x20new\x20topology.');else{if(_0x39acf2[_0x5a24c4(0x199)]===_0x5a24c4(0x18a)){const {room:_0x2504fe,propagation:_0x2d8826}=_0x39acf2[_0x5a24c4(0x196)];let _0x2dd7f8=_0x5a24c4(0x177),_0x5200e0=0x0;if(_0x2d8826){const _0x15ee45=Object[_0x5a24c4(0x167)](_0x2d8826);_0x15ee45['length']>0x0&&(_0x2dd7f8=_0x15ee45[0x0][0x0],_0x5200e0=_0x15ee45[0x0][0x1]);}_0x207e2c[_0x5a24c4(0x183)](_0x5a24c4(0x1ba),{'val':_0x2dd7f8,'ack':!![]}),_0x207e2c['setStateAsync']('analysis.prediction.confidence',{'val':_0x5200e0,'ack':!![]}),_0x5200e0>0.4&&_0x207e2c[_0x5a24c4(0x17a)][_0x5a24c4(0x1b5)]('ðŸ”®\x20Prediction:\x20From\x20'+_0x2504fe+'\x20->\x20Likely\x20'+_0x2dd7f8+'\x20('+(_0x5200e0*0x64)[_0x5a24c4(0x16c)](0x0)+'%)'),automation[_0x5a24c4(0x1aa)](_0x207e2c,_0x2dd7f8,_0x5200e0);}}}}}}}}}}}}}}function startService(_0x454899,_0xe4632){const _0x1c60d6=a4_0x3b02f3;let _0xb2b14a=_0x1c60d6(0x1b9);if(fs[_0x1c60d6(0x197)](_0xe4632))_0xb2b14a=_0xe4632;try{const _0x481a1f=path[_0x1c60d6(0x16a)](__dirname,'..',_0x1c60d6(0x180),'service.py');pythonProcess=spawn(_0xb2b14a,[_0x481a1f]),pythonProcess[_0x1c60d6(0x1b4)]['on']('data',_0x2c527a=>{const _0x329a66=_0x1c60d6,_0x25da21=_0x2c527a[_0x329a66(0x19e)]()[_0x329a66(0x1b1)]('\x0a');_0x25da21[_0x329a66(0x1b8)](_0x32d0e3=>{const _0x229f8b=_0x329a66,_0x4df529=_0x32d0e3[_0x229f8b(0x18e)]();if(!_0x4df529)return;if(_0x4df529['startsWith'](_0x229f8b(0x1c3)))_0x454899[_0x229f8b(0x17a)][_0x229f8b(0x1b5)](_0x229f8b(0x18c)+_0x4df529[_0x229f8b(0x1a2)](0x5)[_0x229f8b(0x18e)]());else{if(_0x4df529[_0x229f8b(0x1ad)]('[RESULT]'))try{const _0x32d152=JSON['parse'](_0x4df529[_0x229f8b(0x1a2)](0x8)[_0x229f8b(0x18e)]());handleResult(_0x454899,_0x32d152);}catch(_0x412a9a){}}});}),pythonProcess['on']('close',_0x17f4e2=>{pythonProcess=null;}),_0x454899[_0x1c60d6(0x195)]=(_0x5ced8b,_0x4a34ec)=>send(_0x454899,_0x5ced8b,_0x4a34ec);}catch(_0x28e8da){_0x454899['log'][_0x1c60d6(0x181)](_0x1c60d6(0x16b)+_0x28e8da[_0x1c60d6(0x1a8)]);}}function stopService(_0x3ffe86){const _0xe9e18d=a4_0x3b02f3;if(pythonProcess){try{pythonProcess[_0xe9e18d(0x188)]();}catch(_0x55d9dc){}pythonProcess=null;}}module[a4_0x3b02f3(0x179)]={'startService':startService,'stopService':stopService,'send':send};