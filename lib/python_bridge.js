const a4_0x4ec087=a4_0x21f5;function a4_0x2857(){const _0x55424e=['apply','debug','exports','applyEnergySavings','stringify','89895StgeXj','stdout','analysis.energy.insulationScore','âš ï¸\x20SECURITY\x20ALARM:\x20','getState','toFixed','PINN_PREDICT_RESULT','Success:\x20','analysis.training.status','SIGNAL_RESULT','heating','[LOG]','length','43985JUQSNe','sendToPythonWrapper','SECURITY_RESULT','Error\x20launching\x20Python:\x20','threshold','type','86AzVxyO','3933468YAcIrR','toISOString','analysis.security.lastCheck','python_service','Unknown','analysis.health.gaitSpeed','python3','210KPKKAS','ENERGY_TRAIN_RESULT','trim','analysis.energy.forecast','6152184eUJtRL','125196vBcxpd','data','constructor','payload','analysis.automation.detectedPatterns','search','stdin','analysis.energy.ventilationAlerts','parse','service.py','GAIT_RESULT','ENERGY_PREDICT_RESULT','20GnPEMj','path','[PYTHON]\x20','[RESULT]','message','HEALTH_TRAIN_RESULT','406FatwZM','split','analysis.prediction.confidence','entries','(((.+)+)+)+$','is_anomaly','analysis.prediction.trackerState','WARMUP_RESULT','kill','startsWith','âœ…\x20HEALTH\x20TRAINED.','64984EwQStQ','HEALTH_RESULT','write','substring','reason','join','ENERGY_OPTIMIZE_RESULT','./automation','val','forEach','log','analysis.isAlert','info','success','handlePrediction','analysis.security.currentThreshold','child_process','toString','5510128UmCjwl','details','writable','setStateAsync'];a4_0x2857=function(){return _0x55424e;};return a4_0x2857();}function a4_0x21f5(_0x4440b5,_0x4861c2){const _0x427f8b=a4_0x2857();return a4_0x21f5=function(_0x491eca,_0x16de43){_0x491eca=_0x491eca-0xf3;let _0x285756=_0x427f8b[_0x491eca];return _0x285756;},a4_0x21f5(_0x4440b5,_0x4861c2);}(function(_0x590f2b,_0xd5c895){const _0x21103c=a4_0x21f5,_0x163e38=_0x590f2b();while(!![]){try{const _0x1e3593=-parseInt(_0x21103c(0x149))/0x1+parseInt(_0x21103c(0xf7))/0x2*(parseInt(_0x21103c(0x13c))/0x3)+-parseInt(_0x21103c(0x121))/0x4*(parseInt(_0x21103c(0xff))/0x5)+-parseInt(_0x21103c(0x104))/0x6*(-parseInt(_0x21103c(0x116))/0x7)+parseInt(_0x21103c(0x133))/0x8+-parseInt(_0x21103c(0x103))/0x9*(parseInt(_0x21103c(0x110))/0xa)+-parseInt(_0x21103c(0xf8))/0xb;if(_0x1e3593===_0xd5c895)break;else _0x163e38['push'](_0x163e38['shift']());}catch(_0x564c34){_0x163e38['push'](_0x163e38['shift']());}}}(a4_0x2857,0xb3cb0));const a4_0x16de43=(function(){let _0x57ac4b=!![];return function(_0x553c36,_0x11b374){const _0x5d16e=_0x57ac4b?function(){const _0x2e9751=a4_0x21f5;if(_0x11b374){const _0x396da2=_0x11b374[_0x2e9751(0x137)](_0x553c36,arguments);return _0x11b374=null,_0x396da2;}}:function(){};return _0x57ac4b=![],_0x5d16e;};}()),a4_0x491eca=a4_0x16de43(this,function(){const _0x3dee8e=a4_0x21f5;return a4_0x491eca[_0x3dee8e(0x132)]()[_0x3dee8e(0x109)](_0x3dee8e(0x11a))[_0x3dee8e(0x132)]()[_0x3dee8e(0x106)](a4_0x491eca)[_0x3dee8e(0x109)]('(((.+)+)+)+$');});a4_0x491eca();'use strict';const {spawn}=require(a4_0x4ec087(0x131)),path=require(a4_0x4ec087(0x111)),fs=require('fs'),setup=require('./setup'),automation=require(a4_0x4ec087(0x128));let pythonProcess=null;function send(_0x511dc9,_0xce53c2,_0x327e7e={}){const _0x20fb2a=a4_0x4ec087;if(!pythonProcess||!pythonProcess['stdin'][_0x20fb2a(0x135)])return;const _0x5342b4=JSON[_0x20fb2a(0x13b)]({'command':_0xce53c2,..._0x327e7e});try{pythonProcess[_0x20fb2a(0x10a)][_0x20fb2a(0x123)](_0x5342b4+'\x0a');}catch(_0x2e8db7){}}function handleResult(_0xa60852,_0x4df221){const _0x23a978=a4_0x4ec087;if(_0x4df221[_0x23a978(0xf6)]==='PONG')_0xa60852[_0x23a978(0x12b)][_0x23a978(0x138)]('ðŸ\x20Python\x20Pong');else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0xf3)){const {anomaly_score:_0x143de4,is_anomaly:_0x4ba57d,threshold:_0x3954cd,explanation:_0x121130}=_0x4df221[_0x23a978(0x107)];_0xa60852[_0x23a978(0x136)]('analysis.security.lastScore',{'val':_0x143de4,'ack':!![]}),_0xa60852['setStateAsync'](_0x23a978(0xfa),{'val':new Date()[_0x23a978(0xf9)](),'ack':!![]});if(_0x3954cd)_0xa60852['setStateAsync'](_0x23a978(0x130),{'val':_0x3954cd,'ack':!![]});if(_0x4ba57d){let _0x48aa7f='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x143de4[_0x23a978(0x141)](0x4)+')';if(_0x121130&&_0x121130!==_0x23a978(0xfc))_0x48aa7f+='\x0aGrund:\x20'+_0x121130;_0xa60852[_0x23a978(0x136)](_0x23a978(0x12c),{'val':!![],'ack':!![]}),_0xa60852[_0x23a978(0x136)]('analysis.alertReason',{'val':_0x48aa7f,'ack':!![]}),setup['sendNotification'](_0xa60852,_0x23a978(0x13f)+_0x48aa7f,![],!![]);}}else{if(_0x4df221['type']==='TRAINING_COMPLETE'){const _0x246ea2=_0x4df221[_0x23a978(0x107)][_0x23a978(0x134)]||'',_0x2a46a2=_0x4df221[_0x23a978(0x107)][_0x23a978(0xf5)],_0x56e9e5=_0x4df221[_0x23a978(0x107)][_0x23a978(0x12e)]?_0x23a978(0x143)+new Date()['toLocaleTimeString']()+'\x20('+_0x246ea2+')':'Failed:\x20'+_0x4df221[_0x23a978(0x107)][_0x23a978(0x125)];_0xa60852[_0x23a978(0x136)](_0x23a978(0x144),{'val':_0x56e9e5,'ack':!![]});if(_0x4df221[_0x23a978(0x107)]['success']&&_0x2a46a2)_0xa60852[_0x23a978(0x136)](_0x23a978(0x130),{'val':_0x2a46a2,'ack':!![]});}else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x100)){if(_0x4df221[_0x23a978(0x107)][_0x23a978(0x12e)])try{const _0xe85f3a=JSON[_0x23a978(0x10c)](_0x4df221[_0x23a978(0x107)][_0x23a978(0x134)]);if(_0xe85f3a['insulation'])_0xa60852[_0x23a978(0x136)](_0x23a978(0x13e),{'val':JSON[_0x23a978(0x13b)](_0xe85f3a['insulation']),'ack':!![]});if(_0xe85f3a[_0x23a978(0x146)])_0xa60852[_0x23a978(0x136)]('analysis.energy.heatingScore',{'val':JSON[_0x23a978(0x13b)](_0xe85f3a[_0x23a978(0x146)]),'ack':!![]});}catch(_0x1d023d){}}else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x115)){if(_0x4df221[_0x23a978(0x107)][_0x23a978(0x12e)])_0xa60852['log'][_0x23a978(0x12d)](_0x23a978(0x120));}else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x122))_0xa60852['setStateAsync']('analysis.health.lastCheck',{'val':new Date()[_0x23a978(0xf9)](),'ack':!![]}),_0xa60852['setStateAsync']('analysis.health.isAnomaly',{'val':_0x4df221[_0x23a978(0x107)][_0x23a978(0x11b)],'ack':!![]});else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x10e)){const {speed_trend:_0x381ba5}=_0x4df221[_0x23a978(0x107)];if(_0x381ba5!==undefined)_0xa60852[_0x23a978(0x136)](_0x23a978(0xfd),{'val':_0x381ba5,'ack':!![]});}else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x10f)){const {forecast:_0x26fcec}=_0x4df221[_0x23a978(0x107)];if(_0x26fcec)_0xa60852['setStateAsync'](_0x23a978(0x102),{'val':JSON['stringify'](_0x26fcec),'ack':!![]});}else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x11d)){const {times:_0x3696f0}=_0x4df221[_0x23a978(0x107)];if(_0x3696f0)_0xa60852['setStateAsync']('analysis.energy.warmupTimes',{'val':JSON[_0x23a978(0x13b)](_0x3696f0),'ack':!![]});}else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x142)){const {forecast:_0x2b1b01}=_0x4df221[_0x23a978(0x107)];if(_0x2b1b01)_0xa60852['setStateAsync']('analysis.energy.pinnForecast',{'val':JSON[_0x23a978(0x13b)](_0x2b1b01),'ack':!![]});}else{if(_0x4df221[_0x23a978(0xf6)]==='VENTILATION_ALERT'){const {alerts:_0x46393f}=_0x4df221[_0x23a978(0x107)];if(_0x46393f)_0xa60852[_0x23a978(0x136)](_0x23a978(0x10b),{'val':JSON[_0x23a978(0x13b)](_0x46393f),'ack':!![]});}else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x127)){const {proposals:_0x42f63f}=_0x4df221[_0x23a978(0x107)];_0xa60852[_0x23a978(0x140)]('analysis.energy.mpcActive',(_0x59af68,_0x3ad724)=>{const _0xef616f=_0x23a978;_0x3ad724&&_0x3ad724[_0xef616f(0x129)]===!![]&&_0x42f63f&&_0x42f63f['length']>0x0&&automation[_0xef616f(0x13a)](_0xa60852,_0x42f63f);});}else{if(_0x4df221[_0x23a978(0xf6)]===_0x23a978(0x145)){const {room:_0x430eab,propagation:_0x3cf0ca}=_0x4df221['payload'];let _0x4d06e9='Unknown',_0x17b239=0x0;if(_0x3cf0ca){const _0x42d3f4=Object[_0x23a978(0x119)](_0x3cf0ca);_0x42d3f4[_0x23a978(0x148)]>0x0&&(_0x4d06e9=_0x42d3f4[0x0][0x0],_0x17b239=_0x42d3f4[0x0][0x1]);}_0xa60852[_0x23a978(0x136)]('analysis.prediction.nextRoom',{'val':_0x4d06e9,'ack':!![]}),_0xa60852[_0x23a978(0x136)](_0x23a978(0x118),{'val':_0x17b239,'ack':!![]}),automation[_0x23a978(0x12f)](_0xa60852,_0x4d06e9,_0x17b239);}else{if(_0x4df221['type']==='TRACKER_RESULT'){const {probabilities:_0x545999}=_0x4df221['payload'];if(_0x545999){_0xa60852[_0x23a978(0x136)](_0x23a978(0x11c),{'val':JSON[_0x23a978(0x13b)](_0x545999),'ack':!![]});const _0x55e9d6=Object['keys'](_0x545999);if(_0x55e9d6[_0x23a978(0x148)]>0x0){const _0x3f2122=_0x55e9d6[0x0],_0x3e89f8=_0x545999[_0x3f2122];_0xa60852[_0x23a978(0x136)]('analysis.prediction.trackerTopRoom',{'val':_0x3f2122,'ack':!![]}),_0xa60852[_0x23a978(0x136)]('analysis.prediction.trackerConfidence',{'val':_0x3e89f8,'ack':!![]});}}}else{if(_0x4df221[_0x23a978(0xf6)]==='COMFORT_RESULT'){const {patterns:_0x989312}=_0x4df221[_0x23a978(0x107)];if(_0x989312&&_0x989312['length']>0x0)_0xa60852[_0x23a978(0x136)](_0x23a978(0x108),{'val':JSON[_0x23a978(0x13b)](_0x989312),'ack':!![]});}}}}}}}}}}}}}}}}function startService(_0x5a2d9a,_0x16573c){const _0x561910=a4_0x4ec087;let _0x4d57ab=_0x561910(0xfe);if(fs['existsSync'](_0x16573c))_0x4d57ab=_0x16573c;try{const _0xe9e4a5=path[_0x561910(0x126)](__dirname,'..',_0x561910(0xfb),_0x561910(0x10d));pythonProcess=spawn(_0x4d57ab,[_0xe9e4a5]),pythonProcess[_0x561910(0x13d)]['on'](_0x561910(0x105),_0x2867a2=>{const _0x3353af=_0x561910,_0x2eb076=_0x2867a2['toString']()[_0x3353af(0x117)]('\x0a');_0x2eb076[_0x3353af(0x12a)](_0x3eca11=>{const _0x43f188=_0x3353af,_0x31b782=_0x3eca11[_0x43f188(0x101)]();if(!_0x31b782)return;if(_0x31b782[_0x43f188(0x11f)](_0x43f188(0x147)))_0x5a2d9a[_0x43f188(0x12b)][_0x43f188(0x138)](_0x43f188(0x112)+_0x31b782[_0x43f188(0x124)](0x5)[_0x43f188(0x101)]());else{if(_0x31b782[_0x43f188(0x11f)](_0x43f188(0x113)))try{const _0x1a7067=JSON[_0x43f188(0x10c)](_0x31b782['substring'](0x8)['trim']());handleResult(_0x5a2d9a,_0x1a7067);}catch(_0x197d1e){}}});}),pythonProcess['on']('close',_0x4ab48e=>{pythonProcess=null;}),_0x5a2d9a[_0x561910(0x14a)]=(_0x3c0c6c,_0x28792a)=>send(_0x5a2d9a,_0x3c0c6c,_0x28792a);}catch(_0x5638b7){_0x5a2d9a[_0x561910(0x12b)]['error'](_0x561910(0xf4)+_0x5638b7[_0x561910(0x114)]);}}function stopService(_0x4d6775){const _0x1b21b7=a4_0x4ec087;if(pythonProcess){try{pythonProcess[_0x1b21b7(0x11e)]();}catch(_0xf63231){}pythonProcess=null;}}module[a4_0x4ec087(0x139)]={'startService':startService,'stopService':stopService,'send':send};