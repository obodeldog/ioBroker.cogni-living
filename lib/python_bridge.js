const a4_0x415089=a4_0x5719;function a4_0x5719(_0x3f7e9a,_0x12c3b0){const _0x310cd4=a4_0x39c3();return a4_0x5719=function(_0x2f83be,_0x31308b){_0x2f83be=_0x2f83be-0xe1;let _0x39c3ba=_0x310cd4[_0x2f83be];return _0x39c3ba;},a4_0x5719(_0x3f7e9a,_0x12c3b0);}(function(_0x473041,_0x5c3697){const _0x1cca4f=a4_0x5719,_0x16cd32=_0x473041();while(!![]){try{const _0x1d374e=-parseInt(_0x1cca4f(0x12b))/0x1+-parseInt(_0x1cca4f(0xe8))/0x2+parseInt(_0x1cca4f(0x117))/0x3+-parseInt(_0x1cca4f(0x11d))/0x4*(-parseInt(_0x1cca4f(0x142))/0x5)+parseInt(_0x1cca4f(0x13c))/0x6+parseInt(_0x1cca4f(0xfe))/0x7+parseInt(_0x1cca4f(0xec))/0x8*(-parseInt(_0x1cca4f(0x14a))/0x9);if(_0x1d374e===_0x5c3697)break;else _0x16cd32['push'](_0x16cd32['shift']());}catch(_0x1b1f62){_0x16cd32['push'](_0x16cd32['shift']());}}}(a4_0x39c3,0xd61c7));const a4_0x31308b=(function(){let _0x3bcd06=!![];return function(_0x421bbe,_0x18836b){const _0x255af4=_0x3bcd06?function(){const _0x5c6d9d=a4_0x5719;if(_0x18836b){const _0x508f86=_0x18836b[_0x5c6d9d(0xef)](_0x421bbe,arguments);return _0x18836b=null,_0x508f86;}}:function(){};return _0x3bcd06=![],_0x255af4;};}()),a4_0x2f83be=a4_0x31308b(this,function(){const _0x2051fb=a4_0x5719;return a4_0x2f83be[_0x2051fb(0x12c)]()[_0x2051fb(0x10f)]('(((.+)+)+)+$')[_0x2051fb(0x12c)]()[_0x2051fb(0x13b)](a4_0x2f83be)['search'](_0x2051fb(0xf6));});a4_0x2f83be();'use strict';const {spawn}=require('child_process'),path=require(a4_0x415089(0x12a)),fs=require('fs'),setup=require('./setup'),automation=require('./automation');let pythonProcess=null;function send(_0x4e55f0,_0x5141cb,_0xc7201a={}){const _0x5b5438=a4_0x415089;if(!pythonProcess||!pythonProcess['stdin'][_0x5b5438(0x127)])return;const _0x22b9f7=JSON[_0x5b5438(0x140)]({'command':_0x5141cb,..._0xc7201a});try{pythonProcess['stdin'][_0x5b5438(0xe7)](_0x22b9f7+'\x0a');}catch(_0x2f80d7){}}function handleResult(_0x1b48a1,_0x4c8fed){const _0xbc84ea=a4_0x415089;if(_0x4c8fed[_0xbc84ea(0x11b)]==='PONG')_0x1b48a1['log']['debug'](_0xbc84ea(0x12d));else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0xf3)){const {anomaly_score:_0x3599da,is_anomaly:_0x3f1862,threshold:_0x574796,explanation:_0x2037f7}=_0x4c8fed[_0xbc84ea(0x146)];_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0xee),{'val':_0x3599da,'ack':!![]}),_0x1b48a1[_0xbc84ea(0x137)]('analysis.security.lastCheck',{'val':new Date()['toISOString'](),'ack':!![]});if(_0x574796)_0x1b48a1['setStateAsync'](_0xbc84ea(0x110),{'val':_0x574796,'ack':!![]});if(_0x3f1862){let _0x24d520=_0xbc84ea(0x13e)+_0x3599da[_0xbc84ea(0xe5)](0x4)+')';if(_0x2037f7&&_0x2037f7!==_0xbc84ea(0x124))_0x24d520+='\x0aGrund:\x20'+_0x2037f7;_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x122),{'val':!![],'ack':!![]}),_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x111),{'val':_0x24d520,'ack':!![]}),setup[_0xbc84ea(0xf5)](_0x1b48a1,_0xbc84ea(0x121)+_0x24d520,![],!![]);}}else{if(_0x4c8fed['type']==='TRAINING_COMPLETE'){const _0xebfe91=_0x4c8fed[_0xbc84ea(0x146)][_0xbc84ea(0x113)]||'',_0x4820c3=_0x4c8fed[_0xbc84ea(0x146)][_0xbc84ea(0x10e)],_0x439b93=_0x4c8fed[_0xbc84ea(0x146)]['success']?_0xbc84ea(0x12e)+new Date()[_0xbc84ea(0xed)]()+'\x20('+_0xebfe91+')':_0xbc84ea(0xe9)+_0x4c8fed[_0xbc84ea(0x146)][_0xbc84ea(0xe2)];_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x109),{'val':_0x439b93,'ack':!![]});if(_0x4c8fed[_0xbc84ea(0x146)]['success']&&_0x4820c3)_0x1b48a1['setStateAsync']('analysis.security.currentThreshold',{'val':_0x4820c3,'ack':!![]});}else{if(_0x4c8fed['type']===_0xbc84ea(0x13a)){if(_0x4c8fed[_0xbc84ea(0x146)][_0xbc84ea(0x11c)])try{const _0x4c1e2a=JSON[_0xbc84ea(0x125)](_0x4c8fed['payload'][_0xbc84ea(0x113)]);if(_0x4c1e2a[_0xbc84ea(0xfc)])_0x1b48a1[_0xbc84ea(0x137)]('analysis.energy.insulationScore',{'val':JSON[_0xbc84ea(0x140)](_0x4c1e2a[_0xbc84ea(0xfc)]),'ack':!![]});if(_0x4c1e2a['heating'])_0x1b48a1['setStateAsync'](_0xbc84ea(0xf0),{'val':JSON[_0xbc84ea(0x140)](_0x4c1e2a[_0xbc84ea(0xe6)]),'ack':!![]});}catch(_0x381ed7){}}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0x126)){if(_0x4c8fed[_0xbc84ea(0x146)]['success']){_0x1b48a1[_0xbc84ea(0x100)]['info'](_0xbc84ea(0x116));const _0xf9b687=new Date(),_0x37d582=_0xf9b687[_0xbc84ea(0xeb)](_0xbc84ea(0x129),{'day':_0xbc84ea(0x106),'month':_0xbc84ea(0xe1),'hour':_0xbc84ea(0x106),'minute':_0xbc84ea(0x106)});_0x1b48a1[_0xbc84ea(0x137)]('analysis.health.lastCheck',{'val':_0x37d582,'ack':!![]});}}else{if(_0x4c8fed['type']===_0xbc84ea(0xe4)){const _0x405860=new Date(),_0x2def5c=_0x405860['toLocaleDateString'](_0xbc84ea(0x129),{'day':_0xbc84ea(0x106),'month':_0xbc84ea(0xe1),'hour':'2-digit','minute':_0xbc84ea(0x106)});_0x1b48a1['setStateAsync']('analysis.health.lastCheck',{'val':_0x2def5c,'ack':!![]}),_0x1b48a1['setStateAsync'](_0xbc84ea(0x10c),{'val':_0x4c8fed[_0xbc84ea(0x146)][_0xbc84ea(0x11a)],'ack':!![]});}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0x141)){const {trend_percent:_0x1c71d4,details:_0x22a86c}=_0x4c8fed[_0xbc84ea(0x146)],_0x40018c=new Date(),_0xbc0c3e=_0x40018c[_0xbc84ea(0xeb)](_0xbc84ea(0x129),{'day':_0xbc84ea(0x106),'month':_0xbc84ea(0xe1),'hour':_0xbc84ea(0x106),'minute':_0xbc84ea(0x106)});_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x14b),{'val':_0xbc0c3e,'ack':!![]}),_0x1b48a1['setStateAsync'](_0xbc84ea(0x105),{'val':_0x1c71d4,'ack':!![]}),_0x1b48a1['log'][_0xbc84ea(0x104)]('ðŸ“ˆ\x20Health\x20Trend:\x20'+_0x22a86c);}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0x13f)){const {speed_trend:_0x11d0b4,sensors:_0x1f2ca9,proof:_0x3c3fc3}=_0x4c8fed['payload'];if(_0x11d0b4!==undefined)_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x108),{'val':_0x11d0b4,'ack':!![]});if(_0x1f2ca9&&Array[_0xbc84ea(0x120)](_0x1f2ca9))_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x10d),{'val':_0x1f2ca9[_0xbc84ea(0x13d)](',\x20'),'ack':!![]});if(_0x3c3fc3)_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x107),{'val':_0x3c3fc3,'ack':!![]});}else{if(_0x4c8fed['type']===_0xbc84ea(0x145)){const {forecast:_0x54fd7b}=_0x4c8fed[_0xbc84ea(0x146)];if(_0x54fd7b)_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x103),{'val':JSON['stringify'](_0x54fd7b),'ack':!![]});}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0xfa)){const {times:_0x5d7020,sources:_0x4fc285,details:_0x5edd45}=_0x4c8fed[_0xbc84ea(0x146)];if(_0x5d7020)_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x138),{'val':JSON[_0xbc84ea(0x140)](_0x5d7020),'ack':!![]});if(_0x4fc285)_0x1b48a1[_0xbc84ea(0x137)]('analysis.energy.warmupSources',{'val':JSON[_0xbc84ea(0x140)](_0x4fc285),'ack':!![]});if(_0x5edd45)_0x1b48a1['setStateAsync'](_0xbc84ea(0xf4),{'val':JSON[_0xbc84ea(0x140)](_0x5edd45),'ack':!![]});}else{if(_0x4c8fed['type']===_0xbc84ea(0x115)){const {penalties:_0x4cdf05}=_0x4c8fed[_0xbc84ea(0x146)];if(_0x4cdf05)_0x1b48a1[_0xbc84ea(0x137)]('analysis.energy.rlPenalties',{'val':JSON[_0xbc84ea(0x140)](_0x4cdf05),'ack':!![]});}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0x149)){const {forecast:_0x286cc9}=_0x4c8fed[_0xbc84ea(0x146)];if(_0x286cc9)_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x144),{'val':JSON[_0xbc84ea(0x140)](_0x286cc9),'ack':!![]});}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0x14e)){const {alerts:_0x40ec5d}=_0x4c8fed[_0xbc84ea(0x146)];if(_0x40ec5d)_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x112),{'val':JSON[_0xbc84ea(0x140)](_0x40ec5d),'ack':!![]});}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0xf1)){const {proposals:_0x6122d2}=_0x4c8fed['payload'];_0x1b48a1[_0xbc84ea(0xf9)](_0xbc84ea(0x102),(_0x52430d,_0x17a76c)=>{const _0x1ffde3=_0xbc84ea;_0x17a76c&&_0x17a76c['val']===!![]&&_0x6122d2&&_0x6122d2[_0x1ffde3(0xf2)]>0x0&&automation[_0x1ffde3(0x133)](_0x1b48a1,_0x6122d2);});}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0xe3)){const {room:_0x4736d9,propagation:_0x516316}=_0x4c8fed[_0xbc84ea(0x146)];let _0x33b732=_0xbc84ea(0x124),_0x39f34f=0x0;if(_0x516316){const _0x28d48d=Object['entries'](_0x516316);_0x28d48d[_0xbc84ea(0xf2)]>0x0&&(_0x33b732=_0x28d48d[0x0][0x0],_0x39f34f=_0x28d48d[0x0][0x1]);}_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0xfb),{'val':_0x33b732,'ack':!![]}),_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0x128),{'val':_0x39f34f,'ack':!![]}),automation['handlePrediction'](_0x1b48a1,_0x33b732,_0x39f34f);}else{if(_0x4c8fed['type']==='TRACKER_RESULT'){const {probabilities:_0x17c359}=_0x4c8fed[_0xbc84ea(0x146)];if(_0x17c359){_0x1b48a1[_0xbc84ea(0x137)]('analysis.prediction.trackerState',{'val':JSON[_0xbc84ea(0x140)](_0x17c359),'ack':!![]});const _0x4753cc=Object[_0xbc84ea(0x135)](_0x17c359);if(_0x4753cc['length']>0x0){const _0x865154=_0x4753cc[0x0],_0x5a5f17=_0x17c359[_0x865154];_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0xea),{'val':_0x865154,'ack':!![]}),_0x1b48a1[_0xbc84ea(0x137)]('analysis.prediction.trackerConfidence',{'val':_0x5a5f17,'ack':!![]});}}}else{if(_0x4c8fed[_0xbc84ea(0x11b)]===_0xbc84ea(0x118)){const {patterns:_0x10c796}=_0x4c8fed['payload'];if(_0x10c796&&_0x10c796[_0xbc84ea(0xf2)]>0x0)_0x1b48a1[_0xbc84ea(0x137)](_0xbc84ea(0xf8),{'val':JSON[_0xbc84ea(0x140)](_0x10c796),'ack':!![]});}}}}}}}}}}}}}}}}}}function a4_0x39c3(){const _0x4493ea=['COMFORT_RESULT','debug','is_anomaly','type','success','312wibSzx','service.py','[LOG]','isArray','âš ï¸\x20SECURITY\x20ALARM:\x20','analysis.isAlert','Error\x20launching\x20Python:\x20','Unknown','parse','HEALTH_TRAIN_RESULT','writable','analysis.prediction.confidence','de-DE','path','482010goXWin','toString','ðŸ\x20Python\x20Pong','Success:\x20','ðŸš€\x20Starting\x20Python\x20Bridge\x20using:\x20','startsWith','Python\x20process\x20exited\x20with\x20code\x20','stderr','applyEnergySavings','[RESULT]','keys','forEach','setStateAsync','analysis.energy.warmupTimes','warn','ENERGY_TRAIN_RESULT','constructor','10277520jBSCJF','join','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','GAIT_RESULT','stringify','HEALTH_TREND_RESULT','42810GUxGro','existsSync','analysis.energy.pinnForecast','ENERGY_PREDICT_RESULT','payload','âŒ\x20CRITICAL:\x20\x27service.py\x27\x20not\x20found!\x20Checked:\x20','sendToPythonWrapper','PINN_PREDICT_RESULT','1233kpMCig','analysis.health.lastCheck','data','close','VENTILATION_ALERT','short','reason','SIGNAL_RESULT','HEALTH_RESULT','toFixed','heating','write','1073120fceTKM','Failed:\x20','analysis.prediction.trackerTopRoom','toLocaleDateString','137296YGFAsf','toLocaleTimeString','analysis.security.lastScore','apply','analysis.energy.heatingScore','ENERGY_OPTIMIZE_RESULT','length','SECURITY_RESULT','analysis.energy.warmupDetails','sendNotification','(((.+)+)+)+$','[PYTHON\x20ERR]\x20','analysis.automation.detectedPatterns','getState','WARMUP_RESULT','analysis.prediction.nextRoom','insulation','substring','2227589CxOhsF','error','log','python_service','analysis.energy.mpcActive','analysis.energy.forecast','info','analysis.health.activityTrend','2-digit','analysis.health.gaitDebug','analysis.health.gaitSpeed','analysis.training.status','trim','\x20AND\x20','analysis.health.isAnomaly','analysis.health.gaitSensors','threshold','search','analysis.security.currentThreshold','analysis.alertReason','analysis.energy.ventilationAlerts','details','[PYTHON]\x20','RL_PENALTY_UPDATE','âœ…\x20HEALTH\x20TRAINED.','4643340yQUQNt'];a4_0x39c3=function(){return _0x4493ea;};return a4_0x39c3();}function startService(_0xf8a3d2,_0x5143e5){const _0x1dcb61=a4_0x415089;let _0x18d79b='python3';if(fs[_0x1dcb61(0x143)](_0x5143e5))_0x18d79b=_0x5143e5;const _0x44f619=path[_0x1dcb61(0x13d)](__dirname,'..',_0x1dcb61(0x11e)),_0x2c929d=path[_0x1dcb61(0x13d)](__dirname,'..',_0x1dcb61(0x101),_0x1dcb61(0x11e));let _0x16a71d='';if(fs[_0x1dcb61(0x143)](_0x44f619))_0x16a71d=_0x44f619;else{if(fs[_0x1dcb61(0x143)](_0x2c929d))_0x16a71d=_0x2c929d;else{_0xf8a3d2[_0x1dcb61(0x100)][_0x1dcb61(0xff)](_0x1dcb61(0x147)+_0x44f619+_0x1dcb61(0x10b)+_0x2c929d+'.\x20Please\x20create\x20this\x20file!');return;}}try{_0xf8a3d2[_0x1dcb61(0x100)][_0x1dcb61(0x104)](_0x1dcb61(0x12f)+_0x18d79b+'\x20'+_0x16a71d),pythonProcess=spawn(_0x18d79b,[_0x16a71d]),pythonProcess['stdout']['on']('data',_0x4bb076=>{const _0x1861e6=_0x1dcb61,_0x5b1af4=_0x4bb076[_0x1861e6(0x12c)]()['split']('\x0a');_0x5b1af4[_0x1861e6(0x136)](_0x14fe23=>{const _0x5c3b74=_0x1861e6,_0x3bf343=_0x14fe23[_0x5c3b74(0x10a)]();if(!_0x3bf343)return;if(_0x3bf343[_0x5c3b74(0x130)](_0x5c3b74(0x11f)))_0xf8a3d2[_0x5c3b74(0x100)][_0x5c3b74(0x119)](_0x5c3b74(0x114)+_0x3bf343[_0x5c3b74(0xfd)](0x5)[_0x5c3b74(0x10a)]());else{if(_0x3bf343[_0x5c3b74(0x130)](_0x5c3b74(0x134)))try{const _0x43246c=JSON['parse'](_0x3bf343[_0x5c3b74(0xfd)](0x8)[_0x5c3b74(0x10a)]());handleResult(_0xf8a3d2,_0x43246c);}catch(_0x3ffec8){}}});}),pythonProcess[_0x1dcb61(0x132)]['on'](_0x1dcb61(0x14c),_0x1511e9=>{const _0x4536a7=_0x1dcb61;_0xf8a3d2['log'][_0x4536a7(0xff)](_0x4536a7(0xf7)+_0x1511e9[_0x4536a7(0x12c)]()[_0x4536a7(0x10a)]());}),pythonProcess['on'](_0x1dcb61(0x14d),_0x28e310=>{const _0x55b008=_0x1dcb61;_0xf8a3d2[_0x55b008(0x100)][_0x55b008(0x139)](_0x55b008(0x131)+_0x28e310),pythonProcess=null;}),_0xf8a3d2[_0x1dcb61(0x148)]=(_0x592a3f,_0x49a58c)=>send(_0xf8a3d2,_0x592a3f,_0x49a58c);}catch(_0x4a2073){_0xf8a3d2[_0x1dcb61(0x100)][_0x1dcb61(0xff)](_0x1dcb61(0x123)+_0x4a2073['message']);}}function stopService(_0x1edfda){if(pythonProcess){try{pythonProcess['kill']();}catch(_0xff0308){}pythonProcess=null;}}module['exports']={'startService':startService,'stopService':stopService,'send':send};