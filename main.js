const a0_0x246150=a0_0x41e9;(function(_0x80bfcb,_0x991284){const _0xc68aab=a0_0x41e9,_0x13e03d=_0x80bfcb();while(!![]){try{const _0xd1b54a=parseInt(_0xc68aab(0x2db))/0x1*(parseInt(_0xc68aab(0x26d))/0x2)+parseInt(_0xc68aab(0x289))/0x3+-parseInt(_0xc68aab(0x26e))/0x4+-parseInt(_0xc68aab(0x249))/0x5+parseInt(_0xc68aab(0x253))/0x6+parseInt(_0xc68aab(0x2ad))/0x7*(-parseInt(_0xc68aab(0x221))/0x8)+parseInt(_0xc68aab(0x21c))/0x9*(-parseInt(_0xc68aab(0x2f0))/0xa);if(_0xd1b54a===_0x991284)break;else _0x13e03d['push'](_0x13e03d['shift']());}catch(_0x18ac61){_0x13e03d['push'](_0x13e03d['shift']());}}}(a0_0x26c6,0x9fbbe));function a0_0x41e9(_0x5b2cc9,_0x3a3d64){const _0x283027=a0_0x26c6();return a0_0x41e9=function(_0x4cd10c,_0x462791){_0x4cd10c=_0x4cd10c-0x1b8;let _0x26c6ee=_0x283027[_0x4cd10c];return _0x26c6ee;},a0_0x41e9(_0x5b2cc9,_0x3a3d64);}const a0_0x462791=(function(){let _0x2a3c27=!![];return function(_0x415d18,_0x12e71d){const _0x26a74b=_0x2a3c27?function(){const _0x230458=a0_0x41e9;if(_0x12e71d){const _0x2d60d9=_0x12e71d[_0x230458(0x314)](_0x415d18,arguments);return _0x12e71d=null,_0x2d60d9;}}:function(){};return _0x2a3c27=![],_0x26a74b;};}()),a0_0x4cd10c=a0_0x462791(this,function(){const _0x5995db=a0_0x41e9;return a0_0x4cd10c[_0x5995db(0x327)]()[_0x5995db(0x30e)](_0x5995db(0x286))[_0x5995db(0x327)]()['constructor'](a0_0x4cd10c)[_0x5995db(0x30e)]('(((.+)+)+)+$');});a0_0x4cd10c();function a0_0x26c6(){const _0x1133fb=['native','System\x20Mode','KALENDER:\x20Keine\x20relevanten\x20Termine','motion','@google/generative-ai','members','Deaktiviert\x20(Pro-Feature)','custom','splice','switch','fenster','Action','val','Lernphase\x20(','k√ºche','0\x204\x20*\x20*\x20*','getStateAsync','08:00','now','[TEST]\x20','analysis.comfortSummary','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','setupBriefingScheduler','18936AQAmzD','861912xQjnSl','indicator.alarm.fire','Activity\x20Summary','Adapter','brightness','getSystemUUID','Baseline\x20Status','getCalendarContext','Gast','ack','off','checkWifiPresence','from','unreach','Drift\x20Status','Gemini\x20Init\x20Error:\x20','initPresenceSubscriptions','Error\x20checking\x20WiFi:\x20','channel','sendNotification','loadDailyDigests','door','isArray','unload','(((.+)+)+)+$','sendMorningBriefing','Trigger\x20Analysis','3752454fPeHdD','driftDetails','object','number','exitTimer','setPresence','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','initHistory','retry','length','eventHistory','lastAlertState','License\x20Check\x20failed:\x20','consumption','bind','replace','geminiApiKey','config_pending','indicator.alarm','system.config','history.','openweathermap.0','uuid','analysis.automation.suggestedAction','runBaselineDriftAnalysis','timestamp','subscribeForeignStatesAsync','KALENDER\x20ERROR:\x20','weatherInstance','scanForDevices','LTM.dailyDigests','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','sensorLastValues','flur','loadSystemMode','onMessage','63AFRnDY','setState','getForeignStateAsync','value.health','Briefing\x20Sched\x20Error:\x20','quality','analysis.isEmergency','WETTER:\x20','Error\x20in\x20onMessage\x20command\x20','notifyPushoverInstance','forEach','loadRawEventLog','initSystemConfig','scheduleJob','lastIndexOf','_score','energy','stringify','calendarSelection','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','toUpperCase','subscribeStates','config','analysis.lastResult','Logbook','PRO-','accuweather','N/A\x20(Learning)','Last\x20raw\x20event','window','saveDailyDigests','Drift\x20Sched\x20Error:\x20','party','presence','setStateAsync','.data.table','state','admin.','\x20min).\x20Watchdog\x20Limit:\x20','setupDriftAnalysisScheduler','currentposition','PARTY','triggerBriefing','minDaysForBaseline','NORMAL','temp','121OnjVIh','Sending\x20notification:\x20\x22','t√ºr','startsWith','rawEventLog','location','isGracePeriodActive','Party','openweathermap','useCalendar','enum.functions.*','longitude','createDailyDigest','AI\x20Emergency\x20Status','onStateChange','split','bewegung','inactivityThresholdHours','isPresent','AI\x20Alert\x20Status','Drift\x20Analysis','10Chbavh','maintenance','siren','LTM.driftAnalysis','none','parse','cogni-living\x20adapter\x20starting\x20(v','notifyTelegramRecipient','command','Scanning\x20for\x20devices\x20(V4:\x20Hard\x20Filter\x20+\x20Recursive)...','processSensorEvent','level','notifyEmailEnabled','Aktiv\x20(','initSensorSubscriptions','javascript.','KALENDER:\x20Keine\x20Daten','slice','Urlaub','rssi','role','push','analysis.health.notes','.NextHours.Location_1.Day_1.current.symbol_desc','type','models/gemini-flash-latest','notifyTelegramInstance','lights','callback','analysis.health.restlessness','search','testNotification','light','enum.rooms.*','Drift\x20Details','Last\x20Result','apply','checkLtmObjects','analysis.analysisHistory','tryParse','Comfort\x20Summary','bad','connection','analysis.feedbackHistory','filter','testApiKey','guest','getForeignObjectAsync','checkSystemObjects','cancel','Error\x20reading\x20calendar\x20table:\x20','onUnload','material.','blind','name','toString','baselineDrift','.Summary.Current','Trigger\x20Digest','application/json','notifyEmailInstance','saveRawEventLog','daswetter.0','Scheduling\x20Morning\x20Briefing\x20for\x20','analysis.activitySummary','events.lastEvent','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','Wohnzimmer','analysisTimer','LTM\x20Sched\x20Error:\x20','.forecast.current.state','systemUUID','dailyDigests','feedbackHistory','\x20|\x20','warn','namespace','uuid-not-found','briefingJob','LTM.baselineStatus','analysis.comfortSuggestion','currentSystemMode','Feedback\x20Log','info.','date','Raw\x20Log','vacation','sort','stick_unreach','isProVersion','lowbat','pop','setupLtmScheduler','events.history','exitGraceTimer','\x20Tage)','getOverviewData','error','event','updateBaselineStatus','version','B√ºro','ical.0','analysis.automation.description','geminiModel','Event\x20History','toLowerCase','LTM','startExitTimer','online','button','VACATION','Badezimmer','system.meta.uuid','analysis.health.sleepScore','Subscribing\x20to\x20','json','extendObjectAsync','createAllObjects','checkLicense','sendToAsync','boolean','getCalendarNames\x20Error:\x20','runGeminiAnalysis','System\x20Status\x20&\x20Control','system.','flot.','Deviation','Starting\x20Autopilot\x20(','find','wohn','Restlessness\x20Level','scriptProblem','Kalender:\x20Deaktiviert','log','0\x203\x20*\x20*\x20*',')\x20-\x20OBFUSCATION\x20SAFE\x20MODE','text','send','system','licenseKey','analysis.trigger','presenceDevices','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','TEST-PRO-KEY','ltmJob','Feedback\x20saved:\x20','analysis.isAlert','expire','Sleep\x20Score\x20(0-100)','Normal','calendarInstance','weather','position','LTM.driftAnalysis.lastCheck','N/A','Cogni-Living','genAI','ready','\x0aSTB:\x20','getForeignObjectsAsync','accuweather.0','modeResetJob','onReady','systemConfig','6367329qIEBDc','setupModeResetScheduler','getCalendarNames','echarts.','time','880144nbTDVC','Processing\x20Status','sound','driftAnalysisTimer','analysisHistory','setObjectNotExistsAsync','sendTo','uuid-error','getEnums','getWeatherContext','analysis.alertReason','initZombies','triggerDailyDigest','ltmLtbWindowDays','LTM.rawEventLog','info','some','K√ºche','substring','signal','fault','KALENDER:\x20','trim','checkLtmDriftObjects','unshift','_calName','analysis.automation.patternDetected','devices','values','status','doors','temperature','includes','dutycycle','runAutopilot','power','node-schedule','map','enum','message','5088295oITqrs','ltmStbWindowDays','text.alarm','unknown','weatherunderground.0','string','working','abortExitTimer','licht','\x20*\x20*\x20*','7131624eFPdqg','updateAnalysisHistory','common'];a0_0x26c6=function(){return _0x1133fb;};return a0_0x26c6();}'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x246150(0x25a)),schedule=require(a0_0x246150(0x245)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x246150(0x309),LTM_SCHEDULE=a0_0x246150(0x1fe),MODE_RESET_SCHEDULE=a0_0x246150(0x265),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x246150(0x22f),LTM_DP_DAILY_DIGESTS=a0_0x246150(0x2a7),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x246150(0x1c6),LTM_DP_DRIFT_CHANNEL=a0_0x246150(0x2f3),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x246150(0x211),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x246150(0x1fb),'scriptEnabled','update',a0_0x246150(0x27b),a0_0x246150(0x1d1),a0_0x246150(0x303),a0_0x246150(0x31a),a0_0x246150(0x2f1),'error',a0_0x246150(0x235),a0_0x246150(0x24f),'direction',a0_0x246150(0x1cf),a0_0x246150(0x29a),a0_0x246150(0x242)],SOFT_IGNORE_TERMS=['battery','voltage','current',a0_0x246150(0x296),a0_0x246150(0x244),a0_0x246150(0x2bd),a0_0x246150(0x234),'link',a0_0x246150(0x2b2)],GENERIC_NAMES=['targetposition',a0_0x246150(0x2d5),'state',a0_0x246150(0x2fb),'value',a0_0x246150(0x272),'on',a0_0x246150(0x278),a0_0x246150(0x25f),a0_0x246150(0x210),'shutter',a0_0x246150(0x325),'cover',a0_0x246150(0x23e),a0_0x246150(0x259),a0_0x246150(0x2ce),'occupancy'],ADAPTER_BLACKLIST=[a0_0x246150(0x1f4),a0_0x246150(0x2d2),a0_0x246150(0x1ca),'vis.',a0_0x246150(0x29d),a0_0x246150(0x324),'icons-mfd.',a0_0x246150(0x1f5),a0_0x246150(0x21f),a0_0x246150(0x2ff)],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x246150(0x1cd),'PARTY':a0_0x246150(0x2cd),'GUEST':a0_0x246150(0x31e)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x246150(0x2d6)],SYSTEM_MODES['GUEST']],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x246150(0x28f),'senior_aal':a0_0x246150(0x206),'family':a0_0x246150(0x1b9),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':'PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.'};class CogniLiving extends utils[a0_0x246150(0x271)]{constructor(_0x19ef77){const _0x48ca43=a0_0x246150;super({..._0x19ef77,'name':'cogni-living'}),this[_0x48ca43(0x293)]=[],this[_0x48ca43(0x225)]=[],this[_0x48ca43(0x1c0)]=[],this[_0x48ca43(0x2df)]=[],this[_0x48ca43(0x1bf)]=[],this[_0x48ca43(0x2a9)]={},this[_0x48ca43(0x21b)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x48ca43(0x2ed)]=!![],this[_0x48ca43(0x28d)]=null,this['exitGraceTimer']=null,this[_0x48ca43(0x2e1)]=![],this[_0x48ca43(0x214)]=null,this[_0x48ca43(0x1df)]=null,this[_0x48ca43(0x1c8)]=SYSTEM_MODES[_0x48ca43(0x2d9)],this[_0x48ca43(0x1d0)]=![],this[_0x48ca43(0x294)]=![],this[_0x48ca43(0x1be)]=_0x48ca43(0x24c),this[_0x48ca43(0x1bb)]=null,this[_0x48ca43(0x208)]=null,this[_0x48ca43(0x219)]=null,this[_0x48ca43(0x224)]=null,this['briefingJob']=null,this['on'](_0x48ca43(0x215),this[_0x48ca43(0x21a)][_0x48ca43(0x297)](this)),this['on']('stateChange',this[_0x48ca43(0x2e9)][_0x48ca43(0x297)](this)),this['on'](_0x48ca43(0x285),this[_0x48ca43(0x323)][_0x48ca43(0x297)](this)),this['on'](_0x48ca43(0x248),this[_0x48ca43(0x2ac)]['bind'](this));}async[a0_0x246150(0x21a)](){const _0x5bfbb3=a0_0x246150;this['log'][_0x5bfbb3(0x230)](_0x5bfbb3(0x2f6)+this[_0x5bfbb3(0x1db)]+_0x5bfbb3(0x1ff)),await this[_0x5bfbb3(0x22c)](),this['config'][_0x5bfbb3(0x203)]=this['config'][_0x5bfbb3(0x203)]||'';try{this[_0x5bfbb3(0x1d0)]=await this[_0x5bfbb3(0x1ee)](this['config'][_0x5bfbb3(0x203)]);}catch(_0x140922){this[_0x5bfbb3(0x1fd)][_0x5bfbb3(0x1d8)](_0x5bfbb3(0x295)+_0x140922[_0x5bfbb3(0x248)]);}if(!this[_0x5bfbb3(0x2c3)][_0x5bfbb3(0x2ec)]||this[_0x5bfbb3(0x2c3)][_0x5bfbb3(0x2ec)]<0.1)this[_0x5bfbb3(0x2c3)][_0x5bfbb3(0x2ec)]=0xc;await this[_0x5bfbb3(0x290)](),await this[_0x5bfbb3(0x2b9)]();if(this[_0x5bfbb3(0x2c3)][_0x5bfbb3(0x299)])try{this[_0x5bfbb3(0x214)]=new GoogleGenerativeAI(this['config'][_0x5bfbb3(0x299)]),this['geminiModel']=this[_0x5bfbb3(0x214)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5bfbb3(0x32b)}}),this[_0x5bfbb3(0x1fd)][_0x5bfbb3(0x230)]('Gemini\x20AI\x20initialized.');}catch(_0x4d88ad){this[_0x5bfbb3(0x1fd)][_0x5bfbb3(0x1d8)](_0x5bfbb3(0x27d)+_0x4d88ad[_0x5bfbb3(0x248)]);}await this[_0x5bfbb3(0x1ed)](),await this[_0x5bfbb3(0x2ab)](),await this[_0x5bfbb3(0x2b8)](),await this[_0x5bfbb3(0x282)](),this[_0x5bfbb3(0x2c2)]('analysis.trigger'),this[_0x5bfbb3(0x2c2)](LTM_DP_TRIGGER_DIGEST),this[_0x5bfbb3(0x2c2)]('system.mode'),this[_0x5bfbb3(0x2c2)]('analysis.triggerBriefing'),await this[_0x5bfbb3(0x2fe)](),await this[_0x5bfbb3(0x27e)]();if(this[_0x5bfbb3(0x1bb)])clearInterval(this['analysisTimer']);const _0x381b56=this[_0x5bfbb3(0x2c3)]['analysisInterval']||0xf;_0x381b56>0x0&&(this[_0x5bfbb3(0x1fd)]['info'](_0x5bfbb3(0x1f7)+_0x381b56+_0x5bfbb3(0x2d3)+this[_0x5bfbb3(0x2c3)][_0x5bfbb3(0x2ec)]+'h.'),this[_0x5bfbb3(0x1bb)]=setInterval(()=>{this['runAutopilot']();},_0x381b56*0x3c*0x3e8)),this[_0x5bfbb3(0x1d3)](),this[_0x5bfbb3(0x21d)](),this[_0x5bfbb3(0x2d4)](),this[_0x5bfbb3(0x26c)]();}[a0_0x246150(0x323)](_0x496276){const _0x53ec6e=a0_0x246150;if(this[_0x53ec6e(0x1bb)])clearInterval(this[_0x53ec6e(0x1bb)]);if(this[_0x53ec6e(0x224)])clearInterval(this[_0x53ec6e(0x224)]);if(this[_0x53ec6e(0x208)])this[_0x53ec6e(0x208)][_0x53ec6e(0x321)]();if(this[_0x53ec6e(0x219)])this['modeResetJob']['cancel']();if(this[_0x53ec6e(0x1c5)])this['briefingJob'][_0x53ec6e(0x321)]();if(this[_0x53ec6e(0x28d)])clearTimeout(this[_0x53ec6e(0x28d)]);if(this[_0x53ec6e(0x1d5)])clearTimeout(this[_0x53ec6e(0x1d5)]);_0x496276();}async[a0_0x246150(0x2e9)](_0x18c0d8,_0x4f03e6){const _0x38dad0=a0_0x246150;if(!_0x4f03e6)return;if(_0x18c0d8===this[_0x38dad0(0x1c3)]+'.'+SYSTEM_DP_MODE){_0x4f03e6['val']&&Object[_0x38dad0(0x23d)](SYSTEM_MODES)['includes'](_0x4f03e6[_0x38dad0(0x262)])&&(this[_0x38dad0(0x1c8)]=_0x4f03e6[_0x38dad0(0x262)],_0x4f03e6[_0x38dad0(0x262)]===SYSTEM_MODES['VACATION']?await this[_0x38dad0(0x28e)](![]):await this['setPresence'](!![]));if(!_0x4f03e6[_0x38dad0(0x277)])this[_0x38dad0(0x2ae)](_0x18c0d8,{'val':this[_0x38dad0(0x1c8)],'ack':!![]});return;}if(!_0x4f03e6[_0x38dad0(0x277)]){_0x18c0d8[_0x38dad0(0x241)](_0x38dad0(0x204))&&_0x4f03e6['val']&&(this[_0x38dad0(0x2ae)](_0x18c0d8,{'val':![],'ack':!![]}),this[_0x38dad0(0x1f2)]());if(_0x18c0d8[_0x38dad0(0x241)](_0x38dad0(0x22d))&&_0x4f03e6[_0x38dad0(0x262)]){this[_0x38dad0(0x2ae)](_0x18c0d8,{'val':![],'ack':!![]});if(this[_0x38dad0(0x1d0)])this['createDailyDigest']();}_0x18c0d8['includes'](_0x38dad0(0x2d7))&&_0x4f03e6[_0x38dad0(0x262)]&&(this[_0x38dad0(0x2ae)](_0x18c0d8,{'val':![],'ack':!![]}),this[_0x38dad0(0x287)]());return;}if(this[_0x38dad0(0x2c3)][_0x38dad0(0x205)]&&this[_0x38dad0(0x2c3)][_0x38dad0(0x205)][_0x38dad0(0x241)](_0x18c0d8)){await this[_0x38dad0(0x279)]();return;}const _0x47ad04=(this[_0x38dad0(0x2c3)][_0x38dad0(0x23c)]||[])[_0x38dad0(0x1f8)](_0x41f70d=>_0x41f70d['id']===_0x18c0d8);if(_0x47ad04)this['processSensorEvent'](_0x18c0d8,_0x4f03e6,_0x47ad04);}async['onMessage'](_0x233f72){const _0x587060=a0_0x246150;if(typeof _0x233f72===_0x587060(0x28b)&&_0x233f72['message'])try{if(_0x233f72[_0x587060(0x2f8)]===_0x587060(0x31d)){}else{if(_0x233f72[_0x587060(0x2f8)]===_0x587060(0x30f)){}else{if(_0x233f72[_0x587060(0x2f8)]==='getLtmData'){}else{if(_0x233f72['command']===_0x587060(0x1d7)){const _0x13114b=this[_0x587060(0x1bf)][_0x587060(0x292)],_0x52a10d=this[_0x587060(0x293)][_0x587060(0x31c)](_0x6bf03d=>_0x6bf03d[_0x587060(0x2a2)]>new Date()['setHours'](0x0,0x0,0x0,0x0))['length'];let _0x1c6a9c={'status':_0x587060(0x212)};try{_0x1c6a9c[_0x587060(0x23e)]=(await this[_0x587060(0x266)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x33a021){}this[_0x587060(0x227)](_0x233f72[_0x587060(0x27a)],_0x233f72[_0x587060(0x2f8)],{'success':!![],'eventHistory':this[_0x587060(0x293)][_0x587060(0x301)](0x0,0xf),'stats':{'digestCount':_0x13114b,'eventCountToday':_0x52a10d,'driftStatus':_0x1c6a9c['status'],'isPresent':this[_0x587060(0x2ed)],'minDays':this[_0x587060(0x2c3)][_0x587060(0x2d8)]||0x7}},_0x233f72[_0x587060(0x30c)]);}else{if(_0x233f72[_0x587060(0x2f8)]===_0x587060(0x229)){const _0x52e3ed=await this['getForeignObjectsAsync']('enum.functions.*',_0x587060(0x247)),_0x19f83a=[];if(_0x52e3ed)for(const _0x5f061e in _0x52e3ed){const _0x2649fd=_0x52e3ed[_0x5f061e],_0x41ef60=(_0x2649fd[_0x587060(0x255)]&&typeof _0x2649fd['common'][_0x587060(0x326)]==='object'?_0x2649fd[_0x587060(0x255)][_0x587060(0x326)]['de']:_0x2649fd['common'][_0x587060(0x326)])||_0x2649fd[_0x587060(0x255)][_0x587060(0x326)];_0x19f83a[_0x587060(0x305)]({'id':_0x5f061e,'name':_0x41ef60});}this[_0x587060(0x227)](_0x233f72[_0x587060(0x27a)],_0x233f72[_0x587060(0x2f8)],{'success':!![],'enums':_0x19f83a},_0x233f72[_0x587060(0x30c)]);}else{if(_0x233f72[_0x587060(0x2f8)]==='scanDevices')try{const _0x35e62c=await this[_0x587060(0x2a6)](_0x233f72[_0x587060(0x248)]||{});this[_0x587060(0x227)](_0x233f72[_0x587060(0x27a)],_0x233f72['command'],{'success':!![],'devices':_0x35e62c},_0x233f72['callback']);}catch(_0x15016f){this['sendTo'](_0x233f72[_0x587060(0x27a)],_0x233f72['command'],{'success':![],'error':_0x15016f[_0x587060(0x248)]},_0x233f72[_0x587060(0x30c)]);}}}}}}}catch(_0x2f8b39){this[_0x587060(0x1fd)][_0x587060(0x1d8)](_0x587060(0x2b5)+_0x233f72[_0x587060(0x2f8)]+':\x20'+_0x2f8b39[_0x587060(0x248)]);if(_0x233f72[_0x587060(0x30c)])this[_0x587060(0x227)](_0x233f72[_0x587060(0x27a)],_0x233f72['command'],{'success':![],'error':_0x2f8b39[_0x587060(0x248)]},_0x233f72['callback']);}}async[a0_0x246150(0x2fa)](_0x117d2b,_0x5c0e73,_0xf0b417){const _0x1e2606=a0_0x246150;if(!_0xf0b417['logDuplicates']&&this[_0x1e2606(0x2a9)][_0x117d2b]===_0x5c0e73[_0x1e2606(0x262)])return;this[_0x1e2606(0x2a9)][_0x117d2b]=_0x5c0e73[_0x1e2606(0x262)];if(this[_0x1e2606(0x2e1)])return;const _0x3f0bf2=await this['checkWifiPresence']();if(_0x3f0bf2){if(!this['isPresent'])await this['setPresence'](!![]);}else{const _0xfe33e1=_0xf0b417['isExit']===!![];_0xfe33e1?this[_0x1e2606(0x1e3)]():(this['exitTimer']&&this['abortExitTimer'](),!this['isPresent']&&this[_0x1e2606(0x1c8)]===SYSTEM_MODES[_0x1e2606(0x2d9)]&&await this['setPresence'](!![]));}const _0x25c7d4={'timestamp':_0x5c0e73['ts'],'id':_0x117d2b,'name':_0xf0b417[_0x1e2606(0x326)],'value':_0x5c0e73[_0x1e2606(0x262)],'location':_0xf0b417[_0x1e2606(0x2e0)],'type':_0xf0b417['type']};this[_0x1e2606(0x293)][_0x1e2606(0x239)](_0x25c7d4);if(this[_0x1e2606(0x293)][_0x1e2606(0x292)]>HISTORY_MAX_SIZE)this['eventHistory']['pop']();await this[_0x1e2606(0x2cf)]('events.lastEvent',{'val':JSON[_0x1e2606(0x2be)](_0x25c7d4),'ack':!![]}),await this[_0x1e2606(0x2cf)](_0x1e2606(0x1d4),{'val':JSON[_0x1e2606(0x2be)](this[_0x1e2606(0x293)]),'ack':!![]}),this[_0x1e2606(0x2df)][_0x1e2606(0x305)]({'timestamp':new Date(_0x5c0e73['ts'])['toISOString'](),'sensorName':_0xf0b417[_0x1e2606(0x326)],'location':_0xf0b417[_0x1e2606(0x2e0)],'value':_0x5c0e73[_0x1e2606(0x262)]}),await this[_0x1e2606(0x32d)]();}async[a0_0x246150(0x243)](){}async[a0_0x246150(0x1f2)](_0x4ae671=''){}async[a0_0x246150(0x2e7)](){}async[a0_0x246150(0x287)](){}async[a0_0x246150(0x2a6)](_0x585508){const _0xe1de8c=a0_0x246150;this['log'][_0xe1de8c(0x230)](_0xe1de8c(0x2f9));const _0x135463=[],_0x21aaa9=await this['getForeignObjectsAsync']('*');let _0x20881b=0x0;const _0x2049b1=await this[_0xe1de8c(0x217)](_0xe1de8c(0x311),_0xe1de8c(0x247)),_0x3ac130=await this['getForeignObjectsAsync'](_0xe1de8c(0x2e5),_0xe1de8c(0x247)),_0x2af657={};if(_0x2049b1)for(const _0x187e4f in _0x2049b1){const _0x2900d=_0x2049b1[_0x187e4f][_0xe1de8c(0x255)][_0xe1de8c(0x25b)]||[],_0x5535bc=typeof _0x2049b1[_0x187e4f][_0xe1de8c(0x255)][_0xe1de8c(0x326)]===_0xe1de8c(0x28b)?_0x2049b1[_0x187e4f][_0xe1de8c(0x255)][_0xe1de8c(0x326)]['de']:_0x2049b1[_0x187e4f][_0xe1de8c(0x255)]['name'];_0x2900d[_0xe1de8c(0x2b7)](_0x1c03c1=>_0x2af657[_0x1c03c1]=_0x5535bc);}const _0x4c2cc7={};if(_0x3ac130)for(const _0xee02ef in _0x3ac130){const _0x5bbd45=_0x3ac130[_0xee02ef][_0xe1de8c(0x255)][_0xe1de8c(0x25b)]||[],_0x135aa7=_0xee02ef[_0xe1de8c(0x2ea)]('.')[_0xe1de8c(0x1d2)]()[_0xe1de8c(0x1e1)]();_0x5bbd45[_0xe1de8c(0x2b7)](_0x49d7dc=>{const _0x4d56d2=_0xe1de8c;if(!_0x4c2cc7[_0x49d7dc])_0x4c2cc7[_0x49d7dc]=[];_0x4c2cc7[_0x49d7dc][_0x4d56d2(0x305)](_0x135aa7);});}const _0x5d5bc5=_0x585508['selectedFunctionIds']||[],_0x63ef81=_0x585508[_0xe1de8c(0x259)]!==![],_0x384983=_0x585508[_0xe1de8c(0x23f)]!==![],_0x1ba190=_0x585508[_0xe1de8c(0x30b)]!==![],_0x7d2cd6=_0x585508[_0xe1de8c(0x240)]===!![],_0x48543b=_0x585508[_0xe1de8c(0x20f)]===!![];for(const _0x530d13 in _0x21aaa9){const _0x2ab00d=_0x21aaa9[_0x530d13];if(_0x2ab00d[_0xe1de8c(0x308)]!==_0xe1de8c(0x2d1)||!_0x2ab00d[_0xe1de8c(0x255)])continue;if(ADAPTER_BLACKLIST['some'](_0x3729df=>_0x530d13[_0xe1de8c(0x2de)](_0x3729df))&&!_0x48543b)continue;const _0x5d0cae=(_0x2ab00d[_0xe1de8c(0x255)][_0xe1de8c(0x304)]||'')[_0xe1de8c(0x1e1)]();let _0x1d7308=(typeof _0x2ab00d[_0xe1de8c(0x255)][_0xe1de8c(0x326)]==='object'?_0x2ab00d['common'][_0xe1de8c(0x326)]['de']:_0x2ab00d['common'][_0xe1de8c(0x326)])||_0x530d13;const _0x2900c3=_0x1d7308[_0xe1de8c(0x1e1)]();if(HARD_IGNORE_TERMS['some'](_0x239d03=>_0x530d13[_0xe1de8c(0x241)](_0x239d03)||_0x2900c3[_0xe1de8c(0x241)](_0x239d03[_0xe1de8c(0x1e1)]())))continue;const _0x35076a=GENERIC_NAMES[_0xe1de8c(0x231)](_0x542207=>_0x2900c3['includes'](_0x542207))||_0x2900c3[_0xe1de8c(0x241)]('targetposition');if(_0x35076a){let _0x99033e='',_0x42e9d2=_0x530d13;for(let _0x27c299=0x0;_0x27c299<0x4;_0x27c299++){const _0x22b6d5=_0x42e9d2[_0xe1de8c(0x2bb)]('.');if(_0x22b6d5===-0x1)break;_0x42e9d2=_0x42e9d2[_0xe1de8c(0x233)](0x0,_0x22b6d5);const _0x24bfb3=_0x21aaa9[_0x42e9d2];if(_0x24bfb3&&_0x24bfb3[_0xe1de8c(0x255)]&&_0x24bfb3[_0xe1de8c(0x255)][_0xe1de8c(0x326)]){const _0x3eff4c=typeof _0x24bfb3[_0xe1de8c(0x255)][_0xe1de8c(0x326)]===_0xe1de8c(0x28b)?_0x24bfb3['common'][_0xe1de8c(0x326)]['de']:_0x24bfb3['common'][_0xe1de8c(0x326)],_0x94108d=_0x3eff4c?_0x3eff4c[_0xe1de8c(0x1e1)]():'',_0x10926e=_0x42e9d2['split']('.')[_0xe1de8c(0x1d2)]()[_0xe1de8c(0x1e1)]();_0x3eff4c&&!_0x94108d['includes'](_0xe1de8c(0x280))&&!_0x94108d[_0xe1de8c(0x241)]('device')&&_0x94108d!==_0x10926e&&_0x3eff4c[_0xe1de8c(0x292)]>0x2&&(_0x99033e=_0x3eff4c);}}_0x99033e&&!_0x1d7308[_0xe1de8c(0x1e1)]()[_0xe1de8c(0x241)](_0x99033e[_0xe1de8c(0x1e1)]())&&(_0x1d7308=_0x99033e+'\x20'+_0x1d7308);}const _0x352fd3=_0x4c2cc7[_0x530d13]||[];let _0x5d0379=![],_0x32d4c5=![];if(_0x5d5bc5[_0xe1de8c(0x292)]>0x0)for(const _0x5f4e62 of _0x5d5bc5){if(_0x3ac130[_0x5f4e62]&&_0x3ac130[_0x5f4e62][_0xe1de8c(0x255)][_0xe1de8c(0x25b)]){const _0x488929=_0x3ac130[_0x5f4e62][_0xe1de8c(0x255)][_0xe1de8c(0x25b)];if(_0x488929[_0xe1de8c(0x241)](_0x530d13)||_0x488929[_0xe1de8c(0x231)](_0x53c646=>_0x530d13[_0xe1de8c(0x2de)](_0x53c646+'.'))){_0x5d0379=!![],_0x32d4c5=!![];break;}}}if(!_0x5d0379&&!_0x48543b){if(SOFT_IGNORE_TERMS[_0xe1de8c(0x231)](_0x8f4eba=>_0x530d13[_0xe1de8c(0x2c1)]()[_0xe1de8c(0x241)](_0x8f4eba)||_0x2900c3[_0xe1de8c(0x241)](_0x8f4eba[_0xe1de8c(0x1e1)]()))){if(!_0x5d0cae[_0xe1de8c(0x241)]('motion')&&!_0x5d0cae[_0xe1de8c(0x241)]('door')&&!_0x5d0cae[_0xe1de8c(0x241)](_0xe1de8c(0x25f)))continue;}}let _0x560c3e='';if(_0x63ef81&&(_0x5d0cae[_0xe1de8c(0x241)](_0xe1de8c(0x259))||_0x2900c3['includes'](_0xe1de8c(0x2eb))))_0x560c3e=_0xe1de8c(0x259);else{if(!_0x560c3e&&_0x384983&&(_0x5d0cae[_0xe1de8c(0x241)](_0xe1de8c(0x283))||_0x5d0cae[_0xe1de8c(0x241)](_0xe1de8c(0x2ca))||_0x2900c3[_0xe1de8c(0x241)](_0xe1de8c(0x260))||_0x2900c3['includes'](_0xe1de8c(0x2dd))))_0x560c3e='door';else{if(!_0x560c3e&&_0x1ba190&&(_0x5d0cae['includes'](_0xe1de8c(0x310))||_0x2900c3[_0xe1de8c(0x241)](_0xe1de8c(0x251))))_0x560c3e='light';else{if(!_0x560c3e&&_0x7d2cd6&&(_0x5d0cae[_0xe1de8c(0x241)](_0xe1de8c(0x240))||_0x2900c3['includes'](_0xe1de8c(0x2da))))_0x560c3e=_0xe1de8c(0x240);else{if(!_0x560c3e&&_0x32d4c5)_0x560c3e=_0xe1de8c(0x25d);}}}}if(_0x560c3e){let _0x1db3df=_0x2af657[_0x530d13]||'';if(!_0x1db3df){let _0x4288f8=_0x530d13;for(let _0x377ba0=0x0;_0x377ba0<0x3;_0x377ba0++){const _0xa0a67e=_0x4288f8[_0xe1de8c(0x2bb)]('.');if(_0xa0a67e===-0x1)break;_0x4288f8=_0x4288f8[_0xe1de8c(0x233)](0x0,_0xa0a67e);if(_0x2af657[_0x4288f8]){_0x1db3df=_0x2af657[_0x4288f8];break;}}}if(!_0x1db3df){if(_0x2900c3[_0xe1de8c(0x241)](_0xe1de8c(0x319)))_0x1db3df=_0xe1de8c(0x1e7);else{if(_0x2900c3[_0xe1de8c(0x241)](_0xe1de8c(0x264)))_0x1db3df=_0xe1de8c(0x232);else{if(_0x2900c3[_0xe1de8c(0x241)](_0xe1de8c(0x1f9)))_0x1db3df=_0xe1de8c(0x1ba);else{if(_0x2900c3[_0xe1de8c(0x241)]('schlaf'))_0x1db3df='Schlafzimmer';else{if(_0x2900c3[_0xe1de8c(0x241)](_0xe1de8c(0x2aa)))_0x1db3df='Flur';else{if(_0x2900c3[_0xe1de8c(0x241)]('b√ºro'))_0x1db3df=_0xe1de8c(0x1dc);}}}}}}_0x135463[_0xe1de8c(0x305)]({'id':_0x530d13,'name':_0x1d7308,'location':_0x1db3df,'type':_0x560c3e,'logDuplicates':_0x560c3e===_0xe1de8c(0x259),'isExit':![],'_score':_0x1db3df?0x50:_0x560c3e===_0xe1de8c(0x25d)?0x5a:0x28});}}return _0x135463[_0xe1de8c(0x1ce)]((_0x3f192e,_0x23c07e)=>_0x23c07e['_score']-_0x3f192e[_0xe1de8c(0x2bc)]),_0x135463;}[a0_0x246150(0x317)](_0x454039){const _0x4e6af3=a0_0x246150;if(typeof _0x454039===_0x4e6af3(0x28b))return _0x454039;try{return JSON[_0x4e6af3(0x2f5)](_0x454039);}catch(_0x4a2f14){return null;}}async[a0_0x246150(0x22c)](){}async[a0_0x246150(0x290)](){const _0x5e8f81=a0_0x246150;try{const _0x3bddb8=await this[_0x5e8f81(0x266)](_0x5e8f81(0x1d4));_0x3bddb8&&_0x3bddb8[_0x5e8f81(0x262)]&&(this[_0x5e8f81(0x293)]=JSON[_0x5e8f81(0x2f5)](_0x3bddb8[_0x5e8f81(0x262)][_0x5e8f81(0x327)]()));}catch(_0x4d5b92){this[_0x5e8f81(0x293)]=[];}try{const _0x5a4640=await this[_0x5e8f81(0x266)](_0x5e8f81(0x316));if(_0x5a4640&&_0x5a4640[_0x5e8f81(0x262)])this['analysisHistory']=JSON[_0x5e8f81(0x2f5)](_0x5a4640[_0x5e8f81(0x262)]['toString']());}catch(_0x46b41b){this[_0x5e8f81(0x225)]=[];}}async[a0_0x246150(0x2b9)](){const _0x368a8b=a0_0x246150;try{const _0x3f8c3b=await this[_0x368a8b(0x31f)](_0x368a8b(0x29c));_0x3f8c3b&&_0x3f8c3b['common']&&(this[_0x368a8b(0x21b)]={'latitude':_0x3f8c3b[_0x368a8b(0x255)]['latitude']||0x0,'longitude':_0x3f8c3b[_0x368a8b(0x255)][_0x368a8b(0x2e6)]||0x0,'city':_0x3f8c3b[_0x368a8b(0x255)]['city']||''});}catch(_0x20fa36){}}async[a0_0x246150(0x1ee)](_0x58b609){const _0x5f3da7=a0_0x246150;if(!_0x58b609)return![];this['systemUUID']=await this[_0x5f3da7(0x273)]();if(_0x58b609===_0x5f3da7(0x207)||_0x58b609[_0x5f3da7(0x2de)](_0x5f3da7(0x2c6)))return!![];return![];}async[a0_0x246150(0x273)](){const _0x384217=a0_0x246150;try{const _0x1b5d01=await this['getForeignObjectAsync'](_0x384217(0x1e8));if(_0x1b5d01&&_0x1b5d01[_0x384217(0x256)]&&_0x1b5d01[_0x384217(0x256)][_0x384217(0x29f)])return _0x1b5d01[_0x384217(0x256)][_0x384217(0x29f)];return _0x384217(0x1c4);}catch(_0x8ae401){return _0x384217(0x228);}}async['createAllObjects'](){const _0x5aa344=a0_0x246150;await this[_0x5aa344(0x320)](),await this[_0x5aa344(0x226)](_0x5aa344(0x1b8),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x2c9),'type':'string','role':_0x5aa344(0x1eb),'read':!![],'write':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x1d4),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x1e0),'type':_0x5aa344(0x24e),'role':_0x5aa344(0x1eb),'read':!![],'write':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x204),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x288),'type':_0x5aa344(0x1f0),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x5aa344(0x226)]('analysis.triggerBriefing',{'type':_0x5aa344(0x2d1),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x5aa344(0x1f0),'role':_0x5aa344(0x1e5),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x2c4),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x313),'type':'string','role':_0x5aa344(0x1eb),'read':!![],'write':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x20a),{'type':'state','common':{'name':_0x5aa344(0x2ee),'type':_0x5aa344(0x1f0),'role':_0x5aa344(0x29b),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x2b3),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x2e8),'type':_0x5aa344(0x1f0),'role':_0x5aa344(0x26f),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x22b),{'type':_0x5aa344(0x2d1),'common':{'name':'Alert\x20Reason','type':'string','role':_0x5aa344(0x24b),'read':!![],'write':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x330),{'type':'state','common':{'name':_0x5aa344(0x270),'type':_0x5aa344(0x24e),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x5aa344(0x226)]('analysis.deviationFromBaseline',{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x1f6),'type':'string','role':_0x5aa344(0x2d1),'read':!![],'write':![],'def':_0x5aa344(0x212)},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x26a),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x318),'type':_0x5aa344(0x24e),'role':_0x5aa344(0x200),'read':!![],'write':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x1c7),{'type':'state','common':{'name':'Comfort\x20Suggestion','type':_0x5aa344(0x24e),'role':_0x5aa344(0x200),'read':!![],'write':![]},'native':{}}),await this[_0x5aa344(0x1ec)]('analysis.automation',{'type':_0x5aa344(0x280),'common':{'name':'Automation\x20Proposals'},'native':{}}),await this['setObjectNotExistsAsync'](_0x5aa344(0x23b),{'type':_0x5aa344(0x2d1),'common':{'name':'Pattern\x20Detected','type':_0x5aa344(0x1f0),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x5aa344(0x1de),{'type':_0x5aa344(0x2d1),'common':{'name':'Description','type':'string','role':_0x5aa344(0x200),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x5aa344(0x2a0),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x261),'type':_0x5aa344(0x24e),'role':_0x5aa344(0x200),'read':!![],'write':![]},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x316),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x2c5),'type':_0x5aa344(0x24e),'role':_0x5aa344(0x1eb),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x31b),{'type':'state','common':{'name':_0x5aa344(0x1c9),'type':_0x5aa344(0x24e),'role':_0x5aa344(0x1eb),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x5aa344(0x1ec)]('analysis.health',{'type':_0x5aa344(0x280),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x1e9),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x20c),'type':_0x5aa344(0x28c),'role':_0x5aa344(0x2b0),'read':!![],'write':![],'def':0x0},'native':{}}),await this[_0x5aa344(0x226)](_0x5aa344(0x30d),{'type':_0x5aa344(0x2d1),'common':{'name':_0x5aa344(0x1fa),'type':_0x5aa344(0x24e),'role':'text','read':!![],'write':![],'def':_0x5aa344(0x2f4)},'native':{}}),await this['setObjectNotExistsAsync'](_0x5aa344(0x306),{'type':_0x5aa344(0x2d1),'common':{'name':'Health\x20Notes','type':_0x5aa344(0x24e),'role':_0x5aa344(0x200),'read':!![],'write':![],'def':''},'native':{}}),await this[_0x5aa344(0x315)](),await this[_0x5aa344(0x238)]();}async[a0_0x246150(0x320)](){const _0x292a82=a0_0x246150;await this['extendObjectAsync'](_0x292a82(0x202),{'type':_0x292a82(0x280),'common':{'name':_0x292a82(0x1f3)},'native':{}}),await this[_0x292a82(0x1ec)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x292a82(0x257),'type':'string','role':_0x292a82(0x2d1),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x292a82(0x2d9)],'states':{[SYSTEM_MODES[_0x292a82(0x2d9)]]:_0x292a82(0x20d),[SYSTEM_MODES[_0x292a82(0x1e6)]]:_0x292a82(0x302),[SYSTEM_MODES['PARTY']]:_0x292a82(0x2e2),[SYSTEM_MODES['GUEST']]:_0x292a82(0x276)}},'native':{}});}async[a0_0x246150(0x315)](){const _0x4513ca=a0_0x246150;await this['extendObjectAsync'](_0x4513ca(0x1e2),{'type':_0x4513ca(0x280),'common':{'name':_0x4513ca(0x1e2)},'native':{}}),await this[_0x4513ca(0x1ec)](LTM_DP_RAW_LOG,{'type':_0x4513ca(0x2d1),'common':{'name':_0x4513ca(0x1cc),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x4513ca(0x2d1),'common':{'name':'Daily\x20Digests','type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x4513ca(0x1ec)](LTM_DP_STATUS,{'type':'state','common':{'name':_0x4513ca(0x222),'type':_0x4513ca(0x24e),'role':_0x4513ca(0x200),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x4513ca(0x2d1),'common':{'name':_0x4513ca(0x32a),'type':_0x4513ca(0x1f0),'role':_0x4513ca(0x1e5),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x4513ca(0x1ec)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':_0x4513ca(0x274),'type':_0x4513ca(0x24e),'role':_0x4513ca(0x200),'read':!![],'write':![]},'native':{}});}async[a0_0x246150(0x238)](){const _0x37eb9d=a0_0x246150;await this[_0x37eb9d(0x1ec)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x37eb9d(0x2ef)},'native':{}}),await this[_0x37eb9d(0x1ec)](LTM_DP_DRIFT_STATUS,{'type':_0x37eb9d(0x2d1),'common':{'name':_0x37eb9d(0x27c),'type':_0x37eb9d(0x24e),'role':'state','read':!![],'write':![],'def':_0x37eb9d(0x212)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x37eb9d(0x2d1),'common':{'name':_0x37eb9d(0x312),'type':_0x37eb9d(0x24e),'role':_0x37eb9d(0x200),'read':!![],'write':![]},'native':{}}),await this[_0x37eb9d(0x1ec)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x37eb9d(0x2d1),'common':{'name':'Last\x20Check','type':_0x37eb9d(0x28c),'role':'date','read':!![],'write':![]},'native':{}});}async['loadSystemMode'](){const _0x26889e=a0_0x246150;try{const _0x27fb5d=await this[_0x26889e(0x266)](SYSTEM_DP_MODE);_0x27fb5d&&_0x27fb5d[_0x26889e(0x262)]&&Object['values'](SYSTEM_MODES)[_0x26889e(0x241)](_0x27fb5d['val'])?this[_0x26889e(0x1c8)]=_0x27fb5d[_0x26889e(0x262)]:(this['currentSystemMode']=SYSTEM_MODES[_0x26889e(0x2d9)],await this[_0x26889e(0x2cf)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x26889e(0x2d9)],'ack':!![]}));}catch(_0x232018){this['currentSystemMode']=SYSTEM_MODES['NORMAL'];}}async[a0_0x246150(0x2b8)](){const _0x1af151=a0_0x246150;try{const _0x25fdfb=await this[_0x1af151(0x266)](LTM_DP_RAW_LOG);if(_0x25fdfb&&_0x25fdfb[_0x1af151(0x262)])this['rawEventLog']=JSON['parse'](_0x25fdfb[_0x1af151(0x262)]);}catch(_0x45787e){this[_0x1af151(0x2df)]=[];}}async[a0_0x246150(0x282)](){const _0x3f6052=a0_0x246150;try{const _0x4565fb=await this[_0x3f6052(0x266)](LTM_DP_DAILY_DIGESTS);if(_0x4565fb&&_0x4565fb[_0x3f6052(0x262)])this[_0x3f6052(0x1bf)]=JSON['parse'](_0x4565fb[_0x3f6052(0x262)]);}catch(_0x2875f8){this['dailyDigests']=[];}await this[_0x3f6052(0x1da)]();}async[a0_0x246150(0x32d)](){const _0x22cfd1=a0_0x246150;this[_0x22cfd1(0x2df)][_0x22cfd1(0x292)]>RAW_LOG_MAX_SIZE&&this[_0x22cfd1(0x2df)][_0x22cfd1(0x25e)](0x0,this[_0x22cfd1(0x2df)]['length']-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x22cfd1(0x2be)](this[_0x22cfd1(0x2df)]),'ack':!![]});}async[a0_0x246150(0x2cb)](_0x459c44=!![]){const _0x4fc66f=a0_0x246150,_0xbb7433=this['config'][_0x4fc66f(0x22e)]||0x3c;this[_0x4fc66f(0x1bf)][_0x4fc66f(0x292)]>_0xbb7433&&this['dailyDigests'][_0x4fc66f(0x25e)](0x0,this[_0x4fc66f(0x1bf)][_0x4fc66f(0x292)]-_0xbb7433);await this[_0x4fc66f(0x2cf)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x4fc66f(0x2be)](this[_0x4fc66f(0x1bf)]),'ack':!![]});if(_0x459c44)await this[_0x4fc66f(0x1da)]();}async[a0_0x246150(0x254)](_0x2b0ec2){const _0x1545aa=a0_0x246150;this[_0x1545aa(0x225)][_0x1545aa(0x239)](_0x2b0ec2);if(this[_0x1545aa(0x225)][_0x1545aa(0x292)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x1545aa(0x225)][_0x1545aa(0x1d2)]();await this[_0x1545aa(0x2cf)](_0x1545aa(0x316),{'val':JSON[_0x1545aa(0x2be)](this[_0x1545aa(0x225)]),'ack':!![]});}async[a0_0x246150(0x1da)](){const _0x1042a0=a0_0x246150;if(!this[_0x1042a0(0x1d0)]){await this[_0x1042a0(0x2cf)](LTM_DP_BASELINE_STATUS,{'val':_0x1042a0(0x25c),'ack':!![]});return;}const _0x3f4bd0=this[_0x1042a0(0x1bf)]['length']>=(this[_0x1042a0(0x2c3)][_0x1042a0(0x2d8)]||0x7)?_0x1042a0(0x2fd)+this['dailyDigests']['length']+_0x1042a0(0x1d6):_0x1042a0(0x263)+this['dailyDigests']['length']+'/'+(this[_0x1042a0(0x2c3)][_0x1042a0(0x2d8)]||0x7)+')';await this[_0x1042a0(0x2cf)](LTM_DP_BASELINE_STATUS,{'val':_0x3f4bd0,'ack':!![]});}async['initSensorSubscriptions'](){const _0x6b8a2=a0_0x246150,_0x14fffc=this[_0x6b8a2(0x2c3)][_0x6b8a2(0x23c)];if(_0x14fffc&&_0x14fffc[_0x6b8a2(0x292)]>0x0){this['log']['info']('Subscribing\x20to\x20'+_0x14fffc[_0x6b8a2(0x292)]+'\x20sensors...');for(const _0x120e0d of _0x14fffc){if(_0x120e0d['id']){await this[_0x6b8a2(0x2a3)](_0x120e0d['id']);try{const _0xa7d189=await this[_0x6b8a2(0x2af)](_0x120e0d['id']);if(_0xa7d189)this['sensorLastValues'][_0x120e0d['id']]=_0xa7d189[_0x6b8a2(0x262)];}catch(_0x390f7b){}}}}}async[a0_0x246150(0x27e)](){const _0x4408fb=a0_0x246150,_0x220ab7=this[_0x4408fb(0x2c3)][_0x4408fb(0x205)]||[];if(_0x220ab7[_0x4408fb(0x292)]>0x0){this[_0x4408fb(0x1fd)][_0x4408fb(0x230)](_0x4408fb(0x1ea)+_0x220ab7['length']+'\x20presence\x20devices...');for(const _0x26c868 of _0x220ab7){await this[_0x4408fb(0x2a3)](_0x26c868);}try{await this[_0x4408fb(0x279)]();}catch(_0x59b176){}}}async[a0_0x246150(0x22a)](){const _0x59c9e1=a0_0x246150;try{if(!this[_0x59c9e1(0x2c3)]['useWeather'])return'Wetter:\x20Deaktiviert';let _0x41ee88='';const _0x501da5=this[_0x59c9e1(0x2c3)][_0x59c9e1(0x2a5)];if(_0x501da5)try{if(_0x501da5[_0x59c9e1(0x241)](_0x59c9e1(0x2c7))){const _0x4b6fb8=await this[_0x59c9e1(0x2af)](_0x501da5+_0x59c9e1(0x329));if(_0x4b6fb8&&_0x4b6fb8[_0x59c9e1(0x262)])_0x41ee88=_0x4b6fb8['val'];}else{if(_0x501da5['includes']('daswetter')){const _0x3f01af=await this['getForeignStateAsync'](_0x501da5+_0x59c9e1(0x307));if(_0x3f01af&&_0x3f01af[_0x59c9e1(0x262)])_0x41ee88=_0x3f01af[_0x59c9e1(0x262)];}else{if(_0x501da5[_0x59c9e1(0x241)](_0x59c9e1(0x2e3))){const _0x543d9a=await this[_0x59c9e1(0x2af)](_0x501da5+_0x59c9e1(0x1bd));if(_0x543d9a&&_0x543d9a['val'])_0x41ee88=_0x543d9a[_0x59c9e1(0x262)];}}}}catch(_0x427831){}if(!_0x41ee88){const _0x53ffb0=[_0x59c9e1(0x218),_0x59c9e1(0x32e),_0x59c9e1(0x24d),_0x59c9e1(0x29e)];for(const _0x2ae98b of _0x53ffb0){try{const _0x3be093=await this['getForeignObjectAsync'](_0x2ae98b);if(_0x3be093){if(_0x2ae98b['includes'](_0x59c9e1(0x2c7))){const _0x11cc8d=await this[_0x59c9e1(0x2af)](_0x2ae98b+'.Summary.Current');if(_0x11cc8d&&_0x11cc8d[_0x59c9e1(0x262)]){_0x41ee88=_0x11cc8d[_0x59c9e1(0x262)];break;}}}}catch(_0x49818e){}}}return _0x41ee88?_0x59c9e1(0x2b4)+_0x41ee88:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x24096d){return'WETTER\x20ERROR:\x20'+_0x24096d[_0x59c9e1(0x248)];}}async[a0_0x246150(0x275)](){const _0x4b7992=a0_0x246150;try{if(!this['config'][_0x4b7992(0x2e4)])return _0x4b7992(0x1fc);let _0x3fd9f4=this[_0x4b7992(0x2c3)][_0x4b7992(0x20e)]||_0x4b7992(0x1dd),_0x1a4850=this[_0x4b7992(0x2c3)][_0x4b7992(0x2bf)]||[];if(typeof _0x1a4850===_0x4b7992(0x24e))_0x1a4850=_0x1a4850[_0x4b7992(0x2ea)](',');try{const _0x24c977=await this['getForeignStateAsync'](_0x3fd9f4+_0x4b7992(0x2d0));if(_0x24c977&&_0x24c977[_0x4b7992(0x262)]){let _0x20d801=this[_0x4b7992(0x317)](_0x24c977[_0x4b7992(0x262)]);if(_0x20d801&&Array[_0x4b7992(0x284)](_0x20d801)){if(_0x1a4850[_0x4b7992(0x292)]>0x0)_0x20d801=_0x20d801[_0x4b7992(0x31c)](_0x38d426=>_0x1a4850[_0x4b7992(0x241)](_0x38d426['_calName']||''));else return _0x4b7992(0x26b);if(_0x20d801[_0x4b7992(0x292)]>0x0){const _0x2af8e0=_0x20d801[_0x4b7992(0x301)](0x0,0x3)['map'](_0x5aa90a=>{const _0x31d2b1=_0x4b7992;let _0x477eea=_0x5aa90a[_0x31d2b1(0x1cb)];if(_0x5aa90a[_0x31d2b1(0x220)])_0x477eea+='\x20'+_0x5aa90a['time'];return _0x477eea+':\x20'+_0x5aa90a[_0x31d2b1(0x1d9)]+'\x20('+_0x5aa90a[_0x31d2b1(0x23a)]+')';});return _0x4b7992(0x236)+_0x2af8e0['join'](_0x4b7992(0x1c1));}else return _0x4b7992(0x258);}}}catch(_0x26b65b){this[_0x4b7992(0x1fd)][_0x4b7992(0x1c2)](_0x4b7992(0x322)+_0x26b65b[_0x4b7992(0x248)]);}return _0x4b7992(0x300);}catch(_0x1f35ea){return _0x4b7992(0x2a4)+_0x1f35ea['message'];}}async[a0_0x246150(0x21e)](_0x383f59){const _0x362614=a0_0x246150;try{const _0x2dc0da=await this['getForeignStateAsync'](_0x383f59+_0x362614(0x2d0));if(_0x2dc0da&&_0x2dc0da[_0x362614(0x262)]){const _0x5af3cc=this[_0x362614(0x317)](_0x2dc0da['val']);if(_0x5af3cc&&Array[_0x362614(0x284)](_0x5af3cc)){const _0x137279=[...new Set(_0x5af3cc[_0x362614(0x246)](_0x339437=>_0x339437[_0x362614(0x23a)])[_0x362614(0x31c)](Boolean))];return _0x137279[_0x362614(0x1ce)]();}}return[];}catch(_0xd6c887){return this[_0x362614(0x1fd)][_0x362614(0x1d8)](_0x362614(0x1f1)+_0xd6c887['message']),[];}}async['checkWifiPresence'](){const _0x3d8e95=a0_0x246150;try{const _0x433ccf=this[_0x3d8e95(0x2c3)]['presenceDevices']||[];let _0x53cb22=![];for(const _0x3e9a10 of _0x433ccf){try{const _0x2ad2b5=await this[_0x3d8e95(0x2af)](_0x3e9a10);if(_0x2ad2b5&&(_0x2ad2b5[_0x3d8e95(0x262)]===!![]||_0x2ad2b5[_0x3d8e95(0x262)]===_0x3d8e95(0x1e4)||_0x2ad2b5[_0x3d8e95(0x262)]===0x1)){_0x53cb22=!![];break;}}catch(_0x4c37fd){}}return _0x53cb22&&(this[_0x3d8e95(0x28d)]&&(this['log']['info'](_0x3d8e95(0x2c0)),this[_0x3d8e95(0x250)]()),!this[_0x3d8e95(0x2ed)]&&this[_0x3d8e95(0x1c8)]===SYSTEM_MODES[_0x3d8e95(0x2d9)]&&await this[_0x3d8e95(0x28e)](!![])),_0x53cb22;}catch(_0x2f55e0){return this['log'][_0x3d8e95(0x1d8)](_0x3d8e95(0x27f)+_0x2f55e0[_0x3d8e95(0x248)]),![];}}[a0_0x246150(0x1e3)](){const _0xc013e8=a0_0x246150;this['abortExitTimer'](),this['isGracePeriodActive']=!![],this[_0xc013e8(0x1d5)]=setTimeout(()=>{const _0xdc1604=_0xc013e8;this[_0xdc1604(0x2e1)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0xc013e8(0x28d)]=setTimeout(()=>{const _0x2b2292=_0xc013e8;this[_0x2b2292(0x28e)](![]),this[_0x2b2292(0x28d)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x246150(0x250)](){const _0x2cc290=a0_0x246150;if(this['exitTimer'])clearTimeout(this[_0x2cc290(0x28d)]);if(this['exitGraceTimer'])clearTimeout(this[_0x2cc290(0x1d5)]);this[_0x2cc290(0x28d)]=null,this['exitGraceTimer']=null,this[_0x2cc290(0x2e1)]=![];}async[a0_0x246150(0x28e)](_0x36faa0){const _0x50a769=a0_0x246150;if(this[_0x50a769(0x2ed)]===_0x36faa0)return;this['isPresent']=_0x36faa0,await this['setStateAsync']('system.isPresent',{'val':_0x36faa0,'ack':!![]});}async['saveFeedback'](_0x7c1ffa){const _0x4ce959=a0_0x246150;this[_0x4ce959(0x1fd)][_0x4ce959(0x230)](_0x4ce959(0x209)+JSON[_0x4ce959(0x2be)](_0x7c1ffa));}async['runBaselineDriftAnalysis'](){const _0x28b286=a0_0x246150;if(!this[_0x28b286(0x1d0)]||!this[_0x28b286(0x1df)])return;const _0x5ed04f=this[_0x28b286(0x2c3)][_0x28b286(0x24a)]||0xe;if(this[_0x28b286(0x1bf)]['length']<_0x5ed04f+(this[_0x28b286(0x2c3)][_0x28b286(0x2d8)]||0x7)){await this[_0x28b286(0x2cf)](LTM_DP_DRIFT_STATUS,{'val':_0x28b286(0x2c8),'ack':!![]});return;}const _0x190ccc=this[_0x28b286(0x1bf)][_0x28b286(0x301)](-_0x5ed04f),_0x47e3ff=this[_0x28b286(0x1bf)][_0x28b286(0x301)](0x0,this[_0x28b286(0x1bf)][_0x28b286(0x292)]-_0x5ed04f),_0x4b5494=_0x28b286(0x2a8)+JSON[_0x28b286(0x2be)](_0x47e3ff)+_0x28b286(0x216)+JSON[_0x28b286(0x2be)](_0x190ccc);try{const _0x120850=await this[_0x28b286(0x1df)]['generateContent'](_0x4b5494),_0x3aa750=JSON[_0x28b286(0x2f5)](_0x120850['response']['text']()[_0x28b286(0x298)](/```json|```/g,'')[_0x28b286(0x237)]());_0x3aa750[_0x28b286(0x328)]&&(await this[_0x28b286(0x2cf)](LTM_DP_DRIFT_STATUS,{'val':_0x3aa750['baselineDrift'],'ack':!![]}),await this[_0x28b286(0x2cf)](LTM_DP_DRIFT_DETAILS,{'val':_0x3aa750[_0x28b286(0x28a)],'ack':!![]}),await this[_0x28b286(0x2cf)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x28b286(0x268)](),'ack':!![]}));}catch(_0x4c0112){}}[a0_0x246150(0x1d3)](){const _0x512485=a0_0x246150;try{if(this['ltmJob'])this[_0x512485(0x208)][_0x512485(0x321)]();if(!this[_0x512485(0x1d0)]){this[_0x512485(0x2cf)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this['ltmJob']=schedule[_0x512485(0x2ba)](LTM_SCHEDULE,()=>this[_0x512485(0x2e7)]());}catch(_0x1545d0){this[_0x512485(0x1fd)][_0x512485(0x1d8)](_0x512485(0x1bc)+_0x1545d0[_0x512485(0x248)]);}}[a0_0x246150(0x21d)](){const _0x175363=a0_0x246150;try{if(this[_0x175363(0x219)])this['modeResetJob'][_0x175363(0x321)]();this['modeResetJob']=schedule[_0x175363(0x2ba)](MODE_RESET_SCHEDULE,async()=>{const _0x20a3d3=_0x175363;await this[_0x20a3d3(0x2ab)](),AUTO_RESET_MODES[_0x20a3d3(0x241)](this[_0x20a3d3(0x1c8)])&&await this[_0x20a3d3(0x2cf)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x45e337){this[_0x175363(0x1fd)][_0x175363(0x1d8)]('Reset\x20Sched\x20Error:\x20'+_0x45e337[_0x175363(0x248)]);}}[a0_0x246150(0x2d4)](){const _0x24ebea=a0_0x246150;try{if(this[_0x24ebea(0x224)])clearInterval(this[_0x24ebea(0x224)]);if(!this[_0x24ebea(0x1d0)])return;this[_0x24ebea(0x224)]=setInterval(()=>this[_0x24ebea(0x2a1)](),(this['config']['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>this[_0x24ebea(0x2a1)](),0x1388);}catch(_0x4d74ac){this[_0x24ebea(0x1fd)]['error'](_0x24ebea(0x2cc)+_0x4d74ac[_0x24ebea(0x248)]);}}[a0_0x246150(0x26c)](){const _0x112c2e=a0_0x246150;try{if(this[_0x112c2e(0x1c5)])this[_0x112c2e(0x1c5)][_0x112c2e(0x321)]();if(!this['config']['briefingEnabled'])return;const _0x1b63b6=(this['config']['briefingTime']||_0x112c2e(0x267))[_0x112c2e(0x2ea)](':'),_0x14b3a0=parseInt(_0x1b63b6[0x0])||0x8,_0x14c02d=parseInt(_0x1b63b6[0x1])||0x0,_0x428bbc=_0x14c02d+'\x20'+_0x14b3a0+_0x112c2e(0x252);this[_0x112c2e(0x1fd)][_0x112c2e(0x230)](_0x112c2e(0x32f)+_0x14b3a0+':'+(_0x14c02d<0xa?'0'+_0x14c02d:_0x14c02d)),this[_0x112c2e(0x1c5)]=schedule[_0x112c2e(0x2ba)](_0x428bbc,()=>{const _0x6cf78c=_0x112c2e;this[_0x6cf78c(0x287)]();});}catch(_0x1cc1cf){this[_0x112c2e(0x1fd)][_0x112c2e(0x1d8)](_0x112c2e(0x2b1)+_0x1cc1cf[_0x112c2e(0x248)]);}}async[a0_0x246150(0x281)](_0x15b803,_0x59d7ba=![],_0x2a23bb=![]){const _0xa2e6d1=a0_0x246150;this[_0xa2e6d1(0x1fd)]['info']((_0x59d7ba?_0xa2e6d1(0x269):'')+_0xa2e6d1(0x2dc)+_0x15b803+'\x22');const _0x5dc407=this[_0xa2e6d1(0x2c3)];let _0x9b49c6=0x0;_0x5dc407['notifyTelegramEnabled']&&(await this[_0xa2e6d1(0x1ef)](_0x5dc407[_0xa2e6d1(0x30a)],_0xa2e6d1(0x201),{'text':_0x15b803,'user':_0x5dc407[_0xa2e6d1(0x2f7)]}),_0x9b49c6++);if(_0x5dc407['notifyPushoverEnabled']){let _0x45dfd4={'message':_0x15b803,'title':_0x2a23bb?'üö®\x20EMERGENCY':_0xa2e6d1(0x213),'priority':_0x2a23bb?0x2:0x1,'device':_0x5dc407['notifyPushoverRecipient']};_0x2a23bb&&(_0x45dfd4[_0xa2e6d1(0x291)]=0x1e,_0x45dfd4[_0xa2e6d1(0x20b)]=0xe10,_0x45dfd4[_0xa2e6d1(0x223)]=_0xa2e6d1(0x2f2)),await this[_0xa2e6d1(0x1ef)](_0x5dc407[_0xa2e6d1(0x2b6)],_0xa2e6d1(0x201),_0x45dfd4),_0x9b49c6++;}return _0x5dc407[_0xa2e6d1(0x2fc)]&&(await this['sendToAsync'](_0x5dc407[_0xa2e6d1(0x32c)],'send',{'text':_0x15b803,'to':_0x5dc407['notifyEmailRecipient']}),_0x9b49c6++),_0x9b49c6;}}if(require['main']!==module)module['exports']=_0x5e14f8=>new CogniLiving(_0x5e14f8);else new CogniLiving();