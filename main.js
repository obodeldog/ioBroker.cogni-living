function a0_0x3db3(_0xe899ec,_0x3918e0){const _0x582469=a0_0x38b8();return a0_0x3db3=function(_0x58499e,_0x22ed39){_0x58499e=_0x58499e-0x14b;let _0x38b8cf=_0x582469[_0x58499e];return _0x38b8cf;},a0_0x3db3(_0xe899ec,_0x3918e0);}const a0_0x29811d=a0_0x3db3;(function(_0x3128dc,_0x557171){const _0x38f324=a0_0x3db3,_0x152f32=_0x3128dc();while(!![]){try{const _0x429f29=-parseInt(_0x38f324(0x17d))/0x1*(-parseInt(_0x38f324(0x1ed))/0x2)+parseInt(_0x38f324(0x277))/0x3*(-parseInt(_0x38f324(0x2bd))/0x4)+-parseInt(_0x38f324(0x1c8))/0x5*(parseInt(_0x38f324(0x221))/0x6)+parseInt(_0x38f324(0x2a0))/0x7+parseInt(_0x38f324(0x242))/0x8+parseInt(_0x38f324(0x16a))/0x9*(-parseInt(_0x38f324(0x20f))/0xa)+-parseInt(_0x38f324(0x1e0))/0xb*(-parseInt(_0x38f324(0x18e))/0xc);if(_0x429f29===_0x557171)break;else _0x152f32['push'](_0x152f32['shift']());}catch(_0x319a4e){_0x152f32['push'](_0x152f32['shift']());}}}(a0_0x38b8,0x65d4a));const a0_0x22ed39=(function(){let _0x2d2647=!![];return function(_0x5aefdd,_0x51c0bd){const _0x2d3394=_0x2d2647?function(){if(_0x51c0bd){const _0x1b660a=_0x51c0bd['apply'](_0x5aefdd,arguments);return _0x51c0bd=null,_0x1b660a;}}:function(){};return _0x2d2647=![],_0x2d3394;};}()),a0_0x58499e=a0_0x22ed39(this,function(){const _0x50258d=a0_0x3db3;return a0_0x58499e[_0x50258d(0x1e6)]()[_0x50258d(0x278)](_0x50258d(0x27e))[_0x50258d(0x1e6)]()['constructor'](a0_0x58499e)[_0x50258d(0x278)](_0x50258d(0x27e));});function a0_0x38b8(){const _0x11f66d=['loadSystemMode','\x20hours.\x20Potential\x20incapacitation.','error','ðŸ“¡\x20Hooking\x20into\x20','analysisHistory','toLocaleString','setStateAsync','toFixed','events.lastEvent','briefingJob','material.','Alarm','time','Raw\x20Log','sound','openweathermap','eventHistory','analysis.isAlert','ltmStbWindowDays','dutycycle','native','sendMorningBriefing','analysis.automation.description','2-digit','\x20presence\x20devices...','weatherunderground.0','command','systemUUID','lastCheck','driftAnalysisTimer','Deaktiviert\x20(Pro-Feature)','notifyTelegramInstance','briefingEnabled','temperature','uuid-error','cogni-living\x20adapter\x20starting\x20(v','push','checkWifiPresence','find','3lbvUzb','search','message','inactivityThresholdHours','subscribeStates','cover','state','(((.+)+)+)+$','Nein','LTM','patternDetected','initSensorSubscriptions','N/A','party','object','notifyPushoverEnabled','Last\x20Check','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','val','unload','Sending\x20notification:\x20\x22','initHistory','analysis.analysisHistory','accuweather','response','includes','notifyEmailInstance','setupBriefingScheduler','analysis.triggerBriefing','fault','genAI','location','Aktiv\x20(','devices','info','\x20min).','KALENDER:\x20','sendToAsync','abortExitTimer','\x20*\x20*\x20*','notifyPushoverInstance','257047LuUANI','licenseKey','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','LTM.triggerDailyDigest','sensorLastValues','@iobroker/adapter-core','ðŸš¨ðŸš¨\x20NOTFALL','ltmJob','cogni-living','feedbackHistory','WETTER:\x20','checkLtmObjects','saveFeedback','energy','Drift\x20Analysis','splice','geminiModel','setupTelegramListener','briefingTime','bind','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','timestamp','modeResetJob','javascript.','onStateChange','value','Gemini\x20Init\x20Error:\x20','getCalendarContext','common','828692hbVAKY','System\x20Mode','stringify','[TEST]\x20','NORMAL','KALENDER:\x20Keine\x20Daten','update','Processing\x20Status','system.isPresent','map','LTM.rawEventLog','checkLtmDriftObjects','callback','getOverviewData','length','getStateAsync','sendNotification','setHours','system','rawEventLog','version','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','livingContext','geminiApiKey','calendarSelection','setState','brightness','pop','lastAlertState','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','.\x20PERSONA:\x20','admin.','.data.table','testApiKey','config_pending','endsWith','city','parse','boolean','387rQMJAV','exitTimer','ack','Pro\x20Feature','config','namespace','Drift\x20Sched\x20Error:\x20','Drift\x20Status','\x20sensors...','.Summary.Current','lowbat','analysis.alertReason','scheduleJob','automationProposal','communicate.request','join','Error\x20reading\x20calendar\x20table:\x20','Trigger\x20Digest','link_quality','113zjFKxY','checkLicense','WETTER\x20ERROR:\x20','notifyEmailEnabled','\x0a\x20\x20\x20\x20\x20\x20\x20\x20CRITICAL\x20SAFETY\x20CHECK:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20Sofort/Ad-Hoc:\x20Ist\x20es\x20jetzt\x20(','scriptProblem','Analysis\x20Error:\x20','Starting\x20Autopilot\x20(','\x20Phase\x203:\x20DRIFT\x20ACTIVE.\x20Compare\x20recent\x20events\x20against\x20long-term\x20patterns.','type','isEmergency','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','warn','useCalendar','runGeminiAnalysis','activity','TEST-PRO-KEY','10743528QbAQNC','âš ï¸\x20Alarm','occupancy','isPresent','updateBaselineStatus','runAutopilot','generic','Phase\x202:\x20ACUTE\x20MONITORING.\x20STB\x20(Last\x2014d):\x20','string','events.history','runBaselineDriftAnalysis','testNotification','history.','analysis.trigger','Daily\x20Digests','onUnload','loadRawEventLog','filter','targetposition','setpoint','models/gemini-flash-latest','loadDailyDigests','values','processSensorEvent','description','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','simple-api.','VACATION','isAlert','triggerBriefing','exitGraceTimer','systemConfig','initZombies','working','PRO-','baselineDrift','set_temperature','.\x20MODUS:\x20','onReady','channel','log','dailyDigests','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','subscribeForeignStatesAsync','power','alertReason','send','.communicate.request','onMessage','getWeatherContext','catch','vis.','\x0aSTB:\x20','unknown','minDaysForBaseline','date','extendObjectAsync','createDailyDigest','313980YfmSUc','LTM.driftAnalysis.driftDetails','comfort','startExitTimer','ical.0','08:00','getGenerativeModel','.\x20PRÃ„SENZ:\x20','vacation','reachable','LTM.driftAnalysis.baselineDrift','inactivityMonitoringEnabled','system.meta.uuid','Adapter','Subscribing\x20to\x20','useWeather','PARTY','de-DE','Reset\x20Sched\x20Error:\x20','currentposition','Gemini\x20AI\x20initialized.','isProVersion','long','getEnums','11CjmZZp','firmware','cancel','triggerDailyDigest','uuid-not-found','from','toString','node-schedule','position','LTM.driftAnalysis','valve','currentSystemMode','_calName','2012RORuGl','KALENDER\x20ERROR:\x20','\x20for\x20interactive\x20buttons...','analysisInterval','getForeignStateAsync','ready','generateContent','KI-Modell\x20nicht\x20initialisiert\x20(Neustart\x20erforderlich?)','presence','setPresence','json','setupModeResetScheduler','isExit','slice','telegram','aiPersona','motion','No\x20recorded\x20events\x20yet.','PRIORITÃ„T:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungewÃ¶hnliche\x20Anwesenheit.','event','name','getForeignObjectAsync','startsWith','Drift\x20Details','latitude','presenceDevices','Triggered\x20analysis\x20but\x20Gemini\x20AI\x20is\x20not\x20initialized!\x20Check\x20API\x20Key.','uuid','LTM.processingStatus','detected','number','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','saveDailyDigests','driftDetails','186950pabPgS','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','System\x20Status\x20&\x20Control','WETTER:\x20Keine\x20Daten\x20gefunden','0\x204\x20*\x20*\x20*','analysisTimer','COGNI_REQUEST_CALL','getLtmData','saveRawEventLog','analysis.automation.patternDetected','Party','level',')\x20-\x20PHASE\x202b:\x20INTERACTIVE','GUEST','text','LTM.driftAnalysis.lastCheck','unshift','Lernphase\x20(','36BNgPqc','sendTo','system.mode','PRIORITÃ„T:\x20Gesundheit\x20und\x20Sicherheit\x20fÃ¼r\x20Senioren\x20(AAL).\x20Erkenne\x20InaktivitÃ¤t,\x20potenzielle\x20StÃ¼rze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20nÃ¤chtliche\x20Unruhe.','updateAnalysisHistory','split','now','echarts.','openweathermap.0','notifyTelegramRecipient','connection','indexOf','Kalender:\x20Deaktiviert','initSystemConfig','weatherInstance','tryParse','isGracePeriodActive','Baseline\x20Status','unreach','handleTelegramResponse','scanForDevices','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','setupDriftAnalysisScheduler','daswetter','ltmLtbWindowDays','trim','\x20Tage)','main','Urlaub','checkSystemObjects','Keine\x20neuen\x20Automatisierungs-Muster\x20erkannt.','Error\x20checking\x20WiFi:\x20','LTM\x20Sched\x20Error:\x20','6073912OPRMOG','online','notifyEmailRecipient','flot.','Scheduling\x20Morning\x20Briefing\x20for\x20','getSystemUUID','notifyTelegramEnabled','isArray','summary','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','stick_unreach','analysis.lastResult','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','status'];a0_0x38b8=function(){return _0x11f66d;};return a0_0x38b8();}a0_0x58499e();'use strict';const utils=require(a0_0x29811d(0x2a5)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x29811d(0x1e7)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x29811d(0x1a2),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x29811d(0x213),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x29811d(0x14d),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x29811d(0x209),LTM_DP_TRIGGER_DIGEST=a0_0x29811d(0x2a3),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x29811d(0x1e9),LTM_DP_DRIFT_STATUS=a0_0x29811d(0x1d2),LTM_DP_DRIFT_DETAILS=a0_0x29811d(0x1c9),LTM_DP_DRIFT_LAST_CHECK=a0_0x29811d(0x21e),SYSTEM_DP_MODE=a0_0x29811d(0x223),HARD_IGNORE_TERMS=[a0_0x29811d(0x182),'scriptEnabled',a0_0x29811d(0x2c3),a0_0x29811d(0x233),a0_0x29811d(0x174),'rssi',a0_0x29811d(0x22b),'maintenance','error',a0_0x29811d(0x294),a0_0x29811d(0x1af),'direction',a0_0x29811d(0x24c),a0_0x29811d(0x165),a0_0x29811d(0x263),a0_0x29811d(0x1e1),a0_0x29811d(0x1d1),a0_0x29811d(0x17c)],GENERIC_NAMES=[a0_0x29811d(0x1a0),a0_0x29811d(0x1db),a0_0x29811d(0x27d),a0_0x29811d(0x21a),a0_0x29811d(0x2b9),a0_0x29811d(0x15d),'on','off','switch',a0_0x29811d(0x1e8),'shutter','blind',a0_0x29811d(0x27c),a0_0x29811d(0x24f),a0_0x29811d(0x1fd),a0_0x29811d(0x1f5),a0_0x29811d(0x190),a0_0x29811d(0x271),'humidity',a0_0x29811d(0x1ba),a0_0x29811d(0x2ad),a0_0x29811d(0x1a1),a0_0x29811d(0x1ea),'actual_temperature',a0_0x29811d(0x1b2)],ADAPTER_BLACKLIST=['system.',a0_0x29811d(0x162),'info.',a0_0x29811d(0x1c1),a0_0x29811d(0x19a),a0_0x29811d(0x25a),'icons-mfd.',a0_0x29811d(0x245),a0_0x29811d(0x228),a0_0x29811d(0x2b7),a0_0x29811d(0x1a8)],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x29811d(0x1d0),'PARTY':a0_0x29811d(0x284),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x29811d(0x1d8)],SYSTEM_MODES[a0_0x29811d(0x21c)]],PERSONA_MAPPING={'generic':a0_0x29811d(0x24b),'senior_aal':a0_0x29811d(0x224),'family':a0_0x29811d(0x2b4),'single_comfort':a0_0x29811d(0x160),'security':a0_0x29811d(0x1ff)};class CogniLiving extends utils[a0_0x29811d(0x1d5)]{constructor(_0x407b61){const _0x5c6986=a0_0x29811d;super({..._0x407b61,'name':_0x5c6986(0x2a8)}),this['eventHistory']=[],this['analysisHistory']=[],this[_0x5c6986(0x2a9)]=[],this[_0x5c6986(0x156)]=[],this['dailyDigests']=[],this['sensorLastValues']={},this[_0x5c6986(0x1ad)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x5c6986(0x16b)]=null,this[_0x5c6986(0x1ac)]=null,this[_0x5c6986(0x231)]=![],this[_0x5c6986(0x295)]=null,this[_0x5c6986(0x2b0)]=null,this[_0x5c6986(0x1eb)]=SYSTEM_MODES[_0x5c6986(0x2c1)],this[_0x5c6986(0x1dd)]=![],this['lastAlertState']=![],this[_0x5c6986(0x26b)]=_0x5c6986(0x1c3),this[_0x5c6986(0x214)]=null,this[_0x5c6986(0x2a7)]=null,this[_0x5c6986(0x2b6)]=null,this[_0x5c6986(0x26d)]=null,this[_0x5c6986(0x259)]=null,this['on'](_0x5c6986(0x1f2),this[_0x5c6986(0x1b4)]['bind'](this)),this['on']('stateChange',this[_0x5c6986(0x2b8)][_0x5c6986(0x2b3)](this)),this['on'](_0x5c6986(0x28a),this[_0x5c6986(0x19d)][_0x5c6986(0x2b3)](this)),this['on'](_0x5c6986(0x279),this[_0x5c6986(0x1be)][_0x5c6986(0x2b3)](this));}async['onReady'](){const _0x2225e2=a0_0x29811d;this[_0x2225e2(0x1b6)][_0x2225e2(0x299)](_0x2225e2(0x273)+this[_0x2225e2(0x157)]+_0x2225e2(0x21b)),await this[_0x2225e2(0x1ae)](),this['config'][_0x2225e2(0x2a1)]=this['config']['licenseKey']||'';try{this[_0x2225e2(0x1dd)]=await this[_0x2225e2(0x17e)](this[_0x2225e2(0x16e)][_0x2225e2(0x2a1)]);}catch(_0x21a219){}if(!this['config'][_0x2225e2(0x27a)]||this['config'][_0x2225e2(0x27a)]<0.1)this['config']['inactivityThresholdHours']=0xc;await this['initHistory'](),await this[_0x2225e2(0x22e)]();if(this['config']['geminiApiKey'])try{this[_0x2225e2(0x295)]=new GoogleGenerativeAI(this['config'][_0x2225e2(0x15a)]),this[_0x2225e2(0x2b0)]=this[_0x2225e2(0x295)][_0x2225e2(0x1ce)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this['log'][_0x2225e2(0x299)](_0x2225e2(0x1dc));}catch(_0x1f8b3b){this['log'][_0x2225e2(0x252)](_0x2225e2(0x2ba)+_0x1f8b3b[_0x2225e2(0x279)]);}await this['createAllObjects'](),await this[_0x2225e2(0x250)](),await this['loadRawEventLog'](),await this[_0x2225e2(0x1a3)](),this[_0x2225e2(0x27b)](_0x2225e2(0x19b)),this[_0x2225e2(0x27b)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates']('system.mode'),this[_0x2225e2(0x27b)](_0x2225e2(0x293)),this[_0x2225e2(0x27b)]('analysis.isAlert'),await this['initSensorSubscriptions'](),await this['initPresenceSubscriptions'](),await this[_0x2225e2(0x2b1)]();if(this[_0x2225e2(0x214)])clearInterval(this['analysisTimer']);const _0x56bc29=this[_0x2225e2(0x16e)][_0x2225e2(0x1f0)]||0xf;_0x56bc29>0x0&&(this[_0x2225e2(0x1b6)]['info'](_0x2225e2(0x184)+_0x56bc29+_0x2225e2(0x29a)),this[_0x2225e2(0x214)]=setInterval(()=>{const _0x162d43=_0x2225e2;this[_0x162d43(0x193)]();},_0x56bc29*0x3c*0x3e8)),this['setupLtmScheduler'](),this[_0x2225e2(0x1f8)](),this[_0x2225e2(0x237)](),this['setupBriefingScheduler']();}[a0_0x29811d(0x19d)](_0x3d2ad8){const _0x5670cd=a0_0x29811d;if(this[_0x5670cd(0x214)])clearInterval(this[_0x5670cd(0x214)]);if(this[_0x5670cd(0x26d)])clearInterval(this[_0x5670cd(0x26d)]);if(this[_0x5670cd(0x2a7)])this[_0x5670cd(0x2a7)][_0x5670cd(0x1e2)]();if(this['modeResetJob'])this[_0x5670cd(0x2b6)][_0x5670cd(0x1e2)]();if(this[_0x5670cd(0x259)])this[_0x5670cd(0x259)]['cancel']();if(this[_0x5670cd(0x16b)])clearTimeout(this[_0x5670cd(0x16b)]);if(this[_0x5670cd(0x1ac)])clearTimeout(this['exitGraceTimer']);_0x3d2ad8();}async['onStateChange'](_0x25e9d4,_0xbb9718){const _0x514fc8=a0_0x29811d;if(!_0xbb9718)return;if(_0x25e9d4[_0x514fc8(0x290)](_0x514fc8(0x1fb))&&_0x25e9d4[_0x514fc8(0x166)](_0x514fc8(0x178))&&_0xbb9718[_0x514fc8(0x289)]){await this[_0x514fc8(0x234)](_0xbb9718[_0x514fc8(0x289)]);return;}if(_0x25e9d4===this[_0x514fc8(0x16f)]+'.'+SYSTEM_DP_MODE){_0xbb9718['val']&&Object['values'](SYSTEM_MODES)[_0x514fc8(0x290)](_0xbb9718[_0x514fc8(0x289)])&&(this[_0x514fc8(0x1eb)]=_0xbb9718['val'],_0xbb9718[_0x514fc8(0x289)]===SYSTEM_MODES[_0x514fc8(0x1a9)]?await this[_0x514fc8(0x1f6)](![]):await this[_0x514fc8(0x1f6)](!![]));if(!_0xbb9718[_0x514fc8(0x16c)])this[_0x514fc8(0x15c)](_0x25e9d4,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0xbb9718[_0x514fc8(0x16c)]){_0x25e9d4[_0x514fc8(0x290)](_0x514fc8(0x19b))&&_0xbb9718[_0x514fc8(0x289)]&&(this[_0x514fc8(0x15c)](_0x25e9d4,{'val':![],'ack':!![]}),this[_0x514fc8(0x18b)]());if(_0x25e9d4[_0x514fc8(0x290)](_0x514fc8(0x1e3))&&_0xbb9718['val']){this[_0x514fc8(0x15c)](_0x25e9d4,{'val':![],'ack':!![]});if(this['isProVersion'])this[_0x514fc8(0x1c7)]();}_0x25e9d4[_0x514fc8(0x290)](_0x514fc8(0x1ab))&&_0xbb9718[_0x514fc8(0x289)]&&(this[_0x514fc8(0x15c)](_0x25e9d4,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this[_0x514fc8(0x16e)][_0x514fc8(0x206)]&&this[_0x514fc8(0x16e)][_0x514fc8(0x206)][_0x514fc8(0x290)](_0x25e9d4)){await this[_0x514fc8(0x275)]();return;}const _0x336d8d=(this[_0x514fc8(0x16e)]['devices']||[])[_0x514fc8(0x276)](_0x303074=>_0x303074['id']===_0x25e9d4);if(_0x336d8d)this[_0x514fc8(0x1a5)](_0x25e9d4,_0xbb9718,_0x336d8d);}async[a0_0x29811d(0x2b1)](){const _0x1c80d1=a0_0x29811d,_0x133395=this[_0x1c80d1(0x16e)][_0x1c80d1(0x26f)];this[_0x1c80d1(0x16e)]['notifyTelegramEnabled']&&_0x133395&&(this[_0x1c80d1(0x1b6)][_0x1c80d1(0x299)](_0x1c80d1(0x253)+_0x133395+_0x1c80d1(0x1ef)),await this['subscribeForeignStatesAsync'](_0x133395+_0x1c80d1(0x1bd)));}async[a0_0x29811d(0x234)](_0x4d3902){const _0x47ae3f=a0_0x29811d;let _0x5bf934=_0x4d3902;_0x4d3902[_0x47ae3f(0x203)]('[')&&(_0x5bf934=_0x4d3902['substring'](_0x4d3902[_0x47ae3f(0x22c)](']')+0x1));if(_0x5bf934==='COGNI_CONFIRM_OK')this[_0x47ae3f(0x1b6)][_0x47ae3f(0x299)]('âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.'),await this[_0x47ae3f(0x256)]('analysis.isAlert',{'val':![],'ack':!![]}),await this[_0x47ae3f(0x256)]('analysis.alertReason',{'val':'Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ack':!![]}),this['lastAlertState']=![],this[_0x47ae3f(0x153)](_0x47ae3f(0x20c),![]);else _0x5bf934===_0x47ae3f(0x215)&&(this['log'][_0x47ae3f(0x189)](_0x47ae3f(0x2a2)),this[_0x47ae3f(0x153)]('ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]));}async[a0_0x29811d(0x1be)](_0x1967e6){const _0x212695=a0_0x29811d;if(typeof _0x1967e6===_0x212695(0x285)&&_0x1967e6[_0x212695(0x279)])try{if(_0x1967e6[_0x212695(0x26a)]===_0x212695(0x164)){}else{if(_0x1967e6['command']===_0x212695(0x199)){const _0x32f0f=await this[_0x212695(0x153)]('[Test]\x20Interaktiver\x20Alarm',!![],!![]);this[_0x212695(0x222)](_0x1967e6[_0x212695(0x1e5)],_0x1967e6[_0x212695(0x26a)],{'success':_0x32f0f>0x0,'message':_0x32f0f+'\x20sent'},_0x1967e6[_0x212695(0x14f)]);}else{if(_0x1967e6[_0x212695(0x26a)]===_0x212695(0x216)){if(!this[_0x212695(0x1dd)])return this[_0x212695(0x222)](_0x1967e6[_0x212695(0x1e5)],_0x1967e6[_0x212695(0x26a)],{'success':![],'isPro':![]},_0x1967e6[_0x212695(0x14f)]);let _0x5f16a4={'status':_0x212695(0x283),'details':'','lastCheck':0x0};try{_0x5f16a4[_0x212695(0x24f)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x212695(0x289)],_0x5f16a4['details']=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x212695(0x289)],_0x5f16a4[_0x212695(0x26c)]=(await this[_0x212695(0x152)](LTM_DP_DRIFT_LAST_CHECK))[_0x212695(0x289)];}catch(_0x468011){}const _0x1d1429=this['analysisHistory']||[];this[_0x212695(0x222)](_0x1967e6['from'],_0x1967e6['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x212695(0x1b7)],'driftAnalysis':_0x5f16a4,'analysisHistory':_0x1d1429},_0x1967e6[_0x212695(0x14f)]);}else{if(_0x1967e6['command']===_0x212695(0x150)){const _0x343ce4=this[_0x212695(0x1b7)][_0x212695(0x151)],_0x7d1d1d=this[_0x212695(0x260)][_0x212695(0x19f)](_0x13144b=>_0x13144b[_0x212695(0x2b5)]>new Date()[_0x212695(0x154)](0x0,0x0,0x0,0x0))[_0x212695(0x151)];let _0x4b9702={'status':_0x212695(0x283)};try{_0x4b9702[_0x212695(0x24f)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x212695(0x289)];}catch(_0x4fb4aa){}let _0x1fccf1=null;!this[_0x212695(0x2b0)]&&(_0x1fccf1=this[_0x212695(0x16e)][_0x212695(0x15a)]?_0x212695(0x1f4):'Kein\x20API\x20Key\x20konfiguriert!');let _0x50b60e={'detected':![],'description':''};try{const _0x2ebe2f=await this[_0x212695(0x152)](_0x212695(0x218)),_0x38dbb2=await this['getStateAsync']('analysis.automation.description');_0x2ebe2f&&_0x2ebe2f[_0x212695(0x289)]&&(_0x50b60e[_0x212695(0x20a)]=!![],_0x50b60e[_0x212695(0x1a6)]=_0x38dbb2?_0x38dbb2['val']:'');}catch(_0x31de72){}this[_0x212695(0x222)](_0x1967e6['from'],_0x1967e6[_0x212695(0x26a)],{'success':!![],'eventHistory':this[_0x212695(0x260)]['slice'](0x0,0xf),'stats':{'digestCount':_0x343ce4,'eventCountToday':_0x7d1d1d,'driftStatus':_0x4b9702[_0x212695(0x24f)],'isPresent':this['isPresent'],'minDays':this[_0x212695(0x16e)][_0x212695(0x1c4)]||0x7,'stbDays':this[_0x212695(0x16e)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x212695(0x16e)][_0x212695(0x239)]||0x3c,'systemError':_0x1fccf1},'automation':_0x50b60e},_0x1967e6[_0x212695(0x14f)]);}else{if(_0x1967e6[_0x212695(0x26a)]===_0x212695(0x1df)){}else{if(_0x1967e6[_0x212695(0x26a)]==='scanDevices')try{const _0x12b086=await this[_0x212695(0x235)](_0x1967e6[_0x212695(0x279)]||{});this[_0x212695(0x222)](_0x1967e6[_0x212695(0x1e5)],_0x1967e6['command'],{'success':!![],'devices':_0x12b086},_0x1967e6[_0x212695(0x14f)]);}catch(_0x564ac8){this[_0x212695(0x222)](_0x1967e6['from'],_0x1967e6[_0x212695(0x26a)],{'success':![],'error':_0x564ac8[_0x212695(0x279)]},_0x1967e6['callback']);}}}}}}}catch(_0x102aa9){}}async[a0_0x29811d(0x1a5)](_0x186c06,_0x3c1d82,_0x278c84){const _0xe59158=a0_0x29811d;if(!_0x278c84['logDuplicates']&&this[_0xe59158(0x2a4)][_0x186c06]===_0x3c1d82[_0xe59158(0x289)])return;this[_0xe59158(0x2a4)][_0x186c06]=_0x3c1d82['val'];if(this[_0xe59158(0x231)])return;const _0x580717=await this[_0xe59158(0x275)]();if(_0x580717){if(!this[_0xe59158(0x191)])await this['setPresence'](!![]);}else{const _0x53e822=_0x278c84[_0xe59158(0x1f9)]===!![];if(_0x53e822)this[_0xe59158(0x1cb)]();else{if(this[_0xe59158(0x16b)])this[_0xe59158(0x29d)]();if(!this[_0xe59158(0x191)]&&this['currentSystemMode']===SYSTEM_MODES[_0xe59158(0x2c1)])await this[_0xe59158(0x1f6)](!![]);}}const _0x2d8d2e={'timestamp':_0x3c1d82['ts'],'id':_0x186c06,'name':_0x278c84[_0xe59158(0x201)],'value':_0x3c1d82[_0xe59158(0x289)],'location':_0x278c84[_0xe59158(0x296)],'type':_0x278c84[_0xe59158(0x186)]};this['eventHistory'][_0xe59158(0x21f)](_0x2d8d2e);if(this[_0xe59158(0x260)][_0xe59158(0x151)]>HISTORY_MAX_SIZE)this[_0xe59158(0x260)]['pop']();await this['setStateAsync'](_0xe59158(0x258),{'val':JSON[_0xe59158(0x2bf)](_0x2d8d2e),'ack':!![]}),await this[_0xe59158(0x256)]('events.history',{'val':JSON[_0xe59158(0x2bf)](this[_0xe59158(0x260)]),'ack':!![]}),this[_0xe59158(0x156)][_0xe59158(0x274)]({'timestamp':new Date(_0x3c1d82['ts'])['toISOString'](),'sensorName':_0x278c84[_0xe59158(0x201)],'location':_0x278c84['location'],'value':_0x3c1d82[_0xe59158(0x289)]}),await this[_0xe59158(0x217)]();}async[a0_0x29811d(0x18b)](_0x38ac6b=''){const _0x137203=a0_0x29811d;if(!this['geminiModel']){this[_0x137203(0x1b6)]['warn'](_0x137203(0x207));return;}const _0x3d49a9=this[_0x137203(0x260)][_0x137203(0x151)]>0x0?this[_0x137203(0x260)]:[{'note':_0x137203(0x1fe)}],_0x4c54e6=PERSONA_MAPPING[this[_0x137203(0x16e)][_0x137203(0x1fc)]||_0x137203(0x194)],_0x9b85fa=this[_0x137203(0x16e)][_0x137203(0x159)]||'',_0x4e8fad=this[_0x137203(0x1eb)],_0x535408=await this['getWeatherContext'](),_0x3705b1=await this[_0x137203(0x2bb)](),_0x2bc8e7=(_0x535408+'\x20'+_0x3705b1)[_0x137203(0x23a)](),_0xe84633=new Date(),_0x511e83=_0xe84633[_0x137203(0x255)](_0x137203(0x1d9),{'weekday':_0x137203(0x1de),'hour':_0x137203(0x267),'minute':_0x137203(0x267)});let _0x4fdb67='Phase\x201:\x20Learning\x20(No\x20Baseline).\x20Rely\x20on\x20common\x20sense.';const _0x13a9a9=this[_0x137203(0x1b7)][_0x137203(0x151)];if(this['isProVersion']&&_0x13a9a9>=(this['config'][_0x137203(0x1c4)]||0x7)){const _0x3364f5=this[_0x137203(0x1b7)][_0x137203(0x1fa)](-(this[_0x137203(0x16e)]['ltmStbWindowDays']||0xe));_0x4fdb67=_0x137203(0x195)+JSON[_0x137203(0x2bf)](_0x3364f5)+'.';if(_0x13a9a9>=0x1e)_0x4fdb67+=_0x137203(0x185);}const _0x24fa02=_0x137203(0x181)+_0x511e83+')\x20verdÃ¤chtig\x20still?\x20Erwartest\x20du\x20basierend\x20auf\x20der\x20Tageszeit\x20AktivitÃ¤t\x20(z.B.\x20Morgens\x20Aufstehen)?\x20Wenn\x20ja\x20->\x20ALARM.\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20Akut\x20(vs.\x20STB):\x20Weicht\x20das\x20heutige\x20Verhalten\x20stark\x20von\x20den\x20letzten\x2014\x20Tagen\x20ab?\x20(z.B.\x205x\x20Toilette\x20statt\x203x).\x20Wenn\x20ja\x20->\x20WARNUNG.\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20Schleichend\x20(Drift):\x20(Nur\x20relevant\x20wenn\x20Phase\x203\x20aktiv)\x20Gibt\x20es\x20einen\x20langsamen\x20Trend\x20ins\x20Negative?\x0a\x20\x20\x20\x20\x20\x20\x20\x20Ignoriere\x20Fehlalarme\x20durch\x20Kontext:\x20'+_0x2bc8e7+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x35d20f=_0x137203(0x1a7)+_0x511e83+_0x137203(0x1b3)+_0x4e8fad+_0x137203(0x1cf)+(this['isPresent']?'Ja':_0x137203(0x27f))+_0x137203(0x210)+_0x9b85fa+_0x137203(0x161)+_0x4c54e6+_0x137203(0x158)+_0x4fdb67+'\x20'+(_0x38ac6b?_0x38ac6b:'')+_0x137203(0x288)+_0x24fa02+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20'+JSON[_0x137203(0x2bf)](_0x3d49a9)+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20}';try{const _0x2c64d2=await this[_0x137203(0x2b0)][_0x137203(0x1f3)](_0x35d20f),_0x13b06d=_0x2c64d2[_0x137203(0x28f)][_0x137203(0x21d)]()['replace'](/```json|```/g,'')['trim'](),_0x56ef96=JSON['parse'](_0x13b06d);await this[_0x137203(0x256)](_0x137203(0x24d),{'val':_0x13b06d,'ack':!![]}),await this['setStateAsync'](_0x137203(0x175),{'val':_0x56ef96[_0x137203(0x18c)][_0x137203(0x1bb)]||'','ack':!![]}),await this['setStateAsync']('analysis.activitySummary',{'val':_0x56ef96[_0x137203(0x18c)][_0x137203(0x24a)]||_0x137203(0x283),'ack':!![]});const _0x5a1efb=_0x56ef96[_0x137203(0x1ca)][_0x137203(0x177)],_0x3b979c=this[_0x137203(0x1dd)]?_0x5a1efb[_0x137203(0x281)]:![];await this[_0x137203(0x256)](_0x137203(0x218),{'val':_0x3b979c,'ack':!![]});let _0x3d5446=_0x137203(0x16d);if(this[_0x137203(0x1dd)])_0x3d5446=_0x3b979c?_0x5a1efb[_0x137203(0x1a6)]:_0x137203(0x23f);await this[_0x137203(0x256)](_0x137203(0x266),{'val':_0x3d5446,'ack':!![]});if(_0x56ef96['activity'][_0x137203(0x1aa)]||_0x56ef96['activity']['isEmergency']){await this[_0x137203(0x256)](_0x137203(0x261),{'val':!![],'ack':!![]});if(!this[_0x137203(0x15f)]||_0x56ef96['activity'][_0x137203(0x187)]){const _0x11eba8=_0x56ef96[_0x137203(0x18c)]['isEmergency']?_0x137203(0x2a6):_0x137203(0x18f);this['sendNotification'](_0x11eba8+':\x20'+_0x56ef96['activity']['alertReason'],![],_0x56ef96[_0x137203(0x18c)][_0x137203(0x187)]);}}else await this[_0x137203(0x256)](_0x137203(0x261),{'val':![],'ack':!![]});this['lastAlertState']=_0x56ef96[_0x137203(0x18c)][_0x137203(0x1aa)]||_0x56ef96[_0x137203(0x18c)]['isEmergency'];const _0x174cc8={'timestamp':Date[_0x137203(0x227)](),'id':Date[_0x137203(0x227)]()[_0x137203(0x1e6)](),'analysis':_0x56ef96,'systemMode':_0x4e8fad,'isPro':this[_0x137203(0x1dd)]};this['updateAnalysisHistory'](_0x174cc8);}catch(_0x1b9103){this[_0x137203(0x1b6)][_0x137203(0x252)](_0x137203(0x183)+_0x1b9103[_0x137203(0x279)]);}}async[a0_0x29811d(0x193)](){const _0x21575a=a0_0x29811d,_0x5e172b=this['config']['inactivityThresholdHours'],_0x1607fd=this[_0x21575a(0x260)][_0x21575a(0x151)]>0x0?this['eventHistory'][0x0][_0x21575a(0x2b5)]:Date[_0x21575a(0x227)](),_0x219e9e=(Date[_0x21575a(0x227)]()-_0x1607fd)/(0x3e8*0x3c*0x3c);let _0x2b2ce5='';this['config'][_0x21575a(0x1d3)]&&this['currentSystemMode']===SYSTEM_MODES[_0x21575a(0x2c1)]&&this['isPresent']&&(_0x219e9e>_0x5e172b&&(_0x2b2ce5=_0x21575a(0x236)+_0x219e9e[_0x21575a(0x257)](0x1)+_0x21575a(0x251))),this['runGeminiAnalysis'](_0x2b2ce5)[_0x21575a(0x1c0)](_0x2329bd=>this['log'][_0x21575a(0x252)](_0x2329bd));}async['createDailyDigest'](){}async[a0_0x29811d(0x265)](){}async[a0_0x29811d(0x235)](_0x3561f2){return[];}[a0_0x29811d(0x230)](_0xa1316a){const _0x510ca7=a0_0x29811d;if(typeof _0xa1316a==='object')return _0xa1316a;try{return JSON[_0x510ca7(0x168)](_0xa1316a);}catch(_0x5d36aa){return null;}}async[a0_0x29811d(0x1ae)](){}async[a0_0x29811d(0x28c)](){const _0x35f5cb=a0_0x29811d;try{const _0x128ccf=await this[_0x35f5cb(0x152)](_0x35f5cb(0x197));_0x128ccf&&_0x128ccf[_0x35f5cb(0x289)]&&(this[_0x35f5cb(0x260)]=JSON[_0x35f5cb(0x168)](_0x128ccf['val']['toString']()));}catch(_0x472ecc){this[_0x35f5cb(0x260)]=[];}try{const _0x321841=await this[_0x35f5cb(0x152)](_0x35f5cb(0x28d));if(_0x321841&&_0x321841[_0x35f5cb(0x289)])this[_0x35f5cb(0x254)]=JSON[_0x35f5cb(0x168)](_0x321841[_0x35f5cb(0x289)]['toString']());}catch(_0x4f8549){this[_0x35f5cb(0x254)]=[];}}async[a0_0x29811d(0x22e)](){const _0x1953cd=a0_0x29811d;try{const _0x5c37d3=await this[_0x1953cd(0x202)]('system.config');_0x5c37d3&&_0x5c37d3['common']&&(this['systemConfig']={'latitude':_0x5c37d3['common'][_0x1953cd(0x205)]||0x0,'longitude':_0x5c37d3['common']['longitude']||0x0,'city':_0x5c37d3[_0x1953cd(0x2bc)][_0x1953cd(0x167)]||''});}catch(_0x413ffd){}}async[a0_0x29811d(0x17e)](_0x51e887){const _0x114d76=a0_0x29811d;if(!_0x51e887)return![];this['systemUUID']=await this[_0x114d76(0x247)]();if(_0x51e887===_0x114d76(0x18d)||_0x51e887[_0x114d76(0x203)](_0x114d76(0x1b0)))return!![];return![];}async[a0_0x29811d(0x247)](){const _0x19bbc2=a0_0x29811d;try{const _0x35d2f9=await this[_0x19bbc2(0x202)](_0x19bbc2(0x1d4));if(_0x35d2f9&&_0x35d2f9[_0x19bbc2(0x264)]&&_0x35d2f9[_0x19bbc2(0x264)][_0x19bbc2(0x208)])return _0x35d2f9[_0x19bbc2(0x264)]['uuid'];return _0x19bbc2(0x1e4);}catch(_0x178e05){return _0x19bbc2(0x272);}}async['createAllObjects'](){}async[a0_0x29811d(0x23e)](){const _0x2a4bc6=a0_0x29811d;await this['extendObjectAsync'](_0x2a4bc6(0x155),{'type':_0x2a4bc6(0x1b5),'common':{'name':_0x2a4bc6(0x211)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x2a4bc6(0x27d),'common':{'name':_0x2a4bc6(0x2be),'type':'string','role':_0x2a4bc6(0x27d),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x2a4bc6(0x2c1)],'states':{[SYSTEM_MODES['NORMAL']]:'Normal',[SYSTEM_MODES[_0x2a4bc6(0x1a9)]]:_0x2a4bc6(0x23d),[SYSTEM_MODES['PARTY']]:_0x2a4bc6(0x219),[SYSTEM_MODES[_0x2a4bc6(0x21c)]]:'Gast'}},'native':{}});}async[a0_0x29811d(0x2ab)](){const _0x2c401f=a0_0x29811d;await this['extendObjectAsync'](_0x2c401f(0x280),{'type':_0x2c401f(0x1b5),'common':{'name':'LTM'},'native':{}}),await this[_0x2c401f(0x1c6)](LTM_DP_RAW_LOG,{'type':_0x2c401f(0x27d),'common':{'name':_0x2c401f(0x25d),'type':_0x2c401f(0x196),'role':_0x2c401f(0x1f7),'read':!![],'write':![]},'native':{}}),await this[_0x2c401f(0x1c6)](LTM_DP_DAILY_DIGESTS,{'type':_0x2c401f(0x27d),'common':{'name':_0x2c401f(0x19c),'type':_0x2c401f(0x196),'role':_0x2c401f(0x1f7),'read':!![],'write':![]},'native':{}}),await this[_0x2c401f(0x1c6)](LTM_DP_STATUS,{'type':_0x2c401f(0x27d),'common':{'name':_0x2c401f(0x2c4),'type':_0x2c401f(0x196),'role':_0x2c401f(0x21d),'read':!![],'write':![]},'native':{}}),await this[_0x2c401f(0x1c6)](LTM_DP_TRIGGER_DIGEST,{'type':_0x2c401f(0x27d),'common':{'name':_0x2c401f(0x17b),'type':_0x2c401f(0x169),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x2c401f(0x1c6)](LTM_DP_BASELINE_STATUS,{'type':_0x2c401f(0x27d),'common':{'name':_0x2c401f(0x232),'type':_0x2c401f(0x196),'role':_0x2c401f(0x21d),'read':!![],'write':![]},'native':{}});}async[a0_0x29811d(0x14e)](){const _0xed7e7b=a0_0x29811d;await this[_0xed7e7b(0x1c6)](LTM_DP_DRIFT_CHANNEL,{'type':_0xed7e7b(0x1b5),'common':{'name':_0xed7e7b(0x2ae)},'native':{}}),await this[_0xed7e7b(0x1c6)](LTM_DP_DRIFT_STATUS,{'type':_0xed7e7b(0x27d),'common':{'name':_0xed7e7b(0x171),'type':_0xed7e7b(0x196),'role':_0xed7e7b(0x27d),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this[_0xed7e7b(0x1c6)](LTM_DP_DRIFT_DETAILS,{'type':_0xed7e7b(0x27d),'common':{'name':_0xed7e7b(0x204),'type':_0xed7e7b(0x196),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0xed7e7b(0x1c6)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0xed7e7b(0x27d),'common':{'name':_0xed7e7b(0x287),'type':_0xed7e7b(0x20b),'role':_0xed7e7b(0x1c5),'read':!![],'write':![]},'native':{}});}async[a0_0x29811d(0x250)](){const _0x4a2d94=a0_0x29811d;try{const _0x4a6307=await this[_0x4a2d94(0x152)](SYSTEM_DP_MODE);_0x4a6307&&_0x4a6307[_0x4a2d94(0x289)]&&Object[_0x4a2d94(0x1a4)](SYSTEM_MODES)[_0x4a2d94(0x290)](_0x4a6307[_0x4a2d94(0x289)])?this[_0x4a2d94(0x1eb)]=_0x4a6307[_0x4a2d94(0x289)]:(this[_0x4a2d94(0x1eb)]=SYSTEM_MODES[_0x4a2d94(0x2c1)],await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x4a2d94(0x2c1)],'ack':!![]}));}catch(_0x385f72){this[_0x4a2d94(0x1eb)]=SYSTEM_MODES[_0x4a2d94(0x2c1)];}}async[a0_0x29811d(0x19e)](){const _0x375b33=a0_0x29811d;try{const _0x525d07=await this[_0x375b33(0x152)](LTM_DP_RAW_LOG);if(_0x525d07&&_0x525d07['val'])this[_0x375b33(0x156)]=JSON['parse'](_0x525d07[_0x375b33(0x289)]);}catch(_0x59d889){this[_0x375b33(0x156)]=[];}}async[a0_0x29811d(0x217)](){const _0x3f08fc=a0_0x29811d;this[_0x3f08fc(0x156)][_0x3f08fc(0x151)]>RAW_LOG_MAX_SIZE&&this[_0x3f08fc(0x156)][_0x3f08fc(0x2af)](0x0,this[_0x3f08fc(0x156)][_0x3f08fc(0x151)]-RAW_LOG_MAX_SIZE),await this[_0x3f08fc(0x256)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](this[_0x3f08fc(0x156)]),'ack':!![]});}async[a0_0x29811d(0x1a3)](){const _0x5a5a05=a0_0x29811d;try{const _0x36d6e1=await this[_0x5a5a05(0x152)](LTM_DP_DAILY_DIGESTS);if(_0x36d6e1&&_0x36d6e1[_0x5a5a05(0x289)])this[_0x5a5a05(0x1b7)]=JSON['parse'](_0x36d6e1[_0x5a5a05(0x289)]);}catch(_0x539ff6){this[_0x5a5a05(0x1b7)]=[];}await this[_0x5a5a05(0x192)]();}async[a0_0x29811d(0x20d)](_0x3ca681=!![]){const _0x18e820=a0_0x29811d,_0x2c5c4b=this[_0x18e820(0x16e)][_0x18e820(0x239)]||0x3c;this[_0x18e820(0x1b7)][_0x18e820(0x151)]>_0x2c5c4b&&this[_0x18e820(0x1b7)][_0x18e820(0x2af)](0x0,this[_0x18e820(0x1b7)][_0x18e820(0x151)]-_0x2c5c4b);await this['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x18e820(0x2bf)](this['dailyDigests']),'ack':!![]});if(_0x3ca681)await this[_0x18e820(0x192)]();}async[a0_0x29811d(0x225)](_0x17ee40){const _0x3d1713=a0_0x29811d;this[_0x3d1713(0x254)][_0x3d1713(0x21f)](_0x17ee40);if(this[_0x3d1713(0x254)][_0x3d1713(0x151)]>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0x3d1713(0x15e)]();await this[_0x3d1713(0x256)](_0x3d1713(0x28d),{'val':JSON[_0x3d1713(0x2bf)](this[_0x3d1713(0x254)]),'ack':!![]});}async['updateBaselineStatus'](){const _0x528430=a0_0x29811d;if(!this['isProVersion']){await this[_0x528430(0x256)](LTM_DP_BASELINE_STATUS,{'val':_0x528430(0x26e),'ack':!![]});return;}const _0x2008be=this['dailyDigests']['length']>=(this[_0x528430(0x16e)][_0x528430(0x1c4)]||0x7)?_0x528430(0x297)+this[_0x528430(0x1b7)][_0x528430(0x151)]+_0x528430(0x23b):_0x528430(0x220)+this[_0x528430(0x1b7)]['length']+'/'+(this[_0x528430(0x16e)]['minDaysForBaseline']||0x7)+')';await this[_0x528430(0x256)](LTM_DP_BASELINE_STATUS,{'val':_0x2008be,'ack':!![]});}async[a0_0x29811d(0x282)](){const _0x26d5b0=a0_0x29811d,_0x4fbab6=this[_0x26d5b0(0x16e)][_0x26d5b0(0x298)];if(_0x4fbab6&&_0x4fbab6['length']>0x0){this['log'][_0x26d5b0(0x299)](_0x26d5b0(0x1d6)+_0x4fbab6[_0x26d5b0(0x151)]+_0x26d5b0(0x172));for(const _0x465294 of _0x4fbab6){if(_0x465294['id']){await this[_0x26d5b0(0x1b9)](_0x465294['id']);try{const _0x28966a=await this[_0x26d5b0(0x1f1)](_0x465294['id']);if(_0x28966a)this[_0x26d5b0(0x2a4)][_0x465294['id']]=_0x28966a[_0x26d5b0(0x289)];}catch(_0x47b51a){}}}}}async['initPresenceSubscriptions'](){const _0x46304c=a0_0x29811d,_0x264854=this[_0x46304c(0x16e)]['presenceDevices']||[];if(_0x264854[_0x46304c(0x151)]>0x0){this[_0x46304c(0x1b6)][_0x46304c(0x299)](_0x46304c(0x1d6)+_0x264854['length']+_0x46304c(0x268));for(const _0x45a81e of _0x264854){await this[_0x46304c(0x1b9)](_0x45a81e);}try{await this[_0x46304c(0x275)]();}catch(_0x111e8d){}}}async[a0_0x29811d(0x1bf)](){const _0xe5dd5d=a0_0x29811d;try{if(!this[_0xe5dd5d(0x16e)][_0xe5dd5d(0x1d7)])return'Wetter:\x20Deaktiviert';let _0x1897f4='';const _0x3ad07c=this['config'][_0xe5dd5d(0x22f)];if(_0x3ad07c)try{if(_0x3ad07c[_0xe5dd5d(0x290)](_0xe5dd5d(0x28e))){const _0x20ee19=await this[_0xe5dd5d(0x1f1)](_0x3ad07c+_0xe5dd5d(0x173));if(_0x20ee19&&_0x20ee19['val'])_0x1897f4=_0x20ee19[_0xe5dd5d(0x289)];}else{if(_0x3ad07c[_0xe5dd5d(0x290)](_0xe5dd5d(0x238))){const _0xaa0a1=await this['getForeignStateAsync'](_0x3ad07c+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0xaa0a1&&_0xaa0a1[_0xe5dd5d(0x289)])_0x1897f4=_0xaa0a1[_0xe5dd5d(0x289)];}else{if(_0x3ad07c[_0xe5dd5d(0x290)](_0xe5dd5d(0x25f))){const _0x430347=await this[_0xe5dd5d(0x1f1)](_0x3ad07c+'.forecast.current.state');if(_0x430347&&_0x430347[_0xe5dd5d(0x289)])_0x1897f4=_0x430347[_0xe5dd5d(0x289)];}}}}catch(_0x573414){}if(!_0x1897f4){const _0x53a10a=['accuweather.0','daswetter.0',_0xe5dd5d(0x269),_0xe5dd5d(0x229)];for(const _0x173212 of _0x53a10a){try{const _0x4012ec=await this['getForeignObjectAsync'](_0x173212);if(_0x4012ec){if(_0x173212[_0xe5dd5d(0x290)](_0xe5dd5d(0x28e))){const _0x535d07=await this[_0xe5dd5d(0x1f1)](_0x173212+_0xe5dd5d(0x173));if(_0x535d07&&_0x535d07[_0xe5dd5d(0x289)]){_0x1897f4=_0x535d07[_0xe5dd5d(0x289)];break;}}}}catch(_0x1efaf9){}}}return _0x1897f4?_0xe5dd5d(0x2aa)+_0x1897f4:_0xe5dd5d(0x212);}catch(_0x1abcaa){return _0xe5dd5d(0x17f)+_0x1abcaa[_0xe5dd5d(0x279)];}}async[a0_0x29811d(0x2bb)](){const _0x2edb71=a0_0x29811d;try{if(!this[_0x2edb71(0x16e)][_0x2edb71(0x18a)])return _0x2edb71(0x22d);let _0x23627f=this[_0x2edb71(0x16e)]['calendarInstance']||_0x2edb71(0x1cc),_0x31f11a=this[_0x2edb71(0x16e)][_0x2edb71(0x15b)]||[];if(typeof _0x31f11a===_0x2edb71(0x196))_0x31f11a=_0x31f11a[_0x2edb71(0x226)](',');try{const _0x53f1f9=await this['getForeignStateAsync'](_0x23627f+'.data.table');if(_0x53f1f9&&_0x53f1f9['val']){let _0xbb3055=this[_0x2edb71(0x230)](_0x53f1f9[_0x2edb71(0x289)]);if(_0xbb3055&&Array[_0x2edb71(0x249)](_0xbb3055)){if(_0x31f11a[_0x2edb71(0x151)]>0x0)_0xbb3055=_0xbb3055[_0x2edb71(0x19f)](_0x7890a2=>_0x31f11a[_0x2edb71(0x290)](_0x7890a2[_0x2edb71(0x1ec)]||''));else return _0x2edb71(0x1b8);if(_0xbb3055[_0x2edb71(0x151)]>0x0){const _0x18373c=_0xbb3055['slice'](0x0,0x3)[_0x2edb71(0x14c)](_0x2f1059=>{const _0x4e9961=_0x2edb71;let _0x3f8aa2=_0x2f1059[_0x4e9961(0x1c5)];if(_0x2f1059[_0x4e9961(0x25c)])_0x3f8aa2+='\x20'+_0x2f1059[_0x4e9961(0x25c)];return _0x3f8aa2+':\x20'+_0x2f1059[_0x4e9961(0x200)]+'\x20('+_0x2f1059[_0x4e9961(0x1ec)]+')';});return _0x2edb71(0x29b)+_0x18373c[_0x2edb71(0x179)]('\x20|\x20');}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x33baf5){this[_0x2edb71(0x1b6)][_0x2edb71(0x189)](_0x2edb71(0x17a)+_0x33baf5['message']);}return _0x2edb71(0x2c2);}catch(_0x2e3804){return _0x2edb71(0x1ee)+_0x2e3804[_0x2edb71(0x279)];}}async['getCalendarNames'](_0x476de9){const _0x543dfa=a0_0x29811d;try{const _0x430da4=await this['getForeignStateAsync'](_0x476de9+_0x543dfa(0x163));if(_0x430da4&&_0x430da4[_0x543dfa(0x289)]){const _0x5b6ae1=this[_0x543dfa(0x230)](_0x430da4[_0x543dfa(0x289)]);if(_0x5b6ae1&&Array[_0x543dfa(0x249)](_0x5b6ae1)){const _0x1f405d=[...new Set(_0x5b6ae1[_0x543dfa(0x14c)](_0x3fd4e7=>_0x3fd4e7[_0x543dfa(0x1ec)])['filter'](Boolean))];return _0x1f405d['sort']();}}return[];}catch(_0x37ff72){return this[_0x543dfa(0x1b6)][_0x543dfa(0x252)]('getCalendarNames\x20Error:\x20'+_0x37ff72[_0x543dfa(0x279)]),[];}}async[a0_0x29811d(0x275)](){const _0x2c746c=a0_0x29811d;try{const _0xc6366=this[_0x2c746c(0x16e)][_0x2c746c(0x206)]||[];let _0x5b7818=![];for(const _0x17ecd0 of _0xc6366){try{const _0x8d8993=await this['getForeignStateAsync'](_0x17ecd0);if(_0x8d8993&&(_0x8d8993[_0x2c746c(0x289)]===!![]||_0x8d8993['val']===_0x2c746c(0x243)||_0x8d8993[_0x2c746c(0x289)]===0x1)){_0x5b7818=!![];break;}}catch(_0x46d6b7){}}return _0x5b7818&&(this[_0x2c746c(0x16b)]&&(this[_0x2c746c(0x1b6)][_0x2c746c(0x299)](_0x2c746c(0x24e)),this[_0x2c746c(0x29d)]()),!this[_0x2c746c(0x191)]&&this[_0x2c746c(0x1eb)]===SYSTEM_MODES[_0x2c746c(0x2c1)]&&await this[_0x2c746c(0x1f6)](!![])),_0x5b7818;}catch(_0xcfdc67){return this['log'][_0x2c746c(0x252)](_0x2c746c(0x240)+_0xcfdc67[_0x2c746c(0x279)]),![];}}[a0_0x29811d(0x1cb)](){const _0x1419d3=a0_0x29811d;this[_0x1419d3(0x29d)](),this[_0x1419d3(0x231)]=!![],this['exitGraceTimer']=setTimeout(()=>{const _0x167493=_0x1419d3;this[_0x167493(0x231)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x1419d3(0x16b)]=setTimeout(()=>{const _0x46d48d=_0x1419d3;this['setPresence'](![]),this[_0x46d48d(0x16b)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x29811d(0x29d)](){const _0x3270ca=a0_0x29811d;if(this[_0x3270ca(0x16b)])clearTimeout(this['exitTimer']);if(this[_0x3270ca(0x1ac)])clearTimeout(this[_0x3270ca(0x1ac)]);this[_0x3270ca(0x16b)]=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![];}async[a0_0x29811d(0x1f6)](_0x5798ae){const _0x44a8c8=a0_0x29811d;if(this['isPresent']===_0x5798ae)return;this[_0x44a8c8(0x191)]=_0x5798ae,await this[_0x44a8c8(0x256)](_0x44a8c8(0x14b),{'val':_0x5798ae,'ack':!![]});}async[a0_0x29811d(0x2ac)](_0x1243f8){const _0x202ef0=a0_0x29811d;this[_0x202ef0(0x1b6)]['info']('Feedback\x20saved:\x20'+JSON[_0x202ef0(0x2bf)](_0x1243f8));}async[a0_0x29811d(0x198)](){const _0x52fd34=a0_0x29811d;if(!this[_0x52fd34(0x1dd)]||!this[_0x52fd34(0x2b0)])return;const _0x49c9ec=this[_0x52fd34(0x16e)][_0x52fd34(0x262)]||0xe;if(this[_0x52fd34(0x1b7)][_0x52fd34(0x151)]<_0x49c9ec+(this['config'][_0x52fd34(0x1c4)]||0x7)){await this[_0x52fd34(0x256)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x44b428=this[_0x52fd34(0x1b7)][_0x52fd34(0x1fa)](-_0x49c9ec),_0x619805=this[_0x52fd34(0x1b7)][_0x52fd34(0x1fa)](0x0,this[_0x52fd34(0x1b7)][_0x52fd34(0x151)]-_0x49c9ec),_0x35752c=_0x52fd34(0x188)+JSON[_0x52fd34(0x2bf)](_0x619805)+_0x52fd34(0x1c2)+JSON[_0x52fd34(0x2bf)](_0x44b428);try{const _0x2b4554=await this[_0x52fd34(0x2b0)][_0x52fd34(0x1f3)](_0x35752c),_0x533bcc=JSON[_0x52fd34(0x168)](_0x2b4554[_0x52fd34(0x28f)][_0x52fd34(0x21d)]()['replace'](/```json|```/g,'')['trim']());_0x533bcc[_0x52fd34(0x1b1)]&&(await this[_0x52fd34(0x256)](LTM_DP_DRIFT_STATUS,{'val':_0x533bcc[_0x52fd34(0x1b1)],'ack':!![]}),await this[_0x52fd34(0x256)](LTM_DP_DRIFT_DETAILS,{'val':_0x533bcc[_0x52fd34(0x20e)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x4d1e59){}}['setupLtmScheduler'](){const _0x3ddbd9=a0_0x29811d;try{if(this[_0x3ddbd9(0x2a7)])this['ltmJob'][_0x3ddbd9(0x1e2)]();if(!this[_0x3ddbd9(0x1dd)]){this[_0x3ddbd9(0x256)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this[_0x3ddbd9(0x2a7)]=schedule[_0x3ddbd9(0x176)](LTM_SCHEDULE,()=>this[_0x3ddbd9(0x1c7)]());}catch(_0x1a21c6){this[_0x3ddbd9(0x1b6)][_0x3ddbd9(0x252)](_0x3ddbd9(0x241)+_0x1a21c6['message']);}}['setupModeResetScheduler'](){const _0x1d88ea=a0_0x29811d;try{if(this[_0x1d88ea(0x2b6)])this[_0x1d88ea(0x2b6)][_0x1d88ea(0x1e2)]();this['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x4ab1c6=_0x1d88ea;await this[_0x4ab1c6(0x250)](),AUTO_RESET_MODES[_0x4ab1c6(0x290)](this[_0x4ab1c6(0x1eb)])&&await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x4ab1c6(0x2c1)],'ack':![]});});}catch(_0x121e0a){this['log'][_0x1d88ea(0x252)](_0x1d88ea(0x1da)+_0x121e0a['message']);}}['setupDriftAnalysisScheduler'](){const _0x5e36c6=a0_0x29811d;try{if(this[_0x5e36c6(0x26d)])clearInterval(this['driftAnalysisTimer']);if(!this[_0x5e36c6(0x1dd)])return;this[_0x5e36c6(0x26d)]=setInterval(()=>this[_0x5e36c6(0x198)](),(this[_0x5e36c6(0x16e)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>this[_0x5e36c6(0x198)](),0x1388);}catch(_0x38876d){this[_0x5e36c6(0x1b6)][_0x5e36c6(0x252)](_0x5e36c6(0x170)+_0x38876d[_0x5e36c6(0x279)]);}}[a0_0x29811d(0x292)](){const _0xd6061c=a0_0x29811d;try{if(this[_0xd6061c(0x259)])this['briefingJob'][_0xd6061c(0x1e2)]();if(!this[_0xd6061c(0x16e)][_0xd6061c(0x270)])return;const _0x9082bc=(this[_0xd6061c(0x16e)][_0xd6061c(0x2b2)]||_0xd6061c(0x1cd))['split'](':'),_0x244eb4=parseInt(_0x9082bc[0x0])||0x8,_0x4ce0db=parseInt(_0x9082bc[0x1])||0x0,_0xb61541=_0x4ce0db+'\x20'+_0x244eb4+_0xd6061c(0x29e);this[_0xd6061c(0x1b6)][_0xd6061c(0x299)](_0xd6061c(0x246)+_0x244eb4+':'+(_0x4ce0db<0xa?'0'+_0x4ce0db:_0x4ce0db)),this[_0xd6061c(0x259)]=schedule['scheduleJob'](_0xb61541,()=>{const _0x1cbb29=_0xd6061c;this[_0x1cbb29(0x265)]();});}catch(_0x31ae06){this[_0xd6061c(0x1b6)][_0xd6061c(0x252)]('Briefing\x20Sched\x20Error:\x20'+_0x31ae06['message']);}}async['sendNotification'](_0xe26ca8,_0x526a09=![],_0x1d8b0f=![]){const _0x32b8ac=a0_0x29811d;this[_0x32b8ac(0x1b6)][_0x32b8ac(0x299)]((_0x526a09?_0x32b8ac(0x2c0):'')+_0x32b8ac(0x28b)+_0xe26ca8+'\x22');const _0x3ff68a=this[_0x32b8ac(0x16e)];let _0x10e5a0=0x0;if(_0x3ff68a[_0x32b8ac(0x248)]&&_0x3ff68a['notifyTelegramInstance']){let _0x5f197a={};(_0xe26ca8['includes'](_0x32b8ac(0x25b))||_0x1d8b0f)&&(_0x5f197a={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':'COGNI_CONFIRM_OK'}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x32b8ac(0x215)}]]}}),await this['sendToAsync'](_0x3ff68a[_0x32b8ac(0x26f)],_0x32b8ac(0x1bc),{'text':_0xe26ca8,'user':_0x3ff68a[_0x32b8ac(0x22a)],..._0x5f197a}),_0x10e5a0++;}if(_0x3ff68a[_0x32b8ac(0x286)]&&_0x3ff68a[_0x32b8ac(0x29f)]){let _0xd7b0e2={'message':_0xe26ca8,'title':_0x1d8b0f?'ðŸš¨\x20EMERGENCY':'Cogni-Living','priority':_0x1d8b0f?0x2:0x1,'device':_0x3ff68a['notifyPushoverRecipient']};_0x1d8b0f&&(_0xd7b0e2['retry']=0x1e,_0xd7b0e2['expire']=0xe10,_0xd7b0e2[_0x32b8ac(0x25e)]='siren'),await this[_0x32b8ac(0x29c)](_0x3ff68a[_0x32b8ac(0x29f)],_0x32b8ac(0x1bc),_0xd7b0e2),_0x10e5a0++;}return _0x3ff68a[_0x32b8ac(0x180)]&&_0x3ff68a[_0x32b8ac(0x291)]&&(await this[_0x32b8ac(0x29c)](_0x3ff68a[_0x32b8ac(0x291)],_0x32b8ac(0x1bc),{'text':_0xe26ca8,'to':_0x3ff68a[_0x32b8ac(0x244)]}),_0x10e5a0++),_0x10e5a0;}}if(require[a0_0x29811d(0x23c)]!==module)module['exports']=_0x2d25b7=>new CogniLiving(_0x2d25b7);else new CogniLiving();