const a0_0x442fc5=a0_0x5b87;(function(_0x4a1bdc,_0x4cbb61){const _0x1553c9=a0_0x5b87,_0x2915eb=_0x4a1bdc();while(!![]){try{const _0x3d38ed=-parseInt(_0x1553c9(0x2b9))/0x1+-parseInt(_0x1553c9(0x201))/0x2*(-parseInt(_0x1553c9(0x288))/0x3)+parseInt(_0x1553c9(0xff))/0x4*(-parseInt(_0x1553c9(0x2a8))/0x5)+-parseInt(_0x1553c9(0x17e))/0x6*(-parseInt(_0x1553c9(0x14a))/0x7)+parseInt(_0x1553c9(0x145))/0x8*(parseInt(_0x1553c9(0x22b))/0x9)+-parseInt(_0x1553c9(0x188))/0xa+parseInt(_0x1553c9(0x1a1))/0xb;if(_0x3d38ed===_0x4cbb61)break;else _0x2915eb['push'](_0x2915eb['shift']());}catch(_0x165875){_0x2915eb['push'](_0x2915eb['shift']());}}}(a0_0x3bdc,0xd91a5));const a0_0x1e74b8=(function(){let _0x45b99c=!![];return function(_0x290507,_0x5c562c){const _0x395a0b=_0x45b99c?function(){if(_0x5c562c){const _0x4f89e1=_0x5c562c['apply'](_0x290507,arguments);return _0x5c562c=null,_0x4f89e1;}}:function(){};return _0x45b99c=![],_0x395a0b;};}()),a0_0x4b3182=a0_0x1e74b8(this,function(){const _0x5a7bcf=a0_0x5b87;return a0_0x4b3182[_0x5a7bcf(0x257)]()[_0x5a7bcf(0x294)](_0x5a7bcf(0x289))[_0x5a7bcf(0x257)]()[_0x5a7bcf(0x1ec)](a0_0x4b3182)[_0x5a7bcf(0x294)]('(((.+)+)+)+$');});a0_0x4b3182();function a0_0x5b87(_0x4d7b13,_0x4e2151){const _0x262248=a0_0x3bdc();return a0_0x5b87=function(_0x4b3182,_0x1e74b8){_0x4b3182=_0x4b3182-0xf7;let _0x3bdc4d=_0x262248[_0x4b3182];return _0x3bdc4d;},a0_0x5b87(_0x4d7b13,_0x4e2151);}'use strict';const utils=require(a0_0x442fc5(0x1c6)),{GoogleGenerativeAI}=require(a0_0x442fc5(0x10b)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x442fc5(0x2ba)),path=require(a0_0x442fc5(0x20c)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x442fc5(0x26d),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x442fc5(0x2d0),LTM_DP_DAILY_DIGESTS=a0_0x442fc5(0x2fe),LTM_DP_STATUS=a0_0x442fc5(0x1b1),LTM_DP_TRIGGER_DIGEST=a0_0x442fc5(0x152),LTM_DP_BASELINE_STATUS=a0_0x442fc5(0x2d4),LTM_DP_DRIFT_CHANNEL=a0_0x442fc5(0x102),LTM_DP_DRIFT_STATUS=a0_0x442fc5(0x225),LTM_DP_DRIFT_DETAILS=a0_0x442fc5(0x245),LTM_DP_DRIFT_LAST_CHECK=a0_0x442fc5(0x23b),SYSTEM_DP_MODE=a0_0x442fc5(0x2de),HARD_IGNORE_TERMS=['scriptProblem',a0_0x442fc5(0x304),a0_0x442fc5(0x24f),a0_0x442fc5(0x202),'lowbat',a0_0x442fc5(0x1da),a0_0x442fc5(0x193),a0_0x442fc5(0xf8),a0_0x442fc5(0x254),a0_0x442fc5(0x1a2),a0_0x442fc5(0x27c),'direction',a0_0x442fc5(0x2df),a0_0x442fc5(0x170),a0_0x442fc5(0x240),a0_0x442fc5(0x136),a0_0x442fc5(0x196),a0_0x442fc5(0x189)],BAD_NAMES=[a0_0x442fc5(0x214),a0_0x442fc5(0x1a3),a0_0x442fc5(0x13c),a0_0x442fc5(0x269),a0_0x442fc5(0x1df),a0_0x442fc5(0x14f),'on',a0_0x442fc5(0x155),a0_0x442fc5(0x280),a0_0x442fc5(0x2a6),a0_0x442fc5(0x23d),a0_0x442fc5(0x256),a0_0x442fc5(0x1db),a0_0x442fc5(0x1e0),a0_0x442fc5(0x2da),a0_0x442fc5(0x17f),a0_0x442fc5(0x173),a0_0x442fc5(0x1d2),'humidity',a0_0x442fc5(0x19b),a0_0x442fc5(0x2fd),a0_0x442fc5(0x12e),'valve',a0_0x442fc5(0x22d),a0_0x442fc5(0x15e)],ADAPTER_BLACKLIST=[a0_0x442fc5(0x229),a0_0x442fc5(0x12a),a0_0x442fc5(0x1e1),'vis.',a0_0x442fc5(0x18d),a0_0x442fc5(0x2e4),a0_0x442fc5(0x2f2),a0_0x442fc5(0x241),a0_0x442fc5(0x287),a0_0x442fc5(0x2db),a0_0x442fc5(0x251)],SYSTEM_MODES={'NORMAL':a0_0x442fc5(0x180),'VACATION':a0_0x442fc5(0x12f),'PARTY':a0_0x442fc5(0x1ea),'GUEST':a0_0x442fc5(0x248)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x442fc5(0x27e)]],PERSONA_MAPPING={'generic':a0_0x442fc5(0x124),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit/AAL.','family':a0_0x442fc5(0x1c0),'single_comfort':a0_0x442fc5(0x1d9),'security':a0_0x442fc5(0x2d8)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x5bb2b1){const _0x4dae82=a0_0x442fc5;try{const _0x1b14ae=['analysis.history_debug_00',_0x4dae82(0x1c9)];for(const _0x242795 of _0x1b14ae){try{const _0x49633a=await _0x5bb2b1[_0x4dae82(0xf9)](_0x242795);_0x49633a&&await _0x5bb2b1[_0x4dae82(0x2cd)](_0x242795);}catch(_0x6be683){}}}catch(_0x439786){}}async function initHistory(_0x357ade){const _0x1406c8=a0_0x442fc5;try{const _0x874398=await _0x357ade[_0x1406c8(0x12d)](_0x1406c8(0x1b4));_0x874398&&_0x874398['val']&&(_0x357ade['eventHistory']=JSON[_0x1406c8(0x13a)](_0x874398['val'][_0x1406c8(0x257)]()));}catch(_0x20d7e1){_0x357ade[_0x1406c8(0x2b0)]=[];}try{const _0x4313e2=await _0x357ade['getStateAsync'](_0x1406c8(0x13d));if(_0x4313e2&&_0x4313e2[_0x1406c8(0x1e3)])_0x357ade['analysisHistory']=JSON[_0x1406c8(0x13a)](_0x4313e2[_0x1406c8(0x1e3)][_0x1406c8(0x257)]());}catch(_0x2aaf06){_0x357ade[_0x1406c8(0x1c8)]=[];}if(_0x357ade[_0x1406c8(0x2b0)]&&_0x357ade[_0x1406c8(0x2b0)][_0x1406c8(0x13f)]>0x0){_0x357ade[_0x1406c8(0x279)][_0x1406c8(0x1d4)](_0x1406c8(0x2fa)+_0x357ade[_0x1406c8(0x2b0)][_0x1406c8(0x13f)]+'\x20events)...');for(let _0x29d523=_0x357ade['eventHistory'][_0x1406c8(0x13f)]-0x1;_0x29d523>=0x0;_0x29d523--){const _0x889838=_0x357ade[_0x1406c8(0x2b0)][_0x29d523];_0x889838&&_0x889838['id']!==undefined&&_0x889838[_0x1406c8(0x1df)]!==undefined&&(_0x357ade['sensorLastValues'][_0x889838['id']]=_0x889838[_0x1406c8(0x1df)]);}}}async function initSystemConfig(_0x15e4e5){const _0x2eeda2=a0_0x442fc5;try{const _0x44dabe=await _0x15e4e5[_0x2eeda2(0x25e)]('system.config');_0x44dabe&&_0x44dabe[_0x2eeda2(0x29e)]&&(_0x15e4e5[_0x2eeda2(0x2d5)]={'latitude':_0x44dabe[_0x2eeda2(0x29e)][_0x2eeda2(0x118)]||0x0,'longitude':_0x44dabe[_0x2eeda2(0x29e)]['longitude']||0x0,'city':_0x44dabe[_0x2eeda2(0x29e)]['city']||''});}catch(_0x1aaf06){}}async function checkLicense(_0x30ee99,_0x6688af){const _0x4ee4f5=a0_0x442fc5;if(!_0x6688af)return![];_0x30ee99['systemUUID']=await getSystemUUID(_0x30ee99);if(_0x6688af===_0x4ee4f5(0x191)||_0x6688af['startsWith']('PRO-'))return!![];return![];}async function getSystemUUID(_0x1d2ad6){const _0x42f09b=a0_0x442fc5;try{const _0x43fc07=await _0x1d2ad6['getForeignObjectAsync']('system.meta.uuid');if(_0x43fc07&&_0x43fc07[_0x42f09b(0x148)]&&_0x43fc07[_0x42f09b(0x148)][_0x42f09b(0x29c)])return _0x43fc07[_0x42f09b(0x148)][_0x42f09b(0x29c)];return _0x42f09b(0x15f);}catch(_0x1aafe3){return'uuid-error';}}async function createAllObjects(_0x4e76cb){const _0x13076e=a0_0x442fc5;await checkSystemObjects(_0x4e76cb),await _0x4e76cb['setObjectNotExistsAsync'](_0x13076e(0x1f6),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x246),'type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![],'def':''},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x1cf),{'type':'state','common':{'name':'Last\x20raw\x20event','type':_0x13076e(0x2ef),'role':'json','read':!![],'write':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x1b4),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x211),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x111),{'type':_0x13076e(0x13c),'common':{'name':'Trigger\x20Analysis','type':_0x13076e(0x2af),'role':_0x13076e(0x2dc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x165),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x20b),'type':_0x13076e(0x2af),'role':_0x13076e(0x2dc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x156),{'type':'state','common':{'name':_0x13076e(0x2ac),'type':_0x13076e(0x2ef),'role':_0x13076e(0x297),'read':!![],'write':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x17c),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x10f),'type':_0x13076e(0x2af),'role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)]('analysis.isEmergency',{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x299),'type':_0x13076e(0x2af),'role':_0x13076e(0x309),'read':!![],'write':![],'def':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x1e8),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x15d),'type':_0x13076e(0x2ef),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x283),{'type':_0x13076e(0x13c),'common':{'name':'Activity\x20Summary','type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![]},'native':{}}),await _0x4e76cb['setObjectNotExistsAsync'](_0x13076e(0x212),{'type':'state','common':{'name':_0x13076e(0x2f0),'type':'string','role':_0x13076e(0x13c),'read':!![],'write':![],'def':_0x13076e(0x1ac)},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x22e),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x242),'type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![]},'native':{}}),await _0x4e76cb['setObjectNotExistsAsync'](_0x13076e(0x28c),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x305),'type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![]},'native':{}}),await _0x4e76cb['extendObjectAsync'](_0x13076e(0x11f),{'type':_0x13076e(0x226),'common':{'name':_0x13076e(0x2e6)},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x1f4),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x1d3),'type':_0x13076e(0x2af),'role':_0x13076e(0x247),'read':!![],'write':![],'def':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x29a),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x182),'type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x1e2),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x100),'type':_0x13076e(0x2ef),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4e76cb['setObjectNotExistsAsync']('analysis.automation.targetId',{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x29d),'type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x24e),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x104),'type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![]},'native':{}}),await _0x4e76cb['setObjectNotExistsAsync'](_0x13076e(0x267),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x1d0),'type':_0x13076e(0x2af),'role':_0x13076e(0x280),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x1ca),{'type':'state','common':{'name':_0x13076e(0x232),'type':'boolean','role':_0x13076e(0x2dc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4e76cb[_0x13076e(0x149)]('analysis.analysisHistory',{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x1ab),'type':_0x13076e(0x2ef),'role':_0x13076e(0x297),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x2c5),{'type':_0x13076e(0x13c),'common':{'name':'Feedback\x20Log','type':'string','role':_0x13076e(0x297),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x4e76cb['extendObjectAsync'](_0x13076e(0x265),{'type':_0x13076e(0x226),'common':{'name':_0x13076e(0x15b)},'native':{}}),await _0x4e76cb['setObjectNotExistsAsync'](_0x13076e(0x2c3),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x2ad),'type':'number','role':_0x13076e(0x252),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x187),{'type':'state','common':{'name':_0x13076e(0x181),'type':'string','role':_0x13076e(0x22c),'read':!![],'write':![],'def':_0x13076e(0x19d)},'native':{}}),await _0x4e76cb['setObjectNotExistsAsync'](_0x13076e(0x1b5),{'type':'state','common':{'name':_0x13076e(0x2e2),'type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![],'def':''},'native':{}}),await _0x4e76cb['setObjectNotExistsAsync'](_0x13076e(0x2bc),{'type':_0x13076e(0x13c),'common':{'name':'Trend\x20Diagnosis\x20(Python)','type':_0x13076e(0x2ef),'role':_0x13076e(0x22c),'read':!![],'write':![],'def':_0x13076e(0x1ac)},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x108),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x1fe),'type':_0x13076e(0x162),'role':_0x13076e(0x1df),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x4e76cb[_0x13076e(0x164)](_0x13076e(0x1a6),{'type':'channel','common':{'name':'Training\x20Data\x20Sets'},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0x12b),{'type':_0x13076e(0x13c),'common':{'name':'Recorded\x20Motion\x20Sequences','type':_0x13076e(0x2ef),'role':_0x13076e(0x297),'read':!![],'write':![],'def':'[]','desc':_0x13076e(0x16a)},'native':{}}),await _0x4e76cb[_0x13076e(0x149)](_0x13076e(0xfc),{'type':_0x13076e(0x13c),'common':{'name':_0x13076e(0x16e),'type':_0x13076e(0x2ef),'role':_0x13076e(0x297),'read':!![],'write':![],'def':'[]','desc':_0x13076e(0x21f)},'native':{}}),await checkLtmObjects(_0x4e76cb),await checkLtmDriftObjects(_0x4e76cb);}async function checkSystemObjects(_0x4983bd){const _0x4898e9=a0_0x442fc5;await _0x4983bd[_0x4898e9(0x164)]('system',{'type':_0x4898e9(0x226),'common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0x4983bd[_0x4898e9(0x164)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x4898e9(0x1aa),'type':_0x4898e9(0x2ef),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES['NORMAL']]:_0x4898e9(0x120),[SYSTEM_MODES['VACATION']]:_0x4898e9(0x2a9),[SYSTEM_MODES[_0x4898e9(0x222)]]:_0x4898e9(0x197),[SYSTEM_MODES[_0x4898e9(0x27e)]]:_0x4898e9(0x1a4)}},'native':{}});}async function checkLtmObjects(_0x1c2f04){const _0x43785c=a0_0x442fc5;await _0x1c2f04['extendObjectAsync'](_0x43785c(0x2ec),{'type':'channel','common':{'name':'LTM'},'native':{}}),await _0x1c2f04[_0x43785c(0x164)](LTM_DP_RAW_LOG,{'type':_0x43785c(0x13c),'common':{'name':_0x43785c(0x30b),'type':_0x43785c(0x2ef),'role':_0x43785c(0x297),'read':!![],'write':![]},'native':{}}),await _0x1c2f04[_0x43785c(0x164)](LTM_DP_DAILY_DIGESTS,{'type':_0x43785c(0x13c),'common':{'name':_0x43785c(0x1ef),'type':_0x43785c(0x2ef),'role':_0x43785c(0x297),'read':!![],'write':![]},'native':{}}),await _0x1c2f04[_0x43785c(0x164)](LTM_DP_STATUS,{'type':_0x43785c(0x13c),'common':{'name':'Processing\x20Status','type':_0x43785c(0x2ef),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1c2f04[_0x43785c(0x164)](LTM_DP_TRIGGER_DIGEST,{'type':_0x43785c(0x13c),'common':{'name':_0x43785c(0x2b3),'type':'boolean','role':_0x43785c(0x2dc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1c2f04['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x43785c(0x13c),'common':{'name':'Baseline\x20Status','type':_0x43785c(0x2ef),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x3c9f0c){const _0x184ffd=a0_0x442fc5;await _0x3c9f0c[_0x184ffd(0x164)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x184ffd(0x17b)},'native':{}}),await _0x3c9f0c[_0x184ffd(0x164)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x184ffd(0x15c),'type':_0x184ffd(0x2ef),'role':_0x184ffd(0x13c),'read':!![],'write':![],'def':_0x184ffd(0x1ac)},'native':{}}),await _0x3c9f0c['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x184ffd(0x13c),'common':{'name':_0x184ffd(0x13b),'type':_0x184ffd(0x2ef),'role':_0x184ffd(0x22c),'read':!![],'write':![]},'native':{}}),await _0x3c9f0c[_0x184ffd(0x164)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x184ffd(0x13c),'common':{'name':_0x184ffd(0x14b),'type':_0x184ffd(0x162),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x3b2c7f){const _0x94a0a6=a0_0x442fc5;try{const _0x5b34cb=await _0x3b2c7f[_0x94a0a6(0x12d)](SYSTEM_DP_MODE);_0x5b34cb&&_0x5b34cb['val']&&Object[_0x94a0a6(0x2e0)](SYSTEM_MODES)[_0x94a0a6(0x2aa)](_0x5b34cb[_0x94a0a6(0x1e3)])?_0x3b2c7f[_0x94a0a6(0x255)]=_0x5b34cb[_0x94a0a6(0x1e3)]:(_0x3b2c7f['currentSystemMode']=SYSTEM_MODES[_0x94a0a6(0x18a)],await _0x3b2c7f[_0x94a0a6(0x1a5)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x4f5b9a){_0x3b2c7f[_0x94a0a6(0x255)]=SYSTEM_MODES[_0x94a0a6(0x18a)];}}async function loadRawEventLog(_0x851c){const _0x1a17f9=a0_0x442fc5;try{const _0x247f46=await _0x851c[_0x1a17f9(0x12d)](LTM_DP_RAW_LOG);if(_0x247f46&&_0x247f46[_0x1a17f9(0x1e3)])_0x851c[_0x1a17f9(0x1fa)]=JSON['parse'](_0x247f46['val']);}catch(_0x160224){_0x851c['rawEventLog']=[];}}async function saveRawEventLog(_0x412d08){const _0x9206ba=a0_0x442fc5;_0x412d08[_0x9206ba(0x1fa)]['length']>RAW_LOG_MAX_SIZE&&_0x412d08[_0x9206ba(0x1fa)][_0x9206ba(0x1ad)](0x0,_0x412d08[_0x9206ba(0x1fa)]['length']-RAW_LOG_MAX_SIZE),await _0x412d08[_0x9206ba(0x1a5)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x412d08[_0x9206ba(0x1fa)]),'ack':!![]});}async function loadDailyDigests(_0x325d12){const _0x2aa2d4=a0_0x442fc5;try{const _0x77e922=await _0x325d12[_0x2aa2d4(0x12d)](LTM_DP_DAILY_DIGESTS);if(_0x77e922&&_0x77e922[_0x2aa2d4(0x1e3)])_0x325d12[_0x2aa2d4(0x2c2)]=JSON[_0x2aa2d4(0x13a)](_0x77e922[_0x2aa2d4(0x1e3)]);}catch(_0x52b65c){_0x325d12['dailyDigests']=[];}await updateBaselineStatus(_0x325d12);}async function saveDailyDigests(_0x63dbad,_0x185228=!![]){const _0x52321c=a0_0x442fc5,_0x29e2a6=_0x63dbad[_0x52321c(0x1c1)][_0x52321c(0x270)]||0x3c;_0x63dbad[_0x52321c(0x2c2)][_0x52321c(0x13f)]>_0x29e2a6&&_0x63dbad[_0x52321c(0x2c2)]['splice'](0x0,_0x63dbad[_0x52321c(0x2c2)][_0x52321c(0x13f)]-_0x29e2a6);await _0x63dbad[_0x52321c(0x1a5)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x63dbad[_0x52321c(0x2c2)]),'ack':!![]});if(_0x185228)await updateBaselineStatus(_0x63dbad);}async function updateAnalysisHistory(_0x202d43,_0x21c3a4){const _0xdaaedd=a0_0x442fc5;_0x202d43[_0xdaaedd(0x1c8)][_0xdaaedd(0x18f)](_0x21c3a4);if(_0x202d43[_0xdaaedd(0x1c8)][_0xdaaedd(0x13f)]>ANALYSIS_HISTORY_MAX_SIZE)_0x202d43[_0xdaaedd(0x1c8)][_0xdaaedd(0x112)]();await _0x202d43['setStateAsync']('analysis.analysisHistory',{'val':JSON[_0xdaaedd(0x277)](_0x202d43['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x3dd3b5){const _0x957607=a0_0x442fc5;if(!_0x3dd3b5[_0x957607(0x171)]){await _0x3dd3b5[_0x957607(0x1a5)](LTM_DP_BASELINE_STATUS,{'val':_0x957607(0x2bb),'ack':!![]});return;}const _0x3007f8=_0x3dd3b5[_0x957607(0x2c2)][_0x957607(0x13f)]>=(_0x3dd3b5['config'][_0x957607(0x224)]||0x7)?_0x957607(0x210)+_0x3dd3b5['dailyDigests']['length']+'\x20Tage)':_0x957607(0x21d)+_0x3dd3b5[_0x957607(0x2c2)][_0x957607(0x13f)]+'/'+(_0x3dd3b5[_0x957607(0x1c1)][_0x957607(0x224)]||0x7)+')';await _0x3dd3b5[_0x957607(0x1a5)](LTM_DP_BASELINE_STATUS,{'val':_0x3007f8,'ack':!![]});}async function initSensorSubscriptions(_0x1d8deb){const _0xb1e850=a0_0x442fc5,_0x11541b=_0x1d8deb['config'][_0xb1e850(0x1d1)];if(_0x11541b&&_0x11541b[_0xb1e850(0x13f)]>0x0){_0x1d8deb['log'][_0xb1e850(0x1d4)](_0xb1e850(0x2ab)+_0x11541b['length']+_0xb1e850(0x198));for(const _0x2bffb9 of _0x11541b){if(_0x2bffb9['id']){await _0x1d8deb[_0xb1e850(0x2a2)](_0x2bffb9['id']);try{const _0x4116ae=await _0x1d8deb[_0xb1e850(0x2dd)](_0x2bffb9['id']);if(_0x4116ae)_0x1d8deb[_0xb1e850(0x260)][_0x2bffb9['id']]=_0x4116ae[_0xb1e850(0x1e3)];}catch(_0x49a407){}}}}}async function initPresenceSubscriptions(_0x291407){const _0x2a1cda=a0_0x442fc5,_0x599983=_0x291407[_0x2a1cda(0x1c1)][_0x2a1cda(0x2f1)]||[];if(_0x599983['length']>0x0){_0x291407[_0x2a1cda(0x279)][_0x2a1cda(0x1d4)]('Subscribing\x20to\x20'+_0x599983[_0x2a1cda(0x13f)]+'\x20presence\x20devices...');for(const _0x417688 of _0x599983){await _0x291407[_0x2a1cda(0x2a2)](_0x417688);}try{await checkWifiPresence(_0x291407);}catch(_0x415f8e){}}}async function getWeatherContext(_0x4bf48b){const _0x16df9e=a0_0x442fc5;try{if(!_0x4bf48b[_0x16df9e(0x1c1)][_0x16df9e(0x28f)])return'Wetter:\x20Deaktiviert';let _0xa152f4='';const _0x1908a1=_0x4bf48b['config'][_0x16df9e(0x1fd)];if(_0x1908a1)try{if(_0x1908a1[_0x16df9e(0x2aa)](_0x16df9e(0x1ee))){const _0x1b1075=await _0x4bf48b[_0x16df9e(0x2dd)](_0x1908a1+_0x16df9e(0x2b4));if(_0x1b1075&&_0x1b1075[_0x16df9e(0x1e3)])_0xa152f4=_0x1b1075[_0x16df9e(0x1e3)];}else{if(_0x1908a1[_0x16df9e(0x2aa)](_0x16df9e(0x1d7))){const _0x37a9a6=await _0x4bf48b[_0x16df9e(0x2dd)](_0x1908a1+_0x16df9e(0x2e7));if(_0x37a9a6&&_0x37a9a6[_0x16df9e(0x1e3)])_0xa152f4=_0x37a9a6[_0x16df9e(0x1e3)];}else{if(_0x1908a1[_0x16df9e(0x2aa)]('openweathermap')){const _0x291e08=await _0x4bf48b[_0x16df9e(0x2dd)](_0x1908a1+_0x16df9e(0x14d));if(_0x291e08&&_0x291e08[_0x16df9e(0x1e3)])_0xa152f4=_0x291e08[_0x16df9e(0x1e3)];}}}}catch(_0x10b50e){}if(!_0xa152f4){const _0x200b8f=[_0x16df9e(0x154),_0x16df9e(0x27d),_0x16df9e(0x132),_0x16df9e(0x21c)];for(const _0x1672c3 of _0x200b8f){try{const _0x2568ac=await _0x4bf48b['getForeignObjectAsync'](_0x1672c3);if(_0x2568ac){if(_0x1672c3['includes']('accuweather')){const _0x2ae319=await _0x4bf48b[_0x16df9e(0x2dd)](_0x1672c3+_0x16df9e(0x2b4));if(_0x2ae319&&_0x2ae319[_0x16df9e(0x1e3)]){_0xa152f4=_0x2ae319[_0x16df9e(0x1e3)];break;}}}}catch(_0xd80058){}}}return _0xa152f4?_0x16df9e(0x26e)+_0xa152f4:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x4eab86){return _0x16df9e(0x2a4)+_0x4eab86[_0x16df9e(0x2bd)];}}async function getCalendarContext(_0x565ebf){const _0x3ac683=a0_0x442fc5;try{if(!_0x565ebf['config'][_0x3ac683(0x227)])return _0x3ac683(0x133);let _0x444ef6=_0x565ebf[_0x3ac683(0x1c1)][_0x3ac683(0x2cf)]||_0x3ac683(0x129),_0x55221c=_0x565ebf[_0x3ac683(0x1c1)][_0x3ac683(0x179)]||[];if(typeof _0x55221c===_0x3ac683(0x2ef))_0x55221c=_0x55221c[_0x3ac683(0x295)](',');try{const _0x376d29=await _0x565ebf[_0x3ac683(0x2dd)](_0x444ef6+_0x3ac683(0x2c7));if(_0x376d29&&_0x376d29['val']){let _0x5acd11=tryParse(_0x376d29['val']);if(_0x5acd11&&Array['isArray'](_0x5acd11)){if(_0x55221c[_0x3ac683(0x13f)]>0x0)_0x5acd11=_0x5acd11[_0x3ac683(0x29b)](_0x15083d=>_0x55221c[_0x3ac683(0x2aa)](_0x15083d[_0x3ac683(0x153)]||''));else return _0x3ac683(0x1e7);if(_0x5acd11[_0x3ac683(0x13f)]>0x0){const _0x39f0fd=_0x5acd11['slice'](0x0,0x3)[_0x3ac683(0x238)](_0x1e1bd6=>{const _0xf43ca7=_0x3ac683;let _0xd49a0=_0x1e1bd6['date'];if(_0x1e1bd6[_0xf43ca7(0x250)])_0xd49a0+='\x20'+_0x1e1bd6[_0xf43ca7(0x250)];return _0xd49a0+':\x20'+_0x1e1bd6[_0xf43ca7(0x1b9)]+'\x20('+_0x1e1bd6[_0xf43ca7(0x153)]+')';});return _0x3ac683(0x19f)+_0x39f0fd[_0x3ac683(0x2b6)](_0x3ac683(0x14c));}else return _0x3ac683(0x19a);}}}catch(_0x4d0467){_0x565ebf[_0x3ac683(0x279)]['warn'](_0x3ac683(0x1ed)+_0x4d0467[_0x3ac683(0x2bd)]);}return _0x3ac683(0x30a);}catch(_0x1f6643){return'KALENDER\x20ERROR:\x20'+_0x1f6643['message'];}}async function getCalendarNames(_0x2c69e2,_0x8c18da){const _0x518a81=a0_0x442fc5;try{const _0x39db48=await _0x2c69e2[_0x518a81(0x2dd)](_0x8c18da+_0x518a81(0x2c7));if(_0x39db48&&_0x39db48['val']){const _0x73299=tryParse(_0x39db48['val']);if(_0x73299&&Array[_0x518a81(0x130)](_0x73299)){const _0x130371=[...new Set(_0x73299[_0x518a81(0x238)](_0x573a87=>_0x573a87[_0x518a81(0x153)])[_0x518a81(0x29b)](Boolean))];return _0x130371['sort']();}}return[];}catch(_0x2751b8){return _0x2c69e2['log'][_0x518a81(0x254)](_0x518a81(0x1cd)+_0x2751b8['message']),[];}}async function checkWifiPresence(_0x25ce28){const _0x4313a9=a0_0x442fc5;try{const _0x2bf724=_0x25ce28[_0x4313a9(0x1c1)][_0x4313a9(0x2f1)]||[];let _0x3ae286=![];const _0x6102c=[];for(const _0x3bed8e of _0x2bf724){try{const _0x2010b6=await _0x25ce28[_0x4313a9(0x2dd)](_0x3bed8e);if(_0x2010b6&&(_0x2010b6[_0x4313a9(0x1e3)]===!![]||_0x2010b6['val']===_0x4313a9(0x1f5)||_0x2010b6[_0x4313a9(0x1e3)]===0x1)){_0x3ae286=!![];const _0x3e5844=await _0x25ce28['getForeignObjectAsync'](_0x3bed8e);let _0x5f2904=_0x3bed8e;_0x3e5844&&_0x3e5844[_0x4313a9(0x29e)]&&_0x3e5844[_0x4313a9(0x29e)][_0x4313a9(0x138)]&&(_0x5f2904=typeof _0x3e5844[_0x4313a9(0x29e)][_0x4313a9(0x138)]===_0x4313a9(0x25a)?_0x3e5844[_0x4313a9(0x29e)][_0x4313a9(0x138)]['de']||_0x3e5844[_0x4313a9(0x29e)]['name']['en']:_0x3e5844[_0x4313a9(0x29e)][_0x4313a9(0x138)]),_0x6102c[_0x4313a9(0x221)](_0x5f2904);}}catch(_0x228e60){}}return await _0x25ce28[_0x4313a9(0x1a5)]('system.presenceWho',{'val':_0x6102c[_0x4313a9(0x2b6)](',\x20'),'ack':!![]}),_0x3ae286&&(_0x25ce28[_0x4313a9(0x2a3)]&&(_0x25ce28[_0x4313a9(0x279)][_0x4313a9(0x1d4)](_0x4313a9(0x1a9)),abortExitTimer(_0x25ce28)),!_0x25ce28['isPresent']&&_0x25ce28['currentSystemMode']===SYSTEM_MODES[_0x4313a9(0x18a)]&&await setPresence(_0x25ce28,!![])),_0x3ae286;}catch(_0x2297b5){return _0x25ce28[_0x4313a9(0x279)][_0x4313a9(0x254)](_0x4313a9(0x1e6)+_0x2297b5[_0x4313a9(0x2bd)]),![];}}function startExitTimer(_0x44f976){const _0x41718f=a0_0x442fc5;abortExitTimer(_0x44f976),_0x44f976[_0x41718f(0x272)]=!![],_0x44f976[_0x41718f(0x1f2)]=setTimeout(()=>{const _0x320c88=_0x41718f;_0x44f976[_0x320c88(0x272)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x44f976[_0x41718f(0x2a3)]=setTimeout(()=>{const _0xc9fa3b=_0x41718f;setPresence(_0x44f976,![]),_0x44f976[_0xc9fa3b(0x2a3)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x2300aa){const _0x25de4c=a0_0x442fc5;if(_0x2300aa[_0x25de4c(0x2a3)])clearTimeout(_0x2300aa[_0x25de4c(0x2a3)]);if(_0x2300aa['exitGraceTimer'])clearTimeout(_0x2300aa[_0x25de4c(0x1f2)]);_0x2300aa['exitTimer']=null,_0x2300aa[_0x25de4c(0x1f2)]=null,_0x2300aa[_0x25de4c(0x272)]=![];}async function setPresence(_0x58a011,_0x367dc1){const _0x175454=a0_0x442fc5;if(_0x58a011[_0x175454(0x22a)]===_0x367dc1)return;_0x58a011[_0x175454(0x22a)]=_0x367dc1,await _0x58a011['setStateAsync']('system.isPresent',{'val':_0x367dc1,'ack':!![]});}async function saveFeedback(_0x134713,_0x3cd972){const _0x5cb507=a0_0x442fc5;_0x134713[_0x5cb507(0x279)]['info'](_0x5cb507(0x2ee)+JSON[_0x5cb507(0x277)](_0x3cd972));}async function runBaselineDriftAnalysis(_0x105c67){const _0x31c00c=a0_0x442fc5;if(!_0x105c67[_0x31c00c(0x171)]||!_0x105c67['geminiModel'])return;const _0x477625=_0x105c67[_0x31c00c(0x1c1)]['ltmStbWindowDays']||0xe;if(_0x105c67[_0x31c00c(0x2c2)][_0x31c00c(0x13f)]<_0x477625+(_0x105c67[_0x31c00c(0x1c1)][_0x31c00c(0x224)]||0x7)){await _0x105c67[_0x31c00c(0x1a5)](LTM_DP_DRIFT_STATUS,{'val':_0x31c00c(0x1eb),'ack':!![]});return;}const _0x895e48=_0x105c67[_0x31c00c(0x2c2)]['slice'](-_0x477625),_0xf8f957=_0x105c67[_0x31c00c(0x2c2)][_0x31c00c(0x2a1)](0x0,_0x105c67['dailyDigests'][_0x31c00c(0x13f)]-_0x477625),_0x1b60b1=_0x31c00c(0x126)+JSON[_0x31c00c(0x277)](_0xf8f957)+'\x0aSTB:\x20'+JSON[_0x31c00c(0x277)](_0x895e48);try{const _0x716c5b=await _0x105c67[_0x31c00c(0x161)]['generateContent'](_0x1b60b1),_0xe92aad=JSON[_0x31c00c(0x13a)](_0x716c5b[_0x31c00c(0x27b)][_0x31c00c(0x22c)]()[_0x31c00c(0x1d6)](/```json|```/g,'')['trim']());_0xe92aad[_0x31c00c(0x176)]&&(await _0x105c67[_0x31c00c(0x1a5)](LTM_DP_DRIFT_STATUS,{'val':_0xe92aad['baselineDrift'],'ack':!![]}),await _0x105c67['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0xe92aad[_0x31c00c(0x205)],'ack':!![]}),await _0x105c67[_0x31c00c(0x1a5)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x40db10){}}function setupLtmScheduler(_0x4d0f56){const _0x420647=a0_0x442fc5;try{if(_0x4d0f56[_0x420647(0x13e)])_0x4d0f56[_0x420647(0x13e)][_0x420647(0x230)]();if(!_0x4d0f56[_0x420647(0x171)]){_0x4d0f56[_0x420647(0x1a5)](LTM_DP_STATUS,{'val':_0x420647(0x2bb),'ack':!![]});return;}_0x4d0f56[_0x420647(0x13e)]=schedule[_0x420647(0x2f6)](LTM_SCHEDULE,()=>createDailyDigest(_0x4d0f56));}catch(_0x89ef2d){_0x4d0f56[_0x420647(0x279)][_0x420647(0x254)]('LTM\x20Sched\x20Error:\x20'+_0x89ef2d[_0x420647(0x2bd)]);}}function setupModeResetScheduler(_0xa2066){const _0x411968=a0_0x442fc5;try{if(_0xa2066[_0x411968(0x2b1)])_0xa2066['modeResetJob']['cancel']();_0xa2066[_0x411968(0x2b1)]=schedule[_0x411968(0x2f6)](MODE_RESET_SCHEDULE,async()=>{const _0x3e5bd2=_0x411968;await loadSystemMode(_0xa2066),AUTO_RESET_MODES['includes'](_0xa2066['currentSystemMode'])&&await _0xa2066['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3e5bd2(0x18a)],'ack':![]});});}catch(_0x1ecd55){_0xa2066[_0x411968(0x279)][_0x411968(0x254)](_0x411968(0x150)+_0x1ecd55[_0x411968(0x2bd)]);}}function setupDriftAnalysisScheduler(_0x5136d7){const _0x593a08=a0_0x442fc5;try{if(_0x5136d7[_0x593a08(0x139)])clearInterval(_0x5136d7[_0x593a08(0x139)]);if(!_0x5136d7[_0x593a08(0x171)])return;_0x5136d7['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x5136d7),(_0x5136d7[_0x593a08(0x1c1)][_0x593a08(0x1ff)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x5136d7),0x1388);}catch(_0x467075){_0x5136d7[_0x593a08(0x279)]['error'](_0x593a08(0x1ae)+_0x467075[_0x593a08(0x2bd)]);}}function setupBriefingScheduler(_0x216c93){const _0xb34bbb=a0_0x442fc5;try{if(_0x216c93[_0xb34bbb(0x1bb)])_0x216c93[_0xb34bbb(0x1bb)]['cancel']();if(!_0x216c93[_0xb34bbb(0x1c1)][_0xb34bbb(0x2d9)])return;const _0x506d7c=(_0x216c93[_0xb34bbb(0x1c1)][_0xb34bbb(0x24d)]||_0xb34bbb(0x259))[_0xb34bbb(0x295)](':'),_0x4717cd=parseInt(_0x506d7c[0x0])||0x8,_0xf2f7f4=parseInt(_0x506d7c[0x1])||0x0,_0x28d3ed=_0xf2f7f4+'\x20'+_0x4717cd+_0xb34bbb(0x22f);_0x216c93[_0xb34bbb(0x279)]['info'](_0xb34bbb(0x119)+_0x4717cd+':'+(_0xf2f7f4<0xa?'0'+_0xf2f7f4:_0xf2f7f4)),_0x216c93[_0xb34bbb(0x1bb)]=schedule['scheduleJob'](_0x28d3ed,()=>{sendMorningBriefing(_0x216c93);});}catch(_0x22fe33){_0x216c93['log'][_0xb34bbb(0x254)](_0xb34bbb(0x26a)+_0x22fe33[_0xb34bbb(0x2bd)]);}}async function sendNotification(_0x1b4053,_0x574ace,_0xa12a4a=![],_0x4aad25=![]){const _0x21fd3b=a0_0x442fc5;_0x1b4053[_0x21fd3b(0x279)][_0x21fd3b(0x1d4)]((_0xa12a4a?_0x21fd3b(0x163):'')+_0x21fd3b(0x20d)+_0x574ace+'\x22');const _0x477859=_0x1b4053['config'];let _0x211bb2=0x0;if(_0x477859[_0x21fd3b(0x2f4)]){let _0x12e0c9={};(_0x574ace['includes'](_0x21fd3b(0x20f))||_0x4aad25)&&(_0x12e0c9={'reply_markup':{'inline_keyboard':[[{'text':_0x21fd3b(0x2bf),'callback_data':_0x21fd3b(0x1ba)}],[{'text':_0x21fd3b(0x262),'callback_data':_0x21fd3b(0x25d)}]]}}),await _0x1b4053[_0x21fd3b(0x121)](_0x477859['notifyTelegramInstance'],_0x21fd3b(0x296),{'text':_0x574ace,'user':_0x477859[_0x21fd3b(0x25f)],..._0x12e0c9}),_0x211bb2++;}if(_0x477859[_0x21fd3b(0x209)]){let _0x59be40={'message':_0x574ace,'title':_0x4aad25?_0x21fd3b(0x16b):_0x21fd3b(0x2ff),'priority':_0x4aad25?0x2:0x1,'device':_0x477859['notifyPushoverRecipient']};_0x4aad25&&(_0x59be40[_0x21fd3b(0x235)]=0x1e,_0x59be40[_0x21fd3b(0x134)]=0xe10,_0x59be40['sound']=_0x21fd3b(0x113)),await _0x1b4053[_0x21fd3b(0x121)](_0x477859[_0x21fd3b(0x123)],_0x21fd3b(0x296),_0x59be40),_0x211bb2++;}return _0x477859[_0x21fd3b(0x306)]&&(await _0x1b4053[_0x21fd3b(0x121)](_0x477859[_0x21fd3b(0x1c2)],_0x21fd3b(0x296),{'text':_0x574ace,'to':_0x477859[_0x21fd3b(0x199)]}),_0x211bb2++),_0x211bb2;}async function setupTelegramListener(_0x115628){const _0x399a49=a0_0x442fc5,_0x27a8d2=_0x115628[_0x399a49(0x1c1)][_0x399a49(0x117)];_0x115628['config'][_0x399a49(0x2f4)]&&_0x27a8d2&&(_0x115628[_0x399a49(0x279)][_0x399a49(0x1d4)]('üì°\x20Hooking\x20into\x20'+_0x27a8d2+_0x399a49(0x135)),await _0x115628[_0x399a49(0x2a2)](_0x27a8d2+_0x399a49(0x236)));}async function handleTelegramResponse(_0x45f5b7,_0x213997){const _0x43b6ce=a0_0x442fc5;let _0x22818b=_0x213997;_0x213997['startsWith']('[')&&(_0x22818b=_0x213997[_0x43b6ce(0x1a0)](_0x213997[_0x43b6ce(0x10d)](']')+0x1));if(_0x22818b===_0x43b6ce(0x1ba))_0x45f5b7['log'][_0x43b6ce(0x1d4)](_0x43b6ce(0x131)),await _0x45f5b7['setStateAsync'](_0x43b6ce(0x17c),{'val':![],'ack':!![]}),await _0x45f5b7['setStateAsync'](_0x43b6ce(0x1e8),{'val':'Vom\x20Benutzer\x20best√§tigt\x20(OK).','ack':!![]}),_0x45f5b7['lastAlertState']=![],sendNotification(_0x45f5b7,_0x43b6ce(0x203),![]);else _0x22818b==='COGNI_REQUEST_CALL'&&(_0x45f5b7[_0x43b6ce(0x279)][_0x43b6ce(0x1f0)](_0x43b6ce(0x10a)),sendNotification(_0x45f5b7,_0x43b6ce(0x1fc),![],!![]));}async function runAutopilot(_0x4da4cb){const _0x4df953=a0_0x442fc5,_0x48746b=_0x4da4cb[_0x4df953(0x1c1)]['inactivityThresholdHours'],_0x3c204e=_0x4da4cb[_0x4df953(0x2b0)][_0x4df953(0x13f)]>0x0?_0x4da4cb[_0x4df953(0x2b0)][0x0][_0x4df953(0x1e5)]:Date['now'](),_0x2f88f8=(Date[_0x4df953(0x258)]()-_0x3c204e)/(0x3e8*0x3c*0x3c);let _0x16726c='';_0x4da4cb[_0x4df953(0x1c1)][_0x4df953(0x1c7)]&&_0x4da4cb['currentSystemMode']===SYSTEM_MODES['NORMAL']&&_0x4da4cb[_0x4df953(0x22a)]&&(_0x2f88f8>_0x48746b&&(_0x16726c='HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0x2f88f8[_0x4df953(0x220)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0x4da4cb,_0x16726c)[_0x4df953(0x24c)](_0x49bac6=>_0x4da4cb[_0x4df953(0x279)][_0x4df953(0x254)](_0x49bac6));}async function createDailyDigest(_0x4e8ddf){const _0xdabee0=a0_0x442fc5;if(!_0x4e8ddf[_0xdabee0(0x171)])return;await _0x4e8ddf[_0xdabee0(0x1a5)](LTM_DP_STATUS,{'val':_0xdabee0(0x28e)+new Date()[_0xdabee0(0x285)](),'ack':!![]});if(!_0x4e8ddf['geminiModel']||_0x4e8ddf[_0xdabee0(0x1fa)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4e8ddf[_0xdabee0(0x1a5)](LTM_DP_STATUS,{'val':_0xdabee0(0x2d3),'ack':!![]});return;}const _0x5d1b96=JSON['parse'](JSON['stringify'](_0x4e8ddf[_0xdabee0(0x1fa)])),_0xc141c6=_0x5d1b96[_0xdabee0(0x13f)],_0x18457a=_0xdabee0(0x174)+JSON['stringify'](_0x5d1b96);try{const _0x4e37e4=await _0x4e8ddf[_0xdabee0(0x161)][_0xdabee0(0x14e)](_0x18457a),_0x3bac15=JSON[_0xdabee0(0x13a)](_0x4e37e4[_0xdabee0(0x27b)][_0xdabee0(0x22c)]()[_0xdabee0(0x1d6)](/```json|```/g,'')[_0xdabee0(0x1be)]());_0x3bac15[_0xdabee0(0x2ca)]&&(_0x4e8ddf[_0xdabee0(0x2c2)][_0xdabee0(0x221)]({'timestamp':new Date()['toISOString'](),'eventCount':_0xc141c6,'summary':_0x3bac15[_0xdabee0(0x2ca)],'activityLevel':_0x3bac15[_0xdabee0(0x1c3)],'systemMode':_0x4e8ddf[_0xdabee0(0x255)]}),await saveDailyDigests(_0x4e8ddf),_0x4e8ddf[_0xdabee0(0x1fa)]=[],await saveRawEventLog(_0x4e8ddf),await _0x4e8ddf[_0xdabee0(0x1a5)](LTM_DP_STATUS,{'val':_0xdabee0(0x263)+_0xc141c6+_0xdabee0(0x2eb),'ack':!![]}),runPythonHealthCheck(_0x4e8ddf));}catch(_0x15bfe0){await _0x4e8ddf['setStateAsync'](LTM_DP_STATUS,{'val':'Error:\x20'+_0x15bfe0['message'],'ack':!![]});}}async function sendMorningBriefing(_0x7f2d50){const _0x448438=a0_0x442fc5;if(!_0x7f2d50[_0x448438(0x161)])return;_0x7f2d50[_0x448438(0x279)][_0x448438(0x1d4)]('Generating\x20Morning\x20Briefing...');const _0x4145a9=_0x7f2d50[_0x448438(0x2c2)][_0x448438(0x13f)]>0x0?_0x7f2d50[_0x448438(0x2c2)][_0x7f2d50[_0x448438(0x2c2)][_0x448438(0x13f)]-0x1]:null,_0x50b6c3=_0x4145a9&&_0x4145a9[_0x448438(0x281)]?_0x4145a9[_0x448438(0x281)][_0x448438(0x195)]:_0x448438(0x1ac),_0x56a20d=new Date();_0x56a20d[_0x448438(0x25c)](0x4,0x0,0x0,0x0);const _0x3783e6=_0x7f2d50['eventHistory'][_0x448438(0x29b)](_0x2d44f8=>new Date(_0x2d44f8[_0x448438(0x1e5)])>_0x56a20d),_0x1654e=PERSONA_MAPPING[_0x7f2d50[_0x448438(0x1c1)][_0x448438(0x2b2)]||_0x448438(0x147)],_0x566aec=_0x7f2d50[_0x448438(0x1c1)][_0x448438(0x177)]||'',_0xa494e2=await getWeatherContext(_0x7f2d50),_0x2ed648=await getCalendarContext(_0x7f2d50),_0x513c4a='ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20'+_0x1654e+'.\x20KONTEXT:\x20'+_0x566aec+'.\x20ZUSATZ:\x20'+_0xa494e2+'\x20'+_0x2ed648+_0x448438(0x300)+_0x50b6c3+_0x448438(0x18e)+JSON['stringify'](_0x3783e6[_0x448438(0x2a1)](0x0,0xa))+_0x448438(0x1b6);try{const _0x5e8a37=await _0x7f2d50['geminiModel']['generateContent'](_0x513c4a),_0x48ba7d=_0x448438(0x2ea)+_0x5e8a37[_0x448438(0x27b)]['text']()[_0x448438(0x1be)]();sendNotification(_0x7f2d50,_0x48ba7d),_0x7f2d50[_0x448438(0x279)][_0x448438(0x1d4)](_0x448438(0x273));}catch(_0x2eae58){_0x7f2d50[_0x448438(0x279)]['error'](_0x448438(0x2d1)+_0x2eae58['message']);}}async function scanForDevices(_0x54fb65,_0x3c4cb8){const _0x5a5034=a0_0x442fc5;_0x54fb65[_0x5a5034(0x279)][_0x5a5034(0x1d4)](_0x5a5034(0x2e5));const _0xce65c0=[],_0x42ac0e=await _0x54fb65[_0x5a5034(0x140)]('*'),_0x4e3f1b=await _0x54fb65[_0x5a5034(0x140)](_0x5a5034(0x190),'enum'),_0x5ce21e=await _0x54fb65[_0x5a5034(0x140)](_0x5a5034(0x2d7),_0x5a5034(0x10e)),_0xd478a1={};if(_0x4e3f1b)for(const _0x397a68 in _0x4e3f1b){const _0x2fc3f5=_0x4e3f1b[_0x397a68][_0x5a5034(0x29e)][_0x5a5034(0x26c)]||[];_0x2fc3f5[_0x5a5034(0x166)](_0x1ab447=>{const _0x270dcc=_0x5a5034;if(!_0xd478a1[_0x1ab447])_0xd478a1[_0x1ab447]=[];_0xd478a1[_0x1ab447][_0x270dcc(0x221)](_0x397a68);});}const _0x295feb={};if(_0x5ce21e)for(const _0x15ebd3 in _0x5ce21e){const _0x50a890=_0x5ce21e[_0x15ebd3][_0x5a5034(0x29e)][_0x5a5034(0x26c)]||[],_0x431546=typeof _0x5ce21e[_0x15ebd3][_0x5a5034(0x29e)]['name']===_0x5a5034(0x25a)?_0x5ce21e[_0x15ebd3][_0x5a5034(0x29e)][_0x5a5034(0x138)]['de']:_0x5ce21e[_0x15ebd3][_0x5a5034(0x29e)][_0x5a5034(0x138)];_0x50a890[_0x5a5034(0x166)](_0x42a0c1=>_0x295feb[_0x42a0c1]=_0x431546);}const _0x2ae42e=_0x3c4cb8[_0x5a5034(0x18c)]||[],_0x22486e=_0x3c4cb8['motion']!==![],_0x5c4ae1=_0x3c4cb8[_0x5a5034(0x24a)]!==![],_0x5d59db=_0x3c4cb8[_0x5a5034(0x116)]!==![],_0x4bfbad=_0x3c4cb8[_0x5a5034(0x1d2)]===!![],_0x43a187=_0x3c4cb8[_0x5a5034(0x28b)]===!![];for(const _0x3ea55d in _0x42ac0e){const _0x131aa4=_0x42ac0e[_0x3ea55d];if(_0x131aa4[_0x5a5034(0x1c4)]!==_0x5a5034(0x13c)||!_0x131aa4[_0x5a5034(0x29e)])continue;if(ADAPTER_BLACKLIST['some'](_0x3e1d06=>_0x3ea55d['startsWith'](_0x3e1d06))&&!_0x43a187)continue;const _0x41df9b=(_0x131aa4['common']['role']||'')['toLowerCase']();let _0x19a4ee=(typeof _0x131aa4[_0x5a5034(0x29e)]['name']===_0x5a5034(0x25a)?_0x131aa4[_0x5a5034(0x29e)][_0x5a5034(0x138)]['de']:_0x131aa4[_0x5a5034(0x29e)][_0x5a5034(0x138)])||_0x3ea55d;const _0x3ed4fa=_0x19a4ee['toLowerCase']();let _0x1879f9=![],_0x485213=![];if(_0x2ae42e[_0x5a5034(0x13f)]>0x0){const _0x36f027=_0xd478a1[_0x3ea55d]||[],_0x41c22e=_0x3ea55d[_0x5a5034(0x295)]('.')['slice'](0x0,-0x1)[_0x5a5034(0x2b6)]('.'),_0x441c6c=_0xd478a1[_0x41c22e]||[];(_0x36f027[_0x5a5034(0x137)](_0x21eb2c=>_0x2ae42e[_0x5a5034(0x2aa)](_0x21eb2c))||_0x441c6c[_0x5a5034(0x137)](_0x20bbbf=>_0x2ae42e[_0x5a5034(0x2aa)](_0x20bbbf)))&&(_0x1879f9=!![],_0x485213=!![]);}if(!_0x1879f9&&!_0x43a187){if(HARD_IGNORE_TERMS[_0x5a5034(0x137)](_0x39f9e5=>_0x3ea55d[_0x5a5034(0x2aa)](_0x39f9e5)||_0x3ed4fa[_0x5a5034(0x2aa)](_0x39f9e5[_0x5a5034(0x20e)]())))continue;}if(BAD_NAMES[_0x5a5034(0x137)](_0x268f5c=>_0x3ed4fa===_0x268f5c||_0x3ed4fa[_0x5a5034(0x159)]('.'+_0x268f5c))){const _0x4d048a=_0x3ea55d['split']('.');if(_0x4d048a[_0x5a5034(0x13f)]>0x2){const _0x56e06e=_0x4d048a[_0x5a5034(0x2a1)](0x0,-0x1)[_0x5a5034(0x2b6)]('.'),_0x3f027b=_0x42ac0e[_0x56e06e];if(_0x3f027b&&_0x3f027b['common']&&_0x3f027b[_0x5a5034(0x29e)]['name']){const _0x4d6ec9=typeof _0x3f027b[_0x5a5034(0x29e)]['name']===_0x5a5034(0x25a)?_0x3f027b[_0x5a5034(0x29e)][_0x5a5034(0x138)]['de']:_0x3f027b[_0x5a5034(0x29e)][_0x5a5034(0x138)];_0x4d6ec9&&!_0x19a4ee['includes'](_0x4d6ec9)&&(_0x19a4ee=_0x4d6ec9+'\x20'+_0x19a4ee);}}}let _0x2064f5='';if(_0x22486e&&(_0x41df9b['includes'](_0x5a5034(0x2da))||_0x41df9b[_0x5a5034(0x2aa)](_0x5a5034(0x173))||_0x3ed4fa[_0x5a5034(0x2aa)]('bewegung')||_0x3ed4fa[_0x5a5034(0x2aa)](_0x5a5034(0x30c))))_0x2064f5=_0x5a5034(0x2da);else{if(!_0x2064f5&&_0x5c4ae1&&(_0x41df9b[_0x5a5034(0x2aa)]('door')||_0x41df9b['includes'](_0x5a5034(0x21a))||_0x41df9b[_0x5a5034(0x2aa)](_0x5a5034(0x1bf))||_0x41df9b[_0x5a5034(0x2aa)](_0x5a5034(0x256))||_0x41df9b[_0x5a5034(0x2aa)](_0x5a5034(0x23d))||_0x3ed4fa[_0x5a5034(0x2aa)](_0x5a5034(0x25b))||_0x3ed4fa[_0x5a5034(0x2aa)](_0x5a5034(0x261))||_0x3ed4fa[_0x5a5034(0x2aa)](_0x5a5034(0x286))))_0x2064f5=_0x5a5034(0x178);else{if(!_0x2064f5&&_0x5d59db&&(_0x41df9b['includes'](_0x5a5034(0x2ae))||_0x41df9b[_0x5a5034(0x2aa)]('switch')||_0x41df9b[_0x5a5034(0x2aa)]('dimmer')||_0x3ed4fa[_0x5a5034(0x2aa)](_0x5a5034(0x141))||_0x3ed4fa['includes']('lampe')||_0x3ed4fa['includes']('schalter'))){if(_0x131aa4[_0x5a5034(0x29e)][_0x5a5034(0x1f9)]||_0x41df9b['includes']('sensor'))_0x2064f5=_0x5a5034(0x2ae);}else{if(!_0x2064f5&&_0x4bfbad&&(_0x41df9b[_0x5a5034(0x2aa)](_0x5a5034(0x1d2))||_0x41df9b[_0x5a5034(0x2aa)]('humidity')||_0x41df9b['includes'](_0x5a5034(0x115))||_0x3ed4fa['includes'](_0x5a5034(0xfe))||_0x3ed4fa[_0x5a5034(0x2aa)](_0x5a5034(0x228))||_0x3ed4fa[_0x5a5034(0x2aa)](_0x5a5034(0x11d))))_0x2064f5=_0x5a5034(0x1d2);else{if(!_0x2064f5&&_0x485213)_0x2064f5='custom';}}}}if(_0x2064f5){let _0x3ad37e=_0x295feb[_0x3ea55d]||'';if(!_0x3ad37e){let _0x496d83=_0x3ea55d;for(let _0x4025b3=0x0;_0x4025b3<0x3;_0x4025b3++){const _0x8d24bc=_0x496d83['lastIndexOf']('.');if(_0x8d24bc===-0x1)break;_0x496d83=_0x496d83[_0x5a5034(0x1a0)](0x0,_0x8d24bc);if(_0x295feb[_0x496d83]){_0x3ad37e=_0x295feb[_0x496d83];break;}}}_0xce65c0[_0x5a5034(0x221)]({'id':_0x3ea55d,'name':_0x19a4ee,'location':_0x3ad37e,'type':_0x2064f5,'logDuplicates':_0x2064f5===_0x5a5034(0x2da),'isExit':![],'_score':_0x3ad37e?0x50:_0x2064f5==='custom'?0x5a:0x28});}}return _0xce65c0[_0x5a5034(0x1bd)]((_0x402220,_0x2e896a)=>_0x2e896a[_0x5a5034(0x1de)]-_0x402220[_0x5a5034(0x1de)]),_0xce65c0;}async function executeAutomationAction(_0x5d059d){const _0x3c3097=a0_0x442fc5;try{const _0x18331b=await _0x5d059d[_0x3c3097(0x12d)](_0x3c3097(0x1c5)),_0x1e4e4c=await _0x5d059d[_0x3c3097(0x12d)]('analysis.automation.targetValue');if(_0x18331b&&_0x18331b[_0x3c3097(0x1e3)]&&_0x1e4e4c){const _0x380fe7=_0x18331b[_0x3c3097(0x1e3)];let _0x2a2ae0=_0x1e4e4c['val'];try{_0x2a2ae0=JSON[_0x3c3097(0x13a)](_0x2a2ae0);}catch(_0x5dc61b){}_0x5d059d[_0x3c3097(0x279)][_0x3c3097(0x1d4)](_0x3c3097(0x23a)+_0x380fe7+'\x20=\x20'+_0x2a2ae0),await _0x5d059d[_0x3c3097(0x27a)](_0x380fe7,_0x2a2ae0);}else _0x5d059d['log'][_0x3c3097(0x1f0)](_0x3c3097(0x11c));}catch(_0x45d68b){_0x5d059d[_0x3c3097(0x279)][_0x3c3097(0x254)]('BUTLER\x20Execution\x20Error:\x20'+_0x45d68b[_0x3c3097(0x2bd)]);}}function tryParse(_0x432f69){const _0x34832b=a0_0x442fc5;try{return JSON[_0x34832b(0x13a)](_0x432f69);}catch(_0x30d6){return null;}}async function recordSequence(_0x365326,_0xa893d3){const _0x3356d7=a0_0x442fc5,_0x191835=(_0xa893d3[_0x3356d7(0x1c4)]||'')['toLowerCase'](),_0x564e42=['motion','bewegung',_0x3356d7(0x30c),_0x3356d7(0x17f),_0x3356d7(0x173),_0x3356d7(0x178),'t√ºr',_0x3356d7(0x21a),_0x3356d7(0x25b),'contact',_0x3356d7(0x249),_0x3356d7(0x2ae),_0x3356d7(0x141),_0x3356d7(0x280),'schalter','dimmer',_0x3356d7(0x274)];if(!_0x564e42[_0x3356d7(0x137)](_0x423c71=>_0x191835['includes'](_0x423c71))){_0x365326[_0x3356d7(0x279)][_0x3356d7(0x2cb)](_0x3356d7(0x21e)+_0xa893d3['id']+'\x20(Type\x20\x27'+_0xa893d3[_0x3356d7(0x1c4)]+_0x3356d7(0x1dd));return;}if(!_0xa893d3['value']){_0x365326['log'][_0x3356d7(0x2cb)](_0x3356d7(0x21e)+_0xa893d3['id']+_0x3356d7(0x19e)+_0xa893d3[_0x3356d7(0x1df)]+')');return;}_0x365326[_0x3356d7(0x279)][_0x3356d7(0x2cb)](_0x3356d7(0x29f)+_0xa893d3['id']+'\x20('+_0xa893d3['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x319cfc={'loc':_0xa893d3[_0x3356d7(0x243)]||'Unknown','id':_0xa893d3['id'],'ts':Date['now']()};activeSequence[_0x3356d7(0x221)](_0x319cfc),_0x365326[_0x3356d7(0x279)][_0x3356d7(0x2cb)](_0x3356d7(0x208)+_0x319cfc['loc']+_0x3356d7(0x2b8)+activeSequence[_0x3356d7(0x13f)]+')'),sequenceTimer=setTimeout(async()=>{const _0x3850b4=_0x3356d7;activeSequence[_0x3850b4(0x13f)]>0x1?await saveCompletedSequence(_0x365326):(_0x365326[_0x3850b4(0x279)][_0x3850b4(0x2cb)](_0x3850b4(0x2f8)+activeSequence[_0x3850b4(0x13f)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0xf9cd2f){const _0x2c2d20=a0_0x442fc5;try{_0xf9cd2f['log']['info'](_0x2c2d20(0x2a0)+activeSequence[_0x2c2d20(0x13f)]+_0x2c2d20(0xfb));const _0x1b854f=await _0xf9cd2f[_0x2c2d20(0x12d)](_0x2c2d20(0x12b));let _0x179dac=[];if(_0x1b854f&&_0x1b854f[_0x2c2d20(0x1e3)])try{_0x179dac=JSON[_0x2c2d20(0x13a)](_0x1b854f[_0x2c2d20(0x1e3)]);}catch(_0x339a45){}const _0x4f9709=activeSequence[0x0]['ts'],_0x346f8d=activeSequence[_0x2c2d20(0x238)](_0x5cb11b=>({'loc':_0x5cb11b[_0x2c2d20(0x1f7)],'t_delta':Math[_0x2c2d20(0x298)]((_0x5cb11b['ts']-_0x4f9709)/0x3e8)})),_0x250496={'timestamp':new Date(_0x4f9709)[_0x2c2d20(0x1dc)](),'steps':_0x346f8d,'duration':Math[_0x2c2d20(0x298)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x4f9709)/0x3e8),'daytime':new Date(_0x4f9709)[_0x2c2d20(0x1cb)]()};_0x179dac[_0x2c2d20(0x221)](_0x250496),_0x179dac[_0x2c2d20(0x13f)]>MAX_TRAINING_SET_SIZE&&_0x179dac['shift'](),await _0xf9cd2f[_0x2c2d20(0x1a5)](_0x2c2d20(0x12b),{'val':JSON[_0x2c2d20(0x277)](_0x179dac),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x4ae6da){_0xf9cd2f[_0x2c2d20(0x279)][_0x2c2d20(0x254)](_0x2c2d20(0x231)+_0x4ae6da[_0x2c2d20(0x2bd)]);}}async function getOutsideTemperatureNumeric(_0xd64e24){const _0x1249a5=a0_0x442fc5;if(_0xd64e24[_0x1249a5(0x1c1)][_0x1249a5(0x26b)])try{const _0x444690=await _0xd64e24[_0x1249a5(0x2dd)](_0xd64e24['config']['outdoorSensorId']);if(_0x444690&&_0x444690['val']!==undefined&&_0x444690[_0x1249a5(0x1e3)]!==null){const _0x341bd0=parseFloat(_0x444690[_0x1249a5(0x1e3)]);if(!isNaN(_0x341bd0))return _0x341bd0;}}catch(_0x44a08a){_0xd64e24['log'][_0x1249a5(0x1f0)](_0x1249a5(0x1b3)+_0xd64e24[_0x1249a5(0x1c1)][_0x1249a5(0x26b)]+':\x20'+_0x44a08a[_0x1249a5(0x2bd)]);}const _0x3668df=_0xd64e24[_0x1249a5(0x1c1)]['weatherInstance'];if(!_0xd64e24[_0x1249a5(0x1c1)][_0x1249a5(0x28f)]||!_0x3668df)return null;try{let _0x4ce32d='';if(_0x3668df[_0x1249a5(0x2aa)]('accuweather'))_0x4ce32d=_0x3668df+_0x1249a5(0x175);else{if(_0x3668df[_0x1249a5(0x2aa)](_0x1249a5(0x1d7)))_0x4ce32d=_0x3668df+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x3668df[_0x1249a5(0x2aa)]('openweathermap'))_0x4ce32d=_0x3668df+'.forecast.current.temperature';else{if(_0x3668df[_0x1249a5(0x2aa)](_0x1249a5(0x28d)))_0x4ce32d=_0x3668df+_0x1249a5(0x185);}}}if(_0x4ce32d){const _0x44bc2d=await _0xd64e24[_0x1249a5(0x2dd)](_0x4ce32d);if(_0x44bc2d&&_0x44bc2d[_0x1249a5(0x1e3)]!==undefined&&_0x44bc2d[_0x1249a5(0x1e3)]!==null)return parseFloat(_0x44bc2d[_0x1249a5(0x1e3)]);}}catch(_0x4df9e6){}return null;}async function recordThermodynamics(_0x502561,_0x5bd113,_0x2ef6ec,_0x53a33a){const _0x29de12=a0_0x442fc5,_0x1e0d1f=await getOutsideTemperatureNumeric(_0x502561),_0x5edd14=await _0x502561[_0x29de12(0x12d)](_0x29de12(0xfc));let _0x29940a=[];if(_0x5edd14&&_0x5edd14['val'])try{_0x29940a=JSON[_0x29de12(0x13a)](_0x5edd14[_0x29de12(0x1e3)]);}catch(_0x4a3982){}_0x29940a[_0x29de12(0x221)]({'ts':Date[_0x29de12(0x258)](),'room':_0x53a33a||_0x29de12(0x2b5),'t_in':_0x2ef6ec,'t_out':_0x1e0d1f});if(_0x29940a['length']>THERMO_LOG_SIZE)_0x29940a[_0x29de12(0x1cc)]();await _0x502561[_0x29de12(0x1a5)](_0x29de12(0xfc),{'val':JSON['stringify'](_0x29940a),'ack':!![]});}function a0_0x3bdc(){const _0x55b197=['system.presenceWho','loc','stdin','write','rawEventLog','Failed\x20to\x20send\x20to\x20Python:\x20','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','weatherInstance','Trend\x20Value\x20(%)','ltmDriftCheckIntervalHours','‚úÖ\x20PRO\x20ACTIVATED','2tzXTcI','unreach','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','testApiKey','driftDetails','TREND_RESULT','kill','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','notifyPushoverEnabled','\x20min).','Trigger\x20Briefing\x20(Test)','path','Sending\x20notification:\x20\x22','toLowerCase','Alarm','Aktiv\x20(','Event\x20History','analysis.deviationFromBaseline','version','targetposition','‚ùå\x20FREE\x20MODE','üêç\x20Starting\x20Python\x20Sidecar:\x20','.\x0a\x20\x20\x20\x20WETTER:\x20','application/json','[PYTHON\x20ERR]\x20','window','isExit','openweathermap.0','Lernphase\x20(','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','toFixed','push','PARTY','isAlert','minDaysForBaseline','LTM.driftAnalysis.baselineDrift','channel','useCalendar','klima','system.','isPresent','3357kcrAaY','text','actual_temperature','analysis.comfortSummary','\x20*\x20*\x20*','cancel','[RECORDER]\x20Error\x20saving\x20sequence:\x20','Trigger\x20Action\x20Now','instance','Error\x20in\x20onMessage\x20command\x20','retry','.communicate.request','üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','map','triggerBriefing','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','LTM.driftAnalysis.lastCheck','startsWith','shutter','No\x20instance','\x20=\x20','dutycycle','flot.','Comfort\x20Summary','location','\x22\x20--break-system-packages','LTM.driftAnalysis.driftDetails','Who\x20is\x20present?','indicator','guest','kontakt','doors','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','catch','briefingTime','analysis.automation.targetValue','update','time','simple-api.','value.health','getEnums','error','currentSystemMode','blind','toString','now','08:00','object','fenster','setHours','COGNI_REQUEST_CALL','getForeignObjectAsync','notifyTelegramRecipient','sensorLastValues','t√ºr','üìû\x20R√ºckruf\x20anfordern','Success:\x20Compressed\x20','ML-Libs\x20fehlen','analysis.health','‚ö†Ô∏è\x20PIP\x20is\x20missing!\x20Attempting\x20self-healing\x20via\x20APT...','analysis.automation.autoApply',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','level','Briefing\x20Sched\x20Error:\x20','outdoorSensorId','members','0\x203\x20*\x20*\x20*','WETTER:\x20','Missing\x20data','ltmLtbWindowDays','onMessage','isGracePeriodActive','Morning\x20Briefing\x20sent.','lampe','testNotification','[LICENSE\x20CHECK]\x20Key\x20present:\x20','stringify','targetValue','log','setForeignStateAsync','response','working','daswetter.0','GUEST','getCalendarNames','switch','health','ack','analysis.activitySummary','‚ùå\x20CRITICAL:\x20Self-healing\x20failed.\x20Please\x20run\x20manually:\x20','toLocaleString','rollladen','echarts.','318831JhsDpm','(((.+)+)+)+$','data','weather','analysis.comfortSuggestion','weatherunderground','Started\x20at\x20','useWeather','Details:\x20','Event\x20received:\x20','getTime','setState','search','split','send','json','round','AI\x20Emergency\x20Status','analysis.automation.description','filter','uuid','Target\x20ID','common','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','slice','subscribeForeignStatesAsync','exitTimer','WETTER\x20ERROR:\x20','onReady','position','systemUUID','4015255vfJEhn','Urlaub','includes','Subscribing\x20to\x20','Last\x20Result','Sleep\x20Score\x20(0-100)','light','boolean','eventHistory','modeResetJob','aiPersona','Trigger\x20Digest','.Summary.Current','Unknown','join','getMonth','\x20(Length:\x20','992557zUWFDv','child_process','Deaktiviert\x20(Pro-Feature)','analysis.health.trendDiagnosis','message','[RESULT]','‚úÖ\x20Alles\x20OK\x20(Reset)','Kein\x20API\x20Key!','dismissAutomation','dailyDigests','analysis.health.sleepScore','PONG','analysis.feedbackHistory','sudo\x20apt-get\x20update\x20&&\x20sudo\x20apt-get\x20install\x20-y\x20python3-pip','.data.table','genAI','üêç\x20Stopping\x20Python\x20Sidecar...','summary','debug','pythonProcess','delObjectAsync','Starting\x20Autopilot\x20(','calendarInstance','LTM.rawEventLog','Briefing\x20Error:\x20','‚úÖ\x20PIP\x20installed\x20successfully.\x20Retrying\x20dependencies...','Skipped\x20(No\x20AI\x20or\x20Data)','LTM.baselineStatus','systemConfig','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','enum.rooms.*','PRIORIT√ÑT:\x20Sicherheit.','briefingEnabled','motion','javascript.','button','getForeignStateAsync','system.mode','stick_unreach','values','...','Health\x20Notes','python3\x20-m\x20pip\x20install\x20-r\x20\x22','material.','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','Automation\x20Proposals','.NextHours.Location_1.Day_1.current.symbol_desc','Adapter','bind','üåÖ\x20Daily\x20Briefing:\x0a','\x20events','LTM','callback','Feedback\x20saved:\x20','string','Deviation','presenceDevices','icons-mfd.','No\x20module\x20named\x20pip','notifyTelegramEnabled','geminiApiKey','scheduleJob','lastCheck','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','cogni-living\x20adapter\x20starting\x20(v','Restoring\x20sensor\x20cache\x20from\x20history\x20(','ANALYZE_TREND','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','energy','LTM.dailyDigests','Cogni-Living','.\x20DATEN:\x20Schlaf\x20','ltmStbWindowDays','getOverviewData','automationProposal','scriptEnabled','Comfort\x20Suggestion','notifyEmailEnabled','[PYTHON]\x20','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','indicator.alarm.fire','KALENDER:\x20Keine\x20Daten','Raw\x20Log','pr√§senz','Say\x20Hello','maintenance','getObjectAsync','.\x0a\x20\x20\x20\x20KONTEXT:\x20',').\x20Saving\x20to\x20Training\x20Data.','LTM.trainingData.thermodynamics','fill','temp','8uTBfoP','Action','simulateButler','LTM.driftAnalysis','Kein\x20API\x20Key\x20eingegeben.','Target\x20Value','inactivityThresholdHours','scanDevices','onStateChange','analysis.health.trendValue','requirements.txt','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','@google/generative-ai','from','indexOf','enum','AI\x20Alert\x20Status','IGNORING\x20DUPLICATE\x20(Cached):\x20','analysis.trigger','pop','siren','payload','thermostat','lights','notifyTelegramInstance','latitude','Scheduling\x20Morning\x20Briefing\x20for\x20','KI-Modell\x20nicht\x20initialisiert','python3','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','heizung','‚ö†Ô∏è\x20ALARM:\x20','analysis.automation','Normal','sendToAsync','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','notifyPushoverInstance','Analysiere\x20ausgewogen.','[LOG]','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','command','feedbackHistory','ical.0','admin.','LTM.trainingData.sequences','stateChange','getStateAsync','setpoint','vacation','isArray','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','weatherunderground.0','Kalender:\x20Deaktiviert','expire','\x20for\x20interactive\x20buttons...','firmware','some','name','driftAnalysisTimer','parse','Drift\x20Details','state','analysis.analysisHistory','ltmJob','length','getForeignObjectsAsync','licht','cogni-living','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','Entry\x20detected\x20via\x20','17096oaRfpl','Gemini\x20AI\x20initialized.','generic','native','setObjectNotExistsAsync','217NAyhvX','Last\x20Check','\x20|\x20','.forecast.current.state','generateContent','brightness','Reset\x20Sched\x20Error:\x20','writable','LTM.triggerDailyDigest','_calName','accuweather.0','off','analysis.lastResult','sendTo','triggerDailyDigest','endsWith','alertReason','Health\x20&\x20Sleep\x20Analysis','Drift\x20Status','Alert\x20Reason','set_temperature','uuid-not-found','lastAlertState','geminiModel','number','[TEST]\x20','extendObjectAsync','analysis.triggerBriefing','forEach','submitFeedback','User\x20dismissed\x20automation\x20proposal.','unload','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','üö®\x20EMERGENCY','description','temperatur','Thermodynamic\x20Data\x20Points','ready','config_pending','isProVersion','python_service','occupancy','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.Current.Temperature','baselineDrift','livingContext','door','calendarSelection','Gemini\x20Init\x20Error:\x20','Drift\x20Analysis','analysis.isAlert','\x20(Value:\x20','340188GoCvKA','presence','normal','Restlessness\x20Level','Description','licenseKey','Keiner','.forecast.current.temp','Gemini\x20Analysis\x20Error:\x20','analysis.health.restlessness','16213370kEiARZ','link_quality','NORMAL','namespace','selectedFunctionIds','history.','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','unshift','enum.functions.*','TEST-PRO-KEY','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','connection',').\x20Starting\x20Timer.','sleepScore','reachable','Party','\x20sensors...','notifyEmailRecipient','KALENDER:\x20Keine\x20relevanten\x20Termine','power','getLtmData','none','\x20(Value\x20is\x20falsy:\x20','KALENDER:\x20','substring','26930563odsuYa','fault','currentposition','Gast','setStateAsync','LTM.trainingData','targetId','Could\x20not\x20kill\x20Python\x20process:\x20','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','System\x20Mode','Logbook','N/A','splice','Drift\x20Sched\x20Error:\x20','isEmergency','subscribeStates','LTM.processingStatus','exports','Error\x20reading\x20outdoor\x20sensor\x20','events.history','analysis.health.notes','.\x20OUTPUT:\x20Nur\x20Text.','Exit\x20Sensor\x20triggered\x20(','dependencyInstallInProgress','event','COGNI_CONFIRM_OK','briefingJob','sudo\x20','sort','trim','lock','Fokus\x20auf\x20Familienroutinen.','config','notifyEmailInstance','activityLevel','type','analysis.automation.targetId','@iobroker/adapter-core','inactivityMonitoringEnabled','analysisHistory','events.history_debug_00','analysis.automation.triggerAction','getHours','shift','getCalendarNames\x20Error:\x20','detected','events.lastEvent','Auto\x20Apply\x20Rule','devices','temperature','Pattern\x20Detected','info','Activity-Level','replace','daswetter','getFullYear','Fokus\x20auf\x20Komfort.','rssi','cover','toISOString','\x27\x20not\x20in\x20allowed\x20list)','_score','value','status','info.','analysis.automation.suggestedAction','val','analysisTimer','timestamp','Error\x20checking\x20WiFi:\x20','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','analysis.alertReason','onUnload','party','N/A\x20(Learning)','constructor','Error\x20reading\x20calendar\x20table:\x20','accuweather','Daily\x20Digests','warn','Keine\x20Analyse.','exitGraceTimer','getGenerativeModel','analysis.automation.patternDetected','online'];a0_0x3bdc=function(){return _0x55b197;};return a0_0x3bdc();}function installPythonDependencies(_0x3801e3){const _0x4cb4b6=a0_0x442fc5;if(_0x3801e3[_0x4cb4b6(0x1b8)])return;_0x3801e3['dependencyInstallInProgress']=!![];const _0x158d8c=path[_0x4cb4b6(0x2b6)](__dirname,_0x4cb4b6(0x172),_0x4cb4b6(0x109));_0x3801e3[_0x4cb4b6(0x279)][_0x4cb4b6(0x1d4)]('üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20'+_0x158d8c+_0x4cb4b6(0x2e1)),stopPythonService(_0x3801e3);const _0x19e542=_0x4cb4b6(0x2e3)+_0x158d8c+_0x4cb4b6(0x244),_0x3ad86d=_0x4cb4b6(0x2c6);exec(_0x4cb4b6(0x1bc)+_0x19e542,(_0xe87db8,_0x512d7a,_0x5b99a1)=>{const _0x326ae6=_0x4cb4b6,_0xaa1d05=_0x5b99a1&&_0x5b99a1[_0x326ae6(0x2aa)](_0x326ae6(0x2f3))||_0xe87db8&&_0xe87db8['message'][_0x326ae6(0x2aa)](_0x326ae6(0x2f3));if(_0xaa1d05){_0x3801e3[_0x326ae6(0x279)][_0x326ae6(0x1f0)](_0x326ae6(0x266)),exec(_0x3ad86d,(_0x78618e,_0x2c694a,_0x63df99)=>{const _0x54e19d=_0x326ae6;_0x78618e?(_0x3801e3[_0x54e19d(0x279)]['error'](_0x54e19d(0x284)+_0x3ad86d),_0x3801e3['dependencyInstallInProgress']=![]):(_0x3801e3['log'][_0x54e19d(0x1d4)](_0x54e19d(0x2d2)),_0x3801e3['dependencyInstallInProgress']=![],installPythonDependencies(_0x3801e3));});return;}_0x3801e3[_0x326ae6(0x1b8)]=![],_0xe87db8?(_0x3801e3[_0x326ae6(0x279)]['error']('‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x19e542),_0x3801e3[_0x326ae6(0x279)][_0x326ae6(0x254)](_0x326ae6(0x290)+(_0x5b99a1||_0xe87db8[_0x326ae6(0x2bd)]))):(_0x3801e3[_0x326ae6(0x279)][_0x326ae6(0x1d4)](_0x326ae6(0x2d6)),startPythonService(_0x3801e3));});}async function processSensorEvent(_0x1b35bf,_0x58f519,_0x37f228,_0x287b7e){const _0x280599=a0_0x442fc5;if(!_0x287b7e)return;const _0x824b80=_0x37f228[_0x280599(0x1e3)],_0x2deaf6=Date[_0x280599(0x258)]();_0x1b35bf['log'][_0x280599(0x2cb)](_0x280599(0x291)+_0x58f519+'\x20=\x20'+_0x824b80);const _0x3ffdff=_0x1b35bf[_0x280599(0x260)][_0x58f519];_0x1b35bf['sensorLastValues'][_0x58f519]=_0x824b80;if(!_0x287b7e['logDuplicates']&&_0x3ffdff!=undefined&&_0x3ffdff==_0x824b80){_0x1b35bf['log']['debug'](_0x280599(0x110)+_0x287b7e['name']+_0x280599(0x17d)+_0x824b80+')');return;}const _0x1f91ed=(_0x287b7e[_0x280599(0x1c4)]||'')[_0x280599(0x20e)](),_0xf1d4df=_0x1f91ed[_0x280599(0x2aa)]('temperature')||_0x1f91ed[_0x280599(0x2aa)](_0x280599(0x16d))||_0x1f91ed[_0x280599(0x2aa)]('klima')||_0x1f91ed['includes'](_0x280599(0x11d));_0x1b35bf['isProVersion']&&_0xf1d4df&&recordThermodynamics(_0x1b35bf,_0x58f519,_0x824b80,_0x287b7e[_0x280599(0x243)]);const _0x4bd67c={'timestamp':_0x2deaf6,'id':_0x58f519,'name':_0x287b7e[_0x280599(0x138)],'type':_0x287b7e['type'],'location':_0x287b7e[_0x280599(0x243)],'value':_0x824b80};_0x1b35bf[_0x280599(0x2b0)]['unshift'](_0x4bd67c);if(_0x1b35bf[_0x280599(0x2b0)][_0x280599(0x13f)]>HISTORY_MAX_SIZE)_0x1b35bf[_0x280599(0x2b0)][_0x280599(0x112)]();await _0x1b35bf['setStateAsync'](_0x280599(0x1cf),{'val':JSON[_0x280599(0x277)](_0x4bd67c),'ack':!![]}),await _0x1b35bf[_0x280599(0x1a5)](_0x280599(0x1b4),{'val':JSON[_0x280599(0x277)](_0x1b35bf[_0x280599(0x2b0)]),'ack':!![]});_0x1b35bf[_0x280599(0x171)]&&(_0x1b35bf['rawEventLog'][_0x280599(0x221)](_0x4bd67c),await saveRawEventLog(_0x1b35bf),recordSequence(_0x1b35bf,_0x4bd67c));if(_0x287b7e[_0x280599(0x21b)]&&_0x824b80===!![]){if(_0x1b35bf[_0x280599(0x22a)]&&!_0x1b35bf[_0x280599(0x272)])_0x1b35bf[_0x280599(0x279)][_0x280599(0x1d4)](_0x280599(0x1b7)+_0x287b7e[_0x280599(0x138)]+_0x280599(0x194)),startExitTimer(_0x1b35bf);else!_0x1b35bf[_0x280599(0x22a)]&&(_0x1b35bf[_0x280599(0x279)][_0x280599(0x1d4)](_0x280599(0x144)+_0x287b7e[_0x280599(0x138)]+'.\x20Welcome\x20home.'),await setPresence(_0x1b35bf,!![]));}else _0x287b7e[_0x280599(0x1c4)]==='motion'&&_0x824b80===!![]&&(_0x1b35bf[_0x280599(0x2a3)]&&(_0x1b35bf[_0x280599(0x279)]['info']('Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.'),abortExitTimer(_0x1b35bf)),!_0x1b35bf[_0x280599(0x22a)]&&_0x1b35bf[_0x280599(0x255)]===SYSTEM_MODES[_0x280599(0x18a)]&&await setPresence(_0x1b35bf,!![]));}async function runGeminiAnalysis(_0x2e2572,_0x1e3f3a=''){const _0x2a18ff=a0_0x442fc5;if(!_0x2e2572[_0x2a18ff(0x161)])return;if(_0x2e2572[_0x2a18ff(0x2b0)][_0x2a18ff(0x13f)]===0x0)return;const _0x4376c7=_0x2e2572[_0x2a18ff(0x2b0)][_0x2a18ff(0x2a1)](0x0,0xf),_0x546504=await getWeatherContext(_0x2e2572),_0x5435d0=_0x2e2572[_0x2a18ff(0x255)],_0x50bf80=PERSONA_MAPPING[_0x2e2572[_0x2a18ff(0x1c1)][_0x2a18ff(0x2b2)]||_0x2a18ff(0x147)],_0x4ab8d0=_0x2e2572['config'][_0x2a18ff(0x177)]||'Keine\x20Details.';let _0x26db05=![];try{const _0x5c24cd=await _0x2e2572[_0x2a18ff(0x12d)](_0x2a18ff(0x267));if(_0x5c24cd&&_0x5c24cd[_0x2a18ff(0x1e3)])_0x26db05=!![];}catch(_0x11af0c){}const _0x2c9705=_0x2a18ff(0x308)+_0x50bf80+_0x2a18ff(0xfa)+_0x4ab8d0+'.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20'+_0x5435d0+_0x2a18ff(0x217)+_0x546504+'.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20'+(_0x1e3f3a||_0x2a18ff(0x184))+_0x2a18ff(0x122)+JSON[_0x2a18ff(0x277)](_0x4376c7)+'\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20';try{const _0x2d58b5=await _0x2e2572[_0x2a18ff(0x161)][_0x2a18ff(0x14e)](_0x2c9705),_0x4ca5e6=_0x2d58b5[_0x2a18ff(0x27b)][_0x2a18ff(0x22c)]()[_0x2a18ff(0x1d6)](/```json|```/g,'')[_0x2a18ff(0x1be)](),_0x33ca84=JSON[_0x2a18ff(0x13a)](_0x4ca5e6);await _0x2e2572[_0x2a18ff(0x1a5)](_0x2a18ff(0x156),{'val':JSON['stringify'](_0x33ca84),'ack':!![]});_0x33ca84['summary']&&await _0x2e2572[_0x2a18ff(0x1a5)]('analysis.activitySummary',{'val':_0x33ca84['summary'],'ack':!![]});const _0x2ae736={'timestamp':Date[_0x2a18ff(0x258)](),'id':Date[_0x2a18ff(0x258)]()['toString'](),'analysis':{'activity':{'summary':_0x33ca84[_0x2a18ff(0x2ca)]||_0x2a18ff(0x1f1),'isAlert':_0x33ca84[_0x2a18ff(0x223)]||![],'alertReason':_0x33ca84[_0x2a18ff(0x15a)]},'comfort':{'automationProposal':_0x33ca84['automationProposal']}}};await updateAnalysisHistory(_0x2e2572,_0x2ae736);const _0x561c88=_0x33ca84[_0x2a18ff(0x223)]||![];_0x561c88!==_0x2e2572[_0x2a18ff(0x160)]&&(await _0x2e2572[_0x2a18ff(0x1a5)](_0x2a18ff(0x17c),{'val':_0x561c88,'ack':!![]}),_0x2e2572[_0x2a18ff(0x160)]=_0x561c88,_0x561c88&&(await _0x2e2572[_0x2a18ff(0x1a5)](_0x2a18ff(0x1e8),{'val':_0x33ca84[_0x2a18ff(0x15a)],'ack':!![]}),sendNotification(_0x2e2572,_0x2a18ff(0x11e)+_0x33ca84[_0x2a18ff(0x15a)],![],_0x33ca84[_0x2a18ff(0x1af)]))),_0x33ca84['automationProposal']&&_0x33ca84[_0x2a18ff(0x303)][_0x2a18ff(0x1ce)]&&_0x33ca84[_0x2a18ff(0x303)][_0x2a18ff(0x1a7)]&&(_0x2e2572[_0x2a18ff(0x279)][_0x2a18ff(0x1d4)]('ü§ñ\x20BUTLER\x20PROPOSAL:\x20'+_0x33ca84[_0x2a18ff(0x303)][_0x2a18ff(0x16c)]),await _0x2e2572[_0x2a18ff(0x1a5)](_0x2a18ff(0x1f4),{'val':!![],'ack':!![]}),await _0x2e2572[_0x2a18ff(0x1a5)](_0x2a18ff(0x29a),{'val':_0x33ca84['automationProposal'][_0x2a18ff(0x16c)],'ack':!![]}),await _0x2e2572[_0x2a18ff(0x1a5)](_0x2a18ff(0x1c5),{'val':_0x33ca84[_0x2a18ff(0x303)][_0x2a18ff(0x1a7)],'ack':!![]}),await _0x2e2572[_0x2a18ff(0x1a5)](_0x2a18ff(0x24e),{'val':JSON['stringify'](_0x33ca84[_0x2a18ff(0x303)][_0x2a18ff(0x278)]),'ack':!![]}),_0x26db05&&(_0x2e2572[_0x2a18ff(0x279)]['info'](_0x2a18ff(0x2fc)+_0x33ca84[_0x2a18ff(0x303)][_0x2a18ff(0x1a7)]+_0x2a18ff(0x2e1)),await executeAutomationAction(_0x2e2572)));}catch(_0x453fb5){_0x2e2572[_0x2a18ff(0x279)][_0x2a18ff(0x254)](_0x2a18ff(0x186)+_0x453fb5[_0x2a18ff(0x2bd)]);}}function sendToPython(_0x3b0fba,_0x5c9f1d,_0x3f31d5={}){const _0x5152a2=a0_0x442fc5;if(!_0x3b0fba[_0x5152a2(0x2cc)]||!_0x3b0fba[_0x5152a2(0x2cc)][_0x5152a2(0x1f8)][_0x5152a2(0x151)])return;const _0x3859b5=JSON[_0x5152a2(0x277)]({'command':_0x5c9f1d,..._0x3f31d5});try{_0x3b0fba['pythonProcess'][_0x5152a2(0x1f8)][_0x5152a2(0x1f9)](_0x3859b5+'\x0a');}catch(_0x389f67){_0x3b0fba[_0x5152a2(0x279)][_0x5152a2(0x254)](_0x5152a2(0x1fb)+_0x389f67[_0x5152a2(0x2bd)]);}}function runPythonHealthCheck(_0x53d8b4){const _0x280a97=a0_0x442fc5;if(!_0x53d8b4[_0x280a97(0x2c2)]||_0x53d8b4['dailyDigests'][_0x280a97(0x13f)]<0x2){_0x53d8b4[_0x280a97(0x279)][_0x280a97(0x1d4)]('Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.');return;}const _0x2f1749=_0x53d8b4['dailyDigests'][_0x280a97(0x238)](_0x3ba33a=>{const _0x39c306=_0x280a97,_0x1bf6bf=(_0x3ba33a[_0x39c306(0x1c3)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x1bf6bf]||0x32;});_0x53d8b4[_0x280a97(0x279)][_0x280a97(0x1d4)]('Guardian:\x20Sending\x20'+_0x2f1749[_0x280a97(0x13f)]+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x53d8b4,_0x280a97(0x2fb),{'values':_0x2f1749,'tag':_0x280a97(0x1d5)});}function handlePythonResult(_0x562bec,_0x5b769e){const _0x5a0abb=a0_0x442fc5;if(_0x5b769e[_0x5a0abb(0x1c4)]===_0x5a0abb(0x2c4))_0x562bec[_0x5a0abb(0x279)][_0x5a0abb(0x2cb)](_0x5a0abb(0x237));else{if(_0x5b769e[_0x5a0abb(0x1c4)]===_0x5a0abb(0x206)){const {tag:_0xc6bb5a,diagnosis:_0x564912,change_percent:_0x4d3748}=_0x5b769e[_0x5a0abb(0x114)];_0x562bec['log']['info']('üêç\x20Guardian\x20Diagnosis\x20('+_0xc6bb5a+'):\x20'+_0x564912+'\x20('+_0x4d3748+'%)'),_0x562bec[_0x5a0abb(0x1a5)](_0x5a0abb(0x2bc),{'val':_0x564912,'ack':!![]}),_0x562bec[_0x5a0abb(0x1a5)](_0x5a0abb(0x108),{'val':_0x4d3748,'ack':!![]});}}}function startPythonService(_0x5c32d5){const _0x1d5dc3=a0_0x442fc5;try{const _0x3a1302=path[_0x1d5dc3(0x2b6)](__dirname,_0x1d5dc3(0x172),'service.py');_0x5c32d5['log']['info'](_0x1d5dc3(0x216)+_0x3a1302),_0x5c32d5[_0x1d5dc3(0x2cc)]=spawn(_0x1d5dc3(0x11b),[_0x3a1302]),_0x5c32d5[_0x1d5dc3(0x2cc)]['stdout']['on'](_0x1d5dc3(0x28a),_0x202f47=>{const _0x4434d4=_0x1d5dc3,_0x3e0170=_0x202f47[_0x4434d4(0x257)]()[_0x4434d4(0x295)]('\x0a');_0x3e0170['forEach'](_0x3d3e2d=>{const _0x304681=_0x4434d4,_0x351e05=_0x3d3e2d[_0x304681(0x1be)]();if(!_0x351e05)return;if(_0x351e05[_0x304681(0x23c)](_0x304681(0x125)))_0x5c32d5[_0x304681(0x279)]['debug'](_0x304681(0x307)+_0x351e05[_0x304681(0x1a0)](0x5)['trim']());else{if(_0x351e05[_0x304681(0x23c)](_0x304681(0x2be)))try{const _0x3c4d9d=JSON[_0x304681(0x13a)](_0x351e05['substring'](0x8)[_0x304681(0x1be)]());handlePythonResult(_0x5c32d5,_0x3c4d9d);}catch(_0x119ff){_0x5c32d5[_0x304681(0x279)][_0x304681(0x1f0)]('Invalid\x20JSON\x20from\x20Python:\x20'+_0x351e05);}}(_0x351e05['includes']('No\x20module\x20named')||_0x351e05[_0x304681(0x2aa)]('Bibliotheken\x20nicht\x20gefunden')||_0x351e05[_0x304681(0x2aa)](_0x304681(0x264)))&&(_0x5c32d5[_0x304681(0x279)]['warn'](_0x304681(0x192)),installPythonDependencies(_0x5c32d5));});}),_0x5c32d5[_0x1d5dc3(0x2cc)]['stderr']['on']('data',_0x535283=>{const _0x5aedbc=_0x1d5dc3,_0x584c6a=_0x535283[_0x5aedbc(0x257)]()[_0x5aedbc(0x1be)]();_0x5c32d5[_0x5aedbc(0x279)][_0x5aedbc(0x254)](_0x5aedbc(0x219)+_0x584c6a);}),_0x5c32d5[_0x1d5dc3(0x2cc)]['on']('close',_0x407d7b=>{const _0x4a7462=_0x1d5dc3;_0x5c32d5[_0x4a7462(0x279)]['info'](_0x4a7462(0x143)+_0x407d7b),_0x5c32d5[_0x4a7462(0x2cc)]=null;}),_0x5c32d5['pythonProcess']['on'](_0x1d5dc3(0x254),_0x569ca7=>{const _0x304aba=_0x1d5dc3;_0x5c32d5[_0x304aba(0x279)][_0x304aba(0x1f0)](_0x304aba(0x24b)+_0x569ca7[_0x304aba(0x2bd)]);});}catch(_0x12fcf9){_0x5c32d5[_0x1d5dc3(0x279)][_0x1d5dc3(0x254)]('Error\x20launching\x20Python\x20service:\x20'+_0x12fcf9[_0x1d5dc3(0x2bd)]);}}function stopPythonService(_0x432218){const _0x5a419e=a0_0x442fc5;if(_0x432218['pythonProcess']){_0x432218['log'][_0x5a419e(0x1d4)](_0x5a419e(0x2c9));try{_0x432218[_0x5a419e(0x2cc)][_0x5a419e(0x207)]();}catch(_0x48276e){_0x432218[_0x5a419e(0x279)][_0x5a419e(0x1f0)](_0x5a419e(0x1a8)+_0x48276e[_0x5a419e(0x2bd)]);}_0x432218['pythonProcess']=null;}}class CogniLiving extends utils[a0_0x442fc5(0x2e8)]{constructor(_0x171580){const _0xd1f2bb=a0_0x442fc5;super({..._0x171580,'name':_0xd1f2bb(0x142)}),this[_0xd1f2bb(0x2b0)]=[],this['analysisHistory']=[],this[_0xd1f2bb(0x128)]=[],this[_0xd1f2bb(0x1fa)]=[],this[_0xd1f2bb(0x2c2)]=[],this['sensorLastValues']={},this[_0xd1f2bb(0x2d5)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0xd1f2bb(0x22a)]=!![],this[_0xd1f2bb(0x2a3)]=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this['genAI']=null,this[_0xd1f2bb(0x161)]=null,this['currentSystemMode']=SYSTEM_MODES[_0xd1f2bb(0x18a)],this[_0xd1f2bb(0x171)]=![],this[_0xd1f2bb(0x160)]=![],this[_0xd1f2bb(0x2a7)]='unknown',this[_0xd1f2bb(0x1e4)]=null,this[_0xd1f2bb(0x13e)]=null,this[_0xd1f2bb(0x2b1)]=null,this[_0xd1f2bb(0x139)]=null,this[_0xd1f2bb(0x1bb)]=null,this[_0xd1f2bb(0x2cc)]=null,this[_0xd1f2bb(0x1b8)]=![],this['on'](_0xd1f2bb(0x16f),this[_0xd1f2bb(0x2a5)][_0xd1f2bb(0x2e9)](this)),this['on'](_0xd1f2bb(0x12c),this[_0xd1f2bb(0x107)][_0xd1f2bb(0x2e9)](this)),this['on'](_0xd1f2bb(0x169),this['onUnload']['bind'](this)),this['on']('message',this[_0xd1f2bb(0x271)][_0xd1f2bb(0x2e9)](this));}async[a0_0x442fc5(0x2a5)](){const _0x2270a3=a0_0x442fc5;this[_0x2270a3(0x279)][_0x2270a3(0x1d4)](_0x2270a3(0x2f9)+this[_0x2270a3(0x213)]+_0x2270a3(0x268)),await initZombies(this),this[_0x2270a3(0x1c1)][_0x2270a3(0x183)]=this[_0x2270a3(0x1c1)][_0x2270a3(0x183)]||'';try{this[_0x2270a3(0x171)]=await checkLicense(this,this[_0x2270a3(0x1c1)]['licenseKey']);}catch(_0x4c0986){}this[_0x2270a3(0x279)][_0x2270a3(0x1d4)](_0x2270a3(0x276)+!!this['config']['licenseKey']+'\x20|\x20Status:\x20'+(this[_0x2270a3(0x171)]?_0x2270a3(0x200):_0x2270a3(0x215)));if(!this[_0x2270a3(0x1c1)][_0x2270a3(0x105)]||this[_0x2270a3(0x1c1)]['inactivityThresholdHours']<0.1)this[_0x2270a3(0x1c1)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x2270a3(0x1c1)]['geminiApiKey'])try{this['genAI']=new GoogleGenerativeAI(this[_0x2270a3(0x1c1)][_0x2270a3(0x2f5)]),this[_0x2270a3(0x161)]=this[_0x2270a3(0x2c8)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2270a3(0x218)}}),this['log']['info'](_0x2270a3(0x146));}catch(_0x117aaa){this[_0x2270a3(0x279)][_0x2270a3(0x254)](_0x2270a3(0x17a)+_0x117aaa[_0x2270a3(0x2bd)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates']('analysis.trigger'),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x2270a3(0x2de)),this[_0x2270a3(0x1b0)](_0x2270a3(0x165)),this[_0x2270a3(0x1b0)](_0x2270a3(0x1ca)),this[_0x2270a3(0x1b0)](_0x2270a3(0x267)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x2270a3(0x1e4)])clearInterval(this[_0x2270a3(0x1e4)]);const _0x5d18f4=this[_0x2270a3(0x1c1)]['analysisInterval']||0xf;_0x5d18f4>0x0&&(this[_0x2270a3(0x279)][_0x2270a3(0x1d4)](_0x2270a3(0x2ce)+_0x5d18f4+_0x2270a3(0x20a)),this['analysisTimer']=setInterval(()=>{runAutopilot(this);},_0x5d18f4*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x3d9e51=_0x2270a3;this[_0x3d9e51(0x2cc)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x442fc5(0x1e9)](_0x1409a9){const _0x1cd609=a0_0x442fc5;if(this[_0x1cd609(0x1e4)])clearInterval(this['analysisTimer']);if(this['driftAnalysisTimer'])clearInterval(this[_0x1cd609(0x139)]);if(this[_0x1cd609(0x13e)])this[_0x1cd609(0x13e)][_0x1cd609(0x230)]();if(this['modeResetJob'])this['modeResetJob'][_0x1cd609(0x230)]();if(this[_0x1cd609(0x1bb)])this[_0x1cd609(0x1bb)]['cancel']();if(this[_0x1cd609(0x2a3)])clearTimeout(this[_0x1cd609(0x2a3)]);if(this[_0x1cd609(0x1f2)])clearTimeout(this[_0x1cd609(0x1f2)]);stopPythonService(this),_0x1409a9();}async[a0_0x442fc5(0x107)](_0x57ad06,_0x5db76b){const _0x43396e=a0_0x442fc5;if(!_0x5db76b)return;if(_0x57ad06[_0x43396e(0x2aa)]('telegram')&&_0x57ad06[_0x43396e(0x159)]('communicate.request')&&_0x5db76b[_0x43396e(0x1e3)]){await handleTelegramResponse(this,_0x5db76b['val']);return;}if(_0x57ad06===this[_0x43396e(0x18b)]+'.'+SYSTEM_DP_MODE){_0x5db76b[_0x43396e(0x1e3)]&&Object[_0x43396e(0x2e0)](SYSTEM_MODES)[_0x43396e(0x2aa)](_0x5db76b[_0x43396e(0x1e3)])&&(this['currentSystemMode']=_0x5db76b[_0x43396e(0x1e3)],_0x5db76b[_0x43396e(0x1e3)]===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x5db76b[_0x43396e(0x282)])this[_0x43396e(0x293)](_0x57ad06,{'val':this[_0x43396e(0x255)],'ack':!![]});return;}if(!_0x5db76b[_0x43396e(0x282)]){_0x57ad06['includes'](_0x43396e(0x111))&&_0x5db76b[_0x43396e(0x1e3)]&&(this[_0x43396e(0x293)](_0x57ad06,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x57ad06['includes'](_0x43396e(0x158))&&_0x5db76b['val']){this['setState'](_0x57ad06,{'val':![],'ack':!![]});if(this[_0x43396e(0x171)])createDailyDigest(this);}_0x57ad06[_0x43396e(0x2aa)](_0x43396e(0x239))&&_0x5db76b['val']&&(this[_0x43396e(0x293)](_0x57ad06,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x57ad06[_0x43396e(0x2aa)]('automation.triggerAction')&&_0x5db76b[_0x43396e(0x1e3)]&&(this['setState'](_0x57ad06,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x43396e(0x1c1)][_0x43396e(0x2f1)]&&this[_0x43396e(0x1c1)][_0x43396e(0x2f1)][_0x43396e(0x2aa)](_0x57ad06)){await checkWifiPresence(this);return;}const _0x3ce479=(this[_0x43396e(0x1c1)][_0x43396e(0x1d1)]||[])['find'](_0x4d94de=>_0x4d94de['id']===_0x57ad06);if(_0x3ce479)processSensorEvent(this,_0x57ad06,_0x5db76b,_0x3ce479);}async[a0_0x442fc5(0x271)](_0x98d545){const _0x4370f0=a0_0x442fc5;if(typeof _0x98d545==='object'&&_0x98d545[_0x4370f0(0x2bd)])try{if(_0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x204)){const _0x316bea=_0x98d545[_0x4370f0(0x2bd)]['apiKey']||this[_0x4370f0(0x1c1)][_0x4370f0(0x2f5)];if(!_0x316bea)return this[_0x4370f0(0x157)](_0x98d545['from'],_0x98d545[_0x4370f0(0x127)],{'success':![],'message':_0x4370f0(0x103)},_0x98d545[_0x4370f0(0x2ed)]);try{const _0x373355=new GoogleGenerativeAI(_0x316bea),_0x25f5d9=_0x373355[_0x4370f0(0x1f3)]({'model':GEMINI_MODEL}),_0x2e42ac=await _0x25f5d9['generateContent'](_0x4370f0(0xf7)),_0x443e04=await _0x2e42ac['response'],_0x4cc1d3=_0x443e04['text']();this[_0x4370f0(0x157)](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':!![],'message':'Verbindung\x20erfolgreich!\x20Antwort:\x20'+_0x4cc1d3[_0x4370f0(0x1a0)](0x0,0x14)+_0x4370f0(0x2e1)},_0x98d545[_0x4370f0(0x2ed)]);}catch(_0x47e45f){this[_0x4370f0(0x157)](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':![],'message':'Fehler:\x20'+_0x47e45f[_0x4370f0(0x2bd)]},_0x98d545[_0x4370f0(0x2ed)]);}}else{if(_0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x275)){}else{if(_0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x19c)){if(!this[_0x4370f0(0x171)])return this[_0x4370f0(0x157)](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':![],'isPro':![]},_0x98d545[_0x4370f0(0x2ed)]);let _0x408c15={'status':'N/A','details':'','lastCheck':0x0};try{_0x408c15[_0x4370f0(0x1e0)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x4370f0(0x1e3)],_0x408c15['details']=(await this[_0x4370f0(0x12d)](LTM_DP_DRIFT_DETAILS))['val'],_0x408c15[_0x4370f0(0x2f7)]=(await this[_0x4370f0(0x12d)](LTM_DP_DRIFT_LAST_CHECK))[_0x4370f0(0x1e3)];}catch(_0x468d5d){}const _0x5c4e0a=this[_0x4370f0(0x1c8)]||[];this[_0x4370f0(0x157)](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x408c15,'analysisHistory':_0x5c4e0a},_0x98d545[_0x4370f0(0x2ed)]);}else{if(_0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x302)){const _0x689f44=this[_0x4370f0(0x2c2)][_0x4370f0(0x13f)],_0x40f226=new Date(),_0x584780=new Date(_0x40f226[_0x4370f0(0x1d8)](),_0x40f226[_0x4370f0(0x2b7)](),_0x40f226['getDate']())[_0x4370f0(0x292)](),_0x105701=this[_0x4370f0(0x1fa)][_0x4370f0(0x29b)](_0x58ddc0=>new Date(_0x58ddc0[_0x4370f0(0x1e5)])[_0x4370f0(0x292)]()>_0x584780)[_0x4370f0(0x13f)],_0x513bac=new Array(0x18)[_0x4370f0(0xfd)](0x0);this[_0x4370f0(0x1fa)][_0x4370f0(0x166)](_0x3f0596=>{const _0x27f730=_0x4370f0,_0x78d323=new Date(_0x3f0596['timestamp']);if(_0x78d323[_0x27f730(0x292)]()>_0x584780)_0x513bac[_0x78d323[_0x27f730(0x1cb)]()]++;});let _0x4e08c1={'status':'N/A'};try{_0x4e08c1['status']=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x4165bf){}let _0x411875='';try{const _0x1c5f37=await this[_0x4370f0(0x12d)]('system.presenceWho');_0x411875=_0x1c5f37?_0x1c5f37[_0x4370f0(0x1e3)]:'';}catch(_0x503007){}let _0x4279c7=null;!this[_0x4370f0(0x161)]&&(_0x4279c7=this[_0x4370f0(0x1c1)]['geminiApiKey']?_0x4370f0(0x11a):_0x4370f0(0x2c0));let _0x19e69a={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x4df3de=await this[_0x4370f0(0x12d)]('analysis.automation.patternDetected'),_0x158c1f=await this['getStateAsync'](_0x4370f0(0x29a)),_0x1fd936=await this[_0x4370f0(0x12d)](_0x4370f0(0x1c5)),_0xeaa79c=await this['getStateAsync'](_0x4370f0(0x24e)),_0x499432=await this[_0x4370f0(0x12d)](_0x4370f0(0x267));_0x4df3de&&_0x4df3de[_0x4370f0(0x1e3)]&&(_0x19e69a[_0x4370f0(0x1ce)]=!![],_0x19e69a['description']=_0x158c1f?_0x158c1f['val']:'',_0x19e69a[_0x4370f0(0x1a7)]=_0x1fd936?_0x1fd936[_0x4370f0(0x1e3)]:'',_0x19e69a['targetValue']=_0xeaa79c?_0xeaa79c[_0x4370f0(0x1e3)]:''),_0x19e69a['autoApply']=_0x499432?!!_0x499432['val']:![];}catch(_0xab5024){}this[_0x4370f0(0x157)](_0x98d545['from'],_0x98d545[_0x4370f0(0x127)],{'success':!![],'eventHistory':this[_0x4370f0(0x2b0)][_0x4370f0(0x2a1)](0x0,0xf),'stats':{'digestCount':_0x689f44,'eventCountToday':_0x105701,'hourlyActivity':_0x513bac,'driftStatus':_0x4e08c1[_0x4370f0(0x1e0)],'isPresent':this[_0x4370f0(0x22a)],'presenceWho':_0x411875,'minDays':this[_0x4370f0(0x1c1)]['minDaysForBaseline']||0x7,'stbDays':this[_0x4370f0(0x1c1)][_0x4370f0(0x301)]||0xe,'ltbDays':this[_0x4370f0(0x1c1)][_0x4370f0(0x270)]||0x3c,'systemError':_0x4279c7},'automation':_0x19e69a},_0x98d545[_0x4370f0(0x2ed)]);}else{if(_0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x253)){const _0x4f02db=await this['getForeignObjectsAsync'](_0x4370f0(0x190),_0x4370f0(0x10e)),_0xf6ed6b=[];if(_0x4f02db)for(const _0x32ca97 in _0x4f02db){const _0x2d74b1=_0x4f02db[_0x32ca97],_0x272396=(_0x2d74b1[_0x4370f0(0x29e)]&&typeof _0x2d74b1[_0x4370f0(0x29e)][_0x4370f0(0x138)]===_0x4370f0(0x25a)?_0x2d74b1[_0x4370f0(0x29e)][_0x4370f0(0x138)]['de']:_0x2d74b1[_0x4370f0(0x29e)][_0x4370f0(0x138)])||_0x2d74b1[_0x4370f0(0x29e)][_0x4370f0(0x138)];_0xf6ed6b[_0x4370f0(0x221)]({'id':_0x32ca97,'name':_0x272396});}this['sendTo'](_0x98d545['from'],_0x98d545['command'],{'success':!![],'enums':_0xf6ed6b},_0x98d545[_0x4370f0(0x2ed)]);}else{if(_0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x106))try{const _0x3633ef=await scanForDevices(this,_0x98d545['message']||{});this[_0x4370f0(0x157)](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':!![],'devices':_0x3633ef},_0x98d545[_0x4370f0(0x2ed)]);}catch(_0x45a3e7){this['sendTo'](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':![],'error':_0x45a3e7[_0x4370f0(0x2bd)]},_0x98d545['callback']);}else{if(_0x98d545['command']===_0x4370f0(0x27f)){const _0x4aa825=_0x98d545[_0x4370f0(0x2bd)][_0x4370f0(0x233)];if(!_0x4aa825)return this['sendTo'](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':![],'error':_0x4370f0(0x23e)},_0x98d545[_0x4370f0(0x2ed)]);const _0x1341dc=await getCalendarNames(this,_0x4aa825);this[_0x4370f0(0x157)](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':!![],'names':_0x1341dc},_0x98d545[_0x4370f0(0x2ed)]);}else{if(_0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x101)){const {targetId:_0x583c05,targetValue:_0xc781d2}=_0x98d545[_0x4370f0(0x2bd)];this['log'][_0x4370f0(0x1d4)]('üß™\x20Simulating\x20Butler\x20Proposal:\x20'+_0x583c05+_0x4370f0(0x23f)+_0xc781d2),await this[_0x4370f0(0x1a5)](_0x4370f0(0x1f4),{'val':!![],'ack':!![]}),await this[_0x4370f0(0x1a5)](_0x4370f0(0x29a),{'val':'SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20'+_0x583c05,'ack':!![]}),await this['setStateAsync'](_0x4370f0(0x1c5),{'val':_0x583c05,'ack':!![]}),await this[_0x4370f0(0x1a5)](_0x4370f0(0x24e),{'val':_0xc781d2,'ack':!![]}),this['sendTo'](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':!![]},_0x98d545[_0x4370f0(0x2ed)]);}else{if(_0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x167)){const {historyId:_0x5668dc,rating:_0x12c635,comment:_0x337999,alertReason:_0x4fcb9e}=_0x98d545['message'];_0x5668dc&&_0x12c635?(await saveFeedback(this,{'timestamp':Date[_0x4370f0(0x258)](),'historyId':_0x5668dc,'rating':_0x12c635,'comment':_0x337999,'alertReason':_0x4fcb9e}),this[_0x4370f0(0x157)](_0x98d545['from'],_0x98d545[_0x4370f0(0x127)],{'success':!![]},_0x98d545[_0x4370f0(0x2ed)])):this[_0x4370f0(0x157)](_0x98d545['from'],_0x98d545[_0x4370f0(0x127)],{'success':![],'error':_0x4370f0(0x26f)},_0x98d545['callback']);}else _0x98d545[_0x4370f0(0x127)]===_0x4370f0(0x2c1)&&(this[_0x4370f0(0x279)][_0x4370f0(0x1d4)](_0x4370f0(0x168)),await this[_0x4370f0(0x1a5)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this['setStateAsync'](_0x4370f0(0x29a),{'val':'','ack':!![]}),this[_0x4370f0(0x157)](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':!![]},_0x98d545[_0x4370f0(0x2ed)]));}}}}}}}}}catch(_0x5d1ff2){this['log'][_0x4370f0(0x254)](_0x4370f0(0x234)+_0x98d545[_0x4370f0(0x127)]+':\x20'+_0x5d1ff2[_0x4370f0(0x2bd)]);if(_0x98d545[_0x4370f0(0x2ed)])this['sendTo'](_0x98d545[_0x4370f0(0x10c)],_0x98d545[_0x4370f0(0x127)],{'success':![],'error':_0x5d1ff2[_0x4370f0(0x2bd)]},_0x98d545[_0x4370f0(0x2ed)]);}}}if(require['main']!==module)module[a0_0x442fc5(0x1b2)]=_0xedb263=>new CogniLiving(_0xedb263);else new CogniLiving();