const a0_0x539918=a0_0x135a;(function(_0x18ab53,_0x244942){const _0x3f1097=a0_0x135a,_0x45cc18=_0x18ab53();while(!![]){try{const _0x2bbb09=-parseInt(_0x3f1097(0x344))/0x1+parseInt(_0x3f1097(0x21c))/0x2+parseInt(_0x3f1097(0x1fc))/0x3*(parseInt(_0x3f1097(0x28e))/0x4)+parseInt(_0x3f1097(0x37d))/0x5+parseInt(_0x3f1097(0x24a))/0x6+parseInt(_0x3f1097(0x250))/0x7*(parseInt(_0x3f1097(0x341))/0x8)+-parseInt(_0x3f1097(0x292))/0x9;if(_0x2bbb09===_0x244942)break;else _0x45cc18['push'](_0x45cc18['shift']());}catch(_0x7ee8d4){_0x45cc18['push'](_0x45cc18['shift']());}}}(a0_0x5cce,0x94ec7));const a0_0x42dbdf=(function(){let _0x81af8f=!![];return function(_0x1b1831,_0x578752){const _0x569363=_0x81af8f?function(){if(_0x578752){const _0x577622=_0x578752['apply'](_0x1b1831,arguments);return _0x578752=null,_0x577622;}}:function(){};return _0x81af8f=![],_0x569363;};}()),a0_0x55d8b6=a0_0x42dbdf(this,function(){const _0x3020f0=a0_0x135a;return a0_0x55d8b6[_0x3020f0(0x1fe)]()[_0x3020f0(0x251)](_0x3020f0(0x306))[_0x3020f0(0x1fe)]()[_0x3020f0(0x241)](a0_0x55d8b6)['search']('(((.+)+)+)+$');});a0_0x55d8b6();function a0_0x5cce(){const _0x2f9af1=['getGenerativeModel','Pattern\x20Detected','level','isPresent','getStateAsync','\x20Tage)','unshift','GUEST','Last\x20Check','instance','System\x20Mode','close','testApiKey','success','kill','Trigger\x20Briefing','setForeignStateAsync','Installing\x20pip\x20packages...\x20(Caching\x20enabled)','status','date','analysis.training.triggerSecurity','analysis.health.gaitSpeed','\x20new\x20patterns.','pip.exe','autoApply','Build\x20Topology','analysis.energy.insulationScore','error','264464jVDrHo','[PYTHON]\x20','setHours','1215096cttNUf','.forecast.current.state','\x22\x20install\x20-r\x20\x22','switch','log','map','analysis.training.triggerTopology','bin','LTM.rawEventLog','BUTLER\x20Execution\x20Error:\x20','Train\x20Security','rating','lights','find','Briefing\x20Error:\x20','üï∏Ô∏è\x20Topology\x20Map\x20updated.','Err:\x20','getObjectAsync','callback','ANALYZE_GAIT','system.config','Training\x20Error:\x20','User\x20dismissed\x20automation\x20proposal.','briefingEnabled','floor','PONG','Train\x20Comfort','[RESULT]','Could\x20not\x20load\x20rooms:\x20','reason','Sec-Training\x20started...','openweathermap','lampe','startsWith','Lernphase\x20(','doors','analysis.analysisHistory','.venv','analysis.security.topologyMatrix','logDuplicates','PARTY','LTM\x20Sched\x20Error:\x20','config','targetValue','extendObjectAsync','setObjectNotExistsAsync','analysis.health.todayVector','exports','testContext','system.mode','system.presenceWho','\x20->\x20','push','Train\x20Health','Activity\x20Summary','üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','pythonProcess','1082480wZZJEl','stdin','response','analysis.isAlert','toFixed','events.history','Sequences','sendTo','is_anomaly','‚ö†Ô∏è\x20Fast-Boot\x20failed.\x20Triggering\x20Self-Healing...','loc','TRAIN_ENERGY','warn','Reset\x20Sched\x20Error:\x20','analysis.training.triggerComfort','bewegung','add','Fokus\x20auf\x20Familienroutinen.','üìù\x20Feedback\x20received:\x20','enum.rooms.*','‚ö†Ô∏è\x20Python\x20VENV\x20or\x20PIP\x20missing.\x20Installing...','\x20*\x20*\x20*','System','python3','üõãÔ∏è\x20BUTLER:\x20Found\x20','getMinutes','exitTimer','node-schedule','heating','system','presence','Target\x20ID','Success:\x20','detected','power','ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...','ltmLtbWindowDays','Last\x20raw\x20event','Adapter','analysis.automation.targetId','Trend\x20Value','details','analysis.trigger','state','win32','pip','N/A','online','namespace','geminiApiKey','HEALTH_RESULT','triggerBriefing','Energy\x20Intelligence','307272SoqxeP','Trigger\x20Action','toString','analysis.health.isAnomaly','selectedFunctionIds','service.py','Raw\x20Log','onStateChange','existsSync','calendarInstance','Kalender\x20deaktiviert.','üß™\x20Simulating\x20Butler\x20Proposal:\x20','forEach','motion','genAI','Anomaly\x20Score','TRAINING_COMPLETE','getLtmData','setStateAsync','round','info','trim','system.isPresent','python_service','inactivityThresholdHours','ENERGY_TRAIN_RESULT','\x0aSTB:\x20','stdout','\x20=\x20','thermostat','platform','notifyTelegramEnabled','1750780ItsEdQ','main','Gemini\x20Init\x20Error:\x20','.Current.WeatherText','description','geminiModel','brightness','LTM.dailyDigests','üêç\x20Checking\x20Python\x20environment...','join','rawEventLog','driftAnalysisTimer','LTM.trainingData.thermodynamics','weatherunderground','0\x204\x20*\x20*\x20*','BUILD_TOPOLOGY','‚úÖ\x20INSTALL\x20SUCCESS.','currentSystemMode','.\x20(Is\x20\x27python3-venv\x27\x20installed?\x20\x27sudo\x20apt\x20install\x20python3-venv\x27)','includes','Temperature\x20Forecast','Aktiv\x20(','insulation','LTM.driftAnalysis.baselineDrift','val','application/json','filter','temperatur','automation.triggerAction','off','vacation','outdoorSensorId','type','Activity-Level','toISOString','analysis.automation.targetValue','TRAIN_COMFORT','constructor','.NextHours.Location_1.Day_1.current.temp_value','from','occupancy','.forecast.current.temp','writable','communicate.request','analysis.health.trendDiagnosis','message','6199872LeSufJ','presenceDevices','role','object','keys','now','140SuFxwW','search','TRAIN_SECURITY','scanDevices','driftDetails','debug','ENERGY_PREDICT_RESULT','accuweather','common','split','indicator','window','timestamp','OK:\x20','devices','analysisTimer','pop','analysis.training.status','data','useWeather','cogni-living','t√ºr','replace','slice','analysis.training.triggerHealth','analysis.health.trendValue','TRAIN_HEALTH','\x0aGrund:\x20','Regel\x20erkannt:\x20','getFullYear','LTM','path','ltmJob','location','.forecast.current.temperature','systemUUID','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','python.exe','analysis.automation.autoApply','rmSync','Wetterdaten\x20deaktiviert.','Kein\x20API\x20Key.','analysis.automation.description','Missing\x20data','\x22\x20-c\x20\x22import\x20tensorflow;\x20print(\x27libs_ok\x27)\x22','setpoint','endsWith','onReady','door','analysis.triggerBriefing','setState','sensorLastValues','EACCES','Alert\x20Status','exitGraceTimer','LTM.baselineStatus','getEnums','party','ANOMALY','Analysiere\x20ausgewogen.','name','Permission\x20denied','12gGvlBi','triggerDailyDigest','analysis.automation.triggerAction','payload','11416887FeHamK','licht','command','klima','modeResetJob','GAIT_RESULT','indicator.alarm','Who\x20is\x20present?','weatherInstance','light','analysis.security.lastCheck','LTM.trainingData.sequences','Delete\x20failed:\x20','pr√§senz','threshold','analysisInterval','Today\x20Vector\x20(15m)','analysis.training.triggerEnergy','getOverviewData','cancel','08:00','briefingJob','parse','longitude','SECURITY_RESULT','getMonth','json','getTime','has','.communicate.request','baselineDrift','activityLevel','Event\x20History','isExit','contact','latitude','WiFi\x20Presence\x20detected.','button','boolean','analysis.history_debug_00','analysis.automation.patternDetected','heizung','@iobroker/adapter-core','dailyDigests','Trend','analysis.security.currentThreshold','events.lastEvent','minDaysForBaseline','shift','analysis.energy','temperature','Auto\x20Apply','events.history_debug_00','Failed:\x20','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','Scripts','child_process','dependencyInstallInProgress','isGracePeriodActive','Current\x20Threshold','getHours','[LOG]','members','LTM.triggerDailyDigest','‚úÖ\x20Fast-Boot:\x20Environment\x20healthy.\x20Skipping\x20installation.','Target\x20Value','ready','PRIORIT√ÑT:\x20Sicherheit.','bind','VACATION','stringify','schalter','enum','subscribeForeignStatesAsync','Health\x20Analysis','text','requirements.txt','.Current.Temperature','analysisHistory','üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','getForeignObjectAsync','Fokus\x20auf\x20Komfort.','models/gemini-flash-latest','unknown','üîç\x20Scanning\x20for\x20devices\x20(Smart\x20Strategy)...','üõë\x20PERMISSION\x20ERROR:\x20Der\x20Adapter\x20darf\x20das\x20VENV\x20nicht\x20anlegen.','N/A\x20(Learning)','Topology\x20Matrix','toLowerCase','ANALYZE_SEQUENCE','length','ack','analysis.alertReason','diagnosis','subscribeStates','python','onMessage','TREND_RESULT','Keine\x20Termine.','fenster','Keine\x20Wetterdaten\x20verf√ºgbar.','daswetter','eventHistory','Security\x20Monitor','Error\x20launching\x20Python:\x20','substring','values','value','guest','[RECORDER]\x20Error:\x20','string','analysis.automation.detectedPatterns','üß†\x20Triggering\x20Security\x20Training...','analysis.energy.heatingScore','analysis.health.lastCheck','number','(((.+)+)+)+$','text.alarm','KI-Modell\x20nicht\x20initialisiert','channel','Unknown','telegram','enum.functions.*','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','AI\x20Training','python3\x20-m\x20venv\x20\x22','normal','scheduleJob','Restoring\x20sensor\x20cache...','apiKey','üêç\x20Python\x20Pong','HEALTH_TRAIN_RESULT','version','simulateButler','LTM.processingStatus','getForeignObjectsAsync','onUnload','‚úÖ\x20HEALTH\x20TRAINED.','some','Insulation\x20Score','PRIORIT√ÑT:\x20Gesundheit/AAL.','getForeignStateAsync','NORMAL','isProVersion','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','LTM.driftAnalysis','generateContent'];a0_0x5cce=function(){return _0x2f9af1;};return a0_0x5cce();}'use strict';const utils=require(a0_0x539918(0x2bc)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x539918(0x398)),{spawn,exec,execSync}=require(a0_0x539918(0x2ca)),path=require(a0_0x539918(0x26f)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x539918(0x2e4),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x539918(0x22a),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x539918(0x34c),LTM_DP_DAILY_DIGESTS=a0_0x539918(0x223),LTM_DP_STATUS=a0_0x539918(0x318),LTM_DP_TRIGGER_DIGEST=a0_0x539918(0x2d1),LTM_DP_BASELINE_STATUS=a0_0x539918(0x287),LTM_DP_DRIFT_CHANNEL=a0_0x539918(0x323),LTM_DP_DRIFT_STATUS=a0_0x539918(0x233),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x539918(0x375),SYSTEM_MODES={'NORMAL':a0_0x539918(0x310),'VACATION':a0_0x539918(0x23a),'PARTY':a0_0x539918(0x289),'GUEST':a0_0x539918(0x2fe)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x539918(0x36c)],SYSTEM_MODES[a0_0x539918(0x32c)]],PERSONA_MAPPING={'generic':a0_0x539918(0x28b),'senior_aal':a0_0x539918(0x31e),'family':a0_0x539918(0x38e),'single_comfort':a0_0x539918(0x2e3),'security':a0_0x539918(0x2d5)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x539918(0x21a)]===a0_0x539918(0x3a9),PERSISTENT_DIR=path[a0_0x539918(0x225)](__dirname,a0_0x539918(0x369)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,'Scripts',a0_0x539918(0x275)):path[a0_0x539918(0x225)](VENV_PATH,a0_0x539918(0x34b),a0_0x539918(0x2f1)),PIP_EXE=IS_WIN?path[a0_0x539918(0x225)](VENV_PATH,a0_0x539918(0x2c9),a0_0x539918(0x33c)):path[a0_0x539918(0x225)](VENV_PATH,'bin',a0_0x539918(0x1f4));let activeSequence=[],sequenceTimer=null;function stopPythonService(_0xf6c701){const _0x561074=a0_0x539918;if(_0xf6c701[_0x561074(0x37c)]){try{_0xf6c701[_0x561074(0x37c)][_0x561074(0x333)]();}catch(_0x1bc0b3){}_0xf6c701[_0x561074(0x37c)]=null;}}function sendToPython(_0x5a3a2a,_0x102820,_0x2817d4={}){const _0x2dc9f9=a0_0x539918;if(!_0x5a3a2a['pythonProcess']||!_0x5a3a2a[_0x2dc9f9(0x37c)][_0x2dc9f9(0x37e)][_0x2dc9f9(0x246)])return;const _0x7c7a2d=JSON[_0x2dc9f9(0x2d8)]({'command':_0x102820,..._0x2817d4});try{_0x5a3a2a['pythonProcess'][_0x2dc9f9(0x37e)]['write'](_0x7c7a2d+'\x0a');}catch(_0x31b85e){}}function a0_0x135a(_0x84e0e2,_0x32ff31){const _0x14f93a=a0_0x5cce();return a0_0x135a=function(_0x55d8b6,_0x42dbdf){_0x55d8b6=_0x55d8b6-0x1f4;let _0x5cceca=_0x14f93a[_0x55d8b6];return _0x5cceca;},a0_0x135a(_0x84e0e2,_0x32ff31);}function runPythonHealthCheck(_0x34d639){const _0x4dcafe=a0_0x539918;if(!_0x34d639[_0x4dcafe(0x2bd)]||_0x34d639['dailyDigests']['length']<0x2)return;const _0x44dac8=_0x34d639[_0x4dcafe(0x2bd)]['map'](_0x2b4edf=>{const _0x8cab4d=_0x4dcafe,_0x401e60=(_0x2b4edf[_0x8cab4d(0x2b1)]||'')[_0x8cab4d(0x2ea)]();return ACTIVITY_LEVEL_MAP[_0x401e60]||0x32;});sendToPython(_0x34d639,'ANALYZE_TREND',{'values':_0x44dac8,'tag':_0x4dcafe(0x23d)});}function handlePythonResult(_0xf0525c,_0x29cbff){const _0x49d769=a0_0x539918;if(_0x29cbff['type']===_0x49d769(0x35d))_0xf0525c[_0x49d769(0x348)][_0x49d769(0x255)](_0x49d769(0x314));else{if(_0x29cbff[_0x49d769(0x23c)]===_0x49d769(0x2aa)){const {anomaly_score:_0x4f6cc2,is_anomaly:_0x1659de,threshold:_0xaa4e7d,explanation:_0x33ef4f}=_0x29cbff[_0x49d769(0x291)];_0xf0525c[_0x49d769(0x348)][_0x49d769(0x210)](_0x49d769(0x322)+_0x4f6cc2[_0x49d769(0x381)](0x5)+_0x49d769(0x377)+(_0x1659de?_0x49d769(0x28a):'OK')),_0xf0525c[_0x49d769(0x20e)]('analysis.security.lastScore',{'val':_0x4f6cc2,'ack':!![]}),_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x29c),{'val':new Date()['toISOString'](),'ack':!![]});if(_0xaa4e7d)_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x2bf),{'val':_0xaa4e7d,'ack':!![]});if(_0x1659de){let _0x63f0f8=_0x49d769(0x30d)+_0x4f6cc2['toFixed'](0x4)+')';if(_0x33ef4f&&_0x33ef4f!=='Unknown')_0x63f0f8+=_0x49d769(0x26b)+_0x33ef4f;_0xf0525c[_0x49d769(0x20e)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x2ee),{'val':_0x63f0f8,'ack':!![]}),sendNotification(_0xf0525c,'‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20'+_0x63f0f8,![],!![]);}}else{if(_0x29cbff[_0x49d769(0x23c)]===_0x49d769(0x20c)){const _0x54b248=_0x29cbff['payload'][_0x49d769(0x3a6)]||'',_0x324da2=_0x29cbff[_0x49d769(0x291)][_0x49d769(0x2a0)],_0x18989b=_0x29cbff[_0x49d769(0x291)][_0x49d769(0x332)]?_0x49d769(0x39d)+new Date()['toLocaleTimeString']()+'\x20('+_0x54b248+')':_0x49d769(0x2c7)+_0x29cbff['payload'][_0x49d769(0x361)];_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x261),{'val':_0x18989b,'ack':!![]});if(_0x29cbff[_0x49d769(0x291)][_0x49d769(0x332)]&&_0x324da2)_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x2bf),{'val':_0x324da2,'ack':!![]});}else{if(_0x29cbff[_0x49d769(0x23c)]==='COMFORT_RESULT'){const {patterns:_0x8d1ad8}=_0x29cbff[_0x49d769(0x291)];if(_0x8d1ad8&&_0x8d1ad8['length']>0x0){_0xf0525c['log']['info'](_0x49d769(0x395)+_0x8d1ad8[_0x49d769(0x2ec)]+_0x49d769(0x33b)),_0xf0525c[_0x49d769(0x20e)]('analysis.automation.detectedPatterns',{'val':JSON[_0x49d769(0x2d8)](_0x8d1ad8),'ack':!![]});const _0x267c01=_0x8d1ad8[0x0],_0x2ecc65=_0x49d769(0x26c)+_0x267c01['rule']+'\x20('+(_0x267c01['confidence']*0x64)[_0x49d769(0x381)](0x0)+'%)';_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x2ba),{'val':!![],'ack':!![]}),_0xf0525c['setStateAsync'](_0x49d769(0x27a),{'val':_0x2ecc65,'ack':!![]});}else _0xf0525c[_0x49d769(0x348)][_0x49d769(0x210)](_0x49d769(0x2e1)),_0xf0525c[_0x49d769(0x20e)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x301),{'val':'[]','ack':!![]});}else{if(_0x29cbff[_0x49d769(0x23c)]===_0x49d769(0x215)){if(_0x29cbff[_0x49d769(0x291)]['success'])try{const _0x9bc094=JSON['parse'](_0x29cbff['payload']['details']);if(_0x9bc094[_0x49d769(0x232)])_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x33f),{'val':JSON[_0x49d769(0x2d8)](_0x9bc094[_0x49d769(0x232)]),'ack':!![]});if(_0x9bc094[_0x49d769(0x399)])_0xf0525c[_0x49d769(0x20e)]('analysis.energy.heatingScore',{'val':JSON['stringify'](_0x9bc094['heating']),'ack':!![]});}catch(_0x2d37b8){}}else{if(_0x29cbff['type']===_0x49d769(0x315)){if(_0x29cbff['payload'][_0x49d769(0x332)])_0xf0525c['log'][_0x49d769(0x210)](_0x49d769(0x31b));}else{if(_0x29cbff[_0x49d769(0x23c)]===_0x49d769(0x1f9))_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x304),{'val':new Date()[_0x49d769(0x23e)](),'ack':!![]}),_0xf0525c['setStateAsync'](_0x49d769(0x1ff),{'val':_0x29cbff[_0x49d769(0x291)][_0x49d769(0x385)],'ack':!![]});else{if(_0x29cbff[_0x49d769(0x23c)]===_0x49d769(0x2f3))_0xf0525c['setStateAsync'](_0x49d769(0x248),{'val':_0x29cbff[_0x49d769(0x291)][_0x49d769(0x2ef)],'ack':!![]}),_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x269),{'val':_0x29cbff[_0x49d769(0x291)]['change_percent'],'ack':!![]});else{if(_0x29cbff[_0x49d769(0x23c)]===_0x49d769(0x297)){const {speed_trend:_0x5c5720}=_0x29cbff[_0x49d769(0x291)];if(_0x5c5720!==undefined)_0xf0525c[_0x49d769(0x20e)](_0x49d769(0x33a),{'val':_0x5c5720,'ack':!![]});}else{if(_0x29cbff[_0x49d769(0x23c)]===_0x49d769(0x256)){const {forecast:_0x1c6f3b}=_0x29cbff[_0x49d769(0x291)];if(_0x1c6f3b)_0xf0525c[_0x49d769(0x20e)]('analysis.energy.forecast',{'val':JSON[_0x49d769(0x2d8)](_0x1c6f3b),'ack':!![]});}else{if(_0x29cbff['type']==='TOPOLOGY_RESULT'){const {data:_0x57623f}=_0x29cbff[_0x49d769(0x291)];_0x57623f&&(_0xf0525c['log'][_0x49d769(0x210)](_0x49d769(0x353)),_0xf0525c['setStateAsync'](_0x49d769(0x36a),{'val':JSON[_0x49d769(0x2d8)](_0x57623f),'ack':!![]}));}}}}}}}}}}}}function startPythonService(_0x4df213){const _0x410808=a0_0x539918;let _0x57fb43=_0x410808(0x394);if(fs[_0x410808(0x204)](PYTHON_EXE))_0x57fb43=PYTHON_EXE;try{const _0x48517f=path[_0x410808(0x225)](__dirname,_0x410808(0x213),_0x410808(0x201));_0x4df213[_0x410808(0x37c)]=spawn(_0x57fb43,[_0x48517f]),_0x4df213[_0x410808(0x37c)][_0x410808(0x217)]['on'](_0x410808(0x262),_0x37e5e3=>{const _0x3ca64b=_0x410808,_0x2eebe3=_0x37e5e3[_0x3ca64b(0x1fe)]()['split']('\x0a');_0x2eebe3[_0x3ca64b(0x208)](_0x4d596d=>{const _0x3638e9=_0x3ca64b,_0x2ec25d=_0x4d596d[_0x3638e9(0x211)]();if(!_0x2ec25d)return;if(_0x2ec25d[_0x3638e9(0x365)](_0x3638e9(0x2cf)))_0x4df213[_0x3638e9(0x348)]['debug'](_0x3638e9(0x342)+_0x2ec25d['substring'](0x5)['trim']());else{if(_0x2ec25d['startsWith'](_0x3638e9(0x35f)))try{const _0x3c66f3=JSON[_0x3638e9(0x2a8)](_0x2ec25d[_0x3638e9(0x2fb)](0x8)['trim']());handlePythonResult(_0x4df213,_0x3c66f3);}catch(_0x250dd8){}}});}),_0x4df213['pythonProcess']['on'](_0x410808(0x330),_0x182bd9=>{const _0x30aff3=_0x410808;_0x4df213[_0x30aff3(0x37c)]=null;});}catch(_0x55d24d){_0x4df213['log'][_0x410808(0x340)](_0x410808(0x2fa)+_0x55d24d[_0x410808(0x249)]);}}function installRequirementsInVenv(_0x5489f5,_0x3dc973){const _0x48e523=a0_0x539918;_0x5489f5[_0x48e523(0x348)][_0x48e523(0x210)](_0x48e523(0x336));const _0x3a54c1='\x22'+PIP_EXE+_0x48e523(0x346)+_0x3dc973+'\x22';exec(_0x3a54c1,{'timeout':0x1b7740},(_0x3b667f,_0x51b16b,_0x3ae640)=>{const _0x5630a5=_0x48e523;_0x5489f5['dependencyInstallInProgress']=![];if(_0x3b667f){_0x5489f5[_0x5630a5(0x348)]['error']('‚ùå\x20INSTALL\x20FAILED:\x20'+(_0x3ae640||_0x3b667f[_0x5630a5(0x249)]));try{fs['rmSync'](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x433a84){}}else _0x5489f5[_0x5630a5(0x348)][_0x5630a5(0x210)](_0x5630a5(0x22c)),startSystem(_0x5489f5);});}function installPythonDependencies(_0xc5320b){const _0x17d66f=a0_0x539918;if(_0xc5320b[_0x17d66f(0x2cb)])return;_0xc5320b[_0x17d66f(0x2cb)]=!![];const _0x127240=path[_0x17d66f(0x225)](__dirname,_0x17d66f(0x213),_0x17d66f(0x2de));stopPythonService(_0xc5320b);if(fs[_0x17d66f(0x204)](VENV_PATH)&&!fs[_0x17d66f(0x204)](PIP_EXE)){_0xc5320b[_0x17d66f(0x348)][_0x17d66f(0x389)]('‚ôªÔ∏è\x20Found\x20broken\x20VENV\x20(no\x20pip).\x20Deleting\x20and\x20recreating...');try{fs[_0x17d66f(0x277)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x43dc51){_0xc5320b[_0x17d66f(0x348)][_0x17d66f(0x340)](_0x17d66f(0x29e)+_0x43dc51['message']);}}if(!fs[_0x17d66f(0x204)](VENV_PATH))try{_0xc5320b[_0x17d66f(0x348)][_0x17d66f(0x210)]('Creating\x20new\x20VENV...'),execSync(_0x17d66f(0x30f)+VENV_PATH+'\x22');}catch(_0x48a0bf){_0xc5320b[_0x17d66f(0x2cb)]=![];_0x48a0bf[_0x17d66f(0x249)][_0x17d66f(0x22f)](_0x17d66f(0x284))||_0x48a0bf[_0x17d66f(0x249)][_0x17d66f(0x22f)](_0x17d66f(0x28d))?(_0xc5320b[_0x17d66f(0x348)][_0x17d66f(0x340)](_0x17d66f(0x2e7)),_0xc5320b[_0x17d66f(0x348)][_0x17d66f(0x340)]('üëâ\x20L√ñSUNG\x20(SSH):\x20sudo\x20chown\x20-R\x20iobroker:iobroker\x20'+path[_0x17d66f(0x225)](__dirname))):_0xc5320b['log'][_0x17d66f(0x340)]('‚ùå\x20VENV\x20CREATION\x20FAILED:\x20'+_0x48a0bf[_0x17d66f(0x249)]+_0x17d66f(0x22e));return;}installRequirementsInVenv(_0xc5320b,_0x127240);}function checkAndInstall(_0x315767){const _0x364e5d=a0_0x539918;if(fs[_0x364e5d(0x204)](PYTHON_EXE)&&fs['existsSync'](PIP_EXE))try{return _0x315767[_0x364e5d(0x348)][_0x364e5d(0x210)](_0x364e5d(0x224)),execSync('\x22'+PYTHON_EXE+_0x364e5d(0x27c),{'timeout':0x3a98}),_0x315767[_0x364e5d(0x348)][_0x364e5d(0x210)](_0x364e5d(0x2d2)),!![];}catch(_0x34fe75){_0x315767[_0x364e5d(0x348)]['warn'](_0x364e5d(0x386));}else _0x315767['log'][_0x364e5d(0x389)](_0x364e5d(0x391));return installPythonDependencies(_0x315767),![];}async function startSystem(_0x23753e){const _0x23dae5=a0_0x539918;_0x23753e['log']['info']('üöÄ\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.5)...'),await initZombies(_0x23753e);try{_0x23753e[_0x23dae5(0x321)]=await checkLicense(_0x23753e['config']['licenseKey']);}catch(_0x4914b0){}if(!_0x23753e[_0x23dae5(0x36e)][_0x23dae5(0x214)]||_0x23753e['config'][_0x23dae5(0x214)]<0.1)_0x23753e[_0x23dae5(0x36e)][_0x23dae5(0x214)]=0xc;await initHistory(_0x23753e),await initSystemConfig(_0x23753e);if(_0x23753e[_0x23dae5(0x36e)]['geminiApiKey'])try{_0x23753e[_0x23dae5(0x20a)]=new GoogleGenerativeAI(_0x23753e['config'][_0x23dae5(0x1f8)]),_0x23753e[_0x23dae5(0x221)]=_0x23753e[_0x23dae5(0x20a)][_0x23dae5(0x325)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x23dae5(0x235)}}),_0x23753e[_0x23dae5(0x348)][_0x23dae5(0x210)]('Gemini\x20AI\x20initialized.');}catch(_0x1a4453){_0x23753e[_0x23dae5(0x348)][_0x23dae5(0x340)](_0x23dae5(0x21e)+_0x1a4453[_0x23dae5(0x249)]);}await createAllObjects(_0x23753e),await loadSystemMode(_0x23753e),await loadRawEventLog(_0x23753e),await loadDailyDigests(_0x23753e),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x3a7)),_0x23753e[_0x23dae5(0x2f0)](LTM_DP_TRIGGER_DIGEST),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x375)),_0x23753e['subscribeStates']('analysis.triggerBriefing'),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x290)),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x276)),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x339)),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x268)),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x2a3)),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x38b)),_0x23753e[_0x23dae5(0x2f0)](_0x23dae5(0x34a)),await initSensorSubscriptions(_0x23753e),await initPresenceSubscriptions(_0x23753e),await setupTelegramListener(_0x23753e),setTimeout(()=>checkWifiPresence(_0x23753e),0x1388);if(_0x23753e['analysisTimer'])clearInterval(_0x23753e[_0x23dae5(0x25f)]);const _0x47ed76=_0x23753e[_0x23dae5(0x36e)][_0x23dae5(0x2a1)]||0xf;_0x47ed76>0x0&&(_0x23753e[_0x23dae5(0x25f)]=setInterval(()=>{runAutopilot(_0x23753e);},_0x47ed76*0x3c*0x3e8)),setupLtmScheduler(_0x23753e),setupModeResetScheduler(_0x23753e),setupDriftAnalysisScheduler(_0x23753e),setupBriefingScheduler(_0x23753e),startPythonService(_0x23753e),setTimeout(()=>{_0x23753e['pythonProcess']&&(runPythonHealthCheck(_0x23753e),triggerGaitAnalysis(_0x23753e),triggerEnergyPrediction(_0x23753e)),updateHealthVector(_0x23753e);},0x1388);}async function runAutopilot(_0x36bbc0){const _0x530aa9=a0_0x539918;_0x36bbc0['log'][_0x530aa9(0x255)](_0x530aa9(0x3a0)),await runGeminiAnalysis(_0x36bbc0),updateHealthVector(_0x36bbc0),triggerGaitAnalysis(_0x36bbc0),triggerEnergyPrediction(_0x36bbc0);}async function triggerGaitAnalysis(_0x49b35a){const _0x3f0186=a0_0x539918;if(!_0x49b35a[_0x3f0186(0x321)])return;try{const _0x2ca43e=await _0x49b35a[_0x3f0186(0x329)](_0x3f0186(0x29d));_0x2ca43e&&_0x2ca43e['val']&&sendToPython(_0x49b35a,_0x3f0186(0x357),{'sequences':JSON[_0x3f0186(0x2a8)](_0x2ca43e[_0x3f0186(0x234)])});}catch(_0x237eb4){}}async function triggerEnergyPrediction(_0x2c93ac){const _0x2693e0=a0_0x539918;if(!_0x2c93ac[_0x2693e0(0x321)])return;try{const _0x2b7b8e=await getOutsideTemperatureNumeric(_0x2c93ac);if(_0x2b7b8e===null)return;const _0x1fac98={},_0x3cb36c=_0x2c93ac[_0x2693e0(0x36e)][_0x2693e0(0x25e)]||[];for(const _0x13dc60 of _0x3cb36c){if(_0x13dc60[_0x2693e0(0x23c)]==='temperature'&&_0x13dc60['location']){const _0x110912=_0x2c93ac[_0x2693e0(0x283)][_0x13dc60['id']];if(_0x110912!==undefined)_0x1fac98[_0x13dc60[_0x2693e0(0x271)]]=_0x110912;}}Object[_0x2693e0(0x24e)](_0x1fac98)[_0x2693e0(0x2ec)]>0x0&&sendToPython(_0x2c93ac,'PREDICT_ENERGY',{'current_temps':_0x1fac98,'t_out':_0x2b7b8e});}catch(_0x196136){}}function updateHealthVector(_0x4c1150){const _0x2374e0=a0_0x539918;if(!_0x4c1150[_0x2374e0(0x226)]||_0x4c1150[_0x2374e0(0x226)][_0x2374e0(0x2ec)]===0x0)return;const _0x4317e5=new Array(0x60)['fill'](0x0),_0x5ab8e1=new Date()[_0x2374e0(0x343)](0x0,0x0,0x0,0x0);_0x4c1150[_0x2374e0(0x226)][_0x2374e0(0x208)](_0x15f86d=>{const _0x346767=_0x2374e0,_0x158d48=new Date(_0x15f86d[_0x346767(0x25c)]);if(_0x158d48[_0x346767(0x2ad)]()>=_0x5ab8e1){const _0x1a8896=_0x158d48[_0x346767(0x2ce)](),_0x179d7a=_0x158d48[_0x346767(0x396)](),_0x3757f9=_0x1a8896*0x4+Math[_0x346767(0x35c)](_0x179d7a/0xf);if(_0x3757f9>=0x0&&_0x3757f9<0x60)_0x4317e5[_0x3757f9]++;}}),_0x4c1150[_0x2374e0(0x20e)](_0x2374e0(0x372),{'val':JSON[_0x2374e0(0x2d8)](_0x4317e5),'ack':!![]});}async function scanForDevices(_0x2200ec,_0x4218aa){const _0x5c2144=a0_0x539918;_0x2200ec[_0x5c2144(0x348)][_0x5c2144(0x210)](_0x5c2144(0x2e6));const _0x38fe07=[],_0x45d8e0=await _0x2200ec[_0x5c2144(0x319)]('*'),_0x259daa={};try{const _0xd67349=await _0x2200ec[_0x5c2144(0x319)](_0x5c2144(0x390),'enum');for(const _0x5917a1 in _0xd67349){const _0x1fc914=_0xd67349[_0x5917a1],_0x37ea32=(_0x1fc914['common']&&typeof _0x1fc914[_0x5c2144(0x258)][_0x5c2144(0x28c)]===_0x5c2144(0x24d)?_0x1fc914[_0x5c2144(0x258)][_0x5c2144(0x28c)]['de']:_0x1fc914['common']['name'])||_0x1fc914[_0x5c2144(0x258)][_0x5c2144(0x28c)];if(_0x1fc914[_0x5c2144(0x258)]&&_0x1fc914['common'][_0x5c2144(0x2d0)])for(const _0x2298ec of _0x1fc914[_0x5c2144(0x258)][_0x5c2144(0x2d0)]){_0x259daa[_0x2298ec]=_0x37ea32;}}}catch(_0x330905){_0x2200ec[_0x5c2144(0x348)][_0x5c2144(0x389)](_0x5c2144(0x360)+_0x330905[_0x5c2144(0x249)]);}let _0x1c6d4e=null,_0x409f55={};if(_0x4218aa['selectedFunctionIds']&&_0x4218aa[_0x5c2144(0x200)][_0x5c2144(0x2ec)]>0x0){_0x1c6d4e=new Set();for(const _0x30a027 of _0x4218aa['selectedFunctionIds']){const _0x25b459=await _0x2200ec['getForeignObjectAsync'](_0x30a027);if(_0x25b459&&_0x25b459['common']&&_0x25b459[_0x5c2144(0x258)][_0x5c2144(0x2d0)]){let _0x28202d=null;const _0x586dc3=_0x30a027['toLowerCase']();if(_0x586dc3['includes']('light')||_0x586dc3['includes'](_0x5c2144(0x293)))_0x28202d=_0x5c2144(0x29b);else{if(_0x586dc3[_0x5c2144(0x22f)](_0x5c2144(0x399))||_0x586dc3[_0x5c2144(0x22f)](_0x5c2144(0x2bb)))_0x28202d=_0x5c2144(0x2c4);else{if(_0x586dc3[_0x5c2144(0x22f)](_0x5c2144(0x25b))||_0x586dc3[_0x5c2144(0x22f)](_0x5c2144(0x2f5)))_0x28202d=_0x5c2144(0x280);}}for(const _0x52eeb8 of _0x25b459[_0x5c2144(0x258)][_0x5c2144(0x2d0)]){_0x1c6d4e[_0x5c2144(0x38d)](_0x52eeb8);if(_0x28202d)_0x409f55[_0x52eeb8]=_0x28202d;}}}}for(const _0xefa446 in _0x45d8e0){const _0x1efc1a=_0x45d8e0[_0xefa446];if(_0x1efc1a&&_0x1efc1a['common']&&_0x1efc1a[_0x5c2144(0x23c)]===_0x5c2144(0x3a8)){if(_0x1c6d4e){let _0x4d4239=_0x1c6d4e[_0x5c2144(0x2ae)](_0xefa446);if(!_0x4d4239){const _0x45844c=_0xefa446[_0x5c2144(0x259)]('.'),_0x3b176a=_0x45844c[_0x5c2144(0x267)](0x0,-0x1)[_0x5c2144(0x225)]('.'),_0x46d899=_0x45844c['slice'](0x0,-0x2)['join']('.');if(_0x1c6d4e['has'](_0x3b176a)){_0x4d4239=!![];if(_0x409f55[_0x3b176a])_0x409f55[_0xefa446]=_0x409f55[_0x3b176a];}else{if(_0x1c6d4e['has'](_0x46d899)){_0x4d4239=!![];if(_0x409f55[_0x46d899])_0x409f55[_0xefa446]=_0x409f55[_0x46d899];}}}if(!_0x4d4239)continue;}let _0xccedbd=(_0x1efc1a[_0x5c2144(0x258)][_0x5c2144(0x28c)]&&typeof _0x1efc1a[_0x5c2144(0x258)][_0x5c2144(0x28c)]===_0x5c2144(0x24d)?_0x1efc1a[_0x5c2144(0x258)][_0x5c2144(0x28c)]['de']:_0x1efc1a[_0x5c2144(0x258)][_0x5c2144(0x28c)])||'';const _0x217601=(_0x1efc1a[_0x5c2144(0x258)][_0x5c2144(0x24c)]||'')[_0x5c2144(0x2ea)](),_0x2cb147=_0xccedbd['toLowerCase']();let _0x56cf03=_0x409f55[_0xefa446]||null;if(!_0x56cf03){if(_0x4218aa[_0x5c2144(0x209)]&&(_0x217601[_0x5c2144(0x22f)](_0x5c2144(0x209))||_0x2cb147[_0x5c2144(0x22f)](_0x5c2144(0x38c))||_0x217601[_0x5c2144(0x22f)]('presence')))_0x56cf03=_0x5c2144(0x209);else{if(_0x4218aa[_0x5c2144(0x367)]&&(_0x217601[_0x5c2144(0x22f)]('door')||_0x217601[_0x5c2144(0x22f)](_0x5c2144(0x25b))||_0x2cb147[_0x5c2144(0x22f)](_0x5c2144(0x265))||_0x2cb147[_0x5c2144(0x22f)](_0x5c2144(0x2f5))||_0x217601[_0x5c2144(0x22f)](_0x5c2144(0x2b4))))_0x56cf03='door';else{if(_0x4218aa[_0x5c2144(0x350)]&&(_0x217601[_0x5c2144(0x22f)](_0x5c2144(0x29b))||_0x217601[_0x5c2144(0x22f)](_0x5c2144(0x347))||_0x2cb147['includes'](_0x5c2144(0x293))||_0x217601[_0x5c2144(0x22f)]('level.dimmer')))_0x56cf03='light';else{if(_0x4218aa[_0x5c2144(0x2c4)]&&(_0x217601[_0x5c2144(0x22f)](_0x5c2144(0x2c4))||_0x2cb147[_0x5c2144(0x22f)](_0x5c2144(0x237))||_0x217601[_0x5c2144(0x22f)](_0x5c2144(0x219))))_0x56cf03=_0x5c2144(0x2c4);}}}}if(_0x56cf03){const _0x1fc027=[_0x5c2144(0x244),_0x5c2144(0x3a8),_0x5c2144(0x327),_0x5c2144(0x2fd),'on',_0x5c2144(0x239),_0x5c2144(0x39f),_0x5c2144(0x222),_0x5c2144(0x337),'temp',_0x5c2144(0x2c4),_0x5c2144(0x27d),_0x5c2144(0x39b)],_0x2b89d4=!_0xccedbd||_0x1fc027[_0x5c2144(0x31c)](_0x49942c=>_0x2cb147===_0x49942c||_0x2cb147[_0x5c2144(0x22f)](_0x49942c));if(_0x2b89d4){const _0x3c2358=_0xefa446[_0x5c2144(0x259)]('.'),_0x1391fd=_0x3c2358['slice'](0x0,-0x1)[_0x5c2144(0x225)]('.'),_0x1690c4=_0x45d8e0[_0x1391fd];if(_0x1690c4&&_0x1690c4[_0x5c2144(0x258)]&&_0x1690c4['common']['name']){let _0x5416ec=(typeof _0x1690c4[_0x5c2144(0x258)]['name']===_0x5c2144(0x24d)?_0x1690c4['common']['name']['de']:_0x1690c4[_0x5c2144(0x258)][_0x5c2144(0x28c)])||'';if(!_0x5416ec||_0x5416ec[_0x5c2144(0x2ea)]()[_0x5c2144(0x22f)](_0x5c2144(0x309))||_0x5416ec===_0x1391fd['split']('.')[_0x5c2144(0x260)]()){const _0x927b82=_0x3c2358[_0x5c2144(0x267)](0x0,-0x2)['join']('.'),_0x2b6480=_0x45d8e0[_0x927b82];_0x2b6480&&_0x2b6480[_0x5c2144(0x258)]&&_0x2b6480[_0x5c2144(0x258)][_0x5c2144(0x28c)]&&(_0x5416ec=(typeof _0x2b6480[_0x5c2144(0x258)][_0x5c2144(0x28c)]===_0x5c2144(0x24d)?_0x2b6480['common'][_0x5c2144(0x28c)]['de']:_0x2b6480[_0x5c2144(0x258)][_0x5c2144(0x28c)])||'');}if(_0x5416ec)_0xccedbd=_0x5416ec+'\x20('+(_0xccedbd||_0xefa446[_0x5c2144(0x259)]('.')['pop']())+')';}}let _0x4b1263=_0x259daa[_0xefa446];if(!_0x4b1263){const _0x3628ec=_0xefa446['split']('.')[_0x5c2144(0x267)](0x0,-0x1)[_0x5c2144(0x225)]('.');_0x4b1263=_0x259daa[_0x3628ec];}if(!_0x4b1263){const _0x20ffc1=_0xefa446['split']('.')[_0x5c2144(0x267)](0x0,-0x2)[_0x5c2144(0x225)]('.');_0x4b1263=_0x259daa[_0x20ffc1];}if(!_0x4b1263){const _0x4323a3=_0xefa446[_0x5c2144(0x259)]('.');if(_0x4323a3[_0x5c2144(0x2ec)]>0x2)_0x4b1263=_0x4323a3[0x2];}_0x38fe07[_0x5c2144(0x378)]({'id':_0xefa446,'name':_0xccedbd||_0xefa446,'type':_0x56cf03,'location':_0x4b1263||'','_score':_0x1c6d4e?0x5a:0x32});}}}return _0x38fe07;}async function getWeatherContext(_0x841156){const _0x2a4566=a0_0x539918;if(!_0x841156[_0x2a4566(0x36e)][_0x2a4566(0x263)]||!_0x841156[_0x2a4566(0x36e)][_0x2a4566(0x29a)])return _0x2a4566(0x278);try{const _0x17a870=_0x841156[_0x2a4566(0x36e)][_0x2a4566(0x29a)];let _0x560f76=await _0x841156['getForeignStateAsync'](_0x17a870+'.Current.Temperature');if(!_0x560f76)_0x560f76=await _0x841156[_0x2a4566(0x31f)](_0x17a870+'.forecast.current.temperature');let _0x1bbb7b=await _0x841156['getForeignStateAsync'](_0x17a870+_0x2a4566(0x21f));if(!_0x1bbb7b)_0x1bbb7b=await _0x841156['getForeignStateAsync'](_0x17a870+_0x2a4566(0x345));if(_0x560f76&&_0x1bbb7b)return _0x560f76[_0x2a4566(0x234)]+'¬∞C,\x20'+_0x1bbb7b[_0x2a4566(0x234)];}catch(_0x3de1d2){}return _0x2a4566(0x2f6);}async function getCalendarContext(_0x20002d){const _0x4af3e3=a0_0x539918;if(!_0x20002d[_0x4af3e3(0x36e)]['useCalendar']||!_0x20002d[_0x4af3e3(0x36e)][_0x4af3e3(0x205)])return _0x4af3e3(0x206);return _0x4af3e3(0x2f4);}async function getCalendarNames(_0x14c5f9,_0x4efc20){return[];}async function saveFeedback(_0x8b8254,_0x553d5c){const _0x54dfd6=a0_0x539918;_0x8b8254['log'][_0x54dfd6(0x210)](_0x54dfd6(0x38f)+_0x553d5c[_0x54dfd6(0x34f)]);}async function sendMorningBriefing(_0x56296c){const _0x3d166f=a0_0x539918;if(!_0x56296c[_0x3d166f(0x221)])return;try{const _0x46e4a0='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x1d3036=await _0x56296c['geminiModel']['generateContent'](_0x46e4a0),_0x47aee1=_0x1d3036[_0x3d166f(0x37f)][_0x3d166f(0x2dd)]();sendNotification(_0x56296c,'üåÖ\x20Morning\x20Briefing:\x0a'+_0x47aee1);}catch(_0x4f2e54){_0x56296c[_0x3d166f(0x348)]['error'](_0x3d166f(0x352)+_0x4f2e54['message']);}}async function initZombies(_0x57c20c){const _0x14d767=a0_0x539918;try{const _0xb3d787=[_0x14d767(0x2b9),_0x14d767(0x2c6)];for(const _0x5c200d of _0xb3d787){try{const _0x520491=await _0x57c20c[_0x14d767(0x355)](_0x5c200d);if(_0x520491)await _0x57c20c['delObjectAsync'](_0x5c200d);}catch(_0x1eae24){}}}catch(_0xe0e6fb){}}async function checkLicense(_0x73f394){return!![];}async function initHistory(_0x2e614b){const _0x3b1150=a0_0x539918;try{const _0x1cd595=await _0x2e614b[_0x3b1150(0x329)](_0x3b1150(0x382));_0x1cd595&&_0x1cd595[_0x3b1150(0x234)]&&(_0x2e614b[_0x3b1150(0x2f8)]=JSON[_0x3b1150(0x2a8)](_0x1cd595[_0x3b1150(0x234)][_0x3b1150(0x1fe)]()));}catch(_0xa31fbe){_0x2e614b[_0x3b1150(0x2f8)]=[];}try{const _0x216eaa=await _0x2e614b['getStateAsync']('analysis.analysisHistory');if(_0x216eaa&&_0x216eaa[_0x3b1150(0x234)])_0x2e614b['analysisHistory']=JSON[_0x3b1150(0x2a8)](_0x216eaa[_0x3b1150(0x234)][_0x3b1150(0x1fe)]());}catch(_0x2f4419){_0x2e614b[_0x3b1150(0x2e0)]=[];}if(_0x2e614b[_0x3b1150(0x2f8)]&&_0x2e614b['eventHistory'][_0x3b1150(0x2ec)]>0x0){_0x2e614b['log'][_0x3b1150(0x210)](_0x3b1150(0x312));for(let _0x374fa5=_0x2e614b[_0x3b1150(0x2f8)]['length']-0x1;_0x374fa5>=0x0;_0x374fa5--){const _0x18112b=_0x2e614b[_0x3b1150(0x2f8)][_0x374fa5];if(_0x18112b&&_0x18112b['id']!==undefined&&_0x18112b[_0x3b1150(0x2fd)]!==undefined)_0x2e614b['sensorLastValues'][_0x18112b['id']]=_0x18112b[_0x3b1150(0x2fd)];}}}async function initSystemConfig(_0xbdc94d){const _0x41c992=a0_0x539918;try{const _0x81f8b3=await _0xbdc94d[_0x41c992(0x2e2)](_0x41c992(0x358));if(_0x81f8b3&&_0x81f8b3['common'])_0xbdc94d['systemConfig']={'latitude':_0x81f8b3[_0x41c992(0x258)][_0x41c992(0x2b5)]||0x0,'longitude':_0x81f8b3[_0x41c992(0x258)][_0x41c992(0x2a9)]||0x0,'city':_0x81f8b3[_0x41c992(0x258)]['city']||''};}catch(_0xf23b3){}}async function createAllObjects(_0x188251){const _0x1178c9=a0_0x539918;await _0x188251[_0x1178c9(0x370)](_0x1178c9(0x39a),{'type':'channel','common':{'name':_0x1178c9(0x393)},'native':{}}),await _0x188251[_0x1178c9(0x370)](SYSTEM_DP_MODE,{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x32f),'type':_0x1178c9(0x300),'role':_0x1178c9(0x3a8),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL']},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x376),{'type':'state','common':{'name':_0x1178c9(0x299),'type':_0x1178c9(0x300),'role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x2c0),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x3a2),'type':_0x1178c9(0x300),'role':_0x1178c9(0x2ac),'read':!![],'write':![]},'native':{}}),await _0x188251['setObjectNotExistsAsync']('events.history',{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x2b2),'type':_0x1178c9(0x300),'role':_0x1178c9(0x2ac),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x370)]('analysis.training',{'type':_0x1178c9(0x309),'common':{'name':_0x1178c9(0x30e)},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x339),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x34e),'type':_0x1178c9(0x2b8),'role':_0x1178c9(0x2b7),'read':!![],'write':!![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x268),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x379),'type':'boolean','role':_0x1178c9(0x2b7),'read':!![],'write':!![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x2a3),{'type':_0x1178c9(0x3a8),'common':{'name':'Train\x20Energy','type':_0x1178c9(0x2b8),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x188251[_0x1178c9(0x371)]('analysis.training.triggerComfort',{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x35e),'type':_0x1178c9(0x2b8),'role':_0x1178c9(0x2b7),'read':!![],'write':!![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x34a),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x33e),'type':_0x1178c9(0x2b8),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x261),{'type':'state','common':{'name':'Training\x20Status','type':'string','role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x370)]('analysis.security',{'type':_0x1178c9(0x309),'common':{'name':_0x1178c9(0x2f9)},'native':{}}),await _0x188251[_0x1178c9(0x371)]('analysis.security.lastScore',{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x20b),'type':_0x1178c9(0x305),'role':_0x1178c9(0x2fd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)]('analysis.security.currentThreshold',{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x2cd),'type':_0x1178c9(0x305),'role':_0x1178c9(0x2fd),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x29c),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x32d),'type':_0x1178c9(0x300),'role':'date','read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x36a),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x2e9),'type':_0x1178c9(0x300),'role':_0x1178c9(0x2ac),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x370)]('analysis.health',{'type':'channel','common':{'name':_0x1178c9(0x2dc)},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x304),{'type':'state','common':{'name':_0x1178c9(0x32d),'type':_0x1178c9(0x300),'role':_0x1178c9(0x338),'read':!![],'write':![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x1ff),{'type':_0x1178c9(0x3a8),'common':{'name':'Anomaly\x20Detected','type':_0x1178c9(0x2b8),'role':_0x1178c9(0x25a),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)]('analysis.health.trendDiagnosis',{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x2be),'type':'string','role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x269),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x3a5),'type':'number','role':_0x1178c9(0x2fd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)]('analysis.health.todayVector',{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x2a2),'type':_0x1178c9(0x300),'role':_0x1178c9(0x2ac),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x33a),{'type':_0x1178c9(0x3a8),'common':{'name':'Gait\x20Speed\x20Trend','type':'number','role':_0x1178c9(0x2fd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x370)](_0x1178c9(0x2c3),{'type':_0x1178c9(0x309),'common':{'name':_0x1178c9(0x1fb)},'native':{}}),await _0x188251['setObjectNotExistsAsync']('analysis.energy.insulationScore',{'type':'state','common':{'name':_0x1178c9(0x31d),'type':_0x1178c9(0x300),'role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x303),{'type':_0x1178c9(0x3a8),'common':{'name':'Heating\x20Score','type':'string','role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251['setObjectNotExistsAsync']('analysis.energy.forecast',{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x230),'type':_0x1178c9(0x300),'role':_0x1178c9(0x2ac),'read':!![],'write':![]},'native':{}}),await _0x188251['extendObjectAsync'](_0x1178c9(0x26e),{'type':'channel','common':{'name':_0x1178c9(0x26e)},'native':{}}),await _0x188251[_0x1178c9(0x370)](LTM_DP_RAW_LOG,{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x202),'type':_0x1178c9(0x300),'role':'json','read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x370)](LTM_DP_DAILY_DIGESTS,{'type':_0x1178c9(0x3a8),'common':{'name':'Daily\x20Digests','type':_0x1178c9(0x300),'role':_0x1178c9(0x2ac),'read':!![],'write':![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x29d),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x383),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x228),{'type':'state','common':{'name':'Thermodynamics','type':_0x1178c9(0x300),'role':_0x1178c9(0x2ac),'read':!![],'write':![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x3a7),{'type':_0x1178c9(0x3a8),'common':{'name':'Trigger\x20Analysis','type':'boolean','role':_0x1178c9(0x2b7),'read':!![],'write':!![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x281),{'type':'state','common':{'name':_0x1178c9(0x334),'type':_0x1178c9(0x2b8),'role':_0x1178c9(0x2b7),'read':!![],'write':!![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x380),{'type':'state','common':{'name':_0x1178c9(0x285),'type':_0x1178c9(0x2b8),'role':_0x1178c9(0x298),'read':!![],'write':![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x2ee),{'type':'state','common':{'name':'Alert\x20Reason','type':_0x1178c9(0x300),'role':_0x1178c9(0x307),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)]('analysis.activitySummary',{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x37a),'type':'string','role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x2ba),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x326),'type':_0x1178c9(0x2b8),'role':_0x1178c9(0x25a),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)]('analysis.automation.description',{'type':'state','common':{'name':'Description','type':'string','role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x301),{'type':_0x1178c9(0x3a8),'common':{'name':'Detected\x20Patterns','type':'string','role':_0x1178c9(0x2ac),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x3a4),{'type':'state','common':{'name':_0x1178c9(0x39c),'type':'string','role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x23f),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x2d3),'type':_0x1178c9(0x300),'role':_0x1178c9(0x2dd),'read':!![],'write':![]},'native':{}}),await _0x188251[_0x1178c9(0x371)](_0x1178c9(0x276),{'type':'state','common':{'name':_0x1178c9(0x2c5),'type':_0x1178c9(0x2b8),'role':_0x1178c9(0x347),'read':!![],'write':!![]},'native':{}}),await _0x188251['setObjectNotExistsAsync'](_0x1178c9(0x290),{'type':_0x1178c9(0x3a8),'common':{'name':_0x1178c9(0x1fd),'type':_0x1178c9(0x2b8),'role':_0x1178c9(0x2b7),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x3b8e52){const _0x50ac60=a0_0x539918;try{const _0x15edbd=await _0x3b8e52[_0x50ac60(0x329)](SYSTEM_DP_MODE);_0x15edbd&&_0x15edbd['val']&&Object[_0x50ac60(0x2fc)](SYSTEM_MODES)[_0x50ac60(0x22f)](_0x15edbd[_0x50ac60(0x234)])?_0x3b8e52[_0x50ac60(0x22d)]=_0x15edbd[_0x50ac60(0x234)]:(_0x3b8e52[_0x50ac60(0x22d)]=SYSTEM_MODES['NORMAL'],await _0x3b8e52['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x50ac60(0x320)],'ack':!![]}));}catch(_0x28d3f8){_0x3b8e52[_0x50ac60(0x22d)]=SYSTEM_MODES[_0x50ac60(0x320)];}}async function loadRawEventLog(_0x159b54){const _0xa00dcd=a0_0x539918;try{const _0x13cd7e=await _0x159b54[_0xa00dcd(0x329)](LTM_DP_RAW_LOG);if(_0x13cd7e&&_0x13cd7e[_0xa00dcd(0x234)])_0x159b54[_0xa00dcd(0x226)]=JSON[_0xa00dcd(0x2a8)](_0x13cd7e[_0xa00dcd(0x234)]);}catch(_0x591042){_0x159b54[_0xa00dcd(0x226)]=[];}}async function saveRawEventLog(_0x2add2e){const _0x9d4f6f=a0_0x539918;if(_0x2add2e[_0x9d4f6f(0x226)][_0x9d4f6f(0x2ec)]>RAW_LOG_MAX_SIZE)_0x2add2e['rawEventLog']['splice'](0x0,_0x2add2e[_0x9d4f6f(0x226)][_0x9d4f6f(0x2ec)]-RAW_LOG_MAX_SIZE);await _0x2add2e[_0x9d4f6f(0x20e)](LTM_DP_RAW_LOG,{'val':JSON[_0x9d4f6f(0x2d8)](_0x2add2e[_0x9d4f6f(0x226)]),'ack':!![]});}async function loadDailyDigests(_0x11c754){const _0x15be08=a0_0x539918;try{const _0x22918d=await _0x11c754[_0x15be08(0x329)](LTM_DP_DAILY_DIGESTS);if(_0x22918d&&_0x22918d[_0x15be08(0x234)])_0x11c754['dailyDigests']=JSON['parse'](_0x22918d[_0x15be08(0x234)]);}catch(_0x318b16){_0x11c754['dailyDigests']=[];}await updateBaselineStatus(_0x11c754);}async function saveDailyDigests(_0x4670d6,_0x1726d8=!![]){const _0x5865d9=a0_0x539918,_0x5c0712=_0x4670d6[_0x5865d9(0x36e)]['ltmLtbWindowDays']||0x3c;_0x4670d6[_0x5865d9(0x2bd)][_0x5865d9(0x2ec)]>_0x5c0712&&_0x4670d6[_0x5865d9(0x2bd)]['splice'](0x0,_0x4670d6[_0x5865d9(0x2bd)]['length']-_0x5c0712);await _0x4670d6[_0x5865d9(0x20e)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x4670d6[_0x5865d9(0x2bd)]),'ack':!![]});if(_0x1726d8)await updateBaselineStatus(_0x4670d6);}async function updateAnalysisHistory(_0x2a45d6,_0x13064e){const _0xf3a336=a0_0x539918;_0x2a45d6[_0xf3a336(0x2e0)][_0xf3a336(0x32b)](_0x13064e);if(_0x2a45d6[_0xf3a336(0x2e0)]['length']>HISTORY_MAX_SIZE)_0x2a45d6[_0xf3a336(0x2e0)][_0xf3a336(0x260)]();await _0x2a45d6[_0xf3a336(0x20e)](_0xf3a336(0x368),{'val':JSON[_0xf3a336(0x2d8)](_0x2a45d6[_0xf3a336(0x2e0)]),'ack':!![]});}async function updateBaselineStatus(_0x26888f){const _0x3de64=a0_0x539918;if(!_0x26888f[_0x3de64(0x321)]){await _0x26888f[_0x3de64(0x20e)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x4705ae=_0x26888f[_0x3de64(0x2bd)][_0x3de64(0x2ec)]>=(_0x26888f[_0x3de64(0x36e)][_0x3de64(0x2c1)]||0x7)?_0x3de64(0x231)+_0x26888f[_0x3de64(0x2bd)]['length']+_0x3de64(0x32a):_0x3de64(0x366)+_0x26888f[_0x3de64(0x2bd)][_0x3de64(0x2ec)]+'/'+(_0x26888f[_0x3de64(0x36e)][_0x3de64(0x2c1)]||0x7)+')';await _0x26888f[_0x3de64(0x20e)](LTM_DP_BASELINE_STATUS,{'val':_0x4705ae,'ack':!![]});}async function initSensorSubscriptions(_0x5f34c6){const _0x3087c1=a0_0x539918,_0x282fe2=_0x5f34c6['config'][_0x3087c1(0x25e)];if(_0x282fe2)for(const _0x51db21 of _0x282fe2){await _0x5f34c6[_0x3087c1(0x2db)](_0x51db21['id']);}}async function initPresenceSubscriptions(_0x42e0ca){const _0x4e15e9=a0_0x539918,_0x594254=_0x42e0ca[_0x4e15e9(0x36e)][_0x4e15e9(0x24b)];if(_0x594254)for(const _0x3df9c5 of _0x594254){await _0x42e0ca[_0x4e15e9(0x2db)](_0x3df9c5);}}async function setupTelegramListener(_0x232d2e){const _0x37da6a=a0_0x539918,_0x447efe=_0x232d2e[_0x37da6a(0x36e)]['notifyTelegramInstance'];if(_0x232d2e[_0x37da6a(0x36e)][_0x37da6a(0x21b)]&&_0x447efe)await _0x232d2e[_0x37da6a(0x2db)](_0x447efe+_0x37da6a(0x2af));}async function checkWifiPresence(_0x51857b){const _0x342b59=a0_0x539918;try{const _0x1aa822=_0x51857b['config'][_0x342b59(0x24b)]||[];let _0x379882=![];const _0x1bd742=[];for(const _0x5d711e of _0x1aa822){try{const _0x3f5c23=await _0x51857b[_0x342b59(0x31f)](_0x5d711e);_0x3f5c23&&(_0x3f5c23[_0x342b59(0x234)]===!![]||_0x3f5c23[_0x342b59(0x234)]===_0x342b59(0x1f6)||_0x3f5c23[_0x342b59(0x234)]===0x1)&&(_0x379882=!![],_0x1bd742[_0x342b59(0x378)](_0x5d711e));}catch(_0x2af0a0){}}return await _0x51857b[_0x342b59(0x20e)](_0x342b59(0x376),{'val':_0x1bd742[_0x342b59(0x225)](',\x20'),'ack':!![]}),_0x379882&&(_0x51857b[_0x342b59(0x397)]&&(_0x51857b['log'][_0x342b59(0x210)](_0x342b59(0x2b6)),abortExitTimer(_0x51857b)),!_0x51857b['isPresent']&&_0x51857b['currentSystemMode']===SYSTEM_MODES[_0x342b59(0x320)]&&await setPresence(_0x51857b,!![])),_0x379882;}catch(_0x5a4a27){return![];}}function startExitTimer(_0x1ca0b4){const _0x48eea7=a0_0x539918;abortExitTimer(_0x1ca0b4),_0x1ca0b4[_0x48eea7(0x2cc)]=!![],_0x1ca0b4[_0x48eea7(0x286)]=setTimeout(()=>{const _0x343c3d=_0x48eea7;_0x1ca0b4[_0x343c3d(0x2cc)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x1ca0b4[_0x48eea7(0x397)]=setTimeout(()=>{const _0x42b17c=_0x48eea7;setPresence(_0x1ca0b4,![]),_0x1ca0b4[_0x42b17c(0x397)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x15d088){const _0x55dd9d=a0_0x539918;if(_0x15d088[_0x55dd9d(0x397)])clearTimeout(_0x15d088[_0x55dd9d(0x397)]);if(_0x15d088[_0x55dd9d(0x286)])clearTimeout(_0x15d088['exitGraceTimer']);_0x15d088[_0x55dd9d(0x397)]=null,_0x15d088[_0x55dd9d(0x286)]=null,_0x15d088[_0x55dd9d(0x2cc)]=![];}async function setPresence(_0x104637,_0x40a608){const _0x4ddae3=a0_0x539918;if(_0x104637[_0x4ddae3(0x328)]===_0x40a608)return;_0x104637[_0x4ddae3(0x328)]=_0x40a608,await _0x104637['setStateAsync'](_0x4ddae3(0x212),{'val':_0x40a608,'ack':!![]});}async function executeAutomationAction(_0xfe0d00){const _0x22ca56=a0_0x539918;try{const _0x28a0da=await _0xfe0d00[_0x22ca56(0x329)]('analysis.automation.targetId'),_0x37146b=await _0xfe0d00[_0x22ca56(0x329)](_0x22ca56(0x23f));if(_0x28a0da&&_0x28a0da[_0x22ca56(0x234)]&&_0x37146b){const _0x12a23b=_0x28a0da[_0x22ca56(0x234)];let _0x369002=_0x37146b['val'];try{_0x369002=JSON[_0x22ca56(0x2a8)](_0x369002);}catch(_0x66f571){}_0xfe0d00[_0x22ca56(0x348)]['info']('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x12a23b+'\x20=\x20'+_0x369002),await _0xfe0d00[_0x22ca56(0x335)](_0x12a23b,_0x369002);}else _0xfe0d00['log'][_0x22ca56(0x389)](_0x22ca56(0x274));}catch(_0x31a97b){_0xfe0d00[_0x22ca56(0x348)][_0x22ca56(0x340)](_0x22ca56(0x34d)+_0x31a97b['message']);}}async function processSensorEvent(_0x336927,_0x1b09ab,_0x2219d4,_0x211abf){const _0x38f008=a0_0x539918;if(!_0x211abf)return;const _0x567e29=_0x2219d4[_0x38f008(0x234)],_0x5c6826=Date['now'](),_0x507291=_0x336927[_0x38f008(0x283)][_0x1b09ab];_0x336927[_0x38f008(0x283)][_0x1b09ab]=_0x567e29;if(!_0x211abf[_0x38f008(0x36b)]&&_0x507291!=undefined&&_0x507291==_0x567e29)return;const _0x2f650f=(_0x211abf[_0x38f008(0x23c)]||'')[_0x38f008(0x2ea)](),_0x3fb34f=_0x2f650f['includes'](_0x38f008(0x2c4))||_0x2f650f['includes'](_0x38f008(0x237))||_0x2f650f[_0x38f008(0x22f)](_0x38f008(0x295))||_0x2f650f[_0x38f008(0x22f)]('heizung');_0x336927['isProVersion']&&_0x3fb34f&&recordThermodynamics(_0x336927,_0x1b09ab,_0x567e29,_0x211abf[_0x38f008(0x271)]);const _0x4dc1f1={'timestamp':_0x5c6826,'id':_0x1b09ab,'name':_0x211abf['name'],'type':_0x211abf[_0x38f008(0x23c)],'location':_0x211abf[_0x38f008(0x271)],'value':_0x567e29};_0x336927[_0x38f008(0x2f8)][_0x38f008(0x32b)](_0x4dc1f1);if(_0x336927[_0x38f008(0x2f8)]['length']>HISTORY_MAX_SIZE)_0x336927['eventHistory'][_0x38f008(0x260)]();await _0x336927[_0x38f008(0x20e)](_0x38f008(0x2c0),{'val':JSON[_0x38f008(0x2d8)](_0x4dc1f1),'ack':!![]}),await _0x336927[_0x38f008(0x20e)](_0x38f008(0x382),{'val':JSON[_0x38f008(0x2d8)](_0x336927[_0x38f008(0x2f8)]),'ack':!![]});_0x336927[_0x38f008(0x321)]&&(_0x336927['rawEventLog'][_0x38f008(0x378)](_0x4dc1f1),await saveRawEventLog(_0x336927),recordSequence(_0x336927,_0x4dc1f1));if(_0x211abf[_0x38f008(0x2b3)]&&_0x567e29===!![]){if(_0x336927[_0x38f008(0x328)]&&!_0x336927[_0x38f008(0x2cc)])startExitTimer(_0x336927);else{if(!_0x336927[_0x38f008(0x328)])setPresence(_0x336927,!![]);}}else{if(_0x211abf[_0x38f008(0x23c)]==='motion'&&_0x567e29===!![]){if(_0x336927[_0x38f008(0x397)])abortExitTimer(_0x336927);if(!_0x336927[_0x38f008(0x328)]&&_0x336927[_0x38f008(0x22d)]===SYSTEM_MODES['NORMAL'])setPresence(_0x336927,!![]);}}}async function recordThermodynamics(_0x330692,_0x27ebc1,_0x19a731,_0x4f15d6){const _0x18cbaf=a0_0x539918,_0x63559e=await getOutsideTemperatureNumeric(_0x330692),_0xe07ba5=await _0x330692[_0x18cbaf(0x329)]('LTM.trainingData.thermodynamics');let _0x4f67f4=[];if(_0xe07ba5&&_0xe07ba5['val'])try{_0x4f67f4=JSON['parse'](_0xe07ba5['val']);}catch(_0x1a039d){}_0x4f67f4[_0x18cbaf(0x378)]({'ts':Date[_0x18cbaf(0x24f)](),'room':_0x4f15d6||_0x18cbaf(0x30a),'t_in':_0x19a731,'t_out':_0x63559e});if(_0x4f67f4[_0x18cbaf(0x2ec)]>THERMO_LOG_SIZE)_0x4f67f4['shift']();await _0x330692[_0x18cbaf(0x20e)](_0x18cbaf(0x228),{'val':JSON[_0x18cbaf(0x2d8)](_0x4f67f4),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x144ead){const _0xa92692=a0_0x539918;if(_0x144ead[_0xa92692(0x36e)][_0xa92692(0x23b)])try{const _0x1d8fab=await _0x144ead['getForeignStateAsync'](_0x144ead['config']['outdoorSensorId']);if(_0x1d8fab&&_0x1d8fab[_0xa92692(0x234)]!==undefined&&_0x1d8fab[_0xa92692(0x234)]!==null)return parseFloat(_0x1d8fab[_0xa92692(0x234)]);}catch(_0x278669){}const _0x388850=_0x144ead[_0xa92692(0x36e)][_0xa92692(0x29a)];if(!_0x144ead[_0xa92692(0x36e)][_0xa92692(0x263)]||!_0x388850)return null;try{let _0x87c266='';if(_0x388850[_0xa92692(0x22f)](_0xa92692(0x257)))_0x87c266=_0x388850+_0xa92692(0x2df);else{if(_0x388850[_0xa92692(0x22f)](_0xa92692(0x2f7)))_0x87c266=_0x388850+_0xa92692(0x242);else{if(_0x388850[_0xa92692(0x22f)](_0xa92692(0x363)))_0x87c266=_0x388850+_0xa92692(0x272);else{if(_0x388850[_0xa92692(0x22f)](_0xa92692(0x229)))_0x87c266=_0x388850+_0xa92692(0x245);}}}if(_0x87c266){const _0x386f80=await _0x144ead[_0xa92692(0x31f)](_0x87c266);if(_0x386f80&&_0x386f80[_0xa92692(0x234)]!==undefined&&_0x386f80['val']!==null)return parseFloat(_0x386f80[_0xa92692(0x234)]);}}catch(_0x48d147){}return null;}async function recordSequence(_0x20da22,_0x1b7cbe){const _0x34fda8=a0_0x539918,_0x1213ea=(_0x1b7cbe[_0x34fda8(0x23c)]||'')[_0x34fda8(0x2ea)](),_0x1a53d0=[_0x34fda8(0x209),'bewegung',_0x34fda8(0x29f),_0x34fda8(0x39b),_0x34fda8(0x244),_0x34fda8(0x280),_0x34fda8(0x265),_0x34fda8(0x25b),_0x34fda8(0x2f5),_0x34fda8(0x2b4),'kontakt',_0x34fda8(0x29b),_0x34fda8(0x293),'switch',_0x34fda8(0x2d9),'dimmer',_0x34fda8(0x364)];if(!_0x1a53d0[_0x34fda8(0x31c)](_0x17588f=>_0x1213ea['includes'](_0x17588f)))return;if(!_0x1b7cbe[_0x34fda8(0x2fd)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x34fda8(0x378)]({'loc':_0x1b7cbe[_0x34fda8(0x271)]||'Unknown','id':_0x1b7cbe['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x20da22);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x576436){const _0x194496=a0_0x539918;try{const _0x217189=await _0x576436[_0x194496(0x329)](_0x194496(0x29d));let _0x2398e0=[];if(_0x217189&&_0x217189[_0x194496(0x234)])try{_0x2398e0=JSON[_0x194496(0x2a8)](_0x217189[_0x194496(0x234)]);}catch(_0x57d469){}const _0x5ac5bf=activeSequence[0x0]['ts'],_0x305cec=activeSequence[_0x194496(0x349)](_0x52acd1=>({'loc':_0x52acd1[_0x194496(0x387)],'t_delta':Math[_0x194496(0x20f)]((_0x52acd1['ts']-_0x5ac5bf)/0x3e8)})),_0xaf0c2a={'timestamp':new Date(_0x5ac5bf)[_0x194496(0x23e)](),'steps':_0x305cec,'duration':Math[_0x194496(0x20f)]((activeSequence[activeSequence[_0x194496(0x2ec)]-0x1]['ts']-_0x5ac5bf)/0x3e8),'daytime':new Date(_0x5ac5bf)[_0x194496(0x2ce)]()};_0x2398e0[_0x194496(0x378)](_0xaf0c2a);if(_0x2398e0[_0x194496(0x2ec)]>MAX_TRAINING_SET_SIZE)_0x2398e0[_0x194496(0x2c2)]();await _0x576436[_0x194496(0x20e)]('LTM.trainingData.sequences',{'val':JSON[_0x194496(0x2d8)](_0x2398e0),'ack':!![]}),runSecurityCheck(_0x576436,_0xaf0c2a);}catch(_0x4d573f){_0x576436[_0x194496(0x348)][_0x194496(0x340)](_0x194496(0x2ff)+_0x4d573f['message']);}}function runSecurityCheck(_0x31f48c,_0x5610b2){const _0x12495e=a0_0x539918;if(!_0x31f48c['isProVersion'])return;sendToPython(_0x31f48c,_0x12495e(0x2eb),{'sequence':_0x5610b2});}function setupLtmScheduler(_0x2da951){const _0x35a958=a0_0x539918;try{if(_0x2da951[_0x35a958(0x270)])_0x2da951[_0x35a958(0x270)][_0x35a958(0x2a5)]();if(!_0x2da951[_0x35a958(0x321)])return;_0x2da951[_0x35a958(0x270)]=schedule[_0x35a958(0x311)](LTM_SCHEDULE,()=>createDailyDigest(_0x2da951));}catch(_0xd029f){_0x2da951['log'][_0x35a958(0x340)](_0x35a958(0x36d)+_0xd029f[_0x35a958(0x249)]);}}function setupModeResetScheduler(_0x30597a){const _0x30e9f5=a0_0x539918;try{if(_0x30597a[_0x30e9f5(0x296)])_0x30597a[_0x30e9f5(0x296)][_0x30e9f5(0x2a5)]();_0x30597a[_0x30e9f5(0x296)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x37e557=_0x30e9f5;await loadSystemMode(_0x30597a),AUTO_RESET_MODES['includes'](_0x30597a['currentSystemMode'])&&await _0x30597a['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x37e557(0x320)],'ack':![]});});}catch(_0x25f48b){_0x30597a[_0x30e9f5(0x348)]['error'](_0x30e9f5(0x38a)+_0x25f48b['message']);}}function setupDriftAnalysisScheduler(_0x3e85b7){const _0x3a6af7=a0_0x539918;try{if(_0x3e85b7[_0x3a6af7(0x227)])clearInterval(_0x3e85b7[_0x3a6af7(0x227)]);if(!_0x3e85b7['isProVersion'])return;_0x3e85b7[_0x3a6af7(0x227)]=setInterval(()=>runBaselineDriftAnalysis(_0x3e85b7),(_0x3e85b7[_0x3a6af7(0x36e)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3e85b7),0x1388);}catch(_0x564f02){_0x3e85b7['log'][_0x3a6af7(0x340)]('Drift\x20Sched\x20Error:\x20'+_0x564f02[_0x3a6af7(0x249)]);}}function setupBriefingScheduler(_0x411d01){const _0x54658e=a0_0x539918;try{if(_0x411d01['briefingJob'])_0x411d01[_0x54658e(0x2a7)][_0x54658e(0x2a5)]();if(!_0x411d01[_0x54658e(0x36e)][_0x54658e(0x35b)])return;const _0x40a507=(_0x411d01[_0x54658e(0x36e)]['briefingTime']||_0x54658e(0x2a6))[_0x54658e(0x259)](':'),_0xdeed2a=parseInt(_0x40a507[0x0])||0x8,_0x55b842=parseInt(_0x40a507[0x1])||0x0,_0x522e4e=_0x55b842+'\x20'+_0xdeed2a+_0x54658e(0x392);_0x411d01['briefingJob']=schedule[_0x54658e(0x311)](_0x522e4e,()=>{sendMorningBriefing(_0x411d01);});}catch(_0x2c70d3){_0x411d01['log']['error']('Briefing\x20Sched\x20Error:\x20'+_0x2c70d3['message']);}}async function runBaselineDriftAnalysis(_0xbb0e5){const _0x28c97f=a0_0x539918;if(!_0xbb0e5[_0x28c97f(0x321)]||!_0xbb0e5['geminiModel'])return;const _0x179704=_0xbb0e5[_0x28c97f(0x36e)]['ltmStbWindowDays']||0xe;if(_0xbb0e5[_0x28c97f(0x2bd)][_0x28c97f(0x2ec)]<_0x179704+0x7){await _0xbb0e5['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x28c97f(0x2e8),'ack':!![]});return;}const _0x335778=_0xbb0e5['dailyDigests']['slice'](-_0x179704),_0x34b83c=_0xbb0e5['dailyDigests'][_0x28c97f(0x267)](0x0,_0xbb0e5[_0x28c97f(0x2bd)][_0x28c97f(0x2ec)]-_0x179704),_0x2bcc5f='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON['stringify'](_0x34b83c)+_0x28c97f(0x216)+JSON[_0x28c97f(0x2d8)](_0x335778);try{const _0x5ae253=await _0xbb0e5[_0x28c97f(0x221)][_0x28c97f(0x324)](_0x2bcc5f),_0x5bf07d=JSON[_0x28c97f(0x2a8)](_0x5ae253[_0x28c97f(0x37f)][_0x28c97f(0x2dd)]()[_0x28c97f(0x266)](/```json|```/g,'')[_0x28c97f(0x211)]());_0x5bf07d[_0x28c97f(0x2b0)]&&(await _0xbb0e5[_0x28c97f(0x20e)](LTM_DP_DRIFT_STATUS,{'val':_0x5bf07d[_0x28c97f(0x2b0)],'ack':!![]}),await _0xbb0e5[_0x28c97f(0x20e)](LTM_DP_DRIFT_DETAILS,{'val':_0x5bf07d[_0x28c97f(0x254)],'ack':!![]}),await _0xbb0e5['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x36712b){}}class CogniLiving extends utils[a0_0x539918(0x3a3)]{constructor(_0x3dcf59){const _0x43c064=a0_0x539918;super({..._0x3dcf59,'name':_0x43c064(0x264)}),this[_0x43c064(0x2f8)]=[],this[_0x43c064(0x2e0)]=[],this[_0x43c064(0x226)]=[],this[_0x43c064(0x2bd)]=[],this[_0x43c064(0x283)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x43c064(0x328)]=!![],this[_0x43c064(0x397)]=null,this[_0x43c064(0x286)]=null,this[_0x43c064(0x2cc)]=![],this[_0x43c064(0x20a)]=null,this[_0x43c064(0x221)]=null,this['currentSystemMode']=SYSTEM_MODES[_0x43c064(0x320)],this[_0x43c064(0x321)]=![],this['lastAlertState']=![],this[_0x43c064(0x273)]=_0x43c064(0x2e5),this[_0x43c064(0x25f)]=null,this[_0x43c064(0x270)]=null,this[_0x43c064(0x296)]=null,this[_0x43c064(0x227)]=null,this[_0x43c064(0x2a7)]=null,this[_0x43c064(0x37c)]=null,this[_0x43c064(0x2cb)]=![],this['on'](_0x43c064(0x2d4),this[_0x43c064(0x27f)][_0x43c064(0x2d6)](this)),this['on']('stateChange',this['onStateChange']['bind'](this)),this['on']('unload',this['onUnload'][_0x43c064(0x2d6)](this)),this['on']('message',this[_0x43c064(0x2f2)][_0x43c064(0x2d6)](this));}async[a0_0x539918(0x27f)](){const _0x1a1d68=a0_0x539918;this[_0x1a1d68(0x348)][_0x1a1d68(0x210)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x1a1d68(0x316)]+')\x20-\x20SAFE\x20BOOT');if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x539918(0x31a)](_0x24fdcb){const _0x5437a9=a0_0x539918;if(this[_0x5437a9(0x25f)])clearInterval(this[_0x5437a9(0x25f)]);if(this[_0x5437a9(0x227)])clearInterval(this[_0x5437a9(0x227)]);if(this[_0x5437a9(0x270)])this[_0x5437a9(0x270)]['cancel']();if(this[_0x5437a9(0x296)])this['modeResetJob'][_0x5437a9(0x2a5)]();if(this[_0x5437a9(0x2a7)])this[_0x5437a9(0x2a7)][_0x5437a9(0x2a5)]();if(this[_0x5437a9(0x397)])clearTimeout(this[_0x5437a9(0x397)]);if(this[_0x5437a9(0x286)])clearTimeout(this[_0x5437a9(0x286)]);stopPythonService(this),_0x24fdcb();}async[a0_0x539918(0x203)](_0x2e1109,_0x5737c4){const _0x536bd7=a0_0x539918;if(!_0x5737c4||this[_0x536bd7(0x2cb)])return;if(_0x2e1109[_0x536bd7(0x22f)](_0x536bd7(0x30b))&&_0x2e1109[_0x536bd7(0x27e)](_0x536bd7(0x247))&&_0x5737c4[_0x536bd7(0x234)]){await handleTelegramResponse(this,_0x5737c4[_0x536bd7(0x234)]);return;}if(_0x2e1109===this[_0x536bd7(0x1f7)]+'.'+SYSTEM_DP_MODE){if(_0x5737c4['val']&&Object[_0x536bd7(0x2fc)](SYSTEM_MODES)[_0x536bd7(0x22f)](_0x5737c4[_0x536bd7(0x234)])){this[_0x536bd7(0x22d)]=_0x5737c4[_0x536bd7(0x234)];if(_0x5737c4[_0x536bd7(0x234)]===SYSTEM_MODES[_0x536bd7(0x2d7)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x5737c4[_0x536bd7(0x2ed)])this['setState'](_0x2e1109,{'val':this[_0x536bd7(0x22d)],'ack':!![]});return;}if(!_0x5737c4[_0x536bd7(0x2ed)]){_0x2e1109[_0x536bd7(0x22f)](_0x536bd7(0x3a7))&&_0x5737c4[_0x536bd7(0x234)]&&(this[_0x536bd7(0x282)](_0x2e1109,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x2e1109[_0x536bd7(0x22f)](_0x536bd7(0x28f))&&_0x5737c4[_0x536bd7(0x234)]){this['setState'](_0x2e1109,{'val':![],'ack':!![]});if(this[_0x536bd7(0x321)])createDailyDigest(this);}_0x2e1109['includes'](_0x536bd7(0x1fa))&&_0x5737c4[_0x536bd7(0x234)]&&(this[_0x536bd7(0x282)](_0x2e1109,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x2e1109[_0x536bd7(0x22f)](_0x536bd7(0x238))&&_0x5737c4[_0x536bd7(0x234)]&&(this[_0x536bd7(0x282)](_0x2e1109,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x2e1109[_0x536bd7(0x22f)](_0x536bd7(0x339))&&_0x5737c4[_0x536bd7(0x234)]){this[_0x536bd7(0x282)](_0x2e1109,{'val':![],'ack':!![]});if(this[_0x536bd7(0x321)])try{const _0x589c85=await this[_0x536bd7(0x329)](_0x536bd7(0x29d));if(_0x589c85&&_0x589c85[_0x536bd7(0x234)]){const _0x2c52a7=JSON[_0x536bd7(0x2a8)](_0x589c85[_0x536bd7(0x234)]);this[_0x536bd7(0x348)]['info'](_0x536bd7(0x302)),this['setStateAsync']('analysis.training.status',{'val':_0x536bd7(0x362),'ack':!![]}),sendToPython(this,_0x536bd7(0x252),{'sequences':_0x2c52a7});}}catch(_0x198cdb){this[_0x536bd7(0x348)][_0x536bd7(0x340)](_0x536bd7(0x359)+_0x198cdb['message']);}}if(_0x2e1109['includes']('analysis.training.triggerHealth')&&_0x5737c4[_0x536bd7(0x234)]){this['setState'](_0x2e1109,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x17032a=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x17032a&&_0x17032a[_0x536bd7(0x234)])sendToPython(this,_0x536bd7(0x26a),{'digests':JSON[_0x536bd7(0x2a8)](_0x17032a[_0x536bd7(0x234)])});}catch(_0x2a37d3){}}if(_0x2e1109[_0x536bd7(0x22f)](_0x536bd7(0x2a3))&&_0x5737c4[_0x536bd7(0x234)]){this[_0x536bd7(0x282)](_0x2e1109,{'val':![],'ack':!![]});if(this[_0x536bd7(0x321)])try{const _0x581dd3=await this[_0x536bd7(0x329)](_0x536bd7(0x228));if(_0x581dd3&&_0x581dd3['val'])sendToPython(this,_0x536bd7(0x388),{'points':JSON[_0x536bd7(0x2a8)](_0x581dd3[_0x536bd7(0x234)])});}catch(_0x54991f){}}if(_0x2e1109['includes']('analysis.training.triggerComfort')&&_0x5737c4[_0x536bd7(0x234)]){this[_0x536bd7(0x282)](_0x2e1109,{'val':![],'ack':!![]});if(this[_0x536bd7(0x321)])try{const _0x2ec4db=await this[_0x536bd7(0x329)](LTM_DP_RAW_LOG);_0x2ec4db&&_0x2ec4db[_0x536bd7(0x234)]&&(this[_0x536bd7(0x348)]['info'](_0x536bd7(0x37b)),sendToPython(this,_0x536bd7(0x240),{'events':JSON[_0x536bd7(0x2a8)](_0x2ec4db[_0x536bd7(0x234)])}));}catch(_0x54d8a5){}}if(_0x2e1109[_0x536bd7(0x22f)]('analysis.training.triggerTopology')&&_0x5737c4[_0x536bd7(0x234)]){this[_0x536bd7(0x282)](_0x2e1109,{'val':![],'ack':!![]});if(this[_0x536bd7(0x321)])try{const _0x3a1aad=await this[_0x536bd7(0x329)](_0x536bd7(0x29d));if(_0x3a1aad&&_0x3a1aad[_0x536bd7(0x234)]){const _0x1c91bc=JSON[_0x536bd7(0x2a8)](_0x3a1aad[_0x536bd7(0x234)]);this[_0x536bd7(0x348)][_0x536bd7(0x210)]('üï∏Ô∏è\x20Building\x20Topology\x20Matrix...'),sendToPython(this,_0x536bd7(0x22b),{'sequences':_0x1c91bc});}}catch(_0xc98059){this[_0x536bd7(0x348)][_0x536bd7(0x340)]('Topology\x20Error:\x20'+_0xc98059[_0x536bd7(0x249)]);}}return;}if(this[_0x536bd7(0x36e)][_0x536bd7(0x24b)]&&this['config'][_0x536bd7(0x24b)][_0x536bd7(0x22f)](_0x2e1109)){await checkWifiPresence(this);return;}const _0x3e521a=(this[_0x536bd7(0x36e)][_0x536bd7(0x25e)]||[])[_0x536bd7(0x351)](_0x2194fe=>_0x2194fe['id']===_0x2e1109);if(_0x3e521a)processSensorEvent(this,_0x2e1109,_0x5737c4,_0x3e521a);}async[a0_0x539918(0x2f2)](_0x217cd1){const _0x4d3eed=a0_0x539918;if(typeof _0x217cd1===_0x4d3eed(0x24d)&&_0x217cd1['message']){if(_0x217cd1['command']===_0x4d3eed(0x331)){const _0x1cac73=_0x217cd1[_0x4d3eed(0x249)][_0x4d3eed(0x313)]||this[_0x4d3eed(0x36e)][_0x4d3eed(0x1f8)];if(!_0x1cac73)return this['sendTo'](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1['command'],{'success':![],'message':_0x4d3eed(0x279)},_0x217cd1['callback']);try{const _0x2e5772=new GoogleGenerativeAI(_0x1cac73),_0x2fd1a7=_0x2e5772[_0x4d3eed(0x325)]({'model':GEMINI_MODEL}),_0x1512f7=await _0x2fd1a7['generateContent']('Hi');this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1[_0x4d3eed(0x294)],{'success':!![],'message':_0x4d3eed(0x25d)+_0x1512f7['response'][_0x4d3eed(0x2dd)]()},_0x217cd1[_0x4d3eed(0x356)]);}catch(_0x3040e8){this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1['command'],{'success':![],'message':_0x4d3eed(0x354)+_0x3040e8[_0x4d3eed(0x249)]},_0x217cd1[_0x4d3eed(0x356)]);}}else{if(_0x217cd1[_0x4d3eed(0x294)]===_0x4d3eed(0x374)){const _0x420c90=await getWeatherContext(this),_0x32fe9c=await getCalendarContext(this);this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1[_0x4d3eed(0x294)],{'success':!![],'weather':_0x420c90,'calendar':_0x32fe9c},_0x217cd1['callback']);}else{if(_0x217cd1[_0x4d3eed(0x294)]===_0x4d3eed(0x20d)){if(!this['isProVersion'])return this[_0x4d3eed(0x384)](_0x217cd1['from'],_0x217cd1[_0x4d3eed(0x294)],{'success':![],'isPro':![]},_0x217cd1[_0x4d3eed(0x356)]);let _0x3b7729={'status':_0x4d3eed(0x1f5)};try{const _0x3d509d=await this[_0x4d3eed(0x329)](LTM_DP_DRIFT_STATUS);_0x3b7729[_0x4d3eed(0x337)]=_0x3d509d?_0x3d509d[_0x4d3eed(0x234)]:_0x4d3eed(0x1f5);}catch(_0x12a344){}this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1[_0x4d3eed(0x294)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x4d3eed(0x2bd)],'driftAnalysis':_0x3b7729,'analysisHistory':this[_0x4d3eed(0x2e0)]},_0x217cd1['callback']);}else{if(_0x217cd1[_0x4d3eed(0x294)]===_0x4d3eed(0x2a4)){const _0x23d9c1=this['dailyDigests']['length'],_0x2c87c7=new Date(),_0x3ee20f=new Date(_0x2c87c7[_0x4d3eed(0x26d)](),_0x2c87c7[_0x4d3eed(0x2ab)](),_0x2c87c7['getDate']())[_0x4d3eed(0x2ad)](),_0xef260=this[_0x4d3eed(0x226)][_0x4d3eed(0x236)](_0x20ea0b=>new Date(_0x20ea0b[_0x4d3eed(0x25c)])[_0x4d3eed(0x2ad)]()>_0x3ee20f)['length'],_0x34a0f0=new Array(0x18)['fill'](0x0);this['rawEventLog'][_0x4d3eed(0x208)](_0x4b5260=>{const _0x509fe3=_0x4d3eed,_0x2e5993=new Date(_0x4b5260[_0x509fe3(0x25c)]);if(_0x2e5993['getTime']()>_0x3ee20f)_0x34a0f0[_0x2e5993[_0x509fe3(0x2ce)]()]++;});let _0x37bf61={'status':_0x4d3eed(0x1f5)};try{const _0x8dd614=await this[_0x4d3eed(0x329)](LTM_DP_DRIFT_STATUS);_0x37bf61[_0x4d3eed(0x337)]=_0x8dd614?_0x8dd614[_0x4d3eed(0x234)]:_0x4d3eed(0x1f5);}catch(_0x249d14){}let _0x236f7a='';try{const _0x5d42b2=await this[_0x4d3eed(0x329)](_0x4d3eed(0x376));_0x236f7a=_0x5d42b2?_0x5d42b2['val']:'';}catch(_0x2f3f8c){}let _0x1a7534=null;!this['geminiModel']&&(_0x1a7534=this[_0x4d3eed(0x36e)][_0x4d3eed(0x1f8)]?_0x4d3eed(0x308):'Kein\x20API\x20Key!');let _0x1f9125={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x528fe6=await this[_0x4d3eed(0x329)](_0x4d3eed(0x2ba));if(_0x528fe6&&_0x528fe6[_0x4d3eed(0x234)]){_0x1f9125[_0x4d3eed(0x39e)]=!![];const _0x1a60d3=await this[_0x4d3eed(0x329)]('analysis.automation.description');_0x1f9125[_0x4d3eed(0x220)]=_0x1a60d3?_0x1a60d3['val']:'';const _0x3505f6=await this[_0x4d3eed(0x329)](_0x4d3eed(0x3a4));_0x1f9125['targetId']=_0x3505f6?_0x3505f6[_0x4d3eed(0x234)]:'';const _0x325119=await this[_0x4d3eed(0x329)](_0x4d3eed(0x23f));_0x1f9125[_0x4d3eed(0x36f)]=_0x325119?_0x325119[_0x4d3eed(0x234)]:'';}const _0x1340ed=await this['getStateAsync'](_0x4d3eed(0x276));_0x1f9125[_0x4d3eed(0x33d)]=_0x1340ed?!!_0x1340ed['val']:![];}catch(_0x2f0acc){}this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1[_0x4d3eed(0x294)],{'success':!![],'eventHistory':this[_0x4d3eed(0x2f8)][_0x4d3eed(0x267)](0x0,0xf),'stats':{'digestCount':_0x23d9c1,'eventCountToday':_0xef260,'hourlyActivity':_0x34a0f0,'driftStatus':_0x37bf61['status'],'isPresent':this[_0x4d3eed(0x328)],'presenceWho':_0x236f7a,'minDays':this[_0x4d3eed(0x36e)][_0x4d3eed(0x2c1)]||0x7,'stbDays':this[_0x4d3eed(0x36e)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x4d3eed(0x36e)][_0x4d3eed(0x3a1)]||0x3c,'systemError':_0x1a7534},'automation':_0x1f9125},_0x217cd1[_0x4d3eed(0x356)]);}else{if(_0x217cd1[_0x4d3eed(0x294)]===_0x4d3eed(0x253))try{const _0x533731=await scanForDevices(this,_0x217cd1[_0x4d3eed(0x249)]||{});this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1[_0x4d3eed(0x294)],{'success':!![],'devices':_0x533731},_0x217cd1[_0x4d3eed(0x356)]);}catch(_0xb6ad66){this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1[_0x4d3eed(0x294)],{'success':![],'error':_0xb6ad66[_0x4d3eed(0x249)]},_0x217cd1[_0x4d3eed(0x356)]);}else{if(_0x217cd1[_0x4d3eed(0x294)]===_0x4d3eed(0x288)){const _0x2204ac=await this[_0x4d3eed(0x319)](_0x4d3eed(0x30c),'enum'),_0x5f2ace=[];if(_0x2204ac)for(const _0x11a277 in _0x2204ac){const _0x294300=_0x2204ac[_0x11a277],_0x3dff48=(_0x294300[_0x4d3eed(0x258)]&&typeof _0x294300['common'][_0x4d3eed(0x28c)]==='object'?_0x294300['common'][_0x4d3eed(0x28c)]['de']:_0x294300['common'][_0x4d3eed(0x28c)])||_0x294300['common'][_0x4d3eed(0x28c)];_0x5f2ace[_0x4d3eed(0x378)]({'id':_0x11a277,'name':_0x3dff48});}const _0x31b02b=await this[_0x4d3eed(0x319)](_0x4d3eed(0x390),_0x4d3eed(0x2da)),_0x486deb=[];if(_0x31b02b)for(const _0x1fe961 in _0x31b02b){const _0x21a89d=_0x31b02b[_0x1fe961],_0xb9abc2=(_0x21a89d[_0x4d3eed(0x258)]&&typeof _0x21a89d[_0x4d3eed(0x258)][_0x4d3eed(0x28c)]===_0x4d3eed(0x24d)?_0x21a89d[_0x4d3eed(0x258)][_0x4d3eed(0x28c)]['de']:_0x21a89d[_0x4d3eed(0x258)][_0x4d3eed(0x28c)])||_0x1fe961['split']('.')[_0x4d3eed(0x260)]();_0x486deb[_0x4d3eed(0x378)](_0xb9abc2);}this['sendTo'](_0x217cd1['from'],_0x217cd1['command'],{'success':!![],'enums':_0x5f2ace,'rooms':_0x486deb},_0x217cd1['callback']);}else{if(_0x217cd1[_0x4d3eed(0x294)]==='getCalendarNames'){const _0x2b45d1=_0x217cd1[_0x4d3eed(0x249)][_0x4d3eed(0x32e)];if(!_0x2b45d1)return this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1['command'],{'success':![],'error':'No\x20instance'},_0x217cd1[_0x4d3eed(0x356)]);const _0x170204=await getCalendarNames(this,_0x2b45d1);this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1['command'],{'success':!![],'names':_0x170204},_0x217cd1[_0x4d3eed(0x356)]);}else{if(_0x217cd1['command']===_0x4d3eed(0x317)){const {targetId:_0x2ee3c6,targetValue:_0x193a70}=_0x217cd1[_0x4d3eed(0x249)];this[_0x4d3eed(0x348)][_0x4d3eed(0x210)](_0x4d3eed(0x207)+_0x2ee3c6+_0x4d3eed(0x218)+_0x193a70),await this[_0x4d3eed(0x20e)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x4d3eed(0x20e)](_0x4d3eed(0x27a),{'val':_0x4d3eed(0x2c8)+_0x2ee3c6,'ack':!![]}),await this[_0x4d3eed(0x20e)](_0x4d3eed(0x3a4),{'val':_0x2ee3c6,'ack':!![]}),await this[_0x4d3eed(0x20e)](_0x4d3eed(0x23f),{'val':_0x193a70,'ack':!![]}),this[_0x4d3eed(0x384)](_0x217cd1['from'],_0x217cd1[_0x4d3eed(0x294)],{'success':!![]},_0x217cd1['callback']);}else{if(_0x217cd1[_0x4d3eed(0x294)]==='submitFeedback'){const {historyId:_0x54e37f,rating:_0x3a4769,comment:_0x528ed9,alertReason:_0x5bde47}=_0x217cd1[_0x4d3eed(0x249)];_0x54e37f&&_0x3a4769?(await saveFeedback(this,{'timestamp':Date[_0x4d3eed(0x24f)](),'historyId':_0x54e37f,'rating':_0x3a4769,'comment':_0x528ed9,'alertReason':_0x5bde47}),this[_0x4d3eed(0x384)](_0x217cd1['from'],_0x217cd1[_0x4d3eed(0x294)],{'success':!![]},_0x217cd1[_0x4d3eed(0x356)])):this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1['command'],{'success':![],'error':_0x4d3eed(0x27b)},_0x217cd1[_0x4d3eed(0x356)]);}else _0x217cd1[_0x4d3eed(0x294)]==='dismissAutomation'&&(this[_0x4d3eed(0x348)][_0x4d3eed(0x210)](_0x4d3eed(0x35a)),await this[_0x4d3eed(0x20e)](_0x4d3eed(0x2ba),{'val':![],'ack':!![]}),await this[_0x4d3eed(0x20e)](_0x4d3eed(0x27a),{'val':'','ack':!![]}),this[_0x4d3eed(0x384)](_0x217cd1[_0x4d3eed(0x243)],_0x217cd1[_0x4d3eed(0x294)],{'success':!![]},_0x217cd1['callback']));}}}}}}}}}}}if(require[a0_0x539918(0x21d)]!==module)module[a0_0x539918(0x373)]=_0x1b0a25=>new CogniLiving(_0x1b0a25);else new CogniLiving();