const a0_0x33d609=a0_0x41b9;(function(_0x28e877,_0x1b3203){const _0x3e671a=a0_0x41b9,_0x2ecfd7=_0x28e877();while(!![]){try{const _0x4c296a=parseInt(_0x3e671a(0xa9))/0x1*(parseInt(_0x3e671a(0x7d))/0x2)+-parseInt(_0x3e671a(0xdb))/0x3+parseInt(_0x3e671a(0xdc))/0x4+-parseInt(_0x3e671a(0x92))/0x5*(parseInt(_0x3e671a(0x103))/0x6)+-parseInt(_0x3e671a(0x19b))/0x7*(parseInt(_0x3e671a(0x1ab))/0x8)+-parseInt(_0x3e671a(0x87))/0x9*(-parseInt(_0x3e671a(0x125))/0xa)+-parseInt(_0x3e671a(0x1c0))/0xb;if(_0x4c296a===_0x1b3203)break;else _0x2ecfd7['push'](_0x2ecfd7['shift']());}catch(_0x5dc247){_0x2ecfd7['push'](_0x2ecfd7['shift']());}}}(a0_0x41a7,0xd4d3c));const a0_0x2f077a=(function(){let _0x4cda87=!![];return function(_0x16d5b6,_0x3e3221){const _0x4d9f8b=_0x4cda87?function(){const _0x353cdd=a0_0x41b9;if(_0x3e3221){const _0x35665a=_0x3e3221[_0x353cdd(0xf0)](_0x16d5b6,arguments);return _0x3e3221=null,_0x35665a;}}:function(){};return _0x4cda87=![],_0x4d9f8b;};}()),a0_0x3274fa=a0_0x2f077a(this,function(){const _0x256df2=a0_0x41b9;return a0_0x3274fa[_0x256df2(0xef)]()[_0x256df2(0x1ce)]('(((.+)+)+)+$')['toString']()[_0x256df2(0x1df)](a0_0x3274fa)[_0x256df2(0x1ce)](_0x256df2(0xb0));});function a0_0x41b9(_0x16eba0,_0x3c2c8e){const _0x193222=a0_0x41a7();return a0_0x41b9=function(_0x3274fa,_0x2f077a){_0x3274fa=_0x3274fa-0x76;let _0x41a75a=_0x193222[_0x3274fa];return _0x41a75a;},a0_0x41b9(_0x16eba0,_0x3c2c8e);}a0_0x3274fa();'use strict';const utils=require(a0_0x33d609(0xfe)),{GoogleGenerativeAI}=require(a0_0x33d609(0x154)),schedule=require(a0_0x33d609(0xb5)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x33d609(0x1cf),MODE_RESET_SCHEDULE=a0_0x33d609(0x189),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x33d609(0x84),LTM_DP_DAILY_DIGESTS=a0_0x33d609(0x106),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x33d609(0x151),LTM_DP_BASELINE_STATUS=a0_0x33d609(0x123),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x33d609(0xc9),LTM_DP_DRIFT_LAST_CHECK=a0_0x33d609(0x1c8),SYSTEM_DP_MODE=a0_0x33d609(0x1b1),HARD_IGNORE_TERMS=[a0_0x33d609(0x1b6),'scriptEnabled',a0_0x33d609(0x182),'unreach','lowbat','rssi',a0_0x33d609(0x11b),'maintenance',a0_0x33d609(0x197),a0_0x33d609(0xb6),'working',a0_0x33d609(0xa5),a0_0x33d609(0x13c),a0_0x33d609(0x12f),a0_0x33d609(0x10f),'firmware','reachable',a0_0x33d609(0xdd)],GENERIC_NAMES=[a0_0x33d609(0x117),a0_0x33d609(0x96),a0_0x33d609(0x9c),'level',a0_0x33d609(0x15b),'brightness','on',a0_0x33d609(0x99),a0_0x33d609(0x9f),a0_0x33d609(0xec),'shutter',a0_0x33d609(0x102),a0_0x33d609(0x109),'status',a0_0x33d609(0x1e8),'presence',a0_0x33d609(0x144),a0_0x33d609(0x86),a0_0x33d609(0x164),a0_0x33d609(0xac),a0_0x33d609(0x1dd),a0_0x33d609(0x9a),a0_0x33d609(0xfb),a0_0x33d609(0xc4),a0_0x33d609(0x198)],ADAPTER_BLACKLIST=[a0_0x33d609(0x105),a0_0x33d609(0x14b),a0_0x33d609(0x1e2),a0_0x33d609(0x18c),a0_0x33d609(0x13a),a0_0x33d609(0xe1),a0_0x33d609(0xf5),a0_0x33d609(0x1b4),'echarts.',a0_0x33d609(0xa7),a0_0x33d609(0x1db)],SYSTEM_MODES={'NORMAL':a0_0x33d609(0xd3),'VACATION':a0_0x33d609(0x9b),'PARTY':a0_0x33d609(0x1a2),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':a0_0x33d609(0x19d),'family':a0_0x33d609(0xa4),'single_comfort':a0_0x33d609(0x8a),'security':a0_0x33d609(0x97)};function a0_0x41a7(){const _0x337620=['cogni-living','eventHistory','Drift\x20Status','1103652fKUMgj','analysis.analysisHistory','\x20*\x20*\x20*','analysis.automation.patternDetected','createDailyDigest','response','getWeatherContext','notifyPushoverRecipient','LTM.driftAnalysis.lastCheck','notifyEmailInstance','slice','isGracePeriodActive','automationProposal','Daily\x20Digests','search','0\x203\x20*\x20*\x20*','ack','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','exports','KALENDER\x20ERROR:\x20','\x20sensors...','onReady','trim','.\x20PERSONA:\x20','Last\x20Check','openweathermap','logDuplicates','simple-api.','isAlert','energy','loadSystemMode','constructor','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','LTM\x20Sched\x20Error:\x20','info.','details','exitTimer','bind','text','patternDetected','motion','length','de-DE','generic','map','saveDailyDigests','NORMAL','inactivityMonitoringEnabled','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','uuid','event','checkLtmDriftObjects','10GqrDBG','expire','Kalender:\x20Deaktiviert','ðŸš¨ðŸš¨\x20NOTFALL','analysis.alertReason','analysis.isAlert','isEmergency','LTM.rawEventLog','analysis.lastResult','temperature','9uPUFJW','includes','lastCheck','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','object','warn','val','stringify','checkLicense','runBaselineDriftAnalysis','common','5cZqfDk','Raw\x20Log','number','from','currentposition','PRIORITÃ„T:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungewÃ¶hnliche\x20Anwesenheit.','detected','off','setpoint','vacation','state','\x20|\x20','COGNI_CONFIRM_OK','switch','splice','isProVersion','ltmLtbWindowDays','WETTER:\x20Keine\x20Daten\x20gefunden','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','direction','Briefing\x20Sched\x20Error:\x20','javascript.','notifyPushoverInstance','33215pjOpyY','VACATION','Kein\x20API\x20Key\x20konfiguriert!','power','.NextHours.Location_1.Day_1.current.symbol_desc','[TEST]\x20','KALENDER:\x20Keine\x20Daten','(((.+)+)+)+$','KALENDER:\x20','description','KI-Modell\x20nicht\x20initialisiert\x20(Neustart\x20erforderlich?)','version','node-schedule','fault','isExit','briefingEnabled','toLocaleString','driftDetails','runAutopilot','info','analysis.activitySummary','.Summary.Current','main','checkWifiPresence','activity','Analysis\x20Error:\x20','getLtmData','actual_temperature','getForeignObjectAsync','unload','KALENDER:\x20Keine\x20relevanten\x20Termine','application/json','LTM.driftAnalysis.driftDetails','generateContent','onUnload','sendMorningBriefing','uuid-not-found','minDaysForBaseline','setState','System\x20Mode','testNotification','triggerBriefing','normal','devices','aiPersona','Error\x20reading\x20calendar\x20table:\x20','useCalendar','initPresenceSubscriptions','loadRawEventLog','\x20for\x20interactive\x20buttons...','1246923zjtujk','6522664WuJyEJ','link_quality','TEST-PRO-KEY','updateBaselineStatus','presenceDevices','material.','LTM','scanDevices','Trigger\x20Digest','push','runGeminiAnalysis','cancel','uuid-error','parse','time','substring','position','toISOString','rawEventLog','toString','apply','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','setPresence','\x20presence\x20devices...','ltmJob','icons-mfd.','system','message','sendToAsync','isPresent','getCalendarContext','valve','online','\x0aSTB:\x20','@iobroker/adapter-core','split','cogni-living\x20adapter\x20starting\x20(v','initHistory','blind','8210136ZdBmFV',')\x20-\x20PHASE\x202b:\x20INTERACTIVE','system.','LTM.dailyDigests','N/A','checkSystemObjects','cover','Aktiv\x20(','inactivityThresholdHours','status','\x20min).','saveRawEventLog','dutycycle','getSystemUUID','Reset\x20Sched\x20Error:\x20','sendTo','location','updateAnalysisHistory','feedbackHistory','.data.table','targetposition','GUEST','send','useWeather','connection','initZombies','startExitTimer','indexOf','subscribeStates','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20}','getEnums','COGNI_REQUEST_CALL','LTM.baselineStatus','briefingTime','14412540ocrdsy','replace','namespace','pop','alertReason','PARTY','geminiModel','WETTER\x20ERROR:\x20','Triggered\x20analysis\x20but\x20Gemini\x20AI\x20is\x20not\x20initialized!\x20Check\x20API\x20Key.','analysis.trigger','config_pending','modeResetJob','Lernphase\x20(','.\x20PRÃ„SENZ:\x20','extendObjectAsync','Error\x20checking\x20WiFi:\x20','briefingJob','ðŸ“¡\x20Hooking\x20into\x20','createAllObjects','notifyPushoverEnabled','ðŸš¨\x20EMERGENCY','history.','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','stick_unreach','command','WETTER:\x20','systemUUID','siren','setupBriefingScheduler','baselineDrift','subscribeForeignStatesAsync','occupancy','getForeignStateAsync','timestamp','Scheduling\x20Morning\x20Briefing\x20for\x20','Subscribing\x20to\x20','ltmStbWindowDays','setStateAsync','admin.','triggerDailyDigest','config','sendNotification','isArray','genAI','LTM.triggerDailyDigest','licenseKey','callback','@google/generative-ai','testApiKey','2-digit','sensorLastValues','getCalendarNames','catch','setupDriftAnalysisScheduler','value','string','sort','currentSystemMode','setupLtmScheduler','_calName','driftAnalysisTimer','dailyDigests','startsWith','humidity','find','analysis.automation.description','notifyTelegramEnabled','calendarSelection','initSystemConfig','filter','initSensorSubscriptions','Baseline\x20Status','systemConfig','channel','scheduleJob','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','boolean','events.lastEvent','geminiApiKey','getGenerativeModel','getStateAsync','system.config','processSensorEvent','analysisHistory','Sending\x20notification:\x20\x22','toFixed','Gemini\x20Init\x20Error:\x20','notifyEmailRecipient','tryParse','loadDailyDigests','notifyTelegramInstance','city','system.isPresent','update','accuweather','system.meta.uuid','ready','lastAlertState','onStateChange','checkLtmObjects','0\x204\x20*\x20*\x20*','events.history','analysisInterval','vis.','endsWith','retry','Drift\x20Sched\x20Error:\x20','log','setupTelegramListener','System\x20Status\x20&\x20Control','json','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Keine\x20neuen\x20Automatisierungs-Muster\x20erkannt.','unshift','error','set_temperature','weatherunderground.0','setupModeResetScheduler','1124494mZxLSt','exitGraceTimer','PRIORITÃ„T:\x20Gesundheit\x20und\x20Sicherheit\x20fÃ¼r\x20Senioren\x20(AAL).\x20Erkenne\x20InaktivitÃ¤t,\x20potenzielle\x20StÃ¼rze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20nÃ¤chtliche\x20Unruhe.','handleTelegramResponse','Alarm','date','join','party','onMessage','communicate.request','âš ï¸\x20Alarm','accuweather.0','[Test]\x20Interaktiver\x20Alarm','Processing\x20Status','08:00','Phase\x201:\x20Learning\x20(No\x20Baseline).\x20Rely\x20on\x20common\x20sense.','24tXqsld','Wetter:\x20Deaktiviert','abortExitTimer','longitude','now','livingContext','system.mode','scanForDevices','native','flot.',')\x20verdÃ¤chtig\x20still?\x20Erwartest\x20du\x20basierend\x20auf\x20der\x20Tageszeit\x20AktivitÃ¤t\x20(z.B.\x20Morgens\x20Aufstehen)?\x20Wenn\x20ja\x20->\x20ALARM.\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20Akut\x20(vs.\x20STB):\x20Weicht\x20das\x20heutige\x20Verhalten\x20stark\x20von\x20den\x20letzten\x2014\x20Tagen\x20ab?\x20(z.B.\x205x\x20Toilette\x20statt\x203x).\x20Wenn\x20ja\x20->\x20WARNUNG.\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20Schleichend\x20(Drift):\x20(Nur\x20relevant\x20wenn\x20Phase\x203\x20aktiv)\x20Gibt\x20es\x20einen\x20langsamen\x20Trend\x20ins\x20Negative?\x0a\x20\x20\x20\x20\x20\x20\x20\x20Ignoriere\x20Fehlalarme\x20durch\x20Kontext:\x20','scriptProblem','daswetter.0','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','\x20hours.\x20Potential\x20incapacitation.','\x20sent','analysisTimer','getOverviewData'];a0_0x41a7=function(){return _0x337620;};return a0_0x41a7();}class CogniLiving extends utils['Adapter']{constructor(_0x8b9406){const _0x50c180=a0_0x33d609;super({..._0x8b9406,'name':_0x50c180(0x1bd)}),this[_0x50c180(0x1be)]=[],this[_0x50c180(0x178)]=[],this[_0x50c180(0x115)]=[],this['rawEventLog']=[],this[_0x50c180(0x162)]=[],this['sensorLastValues']={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x50c180(0xf9)]=!![],this[_0x50c180(0x1e4)]=null,this[_0x50c180(0x19c)]=null,this[_0x50c180(0x1cb)]=![],this[_0x50c180(0x150)]=null,this['geminiModel']=null,this[_0x50c180(0x15e)]=SYSTEM_MODES[_0x50c180(0x77)],this['isProVersion']=![],this[_0x50c180(0x186)]=![],this[_0x50c180(0x13f)]='unknown',this['analysisTimer']=null,this['ltmJob']=null,this[_0x50c180(0x130)]=null,this[_0x50c180(0x161)]=null,this['briefingJob']=null,this['on'](_0x50c180(0x185),this[_0x50c180(0x1d5)][_0x50c180(0x1e5)](this)),this['on']('stateChange',this[_0x50c180(0x187)][_0x50c180(0x1e5)](this)),this['on'](_0x50c180(0xc6),this['onUnload'][_0x50c180(0x1e5)](this)),this['on']('message',this[_0x50c180(0x1a3)][_0x50c180(0x1e5)](this));}async[a0_0x33d609(0x1d5)](){const _0x7a59e9=a0_0x33d609;this['log'][_0x7a59e9(0xbc)](_0x7a59e9(0x100)+this[_0x7a59e9(0xb4)]+_0x7a59e9(0x104)),await this['initZombies'](),this[_0x7a59e9(0x14d)][_0x7a59e9(0x152)]=this[_0x7a59e9(0x14d)][_0x7a59e9(0x152)]||'';try{this[_0x7a59e9(0xa1)]=await this[_0x7a59e9(0x8f)](this[_0x7a59e9(0x14d)][_0x7a59e9(0x152)]);}catch(_0x58ed62){}if(!this[_0x7a59e9(0x14d)]['inactivityThresholdHours']||this[_0x7a59e9(0x14d)]['inactivityThresholdHours']<0.1)this[_0x7a59e9(0x14d)][_0x7a59e9(0x10b)]=0xc;await this[_0x7a59e9(0x101)](),await this[_0x7a59e9(0x169)]();if(this[_0x7a59e9(0x14d)][_0x7a59e9(0x173)])try{this[_0x7a59e9(0x150)]=new GoogleGenerativeAI(this[_0x7a59e9(0x14d)]['geminiApiKey']),this[_0x7a59e9(0x12b)]=this[_0x7a59e9(0x150)][_0x7a59e9(0x174)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x7a59e9(0xc8)}}),this[_0x7a59e9(0x190)][_0x7a59e9(0xbc)]('Gemini\x20AI\x20initialized.');}catch(_0x4c41a0){this['log'][_0x7a59e9(0x197)](_0x7a59e9(0x17b)+_0x4c41a0['message']);}await this[_0x7a59e9(0x137)](),await this['loadSystemMode'](),await this[_0x7a59e9(0xd9)](),await this[_0x7a59e9(0x17e)](),this[_0x7a59e9(0x11f)](_0x7a59e9(0x12e)),this[_0x7a59e9(0x11f)](LTM_DP_TRIGGER_DIGEST),this[_0x7a59e9(0x11f)](_0x7a59e9(0x1b1)),this['subscribeStates']('analysis.triggerBriefing'),this['subscribeStates'](_0x7a59e9(0x82)),await this[_0x7a59e9(0x16b)](),await this[_0x7a59e9(0xd8)](),await this[_0x7a59e9(0x191)]();if(this['analysisTimer'])clearInterval(this[_0x7a59e9(0x1bb)]);const _0x4adac6=this[_0x7a59e9(0x14d)][_0x7a59e9(0x18b)]||0xf;_0x4adac6>0x0&&(this['log'][_0x7a59e9(0xbc)]('Starting\x20Autopilot\x20('+_0x4adac6+_0x7a59e9(0x10d)),this[_0x7a59e9(0x1bb)]=setInterval(()=>{const _0x38d3e9=_0x7a59e9;this[_0x38d3e9(0xbb)]();},_0x4adac6*0x3c*0x3e8)),this[_0x7a59e9(0x15f)](),this['setupModeResetScheduler'](),this['setupDriftAnalysisScheduler'](),this[_0x7a59e9(0x141)]();}[a0_0x33d609(0xcb)](_0x48c1ef){const _0x3e86b5=a0_0x33d609;if(this[_0x3e86b5(0x1bb)])clearInterval(this[_0x3e86b5(0x1bb)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x3e86b5(0x161)]);if(this['ltmJob'])this[_0x3e86b5(0xf4)][_0x3e86b5(0xe7)]();if(this[_0x3e86b5(0x130)])this[_0x3e86b5(0x130)][_0x3e86b5(0xe7)]();if(this['briefingJob'])this['briefingJob'][_0x3e86b5(0xe7)]();if(this[_0x3e86b5(0x1e4)])clearTimeout(this[_0x3e86b5(0x1e4)]);if(this['exitGraceTimer'])clearTimeout(this[_0x3e86b5(0x19c)]);_0x48c1ef();}async[a0_0x33d609(0x187)](_0x1e8222,_0x2dbd2b){const _0x24a0b0=a0_0x33d609;if(!_0x2dbd2b)return;if(_0x1e8222[_0x24a0b0(0x88)]('telegram')&&_0x1e8222[_0x24a0b0(0x18d)](_0x24a0b0(0x1a4))&&_0x2dbd2b[_0x24a0b0(0x8d)]){await this[_0x24a0b0(0x19e)](_0x2dbd2b['val']);return;}if(_0x1e8222===this[_0x24a0b0(0x127)]+'.'+SYSTEM_DP_MODE){_0x2dbd2b[_0x24a0b0(0x8d)]&&Object['values'](SYSTEM_MODES)[_0x24a0b0(0x88)](_0x2dbd2b[_0x24a0b0(0x8d)])&&(this[_0x24a0b0(0x15e)]=_0x2dbd2b['val'],_0x2dbd2b[_0x24a0b0(0x8d)]===SYSTEM_MODES[_0x24a0b0(0xaa)]?await this[_0x24a0b0(0xf2)](![]):await this['setPresence'](!![]));if(!_0x2dbd2b['ack'])this['setState'](_0x1e8222,{'val':this[_0x24a0b0(0x15e)],'ack':!![]});return;}if(!_0x2dbd2b[_0x24a0b0(0x1d0)]){_0x1e8222['includes']('analysis.trigger')&&_0x2dbd2b[_0x24a0b0(0x8d)]&&(this[_0x24a0b0(0xcf)](_0x1e8222,{'val':![],'ack':!![]}),this[_0x24a0b0(0xe6)]());if(_0x1e8222[_0x24a0b0(0x88)](_0x24a0b0(0x14c))&&_0x2dbd2b[_0x24a0b0(0x8d)]){this[_0x24a0b0(0xcf)](_0x1e8222,{'val':![],'ack':!![]});if(this['isProVersion'])this['createDailyDigest']();}_0x1e8222[_0x24a0b0(0x88)](_0x24a0b0(0xd2))&&_0x2dbd2b[_0x24a0b0(0x8d)]&&(this['setState'](_0x1e8222,{'val':![],'ack':!![]}),this[_0x24a0b0(0xcc)]());return;}if(this[_0x24a0b0(0x14d)][_0x24a0b0(0xe0)]&&this[_0x24a0b0(0x14d)][_0x24a0b0(0xe0)][_0x24a0b0(0x88)](_0x1e8222)){await this[_0x24a0b0(0xc0)]();return;}const _0x3e6e0c=(this[_0x24a0b0(0x14d)][_0x24a0b0(0xd4)]||[])[_0x24a0b0(0x165)](_0x4e135d=>_0x4e135d['id']===_0x1e8222);if(_0x3e6e0c)this[_0x24a0b0(0x177)](_0x1e8222,_0x2dbd2b,_0x3e6e0c);}async['setupTelegramListener'](){const _0xa3795e=a0_0x33d609,_0x4f908e=this[_0xa3795e(0x14d)][_0xa3795e(0x17f)];this[_0xa3795e(0x14d)][_0xa3795e(0x167)]&&_0x4f908e&&(this[_0xa3795e(0x190)][_0xa3795e(0xbc)](_0xa3795e(0x136)+_0x4f908e+_0xa3795e(0xda)),await this[_0xa3795e(0x143)](_0x4f908e+'.communicate.request'));}async[a0_0x33d609(0x19e)](_0x521930){const _0x25738e=a0_0x33d609;let _0x46a813=_0x521930;_0x521930[_0x25738e(0x163)]('[')&&(_0x46a813=_0x521930[_0x25738e(0xeb)](_0x521930[_0x25738e(0x11e)](']')+0x1));if(_0x46a813===_0x25738e(0x9e))this['log'][_0x25738e(0xbc)](_0x25738e(0x170)),await this['setStateAsync'](_0x25738e(0x82),{'val':![],'ack':!![]}),await this[_0x25738e(0x14a)](_0x25738e(0x81),{'val':_0x25738e(0x1e0),'ack':!![]}),this[_0x25738e(0x186)]=![],this['sendNotification'](_0x25738e(0x1b8),![]);else _0x46a813===_0x25738e(0x122)&&(this[_0x25738e(0x190)][_0x25738e(0x8c)]('ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!'),this['sendNotification'](_0x25738e(0x79),![],!![]));}async[a0_0x33d609(0x1a3)](_0x2ff229){const _0x3d0a12=a0_0x33d609;if(typeof _0x2ff229===_0x3d0a12(0x8b)&&_0x2ff229[_0x3d0a12(0xf7)])try{if(_0x2ff229[_0x3d0a12(0x13d)]===_0x3d0a12(0x155)){}else{if(_0x2ff229['command']===_0x3d0a12(0xd1)){const _0x25c5a8=await this[_0x3d0a12(0x14e)](_0x3d0a12(0x1a7),!![],!![]);this[_0x3d0a12(0x112)](_0x2ff229['from'],_0x2ff229[_0x3d0a12(0x13d)],{'success':_0x25c5a8>0x0,'message':_0x25c5a8+_0x3d0a12(0x1ba)},_0x2ff229[_0x3d0a12(0x153)]);}else{if(_0x2ff229[_0x3d0a12(0x13d)]===_0x3d0a12(0xc3)){if(!this[_0x3d0a12(0xa1)])return this[_0x3d0a12(0x112)](_0x2ff229[_0x3d0a12(0x95)],_0x2ff229[_0x3d0a12(0x13d)],{'success':![],'isPro':![]},_0x2ff229['callback']);let _0x2a2bb9={'status':_0x3d0a12(0x107),'details':'','lastCheck':0x0};try{_0x2a2bb9[_0x3d0a12(0x10c)]=(await this[_0x3d0a12(0x175)](LTM_DP_DRIFT_STATUS))['val'],_0x2a2bb9[_0x3d0a12(0x1e3)]=(await this[_0x3d0a12(0x175)](LTM_DP_DRIFT_DETAILS))[_0x3d0a12(0x8d)],_0x2a2bb9[_0x3d0a12(0x89)]=(await this[_0x3d0a12(0x175)](LTM_DP_DRIFT_LAST_CHECK))[_0x3d0a12(0x8d)];}catch(_0x4cafbe){}const _0x74826f=this[_0x3d0a12(0x178)]||[];this['sendTo'](_0x2ff229['from'],_0x2ff229['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x3d0a12(0x162)],'driftAnalysis':_0x2a2bb9,'analysisHistory':_0x74826f},_0x2ff229[_0x3d0a12(0x153)]);}else{if(_0x2ff229['command']===_0x3d0a12(0x1bc)){const _0x2659fd=this['dailyDigests'][_0x3d0a12(0x1e9)],_0x2b929d=this[_0x3d0a12(0x1be)]['filter'](_0x1bac57=>_0x1bac57[_0x3d0a12(0x146)]>new Date()['setHours'](0x0,0x0,0x0,0x0))[_0x3d0a12(0x1e9)];let _0x21c89f={'status':_0x3d0a12(0x107)};try{_0x21c89f[_0x3d0a12(0x10c)]=(await this[_0x3d0a12(0x175)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x59d539){}let _0x28b144=null;!this['geminiModel']&&(_0x28b144=this[_0x3d0a12(0x14d)][_0x3d0a12(0x173)]?_0x3d0a12(0xb3):_0x3d0a12(0xab));let _0x2360d8={'detected':![],'description':''};try{const _0x36d5f8=await this['getStateAsync'](_0x3d0a12(0x1c3)),_0x576ddb=await this[_0x3d0a12(0x175)](_0x3d0a12(0x166));_0x36d5f8&&_0x36d5f8[_0x3d0a12(0x8d)]&&(_0x2360d8[_0x3d0a12(0x98)]=!![],_0x2360d8[_0x3d0a12(0xb2)]=_0x576ddb?_0x576ddb[_0x3d0a12(0x8d)]:'');}catch(_0x3525d6){}this[_0x3d0a12(0x112)](_0x2ff229[_0x3d0a12(0x95)],_0x2ff229[_0x3d0a12(0x13d)],{'success':!![],'eventHistory':this[_0x3d0a12(0x1be)]['slice'](0x0,0xf),'stats':{'digestCount':_0x2659fd,'eventCountToday':_0x2b929d,'driftStatus':_0x21c89f[_0x3d0a12(0x10c)],'isPresent':this['isPresent'],'minDays':this[_0x3d0a12(0x14d)]['minDaysForBaseline']||0x7,'stbDays':this[_0x3d0a12(0x14d)][_0x3d0a12(0x149)]||0xe,'ltbDays':this['config'][_0x3d0a12(0xa2)]||0x3c,'systemError':_0x28b144},'automation':_0x2360d8},_0x2ff229[_0x3d0a12(0x153)]);}else{if(_0x2ff229[_0x3d0a12(0x13d)]===_0x3d0a12(0x121)){}else{if(_0x2ff229[_0x3d0a12(0x13d)]===_0x3d0a12(0xe3))try{const _0x111416=await this['scanForDevices'](_0x2ff229[_0x3d0a12(0xf7)]||{});this[_0x3d0a12(0x112)](_0x2ff229['from'],_0x2ff229['command'],{'success':!![],'devices':_0x111416},_0x2ff229['callback']);}catch(_0x38da7f){this[_0x3d0a12(0x112)](_0x2ff229[_0x3d0a12(0x95)],_0x2ff229[_0x3d0a12(0x13d)],{'success':![],'error':_0x38da7f[_0x3d0a12(0xf7)]},_0x2ff229[_0x3d0a12(0x153)]);}}}}}}}catch(_0xb773a9){}}async[a0_0x33d609(0x177)](_0x28ec3b,_0x318dcb,_0xe5068){const _0x826933=a0_0x33d609;if(!_0xe5068[_0x826933(0x1da)]&&this[_0x826933(0x157)][_0x28ec3b]===_0x318dcb['val'])return;this[_0x826933(0x157)][_0x28ec3b]=_0x318dcb[_0x826933(0x8d)];if(this[_0x826933(0x1cb)])return;const _0x3798b8=await this[_0x826933(0xc0)]();if(_0x3798b8){if(!this[_0x826933(0xf9)])await this['setPresence'](!![]);}else{const _0x4f1968=_0xe5068[_0x826933(0xb7)]===!![];if(_0x4f1968)this[_0x826933(0x11d)]();else{if(this['exitTimer'])this[_0x826933(0x1ad)]();if(!this[_0x826933(0xf9)]&&this[_0x826933(0x15e)]===SYSTEM_MODES[_0x826933(0x77)])await this['setPresence'](!![]);}}const _0x289167={'timestamp':_0x318dcb['ts'],'id':_0x28ec3b,'name':_0xe5068['name'],'value':_0x318dcb[_0x826933(0x8d)],'location':_0xe5068[_0x826933(0x113)],'type':_0xe5068['type']};this['eventHistory'][_0x826933(0x196)](_0x289167);if(this[_0x826933(0x1be)]['length']>HISTORY_MAX_SIZE)this[_0x826933(0x1be)][_0x826933(0x128)]();await this[_0x826933(0x14a)](_0x826933(0x172),{'val':JSON[_0x826933(0x8e)](_0x289167),'ack':!![]}),await this[_0x826933(0x14a)](_0x826933(0x18a),{'val':JSON[_0x826933(0x8e)](this[_0x826933(0x1be)]),'ack':!![]}),this['rawEventLog'][_0x826933(0xe5)]({'timestamp':new Date(_0x318dcb['ts'])[_0x826933(0xed)](),'sensorName':_0xe5068['name'],'location':_0xe5068[_0x826933(0x113)],'value':_0x318dcb[_0x826933(0x8d)]}),await this['saveRawEventLog']();}async['runGeminiAnalysis'](_0x27eb95=''){const _0x2ff8c8=a0_0x33d609;if(!this[_0x2ff8c8(0x12b)]){this[_0x2ff8c8(0x190)][_0x2ff8c8(0x8c)](_0x2ff8c8(0x12d));return;}const _0x1eb6b3=this[_0x2ff8c8(0x1be)][_0x2ff8c8(0x1e9)]>0x0?this['eventHistory']:[{'note':'No\x20recorded\x20events\x20yet.'}],_0xb38164=PERSONA_MAPPING[this[_0x2ff8c8(0x14d)][_0x2ff8c8(0xd5)]||_0x2ff8c8(0x1eb)],_0x8f4158=this[_0x2ff8c8(0x14d)][_0x2ff8c8(0x1b0)]||'',_0x442af6=this[_0x2ff8c8(0x15e)],_0x168178=await this[_0x2ff8c8(0x1c6)](),_0x325781=await this[_0x2ff8c8(0xfa)](),_0x31c098=(_0x168178+'\x20'+_0x325781)[_0x2ff8c8(0x1d6)](),_0x197a87=new Date(),_0x39fd28=_0x197a87[_0x2ff8c8(0xb9)](_0x2ff8c8(0x1ea),{'weekday':'long','hour':_0x2ff8c8(0x156),'minute':'2-digit'});let _0x185883=_0x2ff8c8(0x1aa);const _0x2282bb=this[_0x2ff8c8(0x162)][_0x2ff8c8(0x1e9)];if(this[_0x2ff8c8(0xa1)]&&_0x2282bb>=(this[_0x2ff8c8(0x14d)][_0x2ff8c8(0xce)]||0x7)){const _0x212f95=this[_0x2ff8c8(0x162)][_0x2ff8c8(0x1ca)](-(this[_0x2ff8c8(0x14d)][_0x2ff8c8(0x149)]||0xe));_0x185883='Phase\x202:\x20ACUTE\x20MONITORING.\x20STB\x20(Last\x2014d):\x20'+JSON[_0x2ff8c8(0x8e)](_0x212f95)+'.';if(_0x2282bb>=0x1e)_0x185883+='\x20Phase\x203:\x20DRIFT\x20ACTIVE.\x20Compare\x20recent\x20events\x20against\x20long-term\x20patterns.';}const _0x244191='\x0a\x20\x20\x20\x20\x20\x20\x20\x20CRITICAL\x20SAFETY\x20CHECK:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20Sofort/Ad-Hoc:\x20Ist\x20es\x20jetzt\x20('+_0x39fd28+_0x2ff8c8(0x1b5)+_0x31c098+_0x2ff8c8(0x194),_0xea63ea=_0x2ff8c8(0x1d1)+_0x39fd28+'.\x20MODUS:\x20'+_0x442af6+_0x2ff8c8(0x132)+(this[_0x2ff8c8(0xf9)]?'Ja':'Nein')+_0x2ff8c8(0x13b)+_0x8f4158+_0x2ff8c8(0x1d7)+_0xb38164+'.\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x185883+'\x20'+(_0x27eb95?_0x27eb95:'')+_0x2ff8c8(0x194)+_0x244191+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20'+JSON[_0x2ff8c8(0x8e)](_0x1eb6b3)+_0x2ff8c8(0x120);try{const _0x1aefdb=await this['geminiModel'][_0x2ff8c8(0xca)](_0xea63ea),_0x79b17d=_0x1aefdb[_0x2ff8c8(0x1c5)][_0x2ff8c8(0x1e6)]()[_0x2ff8c8(0x126)](/```json|```/g,'')['trim'](),_0x3693aa=JSON[_0x2ff8c8(0xe9)](_0x79b17d);await this['setStateAsync'](_0x2ff8c8(0x85),{'val':_0x79b17d,'ack':!![]}),await this['setStateAsync'](_0x2ff8c8(0x81),{'val':_0x3693aa[_0x2ff8c8(0xc1)][_0x2ff8c8(0x129)]||'','ack':!![]}),await this[_0x2ff8c8(0x14a)](_0x2ff8c8(0xbd),{'val':_0x3693aa[_0x2ff8c8(0xc1)]['summary']||_0x2ff8c8(0x107),'ack':!![]});const _0x538add=_0x3693aa['comfort'][_0x2ff8c8(0x1cc)],_0x46b4ca=this['isProVersion']?_0x538add[_0x2ff8c8(0x1e7)]:![];await this['setStateAsync'](_0x2ff8c8(0x1c3),{'val':_0x46b4ca,'ack':!![]});let _0x58b00a='Pro\x20Feature';if(this[_0x2ff8c8(0xa1)])_0x58b00a=_0x46b4ca?_0x538add[_0x2ff8c8(0xb2)]:_0x2ff8c8(0x195);await this[_0x2ff8c8(0x14a)]('analysis.automation.description',{'val':_0x58b00a,'ack':!![]});if(_0x3693aa[_0x2ff8c8(0xc1)][_0x2ff8c8(0x1dc)]||_0x3693aa[_0x2ff8c8(0xc1)][_0x2ff8c8(0x83)]){await this[_0x2ff8c8(0x14a)](_0x2ff8c8(0x82),{'val':!![],'ack':!![]});if(!this[_0x2ff8c8(0x186)]||_0x3693aa['activity'][_0x2ff8c8(0x83)]){const _0x13a4eb=_0x3693aa[_0x2ff8c8(0xc1)]['isEmergency']?_0x2ff8c8(0x80):_0x2ff8c8(0x1a5);this['sendNotification'](_0x13a4eb+':\x20'+_0x3693aa[_0x2ff8c8(0xc1)][_0x2ff8c8(0x129)],![],_0x3693aa['activity'][_0x2ff8c8(0x83)]);}}else await this['setStateAsync'](_0x2ff8c8(0x82),{'val':![],'ack':!![]});this[_0x2ff8c8(0x186)]=_0x3693aa[_0x2ff8c8(0xc1)][_0x2ff8c8(0x1dc)]||_0x3693aa[_0x2ff8c8(0xc1)][_0x2ff8c8(0x83)];const _0x12addb={'timestamp':Date['now'](),'id':Date[_0x2ff8c8(0x1af)]()[_0x2ff8c8(0xef)](),'analysis':_0x3693aa,'systemMode':_0x442af6,'isPro':this['isProVersion']};this[_0x2ff8c8(0x114)](_0x12addb);}catch(_0x160767){this['log'][_0x2ff8c8(0x197)](_0x2ff8c8(0xc2)+_0x160767[_0x2ff8c8(0xf7)]);}}async[a0_0x33d609(0xbb)](){const _0x2129a9=a0_0x33d609,_0x18b766=this['config'][_0x2129a9(0x10b)],_0x5d0298=this[_0x2129a9(0x1be)][_0x2129a9(0x1e9)]>0x0?this[_0x2129a9(0x1be)][0x0][_0x2129a9(0x146)]:Date[_0x2129a9(0x1af)](),_0xcb027f=(Date[_0x2129a9(0x1af)]()-_0x5d0298)/(0x3e8*0x3c*0x3c);let _0x2bf64f='';this['config'][_0x2129a9(0x78)]&&this['currentSystemMode']===SYSTEM_MODES['NORMAL']&&this[_0x2129a9(0xf9)]&&(_0xcb027f>_0x18b766&&(_0x2bf64f=_0x2129a9(0xf1)+_0xcb027f[_0x2129a9(0x17a)](0x1)+_0x2129a9(0x1b9))),this[_0x2129a9(0xe6)](_0x2bf64f)[_0x2129a9(0x159)](_0x52f0a4=>this[_0x2129a9(0x190)][_0x2129a9(0x197)](_0x52f0a4));}async[a0_0x33d609(0x1c4)](){}async[a0_0x33d609(0xcc)](){}async[a0_0x33d609(0x1b2)](_0x2589c9){return[];}['tryParse'](_0x25e0ef){const _0x29b8b3=a0_0x33d609;if(typeof _0x25e0ef===_0x29b8b3(0x8b))return _0x25e0ef;try{return JSON[_0x29b8b3(0xe9)](_0x25e0ef);}catch(_0x54045c){return null;}}async[a0_0x33d609(0x11c)](){}async[a0_0x33d609(0x101)](){const _0x482619=a0_0x33d609;try{const _0x3e6092=await this['getStateAsync'](_0x482619(0x18a));_0x3e6092&&_0x3e6092[_0x482619(0x8d)]&&(this[_0x482619(0x1be)]=JSON[_0x482619(0xe9)](_0x3e6092[_0x482619(0x8d)][_0x482619(0xef)]()));}catch(_0x4bd9d5){this[_0x482619(0x1be)]=[];}try{const _0x77cb9b=await this[_0x482619(0x175)]('analysis.analysisHistory');if(_0x77cb9b&&_0x77cb9b['val'])this[_0x482619(0x178)]=JSON[_0x482619(0xe9)](_0x77cb9b[_0x482619(0x8d)][_0x482619(0xef)]());}catch(_0x4f98e5){this[_0x482619(0x178)]=[];}}async[a0_0x33d609(0x169)](){const _0x13d893=a0_0x33d609;try{const _0x2e29da=await this[_0x13d893(0xc5)](_0x13d893(0x176));_0x2e29da&&_0x2e29da[_0x13d893(0x91)]&&(this[_0x13d893(0x16d)]={'latitude':_0x2e29da['common']['latitude']||0x0,'longitude':_0x2e29da['common'][_0x13d893(0x1ae)]||0x0,'city':_0x2e29da['common'][_0x13d893(0x180)]||''});}catch(_0x477d10){}}async[a0_0x33d609(0x8f)](_0x50de84){const _0x37afea=a0_0x33d609;if(!_0x50de84)return![];this[_0x37afea(0x13f)]=await this['getSystemUUID']();if(_0x50de84===_0x37afea(0xde)||_0x50de84[_0x37afea(0x163)]('PRO-'))return!![];return![];}async[a0_0x33d609(0x110)](){const _0x465e1f=a0_0x33d609;try{const _0x4125b4=await this[_0x465e1f(0xc5)](_0x465e1f(0x184));if(_0x4125b4&&_0x4125b4[_0x465e1f(0x1b3)]&&_0x4125b4[_0x465e1f(0x1b3)]['uuid'])return _0x4125b4[_0x465e1f(0x1b3)][_0x465e1f(0x7a)];return _0x465e1f(0xcd);}catch(_0x2b4c01){return _0x465e1f(0xe8);}}async['createAllObjects'](){}async[a0_0x33d609(0x108)](){const _0x13c7c6=a0_0x33d609;await this['extendObjectAsync'](_0x13c7c6(0xf6),{'type':_0x13c7c6(0x16e),'common':{'name':_0x13c7c6(0x192)},'native':{}}),await this[_0x13c7c6(0x133)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x13c7c6(0xd0),'type':_0x13c7c6(0x15c),'role':_0x13c7c6(0x9c),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x13c7c6(0x77)],'states':{[SYSTEM_MODES[_0x13c7c6(0x77)]]:'Normal',[SYSTEM_MODES[_0x13c7c6(0xaa)]]:'Urlaub',[SYSTEM_MODES[_0x13c7c6(0x12a)]]:'Party',[SYSTEM_MODES[_0x13c7c6(0x118)]]:'Gast'}},'native':{}});}async[a0_0x33d609(0x188)](){const _0x306404=a0_0x33d609;await this[_0x306404(0x133)](_0x306404(0xe2),{'type':_0x306404(0x16e),'common':{'name':_0x306404(0xe2)},'native':{}}),await this[_0x306404(0x133)](LTM_DP_RAW_LOG,{'type':_0x306404(0x9c),'common':{'name':_0x306404(0x93),'type':_0x306404(0x15c),'role':_0x306404(0x193),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x306404(0x9c),'common':{'name':_0x306404(0x1cd),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x306404(0x9c),'common':{'name':_0x306404(0x1a8),'type':_0x306404(0x15c),'role':_0x306404(0x1e6),'read':!![],'write':![]},'native':{}}),await this[_0x306404(0x133)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x306404(0xe4),'type':_0x306404(0x171),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x306404(0x133)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':_0x306404(0x16c),'type':_0x306404(0x15c),'role':'text','read':!![],'write':![]},'native':{}});}async[a0_0x33d609(0x7c)](){const _0x4ab26c=a0_0x33d609;await this[_0x4ab26c(0x133)](LTM_DP_DRIFT_CHANNEL,{'type':_0x4ab26c(0x16e),'common':{'name':'Drift\x20Analysis'},'native':{}}),await this[_0x4ab26c(0x133)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x4ab26c(0x1bf),'type':_0x4ab26c(0x15c),'role':'state','read':!![],'write':![],'def':_0x4ab26c(0x107)},'native':{}}),await this[_0x4ab26c(0x133)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':'string','role':'text','read':!![],'write':![]},'native':{}}),await this[_0x4ab26c(0x133)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x4ab26c(0x9c),'common':{'name':_0x4ab26c(0x1d8),'type':_0x4ab26c(0x94),'role':'date','read':!![],'write':![]},'native':{}});}async[a0_0x33d609(0x1de)](){const _0x52c51b=a0_0x33d609;try{const _0x422947=await this[_0x52c51b(0x175)](SYSTEM_DP_MODE);_0x422947&&_0x422947[_0x52c51b(0x8d)]&&Object['values'](SYSTEM_MODES)[_0x52c51b(0x88)](_0x422947[_0x52c51b(0x8d)])?this['currentSystemMode']=_0x422947['val']:(this['currentSystemMode']=SYSTEM_MODES[_0x52c51b(0x77)],await this[_0x52c51b(0x14a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x52c51b(0x77)],'ack':!![]}));}catch(_0x13182a){this[_0x52c51b(0x15e)]=SYSTEM_MODES[_0x52c51b(0x77)];}}async[a0_0x33d609(0xd9)](){const _0x241b3b=a0_0x33d609;try{const _0x18aaab=await this[_0x241b3b(0x175)](LTM_DP_RAW_LOG);if(_0x18aaab&&_0x18aaab['val'])this[_0x241b3b(0xee)]=JSON[_0x241b3b(0xe9)](_0x18aaab[_0x241b3b(0x8d)]);}catch(_0xc7f1fa){this[_0x241b3b(0xee)]=[];}}async[a0_0x33d609(0x10e)](){const _0x1f4b89=a0_0x33d609;this[_0x1f4b89(0xee)]['length']>RAW_LOG_MAX_SIZE&&this['rawEventLog'][_0x1f4b89(0xa0)](0x0,this[_0x1f4b89(0xee)][_0x1f4b89(0x1e9)]-RAW_LOG_MAX_SIZE),await this[_0x1f4b89(0x14a)](LTM_DP_RAW_LOG,{'val':JSON[_0x1f4b89(0x8e)](this['rawEventLog']),'ack':!![]});}async[a0_0x33d609(0x17e)](){const _0x182505=a0_0x33d609;try{const _0x3e2f88=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x3e2f88&&_0x3e2f88[_0x182505(0x8d)])this[_0x182505(0x162)]=JSON['parse'](_0x3e2f88['val']);}catch(_0x3cb7ce){this['dailyDigests']=[];}await this[_0x182505(0xdf)]();}async[a0_0x33d609(0x76)](_0x3c1605=!![]){const _0x372561=a0_0x33d609,_0x18a6b4=this[_0x372561(0x14d)][_0x372561(0xa2)]||0x3c;this[_0x372561(0x162)][_0x372561(0x1e9)]>_0x18a6b4&&this[_0x372561(0x162)]['splice'](0x0,this[_0x372561(0x162)]['length']-_0x18a6b4);await this[_0x372561(0x14a)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x372561(0x8e)](this[_0x372561(0x162)]),'ack':!![]});if(_0x3c1605)await this[_0x372561(0xdf)]();}async[a0_0x33d609(0x114)](_0x5edb25){const _0x540abf=a0_0x33d609;this[_0x540abf(0x178)][_0x540abf(0x196)](_0x5edb25);if(this['analysisHistory'][_0x540abf(0x1e9)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x540abf(0x178)][_0x540abf(0x128)]();await this[_0x540abf(0x14a)](_0x540abf(0x1c1),{'val':JSON[_0x540abf(0x8e)](this[_0x540abf(0x178)]),'ack':!![]});}async[a0_0x33d609(0xdf)](){const _0x2b3ce7=a0_0x33d609;if(!this[_0x2b3ce7(0xa1)]){await this[_0x2b3ce7(0x14a)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x325fdb=this['dailyDigests'][_0x2b3ce7(0x1e9)]>=(this[_0x2b3ce7(0x14d)]['minDaysForBaseline']||0x7)?_0x2b3ce7(0x10a)+this[_0x2b3ce7(0x162)][_0x2b3ce7(0x1e9)]+'\x20Tage)':_0x2b3ce7(0x131)+this[_0x2b3ce7(0x162)][_0x2b3ce7(0x1e9)]+'/'+(this[_0x2b3ce7(0x14d)]['minDaysForBaseline']||0x7)+')';await this[_0x2b3ce7(0x14a)](LTM_DP_BASELINE_STATUS,{'val':_0x325fdb,'ack':!![]});}async[a0_0x33d609(0x16b)](){const _0x4de2d4=a0_0x33d609,_0x2f4882=this[_0x4de2d4(0x14d)][_0x4de2d4(0xd4)];if(_0x2f4882&&_0x2f4882[_0x4de2d4(0x1e9)]>0x0){this['log'][_0x4de2d4(0xbc)]('Subscribing\x20to\x20'+_0x2f4882[_0x4de2d4(0x1e9)]+_0x4de2d4(0x1d4));for(const _0x1b712d of _0x2f4882){if(_0x1b712d['id']){await this['subscribeForeignStatesAsync'](_0x1b712d['id']);try{const _0x3d855b=await this[_0x4de2d4(0x145)](_0x1b712d['id']);if(_0x3d855b)this[_0x4de2d4(0x157)][_0x1b712d['id']]=_0x3d855b[_0x4de2d4(0x8d)];}catch(_0x500d12){}}}}}async[a0_0x33d609(0xd8)](){const _0x1d83c3=a0_0x33d609,_0x2717ed=this['config'][_0x1d83c3(0xe0)]||[];if(_0x2717ed[_0x1d83c3(0x1e9)]>0x0){this[_0x1d83c3(0x190)]['info'](_0x1d83c3(0x148)+_0x2717ed[_0x1d83c3(0x1e9)]+_0x1d83c3(0xf3));for(const _0x29faa4 of _0x2717ed){await this[_0x1d83c3(0x143)](_0x29faa4);}try{await this[_0x1d83c3(0xc0)]();}catch(_0x1725ae){}}}async[a0_0x33d609(0x1c6)](){const _0x1786bf=a0_0x33d609;try{if(!this[_0x1786bf(0x14d)][_0x1786bf(0x11a)])return _0x1786bf(0x1ac);let _0x37ea9b='';const _0x442334=this[_0x1786bf(0x14d)]['weatherInstance'];if(_0x442334)try{if(_0x442334['includes'](_0x1786bf(0x183))){const _0x38385c=await this[_0x1786bf(0x145)](_0x442334+'.Summary.Current');if(_0x38385c&&_0x38385c[_0x1786bf(0x8d)])_0x37ea9b=_0x38385c[_0x1786bf(0x8d)];}else{if(_0x442334[_0x1786bf(0x88)]('daswetter')){const _0x89aa4=await this[_0x1786bf(0x145)](_0x442334+_0x1786bf(0xad));if(_0x89aa4&&_0x89aa4[_0x1786bf(0x8d)])_0x37ea9b=_0x89aa4[_0x1786bf(0x8d)];}else{if(_0x442334[_0x1786bf(0x88)](_0x1786bf(0x1d9))){const _0xc2804=await this[_0x1786bf(0x145)](_0x442334+'.forecast.current.state');if(_0xc2804&&_0xc2804[_0x1786bf(0x8d)])_0x37ea9b=_0xc2804[_0x1786bf(0x8d)];}}}}catch(_0x5477c8){}if(!_0x37ea9b){const _0x469350=[_0x1786bf(0x1a6),_0x1786bf(0x1b7),_0x1786bf(0x199),'openweathermap.0'];for(const _0x459cf0 of _0x469350){try{const _0x597750=await this['getForeignObjectAsync'](_0x459cf0);if(_0x597750){if(_0x459cf0['includes'](_0x1786bf(0x183))){const _0x279287=await this[_0x1786bf(0x145)](_0x459cf0+_0x1786bf(0xbe));if(_0x279287&&_0x279287[_0x1786bf(0x8d)]){_0x37ea9b=_0x279287[_0x1786bf(0x8d)];break;}}}}catch(_0x2e3047){}}}return _0x37ea9b?_0x1786bf(0x13e)+_0x37ea9b:_0x1786bf(0xa3);}catch(_0x1ab7b2){return _0x1786bf(0x12c)+_0x1ab7b2['message'];}}async[a0_0x33d609(0xfa)](){const _0x2a6ee=a0_0x33d609;try{if(!this[_0x2a6ee(0x14d)][_0x2a6ee(0xd7)])return _0x2a6ee(0x7f);let _0x150d55=this[_0x2a6ee(0x14d)]['calendarInstance']||'ical.0',_0x15e388=this[_0x2a6ee(0x14d)][_0x2a6ee(0x168)]||[];if(typeof _0x15e388==='string')_0x15e388=_0x15e388[_0x2a6ee(0xff)](',');try{const _0x265f4c=await this[_0x2a6ee(0x145)](_0x150d55+'.data.table');if(_0x265f4c&&_0x265f4c['val']){let _0x549719=this[_0x2a6ee(0x17d)](_0x265f4c[_0x2a6ee(0x8d)]);if(_0x549719&&Array[_0x2a6ee(0x14f)](_0x549719)){if(_0x15e388[_0x2a6ee(0x1e9)]>0x0)_0x549719=_0x549719[_0x2a6ee(0x16a)](_0x1b498e=>_0x15e388[_0x2a6ee(0x88)](_0x1b498e[_0x2a6ee(0x160)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x549719['length']>0x0){const _0x1146c9=_0x549719[_0x2a6ee(0x1ca)](0x0,0x3)[_0x2a6ee(0x1ec)](_0x658460=>{const _0xe1326=_0x2a6ee;let _0x11d63d=_0x658460[_0xe1326(0x1a0)];if(_0x658460[_0xe1326(0xea)])_0x11d63d+='\x20'+_0x658460[_0xe1326(0xea)];return _0x11d63d+':\x20'+_0x658460[_0xe1326(0x7b)]+'\x20('+_0x658460[_0xe1326(0x160)]+')';});return _0x2a6ee(0xb1)+_0x1146c9[_0x2a6ee(0x1a1)](_0x2a6ee(0x9d));}else return _0x2a6ee(0xc7);}}}catch(_0x2b56f5){this[_0x2a6ee(0x190)][_0x2a6ee(0x8c)](_0x2a6ee(0xd6)+_0x2b56f5[_0x2a6ee(0xf7)]);}return _0x2a6ee(0xaf);}catch(_0x203a92){return _0x2a6ee(0x1d3)+_0x203a92[_0x2a6ee(0xf7)];}}async[a0_0x33d609(0x158)](_0x3a301b){const _0x5d6ed8=a0_0x33d609;try{const _0xe2852e=await this[_0x5d6ed8(0x145)](_0x3a301b+_0x5d6ed8(0x116));if(_0xe2852e&&_0xe2852e['val']){const _0x15a800=this[_0x5d6ed8(0x17d)](_0xe2852e[_0x5d6ed8(0x8d)]);if(_0x15a800&&Array[_0x5d6ed8(0x14f)](_0x15a800)){const _0x40930b=[...new Set(_0x15a800[_0x5d6ed8(0x1ec)](_0x4041d0=>_0x4041d0[_0x5d6ed8(0x160)])[_0x5d6ed8(0x16a)](Boolean))];return _0x40930b[_0x5d6ed8(0x15d)]();}}return[];}catch(_0x38a962){return this['log']['error']('getCalendarNames\x20Error:\x20'+_0x38a962['message']),[];}}async[a0_0x33d609(0xc0)](){const _0x3d9790=a0_0x33d609;try{const _0x2b7c08=this['config'][_0x3d9790(0xe0)]||[];let _0x2949a8=![];for(const _0x43a62f of _0x2b7c08){try{const _0xc7d7c9=await this[_0x3d9790(0x145)](_0x43a62f);if(_0xc7d7c9&&(_0xc7d7c9[_0x3d9790(0x8d)]===!![]||_0xc7d7c9['val']===_0x3d9790(0xfc)||_0xc7d7c9['val']===0x1)){_0x2949a8=!![];break;}}catch(_0x1acfed){}}return _0x2949a8&&(this[_0x3d9790(0x1e4)]&&(this[_0x3d9790(0x190)][_0x3d9790(0xbc)]('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),this['abortExitTimer']()),!this['isPresent']&&this['currentSystemMode']===SYSTEM_MODES[_0x3d9790(0x77)]&&await this[_0x3d9790(0xf2)](!![])),_0x2949a8;}catch(_0x453212){return this[_0x3d9790(0x190)]['error'](_0x3d9790(0x134)+_0x453212['message']),![];}}[a0_0x33d609(0x11d)](){const _0x172f8d=a0_0x33d609;this['abortExitTimer'](),this[_0x172f8d(0x1cb)]=!![],this[_0x172f8d(0x19c)]=setTimeout(()=>{const _0x3e91d2=_0x172f8d;this[_0x3e91d2(0x1cb)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x172f8d(0x1e4)]=setTimeout(()=>{const _0x1e2095=_0x172f8d;this['setPresence'](![]),this[_0x1e2095(0x1e4)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x33d609(0x1ad)](){const _0x1c9707=a0_0x33d609;if(this[_0x1c9707(0x1e4)])clearTimeout(this[_0x1c9707(0x1e4)]);if(this[_0x1c9707(0x19c)])clearTimeout(this[_0x1c9707(0x19c)]);this[_0x1c9707(0x1e4)]=null,this['exitGraceTimer']=null,this[_0x1c9707(0x1cb)]=![];}async[a0_0x33d609(0xf2)](_0x507aef){const _0x281fd9=a0_0x33d609;if(this['isPresent']===_0x507aef)return;this[_0x281fd9(0xf9)]=_0x507aef,await this[_0x281fd9(0x14a)](_0x281fd9(0x181),{'val':_0x507aef,'ack':!![]});}async['saveFeedback'](_0x280764){const _0x4d4e26=a0_0x33d609;this[_0x4d4e26(0x190)][_0x4d4e26(0xbc)]('Feedback\x20saved:\x20'+JSON['stringify'](_0x280764));}async[a0_0x33d609(0x90)](){const _0x968ba=a0_0x33d609;if(!this[_0x968ba(0xa1)]||!this[_0x968ba(0x12b)])return;const _0x345fad=this[_0x968ba(0x14d)][_0x968ba(0x149)]||0xe;if(this[_0x968ba(0x162)]['length']<_0x345fad+(this[_0x968ba(0x14d)][_0x968ba(0xce)]||0x7)){await this[_0x968ba(0x14a)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x52456b=this[_0x968ba(0x162)][_0x968ba(0x1ca)](-_0x345fad),_0x222421=this[_0x968ba(0x162)][_0x968ba(0x1ca)](0x0,this[_0x968ba(0x162)][_0x968ba(0x1e9)]-_0x345fad),_0x2e7950='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x968ba(0x8e)](_0x222421)+_0x968ba(0xfd)+JSON[_0x968ba(0x8e)](_0x52456b);try{const _0xbe4e9=await this['geminiModel'][_0x968ba(0xca)](_0x2e7950),_0x3377dc=JSON[_0x968ba(0xe9)](_0xbe4e9[_0x968ba(0x1c5)][_0x968ba(0x1e6)]()[_0x968ba(0x126)](/```json|```/g,'')[_0x968ba(0x1d6)]());_0x3377dc[_0x968ba(0x142)]&&(await this[_0x968ba(0x14a)](LTM_DP_DRIFT_STATUS,{'val':_0x3377dc[_0x968ba(0x142)],'ack':!![]}),await this[_0x968ba(0x14a)](LTM_DP_DRIFT_DETAILS,{'val':_0x3377dc[_0x968ba(0xba)],'ack':!![]}),await this[_0x968ba(0x14a)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x968ba(0x1af)](),'ack':!![]}));}catch(_0xfc0b35){}}[a0_0x33d609(0x15f)](){const _0xf9f679=a0_0x33d609;try{if(this['ltmJob'])this[_0xf9f679(0xf4)]['cancel']();if(!this[_0xf9f679(0xa1)]){this[_0xf9f679(0x14a)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this['ltmJob']=schedule[_0xf9f679(0x16f)](LTM_SCHEDULE,()=>this[_0xf9f679(0x1c4)]());}catch(_0x4a08f2){this[_0xf9f679(0x190)][_0xf9f679(0x197)](_0xf9f679(0x1e1)+_0x4a08f2[_0xf9f679(0xf7)]);}}[a0_0x33d609(0x19a)](){const _0x373c88=a0_0x33d609;try{if(this[_0x373c88(0x130)])this[_0x373c88(0x130)][_0x373c88(0xe7)]();this['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x510ff0=_0x373c88;await this[_0x510ff0(0x1de)](),AUTO_RESET_MODES['includes'](this[_0x510ff0(0x15e)])&&await this[_0x510ff0(0x14a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x95c8e5){this[_0x373c88(0x190)][_0x373c88(0x197)](_0x373c88(0x111)+_0x95c8e5['message']);}}[a0_0x33d609(0x15a)](){const _0x32768f=a0_0x33d609;try{if(this[_0x32768f(0x161)])clearInterval(this['driftAnalysisTimer']);if(!this[_0x32768f(0xa1)])return;this['driftAnalysisTimer']=setInterval(()=>this[_0x32768f(0x90)](),(this[_0x32768f(0x14d)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>this['runBaselineDriftAnalysis'](),0x1388);}catch(_0x269e42){this[_0x32768f(0x190)][_0x32768f(0x197)](_0x32768f(0x18f)+_0x269e42[_0x32768f(0xf7)]);}}[a0_0x33d609(0x141)](){const _0x24c173=a0_0x33d609;try{if(this['briefingJob'])this[_0x24c173(0x135)][_0x24c173(0xe7)]();if(!this[_0x24c173(0x14d)][_0x24c173(0xb8)])return;const _0x3482d4=(this[_0x24c173(0x14d)][_0x24c173(0x124)]||_0x24c173(0x1a9))[_0x24c173(0xff)](':'),_0x5677ae=parseInt(_0x3482d4[0x0])||0x8,_0x19f6e3=parseInt(_0x3482d4[0x1])||0x0,_0x268166=_0x19f6e3+'\x20'+_0x5677ae+_0x24c173(0x1c2);this[_0x24c173(0x190)][_0x24c173(0xbc)](_0x24c173(0x147)+_0x5677ae+':'+(_0x19f6e3<0xa?'0'+_0x19f6e3:_0x19f6e3)),this[_0x24c173(0x135)]=schedule[_0x24c173(0x16f)](_0x268166,()=>{const _0x5910ce=_0x24c173;this[_0x5910ce(0xcc)]();});}catch(_0x1fcdeb){this[_0x24c173(0x190)][_0x24c173(0x197)](_0x24c173(0xa6)+_0x1fcdeb['message']);}}async[a0_0x33d609(0x14e)](_0x1d2fd7,_0x445b13=![],_0x597793=![]){const _0x3925dc=a0_0x33d609;this[_0x3925dc(0x190)][_0x3925dc(0xbc)]((_0x445b13?_0x3925dc(0xae):'')+_0x3925dc(0x179)+_0x1d2fd7+'\x22');const _0x22d825=this[_0x3925dc(0x14d)];let _0x33fd96=0x0;if(_0x22d825[_0x3925dc(0x167)]&&_0x22d825[_0x3925dc(0x17f)]){let _0x141e51={};(_0x1d2fd7[_0x3925dc(0x88)](_0x3925dc(0x19f))||_0x597793)&&(_0x141e51={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':'COGNI_CONFIRM_OK'}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x3925dc(0x122)}]]}}),await this[_0x3925dc(0xf8)](_0x22d825['notifyTelegramInstance'],_0x3925dc(0x119),{'text':_0x1d2fd7,'user':_0x22d825['notifyTelegramRecipient'],..._0x141e51}),_0x33fd96++;}if(_0x22d825[_0x3925dc(0x138)]&&_0x22d825['notifyPushoverInstance']){let _0x22fc38={'message':_0x1d2fd7,'title':_0x597793?_0x3925dc(0x139):'Cogni-Living','priority':_0x597793?0x2:0x1,'device':_0x22d825[_0x3925dc(0x1c7)]};_0x597793&&(_0x22fc38[_0x3925dc(0x18e)]=0x1e,_0x22fc38[_0x3925dc(0x7e)]=0xe10,_0x22fc38['sound']=_0x3925dc(0x140)),await this[_0x3925dc(0xf8)](_0x22d825[_0x3925dc(0xa8)],_0x3925dc(0x119),_0x22fc38),_0x33fd96++;}return _0x22d825['notifyEmailEnabled']&&_0x22d825[_0x3925dc(0x1c9)]&&(await this[_0x3925dc(0xf8)](_0x22d825[_0x3925dc(0x1c9)],_0x3925dc(0x119),{'text':_0x1d2fd7,'to':_0x22d825[_0x3925dc(0x17c)]}),_0x33fd96++),_0x33fd96;}}if(require[a0_0x33d609(0xbf)]!==module)module[a0_0x33d609(0x1d2)]=_0x5780fe=>new CogniLiving(_0x5780fe);else new CogniLiving();