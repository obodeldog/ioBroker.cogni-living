const a0_0x3beab9=a0_0x556c;(function(_0x2665b0,_0x15641e){const _0x1f9244=a0_0x556c,_0x9bd91a=_0x2665b0();while(!![]){try{const _0x1323c7=-parseInt(_0x1f9244(0x1c0))/0x1+parseInt(_0x1f9244(0x1bb))/0x2+parseInt(_0x1f9244(0x232))/0x3+parseInt(_0x1f9244(0x22b))/0x4+parseInt(_0x1f9244(0x1b7))/0x5*(parseInt(_0x1f9244(0x17a))/0x6)+-parseInt(_0x1f9244(0x240))/0x7+parseInt(_0x1f9244(0x215))/0x8*(-parseInt(_0x1f9244(0x1f9))/0x9);if(_0x1323c7===_0x15641e)break;else _0x9bd91a['push'](_0x9bd91a['shift']());}catch(_0x20ccf3){_0x9bd91a['push'](_0x9bd91a['shift']());}}}(a0_0x62ce,0xb7a88));const a0_0xbf7a7b=(function(){let _0x2a9527=!![];return function(_0xa3c568,_0x313e35){const _0x3435aa=_0x2a9527?function(){const _0x1d7627=a0_0x556c;if(_0x313e35){const _0x3def1b=_0x313e35[_0x1d7627(0x20d)](_0xa3c568,arguments);return _0x313e35=null,_0x3def1b;}}:function(){};return _0x2a9527=![],_0x3435aa;};}()),a0_0x1e0708=a0_0xbf7a7b(this,function(){const _0xab7088=a0_0x556c;return a0_0x1e0708['toString']()[_0xab7088(0x1fc)](_0xab7088(0x1ba))['toString']()[_0xab7088(0x20a)](a0_0x1e0708)[_0xab7088(0x1fc)]('(((.+)+)+)+$');});a0_0x1e0708();function a0_0x556c(_0x616117,_0x13e741){const _0x32b57b=a0_0x62ce();return a0_0x556c=function(_0x1e0708,_0xbf7a7b){_0x1e0708=_0x1e0708-0x172;let _0x62ce8=_0x32b57b[_0x1e0708];return _0x62ce8;},a0_0x556c(_0x616117,_0x13e741);}'use strict';function a0_0x62ce(){const _0xd74817=['onReady','toLowerCase','Test','setStateAsync','config','isGracePeriodActive','constructor','ANALYZE_TREND','TRAIN_COMFORT','apply','Keine\x20Antwort\x20von\x20Gemini','system.presenceWho','./lib/topology','createDailyDigest','getLtmData','error','split','1016lnRClk','analysis.training.triggerComfort','info','sort','message','Verbunden','enum','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','motion','length','location','LTM.trainingData.thermodynamics','onUnload','rawEventLog','getOutsideTemperatureNumeric','bind','Fehler:\x20','exitGraceTimer','cancel','WiFi\x20Presence\x20detected.','getGenerativeModel','isProVersion','1206484QsNQMf','getOverviewData','getForeignObjectsAsync','getStateAsync','apiKey','communicate.request','updateTopology','3702741fVHeVz','object','log','isArray','sendMorningBriefing','setupLtmScheduler','analysis.automation.autoApply','SYSTEM_DP_MODE','onMessage','triggerGaitAnalysis','initZombies','setPresence','ready','response','7609630dOhnwH','from','models/gemini-flash-latest','analysis.training.triggerTopology','inactivityThresholdHours','command','Instanz\x20nicht\x20gefunden','currentSystemMode','NORMAL','isPresent','eventHistory','Kein\x20Wetter-Adapter','calendarInstance','checkLicense','licenseKey','fill','264912JYXhnu','getCalendarNames','genAI','parse','stringify','endsWith','slice','find','minDaysForBaseline','add','LTM.dailyDigests','type','debug','main','_calName','floor','./lib/ai_agent','checkAndInstall','val','runGeminiAnalysis','timestamp','testContext','enum.functions.*','updateHealthVector','getHours','runAutopilot','analysis.topology.structure','getForeignObjectAsync','./lib/setup','initSystemConfig','LTM.rawEventLog','analysis.automation.triggerAction','dailyDigests','testApiKey','stateChange','activityLevel','./lib/recorder','pop','forEach','instance','./lib/python_bridge','analysis.training.triggerEnergy','briefingJob','testNotification','runPythonHealthCheck','Daten\x20nicht\x20verfÃ¼gbar','./lib/scheduler','analysis.training.status','Kein\x20Kalender-Adapter','callback','geminiApiKey','processSensorEvent','Gemini\x20AI\x20initialized.','LTM.baselineStatus','updated','text','createAllObjects','getForeignStateAsync','checkWifiPresence','send','analysis.trigger','170iRxNRE','presenceDevices','Verbindung\x20erfolgreich!','(((.+)+)+)+$','295570gMRbSz','@google/generative-ai','setState','Activity-Level','cogni-living\x20adapter\x20starting\x20(v','1230278FNOxfR','systemConfig','ack','setupBriefingScheduler','name','SET_TOPOLOGY','subscribeStates','common','triggerDailyDigest','notifyTelegramEnabled','Aktiv\x20(','./lib/scanner','sendNotification','onStateChange','system.adapter.','driftAnalysisTimer','analysisHistory','Notification\x20Test\x20Failed:\x20','LTM.trainingData.sequences','sendTo','.data.table','generateContent','PREDICT_ENERGY','updateTopologyMatrix','Kein\x20API\x20Key\x20Ã¼bergeben','matrix','triggerEnergyPrediction','getEnums','setHours','namespace','updateLocation','ltmJob','modeResetJob','Sec-Training\x20started...','temperature','setupModeResetScheduler','geminiModel','@iobroker/adapter-core','getTime','getState','exitTimer',')\x20-\x20Phase\x20C\x20(Hardened)','devices','VACATION','\x20Tage)','.communicate.request','sensorLastValues','analysis.triggerBriefing','analysisTimer','SYSTEM_MODES','ANALYZE_GAIT','online','analysis.training.triggerHealth','abortExitTimer','values','dependencyInstallInProgress','analysis.health.todayVector','8163gOedyz','analysis.training.triggerSecurity','cogni-living','search','calendarName','version','executeAutomationAction','TRAIN_SECURITY','telegram','startSystem','includes'];a0_0x62ce=function(){return _0xd74817;};return a0_0x62ce();}const utils=require(a0_0x3beab9(0x1e5)),{GoogleGenerativeAI}=require(a0_0x3beab9(0x1bc)),installer=require('./lib/installer'),scanner=require(a0_0x3beab9(0x1cb)),schedulers=require(a0_0x3beab9(0x1a8)),topology=require(a0_0x3beab9(0x210)),setup=require(a0_0x3beab9(0x196)),recorder=require(a0_0x3beab9(0x19e)),pythonBridge=require(a0_0x3beab9(0x1a2)),aiAgent=require(a0_0x3beab9(0x18a)),deadMan=require('./lib/dead_man'),GEMINI_MODEL=a0_0x3beab9(0x242),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils['Adapter']{constructor(_0x199b84){const _0x320cd9=a0_0x3beab9;super({..._0x199b84,'name':_0x320cd9(0x1fb)}),this[_0x320cd9(0x174)]=[],this[_0x320cd9(0x1d0)]=[],this[_0x320cd9(0x222)]=[],this[_0x320cd9(0x19a)]=[],this[_0x320cd9(0x1ee)]={},this[_0x320cd9(0x1c1)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x320cd9(0x173)]=!![],this[_0x320cd9(0x1e8)]=null,this[_0x320cd9(0x226)]=null,this[_0x320cd9(0x209)]=![],this['genAI']=null,this[_0x320cd9(0x1e4)]=null,this[_0x320cd9(0x247)]=setup[_0x320cd9(0x1f1)][_0x320cd9(0x172)],this[_0x320cd9(0x22a)]=![],this['lastAlertState']=![],this[_0x320cd9(0x1f0)]=null,this['ltmJob']=null,this[_0x320cd9(0x1e0)]=null,this['driftAnalysisTimer']=null,this['briefingJob']=null,this['dependencyInstallInProgress']=![],this['on'](_0x320cd9(0x23e),this[_0x320cd9(0x204)]['bind'](this)),this['on'](_0x320cd9(0x19c),this[_0x320cd9(0x1cd)][_0x320cd9(0x224)](this)),this['on']('unload',this[_0x320cd9(0x221)][_0x320cd9(0x224)](this)),this['on'](_0x320cd9(0x219),this[_0x320cd9(0x23a)][_0x320cd9(0x224)](this));}async[a0_0x3beab9(0x204)](){const _0x5a6d0=a0_0x3beab9;this['log']['info'](_0x5a6d0(0x1bf)+this[_0x5a6d0(0x1fe)]+_0x5a6d0(0x1e9));if(!installer[_0x5a6d0(0x18b)](this,()=>this[_0x5a6d0(0x202)]()))return;}async[a0_0x3beab9(0x202)](){const _0x5fa1d1=a0_0x3beab9;await setup[_0x5fa1d1(0x23c)](this);try{this[_0x5fa1d1(0x22a)]=await setup[_0x5fa1d1(0x177)](this[_0x5fa1d1(0x208)][_0x5fa1d1(0x178)]);}catch(_0x3eac33){}if(!this[_0x5fa1d1(0x208)][_0x5fa1d1(0x244)]||this['config'][_0x5fa1d1(0x244)]<0.1)this[_0x5fa1d1(0x208)][_0x5fa1d1(0x244)]=0xc;await setup['initHistory'](this),await setup[_0x5fa1d1(0x197)](this);if(this[_0x5fa1d1(0x208)][_0x5fa1d1(0x1ac)])try{this['genAI']=new GoogleGenerativeAI(this['config']['geminiApiKey']),this[_0x5fa1d1(0x1e4)]=this[_0x5fa1d1(0x17c)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x5fa1d1(0x234)][_0x5fa1d1(0x217)](_0x5fa1d1(0x1ae));}catch(_0x19cd4f){this[_0x5fa1d1(0x234)][_0x5fa1d1(0x213)]('Gemini\x20Init\x20Error:\x20'+_0x19cd4f[_0x5fa1d1(0x219)]);}await setup[_0x5fa1d1(0x1b2)](this),await this['loadSystemMode']();try{const _0xcd721a=await this[_0x5fa1d1(0x22e)](_0x5fa1d1(0x198));if(_0xcd721a&&_0xcd721a['val'])this[_0x5fa1d1(0x222)]=JSON[_0x5fa1d1(0x17d)](_0xcd721a['val']);}catch(_0xeef0a3){this[_0x5fa1d1(0x222)]=[];}try{const _0x877389=await this[_0x5fa1d1(0x22e)](_0x5fa1d1(0x184));if(_0x877389&&_0x877389[_0x5fa1d1(0x18c)])this['dailyDigests']=JSON[_0x5fa1d1(0x17d)](_0x877389['val']);}catch(_0x33551a){this['dailyDigests']=[];}const _0x11b744=this[_0x5fa1d1(0x19a)][_0x5fa1d1(0x21e)]>=(this['config'][_0x5fa1d1(0x182)]||0x7)?_0x5fa1d1(0x1ca)+this[_0x5fa1d1(0x19a)][_0x5fa1d1(0x21e)]+_0x5fa1d1(0x1ec):'Lernphase\x20('+this[_0x5fa1d1(0x19a)][_0x5fa1d1(0x21e)]+'/'+(this['config']['minDaysForBaseline']||0x7)+')';await this[_0x5fa1d1(0x207)](_0x5fa1d1(0x1af),{'val':_0x11b744,'ack':!![]}),this[_0x5fa1d1(0x1c6)]('analysis.trigger'),this['subscribeStates']('LTM.triggerDailyDigest'),this[_0x5fa1d1(0x1c6)]('system.mode'),this['subscribeStates'](_0x5fa1d1(0x1ef)),this[_0x5fa1d1(0x1c6)](_0x5fa1d1(0x199)),this[_0x5fa1d1(0x1c6)](_0x5fa1d1(0x238)),this[_0x5fa1d1(0x1c6)](_0x5fa1d1(0x1fa)),this[_0x5fa1d1(0x1c6)](_0x5fa1d1(0x1f4)),this[_0x5fa1d1(0x1c6)](_0x5fa1d1(0x1a3)),this[_0x5fa1d1(0x1c6)]('analysis.training.triggerComfort'),this[_0x5fa1d1(0x1c6)]('analysis.training.triggerTopology');const _0x35648c=this[_0x5fa1d1(0x208)][_0x5fa1d1(0x1ea)];if(_0x35648c)for(const _0x13f2b2 of _0x35648c){await this['subscribeForeignStatesAsync'](_0x13f2b2['id']);}const _0x27d7c=this[_0x5fa1d1(0x208)]['presenceDevices'];if(_0x27d7c)for(const _0x36fe2f of _0x27d7c){await this['subscribeForeignStatesAsync'](_0x36fe2f);}if(this[_0x5fa1d1(0x208)][_0x5fa1d1(0x1c9)]&&this['config']['notifyTelegramInstance'])await this['subscribeForeignStatesAsync'](this['config']['notifyTelegramInstance']+_0x5fa1d1(0x1ed));setTimeout(()=>this[_0x5fa1d1(0x1b4)](),0x1388);if(this[_0x5fa1d1(0x1f0)])clearInterval(this[_0x5fa1d1(0x1f0)]);const _0x4dc544=this['config']['analysisInterval']||0xf;_0x4dc544>0x0&&(this[_0x5fa1d1(0x1f0)]=setInterval(()=>{const _0x5109df=_0x5fa1d1;this[_0x5109df(0x193)]();},_0x4dc544*0x3c*0x3e8)),schedulers[_0x5fa1d1(0x237)](this,()=>aiAgent[_0x5fa1d1(0x211)](this,pythonBridge)),schedulers[_0x5fa1d1(0x1e3)](this),schedulers['setupDriftAnalysisScheduler'](this,()=>aiAgent['runBaselineDriftAnalysis'](this)),schedulers[_0x5fa1d1(0x1c3)](this,()=>aiAgent[_0x5fa1d1(0x236)](this)),pythonBridge['startService'](this,installer['PYTHON_EXE']),setTimeout(async()=>{const _0x3e7884=_0x5fa1d1;await topology[_0x3e7884(0x231)](this);try{const _0x1cbcf8=await this[_0x3e7884(0x22e)](_0x3e7884(0x194));if(_0x1cbcf8&&_0x1cbcf8[_0x3e7884(0x18c)])pythonBridge['send'](this,_0x3e7884(0x1c5),JSON[_0x3e7884(0x17d)](_0x1cbcf8[_0x3e7884(0x18c)]));}catch(_0x55793b){}this[_0x3e7884(0x1a6)](),this[_0x3e7884(0x23b)](),this[_0x3e7884(0x1da)](),this[_0x3e7884(0x191)]();},0x1388);}[a0_0x3beab9(0x221)](_0x436646){const _0x29b102=a0_0x3beab9;if(this['analysisTimer'])clearInterval(this[_0x29b102(0x1f0)]);if(this[_0x29b102(0x1cf)])clearInterval(this[_0x29b102(0x1cf)]);if(this[_0x29b102(0x1df)])this[_0x29b102(0x1df)][_0x29b102(0x227)]();if(this[_0x29b102(0x1e0)])this[_0x29b102(0x1e0)][_0x29b102(0x227)]();if(this['briefingJob'])this[_0x29b102(0x1a4)]['cancel']();recorder[_0x29b102(0x1f5)](this),pythonBridge['stopService'](this),_0x436646();}async['onStateChange'](_0x1c59bc,_0x2b12cd){const _0x28ca57=a0_0x3beab9;if(!_0x2b12cd||this[_0x28ca57(0x1f7)])return;if(_0x1c59bc[_0x28ca57(0x203)](_0x28ca57(0x201))&&_0x1c59bc[_0x28ca57(0x17f)](_0x28ca57(0x230))&&_0x2b12cd[_0x28ca57(0x18c)])return;if(_0x1c59bc===this[_0x28ca57(0x1dd)]+'.system.mode'){if(_0x2b12cd[_0x28ca57(0x18c)]&&Object[_0x28ca57(0x1f6)](setup[_0x28ca57(0x1f1)])[_0x28ca57(0x203)](_0x2b12cd[_0x28ca57(0x18c)])){this[_0x28ca57(0x247)]=_0x2b12cd['val'];if(_0x2b12cd[_0x28ca57(0x18c)]===setup['SYSTEM_MODES'][_0x28ca57(0x1eb)])await recorder['setPresence'](this,![]);else await recorder[_0x28ca57(0x23d)](this,!![]);}if(!_0x2b12cd['ack'])this[_0x28ca57(0x1bd)](_0x1c59bc,{'val':this[_0x28ca57(0x247)],'ack':!![]});return;}if(!_0x2b12cd[_0x28ca57(0x1c2)]){_0x1c59bc[_0x28ca57(0x203)](_0x28ca57(0x1b6))&&_0x2b12cd[_0x28ca57(0x18c)]&&(this[_0x28ca57(0x1bd)](_0x1c59bc,{'val':![],'ack':!![]}),aiAgent[_0x28ca57(0x18d)](this));if(_0x1c59bc[_0x28ca57(0x203)](_0x28ca57(0x1c8))&&_0x2b12cd[_0x28ca57(0x18c)]){this['setState'](_0x1c59bc,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent[_0x28ca57(0x211)](this,pythonBridge);}_0x1c59bc['includes']('triggerBriefing')&&_0x2b12cd[_0x28ca57(0x18c)]&&(this[_0x28ca57(0x1bd)](_0x1c59bc,{'val':![],'ack':!![]}),aiAgent[_0x28ca57(0x236)](this));_0x1c59bc['includes']('automation.triggerAction')&&_0x2b12cd[_0x28ca57(0x18c)]&&(this[_0x28ca57(0x1bd)](_0x1c59bc,{'val':![],'ack':!![]}),aiAgent[_0x28ca57(0x1ff)](this));if(_0x1c59bc[_0x28ca57(0x203)]('analysis.training.triggerSecurity')&&_0x2b12cd['val']){this['setState'](_0x1c59bc,{'val':![],'ack':!![]});if(this[_0x28ca57(0x22a)])try{const _0x3f62eb=await this[_0x28ca57(0x22e)](_0x28ca57(0x1d2));if(_0x3f62eb&&_0x3f62eb[_0x28ca57(0x18c)]){const _0x29532f=JSON['parse'](_0x3f62eb[_0x28ca57(0x18c)]);this[_0x28ca57(0x207)](_0x28ca57(0x1a9),{'val':_0x28ca57(0x1e1),'ack':!![]}),pythonBridge[_0x28ca57(0x1b5)](this,_0x28ca57(0x200),{'sequences':_0x29532f});}}catch(_0x805257){}}if(_0x1c59bc[_0x28ca57(0x203)]('analysis.training.triggerHealth')&&_0x2b12cd['val']){this[_0x28ca57(0x1bd)](_0x1c59bc,{'val':![],'ack':!![]});if(this[_0x28ca57(0x22a)])try{const _0x1ccf61=await this[_0x28ca57(0x22e)](_0x28ca57(0x184));if(_0x1ccf61&&_0x1ccf61[_0x28ca57(0x18c)])pythonBridge[_0x28ca57(0x1b5)](this,'TRAIN_HEALTH',{'digests':JSON[_0x28ca57(0x17d)](_0x1ccf61[_0x28ca57(0x18c)])});}catch(_0x480c06){}}if(_0x1c59bc[_0x28ca57(0x203)](_0x28ca57(0x1a3))&&_0x2b12cd[_0x28ca57(0x18c)]){this[_0x28ca57(0x1bd)](_0x1c59bc,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x4ba930=await this['getStateAsync'](_0x28ca57(0x220));if(_0x4ba930&&_0x4ba930[_0x28ca57(0x18c)])pythonBridge['send'](this,'TRAIN_ENERGY',{'points':JSON[_0x28ca57(0x17d)](_0x4ba930[_0x28ca57(0x18c)])});}catch(_0x302ef6){}}if(_0x1c59bc[_0x28ca57(0x203)](_0x28ca57(0x216))&&_0x2b12cd['val']){this[_0x28ca57(0x1bd)](_0x1c59bc,{'val':![],'ack':!![]});if(this[_0x28ca57(0x22a)])try{const _0x3aa650=await this['getStateAsync'](_0x28ca57(0x198));if(_0x3aa650&&_0x3aa650['val'])pythonBridge[_0x28ca57(0x1b5)](this,_0x28ca57(0x20c),{'events':JSON[_0x28ca57(0x17d)](_0x3aa650[_0x28ca57(0x18c)])});}catch(_0x5078e4){}}_0x1c59bc[_0x28ca57(0x203)](_0x28ca57(0x243))&&_0x2b12cd[_0x28ca57(0x18c)]&&(this[_0x28ca57(0x1bd)](_0x1c59bc,{'val':![],'ack':!![]}),topology['updateTopology'](this));return;}if(this[_0x28ca57(0x208)]['presenceDevices']&&this[_0x28ca57(0x208)][_0x28ca57(0x1b8)][_0x28ca57(0x203)](_0x1c59bc)){await this[_0x28ca57(0x1b4)]();return;}const _0x29ff3a=(this[_0x28ca57(0x208)][_0x28ca57(0x1ea)]||[])[_0x28ca57(0x181)](_0x365bcc=>_0x365bcc['id']===_0x1c59bc);if(_0x29ff3a){const _0x255d89=await recorder[_0x28ca57(0x1ad)](this,_0x1c59bc,_0x2b12cd,_0x29ff3a);_0x255d89&&_0x255d89['type']===_0x28ca57(0x21d)&&_0x255d89['location']&&this[_0x28ca57(0x22a)]&&deadMan[_0x28ca57(0x1de)](this,_0x255d89[_0x28ca57(0x21f)]);}}async[a0_0x3beab9(0x23a)](_0xdc8e4d){const _0x171264=a0_0x3beab9;if(typeof _0xdc8e4d===_0x171264(0x233)&&_0xdc8e4d[_0x171264(0x219)]){if(_0xdc8e4d[_0x171264(0x245)]===_0x171264(0x19b))try{const _0x5c31f7=_0xdc8e4d[_0x171264(0x219)][_0x171264(0x22f)];if(!_0x5c31f7)throw new Error(_0x171264(0x1d8));const _0xa6a9be=new GoogleGenerativeAI(_0x5c31f7),_0x480478=_0xa6a9be[_0x171264(0x229)]({'model':GEMINI_MODEL}),_0x50a5fa=await _0x480478[_0x171264(0x1d5)](_0x171264(0x206)),_0x1245a0=await _0x50a5fa[_0x171264(0x23f)];if(_0x1245a0[_0x171264(0x1b1)]())this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d['command'],{'success':!![],'message':_0x171264(0x1b9)},_0xdc8e4d[_0x171264(0x1ab)]);else throw new Error(_0x171264(0x20e));}catch(_0x548f74){this['sendTo'](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d['command'],{'success':![],'message':_0x548f74[_0x171264(0x219)]},_0xdc8e4d['callback']);}else{if(_0xdc8e4d['command']==='scanDevices')try{const _0x3959c0=await scanner['scanForDevices'](this,_0xdc8e4d[_0x171264(0x219)]||{});this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d[_0x171264(0x245)],{'success':!![],'devices':_0x3959c0},_0xdc8e4d[_0x171264(0x1ab)]);}catch(_0x42cd5f){this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d['command'],{'success':![],'error':_0x42cd5f['message']},_0xdc8e4d[_0x171264(0x1ab)]);}else{if(_0xdc8e4d[_0x171264(0x245)]===_0x171264(0x1d7))try{const {matrix:_0xc22831}=_0xdc8e4d[_0x171264(0x219)],_0x3cf5a7=await this['getStateAsync'](_0x171264(0x194));if(_0x3cf5a7&&_0x3cf5a7[_0x171264(0x18c)]){const _0x42c214=JSON[_0x171264(0x17d)](_0x3cf5a7[_0x171264(0x18c)]);_0x42c214[_0x171264(0x1d9)]=_0xc22831,_0x42c214[_0x171264(0x1b0)]=Date['now'](),await this[_0x171264(0x207)](_0x171264(0x194),{'val':JSON[_0x171264(0x17e)](_0x42c214),'ack':!![]}),pythonBridge[_0x171264(0x1b5)](this,_0x171264(0x1c5),_0x42c214);}this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d[_0x171264(0x245)],{'success':!![]},_0xdc8e4d[_0x171264(0x1ab)]);}catch(_0x27b267){this[_0x171264(0x234)][_0x171264(0x213)](_0x27b267);}else{if(_0xdc8e4d['command']===_0x171264(0x212))this[_0x171264(0x1d3)](_0xdc8e4d['from'],_0xdc8e4d[_0x171264(0x245)],{'success':!![],'dailyDigests':this['dailyDigests']||[],'analysisHistory':this[_0x171264(0x1d0)]||[]},_0xdc8e4d[_0x171264(0x1ab)]);else{if(_0xdc8e4d['command']===_0x171264(0x22c)){const _0x288136=this[_0x171264(0x19a)]['length'],_0x12c0ea=new Array(0x18)[_0x171264(0x179)](0x0),_0x5e488e=new Date()[_0x171264(0x1dc)](0x0,0x0,0x0,0x0);this[_0x171264(0x174)]&&this[_0x171264(0x174)][_0x171264(0x1a0)](_0x113209=>{const _0x34b3cc=_0x171264;if(_0x113209[_0x34b3cc(0x18e)]>=_0x5e488e){const _0x34aa10=new Date(_0x113209[_0x34b3cc(0x18e)])['getHours']();if(_0x34aa10>=0x0&&_0x34aa10<0x18)_0x12c0ea[_0x34aa10]++;}}),this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d['command'],{'success':!![],'eventHistory':this[_0x171264(0x174)][_0x171264(0x180)](0x0,0xf),'stats':{'digestCount':_0x288136,'isPresent':this['isPresent'],'hourlyActivity':_0x12c0ea},'automation':{'detected':![]}},_0xdc8e4d[_0x171264(0x1ab)]);}else{if(_0xdc8e4d[_0x171264(0x245)]===_0x171264(0x1db)){const _0x1770e5=await this[_0x171264(0x22d)](_0x171264(0x190),'enum'),_0xbe6f9b=[];if(_0x1770e5)for(const _0x1a47a5 in _0x1770e5){const _0x25babb=_0x1770e5[_0x1a47a5],_0x474987=(_0x25babb[_0x171264(0x1c7)]&&typeof _0x25babb[_0x171264(0x1c7)][_0x171264(0x1c4)]===_0x171264(0x233)?_0x25babb[_0x171264(0x1c7)]['name']['de']:_0x25babb[_0x171264(0x1c7)][_0x171264(0x1c4)])||_0x25babb[_0x171264(0x1c7)][_0x171264(0x1c4)];_0xbe6f9b['push']({'id':_0x1a47a5,'name':_0x474987});}const _0x55c083=await this['getForeignObjectsAsync']('enum.rooms.*',_0x171264(0x21b)),_0x50785a=[];if(_0x55c083)for(const _0x20ad50 in _0x55c083){const _0x522073=_0x55c083[_0x20ad50],_0x380ca9=(_0x522073[_0x171264(0x1c7)]&&typeof _0x522073[_0x171264(0x1c7)][_0x171264(0x1c4)]==='object'?_0x522073[_0x171264(0x1c7)]['name']['de']:_0x522073['common']['name'])||_0x20ad50[_0x171264(0x214)]('.')[_0x171264(0x19f)]();_0x50785a['push'](_0x380ca9);}this[_0x171264(0x1d3)](_0xdc8e4d['from'],_0xdc8e4d[_0x171264(0x245)],{'success':!![],'enums':_0xbe6f9b,'rooms':_0x50785a},_0xdc8e4d[_0x171264(0x1ab)]);}else{if(_0xdc8e4d[_0x171264(0x245)]===_0x171264(0x18f))try{let _0x2a1be7=_0x171264(0x175),_0x19ba06=_0x171264(0x1aa);if(this[_0x171264(0x208)]['weatherInstance']){const _0x3443fd=await recorder[_0x171264(0x223)](this);_0x2a1be7=_0x3443fd!==null?_0x3443fd+'Â°C':_0x171264(0x1a7);}if(this[_0x171264(0x208)][_0x171264(0x176)]){const _0x45c39d=await this[_0x171264(0x195)](_0x171264(0x1ce)+this['config'][_0x171264(0x176)]);_0x19ba06=_0x45c39d?_0x171264(0x21a):_0x171264(0x246);}this['sendTo'](_0xdc8e4d['from'],_0xdc8e4d[_0x171264(0x245)],{'success':!![],'weather':_0x2a1be7,'calendar':_0x19ba06},_0xdc8e4d[_0x171264(0x1ab)]);}catch(_0x2a1089){this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d[_0x171264(0x245)],{'success':![],'error':_0x2a1089[_0x171264(0x219)]},_0xdc8e4d['callback']);}else{if(_0xdc8e4d['command']===_0x171264(0x17b))try{const _0x5a1eed=_0xdc8e4d['message'][_0x171264(0x1a1)],_0x476027=await this[_0x171264(0x1b3)](_0x5a1eed+_0x171264(0x1d4));let _0xde393c=[];if(_0x476027&&_0x476027[_0x171264(0x18c)]){const _0x316e8a=JSON[_0x171264(0x17d)](_0x476027['val']),_0x2f1f07=new Set();Array[_0x171264(0x235)](_0x316e8a)&&_0x316e8a[_0x171264(0x1a0)](_0x451524=>{const _0x1b2c29=_0x171264;if(_0x451524['_calName'])_0x2f1f07[_0x1b2c29(0x183)](_0x451524[_0x1b2c29(0x188)]);else{if(_0x451524[_0x1b2c29(0x1fd)])_0x2f1f07[_0x1b2c29(0x183)](_0x451524[_0x1b2c29(0x1fd)]);}}),_0xde393c=Array[_0x171264(0x241)](_0x2f1f07)[_0x171264(0x218)]();}if(_0xde393c['length']===0x0)_0xde393c=['Standard'];this['sendTo'](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d[_0x171264(0x245)],{'success':!![],'names':_0xde393c},_0xdc8e4d[_0x171264(0x1ab)]);}catch(_0x2ab478){this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d[_0x171264(0x245)],{'success':![],'error':_0x2ab478[_0x171264(0x219)]},_0xdc8e4d[_0x171264(0x1ab)]);}else{if(_0xdc8e4d[_0x171264(0x245)]===_0x171264(0x1a5))try{await setup[_0x171264(0x1cc)](this,'ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.',![],![]),this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d[_0x171264(0x245)],{'success':!![],'message':'Gesendet'},_0xdc8e4d[_0x171264(0x1ab)]);}catch(_0x48dddd){this[_0x171264(0x234)][_0x171264(0x213)](_0x171264(0x1d1)+_0x48dddd['message']),this[_0x171264(0x1d3)](_0xdc8e4d[_0x171264(0x241)],_0xdc8e4d['command'],{'success':![],'message':_0x171264(0x225)+_0x48dddd['message']},_0xdc8e4d['callback']);}}}}}}}}}}}async['loadSystemMode'](){const _0x3c9507=a0_0x3beab9;try{const _0x1dc160=await this['getStateAsync'](setup['SYSTEM_DP_MODE']);_0x1dc160&&_0x1dc160['val']&&Object['values'](setup['SYSTEM_MODES'])[_0x3c9507(0x203)](_0x1dc160[_0x3c9507(0x18c)])?this['currentSystemMode']=_0x1dc160['val']:(this['currentSystemMode']=setup['SYSTEM_MODES'][_0x3c9507(0x172)],await this[_0x3c9507(0x207)](setup[_0x3c9507(0x239)],{'val':setup['SYSTEM_MODES'][_0x3c9507(0x172)],'ack':!![]}));}catch(_0x82046c){this['currentSystemMode']=setup['SYSTEM_MODES'][_0x3c9507(0x172)];}}async[a0_0x3beab9(0x1b4)](){const _0x50c5cb=a0_0x3beab9;try{const _0x1110b9=this[_0x50c5cb(0x208)]['presenceDevices']||[];let _0x181501=![];const _0x6f8f8d=[];for(const _0x4ec9f2 of _0x1110b9){try{const _0x12ee58=await this['getForeignStateAsync'](_0x4ec9f2);_0x12ee58&&(_0x12ee58[_0x50c5cb(0x18c)]===!![]||_0x12ee58['val']===_0x50c5cb(0x1f3)||_0x12ee58[_0x50c5cb(0x18c)]===0x1)&&(_0x181501=!![],_0x6f8f8d['push'](_0x4ec9f2));}catch(_0x221d39){}}return await this['setStateAsync'](_0x50c5cb(0x20f),{'val':_0x6f8f8d['join'](',\x20'),'ack':!![]}),_0x181501&&(this['exitTimer']&&(this[_0x50c5cb(0x234)][_0x50c5cb(0x217)](_0x50c5cb(0x228)),recorder[_0x50c5cb(0x1f5)](this)),!this[_0x50c5cb(0x173)]&&this[_0x50c5cb(0x247)]===setup[_0x50c5cb(0x1f1)][_0x50c5cb(0x172)]&&await recorder[_0x50c5cb(0x23d)](this,!![])),_0x181501;}catch(_0xae5e0d){return![];}}async['runAutopilot'](){const _0x136ba6=a0_0x3beab9;this[_0x136ba6(0x234)][_0x136ba6(0x186)](_0x136ba6(0x21c)),await aiAgent['runGeminiAnalysis'](this),this[_0x136ba6(0x191)](),this[_0x136ba6(0x23b)](),this[_0x136ba6(0x1da)]();}[a0_0x3beab9(0x23b)](){const _0x1cf3db=a0_0x3beab9;if(!this[_0x1cf3db(0x22a)])return;try{this[_0x1cf3db(0x1e7)](_0x1cf3db(0x1d2),(_0x88a9a4,_0x51c7cd)=>{const _0x2613b3=_0x1cf3db;_0x51c7cd&&_0x51c7cd[_0x2613b3(0x18c)]&&pythonBridge[_0x2613b3(0x1b5)](this,_0x2613b3(0x1f2),{'sequences':JSON['parse'](_0x51c7cd[_0x2613b3(0x18c)])});});}catch(_0x562ca2){}}async['triggerEnergyPrediction'](){const _0x4e84b1=a0_0x3beab9;if(!this[_0x4e84b1(0x22a)])return;try{const _0x4874a6=await recorder[_0x4e84b1(0x223)](this);if(_0x4874a6===null)return;const _0x17ca6c={},_0x2d4065=this[_0x4e84b1(0x208)][_0x4e84b1(0x1ea)]||[];for(const _0x55c2c1 of _0x2d4065){if(_0x55c2c1[_0x4e84b1(0x185)]===_0x4e84b1(0x1e2)&&_0x55c2c1[_0x4e84b1(0x21f)]){const _0x217e85=this[_0x4e84b1(0x1ee)][_0x55c2c1['id']];if(_0x217e85!==undefined)_0x17ca6c[_0x55c2c1[_0x4e84b1(0x21f)]]=_0x217e85;}}Object['keys'](_0x17ca6c)[_0x4e84b1(0x21e)]>0x0&&pythonBridge[_0x4e84b1(0x1b5)](this,_0x4e84b1(0x1d6),{'current_temps':_0x17ca6c,'t_out':_0x4874a6});}catch(_0x51aba8){}}['updateHealthVector'](){const _0x33026e=a0_0x3beab9;if(!this['rawEventLog']||this[_0x33026e(0x222)]['length']===0x0)return;const _0x53c6bd=new Array(0x60)['fill'](0x0),_0x1b83d6=new Date()[_0x33026e(0x1dc)](0x0,0x0,0x0,0x0);this[_0x33026e(0x222)][_0x33026e(0x1a0)](_0x4ae34b=>{const _0x1bb608=_0x33026e,_0x38c8b6=new Date(_0x4ae34b[_0x1bb608(0x18e)]);if(_0x38c8b6[_0x1bb608(0x1e6)]()>=_0x1b83d6){const _0x72f0df=_0x38c8b6[_0x1bb608(0x192)](),_0x37ea2c=_0x38c8b6['getMinutes'](),_0x275b73=_0x72f0df*0x4+Math[_0x1bb608(0x189)](_0x37ea2c/0xf);if(_0x275b73>=0x0&&_0x275b73<0x60)_0x53c6bd[_0x275b73]++;}}),this['setStateAsync'](_0x33026e(0x1f8),{'val':JSON['stringify'](_0x53c6bd),'ack':!![]});}['runPythonHealthCheck'](){const _0x2c8e07=a0_0x3beab9;if(!this[_0x2c8e07(0x19a)]||this[_0x2c8e07(0x19a)]['length']<0x2)return;const _0x4c89c1=this[_0x2c8e07(0x19a)]['map'](_0x8e8ea9=>{const _0x3e8c5a=_0x2c8e07,_0x4d9c43=(_0x8e8ea9[_0x3e8c5a(0x19d)]||'')[_0x3e8c5a(0x205)]();return ACTIVITY_LEVEL_MAP[_0x4d9c43]||0x32;});pythonBridge[_0x2c8e07(0x1b5)](this,_0x2c8e07(0x20b),{'values':_0x4c89c1,'tag':_0x2c8e07(0x1be)});}}if(require[a0_0x3beab9(0x187)]!==module)module['exports']=_0x51e06c=>new CogniLiving(_0x51e06c);else new CogniLiving();