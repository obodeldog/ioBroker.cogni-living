const a0_0x3cb6db=a0_0x5ac5;(function(_0x2b1665,_0x185492){const _0xe79d58=a0_0x5ac5,_0x2207e1=_0x2b1665();while(!![]){try{const _0x438f7a=-parseInt(_0xe79d58(0x25e))/0x1+-parseInt(_0xe79d58(0x1b8))/0x2*(parseInt(_0xe79d58(0x1c4))/0x3)+parseInt(_0xe79d58(0x260))/0x4*(parseInt(_0xe79d58(0x1dd))/0x5)+parseInt(_0xe79d58(0x1e8))/0x6+parseInt(_0xe79d58(0x24e))/0x7+parseInt(_0xe79d58(0x1c0))/0x8*(parseInt(_0xe79d58(0x1d8))/0x9)+-parseInt(_0xe79d58(0x1f5))/0xa;if(_0x438f7a===_0x185492)break;else _0x2207e1['push'](_0x2207e1['shift']());}catch(_0x1d51e8){_0x2207e1['push'](_0x2207e1['shift']());}}}(a0_0x6b63,0x4d15c));const a0_0x3a4e8a=(function(){let _0x53be4c=!![];return function(_0x158a9a,_0x1afde0){const _0xb610b9=_0x53be4c?function(){if(_0x1afde0){const _0x273b40=_0x1afde0['apply'](_0x158a9a,arguments);return _0x1afde0=null,_0x273b40;}}:function(){};return _0x53be4c=![],_0xb610b9;};}()),a0_0x324f47=a0_0x3a4e8a(this,function(){const _0x246b69=a0_0x5ac5;return a0_0x324f47['toString']()[_0x246b69(0x23f)](_0x246b69(0x20d))[_0x246b69(0x253)]()[_0x246b69(0x255)](a0_0x324f47)[_0x246b69(0x23f)](_0x246b69(0x20d));});function a0_0x6b63(){const _0x4e5de4=['Gemini\x20AI\x20initialized.','analysis.automation.triggerAction','enum.rooms.*','version','inactivityThresholdHours','onStateChange','system.adapter.','geminiModel','.data.table','val','.communicate.request','bind','dependencyInstallInProgress','includes','analysis.training.triggerHealth','(((.+)+)+)+$','isProVersion','modeResetJob','getForeignObjectsAsync','isGracePeriodActive','.system.mode','telegram','initZombies','Aktiv\x20(','setupBriefingScheduler','./lib/python_bridge','analysis.topology.structure','analysisHistory','getGenerativeModel','@iobroker/adapter-core','message','exitGraceTimer','analysis.training.triggerEnergy','Kein\x20Wetter-Adapter','onMessage','minDaysForBaseline','cancel','split','runAutopilot','getForeignObjectAsync','LTM.trainingData.thermodynamics','devices','startSystem','Keine\x20Antwort\x20von\x20Gemini','createAllObjects','endsWith','TRAIN_SECURITY','ack','licenseKey','online','checkWifiPresence','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','map','NORMAL','setStateAsync','toLowerCase','log','LTM.dailyDigests','./lib/scheduler',')\x20-\x20Phase\x20C\x20(Hardened)','config','LTM.trainingData.sequences','updateHealthVector','currentSystemMode','./lib/topology','search','Standard','stringify','systemConfig','pop','SYSTEM_MODES','_calName','executeAutomationAction','from','testApiKey','Verbindung\x20erfolgreich!','analysis.triggerBriefing','updateTopologyMatrix','loadSystemMode','location','4194036nGPBrm','onUnload','Fehler:\x20','type','system.presenceWho','toString','updated','constructor','values','ANALYZE_GAIT','forEach','getTime','analysis.trigger','callback','apiKey','Activity-Level','25328noCNrQ','updateLocation','6036uwZFcf','exitTimer','floor','activityLevel','cogni-living\x20adapter\x20starting\x20(v','enum','Gesendet','calendarName','./lib/recorder','temperature','runGeminiAnalysis','enum.functions.*','isPresent','setupModeResetScheduler','setHours','LTM.rawEventLog','dailyDigests','runPythonHealthCheck','./lib/ai_agent','startService','stopService','sendTo','setPresence','subscribeForeignStatesAsync','parse','application/json','getForeignStateAsync','getMinutes','setupDriftAnalysisScheduler','main','Daten\x20nicht\x20verfÃ¼gbar','triggerGaitAnalysis','abortExitTimer','@google/generative-ai','calendarInstance','analysis.training.triggerComfort','briefingJob','runBaselineDriftAnalysis','analysisInterval','name','notifyTelegramEnabled','now','onReady','debug','motion','getLtmData','569452bqHntp','analysis.automation.autoApply','push','eventHistory','setState','info','getCalendarNames','Gemini\x20Init\x20Error:\x20','16dgpbfz','unload','models/gemini-flash-latest','TRAIN_COMFORT','3vgpBzP','createDailyDigest','\x20Tage)','getState','keys','getOutsideTemperatureNumeric','ANALYZE_TREND','communicate.request','triggerDailyDigest','triggerEnergyPrediction','analysisTimer','genAI','rawEventLog','sensorLastValues','subscribeStates','VACATION','./lib/installer','command','presenceDevices','Verbunden','594477kcUUdJ','triggerBriefing','object','geminiApiKey','updateTopology','805LJuhri','processSensorEvent','Instanz\x20nicht\x20gefunden','scanDevices','LTM.baselineStatus','error','ready','analysis.training.triggerTopology','PYTHON_EXE','common','timestamp','3756840zAlhNa','Lernphase\x20(','setupLtmScheduler','namespace','getStateAsync','send','notifyTelegramInstance','length','ltmJob','add','SYSTEM_DP_MODE','./lib/scanner','analysis.training.triggerSecurity','9745490CccKiZ','Test','SET_TOPOLOGY','find','sort','driftAnalysisTimer','generateContent','getHours','Kein\x20Kalender-Adapter'];a0_0x6b63=function(){return _0x4e5de4;};return a0_0x6b63();}a0_0x324f47();function a0_0x5ac5(_0x5a4d34,_0x15294a){const _0x4b1260=a0_0x6b63();return a0_0x5ac5=function(_0x324f47,_0x3a4e8a){_0x324f47=_0x324f47-0x1b7;let _0x6b631b=_0x4b1260[_0x324f47];return _0x6b631b;},a0_0x5ac5(_0x5a4d34,_0x15294a);}'use strict';const utils=require(a0_0x3cb6db(0x21b)),{GoogleGenerativeAI}=require(a0_0x3cb6db(0x281)),installer=require(a0_0x3cb6db(0x1d4)),scanner=require(a0_0x3cb6db(0x1f3)),schedulers=require(a0_0x3cb6db(0x238)),topology=require(a0_0x3cb6db(0x23e)),setup=require('./lib/setup'),recorder=require(a0_0x3cb6db(0x268)),pythonBridge=require(a0_0x3cb6db(0x217)),aiAgent=require(a0_0x3cb6db(0x272)),deadMan=require('./lib/dead_man'),GEMINI_MODEL=a0_0x3cb6db(0x1c2),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils['Adapter']{constructor(_0x4e1d4e){const _0x10e003=a0_0x3cb6db;super({..._0x4e1d4e,'name':'cogni-living'}),this['eventHistory']=[],this[_0x10e003(0x219)]=[],this[_0x10e003(0x1d0)]=[],this[_0x10e003(0x270)]=[],this[_0x10e003(0x1d1)]={},this[_0x10e003(0x242)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x10e003(0x26c)]=!![],this[_0x10e003(0x261)]=null,this[_0x10e003(0x21d)]=null,this[_0x10e003(0x211)]=![],this[_0x10e003(0x1cf)]=null,this[_0x10e003(0x205)]=null,this['currentSystemMode']=setup[_0x10e003(0x244)]['NORMAL'],this[_0x10e003(0x20e)]=![],this['lastAlertState']=![],this[_0x10e003(0x1ce)]=null,this['ltmJob']=null,this[_0x10e003(0x20f)]=null,this['driftAnalysisTimer']=null,this[_0x10e003(0x284)]=null,this[_0x10e003(0x20a)]=![],this['on'](_0x10e003(0x1e3),this[_0x10e003(0x28a)][_0x10e003(0x209)](this)),this['on']('stateChange',this[_0x10e003(0x203)]['bind'](this)),this['on'](_0x10e003(0x1c1),this['onUnload'][_0x10e003(0x209)](this)),this['on'](_0x10e003(0x21c),this[_0x10e003(0x220)][_0x10e003(0x209)](this));}async['onReady'](){const _0x1ee768=a0_0x3cb6db;this[_0x1ee768(0x236)][_0x1ee768(0x1bd)](_0x1ee768(0x264)+this[_0x1ee768(0x201)]+_0x1ee768(0x239));if(!installer['checkAndInstall'](this,()=>this[_0x1ee768(0x228)]()))return;}async[a0_0x3cb6db(0x228)](){const _0x46718a=a0_0x3cb6db;await setup[_0x46718a(0x214)](this);try{this['isProVersion']=await setup['checkLicense'](this['config'][_0x46718a(0x22e)]);}catch(_0x50da46){}if(!this['config'][_0x46718a(0x202)]||this[_0x46718a(0x23a)][_0x46718a(0x202)]<0.1)this[_0x46718a(0x23a)][_0x46718a(0x202)]=0xc;await setup['initHistory'](this),await setup['initSystemConfig'](this);if(this[_0x46718a(0x23a)][_0x46718a(0x1db)])try{this['genAI']=new GoogleGenerativeAI(this[_0x46718a(0x23a)]['geminiApiKey']),this['geminiModel']=this['genAI'][_0x46718a(0x21a)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x46718a(0x279)}}),this['log']['info'](_0x46718a(0x1fe));}catch(_0x4b0977){this['log']['error'](_0x46718a(0x1bf)+_0x4b0977[_0x46718a(0x21c)]);}await setup[_0x46718a(0x22a)](this),await this[_0x46718a(0x24c)]();try{const _0x3330bc=await this[_0x46718a(0x1ec)](_0x46718a(0x26f));if(_0x3330bc&&_0x3330bc['val'])this[_0x46718a(0x1d0)]=JSON[_0x46718a(0x278)](_0x3330bc[_0x46718a(0x207)]);}catch(_0x1eb095){this[_0x46718a(0x1d0)]=[];}try{const _0x5ac2f7=await this[_0x46718a(0x1ec)](_0x46718a(0x237));if(_0x5ac2f7&&_0x5ac2f7[_0x46718a(0x207)])this['dailyDigests']=JSON[_0x46718a(0x278)](_0x5ac2f7[_0x46718a(0x207)]);}catch(_0x5063a1){this[_0x46718a(0x270)]=[];}const _0x54b013=this[_0x46718a(0x270)][_0x46718a(0x1ef)]>=(this[_0x46718a(0x23a)][_0x46718a(0x221)]||0x7)?_0x46718a(0x215)+this[_0x46718a(0x270)][_0x46718a(0x1ef)]+_0x46718a(0x1c6):_0x46718a(0x1e9)+this['dailyDigests']['length']+'/'+(this[_0x46718a(0x23a)][_0x46718a(0x221)]||0x7)+')';await this[_0x46718a(0x234)](_0x46718a(0x1e1),{'val':_0x54b013,'ack':!![]}),this[_0x46718a(0x1d2)](_0x46718a(0x25a)),this[_0x46718a(0x1d2)]('LTM.triggerDailyDigest'),this[_0x46718a(0x1d2)]('system.mode'),this[_0x46718a(0x1d2)](_0x46718a(0x24a)),this[_0x46718a(0x1d2)](_0x46718a(0x1ff)),this['subscribeStates'](_0x46718a(0x1b9)),this[_0x46718a(0x1d2)](_0x46718a(0x1f4)),this[_0x46718a(0x1d2)]('analysis.training.triggerHealth'),this[_0x46718a(0x1d2)](_0x46718a(0x21e)),this[_0x46718a(0x1d2)](_0x46718a(0x283)),this[_0x46718a(0x1d2)]('analysis.training.triggerTopology');const _0x5a84e4=this['config'][_0x46718a(0x227)];if(_0x5a84e4)for(const _0x4442f7 of _0x5a84e4){await this['subscribeForeignStatesAsync'](_0x4442f7['id']);}const _0x4426d8=this[_0x46718a(0x23a)][_0x46718a(0x1d6)];if(_0x4426d8)for(const _0x5306b8 of _0x4426d8){await this[_0x46718a(0x277)](_0x5306b8);}if(this[_0x46718a(0x23a)][_0x46718a(0x288)]&&this['config'][_0x46718a(0x1ee)])await this['subscribeForeignStatesAsync'](this[_0x46718a(0x23a)][_0x46718a(0x1ee)]+_0x46718a(0x208));setTimeout(()=>this['checkWifiPresence'](),0x1388);if(this[_0x46718a(0x1ce)])clearInterval(this[_0x46718a(0x1ce)]);const _0x115603=this['config'][_0x46718a(0x286)]||0xf;_0x115603>0x0&&(this[_0x46718a(0x1ce)]=setInterval(()=>{const _0x3644c5=_0x46718a;this[_0x3644c5(0x224)]();},_0x115603*0x3c*0x3e8)),schedulers[_0x46718a(0x1ea)](this,()=>aiAgent[_0x46718a(0x1c5)](this,pythonBridge)),schedulers[_0x46718a(0x26d)](this),schedulers[_0x46718a(0x27c)](this,()=>aiAgent[_0x46718a(0x285)](this)),schedulers[_0x46718a(0x216)](this,()=>aiAgent['sendMorningBriefing'](this)),pythonBridge[_0x46718a(0x273)](this,installer[_0x46718a(0x1e5)]),setTimeout(async()=>{const _0x1e325b=_0x46718a;await topology[_0x1e325b(0x1dc)](this);try{const _0x5efe8b=await this[_0x1e325b(0x1ec)](_0x1e325b(0x218));if(_0x5efe8b&&_0x5efe8b['val'])pythonBridge[_0x1e325b(0x1ed)](this,_0x1e325b(0x1f7),JSON[_0x1e325b(0x278)](_0x5efe8b['val']));}catch(_0x4c38c0){}this['runPythonHealthCheck'](),this[_0x1e325b(0x27f)](),this[_0x1e325b(0x1cd)](),this[_0x1e325b(0x23c)]();},0x1388);}[a0_0x3cb6db(0x24f)](_0x3797b0){const _0x3f47a1=a0_0x3cb6db;if(this['analysisTimer'])clearInterval(this['analysisTimer']);if(this['driftAnalysisTimer'])clearInterval(this[_0x3f47a1(0x1fa)]);if(this[_0x3f47a1(0x1f0)])this[_0x3f47a1(0x1f0)][_0x3f47a1(0x222)]();if(this[_0x3f47a1(0x20f)])this[_0x3f47a1(0x20f)]['cancel']();if(this[_0x3f47a1(0x284)])this[_0x3f47a1(0x284)][_0x3f47a1(0x222)]();recorder[_0x3f47a1(0x280)](this),pythonBridge[_0x3f47a1(0x274)](this),_0x3797b0();}async['onStateChange'](_0x47ac45,_0x833a){const _0x4c38d5=a0_0x3cb6db;if(!_0x833a||this['dependencyInstallInProgress'])return;if(_0x47ac45[_0x4c38d5(0x20b)](_0x4c38d5(0x213))&&_0x47ac45[_0x4c38d5(0x22b)](_0x4c38d5(0x1cb))&&_0x833a[_0x4c38d5(0x207)])return;if(_0x47ac45===this[_0x4c38d5(0x1eb)]+_0x4c38d5(0x212)){if(_0x833a[_0x4c38d5(0x207)]&&Object['values'](setup[_0x4c38d5(0x244)])[_0x4c38d5(0x20b)](_0x833a['val'])){this[_0x4c38d5(0x23d)]=_0x833a['val'];if(_0x833a[_0x4c38d5(0x207)]===setup[_0x4c38d5(0x244)][_0x4c38d5(0x1d3)])await recorder[_0x4c38d5(0x276)](this,![]);else await recorder[_0x4c38d5(0x276)](this,!![]);}if(!_0x833a[_0x4c38d5(0x22d)])this[_0x4c38d5(0x1bc)](_0x47ac45,{'val':this[_0x4c38d5(0x23d)],'ack':!![]});return;}if(!_0x833a['ack']){_0x47ac45[_0x4c38d5(0x20b)](_0x4c38d5(0x25a))&&_0x833a['val']&&(this[_0x4c38d5(0x1bc)](_0x47ac45,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this));if(_0x47ac45[_0x4c38d5(0x20b)](_0x4c38d5(0x1cc))&&_0x833a[_0x4c38d5(0x207)]){this['setState'](_0x47ac45,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent[_0x4c38d5(0x1c5)](this,pythonBridge);}_0x47ac45['includes'](_0x4c38d5(0x1d9))&&_0x833a[_0x4c38d5(0x207)]&&(this['setState'](_0x47ac45,{'val':![],'ack':!![]}),aiAgent['sendMorningBriefing'](this));_0x47ac45[_0x4c38d5(0x20b)]('automation.triggerAction')&&_0x833a[_0x4c38d5(0x207)]&&(this[_0x4c38d5(0x1bc)](_0x47ac45,{'val':![],'ack':!![]}),aiAgent[_0x4c38d5(0x246)](this));if(_0x47ac45[_0x4c38d5(0x20b)](_0x4c38d5(0x1f4))&&_0x833a[_0x4c38d5(0x207)]){this[_0x4c38d5(0x1bc)](_0x47ac45,{'val':![],'ack':!![]});if(this[_0x4c38d5(0x20e)])try{const _0xdadfda=await this[_0x4c38d5(0x1ec)](_0x4c38d5(0x23b));if(_0xdadfda&&_0xdadfda[_0x4c38d5(0x207)]){const _0x24a833=JSON[_0x4c38d5(0x278)](_0xdadfda[_0x4c38d5(0x207)]);this[_0x4c38d5(0x234)]('analysis.training.status',{'val':'Sec-Training\x20started...','ack':!![]}),pythonBridge[_0x4c38d5(0x1ed)](this,_0x4c38d5(0x22c),{'sequences':_0x24a833});}}catch(_0x42f27b){}}if(_0x47ac45[_0x4c38d5(0x20b)](_0x4c38d5(0x20c))&&_0x833a[_0x4c38d5(0x207)]){this[_0x4c38d5(0x1bc)](_0x47ac45,{'val':![],'ack':!![]});if(this[_0x4c38d5(0x20e)])try{const _0x5c83c9=await this[_0x4c38d5(0x1ec)](_0x4c38d5(0x237));if(_0x5c83c9&&_0x5c83c9[_0x4c38d5(0x207)])pythonBridge[_0x4c38d5(0x1ed)](this,'TRAIN_HEALTH',{'digests':JSON[_0x4c38d5(0x278)](_0x5c83c9['val'])});}catch(_0x48a8f8){}}if(_0x47ac45[_0x4c38d5(0x20b)](_0x4c38d5(0x21e))&&_0x833a['val']){this[_0x4c38d5(0x1bc)](_0x47ac45,{'val':![],'ack':!![]});if(this[_0x4c38d5(0x20e)])try{const _0x18ddb8=await this[_0x4c38d5(0x1ec)](_0x4c38d5(0x226));if(_0x18ddb8&&_0x18ddb8[_0x4c38d5(0x207)])pythonBridge[_0x4c38d5(0x1ed)](this,'TRAIN_ENERGY',{'points':JSON[_0x4c38d5(0x278)](_0x18ddb8[_0x4c38d5(0x207)])});}catch(_0x59c654){}}if(_0x47ac45[_0x4c38d5(0x20b)](_0x4c38d5(0x283))&&_0x833a['val']){this['setState'](_0x47ac45,{'val':![],'ack':!![]});if(this[_0x4c38d5(0x20e)])try{const _0x5d2fcc=await this[_0x4c38d5(0x1ec)](_0x4c38d5(0x26f));if(_0x5d2fcc&&_0x5d2fcc[_0x4c38d5(0x207)])pythonBridge['send'](this,_0x4c38d5(0x1c3),{'events':JSON[_0x4c38d5(0x278)](_0x5d2fcc['val'])});}catch(_0xf9590a){}}_0x47ac45[_0x4c38d5(0x20b)](_0x4c38d5(0x1e4))&&_0x833a[_0x4c38d5(0x207)]&&(this[_0x4c38d5(0x1bc)](_0x47ac45,{'val':![],'ack':!![]}),topology[_0x4c38d5(0x1dc)](this));return;}if(this[_0x4c38d5(0x23a)][_0x4c38d5(0x1d6)]&&this['config'][_0x4c38d5(0x1d6)][_0x4c38d5(0x20b)](_0x47ac45)){await this[_0x4c38d5(0x230)]();return;}const _0x2ded00=(this[_0x4c38d5(0x23a)][_0x4c38d5(0x227)]||[])[_0x4c38d5(0x1f8)](_0x302f6f=>_0x302f6f['id']===_0x47ac45);if(_0x2ded00){const _0x366b45=await recorder[_0x4c38d5(0x1de)](this,_0x47ac45,_0x833a,_0x2ded00);_0x366b45&&_0x366b45[_0x4c38d5(0x251)]===_0x4c38d5(0x28c)&&_0x366b45[_0x4c38d5(0x24d)]&&this[_0x4c38d5(0x20e)]&&deadMan[_0x4c38d5(0x25f)](this,_0x366b45[_0x4c38d5(0x24d)]);}}async[a0_0x3cb6db(0x220)](_0xf6547b){const _0xb49942=a0_0x3cb6db;if(typeof _0xf6547b===_0xb49942(0x1da)&&_0xf6547b[_0xb49942(0x21c)]){if(_0xf6547b[_0xb49942(0x1d5)]===_0xb49942(0x248))try{const _0x52f3c8=_0xf6547b['message'][_0xb49942(0x25c)];if(!_0x52f3c8)throw new Error('Kein\x20API\x20Key\x20Ã¼bergeben');const _0x46b7c3=new GoogleGenerativeAI(_0x52f3c8),_0x54e643=_0x46b7c3['getGenerativeModel']({'model':GEMINI_MODEL}),_0x561e9e=await _0x54e643[_0xb49942(0x1fb)](_0xb49942(0x1f6)),_0x492f00=await _0x561e9e['response'];if(_0x492f00['text']())this[_0xb49942(0x275)](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':!![],'message':_0xb49942(0x249)},_0xf6547b['callback']);else throw new Error(_0xb49942(0x229));}catch(_0x493d34){this[_0xb49942(0x275)](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':![],'message':_0x493d34[_0xb49942(0x21c)]},_0xf6547b[_0xb49942(0x25b)]);}else{if(_0xf6547b[_0xb49942(0x1d5)]===_0xb49942(0x1e0))try{const _0x4f8a3c=await scanner['scanForDevices'](this,_0xf6547b['message']||{});this[_0xb49942(0x275)](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':!![],'devices':_0x4f8a3c},_0xf6547b[_0xb49942(0x25b)]);}catch(_0x40c97c){this[_0xb49942(0x275)](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':![],'error':_0x40c97c[_0xb49942(0x21c)]},_0xf6547b[_0xb49942(0x25b)]);}else{if(_0xf6547b[_0xb49942(0x1d5)]===_0xb49942(0x24b))try{const {matrix:_0xdd4508}=_0xf6547b['message'],_0x428423=await this[_0xb49942(0x1ec)](_0xb49942(0x218));if(_0x428423&&_0x428423['val']){const _0x388a55=JSON['parse'](_0x428423[_0xb49942(0x207)]);_0x388a55['matrix']=_0xdd4508,_0x388a55[_0xb49942(0x254)]=Date[_0xb49942(0x289)](),await this[_0xb49942(0x234)](_0xb49942(0x218),{'val':JSON[_0xb49942(0x241)](_0x388a55),'ack':!![]}),pythonBridge[_0xb49942(0x1ed)](this,_0xb49942(0x1f7),_0x388a55);}this['sendTo'](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':!![]},_0xf6547b[_0xb49942(0x25b)]);}catch(_0x1ba2fd){this[_0xb49942(0x236)][_0xb49942(0x1e2)](_0x1ba2fd);}else{if(_0xf6547b[_0xb49942(0x1d5)]===_0xb49942(0x1b7))this['sendTo'](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':!![],'dailyDigests':this[_0xb49942(0x270)]||[],'analysisHistory':this[_0xb49942(0x219)]||[]},_0xf6547b[_0xb49942(0x25b)]);else{if(_0xf6547b[_0xb49942(0x1d5)]==='getOverviewData'){const _0x24a294=this[_0xb49942(0x270)][_0xb49942(0x1ef)],_0x438f07=new Array(0x18)['fill'](0x0),_0x55212f=new Date()['setHours'](0x0,0x0,0x0,0x0);this[_0xb49942(0x1bb)]&&this[_0xb49942(0x1bb)][_0xb49942(0x258)](_0x3dbe50=>{const _0x51331e=_0xb49942;if(_0x3dbe50[_0x51331e(0x1e7)]>=_0x55212f){const _0x501284=new Date(_0x3dbe50[_0x51331e(0x1e7)])[_0x51331e(0x1fc)]();if(_0x501284>=0x0&&_0x501284<0x18)_0x438f07[_0x501284]++;}}),this['sendTo'](_0xf6547b['from'],_0xf6547b[_0xb49942(0x1d5)],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0xf),'stats':{'digestCount':_0x24a294,'isPresent':this[_0xb49942(0x26c)],'hourlyActivity':_0x438f07},'automation':{'detected':![]}},_0xf6547b[_0xb49942(0x25b)]);}else{if(_0xf6547b[_0xb49942(0x1d5)]==='getEnums'){const _0x3b1738=await this['getForeignObjectsAsync'](_0xb49942(0x26b),_0xb49942(0x265)),_0xc6ab4a=[];if(_0x3b1738)for(const _0x5ad566 in _0x3b1738){const _0x476b7f=_0x3b1738[_0x5ad566],_0x15c3e5=(_0x476b7f['common']&&typeof _0x476b7f['common'][_0xb49942(0x287)]==='object'?_0x476b7f[_0xb49942(0x1e6)][_0xb49942(0x287)]['de']:_0x476b7f['common']['name'])||_0x476b7f['common']['name'];_0xc6ab4a[_0xb49942(0x1ba)]({'id':_0x5ad566,'name':_0x15c3e5});}const _0x287981=await this[_0xb49942(0x210)](_0xb49942(0x200),_0xb49942(0x265)),_0x3a34bb=[];if(_0x287981)for(const _0x58f496 in _0x287981){const _0xa4592f=_0x287981[_0x58f496],_0x1b2160=(_0xa4592f[_0xb49942(0x1e6)]&&typeof _0xa4592f[_0xb49942(0x1e6)][_0xb49942(0x287)]===_0xb49942(0x1da)?_0xa4592f[_0xb49942(0x1e6)][_0xb49942(0x287)]['de']:_0xa4592f[_0xb49942(0x1e6)][_0xb49942(0x287)])||_0x58f496[_0xb49942(0x223)]('.')[_0xb49942(0x243)]();_0x3a34bb[_0xb49942(0x1ba)](_0x1b2160);}this[_0xb49942(0x275)](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':!![],'enums':_0xc6ab4a,'rooms':_0x3a34bb},_0xf6547b[_0xb49942(0x25b)]);}else{if(_0xf6547b[_0xb49942(0x1d5)]==='testContext')try{let _0x358bd4=_0xb49942(0x21f),_0x434d75=_0xb49942(0x1fd);if(this[_0xb49942(0x23a)]['weatherInstance']){const _0x55b825=await recorder[_0xb49942(0x1c9)](this);_0x358bd4=_0x55b825!==null?_0x55b825+'Â°C':_0xb49942(0x27e);}if(this[_0xb49942(0x23a)][_0xb49942(0x282)]){const _0x2599d7=await this[_0xb49942(0x225)](_0xb49942(0x204)+this[_0xb49942(0x23a)][_0xb49942(0x282)]);_0x434d75=_0x2599d7?_0xb49942(0x1d7):_0xb49942(0x1df);}this['sendTo'](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':!![],'weather':_0x358bd4,'calendar':_0x434d75},_0xf6547b['callback']);}catch(_0x302155){this[_0xb49942(0x275)](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':![],'error':_0x302155['message']},_0xf6547b['callback']);}else{if(_0xf6547b[_0xb49942(0x1d5)]===_0xb49942(0x1be))try{const _0x1a015b=_0xf6547b['message']['instance'],_0x5ce54c=await this['getForeignStateAsync'](_0x1a015b+_0xb49942(0x206));let _0x537a79=[];if(_0x5ce54c&&_0x5ce54c['val']){const _0x3673f9=JSON[_0xb49942(0x278)](_0x5ce54c[_0xb49942(0x207)]),_0x2be9ba=new Set();Array['isArray'](_0x3673f9)&&_0x3673f9[_0xb49942(0x258)](_0x1ce431=>{const _0xf345d1=_0xb49942;if(_0x1ce431[_0xf345d1(0x245)])_0x2be9ba[_0xf345d1(0x1f1)](_0x1ce431[_0xf345d1(0x245)]);else{if(_0x1ce431[_0xf345d1(0x267)])_0x2be9ba[_0xf345d1(0x1f1)](_0x1ce431[_0xf345d1(0x267)]);}}),_0x537a79=Array[_0xb49942(0x247)](_0x2be9ba)[_0xb49942(0x1f9)]();}if(_0x537a79['length']===0x0)_0x537a79=[_0xb49942(0x240)];this['sendTo'](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':!![],'names':_0x537a79},_0xf6547b[_0xb49942(0x25b)]);}catch(_0x40daa4){this[_0xb49942(0x275)](_0xf6547b[_0xb49942(0x247)],_0xf6547b['command'],{'success':![],'error':_0x40daa4[_0xb49942(0x21c)]},_0xf6547b[_0xb49942(0x25b)]);}else{if(_0xf6547b['command']==='testNotification')try{await setup['sendNotification'](this,'ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.',![],![]),this[_0xb49942(0x275)](_0xf6547b[_0xb49942(0x247)],_0xf6547b['command'],{'success':!![],'message':_0xb49942(0x266)},_0xf6547b[_0xb49942(0x25b)]);}catch(_0x433afe){this[_0xb49942(0x236)][_0xb49942(0x1e2)]('Notification\x20Test\x20Failed:\x20'+_0x433afe[_0xb49942(0x21c)]),this['sendTo'](_0xf6547b[_0xb49942(0x247)],_0xf6547b[_0xb49942(0x1d5)],{'success':![],'message':_0xb49942(0x250)+_0x433afe[_0xb49942(0x21c)]},_0xf6547b[_0xb49942(0x25b)]);}}}}}}}}}}}async[a0_0x3cb6db(0x24c)](){const _0x585e55=a0_0x3cb6db;try{const _0x85daa3=await this[_0x585e55(0x1ec)](setup[_0x585e55(0x1f2)]);_0x85daa3&&_0x85daa3[_0x585e55(0x207)]&&Object[_0x585e55(0x256)](setup[_0x585e55(0x244)])[_0x585e55(0x20b)](_0x85daa3[_0x585e55(0x207)])?this[_0x585e55(0x23d)]=_0x85daa3['val']:(this['currentSystemMode']=setup[_0x585e55(0x244)][_0x585e55(0x233)],await this[_0x585e55(0x234)](setup[_0x585e55(0x1f2)],{'val':setup[_0x585e55(0x244)][_0x585e55(0x233)],'ack':!![]}));}catch(_0x1c3b87){this[_0x585e55(0x23d)]=setup[_0x585e55(0x244)][_0x585e55(0x233)];}}async[a0_0x3cb6db(0x230)](){const _0x198e96=a0_0x3cb6db;try{const _0x52fe66=this[_0x198e96(0x23a)]['presenceDevices']||[];let _0x48758a=![];const _0x372f69=[];for(const _0x2fce8a of _0x52fe66){try{const _0x1ce612=await this[_0x198e96(0x27a)](_0x2fce8a);_0x1ce612&&(_0x1ce612[_0x198e96(0x207)]===!![]||_0x1ce612[_0x198e96(0x207)]===_0x198e96(0x22f)||_0x1ce612[_0x198e96(0x207)]===0x1)&&(_0x48758a=!![],_0x372f69[_0x198e96(0x1ba)](_0x2fce8a));}catch(_0x49345f){}}return await this[_0x198e96(0x234)](_0x198e96(0x252),{'val':_0x372f69['join'](',\x20'),'ack':!![]}),_0x48758a&&(this[_0x198e96(0x261)]&&(this[_0x198e96(0x236)][_0x198e96(0x1bd)]('WiFi\x20Presence\x20detected.'),recorder[_0x198e96(0x280)](this)),!this[_0x198e96(0x26c)]&&this['currentSystemMode']===setup['SYSTEM_MODES'][_0x198e96(0x233)]&&await recorder[_0x198e96(0x276)](this,!![])),_0x48758a;}catch(_0x109b65){return![];}}async['runAutopilot'](){const _0x1ea584=a0_0x3cb6db;this['log'][_0x1ea584(0x28b)](_0x1ea584(0x231)),await aiAgent[_0x1ea584(0x26a)](this),this[_0x1ea584(0x23c)](),this[_0x1ea584(0x27f)](),this[_0x1ea584(0x1cd)]();}[a0_0x3cb6db(0x27f)](){const _0x9ea279=a0_0x3cb6db;if(!this['isProVersion'])return;try{this[_0x9ea279(0x1c7)]('LTM.trainingData.sequences',(_0x38d115,_0x1d2579)=>{const _0x4a360d=_0x9ea279;_0x1d2579&&_0x1d2579[_0x4a360d(0x207)]&&pythonBridge[_0x4a360d(0x1ed)](this,_0x4a360d(0x257),{'sequences':JSON[_0x4a360d(0x278)](_0x1d2579[_0x4a360d(0x207)])});});}catch(_0x512599){}}async[a0_0x3cb6db(0x1cd)](){const _0x493d08=a0_0x3cb6db;if(!this[_0x493d08(0x20e)])return;try{const _0x1a1b17=await recorder[_0x493d08(0x1c9)](this);if(_0x1a1b17===null)return;const _0x32eb93={},_0x5e1da5=this[_0x493d08(0x23a)][_0x493d08(0x227)]||[];for(const _0x16f239 of _0x5e1da5){if(_0x16f239[_0x493d08(0x251)]===_0x493d08(0x269)&&_0x16f239[_0x493d08(0x24d)]){const _0x1d47e3=this[_0x493d08(0x1d1)][_0x16f239['id']];if(_0x1d47e3!==undefined)_0x32eb93[_0x16f239[_0x493d08(0x24d)]]=_0x1d47e3;}}Object[_0x493d08(0x1c8)](_0x32eb93)[_0x493d08(0x1ef)]>0x0&&pythonBridge[_0x493d08(0x1ed)](this,'PREDICT_ENERGY',{'current_temps':_0x32eb93,'t_out':_0x1a1b17});}catch(_0x2f99cf){}}[a0_0x3cb6db(0x23c)](){const _0x2a47f7=a0_0x3cb6db;if(!this['rawEventLog']||this['rawEventLog'][_0x2a47f7(0x1ef)]===0x0)return;const _0x206182=new Array(0x60)['fill'](0x0),_0xf22bb1=new Date()[_0x2a47f7(0x26e)](0x0,0x0,0x0,0x0);this[_0x2a47f7(0x1d0)][_0x2a47f7(0x258)](_0x47da14=>{const _0x11bfe9=_0x2a47f7,_0x19838c=new Date(_0x47da14[_0x11bfe9(0x1e7)]);if(_0x19838c[_0x11bfe9(0x259)]()>=_0xf22bb1){const _0x1e6783=_0x19838c[_0x11bfe9(0x1fc)](),_0x8cdbc5=_0x19838c[_0x11bfe9(0x27b)](),_0x5f3aa1=_0x1e6783*0x4+Math[_0x11bfe9(0x262)](_0x8cdbc5/0xf);if(_0x5f3aa1>=0x0&&_0x5f3aa1<0x60)_0x206182[_0x5f3aa1]++;}}),this[_0x2a47f7(0x234)]('analysis.health.todayVector',{'val':JSON[_0x2a47f7(0x241)](_0x206182),'ack':!![]});}[a0_0x3cb6db(0x271)](){const _0x4c84f0=a0_0x3cb6db;if(!this['dailyDigests']||this[_0x4c84f0(0x270)][_0x4c84f0(0x1ef)]<0x2)return;const _0x1d153a=this[_0x4c84f0(0x270)][_0x4c84f0(0x232)](_0x32aa93=>{const _0x13e4ff=_0x4c84f0,_0x6561ad=(_0x32aa93[_0x13e4ff(0x263)]||'')[_0x13e4ff(0x235)]();return ACTIVITY_LEVEL_MAP[_0x6561ad]||0x32;});pythonBridge['send'](this,_0x4c84f0(0x1ca),{'values':_0x1d153a,'tag':_0x4c84f0(0x25d)});}}if(require[a0_0x3cb6db(0x27d)]!==module)module['exports']=_0x3b58d1=>new CogniLiving(_0x3b58d1);else new CogniLiving();