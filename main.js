const a0_0x45eb70=a0_0x18a5;(function(_0xd766d7,_0x51c484){const _0x17dbdf=a0_0x18a5,_0x133659=_0xd766d7();while(!![]){try{const _0x42cbf3=-parseInt(_0x17dbdf(0x152))/0x1*(parseInt(_0x17dbdf(0x180))/0x2)+-parseInt(_0x17dbdf(0x263))/0x3+-parseInt(_0x17dbdf(0x186))/0x4+-parseInt(_0x17dbdf(0x11f))/0x5*(parseInt(_0x17dbdf(0x142))/0x6)+parseInt(_0x17dbdf(0x184))/0x7+-parseInt(_0x17dbdf(0x13e))/0x8+parseInt(_0x17dbdf(0xe1))/0x9*(parseInt(_0x17dbdf(0x217))/0xa);if(_0x42cbf3===_0x51c484)break;else _0x133659['push'](_0x133659['shift']());}catch(_0x205e53){_0x133659['push'](_0x133659['shift']());}}}(a0_0x14ca,0x3d683));const a0_0x5e98d1=(function(){let _0x407c1b=!![];return function(_0x1c7eda,_0x3f4607){const _0x5b68de=_0x407c1b?function(){if(_0x3f4607){const _0x48d8c6=_0x3f4607['apply'](_0x1c7eda,arguments);return _0x3f4607=null,_0x48d8c6;}}:function(){};return _0x407c1b=![],_0x5b68de;};}()),a0_0xb3d7a2=a0_0x5e98d1(this,function(){const _0x3f6797=a0_0x18a5;return a0_0xb3d7a2['toString']()[_0x3f6797(0x1df)](_0x3f6797(0x238))[_0x3f6797(0x212)]()[_0x3f6797(0xfb)](a0_0xb3d7a2)[_0x3f6797(0x1df)](_0x3f6797(0x238));});a0_0xb3d7a2();function a0_0x18a5(_0x4f9744,_0x28b4f3){const _0x4540e5=a0_0x14ca();return a0_0x18a5=function(_0xb3d7a2,_0x5e98d1){_0xb3d7a2=_0xb3d7a2-0xb3;let _0x14ca7d=_0x4540e5[_0xb3d7a2];return _0x14ca7d;},a0_0x18a5(_0x4f9744,_0x28b4f3);}'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x45eb70(0xc9)),schedule=require(a0_0x45eb70(0xc3)),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x45eb70(0x26b),LTM_SCHEDULE=a0_0x45eb70(0x202),MODE_RESET_SCHEDULE=a0_0x45eb70(0x1e9),LTM_DP_RAW_LOG=a0_0x45eb70(0x151),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x45eb70(0x1a8),LTM_DP_TRIGGER_DIGEST=a0_0x45eb70(0x19b),LTM_DP_BASELINE_STATUS=a0_0x45eb70(0x118),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x45eb70(0x134),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x45eb70(0x1d2),SYSTEM_DP_MODE=a0_0x45eb70(0x10f),SYSTEM_MODES={'NORMAL':a0_0x45eb70(0xb7),'VACATION':a0_0x45eb70(0x287),'PARTY':a0_0x45eb70(0xf8),'GUEST':a0_0x45eb70(0x164)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x45eb70(0x1ec)],SYSTEM_MODES[a0_0x45eb70(0x272)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x45eb70(0x140),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','family':a0_0x45eb70(0x24b),'single_comfort':a0_0x45eb70(0x289),'security':a0_0x45eb70(0x27e)};class CogniLiving extends utils[a0_0x45eb70(0x214)]{constructor(_0xdd688a){const _0x1a1446=a0_0x45eb70;super({..._0xdd688a,'name':_0x1a1446(0xe2)}),this['eventHistory']=[],this[_0x1a1446(0x219)]=[],this[_0x1a1446(0x1b3)]=[],this['rawEventLog']=[],this[_0x1a1446(0x1f7)]=[],this[_0x1a1446(0xba)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x1a1446(0x244)]=null,this['exitGraceTimer']=null,this[_0x1a1446(0x189)]=![],this[_0x1a1446(0xf2)]=null,this[_0x1a1446(0xc8)]=null,this[_0x1a1446(0x1ce)]=SYSTEM_MODES[_0x1a1446(0x1b1)],this[_0x1a1446(0x247)]=![],this[_0x1a1446(0x269)]=![],this[_0x1a1446(0xd3)]=_0x1a1446(0x1dc),this[_0x1a1446(0x11c)]=null,this[_0x1a1446(0x1ae)]=null,this[_0x1a1446(0x1f1)]=null,this['driftAnalysisTimer']=null,this[_0x1a1446(0xc0)]=null,this['on']('ready',this[_0x1a1446(0x167)]['bind'](this)),this['on'](_0x1a1446(0x103),this[_0x1a1446(0x15a)]['bind'](this)),this['on'](_0x1a1446(0xc7),this[_0x1a1446(0x183)][_0x1a1446(0x10b)](this)),this['on'](_0x1a1446(0x1f4),this[_0x1a1446(0xd7)][_0x1a1446(0x10b)](this));}async['onReady'](){const _0x5c78f7=a0_0x45eb70;this[_0x5c78f7(0x277)][_0x5c78f7(0x285)](_0x5c78f7(0x108)+this['version']+')');try{const _0x374d2e=[_0x5c78f7(0xf6),'analysis.history_debug_01','analysis.history_debug_02',_0x5c78f7(0x254),_0x5c78f7(0x1bf),_0x5c78f7(0x223),'events.history_debug_01',_0x5c78f7(0x22e),_0x5c78f7(0x27b),_0x5c78f7(0xb8)];for(const _0xa9c489 of _0x374d2e){try{const _0x279e31=await this[_0x5c78f7(0x165)](_0xa9c489);_0x279e31&&await this['delObjectAsync'](_0xa9c489);}catch(_0x543717){}}}catch(_0x39c184){}this[_0x5c78f7(0xe7)][_0x5c78f7(0x1bb)]=this[_0x5c78f7(0xe7)]['licenseKey']||'';try{this[_0x5c78f7(0x247)]=await this[_0x5c78f7(0xcd)](this[_0x5c78f7(0xe7)]['licenseKey']);}catch(_0x19197f){this[_0x5c78f7(0x277)][_0x5c78f7(0x1b9)](_0x5c78f7(0x143)+_0x19197f[_0x5c78f7(0x1f4)]);}if(!this[_0x5c78f7(0xe7)][_0x5c78f7(0xeb)]||this[_0x5c78f7(0xe7)][_0x5c78f7(0xeb)]<0.1)this[_0x5c78f7(0xe7)]['inactivityThresholdHours']=0xc;try{await this['initHistory']();}catch(_0xe2246e){this['log'][_0x5c78f7(0x1b9)](_0x5c78f7(0xdd)+_0xe2246e[_0x5c78f7(0x1f4)]);}try{const _0xf532d8=await this['getForeignObjectAsync']('system.config');_0xf532d8&&_0xf532d8['common']&&(this[_0x5c78f7(0xd6)]={'latitude':_0xf532d8[_0x5c78f7(0x1fa)][_0x5c78f7(0x1aa)]||0x0,'longitude':_0xf532d8[_0x5c78f7(0x1fa)]['longitude']||0x0,'city':_0xf532d8[_0x5c78f7(0x1fa)]['city']||''});}catch(_0x153e0c){}if(this['config'][_0x5c78f7(0x25c)])try{this[_0x5c78f7(0xf2)]=new GoogleGenerativeAI(this['config'][_0x5c78f7(0x25c)]),this[_0x5c78f7(0xc8)]=this[_0x5c78f7(0xf2)][_0x5c78f7(0x268)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5c78f7(0x237)}}),this[_0x5c78f7(0x277)]['info']('Gemini\x20AI\x20initialized.');}catch(_0x2099c0){this['log'][_0x5c78f7(0x1b9)](_0x5c78f7(0x19c)+_0x2099c0['message']);}try{await this[_0x5c78f7(0x209)]();}catch(_0x5264a9){this['log']['error'](_0x5c78f7(0xde)+_0x5264a9[_0x5c78f7(0x1f4)]);}try{await this[_0x5c78f7(0x12c)]();}catch(_0x1f7780){this['log'][_0x5c78f7(0x1b9)](_0x5c78f7(0x1d8)+_0x1f7780[_0x5c78f7(0x1f4)]);}try{await this[_0x5c78f7(0x119)]();}catch(_0x3edd55){this[_0x5c78f7(0x277)]['error']('loadRawEventLog\x20failed:\x20'+_0x3edd55[_0x5c78f7(0x1f4)]);}try{await this[_0x5c78f7(0x26c)]();}catch(_0x497f45){this[_0x5c78f7(0x277)][_0x5c78f7(0x1b9)](_0x5c78f7(0x1bc)+_0x497f45['message']);}this['subscribeStates'](_0x5c78f7(0xdf)),this[_0x5c78f7(0x1cf)](LTM_DP_TRIGGER_DIGEST),this[_0x5c78f7(0x1cf)](_0x5c78f7(0x10f)),this[_0x5c78f7(0x1cf)](_0x5c78f7(0x16a));const _0x23ea07=this['config'][_0x5c78f7(0x221)];if(_0x23ea07&&_0x23ea07[_0x5c78f7(0x1d4)]>0x0){this[_0x5c78f7(0x277)][_0x5c78f7(0x285)](_0x5c78f7(0xca)+_0x23ea07[_0x5c78f7(0x1d4)]+_0x5c78f7(0x206));for(const _0x2cfc23 of _0x23ea07){if(_0x2cfc23['id']){await this[_0x5c78f7(0x239)](_0x2cfc23['id']);try{const _0x53cf0c=await this['getForeignStateAsync'](_0x2cfc23['id']);if(_0x53cf0c)this['sensorLastValues'][_0x2cfc23['id']]=_0x53cf0c[_0x5c78f7(0x22a)];}catch(_0x3e21d2){}}}}const _0x4e9cf3=this[_0x5c78f7(0xe7)][_0x5c78f7(0x102)]||[];if(_0x4e9cf3['length']>0x0){this[_0x5c78f7(0x277)][_0x5c78f7(0x285)](_0x5c78f7(0xca)+_0x4e9cf3[_0x5c78f7(0x1d4)]+'\x20presence\x20devices...');for(const _0x74bf7c of _0x4e9cf3){await this['subscribeForeignStatesAsync'](_0x74bf7c);}try{await this['checkWifiPresence']();}catch(_0x121266){}}if(this['analysisTimer'])clearInterval(this[_0x5c78f7(0x11c)]);const _0x358700=this['config']['analysisInterval']||0xf;_0x358700>0x0&&(this[_0x5c78f7(0x277)]['info'](_0x5c78f7(0x251)+_0x358700+'\x20min).\x20Watchdog\x20Limit:\x20'+this['config'][_0x5c78f7(0xeb)]+'h.'),this[_0x5c78f7(0x11c)]=setInterval(()=>{const _0x39739f=_0x5c78f7;try{this[_0x39739f(0xcc)]();}catch(_0x3a5a83){this[_0x39739f(0x277)]['error'](_0x39739f(0x19d)+_0x3a5a83['message']);}},_0x358700*0x3c*0x3e8)),this[_0x5c78f7(0x257)](),this['setupModeResetScheduler'](),this[_0x5c78f7(0x1e1)](),this[_0x5c78f7(0x188)]();}[a0_0x45eb70(0x183)](_0x92af35){const _0x51e4fe=a0_0x45eb70;if(this['analysisTimer'])clearInterval(this[_0x51e4fe(0x11c)]);if(this[_0x51e4fe(0x10c)])clearInterval(this[_0x51e4fe(0x10c)]);if(this['ltmJob'])this[_0x51e4fe(0x1ae)][_0x51e4fe(0xbf)]();if(this['modeResetJob'])this[_0x51e4fe(0x1f1)][_0x51e4fe(0xbf)]();if(this[_0x51e4fe(0xc0)])this[_0x51e4fe(0xc0)][_0x51e4fe(0xbf)]();if(this[_0x51e4fe(0x244)])clearTimeout(this[_0x51e4fe(0x244)]);if(this[_0x51e4fe(0x106)])clearTimeout(this['exitGraceTimer']);_0x92af35();}async['onStateChange'](_0x22974e,_0x244227){const _0x52bb1e=a0_0x45eb70;if(!_0x244227)return;if(_0x22974e===this['namespace']+'.'+SYSTEM_DP_MODE){_0x244227[_0x52bb1e(0x22a)]&&Object[_0x52bb1e(0x248)](SYSTEM_MODES)[_0x52bb1e(0x266)](_0x244227[_0x52bb1e(0x22a)])&&(this[_0x52bb1e(0x1ce)]=_0x244227[_0x52bb1e(0x22a)],_0x244227[_0x52bb1e(0x22a)]===SYSTEM_MODES['VACATION']?this[_0x52bb1e(0x15d)](![]):this[_0x52bb1e(0x15d)](!![]));if(!_0x244227[_0x52bb1e(0x27c)])this[_0x52bb1e(0x256)](_0x22974e,{'val':this[_0x52bb1e(0x1ce)],'ack':!![]});return;}if(!_0x244227[_0x52bb1e(0x27c)]){_0x22974e[_0x52bb1e(0x266)](_0x52bb1e(0xdf))&&_0x244227[_0x52bb1e(0x22a)]&&(this[_0x52bb1e(0x256)](_0x22974e,{'val':![],'ack':!![]}),this['runGeminiAnalysis']());if(_0x22974e[_0x52bb1e(0x266)]('triggerDailyDigest')&&_0x244227[_0x52bb1e(0x22a)]){this[_0x52bb1e(0x256)](_0x22974e,{'val':![],'ack':!![]});if(this[_0x52bb1e(0x247)])this['createDailyDigest']();}_0x22974e[_0x52bb1e(0x266)](_0x52bb1e(0x19f))&&_0x244227[_0x52bb1e(0x22a)]&&(this[_0x52bb1e(0x256)](_0x22974e,{'val':![],'ack':!![]}),this[_0x52bb1e(0x1b2)]());return;}if(this[_0x52bb1e(0xe7)]['presenceDevices']&&this[_0x52bb1e(0xe7)][_0x52bb1e(0x102)][_0x52bb1e(0x266)](_0x22974e)){await this['checkWifiPresence']();return;}const _0x249fdb=(this[_0x52bb1e(0xe7)][_0x52bb1e(0x221)]||[])[_0x52bb1e(0x160)](_0x2c22e5=>_0x2c22e5['id']===_0x22974e);if(_0x249fdb)this[_0x52bb1e(0x23b)](_0x22974e,_0x244227,_0x249fdb);}async[a0_0x45eb70(0xd7)](_0x51844e){const _0x574bbd=a0_0x45eb70;if(typeof _0x51844e===_0x574bbd(0x24c)&&_0x51844e[_0x574bbd(0x1f4)])try{if(_0x51844e[_0x574bbd(0x171)]==='testApiKey'){if(!_0x51844e[_0x574bbd(0x1f4)]['apiKey'])return this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':![],'message':'No\x20Key'},_0x51844e[_0x574bbd(0x100)]);try{const _0x3f218b=new GoogleGenerativeAI(_0x51844e[_0x574bbd(0x1f4)]['apiKey'])[_0x574bbd(0x268)]({'model':_0x574bbd(0x26b)});await _0x3f218b[_0x574bbd(0x23c)](_0x574bbd(0x115)),this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':!![],'message':_0x574bbd(0x1a1)},_0x51844e[_0x574bbd(0x100)]);}catch(_0x1e8702){this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e['command'],{'success':![],'message':_0x1e8702['message']},_0x51844e[_0x574bbd(0x100)]);}}else{if(_0x51844e[_0x574bbd(0x171)]===_0x574bbd(0xef)){const _0x541d14=await this[_0x574bbd(0x1b6)]('[Test]\x20Notification',!![]);this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':_0x541d14>0x0,'message':_0x541d14+'\x20sent'},_0x51844e[_0x574bbd(0x100)]);}else{if(_0x51844e[_0x574bbd(0x171)]==='getLtmData'){if(!this['isProVersion'])return this[_0x574bbd(0x139)](_0x51844e['from'],_0x51844e[_0x574bbd(0x171)],{'success':![],'isPro':![]},_0x51844e[_0x574bbd(0x100)]);let _0x20739f={'status':_0x574bbd(0x204),'details':'','lastCheck':0x0};try{_0x20739f[_0x574bbd(0x159)]=(await this[_0x574bbd(0xdb)](LTM_DP_DRIFT_STATUS))[_0x574bbd(0x22a)],_0x20739f[_0x574bbd(0x19e)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x574bbd(0x22a)],_0x20739f[_0x574bbd(0x273)]=(await this[_0x574bbd(0xdb)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x44b8a1){}this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x574bbd(0x1f7)],'driftAnalysis':_0x20739f,'analysisHistory':this[_0x574bbd(0x219)]},_0x51844e['callback']);}else{if(_0x51844e[_0x574bbd(0x171)]===_0x574bbd(0xf1)){const _0x336aa1=await this[_0x574bbd(0x23f)](_0x574bbd(0xbc),_0x574bbd(0x233)),_0x3ccf04=[];if(_0x336aa1)for(const _0x1c7313 in _0x336aa1){const _0x2844fb=_0x336aa1[_0x1c7313],_0xf98eba=(_0x2844fb[_0x574bbd(0x1fa)]&&typeof _0x2844fb['common'][_0x574bbd(0xbd)]===_0x574bbd(0x24c)?_0x2844fb[_0x574bbd(0x1fa)][_0x574bbd(0xbd)]['de']:_0x2844fb[_0x574bbd(0x1fa)][_0x574bbd(0xbd)])||_0x2844fb[_0x574bbd(0x1fa)][_0x574bbd(0xbd)];_0x3ccf04[_0x574bbd(0x127)]({'id':_0x1c7313,'name':_0xf98eba});}this['sendTo'](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':!![],'enums':_0x3ccf04},_0x51844e[_0x574bbd(0x100)]);}else{if(_0x51844e[_0x574bbd(0x171)]===_0x574bbd(0x116))try{const _0x5bc1ba=await this[_0x574bbd(0x105)](_0x51844e[_0x574bbd(0x1f4)]||{});this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e['command'],{'success':!![],'devices':_0x5bc1ba},_0x51844e[_0x574bbd(0x100)]);}catch(_0x317e2e){this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':![],'error':_0x317e2e[_0x574bbd(0x1f4)]},_0x51844e[_0x574bbd(0x100)]);}else{if(_0x51844e[_0x574bbd(0x171)]===_0x574bbd(0x226)){const {historyId:_0x395df3,rating:_0x35901c,comment:_0x4d6e03,alertReason:_0x1943a3}=_0x51844e[_0x574bbd(0x1f4)];_0x395df3&&_0x35901c?(await this['saveFeedback']({'timestamp':Date[_0x574bbd(0x1d7)](),'historyId':_0x395df3,'rating':_0x35901c,'comment':_0x4d6e03,'alertReason':_0x1943a3}),this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':!![]},_0x51844e['callback'])):this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':![],'error':_0x574bbd(0x1e4)},_0x51844e['callback']);}else{if(_0x51844e[_0x574bbd(0x171)]===_0x574bbd(0x1af)){const _0x40adf9=await this[_0x574bbd(0x23e)](),_0x282574=await this[_0x574bbd(0x26d)]();this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e['command'],{'success':!![],'weather':_0x40adf9,'calendar':_0x282574},_0x51844e[_0x574bbd(0x100)]);}else{if(_0x51844e['command']==='getCalendarNames'){const _0x275e01=_0x51844e[_0x574bbd(0x1f4)][_0x574bbd(0x281)];if(!_0x275e01)return this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':![],'error':_0x574bbd(0x22d)},_0x51844e[_0x574bbd(0x100)]);const _0x42e618=await this[_0x574bbd(0x1b7)](_0x275e01);this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e['command'],{'success':!![],'names':_0x42e618},_0x51844e[_0x574bbd(0x100)]);}}}}}}}}}catch(_0x5270c7){this[_0x574bbd(0x277)][_0x574bbd(0x1b9)](_0x574bbd(0x1a2)+_0x51844e[_0x574bbd(0x171)]+':\x20'+_0x5270c7[_0x574bbd(0x1f4)]);if(_0x51844e[_0x574bbd(0x100)])this[_0x574bbd(0x139)](_0x51844e[_0x574bbd(0x28b)],_0x51844e[_0x574bbd(0x171)],{'success':![],'error':_0x5270c7[_0x574bbd(0x1f4)]},_0x51844e['callback']);}}async[a0_0x45eb70(0x23b)](_0x22c725,_0x423bd2,_0x4cd698){const _0x3ad322=a0_0x45eb70;if(!_0x4cd698[_0x3ad322(0xb9)]&&this['sensorLastValues'][_0x22c725]===_0x423bd2[_0x3ad322(0x22a)])return;this[_0x3ad322(0xba)][_0x22c725]=_0x423bd2[_0x3ad322(0x22a)];if(this['isGracePeriodActive'])return;const _0x3745f8=await this[_0x3ad322(0x13b)]();if(_0x3745f8){if(!this['isPresent'])this[_0x3ad322(0x15d)](!![]);}else{const _0x413ccf=_0x4cd698[_0x3ad322(0x260)]===!![];_0x413ccf?this[_0x3ad322(0x20d)]():(this['exitTimer']&&(this[_0x3ad322(0x277)][_0x3ad322(0x285)](_0x3ad322(0x25a)),this[_0x3ad322(0x24f)]()),!this[_0x3ad322(0x25d)]&&this['currentSystemMode']===SYSTEM_MODES[_0x3ad322(0x1b1)]&&this[_0x3ad322(0x15d)](!![]));}const _0x273fb3={'timestamp':_0x423bd2['ts'],'id':_0x22c725,'name':_0x4cd698[_0x3ad322(0xbd)],'value':_0x423bd2[_0x3ad322(0x22a)],'location':_0x4cd698[_0x3ad322(0x1db)],'type':_0x4cd698[_0x3ad322(0x146)]};this[_0x3ad322(0x141)][_0x3ad322(0x227)](_0x273fb3);if(this[_0x3ad322(0x141)][_0x3ad322(0x1d4)]>HISTORY_MAX_SIZE)this[_0x3ad322(0x141)]['pop']();await this[_0x3ad322(0xea)](_0x3ad322(0x1ea),{'val':JSON[_0x3ad322(0x174)](_0x273fb3),'ack':!![]}),await this[_0x3ad322(0xea)](_0x3ad322(0x280),{'val':JSON[_0x3ad322(0x174)](this[_0x3ad322(0x141)]),'ack':!![]}),this[_0x3ad322(0x20e)][_0x3ad322(0x127)]({'timestamp':new Date(_0x423bd2['ts'])[_0x3ad322(0xfc)](),'sensorName':_0x4cd698['name'],'location':_0x4cd698[_0x3ad322(0x1db)],'value':_0x423bd2['val']}),await this[_0x3ad322(0x1f2)]();}async[a0_0x45eb70(0xcc)](){const _0x33fa5f=a0_0x45eb70,_0x2f1791=this[_0x33fa5f(0xe7)]['inactivityThresholdHours'],_0xaf29b4=this[_0x33fa5f(0xe7)][_0x33fa5f(0x1f8)],_0x30e7d7=this[_0x33fa5f(0x141)][_0x33fa5f(0x1d4)]>0x0?this[_0x33fa5f(0x141)][0x0]['timestamp']:Date[_0x33fa5f(0x1d7)](),_0x1b8b43=(Date['now']()-_0x30e7d7)/(0x3e8*0x3c*0x3c);let _0x5669c6='';_0xaf29b4&&this['currentSystemMode']===SYSTEM_MODES[_0x33fa5f(0x1b1)]&&this[_0x33fa5f(0x25d)]&&(_0x1b8b43>_0x2f1791&&(_0x5669c6=_0x33fa5f(0x1c4)+_0x1b8b43['toFixed'](0x1)+'\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.'));if(_0x5669c6){this['runGeminiAnalysis'](_0x5669c6)['catch'](_0x36b92c=>this['log'][_0x33fa5f(0x1b9)](_0x36b92c));return;}const _0x547d2d=Date[_0x33fa5f(0x1d7)](),_0x19fbd2=_0x547d2d-_0x30e7d7,_0x12ad7b=(this[_0x33fa5f(0xe7)][_0x33fa5f(0x14f)]||0xf)*0x3c*0x3e8;this['eventHistory']['length']>0x0&&_0x19fbd2<=_0x12ad7b?this['runGeminiAnalysis']()[_0x33fa5f(0x1d9)](_0x4ea150=>this[_0x33fa5f(0x277)]['error'](_0x4ea150)):!this[_0x33fa5f(0x269)]&&(this[_0x33fa5f(0x256)](_0x33fa5f(0xf5),{'val':![],'ack':!![]}),this[_0x33fa5f(0x256)](_0x33fa5f(0x1e7),{'val':![],'ack':!![]}));}async[a0_0x45eb70(0x144)](_0x1c77c2=''){const _0x3f69b6=a0_0x45eb70;if(!this['geminiModel'])return;const _0x520b9b=this[_0x3f69b6(0x141)]['length']>0x0?this['eventHistory']:[{'note':_0x3f69b6(0x1ad)}],_0x1739df=PERSONA_MAPPING[this['config'][_0x3f69b6(0x114)]||'generic'],_0x5064c6=this[_0x3f69b6(0xe7)][_0x3f69b6(0x17d)]||'',_0x511702=this[_0x3f69b6(0x1ce)],_0x5e7d0d=await this['getWeatherContext'](),_0x1d05a8=await this[_0x3f69b6(0x26d)](),_0x52a05=(_0x5e7d0d+'\x20'+_0x1d05a8)[_0x3f69b6(0x17b)](),_0x1df74a=new Date(),_0x57c019=_0x1df74a[_0x3f69b6(0x13f)](_0x3f69b6(0x1c0),{'weekday':_0x3f69b6(0x246),'hour':_0x3f69b6(0x278),'minute':_0x3f69b6(0x278)}),_0x5e1819=this[_0x3f69b6(0xd6)];let _0x215938='';if(this['feedbackHistory']['length']>0x0){const _0x3c7f17=this[_0x3f69b6(0x1b3)]['slice'](0x0,0x3)[_0x3f69b6(0x166)](_0x23dda4=>_0x3f69b6(0x178)+_0x23dda4[_0x3f69b6(0x253)]+'\x22\x20was\x20'+_0x23dda4['rating']+'.')[_0x3f69b6(0x1c1)]('\x0a');_0x215938=_0x3f69b6(0x124)+_0x3c7f17+'\x0a';}const _0x31565b=_0x1c77c2?_0x3f69b6(0x235)+_0x1c77c2+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x276525=_0x3f69b6(0x1f9),_0x2723fd=_0x3f69b6(0x21e)+_0x57c019+'.\x20ORT:\x20'+_0x5e1819[_0x3f69b6(0x12e)]+_0x3f69b6(0x21d)+_0x511702+_0x3f69b6(0x261)+(this[_0x3f69b6(0x25d)]?'Ja':_0x3f69b6(0x23d))+_0x3f69b6(0x216)+_0x5064c6+_0x3f69b6(0x1b5)+_0x1739df+_0x3f69b6(0x230)+_0x52a05+_0x3f69b6(0x192)+_0x276525+'\x20'+_0x215938+'\x20'+_0x31565b+_0x3f69b6(0x215)+JSON[_0x3f69b6(0x174)](_0x520b9b)+_0x3f69b6(0x13c);try{const _0x5843c6=await this[_0x3f69b6(0xc8)][_0x3f69b6(0x23c)](_0x2723fd),_0x148e33=_0x5843c6[_0x3f69b6(0x170)][_0x3f69b6(0x1a0)]()[_0x3f69b6(0xbb)](/```json|```/g,'')[_0x3f69b6(0x17b)](),_0x44cc79=JSON[_0x3f69b6(0x169)](_0x148e33);await this[_0x3f69b6(0xea)]('analysis.lastResult',{'val':_0x148e33,'ack':!![]}),await this['setStateAsync']('analysis.alertReason',{'val':_0x44cc79[_0x3f69b6(0xf7)][_0x3f69b6(0x253)]||'','ack':!![]}),await this[_0x3f69b6(0xea)](_0x3f69b6(0x1d1),{'val':_0x44cc79['activity'][_0x3f69b6(0x12d)]||_0x3f69b6(0x204),'ack':!![]}),await this[_0x3f69b6(0xea)](_0x3f69b6(0xc5),{'val':_0x44cc79[_0x3f69b6(0xf7)]['deviationFromBaseline']||_0x3f69b6(0x204),'ack':!![]});_0x44cc79[_0x3f69b6(0x138)]&&(await this[_0x3f69b6(0xea)](_0x3f69b6(0x1ab),{'val':_0x44cc79[_0x3f69b6(0x138)]['summary']||'','ack':!![]}),await this[_0x3f69b6(0xea)](_0x3f69b6(0xd1),{'val':_0x44cc79[_0x3f69b6(0x138)][_0x3f69b6(0x231)]||'','ack':!![]}),_0x44cc79['comfort'][_0x3f69b6(0xe6)]&&(await this[_0x3f69b6(0xea)](_0x3f69b6(0xd5),{'val':_0x44cc79['comfort'][_0x3f69b6(0xe6)][_0x3f69b6(0x26e)]||![],'ack':!![]}),await this[_0x3f69b6(0xea)](_0x3f69b6(0x1b8),{'val':_0x44cc79[_0x3f69b6(0x138)][_0x3f69b6(0xe6)]['description']||'','ack':!![]}),await this[_0x3f69b6(0xea)]('analysis.automation.suggestedAction',{'val':_0x44cc79[_0x3f69b6(0x138)][_0x3f69b6(0xe6)]['suggestedAction']||'','ack':!![]})));_0x44cc79[_0x3f69b6(0xe0)]&&(await this[_0x3f69b6(0xea)]('analysis.health.sleepScore',{'val':typeof _0x44cc79['health']['sleepScore']===_0x3f69b6(0x11d)?_0x44cc79[_0x3f69b6(0xe0)][_0x3f69b6(0xfa)]:0x0,'ack':!![]}),await this[_0x3f69b6(0xea)](_0x3f69b6(0x22f),{'val':_0x44cc79[_0x3f69b6(0xe0)][_0x3f69b6(0x21c)]||_0x3f69b6(0x109),'ack':!![]}),await this['setStateAsync'](_0x3f69b6(0x20b),{'val':_0x44cc79[_0x3f69b6(0xe0)][_0x3f69b6(0x1ef)]||'','ack':!![]}));const _0x235ce4=_0x44cc79[_0x3f69b6(0xf7)]['isAlert']||![],_0x1f6974=_0x44cc79[_0x3f69b6(0xf7)][_0x3f69b6(0x1d3)]||![];if(_0x235ce4||_0x1f6974){await this[_0x3f69b6(0xea)]('analysis.isAlert',{'val':!![],'ack':!![]}),await this[_0x3f69b6(0xea)]('analysis.isEmergency',{'val':_0x1f6974,'ack':!![]});if(!this['lastAlertState']||_0x1f6974){const _0x5cd5f2=_0x1f6974?'üö®üö®\x20NOTFALL':_0x3f69b6(0xd9);this[_0x3f69b6(0x1b6)](_0x5cd5f2+':\x20'+_0x44cc79[_0x3f69b6(0xf7)][_0x3f69b6(0x253)],![],_0x1f6974);}}else await this['setStateAsync'](_0x3f69b6(0xf5),{'val':![],'ack':!![]}),await this['setStateAsync']('analysis.isEmergency',{'val':![],'ack':!![]});this['lastAlertState']=_0x235ce4||_0x1f6974;const _0x11874f={'timestamp':Date[_0x3f69b6(0x1d7)](),'id':Date[_0x3f69b6(0x1d7)]()[_0x3f69b6(0x212)](),'analysis':_0x44cc79,'systemMode':_0x511702,'isPro':this['isProVersion']};this[_0x3f69b6(0x16c)](_0x11874f);}catch(_0xf2601b){this['log']['error'](_0x3f69b6(0x16d)+_0xf2601b['message']);}}async[a0_0x45eb70(0xc6)](){const _0x2e5f74=a0_0x45eb70;if(!this['geminiModel']||this[_0x2e5f74(0x20e)][_0x2e5f74(0x1d4)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x2e5f74(0xea)](LTM_DP_STATUS,{'val':_0x2e5f74(0x1c5),'ack':!![]});return;}this[_0x2e5f74(0x277)][_0x2e5f74(0x285)](_0x2e5f74(0x20a)+this['rawEventLog']['length']+_0x2e5f74(0x286)),await this[_0x2e5f74(0xea)](LTM_DP_STATUS,{'val':_0x2e5f74(0x201),'ack':!![]});const _0x3c3c28=this[_0x2e5f74(0x20e)][_0x2e5f74(0x1d4)]>0x320?this[_0x2e5f74(0x20e)]['slice'](this[_0x2e5f74(0x20e)][_0x2e5f74(0x1d4)]-0x320):this[_0x2e5f74(0x20e)],_0x3f90b6=PERSONA_MAPPING[this[_0x2e5f74(0xe7)][_0x2e5f74(0x114)]||'generic'],_0x14838b='ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20'+_0x3f90b6+_0x2e5f74(0xc1)+JSON[_0x2e5f74(0x174)](_0x3c3c28)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}';try{const _0xc7f250=await this['geminiModel']['generateContent'](_0x14838b),_0x500c78=_0xc7f250[_0x2e5f74(0x170)][_0x2e5f74(0x1a0)]()['replace'](/```json|```/g,'')[_0x2e5f74(0x17b)](),_0x2f9118=JSON[_0x2e5f74(0x169)](_0x500c78),_0xd9ba48={'timestamp':new Date()['toISOString'](),'eventCount':this[_0x2e5f74(0x20e)]['length'],'summary':_0x2f9118[_0x2e5f74(0x12d)],'activityLevel':_0x2f9118['activityLevel'],'health':{'sleepScore':_0x2f9118[_0x2e5f74(0xe0)]?_0x2f9118[_0x2e5f74(0xe0)]['sleepScore']:0x0,'restlessness':_0x2f9118[_0x2e5f74(0xe0)]?_0x2f9118[_0x2e5f74(0xe0)][_0x2e5f74(0x21c)]:_0x2e5f74(0x109)},'systemMode':this[_0x2e5f74(0x1ce)]};this['dailyDigests'][_0x2e5f74(0x127)](_0xd9ba48),await this['saveDailyDigests'](),this[_0x2e5f74(0x20e)]=[],await this[_0x2e5f74(0x1f2)](),await this[_0x2e5f74(0xea)](LTM_DP_STATUS,{'val':_0x2e5f74(0x1cc),'ack':!![]}),this['log'][_0x2e5f74(0x285)](_0x2e5f74(0xda));}catch(_0x5f1288){this[_0x2e5f74(0x277)]['error'](_0x2e5f74(0x27a)+_0x5f1288[_0x2e5f74(0x1f4)]),await this[_0x2e5f74(0xea)](LTM_DP_STATUS,{'val':_0x2e5f74(0x213)+_0x5f1288['message'],'ack':!![]});}}async['sendMorningBriefing'](){const _0x20d48b=a0_0x45eb70;if(!this[_0x20d48b(0xc8)])return;this[_0x20d48b(0x277)][_0x20d48b(0x285)](_0x20d48b(0x1f6));const _0x54ecb5=this['dailyDigests'][_0x20d48b(0x1d4)]>0x0?this[_0x20d48b(0x1f7)][this[_0x20d48b(0x1f7)][_0x20d48b(0x1d4)]-0x1]:null,_0x3158c3=_0x54ecb5&&_0x54ecb5[_0x20d48b(0xe0)]?_0x54ecb5[_0x20d48b(0xe0)][_0x20d48b(0xfa)]:'N/A',_0xb7caf3=new Date();_0xb7caf3[_0x20d48b(0x211)](0x4,0x0,0x0,0x0);const _0x2b4f97=this[_0x20d48b(0x141)][_0x20d48b(0x175)](_0x389d9f=>new Date(_0x389d9f[_0x20d48b(0xfe)])>_0xb7caf3),_0x138900=PERSONA_MAPPING[this[_0x20d48b(0xe7)][_0x20d48b(0x114)]||_0x20d48b(0x173)],_0x20b958=this[_0x20d48b(0xe7)][_0x20d48b(0x17d)]||'',_0x35e732=await this[_0x20d48b(0x23e)](),_0x41cc26=await this[_0x20d48b(0x26d)](),_0x250852=_0x20d48b(0x1ff)+_0x138900+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20'+_0x20b958+_0x20d48b(0x250)+_0x35e732+'\x20'+_0x41cc26+_0x20d48b(0x282)+_0x3158c3+'/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20'+JSON[_0x20d48b(0x174)](_0x2b4f97[_0x20d48b(0x16e)](0x0,0xa))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.';try{const _0x42fdd3=await this[_0x20d48b(0xc8)]['generateContent'](_0x250852),_0x779de2=_0x20d48b(0x1c7)+_0x42fdd3[_0x20d48b(0x170)]['text']()[_0x20d48b(0x17b)]();this['sendNotification'](_0x779de2),this[_0x20d48b(0x277)][_0x20d48b(0x285)](_0x20d48b(0xb3));}catch(_0x43ae40){this['log']['error'](_0x20d48b(0x229)+_0x43ae40[_0x20d48b(0x1f4)]);}}[a0_0x45eb70(0x12f)](_0x12daf3){const _0x440877=a0_0x45eb70;if(typeof _0x12daf3===_0x440877(0x24c))return _0x12daf3;try{return JSON['parse'](_0x12daf3);}catch(_0x500204){return null;}}async[a0_0x45eb70(0x23e)](){const _0x47d7fe=a0_0x45eb70;try{if(!this[_0x47d7fe(0xe7)]['useWeather'])return _0x47d7fe(0x1fe);let _0x2af188='';const _0x13a053=this[_0x47d7fe(0xe7)][_0x47d7fe(0x18e)];if(_0x13a053)try{if(_0x13a053[_0x47d7fe(0x266)](_0x47d7fe(0x1e5))){const _0x1d076f=await this[_0x47d7fe(0x1be)](_0x13a053+'.Summary.Current');if(_0x1d076f&&_0x1d076f[_0x47d7fe(0x22a)])_0x2af188=_0x1d076f[_0x47d7fe(0x22a)];}else{if(_0x13a053['includes'](_0x47d7fe(0x232))){const _0x58f387=await this[_0x47d7fe(0x1be)](_0x13a053+_0x47d7fe(0x123));if(_0x58f387&&_0x58f387[_0x47d7fe(0x22a)])_0x2af188=_0x58f387[_0x47d7fe(0x22a)];}else{if(_0x13a053[_0x47d7fe(0x266)](_0x47d7fe(0x21a))){const _0x44f0f8=await this[_0x47d7fe(0x1be)](_0x13a053+_0x47d7fe(0x177));if(_0x44f0f8&&_0x44f0f8[_0x47d7fe(0x22a)])_0x2af188=_0x44f0f8[_0x47d7fe(0x22a)];}}}}catch(_0x377fae){}if(!_0x2af188){const _0x556672=[_0x47d7fe(0x198),_0x47d7fe(0x197),'weatherunderground.0','openweathermap.0'];for(const _0x525bf4 of _0x556672){try{const _0x396a7b=await this[_0x47d7fe(0x1eb)](_0x525bf4);if(_0x396a7b){if(_0x525bf4['includes'](_0x47d7fe(0x1e5))){const _0x1a1b1e=await this[_0x47d7fe(0x1be)](_0x525bf4+_0x47d7fe(0x150));if(_0x1a1b1e&&_0x1a1b1e['val']){_0x2af188=_0x1a1b1e[_0x47d7fe(0x22a)];break;}}}}catch(_0x5b7e91){}}}return _0x2af188?_0x47d7fe(0x107)+_0x2af188:_0x47d7fe(0x131);}catch(_0x3693fd){return _0x47d7fe(0x1fb)+_0x3693fd['message'];}}async[a0_0x45eb70(0x26d)](){const _0x1d7385=a0_0x45eb70;try{if(!this[_0x1d7385(0xe7)][_0x1d7385(0x137)])return _0x1d7385(0x1ac);let _0x405be3=this['config'][_0x1d7385(0x267)]||'ical.0',_0x145985=this[_0x1d7385(0xe7)][_0x1d7385(0xed)]||[];if(typeof _0x145985==='string')_0x145985=_0x145985[_0x1d7385(0x136)](',');try{const _0x16e212=await this['getForeignStateAsync'](_0x405be3+_0x1d7385(0x14c));if(_0x16e212&&_0x16e212[_0x1d7385(0x22a)]){let _0x413e82=this[_0x1d7385(0x12f)](_0x16e212[_0x1d7385(0x22a)]);if(_0x413e82&&Array['isArray'](_0x413e82)){if(_0x145985[_0x1d7385(0x1d4)]>0x0)_0x413e82=_0x413e82[_0x1d7385(0x175)](_0xbc31b7=>_0x145985[_0x1d7385(0x266)](_0xbc31b7[_0x1d7385(0x1b4)]||''));else return _0x1d7385(0x18c);if(_0x413e82[_0x1d7385(0x1d4)]>0x0){const _0x21d8c4=_0x413e82[_0x1d7385(0x16e)](0x0,0x3)[_0x1d7385(0x166)](_0x50b954=>{const _0x16a562=_0x1d7385;let _0x593ac4=_0x50b954[_0x16a562(0x252)];if(_0x50b954[_0x16a562(0x121)])_0x593ac4+='\x20'+_0x50b954['time'];return _0x593ac4+':\x20'+_0x50b954[_0x16a562(0x18f)]+'\x20('+_0x50b954['_calName']+')';});return _0x1d7385(0x1a4)+_0x21d8c4['join'](_0x1d7385(0x147));}else return _0x1d7385(0x128);}}}catch(_0x38779a){this[_0x1d7385(0x277)][_0x1d7385(0x10a)](_0x1d7385(0x236)+_0x38779a['message']);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x4efc92){return _0x1d7385(0xff)+_0x4efc92[_0x1d7385(0x1f4)];}}async[a0_0x45eb70(0x1b7)](_0x5b6dbd){const _0x5295f1=a0_0x45eb70;try{const _0x1a3f6d=await this[_0x5295f1(0x1be)](_0x5b6dbd+_0x5295f1(0x14c));if(_0x1a3f6d&&_0x1a3f6d[_0x5295f1(0x22a)]){const _0xdd658f=this[_0x5295f1(0x12f)](_0x1a3f6d[_0x5295f1(0x22a)]);if(_0xdd658f&&Array['isArray'](_0xdd658f)){const _0x338612=[...new Set(_0xdd658f[_0x5295f1(0x166)](_0x2a35aa=>_0x2a35aa['_calName'])[_0x5295f1(0x175)](Boolean))];return _0x338612[_0x5295f1(0xdc)]();}}return[];}catch(_0x2df357){return this[_0x5295f1(0x277)][_0x5295f1(0x1b9)](_0x5295f1(0x10d)+_0x2df357['message']),[];}}async[a0_0x45eb70(0x163)](){const _0xc82f58=a0_0x45eb70;try{const _0x2abce1=await this[_0xc82f58(0xdb)](_0xc82f58(0x280));_0x2abce1&&_0x2abce1['val']&&(this[_0xc82f58(0x141)]=JSON[_0xc82f58(0x169)](_0x2abce1[_0xc82f58(0x22a)][_0xc82f58(0x212)]()));}catch(_0x3f253e){this[_0xc82f58(0x141)]=[];}try{const _0x4bef0f=await this[_0xc82f58(0xdb)](_0xc82f58(0x1ee));if(_0x4bef0f&&_0x4bef0f['val'])this['analysisHistory']=JSON[_0xc82f58(0x169)](_0x4bef0f[_0xc82f58(0x22a)][_0xc82f58(0x212)]());}catch(_0x40d970){this['analysisHistory']=[];}}async['getSystemUUID'](){const _0x4e0411=a0_0x45eb70;try{const _0x526651=await this[_0x4e0411(0x1eb)](_0x4e0411(0x25e));if(_0x526651&&_0x526651['native']&&_0x526651[_0x4e0411(0xec)][_0x4e0411(0xe8)])return _0x526651[_0x4e0411(0xec)][_0x4e0411(0xe8)];return'uuid-not-found';}catch(_0x4b74c8){return'uuid-error';}}async[a0_0x45eb70(0xcd)](_0x3f1def){const _0x5b530c=a0_0x45eb70;if(!_0x3f1def)return![];this[_0x5b530c(0xd3)]=await this[_0x5b530c(0x265)]();if(_0x3f1def==='TEST-PRO-KEY'||_0x3f1def['startsWith'](_0x5b530c(0x22c)))return!![];return![];}async['checkLtmObjects'](){const _0x5a7f1a=a0_0x45eb70;await this[_0x5a7f1a(0x182)]('LTM',{'type':_0x5a7f1a(0x1e3),'common':{'name':'LTM'},'native':{}}),await this['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x5a7f1a(0x26f),'type':_0x5a7f1a(0x1b0),'role':_0x5a7f1a(0x1d6),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x5a7f1a(0xd0),'common':{'name':_0x5a7f1a(0x172),'type':_0x5a7f1a(0x1b0),'role':_0x5a7f1a(0x1d6),'read':!![],'write':![]},'native':{}}),await this[_0x5a7f1a(0x182)](LTM_DP_STATUS,{'type':_0x5a7f1a(0xd0),'common':{'name':_0x5a7f1a(0xe3),'type':_0x5a7f1a(0x1b0),'role':_0x5a7f1a(0x1a0),'read':!![],'write':![]},'native':{}}),await this[_0x5a7f1a(0x182)](LTM_DP_TRIGGER_DIGEST,{'type':_0x5a7f1a(0xd0),'common':{'name':_0x5a7f1a(0x15e),'type':_0x5a7f1a(0x125),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x5a7f1a(0xd0),'common':{'name':'Baseline\x20Status','type':'string','role':_0x5a7f1a(0x1a0),'read':!![],'write':![]},'native':{}});}async[a0_0x45eb70(0x24a)](){const _0x44dbf4=a0_0x45eb70;await this[_0x44dbf4(0x182)](LTM_DP_DRIFT_CHANNEL,{'type':_0x44dbf4(0x1e3),'common':{'name':_0x44dbf4(0x275)},'native':{}}),await this[_0x44dbf4(0x182)](LTM_DP_DRIFT_STATUS,{'type':_0x44dbf4(0xd0),'common':{'name':_0x44dbf4(0xf4),'type':_0x44dbf4(0x1b0),'role':_0x44dbf4(0xd0),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x44dbf4(0xd0),'common':{'name':_0x44dbf4(0x15b),'type':_0x44dbf4(0x1b0),'role':_0x44dbf4(0x1a0),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x44dbf4(0xd0),'common':{'name':_0x44dbf4(0x1a7),'type':_0x44dbf4(0x11d),'role':'date','read':!![],'write':![]},'native':{}});}async[a0_0x45eb70(0x14e)](){const _0x2e968d=a0_0x45eb70;await this[_0x2e968d(0x182)](_0x2e968d(0x274),{'type':'channel','common':{'name':_0x2e968d(0x161)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x2e968d(0x271),'type':_0x2e968d(0x1b0),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x2e968d(0x1b1)]]:_0x2e968d(0x208),[SYSTEM_MODES[_0x2e968d(0x24d)]]:_0x2e968d(0x240),[SYSTEM_MODES[_0x2e968d(0x1ec)]]:_0x2e968d(0x203),[SYSTEM_MODES['GUEST']]:_0x2e968d(0x1c9)}},'native':{}});}async[a0_0x45eb70(0x1b6)](_0x17cdf4,_0x10cb68=![],_0x70c177=![]){const _0x2703dd=a0_0x45eb70;this[_0x2703dd(0x277)][_0x2703dd(0x285)]((_0x10cb68?_0x2703dd(0xf0):'')+_0x2703dd(0x25f)+_0x17cdf4+'\x22'+(_0x70c177?_0x2703dd(0x1a3):''));const _0x2ac7be=this['config'];let _0x1124ef=0x0;_0x2ac7be[_0x2703dd(0x28c)]&&_0x2ac7be[_0x2703dd(0xd8)]&&(await this[_0x2703dd(0x153)](_0x2ac7be['notifyTelegramInstance'],_0x2703dd(0x1cb),{'text':_0x17cdf4,'user':_0x2ac7be[_0x2703dd(0x1ed)]}),_0x1124ef++);if(_0x2ac7be[_0x2703dd(0xf3)]&&_0x2ac7be[_0x2703dd(0x207)]){let _0x29f9ab={'message':_0x17cdf4,'title':_0x70c177?'üö®\x20EMERGENCY':_0x2703dd(0x200),'priority':_0x70c177?0x2:0x1,'device':_0x2ac7be[_0x2703dd(0x225)]};_0x70c177&&(_0x29f9ab[_0x2703dd(0xf9)]=0x1e,_0x29f9ab['expire']=0xe10,_0x29f9ab[_0x2703dd(0x1dd)]=_0x2703dd(0x12a)),await this['sendToAsync'](_0x2ac7be[_0x2703dd(0x207)],_0x2703dd(0x1cb),_0x29f9ab),_0x1124ef++;}return _0x2ac7be[_0x2703dd(0x27f)]&&_0x2ac7be['notifyEmailInstance']&&(await this[_0x2703dd(0x153)](_0x2ac7be[_0x2703dd(0x276)],'send',{'text':_0x17cdf4,'to':_0x2ac7be[_0x2703dd(0xc4)]}),_0x1124ef++),_0x2ac7be[_0x2703dd(0x14a)]&&_0x2ac7be[_0x2703dd(0x18a)]&&(await this[_0x2703dd(0x153)](_0x2ac7be[_0x2703dd(0x18a)],'send',{'text':_0x17cdf4,'phone':_0x2ac7be[_0x2703dd(0x1a6)]}),_0x1124ef++),_0x2ac7be[_0x2703dd(0xe4)]&&_0x2ac7be[_0x2703dd(0x17c)]&&(await this['sendToAsync'](_0x2ac7be[_0x2703dd(0x17c)],'send',{'text':_0x17cdf4,'phone':_0x2ac7be['notifySignalRecipient']}),_0x1124ef++),_0x1124ef;}async[a0_0x45eb70(0x105)](_0x5ce851={}){const _0x367d69=a0_0x45eb70;this[_0x367d69(0x277)][_0x367d69(0x285)](_0x367d69(0x176)+JSON[_0x367d69(0x174)](_0x5ce851));const _0x2d51e2=[],_0x838e2c=_0x5ce851[_0x367d69(0x185)]!==![],_0x543025=_0x5ce851['doors']!==![],_0x5518c9=_0x5ce851[_0x367d69(0xd4)]!==![],_0x5158b9=_0x5ce851['temperature']===!![],_0x58206a=_0x5ce851['weather']===!![],_0x1a857a=_0x5ce851[_0x367d69(0x28d)]||[],_0x23080f=await this[_0x367d69(0x23f)](_0x367d69(0x14b),'enum'),_0x41af27=await this[_0x367d69(0x23f)](_0x367d69(0xbc),_0x367d69(0x233)),_0x58f0e2={},_0x37a30f={},_0xbd3c67={},_0x1829bf=(_0x4020d8,_0x45946e,_0x28b2a3=![])=>{const _0x6c14de=_0x367d69;if(!_0x4020d8)return;for(const _0x4500e1 in _0x4020d8){const _0x110944=_0x4020d8[_0x4500e1];if(_0x110944&&_0x110944[_0x6c14de(0x1fa)]&&_0x110944[_0x6c14de(0x1fa)][_0x6c14de(0x19a)]){const _0x1b5373=(typeof _0x110944['common'][_0x6c14de(0xbd)]===_0x6c14de(0x24c)?_0x110944['common'][_0x6c14de(0xbd)]['de']:_0x110944[_0x6c14de(0x1fa)][_0x6c14de(0xbd)])||_0x110944['common'][_0x6c14de(0xbd)];if(_0x28b2a3)_0xbd3c67[_0x4500e1]=_0x1b5373;for(const _0x13c9b1 of _0x110944[_0x6c14de(0x1fa)][_0x6c14de(0x19a)]){if(_0x28b2a3){if(!_0x45946e[_0x13c9b1])_0x45946e[_0x13c9b1]=[];_0x45946e[_0x13c9b1][_0x6c14de(0x127)](_0x4500e1);}else _0x45946e[_0x13c9b1]=_0x1b5373;}}}};_0x1829bf(_0x23080f,_0x58f0e2),_0x1829bf(_0x41af27,_0x37a30f,!![]);const _0x1034c3=await this[_0x367d69(0x23f)]('*',_0x367d69(0xd0)),_0x45d829=[_0x367d69(0xe9),_0x367d69(0x18b),_0x367d69(0x258),_0x367d69(0x224),'FAULT',_0x367d69(0x255),'ALARM',_0x367d69(0x145),_0x367d69(0x288),_0x367d69(0xb4),_0x367d69(0x12b),'STICKY_UNREACH',_0x367d69(0x25b),_0x367d69(0x193),_0x367d69(0x22b),_0x367d69(0x179),_0x367d69(0x222),_0x367d69(0x13d),_0x367d69(0x270),_0x367d69(0xb6),_0x367d69(0x28e),_0x367d69(0x16b),'CONNECTION',_0x367d69(0x279),_0x367d69(0x1f0),_0x367d69(0x120),_0x367d69(0x155),_0x367d69(0x194),_0x367d69(0x242),_0x367d69(0x1fc),'info',_0x367d69(0x16f),_0x367d69(0x1e6),_0x367d69(0x11b),_0x367d69(0x21b),'alert',_0x367d69(0x1bd),'colormode',_0x367d69(0x1e2),'xy','ct',_0x367d69(0x15c),_0x367d69(0x1d0),_0x367d69(0x13a),_0x367d69(0x26a),_0x367d69(0x1a9),'uniqueid','command',_0x367d69(0x1e0),_0x367d69(0x262),'capabilities',_0x367d69(0x23a),_0x367d69(0x241),_0x367d69(0x24e),'javascript.0.script','detectionState',_0x367d69(0x12d),_0x367d69(0x149),_0x367d69(0x249),_0x367d69(0x1a5),'info',_0x367d69(0x1d6)];if(!_0x58206a)_0x45d829[_0x367d69(0x127)]('wetter',_0x367d69(0x101),_0x367d69(0xcf),_0x367d69(0x220),'uv','rain',_0x367d69(0x195));const _0x2ffcc7=[_0x367d69(0x130),_0x367d69(0x11a),_0x367d69(0x205),_0x367d69(0x154),_0x367d69(0x1c2),'material.',_0x367d69(0x112),_0x367d69(0x243)];if(!_0x58206a)_0x2ffcc7['push'](_0x367d69(0x27d),_0x367d69(0x1ca),_0x367d69(0x21f),_0x367d69(0x1f3),_0x367d69(0x111));const _0x318e56=(_0x7ccaa1,_0xb6a353,_0x1ce628=![])=>{const _0x547e44=_0x367d69,_0x265aad=_0x7ccaa1[_0x547e44(0x136)]('.');if(_0xb6a353[_0x7ccaa1])return _0xb6a353[_0x7ccaa1];if(_0x265aad[_0x547e44(0x1d4)]>0x2&&_0xb6a353[_0x265aad[_0x547e44(0x16e)](0x0,-0x1)[_0x547e44(0x1c1)]('.')])return _0xb6a353[_0x265aad[_0x547e44(0x16e)](0x0,-0x1)[_0x547e44(0x1c1)]('.')];if(_0x265aad['length']>0x3&&_0xb6a353[_0x265aad[_0x547e44(0x16e)](0x0,-0x2)[_0x547e44(0x1c1)]('.')])return _0xb6a353[_0x265aad[_0x547e44(0x16e)](0x0,-0x2)[_0x547e44(0x1c1)]('.')];return _0x1ce628?[]:null;};for(const _0x2808ed in _0x1034c3){const _0x202aaa=_0x1034c3[_0x2808ed];if(!_0x202aaa||!_0x202aaa['common'])continue;if(_0x2ffcc7[_0x367d69(0x156)](_0x3bc5f9=>_0x2808ed['startsWith'](_0x3bc5f9)))continue;const _0x4611cb=_0x202aaa[_0x367d69(0x1fa)][_0x367d69(0xee)]||'',_0x5be919=(_0x202aaa[_0x367d69(0x1fa)][_0x367d69(0xbd)]&&typeof _0x202aaa['common'][_0x367d69(0xbd)]===_0x367d69(0x24c)?_0x202aaa[_0x367d69(0x1fa)][_0x367d69(0xbd)]['de']:_0x202aaa[_0x367d69(0x1fa)]['name'])||'',_0x2d0329=_0x5be919?_0x5be919[_0x367d69(0x15f)]():'',_0x230193=_0x2808ed[_0x367d69(0x15f)](),_0x3377a5=_0x318e56(_0x2808ed,_0x58f0e2),_0x24c59c=_0x318e56(_0x2808ed,_0x37a30f,!![]);let _0x13e8df=null,_0x9b6149=![];if(_0x24c59c&&_0x24c59c[_0x367d69(0x1d4)]>0x0){const _0x2a4af2=_0x24c59c[_0x367d69(0x160)](_0x4e6f66=>_0x1a857a[_0x367d69(0x266)](_0x4e6f66));if(_0x2a4af2){_0x9b6149=!![];const _0x6a227e=_0xbd3c67[_0x2a4af2];if(_0x230193['includes'](_0x367d69(0x113))||_0x230193[_0x367d69(0x266)](_0x367d69(0x185)))_0x13e8df='Bewegung';else{if(_0x230193['includes']('smoke')||_0x230193[_0x367d69(0x266)]('fire')||_0x2d0329[_0x367d69(0x266)]('rauch'))_0x13e8df='Rauchmelder';else{if(_0x230193['includes'](_0x367d69(0xd0))||_0x230193['includes'](_0x367d69(0x129))||_0x230193[_0x367d69(0x266)]('on'))_0x13e8df=_0x367d69(0x1c8);else _0x13e8df=_0x6a227e;}}}}if(!_0x9b6149&&!_0x58206a){if(_0x45d829['some'](_0x2bf334=>_0x2d0329[_0x367d69(0x266)](_0x2bf334)||_0x2808ed[_0x367d69(0xce)]()[_0x367d69(0x266)](_0x2bf334)))continue;}if(!_0x13e8df&&_0x838e2c){if(_0x4611cb['includes'](_0x367d69(0x110))||_0x4611cb[_0x367d69(0x266)](_0x367d69(0x1fd))||_0x2d0329[_0x367d69(0x266)](_0x367d69(0x132))||_0x2d0329['includes'](_0x367d69(0x126)))_0x13e8df='Bewegung';}!_0x13e8df&&_0x543025&&((_0x230193[_0x367d69(0x266)](_0x367d69(0x104))||_0x4611cb[_0x367d69(0x266)](_0x367d69(0x133))||_0x4611cb[_0x367d69(0x266)](_0x367d69(0x17f))||(_0x2d0329['includes'](_0x367d69(0x181))||_0x2d0329[_0x367d69(0x266)]('t√ºr'))&&!_0x2d0329[_0x367d69(0x266)]('temp')&&!_0x2d0329[_0x367d69(0x266)](_0x367d69(0x157))&&(_0x202aaa['common']['type']===_0x367d69(0x125)||_0x202aaa[_0x367d69(0x1fa)][_0x367d69(0x146)]===_0x367d69(0x11d)))&&(_0x13e8df=_0x367d69(0x20f)));if(!_0x13e8df&&_0x5518c9){if((_0x4611cb['includes'](_0x367d69(0x245))||_0x4611cb[_0x367d69(0x266)]('level.dimmer')||_0x2d0329[_0x367d69(0x266)](_0x367d69(0x168))||_0x2d0329[_0x367d69(0x266)](_0x367d69(0x187)))&&_0x202aaa[_0x367d69(0x1fa)][_0x367d69(0xcb)])_0x13e8df=_0x367d69(0x264);}if(!_0x13e8df&&_0x5158b9){if(_0x4611cb[_0x367d69(0x266)](_0x367d69(0x11e))||_0x4611cb[_0x367d69(0x266)](_0x367d69(0x1d5))||_0x2d0329[_0x367d69(0x266)](_0x367d69(0x284)))_0x13e8df=_0x367d69(0x234);}if(_0x13e8df){let _0x7ce8e3=_0x3377a5||'';if(!_0x7ce8e3){if(_0x2d0329[_0x367d69(0x266)](_0x367d69(0x20c)))_0x7ce8e3=_0x367d69(0x199);else{if(_0x2d0329[_0x367d69(0x266)]('k√ºche'))_0x7ce8e3=_0x367d69(0xfd);else{if(_0x2d0329[_0x367d69(0x266)](_0x367d69(0x162)))_0x7ce8e3=_0x367d69(0x122);else{if(_0x2d0329[_0x367d69(0x266)](_0x367d69(0xd2)))_0x7ce8e3='Schlafzimmer';else{if(_0x2d0329[_0x367d69(0x266)]('flur')||_0x2d0329[_0x367d69(0x266)](_0x367d69(0x1c3)))_0x7ce8e3=_0x367d69(0x28a);else{if(_0x2d0329[_0x367d69(0x266)](_0x367d69(0x17e)))_0x7ce8e3=_0x367d69(0x210);}}}}}}let _0x2316ba=![];_0x13e8df===_0x367d69(0x20f)&&((_0x2d0329['includes']('haust√ºr')||_0x2d0329[_0x367d69(0x266)](_0x367d69(0x117))||_0x2d0329['includes'](_0x367d69(0xbe))||_0x7ce8e3&&_0x7ce8e3[_0x367d69(0x15f)]()['includes'](_0x367d69(0x1c6))&&_0x2d0329['includes'](_0x367d69(0x17a)))&&(_0x2316ba=!![]));let _0x2775ab=0x0;if(_0x9b6149)_0x2775ab+=0x1e;else{if(_0x3377a5)_0x2775ab+=0x14;else{if(_0x7ce8e3)_0x2775ab+=0xa;}}if(_0x2316ba)_0x2775ab+=0x5;_0x2d51e2['push']({'id':_0x2808ed,'name':_0x5be919||_0x2808ed,'type':_0x13e8df,'location':_0x7ce8e3,'logDuplicates':_0x13e8df===_0x367d69(0x14d),'isExit':_0x2316ba,'_score':_0x2775ab});}}return _0x2d51e2['sort']((_0x4e7b6b,_0x1e553e)=>_0x1e553e[_0x367d69(0x191)]-_0x4e7b6b[_0x367d69(0x191)]),_0x2d51e2;}async['startExitTimer'](){const _0x1d6757=a0_0x45eb70;this[_0x1d6757(0x24f)](),this[_0x1d6757(0x189)]=!![],this[_0x1d6757(0x106)]=setTimeout(()=>{const _0x4fe6f3=_0x1d6757;this[_0x4fe6f3(0x189)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x1d6757(0x244)]=setTimeout(()=>{const _0x3b0235=_0x1d6757;this[_0x3b0235(0x15d)](![]),this['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}async[a0_0x45eb70(0x24f)](){const _0x4f29e0=a0_0x45eb70;if(this[_0x4f29e0(0x244)])clearTimeout(this['exitTimer']);if(this[_0x4f29e0(0x106)])clearTimeout(this['exitGraceTimer']);this['exitTimer']=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![];}async[a0_0x45eb70(0x15d)](_0x3a8860){const _0x194d66=a0_0x45eb70;if(this[_0x194d66(0x25d)]===_0x3a8860)return;this['isPresent']=_0x3a8860,await this[_0x194d66(0xea)](_0x194d66(0x196),{'val':_0x3a8860,'ack':!![]});}async[a0_0x45eb70(0x1de)](){const _0x3f8e49=a0_0x45eb70;await this[_0x3f8e49(0xea)](_0x3f8e49(0x1d1),{'val':_0x3f8e49(0x18d),'ack':!![]}),await this[_0x3f8e49(0xea)](_0x3f8e49(0xc5),{'val':this[_0x3f8e49(0x247)]?'N/A\x20(No\x20Activity)':'N/A\x20(Pro\x20Feature)','ack':!![]}),await this[_0x3f8e49(0xea)](_0x3f8e49(0xf5),{'val':![],'ack':!![]}),await this[_0x3f8e49(0xea)]('analysis.isEmergency',{'val':![],'ack':!![]}),this[_0x3f8e49(0x269)]=![];}async[a0_0x45eb70(0xe5)](){const _0x6e03e8=a0_0x45eb70;if(!this[_0x6e03e8(0x247)]||!this[_0x6e03e8(0xc8)])return;const _0x443901=this['config']['ltmStbWindowDays']||0xe;if(this[_0x6e03e8(0x1f7)][_0x6e03e8(0x1d4)]<_0x443901+(this['config'][_0x6e03e8(0x135)]||0x7)){await this[_0x6e03e8(0xea)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0xc35c5c=this[_0x6e03e8(0x1f7)][_0x6e03e8(0x16e)](-_0x443901),_0x1fee8f=this[_0x6e03e8(0x1f7)][_0x6e03e8(0x16e)](0x0,this[_0x6e03e8(0x1f7)]['length']-_0x443901),_0x280161='ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a'+JSON[_0x6e03e8(0x174)](_0x1fee8f)+_0x6e03e8(0x1e8)+JSON[_0x6e03e8(0x174)](_0xc35c5c);try{const _0x36c08a=await this[_0x6e03e8(0xc8)][_0x6e03e8(0x23c)](_0x280161),_0xbc153a=JSON[_0x6e03e8(0x169)](_0x36c08a[_0x6e03e8(0x170)][_0x6e03e8(0x1a0)]()[_0x6e03e8(0xbb)](/```json|```/g,'')[_0x6e03e8(0x17b)]());_0xbc153a[_0x6e03e8(0x218)]&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0xbc153a['baselineDrift'],'ack':!![]}),await this[_0x6e03e8(0xea)](LTM_DP_DRIFT_DETAILS,{'val':_0xbc153a[_0x6e03e8(0x1f5)],'ack':!![]}),await this[_0x6e03e8(0xea)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x6e03e8(0x1d7)](),'ack':!![]}));}catch(_0x524c58){}}[a0_0x45eb70(0x257)](){const _0x5ef0d4=a0_0x45eb70;try{if(this[_0x5ef0d4(0x1ae)])this[_0x5ef0d4(0x1ae)]['cancel']();if(!this[_0x5ef0d4(0x247)]){this['setStateAsync'](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this[_0x5ef0d4(0x1ae)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>this['createDailyDigest']());}catch(_0x4ec0f4){this[_0x5ef0d4(0x277)]['error'](_0x5ef0d4(0x10e)+_0x4ec0f4[_0x5ef0d4(0x1f4)]);}}[a0_0x45eb70(0xb5)](){const _0x48df68=a0_0x45eb70;try{if(this[_0x48df68(0x1f1)])this[_0x48df68(0x1f1)]['cancel']();this['modeResetJob']=schedule[_0x48df68(0x1cd)](MODE_RESET_SCHEDULE,async()=>{const _0x435575=_0x48df68;await this[_0x435575(0x12c)](),AUTO_RESET_MODES['includes'](this['currentSystemMode'])&&await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x435575(0x1b1)],'ack':![]});});}catch(_0x5ea5b1){this['log'][_0x48df68(0x1b9)](_0x48df68(0x190)+_0x5ea5b1[_0x48df68(0x1f4)]);}}['setupDriftAnalysisScheduler'](){const _0x42818a=a0_0x45eb70;try{if(this['driftAnalysisTimer'])clearInterval(this['driftAnalysisTimer']);if(!this[_0x42818a(0x247)])return;this['driftAnalysisTimer']=setInterval(()=>this['runBaselineDriftAnalysis'](),(this[_0x42818a(0xe7)][_0x42818a(0x228)]||0x18)*0x36ee80),setTimeout(()=>this[_0x42818a(0xe5)](),0x1388);}catch(_0x59a372){this[_0x42818a(0x277)][_0x42818a(0x1b9)](_0x42818a(0x1da)+_0x59a372['message']);}}[a0_0x45eb70(0x188)](){const _0x1d9bbe=a0_0x45eb70;try{if(this['briefingJob'])this['briefingJob'][_0x1d9bbe(0xbf)]();if(!this[_0x1d9bbe(0xe7)][_0x1d9bbe(0x158)])return;const _0x30991e=(this['config']['briefingTime']||_0x1d9bbe(0xc2))[_0x1d9bbe(0x136)](':'),_0x2fb699=parseInt(_0x30991e[0x0])||0x8,_0x582359=parseInt(_0x30991e[0x1])||0x0,_0x33e056=_0x582359+'\x20'+_0x2fb699+_0x1d9bbe(0x1ba);this['log']['info']('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x2fb699+':'+(_0x582359<0xa?'0'+_0x582359:_0x582359)),this[_0x1d9bbe(0xc0)]=schedule['scheduleJob'](_0x33e056,()=>{const _0x28b3d2=_0x1d9bbe;this[_0x28b3d2(0x1b2)]();});}catch(_0x26a429){this[_0x1d9bbe(0x277)][_0x1d9bbe(0x1b9)](_0x1d9bbe(0x148)+_0x26a429['message']);}}}function a0_0x14ca(){const _0x38c8eb=['System\x20Status\x20&\x20Control','wohn','initHistory','guest','getObjectAsync','map','onReady','licht','parse','analysis.triggerBriefing','AES_KEY','updateAnalysisHistory','Analysis\x20Error:\x20','slice','signal','response','command','Daily\x20Digests','generic','stringify','filter','Starting\x20Smart\x20Scan\x20with\x20filters:\x20','.forecast.current.state','User\x20Feedback:\x20Alarm\x20\x22','COMBINED_PARAMETER','t√ºr','trim','notifySignalInstance','livingContext','garten','sensor.window','6SPhoAg','fenster','extendObjectAsync','onUnload','290521xAWpVJ','motion','1509496XVxICy','lampe','setupBriefingScheduler','isGracePeriodActive','notifyWhatsappInstance','LOWBAT','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','No\x20recent\x20activity.','weatherInstance','event','Reset\x20Sched\x20Error:\x20','_score','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','VIRTUAL_CHANNEL','firmware','precip','system.isPresent','daswetter.0','accuweather.0','Badezimmer','members','LTM.triggerDailyDigest','Gemini\x20Init\x20Error:\x20','Autopilot\x20error:\x20','details','triggerBriefing','text','Success','Error\x20in\x20onMessage\x20command\x20','\x20(EMERGENCY)','KALENDER:\x20','forecast','notifyWhatsappRecipient','Last\x20Check','LTM.processingStatus','modelid','latitude','analysis.comfortSummary','Kalender:\x20Deaktiviert','No\x20recorded\x20events\x20yet.','ltmJob','testContext','string','NORMAL','sendMorningBriefing','feedbackHistory','_calName','.\x20PERSONA:\x20','sendNotification','getCalendarNames','analysis.automation.description','error','\x20*\x20*\x20*','licenseKey','loadDailyDigests\x20failed:\x20','mode','getForeignStateAsync','analysis.history_debug_04','de-DE','join','history.','diele','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','flur','üåÖ\x20Daily\x20Briefing:\x0a','Schalter/Licht','Gast','weatherunderground.','send','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','scheduleJob','currentSystemMode','subscribeStates','sat','analysis.activitySummary','LTM.driftAnalysis.lastCheck','isEmergency','length','value.humidity','json','now','loadSystemMode\x20failed:\x20','catch','Drift\x20Sched\x20Error:\x20','location','unknown','sound','resetAnalysisStates','search','mac\x20address','setupDriftAnalysisScheduler','effect','channel','Missing\x20data','accuweather','last_seen','analysis.isEmergency','\x0a\x0aA\x20(STB):\x0a','0\x204\x20*\x20*\x20*','events.lastEvent','getForeignObjectAsync','PARTY','notifyTelegramRecipient','analysis.analysisHistory','notes','link_quality','modeResetJob','saveRawEventLog','yr.','message','driftDetails','Generating\x20Morning\x20Briefing...','dailyDigests','inactivityMonitoringEnabled','Baseline:\x20Inactive\x20(Pro\x20Feature).','common','WETTER\x20ERROR:\x20','connection','occupancy','Wetter:\x20Deaktiviert','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','Cogni-Living\x20Alert','Analysiere\x20Tag...','0\x203\x20*\x20*\x20*','Party','N/A','info.','\x20sensors...','notifyPushoverInstance','Normal','createAllObjects','Creating\x20Daily\x20Digest\x20from\x20','analysis.health.notes','bad','startExitTimer','rawEventLog','Fenster/T√ºr','Garten','setHours','toString','Fehler:\x20','Adapter','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','10amxCkc','baselineDrift','analysisHistory','openweathermap','archetype','restlessness','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','accuweather.','pressure','devices','WEEK_PROGRAM','events.history_debug_00','ERROR','notifyPushoverRecipient','submitFeedback','unshift','ltmDriftCheckIntervalHours','Briefing\x20Error:\x20','val','INSTALL_TEST','PRO-','No\x20instance','events.history_debug_02','analysis.health.restlessness','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','suggestion','daswetter','enum','Temperatur','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','Error\x20reading\x20calendar\x20table:\x20','application/json','(((.+)+)+)+$','subscribeForeignStatesAsync','process','processSensorEvent','generateContent','Nein','getWeatherContext','getForeignObjectsAsync','Urlaub','scriptEnabled','version','flot.','exitTimer','switch.light','long','isProVersion','values','history','checkLtmDriftObjects','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','object','VACATION','scriptProblem','abortExitTimer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','Starting\x20Autopilot\x20(','date','alertReason','analysis.history_debug_03','SABOTAGE','setState','setupLtmScheduler','RSSI','main','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','OPERATING_VOLTAGE','geminiApiKey','isPresent','system.meta.uuid','Sending\x20notification:\x20\x22','isExit','.\x20PR√ÑSENZ:\x20','description','1434099MjGUoz','Licht','getSystemUUID','includes','calendarInstance','getGenerativeModel','lastAlertState','manufacturer','models/gemini-flash-latest','loadDailyDigests','getCalendarContext','patternDetected','Raw\x20Log','SECTION','System\x20Mode','GUEST','lastCheck','system','Drift\x20Analysis','notifyEmailInstance','log','2-digit','reachable','Daily\x20Digest\x20Error:\x20','events.history_debug_03','ack','daswetter.','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','notifyEmailEnabled','events.history','instance','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20','exports','temperatur','info','\x20raw\x20events...','vacation','DUTYCYCLE','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','Flur','from','notifyTelegramEnabled','selectedFunctionIds','PROCESS','Morning\x20Briefing\x20sent.','WORKING','setupModeResetScheduler','ERROR_CODE','normal','events.history_debug_04','logDuplicates','sensorLastValues','replace','enum.functions.*','name','wohnungst√ºr','cancel','briefingJob','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','08:00','node-schedule','notifyEmailRecipient','analysis.deviationFromBaseline','createDailyDigest','unload','geminiModel','@google/generative-ai','Subscribing\x20to\x20','write','runAutopilot','checkLicense','toUpperCase','wind','state','analysis.comfortSuggestion','schlaf','systemUUID','lights','analysis.automation.patternDetected','systemConfig','onMessage','notifyTelegramInstance','‚ö†Ô∏è\x20Alarm','Daily\x20Digest\x20created\x20successfully.','getStateAsync','sort','Error\x20initHistory:\x20','createAllObjects\x20failed:\x20','analysis.trigger','health','18396333MLWett','cogni-living','Processing\x20Status','notifySignalEnabled','runBaselineDriftAnalysis','automationProposal','config','uuid','UNREACH','setStateAsync','inactivityThresholdHours','native','calendarSelection','role','testNotification','[TEST]\x20','getEnums','genAI','notifyPushoverEnabled','Drift\x20Status','analysis.isAlert','analysis.history_debug_00','activity','party','retry','sleepScore','constructor','toISOString','K√ºche','timestamp','KALENDER\x20ERROR:\x20','callback','weather','presenceDevices','stateChange','shutter_contact','scanForDevices','exitGraceTimer','WETTER:\x20','cogni-living\x20adapter\x20starting\x20(v','none','warn','bind','driftAnalysisTimer','getCalendarNames\x20Error:\x20','LTM\x20Sched\x20Error:\x20','system.mode','sensor.motion','openweathermap.','icons-mfd.','presence','aiPersona','test','scanDevices','eingang','LTM.baselineStatus','loadRawEventLog','admin.','last\x20action','analysisTimer','number','value.temperature','150HjGryr','battery','time','Wohnzimmer','.NextHours.Location_1.Day_1.current.symbol_desc','\x0aFEEDBACK:\x0a','boolean','pr√§senz','push','KALENDER:\x20Keine\x20relevanten\x20Termine','level','siren','DIRECTION','loadSystemMode','summary','city','tryParse','system.','WETTER:\x20Keine\x20Daten','bewegung','sensor.door','LTM.driftAnalysis.baselineDrift','minDaysForBaseline','split','useCalendar','comfort','sendTo','productname','checkWifiPresence','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','ON_TIME','2618600vZWrio','toLocaleString','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','eventHistory','58998CptrnJ','License\x20Check\x20failed:\x20','runGeminiAnalysis','CONFIG_PENDING','type','\x20|\x20','Briefing\x20Sched\x20Error:\x20','icon','notifyWhatsappEnabled','enum.rooms.*','.data.table','Bewegung','checkSystemObjects','analysisInterval','.Summary.Current','LTM.rawEventLog','118765jUQYkG','sendToAsync','vis.','update','some','griff','briefingEnabled','status','onStateChange','Drift\x20Details','hue','setPresence','Trigger\x20Digest','toLowerCase','find'];a0_0x14ca=function(){return _0x38c8eb;};return a0_0x14ca();}if(require[a0_0x45eb70(0x259)]!==module)module[a0_0x45eb70(0x283)]=_0x2faf99=>new CogniLiving(_0x2faf99);else new CogniLiving();