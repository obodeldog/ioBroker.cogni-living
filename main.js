const a0_0x1e9089=a0_0x33ac;(function(_0x1ff6f2,_0x10bc84){const _0x42d4be=a0_0x33ac,_0x1a5f03=_0x1ff6f2();while(!![]){try{const _0x5d0c13=-parseInt(_0x42d4be(0x23b))/0x1+parseInt(_0x42d4be(0x204))/0x2+-parseInt(_0x42d4be(0xf0))/0x3*(parseInt(_0x42d4be(0x1ec))/0x4)+parseInt(_0x42d4be(0xb6))/0x5+parseInt(_0x42d4be(0x25a))/0x6+parseInt(_0x42d4be(0x105))/0x7*(parseInt(_0x42d4be(0xdb))/0x8)+-parseInt(_0x42d4be(0x1df))/0x9;if(_0x5d0c13===_0x10bc84)break;else _0x1a5f03['push'](_0x1a5f03['shift']());}catch(_0x2b16bf){_0x1a5f03['push'](_0x1a5f03['shift']());}}}(a0_0x1873,0x18afb));const a0_0x31886b=(function(){let _0x23732a=!![];return function(_0x1d3827,_0x1a5ff5){const _0x2d707d=_0x23732a?function(){const _0x2a9440=a0_0x33ac;if(_0x1a5ff5){const _0x2511bd=_0x1a5ff5[_0x2a9440(0x167)](_0x1d3827,arguments);return _0x1a5ff5=null,_0x2511bd;}}:function(){};return _0x23732a=![],_0x2d707d;};}()),a0_0x1a0bb9=a0_0x31886b(this,function(){const _0x54bffd=a0_0x33ac;return a0_0x1a0bb9[_0x54bffd(0x1e4)]()[_0x54bffd(0x1c9)](_0x54bffd(0x205))[_0x54bffd(0x1e4)]()['constructor'](a0_0x1a0bb9)[_0x54bffd(0x1c9)]('(((.+)+)+)+$');});a0_0x1a0bb9();'use strict';const utils=require(a0_0x1e9089(0x13f)),{GoogleGenerativeAI}=require(a0_0x1e9089(0x1cc)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x1e9089(0x259)),path=require(a0_0x1e9089(0x17a)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x1e9089(0x1e9),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x1e9089(0xbd),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x1e9089(0x122),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x1e9089(0xd0),LTM_DP_TRIGGER_DIGEST=a0_0x1e9089(0x24f),LTM_DP_BASELINE_STATUS=a0_0x1e9089(0xec),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x1e9089(0x216),LTM_DP_DRIFT_DETAILS=a0_0x1e9089(0x156),LTM_DP_DRIFT_LAST_CHECK=a0_0x1e9089(0xf6),SYSTEM_DP_MODE=a0_0x1e9089(0x15c),SYSTEM_MODES={'NORMAL':a0_0x1e9089(0x258),'VACATION':'vacation','PARTY':a0_0x1e9089(0x197),'GUEST':a0_0x1e9089(0xc8)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x1e9089(0x1f7)],SYSTEM_MODES[a0_0x1e9089(0x171)]],PERSONA_MAPPING={'generic':a0_0x1e9089(0x165),'senior_aal':a0_0x1e9089(0x130),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x1e9089(0x100)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},HARD_IGNORE_TERMS=['scriptProblem',a0_0x1e9089(0x1b1),'update',a0_0x1e9089(0x12e),'lowbat',a0_0x1e9089(0xb3),a0_0x1e9089(0x107),a0_0x1e9089(0x16b),'error','fault','working','direction',a0_0x1e9089(0x1c1),a0_0x1e9089(0x117),a0_0x1e9089(0x1dd),a0_0x1e9089(0x1b4),a0_0x1e9089(0x20c),a0_0x1e9089(0x1ee)],BAD_NAMES=[a0_0x1e9089(0x19f),a0_0x1e9089(0x18b),'state','level','value',a0_0x1e9089(0x18a),'on',a0_0x1e9089(0x23a),a0_0x1e9089(0x22d),a0_0x1e9089(0x1cb),a0_0x1e9089(0x181),a0_0x1e9089(0x222),a0_0x1e9089(0x21f),a0_0x1e9089(0xbe),a0_0x1e9089(0x1be),'presence','occupancy',a0_0x1e9089(0xd6),'humidity',a0_0x1e9089(0x1c7),a0_0x1e9089(0x1e7),a0_0x1e9089(0x11a),a0_0x1e9089(0xeb),a0_0x1e9089(0xc3),a0_0x1e9089(0x112)],ADAPTER_BLACKLIST=[a0_0x1e9089(0x203),'admin.',a0_0x1e9089(0x22e),'vis.',a0_0x1e9089(0xc4),a0_0x1e9089(0x11d),'icons-mfd.',a0_0x1e9089(0x12c),a0_0x1e9089(0x132),a0_0x1e9089(0x252),a0_0x1e9089(0xd1)],IS_WIN=process['platform']===a0_0x1e9089(0x12f),VENV_PATH=path[a0_0x1e9089(0x1f6)](__dirname,a0_0x1e9089(0x14d)),PYTHON_EXE=IS_WIN?path[a0_0x1e9089(0x1f6)](VENV_PATH,'Scripts',a0_0x1e9089(0x23d)):path[a0_0x1e9089(0x1f6)](VENV_PATH,a0_0x1e9089(0x173),a0_0x1e9089(0x24e)),PIP_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x1e9089(0xcd),a0_0x1e9089(0x218)):path[a0_0x1e9089(0x1f6)](VENV_PATH,a0_0x1e9089(0x173),a0_0x1e9089(0x209));let activeSequence=[],sequenceTimer=null;async function initZombies(_0x200e94){const _0x1d1bf6=a0_0x1e9089;try{const _0x49d7d9=['analysis.history_debug_00','events.history_debug_00'];for(const _0x511253 of _0x49d7d9){try{const _0x415046=await _0x200e94['getObjectAsync'](_0x511253);if(_0x415046)await _0x200e94[_0x1d1bf6(0x25d)](_0x511253);}catch(_0x4962ab){}}}catch(_0xe1fd50){}}async function initHistory(_0x165dd0){const _0x5a7c56=a0_0x1e9089;try{const _0x422c2b=await _0x165dd0[_0x5a7c56(0x15b)](_0x5a7c56(0x25e));_0x422c2b&&_0x422c2b['val']&&(_0x165dd0[_0x5a7c56(0x137)]=JSON[_0x5a7c56(0x14c)](_0x422c2b[_0x5a7c56(0x21b)]['toString']()));}catch(_0x228f07){_0x165dd0[_0x5a7c56(0x137)]=[];}try{const _0x16f70f=await _0x165dd0['getStateAsync'](_0x5a7c56(0x247));if(_0x16f70f&&_0x16f70f['val'])_0x165dd0['analysisHistory']=JSON['parse'](_0x16f70f[_0x5a7c56(0x21b)][_0x5a7c56(0x1e4)]());}catch(_0x55f214){_0x165dd0[_0x5a7c56(0xf1)]=[];}if(_0x165dd0[_0x5a7c56(0x137)]&&_0x165dd0[_0x5a7c56(0x137)][_0x5a7c56(0xc0)]>0x0){_0x165dd0[_0x5a7c56(0x21d)][_0x5a7c56(0x207)](_0x5a7c56(0x241)+_0x165dd0[_0x5a7c56(0x137)]['length']+_0x5a7c56(0xce));for(let _0x53b334=_0x165dd0[_0x5a7c56(0x137)][_0x5a7c56(0xc0)]-0x1;_0x53b334>=0x0;_0x53b334--){const _0x535c6c=_0x165dd0[_0x5a7c56(0x137)][_0x53b334];if(_0x535c6c&&_0x535c6c['id']!==undefined&&_0x535c6c[_0x5a7c56(0x143)]!==undefined)_0x165dd0[_0x5a7c56(0x153)][_0x535c6c['id']]=_0x535c6c[_0x5a7c56(0x143)];}}}async function initSystemConfig(_0x4499d8){const _0xf4fc14=a0_0x1e9089;try{const _0x102e6e=await _0x4499d8[_0xf4fc14(0xf4)](_0xf4fc14(0x152));if(_0x102e6e&&_0x102e6e[_0xf4fc14(0xe9)])_0x4499d8[_0xf4fc14(0x1c0)]={'latitude':_0x102e6e[_0xf4fc14(0xe9)][_0xf4fc14(0x219)]||0x0,'longitude':_0x102e6e[_0xf4fc14(0xe9)]['longitude']||0x0,'city':_0x102e6e['common'][_0xf4fc14(0x186)]||''};}catch(_0x54ab25){}}async function checkLicense(_0x3fd4db,_0x4f316e){return!![];}async function getSystemUUID(_0x5a71f8){const _0x539fe4=a0_0x1e9089;return _0x539fe4(0x146);}async function loadRawEventLog(_0x2c8a23){const _0x2fa932=a0_0x1e9089;try{const _0x1d801d=await _0x2c8a23['getStateAsync'](LTM_DP_RAW_LOG);if(_0x1d801d&&_0x1d801d[_0x2fa932(0x21b)])_0x2c8a23[_0x2fa932(0x1e2)]=JSON[_0x2fa932(0x14c)](_0x1d801d[_0x2fa932(0x21b)]);}catch(_0x45f434){_0x2c8a23['rawEventLog']=[];}}async function saveRawEventLog(_0x59a2eb){const _0xe30cb1=a0_0x1e9089;if(_0x59a2eb[_0xe30cb1(0x1e2)][_0xe30cb1(0xc0)]>RAW_LOG_MAX_SIZE)_0x59a2eb[_0xe30cb1(0x1e2)][_0xe30cb1(0x155)](0x0,_0x59a2eb[_0xe30cb1(0x1e2)][_0xe30cb1(0xc0)]-RAW_LOG_MAX_SIZE);await _0x59a2eb[_0xe30cb1(0x1f5)](LTM_DP_RAW_LOG,{'val':JSON[_0xe30cb1(0x184)](_0x59a2eb[_0xe30cb1(0x1e2)]),'ack':!![]});}async function loadDailyDigests(_0x5636af){const _0x50816f=a0_0x1e9089;try{const _0x520615=await _0x5636af[_0x50816f(0x15b)](LTM_DP_DAILY_DIGESTS);if(_0x520615&&_0x520615[_0x50816f(0x21b)])_0x5636af['dailyDigests']=JSON[_0x50816f(0x14c)](_0x520615[_0x50816f(0x21b)]);}catch(_0x1bd902){_0x5636af[_0x50816f(0x161)]=[];}await updateBaselineStatus(_0x5636af);}async function saveDailyDigests(_0x2ec0d7,_0x9c452b=!![]){const _0x2f85cd=a0_0x1e9089,_0x556877=_0x2ec0d7['config'][_0x2f85cd(0x249)]||0x3c;_0x2ec0d7[_0x2f85cd(0x161)][_0x2f85cd(0xc0)]>_0x556877&&_0x2ec0d7['dailyDigests']['splice'](0x0,_0x2ec0d7['dailyDigests'][_0x2f85cd(0xc0)]-_0x556877);await _0x2ec0d7[_0x2f85cd(0x1f5)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2f85cd(0x184)](_0x2ec0d7[_0x2f85cd(0x161)]),'ack':!![]});if(_0x9c452b)await updateBaselineStatus(_0x2ec0d7);}async function updateAnalysisHistory(_0x2fb663,_0x7db56c){const _0x552198=a0_0x1e9089;_0x2fb663[_0x552198(0xf1)]['unshift'](_0x7db56c);if(_0x2fb663[_0x552198(0xf1)][_0x552198(0xc0)]>ANALYSIS_HISTORY_MAX_SIZE)_0x2fb663[_0x552198(0xf1)]['pop']();await _0x2fb663['setStateAsync'](_0x552198(0x247),{'val':JSON['stringify'](_0x2fb663[_0x552198(0xf1)]),'ack':!![]});}async function updateBaselineStatus(_0x2db573){const _0x51bbbf=a0_0x1e9089;if(!_0x2db573[_0x51bbbf(0x1ce)]){await _0x2db573[_0x51bbbf(0x1f5)](LTM_DP_BASELINE_STATUS,{'val':_0x51bbbf(0x16c),'ack':!![]});return;}const _0x1f228f=_0x2db573[_0x51bbbf(0x161)][_0x51bbbf(0xc0)]>=(_0x2db573[_0x51bbbf(0x23e)][_0x51bbbf(0x109)]||0x7)?'Aktiv\x20('+_0x2db573[_0x51bbbf(0x161)][_0x51bbbf(0xc0)]+_0x51bbbf(0x1e3):_0x51bbbf(0x1d2)+_0x2db573[_0x51bbbf(0x161)][_0x51bbbf(0xc0)]+'/'+(_0x2db573[_0x51bbbf(0x23e)]['minDaysForBaseline']||0x7)+')';await _0x2db573[_0x51bbbf(0x1f5)](LTM_DP_BASELINE_STATUS,{'val':_0x1f228f,'ack':!![]});}async function loadSystemMode(_0xa0a00a){const _0x3b87d7=a0_0x1e9089;try{const _0x4c8721=await _0xa0a00a[_0x3b87d7(0x15b)](SYSTEM_DP_MODE);_0x4c8721&&_0x4c8721[_0x3b87d7(0x21b)]&&Object[_0x3b87d7(0xcf)](SYSTEM_MODES)['includes'](_0x4c8721[_0x3b87d7(0x21b)])?_0xa0a00a['currentSystemMode']=_0x4c8721['val']:(_0xa0a00a[_0x3b87d7(0x1fb)]=SYSTEM_MODES[_0x3b87d7(0x14f)],await _0xa0a00a[_0x3b87d7(0x1f5)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3b87d7(0x14f)],'ack':!![]}));}catch(_0x25590d){_0xa0a00a['currentSystemMode']=SYSTEM_MODES[_0x3b87d7(0x14f)];}}async function createAllObjects(_0x395722){const _0xcce36b=a0_0x1e9089;await _0x395722[_0xcce36b(0x232)]('system',{'type':_0xcce36b(0x104),'common':{'name':_0xcce36b(0x1f8)},'native':{}}),await _0x395722[_0xcce36b(0x232)](SYSTEM_DP_MODE,{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x11b),'type':_0xcce36b(0xd3),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0xcce36b(0x14f)]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x242),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0xf2),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x16f),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x13a),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x18c),'read':!![],'write':![]},'native':{}}),await _0x395722['setObjectNotExistsAsync'](_0xcce36b(0x25e),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0xe4),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x18c),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x232)]('analysis.training',{'type':_0xcce36b(0x104),'common':{'name':'AI\x20Training'},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x23f),{'type':_0xcce36b(0x1da),'common':{'name':'Train\x20Security','type':'boolean','role':_0xcce36b(0x177),'read':!![],'write':!![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x20e),{'type':'state','common':{'name':_0xcce36b(0x1f1),'type':_0xcce36b(0x119),'role':_0xcce36b(0x177),'read':!![],'write':!![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x255),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x144),'type':_0xcce36b(0x119),'role':_0xcce36b(0x177),'read':!![],'write':!![]},'native':{}}),await _0x395722['setObjectNotExistsAsync']('analysis.training.status',{'type':'state','common':{'name':_0xcce36b(0x138),'type':'string','role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x232)]('analysis.security',{'type':_0xcce36b(0x104),'common':{'name':_0xcce36b(0x114)},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x1bf),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0xd9),'type':_0xcce36b(0x142),'role':_0xcce36b(0x143),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x223),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0xf9),'type':_0xcce36b(0xd3),'role':'date','read':!![],'write':![]},'native':{}}),await _0x395722['extendObjectAsync'](_0xcce36b(0x1d8),{'type':_0xcce36b(0x104),'common':{'name':_0xcce36b(0x193)},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x192),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0xf9),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x11e),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x1f9),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0xd5),'type':_0xcce36b(0x119),'role':_0xcce36b(0x235),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)]('analysis.health.trendDiagnosis',{'type':'state','common':{'name':_0xcce36b(0xdc),'type':'string','role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0xae),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x1a4),'type':_0xcce36b(0x142),'role':_0xcce36b(0x143),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x232)](_0xcce36b(0x162),{'type':_0xcce36b(0x104),'common':{'name':'Energy\x20Intelligence'},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x1c4),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0xda),'type':'string','role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x17e),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x115),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x232)](_0xcce36b(0xcb),{'type':_0xcce36b(0x104),'common':{'name':'LTM'},'native':{}}),await _0x395722[_0xcce36b(0x232)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0xcce36b(0x225),'type':'string','role':_0xcce36b(0x18c),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x232)](LTM_DP_DAILY_DIGESTS,{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x233),'type':'string','role':_0xcce36b(0x18c),'read':!![],'write':![]},'native':{}}),await _0x395722['setObjectNotExistsAsync'](_0xcce36b(0x179),{'type':_0xcce36b(0x1da),'common':{'name':'Sequences','type':_0xcce36b(0xd3),'role':_0xcce36b(0x18c),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0xba),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x134),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x18c),'read':!![],'write':![]},'native':{}}),await _0x395722['setObjectNotExistsAsync']('analysis.trigger',{'type':'state','common':{'name':_0xcce36b(0x187),'type':_0xcce36b(0x119),'role':_0xcce36b(0x177),'read':!![],'write':!![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x1cd),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x1a7),'type':_0xcce36b(0x119),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x1e8),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x251),'type':'boolean','role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)]('analysis.alertReason',{'type':_0xcce36b(0x1da),'common':{'name':'Alert\x20Reason','type':_0xcce36b(0xd3),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x149),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0xb5),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x1d0),{'type':_0xcce36b(0x1da),'common':{'name':'Pattern\x20Detected','type':_0xcce36b(0x119),'role':_0xcce36b(0x235),'read':!![],'write':![]},'native':{}}),await _0x395722['setObjectNotExistsAsync']('analysis.automation.description',{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x1c3),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x194),{'type':'state','common':{'name':_0xcce36b(0x1b3),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x168),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x12a),'type':_0xcce36b(0xd3),'role':_0xcce36b(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x214),{'type':_0xcce36b(0x1da),'common':{'name':_0xcce36b(0x199),'type':_0xcce36b(0x119),'role':_0xcce36b(0x22d),'read':!![],'write':!![]},'native':{}}),await _0x395722[_0xcce36b(0x17b)](_0xcce36b(0x121),{'type':_0xcce36b(0x1da),'common':{'name':'Trigger\x20Action','type':_0xcce36b(0x119),'role':'button','read':!![],'write':!![]},'native':{}});}async function recordThermodynamics(_0x57ec72,_0x4a1e0f,_0x2d2b9c,_0x2fa57d){const _0x5bf680=a0_0x1e9089,_0x280d89=await getOutsideTemperatureNumeric(_0x57ec72),_0x17600c=await _0x57ec72[_0x5bf680(0x15b)](_0x5bf680(0xba));let _0x2414c2=[];if(_0x17600c&&_0x17600c[_0x5bf680(0x21b)])try{_0x2414c2=JSON['parse'](_0x17600c[_0x5bf680(0x21b)]);}catch(_0x485437){}_0x2414c2['push']({'ts':Date[_0x5bf680(0x23c)](),'room':_0x2fa57d||_0x5bf680(0xdf),'t_in':_0x2d2b9c,'t_out':_0x280d89});if(_0x2414c2[_0x5bf680(0xc0)]>THERMO_LOG_SIZE)_0x2414c2['shift']();await _0x57ec72[_0x5bf680(0x1f5)](_0x5bf680(0xba),{'val':JSON[_0x5bf680(0x184)](_0x2414c2),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x5cde3c){const _0x2f0293=a0_0x1e9089;if(_0x5cde3c[_0x2f0293(0x23e)][_0x2f0293(0x1d1)])try{const _0x364af2=await _0x5cde3c[_0x2f0293(0xea)](_0x5cde3c[_0x2f0293(0x23e)][_0x2f0293(0x1d1)]);if(_0x364af2&&_0x364af2[_0x2f0293(0x21b)]!==undefined&&_0x364af2[_0x2f0293(0x21b)]!==null)return parseFloat(_0x364af2[_0x2f0293(0x21b)]);}catch(_0x21f025){}return null;}async function recordSequence(_0x46fed6,_0x4009fc){const _0x4a6dba=a0_0x1e9089,_0x868d54=(_0x4009fc[_0x4a6dba(0x10a)]||'')[_0x4a6dba(0x188)](),_0x5925e7=[_0x4a6dba(0x1be),_0x4a6dba(0x11f),_0x4a6dba(0x189),_0x4a6dba(0x174),_0x4a6dba(0x125),'door',_0x4a6dba(0x123),_0x4a6dba(0x230),_0x4a6dba(0x1f4),'contact','kontakt',_0x4a6dba(0x140),_0x4a6dba(0xd2),_0x4a6dba(0x22d),'schalter',_0x4a6dba(0x25b),_0x4a6dba(0x20a)];if(!_0x5925e7[_0x4a6dba(0xcc)](_0x2f0f97=>_0x868d54[_0x4a6dba(0x13d)](_0x2f0f97)))return;if(!_0x4009fc[_0x4a6dba(0x143)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x4a6dba(0x157)]({'loc':_0x4009fc[_0x4a6dba(0x256)]||_0x4a6dba(0xdf),'id':_0x4009fc['id'],'ts':Date['now']()}),_0x46fed6['log'][_0x4a6dba(0xc9)](_0x4a6dba(0x220)+_0x4009fc[_0x4a6dba(0x256)]+_0x4a6dba(0xbf)+activeSequence[_0x4a6dba(0xc0)]+')'),sequenceTimer=setTimeout(async()=>{const _0x38702f=_0x4a6dba;if(activeSequence[_0x38702f(0xc0)]>0x1)await saveCompletedSequence(_0x46fed6);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x23d56e){const _0x36eee6=a0_0x1e9089;try{const _0x58f0b4=await _0x23d56e[_0x36eee6(0x15b)](_0x36eee6(0x179));let _0x577e30=[];if(_0x58f0b4&&_0x58f0b4[_0x36eee6(0x21b)])try{_0x577e30=JSON[_0x36eee6(0x14c)](_0x58f0b4['val']);}catch(_0x3f75ca){}const _0x337d4c=activeSequence[0x0]['ts'],_0x531000=activeSequence['map'](_0x56601a=>({'loc':_0x56601a['loc'],'t_delta':Math['round']((_0x56601a['ts']-_0x337d4c)/0x3e8)})),_0x281e68={'timestamp':new Date(_0x337d4c)[_0x36eee6(0x208)](),'steps':_0x531000,'duration':Math[_0x36eee6(0x1ba)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x337d4c)/0x3e8),'daytime':new Date(_0x337d4c)[_0x36eee6(0x1f2)]()};_0x577e30[_0x36eee6(0x157)](_0x281e68);if(_0x577e30['length']>MAX_TRAINING_SET_SIZE)_0x577e30[_0x36eee6(0x118)]();await _0x23d56e['setStateAsync'](_0x36eee6(0x179),{'val':JSON[_0x36eee6(0x184)](_0x577e30),'ack':!![]}),runSecurityCheck(_0x23d56e,_0x281e68);}catch(_0x589e72){_0x23d56e[_0x36eee6(0x21d)][_0x36eee6(0x20b)](_0x36eee6(0xb4)+_0x589e72[_0x36eee6(0x17f)]);}}function runSecurityCheck(_0xa8ad74,_0x8b61d2){const _0x2e5cc5=a0_0x1e9089;if(!_0xa8ad74[_0x2e5cc5(0x1ce)])return;_0xa8ad74[_0x2e5cc5(0x21d)]['debug'](_0x2e5cc5(0x1e5)),sendToPython(_0xa8ad74,_0x2e5cc5(0x133),{'sequence':_0x8b61d2});}async function processSensorEvent(_0x1a74c5,_0x1b7e58,_0x8371d2,_0x408c67){const _0x547f3b=a0_0x1e9089;if(!_0x408c67)return;const _0x1d7eca=_0x8371d2['val'],_0x4f1e06=Date[_0x547f3b(0x23c)](),_0x2f7957=_0x1a74c5[_0x547f3b(0x153)][_0x1b7e58];_0x1a74c5[_0x547f3b(0x153)][_0x1b7e58]=_0x1d7eca;if(!_0x408c67[_0x547f3b(0xe8)]&&_0x2f7957!=undefined&&_0x2f7957==_0x1d7eca)return;const _0x394f14=(_0x408c67[_0x547f3b(0x10a)]||'')[_0x547f3b(0x188)](),_0x1126ac=_0x394f14['includes'](_0x547f3b(0xd6))||_0x394f14[_0x547f3b(0x13d)]('temperatur')||_0x394f14[_0x547f3b(0x13d)](_0x547f3b(0x139))||_0x394f14[_0x547f3b(0x13d)](_0x547f3b(0x110));_0x1a74c5['isProVersion']&&_0x1126ac&&recordThermodynamics(_0x1a74c5,_0x1b7e58,_0x1d7eca,_0x408c67['location']);const _0x5a2344={'timestamp':_0x4f1e06,'id':_0x1b7e58,'name':_0x408c67[_0x547f3b(0x1ac)],'type':_0x408c67['type'],'location':_0x408c67['location'],'value':_0x1d7eca};_0x1a74c5[_0x547f3b(0x137)][_0x547f3b(0x127)](_0x5a2344);if(_0x1a74c5[_0x547f3b(0x137)][_0x547f3b(0xc0)]>HISTORY_MAX_SIZE)_0x1a74c5[_0x547f3b(0x137)][_0x547f3b(0x163)]();await _0x1a74c5[_0x547f3b(0x1f5)](_0x547f3b(0x16f),{'val':JSON[_0x547f3b(0x184)](_0x5a2344),'ack':!![]}),await _0x1a74c5[_0x547f3b(0x1f5)]('events.history',{'val':JSON[_0x547f3b(0x184)](_0x1a74c5[_0x547f3b(0x137)]),'ack':!![]});_0x1a74c5[_0x547f3b(0x1ce)]&&(_0x1a74c5[_0x547f3b(0x1e2)][_0x547f3b(0x157)](_0x5a2344),await saveRawEventLog(_0x1a74c5),recordSequence(_0x1a74c5,_0x5a2344));if(_0x408c67[_0x547f3b(0x244)]&&_0x1d7eca===!![]){if(_0x1a74c5['isPresent']&&!_0x1a74c5['isGracePeriodActive'])startExitTimer(_0x1a74c5);else{if(!_0x1a74c5[_0x547f3b(0x22f)])setPresence(_0x1a74c5,!![]);}}else{if(_0x408c67[_0x547f3b(0x10a)]==='motion'&&_0x1d7eca===!![]){if(_0x1a74c5['exitTimer'])abortExitTimer(_0x1a74c5);if(!_0x1a74c5['isPresent']&&_0x1a74c5[_0x547f3b(0x1fb)]===SYSTEM_MODES[_0x547f3b(0x14f)])setPresence(_0x1a74c5,!![]);}}}function installPythonDependencies(_0x1d8d29){const _0x5db225=a0_0x1e9089;if(_0x1d8d29[_0x5db225(0x200)])return;_0x1d8d29['dependencyInstallInProgress']=!![];const _0x54dc63=path[_0x5db225(0x1f6)](__dirname,_0x5db225(0xe6),_0x5db225(0x231));_0x1d8d29['log']['info'](_0x5db225(0x151)),stopPythonService(_0x1d8d29);if(fs['existsSync'](VENV_PATH)){if(!fs[_0x5db225(0x1eb)](PIP_EXE)){_0x1d8d29[_0x5db225(0x21d)][_0x5db225(0x24b)](_0x5db225(0x13b));try{fs['rmSync'](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x3280e4){}}}!fs[_0x5db225(0x1eb)](VENV_PATH)?exec('python3\x20-m\x20venv\x20\x22'+VENV_PATH+'\x22',_0x771bea=>{const _0x5a0e24=_0x5db225;if(_0x771bea){_0x1d8d29[_0x5a0e24(0x21d)][_0x5a0e24(0x20b)](_0x5a0e24(0x221)),_0x1d8d29[_0x5a0e24(0x200)]=![];return;}installRequirementsInVenv(_0x1d8d29,_0x54dc63);}):installRequirementsInVenv(_0x1d8d29,_0x54dc63);}function installRequirementsInVenv(_0x26389d,_0x1fb694){const _0x36657e=a0_0x1e9089;_0x26389d['log'][_0x36657e(0x207)](_0x36657e(0x1b7));const _0x1dbc91='\x22'+PIP_EXE+_0x36657e(0x21c)+_0x1fb694+'\x22';exec(_0x1dbc91,{'timeout':0x124f80,'maxBuffer':0x400*0x400*0x32},_0x394202=>{const _0x5a2d00=_0x36657e;_0x26389d[_0x5a2d00(0x200)]=![],_0x394202?_0x26389d['log']['error'](_0x5a2d00(0x128)+_0x394202[_0x5a2d00(0x17f)]):(_0x26389d['log'][_0x5a2d00(0x207)](_0x5a2d00(0x1cf)),startPythonService(_0x26389d));});}function startPythonService(_0x4c8954){const _0x24c50f=a0_0x1e9089;if(_0x4c8954[_0x24c50f(0x200)])return;let _0x985465=_0x24c50f(0x10c);if(fs['existsSync'](PYTHON_EXE))_0x4c8954[_0x24c50f(0x21d)][_0x24c50f(0x207)](_0x24c50f(0xc5)+PYTHON_EXE),_0x985465=PYTHON_EXE;else{_0x4c8954[_0x24c50f(0x21d)][_0x24c50f(0x24b)](_0x24c50f(0xca)),installPythonDependencies(_0x4c8954);return;}try{const _0x5e2255=path['join'](__dirname,_0x24c50f(0xe6),_0x24c50f(0xef));_0x4c8954[_0x24c50f(0x246)]=spawn(_0x985465,[_0x5e2255]),_0x4c8954[_0x24c50f(0x246)][_0x24c50f(0x25c)]['on'](_0x24c50f(0x1b6),_0x489c08=>{const _0x12ea16=_0x24c50f,_0xeb133=_0x489c08[_0x12ea16(0x1e4)]()[_0x12ea16(0x17c)]('\x0a');_0xeb133[_0x12ea16(0x1fa)](_0x1ee6ba=>{const _0x18ce62=_0x12ea16,_0x513aea=_0x1ee6ba[_0x18ce62(0x1bc)]();if(!_0x513aea)return;if(_0x513aea[_0x18ce62(0x1ae)]('[LOG]'))_0x4c8954[_0x18ce62(0x21d)][_0x18ce62(0xc9)](_0x18ce62(0x224)+_0x513aea[_0x18ce62(0x159)](0x5)['trim']());else{if(_0x513aea[_0x18ce62(0x1ae)]('[RESULT]'))try{const _0x306a00=JSON[_0x18ce62(0x14c)](_0x513aea[_0x18ce62(0x159)](0x8)[_0x18ce62(0x1bc)]());handlePythonResult(_0x4c8954,_0x306a00);}catch(_0x341df1){_0x4c8954[_0x18ce62(0x21d)]['warn'](_0x18ce62(0x19b)+_0x513aea);}}(_0x513aea['includes'](_0x18ce62(0x202))||_0x513aea[_0x18ce62(0x13d)](_0x18ce62(0x13e)))&&(_0x4c8954[_0x18ce62(0x21d)][_0x18ce62(0x24b)](_0x18ce62(0x113)),installPythonDependencies(_0x4c8954));});}),_0x4c8954['pythonProcess'][_0x24c50f(0x1a6)]['on'](_0x24c50f(0x1b6),_0x2c7da2=>{const _0x539eb2=_0x24c50f,_0x2e77ae=_0x2c7da2['toString']()[_0x539eb2(0x1bc)]();if(!_0x2e77ae['includes'](_0x539eb2(0x120)))_0x4c8954[_0x539eb2(0x21d)]['error'](_0x539eb2(0xf8)+_0x2e77ae);}),_0x4c8954['pythonProcess']['on'](_0x24c50f(0x16a),_0x2fc1a4=>{const _0x41233c=_0x24c50f;_0x4c8954[_0x41233c(0x21d)][_0x41233c(0x207)]('[PYTHON]\x20Exited\x20code\x20'+_0x2fc1a4),_0x4c8954[_0x41233c(0x246)]=null;});}catch(_0x104bc8){_0x4c8954['log'][_0x24c50f(0x20b)](_0x24c50f(0x195)+_0x104bc8[_0x24c50f(0x17f)]);}}function stopPythonService(_0x303459){const _0x11cea1=a0_0x1e9089;if(_0x303459[_0x11cea1(0x246)]){_0x303459[_0x11cea1(0x21d)]['info']('üêç\x20Stopping\x20Python...');try{_0x303459[_0x11cea1(0x246)][_0x11cea1(0x191)]();}catch(_0xeebeb6){}_0x303459['pythonProcess']=null;}}function handlePythonResult(_0x48834e,_0x499f5f){const _0x2293cb=a0_0x1e9089;if(_0x499f5f[_0x2293cb(0x10a)]===_0x2293cb(0x141))_0x48834e[_0x2293cb(0x21d)][_0x2293cb(0xc9)](_0x2293cb(0xc7));else{if(_0x499f5f[_0x2293cb(0x10a)]===_0x2293cb(0xf3)){const {anomaly_score:_0xf8341e,is_anomaly:_0x6f7e7,threshold:_0x454c46}=_0x499f5f[_0x2293cb(0x135)];_0x48834e[_0x2293cb(0x21d)]['info']('üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20'+_0xf8341e[_0x2293cb(0xb7)](0x5)+_0x2293cb(0x24a)+(_0x6f7e7?_0x2293cb(0x14b):'OK')),_0x48834e[_0x2293cb(0x1f5)](_0x2293cb(0x1bf),{'val':_0xf8341e,'ack':!![]}),_0x48834e[_0x2293cb(0x1f5)]('analysis.security.lastCheck',{'val':new Date()[_0x2293cb(0x208)](),'ack':!![]});if(_0x6f7e7){const _0x4efd10=_0x2293cb(0x250)+_0xf8341e[_0x2293cb(0xb7)](0x4)+')';_0x48834e['setStateAsync'](_0x2293cb(0x1e8),{'val':!![],'ack':!![]}),_0x48834e[_0x2293cb(0x1f5)]('analysis.alertReason',{'val':_0x4efd10,'ack':!![]}),sendNotification(_0x48834e,_0x2293cb(0x182)+_0x4efd10,![],!![]);}}else{if(_0x499f5f[_0x2293cb(0x10a)]==='TRAINING_COMPLETE'){const {success:_0x301239,details:_0x1094ef}=_0x499f5f[_0x2293cb(0x135)];_0x48834e[_0x2293cb(0x1f5)](_0x2293cb(0x1db),{'val':_0x301239?'Success:\x20'+new Date()[_0x2293cb(0x148)]()+'\x20('+_0x1094ef+')':'Failed:\x20'+_0x1094ef,'ack':!![]});}else{if(_0x499f5f[_0x2293cb(0x10a)]==='ENERGY_TRAIN_RESULT'){const {success:_0x48e308,details:_0x50d63c}=_0x499f5f[_0x2293cb(0x135)];if(_0x48e308)try{const _0x2d4672=JSON[_0x2293cb(0x14c)](_0x50d63c);if(_0x2d4672[_0x2293cb(0x150)])_0x48834e[_0x2293cb(0x1f5)]('analysis.energy.insulationScore',{'val':JSON[_0x2293cb(0x184)](_0x2d4672[_0x2293cb(0x150)]),'ack':!![]});if(_0x2d4672[_0x2293cb(0x24d)])_0x48834e['setStateAsync']('analysis.energy.heatingScore',{'val':JSON[_0x2293cb(0x184)](_0x2d4672['heating']),'ack':!![]});}catch(_0x1e9b0c){}}else{if(_0x499f5f['type']===_0x2293cb(0x103)){const {success:_0x1a3ea2,details:_0x429598}=_0x499f5f[_0x2293cb(0x135)];if(_0x1a3ea2)_0x48834e['log'][_0x2293cb(0x207)]('‚úÖ\x20HEALTH\x20TRAINED:\x20'+_0x429598);}else{if(_0x499f5f[_0x2293cb(0x10a)]===_0x2293cb(0x101)){const {is_anomaly:_0x29e9dd,details:_0x42585d}=_0x499f5f[_0x2293cb(0x135)];_0x48834e[_0x2293cb(0x1f5)](_0x2293cb(0x192),{'val':new Date()[_0x2293cb(0x208)](),'ack':!![]}),_0x48834e[_0x2293cb(0x1f5)]('analysis.health.isAnomaly',{'val':_0x29e9dd,'ack':!![]});}}}}}}}function sendToPython(_0x3f0f26,_0x399af0,_0x323c73={}){const _0x184535=a0_0x1e9089;if(!_0x3f0f26[_0x184535(0x246)]||!_0x3f0f26[_0x184535(0x246)][_0x184535(0x238)][_0x184535(0x12b)])return;const _0x4e70fb=JSON[_0x184535(0x184)]({'command':_0x399af0,..._0x323c73});try{_0x3f0f26['pythonProcess'][_0x184535(0x238)][_0x184535(0xf7)](_0x4e70fb+'\x0a');}catch(_0x47d400){}}async function runGeminiAnalysis(_0x31ceff,_0x10d594=''){const _0x2130da=a0_0x1e9089;if(!_0x31ceff[_0x2130da(0x1e6)])return;if(_0x31ceff[_0x2130da(0x137)][_0x2130da(0xc0)]===0x0)return;const _0x5efa38=_0x31ceff[_0x2130da(0x137)][_0x2130da(0x1fd)](0x0,0xf),_0x1c9f5a=await getWeatherContext(_0x31ceff),_0x3c0867=_0x31ceff['currentSystemMode'],_0x584b99=PERSONA_MAPPING[_0x31ceff[_0x2130da(0x23e)]['aiPersona']||_0x2130da(0x215)],_0x238d51=_0x31ceff['config'][_0x2130da(0xb8)]||_0x2130da(0x1e0);let _0x352e31=_0x2130da(0x16d);try{const _0x3958af=await _0x31ceff[_0x2130da(0x15b)](_0x2130da(0x242));if(_0x3958af&&_0x3958af[_0x2130da(0x21b)])_0x352e31=_0x3958af[_0x2130da(0x21b)];}catch(_0x3decf8){}let _0x31f60d=![];try{const _0x56bda9=await _0x31ceff[_0x2130da(0x15b)](_0x2130da(0x214));if(_0x56bda9&&_0x56bda9['val'])_0x31f60d=!![];}catch(_0x39dde3){}const _0x3d807a='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x584b99+_0x2130da(0x1bb)+_0x238d51+_0x2130da(0x13c)+_0x3c0867+'.\x20WETTER:\x20'+_0x1c9f5a+'.\x20ANWESEND:\x20'+_0x352e31+_0x2130da(0x20d)+JSON['stringify'](_0x5efa38)+_0x2130da(0xed)+_0x10d594+_0x2130da(0x1fe);try{const _0x273c30=await _0x31ceff['geminiModel'][_0x2130da(0x131)](_0x3d807a),_0x234ece=_0x273c30[_0x2130da(0x1a8)][_0x2130da(0x1b9)]()['replace'](/```json|```/g,'')[_0x2130da(0x1bc)](),_0x50eb53=JSON['parse'](_0x234ece);await _0x31ceff[_0x2130da(0x1f5)](_0x2130da(0x15a),{'val':JSON[_0x2130da(0x184)](_0x50eb53),'ack':!![]});if(_0x50eb53['summary'])await _0x31ceff[_0x2130da(0x1f5)](_0x2130da(0x149),{'val':_0x50eb53[_0x2130da(0xc1)],'ack':!![]});const _0x5d41db={'timestamp':Date['now'](),'id':Date[_0x2130da(0x23c)]()['toString'](),'analysis':{'activity':{'summary':_0x50eb53[_0x2130da(0xc1)],'isAlert':_0x50eb53[_0x2130da(0x210)],'alertReason':_0x50eb53['alertReason']},'comfort':{'automationProposal':_0x50eb53['automationProposal']}}};await updateAnalysisHistory(_0x31ceff,_0x5d41db);const _0x34090e=_0x50eb53[_0x2130da(0x210)]||![];_0x34090e!==_0x31ceff[_0x2130da(0x196)]&&(await _0x31ceff[_0x2130da(0x1f5)](_0x2130da(0x1e8),{'val':_0x34090e,'ack':!![]}),_0x31ceff['lastAlertState']=_0x34090e,_0x34090e&&(await _0x31ceff[_0x2130da(0x1f5)](_0x2130da(0xe0),{'val':_0x50eb53[_0x2130da(0xe2)],'ack':!![]}),sendNotification(_0x31ceff,_0x2130da(0x237)+_0x50eb53[_0x2130da(0xe2)],![],_0x50eb53[_0x2130da(0x108)])));if(_0x50eb53[_0x2130da(0x14e)]&&_0x50eb53['automationProposal'][_0x2130da(0x1b8)]){await _0x31ceff['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x31ceff['setStateAsync'](_0x2130da(0x229),{'val':_0x50eb53[_0x2130da(0x14e)][_0x2130da(0x185)],'ack':!![]}),await _0x31ceff[_0x2130da(0x1f5)]('analysis.automation.targetId',{'val':_0x50eb53[_0x2130da(0x14e)][_0x2130da(0x21e)],'ack':!![]}),await _0x31ceff[_0x2130da(0x1f5)](_0x2130da(0x168),{'val':JSON[_0x2130da(0x184)](_0x50eb53[_0x2130da(0x14e)][_0x2130da(0x106)]),'ack':!![]});if(_0x31f60d)executeAutomationAction(_0x31ceff);}}catch(_0x3c4497){_0x31ceff['log'][_0x2130da(0x20b)]('Gemini\x20Error:\x20'+_0x3c4497[_0x2130da(0x17f)]);}}async function createDailyDigest(_0x3f4c11){const _0x35810c=a0_0x1e9089;if(!_0x3f4c11['isProVersion'])return;await _0x3f4c11[_0x35810c(0x1f5)](LTM_DP_STATUS,{'val':_0x35810c(0x1f3),'ack':!![]});if(!_0x3f4c11[_0x35810c(0x1e6)]||_0x3f4c11['rawEventLog'][_0x35810c(0xc0)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3f4c11[_0x35810c(0x1f5)](LTM_DP_STATUS,{'val':_0x35810c(0x10d),'ack':!![]});return;}const _0x1c1b23=JSON['parse'](JSON[_0x35810c(0x184)](_0x3f4c11[_0x35810c(0x1e2)])),_0x4d4e9a=_0x1c1b23[_0x35810c(0xc0)],_0x452a24='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON['stringify'](_0x1c1b23);try{const _0x51ae8b=await _0x3f4c11[_0x35810c(0x1e6)][_0x35810c(0x131)](_0x452a24),_0x1e34d6=JSON['parse'](_0x51ae8b[_0x35810c(0x1a8)][_0x35810c(0x1b9)]()[_0x35810c(0x1c8)](/```json|```/g,'')[_0x35810c(0x1bc)]()),_0x548594={'timestamp':new Date()[_0x35810c(0x208)](),'eventCount':_0x4d4e9a,'summary':_0x1e34d6['summary']||_0x35810c(0x158),'activityLevel':_0x1e34d6[_0x35810c(0x236)]||_0x35810c(0x258),'systemMode':_0x3f4c11[_0x35810c(0x1fb)]};_0x3f4c11[_0x35810c(0x161)][_0x35810c(0x157)](_0x548594),await saveDailyDigests(_0x3f4c11),_0x3f4c11[_0x35810c(0x1e2)]=[],await saveRawEventLog(_0x3f4c11),await _0x3f4c11[_0x35810c(0x1f5)](LTM_DP_STATUS,{'val':_0x35810c(0x243),'ack':!![]});if(_0x3f4c11['isProVersion'])sendToPython(_0x3f4c11,'ANALYZE_HEALTH',{'digest':_0x548594});}catch(_0x65cc13){_0x3f4c11[_0x35810c(0x21d)]['error'](_0x65cc13['message']);}}function setupLtmScheduler(_0x5c6d62){const _0x394af4=a0_0x1e9089;try{if(_0x5c6d62['ltmJob'])_0x5c6d62[_0x394af4(0x239)][_0x394af4(0x227)]();if(!_0x5c6d62[_0x394af4(0x1ce)])return;_0x5c6d62[_0x394af4(0x239)]=schedule[_0x394af4(0x1e1)](LTM_SCHEDULE,()=>createDailyDigest(_0x5c6d62));}catch(_0x3de98c){_0x5c6d62[_0x394af4(0x21d)][_0x394af4(0x20b)]('LTM\x20Sched\x20Error:\x20'+_0x3de98c[_0x394af4(0x17f)]);}}function setupModeResetScheduler(_0x135272){const _0xef803b=a0_0x1e9089;try{if(_0x135272[_0xef803b(0x172)])_0x135272[_0xef803b(0x172)]['cancel']();_0x135272[_0xef803b(0x172)]=schedule[_0xef803b(0x1e1)](MODE_RESET_SCHEDULE,async()=>{const _0x1957af=_0xef803b;await loadSystemMode(_0x135272),AUTO_RESET_MODES[_0x1957af(0x13d)](_0x135272[_0x1957af(0x1fb)])&&await _0x135272[_0x1957af(0x1f5)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1957af(0x14f)],'ack':![]});});}catch(_0xfb2a6c){_0x135272[_0xef803b(0x21d)][_0xef803b(0x20b)](_0xef803b(0xde)+_0xfb2a6c['message']);}}function a0_0x1873(){const _0x108ea9=['setForeignStateAsync','\x20=\x20','scanDevices','dailyDigests','analysis.energy','pop','aiPersona','Analysiere\x20ausgewogen.','TRAIN_ENERGY','apply','analysis.automation.targetValue','from','close','maintenance','Deaktiviert\x20(Pro-Feature)','Unbekannt','callback','events.lastEvent','WiFi\x20Presence\x20detected.','GUEST','modeResetJob','bin','presence','N/A','devices','button','.\x20ZUSATZ:\x20','LTM.trainingData.sequences','path','setObjectNotExistsAsync','split','namespace','analysis.energy.heatingScore','message','indexOf','shutter','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','baselineDrift','stringify','description','city','Trigger\x20Analysis','toLowerCase','pr√§senz','brightness','currentposition','json','driftAnalysisTimer','exitTimer','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Vom\x20Benutzer\x20best√§tigt\x20(OK).','kill','analysis.health.lastCheck','Health\x20Analysis','analysis.automation.targetId','Error\x20launching\x20Python:\x20','lastAlertState','party','subscribeForeignStatesAsync','Auto\x20Apply','Err:\x20','Invalid\x20JSON:\x20','simulateButler','Drift\x20Sched\x20Error:\x20','apiKey','targetposition','licenseKey','dismissAutomation','sort','testApiKey','Trend\x20Value','sleepScore','stderr','Trigger\x20Briefing','response','find','COGNI_CONFIRM_OK','COGNI_REQUEST_CALL','name','fill','startsWith','briefingTime','useCalendar','scriptEnabled','Adapter','Target\x20ID','firmware','.\x20DATEN:\x20Schlaf\x20','data','Installing\x20dependencies\x20into\x20venv...','detected','text','round','.\x20KONTEXT:\x20','trim','VACATION','motion','analysis.security.lastScore','systemConfig','stick_unreach','Kalender:\x20Deaktiviert','Description','analysis.energy.insulationScore','08:00','briefingEnabled','power','replace','search','cogni-living','position','@google/generative-ai','analysis.triggerBriefing','isProVersion','‚úÖ\x20INFRASTRUCTURE\x20READY.\x20Starting\x20Service...','analysis.automation.patternDetected','outdoorSensorId','Lernphase\x20(','briefingJob','.communicate.request','Kein\x20API\x20Key!','N/A\x20(Learning)','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','analysis.health','analysis.trigger','state','analysis.training.status','\x20*\x20*\x20*','dutycycle','setState','1788867OlWGYq','Keine\x20Details.','scheduleJob','rawEventLog','\x20Tage)','toString','üõ°Ô∏è\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','geminiModel','energy','analysis.isAlert','models/gemini-flash-latest','instance','existsSync','552632HSjELO','notifyTelegramInstance','link_quality','Keine\x20Termine','Briefing\x20Error:\x20','Train\x20Health','getHours','Started...','fenster','setStateAsync','join','PARTY','System','analysis.health.isAnomaly','forEach','currentSystemMode','command','slice','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','version','dependencyInstallInProgress','Gemini\x20Init\x20Error:\x20','No\x20module\x20named','system.','134064boXMjJ','(((.+)+)+)+$','filter','info','toISOString','pip','lampe','error','reachable','.\x20EVENTS:\x20','analysis.training.triggerHealth','object','isAlert','testContext','getOverviewData','onMessage','analysis.automation.autoApply','generic','LTM.driftAnalysis.baselineDrift','Kein\x20API\x20Key.','pip.exe','latitude','_calName','val','\x22\x20install\x20-r\x20\x22','log','targetId','cover','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','‚ùå\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv','blind','analysis.security.lastCheck','[PYTHON]\x20','Raw\x20Log','getGenerativeModel','cancel','presenceDevices','analysis.automation.description','onReady','onUnload','online','switch','info.','isPresent','window','requirements.txt','extendObjectAsync','Daily\x20Digests','geminiApiKey','indicator','activityLevel','‚ö†Ô∏è\x20ALARM:\x20','stdin','ltmJob','off','82026JOtDoh','now','python.exe','config','analysis.training.triggerSecurity','analysisTimer','Restoring\x20sensor\x20cache\x20from\x20history\x20(','system.presenceWho','Success','isExit','automation.triggerAction','pythonProcess','analysis.analysisHistory','No\x20instance','ltmLtbWindowDays','\x20->\x20','warn','onStateChange','heating','python','LTM.triggerDailyDigest','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','Alert\x20Status','javascript.','Activity-Level','triggerDailyDigest','analysis.training.triggerEnergy','location','submitFeedback','normal','child_process','930756zwoWRu','dimmer','stdout','delObjectAsync','events.history','Generating\x20Morning\x20Briefing...','analysis.health.trendValue','exports','getForeignObjectsAsync','ANALYZE_TREND','system.isPresent','rssi','[RECORDER]\x20Error\x20saving\x20sequence:\x20','Activity\x20Summary','690610vbRmIR','toFixed','livingContext','üß™\x20Simulating\x20Butler\x20Proposal:\x20','LTM.trainingData.thermodynamics','TRAIN_HEALTH','enum','0\x204\x20*\x20*\x20*','status','\x20(Length:\x20','length','summary','KALENDER:\x20','actual_temperature','history.','üêç\x20Using\x20VENV\x20Python:\x20','calendarInstance','üêç\x20Python\x20Pong','guest','debug','‚ö†Ô∏è\x20VENV\x20missing.\x20Attempting\x20install...','LTM','some','Scripts','\x20events)...','values','LTM.processingStatus','simple-api.','licht','string','ltmStbWindowDays','Anomaly\x20Detected','temperature','üåÖ\x20Daily\x20Briefing:\x0a','Feedback:\x20','Anomaly\x20Score','Insulation\x20Score','56QBHMsG','Trend','.data.table','Reset\x20Sched\x20Error:\x20','Unknown','analysis.alertReason','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','alertReason','telegram','Event\x20History','getEnums','python_service','sendTo','logDuplicates','common','getForeignStateAsync','valve','LTM.baselineStatus','.\x20EMERGENCY:\x20','KI-Modell\x20nicht\x20initialisiert','service.py','3PuoSiX','analysisHistory','Who\x20is\x20present?','SECURITY_RESULT','getForeignObjectAsync','Missing\x20data','LTM.driftAnalysis.lastCheck','write','[PYTHON\x20ERR]\x20','Last\x20Check','map','analysisInterval','Training\x20Error:\x20','ack','cogni-living\x20adapter\x20starting\x20(v','Briefing\x20Sched\x20Error:\x20','PRIORIT√ÑT:\x20Sicherheit.','HEALTH_RESULT','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','HEALTH_TRAIN_RESULT','channel','159782fbkWFh','targetValue','connection','isEmergency','minDaysForBaseline','type','üß†\x20Triggering\x20Security\x20Training...','python3','Skipped\x20(No\x20AI\x20or\x20Data)','communicate.request','triggerBriefing','heizung','timestamp','set_temperature','‚ö†Ô∏è\x20Python\x20missing\x20libs.\x20Auto-Install\x20triggered.','Security\x20Monitor','Heating\x20Score','isArray','config_pending','shift','boolean','setpoint','System\x20Mode','inactivityThresholdHours','material.','date','bewegung','cpu_feature_guard','analysis.automation.triggerAction','LTM.rawEventLog','t√ºr','exitGraceTimer','occupancy','unknown','unshift','‚ùå\x20PIP\x20INSTALL\x20FAILED:\x20','systemUUID','Target\x20Value','writable','flot.','ical.0','unreach','win32','PRIORIT√ÑT:\x20Gesundheit/AAL.','generateContent','echarts.','ANALYZE_SEQUENCE','Thermodynamics','payload','getTime','eventHistory','Training\x20Status','klima','Last\x20raw\x20event','‚ö†Ô∏è\x20Broken\x20venv\x20detected.\x20Repairing...','.\x20SYSTEM_MODE:\x20','includes','Bibliotheken\x20nicht\x20gefunden','@iobroker/adapter-core','light','PONG','number','value','Train\x20Energy','bind','uuid','getFullYear','toLocaleTimeString','analysis.activitySummary','subscribeStates','ANOMALY','parse','.venv','automationProposal','NORMAL','insulation','üõ†Ô∏è\x20MAINTENANCE\x20MODE:\x20Installing\x20Python\x20dependencies.\x20Do\x20not\x20restart!','system.config','sensorLastValues','ltmDriftCheckIntervalHours','splice','LTM.driftAnalysis.driftDetails','push','Digest','substring','analysis.lastResult','getStateAsync','system.mode','isGracePeriodActive'];a0_0x1873=function(){return _0x108ea9;};return a0_0x1873();}function setupDriftAnalysisScheduler(_0x32c55c){const _0x3d785c=a0_0x1e9089;try{if(_0x32c55c[_0x3d785c(0x18d)])clearInterval(_0x32c55c['driftAnalysisTimer']);if(!_0x32c55c['isProVersion'])return;_0x32c55c[_0x3d785c(0x18d)]=setInterval(()=>runBaselineDriftAnalysis(_0x32c55c),(_0x32c55c['config'][_0x3d785c(0x154)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x32c55c),0x1388);}catch(_0x41717e){_0x32c55c[_0x3d785c(0x21d)][_0x3d785c(0x20b)](_0x3d785c(0x19d)+_0x41717e[_0x3d785c(0x17f)]);}}function setupBriefingScheduler(_0x1c831f){const _0x4c8f5c=a0_0x1e9089;try{if(_0x1c831f[_0x4c8f5c(0x1d3)])_0x1c831f[_0x4c8f5c(0x1d3)][_0x4c8f5c(0x227)]();if(!_0x1c831f[_0x4c8f5c(0x23e)][_0x4c8f5c(0x1c6)])return;const _0x20937e=(_0x1c831f['config'][_0x4c8f5c(0x1af)]||_0x4c8f5c(0x1c5))['split'](':'),_0x2e9bd9=parseInt(_0x20937e[0x0])||0x8,_0x45ac34=parseInt(_0x20937e[0x1])||0x0,_0x402841=_0x45ac34+'\x20'+_0x2e9bd9+_0x4c8f5c(0x1dc);_0x1c831f[_0x4c8f5c(0x1d3)]=schedule['scheduleJob'](_0x402841,()=>{sendMorningBriefing(_0x1c831f);});}catch(_0x3d05ad){_0x1c831f[_0x4c8f5c(0x21d)][_0x4c8f5c(0x20b)](_0x4c8f5c(0xff)+_0x3d05ad[_0x4c8f5c(0x17f)]);}}async function runBaselineDriftAnalysis(_0x18adbf){const _0x202149=a0_0x1e9089;if(!_0x18adbf[_0x202149(0x1ce)]||!_0x18adbf['geminiModel'])return;const _0x5f0466=_0x18adbf['config']['ltmStbWindowDays']||0xe;if(_0x18adbf[_0x202149(0x161)][_0x202149(0xc0)]<_0x5f0466+0x7){await _0x18adbf[_0x202149(0x1f5)](LTM_DP_DRIFT_STATUS,{'val':_0x202149(0x1d6),'ack':!![]});return;}const _0x2be1c9=_0x18adbf[_0x202149(0x161)][_0x202149(0x1fd)](-_0x5f0466),_0x4f4c69=_0x18adbf[_0x202149(0x161)][_0x202149(0x1fd)](0x0,_0x18adbf['dailyDigests'][_0x202149(0xc0)]-_0x5f0466),_0x4d4d92=_0x202149(0x18f)+JSON['stringify'](_0x4f4c69)+'\x0aSTB:\x20'+JSON['stringify'](_0x2be1c9);try{const _0x4e68bf=await _0x18adbf[_0x202149(0x1e6)]['generateContent'](_0x4d4d92),_0x51b3bf=JSON[_0x202149(0x14c)](_0x4e68bf[_0x202149(0x1a8)][_0x202149(0x1b9)]()[_0x202149(0x1c8)](/```json|```/g,'')[_0x202149(0x1bc)]());_0x51b3bf[_0x202149(0x183)]&&(await _0x18adbf['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x51b3bf[_0x202149(0x183)],'ack':!![]}),await _0x18adbf[_0x202149(0x1f5)](LTM_DP_DRIFT_DETAILS,{'val':_0x51b3bf['driftDetails'],'ack':!![]}),await _0x18adbf['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x202149(0x23c)](),'ack':!![]}));}catch(_0x19024d){}}async function sendMorningBriefing(_0x907c67){const _0x1f5fed=a0_0x1e9089;if(!_0x907c67['geminiModel'])return;_0x907c67['log'][_0x1f5fed(0x207)](_0x1f5fed(0x25f));const _0x1a377d=_0x907c67[_0x1f5fed(0x161)][_0x1f5fed(0xc0)]>0x0?_0x907c67[_0x1f5fed(0x161)][_0x907c67['dailyDigests'][_0x1f5fed(0xc0)]-0x1]:null,_0x1853b4=_0x1a377d&&_0x1a377d['health']?_0x1a377d['health'][_0x1f5fed(0x1a5)]:'N/A',_0x485863=new Date();_0x485863['setHours'](0x4,0x0,0x0,0x0);const _0x1bd9b5=_0x907c67['eventHistory'][_0x1f5fed(0x206)](_0x42a5f9=>new Date(_0x42a5f9[_0x1f5fed(0x111)])>_0x485863),_0x1cee84=PERSONA_MAPPING[_0x907c67[_0x1f5fed(0x23e)][_0x1f5fed(0x164)]||_0x1f5fed(0x215)],_0x180a13=_0x907c67[_0x1f5fed(0x23e)][_0x1f5fed(0xb8)]||'',_0x38bb46=await getWeatherContext(_0x907c67),_0x404b61=await getCalendarContext(_0x907c67),_0x521711='ROLLE:\x20Assistent.\x20AUFGABE:\x20Schreibe\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20'+_0x1cee84+_0x1f5fed(0x1bb)+_0x180a13+_0x1f5fed(0x178)+_0x38bb46+'\x20'+_0x404b61+_0x1f5fed(0x1b5)+_0x1853b4+'/100.\x20OUTPUT:\x20Text.';try{const _0x54261e=await _0x907c67[_0x1f5fed(0x1e6)][_0x1f5fed(0x131)](_0x521711),_0x441437=_0x1f5fed(0xd7)+_0x54261e[_0x1f5fed(0x1a8)][_0x1f5fed(0x1b9)]()[_0x1f5fed(0x1bc)]();sendNotification(_0x907c67,_0x441437);}catch(_0x2bf922){_0x907c67[_0x1f5fed(0x21d)][_0x1f5fed(0x20b)](_0x1f5fed(0x1f0)+_0x2bf922[_0x1f5fed(0x17f)]);}}async function getCalendarNames(_0x5bf48e,_0x588b3f){const _0x1ec535=a0_0x1e9089;try{const _0x11e516=await _0x5bf48e['getForeignStateAsync'](_0x588b3f+_0x1ec535(0xdd));if(_0x11e516&&_0x11e516[_0x1ec535(0x21b)]){const _0x441528=JSON[_0x1ec535(0x14c)](_0x11e516[_0x1ec535(0x21b)]);if(Array[_0x1ec535(0x116)](_0x441528))return[...new Set(_0x441528[_0x1ec535(0xfa)](_0xd1a4f6=>_0xd1a4f6[_0x1ec535(0x21a)])[_0x1ec535(0x206)](Boolean))][_0x1ec535(0x1a2)]();}}catch(_0x2295db){}return[];}async function getCalendarContext(_0x35be72){const _0x1a1f2b=a0_0x1e9089;if(!_0x35be72[_0x1a1f2b(0x23e)][_0x1a1f2b(0x1b0)])return _0x1a1f2b(0x1c2);const _0x4740cc=_0x35be72[_0x1a1f2b(0x23e)][_0x1a1f2b(0xc6)]||_0x1a1f2b(0x12d);try{const _0x5644bb=await _0x35be72[_0x1a1f2b(0xea)](_0x4740cc+_0x1a1f2b(0xdd));if(_0x5644bb&&_0x5644bb['val']){let _0x244dc4=JSON[_0x1a1f2b(0x14c)](_0x5644bb[_0x1a1f2b(0x21b)]);if(Array[_0x1a1f2b(0x116)](_0x244dc4)){if(_0x244dc4[_0x1a1f2b(0xc0)]>0x0)return _0x1a1f2b(0xc2)+_0x244dc4[_0x1a1f2b(0x1fd)](0x0,0x3)[_0x1a1f2b(0xfa)](_0x284343=>_0x284343['event'])[_0x1a1f2b(0x1f6)](',\x20');}}}catch(_0x19a87a){}return _0x1a1f2b(0x1ef);}async function saveFeedback(_0x4f7c92,_0x5b1b20){const _0x54a693=a0_0x1e9089;_0x4f7c92[_0x54a693(0x21d)]['info'](_0x54a693(0xd8)+JSON['stringify'](_0x5b1b20));}async function initSensorSubscriptions(_0x554cc1){const _0x148c5c=a0_0x1e9089,_0x393c30=_0x554cc1[_0x148c5c(0x23e)][_0x148c5c(0x176)];if(_0x393c30)for(const _0x41e7b2 of _0x393c30){await _0x554cc1[_0x148c5c(0x198)](_0x41e7b2['id']);}}async function initPresenceSubscriptions(_0x28fa24){const _0x5d8f12=a0_0x1e9089,_0x3113dc=_0x28fa24[_0x5d8f12(0x23e)][_0x5d8f12(0x228)];if(_0x3113dc)for(const _0x572e9f of _0x3113dc){await _0x28fa24['subscribeForeignStatesAsync'](_0x572e9f);}}async function setupTelegramListener(_0xcc1358){const _0x2b5706=a0_0x1e9089,_0x5c2073=_0xcc1358[_0x2b5706(0x23e)][_0x2b5706(0x1ed)];if(_0xcc1358[_0x2b5706(0x23e)]['notifyTelegramEnabled']&&_0x5c2073)await _0xcc1358[_0x2b5706(0x198)](_0x5c2073+_0x2b5706(0x1d4));}async function checkWifiPresence(_0x449053){const _0x36150b=a0_0x1e9089;try{const _0x17f3d8=_0x449053[_0x36150b(0x23e)]['presenceDevices']||[];let _0x4b52dd=![];const _0x36870f=[];for(const _0x1d69a4 of _0x17f3d8){try{const _0x23aa4a=await _0x449053[_0x36150b(0xea)](_0x1d69a4);_0x23aa4a&&(_0x23aa4a[_0x36150b(0x21b)]===!![]||_0x23aa4a[_0x36150b(0x21b)]===_0x36150b(0x22c)||_0x23aa4a[_0x36150b(0x21b)]===0x1)&&(_0x4b52dd=!![],_0x36870f[_0x36150b(0x157)](_0x1d69a4));}catch(_0x19ac82){}}return await _0x449053['setStateAsync'](_0x36150b(0x242),{'val':_0x36870f['join'](',\x20'),'ack':!![]}),_0x4b52dd&&(_0x449053[_0x36150b(0x18e)]&&(_0x449053[_0x36150b(0x21d)][_0x36150b(0x207)](_0x36150b(0x170)),abortExitTimer(_0x449053)),!_0x449053['isPresent']&&_0x449053[_0x36150b(0x1fb)]===SYSTEM_MODES[_0x36150b(0x14f)]&&await setPresence(_0x449053,!![])),_0x4b52dd;}catch(_0x166793){return![];}}function startExitTimer(_0x5c660b){const _0x26bf5c=a0_0x1e9089;abortExitTimer(_0x5c660b),_0x5c660b[_0x26bf5c(0x15d)]=!![],_0x5c660b[_0x26bf5c(0x124)]=setTimeout(()=>{const _0x1bfca9=_0x26bf5c;_0x5c660b[_0x1bfca9(0x15d)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x5c660b[_0x26bf5c(0x18e)]=setTimeout(()=>{const _0x3ab644=_0x26bf5c;setPresence(_0x5c660b,![]),_0x5c660b[_0x3ab644(0x18e)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x41bf51){const _0x4b071f=a0_0x1e9089;if(_0x41bf51[_0x4b071f(0x18e)])clearTimeout(_0x41bf51[_0x4b071f(0x18e)]);if(_0x41bf51['exitGraceTimer'])clearTimeout(_0x41bf51[_0x4b071f(0x124)]);_0x41bf51[_0x4b071f(0x18e)]=null,_0x41bf51[_0x4b071f(0x124)]=null,_0x41bf51['isGracePeriodActive']=![];}async function setPresence(_0x28004f,_0x4210f4){const _0x174949=a0_0x1e9089;if(_0x28004f['isPresent']===_0x4210f4)return;_0x28004f[_0x174949(0x22f)]=_0x4210f4,await _0x28004f['setStateAsync'](_0x174949(0xb2),{'val':_0x4210f4,'ack':!![]});}async function executeAutomationAction(_0x35a203){const _0x1ba213=a0_0x1e9089;try{const _0x4ad3de=await _0x35a203[_0x1ba213(0x15b)]('analysis.automation.targetId'),_0x24e70c=await _0x35a203[_0x1ba213(0x15b)](_0x1ba213(0x168));if(_0x4ad3de&&_0x4ad3de[_0x1ba213(0x21b)]&&_0x24e70c){const _0x427bca=_0x4ad3de['val'];let _0x39fd19=_0x24e70c['val'];try{_0x39fd19=JSON[_0x1ba213(0x14c)](_0x39fd19);}catch(_0x4258c8){}_0x35a203[_0x1ba213(0x21d)][_0x1ba213(0x207)]('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x427bca+_0x1ba213(0x15f)+_0x39fd19),await _0x35a203[_0x1ba213(0x15e)](_0x427bca,_0x39fd19);}else _0x35a203[_0x1ba213(0x21d)][_0x1ba213(0x24b)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x198aa5){_0x35a203[_0x1ba213(0x21d)][_0x1ba213(0x20b)]('BUTLER\x20Execution\x20Error:\x20'+_0x198aa5[_0x1ba213(0x17f)]);}}function a0_0x33ac(_0x8e988a,_0x595c34){const _0x3154f1=a0_0x1873();return a0_0x33ac=function(_0x1a0bb9,_0x31886b){_0x1a0bb9=_0x1a0bb9-0xae;let _0x1873f8=_0x3154f1[_0x1a0bb9];return _0x1873f8;},a0_0x33ac(_0x8e988a,_0x595c34);}async function handleTelegramResponse(_0x3455ea,_0x1c2028){const _0x19a50a=a0_0x1e9089;let _0x58daf9=_0x1c2028;_0x1c2028['startsWith']('[')&&(_0x58daf9=_0x1c2028[_0x19a50a(0x159)](_0x1c2028[_0x19a50a(0x180)](']')+0x1));if(_0x58daf9===_0x19a50a(0x1aa))await _0x3455ea['setStateAsync'](_0x19a50a(0x1e8),{'val':![],'ack':!![]}),await _0x3455ea[_0x19a50a(0x1f5)](_0x19a50a(0xe0),{'val':_0x19a50a(0x190),'ack':!![]}),_0x3455ea['lastAlertState']=![],sendNotification(_0x3455ea,_0x19a50a(0x1d7),![]);else _0x58daf9===_0x19a50a(0x1ab)&&sendNotification(_0x3455ea,_0x19a50a(0x102),![],!![]);}async function runPythonHealthCheck(_0x53e2a6){const _0x553ca2=a0_0x1e9089;if(!_0x53e2a6[_0x553ca2(0x161)]||_0x53e2a6['dailyDigests'][_0x553ca2(0xc0)]<0x2)return;const _0x664e98=_0x53e2a6['dailyDigests'][_0x553ca2(0xfa)](_0x468e04=>{const _0x3f9ef9=_0x553ca2,_0x5d6f5c=(_0x468e04[_0x3f9ef9(0x236)]||'')[_0x3f9ef9(0x188)]();return ACTIVITY_LEVEL_MAP[_0x5d6f5c]||0x32;});sendToPython(_0x53e2a6,_0x553ca2(0xb1),{'values':_0x664e98,'tag':_0x553ca2(0x253)});}class CogniLiving extends utils[a0_0x1e9089(0x1b2)]{constructor(_0x1f9063){const _0x203ffe=a0_0x1e9089;super({..._0x1f9063,'name':_0x203ffe(0x1ca)}),this[_0x203ffe(0x137)]=[],this[_0x203ffe(0xf1)]=[],this[_0x203ffe(0x1e2)]=[],this[_0x203ffe(0x161)]=[],this[_0x203ffe(0x153)]={},this[_0x203ffe(0x1c0)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x203ffe(0x22f)]=!![],this['exitTimer']=null,this[_0x203ffe(0x124)]=null,this[_0x203ffe(0x15d)]=![],this['genAI']=null,this[_0x203ffe(0x1e6)]=null,this[_0x203ffe(0x1fb)]=SYSTEM_MODES[_0x203ffe(0x14f)],this['isProVersion']=![],this['lastAlertState']=![],this[_0x203ffe(0x129)]=_0x203ffe(0x126),this[_0x203ffe(0x240)]=null,this[_0x203ffe(0x239)]=null,this['modeResetJob']=null,this[_0x203ffe(0x18d)]=null,this[_0x203ffe(0x1d3)]=null,this['pythonProcess']=null,this[_0x203ffe(0x200)]=![],this['on']('ready',this[_0x203ffe(0x22a)][_0x203ffe(0x145)](this)),this['on']('stateChange',this['onStateChange']['bind'](this)),this['on']('unload',this[_0x203ffe(0x22b)][_0x203ffe(0x145)](this)),this['on'](_0x203ffe(0x17f),this[_0x203ffe(0x213)]['bind'](this));}async['onReady'](){const _0x2d7f40=a0_0x1e9089;this[_0x2d7f40(0x21d)]['info'](_0x2d7f40(0xfe)+this[_0x2d7f40(0x1ff)]+')\x20-\x20STRICT\x20ORDER\x20FIX'),await initZombies(this);try{this[_0x2d7f40(0x1ce)]=await checkLicense(this,this['config'][_0x2d7f40(0x1a0)]);}catch(_0xc7eede){}if(!this[_0x2d7f40(0x23e)][_0x2d7f40(0x11c)]||this[_0x2d7f40(0x23e)][_0x2d7f40(0x11c)]<0.1)this[_0x2d7f40(0x23e)][_0x2d7f40(0x11c)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config']['geminiApiKey'])try{this['genAI']=new GoogleGenerativeAI(this[_0x2d7f40(0x23e)][_0x2d7f40(0x234)]),this[_0x2d7f40(0x1e6)]=this['genAI']['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x2d7f40(0x21d)][_0x2d7f40(0x207)]('Gemini\x20AI\x20initialized.');}catch(_0x157113){this[_0x2d7f40(0x21d)]['error'](_0x2d7f40(0x201)+_0x157113[_0x2d7f40(0x17f)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x2d7f40(0x14a)](_0x2d7f40(0x1d9)),this[_0x2d7f40(0x14a)](LTM_DP_TRIGGER_DIGEST),this[_0x2d7f40(0x14a)](_0x2d7f40(0x15c)),this[_0x2d7f40(0x14a)]('analysis.triggerBriefing'),this[_0x2d7f40(0x14a)]('analysis.automation.triggerAction'),this['subscribeStates']('analysis.automation.autoApply'),this['subscribeStates']('analysis.training.triggerSecurity'),this[_0x2d7f40(0x14a)]('analysis.training.triggerHealth'),this[_0x2d7f40(0x14a)](_0x2d7f40(0x255)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x2d7f40(0x240)])clearInterval(this[_0x2d7f40(0x240)]);const _0x5cd688=this[_0x2d7f40(0x23e)][_0x2d7f40(0xfb)]||0xf;_0x5cd688>0x0&&(this['analysisTimer']=setInterval(()=>{runAutopilot(this);},_0x5cd688*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x549d10=_0x2d7f40;if(this[_0x549d10(0x246)])runPythonHealthCheck(this);},0x1388);}[a0_0x1e9089(0x22b)](_0x317b61){const _0x4aecb6=a0_0x1e9089;if(this[_0x4aecb6(0x240)])clearInterval(this[_0x4aecb6(0x240)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x4aecb6(0x18d)]);if(this[_0x4aecb6(0x239)])this[_0x4aecb6(0x239)][_0x4aecb6(0x227)]();if(this['modeResetJob'])this[_0x4aecb6(0x172)][_0x4aecb6(0x227)]();if(this[_0x4aecb6(0x1d3)])this[_0x4aecb6(0x1d3)][_0x4aecb6(0x227)]();if(this[_0x4aecb6(0x18e)])clearTimeout(this[_0x4aecb6(0x18e)]);if(this[_0x4aecb6(0x124)])clearTimeout(this[_0x4aecb6(0x124)]);stopPythonService(this),_0x317b61();}async[a0_0x1e9089(0x24c)](_0x7f1ebc,_0x10aadf){const _0x28a54a=a0_0x1e9089;if(!_0x10aadf||this[_0x28a54a(0x200)])return;if(_0x7f1ebc['includes'](_0x28a54a(0xe3))&&_0x7f1ebc['endsWith'](_0x28a54a(0x10e))&&_0x10aadf[_0x28a54a(0x21b)]){await handleTelegramResponse(this,_0x10aadf[_0x28a54a(0x21b)]);return;}if(_0x7f1ebc===this[_0x28a54a(0x17d)]+'.'+SYSTEM_DP_MODE){if(_0x10aadf[_0x28a54a(0x21b)]&&Object['values'](SYSTEM_MODES)[_0x28a54a(0x13d)](_0x10aadf['val'])){this['currentSystemMode']=_0x10aadf[_0x28a54a(0x21b)];if(_0x10aadf[_0x28a54a(0x21b)]===SYSTEM_MODES[_0x28a54a(0x1bd)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x10aadf[_0x28a54a(0xfd)])this[_0x28a54a(0x1de)](_0x7f1ebc,{'val':this[_0x28a54a(0x1fb)],'ack':!![]});return;}if(!_0x10aadf[_0x28a54a(0xfd)]){_0x7f1ebc[_0x28a54a(0x13d)](_0x28a54a(0x1d9))&&_0x10aadf[_0x28a54a(0x21b)]&&(this[_0x28a54a(0x1de)](_0x7f1ebc,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x7f1ebc[_0x28a54a(0x13d)](_0x28a54a(0x254))&&_0x10aadf[_0x28a54a(0x21b)]){this[_0x28a54a(0x1de)](_0x7f1ebc,{'val':![],'ack':!![]});if(this[_0x28a54a(0x1ce)])createDailyDigest(this);}_0x7f1ebc[_0x28a54a(0x13d)](_0x28a54a(0x10f))&&_0x10aadf[_0x28a54a(0x21b)]&&(this[_0x28a54a(0x1de)](_0x7f1ebc,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x7f1ebc[_0x28a54a(0x13d)](_0x28a54a(0x245))&&_0x10aadf[_0x28a54a(0x21b)]&&(this['setState'](_0x7f1ebc,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x7f1ebc['includes'](_0x28a54a(0x23f))&&_0x10aadf[_0x28a54a(0x21b)]){this[_0x28a54a(0x1de)](_0x7f1ebc,{'val':![],'ack':!![]});if(this[_0x28a54a(0x1ce)])try{const _0x2ba71b=await this[_0x28a54a(0x15b)](_0x28a54a(0x179));if(_0x2ba71b&&_0x2ba71b['val']){const _0x37d57d=JSON['parse'](_0x2ba71b[_0x28a54a(0x21b)]);this[_0x28a54a(0x21d)][_0x28a54a(0x207)](_0x28a54a(0x10b)),this['setStateAsync'](_0x28a54a(0x1db),{'val':'Sec-Training\x20started...','ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x37d57d});}}catch(_0x3c5831){this['log']['error'](_0x28a54a(0xfc)+_0x3c5831[_0x28a54a(0x17f)]);}}if(_0x7f1ebc['includes'](_0x28a54a(0x20e))&&_0x10aadf[_0x28a54a(0x21b)]){this[_0x28a54a(0x1de)](_0x7f1ebc,{'val':![],'ack':!![]});if(this[_0x28a54a(0x1ce)])try{const _0x2d7b6d=await this[_0x28a54a(0x15b)](LTM_DP_DAILY_DIGESTS);if(_0x2d7b6d&&_0x2d7b6d[_0x28a54a(0x21b)])sendToPython(this,_0x28a54a(0xbb),{'digests':JSON[_0x28a54a(0x14c)](_0x2d7b6d['val'])});}catch(_0x5d6289){}}if(_0x7f1ebc[_0x28a54a(0x13d)](_0x28a54a(0x255))&&_0x10aadf['val']){this[_0x28a54a(0x1de)](_0x7f1ebc,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x339961=await this['getStateAsync'](_0x28a54a(0xba));if(_0x339961&&_0x339961[_0x28a54a(0x21b)])sendToPython(this,_0x28a54a(0x166),{'points':JSON['parse'](_0x339961[_0x28a54a(0x21b)])});}catch(_0x4f259e){}}return;}if(this['config'][_0x28a54a(0x228)]&&this[_0x28a54a(0x23e)][_0x28a54a(0x228)][_0x28a54a(0x13d)](_0x7f1ebc)){await checkWifiPresence(this);return;}const _0x489d5e=(this[_0x28a54a(0x23e)][_0x28a54a(0x176)]||[])[_0x28a54a(0x1a9)](_0x106d06=>_0x106d06['id']===_0x7f1ebc);if(_0x489d5e)processSensorEvent(this,_0x7f1ebc,_0x10aadf,_0x489d5e);}async[a0_0x1e9089(0x213)](_0x279042){const _0x44f62a=a0_0x1e9089;if(typeof _0x279042===_0x44f62a(0x20f)&&_0x279042[_0x44f62a(0x17f)]){if(_0x279042[_0x44f62a(0x1fc)]===_0x44f62a(0x1a3)){const _0x302fe2=_0x279042[_0x44f62a(0x17f)][_0x44f62a(0x19e)]||this[_0x44f62a(0x23e)][_0x44f62a(0x234)];if(!_0x302fe2)return this['sendTo'](_0x279042[_0x44f62a(0x169)],_0x279042[_0x44f62a(0x1fc)],{'success':![],'message':_0x44f62a(0x217)},_0x279042[_0x44f62a(0x16e)]);try{const _0x30671f=new GoogleGenerativeAI(_0x302fe2),_0x2d9904=_0x30671f[_0x44f62a(0x226)]({'model':GEMINI_MODEL}),_0x41251e=await _0x2d9904[_0x44f62a(0x131)]('Hi');this['sendTo'](_0x279042[_0x44f62a(0x169)],_0x279042[_0x44f62a(0x1fc)],{'success':!![],'message':'OK:\x20'+_0x41251e[_0x44f62a(0x1a8)]['text']()},_0x279042[_0x44f62a(0x16e)]);}catch(_0x3b6897){this[_0x44f62a(0xe7)](_0x279042['from'],_0x279042[_0x44f62a(0x1fc)],{'success':![],'message':_0x44f62a(0x19a)+_0x3b6897[_0x44f62a(0x17f)]},_0x279042[_0x44f62a(0x16e)]);}}else{if(_0x279042[_0x44f62a(0x1fc)]===_0x44f62a(0x211)){const _0x13466c=await getWeatherContext(this),_0x10d0fc=await getCalendarContext(this);this[_0x44f62a(0xe7)](_0x279042[_0x44f62a(0x169)],_0x279042['command'],{'success':!![],'weather':_0x13466c,'calendar':_0x10d0fc},_0x279042['callback']);}else{if(_0x279042['command']==='getLtmData'){if(!this[_0x44f62a(0x1ce)])return this['sendTo'](_0x279042[_0x44f62a(0x169)],_0x279042[_0x44f62a(0x1fc)],{'success':![],'isPro':![]},_0x279042[_0x44f62a(0x16e)]);let _0xb18fe3={'status':'N/A'};try{const _0x1073a0=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0xb18fe3[_0x44f62a(0xbe)]=_0x1073a0?_0x1073a0['val']:'N/A';}catch(_0x2ca2b3){}this[_0x44f62a(0xe7)](_0x279042[_0x44f62a(0x169)],_0x279042[_0x44f62a(0x1fc)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x44f62a(0x161)],'driftAnalysis':_0xb18fe3,'analysisHistory':this['analysisHistory']},_0x279042[_0x44f62a(0x16e)]);}else{if(_0x279042['command']===_0x44f62a(0x212)){const _0xe91275=this[_0x44f62a(0x161)][_0x44f62a(0xc0)],_0x57c43f=new Date(),_0x1ef4aa=new Date(_0x57c43f[_0x44f62a(0x147)](),_0x57c43f['getMonth'](),_0x57c43f['getDate']())[_0x44f62a(0x136)](),_0x35ecb1=this['rawEventLog'][_0x44f62a(0x206)](_0x4b8231=>new Date(_0x4b8231[_0x44f62a(0x111)])[_0x44f62a(0x136)]()>_0x1ef4aa)[_0x44f62a(0xc0)],_0x57a2a0=new Array(0x18)[_0x44f62a(0x1ad)](0x0);this[_0x44f62a(0x1e2)][_0x44f62a(0x1fa)](_0x450a0d=>{const _0x8dd36d=_0x44f62a,_0x35466f=new Date(_0x450a0d[_0x8dd36d(0x111)]);if(_0x35466f[_0x8dd36d(0x136)]()>_0x1ef4aa)_0x57a2a0[_0x35466f[_0x8dd36d(0x1f2)]()]++;});let _0x196295={'status':_0x44f62a(0x175)};try{const _0x212945=await this[_0x44f62a(0x15b)](LTM_DP_DRIFT_STATUS);_0x196295[_0x44f62a(0xbe)]=_0x212945?_0x212945[_0x44f62a(0x21b)]:'N/A';}catch(_0x40b370){}let _0x847d80='';try{const _0x493467=await this[_0x44f62a(0x15b)](_0x44f62a(0x242));_0x847d80=_0x493467?_0x493467[_0x44f62a(0x21b)]:'';}catch(_0x34840c){}let _0x982c2f=null;!this[_0x44f62a(0x1e6)]&&(_0x982c2f=this['config'][_0x44f62a(0x234)]?_0x44f62a(0xee):_0x44f62a(0x1d5));let _0x538ffb={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x2bf992=await this[_0x44f62a(0x15b)](_0x44f62a(0x1d0));if(_0x2bf992&&_0x2bf992[_0x44f62a(0x21b)]){_0x538ffb[_0x44f62a(0x1b8)]=!![];const _0x4f9b1d=await this[_0x44f62a(0x15b)](_0x44f62a(0x229));_0x538ffb[_0x44f62a(0x185)]=_0x4f9b1d?_0x4f9b1d[_0x44f62a(0x21b)]:'';const _0x1e9156=await this[_0x44f62a(0x15b)](_0x44f62a(0x194));_0x538ffb[_0x44f62a(0x21e)]=_0x1e9156?_0x1e9156[_0x44f62a(0x21b)]:'';const _0x192023=await this[_0x44f62a(0x15b)](_0x44f62a(0x168));_0x538ffb[_0x44f62a(0x106)]=_0x192023?_0x192023[_0x44f62a(0x21b)]:'';}const _0xbd8f2e=await this[_0x44f62a(0x15b)](_0x44f62a(0x214));_0x538ffb['autoApply']=_0xbd8f2e?!!_0xbd8f2e[_0x44f62a(0x21b)]:![];}catch(_0x239e5a){}this[_0x44f62a(0xe7)](_0x279042[_0x44f62a(0x169)],_0x279042['command'],{'success':!![],'eventHistory':this[_0x44f62a(0x137)][_0x44f62a(0x1fd)](0x0,0xf),'stats':{'digestCount':_0xe91275,'eventCountToday':_0x35ecb1,'hourlyActivity':_0x57a2a0,'driftStatus':_0x196295[_0x44f62a(0xbe)],'isPresent':this['isPresent'],'presenceWho':_0x847d80,'minDays':this[_0x44f62a(0x23e)][_0x44f62a(0x109)]||0x7,'stbDays':this['config'][_0x44f62a(0xd4)]||0xe,'ltbDays':this[_0x44f62a(0x23e)][_0x44f62a(0x249)]||0x3c,'systemError':_0x982c2f},'automation':_0x538ffb},_0x279042[_0x44f62a(0x16e)]);}else{if(_0x279042[_0x44f62a(0x1fc)]===_0x44f62a(0x160))try{const _0xe8d9a5=await scanForDevices(this,_0x279042[_0x44f62a(0x17f)]||{});this['sendTo'](_0x279042[_0x44f62a(0x169)],_0x279042['command'],{'success':!![],'devices':_0xe8d9a5},_0x279042[_0x44f62a(0x16e)]);}catch(_0x45d8c3){this['sendTo'](_0x279042[_0x44f62a(0x169)],_0x279042[_0x44f62a(0x1fc)],{'success':![],'error':_0x45d8c3[_0x44f62a(0x17f)]},_0x279042[_0x44f62a(0x16e)]);}else{if(_0x279042[_0x44f62a(0x1fc)]===_0x44f62a(0xe5)){const _0x5d2920=await this[_0x44f62a(0xb0)]('enum.functions.*',_0x44f62a(0xbc)),_0x8c949c=[];if(_0x5d2920)for(const _0x4c673b in _0x5d2920){const _0x155e48=_0x5d2920[_0x4c673b],_0x281449=(_0x155e48[_0x44f62a(0xe9)]&&typeof _0x155e48[_0x44f62a(0xe9)][_0x44f62a(0x1ac)]===_0x44f62a(0x20f)?_0x155e48[_0x44f62a(0xe9)][_0x44f62a(0x1ac)]['de']:_0x155e48['common'][_0x44f62a(0x1ac)])||_0x155e48['common'][_0x44f62a(0x1ac)];_0x8c949c[_0x44f62a(0x157)]({'id':_0x4c673b,'name':_0x281449});}this[_0x44f62a(0xe7)](_0x279042[_0x44f62a(0x169)],_0x279042[_0x44f62a(0x1fc)],{'success':!![],'enums':_0x8c949c},_0x279042[_0x44f62a(0x16e)]);}else{if(_0x279042[_0x44f62a(0x1fc)]==='getCalendarNames'){const _0x47d9ea=_0x279042[_0x44f62a(0x17f)][_0x44f62a(0x1ea)];if(!_0x47d9ea)return this[_0x44f62a(0xe7)](_0x279042['from'],_0x279042[_0x44f62a(0x1fc)],{'success':![],'error':_0x44f62a(0x248)},_0x279042[_0x44f62a(0x16e)]);const _0x1573cc=await getCalendarNames(this,_0x47d9ea);this[_0x44f62a(0xe7)](_0x279042[_0x44f62a(0x169)],_0x279042[_0x44f62a(0x1fc)],{'success':!![],'names':_0x1573cc},_0x279042[_0x44f62a(0x16e)]);}else{if(_0x279042['command']===_0x44f62a(0x19c)){const {targetId:_0x5b568c,targetValue:_0x4901c8}=_0x279042['message'];this[_0x44f62a(0x21d)][_0x44f62a(0x207)](_0x44f62a(0xb9)+_0x5b568c+'\x20=\x20'+_0x4901c8),await this[_0x44f62a(0x1f5)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x44f62a(0x1f5)]('analysis.automation.description',{'val':_0x44f62a(0xe1)+_0x5b568c,'ack':!![]}),await this[_0x44f62a(0x1f5)]('analysis.automation.targetId',{'val':_0x5b568c,'ack':!![]}),await this[_0x44f62a(0x1f5)](_0x44f62a(0x168),{'val':_0x4901c8,'ack':!![]}),this['sendTo'](_0x279042['from'],_0x279042[_0x44f62a(0x1fc)],{'success':!![]},_0x279042['callback']);}else{if(_0x279042[_0x44f62a(0x1fc)]===_0x44f62a(0x257)){const {historyId:_0x507615,rating:_0x454526,comment:_0x3d4104,alertReason:_0x72f022}=_0x279042[_0x44f62a(0x17f)];_0x507615&&_0x454526?(await saveFeedback(this,{'timestamp':Date[_0x44f62a(0x23c)](),'historyId':_0x507615,'rating':_0x454526,'comment':_0x3d4104,'alertReason':_0x72f022}),this[_0x44f62a(0xe7)](_0x279042['from'],_0x279042['command'],{'success':!![]},_0x279042['callback'])):this[_0x44f62a(0xe7)](_0x279042['from'],_0x279042['command'],{'success':![],'error':_0x44f62a(0xf5)},_0x279042[_0x44f62a(0x16e)]);}else _0x279042[_0x44f62a(0x1fc)]===_0x44f62a(0x1a1)&&(this[_0x44f62a(0x21d)][_0x44f62a(0x207)]('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x44f62a(0x1d0),{'val':![],'ack':!![]}),await this[_0x44f62a(0x1f5)](_0x44f62a(0x229),{'val':'','ack':!![]}),this[_0x44f62a(0xe7)](_0x279042[_0x44f62a(0x169)],_0x279042['command'],{'success':!![]},_0x279042[_0x44f62a(0x16e)]));}}}}}}}}}}}if(require['main']!==module)module[a0_0x1e9089(0xaf)]=_0x50ccb4=>new CogniLiving(_0x50ccb4);else new CogniLiving();