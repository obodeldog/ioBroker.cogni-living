const a0_0x38181c=a0_0x52d6;(function(_0xb9196e,_0x9d5ef8){const _0x2cde46=a0_0x52d6,_0x4ae829=_0xb9196e();while(!![]){try{const _0x1cf06e=parseInt(_0x2cde46(0x1bb))/0x1*(-parseInt(_0x2cde46(0x33f))/0x2)+-parseInt(_0x2cde46(0x2db))/0x3*(-parseInt(_0x2cde46(0x25b))/0x4)+parseInt(_0x2cde46(0x245))/0x5+-parseInt(_0x2cde46(0x2bd))/0x6*(parseInt(_0x2cde46(0x26b))/0x7)+-parseInt(_0x2cde46(0x303))/0x8*(parseInt(_0x2cde46(0x338))/0x9)+parseInt(_0x2cde46(0x332))/0xa*(-parseInt(_0x2cde46(0x1be))/0xb)+parseInt(_0x2cde46(0x2e5))/0xc;if(_0x1cf06e===_0x9d5ef8)break;else _0x4ae829['push'](_0x4ae829['shift']());}catch(_0x53f3a0){_0x4ae829['push'](_0x4ae829['shift']());}}}(a0_0x1d0d,0xbe3eb));const a0_0x725697=(function(){let _0x43b005=!![];return function(_0xf28575,_0x12e56a){const _0x4ce33a=_0x43b005?function(){if(_0x12e56a){const _0x28b3fb=_0x12e56a['apply'](_0xf28575,arguments);return _0x12e56a=null,_0x28b3fb;}}:function(){};return _0x43b005=![],_0x4ce33a;};}()),a0_0x512f88=a0_0x725697(this,function(){const _0x4a5f70=a0_0x52d6;return a0_0x512f88[_0x4a5f70(0x2a8)]()[_0x4a5f70(0x1cd)](_0x4a5f70(0x1f7))[_0x4a5f70(0x2a8)]()['constructor'](a0_0x512f88)['search'](_0x4a5f70(0x1f7));});a0_0x512f88();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x38181c(0x317)),schedule=require(a0_0x38181c(0x216)),{spawn,exec}=require(a0_0x38181c(0x218)),path=require(a0_0x38181c(0x2cb)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x38181c(0x250),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x38181c(0x2b1),LTM_DP_DAILY_DIGESTS=a0_0x38181c(0x2c2),LTM_DP_STATUS=a0_0x38181c(0x2d0),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x38181c(0x22b),LTM_DP_DRIFT_CHANNEL=a0_0x38181c(0x2e4),LTM_DP_DRIFT_STATUS=a0_0x38181c(0x1a6),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x38181c(0x2e6),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x38181c(0x1db),'VACATION':'vacation','PARTY':a0_0x38181c(0x25f),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x38181c(0x246)],SYSTEM_MODES[a0_0x38181c(0x202)]],PERSONA_MAPPING={'generic':a0_0x38181c(0x20a),'senior_aal':'PRIORITÃ„T:\x20Gesundheit/AAL.','family':a0_0x38181c(0x26c),'single_comfort':a0_0x38181c(0x1f1),'security':a0_0x38181c(0x293)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x38181c(0x1fa)]===a0_0x38181c(0x2f7),PERSISTENT_DIR=path[a0_0x38181c(0x223)](__dirname,a0_0x38181c(0x333)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x38181c(0x1c1),'python.exe'):path['join'](VENV_PATH,a0_0x38181c(0x1e9),a0_0x38181c(0x302)),PIP_EXE=IS_WIN?path[a0_0x38181c(0x223)](VENV_PATH,'Scripts',a0_0x38181c(0x23b)):path[a0_0x38181c(0x223)](VENV_PATH,a0_0x38181c(0x1e9),a0_0x38181c(0x325));let activeSequence=[],sequenceTimer=null;async function startSystem(_0x2b4f0d){const _0x10fd51=a0_0x38181c;_0x2b4f0d['log']['info'](_0x10fd51(0x2e9)),await initZombies(_0x2b4f0d);try{_0x2b4f0d[_0x10fd51(0x1e5)]=await checkLicense(_0x2b4f0d[_0x10fd51(0x1f9)]['licenseKey']);}catch(_0x4b8ba5){}if(!_0x2b4f0d[_0x10fd51(0x1f9)][_0x10fd51(0x24b)]||_0x2b4f0d[_0x10fd51(0x1f9)][_0x10fd51(0x24b)]<0.1)_0x2b4f0d[_0x10fd51(0x1f9)]['inactivityThresholdHours']=0xc;await initHistory(_0x2b4f0d),await initSystemConfig(_0x2b4f0d);if(_0x2b4f0d['config']['geminiApiKey'])try{_0x2b4f0d['genAI']=new GoogleGenerativeAI(_0x2b4f0d[_0x10fd51(0x1f9)][_0x10fd51(0x2b6)]),_0x2b4f0d['geminiModel']=_0x2b4f0d[_0x10fd51(0x2d5)][_0x10fd51(0x2dd)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),_0x2b4f0d[_0x10fd51(0x2f4)]['info'](_0x10fd51(0x28f));}catch(_0x4f82ef){_0x2b4f0d[_0x10fd51(0x2f4)][_0x10fd51(0x2c5)](_0x10fd51(0x238)+_0x4f82ef[_0x10fd51(0x1cf)]);}await createAllObjects(_0x2b4f0d),await loadSystemMode(_0x2b4f0d),await loadRawEventLog(_0x2b4f0d),await loadDailyDigests(_0x2b4f0d),_0x2b4f0d[_0x10fd51(0x32c)](_0x10fd51(0x24c)),_0x2b4f0d[_0x10fd51(0x32c)](LTM_DP_TRIGGER_DIGEST),_0x2b4f0d[_0x10fd51(0x32c)](_0x10fd51(0x2f0)),_0x2b4f0d['subscribeStates'](_0x10fd51(0x1f2)),_0x2b4f0d[_0x10fd51(0x32c)](_0x10fd51(0x30d)),_0x2b4f0d[_0x10fd51(0x32c)](_0x10fd51(0x312)),_0x2b4f0d[_0x10fd51(0x32c)](_0x10fd51(0x2aa)),_0x2b4f0d['subscribeStates'](_0x10fd51(0x1b9)),_0x2b4f0d[_0x10fd51(0x32c)](_0x10fd51(0x1ec)),_0x2b4f0d[_0x10fd51(0x32c)](_0x10fd51(0x313)),await initSensorSubscriptions(_0x2b4f0d),await initPresenceSubscriptions(_0x2b4f0d),await setupTelegramListener(_0x2b4f0d),setTimeout(()=>checkWifiPresence(_0x2b4f0d),0x1388);if(_0x2b4f0d['analysisTimer'])clearInterval(_0x2b4f0d[_0x10fd51(0x1ce)]);const _0x4a6755=_0x2b4f0d[_0x10fd51(0x1f9)][_0x10fd51(0x260)]||0xf;_0x4a6755>0x0&&(_0x2b4f0d['analysisTimer']=setInterval(()=>{runAutopilot(_0x2b4f0d);},_0x4a6755*0x3c*0x3e8)),setupLtmScheduler(_0x2b4f0d),setupModeResetScheduler(_0x2b4f0d),setupDriftAnalysisScheduler(_0x2b4f0d),setupBriefingScheduler(_0x2b4f0d),startPythonService(_0x2b4f0d),setTimeout(()=>{const _0x3ef7e2=_0x10fd51;if(_0x2b4f0d[_0x3ef7e2(0x1de)])runPythonHealthCheck(_0x2b4f0d);},0x1388);}async function runAutopilot(_0x4d7f44){const _0x4b7d03=a0_0x38181c;_0x4d7f44[_0x4b7d03(0x2f4)][_0x4b7d03(0x249)](_0x4b7d03(0x291)),await runGeminiAnalysis(_0x4d7f44);}async function scanForDevices(_0x3bec56,_0x1aa4c9){const _0x1e4101=a0_0x38181c;_0x3bec56[_0x1e4101(0x2f4)][_0x1e4101(0x290)](_0x1e4101(0x307));const _0x13bae4=[],_0x4787dd=await _0x3bec56[_0x1e4101(0x21e)]('*');for(const _0xe9569c in _0x4787dd){const _0x71aacc=_0x4787dd[_0xe9569c];if(_0x71aacc&&_0x71aacc[_0x1e4101(0x2d8)]&&_0x71aacc[_0x1e4101(0x2b4)]===_0x1e4101(0x227)){const _0x4bc649=(_0x71aacc['common'][_0x1e4101(0x335)]&&typeof _0x71aacc[_0x1e4101(0x2d8)]['name']==='object'?_0x71aacc[_0x1e4101(0x2d8)][_0x1e4101(0x335)]['de']:_0x71aacc[_0x1e4101(0x2d8)][_0x1e4101(0x335)])||'',_0x139001=_0x71aacc[_0x1e4101(0x2d8)][_0x1e4101(0x21c)]||'';let _0x4ce947=null;if(_0x1aa4c9[_0x1e4101(0x29b)]&&(_0x139001[_0x1e4101(0x1f3)](_0x1e4101(0x29b))||_0x4bc649['toLowerCase']()[_0x1e4101(0x1f3)](_0x1e4101(0x1e6))))_0x4ce947='motion';else{if(_0x1aa4c9[_0x1e4101(0x231)]&&(_0x139001[_0x1e4101(0x1f3)](_0x1e4101(0x344))||_0x139001[_0x1e4101(0x1f3)](_0x1e4101(0x29c))||_0x4bc649['toLowerCase']()[_0x1e4101(0x1f3)]('tÃ¼r')||_0x4bc649[_0x1e4101(0x2bc)]()[_0x1e4101(0x1f3)](_0x1e4101(0x299))))_0x4ce947=_0x1e4101(0x344);else{if(_0x1aa4c9[_0x1e4101(0x29d)]&&(_0x139001['includes'](_0x1e4101(0x26a))||_0x139001[_0x1e4101(0x1f3)](_0x1e4101(0x340))||_0x4bc649[_0x1e4101(0x2bc)]()[_0x1e4101(0x1f3)](_0x1e4101(0x1b5))))_0x4ce947=_0x1e4101(0x26a);else{if(_0x1aa4c9[_0x1e4101(0x274)]&&(_0x139001['includes'](_0x1e4101(0x274))||_0x4bc649[_0x1e4101(0x2bc)]()[_0x1e4101(0x1f3)]('temperatur')))_0x4ce947=_0x1e4101(0x274);}}}if(_0x4ce947){let _0x5dd1f9='';const _0x29d082=_0xe9569c['split']('.');if(_0x29d082['length']>0x2)_0x5dd1f9=_0x29d082[0x2];_0x13bae4[_0x1e4101(0x1b0)]({'id':_0xe9569c,'name':_0x4bc649||_0xe9569c,'type':_0x4ce947,'location':_0x5dd1f9,'_score':0x32});}}}return _0x13bae4;}async function getWeatherContext(_0x5ce62a){const _0x2d6d73=a0_0x38181c;if(!_0x5ce62a[_0x2d6d73(0x1f9)]['useWeather']||!_0x5ce62a[_0x2d6d73(0x1f9)][_0x2d6d73(0x2f2)])return _0x2d6d73(0x200);try{const _0x4f23c0=_0x5ce62a[_0x2d6d73(0x1f9)]['weatherInstance'];let _0x5171d0=await _0x5ce62a[_0x2d6d73(0x1ae)](_0x4f23c0+_0x2d6d73(0x350));if(!_0x5171d0)_0x5171d0=await _0x5ce62a[_0x2d6d73(0x1ae)](_0x4f23c0+_0x2d6d73(0x236));let _0x23af9c=await _0x5ce62a[_0x2d6d73(0x1ae)](_0x4f23c0+'.Current.WeatherText');if(!_0x23af9c)_0x23af9c=await _0x5ce62a['getForeignStateAsync'](_0x4f23c0+'.forecast.current.state');if(_0x5171d0&&_0x23af9c)return _0x5171d0[_0x2d6d73(0x2d6)]+_0x2d6d73(0x2ad)+_0x23af9c[_0x2d6d73(0x2d6)];}catch(_0x5635fe){}return _0x2d6d73(0x261);}async function getCalendarContext(_0x5547b1){const _0x405038=a0_0x38181c;if(!_0x5547b1['config'][_0x405038(0x214)]||!_0x5547b1[_0x405038(0x1f9)]['calendarInstance'])return'Kalender\x20deaktiviert.';return _0x405038(0x1eb);}async function getCalendarNames(_0x180c62,_0x499be5){return[];}async function saveFeedback(_0x29d1d5,_0x17d2ea){const _0x4c1132=a0_0x38181c;_0x29d1d5[_0x4c1132(0x2f4)][_0x4c1132(0x290)]('ðŸ“\x20Feedback\x20received:\x20'+_0x17d2ea[_0x4c1132(0x1ac)]);}async function sendMorningBriefing(_0x5701dc){const _0x3d55c9=a0_0x38181c;if(!_0x5701dc[_0x3d55c9(0x258)])return;try{const _0xdf0456=_0x3d55c9(0x25e),_0x23a8fb=await _0x5701dc[_0x3d55c9(0x258)]['generateContent'](_0xdf0456),_0x23cfcf=_0x23a8fb[_0x3d55c9(0x2c8)][_0x3d55c9(0x337)]();sendNotification(_0x5701dc,_0x3d55c9(0x296)+_0x23cfcf);}catch(_0x571ce7){_0x5701dc[_0x3d55c9(0x2f4)]['error'](_0x3d55c9(0x320)+_0x571ce7['message']);}}function checkAndInstall(_0x2835ce){const _0x2d079e=a0_0x38181c;if(!fs[_0x2d079e(0x2b5)](VENV_PATH)||!fs[_0x2d079e(0x2b5)](PIP_EXE))return _0x2835ce[_0x2d079e(0x2f4)][_0x2d079e(0x2ca)](_0x2d079e(0x330)),installPythonDependencies(_0x2835ce),![];return!![];}function installPythonDependencies(_0x1fb947){const _0x55f26d=a0_0x38181c;if(_0x1fb947['dependencyInstallInProgress'])return;_0x1fb947[_0x55f26d(0x2f3)]=!![];const _0xa8c4c=path['join'](__dirname,'python_service','requirements.txt');stopPythonService(_0x1fb947);if(fs['existsSync'](VENV_PATH))try{fs[_0x55f26d(0x266)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x231b69){}exec(_0x55f26d(0x33d)+VENV_PATH+'\x22',_0x5f2096=>{const _0x5e0397=_0x55f26d;if(_0x5f2096){_0x1fb947[_0x5e0397(0x2f4)][_0x5e0397(0x2c5)](_0x5e0397(0x308)+_0x5f2096[_0x5e0397(0x1cf)]),_0x1fb947['dependencyInstallInProgress']=![];return;}installRequirementsInVenv(_0x1fb947,_0xa8c4c);});}function installRequirementsInVenv(_0x1aa861,_0x2447c9){const _0x5f3f19=a0_0x38181c;_0x1aa861[_0x5f3f19(0x2f4)][_0x5f3f19(0x290)]('Installing\x20pip\x20packages...');const _0x24a813='\x22'+PIP_EXE+_0x5f3f19(0x1ab)+_0x2447c9+'\x22';exec(_0x24a813,{'timeout':0x124f80},(_0x3f1314,_0xb00dcb,_0x42be4e)=>{const _0x391bc7=_0x5f3f19;_0x1aa861[_0x391bc7(0x2f3)]=![],_0x3f1314?_0x1aa861['log'][_0x391bc7(0x2c5)](_0x391bc7(0x1dd)+(_0x42be4e||_0x3f1314[_0x391bc7(0x1cf)])):(_0x1aa861[_0x391bc7(0x2f4)]['info'](_0x391bc7(0x2c0)),startSystem(_0x1aa861));});}async function initZombies(_0x38f979){const _0x1478de=a0_0x38181c;try{const _0x17e5c5=[_0x1478de(0x2a0),_0x1478de(0x235)];for(const _0xd1c7ed of _0x17e5c5){try{const _0x1b4f77=await _0x38f979[_0x1478de(0x278)](_0xd1c7ed);if(_0x1b4f77)await _0x38f979['delObjectAsync'](_0xd1c7ed);}catch(_0x4bb85f){}}}catch(_0x3daf54){}}async function checkLicense(_0xcc3b97){return!![];}async function initHistory(_0x1b6693){const _0x182b94=a0_0x38181c;try{const _0x1468d8=await _0x1b6693['getStateAsync'](_0x182b94(0x323));_0x1468d8&&_0x1468d8[_0x182b94(0x2d6)]&&(_0x1b6693['eventHistory']=JSON['parse'](_0x1468d8[_0x182b94(0x2d6)]['toString']()));}catch(_0x6d4455){_0x1b6693['eventHistory']=[];}try{const _0x2e6a71=await _0x1b6693[_0x182b94(0x2d9)](_0x182b94(0x31b));if(_0x2e6a71&&_0x2e6a71['val'])_0x1b6693[_0x182b94(0x2ea)]=JSON['parse'](_0x2e6a71[_0x182b94(0x2d6)][_0x182b94(0x2a8)]());}catch(_0x5d084c){_0x1b6693[_0x182b94(0x2ea)]=[];}if(_0x1b6693[_0x182b94(0x331)]&&_0x1b6693[_0x182b94(0x331)]['length']>0x0){_0x1b6693[_0x182b94(0x2f4)]['info']('Restoring\x20sensor\x20cache...');for(let _0x455ee1=_0x1b6693['eventHistory']['length']-0x1;_0x455ee1>=0x0;_0x455ee1--){const _0x552739=_0x1b6693[_0x182b94(0x331)][_0x455ee1];if(_0x552739&&_0x552739['id']!==undefined&&_0x552739[_0x182b94(0x28d)]!==undefined)_0x1b6693[_0x182b94(0x310)][_0x552739['id']]=_0x552739[_0x182b94(0x28d)];}}}async function initSystemConfig(_0x1e6a13){const _0x2a1312=a0_0x38181c;try{const _0x472b14=await _0x1e6a13['getForeignObjectAsync'](_0x2a1312(0x1b7));if(_0x472b14&&_0x472b14['common'])_0x1e6a13['systemConfig']={'latitude':_0x472b14[_0x2a1312(0x2d8)][_0x2a1312(0x321)]||0x0,'longitude':_0x472b14[_0x2a1312(0x2d8)][_0x2a1312(0x297)]||0x0,'city':_0x472b14[_0x2a1312(0x2d8)][_0x2a1312(0x1e1)]||''};}catch(_0xa0e226){}}async function createAllObjects(_0x24bd11){const _0x1a513f=a0_0x38181c;await _0x24bd11[_0x1a513f(0x34c)](_0x1a513f(0x1d7),{'type':_0x1a513f(0x20e),'common':{'name':_0x1a513f(0x33e)},'native':{}}),await _0x24bd11[_0x1a513f(0x34c)](SYSTEM_DP_MODE,{'type':_0x1a513f(0x227),'common':{'name':'System\x20Mode','type':_0x1a513f(0x1f0),'role':_0x1a513f(0x227),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x1a513f(0x257)]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x2d2),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x1b8),'type':_0x1a513f(0x1f0),'role':'text','read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)]('events.lastEvent',{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x1b4),'type':_0x1a513f(0x1f0),'role':_0x1a513f(0x328),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)]('events.history',{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x1dc),'type':_0x1a513f(0x1f0),'role':'json','read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x34c)]('analysis.training',{'type':'channel','common':{'name':'AI\x20Training'},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x2aa),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x301),'type':_0x1a513f(0x241),'role':_0x1a513f(0x23c),'read':!![],'write':!![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x1b9),{'type':_0x1a513f(0x227),'common':{'name':'Train\x20Health','type':_0x1a513f(0x241),'role':_0x1a513f(0x23c),'read':!![],'write':!![]},'native':{}}),await _0x24bd11['setObjectNotExistsAsync'](_0x1a513f(0x1ec),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x319),'type':'boolean','role':_0x1a513f(0x23c),'read':!![],'write':!![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)]('analysis.training.triggerComfort',{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x1bd),'type':_0x1a513f(0x241),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x327),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x256),'type':_0x1a513f(0x1f0),'role':'text','read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x34c)]('analysis.security',{'type':'channel','common':{'name':_0x1a513f(0x2a1)},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x26e),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x2e1),'type':'number','role':'value','read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x244),{'type':'state','common':{'name':_0x1a513f(0x252),'type':'number','role':_0x1a513f(0x28d),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x30c),{'type':'state','common':{'name':_0x1a513f(0x316),'type':_0x1a513f(0x1f0),'role':'date','read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x34c)](_0x1a513f(0x2e3),{'type':'channel','common':{'name':_0x1a513f(0x27f)},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x29f),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x316),'type':_0x1a513f(0x1f0),'role':_0x1a513f(0x210),'read':!![],'write':![]},'native':{}}),await _0x24bd11['setObjectNotExistsAsync'](_0x1a513f(0x30f),{'type':'state','common':{'name':_0x1a513f(0x1df),'type':_0x1a513f(0x241),'role':_0x1a513f(0x1c0),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x1cc),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x288),'type':_0x1a513f(0x1f0),'role':_0x1a513f(0x337),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x1e0),{'type':'state','common':{'name':'Trend\x20Value','type':_0x1a513f(0x1d5),'role':_0x1a513f(0x28d),'read':!![],'write':![]},'native':{}}),await _0x24bd11['extendObjectAsync'](_0x1a513f(0x271),{'type':_0x1a513f(0x20e),'common':{'name':_0x1a513f(0x20d)},'native':{}}),await _0x24bd11['setObjectNotExistsAsync'](_0x1a513f(0x205),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x21b),'type':_0x1a513f(0x1f0),'role':_0x1a513f(0x337),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x1cb),{'type':'state','common':{'name':_0x1a513f(0x1d0),'type':_0x1a513f(0x1f0),'role':'text','read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x34c)]('LTM',{'type':'channel','common':{'name':'LTM'},'native':{}}),await _0x24bd11['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x20b),'type':_0x1a513f(0x1f0),'role':'json','read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x34c)](LTM_DP_DAILY_DIGESTS,{'type':_0x1a513f(0x227),'common':{'name':'Daily\x20Digests','type':_0x1a513f(0x1f0),'role':_0x1a513f(0x328),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x2fb),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x34b),'type':_0x1a513f(0x1f0),'role':_0x1a513f(0x328),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x27b),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x211),'type':_0x1a513f(0x1f0),'role':_0x1a513f(0x328),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x24c),{'type':'state','common':{'name':'Trigger\x20Analysis','type':_0x1a513f(0x241),'role':_0x1a513f(0x23c),'read':!![],'write':!![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x1f2),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x269),'type':'boolean','role':_0x1a513f(0x23c),'read':!![],'write':!![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x225),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x2dc),'type':'boolean','role':_0x1a513f(0x243),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x324),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x22c),'type':'string','role':_0x1a513f(0x265),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x2cd),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x222),'type':_0x1a513f(0x1f0),'role':_0x1a513f(0x337),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x239),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x1fd),'type':_0x1a513f(0x241),'role':_0x1a513f(0x1c0),'read':!![],'write':![]},'native':{}}),await _0x24bd11['setObjectNotExistsAsync']('analysis.automation.description',{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x1c3),'type':_0x1a513f(0x1f0),'role':_0x1a513f(0x337),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x2ee),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x207),'type':'string','role':_0x1a513f(0x328),'read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x2df),{'type':_0x1a513f(0x227),'common':{'name':'Target\x20ID','type':_0x1a513f(0x1f0),'role':'text','read':!![],'write':![]},'native':{}}),await _0x24bd11['setObjectNotExistsAsync']('analysis.automation.targetValue',{'type':_0x1a513f(0x227),'common':{'name':'Target\x20Value','type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)](_0x1a513f(0x312),{'type':_0x1a513f(0x227),'common':{'name':_0x1a513f(0x2ce),'type':'boolean','role':_0x1a513f(0x340),'read':!![],'write':!![]},'native':{}}),await _0x24bd11[_0x1a513f(0x322)]('analysis.automation.triggerAction',{'type':_0x1a513f(0x227),'common':{'name':'Trigger\x20Action','type':_0x1a513f(0x241),'role':'button','read':!![],'write':!![]},'native':{}});}function a0_0x1d0d(){const _0x3940ea=['stateChange','isPresent','ðŸš€\x20Starting\x20System\x20Logic...','analysisHistory','splice','Err:\x20','No\x20instance','analysis.automation.detectedPatterns','isAlert','system.mode','Success','weatherInstance','dependencyInstallInProgress','log','cancel','heating','win32','TREND_RESULT','Digest','expire','LTM.trainingData.sequences','driftAnalysisTimer','.\x20EVENTS:\x20','setStateAsync','N/A','SECURITY_RESULT','Train\x20Security','python','25856hMAtNG','WiFi\x20Presence\x20detected.','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','exitGraceTimer','ðŸ”\x20Scanning\x20for\x20devices...','âŒ\x20VENV\x20FAILED:\x20','\x0aGrund:\x20','briefingJob','.\x20EMERGENCY:\x20','analysis.security.lastCheck','analysis.automation.triggerAction','system.isPresent','analysis.health.isAnomaly','sensorLastValues','LTM\x20Sched\x20Error:\x20','analysis.automation.autoApply','analysis.training.triggerComfort','[RESULT]','kill','Last\x20Check','@google/generative-ai','Alarm','Train\x20Energy','close','analysis.analysisHistory','details','onUnload','modeResetJob','âœ…\x20Alles\x20OK\x20(Reset)','Briefing\x20Error:\x20','latitude','setObjectNotExistsAsync','events.history','analysis.alertReason','pip','instance','analysis.training.status','json','lampe','from','notifyPushoverRecipient','subscribeStates','Gemini\x20Error:\x20','generateContent','callback','âš ï¸\x20Python\x20VENV\x20missing.\x20Installing\x20locally...','eventHistory','320dRIMXu','.venv','python3','name','simulateButler','text','90ziQHqn','ðŸš¨\x20EMERGENCY','namespace','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','writable','python3\x20-m\x20venv\x20\x22','System','42mqHCPY','switch','livingContext','success','TRAINING_COMPLETE','door','split','now','onStateChange','Reset\x20Sched\x20Error:\x20','User\x20dismissed\x20automation\x20proposal.','Failed:\x20','Sequences','extendObjectAsync','apiKey','status','.communicate.request','.Current.Temperature','Kein\x20API\x20Key.','ltmStbWindowDays','LTM.driftAnalysis.baselineDrift','dismissAutomation','trim','submitFeedback','data','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','rating','Training\x20Error:\x20','getForeignStateAsync','HEALTH_RESULT','push','briefingTime','notifyEmailInstance','alertReason','Last\x20raw\x20event','licht','enum.functions.*','system.config','Who\x20is\x20present?','analysis.training.triggerHealth','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','12226wLJvBg','ltmJob','Train\x20Comfort','390511lQAaAy','Unknown','indicator','Scripts','cogni-living\x20adapter\x20starting\x20(v','Description','loc','sendTo','payload','useWeather','rawEventLog','ltmDriftCheckIntervalHours','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','analysis.energy.heatingScore','analysis.health.trendDiagnosis','search','analysisTimer','message','Heating\x20Score','send','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','openweathermap','getLtmData','number','confidence','system','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','analysis.automation.targetValue','normal','Event\x20History','âŒ\x20INSTALL\x20FAILED:\x20','pythonProcess','Anomaly\x20Detected','analysis.health.trendValue','city','lastAlertState','TRAIN_HEALTH','command','isProVersion','bewegung','subscribeForeignStatesAsync','cogni-living','bin','OK:\x20','Keine\x20Termine.','analysis.training.triggerEnergy','.\x20SYSTEM_MODE:\x20','minDaysForBaseline','outdoorSensorId','string','Fokus\x20auf\x20Komfort.','analysis.triggerBriefing','includes','\x20->\x20','Activity-Level','toISOString','(((.+)+)+)+$','âš ï¸\x20SECURITY\x20ALARM:\x20','config','platform','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','notifyEmailRecipient','Pattern\x20Detected','KI-Modell\x20nicht\x20initialisiert','TRAIN_SECURITY','Wetterdaten\x20deaktiviert.','communicate.request','GUEST','toFixed','Kein\x20API\x20Key!','analysis.energy.insulationScore','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','Detected\x20Patterns','find','unshift','Analysiere\x20ausgewogen.','Raw\x20Log','currentSystemMode','Energy\x20Intelligence','channel','detected','date','Thermodynamics','insulation','COGNI_REQUEST_CALL','useCalendar','COGNI_CONFIRM_OK','node-schedule','isEmergency','child_process','ðŸ§ \x20Triggering\x20Security\x20Training...','sendToAsync','Insulation\x20Score','role','unload','getForeignObjectsAsync','enum','round','accuweather','Activity\x20Summary','join','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','analysis.isAlert','BUTLER\x20Execution\x20Error:\x20','state','TRAIN_ENERGY','values','onReady','LTM.baselineStatus','Alert\x20Reason','parse','Sec-Training\x20started...','.NextHours.Location_1.Day_1.current.temp_value','location','doors','unknown','notifyTelegramRecipient','COMFORT_RESULT','events.history_debug_00','.forecast.current.temperature','ready','Gemini\x20Init\x20Error:\x20','analysis.automation.patternDetected','getTime','pip.exe','button','TRAIN_COMFORT','weatherunderground','setForeignStateAsync','summary','boolean','pop','indicator.alarm','analysis.security.currentThreshold','4200520BXQVMZ','PARTY','replace','activityLevel','debug','isGracePeriodActive','inactivityThresholdHours','analysis.trigger','slice','systemConfig','Lernphase\x20(','models/gemini-flash-latest','getCalendarNames','Current\x20Threshold','baselineDrift','map','triggerDailyDigest','Training\x20Status','NORMAL','geminiModel','analysis.automation.description','N/A\x20(Learning)','536ZaRqCK','substring','kontakt','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','party','analysisInterval','Keine\x20Wetterdaten\x20verfÃ¼gbar.','is_anomaly','exitTimer','siren','text.alarm','rmSync','stringify','Deaktiviert\x20(Pro-Feature)','Trigger\x20Briefing','light','6331591rLRTzh','Fokus\x20auf\x20Familienroutinen.','stdout','analysis.security.lastScore','exports','Adapter','analysis.energy','setState','indexOf','temperature','automationProposal','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','VACATION','getObjectAsync','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','notifyEmailEnabled','LTM.trainingData.thermodynamics','toLocaleTimeString','targetId','ANALYZE_SEQUENCE','Health\x20Analysis','\x20=\x20','occupancy','Cogni-Living','Briefing\x20Sched\x20Error:\x20','Started...','getMonth','daswetter','notifyTelegramInstance','Trend','some','Skipped\x20(No\x20AI\x20or\x20Data)','dimmer','\x20*\x20*\x20*','value','version','Gemini\x20AI\x20initialized.','info','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','aiPersona','PRIORITÃ„T:\x20Sicherheit.','autoApply','[PYTHON]\x20','ðŸŒ…\x20Morning\x20Briefing:\x0a','longitude','getHours','fenster','dailyDigests','motion','window','lights','klima','analysis.health.lastCheck','analysis.history_debug_00','Security\x20Monitor','main','presenceDevices','temperatur','change_percent','startsWith','automation.triggerAction','toString','getDate','analysis.training.triggerSecurity','ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','triggerBriefing','Â°C,\x20','getOverviewData','\x0aSTB:\x20','devices','LTM.rawEventLog','ANALYZE_TREND','timestamp','type','existsSync','geminiApiKey','object','\x20new\x20patterns.','length','bind','Missing\x20data','toLowerCase','6QXrsYK','targetValue','ENERGY_TRAIN_RESULT','âœ…\x20INSTALL\x20SUCCESS.','driftDetails','LTM.dailyDigests','forEach','08:00','error','Drift\x20Sched\x20Error:\x20','scheduleJob','response','ltmLtbWindowDays','warn','path','reason','analysis.activitySummary','Auto\x20Apply','ðŸ\x20Python\x20Pong','LTM.processingStatus','sound','system.presenceWho','âš ï¸\x20ALARM:\x20','events.lastEvent','genAI','val','Error\x20launching\x20Python:\x20','common','getStateAsync','systemUUID','19320ZDbtOm','Alert\x20Status','getGenerativeModel','heizung','analysis.automation.targetId','telegram','Anomaly\x20Score','ack','analysis.health','LTM.driftAnalysis','16869480JDOlEr','LTM.driftAnalysis.lastCheck'];a0_0x1d0d=function(){return _0x3940ea;};return a0_0x1d0d();}async function loadSystemMode(_0x4818c5){const _0x3255fe=a0_0x38181c;try{const _0x259d65=await _0x4818c5['getStateAsync'](SYSTEM_DP_MODE);_0x259d65&&_0x259d65[_0x3255fe(0x2d6)]&&Object[_0x3255fe(0x229)](SYSTEM_MODES)[_0x3255fe(0x1f3)](_0x259d65[_0x3255fe(0x2d6)])?_0x4818c5[_0x3255fe(0x20c)]=_0x259d65[_0x3255fe(0x2d6)]:(_0x4818c5[_0x3255fe(0x20c)]=SYSTEM_MODES['NORMAL'],await _0x4818c5[_0x3255fe(0x2fe)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3255fe(0x257)],'ack':!![]}));}catch(_0x3611aa){_0x4818c5[_0x3255fe(0x20c)]=SYSTEM_MODES[_0x3255fe(0x257)];}}async function loadRawEventLog(_0x7e41d0){const _0x3fcdaf=a0_0x38181c;try{const _0x2d06cb=await _0x7e41d0[_0x3fcdaf(0x2d9)](LTM_DP_RAW_LOG);if(_0x2d06cb&&_0x2d06cb[_0x3fcdaf(0x2d6)])_0x7e41d0[_0x3fcdaf(0x1c8)]=JSON[_0x3fcdaf(0x22d)](_0x2d06cb[_0x3fcdaf(0x2d6)]);}catch(_0xcb4232){_0x7e41d0[_0x3fcdaf(0x1c8)]=[];}}async function saveRawEventLog(_0x171c79){const _0x256aa=a0_0x38181c;if(_0x171c79[_0x256aa(0x1c8)][_0x256aa(0x2b9)]>RAW_LOG_MAX_SIZE)_0x171c79[_0x256aa(0x1c8)][_0x256aa(0x2eb)](0x0,_0x171c79[_0x256aa(0x1c8)][_0x256aa(0x2b9)]-RAW_LOG_MAX_SIZE);await _0x171c79[_0x256aa(0x2fe)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x171c79[_0x256aa(0x1c8)]),'ack':!![]});}async function loadDailyDigests(_0x5ed612){const _0x4747d3=a0_0x38181c;try{const _0x577e6b=await _0x5ed612['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x577e6b&&_0x577e6b[_0x4747d3(0x2d6)])_0x5ed612[_0x4747d3(0x29a)]=JSON[_0x4747d3(0x22d)](_0x577e6b['val']);}catch(_0x32dc0f){_0x5ed612[_0x4747d3(0x29a)]=[];}await updateBaselineStatus(_0x5ed612);}async function saveDailyDigests(_0x5cf5bb,_0x4a7a84=!![]){const _0x3eecff=a0_0x38181c,_0x13501e=_0x5cf5bb[_0x3eecff(0x1f9)][_0x3eecff(0x2c9)]||0x3c;_0x5cf5bb[_0x3eecff(0x29a)]['length']>_0x13501e&&_0x5cf5bb['dailyDigests']['splice'](0x0,_0x5cf5bb[_0x3eecff(0x29a)][_0x3eecff(0x2b9)]-_0x13501e);await _0x5cf5bb[_0x3eecff(0x2fe)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x3eecff(0x267)](_0x5cf5bb[_0x3eecff(0x29a)]),'ack':!![]});if(_0x4a7a84)await updateBaselineStatus(_0x5cf5bb);}function a0_0x52d6(_0x113864,_0xfa0e90){const _0x4dbeba=a0_0x1d0d();return a0_0x52d6=function(_0x512f88,_0x725697){_0x512f88=_0x512f88-0x1a5;let _0x1d0df2=_0x4dbeba[_0x512f88];return _0x1d0df2;},a0_0x52d6(_0x113864,_0xfa0e90);}async function updateAnalysisHistory(_0x4a6a17,_0x45edef){const _0x343688=a0_0x38181c;_0x4a6a17['analysisHistory'][_0x343688(0x209)](_0x45edef);if(_0x4a6a17[_0x343688(0x2ea)][_0x343688(0x2b9)]>HISTORY_MAX_SIZE)_0x4a6a17[_0x343688(0x2ea)][_0x343688(0x242)]();await _0x4a6a17[_0x343688(0x2fe)](_0x343688(0x31b),{'val':JSON[_0x343688(0x267)](_0x4a6a17['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x5a099b){const _0x39ff90=a0_0x38181c;if(!_0x5a099b[_0x39ff90(0x1e5)]){await _0x5a099b['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x39ff90(0x268),'ack':!![]});return;}const _0x79d663=_0x5a099b[_0x39ff90(0x29a)][_0x39ff90(0x2b9)]>=(_0x5a099b[_0x39ff90(0x1f9)][_0x39ff90(0x1ee)]||0x7)?'Aktiv\x20('+_0x5a099b['dailyDigests'][_0x39ff90(0x2b9)]+'\x20Tage)':_0x39ff90(0x24f)+_0x5a099b[_0x39ff90(0x29a)][_0x39ff90(0x2b9)]+'/'+(_0x5a099b[_0x39ff90(0x1f9)]['minDaysForBaseline']||0x7)+')';await _0x5a099b[_0x39ff90(0x2fe)](LTM_DP_BASELINE_STATUS,{'val':_0x79d663,'ack':!![]});}async function initSensorSubscriptions(_0x2e1ff6){const _0x57c6f9=a0_0x38181c,_0x2ea47b=_0x2e1ff6[_0x57c6f9(0x1f9)][_0x57c6f9(0x2b0)];if(_0x2ea47b)for(const _0x42111d of _0x2ea47b){await _0x2e1ff6[_0x57c6f9(0x1e7)](_0x42111d['id']);}}async function initPresenceSubscriptions(_0x51f2f8){const _0x1f5c42=a0_0x38181c,_0x2176f1=_0x51f2f8[_0x1f5c42(0x1f9)][_0x1f5c42(0x2a3)];if(_0x2176f1)for(const _0x3de83d of _0x2176f1){await _0x51f2f8[_0x1f5c42(0x1e7)](_0x3de83d);}}async function setupTelegramListener(_0x429f7c){const _0x25e229=a0_0x38181c,_0xa86f7f=_0x429f7c['config'][_0x25e229(0x287)];if(_0x429f7c[_0x25e229(0x1f9)]['notifyTelegramEnabled']&&_0xa86f7f)await _0x429f7c[_0x25e229(0x1e7)](_0xa86f7f+_0x25e229(0x34f));}async function checkWifiPresence(_0x3a0f66){const _0x2d8a89=a0_0x38181c;try{const _0xc6b44c=_0x3a0f66[_0x2d8a89(0x1f9)][_0x2d8a89(0x2a3)]||[];let _0x362a10=![];const _0x116e65=[];for(const _0x2de05d of _0xc6b44c){try{const _0x57eaeb=await _0x3a0f66[_0x2d8a89(0x1ae)](_0x2de05d);_0x57eaeb&&(_0x57eaeb[_0x2d8a89(0x2d6)]===!![]||_0x57eaeb[_0x2d8a89(0x2d6)]==='online'||_0x57eaeb['val']===0x1)&&(_0x362a10=!![],_0x116e65[_0x2d8a89(0x1b0)](_0x2de05d));}catch(_0x493022){}}return await _0x3a0f66[_0x2d8a89(0x2fe)](_0x2d8a89(0x2d2),{'val':_0x116e65['join'](',\x20'),'ack':!![]}),_0x362a10&&(_0x3a0f66[_0x2d8a89(0x263)]&&(_0x3a0f66[_0x2d8a89(0x2f4)][_0x2d8a89(0x290)](_0x2d8a89(0x304)),abortExitTimer(_0x3a0f66)),!_0x3a0f66['isPresent']&&_0x3a0f66[_0x2d8a89(0x20c)]===SYSTEM_MODES[_0x2d8a89(0x257)]&&await setPresence(_0x3a0f66,!![])),_0x362a10;}catch(_0xc0b044){return![];}}function startExitTimer(_0x569299){const _0x4a3722=a0_0x38181c;abortExitTimer(_0x569299),_0x569299[_0x4a3722(0x24a)]=!![],_0x569299[_0x4a3722(0x306)]=setTimeout(()=>{const _0x46bd42=_0x4a3722;_0x569299[_0x46bd42(0x24a)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x569299[_0x4a3722(0x263)]=setTimeout(()=>{setPresence(_0x569299,![]),_0x569299['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x32864a){const _0x3f55f2=a0_0x38181c;if(_0x32864a[_0x3f55f2(0x263)])clearTimeout(_0x32864a['exitTimer']);if(_0x32864a[_0x3f55f2(0x306)])clearTimeout(_0x32864a['exitGraceTimer']);_0x32864a[_0x3f55f2(0x263)]=null,_0x32864a[_0x3f55f2(0x306)]=null,_0x32864a[_0x3f55f2(0x24a)]=![];}async function setPresence(_0x28fc34,_0x4976bd){const _0x1bdcad=a0_0x38181c;if(_0x28fc34[_0x1bdcad(0x2e8)]===_0x4976bd)return;_0x28fc34[_0x1bdcad(0x2e8)]=_0x4976bd,await _0x28fc34[_0x1bdcad(0x2fe)](_0x1bdcad(0x30e),{'val':_0x4976bd,'ack':!![]});}async function executeAutomationAction(_0x3e9cdb){const _0x46bd70=a0_0x38181c;try{const _0x187afa=await _0x3e9cdb[_0x46bd70(0x2d9)](_0x46bd70(0x2df)),_0x2843a7=await _0x3e9cdb[_0x46bd70(0x2d9)](_0x46bd70(0x1da));if(_0x187afa&&_0x187afa[_0x46bd70(0x2d6)]&&_0x2843a7){const _0x391d37=_0x187afa[_0x46bd70(0x2d6)];let _0x51701e=_0x2843a7['val'];try{_0x51701e=JSON[_0x46bd70(0x22d)](_0x51701e);}catch(_0x2d693d){}_0x3e9cdb[_0x46bd70(0x2f4)]['info'](_0x46bd70(0x206)+_0x391d37+_0x46bd70(0x280)+_0x51701e),await _0x3e9cdb[_0x46bd70(0x23f)](_0x391d37,_0x51701e);}else _0x3e9cdb[_0x46bd70(0x2f4)][_0x46bd70(0x2ca)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x5e640d){_0x3e9cdb[_0x46bd70(0x2f4)][_0x46bd70(0x2c5)](_0x46bd70(0x226)+_0x5e640d[_0x46bd70(0x1cf)]);}}async function processSensorEvent(_0x5b67c9,_0x266392,_0x1205a5,_0x19c5b7){const _0x5b559a=a0_0x38181c;if(!_0x19c5b7)return;const _0x15a15d=_0x1205a5[_0x5b559a(0x2d6)],_0x245aef=Date[_0x5b559a(0x346)](),_0x186266=_0x5b67c9['sensorLastValues'][_0x266392];_0x5b67c9[_0x5b559a(0x310)][_0x266392]=_0x15a15d;if(!_0x19c5b7['logDuplicates']&&_0x186266!=undefined&&_0x186266==_0x15a15d)return;const _0x23180d=(_0x19c5b7[_0x5b559a(0x2b4)]||'')['toLowerCase'](),_0xd5858c=_0x23180d[_0x5b559a(0x1f3)](_0x5b559a(0x274))||_0x23180d[_0x5b559a(0x1f3)](_0x5b559a(0x2a4))||_0x23180d[_0x5b559a(0x1f3)](_0x5b559a(0x29e))||_0x23180d[_0x5b559a(0x1f3)](_0x5b559a(0x2de));_0x5b67c9[_0x5b559a(0x1e5)]&&_0xd5858c&&recordThermodynamics(_0x5b67c9,_0x266392,_0x15a15d,_0x19c5b7['location']);const _0x2ea746={'timestamp':_0x245aef,'id':_0x266392,'name':_0x19c5b7['name'],'type':_0x19c5b7[_0x5b559a(0x2b4)],'location':_0x19c5b7['location'],'value':_0x15a15d};_0x5b67c9['eventHistory'][_0x5b559a(0x209)](_0x2ea746);if(_0x5b67c9['eventHistory'][_0x5b559a(0x2b9)]>HISTORY_MAX_SIZE)_0x5b67c9['eventHistory'][_0x5b559a(0x242)]();await _0x5b67c9['setStateAsync'](_0x5b559a(0x2d4),{'val':JSON[_0x5b559a(0x267)](_0x2ea746),'ack':!![]}),await _0x5b67c9[_0x5b559a(0x2fe)](_0x5b559a(0x323),{'val':JSON[_0x5b559a(0x267)](_0x5b67c9[_0x5b559a(0x331)]),'ack':!![]});_0x5b67c9[_0x5b559a(0x1e5)]&&(_0x5b67c9[_0x5b559a(0x1c8)]['push'](_0x2ea746),await saveRawEventLog(_0x5b67c9),recordSequence(_0x5b67c9,_0x2ea746));if(_0x19c5b7['isExit']&&_0x15a15d===!![]){if(_0x5b67c9[_0x5b559a(0x2e8)]&&!_0x5b67c9[_0x5b559a(0x24a)])startExitTimer(_0x5b67c9);else{if(!_0x5b67c9[_0x5b559a(0x2e8)])setPresence(_0x5b67c9,!![]);}}else{if(_0x19c5b7['type']===_0x5b559a(0x29b)&&_0x15a15d===!![]){if(_0x5b67c9[_0x5b559a(0x263)])abortExitTimer(_0x5b67c9);if(!_0x5b67c9['isPresent']&&_0x5b67c9[_0x5b559a(0x20c)]===SYSTEM_MODES['NORMAL'])setPresence(_0x5b67c9,!![]);}}}async function recordThermodynamics(_0x35bdc6,_0x4722aa,_0x5aebb9,_0x3923bd){const _0x43bcd9=a0_0x38181c,_0x538da4=await getOutsideTemperatureNumeric(_0x35bdc6),_0x41d988=await _0x35bdc6[_0x43bcd9(0x2d9)](_0x43bcd9(0x27b));let _0x44bf2e=[];if(_0x41d988&&_0x41d988[_0x43bcd9(0x2d6)])try{_0x44bf2e=JSON[_0x43bcd9(0x22d)](_0x41d988[_0x43bcd9(0x2d6)]);}catch(_0x1f5391){}_0x44bf2e[_0x43bcd9(0x1b0)]({'ts':Date[_0x43bcd9(0x346)](),'room':_0x3923bd||_0x43bcd9(0x1bf),'t_in':_0x5aebb9,'t_out':_0x538da4});if(_0x44bf2e[_0x43bcd9(0x2b9)]>THERMO_LOG_SIZE)_0x44bf2e['shift']();await _0x35bdc6[_0x43bcd9(0x2fe)](_0x43bcd9(0x27b),{'val':JSON[_0x43bcd9(0x267)](_0x44bf2e),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x16541e){const _0x32a61a=a0_0x38181c;if(_0x16541e[_0x32a61a(0x1f9)][_0x32a61a(0x1ef)])try{const _0x186a62=await _0x16541e[_0x32a61a(0x1ae)](_0x16541e[_0x32a61a(0x1f9)][_0x32a61a(0x1ef)]);if(_0x186a62&&_0x186a62['val']!==undefined&&_0x186a62[_0x32a61a(0x2d6)]!==null)return parseFloat(_0x186a62['val']);}catch(_0x540b78){}const _0xbd8a2a=_0x16541e['config'][_0x32a61a(0x2f2)];if(!_0x16541e[_0x32a61a(0x1f9)][_0x32a61a(0x1c7)]||!_0xbd8a2a)return null;try{let _0x3d6c5a='';if(_0xbd8a2a[_0x32a61a(0x1f3)](_0x32a61a(0x221)))_0x3d6c5a=_0xbd8a2a+_0x32a61a(0x350);else{if(_0xbd8a2a['includes'](_0x32a61a(0x286)))_0x3d6c5a=_0xbd8a2a+_0x32a61a(0x22f);else{if(_0xbd8a2a['includes'](_0x32a61a(0x1d3)))_0x3d6c5a=_0xbd8a2a+'.forecast.current.temperature';else{if(_0xbd8a2a[_0x32a61a(0x1f3)](_0x32a61a(0x23e)))_0x3d6c5a=_0xbd8a2a+'.forecast.current.temp';}}}if(_0x3d6c5a){const _0x397c0a=await _0x16541e['getForeignStateAsync'](_0x3d6c5a);if(_0x397c0a&&_0x397c0a[_0x32a61a(0x2d6)]!==undefined&&_0x397c0a[_0x32a61a(0x2d6)]!==null)return parseFloat(_0x397c0a[_0x32a61a(0x2d6)]);}}catch(_0x7c042e){}return null;}async function recordSequence(_0x6bb6ad,_0x53d569){const _0x2b1a52=a0_0x38181c,_0x5d0c8a=(_0x53d569[_0x2b1a52(0x2b4)]||'')[_0x2b1a52(0x2bc)](),_0x3ac0c7=[_0x2b1a52(0x29b),_0x2b1a52(0x1e6),'prÃ¤senz','presence',_0x2b1a52(0x281),_0x2b1a52(0x344),'tÃ¼r',_0x2b1a52(0x29c),_0x2b1a52(0x299),'contact',_0x2b1a52(0x25d),_0x2b1a52(0x26a),_0x2b1a52(0x1b5),_0x2b1a52(0x340),'schalter',_0x2b1a52(0x28b),_0x2b1a52(0x329)];if(!_0x3ac0c7[_0x2b1a52(0x289)](_0x231082=>_0x5d0c8a[_0x2b1a52(0x1f3)](_0x231082)))return;if(!_0x53d569[_0x2b1a52(0x28d)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x2b1a52(0x1b0)]({'loc':_0x53d569[_0x2b1a52(0x230)]||_0x2b1a52(0x1bf),'id':_0x53d569['id'],'ts':Date[_0x2b1a52(0x346)]()}),sequenceTimer=setTimeout(async()=>{const _0x33563e=_0x2b1a52;if(activeSequence[_0x33563e(0x2b9)]>0x1)await saveCompletedSequence(_0x6bb6ad);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x28aec4){const _0x4fa19e=a0_0x38181c;try{const _0x5cb828=await _0x28aec4[_0x4fa19e(0x2d9)](_0x4fa19e(0x2fb));let _0x2aa40c=[];if(_0x5cb828&&_0x5cb828[_0x4fa19e(0x2d6)])try{_0x2aa40c=JSON['parse'](_0x5cb828[_0x4fa19e(0x2d6)]);}catch(_0xf267f0){}const _0x5d874c=activeSequence[0x0]['ts'],_0x3d33ff=activeSequence[_0x4fa19e(0x254)](_0x5aa195=>({'loc':_0x5aa195[_0x4fa19e(0x1c4)],'t_delta':Math[_0x4fa19e(0x220)]((_0x5aa195['ts']-_0x5d874c)/0x3e8)})),_0x5a068e={'timestamp':new Date(_0x5d874c)[_0x4fa19e(0x1f6)](),'steps':_0x3d33ff,'duration':Math[_0x4fa19e(0x220)]((activeSequence[activeSequence[_0x4fa19e(0x2b9)]-0x1]['ts']-_0x5d874c)/0x3e8),'daytime':new Date(_0x5d874c)[_0x4fa19e(0x298)]()};_0x2aa40c[_0x4fa19e(0x1b0)](_0x5a068e);if(_0x2aa40c[_0x4fa19e(0x2b9)]>MAX_TRAINING_SET_SIZE)_0x2aa40c['shift']();await _0x28aec4['setStateAsync']('LTM.trainingData.sequences',{'val':JSON[_0x4fa19e(0x267)](_0x2aa40c),'ack':!![]}),runSecurityCheck(_0x28aec4,_0x5a068e);}catch(_0x31c853){_0x28aec4[_0x4fa19e(0x2f4)][_0x4fa19e(0x2c5)]('[RECORDER]\x20Error:\x20'+_0x31c853[_0x4fa19e(0x1cf)]);}}function runSecurityCheck(_0x546692,_0x33d3b9){const _0x201429=a0_0x38181c;if(!_0x546692['isProVersion'])return;sendToPython(_0x546692,_0x201429(0x27e),{'sequence':_0x33d3b9});}function sendToPython(_0x1dd665,_0x2477f9,_0x3bab1e={}){const _0x506ed8=a0_0x38181c;if(!_0x1dd665[_0x506ed8(0x1de)]||!_0x1dd665['pythonProcess']['stdin'][_0x506ed8(0x33c)])return;const _0x4a462b=JSON[_0x506ed8(0x267)]({'command':_0x2477f9,..._0x3bab1e});try{_0x1dd665['pythonProcess']['stdin']['write'](_0x4a462b+'\x0a');}catch(_0xf0b72b){}}function startPythonService(_0x59c954){const _0x339197=a0_0x38181c;let _0x1cfef7=_0x339197(0x334);if(fs[_0x339197(0x2b5)](PYTHON_EXE))_0x1cfef7=PYTHON_EXE;try{const _0x193e67=path[_0x339197(0x223)](__dirname,'python_service','service.py');_0x59c954[_0x339197(0x1de)]=spawn(_0x1cfef7,[_0x193e67]),_0x59c954[_0x339197(0x1de)][_0x339197(0x26d)]['on'](_0x339197(0x1aa),_0x1744c7=>{const _0x31c7ba=_0x339197,_0x57296=_0x1744c7[_0x31c7ba(0x2a8)]()[_0x31c7ba(0x345)]('\x0a');_0x57296['forEach'](_0xbc37fe=>{const _0x508c67=_0x31c7ba,_0xcf883e=_0xbc37fe[_0x508c67(0x1a8)]();if(!_0xcf883e)return;if(_0xcf883e[_0x508c67(0x2a6)]('[LOG]'))_0x59c954[_0x508c67(0x2f4)][_0x508c67(0x249)](_0x508c67(0x295)+_0xcf883e[_0x508c67(0x25c)](0x5)[_0x508c67(0x1a8)]());else{if(_0xcf883e[_0x508c67(0x2a6)](_0x508c67(0x314)))try{const _0x5aef74=JSON[_0x508c67(0x22d)](_0xcf883e['substring'](0x8)['trim']());handlePythonResult(_0x59c954,_0x5aef74);}catch(_0x563372){}}});}),_0x59c954[_0x339197(0x1de)]['on'](_0x339197(0x31a),_0x2e3862=>{const _0x4826fc=_0x339197;_0x59c954[_0x4826fc(0x1de)]=null;});}catch(_0x1da7fd){_0x59c954[_0x339197(0x2f4)][_0x339197(0x2c5)](_0x339197(0x2d7)+_0x1da7fd['message']);}}function stopPythonService(_0x2adba9){const _0x396c8e=a0_0x38181c;if(_0x2adba9['pythonProcess']){try{_0x2adba9[_0x396c8e(0x1de)][_0x396c8e(0x315)]();}catch(_0x204c9d){}_0x2adba9[_0x396c8e(0x1de)]=null;}}function handlePythonResult(_0x18af29,_0x6e9627){const _0x5cf495=a0_0x38181c;if(_0x6e9627[_0x5cf495(0x2b4)]==='PONG')_0x18af29[_0x5cf495(0x2f4)][_0x5cf495(0x249)](_0x5cf495(0x2cf));else{if(_0x6e9627['type']===_0x5cf495(0x300)){const {anomaly_score:_0x43368d,is_anomaly:_0x32a0dc,threshold:_0x2d718e,explanation:_0x4df8e8}=_0x6e9627[_0x5cf495(0x1c6)];_0x18af29[_0x5cf495(0x2f4)]['info'](_0x5cf495(0x224)+_0x43368d[_0x5cf495(0x203)](0x5)+_0x5cf495(0x1f4)+(_0x32a0dc?'ANOMALY':'OK')),_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x26e),{'val':_0x43368d,'ack':!![]}),_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x30c),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x2d718e)_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x244),{'val':_0x2d718e,'ack':!![]});if(_0x32a0dc){let _0xed6d12=_0x5cf495(0x305)+_0x43368d[_0x5cf495(0x203)](0x4)+')';if(_0x4df8e8&&_0x4df8e8!==_0x5cf495(0x1bf))_0xed6d12+=_0x5cf495(0x309)+_0x4df8e8;_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x225),{'val':!![],'ack':!![]}),_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x324),{'val':_0xed6d12,'ack':!![]}),sendNotification(_0x18af29,_0x5cf495(0x1f8)+_0xed6d12,![],!![]);}}else{if(_0x6e9627[_0x5cf495(0x2b4)]===_0x5cf495(0x343)){const _0x45d0ca=_0x6e9627[_0x5cf495(0x1c6)]['details']||'',_0x486c97=_0x6e9627[_0x5cf495(0x1c6)]['threshold'],_0x52fb61=_0x6e9627[_0x5cf495(0x1c6)]['success']?'Success:\x20'+new Date()[_0x5cf495(0x27c)]()+'\x20('+_0x45d0ca+')':_0x5cf495(0x34a)+_0x6e9627[_0x5cf495(0x1c6)][_0x5cf495(0x2cc)];_0x18af29[_0x5cf495(0x2fe)]('analysis.training.status',{'val':_0x52fb61,'ack':!![]});if(_0x6e9627[_0x5cf495(0x1c6)][_0x5cf495(0x342)]&&_0x486c97)_0x18af29[_0x5cf495(0x2fe)]('analysis.security.currentThreshold',{'val':_0x486c97,'ack':!![]});}else{if(_0x6e9627[_0x5cf495(0x2b4)]===_0x5cf495(0x234)){const {patterns:_0x334868}=_0x6e9627[_0x5cf495(0x1c6)];if(_0x334868&&_0x334868[_0x5cf495(0x2b9)]>0x0){_0x18af29[_0x5cf495(0x2f4)][_0x5cf495(0x290)](_0x5cf495(0x276)+_0x334868[_0x5cf495(0x2b9)]+_0x5cf495(0x2b8)),_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x2ee),{'val':JSON[_0x5cf495(0x267)](_0x334868),'ack':!![]});const _0x5a1037=_0x334868[0x0],_0x5bfe38='Regel\x20erkannt:\x20'+_0x5a1037['rule']+'\x20('+(_0x5a1037[_0x5cf495(0x1d6)]*0x64)[_0x5cf495(0x203)](0x0)+'%)';_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x239),{'val':!![],'ack':!![]}),_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x259),{'val':_0x5bfe38,'ack':!![]});}else _0x18af29[_0x5cf495(0x2f4)][_0x5cf495(0x290)](_0x5cf495(0x279)),_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x239),{'val':![],'ack':!![]}),_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x2ee),{'val':'[]','ack':!![]});}else{if(_0x6e9627['type']===_0x5cf495(0x2bf)){if(_0x6e9627[_0x5cf495(0x1c6)][_0x5cf495(0x342)])try{const _0x41b626=JSON['parse'](_0x6e9627[_0x5cf495(0x1c6)][_0x5cf495(0x31c)]);if(_0x41b626['insulation'])_0x18af29['setStateAsync'](_0x5cf495(0x205),{'val':JSON[_0x5cf495(0x267)](_0x41b626[_0x5cf495(0x212)]),'ack':!![]});if(_0x41b626[_0x5cf495(0x2f6)])_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x1cb),{'val':JSON[_0x5cf495(0x267)](_0x41b626[_0x5cf495(0x2f6)]),'ack':!![]});}catch(_0x3ca57d){}}else{if(_0x6e9627['type']==='HEALTH_TRAIN_RESULT'){if(_0x6e9627[_0x5cf495(0x1c6)][_0x5cf495(0x342)])_0x18af29[_0x5cf495(0x2f4)][_0x5cf495(0x290)]('âœ…\x20HEALTH\x20TRAINED.');}else{if(_0x6e9627[_0x5cf495(0x2b4)]===_0x5cf495(0x1af))_0x18af29['setStateAsync'](_0x5cf495(0x29f),{'val':new Date()[_0x5cf495(0x1f6)](),'ack':!![]}),_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x30f),{'val':_0x6e9627[_0x5cf495(0x1c6)][_0x5cf495(0x262)],'ack':!![]});else _0x6e9627[_0x5cf495(0x2b4)]===_0x5cf495(0x2f8)&&(_0x18af29[_0x5cf495(0x2fe)](_0x5cf495(0x1cc),{'val':_0x6e9627['payload']['diagnosis'],'ack':!![]}),_0x18af29[_0x5cf495(0x2fe)]('analysis.health.trendValue',{'val':_0x6e9627['payload'][_0x5cf495(0x2a5)],'ack':!![]}));}}}}}}}function runPythonHealthCheck(_0x132651){const _0x3351a5=a0_0x38181c;if(!_0x132651[_0x3351a5(0x29a)]||_0x132651[_0x3351a5(0x29a)][_0x3351a5(0x2b9)]<0x2)return;const _0x35548d=_0x132651[_0x3351a5(0x29a)][_0x3351a5(0x254)](_0x19f1ff=>{const _0x30011b=_0x3351a5,_0x31bae8=(_0x19f1ff[_0x30011b(0x248)]||'')[_0x30011b(0x2bc)]();return ACTIVITY_LEVEL_MAP[_0x31bae8]||0x32;});sendToPython(_0x132651,_0x3351a5(0x2b2),{'values':_0x35548d,'tag':_0x3351a5(0x1f5)});}async function handleTelegramResponse(_0x5f3501,_0x1da070){const _0x4ab18f=a0_0x38181c;let _0x35a026=_0x1da070;_0x1da070[_0x4ab18f(0x2a6)]('[')&&(_0x35a026=_0x1da070[_0x4ab18f(0x25c)](_0x1da070[_0x4ab18f(0x273)](']')+0x1));if(_0x35a026===_0x4ab18f(0x215))await _0x5f3501['setStateAsync'](_0x4ab18f(0x225),{'val':![],'ack':!![]}),await _0x5f3501[_0x4ab18f(0x2fe)](_0x4ab18f(0x324),{'val':'Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ack':!![]}),_0x5f3501[_0x4ab18f(0x1e2)]=![],sendNotification(_0x5f3501,_0x4ab18f(0x1d8),![]);else _0x35a026===_0x4ab18f(0x213)&&sendNotification(_0x5f3501,'ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]);}async function sendNotification(_0x4de947,_0x519a34,_0x53aa4d=![],_0x4e0684=![]){const _0x59256c=a0_0x38181c,_0x5efcb0=_0x4de947[_0x59256c(0x1f9)];if(_0x5efcb0['notifyTelegramEnabled']){let _0x26edb1={};(_0x519a34['includes'](_0x59256c(0x318))||_0x4e0684)&&(_0x26edb1={'reply_markup':{'inline_keyboard':[[{'text':_0x59256c(0x31f),'callback_data':_0x59256c(0x215)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x59256c(0x213)}]]}}),await _0x4de947[_0x59256c(0x21a)](_0x5efcb0[_0x59256c(0x287)],_0x59256c(0x1d1),{'text':_0x519a34,'user':_0x5efcb0[_0x59256c(0x233)],..._0x26edb1});}if(_0x5efcb0['notifyPushoverEnabled']){let _0x23fa42={'message':_0x519a34,'title':_0x4e0684?_0x59256c(0x339):_0x59256c(0x282),'priority':_0x4e0684?0x2:0x1,'device':_0x5efcb0[_0x59256c(0x32b)]};_0x4e0684&&(_0x23fa42['retry']=0x1e,_0x23fa42[_0x59256c(0x2fa)]=0xe10,_0x23fa42[_0x59256c(0x2d1)]=_0x59256c(0x264)),await _0x4de947['sendToAsync'](_0x5efcb0['notifyPushoverInstance'],_0x59256c(0x1d1),_0x23fa42);}_0x5efcb0[_0x59256c(0x27a)]&&await _0x4de947[_0x59256c(0x21a)](_0x5efcb0[_0x59256c(0x1b2)],_0x59256c(0x1d1),{'text':_0x519a34,'to':_0x5efcb0[_0x59256c(0x1fc)]});}async function runGeminiAnalysis(_0x5e2098,_0x135dda=''){const _0x179972=a0_0x38181c;if(!_0x5e2098[_0x179972(0x258)])return;if(_0x5e2098[_0x179972(0x331)][_0x179972(0x2b9)]===0x0)return;const _0x1f98ad=_0x5e2098[_0x179972(0x331)][_0x179972(0x24d)](0x0,0xf),_0x518361=await getWeatherContext(_0x5e2098),_0x1eb4f4=_0x5e2098[_0x179972(0x20c)],_0x4aa1f8=PERSONA_MAPPING[_0x5e2098[_0x179972(0x1f9)][_0x179972(0x292)]||'generic'],_0x270987=_0x5e2098[_0x179972(0x1f9)][_0x179972(0x341)]||'Keine\x20Details.';let _0x2d5dfb='Unbekannt';try{const _0x1553e3=await _0x5e2098[_0x179972(0x2d9)](_0x179972(0x2d2));if(_0x1553e3&&_0x1553e3[_0x179972(0x2d6)])_0x2d5dfb=_0x1553e3[_0x179972(0x2d6)];}catch(_0x4f0f8a){}let _0x389f85=![];try{const _0x5c8db7=await _0x5e2098[_0x179972(0x2d9)](_0x179972(0x312));if(_0x5c8db7&&_0x5c8db7['val'])_0x389f85=!![];}catch(_0x4303d7){}const _0x5eed98=_0x179972(0x1d9)+_0x4aa1f8+'.\x20KONTEXT:\x20'+_0x270987+_0x179972(0x1ed)+_0x1eb4f4+'.\x20WETTER:\x20'+_0x518361+'.\x20ANWESEND:\x20'+_0x2d5dfb+_0x179972(0x2fd)+JSON[_0x179972(0x267)](_0x1f98ad)+_0x179972(0x30b)+_0x135dda+_0x179972(0x1ba);try{const _0x45c796=await _0x5e2098['geminiModel'][_0x179972(0x32e)](_0x5eed98),_0x2efbe1=JSON['parse'](_0x45c796[_0x179972(0x2c8)][_0x179972(0x337)]()[_0x179972(0x247)](/```json|```/g,'')[_0x179972(0x1a8)]());await _0x5e2098['setStateAsync']('analysis.lastResult',{'val':JSON[_0x179972(0x267)](_0x2efbe1),'ack':!![]});if(_0x2efbe1[_0x179972(0x240)])await _0x5e2098[_0x179972(0x2fe)](_0x179972(0x2cd),{'val':_0x2efbe1[_0x179972(0x240)],'ack':!![]});const _0x42bdd2={'timestamp':Date['now'](),'id':Date['now']()[_0x179972(0x2a8)](),'analysis':{'activity':{'summary':_0x2efbe1['summary'],'isAlert':_0x2efbe1[_0x179972(0x2ef)],'alertReason':_0x2efbe1[_0x179972(0x1b3)]},'comfort':{'automationProposal':_0x2efbe1['automationProposal']}}};await updateAnalysisHistory(_0x5e2098,_0x42bdd2);const _0x1863d6=_0x2efbe1[_0x179972(0x2ef)]||![];_0x1863d6!==_0x5e2098[_0x179972(0x1e2)]&&(await _0x5e2098[_0x179972(0x2fe)](_0x179972(0x225),{'val':_0x1863d6,'ack':!![]}),_0x5e2098['lastAlertState']=_0x1863d6,_0x1863d6&&(await _0x5e2098[_0x179972(0x2fe)](_0x179972(0x324),{'val':_0x2efbe1[_0x179972(0x1b3)],'ack':!![]}),sendNotification(_0x5e2098,_0x179972(0x2d3)+_0x2efbe1[_0x179972(0x1b3)],![],_0x2efbe1[_0x179972(0x217)])));if(_0x2efbe1[_0x179972(0x275)]&&_0x2efbe1[_0x179972(0x275)]['detected']){await _0x5e2098[_0x179972(0x2fe)](_0x179972(0x239),{'val':!![],'ack':!![]}),await _0x5e2098['setStateAsync']('analysis.automation.description',{'val':_0x2efbe1[_0x179972(0x275)]['description'],'ack':!![]}),await _0x5e2098['setStateAsync'](_0x179972(0x2df),{'val':_0x2efbe1[_0x179972(0x275)][_0x179972(0x27d)],'ack':!![]}),await _0x5e2098[_0x179972(0x2fe)]('analysis.automation.targetValue',{'val':JSON['stringify'](_0x2efbe1['automationProposal'][_0x179972(0x2be)]),'ack':!![]});if(_0x389f85)executeAutomationAction(_0x5e2098);}}catch(_0x38d66b){_0x5e2098[_0x179972(0x2f4)][_0x179972(0x2c5)](_0x179972(0x32d)+_0x38d66b[_0x179972(0x1cf)]);}}async function createDailyDigest(_0x2c444d){const _0x47ff76=a0_0x38181c;if(!_0x2c444d[_0x47ff76(0x1e5)])return;await _0x2c444d[_0x47ff76(0x2fe)](LTM_DP_STATUS,{'val':_0x47ff76(0x284),'ack':!![]});if(!_0x2c444d[_0x47ff76(0x258)]||_0x2c444d[_0x47ff76(0x1c8)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2c444d[_0x47ff76(0x2fe)](LTM_DP_STATUS,{'val':_0x47ff76(0x28a),'ack':!![]});return;}const _0xd15590=JSON[_0x47ff76(0x22d)](JSON[_0x47ff76(0x267)](_0x2c444d[_0x47ff76(0x1c8)])),_0x3ddede=_0xd15590['length'],_0x272526=_0x47ff76(0x1d2)+JSON[_0x47ff76(0x267)](_0xd15590);try{const _0xb8962=await _0x2c444d[_0x47ff76(0x258)][_0x47ff76(0x32e)](_0x272526),_0x52e1e9=JSON[_0x47ff76(0x22d)](_0xb8962['response'][_0x47ff76(0x337)]()[_0x47ff76(0x247)](/```json|```/g,'')[_0x47ff76(0x1a8)]()),_0x4ead4e={'timestamp':new Date()[_0x47ff76(0x1f6)](),'eventCount':_0x3ddede,'summary':_0x52e1e9['summary']||_0x47ff76(0x2f9),'activityLevel':_0x52e1e9[_0x47ff76(0x248)]||_0x47ff76(0x1db),'systemMode':_0x2c444d['currentSystemMode']};_0x2c444d[_0x47ff76(0x29a)]['push'](_0x4ead4e),await saveDailyDigests(_0x2c444d),_0x2c444d['rawEventLog']=[],await saveRawEventLog(_0x2c444d),await _0x2c444d[_0x47ff76(0x2fe)](LTM_DP_STATUS,{'val':_0x47ff76(0x2f1),'ack':!![]});if(_0x2c444d['isProVersion'])sendToPython(_0x2c444d,'ANALYZE_HEALTH',{'digest':_0x4ead4e});}catch(_0x5a2dc3){_0x2c444d[_0x47ff76(0x2f4)][_0x47ff76(0x2c5)](_0x5a2dc3['message']);}}function setupLtmScheduler(_0x4a1cb2){const _0x1ecced=a0_0x38181c;try{if(_0x4a1cb2[_0x1ecced(0x1bc)])_0x4a1cb2[_0x1ecced(0x1bc)][_0x1ecced(0x2f5)]();if(!_0x4a1cb2[_0x1ecced(0x1e5)])return;_0x4a1cb2[_0x1ecced(0x1bc)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x4a1cb2));}catch(_0x56bb60){_0x4a1cb2[_0x1ecced(0x2f4)]['error'](_0x1ecced(0x311)+_0x56bb60[_0x1ecced(0x1cf)]);}}function setupModeResetScheduler(_0x40bdc6){const _0x257b02=a0_0x38181c;try{if(_0x40bdc6['modeResetJob'])_0x40bdc6[_0x257b02(0x31e)]['cancel']();_0x40bdc6[_0x257b02(0x31e)]=schedule[_0x257b02(0x2c7)](MODE_RESET_SCHEDULE,async()=>{const _0x210145=_0x257b02;await loadSystemMode(_0x40bdc6),AUTO_RESET_MODES[_0x210145(0x1f3)](_0x40bdc6['currentSystemMode'])&&await _0x40bdc6[_0x210145(0x2fe)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x210145(0x257)],'ack':![]});});}catch(_0x131803){_0x40bdc6['log'][_0x257b02(0x2c5)](_0x257b02(0x348)+_0x131803[_0x257b02(0x1cf)]);}}function setupDriftAnalysisScheduler(_0x1c13df){const _0x3a4b0b=a0_0x38181c;try{if(_0x1c13df[_0x3a4b0b(0x2fc)])clearInterval(_0x1c13df[_0x3a4b0b(0x2fc)]);if(!_0x1c13df[_0x3a4b0b(0x1e5)])return;_0x1c13df['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x1c13df),(_0x1c13df[_0x3a4b0b(0x1f9)][_0x3a4b0b(0x1c9)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x1c13df),0x1388);}catch(_0x219f9e){_0x1c13df[_0x3a4b0b(0x2f4)][_0x3a4b0b(0x2c5)](_0x3a4b0b(0x2c6)+_0x219f9e[_0x3a4b0b(0x1cf)]);}}function setupBriefingScheduler(_0xd5cb83){const _0x194088=a0_0x38181c;try{if(_0xd5cb83[_0x194088(0x30a)])_0xd5cb83[_0x194088(0x30a)][_0x194088(0x2f5)]();if(!_0xd5cb83[_0x194088(0x1f9)]['briefingEnabled'])return;const _0x547dbd=(_0xd5cb83[_0x194088(0x1f9)][_0x194088(0x1b1)]||_0x194088(0x2c4))['split'](':'),_0x37b5cf=parseInt(_0x547dbd[0x0])||0x8,_0x387dbb=parseInt(_0x547dbd[0x1])||0x0,_0x5e38da=_0x387dbb+'\x20'+_0x37b5cf+_0x194088(0x28c);_0xd5cb83['briefingJob']=schedule[_0x194088(0x2c7)](_0x5e38da,()=>{sendMorningBriefing(_0xd5cb83);});}catch(_0x2ca9dc){_0xd5cb83['log'][_0x194088(0x2c5)](_0x194088(0x283)+_0x2ca9dc[_0x194088(0x1cf)]);}}async function runBaselineDriftAnalysis(_0x5b5bcf){const _0x21588d=a0_0x38181c;if(!_0x5b5bcf['isProVersion']||!_0x5b5bcf['geminiModel'])return;const _0x872d4d=_0x5b5bcf[_0x21588d(0x1f9)][_0x21588d(0x1a5)]||0xe;if(_0x5b5bcf[_0x21588d(0x29a)][_0x21588d(0x2b9)]<_0x872d4d+0x7){await _0x5b5bcf[_0x21588d(0x2fe)](LTM_DP_DRIFT_STATUS,{'val':_0x21588d(0x25a),'ack':!![]});return;}const _0x5cf42f=_0x5b5bcf[_0x21588d(0x29a)][_0x21588d(0x24d)](-_0x872d4d),_0x55b175=_0x5b5bcf[_0x21588d(0x29a)][_0x21588d(0x24d)](0x0,_0x5b5bcf[_0x21588d(0x29a)]['length']-_0x872d4d),_0x57ee8a=_0x21588d(0x1fb)+JSON[_0x21588d(0x267)](_0x55b175)+_0x21588d(0x2af)+JSON[_0x21588d(0x267)](_0x5cf42f);try{const _0x1753c2=await _0x5b5bcf['geminiModel'][_0x21588d(0x32e)](_0x57ee8a),_0x4623d7=JSON[_0x21588d(0x22d)](_0x1753c2[_0x21588d(0x2c8)][_0x21588d(0x337)]()[_0x21588d(0x247)](/```json|```/g,'')[_0x21588d(0x1a8)]());_0x4623d7[_0x21588d(0x253)]&&(await _0x5b5bcf[_0x21588d(0x2fe)](LTM_DP_DRIFT_STATUS,{'val':_0x4623d7['baselineDrift'],'ack':!![]}),await _0x5b5bcf[_0x21588d(0x2fe)](LTM_DP_DRIFT_DETAILS,{'val':_0x4623d7[_0x21588d(0x2c1)],'ack':!![]}),await _0x5b5bcf['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x3b73ee){}}class CogniLiving extends utils[a0_0x38181c(0x270)]{constructor(_0x6cdcf1){const _0x4026d8=a0_0x38181c;super({..._0x6cdcf1,'name':_0x4026d8(0x1e8)}),this['eventHistory']=[],this['analysisHistory']=[],this['rawEventLog']=[],this[_0x4026d8(0x29a)]=[],this['sensorLastValues']={},this[_0x4026d8(0x24e)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x4026d8(0x2e8)]=!![],this[_0x4026d8(0x263)]=null,this['exitGraceTimer']=null,this[_0x4026d8(0x24a)]=![],this[_0x4026d8(0x2d5)]=null,this['geminiModel']=null,this[_0x4026d8(0x20c)]=SYSTEM_MODES['NORMAL'],this[_0x4026d8(0x1e5)]=![],this['lastAlertState']=![],this[_0x4026d8(0x2da)]=_0x4026d8(0x232),this[_0x4026d8(0x1ce)]=null,this[_0x4026d8(0x1bc)]=null,this[_0x4026d8(0x31e)]=null,this[_0x4026d8(0x2fc)]=null,this[_0x4026d8(0x30a)]=null,this[_0x4026d8(0x1de)]=null,this[_0x4026d8(0x2f3)]=![],this['on'](_0x4026d8(0x237),this[_0x4026d8(0x22a)][_0x4026d8(0x2ba)](this)),this['on'](_0x4026d8(0x2e7),this[_0x4026d8(0x347)][_0x4026d8(0x2ba)](this)),this['on'](_0x4026d8(0x21d),this[_0x4026d8(0x31d)]['bind'](this)),this['on'](_0x4026d8(0x1cf),this['onMessage'][_0x4026d8(0x2ba)](this));}async[a0_0x38181c(0x22a)](){const _0x34993b=a0_0x38181c;this[_0x34993b(0x2f4)][_0x34993b(0x290)](_0x34993b(0x1c2)+this[_0x34993b(0x28e)]+')\x20-\x20SAFE\x20BOOT');if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x38181c(0x31d)](_0x1ef8d1){const _0x2c04e0=a0_0x38181c;if(this['analysisTimer'])clearInterval(this[_0x2c04e0(0x1ce)]);if(this[_0x2c04e0(0x2fc)])clearInterval(this['driftAnalysisTimer']);if(this['ltmJob'])this[_0x2c04e0(0x1bc)]['cancel']();if(this['modeResetJob'])this[_0x2c04e0(0x31e)][_0x2c04e0(0x2f5)]();if(this[_0x2c04e0(0x30a)])this['briefingJob'][_0x2c04e0(0x2f5)]();if(this[_0x2c04e0(0x263)])clearTimeout(this['exitTimer']);if(this[_0x2c04e0(0x306)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x1ef8d1();}async[a0_0x38181c(0x347)](_0x1bf6e1,_0x3cb617){const _0xe181b6=a0_0x38181c;if(!_0x3cb617||this[_0xe181b6(0x2f3)])return;if(_0x1bf6e1[_0xe181b6(0x1f3)](_0xe181b6(0x2e0))&&_0x1bf6e1['endsWith'](_0xe181b6(0x201))&&_0x3cb617[_0xe181b6(0x2d6)]){await handleTelegramResponse(this,_0x3cb617[_0xe181b6(0x2d6)]);return;}if(_0x1bf6e1===this[_0xe181b6(0x33a)]+'.'+SYSTEM_DP_MODE){if(_0x3cb617[_0xe181b6(0x2d6)]&&Object[_0xe181b6(0x229)](SYSTEM_MODES)[_0xe181b6(0x1f3)](_0x3cb617[_0xe181b6(0x2d6)])){this[_0xe181b6(0x20c)]=_0x3cb617[_0xe181b6(0x2d6)];if(_0x3cb617[_0xe181b6(0x2d6)]===SYSTEM_MODES[_0xe181b6(0x277)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x3cb617[_0xe181b6(0x2e2)])this[_0xe181b6(0x272)](_0x1bf6e1,{'val':this[_0xe181b6(0x20c)],'ack':!![]});return;}if(!_0x3cb617['ack']){_0x1bf6e1['includes'](_0xe181b6(0x24c))&&_0x3cb617[_0xe181b6(0x2d6)]&&(this[_0xe181b6(0x272)](_0x1bf6e1,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x1bf6e1[_0xe181b6(0x1f3)](_0xe181b6(0x255))&&_0x3cb617[_0xe181b6(0x2d6)]){this[_0xe181b6(0x272)](_0x1bf6e1,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x1bf6e1[_0xe181b6(0x1f3)](_0xe181b6(0x2ac))&&_0x3cb617[_0xe181b6(0x2d6)]&&(this[_0xe181b6(0x272)](_0x1bf6e1,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x1bf6e1[_0xe181b6(0x1f3)](_0xe181b6(0x2a7))&&_0x3cb617[_0xe181b6(0x2d6)]&&(this[_0xe181b6(0x272)](_0x1bf6e1,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x1bf6e1['includes']('analysis.training.triggerSecurity')&&_0x3cb617[_0xe181b6(0x2d6)]){this['setState'](_0x1bf6e1,{'val':![],'ack':!![]});if(this[_0xe181b6(0x1e5)])try{const _0x425caf=await this[_0xe181b6(0x2d9)](_0xe181b6(0x2fb));if(_0x425caf&&_0x425caf['val']){const _0x3aaa8e=JSON[_0xe181b6(0x22d)](_0x425caf[_0xe181b6(0x2d6)]);this['log'][_0xe181b6(0x290)](_0xe181b6(0x219)),this[_0xe181b6(0x2fe)]('analysis.training.status',{'val':_0xe181b6(0x22e),'ack':!![]}),sendToPython(this,_0xe181b6(0x1ff),{'sequences':_0x3aaa8e});}}catch(_0x652fe7){this[_0xe181b6(0x2f4)]['error'](_0xe181b6(0x1ad)+_0x652fe7[_0xe181b6(0x1cf)]);}}if(_0x1bf6e1['includes'](_0xe181b6(0x1b9))&&_0x3cb617['val']){this['setState'](_0x1bf6e1,{'val':![],'ack':!![]});if(this[_0xe181b6(0x1e5)])try{const _0x2f6070=await this[_0xe181b6(0x2d9)](LTM_DP_DAILY_DIGESTS);if(_0x2f6070&&_0x2f6070[_0xe181b6(0x2d6)])sendToPython(this,_0xe181b6(0x1e3),{'digests':JSON[_0xe181b6(0x22d)](_0x2f6070[_0xe181b6(0x2d6)])});}catch(_0xcb477b){}}if(_0x1bf6e1[_0xe181b6(0x1f3)](_0xe181b6(0x1ec))&&_0x3cb617[_0xe181b6(0x2d6)]){this['setState'](_0x1bf6e1,{'val':![],'ack':!![]});if(this[_0xe181b6(0x1e5)])try{const _0x7e5e5b=await this[_0xe181b6(0x2d9)](_0xe181b6(0x27b));if(_0x7e5e5b&&_0x7e5e5b[_0xe181b6(0x2d6)])sendToPython(this,_0xe181b6(0x228),{'points':JSON['parse'](_0x7e5e5b[_0xe181b6(0x2d6)])});}catch(_0x45c280){}}if(_0x1bf6e1[_0xe181b6(0x1f3)]('analysis.training.triggerComfort')&&_0x3cb617[_0xe181b6(0x2d6)]){this[_0xe181b6(0x272)](_0x1bf6e1,{'val':![],'ack':!![]});if(this[_0xe181b6(0x1e5)])try{const _0x23c93f=await this[_0xe181b6(0x2d9)](LTM_DP_RAW_LOG);_0x23c93f&&_0x23c93f['val']&&(this[_0xe181b6(0x2f4)][_0xe181b6(0x290)](_0xe181b6(0x2ab)),sendToPython(this,_0xe181b6(0x23d),{'events':JSON[_0xe181b6(0x22d)](_0x23c93f[_0xe181b6(0x2d6)])}));}catch(_0x24c072){}}return;}if(this[_0xe181b6(0x1f9)][_0xe181b6(0x2a3)]&&this[_0xe181b6(0x1f9)][_0xe181b6(0x2a3)][_0xe181b6(0x1f3)](_0x1bf6e1)){await checkWifiPresence(this);return;}const _0x16a0c1=(this[_0xe181b6(0x1f9)][_0xe181b6(0x2b0)]||[])[_0xe181b6(0x208)](_0x27db70=>_0x27db70['id']===_0x1bf6e1);if(_0x16a0c1)processSensorEvent(this,_0x1bf6e1,_0x3cb617,_0x16a0c1);}async['onMessage'](_0x3def72){const _0x175456=a0_0x38181c;if(typeof _0x3def72===_0x175456(0x2b7)&&_0x3def72[_0x175456(0x1cf)]){if(_0x3def72[_0x175456(0x1e4)]==='testApiKey'){const _0x27526e=_0x3def72[_0x175456(0x1cf)][_0x175456(0x34d)]||this[_0x175456(0x1f9)][_0x175456(0x2b6)];if(!_0x27526e)return this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72['command'],{'success':![],'message':_0x175456(0x351)},_0x3def72['callback']);try{const _0x18ca29=new GoogleGenerativeAI(_0x27526e),_0x37c398=_0x18ca29[_0x175456(0x2dd)]({'model':GEMINI_MODEL}),_0x4cf3a9=await _0x37c398[_0x175456(0x32e)]('Hi');this['sendTo'](_0x3def72[_0x175456(0x32a)],_0x3def72[_0x175456(0x1e4)],{'success':!![],'message':_0x175456(0x1ea)+_0x4cf3a9[_0x175456(0x2c8)][_0x175456(0x337)]()},_0x3def72[_0x175456(0x32f)]);}catch(_0x4c28bf){this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72[_0x175456(0x1e4)],{'success':![],'message':_0x175456(0x2ec)+_0x4c28bf[_0x175456(0x1cf)]},_0x3def72[_0x175456(0x32f)]);}}else{if(_0x3def72[_0x175456(0x1e4)]==='testContext'){const _0xcd9a16=await getWeatherContext(this),_0x4f6874=await getCalendarContext(this);this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72[_0x175456(0x1e4)],{'success':!![],'weather':_0xcd9a16,'calendar':_0x4f6874},_0x3def72[_0x175456(0x32f)]);}else{if(_0x3def72[_0x175456(0x1e4)]===_0x175456(0x1d4)){if(!this[_0x175456(0x1e5)])return this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72[_0x175456(0x1e4)],{'success':![],'isPro':![]},_0x3def72['callback']);let _0x150e42={'status':_0x175456(0x2ff)};try{const _0x40ba35=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x150e42['status']=_0x40ba35?_0x40ba35[_0x175456(0x2d6)]:_0x175456(0x2ff);}catch(_0x3d2072){}this[_0x175456(0x1c5)](_0x3def72['from'],_0x3def72['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x175456(0x29a)],'driftAnalysis':_0x150e42,'analysisHistory':this['analysisHistory']},_0x3def72[_0x175456(0x32f)]);}else{if(_0x3def72[_0x175456(0x1e4)]===_0x175456(0x2ae)){const _0x2250be=this[_0x175456(0x29a)]['length'],_0x3706b1=new Date(),_0x4aec8e=new Date(_0x3706b1['getFullYear'](),_0x3706b1[_0x175456(0x285)](),_0x3706b1[_0x175456(0x2a9)]())['getTime'](),_0x3c4891=this['rawEventLog']['filter'](_0x1a5a24=>new Date(_0x1a5a24[_0x175456(0x2b3)])[_0x175456(0x23a)]()>_0x4aec8e)[_0x175456(0x2b9)],_0x502ed7=new Array(0x18)['fill'](0x0);this[_0x175456(0x1c8)][_0x175456(0x2c3)](_0x408c64=>{const _0x1a0284=_0x175456,_0x5e9ed9=new Date(_0x408c64['timestamp']);if(_0x5e9ed9['getTime']()>_0x4aec8e)_0x502ed7[_0x5e9ed9[_0x1a0284(0x298)]()]++;});let _0x41b744={'status':'N/A'};try{const _0x2a8ace=await this[_0x175456(0x2d9)](LTM_DP_DRIFT_STATUS);_0x41b744[_0x175456(0x34e)]=_0x2a8ace?_0x2a8ace[_0x175456(0x2d6)]:_0x175456(0x2ff);}catch(_0x2966a6){}let _0x2b77fb='';try{const _0x289b6a=await this['getStateAsync'](_0x175456(0x2d2));_0x2b77fb=_0x289b6a?_0x289b6a[_0x175456(0x2d6)]:'';}catch(_0x562e1d){}let _0x409551=null;!this[_0x175456(0x258)]&&(_0x409551=this['config']['geminiApiKey']?_0x175456(0x1fe):_0x175456(0x204));let _0x3f0d49={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x577524=await this[_0x175456(0x2d9)](_0x175456(0x239));if(_0x577524&&_0x577524[_0x175456(0x2d6)]){_0x3f0d49[_0x175456(0x20f)]=!![];const _0x532580=await this[_0x175456(0x2d9)]('analysis.automation.description');_0x3f0d49['description']=_0x532580?_0x532580[_0x175456(0x2d6)]:'';const _0x4a0691=await this['getStateAsync']('analysis.automation.targetId');_0x3f0d49[_0x175456(0x27d)]=_0x4a0691?_0x4a0691[_0x175456(0x2d6)]:'';const _0x584b5e=await this[_0x175456(0x2d9)](_0x175456(0x1da));_0x3f0d49[_0x175456(0x2be)]=_0x584b5e?_0x584b5e[_0x175456(0x2d6)]:'';}const _0x30cd16=await this[_0x175456(0x2d9)](_0x175456(0x312));_0x3f0d49[_0x175456(0x294)]=_0x30cd16?!!_0x30cd16[_0x175456(0x2d6)]:![];}catch(_0x252a7e){}this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72[_0x175456(0x1e4)],{'success':!![],'eventHistory':this[_0x175456(0x331)]['slice'](0x0,0xf),'stats':{'digestCount':_0x2250be,'eventCountToday':_0x3c4891,'hourlyActivity':_0x502ed7,'driftStatus':_0x41b744[_0x175456(0x34e)],'isPresent':this[_0x175456(0x2e8)],'presenceWho':_0x2b77fb,'minDays':this[_0x175456(0x1f9)][_0x175456(0x1ee)]||0x7,'stbDays':this[_0x175456(0x1f9)][_0x175456(0x1a5)]||0xe,'ltbDays':this['config'][_0x175456(0x2c9)]||0x3c,'systemError':_0x409551},'automation':_0x3f0d49},_0x3def72[_0x175456(0x32f)]);}else{if(_0x3def72[_0x175456(0x1e4)]==='scanDevices')try{const _0x387501=await scanForDevices(this,_0x3def72[_0x175456(0x1cf)]||{});this[_0x175456(0x1c5)](_0x3def72['from'],_0x3def72['command'],{'success':!![],'devices':_0x387501},_0x3def72[_0x175456(0x32f)]);}catch(_0x31f4df){this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72['command'],{'success':![],'error':_0x31f4df['message']},_0x3def72['callback']);}else{if(_0x3def72[_0x175456(0x1e4)]==='getEnums'){const _0x307045=await this[_0x175456(0x21e)](_0x175456(0x1b6),_0x175456(0x21f)),_0x5e4965=[];if(_0x307045)for(const _0x9ea653 in _0x307045){const _0x58c80e=_0x307045[_0x9ea653],_0x2a015b=(_0x58c80e[_0x175456(0x2d8)]&&typeof _0x58c80e[_0x175456(0x2d8)][_0x175456(0x335)]===_0x175456(0x2b7)?_0x58c80e[_0x175456(0x2d8)][_0x175456(0x335)]['de']:_0x58c80e['common'][_0x175456(0x335)])||_0x58c80e['common']['name'];_0x5e4965[_0x175456(0x1b0)]({'id':_0x9ea653,'name':_0x2a015b});}this['sendTo'](_0x3def72['from'],_0x3def72[_0x175456(0x1e4)],{'success':!![],'enums':_0x5e4965},_0x3def72[_0x175456(0x32f)]);}else{if(_0x3def72['command']===_0x175456(0x251)){const _0xb341b1=_0x3def72['message'][_0x175456(0x326)];if(!_0xb341b1)return this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72[_0x175456(0x1e4)],{'success':![],'error':_0x175456(0x2ed)},_0x3def72['callback']);const _0x41b5ba=await getCalendarNames(this,_0xb341b1);this[_0x175456(0x1c5)](_0x3def72['from'],_0x3def72['command'],{'success':!![],'names':_0x41b5ba},_0x3def72['callback']);}else{if(_0x3def72['command']===_0x175456(0x336)){const {targetId:_0x1ef500,targetValue:_0x46a784}=_0x3def72[_0x175456(0x1cf)];this['log']['info'](_0x175456(0x33b)+_0x1ef500+_0x175456(0x280)+_0x46a784),await this[_0x175456(0x2fe)](_0x175456(0x239),{'val':!![],'ack':!![]}),await this[_0x175456(0x2fe)](_0x175456(0x259),{'val':_0x175456(0x1ca)+_0x1ef500,'ack':!![]}),await this[_0x175456(0x2fe)](_0x175456(0x2df),{'val':_0x1ef500,'ack':!![]}),await this[_0x175456(0x2fe)](_0x175456(0x1da),{'val':_0x46a784,'ack':!![]}),this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72[_0x175456(0x1e4)],{'success':!![]},_0x3def72[_0x175456(0x32f)]);}else{if(_0x3def72[_0x175456(0x1e4)]===_0x175456(0x1a9)){const {historyId:_0x3d5ddd,rating:_0xce362d,comment:_0x28e5e2,alertReason:_0x2dd08a}=_0x3def72[_0x175456(0x1cf)];_0x3d5ddd&&_0xce362d?(await saveFeedback(this,{'timestamp':Date[_0x175456(0x346)](),'historyId':_0x3d5ddd,'rating':_0xce362d,'comment':_0x28e5e2,'alertReason':_0x2dd08a}),this[_0x175456(0x1c5)](_0x3def72[_0x175456(0x32a)],_0x3def72['command'],{'success':!![]},_0x3def72['callback'])):this['sendTo'](_0x3def72[_0x175456(0x32a)],_0x3def72[_0x175456(0x1e4)],{'success':![],'error':_0x175456(0x2bb)},_0x3def72['callback']);}else _0x3def72['command']===_0x175456(0x1a7)&&(this[_0x175456(0x2f4)][_0x175456(0x290)](_0x175456(0x349)),await this[_0x175456(0x2fe)](_0x175456(0x239),{'val':![],'ack':!![]}),await this[_0x175456(0x2fe)]('analysis.automation.description',{'val':'','ack':!![]}),this['sendTo'](_0x3def72['from'],_0x3def72[_0x175456(0x1e4)],{'success':!![]},_0x3def72[_0x175456(0x32f)]));}}}}}}}}}}}if(require[a0_0x38181c(0x2a2)]!==module)module[a0_0x38181c(0x26f)]=_0x53270c=>new CogniLiving(_0x53270c);else new CogniLiving();