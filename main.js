const a0_0x357c58=a0_0xe5fc;function a0_0xe5fc(_0x874abf,_0x120685){const _0x1d85ab=a0_0x170e();return a0_0xe5fc=function(_0x3a0c3b,_0x270565){_0x3a0c3b=_0x3a0c3b-0xf5;let _0x170eb9=_0x1d85ab[_0x3a0c3b];return _0x170eb9;},a0_0xe5fc(_0x874abf,_0x120685);}(function(_0x235b36,_0x4a40fc){const _0x4147ce=a0_0xe5fc,_0x1ac6f8=_0x235b36();while(!![]){try{const _0x50b130=parseInt(_0x4147ce(0x14d))/0x1+-parseInt(_0x4147ce(0xfe))/0x2*(parseInt(_0x4147ce(0x193))/0x3)+parseInt(_0x4147ce(0x179))/0x4*(-parseInt(_0x4147ce(0x1b7))/0x5)+parseInt(_0x4147ce(0x1b8))/0x6+parseInt(_0x4147ce(0x148))/0x7+-parseInt(_0x4147ce(0x1c4))/0x8+parseInt(_0x4147ce(0x146))/0x9;if(_0x50b130===_0x4a40fc)break;else _0x1ac6f8['push'](_0x1ac6f8['shift']());}catch(_0x3e053d){_0x1ac6f8['push'](_0x1ac6f8['shift']());}}}(a0_0x170e,0xc8da5));const a0_0x270565=(function(){let _0x459396=!![];return function(_0x1914ab,_0x51665e){const _0x7a4522=_0x459396?function(){const _0x4958ff=a0_0xe5fc;if(_0x51665e){const _0x31c2b1=_0x51665e[_0x4958ff(0x1c3)](_0x1914ab,arguments);return _0x51665e=null,_0x31c2b1;}}:function(){};return _0x459396=![],_0x7a4522;};}()),a0_0x3a0c3b=a0_0x270565(this,function(){const _0x1a2469=a0_0xe5fc;return a0_0x3a0c3b[_0x1a2469(0x12f)]()['search'](_0x1a2469(0x150))[_0x1a2469(0x12f)]()[_0x1a2469(0x112)](a0_0x3a0c3b)['search'](_0x1a2469(0x150));});a0_0x3a0c3b();function a0_0x170e(){const _0x283a45=['lastTrackerEventTime','integrateRoomTime','createAllObjects','Gemini\x20Init\x20Error:\x20','Warte\x20auf\x20Analyse...','isPresent','SYSTEM_DP_MODE','toLowerCase','Corrupt','analysis.trigger','checkThermostats','energy','history','740FiXwCJ','analysis.health.todayVector','runGeminiAnalysis','Warm-Up\x20Time','triggerInfrasoundCorrelation','parse','getGenerativeModel','driftAnalysisTimer','now','./lib/installer','analyzeWindowOpening','Live\x20Event\x20Pulse','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','modules','analysis.automation.patternDetected','LTM.rawEventLog','analysis.visualization.pulse','Room\x20History\x20(24h\x20Buckets)','moduleSecurity','infrasoundEnabled','checkWifiPresence','triggerGaitAnalysis','initZombies','analysis.health.geminiDay','infrasoundSensorId','presenceDevices','606EufJkt','eventHistory','isSolar','runAutopilot','warn','enum.functions.*','\x22history\x22:{}','analysis.automation.targetId','find','abortExitTimer','Unknown','fill','geminiApiKey','pressureBuffer','activeModules','cogni-living','bootTime','config','bin','@iobroker/adapter-core','./lib/scanner','memoryCache','stringify','some','analysis.health.activityTrend','Init...','split','healthTrendInterval','handleInfrasound','setHours','terrasse','location','callback','getStateAsync','json','error','12835IAtObd','1550862rLjmSy','motion','max','exitGraceTimer','string','value','trackerHeartbeat','59\x2023\x20*\x20*\x20*','./lib/automation','models/gemini-flash-latest','common','apply','3316656KprWAS','toLocaleDateString','currentSystemMode','analysis.health.geminiNight','General\x20Activity\x20Trend','analysis.security.lastScore','writeFileSync','No\x20data','initHistory','licenseKey','setObjectNotExistsAsync','moduleComfort','genAI','getOverviewData','moduleEnergy','moduleHealth','onUnload','8416cGtnFt','inactivityThresholdHours','getEnums','Gemini\x20Report\x20Night','main','from','isProVersion','dependencyInstallInProgress','analysis.automation.description','version','getAbsoluteDefaultDataDir','...','min','text','checkSolarCondition','saveDailyHistory','Lernphase\x20(','dailyDigests','includes','round','constructor','Room\x20Dwell\x20Time\x20Stats','sensorLastValues','Gemini\x20Report\x20Day','node-schedule','systemConfig','NORMAL','enum','scanForDevices','path','subscribeForeignStatesAsync','forEach','.json','subscribeForeignStates','sendNotification','log','Aktiv\x20(','sendTo','scanThermostats','info','date','subscribeStates','security','join','analysis.prediction.trackerTopRoom','analysis.activity.roomHistory','name','exports','message','toString','exitTimer','roomIntegratorTimer','health','cancel','./lib/setup','onMessage','startSystem','checkLicense','number','./lib/python_bridge','then','âœ…\x20History\x20saved:\x20','replayTodayEvents','geminiModel','analysis.energy.warmupSources','timestamp','setStateAsync','existsSync','updateHealthVector','rawEventLog','analysisTimer','briefingJob','2840364HoSyfF','onReady','3970771madfvs','triggerEnergyPrediction','mkdirSync','bind','LTM.baselineStatus','1420860cnyDwh','push','analysis.energy.warmupTimes','(((.+)+)+)+$','scheduleJob','val','analysis.health.lastCheck','getHours','historyJob','enum.rooms.*','utf8','comfort','cogni-living\x20adapter\x20starting\x20(v','command','appendToLog','ready','state','Keine\x20Daten','analysis.automation.targetValue','all','system.presenceWho','analysisHistory','./lib/topology','object','length','type','devices','@google/generative-ai','SYSTEM_MODES','ltmJob','./lib/dead_man'];a0_0x170e=function(){return _0x283a45;};return a0_0x170e();}'use strict';const utils=require(a0_0x357c58(0x1a6)),{GoogleGenerativeAI}=require(a0_0x357c58(0x168)),path=require(a0_0x357c58(0x11b)),fs=require('fs'),installer=require(a0_0x357c58(0x182)),scanner=require(a0_0x357c58(0x1a7)),schedulers=require('./lib/scheduler'),topology=require(a0_0x357c58(0x163)),setup=require(a0_0x357c58(0x134)),recorder=require('./lib/recorder'),pythonBridge=require(a0_0x357c58(0x139)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x357c58(0x16b)),automation=require(a0_0x357c58(0x1c0)),GEMINI_MODEL=a0_0x357c58(0x1c1);class CogniLiving extends utils['Adapter']{constructor(_0x4b8b2e){const _0x2f5a49=a0_0x357c58;super({..._0x4b8b2e,'name':'cogni-living'}),this['eventHistory']=[],this[_0x2f5a49(0x162)]=[],this[_0x2f5a49(0x143)]=[],this[_0x2f5a49(0x10f)]=[],this[_0x2f5a49(0x114)]={},this[_0x2f5a49(0x117)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x2f5a49(0x171)]=!![],this[_0x2f5a49(0x130)]=null,this[_0x2f5a49(0x1bb)]=null,this['isGracePeriodActive']=![],this[_0x2f5a49(0xf9)]=null,this[_0x2f5a49(0x13d)]=null,this[_0x2f5a49(0x1c6)]=setup[_0x2f5a49(0x169)][_0x2f5a49(0x118)],this[_0x2f5a49(0x104)]=![],this['lastAlertState']=![],this[_0x2f5a49(0x144)]=null,this[_0x2f5a49(0x16a)]=null,this['modeResetJob']=null,this[_0x2f5a49(0x180)]=null,this[_0x2f5a49(0x145)]=null,this[_0x2f5a49(0x155)]=null,this[_0x2f5a49(0x1be)]=null,this[_0x2f5a49(0x1ae)]=null,this[_0x2f5a49(0x131)]=null,this[_0x2f5a49(0x105)]=![],this[_0x2f5a49(0x16c)]=Date[_0x2f5a49(0x181)](),this['memoryCache']=null,this[_0x2f5a49(0x1a3)]=Date[_0x2f5a49(0x181)](),this['infrasoundLocked']=![],this[_0x2f5a49(0x1a0)]=[],this['activeModules']={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x2f5a49(0x15c),this[_0x2f5a49(0x147)][_0x2f5a49(0x14b)](this)),this['on']('stateChange',this['onStateChange']['bind'](this)),this['on']('unload',this[_0x2f5a49(0xfd)][_0x2f5a49(0x14b)](this)),this['on']('message',this[_0x2f5a49(0x135)][_0x2f5a49(0x14b)](this));}async[a0_0x357c58(0x147)](){const _0x3e8af2=a0_0x357c58;this[_0x3e8af2(0x121)][_0x3e8af2(0x125)](_0x3e8af2(0x159)+this[_0x3e8af2(0x107)]+')\x20-\x20Phase\x20E\x20(History\x20&\x20Replay)');if(this[_0x3e8af2(0x1a4)][_0x3e8af2(0xfc)]!==undefined)this[_0x3e8af2(0x1a1)]['health']=this['config']['moduleHealth'];if(this[_0x3e8af2(0x1a4)][_0x3e8af2(0x18b)]!==undefined)this[_0x3e8af2(0x1a1)]['security']=this[_0x3e8af2(0x1a4)]['moduleSecurity'];if(this[_0x3e8af2(0x1a4)][_0x3e8af2(0xfb)]!==undefined)this[_0x3e8af2(0x1a1)][_0x3e8af2(0x177)]=this[_0x3e8af2(0x1a4)][_0x3e8af2(0xfb)];if(this[_0x3e8af2(0x1a4)][_0x3e8af2(0xf8)]!==undefined)this[_0x3e8af2(0x1a1)][_0x3e8af2(0x158)]=this[_0x3e8af2(0x1a4)][_0x3e8af2(0xf8)];if(this['config'][_0x3e8af2(0x186)])this['activeModules']={...this[_0x3e8af2(0x1a1)],...this[_0x3e8af2(0x1a4)][_0x3e8af2(0x186)]};this[_0x3e8af2(0x136)]();}async['startSystem'](){const _0x38ee88=a0_0x357c58;await setup[_0x38ee88(0x18f)](this);try{this[_0x38ee88(0x104)]=await setup[_0x38ee88(0x137)](this['config'][_0x38ee88(0xf6)]);}catch(_0x830e9f){}if(!this['config'][_0x38ee88(0xff)]||this['config'][_0x38ee88(0xff)]<0.1)this['config'][_0x38ee88(0xff)]=0xc;await setup[_0x38ee88(0xf5)](this),await setup['initSystemConfig'](this);try{const _0x26b6db=await this['getStateAsync'](_0x38ee88(0x14f)),_0x312bba=await this[_0x38ee88(0x1b4)](_0x38ee88(0x13e));_0x26b6db&&_0x26b6db[_0x38ee88(0x152)]&&_0x312bba&&_0x312bba['val']&&(Date[_0x38ee88(0x181)]()-_0x26b6db['ts']<0x4*0xe10*0x3e8&&(this[_0x38ee88(0x1a8)]={'times':JSON['parse'](_0x26b6db[_0x38ee88(0x152)]),'sources':JSON[_0x38ee88(0x17e)](_0x312bba['val'])}));}catch(_0x1cd83c){}if(this[_0x38ee88(0x1a4)][_0x38ee88(0x19f)])try{this['genAI']=new GoogleGenerativeAI(this[_0x38ee88(0x1a4)][_0x38ee88(0x19f)]),this[_0x38ee88(0x13d)]=this['genAI'][_0x38ee88(0x17f)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}});}catch(_0x3a6b5f){this[_0x38ee88(0x121)][_0x38ee88(0x1b6)](_0x38ee88(0x16f)+_0x3a6b5f[_0x38ee88(0x12e)]);}await setup[_0x38ee88(0x16e)](this),await this['loadSystemMode'](),await this[_0x38ee88(0xf7)](_0x38ee88(0x189),{'type':_0x38ee88(0x15d),'common':{'name':_0x38ee88(0x184),'type':_0x38ee88(0x138),'role':_0x38ee88(0x1bd),'read':!![],'write':![]},'native':{}}),await this[_0x38ee88(0xf7)]('analysis.activity.roomStats',{'type':'state','common':{'name':_0x38ee88(0x113),'type':_0x38ee88(0x1bc),'role':'json','read':!![],'write':![],'def':_0x38ee88(0x185)},'native':{}}),await this[_0x38ee88(0xf7)](_0x38ee88(0x12b),{'type':_0x38ee88(0x15d),'common':{'name':_0x38ee88(0x18a),'type':_0x38ee88(0x1bc),'role':'json','read':!![],'write':![],'def':'{\x22history\x22:{}}'},'native':{}}),await this[_0x38ee88(0xf7)]('analysis.health.geminiNight',{'type':_0x38ee88(0x15d),'common':{'name':_0x38ee88(0x101),'type':_0x38ee88(0x1bc),'role':_0x38ee88(0x10b),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x38ee88(0xf7)](_0x38ee88(0x190),{'type':_0x38ee88(0x15d),'common':{'name':_0x38ee88(0x115),'type':_0x38ee88(0x1bc),'role':_0x38ee88(0x10b),'read':!![],'write':![],'def':_0x38ee88(0x170)},'native':{}}),await this[_0x38ee88(0xf7)](_0x38ee88(0x17a),{'type':_0x38ee88(0x15d),'common':{'name':'Daily\x20Activity\x20Vector\x20(24h)','type':_0x38ee88(0x1bc),'role':_0x38ee88(0x1b5),'read':!![],'write':![],'def':'[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]'},'native':{}}),await this[_0x38ee88(0xf7)]('analysis.health.activityTrend',{'type':'state','common':{'name':_0x38ee88(0x1c8),'type':_0x38ee88(0x138),'role':_0x38ee88(0x1bd),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x38ee88(0xf7)]('analysis.energy.warmupTimes',{'type':_0x38ee88(0x15d),'common':{'name':_0x38ee88(0x17c),'type':'string','role':_0x38ee88(0x1b5),'read':!![],'write':![]},'native':{}});try{const _0x51a6fe=await this['getStateAsync'](_0x38ee88(0x188));if(_0x51a6fe&&_0x51a6fe['val'])this[_0x38ee88(0x143)]=JSON['parse'](_0x51a6fe[_0x38ee88(0x152)]);}catch(_0x3492f4){this[_0x38ee88(0x143)]=[];}try{const _0x198d4d=await this['getStateAsync']('LTM.dailyDigests');if(_0x198d4d&&_0x198d4d[_0x38ee88(0x152)])this[_0x38ee88(0x10f)]=JSON[_0x38ee88(0x17e)](_0x198d4d['val']);}catch(_0x34ebcd){this['dailyDigests']=[];}const _0x20897d=this['dailyDigests'][_0x38ee88(0x165)]>=(this['config']['minDaysForBaseline']||0x7)?_0x38ee88(0x122)+this[_0x38ee88(0x10f)][_0x38ee88(0x165)]+'\x20Tage)':_0x38ee88(0x10e)+this[_0x38ee88(0x10f)][_0x38ee88(0x165)]+'/'+(this[_0x38ee88(0x1a4)]['minDaysForBaseline']||0x7)+')';await this[_0x38ee88(0x140)](_0x38ee88(0x14c),{'val':_0x20897d,'ack':!![]}),this[_0x38ee88(0x127)](_0x38ee88(0x175)),this[_0x38ee88(0x127)]('LTM.triggerDailyDigest'),this[_0x38ee88(0x127)]('analysis.training.triggerHealth');this[_0x38ee88(0x1a4)][_0x38ee88(0x18c)]&&this[_0x38ee88(0x1a4)][_0x38ee88(0x191)]&&this[_0x38ee88(0x1a1)][_0x38ee88(0x128)]&&this[_0x38ee88(0x11f)](this[_0x38ee88(0x1a4)][_0x38ee88(0x191)]);const _0x3e7032=this['config'][_0x38ee88(0x167)];if(_0x3e7032)for(const _0x18ef42 of _0x3e7032){await this[_0x38ee88(0x11c)](_0x18ef42['id']);}const _0x2828f5=this[_0x38ee88(0x1a4)][_0x38ee88(0x192)];if(_0x2828f5)for(const _0x4aac76 of _0x2828f5){await this[_0x38ee88(0x11c)](_0x4aac76);}const _0x3901cb=require(_0x38ee88(0x116));if(this['historyJob'])this[_0x38ee88(0x155)][_0x38ee88(0x133)]();this['historyJob']=_0x3901cb[_0x38ee88(0x151)](_0x38ee88(0x1bf),()=>{this['saveDailyHistory']();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this['roomIntegratorTimer'])clearInterval(this[_0x38ee88(0x131)]);this['integrateRoomTime'](),this['roomIntegratorTimer']=setInterval(async()=>{const _0x59a527=_0x38ee88;await this[_0x59a527(0x16d)]();},0x3c*0x3e8);if(this['healthTrendInterval'])clearInterval(this[_0x38ee88(0x1ae)]);this[_0x38ee88(0x1ae)]=setInterval(()=>{const _0x276bdf=_0x38ee88;this[_0x276bdf(0x104)]&&this[_0x276bdf(0x1a1)]['health']&&this['runPythonHealthCheck']();},0x4*0x3c*0x3c*0x3e8);const _0x2995c8=path['join'](__dirname,'.venv',_0x38ee88(0x1a5),'python');pythonBridge['startService'](this,_0x2995c8);}[a0_0x357c58(0xfd)](_0x42c14f){const _0x3c7dd7=a0_0x357c58;if(this[_0x3c7dd7(0x155)])this[_0x3c7dd7(0x155)][_0x3c7dd7(0x133)]();this[_0x3c7dd7(0x10d)]()[_0x3c7dd7(0x13a)](()=>{const _0x3405c7=_0x3c7dd7;if(this['analysisTimer'])clearInterval(this[_0x3405c7(0x144)]);if(this[_0x3405c7(0x131)])clearInterval(this[_0x3405c7(0x131)]);recorder[_0x3405c7(0x19c)](this),pythonBridge['stopService'](this),_0x42c14f();});}async[a0_0x357c58(0x13c)](){const _0x40e221=a0_0x357c58;if(!this[_0x40e221(0x194)]||this['eventHistory'][_0x40e221(0x165)]===0x0)return;const _0xc0c518=new Date()[_0x40e221(0x1b0)](0x0,0x0,0x0,0x0),_0x274930=_0x40e221(0x12b);let _0x16c437={'history':{},'date':new Date()[_0x40e221(0x1c5)]()};this['eventHistory'][_0x40e221(0x11d)](_0x3c43bb=>{const _0x5e68b1=_0x40e221;if(_0x3c43bb['timestamp']>=_0xc0c518&&(_0x3c43bb['type']===_0x5e68b1(0x1b9)||_0x3c43bb['type']==='presence')&&_0x3c43bb[_0x5e68b1(0x1bd)]===!![]){const _0x15b1b3=new Date(_0x3c43bb[_0x5e68b1(0x13f)])[_0x5e68b1(0x154)]();let _0x41cef0=_0x3c43bb[_0x5e68b1(0x1b2)]||_0x5e68b1(0x19d);const _0x1dbc15=(this[_0x5e68b1(0x1a4)][_0x5e68b1(0x167)]||[])[_0x5e68b1(0x19b)](_0x1eb1d1=>_0x1eb1d1[_0x5e68b1(0x1b2)]===_0x41cef0);if(_0x1dbc15)_0x41cef0=_0x1dbc15[_0x5e68b1(0x1b2)];if(!_0x16c437[_0x5e68b1(0x178)][_0x41cef0])_0x16c437[_0x5e68b1(0x178)][_0x41cef0]=new Array(0x18)[_0x5e68b1(0x19e)](0x0);if(_0x16c437[_0x5e68b1(0x178)][_0x41cef0][_0x15b1b3]<0x3c)_0x16c437[_0x5e68b1(0x178)][_0x41cef0][_0x15b1b3]++;}});const _0x3d236e=await this['getStateAsync'](_0x274930);(!_0x3d236e||!_0x3d236e[_0x40e221(0x152)]||_0x3d236e[_0x40e221(0x152)]==='{}'||_0x3d236e[_0x40e221(0x152)][_0x40e221(0x110)](_0x40e221(0x199)))&&(this[_0x40e221(0x121)]['info']('â†º\x20Replayed\x20events\x20to\x20restore\x20Room\x20History.'),await this[_0x40e221(0x140)](_0x274930,{'val':JSON[_0x40e221(0x1a9)](_0x16c437),'ack':!![]}));}async[a0_0x357c58(0x10d)](){const _0x49c362=a0_0x357c58;if(!this['activeModules'][_0x49c362(0x132)])return;const _0xb05630=new Date()['toISOString']()['split']('T')[0x0];this[_0x49c362(0x121)]['debug']('ðŸ’¾\x20Saving\x20Daily\x20History\x20for\x20'+_0xb05630+_0x49c362(0x109));try{const [_0x23c391,_0x118fce,_0x41e8cc,_0x43fe2f,_0x154cce,_0x19da9a,_0x65ad1e]=await Promise[_0x49c362(0x160)]([this[_0x49c362(0x1b4)]('analysis.activity.roomHistory'),this['getStateAsync'](_0x49c362(0x1c7)),this[_0x49c362(0x1b4)](_0x49c362(0x190)),this[_0x49c362(0x1b4)](_0x49c362(0x1c9)),this['getStateAsync']('analysis.health.todayVector'),this[_0x49c362(0x1b4)](_0x49c362(0x1ab)),this[_0x49c362(0x1b4)](_0x49c362(0x153))]),_0x5e2c86=this[_0x49c362(0x194)]['filter'](_0x30974b=>_0x30974b[_0x49c362(0x13f)]>=new Date()['setHours'](0x0,0x0,0x0,0x0)&&(_0x30974b[_0x49c362(0x12c)]['toLowerCase']()['includes']('haustÃ¼r')||_0x30974b[_0x49c362(0x12c)]['toLowerCase']()[_0x49c362(0x110)](_0x49c362(0x1b1)))&&(_0x30974b['value']===!![]||_0x30974b[_0x49c362(0x1bd)]==='open'))['length'];let _0x375407=0x55;if(_0x19da9a&&_0x19da9a[_0x49c362(0x152)]!==undefined)_0x375407=Math[_0x49c362(0x10a)](0x64,Math[_0x49c362(0x1ba)](0x14,Math[_0x49c362(0x111)](0x50+Number(_0x19da9a[_0x49c362(0x152)])*0x5)));const _0x475963={'date':_0xb05630,'timestamp':Date[_0x49c362(0x181)](),'roomHistory':_0x23c391?.[_0x49c362(0x152)]?JSON[_0x49c362(0x17e)](_0x23c391[_0x49c362(0x152)]):{},'geminiNight':_0x118fce?.[_0x49c362(0x152)]||_0x49c362(0x15e),'geminiDay':_0x41e8cc?.[_0x49c362(0x152)]||_0x49c362(0x15e),'anomalyScore':_0x43fe2f?.[_0x49c362(0x152)]||0.1,'todayVector':_0x154cce?.[_0x49c362(0x152)]?JSON[_0x49c362(0x17e)](_0x154cce[_0x49c362(0x152)]):new Array(0x18)[_0x49c362(0x19e)](0x0),'batteryLevel':_0x375407,'freshAirCount':_0x5e2c86,'eventHistory':this[_0x49c362(0x194)]},_0x47f489=utils[_0x49c362(0x108)](),_0x1a47c9=path[_0x49c362(0x129)](_0x47f489,_0x49c362(0x1a2),_0x49c362(0x178));if(!fs['existsSync'](_0x1a47c9))fs[_0x49c362(0x14a)](_0x1a47c9,{'recursive':!![]});const _0x4a395f=path[_0x49c362(0x129)](_0x1a47c9,_0xb05630+_0x49c362(0x11e));fs[_0x49c362(0x1ca)](_0x4a395f,JSON[_0x49c362(0x1a9)](_0x475963)),this['log'][_0x49c362(0x125)](_0x49c362(0x13b)+_0x4a395f);}catch(_0x366404){this['log'][_0x49c362(0x1b6)]('History\x20Save\x20Error:\x20'+_0x366404['message']);}}async['integrateRoomTime'](){const _0x5a331e=a0_0x357c58;if(!this[_0x5a331e(0x171)])return;try{let _0x5e4fe4=null;try{const _0x1b30d9=await this[_0x5a331e(0x1b4)](_0x5a331e(0x12a)),_0x39c700=await this[_0x5a331e(0x1b4)]('analysis.prediction.trackerConfidence');if(_0x1b30d9&&_0x1b30d9[_0x5a331e(0x152)]&&_0x39c700&&_0x39c700['val']&&_0x39c700[_0x5a331e(0x152)]>0.3){if(_0x1b30d9[_0x5a331e(0x152)]!==_0x5a331e(0x19d)&&_0x1b30d9[_0x5a331e(0x152)]!==_0x5a331e(0x1ac))_0x5e4fe4=_0x1b30d9[_0x5a331e(0x152)];}}catch(_0x4f52ac){}if(!_0x5e4fe4){const _0x456ccf=this[_0x5a331e(0x1a4)][_0x5a331e(0x167)]||[];for(const _0x257833 of _0x456ccf){if(_0x257833[_0x5a331e(0x166)]===_0x5a331e(0x1b9)&&_0x257833[_0x5a331e(0x1b2)])try{const _0x3d33f6=await this['getForeignStateAsync'](_0x257833['id']);if(_0x3d33f6&&(_0x3d33f6[_0x5a331e(0x152)]===!![]||_0x3d33f6[_0x5a331e(0x152)]==='on'||_0x3d33f6['val']===0x1)){_0x5e4fe4=_0x257833[_0x5a331e(0x1b2)];break;}}catch(_0x171eac){}}}if(!_0x5e4fe4)return;const _0x215a1f=this[_0x5a331e(0x1a4)][_0x5a331e(0x167)]||[];let _0x565e3a=_0x5e4fe4;const _0x172ff2=_0x215a1f[_0x5a331e(0x19b)](_0x1e1ad7=>_0x1e1ad7[_0x5a331e(0x1b2)]&&_0x1e1ad7[_0x5a331e(0x1b2)]['toLowerCase']()===_0x5e4fe4[_0x5a331e(0x173)]());if(_0x172ff2)_0x565e3a=_0x172ff2[_0x5a331e(0x1b2)];const _0x3291c7=_0x5a331e(0x12b),_0x3bd68a=await this[_0x5a331e(0x1b4)](_0x3291c7),_0x340e13=new Date()['toLocaleDateString']();let _0x497ec7={'history':{},'date':_0x340e13};if(_0x3bd68a&&_0x3bd68a[_0x5a331e(0x152)])try{_0x497ec7=JSON[_0x5a331e(0x17e)](_0x3bd68a['val']);}catch(_0x4ba16b){}_0x497ec7[_0x5a331e(0x126)]!==_0x340e13&&(_0x497ec7[_0x5a331e(0x178)]={},_0x497ec7[_0x5a331e(0x126)]=_0x340e13);if(!_0x497ec7['history'][_0x565e3a])_0x497ec7[_0x5a331e(0x178)][_0x565e3a]=new Array(0x18)[_0x5a331e(0x19e)](0x0);const _0xd990c3=new Date()[_0x5a331e(0x154)]();if(_0x497ec7[_0x5a331e(0x178)][_0x565e3a][_0xd990c3]<0x3c)_0x497ec7[_0x5a331e(0x178)][_0x565e3a][_0xd990c3]++;await this[_0x5a331e(0x140)](_0x3291c7,{'val':JSON['stringify'](_0x497ec7),'ack':!![]});}catch(_0xf1a742){this['log'][_0x5a331e(0x197)]('[Integrator]\x20Error:\x20'+_0xf1a742['message']);}}async[a0_0x357c58(0x135)](_0x2d523d){const _0x3b6ffd=a0_0x357c58;if(typeof _0x2d523d===_0x3b6ffd(0x164)&&_0x2d523d['message']){if(_0x2d523d['command']==='getHistoryData'){const _0x462515=_0x2d523d['message'][_0x3b6ffd(0x126)],_0x4a7b1f=utils[_0x3b6ffd(0x108)](),_0xb9c71c=path['join'](_0x4a7b1f,'cogni-living',_0x3b6ffd(0x178),_0x462515+_0x3b6ffd(0x11e));if(fs[_0x3b6ffd(0x141)](_0xb9c71c))try{const _0xfea6c6=JSON['parse'](fs['readFileSync'](_0xb9c71c,_0x3b6ffd(0x157)));this['sendTo'](_0x2d523d[_0x3b6ffd(0x103)],_0x2d523d[_0x3b6ffd(0x15a)],{'success':!![],'data':_0xfea6c6},_0x2d523d[_0x3b6ffd(0x1b3)]);}catch(_0xd399c3){this[_0x3b6ffd(0x123)](_0x2d523d[_0x3b6ffd(0x103)],_0x2d523d[_0x3b6ffd(0x15a)],{'success':![],'error':_0x3b6ffd(0x174)},_0x2d523d['callback']);}else this[_0x3b6ffd(0x123)](_0x2d523d[_0x3b6ffd(0x103)],_0x2d523d['command'],{'success':![],'error':_0x3b6ffd(0x1cb)},_0x2d523d[_0x3b6ffd(0x1b3)]);}else{if(_0x2d523d[_0x3b6ffd(0x15a)]===_0x3b6ffd(0xfa)){const _0x56047b=this[_0x3b6ffd(0x10f)][_0x3b6ffd(0x165)];let _0x6eaff1=new Array(0x18)[_0x3b6ffd(0x19e)](0x0);try{const _0x5d7661=await this[_0x3b6ffd(0x1b4)](_0x3b6ffd(0x17a));if(_0x5d7661&&_0x5d7661[_0x3b6ffd(0x152)])_0x6eaff1=JSON[_0x3b6ffd(0x17e)](_0x5d7661['val']);else{const _0x1e0ef4=new Date()[_0x3b6ffd(0x1b0)](0x0,0x0,0x0,0x0);this[_0x3b6ffd(0x194)]&&this[_0x3b6ffd(0x194)]['forEach'](_0x48ce63=>{const _0x2e36c5=_0x3b6ffd;if(_0x48ce63[_0x2e36c5(0x13f)]>=_0x1e0ef4){const _0x4842d5=new Date(_0x48ce63[_0x2e36c5(0x13f)])[_0x2e36c5(0x154)]();if(_0x4842d5>=0x0&&_0x4842d5<0x18)_0x6eaff1[_0x4842d5]++;}});}}catch(_0x2b59d0){}let _0x527833={'today':{},'yesterday':{}};try{const _0x2b44bf=await this[_0x3b6ffd(0x1b4)]('analysis.activity.roomStats');if(_0x2b44bf&&_0x2b44bf[_0x3b6ffd(0x152)])_0x527833=JSON[_0x3b6ffd(0x17e)](_0x2b44bf[_0x3b6ffd(0x152)]);}catch(_0x59b024){}let _0x2e6e87=![],_0x39dfc4='',_0x5a42a9='',_0x2f7f77='';try{const _0x5e4675=await this[_0x3b6ffd(0x1b4)](_0x3b6ffd(0x187));if(_0x5e4675&&_0x5e4675['val']){_0x2e6e87=!![];const _0x3c698f=await this[_0x3b6ffd(0x1b4)](_0x3b6ffd(0x106));_0x39dfc4=_0x3c698f?_0x3c698f[_0x3b6ffd(0x152)]:'';const _0x3db4d8=await this[_0x3b6ffd(0x1b4)](_0x3b6ffd(0x19a));_0x5a42a9=_0x3db4d8?_0x3db4d8['val']:'';const _0x50ef85=await this['getStateAsync'](_0x3b6ffd(0x15f));_0x2f7f77=_0x50ef85?_0x50ef85[_0x3b6ffd(0x152)]:'';}}catch(_0x263f1c){}const _0x592213=await this[_0x3b6ffd(0x10c)](),_0x3ed441=(this[_0x3b6ffd(0x1a4)][_0x3b6ffd(0x167)]||[])[_0x3b6ffd(0x1aa)](_0x59f0a2=>_0x59f0a2[_0x3b6ffd(0x195)]),_0x19dcc5=_0x592213&&_0x3ed441;let _0x1d18dc='';try{const _0x365155=await this[_0x3b6ffd(0x1b4)](_0x3b6ffd(0x161));if(_0x365155&&_0x365155['val'])_0x1d18dc=_0x365155['val'];}catch(_0x8f9602){}this[_0x3b6ffd(0x123)](_0x2d523d['from'],_0x2d523d[_0x3b6ffd(0x15a)],{'success':!![],'eventHistory':this[_0x3b6ffd(0x194)]['slice'](0x0,0x7d0),'stats':{'digestCount':_0x56047b,'isPresent':this[_0x3b6ffd(0x171)],'hourlyActivity':_0x6eaff1,'solarActive':_0x19dcc5,'presenceWho':_0x1d18dc,'roomStats':_0x527833,'modules':this['activeModules']},'automation':{'detected':_0x2e6e87,'description':_0x39dfc4,'targetId':_0x5a42a9,'targetValue':_0x2f7f77}},_0x2d523d[_0x3b6ffd(0x1b3)]);}else{if(_0x2d523d[_0x3b6ffd(0x15a)]===_0x3b6ffd(0x176))try{const _0x5a3bc1=await automation[_0x3b6ffd(0x124)](this);this[_0x3b6ffd(0x123)](_0x2d523d[_0x3b6ffd(0x103)],_0x2d523d[_0x3b6ffd(0x15a)],{'success':!![],'results':_0x5a3bc1},_0x2d523d['callback']);}catch(_0x10b490){this[_0x3b6ffd(0x123)](_0x2d523d['from'],_0x2d523d['command'],{'success':![],'error':_0x10b490['message']},_0x2d523d[_0x3b6ffd(0x1b3)]);}else{if(_0x2d523d['command']==='scanDevices')try{const _0x27e9aa=await scanner[_0x3b6ffd(0x11a)](this,_0x2d523d['message']||{});this[_0x3b6ffd(0x123)](_0x2d523d['from'],_0x2d523d[_0x3b6ffd(0x15a)],{'success':!![],'devices':_0x27e9aa},_0x2d523d[_0x3b6ffd(0x1b3)]);}catch(_0x10e5e4){}else{if(_0x2d523d[_0x3b6ffd(0x15a)]===_0x3b6ffd(0x100)){const _0x18b37e=await this['getForeignObjectsAsync'](_0x3b6ffd(0x198),'enum'),_0x3c2278=[];if(_0x18b37e)for(const _0x193284 in _0x18b37e){_0x3c2278[_0x3b6ffd(0x14e)]({'id':_0x193284,'name':_0x18b37e[_0x193284][_0x3b6ffd(0x1c2)]['name']});}const _0x36de08=await this['getForeignObjectsAsync'](_0x3b6ffd(0x156),_0x3b6ffd(0x119)),_0x10f686=[];if(_0x36de08)for(const _0xf09ef in _0x36de08){_0x10f686['push'](_0x36de08[_0xf09ef][_0x3b6ffd(0x1c2)][_0x3b6ffd(0x12c)]||_0xf09ef[_0x3b6ffd(0x1ad)]('.')['pop']());}this[_0x3b6ffd(0x123)](_0x2d523d[_0x3b6ffd(0x103)],_0x2d523d[_0x3b6ffd(0x15a)],{'success':!![],'enums':_0x3c2278,'rooms':_0x10f686},_0x2d523d[_0x3b6ffd(0x1b3)]);}}}}}}}async['loadSystemMode'](){const _0x4738f4=a0_0x357c58;try{const _0x3e77cb=await this[_0x4738f4(0x1b4)](setup[_0x4738f4(0x172)]);if(_0x3e77cb&&_0x3e77cb[_0x4738f4(0x152)])this[_0x4738f4(0x1c6)]=_0x3e77cb[_0x4738f4(0x152)];}catch(_0x12f4a5){this['currentSystemMode']=setup[_0x4738f4(0x169)][_0x4738f4(0x118)];}}async[a0_0x357c58(0x18d)](){return![];}async[a0_0x357c58(0x196)](){const _0x20f684=a0_0x357c58;await aiAgent[_0x20f684(0x17b)](this);this[_0x20f684(0x1a1)]['health']&&(this[_0x20f684(0x142)](),this['triggerGaitAnalysis']());if(this[_0x20f684(0x1a1)][_0x20f684(0x177)])this['triggerEnergyPrediction']();}async[a0_0x357c58(0x10c)](){return![];}[a0_0x357c58(0x18e)](){if(!this['isProVersion'])return;}async[a0_0x357c58(0x149)](){}[a0_0x357c58(0x142)](){}async[a0_0x357c58(0x1af)](_0x376b03){}async[a0_0x357c58(0x17d)](_0x4974c7,_0x3480ec){}async[a0_0x357c58(0x183)](_0x558421){}async[a0_0x357c58(0x15b)](_0x5533cd){}[a0_0x357c58(0x120)](_0x2847b9){}}if(require[a0_0x357c58(0x102)]!==module)module[a0_0x357c58(0x12d)]=_0x3c2b92=>new CogniLiving(_0x3c2b92);else new CogniLiving();