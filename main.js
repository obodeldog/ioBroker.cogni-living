const a0_0x3059de=a0_0x37c0;(function(_0x5b7d39,_0xe2542c){const _0x4d8f07=a0_0x37c0,_0x3e6539=_0x5b7d39();while(!![]){try{const _0x5e1521=parseInt(_0x4d8f07(0x365))/0x1+parseInt(_0x4d8f07(0x34f))/0x2*(parseInt(_0x4d8f07(0x35f))/0x3)+-parseInt(_0x4d8f07(0x385))/0x4*(parseInt(_0x4d8f07(0x344))/0x5)+-parseInt(_0x4d8f07(0x380))/0x6+parseInt(_0x4d8f07(0x38d))/0x7*(parseInt(_0x4d8f07(0x33e))/0x8)+-parseInt(_0x4d8f07(0x265))/0x9*(-parseInt(_0x4d8f07(0x3cc))/0xa)+-parseInt(_0x4d8f07(0x3c2))/0xb*(parseInt(_0x4d8f07(0x245))/0xc);if(_0x5e1521===_0xe2542c)break;else _0x3e6539['push'](_0x3e6539['shift']());}catch(_0x2499e9){_0x3e6539['push'](_0x3e6539['shift']());}}}(a0_0x12e9,0x49455));const a0_0x172537=(function(){let _0x2de4f2=!![];return function(_0x527ee7,_0x44d1c5){const _0x4b8e56=_0x2de4f2?function(){if(_0x44d1c5){const _0x3924e7=_0x44d1c5['apply'](_0x527ee7,arguments);return _0x44d1c5=null,_0x3924e7;}}:function(){};return _0x2de4f2=![],_0x4b8e56;};}()),a0_0xc5fbde=a0_0x172537(this,function(){const _0x4cb49d=a0_0x37c0;return a0_0xc5fbde[_0x4cb49d(0x32a)]()[_0x4cb49d(0x324)](_0x4cb49d(0x260))[_0x4cb49d(0x32a)]()[_0x4cb49d(0x2e4)](a0_0xc5fbde)['search']('(((.+)+)+)+$');});a0_0xc5fbde();'use strict';const utils=require(a0_0x3059de(0x1e7)),{GoogleGenerativeAI}=require(a0_0x3059de(0x32d)),schedule=require(a0_0x3059de(0x3c7)),{spawn,exec}=require('child_process'),path=require(a0_0x3059de(0x352)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x3059de(0x213),LTM_SCHEDULE=a0_0x3059de(0x34e),MODE_RESET_SCHEDULE=a0_0x3059de(0x28e),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x3059de(0x27e),LTM_DP_DAILY_DIGESTS=a0_0x3059de(0x379),LTM_DP_STATUS=a0_0x3059de(0x3aa),LTM_DP_TRIGGER_DIGEST=a0_0x3059de(0x24b),LTM_DP_BASELINE_STATUS=a0_0x3059de(0x2d1),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x3059de(0x335),LTM_DP_DRIFT_DETAILS=a0_0x3059de(0x27c),LTM_DP_DRIFT_LAST_CHECK=a0_0x3059de(0x35b),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x3059de(0x37f),a0_0x3059de(0x2a1),a0_0x3059de(0x2d4),a0_0x3059de(0x2fe),a0_0x3059de(0x29f),a0_0x3059de(0x2b6),a0_0x3059de(0x3c0),'maintenance',a0_0x3059de(0x276),a0_0x3059de(0x2ac),a0_0x3059de(0x2f4),a0_0x3059de(0x37a),a0_0x3059de(0x293),a0_0x3059de(0x2af),a0_0x3059de(0x2a7),a0_0x3059de(0x29d),'reachable',a0_0x3059de(0x311)],BAD_NAMES=[a0_0x3059de(0x2e6),a0_0x3059de(0x21c),a0_0x3059de(0x382),a0_0x3059de(0x223),'value',a0_0x3059de(0x2bf),'on',a0_0x3059de(0x31a),a0_0x3059de(0x22a),a0_0x3059de(0x36c),a0_0x3059de(0x31b),'blind',a0_0x3059de(0x291),a0_0x3059de(0x38f),'motion',a0_0x3059de(0x2f0),a0_0x3059de(0x2ea),a0_0x3059de(0x206),a0_0x3059de(0x2c4),'power',a0_0x3059de(0x1eb),a0_0x3059de(0x24f),a0_0x3059de(0x38c),a0_0x3059de(0x323),a0_0x3059de(0x1f5)],ADAPTER_BLACKLIST=[a0_0x3059de(0x23c),a0_0x3059de(0x2f8),a0_0x3059de(0x36b),a0_0x3059de(0x313),a0_0x3059de(0x3d4),a0_0x3059de(0x267),a0_0x3059de(0x3b3),a0_0x3059de(0x26d),'echarts.',a0_0x3059de(0x2da),a0_0x3059de(0x264)],SYSTEM_MODES={'NORMAL':a0_0x3059de(0x244),'VACATION':a0_0x3059de(0x297),'PARTY':a0_0x3059de(0x343),'GUEST':a0_0x3059de(0x362)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x3059de(0x357)],SYSTEM_MODES[a0_0x3059de(0x283)]],PERSONA_MAPPING={'generic':a0_0x3059de(0x395),'senior_aal':a0_0x3059de(0x363),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x3059de(0x36e),'security':a0_0x3059de(0x34d)};async function initZombies(_0x571d8c){const _0x296917=a0_0x3059de;try{const _0x4db3c2=[_0x296917(0x3c6),'events.history_debug_00'];for(const _0x37cd42 of _0x4db3c2){try{const _0x2d29ed=await _0x571d8c[_0x296917(0x207)](_0x37cd42);_0x2d29ed&&await _0x571d8c[_0x296917(0x1f8)](_0x37cd42);}catch(_0x136912){}}}catch(_0x275dc5){}}async function initHistory(_0x5b5412){const _0x12112e=a0_0x3059de;try{const _0x4bc91e=await _0x5b5412[_0x12112e(0x2b8)](_0x12112e(0x248));_0x4bc91e&&_0x4bc91e[_0x12112e(0x33a)]&&(_0x5b5412['eventHistory']=JSON[_0x12112e(0x210)](_0x4bc91e['val'][_0x12112e(0x32a)]()));}catch(_0x34f673){_0x5b5412[_0x12112e(0x3ad)]=[];}try{const _0x1a6b8b=await _0x5b5412[_0x12112e(0x2b8)](_0x12112e(0x2b0));if(_0x1a6b8b&&_0x1a6b8b[_0x12112e(0x33a)])_0x5b5412['analysisHistory']=JSON[_0x12112e(0x210)](_0x1a6b8b[_0x12112e(0x33a)][_0x12112e(0x32a)]());}catch(_0x4c2114){_0x5b5412[_0x12112e(0x2f7)]=[];}if(_0x5b5412[_0x12112e(0x3ad)]&&_0x5b5412[_0x12112e(0x3ad)][_0x12112e(0x3ce)]>0x0){_0x5b5412[_0x12112e(0x39c)]['info'](_0x12112e(0x255)+_0x5b5412[_0x12112e(0x3ad)][_0x12112e(0x3ce)]+_0x12112e(0x1e9));for(let _0x115ad2=_0x5b5412[_0x12112e(0x3ad)][_0x12112e(0x3ce)]-0x1;_0x115ad2>=0x0;_0x115ad2--){const _0x58125e=_0x5b5412[_0x12112e(0x3ad)][_0x115ad2];_0x58125e&&_0x58125e['id']!==undefined&&_0x58125e[_0x12112e(0x1fb)]!==undefined&&(_0x5b5412[_0x12112e(0x1ff)][_0x58125e['id']]=_0x58125e[_0x12112e(0x1fb)]);}}}async function initSystemConfig(_0x177cf4){const _0x499da9=a0_0x3059de;try{const _0x91ac33=await _0x177cf4[_0x499da9(0x2c2)](_0x499da9(0x224));_0x91ac33&&_0x91ac33[_0x499da9(0x21b)]&&(_0x177cf4[_0x499da9(0x32c)]={'latitude':_0x91ac33[_0x499da9(0x21b)][_0x499da9(0x3cd)]||0x0,'longitude':_0x91ac33[_0x499da9(0x21b)][_0x499da9(0x1fa)]||0x0,'city':_0x91ac33['common'][_0x499da9(0x238)]||''});}catch(_0x56ce38){}}async function checkLicense(_0x112a1f,_0xed0a30){const _0x3c61b5=a0_0x3059de;if(!_0xed0a30)return![];_0x112a1f[_0x3c61b5(0x3b6)]=await getSystemUUID(_0x112a1f);if(_0xed0a30===_0x3c61b5(0x2b9)||_0xed0a30[_0x3c61b5(0x252)](_0x3c61b5(0x266)))return!![];return![];}async function getSystemUUID(_0xcdf372){const _0x3bfd8d=a0_0x3059de;try{const _0x34cd9c=await _0xcdf372['getForeignObjectAsync'](_0x3bfd8d(0x222));if(_0x34cd9c&&_0x34cd9c['native']&&_0x34cd9c[_0x3bfd8d(0x330)]['uuid'])return _0x34cd9c[_0x3bfd8d(0x330)][_0x3bfd8d(0x23e)];return _0x3bfd8d(0x2de);}catch(_0x2b305e){return _0x3bfd8d(0x2f2);}}async function createAllObjects(_0x1fe3f6){const _0x50ca95=a0_0x3059de;await checkSystemObjects(_0x1fe3f6),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x376),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x2d2),'type':_0x50ca95(0x30e),'role':'text','read':!![],'write':![],'def':''},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)]('events.lastEvent',{'type':'state','common':{'name':_0x50ca95(0x261),'type':'string','role':_0x50ca95(0x294),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x248),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x2bd),'type':_0x50ca95(0x30e),'role':_0x50ca95(0x294),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x31c),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x2cf),'type':_0x50ca95(0x33b),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x2d7),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x39f),'type':_0x50ca95(0x33b),'role':_0x50ca95(0x2b7),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x275),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x2fd),'type':'string','role':_0x50ca95(0x294),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x26c),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x2c6),'type':_0x50ca95(0x33b),'role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)]('analysis.isEmergency',{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x28c),'type':_0x50ca95(0x33b),'role':_0x50ca95(0x23f),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x2ca),{'type':'state','common':{'name':'Alert\x20Reason','type':_0x50ca95(0x30e),'role':_0x50ca95(0x318),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x372),{'type':_0x50ca95(0x382),'common':{'name':'Activity\x20Summary','type':_0x50ca95(0x30e),'role':_0x50ca95(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)]('analysis.deviationFromBaseline',{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x26a),'type':_0x50ca95(0x30e),'role':_0x50ca95(0x382),'read':!![],'write':![],'def':_0x50ca95(0x228)},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)]('analysis.comfortSummary',{'type':'state','common':{'name':_0x50ca95(0x30a),'type':_0x50ca95(0x30e),'role':_0x50ca95(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x2e5),{'type':'state','common':{'name':_0x50ca95(0x32e),'type':_0x50ca95(0x30e),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x3af)](_0x50ca95(0x24e),{'type':_0x50ca95(0x303),'common':{'name':'Automation\x20Proposals'},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)]('analysis.automation.patternDetected',{'type':'state','common':{'name':_0x50ca95(0x378),'type':_0x50ca95(0x33b),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x1fe3f6['setObjectNotExistsAsync']('analysis.automation.description',{'type':'state','common':{'name':'Description','type':_0x50ca95(0x30e),'role':_0x50ca95(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6['setObjectNotExistsAsync'](_0x50ca95(0x2e7),{'type':_0x50ca95(0x382),'common':{'name':'Action','type':_0x50ca95(0x30e),'role':_0x50ca95(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6['setObjectNotExistsAsync'](_0x50ca95(0x23a),{'type':_0x50ca95(0x382),'common':{'name':'Target\x20ID','type':_0x50ca95(0x30e),'role':_0x50ca95(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x1fe3f6['setObjectNotExistsAsync']('analysis.automation.targetValue',{'type':_0x50ca95(0x382),'common':{'name':'Target\x20Value','type':_0x50ca95(0x30e),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1fe3f6['setObjectNotExistsAsync']('analysis.automation.autoApply',{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x32b),'type':'boolean','role':_0x50ca95(0x22a),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x371),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x27d),'type':_0x50ca95(0x33b),'role':_0x50ca95(0x2b7),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x2b0),{'type':'state','common':{'name':_0x50ca95(0x2f3),'type':_0x50ca95(0x30e),'role':_0x50ca95(0x294),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)]('analysis.feedbackHistory',{'type':'state','common':{'name':_0x50ca95(0x2d0),'type':_0x50ca95(0x30e),'role':_0x50ca95(0x294),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1fe3f6[_0x50ca95(0x3af)](_0x50ca95(0x24d),{'type':_0x50ca95(0x303),'common':{'name':_0x50ca95(0x208)},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x39d),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x2b4),'type':'number','role':_0x50ca95(0x334),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)](_0x50ca95(0x250),{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x3d0),'type':_0x50ca95(0x30e),'role':_0x50ca95(0x1f4),'read':!![],'write':![],'def':'none'},'native':{}}),await _0x1fe3f6[_0x50ca95(0x2a3)]('analysis.health.notes',{'type':_0x50ca95(0x382),'common':{'name':_0x50ca95(0x268),'type':'string','role':'text','read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x1fe3f6),await checkLtmDriftObjects(_0x1fe3f6);}async function checkSystemObjects(_0x49afcc){const _0x23fa41=a0_0x3059de;await _0x49afcc['extendObjectAsync'](_0x23fa41(0x22e),{'type':_0x23fa41(0x303),'common':{'name':_0x23fa41(0x325)},'native':{}}),await _0x49afcc['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x23fa41(0x382),'common':{'name':'System\x20Mode','type':_0x23fa41(0x30e),'role':_0x23fa41(0x382),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x23fa41(0x280)],'states':{[SYSTEM_MODES[_0x23fa41(0x280)]]:_0x23fa41(0x2a8),[SYSTEM_MODES[_0x23fa41(0x3a1)]]:'Urlaub',[SYSTEM_MODES['PARTY']]:_0x23fa41(0x342),[SYSTEM_MODES[_0x23fa41(0x283)]]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x592a8c){const _0x44ba0a=a0_0x3059de;await _0x592a8c['extendObjectAsync'](_0x44ba0a(0x398),{'type':_0x44ba0a(0x303),'common':{'name':_0x44ba0a(0x398)},'native':{}}),await _0x592a8c[_0x44ba0a(0x3af)](LTM_DP_RAW_LOG,{'type':_0x44ba0a(0x382),'common':{'name':_0x44ba0a(0x3b4),'type':_0x44ba0a(0x30e),'role':_0x44ba0a(0x294),'read':!![],'write':![]},'native':{}}),await _0x592a8c['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x44ba0a(0x382),'common':{'name':_0x44ba0a(0x306),'type':_0x44ba0a(0x30e),'role':'json','read':!![],'write':![]},'native':{}}),await _0x592a8c['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x44ba0a(0x382),'common':{'name':'Processing\x20Status','type':_0x44ba0a(0x30e),'role':_0x44ba0a(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x592a8c[_0x44ba0a(0x3af)](LTM_DP_TRIGGER_DIGEST,{'type':_0x44ba0a(0x382),'common':{'name':_0x44ba0a(0x3c8),'type':_0x44ba0a(0x33b),'role':_0x44ba0a(0x2b7),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x592a8c['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x44ba0a(0x382),'common':{'name':_0x44ba0a(0x3d1),'type':_0x44ba0a(0x30e),'role':_0x44ba0a(0x1f4),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4cb062){const _0x48c954=a0_0x3059de;await _0x4cb062[_0x48c954(0x3af)](LTM_DP_DRIFT_CHANNEL,{'type':_0x48c954(0x303),'common':{'name':_0x48c954(0x321)},'native':{}}),await _0x4cb062['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x48c954(0x382),'common':{'name':_0x48c954(0x26b),'type':_0x48c954(0x30e),'role':_0x48c954(0x382),'read':!![],'write':![],'def':_0x48c954(0x228)},'native':{}}),await _0x4cb062[_0x48c954(0x3af)](LTM_DP_DRIFT_DETAILS,{'type':_0x48c954(0x382),'common':{'name':_0x48c954(0x3b1),'type':_0x48c954(0x30e),'role':_0x48c954(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x4cb062[_0x48c954(0x3af)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x48c954(0x226),'type':'number','role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x2339f7){const _0x1ead06=a0_0x3059de;try{const _0x19203b=await _0x2339f7[_0x1ead06(0x2b8)](SYSTEM_DP_MODE);_0x19203b&&_0x19203b[_0x1ead06(0x33a)]&&Object[_0x1ead06(0x308)](SYSTEM_MODES)[_0x1ead06(0x2f1)](_0x19203b['val'])?_0x2339f7['currentSystemMode']=_0x19203b[_0x1ead06(0x33a)]:(_0x2339f7[_0x1ead06(0x3be)]=SYSTEM_MODES[_0x1ead06(0x280)],await _0x2339f7[_0x1ead06(0x30b)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x2a38fb){_0x2339f7[_0x1ead06(0x3be)]=SYSTEM_MODES[_0x1ead06(0x280)];}}async function loadRawEventLog(_0x425a32){const _0x2ad663=a0_0x3059de;try{const _0x53ec72=await _0x425a32[_0x2ad663(0x2b8)](LTM_DP_RAW_LOG);if(_0x53ec72&&_0x53ec72[_0x2ad663(0x33a)])_0x425a32[_0x2ad663(0x221)]=JSON[_0x2ad663(0x210)](_0x53ec72['val']);}catch(_0x46b729){_0x425a32['rawEventLog']=[];}}async function saveRawEventLog(_0x481947){const _0x20a536=a0_0x3059de;_0x481947[_0x20a536(0x221)][_0x20a536(0x3ce)]>RAW_LOG_MAX_SIZE&&_0x481947[_0x20a536(0x221)][_0x20a536(0x31d)](0x0,_0x481947[_0x20a536(0x221)]['length']-RAW_LOG_MAX_SIZE),await _0x481947[_0x20a536(0x30b)](LTM_DP_RAW_LOG,{'val':JSON[_0x20a536(0x217)](_0x481947[_0x20a536(0x221)]),'ack':!![]});}async function loadDailyDigests(_0x2e6a27){const _0x457aa4=a0_0x3059de;try{const _0x1021c7=await _0x2e6a27[_0x457aa4(0x2b8)](LTM_DP_DAILY_DIGESTS);if(_0x1021c7&&_0x1021c7[_0x457aa4(0x33a)])_0x2e6a27['dailyDigests']=JSON[_0x457aa4(0x210)](_0x1021c7[_0x457aa4(0x33a)]);}catch(_0x28294c){_0x2e6a27[_0x457aa4(0x2a9)]=[];}await updateBaselineStatus(_0x2e6a27);}async function saveDailyDigests(_0x4b44a7,_0x591416=!![]){const _0x120c94=a0_0x3059de,_0x2210a5=_0x4b44a7[_0x120c94(0x1ef)]['ltmLtbWindowDays']||0x3c;_0x4b44a7[_0x120c94(0x2a9)]['length']>_0x2210a5&&_0x4b44a7['dailyDigests'][_0x120c94(0x31d)](0x0,_0x4b44a7[_0x120c94(0x2a9)][_0x120c94(0x3ce)]-_0x2210a5);await _0x4b44a7[_0x120c94(0x30b)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x4b44a7[_0x120c94(0x2a9)]),'ack':!![]});if(_0x591416)await updateBaselineStatus(_0x4b44a7);}async function updateAnalysisHistory(_0x2c2d0b,_0x36ed99){const _0x337ade=a0_0x3059de;_0x2c2d0b['analysisHistory'][_0x337ade(0x35d)](_0x36ed99);if(_0x2c2d0b[_0x337ade(0x2f7)][_0x337ade(0x3ce)]>ANALYSIS_HISTORY_MAX_SIZE)_0x2c2d0b[_0x337ade(0x2f7)][_0x337ade(0x25b)]();await _0x2c2d0b[_0x337ade(0x30b)](_0x337ade(0x2b0),{'val':JSON[_0x337ade(0x217)](_0x2c2d0b['analysisHistory']),'ack':!![]});}function a0_0x12e9(){const _0x3c2534=['notifyTelegramEnabled','accuweather','.\x20Welcome\x20home.','analysis.lastResult','error','lock','pr√§senz','motion','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','sensor','LTM.driftAnalysis.driftDetails','Trigger\x20Action\x20Now','LTM.rawEventLog','cancel','NORMAL','testApiKey','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','GUEST','some','members','[PYTHON]\x20','targetValue','scheduleJob','IGNORING\x20DUPLICATE\x20(Cached):\x20','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','dismissAutomation','AI\x20Emergency\x20Status','now','0\x204\x20*\x20*\x20*','Cogni-Living','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','cover','getOverviewData','stick_unreach','json','testNotification','timestamp','vacation','Lernphase\x20(','unload','kill','indexOf','weatherunderground.0','firmware','weatherInstance','lowbat','getCalendarNames','scriptEnabled','enum.functions.*','setObjectNotExistsAsync','toLocaleString','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','writable','dutycycle','Normal','dailyDigests','events.lastEvent','split','fault','Feedback\x20saved:\x20','\x20events','config_pending','analysis.analysisHistory','ltmStbWindowDays','toFixed','event','Sleep\x20Score\x20(0-100)','Entry\x20detected\x20via\x20','rssi','button','getStateAsync','TEST-PRO-KEY','temp','_calName','setState','Event\x20History','üêç\x20Python\x20calculated\x20stats:\x20Mean=','brightness','sound','debug','getForeignObjectAsync','autoApply','humidity','find','AI\x20Alert\x20Status','Gemini\x20Analysis\x20Error:\x20','...','.data.table','analysis.alertReason','detected','getForeignObjectsAsync','replace','\x20(Value:\x20','Trigger\x20Analysis','Feedback\x20Log','LTM.baselineStatus','Who\x20is\x20present?','analysis.automation.targetValue','update','pythonProcess','briefingJob','analysis.triggerBriefing','[TEST]\x20','stdin','javascript.','siren','exports','setHours','uuid-not-found','feedbackHistory','communicate.request','_score','bind','onUnload','constructor','analysis.comfortSuggestion','targetposition','analysis.automation.suggestedAction','openweathermap','mean','occupancy','PONG','[LOG]','expire','isExit','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','presence','includes','uuid-error','Logbook','working','rollladen','Bibliotheken\x20nicht\x20gefunden','analysisHistory','admin.','üß™\x20Simulating\x20Butler\x20Proposal:\x20','service.py','endsWith','No\x20module\x20named','Last\x20Result','unreach','\x20sensors...','KI-Modell\x20nicht\x20initialisiert','getLtmData','notifyPushoverRecipient','channel','isPresent','Keiner','Daily\x20Digests','online','values','unknown','Comfort\x20Summary','setStateAsync','CALC_STATS','enum','string','onStateChange','getForeignStateAsync','link_quality','description','vis.','push','licenseKey','Deaktiviert\x20(Pro-Feature)','Wetter:\x20Deaktiviert','text.alarm','briefingTime','off','shutter','analysis.trigger','splice','08:00','isProVersion','sleepScore','Drift\x20Analysis','info','actual_temperature','search','System\x20Status\x20&\x20Control','geminiModel','Scheduling\x20Morning\x20Briefing\x20for\x20','schalter','automation.triggerAction','toString','Auto\x20Apply\x20Rule','systemConfig','@google/generative-ai','Comfort\x20Suggestion','KALENDER:\x20Keine\x20Daten','native','isAlert','analysisTimer','User\x20dismissed\x20automation\x20proposal.','value.health','LTM.driftAnalysis.baselineDrift','namespace','calendarSelection','Drift\x20Sched\x20Error:\x20','\x20|\x20','val','boolean','[PYTHON\x20ERR]\x20','WETTER:\x20Keine\x20Daten\x20gefunden','812368SIminX','triggerBriefing','lampe','ltmJob','Party','party','615wGncDM','analysis.automation.autoApply','onReady','doors','trim','getGenerativeModel',').\x20Starting\x20Timer.','filter','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','PRIORIT√ÑT:\x20Sicherheit.','0\x203\x20*\x20*\x20*','368lWDiOr','‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','path','klima','health','median','notifyTelegramRecipient','PARTY','warn','targetId','analysis.automation.description','LTM.driftAnalysis.lastCheck','üêç\x20Stopping\x20Python\x20Sidecar...','unshift','notifyTelegramInstance','1458SxoegF','join','write','guest','PRIORIT√ÑT:\x20Gesundheit/AAL.','generateContent','141904PeSwCc','setForeignStateAsync','fenster','WETTER\x20ERROR:\x20','üìû\x20R√ºckruf\x20anfordern','name','info.','position','Error\x20in\x20onMessage\x20command\x20','Fokus\x20auf\x20Komfort.','light','response','analysis.automation.triggerAction','analysis.activitySummary','Invalid\x20JSON\x20from\x20Python:\x20','KALENDER:\x20','onMessage','system.presenceWho','stdout','Pattern\x20Detected','LTM.dailyDigests','direction','payload','getFullYear','daswetter.0','data','scriptProblem','1722060iXAbsT','Sending\x20notification:\x20\x22','state','Could\x20not\x20kill\x20Python\x20process:\x20','python_service','9068enPCde','blind','COGNI_REQUEST_CALL','location','map','retry','selectedFunctionIds','valve','14hiMonl','close','status','send','Missing\x20data','analysis.automation.patternDetected','licht','getTime','Analysiere\x20ausgewogen.','submitFeedback','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','LTM','scanDevices','Briefing\x20Error:\x20','application/json','log','analysis.health.sleepScore','custom','Trigger\x20Briefing\x20(Test)','inactivityMonitoringEnabled','VACATION',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','genAI','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','getMonth','üåÖ\x20Daily\x20Briefing:\x0a','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','toISOString','LTM.processingStatus','ready','Error\x20reading\x20calendar\x20table:\x20','eventHistory','bewegung','extendObjectAsync','substring','Drift\x20Details','No\x20instance','icons-mfd.','Raw\x20Log','from','systemUUID',',\x20Median=','\x20=\x20','Kalender:\x20Deaktiviert','notifyPushoverInstance','time','stderr','sendToAsync','currentSystemMode','\x20presence\x20devices...','connection','modeResetJob','88NKfkgh','driftDetails','python3\x20-m\x20pip\x20install\x20-r\x20\x22','getDate','analysis.history_debug_00','node-schedule','Trigger\x20Digest','system.isPresent','sort','baselineDrift','4875320loVCyg','latitude','length','isEmergency','Restlessness\x20Level','Baseline\x20Status','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','.communicate.request','history.','lastIndexOf','triggerDailyDigest','python3','@iobroker/adapter-core','enum.rooms.*','\x20events)...','main','energy','\x20Tage)','N/A\x20(Learning)','dependencyInstallInProgress','config','message','.\x20KONTEXT:\x20','fill','inactivityThresholdHours','text','set_temperature','getHours','\x0aSTB:\x20','delObjectAsync','geminiApiKey','longitude','value','.NextHours.Location_1.Day_1.current.symbol_desc','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','ack','sensorLastValues','getCalendarNames\x20Error:\x20','üì°\x20Hooking\x20into\x20','Started\x20at\x20','.forecast.current.state','sendTo','forEach','temperature','getObjectAsync','Health\x20&\x20Sleep\x20Analysis','simulateButler','type','Error\x20checking\x20WiFi:\x20','details','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','cogni-living','cogni-living\x20adapter\x20starting\x20(v','parse','minDaysForBaseline','Starting\x20Autopilot\x20(','models/gemini-flash-latest','role','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','Vom\x20Benutzer\x20best√§tigt\x20(OK).','stringify','exitGraceTimer','Skipped\x20(No\x20AI\x20or\x20Data)','Details:\x20','common','currentposition','Adapter','WETTER:\x20','subscribeForeignStatesAsync','thermostat','rawEventLog','system.meta.uuid','level','system.config','livingContext','Last\x20Check','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','N/A','driftAnalysisTimer','switch','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','Kein\x20API\x20Key!','system','alertReason','heizung','.\x20ZUSATZ:\x20','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','slice','devices','window','Error\x20launching\x20Python\x20service:\x20','Failed\x20to\x20send\x20to\x20Python:\x20','city','Subscribing\x20to\x20','analysis.automation.targetId','Event\x20received:\x20','system.','briefingEnabled','uuid','indicator.alarm.fire','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','aiPersona','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','\x20for\x20interactive\x20buttons...','normal','83976uJTfKc','object','presenceDevices','events.history','subscribeStates','command','LTM.triggerDailyDigest','.\x0a\x20\x20\x20\x20KONTEXT:\x20','analysis.health','analysis.automation','setpoint','analysis.health.restlessness','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','startsWith','[RESULT]','automationProposal','Restoring\x20sensor\x20cache\x20from\x20history\x20(','lastAlertState','Briefing\x20Sched\x20Error:\x20','notifyPushoverEnabled','Generating\x20Morning\x20Briefing...','\x20*\x20*\x20*','pop','requirements.txt','isArray','callback','‚ö†Ô∏è\x20ALARM:\x20','(((.+)+)+)+$','Last\x20raw\x20event','.\x20OUTPUT:\x20Nur\x20Text.','COGNI_CONFIRM_OK','simple-api.','9uCttTm','PRO-','material.','Health\x20Notes','notifyEmailInstance','Deviation','Drift\x20Status','analysis.isAlert','flot.','exitTimer','Success:\x20Compressed\x20','summary','isGracePeriodActive'];a0_0x12e9=function(){return _0x3c2534;};return a0_0x12e9();}async function updateBaselineStatus(_0x330bd0){const _0x3f1b95=a0_0x3059de;if(!_0x330bd0['isProVersion']){await _0x330bd0[_0x3f1b95(0x30b)](LTM_DP_BASELINE_STATUS,{'val':_0x3f1b95(0x316),'ack':!![]});return;}const _0x4f96e2=_0x330bd0[_0x3f1b95(0x2a9)][_0x3f1b95(0x3ce)]>=(_0x330bd0['config'][_0x3f1b95(0x211)]||0x7)?'Aktiv\x20('+_0x330bd0[_0x3f1b95(0x2a9)][_0x3f1b95(0x3ce)]+_0x3f1b95(0x1ec):_0x3f1b95(0x298)+_0x330bd0['dailyDigests'][_0x3f1b95(0x3ce)]+'/'+(_0x330bd0['config']['minDaysForBaseline']||0x7)+')';await _0x330bd0[_0x3f1b95(0x30b)](LTM_DP_BASELINE_STATUS,{'val':_0x4f96e2,'ack':!![]});}async function initSensorSubscriptions(_0x501da7){const _0x6e9968=a0_0x3059de,_0x266253=_0x501da7[_0x6e9968(0x1ef)][_0x6e9968(0x234)];if(_0x266253&&_0x266253[_0x6e9968(0x3ce)]>0x0){_0x501da7[_0x6e9968(0x39c)][_0x6e9968(0x322)](_0x6e9968(0x239)+_0x266253[_0x6e9968(0x3ce)]+_0x6e9968(0x2ff));for(const _0x3db200 of _0x266253){if(_0x3db200['id']){await _0x501da7[_0x6e9968(0x21f)](_0x3db200['id']);try{const _0x360e02=await _0x501da7['getForeignStateAsync'](_0x3db200['id']);if(_0x360e02)_0x501da7[_0x6e9968(0x1ff)][_0x3db200['id']]=_0x360e02[_0x6e9968(0x33a)];}catch(_0x196bcf){}}}}}async function initPresenceSubscriptions(_0x20cb2c){const _0x5838a8=a0_0x3059de,_0x101ef4=_0x20cb2c[_0x5838a8(0x1ef)][_0x5838a8(0x247)]||[];if(_0x101ef4[_0x5838a8(0x3ce)]>0x0){_0x20cb2c[_0x5838a8(0x39c)][_0x5838a8(0x322)](_0x5838a8(0x239)+_0x101ef4['length']+_0x5838a8(0x3bf));for(const _0x4f8103 of _0x101ef4){await _0x20cb2c['subscribeForeignStatesAsync'](_0x4f8103);}try{await checkWifiPresence(_0x20cb2c);}catch(_0x359a3a){}}}async function getWeatherContext(_0x315e35){const _0xfeecf8=a0_0x3059de;try{if(!_0x315e35['config']['useWeather'])return _0xfeecf8(0x317);let _0x2cdf96='';const _0x353b6c=_0x315e35['config'][_0xfeecf8(0x29e)];if(_0x353b6c)try{if(_0x353b6c[_0xfeecf8(0x2f1)]('accuweather')){const _0x185c83=await _0x315e35['getForeignStateAsync'](_0x353b6c+'.Summary.Current');if(_0x185c83&&_0x185c83[_0xfeecf8(0x33a)])_0x2cdf96=_0x185c83[_0xfeecf8(0x33a)];}else{if(_0x353b6c[_0xfeecf8(0x2f1)]('daswetter')){const _0x3ce424=await _0x315e35[_0xfeecf8(0x310)](_0x353b6c+_0xfeecf8(0x1fc));if(_0x3ce424&&_0x3ce424[_0xfeecf8(0x33a)])_0x2cdf96=_0x3ce424['val'];}else{if(_0x353b6c[_0xfeecf8(0x2f1)](_0xfeecf8(0x2e8))){const _0x306dba=await _0x315e35[_0xfeecf8(0x310)](_0x353b6c+_0xfeecf8(0x203));if(_0x306dba&&_0x306dba[_0xfeecf8(0x33a)])_0x2cdf96=_0x306dba[_0xfeecf8(0x33a)];}}}}catch(_0x53b449){}if(!_0x2cdf96){const _0x51e26f=['accuweather.0',_0xfeecf8(0x37d),_0xfeecf8(0x29c),'openweathermap.0'];for(const _0x3313a9 of _0x51e26f){try{const _0xb2dbf0=await _0x315e35[_0xfeecf8(0x2c2)](_0x3313a9);if(_0xb2dbf0){if(_0x3313a9[_0xfeecf8(0x2f1)](_0xfeecf8(0x273))){const _0x285ef6=await _0x315e35['getForeignStateAsync'](_0x3313a9+'.Summary.Current');if(_0x285ef6&&_0x285ef6[_0xfeecf8(0x33a)]){_0x2cdf96=_0x285ef6[_0xfeecf8(0x33a)];break;}}}}catch(_0x3f63ca){}}}return _0x2cdf96?_0xfeecf8(0x21e)+_0x2cdf96:_0xfeecf8(0x33d);}catch(_0x397a82){return _0xfeecf8(0x368)+_0x397a82[_0xfeecf8(0x1f0)];}}async function getCalendarContext(_0x5704cc){const _0x24d8cd=a0_0x3059de;try{if(!_0x5704cc[_0x24d8cd(0x1ef)]['useCalendar'])return _0x24d8cd(0x3b9);let _0x3d0965=_0x5704cc['config']['calendarInstance']||'ical.0',_0x560767=_0x5704cc[_0x24d8cd(0x1ef)][_0x24d8cd(0x337)]||[];if(typeof _0x560767===_0x24d8cd(0x30e))_0x560767=_0x560767[_0x24d8cd(0x2ab)](',');try{const _0x430029=await _0x5704cc[_0x24d8cd(0x310)](_0x3d0965+_0x24d8cd(0x2c9));if(_0x430029&&_0x430029[_0x24d8cd(0x33a)]){let _0x4b3638=tryParse(_0x430029[_0x24d8cd(0x33a)]);if(_0x4b3638&&Array[_0x24d8cd(0x25d)](_0x4b3638)){if(_0x560767[_0x24d8cd(0x3ce)]>0x0)_0x4b3638=_0x4b3638[_0x24d8cd(0x34b)](_0x47e8a3=>_0x560767[_0x24d8cd(0x2f1)](_0x47e8a3[_0x24d8cd(0x2bb)]||''));else return _0x24d8cd(0x1fd);if(_0x4b3638[_0x24d8cd(0x3ce)]>0x0){const _0x1b674c=_0x4b3638[_0x24d8cd(0x233)](0x0,0x3)[_0x24d8cd(0x389)](_0x27ce3c=>{const _0x59c58c=_0x24d8cd;let _0x50b40c=_0x27ce3c['date'];if(_0x27ce3c[_0x59c58c(0x3bb)])_0x50b40c+='\x20'+_0x27ce3c['time'];return _0x50b40c+':\x20'+_0x27ce3c[_0x59c58c(0x2b3)]+'\x20('+_0x27ce3c['_calName']+')';});return _0x24d8cd(0x374)+_0x1b674c[_0x24d8cd(0x360)](_0x24d8cd(0x339));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x946e0b){_0x5704cc['log'][_0x24d8cd(0x358)](_0x24d8cd(0x3ac)+_0x946e0b[_0x24d8cd(0x1f0)]);}return _0x24d8cd(0x32f);}catch(_0x38f9b2){return'KALENDER\x20ERROR:\x20'+_0x38f9b2['message'];}}async function getCalendarNames(_0x5119e0,_0x460a3f){const _0x24e42a=a0_0x3059de;try{const _0x935974=await _0x5119e0['getForeignStateAsync'](_0x460a3f+_0x24e42a(0x2c9));if(_0x935974&&_0x935974[_0x24e42a(0x33a)]){const _0x377b68=tryParse(_0x935974[_0x24e42a(0x33a)]);if(_0x377b68&&Array[_0x24e42a(0x25d)](_0x377b68)){const _0x5abf23=[...new Set(_0x377b68['map'](_0x4c820b=>_0x4c820b[_0x24e42a(0x2bb)])[_0x24e42a(0x34b)](Boolean))];return _0x5abf23[_0x24e42a(0x3ca)]();}}return[];}catch(_0xc052d5){return _0x5119e0[_0x24e42a(0x39c)][_0x24e42a(0x276)](_0x24e42a(0x200)+_0xc052d5['message']),[];}}async function checkWifiPresence(_0xbcac54){const _0x3e60ba=a0_0x3059de;try{const _0x588e1a=_0xbcac54['config']['presenceDevices']||[];let _0x2df6d9=![];const _0x4ac39b=[];for(const _0x24764e of _0x588e1a){try{const _0x15da96=await _0xbcac54['getForeignStateAsync'](_0x24764e);if(_0x15da96&&(_0x15da96['val']===!![]||_0x15da96[_0x3e60ba(0x33a)]===_0x3e60ba(0x307)||_0x15da96[_0x3e60ba(0x33a)]===0x1)){_0x2df6d9=!![];const _0x206498=await _0xbcac54[_0x3e60ba(0x2c2)](_0x24764e);let _0x35707e=_0x24764e;_0x206498&&_0x206498[_0x3e60ba(0x21b)]&&_0x206498[_0x3e60ba(0x21b)][_0x3e60ba(0x36a)]&&(_0x35707e=typeof _0x206498[_0x3e60ba(0x21b)][_0x3e60ba(0x36a)]==='object'?_0x206498[_0x3e60ba(0x21b)]['name']['de']||_0x206498[_0x3e60ba(0x21b)][_0x3e60ba(0x36a)]['en']:_0x206498[_0x3e60ba(0x21b)][_0x3e60ba(0x36a)]),_0x4ac39b[_0x3e60ba(0x314)](_0x35707e);}}catch(_0x31bbb7){}}return await _0xbcac54[_0x3e60ba(0x30b)]('system.presenceWho',{'val':_0x4ac39b[_0x3e60ba(0x360)](',\x20'),'ack':!![]}),_0x2df6d9&&(_0xbcac54[_0x3e60ba(0x26e)]&&(_0xbcac54[_0x3e60ba(0x39c)]['info'](_0x3e60ba(0x232)),abortExitTimer(_0xbcac54)),!_0xbcac54[_0x3e60ba(0x304)]&&_0xbcac54[_0x3e60ba(0x3be)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0xbcac54,!![])),_0x2df6d9;}catch(_0x4b4711){return _0xbcac54[_0x3e60ba(0x39c)]['error'](_0x3e60ba(0x20b)+_0x4b4711['message']),![];}}function startExitTimer(_0x553e6b){const _0x11fe25=a0_0x3059de;abortExitTimer(_0x553e6b),_0x553e6b[_0x11fe25(0x271)]=!![],_0x553e6b['exitGraceTimer']=setTimeout(()=>{_0x553e6b['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x553e6b['exitTimer']=setTimeout(()=>{setPresence(_0x553e6b,![]),_0x553e6b['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x3a11b3){const _0x57007=a0_0x3059de;if(_0x3a11b3['exitTimer'])clearTimeout(_0x3a11b3[_0x57007(0x26e)]);if(_0x3a11b3[_0x57007(0x218)])clearTimeout(_0x3a11b3['exitGraceTimer']);_0x3a11b3['exitTimer']=null,_0x3a11b3['exitGraceTimer']=null,_0x3a11b3['isGracePeriodActive']=![];}function a0_0x37c0(_0x3b4518,_0xdff415){const _0x5ca5ed=a0_0x12e9();return a0_0x37c0=function(_0xc5fbde,_0x172537){_0xc5fbde=_0xc5fbde-0x1e5;let _0x12e90d=_0x5ca5ed[_0xc5fbde];return _0x12e90d;},a0_0x37c0(_0x3b4518,_0xdff415);}async function setPresence(_0x584a28,_0x39df9e){const _0x27207a=a0_0x3059de;if(_0x584a28['isPresent']===_0x39df9e)return;_0x584a28['isPresent']=_0x39df9e,await _0x584a28['setStateAsync'](_0x27207a(0x3c9),{'val':_0x39df9e,'ack':!![]});}async function saveFeedback(_0x6eedfd,_0xffe9b2){const _0x36ce55=a0_0x3059de;_0x6eedfd[_0x36ce55(0x39c)][_0x36ce55(0x322)](_0x36ce55(0x2ad)+JSON[_0x36ce55(0x217)](_0xffe9b2));}async function runBaselineDriftAnalysis(_0x4ee077){const _0x9a35ab=a0_0x3059de;if(!_0x4ee077[_0x9a35ab(0x31f)]||!_0x4ee077[_0x9a35ab(0x326)])return;const _0x2234f7=_0x4ee077['config'][_0x9a35ab(0x2b1)]||0xe;if(_0x4ee077[_0x9a35ab(0x2a9)][_0x9a35ab(0x3ce)]<_0x2234f7+(_0x4ee077['config'][_0x9a35ab(0x211)]||0x7)){await _0x4ee077[_0x9a35ab(0x30b)](LTM_DP_DRIFT_STATUS,{'val':_0x9a35ab(0x1ed),'ack':!![]});return;}const _0x24ed90=_0x4ee077['dailyDigests'][_0x9a35ab(0x233)](-_0x2234f7),_0x48f4f8=_0x4ee077[_0x9a35ab(0x2a9)][_0x9a35ab(0x233)](0x0,_0x4ee077[_0x9a35ab(0x2a9)][_0x9a35ab(0x3ce)]-_0x2234f7),_0x12b475=_0x9a35ab(0x242)+JSON[_0x9a35ab(0x217)](_0x48f4f8)+_0x9a35ab(0x1f7)+JSON[_0x9a35ab(0x217)](_0x24ed90);try{const _0x4dbcc0=await _0x4ee077[_0x9a35ab(0x326)][_0x9a35ab(0x364)](_0x12b475),_0x1acd90=JSON[_0x9a35ab(0x210)](_0x4dbcc0[_0x9a35ab(0x370)]['text']()[_0x9a35ab(0x2cd)](/```json|```/g,'')[_0x9a35ab(0x348)]());_0x1acd90[_0x9a35ab(0x3cb)]&&(await _0x4ee077[_0x9a35ab(0x30b)](LTM_DP_DRIFT_STATUS,{'val':_0x1acd90[_0x9a35ab(0x3cb)],'ack':!![]}),await _0x4ee077[_0x9a35ab(0x30b)](LTM_DP_DRIFT_DETAILS,{'val':_0x1acd90[_0x9a35ab(0x3c3)],'ack':!![]}),await _0x4ee077[_0x9a35ab(0x30b)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x9a35ab(0x28d)](),'ack':!![]}));}catch(_0x2a6949){}}function setupLtmScheduler(_0x3751a4){const _0x4c51a0=a0_0x3059de;try{if(_0x3751a4[_0x4c51a0(0x341)])_0x3751a4[_0x4c51a0(0x341)]['cancel']();if(!_0x3751a4[_0x4c51a0(0x31f)]){_0x3751a4['setStateAsync'](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x3751a4[_0x4c51a0(0x341)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x3751a4));}catch(_0x5ec12a){_0x3751a4[_0x4c51a0(0x39c)][_0x4c51a0(0x276)]('LTM\x20Sched\x20Error:\x20'+_0x5ec12a[_0x4c51a0(0x1f0)]);}}function setupModeResetScheduler(_0x1a3a59){const _0x561bb6=a0_0x3059de;try{if(_0x1a3a59[_0x561bb6(0x3c1)])_0x1a3a59['modeResetJob']['cancel']();_0x1a3a59[_0x561bb6(0x3c1)]=schedule[_0x561bb6(0x288)](MODE_RESET_SCHEDULE,async()=>{const _0x44a92e=_0x561bb6;await loadSystemMode(_0x1a3a59),AUTO_RESET_MODES[_0x44a92e(0x2f1)](_0x1a3a59[_0x44a92e(0x3be)])&&await _0x1a3a59[_0x44a92e(0x30b)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x44a92e(0x280)],'ack':![]});});}catch(_0x29cc53){_0x1a3a59[_0x561bb6(0x39c)][_0x561bb6(0x276)]('Reset\x20Sched\x20Error:\x20'+_0x29cc53[_0x561bb6(0x1f0)]);}}function setupDriftAnalysisScheduler(_0x590123){const _0x7df688=a0_0x3059de;try{if(_0x590123['driftAnalysisTimer'])clearInterval(_0x590123[_0x7df688(0x229)]);if(!_0x590123[_0x7df688(0x31f)])return;_0x590123[_0x7df688(0x229)]=setInterval(()=>runBaselineDriftAnalysis(_0x590123),(_0x590123['config']['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x590123),0x1388);}catch(_0x586f1b){_0x590123[_0x7df688(0x39c)][_0x7df688(0x276)](_0x7df688(0x338)+_0x586f1b['message']);}}function setupBriefingScheduler(_0x538db2){const _0xb12476=a0_0x3059de;try{if(_0x538db2[_0xb12476(0x2d6)])_0x538db2[_0xb12476(0x2d6)][_0xb12476(0x27f)]();if(!_0x538db2['config'][_0xb12476(0x23d)])return;const _0x3f21fe=(_0x538db2[_0xb12476(0x1ef)][_0xb12476(0x319)]||_0xb12476(0x31e))[_0xb12476(0x2ab)](':'),_0x4a4666=parseInt(_0x3f21fe[0x0])||0x8,_0x487c99=parseInt(_0x3f21fe[0x1])||0x0,_0x5dcb4c=_0x487c99+'\x20'+_0x4a4666+_0xb12476(0x25a);_0x538db2[_0xb12476(0x39c)][_0xb12476(0x322)](_0xb12476(0x327)+_0x4a4666+':'+(_0x487c99<0xa?'0'+_0x487c99:_0x487c99)),_0x538db2['briefingJob']=schedule['scheduleJob'](_0x5dcb4c,()=>{sendMorningBriefing(_0x538db2);});}catch(_0x41ef99){_0x538db2['log'][_0xb12476(0x276)](_0xb12476(0x257)+_0x41ef99[_0xb12476(0x1f0)]);}}async function sendNotification(_0xd992a0,_0x593063,_0x17fa1a=![],_0x353e12=![]){const _0x5e6020=a0_0x3059de;_0xd992a0[_0x5e6020(0x39c)]['info']((_0x17fa1a?_0x5e6020(0x2d8):'')+_0x5e6020(0x381)+_0x593063+'\x22');const _0x266a83=_0xd992a0[_0x5e6020(0x1ef)];let _0x123ff6=0x0;if(_0x266a83[_0x5e6020(0x272)]){let _0xd24a68={};(_0x593063[_0x5e6020(0x2f1)]('Alarm')||_0x353e12)&&(_0xd24a68={'reply_markup':{'inline_keyboard':[[{'text':'‚úÖ\x20Alles\x20OK\x20(Reset)','callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x5e6020(0x369),'callback_data':_0x5e6020(0x387)}]]}}),await _0xd992a0[_0x5e6020(0x3bd)](_0x266a83[_0x5e6020(0x35e)],_0x5e6020(0x390),{'text':_0x593063,'user':_0x266a83[_0x5e6020(0x356)],..._0xd24a68}),_0x123ff6++;}if(_0x266a83[_0x5e6020(0x258)]){let _0x566c9b={'message':_0x593063,'title':_0x353e12?'üö®\x20EMERGENCY':_0x5e6020(0x28f),'priority':_0x353e12?0x2:0x1,'device':_0x266a83[_0x5e6020(0x302)]};_0x353e12&&(_0x566c9b[_0x5e6020(0x38a)]=0x1e,_0x566c9b[_0x5e6020(0x2ed)]=0xe10,_0x566c9b[_0x5e6020(0x2c0)]=_0x5e6020(0x2db)),await _0xd992a0[_0x5e6020(0x3bd)](_0x266a83[_0x5e6020(0x3ba)],_0x5e6020(0x390),_0x566c9b),_0x123ff6++;}return _0x266a83['notifyEmailEnabled']&&(await _0xd992a0['sendToAsync'](_0x266a83[_0x5e6020(0x269)],_0x5e6020(0x390),{'text':_0x593063,'to':_0x266a83['notifyEmailRecipient']}),_0x123ff6++),_0x123ff6;}async function setupTelegramListener(_0x1c9ea6){const _0x215d6e=a0_0x3059de,_0x370d98=_0x1c9ea6['config'][_0x215d6e(0x35e)];_0x1c9ea6['config'][_0x215d6e(0x272)]&&_0x370d98&&(_0x1c9ea6['log'][_0x215d6e(0x322)](_0x215d6e(0x201)+_0x370d98+_0x215d6e(0x243)),await _0x1c9ea6['subscribeForeignStatesAsync'](_0x370d98+_0x215d6e(0x3d3)));}async function handleTelegramResponse(_0x28594d,_0xed9871){const _0x34f5dd=a0_0x3059de;let _0x11d870=_0xed9871;_0xed9871[_0x34f5dd(0x252)]('[')&&(_0x11d870=_0xed9871[_0x34f5dd(0x3b0)](_0xed9871[_0x34f5dd(0x29b)](']')+0x1));if(_0x11d870===_0x34f5dd(0x263))_0x28594d[_0x34f5dd(0x39c)][_0x34f5dd(0x322)](_0x34f5dd(0x20d)),await _0x28594d[_0x34f5dd(0x30b)](_0x34f5dd(0x26c),{'val':![],'ack':!![]}),await _0x28594d[_0x34f5dd(0x30b)](_0x34f5dd(0x2ca),{'val':_0x34f5dd(0x216),'ack':!![]}),_0x28594d[_0x34f5dd(0x256)]=![],sendNotification(_0x28594d,_0x34f5dd(0x240),![]);else _0x11d870===_0x34f5dd(0x387)&&(_0x28594d[_0x34f5dd(0x39c)][_0x34f5dd(0x358)]('üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x28594d,_0x34f5dd(0x227),![],!![]));}async function runAutopilot(_0x1753d0){const _0x423bdb=a0_0x3059de,_0x1d409e=_0x1753d0[_0x423bdb(0x1ef)][_0x423bdb(0x1f3)],_0x41f9af=_0x1753d0['eventHistory'][_0x423bdb(0x3ce)]>0x0?_0x1753d0[_0x423bdb(0x3ad)][0x0][_0x423bdb(0x296)]:Date[_0x423bdb(0x28d)](),_0x583c52=(Date[_0x423bdb(0x28d)]()-_0x41f9af)/(0x3e8*0x3c*0x3c);let _0x861ef='';_0x1753d0['config'][_0x423bdb(0x3a0)]&&_0x1753d0[_0x423bdb(0x3be)]===SYSTEM_MODES[_0x423bdb(0x280)]&&_0x1753d0[_0x423bdb(0x304)]&&(_0x583c52>_0x1d409e&&(_0x861ef=_0x423bdb(0x27a)+_0x583c52[_0x423bdb(0x2b2)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0x1753d0,_0x861ef)['catch'](_0x36f25f=>_0x1753d0[_0x423bdb(0x39c)]['error'](_0x36f25f));}async function createDailyDigest(_0x25d343){const _0x35fdaf=a0_0x3059de;if(!_0x25d343['isProVersion'])return;await _0x25d343[_0x35fdaf(0x30b)](LTM_DP_STATUS,{'val':_0x35fdaf(0x202)+new Date()[_0x35fdaf(0x2a4)](),'ack':!![]});if(!_0x25d343[_0x35fdaf(0x326)]||_0x25d343[_0x35fdaf(0x221)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x25d343['setStateAsync'](LTM_DP_STATUS,{'val':_0x35fdaf(0x219),'ack':!![]});return;}const _0x199670=JSON[_0x35fdaf(0x210)](JSON['stringify'](_0x25d343[_0x35fdaf(0x221)])),_0x4d7662=_0x199670[_0x35fdaf(0x3ce)],_0x11b811=_0x35fdaf(0x22b)+JSON['stringify'](_0x199670);try{const _0x459c30=await _0x25d343[_0x35fdaf(0x326)][_0x35fdaf(0x364)](_0x11b811),_0x1fc0f1=JSON[_0x35fdaf(0x210)](_0x459c30['response']['text']()['replace'](/```json|```/g,'')['trim']());_0x1fc0f1[_0x35fdaf(0x270)]&&(_0x25d343[_0x35fdaf(0x2a9)][_0x35fdaf(0x314)]({'timestamp':new Date()[_0x35fdaf(0x3a9)](),'eventCount':_0x4d7662,'summary':_0x1fc0f1[_0x35fdaf(0x270)],'activityLevel':_0x1fc0f1['activityLevel'],'systemMode':_0x25d343[_0x35fdaf(0x3be)]}),await saveDailyDigests(_0x25d343),_0x25d343[_0x35fdaf(0x221)]=[],await saveRawEventLog(_0x25d343),await _0x25d343[_0x35fdaf(0x30b)](LTM_DP_STATUS,{'val':_0x35fdaf(0x26f)+_0x4d7662+_0x35fdaf(0x2ae),'ack':!![]}));}catch(_0x5b40d8){await _0x25d343[_0x35fdaf(0x30b)](LTM_DP_STATUS,{'val':'Error:\x20'+_0x5b40d8[_0x35fdaf(0x1f0)],'ack':!![]});}}async function sendMorningBriefing(_0x58fd35){const _0x4b69cf=a0_0x3059de;if(!_0x58fd35[_0x4b69cf(0x326)])return;_0x58fd35[_0x4b69cf(0x39c)][_0x4b69cf(0x322)](_0x4b69cf(0x259));const _0x345516=_0x58fd35[_0x4b69cf(0x2a9)][_0x4b69cf(0x3ce)]>0x0?_0x58fd35[_0x4b69cf(0x2a9)][_0x58fd35['dailyDigests']['length']-0x1]:null,_0x2e9908=_0x345516&&_0x345516[_0x4b69cf(0x354)]?_0x345516[_0x4b69cf(0x354)][_0x4b69cf(0x320)]:_0x4b69cf(0x228),_0x475ec9=new Date();_0x475ec9[_0x4b69cf(0x2dd)](0x4,0x0,0x0,0x0);const _0x4fe692=_0x58fd35[_0x4b69cf(0x3ad)][_0x4b69cf(0x34b)](_0x239b4d=>new Date(_0x239b4d[_0x4b69cf(0x296)])>_0x475ec9),_0x4d8c2f=PERSONA_MAPPING[_0x58fd35[_0x4b69cf(0x1ef)][_0x4b69cf(0x241)]||'generic'],_0x505f12=_0x58fd35[_0x4b69cf(0x1ef)][_0x4b69cf(0x225)]||'',_0x199a67=await getWeatherContext(_0x58fd35),_0xd23971=await getCalendarContext(_0x58fd35),_0x2474b3=_0x4b69cf(0x3a8)+_0x4d8c2f+_0x4b69cf(0x1f1)+_0x505f12+_0x4b69cf(0x231)+_0x199a67+'\x20'+_0xd23971+'.\x20DATEN:\x20Schlaf\x20'+_0x2e9908+_0x4b69cf(0x2a5)+JSON[_0x4b69cf(0x217)](_0x4fe692[_0x4b69cf(0x233)](0x0,0xa))+_0x4b69cf(0x262);try{const _0x3123fa=await _0x58fd35[_0x4b69cf(0x326)][_0x4b69cf(0x364)](_0x2474b3),_0x469d36=_0x4b69cf(0x3a7)+_0x3123fa['response'][_0x4b69cf(0x1f4)]()[_0x4b69cf(0x348)]();sendNotification(_0x58fd35,_0x469d36),_0x58fd35['log'][_0x4b69cf(0x322)]('Morning\x20Briefing\x20sent.');}catch(_0x1ee28e){_0x58fd35[_0x4b69cf(0x39c)][_0x4b69cf(0x276)](_0x4b69cf(0x39a)+_0x1ee28e['message']);}}async function scanForDevices(_0x2bfb17,_0x4bd1b0){const _0x47f11e=a0_0x3059de;_0x2bfb17[_0x47f11e(0x39c)][_0x47f11e(0x322)](_0x47f11e(0x215));const _0x261408=[],_0x561541=await _0x2bfb17[_0x47f11e(0x2cc)]('*'),_0x30299c=await _0x2bfb17[_0x47f11e(0x2cc)](_0x47f11e(0x2a2),_0x47f11e(0x30d)),_0x4512e5=await _0x2bfb17['getForeignObjectsAsync'](_0x47f11e(0x1e8),_0x47f11e(0x30d)),_0x46d8e3={};if(_0x30299c)for(const _0x36526c in _0x30299c){const _0x3166d1=_0x30299c[_0x36526c]['common'][_0x47f11e(0x285)]||[];_0x3166d1[_0x47f11e(0x205)](_0x5051bb=>{if(!_0x46d8e3[_0x5051bb])_0x46d8e3[_0x5051bb]=[];_0x46d8e3[_0x5051bb]['push'](_0x36526c);});}const _0x419446={};if(_0x4512e5)for(const _0x3c3690 in _0x4512e5){const _0x55ba7d=_0x4512e5[_0x3c3690][_0x47f11e(0x21b)][_0x47f11e(0x285)]||[],_0x2f3118=typeof _0x4512e5[_0x3c3690]['common']['name']===_0x47f11e(0x246)?_0x4512e5[_0x3c3690]['common'][_0x47f11e(0x36a)]['de']:_0x4512e5[_0x3c3690][_0x47f11e(0x21b)][_0x47f11e(0x36a)];_0x55ba7d[_0x47f11e(0x205)](_0x315735=>_0x419446[_0x315735]=_0x2f3118);}const _0x161fd5=_0x4bd1b0[_0x47f11e(0x38b)]||[],_0x40056f=_0x4bd1b0[_0x47f11e(0x279)]!==![],_0xc5ba79=_0x4bd1b0[_0x47f11e(0x347)]!==![],_0x85bc64=_0x4bd1b0['lights']!==![],_0x44c428=_0x4bd1b0[_0x47f11e(0x206)]===!![],_0x4e966d=_0x4bd1b0['weather']===!![];for(const _0x33cb14 in _0x561541){const _0x49dba3=_0x561541[_0x33cb14];if(_0x49dba3[_0x47f11e(0x20a)]!==_0x47f11e(0x382)||!_0x49dba3['common'])continue;if(ADAPTER_BLACKLIST[_0x47f11e(0x284)](_0x26e8d2=>_0x33cb14[_0x47f11e(0x252)](_0x26e8d2))&&!_0x4e966d)continue;const _0x385251=(_0x49dba3[_0x47f11e(0x21b)][_0x47f11e(0x214)]||'')['toLowerCase']();let _0x3e284f=(typeof _0x49dba3['common'][_0x47f11e(0x36a)]===_0x47f11e(0x246)?_0x49dba3[_0x47f11e(0x21b)][_0x47f11e(0x36a)]['de']:_0x49dba3['common']['name'])||_0x33cb14;const _0x227ffb=_0x3e284f['toLowerCase']();let _0x426a3a=![],_0x106dc8=![];if(_0x161fd5['length']>0x0){const _0x1e6756=_0x46d8e3[_0x33cb14]||[],_0x134267=_0x33cb14[_0x47f11e(0x2ab)]('.')['slice'](0x0,-0x1)['join']('.'),_0x4cab68=_0x46d8e3[_0x134267]||[];(_0x1e6756[_0x47f11e(0x284)](_0x39c7ae=>_0x161fd5[_0x47f11e(0x2f1)](_0x39c7ae))||_0x4cab68[_0x47f11e(0x284)](_0x389062=>_0x161fd5[_0x47f11e(0x2f1)](_0x389062)))&&(_0x426a3a=!![],_0x106dc8=!![]);}if(!_0x426a3a&&!_0x4e966d){if(HARD_IGNORE_TERMS[_0x47f11e(0x284)](_0x27bc25=>_0x33cb14['includes'](_0x27bc25)||_0x227ffb[_0x47f11e(0x2f1)](_0x27bc25['toLowerCase']())))continue;}if(BAD_NAMES[_0x47f11e(0x284)](_0x3c42f3=>_0x227ffb===_0x3c42f3||_0x227ffb[_0x47f11e(0x2fb)]('.'+_0x3c42f3))){const _0xd768ca=_0x33cb14[_0x47f11e(0x2ab)]('.');if(_0xd768ca[_0x47f11e(0x3ce)]>0x2){const _0x2ae1fb=_0xd768ca[_0x47f11e(0x233)](0x0,-0x1)[_0x47f11e(0x360)]('.'),_0x163d1a=_0x561541[_0x2ae1fb];if(_0x163d1a&&_0x163d1a[_0x47f11e(0x21b)]&&_0x163d1a[_0x47f11e(0x21b)]['name']){const _0x32162f=typeof _0x163d1a[_0x47f11e(0x21b)][_0x47f11e(0x36a)]==='object'?_0x163d1a[_0x47f11e(0x21b)][_0x47f11e(0x36a)]['de']:_0x163d1a[_0x47f11e(0x21b)]['name'];_0x32162f&&!_0x3e284f[_0x47f11e(0x2f1)](_0x32162f)&&(_0x3e284f=_0x32162f+'\x20'+_0x3e284f);}}}let _0x155e48='';if(_0x40056f&&(_0x385251[_0x47f11e(0x2f1)](_0x47f11e(0x279))||_0x385251[_0x47f11e(0x2f1)]('occupancy')||_0x227ffb[_0x47f11e(0x2f1)](_0x47f11e(0x3ae))||_0x227ffb[_0x47f11e(0x2f1)](_0x47f11e(0x278))))_0x155e48=_0x47f11e(0x279);else{if(!_0x155e48&&_0xc5ba79&&(_0x385251[_0x47f11e(0x2f1)]('door')||_0x385251[_0x47f11e(0x2f1)](_0x47f11e(0x235))||_0x385251[_0x47f11e(0x2f1)](_0x47f11e(0x277))||_0x385251[_0x47f11e(0x2f1)](_0x47f11e(0x386))||_0x385251[_0x47f11e(0x2f1)](_0x47f11e(0x31b))||_0x227ffb[_0x47f11e(0x2f1)](_0x47f11e(0x367))||_0x227ffb[_0x47f11e(0x2f1)]('t√ºr')||_0x227ffb['includes'](_0x47f11e(0x2f5))))_0x155e48='door';else{if(!_0x155e48&&_0x85bc64&&(_0x385251['includes'](_0x47f11e(0x36f))||_0x385251[_0x47f11e(0x2f1)]('switch')||_0x385251[_0x47f11e(0x2f1)]('dimmer')||_0x227ffb[_0x47f11e(0x2f1)](_0x47f11e(0x393))||_0x227ffb['includes'](_0x47f11e(0x340))||_0x227ffb[_0x47f11e(0x2f1)](_0x47f11e(0x328)))){if(_0x49dba3[_0x47f11e(0x21b)][_0x47f11e(0x361)]||_0x385251['includes'](_0x47f11e(0x27b)))_0x155e48=_0x47f11e(0x36f);}else{if(!_0x155e48&&_0x44c428&&(_0x385251['includes']('temperature')||_0x385251[_0x47f11e(0x2f1)]('humidity')||_0x385251[_0x47f11e(0x2f1)](_0x47f11e(0x220))||_0x227ffb[_0x47f11e(0x2f1)](_0x47f11e(0x2ba))||_0x227ffb['includes'](_0x47f11e(0x353))||_0x227ffb[_0x47f11e(0x2f1)](_0x47f11e(0x230))))_0x155e48=_0x47f11e(0x206);else{if(!_0x155e48&&_0x106dc8)_0x155e48=_0x47f11e(0x39e);}}}}if(_0x155e48){let _0x1371c4=_0x419446[_0x33cb14]||'';if(!_0x1371c4){let _0x1c1210=_0x33cb14;for(let _0x459fa0=0x0;_0x459fa0<0x3;_0x459fa0++){const _0x431d96=_0x1c1210[_0x47f11e(0x3d5)]('.');if(_0x431d96===-0x1)break;_0x1c1210=_0x1c1210['substring'](0x0,_0x431d96);if(_0x419446[_0x1c1210]){_0x1371c4=_0x419446[_0x1c1210];break;}}}_0x261408[_0x47f11e(0x314)]({'id':_0x33cb14,'name':_0x3e284f,'location':_0x1371c4,'type':_0x155e48,'logDuplicates':_0x155e48===_0x47f11e(0x279),'isExit':![],'_score':_0x1371c4?0x50:_0x155e48===_0x47f11e(0x39e)?0x5a:0x28});}}return _0x261408['sort']((_0x4d32a5,_0x27d37c)=>_0x27d37c[_0x47f11e(0x2e1)]-_0x4d32a5[_0x47f11e(0x2e1)]),_0x261408;}async function executeAutomationAction(_0xa0fcee){const _0x112775=a0_0x3059de;try{const _0x1f5a4f=await _0xa0fcee['getStateAsync'](_0x112775(0x23a)),_0x53e266=await _0xa0fcee[_0x112775(0x2b8)](_0x112775(0x2d3));if(_0x1f5a4f&&_0x1f5a4f['val']&&_0x53e266){const _0x4f0668=_0x1f5a4f[_0x112775(0x33a)];let _0x1f5e9f=_0x53e266[_0x112775(0x33a)];try{_0x1f5e9f=JSON[_0x112775(0x210)](_0x1f5e9f);}catch(_0x17ed02){}_0xa0fcee[_0x112775(0x39c)][_0x112775(0x322)](_0x112775(0x28a)+_0x4f0668+_0x112775(0x3b8)+_0x1f5e9f),await _0xa0fcee[_0x112775(0x366)](_0x4f0668,_0x1f5e9f);}else _0xa0fcee[_0x112775(0x39c)][_0x112775(0x358)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x293899){_0xa0fcee[_0x112775(0x39c)]['error']('BUTLER\x20Execution\x20Error:\x20'+_0x293899['message']);}}function tryParse(_0x449970){const _0x366a53=a0_0x3059de;try{return JSON[_0x366a53(0x210)](_0x449970);}catch(_0x14827b){return null;}}async function processSensorEvent(_0x2ce40b,_0x47184c,_0xe71ed5,_0x1faede){const _0x2e385b=a0_0x3059de;if(!_0x1faede)return;const _0x2d8d10=_0xe71ed5[_0x2e385b(0x33a)],_0x10a71d=Date['now']();_0x2ce40b[_0x2e385b(0x39c)]['debug'](_0x2e385b(0x23b)+_0x47184c+'\x20=\x20'+_0x2d8d10);const _0x1c0fd8=_0x2ce40b[_0x2e385b(0x1ff)][_0x47184c];_0x2ce40b['sensorLastValues'][_0x47184c]=_0x2d8d10;if(!_0x1faede['logDuplicates']&&_0x1c0fd8!=undefined&&_0x1c0fd8==_0x2d8d10){_0x2ce40b['log']['debug'](_0x2e385b(0x289)+_0x1faede[_0x2e385b(0x36a)]+_0x2e385b(0x2ce)+_0x2d8d10+')');return;}const _0x5a31fa={'timestamp':_0x10a71d,'id':_0x47184c,'name':_0x1faede[_0x2e385b(0x36a)],'type':_0x1faede[_0x2e385b(0x20a)],'location':_0x1faede[_0x2e385b(0x388)],'value':_0x2d8d10};_0x2ce40b[_0x2e385b(0x3ad)][_0x2e385b(0x35d)](_0x5a31fa);if(_0x2ce40b[_0x2e385b(0x3ad)]['length']>HISTORY_MAX_SIZE)_0x2ce40b['eventHistory']['pop']();await _0x2ce40b[_0x2e385b(0x30b)](_0x2e385b(0x2aa),{'val':JSON['stringify'](_0x5a31fa),'ack':!![]}),await _0x2ce40b[_0x2e385b(0x30b)](_0x2e385b(0x248),{'val':JSON['stringify'](_0x2ce40b[_0x2e385b(0x3ad)]),'ack':!![]});_0x2ce40b[_0x2e385b(0x31f)]&&(_0x2ce40b[_0x2e385b(0x221)]['push'](_0x5a31fa),await saveRawEventLog(_0x2ce40b));if(_0x1faede[_0x2e385b(0x2ee)]&&_0x2d8d10===!![]){if(_0x2ce40b['isPresent']&&!_0x2ce40b[_0x2e385b(0x271)])_0x2ce40b['log']['info']('Exit\x20Sensor\x20triggered\x20('+_0x1faede['name']+_0x2e385b(0x34a)),startExitTimer(_0x2ce40b);else!_0x2ce40b['isPresent']&&(_0x2ce40b[_0x2e385b(0x39c)]['info'](_0x2e385b(0x2b5)+_0x1faede[_0x2e385b(0x36a)]+_0x2e385b(0x274)),await setPresence(_0x2ce40b,!![]));}else _0x1faede[_0x2e385b(0x20a)]==='motion'&&_0x2d8d10===!![]&&(_0x2ce40b[_0x2e385b(0x26e)]&&(_0x2ce40b['log'][_0x2e385b(0x322)]('Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.'),abortExitTimer(_0x2ce40b)),!_0x2ce40b[_0x2e385b(0x304)]&&_0x2ce40b[_0x2e385b(0x3be)]===SYSTEM_MODES[_0x2e385b(0x280)]&&await setPresence(_0x2ce40b,!![]));}async function runGeminiAnalysis(_0x197315,_0x5e16d4=''){const _0x126fb7=a0_0x3059de;if(!_0x197315[_0x126fb7(0x326)])return;if(_0x197315[_0x126fb7(0x3ad)]['length']===0x0)return;const _0x33d19d=_0x197315['eventHistory']['slice'](0x0,0xf),_0x22e76a=await getWeatherContext(_0x197315),_0x1e12e0=_0x197315[_0x126fb7(0x3be)],_0x169e58=PERSONA_MAPPING[_0x197315[_0x126fb7(0x1ef)][_0x126fb7(0x241)]||'generic'],_0x44de67=_0x197315['config'][_0x126fb7(0x225)]||'Keine\x20Details.';let _0x55ca3a=![];try{const _0x5e3a43=await _0x197315[_0x126fb7(0x2b8)]('analysis.automation.autoApply');if(_0x5e3a43&&_0x5e3a43['val'])_0x55ca3a=!![];}catch(_0x2a6a47){}const _0x29912b=_0x126fb7(0x22c)+_0x169e58+_0x126fb7(0x24c)+_0x44de67+_0x126fb7(0x251)+_0x1e12e0+'.\x0a\x20\x20\x20\x20WETTER:\x20'+_0x22e76a+_0x126fb7(0x2ef)+(_0x5e16d4||_0x126fb7(0x305))+_0x126fb7(0x397)+JSON[_0x126fb7(0x217)](_0x33d19d)+_0x126fb7(0x282);try{const _0x4bc837=await _0x197315['geminiModel'][_0x126fb7(0x364)](_0x29912b),_0x2cd35b=_0x4bc837[_0x126fb7(0x370)]['text']()['replace'](/```json|```/g,'')['trim'](),_0x99b196=JSON['parse'](_0x2cd35b);await _0x197315[_0x126fb7(0x30b)](_0x126fb7(0x275),{'val':JSON['stringify'](_0x99b196),'ack':!![]});const _0x14b9da=_0x99b196[_0x126fb7(0x331)]||![];_0x14b9da!==_0x197315[_0x126fb7(0x256)]&&(await _0x197315[_0x126fb7(0x30b)]('analysis.isAlert',{'val':_0x14b9da,'ack':!![]}),_0x197315[_0x126fb7(0x256)]=_0x14b9da,_0x14b9da&&(await _0x197315[_0x126fb7(0x30b)]('analysis.alertReason',{'val':_0x99b196[_0x126fb7(0x22f)],'ack':!![]}),sendNotification(_0x197315,_0x126fb7(0x25f)+_0x99b196[_0x126fb7(0x22f)],![],_0x99b196[_0x126fb7(0x3cf)]))),_0x99b196[_0x126fb7(0x254)]&&_0x99b196['automationProposal'][_0x126fb7(0x2cb)]&&_0x99b196[_0x126fb7(0x254)][_0x126fb7(0x359)]&&(_0x197315[_0x126fb7(0x39c)][_0x126fb7(0x322)](_0x126fb7(0x34c)+_0x99b196[_0x126fb7(0x254)][_0x126fb7(0x312)]),await _0x197315['setStateAsync'](_0x126fb7(0x392),{'val':!![],'ack':!![]}),await _0x197315['setStateAsync'](_0x126fb7(0x35a),{'val':_0x99b196['automationProposal']['description'],'ack':!![]}),await _0x197315[_0x126fb7(0x30b)](_0x126fb7(0x23a),{'val':_0x99b196['automationProposal'][_0x126fb7(0x359)],'ack':!![]}),await _0x197315['setStateAsync']('analysis.automation.targetValue',{'val':JSON['stringify'](_0x99b196[_0x126fb7(0x254)][_0x126fb7(0x287)]),'ack':!![]}),_0x55ca3a&&(_0x197315['log'][_0x126fb7(0x322)]('ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20'+_0x99b196[_0x126fb7(0x254)]['targetId']+_0x126fb7(0x2c8)),await executeAutomationAction(_0x197315)));}catch(_0x1153e0){_0x197315[_0x126fb7(0x39c)]['error'](_0x126fb7(0x2c7)+_0x1153e0[_0x126fb7(0x1f0)]);}}function installPythonDependencies(_0x46de01){const _0x1839f7=a0_0x3059de;if(_0x46de01[_0x1839f7(0x1ee)])return;_0x46de01[_0x1839f7(0x1ee)]=!![];const _0x1cf4be=path[_0x1839f7(0x360)](__dirname,_0x1839f7(0x384),_0x1839f7(0x25c));_0x46de01[_0x1839f7(0x39c)]['info'](_0x1839f7(0x3d2)+_0x1cf4be+_0x1839f7(0x2c8)),stopPythonService(_0x46de01);const _0x21a9a6=_0x1839f7(0x3c4)+_0x1cf4be+'\x22\x20--break-system-packages';exec(_0x21a9a6,(_0x3f6934,_0x84085e,_0x17e1dd)=>{const _0x133c77=_0x1839f7;_0x46de01[_0x133c77(0x1ee)]=![],_0x3f6934?(_0x46de01[_0x133c77(0x39c)]['error'](_0x133c77(0x350)+_0x21a9a6),_0x46de01[_0x133c77(0x39c)][_0x133c77(0x276)](_0x133c77(0x21a)+(_0x17e1dd||_0x3f6934[_0x133c77(0x1f0)]))):(_0x46de01['log'][_0x133c77(0x322)](_0x133c77(0x3a4)),startPythonService(_0x46de01));});}function sendToPython(_0x441d06,_0x968ce5,_0x2de2d7={}){const _0x57ff64=a0_0x3059de;if(!_0x441d06['pythonProcess']||!_0x441d06[_0x57ff64(0x2d5)][_0x57ff64(0x2d9)][_0x57ff64(0x2a6)])return;const _0x3119fd=JSON[_0x57ff64(0x217)]({'command':_0x968ce5,..._0x2de2d7});try{_0x441d06[_0x57ff64(0x2d5)][_0x57ff64(0x2d9)][_0x57ff64(0x361)](_0x3119fd+'\x0a');}catch(_0x223286){_0x441d06['log'][_0x57ff64(0x276)](_0x57ff64(0x237)+_0x223286['message']);}}function handlePythonResult(_0xd00530,_0x1f5133){const _0x4f4f87=a0_0x3059de;if(_0x1f5133[_0x4f4f87(0x20a)]===_0x4f4f87(0x2eb))_0xd00530[_0x4f4f87(0x39c)][_0x4f4f87(0x2c1)]('üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.');else _0x1f5133[_0x4f4f87(0x20a)]==='STATS_RESULT'&&_0xd00530[_0x4f4f87(0x39c)][_0x4f4f87(0x322)](_0x4f4f87(0x2be)+_0x1f5133[_0x4f4f87(0x37b)][_0x4f4f87(0x2e9)]+_0x4f4f87(0x3b7)+_0x1f5133[_0x4f4f87(0x37b)][_0x4f4f87(0x355)]);}function startPythonService(_0x274794){const _0x42b26f=a0_0x3059de;try{const _0x5047ae=path[_0x42b26f(0x360)](__dirname,_0x42b26f(0x384),_0x42b26f(0x2fa));_0x274794['log'][_0x42b26f(0x322)]('üêç\x20Starting\x20Python\x20Sidecar:\x20'+_0x5047ae),_0x274794[_0x42b26f(0x2d5)]=spawn(_0x42b26f(0x1e6),[_0x5047ae]),_0x274794['pythonProcess'][_0x42b26f(0x377)]['on'](_0x42b26f(0x37e),_0x3a72dc=>{const _0x9ea0cc=_0x42b26f,_0x1b39fe=_0x3a72dc[_0x9ea0cc(0x32a)]()['split']('\x0a');_0x1b39fe[_0x9ea0cc(0x205)](_0x2cd914=>{const _0x34e900=_0x9ea0cc,_0x32e186=_0x2cd914['trim']();if(!_0x32e186)return;if(_0x32e186[_0x34e900(0x252)](_0x34e900(0x2ec)))_0x274794[_0x34e900(0x39c)][_0x34e900(0x2c1)](_0x34e900(0x286)+_0x32e186['substring'](0x5)[_0x34e900(0x348)]());else{if(_0x32e186[_0x34e900(0x252)](_0x34e900(0x253)))try{const _0x12b94d=JSON[_0x34e900(0x210)](_0x32e186[_0x34e900(0x3b0)](0x8)[_0x34e900(0x348)]());handlePythonResult(_0x274794,_0x12b94d);}catch(_0x43b7de){_0x274794['log'][_0x34e900(0x358)](_0x34e900(0x373)+_0x32e186);}}(_0x32e186[_0x34e900(0x2f1)](_0x34e900(0x2fc))||_0x32e186['includes'](_0x34e900(0x2f6)))&&(_0x274794[_0x34e900(0x39c)][_0x34e900(0x358)](_0x34e900(0x290)),installPythonDependencies(_0x274794));});}),_0x274794['pythonProcess'][_0x42b26f(0x3bc)]['on'](_0x42b26f(0x37e),_0x219e36=>{const _0x291695=_0x42b26f,_0x4efe1f=_0x219e36['toString']()[_0x291695(0x348)]();_0x274794['log'][_0x291695(0x276)](_0x291695(0x33c)+_0x4efe1f);}),_0x274794['pythonProcess']['on'](_0x42b26f(0x38e),_0x5902a4=>{const _0xec6031=_0x42b26f;_0x274794[_0xec6031(0x39c)][_0xec6031(0x322)](_0xec6031(0x351)+_0x5902a4),_0x274794[_0xec6031(0x2d5)]=null;}),_0x274794[_0x42b26f(0x2d5)]['on'](_0x42b26f(0x276),_0x4a2be7=>{const _0x5a3d74=_0x42b26f;_0x274794[_0x5a3d74(0x39c)]['warn']('[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20'+_0x4a2be7[_0x5a3d74(0x1f0)]);});}catch(_0x2fc995){_0x274794[_0x42b26f(0x39c)][_0x42b26f(0x276)](_0x42b26f(0x236)+_0x2fc995[_0x42b26f(0x1f0)]);}}function stopPythonService(_0x206c6b){const _0x8312cc=a0_0x3059de;if(_0x206c6b[_0x8312cc(0x2d5)]){_0x206c6b[_0x8312cc(0x39c)][_0x8312cc(0x322)](_0x8312cc(0x35c));try{_0x206c6b[_0x8312cc(0x2d5)][_0x8312cc(0x29a)]();}catch(_0x408f3b){_0x206c6b[_0x8312cc(0x39c)][_0x8312cc(0x358)](_0x8312cc(0x383)+_0x408f3b[_0x8312cc(0x1f0)]);}_0x206c6b[_0x8312cc(0x2d5)]=null;}}class CogniLiving extends utils[a0_0x3059de(0x21d)]{constructor(_0x2e2230){const _0x287777=a0_0x3059de;super({..._0x2e2230,'name':_0x287777(0x20e)}),this[_0x287777(0x3ad)]=[],this[_0x287777(0x2f7)]=[],this[_0x287777(0x2df)]=[],this[_0x287777(0x221)]=[],this['dailyDigests']=[],this[_0x287777(0x1ff)]={},this[_0x287777(0x32c)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x287777(0x26e)]=null,this['exitGraceTimer']=null,this[_0x287777(0x271)]=![],this[_0x287777(0x3a3)]=null,this['geminiModel']=null,this['currentSystemMode']=SYSTEM_MODES[_0x287777(0x280)],this[_0x287777(0x31f)]=![],this[_0x287777(0x256)]=![],this[_0x287777(0x3b6)]=_0x287777(0x309),this['analysisTimer']=null,this['ltmJob']=null,this['modeResetJob']=null,this[_0x287777(0x229)]=null,this['briefingJob']=null,this[_0x287777(0x2d5)]=null,this[_0x287777(0x1ee)]=![],this['on'](_0x287777(0x3ab),this[_0x287777(0x346)][_0x287777(0x2e2)](this)),this['on']('stateChange',this[_0x287777(0x30f)][_0x287777(0x2e2)](this)),this['on'](_0x287777(0x299),this[_0x287777(0x2e3)][_0x287777(0x2e2)](this)),this['on'](_0x287777(0x1f0),this[_0x287777(0x375)][_0x287777(0x2e2)](this));}async['onReady'](){const _0x49c4cd=a0_0x3059de;this[_0x49c4cd(0x39c)][_0x49c4cd(0x322)](_0x49c4cd(0x20f)+this['version']+_0x49c4cd(0x3a2)),await initZombies(this),this['config'][_0x49c4cd(0x315)]=this[_0x49c4cd(0x1ef)][_0x49c4cd(0x315)]||'';try{this['isProVersion']=await checkLicense(this,this['config']['licenseKey']);}catch(_0x137265){}if(!this[_0x49c4cd(0x1ef)]['inactivityThresholdHours']||this[_0x49c4cd(0x1ef)][_0x49c4cd(0x1f3)]<0.1)this[_0x49c4cd(0x1ef)][_0x49c4cd(0x1f3)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x49c4cd(0x1ef)][_0x49c4cd(0x1f9)])try{this[_0x49c4cd(0x3a3)]=new GoogleGenerativeAI(this[_0x49c4cd(0x1ef)]['geminiApiKey']),this['geminiModel']=this[_0x49c4cd(0x3a3)][_0x49c4cd(0x349)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x49c4cd(0x39b)}}),this['log'][_0x49c4cd(0x322)]('Gemini\x20AI\x20initialized.');}catch(_0x40c947){this[_0x49c4cd(0x39c)][_0x49c4cd(0x276)]('Gemini\x20Init\x20Error:\x20'+_0x40c947['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x49c4cd(0x249)](_0x49c4cd(0x31c)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x49c4cd(0x249)]('system.mode'),this['subscribeStates'](_0x49c4cd(0x2d7)),this[_0x49c4cd(0x249)](_0x49c4cd(0x371)),this['subscribeStates'](_0x49c4cd(0x345)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x49c4cd(0x332)])clearInterval(this[_0x49c4cd(0x332)]);const _0x34c6db=this[_0x49c4cd(0x1ef)]['analysisInterval']||0xf;_0x34c6db>0x0&&(this['log'][_0x49c4cd(0x322)](_0x49c4cd(0x212)+_0x34c6db+'\x20min).'),this[_0x49c4cd(0x332)]=setInterval(()=>{runAutopilot(this);},_0x34c6db*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x5f568f=_0x49c4cd;this[_0x5f568f(0x2d5)]&&(this[_0x5f568f(0x39c)][_0x5f568f(0x322)]('Testing\x20Python-Link\x20(Calculating\x20stats\x20for\x20[10,\x2020,\x2099])...'),sendToPython(this,_0x5f568f(0x30c),{'values':[0xa,0x14,0x63]}));},0x1388);}[a0_0x3059de(0x2e3)](_0x3a1654){const _0x4bd4f4=a0_0x3059de;if(this[_0x4bd4f4(0x332)])clearInterval(this[_0x4bd4f4(0x332)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x4bd4f4(0x229)]);if(this[_0x4bd4f4(0x341)])this['ltmJob']['cancel']();if(this['modeResetJob'])this[_0x4bd4f4(0x3c1)][_0x4bd4f4(0x27f)]();if(this[_0x4bd4f4(0x2d6)])this[_0x4bd4f4(0x2d6)]['cancel']();if(this['exitTimer'])clearTimeout(this[_0x4bd4f4(0x26e)]);if(this[_0x4bd4f4(0x218)])clearTimeout(this[_0x4bd4f4(0x218)]);stopPythonService(this),_0x3a1654();}async[a0_0x3059de(0x30f)](_0x510ba0,_0x34d5fc){const _0xdcedb1=a0_0x3059de;if(!_0x34d5fc)return;if(_0x510ba0[_0xdcedb1(0x2f1)]('telegram')&&_0x510ba0[_0xdcedb1(0x2fb)](_0xdcedb1(0x2e0))&&_0x34d5fc[_0xdcedb1(0x33a)]){await handleTelegramResponse(this,_0x34d5fc[_0xdcedb1(0x33a)]);return;}if(_0x510ba0===this[_0xdcedb1(0x336)]+'.'+SYSTEM_DP_MODE){_0x34d5fc[_0xdcedb1(0x33a)]&&Object[_0xdcedb1(0x308)](SYSTEM_MODES)[_0xdcedb1(0x2f1)](_0x34d5fc[_0xdcedb1(0x33a)])&&(this[_0xdcedb1(0x3be)]=_0x34d5fc[_0xdcedb1(0x33a)],_0x34d5fc[_0xdcedb1(0x33a)]===SYSTEM_MODES[_0xdcedb1(0x3a1)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x34d5fc['ack'])this[_0xdcedb1(0x2bc)](_0x510ba0,{'val':this[_0xdcedb1(0x3be)],'ack':!![]});return;}if(!_0x34d5fc[_0xdcedb1(0x1fe)]){_0x510ba0[_0xdcedb1(0x2f1)](_0xdcedb1(0x31c))&&_0x34d5fc[_0xdcedb1(0x33a)]&&(this[_0xdcedb1(0x2bc)](_0x510ba0,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x510ba0[_0xdcedb1(0x2f1)](_0xdcedb1(0x1e5))&&_0x34d5fc[_0xdcedb1(0x33a)]){this[_0xdcedb1(0x2bc)](_0x510ba0,{'val':![],'ack':!![]});if(this[_0xdcedb1(0x31f)])createDailyDigest(this);}_0x510ba0[_0xdcedb1(0x2f1)](_0xdcedb1(0x33f))&&_0x34d5fc[_0xdcedb1(0x33a)]&&(this[_0xdcedb1(0x2bc)](_0x510ba0,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x510ba0[_0xdcedb1(0x2f1)](_0xdcedb1(0x329))&&_0x34d5fc[_0xdcedb1(0x33a)]&&(this[_0xdcedb1(0x2bc)](_0x510ba0,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0xdcedb1(0x1ef)][_0xdcedb1(0x247)]&&this[_0xdcedb1(0x1ef)][_0xdcedb1(0x247)][_0xdcedb1(0x2f1)](_0x510ba0)){await checkWifiPresence(this);return;}const _0x18c963=(this[_0xdcedb1(0x1ef)][_0xdcedb1(0x234)]||[])[_0xdcedb1(0x2c5)](_0xcd9124=>_0xcd9124['id']===_0x510ba0);if(_0x18c963)processSensorEvent(this,_0x510ba0,_0x34d5fc,_0x18c963);}async['onMessage'](_0x498298){const _0x55801e=a0_0x3059de;if(typeof _0x498298===_0x55801e(0x246)&&_0x498298[_0x55801e(0x1f0)])try{if(_0x498298['command']===_0x55801e(0x281)){}else{if(_0x498298[_0x55801e(0x24a)]===_0x55801e(0x295)){}else{if(_0x498298['command']===_0x55801e(0x301)){if(!this['isProVersion'])return this[_0x55801e(0x204)](_0x498298['from'],_0x498298[_0x55801e(0x24a)],{'success':![],'isPro':![]},_0x498298[_0x55801e(0x25e)]);let _0x5d98ac={'status':_0x55801e(0x228),'details':'','lastCheck':0x0};try{_0x5d98ac[_0x55801e(0x38f)]=(await this[_0x55801e(0x2b8)](LTM_DP_DRIFT_STATUS))['val'],_0x5d98ac[_0x55801e(0x20c)]=(await this[_0x55801e(0x2b8)](LTM_DP_DRIFT_DETAILS))['val'],_0x5d98ac['lastCheck']=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x55801e(0x33a)];}catch(_0x11eca2){}const _0x2d55be=this['analysisHistory']||[];this[_0x55801e(0x204)](_0x498298[_0x55801e(0x3b5)],_0x498298[_0x55801e(0x24a)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x55801e(0x2a9)],'driftAnalysis':_0x5d98ac,'analysisHistory':_0x2d55be},_0x498298[_0x55801e(0x25e)]);}else{if(_0x498298[_0x55801e(0x24a)]===_0x55801e(0x292)){const _0x223247=this['dailyDigests'][_0x55801e(0x3ce)],_0x228fec=new Date(),_0x378083=new Date(_0x228fec[_0x55801e(0x37c)](),_0x228fec[_0x55801e(0x3a6)](),_0x228fec[_0x55801e(0x3c5)]())[_0x55801e(0x394)](),_0x58dd01=this['rawEventLog'][_0x55801e(0x34b)](_0x2b6c18=>new Date(_0x2b6c18[_0x55801e(0x296)])[_0x55801e(0x394)]()>_0x378083)[_0x55801e(0x3ce)],_0x3e4567=new Array(0x18)[_0x55801e(0x1f2)](0x0);this[_0x55801e(0x221)][_0x55801e(0x205)](_0x21256b=>{const _0x30b626=_0x55801e,_0x5409ad=new Date(_0x21256b[_0x30b626(0x296)]);if(_0x5409ad[_0x30b626(0x394)]()>_0x378083)_0x3e4567[_0x5409ad[_0x30b626(0x1f6)]()]++;});let _0xfe7822={'status':_0x55801e(0x228)};try{_0xfe7822[_0x55801e(0x38f)]=(await this[_0x55801e(0x2b8)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x29366d){}let _0x318880='';try{const _0x3a101d=await this[_0x55801e(0x2b8)](_0x55801e(0x376));_0x318880=_0x3a101d?_0x3a101d[_0x55801e(0x33a)]:'';}catch(_0x49a264){}let _0x18edcb=null;!this['geminiModel']&&(_0x18edcb=this['config']['geminiApiKey']?_0x55801e(0x300):_0x55801e(0x22d));let _0x50ecc7={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x17bb76=await this[_0x55801e(0x2b8)]('analysis.automation.patternDetected'),_0xfacafb=await this['getStateAsync'](_0x55801e(0x35a)),_0x3d4bda=await this[_0x55801e(0x2b8)]('analysis.automation.targetId'),_0x5bd0d9=await this[_0x55801e(0x2b8)](_0x55801e(0x2d3)),_0x590b8c=await this['getStateAsync'](_0x55801e(0x345));_0x17bb76&&_0x17bb76[_0x55801e(0x33a)]&&(_0x50ecc7['detected']=!![],_0x50ecc7[_0x55801e(0x312)]=_0xfacafb?_0xfacafb[_0x55801e(0x33a)]:'',_0x50ecc7[_0x55801e(0x359)]=_0x3d4bda?_0x3d4bda[_0x55801e(0x33a)]:'',_0x50ecc7[_0x55801e(0x287)]=_0x5bd0d9?_0x5bd0d9[_0x55801e(0x33a)]:''),_0x50ecc7[_0x55801e(0x2c3)]=_0x590b8c?!!_0x590b8c[_0x55801e(0x33a)]:![];}catch(_0x4fe30c){}this[_0x55801e(0x204)](_0x498298[_0x55801e(0x3b5)],_0x498298[_0x55801e(0x24a)],{'success':!![],'eventHistory':this[_0x55801e(0x3ad)][_0x55801e(0x233)](0x0,0xf),'stats':{'digestCount':_0x223247,'eventCountToday':_0x58dd01,'hourlyActivity':_0x3e4567,'driftStatus':_0xfe7822[_0x55801e(0x38f)],'isPresent':this[_0x55801e(0x304)],'presenceWho':_0x318880,'minDays':this[_0x55801e(0x1ef)][_0x55801e(0x211)]||0x7,'stbDays':this[_0x55801e(0x1ef)][_0x55801e(0x2b1)]||0xe,'ltbDays':this[_0x55801e(0x1ef)]['ltmLtbWindowDays']||0x3c,'systemError':_0x18edcb},'automation':_0x50ecc7},_0x498298[_0x55801e(0x25e)]);}else{if(_0x498298[_0x55801e(0x24a)]==='getEnums'){const _0xc507a3=await this[_0x55801e(0x2cc)](_0x55801e(0x2a2),_0x55801e(0x30d)),_0x1cfd89=[];if(_0xc507a3)for(const _0x51bf0f in _0xc507a3){const _0x57931a=_0xc507a3[_0x51bf0f],_0x527477=(_0x57931a['common']&&typeof _0x57931a[_0x55801e(0x21b)][_0x55801e(0x36a)]===_0x55801e(0x246)?_0x57931a['common']['name']['de']:_0x57931a[_0x55801e(0x21b)][_0x55801e(0x36a)])||_0x57931a['common']['name'];_0x1cfd89[_0x55801e(0x314)]({'id':_0x51bf0f,'name':_0x527477});}this[_0x55801e(0x204)](_0x498298[_0x55801e(0x3b5)],_0x498298[_0x55801e(0x24a)],{'success':!![],'enums':_0x1cfd89},_0x498298[_0x55801e(0x25e)]);}else{if(_0x498298['command']===_0x55801e(0x399))try{const _0x40ce34=await scanForDevices(this,_0x498298['message']||{});this[_0x55801e(0x204)](_0x498298['from'],_0x498298[_0x55801e(0x24a)],{'success':!![],'devices':_0x40ce34},_0x498298[_0x55801e(0x25e)]);}catch(_0x59fa44){this[_0x55801e(0x204)](_0x498298['from'],_0x498298[_0x55801e(0x24a)],{'success':![],'error':_0x59fa44['message']},_0x498298['callback']);}else{if(_0x498298[_0x55801e(0x24a)]===_0x55801e(0x2a0)){const _0x2fa1b2=_0x498298[_0x55801e(0x1f0)]['instance'];if(!_0x2fa1b2)return this[_0x55801e(0x204)](_0x498298['from'],_0x498298[_0x55801e(0x24a)],{'success':![],'error':_0x55801e(0x3b2)},_0x498298[_0x55801e(0x25e)]);const _0x3ca049=await getCalendarNames(this,_0x2fa1b2);this['sendTo'](_0x498298['from'],_0x498298[_0x55801e(0x24a)],{'success':!![],'names':_0x3ca049},_0x498298[_0x55801e(0x25e)]);}else{if(_0x498298[_0x55801e(0x24a)]===_0x55801e(0x209)){const {targetId:_0x1052ac,targetValue:_0x50a7e9}=_0x498298['message'];this[_0x55801e(0x39c)][_0x55801e(0x322)](_0x55801e(0x2f9)+_0x1052ac+_0x55801e(0x3b8)+_0x50a7e9),await this['setStateAsync'](_0x55801e(0x392),{'val':!![],'ack':!![]}),await this[_0x55801e(0x30b)](_0x55801e(0x35a),{'val':_0x55801e(0x3a5)+_0x1052ac,'ack':!![]}),await this[_0x55801e(0x30b)](_0x55801e(0x23a),{'val':_0x1052ac,'ack':!![]}),await this[_0x55801e(0x30b)](_0x55801e(0x2d3),{'val':_0x50a7e9,'ack':!![]}),this[_0x55801e(0x204)](_0x498298[_0x55801e(0x3b5)],_0x498298[_0x55801e(0x24a)],{'success':!![]},_0x498298[_0x55801e(0x25e)]);}else{if(_0x498298[_0x55801e(0x24a)]===_0x55801e(0x396)){const {historyId:_0x179737,rating:_0x5c0a9f,comment:_0x4a9186,alertReason:_0x5b10b2}=_0x498298[_0x55801e(0x1f0)];_0x179737&&_0x5c0a9f?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x179737,'rating':_0x5c0a9f,'comment':_0x4a9186,'alertReason':_0x5b10b2}),this[_0x55801e(0x204)](_0x498298[_0x55801e(0x3b5)],_0x498298['command'],{'success':!![]},_0x498298['callback'])):this[_0x55801e(0x204)](_0x498298['from'],_0x498298[_0x55801e(0x24a)],{'success':![],'error':_0x55801e(0x391)},_0x498298[_0x55801e(0x25e)]);}else _0x498298[_0x55801e(0x24a)]===_0x55801e(0x28b)&&(this[_0x55801e(0x39c)]['info'](_0x55801e(0x333)),await this[_0x55801e(0x30b)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x55801e(0x30b)](_0x55801e(0x35a),{'val':'','ack':!![]}),this[_0x55801e(0x204)](_0x498298[_0x55801e(0x3b5)],_0x498298['command'],{'success':!![]},_0x498298['callback']));}}}}}}}}}catch(_0x18f1db){this['log'][_0x55801e(0x276)](_0x55801e(0x36d)+_0x498298['command']+':\x20'+_0x18f1db[_0x55801e(0x1f0)]);if(_0x498298['callback'])this['sendTo'](_0x498298[_0x55801e(0x3b5)],_0x498298[_0x55801e(0x24a)],{'success':![],'error':_0x18f1db[_0x55801e(0x1f0)]},_0x498298[_0x55801e(0x25e)]);}}}if(require[a0_0x3059de(0x1ea)]!==module)module[a0_0x3059de(0x2dc)]=_0x193afa=>new CogniLiving(_0x193afa);else new CogniLiving();