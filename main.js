const a0_0x416b61=a0_0x4439;(function(_0x15bfb5,_0x28efc9){const _0x2825f8=a0_0x4439,_0x3acb8e=_0x15bfb5();while(!![]){try{const _0x3fdcb0=parseInt(_0x2825f8(0x175))/0x1+-parseInt(_0x2825f8(0x197))/0x2*(parseInt(_0x2825f8(0x19c))/0x3)+parseInt(_0x2825f8(0x157))/0x4*(parseInt(_0x2825f8(0x195))/0x5)+parseInt(_0x2825f8(0x20b))/0x6+-parseInt(_0x2825f8(0xbd))/0x7+-parseInt(_0x2825f8(0x112))/0x8+-parseInt(_0x2825f8(0xa3))/0x9*(-parseInt(_0x2825f8(0xf1))/0xa);if(_0x3fdcb0===_0x28efc9)break;else _0x3acb8e['push'](_0x3acb8e['shift']());}catch(_0xc438cc){_0x3acb8e['push'](_0x3acb8e['shift']());}}}(a0_0x440c,0x6ff28));const a0_0x4901df=(function(){let _0x861dc=!![];return function(_0x11bcbf,_0x58d604){const _0x381e4e=_0x861dc?function(){if(_0x58d604){const _0x1927da=_0x58d604['apply'](_0x11bcbf,arguments);return _0x58d604=null,_0x1927da;}}:function(){};return _0x861dc=![],_0x381e4e;};}()),a0_0x2219b1=a0_0x4901df(this,function(){const _0x108a9f=a0_0x4439;return a0_0x2219b1[_0x108a9f(0x277)]()[_0x108a9f(0xbb)](_0x108a9f(0xb2))[_0x108a9f(0x277)]()['constructor'](a0_0x2219b1)['search'](_0x108a9f(0xb2));});a0_0x2219b1();'use strict';const utils=require(a0_0x416b61(0x1c1)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x416b61(0x235)),path=require(a0_0x416b61(0x82)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x416b61(0x148),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x416b61(0x236),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x416b61(0x270),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x416b61(0x1c0),LTM_DP_DRIFT_DETAILS=a0_0x416b61(0x163),LTM_DP_DRIFT_LAST_CHECK=a0_0x416b61(0x147),SYSTEM_DP_MODE=a0_0x416b61(0x282),HARD_IGNORE_TERMS=[a0_0x416b61(0x14c),a0_0x416b61(0x237),a0_0x416b61(0x1d7),'unreach','lowbat',a0_0x416b61(0xa9),a0_0x416b61(0x1ef),a0_0x416b61(0x7a),a0_0x416b61(0x26d),a0_0x416b61(0x246),a0_0x416b61(0xa7),a0_0x416b61(0x109),a0_0x416b61(0x234),a0_0x416b61(0x19e),a0_0x416b61(0xb5),a0_0x416b61(0x81),a0_0x416b61(0xf0),a0_0x416b61(0x150)],BAD_NAMES=[a0_0x416b61(0x193),a0_0x416b61(0x128),'state',a0_0x416b61(0x76),a0_0x416b61(0x159),a0_0x416b61(0x223),'on',a0_0x416b61(0x20c),'switch','position',a0_0x416b61(0x11e),a0_0x416b61(0x156),'cover','status','motion',a0_0x416b61(0x126),'occupancy','temperature',a0_0x416b61(0x1c5),a0_0x416b61(0x220),a0_0x416b61(0x1dc),a0_0x416b61(0x73),a0_0x416b61(0x16a),a0_0x416b61(0x17a),'set_temperature'],ADAPTER_BLACKLIST=['system.',a0_0x416b61(0x1f9),a0_0x416b61(0x1b1),a0_0x416b61(0x77),a0_0x416b61(0xac),a0_0x416b61(0x164),a0_0x416b61(0x155),'flot.','echarts.',a0_0x416b61(0x280),a0_0x416b61(0x13a)],SYSTEM_MODES={'NORMAL':a0_0x416b61(0x207),'VACATION':'vacation','PARTY':a0_0x416b61(0x92),'GUEST':a0_0x416b61(0x271)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x416b61(0x26c)]],PERSONA_MAPPING={'generic':a0_0x416b61(0x1cc),'senior_aal':a0_0x416b61(0x135),'family':a0_0x416b61(0x16f),'single_comfort':a0_0x416b61(0x1b5),'security':'PRIORITÃ„T:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x2136dd){const _0x5e9154=a0_0x416b61;try{const _0x12d5b9=[_0x5e9154(0x1e2),_0x5e9154(0xb3)];for(const _0x31256a of _0x12d5b9){try{const _0x206a23=await _0x2136dd[_0x5e9154(0x214)](_0x31256a);_0x206a23&&await _0x2136dd[_0x5e9154(0x10d)](_0x31256a);}catch(_0x363f72){}}}catch(_0x443971){}}async function initHistory(_0x5c6e05){const _0x33ae15=a0_0x416b61;try{const _0x2b61b2=await _0x5c6e05[_0x33ae15(0x194)](_0x33ae15(0x8e));_0x2b61b2&&_0x2b61b2[_0x33ae15(0x154)]&&(_0x5c6e05[_0x33ae15(0x123)]=JSON[_0x33ae15(0x250)](_0x2b61b2[_0x33ae15(0x154)]['toString']()));}catch(_0x2c3072){_0x5c6e05['eventHistory']=[];}try{const _0x52da69=await _0x5c6e05[_0x33ae15(0x194)](_0x33ae15(0x26b));if(_0x52da69&&_0x52da69[_0x33ae15(0x154)])_0x5c6e05[_0x33ae15(0x1a8)]=JSON[_0x33ae15(0x250)](_0x52da69[_0x33ae15(0x154)][_0x33ae15(0x277)]());}catch(_0x8a9ced){_0x5c6e05[_0x33ae15(0x1a8)]=[];}if(_0x5c6e05['eventHistory']&&_0x5c6e05[_0x33ae15(0x123)][_0x33ae15(0xc0)]>0x0){_0x5c6e05[_0x33ae15(0xb0)]['info'](_0x33ae15(0x21b)+_0x5c6e05[_0x33ae15(0x123)][_0x33ae15(0xc0)]+_0x33ae15(0x137));for(let _0x36f06d=_0x5c6e05['eventHistory'][_0x33ae15(0xc0)]-0x1;_0x36f06d>=0x0;_0x36f06d--){const _0x37ec65=_0x5c6e05[_0x33ae15(0x123)][_0x36f06d];_0x37ec65&&_0x37ec65['id']!==undefined&&_0x37ec65[_0x33ae15(0x159)]!==undefined&&(_0x5c6e05[_0x33ae15(0xd2)][_0x37ec65['id']]=_0x37ec65[_0x33ae15(0x159)]);}}}async function initSystemConfig(_0x31d0ca){const _0x530902=a0_0x416b61;try{const _0x36b2de=await _0x31d0ca[_0x530902(0x78)](_0x530902(0xf5));_0x36b2de&&_0x36b2de['common']&&(_0x31d0ca[_0x530902(0x1ee)]={'latitude':_0x36b2de[_0x530902(0x105)][_0x530902(0x16c)]||0x0,'longitude':_0x36b2de['common']['longitude']||0x0,'city':_0x36b2de[_0x530902(0x105)][_0x530902(0x19f)]||''});}catch(_0x530d7d){}}function a0_0x440c(){const _0xafcceb=['.\x0a\x20\x20\x20\x20ANWESENDE_GERAETE:\x20','LTM.driftAnalysis.lastCheck','0\x204\x20*\x20*\x20*','sensor','switch','Error\x20launching\x20Python\x20service:\x20','scriptProblem','getForeignStateAsync','Generating\x20Morning\x20Briefing...','payload','link_quality','number','Details:\x20','Reset\x20Sched\x20Error:\x20','val','icons-mfd.','blind','53940mRrONk','Last\x20Result','value','PARTY','notifyTelegramEnabled','telegram','unload','system.presenceWho','briefingJob','.\x20Welcome\x20home.','string','AI\x20Emergency\x20Status','LTM.driftAnalysis.driftDetails','material.','catch','getOverviewData','Activity\x20Summary','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','Adapter','valve','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','latitude','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','Briefing\x20Sched\x20Error:\x20','Fokus\x20auf\x20Familienroutinen.','getCalendarNames\x20Error:\x20','User\x20dismissed\x20automation\x20proposal.','notifyPushoverInstance','briefingTime','N/A','49773opPIrB','Drift\x20Status','Restlessness\x20Level','getGenerativeModel','Trigger\x20Briefing\x20(Test)','actual_temperature','slice','NORMAL','calendarInstance','motion','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','push','feedbackHistory','Action','AI\x20Alert\x20Status','extendObjectAsync','ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','[PYTHON\x20ERR]\x20','automationProposal','testApiKey','stateChange','devices','Alarm','\x22\x20--break-system-packages','Subscribing\x20to\x20','fenster','text','pop','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','targetposition','getStateAsync','155nJbwrQ','cogni-living\x20adapter\x20starting\x20(v','68QkVoTU','\x20(Length:\x20','isArray','json','communicate.request','38838KUmVnU','openweathermap','config_pending','city','contact','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','WETTER\x20ERROR:\x20','generic','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','detected','logDuplicates','location','analysisHistory','âœ…\x20Alles\x20OK\x20(Reset)','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','temp','Unknown','warn','Deaktiviert\x20(Pro-Feature)','unshift','boolean','info.','analysis.health.notes','message','LTM.trainingData.sequences','Fokus\x20auf\x20Komfort.','Auto\x20Apply\x20Rule','.\x0a\x20\x20\x20\x20WETTER:\x20','targetId','No\x20module\x20named','some','notifyTelegramRecipient','getCalendarNames','weatherunderground.0','Unbekannt','Error\x20checking\x20WiFi:\x20','LTM.driftAnalysis.baselineDrift','@iobroker/adapter-core','system.meta.uuid','analysis.automation.targetValue','status','humidity','simulateButler','...','modeResetJob','ltmStbWindowDays','subscribeStates','time','Analysiere\x20ausgewogen.','lastIndexOf','role','driftDetails','analysis.deviationFromBaseline','native','debug','health','Sending\x20notification:\x20\x22','\x20events','temperature','update','weatherunderground','livingContext','systemUUID','\x20presence\x20devices...','energy','kontakt','setObjectNotExistsAsync','dailyDigests','analysisInterval','briefingEnabled','analysis.history_debug_00','onUnload','COGNI_CONFIRM_OK','presenceDevices','instance','python_service','Failed\x20to\x20send\x20to\x20Python:\x20','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','\x20=\x20','triggerBriefing','join','LTM.trainingData.thermodynamics','systemConfig','connection','scanDevices','setState','Last\x20raw\x20event','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','analysisTimer','currentSystemMode','getEnums','onMessage','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','admin.','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','Missing\x20data','submitFeedback','kill','thermostat','retry','enum.functions.*','onReady','isPresent','info','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','scheduleJob','python3\x20-m\x20pip\x20install\x20-r\x20\x22','normal','from','licenseKey','useCalendar','218808NmLGSV','off','values','getLtmData','Trend\x20Diagnosis\x20(Python)','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','sendToAsync','Entry\x20detected\x20via\x20','none','getObjectAsync','.NextHours.Location_1.Day_1.current.symbol_desc','\x20sensors...','analysis.automation.targetId','data','âŒ\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20','notifyEmailInstance','Restoring\x20sensor\x20cache\x20from\x20history\x20(','KALENDER\x20ERROR:\x20','summary','daswetter.0','round','power','Cogni-Living','âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.','brightness','sound','setForeignStateAsync','tÃ¼r','ML-Libs\x20fehlen','version','bewegung','Kein\x20API\x20Key!','KALENDER:\x20Keine\x20relevanten\x20Termine','isGracePeriodActive','Gast','notifyPushoverEnabled','[TEST]\x20','Drift\x20Details','LTM\x20Sched\x20Error:\x20','geminiModel','notifyEmailRecipient','stick_unreach','child_process','LTM.dailyDigests','scriptEnabled','setStateAsync','[LOG]','analysis.isAlert','getFullYear','.Current.Temperature','split','Error\x20reading\x20outdoor\x20sensor\x20','send','âœ…\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','analysis.health.trendValue','stdin','stringify','KI-Modell\x20nicht\x20initialisiert','name','fault','object','baselineDrift','\x0aSTB:\x20','analysis.health.sleepScore','button','analysis.automation.triggerAction','accuweather','writable','LTM','parse','ltmLtbWindowDays','useWeather','Gemini\x20AI\x20initialized.','ready','Target\x20ID','licht','analysis.automation.patternDetected','.\x0a\x20\x20\x20\x20ANWESENHEITS_STATUS:\x20','Verbindung\x20erfolgreich!\x20Antwort:\x20','Guardian:\x20Sending\x20','custom','Target\x20Value','analysis.automation.autoApply','genAI','alertReason','response','getDate','type','toFixed','requirements.txt','exitGraceTimer','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','isProVersion','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','dependencyInstallInProgress','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','analysis.analysisHistory','GUEST','error','fill','System\x20Mode','LTM.baselineStatus','guest','includes','\x20*\x20*\x20*','expire','ANALYZE_TREND','toLowerCase','toString','.data.table','inactivityMonitoringEnabled','analysis.comfortSummary','LTM.trainingData','_score','Pattern\x20Detected','cancel','system','javascript.','notifyTelegramInstance','system.mode','_calName','setHours','isExit','setpoint','Kalender:\x20Deaktiviert','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','level','vis.','getForeignObjectAsync','TREND_RESULT','maintenance','ltmDriftCheckIntervalHours','weatherInstance','schalter','Raw\x20Log','Automation\x20Proposals','Kein\x20API\x20Key\x20eingegeben.','firmware','path','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','âŒ\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.','driftAnalysisTimer','Training\x20Data\x20Sets','Deviation','application/json','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','occupancy','command','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','klima','events.history','window','bind','map','party','online','analysis.isEmergency','Error:\x20','Drift\x20Analysis','splice','uuid','Urlaub','âš ï¸\x20ALARM:\x20','Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip','[PYTHON]\x20','.forecast.current.temp','Trigger\x20Action\x20Now','No\x20module\x20named\x20pip','Error\x20in\x20onMessage\x20command\x20','selectedFunctionIds','getTime','9xQwirZ','\x20for\x20interactive\x20buttons...','config','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','working','Keiner','rssi','minDaysForBaseline','lastAlertState','history.','analysis.trigger','description','analysis.health.trendDiagnosis','log','Comfort\x20Summary','(((.+)+)+)+$','events.history_debug_00','ðŸ“¡\x20Hooking\x20into\x20','dutycycle','system.isPresent','state','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','.Summary.Current','search','dimmer','1875832pLiUnG','aiPersona','Aktiv\x20(','length','âœ…\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','pythonProcess','Feedback\x20Log','automation.triggerAction','\x20days\x20of\x20activity\x20data\x20to\x20Python...','lights','.\x20DATEN:\x20Schlaf\x20','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','Health\x20&\x20Sleep\x20Analysis','Normal','Baseline\x20Status','enum','replace','testNotification','isAlert','):\x20','text.alarm','sensorLastValues','trim','generateContent','Wetter:\x20Deaktiviert','.forecast.current.state','subscribeForeignStatesAsync','sort','\x20(Value:\x20','event','Skipped\x20(No\x20AI\x20or\x20Data)','ical.0','analysis.feedbackHistory',').\x20Starting\x20Timer.','exitTimer','channel','find','Alert\x20Reason','members','details','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','main','VACATION','geminiApiKey','Anwesend','analysis.automation.description','Feedback\x20saved:\x20','events.lastEvent','PONG','COGNI_REQUEST_CALL','reachable','10342490fSCrjr','daswetter','sendTo','Thermodynamic\x20Data\x20Points','system.config','unknown','ðŸŒ…\x20Daily\x20Briefing:\x0a','Logbook','now','timestamp','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','startsWith','Started\x20at\x20','getForeignObjectsAsync','lastCheck','Fehler:\x20','WETTER:\x20','\x20hours.\x20Potential\x20incapacitation.','N/A\x20(Learning)','light','common','getHours','ABWESEND','outdoorSensorId','direction','shift','substring','isEmergency','delObjectAsync','ack','forEach','dismissAutomation','lampe','2974792rjPJbU','\x20|\x20','Could\x20not\x20kill\x20Python\x20process:\x20','\x27\x20not\x20in\x20allowed\x20list)','loc','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','inactivityThresholdHours','callback','endsWith','Last\x20Check','Who\x20is\x20present?','shutter','rawEventLog','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','analysis.activitySummary','stderr','eventHistory','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','prÃ¤senz','presence','analysis.health.restlessness','currentposition','\x22\x20--break-system-packages\x20--user','indicator.alarm','stdout','door','indicator','indexOf','activityLevel','toISOString','Lernphase\x20(','WETTER:\x20Keine\x20Daten\x20gefunden','filter','apiKey','PRIORITÃ„T:\x20Gesundheit/AAL.','analysis.triggerBriefing','\x20events)...','date','analysis.automation','simple-api.','rollladen','KALENDER:\x20','KALENDER:\x20Keine\x20Daten','Event\x20History','TEST-PRO-KEY','analysis.comfortSuggestion','analysis.alertReason','heizung','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','analysis.automation.suggestedAction','ltmJob'];a0_0x440c=function(){return _0xafcceb;};return a0_0x440c();}async function checkLicense(_0x2456b0,_0x57b102){const _0x3763fc=a0_0x416b61;if(!_0x57b102)return![];_0x2456b0['systemUUID']=await getSystemUUID(_0x2456b0);if(_0x57b102===_0x3763fc(0x13f)||_0x57b102['startsWith']('PRO-'))return!![];return![];}async function getSystemUUID(_0x5a18cd){const _0x383f90=a0_0x416b61;try{const _0x209f86=await _0x5a18cd[_0x383f90(0x78)](_0x383f90(0x1c2));if(_0x209f86&&_0x209f86[_0x383f90(0x1d1)]&&_0x209f86[_0x383f90(0x1d1)]['uuid'])return _0x209f86['native'][_0x383f90(0x98)];return'uuid-not-found';}catch(_0x15331e){return'uuid-error';}}async function createAllObjects(_0x2d4b9a){const _0x59783f=a0_0x416b61;await checkSystemObjects(_0x2d4b9a),await _0x2d4b9a[_0x59783f(0x1de)]('system.presenceWho',{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x11d),'type':_0x59783f(0x161),'role':_0x59783f(0x190),'read':!![],'write':![],'def':''},'native':{}}),await _0x2d4b9a['setObjectNotExistsAsync'](_0x59783f(0xed),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x1f2),'type':_0x59783f(0x161),'role':'json','read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)]('events.history',{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x13e),'type':_0x59783f(0x161),'role':_0x59783f(0x19a),'read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0xad),{'type':_0x59783f(0xb7),'common':{'name':'Trigger\x20Analysis','type':_0x59783f(0x1b0),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x2d4b9a['setObjectNotExistsAsync'](_0x59783f(0x136),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x179),'type':_0x59783f(0x1b0),'role':_0x59783f(0x24b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)]('analysis.lastResult',{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x158),'type':_0x59783f(0x161),'role':'json','read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x23a),{'type':'state','common':{'name':_0x59783f(0x183),'type':_0x59783f(0x1b0),'role':_0x59783f(0x12a),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x94),{'type':'state','common':{'name':_0x59783f(0x162),'type':_0x59783f(0x1b0),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x141),{'type':'state','common':{'name':_0x59783f(0xe2),'type':_0x59783f(0x161),'role':_0x59783f(0xd1),'read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x121),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x167),'type':_0x59783f(0x161),'role':_0x59783f(0x190),'read':!![],'write':![]},'native':{}}),await _0x2d4b9a['setObjectNotExistsAsync'](_0x59783f(0x1d0),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x87),'type':_0x59783f(0x161),'role':'state','read':!![],'write':![],'def':_0x59783f(0x174)},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x27a),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0xb1),'type':_0x59783f(0x161),'role':'text','read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x140),{'type':'state','common':{'name':'Comfort\x20Suggestion','type':_0x59783f(0x161),'role':'text','read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x184)](_0x59783f(0x139),{'type':_0x59783f(0xe0),'common':{'name':_0x59783f(0x7f)},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x257),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x27d),'type':_0x59783f(0x1b0),'role':_0x59783f(0x12d),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0xeb),{'type':_0x59783f(0xb7),'common':{'name':'Description','type':'string','role':_0x59783f(0x190),'read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x144),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x182),'type':'string','role':_0x59783f(0x190),'read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x217),{'type':'state','common':{'name':_0x59783f(0x255),'type':_0x59783f(0x161),'role':_0x59783f(0x190),'read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x1c3),{'type':'state','common':{'name':_0x59783f(0x25c),'type':_0x59783f(0x161),'role':_0x59783f(0x190),'read':!![],'write':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x25d),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x1b6),'type':'boolean','role':_0x59783f(0x14a),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x24c),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x9e),'type':'boolean','role':_0x59783f(0x24b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x26b),{'type':'state','common':{'name':_0x59783f(0xf8),'type':_0x59783f(0x161),'role':_0x59783f(0x19a),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0xdd),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0xc3),'type':_0x59783f(0x161),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2d4b9a[_0x59783f(0x184)]('analysis.health',{'type':_0x59783f(0xe0),'common':{'name':_0x59783f(0xc9)},'native':{}}),await _0x2d4b9a['setObjectNotExistsAsync'](_0x59783f(0x24a),{'type':_0x59783f(0xb7),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x59783f(0x151),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x127),{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x177),'type':_0x59783f(0x161),'role':_0x59783f(0x190),'read':!![],'write':![],'def':_0x59783f(0x213)},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x1b2),{'type':_0x59783f(0xb7),'common':{'name':'Health\x20Notes','type':_0x59783f(0x161),'role':_0x59783f(0x190),'read':!![],'write':![],'def':''},'native':{}}),await _0x2d4b9a['setObjectNotExistsAsync']('analysis.health.trendDiagnosis',{'type':_0x59783f(0xb7),'common':{'name':_0x59783f(0x20f),'type':_0x59783f(0x161),'role':_0x59783f(0x190),'read':!![],'write':![],'def':_0x59783f(0x174)},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x241),{'type':_0x59783f(0xb7),'common':{'name':'Trend\x20Value\x20(%)','type':_0x59783f(0x151),'role':_0x59783f(0x159),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x2d4b9a['extendObjectAsync'](_0x59783f(0x27b),{'type':'channel','common':{'name':_0x59783f(0x86)},'native':{}}),await _0x2d4b9a[_0x59783f(0x1de)](_0x59783f(0x1b4),{'type':'state','common':{'name':'Recorded\x20Motion\x20Sequences','type':_0x59783f(0x161),'role':_0x59783f(0x19a),'read':!![],'write':![],'def':'[]','desc':_0x59783f(0x83)},'native':{}}),await _0x2d4b9a['setObjectNotExistsAsync']('LTM.trainingData.thermodynamics',{'type':'state','common':{'name':_0x59783f(0xf4),'type':_0x59783f(0x161),'role':_0x59783f(0x19a),'read':!![],'write':![],'def':'[]','desc':_0x59783f(0x1f8)},'native':{}}),await checkLtmObjects(_0x2d4b9a),await checkLtmDriftObjects(_0x2d4b9a);}async function checkSystemObjects(_0x2e4ace){const _0x2fb08c=a0_0x416b61;await _0x2e4ace[_0x2fb08c(0x184)](_0x2fb08c(0x27f),{'type':_0x2fb08c(0xe0),'common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0x2e4ace[_0x2fb08c(0x184)](SYSTEM_DP_MODE,{'type':_0x2fb08c(0xb7),'common':{'name':_0x2fb08c(0x26f),'type':_0x2fb08c(0x161),'role':_0x2fb08c(0xb7),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x2fb08c(0x17c)],'states':{[SYSTEM_MODES[_0x2fb08c(0x17c)]]:_0x2fb08c(0xca),[SYSTEM_MODES[_0x2fb08c(0xe8)]]:_0x2fb08c(0x99),[SYSTEM_MODES[_0x2fb08c(0x15a)]]:'Party',[SYSTEM_MODES[_0x2fb08c(0x26c)]]:_0x2fb08c(0x22d)}},'native':{}});}async function checkLtmObjects(_0x165c13){const _0x976594=a0_0x416b61;await _0x165c13['extendObjectAsync'](_0x976594(0x24f),{'type':_0x976594(0xe0),'common':{'name':_0x976594(0x24f)},'native':{}}),await _0x165c13['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x976594(0xb7),'common':{'name':_0x976594(0x7e),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x165c13['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x976594(0xb7),'common':{'name':'Daily\x20Digests','type':_0x976594(0x161),'role':'json','read':!![],'write':![]},'native':{}}),await _0x165c13['extendObjectAsync'](LTM_DP_STATUS,{'type':'state','common':{'name':'Processing\x20Status','type':_0x976594(0x161),'role':'text','read':!![],'write':![]},'native':{}}),await _0x165c13['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x976594(0xb7),'common':{'name':'Trigger\x20Digest','type':_0x976594(0x1b0),'role':_0x976594(0x24b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x165c13[_0x976594(0x184)](LTM_DP_BASELINE_STATUS,{'type':_0x976594(0xb7),'common':{'name':_0x976594(0xcb),'type':'string','role':_0x976594(0x190),'read':!![],'write':![]},'native':{}});}function a0_0x4439(_0x559241,_0x346aa9){const _0x15ef33=a0_0x440c();return a0_0x4439=function(_0x2219b1,_0x4901df){_0x2219b1=_0x2219b1-0x71;let _0x440c70=_0x15ef33[_0x2219b1];return _0x440c70;},a0_0x4439(_0x559241,_0x346aa9);}async function checkLtmDriftObjects(_0x449b61){const _0x3b9152=a0_0x416b61;await _0x449b61['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x3b9152(0xe0),'common':{'name':_0x3b9152(0x96)},'native':{}}),await _0x449b61['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x3b9152(0xb7),'common':{'name':_0x3b9152(0x176),'type':_0x3b9152(0x161),'role':_0x3b9152(0xb7),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x449b61[_0x3b9152(0x184)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x3b9152(0x230),'type':_0x3b9152(0x161),'role':'text','read':!![],'write':![]},'native':{}}),await _0x449b61[_0x3b9152(0x184)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x3b9152(0xb7),'common':{'name':_0x3b9152(0x11c),'type':_0x3b9152(0x151),'role':_0x3b9152(0x138),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x11f93f){const _0x50b735=a0_0x416b61;try{const _0x5d0750=await _0x11f93f[_0x50b735(0x194)](SYSTEM_DP_MODE);_0x5d0750&&_0x5d0750[_0x50b735(0x154)]&&Object[_0x50b735(0x20d)](SYSTEM_MODES)[_0x50b735(0x272)](_0x5d0750[_0x50b735(0x154)])?_0x11f93f[_0x50b735(0x1f5)]=_0x5d0750[_0x50b735(0x154)]:(_0x11f93f['currentSystemMode']=SYSTEM_MODES[_0x50b735(0x17c)],await _0x11f93f[_0x50b735(0x238)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x50b735(0x17c)],'ack':!![]}));}catch(_0x3cf675){_0x11f93f[_0x50b735(0x1f5)]=SYSTEM_MODES[_0x50b735(0x17c)];}}async function loadRawEventLog(_0x2322ee){const _0x5120c4=a0_0x416b61;try{const _0x1cb1bd=await _0x2322ee[_0x5120c4(0x194)](LTM_DP_RAW_LOG);if(_0x1cb1bd&&_0x1cb1bd[_0x5120c4(0x154)])_0x2322ee[_0x5120c4(0x11f)]=JSON[_0x5120c4(0x250)](_0x1cb1bd['val']);}catch(_0x26a2db){_0x2322ee[_0x5120c4(0x11f)]=[];}}async function saveRawEventLog(_0x4ed996){const _0x31a4a6=a0_0x416b61;_0x4ed996[_0x31a4a6(0x11f)][_0x31a4a6(0xc0)]>RAW_LOG_MAX_SIZE&&_0x4ed996[_0x31a4a6(0x11f)]['splice'](0x0,_0x4ed996['rawEventLog']['length']-RAW_LOG_MAX_SIZE),await _0x4ed996[_0x31a4a6(0x238)](LTM_DP_RAW_LOG,{'val':JSON[_0x31a4a6(0x243)](_0x4ed996[_0x31a4a6(0x11f)]),'ack':!![]});}async function loadDailyDigests(_0x1a76e6){const _0x24752e=a0_0x416b61;try{const _0x4bbf8e=await _0x1a76e6['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x4bbf8e&&_0x4bbf8e[_0x24752e(0x154)])_0x1a76e6['dailyDigests']=JSON[_0x24752e(0x250)](_0x4bbf8e[_0x24752e(0x154)]);}catch(_0x3d4073){_0x1a76e6[_0x24752e(0x1df)]=[];}await updateBaselineStatus(_0x1a76e6);}async function saveDailyDigests(_0x1a7772,_0x35e62f=!![]){const _0x1b7413=a0_0x416b61,_0x26f06d=_0x1a7772[_0x1b7413(0xa5)][_0x1b7413(0x251)]||0x3c;_0x1a7772['dailyDigests'][_0x1b7413(0xc0)]>_0x26f06d&&_0x1a7772[_0x1b7413(0x1df)][_0x1b7413(0x97)](0x0,_0x1a7772[_0x1b7413(0x1df)][_0x1b7413(0xc0)]-_0x26f06d);await _0x1a7772[_0x1b7413(0x238)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x1a7772[_0x1b7413(0x1df)]),'ack':!![]});if(_0x35e62f)await updateBaselineStatus(_0x1a7772);}async function updateAnalysisHistory(_0x1759c2,_0x1f0dc8){const _0x2557df=a0_0x416b61;_0x1759c2[_0x2557df(0x1a8)][_0x2557df(0x1af)](_0x1f0dc8);if(_0x1759c2['analysisHistory'][_0x2557df(0xc0)]>ANALYSIS_HISTORY_MAX_SIZE)_0x1759c2[_0x2557df(0x1a8)]['pop']();await _0x1759c2[_0x2557df(0x238)](_0x2557df(0x26b),{'val':JSON['stringify'](_0x1759c2[_0x2557df(0x1a8)]),'ack':!![]});}async function updateBaselineStatus(_0x1f2eb1){const _0x18cd29=a0_0x416b61;if(!_0x1f2eb1[_0x18cd29(0x267)]){await _0x1f2eb1['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x18cd29(0x1ae),'ack':!![]});return;}const _0xa9b6e3=_0x1f2eb1[_0x18cd29(0x1df)]['length']>=(_0x1f2eb1[_0x18cd29(0xa5)][_0x18cd29(0xaa)]||0x7)?_0x18cd29(0xbf)+_0x1f2eb1['dailyDigests'][_0x18cd29(0xc0)]+'\x20Tage)':_0x18cd29(0x131)+_0x1f2eb1[_0x18cd29(0x1df)]['length']+'/'+(_0x1f2eb1[_0x18cd29(0xa5)]['minDaysForBaseline']||0x7)+')';await _0x1f2eb1[_0x18cd29(0x238)](LTM_DP_BASELINE_STATUS,{'val':_0xa9b6e3,'ack':!![]});}async function initSensorSubscriptions(_0x29196d){const _0x4941f2=a0_0x416b61,_0x44c3c1=_0x29196d[_0x4941f2(0xa5)]['devices'];if(_0x44c3c1&&_0x44c3c1[_0x4941f2(0xc0)]>0x0){_0x29196d[_0x4941f2(0xb0)][_0x4941f2(0x203)](_0x4941f2(0x18e)+_0x44c3c1[_0x4941f2(0xc0)]+_0x4941f2(0x216));for(const _0x521370 of _0x44c3c1){if(_0x521370['id']){await _0x29196d[_0x4941f2(0xd7)](_0x521370['id']);try{const _0x340aec=await _0x29196d[_0x4941f2(0x14d)](_0x521370['id']);if(_0x340aec)_0x29196d[_0x4941f2(0xd2)][_0x521370['id']]=_0x340aec[_0x4941f2(0x154)];}catch(_0x28e503){}}}}}async function initPresenceSubscriptions(_0x2d74f0){const _0x37f2c=a0_0x416b61,_0x20a5b7=_0x2d74f0['config'][_0x37f2c(0x1e5)]||[];if(_0x20a5b7[_0x37f2c(0xc0)]>0x0){_0x2d74f0[_0x37f2c(0xb0)][_0x37f2c(0x203)](_0x37f2c(0x18e)+_0x20a5b7[_0x37f2c(0xc0)]+_0x37f2c(0x1db));for(const _0x150b31 of _0x20a5b7){await _0x2d74f0[_0x37f2c(0xd7)](_0x150b31);}try{await checkWifiPresence(_0x2d74f0);}catch(_0x8ed8a3){}}}async function getWeatherContext(_0x29cf10){const _0x3d0e60=a0_0x416b61;try{if(!_0x29cf10[_0x3d0e60(0xa5)][_0x3d0e60(0x252)])return _0x3d0e60(0xd5);let _0x188bce='';const _0x39592e=_0x29cf10[_0x3d0e60(0xa5)][_0x3d0e60(0x7c)];if(_0x39592e)try{if(_0x39592e[_0x3d0e60(0x272)](_0x3d0e60(0x24d))){const _0x564878=await _0x29cf10[_0x3d0e60(0x14d)](_0x39592e+_0x3d0e60(0xba));if(_0x564878&&_0x564878['val'])_0x188bce=_0x564878[_0x3d0e60(0x154)];}else{if(_0x39592e[_0x3d0e60(0x272)](_0x3d0e60(0xf2))){const _0x587b77=await _0x29cf10[_0x3d0e60(0x14d)](_0x39592e+_0x3d0e60(0x215));if(_0x587b77&&_0x587b77[_0x3d0e60(0x154)])_0x188bce=_0x587b77[_0x3d0e60(0x154)];}else{if(_0x39592e[_0x3d0e60(0x272)](_0x3d0e60(0x19d))){const _0xf298ea=await _0x29cf10[_0x3d0e60(0x14d)](_0x39592e+_0x3d0e60(0xd6));if(_0xf298ea&&_0xf298ea[_0x3d0e60(0x154)])_0x188bce=_0xf298ea[_0x3d0e60(0x154)];}}}}catch(_0x530d12){}if(!_0x188bce){const _0x41658c=['accuweather.0',_0x3d0e60(0x21e),_0x3d0e60(0x1bd),'openweathermap.0'];for(const _0x50782d of _0x41658c){try{const _0x4ef4db=await _0x29cf10['getForeignObjectAsync'](_0x50782d);if(_0x4ef4db){if(_0x50782d[_0x3d0e60(0x272)](_0x3d0e60(0x24d))){const _0x2d05a9=await _0x29cf10['getForeignStateAsync'](_0x50782d+'.Summary.Current');if(_0x2d05a9&&_0x2d05a9['val']){_0x188bce=_0x2d05a9[_0x3d0e60(0x154)];break;}}}}catch(_0xfb8c9d){}}}return _0x188bce?_0x3d0e60(0x101)+_0x188bce:_0x3d0e60(0x132);}catch(_0x3f20fd){return _0x3d0e60(0x1a2)+_0x3f20fd[_0x3d0e60(0x1b3)];}}async function getCalendarContext(_0x3961bb){const _0x4ec88a=a0_0x416b61;try{if(!_0x3961bb[_0x4ec88a(0xa5)][_0x4ec88a(0x20a)])return _0x4ec88a(0x74);let _0x3d3b9b=_0x3961bb[_0x4ec88a(0xa5)][_0x4ec88a(0x17d)]||_0x4ec88a(0xdc),_0xa2caef=_0x3961bb[_0x4ec88a(0xa5)]['calendarSelection']||[];if(typeof _0xa2caef===_0x4ec88a(0x161))_0xa2caef=_0xa2caef['split'](',');try{const _0x39e4c0=await _0x3961bb['getForeignStateAsync'](_0x3d3b9b+'.data.table');if(_0x39e4c0&&_0x39e4c0['val']){let _0x30fc79=tryParse(_0x39e4c0[_0x4ec88a(0x154)]);if(_0x30fc79&&Array[_0x4ec88a(0x199)](_0x30fc79)){if(_0xa2caef['length']>0x0)_0x30fc79=_0x30fc79['filter'](_0x23861d=>_0xa2caef[_0x4ec88a(0x272)](_0x23861d[_0x4ec88a(0x283)]||''));else return _0x4ec88a(0x168);if(_0x30fc79[_0x4ec88a(0xc0)]>0x0){const _0x1f1602=_0x30fc79[_0x4ec88a(0x17b)](0x0,0x3)[_0x4ec88a(0x91)](_0x2197b0=>{const _0x357c33=_0x4ec88a;let _0x3d495c=_0x2197b0[_0x357c33(0x138)];if(_0x2197b0[_0x357c33(0x1cb)])_0x3d495c+='\x20'+_0x2197b0['time'];return _0x3d495c+':\x20'+_0x2197b0[_0x357c33(0xda)]+'\x20('+_0x2197b0[_0x357c33(0x283)]+')';});return _0x4ec88a(0x13c)+_0x1f1602[_0x4ec88a(0x1ec)](_0x4ec88a(0x113));}else return _0x4ec88a(0x22b);}}}catch(_0x31be75){_0x3961bb[_0x4ec88a(0xb0)][_0x4ec88a(0x1ad)]('Error\x20reading\x20calendar\x20table:\x20'+_0x31be75['message']);}return _0x4ec88a(0x13d);}catch(_0x7bc4fb){return _0x4ec88a(0x21c)+_0x7bc4fb[_0x4ec88a(0x1b3)];}}async function getCalendarNames(_0xe9e73e,_0x190002){const _0x2a7667=a0_0x416b61;try{const _0x5ad33c=await _0xe9e73e[_0x2a7667(0x14d)](_0x190002+_0x2a7667(0x278));if(_0x5ad33c&&_0x5ad33c[_0x2a7667(0x154)]){const _0x2b2554=tryParse(_0x5ad33c[_0x2a7667(0x154)]);if(_0x2b2554&&Array[_0x2a7667(0x199)](_0x2b2554)){const _0x1ab263=[...new Set(_0x2b2554[_0x2a7667(0x91)](_0x3188e6=>_0x3188e6[_0x2a7667(0x283)])[_0x2a7667(0x133)](Boolean))];return _0x1ab263[_0x2a7667(0xd8)]();}}return[];}catch(_0x582a9b){return _0xe9e73e[_0x2a7667(0xb0)][_0x2a7667(0x26d)](_0x2a7667(0x170)+_0x582a9b[_0x2a7667(0x1b3)]),[];}}async function checkWifiPresence(_0x4bc8f6){const _0x1e6446=a0_0x416b61;try{const _0x2876ea=_0x4bc8f6[_0x1e6446(0xa5)]['presenceDevices']||[];let _0x1a59a8=![];const _0x59f062=[];for(const _0x240f7d of _0x2876ea){try{const _0xba329d=await _0x4bc8f6[_0x1e6446(0x14d)](_0x240f7d);if(_0xba329d&&(_0xba329d['val']===!![]||_0xba329d[_0x1e6446(0x154)]===_0x1e6446(0x93)||_0xba329d['val']===0x1)){_0x1a59a8=!![];const _0x3196a5=await _0x4bc8f6[_0x1e6446(0x78)](_0x240f7d);let _0x5cff38=_0x240f7d;_0x3196a5&&_0x3196a5[_0x1e6446(0x105)]&&_0x3196a5[_0x1e6446(0x105)][_0x1e6446(0x245)]&&(_0x5cff38=typeof _0x3196a5[_0x1e6446(0x105)][_0x1e6446(0x245)]==='object'?_0x3196a5[_0x1e6446(0x105)]['name']['de']||_0x3196a5[_0x1e6446(0x105)]['name']['en']:_0x3196a5[_0x1e6446(0x105)]['name']),_0x59f062[_0x1e6446(0x180)](_0x5cff38);}}catch(_0x540e82){}}return await _0x4bc8f6[_0x1e6446(0x238)](_0x1e6446(0x15e),{'val':_0x59f062[_0x1e6446(0x1ec)](',\x20'),'ack':!![]}),_0x1a59a8&&(_0x4bc8f6[_0x1e6446(0xdf)]&&(_0x4bc8f6[_0x1e6446(0xb0)]['info'](_0x1e6446(0x143)),abortExitTimer(_0x4bc8f6)),!_0x4bc8f6[_0x1e6446(0x202)]&&_0x4bc8f6[_0x1e6446(0x1f5)]===SYSTEM_MODES[_0x1e6446(0x17c)]&&await setPresence(_0x4bc8f6,!![])),_0x1a59a8;}catch(_0x5669b3){return _0x4bc8f6[_0x1e6446(0xb0)]['error'](_0x1e6446(0x1bf)+_0x5669b3[_0x1e6446(0x1b3)]),![];}}function startExitTimer(_0x51b16a){const _0x59941a=a0_0x416b61;abortExitTimer(_0x51b16a),_0x51b16a[_0x59941a(0x22c)]=!![],_0x51b16a[_0x59941a(0x265)]=setTimeout(()=>{_0x51b16a['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x51b16a[_0x59941a(0xdf)]=setTimeout(()=>{const _0x58bc74=_0x59941a;setPresence(_0x51b16a,![]),_0x51b16a[_0x58bc74(0xdf)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x468807){const _0x5530bf=a0_0x416b61;if(_0x468807['exitTimer'])clearTimeout(_0x468807[_0x5530bf(0xdf)]);if(_0x468807[_0x5530bf(0x265)])clearTimeout(_0x468807[_0x5530bf(0x265)]);_0x468807[_0x5530bf(0xdf)]=null,_0x468807[_0x5530bf(0x265)]=null,_0x468807[_0x5530bf(0x22c)]=![];}async function setPresence(_0x9c3c4,_0x39ffc4){const _0x3971be=a0_0x416b61;if(_0x9c3c4[_0x3971be(0x202)]===_0x39ffc4)return;_0x9c3c4[_0x3971be(0x202)]=_0x39ffc4,await _0x9c3c4['setStateAsync'](_0x3971be(0xb6),{'val':_0x39ffc4,'ack':!![]});}async function saveFeedback(_0x47e536,_0x176b96){const _0x1670e0=a0_0x416b61;_0x47e536[_0x1670e0(0xb0)][_0x1670e0(0x203)](_0x1670e0(0xec)+JSON[_0x1670e0(0x243)](_0x176b96));}async function runBaselineDriftAnalysis(_0x412c45){const _0x554cc7=a0_0x416b61;if(!_0x412c45[_0x554cc7(0x267)]||!_0x412c45['geminiModel'])return;const _0x304441=_0x412c45[_0x554cc7(0xa5)][_0x554cc7(0x1c9)]||0xe;if(_0x412c45[_0x554cc7(0x1df)][_0x554cc7(0xc0)]<_0x304441+(_0x412c45[_0x554cc7(0xa5)][_0x554cc7(0xaa)]||0x7)){await _0x412c45[_0x554cc7(0x238)](LTM_DP_DRIFT_STATUS,{'val':_0x554cc7(0x103),'ack':!![]});return;}const _0x383e63=_0x412c45[_0x554cc7(0x1df)]['slice'](-_0x304441),_0x2a922f=_0x412c45[_0x554cc7(0x1df)]['slice'](0x0,_0x412c45[_0x554cc7(0x1df)]['length']-_0x304441),_0x2dc1dc='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x554cc7(0x243)](_0x2a922f)+_0x554cc7(0x249)+JSON[_0x554cc7(0x243)](_0x383e63);try{const _0x1edf8a=await _0x412c45['geminiModel'][_0x554cc7(0xd4)](_0x2dc1dc),_0x51c629=JSON['parse'](_0x1edf8a[_0x554cc7(0x260)][_0x554cc7(0x190)]()[_0x554cc7(0xcd)](/```json|```/g,'')['trim']());_0x51c629[_0x554cc7(0x248)]&&(await _0x412c45[_0x554cc7(0x238)](LTM_DP_DRIFT_STATUS,{'val':_0x51c629[_0x554cc7(0x248)],'ack':!![]}),await _0x412c45[_0x554cc7(0x238)](LTM_DP_DRIFT_DETAILS,{'val':_0x51c629[_0x554cc7(0x1cf)],'ack':!![]}),await _0x412c45[_0x554cc7(0x238)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x1214b5){}}function setupLtmScheduler(_0x2590be){const _0x3ff6fb=a0_0x416b61;try{if(_0x2590be[_0x3ff6fb(0x145)])_0x2590be[_0x3ff6fb(0x145)]['cancel']();if(!_0x2590be['isProVersion']){_0x2590be[_0x3ff6fb(0x238)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x2590be[_0x3ff6fb(0x145)]=schedule[_0x3ff6fb(0x205)](LTM_SCHEDULE,()=>createDailyDigest(_0x2590be));}catch(_0x541e85){_0x2590be[_0x3ff6fb(0xb0)]['error'](_0x3ff6fb(0x231)+_0x541e85[_0x3ff6fb(0x1b3)]);}}function setupModeResetScheduler(_0x3b51e0){const _0x3058c5=a0_0x416b61;try{if(_0x3b51e0[_0x3058c5(0x1c8)])_0x3b51e0['modeResetJob'][_0x3058c5(0x27e)]();_0x3b51e0[_0x3058c5(0x1c8)]=schedule[_0x3058c5(0x205)](MODE_RESET_SCHEDULE,async()=>{const _0x1153ff=_0x3058c5;await loadSystemMode(_0x3b51e0),AUTO_RESET_MODES[_0x1153ff(0x272)](_0x3b51e0[_0x1153ff(0x1f5)])&&await _0x3b51e0[_0x1153ff(0x238)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1153ff(0x17c)],'ack':![]});});}catch(_0x342092){_0x3b51e0[_0x3058c5(0xb0)]['error'](_0x3058c5(0x153)+_0x342092['message']);}}function setupDriftAnalysisScheduler(_0x3b017d){const _0x2b5a8c=a0_0x416b61;try{if(_0x3b017d[_0x2b5a8c(0x85)])clearInterval(_0x3b017d[_0x2b5a8c(0x85)]);if(!_0x3b017d[_0x2b5a8c(0x267)])return;_0x3b017d[_0x2b5a8c(0x85)]=setInterval(()=>runBaselineDriftAnalysis(_0x3b017d),(_0x3b017d[_0x2b5a8c(0xa5)][_0x2b5a8c(0x7b)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3b017d),0x1388);}catch(_0x1a327e){_0x3b017d[_0x2b5a8c(0xb0)][_0x2b5a8c(0x26d)]('Drift\x20Sched\x20Error:\x20'+_0x1a327e[_0x2b5a8c(0x1b3)]);}}function setupBriefingScheduler(_0x8190a8){const _0x4265f5=a0_0x416b61;try{if(_0x8190a8['briefingJob'])_0x8190a8['briefingJob'][_0x4265f5(0x27e)]();if(!_0x8190a8[_0x4265f5(0xa5)][_0x4265f5(0x1e1)])return;const _0x3c86e3=(_0x8190a8['config'][_0x4265f5(0x173)]||'08:00')[_0x4265f5(0x23d)](':'),_0x2a5fa9=parseInt(_0x3c86e3[0x0])||0x8,_0x5423d7=parseInt(_0x3c86e3[0x1])||0x0,_0x572a45=_0x5423d7+'\x20'+_0x2a5fa9+_0x4265f5(0x273);_0x8190a8[_0x4265f5(0xb0)][_0x4265f5(0x203)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x2a5fa9+':'+(_0x5423d7<0xa?'0'+_0x5423d7:_0x5423d7)),_0x8190a8[_0x4265f5(0x15f)]=schedule[_0x4265f5(0x205)](_0x572a45,()=>{sendMorningBriefing(_0x8190a8);});}catch(_0x250d44){_0x8190a8[_0x4265f5(0xb0)][_0x4265f5(0x26d)](_0x4265f5(0x16e)+_0x250d44[_0x4265f5(0x1b3)]);}}async function sendNotification(_0x4a5bc2,_0x5cc5b6,_0x2b59aa=![],_0x59c9d1=![]){const _0x410038=a0_0x416b61;_0x4a5bc2[_0x410038(0xb0)][_0x410038(0x203)]((_0x2b59aa?_0x410038(0x22f):'')+_0x410038(0x1d4)+_0x5cc5b6+'\x22');const _0x17acb2=_0x4a5bc2[_0x410038(0xa5)];let _0x187fa2=0x0;if(_0x17acb2[_0x410038(0x15b)]){let _0x34f988={};(_0x5cc5b6['includes'](_0x410038(0x18c))||_0x59c9d1)&&(_0x34f988={'reply_markup':{'inline_keyboard':[[{'text':_0x410038(0x1a9),'callback_data':_0x410038(0x1e4)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x410038(0xef)}]]}}),await _0x4a5bc2[_0x410038(0x211)](_0x17acb2[_0x410038(0x281)],'send',{'text':_0x5cc5b6,'user':_0x17acb2[_0x410038(0x1bb)],..._0x34f988}),_0x187fa2++;}if(_0x17acb2[_0x410038(0x22e)]){let _0x4415fa={'message':_0x5cc5b6,'title':_0x59c9d1?'ðŸš¨\x20EMERGENCY':_0x410038(0x221),'priority':_0x59c9d1?0x2:0x1,'device':_0x17acb2['notifyPushoverRecipient']};_0x59c9d1&&(_0x4415fa[_0x410038(0x1ff)]=0x1e,_0x4415fa[_0x410038(0x274)]=0xe10,_0x4415fa[_0x410038(0x224)]='siren'),await _0x4a5bc2['sendToAsync'](_0x17acb2[_0x410038(0x172)],_0x410038(0x23f),_0x4415fa),_0x187fa2++;}return _0x17acb2['notifyEmailEnabled']&&(await _0x4a5bc2[_0x410038(0x211)](_0x17acb2[_0x410038(0x21a)],_0x410038(0x23f),{'text':_0x5cc5b6,'to':_0x17acb2[_0x410038(0x233)]}),_0x187fa2++),_0x187fa2;}async function setupTelegramListener(_0x5e5865){const _0x5494c4=a0_0x416b61,_0x28909d=_0x5e5865['config']['notifyTelegramInstance'];_0x5e5865['config'][_0x5494c4(0x15b)]&&_0x28909d&&(_0x5e5865[_0x5494c4(0xb0)][_0x5494c4(0x203)](_0x5494c4(0xb4)+_0x28909d+_0x5494c4(0xa4)),await _0x5e5865[_0x5494c4(0xd7)](_0x28909d+'.communicate.request'));}async function handleTelegramResponse(_0x36395c,_0x5887ea){const _0x585121=a0_0x416b61;let _0x21099c=_0x5887ea;_0x5887ea[_0x585121(0xfc)]('[')&&(_0x21099c=_0x5887ea[_0x585121(0x10b)](_0x5887ea[_0x585121(0x12e)](']')+0x1));if(_0x21099c===_0x585121(0x1e4))_0x36395c[_0x585121(0xb0)][_0x585121(0x203)](_0x585121(0x75)),await _0x36395c[_0x585121(0x238)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x36395c[_0x585121(0x238)](_0x585121(0x141),{'val':'Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ack':!![]}),_0x36395c[_0x585121(0xab)]=![],sendNotification(_0x36395c,_0x585121(0x8c),![]);else _0x21099c===_0x585121(0xef)&&(_0x36395c[_0x585121(0xb0)][_0x585121(0x1ad)](_0x585121(0xe5)),sendNotification(_0x36395c,_0x585121(0x26a),![],!![]));}async function runAutopilot(_0x159ac5){const _0x3ad943=a0_0x416b61,_0x5f5737=_0x159ac5[_0x3ad943(0xa5)][_0x3ad943(0x119)],_0x439b78=_0x159ac5[_0x3ad943(0x123)]['length']>0x0?_0x159ac5[_0x3ad943(0x123)][0x0][_0x3ad943(0xfa)]:Date[_0x3ad943(0xf9)](),_0x3f0ca8=(Date[_0x3ad943(0xf9)]()-_0x439b78)/(0x3e8*0x3c*0x3c);let _0x1f4668='';_0x159ac5[_0x3ad943(0xa5)][_0x3ad943(0x279)]&&_0x159ac5[_0x3ad943(0x1f5)]===SYSTEM_MODES['NORMAL']&&_0x159ac5[_0x3ad943(0x202)]&&(_0x3f0ca8>_0x5f5737&&(_0x1f4668=_0x3ad943(0xfb)+_0x3f0ca8[_0x3ad943(0x263)](0x1)+_0x3ad943(0x102))),runGeminiAnalysis(_0x159ac5,_0x1f4668)[_0x3ad943(0x165)](_0x2998ce=>_0x159ac5['log'][_0x3ad943(0x26d)](_0x2998ce));}async function createDailyDigest(_0x19ca2c){const _0x1b11d5=a0_0x416b61;if(!_0x19ca2c['isProVersion'])return;await _0x19ca2c['setStateAsync'](LTM_DP_STATUS,{'val':_0x1b11d5(0xfd)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x19ca2c[_0x1b11d5(0x232)]||_0x19ca2c['rawEventLog'][_0x1b11d5(0xc0)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x19ca2c[_0x1b11d5(0x238)](LTM_DP_STATUS,{'val':_0x1b11d5(0xdb),'ack':!![]});return;}const _0x2bced8=JSON[_0x1b11d5(0x250)](JSON[_0x1b11d5(0x243)](_0x19ca2c[_0x1b11d5(0x11f)])),_0x518d8d=_0x2bced8[_0x1b11d5(0xc0)],_0x58d28f=_0x1b11d5(0x1aa)+JSON[_0x1b11d5(0x243)](_0x2bced8);try{const _0x439503=await _0x19ca2c[_0x1b11d5(0x232)]['generateContent'](_0x58d28f),_0x435a9b=JSON[_0x1b11d5(0x250)](_0x439503['response']['text']()[_0x1b11d5(0xcd)](/```json|```/g,'')[_0x1b11d5(0xd3)]());_0x435a9b[_0x1b11d5(0x21d)]&&(_0x19ca2c[_0x1b11d5(0x1df)][_0x1b11d5(0x180)]({'timestamp':new Date()[_0x1b11d5(0x130)](),'eventCount':_0x518d8d,'summary':_0x435a9b[_0x1b11d5(0x21d)],'activityLevel':_0x435a9b[_0x1b11d5(0x12f)],'systemMode':_0x19ca2c[_0x1b11d5(0x1f5)]}),await saveDailyDigests(_0x19ca2c),_0x19ca2c[_0x1b11d5(0x11f)]=[],await saveRawEventLog(_0x19ca2c),await _0x19ca2c[_0x1b11d5(0x238)](LTM_DP_STATUS,{'val':'Success:\x20Compressed\x20'+_0x518d8d+_0x1b11d5(0x1d5),'ack':!![]}),runPythonHealthCheck(_0x19ca2c));}catch(_0xc74185){await _0x19ca2c[_0x1b11d5(0x238)](LTM_DP_STATUS,{'val':_0x1b11d5(0x95)+_0xc74185['message'],'ack':!![]});}}async function sendMorningBriefing(_0x39700c){const _0x3396e2=a0_0x416b61;if(!_0x39700c['geminiModel'])return;_0x39700c[_0x3396e2(0xb0)]['info'](_0x3396e2(0x14e));const _0x65dad8=_0x39700c[_0x3396e2(0x1df)]['length']>0x0?_0x39700c['dailyDigests'][_0x39700c[_0x3396e2(0x1df)][_0x3396e2(0xc0)]-0x1]:null,_0xb7a541=_0x65dad8&&_0x65dad8[_0x3396e2(0x1d3)]?_0x65dad8[_0x3396e2(0x1d3)]['sleepScore']:_0x3396e2(0x174),_0x41f899=new Date();_0x41f899[_0x3396e2(0x71)](0x4,0x0,0x0,0x0);const _0x54f70e=_0x39700c[_0x3396e2(0x123)]['filter'](_0x3a1c06=>new Date(_0x3a1c06[_0x3396e2(0xfa)])>_0x41f899),_0xca0efc=PERSONA_MAPPING[_0x39700c['config'][_0x3396e2(0xbe)]||_0x3396e2(0x1a3)],_0x2dae5c=_0x39700c[_0x3396e2(0xa5)]['livingContext']||'',_0x14e001=await getWeatherContext(_0x39700c),_0x2509cd=await getCalendarContext(_0x39700c),_0x81c89d='ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20'+_0xca0efc+'.\x20KONTEXT:\x20'+_0x2dae5c+'.\x20ZUSATZ:\x20'+_0x14e001+'\x20'+_0x2509cd+_0x3396e2(0xc7)+_0xb7a541+_0x3396e2(0x1f3)+JSON[_0x3396e2(0x243)](_0x54f70e[_0x3396e2(0x17b)](0x0,0xa))+'.\x20OUTPUT:\x20Nur\x20Text.';try{const _0xb1ea23=await _0x39700c[_0x3396e2(0x232)]['generateContent'](_0x81c89d),_0x50027a=_0x3396e2(0xf7)+_0xb1ea23[_0x3396e2(0x260)][_0x3396e2(0x190)]()[_0x3396e2(0xd3)]();sendNotification(_0x39700c,_0x50027a),_0x39700c['log'][_0x3396e2(0x203)]('Morning\x20Briefing\x20sent.');}catch(_0x5573d3){_0x39700c[_0x3396e2(0xb0)]['error']('Briefing\x20Error:\x20'+_0x5573d3[_0x3396e2(0x1b3)]);}}async function scanForDevices(_0x2cf78a,_0x153868){const _0x35bc48=a0_0x416b61;_0x2cf78a[_0x35bc48(0xb0)]['info'](_0x35bc48(0xb9));const _0x1839f0=[],_0xbb7d9d=await _0x2cf78a['getForeignObjectsAsync']('*'),_0x28cebe=await _0x2cf78a[_0x35bc48(0xfe)](_0x35bc48(0x200),_0x35bc48(0xcc)),_0x107630=await _0x2cf78a[_0x35bc48(0xfe)]('enum.rooms.*',_0x35bc48(0xcc)),_0x3a4cf5={};if(_0x28cebe)for(const _0x104523 in _0x28cebe){const _0x72080c=_0x28cebe[_0x104523][_0x35bc48(0x105)][_0x35bc48(0xe3)]||[];_0x72080c[_0x35bc48(0x10f)](_0x2604e1=>{if(!_0x3a4cf5[_0x2604e1])_0x3a4cf5[_0x2604e1]=[];_0x3a4cf5[_0x2604e1]['push'](_0x104523);});}const _0x46d55d={};if(_0x107630)for(const _0xe2241c in _0x107630){const _0x16e2c4=_0x107630[_0xe2241c][_0x35bc48(0x105)][_0x35bc48(0xe3)]||[],_0xcb83ef=typeof _0x107630[_0xe2241c][_0x35bc48(0x105)][_0x35bc48(0x245)]===_0x35bc48(0x247)?_0x107630[_0xe2241c]['common']['name']['de']:_0x107630[_0xe2241c]['common'][_0x35bc48(0x245)];_0x16e2c4['forEach'](_0x16b444=>_0x46d55d[_0x16b444]=_0xcb83ef);}const _0x41d6d5=_0x153868[_0x35bc48(0xa1)]||[],_0x5e5582=_0x153868['motion']!==![],_0x801ff2=_0x153868['doors']!==![],_0x315ac4=_0x153868[_0x35bc48(0xc6)]!==![],_0x58a67c=_0x153868[_0x35bc48(0x1d6)]===!![],_0xb4d8dd=_0x153868['weather']===!![];for(const _0xb65c6b in _0xbb7d9d){const _0x23a281=_0xbb7d9d[_0xb65c6b];if(_0x23a281[_0x35bc48(0x262)]!==_0x35bc48(0xb7)||!_0x23a281[_0x35bc48(0x105)])continue;if(ADAPTER_BLACKLIST['some'](_0x48347a=>_0xb65c6b[_0x35bc48(0xfc)](_0x48347a))&&!_0xb4d8dd)continue;const _0x373289=(_0x23a281[_0x35bc48(0x105)][_0x35bc48(0x1ce)]||'')['toLowerCase']();let _0x33f622=(typeof _0x23a281['common'][_0x35bc48(0x245)]===_0x35bc48(0x247)?_0x23a281[_0x35bc48(0x105)][_0x35bc48(0x245)]['de']:_0x23a281['common'][_0x35bc48(0x245)])||_0xb65c6b;const _0x43799b=_0x33f622[_0x35bc48(0x276)]();let _0x40486f=![],_0xd35075=![];if(_0x41d6d5['length']>0x0){const _0x254585=_0x3a4cf5[_0xb65c6b]||[],_0x193f53=_0xb65c6b[_0x35bc48(0x23d)]('.')['slice'](0x0,-0x1)[_0x35bc48(0x1ec)]('.'),_0x1a85f3=_0x3a4cf5[_0x193f53]||[];(_0x254585[_0x35bc48(0x1ba)](_0x5eeff0=>_0x41d6d5[_0x35bc48(0x272)](_0x5eeff0))||_0x1a85f3[_0x35bc48(0x1ba)](_0x25406f=>_0x41d6d5[_0x35bc48(0x272)](_0x25406f)))&&(_0x40486f=!![],_0xd35075=!![]);}if(!_0x40486f&&!_0xb4d8dd){if(HARD_IGNORE_TERMS['some'](_0x28dffa=>_0xb65c6b[_0x35bc48(0x272)](_0x28dffa)||_0x43799b[_0x35bc48(0x272)](_0x28dffa[_0x35bc48(0x276)]())))continue;}if(BAD_NAMES[_0x35bc48(0x1ba)](_0x589a48=>_0x43799b===_0x589a48||_0x43799b[_0x35bc48(0x11b)]('.'+_0x589a48))){const _0x455ba9=_0xb65c6b[_0x35bc48(0x23d)]('.');if(_0x455ba9[_0x35bc48(0xc0)]>0x2){const _0x4cf8e1=_0x455ba9[_0x35bc48(0x17b)](0x0,-0x1)[_0x35bc48(0x1ec)]('.'),_0xc93a06=_0xbb7d9d[_0x4cf8e1];if(_0xc93a06&&_0xc93a06[_0x35bc48(0x105)]&&_0xc93a06[_0x35bc48(0x105)]['name']){const _0x5083b7=typeof _0xc93a06[_0x35bc48(0x105)]['name']==='object'?_0xc93a06['common']['name']['de']:_0xc93a06[_0x35bc48(0x105)]['name'];_0x5083b7&&!_0x33f622[_0x35bc48(0x272)](_0x5083b7)&&(_0x33f622=_0x5083b7+'\x20'+_0x33f622);}}}let _0x39983c='';if(_0x5e5582&&(_0x373289[_0x35bc48(0x272)](_0x35bc48(0x17e))||_0x373289[_0x35bc48(0x272)](_0x35bc48(0x8a))||_0x43799b[_0x35bc48(0x272)](_0x35bc48(0x229))||_0x43799b[_0x35bc48(0x272)](_0x35bc48(0x125))))_0x39983c=_0x35bc48(0x17e);else{if(!_0x39983c&&_0x801ff2&&(_0x373289[_0x35bc48(0x272)]('door')||_0x373289[_0x35bc48(0x272)](_0x35bc48(0x8f))||_0x373289[_0x35bc48(0x272)]('lock')||_0x373289['includes'](_0x35bc48(0x156))||_0x373289['includes']('shutter')||_0x43799b['includes'](_0x35bc48(0x18f))||_0x43799b[_0x35bc48(0x272)](_0x35bc48(0x226))||_0x43799b[_0x35bc48(0x272)](_0x35bc48(0x13b))))_0x39983c='door';else{if(!_0x39983c&&_0x315ac4&&(_0x373289[_0x35bc48(0x272)](_0x35bc48(0x104))||_0x373289[_0x35bc48(0x272)]('switch')||_0x373289['includes'](_0x35bc48(0xbc))||_0x43799b['includes'](_0x35bc48(0x256))||_0x43799b[_0x35bc48(0x272)]('lampe')||_0x43799b[_0x35bc48(0x272)](_0x35bc48(0x7d)))){if(_0x23a281['common']['write']||_0x373289[_0x35bc48(0x272)](_0x35bc48(0x149)))_0x39983c=_0x35bc48(0x104);}else{if(!_0x39983c&&_0x58a67c&&(_0x373289[_0x35bc48(0x272)](_0x35bc48(0x1d6))||_0x373289['includes']('humidity')||_0x373289[_0x35bc48(0x272)](_0x35bc48(0x1fe))||_0x43799b['includes'](_0x35bc48(0x1ab))||_0x43799b[_0x35bc48(0x272)](_0x35bc48(0x8d))||_0x43799b[_0x35bc48(0x272)](_0x35bc48(0x142))))_0x39983c=_0x35bc48(0x1d6);else{if(!_0x39983c&&_0xd35075)_0x39983c=_0x35bc48(0x25b);}}}}if(_0x39983c){let _0x10cca1=_0x46d55d[_0xb65c6b]||'';if(!_0x10cca1){let _0x3c16cb=_0xb65c6b;for(let _0x40450c=0x0;_0x40450c<0x3;_0x40450c++){const _0x4b4b7f=_0x3c16cb[_0x35bc48(0x1cd)]('.');if(_0x4b4b7f===-0x1)break;_0x3c16cb=_0x3c16cb[_0x35bc48(0x10b)](0x0,_0x4b4b7f);if(_0x46d55d[_0x3c16cb]){_0x10cca1=_0x46d55d[_0x3c16cb];break;}}}_0x1839f0[_0x35bc48(0x180)]({'id':_0xb65c6b,'name':_0x33f622,'location':_0x10cca1,'type':_0x39983c,'logDuplicates':_0x39983c===_0x35bc48(0x17e),'isExit':![],'_score':_0x10cca1?0x50:_0x39983c===_0x35bc48(0x25b)?0x5a:0x28});}}return _0x1839f0[_0x35bc48(0xd8)]((_0x38f22f,_0x1c1931)=>_0x1c1931[_0x35bc48(0x27c)]-_0x38f22f[_0x35bc48(0x27c)]),_0x1839f0;}async function executeAutomationAction(_0x39ac78){const _0x100915=a0_0x416b61;try{const _0x248bf0=await _0x39ac78['getStateAsync'](_0x100915(0x217)),_0x361ce3=await _0x39ac78[_0x100915(0x194)]('analysis.automation.targetValue');if(_0x248bf0&&_0x248bf0[_0x100915(0x154)]&&_0x361ce3){const _0x45f393=_0x248bf0[_0x100915(0x154)];let _0x3b8d7b=_0x361ce3[_0x100915(0x154)];try{_0x3b8d7b=JSON[_0x100915(0x250)](_0x3b8d7b);}catch(_0x212223){}_0x39ac78[_0x100915(0xb0)][_0x100915(0x203)](_0x100915(0x1e9)+_0x45f393+_0x100915(0x1ea)+_0x3b8d7b),await _0x39ac78[_0x100915(0x225)](_0x45f393,_0x3b8d7b);}else _0x39ac78[_0x100915(0xb0)][_0x100915(0x1ad)](_0x100915(0xe6));}catch(_0x3cea48){_0x39ac78['log'][_0x100915(0x26d)]('BUTLER\x20Execution\x20Error:\x20'+_0x3cea48[_0x100915(0x1b3)]);}}function tryParse(_0x53894c){const _0x24c9d5=a0_0x416b61;try{return JSON[_0x24c9d5(0x250)](_0x53894c);}catch(_0x533193){return null;}}async function recordSequence(_0xb1ead0,_0xb902de){const _0x37ceb1=a0_0x416b61,_0x1dcc7c=(_0xb902de['type']||'')[_0x37ceb1(0x276)](),_0x169051=[_0x37ceb1(0x17e),_0x37ceb1(0x229),_0x37ceb1(0x125),_0x37ceb1(0x126),'occupancy',_0x37ceb1(0x12c),'tÃ¼r',_0x37ceb1(0x8f),_0x37ceb1(0x18f),_0x37ceb1(0x1a0),_0x37ceb1(0x1dd),'light',_0x37ceb1(0x256),'switch','schalter',_0x37ceb1(0xbc),_0x37ceb1(0x111)];if(!_0x169051[_0x37ceb1(0x1ba)](_0x402023=>_0x1dcc7c[_0x37ceb1(0x272)](_0x402023))){_0xb1ead0[_0x37ceb1(0xb0)][_0x37ceb1(0x1d2)](_0x37ceb1(0x186)+_0xb902de['id']+'\x20(Type\x20\x27'+_0xb902de[_0x37ceb1(0x262)]+_0x37ceb1(0x115));return;}if(!_0xb902de[_0x37ceb1(0x159)]){_0xb1ead0['log'][_0x37ceb1(0x1d2)](_0x37ceb1(0x186)+_0xb902de['id']+'\x20(Value\x20is\x20falsy:\x20'+_0xb902de[_0x37ceb1(0x159)]+')');return;}_0xb1ead0[_0x37ceb1(0xb0)]['debug'](_0x37ceb1(0x16d)+_0xb902de['id']+'\x20('+_0xb902de[_0x37ceb1(0x1a7)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x2d50a1={'loc':_0xb902de[_0x37ceb1(0x1a7)]||_0x37ceb1(0x1ac),'id':_0xb902de['id'],'ts':Date[_0x37ceb1(0xf9)]()};activeSequence[_0x37ceb1(0x180)](_0x2d50a1),_0xb1ead0[_0x37ceb1(0xb0)][_0x37ceb1(0x1d2)](_0x37ceb1(0xa6)+_0x2d50a1[_0x37ceb1(0x116)]+_0x37ceb1(0x198)+activeSequence[_0x37ceb1(0xc0)]+')'),sequenceTimer=setTimeout(async()=>{const _0x10cbac=_0x37ceb1;activeSequence[_0x10cbac(0xc0)]>0x1?await saveCompletedSequence(_0xb1ead0):(_0xb1ead0['log'][_0x10cbac(0x1d2)](_0x10cbac(0x210)+activeSequence[_0x10cbac(0xc0)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x113283){const _0x155044=a0_0x416b61;try{_0x113283['log'][_0x155044(0x203)](_0x155044(0x120)+activeSequence['length']+').\x20Saving\x20to\x20Training\x20Data.');const _0x5e23f7=await _0x113283[_0x155044(0x194)](_0x155044(0x1b4));let _0x279d88=[];if(_0x5e23f7&&_0x5e23f7[_0x155044(0x154)])try{_0x279d88=JSON['parse'](_0x5e23f7[_0x155044(0x154)]);}catch(_0xd9f905){}const _0x490de5=activeSequence[0x0]['ts'],_0x1253eb=activeSequence[_0x155044(0x91)](_0x419b87=>({'loc':_0x419b87[_0x155044(0x116)],'t_delta':Math[_0x155044(0x21f)]((_0x419b87['ts']-_0x490de5)/0x3e8)})),_0x53fe27={'timestamp':new Date(_0x490de5)[_0x155044(0x130)](),'steps':_0x1253eb,'duration':Math['round']((activeSequence[activeSequence[_0x155044(0xc0)]-0x1]['ts']-_0x490de5)/0x3e8),'daytime':new Date(_0x490de5)[_0x155044(0x106)]()};_0x279d88[_0x155044(0x180)](_0x53fe27),_0x279d88[_0x155044(0xc0)]>MAX_TRAINING_SET_SIZE&&_0x279d88[_0x155044(0x10a)](),await _0x113283[_0x155044(0x238)]('LTM.trainingData.sequences',{'val':JSON[_0x155044(0x243)](_0x279d88),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x50d1be){_0x113283[_0x155044(0xb0)][_0x155044(0x26d)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x50d1be[_0x155044(0x1b3)]);}}async function getOutsideTemperatureNumeric(_0x5364ac){const _0xa2fc4f=a0_0x416b61;if(_0x5364ac[_0xa2fc4f(0xa5)]['outdoorSensorId'])try{const _0x27c13c=await _0x5364ac['getForeignStateAsync'](_0x5364ac[_0xa2fc4f(0xa5)][_0xa2fc4f(0x108)]);if(_0x27c13c&&_0x27c13c['val']!==undefined&&_0x27c13c['val']!==null){const _0x1b3b37=parseFloat(_0x27c13c[_0xa2fc4f(0x154)]);if(!isNaN(_0x1b3b37))return _0x1b3b37;}}catch(_0x131660){_0x5364ac[_0xa2fc4f(0xb0)][_0xa2fc4f(0x1ad)](_0xa2fc4f(0x23e)+_0x5364ac[_0xa2fc4f(0xa5)]['outdoorSensorId']+':\x20'+_0x131660['message']);}const _0x42af5c=_0x5364ac[_0xa2fc4f(0xa5)][_0xa2fc4f(0x7c)];if(!_0x5364ac[_0xa2fc4f(0xa5)][_0xa2fc4f(0x252)]||!_0x42af5c)return null;try{let _0x4f4d6b='';if(_0x42af5c[_0xa2fc4f(0x272)](_0xa2fc4f(0x24d)))_0x4f4d6b=_0x42af5c+_0xa2fc4f(0x23c);else{if(_0x42af5c[_0xa2fc4f(0x272)](_0xa2fc4f(0xf2)))_0x4f4d6b=_0x42af5c+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x42af5c[_0xa2fc4f(0x272)]('openweathermap'))_0x4f4d6b=_0x42af5c+'.forecast.current.temperature';else{if(_0x42af5c[_0xa2fc4f(0x272)](_0xa2fc4f(0x1d8)))_0x4f4d6b=_0x42af5c+_0xa2fc4f(0x9d);}}}if(_0x4f4d6b){const _0x4b5fd3=await _0x5364ac['getForeignStateAsync'](_0x4f4d6b);if(_0x4b5fd3&&_0x4b5fd3['val']!==undefined&&_0x4b5fd3[_0xa2fc4f(0x154)]!==null)return parseFloat(_0x4b5fd3['val']);}}catch(_0xe42cbb){}return null;}async function recordThermodynamics(_0x32b68c,_0x40f44a,_0x1dc3cb,_0x4ec40d){const _0x170db6=a0_0x416b61,_0x42de86=await getOutsideTemperatureNumeric(_0x32b68c),_0x3bc0c5=await _0x32b68c['getStateAsync'](_0x170db6(0x1ed));let _0x468490=[];if(_0x3bc0c5&&_0x3bc0c5[_0x170db6(0x154)])try{_0x468490=JSON[_0x170db6(0x250)](_0x3bc0c5['val']);}catch(_0xef6ada){}_0x468490[_0x170db6(0x180)]({'ts':Date[_0x170db6(0xf9)](),'room':_0x4ec40d||_0x170db6(0x1ac),'t_in':_0x1dc3cb,'t_out':_0x42de86});if(_0x468490[_0x170db6(0xc0)]>THERMO_LOG_SIZE)_0x468490[_0x170db6(0x10a)]();await _0x32b68c[_0x170db6(0x238)](_0x170db6(0x1ed),{'val':JSON[_0x170db6(0x243)](_0x468490),'ack':!![]});}async function processSensorEvent(_0x58fd26,_0x31df01,_0x171954,_0x4eaff7){const _0x4aa82e=a0_0x416b61;if(!_0x4eaff7)return;const _0x5d7ac6=_0x171954[_0x4aa82e(0x154)],_0x2d6b6e=Date[_0x4aa82e(0xf9)]();_0x58fd26['log'][_0x4aa82e(0x1d2)]('Event\x20received:\x20'+_0x31df01+_0x4aa82e(0x1ea)+_0x5d7ac6);const _0x4075bf=_0x58fd26[_0x4aa82e(0xd2)][_0x31df01];_0x58fd26[_0x4aa82e(0xd2)][_0x31df01]=_0x5d7ac6;if(!_0x4eaff7[_0x4aa82e(0x1a6)]&&_0x4075bf!=undefined&&_0x4075bf==_0x5d7ac6){_0x58fd26['log'][_0x4aa82e(0x1d2)]('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x4eaff7[_0x4aa82e(0x245)]+_0x4aa82e(0xd9)+_0x5d7ac6+')');return;}const _0x1f6fbb=(_0x4eaff7[_0x4aa82e(0x262)]||'')[_0x4aa82e(0x276)](),_0x4190f4=_0x1f6fbb[_0x4aa82e(0x272)](_0x4aa82e(0x1d6))||_0x1f6fbb[_0x4aa82e(0x272)]('temperatur')||_0x1f6fbb[_0x4aa82e(0x272)]('klima')||_0x1f6fbb[_0x4aa82e(0x272)](_0x4aa82e(0x142));_0x58fd26[_0x4aa82e(0x267)]&&_0x4190f4&&recordThermodynamics(_0x58fd26,_0x31df01,_0x5d7ac6,_0x4eaff7[_0x4aa82e(0x1a7)]);const _0x3e5818={'timestamp':_0x2d6b6e,'id':_0x31df01,'name':_0x4eaff7[_0x4aa82e(0x245)],'type':_0x4eaff7['type'],'location':_0x4eaff7['location'],'value':_0x5d7ac6};_0x58fd26[_0x4aa82e(0x123)][_0x4aa82e(0x1af)](_0x3e5818);if(_0x58fd26[_0x4aa82e(0x123)]['length']>HISTORY_MAX_SIZE)_0x58fd26[_0x4aa82e(0x123)][_0x4aa82e(0x191)]();await _0x58fd26[_0x4aa82e(0x238)](_0x4aa82e(0xed),{'val':JSON['stringify'](_0x3e5818),'ack':!![]}),await _0x58fd26['setStateAsync'](_0x4aa82e(0x8e),{'val':JSON[_0x4aa82e(0x243)](_0x58fd26[_0x4aa82e(0x123)]),'ack':!![]});_0x58fd26[_0x4aa82e(0x267)]&&(_0x58fd26[_0x4aa82e(0x11f)][_0x4aa82e(0x180)](_0x3e5818),await saveRawEventLog(_0x58fd26),recordSequence(_0x58fd26,_0x3e5818));if(_0x4eaff7[_0x4aa82e(0x72)]&&_0x5d7ac6===!![]){if(_0x58fd26[_0x4aa82e(0x202)]&&!_0x58fd26['isGracePeriodActive'])_0x58fd26[_0x4aa82e(0xb0)]['info']('Exit\x20Sensor\x20triggered\x20('+_0x4eaff7[_0x4aa82e(0x245)]+_0x4aa82e(0xde)),startExitTimer(_0x58fd26);else!_0x58fd26[_0x4aa82e(0x202)]&&(_0x58fd26['log'][_0x4aa82e(0x203)](_0x4aa82e(0x212)+_0x4eaff7[_0x4aa82e(0x245)]+_0x4aa82e(0x160)),await setPresence(_0x58fd26,!![]));}else _0x4eaff7['type']===_0x4aa82e(0x17e)&&_0x5d7ac6===!![]&&(_0x58fd26[_0x4aa82e(0xdf)]&&(_0x58fd26['log']['info'](_0x4aa82e(0x268)),abortExitTimer(_0x58fd26)),!_0x58fd26[_0x4aa82e(0x202)]&&_0x58fd26[_0x4aa82e(0x1f5)]===SYSTEM_MODES[_0x4aa82e(0x17c)]&&await setPresence(_0x58fd26,!![]));}async function runGeminiAnalysis(_0xfc0d5c,_0xc9b076=''){const _0x5450ba=a0_0x416b61;if(!_0xfc0d5c[_0x5450ba(0x232)])return;if(_0xfc0d5c[_0x5450ba(0x123)][_0x5450ba(0xc0)]===0x0)return;const _0x121b10=_0xfc0d5c[_0x5450ba(0x123)][_0x5450ba(0x17b)](0x0,0xf),_0xd40ae5=await getWeatherContext(_0xfc0d5c),_0x2cd2c4=_0xfc0d5c[_0x5450ba(0x1f5)],_0x4ed8a5=PERSONA_MAPPING[_0xfc0d5c['config']['aiPersona']||_0x5450ba(0x1a3)],_0x56b352=_0xfc0d5c['config'][_0x5450ba(0x1d9)]||'Keine\x20Details.';let _0x4d4c11=_0x5450ba(0x1be);try{const _0x469eeb=await _0xfc0d5c[_0x5450ba(0x194)](_0x5450ba(0x15e));if(_0x469eeb&&_0x469eeb[_0x5450ba(0x154)])_0x4d4c11=_0x469eeb[_0x5450ba(0x154)];}catch(_0x3ef0fa){}let _0x416000=![];try{const _0x106996=await _0xfc0d5c[_0x5450ba(0x194)](_0x5450ba(0x25d));if(_0x106996&&_0x106996[_0x5450ba(0x154)])_0x416000=!![];}catch(_0x15ea33){}const _0x20cb3f=_0x5450ba(0x118)+_0x4ed8a5+'.\x0a\x20\x20\x20\x20KONTEXT:\x20'+_0x56b352+_0x5450ba(0x1a1)+_0x2cd2c4+_0x5450ba(0x1b7)+_0xd40ae5+_0x5450ba(0x192)+(_0xc9b076||_0x5450ba(0xa8))+_0x5450ba(0x258)+(_0xfc0d5c['isPresent']?_0x5450ba(0xea):_0x5450ba(0x107))+_0x5450ba(0x146)+_0x4d4c11+_0x5450ba(0xb8)+JSON[_0x5450ba(0x243)](_0x121b10)+_0x5450ba(0xc8);try{const _0x5d39ba=await _0xfc0d5c['geminiModel']['generateContent'](_0x20cb3f),_0x9a1ebb=_0x5d39ba[_0x5450ba(0x260)][_0x5450ba(0x190)]()['replace'](/```json|```/g,'')[_0x5450ba(0xd3)](),_0x2ef6f5=JSON[_0x5450ba(0x250)](_0x9a1ebb);await _0xfc0d5c[_0x5450ba(0x238)]('analysis.lastResult',{'val':JSON[_0x5450ba(0x243)](_0x2ef6f5),'ack':!![]});_0x2ef6f5[_0x5450ba(0x21d)]&&await _0xfc0d5c[_0x5450ba(0x238)](_0x5450ba(0x121),{'val':_0x2ef6f5[_0x5450ba(0x21d)],'ack':!![]});const _0x462547={'timestamp':Date[_0x5450ba(0xf9)](),'id':Date[_0x5450ba(0xf9)]()[_0x5450ba(0x277)](),'analysis':{'activity':{'summary':_0x2ef6f5[_0x5450ba(0x21d)]||'Keine\x20Analyse.','isAlert':_0x2ef6f5[_0x5450ba(0xcf)]||![],'alertReason':_0x2ef6f5[_0x5450ba(0x25f)]},'comfort':{'automationProposal':_0x2ef6f5['automationProposal']}}};await updateAnalysisHistory(_0xfc0d5c,_0x462547);const _0x1d7124=_0x2ef6f5[_0x5450ba(0xcf)]||![];_0x1d7124!==_0xfc0d5c[_0x5450ba(0xab)]&&(await _0xfc0d5c['setStateAsync'](_0x5450ba(0x23a),{'val':_0x1d7124,'ack':!![]}),_0xfc0d5c['lastAlertState']=_0x1d7124,_0x1d7124&&(await _0xfc0d5c[_0x5450ba(0x238)](_0x5450ba(0x141),{'val':_0x2ef6f5['alertReason'],'ack':!![]}),sendNotification(_0xfc0d5c,_0x5450ba(0x9a)+_0x2ef6f5[_0x5450ba(0x25f)],![],_0x2ef6f5[_0x5450ba(0x10c)]))),_0x2ef6f5[_0x5450ba(0x188)]&&_0x2ef6f5[_0x5450ba(0x188)][_0x5450ba(0x1a5)]&&_0x2ef6f5['automationProposal'][_0x5450ba(0x1b8)]&&(_0xfc0d5c[_0x5450ba(0xb0)]['info'](_0x5450ba(0x1fa)+_0x2ef6f5[_0x5450ba(0x188)][_0x5450ba(0xae)]),await _0xfc0d5c['setStateAsync'](_0x5450ba(0x257),{'val':!![],'ack':!![]}),await _0xfc0d5c[_0x5450ba(0x238)](_0x5450ba(0xeb),{'val':_0x2ef6f5[_0x5450ba(0x188)][_0x5450ba(0xae)],'ack':!![]}),await _0xfc0d5c['setStateAsync'](_0x5450ba(0x217),{'val':_0x2ef6f5[_0x5450ba(0x188)]['targetId'],'ack':!![]}),await _0xfc0d5c[_0x5450ba(0x238)]('analysis.automation.targetValue',{'val':JSON[_0x5450ba(0x243)](_0x2ef6f5[_0x5450ba(0x188)]['targetValue']),'ack':!![]}),_0x416000&&(_0xfc0d5c[_0x5450ba(0xb0)]['info'](_0x5450ba(0x204)+_0x2ef6f5[_0x5450ba(0x188)][_0x5450ba(0x1b8)]+'...'),await executeAutomationAction(_0xfc0d5c)));}catch(_0x4af2ac){_0xfc0d5c[_0x5450ba(0xb0)][_0x5450ba(0x26d)]('Gemini\x20Analysis\x20Error:\x20'+_0x4af2ac[_0x5450ba(0x1b3)]);}}function installPythonDependencies(_0x5e12d8){const _0x3106d0=a0_0x416b61;if(_0x5e12d8[_0x3106d0(0x269)])return;_0x5e12d8[_0x3106d0(0x269)]=!![];const _0x161fa2=path[_0x3106d0(0x1ec)](__dirname,_0x3106d0(0x1e7),_0x3106d0(0x264));_0x5e12d8[_0x3106d0(0xb0)]['info'](_0x3106d0(0x1a4)+_0x161fa2+_0x3106d0(0x1c7)),stopPythonService(_0x5e12d8);const _0x78965c='python3\x20-m\x20pip\x20install\x20-r\x20\x22'+_0x161fa2+_0x3106d0(0x18d);exec(_0x78965c,(_0x248c77,_0x42c563,_0x3797f8)=>{const _0xd91cb3=_0x3106d0,_0x3c885e=_0x3797f8&&_0x3797f8[_0xd91cb3(0x272)](_0xd91cb3(0x9f))||_0x248c77&&_0x248c77[_0xd91cb3(0x1b3)]['includes'](_0xd91cb3(0x9f));if(_0x3c885e){_0x5e12d8['log'][_0xd91cb3(0x1ad)]('âš ï¸\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...'),exec('python3\x20-m\x20ensurepip\x20--default-pip\x20--user',(_0x3490cd,_0x457feb,_0x4a0795)=>{const _0x2e9b34=_0xd91cb3;_0x3490cd?(_0x5e12d8[_0x2e9b34(0xb0)][_0x2e9b34(0x26d)](_0x2e9b34(0x84)),_0x5e12d8['log'][_0x2e9b34(0x26d)](_0x2e9b34(0x9b)),_0x5e12d8[_0x2e9b34(0x269)]=![]):(_0x5e12d8[_0x2e9b34(0xb0)][_0x2e9b34(0x203)](_0x2e9b34(0x240)),exec(_0x2e9b34(0x206)+_0x161fa2+_0x2e9b34(0x129),(_0x2a4a50,_0x1c973e,_0x35cefb)=>{const _0x495163=_0x2e9b34;_0x2a4a50?_0x5e12d8[_0x495163(0xb0)]['error'](_0x495163(0x219)+_0x2a4a50[_0x495163(0x1b3)]):(_0x5e12d8[_0x495163(0xb0)][_0x495163(0x203)](_0x495163(0xc1)),startPythonService(_0x5e12d8)),_0x5e12d8['dependencyInstallInProgress']=![];}));});return;}_0x5e12d8['dependencyInstallInProgress']=![],_0x248c77?(_0x5e12d8[_0xd91cb3(0xb0)]['error'](_0xd91cb3(0x222)),_0x5e12d8['log'][_0xd91cb3(0x26d)](_0xd91cb3(0x152)+(_0x3797f8||_0x248c77[_0xd91cb3(0x1b3)]))):(_0x5e12d8[_0xd91cb3(0xb0)][_0xd91cb3(0x203)](_0xd91cb3(0x124)),startPythonService(_0x5e12d8));});}function sendToPython(_0x5c6115,_0xc538d2,_0x289e48={}){const _0x230bfe=a0_0x416b61;if(!_0x5c6115[_0x230bfe(0xc2)]||!_0x5c6115[_0x230bfe(0xc2)][_0x230bfe(0x242)][_0x230bfe(0x24e)])return;const _0xecdc6=JSON[_0x230bfe(0x243)]({'command':_0xc538d2,..._0x289e48});try{_0x5c6115[_0x230bfe(0xc2)]['stdin']['write'](_0xecdc6+'\x0a');}catch(_0x2d2ebc){_0x5c6115['log']['error'](_0x230bfe(0x1e8)+_0x2d2ebc[_0x230bfe(0x1b3)]);}}function runPythonHealthCheck(_0x14aaa7){const _0x3f5945=a0_0x416b61;if(!_0x14aaa7['dailyDigests']||_0x14aaa7[_0x3f5945(0x1df)][_0x3f5945(0xc0)]<0x2){_0x14aaa7[_0x3f5945(0xb0)][_0x3f5945(0x203)]('Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.');return;}const _0x3d173d=_0x14aaa7[_0x3f5945(0x1df)][_0x3f5945(0x91)](_0x216378=>{const _0x1dcbd8=_0x3f5945,_0x30d8ae=(_0x216378['activityLevel']||'')[_0x1dcbd8(0x276)]();return ACTIVITY_LEVEL_MAP[_0x30d8ae]||0x32;});_0x14aaa7[_0x3f5945(0xb0)]['info'](_0x3f5945(0x25a)+_0x3d173d[_0x3f5945(0xc0)]+_0x3f5945(0xc5)),sendToPython(_0x14aaa7,_0x3f5945(0x275),{'values':_0x3d173d,'tag':'Activity-Level'});}function handlePythonResult(_0x2ab637,_0x3f64ef){const _0x17f9c4=a0_0x416b61;if(_0x3f64ef[_0x17f9c4(0x262)]===_0x17f9c4(0xee))_0x2ab637['log']['debug'](_0x17f9c4(0x185));else{if(_0x3f64ef[_0x17f9c4(0x262)]===_0x17f9c4(0x79)){const {tag:_0x2d5b7d,diagnosis:_0x5b70f1,change_percent:_0x505898}=_0x3f64ef[_0x17f9c4(0x14f)];_0x2ab637[_0x17f9c4(0xb0)]['info']('ðŸ\x20Guardian\x20Diagnosis\x20('+_0x2d5b7d+_0x17f9c4(0xd0)+_0x5b70f1+'\x20('+_0x505898+'%)'),_0x2ab637[_0x17f9c4(0x238)](_0x17f9c4(0xaf),{'val':_0x5b70f1,'ack':!![]}),_0x2ab637[_0x17f9c4(0x238)]('analysis.health.trendValue',{'val':_0x505898,'ack':!![]});}}}function startPythonService(_0x5f2252){const _0x8f4263=a0_0x416b61;try{const _0x3eef0a=path[_0x8f4263(0x1ec)](__dirname,_0x8f4263(0x1e7),'service.py');_0x5f2252['log'][_0x8f4263(0x203)](_0x8f4263(0x17f)+_0x3eef0a),_0x5f2252[_0x8f4263(0xc2)]=spawn('python3',[_0x3eef0a]),_0x5f2252[_0x8f4263(0xc2)][_0x8f4263(0x12b)]['on'](_0x8f4263(0x218),_0x170536=>{const _0x9a48b0=_0x8f4263,_0x9984aa=_0x170536[_0x9a48b0(0x277)]()['split']('\x0a');_0x9984aa[_0x9a48b0(0x10f)](_0xabcb09=>{const _0x42a0d2=_0x9a48b0,_0x10756=_0xabcb09['trim']();if(!_0x10756)return;if(_0x10756[_0x42a0d2(0xfc)](_0x42a0d2(0x239)))_0x5f2252['log'][_0x42a0d2(0x1d2)](_0x42a0d2(0x9c)+_0x10756[_0x42a0d2(0x10b)](0x5)[_0x42a0d2(0xd3)]());else{if(_0x10756[_0x42a0d2(0xfc)]('[RESULT]'))try{const _0x223f44=JSON[_0x42a0d2(0x250)](_0x10756[_0x42a0d2(0x10b)](0x8)[_0x42a0d2(0xd3)]());handlePythonResult(_0x5f2252,_0x223f44);}catch(_0x83a050){_0x5f2252[_0x42a0d2(0xb0)]['warn']('Invalid\x20JSON\x20from\x20Python:\x20'+_0x10756);}}(_0x10756['includes'](_0x42a0d2(0x1b9))||_0x10756[_0x42a0d2(0x272)]('Bibliotheken\x20nicht\x20gefunden')||_0x10756[_0x42a0d2(0x272)](_0x42a0d2(0x227)))&&(_0x5f2252[_0x42a0d2(0xb0)][_0x42a0d2(0x1ad)](_0x42a0d2(0x266)),installPythonDependencies(_0x5f2252));});}),_0x5f2252['pythonProcess'][_0x8f4263(0x122)]['on']('data',_0x19389a=>{const _0x6032c8=_0x8f4263,_0x267550=_0x19389a[_0x6032c8(0x277)]()['trim']();_0x5f2252[_0x6032c8(0xb0)]['error'](_0x6032c8(0x187)+_0x267550);}),_0x5f2252[_0x8f4263(0xc2)]['on']('close',_0x221a73=>{const _0x2953d2=_0x8f4263;_0x5f2252[_0x2953d2(0xb0)][_0x2953d2(0x203)]('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x221a73),_0x5f2252['pythonProcess']=null;}),_0x5f2252[_0x8f4263(0xc2)]['on'](_0x8f4263(0x26d),_0x5b8b3e=>{const _0x5b083d=_0x8f4263;_0x5f2252[_0x5b083d(0xb0)][_0x5b083d(0x1ad)](_0x5b083d(0x16b)+_0x5b8b3e[_0x5b083d(0x1b3)]);});}catch(_0x3166dc){_0x5f2252[_0x8f4263(0xb0)][_0x8f4263(0x26d)](_0x8f4263(0x14b)+_0x3166dc['message']);}}function stopPythonService(_0x1636ea){const _0x35284b=a0_0x416b61;if(_0x1636ea[_0x35284b(0xc2)]){_0x1636ea[_0x35284b(0xb0)]['info']('ðŸ\x20Stopping\x20Python\x20Sidecar...');try{_0x1636ea[_0x35284b(0xc2)][_0x35284b(0x1fd)]();}catch(_0x21e079){_0x1636ea[_0x35284b(0xb0)][_0x35284b(0x1ad)](_0x35284b(0x114)+_0x21e079[_0x35284b(0x1b3)]);}_0x1636ea[_0x35284b(0xc2)]=null;}}class CogniLiving extends utils[a0_0x416b61(0x169)]{constructor(_0x4c5870){const _0x4b7850=a0_0x416b61;super({..._0x4c5870,'name':'cogni-living'}),this[_0x4b7850(0x123)]=[],this[_0x4b7850(0x1a8)]=[],this[_0x4b7850(0x181)]=[],this[_0x4b7850(0x11f)]=[],this[_0x4b7850(0x1df)]=[],this['sensorLastValues']={},this[_0x4b7850(0x1ee)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x4b7850(0xdf)]=null,this[_0x4b7850(0x265)]=null,this[_0x4b7850(0x22c)]=![],this[_0x4b7850(0x25e)]=null,this['geminiModel']=null,this[_0x4b7850(0x1f5)]=SYSTEM_MODES[_0x4b7850(0x17c)],this[_0x4b7850(0x267)]=![],this[_0x4b7850(0xab)]=![],this[_0x4b7850(0x1da)]=_0x4b7850(0xf6),this[_0x4b7850(0x1f4)]=null,this['ltmJob']=null,this[_0x4b7850(0x1c8)]=null,this[_0x4b7850(0x85)]=null,this[_0x4b7850(0x15f)]=null,this[_0x4b7850(0xc2)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x4b7850(0x254),this[_0x4b7850(0x201)]['bind'](this)),this['on'](_0x4b7850(0x18a),this['onStateChange'][_0x4b7850(0x90)](this)),this['on'](_0x4b7850(0x15d),this[_0x4b7850(0x1e3)][_0x4b7850(0x90)](this)),this['on'](_0x4b7850(0x1b3),this['onMessage'][_0x4b7850(0x90)](this));}async[a0_0x416b61(0x201)](){const _0x37e66e=a0_0x416b61;this[_0x37e66e(0xb0)]['info'](_0x37e66e(0x196)+this[_0x37e66e(0x228)]+')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE'),await initZombies(this),this[_0x37e66e(0xa5)][_0x37e66e(0x209)]=this[_0x37e66e(0xa5)][_0x37e66e(0x209)]||'';try{this['isProVersion']=await checkLicense(this,this[_0x37e66e(0xa5)][_0x37e66e(0x209)]);}catch(_0x564529){}if(!this[_0x37e66e(0xa5)]['inactivityThresholdHours']||this[_0x37e66e(0xa5)][_0x37e66e(0x119)]<0.1)this[_0x37e66e(0xa5)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x37e66e(0xa5)][_0x37e66e(0xe9)])try{this[_0x37e66e(0x25e)]=new GoogleGenerativeAI(this[_0x37e66e(0xa5)][_0x37e66e(0xe9)]),this[_0x37e66e(0x232)]=this[_0x37e66e(0x25e)][_0x37e66e(0x178)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x37e66e(0x88)}}),this['log'][_0x37e66e(0x203)](_0x37e66e(0x253));}catch(_0x42fe6e){this[_0x37e66e(0xb0)]['error']('Gemini\x20Init\x20Error:\x20'+_0x42fe6e[_0x37e66e(0x1b3)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x37e66e(0x1ca)](_0x37e66e(0xad)),this[_0x37e66e(0x1ca)](LTM_DP_TRIGGER_DIGEST),this[_0x37e66e(0x1ca)]('system.mode'),this[_0x37e66e(0x1ca)]('analysis.triggerBriefing'),this[_0x37e66e(0x1ca)](_0x37e66e(0x24c)),this[_0x37e66e(0x1ca)](_0x37e66e(0x25d)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x37e66e(0x1f4)])clearInterval(this[_0x37e66e(0x1f4)]);const _0x38338f=this[_0x37e66e(0xa5)][_0x37e66e(0x1e0)]||0xf;_0x38338f>0x0&&(this['log'][_0x37e66e(0x203)]('Starting\x20Autopilot\x20('+_0x38338f+'\x20min).'),this['analysisTimer']=setInterval(()=>{runAutopilot(this);},_0x38338f*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x36d3dd=_0x37e66e;this[_0x36d3dd(0xc2)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x416b61(0x1e3)](_0x3b7ac5){const _0x410039=a0_0x416b61;if(this[_0x410039(0x1f4)])clearInterval(this[_0x410039(0x1f4)]);if(this[_0x410039(0x85)])clearInterval(this[_0x410039(0x85)]);if(this[_0x410039(0x145)])this[_0x410039(0x145)][_0x410039(0x27e)]();if(this['modeResetJob'])this[_0x410039(0x1c8)][_0x410039(0x27e)]();if(this[_0x410039(0x15f)])this[_0x410039(0x15f)]['cancel']();if(this[_0x410039(0xdf)])clearTimeout(this[_0x410039(0xdf)]);if(this['exitGraceTimer'])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x3b7ac5();}async['onStateChange'](_0x240bf3,_0x4698ee){const _0x3f5bbe=a0_0x416b61;if(!_0x4698ee)return;if(_0x240bf3[_0x3f5bbe(0x272)](_0x3f5bbe(0x15c))&&_0x240bf3[_0x3f5bbe(0x11b)](_0x3f5bbe(0x19b))&&_0x4698ee[_0x3f5bbe(0x154)]){await handleTelegramResponse(this,_0x4698ee['val']);return;}if(_0x240bf3===this['namespace']+'.'+SYSTEM_DP_MODE){_0x4698ee['val']&&Object[_0x3f5bbe(0x20d)](SYSTEM_MODES)[_0x3f5bbe(0x272)](_0x4698ee[_0x3f5bbe(0x154)])&&(this[_0x3f5bbe(0x1f5)]=_0x4698ee[_0x3f5bbe(0x154)],_0x4698ee[_0x3f5bbe(0x154)]===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x4698ee[_0x3f5bbe(0x10e)])this[_0x3f5bbe(0x1f1)](_0x240bf3,{'val':this[_0x3f5bbe(0x1f5)],'ack':!![]});return;}if(!_0x4698ee[_0x3f5bbe(0x10e)]){_0x240bf3[_0x3f5bbe(0x272)](_0x3f5bbe(0xad))&&_0x4698ee[_0x3f5bbe(0x154)]&&(this[_0x3f5bbe(0x1f1)](_0x240bf3,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x240bf3['includes']('triggerDailyDigest')&&_0x4698ee[_0x3f5bbe(0x154)]){this['setState'](_0x240bf3,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x240bf3['includes'](_0x3f5bbe(0x1eb))&&_0x4698ee[_0x3f5bbe(0x154)]&&(this['setState'](_0x240bf3,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x240bf3[_0x3f5bbe(0x272)](_0x3f5bbe(0xc4))&&_0x4698ee[_0x3f5bbe(0x154)]&&(this[_0x3f5bbe(0x1f1)](_0x240bf3,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x3f5bbe(0xa5)][_0x3f5bbe(0x1e5)]&&this[_0x3f5bbe(0xa5)][_0x3f5bbe(0x1e5)][_0x3f5bbe(0x272)](_0x240bf3)){await checkWifiPresence(this);return;}const _0x4ad5dc=(this[_0x3f5bbe(0xa5)][_0x3f5bbe(0x18b)]||[])[_0x3f5bbe(0xe1)](_0xf0d3fa=>_0xf0d3fa['id']===_0x240bf3);if(_0x4ad5dc)processSensorEvent(this,_0x240bf3,_0x4698ee,_0x4ad5dc);}async[a0_0x416b61(0x1f7)](_0x1de8fa){const _0x56f7c5=a0_0x416b61;if(typeof _0x1de8fa==='object'&&_0x1de8fa[_0x56f7c5(0x1b3)])try{if(_0x1de8fa['command']===_0x56f7c5(0x189)){const _0xe62e99=_0x1de8fa[_0x56f7c5(0x1b3)][_0x56f7c5(0x134)]||this[_0x56f7c5(0xa5)][_0x56f7c5(0xe9)];if(!_0xe62e99)return this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':![],'message':_0x56f7c5(0x80)},_0x1de8fa[_0x56f7c5(0x11a)]);try{const _0x3a0855=new GoogleGenerativeAI(_0xe62e99),_0x4c823b=_0x3a0855[_0x56f7c5(0x178)]({'model':GEMINI_MODEL}),_0x1c1483=await _0x4c823b[_0x56f7c5(0xd4)]('Say\x20Hello'),_0x33e189=await _0x1c1483[_0x56f7c5(0x260)],_0x33f223=_0x33e189[_0x56f7c5(0x190)]();this['sendTo'](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa['command'],{'success':!![],'message':_0x56f7c5(0x259)+_0x33f223[_0x56f7c5(0x10b)](0x0,0x14)+_0x56f7c5(0x1c7)},_0x1de8fa[_0x56f7c5(0x11a)]);}catch(_0x5d5f4e){this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':![],'message':_0x56f7c5(0x100)+_0x5d5f4e[_0x56f7c5(0x1b3)]},_0x1de8fa[_0x56f7c5(0x11a)]);}}else{if(_0x1de8fa[_0x56f7c5(0x8b)]==='testContext'){const _0x5bc2ed=await getWeatherContext(this),_0x3aaf2f=await getCalendarContext(this);this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':!![],'weather':_0x5bc2ed,'calendar':_0x3aaf2f},_0x1de8fa['callback']);}else{if(_0x1de8fa[_0x56f7c5(0x8b)]===_0x56f7c5(0xce)){}else{if(_0x1de8fa[_0x56f7c5(0x8b)]===_0x56f7c5(0x20e)){if(!this['isProVersion'])return this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa['command'],{'success':![],'isPro':![]},_0x1de8fa[_0x56f7c5(0x11a)]);let _0x13568c={'status':_0x56f7c5(0x174),'details':'','lastCheck':0x0};try{_0x13568c[_0x56f7c5(0x1c4)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x56f7c5(0x154)],_0x13568c[_0x56f7c5(0xe4)]=(await this[_0x56f7c5(0x194)](LTM_DP_DRIFT_DETAILS))[_0x56f7c5(0x154)],_0x13568c[_0x56f7c5(0xff)]=(await this[_0x56f7c5(0x194)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0xa70ced){}const _0x8e09c6=this[_0x56f7c5(0x1a8)]||[];this[_0x56f7c5(0xf3)](_0x1de8fa['from'],_0x1de8fa[_0x56f7c5(0x8b)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x13568c,'analysisHistory':_0x8e09c6},_0x1de8fa[_0x56f7c5(0x11a)]);}else{if(_0x1de8fa[_0x56f7c5(0x8b)]===_0x56f7c5(0x166)){const _0x24479=this[_0x56f7c5(0x1df)][_0x56f7c5(0xc0)],_0x1b3bc5=new Date(),_0x66b70f=new Date(_0x1b3bc5[_0x56f7c5(0x23b)](),_0x1b3bc5['getMonth'](),_0x1b3bc5[_0x56f7c5(0x261)]())[_0x56f7c5(0xa2)](),_0x3e0e9f=this[_0x56f7c5(0x11f)][_0x56f7c5(0x133)](_0x45075a=>new Date(_0x45075a[_0x56f7c5(0xfa)])['getTime']()>_0x66b70f)[_0x56f7c5(0xc0)],_0x484dc0=new Array(0x18)[_0x56f7c5(0x26e)](0x0);this['rawEventLog'][_0x56f7c5(0x10f)](_0x1fcb57=>{const _0x2c4f1d=_0x56f7c5,_0x1583c3=new Date(_0x1fcb57[_0x2c4f1d(0xfa)]);if(_0x1583c3['getTime']()>_0x66b70f)_0x484dc0[_0x1583c3[_0x2c4f1d(0x106)]()]++;});let _0x4bf8b7={'status':_0x56f7c5(0x174)};try{_0x4bf8b7[_0x56f7c5(0x1c4)]=(await this[_0x56f7c5(0x194)](LTM_DP_DRIFT_STATUS))[_0x56f7c5(0x154)];}catch(_0x550f3e){}let _0x3e7cbe='';try{const _0x2d773b=await this[_0x56f7c5(0x194)](_0x56f7c5(0x15e));_0x3e7cbe=_0x2d773b?_0x2d773b['val']:'';}catch(_0x31a498){}let _0x19c5d3=null;!this[_0x56f7c5(0x232)]&&(_0x19c5d3=this[_0x56f7c5(0xa5)][_0x56f7c5(0xe9)]?_0x56f7c5(0x244):_0x56f7c5(0x22a));let _0x5c2e5e={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x449039=await this[_0x56f7c5(0x194)]('analysis.automation.patternDetected'),_0x25373f=await this[_0x56f7c5(0x194)](_0x56f7c5(0xeb)),_0x3e7a5d=await this[_0x56f7c5(0x194)](_0x56f7c5(0x217)),_0x47011f=await this[_0x56f7c5(0x194)](_0x56f7c5(0x1c3)),_0xaba85d=await this[_0x56f7c5(0x194)](_0x56f7c5(0x25d));_0x449039&&_0x449039['val']&&(_0x5c2e5e['detected']=!![],_0x5c2e5e[_0x56f7c5(0xae)]=_0x25373f?_0x25373f['val']:'',_0x5c2e5e[_0x56f7c5(0x1b8)]=_0x3e7a5d?_0x3e7a5d[_0x56f7c5(0x154)]:'',_0x5c2e5e['targetValue']=_0x47011f?_0x47011f[_0x56f7c5(0x154)]:''),_0x5c2e5e['autoApply']=_0xaba85d?!!_0xaba85d[_0x56f7c5(0x154)]:![];}catch(_0x488eb7){}this[_0x56f7c5(0xf3)](_0x1de8fa['from'],_0x1de8fa[_0x56f7c5(0x8b)],{'success':!![],'eventHistory':this[_0x56f7c5(0x123)]['slice'](0x0,0xf),'stats':{'digestCount':_0x24479,'eventCountToday':_0x3e0e9f,'hourlyActivity':_0x484dc0,'driftStatus':_0x4bf8b7[_0x56f7c5(0x1c4)],'isPresent':this[_0x56f7c5(0x202)],'presenceWho':_0x3e7cbe,'minDays':this[_0x56f7c5(0xa5)][_0x56f7c5(0xaa)]||0x7,'stbDays':this['config'][_0x56f7c5(0x1c9)]||0xe,'ltbDays':this[_0x56f7c5(0xa5)][_0x56f7c5(0x251)]||0x3c,'systemError':_0x19c5d3},'automation':_0x5c2e5e},_0x1de8fa[_0x56f7c5(0x11a)]);}else{if(_0x1de8fa[_0x56f7c5(0x8b)]===_0x56f7c5(0x1f6)){const _0x10436f=await this[_0x56f7c5(0xfe)](_0x56f7c5(0x200),'enum'),_0x4ac795=[];if(_0x10436f)for(const _0x5946b5 in _0x10436f){const _0x24c958=_0x10436f[_0x5946b5],_0x3619ed=(_0x24c958[_0x56f7c5(0x105)]&&typeof _0x24c958[_0x56f7c5(0x105)][_0x56f7c5(0x245)]===_0x56f7c5(0x247)?_0x24c958[_0x56f7c5(0x105)][_0x56f7c5(0x245)]['de']:_0x24c958[_0x56f7c5(0x105)][_0x56f7c5(0x245)])||_0x24c958[_0x56f7c5(0x105)][_0x56f7c5(0x245)];_0x4ac795[_0x56f7c5(0x180)]({'id':_0x5946b5,'name':_0x3619ed});}this['sendTo'](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa['command'],{'success':!![],'enums':_0x4ac795},_0x1de8fa[_0x56f7c5(0x11a)]);}else{if(_0x1de8fa[_0x56f7c5(0x8b)]===_0x56f7c5(0x1f0))try{const _0xfd7411=await scanForDevices(this,_0x1de8fa[_0x56f7c5(0x1b3)]||{});this['sendTo'](_0x1de8fa['from'],_0x1de8fa[_0x56f7c5(0x8b)],{'success':!![],'devices':_0xfd7411},_0x1de8fa[_0x56f7c5(0x11a)]);}catch(_0x299c50){this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':![],'error':_0x299c50[_0x56f7c5(0x1b3)]},_0x1de8fa[_0x56f7c5(0x11a)]);}else{if(_0x1de8fa[_0x56f7c5(0x8b)]===_0x56f7c5(0x1bc)){const _0x475735=_0x1de8fa['message'][_0x56f7c5(0x1e6)];if(!_0x475735)return this[_0x56f7c5(0xf3)](_0x1de8fa['from'],_0x1de8fa[_0x56f7c5(0x8b)],{'success':![],'error':'No\x20instance'},_0x1de8fa[_0x56f7c5(0x11a)]);const _0x632bdc=await getCalendarNames(this,_0x475735);this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':!![],'names':_0x632bdc},_0x1de8fa[_0x56f7c5(0x11a)]);}else{if(_0x1de8fa[_0x56f7c5(0x8b)]===_0x56f7c5(0x1c6)){const {targetId:_0x48b7a8,targetValue:_0x8d9f25}=_0x1de8fa[_0x56f7c5(0x1b3)];this[_0x56f7c5(0xb0)][_0x56f7c5(0x203)](_0x56f7c5(0x117)+_0x48b7a8+_0x56f7c5(0x1ea)+_0x8d9f25),await this['setStateAsync'](_0x56f7c5(0x257),{'val':!![],'ack':!![]}),await this[_0x56f7c5(0x238)](_0x56f7c5(0xeb),{'val':_0x56f7c5(0x89)+_0x48b7a8,'ack':!![]}),await this['setStateAsync'](_0x56f7c5(0x217),{'val':_0x48b7a8,'ack':!![]}),await this[_0x56f7c5(0x238)](_0x56f7c5(0x1c3),{'val':_0x8d9f25,'ack':!![]}),this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa['command'],{'success':!![]},_0x1de8fa[_0x56f7c5(0x11a)]);}else{if(_0x1de8fa['command']===_0x56f7c5(0x1fc)){const {historyId:_0x3bfa03,rating:_0x12551a,comment:_0x2df9c6,alertReason:_0x2aaeb9}=_0x1de8fa[_0x56f7c5(0x1b3)];_0x3bfa03&&_0x12551a?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x3bfa03,'rating':_0x12551a,'comment':_0x2df9c6,'alertReason':_0x2aaeb9}),this['sendTo'](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':!![]},_0x1de8fa['callback'])):this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':![],'error':_0x56f7c5(0x1fb)},_0x1de8fa[_0x56f7c5(0x11a)]);}else _0x1de8fa[_0x56f7c5(0x8b)]===_0x56f7c5(0x110)&&(this['log'][_0x56f7c5(0x203)](_0x56f7c5(0x171)),await this[_0x56f7c5(0x238)](_0x56f7c5(0x257),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x56f7c5(0xeb),{'val':'','ack':!![]}),this[_0x56f7c5(0xf3)](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':!![]},_0x1de8fa[_0x56f7c5(0x11a)]));}}}}}}}}}}catch(_0x329781){this[_0x56f7c5(0xb0)][_0x56f7c5(0x26d)](_0x56f7c5(0xa0)+_0x1de8fa[_0x56f7c5(0x8b)]+':\x20'+_0x329781[_0x56f7c5(0x1b3)]);if(_0x1de8fa[_0x56f7c5(0x11a)])this['sendTo'](_0x1de8fa[_0x56f7c5(0x208)],_0x1de8fa[_0x56f7c5(0x8b)],{'success':![],'error':_0x329781['message']},_0x1de8fa['callback']);}}}if(require[a0_0x416b61(0xe7)]!==module)module['exports']=_0x92b547=>new CogniLiving(_0x92b547);else new CogniLiving();