const a0_0x2eaee0=a0_0x3395;(function(_0x44a114,_0x394539){const _0x33482f=a0_0x3395,_0x4b81ca=_0x44a114();while(!![]){try{const _0x3b8e2c=parseInt(_0x33482f(0x249))/0x1+parseInt(_0x33482f(0x26a))/0x2*(parseInt(_0x33482f(0x274))/0x3)+parseInt(_0x33482f(0x1d6))/0x4*(-parseInt(_0x33482f(0x240))/0x5)+parseInt(_0x33482f(0x25a))/0x6+parseInt(_0x33482f(0x228))/0x7*(parseInt(_0x33482f(0x27f))/0x8)+-parseInt(_0x33482f(0x203))/0x9*(-parseInt(_0x33482f(0x28a))/0xa)+-parseInt(_0x33482f(0x211))/0xb*(parseInt(_0x33482f(0x21d))/0xc);if(_0x3b8e2c===_0x394539)break;else _0x4b81ca['push'](_0x4b81ca['shift']());}catch(_0x21b411){_0x4b81ca['push'](_0x4b81ca['shift']());}}}(a0_0x12a9,0x6e331));function a0_0x12a9(){const _0x568329=['enum.rooms.*','forEach','ready','SYSTEM_MODES','analysis.topology.structure','ANALYZE_GAIT','namespace','command','onStateChange','toString','createDailyDigest','minDaysForBaseline','from','analysisHistory','weatherInstance','PREDICT_ENERGY','SYSTEM_DP_MODE','387YharMN','isGracePeriodActive','log','enum','cogni-living\x20adapter\x20starting\x20(v','triggerEnergyPrediction','parse','scanDevices','endsWith','testApiKey','initSystemConfig','subscribeForeignStatesAsync','.system.mode','onUnload','737SxkeNj','_calName','fill','find','Daten\x20nicht\x20verfÃ¼gbar','ack','timestamp','activityLevel','(((.+)+)+)+$','Standard','scanForDevices','setupBriefingScheduler','258252VZWmaw','eventHistory','geminiApiKey','getMinutes','setState','getForeignObjectAsync','devices','genAI','cancel','getForeignObjectsAsync','callback','7oxAmsr','common','map','getLtmData','setStateAsync','triggerBriefing','automation.triggerAction','system.adapter.','constructor','Aktiv\x20(','isPresent','name','sensorLastValues','NORMAL','startSystem','inactivityThresholdHours','notifyTelegramInstance','sendNotification','calendarName','notifyTelegramEnabled','isProVersion','testContext','analysis.training.triggerEnergy','Gemini\x20AI\x20initialized.','15LTeiKH','toLowerCase','runPythonHealthCheck','./lib/dead_man','geminiModel','unload','LTM.baselineStatus','analysis.training.triggerSecurity','enum.functions.*','735064aFfjEb','LTM.rawEventLog','error','subscribeStates','abortExitTimer','presenceDevices','checkWifiPresence','system.presenceWho','LTM.dailyDigests','Kein\x20Wetter-Adapter','runGeminiAnalysis','analysisTimer','setHours','val','getHours','LTM.triggerDailyDigest','startService','1237284scrJeu','systemConfig','setupModeResetScheduler','debug','setupDriftAnalysisScheduler','checkAndInstall','lastAlertState','type','WiFi\x20Presence\x20detected.','triggerDailyDigest','getGenerativeModel','response','online','LTM.trainingData.sequences','getTime','modeResetJob','2GkVdcU','analysis.training.triggerComfort','updateTopology','./lib/python_bridge','onReady','cogni-living','./lib/installer','analysis.automation.triggerAction','message','updateLocation','1396659vEdOVw','Lernphase\x20(','getEnums','analysisInterval','analysis.training.triggerTopology','setPresence','getOutsideTemperatureNumeric','application/json','runAutopilot','currentSystemMode','dependencyInstallInProgress','4825096KzAotD','config','analysis.trigger','runBaselineDriftAnalysis','analysis.automation.autoApply','sendTo','executeAutomationAction','motion','exports','text','./lib/topology','48610rlAwGD','initZombies','generateContent','getForeignStateAsync','rawEventLog','getStateAsync','values','setupLtmScheduler','info','.communicate.request','briefingJob','communicate.request','\x20Tage)','add','analysis.training.triggerHealth','getCalendarNames','TRAIN_SECURITY','PYTHON_EXE','temperature','exitGraceTimer','Test','Gesendet','isArray','getOverviewData','initHistory','./lib/recorder','bind','pop','testNotification','updateTopologyMatrix','getState','system.mode','./lib/setup','Notification\x20Test\x20Failed:\x20','exitTimer','updated','Instanz\x20nicht\x20gefunden','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','stopService','Verbindung\x20erfolgreich!','Kein\x20API\x20Key\x20Ã¼bergeben','434276Pjrdxc','push','TRAIN_HEALTH','SET_TOPOLOGY','updateHealthVector','location','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','Adapter','keys','send','createAllObjects','triggerGaitAnalysis','dailyDigests','calendarInstance',')\x20-\x20Phase\x20C\x20(Hardened)','sendMorningBriefing','LTM.trainingData.thermodynamics','length','search','includes','Sec-Training\x20started...','analysis.training.status','VACATION','sort','stateChange','object','stringify','analysis.triggerBriefing'];a0_0x12a9=function(){return _0x568329;};return a0_0x12a9();}const a0_0x2fcf40=(function(){let _0x32b992=!![];return function(_0x4e8a66,_0x54cada){const _0x52bd5f=_0x32b992?function(){if(_0x54cada){const _0x11f334=_0x54cada['apply'](_0x4e8a66,arguments);return _0x54cada=null,_0x11f334;}}:function(){};return _0x32b992=![],_0x52bd5f;};}()),a0_0x3a7f97=a0_0x2fcf40(this,function(){const _0x231297=a0_0x3395;return a0_0x3a7f97['toString']()[_0x231297(0x1e8)](_0x231297(0x219))[_0x231297(0x1fb)]()[_0x231297(0x230)](a0_0x3a7f97)[_0x231297(0x1e8)]('(((.+)+)+)+$');});a0_0x3a7f97();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),installer=require(a0_0x2eaee0(0x270)),scanner=require('./lib/scanner'),schedulers=require('./lib/scheduler'),topology=require(a0_0x2eaee0(0x289)),setup=require(a0_0x2eaee0(0x1cd)),recorder=require(a0_0x2eaee0(0x1c6)),pythonBridge=require(a0_0x2eaee0(0x26d)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x2eaee0(0x243)),GEMINI_MODEL='models/gemini-flash-latest',ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};function a0_0x3395(_0x133ae3,_0x249233){const _0xf36b8a=a0_0x12a9();return a0_0x3395=function(_0x3a7f97,_0x2fcf40){_0x3a7f97=_0x3a7f97-0x1b3;let _0x12a9b6=_0xf36b8a[_0x3a7f97];return _0x12a9b6;},a0_0x3395(_0x133ae3,_0x249233);}class CogniLiving extends utils[a0_0x2eaee0(0x1dd)]{constructor(_0x7d4e14){const _0x47877d=a0_0x2eaee0;super({..._0x7d4e14,'name':_0x47877d(0x26f)}),this[_0x47877d(0x21e)]=[],this[_0x47877d(0x1ff)]=[],this['rawEventLog']=[],this['dailyDigests']=[],this['sensorLastValues']={},this[_0x47877d(0x25b)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x47877d(0x232)]=!![],this[_0x47877d(0x1cf)]=null,this[_0x47877d(0x1c0)]=null,this[_0x47877d(0x204)]=![],this[_0x47877d(0x224)]=null,this[_0x47877d(0x244)]=null,this['currentSystemMode']=setup[_0x47877d(0x1f5)][_0x47877d(0x235)],this[_0x47877d(0x23c)]=![],this[_0x47877d(0x260)]=![],this[_0x47877d(0x254)]=null,this['ltmJob']=null,this[_0x47877d(0x269)]=null,this['driftAnalysisTimer']=null,this[_0x47877d(0x1b7)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x47877d(0x1f4),this['onReady']['bind'](this)),this['on'](_0x47877d(0x1ee),this[_0x47877d(0x1fa)][_0x47877d(0x1c7)](this)),this['on'](_0x47877d(0x245),this[_0x47877d(0x210)][_0x47877d(0x1c7)](this)),this['on']('message',this['onMessage'][_0x47877d(0x1c7)](this));}async[a0_0x2eaee0(0x26e)](){const _0x3ffc53=a0_0x2eaee0;this['log']['info'](_0x3ffc53(0x207)+this['version']+_0x3ffc53(0x1e4));if(!installer[_0x3ffc53(0x25f)](this,()=>this[_0x3ffc53(0x236)]()))return;}async[a0_0x2eaee0(0x236)](){const _0x5b7350=a0_0x2eaee0;await setup[_0x5b7350(0x28b)](this);try{this['isProVersion']=await setup['checkLicense'](this[_0x5b7350(0x280)]['licenseKey']);}catch(_0x341e76){}if(!this['config'][_0x5b7350(0x237)]||this[_0x5b7350(0x280)]['inactivityThresholdHours']<0.1)this['config'][_0x5b7350(0x237)]=0xc;await setup[_0x5b7350(0x1c5)](this),await setup[_0x5b7350(0x20d)](this);if(this['config']['geminiApiKey'])try{this[_0x5b7350(0x224)]=new GoogleGenerativeAI(this[_0x5b7350(0x280)][_0x5b7350(0x21f)]),this[_0x5b7350(0x244)]=this[_0x5b7350(0x224)][_0x5b7350(0x264)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5b7350(0x27b)}}),this[_0x5b7350(0x205)]['info'](_0x5b7350(0x23f));}catch(_0x400dfb){this[_0x5b7350(0x205)][_0x5b7350(0x24b)]('Gemini\x20Init\x20Error:\x20'+_0x400dfb['message']);}await setup[_0x5b7350(0x1e0)](this),await this['loadSystemMode']();try{const _0x12316d=await this['getStateAsync'](_0x5b7350(0x24a));if(_0x12316d&&_0x12316d[_0x5b7350(0x256)])this[_0x5b7350(0x28e)]=JSON[_0x5b7350(0x209)](_0x12316d['val']);}catch(_0x340642){this[_0x5b7350(0x28e)]=[];}try{const _0x2fde1d=await this[_0x5b7350(0x28f)]('LTM.dailyDigests');if(_0x2fde1d&&_0x2fde1d[_0x5b7350(0x256)])this[_0x5b7350(0x1e2)]=JSON[_0x5b7350(0x209)](_0x2fde1d[_0x5b7350(0x256)]);}catch(_0x4ad7da){this[_0x5b7350(0x1e2)]=[];}const _0x43adf7=this['dailyDigests'][_0x5b7350(0x1e7)]>=(this[_0x5b7350(0x280)][_0x5b7350(0x1fd)]||0x7)?_0x5b7350(0x231)+this[_0x5b7350(0x1e2)][_0x5b7350(0x1e7)]+_0x5b7350(0x1b9):_0x5b7350(0x275)+this[_0x5b7350(0x1e2)][_0x5b7350(0x1e7)]+'/'+(this[_0x5b7350(0x280)][_0x5b7350(0x1fd)]||0x7)+')';await this['setStateAsync'](_0x5b7350(0x246),{'val':_0x43adf7,'ack':!![]}),this[_0x5b7350(0x24c)](_0x5b7350(0x281)),this['subscribeStates'](_0x5b7350(0x258)),this[_0x5b7350(0x24c)](_0x5b7350(0x1cc)),this[_0x5b7350(0x24c)](_0x5b7350(0x1f1)),this[_0x5b7350(0x24c)](_0x5b7350(0x271)),this[_0x5b7350(0x24c)](_0x5b7350(0x283)),this[_0x5b7350(0x24c)](_0x5b7350(0x247)),this['subscribeStates'](_0x5b7350(0x1bb)),this[_0x5b7350(0x24c)](_0x5b7350(0x23e)),this[_0x5b7350(0x24c)](_0x5b7350(0x26b)),this['subscribeStates'](_0x5b7350(0x278));const _0x3c7a9d=this['config'][_0x5b7350(0x223)];if(_0x3c7a9d)for(const _0x61a4e8 of _0x3c7a9d){await this['subscribeForeignStatesAsync'](_0x61a4e8['id']);}const _0x101389=this[_0x5b7350(0x280)][_0x5b7350(0x24e)];if(_0x101389)for(const _0x64ad6d of _0x101389){await this[_0x5b7350(0x20e)](_0x64ad6d);}if(this['config'][_0x5b7350(0x23b)]&&this[_0x5b7350(0x280)]['notifyTelegramInstance'])await this[_0x5b7350(0x20e)](this[_0x5b7350(0x280)][_0x5b7350(0x238)]+_0x5b7350(0x1b6));setTimeout(()=>this[_0x5b7350(0x24f)](),0x1388);if(this[_0x5b7350(0x254)])clearInterval(this[_0x5b7350(0x254)]);const _0x5036fd=this[_0x5b7350(0x280)][_0x5b7350(0x277)]||0xf;_0x5036fd>0x0&&(this[_0x5b7350(0x254)]=setInterval(()=>{this['runAutopilot']();},_0x5036fd*0x3c*0x3e8)),schedulers[_0x5b7350(0x1b4)](this,()=>aiAgent[_0x5b7350(0x1fc)](this,pythonBridge)),schedulers[_0x5b7350(0x25c)](this),schedulers[_0x5b7350(0x25e)](this,()=>aiAgent[_0x5b7350(0x282)](this)),schedulers[_0x5b7350(0x21c)](this,()=>aiAgent[_0x5b7350(0x1e5)](this)),pythonBridge[_0x5b7350(0x259)](this,installer[_0x5b7350(0x1be)]),setTimeout(async()=>{const _0x59c97d=_0x5b7350;await topology[_0x59c97d(0x26c)](this);try{const _0x11fd5e=await this[_0x59c97d(0x28f)]('analysis.topology.structure');if(_0x11fd5e&&_0x11fd5e['val'])pythonBridge['send'](this,_0x59c97d(0x1d9),JSON[_0x59c97d(0x209)](_0x11fd5e[_0x59c97d(0x256)]));}catch(_0x4dfa4f){}this[_0x59c97d(0x242)](),this[_0x59c97d(0x1e1)](),this[_0x59c97d(0x208)](),this[_0x59c97d(0x1da)]();},0x1388);}[a0_0x2eaee0(0x210)](_0x117175){const _0x1bee9a=a0_0x2eaee0;if(this[_0x1bee9a(0x254)])clearInterval(this[_0x1bee9a(0x254)]);if(this['driftAnalysisTimer'])clearInterval(this['driftAnalysisTimer']);if(this['ltmJob'])this['ltmJob'][_0x1bee9a(0x225)]();if(this['modeResetJob'])this[_0x1bee9a(0x269)][_0x1bee9a(0x225)]();if(this[_0x1bee9a(0x1b7)])this[_0x1bee9a(0x1b7)][_0x1bee9a(0x225)]();recorder[_0x1bee9a(0x24d)](this),pythonBridge[_0x1bee9a(0x1d3)](this),_0x117175();}async[a0_0x2eaee0(0x1fa)](_0x29f05f,_0x13d6dd){const _0x567bfe=a0_0x2eaee0;if(!_0x13d6dd||this[_0x567bfe(0x27e)])return;if(_0x29f05f['includes']('telegram')&&_0x29f05f[_0x567bfe(0x20b)](_0x567bfe(0x1b8))&&_0x13d6dd['val'])return;if(_0x29f05f===this[_0x567bfe(0x1f8)]+_0x567bfe(0x20f)){if(_0x13d6dd[_0x567bfe(0x256)]&&Object['values'](setup[_0x567bfe(0x1f5)])['includes'](_0x13d6dd[_0x567bfe(0x256)])){this[_0x567bfe(0x27d)]=_0x13d6dd[_0x567bfe(0x256)];if(_0x13d6dd[_0x567bfe(0x256)]===setup[_0x567bfe(0x1f5)][_0x567bfe(0x1ec)])await recorder[_0x567bfe(0x279)](this,![]);else await recorder[_0x567bfe(0x279)](this,!![]);}if(!_0x13d6dd['ack'])this[_0x567bfe(0x221)](_0x29f05f,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x13d6dd[_0x567bfe(0x216)]){_0x29f05f['includes'](_0x567bfe(0x281))&&_0x13d6dd[_0x567bfe(0x256)]&&(this[_0x567bfe(0x221)](_0x29f05f,{'val':![],'ack':!![]}),aiAgent[_0x567bfe(0x253)](this));if(_0x29f05f[_0x567bfe(0x1e9)](_0x567bfe(0x263))&&_0x13d6dd[_0x567bfe(0x256)]){this[_0x567bfe(0x221)](_0x29f05f,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent[_0x567bfe(0x1fc)](this,pythonBridge);}_0x29f05f[_0x567bfe(0x1e9)](_0x567bfe(0x22d))&&_0x13d6dd['val']&&(this[_0x567bfe(0x221)](_0x29f05f,{'val':![],'ack':!![]}),aiAgent[_0x567bfe(0x1e5)](this));_0x29f05f[_0x567bfe(0x1e9)](_0x567bfe(0x22e))&&_0x13d6dd[_0x567bfe(0x256)]&&(this[_0x567bfe(0x221)](_0x29f05f,{'val':![],'ack':!![]}),aiAgent[_0x567bfe(0x285)](this));if(_0x29f05f['includes'](_0x567bfe(0x247))&&_0x13d6dd['val']){this[_0x567bfe(0x221)](_0x29f05f,{'val':![],'ack':!![]});if(this[_0x567bfe(0x23c)])try{const _0x3b1bd7=await this[_0x567bfe(0x28f)]('LTM.trainingData.sequences');if(_0x3b1bd7&&_0x3b1bd7['val']){const _0x5904e6=JSON[_0x567bfe(0x209)](_0x3b1bd7[_0x567bfe(0x256)]);this[_0x567bfe(0x22c)](_0x567bfe(0x1eb),{'val':_0x567bfe(0x1ea),'ack':!![]}),pythonBridge['send'](this,_0x567bfe(0x1bd),{'sequences':_0x5904e6});}}catch(_0x2ffbca){}}if(_0x29f05f[_0x567bfe(0x1e9)](_0x567bfe(0x1bb))&&_0x13d6dd['val']){this[_0x567bfe(0x221)](_0x29f05f,{'val':![],'ack':!![]});if(this[_0x567bfe(0x23c)])try{const _0xf44313=await this[_0x567bfe(0x28f)](_0x567bfe(0x251));if(_0xf44313&&_0xf44313[_0x567bfe(0x256)])pythonBridge[_0x567bfe(0x1df)](this,_0x567bfe(0x1d8),{'digests':JSON[_0x567bfe(0x209)](_0xf44313[_0x567bfe(0x256)])});}catch(_0x1aa729){}}if(_0x29f05f[_0x567bfe(0x1e9)](_0x567bfe(0x23e))&&_0x13d6dd['val']){this['setState'](_0x29f05f,{'val':![],'ack':!![]});if(this[_0x567bfe(0x23c)])try{const _0x56677c=await this[_0x567bfe(0x28f)](_0x567bfe(0x1e6));if(_0x56677c&&_0x56677c['val'])pythonBridge[_0x567bfe(0x1df)](this,'TRAIN_ENERGY',{'points':JSON[_0x567bfe(0x209)](_0x56677c['val'])});}catch(_0x130150){}}if(_0x29f05f['includes'](_0x567bfe(0x26b))&&_0x13d6dd[_0x567bfe(0x256)]){this['setState'](_0x29f05f,{'val':![],'ack':!![]});if(this[_0x567bfe(0x23c)])try{const _0x12de40=await this[_0x567bfe(0x28f)]('LTM.rawEventLog');if(_0x12de40&&_0x12de40[_0x567bfe(0x256)])pythonBridge[_0x567bfe(0x1df)](this,'TRAIN_COMFORT',{'events':JSON['parse'](_0x12de40['val'])});}catch(_0x37feb3){}}_0x29f05f[_0x567bfe(0x1e9)](_0x567bfe(0x278))&&_0x13d6dd[_0x567bfe(0x256)]&&(this[_0x567bfe(0x221)](_0x29f05f,{'val':![],'ack':!![]}),topology[_0x567bfe(0x26c)](this));return;}if(this[_0x567bfe(0x280)][_0x567bfe(0x24e)]&&this[_0x567bfe(0x280)][_0x567bfe(0x24e)]['includes'](_0x29f05f)){await this[_0x567bfe(0x24f)]();return;}const _0x3bf0ea=(this['config'][_0x567bfe(0x223)]||[])[_0x567bfe(0x214)](_0x3e8eaf=>_0x3e8eaf['id']===_0x29f05f);if(_0x3bf0ea){const _0x180cc3=await recorder['processSensorEvent'](this,_0x29f05f,_0x13d6dd,_0x3bf0ea);_0x180cc3&&_0x180cc3[_0x567bfe(0x261)]===_0x567bfe(0x286)&&_0x180cc3[_0x567bfe(0x1db)]&&this[_0x567bfe(0x23c)]&&deadMan[_0x567bfe(0x273)](this,_0x180cc3[_0x567bfe(0x1db)]);}}async['onMessage'](_0x185423){const _0x2ffad9=a0_0x2eaee0;if(typeof _0x185423===_0x2ffad9(0x1ef)&&_0x185423['message']){if(_0x185423[_0x2ffad9(0x1f9)]===_0x2ffad9(0x20c))try{const _0x5d0d4d=_0x185423[_0x2ffad9(0x272)]['apiKey'];if(!_0x5d0d4d)throw new Error(_0x2ffad9(0x1d5));const _0x403f53=new GoogleGenerativeAI(_0x5d0d4d),_0xb58692=_0x403f53[_0x2ffad9(0x264)]({'model':GEMINI_MODEL}),_0x430024=await _0xb58692[_0x2ffad9(0x28c)](_0x2ffad9(0x1c1)),_0x456f11=await _0x430024[_0x2ffad9(0x265)];if(_0x456f11[_0x2ffad9(0x288)]())this[_0x2ffad9(0x284)](_0x185423[_0x2ffad9(0x1fe)],_0x185423['command'],{'success':!![],'message':_0x2ffad9(0x1d4)},_0x185423[_0x2ffad9(0x227)]);else throw new Error('Keine\x20Antwort\x20von\x20Gemini');}catch(_0x5c99a3){this[_0x2ffad9(0x284)](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':![],'message':_0x5c99a3[_0x2ffad9(0x272)]},_0x185423[_0x2ffad9(0x227)]);}else{if(_0x185423[_0x2ffad9(0x1f9)]===_0x2ffad9(0x20a))try{const _0x48fff6=await scanner[_0x2ffad9(0x21b)](this,_0x185423[_0x2ffad9(0x272)]||{});this[_0x2ffad9(0x284)](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':!![],'devices':_0x48fff6},_0x185423[_0x2ffad9(0x227)]);}catch(_0x1e97b6){this[_0x2ffad9(0x284)](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':![],'error':_0x1e97b6[_0x2ffad9(0x272)]},_0x185423[_0x2ffad9(0x227)]);}else{if(_0x185423[_0x2ffad9(0x1f9)]===_0x2ffad9(0x1ca))try{const {matrix:_0x33b0a1}=_0x185423[_0x2ffad9(0x272)],_0x1218c8=await this['getStateAsync'](_0x2ffad9(0x1f6));if(_0x1218c8&&_0x1218c8[_0x2ffad9(0x256)]){const _0x3f02c0=JSON['parse'](_0x1218c8[_0x2ffad9(0x256)]);_0x3f02c0['matrix']=_0x33b0a1,_0x3f02c0[_0x2ffad9(0x1d0)]=Date['now'](),await this[_0x2ffad9(0x22c)](_0x2ffad9(0x1f6),{'val':JSON[_0x2ffad9(0x1f0)](_0x3f02c0),'ack':!![]}),pythonBridge[_0x2ffad9(0x1df)](this,'SET_TOPOLOGY',_0x3f02c0);}this[_0x2ffad9(0x284)](_0x185423['from'],_0x185423[_0x2ffad9(0x1f9)],{'success':!![]},_0x185423[_0x2ffad9(0x227)]);}catch(_0x121049){this[_0x2ffad9(0x205)][_0x2ffad9(0x24b)](_0x121049);}else{if(_0x185423[_0x2ffad9(0x1f9)]===_0x2ffad9(0x22b))this[_0x2ffad9(0x284)](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':!![],'dailyDigests':this[_0x2ffad9(0x1e2)]||[],'analysisHistory':this[_0x2ffad9(0x1ff)]||[]},_0x185423[_0x2ffad9(0x227)]);else{if(_0x185423['command']===_0x2ffad9(0x1c4)){const _0x57b47a=this[_0x2ffad9(0x1e2)][_0x2ffad9(0x1e7)],_0x2661bf=new Array(0x18)[_0x2ffad9(0x213)](0x0),_0x3b65e9=new Date()[_0x2ffad9(0x255)](0x0,0x0,0x0,0x0);this['eventHistory']&&this['eventHistory'][_0x2ffad9(0x1f3)](_0x53cc1d=>{const _0x3959a9=_0x2ffad9;if(_0x53cc1d[_0x3959a9(0x217)]>=_0x3b65e9){const _0x2aeb8c=new Date(_0x53cc1d[_0x3959a9(0x217)])[_0x3959a9(0x257)]();if(_0x2aeb8c>=0x0&&_0x2aeb8c<0x18)_0x2661bf[_0x2aeb8c]++;}}),this['sendTo'](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':!![],'eventHistory':this[_0x2ffad9(0x21e)]['slice'](0x0,0xf),'stats':{'digestCount':_0x57b47a,'isPresent':this['isPresent'],'hourlyActivity':_0x2661bf},'automation':{'detected':![]}},_0x185423['callback']);}else{if(_0x185423[_0x2ffad9(0x1f9)]===_0x2ffad9(0x276)){const _0x127706=await this[_0x2ffad9(0x226)](_0x2ffad9(0x248),_0x2ffad9(0x206)),_0x2dd9aa=[];if(_0x127706)for(const _0x534509 in _0x127706){const _0x4ba885=_0x127706[_0x534509],_0x22b651=(_0x4ba885[_0x2ffad9(0x229)]&&typeof _0x4ba885['common'][_0x2ffad9(0x233)]===_0x2ffad9(0x1ef)?_0x4ba885['common']['name']['de']:_0x4ba885['common'][_0x2ffad9(0x233)])||_0x4ba885[_0x2ffad9(0x229)][_0x2ffad9(0x233)];_0x2dd9aa[_0x2ffad9(0x1d7)]({'id':_0x534509,'name':_0x22b651});}const _0x1184c3=await this[_0x2ffad9(0x226)](_0x2ffad9(0x1f2),_0x2ffad9(0x206)),_0x33d2ba=[];if(_0x1184c3)for(const _0x2464a6 in _0x1184c3){const _0x47450f=_0x1184c3[_0x2464a6],_0x3b37c6=(_0x47450f[_0x2ffad9(0x229)]&&typeof _0x47450f[_0x2ffad9(0x229)][_0x2ffad9(0x233)]===_0x2ffad9(0x1ef)?_0x47450f['common'][_0x2ffad9(0x233)]['de']:_0x47450f[_0x2ffad9(0x229)][_0x2ffad9(0x233)])||_0x2464a6['split']('.')[_0x2ffad9(0x1c8)]();_0x33d2ba[_0x2ffad9(0x1d7)](_0x3b37c6);}this['sendTo'](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':!![],'enums':_0x2dd9aa,'rooms':_0x33d2ba},_0x185423['callback']);}else{if(_0x185423[_0x2ffad9(0x1f9)]===_0x2ffad9(0x23d))try{let _0x596b23=_0x2ffad9(0x252),_0x165617='Kein\x20Kalender-Adapter';if(this[_0x2ffad9(0x280)][_0x2ffad9(0x200)]){const _0x2b0f8f=await recorder[_0x2ffad9(0x27a)](this);_0x596b23=_0x2b0f8f!==null?_0x2b0f8f+'Â°C':_0x2ffad9(0x215);}if(this['config']['calendarInstance']){const _0x1a69c9=await this[_0x2ffad9(0x222)](_0x2ffad9(0x22f)+this['config'][_0x2ffad9(0x1e3)]);_0x165617=_0x1a69c9?'Verbunden':_0x2ffad9(0x1d1);}this[_0x2ffad9(0x284)](_0x185423[_0x2ffad9(0x1fe)],_0x185423['command'],{'success':!![],'weather':_0x596b23,'calendar':_0x165617},_0x185423['callback']);}catch(_0x40a386){this[_0x2ffad9(0x284)](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':![],'error':_0x40a386[_0x2ffad9(0x272)]},_0x185423['callback']);}else{if(_0x185423['command']===_0x2ffad9(0x1bc))try{const _0x296730=_0x185423[_0x2ffad9(0x272)]['instance'],_0xaf27a3=await this['getForeignStateAsync'](_0x296730+'.data.table');let _0xa0262c=[];if(_0xaf27a3&&_0xaf27a3[_0x2ffad9(0x256)]){const _0x1abb2d=JSON[_0x2ffad9(0x209)](_0xaf27a3['val']),_0x17c5df=new Set();Array[_0x2ffad9(0x1c3)](_0x1abb2d)&&_0x1abb2d[_0x2ffad9(0x1f3)](_0x509d1b=>{const _0x42e790=_0x2ffad9;if(_0x509d1b[_0x42e790(0x212)])_0x17c5df[_0x42e790(0x1ba)](_0x509d1b[_0x42e790(0x212)]);else{if(_0x509d1b[_0x42e790(0x23a)])_0x17c5df[_0x42e790(0x1ba)](_0x509d1b['calendarName']);}}),_0xa0262c=Array[_0x2ffad9(0x1fe)](_0x17c5df)[_0x2ffad9(0x1ed)]();}if(_0xa0262c[_0x2ffad9(0x1e7)]===0x0)_0xa0262c=[_0x2ffad9(0x21a)];this['sendTo'](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':!![],'names':_0xa0262c},_0x185423[_0x2ffad9(0x227)]);}catch(_0x402ba7){this[_0x2ffad9(0x284)](_0x185423['from'],_0x185423[_0x2ffad9(0x1f9)],{'success':![],'error':_0x402ba7['message']},_0x185423[_0x2ffad9(0x227)]);}else{if(_0x185423[_0x2ffad9(0x1f9)]===_0x2ffad9(0x1c9))try{await setup[_0x2ffad9(0x239)](this,_0x2ffad9(0x1d2),![],![]),this[_0x2ffad9(0x284)](_0x185423[_0x2ffad9(0x1fe)],_0x185423[_0x2ffad9(0x1f9)],{'success':!![],'message':_0x2ffad9(0x1c2)},_0x185423[_0x2ffad9(0x227)]);}catch(_0x4de5dd){this['log'][_0x2ffad9(0x24b)](_0x2ffad9(0x1ce)+_0x4de5dd[_0x2ffad9(0x272)]),this[_0x2ffad9(0x284)](_0x185423['from'],_0x185423['command'],{'success':![],'message':'Fehler:\x20'+_0x4de5dd[_0x2ffad9(0x272)]},_0x185423['callback']);}}}}}}}}}}}async['loadSystemMode'](){const _0x173e3a=a0_0x2eaee0;try{const _0x2a2ed2=await this['getStateAsync'](setup[_0x173e3a(0x202)]);_0x2a2ed2&&_0x2a2ed2[_0x173e3a(0x256)]&&Object[_0x173e3a(0x1b3)](setup[_0x173e3a(0x1f5)])['includes'](_0x2a2ed2[_0x173e3a(0x256)])?this[_0x173e3a(0x27d)]=_0x2a2ed2['val']:(this['currentSystemMode']=setup[_0x173e3a(0x1f5)][_0x173e3a(0x235)],await this[_0x173e3a(0x22c)](setup[_0x173e3a(0x202)],{'val':setup[_0x173e3a(0x1f5)]['NORMAL'],'ack':!![]}));}catch(_0x48d0c9){this['currentSystemMode']=setup[_0x173e3a(0x1f5)][_0x173e3a(0x235)];}}async[a0_0x2eaee0(0x24f)](){const _0x21d1a6=a0_0x2eaee0;try{const _0x5178a7=this[_0x21d1a6(0x280)][_0x21d1a6(0x24e)]||[];let _0xa28e1=![];const _0x231597=[];for(const _0x123a9a of _0x5178a7){try{const _0x4ac420=await this[_0x21d1a6(0x28d)](_0x123a9a);_0x4ac420&&(_0x4ac420[_0x21d1a6(0x256)]===!![]||_0x4ac420[_0x21d1a6(0x256)]===_0x21d1a6(0x266)||_0x4ac420['val']===0x1)&&(_0xa28e1=!![],_0x231597[_0x21d1a6(0x1d7)](_0x123a9a));}catch(_0xa8e463){}}return await this['setStateAsync'](_0x21d1a6(0x250),{'val':_0x231597['join'](',\x20'),'ack':!![]}),_0xa28e1&&(this['exitTimer']&&(this[_0x21d1a6(0x205)][_0x21d1a6(0x1b5)](_0x21d1a6(0x262)),recorder[_0x21d1a6(0x24d)](this)),!this[_0x21d1a6(0x232)]&&this[_0x21d1a6(0x27d)]===setup['SYSTEM_MODES'][_0x21d1a6(0x235)]&&await recorder[_0x21d1a6(0x279)](this,!![])),_0xa28e1;}catch(_0x55d85b){return![];}}async[a0_0x2eaee0(0x27c)](){const _0x38a735=a0_0x2eaee0;this[_0x38a735(0x205)][_0x38a735(0x25d)](_0x38a735(0x1dc)),await aiAgent[_0x38a735(0x253)](this),this[_0x38a735(0x1da)](),this[_0x38a735(0x1e1)](),this[_0x38a735(0x208)]();}['triggerGaitAnalysis'](){const _0x56cf71=a0_0x2eaee0;if(!this[_0x56cf71(0x23c)])return;try{this[_0x56cf71(0x1cb)](_0x56cf71(0x267),(_0x19af15,_0x50b5ea)=>{const _0x5bf1b7=_0x56cf71;_0x50b5ea&&_0x50b5ea[_0x5bf1b7(0x256)]&&pythonBridge[_0x5bf1b7(0x1df)](this,_0x5bf1b7(0x1f7),{'sequences':JSON['parse'](_0x50b5ea[_0x5bf1b7(0x256)])});});}catch(_0x7b7edb){}}async['triggerEnergyPrediction'](){const _0x5d4975=a0_0x2eaee0;if(!this[_0x5d4975(0x23c)])return;try{const _0x2c1169=await recorder[_0x5d4975(0x27a)](this);if(_0x2c1169===null)return;const _0x3bd1b2={},_0xaa6c8b=this[_0x5d4975(0x280)][_0x5d4975(0x223)]||[];for(const _0x14971e of _0xaa6c8b){if(_0x14971e[_0x5d4975(0x261)]===_0x5d4975(0x1bf)&&_0x14971e[_0x5d4975(0x1db)]){const _0x307d49=this[_0x5d4975(0x234)][_0x14971e['id']];if(_0x307d49!==undefined)_0x3bd1b2[_0x14971e[_0x5d4975(0x1db)]]=_0x307d49;}}Object[_0x5d4975(0x1de)](_0x3bd1b2)[_0x5d4975(0x1e7)]>0x0&&pythonBridge[_0x5d4975(0x1df)](this,_0x5d4975(0x201),{'current_temps':_0x3bd1b2,'t_out':_0x2c1169});}catch(_0x6b416d){}}[a0_0x2eaee0(0x1da)](){const _0x3bd7fd=a0_0x2eaee0;if(!this[_0x3bd7fd(0x28e)]||this['rawEventLog']['length']===0x0)return;const _0x52ba12=new Array(0x60)['fill'](0x0),_0x26bbae=new Date()[_0x3bd7fd(0x255)](0x0,0x0,0x0,0x0);this[_0x3bd7fd(0x28e)][_0x3bd7fd(0x1f3)](_0x10ebf8=>{const _0x490b0f=_0x3bd7fd,_0x5bea58=new Date(_0x10ebf8[_0x490b0f(0x217)]);if(_0x5bea58[_0x490b0f(0x268)]()>=_0x26bbae){const _0x1e2469=_0x5bea58[_0x490b0f(0x257)](),_0x2e8e13=_0x5bea58[_0x490b0f(0x220)](),_0x1889b5=_0x1e2469*0x4+Math['floor'](_0x2e8e13/0xf);if(_0x1889b5>=0x0&&_0x1889b5<0x60)_0x52ba12[_0x1889b5]++;}}),this[_0x3bd7fd(0x22c)]('analysis.health.todayVector',{'val':JSON['stringify'](_0x52ba12),'ack':!![]});}[a0_0x2eaee0(0x242)](){const _0x3e6267=a0_0x2eaee0;if(!this['dailyDigests']||this[_0x3e6267(0x1e2)][_0x3e6267(0x1e7)]<0x2)return;const _0x5744ca=this[_0x3e6267(0x1e2)][_0x3e6267(0x22a)](_0x20894f=>{const _0xd86639=_0x3e6267,_0x54a984=(_0x20894f[_0xd86639(0x218)]||'')[_0xd86639(0x241)]();return ACTIVITY_LEVEL_MAP[_0x54a984]||0x32;});pythonBridge['send'](this,'ANALYZE_TREND',{'values':_0x5744ca,'tag':'Activity-Level'});}}if(require['main']!==module)module[a0_0x2eaee0(0x287)]=_0x2639a5=>new CogniLiving(_0x2639a5);else new CogniLiving();