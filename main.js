const a0_0x5d0ec5=a0_0x4037;(function(_0x4bb354,_0x4b7380){const _0x2ed558=a0_0x4037,_0x16fbd3=_0x4bb354();while(!![]){try{const _0x62d3e1=-parseInt(_0x2ed558(0x1d8))/0x1*(parseInt(_0x2ed558(0x1c9))/0x2)+-parseInt(_0x2ed558(0xba))/0x3*(parseInt(_0x2ed558(0xc6))/0x4)+parseInt(_0x2ed558(0x1e0))/0x5*(parseInt(_0x2ed558(0x19b))/0x6)+parseInt(_0x2ed558(0x17a))/0x7*(-parseInt(_0x2ed558(0xb5))/0x8)+parseInt(_0x2ed558(0xbc))/0x9*(-parseInt(_0x2ed558(0xca))/0xa)+parseInt(_0x2ed558(0x119))/0xb*(parseInt(_0x2ed558(0x15a))/0xc)+parseInt(_0x2ed558(0x117))/0xd;if(_0x62d3e1===_0x4b7380)break;else _0x16fbd3['push'](_0x16fbd3['shift']());}catch(_0x5ea1b9){_0x16fbd3['push'](_0x16fbd3['shift']());}}}(a0_0x350e,0x45583));const a0_0x1fde39=(function(){let _0x31f453=!![];return function(_0x312fba,_0x499759){const _0x2e64c9=_0x31f453?function(){const _0x3b85cf=a0_0x4037;if(_0x499759){const _0x23f1d4=_0x499759[_0x3b85cf(0x197)](_0x312fba,arguments);return _0x499759=null,_0x23f1d4;}}:function(){};return _0x31f453=![],_0x2e64c9;};}()),a0_0x616a97=a0_0x1fde39(this,function(){const _0x4ead2c=a0_0x4037;return a0_0x616a97[_0x4ead2c(0xf0)]()[_0x4ead2c(0x15e)]('(((.+)+)+)+$')['toString']()['constructor'](a0_0x616a97)['search'](_0x4ead2c(0xe9));});a0_0x616a97();'use strict';const utils=require(a0_0x5d0ec5(0x13a)),{GoogleGenerativeAI}=require(a0_0x5d0ec5(0x1c8)),path=require(a0_0x5d0ec5(0xda)),fs=require('fs'),installer=require(a0_0x5d0ec5(0x14a)),scanner=require('./lib/scanner'),schedulers=require(a0_0x5d0ec5(0xd3)),topology=require('./lib/topology'),setup=require(a0_0x5d0ec5(0x1be)),recorder=require(a0_0x5d0ec5(0x1f4)),pythonBridge=require(a0_0x5d0ec5(0x12d)),aiAgent=require(a0_0x5d0ec5(0x1ef)),deadMan=require(a0_0x5d0ec5(0x174)),automation=require(a0_0x5d0ec5(0xdc)),GEMINI_MODEL='models/gemini-flash-latest';class CogniLiving extends utils[a0_0x5d0ec5(0x1cb)]{constructor(_0x3e6c7b){const _0x45bc7c=a0_0x5d0ec5;super({..._0x3e6c7b,'name':_0x45bc7c(0x155)}),this[_0x45bc7c(0xe3)]=[],this[_0x45bc7c(0x1b1)]=[],this[_0x45bc7c(0x110)]=[],this['dailyDigests']=[],this[_0x45bc7c(0x1c2)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x45bc7c(0x185)]=!![],this[_0x45bc7c(0x138)]=null,this[_0x45bc7c(0x1a6)]=null,this['isGracePeriodActive']=![],this[_0x45bc7c(0xb6)]=null,this[_0x45bc7c(0x1a1)]=null,this[_0x45bc7c(0x17e)]=setup[_0x45bc7c(0xb3)][_0x45bc7c(0x127)],this['isProVersion']=![],this['lastAlertState']=![],this[_0x45bc7c(0x103)]=null,this[_0x45bc7c(0x12f)]=null,this[_0x45bc7c(0x122)]=null,this[_0x45bc7c(0x194)]=null,this['modeResetJob']=null,this[_0x45bc7c(0x1db)]=null,this[_0x45bc7c(0x162)]=null,this['historyJob']=null,this[_0x45bc7c(0x176)]=null,this[_0x45bc7c(0xf8)]=null,this['roomIntegratorTimer']=null,this[_0x45bc7c(0x113)]=![],this[_0x45bc7c(0x1aa)]=Date['now'](),this[_0x45bc7c(0xdd)]=null,this[_0x45bc7c(0x1ce)]=Date['now'](),this[_0x45bc7c(0x160)]=![],this[_0x45bc7c(0xd6)]=[],this[_0x45bc7c(0x168)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x45bc7c(0x146),this['onReady'][_0x45bc7c(0x1b8)](this)),this['on'](_0x45bc7c(0x13c),this[_0x45bc7c(0xde)][_0x45bc7c(0x1b8)](this)),this['on'](_0x45bc7c(0x178),this[_0x45bc7c(0x1ca)][_0x45bc7c(0x1b8)](this)),this['on'](_0x45bc7c(0x102),this['onMessage'][_0x45bc7c(0x1b8)](this));}async[a0_0x5d0ec5(0x14e)](){const _0xd6e718=a0_0x5d0ec5;this[_0xd6e718(0xf2)][_0xd6e718(0x1d2)](_0xd6e718(0x1e6)+this['version']+')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)');if(this['config'][_0xd6e718(0x198)]!==undefined)this[_0xd6e718(0x168)][_0xd6e718(0x1ee)]=this[_0xd6e718(0xfb)][_0xd6e718(0x198)];if(this['config']['moduleSecurity']!==undefined)this[_0xd6e718(0x168)][_0xd6e718(0x166)]=this[_0xd6e718(0xfb)][_0xd6e718(0x11b)];if(this['config']['moduleEnergy']!==undefined)this[_0xd6e718(0x168)][_0xd6e718(0x196)]=this[_0xd6e718(0xfb)][_0xd6e718(0x186)];if(this['config'][_0xd6e718(0x1c0)]!==undefined)this[_0xd6e718(0x168)][_0xd6e718(0x1d1)]=this[_0xd6e718(0xfb)][_0xd6e718(0x1c0)];if(this[_0xd6e718(0xfb)][_0xd6e718(0x1ed)])this['activeModules']={...this['activeModules'],...this[_0xd6e718(0xfb)]['modules']};this[_0xd6e718(0x15b)]();}async[a0_0x5d0ec5(0x15b)](){const _0x14f6fb=a0_0x5d0ec5;await setup['initZombies'](this);try{this['isProVersion']=await setup[_0x14f6fb(0x1b2)](this['config'][_0x14f6fb(0x175)]);}catch(_0x388130){}if(!this[_0x14f6fb(0xfb)][_0x14f6fb(0x1bc)]||this['config']['inactivityThresholdHours']<0.1)this[_0x14f6fb(0xfb)][_0x14f6fb(0x1bc)]=0xc;await setup['initHistory'](this),await setup[_0x14f6fb(0x1a8)](this);try{const _0x317700=await this[_0x14f6fb(0x16a)](_0x14f6fb(0x1dd)),_0x579be2=await this[_0x14f6fb(0x16a)]('analysis.energy.warmupSources');_0x317700&&_0x317700[_0x14f6fb(0x10c)]&&_0x579be2&&_0x579be2[_0x14f6fb(0x10c)]&&(Date[_0x14f6fb(0xc5)]()-_0x317700['ts']<0x4*0xe10*0x3e8&&(this[_0x14f6fb(0xdd)]={'times':JSON[_0x14f6fb(0x1c6)](_0x317700[_0x14f6fb(0x10c)]),'sources':JSON[_0x14f6fb(0x1c6)](_0x579be2['val'])}));}catch(_0x135f77){}if(this[_0x14f6fb(0xfb)]['geminiApiKey'])try{this['genAI']=new GoogleGenerativeAI(this[_0x14f6fb(0xfb)][_0x14f6fb(0x19d)]),this[_0x14f6fb(0x1a1)]=this[_0x14f6fb(0xb6)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x14f6fb(0x1c4)}});}catch(_0x2a6818){this[_0x14f6fb(0xf2)]['error'](_0x14f6fb(0xfc)+_0x2a6818[_0x14f6fb(0x102)]);}await setup['createAllObjects'](this),await this[_0x14f6fb(0x111)](),schedulers[_0x14f6fb(0x131)](this),await this[_0x14f6fb(0x1c7)](_0x14f6fb(0xbb),{'type':'state','common':{'name':_0x14f6fb(0x106),'type':_0x14f6fb(0x142),'role':_0x14f6fb(0x124),'read':!![],'write':![]},'native':{}}),await this[_0x14f6fb(0x1c7)](_0x14f6fb(0x152),{'type':_0x14f6fb(0x100),'common':{'name':'Room\x20Dwell\x20Time\x20Stats','type':'string','role':_0x14f6fb(0xb7),'read':!![],'write':![],'def':_0x14f6fb(0xd1)},'native':{}}),await this[_0x14f6fb(0x1c7)](_0x14f6fb(0x188),{'type':_0x14f6fb(0x100),'common':{'name':'Room\x20History\x20(24h\x20Buckets)','type':_0x14f6fb(0x1f7),'role':_0x14f6fb(0xb7),'read':!![],'write':![],'def':_0x14f6fb(0x11c)},'native':{}}),await this[_0x14f6fb(0x1c7)]('analysis.health.geminiNight',{'type':_0x14f6fb(0x100),'common':{'name':_0x14f6fb(0x116),'type':'string','role':_0x14f6fb(0x1af),'read':!![],'write':![],'def':_0x14f6fb(0x18a)},'native':{}}),await this[_0x14f6fb(0x1c7)](_0x14f6fb(0x13f),{'type':'state','common':{'name':'Gemini\x20Report\x20Day','type':_0x14f6fb(0x1f7),'role':'text','read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x14f6fb(0x1c7)](_0x14f6fb(0x170),{'type':_0x14f6fb(0x100),'common':{'name':_0x14f6fb(0xdb),'type':'string','role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x14f6fb(0x123),{'type':_0x14f6fb(0x100),'common':{'name':'Daily\x20Room\x20Details\x20(48x30min)','type':_0x14f6fb(0x1f7),'role':_0x14f6fb(0xb7),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x14f6fb(0x1c7)](_0x14f6fb(0xf4),{'type':_0x14f6fb(0x100),'common':{'name':_0x14f6fb(0x1da),'type':_0x14f6fb(0x142),'role':_0x14f6fb(0x124),'unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x14f6fb(0x1dd),{'type':'state','common':{'name':_0x14f6fb(0x1e2),'type':'string','role':_0x14f6fb(0xb7),'read':!![],'write':![]},'native':{}});try{const _0xe0be76=await this[_0x14f6fb(0x16a)](_0x14f6fb(0x143));if(_0xe0be76&&_0xe0be76['val']){this[_0x14f6fb(0xe3)]=JSON[_0x14f6fb(0x1c6)](_0xe0be76[_0x14f6fb(0x10c)]);if(this['isProVersion']){const _0x397c93=await this[_0x14f6fb(0x16a)](_0x14f6fb(0xf7));if(_0x397c93&&_0x397c93[_0x14f6fb(0x10c)])this[_0x14f6fb(0x110)]=JSON[_0x14f6fb(0x1c6)](_0x397c93[_0x14f6fb(0x10c)]);}this[_0x14f6fb(0xf2)][_0x14f6fb(0x1d2)](_0x14f6fb(0x12a)+this[_0x14f6fb(0xe3)][_0x14f6fb(0x15d)]+_0x14f6fb(0xee));}}catch(_0x3da33f){this[_0x14f6fb(0xe3)]=[];}try{const _0x3d3e4f=await this['getStateAsync']('LTM.dailyDigests');if(_0x3d3e4f&&_0x3d3e4f[_0x14f6fb(0x10c)])this[_0x14f6fb(0x11d)]=JSON[_0x14f6fb(0x1c6)](_0x3d3e4f[_0x14f6fb(0x10c)]);}catch(_0x34f959){this['dailyDigests']=[];}const _0x4bbca0=this[_0x14f6fb(0x11d)][_0x14f6fb(0x15d)]>=(this[_0x14f6fb(0xfb)][_0x14f6fb(0xc3)]||0x7)?_0x14f6fb(0x177)+this['dailyDigests']['length']+_0x14f6fb(0xc1):_0x14f6fb(0xf3)+this[_0x14f6fb(0x11d)]['length']+'/'+(this[_0x14f6fb(0xfb)][_0x14f6fb(0xc3)]||0x7)+')';await this[_0x14f6fb(0x164)]('LTM.baselineStatus',{'val':_0x4bbca0,'ack':!![]}),this[_0x14f6fb(0x1d4)]('analysis.trigger'),this['subscribeStates'](_0x14f6fb(0x189)),this[_0x14f6fb(0x1d4)](_0x14f6fb(0x108));this[_0x14f6fb(0xfb)][_0x14f6fb(0x1ab)]&&this['config'][_0x14f6fb(0x1d6)]&&this[_0x14f6fb(0x168)][_0x14f6fb(0x166)]&&this[_0x14f6fb(0x105)](this['config'][_0x14f6fb(0x1d6)]);const _0x1782a6=this[_0x14f6fb(0xfb)][_0x14f6fb(0x18c)];if(_0x1782a6)for(const _0x4932c4 of _0x1782a6){await this[_0x14f6fb(0x18e)](_0x4932c4['id']);}const _0x414e1d=this[_0x14f6fb(0xfb)]['presenceDevices'];if(_0x414e1d)for(const _0x3b2781 of _0x414e1d){await this[_0x14f6fb(0x18e)](_0x3b2781);}const _0x200f66=require(_0x14f6fb(0xf1));if(this['historyJob'])this[_0x14f6fb(0xbe)][_0x14f6fb(0x1b0)]();this[_0x14f6fb(0xbe)]=_0x200f66[_0x14f6fb(0xf5)]('59\x2023\x20*\x20*\x20*',()=>{const _0x2bd89a=_0x14f6fb;this[_0x2bd89a(0x169)]();}),setTimeout(()=>this[_0x14f6fb(0x1e3)](),0x1388);if(this[_0x14f6fb(0xc2)])clearInterval(this[_0x14f6fb(0xc2)]);this[_0x14f6fb(0xcb)](),this[_0x14f6fb(0xc2)]=setInterval(async()=>{const _0x45e0ec=_0x14f6fb;await this[_0x45e0ec(0xcb)]();},0x3c*0x3e8);if(this[_0x14f6fb(0xf8)])clearInterval(this['healthTrendInterval']);this[_0x14f6fb(0xf8)]=setInterval(()=>{const _0x1a3bf7=_0x14f6fb;this[_0x1a3bf7(0x1f1)]&&this[_0x1a3bf7(0x168)][_0x1a3bf7(0x1ee)]&&this[_0x1a3bf7(0xeb)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x14f6fb(0x103)])clearInterval(this[_0x14f6fb(0x103)]);this[_0x14f6fb(0x168)][_0x14f6fb(0x196)]&&(this[_0x14f6fb(0x103)]=setInterval(()=>{const _0x33cd59=_0x14f6fb;this[_0x33cd59(0x120)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x14f6fb(0x120)](),0x2710));if(this[_0x14f6fb(0x12f)])clearInterval(this['calendarCheckTimer']);this[_0x14f6fb(0xfb)][_0x14f6fb(0x1d0)]&&this['activeModules'][_0x14f6fb(0x196)]&&(this[_0x14f6fb(0x12f)]=setInterval(()=>{automation['checkCalendarTriggers'](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x14f6fb(0x12e)](this),0x3a98));if(this['presenceCheckTimer'])clearInterval(this[_0x14f6fb(0x122)]);this[_0x14f6fb(0xfb)][_0x14f6fb(0x183)]&&this[_0x14f6fb(0xfb)][_0x14f6fb(0x183)][_0x14f6fb(0x15d)]>0x0&&(this[_0x14f6fb(0x122)]=setInterval(async()=>{const _0x42651c=_0x14f6fb;await this[_0x42651c(0xea)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0x14f6fb(0xea)](),0x1388));const _0x394797=path[_0x14f6fb(0xd0)](__dirname,_0x14f6fb(0xd2),_0x14f6fb(0x1e4),_0x14f6fb(0x136));pythonBridge['startService'](this,_0x394797);}[a0_0x5d0ec5(0x1ca)](_0x5ba3e2){const _0x2fc023=a0_0x5d0ec5;if(this[_0x2fc023(0xbe)])this[_0x2fc023(0xbe)][_0x2fc023(0x1b0)]();this['saveDailyHistory']()[_0x2fc023(0x1f5)](()=>{const _0x1062e7=_0x2fc023;if(this[_0x1062e7(0x103)])clearInterval(this[_0x1062e7(0x103)]);if(this[_0x1062e7(0x12f)])clearInterval(this[_0x1062e7(0x12f)]);if(this[_0x1062e7(0x122)])clearInterval(this[_0x1062e7(0x122)]);if(this[_0x1062e7(0xc2)])clearInterval(this[_0x1062e7(0xc2)]);recorder[_0x1062e7(0x112)](this),pythonBridge[_0x1062e7(0x179)](this),_0x5ba3e2();});}async[a0_0x5d0ec5(0x1e3)](){const _0x5431ee=a0_0x5d0ec5;if(!this[_0x5431ee(0xe3)]||this['eventHistory'][_0x5431ee(0x15d)]===0x0){this['log'][_0x5431ee(0x1f2)](_0x5431ee(0xb9));return;}this[_0x5431ee(0xf2)][_0x5431ee(0x1d2)]('‚Ü∫\x20Replaying\x20'+this[_0x5431ee(0xe3)][_0x5431ee(0x15d)]+_0x5431ee(0x148));const _0x25d386=new Date()[_0x5431ee(0xbf)](0x0,0x0,0x0,0x0),_0x183148='analysis.activity.roomHistory';let _0x17158a={'history':{},'date':new Date()['toLocaleDateString']()};const _0x24a8b8=_0x5431ee(0x170),_0x3f5670='analysis.health.todayRoomDetails';let _0x1e4070=new Array(0x30)[_0x5431ee(0x19a)](0x0),_0x1f21c8=Array[_0x5431ee(0x13e)]({'length':0x30},()=>[]);this[_0x5431ee(0xe3)][_0x5431ee(0xcc)](_0x389df2=>{const _0x2f2578=_0x5431ee;if(_0x389df2[_0x2f2578(0x132)]>=_0x25d386){if(recorder[_0x2f2578(0x1ad)](_0x389df2[_0x2f2578(0x187)],_0x389df2[_0x2f2578(0x124)])){const _0x548952=new Date(_0x389df2[_0x2f2578(0x132)]),_0x4e980f=_0x548952['getHours']()*0x2+(_0x548952[_0x2f2578(0x10a)]()>=0x1e?0x1:0x0);if(_0x4e980f<0x30){_0x1e4070[_0x4e980f]++;const _0x4eaa95=_0x389df2[_0x2f2578(0x1e7)]||_0x389df2[_0x2f2578(0x182)]||'?';let _0x561ae1=_0x1f21c8[_0x4e980f];!_0x561ae1[_0x2f2578(0xc7)](_0x4eaa95)&&_0x561ae1['push'](_0x4eaa95);}const _0x544e6c=_0x548952[_0x2f2578(0x17d)]();let _0xc482e6=_0x389df2['location']||_0x2f2578(0x19f);const _0x37127b=(this[_0x2f2578(0xfb)][_0x2f2578(0x18c)]||[])['find'](_0x359d86=>_0x359d86[_0x2f2578(0x1e7)]===_0xc482e6);if(_0x37127b)_0xc482e6=_0x37127b[_0x2f2578(0x1e7)];if(!_0x17158a['history'][_0xc482e6])_0x17158a[_0x2f2578(0x17c)][_0xc482e6]=new Array(0x18)[_0x2f2578(0x19a)](0x0);if(_0x17158a['history'][_0xc482e6][_0x544e6c]<0x3c)_0x17158a['history'][_0xc482e6][_0x544e6c]++;}}});const _0x5d53c7=await this[_0x5431ee(0x16a)](_0x183148);(!_0x5d53c7||!_0x5d53c7[_0x5431ee(0x10c)]||_0x5d53c7[_0x5431ee(0x10c)]==='{}'||_0x5d53c7['val'][_0x5431ee(0xc7)](_0x5431ee(0x129)))&&await this[_0x5431ee(0x164)](_0x183148,{'val':JSON['stringify'](_0x17158a),'ack':!![]}),await this[_0x5431ee(0x164)](_0x24a8b8,{'val':JSON[_0x5431ee(0x17f)](_0x1e4070),'ack':!![]}),await this[_0x5431ee(0x164)](_0x3f5670,{'val':JSON[_0x5431ee(0x17f)](_0x1f21c8),'ack':!![]}),this[_0x5431ee(0xf2)][_0x5431ee(0x1d2)](_0x5431ee(0xcf));}async[a0_0x5d0ec5(0x169)](){const _0x9939df=a0_0x5d0ec5;if(!this['activeModules']['health'])return;const _0x25cf5e=new Date()[_0x9939df(0x151)]()[_0x9939df(0xe8)]('T')[0x0];this['log'][_0x9939df(0x199)]('üíæ\x20Saving\x20Daily\x20History\x20for\x20'+_0x25cf5e+_0x9939df(0x167));try{const [_0x10b1dc,_0x24791d,_0x5d0259,_0xb3ca14,_0x5b945d,_0x258317]=await Promise[_0x9939df(0x19c)]([this[_0x9939df(0x16a)](_0x9939df(0x188)),this['getStateAsync'](_0x9939df(0x134)),this['getStateAsync'](_0x9939df(0x13f)),this[_0x9939df(0x16a)](_0x9939df(0xe5)),this[_0x9939df(0x16a)](_0x9939df(0x170)),this[_0x9939df(0x16a)](_0x9939df(0xf4))]),_0xcd19c0=this['eventHistory'][_0x9939df(0xfd)](_0x8079c7=>_0x8079c7[_0x9939df(0x132)]>=new Date()[_0x9939df(0xbf)](0x0,0x0,0x0,0x0)&&(_0x8079c7[_0x9939df(0x182)][_0x9939df(0x137)]()['includes'](_0x9939df(0x15c))||_0x8079c7[_0x9939df(0x182)]['toLowerCase']()[_0x9939df(0xc7)](_0x9939df(0x18b)))&&(_0x8079c7[_0x9939df(0x124)]===!![]||_0x8079c7[_0x9939df(0x124)]==='open'))['length'];let _0x3b9c53=0x55;if(_0x258317&&_0x258317['val']!==undefined)_0x3b9c53=Math[_0x9939df(0x1b7)](0x64,Math[_0x9939df(0x184)](0x14,Math[_0x9939df(0xcd)](0x50+Number(_0x258317['val'])*0x5)));const _0x9c3415={'date':_0x25cf5e,'timestamp':Date['now'](),'roomHistory':_0x10b1dc?.[_0x9939df(0x10c)]?JSON['parse'](_0x10b1dc['val']):{},'geminiNight':_0x24791d?.[_0x9939df(0x10c)]||'Keine\x20Daten','geminiDay':_0x5d0259?.[_0x9939df(0x10c)]||'Keine\x20Daten','anomalyScore':_0xb3ca14?.[_0x9939df(0x10c)]||0.1,'todayVector':_0x5b945d?.[_0x9939df(0x10c)]?JSON['parse'](_0x5b945d['val']):new Array(0x30)[_0x9939df(0x19a)](0x0),'batteryLevel':_0x3b9c53,'freshAirCount':_0xcd19c0,'eventHistory':this[_0x9939df(0xe3)]},_0x2308e2=utils[_0x9939df(0xd5)](),_0x30ec04=path[_0x9939df(0xd0)](_0x2308e2,_0x9939df(0x155),_0x9939df(0x17c));if(!fs[_0x9939df(0x1cf)](_0x30ec04))fs[_0x9939df(0x1a4)](_0x30ec04,{'recursive':!![]});const _0x4b994e=path[_0x9939df(0xd0)](_0x30ec04,_0x25cf5e+_0x9939df(0x135));fs[_0x9939df(0x149)](_0x4b994e,JSON[_0x9939df(0x17f)](_0x9c3415)),this[_0x9939df(0xf2)]['info'](_0x9939df(0x1bd)+_0x4b994e);}catch(_0x17a64c){this['log']['error'](_0x9939df(0x145)+_0x17a64c[_0x9939df(0x102)]);}}async['integrateRoomTime'](){const _0xd022aa=a0_0x5d0ec5;if(!this[_0xd022aa(0x185)])return;try{let _0x3d3e93=null;try{const _0xf42cc1=await this[_0xd022aa(0x16a)]('analysis.prediction.trackerTopRoom'),_0x39c57d=await this[_0xd022aa(0x16a)](_0xd022aa(0x12c));if(_0xf42cc1&&_0xf42cc1[_0xd022aa(0x10c)]&&_0x39c57d&&_0x39c57d[_0xd022aa(0x10c)]&&_0x39c57d['val']>0.3){if(_0xf42cc1['val']!=='Unknown'&&_0xf42cc1[_0xd022aa(0x10c)]!==_0xd022aa(0x1a7))_0x3d3e93=_0xf42cc1[_0xd022aa(0x10c)];}}catch(_0x4c02b8){}if(!_0x3d3e93){const _0x3231f3=this[_0xd022aa(0xfb)][_0xd022aa(0x18c)]||[];for(const _0x8ded6d of _0x3231f3){if(_0x8ded6d['type']===_0xd022aa(0x104)&&_0x8ded6d[_0xd022aa(0x1e7)])try{const _0x4adee6=await this[_0xd022aa(0x16d)](_0x8ded6d['id']);if(_0x4adee6&&(_0x4adee6['val']===!![]||_0x4adee6[_0xd022aa(0x10c)]==='on'||_0x4adee6[_0xd022aa(0x10c)]===0x1)){_0x3d3e93=_0x8ded6d[_0xd022aa(0x1e7)];break;}}catch(_0x40f609){}}}if(!_0x3d3e93)return;const _0xd17016=this[_0xd022aa(0xfb)]['devices']||[];let _0x4e9a59=_0x3d3e93;const _0x446248=_0xd17016[_0xd022aa(0x1b3)](_0x2326dc=>_0x2326dc[_0xd022aa(0x1e7)]&&_0x2326dc['location'][_0xd022aa(0x137)]()===_0x3d3e93[_0xd022aa(0x137)]());if(_0x446248)_0x4e9a59=_0x446248[_0xd022aa(0x1e7)];const _0x3e0a67='analysis.activity.roomHistory',_0x287de6=await this[_0xd022aa(0x16a)](_0x3e0a67),_0x52dfbd=new Date()[_0xd022aa(0x1e1)]();let _0x2a495f={'history':{},'date':_0x52dfbd};if(_0x287de6&&_0x287de6[_0xd022aa(0x10c)])try{_0x2a495f=JSON['parse'](_0x287de6[_0xd022aa(0x10c)]);}catch(_0x17b291){}_0x2a495f[_0xd022aa(0x171)]!==_0x52dfbd&&(_0x2a495f[_0xd022aa(0x17c)]={},_0x2a495f[_0xd022aa(0x171)]=_0x52dfbd);if(!_0x2a495f[_0xd022aa(0x17c)][_0x4e9a59])_0x2a495f['history'][_0x4e9a59]=new Array(0x18)[_0xd022aa(0x19a)](0x0);const _0x1877f5=new Date()[_0xd022aa(0x17d)]();if(_0x2a495f[_0xd022aa(0x17c)][_0x4e9a59][_0x1877f5]<0x3c)_0x2a495f[_0xd022aa(0x17c)][_0x4e9a59][_0x1877f5]++;await this[_0xd022aa(0x164)](_0x3e0a67,{'val':JSON[_0xd022aa(0x17f)](_0x2a495f),'ack':!![]});}catch(_0x2096d2){this['log'][_0xd022aa(0x1f2)](_0xd022aa(0x10d)+_0x2096d2[_0xd022aa(0x102)]);}}async[a0_0x5d0ec5(0xe2)](_0x5df064){const _0xe0cc1c=a0_0x5d0ec5;if(typeof _0x5df064===_0xe0cc1c(0x1c5)&&_0x5df064['message']){if(_0x5df064[_0xe0cc1c(0xed)]===_0xe0cc1c(0x161)){const _0x37c995=_0x5df064['message']['date'],_0x9748b7=utils[_0xe0cc1c(0xd5)](),_0x35cb41=path['join'](_0x9748b7,'cogni-living',_0xe0cc1c(0x17c),_0x37c995+_0xe0cc1c(0x135));if(fs['existsSync'](_0x35cb41))try{const _0x34ff04=JSON['parse'](fs[_0xe0cc1c(0x1a2)](_0x35cb41,_0xe0cc1c(0x16c)));this[_0xe0cc1c(0x1df)](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064[_0xe0cc1c(0xed)],{'success':!![],'data':_0x34ff04},_0x5df064[_0xe0cc1c(0x101)]);}catch(_0x22fac3){this['sendTo'](_0x5df064['from'],_0x5df064[_0xe0cc1c(0xed)],{'success':![],'error':_0xe0cc1c(0x181)},_0x5df064[_0xe0cc1c(0x101)]);}else this[_0xe0cc1c(0x1df)](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064[_0xe0cc1c(0xed)],{'success':![],'error':_0xe0cc1c(0xf9)},_0x5df064[_0xe0cc1c(0x101)]);}else{if(_0x5df064[_0xe0cc1c(0xed)]===_0xe0cc1c(0xbd)){const _0xa5df1f=this[_0xe0cc1c(0x11d)]['length'];let _0x2a052c=new Array(0x30)['fill'](0x0),_0x5b0940=Array['from']({'length':0x30},()=>[]);try{const _0x194e65=await this[_0xe0cc1c(0x16a)]('analysis.health.todayVector');if(_0x194e65&&_0x194e65[_0xe0cc1c(0x10c)])_0x2a052c=JSON['parse'](_0x194e65[_0xe0cc1c(0x10c)]);const _0x44de79=await this[_0xe0cc1c(0x16a)](_0xe0cc1c(0x123));if(_0x44de79&&_0x44de79[_0xe0cc1c(0x10c)])_0x5b0940=JSON['parse'](_0x44de79['val']);}catch(_0x25bd54){}let _0x3e0e30=new Array(0x30)['fill'](0x0);try{const _0x52e961=new Date();_0x52e961[_0xe0cc1c(0xd9)](_0x52e961['getDate']()-0x1);const _0x4ac847=_0x52e961[_0xe0cc1c(0x151)]()[_0xe0cc1c(0xe8)]('T')[0x0],_0x6f128d=utils[_0xe0cc1c(0xd5)](),_0x53ea07=path['join'](_0x6f128d,_0xe0cc1c(0x155),_0xe0cc1c(0x17c),_0x4ac847+_0xe0cc1c(0x135));if(fs[_0xe0cc1c(0x1cf)](_0x53ea07)){const _0x3c4f3f=JSON[_0xe0cc1c(0x1c6)](fs[_0xe0cc1c(0x1a2)](_0x53ea07,_0xe0cc1c(0x16c)));if(_0x3c4f3f&&_0x3c4f3f[_0xe0cc1c(0x159)])_0x3e0e30=_0x3c4f3f[_0xe0cc1c(0x159)];}}catch(_0x5cb264){}let _0x8bc218={'today':{},'yesterday':{}};try{const _0x404a06=await this[_0xe0cc1c(0x16a)](_0xe0cc1c(0x152));if(_0x404a06&&_0x404a06[_0xe0cc1c(0x10c)])_0x8bc218=JSON['parse'](_0x404a06['val']);}catch(_0x5e8049){}let _0x1881e5=null;try{const _0x3b41c0=await this['getStateAsync'](_0xe0cc1c(0xf4));if(_0x3b41c0)_0x1881e5=_0x3b41c0[_0xe0cc1c(0x10c)];}catch(_0xdf06de){}if(_0x1881e5===undefined||_0x1881e5===null){const _0x3d1b05=_0x2a052c['reduce']((_0x42657a,_0xd3e95b)=>_0x42657a+_0xd3e95b,0x0),_0x8089d4=Math[_0xe0cc1c(0x1b7)](0x2,Math[_0xe0cc1c(0x184)](-0x2,(0x64-_0x3d1b05)/0x32));_0x1881e5=_0x8089d4;}let _0x5b24dc=![],_0x74228='',_0x520767='',_0x11e042='';try{const _0x324853=await this['getStateAsync'](_0xe0cc1c(0x11f));if(_0x324853&&_0x324853[_0xe0cc1c(0x10c)]){_0x5b24dc=!![];const _0x11735f=await this[_0xe0cc1c(0x16a)](_0xe0cc1c(0x133));_0x74228=_0x11735f?_0x11735f[_0xe0cc1c(0x10c)]:'';const _0x410bac=await this['getStateAsync'](_0xe0cc1c(0x140));_0x520767=_0x410bac?_0x410bac[_0xe0cc1c(0x10c)]:'';const _0x33c6d3=await this[_0xe0cc1c(0x16a)](_0xe0cc1c(0x1e5));_0x11e042=_0x33c6d3?_0x33c6d3[_0xe0cc1c(0x10c)]:'';}}catch(_0x3d0722){}const _0x3108ad=await this['checkSolarCondition'](),_0xf1d15e=(this[_0xe0cc1c(0xfb)]['devices']||[])['some'](_0x4594eb=>_0x4594eb['isSolar']),_0x3ccbcc=_0x3108ad&&_0xf1d15e;let _0x476ee3='';try{const _0xd57109=await this[_0xe0cc1c(0x16a)]('system.presenceWho');if(_0xd57109&&_0xd57109[_0xe0cc1c(0x10c)])_0x476ee3=_0xd57109[_0xe0cc1c(0x10c)];}catch(_0x3c90f9){}this[_0xe0cc1c(0x1df)](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064[_0xe0cc1c(0xed)],{'success':!![],'eventHistory':this[_0xe0cc1c(0xe3)][_0xe0cc1c(0x1bb)](0x0,0x7d0),'stats':{'digestCount':_0xa5df1f,'isPresent':this[_0xe0cc1c(0x185)],'hourlyActivity':_0x2a052c,'hourlyDetails':_0x5b0940,'yesterdayActivity':_0x3e0e30,'solarActive':_0x3ccbcc,'presenceWho':_0x476ee3,'roomStats':_0x8bc218,'activityTrend':_0x1881e5,'modules':this[_0xe0cc1c(0x168)]},'automation':{'detected':_0x5b24dc,'description':_0x74228,'targetId':_0x520767,'targetValue':_0x11e042}},_0x5df064[_0xe0cc1c(0x101)]);}else{if(_0x5df064[_0xe0cc1c(0xed)]===_0xe0cc1c(0xef))try{const _0xc4f447=await automation[_0xe0cc1c(0xc9)](this);this[_0xe0cc1c(0x1df)](_0x5df064['from'],_0x5df064[_0xe0cc1c(0xed)],{'success':!![],'results':_0xc4f447},_0x5df064[_0xe0cc1c(0x101)]);}catch(_0x268976){this[_0xe0cc1c(0x1df)](_0x5df064['from'],_0x5df064['command'],{'success':![],'error':_0x268976[_0xe0cc1c(0x102)]},_0x5df064['callback']);}else{if(_0x5df064[_0xe0cc1c(0xed)]==='scanDevices')try{const _0x56f9b4=await scanner[_0xe0cc1c(0x1c3)](this,_0x5df064[_0xe0cc1c(0x102)]||{});this[_0xe0cc1c(0x1df)](_0x5df064['from'],_0x5df064[_0xe0cc1c(0xed)],{'success':!![],'devices':_0x56f9b4},_0x5df064[_0xe0cc1c(0x101)]);}catch(_0x528c42){}else{if(_0x5df064[_0xe0cc1c(0xed)]===_0xe0cc1c(0x1d3)){const _0x43a778=await this[_0xe0cc1c(0x1a5)](_0xe0cc1c(0x153),_0xe0cc1c(0x14d)),_0x229a04=[];if(_0x43a778)for(const _0x3b5458 in _0x43a778){let _0x2e9fb4=_0x43a778[_0x3b5458]['common']['name'];if(_0x2e9fb4&&typeof _0x2e9fb4===_0xe0cc1c(0x1c5))_0x2e9fb4=_0x2e9fb4['de']||_0x2e9fb4['en']||Object['values'](_0x2e9fb4)[0x0]||JSON['stringify'](_0x2e9fb4);_0x229a04[_0xe0cc1c(0xb4)]({'id':_0x3b5458,'name':String(_0x2e9fb4||_0x3b5458)});}const _0x4e9378=await this[_0xe0cc1c(0x1a5)]('enum.rooms.*',_0xe0cc1c(0x14d)),_0x162717=[];if(_0x4e9378)for(const _0x1e806c in _0x4e9378){let _0x1bb403=_0x4e9378[_0x1e806c][_0xe0cc1c(0x1b6)]['name'];if(_0x1bb403&&typeof _0x1bb403===_0xe0cc1c(0x1c5))_0x1bb403=_0x1bb403['de']||_0x1bb403['en']||Object[_0xe0cc1c(0x10b)](_0x1bb403)[0x0]||JSON[_0xe0cc1c(0x17f)](_0x1bb403);_0x162717['push'](String(_0x1bb403||_0x1e806c['split']('.')[_0xe0cc1c(0x192)]()));}this[_0xe0cc1c(0x1df)](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064[_0xe0cc1c(0xed)],{'success':!![],'enums':_0x229a04,'rooms':_0x162717},_0x5df064[_0xe0cc1c(0x101)]);}else{if(_0x5df064[_0xe0cc1c(0xed)]==='getCalendarNames')try{const _0x5e83cd=await this[_0xe0cc1c(0xe7)](_0xe0cc1c(0x130),_0xe0cc1c(0x11a),{'startkey':_0xe0cc1c(0x1c1),'endkey':'system.adapter.ical.È¶ô'}),_0x5630f2=new Set();if(_0x5e83cd&&_0x5e83cd[_0xe0cc1c(0x114)])for(const _0x1d1f9a of _0x5e83cd[_0xe0cc1c(0x114)]){const _0x7a763b=_0x1d1f9a['id'][_0xe0cc1c(0x191)](_0xe0cc1c(0x1ec),''),_0x28e64c=await this[_0xe0cc1c(0x16d)](_0x7a763b+'.data.table');let _0xf544ae=![];if(_0x28e64c&&_0x28e64c[_0xe0cc1c(0x10c)]){const _0x4d9955=typeof _0x28e64c[_0xe0cc1c(0x10c)]===_0xe0cc1c(0x1f7)?JSON['parse'](_0x28e64c['val']):_0x28e64c[_0xe0cc1c(0x10c)];Array['isArray'](_0x4d9955)&&_0x4d9955[_0xe0cc1c(0xcc)](_0x3784a9=>{const _0xde38e7=_0xe0cc1c;_0x3784a9[_0xde38e7(0x139)]&&(_0x5630f2[_0xde38e7(0x173)](_0x3784a9[_0xde38e7(0x139)]),_0xf544ae=!![]);});}!_0xf544ae&&_0x5630f2[_0xe0cc1c(0x173)](_0x7a763b);}const _0x1e735e=Array[_0xe0cc1c(0x13e)](_0x5630f2);if(_0x1e735e[_0xe0cc1c(0x15d)]===0x0)_0x1e735e[_0xe0cc1c(0xb4)](_0xe0cc1c(0x1b9));this[_0xe0cc1c(0x1df)](_0x5df064['from'],_0x5df064[_0xe0cc1c(0xed)],{'success':!![],'names':_0x1e735e},_0x5df064['callback']);}catch(_0x4da43a){this[_0xe0cc1c(0x1df)](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064['command'],{'success':![],'error':_0xe0cc1c(0x1cc)+_0x4da43a[_0xe0cc1c(0x102)]},_0x5df064[_0xe0cc1c(0x101)]);}else{if(_0x5df064[_0xe0cc1c(0xed)]==='refreshCalendar')try{await automation[_0xe0cc1c(0xc0)](this),this[_0xe0cc1c(0x1df)](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064[_0xe0cc1c(0xed)],{'success':!![]},_0x5df064['callback']);}catch(_0x143670){this['log'][_0xe0cc1c(0x1f2)](_0xe0cc1c(0xb8)+_0x143670[_0xe0cc1c(0x102)]),this[_0xe0cc1c(0x1df)](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064['command'],{'success':![],'error':_0x143670['message']},_0x5df064[_0xe0cc1c(0x101)]);}else{if(_0x5df064[_0xe0cc1c(0xed)]===_0xe0cc1c(0x158))try{const _0x466c6e=_0x5df064[_0xe0cc1c(0x102)]?_0x5df064[_0xe0cc1c(0x102)][_0xe0cc1c(0x16b)]:'';if(!_0x466c6e)throw new Error(_0xe0cc1c(0x18f));const _0x37f3d7=new GoogleGenerativeAI(_0x466c6e),_0x4e9325=_0x37f3d7[_0xe0cc1c(0x18d)]({'model':GEMINI_MODEL}),_0x1aa13f=await _0x4e9325[_0xe0cc1c(0x156)](_0xe0cc1c(0x12b)),_0x82d287=await _0x1aa13f[_0xe0cc1c(0x109)],_0x208afb=_0x82d287['text']();this[_0xe0cc1c(0x1df)](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064['command'],{'success':!![],'message':'Verbindung\x20erfolgreich:\x20'+_0x208afb[_0xe0cc1c(0x11e)](0x0,0x14)+_0xe0cc1c(0x167)},_0x5df064['callback']);}catch(_0x4f0803){this[_0xe0cc1c(0x1df)](_0x5df064['from'],_0x5df064[_0xe0cc1c(0xed)],{'success':![],'message':_0x4f0803[_0xe0cc1c(0x102)]},_0x5df064[_0xe0cc1c(0x101)]);}else{if(_0x5df064[_0xe0cc1c(0xed)]==='testContext')try{const _0x48dd48=await this['checkSolarCondition'](),_0x3b002a=await this[_0xe0cc1c(0xe7)](_0xe0cc1c(0x130),_0xe0cc1c(0x11a),{'startkey':_0xe0cc1c(0x1c1),'endkey':'system.adapter.ical.È¶ô'}),_0x43d2dd=_0x3b002a&&_0x3b002a[_0xe0cc1c(0x114)]?_0x3b002a[_0xe0cc1c(0x114)][_0xe0cc1c(0x15d)]:0x0;this['sendTo'](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064['command'],{'success':!![],'weather':_0xe0cc1c(0x16e)+_0x48dd48+_0xe0cc1c(0x165)+(this[_0xe0cc1c(0x1c2)][this[_0xe0cc1c(0xfb)][_0xe0cc1c(0xce)]]||'?')+'¬∞C','calendar':_0x43d2dd+_0xe0cc1c(0x1a0)},_0x5df064[_0xe0cc1c(0x101)]);}catch(_0x16e333){this['sendTo'](_0x5df064[_0xe0cc1c(0x13e)],_0x5df064[_0xe0cc1c(0xed)],{'success':![]},_0x5df064['callback']);}}}}}}}}}}}[a0_0x5d0ec5(0xeb)](){const _0xb4b468=a0_0x5d0ec5;if(!this[_0xb4b468(0x168)][_0xb4b468(0x1ee)])return;this['log'][_0xb4b468(0x199)](_0xb4b468(0x1de));try{const _0x1777fd=this[_0xb4b468(0x110)]||[];pythonBridge[_0xb4b468(0x1f0)](this,_0xb4b468(0x1d5),{'events':_0x1777fd});}catch(_0x489e9d){this[_0xb4b468(0xf2)][_0xb4b468(0x1f2)]('Failed\x20to\x20trigger\x20Python\x20Health\x20Check');}}async[a0_0x5d0ec5(0xde)](_0x5d8e4b,_0x489249){const _0x169f52=a0_0x5d0ec5;if(!_0x489249||this[_0x169f52(0x113)])return;if(_0x5d8e4b[_0x169f52(0xc7)](_0x169f52(0x10f))&&_0x5d8e4b[_0x169f52(0x1dc)](_0x169f52(0xe0))&&_0x489249[_0x169f52(0x10c)])return;if(this[_0x169f52(0xfb)]['infrasoundEnabled']&&_0x5d8e4b===this[_0x169f52(0xfb)][_0x169f52(0x1d6)]&&this[_0x169f52(0x168)][_0x169f52(0x166)]){this['handleInfrasound'](_0x489249[_0x169f52(0x10c)]);return;}if(_0x489249[_0x169f52(0x172)]&&_0x5d8e4b[_0x169f52(0x1dc)]('pulse'))return;if(_0x5d8e4b===this[_0x169f52(0x157)]+_0x169f52(0x1f3)){if(_0x489249[_0x169f52(0x10c)]&&Object[_0x169f52(0x10b)](setup[_0x169f52(0xb3)])['includes'](_0x489249[_0x169f52(0x10c)])){this[_0x169f52(0x17e)]=_0x489249[_0x169f52(0x10c)];if(_0x489249['val']===setup['SYSTEM_MODES'][_0x169f52(0x15f)])await recorder['setPresence'](this,![]);else await recorder[_0x169f52(0xfa)](this,!![]);if(this[_0x169f52(0x1f1)]){let _0x43d7f9=![],_0x3796ed=0x0,_0x29d00d=_0x169f52(0x154);if(this[_0x169f52(0x17e)]===_0x169f52(0x180))_0x43d7f9=!![],_0x3796ed=0x168,_0x29d00d=_0x169f52(0x193);else this[_0x169f52(0x17e)]===_0x169f52(0xf6)&&(_0x43d7f9=!![],_0x3796ed=0x5a0,_0x29d00d='Guest\x20Mode');pythonBridge['send'](this,_0x169f52(0x19e),{'active':_0x43d7f9,'duration':_0x3796ed,'label':_0x29d00d}),await this['setStateAsync'](_0x169f52(0xec),{'val':JSON[_0x169f52(0x17f)]({'active':_0x43d7f9,'label':_0x29d00d,'timestamp':Date[_0x169f52(0xc5)]()}),'ack':!![]});}}if(!_0x489249[_0x169f52(0x172)])this[_0x169f52(0x10e)](_0x5d8e4b,{'val':this[_0x169f52(0x17e)],'ack':!![]});return;}if(_0x5d8e4b[_0x169f52(0x1dc)](_0x169f52(0x1ac))&&_0x489249[_0x169f52(0x172)])this[_0x169f52(0x16f)](_0x489249[_0x169f52(0x10c)]);if(_0x5d8e4b[_0x169f52(0x1dc)](_0x169f52(0x1dd))&&_0x489249[_0x169f52(0x172)]&&this[_0x169f52(0x168)][_0x169f52(0x196)])automation[_0x169f52(0x12e)](this);if(!_0x489249[_0x169f52(0x172)]){if(_0x5d8e4b[_0x169f52(0xc7)](_0x169f52(0x14c))&&_0x489249[_0x169f52(0x10c)]){this[_0x169f52(0x10e)](_0x5d8e4b,{'val':![],'ack':!![]}),aiAgent[_0x169f52(0x1bf)](this);return;}if(_0x5d8e4b[_0x169f52(0xc7)](_0x169f52(0xe1))&&_0x489249['val']){this[_0x169f52(0x10e)](_0x5d8e4b,{'val':![],'ack':!![]});if(this[_0x169f52(0x1f1)])aiAgent[_0x169f52(0x195)](this,pythonBridge);return;}if(_0x5d8e4b[_0x169f52(0xc7)]('triggerBriefing')&&_0x489249[_0x169f52(0x10c)]){this[_0x169f52(0x10e)](_0x5d8e4b,{'val':![],'ack':!![]}),aiAgent[_0x169f52(0x1ba)](this);return;}if(_0x5d8e4b[_0x169f52(0xc7)](_0x169f52(0x147))&&_0x489249[_0x169f52(0x10c)]){this[_0x169f52(0x10e)](_0x5d8e4b,{'val':![],'ack':!![]}),aiAgent[_0x169f52(0xc4)](this);return;}if(_0x5d8e4b[_0x169f52(0xc7)](_0x169f52(0x1ea))&&_0x489249[_0x169f52(0x10c)]){this['setState'](_0x5d8e4b,{'val':![],'ack':!![]});if(this[_0x169f52(0x1f1)])try{const _0x28e841=await this['getStateAsync'](_0x169f52(0xd7));if(_0x28e841&&_0x28e841[_0x169f52(0x10c)]){const _0x1aac21=JSON[_0x169f52(0x1c6)](_0x28e841[_0x169f52(0x10c)]);this[_0x169f52(0x164)](_0x169f52(0x1eb),{'val':_0x169f52(0x128),'ack':!![]}),pythonBridge[_0x169f52(0x1f0)](this,_0x169f52(0x144),{'sequences':_0x1aac21});}}catch(_0x122725){}return;}if(_0x5d8e4b[_0x169f52(0xc7)](_0x169f52(0x108))&&_0x489249[_0x169f52(0x10c)]){this['setState'](_0x5d8e4b,{'val':![],'ack':!![]});if(this[_0x169f52(0x1f1)])try{this[_0x169f52(0xeb)]();const _0x249921=await this[_0x169f52(0x16a)]('LTM.dailyDigests');if(_0x249921&&_0x249921[_0x169f52(0x10c)])pythonBridge[_0x169f52(0x1f0)](this,_0x169f52(0x190),{'digests':JSON[_0x169f52(0x1c6)](_0x249921[_0x169f52(0x10c)])});aiAgent[_0x169f52(0xe4)](this,_0x169f52(0x1b5)),setTimeout(()=>aiAgent[_0x169f52(0xe4)](this,'DAY'),0x2ee0);}catch(_0x2b23a3){}return;}if(_0x5d8e4b[_0x169f52(0xc7)](_0x169f52(0x14f))&&_0x489249[_0x169f52(0x10c)]){this[_0x169f52(0x10e)](_0x5d8e4b,{'val':![],'ack':!![]}),await this['triggerEnergyPrediction']();return;}if(_0x5d8e4b[_0x169f52(0xc7)]('analysis.training.triggerComfort')&&_0x489249[_0x169f52(0x10c)]){this[_0x169f52(0x10e)](_0x5d8e4b,{'val':![],'ack':!![]});if(this[_0x169f52(0x1f1)])try{const _0x5b2000=await this[_0x169f52(0x16a)](_0x169f52(0xf7));if(_0x5b2000&&_0x5b2000[_0x169f52(0x10c)]){const _0x3eaae8={};if(this[_0x169f52(0xfb)][_0x169f52(0x18c)])this[_0x169f52(0xfb)][_0x169f52(0x18c)]['forEach'](_0x357731=>{if(_0x357731['id']&&_0x357731['type'])_0x3eaae8[_0x357731['id']]=_0x357731['type'];});pythonBridge['send'](this,'TRAIN_COMFORT',{'events':JSON[_0x169f52(0x1c6)](_0x5b2000[_0x169f52(0x10c)]),'deviceMap':_0x3eaae8});}}catch(_0x1b9647){}return;}if(_0x5d8e4b[_0x169f52(0xc7)](_0x169f52(0x150))&&_0x489249['val']){this['setState'](_0x5d8e4b,{'val':![],'ack':!![]}),topology[_0x169f52(0xd8)](this);if(this[_0x169f52(0x1f1)])try{const _0x296059=await this[_0x169f52(0x16a)](_0x169f52(0xd7));if(_0x296059&&_0x296059[_0x169f52(0x10c)])pythonBridge['send'](this,'TRAIN_TOPOLOGY',{'sequences':JSON['parse'](_0x296059[_0x169f52(0x10c)])});}catch(_0x1e014a){}return;}}const _0x43e4e8=(this['config'][_0x169f52(0x18c)]||[])[_0x169f52(0x1b3)](_0x4e3930=>_0x4e3930['id']===_0x5d8e4b);if(_0x43e4e8){const _0x4648d0=await recorder['processSensorEvent'](this,_0x5d8e4b,_0x489249,_0x43e4e8);_0x4648d0&&this[_0x169f52(0x10e)]('analysis.visualization.pulse',{'val':Date[_0x169f52(0xc5)](),'ack':!![]});_0x4648d0&&_0x4648d0[_0x169f52(0x187)]===_0x169f52(0x104)&&_0x4648d0[_0x169f52(0x1e7)]&&this[_0x169f52(0x1f1)]&&deadMan[_0x169f52(0x126)](this,_0x4648d0[_0x169f52(0x1e7)]);_0x489249[_0x169f52(0x10c)]&&(_0x489249['val']===!![]||_0x489249[_0x169f52(0x10c)]===0x1||String(_0x489249[_0x169f52(0x10c)])['toLowerCase']()===_0x169f52(0x1ae))&&(_0x43e4e8['type']&&(_0x43e4e8[_0x169f52(0x187)][_0x169f52(0xc7)](_0x169f52(0x125))||_0x43e4e8[_0x169f52(0x187)][_0x169f52(0xc7)](_0x169f52(0x1a9)))&&this[_0x169f52(0xff)](_0x43e4e8));if(_0x43e4e8[_0x169f52(0x187)]===_0x169f52(0x1b4)||_0x43e4e8[_0x169f52(0x187)]===_0x169f52(0xd4)){if(this[_0x169f52(0x168)][_0x169f52(0x196)])automation[_0x169f52(0x1cd)](this);}}}async[a0_0x5d0ec5(0x16f)](_0x322ed8){const _0x13cd22=a0_0x5d0ec5;if(!this[_0x13cd22(0xdd)]||Date['now']()-this[_0x13cd22(0x1ce)]>0x493e0)return;try{const _0x4f6b13=JSON['parse'](_0x322ed8),_0x28402c=this['memoryCache'][_0x13cd22(0x1f6)];let _0x2a0b87=![];for(const _0x10ba93 in _0x28402c){if(_0x28402c[_0x10ba93]['includes']('AI')&&_0x4f6b13[_0x10ba93]&&!_0x4f6b13[_0x10ba93][_0x13cd22(0xc7)]('AI')){_0x2a0b87=!![];break;}}_0x2a0b87&&(await this[_0x13cd22(0x164)](_0x13cd22(0x1dd),{'val':JSON[_0x13cd22(0x17f)](this[_0x13cd22(0xdd)][_0x13cd22(0x118)]),'ack':!![]}),await this[_0x13cd22(0x164)](_0x13cd22(0x1ac),{'val':JSON[_0x13cd22(0x17f)](this[_0x13cd22(0xdd)][_0x13cd22(0x1f6)]),'ack':!![]}));}catch(_0x1a8763){}}async[a0_0x5d0ec5(0x111)](){const _0x199a33=a0_0x5d0ec5;try{const _0x530b6b=await this[_0x199a33(0x16a)](setup[_0x199a33(0xdf)]);if(_0x530b6b&&_0x530b6b[_0x199a33(0x10c)])this['currentSystemMode']=_0x530b6b['val'];}catch(_0x464cec){this[_0x199a33(0x17e)]=setup['SYSTEM_MODES'][_0x199a33(0x127)];}}async[a0_0x5d0ec5(0xea)](){const _0x2ea3f9=a0_0x5d0ec5,_0x155736=this[_0x2ea3f9(0xfb)][_0x2ea3f9(0x183)]||[];if(_0x155736[_0x2ea3f9(0x15d)]===0x0)return![];const _0x5e4e00=[],_0x2bf80f=Date[_0x2ea3f9(0xc5)](),_0x5d9fe8=0x5*0x3c*0x3e8;for(const _0x10ce88 of _0x155736){try{let _0x4d7ac9=![];try{const _0x46f54c=await this['getForeignStateAsync'](_0x10ce88+_0x2ea3f9(0x13b));if(_0x46f54c&&_0x46f54c[_0x2ea3f9(0x10c)]===!![])_0x4d7ac9=!![];}catch(_0x44beea){}if(!_0x4d7ac9)try{const _0x1bbb63=await this[_0x2ea3f9(0x16d)](_0x10ce88+_0x2ea3f9(0x1d7));if(_0x1bbb63&&_0x1bbb63['ts']){const _0x1de434=_0x2bf80f-_0x1bbb63['ts'];if(_0x1de434<_0x5d9fe8)_0x4d7ac9=!![];}}catch(_0x4801e3){}if(!_0x4d7ac9)try{const _0x2b5377=await this[_0x2ea3f9(0x16d)](_0x10ce88+_0x2ea3f9(0x115));if(_0x2b5377&&typeof _0x2b5377['val']==='number'&&_0x2b5377[_0x2ea3f9(0x10c)]>0x0)_0x4d7ac9=!![];}catch(_0x3db5e2){}if(!_0x4d7ac9)try{const _0x4b629d=await this['getForeignStateAsync'](_0x10ce88);if(_0x4b629d){const _0x34dc2a=_0x2bf80f-(_0x4b629d['ts']||0x0);_0x34dc2a<_0x5d9fe8&&(_0x4b629d[_0x2ea3f9(0x10c)]===!![]||_0x4b629d['val']===_0x2ea3f9(0x14b)||_0x4b629d['val']===0x1)&&(_0x4d7ac9=!![]);}}catch(_0x3650fd){}if(_0x4d7ac9){const _0x52cfd1=_0x10ce88[_0x2ea3f9(0xe8)]('.'),_0x33ebd1=_0x52cfd1[_0x52cfd1[_0x2ea3f9(0x15d)]-0x1]||_0x10ce88;_0x5e4e00['push'](_0x33ebd1);}}catch(_0x5ce6c0){this[_0x2ea3f9(0xf2)][_0x2ea3f9(0x1f2)]('checkWifiPresence:\x20Error\x20checking\x20'+_0x10ce88+':\x20'+_0x5ce6c0[_0x2ea3f9(0x102)]);}}const _0x561591=_0x5e4e00[_0x2ea3f9(0x15d)]>0x0?_0x5e4e00[_0x2ea3f9(0xd0)](',\x20'):_0x2ea3f9(0x1d9);return await this[_0x2ea3f9(0x164)](_0x2ea3f9(0x107),{'val':_0x561591,'ack':!![]}),_0x5e4e00[_0x2ea3f9(0x15d)]>0x0;}async[a0_0x5d0ec5(0xfe)](){const _0x264769=a0_0x5d0ec5;await aiAgent[_0x264769(0x1bf)](this);this[_0x264769(0x168)][_0x264769(0x1ee)]&&(this['updateHealthVector'](),this[_0x264769(0x1e8)]());if(this[_0x264769(0x168)][_0x264769(0x196)])this[_0x264769(0x120)]();}async[a0_0x5d0ec5(0x1e9)](){return![];}['triggerGaitAnalysis'](){if(!this['isProVersion'])return;}async['triggerEnergyPrediction'](){const _0x51c409=a0_0x5d0ec5;if(!this[_0x51c409(0x1f1)]||!this[_0x51c409(0x168)][_0x51c409(0x196)])return;try{const _0x5da475={},_0x36395f={},_0x17005d=this[_0x51c409(0xfb)][_0x51c409(0x18c)]||[];for(const _0xd2918f of _0x17005d){if((_0xd2918f[_0x51c409(0x187)]===_0x51c409(0x1b4)||_0xd2918f['type']==='thermostat')&&_0xd2918f[_0x51c409(0x1e7)])try{const _0x37d7e6=await this[_0x51c409(0x16d)](_0xd2918f['id']);_0x37d7e6&&typeof _0x37d7e6[_0x51c409(0x10c)]===_0x51c409(0x142)&&(_0x5da475[_0xd2918f[_0x51c409(0x1e7)]]=_0x37d7e6[_0x51c409(0x10c)],_0x36395f[_0xd2918f['location']]=_0xd2918f[_0x51c409(0x121)]||![]);}catch(_0x2eeae2){}}let _0x108870=0xa;if(this[_0x51c409(0xfb)]['weatherTempId'])try{const _0x4404d5=await this['getForeignStateAsync'](this[_0x51c409(0xfb)][_0x51c409(0x1a3)]);if(_0x4404d5&&typeof _0x4404d5[_0x51c409(0x10c)]===_0x51c409(0x142))_0x108870=_0x4404d5[_0x51c409(0x10c)];}catch(_0x4dfd15){}const _0x2112fc=await this[_0x51c409(0x1e9)]();let _0x439eb6={};try{const _0x59867b=await this[_0x51c409(0x16a)]('analysis.energy.warmupTargets');if(_0x59867b&&_0x59867b[_0x51c409(0x10c)])_0x439eb6=JSON[_0x51c409(0x1c6)](_0x59867b['val']);}catch(_0x460208){}pythonBridge[_0x51c409(0x1f0)](this,'PREDICT_ENERGY',{'current_temps':_0x5da475,'t_out':_0x108870,'is_sunny':_0x2112fc,'solar_flags':_0x36395f,'warmup_targets':_0x439eb6}),this[_0x51c409(0xf2)]['info']('üîÆ\x20Energy\x20Prediction\x20triggered\x20('+Object[_0x51c409(0x141)](_0x5da475)[_0x51c409(0x15d)]+'\x20rooms)');}catch(_0x23ba56){this[_0x51c409(0xf2)]['warn'](_0x51c409(0x163)+_0x23ba56[_0x51c409(0x102)]);}}[a0_0x5d0ec5(0xc8)](){}async['handleInfrasound'](_0x2ab273){}async[a0_0x5d0ec5(0xe6)](_0x491cec,_0x5e6e58){}async[a0_0x5d0ec5(0xff)](_0x28463a){}async[a0_0x5d0ec5(0x17b)](_0x2a7884){}['sendNotification'](_0xdcca9c){}}if(require[a0_0x5d0ec5(0x13d)]!==module)module['exports']=_0x5e1071=>new CogniLiving(_0x5e1071);else new CogniLiving();function a0_0x4037(_0x1b4f64,_0x3b541b){const _0x160a7b=a0_0x350e();return a0_0x4037=function(_0x616a97,_0x1fde39){_0x616a97=_0x616a97-0xb3;let _0x350e39=_0x160a7b[_0x616a97];return _0x350e39;},a0_0x4037(_0x1b4f64,_0x3b541b);}function a0_0x350e(){const _0x4f8f84=['isSolar','presenceCheckTimer','analysis.health.todayRoomDetails','value','window','updateLocation','NORMAL','Sec-Training\x20started...','\x22history\x22:{}','üì¶\x20Restored\x20','Say\x20Hello','analysis.prediction.trackerConfidence','./lib/python_bridge','checkCalendarTriggers','calendarCheckTimer','system','initSchedules','timestamp','analysis.automation.description','analysis.health.geminiNight','.json','python','toLowerCase','exitTimer','calendarName','@iobroker/adapter-core','.isOnline','stateChange','main','from','analysis.health.geminiDay','analysis.automation.targetId','keys','number','events.history','TRAIN_SECURITY','History\x20Save\x20Error:\x20','ready','automation.triggerAction','\x20events\x20from\x20today...','writeFileSync','./lib/installer','online','analysis.trigger','enum','onReady','analysis.training.triggerEnergy','analysis.training.triggerTopology','toISOString','analysis.activity.roomStats','enum.functions.*','manual','cogni-living','generateContent','namespace','testApiKey','todayVector','3941148tjAscw','startSystem','haust√ºr','length','search','VACATION','infrasoundLocked','getHistoryData','briefingJob','triggerEnergyPrediction\x20Error:\x20','setStateAsync',',\x20Temp:\x20','security','...','activeModules','saveDailyHistory','getStateAsync','apiKey','utf8','getForeignStateAsync','Sonne:\x20','protectAiMemory','analysis.health.todayVector','date','ack','add','./lib/dead_man','licenseKey','trackerHeartbeat','Aktiv\x20(','unload','stopService','57932aljrPg','appendToLog','history','getHours','currentSystemMode','stringify','party','Corrupt','name','presenceDevices','max','isPresent','moduleEnergy','type','analysis.activity.roomHistory','LTM.triggerDailyDigest','Warte\x20auf\x20Analyse...','terrasse','devices','getGenerativeModel','subscribeForeignStatesAsync','Kein\x20API\x20Key\x20√ºbergeben.','TRAIN_HEALTH','replace','pop','Party\x20Mode','ltmJob','createDailyDigest','energy','apply','moduleHealth','debug','fill','2719866GdElYN','all','geminiApiKey','SET_LEARNING_MODE','Unknown','\x20Kalender-Adapter\x20gefunden.','geminiModel','readFileSync','weatherTempId','mkdirSync','getForeignObjectsAsync','exitGraceTimer','Init...','initSystemConfig','door','lastTrackerEventTime','infrasoundEnabled','analysis.energy.warmupSources','isRelevantActivity','open','text','cancel','analysisHistory','checkLicense','find','temperature','NIGHT','common','min','bind','Standard','sendMorningBriefing','slice','inactivityThresholdHours','‚úÖ\x20History\x20saved:\x20','./lib/setup','runGeminiAnalysis','moduleComfort','system.adapter.ical.','sensorLastValues','scanForDevices','application/json','object','parse','setObjectNotExistsAsync','@google/generative-ai','113182fWuGdN','onUnload','Adapter','Scan\x20Error:\x20','cleanupGhostInterventions','bootTime','existsSync','useCalendar','comfort','info','getEnums','subscribeStates','CALCULATE_HEALTH_TREND','infrasoundSensorId','.last_seen','10diDCFb','Niemand','General\x20Activity\x20Trend','driftAnalysisTimer','endsWith','analysis.energy.warmupTimes','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','sendTo','5lUeeHY','toLocaleDateString','Warm-Up\x20Time','replayTodayEvents','bin','analysis.automation.targetValue','cogni-living\x20adapter\x20starting\x20(v','location','triggerGaitAnalysis','checkSolarCondition','analysis.training.triggerSecurity','analysis.training.status','system.adapter.','modules','health','./lib/ai_agent','send','isProVersion','warn','.system.mode','./lib/recorder','then','sources','string','SYSTEM_MODES','push','448OZBQBJ','genAI','json','refreshCalendar\x20failed:\x20','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','3prVjxY','analysis.visualization.pulse','9tZWMrH','getOverviewData','historyJob','setHours','updateSchedulePreview','\x20Tage)','roomIntegratorTimer','minDaysForBaseline','executeAutomationAction','now','112432OImACz','includes','updateHealthVector','scanThermostats','4551310CmqhCO','integrateRoomTime','forEach','round','outdoorSensorId','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','join','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','.venv','./lib/scheduler','thermostat','getAbsoluteDefaultDataDir','pressureBuffer','LTM.trainingData.sequences','updateTopology','setDate','path','Daily\x20Activity\x20Vector\x20(48x30min)','./lib/automation','memoryCache','onStateChange','SYSTEM_DP_MODE','communicate.request','triggerDailyDigest','onMessage','eventHistory','generateHealthReport','analysis.security.lastScore','triggerInfrasoundCorrelation','getObjectViewAsync','split','(((.+)+)+)+$','checkWifiPresence','runPythonHealthCheck','analysis.security.learningStatus','command','\x20events\x20from\x20standard\x20storage.','checkThermostats','toString','node-schedule','log','Lernphase\x20(','analysis.health.activityTrend','scheduleJob','guest','LTM.rawEventLog','healthTrendInterval','No\x20data','setPresence','config','Gemini\x20Init\x20Error:\x20','filter','runAutopilot','analyzeWindowOpening','state','callback','message','analysisTimer','motion','subscribeForeignStates','Live\x20Event\x20Pulse','system.presenceWho','analysis.training.triggerHealth','response','getMinutes','values','val','[Integrator]\x20Error:\x20','setState','telegram','rawEventLog','loadSystemMode','abortExitTimer','dependencyInstallInProgress','rows','.uptime','Gemini\x20Report\x20Night','13193700zoJaHQ','times','11MidjiQ','instance','moduleSecurity','{\x22history\x22:{}}','dailyDigests','substring','analysis.automation.patternDetected','triggerEnergyPrediction'];a0_0x350e=function(){return _0x4f8f84;};return a0_0x350e();}