const a0_0x6951a=a0_0x81cc;(function(_0x45dfad,_0x272703){const _0x3f24d5=a0_0x81cc,_0x251c36=_0x45dfad();while(!![]){try{const _0x5cdc25=parseInt(_0x3f24d5(0x284))/0x1+parseInt(_0x3f24d5(0x27f))/0x2*(parseInt(_0x3f24d5(0x1da))/0x3)+parseInt(_0x3f24d5(0x2ac))/0x4*(-parseInt(_0x3f24d5(0x218))/0x5)+parseInt(_0x3f24d5(0x29e))/0x6+-parseInt(_0x3f24d5(0x1e7))/0x7+-parseInt(_0x3f24d5(0x17b))/0x8*(parseInt(_0x3f24d5(0x21f))/0x9)+parseInt(_0x3f24d5(0x1f4))/0xa;if(_0x5cdc25===_0x272703)break;else _0x251c36['push'](_0x251c36['shift']());}catch(_0x3cc362){_0x251c36['push'](_0x251c36['shift']());}}}(a0_0x449f,0xb6ae4));const a0_0x10b23e=(function(){let _0x28c7ca=!![];return function(_0x2b8b18,_0xd7f76b){const _0x43944e=_0x28c7ca?function(){const _0x4320b8=a0_0x81cc;if(_0xd7f76b){const _0x204ede=_0xd7f76b[_0x4320b8(0x1ce)](_0x2b8b18,arguments);return _0xd7f76b=null,_0x204ede;}}:function(){};return _0x28c7ca=![],_0x43944e;};}()),a0_0x489e03=a0_0x10b23e(this,function(){const _0x31a350=a0_0x81cc;return a0_0x489e03['toString']()[_0x31a350(0x1c6)](_0x31a350(0x26c))[_0x31a350(0x1e0)]()[_0x31a350(0x19c)](a0_0x489e03)[_0x31a350(0x1c6)]('(((.+)+)+)+$');});a0_0x489e03();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x6951a(0x257)),schedule=require(a0_0x6951a(0x1ea)),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL='models/gemini-flash-latest',ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE='0\x203\x20*\x20*\x20*',LTM_DP_RAW_LOG=a0_0x6951a(0x256),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x6951a(0x1ad),LTM_DP_DRIFT_CHANNEL=a0_0x6951a(0x275),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x6951a(0x207),LTM_DP_DRIFT_LAST_CHECK=a0_0x6951a(0x1de),SYSTEM_DP_MODE='system.mode',MODE_RESET_SCHEDULE=a0_0x6951a(0x286),SYSTEM_MODES={'NORMAL':a0_0x6951a(0x264),'VACATION':a0_0x6951a(0x27c),'PARTY':a0_0x6951a(0x2a5),'GUEST':a0_0x6951a(0x17c)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x6951a(0x241)],SYSTEM_MODES[a0_0x6951a(0x239)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':a0_0x6951a(0x209),'family':a0_0x6951a(0x193),'single_comfort':a0_0x6951a(0x222),'security':'PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.'};class CogniLiving extends utils[a0_0x6951a(0x198)]{constructor(_0x426c63){const _0x3a273b=a0_0x6951a;super({..._0x426c63,'name':_0x3a273b(0x28a)}),this['eventHistory']=[],this[_0x3a273b(0x1be)]=[],this[_0x3a273b(0x175)]=[],this[_0x3a273b(0x162)]=[],this[_0x3a273b(0x247)]=[],this[_0x3a273b(0x1cc)]={},this[_0x3a273b(0x270)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x3a273b(0x206)]=!![],this[_0x3a273b(0x296)]=null,this['exitGraceTimer']=null,this[_0x3a273b(0x2b0)]=![],this[_0x3a273b(0x17e)]=null,this[_0x3a273b(0x22d)]=null,this[_0x3a273b(0x2a7)]=SYSTEM_MODES[_0x3a273b(0x1db)],this[_0x3a273b(0x1f6)]=![],this[_0x3a273b(0x297)]=![],this['systemUUID']='unknown',this['analysisTimer']=null,this[_0x3a273b(0x244)]=null,this[_0x3a273b(0x16f)]=null,this[_0x3a273b(0x1a5)]=null,this['on'](_0x3a273b(0x25f),this[_0x3a273b(0x1f1)][_0x3a273b(0x266)](this)),this['on'](_0x3a273b(0x231),this[_0x3a273b(0x21a)][_0x3a273b(0x266)](this)),this['on'](_0x3a273b(0x246),this[_0x3a273b(0x161)][_0x3a273b(0x266)](this)),this['on'](_0x3a273b(0x1fe),this[_0x3a273b(0x235)][_0x3a273b(0x266)](this));}async[a0_0x6951a(0x1f1)](){const _0x5131f4=a0_0x6951a;this[_0x5131f4(0x1e1)][_0x5131f4(0x20e)](_0x5131f4(0x16d)+this['version']+')\x20-\x20DEBUG\x20MODE\x20ENABLED'),await this['cleanUpZombies'](),this['config'][_0x5131f4(0x299)]=this['config'][_0x5131f4(0x299)]||'',this[_0x5131f4(0x1f6)]=await this[_0x5131f4(0x2a1)](this[_0x5131f4(0x27e)][_0x5131f4(0x299)]);if(!this['config'][_0x5131f4(0x1e2)]||this['config']['inactivityThresholdHours']<0.1)this[_0x5131f4(0x27e)][_0x5131f4(0x1e2)]=0xc;await this[_0x5131f4(0x20b)]();try{const _0x75e309=await this[_0x5131f4(0x171)](_0x5131f4(0x1fb));_0x75e309&&_0x75e309['common']&&(this[_0x5131f4(0x270)]={'latitude':_0x75e309[_0x5131f4(0x15e)]['latitude']||0x0,'longitude':_0x75e309[_0x5131f4(0x15e)][_0x5131f4(0x1aa)]||0x0,'city':_0x75e309[_0x5131f4(0x15e)]['city']||''},this['log'][_0x5131f4(0x20e)]('üìç\x20Standort\x20geladen:\x20'+this[_0x5131f4(0x270)][_0x5131f4(0x265)]));}catch(_0x445a74){this[_0x5131f4(0x1e1)]['warn'](_0x5131f4(0x251));}if(this[_0x5131f4(0x27e)][_0x5131f4(0x18c)])try{this[_0x5131f4(0x17e)]=new GoogleGenerativeAI(this[_0x5131f4(0x27e)][_0x5131f4(0x18c)]),this[_0x5131f4(0x22d)]=this['genAI'][_0x5131f4(0x291)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5131f4(0x213)}}),this['log'][_0x5131f4(0x20e)](_0x5131f4(0x1c5));}catch(_0x7f476c){this['log']['error'](_0x5131f4(0x170)+_0x7f476c[_0x5131f4(0x1fe)]);}else this[_0x5131f4(0x1e1)][_0x5131f4(0x217)]('Gemini\x20API\x20Key\x20missing.\x20AI\x20features\x20disabled.');await this[_0x5131f4(0x1e8)](),await this['loadSystemMode'](),await this[_0x5131f4(0x1d0)](),await this[_0x5131f4(0x29a)](),this[_0x5131f4(0x200)](_0x5131f4(0x1c7)),this[_0x5131f4(0x200)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates']('system.mode');const _0x4fa78c=this['config'][_0x5131f4(0x1c3)];if(_0x4fa78c&&_0x4fa78c[_0x5131f4(0x1a7)]>0x0){this[_0x5131f4(0x1e1)][_0x5131f4(0x20e)]('Subscribing\x20to\x20'+_0x4fa78c[_0x5131f4(0x1a7)]+_0x5131f4(0x181));for(const _0x539e62 of _0x4fa78c){if(_0x539e62['id']){await this[_0x5131f4(0x289)](_0x539e62['id']);try{const _0x45f72d=await this[_0x5131f4(0x1a1)](_0x539e62['id']);if(_0x45f72d)this['sensorLastValues'][_0x539e62['id']]=_0x45f72d[_0x5131f4(0x1e6)];}catch(_0x2893fc){}}}}if(this[_0x5131f4(0x1b5)])clearInterval(this[_0x5131f4(0x1b5)]);const _0x34bc03=this[_0x5131f4(0x27e)][_0x5131f4(0x28b)]||0xf;_0x34bc03>0x0&&(this[_0x5131f4(0x1e1)]['info'](_0x5131f4(0x179)+_0x34bc03+_0x5131f4(0x24f)+this['config'][_0x5131f4(0x1e2)]+'h.'),this[_0x5131f4(0x1b5)]=setInterval(()=>this[_0x5131f4(0x1b2)](),_0x34bc03*0x3c*0x3e8)),this[_0x5131f4(0x21d)](),this[_0x5131f4(0x19b)](),this[_0x5131f4(0x205)]();}async[a0_0x6951a(0x20a)](){const _0x434241=a0_0x6951a,_0x5404c3=['analysis.history_debug_00','analysis.history_debug_01','analysis.history_debug_02',_0x434241(0x1a4),'analysis.history_debug_04',_0x434241(0x1e5),'events.history_debug_01',_0x434241(0x2ab),_0x434241(0x294),_0x434241(0x178)];for(const _0x2138f5 of _0x5404c3){try{const _0x264b5c=await this['getObjectAsync'](_0x2138f5);_0x264b5c&&await this[_0x434241(0x1e9)](_0x2138f5);}catch(_0x577102){}}}async[a0_0x6951a(0x20b)](){const _0xdfd3c3=a0_0x6951a;try{const _0x291265=await this[_0xdfd3c3(0x18a)]('events.history');_0x291265&&_0x291265[_0xdfd3c3(0x1e6)]&&(this[_0xdfd3c3(0x20f)]=JSON['parse'](_0x291265['val']['toString']()),this[_0xdfd3c3(0x1e1)][_0xdfd3c3(0x20e)]('Loaded\x20'+this[_0xdfd3c3(0x20f)]['length']+_0xdfd3c3(0x167)));}catch(_0x1c3996){this[_0xdfd3c3(0x20f)]=[];}try{const _0x495e7b=await this[_0xdfd3c3(0x18a)](_0xdfd3c3(0x195));if(_0x495e7b&&_0x495e7b[_0xdfd3c3(0x1e6)])this['analysisHistory']=JSON[_0xdfd3c3(0x22c)](_0x495e7b['val']['toString']());}catch(_0x1615ec){this[_0xdfd3c3(0x1be)]=[];}}[a0_0x6951a(0x21a)](_0x5863aa,_0x19f65b){const _0x34c918=a0_0x6951a;if(!_0x19f65b)return;if(_0x5863aa===this[_0x34c918(0x24c)]+'.'+SYSTEM_DP_MODE){_0x19f65b[_0x34c918(0x1e6)]&&Object[_0x34c918(0x1fc)](SYSTEM_MODES)['includes'](_0x19f65b['val'])&&(this[_0x34c918(0x2a7)]=_0x19f65b[_0x34c918(0x1e6)],_0x19f65b['val']===SYSTEM_MODES[_0x34c918(0x1b4)]?this['setPresence'](![]):this[_0x34c918(0x1eb)](!![]));if(!_0x19f65b[_0x34c918(0x1f8)])this[_0x34c918(0x19e)](_0x5863aa,{'val':this[_0x34c918(0x2a7)],'ack':!![]});return;}if(!_0x19f65b[_0x34c918(0x1f8)]){_0x5863aa[_0x34c918(0x219)](_0x34c918(0x1c7))&&_0x19f65b[_0x34c918(0x1e6)]&&(this[_0x34c918(0x1e1)][_0x34c918(0x20e)](_0x34c918(0x292)),this[_0x34c918(0x19e)](_0x5863aa,{'val':![],'ack':!![]}),this['runGeminiAnalysis']());if(_0x5863aa[_0x34c918(0x219)](_0x34c918(0x1d8))&&_0x19f65b[_0x34c918(0x1e6)]){this[_0x34c918(0x19e)](_0x5863aa,{'val':![],'ack':!![]});if(this[_0x34c918(0x1f6)])this[_0x34c918(0x1b3)]();}return;}const _0x9075aa=(this[_0x34c918(0x27e)][_0x34c918(0x1c3)]||[])[_0x34c918(0x281)](_0x3f20f5=>_0x3f20f5['id']===_0x5863aa);if(_0x9075aa)this['processSensorEvent'](_0x5863aa,_0x19f65b,_0x9075aa);}async[a0_0x6951a(0x2a6)](_0x26874a,_0x2645bf,_0x2a9e9b){const _0x2bf35b=a0_0x6951a;if(!_0x2a9e9b[_0x2bf35b(0x185)]&&this['sensorLastValues'][_0x26874a]===_0x2645bf['val'])return;this[_0x2bf35b(0x1cc)][_0x26874a]=_0x2645bf[_0x2bf35b(0x1e6)];if(this[_0x2bf35b(0x2b0)]){this[_0x2bf35b(0x1e1)][_0x2bf35b(0x210)](_0x2bf35b(0x274)+_0x2a9e9b[_0x2bf35b(0x1c4)]);return;}const _0x3be3a0=_0x2a9e9b['type']===_0x2bf35b(0x1a6)&&(_0x2a9e9b[_0x2bf35b(0x1c4)][_0x2bf35b(0x28c)]()[_0x2bf35b(0x219)]('haust√ºr')||_0x2a9e9b['name'][_0x2bf35b(0x28c)]()[_0x2bf35b(0x219)]('eingang')||_0x2a9e9b[_0x2bf35b(0x188)]['toLowerCase']()[_0x2bf35b(0x219)](_0x2bf35b(0x2a8)));_0x3be3a0&&!_0x2645bf[_0x2bf35b(0x1e6)]?this[_0x2bf35b(0x208)]():(this[_0x2bf35b(0x296)]&&(this[_0x2bf35b(0x1e1)][_0x2bf35b(0x20e)](_0x2bf35b(0x1b9)),this[_0x2bf35b(0x15d)]()),!this['isPresent']&&this[_0x2bf35b(0x2a7)]===SYSTEM_MODES[_0x2bf35b(0x1db)]&&this[_0x2bf35b(0x1eb)](!![]));const _0x33a054={'timestamp':_0x2645bf['ts'],'id':_0x26874a,'name':_0x2a9e9b[_0x2bf35b(0x1c4)],'value':_0x2645bf[_0x2bf35b(0x1e6)],'location':_0x2a9e9b[_0x2bf35b(0x188)],'type':_0x2a9e9b[_0x2bf35b(0x22a)]};this[_0x2bf35b(0x20f)][_0x2bf35b(0x166)](_0x33a054);if(this[_0x2bf35b(0x20f)]['length']>HISTORY_MAX_SIZE)this[_0x2bf35b(0x20f)][_0x2bf35b(0x276)]();await this[_0x2bf35b(0x1dd)](_0x2bf35b(0x1b7),{'val':JSON[_0x2bf35b(0x172)](_0x33a054),'ack':!![]}),await this[_0x2bf35b(0x1dd)](_0x2bf35b(0x17a),{'val':JSON[_0x2bf35b(0x172)](this[_0x2bf35b(0x20f)]),'ack':!![]}),this['rawEventLog'][_0x2bf35b(0x25a)]({'timestamp':new Date(_0x2645bf['ts'])[_0x2bf35b(0x215)](),'sensorName':_0x2a9e9b[_0x2bf35b(0x1c4)],'location':_0x2a9e9b[_0x2bf35b(0x188)],'value':_0x2645bf[_0x2bf35b(0x1e6)]}),await this[_0x2bf35b(0x24e)]();}['startExitTimer'](){const _0x193010=a0_0x6951a;this[_0x193010(0x1e1)][_0x193010(0x20e)](_0x193010(0x248)+EXIT_TIMER_MINUTES+_0x193010(0x173)+EXIT_GRACE_PERIOD_SECONDS+_0x193010(0x1ab)),this[_0x193010(0x15d)](),this['isGracePeriodActive']=!![],this[_0x193010(0x201)]=setTimeout(()=>{const _0x4d976f=_0x193010;this[_0x4d976f(0x2b0)]=![],this[_0x4d976f(0x1e1)][_0x4d976f(0x210)](_0x4d976f(0x25b));},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x193010(0x296)]=setTimeout(()=>{const _0x1fd5f5=_0x193010;this[_0x1fd5f5(0x1e1)][_0x1fd5f5(0x20e)](_0x1fd5f5(0x1cd)),this[_0x1fd5f5(0x1eb)](![]),this['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}['abortExitTimer'](){const _0x5f41e3=a0_0x6951a;if(this[_0x5f41e3(0x296)])clearTimeout(this[_0x5f41e3(0x296)]);if(this[_0x5f41e3(0x201)])clearTimeout(this[_0x5f41e3(0x201)]);this[_0x5f41e3(0x296)]=null,this[_0x5f41e3(0x201)]=null,this['isGracePeriodActive']=![];}async[a0_0x6951a(0x1eb)](_0xf883ed){const _0x83c2b4=a0_0x6951a;if(this[_0x83c2b4(0x206)]===_0xf883ed)return;this[_0x83c2b4(0x206)]=_0xf883ed,await this[_0x83c2b4(0x1dd)](_0x83c2b4(0x204),{'val':_0xf883ed,'ack':!![]}),this['log'][_0x83c2b4(0x20e)](_0x83c2b4(0x196)+(_0xf883ed?_0x83c2b4(0x1c0):'ABWESEND\x20‚úàÔ∏è'));}[a0_0x6951a(0x1b2)](){const _0x3f944f=a0_0x6951a,_0x4af5de=this['config'][_0x3f944f(0x1e2)],_0x430501=this['config'][_0x3f944f(0x163)],_0xaf0d78=this['eventHistory'][_0x3f944f(0x1a7)]>0x0?this[_0x3f944f(0x20f)][0x0][_0x3f944f(0x255)]:Date['now'](),_0x3260da=(Date[_0x3f944f(0x268)]()-_0xaf0d78)/(0x3e8*0x3c*0x3c);let _0xbaef32='';_0x430501&&this[_0x3f944f(0x2a7)]===SYSTEM_MODES['NORMAL']&&this[_0x3f944f(0x206)]&&(_0x3260da>_0x4af5de&&(this['log']['warn'](_0x3f944f(0x1bf)+_0x3260da[_0x3f944f(0x214)](0x1)+'\x20Stunden!'),_0xbaef32=_0x3f944f(0x18b)+_0x3260da[_0x3f944f(0x214)](0x1)+_0x3f944f(0x2aa)));if(_0xbaef32){this['runGeminiAnalysis'](_0xbaef32)[_0x3f944f(0x24a)](_0x32ca8b=>this[_0x3f944f(0x1e1)][_0x3f944f(0x1c1)](_0x32ca8b));return;}const _0x154026=Date[_0x3f944f(0x268)](),_0x1dd573=_0x154026-_0xaf0d78,_0x893227=(this[_0x3f944f(0x27e)][_0x3f944f(0x28b)]||0xf)*0x3c*0x3e8;this[_0x3f944f(0x20f)]['length']>0x0&&_0x1dd573<=_0x893227?this[_0x3f944f(0x1ef)]()[_0x3f944f(0x24a)](_0x315cc1=>this[_0x3f944f(0x1e1)][_0x3f944f(0x1c1)](_0x315cc1)):!this[_0x3f944f(0x297)]&&(this[_0x3f944f(0x19e)](_0x3f944f(0x23d),{'val':![],'ack':!![]}),this[_0x3f944f(0x19e)](_0x3f944f(0x271),{'val':![],'ack':!![]}));}async[a0_0x6951a(0x1ef)](_0x27ce5f=''){const _0x2ca4b5=a0_0x6951a;this['log'][_0x2ca4b5(0x20e)](_0x2ca4b5(0x26f));if(!this['geminiModel']){this[_0x2ca4b5(0x1e1)][_0x2ca4b5(0x1c1)](_0x2ca4b5(0x160));return;}const _0x3af0e4=this[_0x2ca4b5(0x20f)]['length']>0x0?this[_0x2ca4b5(0x20f)]:[{'note':_0x2ca4b5(0x194)}],_0x3f5a38=PERSONA_MAPPING[this[_0x2ca4b5(0x27e)][_0x2ca4b5(0x2ad)]||_0x2ca4b5(0x1af)],_0x374abd=this[_0x2ca4b5(0x27e)][_0x2ca4b5(0x298)]||'',_0x84f45b=this['currentSystemMode'],_0x2949fd=new Date(),_0x4dd4e0=_0x2949fd[_0x2ca4b5(0x1f7)](_0x2ca4b5(0x233),{'weekday':_0x2ca4b5(0x1b6),'hour':'2-digit','minute':_0x2ca4b5(0x293)}),_0x5961f1=this[_0x2ca4b5(0x270)];let _0x226f1b='';if(this[_0x2ca4b5(0x175)]['length']>0x0){const _0x454000=this[_0x2ca4b5(0x175)][_0x2ca4b5(0x21b)](0x0,0x3)['map'](_0x57d460=>_0x2ca4b5(0x1ae)+_0x57d460[_0x2ca4b5(0x2a9)]+'\x22\x20was\x20'+_0x57d460[_0x2ca4b5(0x18e)]+'.')[_0x2ca4b5(0x242)]('\x0a');_0x226f1b=_0x2ca4b5(0x28d)+_0x454000+'\x0a';}const _0x5781a3=_0x27ce5f?_0x2ca4b5(0x186)+_0x27ce5f+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x1ba17c='Baseline:\x20Inactive\x20(Pro\x20Feature).',_0x23df26=_0x2ca4b5(0x192)+_0x4dd4e0+_0x2ca4b5(0x26d)+_0x5961f1[_0x2ca4b5(0x265)]+_0x2ca4b5(0x1a9)+_0x84f45b+_0x2ca4b5(0x1d3)+(this['isPresent']?'Ja':'Nein')+_0x2ca4b5(0x220)+_0x374abd+_0x2ca4b5(0x225)+_0x3f5a38+_0x2ca4b5(0x1fa)+_0x1ba17c+'\x20'+_0x226f1b+'\x20'+_0x5781a3+_0x2ca4b5(0x282)+JSON[_0x2ca4b5(0x172)](_0x3af0e4)+_0x2ca4b5(0x1c9);try{this[_0x2ca4b5(0x1e1)]['debug'](_0x2ca4b5(0x19d)+_0x23df26[_0x2ca4b5(0x1a7)]+')...');const _0xc6dd93=await this['geminiModel']['generateContent'](_0x23df26),_0x37c7ca=_0xc6dd93['response']['text']()[_0x2ca4b5(0x245)](/```json|```/g,'')[_0x2ca4b5(0x203)]();this[_0x2ca4b5(0x1e1)][_0x2ca4b5(0x20e)]('‚úÖ\x20Gemini\x20Response\x20received.');const _0x49f4ea=JSON[_0x2ca4b5(0x22c)](_0x37c7ca);await this['setStateAsync'](_0x2ca4b5(0x279),{'val':_0x37c7ca,'ack':!![]}),await this['setStateAsync'](_0x2ca4b5(0x202),{'val':_0x49f4ea[_0x2ca4b5(0x27a)][_0x2ca4b5(0x2a9)]||'','ack':!![]}),await this[_0x2ca4b5(0x1dd)](_0x2ca4b5(0x26a),{'val':_0x49f4ea[_0x2ca4b5(0x27a)][_0x2ca4b5(0x1e4)]||'N/A','ack':!![]}),await this[_0x2ca4b5(0x1dd)](_0x2ca4b5(0x221),{'val':_0x49f4ea['activity'][_0x2ca4b5(0x23e)]||_0x2ca4b5(0x1cb),'ack':!![]});_0x49f4ea[_0x2ca4b5(0x1d2)]&&(await this[_0x2ca4b5(0x1dd)](_0x2ca4b5(0x2a3),{'val':_0x49f4ea[_0x2ca4b5(0x1d2)][_0x2ca4b5(0x1e4)]||'','ack':!![]}),await this['setStateAsync'](_0x2ca4b5(0x189),{'val':_0x49f4ea[_0x2ca4b5(0x1d2)][_0x2ca4b5(0x1cf)]||'','ack':!![]}),_0x49f4ea[_0x2ca4b5(0x1d2)][_0x2ca4b5(0x277)]&&(await this['setStateAsync'](_0x2ca4b5(0x27b),{'val':_0x49f4ea[_0x2ca4b5(0x1d2)][_0x2ca4b5(0x277)][_0x2ca4b5(0x19a)]||![],'ack':!![]}),await this[_0x2ca4b5(0x1dd)](_0x2ca4b5(0x237),{'val':_0x49f4ea[_0x2ca4b5(0x1d2)][_0x2ca4b5(0x277)]['description']||'','ack':!![]}),await this[_0x2ca4b5(0x1dd)](_0x2ca4b5(0x273),{'val':_0x49f4ea[_0x2ca4b5(0x1d2)][_0x2ca4b5(0x277)][_0x2ca4b5(0x1bd)]||'','ack':!![]})));const _0x10fdff=_0x49f4ea[_0x2ca4b5(0x27a)][_0x2ca4b5(0x1d6)]||![],_0x4ffb71=_0x49f4ea['activity']['isEmergency']||![];if(_0x10fdff||_0x4ffb71){await this[_0x2ca4b5(0x1dd)](_0x2ca4b5(0x23d),{'val':!![],'ack':!![]}),await this[_0x2ca4b5(0x1dd)]('analysis.isEmergency',{'val':_0x4ffb71,'ack':!![]});if(!this[_0x2ca4b5(0x297)]||_0x4ffb71){const _0x398f9a=_0x4ffb71?_0x2ca4b5(0x1b0):_0x2ca4b5(0x1d7);this[_0x2ca4b5(0x261)](_0x398f9a+':\x20'+_0x49f4ea[_0x2ca4b5(0x27a)][_0x2ca4b5(0x2a9)],![],_0x4ffb71);}}else await this[_0x2ca4b5(0x1dd)](_0x2ca4b5(0x23d),{'val':![],'ack':!![]}),await this[_0x2ca4b5(0x1dd)]('analysis.isEmergency',{'val':![],'ack':!![]});this[_0x2ca4b5(0x297)]=_0x10fdff||_0x4ffb71;const _0x2e3ee6={'timestamp':Date[_0x2ca4b5(0x268)](),'id':Date[_0x2ca4b5(0x268)]()[_0x2ca4b5(0x1e0)](),'analysis':_0x49f4ea,'systemMode':_0x84f45b,'isPro':this[_0x2ca4b5(0x1f6)]};this['updateAnalysisHistory'](_0x2e3ee6);}catch(_0x189d03){this[_0x2ca4b5(0x1e1)]['error'](_0x2ca4b5(0x263)+_0x189d03[_0x2ca4b5(0x1fe)]);}}async[a0_0x6951a(0x1b3)](){const _0x4e2ba0=a0_0x6951a;if(!this[_0x4e2ba0(0x1f6)])return;await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x4e2ba0(0x1d1)+new Date()[_0x4e2ba0(0x1f7)](),'ack':!![]});if(!this[_0x4e2ba0(0x22d)]||this[_0x4e2ba0(0x162)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x4e2ba0(0x1dd)](LTM_DP_STATUS,{'val':_0x4e2ba0(0x180),'ack':!![]});return;}const _0x1481f3=JSON[_0x4e2ba0(0x22c)](JSON['stringify'](this[_0x4e2ba0(0x162)])),_0x47a758=(this[_0x4e2ba0(0x27e)][_0x4e2ba0(0x298)]||'')[_0x4e2ba0(0x28f)](0x0,0x3e8),_0x7f40c1=_0x4e2ba0(0x1f3)+_0x47a758+_0x4e2ba0(0x2ae)+JSON['stringify'](_0x1481f3);try{const _0x38109c=await this[_0x4e2ba0(0x22d)][_0x4e2ba0(0x1dc)](_0x7f40c1),_0x450e1e=JSON[_0x4e2ba0(0x22c)](_0x38109c[_0x4e2ba0(0x1e3)][_0x4e2ba0(0x187)]()[_0x4e2ba0(0x245)](/```json|```/g,'')[_0x4e2ba0(0x203)]());_0x450e1e[_0x4e2ba0(0x1e4)]&&(this[_0x4e2ba0(0x247)][_0x4e2ba0(0x25a)]({'timestamp':new Date()[_0x4e2ba0(0x215)](),'eventCount':_0x1481f3[_0x4e2ba0(0x1a7)],'summary':_0x450e1e['summary'],'activityLevel':_0x450e1e[_0x4e2ba0(0x1bb)],'systemMode':this[_0x4e2ba0(0x2a7)]}),await this[_0x4e2ba0(0x190)](),this[_0x4e2ba0(0x162)]=[],await this['saveRawEventLog'](),await this[_0x4e2ba0(0x1dd)](LTM_DP_STATUS,{'val':_0x4e2ba0(0x1b8)+_0x1481f3[_0x4e2ba0(0x1a7)]+_0x4e2ba0(0x252),'ack':!![]}));}catch(_0x311f6e){await this[_0x4e2ba0(0x1dd)](LTM_DP_STATUS,{'val':_0x4e2ba0(0x18d)+_0x311f6e['message'],'ack':!![]});}}async[a0_0x6951a(0x1e8)](){const _0x76da1=a0_0x6951a;await this['checkSystemObjects'](),await this['setObjectNotExistsAsync']('system.isPresent',{'type':_0x76da1(0x253),'common':{'name':_0x76da1(0x230),'type':_0x76da1(0x295),'role':'indicator','read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x76da1(0x2af)](_0x76da1(0x1b7),{'type':'state','common':{'name':'Last\x20raw\x20event','type':_0x76da1(0x24d),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x76da1(0x2af)](_0x76da1(0x17a),{'type':'state','common':{'name':_0x76da1(0x20c),'type':_0x76da1(0x24d),'role':_0x76da1(0x216),'read':!![],'write':![]},'native':{}}),await this[_0x76da1(0x2af)]('analysis.trigger',{'type':'state','common':{'name':_0x76da1(0x29c),'type':_0x76da1(0x295),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x76da1(0x279),{'type':'state','common':{'name':'Last\x20Result','type':'string','role':_0x76da1(0x216),'read':!![],'write':![]},'native':{}}),await this[_0x76da1(0x2af)](_0x76da1(0x23d),{'type':_0x76da1(0x253),'common':{'name':'AI\x20Alert\x20Status','type':'boolean','role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x76da1(0x271),{'type':'state','common':{'name':_0x76da1(0x1ac),'type':_0x76da1(0x295),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x76da1(0x2af)](_0x76da1(0x202),{'type':_0x76da1(0x253),'common':{'name':_0x76da1(0x229),'type':_0x76da1(0x24d),'role':_0x76da1(0x1d4),'read':!![],'write':![]},'native':{}}),await this[_0x76da1(0x2af)](_0x76da1(0x26a),{'type':_0x76da1(0x253),'common':{'name':'Activity\x20Summary','type':_0x76da1(0x24d),'role':_0x76da1(0x187),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x76da1(0x221),{'type':_0x76da1(0x253),'common':{'name':_0x76da1(0x29f),'type':_0x76da1(0x24d),'role':_0x76da1(0x253),'read':!![],'write':![],'def':_0x76da1(0x1cb)},'native':{}}),await this[_0x76da1(0x2af)]('analysis.comfortSummary',{'type':_0x76da1(0x253),'common':{'name':_0x76da1(0x26e),'type':_0x76da1(0x24d),'role':_0x76da1(0x187),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x76da1(0x189),{'type':_0x76da1(0x253),'common':{'name':_0x76da1(0x23a),'type':_0x76da1(0x24d),'role':_0x76da1(0x187),'read':!![],'write':![]},'native':{}}),await this[_0x76da1(0x28e)](_0x76da1(0x183),{'type':'channel','common':{'name':_0x76da1(0x280)},'native':{}}),await this['setObjectNotExistsAsync'](_0x76da1(0x27b),{'type':_0x76da1(0x253),'common':{'name':'Pattern\x20Detected','type':_0x76da1(0x295),'role':_0x76da1(0x23f),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x76da1(0x2af)](_0x76da1(0x237),{'type':_0x76da1(0x253),'common':{'name':_0x76da1(0x249),'type':'string','role':_0x76da1(0x187),'read':!![],'write':![]},'native':{}}),await this[_0x76da1(0x2af)](_0x76da1(0x273),{'type':'state','common':{'name':'Action','type':_0x76da1(0x24d),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x76da1(0x2af)]('analysis.analysisHistory',{'type':_0x76da1(0x253),'common':{'name':_0x76da1(0x21e),'type':_0x76da1(0x24d),'role':_0x76da1(0x216),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x76da1(0x2af)](_0x76da1(0x1ca),{'type':_0x76da1(0x253),'common':{'name':_0x76da1(0x2a2),'type':_0x76da1(0x24d),'role':_0x76da1(0x216),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['checkLtmObjects'](),await this[_0x76da1(0x234)]();}async['checkSystemObjects'](){const _0x185412=a0_0x6951a;await this[_0x185412(0x28e)](_0x185412(0x1ff),{'type':_0x185412(0x197),'common':{'name':_0x185412(0x22e)},'native':{}}),await this[_0x185412(0x28e)](SYSTEM_DP_MODE,{'type':_0x185412(0x253),'common':{'name':_0x185412(0x278),'type':'string','role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x185412(0x1db)],'states':{[SYSTEM_MODES[_0x185412(0x1db)]]:'Normal',[SYSTEM_MODES['VACATION']]:_0x185412(0x2a4),[SYSTEM_MODES['PARTY']]:_0x185412(0x1d5),[SYSTEM_MODES['GUEST']]:'Gast'}},'native':{}});}async[a0_0x6951a(0x261)](_0x246491,_0x2277d2=![],_0x3ab7f2=![]){const _0x1e4f6a=a0_0x6951a;this[_0x1e4f6a(0x1e1)][_0x1e4f6a(0x20e)]((_0x2277d2?_0x1e4f6a(0x22f):'')+_0x1e4f6a(0x1c2)+_0x246491+'\x22'+(_0x3ab7f2?_0x1e4f6a(0x27d):''));const _0x4983d7=this[_0x1e4f6a(0x27e)];let _0x51f90d=0x0;_0x4983d7[_0x1e4f6a(0x17d)]&&_0x4983d7[_0x1e4f6a(0x16e)]&&(await this[_0x1e4f6a(0x1b1)](_0x4983d7[_0x1e4f6a(0x16e)],'send',{'text':_0x246491,'user':_0x4983d7[_0x1e4f6a(0x267)]}),_0x51f90d++);if(_0x4983d7[_0x1e4f6a(0x1ee)]&&_0x4983d7['notifyPushoverInstance']){let _0x1286a6={'message':_0x246491,'title':_0x3ab7f2?_0x1e4f6a(0x290):_0x1e4f6a(0x15f),'priority':_0x3ab7f2?0x2:0x1,'device':_0x4983d7[_0x1e4f6a(0x1a3)]};_0x3ab7f2&&(_0x1286a6['retry']=0x1e,_0x1286a6['expire']=0xe10,_0x1286a6[_0x1e4f6a(0x2a0)]=_0x1e4f6a(0x260)),await this['sendToAsync'](_0x4983d7[_0x1e4f6a(0x25e)],_0x1e4f6a(0x177),_0x1286a6),_0x51f90d++;}return _0x4983d7[_0x1e4f6a(0x1fd)]&&_0x4983d7[_0x1e4f6a(0x174)]&&(await this[_0x1e4f6a(0x1b1)](_0x4983d7[_0x1e4f6a(0x174)],_0x1e4f6a(0x177),{'text':_0x246491,'to':_0x4983d7['notifyEmailRecipient']}),_0x51f90d++),_0x4983d7['notifyWhatsappEnabled']&&_0x4983d7[_0x1e4f6a(0x236)]&&(await this[_0x1e4f6a(0x1b1)](_0x4983d7['notifyWhatsappInstance'],_0x1e4f6a(0x177),{'text':_0x246491,'phone':_0x4983d7[_0x1e4f6a(0x226)]}),_0x51f90d++),_0x4983d7['notifySignalEnabled']&&_0x4983d7[_0x1e4f6a(0x211)]&&(await this['sendToAsync'](_0x4983d7[_0x1e4f6a(0x211)],_0x1e4f6a(0x177),{'text':_0x246491,'phone':_0x4983d7[_0x1e4f6a(0x223)]}),_0x51f90d++),_0x51f90d;}async[a0_0x6951a(0x1d0)](){const _0x597da2=a0_0x6951a;try{const _0x2cb577=await this['getStateAsync'](LTM_DP_RAW_LOG);if(_0x2cb577&&_0x2cb577[_0x597da2(0x1e6)])this[_0x597da2(0x162)]=JSON[_0x597da2(0x22c)](_0x2cb577[_0x597da2(0x1e6)]);}catch(_0x510377){this[_0x597da2(0x162)]=[];}}async[a0_0x6951a(0x24e)](){const _0x4a8204=a0_0x6951a;this[_0x4a8204(0x162)]['length']>RAW_LOG_MAX_SIZE&&this[_0x4a8204(0x162)]['splice'](0x0,this[_0x4a8204(0x162)][_0x4a8204(0x1a7)]-RAW_LOG_MAX_SIZE),await this[_0x4a8204(0x1dd)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](this[_0x4a8204(0x162)]),'ack':!![]});}async[a0_0x6951a(0x29a)](){const _0x1dc0e4=a0_0x6951a;try{const _0x1b7e0f=await this[_0x1dc0e4(0x18a)](LTM_DP_DAILY_DIGESTS);if(_0x1b7e0f&&_0x1b7e0f[_0x1dc0e4(0x1e6)])this[_0x1dc0e4(0x247)]=JSON[_0x1dc0e4(0x22c)](_0x1b7e0f[_0x1dc0e4(0x1e6)]);}catch(_0x344d7f){this[_0x1dc0e4(0x247)]=[];}await this[_0x1dc0e4(0x238)]();}async[a0_0x6951a(0x190)](_0x282e0b=!![]){const _0x12a7fc=a0_0x6951a,_0x4e18a2=this[_0x12a7fc(0x27e)]['ltmLtbWindowDays']||0x3c;this['dailyDigests']['length']>_0x4e18a2&&this[_0x12a7fc(0x247)][_0x12a7fc(0x232)](0x0,this[_0x12a7fc(0x247)][_0x12a7fc(0x1a7)]-_0x4e18a2);await this['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](this['dailyDigests']),'ack':!![]});if(_0x282e0b)await this[_0x12a7fc(0x238)]();}[a0_0x6951a(0x21d)](){const _0x240c62=a0_0x6951a;if(this[_0x240c62(0x244)])this['ltmJob'][_0x240c62(0x243)]();if(!this['isProVersion']){this[_0x240c62(0x1dd)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this[_0x240c62(0x244)]=schedule[_0x240c62(0x182)](LTM_SCHEDULE,()=>this[_0x240c62(0x1b3)]());}[a0_0x6951a(0x205)](){const _0x56435c=a0_0x6951a;if(this[_0x56435c(0x1a5)])clearInterval(this[_0x56435c(0x1a5)]);if(!this[_0x56435c(0x1f6)])return;this[_0x56435c(0x1a5)]=setInterval(()=>this['runBaselineDriftAnalysis'](),(this['config']['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>this[_0x56435c(0x227)](),0x1388);}async[a0_0x6951a(0x16b)](){const _0x33c471=a0_0x6951a;await this[_0x33c471(0x1dd)]('analysis.activitySummary',{'val':_0x33c471(0x29b),'ack':!![]}),await this[_0x33c471(0x1dd)](_0x33c471(0x221),{'val':this['isProVersion']?_0x33c471(0x224):_0x33c471(0x25d),'ack':!![]}),await this[_0x33c471(0x1dd)](_0x33c471(0x23d),{'val':![],'ack':!![]}),await this[_0x33c471(0x1dd)](_0x33c471(0x271),{'val':![],'ack':!![]}),this[_0x33c471(0x297)]=![];}async['updateAnalysisHistory'](_0x55d7e7){const _0x475dbf=a0_0x6951a;this['analysisHistory'][_0x475dbf(0x166)](_0x55d7e7);if(this[_0x475dbf(0x1be)][_0x475dbf(0x1a7)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x475dbf(0x1be)][_0x475dbf(0x276)]();await this[_0x475dbf(0x1dd)](_0x475dbf(0x195),{'val':JSON[_0x475dbf(0x172)](this['analysisHistory']),'ack':!![]});}['setupModeResetScheduler'](){const _0x2eae2a=a0_0x6951a;if(this[_0x2eae2a(0x16f)])this[_0x2eae2a(0x16f)][_0x2eae2a(0x243)]();this['modeResetJob']=schedule[_0x2eae2a(0x182)](MODE_RESET_SCHEDULE,async()=>{const _0x20dce2=_0x2eae2a;await this[_0x20dce2(0x1f5)](),AUTO_RESET_MODES[_0x20dce2(0x219)](this['currentSystemMode'])&&await this[_0x20dce2(0x1dd)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x20dce2(0x1db)],'ack':![]});});}async[a0_0x6951a(0x238)](){const _0x404320=a0_0x6951a;if(!this[_0x404320(0x1f6)]){await this[_0x404320(0x1dd)](LTM_DP_BASELINE_STATUS,{'val':_0x404320(0x17f),'ack':!![]});return;}const _0x294850=this[_0x404320(0x247)][_0x404320(0x1a7)]>=(this['config']['minDaysForBaseline']||0x7)?_0x404320(0x18f)+this[_0x404320(0x247)][_0x404320(0x1a7)]+_0x404320(0x287):_0x404320(0x26b)+this['dailyDigests'][_0x404320(0x1a7)]+'/'+(this[_0x404320(0x27e)][_0x404320(0x288)]||0x7)+')';await this[_0x404320(0x1dd)](LTM_DP_BASELINE_STATUS,{'val':_0x294850,'ack':!![]});}async[a0_0x6951a(0x1f0)](){const _0x4b6c29=a0_0x6951a;await this[_0x4b6c29(0x28e)](_0x4b6c29(0x212),{'type':_0x4b6c29(0x197),'common':{'name':'LTM'},'native':{}}),await this['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':'Raw\x20Log','type':_0x4b6c29(0x24d),'role':_0x4b6c29(0x216),'read':!![],'write':![]},'native':{}}),await this[_0x4b6c29(0x28e)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x4b6c29(0x1df),'type':_0x4b6c29(0x24d),'role':_0x4b6c29(0x216),'read':!![],'write':![]},'native':{}}),await this[_0x4b6c29(0x28e)](LTM_DP_STATUS,{'type':_0x4b6c29(0x253),'common':{'name':'Processing\x20Status','type':_0x4b6c29(0x24d),'role':_0x4b6c29(0x187),'read':!![],'write':![]},'native':{}}),await this[_0x4b6c29(0x28e)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':'Trigger\x20Digest','type':_0x4b6c29(0x295),'role':_0x4b6c29(0x1d9),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x4b6c29(0x28e)](LTM_DP_BASELINE_STATUS,{'type':_0x4b6c29(0x253),'common':{'name':'Baseline\x20Status','type':'string','role':_0x4b6c29(0x187),'read':!![],'write':![]},'native':{}});}async[a0_0x6951a(0x234)](){const _0x304ee7=a0_0x6951a;await this[_0x304ee7(0x28e)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':'Drift\x20Analysis'},'native':{}}),await this[_0x304ee7(0x28e)](LTM_DP_DRIFT_STATUS,{'type':_0x304ee7(0x253),'common':{'name':'Drift\x20Status','type':'string','role':_0x304ee7(0x253),'read':!![],'write':![],'def':_0x304ee7(0x1cb)},'native':{}}),await this[_0x304ee7(0x28e)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':_0x304ee7(0x24d),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x304ee7(0x28e)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':'Last\x20Check','type':'number','role':_0x304ee7(0x258),'read':!![],'write':![]},'native':{}});}async['runBaselineDriftAnalysis'](){const _0x14e33e=a0_0x6951a;if(!this[_0x14e33e(0x1f6)]||!this[_0x14e33e(0x22d)])return;const _0x442510=this[_0x14e33e(0x27e)][_0x14e33e(0x240)]||0xe;if(this[_0x14e33e(0x247)][_0x14e33e(0x1a7)]<_0x442510+(this[_0x14e33e(0x27e)][_0x14e33e(0x288)]||0x7)){await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x14e33e(0x1f2),'ack':!![]});return;}const _0x30df3c=this[_0x14e33e(0x247)]['slice'](-_0x442510),_0x3e22ef=this[_0x14e33e(0x247)][_0x14e33e(0x21b)](0x0,this['dailyDigests'][_0x14e33e(0x1a7)]-_0x442510),_0x1b3e2e=_0x14e33e(0x168)+JSON[_0x14e33e(0x172)](_0x3e22ef)+_0x14e33e(0x164)+JSON[_0x14e33e(0x172)](_0x30df3c);try{const _0x47a82f=await this[_0x14e33e(0x22d)][_0x14e33e(0x1dc)](_0x1b3e2e),_0x344cd0=JSON[_0x14e33e(0x22c)](_0x47a82f['response'][_0x14e33e(0x187)]()['replace'](/```json|```/g,'')[_0x14e33e(0x203)]());_0x344cd0[_0x14e33e(0x24b)]&&(await this[_0x14e33e(0x1dd)](LTM_DP_DRIFT_STATUS,{'val':_0x344cd0[_0x14e33e(0x24b)],'ack':!![]}),await this[_0x14e33e(0x1dd)](LTM_DP_DRIFT_DETAILS,{'val':_0x344cd0[_0x14e33e(0x23b)],'ack':!![]}),await this[_0x14e33e(0x1dd)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x14e33e(0x268)](),'ack':!![]}));}catch(_0x256c32){}}async['loadSystemMode'](){const _0x2e8aaf=a0_0x6951a;try{const _0x1a502b=await this[_0x2e8aaf(0x18a)](SYSTEM_DP_MODE);_0x1a502b&&_0x1a502b[_0x2e8aaf(0x1e6)]&&Object[_0x2e8aaf(0x1fc)](SYSTEM_MODES)[_0x2e8aaf(0x219)](_0x1a502b[_0x2e8aaf(0x1e6)])?this[_0x2e8aaf(0x2a7)]=_0x1a502b[_0x2e8aaf(0x1e6)]:(this[_0x2e8aaf(0x2a7)]=SYSTEM_MODES[_0x2e8aaf(0x1db)],await this[_0x2e8aaf(0x1dd)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x5e2503){this[_0x2e8aaf(0x2a7)]=SYSTEM_MODES[_0x2e8aaf(0x1db)];}}async['getSystemUUID'](){const _0x12ac09=a0_0x6951a;try{const _0x386126=await this[_0x12ac09(0x171)](_0x12ac09(0x262));if(_0x386126&&_0x386126['native']&&_0x386126['native']['uuid'])return _0x386126[_0x12ac09(0x191)][_0x12ac09(0x1ed)];return _0x12ac09(0x269);}catch(_0x4a7ec8){return _0x12ac09(0x21c);}}async['checkLicense'](_0x3aae75){const _0x3e0767=a0_0x6951a;if(!_0x3aae75)return![];this[_0x3e0767(0x1ec)]=await this[_0x3e0767(0x176)]();if(_0x3aae75===_0x3e0767(0x1bc)||_0x3aae75[_0x3e0767(0x1a2)](_0x3e0767(0x199)))return!![];return![];}[a0_0x6951a(0x161)](_0x546c47){const _0x5bdac9=a0_0x6951a;if(this[_0x5bdac9(0x1b5)])clearInterval(this['analysisTimer']);if(this[_0x5bdac9(0x1a5)])clearInterval(this[_0x5bdac9(0x1a5)]);if(this[_0x5bdac9(0x244)])this[_0x5bdac9(0x244)][_0x5bdac9(0x243)]();if(this[_0x5bdac9(0x16f)])this[_0x5bdac9(0x16f)][_0x5bdac9(0x243)]();if(this['exitTimer'])clearTimeout(this[_0x5bdac9(0x296)]);if(this[_0x5bdac9(0x201)])clearTimeout(this[_0x5bdac9(0x201)]);_0x546c47();}async[a0_0x6951a(0x235)](_0x28765c){const _0x42485c=a0_0x6951a;if(typeof _0x28765c==='object'&&_0x28765c[_0x42485c(0x1fe)]){if(_0x28765c[_0x42485c(0x1c8)]===_0x42485c(0x1f9)){if(!_0x28765c[_0x42485c(0x1fe)][_0x42485c(0x285)])return this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':![],'message':'No\x20Key'},_0x28765c[_0x42485c(0x228)]);try{const _0x682a38=new GoogleGenerativeAI(_0x28765c[_0x42485c(0x1fe)]['apiKey'])[_0x42485c(0x291)]({'model':'models/gemini-flash-latest'});await _0x682a38['generateContent'](_0x42485c(0x16a)),this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':!![],'message':_0x42485c(0x29d)},_0x28765c['callback']);}catch(_0xd46b96){this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':![],'message':_0xd46b96[_0x42485c(0x1fe)]},_0x28765c[_0x42485c(0x228)]);}}else{if(_0x28765c[_0x42485c(0x1c8)]==='testNotification'){const _0x353896=await this['sendNotification']('[Test]\x20Notification',!![]);this['sendTo'](_0x28765c['from'],_0x28765c[_0x42485c(0x1c8)],{'success':_0x353896>0x0,'message':_0x353896+_0x42485c(0x19f)},_0x28765c[_0x42485c(0x228)]);}else{if(_0x28765c[_0x42485c(0x1c8)]===_0x42485c(0x184)){if(!this[_0x42485c(0x1f6)])return this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':![],'isPro':![]},_0x28765c[_0x42485c(0x228)]);let _0x317dc1={'status':_0x42485c(0x1cb),'details':'','lastCheck':0x0};try{_0x317dc1[_0x42485c(0x1ba)]=(await this[_0x42485c(0x18a)](LTM_DP_DRIFT_STATUS))[_0x42485c(0x1e6)],_0x317dc1[_0x42485c(0x16c)]=(await this[_0x42485c(0x18a)](LTM_DP_DRIFT_DETAILS))['val'],_0x317dc1['lastCheck']=(await this[_0x42485c(0x18a)](LTM_DP_DRIFT_LAST_CHECK))[_0x42485c(0x1e6)];}catch(_0x31e00e){}this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x42485c(0x247)],'driftAnalysis':_0x317dc1,'analysisHistory':this['analysisHistory']},_0x28765c[_0x42485c(0x228)]);}else{if(_0x28765c[_0x42485c(0x1c8)]==='getEnums'){const _0x34ec25=await this[_0x42485c(0x283)](_0x42485c(0x254),_0x42485c(0x250)),_0x5794d9=[];if(_0x34ec25)for(const _0x4f70e0 in _0x34ec25){const _0x1f779b=_0x34ec25[_0x4f70e0],_0x311459=(_0x1f779b['common']&&typeof _0x1f779b['common'][_0x42485c(0x1c4)]===_0x42485c(0x1a0)?_0x1f779b[_0x42485c(0x15e)]['name']['de']:_0x1f779b[_0x42485c(0x15e)]['name'])||_0x1f779b['common']['name'];_0x5794d9[_0x42485c(0x25a)]({'id':_0x4f70e0,'name':_0x311459});}this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':!![],'enums':_0x5794d9},_0x28765c['callback']);}else{if(_0x28765c['command']===_0x42485c(0x169)){this[_0x42485c(0x1e1)][_0x42485c(0x20e)](_0x42485c(0x1a8));const _0x486957=_0x28765c[_0x42485c(0x1fe)]||{};try{const _0x4220df=await this[_0x42485c(0x25c)](_0x486957);this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':!![],'devices':_0x4220df},_0x28765c[_0x42485c(0x228)]);}catch(_0x454964){this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':![],'error':_0x454964[_0x42485c(0x1fe)]},_0x28765c[_0x42485c(0x228)]);}}else{if(_0x28765c[_0x42485c(0x1c8)]===_0x42485c(0x20d)){const {historyId:_0x4da10c,rating:_0x19313a,comment:_0x3217a9,alertReason:_0x5e89c0}=_0x28765c[_0x42485c(0x1fe)];_0x4da10c&&_0x19313a?(await this[_0x42485c(0x272)]({'timestamp':Date[_0x42485c(0x268)](),'historyId':_0x4da10c,'rating':_0x19313a,'comment':_0x3217a9,'alertReason':_0x5e89c0}),this[_0x42485c(0x165)](_0x28765c[_0x42485c(0x23c)],_0x28765c[_0x42485c(0x1c8)],{'success':!![]},_0x28765c['callback'])):this['sendTo'](_0x28765c['from'],_0x28765c[_0x42485c(0x1c8)],{'success':![],'error':'Missing\x20data'},_0x28765c[_0x42485c(0x228)]);}}}}}}}}}if(require[a0_0x6951a(0x22b)]!==module)module[a0_0x6951a(0x259)]=_0x4425ed=>new CogniLiving(_0x4425ed);else new CogniLiving();function a0_0x81cc(_0x29a121,_0x22cd3c){const _0x53980e=a0_0x449f();return a0_0x81cc=function(_0x489e03,_0x10b23e){_0x489e03=_0x489e03-0x15d;let _0x449fd9=_0x53980e[_0x489e03];return _0x449fd9;},a0_0x81cc(_0x29a121,_0x22cd3c);}function a0_0x449f(){const _0x39598f=['json','warn','50wySdJF','includes','onStateChange','slice','uuid-error','setupLtmScheduler','Logbook','9aOMJex','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','analysis.deviationFromBaseline','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','notifySignalRecipient','N/A\x20(No\x20Activity)','.\x20PERSONA:\x20','notifyWhatsappRecipient','runBaselineDriftAnalysis','callback','Alert\x20Reason','type','main','parse','geminiModel','System\x20Status\x20&\x20Control','[TEST]\x20','Presence\x20Status','stateChange','splice','de-DE','checkLtmDriftObjects','onMessage','notifyWhatsappInstance','analysis.automation.description','updateBaselineStatus','GUEST','Comfort\x20Suggestion','driftDetails','from','analysis.isAlert','deviationFromBaseline','indicator','ltmStbWindowDays','PARTY','join','cancel','ltmJob','replace','unload','dailyDigests','Haust√ºr\x20Event:\x20Starte\x20Exit-Logik\x20(','Description','catch','baselineDrift','namespace','string','saveRawEventLog','\x20min).\x20Watchdog\x20Limit:\x20','enum','Konnte\x20System-Standort\x20nicht\x20laden.','\x20events','state','enum.functions.*','timestamp','LTM.rawEventLog','@google/generative-ai','date','exports','push','Exit\x20Grace\x20Period\x20beendet.\x20√úberwache\x20nun\x20Innenraum...','scanForDevices','N/A\x20(Pro\x20Feature)','notifyPushoverInstance','ready','siren','sendNotification','system.meta.uuid','Analysis\x20Error:\x20','normal','city','bind','notifyTelegramRecipient','now','uuid-not-found','analysis.activitySummary','Lernphase\x20(','(((.+)+)+)+$','.\x20ORT:\x20','Comfort\x20Summary','ü§ñ\x20Starting\x20Gemini\x20Analysis...','systemConfig','analysis.isEmergency','saveFeedback','analysis.automation.suggestedAction','Ignoring\x20event\x20during\x20Exit\x20Grace\x20Period:\x20','LTM.driftAnalysis','pop','automationProposal','System\x20Mode','analysis.lastResult','activity','analysis.automation.patternDetected','vacation','\x20(EMERGENCY)','config','2ydGnxZ','Automation\x20Proposals','find','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','getForeignObjectsAsync','210364JOBUUR','apiKey','0\x204\x20*\x20*\x20*','\x20Tage)','minDaysForBaseline','subscribeForeignStatesAsync','cogni-living','analysisInterval','toLowerCase','\x0aFEEDBACK:\x0a','extendObjectAsync','substring','üö®\x20EMERGENCY','getGenerativeModel','Manual\x20Analysis\x20Trigger\x20detected!','2-digit','events.history_debug_03','boolean','exitTimer','lastAlertState','livingContext','licenseKey','loadDailyDigests','No\x20recent\x20activity.','Trigger\x20Analysis','Success','3789834kIfkuQ','Deviation','sound','checkLicense','Feedback\x20Log','analysis.comfortSummary','Urlaub','party','processSensorEvent','currentSystemMode','flur','alertReason','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','events.history_debug_02','144256ynGddy','aiPersona','.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','setObjectNotExistsAsync','isGracePeriodActive','abortExitTimer','common','Cogni-Living\x20Alert','‚ùå\x20Gemini\x20Model\x20not\x20initialized!\x20Check\x20API\x20Key.','onUnload','rawEventLog','inactivityMonitoringEnabled','\x0a\x0aA\x20(STB):\x0a','sendTo','unshift','\x20events\x20from\x20history.','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','scanDevices','test','resetAnalysisStates','details','cogni-living\x20adapter\x20starting\x20(v','notifyTelegramInstance','modeResetJob','Gemini\x20Init\x20Error:\x20','getForeignObjectAsync','stringify','min\x20Timer,\x20','notifyEmailInstance','feedbackHistory','getSystemUUID','send','events.history_debug_04','Starting\x20Autopilot\x20(','events.history','5287056lGLUmw','guest','notifyTelegramEnabled','genAI','Deaktiviert\x20(Pro-Feature)','Skipped\x20(No\x20AI\x20or\x20Data)','\x20sensors...','scheduleJob','analysis.automation','getLtmData','logDuplicates','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','text','location','analysis.comfortSuggestion','getStateAsync','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','geminiApiKey','Error:\x20','rating','Aktiv\x20(','saveDailyDigests','native','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','No\x20recorded\x20events\x20yet.','analysis.analysisHistory','Pr√§senz-Status\x20ge√§ndert:\x20','channel','Adapter','PRO-','patternDetected','setupModeResetScheduler','constructor','Sending\x20Prompt\x20(Length:\x20','setState','\x20sent','object','getForeignStateAsync','startsWith','notifyPushoverRecipient','analysis.history_debug_03','driftAnalysisTimer','Fenster/T√ºr','length','Received\x20scanDevices\x20request\x20from\x20Admin\x20UI.','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','longitude','s\x20Grace).','AI\x20Emergency\x20Status','LTM.baselineStatus','User\x20Feedback:\x20Alarm\x20\x22','generic','üö®üö®\x20NOTFALL','sendToAsync','runAutopilot','createDailyDigest','VACATION','analysisTimer','long','events.lastEvent','Success:\x20Compressed\x20','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','status','activityLevel','TEST-PRO-KEY','suggestedAction','analysisHistory','üö®\x20Dead\x20Man\x27s\x20Switch:\x20Keine\x20Aktivit√§t\x20seit\x20','ANWESEND\x20üè†','error','Sending\x20notification:\x20\x22','devices','name','Gemini\x20AI\x20initialized.','search','analysis.trigger','command','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20}\x20}','analysis.feedbackHistory','N/A','sensorLastValues','Exit-Timer\x20abgelaufen:\x20Keine\x20Bewegung\x20innen\x20erkannt\x20->\x20ABWESEND.','apply','suggestion','loadRawEventLog','Started\x20at\x20','comfort','.\x20PR√ÑSENZ:\x20','text.alarm','Party','isAlert','‚ö†Ô∏è\x20Alarm','triggerDailyDigest','button','2858253FmXgkn','NORMAL','generateContent','setStateAsync','LTM.driftAnalysis.lastCheck','Daily\x20Digests','toString','log','inactivityThresholdHours','response','summary','events.history_debug_00','val','2639182GsakYo','createAllObjects','delObjectAsync','node-schedule','setPresence','systemUUID','uuid','notifyPushoverEnabled','runGeminiAnalysis','checkLtmObjects','onReady','N/A\x20(Learning)','ROLLE:\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20KONTEXT:\x20','3520540PZZWGf','loadSystemMode','isProVersion','toLocaleString','ack','testApiKey','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','system.config','values','notifyEmailEnabled','message','system','subscribeStates','exitGraceTimer','analysis.alertReason','trim','system.isPresent','setupDriftAnalysisScheduler','isPresent','LTM.driftAnalysis.driftDetails','startExitTimer','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20ungew√∂hnliche\x20n√§chtliche\x20Aktivit√§t.','cleanUpZombies','loadHistoryFromState','Event\x20History','submitFeedback','info','eventHistory','debug','notifySignalInstance','LTM','application/json','toFixed','toISOString'];a0_0x449f=function(){return _0x39598f;};return a0_0x449f();}