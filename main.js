const a0_0x89cb30=a0_0x145d;(function(_0x401b8a,_0x1eb4fc){const _0x59333d=a0_0x145d,_0x438c57=_0x401b8a();while(!![]){try{const _0x4df688=-parseInt(_0x59333d(0x29a))/0x1+-parseInt(_0x59333d(0x1ee))/0x2*(parseInt(_0x59333d(0x25c))/0x3)+-parseInt(_0x59333d(0x255))/0x4+-parseInt(_0x59333d(0x2ec))/0x5*(-parseInt(_0x59333d(0x2fd))/0x6)+-parseInt(_0x59333d(0x237))/0x7*(parseInt(_0x59333d(0x26f))/0x8)+-parseInt(_0x59333d(0x26e))/0x9*(-parseInt(_0x59333d(0x1da))/0xa)+-parseInt(_0x59333d(0x161))/0xb*(-parseInt(_0x59333d(0x285))/0xc);if(_0x4df688===_0x1eb4fc)break;else _0x438c57['push'](_0x438c57['shift']());}catch(_0x570163){_0x438c57['push'](_0x438c57['shift']());}}}(a0_0x1ef0,0x917c5));const a0_0x151a79=(function(){let _0x23197d=!![];return function(_0xcf567,_0xbb5d36){const _0x1fa6da=_0x23197d?function(){const _0x131b36=a0_0x145d;if(_0xbb5d36){const _0x51b661=_0xbb5d36[_0x131b36(0x1be)](_0xcf567,arguments);return _0xbb5d36=null,_0x51b661;}}:function(){};return _0x23197d=![],_0x1fa6da;};}()),a0_0x4e4d98=a0_0x151a79(this,function(){const _0x38e458=a0_0x145d;return a0_0x4e4d98['toString']()[_0x38e458(0x233)](_0x38e458(0x229))[_0x38e458(0x24e)]()[_0x38e458(0x218)](a0_0x4e4d98)[_0x38e458(0x233)](_0x38e458(0x229));});a0_0x4e4d98();'use strict';const utils=require(a0_0x89cb30(0x187)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x89cb30(0x17b)),{spawn,exec}=require(a0_0x89cb30(0x2f8)),path=require('path'),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x89cb30(0x1d1),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x89cb30(0x2cd),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x89cb30(0x21b),LTM_DP_DAILY_DIGESTS=a0_0x89cb30(0x2f4),LTM_DP_STATUS=a0_0x89cb30(0x257),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x89cb30(0x302),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x89cb30(0x1ae),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x89cb30(0x156),SYSTEM_MODES={'NORMAL':a0_0x89cb30(0x2ee),'VACATION':'vacation','PARTY':'party','GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x89cb30(0x22c),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit/AAL.','family':a0_0x89cb30(0x1cf),'single_comfort':a0_0x89cb30(0x1a3),'security':a0_0x89cb30(0x2f6)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x89cb30(0x21e)]===a0_0x89cb30(0x173),PERSISTENT_DIR=path['join'](__dirname,a0_0x89cb30(0x272)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path[a0_0x89cb30(0x209)](VENV_PATH,a0_0x89cb30(0x28b),a0_0x89cb30(0x2dd)):path[a0_0x89cb30(0x209)](VENV_PATH,'bin',a0_0x89cb30(0x29e)),PIP_EXE=IS_WIN?path[a0_0x89cb30(0x209)](VENV_PATH,'Scripts','pip.exe'):path['join'](VENV_PATH,'bin',a0_0x89cb30(0x1c1));let activeSequence=[],sequenceTimer=null;async function startSystem(_0xe7d80a){const _0x51724f=a0_0x89cb30;_0xe7d80a[_0x51724f(0x1e2)]['info'](_0x51724f(0x288)),await initZombies(_0xe7d80a);try{_0xe7d80a[_0x51724f(0x166)]=await checkLicense(_0xe7d80a[_0x51724f(0x1e5)][_0x51724f(0x18a)]);}catch(_0x597b35){}if(!_0xe7d80a[_0x51724f(0x1e5)]['inactivityThresholdHours']||_0xe7d80a[_0x51724f(0x1e5)][_0x51724f(0x261)]<0.1)_0xe7d80a[_0x51724f(0x1e5)][_0x51724f(0x261)]=0xc;await initHistory(_0xe7d80a),await initSystemConfig(_0xe7d80a);if(_0xe7d80a['config'][_0x51724f(0x297)])try{_0xe7d80a['genAI']=new GoogleGenerativeAI(_0xe7d80a[_0x51724f(0x1e5)][_0x51724f(0x297)]),_0xe7d80a[_0x51724f(0x186)]=_0xe7d80a[_0x51724f(0x290)][_0x51724f(0x1d5)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),_0xe7d80a[_0x51724f(0x1e2)][_0x51724f(0x227)](_0x51724f(0x2cb));}catch(_0x4fc7ed){_0xe7d80a[_0x51724f(0x1e2)][_0x51724f(0x266)](_0x51724f(0x1af)+_0x4fc7ed[_0x51724f(0x19e)]);}await createAllObjects(_0xe7d80a),await loadSystemMode(_0xe7d80a),await loadRawEventLog(_0xe7d80a),await loadDailyDigests(_0xe7d80a),_0xe7d80a[_0x51724f(0x212)](_0x51724f(0x293)),_0xe7d80a[_0x51724f(0x212)](LTM_DP_TRIGGER_DIGEST),_0xe7d80a['subscribeStates'](_0x51724f(0x156)),_0xe7d80a[_0x51724f(0x212)](_0x51724f(0x2fa)),_0xe7d80a[_0x51724f(0x212)]('analysis.automation.triggerAction'),_0xe7d80a[_0x51724f(0x212)](_0x51724f(0x206)),_0xe7d80a[_0x51724f(0x212)](_0x51724f(0x16c)),_0xe7d80a[_0x51724f(0x212)]('analysis.training.triggerHealth'),_0xe7d80a[_0x51724f(0x212)](_0x51724f(0x220)),_0xe7d80a[_0x51724f(0x212)](_0x51724f(0x2b6)),_0xe7d80a[_0x51724f(0x212)](_0x51724f(0x19b)),await initSensorSubscriptions(_0xe7d80a),await initPresenceSubscriptions(_0xe7d80a),await setupTelegramListener(_0xe7d80a),setTimeout(()=>checkWifiPresence(_0xe7d80a),0x1388);if(_0xe7d80a['analysisTimer'])clearInterval(_0xe7d80a['analysisTimer']);const _0x43f2a0=_0xe7d80a['config'][_0x51724f(0x274)]||0xf;_0x43f2a0>0x0&&(_0xe7d80a[_0x51724f(0x20e)]=setInterval(()=>{runAutopilot(_0xe7d80a);},_0x43f2a0*0x3c*0x3e8)),setupLtmScheduler(_0xe7d80a),setupModeResetScheduler(_0xe7d80a),setupDriftAnalysisScheduler(_0xe7d80a),setupBriefingScheduler(_0xe7d80a),startPythonService(_0xe7d80a),setTimeout(()=>{const _0x51e5b4=_0x51724f;_0xe7d80a[_0x51e5b4(0x17c)]&&(runPythonHealthCheck(_0xe7d80a),triggerGaitAnalysis(_0xe7d80a),triggerEnergyPrediction(_0xe7d80a)),updateHealthVector(_0xe7d80a);},0x1388);}function a0_0x145d(_0x83627b,_0x2b2362){const _0x2f2f6a=a0_0x1ef0();return a0_0x145d=function(_0x4e4d98,_0x151a79){_0x4e4d98=_0x4e4d98-0x155;let _0x1ef045=_0x2f2f6a[_0x4e4d98];return _0x1ef045;},a0_0x145d(_0x83627b,_0x2b2362);}async function runAutopilot(_0x360259){const _0x567642=a0_0x89cb30;_0x360259[_0x567642(0x1e2)][_0x567642(0x291)](_0x567642(0x2e1)),await runGeminiAnalysis(_0x360259),updateHealthVector(_0x360259),triggerGaitAnalysis(_0x360259),triggerEnergyPrediction(_0x360259);}async function triggerGaitAnalysis(_0x18f5dc){const _0x2d3e0c=a0_0x89cb30;if(!_0x18f5dc[_0x2d3e0c(0x166)])return;try{const _0x93de60=await _0x18f5dc[_0x2d3e0c(0x260)]('LTM.trainingData.sequences');_0x93de60&&_0x93de60[_0x2d3e0c(0x1a4)]&&sendToPython(_0x18f5dc,_0x2d3e0c(0x1a0),{'sequences':JSON['parse'](_0x93de60[_0x2d3e0c(0x1a4)])});}catch(_0x3865ec){}}async function triggerEnergyPrediction(_0x200565){const _0xcba609=a0_0x89cb30;if(!_0x200565[_0xcba609(0x166)])return;try{const _0x9a5fa6=await getOutsideTemperatureNumeric(_0x200565);if(_0x9a5fa6===null)return;const _0x4ba149={},_0x7d14dd=_0x200565[_0xcba609(0x1e5)][_0xcba609(0x19c)]||[];for(const _0x2ff8f6 of _0x7d14dd){if(_0x2ff8f6[_0xcba609(0x203)]===_0xcba609(0x2b8)&&_0x2ff8f6['location']){const _0x114678=_0x200565[_0xcba609(0x2e2)][_0x2ff8f6['id']];if(_0x114678!==undefined)_0x4ba149[_0x2ff8f6['location']]=_0x114678;}}Object[_0xcba609(0x1e3)](_0x4ba149)[_0xcba609(0x25d)]>0x0&&sendToPython(_0x200565,_0xcba609(0x25e),{'current_temps':_0x4ba149,'t_out':_0x9a5fa6});}catch(_0x32bc95){}}function updateHealthVector(_0x5f0dbd){const _0x273af7=a0_0x89cb30;if(!_0x5f0dbd['rawEventLog']||_0x5f0dbd[_0x273af7(0x27c)][_0x273af7(0x25d)]===0x0)return;const _0x3ea59c=new Array(0x60)['fill'](0x0),_0x1a6d26=new Date()[_0x273af7(0x171)](0x0,0x0,0x0,0x0);_0x5f0dbd['rawEventLog'][_0x273af7(0x23f)](_0x108951=>{const _0x36e268=_0x273af7,_0x5da375=new Date(_0x108951[_0x36e268(0x16f)]);if(_0x5da375[_0x36e268(0x21a)]()>=_0x1a6d26){const _0xa33b71=_0x5da375[_0x36e268(0x1e1)](),_0x37a409=_0x5da375[_0x36e268(0x24f)](),_0x10ceab=_0xa33b71*0x4+Math['floor'](_0x37a409/0xf);if(_0x10ceab>=0x0&&_0x10ceab<0x60)_0x3ea59c[_0x10ceab]++;}}),_0x5f0dbd[_0x273af7(0x179)]('analysis.health.todayVector',{'val':JSON['stringify'](_0x3ea59c),'ack':!![]});}async function scanForDevices(_0x22fa80,_0x137c6d){const _0x55813a=a0_0x89cb30;_0x22fa80[_0x55813a(0x1e2)][_0x55813a(0x227)]('üîç\x20Scanning\x20for\x20devices...');const _0x61b8e=[],_0x1e85ad=await _0x22fa80[_0x55813a(0x174)]('*');for(const _0x125e4d in _0x1e85ad){const _0x3c44f9=_0x1e85ad[_0x125e4d];if(_0x3c44f9&&_0x3c44f9[_0x55813a(0x2ef)]&&_0x3c44f9[_0x55813a(0x203)]===_0x55813a(0x1d6)){const _0x5b89ea=(_0x3c44f9[_0x55813a(0x2ef)][_0x55813a(0x276)]&&typeof _0x3c44f9[_0x55813a(0x2ef)][_0x55813a(0x276)]==='object'?_0x3c44f9[_0x55813a(0x2ef)][_0x55813a(0x276)]['de']:_0x3c44f9[_0x55813a(0x2ef)][_0x55813a(0x276)])||'',_0x2603a2=_0x3c44f9[_0x55813a(0x2ef)]['role']||'';let _0x1d7924=null;if(_0x137c6d[_0x55813a(0x20a)]&&(_0x2603a2[_0x55813a(0x1d9)](_0x55813a(0x20a))||_0x5b89ea['toLowerCase']()[_0x55813a(0x1d9)]('bewegung')))_0x1d7924=_0x55813a(0x20a);else{if(_0x137c6d[_0x55813a(0x19f)]&&(_0x2603a2[_0x55813a(0x1d9)](_0x55813a(0x2ad))||_0x2603a2[_0x55813a(0x1d9)](_0x55813a(0x28d))||_0x5b89ea[_0x55813a(0x20f)]()[_0x55813a(0x1d9)]('t√ºr')||_0x5b89ea[_0x55813a(0x20f)]()[_0x55813a(0x1d9)](_0x55813a(0x27b))))_0x1d7924=_0x55813a(0x2ad);else{if(_0x137c6d[_0x55813a(0x2ac)]&&(_0x2603a2['includes']('light')||_0x2603a2['includes'](_0x55813a(0x292))||_0x5b89ea[_0x55813a(0x20f)]()[_0x55813a(0x1d9)](_0x55813a(0x247))))_0x1d7924=_0x55813a(0x2a5);else{if(_0x137c6d[_0x55813a(0x2b8)]&&(_0x2603a2[_0x55813a(0x1d9)]('temperature')||_0x5b89ea[_0x55813a(0x20f)]()[_0x55813a(0x1d9)](_0x55813a(0x284))))_0x1d7924=_0x55813a(0x2b8);}}}if(_0x1d7924){let _0x270af2='';const _0x3576d5=_0x125e4d[_0x55813a(0x2c7)]('.');if(_0x3576d5[_0x55813a(0x25d)]>0x2)_0x270af2=_0x3576d5[0x2];_0x61b8e[_0x55813a(0x1fa)]({'id':_0x125e4d,'name':_0x5b89ea||_0x125e4d,'type':_0x1d7924,'location':_0x270af2,'_score':0x32});}}}return _0x61b8e;}async function getWeatherContext(_0x99a077){const _0x4765a8=a0_0x89cb30;if(!_0x99a077['config'][_0x4765a8(0x215)]||!_0x99a077['config'][_0x4765a8(0x165)])return _0x4765a8(0x28c);try{const _0x13613d=_0x99a077[_0x4765a8(0x1e5)]['weatherInstance'];let _0x39ddfd=await _0x99a077[_0x4765a8(0x2db)](_0x13613d+_0x4765a8(0x29f));if(!_0x39ddfd)_0x39ddfd=await _0x99a077[_0x4765a8(0x2db)](_0x13613d+'.forecast.current.temperature');let _0x418ddc=await _0x99a077[_0x4765a8(0x2db)](_0x13613d+_0x4765a8(0x2ff));if(!_0x418ddc)_0x418ddc=await _0x99a077[_0x4765a8(0x2db)](_0x13613d+_0x4765a8(0x2f2));if(_0x39ddfd&&_0x418ddc)return _0x39ddfd['val']+_0x4765a8(0x2a9)+_0x418ddc[_0x4765a8(0x1a4)];}catch(_0x2e275e){}return _0x4765a8(0x2da);}async function getCalendarContext(_0x578e79){const _0x374a07=a0_0x89cb30;if(!_0x578e79['config'][_0x374a07(0x27a)]||!_0x578e79[_0x374a07(0x1e5)][_0x374a07(0x19a)])return _0x374a07(0x2ae);return _0x374a07(0x22e);}async function getCalendarNames(_0x52da03,_0x406ac4){return[];}async function saveFeedback(_0x3754fc,_0xb330e7){const _0x2556cf=a0_0x89cb30;_0x3754fc[_0x2556cf(0x1e2)][_0x2556cf(0x227)]('üìù\x20Feedback\x20received:\x20'+_0xb330e7['rating']);}async function sendMorningBriefing(_0x1b203a){const _0x322a2a=a0_0x89cb30;if(!_0x1b203a[_0x322a2a(0x186)])return;try{const _0x3ae9d8=_0x322a2a(0x2e9),_0x1bba7e=await _0x1b203a[_0x322a2a(0x186)]['generateContent'](_0x3ae9d8),_0x270cd7=_0x1bba7e[_0x322a2a(0x15e)][_0x322a2a(0x15d)]();sendNotification(_0x1b203a,_0x322a2a(0x193)+_0x270cd7);}catch(_0x3bc4f4){_0x1b203a['log'][_0x322a2a(0x266)](_0x322a2a(0x1e7)+_0x3bc4f4['message']);}}function checkAndInstall(_0x4c6dd7){const _0x32dff7=a0_0x89cb30;if(!fs[_0x32dff7(0x190)](VENV_PATH)||!fs[_0x32dff7(0x190)](PIP_EXE))return _0x4c6dd7[_0x32dff7(0x1e2)][_0x32dff7(0x2d8)]('‚ö†Ô∏è\x20Python\x20VENV\x20missing.\x20Installing\x20locally...'),installPythonDependencies(_0x4c6dd7),![];return!![];}function installPythonDependencies(_0x12b58d){const _0x33befc=a0_0x89cb30;if(_0x12b58d[_0x33befc(0x1bc)])return;_0x12b58d[_0x33befc(0x1bc)]=!![];const _0x2ee4ff=path['join'](__dirname,_0x33befc(0x2ca),_0x33befc(0x1f2));stopPythonService(_0x12b58d);if(fs[_0x33befc(0x190)](VENV_PATH))try{fs[_0x33befc(0x2d6)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x3bc33e){}exec(_0x33befc(0x223)+VENV_PATH+'\x22',_0x247af9=>{const _0x1d63f2=_0x33befc;if(_0x247af9){_0x12b58d[_0x1d63f2(0x1e2)][_0x1d63f2(0x266)](_0x1d63f2(0x2fb)+_0x247af9[_0x1d63f2(0x19e)]),_0x12b58d[_0x1d63f2(0x1bc)]=![];return;}installRequirementsInVenv(_0x12b58d,_0x2ee4ff);});}function installRequirementsInVenv(_0x3f46a4,_0x573edf){const _0x5f2f1f=a0_0x89cb30;_0x3f46a4[_0x5f2f1f(0x1e2)]['info'](_0x5f2f1f(0x281));const _0x2ae041='\x22'+PIP_EXE+_0x5f2f1f(0x253)+_0x573edf+'\x22';exec(_0x2ae041,{'timeout':0x124f80},(_0x3452a1,_0x116516,_0x1ca758)=>{const _0x464ed7=_0x5f2f1f;_0x3f46a4[_0x464ed7(0x1bc)]=![],_0x3452a1?_0x3f46a4['log'][_0x464ed7(0x266)](_0x464ed7(0x1ea)+(_0x1ca758||_0x3452a1['message'])):(_0x3f46a4[_0x464ed7(0x1e2)]['info'](_0x464ed7(0x22d)),startSystem(_0x3f46a4));});}async function initZombies(_0x8a941e){const _0x162106=a0_0x89cb30;try{const _0x532797=['analysis.history_debug_00',_0x162106(0x28f)];for(const _0x3ebd92 of _0x532797){try{const _0x5562ad=await _0x8a941e['getObjectAsync'](_0x3ebd92);if(_0x5562ad)await _0x8a941e[_0x162106(0x239)](_0x3ebd92);}catch(_0x3226ed){}}}catch(_0x366707){}}async function checkLicense(_0x10fe75){return!![];}async function initHistory(_0x1fbcb2){const _0x3d30b0=a0_0x89cb30;try{const _0x11b4ca=await _0x1fbcb2[_0x3d30b0(0x260)](_0x3d30b0(0x2d0));_0x11b4ca&&_0x11b4ca['val']&&(_0x1fbcb2[_0x3d30b0(0x249)]=JSON[_0x3d30b0(0x1a5)](_0x11b4ca[_0x3d30b0(0x1a4)][_0x3d30b0(0x24e)]()));}catch(_0x50a8e1){_0x1fbcb2[_0x3d30b0(0x249)]=[];}try{const _0x82c987=await _0x1fbcb2[_0x3d30b0(0x260)]('analysis.analysisHistory');if(_0x82c987&&_0x82c987[_0x3d30b0(0x1a4)])_0x1fbcb2[_0x3d30b0(0x199)]=JSON[_0x3d30b0(0x1a5)](_0x82c987[_0x3d30b0(0x1a4)][_0x3d30b0(0x24e)]());}catch(_0x269e53){_0x1fbcb2[_0x3d30b0(0x199)]=[];}if(_0x1fbcb2[_0x3d30b0(0x249)]&&_0x1fbcb2[_0x3d30b0(0x249)][_0x3d30b0(0x25d)]>0x0){_0x1fbcb2[_0x3d30b0(0x1e2)]['info']('Restoring\x20sensor\x20cache...');for(let _0x4fbc71=_0x1fbcb2[_0x3d30b0(0x249)][_0x3d30b0(0x25d)]-0x1;_0x4fbc71>=0x0;_0x4fbc71--){const _0x4d2113=_0x1fbcb2['eventHistory'][_0x4fbc71];if(_0x4d2113&&_0x4d2113['id']!==undefined&&_0x4d2113['value']!==undefined)_0x1fbcb2['sensorLastValues'][_0x4d2113['id']]=_0x4d2113['value'];}}}async function initSystemConfig(_0xea7920){const _0x5c28dd=a0_0x89cb30;try{const _0x31f1d0=await _0xea7920[_0x5c28dd(0x23d)](_0x5c28dd(0x2b0));if(_0x31f1d0&&_0x31f1d0[_0x5c28dd(0x2ef)])_0xea7920['systemConfig']={'latitude':_0x31f1d0[_0x5c28dd(0x2ef)][_0x5c28dd(0x182)]||0x0,'longitude':_0x31f1d0[_0x5c28dd(0x2ef)][_0x5c28dd(0x2ea)]||0x0,'city':_0x31f1d0['common'][_0x5c28dd(0x210)]||''};}catch(_0x4b1fbe){}}async function createAllObjects(_0x42b25e){const _0x59f596=a0_0x89cb30;await _0x42b25e[_0x59f596(0x1c8)](_0x59f596(0x1f0),{'type':_0x59f596(0x1c4),'common':{'name':_0x59f596(0x27f)},'native':{}}),await _0x42b25e[_0x59f596(0x1c8)](SYSTEM_DP_MODE,{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x1d4),'type':_0x59f596(0x26a),'role':_0x59f596(0x1d6),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x59f596(0x1ed)]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x2d2),{'type':'state','common':{'name':_0x59f596(0x20c),'type':'string','role':_0x59f596(0x15d),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x2eb),{'type':_0x59f596(0x1d6),'common':{'name':'Last\x20raw\x20event','type':_0x59f596(0x26a),'role':_0x59f596(0x17f),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x2d0),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x267),'type':'string','role':_0x59f596(0x17f),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x1c8)](_0x59f596(0x2bb),{'type':'channel','common':{'name':'AI\x20Training'},'native':{}}),await _0x42b25e['setObjectNotExistsAsync']('analysis.training.triggerSecurity',{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x1b1),'type':'boolean','role':_0x59f596(0x2f1),'read':!![],'write':!![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x1bf),{'type':'state','common':{'name':'Train\x20Health','type':_0x59f596(0x1f4),'role':_0x59f596(0x2f1),'read':!![],'write':!![]},'native':{}}),await _0x42b25e['setObjectNotExistsAsync']('analysis.training.triggerEnergy',{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x202),'type':_0x59f596(0x1f4),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x2b6),{'type':'state','common':{'name':'Train\x20Comfort','type':_0x59f596(0x1f4),'role':_0x59f596(0x2f1),'read':!![],'write':!![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x19b),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x1ab),'type':_0x59f596(0x1f4),'role':_0x59f596(0x2f1),'read':!![],'write':!![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)]('analysis.training.status',{'type':_0x59f596(0x1d6),'common':{'name':'Training\x20Status','type':_0x59f596(0x26a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x1c8)]('analysis.security',{'type':_0x59f596(0x1c4),'common':{'name':_0x59f596(0x2a0)},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x2dc),{'type':_0x59f596(0x1d6),'common':{'name':'Anomaly\x20Score','type':'number','role':_0x59f596(0x1c0),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x16a),{'type':_0x59f596(0x1d6),'common':{'name':'Current\x20Threshold','type':_0x59f596(0x2c0),'role':_0x59f596(0x1c0),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x42b25e[_0x59f596(0x188)]('analysis.security.lastCheck',{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x2f5),'type':_0x59f596(0x26a),'role':_0x59f596(0x1c5),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x1b7),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x2c3),'type':_0x59f596(0x26a),'role':_0x59f596(0x17f),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x1c8)](_0x59f596(0x2d5),{'type':'channel','common':{'name':_0x59f596(0x2ba)},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x24d),{'type':_0x59f596(0x1d6),'common':{'name':'Last\x20Check','type':_0x59f596(0x26a),'role':_0x59f596(0x1c5),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x270),{'type':'state','common':{'name':'Anomaly\x20Detected','type':_0x59f596(0x1f4),'role':_0x59f596(0x1ec),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x230),{'type':_0x59f596(0x1d6),'common':{'name':'Trend','type':_0x59f596(0x26a),'role':_0x59f596(0x15d),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)]('analysis.health.trendValue',{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x2b7),'type':_0x59f596(0x2c0),'role':'value','read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x1d7),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x2b4),'type':'string','role':_0x59f596(0x17f),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)]('analysis.health.gaitSpeed',{'type':_0x59f596(0x1d6),'common':{'name':'Gait\x20Speed\x20Trend','type':_0x59f596(0x2c0),'role':_0x59f596(0x1c0),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x1c8)]('analysis.energy',{'type':_0x59f596(0x1c4),'common':{'name':'Energy\x20Intelligence'},'native':{}}),await _0x42b25e[_0x59f596(0x188)]('analysis.energy.insulationScore',{'type':_0x59f596(0x1d6),'common':{'name':'Insulation\x20Score','type':_0x59f596(0x26a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)]('analysis.energy.heatingScore',{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x1cb),'type':_0x59f596(0x26a),'role':_0x59f596(0x15d),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x1fe),{'type':'state','common':{'name':'Temperature\x20Forecast','type':_0x59f596(0x26a),'role':_0x59f596(0x17f),'read':!![],'write':![]},'native':{}}),await _0x42b25e['extendObjectAsync']('LTM',{'type':_0x59f596(0x1c4),'common':{'name':'LTM'},'native':{}}),await _0x42b25e['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x2bc),'type':'string','role':_0x59f596(0x17f),'read':!![],'write':![]},'native':{}}),await _0x42b25e['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x59f596(0x1d6),'common':{'name':'Daily\x20Digests','type':_0x59f596(0x26a),'role':_0x59f596(0x17f),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x1bd),{'type':_0x59f596(0x1d6),'common':{'name':'Sequences','type':_0x59f596(0x26a),'role':'json','read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x205),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x1e0),'type':_0x59f596(0x26a),'role':'json','read':!![],'write':![]},'native':{}}),await _0x42b25e['setObjectNotExistsAsync']('analysis.trigger',{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x197),'type':_0x59f596(0x1f4),'role':_0x59f596(0x2f1),'read':!![],'write':!![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)]('analysis.triggerBriefing',{'type':'state','common':{'name':_0x59f596(0x2b5),'type':_0x59f596(0x1f4),'role':_0x59f596(0x2f1),'read':!![],'write':!![]},'native':{}}),await _0x42b25e['setObjectNotExistsAsync'](_0x59f596(0x198),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x265),'type':'boolean','role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x2e3),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x25b),'type':_0x59f596(0x26a),'role':_0x59f596(0x296),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x23c),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x27d),'type':_0x59f596(0x26a),'role':_0x59f596(0x15d),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)]('analysis.automation.patternDetected',{'type':'state','common':{'name':'Pattern\x20Detected','type':_0x59f596(0x1f4),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x42b25e['setObjectNotExistsAsync'](_0x59f596(0x1e8),{'type':'state','common':{'name':_0x59f596(0x217),'type':_0x59f596(0x26a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x17e),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x181),'type':_0x59f596(0x26a),'role':'json','read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x1c6),{'type':'state','common':{'name':'Target\x20ID','type':'string','role':_0x59f596(0x15d),'read':!![],'write':![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x211),{'type':_0x59f596(0x1d6),'common':{'name':'Target\x20Value','type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x42b25e['setObjectNotExistsAsync'](_0x59f596(0x206),{'type':_0x59f596(0x1d6),'common':{'name':'Auto\x20Apply','type':_0x59f596(0x1f4),'role':_0x59f596(0x292),'read':!![],'write':!![]},'native':{}}),await _0x42b25e[_0x59f596(0x188)](_0x59f596(0x1f5),{'type':_0x59f596(0x1d6),'common':{'name':_0x59f596(0x228),'type':_0x59f596(0x1f4),'role':_0x59f596(0x2f1),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0xdd78dd){const _0x46549b=a0_0x89cb30;try{const _0x53b819=await _0xdd78dd[_0x46549b(0x260)](SYSTEM_DP_MODE);_0x53b819&&_0x53b819[_0x46549b(0x1a4)]&&Object[_0x46549b(0x2bd)](SYSTEM_MODES)[_0x46549b(0x1d9)](_0x53b819[_0x46549b(0x1a4)])?_0xdd78dd[_0x46549b(0x2b1)]=_0x53b819[_0x46549b(0x1a4)]:(_0xdd78dd['currentSystemMode']=SYSTEM_MODES[_0x46549b(0x1ed)],await _0xdd78dd['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x46549b(0x1ed)],'ack':!![]}));}catch(_0x359563){_0xdd78dd[_0x46549b(0x2b1)]=SYSTEM_MODES[_0x46549b(0x1ed)];}}async function loadRawEventLog(_0x2e2523){const _0x4847fa=a0_0x89cb30;try{const _0x4e2513=await _0x2e2523[_0x4847fa(0x260)](LTM_DP_RAW_LOG);if(_0x4e2513&&_0x4e2513[_0x4847fa(0x1a4)])_0x2e2523[_0x4847fa(0x27c)]=JSON[_0x4847fa(0x1a5)](_0x4e2513['val']);}catch(_0x311881){_0x2e2523[_0x4847fa(0x27c)]=[];}}async function saveRawEventLog(_0xaf8ff0){const _0x10d529=a0_0x89cb30;if(_0xaf8ff0[_0x10d529(0x27c)]['length']>RAW_LOG_MAX_SIZE)_0xaf8ff0['rawEventLog'][_0x10d529(0x1e4)](0x0,_0xaf8ff0['rawEventLog']['length']-RAW_LOG_MAX_SIZE);await _0xaf8ff0[_0x10d529(0x179)](LTM_DP_RAW_LOG,{'val':JSON[_0x10d529(0x158)](_0xaf8ff0[_0x10d529(0x27c)]),'ack':!![]});}async function loadDailyDigests(_0x515e8f){const _0x1df4c2=a0_0x89cb30;try{const _0x3f9fb0=await _0x515e8f[_0x1df4c2(0x260)](LTM_DP_DAILY_DIGESTS);if(_0x3f9fb0&&_0x3f9fb0[_0x1df4c2(0x1a4)])_0x515e8f[_0x1df4c2(0x1d2)]=JSON[_0x1df4c2(0x1a5)](_0x3f9fb0[_0x1df4c2(0x1a4)]);}catch(_0x15b4a4){_0x515e8f['dailyDigests']=[];}await updateBaselineStatus(_0x515e8f);}async function saveDailyDigests(_0x37a16e,_0x2093c4=!![]){const _0x2da3b5=a0_0x89cb30,_0x3330ad=_0x37a16e[_0x2da3b5(0x1e5)][_0x2da3b5(0x250)]||0x3c;_0x37a16e[_0x2da3b5(0x1d2)]['length']>_0x3330ad&&_0x37a16e[_0x2da3b5(0x1d2)]['splice'](0x0,_0x37a16e[_0x2da3b5(0x1d2)][_0x2da3b5(0x25d)]-_0x3330ad);await _0x37a16e['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x37a16e[_0x2da3b5(0x1d2)]),'ack':!![]});if(_0x2093c4)await updateBaselineStatus(_0x37a16e);}async function updateAnalysisHistory(_0x403df5,_0x2616b4){const _0x2dbc19=a0_0x89cb30;_0x403df5[_0x2dbc19(0x199)][_0x2dbc19(0x1f8)](_0x2616b4);if(_0x403df5[_0x2dbc19(0x199)]['length']>HISTORY_MAX_SIZE)_0x403df5['analysisHistory'][_0x2dbc19(0x2cc)]();await _0x403df5[_0x2dbc19(0x179)]('analysis.analysisHistory',{'val':JSON[_0x2dbc19(0x158)](_0x403df5[_0x2dbc19(0x199)]),'ack':!![]});}async function updateBaselineStatus(_0x20368d){const _0xc93809=a0_0x89cb30;if(!_0x20368d[_0xc93809(0x166)]){await _0x20368d['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0xc93809(0x298),'ack':!![]});return;}const _0x4ce2a7=_0x20368d[_0xc93809(0x1d2)][_0xc93809(0x25d)]>=(_0x20368d['config'][_0xc93809(0x2e6)]||0x7)?'Aktiv\x20('+_0x20368d[_0xc93809(0x1d2)][_0xc93809(0x25d)]+_0xc93809(0x20d):'Lernphase\x20('+_0x20368d['dailyDigests'][_0xc93809(0x25d)]+'/'+(_0x20368d[_0xc93809(0x1e5)][_0xc93809(0x2e6)]||0x7)+')';await _0x20368d[_0xc93809(0x179)](LTM_DP_BASELINE_STATUS,{'val':_0x4ce2a7,'ack':!![]});}async function initSensorSubscriptions(_0x31c06f){const _0x127aa5=a0_0x89cb30,_0x23e1f4=_0x31c06f[_0x127aa5(0x1e5)]['devices'];if(_0x23e1f4)for(const _0x14aef6 of _0x23e1f4){await _0x31c06f[_0x127aa5(0x204)](_0x14aef6['id']);}}async function initPresenceSubscriptions(_0x3b3ee6){const _0x4cb16c=a0_0x89cb30,_0x533841=_0x3b3ee6[_0x4cb16c(0x1e5)][_0x4cb16c(0x1c7)];if(_0x533841)for(const _0x5ce3b4 of _0x533841){await _0x3b3ee6[_0x4cb16c(0x204)](_0x5ce3b4);}}async function setupTelegramListener(_0x236980){const _0x3d79d1=a0_0x89cb30,_0x59f237=_0x236980['config'][_0x3d79d1(0x256)];if(_0x236980[_0x3d79d1(0x1e5)][_0x3d79d1(0x279)]&&_0x59f237)await _0x236980['subscribeForeignStatesAsync'](_0x59f237+_0x3d79d1(0x189));}async function checkWifiPresence(_0x3e8b54){const _0xc25fb7=a0_0x89cb30;try{const _0x1c48af=_0x3e8b54['config'][_0xc25fb7(0x1c7)]||[];let _0x489693=![];const _0x4b71b1=[];for(const _0xe804c5 of _0x1c48af){try{const _0x1d858f=await _0x3e8b54['getForeignStateAsync'](_0xe804c5);_0x1d858f&&(_0x1d858f['val']===!![]||_0x1d858f[_0xc25fb7(0x1a4)]===_0xc25fb7(0x1c2)||_0x1d858f['val']===0x1)&&(_0x489693=!![],_0x4b71b1['push'](_0xe804c5));}catch(_0x2452f9){}}return await _0x3e8b54[_0xc25fb7(0x179)](_0xc25fb7(0x2d2),{'val':_0x4b71b1[_0xc25fb7(0x209)](',\x20'),'ack':!![]}),_0x489693&&(_0x3e8b54[_0xc25fb7(0x232)]&&(_0x3e8b54[_0xc25fb7(0x1e2)][_0xc25fb7(0x227)](_0xc25fb7(0x224)),abortExitTimer(_0x3e8b54)),!_0x3e8b54[_0xc25fb7(0x25a)]&&_0x3e8b54['currentSystemMode']===SYSTEM_MODES['NORMAL']&&await setPresence(_0x3e8b54,!![])),_0x489693;}catch(_0x421bae){return![];}}function startExitTimer(_0x59e0ae){const _0x59cc7b=a0_0x89cb30;abortExitTimer(_0x59e0ae),_0x59e0ae[_0x59cc7b(0x1ff)]=!![],_0x59e0ae['exitGraceTimer']=setTimeout(()=>{const _0x4c3938=_0x59cc7b;_0x59e0ae[_0x4c3938(0x1ff)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x59e0ae[_0x59cc7b(0x232)]=setTimeout(()=>{const _0x3ceaf5=_0x59cc7b;setPresence(_0x59e0ae,![]),_0x59e0ae[_0x3ceaf5(0x232)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x3d9de3){const _0x4646d6=a0_0x89cb30;if(_0x3d9de3[_0x4646d6(0x232)])clearTimeout(_0x3d9de3[_0x4646d6(0x232)]);if(_0x3d9de3[_0x4646d6(0x1ef)])clearTimeout(_0x3d9de3[_0x4646d6(0x1ef)]);_0x3d9de3[_0x4646d6(0x232)]=null,_0x3d9de3[_0x4646d6(0x1ef)]=null,_0x3d9de3[_0x4646d6(0x1ff)]=![];}async function setPresence(_0x12543e,_0x364a79){const _0x1881db=a0_0x89cb30;if(_0x12543e[_0x1881db(0x25a)]===_0x364a79)return;_0x12543e['isPresent']=_0x364a79,await _0x12543e[_0x1881db(0x179)](_0x1881db(0x294),{'val':_0x364a79,'ack':!![]});}async function executeAutomationAction(_0x10d78d){const _0x4aa861=a0_0x89cb30;try{const _0x5177c5=await _0x10d78d[_0x4aa861(0x260)](_0x4aa861(0x1c6)),_0x379139=await _0x10d78d[_0x4aa861(0x260)]('analysis.automation.targetValue');if(_0x5177c5&&_0x5177c5[_0x4aa861(0x1a4)]&&_0x379139){const _0xb48be=_0x5177c5['val'];let _0x161a4f=_0x379139[_0x4aa861(0x1a4)];try{_0x161a4f=JSON['parse'](_0x161a4f);}catch(_0x3a2187){}_0x10d78d[_0x4aa861(0x1e2)][_0x4aa861(0x227)](_0x4aa861(0x246)+_0xb48be+_0x4aa861(0x2a4)+_0x161a4f),await _0x10d78d['setForeignStateAsync'](_0xb48be,_0x161a4f);}else _0x10d78d[_0x4aa861(0x1e2)][_0x4aa861(0x2d8)](_0x4aa861(0x21c));}catch(_0x109154){_0x10d78d['log'][_0x4aa861(0x266)](_0x4aa861(0x1e6)+_0x109154['message']);}}async function processSensorEvent(_0x46f487,_0x4199b9,_0x59ad87,_0x103dff){const _0x1e22df=a0_0x89cb30;if(!_0x103dff)return;const _0x3c133a=_0x59ad87[_0x1e22df(0x1a4)],_0x25367f=Date['now'](),_0x175cf7=_0x46f487[_0x1e22df(0x2e2)][_0x4199b9];_0x46f487['sensorLastValues'][_0x4199b9]=_0x3c133a;if(!_0x103dff[_0x1e22df(0x273)]&&_0x175cf7!=undefined&&_0x175cf7==_0x3c133a)return;const _0x346462=(_0x103dff['type']||'')['toLowerCase'](),_0x31a41b=_0x346462[_0x1e22df(0x1d9)](_0x1e22df(0x2b8))||_0x346462[_0x1e22df(0x1d9)](_0x1e22df(0x284))||_0x346462[_0x1e22df(0x1d9)](_0x1e22df(0x2c1))||_0x346462['includes'](_0x1e22df(0x1eb));_0x46f487[_0x1e22df(0x166)]&&_0x31a41b&&recordThermodynamics(_0x46f487,_0x4199b9,_0x3c133a,_0x103dff['location']);const _0x42094e={'timestamp':_0x25367f,'id':_0x4199b9,'name':_0x103dff[_0x1e22df(0x276)],'type':_0x103dff[_0x1e22df(0x203)],'location':_0x103dff['location'],'value':_0x3c133a};_0x46f487[_0x1e22df(0x249)][_0x1e22df(0x1f8)](_0x42094e);if(_0x46f487['eventHistory'][_0x1e22df(0x25d)]>HISTORY_MAX_SIZE)_0x46f487[_0x1e22df(0x249)]['pop']();await _0x46f487['setStateAsync'](_0x1e22df(0x2eb),{'val':JSON[_0x1e22df(0x158)](_0x42094e),'ack':!![]}),await _0x46f487['setStateAsync'](_0x1e22df(0x2d0),{'val':JSON['stringify'](_0x46f487['eventHistory']),'ack':!![]});_0x46f487[_0x1e22df(0x166)]&&(_0x46f487['rawEventLog'][_0x1e22df(0x1fa)](_0x42094e),await saveRawEventLog(_0x46f487),recordSequence(_0x46f487,_0x42094e));if(_0x103dff[_0x1e22df(0x1cd)]&&_0x3c133a===!![]){if(_0x46f487[_0x1e22df(0x25a)]&&!_0x46f487['isGracePeriodActive'])startExitTimer(_0x46f487);else{if(!_0x46f487['isPresent'])setPresence(_0x46f487,!![]);}}else{if(_0x103dff[_0x1e22df(0x203)]===_0x1e22df(0x20a)&&_0x3c133a===!![]){if(_0x46f487[_0x1e22df(0x232)])abortExitTimer(_0x46f487);if(!_0x46f487[_0x1e22df(0x25a)]&&_0x46f487[_0x1e22df(0x2b1)]===SYSTEM_MODES[_0x1e22df(0x1ed)])setPresence(_0x46f487,!![]);}}}async function recordThermodynamics(_0x2aa786,_0x3686d0,_0x314f91,_0x735e7e){const _0x5a8c58=a0_0x89cb30,_0x43f30a=await getOutsideTemperatureNumeric(_0x2aa786),_0xf87de1=await _0x2aa786[_0x5a8c58(0x260)](_0x5a8c58(0x205));let _0xc438e4=[];if(_0xf87de1&&_0xf87de1[_0x5a8c58(0x1a4)])try{_0xc438e4=JSON[_0x5a8c58(0x1a5)](_0xf87de1[_0x5a8c58(0x1a4)]);}catch(_0x5a69f5){}_0xc438e4[_0x5a8c58(0x1fa)]({'ts':Date[_0x5a8c58(0x2af)](),'room':_0x735e7e||_0x5a8c58(0x275),'t_in':_0x314f91,'t_out':_0x43f30a});if(_0xc438e4[_0x5a8c58(0x25d)]>THERMO_LOG_SIZE)_0xc438e4[_0x5a8c58(0x27e)]();await _0x2aa786[_0x5a8c58(0x179)](_0x5a8c58(0x205),{'val':JSON[_0x5a8c58(0x158)](_0xc438e4),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x2d9880){const _0x3fc3c4=a0_0x89cb30;if(_0x2d9880[_0x3fc3c4(0x1e5)]['outdoorSensorId'])try{const _0x19d7dc=await _0x2d9880[_0x3fc3c4(0x2db)](_0x2d9880[_0x3fc3c4(0x1e5)][_0x3fc3c4(0x1fb)]);if(_0x19d7dc&&_0x19d7dc[_0x3fc3c4(0x1a4)]!==undefined&&_0x19d7dc['val']!==null)return parseFloat(_0x19d7dc[_0x3fc3c4(0x1a4)]);}catch(_0x329541){}const _0x2e464d=_0x2d9880['config'][_0x3fc3c4(0x165)];if(!_0x2d9880[_0x3fc3c4(0x1e5)][_0x3fc3c4(0x215)]||!_0x2e464d)return null;try{let _0x5cbccb='';if(_0x2e464d['includes']('accuweather'))_0x5cbccb=_0x2e464d+'.Current.Temperature';else{if(_0x2e464d[_0x3fc3c4(0x1d9)]('daswetter'))_0x5cbccb=_0x2e464d+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x2e464d['includes'](_0x3fc3c4(0x214)))_0x5cbccb=_0x2e464d+_0x3fc3c4(0x2a8);else{if(_0x2e464d['includes'](_0x3fc3c4(0x1b6)))_0x5cbccb=_0x2e464d+'.forecast.current.temp';}}}if(_0x5cbccb){const _0x265b28=await _0x2d9880[_0x3fc3c4(0x2db)](_0x5cbccb);if(_0x265b28&&_0x265b28['val']!==undefined&&_0x265b28[_0x3fc3c4(0x1a4)]!==null)return parseFloat(_0x265b28[_0x3fc3c4(0x1a4)]);}}catch(_0x3c2345){}return null;}async function recordSequence(_0x3d0012,_0x4ffbb4){const _0x57bcd0=a0_0x89cb30,_0x1bfbb8=(_0x4ffbb4[_0x57bcd0(0x203)]||'')[_0x57bcd0(0x20f)](),_0x498ba4=['motion',_0x57bcd0(0x303),'pr√§senz','presence',_0x57bcd0(0x300),_0x57bcd0(0x2ad),_0x57bcd0(0x19d),_0x57bcd0(0x28d),_0x57bcd0(0x27b),_0x57bcd0(0x248),_0x57bcd0(0x244),_0x57bcd0(0x2a5),_0x57bcd0(0x247),_0x57bcd0(0x292),_0x57bcd0(0x1dc),_0x57bcd0(0x271),_0x57bcd0(0x1fc)];if(!_0x498ba4[_0x57bcd0(0x1cc)](_0x59e765=>_0x1bfbb8[_0x57bcd0(0x1d9)](_0x59e765)))return;if(!_0x4ffbb4[_0x57bcd0(0x1c0)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x57bcd0(0x1fa)]({'loc':_0x4ffbb4[_0x57bcd0(0x231)]||_0x57bcd0(0x275),'id':_0x4ffbb4['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{const _0x16518a=_0x57bcd0;if(activeSequence[_0x16518a(0x25d)]>0x1)await saveCompletedSequence(_0x3d0012);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x14957a){const _0x1458f8=a0_0x89cb30;try{const _0x494b17=await _0x14957a[_0x1458f8(0x260)](_0x1458f8(0x1bd));let _0x5ab149=[];if(_0x494b17&&_0x494b17[_0x1458f8(0x1a4)])try{_0x5ab149=JSON[_0x1458f8(0x1a5)](_0x494b17[_0x1458f8(0x1a4)]);}catch(_0x41f578){}const _0x5c0adb=activeSequence[0x0]['ts'],_0x1c2568=activeSequence[_0x1458f8(0x295)](_0x2e7bb7=>({'loc':_0x2e7bb7[_0x1458f8(0x222)],'t_delta':Math['round']((_0x2e7bb7['ts']-_0x5c0adb)/0x3e8)})),_0x33a65b={'timestamp':new Date(_0x5c0adb)[_0x1458f8(0x286)](),'steps':_0x1c2568,'duration':Math[_0x1458f8(0x1ce)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x5c0adb)/0x3e8),'daytime':new Date(_0x5c0adb)[_0x1458f8(0x1e1)]()};_0x5ab149[_0x1458f8(0x1fa)](_0x33a65b);if(_0x5ab149[_0x1458f8(0x25d)]>MAX_TRAINING_SET_SIZE)_0x5ab149['shift']();await _0x14957a[_0x1458f8(0x179)](_0x1458f8(0x1bd),{'val':JSON[_0x1458f8(0x158)](_0x5ab149),'ack':!![]}),runSecurityCheck(_0x14957a,_0x33a65b);}catch(_0x455043){_0x14957a[_0x1458f8(0x1e2)]['error'](_0x1458f8(0x194)+_0x455043[_0x1458f8(0x19e)]);}}function runSecurityCheck(_0x441961,_0x2268ff){const _0x2018e8=a0_0x89cb30;if(!_0x441961['isProVersion'])return;sendToPython(_0x441961,_0x2018e8(0x240),{'sequence':_0x2268ff});}function sendToPython(_0x41a4c2,_0x3da84a,_0x443b9={}){const _0x405455=a0_0x89cb30;if(!_0x41a4c2['pythonProcess']||!_0x41a4c2[_0x405455(0x17c)][_0x405455(0x2f7)]['writable'])return;const _0x43abd7=JSON[_0x405455(0x158)]({'command':_0x3da84a,..._0x443b9});try{_0x41a4c2[_0x405455(0x17c)][_0x405455(0x2f7)][_0x405455(0x26c)](_0x43abd7+'\x0a');}catch(_0x1a568e){}}function startPythonService(_0x2e4645){const _0x1a61c9=a0_0x89cb30;let _0x5479bb=_0x1a61c9(0x208);if(fs[_0x1a61c9(0x190)](PYTHON_EXE))_0x5479bb=PYTHON_EXE;try{const _0x1cce7c=path[_0x1a61c9(0x209)](__dirname,_0x1a61c9(0x2ca),'service.py');_0x2e4645[_0x1a61c9(0x17c)]=spawn(_0x5479bb,[_0x1cce7c]),_0x2e4645[_0x1a61c9(0x17c)]['stdout']['on'](_0x1a61c9(0x28e),_0x4ae505=>{const _0x152de8=_0x1a61c9,_0x5d70ad=_0x4ae505[_0x152de8(0x24e)]()[_0x152de8(0x2c7)]('\x0a');_0x5d70ad[_0x152de8(0x23f)](_0x5b4a5d=>{const _0x4b699f=_0x152de8,_0x474e8f=_0x5b4a5d['trim']();if(!_0x474e8f)return;if(_0x474e8f[_0x4b699f(0x201)](_0x4b699f(0x2ed)))_0x2e4645['log'][_0x4b699f(0x291)]('[PYTHON]\x20'+_0x474e8f[_0x4b699f(0x22f)](0x5)['trim']());else{if(_0x474e8f[_0x4b699f(0x201)]('[RESULT]'))try{const _0x1de434=JSON[_0x4b699f(0x1a5)](_0x474e8f['substring'](0x8)[_0x4b699f(0x2d4)]());handlePythonResult(_0x2e4645,_0x1de434);}catch(_0x25b690){}}});}),_0x2e4645[_0x1a61c9(0x17c)]['on'](_0x1a61c9(0x1a2),_0x7a7e28=>{const _0x513f92=_0x1a61c9;_0x2e4645[_0x513f92(0x17c)]=null;});}catch(_0x4889b0){_0x2e4645[_0x1a61c9(0x1e2)][_0x1a61c9(0x266)](_0x1a61c9(0x16b)+_0x4889b0[_0x1a61c9(0x19e)]);}}function stopPythonService(_0x1af88d){const _0x224c10=a0_0x89cb30;if(_0x1af88d[_0x224c10(0x17c)]){try{_0x1af88d['pythonProcess'][_0x224c10(0x164)]();}catch(_0x307b26){}_0x1af88d[_0x224c10(0x17c)]=null;}}function handlePythonResult(_0x9f96c7,_0x24d430){const _0x527f80=a0_0x89cb30;if(_0x24d430[_0x527f80(0x203)]===_0x527f80(0x1db))_0x9f96c7[_0x527f80(0x1e2)][_0x527f80(0x291)](_0x527f80(0x221));else{if(_0x24d430['type']===_0x527f80(0x16e)){const {anomaly_score:_0x4d1328,is_anomaly:_0x15635e,threshold:_0x26d275,explanation:_0x5c1bbd}=_0x24d430[_0x527f80(0x283)];_0x9f96c7[_0x527f80(0x1e2)][_0x527f80(0x227)](_0x527f80(0x2bf)+_0x4d1328[_0x527f80(0x2e8)](0x5)+_0x527f80(0x2a3)+(_0x15635e?_0x527f80(0x241):'OK')),_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x2dc),{'val':_0x4d1328,'ack':!![]}),_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x155),{'val':new Date()[_0x527f80(0x286)](),'ack':!![]});if(_0x26d275)_0x9f96c7[_0x527f80(0x179)]('analysis.security.currentThreshold',{'val':_0x26d275,'ack':!![]});if(_0x15635e){let _0x7a23d1=_0x527f80(0x1ba)+_0x4d1328[_0x527f80(0x2e8)](0x4)+')';if(_0x5c1bbd&&_0x5c1bbd!==_0x527f80(0x275))_0x7a23d1+='\x0aGrund:\x20'+_0x5c1bbd;_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x198),{'val':!![],'ack':!![]}),_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x2e3),{'val':_0x7a23d1,'ack':!![]}),sendNotification(_0x9f96c7,_0x527f80(0x216)+_0x7a23d1,![],!![]);}}else{if(_0x24d430[_0x527f80(0x203)]===_0x527f80(0x1b8)){const _0x37e8d1=_0x24d430[_0x527f80(0x283)][_0x527f80(0x2ce)]||'',_0x537628=_0x24d430[_0x527f80(0x283)][_0x527f80(0x167)],_0x2de5f8=_0x24d430[_0x527f80(0x283)][_0x527f80(0x18e)]?_0x527f80(0x251)+new Date()[_0x527f80(0x2b3)]()+'\x20('+_0x37e8d1+')':'Failed:\x20'+_0x24d430[_0x527f80(0x283)][_0x527f80(0x1dd)];_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x268),{'val':_0x2de5f8,'ack':!![]});if(_0x24d430[_0x527f80(0x283)][_0x527f80(0x18e)]&&_0x537628)_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x16a),{'val':_0x537628,'ack':!![]});}else{if(_0x24d430[_0x527f80(0x203)]===_0x527f80(0x15b)){const {patterns:_0x24b3fa}=_0x24d430[_0x527f80(0x283)];if(_0x24b3fa&&_0x24b3fa['length']>0x0){_0x9f96c7[_0x527f80(0x1e2)][_0x527f80(0x227)](_0x527f80(0x1df)+_0x24b3fa['length']+_0x527f80(0x15a)),_0x9f96c7['setStateAsync']('analysis.automation.detectedPatterns',{'val':JSON[_0x527f80(0x158)](_0x24b3fa),'ack':!![]});const _0x19ddf0=_0x24b3fa[0x0],_0x116b04=_0x527f80(0x1f3)+_0x19ddf0[_0x527f80(0x18d)]+'\x20('+(_0x19ddf0[_0x527f80(0x269)]*0x64)['toFixed'](0x0)+'%)';_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x1d3),{'val':!![],'ack':!![]}),_0x9f96c7['setStateAsync'](_0x527f80(0x1e8),{'val':_0x116b04,'ack':!![]});}else _0x9f96c7[_0x527f80(0x1e2)][_0x527f80(0x227)]('üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x9f96c7['setStateAsync'](_0x527f80(0x1d3),{'val':![],'ack':!![]}),_0x9f96c7['setStateAsync'](_0x527f80(0x17e),{'val':'[]','ack':!![]});}else{if(_0x24d430[_0x527f80(0x203)]===_0x527f80(0x238)){if(_0x24d430[_0x527f80(0x283)][_0x527f80(0x18e)])try{const _0x10a228=JSON[_0x527f80(0x1a5)](_0x24d430[_0x527f80(0x283)][_0x527f80(0x2ce)]);if(_0x10a228[_0x527f80(0x225)])_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x252),{'val':JSON[_0x527f80(0x158)](_0x10a228[_0x527f80(0x225)]),'ack':!![]});if(_0x10a228[_0x527f80(0x162)])_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x15f),{'val':JSON[_0x527f80(0x158)](_0x10a228[_0x527f80(0x162)]),'ack':!![]});}catch(_0x58c7d2){}}else{if(_0x24d430['type']===_0x527f80(0x22a)){if(_0x24d430[_0x527f80(0x283)][_0x527f80(0x18e)])_0x9f96c7[_0x527f80(0x1e2)][_0x527f80(0x227)](_0x527f80(0x180));}else{if(_0x24d430['type']===_0x527f80(0x264))_0x9f96c7['setStateAsync'](_0x527f80(0x24d),{'val':new Date()[_0x527f80(0x286)](),'ack':!![]}),_0x9f96c7['setStateAsync']('analysis.health.isAnomaly',{'val':_0x24d430[_0x527f80(0x283)]['is_anomaly'],'ack':!![]});else{if(_0x24d430['type']===_0x527f80(0x1a7))_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x230),{'val':_0x24d430[_0x527f80(0x283)]['diagnosis'],'ack':!![]}),_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x2c9),{'val':_0x24d430['payload'][_0x527f80(0x29b)],'ack':!![]});else{if(_0x24d430['type']==='GAIT_RESULT'){const {speed_trend:_0x4101c8}=_0x24d430[_0x527f80(0x283)];_0x4101c8!==undefined&&_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x258),{'val':_0x4101c8,'ack':!![]});}else{if(_0x24d430[_0x527f80(0x203)]===_0x527f80(0x23b)){const {forecast:_0x5a4546}=_0x24d430['payload'];_0x5a4546&&_0x9f96c7[_0x527f80(0x179)](_0x527f80(0x1fe),{'val':JSON[_0x527f80(0x158)](_0x5a4546),'ack':!![]});}else{if(_0x24d430[_0x527f80(0x203)]===_0x527f80(0x20b)){const {data:_0x4bd636}=_0x24d430[_0x527f80(0x283)];_0x4bd636&&(_0x9f96c7[_0x527f80(0x1e2)][_0x527f80(0x227)](_0x527f80(0x2fc)),_0x9f96c7['setStateAsync'](_0x527f80(0x1b7),{'val':JSON[_0x527f80(0x158)](_0x4bd636),'ack':!![]}));}}}}}}}}}}}}function runPythonHealthCheck(_0x56a652){const _0x54571c=a0_0x89cb30;if(!_0x56a652[_0x54571c(0x1d2)]||_0x56a652[_0x54571c(0x1d2)][_0x54571c(0x25d)]<0x2)return;const _0x57b41f=_0x56a652[_0x54571c(0x1d2)][_0x54571c(0x295)](_0x3b49b3=>{const _0x23e519=_0x54571c,_0x239617=(_0x3b49b3[_0x23e519(0x1bb)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x239617]||0x32;});sendToPython(_0x56a652,_0x54571c(0x278),{'values':_0x57b41f,'tag':_0x54571c(0x28a)});}async function handleTelegramResponse(_0x59d33e,_0x9409d5){const _0x57b9c3=a0_0x89cb30;let _0x1f4c09=_0x9409d5;_0x9409d5[_0x57b9c3(0x201)]('[')&&(_0x1f4c09=_0x9409d5[_0x57b9c3(0x22f)](_0x9409d5[_0x57b9c3(0x1f6)](']')+0x1));if(_0x1f4c09===_0x57b9c3(0x2e4))await _0x59d33e['setStateAsync'](_0x57b9c3(0x198),{'val':![],'ack':!![]}),await _0x59d33e['setStateAsync'](_0x57b9c3(0x2e3),{'val':_0x57b9c3(0x2e5),'ack':!![]}),_0x59d33e[_0x57b9c3(0x2d1)]=![],sendNotification(_0x59d33e,_0x57b9c3(0x15c),![]);else _0x1f4c09===_0x57b9c3(0x22b)&&sendNotification(_0x59d33e,'üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.',![],!![]);}async function sendNotification(_0x24ec7c,_0x531080,_0x2d6d56=![],_0xc3dbbb=![]){const _0x4821ec=a0_0x89cb30,_0x19a409=_0x24ec7c[_0x4821ec(0x1e5)];if(_0x19a409[_0x4821ec(0x279)]){let _0x529f24={};(_0x531080[_0x4821ec(0x1d9)](_0x4821ec(0x304))||_0xc3dbbb)&&(_0x529f24={'reply_markup':{'inline_keyboard':[[{'text':_0x4821ec(0x176),'callback_data':_0x4821ec(0x2e4)}],[{'text':_0x4821ec(0x2ab),'callback_data':_0x4821ec(0x22b)}]]}}),await _0x24ec7c[_0x4821ec(0x254)](_0x19a409[_0x4821ec(0x256)],_0x4821ec(0x1a6),{'text':_0x531080,'user':_0x19a409[_0x4821ec(0x2d9)],..._0x529f24});}if(_0x19a409[_0x4821ec(0x1f9)]){let _0x3b01a2={'message':_0x531080,'title':_0xc3dbbb?_0x4821ec(0x1de):'Cogni-Living','priority':_0xc3dbbb?0x2:0x1,'device':_0x19a409[_0x4821ec(0x26d)]};_0xc3dbbb&&(_0x3b01a2[_0x4821ec(0x2cf)]=0x1e,_0x3b01a2[_0x4821ec(0x1f7)]=0xe10,_0x3b01a2[_0x4821ec(0x170)]=_0x4821ec(0x163)),await _0x24ec7c[_0x4821ec(0x254)](_0x19a409[_0x4821ec(0x2de)],_0x4821ec(0x1a6),_0x3b01a2);}_0x19a409[_0x4821ec(0x277)]&&await _0x24ec7c[_0x4821ec(0x254)](_0x19a409['notifyEmailInstance'],_0x4821ec(0x1a6),{'text':_0x531080,'to':_0x19a409[_0x4821ec(0x263)]});}async function runGeminiAnalysis(_0x2108e4,_0x18fb24=''){const _0x34ea3f=a0_0x89cb30;if(!_0x2108e4['geminiModel'])return;if(_0x2108e4[_0x34ea3f(0x249)]['length']===0x0)return;const _0x2c0591=_0x2108e4[_0x34ea3f(0x249)][_0x34ea3f(0x2d7)](0x0,0xf),_0x113f32=await getWeatherContext(_0x2108e4),_0x566e3b=_0x2108e4[_0x34ea3f(0x2b1)],_0x5b34fd=PERSONA_MAPPING[_0x2108e4[_0x34ea3f(0x1e5)]['aiPersona']||_0x34ea3f(0x2b9)],_0x55b732=_0x2108e4['config'][_0x34ea3f(0x262)]||_0x34ea3f(0x1fd);let _0x698358=_0x34ea3f(0x1ad);try{const _0x5bf698=await _0x2108e4[_0x34ea3f(0x260)](_0x34ea3f(0x2d2));if(_0x5bf698&&_0x5bf698[_0x34ea3f(0x1a4)])_0x698358=_0x5bf698['val'];}catch(_0x3e65be){}let _0x1c73e6=![];try{const _0x9c77d3=await _0x2108e4[_0x34ea3f(0x260)](_0x34ea3f(0x206));if(_0x9c77d3&&_0x9c77d3[_0x34ea3f(0x1a4)])_0x1c73e6=!![];}catch(_0x175a04){}const _0x38d687=_0x34ea3f(0x196)+_0x5b34fd+_0x34ea3f(0x2f9)+_0x55b732+_0x34ea3f(0x29c)+_0x566e3b+'.\x20WETTER:\x20'+_0x113f32+'.\x20ANWESEND:\x20'+_0x698358+_0x34ea3f(0x1b0)+JSON['stringify'](_0x2c0591)+_0x34ea3f(0x21f)+_0x18fb24+_0x34ea3f(0x2a1);try{const _0x4cb146=await _0x2108e4[_0x34ea3f(0x186)]['generateContent'](_0x38d687),_0x17d533=JSON[_0x34ea3f(0x1a5)](_0x4cb146[_0x34ea3f(0x15e)][_0x34ea3f(0x15d)]()[_0x34ea3f(0x243)](/```json|```/g,'')[_0x34ea3f(0x2d4)]());await _0x2108e4[_0x34ea3f(0x179)](_0x34ea3f(0x24c),{'val':JSON[_0x34ea3f(0x158)](_0x17d533),'ack':!![]});if(_0x17d533[_0x34ea3f(0x299)])await _0x2108e4[_0x34ea3f(0x179)](_0x34ea3f(0x23c),{'val':_0x17d533[_0x34ea3f(0x299)],'ack':!![]});const _0x168443={'timestamp':Date['now'](),'id':Date[_0x34ea3f(0x2af)]()['toString'](),'analysis':{'activity':{'summary':_0x17d533[_0x34ea3f(0x299)],'isAlert':_0x17d533['isAlert'],'alertReason':_0x17d533[_0x34ea3f(0x192)]},'comfort':{'automationProposal':_0x17d533[_0x34ea3f(0x219)]}}};await updateAnalysisHistory(_0x2108e4,_0x168443);const _0x1279f6=_0x17d533[_0x34ea3f(0x2a7)]||![];_0x1279f6!==_0x2108e4[_0x34ea3f(0x2d1)]&&(await _0x2108e4[_0x34ea3f(0x179)](_0x34ea3f(0x198),{'val':_0x1279f6,'ack':!![]}),_0x2108e4[_0x34ea3f(0x2d1)]=_0x1279f6,_0x1279f6&&(await _0x2108e4['setStateAsync']('analysis.alertReason',{'val':_0x17d533[_0x34ea3f(0x192)],'ack':!![]}),sendNotification(_0x2108e4,'‚ö†Ô∏è\x20ALARM:\x20'+_0x17d533[_0x34ea3f(0x192)],![],_0x17d533[_0x34ea3f(0x2f3)])));if(_0x17d533[_0x34ea3f(0x219)]&&_0x17d533[_0x34ea3f(0x219)][_0x34ea3f(0x2f0)]){await _0x2108e4[_0x34ea3f(0x179)](_0x34ea3f(0x1d3),{'val':!![],'ack':!![]}),await _0x2108e4['setStateAsync'](_0x34ea3f(0x1e8),{'val':_0x17d533[_0x34ea3f(0x219)][_0x34ea3f(0x1b2)],'ack':!![]}),await _0x2108e4[_0x34ea3f(0x179)](_0x34ea3f(0x1c6),{'val':_0x17d533['automationProposal'][_0x34ea3f(0x17d)],'ack':!![]}),await _0x2108e4[_0x34ea3f(0x179)](_0x34ea3f(0x211),{'val':JSON['stringify'](_0x17d533[_0x34ea3f(0x219)][_0x34ea3f(0x18c)]),'ack':!![]});if(_0x1c73e6)executeAutomationAction(_0x2108e4);}}catch(_0x51314f){_0x2108e4[_0x34ea3f(0x1e2)][_0x34ea3f(0x266)](_0x34ea3f(0x23a)+_0x51314f[_0x34ea3f(0x19e)]);}}async function createDailyDigest(_0x9d5cfe){const _0x41ca56=a0_0x89cb30;if(!_0x9d5cfe[_0x41ca56(0x166)])return;await _0x9d5cfe[_0x41ca56(0x179)](LTM_DP_STATUS,{'val':_0x41ca56(0x1b5),'ack':!![]});if(!_0x9d5cfe[_0x41ca56(0x186)]||_0x9d5cfe[_0x41ca56(0x27c)][_0x41ca56(0x25d)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x9d5cfe[_0x41ca56(0x179)](LTM_DP_STATUS,{'val':_0x41ca56(0x168),'ack':!![]});return;}const _0x162a64=JSON[_0x41ca56(0x1a5)](JSON[_0x41ca56(0x158)](_0x9d5cfe[_0x41ca56(0x27c)])),_0x283ec5=_0x162a64[_0x41ca56(0x25d)],_0x3eab89=_0x41ca56(0x2e0)+JSON[_0x41ca56(0x158)](_0x162a64);try{const _0x363a16=await _0x9d5cfe[_0x41ca56(0x186)][_0x41ca56(0x16d)](_0x3eab89),_0x5a79c3=JSON[_0x41ca56(0x1a5)](_0x363a16[_0x41ca56(0x15e)][_0x41ca56(0x15d)]()['replace'](/```json|```/g,'')[_0x41ca56(0x2d4)]()),_0x3b49c5={'timestamp':new Date()[_0x41ca56(0x286)](),'eventCount':_0x283ec5,'summary':_0x5a79c3[_0x41ca56(0x299)]||_0x41ca56(0x226),'activityLevel':_0x5a79c3[_0x41ca56(0x1bb)]||_0x41ca56(0x2ee),'systemMode':_0x9d5cfe[_0x41ca56(0x2b1)]};_0x9d5cfe[_0x41ca56(0x1d2)]['push'](_0x3b49c5),await saveDailyDigests(_0x9d5cfe),_0x9d5cfe['rawEventLog']=[],await saveRawEventLog(_0x9d5cfe),await _0x9d5cfe[_0x41ca56(0x179)](LTM_DP_STATUS,{'val':'Success','ack':!![]});if(_0x9d5cfe['isProVersion'])sendToPython(_0x9d5cfe,_0x41ca56(0x1ac),{'digest':_0x3b49c5});}catch(_0x386672){_0x9d5cfe[_0x41ca56(0x1e2)][_0x41ca56(0x266)](_0x386672['message']);}}function a0_0x1ef0(){const _0x1cee5d=['temperatur','29004cOVaJf','toISOString','sendTo','üöÄ\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.0)...','User\x20dismissed\x20automation\x20proposal.','Activity-Level','Scripts','Wetterdaten\x20deaktiviert.','window','data','events.history_debug_00','genAI','debug','switch','analysis.trigger','system.isPresent','map','text.alarm','geminiApiKey','Deaktiviert\x20(Pro-Feature)','summary','676828OygwQq','change_percent','.\x20SYSTEM_MODE:\x20','simulateButler','python','.Current.Temperature','Security\x20Monitor','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','unload','\x20->\x20','\x20=\x20','light','version','isAlert','.forecast.current.temperature','¬∞C,\x20','filter','üìû\x20R√ºckruf\x20anfordern','lights','door','Kalender\x20deaktiviert.','now','system.config','currentSystemMode','find','toLocaleTimeString','Today\x20Vector\x20(15m)','Trigger\x20Briefing','analysis.training.triggerComfort','Trend\x20Value','temperature','generic','Health\x20Analysis','analysis.training','Raw\x20Log','values','endsWith','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','number','klima','callback','Topology\x20Matrix','driftAnalysisTimer','briefingEnabled','OK:\x20','split','Sec-Training\x20started...','analysis.health.trendValue','python_service','Gemini\x20AI\x20initialized.','pop','0\x204\x20*\x20*\x20*','details','retry','events.history','lastAlertState','system.presenceWho','automation.triggerAction','trim','analysis.health','rmSync','slice','warn','notifyTelegramRecipient','Keine\x20Wetterdaten\x20verf√ºgbar.','getForeignStateAsync','analysis.security.lastScore','python.exe','notifyPushoverInstance',')\x20-\x20SAFE\x20BOOT','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...','sensorLastValues','analysis.alertReason','COGNI_CONFIRM_OK','Vom\x20Benutzer\x20best√§tigt\x20(OK).','minDaysForBaseline','from','toFixed','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','longitude','events.lastEvent','10oRZMCt','[LOG]','normal','common','detected','button','.forecast.current.state','isEmergency','LTM.dailyDigests','Last\x20Check','PRIORIT√ÑT:\x20Sicherheit.','stdin','child_process','.\x20KONTEXT:\x20','analysis.triggerBriefing','‚ùå\x20VENV\x20FAILED:\x20','üï∏Ô∏è\x20Topology\x20Map\x20updated.','1925412EzVJvG','Training\x20Error:\x20','.Current.WeatherText','occupancy','N/A','LTM.baselineStatus','bewegung','Alarm','analysis.security.lastCheck','system.mode','cogni-living','stringify','onMessage','\x20new\x20patterns.','COMFORT_RESULT','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','text','response','analysis.energy.heatingScore','cogni-living\x20adapter\x20starting\x20(v','2563fSwjxl','heating','siren','kill','weatherInstance','isProVersion','threshold','Skipped\x20(No\x20AI\x20or\x20Data)','unknown','analysis.security.currentThreshold','Error\x20launching\x20Python:\x20','analysis.training.triggerSecurity','generateContent','SECURITY_RESULT','timestamp','sound','setHours','baselineDrift','win32','getForeignObjectsAsync','Drift\x20Sched\x20Error:\x20','‚úÖ\x20Alles\x20OK\x20(Reset)','ltmJob','getMonth','setStateAsync','dismissAutomation','node-schedule','pythonProcess','targetId','analysis.automation.detectedPatterns','json','‚úÖ\x20HEALTH\x20TRAINED.','Detected\x20Patterns','latitude','onUnload','instance','onStateChange','geminiModel','@iobroker/adapter-core','setObjectNotExistsAsync','.communicate.request','licenseKey','briefingJob','targetValue','rule','success','Adapter','existsSync','exports','alertReason','üåÖ\x20Morning\x20Briefing:\x0a','[RECORDER]\x20Error:\x20','fill','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','Trigger\x20Analysis','analysis.isAlert','analysisHistory','calendarInstance','analysis.training.triggerTopology','devices','t√ºr','message','doors','ANALYZE_GAIT','autoApply','close','Fokus\x20auf\x20Komfort.','val','parse','send','TREND_RESULT','Err:\x20','status','\x0aSTB:\x20','Build\x20Topology','ANALYZE_HEALTH','Unbekannt','LTM.driftAnalysis.driftDetails','Gemini\x20Init\x20Error:\x20','.\x20EVENTS:\x20','Train\x20Security','description','telegram','TRAIN_COMFORT','Started...','weatherunderground','analysis.security.topologyMatrix','TRAINING_COMPLETE','modeResetJob','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','activityLevel','dependencyInstallInProgress','LTM.trainingData.sequences','apply','analysis.training.triggerHealth','value','pip','online','briefingTime','channel','date','analysis.automation.targetId','presenceDevices','extendObjectAsync','TRAIN_SECURITY','Kein\x20API\x20Key!','Heating\x20Score','some','isExit','round','Fokus\x20auf\x20Familienroutinen.','ready','models/gemini-flash-latest','dailyDigests','analysis.automation.patternDetected','System\x20Mode','getGenerativeModel','state','analysis.health.todayVector','üß†\x20Triggering\x20Security\x20Training...','includes','10IvozQF','PONG','schalter','reason','üö®\x20EMERGENCY','üõãÔ∏è\x20BUTLER:\x20Found\x20','Thermodynamics','getHours','log','keys','splice','config','BUTLER\x20Execution\x20Error:\x20','Briefing\x20Error:\x20','analysis.automation.description','main','‚ùå\x20INSTALL\x20FAILED:\x20','heizung','indicator','NORMAL','36sClcdx','exitGraceTimer','system','bind','requirements.txt','Regel\x20erkannt:\x20','boolean','analysis.automation.triggerAction','indexOf','expire','unshift','notifyPushoverEnabled','push','outdoorSensorId','lampe','Keine\x20Details.','analysis.energy.forecast','isGracePeriodActive','submitFeedback','startsWith','Train\x20Energy','type','subscribeForeignStatesAsync','LTM.trainingData.thermodynamics','analysis.automation.autoApply','setState','python3','join','motion','TOPOLOGY_RESULT','Who\x20is\x20present?','\x20Tage)','analysisTimer','toLowerCase','city','analysis.automation.targetValue','subscribeStates','Missing\x20data','openweathermap','useWeather','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','Description','constructor','automationProposal','getTime','LTM.rawEventLog','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','apiKey','platform','.\x20EMERGENCY:\x20','analysis.training.triggerEnergy','üêç\x20Python\x20Pong','loc','python3\x20-m\x20venv\x20\x22','WiFi\x20Presence\x20detected.','insulation','Digest','info','Trigger\x20Action','(((.+)+)+)+$','HEALTH_TRAIN_RESULT','COGNI_REQUEST_CALL','Analysiere\x20ausgewogen.','‚úÖ\x20INSTALL\x20SUCCESS.','Keine\x20Termine.','substring','analysis.health.trendDiagnosis','location','exitTimer','search','KI-Modell\x20nicht\x20initialisiert','scanDevices','Briefing\x20Sched\x20Error:\x20','3083738SinDbK','ENERGY_TRAIN_RESULT','delObjectAsync','Gemini\x20Error:\x20','ENERGY_PREDICT_RESULT','analysis.activitySummary','getForeignObjectAsync','command','forEach','ANALYZE_SEQUENCE','ANOMALY','enum.functions.*','replace','kontakt','getEnums','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','licht','contact','eventHistory','ack','üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','analysis.lastResult','analysis.health.lastCheck','toString','getMinutes','ltmLtbWindowDays','Success:\x20','analysis.energy.insulationScore','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','sendToAsync','697428Zghnyi','notifyTelegramInstance','LTM.processingStatus','analysis.health.gaitSpeed','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','isPresent','Alert\x20Reason','12741xlQdBo','length','PREDICT_ENERGY','BUILD_TOPOLOGY','getStateAsync','inactivityThresholdHours','livingContext','notifyEmailRecipient','HEALTH_RESULT','Alert\x20Status','error','Event\x20History','analysis.training.status','confidence','string','\x20*\x20*\x20*','write','notifyPushoverRecipient','6831981sdNvXq','8oqIUJb','analysis.health.isAnomaly','dimmer','.venv','logDuplicates','analysisInterval','Unknown','name','notifyEmailEnabled','ANALYZE_TREND','notifyTelegramEnabled','useCalendar','fenster','rawEventLog','Activity\x20Summary','shift','System','scheduleJob','Installing\x20pip\x20packages...','cancel','payload'];a0_0x1ef0=function(){return _0x1cee5d;};return a0_0x1ef0();}function setupLtmScheduler(_0x3229a6){const _0x276fc0=a0_0x89cb30;try{if(_0x3229a6[_0x276fc0(0x177)])_0x3229a6['ltmJob']['cancel']();if(!_0x3229a6['isProVersion'])return;_0x3229a6[_0x276fc0(0x177)]=schedule[_0x276fc0(0x280)](LTM_SCHEDULE,()=>createDailyDigest(_0x3229a6));}catch(_0x23353b){_0x3229a6[_0x276fc0(0x1e2)][_0x276fc0(0x266)]('LTM\x20Sched\x20Error:\x20'+_0x23353b['message']);}}function setupModeResetScheduler(_0x5b16bc){const _0x2e5d86=a0_0x89cb30;try{if(_0x5b16bc[_0x2e5d86(0x1b9)])_0x5b16bc[_0x2e5d86(0x1b9)][_0x2e5d86(0x282)]();_0x5b16bc['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x47356a=_0x2e5d86;await loadSystemMode(_0x5b16bc),AUTO_RESET_MODES[_0x47356a(0x1d9)](_0x5b16bc['currentSystemMode'])&&await _0x5b16bc[_0x47356a(0x179)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x47356a(0x1ed)],'ack':![]});});}catch(_0x4786fa){_0x5b16bc[_0x2e5d86(0x1e2)][_0x2e5d86(0x266)]('Reset\x20Sched\x20Error:\x20'+_0x4786fa[_0x2e5d86(0x19e)]);}}function setupDriftAnalysisScheduler(_0x253bd3){const _0x13325b=a0_0x89cb30;try{if(_0x253bd3['driftAnalysisTimer'])clearInterval(_0x253bd3['driftAnalysisTimer']);if(!_0x253bd3[_0x13325b(0x166)])return;_0x253bd3[_0x13325b(0x2c4)]=setInterval(()=>runBaselineDriftAnalysis(_0x253bd3),(_0x253bd3[_0x13325b(0x1e5)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x253bd3),0x1388);}catch(_0xee94a){_0x253bd3[_0x13325b(0x1e2)][_0x13325b(0x266)](_0x13325b(0x175)+_0xee94a[_0x13325b(0x19e)]);}}function setupBriefingScheduler(_0xd3abb4){const _0x650875=a0_0x89cb30;try{if(_0xd3abb4['briefingJob'])_0xd3abb4['briefingJob'][_0x650875(0x282)]();if(!_0xd3abb4[_0x650875(0x1e5)][_0x650875(0x2c5)])return;const _0x14922f=(_0xd3abb4[_0x650875(0x1e5)][_0x650875(0x1c3)]||'08:00')[_0x650875(0x2c7)](':'),_0x5cb810=parseInt(_0x14922f[0x0])||0x8,_0x4d0bd9=parseInt(_0x14922f[0x1])||0x0,_0x1fec0e=_0x4d0bd9+'\x20'+_0x5cb810+_0x650875(0x26b);_0xd3abb4[_0x650875(0x18b)]=schedule['scheduleJob'](_0x1fec0e,()=>{sendMorningBriefing(_0xd3abb4);});}catch(_0x5717a9){_0xd3abb4['log'][_0x650875(0x266)](_0x650875(0x236)+_0x5717a9['message']);}}async function runBaselineDriftAnalysis(_0x2a272d){const _0x212704=a0_0x89cb30;if(!_0x2a272d[_0x212704(0x166)]||!_0x2a272d['geminiModel'])return;const _0x5e1edd=_0x2a272d[_0x212704(0x1e5)]['ltmStbWindowDays']||0xe;if(_0x2a272d[_0x212704(0x1d2)][_0x212704(0x25d)]<_0x5e1edd+0x7){await _0x2a272d[_0x212704(0x179)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x500d9a=_0x2a272d['dailyDigests'][_0x212704(0x2d7)](-_0x5e1edd),_0x499b63=_0x2a272d[_0x212704(0x1d2)][_0x212704(0x2d7)](0x0,_0x2a272d[_0x212704(0x1d2)][_0x212704(0x25d)]-_0x5e1edd),_0x3983c9='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON['stringify'](_0x499b63)+_0x212704(0x1aa)+JSON[_0x212704(0x158)](_0x500d9a);try{const _0x9ade95=await _0x2a272d['geminiModel'][_0x212704(0x16d)](_0x3983c9),_0xbcc6e7=JSON[_0x212704(0x1a5)](_0x9ade95[_0x212704(0x15e)]['text']()['replace'](/```json|```/g,'')[_0x212704(0x2d4)]());_0xbcc6e7[_0x212704(0x172)]&&(await _0x2a272d['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0xbcc6e7[_0x212704(0x172)],'ack':!![]}),await _0x2a272d[_0x212704(0x179)](LTM_DP_DRIFT_DETAILS,{'val':_0xbcc6e7['driftDetails'],'ack':!![]}),await _0x2a272d['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x1cf991){}}class CogniLiving extends utils[a0_0x89cb30(0x18f)]{constructor(_0x5639a4){const _0x295b72=a0_0x89cb30;super({..._0x5639a4,'name':_0x295b72(0x157)}),this[_0x295b72(0x249)]=[],this['analysisHistory']=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x295b72(0x2e2)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x295b72(0x25a)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x295b72(0x1ff)]=![],this[_0x295b72(0x290)]=null,this[_0x295b72(0x186)]=null,this[_0x295b72(0x2b1)]=SYSTEM_MODES[_0x295b72(0x1ed)],this[_0x295b72(0x166)]=![],this[_0x295b72(0x2d1)]=![],this['systemUUID']=_0x295b72(0x169),this[_0x295b72(0x20e)]=null,this['ltmJob']=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this[_0x295b72(0x18b)]=null,this[_0x295b72(0x17c)]=null,this[_0x295b72(0x1bc)]=![],this['on'](_0x295b72(0x1d0),this['onReady'][_0x295b72(0x1f1)](this)),this['on']('stateChange',this[_0x295b72(0x185)]['bind'](this)),this['on'](_0x295b72(0x2a2),this[_0x295b72(0x183)][_0x295b72(0x1f1)](this)),this['on']('message',this[_0x295b72(0x159)][_0x295b72(0x1f1)](this));}async['onReady'](){const _0x59d94e=a0_0x89cb30;this[_0x59d94e(0x1e2)]['info'](_0x59d94e(0x160)+this[_0x59d94e(0x2a6)]+_0x59d94e(0x2df));if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x89cb30(0x183)](_0x18c7e3){const _0x5dfc03=a0_0x89cb30;if(this[_0x5dfc03(0x20e)])clearInterval(this[_0x5dfc03(0x20e)]);if(this[_0x5dfc03(0x2c4)])clearInterval(this[_0x5dfc03(0x2c4)]);if(this[_0x5dfc03(0x177)])this['ltmJob'][_0x5dfc03(0x282)]();if(this['modeResetJob'])this[_0x5dfc03(0x1b9)][_0x5dfc03(0x282)]();if(this[_0x5dfc03(0x18b)])this[_0x5dfc03(0x18b)][_0x5dfc03(0x282)]();if(this['exitTimer'])clearTimeout(this['exitTimer']);if(this[_0x5dfc03(0x1ef)])clearTimeout(this[_0x5dfc03(0x1ef)]);stopPythonService(this),_0x18c7e3();}async[a0_0x89cb30(0x185)](_0x5d999e,_0xce9185){const _0x3973ba=a0_0x89cb30;if(!_0xce9185||this[_0x3973ba(0x1bc)])return;if(_0x5d999e[_0x3973ba(0x1d9)](_0x3973ba(0x1b3))&&_0x5d999e[_0x3973ba(0x2be)]('communicate.request')&&_0xce9185['val']){await handleTelegramResponse(this,_0xce9185['val']);return;}if(_0x5d999e===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0xce9185[_0x3973ba(0x1a4)]&&Object[_0x3973ba(0x2bd)](SYSTEM_MODES)[_0x3973ba(0x1d9)](_0xce9185['val'])){this[_0x3973ba(0x2b1)]=_0xce9185[_0x3973ba(0x1a4)];if(_0xce9185['val']===SYSTEM_MODES['VACATION'])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0xce9185[_0x3973ba(0x24a)])this[_0x3973ba(0x207)](_0x5d999e,{'val':this[_0x3973ba(0x2b1)],'ack':!![]});return;}if(!_0xce9185[_0x3973ba(0x24a)]){_0x5d999e[_0x3973ba(0x1d9)]('analysis.trigger')&&_0xce9185[_0x3973ba(0x1a4)]&&(this[_0x3973ba(0x207)](_0x5d999e,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x5d999e[_0x3973ba(0x1d9)]('triggerDailyDigest')&&_0xce9185[_0x3973ba(0x1a4)]){this[_0x3973ba(0x207)](_0x5d999e,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x5d999e['includes']('triggerBriefing')&&_0xce9185['val']&&(this[_0x3973ba(0x207)](_0x5d999e,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x5d999e[_0x3973ba(0x1d9)](_0x3973ba(0x2d3))&&_0xce9185[_0x3973ba(0x1a4)]&&(this[_0x3973ba(0x207)](_0x5d999e,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x5d999e[_0x3973ba(0x1d9)](_0x3973ba(0x16c))&&_0xce9185[_0x3973ba(0x1a4)]){this[_0x3973ba(0x207)](_0x5d999e,{'val':![],'ack':!![]});if(this[_0x3973ba(0x166)])try{const _0x1934b6=await this['getStateAsync'](_0x3973ba(0x1bd));if(_0x1934b6&&_0x1934b6[_0x3973ba(0x1a4)]){const _0x41bdbe=JSON[_0x3973ba(0x1a5)](_0x1934b6['val']);this[_0x3973ba(0x1e2)]['info'](_0x3973ba(0x1d8)),this[_0x3973ba(0x179)](_0x3973ba(0x268),{'val':_0x3973ba(0x2c8),'ack':!![]}),sendToPython(this,_0x3973ba(0x1c9),{'sequences':_0x41bdbe});}}catch(_0x452f8d){this['log']['error'](_0x3973ba(0x2fe)+_0x452f8d['message']);}}if(_0x5d999e['includes']('analysis.training.triggerHealth')&&_0xce9185['val']){this['setState'](_0x5d999e,{'val':![],'ack':!![]});if(this[_0x3973ba(0x166)])try{const _0x52d1ae=await this[_0x3973ba(0x260)](LTM_DP_DAILY_DIGESTS);if(_0x52d1ae&&_0x52d1ae[_0x3973ba(0x1a4)])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0x3973ba(0x1a5)](_0x52d1ae[_0x3973ba(0x1a4)])});}catch(_0x41b0c9){}}if(_0x5d999e[_0x3973ba(0x1d9)](_0x3973ba(0x220))&&_0xce9185[_0x3973ba(0x1a4)]){this[_0x3973ba(0x207)](_0x5d999e,{'val':![],'ack':!![]});if(this[_0x3973ba(0x166)])try{const _0x3c83e4=await this[_0x3973ba(0x260)](_0x3973ba(0x205));if(_0x3c83e4&&_0x3c83e4['val'])sendToPython(this,'TRAIN_ENERGY',{'points':JSON['parse'](_0x3c83e4[_0x3973ba(0x1a4)])});}catch(_0x358072){}}if(_0x5d999e['includes'](_0x3973ba(0x2b6))&&_0xce9185[_0x3973ba(0x1a4)]){this[_0x3973ba(0x207)](_0x5d999e,{'val':![],'ack':!![]});if(this[_0x3973ba(0x166)])try{const _0x52ecc8=await this[_0x3973ba(0x260)](LTM_DP_RAW_LOG);_0x52ecc8&&_0x52ecc8[_0x3973ba(0x1a4)]&&(this[_0x3973ba(0x1e2)]['info'](_0x3973ba(0x24b)),sendToPython(this,_0x3973ba(0x1b4),{'events':JSON[_0x3973ba(0x1a5)](_0x52ecc8[_0x3973ba(0x1a4)])}));}catch(_0x56a772){}}if(_0x5d999e['includes'](_0x3973ba(0x19b))&&_0xce9185['val']){this[_0x3973ba(0x207)](_0x5d999e,{'val':![],'ack':!![]});if(this[_0x3973ba(0x166)])try{const _0x3b333b=await this[_0x3973ba(0x260)](_0x3973ba(0x1bd));if(_0x3b333b&&_0x3b333b[_0x3973ba(0x1a4)]){const _0x3eb02b=JSON[_0x3973ba(0x1a5)](_0x3b333b[_0x3973ba(0x1a4)]);this[_0x3973ba(0x1e2)][_0x3973ba(0x227)]('üï∏Ô∏è\x20Building\x20Topology\x20Matrix...'),sendToPython(this,_0x3973ba(0x25f),{'sequences':_0x3eb02b});}}catch(_0x149c54){this[_0x3973ba(0x1e2)]['error']('Topology\x20Error:\x20'+_0x149c54[_0x3973ba(0x19e)]);}}return;}if(this[_0x3973ba(0x1e5)][_0x3973ba(0x1c7)]&&this[_0x3973ba(0x1e5)]['presenceDevices'][_0x3973ba(0x1d9)](_0x5d999e)){await checkWifiPresence(this);return;}const _0x4d417b=(this['config']['devices']||[])[_0x3973ba(0x2b2)](_0x277501=>_0x277501['id']===_0x5d999e);if(_0x4d417b)processSensorEvent(this,_0x5d999e,_0xce9185,_0x4d417b);}async['onMessage'](_0x1b12ec){const _0x180fd2=a0_0x89cb30;if(typeof _0x1b12ec==='object'&&_0x1b12ec[_0x180fd2(0x19e)]){if(_0x1b12ec[_0x180fd2(0x23e)]==='testApiKey'){const _0x42853c=_0x1b12ec[_0x180fd2(0x19e)][_0x180fd2(0x21d)]||this['config'][_0x180fd2(0x297)];if(!_0x42853c)return this['sendTo'](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec['command'],{'success':![],'message':'Kein\x20API\x20Key.'},_0x1b12ec[_0x180fd2(0x2c2)]);try{const _0x43e95e=new GoogleGenerativeAI(_0x42853c),_0x4394e3=_0x43e95e[_0x180fd2(0x1d5)]({'model':GEMINI_MODEL}),_0xdc1188=await _0x4394e3['generateContent']('Hi');this[_0x180fd2(0x287)](_0x1b12ec['from'],_0x1b12ec[_0x180fd2(0x23e)],{'success':!![],'message':_0x180fd2(0x2c6)+_0xdc1188['response'][_0x180fd2(0x15d)]()},_0x1b12ec[_0x180fd2(0x2c2)]);}catch(_0x2f6de2){this[_0x180fd2(0x287)](_0x1b12ec['from'],_0x1b12ec[_0x180fd2(0x23e)],{'success':![],'message':_0x180fd2(0x1a8)+_0x2f6de2[_0x180fd2(0x19e)]},_0x1b12ec[_0x180fd2(0x2c2)]);}}else{if(_0x1b12ec[_0x180fd2(0x23e)]==='testContext'){const _0x5e8e80=await getWeatherContext(this),_0x3f487a=await getCalendarContext(this);this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':!![],'weather':_0x5e8e80,'calendar':_0x3f487a},_0x1b12ec[_0x180fd2(0x2c2)]);}else{if(_0x1b12ec[_0x180fd2(0x23e)]==='getLtmData'){if(!this[_0x180fd2(0x166)])return this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':![],'isPro':![]},_0x1b12ec[_0x180fd2(0x2c2)]);let _0x39e795={'status':_0x180fd2(0x301)};try{const _0x212908=await this[_0x180fd2(0x260)](LTM_DP_DRIFT_STATUS);_0x39e795[_0x180fd2(0x1a9)]=_0x212908?_0x212908[_0x180fd2(0x1a4)]:'N/A';}catch(_0x74c314){}this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x39e795,'analysisHistory':this[_0x180fd2(0x199)]},_0x1b12ec[_0x180fd2(0x2c2)]);}else{if(_0x1b12ec[_0x180fd2(0x23e)]==='getOverviewData'){const _0x32af37=this[_0x180fd2(0x1d2)][_0x180fd2(0x25d)],_0x3e95ad=new Date(),_0x310b39=new Date(_0x3e95ad['getFullYear'](),_0x3e95ad[_0x180fd2(0x178)](),_0x3e95ad['getDate']())[_0x180fd2(0x21a)](),_0x49c6d3=this[_0x180fd2(0x27c)][_0x180fd2(0x2aa)](_0x798962=>new Date(_0x798962['timestamp'])[_0x180fd2(0x21a)]()>_0x310b39)[_0x180fd2(0x25d)],_0x331f7c=new Array(0x18)[_0x180fd2(0x195)](0x0);this[_0x180fd2(0x27c)][_0x180fd2(0x23f)](_0x3fb8be=>{const _0x3ccf24=_0x180fd2,_0x1cf37a=new Date(_0x3fb8be[_0x3ccf24(0x16f)]);if(_0x1cf37a[_0x3ccf24(0x21a)]()>_0x310b39)_0x331f7c[_0x1cf37a[_0x3ccf24(0x1e1)]()]++;});let _0x2d7af6={'status':_0x180fd2(0x301)};try{const _0xe3e5c0=await this[_0x180fd2(0x260)](LTM_DP_DRIFT_STATUS);_0x2d7af6['status']=_0xe3e5c0?_0xe3e5c0[_0x180fd2(0x1a4)]:_0x180fd2(0x301);}catch(_0x3f8007){}let _0x291536='';try{const _0x3b311a=await this[_0x180fd2(0x260)]('system.presenceWho');_0x291536=_0x3b311a?_0x3b311a['val']:'';}catch(_0x5cd93a){}let _0x565a5e=null;!this[_0x180fd2(0x186)]&&(_0x565a5e=this['config']['geminiApiKey']?_0x180fd2(0x234):_0x180fd2(0x1ca));let _0x5d60f2={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x48919a=await this[_0x180fd2(0x260)](_0x180fd2(0x1d3));if(_0x48919a&&_0x48919a['val']){_0x5d60f2[_0x180fd2(0x2f0)]=!![];const _0x3c207e=await this['getStateAsync'](_0x180fd2(0x1e8));_0x5d60f2['description']=_0x3c207e?_0x3c207e[_0x180fd2(0x1a4)]:'';const _0x4f2620=await this['getStateAsync'](_0x180fd2(0x1c6));_0x5d60f2[_0x180fd2(0x17d)]=_0x4f2620?_0x4f2620[_0x180fd2(0x1a4)]:'';const _0xb1957f=await this[_0x180fd2(0x260)]('analysis.automation.targetValue');_0x5d60f2['targetValue']=_0xb1957f?_0xb1957f[_0x180fd2(0x1a4)]:'';}const _0x15264d=await this[_0x180fd2(0x260)](_0x180fd2(0x206));_0x5d60f2[_0x180fd2(0x1a1)]=_0x15264d?!!_0x15264d['val']:![];}catch(_0x48c2a8){}this['sendTo'](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':!![],'eventHistory':this[_0x180fd2(0x249)][_0x180fd2(0x2d7)](0x0,0xf),'stats':{'digestCount':_0x32af37,'eventCountToday':_0x49c6d3,'hourlyActivity':_0x331f7c,'driftStatus':_0x2d7af6['status'],'isPresent':this[_0x180fd2(0x25a)],'presenceWho':_0x291536,'minDays':this[_0x180fd2(0x1e5)][_0x180fd2(0x2e6)]||0x7,'stbDays':this['config']['ltmStbWindowDays']||0xe,'ltbDays':this[_0x180fd2(0x1e5)][_0x180fd2(0x250)]||0x3c,'systemError':_0x565a5e},'automation':_0x5d60f2},_0x1b12ec['callback']);}else{if(_0x1b12ec[_0x180fd2(0x23e)]===_0x180fd2(0x235))try{const _0x5b993e=await scanForDevices(this,_0x1b12ec['message']||{});this['sendTo'](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':!![],'devices':_0x5b993e},_0x1b12ec[_0x180fd2(0x2c2)]);}catch(_0x309ee6){this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':![],'error':_0x309ee6[_0x180fd2(0x19e)]},_0x1b12ec[_0x180fd2(0x2c2)]);}else{if(_0x1b12ec['command']===_0x180fd2(0x245)){const _0x398633=await this[_0x180fd2(0x174)](_0x180fd2(0x242),'enum'),_0x4c8d22=[];if(_0x398633)for(const _0x4e8bf0 in _0x398633){const _0x483ab6=_0x398633[_0x4e8bf0],_0x38713b=(_0x483ab6[_0x180fd2(0x2ef)]&&typeof _0x483ab6['common']['name']==='object'?_0x483ab6[_0x180fd2(0x2ef)][_0x180fd2(0x276)]['de']:_0x483ab6['common'][_0x180fd2(0x276)])||_0x483ab6['common']['name'];_0x4c8d22[_0x180fd2(0x1fa)]({'id':_0x4e8bf0,'name':_0x38713b});}this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':!![],'enums':_0x4c8d22},_0x1b12ec[_0x180fd2(0x2c2)]);}else{if(_0x1b12ec[_0x180fd2(0x23e)]==='getCalendarNames'){const _0x339912=_0x1b12ec[_0x180fd2(0x19e)][_0x180fd2(0x184)];if(!_0x339912)return this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec['command'],{'success':![],'error':'No\x20instance'},_0x1b12ec[_0x180fd2(0x2c2)]);const _0x3ebb1b=await getCalendarNames(this,_0x339912);this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':!![],'names':_0x3ebb1b},_0x1b12ec['callback']);}else{if(_0x1b12ec[_0x180fd2(0x23e)]===_0x180fd2(0x29d)){const {targetId:_0x5600c7,targetValue:_0x16d554}=_0x1b12ec['message'];this[_0x180fd2(0x1e2)][_0x180fd2(0x227)]('üß™\x20Simulating\x20Butler\x20Proposal:\x20'+_0x5600c7+'\x20=\x20'+_0x16d554),await this['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this['setStateAsync']('analysis.automation.description',{'val':_0x180fd2(0x259)+_0x5600c7,'ack':!![]}),await this[_0x180fd2(0x179)](_0x180fd2(0x1c6),{'val':_0x5600c7,'ack':!![]}),await this[_0x180fd2(0x179)]('analysis.automation.targetValue',{'val':_0x16d554,'ack':!![]}),this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec['command'],{'success':!![]},_0x1b12ec[_0x180fd2(0x2c2)]);}else{if(_0x1b12ec[_0x180fd2(0x23e)]===_0x180fd2(0x200)){const {historyId:_0x5c6948,rating:_0x1980fe,comment:_0x2245ca,alertReason:_0x56377c}=_0x1b12ec['message'];_0x5c6948&&_0x1980fe?(await saveFeedback(this,{'timestamp':Date[_0x180fd2(0x2af)](),'historyId':_0x5c6948,'rating':_0x1980fe,'comment':_0x2245ca,'alertReason':_0x56377c}),this[_0x180fd2(0x287)](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':!![]},_0x1b12ec[_0x180fd2(0x2c2)])):this['sendTo'](_0x1b12ec[_0x180fd2(0x2e7)],_0x1b12ec[_0x180fd2(0x23e)],{'success':![],'error':_0x180fd2(0x213)},_0x1b12ec['callback']);}else _0x1b12ec['command']===_0x180fd2(0x17a)&&(this[_0x180fd2(0x1e2)][_0x180fd2(0x227)](_0x180fd2(0x289)),await this[_0x180fd2(0x179)](_0x180fd2(0x1d3),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x180fd2(0x1e8),{'val':'','ack':!![]}),this[_0x180fd2(0x287)](_0x1b12ec['from'],_0x1b12ec['command'],{'success':!![]},_0x1b12ec[_0x180fd2(0x2c2)]));}}}}}}}}}}}if(require[a0_0x89cb30(0x1e9)]!==module)module[a0_0x89cb30(0x191)]=_0x53efd0=>new CogniLiving(_0x53efd0);else new CogniLiving();