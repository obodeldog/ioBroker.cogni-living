const a0_0x28f9ea=a0_0x4f22;(function(_0x88c96b,_0x51f0f0){const _0x4daa12=a0_0x4f22,_0x1a1150=_0x88c96b();while(!![]){try{const _0x1bdc20=-parseInt(_0x4daa12(0x1a0))/0x1+-parseInt(_0x4daa12(0x2f6))/0x2*(parseInt(_0x4daa12(0x1a6))/0x3)+parseInt(_0x4daa12(0x32f))/0x4+parseInt(_0x4daa12(0x2c6))/0x5+parseInt(_0x4daa12(0x23a))/0x6*(parseInt(_0x4daa12(0x1e8))/0x7)+-parseInt(_0x4daa12(0x223))/0x8*(-parseInt(_0x4daa12(0x2f0))/0x9)+-parseInt(_0x4daa12(0x19b))/0xa;if(_0x1bdc20===_0x51f0f0)break;else _0x1a1150['push'](_0x1a1150['shift']());}catch(_0x563bc5){_0x1a1150['push'](_0x1a1150['shift']());}}}(a0_0x4b29,0xf37cf));const a0_0x12af55=(function(){let _0x58402d=!![];return function(_0x1af2d0,_0x4db375){const _0x93ff49=_0x58402d?function(){if(_0x4db375){const _0x4b0478=_0x4db375['apply'](_0x1af2d0,arguments);return _0x4db375=null,_0x4b0478;}}:function(){};return _0x58402d=![],_0x93ff49;};}()),a0_0x26dadf=a0_0x12af55(this,function(){const _0x5ac723=a0_0x4f22;return a0_0x26dadf[_0x5ac723(0x273)]()[_0x5ac723(0x16b)](_0x5ac723(0x221))[_0x5ac723(0x273)]()[_0x5ac723(0x26a)](a0_0x26dadf)['search'](_0x5ac723(0x221));});a0_0x26dadf();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x28f9ea(0x16c)),{spawn,exec,execSync}=require(a0_0x28f9ea(0x171)),path=require(a0_0x28f9ea(0x2d8)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x28f9ea(0x1ad),LTM_SCHEDULE=a0_0x28f9ea(0x2aa),MODE_RESET_SCHEDULE=a0_0x28f9ea(0x1ba),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x28f9ea(0x1d9),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x28f9ea(0x257),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x28f9ea(0x286),LTM_DP_DRIFT_CHANNEL=a0_0x28f9ea(0x2ce),LTM_DP_DRIFT_STATUS=a0_0x28f9ea(0x2fb),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x28f9ea(0x2bb),SYSTEM_DP_MODE=a0_0x28f9ea(0x2a1),SYSTEM_MODES={'NORMAL':a0_0x28f9ea(0x320),'VACATION':'vacation','PARTY':a0_0x28f9ea(0x248),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x28f9ea(0x1bc),'senior_aal':a0_0x28f9ea(0x1ff),'family':a0_0x28f9ea(0x21b),'single_comfort':a0_0x28f9ea(0x301),'security':a0_0x28f9ea(0x2d4)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x28f9ea(0x24e)]===a0_0x28f9ea(0x21c),PERSISTENT_DIR=path[a0_0x28f9ea(0x1b4)](__dirname,a0_0x28f9ea(0x216)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x28f9ea(0x310),a0_0x28f9ea(0x32d)):path[a0_0x28f9ea(0x1b4)](VENV_PATH,a0_0x28f9ea(0x1b7),a0_0x28f9ea(0x2a2)),PIP_EXE=IS_WIN?path['join'](VENV_PATH,'Scripts',a0_0x28f9ea(0x28f)):path[a0_0x28f9ea(0x1b4)](VENV_PATH,a0_0x28f9ea(0x1b7),a0_0x28f9ea(0x18d));let activeSequence=[],sequenceTimer=null;async function startSystem(_0x4d1087){const _0x2f7e74=a0_0x28f9ea;_0x4d1087[_0x2f7e74(0x1c7)]['info'](_0x2f7e74(0x2c9)),await initZombies(_0x4d1087);try{_0x4d1087[_0x2f7e74(0x29b)]=await checkLicense(_0x4d1087[_0x2f7e74(0x27d)][_0x2f7e74(0x2e8)]);}catch(_0x42e7db){}if(!_0x4d1087[_0x2f7e74(0x27d)][_0x2f7e74(0x295)]||_0x4d1087[_0x2f7e74(0x27d)][_0x2f7e74(0x295)]<0.1)_0x4d1087['config'][_0x2f7e74(0x295)]=0xc;await initHistory(_0x4d1087),await initSystemConfig(_0x4d1087);if(_0x4d1087[_0x2f7e74(0x27d)][_0x2f7e74(0x25c)])try{_0x4d1087[_0x2f7e74(0x29f)]=new GoogleGenerativeAI(_0x4d1087[_0x2f7e74(0x27d)][_0x2f7e74(0x25c)]),_0x4d1087[_0x2f7e74(0x1cb)]=_0x4d1087[_0x2f7e74(0x29f)][_0x2f7e74(0x232)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2f7e74(0x1a3)}}),_0x4d1087[_0x2f7e74(0x1c7)]['info'](_0x2f7e74(0x32e));}catch(_0x28ed1c){_0x4d1087[_0x2f7e74(0x1c7)][_0x2f7e74(0x1ea)](_0x2f7e74(0x2a3)+_0x28ed1c['message']);}await createAllObjects(_0x4d1087),await loadSystemMode(_0x4d1087),await loadRawEventLog(_0x4d1087),await loadDailyDigests(_0x4d1087),_0x4d1087['subscribeStates'](_0x2f7e74(0x28e)),_0x4d1087[_0x2f7e74(0x28b)](LTM_DP_TRIGGER_DIGEST),_0x4d1087['subscribeStates'](_0x2f7e74(0x2a1)),_0x4d1087[_0x2f7e74(0x28b)](_0x2f7e74(0x156)),_0x4d1087['subscribeStates'](_0x2f7e74(0x23b)),_0x4d1087[_0x2f7e74(0x28b)](_0x2f7e74(0x264)),_0x4d1087[_0x2f7e74(0x28b)](_0x2f7e74(0x208)),_0x4d1087[_0x2f7e74(0x28b)](_0x2f7e74(0x283)),_0x4d1087[_0x2f7e74(0x28b)]('analysis.training.triggerEnergy'),_0x4d1087[_0x2f7e74(0x28b)]('analysis.training.triggerComfort'),_0x4d1087[_0x2f7e74(0x28b)](_0x2f7e74(0x29c)),await initSensorSubscriptions(_0x4d1087),await initPresenceSubscriptions(_0x4d1087),await setupTelegramListener(_0x4d1087),setTimeout(()=>checkWifiPresence(_0x4d1087),0x1388);if(_0x4d1087[_0x2f7e74(0x15b)])clearInterval(_0x4d1087[_0x2f7e74(0x15b)]);const _0x4ed7bf=_0x4d1087[_0x2f7e74(0x27d)]['analysisInterval']||0xf;_0x4ed7bf>0x0&&(_0x4d1087[_0x2f7e74(0x15b)]=setInterval(()=>{runAutopilot(_0x4d1087);},_0x4ed7bf*0x3c*0x3e8)),setupLtmScheduler(_0x4d1087),setupModeResetScheduler(_0x4d1087),setupDriftAnalysisScheduler(_0x4d1087),setupBriefingScheduler(_0x4d1087),startPythonService(_0x4d1087),setTimeout(()=>{const _0x43c374=_0x2f7e74;_0x4d1087[_0x43c374(0x153)]&&(runPythonHealthCheck(_0x4d1087),triggerGaitAnalysis(_0x4d1087),triggerEnergyPrediction(_0x4d1087)),updateHealthVector(_0x4d1087);},0x1388);}async function runAutopilot(_0x128217){const _0x108ae9=a0_0x28f9ea;_0x128217[_0x108ae9(0x1c7)][_0x108ae9(0x249)](_0x108ae9(0x261)),await runGeminiAnalysis(_0x128217),updateHealthVector(_0x128217),triggerGaitAnalysis(_0x128217),triggerEnergyPrediction(_0x128217);}async function triggerGaitAnalysis(_0x1b70ec){const _0x7bd451=a0_0x28f9ea;if(!_0x1b70ec[_0x7bd451(0x29b)])return;try{const _0x5e4491=await _0x1b70ec[_0x7bd451(0x238)](_0x7bd451(0x1e9));_0x5e4491&&_0x5e4491[_0x7bd451(0x1d3)]&&sendToPython(_0x1b70ec,_0x7bd451(0x331),{'sequences':JSON['parse'](_0x5e4491[_0x7bd451(0x1d3)])});}catch(_0x20bd39){}}async function triggerEnergyPrediction(_0x51948a){const _0x158587=a0_0x28f9ea;if(!_0x51948a[_0x158587(0x29b)])return;try{const _0x567bd9=await getOutsideTemperatureNumeric(_0x51948a);if(_0x567bd9===null)return;const _0x2b3648={},_0x59cf9d=_0x51948a[_0x158587(0x27d)]['devices']||[];for(const _0x579c9f of _0x59cf9d){if(_0x579c9f['type']==='temperature'&&_0x579c9f['location']){const _0x557b65=_0x51948a[_0x158587(0x30f)][_0x579c9f['id']];if(_0x557b65!==undefined)_0x2b3648[_0x579c9f[_0x158587(0x2bd)]]=_0x557b65;}}Object[_0x158587(0x2b3)](_0x2b3648)['length']>0x0&&sendToPython(_0x51948a,_0x158587(0x195),{'current_temps':_0x2b3648,'t_out':_0x567bd9});}catch(_0x3a1098){}}function updateHealthVector(_0x5e77a2){const _0x53d3df=a0_0x28f9ea;if(!_0x5e77a2[_0x53d3df(0x172)]||_0x5e77a2[_0x53d3df(0x172)][_0x53d3df(0x220)]===0x0)return;const _0xfa0238=new Array(0x60)[_0x53d3df(0x211)](0x0),_0x22b0ce=new Date()[_0x53d3df(0x1c8)](0x0,0x0,0x0,0x0);_0x5e77a2[_0x53d3df(0x172)]['forEach'](_0x1768fa=>{const _0x2a53f2=_0x53d3df,_0x4509f0=new Date(_0x1768fa[_0x2a53f2(0x23c)]);if(_0x4509f0[_0x2a53f2(0x181)]()>=_0x22b0ce){const _0x240392=_0x4509f0[_0x2a53f2(0x1f1)](),_0x3cdeaa=_0x4509f0[_0x2a53f2(0x168)](),_0x52c962=_0x240392*0x4+Math[_0x2a53f2(0x1d4)](_0x3cdeaa/0xf);if(_0x52c962>=0x0&&_0x52c962<0x60)_0xfa0238[_0x52c962]++;}}),_0x5e77a2['setStateAsync'](_0x53d3df(0x321),{'val':JSON[_0x53d3df(0x30e)](_0xfa0238),'ack':!![]});}async function scanForDevices(_0x7112bc,_0xf21953){const _0x53c5fa=a0_0x28f9ea;_0x7112bc[_0x53c5fa(0x1c7)][_0x53c5fa(0x1e2)](_0x53c5fa(0x26d));const _0x120251=[],_0x2b472d=await _0x7112bc['getForeignObjectsAsync']('*');let _0x8ce0c9=null,_0x18fef8={};if(_0xf21953[_0x53c5fa(0x1b5)]&&_0xf21953[_0x53c5fa(0x1b5)]['length']>0x0){_0x8ce0c9=new Set(),_0x7112bc[_0x53c5fa(0x1c7)][_0x53c5fa(0x1e2)](_0x53c5fa(0x2f9)+_0xf21953[_0x53c5fa(0x1b5)]['length']+_0x53c5fa(0x2a8));for(const _0xb0a5c4 of _0xf21953[_0x53c5fa(0x1b5)]){const _0x1e46f8=await _0x7112bc['getForeignObjectAsync'](_0xb0a5c4);if(_0x1e46f8&&_0x1e46f8[_0x53c5fa(0x228)]&&_0x1e46f8[_0x53c5fa(0x228)][_0x53c5fa(0x309)]){let _0x1d158d=null;const _0x3a11e6=_0xb0a5c4[_0x53c5fa(0x334)]();if(_0x3a11e6[_0x53c5fa(0x1c1)](_0x53c5fa(0x1f9))||_0x3a11e6[_0x53c5fa(0x1c1)](_0x53c5fa(0x15f)))_0x1d158d=_0x53c5fa(0x1f9);else{if(_0x3a11e6[_0x53c5fa(0x1c1)](_0x53c5fa(0x1e7))||_0x3a11e6[_0x53c5fa(0x1c1)]('heizung'))_0x1d158d='temperature';else{if(_0x3a11e6['includes']('window')||_0x3a11e6[_0x53c5fa(0x1c1)](_0x53c5fa(0x289)))_0x1d158d=_0x53c5fa(0x1f8);}}for(const _0x54f43f of _0x1e46f8['common'][_0x53c5fa(0x309)]){_0x8ce0c9[_0x53c5fa(0x18e)](_0x54f43f);if(_0x1d158d)_0x18fef8[_0x54f43f]=_0x1d158d;}}}}for(const _0x299125 in _0x2b472d){const _0x573e37=_0x2b472d[_0x299125];if(_0x573e37&&_0x573e37['common']&&_0x573e37['type']===_0x53c5fa(0x2b9)){if(_0x8ce0c9){let _0x2121b8=_0x8ce0c9[_0x53c5fa(0x2d6)](_0x299125);if(!_0x2121b8)for(const _0x78aad8 of _0x8ce0c9){if(_0x299125[_0x53c5fa(0x2cf)](_0x78aad8+'.')){_0x2121b8=!![];if(_0x18fef8[_0x78aad8])_0x18fef8[_0x299125]=_0x18fef8[_0x78aad8];break;}}if(!_0x2121b8)continue;}const _0x379747=(_0x573e37[_0x53c5fa(0x228)]['name']&&typeof _0x573e37[_0x53c5fa(0x228)][_0x53c5fa(0x2d0)]===_0x53c5fa(0x2eb)?_0x573e37[_0x53c5fa(0x228)][_0x53c5fa(0x2d0)]['de']:_0x573e37[_0x53c5fa(0x228)][_0x53c5fa(0x2d0)])||'',_0xd88516=(_0x573e37[_0x53c5fa(0x228)][_0x53c5fa(0x2e9)]||'')[_0x53c5fa(0x334)](),_0x43825b=_0x379747[_0x53c5fa(0x334)]();let _0x3db938=_0x18fef8[_0x299125]||null;if(!_0x3db938){if(_0xf21953['motion']&&(_0xd88516['includes'](_0x53c5fa(0x19d))||_0x43825b['includes']('bewegung')||_0xd88516[_0x53c5fa(0x1c1)](_0x53c5fa(0x2a5))))_0x3db938=_0x53c5fa(0x19d);else{if(_0xf21953[_0x53c5fa(0x22b)]&&(_0xd88516[_0x53c5fa(0x1c1)](_0x53c5fa(0x1f8))||_0xd88516[_0x53c5fa(0x1c1)](_0x53c5fa(0x2b4))||_0x43825b[_0x53c5fa(0x1c1)](_0x53c5fa(0x160))||_0x43825b[_0x53c5fa(0x1c1)]('fenster')||_0xd88516[_0x53c5fa(0x1c1)]('contact')))_0x3db938='door';else{if(_0xf21953[_0x53c5fa(0x270)]&&(_0xd88516[_0x53c5fa(0x1c1)]('light')||_0xd88516[_0x53c5fa(0x1c1)](_0x53c5fa(0x1be))||_0x43825b[_0x53c5fa(0x1c1)](_0x53c5fa(0x15f))||_0xd88516['includes']('level.dimmer')))_0x3db938='light';else{if(_0xf21953[_0x53c5fa(0x1d1)]&&(_0xd88516[_0x53c5fa(0x1c1)](_0x53c5fa(0x1d1))||_0x43825b[_0x53c5fa(0x1c1)](_0x53c5fa(0x2da))||_0xd88516[_0x53c5fa(0x1c1)](_0x53c5fa(0x190))))_0x3db938=_0x53c5fa(0x1d1);}}}}if(_0x3db938){let _0x287c71='';const _0x4c1379=_0x299125[_0x53c5fa(0x19a)]('.');if(_0x4c1379[_0x53c5fa(0x220)]>0x2)_0x287c71=_0x4c1379[0x2];_0x120251[_0x53c5fa(0x180)]({'id':_0x299125,'name':_0x379747||_0x299125,'type':_0x3db938,'location':_0x287c71,'_score':_0x8ce0c9?0x5a:0x32});}}}return _0x7112bc[_0x53c5fa(0x1c7)]['info'](_0x53c5fa(0x237)+_0x120251[_0x53c5fa(0x220)]+_0x53c5fa(0x187)),_0x120251;}async function getWeatherContext(_0x18f54d){const _0x246b75=a0_0x28f9ea;if(!_0x18f54d['config']['useWeather']||!_0x18f54d[_0x246b75(0x27d)]['weatherInstance'])return _0x246b75(0x154);try{const _0x48282b=_0x18f54d[_0x246b75(0x27d)][_0x246b75(0x28d)];let _0x20f4d0=await _0x18f54d['getForeignStateAsync'](_0x48282b+'.Current.Temperature');if(!_0x20f4d0)_0x20f4d0=await _0x18f54d['getForeignStateAsync'](_0x48282b+_0x246b75(0x2b1));let _0x18a18e=await _0x18f54d['getForeignStateAsync'](_0x48282b+_0x246b75(0x16a));if(!_0x18a18e)_0x18a18e=await _0x18f54d[_0x246b75(0x191)](_0x48282b+_0x246b75(0x2d2));if(_0x20f4d0&&_0x18a18e)return _0x20f4d0['val']+_0x246b75(0x2d1)+_0x18a18e[_0x246b75(0x1d3)];}catch(_0xa2d320){}return _0x246b75(0x2ed);}async function getCalendarContext(_0x1c1457){const _0x53f0e0=a0_0x28f9ea;if(!_0x1c1457[_0x53f0e0(0x27d)]['useCalendar']||!_0x1c1457['config'][_0x53f0e0(0x1c9)])return'Kalender\x20deaktiviert.';return _0x53f0e0(0x30a);}async function getCalendarNames(_0x279151,_0x4edeee){return[];}async function saveFeedback(_0x4496c5,_0x1e0e18){const _0x2909d6=a0_0x28f9ea;_0x4496c5['log']['info'](_0x2909d6(0x2df)+_0x1e0e18[_0x2909d6(0x278)]);}async function sendMorningBriefing(_0x5b32c1){const _0x448ccc=a0_0x28f9ea;if(!_0x5b32c1['geminiModel'])return;try{const _0x35d51c=_0x448ccc(0x277),_0x39c9cf=await _0x5b32c1[_0x448ccc(0x1cb)][_0x448ccc(0x28a)](_0x35d51c),_0x223a08=_0x39c9cf[_0x448ccc(0x157)][_0x448ccc(0x1d0)]();sendNotification(_0x5b32c1,_0x448ccc(0x194)+_0x223a08);}catch(_0x338694){_0x5b32c1[_0x448ccc(0x1c7)][_0x448ccc(0x1ea)](_0x448ccc(0x241)+_0x338694[_0x448ccc(0x161)]);}}function checkAndInstall(_0x2cfe1b){const _0x5dabf9=a0_0x28f9ea;if(fs[_0x5dabf9(0x25e)](PYTHON_EXE))try{return _0x2cfe1b[_0x5dabf9(0x1c7)][_0x5dabf9(0x1e2)](_0x5dabf9(0x21e)),execSync('\x22'+PYTHON_EXE+_0x5dabf9(0x298),{'timeout':0x3a98}),_0x2cfe1b[_0x5dabf9(0x1c7)][_0x5dabf9(0x1e2)](_0x5dabf9(0x30c)),!![];}catch(_0x238922){_0x2cfe1b['log'][_0x5dabf9(0x20c)](_0x5dabf9(0x1d2));}else _0x2cfe1b[_0x5dabf9(0x1c7)][_0x5dabf9(0x20c)](_0x5dabf9(0x1fe));return installPythonDependencies(_0x2cfe1b),![];}function installPythonDependencies(_0xf90d64){const _0x59e06f=a0_0x28f9ea;if(_0xf90d64['dependencyInstallInProgress'])return;_0xf90d64[_0x59e06f(0x242)]=!![];const _0x2f7a75=path[_0x59e06f(0x1b4)](__dirname,_0x59e06f(0x1f5),_0x59e06f(0x1e1));stopPythonService(_0xf90d64);if(!fs[_0x59e06f(0x25e)](VENV_PATH))try{_0xf90d64[_0x59e06f(0x1c7)][_0x59e06f(0x1e2)](_0x59e06f(0x235)),execSync(_0x59e06f(0x18c)+VENV_PATH+'\x22');}catch(_0x63ee86){_0xf90d64[_0x59e06f(0x1c7)][_0x59e06f(0x1ea)](_0x59e06f(0x31d)+_0x63ee86[_0x59e06f(0x161)]),_0xf90d64['dependencyInstallInProgress']=![];return;}installRequirementsInVenv(_0xf90d64,_0x2f7a75);}function installRequirementsInVenv(_0x4e133f,_0x4e7dab){const _0x3757a3=a0_0x28f9ea;_0x4e133f[_0x3757a3(0x1c7)][_0x3757a3(0x1e2)](_0x3757a3(0x316));const _0x5522a3='\x22'+PIP_EXE+_0x3757a3(0x189)+_0x4e7dab+'\x22';exec(_0x5522a3,{'timeout':0x1b7740},(_0x34e36a,_0xb6bdf,_0x298202)=>{const _0x3f9398=_0x3757a3;_0x4e133f[_0x3f9398(0x242)]=![];if(_0x34e36a){_0x4e133f[_0x3f9398(0x1c7)][_0x3f9398(0x1ea)](_0x3f9398(0x1bd)+(_0x298202||_0x34e36a[_0x3f9398(0x161)]));try{fs[_0x3f9398(0x31f)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x4d5218){}}else _0x4e133f[_0x3f9398(0x1c7)][_0x3f9398(0x1e2)](_0x3f9398(0x252)),startSystem(_0x4e133f);});}async function initZombies(_0x48ca56){const _0x3211b0=a0_0x28f9ea;try{const _0x283cd5=[_0x3211b0(0x2ae),_0x3211b0(0x233)];for(const _0x4f41a9 of _0x283cd5){try{const _0x335f6a=await _0x48ca56[_0x3211b0(0x1bf)](_0x4f41a9);if(_0x335f6a)await _0x48ca56['delObjectAsync'](_0x4f41a9);}catch(_0x4dada8){}}}catch(_0x3890d1){}}async function checkLicense(_0x40e6b6){return!![];}async function initHistory(_0x1a28d5){const _0x25df66=a0_0x28f9ea;try{const _0x5d84e4=await _0x1a28d5[_0x25df66(0x238)](_0x25df66(0x207));_0x5d84e4&&_0x5d84e4[_0x25df66(0x1d3)]&&(_0x1a28d5[_0x25df66(0x230)]=JSON['parse'](_0x5d84e4[_0x25df66(0x1d3)][_0x25df66(0x273)]()));}catch(_0x422953){_0x1a28d5[_0x25df66(0x230)]=[];}try{const _0x8486d4=await _0x1a28d5['getStateAsync'](_0x25df66(0x2fd));if(_0x8486d4&&_0x8486d4[_0x25df66(0x1d3)])_0x1a28d5['analysisHistory']=JSON['parse'](_0x8486d4[_0x25df66(0x1d3)][_0x25df66(0x273)]());}catch(_0x45047a){_0x1a28d5['analysisHistory']=[];}if(_0x1a28d5['eventHistory']&&_0x1a28d5[_0x25df66(0x230)][_0x25df66(0x220)]>0x0){_0x1a28d5[_0x25df66(0x1c7)]['info']('Restoring\x20sensor\x20cache...');for(let _0xa1bce2=_0x1a28d5[_0x25df66(0x230)][_0x25df66(0x220)]-0x1;_0xa1bce2>=0x0;_0xa1bce2--){const _0x69358f=_0x1a28d5[_0x25df66(0x230)][_0xa1bce2];if(_0x69358f&&_0x69358f['id']!==undefined&&_0x69358f[_0x25df66(0x2ff)]!==undefined)_0x1a28d5[_0x25df66(0x30f)][_0x69358f['id']]=_0x69358f['value'];}}}async function initSystemConfig(_0x4e429b){const _0x329431=a0_0x28f9ea;try{const _0x54c2b5=await _0x4e429b[_0x329431(0x218)]('system.config');if(_0x54c2b5&&_0x54c2b5[_0x329431(0x228)])_0x4e429b['systemConfig']={'latitude':_0x54c2b5[_0x329431(0x228)][_0x329431(0x151)]||0x0,'longitude':_0x54c2b5[_0x329431(0x228)][_0x329431(0x274)]||0x0,'city':_0x54c2b5[_0x329431(0x228)][_0x329431(0x2c5)]||''};}catch(_0x536b4b){}}async function createAllObjects(_0x1a9481){const _0x218dab=a0_0x28f9ea;await _0x1a9481[_0x218dab(0x17d)](_0x218dab(0x27b),{'type':_0x218dab(0x260),'common':{'name':'System'},'native':{}}),await _0x1a9481[_0x218dab(0x17d)](SYSTEM_DP_MODE,{'type':'state','common':{'name':'System\x20Mode','type':'string','role':_0x218dab(0x2b9),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x218dab(0x2b8)]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x333),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x323),'type':'string','role':_0x218dab(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x2d9),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x250),'type':_0x218dab(0x1b6),'role':_0x218dab(0x27a),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)]('events.history',{'type':_0x218dab(0x2b9),'common':{'name':'Event\x20History','type':_0x218dab(0x1b6),'role':'json','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x17d)](_0x218dab(0x2ef),{'type':'channel','common':{'name':_0x218dab(0x158)},'native':{}}),await _0x1a9481['setObjectNotExistsAsync'](_0x218dab(0x208),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x2be),'type':_0x218dab(0x2de),'role':_0x218dab(0x217),'read':!![],'write':!![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x283),{'type':'state','common':{'name':'Train\x20Health','type':_0x218dab(0x2de),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x244),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x315),'type':'boolean','role':_0x218dab(0x217),'read':!![],'write':!![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x2f8),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x287),'type':_0x218dab(0x2de),'role':_0x218dab(0x217),'read':!![],'write':!![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x29c),{'type':'state','common':{'name':_0x218dab(0x2f7),'type':_0x218dab(0x2de),'role':_0x218dab(0x217),'read':!![],'write':!![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x27c),{'type':'state','common':{'name':_0x218dab(0x24f),'type':_0x218dab(0x1b6),'role':_0x218dab(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x1a9481['extendObjectAsync']('analysis.security',{'type':_0x218dab(0x260),'common':{'name':_0x218dab(0x267)},'native':{}}),await _0x1a9481[_0x218dab(0x199)]('analysis.security.lastScore',{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x2c7),'type':_0x218dab(0x1db),'role':_0x218dab(0x2ff),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x306),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x222),'type':_0x218dab(0x1db),'role':_0x218dab(0x2ff),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x1a9481['setObjectNotExistsAsync']('analysis.security.lastCheck',{'type':_0x218dab(0x2b9),'common':{'name':'Last\x20Check','type':_0x218dab(0x1b6),'role':_0x218dab(0x26f),'read':!![],'write':![]},'native':{}}),await _0x1a9481['setObjectNotExistsAsync']('analysis.security.topologyMatrix',{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x1d7),'type':_0x218dab(0x1b6),'role':_0x218dab(0x27a),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x17d)](_0x218dab(0x1de),{'type':_0x218dab(0x260),'common':{'name':_0x218dab(0x17b)},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x2db),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x155),'type':'string','role':'date','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x185),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x279),'type':_0x218dab(0x2de),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x1aa),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x32a),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x1a9481['setObjectNotExistsAsync']('analysis.health.trendValue',{'type':'state','common':{'name':_0x218dab(0x319),'type':_0x218dab(0x1db),'role':_0x218dab(0x2ff),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x321),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x2ea),'type':_0x218dab(0x1b6),'role':_0x218dab(0x27a),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x1cc),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x2e7),'type':'number','role':'value','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x17d)](_0x218dab(0x1b2),{'type':_0x218dab(0x260),'common':{'name':_0x218dab(0x164)},'native':{}}),await _0x1a9481['setObjectNotExistsAsync']('analysis.energy.insulationScore',{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x288),'type':'string','role':_0x218dab(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x1a9481['setObjectNotExistsAsync'](_0x218dab(0x2c4),{'type':_0x218dab(0x2b9),'common':{'name':'Heating\x20Score','type':_0x218dab(0x1b6),'role':_0x218dab(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x1df),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x169),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x17d)](_0x218dab(0x15d),{'type':_0x218dab(0x260),'common':{'name':_0x218dab(0x15d)},'native':{}}),await _0x1a9481[_0x218dab(0x17d)](LTM_DP_RAW_LOG,{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x23f),'type':_0x218dab(0x1b6),'role':'json','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x17d)](LTM_DP_DAILY_DIGESTS,{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x22a),'type':_0x218dab(0x1b6),'role':_0x218dab(0x27a),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x1e9),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x31c),'type':_0x218dab(0x1b6),'role':_0x218dab(0x27a),'read':!![],'write':![]},'native':{}}),await _0x1a9481['setObjectNotExistsAsync'](_0x218dab(0x20d),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x31e),'type':_0x218dab(0x1b6),'role':_0x218dab(0x27a),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)]('analysis.trigger',{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x1f6),'type':_0x218dab(0x2de),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x156),{'type':'state','common':{'name':_0x218dab(0x16d),'type':'boolean','role':_0x218dab(0x217),'read':!![],'write':!![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)]('analysis.isAlert',{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x31a),'type':_0x218dab(0x2de),'role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x210),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x22c),'type':_0x218dab(0x1b6),'role':_0x218dab(0x240),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x26c),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x311),'type':_0x218dab(0x1b6),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x25f),{'type':'state','common':{'name':_0x218dab(0x2cd),'type':_0x218dab(0x2de),'role':_0x218dab(0x293),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x1c5),{'type':_0x218dab(0x2b9),'common':{'name':'Description','type':_0x218dab(0x1b6),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x193),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x176),'type':'string','role':_0x218dab(0x27a),'read':!![],'write':![]},'native':{}}),await _0x1a9481['setObjectNotExistsAsync']('analysis.automation.targetId',{'type':'state','common':{'name':_0x218dab(0x231),'type':_0x218dab(0x1b6),'role':_0x218dab(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)](_0x218dab(0x2b0),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x24a),'type':'string','role':_0x218dab(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x1a9481[_0x218dab(0x199)]('analysis.automation.autoApply',{'type':'state','common':{'name':'Auto\x20Apply','type':_0x218dab(0x2de),'role':_0x218dab(0x1be),'read':!![],'write':!![]},'native':{}}),await _0x1a9481['setObjectNotExistsAsync'](_0x218dab(0x23b),{'type':_0x218dab(0x2b9),'common':{'name':_0x218dab(0x1d5),'type':_0x218dab(0x2de),'role':_0x218dab(0x217),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x2c74b2){const _0x2565af=a0_0x28f9ea;try{const _0x21bbe0=await _0x2c74b2[_0x2565af(0x238)](SYSTEM_DP_MODE);_0x21bbe0&&_0x21bbe0[_0x2565af(0x1d3)]&&Object[_0x2565af(0x2cc)](SYSTEM_MODES)[_0x2565af(0x1c1)](_0x21bbe0[_0x2565af(0x1d3)])?_0x2c74b2[_0x2565af(0x1a2)]=_0x21bbe0[_0x2565af(0x1d3)]:(_0x2c74b2[_0x2565af(0x1a2)]=SYSTEM_MODES[_0x2565af(0x2b8)],await _0x2c74b2[_0x2565af(0x1ca)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x283af1){_0x2c74b2['currentSystemMode']=SYSTEM_MODES[_0x2565af(0x2b8)];}}async function loadRawEventLog(_0x2faf48){const _0x565b19=a0_0x28f9ea;try{const _0x1a3605=await _0x2faf48[_0x565b19(0x238)](LTM_DP_RAW_LOG);if(_0x1a3605&&_0x1a3605[_0x565b19(0x1d3)])_0x2faf48[_0x565b19(0x172)]=JSON[_0x565b19(0x281)](_0x1a3605['val']);}catch(_0x5a1729){_0x2faf48[_0x565b19(0x172)]=[];}}async function saveRawEventLog(_0x5d20ba){const _0x1450c0=a0_0x28f9ea;if(_0x5d20ba[_0x1450c0(0x172)][_0x1450c0(0x220)]>RAW_LOG_MAX_SIZE)_0x5d20ba[_0x1450c0(0x172)][_0x1450c0(0x32b)](0x0,_0x5d20ba[_0x1450c0(0x172)]['length']-RAW_LOG_MAX_SIZE);await _0x5d20ba[_0x1450c0(0x1ca)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x5d20ba[_0x1450c0(0x172)]),'ack':!![]});}function a0_0x4b29(){const _0x2112fc=['âš ï¸\x20SECURITY\x20ALARM:\x20','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','parse','Activity-Level','analysis.training.triggerHealth','No\x20instance','COGNI_REQUEST_CALL','LTM.baselineStatus','Train\x20Comfort','Insulation\x20Score','fenster','generateContent','subscribeStates','BUTLER\x20Execution\x20Error:\x20','weatherInstance','analysis.trigger','pip.exe','onUnload','lampe','unshift','indicator','reason','inactivityThresholdHours','outdoorSensorId','modeResetJob','\x22\x20-c\x20\x22import\x20tensorflow;\x20import\x20pandas;\x20import\x20numpy;\x20print(\x27libs_ok\x27)\x22','loc','onStateChange','isProVersion','analysis.training.triggerTopology','getForeignObjectsAsync','analysis.security.lastCheck','genAI','main','system.mode','python','Gemini\x20Init\x20Error:\x20','LTM\x20Sched\x20Error:\x20','presence','COMFORT_RESULT','Started...','\x20Enums...','systemUUID','0\x203\x20*\x20*\x20*','Keine\x20Details.','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','Skipped\x20(No\x20AI\x20or\x20Data)','analysis.history_debug_00','notifyTelegramEnabled','analysis.automation.targetValue','.forecast.current.temperature','N/A\x20(Learning)','keys','window','retry','isAlert','bind','NORMAL','state','notifyTelegramRecipient','LTM.driftAnalysis.lastCheck','ltmLtbWindowDays','location','Train\x20Security','analysis.security.topologyMatrix','ANALYZE_HEALTH','map','sendToAsync','occupancy','analysis.energy.heatingScore','city','8669895AKGKhb','Anomaly\x20Score','command','ðŸš€\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.1)...','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','summary','values','Pattern\x20Detected','LTM.driftAnalysis','startsWith','name','Â°C,\x20','.forecast.current.state','systemConfig','PRIORITÃ„T:\x20Sicherheit.','SECURITY_RESULT','has','expire','path','events.lastEvent','temperatur','analysis.health.lastCheck','payload','N/A','boolean','ðŸ“\x20Feedback\x20received:\x20','prÃ¤senz','communicate.request','automation.triggerAction','siren','\x20->\x20','ltmDriftCheckIntervalHours','getCalendarNames','Gait\x20Speed\x20Trend','licenseKey','role','Today\x20Vector\x20(15m)','object','lastAlertState','Keine\x20Wetterdaten\x20verfÃ¼gbar.',')\x20-\x20SAFE\x20BOOT','analysis.training','16299HJFqku','ltmStbWindowDays','TRAIN_ENERGY','Reset\x20Sched\x20Error:\x20','WiFi\x20Presence\x20detected.','baselineDrift','100zRjIir','Build\x20Topology','analysis.training.triggerComfort','ðŸ”\x20Filtering\x20by\x20','subscribeForeignStatesAsync','LTM.driftAnalysis.baselineDrift','substring','analysis.analysisHistory','notifyEmailEnabled','value','heizung','Fokus\x20auf\x20Komfort.','notifyPushoverRecipient','COGNI_CONFIRM_OK','alertReason','ANALYZE_SEQUENCE','analysis.security.currentThreshold','writable','TREND_RESULT','members','Keine\x20Termine.','toFixed','âœ…\x20Fast-Boot:\x20Environment\x20healthy.\x20Skipping\x20installation.','filter','stringify','sensorLastValues','Scripts','Activity\x20Summary','dimmer','\x0aSTB:\x20','scheduleJob','Train\x20Energy','Installing\x20pip\x20packages...\x20(Caching\x20enabled)','\x20*\x20*\x20*','from','Trend\x20Value','Alert\x20Status','ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','Sequences','âŒ\x20VENV\x20CREATION\x20FAILED:\x20','Thermodynamics','rmSync','normal','analysis.health.todayVector','onMessage','Who\x20is\x20present?','Unknown','python3','Topology\x20Error:\x20','analysis.isAlert','change_percent','.NextHours.Location_1.Day_1.current.temp_value','Trend','splice','activityLevel','python.exe','Gemini\x20AI\x20initialized.','4404016CLpnon','HEALTH_TRAIN_RESULT','ANALYZE_GAIT','analysis.security.lastScore','system.presenceWho','toLowerCase','latitude','automationProposal','pythonProcess','Wetterdaten\x20deaktiviert.','Last\x20Check','analysis.triggerBriefing','response','AI\x20Training','stdout','triggerBriefing','analysisTimer','Err:\x20','LTM','sendTo','licht','tÃ¼r','message','simulateButler','analysisHistory','Energy\x20Intelligence','endsWith','targetValue','Training\x20Error:\x20','getMinutes','Temperature\x20Forecast','.Current.WeatherText','search','node-schedule','Trigger\x20Briefing','onReady','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','\x20new\x20patterns.','child_process','rawEventLog','Adapter','setForeignStateAsync','Success:\x20','Detected\x20Patterns','ENERGY_PREDICT_RESULT','Success','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','write','Health\x20Analysis','targetId','extendObjectAsync','minDaysForBaseline','send','push','getTime','exports','enum.functions.*','autoApply','analysis.health.isAnomaly','briefingJob','\x20candidates.','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','\x22\x20install\x20-r\x20\x22','some','isPresent','python3\x20-m\x20venv\x20\x22','pip','add','ðŸš¨\x20EMERGENCY','thermostat','getForeignStateAsync','GAIT_RESULT','analysis.automation.detectedPatterns','ðŸŒ…\x20Morning\x20Briefing:\x0a','PREDICT_ENERGY','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','\x20Tage)','analysis.automation.targetId','setObjectNotExistsAsync','split','19325640jJFSSV','testApiKey','motion','stateChange','submitFeedback','770318MciWdo','getLtmData','currentSystemMode','application/json','unload','dailyDigests','39243embogL','kontakt','enum','cogni-living','analysis.health.trendDiagnosis','insulation','data','models/gemini-flash-latest','online','08:00','ANALYZE_TREND','daswetter','analysis.energy','notifyPushoverEnabled','join','selectedFunctionIds','string','bin','HEALTH_RESULT','ðŸ\x20Python\x20Pong','0\x204\x20*\x20*\x20*','Cogni-Living','Analysiere\x20ausgewogen.','âŒ\x20INSTALL\x20FAILED:\x20','switch','getObjectAsync','\x20=\x20','includes','openweathermap','âœ…\x20Alles\x20OK\x20(Reset)','Regel\x20erkannt:\x20','analysis.automation.description','TOPOLOGY_RESULT','log','setHours','calendarInstance','setStateAsync','geminiModel','analysis.health.gaitSpeed','.\x20EMERGENCY:\x20','schalter','rule','text','temperature','âš ï¸\x20Fast-Boot\x20failed.\x20Starting\x20repair/install...','val','floor','Trigger\x20Action','briefingTime','Topology\x20Matrix','presenceDevices','LTM.rawEventLog','confidence','number','\x0aGrund:\x20','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','analysis.health','analysis.energy.forecast','driftAnalysisTimer','requirements.txt','info','setState','replace','notifyEmailInstance','.Current.Temperature','heating','9527AVgRaz','LTM.trainingData.sequences','error','Unbekannt','[RECORDER]\x20Error:\x20','version','ENERGY_TRAIN_RESULT','slice','ðŸ•¸ï¸\x20Topology\x20Map\x20updated.','getHours','exitGraceTimer','shift','success','python_service','Trigger\x20Analysis','ack','door','light','.\x20WETTER:\x20','weatherunderground','logDuplicates','toISOString','âš ï¸\x20Python\x20VENV\x20missing.\x20Installing\x20locally...','PRIORITÃ„T:\x20Gesundheit/AAL.','Deaktiviert\x20(Pro-Feature)','testContext','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Alarm','now','ðŸ§ \x20Triggering\x20Security\x20Training...','threshold','events.history','analysis.training.triggerSecurity','ltmJob','service.py','.\x20ANWESEND:\x20','warn','LTM.trainingData.thermodynamics','trim','is_anomaly','analysis.alertReason','fill','Aktiv\x20(','getOverviewData','isGracePeriodActive','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.venv','button','getForeignObjectAsync','cogni-living\x20adapter\x20starting\x20(v','callback','Fokus\x20auf\x20Familienroutinen.','win32','briefingEnabled','ðŸ\x20Checking\x20Python\x20environment...','telegram','length','(((.+)+)+)+$','Current\x20Threshold','6056CMExIY','ðŸ•¸ï¸\x20Building\x20Topology\x20Matrix...','TRAINING_COMPLETE','description','diagnosis','common','getEnums','Daily\x20Digests','doors','Alert\x20Reason','details','Sec-Training\x20started...','getFullYear','eventHistory','Target\x20ID','getGenerativeModel','events.history_debug_00','generic','Creating\x20new\x20VENV...','getDate','ðŸ”\x20Scan\x20finished.\x20Found\x20','getStateAsync','scanDevices','654vvWISE','analysis.automation.triggerAction','timestamp','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','.\x20SYSTEM_MODE:\x20','Raw\x20Log','text.alarm','Briefing\x20Error:\x20','dependencyInstallInProgress','notifyTelegramInstance','analysis.training.triggerEnergy','cancel','PONG','round','party','debug','Target\x20Value','devices','accuweather','status','platform','Training\x20Status','Last\x20raw\x20event','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','âœ…\x20INSTALL\x20SUCCESS.','detected','Digest','Briefing\x20Sched\x20Error:\x20','Error\x20launching\x20Python:\x20','LTM.processingStatus','pop','Missing\x20data','Lernphase\x20(','namespace','geminiApiKey','VACATION','existsSync','analysis.automation.patternDetected','channel','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','toLocaleTimeString','BUILD_TOPOLOGY','analysis.automation.autoApply','stdin','system.isPresent','Security\x20Monitor','analysis.health.trendValue','TRAIN_HEALTH','constructor','type','analysis.activitySummary','ðŸ”\x20Scanning\x20for\x20devices...','[PYTHON]\x20','date','lights','indexOf','Drift\x20Sched\x20Error:\x20','toString','longitude','exitTimer','find','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','rating','Anomaly\x20Detected','json','system','analysis.training.status','config'];a0_0x4b29=function(){return _0x2112fc;};return a0_0x4b29();}async function loadDailyDigests(_0x1a7e69){const _0x4f5a54=a0_0x28f9ea;try{const _0x5724da=await _0x1a7e69[_0x4f5a54(0x238)](LTM_DP_DAILY_DIGESTS);if(_0x5724da&&_0x5724da[_0x4f5a54(0x1d3)])_0x1a7e69[_0x4f5a54(0x1a5)]=JSON['parse'](_0x5724da[_0x4f5a54(0x1d3)]);}catch(_0x1fbfb7){_0x1a7e69[_0x4f5a54(0x1a5)]=[];}await updateBaselineStatus(_0x1a7e69);}async function saveDailyDigests(_0x2c30e0,_0xd01bbd=!![]){const _0x2b354c=a0_0x28f9ea,_0x175d16=_0x2c30e0[_0x2b354c(0x27d)][_0x2b354c(0x2bc)]||0x3c;_0x2c30e0[_0x2b354c(0x1a5)][_0x2b354c(0x220)]>_0x175d16&&_0x2c30e0[_0x2b354c(0x1a5)][_0x2b354c(0x32b)](0x0,_0x2c30e0[_0x2b354c(0x1a5)][_0x2b354c(0x220)]-_0x175d16);await _0x2c30e0['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2b354c(0x30e)](_0x2c30e0[_0x2b354c(0x1a5)]),'ack':!![]});if(_0xd01bbd)await updateBaselineStatus(_0x2c30e0);}async function updateAnalysisHistory(_0x5accca,_0x5dedc9){const _0x5a4b05=a0_0x28f9ea;_0x5accca[_0x5a4b05(0x163)][_0x5a4b05(0x292)](_0x5dedc9);if(_0x5accca[_0x5a4b05(0x163)][_0x5a4b05(0x220)]>HISTORY_MAX_SIZE)_0x5accca[_0x5a4b05(0x163)][_0x5a4b05(0x258)]();await _0x5accca['setStateAsync'](_0x5a4b05(0x2fd),{'val':JSON[_0x5a4b05(0x30e)](_0x5accca['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x27f7fe){const _0x408597=a0_0x28f9ea;if(!_0x27f7fe[_0x408597(0x29b)]){await _0x27f7fe[_0x408597(0x1ca)](LTM_DP_BASELINE_STATUS,{'val':_0x408597(0x200),'ack':!![]});return;}const _0x552229=_0x27f7fe[_0x408597(0x1a5)]['length']>=(_0x27f7fe['config'][_0x408597(0x17e)]||0x7)?_0x408597(0x212)+_0x27f7fe[_0x408597(0x1a5)][_0x408597(0x220)]+_0x408597(0x197):_0x408597(0x25a)+_0x27f7fe['dailyDigests'][_0x408597(0x220)]+'/'+(_0x27f7fe[_0x408597(0x27d)]['minDaysForBaseline']||0x7)+')';await _0x27f7fe['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x552229,'ack':!![]});}async function initSensorSubscriptions(_0x59d662){const _0xae663b=a0_0x28f9ea,_0x2fd1cb=_0x59d662['config'][_0xae663b(0x24b)];if(_0x2fd1cb)for(const _0x376481 of _0x2fd1cb){await _0x59d662[_0xae663b(0x2fa)](_0x376481['id']);}}function a0_0x4f22(_0x520f88,_0x462a68){const _0x2657b8=a0_0x4b29();return a0_0x4f22=function(_0x26dadf,_0x12af55){_0x26dadf=_0x26dadf-0x151;let _0x4b2946=_0x2657b8[_0x26dadf];return _0x4b2946;},a0_0x4f22(_0x520f88,_0x462a68);}async function initPresenceSubscriptions(_0x4981d2){const _0x573b78=a0_0x28f9ea,_0x1bdf17=_0x4981d2[_0x573b78(0x27d)][_0x573b78(0x1d8)];if(_0x1bdf17)for(const _0xa4b0f4 of _0x1bdf17){await _0x4981d2[_0x573b78(0x2fa)](_0xa4b0f4);}}async function setupTelegramListener(_0x5bb36a){const _0x533751=a0_0x28f9ea,_0x237722=_0x5bb36a[_0x533751(0x27d)][_0x533751(0x243)];if(_0x5bb36a[_0x533751(0x27d)][_0x533751(0x2af)]&&_0x237722)await _0x5bb36a['subscribeForeignStatesAsync'](_0x237722+'.communicate.request');}async function checkWifiPresence(_0x179b71){const _0x345267=a0_0x28f9ea;try{const _0x226fea=_0x179b71['config'][_0x345267(0x1d8)]||[];let _0xb36162=![];const _0x3ebbf1=[];for(const _0x3a6edb of _0x226fea){try{const _0x1f3cf3=await _0x179b71[_0x345267(0x191)](_0x3a6edb);_0x1f3cf3&&(_0x1f3cf3[_0x345267(0x1d3)]===!![]||_0x1f3cf3[_0x345267(0x1d3)]===_0x345267(0x1ae)||_0x1f3cf3['val']===0x1)&&(_0xb36162=!![],_0x3ebbf1[_0x345267(0x180)](_0x3a6edb));}catch(_0x16f6d1){}}return await _0x179b71[_0x345267(0x1ca)](_0x345267(0x333),{'val':_0x3ebbf1[_0x345267(0x1b4)](',\x20'),'ack':!![]}),_0xb36162&&(_0x179b71[_0x345267(0x275)]&&(_0x179b71[_0x345267(0x1c7)][_0x345267(0x1e2)](_0x345267(0x2f4)),abortExitTimer(_0x179b71)),!_0x179b71[_0x345267(0x18b)]&&_0x179b71['currentSystemMode']===SYSTEM_MODES[_0x345267(0x2b8)]&&await setPresence(_0x179b71,!![])),_0xb36162;}catch(_0xe4690b){return![];}}function startExitTimer(_0x46a851){const _0x1a4cc7=a0_0x28f9ea;abortExitTimer(_0x46a851),_0x46a851[_0x1a4cc7(0x214)]=!![],_0x46a851[_0x1a4cc7(0x1f2)]=setTimeout(()=>{const _0x32f50f=_0x1a4cc7;_0x46a851[_0x32f50f(0x214)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x46a851[_0x1a4cc7(0x275)]=setTimeout(()=>{const _0x1b5488=_0x1a4cc7;setPresence(_0x46a851,![]),_0x46a851[_0x1b5488(0x275)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x5642d7){const _0x58b8cc=a0_0x28f9ea;if(_0x5642d7[_0x58b8cc(0x275)])clearTimeout(_0x5642d7['exitTimer']);if(_0x5642d7[_0x58b8cc(0x1f2)])clearTimeout(_0x5642d7['exitGraceTimer']);_0x5642d7['exitTimer']=null,_0x5642d7[_0x58b8cc(0x1f2)]=null,_0x5642d7['isGracePeriodActive']=![];}async function setPresence(_0x1c6800,_0x289bd0){const _0x4f3fb2=a0_0x28f9ea;if(_0x1c6800[_0x4f3fb2(0x18b)]===_0x289bd0)return;_0x1c6800[_0x4f3fb2(0x18b)]=_0x289bd0,await _0x1c6800[_0x4f3fb2(0x1ca)](_0x4f3fb2(0x266),{'val':_0x289bd0,'ack':!![]});}async function executeAutomationAction(_0x32d3bd){const _0x8720a7=a0_0x28f9ea;try{const _0x518ff1=await _0x32d3bd[_0x8720a7(0x238)](_0x8720a7(0x198)),_0x35cff4=await _0x32d3bd[_0x8720a7(0x238)](_0x8720a7(0x2b0));if(_0x518ff1&&_0x518ff1[_0x8720a7(0x1d3)]&&_0x35cff4){const _0x1999a8=_0x518ff1[_0x8720a7(0x1d3)];let _0x18909e=_0x35cff4['val'];try{_0x18909e=JSON[_0x8720a7(0x281)](_0x18909e);}catch(_0x1c291c){}_0x32d3bd['log'][_0x8720a7(0x1e2)](_0x8720a7(0x179)+_0x1999a8+'\x20=\x20'+_0x18909e),await _0x32d3bd[_0x8720a7(0x174)](_0x1999a8,_0x18909e);}else _0x32d3bd['log'][_0x8720a7(0x20c)](_0x8720a7(0x202));}catch(_0x5913aa){_0x32d3bd[_0x8720a7(0x1c7)][_0x8720a7(0x1ea)](_0x8720a7(0x28c)+_0x5913aa[_0x8720a7(0x161)]);}}async function processSensorEvent(_0x1ad28d,_0x5865f4,_0x3c381a,_0x424c5c){const _0x39cbb3=a0_0x28f9ea;if(!_0x424c5c)return;const _0x8a423=_0x3c381a['val'],_0x141f1d=Date[_0x39cbb3(0x204)](),_0x186329=_0x1ad28d[_0x39cbb3(0x30f)][_0x5865f4];_0x1ad28d['sensorLastValues'][_0x5865f4]=_0x8a423;if(!_0x424c5c[_0x39cbb3(0x1fc)]&&_0x186329!=undefined&&_0x186329==_0x8a423)return;const _0x45b38a=(_0x424c5c[_0x39cbb3(0x26b)]||'')['toLowerCase'](),_0x1a4976=_0x45b38a[_0x39cbb3(0x1c1)](_0x39cbb3(0x1d1))||_0x45b38a[_0x39cbb3(0x1c1)]('temperatur')||_0x45b38a[_0x39cbb3(0x1c1)]('klima')||_0x45b38a['includes'](_0x39cbb3(0x300));_0x1ad28d[_0x39cbb3(0x29b)]&&_0x1a4976&&recordThermodynamics(_0x1ad28d,_0x5865f4,_0x8a423,_0x424c5c[_0x39cbb3(0x2bd)]);const _0x50e1c3={'timestamp':_0x141f1d,'id':_0x5865f4,'name':_0x424c5c[_0x39cbb3(0x2d0)],'type':_0x424c5c[_0x39cbb3(0x26b)],'location':_0x424c5c[_0x39cbb3(0x2bd)],'value':_0x8a423};_0x1ad28d[_0x39cbb3(0x230)][_0x39cbb3(0x292)](_0x50e1c3);if(_0x1ad28d[_0x39cbb3(0x230)][_0x39cbb3(0x220)]>HISTORY_MAX_SIZE)_0x1ad28d['eventHistory'][_0x39cbb3(0x258)]();await _0x1ad28d[_0x39cbb3(0x1ca)]('events.lastEvent',{'val':JSON[_0x39cbb3(0x30e)](_0x50e1c3),'ack':!![]}),await _0x1ad28d[_0x39cbb3(0x1ca)](_0x39cbb3(0x207),{'val':JSON[_0x39cbb3(0x30e)](_0x1ad28d[_0x39cbb3(0x230)]),'ack':!![]});_0x1ad28d[_0x39cbb3(0x29b)]&&(_0x1ad28d['rawEventLog']['push'](_0x50e1c3),await saveRawEventLog(_0x1ad28d),recordSequence(_0x1ad28d,_0x50e1c3));if(_0x424c5c['isExit']&&_0x8a423===!![]){if(_0x1ad28d['isPresent']&&!_0x1ad28d[_0x39cbb3(0x214)])startExitTimer(_0x1ad28d);else{if(!_0x1ad28d[_0x39cbb3(0x18b)])setPresence(_0x1ad28d,!![]);}}else{if(_0x424c5c[_0x39cbb3(0x26b)]==='motion'&&_0x8a423===!![]){if(_0x1ad28d[_0x39cbb3(0x275)])abortExitTimer(_0x1ad28d);if(!_0x1ad28d[_0x39cbb3(0x18b)]&&_0x1ad28d[_0x39cbb3(0x1a2)]===SYSTEM_MODES[_0x39cbb3(0x2b8)])setPresence(_0x1ad28d,!![]);}}}async function recordThermodynamics(_0x4a52a0,_0x301f53,_0x8db714,_0x1d5e23){const _0x3d6b23=a0_0x28f9ea,_0x102226=await getOutsideTemperatureNumeric(_0x4a52a0),_0x5cbbe0=await _0x4a52a0[_0x3d6b23(0x238)](_0x3d6b23(0x20d));let _0x31a7ce=[];if(_0x5cbbe0&&_0x5cbbe0['val'])try{_0x31a7ce=JSON[_0x3d6b23(0x281)](_0x5cbbe0[_0x3d6b23(0x1d3)]);}catch(_0xdc684d){}_0x31a7ce['push']({'ts':Date['now'](),'room':_0x1d5e23||_0x3d6b23(0x324),'t_in':_0x8db714,'t_out':_0x102226});if(_0x31a7ce[_0x3d6b23(0x220)]>THERMO_LOG_SIZE)_0x31a7ce[_0x3d6b23(0x1f3)]();await _0x4a52a0[_0x3d6b23(0x1ca)](_0x3d6b23(0x20d),{'val':JSON['stringify'](_0x31a7ce),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x2be148){const _0x2602ba=a0_0x28f9ea;if(_0x2be148[_0x2602ba(0x27d)][_0x2602ba(0x296)])try{const _0x1b1c7f=await _0x2be148[_0x2602ba(0x191)](_0x2be148[_0x2602ba(0x27d)][_0x2602ba(0x296)]);if(_0x1b1c7f&&_0x1b1c7f['val']!==undefined&&_0x1b1c7f['val']!==null)return parseFloat(_0x1b1c7f[_0x2602ba(0x1d3)]);}catch(_0x4b4d72){}const _0x14937e=_0x2be148[_0x2602ba(0x27d)]['weatherInstance'];if(!_0x2be148['config']['useWeather']||!_0x14937e)return null;try{let _0x44a258='';if(_0x14937e[_0x2602ba(0x1c1)](_0x2602ba(0x24c)))_0x44a258=_0x14937e+_0x2602ba(0x1e6);else{if(_0x14937e['includes'](_0x2602ba(0x1b1)))_0x44a258=_0x14937e+_0x2602ba(0x329);else{if(_0x14937e['includes'](_0x2602ba(0x1c2)))_0x44a258=_0x14937e+'.forecast.current.temperature';else{if(_0x14937e[_0x2602ba(0x1c1)](_0x2602ba(0x1fb)))_0x44a258=_0x14937e+'.forecast.current.temp';}}}if(_0x44a258){const _0x66cd9d=await _0x2be148['getForeignStateAsync'](_0x44a258);if(_0x66cd9d&&_0x66cd9d[_0x2602ba(0x1d3)]!==undefined&&_0x66cd9d['val']!==null)return parseFloat(_0x66cd9d[_0x2602ba(0x1d3)]);}}catch(_0x39a009){}return null;}async function recordSequence(_0x24e78a,_0xa7e4a2){const _0x2672fb=a0_0x28f9ea,_0x20525d=(_0xa7e4a2['type']||'')[_0x2672fb(0x334)](),_0x309c1d=['motion','bewegung',_0x2672fb(0x2e0),_0x2672fb(0x2a5),_0x2672fb(0x2c3),_0x2672fb(0x1f8),_0x2672fb(0x160),_0x2672fb(0x2b4),_0x2672fb(0x289),'contact',_0x2672fb(0x1a7),_0x2672fb(0x1f9),_0x2672fb(0x15f),'switch',_0x2672fb(0x1ce),_0x2672fb(0x312),_0x2672fb(0x291)];if(!_0x309c1d[_0x2672fb(0x18a)](_0x3f69ec=>_0x20525d['includes'](_0x3f69ec)))return;if(!_0xa7e4a2[_0x2672fb(0x2ff)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0xa7e4a2[_0x2672fb(0x2bd)]||_0x2672fb(0x324),'id':_0xa7e4a2['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{const _0x1ff57e=_0x2672fb;if(activeSequence[_0x1ff57e(0x220)]>0x1)await saveCompletedSequence(_0x24e78a);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x4dfd38){const _0x5dfaf5=a0_0x28f9ea;try{const _0xacf1ac=await _0x4dfd38[_0x5dfaf5(0x238)](_0x5dfaf5(0x1e9));let _0x5d43f5=[];if(_0xacf1ac&&_0xacf1ac[_0x5dfaf5(0x1d3)])try{_0x5d43f5=JSON[_0x5dfaf5(0x281)](_0xacf1ac[_0x5dfaf5(0x1d3)]);}catch(_0x100e38){}const _0x2d5794=activeSequence[0x0]['ts'],_0x4fdb5c=activeSequence[_0x5dfaf5(0x2c1)](_0x353d69=>({'loc':_0x353d69[_0x5dfaf5(0x299)],'t_delta':Math[_0x5dfaf5(0x247)]((_0x353d69['ts']-_0x2d5794)/0x3e8)})),_0x257219={'timestamp':new Date(_0x2d5794)[_0x5dfaf5(0x1fd)](),'steps':_0x4fdb5c,'duration':Math[_0x5dfaf5(0x247)]((activeSequence[activeSequence[_0x5dfaf5(0x220)]-0x1]['ts']-_0x2d5794)/0x3e8),'daytime':new Date(_0x2d5794)[_0x5dfaf5(0x1f1)]()};_0x5d43f5['push'](_0x257219);if(_0x5d43f5[_0x5dfaf5(0x220)]>MAX_TRAINING_SET_SIZE)_0x5d43f5['shift']();await _0x4dfd38[_0x5dfaf5(0x1ca)](_0x5dfaf5(0x1e9),{'val':JSON[_0x5dfaf5(0x30e)](_0x5d43f5),'ack':!![]}),runSecurityCheck(_0x4dfd38,_0x257219);}catch(_0x961076){_0x4dfd38[_0x5dfaf5(0x1c7)][_0x5dfaf5(0x1ea)](_0x5dfaf5(0x1ec)+_0x961076['message']);}}function runSecurityCheck(_0x433a58,_0x1cfb62){const _0xfb8d12=a0_0x28f9ea;if(!_0x433a58[_0xfb8d12(0x29b)])return;sendToPython(_0x433a58,_0xfb8d12(0x305),{'sequence':_0x1cfb62});}function sendToPython(_0x3795b0,_0x2e5f62,_0x5765cb={}){const _0x7bd15b=a0_0x28f9ea;if(!_0x3795b0['pythonProcess']||!_0x3795b0['pythonProcess']['stdin'][_0x7bd15b(0x307)])return;const _0x45ab3d=JSON[_0x7bd15b(0x30e)]({'command':_0x2e5f62,..._0x5765cb});try{_0x3795b0[_0x7bd15b(0x153)][_0x7bd15b(0x265)][_0x7bd15b(0x17a)](_0x45ab3d+'\x0a');}catch(_0x5c1837){}}function startPythonService(_0x3b4b88){const _0x503912=a0_0x28f9ea;let _0x18b677=_0x503912(0x325);if(fs[_0x503912(0x25e)](PYTHON_EXE))_0x18b677=PYTHON_EXE;try{const _0x5f4e5d=path[_0x503912(0x1b4)](__dirname,_0x503912(0x1f5),_0x503912(0x20a));_0x3b4b88[_0x503912(0x153)]=spawn(_0x18b677,[_0x5f4e5d]),_0x3b4b88[_0x503912(0x153)][_0x503912(0x159)]['on'](_0x503912(0x1ac),_0x487122=>{const _0x384fe6=_0x503912,_0x1d5e38=_0x487122[_0x384fe6(0x273)]()['split']('\x0a');_0x1d5e38['forEach'](_0x14ee68=>{const _0x20130b=_0x384fe6,_0x1326f9=_0x14ee68[_0x20130b(0x20e)]();if(!_0x1326f9)return;if(_0x1326f9[_0x20130b(0x2cf)]('[LOG]'))_0x3b4b88[_0x20130b(0x1c7)]['debug'](_0x20130b(0x26e)+_0x1326f9[_0x20130b(0x2fc)](0x5)[_0x20130b(0x20e)]());else{if(_0x1326f9[_0x20130b(0x2cf)]('[RESULT]'))try{const _0x54967e=JSON['parse'](_0x1326f9[_0x20130b(0x2fc)](0x8)[_0x20130b(0x20e)]());handlePythonResult(_0x3b4b88,_0x54967e);}catch(_0x882002){}}});}),_0x3b4b88[_0x503912(0x153)]['on']('close',_0x433427=>{_0x3b4b88['pythonProcess']=null;});}catch(_0x42a723){_0x3b4b88['log']['error'](_0x503912(0x256)+_0x42a723[_0x503912(0x161)]);}}function stopPythonService(_0x49a7a7){const _0x187aa5=a0_0x28f9ea;if(_0x49a7a7[_0x187aa5(0x153)]){try{_0x49a7a7[_0x187aa5(0x153)]['kill']();}catch(_0x3adf68){}_0x49a7a7[_0x187aa5(0x153)]=null;}}function handlePythonResult(_0x48e2f0,_0x6bae29){const _0x454318=a0_0x28f9ea;if(_0x6bae29['type']===_0x454318(0x246))_0x48e2f0['log'][_0x454318(0x249)](_0x454318(0x1b9));else{if(_0x6bae29['type']===_0x454318(0x2d5)){const {anomaly_score:_0x5246e7,is_anomaly:_0x12f4de,threshold:_0xf8efd0,explanation:_0x2ee915}=_0x6bae29[_0x454318(0x2dc)];_0x48e2f0[_0x454318(0x1c7)][_0x454318(0x1e2)](_0x454318(0x2ac)+_0x5246e7['toFixed'](0x5)+_0x454318(0x2e4)+(_0x12f4de?'ANOMALY':'OK')),_0x48e2f0['setStateAsync'](_0x454318(0x332),{'val':_0x5246e7,'ack':!![]}),_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x29e),{'val':new Date()['toISOString'](),'ack':!![]});if(_0xf8efd0)_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x306),{'val':_0xf8efd0,'ack':!![]});if(_0x12f4de){let _0x4ed40f=_0x454318(0x196)+_0x5246e7[_0x454318(0x30b)](0x4)+')';if(_0x2ee915&&_0x2ee915!==_0x454318(0x324))_0x4ed40f+=_0x454318(0x1dc)+_0x2ee915;_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x327),{'val':!![],'ack':!![]}),_0x48e2f0[_0x454318(0x1ca)]('analysis.alertReason',{'val':_0x4ed40f,'ack':!![]}),sendNotification(_0x48e2f0,_0x454318(0x27e)+_0x4ed40f,![],!![]);}}else{if(_0x6bae29[_0x454318(0x26b)]===_0x454318(0x225)){const _0x3054d8=_0x6bae29['payload'][_0x454318(0x22d)]||'',_0x7096fb=_0x6bae29['payload'][_0x454318(0x206)],_0x1a61b7=_0x6bae29[_0x454318(0x2dc)][_0x454318(0x1f4)]?_0x454318(0x175)+new Date()[_0x454318(0x262)]()+'\x20('+_0x3054d8+')':'Failed:\x20'+_0x6bae29[_0x454318(0x2dc)][_0x454318(0x294)];_0x48e2f0['setStateAsync']('analysis.training.status',{'val':_0x1a61b7,'ack':!![]});if(_0x6bae29[_0x454318(0x2dc)][_0x454318(0x1f4)]&&_0x7096fb)_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x306),{'val':_0x7096fb,'ack':!![]});}else{if(_0x6bae29[_0x454318(0x26b)]===_0x454318(0x2a6)){const {patterns:_0x45aa79}=_0x6bae29[_0x454318(0x2dc)];if(_0x45aa79&&_0x45aa79['length']>0x0){_0x48e2f0[_0x454318(0x1c7)][_0x454318(0x1e2)](_0x454318(0x27f)+_0x45aa79['length']+_0x454318(0x170)),_0x48e2f0[_0x454318(0x1ca)]('analysis.automation.detectedPatterns',{'val':JSON[_0x454318(0x30e)](_0x45aa79),'ack':!![]});const _0x580ad2=_0x45aa79[0x0],_0x3a258e=_0x454318(0x1c4)+_0x580ad2[_0x454318(0x1cf)]+'\x20('+(_0x580ad2[_0x454318(0x1da)]*0x64)[_0x454318(0x30b)](0x0)+'%)';_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x25f),{'val':!![],'ack':!![]}),_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x1c5),{'val':_0x3a258e,'ack':!![]});}else _0x48e2f0[_0x454318(0x1c7)][_0x454318(0x1e2)](_0x454318(0x16f)),_0x48e2f0[_0x454318(0x1ca)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x193),{'val':'[]','ack':!![]});}else{if(_0x6bae29[_0x454318(0x26b)]===_0x454318(0x1ee)){if(_0x6bae29[_0x454318(0x2dc)][_0x454318(0x1f4)])try{const _0x230d52=JSON[_0x454318(0x281)](_0x6bae29[_0x454318(0x2dc)][_0x454318(0x22d)]);if(_0x230d52[_0x454318(0x1ab)])_0x48e2f0[_0x454318(0x1ca)]('analysis.energy.insulationScore',{'val':JSON[_0x454318(0x30e)](_0x230d52[_0x454318(0x1ab)]),'ack':!![]});if(_0x230d52[_0x454318(0x1e7)])_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x2c4),{'val':JSON[_0x454318(0x30e)](_0x230d52[_0x454318(0x1e7)]),'ack':!![]});}catch(_0x384ece){}}else{if(_0x6bae29[_0x454318(0x26b)]===_0x454318(0x330)){if(_0x6bae29['payload'][_0x454318(0x1f4)])_0x48e2f0[_0x454318(0x1c7)][_0x454318(0x1e2)]('âœ…\x20HEALTH\x20TRAINED.');}else{if(_0x6bae29[_0x454318(0x26b)]===_0x454318(0x1b8))_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x2db),{'val':new Date()[_0x454318(0x1fd)](),'ack':!![]}),_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x185),{'val':_0x6bae29[_0x454318(0x2dc)][_0x454318(0x20f)],'ack':!![]});else{if(_0x6bae29[_0x454318(0x26b)]===_0x454318(0x308))_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x1aa),{'val':_0x6bae29['payload'][_0x454318(0x227)],'ack':!![]}),_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x268),{'val':_0x6bae29[_0x454318(0x2dc)][_0x454318(0x328)],'ack':!![]});else{if(_0x6bae29[_0x454318(0x26b)]===_0x454318(0x192)){const {speed_trend:_0x17adc7}=_0x6bae29[_0x454318(0x2dc)];_0x17adc7!==undefined&&_0x48e2f0['setStateAsync'](_0x454318(0x1cc),{'val':_0x17adc7,'ack':!![]});}else{if(_0x6bae29['type']===_0x454318(0x177)){const {forecast:_0x25a21b}=_0x6bae29[_0x454318(0x2dc)];_0x25a21b&&_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x1df),{'val':JSON[_0x454318(0x30e)](_0x25a21b),'ack':!![]});}else{if(_0x6bae29['type']===_0x454318(0x1c6)){const {data:_0x1b19d9}=_0x6bae29[_0x454318(0x2dc)];_0x1b19d9&&(_0x48e2f0[_0x454318(0x1c7)]['info'](_0x454318(0x1f0)),_0x48e2f0[_0x454318(0x1ca)](_0x454318(0x2bf),{'val':JSON['stringify'](_0x1b19d9),'ack':!![]}));}}}}}}}}}}}}function runPythonHealthCheck(_0x437b1b){const _0x584b14=a0_0x28f9ea;if(!_0x437b1b[_0x584b14(0x1a5)]||_0x437b1b[_0x584b14(0x1a5)][_0x584b14(0x220)]<0x2)return;const _0x2a8320=_0x437b1b['dailyDigests'][_0x584b14(0x2c1)](_0x25c3e5=>{const _0x5c132d=_0x584b14,_0x3a42e2=(_0x25c3e5[_0x5c132d(0x32c)]||'')[_0x5c132d(0x334)]();return ACTIVITY_LEVEL_MAP[_0x3a42e2]||0x32;});sendToPython(_0x437b1b,_0x584b14(0x1b0),{'values':_0x2a8320,'tag':_0x584b14(0x282)});}async function handleTelegramResponse(_0x341321,_0x22bd40){const _0x28d54a=a0_0x28f9ea;let _0x31f8c4=_0x22bd40;_0x22bd40[_0x28d54a(0x2cf)]('[')&&(_0x31f8c4=_0x22bd40[_0x28d54a(0x2fc)](_0x22bd40[_0x28d54a(0x271)](']')+0x1));if(_0x31f8c4==='COGNI_CONFIRM_OK')await _0x341321[_0x28d54a(0x1ca)](_0x28d54a(0x327),{'val':![],'ack':!![]}),await _0x341321[_0x28d54a(0x1ca)](_0x28d54a(0x210),{'val':_0x28d54a(0x23d),'ack':!![]}),_0x341321[_0x28d54a(0x2ec)]=![],sendNotification(_0x341321,'âœ…\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x31f8c4===_0x28d54a(0x285)&&sendNotification(_0x341321,_0x28d54a(0x188),![],!![]);}async function sendNotification(_0x2a1700,_0xf0d75b,_0x14063=![],_0x58db47=![]){const _0x1d1a7c=a0_0x28f9ea,_0x378c44=_0x2a1700[_0x1d1a7c(0x27d)];if(_0x378c44[_0x1d1a7c(0x2af)]){let _0x397155={};(_0xf0d75b[_0x1d1a7c(0x1c1)](_0x1d1a7c(0x203))||_0x58db47)&&(_0x397155={'reply_markup':{'inline_keyboard':[[{'text':_0x1d1a7c(0x1c3),'callback_data':_0x1d1a7c(0x303)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x1d1a7c(0x285)}]]}}),await _0x2a1700[_0x1d1a7c(0x2c2)](_0x378c44[_0x1d1a7c(0x243)],_0x1d1a7c(0x17f),{'text':_0xf0d75b,'user':_0x378c44[_0x1d1a7c(0x2ba)],..._0x397155});}if(_0x378c44[_0x1d1a7c(0x1b3)]){let _0x1a4daa={'message':_0xf0d75b,'title':_0x58db47?_0x1d1a7c(0x18f):_0x1d1a7c(0x1bb),'priority':_0x58db47?0x2:0x1,'device':_0x378c44[_0x1d1a7c(0x302)]};_0x58db47&&(_0x1a4daa[_0x1d1a7c(0x2b5)]=0x1e,_0x1a4daa[_0x1d1a7c(0x2d7)]=0xe10,_0x1a4daa['sound']=_0x1d1a7c(0x2e3)),await _0x2a1700[_0x1d1a7c(0x2c2)](_0x378c44['notifyPushoverInstance'],'send',_0x1a4daa);}_0x378c44[_0x1d1a7c(0x2fe)]&&await _0x2a1700['sendToAsync'](_0x378c44[_0x1d1a7c(0x1e5)],_0x1d1a7c(0x17f),{'text':_0xf0d75b,'to':_0x378c44['notifyEmailRecipient']});}async function runGeminiAnalysis(_0x4efcb1,_0x349b46=''){const _0x43a1c9=a0_0x28f9ea;if(!_0x4efcb1[_0x43a1c9(0x1cb)])return;if(_0x4efcb1[_0x43a1c9(0x230)][_0x43a1c9(0x220)]===0x0)return;const _0x402f5c=_0x4efcb1['eventHistory'][_0x43a1c9(0x1ef)](0x0,0xf),_0x31c2f4=await getWeatherContext(_0x4efcb1),_0x25c7aa=_0x4efcb1[_0x43a1c9(0x1a2)],_0x1bec2e=PERSONA_MAPPING[_0x4efcb1[_0x43a1c9(0x27d)]['aiPersona']||_0x43a1c9(0x234)],_0x2d7c5b=_0x4efcb1[_0x43a1c9(0x27d)]['livingContext']||_0x43a1c9(0x2ab);let _0x72fbd1=_0x43a1c9(0x1eb);try{const _0x75d23d=await _0x4efcb1[_0x43a1c9(0x238)](_0x43a1c9(0x333));if(_0x75d23d&&_0x75d23d['val'])_0x72fbd1=_0x75d23d[_0x43a1c9(0x1d3)];}catch(_0xa238d9){}let _0x3917de=![];try{const _0x1aba30=await _0x4efcb1['getStateAsync'](_0x43a1c9(0x264));if(_0x1aba30&&_0x1aba30[_0x43a1c9(0x1d3)])_0x3917de=!![];}catch(_0x151d26){}const _0x187dd0=_0x43a1c9(0x1dd)+_0x1bec2e+'.\x20KONTEXT:\x20'+_0x2d7c5b+_0x43a1c9(0x23e)+_0x25c7aa+_0x43a1c9(0x1fa)+_0x31c2f4+_0x43a1c9(0x20b)+_0x72fbd1+'.\x20EVENTS:\x20'+JSON[_0x43a1c9(0x30e)](_0x402f5c)+_0x43a1c9(0x1cd)+_0x349b46+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{const _0xba559f=await _0x4efcb1['geminiModel'][_0x43a1c9(0x28a)](_0x187dd0),_0x27f22d=JSON['parse'](_0xba559f['response']['text']()[_0x43a1c9(0x1e4)](/```json|```/g,'')[_0x43a1c9(0x20e)]());await _0x4efcb1[_0x43a1c9(0x1ca)]('analysis.lastResult',{'val':JSON[_0x43a1c9(0x30e)](_0x27f22d),'ack':!![]});if(_0x27f22d[_0x43a1c9(0x2cb)])await _0x4efcb1['setStateAsync'](_0x43a1c9(0x26c),{'val':_0x27f22d[_0x43a1c9(0x2cb)],'ack':!![]});const _0x509ae4={'timestamp':Date[_0x43a1c9(0x204)](),'id':Date[_0x43a1c9(0x204)]()[_0x43a1c9(0x273)](),'analysis':{'activity':{'summary':_0x27f22d[_0x43a1c9(0x2cb)],'isAlert':_0x27f22d['isAlert'],'alertReason':_0x27f22d['alertReason']},'comfort':{'automationProposal':_0x27f22d[_0x43a1c9(0x152)]}}};await updateAnalysisHistory(_0x4efcb1,_0x509ae4);const _0x388946=_0x27f22d[_0x43a1c9(0x2b6)]||![];_0x388946!==_0x4efcb1[_0x43a1c9(0x2ec)]&&(await _0x4efcb1[_0x43a1c9(0x1ca)]('analysis.isAlert',{'val':_0x388946,'ack':!![]}),_0x4efcb1[_0x43a1c9(0x2ec)]=_0x388946,_0x388946&&(await _0x4efcb1[_0x43a1c9(0x1ca)](_0x43a1c9(0x210),{'val':_0x27f22d[_0x43a1c9(0x304)],'ack':!![]}),sendNotification(_0x4efcb1,'âš ï¸\x20ALARM:\x20'+_0x27f22d['alertReason'],![],_0x27f22d['isEmergency'])));if(_0x27f22d[_0x43a1c9(0x152)]&&_0x27f22d[_0x43a1c9(0x152)]['detected']){await _0x4efcb1[_0x43a1c9(0x1ca)](_0x43a1c9(0x25f),{'val':!![],'ack':!![]}),await _0x4efcb1[_0x43a1c9(0x1ca)](_0x43a1c9(0x1c5),{'val':_0x27f22d[_0x43a1c9(0x152)]['description'],'ack':!![]}),await _0x4efcb1['setStateAsync'](_0x43a1c9(0x198),{'val':_0x27f22d[_0x43a1c9(0x152)][_0x43a1c9(0x17c)],'ack':!![]}),await _0x4efcb1[_0x43a1c9(0x1ca)](_0x43a1c9(0x2b0),{'val':JSON['stringify'](_0x27f22d['automationProposal'][_0x43a1c9(0x166)]),'ack':!![]});if(_0x3917de)executeAutomationAction(_0x4efcb1);}}catch(_0xf8c22b){_0x4efcb1['log'][_0x43a1c9(0x1ea)]('Gemini\x20Error:\x20'+_0xf8c22b[_0x43a1c9(0x161)]);}}async function createDailyDigest(_0x2f2660){const _0x3014c2=a0_0x28f9ea;if(!_0x2f2660[_0x3014c2(0x29b)])return;await _0x2f2660['setStateAsync'](LTM_DP_STATUS,{'val':_0x3014c2(0x2a7),'ack':!![]});if(!_0x2f2660['geminiModel']||_0x2f2660[_0x3014c2(0x172)][_0x3014c2(0x220)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2f2660['setStateAsync'](LTM_DP_STATUS,{'val':_0x3014c2(0x2ad),'ack':!![]});return;}const _0x71dfce=JSON[_0x3014c2(0x281)](JSON[_0x3014c2(0x30e)](_0x2f2660[_0x3014c2(0x172)])),_0x1e30e8=_0x71dfce[_0x3014c2(0x220)],_0x1424ad=_0x3014c2(0x215)+JSON['stringify'](_0x71dfce);try{const _0x36af0b=await _0x2f2660[_0x3014c2(0x1cb)][_0x3014c2(0x28a)](_0x1424ad),_0x34e69f=JSON['parse'](_0x36af0b[_0x3014c2(0x157)][_0x3014c2(0x1d0)]()[_0x3014c2(0x1e4)](/```json|```/g,'')['trim']()),_0x5ebaff={'timestamp':new Date()['toISOString'](),'eventCount':_0x1e30e8,'summary':_0x34e69f[_0x3014c2(0x2cb)]||_0x3014c2(0x254),'activityLevel':_0x34e69f['activityLevel']||'normal','systemMode':_0x2f2660[_0x3014c2(0x1a2)]};_0x2f2660['dailyDigests'][_0x3014c2(0x180)](_0x5ebaff),await saveDailyDigests(_0x2f2660),_0x2f2660[_0x3014c2(0x172)]=[],await saveRawEventLog(_0x2f2660),await _0x2f2660[_0x3014c2(0x1ca)](LTM_DP_STATUS,{'val':_0x3014c2(0x178),'ack':!![]});if(_0x2f2660[_0x3014c2(0x29b)])sendToPython(_0x2f2660,_0x3014c2(0x2c0),{'digest':_0x5ebaff});}catch(_0x5e79c1){_0x2f2660['log']['error'](_0x5e79c1[_0x3014c2(0x161)]);}}function setupLtmScheduler(_0x1266ea){const _0x47f218=a0_0x28f9ea;try{if(_0x1266ea[_0x47f218(0x209)])_0x1266ea[_0x47f218(0x209)][_0x47f218(0x245)]();if(!_0x1266ea[_0x47f218(0x29b)])return;_0x1266ea[_0x47f218(0x209)]=schedule[_0x47f218(0x314)](LTM_SCHEDULE,()=>createDailyDigest(_0x1266ea));}catch(_0x11a9c5){_0x1266ea[_0x47f218(0x1c7)][_0x47f218(0x1ea)](_0x47f218(0x2a4)+_0x11a9c5[_0x47f218(0x161)]);}}function setupModeResetScheduler(_0x394185){const _0x14e88f=a0_0x28f9ea;try{if(_0x394185[_0x14e88f(0x297)])_0x394185['modeResetJob']['cancel']();_0x394185['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x4a5297=_0x14e88f;await loadSystemMode(_0x394185),AUTO_RESET_MODES[_0x4a5297(0x1c1)](_0x394185[_0x4a5297(0x1a2)])&&await _0x394185[_0x4a5297(0x1ca)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x4a5297(0x2b8)],'ack':![]});});}catch(_0x8f3bdb){_0x394185[_0x14e88f(0x1c7)][_0x14e88f(0x1ea)](_0x14e88f(0x2f3)+_0x8f3bdb['message']);}}function setupDriftAnalysisScheduler(_0x3eb081){const _0x251610=a0_0x28f9ea;try{if(_0x3eb081[_0x251610(0x1e0)])clearInterval(_0x3eb081[_0x251610(0x1e0)]);if(!_0x3eb081['isProVersion'])return;_0x3eb081[_0x251610(0x1e0)]=setInterval(()=>runBaselineDriftAnalysis(_0x3eb081),(_0x3eb081[_0x251610(0x27d)][_0x251610(0x2e5)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3eb081),0x1388);}catch(_0x49fe9a){_0x3eb081[_0x251610(0x1c7)][_0x251610(0x1ea)](_0x251610(0x272)+_0x49fe9a[_0x251610(0x161)]);}}function setupBriefingScheduler(_0x587a4e){const _0x20fffd=a0_0x28f9ea;try{if(_0x587a4e[_0x20fffd(0x186)])_0x587a4e[_0x20fffd(0x186)]['cancel']();if(!_0x587a4e[_0x20fffd(0x27d)][_0x20fffd(0x21d)])return;const _0x5dfc0a=(_0x587a4e[_0x20fffd(0x27d)][_0x20fffd(0x1d6)]||_0x20fffd(0x1af))[_0x20fffd(0x19a)](':'),_0x47a661=parseInt(_0x5dfc0a[0x0])||0x8,_0x29b0b5=parseInt(_0x5dfc0a[0x1])||0x0,_0x29f7e6=_0x29b0b5+'\x20'+_0x47a661+_0x20fffd(0x317);_0x587a4e[_0x20fffd(0x186)]=schedule['scheduleJob'](_0x29f7e6,()=>{sendMorningBriefing(_0x587a4e);});}catch(_0x47941f){_0x587a4e['log'][_0x20fffd(0x1ea)](_0x20fffd(0x255)+_0x47941f[_0x20fffd(0x161)]);}}async function runBaselineDriftAnalysis(_0x3181d0){const _0x3ebd2a=a0_0x28f9ea;if(!_0x3181d0[_0x3ebd2a(0x29b)]||!_0x3181d0['geminiModel'])return;const _0x3ea74f=_0x3181d0[_0x3ebd2a(0x27d)][_0x3ebd2a(0x2f1)]||0xe;if(_0x3181d0['dailyDigests'][_0x3ebd2a(0x220)]<_0x3ea74f+0x7){await _0x3181d0[_0x3ebd2a(0x1ca)](LTM_DP_DRIFT_STATUS,{'val':_0x3ebd2a(0x2b2),'ack':!![]});return;}const _0x34cebb=_0x3181d0[_0x3ebd2a(0x1a5)][_0x3ebd2a(0x1ef)](-_0x3ea74f),_0x552605=_0x3181d0['dailyDigests'][_0x3ebd2a(0x1ef)](0x0,_0x3181d0['dailyDigests'][_0x3ebd2a(0x220)]-_0x3ea74f),_0x481ebc=_0x3ebd2a(0x280)+JSON['stringify'](_0x552605)+_0x3ebd2a(0x313)+JSON[_0x3ebd2a(0x30e)](_0x34cebb);try{const _0x42464c=await _0x3181d0['geminiModel'][_0x3ebd2a(0x28a)](_0x481ebc),_0xb9803b=JSON['parse'](_0x42464c[_0x3ebd2a(0x157)][_0x3ebd2a(0x1d0)]()[_0x3ebd2a(0x1e4)](/```json|```/g,'')[_0x3ebd2a(0x20e)]());_0xb9803b[_0x3ebd2a(0x2f5)]&&(await _0x3181d0['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0xb9803b['baselineDrift'],'ack':!![]}),await _0x3181d0[_0x3ebd2a(0x1ca)](LTM_DP_DRIFT_DETAILS,{'val':_0xb9803b['driftDetails'],'ack':!![]}),await _0x3181d0[_0x3ebd2a(0x1ca)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x1ba201){}}class CogniLiving extends utils[a0_0x28f9ea(0x173)]{constructor(_0x469f65){const _0x4e0bbc=a0_0x28f9ea;super({..._0x469f65,'name':_0x4e0bbc(0x1a9)}),this['eventHistory']=[],this['analysisHistory']=[],this['rawEventLog']=[],this[_0x4e0bbc(0x1a5)]=[],this[_0x4e0bbc(0x30f)]={},this[_0x4e0bbc(0x2d3)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x4e0bbc(0x18b)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x4e0bbc(0x214)]=![],this['genAI']=null,this[_0x4e0bbc(0x1cb)]=null,this[_0x4e0bbc(0x1a2)]=SYSTEM_MODES[_0x4e0bbc(0x2b8)],this[_0x4e0bbc(0x29b)]=![],this[_0x4e0bbc(0x2ec)]=![],this[_0x4e0bbc(0x2a9)]='unknown',this['analysisTimer']=null,this[_0x4e0bbc(0x209)]=null,this[_0x4e0bbc(0x297)]=null,this[_0x4e0bbc(0x1e0)]=null,this['briefingJob']=null,this[_0x4e0bbc(0x153)]=null,this[_0x4e0bbc(0x242)]=![],this['on']('ready',this[_0x4e0bbc(0x16e)][_0x4e0bbc(0x2b7)](this)),this['on'](_0x4e0bbc(0x19e),this[_0x4e0bbc(0x29a)][_0x4e0bbc(0x2b7)](this)),this['on'](_0x4e0bbc(0x1a4),this['onUnload'][_0x4e0bbc(0x2b7)](this)),this['on'](_0x4e0bbc(0x161),this[_0x4e0bbc(0x322)][_0x4e0bbc(0x2b7)](this));}async[a0_0x28f9ea(0x16e)](){const _0x3f3519=a0_0x28f9ea;this[_0x3f3519(0x1c7)][_0x3f3519(0x1e2)](_0x3f3519(0x219)+this[_0x3f3519(0x1ed)]+_0x3f3519(0x2ee));if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x28f9ea(0x290)](_0x49b9d8){const _0x1fb31e=a0_0x28f9ea;if(this[_0x1fb31e(0x15b)])clearInterval(this['analysisTimer']);if(this[_0x1fb31e(0x1e0)])clearInterval(this[_0x1fb31e(0x1e0)]);if(this[_0x1fb31e(0x209)])this[_0x1fb31e(0x209)][_0x1fb31e(0x245)]();if(this[_0x1fb31e(0x297)])this[_0x1fb31e(0x297)][_0x1fb31e(0x245)]();if(this[_0x1fb31e(0x186)])this[_0x1fb31e(0x186)][_0x1fb31e(0x245)]();if(this[_0x1fb31e(0x275)])clearTimeout(this[_0x1fb31e(0x275)]);if(this[_0x1fb31e(0x1f2)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x49b9d8();}async['onStateChange'](_0x359c44,_0x242662){const _0xd50cbc=a0_0x28f9ea;if(!_0x242662||this[_0xd50cbc(0x242)])return;if(_0x359c44[_0xd50cbc(0x1c1)](_0xd50cbc(0x21f))&&_0x359c44[_0xd50cbc(0x165)](_0xd50cbc(0x2e1))&&_0x242662[_0xd50cbc(0x1d3)]){await handleTelegramResponse(this,_0x242662[_0xd50cbc(0x1d3)]);return;}if(_0x359c44===this[_0xd50cbc(0x25b)]+'.'+SYSTEM_DP_MODE){if(_0x242662[_0xd50cbc(0x1d3)]&&Object['values'](SYSTEM_MODES)[_0xd50cbc(0x1c1)](_0x242662[_0xd50cbc(0x1d3)])){this[_0xd50cbc(0x1a2)]=_0x242662[_0xd50cbc(0x1d3)];if(_0x242662[_0xd50cbc(0x1d3)]===SYSTEM_MODES[_0xd50cbc(0x25d)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x242662[_0xd50cbc(0x1f7)])this[_0xd50cbc(0x1e3)](_0x359c44,{'val':this[_0xd50cbc(0x1a2)],'ack':!![]});return;}if(!_0x242662[_0xd50cbc(0x1f7)]){_0x359c44[_0xd50cbc(0x1c1)](_0xd50cbc(0x28e))&&_0x242662[_0xd50cbc(0x1d3)]&&(this[_0xd50cbc(0x1e3)](_0x359c44,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x359c44[_0xd50cbc(0x1c1)]('triggerDailyDigest')&&_0x242662[_0xd50cbc(0x1d3)]){this['setState'](_0x359c44,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x359c44[_0xd50cbc(0x1c1)](_0xd50cbc(0x15a))&&_0x242662[_0xd50cbc(0x1d3)]&&(this[_0xd50cbc(0x1e3)](_0x359c44,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x359c44[_0xd50cbc(0x1c1)](_0xd50cbc(0x2e2))&&_0x242662[_0xd50cbc(0x1d3)]&&(this[_0xd50cbc(0x1e3)](_0x359c44,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x359c44[_0xd50cbc(0x1c1)](_0xd50cbc(0x208))&&_0x242662[_0xd50cbc(0x1d3)]){this[_0xd50cbc(0x1e3)](_0x359c44,{'val':![],'ack':!![]});if(this[_0xd50cbc(0x29b)])try{const _0x4039c5=await this[_0xd50cbc(0x238)]('LTM.trainingData.sequences');if(_0x4039c5&&_0x4039c5['val']){const _0x5c095a=JSON[_0xd50cbc(0x281)](_0x4039c5[_0xd50cbc(0x1d3)]);this[_0xd50cbc(0x1c7)][_0xd50cbc(0x1e2)](_0xd50cbc(0x205)),this['setStateAsync'](_0xd50cbc(0x27c),{'val':_0xd50cbc(0x22e),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x5c095a});}}catch(_0x964558){this['log']['error'](_0xd50cbc(0x167)+_0x964558[_0xd50cbc(0x161)]);}}if(_0x359c44[_0xd50cbc(0x1c1)](_0xd50cbc(0x283))&&_0x242662[_0xd50cbc(0x1d3)]){this[_0xd50cbc(0x1e3)](_0x359c44,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x369ee7=await this[_0xd50cbc(0x238)](LTM_DP_DAILY_DIGESTS);if(_0x369ee7&&_0x369ee7[_0xd50cbc(0x1d3)])sendToPython(this,_0xd50cbc(0x269),{'digests':JSON[_0xd50cbc(0x281)](_0x369ee7['val'])});}catch(_0xf5890d){}}if(_0x359c44[_0xd50cbc(0x1c1)](_0xd50cbc(0x244))&&_0x242662[_0xd50cbc(0x1d3)]){this['setState'](_0x359c44,{'val':![],'ack':!![]});if(this[_0xd50cbc(0x29b)])try{const _0x424e1e=await this[_0xd50cbc(0x238)](_0xd50cbc(0x20d));if(_0x424e1e&&_0x424e1e[_0xd50cbc(0x1d3)])sendToPython(this,_0xd50cbc(0x2f2),{'points':JSON[_0xd50cbc(0x281)](_0x424e1e['val'])});}catch(_0x58b27b){}}if(_0x359c44['includes'](_0xd50cbc(0x2f8))&&_0x242662[_0xd50cbc(0x1d3)]){this['setState'](_0x359c44,{'val':![],'ack':!![]});if(this[_0xd50cbc(0x29b)])try{const _0xb72756=await this[_0xd50cbc(0x238)](LTM_DP_RAW_LOG);_0xb72756&&_0xb72756[_0xd50cbc(0x1d3)]&&(this[_0xd50cbc(0x1c7)]['info'](_0xd50cbc(0x31b)),sendToPython(this,'TRAIN_COMFORT',{'events':JSON[_0xd50cbc(0x281)](_0xb72756[_0xd50cbc(0x1d3)])}));}catch(_0x290bcc){}}if(_0x359c44[_0xd50cbc(0x1c1)]('analysis.training.triggerTopology')&&_0x242662[_0xd50cbc(0x1d3)]){this[_0xd50cbc(0x1e3)](_0x359c44,{'val':![],'ack':!![]});if(this[_0xd50cbc(0x29b)])try{const _0x44b265=await this['getStateAsync'](_0xd50cbc(0x1e9));if(_0x44b265&&_0x44b265[_0xd50cbc(0x1d3)]){const _0x28136a=JSON[_0xd50cbc(0x281)](_0x44b265[_0xd50cbc(0x1d3)]);this[_0xd50cbc(0x1c7)]['info'](_0xd50cbc(0x224)),sendToPython(this,_0xd50cbc(0x263),{'sequences':_0x28136a});}}catch(_0x3e867b){this[_0xd50cbc(0x1c7)][_0xd50cbc(0x1ea)](_0xd50cbc(0x326)+_0x3e867b[_0xd50cbc(0x161)]);}}return;}if(this[_0xd50cbc(0x27d)][_0xd50cbc(0x1d8)]&&this['config'][_0xd50cbc(0x1d8)][_0xd50cbc(0x1c1)](_0x359c44)){await checkWifiPresence(this);return;}const _0x58b084=(this[_0xd50cbc(0x27d)][_0xd50cbc(0x24b)]||[])[_0xd50cbc(0x276)](_0xe1eccb=>_0xe1eccb['id']===_0x359c44);if(_0x58b084)processSensorEvent(this,_0x359c44,_0x242662,_0x58b084);}async[a0_0x28f9ea(0x322)](_0x103fe7){const _0x2da488=a0_0x28f9ea;if(typeof _0x103fe7===_0x2da488(0x2eb)&&_0x103fe7[_0x2da488(0x161)]){if(_0x103fe7[_0x2da488(0x2c8)]===_0x2da488(0x19c)){const _0x448011=_0x103fe7[_0x2da488(0x161)]['apiKey']||this[_0x2da488(0x27d)][_0x2da488(0x25c)];if(!_0x448011)return this['sendTo'](_0x103fe7[_0x2da488(0x318)],_0x103fe7[_0x2da488(0x2c8)],{'success':![],'message':'Kein\x20API\x20Key.'},_0x103fe7['callback']);try{const _0x464217=new GoogleGenerativeAI(_0x448011),_0x4a2524=_0x464217[_0x2da488(0x232)]({'model':GEMINI_MODEL}),_0x387691=await _0x4a2524[_0x2da488(0x28a)]('Hi');this['sendTo'](_0x103fe7[_0x2da488(0x318)],_0x103fe7['command'],{'success':!![],'message':'OK:\x20'+_0x387691[_0x2da488(0x157)][_0x2da488(0x1d0)]()},_0x103fe7['callback']);}catch(_0xfe035f){this[_0x2da488(0x15e)](_0x103fe7[_0x2da488(0x318)],_0x103fe7['command'],{'success':![],'message':_0x2da488(0x15c)+_0xfe035f[_0x2da488(0x161)]},_0x103fe7['callback']);}}else{if(_0x103fe7[_0x2da488(0x2c8)]===_0x2da488(0x201)){const _0xcaa40b=await getWeatherContext(this),_0x169666=await getCalendarContext(this);this['sendTo'](_0x103fe7[_0x2da488(0x318)],_0x103fe7['command'],{'success':!![],'weather':_0xcaa40b,'calendar':_0x169666},_0x103fe7[_0x2da488(0x21a)]);}else{if(_0x103fe7['command']===_0x2da488(0x1a1)){if(!this[_0x2da488(0x29b)])return this[_0x2da488(0x15e)](_0x103fe7[_0x2da488(0x318)],_0x103fe7[_0x2da488(0x2c8)],{'success':![],'isPro':![]},_0x103fe7[_0x2da488(0x21a)]);let _0x4569ff={'status':'N/A'};try{const _0x2bb2c5=await this[_0x2da488(0x238)](LTM_DP_DRIFT_STATUS);_0x4569ff[_0x2da488(0x24d)]=_0x2bb2c5?_0x2bb2c5['val']:_0x2da488(0x2dd);}catch(_0x529c75){}this[_0x2da488(0x15e)](_0x103fe7[_0x2da488(0x318)],_0x103fe7['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x4569ff,'analysisHistory':this['analysisHistory']},_0x103fe7['callback']);}else{if(_0x103fe7['command']===_0x2da488(0x213)){const _0x52632b=this[_0x2da488(0x1a5)]['length'],_0x4547a1=new Date(),_0x18558b=new Date(_0x4547a1[_0x2da488(0x22f)](),_0x4547a1['getMonth'](),_0x4547a1[_0x2da488(0x236)]())[_0x2da488(0x181)](),_0x402317=this['rawEventLog'][_0x2da488(0x30d)](_0x396b14=>new Date(_0x396b14['timestamp'])[_0x2da488(0x181)]()>_0x18558b)['length'],_0x109c59=new Array(0x18)[_0x2da488(0x211)](0x0);this[_0x2da488(0x172)]['forEach'](_0x311056=>{const _0x20a31b=_0x2da488,_0x29b4e0=new Date(_0x311056[_0x20a31b(0x23c)]);if(_0x29b4e0[_0x20a31b(0x181)]()>_0x18558b)_0x109c59[_0x29b4e0[_0x20a31b(0x1f1)]()]++;});let _0x515286={'status':_0x2da488(0x2dd)};try{const _0x28fd95=await this[_0x2da488(0x238)](LTM_DP_DRIFT_STATUS);_0x515286[_0x2da488(0x24d)]=_0x28fd95?_0x28fd95[_0x2da488(0x1d3)]:'N/A';}catch(_0x34f02e){}let _0x2f66bf='';try{const _0x4b4221=await this[_0x2da488(0x238)](_0x2da488(0x333));_0x2f66bf=_0x4b4221?_0x4b4221['val']:'';}catch(_0x28b14a){}let _0x21779d=null;!this['geminiModel']&&(_0x21779d=this[_0x2da488(0x27d)][_0x2da488(0x25c)]?'KI-Modell\x20nicht\x20initialisiert':'Kein\x20API\x20Key!');let _0x1dff7d={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x23d28b=await this[_0x2da488(0x238)](_0x2da488(0x25f));if(_0x23d28b&&_0x23d28b[_0x2da488(0x1d3)]){_0x1dff7d[_0x2da488(0x253)]=!![];const _0x4858a0=await this[_0x2da488(0x238)](_0x2da488(0x1c5));_0x1dff7d[_0x2da488(0x226)]=_0x4858a0?_0x4858a0[_0x2da488(0x1d3)]:'';const _0xdd087b=await this['getStateAsync'](_0x2da488(0x198));_0x1dff7d[_0x2da488(0x17c)]=_0xdd087b?_0xdd087b['val']:'';const _0xef8d0b=await this[_0x2da488(0x238)]('analysis.automation.targetValue');_0x1dff7d[_0x2da488(0x166)]=_0xef8d0b?_0xef8d0b[_0x2da488(0x1d3)]:'';}const _0x210ccd=await this[_0x2da488(0x238)](_0x2da488(0x264));_0x1dff7d[_0x2da488(0x184)]=_0x210ccd?!!_0x210ccd['val']:![];}catch(_0x44f7f6){}this[_0x2da488(0x15e)](_0x103fe7[_0x2da488(0x318)],_0x103fe7[_0x2da488(0x2c8)],{'success':!![],'eventHistory':this[_0x2da488(0x230)][_0x2da488(0x1ef)](0x0,0xf),'stats':{'digestCount':_0x52632b,'eventCountToday':_0x402317,'hourlyActivity':_0x109c59,'driftStatus':_0x515286[_0x2da488(0x24d)],'isPresent':this[_0x2da488(0x18b)],'presenceWho':_0x2f66bf,'minDays':this['config']['minDaysForBaseline']||0x7,'stbDays':this[_0x2da488(0x27d)][_0x2da488(0x2f1)]||0xe,'ltbDays':this[_0x2da488(0x27d)]['ltmLtbWindowDays']||0x3c,'systemError':_0x21779d},'automation':_0x1dff7d},_0x103fe7['callback']);}else{if(_0x103fe7[_0x2da488(0x2c8)]===_0x2da488(0x239))try{const _0x589ba7=await scanForDevices(this,_0x103fe7[_0x2da488(0x161)]||{});this[_0x2da488(0x15e)](_0x103fe7['from'],_0x103fe7[_0x2da488(0x2c8)],{'success':!![],'devices':_0x589ba7},_0x103fe7['callback']);}catch(_0x26da3a){this['sendTo'](_0x103fe7[_0x2da488(0x318)],_0x103fe7[_0x2da488(0x2c8)],{'success':![],'error':_0x26da3a[_0x2da488(0x161)]},_0x103fe7[_0x2da488(0x21a)]);}else{if(_0x103fe7[_0x2da488(0x2c8)]===_0x2da488(0x229)){const _0x3098b4=await this[_0x2da488(0x29d)](_0x2da488(0x183),_0x2da488(0x1a8)),_0x1afb64=[];if(_0x3098b4)for(const _0x57529d in _0x3098b4){const _0x44ba9e=_0x3098b4[_0x57529d],_0x4ae940=(_0x44ba9e[_0x2da488(0x228)]&&typeof _0x44ba9e[_0x2da488(0x228)][_0x2da488(0x2d0)]===_0x2da488(0x2eb)?_0x44ba9e[_0x2da488(0x228)]['name']['de']:_0x44ba9e[_0x2da488(0x228)]['name'])||_0x44ba9e[_0x2da488(0x228)]['name'];_0x1afb64[_0x2da488(0x180)]({'id':_0x57529d,'name':_0x4ae940});}const _0xb649fc=await this[_0x2da488(0x29d)]('enum.rooms.*',_0x2da488(0x1a8)),_0x233806=[];if(_0xb649fc)for(const _0x59e96a in _0xb649fc){const _0x53ecb7=_0xb649fc[_0x59e96a],_0x2db0d3=(_0x53ecb7[_0x2da488(0x228)]&&typeof _0x53ecb7[_0x2da488(0x228)][_0x2da488(0x2d0)]===_0x2da488(0x2eb)?_0x53ecb7[_0x2da488(0x228)][_0x2da488(0x2d0)]['de']:_0x53ecb7[_0x2da488(0x228)][_0x2da488(0x2d0)])||_0x59e96a['split']('.')[_0x2da488(0x258)]();_0x233806[_0x2da488(0x180)](_0x2db0d3);}this[_0x2da488(0x15e)](_0x103fe7[_0x2da488(0x318)],_0x103fe7['command'],{'success':!![],'enums':_0x1afb64,'rooms':_0x233806},_0x103fe7[_0x2da488(0x21a)]);}else{if(_0x103fe7['command']===_0x2da488(0x2e6)){const _0x4b039c=_0x103fe7['message']['instance'];if(!_0x4b039c)return this[_0x2da488(0x15e)](_0x103fe7['from'],_0x103fe7[_0x2da488(0x2c8)],{'success':![],'error':_0x2da488(0x284)},_0x103fe7[_0x2da488(0x21a)]);const _0x313593=await getCalendarNames(this,_0x4b039c);this[_0x2da488(0x15e)](_0x103fe7[_0x2da488(0x318)],_0x103fe7[_0x2da488(0x2c8)],{'success':!![],'names':_0x313593},_0x103fe7[_0x2da488(0x21a)]);}else{if(_0x103fe7['command']===_0x2da488(0x162)){const {targetId:_0x53e6f7,targetValue:_0x19f466}=_0x103fe7[_0x2da488(0x161)];this[_0x2da488(0x1c7)]['info'](_0x2da488(0x2ca)+_0x53e6f7+_0x2da488(0x1c0)+_0x19f466),await this['setStateAsync'](_0x2da488(0x25f),{'val':!![],'ack':!![]}),await this[_0x2da488(0x1ca)]('analysis.automation.description',{'val':_0x2da488(0x251)+_0x53e6f7,'ack':!![]}),await this[_0x2da488(0x1ca)](_0x2da488(0x198),{'val':_0x53e6f7,'ack':!![]}),await this[_0x2da488(0x1ca)](_0x2da488(0x2b0),{'val':_0x19f466,'ack':!![]}),this[_0x2da488(0x15e)](_0x103fe7['from'],_0x103fe7[_0x2da488(0x2c8)],{'success':!![]},_0x103fe7[_0x2da488(0x21a)]);}else{if(_0x103fe7[_0x2da488(0x2c8)]===_0x2da488(0x19f)){const {historyId:_0x398bc7,rating:_0x9967c5,comment:_0x1898cb,alertReason:_0x299f10}=_0x103fe7['message'];_0x398bc7&&_0x9967c5?(await saveFeedback(this,{'timestamp':Date[_0x2da488(0x204)](),'historyId':_0x398bc7,'rating':_0x9967c5,'comment':_0x1898cb,'alertReason':_0x299f10}),this[_0x2da488(0x15e)](_0x103fe7['from'],_0x103fe7[_0x2da488(0x2c8)],{'success':!![]},_0x103fe7[_0x2da488(0x21a)])):this[_0x2da488(0x15e)](_0x103fe7[_0x2da488(0x318)],_0x103fe7[_0x2da488(0x2c8)],{'success':![],'error':_0x2da488(0x259)},_0x103fe7['callback']);}else _0x103fe7[_0x2da488(0x2c8)]==='dismissAutomation'&&(this[_0x2da488(0x1c7)]['info']('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x2da488(0x25f),{'val':![],'ack':!![]}),await this[_0x2da488(0x1ca)](_0x2da488(0x1c5),{'val':'','ack':!![]}),this[_0x2da488(0x15e)](_0x103fe7[_0x2da488(0x318)],_0x103fe7['command'],{'success':!![]},_0x103fe7[_0x2da488(0x21a)]));}}}}}}}}}}}if(require[a0_0x28f9ea(0x2a0)]!==module)module[a0_0x28f9ea(0x182)]=_0xb14be3=>new CogniLiving(_0xb14be3);else new CogniLiving();