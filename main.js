function a0_0x25d4(_0x365e53,_0x22b18d){const _0x4158d1=a0_0x5c00();return a0_0x25d4=function(_0x3d65c6,_0x7f115a){_0x3d65c6=_0x3d65c6-0x162;let _0x5c0087=_0x4158d1[_0x3d65c6];return _0x5c0087;},a0_0x25d4(_0x365e53,_0x22b18d);}const a0_0x343305=a0_0x25d4;(function(_0x25d7d4,_0xe2a35f){const _0x29e8fc=a0_0x25d4,_0x3ebc6c=_0x25d7d4();while(!![]){try{const _0x46cb62=parseInt(_0x29e8fc(0x287))/0x1*(parseInt(_0x29e8fc(0x1e2))/0x2)+-parseInt(_0x29e8fc(0x269))/0x3*(parseInt(_0x29e8fc(0x257))/0x4)+-parseInt(_0x29e8fc(0x26e))/0x5+parseInt(_0x29e8fc(0x1be))/0x6+-parseInt(_0x29e8fc(0x213))/0x7+parseInt(_0x29e8fc(0x1ae))/0x8+parseInt(_0x29e8fc(0x1d6))/0x9*(-parseInt(_0x29e8fc(0x279))/0xa);if(_0x46cb62===_0xe2a35f)break;else _0x3ebc6c['push'](_0x3ebc6c['shift']());}catch(_0x5dd5dd){_0x3ebc6c['push'](_0x3ebc6c['shift']());}}}(a0_0x5c00,0x7f923));const a0_0x7f115a=(function(){let _0x3530ab=!![];return function(_0x4f2b9f,_0x49aa38){const _0x49e303=_0x3530ab?function(){const _0x1cc48e=a0_0x25d4;if(_0x49aa38){const _0x1db8de=_0x49aa38[_0x1cc48e(0x183)](_0x4f2b9f,arguments);return _0x49aa38=null,_0x1db8de;}}:function(){};return _0x3530ab=![],_0x49e303;};}()),a0_0x3d65c6=a0_0x7f115a(this,function(){const _0x4fd513=a0_0x25d4;return a0_0x3d65c6[_0x4fd513(0x1c4)]()[_0x4fd513(0x239)]('(((.+)+)+)+$')['toString']()[_0x4fd513(0x224)](a0_0x3d65c6)[_0x4fd513(0x239)](_0x4fd513(0x251));});function a0_0x5c00(){const _0x24d9f6=['\x20Stunden!','0\x204\x20*\x20*\x20*','logDuplicates','[TEST]\x20','Gemini\x20Init\x20Error:\x20','system','Presence\x20Status','Exit\x20Grace\x20Period\x20beendet.\x20√úberwache\x20nun\x20Innenraum...','getSystemUUID','includes','Last\x20Result','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','test','testApiKey','substring','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','notifyPushoverRecipient','summary','apply','alertReason','notifySignalEnabled','boolean','Pattern\x20Detected','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20ungew√∂hnliche\x20n√§chtliche\x20Aktivit√§t.','analysis.trigger','log','cogni-living','info','analysis.lastResult','details','Received\x20scanDevices\x20request\x20from\x20Admin\x20UI.','Konnte\x20System-Standort\x20nicht\x20laden.','subscribeStates','namespace','Sending\x20notification:\x20\x22','native','runBaselineDriftAnalysis','\x20Tage)','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','eventHistory','replace','analysis.alertReason','loadSystemMode','exports','createAllObjects','AI\x20Alert\x20Status','Aktiv\x20(','checkLtmDriftObjects','parse','Skipped\x20(No\x20AI\x20or\x20Data)','debug','testNotification','üö®\x20Dead\x20Man\x27s\x20Switch:\x20Keine\x20Aktivit√§t\x20seit\x20','lastAlertState','command','Pr√§senz-Status\x20ge√§ndert:\x20','message','analysis.history_debug_03','enum','Started\x20at\x20','siren','8193608ptFYnn','sound','LTM.triggerDailyDigest','sendTo','baselineDrift','toLocaleTimeString','analysis.comfortSummary','checkLicense','N/A','bind','\x20(EMERGENCY)','loadRawEventLog','getLtmData','[Test]\x20Notification','error','enum.functions.*','4091562keGHHv','loadDailyDigests','GUEST','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','Baseline\x20Status','haust√ºr','toString','unload','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','delObjectAsync','Party','de-DE','inactivityMonitoringEnabled','LTM.driftAnalysis.driftDetails','Analysis\x20Error:\x20','genAI','analysis.automation','notifyTelegramEnabled','button','No\x20Key','channel','TEST-PRO-KEY','runAutopilot','2-digit','9MZdnDi','LTM.driftAnalysis.lastCheck','Success','setupDriftAnalysisScheduler','onUnload','uuid-error','checkLtmObjects','\x0a\x0aUSER\x20FEEDBACK\x20/\x20LERN-CONTEXT\x20(Vermeide\x20diese\x20Fehler):\x0a','System\x20Mode','flur','ltmJob','indicator.alarm.fire','2nyPwIe','object','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','models/gemini-flash-latest','No\x20recent\x20activity.','Fenster/T√ºr','0\x203\x20*\x20*\x20*','events.lastEvent','ltmDriftCheckIntervalHours','type','Deviation','resetAnalysisStates','licenseKey','Nein','system.meta.uuid','driftAnalysisTimer','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','notifyPushoverInstance','notifySignalInstance','text.alarm','length','events.history_debug_03','notifySignalRecipient','from','notifyTelegramRecipient','uuid-not-found','cogni-living\x20adapter\x20starting\x20(v','timestamp','geminiApiKey','onMessage','geminiModel','Ignoring\x20event\x20during\x20Exit\x20Grace\x20Period:\x20','catch','warn','activityLevel','application/json','analysis.history_debug_02','latitude','modeResetJob','text','notifyWhatsappInstance','sendNotification','indicator.alarm','push','config','Drift\x20Details','expire','Success:\x20Compressed\x20','isEmergency','4449844rEHUgb','LTM.dailyDigests','Description','cleanUpZombies','setupModeResetScheduler','find','Last\x20Check','analysis.automation.patternDetected','Comfort\x20Summary','saveRawEventLog','response','analysis.comfortSuggestion','getGenerativeModel','Drift\x20Status','system.isPresent','LTM.driftAnalysis.baselineDrift','extendObjectAsync','constructor','indicator','onReady','analysisHistory','cancel','notifyEmailEnabled','setObjectNotExistsAsync','values','lastCheck','@google/generative-ai','\x20sensors...','notifyPushoverEnabled','.\x20ORT:\x20','system.config','Activity\x20Summary','N/A\x20(Pro\x20Feature)','checkSystemObjects','AI\x20Emergency\x20Status','map','Cogni-Living\x20Alert','Action','search','onStateChange','comment','N/A\x20(Learning)','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','status','LTM.processingStatus','analysis.isEmergency','activity','uuid','exitGraceTimer','subscribeForeignStatesAsync','setupLtmScheduler','string','analysisTimer','Baseline:\x20Inactive\x20(Pro\x20Feature).','dailyDigests','name','Error:\x20','stringify','Automation\x20Proposals','ROLLE:\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20KONTEXT:\x20','analysis.isAlert','No\x20recorded\x20events\x20yet.','(((.+)+)+)+$','exitTimer','sendToAsync','abortExitTimer','Missing\x20data','@iobroker/adapter-core','5932FTBqqq','Gemini\x20AI\x20initialized.','createDailyDigest','analysis.history_debug_04','unshift','setPresence','systemConfig','state','splice','LTM.baselineStatus','ack','Comfort\x20Suggestion','isProVersion','json','scanForDevices','updateBaselineStatus','notifyWhatsappRecipient','loadHistoryFromState','1113jtVclQ','setStateAsync','toLowerCase','system.mode','getEnums','70440SolOOg','currentSystemMode','Trigger\x20Digest','city','val','startsWith','filter','triggerDailyDigest','rating','notifyTelegramInstance','ltmLtbWindowDays','781910YiWwkA','rawEventLog','Raw\x20Log','inactivityThresholdHours','Processing\x20Status','runGeminiAnalysis','analysis.deviationFromBaseline','driftDetails','üö®üö®\x20NOTFALL','minDaysForBaseline','\x20min).\x20Watchdog\x20Limit:\x20','location','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','isPresent','94567RwxFaZ','scheduleJob','version','getStateAsync','saveDailyDigests','setState','isGracePeriodActive','ltmStbWindowDays','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','feedbackHistory','Gast','System\x20Status\x20&\x20Control','slice','main','normal','analysis.activitySummary','Loaded\x20','generateContent','Deaktiviert\x20(Pro-Feature)','.\x20PERSONA:\x20','vacation','\x0a\x0aA\x20(STB):\x0a','Haust√ºr\x20Event:\x20Starte\x20Exit-Logik\x20(15min\x20Timer,\x2030s\x20Grace\x20Period).','notifyEmailInstance','send','events.history','submitFeedback','Event\x20History','apiKey','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','toLocaleString','analysisInterval','updateAnalysisHistory','Last\x20raw\x20event','number','events.history_debug_01','üö®\x20EMERGENCY','analysis.analysisHistory','aiPersona','toFixed','NORMAL','callback','trim','analysis.feedbackHistory','Lernphase\x20(','node-schedule','PARTY','üìç\x20Standort\x20geladen:\x20','toISOString','now','Trigger\x20Analysis','sensorLastValues','getForeignObjectAsync','startExitTimer','Exit-Timer\x20abgelaufen:\x20Keine\x20Bewegung\x20innen\x20erkannt\x20->\x20ABWESEND.','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','\x20was\x20FALSE.\x20Reason:\x20','events.history_debug_00','Feedback\x20Log','needs_improvement','Daily\x20Digests','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','common','.\x20PR√ÑSENZ:\x20','PRO-'];a0_0x5c00=function(){return _0x24d9f6;};return a0_0x5c00();}a0_0x3d65c6();'use strict';const utils=require(a0_0x343305(0x256)),{GoogleGenerativeAI}=require(a0_0x343305(0x22d)),schedule=require(a0_0x343305(0x2b4)),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL=a0_0x343305(0x1e5),ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE=a0_0x343305(0x1e8),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x343305(0x214),LTM_DP_STATUS=a0_0x343305(0x23f),LTM_DP_TRIGGER_DIGEST=a0_0x343305(0x1b0),LTM_DP_BASELINE_STATUS=a0_0x343305(0x260),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x343305(0x222),LTM_DP_DRIFT_DETAILS=a0_0x343305(0x1cb),LTM_DP_DRIFT_LAST_CHECK=a0_0x343305(0x1d7),SYSTEM_DP_MODE='system.mode',MODE_RESET_SCHEDULE=a0_0x343305(0x172),SYSTEM_MODES={'NORMAL':a0_0x343305(0x295),'VACATION':a0_0x343305(0x29b),'PARTY':'party','GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x343305(0x2b5)],SYSTEM_MODES[a0_0x343305(0x1c0)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x343305(0x1c6),'senior_aal':a0_0x343305(0x188),'family':a0_0x343305(0x1c1),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':a0_0x343305(0x1f2)};class CogniLiving extends utils['Adapter']{constructor(_0x15a05b){const _0x554a27=a0_0x343305;super({..._0x15a05b,'name':_0x554a27(0x18b)}),this['eventHistory']=[],this[_0x554a27(0x227)]=[],this[_0x554a27(0x290)]=[],this['rawEventLog']=[],this['dailyDigests']=[],this['sensorLastValues']={},this[_0x554a27(0x25d)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x554a27(0x286)]=!![],this[_0x554a27(0x252)]=null,this[_0x554a27(0x243)]=null,this['isGracePeriodActive']=![],this[_0x554a27(0x1cd)]=null,this[_0x554a27(0x200)]=null,this[_0x554a27(0x26f)]=SYSTEM_MODES[_0x554a27(0x2af)],this['isProVersion']=![],this[_0x554a27(0x1a6)]=![],this['systemUUID']='unknown',this[_0x554a27(0x247)]=null,this[_0x554a27(0x1e0)]=null,this[_0x554a27(0x208)]=null,this[_0x554a27(0x1f1)]=null,this['on']('ready',this[_0x554a27(0x226)]['bind'](this)),this['on']('stateChange',this[_0x554a27(0x23a)]['bind'](this)),this['on'](_0x554a27(0x1c5),this[_0x554a27(0x1da)][_0x554a27(0x1b7)](this)),this['on']('message',this[_0x554a27(0x1ff)][_0x554a27(0x1b7)](this));}async[a0_0x343305(0x226)](){const _0x26d560=a0_0x343305;this['log']['info'](_0x26d560(0x1fc)+this[_0x26d560(0x289)]+')'),await this[_0x26d560(0x216)](),this['config'][_0x26d560(0x1ee)]=this['config'][_0x26d560(0x1ee)]||'',this[_0x26d560(0x263)]=await this[_0x26d560(0x1b5)](this[_0x26d560(0x20e)][_0x26d560(0x1ee)]);if(!this[_0x26d560(0x20e)]['inactivityThresholdHours']||this[_0x26d560(0x20e)][_0x26d560(0x27c)]<0.1)this[_0x26d560(0x20e)]['inactivityThresholdHours']=0xc;await this[_0x26d560(0x268)]();try{const _0x4191b1=await this[_0x26d560(0x164)](_0x26d560(0x231));_0x4191b1&&_0x4191b1[_0x26d560(0x16e)]&&(this[_0x26d560(0x25d)]={'latitude':_0x4191b1[_0x26d560(0x16e)][_0x26d560(0x207)]||0x0,'longitude':_0x4191b1['common']['longitude']||0x0,'city':_0x4191b1[_0x26d560(0x16e)][_0x26d560(0x271)]||''},this[_0x26d560(0x18a)][_0x26d560(0x18c)](_0x26d560(0x2b6)+this[_0x26d560(0x25d)][_0x26d560(0x271)]));}catch(_0x53bfb0){this['log']['warn'](_0x26d560(0x190));}if(this[_0x26d560(0x20e)]['geminiApiKey'])try{this['genAI']=new GoogleGenerativeAI(this['config'][_0x26d560(0x1fe)]),this[_0x26d560(0x200)]=this[_0x26d560(0x1cd)][_0x26d560(0x21f)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x26d560(0x205)}}),this['log'][_0x26d560(0x18c)](_0x26d560(0x258));}catch(_0xce5476){this[_0x26d560(0x18a)][_0x26d560(0x1bc)](_0x26d560(0x175)+_0xce5476[_0x26d560(0x1a9)]);}else this[_0x26d560(0x18a)][_0x26d560(0x203)]('Gemini\x20API\x20Key\x20missing.\x20AI\x20features\x20disabled.');await this[_0x26d560(0x19d)](),await this[_0x26d560(0x19b)](),await this[_0x26d560(0x1b9)](),await this[_0x26d560(0x1bf)](),this['subscribeStates'](_0x26d560(0x189)),this[_0x26d560(0x191)](LTM_DP_TRIGGER_DIGEST),this[_0x26d560(0x191)](_0x26d560(0x26c));const _0x5646c0=this[_0x26d560(0x20e)]['devices'];if(_0x5646c0&&_0x5646c0[_0x26d560(0x1f6)]>0x0){this['log'][_0x26d560(0x18c)]('Subscribing\x20to\x20'+_0x5646c0['length']+_0x26d560(0x22e));for(const _0x238a28 of _0x5646c0){if(_0x238a28['id']){await this[_0x26d560(0x244)](_0x238a28['id']);try{const _0x25fe6f=await this['getForeignStateAsync'](_0x238a28['id']);if(_0x25fe6f)this[_0x26d560(0x163)][_0x238a28['id']]=_0x25fe6f[_0x26d560(0x272)];}catch(_0x5f4b67){}}}}if(this['analysisTimer'])clearInterval(this[_0x26d560(0x247)]);const _0x47a1ce=this[_0x26d560(0x20e)][_0x26d560(0x2a6)]||0xf;_0x47a1ce>0x0&&(this[_0x26d560(0x18a)][_0x26d560(0x18c)]('Starting\x20Autopilot\x20('+_0x47a1ce+_0x26d560(0x283)+this[_0x26d560(0x20e)][_0x26d560(0x27c)]+'h.'),this[_0x26d560(0x247)]=setInterval(()=>this['runAutopilot'](),_0x47a1ce*0x3c*0x3e8)),this[_0x26d560(0x245)](),this['setupModeResetScheduler'](),this[_0x26d560(0x1d9)]();}async['cleanUpZombies'](){const _0x8de546=a0_0x343305,_0x17bcac=['analysis.history_debug_00','analysis.history_debug_01',_0x8de546(0x206),_0x8de546(0x1aa),_0x8de546(0x25a),_0x8de546(0x169),_0x8de546(0x2aa),'events.history_debug_02',_0x8de546(0x1f7),'events.history_debug_04'];for(const _0x2f7676 of _0x17bcac){try{const _0x3fc3f1=await this['getObjectAsync'](_0x2f7676);_0x3fc3f1&&(this[_0x8de546(0x18a)][_0x8de546(0x18c)]('Cleaning\x20up\x20zombie\x20object:\x20'+_0x2f7676),await this[_0x8de546(0x1c7)](_0x2f7676));}catch(_0x1abf2e){}}}async[a0_0x343305(0x268)](){const _0x1363cb=a0_0x343305;try{const _0x40343d=await this[_0x1363cb(0x28a)]('events.history');_0x40343d&&_0x40343d[_0x1363cb(0x272)]&&(this[_0x1363cb(0x198)]=JSON[_0x1363cb(0x1a1)](_0x40343d[_0x1363cb(0x272)]['toString']()),this[_0x1363cb(0x18a)][_0x1363cb(0x18c)](_0x1363cb(0x297)+this[_0x1363cb(0x198)][_0x1363cb(0x1f6)]+'\x20events\x20from\x20history.\x20Last\x20event:\x20'+new Date(this[_0x1363cb(0x198)][0x0]?.[_0x1363cb(0x1fd)])[_0x1363cb(0x2a5)]()));}catch(_0x3096e2){this[_0x1363cb(0x198)]=[];}try{const _0x283dc7=await this['getStateAsync'](_0x1363cb(0x2ac));if(_0x283dc7&&_0x283dc7[_0x1363cb(0x272)])this[_0x1363cb(0x227)]=JSON[_0x1363cb(0x1a1)](_0x283dc7[_0x1363cb(0x272)]['toString']());}catch(_0x568920){this['analysisHistory']=[];}}[a0_0x343305(0x23a)](_0x53c1a8,_0x30cf2e){const _0x565767=a0_0x343305;if(!_0x30cf2e)return;if(_0x53c1a8===this[_0x565767(0x192)]+'.'+SYSTEM_DP_MODE){_0x30cf2e[_0x565767(0x272)]&&Object[_0x565767(0x22b)](SYSTEM_MODES)[_0x565767(0x17a)](_0x30cf2e[_0x565767(0x272)])&&(this[_0x565767(0x26f)]=_0x30cf2e[_0x565767(0x272)],_0x30cf2e[_0x565767(0x272)]===SYSTEM_MODES['VACATION']?this[_0x565767(0x25c)](![]):this[_0x565767(0x25c)](!![]));if(!_0x30cf2e[_0x565767(0x261)])this[_0x565767(0x28c)](_0x53c1a8,{'val':this[_0x565767(0x26f)],'ack':!![]});return;}if(!_0x30cf2e[_0x565767(0x261)]){_0x53c1a8[_0x565767(0x17a)](_0x565767(0x189))&&_0x30cf2e[_0x565767(0x272)]&&(this['setState'](_0x53c1a8,{'val':![],'ack':!![]}),this[_0x565767(0x27e)]());if(_0x53c1a8[_0x565767(0x17a)](_0x565767(0x275))&&_0x30cf2e[_0x565767(0x272)]){this[_0x565767(0x28c)](_0x53c1a8,{'val':![],'ack':!![]});if(this[_0x565767(0x263)])this[_0x565767(0x259)]();}return;}const _0xe9c2cf=(this[_0x565767(0x20e)]['devices']||[])[_0x565767(0x218)](_0xe559e2=>_0xe559e2['id']===_0x53c1a8);if(_0xe9c2cf)this['processSensorEvent'](_0x53c1a8,_0x30cf2e,_0xe9c2cf);}async['processSensorEvent'](_0x4bc234,_0x32c72a,_0x1df6af){const _0xd26bb6=a0_0x343305;if(!_0x1df6af[_0xd26bb6(0x173)]&&this['sensorLastValues'][_0x4bc234]===_0x32c72a['val'])return;this[_0xd26bb6(0x163)][_0x4bc234]=_0x32c72a[_0xd26bb6(0x272)];if(this[_0xd26bb6(0x28d)]){this[_0xd26bb6(0x18a)]['debug'](_0xd26bb6(0x201)+_0x1df6af[_0xd26bb6(0x24a)]);return;}const _0x45ff68=_0x1df6af[_0xd26bb6(0x1eb)]===_0xd26bb6(0x1e7)&&(_0x1df6af[_0xd26bb6(0x24a)][_0xd26bb6(0x26b)]()[_0xd26bb6(0x17a)](_0xd26bb6(0x1c3))||_0x1df6af[_0xd26bb6(0x24a)]['toLowerCase']()[_0xd26bb6(0x17a)]('eingang')||_0x1df6af[_0xd26bb6(0x284)][_0xd26bb6(0x26b)]()[_0xd26bb6(0x17a)](_0xd26bb6(0x1df)));_0x45ff68&&!_0x32c72a[_0xd26bb6(0x272)]?this['startExitTimer']():(this[_0xd26bb6(0x252)]&&(this['log']['info'](_0xd26bb6(0x17c)),this[_0xd26bb6(0x254)]()),!this[_0xd26bb6(0x286)]&&this['currentSystemMode']===SYSTEM_MODES[_0xd26bb6(0x2af)]&&this[_0xd26bb6(0x25c)](!![]));const _0x163b84={'timestamp':_0x32c72a['ts'],'id':_0x4bc234,'name':_0x1df6af['name'],'value':_0x32c72a['val'],'location':_0x1df6af[_0xd26bb6(0x284)],'type':_0x1df6af[_0xd26bb6(0x1eb)]};this['eventHistory'][_0xd26bb6(0x25b)](_0x163b84);if(this['eventHistory'][_0xd26bb6(0x1f6)]>HISTORY_MAX_SIZE)this['eventHistory']['pop']();await this['setStateAsync']('events.lastEvent',{'val':JSON['stringify'](_0x163b84),'ack':!![]}),await this[_0xd26bb6(0x26a)]('events.history',{'val':JSON['stringify'](this[_0xd26bb6(0x198)]),'ack':!![]}),this['rawEventLog'][_0xd26bb6(0x20d)]({'timestamp':new Date(_0x32c72a['ts'])[_0xd26bb6(0x2b7)](),'sensorName':_0x1df6af[_0xd26bb6(0x24a)],'location':_0x1df6af[_0xd26bb6(0x284)],'value':_0x32c72a[_0xd26bb6(0x272)]}),await this[_0xd26bb6(0x21c)]();}[a0_0x343305(0x165)](){const _0x392ce9=a0_0x343305;this['log'][_0x392ce9(0x18c)](_0x392ce9(0x29d)),this['abortExitTimer'](),this[_0x392ce9(0x28d)]=!![],this['exitGraceTimer']=setTimeout(()=>{const _0x4fbee7=_0x392ce9;this[_0x4fbee7(0x28d)]=![],this[_0x4fbee7(0x18a)][_0x4fbee7(0x1a3)](_0x4fbee7(0x178));},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x392ce9(0x252)]=setTimeout(()=>{const _0x1ac104=_0x392ce9;this[_0x1ac104(0x18a)][_0x1ac104(0x18c)](_0x1ac104(0x166)),this['setPresence'](![]),this[_0x1ac104(0x252)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x343305(0x254)](){const _0x2e9af9=a0_0x343305;if(this[_0x2e9af9(0x252)])clearTimeout(this['exitTimer']);if(this[_0x2e9af9(0x243)])clearTimeout(this[_0x2e9af9(0x243)]);this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x2e9af9(0x28d)]=![];}async[a0_0x343305(0x25c)](_0x4ace74){const _0x6277ea=a0_0x343305;if(this[_0x6277ea(0x286)]===_0x4ace74)return;this[_0x6277ea(0x286)]=_0x4ace74,await this['setStateAsync'](_0x6277ea(0x221),{'val':_0x4ace74,'ack':!![]}),this[_0x6277ea(0x18a)][_0x6277ea(0x18c)](_0x6277ea(0x1a8)+(_0x4ace74?'ANWESEND\x20üè†':'ABWESEND\x20‚úàÔ∏è'));}[a0_0x343305(0x1d4)](){const _0x2686ee=a0_0x343305,_0x42115c=this['config'][_0x2686ee(0x27c)],_0x188d4e=this[_0x2686ee(0x20e)][_0x2686ee(0x1ca)],_0x36acef=this['eventHistory'][_0x2686ee(0x1f6)]>0x0?this[_0x2686ee(0x198)][0x0][_0x2686ee(0x1fd)]:Date[_0x2686ee(0x2b8)](),_0x7c3af9=(Date[_0x2686ee(0x2b8)]()-_0x36acef)/(0x3e8*0x3c*0x3c);let _0xd8692='';if(_0x188d4e&&this['currentSystemMode']===SYSTEM_MODES['NORMAL']&&this['isPresent'])_0x7c3af9>_0x42115c&&(this['log']['warn'](_0x2686ee(0x1a5)+_0x7c3af9['toFixed'](0x1)+_0x2686ee(0x171)),_0xd8692=_0x2686ee(0x16d)+_0x7c3af9[_0x2686ee(0x2ae)](0x1)+_0x2686ee(0x167));else{if(!this[_0x2686ee(0x286)]){}}if(_0xd8692){this[_0x2686ee(0x27e)](_0xd8692)[_0x2686ee(0x202)](_0x22b229=>this[_0x2686ee(0x18a)][_0x2686ee(0x1bc)](_0x22b229));return;}const _0x463045=Date[_0x2686ee(0x2b8)](),_0x4f2a03=_0x463045-_0x36acef,_0x226a07=(this['config'][_0x2686ee(0x2a6)]||0xf)*0x3c*0x3e8;this[_0x2686ee(0x198)][_0x2686ee(0x1f6)]>0x0&&_0x4f2a03<=_0x226a07?this[_0x2686ee(0x27e)]()[_0x2686ee(0x202)](_0x53e279=>this[_0x2686ee(0x18a)]['error'](_0x53e279)):!this[_0x2686ee(0x1a6)]&&(this[_0x2686ee(0x28c)](_0x2686ee(0x24f),{'val':![],'ack':!![]}),this[_0x2686ee(0x28c)](_0x2686ee(0x240),{'val':![],'ack':!![]}));}async['runGeminiAnalysis'](_0x467ff3=''){const _0x358a00=a0_0x343305;if(!this[_0x358a00(0x200)])return;const _0xe4cf29=this['eventHistory']['length']>0x0?this[_0x358a00(0x198)]:[{'note':_0x358a00(0x250)}],_0x511c11=PERSONA_MAPPING[this[_0x358a00(0x20e)][_0x358a00(0x2ad)]||'generic'],_0xe87a6b=this[_0x358a00(0x20e)]['livingContext']||'',_0x262790=this[_0x358a00(0x26f)],_0x1b6b1f=new Date(),_0x4828ab=_0x1b6b1f['toLocaleString'](_0x358a00(0x1c9),{'weekday':'long','hour':_0x358a00(0x1d5),'minute':_0x358a00(0x1d5)}),_0x2d7a7d=this[_0x358a00(0x25d)];let _0x49d37d='';if(this[_0x358a00(0x290)][_0x358a00(0x1f6)]>0x0){const _0x13bf6c=this[_0x358a00(0x290)][_0x358a00(0x274)](_0x286332=>_0x286332[_0x358a00(0x276)]==='false_positive'||_0x286332[_0x358a00(0x276)]===_0x358a00(0x16b))[_0x358a00(0x293)](0x0,0x3)[_0x358a00(0x236)](_0x8eb656=>'-\x20User\x20Feedback:\x20Alarm\x20\x22'+_0x8eb656['alertReason']+'\x22\x20at\x20'+new Date(_0x8eb656[_0x358a00(0x1fd)])[_0x358a00(0x1b3)]()+_0x358a00(0x168)+(_0x8eb656[_0x358a00(0x23b)]||'No\x20comment')+'.')['join']('\x0a');_0x13bf6c&&(_0x49d37d=_0x358a00(0x1dd)+_0x13bf6c+'\x0a');}const _0x20e773=_0x467ff3?'\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a'+_0x467ff3+_0x358a00(0x285):'',_0x582ed6=_0x358a00(0x248),_0x2e62f5=_0x358a00(0x180)+_0x4828ab+_0x358a00(0x230)+_0x2d7a7d[_0x358a00(0x271)]+_0x358a00(0x2a4)+_0x262790+_0x358a00(0x16f)+(this[_0x358a00(0x286)]?'Ja':_0x358a00(0x1ef))+_0x358a00(0x1e4)+_0xe87a6b+_0x358a00(0x29a)+_0x511c11+_0x358a00(0x23d)+_0x582ed6+'\x20'+_0x49d37d+'\x20'+_0x20e773+_0x358a00(0x28f)+JSON[_0x358a00(0x24c)](_0xe4cf29)+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20}\x20}';try{const _0x5a9d89=await this[_0x358a00(0x200)][_0x358a00(0x298)](_0x2e62f5),_0x2c1b4c=_0x5a9d89[_0x358a00(0x21d)][_0x358a00(0x209)]()['replace'](/```json|```/g,'')['trim'](),_0x32f262=JSON[_0x358a00(0x1a1)](_0x2c1b4c);await this[_0x358a00(0x26a)](_0x358a00(0x18d),{'val':_0x2c1b4c,'ack':!![]}),await this[_0x358a00(0x26a)]('analysis.alertReason',{'val':_0x32f262[_0x358a00(0x241)][_0x358a00(0x184)]||'','ack':!![]}),await this['setStateAsync'](_0x358a00(0x296),{'val':_0x32f262[_0x358a00(0x241)][_0x358a00(0x182)]||_0x358a00(0x1b6),'ack':!![]});const _0x32d6b3=_0x32f262[_0x358a00(0x241)]['isAlert']||![],_0x345a71=_0x32f262[_0x358a00(0x241)][_0x358a00(0x212)]||![];if(_0x32d6b3||_0x345a71){await this['setStateAsync'](_0x358a00(0x24f),{'val':!![],'ack':!![]}),await this[_0x358a00(0x26a)]('analysis.isEmergency',{'val':_0x345a71,'ack':!![]});if(!this[_0x358a00(0x1a6)]||_0x345a71){const _0x151b01=_0x345a71?_0x358a00(0x281):'‚ö†Ô∏è\x20Alarm';this[_0x358a00(0x20b)](_0x151b01+':\x20'+_0x32f262[_0x358a00(0x241)][_0x358a00(0x184)],![],_0x345a71);}}else await this[_0x358a00(0x26a)]('analysis.isAlert',{'val':![],'ack':!![]}),await this['setStateAsync'](_0x358a00(0x240),{'val':![],'ack':!![]});this[_0x358a00(0x1a6)]=_0x32d6b3||_0x345a71;}catch(_0x15cc1e){this[_0x358a00(0x18a)][_0x358a00(0x1bc)](_0x358a00(0x1cc)+_0x15cc1e[_0x358a00(0x1a9)]);}}async[a0_0x343305(0x259)](){const _0x4cc106=a0_0x343305;if(!this['isProVersion'])return;await this[_0x4cc106(0x26a)](LTM_DP_STATUS,{'val':_0x4cc106(0x1ac)+new Date()['toLocaleString'](),'ack':!![]});if(!this['geminiModel']||this[_0x4cc106(0x27a)][_0x4cc106(0x1f6)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x4cc106(0x26a)](LTM_DP_STATUS,{'val':_0x4cc106(0x1a2),'ack':!![]});return;}const _0x4c5794=JSON[_0x4cc106(0x1a1)](JSON[_0x4cc106(0x24c)](this[_0x4cc106(0x27a)])),_0x182fd7=(this[_0x4cc106(0x20e)]['livingContext']||'')[_0x4cc106(0x17f)](0x0,0x3e8),_0x5413ff=_0x4cc106(0x24e)+_0x182fd7+'.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON['stringify'](_0x4c5794);try{const _0x6b94c3=await this[_0x4cc106(0x200)][_0x4cc106(0x298)](_0x5413ff),_0x49ef34=JSON[_0x4cc106(0x1a1)](_0x6b94c3[_0x4cc106(0x21d)][_0x4cc106(0x209)]()[_0x4cc106(0x199)](/```json|```/g,'')[_0x4cc106(0x2b1)]());_0x49ef34[_0x4cc106(0x182)]&&(this['dailyDigests'][_0x4cc106(0x20d)]({'timestamp':new Date()['toISOString'](),'eventCount':_0x4c5794[_0x4cc106(0x1f6)],'summary':_0x49ef34['summary'],'activityLevel':_0x49ef34[_0x4cc106(0x204)],'systemMode':this[_0x4cc106(0x26f)]}),await this[_0x4cc106(0x28b)](),this[_0x4cc106(0x27a)]=[],await this[_0x4cc106(0x21c)](),await this[_0x4cc106(0x26a)](LTM_DP_STATUS,{'val':_0x4cc106(0x211)+_0x4c5794['length']+'\x20events','ack':!![]}));}catch(_0x28108d){await this[_0x4cc106(0x26a)](LTM_DP_STATUS,{'val':_0x4cc106(0x24b)+_0x28108d[_0x4cc106(0x1a9)],'ack':!![]});}}async[a0_0x343305(0x19d)](){const _0x7faf9f=a0_0x343305;await this[_0x7faf9f(0x234)](),await this['setObjectNotExistsAsync'](_0x7faf9f(0x221),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x177),'type':_0x7faf9f(0x186),'role':_0x7faf9f(0x225),'read':!![],'write':![],'def':!![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x7faf9f(0x1e9),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x2a8),'type':_0x7faf9f(0x246),'role':_0x7faf9f(0x264),'read':!![],'write':![]},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x2a0),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x2a2),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x189),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x162),'type':_0x7faf9f(0x186),'role':_0x7faf9f(0x1d0),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x7faf9f(0x18d),{'type':'state','common':{'name':_0x7faf9f(0x17b),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x24f),{'type':'state','common':{'name':_0x7faf9f(0x19e),'type':_0x7faf9f(0x186),'role':_0x7faf9f(0x20c),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x7faf9f(0x22a)]('analysis.isEmergency',{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x235),'type':_0x7faf9f(0x186),'role':_0x7faf9f(0x1e1),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x19a),{'type':_0x7faf9f(0x25e),'common':{'name':'Alert\x20Reason','type':'string','role':_0x7faf9f(0x1f5),'read':!![],'write':![]},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x296),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x232),'type':_0x7faf9f(0x246),'role':_0x7faf9f(0x209),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x7faf9f(0x27f),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x1ec),'type':'string','role':'state','read':!![],'write':![],'def':_0x7faf9f(0x1b6)},'native':{}}),await this['setObjectNotExistsAsync'](_0x7faf9f(0x1b4),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x21b),'type':_0x7faf9f(0x246),'role':_0x7faf9f(0x209),'read':!![],'write':![]},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x21e),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x262),'type':_0x7faf9f(0x246),'role':_0x7faf9f(0x209),'read':!![],'write':![]},'native':{}}),await this[_0x7faf9f(0x223)](_0x7faf9f(0x1ce),{'type':'channel','common':{'name':_0x7faf9f(0x24d)},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x21a),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x187),'type':_0x7faf9f(0x186),'role':_0x7faf9f(0x225),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x7faf9f(0x22a)]('analysis.automation.description',{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x215),'type':_0x7faf9f(0x246),'role':_0x7faf9f(0x209),'read':!![],'write':![]},'native':{}}),await this[_0x7faf9f(0x22a)]('analysis.automation.suggestedAction',{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x238),'type':'string','role':_0x7faf9f(0x209),'read':!![],'write':![]},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x2ac),{'type':'state','common':{'name':'Logbook','type':'string','role':_0x7faf9f(0x264),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x7faf9f(0x22a)](_0x7faf9f(0x2b2),{'type':_0x7faf9f(0x25e),'common':{'name':_0x7faf9f(0x16a),'type':_0x7faf9f(0x246),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x7faf9f(0x1dc)](),await this['checkLtmDriftObjects']();}async[a0_0x343305(0x234)](){const _0x39b499=a0_0x343305;await this['extendObjectAsync'](_0x39b499(0x176),{'type':_0x39b499(0x1d2),'common':{'name':_0x39b499(0x292)},'native':{}}),await this[_0x39b499(0x223)](SYSTEM_DP_MODE,{'type':_0x39b499(0x25e),'common':{'name':_0x39b499(0x1de),'type':_0x39b499(0x246),'role':_0x39b499(0x25e),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x39b499(0x2af)],'states':{[SYSTEM_MODES['NORMAL']]:'Normal',[SYSTEM_MODES['VACATION']]:'Urlaub',[SYSTEM_MODES[_0x39b499(0x2b5)]]:_0x39b499(0x1c8),[SYSTEM_MODES[_0x39b499(0x1c0)]]:_0x39b499(0x291)}},'native':{}});}async[a0_0x343305(0x20b)](_0xe7c422,_0x5088e4=![],_0x122b16=![]){const _0x3bacab=a0_0x343305;this[_0x3bacab(0x18a)][_0x3bacab(0x18c)]((_0x5088e4?_0x3bacab(0x174):'')+_0x3bacab(0x193)+_0xe7c422+'\x22'+(_0x122b16?_0x3bacab(0x1b8):''));const _0x1a6d82=this[_0x3bacab(0x20e)];let _0x2c28c=0x0;_0x1a6d82[_0x3bacab(0x1cf)]&&_0x1a6d82[_0x3bacab(0x277)]&&(await this[_0x3bacab(0x253)](_0x1a6d82[_0x3bacab(0x277)],_0x3bacab(0x29f),{'text':_0xe7c422,'user':_0x1a6d82[_0x3bacab(0x1fa)]}),_0x2c28c++);if(_0x1a6d82[_0x3bacab(0x22f)]&&_0x1a6d82['notifyPushoverInstance']){let _0x20f469={'message':_0xe7c422,'title':_0x122b16?_0x3bacab(0x2ab):_0x3bacab(0x237),'priority':_0x122b16?0x2:0x1,'device':_0x1a6d82[_0x3bacab(0x181)]};_0x122b16&&(_0x20f469['retry']=0x1e,_0x20f469[_0x3bacab(0x210)]=0xe10,_0x20f469[_0x3bacab(0x1af)]=_0x3bacab(0x1ad)),await this[_0x3bacab(0x253)](_0x1a6d82[_0x3bacab(0x1f3)],'send',_0x20f469),_0x2c28c++;}return _0x1a6d82[_0x3bacab(0x229)]&&_0x1a6d82[_0x3bacab(0x29e)]&&(await this[_0x3bacab(0x253)](_0x1a6d82['notifyEmailInstance'],_0x3bacab(0x29f),{'text':_0xe7c422,'to':_0x1a6d82['notifyEmailRecipient']}),_0x2c28c++),_0x1a6d82['notifyWhatsappEnabled']&&_0x1a6d82[_0x3bacab(0x20a)]&&(await this['sendToAsync'](_0x1a6d82[_0x3bacab(0x20a)],_0x3bacab(0x29f),{'text':_0xe7c422,'phone':_0x1a6d82[_0x3bacab(0x267)]}),_0x2c28c++),_0x1a6d82[_0x3bacab(0x185)]&&_0x1a6d82['notifySignalInstance']&&(await this['sendToAsync'](_0x1a6d82[_0x3bacab(0x1f4)],_0x3bacab(0x29f),{'text':_0xe7c422,'phone':_0x1a6d82[_0x3bacab(0x1f8)]}),_0x2c28c++),_0x2c28c;}async[a0_0x343305(0x1b9)](){const _0x205b1b=a0_0x343305;try{const _0x23cbc4=await this[_0x205b1b(0x28a)](LTM_DP_RAW_LOG);if(_0x23cbc4&&_0x23cbc4[_0x205b1b(0x272)])this['rawEventLog']=JSON[_0x205b1b(0x1a1)](_0x23cbc4[_0x205b1b(0x272)]);}catch(_0x2519e5){this['rawEventLog']=[];}}async[a0_0x343305(0x21c)](){const _0x4e61b7=a0_0x343305;this['rawEventLog']['length']>RAW_LOG_MAX_SIZE&&this[_0x4e61b7(0x27a)][_0x4e61b7(0x25f)](0x0,this[_0x4e61b7(0x27a)][_0x4e61b7(0x1f6)]-RAW_LOG_MAX_SIZE),await this[_0x4e61b7(0x26a)](LTM_DP_RAW_LOG,{'val':JSON[_0x4e61b7(0x24c)](this['rawEventLog']),'ack':!![]});}async[a0_0x343305(0x1bf)](){const _0x370772=a0_0x343305;try{const _0x3a2a32=await this[_0x370772(0x28a)](LTM_DP_DAILY_DIGESTS);if(_0x3a2a32&&_0x3a2a32[_0x370772(0x272)])this[_0x370772(0x249)]=JSON['parse'](_0x3a2a32[_0x370772(0x272)]);}catch(_0x5aeedd){this['dailyDigests']=[];}await this[_0x370772(0x266)]();}async[a0_0x343305(0x28b)](_0x4c08a0=!![]){const _0x1a0370=a0_0x343305,_0x324134=this[_0x1a0370(0x20e)][_0x1a0370(0x278)]||0x3c;this[_0x1a0370(0x249)][_0x1a0370(0x1f6)]>_0x324134&&this[_0x1a0370(0x249)]['splice'](0x0,this[_0x1a0370(0x249)][_0x1a0370(0x1f6)]-_0x324134);await this['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1a0370(0x24c)](this['dailyDigests']),'ack':!![]});if(_0x4c08a0)await this[_0x1a0370(0x266)]();}[a0_0x343305(0x245)](){const _0x431675=a0_0x343305;if(this[_0x431675(0x1e0)])this[_0x431675(0x1e0)][_0x431675(0x228)]();if(!this[_0x431675(0x263)]){this[_0x431675(0x26a)](LTM_DP_STATUS,{'val':_0x431675(0x299),'ack':!![]});return;}this['ltmJob']=schedule[_0x431675(0x288)](LTM_SCHEDULE,()=>this[_0x431675(0x259)]());}[a0_0x343305(0x1d9)](){const _0x4c71a6=a0_0x343305;if(this[_0x4c71a6(0x1f1)])clearInterval(this[_0x4c71a6(0x1f1)]);if(!this[_0x4c71a6(0x263)])return;this[_0x4c71a6(0x1f1)]=setInterval(()=>this[_0x4c71a6(0x195)](),(this['config'][_0x4c71a6(0x1ea)]||0x18)*0x36ee80),setTimeout(()=>this['runBaselineDriftAnalysis'](),0x1388);}async[a0_0x343305(0x1ed)](){const _0x1d83c9=a0_0x343305;await this[_0x1d83c9(0x26a)](_0x1d83c9(0x296),{'val':_0x1d83c9(0x1e6),'ack':!![]}),await this[_0x1d83c9(0x26a)](_0x1d83c9(0x27f),{'val':this[_0x1d83c9(0x263)]?'N/A\x20(No\x20Activity)':_0x1d83c9(0x233),'ack':!![]}),await this[_0x1d83c9(0x26a)](_0x1d83c9(0x24f),{'val':![],'ack':!![]}),await this['setStateAsync']('analysis.isEmergency',{'val':![],'ack':!![]}),this[_0x1d83c9(0x1a6)]=![];}async[a0_0x343305(0x2a7)](_0x1a2eb1){const _0x2cc7f8=a0_0x343305;this[_0x2cc7f8(0x227)][_0x2cc7f8(0x25b)](_0x1a2eb1);if(this[_0x2cc7f8(0x227)][_0x2cc7f8(0x1f6)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x2cc7f8(0x227)]['pop']();await this['setStateAsync'](_0x2cc7f8(0x2ac),{'val':JSON[_0x2cc7f8(0x24c)](this[_0x2cc7f8(0x227)]),'ack':!![]});}[a0_0x343305(0x217)](){const _0x1aa0a2=a0_0x343305;if(this[_0x1aa0a2(0x208)])this[_0x1aa0a2(0x208)][_0x1aa0a2(0x228)]();this[_0x1aa0a2(0x208)]=schedule[_0x1aa0a2(0x288)](MODE_RESET_SCHEDULE,async()=>{const _0x233d39=_0x1aa0a2;await this[_0x233d39(0x19b)](),AUTO_RESET_MODES[_0x233d39(0x17a)](this[_0x233d39(0x26f)])&&await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}async[a0_0x343305(0x266)](){const _0xce82a4=a0_0x343305;if(!this[_0xce82a4(0x263)]){await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0xce82a4(0x299),'ack':!![]});return;}const _0x736a01=this[_0xce82a4(0x249)][_0xce82a4(0x1f6)]>=(this[_0xce82a4(0x20e)][_0xce82a4(0x282)]||0x7)?_0xce82a4(0x19f)+this[_0xce82a4(0x249)][_0xce82a4(0x1f6)]+_0xce82a4(0x196):_0xce82a4(0x2b3)+this[_0xce82a4(0x249)]['length']+'/'+(this['config'][_0xce82a4(0x282)]||0x7)+')';await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x736a01,'ack':!![]});}async[a0_0x343305(0x1dc)](){const _0xb5793d=a0_0x343305;await this[_0xb5793d(0x223)]('LTM',{'type':_0xb5793d(0x1d2),'common':{'name':'LTM'},'native':{}}),await this[_0xb5793d(0x223)](LTM_DP_RAW_LOG,{'type':_0xb5793d(0x25e),'common':{'name':_0xb5793d(0x27b),'type':_0xb5793d(0x246),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0xb5793d(0x223)](LTM_DP_DAILY_DIGESTS,{'type':_0xb5793d(0x25e),'common':{'name':_0xb5793d(0x16c),'type':_0xb5793d(0x246),'role':'json','read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_STATUS,{'type':_0xb5793d(0x25e),'common':{'name':_0xb5793d(0x27d),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await this[_0xb5793d(0x223)](LTM_DP_TRIGGER_DIGEST,{'type':_0xb5793d(0x25e),'common':{'name':_0xb5793d(0x270),'type':'boolean','role':_0xb5793d(0x1d0),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0xb5793d(0x223)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':_0xb5793d(0x1c2),'type':_0xb5793d(0x246),'role':_0xb5793d(0x209),'read':!![],'write':![]},'native':{}});}async[a0_0x343305(0x1a0)](){const _0x110bb0=a0_0x343305;await this['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x110bb0(0x1d2),'common':{'name':'Drift\x20Analysis'},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x110bb0(0x220),'type':_0x110bb0(0x246),'role':_0x110bb0(0x25e),'read':!![],'write':![],'def':_0x110bb0(0x1b6)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x110bb0(0x25e),'common':{'name':_0x110bb0(0x20f),'type':'string','role':_0x110bb0(0x209),'read':!![],'write':![]},'native':{}}),await this[_0x110bb0(0x223)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x110bb0(0x25e),'common':{'name':_0x110bb0(0x219),'type':_0x110bb0(0x2a9),'role':'date','read':!![],'write':![]},'native':{}});}async[a0_0x343305(0x195)](){const _0x19cea6=a0_0x343305;if(!this[_0x19cea6(0x263)]||!this[_0x19cea6(0x200)])return;const _0x35534b=this[_0x19cea6(0x20e)][_0x19cea6(0x28e)]||0xe;if(this['dailyDigests'][_0x19cea6(0x1f6)]<_0x35534b+(this[_0x19cea6(0x20e)][_0x19cea6(0x282)]||0x7)){await this[_0x19cea6(0x26a)](LTM_DP_DRIFT_STATUS,{'val':_0x19cea6(0x23c),'ack':!![]});return;}const _0x362afd=this[_0x19cea6(0x249)][_0x19cea6(0x293)](-_0x35534b),_0x16b428=this[_0x19cea6(0x249)][_0x19cea6(0x293)](0x0,this[_0x19cea6(0x249)]['length']-_0x35534b),_0x3e3949=_0x19cea6(0x197)+JSON['stringify'](_0x16b428)+_0x19cea6(0x29c)+JSON[_0x19cea6(0x24c)](_0x362afd);try{const _0x77686e=await this[_0x19cea6(0x200)][_0x19cea6(0x298)](_0x3e3949),_0x594e09=JSON[_0x19cea6(0x1a1)](_0x77686e[_0x19cea6(0x21d)][_0x19cea6(0x209)]()['replace'](/```json|```/g,'')['trim']());_0x594e09[_0x19cea6(0x1b2)]&&(await this[_0x19cea6(0x26a)](LTM_DP_DRIFT_STATUS,{'val':_0x594e09[_0x19cea6(0x1b2)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x594e09[_0x19cea6(0x280)],'ack':!![]}),await this[_0x19cea6(0x26a)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x19cea6(0x2b8)](),'ack':!![]}));}catch(_0x599d01){}}async[a0_0x343305(0x19b)](){const _0x1e63cd=a0_0x343305;try{const _0x2c54eb=await this[_0x1e63cd(0x28a)](SYSTEM_DP_MODE);_0x2c54eb&&_0x2c54eb[_0x1e63cd(0x272)]&&Object[_0x1e63cd(0x22b)](SYSTEM_MODES)[_0x1e63cd(0x17a)](_0x2c54eb[_0x1e63cd(0x272)])?this[_0x1e63cd(0x26f)]=_0x2c54eb[_0x1e63cd(0x272)]:(this[_0x1e63cd(0x26f)]=SYSTEM_MODES[_0x1e63cd(0x2af)],await this[_0x1e63cd(0x26a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1e63cd(0x2af)],'ack':!![]}));}catch(_0x51f3e2){this[_0x1e63cd(0x26f)]=SYSTEM_MODES[_0x1e63cd(0x2af)];}}async[a0_0x343305(0x179)](){const _0x33bec5=a0_0x343305;try{const _0x14dbf0=await this[_0x33bec5(0x164)](_0x33bec5(0x1f0));if(_0x14dbf0&&_0x14dbf0[_0x33bec5(0x194)]&&_0x14dbf0[_0x33bec5(0x194)][_0x33bec5(0x242)])return _0x14dbf0['native']['uuid'];return _0x33bec5(0x1fb);}catch(_0x381f19){return _0x33bec5(0x1db);}}async[a0_0x343305(0x1b5)](_0x3e13ac){const _0x1883ba=a0_0x343305;if(!_0x3e13ac)return![];this['systemUUID']=await this['getSystemUUID']();if(_0x3e13ac===_0x1883ba(0x1d3)||_0x3e13ac[_0x1883ba(0x273)](_0x1883ba(0x170)))return!![];return![];}['onUnload'](_0x59cb7e){const _0x4e7ac9=a0_0x343305;if(this[_0x4e7ac9(0x247)])clearInterval(this[_0x4e7ac9(0x247)]);if(this[_0x4e7ac9(0x1f1)])clearInterval(this['driftAnalysisTimer']);if(this[_0x4e7ac9(0x1e0)])this[_0x4e7ac9(0x1e0)]['cancel']();if(this[_0x4e7ac9(0x208)])this[_0x4e7ac9(0x208)][_0x4e7ac9(0x228)]();if(this['exitTimer'])clearTimeout(this[_0x4e7ac9(0x252)]);if(this[_0x4e7ac9(0x243)])clearTimeout(this[_0x4e7ac9(0x243)]);_0x59cb7e();}async[a0_0x343305(0x1ff)](_0x58f60c){const _0x16123e=a0_0x343305;if(typeof _0x58f60c==='object'&&_0x58f60c['message']){if(_0x58f60c[_0x16123e(0x1a7)]===_0x16123e(0x17e)){if(!_0x58f60c[_0x16123e(0x1a9)][_0x16123e(0x2a3)])return this['sendTo'](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':![],'message':_0x16123e(0x1d1)},_0x58f60c[_0x16123e(0x2b0)]);try{const _0x5ade21=new GoogleGenerativeAI(_0x58f60c[_0x16123e(0x1a9)]['apiKey'])[_0x16123e(0x21f)]({'model':_0x16123e(0x1e5)});await _0x5ade21[_0x16123e(0x298)](_0x16123e(0x17d)),this[_0x16123e(0x1b1)](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':!![],'message':_0x16123e(0x1d8)},_0x58f60c[_0x16123e(0x2b0)]);}catch(_0x2cf045){this[_0x16123e(0x1b1)](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':![],'message':_0x2cf045['message']},_0x58f60c[_0x16123e(0x2b0)]);}}else{if(_0x58f60c[_0x16123e(0x1a7)]===_0x16123e(0x1a4)){const _0x3a0e9b=await this['sendNotification'](_0x16123e(0x1bb),!![]);this[_0x16123e(0x1b1)](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':_0x3a0e9b>0x0,'message':_0x3a0e9b+'\x20sent'},_0x58f60c['callback']);}else{if(_0x58f60c['command']===_0x16123e(0x1ba)){if(!this[_0x16123e(0x263)])return this[_0x16123e(0x1b1)](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':![],'isPro':![]},_0x58f60c['callback']);let _0x1925ac={'status':_0x16123e(0x1b6),'details':'','lastCheck':0x0};try{_0x1925ac[_0x16123e(0x23e)]=(await this[_0x16123e(0x28a)](LTM_DP_DRIFT_STATUS))[_0x16123e(0x272)],_0x1925ac[_0x16123e(0x18e)]=(await this[_0x16123e(0x28a)](LTM_DP_DRIFT_DETAILS))[_0x16123e(0x272)],_0x1925ac[_0x16123e(0x22c)]=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0xb6bf6b){}this[_0x16123e(0x1b1)](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x16123e(0x249)],'driftAnalysis':_0x1925ac,'analysisHistory':this[_0x16123e(0x227)]},_0x58f60c[_0x16123e(0x2b0)]);}else{if(_0x58f60c['command']===_0x16123e(0x26d)){const _0x4d189d=await this['getForeignObjectsAsync'](_0x16123e(0x1bd),_0x16123e(0x1ab)),_0x55e68f=[];if(_0x4d189d)for(const _0x30d63a in _0x4d189d){const _0x182b04=_0x4d189d[_0x30d63a],_0x596d76=(_0x182b04['common']&&typeof _0x182b04[_0x16123e(0x16e)]['name']===_0x16123e(0x1e3)?_0x182b04['common'][_0x16123e(0x24a)]['de']:_0x182b04['common'][_0x16123e(0x24a)])||_0x182b04[_0x16123e(0x16e)][_0x16123e(0x24a)];_0x55e68f['push']({'id':_0x30d63a,'name':_0x596d76});}this[_0x16123e(0x1b1)](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':!![],'enums':_0x55e68f},_0x58f60c[_0x16123e(0x2b0)]);}else{if(_0x58f60c[_0x16123e(0x1a7)]==='scanDevices'){this['log'][_0x16123e(0x18c)](_0x16123e(0x18f));const _0x175a3b=_0x58f60c['message']||{};try{const _0x1a69c9=await this[_0x16123e(0x265)](_0x175a3b);this['sendTo'](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':!![],'devices':_0x1a69c9},_0x58f60c[_0x16123e(0x2b0)]);}catch(_0x21f0cd){this[_0x16123e(0x1b1)](_0x58f60c['from'],_0x58f60c[_0x16123e(0x1a7)],{'success':![],'error':_0x21f0cd['message']},_0x58f60c[_0x16123e(0x2b0)]);}}else{if(_0x58f60c[_0x16123e(0x1a7)]===_0x16123e(0x2a1)){const {historyId:_0x5662a3,rating:_0x1a8ba7,comment:_0x3bc7a8,alertReason:_0x3b0f20}=_0x58f60c['message'];_0x5662a3&&_0x1a8ba7?(await this['saveFeedback']({'timestamp':Date[_0x16123e(0x2b8)](),'historyId':_0x5662a3,'rating':_0x1a8ba7,'comment':_0x3bc7a8,'alertReason':_0x3b0f20}),this[_0x16123e(0x1b1)](_0x58f60c['from'],_0x58f60c[_0x16123e(0x1a7)],{'success':!![]},_0x58f60c['callback'])):this['sendTo'](_0x58f60c[_0x16123e(0x1f9)],_0x58f60c[_0x16123e(0x1a7)],{'success':![],'error':_0x16123e(0x255)},_0x58f60c[_0x16123e(0x2b0)]);}}}}}}}}}if(require[a0_0x343305(0x294)]!==module)module[a0_0x343305(0x19c)]=_0x3d1b2e=>new CogniLiving(_0x3d1b2e);else new CogniLiving();