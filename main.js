const a0_0x1b8592=a0_0x495c;(function(_0x4f686d,_0x218e74){const _0x228fff=a0_0x495c,_0x3dc105=_0x4f686d();while(!![]){try{const _0x2c418a=parseInt(_0x228fff(0x343))/0x1*(-parseInt(_0x228fff(0x1ae))/0x2)+-parseInt(_0x228fff(0x2fd))/0x3*(-parseInt(_0x228fff(0x2bb))/0x4)+-parseInt(_0x228fff(0x305))/0x5+-parseInt(_0x228fff(0x1b2))/0x6*(parseInt(_0x228fff(0x313))/0x7)+-parseInt(_0x228fff(0x250))/0x8+-parseInt(_0x228fff(0x2ef))/0x9*(parseInt(_0x228fff(0x2be))/0xa)+parseInt(_0x228fff(0x1f1))/0xb;if(_0x2c418a===_0x218e74)break;else _0x3dc105['push'](_0x3dc105['shift']());}catch(_0x1d4287){_0x3dc105['push'](_0x3dc105['shift']());}}}(a0_0x4cba,0x41e87));const a0_0x3c33c1=(function(){let _0x876abe=!![];return function(_0x3a0e64,_0x2f6427){const _0x44e945=_0x876abe?function(){const _0x20699c=a0_0x495c;if(_0x2f6427){const _0x3bc17a=_0x2f6427[_0x20699c(0x2a1)](_0x3a0e64,arguments);return _0x2f6427=null,_0x3bc17a;}}:function(){};return _0x876abe=![],_0x44e945;};}()),a0_0x485469=a0_0x3c33c1(this,function(){const _0x561fc3=a0_0x495c;return a0_0x485469[_0x561fc3(0x19d)]()[_0x561fc3(0x1af)](_0x561fc3(0x219))[_0x561fc3(0x19d)]()[_0x561fc3(0x30c)](a0_0x485469)[_0x561fc3(0x1af)](_0x561fc3(0x219));});function a0_0x495c(_0x1a8ca8,_0x3e1c37){const _0x373519=a0_0x4cba();return a0_0x495c=function(_0x485469,_0x3c33c1){_0x485469=_0x485469-0x186;let _0x4cbaf9=_0x373519[_0x485469];return _0x4cbaf9;},a0_0x495c(_0x1a8ca8,_0x3e1c37);}a0_0x485469();'use strict';const utils=require(a0_0x1b8592(0x1e4)),{GoogleGenerativeAI}=require(a0_0x1b8592(0x222)),schedule=require(a0_0x1b8592(0x1a1)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x1b8592(0x1d0),LTM_SCHEDULE=a0_0x1b8592(0x1fa),MODE_RESET_SCHEDULE=a0_0x1b8592(0x316),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x1b8592(0x236),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x1b8592(0x2b7),LTM_DP_BASELINE_STATUS=a0_0x1b8592(0x195),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x1b8592(0x2b5),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x1b8592(0x341),SYSTEM_DP_MODE='system.mode',IGNORE_TERMS=['unreach','lowbat','rssi',a0_0x1b8592(0x2ae),a0_0x1b8592(0x1f5),a0_0x1b8592(0x2f1),'current',a0_0x1b8592(0x1d5),a0_0x1b8592(0x2f3),a0_0x1b8592(0x211),a0_0x1b8592(0x2cf),'available','link',a0_0x1b8592(0x210),a0_0x1b8592(0x23e),a0_0x1b8592(0x244),'error',a0_0x1b8592(0x331),a0_0x1b8592(0x224),a0_0x1b8592(0x2bf)],SYSTEM_MODES={'NORMAL':a0_0x1b8592(0x2a2),'VACATION':'vacation','PARTY':'party','GUEST':a0_0x1b8592(0x1ad)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x1b8592(0x269)],SYSTEM_MODES[a0_0x1b8592(0x1e0)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x1b8592(0x303),'senior_aal':a0_0x1b8592(0x1a6),'family':'Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','single_comfort':a0_0x1b8592(0x249),'security':a0_0x1b8592(0x272)};function a0_0x4cba(){const _0xf0e66d=['notifyTelegramRecipient','cogni-living\x20adapter\x20starting\x20(v','quality','energy','event','switch','getWeatherContext','saveFeedback','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','scanDevices','getSystemUUID','(((.+)+)+)+$','genAI','details','Fehler:\x20','Comfort\x20Suggestion','unshift','Generating\x20Morning\x20Briefing...','Zu\x20wenig\x20Daten\x20fÃ¼r\x20Daily\x20Digest.','inactivityThresholdHours','@google/generative-ai','Baseline:\x20Inactive\x20(Pro\x20Feature).','working','longitude','\x0a\x0aA\x20(STB):\x0a','object','analysis.automation','licht','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20AktivitÃ¤t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20GartenaktivitÃ¤t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','join','activity','Daily\x20Digests','Logbook','inactivityMonitoringEnabled','analysis.analysisHistory','daswetter','LTM','systemUUID','setupBriefingScheduler','toLowerCase','LTM.dailyDigests','KALENDER:\x20Keine\x20Daten','string','onReady','isGracePeriodActive','LTM\x20Sched\x20Error:\x20','getForeignObjectAsync','testNotification','connection','analysisTimer','cancel','light','text','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','maintenance','livingContext','getForeignObjectsAsync','Party','lights','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','some','subscribeStates','ltmStbWindowDays','unload','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','temp','1945992zUsZWA','startExitTimer','Scheduling\x20Morning\x20Briefing\x20for\x20','TEST-PRO-KEY','ltmJob','subscribeForeignStatesAsync','type','health','getLtmData','system.meta.uuid','automationProposal','accuweather','retry','window','notifySignalInstance','Daily\x20Digest\x20created\x20successfully.','members','System\x20Mode','getStateAsync','Error\x20checking\x20WiFi:\x20','isEmergency','feedbackHistory','splice','suggestedAction','indicator.alarm.fire','PARTY','devices','.forecast.current.state','analysis.history_debug_00','Trigger\x20Analysis','Sending\x20notification:\x20\x22','_calName','License\x20Check\x20failed:\x20','Sleep\x20Score\x20(0-100)','PRIORITÃ„T:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungewÃ¶hnliche\x20Anwesenheit.','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','systemConfig','main','analysis.isAlert','.Summary.Current','setState','Subscribing\x20to\x20','comfort','Nein','.\x20ORT:\x20','baselineDrift','checkLicense','enum.functions.*','notifyWhatsappRecipient','AI\x20Emergency\x20Status','application/json','Last\x20Check','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','exitGraceTimer','\x20presence\x20devices...','calendarSelection','Comfort\x20Summary','events.history_debug_03','notifyTelegramInstance','N/A','exitTimer','scanForDevices','KALENDER:\x20Keine\x20relevanten\x20Termine','test','description','licenseKey','getGenerativeModel','presence','updateBaselineStatus','calendarInstance','setPresence','weatherInstance','alertReason','ðŸš¨ðŸš¨\x20NOTFALL','date','notifyEmailRecipient','analysis.triggerBriefing','events.history_debug_02','analysis.comfortSummary','now','apply','normal','schalter','Drift\x20Analysis','isProVersion','getEnums','loadDailyDigests','Last\x20raw\x20event','2-digit','button','Health\x20Notes','minDaysForBaseline','.\x20PERSONA:\x20','signal','Restlessness\x20Level','[TEST]\x20','ltmDriftCheckIntervalHours','from','notifyPushoverInstance','\x0aFEEDBACK:\x0a','LTM.driftAnalysis.baselineDrift','sensorLastValues','LTM.triggerDailyDigest','.data.table','openweathermap.0','info','80260aPcGsK','notifyEmailEnabled','name','60620deGagA','direction','analysis.health.sleepScore','send','analysis.deviationFromBaseline','summary','catch','warn','setupDriftAnalysisScheduler','deviationFromBaseline','No\x20recorded\x20events\x20yet.','analysis.comfortSuggestion','analysis.automation.description','presenceDevices','\x20min).\x20Watchdog\x20Limit:\x20','updateAnalysisHistory','\x22\x20was\x20','update','map','loadRawEventLog','toFixed','Briefing\x20Sched\x20Error:\x20','dailyDigests','âš ï¸\x20Alarm','isPresent','/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20AktivitÃ¤t\x20seit\x2004:00\x20Uhr:\x20','Analysiere\x20Tag...','\x20sent','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','createAllObjects','Lernphase\x20(','sendTo','fenster','setupModeResetScheduler','values','analysis.health','doors','isExit','error','No\x20Key','uuid-not-found','loadSystemMode','native','online','aiPersona','channel','namespace','temperature','Raw\x20Log','171EPfWso','logDuplicates','voltage','delObjectAsync','power','Presence\x20Status','driftAnalysisTimer','Drift\x20Status','analysis.lastResult','currentSystemMode','stringify','city','analysis.trigger','openweathermap','27KKYgcV','isArray','de-DE','analysis.alertReason','filter','response','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','scheduleJob','468385KIyLcx','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','N/A\x20(Learning)','testContext','Daily\x20Digest\x20Error:\x20','system.isPresent','getObjectAsync','constructor','sort','val','bind','boolean','onStateChange','.\x20PRÃ„SENZ:\x20','189XitweH','restlessness','tryParse','0\x204\x20*\x20*\x20*','runGeminiAnalysis','events.lastEvent','\x20raw\x20events...','processSensorEvent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','Urlaub','callback','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','setHours','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20SchlafqualitÃ¤t\x20letzte\x20Nacht:\x20','runAutopilot','System\x20Status\x20&\x20Control','indicator.alarm','initPresenceSubscriptions','checkSystemObjects','door','log','briefingTime','timestamp','No\x20instance','activityLevel','modeResetJob','ical.0','state','extendObjectAsync','common','fault','getForeignStateAsync','Processing\x20Status','split','Gemini\x20AI\x20initialized.','getCalendarNames\x20Error:\x20','events.history','.NextHours.Location_1.Day_1.current.symbol_desc','sound','dimmer','Cogni-Living\x20Alert','security','Action','version','checkLtmDriftObjects','on/off','LTM.driftAnalysis.lastCheck','pop','10JiJioq','time','initZombies','lock','analysis.automation.patternDetected','ready','Analysis\x20Error:\x20','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','analysis.automation.suggestedAction','isAlert','toISOString','Error\x20creating\x20objects:\x20','checkLtmObjects','command','parse','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','Missing\x20data','08:00','briefingJob','LTM.baselineStatus','Deaktiviert\x20(Pro-Feature)','Starting\x20Autopilot\x20(','Wetter:\x20Deaktiviert','VACATION','useWeather','submitFeedback','rating','toString','sleepScore','sendNotification','motion','node-schedule','Event\x20History','saveRawEventLog','indicator','humidity','PRIORITÃ„T:\x20Gesundheit\x20und\x20Sicherheit\x20fÃ¼r\x20Senioren\x20(AAL).\x20Erkenne\x20InaktivitÃ¤t,\x20potenzielle\x20StÃ¼rze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20nÃ¤chtliche\x20Unruhe.','patternDetected','none','geminiApiKey','apiKey','accuweather.0','Alert\x20Reason','guest','63650nWhnzT','search','daswetter.0','message','7302GlTQWU','analysis.activitySummary','Morning\x20Briefing\x20sent.','geminiModel','notifyEmailInstance','bewegung','onMessage','WETTER:\x20Keine\x20Daten\x20gefunden','startsWith','suggestion','AI\x20Alert\x20Status','cogni-living','NORMAL','analysisInterval','runBaselineDriftAnalysis','Pattern\x20Detected','notifySignalRecipient','events.history_debug_04','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','analysis.history_debug_02','createDailyDigest','initHistory','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','setStateAsync','setObjectNotExistsAsync','eventHistory','ack','driftDetails','notes','Adapter','models/gemini-flash-latest','number','sendToAsync','getCalendarNames','toLocaleString','consumption','replace','system.config','json','Scanning\x20for\x20devices\x20(Sprint\x2023b\x20Logic)...','PRO-','ðŸŒ…\x20Daily\x20Briefing:\x0a','notifyWhatsappEnabled','\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}','sendMorningBriefing','analysisHistory','GUEST','latitude','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20',')\x20-\x20OBFUSCATION\x20SAFE\x20MODE','@iobroker/adapter-core','length','selectedFunctionIds','abortExitTimer','enum','find','includes','ðŸš¨\x20EMERGENCY','slice','Feedback\x20saved:\x20','expire','trim','checkWifiPresence','9818457jMCjKN','generateContent','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','Activity\x20Summary','battery','Description','analysis.health.notes','thermostat','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20AngehÃ¶rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','0\x203\x20*\x20*\x20*','push','Error\x20reading\x20calendar\x20table:\x20','setupLtmScheduler','useCalendar','events.history_debug_00','enum.rooms.*','rawEventLog','uuid','analysis.history_debug_03','config','lampe','initSensorSubscriptions','generic','notifyPushoverEnabled','onUnload','Creating\x20Daily\x20Digest\x20from\x20','lastAlertState','getCalendarContext','analysis.isEmergency'];a0_0x4cba=function(){return _0xf0e66d;};return a0_0x4cba();}class CogniLiving extends utils[a0_0x1b8592(0x1cf)]{constructor(_0x5d365b){const _0x5993b3=a0_0x1b8592;super({..._0x5d365b,'name':_0x5993b3(0x1bd)}),this[_0x5993b3(0x1cb)]=[],this[_0x5993b3(0x1df)]=[],this[_0x5993b3(0x265)]=[],this[_0x5993b3(0x201)]=[],this[_0x5993b3(0x2d4)]=[],this['sensorLastValues']={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x5993b3(0x28d)]=null,this[_0x5993b3(0x286)]=null,this[_0x5993b3(0x23a)]=![],this[_0x5993b3(0x21a)]=null,this['geminiModel']=null,this[_0x5993b3(0x2f8)]=SYSTEM_MODES[_0x5993b3(0x1be)],this[_0x5993b3(0x2a5)]=![],this[_0x5993b3(0x20b)]=![],this['systemUUID']='unknown',this[_0x5993b3(0x23f)]=null,this[_0x5993b3(0x254)]=null,this[_0x5993b3(0x32c)]=null,this[_0x5993b3(0x2f5)]=null,this[_0x5993b3(0x194)]=null,this['on'](_0x5993b3(0x187),this[_0x5993b3(0x239)]['bind'](this)),this['on']('stateChange',this[_0x5993b3(0x311)]['bind'](this)),this['on'](_0x5993b3(0x24d),this[_0x5993b3(0x209)][_0x5993b3(0x30f)](this)),this['on']('message',this[_0x5993b3(0x1b8)]['bind'](this));}async[a0_0x1b8592(0x239)](){const _0x2d2302=a0_0x1b8592;this[_0x2d2302(0x327)][_0x2d2302(0x2ba)](_0x2d2302(0x20f)+this[_0x2d2302(0x33e)]+_0x2d2302(0x1e3)),await this[_0x2d2302(0x345)](),this['config'][_0x2d2302(0x292)]=this[_0x2d2302(0x204)][_0x2d2302(0x292)]||'';try{this['isProVersion']=await this[_0x2d2302(0x27f)](this[_0x2d2302(0x204)][_0x2d2302(0x292)]);}catch(_0x4a517a){this[_0x2d2302(0x327)][_0x2d2302(0x2e4)](_0x2d2302(0x270)+_0x4a517a[_0x2d2302(0x1b1)]);}if(!this[_0x2d2302(0x204)][_0x2d2302(0x221)]||this[_0x2d2302(0x204)]['inactivityThresholdHours']<0.1)this[_0x2d2302(0x204)][_0x2d2302(0x221)]=0xc;await this[_0x2d2302(0x1c7)](),await this['initSystemConfig']();if(this[_0x2d2302(0x204)][_0x2d2302(0x1a9)])try{this[_0x2d2302(0x21a)]=new GoogleGenerativeAI(this[_0x2d2302(0x204)][_0x2d2302(0x1a9)]),this[_0x2d2302(0x1b5)]=this[_0x2d2302(0x21a)][_0x2d2302(0x293)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2d2302(0x283)}}),this[_0x2d2302(0x327)]['info'](_0x2d2302(0x335));}catch(_0x457742){this['log'][_0x2d2302(0x2e4)]('Gemini\x20Init\x20Error:\x20'+_0x457742[_0x2d2302(0x1b1)]);}await this[_0x2d2302(0x2db)](),await this[_0x2d2302(0x2e7)](),await this[_0x2d2302(0x2d1)](),await this[_0x2d2302(0x2a7)](),this[_0x2d2302(0x24b)](_0x2d2302(0x2fb)),this[_0x2d2302(0x24b)](LTM_DP_TRIGGER_DIGEST),this[_0x2d2302(0x24b)]('system.mode'),this[_0x2d2302(0x24b)](_0x2d2302(0x29d)),await this[_0x2d2302(0x206)](),await this[_0x2d2302(0x324)]();if(this[_0x2d2302(0x23f)])clearInterval(this['analysisTimer']);const _0x2f0916=this[_0x2d2302(0x204)][_0x2d2302(0x1bf)]||0xf;_0x2f0916>0x0&&(this['log']['info'](_0x2d2302(0x197)+_0x2f0916+_0x2d2302(0x2cc)+this[_0x2d2302(0x204)][_0x2d2302(0x221)]+'h.'),this['analysisTimer']=setInterval(()=>{const _0x2e8c71=_0x2d2302;this[_0x2e8c71(0x321)]();},_0x2f0916*0x3c*0x3e8)),this[_0x2d2302(0x1fd)](),this[_0x2d2302(0x2df)](),this[_0x2d2302(0x2c6)](),this[_0x2d2302(0x234)]();}['onUnload'](_0x6ec612){const _0x53139c=a0_0x1b8592;if(this['analysisTimer'])clearInterval(this[_0x53139c(0x23f)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x53139c(0x2f5)]);if(this[_0x53139c(0x254)])this[_0x53139c(0x254)][_0x53139c(0x240)]();if(this[_0x53139c(0x32c)])this[_0x53139c(0x32c)][_0x53139c(0x240)]();if(this[_0x53139c(0x194)])this[_0x53139c(0x194)][_0x53139c(0x240)]();if(this[_0x53139c(0x28d)])clearTimeout(this[_0x53139c(0x28d)]);if(this[_0x53139c(0x286)])clearTimeout(this[_0x53139c(0x286)]);_0x6ec612();}async[a0_0x1b8592(0x311)](_0x504321,_0x46fc95){const _0x3f1e7e=a0_0x1b8592;if(!_0x46fc95)return;if(_0x504321===this[_0x3f1e7e(0x2ec)]+'.'+SYSTEM_DP_MODE){_0x46fc95[_0x3f1e7e(0x30e)]&&Object[_0x3f1e7e(0x2e0)](SYSTEM_MODES)[_0x3f1e7e(0x1ea)](_0x46fc95[_0x3f1e7e(0x30e)])&&(this[_0x3f1e7e(0x2f8)]=_0x46fc95[_0x3f1e7e(0x30e)],_0x46fc95[_0x3f1e7e(0x30e)]===SYSTEM_MODES[_0x3f1e7e(0x199)]?await this['setPresence'](![]):await this[_0x3f1e7e(0x297)](!![]));if(!_0x46fc95[_0x3f1e7e(0x1cc)])this[_0x3f1e7e(0x279)](_0x504321,{'val':this[_0x3f1e7e(0x2f8)],'ack':!![]});return;}if(!_0x46fc95['ack']){_0x504321[_0x3f1e7e(0x1ea)](_0x3f1e7e(0x2fb))&&_0x46fc95[_0x3f1e7e(0x30e)]&&(this[_0x3f1e7e(0x279)](_0x504321,{'val':![],'ack':!![]}),this[_0x3f1e7e(0x317)]());if(_0x504321[_0x3f1e7e(0x1ea)]('triggerDailyDigest')&&_0x46fc95['val']){this['setState'](_0x504321,{'val':![],'ack':!![]});if(this[_0x3f1e7e(0x2a5)])this[_0x3f1e7e(0x1c6)]();}_0x504321[_0x3f1e7e(0x1ea)]('triggerBriefing')&&_0x46fc95[_0x3f1e7e(0x30e)]&&(this[_0x3f1e7e(0x279)](_0x504321,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this['config']['presenceDevices']&&this[_0x3f1e7e(0x204)][_0x3f1e7e(0x2cb)]['includes'](_0x504321)){await this[_0x3f1e7e(0x1f0)]();return;}const _0x58268c=(this[_0x3f1e7e(0x204)]['devices']||[])[_0x3f1e7e(0x1e9)](_0x339e71=>_0x339e71['id']===_0x504321);if(_0x58268c)this['processSensorEvent'](_0x504321,_0x46fc95,_0x58268c);}async['onMessage'](_0xbf932a){const _0x40ed4b=a0_0x1b8592;if(typeof _0xbf932a===_0x40ed4b(0x227)&&_0xbf932a[_0x40ed4b(0x1b1)])try{if(_0xbf932a[_0x40ed4b(0x18f)]==='testApiKey'){if(!_0xbf932a[_0x40ed4b(0x1b1)][_0x40ed4b(0x1aa)])return this['sendTo'](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':![],'message':_0x40ed4b(0x2e5)},_0xbf932a[_0x40ed4b(0x31d)]);try{const _0x2533b3=new GoogleGenerativeAI(_0xbf932a['message'][_0x40ed4b(0x1aa)])[_0x40ed4b(0x293)]({'model':_0x40ed4b(0x1d0)});await _0x2533b3[_0x40ed4b(0x1f2)](_0x40ed4b(0x290)),this[_0x40ed4b(0x2dd)](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':!![],'message':'Success'},_0xbf932a['callback']);}catch(_0x426d57){this[_0x40ed4b(0x2dd)](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':![],'message':_0x426d57[_0x40ed4b(0x1b1)]},_0xbf932a[_0x40ed4b(0x31d)]);}}else{if(_0xbf932a[_0x40ed4b(0x18f)]===_0x40ed4b(0x23d)){const _0x1d57a4=await this[_0x40ed4b(0x19f)]('[Test]\x20Notification',!![]);this[_0x40ed4b(0x2dd)](_0xbf932a['from'],_0xbf932a[_0x40ed4b(0x18f)],{'success':_0x1d57a4>0x0,'message':_0x1d57a4+_0x40ed4b(0x2d9)},_0xbf932a[_0x40ed4b(0x31d)]);}else{if(_0xbf932a[_0x40ed4b(0x18f)]===_0x40ed4b(0x258)){if(!this[_0x40ed4b(0x2a5)])return this[_0x40ed4b(0x2dd)](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':![],'isPro':![]},_0xbf932a[_0x40ed4b(0x31d)]);let _0x3f3352={'status':'N/A','details':'','lastCheck':0x0};try{_0x3f3352['status']=(await this[_0x40ed4b(0x262)](LTM_DP_DRIFT_STATUS))[_0x40ed4b(0x30e)],_0x3f3352[_0x40ed4b(0x21b)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x40ed4b(0x30e)],_0x3f3352['lastCheck']=(await this[_0x40ed4b(0x262)](LTM_DP_DRIFT_LAST_CHECK))[_0x40ed4b(0x30e)];}catch(_0x3a7de8){}this[_0x40ed4b(0x2dd)](_0xbf932a['from'],_0xbf932a[_0x40ed4b(0x18f)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x40ed4b(0x2d4)],'driftAnalysis':_0x3f3352,'analysisHistory':this[_0x40ed4b(0x1df)]},_0xbf932a['callback']);}else{if(_0xbf932a[_0x40ed4b(0x18f)]===_0x40ed4b(0x2a6)){const _0x1a3aa0=await this[_0x40ed4b(0x246)](_0x40ed4b(0x280),'enum'),_0x25fa99=[];if(_0x1a3aa0)for(const _0x1d2ce8 in _0x1a3aa0){const _0x3d927e=_0x1a3aa0[_0x1d2ce8],_0x2bcb7b=(_0x3d927e[_0x40ed4b(0x330)]&&typeof _0x3d927e[_0x40ed4b(0x330)][_0x40ed4b(0x2bd)]===_0x40ed4b(0x227)?_0x3d927e['common']['name']['de']:_0x3d927e['common'][_0x40ed4b(0x2bd)])||_0x3d927e[_0x40ed4b(0x330)][_0x40ed4b(0x2bd)];_0x25fa99['push']({'id':_0x1d2ce8,'name':_0x2bcb7b});}this[_0x40ed4b(0x2dd)](_0xbf932a['from'],_0xbf932a[_0x40ed4b(0x18f)],{'success':!![],'enums':_0x25fa99},_0xbf932a[_0x40ed4b(0x31d)]);}else{if(_0xbf932a[_0x40ed4b(0x18f)]===_0x40ed4b(0x217))try{const _0x3d8add=await this[_0x40ed4b(0x28e)](_0xbf932a[_0x40ed4b(0x1b1)]||{});this[_0x40ed4b(0x2dd)](_0xbf932a['from'],_0xbf932a[_0x40ed4b(0x18f)],{'success':!![],'devices':_0x3d8add},_0xbf932a[_0x40ed4b(0x31d)]);}catch(_0x45ef6b){this[_0x40ed4b(0x2dd)](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':![],'error':_0x45ef6b['message']},_0xbf932a[_0x40ed4b(0x31d)]);}else{if(_0xbf932a[_0x40ed4b(0x18f)]===_0x40ed4b(0x19b)){const {historyId:_0x5a2ffe,rating:_0x5c6cfb,comment:_0x2b57f3,alertReason:_0x51619d}=_0xbf932a[_0x40ed4b(0x1b1)];_0x5a2ffe&&_0x5c6cfb?(await this[_0x40ed4b(0x215)]({'timestamp':Date[_0x40ed4b(0x2a0)](),'historyId':_0x5a2ffe,'rating':_0x5c6cfb,'comment':_0x2b57f3,'alertReason':_0x51619d}),this[_0x40ed4b(0x2dd)](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':!![]},_0xbf932a[_0x40ed4b(0x31d)])):this[_0x40ed4b(0x2dd)](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':![],'error':_0x40ed4b(0x192)},_0xbf932a[_0x40ed4b(0x31d)]);}else{if(_0xbf932a[_0x40ed4b(0x18f)]===_0x40ed4b(0x308)){const _0x49e655=await this[_0x40ed4b(0x214)](),_0x3c0815=await this['getCalendarContext']();this['sendTo'](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':!![],'weather':_0x49e655,'calendar':_0x3c0815},_0xbf932a[_0x40ed4b(0x31d)]);}else{if(_0xbf932a[_0x40ed4b(0x18f)]===_0x40ed4b(0x1d3)){const _0xbb0008=_0xbf932a[_0x40ed4b(0x1b1)]['instance'];if(!_0xbb0008)return this[_0x40ed4b(0x2dd)](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':![],'error':_0x40ed4b(0x32a)},_0xbf932a[_0x40ed4b(0x31d)]);const _0x349e71=await this[_0x40ed4b(0x1d3)](_0xbb0008);this[_0x40ed4b(0x2dd)](_0xbf932a[_0x40ed4b(0x2b2)],_0xbf932a[_0x40ed4b(0x18f)],{'success':!![],'names':_0x349e71},_0xbf932a[_0x40ed4b(0x31d)]);}}}}}}}}}catch(_0x36af24){this[_0x40ed4b(0x327)][_0x40ed4b(0x2e4)]('Error\x20in\x20onMessage\x20command\x20'+_0xbf932a['command']+':\x20'+_0x36af24['message']);if(_0xbf932a[_0x40ed4b(0x31d)])this['sendTo'](_0xbf932a['from'],_0xbf932a[_0x40ed4b(0x18f)],{'success':![],'error':_0x36af24[_0x40ed4b(0x1b1)]},_0xbf932a[_0x40ed4b(0x31d)]);}}async[a0_0x1b8592(0x31a)](_0x46e3c1,_0x530b39,_0x3eb0a9){const _0x46f49a=a0_0x1b8592;if(!_0x3eb0a9[_0x46f49a(0x2f0)]&&this[_0x46f49a(0x2b6)][_0x46e3c1]===_0x530b39[_0x46f49a(0x30e)])return;this[_0x46f49a(0x2b6)][_0x46e3c1]=_0x530b39[_0x46f49a(0x30e)];if(this[_0x46f49a(0x23a)])return;const _0xc17a57=await this[_0x46f49a(0x1f0)]();if(_0xc17a57){if(!this[_0x46f49a(0x2d6)])await this[_0x46f49a(0x297)](!![]);}else{const _0x3701f2=_0x3eb0a9[_0x46f49a(0x2e3)]===!![];_0x3701f2?this[_0x46f49a(0x251)]():(this[_0x46f49a(0x28d)]&&(this[_0x46f49a(0x327)]['info']('Bewegung\x20wÃ¤hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.'),this[_0x46f49a(0x1e7)]()),!this[_0x46f49a(0x2d6)]&&this[_0x46f49a(0x2f8)]===SYSTEM_MODES[_0x46f49a(0x1be)]&&await this[_0x46f49a(0x297)](!![]));}const _0x2223b7={'timestamp':_0x530b39['ts'],'id':_0x46e3c1,'name':_0x3eb0a9[_0x46f49a(0x2bd)],'value':_0x530b39['val'],'location':_0x3eb0a9['location'],'type':_0x3eb0a9[_0x46f49a(0x256)]};this[_0x46f49a(0x1cb)][_0x46f49a(0x21e)](_0x2223b7);if(this[_0x46f49a(0x1cb)][_0x46f49a(0x1e5)]>HISTORY_MAX_SIZE)this[_0x46f49a(0x1cb)][_0x46f49a(0x342)]();await this[_0x46f49a(0x1c9)]('events.lastEvent',{'val':JSON['stringify'](_0x2223b7),'ack':!![]}),await this[_0x46f49a(0x1c9)](_0x46f49a(0x337),{'val':JSON[_0x46f49a(0x2f9)](this[_0x46f49a(0x1cb)]),'ack':!![]}),this[_0x46f49a(0x201)][_0x46f49a(0x1fb)]({'timestamp':new Date(_0x530b39['ts'])['toISOString'](),'sensorName':_0x3eb0a9[_0x46f49a(0x2bd)],'location':_0x3eb0a9['location'],'value':_0x530b39[_0x46f49a(0x30e)]}),await this[_0x46f49a(0x1a3)]();}async['runAutopilot'](){const _0x8481f7=a0_0x1b8592,_0x1956cf=this[_0x8481f7(0x204)]['inactivityThresholdHours'],_0x559cfb=this[_0x8481f7(0x204)][_0x8481f7(0x22f)],_0x26d8b0=this[_0x8481f7(0x1cb)][_0x8481f7(0x1e5)]>0x0?this[_0x8481f7(0x1cb)][0x0]['timestamp']:Date['now'](),_0xf97763=(Date['now']()-_0x26d8b0)/(0x3e8*0x3c*0x3c);let _0x431fe0='';_0x559cfb&&this['currentSystemMode']===SYSTEM_MODES['NORMAL']&&this[_0x8481f7(0x2d6)]&&(_0xf97763>_0x1956cf&&(_0x431fe0='CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0xf97763[_0x8481f7(0x2d2)](0x1)+_0x8481f7(0x31e)));if(_0x431fe0){this[_0x8481f7(0x317)](_0x431fe0)['catch'](_0x17e456=>this[_0x8481f7(0x327)]['error'](_0x17e456));return;}const _0x41d942=Date['now'](),_0x521778=_0x41d942-_0x26d8b0,_0xae253a=(this[_0x8481f7(0x204)][_0x8481f7(0x1bf)]||0xf)*0x3c*0x3e8;this[_0x8481f7(0x1cb)][_0x8481f7(0x1e5)]>0x0&&_0x521778<=_0xae253a?this[_0x8481f7(0x317)]()[_0x8481f7(0x2c4)](_0x3f9c50=>this['log'][_0x8481f7(0x2e4)](_0x3f9c50)):!this[_0x8481f7(0x20b)]&&(this[_0x8481f7(0x279)](_0x8481f7(0x277),{'val':![],'ack':!![]}),this['setState'](_0x8481f7(0x20d),{'val':![],'ack':!![]}));}async[a0_0x1b8592(0x317)](_0x4fd96f=''){const _0x48fdc5=a0_0x1b8592;if(!this[_0x48fdc5(0x1b5)])return;const _0x406028=this[_0x48fdc5(0x1cb)]['length']>0x0?this[_0x48fdc5(0x1cb)]:[{'note':_0x48fdc5(0x2c8)}],_0x2fb260=PERSONA_MAPPING[this[_0x48fdc5(0x204)]['aiPersona']||_0x48fdc5(0x207)],_0x17c85d=this[_0x48fdc5(0x204)]['livingContext']||'',_0x36698d=this[_0x48fdc5(0x2f8)],_0x52712b=await this[_0x48fdc5(0x214)](),_0x58a33d=await this['getCalendarContext'](),_0x2fd1f0=(_0x52712b+'\x20'+_0x58a33d)[_0x48fdc5(0x1ef)](),_0x5a264d=new Date(),_0x3ae562=_0x5a264d[_0x48fdc5(0x1d4)](_0x48fdc5(0x2ff),{'weekday':'long','hour':_0x48fdc5(0x2a9),'minute':_0x48fdc5(0x2a9)}),_0x2645ca=this[_0x48fdc5(0x275)];let _0x52682e='';if(this['feedbackHistory'][_0x48fdc5(0x1e5)]>0x0){const _0x3d142c=this['feedbackHistory'][_0x48fdc5(0x1ec)](0x0,0x3)[_0x48fdc5(0x2d0)](_0x3d8a1d=>'User\x20Feedback:\x20Alarm\x20\x22'+_0x3d8a1d[_0x48fdc5(0x299)]+_0x48fdc5(0x2ce)+_0x3d8a1d[_0x48fdc5(0x19c)]+'.')[_0x48fdc5(0x22b)]('\x0a');_0x52682e=_0x48fdc5(0x2b4)+_0x3d142c+'\x0a';}const _0x409600=_0x4fd96f?_0x48fdc5(0x216)+_0x4fd96f+_0x48fdc5(0x24e):'',_0x26c7ff=_0x48fdc5(0x223),_0x2dfdbc=_0x48fdc5(0x306)+_0x3ae562+_0x48fdc5(0x27d)+_0x2645ca[_0x48fdc5(0x2fa)]+'.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20'+_0x36698d+_0x48fdc5(0x312)+(this[_0x48fdc5(0x2d6)]?'Ja':_0x48fdc5(0x27c))+_0x48fdc5(0x243)+_0x17c85d+_0x48fdc5(0x2ad)+_0x2fb260+_0x48fdc5(0x273)+_0x2fd1f0+_0x48fdc5(0x274)+_0x26c7ff+'\x20'+_0x52682e+'\x20'+_0x409600+_0x48fdc5(0x191)+JSON[_0x48fdc5(0x2f9)](_0x406028)+_0x48fdc5(0x22a);try{const _0x18351f=await this[_0x48fdc5(0x1b5)][_0x48fdc5(0x1f2)](_0x2dfdbc),_0x120c63=_0x18351f[_0x48fdc5(0x302)][_0x48fdc5(0x242)]()['replace'](/```json|```/g,'')[_0x48fdc5(0x1ef)](),_0x4f926c=JSON[_0x48fdc5(0x190)](_0x120c63);await this['setStateAsync']('analysis.lastResult',{'val':_0x120c63,'ack':!![]}),await this['setStateAsync'](_0x48fdc5(0x300),{'val':_0x4f926c[_0x48fdc5(0x22c)][_0x48fdc5(0x299)]||'','ack':!![]}),await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x1b3),{'val':_0x4f926c['activity'][_0x48fdc5(0x2c3)]||_0x48fdc5(0x28c),'ack':!![]}),await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x2c2),{'val':_0x4f926c[_0x48fdc5(0x22c)][_0x48fdc5(0x2c7)]||_0x48fdc5(0x28c),'ack':!![]});_0x4f926c[_0x48fdc5(0x27b)]&&(await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x29f),{'val':_0x4f926c[_0x48fdc5(0x27b)]['summary']||'','ack':!![]}),await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x2c9),{'val':_0x4f926c[_0x48fdc5(0x27b)][_0x48fdc5(0x1bb)]||'','ack':!![]}),_0x4f926c[_0x48fdc5(0x27b)][_0x48fdc5(0x25a)]&&(await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x186),{'val':_0x4f926c['comfort'][_0x48fdc5(0x25a)][_0x48fdc5(0x1a7)]||![],'ack':!![]}),await this['setStateAsync'](_0x48fdc5(0x2ca),{'val':_0x4f926c['comfort'][_0x48fdc5(0x25a)][_0x48fdc5(0x291)]||'','ack':!![]}),await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x18a),{'val':_0x4f926c[_0x48fdc5(0x27b)][_0x48fdc5(0x25a)][_0x48fdc5(0x267)]||'','ack':!![]})));_0x4f926c[_0x48fdc5(0x257)]&&(await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x2c0),{'val':typeof _0x4f926c[_0x48fdc5(0x257)][_0x48fdc5(0x19e)]===_0x48fdc5(0x1d1)?_0x4f926c[_0x48fdc5(0x257)]['sleepScore']:0x0,'ack':!![]}),await this['setStateAsync']('analysis.health.restlessness',{'val':_0x4f926c[_0x48fdc5(0x257)][_0x48fdc5(0x314)]||'none','ack':!![]}),await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x1f7),{'val':_0x4f926c[_0x48fdc5(0x257)][_0x48fdc5(0x1ce)]||'','ack':!![]}));const _0xaa9ee5=_0x4f926c['activity'][_0x48fdc5(0x18b)]||![],_0x5dc635=_0x4f926c[_0x48fdc5(0x22c)][_0x48fdc5(0x264)]||![];if(_0xaa9ee5||_0x5dc635){await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x277),{'val':!![],'ack':!![]}),await this['setStateAsync']('analysis.isEmergency',{'val':_0x5dc635,'ack':!![]});if(!this[_0x48fdc5(0x20b)]||_0x5dc635){const _0x372e08=_0x5dc635?_0x48fdc5(0x29a):_0x48fdc5(0x2d5);this[_0x48fdc5(0x19f)](_0x372e08+':\x20'+_0x4f926c[_0x48fdc5(0x22c)][_0x48fdc5(0x299)],![],_0x5dc635);}}else await this[_0x48fdc5(0x1c9)](_0x48fdc5(0x277),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x48fdc5(0x20d),{'val':![],'ack':!![]});this[_0x48fdc5(0x20b)]=_0xaa9ee5||_0x5dc635;const _0x6d92a={'timestamp':Date[_0x48fdc5(0x2a0)](),'id':Date['now']()[_0x48fdc5(0x19d)](),'analysis':_0x4f926c,'systemMode':_0x36698d,'isPro':this['isProVersion']};this[_0x48fdc5(0x2cd)](_0x6d92a);}catch(_0x591f8e){this['log']['error'](_0x48fdc5(0x188)+_0x591f8e['message']);}}async[a0_0x1b8592(0x1c6)](){const _0x333633=a0_0x1b8592;if(!this[_0x333633(0x1b5)]||this['rawEventLog'][_0x333633(0x1e5)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x333633(0x1c9)](LTM_DP_STATUS,{'val':_0x333633(0x220),'ack':!![]});return;}this[_0x333633(0x327)][_0x333633(0x2ba)](_0x333633(0x20a)+this['rawEventLog'][_0x333633(0x1e5)]+_0x333633(0x319)),await this[_0x333633(0x1c9)](LTM_DP_STATUS,{'val':_0x333633(0x2d8),'ack':!![]});const _0x4a7a8d=this[_0x333633(0x201)]['length']>0x320?this['rawEventLog'][_0x333633(0x1ec)](this[_0x333633(0x201)][_0x333633(0x1e5)]-0x320):this[_0x333633(0x201)],_0x5a8510=PERSONA_MAPPING[this[_0x333633(0x204)][_0x333633(0x2ea)]||_0x333633(0x207)],_0x3774ce=_0x333633(0x1f3)+_0x5a8510+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20'+JSON[_0x333633(0x2f9)](_0x4a7a8d)+_0x333633(0x1dd);try{const _0x460483=await this[_0x333633(0x1b5)]['generateContent'](_0x3774ce),_0x539901=_0x460483[_0x333633(0x302)][_0x333633(0x242)]()['replace'](/```json|```/g,'')[_0x333633(0x1ef)](),_0xe1f438=JSON[_0x333633(0x190)](_0x539901),_0x2f64a4={'timestamp':new Date()[_0x333633(0x18c)](),'eventCount':this[_0x333633(0x201)][_0x333633(0x1e5)],'summary':_0xe1f438['summary'],'activityLevel':_0xe1f438[_0x333633(0x32b)],'health':{'sleepScore':_0xe1f438[_0x333633(0x257)]?_0xe1f438[_0x333633(0x257)]['sleepScore']:0x0,'restlessness':_0xe1f438[_0x333633(0x257)]?_0xe1f438['health'][_0x333633(0x314)]:'none'},'systemMode':this[_0x333633(0x2f8)]};this['dailyDigests'][_0x333633(0x1fb)](_0x2f64a4),await this['saveDailyDigests'](),this[_0x333633(0x201)]=[],await this[_0x333633(0x1a3)](),await this[_0x333633(0x1c9)](LTM_DP_STATUS,{'val':_0x333633(0x285),'ack':!![]}),this[_0x333633(0x327)][_0x333633(0x2ba)](_0x333633(0x25f));}catch(_0x3a43a5){this['log'][_0x333633(0x2e4)](_0x333633(0x309)+_0x3a43a5[_0x333633(0x1b1)]),await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x333633(0x21c)+_0x3a43a5[_0x333633(0x1b1)],'ack':!![]});}}async[a0_0x1b8592(0x1de)](){const _0x4176ae=a0_0x1b8592;if(!this[_0x4176ae(0x1b5)])return;this['log'][_0x4176ae(0x2ba)](_0x4176ae(0x21f));const _0x580ff9=this['dailyDigests'][_0x4176ae(0x1e5)]>0x0?this[_0x4176ae(0x2d4)][this['dailyDigests'][_0x4176ae(0x1e5)]-0x1]:null,_0x430e5d=_0x580ff9&&_0x580ff9['health']?_0x580ff9[_0x4176ae(0x257)]['sleepScore']:'N/A',_0x162d4e=new Date();_0x162d4e[_0x4176ae(0x31f)](0x4,0x0,0x0,0x0);const _0x1dd417=this[_0x4176ae(0x1cb)][_0x4176ae(0x301)](_0x531a71=>new Date(_0x531a71[_0x4176ae(0x329)])>_0x162d4e),_0x22261f=PERSONA_MAPPING[this[_0x4176ae(0x204)][_0x4176ae(0x2ea)]||_0x4176ae(0x207)],_0x1fd2c4=this['config'][_0x4176ae(0x245)]||'',_0xdde230=await this[_0x4176ae(0x214)](),_0xc93172=await this[_0x4176ae(0x20c)](),_0x320fdf=_0x4176ae(0x1f9)+_0x22261f+_0x4176ae(0x1c4)+_0x1fd2c4+_0x4176ae(0x1e2)+_0xdde230+'\x20'+_0xc93172+_0x4176ae(0x320)+_0x430e5d+_0x4176ae(0x2d7)+JSON[_0x4176ae(0x2f9)](_0x1dd417[_0x4176ae(0x1ec)](0x0,0xa))+_0x4176ae(0x31b);try{const _0x5697c2=await this['geminiModel'][_0x4176ae(0x1f2)](_0x320fdf),_0xd14ff7=_0x4176ae(0x1db)+_0x5697c2[_0x4176ae(0x302)][_0x4176ae(0x242)]()['trim']();this[_0x4176ae(0x19f)](_0xd14ff7),this['log'][_0x4176ae(0x2ba)](_0x4176ae(0x1b4));}catch(_0xe29edd){this['log'][_0x4176ae(0x2e4)]('Briefing\x20Error:\x20'+_0xe29edd[_0x4176ae(0x1b1)]);}}async['scanForDevices'](_0x4f00bb){const _0x3884bc=a0_0x1b8592;this[_0x3884bc(0x327)][_0x3884bc(0x2ba)](_0x3884bc(0x1d9));const _0x358ed6=[],_0x3e40f7=await this[_0x3884bc(0x246)]('*',_0x3884bc(0x32e)),_0x76f3e3=await this[_0x3884bc(0x246)](_0x3884bc(0x200),'enum'),_0x1fbdad={};if(_0x76f3e3)for(const _0x32ffb1 in _0x76f3e3){const _0x1021e3=_0x76f3e3[_0x32ffb1][_0x3884bc(0x330)][_0x3884bc(0x260)];if(_0x1021e3&&Array[_0x3884bc(0x2fe)](_0x1021e3)){const _0x28a817=typeof _0x76f3e3[_0x32ffb1]['common']['name']===_0x3884bc(0x227)?_0x76f3e3[_0x32ffb1]['common'][_0x3884bc(0x2bd)]['de']:_0x76f3e3[_0x32ffb1][_0x3884bc(0x330)]['name'];for(const _0x490183 of _0x1021e3){_0x1fbdad[_0x490183]=_0x28a817;}}}const _0x1d2610=await this[_0x3884bc(0x246)](_0x3884bc(0x280),_0x3884bc(0x1e8)),_0x97d6e1={};if(_0x1d2610)for(const _0xbaa8b5 in _0x1d2610){const _0x5aec46=_0x1d2610[_0xbaa8b5][_0x3884bc(0x330)]['members'],_0x13e0e3=_0xbaa8b5[_0x3884bc(0x334)]('.')[_0x3884bc(0x342)]()[_0x3884bc(0x235)]();if(_0x5aec46&&Array[_0x3884bc(0x2fe)](_0x5aec46))for(const _0x264385 of _0x5aec46){if(!_0x97d6e1[_0x264385])_0x97d6e1[_0x264385]=[];_0x97d6e1[_0x264385][_0x3884bc(0x1fb)](_0x13e0e3);}}const _0x4e7f75=_0x4f00bb[_0x3884bc(0x1e6)]||[];for(const _0x54b108 in _0x3e40f7){const _0x11b92b=_0x3e40f7[_0x54b108];if(!_0x11b92b[_0x3884bc(0x330)])continue;const _0x3fd0d6=(_0x11b92b[_0x3884bc(0x330)]['role']||'')[_0x3884bc(0x235)](),_0x4b002b=((typeof _0x11b92b[_0x3884bc(0x330)]['name']===_0x3884bc(0x227)?_0x11b92b['common']['name']['de']:_0x11b92b['common'][_0x3884bc(0x2bd)])||_0x54b108)[_0x3884bc(0x235)](),_0x3bde41=_0x97d6e1[_0x54b108]||[];let _0x22fe3b=![];if(_0x4e7f75[_0x3884bc(0x1e5)]>0x0)for(const _0x1d67d6 of _0x4e7f75){if(_0x1d2610[_0x1d67d6]&&_0x1d2610[_0x1d67d6]['common']['members']&&_0x1d2610[_0x1d67d6][_0x3884bc(0x330)][_0x3884bc(0x260)][_0x3884bc(0x1ea)](_0x54b108)){_0x22fe3b=!![];break;}}if(!_0x22fe3b){if(IGNORE_TERMS[_0x3884bc(0x24a)](_0x1e3c21=>_0x54b108[_0x3884bc(0x235)]()['includes'](_0x1e3c21)||_0x4b002b[_0x3884bc(0x1ea)](_0x1e3c21)||_0x3fd0d6[_0x3884bc(0x1ea)](_0x1e3c21)))continue;}let _0x5b9d9a='';if(_0x4f00bb[_0x3884bc(0x1a0)]){if(_0x3fd0d6[_0x3884bc(0x1ea)]('motion')||_0x3fd0d6==='sensor.alarm'||_0x3bde41[_0x3884bc(0x24a)](_0x463205=>_0x463205[_0x3884bc(0x1ea)](_0x3884bc(0x1a0))||_0x463205['includes'](_0x3884bc(0x33c))))_0x5b9d9a='motion';else{if(_0x4b002b[_0x3884bc(0x1ea)](_0x3884bc(0x1b7))||_0x4b002b['includes']('motion')||_0x4b002b[_0x3884bc(0x1ea)](_0x3884bc(0x294)))_0x5b9d9a=_0x3884bc(0x1a0);}}if(!_0x5b9d9a&&_0x4f00bb[_0x3884bc(0x2e2)]){if(_0x3fd0d6[_0x3884bc(0x1ea)](_0x3884bc(0x326))||_0x3fd0d6[_0x3884bc(0x1ea)](_0x3884bc(0x25d))||_0x3fd0d6[_0x3884bc(0x1ea)](_0x3884bc(0x346))||_0x3bde41[_0x3884bc(0x24a)](_0x5c5c2e=>_0x5c5c2e['includes']('window')||_0x5c5c2e[_0x3884bc(0x1ea)](_0x3884bc(0x326))||_0x5c5c2e[_0x3884bc(0x1ea)](_0x3884bc(0x346))))_0x5b9d9a='door';else{if(_0x4b002b[_0x3884bc(0x1ea)](_0x3884bc(0x2de))||_0x4b002b[_0x3884bc(0x1ea)]('tÃ¼r')||_0x4b002b[_0x3884bc(0x1ea)](_0x3884bc(0x326))||_0x4b002b[_0x3884bc(0x1ea)](_0x3884bc(0x25d))||_0x4b002b[_0x3884bc(0x1ea)]('contact'))_0x5b9d9a=_0x3884bc(0x326);}}if(!_0x5b9d9a&&_0x4f00bb[_0x3884bc(0x248)]){if(_0x3fd0d6[_0x3884bc(0x1ea)](_0x3884bc(0x241))||_0x3fd0d6['includes'](_0x3884bc(0x213))||_0x3fd0d6[_0x3884bc(0x1ea)](_0x3884bc(0x33a))||_0x3bde41[_0x3884bc(0x24a)](_0x3acea9=>_0x3acea9[_0x3884bc(0x1ea)](_0x3884bc(0x241))))_0x5b9d9a=_0x3884bc(0x241);else{if(_0x4b002b['includes'](_0x3884bc(0x229))||_0x4b002b[_0x3884bc(0x1ea)](_0x3884bc(0x241))||_0x4b002b[_0x3884bc(0x1ea)](_0x3884bc(0x205))||_0x4b002b[_0x3884bc(0x1ea)](_0x3884bc(0x2a3))||_0x4b002b['includes'](_0x3884bc(0x340)))_0x5b9d9a=_0x3884bc(0x241);}}if(!_0x5b9d9a&&_0x4f00bb[_0x3884bc(0x2ed)]){if(_0x3fd0d6['includes'](_0x3884bc(0x2ed))||_0x3fd0d6[_0x3884bc(0x1ea)](_0x3884bc(0x1a5))||_0x3fd0d6[_0x3884bc(0x1ea)](_0x3884bc(0x1f8)))_0x5b9d9a='temperature';else{if(_0x4b002b['includes'](_0x3884bc(0x24f))||_0x4b002b[_0x3884bc(0x1ea)]('klima')||_0x4b002b[_0x3884bc(0x1ea)]('thermostat'))_0x5b9d9a=_0x3884bc(0x2ed);}}!_0x5b9d9a&&_0x22fe3b&&(_0x5b9d9a='custom');if(_0x5b9d9a){let _0x2a82aa=_0x1fbdad[_0x54b108]||'';if(!_0x2a82aa){const _0x5b14e0=_0x54b108[_0x3884bc(0x334)]('.');_0x5b14e0['pop']();const _0x2a0c81=_0x5b14e0[_0x3884bc(0x22b)]('.');_0x2a82aa=_0x1fbdad[_0x2a0c81]||'';}_0x358ed6['push']({'id':_0x54b108,'name':(typeof _0x11b92b[_0x3884bc(0x330)][_0x3884bc(0x2bd)]===_0x3884bc(0x227)?_0x11b92b['common'][_0x3884bc(0x2bd)]['de']:_0x11b92b[_0x3884bc(0x330)][_0x3884bc(0x2bd)])||_0x54b108,'location':_0x2a82aa,'type':_0x5b9d9a,'logDuplicates':![],'isExit':![],'_score':_0x2a82aa?0x50:_0x5b9d9a==='custom'?0x5a:0x28});}}return _0x358ed6;}[a0_0x1b8592(0x315)](_0x5be6e5){const _0x2b2aec=a0_0x1b8592;if(typeof _0x5be6e5===_0x2b2aec(0x227))return _0x5be6e5;try{return JSON[_0x2b2aec(0x190)](_0x5be6e5);}catch(_0x421c61){return null;}}async['initZombies'](){const _0x29cad9=a0_0x1b8592;try{const _0x310fa2=[_0x29cad9(0x26c),'analysis.history_debug_01',_0x29cad9(0x1c5),_0x29cad9(0x203),'analysis.history_debug_04',_0x29cad9(0x1ff),'events.history_debug_01',_0x29cad9(0x29e),_0x29cad9(0x28a),_0x29cad9(0x1c3)];for(const _0x32d6a3 of _0x310fa2){try{const _0x5e95ea=await this[_0x29cad9(0x30b)](_0x32d6a3);_0x5e95ea&&await this[_0x29cad9(0x2f2)](_0x32d6a3);}catch(_0x432144){}}}catch(_0x3860b7){}}async['initHistory'](){const _0xd75e11=a0_0x1b8592;try{const _0x121ecb=await this[_0xd75e11(0x262)](_0xd75e11(0x337));_0x121ecb&&_0x121ecb[_0xd75e11(0x30e)]&&(this[_0xd75e11(0x1cb)]=JSON[_0xd75e11(0x190)](_0x121ecb[_0xd75e11(0x30e)][_0xd75e11(0x19d)]()));}catch(_0xdf5d39){this[_0xd75e11(0x1cb)]=[];}try{const _0x51e787=await this['getStateAsync']('analysis.analysisHistory');if(_0x51e787&&_0x51e787[_0xd75e11(0x30e)])this[_0xd75e11(0x1df)]=JSON[_0xd75e11(0x190)](_0x51e787['val'][_0xd75e11(0x19d)]());}catch(_0x10b1e9){this[_0xd75e11(0x1df)]=[];}}async['initSystemConfig'](){const _0x2aaa7e=a0_0x1b8592;try{const _0x526efb=await this['getForeignObjectAsync'](_0x2aaa7e(0x1d7));_0x526efb&&_0x526efb[_0x2aaa7e(0x330)]&&(this['systemConfig']={'latitude':_0x526efb[_0x2aaa7e(0x330)][_0x2aaa7e(0x1e1)]||0x0,'longitude':_0x526efb[_0x2aaa7e(0x330)][_0x2aaa7e(0x225)]||0x0,'city':_0x526efb['common'][_0x2aaa7e(0x2fa)]||''});}catch(_0x355df1){}}async[a0_0x1b8592(0x27f)](_0x57d3e4){const _0x28b273=a0_0x1b8592;if(!_0x57d3e4)return![];this[_0x28b273(0x233)]=await this[_0x28b273(0x218)]();if(_0x57d3e4===_0x28b273(0x253)||_0x57d3e4[_0x28b273(0x1ba)](_0x28b273(0x1da)))return!![];return![];}async[a0_0x1b8592(0x218)](){const _0xae3f2f=a0_0x1b8592;try{const _0x4bc0a=await this[_0xae3f2f(0x23c)](_0xae3f2f(0x259));if(_0x4bc0a&&_0x4bc0a[_0xae3f2f(0x2e8)]&&_0x4bc0a[_0xae3f2f(0x2e8)][_0xae3f2f(0x202)])return _0x4bc0a[_0xae3f2f(0x2e8)]['uuid'];return _0xae3f2f(0x2e6);}catch(_0x385fb0){return'uuid-error';}}async[a0_0x1b8592(0x2db)](){const _0x563bc9=a0_0x1b8592;try{await this['checkSystemObjects'](),await this[_0x563bc9(0x1ca)](_0x563bc9(0x30a),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x2f4),'type':'boolean','role':_0x563bc9(0x1a4),'read':!![],'write':![],'def':!![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x563bc9(0x318),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x2a8),'type':'string','role':_0x563bc9(0x1d8),'read':!![],'write':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x337),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x1a2),'type':_0x563bc9(0x238),'role':_0x563bc9(0x1d8),'read':!![],'write':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x2fb),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x26d),'type':_0x563bc9(0x310),'role':_0x563bc9(0x2aa),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x29d),{'type':'state','common':{'name':'Trigger\x20Briefing\x20(Test)','type':'boolean','role':_0x563bc9(0x2aa),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x2f7),{'type':'state','common':{'name':'Last\x20Result','type':_0x563bc9(0x238),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x277),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x1bc),'type':'boolean','role':_0x563bc9(0x323),'read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x563bc9(0x20d),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x282),'type':_0x563bc9(0x310),'role':_0x563bc9(0x268),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x300),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x1ac),'type':_0x563bc9(0x238),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x563bc9(0x1b3),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x1f4),'type':_0x563bc9(0x238),'role':_0x563bc9(0x242),'read':!![],'write':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x2c2),{'type':_0x563bc9(0x32e),'common':{'name':'Deviation','type':'string','role':_0x563bc9(0x32e),'read':!![],'write':![],'def':_0x563bc9(0x28c)},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x29f),{'type':'state','common':{'name':_0x563bc9(0x289),'type':_0x563bc9(0x238),'role':_0x563bc9(0x242),'read':!![],'write':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x2c9),{'type':'state','common':{'name':_0x563bc9(0x21d),'type':_0x563bc9(0x238),'role':_0x563bc9(0x242),'read':!![],'write':![]},'native':{}}),await this[_0x563bc9(0x32f)](_0x563bc9(0x228),{'type':'channel','common':{'name':'Automation\x20Proposals'},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x186),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x1c1),'type':_0x563bc9(0x310),'role':_0x563bc9(0x1a4),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x2ca),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x1f6),'type':_0x563bc9(0x238),'role':_0x563bc9(0x242),'read':!![],'write':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x18a),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x33d),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x230),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x22e),'type':'string','role':_0x563bc9(0x1d8),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x563bc9(0x1ca)]('analysis.feedbackHistory',{'type':'state','common':{'name':'Feedback\x20Log','type':_0x563bc9(0x238),'role':_0x563bc9(0x1d8),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x563bc9(0x32f)](_0x563bc9(0x2e1),{'type':_0x563bc9(0x2eb),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await this['setObjectNotExistsAsync'](_0x563bc9(0x2c0),{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x271),'type':_0x563bc9(0x1d1),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await this['setObjectNotExistsAsync']('analysis.health.restlessness',{'type':_0x563bc9(0x32e),'common':{'name':_0x563bc9(0x2af),'type':_0x563bc9(0x238),'role':_0x563bc9(0x242),'read':!![],'write':![],'def':_0x563bc9(0x1a8)},'native':{}}),await this[_0x563bc9(0x1ca)](_0x563bc9(0x1f7),{'type':'state','common':{'name':_0x563bc9(0x2ab),'type':_0x563bc9(0x238),'role':_0x563bc9(0x242),'read':!![],'write':![],'def':''},'native':{}}),await this['checkLtmObjects'](),await this[_0x563bc9(0x33f)]();}catch(_0x52480f){this['log']['error'](_0x563bc9(0x18d)+_0x52480f[_0x563bc9(0x1b1)]);}}async[a0_0x1b8592(0x325)](){const _0x41b6e8=a0_0x1b8592;await this[_0x41b6e8(0x32f)]('system',{'type':_0x41b6e8(0x2eb),'common':{'name':_0x41b6e8(0x322)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x41b6e8(0x32e),'common':{'name':_0x41b6e8(0x261),'type':_0x41b6e8(0x238),'role':_0x41b6e8(0x32e),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x41b6e8(0x1be)]]:'Normal',[SYSTEM_MODES[_0x41b6e8(0x199)]]:_0x41b6e8(0x31c),[SYSTEM_MODES[_0x41b6e8(0x269)]]:_0x41b6e8(0x247),[SYSTEM_MODES['GUEST']]:'Gast'}},'native':{}});}async[a0_0x1b8592(0x18e)](){const _0x1c9c66=a0_0x1b8592;await this[_0x1c9c66(0x32f)](_0x1c9c66(0x232),{'type':_0x1c9c66(0x2eb),'common':{'name':_0x1c9c66(0x232)},'native':{}}),await this[_0x1c9c66(0x32f)](LTM_DP_RAW_LOG,{'type':_0x1c9c66(0x32e),'common':{'name':_0x1c9c66(0x2ee),'type':_0x1c9c66(0x238),'role':_0x1c9c66(0x1d8),'read':!![],'write':![]},'native':{}}),await this[_0x1c9c66(0x32f)](LTM_DP_DAILY_DIGESTS,{'type':_0x1c9c66(0x32e),'common':{'name':_0x1c9c66(0x22d),'type':_0x1c9c66(0x238),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x1c9c66(0x32f)](LTM_DP_STATUS,{'type':_0x1c9c66(0x32e),'common':{'name':_0x1c9c66(0x333),'type':_0x1c9c66(0x238),'role':_0x1c9c66(0x242),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x1c9c66(0x32e),'common':{'name':'Trigger\x20Digest','type':'boolean','role':_0x1c9c66(0x2aa),'read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x1c9c66(0x32e),'common':{'name':'Baseline\x20Status','type':_0x1c9c66(0x238),'role':_0x1c9c66(0x242),'read':!![],'write':![]},'native':{}});}async[a0_0x1b8592(0x33f)](){const _0x2b8bf8=a0_0x1b8592;await this[_0x2b8bf8(0x32f)](LTM_DP_DRIFT_CHANNEL,{'type':_0x2b8bf8(0x2eb),'common':{'name':_0x2b8bf8(0x2a4)},'native':{}}),await this[_0x2b8bf8(0x32f)](LTM_DP_DRIFT_STATUS,{'type':_0x2b8bf8(0x32e),'common':{'name':_0x2b8bf8(0x2f6),'type':_0x2b8bf8(0x238),'role':_0x2b8bf8(0x32e),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this[_0x2b8bf8(0x32f)](LTM_DP_DRIFT_DETAILS,{'type':_0x2b8bf8(0x32e),'common':{'name':'Drift\x20Details','type':'string','role':_0x2b8bf8(0x242),'read':!![],'write':![]},'native':{}}),await this[_0x2b8bf8(0x32f)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x2b8bf8(0x284),'type':'number','role':_0x2b8bf8(0x29b),'read':!![],'write':![]},'native':{}});}async[a0_0x1b8592(0x2e7)](){const _0xe2cabf=a0_0x1b8592;try{const _0x512c7e=await this[_0xe2cabf(0x262)](SYSTEM_DP_MODE);_0x512c7e&&_0x512c7e['val']&&Object[_0xe2cabf(0x2e0)](SYSTEM_MODES)[_0xe2cabf(0x1ea)](_0x512c7e[_0xe2cabf(0x30e)])?this[_0xe2cabf(0x2f8)]=_0x512c7e[_0xe2cabf(0x30e)]:(this[_0xe2cabf(0x2f8)]=SYSTEM_MODES['NORMAL'],await this[_0xe2cabf(0x1c9)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0xe2cabf(0x1be)],'ack':!![]}));}catch(_0x47f3ac){this['currentSystemMode']=SYSTEM_MODES[_0xe2cabf(0x1be)];}}async[a0_0x1b8592(0x2d1)](){const _0x4332b6=a0_0x1b8592;try{const _0x4fbfac=await this[_0x4332b6(0x262)](LTM_DP_RAW_LOG);if(_0x4fbfac&&_0x4fbfac['val'])this[_0x4332b6(0x201)]=JSON['parse'](_0x4fbfac[_0x4332b6(0x30e)]);}catch(_0x965aa9){this[_0x4332b6(0x201)]=[];}}async['loadDailyDigests'](){const _0x45cfa4=a0_0x1b8592;try{const _0x1130d1=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x1130d1&&_0x1130d1[_0x45cfa4(0x30e)])this[_0x45cfa4(0x2d4)]=JSON[_0x45cfa4(0x190)](_0x1130d1[_0x45cfa4(0x30e)]);}catch(_0x2fec8a){this[_0x45cfa4(0x2d4)]=[];}await this['updateBaselineStatus']();}async['saveRawEventLog'](){const _0x20ddf9=a0_0x1b8592;this['rawEventLog'][_0x20ddf9(0x1e5)]>RAW_LOG_MAX_SIZE&&this['rawEventLog'][_0x20ddf9(0x266)](0x0,this[_0x20ddf9(0x201)][_0x20ddf9(0x1e5)]-RAW_LOG_MAX_SIZE),await this[_0x20ddf9(0x1c9)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](this[_0x20ddf9(0x201)]),'ack':!![]});}async['saveDailyDigests'](_0x43335c=!![]){const _0x2dcd19=a0_0x1b8592,_0x50e270=this['config']['ltmLtbWindowDays']||0x3c;this[_0x2dcd19(0x2d4)][_0x2dcd19(0x1e5)]>_0x50e270&&this[_0x2dcd19(0x2d4)][_0x2dcd19(0x266)](0x0,this[_0x2dcd19(0x2d4)]['length']-_0x50e270);await this[_0x2dcd19(0x1c9)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2dcd19(0x2f9)](this[_0x2dcd19(0x2d4)]),'ack':!![]});if(_0x43335c)await this[_0x2dcd19(0x295)]();}async['updateAnalysisHistory'](_0x23e97e){const _0x1973cb=a0_0x1b8592;this[_0x1973cb(0x1df)][_0x1973cb(0x21e)](_0x23e97e);if(this[_0x1973cb(0x1df)][_0x1973cb(0x1e5)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x1973cb(0x1df)][_0x1973cb(0x342)]();await this[_0x1973cb(0x1c9)](_0x1973cb(0x230),{'val':JSON[_0x1973cb(0x2f9)](this[_0x1973cb(0x1df)]),'ack':!![]});}async['updateBaselineStatus'](){const _0x152464=a0_0x1b8592;if(!this[_0x152464(0x2a5)]){await this[_0x152464(0x1c9)](LTM_DP_BASELINE_STATUS,{'val':_0x152464(0x196),'ack':!![]});return;}const _0x3c087f=this['dailyDigests'][_0x152464(0x1e5)]>=(this[_0x152464(0x204)][_0x152464(0x2ac)]||0x7)?'Aktiv\x20('+this['dailyDigests']['length']+'\x20Tage)':_0x152464(0x2dc)+this[_0x152464(0x2d4)][_0x152464(0x1e5)]+'/'+(this[_0x152464(0x204)][_0x152464(0x2ac)]||0x7)+')';await this[_0x152464(0x1c9)](LTM_DP_BASELINE_STATUS,{'val':_0x3c087f,'ack':!![]});}async['initSensorSubscriptions'](){const _0x4d1bad=a0_0x1b8592,_0x24f511=this[_0x4d1bad(0x204)][_0x4d1bad(0x26a)];if(_0x24f511&&_0x24f511[_0x4d1bad(0x1e5)]>0x0){this[_0x4d1bad(0x327)][_0x4d1bad(0x2ba)](_0x4d1bad(0x27a)+_0x24f511[_0x4d1bad(0x1e5)]+'\x20sensors...');for(const _0x4fee36 of _0x24f511){if(_0x4fee36['id']){await this[_0x4d1bad(0x255)](_0x4fee36['id']);try{const _0x3547bd=await this[_0x4d1bad(0x332)](_0x4fee36['id']);if(_0x3547bd)this[_0x4d1bad(0x2b6)][_0x4fee36['id']]=_0x3547bd[_0x4d1bad(0x30e)];}catch(_0x5e2172){}}}}}async[a0_0x1b8592(0x324)](){const _0x354990=a0_0x1b8592,_0x23f0ed=this[_0x354990(0x204)][_0x354990(0x2cb)]||[];if(_0x23f0ed[_0x354990(0x1e5)]>0x0){this[_0x354990(0x327)][_0x354990(0x2ba)](_0x354990(0x27a)+_0x23f0ed['length']+_0x354990(0x287));for(const _0x158817 of _0x23f0ed){await this[_0x354990(0x255)](_0x158817);}try{await this[_0x354990(0x1f0)]();}catch(_0x405f08){}}}async[a0_0x1b8592(0x214)](){const _0x2f944b=a0_0x1b8592;try{if(!this[_0x2f944b(0x204)][_0x2f944b(0x19a)])return _0x2f944b(0x198);let _0x1bf3e9='';const _0x1ecc02=this['config'][_0x2f944b(0x298)];if(_0x1ecc02)try{if(_0x1ecc02[_0x2f944b(0x1ea)](_0x2f944b(0x25b))){const _0x1c5fa0=await this['getForeignStateAsync'](_0x1ecc02+'.Summary.Current');if(_0x1c5fa0&&_0x1c5fa0[_0x2f944b(0x30e)])_0x1bf3e9=_0x1c5fa0[_0x2f944b(0x30e)];}else{if(_0x1ecc02['includes'](_0x2f944b(0x231))){const _0x195312=await this[_0x2f944b(0x332)](_0x1ecc02+_0x2f944b(0x338));if(_0x195312&&_0x195312[_0x2f944b(0x30e)])_0x1bf3e9=_0x195312[_0x2f944b(0x30e)];}else{if(_0x1ecc02['includes'](_0x2f944b(0x2fc))){const _0x4a2986=await this['getForeignStateAsync'](_0x1ecc02+_0x2f944b(0x26b));if(_0x4a2986&&_0x4a2986[_0x2f944b(0x30e)])_0x1bf3e9=_0x4a2986[_0x2f944b(0x30e)];}}}}catch(_0x187d12){}if(!_0x1bf3e9){const _0x47e0a5=[_0x2f944b(0x1ab),_0x2f944b(0x1b0),'weatherunderground.0',_0x2f944b(0x2b9)];for(const _0x27879d of _0x47e0a5){try{const _0x197a17=await this[_0x2f944b(0x23c)](_0x27879d);if(_0x197a17){if(_0x27879d['includes'](_0x2f944b(0x25b))){const _0x4e2547=await this[_0x2f944b(0x332)](_0x27879d+_0x2f944b(0x278));if(_0x4e2547&&_0x4e2547['val']){_0x1bf3e9=_0x4e2547[_0x2f944b(0x30e)];break;}}}}catch(_0x46d12d){}}}return _0x1bf3e9?'WETTER:\x20'+_0x1bf3e9:_0x2f944b(0x1b9);}catch(_0x4b8e7c){return'WETTER\x20ERROR:\x20'+_0x4b8e7c['message'];}}async[a0_0x1b8592(0x20c)](){const _0x1db550=a0_0x1b8592;try{if(!this[_0x1db550(0x204)][_0x1db550(0x1fe)])return'Kalender:\x20Deaktiviert';let _0x3c2ddf=this[_0x1db550(0x204)][_0x1db550(0x296)]||_0x1db550(0x32d),_0x4fb6a7=this['config'][_0x1db550(0x288)]||[];if(typeof _0x4fb6a7==='string')_0x4fb6a7=_0x4fb6a7[_0x1db550(0x334)](',');try{const _0x422fff=await this[_0x1db550(0x332)](_0x3c2ddf+'.data.table');if(_0x422fff&&_0x422fff[_0x1db550(0x30e)]){let _0x2ab888=this[_0x1db550(0x315)](_0x422fff[_0x1db550(0x30e)]);if(_0x2ab888&&Array[_0x1db550(0x2fe)](_0x2ab888)){if(_0x4fb6a7[_0x1db550(0x1e5)]>0x0)_0x2ab888=_0x2ab888['filter'](_0x18f4b9=>_0x4fb6a7[_0x1db550(0x1ea)](_0x18f4b9[_0x1db550(0x26f)]||''));else return _0x1db550(0x2da);if(_0x2ab888[_0x1db550(0x1e5)]>0x0){const _0x1850ae=_0x2ab888['slice'](0x0,0x3)[_0x1db550(0x2d0)](_0x31aeaf=>{const _0x5981b0=_0x1db550;let _0x3cf0c3=_0x31aeaf['date'];if(_0x31aeaf[_0x5981b0(0x344)])_0x3cf0c3+='\x20'+_0x31aeaf[_0x5981b0(0x344)];return _0x3cf0c3+':\x20'+_0x31aeaf[_0x5981b0(0x212)]+'\x20('+_0x31aeaf[_0x5981b0(0x26f)]+')';});return'KALENDER:\x20'+_0x1850ae[_0x1db550(0x22b)]('\x20|\x20');}else return _0x1db550(0x28f);}}}catch(_0x4da01a){this[_0x1db550(0x327)][_0x1db550(0x2c5)](_0x1db550(0x1fc)+_0x4da01a['message']);}return _0x1db550(0x237);}catch(_0x375200){return'KALENDER\x20ERROR:\x20'+_0x375200['message'];}}async[a0_0x1b8592(0x1d3)](_0x26b4a8){const _0x5c14c2=a0_0x1b8592;try{const _0x5267e0=await this[_0x5c14c2(0x332)](_0x26b4a8+_0x5c14c2(0x2b8));if(_0x5267e0&&_0x5267e0[_0x5c14c2(0x30e)]){const _0x3ed1d6=this[_0x5c14c2(0x315)](_0x5267e0[_0x5c14c2(0x30e)]);if(_0x3ed1d6&&Array[_0x5c14c2(0x2fe)](_0x3ed1d6)){const _0x32d7ad=[...new Set(_0x3ed1d6['map'](_0x567502=>_0x567502[_0x5c14c2(0x26f)])[_0x5c14c2(0x301)](Boolean))];return _0x32d7ad[_0x5c14c2(0x30d)]();}}return[];}catch(_0x2409cb){return this[_0x5c14c2(0x327)][_0x5c14c2(0x2e4)](_0x5c14c2(0x336)+_0x2409cb[_0x5c14c2(0x1b1)]),[];}}async['checkWifiPresence'](){const _0x4c4c81=a0_0x1b8592;try{const _0x31f452=this[_0x4c4c81(0x204)]['presenceDevices']||[];let _0x38abb4=![];for(const _0x4cd2ec of _0x31f452){try{const _0x35bcea=await this['getForeignStateAsync'](_0x4cd2ec);if(_0x35bcea&&(_0x35bcea['val']===!![]||_0x35bcea['val']===_0x4c4c81(0x2e9)||_0x35bcea[_0x4c4c81(0x30e)]===0x1)){_0x38abb4=!![];break;}}catch(_0x1e4c7c){}}return _0x38abb4&&(this[_0x4c4c81(0x28d)]&&(this[_0x4c4c81(0x327)][_0x4c4c81(0x2ba)](_0x4c4c81(0x189)),this[_0x4c4c81(0x1e7)]()),!this[_0x4c4c81(0x2d6)]&&this['currentSystemMode']===SYSTEM_MODES['NORMAL']&&await this[_0x4c4c81(0x297)](!![])),_0x38abb4;}catch(_0x211de0){return this[_0x4c4c81(0x327)][_0x4c4c81(0x2e4)](_0x4c4c81(0x263)+_0x211de0['message']),![];}}[a0_0x1b8592(0x251)](){const _0x2e26bf=a0_0x1b8592;this[_0x2e26bf(0x1e7)](),this[_0x2e26bf(0x23a)]=!![],this[_0x2e26bf(0x286)]=setTimeout(()=>{const _0x53f10e=_0x2e26bf;this[_0x53f10e(0x23a)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x2e26bf(0x28d)]=setTimeout(()=>{const _0x588a1d=_0x2e26bf;this[_0x588a1d(0x297)](![]),this[_0x588a1d(0x28d)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}['abortExitTimer'](){const _0x8c8995=a0_0x1b8592;if(this[_0x8c8995(0x28d)])clearTimeout(this[_0x8c8995(0x28d)]);if(this[_0x8c8995(0x286)])clearTimeout(this[_0x8c8995(0x286)]);this['exitTimer']=null,this[_0x8c8995(0x286)]=null,this[_0x8c8995(0x23a)]=![];}async['setPresence'](_0x38e651){const _0x48409c=a0_0x1b8592;if(this[_0x48409c(0x2d6)]===_0x38e651)return;this[_0x48409c(0x2d6)]=_0x38e651,await this[_0x48409c(0x1c9)](_0x48409c(0x30a),{'val':_0x38e651,'ack':!![]});}async[a0_0x1b8592(0x215)](_0x298003){const _0x1a3377=a0_0x1b8592;this[_0x1a3377(0x327)][_0x1a3377(0x2ba)](_0x1a3377(0x1ed)+JSON[_0x1a3377(0x2f9)](_0x298003));}async[a0_0x1b8592(0x1c0)](){const _0x29cd37=a0_0x1b8592;if(!this['isProVersion']||!this[_0x29cd37(0x1b5)])return;const _0xc6c631=this[_0x29cd37(0x204)][_0x29cd37(0x24c)]||0xe;if(this[_0x29cd37(0x2d4)][_0x29cd37(0x1e5)]<_0xc6c631+(this[_0x29cd37(0x204)][_0x29cd37(0x2ac)]||0x7)){await this[_0x29cd37(0x1c9)](LTM_DP_DRIFT_STATUS,{'val':_0x29cd37(0x307),'ack':!![]});return;}const _0x4608eb=this[_0x29cd37(0x2d4)]['slice'](-_0xc6c631),_0x147d17=this[_0x29cd37(0x2d4)][_0x29cd37(0x1ec)](0x0,this['dailyDigests']['length']-_0xc6c631),_0x30d72a=_0x29cd37(0x1c8)+JSON[_0x29cd37(0x2f9)](_0x147d17)+_0x29cd37(0x226)+JSON['stringify'](_0x4608eb);try{const _0x3c07c3=await this['geminiModel'][_0x29cd37(0x1f2)](_0x30d72a),_0x48bcbd=JSON[_0x29cd37(0x190)](_0x3c07c3[_0x29cd37(0x302)][_0x29cd37(0x242)]()[_0x29cd37(0x1d6)](/```json|```/g,'')[_0x29cd37(0x1ef)]());_0x48bcbd[_0x29cd37(0x27e)]&&(await this[_0x29cd37(0x1c9)](LTM_DP_DRIFT_STATUS,{'val':_0x48bcbd[_0x29cd37(0x27e)],'ack':!![]}),await this[_0x29cd37(0x1c9)](LTM_DP_DRIFT_DETAILS,{'val':_0x48bcbd[_0x29cd37(0x1cd)],'ack':!![]}),await this[_0x29cd37(0x1c9)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x36cab8){}}[a0_0x1b8592(0x1fd)](){const _0x1534c2=a0_0x1b8592;try{if(this[_0x1534c2(0x254)])this[_0x1534c2(0x254)][_0x1534c2(0x240)]();if(!this[_0x1534c2(0x2a5)]){this[_0x1534c2(0x1c9)](LTM_DP_STATUS,{'val':_0x1534c2(0x196),'ack':!![]});return;}this['ltmJob']=schedule['scheduleJob'](LTM_SCHEDULE,()=>this[_0x1534c2(0x1c6)]());}catch(_0x284421){this[_0x1534c2(0x327)][_0x1534c2(0x2e4)](_0x1534c2(0x23b)+_0x284421[_0x1534c2(0x1b1)]);}}[a0_0x1b8592(0x2df)](){const _0x3689fd=a0_0x1b8592;try{if(this[_0x3689fd(0x32c)])this[_0x3689fd(0x32c)]['cancel']();this['modeResetJob']=schedule[_0x3689fd(0x304)](MODE_RESET_SCHEDULE,async()=>{const _0x48e180=_0x3689fd;await this['loadSystemMode'](),AUTO_RESET_MODES[_0x48e180(0x1ea)](this['currentSystemMode'])&&await this[_0x48e180(0x1c9)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x48e180(0x1be)],'ack':![]});});}catch(_0x473946){this['log'][_0x3689fd(0x2e4)]('Reset\x20Sched\x20Error:\x20'+_0x473946[_0x3689fd(0x1b1)]);}}[a0_0x1b8592(0x2c6)](){const _0xd5ecbe=a0_0x1b8592;try{if(this[_0xd5ecbe(0x2f5)])clearInterval(this['driftAnalysisTimer']);if(!this[_0xd5ecbe(0x2a5)])return;this[_0xd5ecbe(0x2f5)]=setInterval(()=>this['runBaselineDriftAnalysis'](),(this[_0xd5ecbe(0x204)][_0xd5ecbe(0x2b1)]||0x18)*0x36ee80),setTimeout(()=>this[_0xd5ecbe(0x1c0)](),0x1388);}catch(_0x439a60){this['log']['error']('Drift\x20Sched\x20Error:\x20'+_0x439a60[_0xd5ecbe(0x1b1)]);}}['setupBriefingScheduler'](){const _0x2a3576=a0_0x1b8592;try{if(this[_0x2a3576(0x194)])this[_0x2a3576(0x194)]['cancel']();if(!this[_0x2a3576(0x204)]['briefingEnabled'])return;const _0x267077=(this['config'][_0x2a3576(0x328)]||_0x2a3576(0x193))[_0x2a3576(0x334)](':'),_0x386602=parseInt(_0x267077[0x0])||0x8,_0x109b6d=parseInt(_0x267077[0x1])||0x0,_0x37c25d=_0x109b6d+'\x20'+_0x386602+'\x20*\x20*\x20*';this[_0x2a3576(0x327)][_0x2a3576(0x2ba)](_0x2a3576(0x252)+_0x386602+':'+(_0x109b6d<0xa?'0'+_0x109b6d:_0x109b6d)),this[_0x2a3576(0x194)]=schedule[_0x2a3576(0x304)](_0x37c25d,()=>{const _0xc51090=_0x2a3576;this[_0xc51090(0x1de)]();});}catch(_0x408c29){this[_0x2a3576(0x327)][_0x2a3576(0x2e4)](_0x2a3576(0x2d3)+_0x408c29[_0x2a3576(0x1b1)]);}}async[a0_0x1b8592(0x19f)](_0x598341,_0x691b9c=![],_0x14a137=![]){const _0x1f3928=a0_0x1b8592;this[_0x1f3928(0x327)][_0x1f3928(0x2ba)]((_0x691b9c?_0x1f3928(0x2b0):'')+_0x1f3928(0x26e)+_0x598341+'\x22'+(_0x14a137?'\x20(EMERGENCY)':''));const _0xe17451=this[_0x1f3928(0x204)];let _0x47ec61=0x0;_0xe17451['notifyTelegramEnabled']&&_0xe17451[_0x1f3928(0x28b)]&&(await this[_0x1f3928(0x1d2)](_0xe17451[_0x1f3928(0x28b)],_0x1f3928(0x2c1),{'text':_0x598341,'user':_0xe17451[_0x1f3928(0x20e)]}),_0x47ec61++);if(_0xe17451[_0x1f3928(0x208)]&&_0xe17451[_0x1f3928(0x2b3)]){let _0x5da49f={'message':_0x598341,'title':_0x14a137?_0x1f3928(0x1eb):_0x1f3928(0x33b),'priority':_0x14a137?0x2:0x1,'device':_0xe17451['notifyPushoverRecipient']};_0x14a137&&(_0x5da49f[_0x1f3928(0x25c)]=0x1e,_0x5da49f[_0x1f3928(0x1ee)]=0xe10,_0x5da49f[_0x1f3928(0x339)]='siren'),await this[_0x1f3928(0x1d2)](_0xe17451[_0x1f3928(0x2b3)],_0x1f3928(0x2c1),_0x5da49f),_0x47ec61++;}return _0xe17451[_0x1f3928(0x2bc)]&&_0xe17451['notifyEmailInstance']&&(await this[_0x1f3928(0x1d2)](_0xe17451[_0x1f3928(0x1b6)],_0x1f3928(0x2c1),{'text':_0x598341,'to':_0xe17451[_0x1f3928(0x29c)]}),_0x47ec61++),_0xe17451[_0x1f3928(0x1dc)]&&_0xe17451['notifyWhatsappInstance']&&(await this[_0x1f3928(0x1d2)](_0xe17451['notifyWhatsappInstance'],_0x1f3928(0x2c1),{'text':_0x598341,'phone':_0xe17451[_0x1f3928(0x281)]}),_0x47ec61++),_0xe17451['notifySignalEnabled']&&_0xe17451[_0x1f3928(0x25e)]&&(await this[_0x1f3928(0x1d2)](_0xe17451[_0x1f3928(0x25e)],_0x1f3928(0x2c1),{'text':_0x598341,'phone':_0xe17451[_0x1f3928(0x1c2)]}),_0x47ec61++),_0x47ec61;}}if(require[a0_0x1b8592(0x276)]!==module)module['exports']=_0x186a22=>new CogniLiving(_0x186a22);else new CogniLiving();