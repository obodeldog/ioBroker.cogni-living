const a0_0x43e95d=a0_0x4420;function a0_0x3982(){const _0x5d592d=['info.','slice','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','exitTimer','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','logDuplicates','weatherunderground.0','apiKey','N/A','weatherInstance','details','inactivityThresholdHours','Gemini\x20AI\x20initialized.','unshift','LTM.baselineStatus','generateContent','motion','.Summary.Current','saveRawEventLog','initHistory','calendarSelection','tryParse','patternDetected','getObjectAsync','members','startsWith','Party','getForeignObjectAsync','analysisTimer','onMessage','Gemini\x20Init\x20Error:\x20','\x20raw\x20events...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','257100krbUwz','VACATION','expire','bind','notifyEmailInstance','warn','subscribeForeignStatesAsync','accuweather.0','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','LTM.driftAnalysis.baselineDrift','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','analysisInterval','events.history_debug_02','node-schedule','version','Adapter','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','Processing\x20Status','Nein','search','analysis.alertReason','comfort','activity','message','vacation','stringify','weatherunderground.','subscribeStates','testContext','sendMorningBriefing','system.meta.uuid','1092PJHXpp','isProVersion','boolean','notifyTelegramInstance','val','string','LTM.driftAnalysis.driftDetails','activityLevel','onStateChange','presenceDevices','genAI','longitude','filter','json','runAutopilot','\x0aFEEDBACK:\x0a','140eBKzHW','models/gemini-flash-latest','getLtmData','geminiApiKey','openweathermap','accuweather','scanForDevices','selectedFunctionIds','sendNotification','0\x203\x20*\x20*\x20*','response','currentSystemMode','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','yr.','Kalender:\x20Deaktiviert','Fehler:\x20','checkWifiPresence','\x20sensors...','callback','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','analysis.history_debug_04','find','GUEST','livingContext','System\x20Mode','isGracePeriodActive','LTM.rawEventLog','setStateAsync','\x20sent','Starting\x20Autopilot\x20(','KALENDER\x20ERROR:\x20','main','processSensorEvent','sort','loadDailyDigests','‚ö†Ô∏è\x20Alarm','eventHistory','isExit','getWeatherContext','error','openweathermap.','createAllObjects','unknown','rating','toString','@google/generative-ai','config','de-DE','User\x20Feedback:\x20Alarm\x20\x22','PARTY','events.history_debug_04','Cogni-Living\x20Alert','triggerDailyDigest','4181232ghLVed','TEST-PRO-KEY','_calName','vis.','split','Analysiere\x20Tag...','Subscribing\x20to\x20','/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20','WETTER:\x20','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','Raw\x20Log','notifyPushoverRecipient','setupModeResetScheduler','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','Morning\x20Briefing\x20sent.','analysis.history_debug_00','send','parse','analysis.health.notes','notifyEmailRecipient','getForeignObjectsAsync','410hfUpnX','analysis.analysisHistory','56022awlxsH','ical.0','8NywmPO','button','checkLtmObjects','info','onReady','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','enum.functions.*','Urlaub','setState','catch','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','saveDailyDigests','city','isEmergency','cogni-living','length','rawEventLog','application/json','daswetter','LTM.driftAnalysis.lastCheck','abortExitTimer','@iobroker/adapter-core','WETTER\x20ERROR:\x20','LTM','state','material.','Daily\x20Digest\x20created\x20successfully.','analysis.history_debug_03','event','exports','alertReason','sound','automationProposal','Autopilot\x20error:\x20','No\x20Key','toLocaleString','analysisHistory','object','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','log','retry','useWeather','pop','getStateAsync','lastAlertState','join','[Test]\x20Notification','updateAnalysisHistory','normal','runGeminiAnalysis','Error\x20reading\x20calendar\x20table:\x20','history.','devices','inactivityMonitoringEnabled','analysis.activitySummary','summary','accuweather.','geminiModel','\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}','ack','none','push','KALENDER:\x20Keine\x20relevanten\x20Termine','üö®üö®\x20NOTFALL','\x20(EMERGENCY)','LTM.triggerDailyDigest','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','ltmJob','lastCheck','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','cancel','doors','events.history_debug_01','Baseline\x20Status','(((.+)+)+)+$','uuid-error','calendarInstance','unload','createAllObjects\x20failed:\x20','Missing\x20data','analysis.trigger','loadSystemMode\x20failed:\x20','2-digit','notifyPushoverInstance','Daily\x20Digests','name','suggestion','dailyDigests','flot.','8743EFWrys','\x20|\x20','5048DSEgtn','cogni-living\x20adapter\x20starting\x20(v','getEnums','system.mode','extendObjectAsync','notifyWhatsappInstance','startExitTimer','now','onUnload','notifySignalInstance','analysis.comfortSummary','PRO-','temperature','2323ptTLgM','timestamp','notifyWhatsappRecipient','sendTo','getGenerativeModel','namespace','modeResetJob','.\x20ORT:\x20','checkLtmDriftObjects','analysis.deviationFromBaseline','system','some','getCalendarContext','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','KALENDER:\x20','Success','location','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','delObjectAsync','428913TFTHhP','description','guest','No\x20instance','analysis.history_debug_02','notifyTelegramEnabled','native','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','createDailyDigest','driftAnalysisTimer','text','\x22\x20was\x20','140jWuVvg','notifySignalRecipient','setPresence','Error\x20initHistory:\x20','notifySignalEnabled','LTM.driftAnalysis','apply','Baseline:\x20Inactive\x20(Pro\x20Feature).','loadDailyDigests\x20failed:\x20','testApiKey','toISOString','.data.table','time','analysis.history_debug_01','Normal','systemConfig','üö®\x20EMERGENCY','0\x204\x20*\x20*\x20*','Trigger\x20Digest','replace','lights','setupBriefingScheduler','LTM.processingStatus','sleepScore','latitude','restlessness','checkLicense','\x20presence\x20devices...','command','üåÖ\x20Daily\x20Briefing:\x0a','common','health','channel','trim','NORMAL','analysis.automation.patternDetected','getCalendarNames\x20Error:\x20','from','feedbackHistory','Gast','isPresent','uuid','isArray','No\x20recorded\x20events\x20yet.','daswetter.','instance','enum','sensorLastValues','number','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','ready','exitGraceTimer','uuid-not-found','events.lastEvent','aiPersona','sendToAsync','systemUUID','analysis.health.restlessness','checkSystemObjects','siren','includes','getSystemUUID','generic','date','values','getForeignStateAsync','events.history','analysis.comfortSuggestion','Creating\x20Daily\x20Digest\x20from\x20','briefingJob','License\x20Check\x20failed:\x20','getCalendarNames','notifyEmailEnabled','analysis.isAlert','LTM.dailyDigests','Analysis\x20Error:\x20','loadSystemMode','admin.','674778AMnYjD','System\x20Status\x20&\x20Control','events.history_debug_03'];a0_0x3982=function(){return _0x5d592d;};return a0_0x3982();}(function(_0x1c2ca4,_0x4cdc45){const _0x1b914a=a0_0x4420,_0x5d26f2=_0x1c2ca4();while(!![]){try{const _0x213b9b=-parseInt(_0x1b914a(0x1a1))/0x1*(-parseInt(_0x1b914a(0x135))/0x2)+parseInt(_0x1b914a(0x20f))/0x3*(parseInt(_0x1b914a(0x139))/0x4)+-parseInt(_0x1b914a(0xeb))/0x5*(-parseInt(_0x1b914a(0x137))/0x6)+-parseInt(_0x1b914a(0x192))/0x7*(-parseInt(_0x1b914a(0x194))/0x8)+parseInt(_0x1b914a(0x1b4))/0x9*(parseInt(_0x1b914a(0x1c1))/0xa)+-parseInt(_0x1b914a(0x120))/0xb+parseInt(_0x1b914a(0x233))/0xc*(-parseInt(_0x1b914a(0xdb))/0xd);if(_0x213b9b===_0x4cdc45)break;else _0x5d26f2['push'](_0x5d26f2['shift']());}catch(_0x3df913){_0x5d26f2['push'](_0x5d26f2['shift']());}}}(a0_0x3982,0x710a0));const a0_0x5884ac=(function(){let _0x2f0647=!![];return function(_0x19440f,_0x2b85e0){const _0x53bf82=_0x2f0647?function(){const _0x3d1f41=a0_0x4420;if(_0x2b85e0){const _0x124330=_0x2b85e0[_0x3d1f41(0x1c7)](_0x19440f,arguments);return _0x2b85e0=null,_0x124330;}}:function(){};return _0x2f0647=![],_0x53bf82;};}()),a0_0x622cd5=a0_0x5884ac(this,function(){const _0x113514=a0_0x4420;return a0_0x622cd5[_0x113514(0x117)]()[_0x113514(0x248)](_0x113514(0x183))[_0x113514(0x117)]()['constructor'](a0_0x622cd5)[_0x113514(0x248)](_0x113514(0x183));});a0_0x622cd5();'use strict';const utils=require(a0_0x43e95d(0x14e)),{GoogleGenerativeAI}=require(a0_0x43e95d(0x118)),schedule=require(a0_0x43e95d(0x242)),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x43e95d(0xec),LTM_SCHEDULE=a0_0x43e95d(0xf4),MODE_RESET_SCHEDULE=a0_0x43e95d(0x1d2),LTM_DP_RAW_LOG=a0_0x43e95d(0x105),LTM_DP_DAILY_DIGESTS=a0_0x43e95d(0x20b),LTM_DP_STATUS=a0_0x43e95d(0x1d7),LTM_DP_TRIGGER_DIGEST=a0_0x43e95d(0x17a),LTM_DP_BASELINE_STATUS=a0_0x43e95d(0x220),LTM_DP_DRIFT_CHANNEL=a0_0x43e95d(0x1c6),LTM_DP_DRIFT_STATUS=a0_0x43e95d(0x23d),LTM_DP_DRIFT_DETAILS=a0_0x43e95d(0xe1),LTM_DP_DRIFT_LAST_CHECK=a0_0x43e95d(0x14c),SYSTEM_DP_MODE=a0_0x43e95d(0x197),SYSTEM_MODES={'NORMAL':a0_0x43e95d(0x169),'VACATION':a0_0x43e95d(0xd4),'PARTY':'party','GUEST':a0_0x43e95d(0x1b6)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x43e95d(0x11c)],SYSTEM_MODES['GUEST']],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x43e95d(0x129),'senior_aal':a0_0x43e95d(0xf7),'family':'Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','single_comfort':a0_0x43e95d(0x23f),'security':a0_0x43e95d(0x143)};class CogniLiving extends utils[a0_0x43e95d(0x244)]{constructor(_0x22d32e){const _0x13bec6=a0_0x43e95d;super({..._0x22d32e,'name':_0x13bec6(0x147)}),this[_0x13bec6(0x10f)]=[],this[_0x13bec6(0x15d)]=[],this[_0x13bec6(0x1e7)]=[],this[_0x13bec6(0x149)]=[],this[_0x13bec6(0x190)]=[],this[_0x13bec6(0x1f0)]={},this[_0x13bec6(0x1d0)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x13bec6(0x215)]=null,this[_0x13bec6(0x1f4)]=null,this[_0x13bec6(0x104)]=![],this[_0x13bec6(0xe5)]=null,this[_0x13bec6(0x172)]=null,this[_0x13bec6(0xf6)]=SYSTEM_MODES[_0x13bec6(0x1e3)],this[_0x13bec6(0xdc)]=![],this['lastAlertState']=![],this[_0x13bec6(0x1f9)]=_0x13bec6(0x115),this[_0x13bec6(0x22e)]=null,this[_0x13bec6(0x17c)]=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this[_0x13bec6(0x206)]=null,this['on'](_0x13bec6(0x1f3),this['onReady'][_0x13bec6(0x236)](this)),this['on']('stateChange',this[_0x13bec6(0xe3)][_0x13bec6(0x236)](this)),this['on'](_0x13bec6(0x186),this['onUnload']['bind'](this)),this['on'](_0x13bec6(0x24c),this['onMessage'][_0x13bec6(0x236)](this));}async[a0_0x43e95d(0x13d)](){const _0x4c1732=a0_0x43e95d;this[_0x4c1732(0x160)][_0x4c1732(0x13c)](_0x4c1732(0x195)+this[_0x4c1732(0x243)]+')');try{const _0x281793=[_0x4c1732(0x12f),_0x4c1732(0x1ce),_0x4c1732(0x1b8),_0x4c1732(0x154),_0x4c1732(0xff),'events.history_debug_00',_0x4c1732(0x181),_0x4c1732(0x241),_0x4c1732(0x211),_0x4c1732(0x11d)];for(const _0x2f7bd4 of _0x281793){try{const _0x468cbf=await this[_0x4c1732(0x229)](_0x2f7bd4);_0x468cbf&&await this[_0x4c1732(0x1b3)](_0x2f7bd4);}catch(_0x5e6f83){}}}catch(_0x117729){}this[_0x4c1732(0x119)]['licenseKey']=this['config']['licenseKey']||'';try{this[_0x4c1732(0xdc)]=await this[_0x4c1732(0x1db)](this[_0x4c1732(0x119)]['licenseKey']);}catch(_0x3cc95b){this['log']['error'](_0x4c1732(0x207)+_0x3cc95b['message']);}if(!this[_0x4c1732(0x119)][_0x4c1732(0x21d)]||this[_0x4c1732(0x119)][_0x4c1732(0x21d)]<0.1)this[_0x4c1732(0x119)][_0x4c1732(0x21d)]=0xc;try{await this[_0x4c1732(0x225)]();}catch(_0x142c6b){this[_0x4c1732(0x160)][_0x4c1732(0x112)](_0x4c1732(0x1c4)+_0x142c6b[_0x4c1732(0x24c)]);}try{const _0x2c1fe2=await this[_0x4c1732(0x22d)]('system.config');_0x2c1fe2&&_0x2c1fe2[_0x4c1732(0x1df)]&&(this[_0x4c1732(0x1d0)]={'latitude':_0x2c1fe2['common'][_0x4c1732(0x1d9)]||0x0,'longitude':_0x2c1fe2['common'][_0x4c1732(0xe6)]||0x0,'city':_0x2c1fe2[_0x4c1732(0x1df)][_0x4c1732(0x145)]||''});}catch(_0x53cae4){}if(this[_0x4c1732(0x119)][_0x4c1732(0xee)])try{this[_0x4c1732(0xe5)]=new GoogleGenerativeAI(this['config'][_0x4c1732(0xee)]),this['geminiModel']=this[_0x4c1732(0xe5)][_0x4c1732(0x1a5)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x4c1732(0x14a)}}),this[_0x4c1732(0x160)][_0x4c1732(0x13c)](_0x4c1732(0x21e));}catch(_0x50a446){this[_0x4c1732(0x160)][_0x4c1732(0x112)](_0x4c1732(0x230)+_0x50a446[_0x4c1732(0x24c)]);}try{await this[_0x4c1732(0x114)]();}catch(_0x3f0866){this['log'][_0x4c1732(0x112)](_0x4c1732(0x187)+_0x3f0866[_0x4c1732(0x24c)]);}try{await this[_0x4c1732(0x20d)]();}catch(_0x3ed151){this['log'][_0x4c1732(0x112)](_0x4c1732(0x18a)+_0x3ed151['message']);}try{await this['loadRawEventLog']();}catch(_0x24ed5c){this['log'][_0x4c1732(0x112)]('loadRawEventLog\x20failed:\x20'+_0x24ed5c[_0x4c1732(0x24c)]);}try{await this[_0x4c1732(0x10d)]();}catch(_0xca9e55){this[_0x4c1732(0x160)]['error'](_0x4c1732(0x1c9)+_0xca9e55[_0x4c1732(0x24c)]);}this[_0x4c1732(0xd7)](_0x4c1732(0x189)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this['subscribeStates']('system.mode'),this[_0x4c1732(0xd7)]('analysis.triggerBriefing');const _0x1cb440=this[_0x4c1732(0x119)][_0x4c1732(0x16d)];if(_0x1cb440&&_0x1cb440[_0x4c1732(0x148)]>0x0){this[_0x4c1732(0x160)][_0x4c1732(0x13c)](_0x4c1732(0x126)+_0x1cb440[_0x4c1732(0x148)]+_0x4c1732(0xfc));for(const _0x4133c9 of _0x1cb440){if(_0x4133c9['id']){await this[_0x4c1732(0x239)](_0x4133c9['id']);try{const _0x552b2c=await this[_0x4c1732(0x202)](_0x4133c9['id']);if(_0x552b2c)this[_0x4c1732(0x1f0)][_0x4133c9['id']]=_0x552b2c['val'];}catch(_0x20419a){}}}}const _0x37dc06=this['config'][_0x4c1732(0xe4)]||[];if(_0x37dc06[_0x4c1732(0x148)]>0x0){this[_0x4c1732(0x160)][_0x4c1732(0x13c)](_0x4c1732(0x126)+_0x37dc06[_0x4c1732(0x148)]+_0x4c1732(0x1dc));for(const _0x51d8c1 of _0x37dc06){await this['subscribeForeignStatesAsync'](_0x51d8c1);}try{await this['checkWifiPresence']();}catch(_0x1fd92a){}}if(this['analysisTimer'])clearInterval(this['analysisTimer']);const _0x37bb13=this[_0x4c1732(0x119)][_0x4c1732(0x240)]||0xf;_0x37bb13>0x0&&(this[_0x4c1732(0x160)][_0x4c1732(0x13c)](_0x4c1732(0x108)+_0x37bb13+'\x20min).\x20Watchdog\x20Limit:\x20'+this[_0x4c1732(0x119)]['inactivityThresholdHours']+'h.'),this[_0x4c1732(0x22e)]=setInterval(()=>{const _0x66f035=_0x4c1732;try{this['runAutopilot']();}catch(_0x29bdf4){this[_0x66f035(0x160)][_0x66f035(0x112)](_0x66f035(0x15a)+_0x29bdf4[_0x66f035(0x24c)]);}},_0x37bb13*0x3c*0x3e8)),this['setupLtmScheduler'](),this[_0x4c1732(0x12c)](),this['setupDriftAnalysisScheduler'](),this[_0x4c1732(0x1d6)]();}[a0_0x43e95d(0x19c)](_0x1443e3){const _0xa0b587=a0_0x43e95d;if(this[_0xa0b587(0x22e)])clearInterval(this['analysisTimer']);if(this['driftAnalysisTimer'])clearInterval(this[_0xa0b587(0x1be)]);if(this['ltmJob'])this[_0xa0b587(0x17c)][_0xa0b587(0x17f)]();if(this['modeResetJob'])this[_0xa0b587(0x1a7)]['cancel']();if(this[_0xa0b587(0x206)])this[_0xa0b587(0x206)][_0xa0b587(0x17f)]();if(this['exitTimer'])clearTimeout(this[_0xa0b587(0x215)]);if(this[_0xa0b587(0x1f4)])clearTimeout(this[_0xa0b587(0x1f4)]);_0x1443e3();}async['onStateChange'](_0x4094e6,_0x385189){const _0x339dc2=a0_0x43e95d;if(!_0x385189)return;if(_0x4094e6===this[_0x339dc2(0x1a6)]+'.'+SYSTEM_DP_MODE){_0x385189[_0x339dc2(0xdf)]&&Object[_0x339dc2(0x201)](SYSTEM_MODES)[_0x339dc2(0x1fd)](_0x385189[_0x339dc2(0xdf)])&&(this['currentSystemMode']=_0x385189['val'],_0x385189[_0x339dc2(0xdf)]===SYSTEM_MODES[_0x339dc2(0x234)]?this['setPresence'](![]):this[_0x339dc2(0x1c3)](!![]));if(!_0x385189[_0x339dc2(0x174)])this[_0x339dc2(0x141)](_0x4094e6,{'val':this[_0x339dc2(0xf6)],'ack':!![]});return;}if(!_0x385189['ack']){_0x4094e6['includes'](_0x339dc2(0x189))&&_0x385189['val']&&(this[_0x339dc2(0x141)](_0x4094e6,{'val':![],'ack':!![]}),this[_0x339dc2(0x16a)]());if(_0x4094e6['includes'](_0x339dc2(0x11f))&&_0x385189['val']){this['setState'](_0x4094e6,{'val':![],'ack':!![]});if(this[_0x339dc2(0xdc)])this['createDailyDigest']();}_0x4094e6[_0x339dc2(0x1fd)]('triggerBriefing')&&_0x385189['val']&&(this[_0x339dc2(0x141)](_0x4094e6,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this[_0x339dc2(0x119)]['presenceDevices']&&this[_0x339dc2(0x119)][_0x339dc2(0xe4)]['includes'](_0x4094e6)){await this[_0x339dc2(0xfb)]();return;}const _0x275dd1=(this[_0x339dc2(0x119)]['devices']||[])[_0x339dc2(0x100)](_0x2bb8fa=>_0x2bb8fa['id']===_0x4094e6);if(_0x275dd1)this['processSensorEvent'](_0x4094e6,_0x385189,_0x275dd1);}async[a0_0x43e95d(0x22f)](_0x1c6dd9){const _0x5909b6=a0_0x43e95d;if(typeof _0x1c6dd9===_0x5909b6(0x15e)&&_0x1c6dd9[_0x5909b6(0x24c)])try{if(_0x1c6dd9['command']===_0x5909b6(0x1ca)){if(!_0x1c6dd9['message'][_0x5909b6(0x219)])return this['sendTo'](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':![],'message':_0x5909b6(0x15b)},_0x1c6dd9[_0x5909b6(0xfd)]);try{const _0x41c232=new GoogleGenerativeAI(_0x1c6dd9[_0x5909b6(0x24c)][_0x5909b6(0x219)])[_0x5909b6(0x1a5)]({'model':_0x5909b6(0xec)});await _0x41c232['generateContent']('test'),this['sendTo'](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9['command'],{'success':!![],'message':_0x5909b6(0x1b0)},_0x1c6dd9[_0x5909b6(0xfd)]);}catch(_0x3e4a93){this[_0x5909b6(0x1a4)](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':![],'message':_0x3e4a93[_0x5909b6(0x24c)]},_0x1c6dd9['callback']);}}else{if(_0x1c6dd9['command']==='testNotification'){const _0x9f47f=await this[_0x5909b6(0xf3)](_0x5909b6(0x167),!![]);this[_0x5909b6(0x1a4)](_0x1c6dd9['from'],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':_0x9f47f>0x0,'message':_0x9f47f+_0x5909b6(0x107)},_0x1c6dd9[_0x5909b6(0xfd)]);}else{if(_0x1c6dd9[_0x5909b6(0x1dd)]===_0x5909b6(0xed)){if(!this[_0x5909b6(0xdc)])return this[_0x5909b6(0x1a4)](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':![],'isPro':![]},_0x1c6dd9[_0x5909b6(0xfd)]);let _0x1f37d7={'status':_0x5909b6(0x21a),'details':'','lastCheck':0x0};try{_0x1f37d7['status']=(await this[_0x5909b6(0x164)](LTM_DP_DRIFT_STATUS))[_0x5909b6(0xdf)],_0x1f37d7[_0x5909b6(0x21c)]=(await this[_0x5909b6(0x164)](LTM_DP_DRIFT_DETAILS))[_0x5909b6(0xdf)],_0x1f37d7[_0x5909b6(0x17d)]=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x5909b6(0xdf)];}catch(_0x31384d){}this[_0x5909b6(0x1a4)](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x5909b6(0x190)],'driftAnalysis':_0x1f37d7,'analysisHistory':this['analysisHistory']},_0x1c6dd9[_0x5909b6(0xfd)]);}else{if(_0x1c6dd9[_0x5909b6(0x1dd)]===_0x5909b6(0x196)){const _0x4d1c2b=await this[_0x5909b6(0x134)](_0x5909b6(0x13f),'enum'),_0x55133e=[];if(_0x4d1c2b)for(const _0x2581ff in _0x4d1c2b){const _0x4f64fa=_0x4d1c2b[_0x2581ff],_0x15c29f=(_0x4f64fa[_0x5909b6(0x1df)]&&typeof _0x4f64fa[_0x5909b6(0x1df)][_0x5909b6(0x18e)]===_0x5909b6(0x15e)?_0x4f64fa['common']['name']['de']:_0x4f64fa['common'][_0x5909b6(0x18e)])||_0x4f64fa[_0x5909b6(0x1df)][_0x5909b6(0x18e)];_0x55133e[_0x5909b6(0x176)]({'id':_0x2581ff,'name':_0x15c29f});}this[_0x5909b6(0x1a4)](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':!![],'enums':_0x55133e},_0x1c6dd9[_0x5909b6(0xfd)]);}else{if(_0x1c6dd9[_0x5909b6(0x1dd)]==='scanDevices')try{const _0x15a0c4=await this[_0x5909b6(0xf1)](_0x1c6dd9[_0x5909b6(0x24c)]||{});this['sendTo'](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':!![],'devices':_0x15a0c4},_0x1c6dd9[_0x5909b6(0xfd)]);}catch(_0x435f28){this['sendTo'](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':![],'error':_0x435f28[_0x5909b6(0x24c)]},_0x1c6dd9[_0x5909b6(0xfd)]);}else{if(_0x1c6dd9[_0x5909b6(0x1dd)]==='submitFeedback'){const {historyId:_0x4af7d3,rating:_0x4b88a5,comment:_0x580ed7,alertReason:_0x3a3337}=_0x1c6dd9[_0x5909b6(0x24c)];_0x4af7d3&&_0x4b88a5?(await this['saveFeedback']({'timestamp':Date[_0x5909b6(0x19b)](),'historyId':_0x4af7d3,'rating':_0x4b88a5,'comment':_0x580ed7,'alertReason':_0x3a3337}),this['sendTo'](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':!![]},_0x1c6dd9[_0x5909b6(0xfd)])):this[_0x5909b6(0x1a4)](_0x1c6dd9['from'],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':![],'error':_0x5909b6(0x188)},_0x1c6dd9[_0x5909b6(0xfd)]);}else{if(_0x1c6dd9[_0x5909b6(0x1dd)]===_0x5909b6(0xd8)){const _0x3e5139=await this['getWeatherContext'](),_0x23c2f0=await this[_0x5909b6(0x1ad)]();this['sendTo'](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9['command'],{'success':!![],'weather':_0x3e5139,'calendar':_0x23c2f0},_0x1c6dd9[_0x5909b6(0xfd)]);}else{if(_0x1c6dd9[_0x5909b6(0x1dd)]===_0x5909b6(0x208)){const _0x59c92c=_0x1c6dd9[_0x5909b6(0x24c)][_0x5909b6(0x1ee)];if(!_0x59c92c)return this[_0x5909b6(0x1a4)](_0x1c6dd9['from'],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':![],'error':_0x5909b6(0x1b7)},_0x1c6dd9[_0x5909b6(0xfd)]);const _0x5a9f05=await this[_0x5909b6(0x208)](_0x59c92c);this[_0x5909b6(0x1a4)](_0x1c6dd9['from'],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':!![],'names':_0x5a9f05},_0x1c6dd9['callback']);}}}}}}}}}catch(_0xa07bac){if(_0x1c6dd9['callback'])this[_0x5909b6(0x1a4)](_0x1c6dd9[_0x5909b6(0x1e6)],_0x1c6dd9[_0x5909b6(0x1dd)],{'success':![],'error':_0xa07bac[_0x5909b6(0x24c)]},_0x1c6dd9['callback']);}}async[a0_0x43e95d(0x10b)](_0x558876,_0x558e09,_0x44ceed){const _0x2ca97c=a0_0x43e95d;if(!_0x44ceed[_0x2ca97c(0x217)]&&this['sensorLastValues'][_0x558876]===_0x558e09[_0x2ca97c(0xdf)])return;this['sensorLastValues'][_0x558876]=_0x558e09[_0x2ca97c(0xdf)];if(this['isGracePeriodActive'])return;const _0xaed426=await this[_0x2ca97c(0xfb)]();if(_0xaed426){if(!this['isPresent'])this['setPresence'](!![]);}else{const _0x292307=_0x44ceed[_0x2ca97c(0x110)]===!![];_0x292307?this[_0x2ca97c(0x19a)]():(this[_0x2ca97c(0x215)]&&(this['log'][_0x2ca97c(0x13c)](_0x2ca97c(0x23e)),this[_0x2ca97c(0x14d)]()),!this[_0x2ca97c(0x1e9)]&&this['currentSystemMode']===SYSTEM_MODES[_0x2ca97c(0x1e3)]&&this[_0x2ca97c(0x1c3)](!![]));}const _0x2fb27a={'timestamp':_0x558e09['ts'],'id':_0x558876,'name':_0x44ceed[_0x2ca97c(0x18e)],'value':_0x558e09[_0x2ca97c(0xdf)],'location':_0x44ceed[_0x2ca97c(0x1b1)],'type':_0x44ceed['type']};this[_0x2ca97c(0x10f)][_0x2ca97c(0x21f)](_0x2fb27a);if(this[_0x2ca97c(0x10f)][_0x2ca97c(0x148)]>HISTORY_MAX_SIZE)this[_0x2ca97c(0x10f)][_0x2ca97c(0x163)]();await this[_0x2ca97c(0x106)](_0x2ca97c(0x1f6),{'val':JSON['stringify'](_0x2fb27a),'ack':!![]}),await this[_0x2ca97c(0x106)](_0x2ca97c(0x203),{'val':JSON['stringify'](this[_0x2ca97c(0x10f)]),'ack':!![]}),this[_0x2ca97c(0x149)][_0x2ca97c(0x176)]({'timestamp':new Date(_0x558e09['ts'])['toISOString'](),'sensorName':_0x44ceed[_0x2ca97c(0x18e)],'location':_0x44ceed[_0x2ca97c(0x1b1)],'value':_0x558e09['val']}),await this[_0x2ca97c(0x224)]();}async[a0_0x43e95d(0xe9)](){const _0x33be9d=a0_0x43e95d,_0x5a9e13=this[_0x33be9d(0x119)][_0x33be9d(0x21d)],_0x1c93dd=this[_0x33be9d(0x119)][_0x33be9d(0x16e)],_0x273be1=this[_0x33be9d(0x10f)]['length']>0x0?this[_0x33be9d(0x10f)][0x0][_0x33be9d(0x1a2)]:Date[_0x33be9d(0x19b)](),_0x2ccb04=(Date[_0x33be9d(0x19b)]()-_0x273be1)/(0x3e8*0x3c*0x3c);let _0x1b980c='';_0x1c93dd&&this[_0x33be9d(0xf6)]===SYSTEM_MODES[_0x33be9d(0x1e3)]&&this[_0x33be9d(0x1e9)]&&(_0x2ccb04>_0x5a9e13&&(_0x1b980c=_0x33be9d(0x1b2)+_0x2ccb04['toFixed'](0x1)+_0x33be9d(0x1f2)));if(_0x1b980c){this[_0x33be9d(0x16a)](_0x1b980c)[_0x33be9d(0x142)](_0x4c3101=>this[_0x33be9d(0x160)][_0x33be9d(0x112)](_0x4c3101));return;}const _0x4cae6d=Date[_0x33be9d(0x19b)](),_0x2fbb08=_0x4cae6d-_0x273be1,_0xc05373=(this[_0x33be9d(0x119)][_0x33be9d(0x240)]||0xf)*0x3c*0x3e8;this[_0x33be9d(0x10f)][_0x33be9d(0x148)]>0x0&&_0x2fbb08<=_0xc05373?this[_0x33be9d(0x16a)]()[_0x33be9d(0x142)](_0x156a6e=>this['log'][_0x33be9d(0x112)](_0x156a6e)):!this[_0x33be9d(0x165)]&&(this[_0x33be9d(0x141)](_0x33be9d(0x20a),{'val':![],'ack':!![]}),this[_0x33be9d(0x141)]('analysis.isEmergency',{'val':![],'ack':!![]}));}async['runGeminiAnalysis'](_0x512800=''){const _0x5c386a=a0_0x43e95d;if(!this['geminiModel'])return;const _0x38a182=this['eventHistory'][_0x5c386a(0x148)]>0x0?this[_0x5c386a(0x10f)]:[{'note':_0x5c386a(0x1ec)}],_0x2e39e3=PERSONA_MAPPING[this[_0x5c386a(0x119)][_0x5c386a(0x1f7)]||_0x5c386a(0x1ff)],_0x440c6c=this[_0x5c386a(0x119)][_0x5c386a(0x102)]||'',_0x1b92df=this[_0x5c386a(0xf6)],_0x17eb58=await this[_0x5c386a(0x111)](),_0x38332a=await this[_0x5c386a(0x1ad)](),_0x348362=(_0x17eb58+'\x20'+_0x38332a)[_0x5c386a(0x1e2)](),_0x1173fa=new Date(),_0x741349=_0x1173fa[_0x5c386a(0x15c)](_0x5c386a(0x11a),{'weekday':'long','hour':'2-digit','minute':_0x5c386a(0x18b)}),_0x2694d2=this['systemConfig'];let _0x339a59='';if(this['feedbackHistory']['length']>0x0){const _0x3a0c9b=this[_0x5c386a(0x1e7)][_0x5c386a(0x213)](0x0,0x3)['map'](_0x24f692=>_0x5c386a(0x11b)+_0x24f692[_0x5c386a(0x157)]+_0x5c386a(0x1c0)+_0x24f692[_0x5c386a(0x116)]+'.')[_0x5c386a(0x166)]('\x0a');_0x339a59=_0x5c386a(0xea)+_0x3a0c9b+'\x0a';}const _0x3a431d=_0x512800?_0x5c386a(0x17e)+_0x512800+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x381334=_0x5c386a(0x1c8),_0x1d59f8=_0x5c386a(0x1bb)+_0x741349+_0x5c386a(0x1a8)+_0x2694d2[_0x5c386a(0x145)]+_0x5c386a(0x23c)+_0x1b92df+'.\x20PR√ÑSENZ:\x20'+(this[_0x5c386a(0x1e9)]?'Ja':_0x5c386a(0x247))+_0x5c386a(0x216)+_0x440c6c+'.\x20PERSONA:\x20'+_0x2e39e3+_0x5c386a(0x15f)+_0x348362+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x381334+'\x20'+_0x339a59+'\x20'+_0x3a431d+_0x5c386a(0x12d)+JSON[_0x5c386a(0xd5)](_0x38a182)+_0x5c386a(0x1ae);try{const _0x3acc15=await this[_0x5c386a(0x172)][_0x5c386a(0x221)](_0x1d59f8),_0x5f2118=_0x3acc15[_0x5c386a(0xf5)][_0x5c386a(0x1bf)]()[_0x5c386a(0x1d4)](/```json|```/g,'')[_0x5c386a(0x1e2)](),_0x2d811d=JSON[_0x5c386a(0x131)](_0x5f2118);await this[_0x5c386a(0x106)]('analysis.lastResult',{'val':_0x5f2118,'ack':!![]}),await this[_0x5c386a(0x106)](_0x5c386a(0x249),{'val':_0x2d811d[_0x5c386a(0x24b)][_0x5c386a(0x157)]||'','ack':!![]}),await this['setStateAsync'](_0x5c386a(0x16f),{'val':_0x2d811d[_0x5c386a(0x24b)][_0x5c386a(0x170)]||_0x5c386a(0x21a),'ack':!![]}),await this[_0x5c386a(0x106)](_0x5c386a(0x1aa),{'val':_0x2d811d['activity']['deviationFromBaseline']||_0x5c386a(0x21a),'ack':!![]});_0x2d811d['comfort']&&(await this[_0x5c386a(0x106)](_0x5c386a(0x19e),{'val':_0x2d811d[_0x5c386a(0x24a)][_0x5c386a(0x170)]||'','ack':!![]}),await this[_0x5c386a(0x106)](_0x5c386a(0x204),{'val':_0x2d811d[_0x5c386a(0x24a)][_0x5c386a(0x18f)]||'','ack':!![]}),_0x2d811d[_0x5c386a(0x24a)][_0x5c386a(0x159)]&&(await this['setStateAsync'](_0x5c386a(0x1e4),{'val':_0x2d811d[_0x5c386a(0x24a)][_0x5c386a(0x159)][_0x5c386a(0x228)]||![],'ack':!![]}),await this[_0x5c386a(0x106)]('analysis.automation.description',{'val':_0x2d811d[_0x5c386a(0x24a)][_0x5c386a(0x159)][_0x5c386a(0x1b5)]||'','ack':!![]}),await this[_0x5c386a(0x106)]('analysis.automation.suggestedAction',{'val':_0x2d811d['comfort'][_0x5c386a(0x159)]['suggestedAction']||'','ack':!![]})));_0x2d811d['health']&&(await this[_0x5c386a(0x106)]('analysis.health.sleepScore',{'val':typeof _0x2d811d['health']['sleepScore']===_0x5c386a(0x1f1)?_0x2d811d[_0x5c386a(0x1e0)][_0x5c386a(0x1d8)]:0x0,'ack':!![]}),await this[_0x5c386a(0x106)](_0x5c386a(0x1fa),{'val':_0x2d811d[_0x5c386a(0x1e0)][_0x5c386a(0x1da)]||_0x5c386a(0x175),'ack':!![]}),await this[_0x5c386a(0x106)](_0x5c386a(0x132),{'val':_0x2d811d['health']['notes']||'','ack':!![]}));const _0x465008=_0x2d811d[_0x5c386a(0x24b)]['isAlert']||![],_0x1fb61a=_0x2d811d[_0x5c386a(0x24b)][_0x5c386a(0x146)]||![];if(_0x465008||_0x1fb61a){await this['setStateAsync'](_0x5c386a(0x20a),{'val':!![],'ack':!![]}),await this['setStateAsync']('analysis.isEmergency',{'val':_0x1fb61a,'ack':!![]});if(!this[_0x5c386a(0x165)]||_0x1fb61a){const _0x3e6270=_0x1fb61a?_0x5c386a(0x178):_0x5c386a(0x10e);this[_0x5c386a(0xf3)](_0x3e6270+':\x20'+_0x2d811d['activity']['alertReason'],![],_0x1fb61a);}}else await this[_0x5c386a(0x106)](_0x5c386a(0x20a),{'val':![],'ack':!![]}),await this[_0x5c386a(0x106)]('analysis.isEmergency',{'val':![],'ack':!![]});this['lastAlertState']=_0x465008||_0x1fb61a;const _0x137e1a={'timestamp':Date[_0x5c386a(0x19b)](),'id':Date[_0x5c386a(0x19b)]()[_0x5c386a(0x117)](),'analysis':_0x2d811d,'systemMode':_0x1b92df,'isPro':this[_0x5c386a(0xdc)]};this[_0x5c386a(0x168)](_0x137e1a);}catch(_0x50efdc){this[_0x5c386a(0x160)][_0x5c386a(0x112)](_0x5c386a(0x20c)+_0x50efdc[_0x5c386a(0x24c)]);}}async[a0_0x43e95d(0x1bd)](){const _0xa57b65=a0_0x43e95d;if(!this[_0xa57b65(0x172)]||this['rawEventLog']['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0xa57b65(0x106)](LTM_DP_STATUS,{'val':'Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','ack':!![]});return;}this['log'][_0xa57b65(0x13c)](_0xa57b65(0x205)+this[_0xa57b65(0x149)][_0xa57b65(0x148)]+_0xa57b65(0x231)),await this[_0xa57b65(0x106)](LTM_DP_STATUS,{'val':_0xa57b65(0x125),'ack':!![]});const _0x68098c=this[_0xa57b65(0x149)]['length']>0x320?this[_0xa57b65(0x149)][_0xa57b65(0x213)](this[_0xa57b65(0x149)][_0xa57b65(0x148)]-0x320):this['rawEventLog'],_0xa0ac9c=PERSONA_MAPPING[this[_0xa57b65(0x119)][_0xa57b65(0x1f7)]||'generic'],_0x35c2e9=_0xa57b65(0x23b)+_0xa0ac9c+_0xa57b65(0x232)+JSON[_0xa57b65(0xd5)](_0x68098c)+_0xa57b65(0x173);try{const _0x697330=await this[_0xa57b65(0x172)]['generateContent'](_0x35c2e9),_0xd9c528=_0x697330[_0xa57b65(0xf5)][_0xa57b65(0x1bf)]()[_0xa57b65(0x1d4)](/```json|```/g,'')[_0xa57b65(0x1e2)](),_0x31932a=JSON[_0xa57b65(0x131)](_0xd9c528),_0x566960={'timestamp':new Date()[_0xa57b65(0x1cb)](),'eventCount':this['rawEventLog']['length'],'summary':_0x31932a[_0xa57b65(0x170)],'activityLevel':_0x31932a[_0xa57b65(0xe2)],'health':{'sleepScore':_0x31932a['health']?_0x31932a[_0xa57b65(0x1e0)][_0xa57b65(0x1d8)]:0x0,'restlessness':_0x31932a[_0xa57b65(0x1e0)]?_0x31932a[_0xa57b65(0x1e0)][_0xa57b65(0x1da)]:'none'},'systemMode':this[_0xa57b65(0xf6)]};this['dailyDigests'][_0xa57b65(0x176)](_0x566960),await this[_0xa57b65(0x144)](),this[_0xa57b65(0x149)]=[],await this[_0xa57b65(0x224)](),await this[_0xa57b65(0x106)](LTM_DP_STATUS,{'val':_0xa57b65(0x17b),'ack':!![]}),this[_0xa57b65(0x160)][_0xa57b65(0x13c)](_0xa57b65(0x153));}catch(_0x3b8212){this[_0xa57b65(0x160)][_0xa57b65(0x112)]('Daily\x20Digest\x20Error:\x20'+_0x3b8212['message']),await this[_0xa57b65(0x106)](LTM_DP_STATUS,{'val':_0xa57b65(0xfa)+_0x3b8212[_0xa57b65(0x24c)],'ack':!![]});}}async[a0_0x43e95d(0xd9)](){const _0x1e966b=a0_0x43e95d;if(!this[_0x1e966b(0x172)])return;this[_0x1e966b(0x160)][_0x1e966b(0x13c)]('Generating\x20Morning\x20Briefing...');const _0x22f469=this['dailyDigests'][_0x1e966b(0x148)]>0x0?this[_0x1e966b(0x190)][this[_0x1e966b(0x190)][_0x1e966b(0x148)]-0x1]:null,_0x13ccfc=_0x22f469&&_0x22f469[_0x1e966b(0x1e0)]?_0x22f469[_0x1e966b(0x1e0)][_0x1e966b(0x1d8)]:_0x1e966b(0x21a),_0x17f8cd=new Date();_0x17f8cd['setHours'](0x4,0x0,0x0,0x0);const _0x58f796=this['eventHistory'][_0x1e966b(0xe7)](_0x341cf6=>new Date(_0x341cf6[_0x1e966b(0x1a2)])>_0x17f8cd),_0x5ba59d=PERSONA_MAPPING[this[_0x1e966b(0x119)][_0x1e966b(0x1f7)]||_0x1e966b(0x1ff)],_0x1e3b31=this[_0x1e966b(0x119)]['livingContext']||'',_0x14e73e=await this[_0x1e966b(0x111)](),_0x589683=await this[_0x1e966b(0x1ad)](),_0x54e4d3=_0x1e966b(0x214)+_0x5ba59d+_0x1e966b(0xfe)+_0x1e3b31+_0x1e966b(0x245)+_0x14e73e+'\x20'+_0x589683+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20'+_0x13ccfc+_0x1e966b(0x127)+JSON[_0x1e966b(0xd5)](_0x58f796[_0x1e966b(0x213)](0x0,0xa))+_0x1e966b(0x1bc);try{const _0x133bd4=await this[_0x1e966b(0x172)][_0x1e966b(0x221)](_0x54e4d3),_0x3f9468=_0x1e966b(0x1de)+_0x133bd4[_0x1e966b(0xf5)][_0x1e966b(0x1bf)]()[_0x1e966b(0x1e2)]();this[_0x1e966b(0xf3)](_0x3f9468),this[_0x1e966b(0x160)]['info'](_0x1e966b(0x12e));}catch(_0x1f3c36){this[_0x1e966b(0x160)]['error']('Briefing\x20Error:\x20'+_0x1f3c36[_0x1e966b(0x24c)]);}}[a0_0x43e95d(0x227)](_0x243f87){const _0x4822e9=a0_0x43e95d;if(typeof _0x243f87===_0x4822e9(0x15e))return _0x243f87;try{return JSON['parse'](_0x243f87);}catch(_0x443218){return null;}}async[a0_0x43e95d(0x111)](){const _0x4db849=a0_0x43e95d;try{if(!this[_0x4db849(0x119)][_0x4db849(0x162)])return'Wetter:\x20Deaktiviert';let _0x2882fc='';const _0x28dff7=this['config'][_0x4db849(0x21b)];if(_0x28dff7)try{if(_0x28dff7[_0x4db849(0x1fd)](_0x4db849(0xf0))){const _0x26016e=await this[_0x4db849(0x202)](_0x28dff7+_0x4db849(0x223));if(_0x26016e&&_0x26016e[_0x4db849(0xdf)])_0x2882fc=_0x26016e['val'];}else{if(_0x28dff7[_0x4db849(0x1fd)](_0x4db849(0x14b))){const _0x1a6485=await this[_0x4db849(0x202)](_0x28dff7+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0x1a6485&&_0x1a6485[_0x4db849(0xdf)])_0x2882fc=_0x1a6485[_0x4db849(0xdf)];}else{if(_0x28dff7[_0x4db849(0x1fd)](_0x4db849(0xef))){const _0x4f80ed=await this[_0x4db849(0x202)](_0x28dff7+'.forecast.current.state');if(_0x4f80ed&&_0x4f80ed[_0x4db849(0xdf)])_0x2882fc=_0x4f80ed['val'];}}}}catch(_0x25ee5e){}if(!_0x2882fc){const _0x1bcc55=[_0x4db849(0x23a),'daswetter.0',_0x4db849(0x218),'openweathermap.0'];for(const _0xf2cf02 of _0x1bcc55){try{const _0x2b8fc7=await this[_0x4db849(0x22d)](_0xf2cf02);if(_0x2b8fc7){if(_0xf2cf02[_0x4db849(0x1fd)](_0x4db849(0xf0))){const _0x406d40=await this['getForeignStateAsync'](_0xf2cf02+_0x4db849(0x223));if(_0x406d40&&_0x406d40[_0x4db849(0xdf)]){_0x2882fc=_0x406d40[_0x4db849(0xdf)];break;}}}}catch(_0x50bfdc){}}}return _0x2882fc?_0x4db849(0x128)+_0x2882fc:'WETTER:\x20Keine\x20Daten';}catch(_0xe9feb9){return _0x4db849(0x14f)+_0xe9feb9[_0x4db849(0x24c)];}}async['getCalendarContext'](){const _0x3de4ae=a0_0x43e95d;try{if(!this[_0x3de4ae(0x119)]['useCalendar'])return _0x3de4ae(0xf9);let _0x4a2361=this[_0x3de4ae(0x119)][_0x3de4ae(0x185)]||_0x3de4ae(0x138),_0x298dd9=this[_0x3de4ae(0x119)][_0x3de4ae(0x226)]||[];if(typeof _0x298dd9===_0x3de4ae(0xe0))_0x298dd9=_0x298dd9[_0x3de4ae(0x124)](',');try{const _0x19819d=await this[_0x3de4ae(0x202)](_0x4a2361+_0x3de4ae(0x1cc));if(_0x19819d&&_0x19819d[_0x3de4ae(0xdf)]){let _0x5ca2ee=this[_0x3de4ae(0x227)](_0x19819d[_0x3de4ae(0xdf)]);if(_0x5ca2ee&&Array[_0x3de4ae(0x1eb)](_0x5ca2ee)){if(_0x298dd9[_0x3de4ae(0x148)]>0x0)_0x5ca2ee=_0x5ca2ee[_0x3de4ae(0xe7)](_0x222c2e=>_0x298dd9['includes'](_0x222c2e[_0x3de4ae(0x122)]||''));else return _0x3de4ae(0x13e);if(_0x5ca2ee[_0x3de4ae(0x148)]>0x0){const _0x110b77=_0x5ca2ee[_0x3de4ae(0x213)](0x0,0x3)['map'](_0x1371e8=>{const _0x27766c=_0x3de4ae;let _0xe0d9f4=_0x1371e8['date'];if(_0x1371e8[_0x27766c(0x1cd)])_0xe0d9f4+='\x20'+_0x1371e8[_0x27766c(0x1cd)];return _0xe0d9f4+':\x20'+_0x1371e8[_0x27766c(0x155)]+'\x20('+_0x1371e8[_0x27766c(0x122)]+')';});return _0x3de4ae(0x1af)+_0x110b77['join'](_0x3de4ae(0x193));}else return _0x3de4ae(0x177);}}}catch(_0x17ea75){this[_0x3de4ae(0x160)][_0x3de4ae(0x238)](_0x3de4ae(0x16b)+_0x17ea75[_0x3de4ae(0x24c)]);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x23df86){return _0x3de4ae(0x109)+_0x23df86[_0x3de4ae(0x24c)];}}async['getCalendarNames'](_0x637f9e){const _0x1a1607=a0_0x43e95d;try{const _0x5e7a1c=await this[_0x1a1607(0x202)](_0x637f9e+_0x1a1607(0x1cc));if(_0x5e7a1c&&_0x5e7a1c[_0x1a1607(0xdf)]){const _0x3de1a4=this[_0x1a1607(0x227)](_0x5e7a1c[_0x1a1607(0xdf)]);if(_0x3de1a4&&Array[_0x1a1607(0x1eb)](_0x3de1a4)){const _0x249199=[...new Set(_0x3de1a4['map'](_0x59b2e5=>_0x59b2e5['_calName'])[_0x1a1607(0xe7)](Boolean))];return _0x249199[_0x1a1607(0x10c)]();}}return[];}catch(_0x477cf9){return this[_0x1a1607(0x160)][_0x1a1607(0x112)](_0x1a1607(0x1e5)+_0x477cf9[_0x1a1607(0x24c)]),[];}}async[a0_0x43e95d(0x225)](){const _0x2bd00f=a0_0x43e95d;try{const _0x52d911=await this[_0x2bd00f(0x164)](_0x2bd00f(0x203));_0x52d911&&_0x52d911[_0x2bd00f(0xdf)]&&(this['eventHistory']=JSON[_0x2bd00f(0x131)](_0x52d911[_0x2bd00f(0xdf)][_0x2bd00f(0x117)]()));}catch(_0x493126){this['eventHistory']=[];}try{const _0x51205c=await this[_0x2bd00f(0x164)](_0x2bd00f(0x136));if(_0x51205c&&_0x51205c[_0x2bd00f(0xdf)])this['analysisHistory']=JSON['parse'](_0x51205c[_0x2bd00f(0xdf)]['toString']());}catch(_0x38e550){this[_0x2bd00f(0x15d)]=[];}}async[a0_0x43e95d(0x1fe)](){const _0x5f1e35=a0_0x43e95d;try{const _0x58b373=await this[_0x5f1e35(0x22d)](_0x5f1e35(0xda));if(_0x58b373&&_0x58b373[_0x5f1e35(0x1ba)]&&_0x58b373[_0x5f1e35(0x1ba)][_0x5f1e35(0x1ea)])return _0x58b373[_0x5f1e35(0x1ba)][_0x5f1e35(0x1ea)];return _0x5f1e35(0x1f5);}catch(_0xeb0ce8){return _0x5f1e35(0x184);}}async[a0_0x43e95d(0x1db)](_0x548f13){const _0x1f1fc2=a0_0x43e95d;if(!_0x548f13)return![];this[_0x1f1fc2(0x1f9)]=await this[_0x1f1fc2(0x1fe)]();if(_0x548f13===_0x1f1fc2(0x121)||_0x548f13[_0x1f1fc2(0x22b)](_0x1f1fc2(0x19f)))return!![];return![];}async[a0_0x43e95d(0x13b)](){const _0x244521=a0_0x43e95d;await this[_0x244521(0x198)](_0x244521(0x150),{'type':'channel','common':{'name':_0x244521(0x150)},'native':{}}),await this['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x244521(0x12a),'type':_0x244521(0xe0),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x244521(0x198)](LTM_DP_DAILY_DIGESTS,{'type':_0x244521(0x151),'common':{'name':_0x244521(0x18d),'type':_0x244521(0xe0),'role':_0x244521(0xe8),'read':!![],'write':![]},'native':{}}),await this[_0x244521(0x198)](LTM_DP_STATUS,{'type':_0x244521(0x151),'common':{'name':_0x244521(0x246),'type':_0x244521(0xe0),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x244521(0x198)](LTM_DP_TRIGGER_DIGEST,{'type':_0x244521(0x151),'common':{'name':_0x244521(0x1d3),'type':_0x244521(0xdd),'role':_0x244521(0x13a),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x244521(0x198)](LTM_DP_BASELINE_STATUS,{'type':_0x244521(0x151),'common':{'name':_0x244521(0x182),'type':'string','role':_0x244521(0x1bf),'read':!![],'write':![]},'native':{}});}async[a0_0x43e95d(0x1a9)](){const _0xb9ada8=a0_0x43e95d;await this[_0xb9ada8(0x198)](LTM_DP_DRIFT_CHANNEL,{'type':_0xb9ada8(0x1e1),'common':{'name':'Drift\x20Analysis'},'native':{}}),await this[_0xb9ada8(0x198)](LTM_DP_DRIFT_STATUS,{'type':_0xb9ada8(0x151),'common':{'name':'Drift\x20Status','type':_0xb9ada8(0xe0),'role':_0xb9ada8(0x151),'read':!![],'write':![],'def':_0xb9ada8(0x21a)},'native':{}}),await this[_0xb9ada8(0x198)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':_0xb9ada8(0xe0),'role':_0xb9ada8(0x1bf),'read':!![],'write':![]},'native':{}}),await this[_0xb9ada8(0x198)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0xb9ada8(0x151),'common':{'name':'Last\x20Check','type':_0xb9ada8(0x1f1),'role':_0xb9ada8(0x200),'read':!![],'write':![]},'native':{}});}async[a0_0x43e95d(0x1fb)](){const _0x426fe1=a0_0x43e95d;await this[_0x426fe1(0x198)](_0x426fe1(0x1ab),{'type':_0x426fe1(0x1e1),'common':{'name':_0x426fe1(0x210)},'native':{}}),await this[_0x426fe1(0x198)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x426fe1(0x103),'type':_0x426fe1(0xe0),'role':_0x426fe1(0x151),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x426fe1(0x1e3)],'states':{[SYSTEM_MODES[_0x426fe1(0x1e3)]]:_0x426fe1(0x1cf),[SYSTEM_MODES[_0x426fe1(0x234)]]:_0x426fe1(0x140),[SYSTEM_MODES['PARTY']]:_0x426fe1(0x22c),[SYSTEM_MODES[_0x426fe1(0x101)]]:_0x426fe1(0x1e8)}},'native':{}});}async[a0_0x43e95d(0xf3)](_0x5a79bc,_0x58072c=![],_0x49f67c=![]){const _0x1e3d91=a0_0x43e95d;this[_0x1e3d91(0x160)]['info']((_0x58072c?'[TEST]\x20':'')+'Sending\x20notification:\x20\x22'+_0x5a79bc+'\x22'+(_0x49f67c?_0x1e3d91(0x179):''));const _0x126ef4=this[_0x1e3d91(0x119)];let _0x1837ec=0x0;_0x126ef4[_0x1e3d91(0x1b9)]&&_0x126ef4[_0x1e3d91(0xde)]&&(await this[_0x1e3d91(0x1f8)](_0x126ef4[_0x1e3d91(0xde)],_0x1e3d91(0x130),{'text':_0x5a79bc,'user':_0x126ef4['notifyTelegramRecipient']}),_0x1837ec++);if(_0x126ef4['notifyPushoverEnabled']&&_0x126ef4[_0x1e3d91(0x18c)]){let _0x5ca3f6={'message':_0x5a79bc,'title':_0x49f67c?_0x1e3d91(0x1d1):_0x1e3d91(0x11e),'priority':_0x49f67c?0x2:0x1,'device':_0x126ef4[_0x1e3d91(0x12b)]};_0x49f67c&&(_0x5ca3f6[_0x1e3d91(0x161)]=0x1e,_0x5ca3f6[_0x1e3d91(0x235)]=0xe10,_0x5ca3f6[_0x1e3d91(0x158)]=_0x1e3d91(0x1fc)),await this[_0x1e3d91(0x1f8)](_0x126ef4[_0x1e3d91(0x18c)],'send',_0x5ca3f6),_0x1837ec++;}return _0x126ef4[_0x1e3d91(0x209)]&&_0x126ef4[_0x1e3d91(0x237)]&&(await this[_0x1e3d91(0x1f8)](_0x126ef4['notifyEmailInstance'],'send',{'text':_0x5a79bc,'to':_0x126ef4[_0x1e3d91(0x133)]}),_0x1837ec++),_0x126ef4['notifyWhatsappEnabled']&&_0x126ef4[_0x1e3d91(0x199)]&&(await this[_0x1e3d91(0x1f8)](_0x126ef4[_0x1e3d91(0x199)],'send',{'text':_0x5a79bc,'phone':_0x126ef4[_0x1e3d91(0x1a3)]}),_0x1837ec++),_0x126ef4[_0x1e3d91(0x1c5)]&&_0x126ef4[_0x1e3d91(0x19d)]&&(await this['sendToAsync'](_0x126ef4[_0x1e3d91(0x19d)],_0x1e3d91(0x130),{'text':_0x5a79bc,'phone':_0x126ef4[_0x1e3d91(0x1c2)]}),_0x1837ec++),_0x1837ec;}async[a0_0x43e95d(0xf1)](_0x58175d={}){const _0x3c28b4=a0_0x43e95d;this[_0x3c28b4(0x160)][_0x3c28b4(0x13c)]('Starting\x20Smart\x20Scan\x20with\x20filters:\x20'+JSON[_0x3c28b4(0xd5)](_0x58175d));const _0x13a8fb=[],_0x55a9d8=_0x58175d[_0x3c28b4(0x222)]!==![],_0x5635f9=_0x58175d[_0x3c28b4(0x180)]!==![],_0x270f8a=_0x58175d[_0x3c28b4(0x1d5)]!==![],_0x98b0f4=_0x58175d[_0x3c28b4(0x1a0)]===!![],_0x7bdc94=_0x58175d['weather']===!![],_0x4262c8=_0x58175d[_0x3c28b4(0xf2)]||[],_0x3f680c=await this[_0x3c28b4(0x134)]('enum.rooms.*',_0x3c28b4(0x1ef)),_0x39c330=await this['getForeignObjectsAsync'](_0x3c28b4(0x13f),_0x3c28b4(0x1ef)),_0x2517bb={},_0x262b82={},_0x99a204={},_0x5b2dff=(_0x1a2328,_0x3f243c,_0x5b0778=![])=>{const _0x5450c9=_0x3c28b4;if(!_0x1a2328)return;for(const _0x3ec47d in _0x1a2328){const _0x2a7bea=_0x1a2328[_0x3ec47d];if(_0x2a7bea&&_0x2a7bea[_0x5450c9(0x1df)]&&_0x2a7bea[_0x5450c9(0x1df)][_0x5450c9(0x22a)]){const _0x56c76e=(typeof _0x2a7bea['common'][_0x5450c9(0x18e)]==='object'?_0x2a7bea[_0x5450c9(0x1df)][_0x5450c9(0x18e)]['de']:_0x2a7bea[_0x5450c9(0x1df)][_0x5450c9(0x18e)])||_0x2a7bea[_0x5450c9(0x1df)][_0x5450c9(0x18e)];if(_0x5b0778)_0x99a204[_0x3ec47d]=_0x56c76e;for(const _0x32636d of _0x2a7bea['common']['members']){if(_0x5b0778){if(!_0x3f243c[_0x32636d])_0x3f243c[_0x32636d]=[];_0x3f243c[_0x32636d][_0x5450c9(0x176)](_0x3ec47d);}else _0x3f243c[_0x32636d]=_0x56c76e;}}}};_0x5b2dff(_0x3f680c,_0x2517bb),_0x5b2dff(_0x39c330,_0x262b82,!![]);const _0x1f1466=await this[_0x3c28b4(0x134)]('*',_0x3c28b4(0x151)),_0x488e83=['system.',_0x3c28b4(0x20e),_0x3c28b4(0x212),_0x3c28b4(0x123),_0x3c28b4(0x16c),_0x3c28b4(0x152),'icons-mfd.',_0x3c28b4(0x191)];if(!_0x7bdc94)_0x488e83[_0x3c28b4(0x176)](_0x3c28b4(0x1ed),_0x3c28b4(0xd6),_0x3c28b4(0x171),_0x3c28b4(0xf8),_0x3c28b4(0x113));for(const _0x145bd7 in _0x1f1466){const _0x2888f2=_0x1f1466[_0x145bd7];if(!_0x2888f2||!_0x2888f2['common'])continue;if(_0x488e83[_0x3c28b4(0x1ac)](_0xd58e5c=>_0x145bd7['startsWith'](_0xd58e5c)))continue;}return[];}async[a0_0x43e95d(0xf1)](_0x5cac99={}){const _0x24bbbd=[];return _0x24bbbd;}}function a0_0x4420(_0x3ec714,_0x465eb7){const _0x5b4c54=a0_0x3982();return a0_0x4420=function(_0x622cd5,_0x5884ac){_0x622cd5=_0x622cd5-0xd4;let _0x3982de=_0x5b4c54[_0x622cd5];return _0x3982de;},a0_0x4420(_0x3ec714,_0x465eb7);}if(require[a0_0x43e95d(0x10a)]!==module)module[a0_0x43e95d(0x156)]=_0x5bd4ac=>new CogniLiving(_0x5bd4ac);else new CogniLiving();