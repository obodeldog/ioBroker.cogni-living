const a0_0x5d5af9=a0_0x1cce;(function(_0x2a3f67,_0x10385b){const _0x27cdff=a0_0x1cce,_0x33fb85=_0x2a3f67();while(!![]){try{const _0x45d15=-parseInt(_0x27cdff(0x150))/0x1*(parseInt(_0x27cdff(0x9c))/0x2)+parseInt(_0x27cdff(0xe7))/0x3+-parseInt(_0x27cdff(0x14f))/0x4*(parseInt(_0x27cdff(0xf1))/0x5)+-parseInt(_0x27cdff(0x103))/0x6*(parseInt(_0x27cdff(0xb0))/0x7)+-parseInt(_0x27cdff(0x12e))/0x8+-parseInt(_0x27cdff(0x125))/0x9+parseInt(_0x27cdff(0xb1))/0xa;if(_0x45d15===_0x10385b)break;else _0x33fb85['push'](_0x33fb85['shift']());}catch(_0x993a1a){_0x33fb85['push'](_0x33fb85['shift']());}}}(a0_0xae4d,0xaf2fd));function a0_0xae4d(){const _0x5d5ab7=['createDailyDigest','checkAndInstall','runBaselineDriftAnalysis','testApiKey','onMessage','from','calendarInstance','getForeignStateAsync','cancel','onStateChange','apiKey','analysis.training.triggerSecurity','checkLicense','setStateAsync','Verbunden','stringify','74eJmWIY','LTM.dailyDigests','join','subscribeStates','ready','WiFi\x20Presence\x20detected.','Kein\x20Wetter-Adapter','forEach','pop','setState','getOverviewData','generateContent','getOutsideTemperatureNumeric','enum.rooms.*','Gemini\x20Init\x20Error:\x20','getCalendarNames','analysis.health.todayVector','communicate.request','setupLtmScheduler','Instanz\x20nicht\x20gefunden','42VUEqhm','34775790qhZXYp','application/json','version','@iobroker/adapter-core','updateLocation','lastAlertState','executeAutomationAction','initSystemConfig','SYSTEM_MODES','sendNotification','briefingJob','LTM.baselineStatus','Gemini\x20AI\x20initialized.','setupModeResetScheduler','modeResetJob','Keine\x20Antwort\x20von\x20Gemini','debug','analysisInterval','sendTo','inactivityThresholdHours','dependencyInstallInProgress','message','add','search','devices','getMinutes','SYSTEM_DP_MODE','val','geminiApiKey','name','stopService','loadSystemMode','dailyDigests','exitTimer','Kein\x20API\x20Key\x20Ã¼bergeben','PREDICT_ENERGY','system.mode','setPresence','isProVersion','triggerEnergyPrediction','matrix','Aktiv\x20(','startService','split','TRAIN_HEALTH','parse','getHours','ack','notifyTelegramEnabled','presenceDevices','LTM.trainingData.sequences','.data.table','updateHealthVector','SET_TOPOLOGY','108360YVNWKG','\x20Tage)','sort','getLtmData','Lernphase\x20(','triggerDailyDigest','toLowerCase','./lib/topology','./lib/recorder','onUnload','105QcguQW','rawEventLog','LTM.trainingData.thermodynamics','analysis.training.triggerEnergy','online','log','getStateAsync','ltmJob','apply','instance','isPresent','Kein\x20Kalender-Adapter','type','startSystem','telegram','bind','temperature','scanForDevices','1140546SnNBMO','subscribeForeignStatesAsync','motion','runAutopilot','LTM.triggerDailyDigest','enum.functions.*','PYTHON_EXE','Notification\x20Test\x20Failed:\x20','callback','currentSystemMode','config','Activity-Level','text','genAI','createAllObjects','VACATION','analysis.training.triggerTopology','length','Daten\x20nicht\x20verfÃ¼gbar','response','.system.mode','./lib/scheduler','analysis.training.triggerHealth','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','./lib/dead_man','floor','timestamp','minDaysForBaseline','testContext','cogni-living\x20adapter\x20starting\x20(v','values','eventHistory','onReady',')\x20-\x20Phase\x20C\x20(Hardened)','2111256cbAIta','runPythonHealthCheck','./lib/installer','processSensorEvent','sensorLastValues','analysis.automation.autoApply','enum','now','LTM.rawEventLog','2248136MFYLgz','analysisTimer','namespace','calendarName','NORMAL','./lib/ai_agent','system.adapter.','Verbindung\x20erfolgreich!','keys','analysis.topology.structure','send','error','updated','exports','toString','_calName','TRAIN_COMFORT','runGeminiAnalysis','Gesendet','./lib/scanner','analysis.automation.triggerAction','find','fill','notifyTelegramInstance','command','driftAnalysisTimer','getForeignObjectsAsync','initHistory','push','getEnums','abortExitTimer','includes','activityLevel','171056YGKeKA','6539EEOgra','info','testNotification','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','Standard','analysis.triggerBriefing','setHours','object','common','location','Sec-Training\x20started...','getTime','updateTopology','endsWith','setupBriefingScheduler','sendMorningBriefing','triggerGaitAnalysis','map','analysis.trigger','TRAIN_ENERGY','getState','analysis.training.triggerComfort','systemConfig','triggerBriefing'];a0_0xae4d=function(){return _0x5d5ab7;};return a0_0xae4d();}const a0_0x40e4e5=(function(){let _0x27aa17=!![];return function(_0x712a24,_0x2951db){const _0x2f3261=_0x27aa17?function(){const _0x23fa18=a0_0x1cce;if(_0x2951db){const _0x4cf360=_0x2951db[_0x23fa18(0xf9)](_0x712a24,arguments);return _0x2951db=null,_0x4cf360;}}:function(){};return _0x27aa17=![],_0x2f3261;};}()),a0_0x688e7a=a0_0x40e4e5(this,function(){const _0x3573ed=a0_0x1cce;return a0_0x688e7a['toString']()['search']('(((.+)+)+)+$')[_0x3573ed(0x13c)]()['constructor'](a0_0x688e7a)[_0x3573ed(0xc8)]('(((.+)+)+)+$');});a0_0x688e7a();'use strict';const utils=require(a0_0x5d5af9(0xb4)),{GoogleGenerativeAI}=require('@google/generative-ai'),installer=require(a0_0x5d5af9(0x127)),scanner=require(a0_0x5d5af9(0x141)),schedulers=require(a0_0x5d5af9(0x118)),topology=require(a0_0x5d5af9(0xee)),setup=require('./lib/setup'),recorder=require(a0_0x5d5af9(0xef)),pythonBridge=require('./lib/python_bridge'),aiAgent=require(a0_0x5d5af9(0x133)),deadMan=require(a0_0x5d5af9(0x11b)),GEMINI_MODEL='models/gemini-flash-latest',ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};function a0_0x1cce(_0x36658f,_0x56150b){const _0x3d741b=a0_0xae4d();return a0_0x1cce=function(_0x688e7a,_0x40e4e5){_0x688e7a=_0x688e7a-0x78;let _0xae4de4=_0x3d741b[_0x688e7a];return _0xae4de4;},a0_0x1cce(_0x36658f,_0x56150b);}class CogniLiving extends utils['Adapter']{constructor(_0x1d3ff4){const _0x2c3dbf=a0_0x5d5af9;super({..._0x1d3ff4,'name':'cogni-living'}),this[_0x2c3dbf(0x122)]=[],this['analysisHistory']=[],this[_0x2c3dbf(0xf2)]=[],this[_0x2c3dbf(0xd1)]=[],this[_0x2c3dbf(0x129)]={},this[_0x2c3dbf(0x8a)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x2c3dbf(0xfb)]=!![],this[_0x2c3dbf(0xd2)]=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this[_0x2c3dbf(0x110)]=null,this['geminiModel']=null,this[_0x2c3dbf(0x10c)]=setup[_0x2c3dbf(0xb9)][_0x2c3dbf(0x132)],this[_0x2c3dbf(0xd7)]=![],this[_0x2c3dbf(0xb6)]=![],this[_0x2c3dbf(0x12f)]=null,this[_0x2c3dbf(0xf8)]=null,this[_0x2c3dbf(0xbf)]=null,this['driftAnalysisTimer']=null,this['briefingJob']=null,this[_0x2c3dbf(0xc5)]=![],this['on'](_0x2c3dbf(0xa0),this[_0x2c3dbf(0x123)][_0x2c3dbf(0x100)](this)),this['on']('stateChange',this[_0x2c3dbf(0x95)][_0x2c3dbf(0x100)](this)),this['on']('unload',this[_0x2c3dbf(0xf0)][_0x2c3dbf(0x100)](this)),this['on'](_0x2c3dbf(0xc6),this[_0x2c3dbf(0x90)][_0x2c3dbf(0x100)](this));}async[a0_0x5d5af9(0x123)](){const _0x354b34=a0_0x5d5af9;this[_0x354b34(0xf6)][_0x354b34(0x151)](_0x354b34(0x120)+this[_0x354b34(0xb3)]+_0x354b34(0x124));if(!installer[_0x354b34(0x8d)](this,()=>this[_0x354b34(0xfe)]()))return;}async['startSystem'](){const _0x50a686=a0_0x5d5af9;await setup['initZombies'](this);try{this['isProVersion']=await setup[_0x50a686(0x98)](this['config']['licenseKey']);}catch(_0xf43a71){}if(!this[_0x50a686(0x10d)][_0x50a686(0xc4)]||this[_0x50a686(0x10d)]['inactivityThresholdHours']<0.1)this[_0x50a686(0x10d)]['inactivityThresholdHours']=0xc;await setup[_0x50a686(0x149)](this),await setup[_0x50a686(0xb8)](this);if(this['config'][_0x50a686(0xcd)])try{this['genAI']=new GoogleGenerativeAI(this[_0x50a686(0x10d)]['geminiApiKey']),this['geminiModel']=this[_0x50a686(0x110)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x50a686(0xb2)}}),this['log'][_0x50a686(0x151)](_0x50a686(0xbd));}catch(_0x2b571d){this['log'][_0x50a686(0x139)](_0x50a686(0xaa)+_0x2b571d[_0x50a686(0xc6)]);}await setup[_0x50a686(0x111)](this),await this[_0x50a686(0xd0)]();try{const _0x38f0ff=await this[_0x50a686(0xf7)](_0x50a686(0x12d));if(_0x38f0ff&&_0x38f0ff[_0x50a686(0xcc)])this[_0x50a686(0xf2)]=JSON[_0x50a686(0xde)](_0x38f0ff[_0x50a686(0xcc)]);}catch(_0x279859){this['rawEventLog']=[];}try{const _0x4ed6f2=await this[_0x50a686(0xf7)](_0x50a686(0x9d));if(_0x4ed6f2&&_0x4ed6f2[_0x50a686(0xcc)])this[_0x50a686(0xd1)]=JSON['parse'](_0x4ed6f2[_0x50a686(0xcc)]);}catch(_0x4d2aec){this[_0x50a686(0xd1)]=[];}const _0x26a5ff=this['dailyDigests'][_0x50a686(0x114)]>=(this['config'][_0x50a686(0x11e)]||0x7)?_0x50a686(0xda)+this[_0x50a686(0xd1)][_0x50a686(0x114)]+_0x50a686(0xe8):_0x50a686(0xeb)+this['dailyDigests'][_0x50a686(0x114)]+'/'+(this['config']['minDaysForBaseline']||0x7)+')';await this[_0x50a686(0x99)](_0x50a686(0xbc),{'val':_0x26a5ff,'ack':!![]}),this['subscribeStates']('analysis.trigger'),this[_0x50a686(0x9f)](_0x50a686(0x107)),this[_0x50a686(0x9f)](_0x50a686(0xd5)),this['subscribeStates'](_0x50a686(0x79)),this[_0x50a686(0x9f)](_0x50a686(0x142)),this['subscribeStates'](_0x50a686(0x12a)),this['subscribeStates'](_0x50a686(0x97)),this[_0x50a686(0x9f)](_0x50a686(0x119)),this[_0x50a686(0x9f)](_0x50a686(0xf4)),this[_0x50a686(0x9f)](_0x50a686(0x89)),this['subscribeStates'](_0x50a686(0x113));const _0x5d765a=this[_0x50a686(0x10d)]['devices'];if(_0x5d765a)for(const _0x598563 of _0x5d765a){await this[_0x50a686(0x104)](_0x598563['id']);}const _0x580ff1=this['config']['presenceDevices'];if(_0x580ff1)for(const _0x505e00 of _0x580ff1){await this[_0x50a686(0x104)](_0x505e00);}if(this[_0x50a686(0x10d)][_0x50a686(0xe1)]&&this['config'][_0x50a686(0x145)])await this[_0x50a686(0x104)](this[_0x50a686(0x10d)]['notifyTelegramInstance']+'.communicate.request');setTimeout(()=>this['checkWifiPresence'](),0x1388);if(this[_0x50a686(0x12f)])clearInterval(this[_0x50a686(0x12f)]);const _0xb4144d=this[_0x50a686(0x10d)][_0x50a686(0xc2)]||0xf;_0xb4144d>0x0&&(this[_0x50a686(0x12f)]=setInterval(()=>{this['runAutopilot']();},_0xb4144d*0x3c*0x3e8)),schedulers[_0x50a686(0xae)](this,()=>aiAgent['createDailyDigest'](this,pythonBridge)),schedulers[_0x50a686(0xbe)](this),schedulers['setupDriftAnalysisScheduler'](this,()=>aiAgent[_0x50a686(0x8e)](this)),schedulers[_0x50a686(0x82)](this,()=>aiAgent[_0x50a686(0x83)](this)),pythonBridge[_0x50a686(0xdb)](this,installer[_0x50a686(0x109)]),setTimeout(async()=>{const _0x34bcfe=_0x50a686;await topology[_0x34bcfe(0x80)](this);try{const _0xea8370=await this[_0x34bcfe(0xf7)]('analysis.topology.structure');if(_0xea8370&&_0xea8370[_0x34bcfe(0xcc)])pythonBridge['send'](this,_0x34bcfe(0xe6),JSON[_0x34bcfe(0xde)](_0xea8370[_0x34bcfe(0xcc)]));}catch(_0x480b4e){}this[_0x34bcfe(0x126)](),this['triggerGaitAnalysis'](),this[_0x34bcfe(0xd8)](),this['updateHealthVector']();},0x1388);}['onUnload'](_0x42ff3e){const _0x44dcdf=a0_0x5d5af9;if(this['analysisTimer'])clearInterval(this[_0x44dcdf(0x12f)]);if(this[_0x44dcdf(0x147)])clearInterval(this[_0x44dcdf(0x147)]);if(this[_0x44dcdf(0xf8)])this[_0x44dcdf(0xf8)][_0x44dcdf(0x94)]();if(this[_0x44dcdf(0xbf)])this[_0x44dcdf(0xbf)][_0x44dcdf(0x94)]();if(this[_0x44dcdf(0xbb)])this[_0x44dcdf(0xbb)][_0x44dcdf(0x94)]();recorder[_0x44dcdf(0x14c)](this),pythonBridge[_0x44dcdf(0xcf)](this),_0x42ff3e();}async[a0_0x5d5af9(0x95)](_0x2ab6fd,_0x2050a6){const _0x180f6b=a0_0x5d5af9;if(!_0x2050a6||this[_0x180f6b(0xc5)])return;if(_0x2ab6fd[_0x180f6b(0x14d)](_0x180f6b(0xff))&&_0x2ab6fd[_0x180f6b(0x81)](_0x180f6b(0xad))&&_0x2050a6[_0x180f6b(0xcc)])return;if(_0x2ab6fd===this[_0x180f6b(0x130)]+_0x180f6b(0x117)){if(_0x2050a6[_0x180f6b(0xcc)]&&Object[_0x180f6b(0x121)](setup['SYSTEM_MODES'])[_0x180f6b(0x14d)](_0x2050a6[_0x180f6b(0xcc)])){this[_0x180f6b(0x10c)]=_0x2050a6[_0x180f6b(0xcc)];if(_0x2050a6[_0x180f6b(0xcc)]===setup[_0x180f6b(0xb9)][_0x180f6b(0x112)])await recorder[_0x180f6b(0xd6)](this,![]);else await recorder[_0x180f6b(0xd6)](this,!![]);}if(!_0x2050a6[_0x180f6b(0xe0)])this['setState'](_0x2ab6fd,{'val':this[_0x180f6b(0x10c)],'ack':!![]});return;}if(!_0x2050a6[_0x180f6b(0xe0)]){_0x2ab6fd[_0x180f6b(0x14d)](_0x180f6b(0x86))&&_0x2050a6['val']&&(this[_0x180f6b(0xa5)](_0x2ab6fd,{'val':![],'ack':!![]}),aiAgent[_0x180f6b(0x13f)](this));if(_0x2ab6fd['includes'](_0x180f6b(0xec))&&_0x2050a6['val']){this['setState'](_0x2ab6fd,{'val':![],'ack':!![]});if(this[_0x180f6b(0xd7)])aiAgent[_0x180f6b(0x8c)](this,pythonBridge);}_0x2ab6fd['includes'](_0x180f6b(0x8b))&&_0x2050a6[_0x180f6b(0xcc)]&&(this[_0x180f6b(0xa5)](_0x2ab6fd,{'val':![],'ack':!![]}),aiAgent['sendMorningBriefing'](this));_0x2ab6fd[_0x180f6b(0x14d)]('automation.triggerAction')&&_0x2050a6['val']&&(this[_0x180f6b(0xa5)](_0x2ab6fd,{'val':![],'ack':!![]}),aiAgent[_0x180f6b(0xb7)](this));if(_0x2ab6fd[_0x180f6b(0x14d)](_0x180f6b(0x97))&&_0x2050a6[_0x180f6b(0xcc)]){this['setState'](_0x2ab6fd,{'val':![],'ack':!![]});if(this[_0x180f6b(0xd7)])try{const _0x586955=await this[_0x180f6b(0xf7)](_0x180f6b(0xe3));if(_0x586955&&_0x586955[_0x180f6b(0xcc)]){const _0xfa7795=JSON[_0x180f6b(0xde)](_0x586955['val']);this['setStateAsync']('analysis.training.status',{'val':_0x180f6b(0x7e),'ack':!![]}),pythonBridge[_0x180f6b(0x138)](this,'TRAIN_SECURITY',{'sequences':_0xfa7795});}}catch(_0x7ae4c0){}}if(_0x2ab6fd[_0x180f6b(0x14d)](_0x180f6b(0x119))&&_0x2050a6[_0x180f6b(0xcc)]){this['setState'](_0x2ab6fd,{'val':![],'ack':!![]});if(this[_0x180f6b(0xd7)])try{const _0x29e878=await this['getStateAsync'](_0x180f6b(0x9d));if(_0x29e878&&_0x29e878[_0x180f6b(0xcc)])pythonBridge[_0x180f6b(0x138)](this,_0x180f6b(0xdd),{'digests':JSON['parse'](_0x29e878[_0x180f6b(0xcc)])});}catch(_0x2cb4e0){}}if(_0x2ab6fd['includes'](_0x180f6b(0xf4))&&_0x2050a6[_0x180f6b(0xcc)]){this['setState'](_0x2ab6fd,{'val':![],'ack':!![]});if(this[_0x180f6b(0xd7)])try{const _0x1ab371=await this[_0x180f6b(0xf7)](_0x180f6b(0xf3));if(_0x1ab371&&_0x1ab371[_0x180f6b(0xcc)])pythonBridge[_0x180f6b(0x138)](this,_0x180f6b(0x87),{'points':JSON[_0x180f6b(0xde)](_0x1ab371[_0x180f6b(0xcc)])});}catch(_0x25f8dd){}}if(_0x2ab6fd['includes'](_0x180f6b(0x89))&&_0x2050a6[_0x180f6b(0xcc)]){this['setState'](_0x2ab6fd,{'val':![],'ack':!![]});if(this[_0x180f6b(0xd7)])try{const _0x4448cc=await this[_0x180f6b(0xf7)]('LTM.rawEventLog');if(_0x4448cc&&_0x4448cc[_0x180f6b(0xcc)])pythonBridge['send'](this,_0x180f6b(0x13e),{'events':JSON[_0x180f6b(0xde)](_0x4448cc[_0x180f6b(0xcc)])});}catch(_0xb0a09b){}}_0x2ab6fd[_0x180f6b(0x14d)](_0x180f6b(0x113))&&_0x2050a6['val']&&(this[_0x180f6b(0xa5)](_0x2ab6fd,{'val':![],'ack':!![]}),topology[_0x180f6b(0x80)](this));return;}if(this[_0x180f6b(0x10d)][_0x180f6b(0xe2)]&&this['config'][_0x180f6b(0xe2)][_0x180f6b(0x14d)](_0x2ab6fd)){await this['checkWifiPresence']();return;}const _0x452f69=(this[_0x180f6b(0x10d)][_0x180f6b(0xc9)]||[])[_0x180f6b(0x143)](_0xdb24fa=>_0xdb24fa['id']===_0x2ab6fd);if(_0x452f69){const _0xbc83ad=await recorder[_0x180f6b(0x128)](this,_0x2ab6fd,_0x2050a6,_0x452f69);_0xbc83ad&&_0xbc83ad[_0x180f6b(0xfd)]===_0x180f6b(0x105)&&_0xbc83ad['location']&&this[_0x180f6b(0xd7)]&&deadMan[_0x180f6b(0xb5)](this,_0xbc83ad[_0x180f6b(0x7d)]);}}async['onMessage'](_0x3a29ee){const _0x4ad24a=a0_0x5d5af9;if(typeof _0x3a29ee==='object'&&_0x3a29ee[_0x4ad24a(0xc6)]){if(_0x3a29ee['command']===_0x4ad24a(0x8f))try{const _0x52e01f=_0x3a29ee[_0x4ad24a(0xc6)][_0x4ad24a(0x96)];if(!_0x52e01f)throw new Error(_0x4ad24a(0xd3));const _0x5696f7=new GoogleGenerativeAI(_0x52e01f),_0x12c5a7=_0x5696f7['getGenerativeModel']({'model':GEMINI_MODEL}),_0x1842f2=await _0x12c5a7[_0x4ad24a(0xa7)]('Test'),_0xc92cf7=await _0x1842f2[_0x4ad24a(0x116)];if(_0xc92cf7[_0x4ad24a(0x10f)]())this[_0x4ad24a(0xc3)](_0x3a29ee[_0x4ad24a(0x91)],_0x3a29ee[_0x4ad24a(0x146)],{'success':!![],'message':_0x4ad24a(0x135)},_0x3a29ee[_0x4ad24a(0x10b)]);else throw new Error(_0x4ad24a(0xc0));}catch(_0x2a8a0f){this[_0x4ad24a(0xc3)](_0x3a29ee[_0x4ad24a(0x91)],_0x3a29ee[_0x4ad24a(0x146)],{'success':![],'message':_0x2a8a0f['message']},_0x3a29ee[_0x4ad24a(0x10b)]);}else{if(_0x3a29ee[_0x4ad24a(0x146)]==='scanDevices')try{const _0x2f41ae=await scanner[_0x4ad24a(0x102)](this,_0x3a29ee[_0x4ad24a(0xc6)]||{});this['sendTo'](_0x3a29ee[_0x4ad24a(0x91)],_0x3a29ee['command'],{'success':!![],'devices':_0x2f41ae},_0x3a29ee[_0x4ad24a(0x10b)]);}catch(_0x504dec){this['sendTo'](_0x3a29ee[_0x4ad24a(0x91)],_0x3a29ee[_0x4ad24a(0x146)],{'success':![],'error':_0x504dec[_0x4ad24a(0xc6)]},_0x3a29ee[_0x4ad24a(0x10b)]);}else{if(_0x3a29ee[_0x4ad24a(0x146)]==='updateTopologyMatrix')try{const {matrix:_0x248734}=_0x3a29ee[_0x4ad24a(0xc6)],_0x17f00b=await this['getStateAsync'](_0x4ad24a(0x137));if(_0x17f00b&&_0x17f00b[_0x4ad24a(0xcc)]){const _0x237eea=JSON[_0x4ad24a(0xde)](_0x17f00b[_0x4ad24a(0xcc)]);_0x237eea[_0x4ad24a(0xd9)]=_0x248734,_0x237eea[_0x4ad24a(0x13a)]=Date[_0x4ad24a(0x12c)](),await this[_0x4ad24a(0x99)](_0x4ad24a(0x137),{'val':JSON[_0x4ad24a(0x9b)](_0x237eea),'ack':!![]}),pythonBridge[_0x4ad24a(0x138)](this,_0x4ad24a(0xe6),_0x237eea);}this['sendTo'](_0x3a29ee[_0x4ad24a(0x91)],_0x3a29ee[_0x4ad24a(0x146)],{'success':!![]},_0x3a29ee['callback']);}catch(_0x4ea515){this['log'][_0x4ad24a(0x139)](_0x4ea515);}else{if(_0x3a29ee['command']===_0x4ad24a(0xea))this[_0x4ad24a(0xc3)](_0x3a29ee['from'],_0x3a29ee['command'],{'success':!![],'dailyDigests':this[_0x4ad24a(0xd1)]||[],'analysisHistory':this['analysisHistory']||[]},_0x3a29ee[_0x4ad24a(0x10b)]);else{if(_0x3a29ee[_0x4ad24a(0x146)]===_0x4ad24a(0xa6)){const _0x508ef4=this[_0x4ad24a(0xd1)][_0x4ad24a(0x114)],_0x5388fd=new Array(0x18)[_0x4ad24a(0x144)](0x0),_0x533a56=new Date()[_0x4ad24a(0x7a)](0x0,0x0,0x0,0x0);this[_0x4ad24a(0x122)]&&this['eventHistory'][_0x4ad24a(0xa3)](_0x2846e5=>{const _0x100567=_0x4ad24a;if(_0x2846e5[_0x100567(0x11d)]>=_0x533a56){const _0x21989a=new Date(_0x2846e5[_0x100567(0x11d)])['getHours']();if(_0x21989a>=0x0&&_0x21989a<0x18)_0x5388fd[_0x21989a]++;}}),this[_0x4ad24a(0xc3)](_0x3a29ee['from'],_0x3a29ee[_0x4ad24a(0x146)],{'success':!![],'eventHistory':this[_0x4ad24a(0x122)]['slice'](0x0,0xf),'stats':{'digestCount':_0x508ef4,'isPresent':this[_0x4ad24a(0xfb)],'hourlyActivity':_0x5388fd},'automation':{'detected':![]}},_0x3a29ee['callback']);}else{if(_0x3a29ee['command']===_0x4ad24a(0x14b)){const _0x415503=await this[_0x4ad24a(0x148)](_0x4ad24a(0x108),_0x4ad24a(0x12b)),_0x3e8e2c=[];if(_0x415503)for(const _0x23de2b in _0x415503){const _0x16431d=_0x415503[_0x23de2b],_0x5352bd=(_0x16431d[_0x4ad24a(0x7c)]&&typeof _0x16431d[_0x4ad24a(0x7c)][_0x4ad24a(0xce)]===_0x4ad24a(0x7b)?_0x16431d[_0x4ad24a(0x7c)]['name']['de']:_0x16431d[_0x4ad24a(0x7c)]['name'])||_0x16431d[_0x4ad24a(0x7c)][_0x4ad24a(0xce)];_0x3e8e2c[_0x4ad24a(0x14a)]({'id':_0x23de2b,'name':_0x5352bd});}const _0xc7e3e=await this[_0x4ad24a(0x148)](_0x4ad24a(0xa9),_0x4ad24a(0x12b)),_0x1dbd44=[];if(_0xc7e3e)for(const _0x1c1a0b in _0xc7e3e){const _0x271b0f=_0xc7e3e[_0x1c1a0b],_0x2189cc=(_0x271b0f[_0x4ad24a(0x7c)]&&typeof _0x271b0f[_0x4ad24a(0x7c)][_0x4ad24a(0xce)]===_0x4ad24a(0x7b)?_0x271b0f[_0x4ad24a(0x7c)][_0x4ad24a(0xce)]['de']:_0x271b0f[_0x4ad24a(0x7c)]['name'])||_0x1c1a0b[_0x4ad24a(0xdc)]('.')[_0x4ad24a(0xa4)]();_0x1dbd44[_0x4ad24a(0x14a)](_0x2189cc);}this[_0x4ad24a(0xc3)](_0x3a29ee[_0x4ad24a(0x91)],_0x3a29ee[_0x4ad24a(0x146)],{'success':!![],'enums':_0x3e8e2c,'rooms':_0x1dbd44},_0x3a29ee[_0x4ad24a(0x10b)]);}else{if(_0x3a29ee[_0x4ad24a(0x146)]===_0x4ad24a(0x11f))try{let _0x475120=_0x4ad24a(0xa2),_0x20e3be=_0x4ad24a(0xfc);if(this['config']['weatherInstance']){const _0x255aa2=await recorder[_0x4ad24a(0xa8)](this);_0x475120=_0x255aa2!==null?_0x255aa2+'Â°C':_0x4ad24a(0x115);}if(this['config']['calendarInstance']){const _0x358489=await this['getForeignObjectAsync'](_0x4ad24a(0x134)+this[_0x4ad24a(0x10d)][_0x4ad24a(0x92)]);_0x20e3be=_0x358489?_0x4ad24a(0x9a):_0x4ad24a(0xaf);}this[_0x4ad24a(0xc3)](_0x3a29ee['from'],_0x3a29ee[_0x4ad24a(0x146)],{'success':!![],'weather':_0x475120,'calendar':_0x20e3be},_0x3a29ee[_0x4ad24a(0x10b)]);}catch(_0x37c1d7){this[_0x4ad24a(0xc3)](_0x3a29ee[_0x4ad24a(0x91)],_0x3a29ee[_0x4ad24a(0x146)],{'success':![],'error':_0x37c1d7[_0x4ad24a(0xc6)]},_0x3a29ee[_0x4ad24a(0x10b)]);}else{if(_0x3a29ee[_0x4ad24a(0x146)]===_0x4ad24a(0xab))try{const _0x287b28=_0x3a29ee['message'][_0x4ad24a(0xfa)],_0x55189c=await this[_0x4ad24a(0x93)](_0x287b28+_0x4ad24a(0xe4));let _0x206f52=[];if(_0x55189c&&_0x55189c['val']){const _0x1f839a=JSON['parse'](_0x55189c[_0x4ad24a(0xcc)]),_0x41596f=new Set();Array['isArray'](_0x1f839a)&&_0x1f839a[_0x4ad24a(0xa3)](_0x4f013b=>{const _0x367245=_0x4ad24a;if(_0x4f013b[_0x367245(0x13d)])_0x41596f[_0x367245(0xc7)](_0x4f013b[_0x367245(0x13d)]);else{if(_0x4f013b[_0x367245(0x131)])_0x41596f[_0x367245(0xc7)](_0x4f013b['calendarName']);}}),_0x206f52=Array['from'](_0x41596f)[_0x4ad24a(0xe9)]();}if(_0x206f52[_0x4ad24a(0x114)]===0x0)_0x206f52=[_0x4ad24a(0x78)];this['sendTo'](_0x3a29ee['from'],_0x3a29ee[_0x4ad24a(0x146)],{'success':!![],'names':_0x206f52},_0x3a29ee[_0x4ad24a(0x10b)]);}catch(_0x581557){this['sendTo'](_0x3a29ee['from'],_0x3a29ee[_0x4ad24a(0x146)],{'success':![],'error':_0x581557[_0x4ad24a(0xc6)]},_0x3a29ee['callback']);}else{if(_0x3a29ee[_0x4ad24a(0x146)]===_0x4ad24a(0x152))try{await setup[_0x4ad24a(0xba)](this,_0x4ad24a(0x153),![],![]),this[_0x4ad24a(0xc3)](_0x3a29ee[_0x4ad24a(0x91)],_0x3a29ee[_0x4ad24a(0x146)],{'success':!![],'message':_0x4ad24a(0x140)},_0x3a29ee['callback']);}catch(_0x512a76){this[_0x4ad24a(0xf6)][_0x4ad24a(0x139)](_0x4ad24a(0x10a)+_0x512a76[_0x4ad24a(0xc6)]),this[_0x4ad24a(0xc3)](_0x3a29ee['from'],_0x3a29ee[_0x4ad24a(0x146)],{'success':![],'message':'Fehler:\x20'+_0x512a76['message']},_0x3a29ee[_0x4ad24a(0x10b)]);}}}}}}}}}}}async['loadSystemMode'](){const _0x5084f5=a0_0x5d5af9;try{const _0x160b49=await this[_0x5084f5(0xf7)](setup['SYSTEM_DP_MODE']);_0x160b49&&_0x160b49[_0x5084f5(0xcc)]&&Object[_0x5084f5(0x121)](setup[_0x5084f5(0xb9)])[_0x5084f5(0x14d)](_0x160b49['val'])?this[_0x5084f5(0x10c)]=_0x160b49[_0x5084f5(0xcc)]:(this[_0x5084f5(0x10c)]=setup[_0x5084f5(0xb9)][_0x5084f5(0x132)],await this['setStateAsync'](setup[_0x5084f5(0xcb)],{'val':setup['SYSTEM_MODES'][_0x5084f5(0x132)],'ack':!![]}));}catch(_0x33f2be){this[_0x5084f5(0x10c)]=setup['SYSTEM_MODES']['NORMAL'];}}async['checkWifiPresence'](){const _0x899e2d=a0_0x5d5af9;try{const _0x3760f5=this[_0x899e2d(0x10d)][_0x899e2d(0xe2)]||[];let _0x36f89d=![];const _0x5701d6=[];for(const _0x547b4e of _0x3760f5){try{const _0xf30cd1=await this[_0x899e2d(0x93)](_0x547b4e);_0xf30cd1&&(_0xf30cd1[_0x899e2d(0xcc)]===!![]||_0xf30cd1['val']===_0x899e2d(0xf5)||_0xf30cd1[_0x899e2d(0xcc)]===0x1)&&(_0x36f89d=!![],_0x5701d6['push'](_0x547b4e));}catch(_0x6e5273){}}return await this[_0x899e2d(0x99)]('system.presenceWho',{'val':_0x5701d6[_0x899e2d(0x9e)](',\x20'),'ack':!![]}),_0x36f89d&&(this[_0x899e2d(0xd2)]&&(this[_0x899e2d(0xf6)][_0x899e2d(0x151)](_0x899e2d(0xa1)),recorder[_0x899e2d(0x14c)](this)),!this[_0x899e2d(0xfb)]&&this['currentSystemMode']===setup[_0x899e2d(0xb9)][_0x899e2d(0x132)]&&await recorder['setPresence'](this,!![])),_0x36f89d;}catch(_0x48bafc){return![];}}async[a0_0x5d5af9(0x106)](){const _0x13ed62=a0_0x5d5af9;this[_0x13ed62(0xf6)][_0x13ed62(0xc1)](_0x13ed62(0x11a)),await aiAgent[_0x13ed62(0x13f)](this),this[_0x13ed62(0xe5)](),this[_0x13ed62(0x84)](),this['triggerEnergyPrediction']();}[a0_0x5d5af9(0x84)](){const _0x4395ce=a0_0x5d5af9;if(!this[_0x4395ce(0xd7)])return;try{this[_0x4395ce(0x88)](_0x4395ce(0xe3),(_0xb7cd02,_0x208cdf)=>{const _0x3d652d=_0x4395ce;_0x208cdf&&_0x208cdf[_0x3d652d(0xcc)]&&pythonBridge['send'](this,'ANALYZE_GAIT',{'sequences':JSON[_0x3d652d(0xde)](_0x208cdf[_0x3d652d(0xcc)])});});}catch(_0x5af515){}}async[a0_0x5d5af9(0xd8)](){const _0x35b35c=a0_0x5d5af9;if(!this[_0x35b35c(0xd7)])return;try{const _0x3784a4=await recorder[_0x35b35c(0xa8)](this);if(_0x3784a4===null)return;const _0x4b18c6={},_0x55eb36=this['config'][_0x35b35c(0xc9)]||[];for(const _0xb2df91 of _0x55eb36){if(_0xb2df91[_0x35b35c(0xfd)]===_0x35b35c(0x101)&&_0xb2df91['location']){const _0x36718a=this[_0x35b35c(0x129)][_0xb2df91['id']];if(_0x36718a!==undefined)_0x4b18c6[_0xb2df91[_0x35b35c(0x7d)]]=_0x36718a;}}Object[_0x35b35c(0x136)](_0x4b18c6)[_0x35b35c(0x114)]>0x0&&pythonBridge[_0x35b35c(0x138)](this,_0x35b35c(0xd4),{'current_temps':_0x4b18c6,'t_out':_0x3784a4});}catch(_0x2614b4){}}['updateHealthVector'](){const _0x399f8a=a0_0x5d5af9;if(!this[_0x399f8a(0xf2)]||this['rawEventLog']['length']===0x0)return;const _0x2e5572=new Array(0x60)[_0x399f8a(0x144)](0x0),_0x120022=new Date()['setHours'](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x399f8a(0xa3)](_0xc00ee6=>{const _0x331ed0=_0x399f8a,_0x2fcf12=new Date(_0xc00ee6[_0x331ed0(0x11d)]);if(_0x2fcf12[_0x331ed0(0x7f)]()>=_0x120022){const _0x4b8f8a=_0x2fcf12[_0x331ed0(0xdf)](),_0x5d335a=_0x2fcf12[_0x331ed0(0xca)](),_0xb7aba8=_0x4b8f8a*0x4+Math[_0x331ed0(0x11c)](_0x5d335a/0xf);if(_0xb7aba8>=0x0&&_0xb7aba8<0x60)_0x2e5572[_0xb7aba8]++;}}),this[_0x399f8a(0x99)](_0x399f8a(0xac),{'val':JSON['stringify'](_0x2e5572),'ack':!![]});}[a0_0x5d5af9(0x126)](){const _0x451585=a0_0x5d5af9;if(!this[_0x451585(0xd1)]||this[_0x451585(0xd1)][_0x451585(0x114)]<0x2)return;const _0x266a54=this['dailyDigests'][_0x451585(0x85)](_0x45d162=>{const _0x4f3db6=_0x451585,_0x2e7ffe=(_0x45d162[_0x4f3db6(0x14e)]||'')[_0x4f3db6(0xed)]();return ACTIVITY_LEVEL_MAP[_0x2e7ffe]||0x32;});pythonBridge[_0x451585(0x138)](this,'ANALYZE_TREND',{'values':_0x266a54,'tag':_0x451585(0x10e)});}}if(require['main']!==module)module[a0_0x5d5af9(0x13b)]=_0x15a998=>new CogniLiving(_0x15a998);else new CogniLiving();