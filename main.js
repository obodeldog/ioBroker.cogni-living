function a0_0x1d60(_0x3bc64e,_0x1015ed){const _0x43cff6=a0_0x96bc();return a0_0x1d60=function(_0x4f8bc1,_0x2415d1){_0x4f8bc1=_0x4f8bc1-0x1d2;let _0x96bcd3=_0x43cff6[_0x4f8bc1];return _0x96bcd3;},a0_0x1d60(_0x3bc64e,_0x1015ed);}const a0_0x3a3552=a0_0x1d60;(function(_0x990c84,_0x53bded){const _0x126c6f=a0_0x1d60,_0x5b99e0=_0x990c84();while(!![]){try{const _0x2df3b6=-parseInt(_0x126c6f(0x1e8))/0x1*(parseInt(_0x126c6f(0x281))/0x2)+parseInt(_0x126c6f(0x264))/0x3+-parseInt(_0x126c6f(0x23f))/0x4+parseInt(_0x126c6f(0x20e))/0x5+-parseInt(_0x126c6f(0x25c))/0x6+parseInt(_0x126c6f(0x1f5))/0x7+parseInt(_0x126c6f(0x226))/0x8*(parseInt(_0x126c6f(0x287))/0x9);if(_0x2df3b6===_0x53bded)break;else _0x5b99e0['push'](_0x5b99e0['shift']());}catch(_0x17c9dc){_0x5b99e0['push'](_0x5b99e0['shift']());}}}(a0_0x96bc,0xc7781));const a0_0x2415d1=(function(){let _0x1a6afa=!![];return function(_0x2f04c5,_0x1d642d){const _0x3085b6=_0x1a6afa?function(){const _0x3eb7be=a0_0x1d60;if(_0x1d642d){const _0x4ca77d=_0x1d642d[_0x3eb7be(0x295)](_0x2f04c5,arguments);return _0x1d642d=null,_0x4ca77d;}}:function(){};return _0x1a6afa=![],_0x3085b6;};}()),a0_0x4f8bc1=a0_0x2415d1(this,function(){const _0x5d677=a0_0x1d60;return a0_0x4f8bc1[_0x5d677(0x265)]()['search'](_0x5d677(0x290))[_0x5d677(0x265)]()[_0x5d677(0x241)](a0_0x4f8bc1)[_0x5d677(0x1f7)](_0x5d677(0x290));});a0_0x4f8bc1();function a0_0x96bc(){const _0x3ebd32=['error','setStateAsync','getMinutes','dailyDigests','./lib/python_bridge','PYTHON_EXE','ANALYZE_TREND','4810348RvJzrV','geminiApiKey','constructor','communicate.request','getCalendarNames','length','common','matrix','getState','initZombies','split','apiKey','getOutsideTemperatureNumeric','systemConfig','geminiModel','analysis.training.triggerComfort','Keine\x20Antwort\x20von\x20Gemini','analysis.automation.autoApply','triggerBriefing','analysis.training.triggerHealth','find','PREDICT_ENERGY','info','LTM.baselineStatus','forEach','ANALYZE_GAIT','version','.data.table','name','6253524HpszHm','currentSystemMode','timestamp','isGracePeriodActive','isArray','sort','setupBriefingScheduler','exports','3938136wAyeVR','toString','scanForDevices','analysis.training.triggerEnergy','ack','presenceDevices','text','type','testContext','TRAIN_SECURITY','modeResetJob','val','command','ltmJob','Standard','briefingJob','TRAIN_HEALTH','NORMAL','map','namespace','log','loadSystemMode','notifyTelegramEnabled','push','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','Kein\x20Kalender-Adapter','object','weatherInstance','analysisTimer','666998KFCJOe','values','getHours','./lib/installer','parse','SYSTEM_DP_MODE','128979VdPrxB','LTM.triggerDailyDigest','activityLevel','genAI','./lib/setup','isProVersion','setHours','WiFi\x20Presence\x20detected.','join','(((.+)+)+)+$','onStateChange','abortExitTimer','LTM.trainingData.sequences','_calName','apply','./lib/topology','system.mode','instance','updated','TRAIN_COMFORT','application/json','.communicate.request','Aktiv\x20(','@google/generative-ai','Kein\x20API\x20Key\x20Ã¼bergeben','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','getGenerativeModel','system.adapter.','initSystemConfig','analysis.topology.structure','callback','SYSTEM_MODES','Notification\x20Test\x20Failed:\x20','telegram','message','config','enum.functions.*','notifyTelegramInstance','subscribeStates','onUnload','from','system.presenceWho','initHistory','startSystem','inactivityThresholdHours','LTM.rawEventLog','cogni-living','enum','sendMorningBriefing','sendTo','./lib/scheduler','LTM.trainingData.thermodynamics','sensorLastValues','runGeminiAnalysis','1AccVFl','Kein\x20Wetter-Adapter','setState','runPythonHealthCheck','createDailyDigest','triggerEnergyPrediction','analysis.automation.triggerAction','cancel','rawEventLog',')\x20-\x20Phase\x20C\x20(Hardened)','checkWifiPresence','checkAndInstall','./lib/dead_man','8191820UWfADn','runBaselineDriftAnalysis','search','setupLtmScheduler','lastAlertState','toLowerCase','analysis.training.status','Fehler:\x20','executeAutomationAction','temperature','bind','testApiKey','automation.triggerAction','cogni-living\x20adapter\x20starting\x20(v','motion','dependencyInstallInProgress','fill','online','VACATION','ready','./lib/ai_agent','onReady','slice','calendarInstance','updateHealthVector','2483970NleAjC','setPresence','getStateAsync','getOverviewData','onMessage','devices','getForeignObjectsAsync','sendNotification','getTime','@iobroker/adapter-core','calendarName','Gemini\x20AI\x20initialized.','setupDriftAnalysisScheduler','location','Adapter','checkLicense','triggerGaitAnalysis','send','stringify','createAllObjects','analysisHistory','Lernphase\x20(','Instanz\x20nicht\x20gefunden','TRAIN_ENERGY','232hFGcmr','Verbunden','Gemini\x20Init\x20Error:\x20','Test','getForeignStateAsync','includes','subscribeForeignStatesAsync','licenseKey','eventHistory','scanDevices','SET_TOPOLOGY','isPresent','response','./lib/recorder','getForeignObjectAsync','endsWith','analysis.training.triggerSecurity','driftAnalysisTimer'];a0_0x96bc=function(){return _0x3ebd32;};return a0_0x96bc();}'use strict';const utils=require(a0_0x3a3552(0x217)),{GoogleGenerativeAI}=require(a0_0x3a3552(0x29e)),installer=require(a0_0x3a3552(0x284)),scanner=require('./lib/scanner'),schedulers=require(a0_0x3a3552(0x1e4)),topology=require(a0_0x3a3552(0x296)),setup=require(a0_0x3a3552(0x28b)),recorder=require(a0_0x3a3552(0x233)),pythonBridge=require(a0_0x3a3552(0x23c)),aiAgent=require(a0_0x3a3552(0x209)),deadMan=require(a0_0x3a3552(0x1f4)),GEMINI_MODEL='models/gemini-flash-latest',ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils[a0_0x3a3552(0x21c)]{constructor(_0x1a0c74){const _0x183613=a0_0x3a3552;super({..._0x1a0c74,'name':_0x183613(0x1e0)}),this[_0x183613(0x22e)]=[],this['analysisHistory']=[],this[_0x183613(0x1f0)]=[],this[_0x183613(0x23b)]=[],this[_0x183613(0x1e6)]={},this[_0x183613(0x24c)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x183613(0x25f)]=![],this[_0x183613(0x28a)]=null,this[_0x183613(0x24d)]=null,this[_0x183613(0x25d)]=setup['SYSTEM_MODES'][_0x183613(0x275)],this['isProVersion']=![],this[_0x183613(0x1f9)]=![],this[_0x183613(0x280)]=null,this['ltmJob']=null,this[_0x183613(0x26e)]=null,this[_0x183613(0x237)]=null,this['briefingJob']=null,this[_0x183613(0x204)]=![],this['on'](_0x183613(0x208),this[_0x183613(0x20a)]['bind'](this)),this['on']('stateChange',this[_0x183613(0x291)][_0x183613(0x1ff)](this)),this['on']('unload',this[_0x183613(0x1d9)][_0x183613(0x1ff)](this)),this['on'](_0x183613(0x1d4),this[_0x183613(0x212)][_0x183613(0x1ff)](this));}async['onReady'](){const _0x3bf38c=a0_0x3a3552;this['log'][_0x3bf38c(0x255)](_0x3bf38c(0x202)+this[_0x3bf38c(0x259)]+_0x3bf38c(0x1f1));if(!installer[_0x3bf38c(0x1f3)](this,()=>this['startSystem']()))return;}async[a0_0x3a3552(0x1dd)](){const _0x5f057a=a0_0x3a3552;await setup[_0x5f057a(0x248)](this);try{this['isProVersion']=await setup[_0x5f057a(0x21d)](this[_0x5f057a(0x1d5)][_0x5f057a(0x22d)]);}catch(_0x37b19c){}if(!this['config'][_0x5f057a(0x1de)]||this['config']['inactivityThresholdHours']<0.1)this[_0x5f057a(0x1d5)]['inactivityThresholdHours']=0xc;await setup[_0x5f057a(0x1dc)](this),await setup[_0x5f057a(0x2a3)](this);if(this[_0x5f057a(0x1d5)][_0x5f057a(0x240)])try{this[_0x5f057a(0x28a)]=new GoogleGenerativeAI(this[_0x5f057a(0x1d5)][_0x5f057a(0x240)]),this[_0x5f057a(0x24d)]=this[_0x5f057a(0x28a)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5f057a(0x29b)}}),this['log'][_0x5f057a(0x255)](_0x5f057a(0x219));}catch(_0x533edc){this[_0x5f057a(0x278)]['error'](_0x5f057a(0x228)+_0x533edc[_0x5f057a(0x1d4)]);}await setup[_0x5f057a(0x221)](this),await this[_0x5f057a(0x279)]();try{const _0x2f814a=await this['getStateAsync'](_0x5f057a(0x1df));if(_0x2f814a&&_0x2f814a['val'])this[_0x5f057a(0x1f0)]=JSON[_0x5f057a(0x285)](_0x2f814a[_0x5f057a(0x26f)]);}catch(_0x3e6641){this[_0x5f057a(0x1f0)]=[];}try{const _0x516964=await this['getStateAsync']('LTM.dailyDigests');if(_0x516964&&_0x516964[_0x5f057a(0x26f)])this['dailyDigests']=JSON[_0x5f057a(0x285)](_0x516964[_0x5f057a(0x26f)]);}catch(_0x5538d9){this['dailyDigests']=[];}const _0x5e1941=this[_0x5f057a(0x23b)][_0x5f057a(0x244)]>=(this[_0x5f057a(0x1d5)]['minDaysForBaseline']||0x7)?_0x5f057a(0x29d)+this[_0x5f057a(0x23b)]['length']+'\x20Tage)':_0x5f057a(0x223)+this['dailyDigests'][_0x5f057a(0x244)]+'/'+(this['config']['minDaysForBaseline']||0x7)+')';await this[_0x5f057a(0x239)](_0x5f057a(0x256),{'val':_0x5e1941,'ack':!![]}),this['subscribeStates']('analysis.trigger'),this['subscribeStates'](_0x5f057a(0x288)),this[_0x5f057a(0x1d8)](_0x5f057a(0x297)),this[_0x5f057a(0x1d8)]('analysis.triggerBriefing'),this[_0x5f057a(0x1d8)](_0x5f057a(0x1ee)),this[_0x5f057a(0x1d8)](_0x5f057a(0x250)),this['subscribeStates'](_0x5f057a(0x236)),this['subscribeStates'](_0x5f057a(0x252)),this[_0x5f057a(0x1d8)](_0x5f057a(0x267)),this[_0x5f057a(0x1d8)]('analysis.training.triggerComfort'),this['subscribeStates']('analysis.training.triggerTopology');const _0x477297=this[_0x5f057a(0x1d5)][_0x5f057a(0x213)];if(_0x477297)for(const _0x3390c1 of _0x477297){await this[_0x5f057a(0x22c)](_0x3390c1['id']);}const _0xdfa7bb=this[_0x5f057a(0x1d5)][_0x5f057a(0x269)];if(_0xdfa7bb)for(const _0x377278 of _0xdfa7bb){await this[_0x5f057a(0x22c)](_0x377278);}if(this['config'][_0x5f057a(0x27a)]&&this[_0x5f057a(0x1d5)][_0x5f057a(0x1d7)])await this[_0x5f057a(0x22c)](this['config'][_0x5f057a(0x1d7)]+_0x5f057a(0x29c));setTimeout(()=>this[_0x5f057a(0x1f2)](),0x1388);if(this['analysisTimer'])clearInterval(this['analysisTimer']);const _0x221c0f=this[_0x5f057a(0x1d5)]['analysisInterval']||0xf;_0x221c0f>0x0&&(this[_0x5f057a(0x280)]=setInterval(()=>{this['runAutopilot']();},_0x221c0f*0x3c*0x3e8)),schedulers[_0x5f057a(0x1f8)](this,()=>aiAgent[_0x5f057a(0x1ec)](this,pythonBridge)),schedulers['setupModeResetScheduler'](this),schedulers[_0x5f057a(0x21a)](this,()=>aiAgent[_0x5f057a(0x1f6)](this)),schedulers[_0x5f057a(0x262)](this,()=>aiAgent[_0x5f057a(0x1e2)](this)),pythonBridge['startService'](this,installer[_0x5f057a(0x23d)]),setTimeout(async()=>{const _0x368a87=_0x5f057a;await topology['updateTopology'](this);try{const _0x4073e3=await this[_0x368a87(0x210)]('analysis.topology.structure');if(_0x4073e3&&_0x4073e3[_0x368a87(0x26f)])pythonBridge[_0x368a87(0x21f)](this,_0x368a87(0x230),JSON[_0x368a87(0x285)](_0x4073e3['val']));}catch(_0x41f23b){}this['runPythonHealthCheck'](),this[_0x368a87(0x21e)](),this[_0x368a87(0x1ed)](),this[_0x368a87(0x20d)]();},0x1388);}[a0_0x3a3552(0x1d9)](_0x2c91bd){const _0x325402=a0_0x3a3552;if(this[_0x325402(0x280)])clearInterval(this[_0x325402(0x280)]);if(this[_0x325402(0x237)])clearInterval(this['driftAnalysisTimer']);if(this[_0x325402(0x271)])this[_0x325402(0x271)][_0x325402(0x1ef)]();if(this[_0x325402(0x26e)])this[_0x325402(0x26e)][_0x325402(0x1ef)]();if(this[_0x325402(0x273)])this[_0x325402(0x273)][_0x325402(0x1ef)]();recorder[_0x325402(0x292)](this),pythonBridge['stopService'](this),_0x2c91bd();}async[a0_0x3a3552(0x291)](_0x88f77b,_0x59bf53){const _0x1bce50=a0_0x3a3552;if(!_0x59bf53||this[_0x1bce50(0x204)])return;if(_0x88f77b['includes'](_0x1bce50(0x1d3))&&_0x88f77b[_0x1bce50(0x235)](_0x1bce50(0x242))&&_0x59bf53['val'])return;if(_0x88f77b===this[_0x1bce50(0x277)]+'.system.mode'){if(_0x59bf53[_0x1bce50(0x26f)]&&Object[_0x1bce50(0x282)](setup['SYSTEM_MODES'])[_0x1bce50(0x22b)](_0x59bf53[_0x1bce50(0x26f)])){this['currentSystemMode']=_0x59bf53['val'];if(_0x59bf53[_0x1bce50(0x26f)]===setup[_0x1bce50(0x2a6)][_0x1bce50(0x207)])await recorder[_0x1bce50(0x20f)](this,![]);else await recorder[_0x1bce50(0x20f)](this,!![]);}if(!_0x59bf53[_0x1bce50(0x268)])this[_0x1bce50(0x1ea)](_0x88f77b,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x59bf53[_0x1bce50(0x268)]){_0x88f77b[_0x1bce50(0x22b)]('analysis.trigger')&&_0x59bf53[_0x1bce50(0x26f)]&&(this[_0x1bce50(0x1ea)](_0x88f77b,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this));if(_0x88f77b[_0x1bce50(0x22b)]('triggerDailyDigest')&&_0x59bf53[_0x1bce50(0x26f)]){this[_0x1bce50(0x1ea)](_0x88f77b,{'val':![],'ack':!![]});if(this[_0x1bce50(0x28c)])aiAgent['createDailyDigest'](this,pythonBridge);}_0x88f77b[_0x1bce50(0x22b)](_0x1bce50(0x251))&&_0x59bf53[_0x1bce50(0x26f)]&&(this['setState'](_0x88f77b,{'val':![],'ack':!![]}),aiAgent[_0x1bce50(0x1e2)](this));_0x88f77b[_0x1bce50(0x22b)](_0x1bce50(0x201))&&_0x59bf53[_0x1bce50(0x26f)]&&(this[_0x1bce50(0x1ea)](_0x88f77b,{'val':![],'ack':!![]}),aiAgent[_0x1bce50(0x1fd)](this));if(_0x88f77b[_0x1bce50(0x22b)](_0x1bce50(0x236))&&_0x59bf53[_0x1bce50(0x26f)]){this['setState'](_0x88f77b,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x3367c9=await this['getStateAsync']('LTM.trainingData.sequences');if(_0x3367c9&&_0x3367c9['val']){const _0x4bc48f=JSON['parse'](_0x3367c9[_0x1bce50(0x26f)]);this[_0x1bce50(0x239)](_0x1bce50(0x1fb),{'val':'Sec-Training\x20started...','ack':!![]}),pythonBridge[_0x1bce50(0x21f)](this,_0x1bce50(0x26d),{'sequences':_0x4bc48f});}}catch(_0x1cd92d){}}if(_0x88f77b['includes'](_0x1bce50(0x252))&&_0x59bf53['val']){this['setState'](_0x88f77b,{'val':![],'ack':!![]});if(this[_0x1bce50(0x28c)])try{const _0x4e337f=await this['getStateAsync']('LTM.dailyDigests');if(_0x4e337f&&_0x4e337f[_0x1bce50(0x26f)])pythonBridge['send'](this,_0x1bce50(0x274),{'digests':JSON[_0x1bce50(0x285)](_0x4e337f[_0x1bce50(0x26f)])});}catch(_0x57122a){}}if(_0x88f77b[_0x1bce50(0x22b)](_0x1bce50(0x267))&&_0x59bf53[_0x1bce50(0x26f)]){this[_0x1bce50(0x1ea)](_0x88f77b,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x5e32b2=await this[_0x1bce50(0x210)](_0x1bce50(0x1e5));if(_0x5e32b2&&_0x5e32b2[_0x1bce50(0x26f)])pythonBridge['send'](this,_0x1bce50(0x225),{'points':JSON[_0x1bce50(0x285)](_0x5e32b2['val'])});}catch(_0x611858){}}if(_0x88f77b[_0x1bce50(0x22b)](_0x1bce50(0x24e))&&_0x59bf53[_0x1bce50(0x26f)]){this[_0x1bce50(0x1ea)](_0x88f77b,{'val':![],'ack':!![]});if(this[_0x1bce50(0x28c)])try{const _0x52b29b=await this[_0x1bce50(0x210)](_0x1bce50(0x1df));if(_0x52b29b&&_0x52b29b[_0x1bce50(0x26f)])pythonBridge[_0x1bce50(0x21f)](this,_0x1bce50(0x29a),{'events':JSON[_0x1bce50(0x285)](_0x52b29b['val'])});}catch(_0x59f2ad){}}_0x88f77b['includes']('analysis.training.triggerTopology')&&_0x59bf53[_0x1bce50(0x26f)]&&(this[_0x1bce50(0x1ea)](_0x88f77b,{'val':![],'ack':!![]}),topology['updateTopology'](this));return;}if(this[_0x1bce50(0x1d5)][_0x1bce50(0x269)]&&this[_0x1bce50(0x1d5)]['presenceDevices'][_0x1bce50(0x22b)](_0x88f77b)){await this[_0x1bce50(0x1f2)]();return;}const _0x48eb21=(this[_0x1bce50(0x1d5)][_0x1bce50(0x213)]||[])[_0x1bce50(0x253)](_0x4592ef=>_0x4592ef['id']===_0x88f77b);if(_0x48eb21){const _0x3a402e=await recorder['processSensorEvent'](this,_0x88f77b,_0x59bf53,_0x48eb21);_0x3a402e&&_0x3a402e[_0x1bce50(0x26b)]===_0x1bce50(0x203)&&_0x3a402e[_0x1bce50(0x21b)]&&this['isProVersion']&&deadMan['updateLocation'](this,_0x3a402e[_0x1bce50(0x21b)]);}}async[a0_0x3a3552(0x212)](_0x163891){const _0xd35aee=a0_0x3a3552;if(typeof _0x163891===_0xd35aee(0x27e)&&_0x163891[_0xd35aee(0x1d4)]){if(_0x163891[_0xd35aee(0x270)]===_0xd35aee(0x200))try{const _0xa54a3f=_0x163891[_0xd35aee(0x1d4)][_0xd35aee(0x24a)];if(!_0xa54a3f)throw new Error(_0xd35aee(0x29f));const _0x25f5b3=new GoogleGenerativeAI(_0xa54a3f),_0x2eb5f4=_0x25f5b3[_0xd35aee(0x2a1)]({'model':GEMINI_MODEL}),_0x1673df=await _0x2eb5f4['generateContent'](_0xd35aee(0x229)),_0x22b48e=await _0x1673df[_0xd35aee(0x232)];if(_0x22b48e[_0xd35aee(0x26a)]())this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':!![],'message':'Verbindung\x20erfolgreich!'},_0x163891[_0xd35aee(0x2a5)]);else throw new Error(_0xd35aee(0x24f));}catch(_0x422020){this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':![],'message':_0x422020[_0xd35aee(0x1d4)]},_0x163891[_0xd35aee(0x2a5)]);}else{if(_0x163891[_0xd35aee(0x270)]===_0xd35aee(0x22f))try{const _0x36156f=await scanner[_0xd35aee(0x266)](this,_0x163891[_0xd35aee(0x1d4)]||{});this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':!![],'devices':_0x36156f},_0x163891[_0xd35aee(0x2a5)]);}catch(_0x5c0226){this[_0xd35aee(0x1e3)](_0x163891['from'],_0x163891[_0xd35aee(0x270)],{'success':![],'error':_0x5c0226[_0xd35aee(0x1d4)]},_0x163891[_0xd35aee(0x2a5)]);}else{if(_0x163891[_0xd35aee(0x270)]==='updateTopologyMatrix')try{const {matrix:_0x172fbf}=_0x163891[_0xd35aee(0x1d4)],_0x4d36b5=await this[_0xd35aee(0x210)]('analysis.topology.structure');if(_0x4d36b5&&_0x4d36b5[_0xd35aee(0x26f)]){const _0x484efb=JSON['parse'](_0x4d36b5[_0xd35aee(0x26f)]);_0x484efb[_0xd35aee(0x246)]=_0x172fbf,_0x484efb[_0xd35aee(0x299)]=Date['now'](),await this[_0xd35aee(0x239)](_0xd35aee(0x2a4),{'val':JSON[_0xd35aee(0x220)](_0x484efb),'ack':!![]}),pythonBridge[_0xd35aee(0x21f)](this,'SET_TOPOLOGY',_0x484efb);}this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':!![]},_0x163891[_0xd35aee(0x2a5)]);}catch(_0x48b34a){this[_0xd35aee(0x278)][_0xd35aee(0x238)](_0x48b34a);}else{if(_0x163891['command']==='getLtmData')this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':!![],'dailyDigests':this['dailyDigests']||[],'analysisHistory':this[_0xd35aee(0x222)]||[]},_0x163891[_0xd35aee(0x2a5)]);else{if(_0x163891['command']===_0xd35aee(0x211)){const _0x372483=this[_0xd35aee(0x23b)][_0xd35aee(0x244)],_0x53db48=new Array(0x18)[_0xd35aee(0x205)](0x0),_0x2b18fe=new Date()[_0xd35aee(0x28d)](0x0,0x0,0x0,0x0);this['eventHistory']&&this[_0xd35aee(0x22e)][_0xd35aee(0x257)](_0x48ac7f=>{const _0x4ee2d5=_0xd35aee;if(_0x48ac7f[_0x4ee2d5(0x25e)]>=_0x2b18fe){const _0x40048b=new Date(_0x48ac7f[_0x4ee2d5(0x25e)])[_0x4ee2d5(0x283)]();if(_0x40048b>=0x0&&_0x40048b<0x18)_0x53db48[_0x40048b]++;}}),this[_0xd35aee(0x1e3)](_0x163891['from'],_0x163891[_0xd35aee(0x270)],{'success':!![],'eventHistory':this[_0xd35aee(0x22e)][_0xd35aee(0x20b)](0x0,0xf),'stats':{'digestCount':_0x372483,'isPresent':this[_0xd35aee(0x231)],'hourlyActivity':_0x53db48},'automation':{'detected':![]}},_0x163891[_0xd35aee(0x2a5)]);}else{if(_0x163891['command']==='getEnums'){const _0x32e926=await this[_0xd35aee(0x214)](_0xd35aee(0x1d6),_0xd35aee(0x1e1)),_0x3207bc=[];if(_0x32e926)for(const _0x41613e in _0x32e926){const _0x2349c5=_0x32e926[_0x41613e],_0x1114b6=(_0x2349c5['common']&&typeof _0x2349c5[_0xd35aee(0x245)][_0xd35aee(0x25b)]===_0xd35aee(0x27e)?_0x2349c5[_0xd35aee(0x245)][_0xd35aee(0x25b)]['de']:_0x2349c5[_0xd35aee(0x245)][_0xd35aee(0x25b)])||_0x2349c5['common'][_0xd35aee(0x25b)];_0x3207bc[_0xd35aee(0x27b)]({'id':_0x41613e,'name':_0x1114b6});}const _0x32ee6a=await this['getForeignObjectsAsync']('enum.rooms.*','enum'),_0x252fb6=[];if(_0x32ee6a)for(const _0x320488 in _0x32ee6a){const _0x203682=_0x32ee6a[_0x320488],_0x492a27=(_0x203682[_0xd35aee(0x245)]&&typeof _0x203682[_0xd35aee(0x245)][_0xd35aee(0x25b)]==='object'?_0x203682[_0xd35aee(0x245)]['name']['de']:_0x203682[_0xd35aee(0x245)][_0xd35aee(0x25b)])||_0x320488[_0xd35aee(0x249)]('.')['pop']();_0x252fb6[_0xd35aee(0x27b)](_0x492a27);}this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':!![],'enums':_0x3207bc,'rooms':_0x252fb6},_0x163891['callback']);}else{if(_0x163891['command']===_0xd35aee(0x26c))try{let _0x1647fb=_0xd35aee(0x1e9),_0xd8533f=_0xd35aee(0x27d);if(this[_0xd35aee(0x1d5)][_0xd35aee(0x27f)]){const _0x44032c=await recorder['getOutsideTemperatureNumeric'](this);_0x1647fb=_0x44032c!==null?_0x44032c+'Â°C':'Daten\x20nicht\x20verfÃ¼gbar';}if(this['config'][_0xd35aee(0x20c)]){const _0xc9ca66=await this[_0xd35aee(0x234)](_0xd35aee(0x2a2)+this[_0xd35aee(0x1d5)]['calendarInstance']);_0xd8533f=_0xc9ca66?_0xd35aee(0x227):_0xd35aee(0x224);}this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':!![],'weather':_0x1647fb,'calendar':_0xd8533f},_0x163891[_0xd35aee(0x2a5)]);}catch(_0x580f28){this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':![],'error':_0x580f28[_0xd35aee(0x1d4)]},_0x163891[_0xd35aee(0x2a5)]);}else{if(_0x163891[_0xd35aee(0x270)]===_0xd35aee(0x243))try{const _0x140292=_0x163891[_0xd35aee(0x1d4)][_0xd35aee(0x298)],_0x44ce2a=await this['getForeignStateAsync'](_0x140292+_0xd35aee(0x25a));let _0x30f725=[];if(_0x44ce2a&&_0x44ce2a[_0xd35aee(0x26f)]){const _0x50be5a=JSON[_0xd35aee(0x285)](_0x44ce2a[_0xd35aee(0x26f)]),_0x59ca6a=new Set();Array[_0xd35aee(0x260)](_0x50be5a)&&_0x50be5a['forEach'](_0x661215=>{const _0x57671c=_0xd35aee;if(_0x661215['_calName'])_0x59ca6a['add'](_0x661215[_0x57671c(0x294)]);else{if(_0x661215[_0x57671c(0x218)])_0x59ca6a['add'](_0x661215[_0x57671c(0x218)]);}}),_0x30f725=Array[_0xd35aee(0x1da)](_0x59ca6a)[_0xd35aee(0x261)]();}if(_0x30f725['length']===0x0)_0x30f725=[_0xd35aee(0x272)];this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891['command'],{'success':!![],'names':_0x30f725},_0x163891['callback']);}catch(_0xe8e52){this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891['command'],{'success':![],'error':_0xe8e52[_0xd35aee(0x1d4)]},_0x163891[_0xd35aee(0x2a5)]);}else{if(_0x163891['command']==='testNotification')try{await setup[_0xd35aee(0x215)](this,_0xd35aee(0x27c),![],![]),this[_0xd35aee(0x1e3)](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':!![],'message':'Gesendet'},_0x163891['callback']);}catch(_0x494739){this['log'][_0xd35aee(0x238)](_0xd35aee(0x1d2)+_0x494739[_0xd35aee(0x1d4)]),this['sendTo'](_0x163891[_0xd35aee(0x1da)],_0x163891[_0xd35aee(0x270)],{'success':![],'message':_0xd35aee(0x1fc)+_0x494739['message']},_0x163891['callback']);}}}}}}}}}}}async[a0_0x3a3552(0x279)](){const _0x32b353=a0_0x3a3552;try{const _0x359f01=await this[_0x32b353(0x210)](setup[_0x32b353(0x286)]);_0x359f01&&_0x359f01[_0x32b353(0x26f)]&&Object[_0x32b353(0x282)](setup[_0x32b353(0x2a6)])[_0x32b353(0x22b)](_0x359f01[_0x32b353(0x26f)])?this[_0x32b353(0x25d)]=_0x359f01[_0x32b353(0x26f)]:(this[_0x32b353(0x25d)]=setup['SYSTEM_MODES'][_0x32b353(0x275)],await this[_0x32b353(0x239)](setup[_0x32b353(0x286)],{'val':setup[_0x32b353(0x2a6)]['NORMAL'],'ack':!![]}));}catch(_0x17d03a){this[_0x32b353(0x25d)]=setup[_0x32b353(0x2a6)][_0x32b353(0x275)];}}async[a0_0x3a3552(0x1f2)](){const _0x4c8862=a0_0x3a3552;try{const _0x4b26d3=this[_0x4c8862(0x1d5)][_0x4c8862(0x269)]||[];let _0x49148c=![];const _0x43f01f=[];for(const _0x4bac4d of _0x4b26d3){try{const _0x261b14=await this[_0x4c8862(0x22a)](_0x4bac4d);_0x261b14&&(_0x261b14[_0x4c8862(0x26f)]===!![]||_0x261b14[_0x4c8862(0x26f)]===_0x4c8862(0x206)||_0x261b14[_0x4c8862(0x26f)]===0x1)&&(_0x49148c=!![],_0x43f01f['push'](_0x4bac4d));}catch(_0x20ad18){}}return await this[_0x4c8862(0x239)](_0x4c8862(0x1db),{'val':_0x43f01f[_0x4c8862(0x28f)](',\x20'),'ack':!![]}),_0x49148c&&(this['exitTimer']&&(this[_0x4c8862(0x278)]['info'](_0x4c8862(0x28e)),recorder[_0x4c8862(0x292)](this)),!this[_0x4c8862(0x231)]&&this[_0x4c8862(0x25d)]===setup['SYSTEM_MODES']['NORMAL']&&await recorder['setPresence'](this,!![])),_0x49148c;}catch(_0x599340){return![];}}async['runAutopilot'](){const _0x494f14=a0_0x3a3552;this[_0x494f14(0x278)]['debug'](_0x494f14(0x2a0)),await aiAgent[_0x494f14(0x1e7)](this),this[_0x494f14(0x20d)](),this[_0x494f14(0x21e)](),this[_0x494f14(0x1ed)]();}[a0_0x3a3552(0x21e)](){const _0x4be23c=a0_0x3a3552;if(!this[_0x4be23c(0x28c)])return;try{this[_0x4be23c(0x247)](_0x4be23c(0x293),(_0x19faf5,_0x34a645)=>{const _0x1d6ebd=_0x4be23c;_0x34a645&&_0x34a645[_0x1d6ebd(0x26f)]&&pythonBridge['send'](this,_0x1d6ebd(0x258),{'sequences':JSON[_0x1d6ebd(0x285)](_0x34a645[_0x1d6ebd(0x26f)])});});}catch(_0xdecb7e){}}async[a0_0x3a3552(0x1ed)](){const _0x18be4b=a0_0x3a3552;if(!this[_0x18be4b(0x28c)])return;try{const _0x2cb746=await recorder[_0x18be4b(0x24b)](this);if(_0x2cb746===null)return;const _0x15eee6={},_0x36cca5=this[_0x18be4b(0x1d5)]['devices']||[];for(const _0x37620e of _0x36cca5){if(_0x37620e[_0x18be4b(0x26b)]===_0x18be4b(0x1fe)&&_0x37620e[_0x18be4b(0x21b)]){const _0x4bb430=this['sensorLastValues'][_0x37620e['id']];if(_0x4bb430!==undefined)_0x15eee6[_0x37620e[_0x18be4b(0x21b)]]=_0x4bb430;}}Object['keys'](_0x15eee6)[_0x18be4b(0x244)]>0x0&&pythonBridge['send'](this,_0x18be4b(0x254),{'current_temps':_0x15eee6,'t_out':_0x2cb746});}catch(_0x5c6f3b){}}[a0_0x3a3552(0x20d)](){const _0xb07b4f=a0_0x3a3552;if(!this[_0xb07b4f(0x1f0)]||this[_0xb07b4f(0x1f0)][_0xb07b4f(0x244)]===0x0)return;const _0x5cecbe=new Array(0x60)[_0xb07b4f(0x205)](0x0),_0x12a466=new Date()['setHours'](0x0,0x0,0x0,0x0);this[_0xb07b4f(0x1f0)][_0xb07b4f(0x257)](_0x2c5201=>{const _0x1de1b4=_0xb07b4f,_0x44e890=new Date(_0x2c5201[_0x1de1b4(0x25e)]);if(_0x44e890[_0x1de1b4(0x216)]()>=_0x12a466){const _0x1423f9=_0x44e890[_0x1de1b4(0x283)](),_0x22e657=_0x44e890[_0x1de1b4(0x23a)](),_0x2eff2c=_0x1423f9*0x4+Math['floor'](_0x22e657/0xf);if(_0x2eff2c>=0x0&&_0x2eff2c<0x60)_0x5cecbe[_0x2eff2c]++;}}),this[_0xb07b4f(0x239)]('analysis.health.todayVector',{'val':JSON[_0xb07b4f(0x220)](_0x5cecbe),'ack':!![]});}[a0_0x3a3552(0x1eb)](){const _0x3f79a0=a0_0x3a3552;if(!this['dailyDigests']||this[_0x3f79a0(0x23b)][_0x3f79a0(0x244)]<0x2)return;const _0x154fc4=this['dailyDigests'][_0x3f79a0(0x276)](_0x245847=>{const _0x389b2b=_0x3f79a0,_0x3eb844=(_0x245847[_0x389b2b(0x289)]||'')[_0x389b2b(0x1fa)]();return ACTIVITY_LEVEL_MAP[_0x3eb844]||0x32;});pythonBridge[_0x3f79a0(0x21f)](this,_0x3f79a0(0x23e),{'values':_0x154fc4,'tag':'Activity-Level'});}}if(require['main']!==module)module[a0_0x3a3552(0x263)]=_0x53dc88=>new CogniLiving(_0x53dc88);else new CogniLiving();