const a0_0x1e359a=a0_0x3481;function a0_0x3481(_0x4d881b,_0x1f4da6){const _0x4fb04a=a0_0x35d6();return a0_0x3481=function(_0x49a97e,_0x4da49b){_0x49a97e=_0x49a97e-0x84;let _0x35d692=_0x4fb04a[_0x49a97e];return _0x35d692;},a0_0x3481(_0x4d881b,_0x1f4da6);}(function(_0x11da6e,_0x2576b8){const _0x1cda6f=a0_0x3481,_0x5050f2=_0x11da6e();while(!![]){try{const _0x8f401e=parseInt(_0x1cda6f(0x11d))/0x1+parseInt(_0x1cda6f(0x1c1))/0x2+parseInt(_0x1cda6f(0x168))/0x3*(parseInt(_0x1cda6f(0xaa))/0x4)+-parseInt(_0x1cda6f(0x1c4))/0x5+-parseInt(_0x1cda6f(0x11e))/0x6+-parseInt(_0x1cda6f(0x183))/0x7+-parseInt(_0x1cda6f(0x1c3))/0x8;if(_0x8f401e===_0x2576b8)break;else _0x5050f2['push'](_0x5050f2['shift']());}catch(_0x43f49b){_0x5050f2['push'](_0x5050f2['shift']());}}}(a0_0x35d6,0x9770e));const a0_0x4da49b=(function(){let _0x3e42d3=!![];return function(_0x51dec4,_0x607b1b){const _0x53e7f2=_0x3e42d3?function(){const _0x55a5d6=a0_0x3481;if(_0x607b1b){const _0x311a2f=_0x607b1b[_0x55a5d6(0x139)](_0x51dec4,arguments);return _0x607b1b=null,_0x311a2f;}}:function(){};return _0x3e42d3=![],_0x53e7f2;};}()),a0_0x49a97e=a0_0x4da49b(this,function(){const _0x183bf0=a0_0x3481;return a0_0x49a97e[_0x183bf0(0x19a)]()['search']('(((.+)+)+)+$')['toString']()['constructor'](a0_0x49a97e)[_0x183bf0(0x14f)](_0x183bf0(0x9a));});a0_0x49a97e();function a0_0x35d6(){const _0x210690=['open','analysis.security.infrasoundLog','\x20sequences...','Daily\x20Activity\x20Vector\x20(24h)','setupLtmScheduler','weatherunderground.0','Kein\x20Wetter-Adapter','initZombies','guest','search','.data.table','Graph-Brain\x20Train\x20Error:\x20','LTM.rawEventLog','isPresent','NORMAL','config','ðŸŽ“\x20[RL-RESET]\x20Lern-Sperre\x20(Penalty)\x20fÃ¼r\x20\x27','\x20rooms\x20(preventing\x20Cold\x20Start\x20Amnesia).','TRAIN_TOPOLOGY','type','stringify','sensorLastValues','resetRLPenalty','./lib/topology','./lib/ai_agent','./lib/setup','some','TRACK_EVENT','triggerDailyDigest','ANOMALY\x20(Real\x20Threat?)','analysis.health.gaitSensors','analysis.triggerBriefing','bootTime','checkLicense','3XzPeCD','includes','notifyTelegramInstance','getCalendarNames','values','analysis.training.triggerHealth','ErklÃ¤rt\x20durch:\x20','from','ðŸ§ \x20Graph-Brain:\x20Training\x20Behaviour\x20Matrix\x20based\x20on\x20','analysis.automation.description','initHistory','useWeather','getGenerativeModel','parse','calendarName','memoryCache','checkAndInstall','thermostat','getTime','[Infrasound]\x20ðŸŸ¡\x20Debug-Mode:\x20Alarm\x20detected\x20but\x20suppressed\x20because\x20presence=true.','scanForDevices','forEach','lastTrackerEventTime','filter','window','sonn','[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]','3714319lOfYHJ','minDaysForBaseline','refreshCalendar','TRAIN_ENERGY','sensor.door','sources','healthTrendInterval','[Infrasound]\x20Subscribing\x20to\x20external\x20sensor:\x20','daswetter.0','modeResetJob','getState','CALIB','dependencyInstallInProgress','toLowerCase','endsWith','analysis.training.status','â±ï¸\x20Physics\x20Engine\x20finished.\x20Triggering\x20reactive\x20schedule\x20calculation...','exitGraceTimer','simulateEnergyMPC','setupModeResetScheduler','setPresence','protectAiMemory','Fehler:\x20','toString','PREDICT_ENERGY','genAI','processSensorEvent','setObjectNotExistsAsync','Verbunden','split','VACATION','analysis.energy.warmupTimes','cancel','getForeignObjectAsync','SET_TOPOLOGY','geminiApiKey','log','setStateAsync','analysis.trigger','common','clear',')\x20-\x20Phase\x20D\x20(Comfort\x20Refinement)','Keine\x20Sensor-AktivitÃ¤t','Fenster\x20geÃ¶ffnet:\x20','error','motion','val','map','ðŸ§ \x20Memory\x20Protection:\x20Restoring\x20persisted\x20AI-Calculations\x20(preventing\x20\x27Cold\x20Start\x27\x20amnesia).','Forensic\x20Infrasound\x20Log','join','enum','scanDevices','models/gemini-flash-latest','analysis.automation.patternDetected','analysis.energy.warmupTargets','SYSTEM_MODES','object','Sec-Training\x20started...','setupDriftAnalysisScheduler','licenseKey','briefingJob','2078118dXYRqj','analysisTimer','8623896xtuiPC','1706010dONWWS','getEnums','trackerEnabled','application/json','notifyPushoverEnabled','minutes_safe','analysis.training.triggerTopology','activityLevel','Lernphase\x20(','analysis.topology.structure','analysis.energy.activeEnforcements','onMessage','{\x22default\x22:\x2021}','push','cogni-living\x20adapter\x20starting\x20(v','now','geminiModel','testContext','onReady','Gemini\x20AI\x20initialized.','analysis.health.todayVector','length','analysis.energy.mpcActive','runGeminiAnalysis','MATCH\x20(False\x20Positive)','automation.triggerAction','PYTHON_EXE','stopService','\x20min\x20ausbleiben.','Warm-Up\x20Time\x20(Minutes\x20to\x20Target)','scanThermostats','ltmJob','PINN\x20AI\x20Forecast','response','TRAIN_COMFORT','pressureBuffer','namespace','heiter','testApiKey','(((.+)+)+)+$','getOutsideTemperatureNumeric','.communicate.request','sendNotification','LTM.trainingData.sequences','online','setState','onStateChange','LTM.triggerDailyDigest','getForeignObjectsAsync','find','ack','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','number','notifyTelegramEnabled','\x20devices.','4264984fUoYNa','subscribeForeignStates','_calName','createDailyDigest','Instanz\x20nicht\x20gefunden','analyzeWindowOpening','slice','subscribeStates','infrasoundArmingId','./lib/recorder','analysis.automation.targetValue','./lib/scanner','send','timestamp','dailyDigests','system.mode','.system.mode','isSolar','analysis.training.triggerEnergy','./lib/dead_man','version','bind','getOverviewData','runAutopilot','startSystem','triggerInfrasoundCorrelation','monitorEnforcements','string','\x20hPa\x20(Threshold:\x20','accuweather.0','Party\x20Mode','infrasoundLocked','sendMorningBriefing','name','state','generateContent','analysis.energy.warmupSources','isProVersion','checkSolarCondition','loadSystemMode','infrasoundSensorId','updateHealthVector','TRAIN_SECURITY','system.adapter.','updated','keys','calendarInstance','message','ALARM','location','updateSchedulePreview','temperature','ðŸ¤–\x20Butler\x20Training\x20started.\x20Injecting\x20knowledge\x20about\x20','devices','ðŸ§ \x20Memory:\x20Cache\x20hydrated\x20with\x20','Memory\x20Hydration\x20Failed:\x20','subscribeForeignStatesAsync','add','presenceDevices','pop','analysis.health.gaitDebug','getStateAsync','analysis.automation.autoApply','createAllObjects','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','setupBriefingScheduler','@google/generative-ai','cleanupGhostInterventions','fill','door','driftAnalysisTimer','Gesendet','sunny','info','magnet','warn','General\x20Activity\x20Trend\x20(%)','floor','analysis.energy.rlPenalties','updateLocation','executeAutomationAction','inactivityThresholdHours','runPythonHealthCheck','notifyPushoverInstance','callback','manual','command','LTM.dailyDigests','onUnload','./lib/python_bridge','infrasoundEnabled','analysisHistory','checkWifiPresence','getLtmData','Kein\x20Kalender-Adapter','rawEventLog','analysis.automation.targetId','WiFi\x20Presence\x20detected.','Key\x20not\x20found\x20or\x20not\x20provided','analysis.training.triggerSecurity','SYSTEM_DP_MODE','handleInfrasound','./lib/installer','unshift','times','value','TRAIN_HEALTH','setHours','scores','analysis.energy.insulationScore','\x20opened.\x20Peak\x20Pressure:\x20','infrasoundThreshold','currentSystemMode','getMinutes','Standard','733376YGYHED','1611438HIdnin','role','sort','simulateButler','exitTimer','analysis.security.learningStatus','Heizung\x20kann\x20','toFixed','json','sendTo','analysis.training.triggerComfort','analysis.energy.pinnForecast','LTM.trainingData.thermodynamics','\x20Tage)','Nuukanni\x20Security','system.presenceWho','analysisInterval','triggerEnergyPrediction','Daten\x20nicht\x20verfÃ¼gbar','triggerBriefing','text','isArray','eventHistory','trackerHeartbeat','enum.functions.*','checkCalendarTriggers','Notification\x20Test\x20Failed:\x20','apply','[Forensics]\x20Save\x20failed:\x20','Sensors\x20used\x20for\x20Gait\x20Analysis','matrix','systemConfig','updateTopology','Verbindung\x20erfolgreich!','updateTopologyMatrix','startService','abs','enum.rooms.*','getForeignStateAsync','Comfort\x20Train\x20Error:\x20'];a0_0x35d6=function(){return _0x210690;};return a0_0x35d6();}'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x1e359a(0xec)),installer=require(a0_0x1e359a(0x110)),scanner=require(a0_0x1e359a(0xb5)),schedulers=require('./lib/scheduler'),topology=require(a0_0x1e359a(0x15d)),setup=require(a0_0x1e359a(0x15f)),recorder=require(a0_0x1e359a(0xb3)),pythonBridge=require(a0_0x1e359a(0x103)),aiAgent=require(a0_0x1e359a(0x15e)),deadMan=require(a0_0x1e359a(0xbd)),automation=require('./lib/automation'),GEMINI_MODEL=a0_0x1e359a(0x1b8),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils['Adapter']{constructor(_0x3255f9){const _0x590bde=a0_0x1e359a;super({..._0x3255f9,'name':'cogni-living'}),this[_0x590bde(0x134)]=[],this['analysisHistory']=[],this[_0x590bde(0x109)]=[],this[_0x590bde(0xb8)]=[],this[_0x590bde(0x15b)]={},this[_0x590bde(0x13d)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x590bde(0x153)]=!![],this[_0x590bde(0x122)]=null,this[_0x590bde(0x194)]=null,this['isGracePeriodActive']=![],this[_0x590bde(0x19c)]=null,this[_0x590bde(0x1d4)]=null,this['currentSystemMode']=setup['SYSTEM_MODES'][_0x590bde(0x154)],this[_0x590bde(0xcf)]=![],this['lastAlertState']=![],this[_0x590bde(0x1c2)]=null,this[_0x590bde(0x92)]=null,this['modeResetJob']=null,this[_0x590bde(0xf0)]=null,this[_0x590bde(0x1c0)]=null,this[_0x590bde(0x135)]=null,this['healthTrendInterval']=null,this['dependencyInstallInProgress']=![],this[_0x590bde(0x17e)]=Date[_0x590bde(0x1d3)](),this[_0x590bde(0x177)]=null,this['bootTime']=Date[_0x590bde(0x1d3)](),this[_0x590bde(0xc9)]=![],this[_0x590bde(0x96)]=[],this['on']('ready',this[_0x590bde(0x85)][_0x590bde(0xbf)](this)),this['on']('stateChange',this[_0x590bde(0xa1)]['bind'](this)),this['on']('unload',this[_0x590bde(0x102)][_0x590bde(0xbf)](this)),this['on'](_0x590bde(0xd9),this[_0x590bde(0x1cf)][_0x590bde(0xbf)](this));}async[a0_0x1e359a(0x85)](){const _0x405a9b=a0_0x1e359a;this[_0x405a9b(0x1a7)][_0x405a9b(0xf3)](_0x405a9b(0x1d2)+this[_0x405a9b(0xbe)]+_0x405a9b(0x1ac));if(!installer[_0x405a9b(0x178)](this,()=>this[_0x405a9b(0xc2)]()))return;}async[a0_0x1e359a(0xc2)](){const _0x1f612e=a0_0x1e359a;await setup[_0x1f612e(0x14d)](this);try{this[_0x1f612e(0xcf)]=await setup[_0x1f612e(0x167)](this[_0x1f612e(0x155)][_0x1f612e(0x1bf)]);}catch(_0x3aa5b4){}if(!this[_0x1f612e(0x155)][_0x1f612e(0xfb)]||this[_0x1f612e(0x155)]['inactivityThresholdHours']<0.1)this[_0x1f612e(0x155)][_0x1f612e(0xfb)]=0xc;await setup[_0x1f612e(0x172)](this),await setup['initSystemConfig'](this);try{const _0x19dd72=await this[_0x1f612e(0xe7)](_0x1f612e(0x1a2)),_0x59153b=await this[_0x1f612e(0xe7)]('analysis.energy.warmupSources');_0x19dd72&&_0x19dd72['val']&&_0x59153b&&_0x59153b['val']&&(Date[_0x1f612e(0x1d3)]()-_0x19dd72['ts']<0x4*0xe10*0x3e8&&(this[_0x1f612e(0x177)]={'times':JSON[_0x1f612e(0x175)](_0x19dd72[_0x1f612e(0x1b1)]),'sources':JSON[_0x1f612e(0x175)](_0x59153b[_0x1f612e(0x1b1)])},this[_0x1f612e(0x1a7)]['info'](_0x1f612e(0xe0)+Object[_0x1f612e(0xd7)](this[_0x1f612e(0x177)][_0x1f612e(0x112)])['length']+_0x1f612e(0x157))));}catch(_0xae23ff){this[_0x1f612e(0x1a7)][_0x1f612e(0xf5)](_0x1f612e(0xe1)+_0xae23ff[_0x1f612e(0xd9)]);}if(this[_0x1f612e(0x155)][_0x1f612e(0x1a6)])try{this[_0x1f612e(0x19c)]=new GoogleGenerativeAI(this[_0x1f612e(0x155)][_0x1f612e(0x1a6)]),this[_0x1f612e(0x1d4)]=this[_0x1f612e(0x19c)][_0x1f612e(0x174)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x1f612e(0x1c7)}}),this[_0x1f612e(0x1a7)][_0x1f612e(0xf3)](_0x1f612e(0x86));}catch(_0x24bb95){this[_0x1f612e(0x1a7)]['error']('Gemini\x20Init\x20Error:\x20'+_0x24bb95[_0x1f612e(0xd9)]);}await setup[_0x1f612e(0xe9)](this),await this[_0x1f612e(0xd1)](),await this['setObjectNotExistsAsync'](_0x1f612e(0x129),{'type':_0x1f612e(0xcc),'common':{'name':_0x1f612e(0x93),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x1f612e(0x19e)]('analysis.energy.ventilationAlerts',{'type':_0x1f612e(0xcc),'common':{'name':'Active\x20Ventilation\x20Alerts','type':_0x1f612e(0xc5),'role':_0x1f612e(0x126),'read':!![],'write':![]},'native':{}}),await this[_0x1f612e(0x19e)](_0x1f612e(0x1a2),{'type':_0x1f612e(0xcc),'common':{'name':_0x1f612e(0x90),'type':_0x1f612e(0xc5),'role':_0x1f612e(0x126),'read':!![],'write':![]},'native':{}}),await this[_0x1f612e(0x19e)]('analysis.energy.warmupTargets',{'type':_0x1f612e(0xcc),'common':{'name':'Warm-Up\x20Target\x20Temps\x20(JSON)','type':_0x1f612e(0xc5),'role':_0x1f612e(0x126),'read':!![],'write':!![],'def':_0x1f612e(0x1d0)},'native':{}}),await this[_0x1f612e(0x19e)](_0x1f612e(0xf8),{'type':'state','common':{'name':'Reinforcement\x20Learning\x20Penalties','type':_0x1f612e(0xc5),'role':_0x1f612e(0x126),'read':!![],'write':![],'def':'{}'},'native':{}}),await this[_0x1f612e(0x19e)]('analysis.health.activityTrend',{'type':'state','common':{'name':_0x1f612e(0xf6),'type':_0x1f612e(0xa7),'role':_0x1f612e(0x113),'unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x1f612e(0x164),{'type':'state','common':{'name':_0x1f612e(0x13b),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x1f612e(0x1ce),{'type':_0x1f612e(0xcc),'common':{'name':'Active\x20Calendar\x20Enforcements\x20(Locks)','type':_0x1f612e(0xc5),'role':_0x1f612e(0x126),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1f612e(0x19e)](_0x1f612e(0x147),{'type':_0x1f612e(0xcc),'common':{'name':_0x1f612e(0x1b4),'type':_0x1f612e(0xc5),'role':_0x1f612e(0x126),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1f612e(0x19e)](_0x1f612e(0xe6),{'type':_0x1f612e(0xcc),'common':{'name':'Gait\x20Speed\x20Calculation\x20Proof','type':'string','role':_0x1f612e(0x132),'read':!![],'write':![]},'native':{}}),await this[_0x1f612e(0x19e)](_0x1f612e(0x87),{'type':_0x1f612e(0xcc),'common':{'name':_0x1f612e(0x149),'type':_0x1f612e(0xc5),'role':_0x1f612e(0x126),'read':!![],'write':![],'def':_0x1f612e(0x182)},'native':{}});try{const _0x18c034=await this['getStateAsync'](_0x1f612e(0x152));if(_0x18c034&&_0x18c034['val'])this[_0x1f612e(0x109)]=JSON['parse'](_0x18c034[_0x1f612e(0x1b1)]);}catch(_0x56b88f){this[_0x1f612e(0x109)]=[];}try{const _0x26e51d=await this[_0x1f612e(0xe7)]('LTM.dailyDigests');if(_0x26e51d&&_0x26e51d['val'])this[_0x1f612e(0xb8)]=JSON[_0x1f612e(0x175)](_0x26e51d['val']);}catch(_0x16a01a){this[_0x1f612e(0xb8)]=[];}const _0x1fd949=this['dailyDigests']['length']>=(this[_0x1f612e(0x155)][_0x1f612e(0x184)]||0x7)?'Aktiv\x20('+this['dailyDigests'][_0x1f612e(0x88)]+_0x1f612e(0x12b):_0x1f612e(0x1cc)+this['dailyDigests'][_0x1f612e(0x88)]+'/'+(this[_0x1f612e(0x155)][_0x1f612e(0x184)]||0x7)+')';await this[_0x1f612e(0x1a8)]('LTM.baselineStatus',{'val':_0x1fd949,'ack':!![]}),this[_0x1f612e(0xb1)](_0x1f612e(0x1a9)),this['subscribeStates'](_0x1f612e(0xa2)),this['subscribeStates'](_0x1f612e(0xb9)),this['subscribeStates'](_0x1f612e(0x165)),this['subscribeStates']('analysis.automation.triggerAction'),this[_0x1f612e(0xb1)](_0x1f612e(0xe8)),this[_0x1f612e(0xb1)](_0x1f612e(0x10d)),this[_0x1f612e(0xb1)](_0x1f612e(0x16d)),this[_0x1f612e(0xb1)](_0x1f612e(0xbc)),this[_0x1f612e(0xb1)](_0x1f612e(0x128)),this[_0x1f612e(0xb1)](_0x1f612e(0x1ca)),this['subscribeStates'](_0x1f612e(0x89)),this[_0x1f612e(0xb1)](_0x1f612e(0xce)),this['subscribeStates'](_0x1f612e(0x1a2));this[_0x1f612e(0x155)][_0x1f612e(0x104)]&&this[_0x1f612e(0x155)][_0x1f612e(0xd2)]&&(this[_0x1f612e(0x1a7)]['info'](_0x1f612e(0x18a)+this[_0x1f612e(0x155)][_0x1f612e(0xd2)]),this[_0x1f612e(0xab)](this[_0x1f612e(0x155)][_0x1f612e(0xd2)]));const _0x131562=this['config'][_0x1f612e(0xdf)];if(_0x131562)for(const _0x290774 of _0x131562){await this['subscribeForeignStatesAsync'](_0x290774['id']);}const _0x5019bd=this[_0x1f612e(0x155)]['presenceDevices'];if(_0x5019bd)for(const _0x44252f of _0x5019bd){await this[_0x1f612e(0xe2)](_0x44252f);}if(this['config'][_0x1f612e(0xa8)]&&this[_0x1f612e(0x155)]['notifyTelegramInstance'])await this[_0x1f612e(0xe2)](this[_0x1f612e(0x155)][_0x1f612e(0x16a)]+_0x1f612e(0x9c));setTimeout(()=>this[_0x1f612e(0x106)](),0x1388);if(this[_0x1f612e(0x1c2)])clearInterval(this[_0x1f612e(0x1c2)]);const _0x3824ee=this['config'][_0x1f612e(0x12e)]||0xf;_0x3824ee>0x0&&(this[_0x1f612e(0x1c2)]=setInterval(()=>{this['runAutopilot'](),automation['monitorEnforcements'](this);},_0x3824ee*0x3c*0x3e8));setTimeout(()=>{const _0x279767=_0x1f612e;automation[_0x279767(0x137)](this),automation[_0x279767(0xc4)](this);},0x2710);this['config'][_0x1f612e(0x1c6)]!==![]&&(this[_0x1f612e(0x135)]=setInterval(()=>{const _0x6bc451=_0x1f612e;if(this[_0x6bc451(0xcf)]){const _0x1227c3=Date[_0x6bc451(0x1d3)](),_0x561a67=this[_0x6bc451(0x17e)]||_0x1227c3,_0x189ce7=(_0x1227c3-_0x561a67)/0x3e8;_0x189ce7>0x2&&(this[_0x6bc451(0x17e)]=_0x1227c3,pythonBridge[_0x6bc451(0xb6)](this,_0x6bc451(0x161),{'room':null,'dt':_0x189ce7}));}},0xbb8));if(this[_0x1f612e(0x189)])clearInterval(this[_0x1f612e(0x189)]);this[_0x1f612e(0x189)]=setInterval(()=>{const _0x1751c5=_0x1f612e;this['isProVersion']&&(this[_0x1751c5(0x1a7)][_0x1751c5(0xf3)]('â¤ï¸\x20Auto-Heartbeat:\x20Aktualisiere\x20Gesundheits-Trends...'),this[_0x1751c5(0xfc)]());},0x4*0x3c*0x3c*0x3e8),schedulers[_0x1f612e(0x14a)](this,()=>aiAgent[_0x1f612e(0xad)](this,pythonBridge)),schedulers[_0x1f612e(0x196)](this),schedulers[_0x1f612e(0x1be)](this,()=>aiAgent['runBaselineDriftAnalysis'](this)),schedulers[_0x1f612e(0xeb)](this,()=>aiAgent[_0x1f612e(0xca)](this)),pythonBridge[_0x1f612e(0x141)](this,installer[_0x1f612e(0x8d)]),setTimeout(async()=>{const _0x3c8658=_0x1f612e;await topology[_0x3c8658(0x13e)](this);try{const _0x54f2d0=await this['getStateAsync']('analysis.topology.structure');if(_0x54f2d0&&_0x54f2d0[_0x3c8658(0x1b1)])pythonBridge[_0x3c8658(0xb6)](this,'SET_TOPOLOGY',JSON['parse'](_0x54f2d0[_0x3c8658(0x1b1)]));}catch(_0x503594){}this[_0x3c8658(0xfc)](),this['triggerGaitAnalysis'](),this[_0x3c8658(0x12f)](),this[_0x3c8658(0xd3)]();},0x1388);}[a0_0x1e359a(0x102)](_0x4c0d1c){const _0x2a3153=a0_0x1e359a;if(this[_0x2a3153(0x1c2)])clearInterval(this['analysisTimer']);if(this[_0x2a3153(0xf0)])clearInterval(this[_0x2a3153(0xf0)]);if(this[_0x2a3153(0x135)])clearInterval(this[_0x2a3153(0x135)]);if(this[_0x2a3153(0x189)])clearInterval(this[_0x2a3153(0x189)]);if(this[_0x2a3153(0x92)])this['ltmJob'][_0x2a3153(0x1a3)]();if(this[_0x2a3153(0x18c)])this[_0x2a3153(0x18c)][_0x2a3153(0x1a3)]();if(this[_0x2a3153(0x1c0)])this[_0x2a3153(0x1c0)][_0x2a3153(0x1a3)]();recorder['abortExitTimer'](this),pythonBridge[_0x2a3153(0x8e)](this),_0x4c0d1c();}async[a0_0x1e359a(0xa1)](_0xd0d65d,_0x209e4c){const _0x14e8f=a0_0x1e359a;if(!_0x209e4c||this[_0x14e8f(0x18f)])return;if(_0xd0d65d['includes']('telegram')&&_0xd0d65d[_0x14e8f(0x191)]('communicate.request')&&_0x209e4c[_0x14e8f(0x1b1)])return;if(this[_0x14e8f(0x155)][_0x14e8f(0x104)]&&_0xd0d65d===this[_0x14e8f(0x155)][_0x14e8f(0xd2)]){this['handleInfrasound'](_0x209e4c[_0x14e8f(0x1b1)]);return;}if(_0xd0d65d===this[_0x14e8f(0x97)]+_0x14e8f(0xba)){if(_0x209e4c[_0x14e8f(0x1b1)]&&Object['values'](setup[_0x14e8f(0x1bb)])['includes'](_0x209e4c['val'])){this[_0x14e8f(0x11a)]=_0x209e4c[_0x14e8f(0x1b1)];if(_0x209e4c[_0x14e8f(0x1b1)]===setup[_0x14e8f(0x1bb)][_0x14e8f(0x1a1)])await recorder[_0x14e8f(0x197)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x14e8f(0xcf)]){let _0x112f78=![],_0x423745=0x0,_0xf3a6e7=_0x14e8f(0xff);if(this[_0x14e8f(0x11a)]==='party')_0x112f78=!![],_0x423745=0x168,_0xf3a6e7=_0x14e8f(0xc8);else this['currentSystemMode']===_0x14e8f(0x14e)&&(_0x112f78=!![],_0x423745=0x5a0,_0xf3a6e7='Guest\x20Mode');pythonBridge[_0x14e8f(0xb6)](this,'SET_LEARNING_MODE',{'active':_0x112f78,'duration':_0x423745,'label':_0xf3a6e7}),await this[_0x14e8f(0x1a8)](_0x14e8f(0x123),{'val':JSON[_0x14e8f(0x15a)]({'active':_0x112f78,'label':_0xf3a6e7,'timestamp':Date[_0x14e8f(0x1d3)]()}),'ack':!![]});}}if(!_0x209e4c['ack'])this[_0x14e8f(0xa0)](_0xd0d65d,{'val':this['currentSystemMode'],'ack':!![]});return;}_0xd0d65d[_0x14e8f(0x191)](_0x14e8f(0xce))&&_0x209e4c[_0x14e8f(0xa5)]&&this[_0x14e8f(0x198)](_0x209e4c['val']);_0xd0d65d[_0x14e8f(0x191)](_0x14e8f(0x1a2))&&_0x209e4c[_0x14e8f(0xa5)]&&(this[_0x14e8f(0x1a7)]['debug'](_0x14e8f(0x193)),automation[_0x14e8f(0x137)](this));if(!_0x209e4c[_0x14e8f(0xa5)]){if(_0xd0d65d[_0x14e8f(0x169)](_0x14e8f(0x1a9))&&_0x209e4c[_0x14e8f(0x1b1)]){this[_0x14e8f(0xa0)](_0xd0d65d,{'val':![],'ack':!![]}),aiAgent[_0x14e8f(0x8a)](this);return;}if(_0xd0d65d[_0x14e8f(0x169)](_0x14e8f(0x162))&&_0x209e4c[_0x14e8f(0x1b1)]){this[_0x14e8f(0xa0)](_0xd0d65d,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent[_0x14e8f(0xad)](this,pythonBridge);return;}if(_0xd0d65d['includes'](_0x14e8f(0x131))&&_0x209e4c[_0x14e8f(0x1b1)]){this[_0x14e8f(0xa0)](_0xd0d65d,{'val':![],'ack':!![]}),aiAgent[_0x14e8f(0xca)](this);return;}if(_0xd0d65d[_0x14e8f(0x169)](_0x14e8f(0x8c))&&_0x209e4c['val']){this[_0x14e8f(0xa0)](_0xd0d65d,{'val':![],'ack':!![]}),aiAgent[_0x14e8f(0xfa)](this);return;}if(_0xd0d65d['includes']('analysis.training.triggerSecurity')&&_0x209e4c[_0x14e8f(0x1b1)]){this[_0x14e8f(0xa0)](_0xd0d65d,{'val':![],'ack':!![]});if(this[_0x14e8f(0xcf)])try{const _0x1ee169=await this[_0x14e8f(0xe7)]('LTM.trainingData.sequences');if(_0x1ee169&&_0x1ee169[_0x14e8f(0x1b1)]){const _0x1a6b17=JSON[_0x14e8f(0x175)](_0x1ee169[_0x14e8f(0x1b1)]);this[_0x14e8f(0x1a8)](_0x14e8f(0x192),{'val':_0x14e8f(0x1bd),'ack':!![]}),pythonBridge[_0x14e8f(0xb6)](this,_0x14e8f(0xd4),{'sequences':_0x1a6b17});}}catch(_0x4f2885){}return;}if(_0xd0d65d[_0x14e8f(0x169)](_0x14e8f(0x16d))&&_0x209e4c['val']){this['setState'](_0xd0d65d,{'val':![],'ack':!![]});if(this[_0x14e8f(0xcf)])try{const _0x2909a7=await this[_0x14e8f(0xe7)](_0x14e8f(0x101));if(_0x2909a7&&_0x2909a7[_0x14e8f(0x1b1)])pythonBridge[_0x14e8f(0xb6)](this,_0x14e8f(0x114),{'digests':JSON[_0x14e8f(0x175)](_0x2909a7['val'])});}catch(_0x272fbb){}return;}if(_0xd0d65d['includes'](_0x14e8f(0xbc))&&_0x209e4c[_0x14e8f(0x1b1)]){this[_0x14e8f(0xa0)](_0xd0d65d,{'val':![],'ack':!![]});if(this[_0x14e8f(0xcf)])try{const _0x3becaf=await this[_0x14e8f(0xe7)](_0x14e8f(0x12a));if(_0x3becaf&&_0x3becaf['val'])pythonBridge[_0x14e8f(0xb6)](this,_0x14e8f(0x186),{'points':JSON[_0x14e8f(0x175)](_0x3becaf[_0x14e8f(0x1b1)])});}catch(_0x45cb7c){}return;}if(_0xd0d65d['includes']('analysis.training.triggerComfort')&&_0x209e4c[_0x14e8f(0x1b1)]){this[_0x14e8f(0xa0)](_0xd0d65d,{'val':![],'ack':!![]});if(this[_0x14e8f(0xcf)])try{const _0x399f62=await this['getStateAsync']('LTM.rawEventLog');if(_0x399f62&&_0x399f62[_0x14e8f(0x1b1)]){const _0x472982={};this['config'][_0x14e8f(0xdf)]&&Array[_0x14e8f(0x133)](this[_0x14e8f(0x155)][_0x14e8f(0xdf)])&&this['config'][_0x14e8f(0xdf)][_0x14e8f(0x17d)](_0x37b1a2=>{const _0x11d72e=_0x14e8f;if(_0x37b1a2['id']&&_0x37b1a2[_0x11d72e(0x159)])_0x472982[_0x37b1a2['id']]=_0x37b1a2['type'];}),this[_0x14e8f(0x1a7)][_0x14e8f(0xf3)](_0x14e8f(0xde)+Object[_0x14e8f(0xd7)](_0x472982)['length']+_0x14e8f(0xa9)),pythonBridge['send'](this,_0x14e8f(0x95),{'events':JSON['parse'](_0x399f62[_0x14e8f(0x1b1)]),'deviceMap':_0x472982});}}catch(_0x17cdf3){this[_0x14e8f(0x1a7)]['error'](_0x14e8f(0x145)+_0x17cdf3['message']);}return;}if(_0xd0d65d[_0x14e8f(0x169)]('analysis.training.triggerTopology')&&_0x209e4c[_0x14e8f(0x1b1)]){this['setState'](_0xd0d65d,{'val':![],'ack':!![]}),topology[_0x14e8f(0x13e)](this);if(this['isProVersion'])try{const _0x456e9c=await this[_0x14e8f(0xe7)](_0x14e8f(0x9e));if(_0x456e9c&&_0x456e9c['val']){const _0x5795e9=JSON[_0x14e8f(0x175)](_0x456e9c['val']);this[_0x14e8f(0x1a7)][_0x14e8f(0xf3)](_0x14e8f(0x170)+_0x5795e9['length']+_0x14e8f(0x148)),pythonBridge[_0x14e8f(0xb6)](this,_0x14e8f(0x158),{'sequences':_0x5795e9});}else this[_0x14e8f(0x1a7)][_0x14e8f(0xf5)]('âš ï¸\x20Graph-Brain:\x20No\x20training\x20sequences\x20found\x20in\x20LTM.');}catch(_0x4fcb50){this[_0x14e8f(0x1a7)][_0x14e8f(0x1af)](_0x14e8f(0x151)+_0x4fcb50[_0x14e8f(0xd9)]);}return;}}if(this[_0x14e8f(0x155)][_0x14e8f(0xe4)]&&this[_0x14e8f(0x155)][_0x14e8f(0xe4)][_0x14e8f(0x169)](_0xd0d65d)){await this[_0x14e8f(0x106)]();return;}const _0x4223a8=(this['config'][_0x14e8f(0xdf)]||[])[_0x14e8f(0xa4)](_0x2629c2=>_0x2629c2['id']===_0xd0d65d);if(_0x4223a8){const _0x4b0ba4=await recorder[_0x14e8f(0x19d)](this,_0xd0d65d,_0x209e4c,_0x4223a8);_0x4b0ba4&&_0x4b0ba4[_0x14e8f(0x159)]===_0x14e8f(0x1b0)&&_0x4b0ba4[_0x14e8f(0xdb)]&&this[_0x14e8f(0xcf)]&&deadMan[_0x14e8f(0xf9)](this,_0x4b0ba4[_0x14e8f(0xdb)]),_0x209e4c['val']&&(_0x209e4c['val']===!![]||_0x209e4c[_0x14e8f(0x1b1)]===0x1||String(_0x209e4c[_0x14e8f(0x1b1)])[_0x14e8f(0x190)]()===_0x14e8f(0x146))&&(_0x4223a8['type']&&(_0x4223a8['type']['includes'](_0x14e8f(0x180))||_0x4223a8[_0x14e8f(0x159)][_0x14e8f(0x169)](_0x14e8f(0xef))||_0x4223a8[_0x14e8f(0x159)][_0x14e8f(0x169)](_0x14e8f(0xf4)))&&this['analyzeWindowOpening'](_0x4223a8)),(_0x4223a8[_0x14e8f(0x159)]===_0x14e8f(0xdd)||_0x4223a8['type']===_0x14e8f(0x179))&&automation[_0x14e8f(0xed)](this);}}async[a0_0x1e359a(0x198)](_0x56b89e){const _0x561097=a0_0x1e359a;if(!this[_0x561097(0x177)]||Date['now']()-this[_0x561097(0x166)]>0x493e0)return;if(!this['memoryCache']['sources']||!this[_0x561097(0x177)][_0x561097(0x112)])return;try{const _0xa0578c=JSON[_0x561097(0x175)](_0x56b89e),_0x4f75a3=this['memoryCache'][_0x561097(0x188)];let _0x282916=![];for(const _0x1ad1e9 in _0x4f75a3){if(_0x4f75a3[_0x1ad1e9][_0x561097(0x169)]('AI')&&_0xa0578c[_0x1ad1e9]&&!_0xa0578c[_0x1ad1e9][_0x561097(0x169)]('AI')){_0x282916=!![];break;}}_0x282916&&(this[_0x561097(0x1a7)][_0x561097(0xf3)](_0x561097(0x1b3)),await this[_0x561097(0x1a8)]('analysis.energy.warmupTimes',{'val':JSON[_0x561097(0x15a)](this[_0x561097(0x177)][_0x561097(0x112)]),'ack':!![]}),await this[_0x561097(0x1a8)](_0x561097(0xce),{'val':JSON[_0x561097(0x15a)](this[_0x561097(0x177)]['sources']),'ack':!![]}));}catch(_0x37782a){}}async[a0_0x1e359a(0x1cf)](_0x41189e){const _0x46729d=a0_0x1e359a;if(typeof _0x41189e===_0x46729d(0x1bc)&&_0x41189e[_0x46729d(0xd9)]){if(_0x41189e[_0x46729d(0x100)]==='checkThermostats')try{const _0x443190=await automation[_0x46729d(0x91)](this);this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e['command'],{'success':!![],'results':_0x443190},_0x41189e[_0x46729d(0xfe)]);}catch(_0x228208){this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':![],'error':_0x228208[_0x46729d(0xd9)]},_0x41189e['callback']);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x195))try{const {current_temps:_0x4db5b6,t_out:_0x2ee4fd,targets:_0x1aa0cf,t_forecast:_0x268dec}=_0x41189e[_0x46729d(0xd9)],_0x34204d=[];let _0x3ef31b={};try{const _0x3bc308=await this[_0x46729d(0xe7)](_0x46729d(0x117));if(_0x3bc308&&_0x3bc308[_0x46729d(0x1b1)]){const _0x42a63f=JSON[_0x46729d(0x175)](_0x3bc308[_0x46729d(0x1b1)]);_0x3ef31b=_0x42a63f[_0x46729d(0x116)]||_0x42a63f;}}catch(_0x3f0b11){}const _0x169611=_0x268dec!==undefined&&_0x268dec!==null?(_0x2ee4fd+_0x268dec)/0x2:_0x2ee4fd;for(const [_0x32defd,_0x402889]of Object['entries'](_0x4db5b6)){const _0x264ace=_0x1aa0cf[_0x32defd]||0x15;if(_0x402889<=_0x264ace)continue;let _0x2d7b1d=_0x3ef31b[_0x32defd]||-0.5;if(_0x2d7b1d>=0x0)_0x2d7b1d=-0.5;const _0x7a7b23=Math[_0x46729d(0x142)](_0x2d7b1d),_0x2b2973=_0x402889-_0x264ace;let _0x2076f1=Math[_0x46729d(0xf7)](_0x2b2973/_0x7a7b23*0x3c);const _0x2568ef=_0x402889-_0x2ee4fd,_0x15d13c=_0x402889-_0x169611;if(_0x15d13c!==0x0&&_0x2568ef!==0x0){const _0x59fa2f=_0x2568ef/_0x15d13c;_0x2076f1=Math[_0x46729d(0xf7)](_0x2076f1*_0x59fa2f);}if(_0x2076f1>0xf){if(_0x2076f1>0xf0)_0x2076f1=0xf0;_0x34204d[_0x46729d(0x1d1)]({'room':_0x32defd,'minutes_safe':_0x2076f1,'target':_0x264ace,'current':_0x402889,'savings_msg':_0x46729d(0x124)+_0x2076f1+_0x46729d(0x8f)});}}_0x34204d['sort']((_0x3ae900,_0x1e1ea7)=>_0x1e1ea7[_0x46729d(0x1c9)]-_0x3ae900[_0x46729d(0x1c9)]),this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':!![],'proposals':_0x34204d},_0x41189e[_0x46729d(0xfe)]);}catch(_0x6e38fc){this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e['command'],{'success':![],'error':_0x6e38fc[_0x46729d(0xd9)]},_0x41189e[_0x46729d(0xfe)]);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x185))try{await automation[_0x46729d(0xdc)](this),this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':!![]},_0x41189e[_0x46729d(0xfe)]);}catch(_0x2ce62f){this[_0x46729d(0x127)](_0x41189e['from'],_0x41189e['command'],{'success':![],'error':_0x2ce62f[_0x46729d(0xd9)]},_0x41189e[_0x46729d(0xfe)]);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x15c))try{const _0x524bcb=_0x41189e[_0x46729d(0xd9)]['key'],_0x2f1995=_0x46729d(0xf8),_0x94b843=await this['getStateAsync'](_0x2f1995);let _0x51116e={};if(_0x94b843&&_0x94b843[_0x46729d(0x1b1)])try{_0x51116e=JSON[_0x46729d(0x175)](_0x94b843[_0x46729d(0x1b1)]);}catch(_0x349d9f){}_0x524bcb&&_0x51116e[_0x524bcb]?(delete _0x51116e[_0x524bcb],await this['setStateAsync'](_0x2f1995,{'val':JSON[_0x46729d(0x15a)](_0x51116e),'ack':!![]}),this['log'][_0x46729d(0xf3)](_0x46729d(0x156)+_0x524bcb+'\x27\x20wurde\x20manuell\x20vom\x20Benutzer\x20gelÃ¶scht.'),this['sendTo'](_0x41189e[_0x46729d(0x16f)],_0x41189e['command'],{'success':!![]},_0x41189e[_0x46729d(0xfe)])):this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e['command'],{'success':![],'error':_0x46729d(0x10c)},_0x41189e[_0x46729d(0xfe)]);}catch(_0x40c7e9){this['sendTo'](_0x41189e['from'],_0x41189e['command'],{'success':![],'error':_0x40c7e9[_0x46729d(0xd9)]},_0x41189e['callback']);}else{if(_0x41189e['command']==='dismissAutomation')await this[_0x46729d(0x1a8)](_0x46729d(0x1b9),{'val':![],'ack':!![]}),await this[_0x46729d(0x1a8)](_0x46729d(0x171),{'val':'','ack':!![]}),await this['setStateAsync'](_0x46729d(0x10a),{'val':'','ack':!![]}),this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':!![]},_0x41189e[_0x46729d(0xfe)]);else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x121)){const {targetId:_0x3b4912,targetValue:_0x20fda8}=_0x41189e[_0x46729d(0xd9)];await this[_0x46729d(0x1a8)](_0x46729d(0x1b9),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x46729d(0x171),{'val':'Simulation\x20durch\x20Admin\x20(Test)','ack':!![]}),await this[_0x46729d(0x1a8)](_0x46729d(0x10a),{'val':_0x3b4912,'ack':!![]}),await this[_0x46729d(0x1a8)](_0x46729d(0xb4),{'val':String(_0x20fda8),'ack':!![]}),this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':!![]},_0x41189e[_0x46729d(0xfe)]);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x99))try{const _0x29042c=_0x41189e[_0x46729d(0xd9)]['apiKey'];if(!_0x29042c)throw new Error('Kein\x20API\x20Key\x20Ã¼bergeben');const _0xc73828=new GoogleGenerativeAI(_0x29042c),_0x2f51a1=_0xc73828[_0x46729d(0x174)]({'model':GEMINI_MODEL}),_0x3d8762=await _0x2f51a1[_0x46729d(0xcd)]('Test'),_0x382bf6=await _0x3d8762[_0x46729d(0x94)];if(_0x382bf6[_0x46729d(0x132)]())this[_0x46729d(0x127)](_0x41189e['from'],_0x41189e[_0x46729d(0x100)],{'success':!![],'message':_0x46729d(0x13f)},_0x41189e[_0x46729d(0xfe)]);else throw new Error('Keine\x20Antwort\x20von\x20Gemini');}catch(_0x4e214f){this[_0x46729d(0x127)](_0x41189e['from'],_0x41189e[_0x46729d(0x100)],{'success':![],'message':_0x4e214f[_0x46729d(0xd9)]},_0x41189e[_0x46729d(0xfe)]);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x1b7))try{const _0x41eb59=await scanner[_0x46729d(0x17c)](this,_0x41189e['message']||{});this['sendTo'](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':!![],'devices':_0x41eb59},_0x41189e[_0x46729d(0xfe)]);}catch(_0x540c52){this['sendTo'](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':![],'error':_0x540c52[_0x46729d(0xd9)]},_0x41189e[_0x46729d(0xfe)]);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x140))try{const {matrix:_0x2afd62}=_0x41189e[_0x46729d(0xd9)],_0x4824b5=await this[_0x46729d(0xe7)](_0x46729d(0x1cd));if(_0x4824b5&&_0x4824b5[_0x46729d(0x1b1)]){const _0x262e1f=JSON['parse'](_0x4824b5[_0x46729d(0x1b1)]);_0x262e1f[_0x46729d(0x13c)]=_0x2afd62,_0x262e1f[_0x46729d(0xd6)]=Date[_0x46729d(0x1d3)](),await this[_0x46729d(0x1a8)](_0x46729d(0x1cd),{'val':JSON[_0x46729d(0x15a)](_0x262e1f),'ack':!![]}),pythonBridge[_0x46729d(0xb6)](this,_0x46729d(0x1a5),_0x262e1f);}this['sendTo'](_0x41189e['from'],_0x41189e[_0x46729d(0x100)],{'success':!![]},_0x41189e['callback']);}catch(_0x352d8a){this[_0x46729d(0x1a7)][_0x46729d(0x1af)](_0x352d8a);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x107))this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':!![],'dailyDigests':this['dailyDigests']||[],'analysisHistory':this[_0x46729d(0x105)]||[]},_0x41189e[_0x46729d(0xfe)]);else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0xc0)){const _0x426e06=this['dailyDigests'][_0x46729d(0x88)];let _0x3a4ca1=new Array(0x18)[_0x46729d(0xee)](0x0);try{const _0x4c89d9=await this[_0x46729d(0xe7)](_0x46729d(0x87));if(_0x4c89d9&&_0x4c89d9[_0x46729d(0x1b1)])_0x3a4ca1=JSON[_0x46729d(0x175)](_0x4c89d9['val']);else{const _0x14e953=new Date()[_0x46729d(0x115)](0x0,0x0,0x0,0x0);this[_0x46729d(0x134)]&&this[_0x46729d(0x134)]['forEach'](_0x1497c7=>{const _0x537599=_0x46729d;if(_0x1497c7[_0x537599(0xb7)]>=_0x14e953){const _0x33899d=new Date(_0x1497c7['timestamp'])['getHours']();if(_0x33899d>=0x0&&_0x33899d<0x18)_0x3a4ca1[_0x33899d]++;}});}}catch(_0x3e8af6){this[_0x46729d(0x1a7)][_0x46729d(0xf5)]('Could\x20not\x20read\x20daily\x20vector:\x20'+_0x3e8af6[_0x46729d(0xd9)]);}let _0x48b4a0=![],_0x26511b='',_0x1e27ff='',_0x437926='';try{const _0x2c9336=await this[_0x46729d(0xe7)](_0x46729d(0x1b9));if(_0x2c9336&&_0x2c9336['val']){_0x48b4a0=!![];const _0x4dcf8f=await this[_0x46729d(0xe7)](_0x46729d(0x171));_0x26511b=_0x4dcf8f?_0x4dcf8f[_0x46729d(0x1b1)]:'';const _0x15f470=await this[_0x46729d(0xe7)](_0x46729d(0x10a));_0x1e27ff=_0x15f470?_0x15f470[_0x46729d(0x1b1)]:'';const _0x3d3fed=await this[_0x46729d(0xe7)](_0x46729d(0xb4));_0x437926=_0x3d3fed?_0x3d3fed['val']:'';}}catch(_0x2248f9){}const _0x1940bd=await this[_0x46729d(0xd0)](),_0x520ace=(this[_0x46729d(0x155)][_0x46729d(0xdf)]||[])[_0x46729d(0x160)](_0x580310=>_0x580310[_0x46729d(0xbb)]),_0x1918fd=_0x1940bd&&_0x520ace;let _0x4c165c='';try{const _0xbe8cdc=await this[_0x46729d(0xe7)](_0x46729d(0x12d));if(_0xbe8cdc&&_0xbe8cdc['val'])_0x4c165c=_0xbe8cdc[_0x46729d(0x1b1)];}catch(_0x298bcd){}this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':!![],'eventHistory':this[_0x46729d(0x134)][_0x46729d(0xb0)](0x0,0x64),'stats':{'digestCount':_0x426e06,'isPresent':this[_0x46729d(0x153)],'hourlyActivity':_0x3a4ca1,'solarActive':_0x1918fd,'presenceWho':_0x4c165c},'automation':{'detected':_0x48b4a0,'description':_0x26511b,'targetId':_0x1e27ff,'targetValue':_0x437926}},_0x41189e[_0x46729d(0xfe)]);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x1c5)){const _0x9e1c71=await this[_0x46729d(0xa3)](_0x46729d(0x136),_0x46729d(0x1b6)),_0x44d44e=[];if(_0x9e1c71)for(const _0x30a867 in _0x9e1c71){const _0x47b50a=_0x9e1c71[_0x30a867],_0x2405c7=(_0x47b50a[_0x46729d(0x1aa)]&&typeof _0x47b50a['common']['name']==='object'?_0x47b50a[_0x46729d(0x1aa)][_0x46729d(0xcb)]['de']:_0x47b50a[_0x46729d(0x1aa)][_0x46729d(0xcb)])||_0x47b50a[_0x46729d(0x1aa)][_0x46729d(0xcb)];_0x44d44e['push']({'id':_0x30a867,'name':_0x2405c7});}const _0x4305d5=await this['getForeignObjectsAsync'](_0x46729d(0x143),_0x46729d(0x1b6)),_0x346a32=[];if(_0x4305d5)for(const _0x4ade69 in _0x4305d5){const _0x9a0e75=_0x4305d5[_0x4ade69],_0x295923=(_0x9a0e75['common']&&typeof _0x9a0e75[_0x46729d(0x1aa)][_0x46729d(0xcb)]===_0x46729d(0x1bc)?_0x9a0e75['common'][_0x46729d(0xcb)]['de']:_0x9a0e75['common']['name'])||_0x4ade69[_0x46729d(0x1a0)]('.')[_0x46729d(0xe5)]();_0x346a32[_0x46729d(0x1d1)](_0x295923);}this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':!![],'enums':_0x44d44e,'rooms':_0x346a32},_0x41189e['callback']);}else{if(_0x41189e['command']===_0x46729d(0x84))try{let _0x510803=_0x46729d(0x14c),_0x43307b=_0x46729d(0x108);if(this[_0x46729d(0x155)][_0x46729d(0x173)]){const _0x2b3d58=await recorder[_0x46729d(0x9b)](this);_0x510803=_0x2b3d58!==null?_0x2b3d58+'Â°C':_0x46729d(0x130);}if(this[_0x46729d(0x155)][_0x46729d(0xd8)]){const _0x49880d=await this[_0x46729d(0x1a4)](_0x46729d(0xd5)+this[_0x46729d(0x155)][_0x46729d(0xd8)]);_0x43307b=_0x49880d?_0x46729d(0x19f):_0x46729d(0xae);}this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e['command'],{'success':!![],'weather':_0x510803,'calendar':_0x43307b},_0x41189e[_0x46729d(0xfe)]);}catch(_0x300de9){this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e[_0x46729d(0x100)],{'success':![],'error':_0x300de9[_0x46729d(0xd9)]},_0x41189e[_0x46729d(0xfe)]);}else{if(_0x41189e[_0x46729d(0x100)]===_0x46729d(0x16b))try{const _0x591ebf=_0x41189e['message']['instance'],_0x9faaeb=await this[_0x46729d(0x144)](_0x591ebf+_0x46729d(0x150));let _0x72f83e=[];if(_0x9faaeb&&_0x9faaeb['val']){const _0x44bb9c=JSON[_0x46729d(0x175)](_0x9faaeb[_0x46729d(0x1b1)]),_0x197bef=new Set();Array[_0x46729d(0x133)](_0x44bb9c)&&_0x44bb9c[_0x46729d(0x17d)](_0x4754ca=>{const _0x3c1680=_0x46729d;if(_0x4754ca[_0x3c1680(0xac)])_0x197bef[_0x3c1680(0xe3)](_0x4754ca[_0x3c1680(0xac)]);else{if(_0x4754ca[_0x3c1680(0x176)])_0x197bef[_0x3c1680(0xe3)](_0x4754ca['calendarName']);}}),_0x72f83e=Array[_0x46729d(0x16f)](_0x197bef)[_0x46729d(0x120)]();}if(_0x72f83e[_0x46729d(0x88)]===0x0)_0x72f83e=[_0x46729d(0x11c)];this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e['command'],{'success':!![],'names':_0x72f83e},_0x41189e[_0x46729d(0xfe)]);}catch(_0xded13b){this['sendTo'](_0x41189e['from'],_0x41189e[_0x46729d(0x100)],{'success':![],'error':_0xded13b[_0x46729d(0xd9)]},_0x41189e[_0x46729d(0xfe)]);}else{if(_0x41189e[_0x46729d(0x100)]==='testNotification')try{await setup[_0x46729d(0x9d)](this,_0x46729d(0xea),![],![]),this[_0x46729d(0x127)](_0x41189e[_0x46729d(0x16f)],_0x41189e['command'],{'success':!![],'message':_0x46729d(0xf1)},_0x41189e[_0x46729d(0xfe)]);}catch(_0x166766){this[_0x46729d(0x1a7)][_0x46729d(0x1af)](_0x46729d(0x138)+_0x166766[_0x46729d(0xd9)]),this[_0x46729d(0x127)](_0x41189e['from'],_0x41189e['command'],{'success':![],'message':_0x46729d(0x199)+_0x166766[_0x46729d(0xd9)]},_0x41189e[_0x46729d(0xfe)]);}}}}}}}}}}}}}}}}}async['loadSystemMode'](){const _0x2d91cf=a0_0x1e359a;try{const _0x3573bf=await this['getStateAsync'](setup[_0x2d91cf(0x10e)]);_0x3573bf&&_0x3573bf[_0x2d91cf(0x1b1)]&&Object[_0x2d91cf(0x16c)](setup[_0x2d91cf(0x1bb)])[_0x2d91cf(0x169)](_0x3573bf[_0x2d91cf(0x1b1)])?this[_0x2d91cf(0x11a)]=_0x3573bf[_0x2d91cf(0x1b1)]:(this[_0x2d91cf(0x11a)]=setup[_0x2d91cf(0x1bb)]['NORMAL'],await this[_0x2d91cf(0x1a8)](setup[_0x2d91cf(0x10e)],{'val':setup[_0x2d91cf(0x1bb)][_0x2d91cf(0x154)],'ack':!![]}));}catch(_0x31b1dd){this[_0x2d91cf(0x11a)]=setup[_0x2d91cf(0x1bb)][_0x2d91cf(0x154)];}}async[a0_0x1e359a(0x106)](){const _0x381833=a0_0x1e359a;try{const _0x2a19ee=this['config'][_0x381833(0xe4)]||[];let _0x6645d5=![];const _0x25f076=[];for(const _0x405f78 of _0x2a19ee){try{const _0x854384=await this[_0x381833(0x144)](_0x405f78);_0x854384&&(_0x854384[_0x381833(0x1b1)]===!![]||_0x854384[_0x381833(0x1b1)]===_0x381833(0x9f)||_0x854384[_0x381833(0x1b1)]===0x1)&&(_0x6645d5=!![],_0x25f076['push'](_0x405f78));}catch(_0x15ed64){}}return await this[_0x381833(0x1a8)]('system.presenceWho',{'val':_0x25f076[_0x381833(0x1b5)](',\x20'),'ack':!![]}),_0x6645d5&&(this[_0x381833(0x122)]&&(this['log'][_0x381833(0xf3)](_0x381833(0x10b)),recorder['abortExitTimer'](this)),!this[_0x381833(0x153)]&&this[_0x381833(0x11a)]===setup[_0x381833(0x1bb)]['NORMAL']&&await recorder[_0x381833(0x197)](this,!![])),_0x6645d5;}catch(_0x3cd875){return![];}}async[a0_0x1e359a(0xc1)](){const _0x3962e1=a0_0x1e359a;this[_0x3962e1(0x1a7)]['debug'](_0x3962e1(0xa6)),await aiAgent[_0x3962e1(0x8a)](this),this[_0x3962e1(0xd3)](),this['triggerGaitAnalysis'](),this[_0x3962e1(0x12f)]();}async[a0_0x1e359a(0xd0)](){const _0x152494=a0_0x1e359a,_0x13ca35=[_0x152494(0x14b),_0x152494(0xc7),_0x152494(0x18b)],_0x34919d=['forecast.current.weather','Current.WeatherText','NextHours.Location_1.Day_1.current.symbol_desc'];for(const _0x1d516b of _0x13ca35){for(const _0x107feb of _0x34919d){try{const _0x340eec=_0x1d516b+'.'+_0x107feb,_0x525f40=await this[_0x152494(0x144)](_0x340eec);if(_0x525f40&&_0x525f40[_0x152494(0x1b1)]){const _0x2ac0f9=String(_0x525f40[_0x152494(0x1b1)])['toLowerCase']();if(_0x2ac0f9[_0x152494(0x169)](_0x152494(0x181))||_0x2ac0f9['includes'](_0x152494(0xf2))||_0x2ac0f9[_0x152494(0x169)]('klar')||_0x2ac0f9['includes'](_0x152494(0x1ab))||_0x2ac0f9[_0x152494(0x169)](_0x152494(0x98)))return!![];}}catch(_0x514cc2){}}}return![];}['triggerGaitAnalysis'](){const _0x367dc7=a0_0x1e359a;if(!this['isProVersion'])return;try{this[_0x367dc7(0x18d)](_0x367dc7(0x9e),(_0x3f0d5b,_0x4356a3)=>{const _0x4b7b34=_0x367dc7;_0x4356a3&&_0x4356a3['val']&&pythonBridge[_0x4b7b34(0xb6)](this,'ANALYZE_GAIT',{'sequences':JSON[_0x4b7b34(0x175)](_0x4356a3['val'])});});}catch(_0x123bbe){}}async['triggerEnergyPrediction'](){const _0x319fdd=a0_0x1e359a;if(!this[_0x319fdd(0xcf)])return;try{const _0x50f4fd=await recorder[_0x319fdd(0x9b)](this);if(_0x50f4fd===null)return;const _0x57ba7a={},_0x1a620f={},_0x19740d=this[_0x319fdd(0x155)][_0x319fdd(0xdf)]||[];for(const _0x4fd836 of _0x19740d){if(_0x4fd836[_0x319fdd(0x159)]===_0x319fdd(0xdd)&&_0x4fd836[_0x319fdd(0xdb)]){const _0x48d5bb=this['sensorLastValues'][_0x4fd836['id']];if(_0x48d5bb!==undefined)_0x57ba7a[_0x4fd836[_0x319fdd(0xdb)]]=_0x48d5bb;if(_0x4fd836[_0x319fdd(0xbb)])_0x1a620f[_0x4fd836['location']]=!![];}}const _0x5a8cd7=await this[_0x319fdd(0xd0)]();let _0x5be244={};try{const _0x3e1f92=await this[_0x319fdd(0xe7)](_0x319fdd(0x1ba));if(_0x3e1f92&&_0x3e1f92[_0x319fdd(0x1b1)])_0x5be244=JSON[_0x319fdd(0x175)](_0x3e1f92['val']);}catch(_0x3e3cbe){}Object[_0x319fdd(0xd7)](_0x57ba7a)[_0x319fdd(0x88)]>0x0&&(pythonBridge[_0x319fdd(0xb6)](this,_0x319fdd(0x19b),{'current_temps':_0x57ba7a,'t_out':_0x50f4fd,'is_sunny':_0x5a8cd7,'solar_flags':_0x1a620f,'warmup_targets':_0x5be244}),pythonBridge['send'](this,'OPTIMIZE_ENERGY',{'current_temps':_0x57ba7a,'t_out':_0x50f4fd,'targets':{}}));}catch(_0x57c933){}}[a0_0x1e359a(0xd3)](){const _0x44ca78=a0_0x1e359a;if(!this[_0x44ca78(0x109)]||this[_0x44ca78(0x109)]['length']===0x0)return;const _0x1e2b3c=new Array(0x60)[_0x44ca78(0xee)](0x0),_0x2b4503=new Date()['setHours'](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x44ca78(0x17d)](_0xff8eee=>{const _0x53b4e7=_0x44ca78,_0x56327b=new Date(_0xff8eee[_0x53b4e7(0xb7)]);if(_0x56327b[_0x53b4e7(0x17a)]()>=_0x2b4503){const _0x159f6c=_0x56327b['getHours'](),_0x47148f=_0x56327b[_0x53b4e7(0x11b)](),_0x30241b=_0x159f6c*0x4+Math[_0x53b4e7(0xf7)](_0x47148f/0xf);if(_0x30241b>=0x0&&_0x30241b<0x60)_0x1e2b3c[_0x30241b]++;}});}[a0_0x1e359a(0xfc)](){const _0x496287=a0_0x1e359a;if(!this[_0x496287(0xb8)]||this[_0x496287(0xb8)][_0x496287(0x88)]<0x2)return;const _0x1d6a46=this['dailyDigests'][_0x496287(0x1b2)](_0x2024e9=>{const _0x4c5404=_0x496287,_0x48f7b3=(_0x2024e9[_0x4c5404(0x1cb)]||'')[_0x4c5404(0x190)]();return ACTIVITY_LEVEL_MAP[_0x48f7b3]||0x32;});pythonBridge[_0x496287(0xb6)](this,'ANALYZE_TREND',{'values':_0x1d6a46,'tag':'Activity-Level'});}async[a0_0x1e359a(0x10f)](_0x3d53ac){const _0x5ccda4=a0_0x1e359a;if(_0x3d53ac==null||typeof _0x3d53ac!==_0x5ccda4(0xa7))return;const _0x403164=Date[_0x5ccda4(0x1d3)]();this['pressureBuffer'][_0x5ccda4(0x1d1)]({'ts':_0x403164,'val':_0x3d53ac}),this[_0x5ccda4(0x96)]=this[_0x5ccda4(0x96)][_0x5ccda4(0x17f)](_0x3b07b0=>_0x403164-_0x3b07b0['ts']<0x1388);if(this[_0x5ccda4(0xc9)])return;if(this['config']['infrasoundArmingId']){const _0x55a863=await this[_0x5ccda4(0x144)](this['config'][_0x5ccda4(0xb2)]);if(_0x55a863&&!_0x55a863[_0x5ccda4(0x1b1)])return;}const _0x2cc173=this['config']['infrasoundThreshold']||0.04;if(Math['abs'](_0x3d53ac)>=_0x2cc173){this[_0x5ccda4(0x1a7)][_0x5ccda4(0xf5)]('[Infrasound]\x20ðŸš¨\x20ALARM\x20TRIGGERED!\x20Pressure\x20Wave:\x20'+_0x3d53ac+'\x20hPa\x20(Limit:\x20'+_0x2cc173+')'),await this['setStateAsync']('security.alarm_triggered',{'val':!![],'ack':!![]});const _0xf2dd08=this[_0x5ccda4(0x153)];_0xf2dd08?(this[_0x5ccda4(0x1a7)][_0x5ccda4(0xf3)](_0x5ccda4(0x17b)),this[_0x5ccda4(0xc3)](_0x3d53ac,'INTERNAL')):(this[_0x5ccda4(0xc3)](_0x3d53ac,_0x5ccda4(0xda)),this[_0x5ccda4(0x9d)]('ðŸš¨\x20DRUCKWELLEN-ALARM!\x20StÃ¤rke:\x20'+_0x3d53ac+'\x20hPa.\x20Einbruch\x20wahrscheinlich.')),this['infrasoundLocked']=!![],setTimeout(()=>{const _0x170e67=_0x5ccda4;this[_0x170e67(0xc9)]=![];},0x2710);}}async[a0_0x1e359a(0xc3)](_0x259233,_0x49559a=a0_0x1e359a(0xda)){const _0x4da10a=a0_0x1e359a,_0x53b69e=Date[_0x4da10a(0x1d3)](),_0xeccca9=this[_0x4da10a(0x155)][_0x4da10a(0xdf)]||[];setTimeout(async()=>{const _0x2708fa=_0x4da10a;let _0x16cc90=null,_0x423b7a=_0x2708fa(0x1ad);const _0x765e32=_0xeccca9[_0x2708fa(0x17f)](_0x2eaa5e=>_0x2eaa5e['type']&&(_0x2eaa5e[_0x2708fa(0x159)][_0x2708fa(0x169)](_0x2708fa(0x180))||_0x2eaa5e[_0x2708fa(0x159)][_0x2708fa(0x169)]('door')||_0x2eaa5e[_0x2708fa(0x159)][_0x2708fa(0x169)]('magnet')||_0x2eaa5e[_0x2708fa(0x159)][_0x2708fa(0x169)]('reed'))||_0x2eaa5e[_0x2708fa(0x11f)]&&(_0x2eaa5e[_0x2708fa(0x11f)][_0x2708fa(0x169)]('sensor.window')||_0x2eaa5e[_0x2708fa(0x11f)][_0x2708fa(0x169)](_0x2708fa(0x187))));for(const _0x5bdd12 of _0x765e32){try{const _0x4e2919=await this['getForeignStateAsync'](_0x5bdd12['id']);if(_0x4e2919){if(_0x4e2919['ts']>=_0x53b69e-0x7d0){_0x16cc90=_0x5bdd12[_0x2708fa(0xcb)]||_0x5bdd12['id'],_0x423b7a=_0x2708fa(0x16e)+_0x16cc90;break;}}}catch(_0x190b46){}}const _0x1dd2cd={'timestamp':_0x53b69e,'pressure':_0x259233,'isMatch':!!_0x16cc90,'explanation':_0x423b7a,'type':_0x49559a};await this['appendToLog'](_0x1dd2cd),this[_0x2708fa(0x1a7)]['info']('[Forensics]\x20Infrasound\x20Event\x20correlated:\x20'+(!!_0x16cc90?_0x2708fa(0x8b):_0x2708fa(0x163)));},0x1388);}async[a0_0x1e359a(0xaf)](_0x4f499c){const _0x3870a1=a0_0x1e359a,_0x1cc872=Date[_0x3870a1(0x1d3)](),_0x5d92d3=_0x4f499c[_0x3870a1(0xcb)]||_0x4f499c['id'][_0x3870a1(0x1a0)]('.')[_0x3870a1(0xe5)]();let _0xbd5c8b=0x0;setTimeout(async()=>{const _0x1d6e29=_0x3870a1;this[_0x1d6e29(0x96)][_0x1d6e29(0x17d)](_0x3e2070=>{const _0x313de0=_0x1d6e29;_0x3e2070['ts']>=_0x1cc872-0xfa0&&_0x3e2070['ts']<=_0x1cc872+0x3e8&&(Math['abs'](_0x3e2070[_0x313de0(0x1b1)])>Math[_0x313de0(0x142)](_0xbd5c8b)&&(_0xbd5c8b=_0x3e2070[_0x313de0(0x1b1)]));});const _0x187a7f=this['config'][_0x1d6e29(0x119)]||0.04,_0x2bdd25=Math[_0x1d6e29(0x142)](_0xbd5c8b)>=_0x187a7f,_0x5a2a4f={'timestamp':_0x1cc872,'pressure':_0xbd5c8b,'isMatch':_0x2bdd25,'explanation':_0x1d6e29(0x1ae)+_0x5d92d3,'type':_0x1d6e29(0x18e)};await this['appendToLog'](_0x5a2a4f),this[_0x1d6e29(0x1a7)]['debug']('[Calibration]\x20Window\x20'+_0x5d92d3+_0x1d6e29(0x118)+_0xbd5c8b[_0x1d6e29(0x125)](0x4)+_0x1d6e29(0xc6)+_0x187a7f+')');},0x1f4);}async['appendToLog'](_0x275452){const _0x3d8d12=a0_0x1e359a;try{const _0xb87ab8=await this[_0x3d8d12(0xe7)](_0x3d8d12(0x147));let _0x5c03f3=[];if(_0xb87ab8&&_0xb87ab8[_0x3d8d12(0x1b1)])_0x5c03f3=JSON[_0x3d8d12(0x175)](_0xb87ab8[_0x3d8d12(0x1b1)]);_0x5c03f3[_0x3d8d12(0x111)](_0x275452);if(_0x5c03f3[_0x3d8d12(0x88)]>0x14)_0x5c03f3=_0x5c03f3[_0x3d8d12(0xb0)](0x0,0x14);await this[_0x3d8d12(0x1a8)]('analysis.security.infrasoundLog',{'val':JSON[_0x3d8d12(0x15a)](_0x5c03f3),'ack':!![]});}catch(_0x4dbd1c){this['log'][_0x3d8d12(0x1af)](_0x3d8d12(0x13a)+_0x4dbd1c[_0x3d8d12(0xd9)]);}}[a0_0x1e359a(0x9d)](_0x32d551){const _0x2a892a=a0_0x1e359a;this[_0x2a892a(0x155)][_0x2a892a(0x1c8)]&&this[_0x2a892a(0x155)][_0x2a892a(0xfd)]&&this[_0x2a892a(0x127)](this[_0x2a892a(0x155)][_0x2a892a(0xfd)],_0x2a892a(0xb6),{'message':_0x32d551,'title':_0x2a892a(0x12c),'priority':0x1}),this[_0x2a892a(0x155)][_0x2a892a(0xa8)]&&this[_0x2a892a(0x155)][_0x2a892a(0x16a)]&&this[_0x2a892a(0x127)](this[_0x2a892a(0x155)][_0x2a892a(0x16a)],_0x2a892a(0xb6),{'text':_0x32d551});}}if(require['main']!==module)module['exports']=_0x586778=>new CogniLiving(_0x586778);else new CogniLiving();