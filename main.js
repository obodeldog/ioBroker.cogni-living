function a0_0x3676(_0x132702,_0x1b96fd){const _0x482641=a0_0x27b8();return a0_0x3676=function(_0x42180e,_0x45cc91){_0x42180e=_0x42180e-0x98;let _0x27b89c=_0x482641[_0x42180e];return _0x27b89c;},a0_0x3676(_0x132702,_0x1b96fd);}const a0_0x1c9c37=a0_0x3676;(function(_0x126e9e,_0x5291ab){const _0x581f33=a0_0x3676,_0x256210=_0x126e9e();while(!![]){try{const _0xc81dde=-parseInt(_0x581f33(0x137))/0x1*(-parseInt(_0x581f33(0x1c7))/0x2)+-parseInt(_0x581f33(0xd1))/0x3+-parseInt(_0x581f33(0x1bc))/0x4*(-parseInt(_0x581f33(0xe5))/0x5)+parseInt(_0x581f33(0x154))/0x6+-parseInt(_0x581f33(0xaa))/0x7*(parseInt(_0x581f33(0x110))/0x8)+parseInt(_0x581f33(0x164))/0x9*(-parseInt(_0x581f33(0x147))/0xa)+parseInt(_0x581f33(0xfa))/0xb*(parseInt(_0x581f33(0xa8))/0xc);if(_0xc81dde===_0x5291ab)break;else _0x256210['push'](_0x256210['shift']());}catch(_0x5d3d0c){_0x256210['push'](_0x256210['shift']());}}}(a0_0x27b8,0xc0e74));function a0_0x27b8(){const _0x57f214=['outdoorSensorId','startSystem','isSolar','security','fill','system.adapter.ical.','SET_LEARNING_MODE','analysis.training.triggerTopology','includes','value','{\x22history\x22:{}}','system','dependencyInstallInProgress','forEach','initZombies','3626465KpZygw','./lib/automation','analysis.automation.targetValue','Party\x20Mode','refreshCalendar','exitTimer','TRAIN_COMFORT','cleanupGhostInterventions','analysis.training.triggerEnergy','runGeminiAnalysis','object','unload','Keine\x20Daten','sensorLastValues','namespace','Say\x20Hello','triggerBriefing','TRAIN_HEALTH','isProVersion','modeResetJob','ltmJob','99zCvINW','Kein\x20API\x20Key\x20√ºbergeben.','./lib/installer','getCalendarNames','scanDevices','subscribeForeignStates','name','memoryCache','./lib/scheduler','warn','isGracePeriodActive','moduleEnergy','Room\x20History\x20(24h\x20Buckets)','NIGHT','Warte\x20auf\x20Analyse...','location','handleInfrasound','ack','moduleHealth','triggerEnergyPrediction\x20Error:\x20','analysis.training.triggerSecurity','some','5392VYOayq','all','updateHealthVector','checkThermostats','getHistoryData','stringify','analysis.energy.warmupTargets','analysisTimer','getStateAsync','getAbsoluteDefaultDataDir','getHours','send','getEnums','system.adapter.','inactivityThresholdHours','analysis.health.todayVector','@iobroker/adapter-core','enum.functions.*','analysis.automation.description','main','.data.table','json','values','getForeignObjectsAsync','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','checkSolarCondition','analysisHistory','devices','isRelevantActivity','readFileSync','models/gemini-flash-latest','refreshCalendar\x20failed:\x20','roomIntegratorTimer','historyJob','lastAlertState','rows','analysis.energy.warmupSources','message','TRAIN_TOPOLOGY','2wDDfXj','party','analysis.health.geminiDay','ready','activeModules','apiKey','appendToLog','Gemini\x20Report\x20Day','\x20Tage)','node-schedule','genAI','open','weatherTempId','analysis.security.learningStatus',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','minDaysForBaseline','10EsVQYC','./lib/python_bridge','triggerEnergyPrediction','updateTopology','type','debug','createAllObjects','toISOString','error','terrasse','slice','...','analysis.training.triggerHealth','4694922LYVzSx','min','onReady','isPresent','SYSTEM_DP_MODE','getObjectViewAsync','setDate','isArray','now','getMinutes','max','rawEventLog','substring','exports','createDailyDigest','scanForDevices','5063076WdHJfV','info','Gemini\x20Report\x20Night','bind','Room\x20Dwell\x20Time\x20Stats','analysis.prediction.trackerTopRoom','text','analysis.activity.roomStats','Sec-Training\x20started...','SYSTEM_MODES','initHistory','replace','modules','keys','Daily\x20Activity\x20Vector\x20(48x30min)','analysis.training.triggerComfort','sources','No\x20data','Gemini\x20Init\x20Error:\x20','bootTime','licenseKey','moduleComfort','dailyDigests','string','replayTodayEvents','Daily\x20Room\x20Details\x20(48x30min)','infrasoundSensorId','briefingJob','thermostat','analysis.health.activityTrend','\x20events\x20from\x20standard\x20storage.','getOverviewData','automation.triggerAction','geminiApiKey','./lib/topology','Guest\x20Mode','sendTo','todayVector','executeAutomationAction','triggerInfrasoundCorrelation','energy','geminiModel','analysis.security.lastScore','add','updateLocation','TRAIN_SECURITY','endsWith','onMessage','val','python','onStateChange','infrasoundEnabled','response','‚Ü∫\x20Replaying\x20','apply','split','health','setObjectNotExistsAsync','trackerHeartbeat','history','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','application/json','push','analysis.trigger','analysis.visualization.pulse','checkWifiPresence','Corrupt','communicate.request','testContext','getForeignStateAsync','initSchedules','sendMorningBriefing','üì¶\x20Restored\x20','LTM.dailyDigests','pop','LTM.baselineStatus','59\x2023\x20*\x20*\x20*','config','triggerDailyDigest','existsSync','instance','setPresence','analysis.activity.roomHistory','eventHistory','./lib/scanner','stopService','triggerGaitAnalysis','checkLicense','4HejxOT','writeFileSync','moduleSecurity','analysis.energy.warmupTimes','currentSystemMode','\x20rooms)','presenceDevices','enum.rooms.*','number','toLocaleDateString','analysis.health.geminiNight','227890VtKrct','system.adapter.ical.È¶ô','testApiKey','analysis.automation.targetId','LTM.trainingData.sequences','setHours','haust√ºr','cogni-living','enum','protectAiMemory','date','temperature','events.history','.system.mode','infrasoundLocked','analysis.automation.patternDetected','driftAnalysisTimer','toLowerCase','healthTrendInterval','Lernphase\x20(','cancel','utf8','.json','runAutopilot','Verbindung\x20erfolgreich:\x20','initSystemConfig','join','callback','(((.+)+)+)+$','loadSystemMode','common','‚úÖ\x20History\x20saved:\x20','analysis.prediction.trackerConfidence','PREDICT_ENERGY','2850684MNGAuD',',\x20Temp:\x20','11578DVFXfW','bin','generateHealthReport','General\x20Activity\x20Trend','setStateAsync','length','DAY','CALCULATE_HEALTH_TREND','integrateRoomTime','onUnload','saveDailyHistory','subscribeForeignStatesAsync','from','VACATION','lastTrackerEventTime','processSensorEvent','parse','log','find','command','calendarName','motion','then','scanThermostats','setState','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','state','Unknown','subscribeStates','reduce','manual','runPythonHealthCheck','timestamp','version','search','LTM.rawEventLog','analyzeWindowOpening','NORMAL','4218573WcAqsJ','./lib/dead_man','heating','getGenerativeModel','analysis.health.todayRoomDetails'];a0_0x27b8=function(){return _0x57f214;};return a0_0x27b8();}const a0_0x45cc91=(function(){let _0x187d94=!![];return function(_0x283633,_0x45a2b9){const _0x39ac40=_0x187d94?function(){const _0x47d549=a0_0x3676;if(_0x45a2b9){const _0x4fddef=_0x45a2b9[_0x47d549(0x19a)](_0x283633,arguments);return _0x45a2b9=null,_0x4fddef;}}:function(){};return _0x187d94=![],_0x39ac40;};}()),a0_0x42180e=a0_0x45cc91(this,function(){const _0x5f170f=a0_0x3676;return a0_0x42180e['toString']()[_0x5f170f(0xcd)](_0x5f170f(0xa2))['toString']()['constructor'](a0_0x42180e)['search'](_0x5f170f(0xa2));});a0_0x42180e();'use strict';const utils=require(a0_0x1c9c37(0x120)),{GoogleGenerativeAI}=require('@google/generative-ai'),path=require('path'),fs=require('fs'),installer=require(a0_0x1c9c37(0xfc)),scanner=require(a0_0x1c9c37(0x1b8)),schedulers=require(a0_0x1c9c37(0x102)),topology=require(a0_0x1c9c37(0x186)),setup=require('./lib/setup'),recorder=require('./lib/recorder'),pythonBridge=require(a0_0x1c9c37(0x148)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x1c9c37(0xd2)),automation=require(a0_0x1c9c37(0xe6)),GEMINI_MODEL=a0_0x1c9c37(0x12e);class CogniLiving extends utils['Adapter']{constructor(_0x191173){const _0x324641=a0_0x1c9c37;super({..._0x191173,'name':_0x324641(0x1ce)}),this[_0x324641(0x1b7)]=[],this[_0x324641(0x12a)]=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x324641(0xf2)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x324641(0xea)]=null,this['exitGraceTimer']=null,this[_0x324641(0x104)]=![],this['genAI']=null,this[_0x324641(0x18d)]=null,this['currentSystemMode']=setup[_0x324641(0x16d)][_0x324641(0xd0)],this[_0x324641(0xf7)]=![],this[_0x324641(0x132)]=![],this[_0x324641(0x117)]=null,this[_0x324641(0xf9)]=null,this[_0x324641(0xf8)]=null,this[_0x324641(0x1d7)]=null,this[_0x324641(0x17f)]=null,this[_0x324641(0x131)]=null,this[_0x324641(0x19e)]=null,this[_0x324641(0x98)]=null,this[_0x324641(0x130)]=null,this['dependencyInstallInProgress']=![],this[_0x324641(0xb8)]=Date[_0x324641(0x15c)](),this['memoryCache']=null,this[_0x324641(0x177)]=Date[_0x324641(0x15c)](),this[_0x324641(0x1d5)]=![],this['pressureBuffer']=[],this[_0x324641(0x13b)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x324641(0x13a),this[_0x324641(0x156)]['bind'](this)),this['on']('stateChange',this[_0x324641(0x196)][_0x324641(0x167)](this)),this['on'](_0x324641(0xf0),this['onUnload'][_0x324641(0x167)](this)),this['on'](_0x324641(0x135),this[_0x324641(0x193)][_0x324641(0x167)](this));}async[a0_0x1c9c37(0x156)](){const _0x57204b=a0_0x1c9c37;this[_0x57204b(0xbb)][_0x57204b(0x165)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x57204b(0xcc)]+_0x57204b(0x145));if(this[_0x57204b(0x1b1)][_0x57204b(0x10c)]!==undefined)this[_0x57204b(0x13b)][_0x57204b(0x19c)]=this['config'][_0x57204b(0x10c)];if(this['config'][_0x57204b(0x1be)]!==undefined)this['activeModules']['security']=this[_0x57204b(0x1b1)][_0x57204b(0x1be)];if(this[_0x57204b(0x1b1)][_0x57204b(0x105)]!==undefined)this['activeModules'][_0x57204b(0x18c)]=this[_0x57204b(0x1b1)][_0x57204b(0x105)];if(this[_0x57204b(0x1b1)][_0x57204b(0x179)]!==undefined)this[_0x57204b(0x13b)]['comfort']=this['config']['moduleComfort'];if(this[_0x57204b(0x1b1)][_0x57204b(0x170)])this['activeModules']={...this[_0x57204b(0x13b)],...this['config'][_0x57204b(0x170)]};this[_0x57204b(0xd7)]();}async['startSystem'](){const _0x37a286=a0_0x1c9c37;await setup[_0x37a286(0xe4)](this);try{this[_0x37a286(0xf7)]=await setup[_0x37a286(0x1bb)](this['config'][_0x37a286(0x178)]);}catch(_0xbcd56b){}if(!this[_0x37a286(0x1b1)][_0x37a286(0x11e)]||this[_0x37a286(0x1b1)][_0x37a286(0x11e)]<0.1)this[_0x37a286(0x1b1)]['inactivityThresholdHours']=0xc;await setup[_0x37a286(0x16e)](this),await setup[_0x37a286(0x9f)](this);try{const _0x113eb1=await this[_0x37a286(0x118)](_0x37a286(0x1bf)),_0x5b541b=await this[_0x37a286(0x118)](_0x37a286(0x134));_0x113eb1&&_0x113eb1[_0x37a286(0x194)]&&_0x5b541b&&_0x5b541b[_0x37a286(0x194)]&&(Date[_0x37a286(0x15c)]()-_0x113eb1['ts']<0x4*0xe10*0x3e8&&(this[_0x37a286(0x101)]={'times':JSON[_0x37a286(0xba)](_0x113eb1[_0x37a286(0x194)]),'sources':JSON['parse'](_0x5b541b[_0x37a286(0x194)])}));}catch(_0x59b1e9){}if(this['config'][_0x37a286(0x185)])try{this[_0x37a286(0x141)]=new GoogleGenerativeAI(this['config'][_0x37a286(0x185)]),this[_0x37a286(0x18d)]=this[_0x37a286(0x141)][_0x37a286(0xd4)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x37a286(0x1a1)}});}catch(_0x5a03f8){this[_0x37a286(0xbb)][_0x37a286(0x14f)](_0x37a286(0x176)+_0x5a03f8[_0x37a286(0x135)]);}await setup[_0x37a286(0x14d)](this),await this['loadSystemMode'](),schedulers[_0x37a286(0x1aa)](this),await this[_0x37a286(0x19d)](_0x37a286(0x1a4),{'type':_0x37a286(0xc5),'common':{'name':'Live\x20Event\x20Pulse','type':_0x37a286(0x1c4),'role':'value','read':!![],'write':![]},'native':{}}),await this[_0x37a286(0x19d)](_0x37a286(0x16b),{'type':_0x37a286(0xc5),'common':{'name':_0x37a286(0x168),'type':_0x37a286(0x17b),'role':_0x37a286(0x125),'read':!![],'write':![],'def':'{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}'},'native':{}}),await this['setObjectNotExistsAsync'](_0x37a286(0x1b6),{'type':_0x37a286(0xc5),'common':{'name':_0x37a286(0x106),'type':_0x37a286(0x17b),'role':_0x37a286(0x125),'read':!![],'write':![],'def':_0x37a286(0xe0)},'native':{}}),await this[_0x37a286(0x19d)](_0x37a286(0x1c6),{'type':_0x37a286(0xc5),'common':{'name':_0x37a286(0x166),'type':_0x37a286(0x17b),'role':_0x37a286(0x16a),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x37a286(0x19d)]('analysis.health.geminiDay',{'type':_0x37a286(0xc5),'common':{'name':_0x37a286(0x13e),'type':'string','role':_0x37a286(0x16a),'read':!![],'write':![],'def':_0x37a286(0x108)},'native':{}}),await this[_0x37a286(0x19d)](_0x37a286(0x11f),{'type':'state','common':{'name':_0x37a286(0x172),'type':_0x37a286(0x17b),'role':_0x37a286(0x125),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x37a286(0x19d)](_0x37a286(0xd5),{'type':_0x37a286(0xc5),'common':{'name':_0x37a286(0x17d),'type':'string','role':_0x37a286(0x125),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x37a286(0x181),{'type':_0x37a286(0xc5),'common':{'name':_0x37a286(0xad),'type':_0x37a286(0x1c4),'role':_0x37a286(0xdf),'unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x37a286(0x1bf),{'type':'state','common':{'name':'Warm-Up\x20Time','type':'string','role':'json','read':!![],'write':![]},'native':{}});try{const _0x544053=await this['getStateAsync'](_0x37a286(0x1d3));if(_0x544053&&_0x544053[_0x37a286(0x194)]){this['eventHistory']=JSON['parse'](_0x544053[_0x37a286(0x194)]);if(this[_0x37a286(0xf7)]){const _0x2cab9d=await this[_0x37a286(0x118)]('LTM.rawEventLog');if(_0x2cab9d&&_0x2cab9d[_0x37a286(0x194)])this['rawEventLog']=JSON[_0x37a286(0xba)](_0x2cab9d['val']);}this['log']['info'](_0x37a286(0x1ac)+this[_0x37a286(0x1b7)][_0x37a286(0xaf)]+_0x37a286(0x182));}}catch(_0x53e83f){this[_0x37a286(0x1b7)]=[];}try{const _0x41aec6=await this[_0x37a286(0x118)](_0x37a286(0x1ad));if(_0x41aec6&&_0x41aec6['val'])this['dailyDigests']=JSON[_0x37a286(0xba)](_0x41aec6[_0x37a286(0x194)]);}catch(_0x3e7a5e){this['dailyDigests']=[];}const _0x569a5e=this[_0x37a286(0x17a)]['length']>=(this[_0x37a286(0x1b1)][_0x37a286(0x146)]||0x7)?'Aktiv\x20('+this[_0x37a286(0x17a)][_0x37a286(0xaf)]+_0x37a286(0x13f):_0x37a286(0x99)+this[_0x37a286(0x17a)][_0x37a286(0xaf)]+'/'+(this[_0x37a286(0x1b1)]['minDaysForBaseline']||0x7)+')';await this[_0x37a286(0xae)](_0x37a286(0x1af),{'val':_0x569a5e,'ack':!![]}),this['subscribeStates']('analysis.trigger'),this[_0x37a286(0xc7)]('LTM.triggerDailyDigest'),this[_0x37a286(0xc7)](_0x37a286(0x153));this[_0x37a286(0x1b1)][_0x37a286(0x197)]&&this[_0x37a286(0x1b1)][_0x37a286(0x17e)]&&this[_0x37a286(0x13b)][_0x37a286(0xd9)]&&this[_0x37a286(0xff)](this[_0x37a286(0x1b1)]['infrasoundSensorId']);const _0x440772=this[_0x37a286(0x1b1)][_0x37a286(0x12b)];if(_0x440772)for(const _0x2ca444 of _0x440772){await this[_0x37a286(0xb5)](_0x2ca444['id']);}const _0x34475f=this[_0x37a286(0x1b1)][_0x37a286(0x1c2)];if(_0x34475f)for(const _0x524697 of _0x34475f){await this[_0x37a286(0xb5)](_0x524697);}const _0x2eb1d4=require(_0x37a286(0x140));if(this[_0x37a286(0x131)])this[_0x37a286(0x131)]['cancel']();this['historyJob']=_0x2eb1d4['scheduleJob'](_0x37a286(0x1b0),()=>{this['saveDailyHistory']();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this[_0x37a286(0x130)])clearInterval(this[_0x37a286(0x130)]);this['integrateRoomTime'](),this[_0x37a286(0x130)]=setInterval(async()=>{const _0x183710=_0x37a286;await this[_0x183710(0xb2)]();},0x3c*0x3e8);if(this[_0x37a286(0x98)])clearInterval(this['healthTrendInterval']);this[_0x37a286(0x98)]=setInterval(()=>{const _0x287d91=_0x37a286;this[_0x287d91(0xf7)]&&this[_0x287d91(0x13b)][_0x287d91(0x19c)]&&this[_0x287d91(0xca)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x37a286(0x117)])clearInterval(this[_0x37a286(0x117)]);this['activeModules'][_0x37a286(0x18c)]&&(this['analysisTimer']=setInterval(()=>{const _0x289cd0=_0x37a286;this[_0x289cd0(0x149)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x37a286(0x149)](),0x2710));const _0x40b5a0=path[_0x37a286(0xa0)](__dirname,'.venv',_0x37a286(0xab),_0x37a286(0x195));pythonBridge['startService'](this,_0x40b5a0);}[a0_0x1c9c37(0xb3)](_0x3afd39){const _0x544c43=a0_0x1c9c37;if(this[_0x544c43(0x131)])this[_0x544c43(0x131)][_0x544c43(0x9a)]();this[_0x544c43(0xb4)]()[_0x544c43(0xc0)](()=>{const _0x4ac55d=_0x544c43;if(this[_0x4ac55d(0x117)])clearInterval(this[_0x4ac55d(0x117)]);if(this[_0x4ac55d(0x130)])clearInterval(this[_0x4ac55d(0x130)]);recorder['abortExitTimer'](this),pythonBridge[_0x4ac55d(0x1b9)](this),_0x3afd39();});}async[a0_0x1c9c37(0x17c)](){const _0x3341de=a0_0x1c9c37;if(!this[_0x3341de(0x1b7)]||this[_0x3341de(0x1b7)]['length']===0x0){this[_0x3341de(0xbb)]['warn'](_0x3341de(0x1a0));return;}this[_0x3341de(0xbb)][_0x3341de(0x165)](_0x3341de(0x199)+this['eventHistory'][_0x3341de(0xaf)]+'\x20events\x20from\x20today...');const _0x1aa291=new Date()[_0x3341de(0x1cc)](0x0,0x0,0x0,0x0),_0x15033f='analysis.activity.roomHistory';let _0x542694={'history':{},'date':new Date()[_0x3341de(0x1c5)]()};const _0x53207c='analysis.health.todayVector',_0x2d0806=_0x3341de(0xd5);let _0x47a8b7=new Array(0x30)['fill'](0x0),_0x4b26f0=Array[_0x3341de(0xb6)]({'length':0x30},()=>[]);this[_0x3341de(0x1b7)][_0x3341de(0xe3)](_0x490644=>{const _0x3adf5c=_0x3341de;if(_0x490644[_0x3adf5c(0xcb)]>=_0x1aa291){if(recorder[_0x3adf5c(0x12c)](_0x490644[_0x3adf5c(0x14b)],_0x490644['value'])){const _0x8181f8=new Date(_0x490644[_0x3adf5c(0xcb)]),_0x2fa097=_0x8181f8[_0x3adf5c(0x11a)]()*0x2+(_0x8181f8[_0x3adf5c(0x15d)]()>=0x1e?0x1:0x0);if(_0x2fa097<0x30){_0x47a8b7[_0x2fa097]++;const _0x505829=_0x490644[_0x3adf5c(0x109)]||_0x490644['name']||'?';let _0x38e76d=_0x4b26f0[_0x2fa097];!_0x38e76d[_0x3adf5c(0xde)](_0x505829)&&_0x38e76d[_0x3adf5c(0x1a2)](_0x505829);}const _0xeb79b6=_0x8181f8['getHours']();let _0x3d2349=_0x490644[_0x3adf5c(0x109)]||_0x3adf5c(0xc6);const _0xc0b008=(this['config'][_0x3adf5c(0x12b)]||[])[_0x3adf5c(0xbc)](_0x104046=>_0x104046[_0x3adf5c(0x109)]===_0x3d2349);if(_0xc0b008)_0x3d2349=_0xc0b008[_0x3adf5c(0x109)];if(!_0x542694[_0x3adf5c(0x19f)][_0x3d2349])_0x542694['history'][_0x3d2349]=new Array(0x18)[_0x3adf5c(0xda)](0x0);if(_0x542694[_0x3adf5c(0x19f)][_0x3d2349][_0xeb79b6]<0x3c)_0x542694[_0x3adf5c(0x19f)][_0x3d2349][_0xeb79b6]++;}}});const _0x125b02=await this[_0x3341de(0x118)](_0x15033f);(!_0x125b02||!_0x125b02[_0x3341de(0x194)]||_0x125b02['val']==='{}'||_0x125b02['val']['includes']('\x22history\x22:{}'))&&await this['setStateAsync'](_0x15033f,{'val':JSON[_0x3341de(0x115)](_0x542694),'ack':!![]}),await this['setStateAsync'](_0x53207c,{'val':JSON[_0x3341de(0x115)](_0x47a8b7),'ack':!![]}),await this['setStateAsync'](_0x2d0806,{'val':JSON[_0x3341de(0x115)](_0x4b26f0),'ack':!![]}),this[_0x3341de(0xbb)][_0x3341de(0x165)](_0x3341de(0xc4));}async['saveDailyHistory'](){const _0x3cb1c4=a0_0x1c9c37;if(!this[_0x3cb1c4(0x13b)][_0x3cb1c4(0x19c)])return;const _0x575c8c=new Date()[_0x3cb1c4(0x14e)]()[_0x3cb1c4(0x19b)]('T')[0x0];this[_0x3cb1c4(0xbb)][_0x3cb1c4(0x14c)]('üíæ\x20Saving\x20Daily\x20History\x20for\x20'+_0x575c8c+_0x3cb1c4(0x152));try{const [_0x3d80a4,_0x419ac8,_0x39a9d2,_0x40551d,_0x278133,_0x2afc35]=await Promise[_0x3cb1c4(0x111)]([this[_0x3cb1c4(0x118)](_0x3cb1c4(0x1b6)),this[_0x3cb1c4(0x118)]('analysis.health.geminiNight'),this[_0x3cb1c4(0x118)](_0x3cb1c4(0x139)),this[_0x3cb1c4(0x118)](_0x3cb1c4(0x18e)),this[_0x3cb1c4(0x118)](_0x3cb1c4(0x11f)),this[_0x3cb1c4(0x118)](_0x3cb1c4(0x181))]),_0x2c0452=this[_0x3cb1c4(0x1b7)]['filter'](_0x1f8523=>_0x1f8523[_0x3cb1c4(0xcb)]>=new Date()['setHours'](0x0,0x0,0x0,0x0)&&(_0x1f8523[_0x3cb1c4(0x100)][_0x3cb1c4(0x1d8)]()[_0x3cb1c4(0xde)](_0x3cb1c4(0x1cd))||_0x1f8523['name'][_0x3cb1c4(0x1d8)]()['includes'](_0x3cb1c4(0x150)))&&(_0x1f8523['value']===!![]||_0x1f8523[_0x3cb1c4(0xdf)]===_0x3cb1c4(0x142)))[_0x3cb1c4(0xaf)];let _0x164ad2=0x55;if(_0x2afc35&&_0x2afc35[_0x3cb1c4(0x194)]!==undefined)_0x164ad2=Math[_0x3cb1c4(0x155)](0x64,Math[_0x3cb1c4(0x15e)](0x14,Math['round'](0x50+Number(_0x2afc35[_0x3cb1c4(0x194)])*0x5)));const _0x188538={'date':_0x575c8c,'timestamp':Date['now'](),'roomHistory':_0x3d80a4?.[_0x3cb1c4(0x194)]?JSON[_0x3cb1c4(0xba)](_0x3d80a4['val']):{},'geminiNight':_0x419ac8?.[_0x3cb1c4(0x194)]||_0x3cb1c4(0xf1),'geminiDay':_0x39a9d2?.[_0x3cb1c4(0x194)]||_0x3cb1c4(0xf1),'anomalyScore':_0x40551d?.[_0x3cb1c4(0x194)]||0.1,'todayVector':_0x278133?.[_0x3cb1c4(0x194)]?JSON[_0x3cb1c4(0xba)](_0x278133[_0x3cb1c4(0x194)]):new Array(0x30)[_0x3cb1c4(0xda)](0x0),'batteryLevel':_0x164ad2,'freshAirCount':_0x2c0452,'eventHistory':this[_0x3cb1c4(0x1b7)]},_0xf8d2d5=utils[_0x3cb1c4(0x119)](),_0x3d4114=path[_0x3cb1c4(0xa0)](_0xf8d2d5,_0x3cb1c4(0x1ce),'history');if(!fs['existsSync'](_0x3d4114))fs['mkdirSync'](_0x3d4114,{'recursive':!![]});const _0x4d880d=path[_0x3cb1c4(0xa0)](_0x3d4114,_0x575c8c+_0x3cb1c4(0x9c));fs[_0x3cb1c4(0x1bd)](_0x4d880d,JSON[_0x3cb1c4(0x115)](_0x188538)),this[_0x3cb1c4(0xbb)]['info'](_0x3cb1c4(0xa5)+_0x4d880d);}catch(_0x5592ed){this[_0x3cb1c4(0xbb)]['error']('History\x20Save\x20Error:\x20'+_0x5592ed['message']);}}async[a0_0x1c9c37(0xb2)](){const _0x3d9907=a0_0x1c9c37;if(!this['isPresent'])return;try{let _0xafbdfd=null;try{const _0x4568ac=await this[_0x3d9907(0x118)](_0x3d9907(0x169)),_0x2ecdd6=await this[_0x3d9907(0x118)](_0x3d9907(0xa6));if(_0x4568ac&&_0x4568ac[_0x3d9907(0x194)]&&_0x2ecdd6&&_0x2ecdd6[_0x3d9907(0x194)]&&_0x2ecdd6['val']>0.3){if(_0x4568ac[_0x3d9907(0x194)]!==_0x3d9907(0xc6)&&_0x4568ac['val']!=='Init...')_0xafbdfd=_0x4568ac[_0x3d9907(0x194)];}}catch(_0x5921c2){}if(!_0xafbdfd){const _0x473438=this['config']['devices']||[];for(const _0x1798ca of _0x473438){if(_0x1798ca[_0x3d9907(0x14b)]==='motion'&&_0x1798ca[_0x3d9907(0x109)])try{const _0x24da5c=await this[_0x3d9907(0x1a9)](_0x1798ca['id']);if(_0x24da5c&&(_0x24da5c[_0x3d9907(0x194)]===!![]||_0x24da5c[_0x3d9907(0x194)]==='on'||_0x24da5c[_0x3d9907(0x194)]===0x1)){_0xafbdfd=_0x1798ca['location'];break;}}catch(_0x448dea){}}}if(!_0xafbdfd)return;const _0x488199=this[_0x3d9907(0x1b1)][_0x3d9907(0x12b)]||[];let _0x1c0cc0=_0xafbdfd;const _0x38e8c9=_0x488199[_0x3d9907(0xbc)](_0x52a6c1=>_0x52a6c1['location']&&_0x52a6c1[_0x3d9907(0x109)][_0x3d9907(0x1d8)]()===_0xafbdfd['toLowerCase']());if(_0x38e8c9)_0x1c0cc0=_0x38e8c9[_0x3d9907(0x109)];const _0x9542b5=_0x3d9907(0x1b6),_0x486503=await this[_0x3d9907(0x118)](_0x9542b5),_0x10a48c=new Date()[_0x3d9907(0x1c5)]();let _0x4a5b8={'history':{},'date':_0x10a48c};if(_0x486503&&_0x486503['val'])try{_0x4a5b8=JSON[_0x3d9907(0xba)](_0x486503[_0x3d9907(0x194)]);}catch(_0x1d28b4){}_0x4a5b8[_0x3d9907(0x1d1)]!==_0x10a48c&&(_0x4a5b8[_0x3d9907(0x19f)]={},_0x4a5b8[_0x3d9907(0x1d1)]=_0x10a48c);if(!_0x4a5b8[_0x3d9907(0x19f)][_0x1c0cc0])_0x4a5b8[_0x3d9907(0x19f)][_0x1c0cc0]=new Array(0x18)[_0x3d9907(0xda)](0x0);const _0x26df69=new Date()['getHours']();if(_0x4a5b8['history'][_0x1c0cc0][_0x26df69]<0x3c)_0x4a5b8[_0x3d9907(0x19f)][_0x1c0cc0][_0x26df69]++;await this[_0x3d9907(0xae)](_0x9542b5,{'val':JSON[_0x3d9907(0x115)](_0x4a5b8),'ack':!![]});}catch(_0x258a1c){this[_0x3d9907(0xbb)][_0x3d9907(0x103)]('[Integrator]\x20Error:\x20'+_0x258a1c[_0x3d9907(0x135)]);}}async[a0_0x1c9c37(0x193)](_0x581e5b){const _0x3746d9=a0_0x1c9c37;if(typeof _0x581e5b===_0x3746d9(0xef)&&_0x581e5b[_0x3746d9(0x135)]){if(_0x581e5b['command']===_0x3746d9(0x114)){const _0x531a60=_0x581e5b[_0x3746d9(0x135)][_0x3746d9(0x1d1)],_0x318fe7=utils['getAbsoluteDefaultDataDir'](),_0x4a938e=path[_0x3746d9(0xa0)](_0x318fe7,_0x3746d9(0x1ce),_0x3746d9(0x19f),_0x531a60+_0x3746d9(0x9c));if(fs[_0x3746d9(0x1b3)](_0x4a938e))try{const _0x16692d=JSON[_0x3746d9(0xba)](fs[_0x3746d9(0x12d)](_0x4a938e,'utf8'));this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![],'data':_0x16692d},_0x581e5b[_0x3746d9(0xa1)]);}catch(_0x1a6fca){this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b['command'],{'success':![],'error':_0x3746d9(0x1a6)},_0x581e5b['callback']);}else this['sendTo'](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b['command'],{'success':![],'error':_0x3746d9(0x175)},_0x581e5b[_0x3746d9(0xa1)]);}else{if(_0x581e5b[_0x3746d9(0xbd)]===_0x3746d9(0x183)){const _0x83c041=this['dailyDigests'][_0x3746d9(0xaf)];let _0x337962=new Array(0x30)[_0x3746d9(0xda)](0x0),_0x22e21b=Array[_0x3746d9(0xb6)]({'length':0x30},()=>[]);try{const _0x1e7f9e=await this['getStateAsync'](_0x3746d9(0x11f));if(_0x1e7f9e&&_0x1e7f9e[_0x3746d9(0x194)])_0x337962=JSON[_0x3746d9(0xba)](_0x1e7f9e[_0x3746d9(0x194)]);const _0x1a401b=await this['getStateAsync'](_0x3746d9(0xd5));if(_0x1a401b&&_0x1a401b[_0x3746d9(0x194)])_0x22e21b=JSON[_0x3746d9(0xba)](_0x1a401b['val']);}catch(_0x50569a){}let _0x5de151=new Array(0x30)[_0x3746d9(0xda)](0x0);try{const _0x17a648=new Date();_0x17a648[_0x3746d9(0x15a)](_0x17a648['getDate']()-0x1);const _0x4e3e9d=_0x17a648[_0x3746d9(0x14e)]()[_0x3746d9(0x19b)]('T')[0x0],_0x14bfef=utils[_0x3746d9(0x119)](),_0x42c4c5=path[_0x3746d9(0xa0)](_0x14bfef,'cogni-living',_0x3746d9(0x19f),_0x4e3e9d+_0x3746d9(0x9c));if(fs[_0x3746d9(0x1b3)](_0x42c4c5)){const _0x2fac77=JSON[_0x3746d9(0xba)](fs[_0x3746d9(0x12d)](_0x42c4c5,_0x3746d9(0x9b)));if(_0x2fac77&&_0x2fac77[_0x3746d9(0x189)])_0x5de151=_0x2fac77[_0x3746d9(0x189)];}}catch(_0x319065){}let _0x454d72={'today':{},'yesterday':{}};try{const _0x4500ad=await this[_0x3746d9(0x118)]('analysis.activity.roomStats');if(_0x4500ad&&_0x4500ad[_0x3746d9(0x194)])_0x454d72=JSON[_0x3746d9(0xba)](_0x4500ad[_0x3746d9(0x194)]);}catch(_0x5655db){}let _0x24619d=null;try{const _0x1500b5=await this[_0x3746d9(0x118)](_0x3746d9(0x181));if(_0x1500b5)_0x24619d=_0x1500b5[_0x3746d9(0x194)];}catch(_0x4085f7){}if(_0x24619d===undefined||_0x24619d===null){const _0x493ac0=_0x337962[_0x3746d9(0xc8)]((_0x4a7b5e,_0x33d17f)=>_0x4a7b5e+_0x33d17f,0x0),_0x2a6b08=Math[_0x3746d9(0x155)](0x2,Math[_0x3746d9(0x15e)](-0x2,(0x64-_0x493ac0)/0x32));_0x24619d=_0x2a6b08;}let _0x3ee6eb=![],_0xe9fa21='',_0x1665c5='',_0x4a8e66='';try{const _0x533b81=await this[_0x3746d9(0x118)](_0x3746d9(0x1d6));if(_0x533b81&&_0x533b81[_0x3746d9(0x194)]){_0x3ee6eb=!![];const _0x3e13f4=await this[_0x3746d9(0x118)](_0x3746d9(0x122));_0xe9fa21=_0x3e13f4?_0x3e13f4[_0x3746d9(0x194)]:'';const _0x547e04=await this[_0x3746d9(0x118)](_0x3746d9(0x1ca));_0x1665c5=_0x547e04?_0x547e04[_0x3746d9(0x194)]:'';const _0x152937=await this[_0x3746d9(0x118)](_0x3746d9(0xe7));_0x4a8e66=_0x152937?_0x152937['val']:'';}}catch(_0x1380ca){}const _0x4eb814=await this['checkSolarCondition'](),_0x39c969=(this[_0x3746d9(0x1b1)]['devices']||[])[_0x3746d9(0x10f)](_0x3d6ef8=>_0x3d6ef8[_0x3746d9(0xd8)]),_0x43dd0b=_0x4eb814&&_0x39c969;let _0x48a8a4='';try{const _0x1c5564=await this[_0x3746d9(0x118)]('system.presenceWho');if(_0x1c5564&&_0x1c5564[_0x3746d9(0x194)])_0x48a8a4=_0x1c5564[_0x3746d9(0x194)];}catch(_0x70bc37){}this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![],'eventHistory':this['eventHistory'][_0x3746d9(0x151)](0x0,0x7d0),'stats':{'digestCount':_0x83c041,'isPresent':this[_0x3746d9(0x157)],'hourlyActivity':_0x337962,'hourlyDetails':_0x22e21b,'yesterdayActivity':_0x5de151,'solarActive':_0x43dd0b,'presenceWho':_0x48a8a4,'roomStats':_0x454d72,'activityTrend':_0x24619d,'modules':this[_0x3746d9(0x13b)]},'automation':{'detected':_0x3ee6eb,'description':_0xe9fa21,'targetId':_0x1665c5,'targetValue':_0x4a8e66}},_0x581e5b['callback']);}else{if(_0x581e5b[_0x3746d9(0xbd)]===_0x3746d9(0x113))try{const _0x396d45=await automation[_0x3746d9(0xc1)](this);this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![],'results':_0x396d45},_0x581e5b['callback']);}catch(_0x476262){this['sendTo'](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':![],'error':_0x476262[_0x3746d9(0x135)]},_0x581e5b[_0x3746d9(0xa1)]);}else{if(_0x581e5b[_0x3746d9(0xbd)]===_0x3746d9(0xfe))try{const _0x5beeec=await scanner[_0x3746d9(0x163)](this,_0x581e5b[_0x3746d9(0x135)]||{});this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![],'devices':_0x5beeec},_0x581e5b[_0x3746d9(0xa1)]);}catch(_0x3f1ad8){}else{if(_0x581e5b[_0x3746d9(0xbd)]===_0x3746d9(0x11c)){const _0x8d3348=await this[_0x3746d9(0x127)](_0x3746d9(0x121),_0x3746d9(0x1cf)),_0x9f226e=[];if(_0x8d3348)for(const _0x4341e1 in _0x8d3348){let _0x3a9a39=_0x8d3348[_0x4341e1]['common'][_0x3746d9(0x100)];if(_0x3a9a39&&typeof _0x3a9a39===_0x3746d9(0xef))_0x3a9a39=_0x3a9a39['de']||_0x3a9a39['en']||Object[_0x3746d9(0x126)](_0x3a9a39)[0x0]||JSON[_0x3746d9(0x115)](_0x3a9a39);_0x9f226e[_0x3746d9(0x1a2)]({'id':_0x4341e1,'name':String(_0x3a9a39||_0x4341e1)});}const _0x37ffc2=await this[_0x3746d9(0x127)](_0x3746d9(0x1c3),_0x3746d9(0x1cf)),_0x5059a4=[];if(_0x37ffc2)for(const _0x591ac0 in _0x37ffc2){let _0x453c86=_0x37ffc2[_0x591ac0][_0x3746d9(0xa4)]['name'];if(_0x453c86&&typeof _0x453c86===_0x3746d9(0xef))_0x453c86=_0x453c86['de']||_0x453c86['en']||Object[_0x3746d9(0x126)](_0x453c86)[0x0]||JSON[_0x3746d9(0x115)](_0x453c86);_0x5059a4[_0x3746d9(0x1a2)](String(_0x453c86||_0x591ac0['split']('.')[_0x3746d9(0x1ae)]()));}this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![],'enums':_0x9f226e,'rooms':_0x5059a4},_0x581e5b[_0x3746d9(0xa1)]);}else{if(_0x581e5b['command']===_0x3746d9(0xfd))try{const _0x4a9169=await this[_0x3746d9(0x159)](_0x3746d9(0xe1),_0x3746d9(0x1b4),{'startkey':_0x3746d9(0xdb),'endkey':_0x3746d9(0x1c8)}),_0xd42d95=new Set();if(_0x4a9169&&_0x4a9169[_0x3746d9(0x133)])for(const _0x287292 of _0x4a9169[_0x3746d9(0x133)]){const _0x4cc5e4=_0x287292['id'][_0x3746d9(0x16f)](_0x3746d9(0x11d),''),_0x30b74e=await this[_0x3746d9(0x1a9)](_0x4cc5e4+_0x3746d9(0x124));let _0x51496d=![];if(_0x30b74e&&_0x30b74e[_0x3746d9(0x194)]){const _0x31bf63=typeof _0x30b74e[_0x3746d9(0x194)]===_0x3746d9(0x17b)?JSON[_0x3746d9(0xba)](_0x30b74e[_0x3746d9(0x194)]):_0x30b74e[_0x3746d9(0x194)];Array[_0x3746d9(0x15b)](_0x31bf63)&&_0x31bf63['forEach'](_0x4f29fd=>{const _0x242693=_0x3746d9;_0x4f29fd[_0x242693(0xbe)]&&(_0xd42d95[_0x242693(0x18f)](_0x4f29fd[_0x242693(0xbe)]),_0x51496d=!![]);});}!_0x51496d&&_0xd42d95[_0x3746d9(0x18f)](_0x4cc5e4);}const _0x4de950=Array['from'](_0xd42d95);if(_0x4de950['length']===0x0)_0x4de950[_0x3746d9(0x1a2)]('Standard');this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![],'names':_0x4de950},_0x581e5b['callback']);}catch(_0xbba3fd){this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':![],'error':'Scan\x20Error:\x20'+_0xbba3fd['message']},_0x581e5b[_0x3746d9(0xa1)]);}else{if(_0x581e5b[_0x3746d9(0xbd)]===_0x3746d9(0xe9))try{await automation['updateSchedulePreview'](this),this['sendTo'](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![]},_0x581e5b[_0x3746d9(0xa1)]);}catch(_0x6ceda4){this['log']['warn'](_0x3746d9(0x12f)+_0x6ceda4[_0x3746d9(0x135)]),this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':![],'error':_0x6ceda4['message']},_0x581e5b[_0x3746d9(0xa1)]);}else{if(_0x581e5b['command']===_0x3746d9(0x1c9))try{const _0x177697=_0x581e5b[_0x3746d9(0x135)]?_0x581e5b[_0x3746d9(0x135)][_0x3746d9(0x13c)]:'';if(!_0x177697)throw new Error(_0x3746d9(0xfb));const _0x4fd3d=new GoogleGenerativeAI(_0x177697),_0x1f2128=_0x4fd3d[_0x3746d9(0xd4)]({'model':GEMINI_MODEL}),_0x561ea4=await _0x1f2128['generateContent'](_0x3746d9(0xf4)),_0x18ce67=await _0x561ea4[_0x3746d9(0x198)],_0x403bf1=_0x18ce67[_0x3746d9(0x16a)]();this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![],'message':_0x3746d9(0x9e)+_0x403bf1[_0x3746d9(0x160)](0x0,0x14)+_0x3746d9(0x152)},_0x581e5b[_0x3746d9(0xa1)]);}catch(_0x4a1f3f){this[_0x3746d9(0x188)](_0x581e5b['from'],_0x581e5b['command'],{'success':![],'message':_0x4a1f3f[_0x3746d9(0x135)]},_0x581e5b[_0x3746d9(0xa1)]);}else{if(_0x581e5b[_0x3746d9(0xbd)]===_0x3746d9(0x1a8))try{const _0x11e9b4=await this[_0x3746d9(0x129)](),_0x252913=await this[_0x3746d9(0x159)](_0x3746d9(0xe1),_0x3746d9(0x1b4),{'startkey':_0x3746d9(0xdb),'endkey':_0x3746d9(0x1c8)}),_0xe96c13=_0x252913&&_0x252913[_0x3746d9(0x133)]?_0x252913[_0x3746d9(0x133)][_0x3746d9(0xaf)]:0x0;this['sendTo'](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b[_0x3746d9(0xbd)],{'success':!![],'weather':'Sonne:\x20'+_0x11e9b4+_0x3746d9(0xa9)+(this[_0x3746d9(0xf2)][this['config'][_0x3746d9(0xd6)]]||'?')+'¬∞C','calendar':_0xe96c13+'\x20Kalender-Adapter\x20gefunden.'},_0x581e5b[_0x3746d9(0xa1)]);}catch(_0x1ebfef){this[_0x3746d9(0x188)](_0x581e5b[_0x3746d9(0xb6)],_0x581e5b['command'],{'success':![]},_0x581e5b[_0x3746d9(0xa1)]);}}}}}}}}}}}[a0_0x1c9c37(0xca)](){const _0xa60c53=a0_0x1c9c37;if(!this[_0xa60c53(0x13b)][_0xa60c53(0x19c)])return;this[_0xa60c53(0xbb)][_0xa60c53(0x14c)](_0xa60c53(0x128));try{const _0xa4d938=this[_0xa60c53(0x15f)]||[];pythonBridge['send'](this,_0xa60c53(0xb1),{'events':_0xa4d938});}catch(_0x89e55d){this[_0xa60c53(0xbb)]['warn'](_0xa60c53(0xc3));}}async['onStateChange'](_0x52889d,_0x455b49){const _0x5a343a=a0_0x1c9c37;if(!_0x455b49||this[_0x5a343a(0xe2)])return;if(_0x52889d['includes']('telegram')&&_0x52889d['endsWith'](_0x5a343a(0x1a7))&&_0x455b49['val'])return;if(this[_0x5a343a(0x1b1)][_0x5a343a(0x197)]&&_0x52889d===this[_0x5a343a(0x1b1)]['infrasoundSensorId']&&this['activeModules'][_0x5a343a(0xd9)]){this['handleInfrasound'](_0x455b49[_0x5a343a(0x194)]);return;}if(_0x455b49['ack']&&_0x52889d[_0x5a343a(0x192)]('pulse'))return;if(_0x52889d===this[_0x5a343a(0xf3)]+_0x5a343a(0x1d4)){if(_0x455b49[_0x5a343a(0x194)]&&Object[_0x5a343a(0x126)](setup[_0x5a343a(0x16d)])[_0x5a343a(0xde)](_0x455b49[_0x5a343a(0x194)])){this[_0x5a343a(0x1c0)]=_0x455b49[_0x5a343a(0x194)];if(_0x455b49[_0x5a343a(0x194)]===setup[_0x5a343a(0x16d)][_0x5a343a(0xb7)])await recorder[_0x5a343a(0x1b5)](this,![]);else await recorder[_0x5a343a(0x1b5)](this,!![]);if(this['isProVersion']){let _0x317c4b=![],_0x3859a9=0x0,_0x252d6f=_0x5a343a(0xc9);if(this['currentSystemMode']===_0x5a343a(0x138))_0x317c4b=!![],_0x3859a9=0x168,_0x252d6f=_0x5a343a(0xe8);else this[_0x5a343a(0x1c0)]==='guest'&&(_0x317c4b=!![],_0x3859a9=0x5a0,_0x252d6f=_0x5a343a(0x187));pythonBridge[_0x5a343a(0x11b)](this,_0x5a343a(0xdc),{'active':_0x317c4b,'duration':_0x3859a9,'label':_0x252d6f}),await this[_0x5a343a(0xae)](_0x5a343a(0x144),{'val':JSON[_0x5a343a(0x115)]({'active':_0x317c4b,'label':_0x252d6f,'timestamp':Date[_0x5a343a(0x15c)]()}),'ack':!![]});}}if(!_0x455b49[_0x5a343a(0x10b)])this['setState'](_0x52889d,{'val':this[_0x5a343a(0x1c0)],'ack':!![]});return;}if(_0x52889d[_0x5a343a(0x192)](_0x5a343a(0x134))&&_0x455b49['ack'])this[_0x5a343a(0x1d0)](_0x455b49[_0x5a343a(0x194)]);if(_0x52889d[_0x5a343a(0x192)]('analysis.energy.warmupTimes')&&_0x455b49[_0x5a343a(0x10b)]&&this['activeModules'][_0x5a343a(0x18c)])automation['checkCalendarTriggers'](this);if(!_0x455b49[_0x5a343a(0x10b)]){if(_0x52889d['includes'](_0x5a343a(0x1a3))&&_0x455b49[_0x5a343a(0x194)]){this[_0x5a343a(0xc2)](_0x52889d,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this);return;}if(_0x52889d[_0x5a343a(0xde)](_0x5a343a(0x1b2))&&_0x455b49[_0x5a343a(0x194)]){this['setState'](_0x52889d,{'val':![],'ack':!![]});if(this[_0x5a343a(0xf7)])aiAgent[_0x5a343a(0x162)](this,pythonBridge);return;}if(_0x52889d['includes'](_0x5a343a(0xf5))&&_0x455b49[_0x5a343a(0x194)]){this[_0x5a343a(0xc2)](_0x52889d,{'val':![],'ack':!![]}),aiAgent[_0x5a343a(0x1ab)](this);return;}if(_0x52889d[_0x5a343a(0xde)](_0x5a343a(0x184))&&_0x455b49[_0x5a343a(0x194)]){this[_0x5a343a(0xc2)](_0x52889d,{'val':![],'ack':!![]}),aiAgent[_0x5a343a(0x18a)](this);return;}if(_0x52889d[_0x5a343a(0xde)](_0x5a343a(0x10e))&&_0x455b49[_0x5a343a(0x194)]){this['setState'](_0x52889d,{'val':![],'ack':!![]});if(this[_0x5a343a(0xf7)])try{const _0x364006=await this['getStateAsync'](_0x5a343a(0x1cb));if(_0x364006&&_0x364006[_0x5a343a(0x194)]){const _0x574cca=JSON['parse'](_0x364006[_0x5a343a(0x194)]);this[_0x5a343a(0xae)]('analysis.training.status',{'val':_0x5a343a(0x16c),'ack':!![]}),pythonBridge[_0x5a343a(0x11b)](this,_0x5a343a(0x191),{'sequences':_0x574cca});}}catch(_0x4e8663){}return;}if(_0x52889d['includes'](_0x5a343a(0x153))&&_0x455b49[_0x5a343a(0x194)]){this[_0x5a343a(0xc2)](_0x52889d,{'val':![],'ack':!![]});if(this[_0x5a343a(0xf7)])try{this[_0x5a343a(0xca)]();const _0x416108=await this[_0x5a343a(0x118)]('LTM.dailyDigests');if(_0x416108&&_0x416108[_0x5a343a(0x194)])pythonBridge[_0x5a343a(0x11b)](this,_0x5a343a(0xf6),{'digests':JSON[_0x5a343a(0xba)](_0x416108['val'])});aiAgent[_0x5a343a(0xac)](this,_0x5a343a(0x107)),setTimeout(()=>aiAgent[_0x5a343a(0xac)](this,_0x5a343a(0xb0)),0x2ee0);}catch(_0x5e2e63){}return;}if(_0x52889d[_0x5a343a(0xde)](_0x5a343a(0xed))&&_0x455b49['val']){this['setState'](_0x52889d,{'val':![],'ack':!![]}),await this[_0x5a343a(0x149)]();return;}if(_0x52889d[_0x5a343a(0xde)](_0x5a343a(0x173))&&_0x455b49[_0x5a343a(0x194)]){this['setState'](_0x52889d,{'val':![],'ack':!![]});if(this[_0x5a343a(0xf7)])try{const _0x429379=await this[_0x5a343a(0x118)](_0x5a343a(0xce));if(_0x429379&&_0x429379['val']){const _0x222500={};if(this['config'][_0x5a343a(0x12b)])this[_0x5a343a(0x1b1)][_0x5a343a(0x12b)][_0x5a343a(0xe3)](_0x41c620=>{if(_0x41c620['id']&&_0x41c620['type'])_0x222500[_0x41c620['id']]=_0x41c620['type'];});pythonBridge[_0x5a343a(0x11b)](this,_0x5a343a(0xeb),{'events':JSON[_0x5a343a(0xba)](_0x429379[_0x5a343a(0x194)]),'deviceMap':_0x222500});}}catch(_0x2aa79c){}return;}if(_0x52889d[_0x5a343a(0xde)](_0x5a343a(0xdd))&&_0x455b49[_0x5a343a(0x194)]){this[_0x5a343a(0xc2)](_0x52889d,{'val':![],'ack':!![]}),topology[_0x5a343a(0x14a)](this);if(this[_0x5a343a(0xf7)])try{const _0x4a973d=await this[_0x5a343a(0x118)](_0x5a343a(0x1cb));if(_0x4a973d&&_0x4a973d[_0x5a343a(0x194)])pythonBridge['send'](this,_0x5a343a(0x136),{'sequences':JSON[_0x5a343a(0xba)](_0x4a973d[_0x5a343a(0x194)])});}catch(_0x1f6dd6){}return;}}const _0x58cf62=(this['config']['devices']||[])[_0x5a343a(0xbc)](_0x6cdb85=>_0x6cdb85['id']===_0x52889d);if(_0x58cf62){const _0x39ef51=await recorder[_0x5a343a(0xb9)](this,_0x52889d,_0x455b49,_0x58cf62);_0x39ef51&&this[_0x5a343a(0xc2)]('analysis.visualization.pulse',{'val':Date['now'](),'ack':!![]});_0x39ef51&&_0x39ef51['type']===_0x5a343a(0xbf)&&_0x39ef51[_0x5a343a(0x109)]&&this[_0x5a343a(0xf7)]&&deadMan[_0x5a343a(0x190)](this,_0x39ef51[_0x5a343a(0x109)]);_0x455b49[_0x5a343a(0x194)]&&(_0x455b49[_0x5a343a(0x194)]===!![]||_0x455b49[_0x5a343a(0x194)]===0x1||String(_0x455b49[_0x5a343a(0x194)])[_0x5a343a(0x1d8)]()===_0x5a343a(0x142))&&(_0x58cf62[_0x5a343a(0x14b)]&&(_0x58cf62['type'][_0x5a343a(0xde)]('window')||_0x58cf62['type'][_0x5a343a(0xde)]('door'))&&this[_0x5a343a(0xcf)](_0x58cf62));if(_0x58cf62[_0x5a343a(0x14b)]===_0x5a343a(0x1d2)||_0x58cf62[_0x5a343a(0x14b)]===_0x5a343a(0x180)){if(this[_0x5a343a(0x13b)][_0x5a343a(0x18c)])automation[_0x5a343a(0xec)](this);}}}async[a0_0x1c9c37(0x1d0)](_0xb4f05f){const _0x79a8bb=a0_0x1c9c37;if(!this[_0x79a8bb(0x101)]||Date['now']()-this[_0x79a8bb(0x177)]>0x493e0)return;try{const _0x2d1ce2=JSON['parse'](_0xb4f05f),_0x3bd42e=this['memoryCache']['sources'];let _0x1861f7=![];for(const _0x34f406 in _0x3bd42e){if(_0x3bd42e[_0x34f406][_0x79a8bb(0xde)]('AI')&&_0x2d1ce2[_0x34f406]&&!_0x2d1ce2[_0x34f406][_0x79a8bb(0xde)]('AI')){_0x1861f7=!![];break;}}_0x1861f7&&(await this[_0x79a8bb(0xae)](_0x79a8bb(0x1bf),{'val':JSON[_0x79a8bb(0x115)](this[_0x79a8bb(0x101)]['times']),'ack':!![]}),await this[_0x79a8bb(0xae)](_0x79a8bb(0x134),{'val':JSON[_0x79a8bb(0x115)](this[_0x79a8bb(0x101)][_0x79a8bb(0x174)]),'ack':!![]}));}catch(_0x4835c4){}}async[a0_0x1c9c37(0xa3)](){const _0x50c1ff=a0_0x1c9c37;try{const _0x58497d=await this['getStateAsync'](setup[_0x50c1ff(0x158)]);if(_0x58497d&&_0x58497d[_0x50c1ff(0x194)])this[_0x50c1ff(0x1c0)]=_0x58497d['val'];}catch(_0x2c5a28){this[_0x50c1ff(0x1c0)]=setup['SYSTEM_MODES'][_0x50c1ff(0xd0)];}}async[a0_0x1c9c37(0x1a5)](){return![];}async[a0_0x1c9c37(0x9d)](){const _0x3f461c=a0_0x1c9c37;await aiAgent[_0x3f461c(0xee)](this);this[_0x3f461c(0x13b)][_0x3f461c(0x19c)]&&(this[_0x3f461c(0x112)](),this[_0x3f461c(0x1ba)]());if(this['activeModules'][_0x3f461c(0x18c)])this[_0x3f461c(0x149)]();}async[a0_0x1c9c37(0x129)](){return![];}[a0_0x1c9c37(0x1ba)](){const _0x150053=a0_0x1c9c37;if(!this[_0x150053(0xf7)])return;}async['triggerEnergyPrediction'](){const _0x1d249e=a0_0x1c9c37;if(!this[_0x1d249e(0xf7)]||!this[_0x1d249e(0x13b)]['energy'])return;try{const _0x570ccd={},_0x2b6f79={},_0x33cb37=this['config'][_0x1d249e(0x12b)]||[];for(const _0x4988a2 of _0x33cb37){if(_0x4988a2[_0x1d249e(0x14b)]===_0x1d249e(0xd3)&&_0x4988a2['location'])try{const _0x2d50e6=await this[_0x1d249e(0x1a9)](_0x4988a2['id']);_0x2d50e6&&typeof _0x2d50e6[_0x1d249e(0x194)]==='number'&&(_0x570ccd[_0x4988a2[_0x1d249e(0x109)]]=_0x2d50e6[_0x1d249e(0x194)],_0x2b6f79[_0x4988a2[_0x1d249e(0x109)]]=_0x4988a2[_0x1d249e(0xd8)]||![]);}catch(_0x4bd733){}}let _0x18ec7a=0xa;if(this[_0x1d249e(0x1b1)][_0x1d249e(0x143)])try{const _0x5182cc=await this[_0x1d249e(0x1a9)](this[_0x1d249e(0x1b1)][_0x1d249e(0x143)]);if(_0x5182cc&&typeof _0x5182cc[_0x1d249e(0x194)]===_0x1d249e(0x1c4))_0x18ec7a=_0x5182cc[_0x1d249e(0x194)];}catch(_0x3df94c){}const _0x45894b=await this[_0x1d249e(0x129)]();let _0x3f4c5d={};try{const _0x5f334b=await this[_0x1d249e(0x118)](_0x1d249e(0x116));if(_0x5f334b&&_0x5f334b[_0x1d249e(0x194)])_0x3f4c5d=JSON['parse'](_0x5f334b['val']);}catch(_0x2a3b39){}pythonBridge[_0x1d249e(0x11b)](this,_0x1d249e(0xa7),{'current_temps':_0x570ccd,'t_out':_0x18ec7a,'is_sunny':_0x45894b,'solar_flags':_0x2b6f79,'warmup_targets':_0x3f4c5d}),this[_0x1d249e(0xbb)][_0x1d249e(0x165)]('üîÆ\x20Energy\x20Prediction\x20triggered\x20('+Object[_0x1d249e(0x171)](_0x570ccd)[_0x1d249e(0xaf)]+_0x1d249e(0x1c1));}catch(_0x317be7){this[_0x1d249e(0xbb)][_0x1d249e(0x103)](_0x1d249e(0x10d)+_0x317be7[_0x1d249e(0x135)]);}}[a0_0x1c9c37(0x112)](){}async[a0_0x1c9c37(0x10a)](_0x43ea3e){}async[a0_0x1c9c37(0x18b)](_0xf69a0f,_0x16bc0a){}async[a0_0x1c9c37(0xcf)](_0x3ff80e){}async[a0_0x1c9c37(0x13d)](_0x39aa18){}['sendNotification'](_0x16abb9){}}if(require[a0_0x1c9c37(0x123)]!==module)module[a0_0x1c9c37(0x161)]=_0xaaf827=>new CogniLiving(_0xaaf827);else new CogniLiving();