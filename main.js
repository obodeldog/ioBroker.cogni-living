const a0_0x272bed=a0_0xa543;(function(_0x3ea706,_0x22b5d1){const _0x22ab0c=a0_0xa543,_0x5d5a4d=_0x3ea706();while(!![]){try{const _0x45f01e=parseInt(_0x22ab0c(0x191))/0x1*(-parseInt(_0x22ab0c(0x16b))/0x2)+parseInt(_0x22ab0c(0x160))/0x3*(parseInt(_0x22ab0c(0x151))/0x4)+parseInt(_0x22ab0c(0x1ff))/0x5*(parseInt(_0x22ab0c(0x190))/0x6)+parseInt(_0x22ab0c(0x1f2))/0x7*(parseInt(_0x22ab0c(0x1a8))/0x8)+-parseInt(_0x22ab0c(0x18a))/0x9+-parseInt(_0x22ab0c(0x142))/0xa+parseInt(_0x22ab0c(0x240))/0xb*(-parseInt(_0x22ab0c(0x1bd))/0xc);if(_0x45f01e===_0x22b5d1)break;else _0x5d5a4d['push'](_0x5d5a4d['shift']());}catch(_0x29b5b9){_0x5d5a4d['push'](_0x5d5a4d['shift']());}}}(a0_0x3848,0x2e822));const a0_0x172f4a=(function(){let _0x1aa577=!![];return function(_0x5f328d,_0x2bdc26){const _0xf813d1=_0x1aa577?function(){const _0x3d81c6=a0_0xa543;if(_0x2bdc26){const _0x5de26c=_0x2bdc26[_0x3d81c6(0x1f8)](_0x5f328d,arguments);return _0x2bdc26=null,_0x5de26c;}}:function(){};return _0x1aa577=![],_0xf813d1;};}()),a0_0x346797=a0_0x172f4a(this,function(){const _0x56d303=a0_0xa543;return a0_0x346797['toString']()[_0x56d303(0x185)](_0x56d303(0x161))['toString']()[_0x56d303(0x13a)](a0_0x346797)[_0x56d303(0x185)]('(((.+)+)+)+$');});a0_0x346797();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x272bed(0x11f)),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL='models/gemini-flash-latest',ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE=a0_0x272bed(0x23d),LTM_DP_RAW_LOG=a0_0x272bed(0x13b),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x272bed(0x24c),LTM_DP_TRIGGER_DIGEST=a0_0x272bed(0x170),LTM_DP_BASELINE_STATUS=a0_0x272bed(0x246),LTM_DP_DRIFT_CHANNEL=a0_0x272bed(0x195),LTM_DP_DRIFT_STATUS=a0_0x272bed(0x17f),LTM_DP_DRIFT_DETAILS=a0_0x272bed(0x18e),LTM_DP_DRIFT_LAST_CHECK=a0_0x272bed(0x19f),SYSTEM_DP_MODE=a0_0x272bed(0x199),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',SYSTEM_MODES={'NORMAL':a0_0x272bed(0x1b7),'VACATION':a0_0x272bed(0x263),'PARTY':a0_0x272bed(0x216),'GUEST':a0_0x272bed(0x14a)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x272bed(0x127)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x272bed(0x215),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20ungew√∂hnliche\x20n√§chtliche\x20Aktivit√§t.','family':'Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','single_comfort':a0_0x272bed(0x16a),'security':'PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.'};class CogniLiving extends utils[a0_0x272bed(0x147)]{constructor(_0x3c585b){const _0x3f2f02=a0_0x272bed;super({..._0x3c585b,'name':_0x3f2f02(0x1e4)}),this[_0x3f2f02(0x244)]=[],this[_0x3f2f02(0x1dd)]=[],this[_0x3f2f02(0x220)]=[],this[_0x3f2f02(0x202)]=[],this[_0x3f2f02(0x1b4)]=[],this[_0x3f2f02(0x175)]={},this[_0x3f2f02(0x209)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x3f2f02(0x17b)]=!![],this['exitTimer']=null,this[_0x3f2f02(0x1b0)]=null,this[_0x3f2f02(0x184)]=![],this[_0x3f2f02(0x266)]=null,this[_0x3f2f02(0x255)]=null,this[_0x3f2f02(0x12a)]=SYSTEM_MODES[_0x3f2f02(0x18f)],this['isProVersion']=![],this[_0x3f2f02(0x24f)]=![],this[_0x3f2f02(0x21c)]='unknown',this[_0x3f2f02(0x13d)]=null,this['ltmJob']=null,this['modeResetJob']=null,this[_0x3f2f02(0x122)]=null,this['on'](_0x3f2f02(0x22d),this[_0x3f2f02(0x1dc)]['bind'](this)),this['on']('stateChange',this[_0x3f2f02(0x174)][_0x3f2f02(0x165)](this)),this['on']('unload',this[_0x3f2f02(0x1ab)]['bind'](this)),this['on'](_0x3f2f02(0x13f),this[_0x3f2f02(0x17a)][_0x3f2f02(0x165)](this));}async[a0_0x272bed(0x1dc)](){const _0x422f33=a0_0x272bed;this['log']['info'](_0x422f33(0x1e7)+this[_0x422f33(0x1e6)]+')\x20-\x20DEBUG\x20MODE\x20ENABLED'),await this[_0x422f33(0x180)](),this[_0x422f33(0x1c5)][_0x422f33(0x203)]=this[_0x422f33(0x1c5)][_0x422f33(0x203)]||'',this[_0x422f33(0x15a)]=await this[_0x422f33(0x22b)](this['config'][_0x422f33(0x203)]);if(!this[_0x422f33(0x1c5)][_0x422f33(0x226)]||this[_0x422f33(0x1c5)][_0x422f33(0x226)]<0.1)this['config'][_0x422f33(0x226)]=0xc;await this[_0x422f33(0x189)]();try{const _0x1ebf4e=await this['getForeignObjectAsync']('system.config');_0x1ebf4e&&_0x1ebf4e[_0x422f33(0x251)]&&(this[_0x422f33(0x209)]={'latitude':_0x1ebf4e[_0x422f33(0x251)][_0x422f33(0x150)]||0x0,'longitude':_0x1ebf4e[_0x422f33(0x251)][_0x422f33(0x245)]||0x0,'city':_0x1ebf4e[_0x422f33(0x251)][_0x422f33(0x124)]||''},this[_0x422f33(0x11a)]['info'](_0x422f33(0x1f1)+this['systemConfig'][_0x422f33(0x124)]));}catch(_0x40c8cc){this[_0x422f33(0x11a)][_0x422f33(0x15c)](_0x422f33(0x21a));}if(this[_0x422f33(0x1c5)][_0x422f33(0x182)])try{this[_0x422f33(0x266)]=new GoogleGenerativeAI(this[_0x422f33(0x1c5)][_0x422f33(0x182)]),this[_0x422f33(0x255)]=this['genAI'][_0x422f33(0x235)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this['log'][_0x422f33(0x162)](_0x422f33(0x1e8));}catch(_0x7e4522){this[_0x422f33(0x11a)][_0x422f33(0x1af)](_0x422f33(0x1f7)+_0x7e4522[_0x422f33(0x13f)]);}else this[_0x422f33(0x11a)][_0x422f33(0x15c)](_0x422f33(0x1b3));await this[_0x422f33(0x253)](),await this[_0x422f33(0x20d)](),await this['loadRawEventLog'](),await this[_0x422f33(0x1c3)](),this[_0x422f33(0x238)](_0x422f33(0x15d)),this[_0x422f33(0x238)](LTM_DP_TRIGGER_DIGEST),this[_0x422f33(0x238)](_0x422f33(0x199));const _0x260d90=this[_0x422f33(0x1c5)][_0x422f33(0x1ec)];if(_0x260d90&&_0x260d90[_0x422f33(0x13c)]>0x0){this[_0x422f33(0x11a)]['info']('Subscribing\x20to\x20'+_0x260d90[_0x422f33(0x13c)]+_0x422f33(0x11b));for(const _0x164838 of _0x260d90){if(_0x164838['id']){await this['subscribeForeignStatesAsync'](_0x164838['id']);try{const _0x3bf9eb=await this[_0x422f33(0x17e)](_0x164838['id']);if(_0x3bf9eb)this[_0x422f33(0x175)][_0x164838['id']]=_0x3bf9eb['val'];}catch(_0x42270c){}}}}if(this[_0x422f33(0x13d)])clearInterval(this['analysisTimer']);const _0x39b6a9=this['config'][_0x422f33(0x22e)]||0xf;_0x39b6a9>0x0&&(this[_0x422f33(0x11a)][_0x422f33(0x162)](_0x422f33(0x155)+_0x39b6a9+_0x422f33(0x217)+this[_0x422f33(0x1c5)][_0x422f33(0x226)]+'h.'),this['analysisTimer']=setInterval(()=>this[_0x422f33(0x168)](),_0x39b6a9*0x3c*0x3e8)),this[_0x422f33(0x1ee)](),this[_0x422f33(0x143)](),this[_0x422f33(0x212)]();}async[a0_0x272bed(0x180)](){const _0x2345fb=a0_0x272bed,_0x297a8e=[_0x2345fb(0x1b8),'analysis.history_debug_01',_0x2345fb(0x228),_0x2345fb(0x219),_0x2345fb(0x1cc),_0x2345fb(0x11e),_0x2345fb(0x1f9),_0x2345fb(0x1ce),_0x2345fb(0x1c7),_0x2345fb(0x133)];for(const _0x4c356f of _0x297a8e){try{const _0x26e2ea=await this['getObjectAsync'](_0x4c356f);_0x26e2ea&&await this[_0x2345fb(0x1c8)](_0x4c356f);}catch(_0x45d931){}}}async[a0_0x272bed(0x189)](){const _0xecfbb1=a0_0x272bed;try{const _0x3e5e6c=await this[_0xecfbb1(0x230)]('events.history');_0x3e5e6c&&_0x3e5e6c['val']&&(this[_0xecfbb1(0x244)]=JSON['parse'](_0x3e5e6c[_0xecfbb1(0x1e9)][_0xecfbb1(0x166)]()),this['log'][_0xecfbb1(0x162)](_0xecfbb1(0x120)+this[_0xecfbb1(0x244)][_0xecfbb1(0x13c)]+_0xecfbb1(0x1a6)));}catch(_0x5e612d){this[_0xecfbb1(0x244)]=[];}try{const _0x4e03d3=await this[_0xecfbb1(0x230)](_0xecfbb1(0x25a));if(_0x4e03d3&&_0x4e03d3[_0xecfbb1(0x1e9)])this['analysisHistory']=JSON[_0xecfbb1(0x140)](_0x4e03d3['val'][_0xecfbb1(0x166)]());}catch(_0x2f3e92){this[_0xecfbb1(0x1dd)]=[];}}['onStateChange'](_0xe68550,_0x52ce52){const _0x587ede=a0_0x272bed;if(!_0x52ce52)return;if(_0xe68550===this[_0x587ede(0x1bf)]+'.'+SYSTEM_DP_MODE){_0x52ce52[_0x587ede(0x1e9)]&&Object[_0x587ede(0x141)](SYSTEM_MODES)[_0x587ede(0x252)](_0x52ce52['val'])&&(this[_0x587ede(0x12a)]=_0x52ce52['val'],_0x52ce52[_0x587ede(0x1e9)]===SYSTEM_MODES[_0x587ede(0x1fa)]?this[_0x587ede(0x137)](![]):this['setPresence'](!![]));if(!_0x52ce52[_0x587ede(0x192)])this['setState'](_0xe68550,{'val':this[_0x587ede(0x12a)],'ack':!![]});return;}if(!_0x52ce52['ack']){_0xe68550[_0x587ede(0x252)](_0x587ede(0x15d))&&_0x52ce52[_0x587ede(0x1e9)]&&(this[_0x587ede(0x11a)]['info'](_0x587ede(0x163)),this[_0x587ede(0x1ed)](_0xe68550,{'val':![],'ack':!![]}),this[_0x587ede(0x1cb)]());if(_0xe68550[_0x587ede(0x252)]('triggerDailyDigest')&&_0x52ce52[_0x587ede(0x1e9)]){this['setState'](_0xe68550,{'val':![],'ack':!![]});if(this[_0x587ede(0x15a)])this[_0x587ede(0x1d0)]();}return;}const _0x2487e1=(this[_0x587ede(0x1c5)][_0x587ede(0x1ec)]||[])[_0x587ede(0x154)](_0x34f07a=>_0x34f07a['id']===_0xe68550);if(_0x2487e1)this[_0x587ede(0x1cf)](_0xe68550,_0x52ce52,_0x2487e1);}async['processSensorEvent'](_0x11f897,_0x1f8e0f,_0x1e4fa4){const _0x147f8e=a0_0x272bed;if(!_0x1e4fa4['logDuplicates']&&this['sensorLastValues'][_0x11f897]===_0x1f8e0f[_0x147f8e(0x1e9)])return;this[_0x147f8e(0x175)][_0x11f897]=_0x1f8e0f['val'];if(this[_0x147f8e(0x184)]){this[_0x147f8e(0x11a)]['debug'](_0x147f8e(0x1d8)+_0x1e4fa4['name']);return;}const _0x4a95b4=_0x1e4fa4[_0x147f8e(0x1e5)]==='Fenster/T√ºr'&&(_0x1e4fa4[_0x147f8e(0x20f)][_0x147f8e(0x1e0)]()[_0x147f8e(0x252)](_0x147f8e(0x126))||_0x1e4fa4['name']['toLowerCase']()[_0x147f8e(0x252)](_0x147f8e(0x23c))||_0x1e4fa4[_0x147f8e(0x15b)][_0x147f8e(0x1e0)]()['includes'](_0x147f8e(0x12e)));_0x4a95b4&&!_0x1f8e0f[_0x147f8e(0x1e9)]?this['startExitTimer']():(this[_0x147f8e(0x262)]&&(this['log']['info'](_0x147f8e(0x1b1)),this[_0x147f8e(0x131)]()),!this[_0x147f8e(0x17b)]&&this[_0x147f8e(0x12a)]===SYSTEM_MODES[_0x147f8e(0x18f)]&&this[_0x147f8e(0x137)](!![]));const _0x1aef7d={'timestamp':_0x1f8e0f['ts'],'id':_0x11f897,'name':_0x1e4fa4[_0x147f8e(0x20f)],'value':_0x1f8e0f[_0x147f8e(0x1e9)],'location':_0x1e4fa4[_0x147f8e(0x15b)],'type':_0x1e4fa4[_0x147f8e(0x1e5)]};this[_0x147f8e(0x244)][_0x147f8e(0x1d1)](_0x1aef7d);if(this['eventHistory'][_0x147f8e(0x13c)]>HISTORY_MAX_SIZE)this[_0x147f8e(0x244)][_0x147f8e(0x1fb)]();await this[_0x147f8e(0x198)](_0x147f8e(0x11c),{'val':JSON[_0x147f8e(0x1c1)](_0x1aef7d),'ack':!![]}),await this[_0x147f8e(0x198)]('events.history',{'val':JSON[_0x147f8e(0x1c1)](this['eventHistory']),'ack':!![]}),this[_0x147f8e(0x202)][_0x147f8e(0x196)]({'timestamp':new Date(_0x1f8e0f['ts'])[_0x147f8e(0x1a1)](),'sensorName':_0x1e4fa4['name'],'location':_0x1e4fa4[_0x147f8e(0x15b)],'value':_0x1f8e0f[_0x147f8e(0x1e9)]}),await this[_0x147f8e(0x233)]();}[a0_0x272bed(0x1f3)](){const _0x5bbaec=a0_0x272bed;this[_0x5bbaec(0x11a)][_0x5bbaec(0x162)](_0x5bbaec(0x135)+EXIT_TIMER_MINUTES+_0x5bbaec(0x24a)+EXIT_GRACE_PERIOD_SECONDS+_0x5bbaec(0x1b6)),this['abortExitTimer'](),this[_0x5bbaec(0x184)]=!![],this[_0x5bbaec(0x1b0)]=setTimeout(()=>{const _0x294ec7=_0x5bbaec;this[_0x294ec7(0x184)]=![],this['log'][_0x294ec7(0x193)](_0x294ec7(0x20b));},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this['exitTimer']=setTimeout(()=>{const _0x4bb2a7=_0x5bbaec;this[_0x4bb2a7(0x11a)][_0x4bb2a7(0x162)](_0x4bb2a7(0x241)),this[_0x4bb2a7(0x137)](![]),this[_0x4bb2a7(0x262)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x272bed(0x131)](){const _0x17e4ca=a0_0x272bed;if(this[_0x17e4ca(0x262)])clearTimeout(this['exitTimer']);if(this['exitGraceTimer'])clearTimeout(this[_0x17e4ca(0x1b0)]);this[_0x17e4ca(0x262)]=null,this[_0x17e4ca(0x1b0)]=null,this[_0x17e4ca(0x184)]=![];}async['setPresence'](_0x2d36b6){const _0x39cb3a=a0_0x272bed;if(this[_0x39cb3a(0x17b)]===_0x2d36b6)return;this[_0x39cb3a(0x17b)]=_0x2d36b6,await this[_0x39cb3a(0x198)](_0x39cb3a(0x23a),{'val':_0x2d36b6,'ack':!![]}),this[_0x39cb3a(0x11a)][_0x39cb3a(0x162)](_0x39cb3a(0x19b)+(_0x2d36b6?_0x39cb3a(0x1c9):_0x39cb3a(0x201)));}[a0_0x272bed(0x168)](){const _0x3bf149=a0_0x272bed,_0x26beed=this[_0x3bf149(0x1c5)][_0x3bf149(0x226)],_0x3ede57=this['config']['inactivityMonitoringEnabled'],_0x3287dc=this[_0x3bf149(0x244)][_0x3bf149(0x13c)]>0x0?this['eventHistory'][0x0]['timestamp']:Date[_0x3bf149(0x186)](),_0x81cf56=(Date[_0x3bf149(0x186)]()-_0x3287dc)/(0x3e8*0x3c*0x3c);let _0x96eb73='';_0x3ede57&&this[_0x3bf149(0x12a)]===SYSTEM_MODES[_0x3bf149(0x18f)]&&this['isPresent']&&(_0x81cf56>_0x26beed&&(this[_0x3bf149(0x11a)][_0x3bf149(0x15c)](_0x3bf149(0x178)+_0x81cf56[_0x3bf149(0x21e)](0x1)+_0x3bf149(0x158)),_0x96eb73='CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0x81cf56[_0x3bf149(0x21e)](0x1)+_0x3bf149(0x227)));if(_0x96eb73){this[_0x3bf149(0x1cb)](_0x96eb73)[_0x3bf149(0x19a)](_0x593b41=>this['log'][_0x3bf149(0x1af)](_0x593b41));return;}const _0x3de0a6=Date['now'](),_0x42cb4a=_0x3de0a6-_0x3287dc,_0xa53732=(this[_0x3bf149(0x1c5)][_0x3bf149(0x22e)]||0xf)*0x3c*0x3e8;this['eventHistory'][_0x3bf149(0x13c)]>0x0&&_0x42cb4a<=_0xa53732?this[_0x3bf149(0x1cb)]()[_0x3bf149(0x19a)](_0x5dd199=>this['log'][_0x3bf149(0x1af)](_0x5dd199)):!this[_0x3bf149(0x24f)]&&(this[_0x3bf149(0x1ed)](_0x3bf149(0x210),{'val':![],'ack':!![]}),this['setState'](_0x3bf149(0x167),{'val':![],'ack':!![]}));}async[a0_0x272bed(0x1cb)](_0x556ca3=''){const _0x3f920b=a0_0x272bed;this[_0x3f920b(0x11a)]['info'](_0x3f920b(0x1d5));if(!this[_0x3f920b(0x255)]){this['log']['error'](_0x3f920b(0x130));return;}const _0x476e2e=this[_0x3f920b(0x244)][_0x3f920b(0x13c)]>0x0?this[_0x3f920b(0x244)]:[{'note':_0x3f920b(0x25f)}],_0x32c72d=PERSONA_MAPPING[this[_0x3f920b(0x1c5)]['aiPersona']||'generic'],_0x1ed184=this[_0x3f920b(0x1c5)][_0x3f920b(0x1d6)]||'',_0x3cc7c1=this[_0x3f920b(0x12a)],_0x55d815=new Date(),_0x20bdaa=_0x55d815[_0x3f920b(0x179)]('de-DE',{'weekday':_0x3f920b(0x224),'hour':_0x3f920b(0x164),'minute':_0x3f920b(0x164)}),_0x362525=this[_0x3f920b(0x209)];let _0x5a9a2f='';if(this['feedbackHistory'][_0x3f920b(0x13c)]>0x0){const _0x4efde1=this['feedbackHistory'][_0x3f920b(0x197)](0x0,0x3)[_0x3f920b(0x256)](_0x2a3c9a=>_0x3f920b(0x260)+_0x2a3c9a['alertReason']+_0x3f920b(0x254)+_0x2a3c9a[_0x3f920b(0x234)]+'.')[_0x3f920b(0x231)]('\x0a');_0x5a9a2f=_0x3f920b(0x214)+_0x4efde1+'\x0a';}const _0x10967b=_0x556ca3?'\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a'+_0x556ca3+_0x3f920b(0x136):'',_0x3fc85b=_0x3f920b(0x208),_0x2ef32f=_0x3f920b(0x20a)+_0x20bdaa+_0x3f920b(0x19d)+_0x362525[_0x3f920b(0x124)]+_0x3f920b(0x1ea)+_0x3cc7c1+_0x3f920b(0x14b)+(this[_0x3f920b(0x17b)]?'Ja':'Nein')+_0x3f920b(0x258)+_0x1ed184+'.\x20PERSONA:\x20'+_0x32c72d+_0x3f920b(0x259)+_0x3fc85b+'\x20'+_0x5a9a2f+'\x20'+_0x10967b+_0x3f920b(0x247)+JSON[_0x3f920b(0x1c1)](_0x476e2e)+_0x3f920b(0x23b);try{this[_0x3f920b(0x11a)]['debug']('Sending\x20Prompt\x20(Length:\x20'+_0x2ef32f[_0x3f920b(0x13c)]+')...');const _0x2e0f80=await this['geminiModel']['generateContent'](_0x2ef32f),_0x10acd7=_0x2e0f80[_0x3f920b(0x1b2)][_0x3f920b(0x237)]()[_0x3f920b(0x129)](/```json|```/g,'')['trim']();this[_0x3f920b(0x11a)][_0x3f920b(0x162)](_0x3f920b(0x21b));const _0x55316f=JSON[_0x3f920b(0x140)](_0x10acd7);await this[_0x3f920b(0x198)](_0x3f920b(0x1f4),{'val':_0x10acd7,'ack':!![]}),await this[_0x3f920b(0x198)](_0x3f920b(0x25d),{'val':_0x55316f['activity']['alertReason']||'','ack':!![]}),await this[_0x3f920b(0x198)](_0x3f920b(0x1bb),{'val':_0x55316f[_0x3f920b(0x218)][_0x3f920b(0x242)]||'N/A','ack':!![]});const _0x3bf5af=_0x55316f[_0x3f920b(0x218)][_0x3f920b(0x1d7)]||![],_0x4b5a20=_0x55316f[_0x3f920b(0x218)]['isEmergency']||![];if(_0x3bf5af||_0x4b5a20){await this[_0x3f920b(0x198)]('analysis.isAlert',{'val':!![],'ack':!![]}),await this[_0x3f920b(0x198)](_0x3f920b(0x167),{'val':_0x4b5a20,'ack':!![]});if(!this[_0x3f920b(0x24f)]||_0x4b5a20){const _0x47a111=_0x4b5a20?'üö®üö®\x20NOTFALL':_0x3f920b(0x18c);this['sendNotification'](_0x47a111+':\x20'+_0x55316f[_0x3f920b(0x218)][_0x3f920b(0x1a7)],![],_0x4b5a20);}}else await this[_0x3f920b(0x198)](_0x3f920b(0x210),{'val':![],'ack':!![]}),await this[_0x3f920b(0x198)](_0x3f920b(0x167),{'val':![],'ack':!![]});this[_0x3f920b(0x24f)]=_0x3bf5af||_0x4b5a20;const _0x266dad={'timestamp':Date['now'](),'id':Date[_0x3f920b(0x186)]()['toString'](),'analysis':_0x55316f,'systemMode':_0x3cc7c1,'isPro':this['isProVersion']};this[_0x3f920b(0x172)](_0x266dad);}catch(_0xc65daa){this[_0x3f920b(0x11a)]['error'](_0x3f920b(0x1ac)+_0xc65daa['message']);}}async[a0_0x272bed(0x1d0)](){const _0x28b3b9=a0_0x272bed;if(!this['isProVersion'])return;await this[_0x28b3b9(0x198)](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()[_0x28b3b9(0x179)](),'ack':!![]});if(!this[_0x28b3b9(0x255)]||this[_0x28b3b9(0x202)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x28b3b9(0x198)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x54d885=JSON[_0x28b3b9(0x140)](JSON[_0x28b3b9(0x1c1)](this[_0x28b3b9(0x202)])),_0x438eb0=(this[_0x28b3b9(0x1c5)][_0x28b3b9(0x1d6)]||'')['substring'](0x0,0x3e8),_0x41420e=_0x28b3b9(0x1bc)+_0x438eb0+'.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON['stringify'](_0x54d885);try{const _0x3d3511=await this[_0x28b3b9(0x255)]['generateContent'](_0x41420e),_0xf70a54=JSON[_0x28b3b9(0x140)](_0x3d3511[_0x28b3b9(0x1b2)]['text']()[_0x28b3b9(0x129)](/```json|```/g,'')[_0x28b3b9(0x222)]());_0xf70a54['summary']&&(this[_0x28b3b9(0x1b4)]['push']({'timestamp':new Date()['toISOString'](),'eventCount':_0x54d885[_0x28b3b9(0x13c)],'summary':_0xf70a54[_0x28b3b9(0x242)],'activityLevel':_0xf70a54[_0x28b3b9(0x144)],'systemMode':this[_0x28b3b9(0x12a)]}),await this[_0x28b3b9(0x12d)](),this['rawEventLog']=[],await this[_0x28b3b9(0x233)](),await this[_0x28b3b9(0x198)](LTM_DP_STATUS,{'val':_0x28b3b9(0x139)+_0x54d885[_0x28b3b9(0x13c)]+_0x28b3b9(0x1ca),'ack':!![]}));}catch(_0x1fafc2){await this[_0x28b3b9(0x198)](LTM_DP_STATUS,{'val':_0x28b3b9(0x1fd)+_0x1fafc2['message'],'ack':!![]});}}async['createAllObjects'](){const _0x2952e5=a0_0x272bed;await this[_0x2952e5(0x157)](),await this['setObjectNotExistsAsync'](_0x2952e5(0x23a),{'type':_0x2952e5(0x15f),'common':{'name':_0x2952e5(0x16c),'type':'boolean','role':_0x2952e5(0x1d3),'read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x2952e5(0x188)]('events.lastEvent',{'type':_0x2952e5(0x15f),'common':{'name':_0x2952e5(0x1ba),'type':_0x2952e5(0x206),'role':_0x2952e5(0x12f),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2952e5(0x14c),{'type':_0x2952e5(0x15f),'common':{'name':_0x2952e5(0x1b5),'type':_0x2952e5(0x206),'role':_0x2952e5(0x12f),'read':!![],'write':![]},'native':{}}),await this[_0x2952e5(0x188)](_0x2952e5(0x15d),{'type':_0x2952e5(0x15f),'common':{'name':_0x2952e5(0x1be),'type':_0x2952e5(0x156),'role':_0x2952e5(0x1ad),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2952e5(0x1f4),{'type':'state','common':{'name':'Last\x20Result','type':_0x2952e5(0x206),'role':'json','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2952e5(0x210),{'type':'state','common':{'name':'AI\x20Alert\x20Status','type':_0x2952e5(0x156),'role':_0x2952e5(0x19e),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x2952e5(0x188)](_0x2952e5(0x167),{'type':_0x2952e5(0x15f),'common':{'name':'AI\x20Emergency\x20Status','type':_0x2952e5(0x156),'role':_0x2952e5(0x223),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x2952e5(0x188)](_0x2952e5(0x25d),{'type':'state','common':{'name':_0x2952e5(0x14d),'type':_0x2952e5(0x206),'role':_0x2952e5(0x204),'read':!![],'write':![]},'native':{}}),await this[_0x2952e5(0x188)]('analysis.activitySummary',{'type':_0x2952e5(0x15f),'common':{'name':'Activity\x20Summary','type':_0x2952e5(0x206),'role':'text','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2952e5(0x1c4),{'type':_0x2952e5(0x15f),'common':{'name':_0x2952e5(0x1fe),'type':_0x2952e5(0x206),'role':_0x2952e5(0x15f),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this[_0x2952e5(0x188)]('analysis.comfortSummary',{'type':_0x2952e5(0x15f),'common':{'name':'Comfort\x20Summary','type':_0x2952e5(0x206),'role':_0x2952e5(0x237),'read':!![],'write':![]},'native':{}}),await this[_0x2952e5(0x188)](_0x2952e5(0x1df),{'type':'state','common':{'name':_0x2952e5(0x1a5),'type':_0x2952e5(0x206),'role':_0x2952e5(0x237),'read':!![],'write':![]},'native':{}}),await this[_0x2952e5(0x225)](_0x2952e5(0x1f0),{'type':_0x2952e5(0x232),'common':{'name':_0x2952e5(0x1a3)},'native':{}}),await this[_0x2952e5(0x188)]('analysis.automation.patternDetected',{'type':_0x2952e5(0x15f),'common':{'name':_0x2952e5(0x19c),'type':'boolean','role':_0x2952e5(0x1d3),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x2952e5(0x188)](_0x2952e5(0x148),{'type':_0x2952e5(0x15f),'common':{'name':_0x2952e5(0x23e),'type':_0x2952e5(0x206),'role':_0x2952e5(0x237),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.automation.suggestedAction',{'type':_0x2952e5(0x15f),'common':{'name':_0x2952e5(0x12b),'type':_0x2952e5(0x206),'role':_0x2952e5(0x237),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2952e5(0x25a),{'type':_0x2952e5(0x15f),'common':{'name':'Logbook','type':_0x2952e5(0x206),'role':_0x2952e5(0x12f),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x2952e5(0x188)]('analysis.feedbackHistory',{'type':'state','common':{'name':_0x2952e5(0x18d),'type':_0x2952e5(0x206),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this['checkLtmObjects'](),await this[_0x2952e5(0x1c6)]();}async[a0_0x272bed(0x157)](){const _0x189d55=a0_0x272bed;await this['extendObjectAsync'](_0x189d55(0x187),{'type':_0x189d55(0x232),'common':{'name':_0x189d55(0x250)},'native':{}}),await this[_0x189d55(0x225)](SYSTEM_DP_MODE,{'type':_0x189d55(0x15f),'common':{'name':_0x189d55(0x132),'type':_0x189d55(0x206),'role':_0x189d55(0x15f),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x189d55(0x18f)],'states':{[SYSTEM_MODES[_0x189d55(0x18f)]]:_0x189d55(0x1e3),[SYSTEM_MODES[_0x189d55(0x1fa)]]:_0x189d55(0x257),[SYSTEM_MODES['PARTY']]:_0x189d55(0x21d),[SYSTEM_MODES[_0x189d55(0x127)]]:_0x189d55(0x134)}},'native':{}});}async[a0_0x272bed(0x213)](_0x3ba61d,_0x309a2f=![],_0x3040b7=![]){const _0xc352eb=a0_0x272bed;this[_0xc352eb(0x11a)]['info']((_0x309a2f?_0xc352eb(0x1c0):'')+_0xc352eb(0x1c2)+_0x3ba61d+'\x22'+(_0x3040b7?'\x20(EMERGENCY)':''));const _0x2b6e8c=this[_0xc352eb(0x1c5)];let _0x4125ea=0x0;_0x2b6e8c['notifyTelegramEnabled']&&_0x2b6e8c[_0xc352eb(0x1da)]&&(await this[_0xc352eb(0x1fc)](_0x2b6e8c[_0xc352eb(0x1da)],_0xc352eb(0x1a4),{'text':_0x3ba61d,'user':_0x2b6e8c[_0xc352eb(0x152)]}),_0x4125ea++);if(_0x2b6e8c[_0xc352eb(0x248)]&&_0x2b6e8c[_0xc352eb(0x1cd)]){let _0x5cd8e8={'message':_0x3ba61d,'title':_0x3040b7?_0xc352eb(0x1d4):_0xc352eb(0x159),'priority':_0x3040b7?0x2:0x1,'device':_0x2b6e8c['notifyPushoverRecipient']};_0x3040b7&&(_0x5cd8e8['retry']=0x1e,_0x5cd8e8[_0xc352eb(0x16f)]=0xe10,_0x5cd8e8[_0xc352eb(0x177)]='siren'),await this[_0xc352eb(0x1fc)](_0x2b6e8c[_0xc352eb(0x1cd)],_0xc352eb(0x1a4),_0x5cd8e8),_0x4125ea++;}return _0x2b6e8c['notifyEmailEnabled']&&_0x2b6e8c['notifyEmailInstance']&&(await this[_0xc352eb(0x1fc)](_0x2b6e8c[_0xc352eb(0x239)],_0xc352eb(0x1a4),{'text':_0x3ba61d,'to':_0x2b6e8c[_0xc352eb(0x17d)]}),_0x4125ea++),_0x2b6e8c[_0xc352eb(0x14e)]&&_0x2b6e8c[_0xc352eb(0x236)]&&(await this[_0xc352eb(0x1fc)](_0x2b6e8c[_0xc352eb(0x236)],_0xc352eb(0x1a4),{'text':_0x3ba61d,'phone':_0x2b6e8c['notifyWhatsappRecipient']}),_0x4125ea++),_0x2b6e8c[_0xc352eb(0x22a)]&&_0x2b6e8c[_0xc352eb(0x17c)]&&(await this[_0xc352eb(0x1fc)](_0x2b6e8c['notifySignalInstance'],_0xc352eb(0x1a4),{'text':_0x3ba61d,'phone':_0x2b6e8c['notifySignalRecipient']}),_0x4125ea++),_0x4125ea;}async[a0_0x272bed(0x1e2)](){const _0x2d680c=a0_0x272bed;try{const _0x150319=await this[_0x2d680c(0x230)](LTM_DP_RAW_LOG);if(_0x150319&&_0x150319[_0x2d680c(0x1e9)])this['rawEventLog']=JSON[_0x2d680c(0x140)](_0x150319['val']);}catch(_0x59b047){this[_0x2d680c(0x202)]=[];}}async[a0_0x272bed(0x233)](){const _0x897906=a0_0x272bed;this['rawEventLog'][_0x897906(0x13c)]>RAW_LOG_MAX_SIZE&&this[_0x897906(0x202)]['splice'](0x0,this['rawEventLog']['length']-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x897906(0x1c1)](this['rawEventLog']),'ack':!![]});}async['loadDailyDigests'](){const _0x40b10c=a0_0x272bed;try{const _0x4633ca=await this[_0x40b10c(0x230)](LTM_DP_DAILY_DIGESTS);if(_0x4633ca&&_0x4633ca[_0x40b10c(0x1e9)])this[_0x40b10c(0x1b4)]=JSON[_0x40b10c(0x140)](_0x4633ca['val']);}catch(_0x156adf){this[_0x40b10c(0x1b4)]=[];}await this[_0x40b10c(0x22f)]();}async[a0_0x272bed(0x12d)](_0xe8b042=!![]){const _0x278528=a0_0x272bed,_0x25d997=this[_0x278528(0x1c5)][_0x278528(0x24d)]||0x3c;this[_0x278528(0x1b4)]['length']>_0x25d997&&this[_0x278528(0x1b4)][_0x278528(0x24b)](0x0,this[_0x278528(0x1b4)][_0x278528(0x13c)]-_0x25d997);await this[_0x278528(0x198)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x278528(0x1c1)](this['dailyDigests']),'ack':!![]});if(_0xe8b042)await this[_0x278528(0x22f)]();}[a0_0x272bed(0x1ee)](){const _0x2ffeca=a0_0x272bed;if(this[_0x2ffeca(0x1e1)])this[_0x2ffeca(0x1e1)][_0x2ffeca(0x12c)]();if(!this[_0x2ffeca(0x15a)]){this[_0x2ffeca(0x198)](LTM_DP_STATUS,{'val':_0x2ffeca(0x181),'ack':!![]});return;}this[_0x2ffeca(0x1e1)]=schedule[_0x2ffeca(0x125)](LTM_SCHEDULE,()=>this[_0x2ffeca(0x1d0)]());}[a0_0x272bed(0x212)](){const _0x3afe2e=a0_0x272bed;if(this[_0x3afe2e(0x122)])clearInterval(this[_0x3afe2e(0x122)]);if(!this[_0x3afe2e(0x15a)])return;this[_0x3afe2e(0x122)]=setInterval(()=>this[_0x3afe2e(0x267)](),(this[_0x3afe2e(0x1c5)][_0x3afe2e(0x221)]||0x18)*0x36ee80),setTimeout(()=>this['runBaselineDriftAnalysis'](),0x1388);}async['resetAnalysisStates'](){const _0x35fb42=a0_0x272bed;await this[_0x35fb42(0x198)](_0x35fb42(0x1bb),{'val':_0x35fb42(0x249),'ack':!![]}),await this['setStateAsync'](_0x35fb42(0x1c4),{'val':this[_0x35fb42(0x15a)]?_0x35fb42(0x183):_0x35fb42(0x25c),'ack':!![]}),await this[_0x35fb42(0x198)](_0x35fb42(0x210),{'val':![],'ack':!![]}),await this['setStateAsync']('analysis.isEmergency',{'val':![],'ack':!![]}),this[_0x35fb42(0x24f)]=![];}async['updateAnalysisHistory'](_0x16653f){const _0x4e6eb3=a0_0x272bed;this[_0x4e6eb3(0x1dd)][_0x4e6eb3(0x1d1)](_0x16653f);if(this['analysisHistory'][_0x4e6eb3(0x13c)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x4e6eb3(0x1dd)][_0x4e6eb3(0x1fb)]();await this[_0x4e6eb3(0x198)](_0x4e6eb3(0x25a),{'val':JSON[_0x4e6eb3(0x1c1)](this[_0x4e6eb3(0x1dd)]),'ack':!![]});}[a0_0x272bed(0x143)](){const _0x4f4d20=a0_0x272bed;if(this[_0x4f4d20(0x15e)])this[_0x4f4d20(0x15e)]['cancel']();this['modeResetJob']=schedule[_0x4f4d20(0x125)](MODE_RESET_SCHEDULE,async()=>{const _0x289df0=_0x4f4d20;await this[_0x289df0(0x20d)](),AUTO_RESET_MODES[_0x289df0(0x252)](this[_0x289df0(0x12a)])&&await this[_0x289df0(0x198)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x289df0(0x18f)],'ack':![]});});}async[a0_0x272bed(0x22f)](){const _0x450dd6=a0_0x272bed;if(!this[_0x450dd6(0x15a)]){await this[_0x450dd6(0x198)](LTM_DP_BASELINE_STATUS,{'val':_0x450dd6(0x181),'ack':!![]});return;}const _0x346b88=this[_0x450dd6(0x1b4)]['length']>=(this[_0x450dd6(0x1c5)][_0x450dd6(0x16d)]||0x7)?'Aktiv\x20('+this[_0x450dd6(0x1b4)]['length']+'\x20Tage)':_0x450dd6(0x229)+this['dailyDigests'][_0x450dd6(0x13c)]+'/'+(this[_0x450dd6(0x1c5)][_0x450dd6(0x16d)]||0x7)+')';await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x346b88,'ack':!![]});}async[a0_0x272bed(0x173)](){const _0x3db983=a0_0x272bed;await this[_0x3db983(0x225)](_0x3db983(0x23f),{'type':_0x3db983(0x232),'common':{'name':_0x3db983(0x23f)},'native':{}}),await this[_0x3db983(0x225)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x3db983(0x169),'type':_0x3db983(0x206),'role':_0x3db983(0x12f),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x3db983(0x261),'type':_0x3db983(0x206),'role':_0x3db983(0x12f),'read':!![],'write':![]},'native':{}}),await this[_0x3db983(0x225)](LTM_DP_STATUS,{'type':_0x3db983(0x15f),'common':{'name':'Processing\x20Status','type':_0x3db983(0x206),'role':'text','read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x3db983(0x15f),'common':{'name':_0x3db983(0x1d9),'type':_0x3db983(0x156),'role':_0x3db983(0x1ad),'read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x3db983(0x15f),'common':{'name':_0x3db983(0x25b),'type':_0x3db983(0x206),'role':'text','read':!![],'write':![]},'native':{}});}async['checkLtmDriftObjects'](){const _0x484078=a0_0x272bed;await this[_0x484078(0x225)](LTM_DP_DRIFT_CHANNEL,{'type':_0x484078(0x232),'common':{'name':_0x484078(0x22c)},'native':{}}),await this[_0x484078(0x225)](LTM_DP_DRIFT_STATUS,{'type':_0x484078(0x15f),'common':{'name':_0x484078(0x265),'type':_0x484078(0x206),'role':'state','read':!![],'write':![],'def':_0x484078(0x128)},'native':{}}),await this[_0x484078(0x225)](LTM_DP_DRIFT_DETAILS,{'type':_0x484078(0x15f),'common':{'name':'Drift\x20Details','type':_0x484078(0x206),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x484078(0x225)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x484078(0x15f),'common':{'name':_0x484078(0x205),'type':'number','role':_0x484078(0x207),'read':!![],'write':![]},'native':{}});}async[a0_0x272bed(0x267)](){const _0x2dfa95=a0_0x272bed;if(!this[_0x2dfa95(0x15a)]||!this[_0x2dfa95(0x255)])return;const _0x2b71e2=this[_0x2dfa95(0x1c5)][_0x2dfa95(0x24e)]||0xe;if(this[_0x2dfa95(0x1b4)][_0x2dfa95(0x13c)]<_0x2b71e2+(this[_0x2dfa95(0x1c5)]['minDaysForBaseline']||0x7)){await this[_0x2dfa95(0x198)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x49a650=this[_0x2dfa95(0x1b4)][_0x2dfa95(0x197)](-_0x2b71e2),_0x5a78ce=this[_0x2dfa95(0x1b4)][_0x2dfa95(0x197)](0x0,this['dailyDigests'][_0x2dfa95(0x13c)]-_0x2b71e2),_0x2d8507=_0x2dfa95(0x264)+JSON['stringify'](_0x5a78ce)+'\x0a\x0aA\x20(STB):\x0a'+JSON['stringify'](_0x49a650);try{const _0x373324=await this[_0x2dfa95(0x255)][_0x2dfa95(0x20c)](_0x2d8507),_0x7324a4=JSON[_0x2dfa95(0x140)](_0x373324['response'][_0x2dfa95(0x237)]()[_0x2dfa95(0x129)](/```json|```/g,'')[_0x2dfa95(0x222)]());_0x7324a4[_0x2dfa95(0x146)]&&(await this[_0x2dfa95(0x198)](LTM_DP_DRIFT_STATUS,{'val':_0x7324a4[_0x2dfa95(0x146)],'ack':!![]}),await this[_0x2dfa95(0x198)](LTM_DP_DRIFT_DETAILS,{'val':_0x7324a4[_0x2dfa95(0x25e)],'ack':!![]}),await this[_0x2dfa95(0x198)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x1fbe2c){}}async[a0_0x272bed(0x20d)](){const _0xcba55b=a0_0x272bed;try{const _0x382a93=await this[_0xcba55b(0x230)](SYSTEM_DP_MODE);_0x382a93&&_0x382a93[_0xcba55b(0x1e9)]&&Object['values'](SYSTEM_MODES)[_0xcba55b(0x252)](_0x382a93[_0xcba55b(0x1e9)])?this[_0xcba55b(0x12a)]=_0x382a93[_0xcba55b(0x1e9)]:(this[_0xcba55b(0x12a)]=SYSTEM_MODES[_0xcba55b(0x18f)],await this[_0xcba55b(0x198)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0xcba55b(0x18f)],'ack':!![]}));}catch(_0x1c3495){this['currentSystemMode']=SYSTEM_MODES['NORMAL'];}}async[a0_0x272bed(0x16e)](){const _0x13fe37=a0_0x272bed;try{const _0x3755b3=await this[_0x13fe37(0x14f)](_0x13fe37(0x243));if(_0x3755b3&&_0x3755b3[_0x13fe37(0x138)]&&_0x3755b3[_0x13fe37(0x138)]['uuid'])return _0x3755b3[_0x13fe37(0x138)][_0x13fe37(0x1db)];return _0x13fe37(0x1eb);}catch(_0x2954d1){return'uuid-error';}}async[a0_0x272bed(0x22b)](_0x476a32){const _0x10729c=a0_0x272bed;if(!_0x476a32)return![];this['systemUUID']=await this[_0x10729c(0x16e)]();if(_0x476a32===_0x10729c(0x1f6)||_0x476a32[_0x10729c(0x149)]('PRO-'))return!![];return![];}[a0_0x272bed(0x1ab)](_0x1abd9c){const _0x11b0d0=a0_0x272bed;if(this['analysisTimer'])clearInterval(this[_0x11b0d0(0x13d)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x11b0d0(0x122)]);if(this[_0x11b0d0(0x1e1)])this[_0x11b0d0(0x1e1)]['cancel']();if(this[_0x11b0d0(0x15e)])this['modeResetJob'][_0x11b0d0(0x12c)]();if(this[_0x11b0d0(0x262)])clearTimeout(this['exitTimer']);if(this['exitGraceTimer'])clearTimeout(this['exitGraceTimer']);_0x1abd9c();}async[a0_0x272bed(0x17a)](_0x2d025f){const _0x5cc605=a0_0x272bed;if(typeof _0x2d025f===_0x5cc605(0x1a9)&&_0x2d025f[_0x5cc605(0x13f)]){if(_0x2d025f[_0x5cc605(0x11d)]===_0x5cc605(0x171)){if(!_0x2d025f[_0x5cc605(0x13f)][_0x5cc605(0x20e)])return this[_0x5cc605(0x1ae)](_0x2d025f[_0x5cc605(0x1ef)],_0x2d025f[_0x5cc605(0x11d)],{'success':![],'message':_0x5cc605(0x1de)},_0x2d025f['callback']);try{const _0x55026c=new GoogleGenerativeAI(_0x2d025f[_0x5cc605(0x13f)][_0x5cc605(0x20e)])[_0x5cc605(0x235)]({'model':_0x5cc605(0x123)});await _0x55026c[_0x5cc605(0x20c)]('test'),this['sendTo'](_0x2d025f[_0x5cc605(0x1ef)],_0x2d025f[_0x5cc605(0x11d)],{'success':!![],'message':_0x5cc605(0x200)},_0x2d025f[_0x5cc605(0x1a2)]);}catch(_0x11e20e){this[_0x5cc605(0x1ae)](_0x2d025f[_0x5cc605(0x1ef)],_0x2d025f[_0x5cc605(0x11d)],{'success':![],'message':_0x11e20e[_0x5cc605(0x13f)]},_0x2d025f[_0x5cc605(0x1a2)]);}}else{if(_0x2d025f[_0x5cc605(0x11d)]===_0x5cc605(0x153)){const _0xfbdb95=await this[_0x5cc605(0x213)](_0x5cc605(0x176),!![]);this['sendTo'](_0x2d025f['from'],_0x2d025f[_0x5cc605(0x11d)],{'success':_0xfbdb95>0x0,'message':_0xfbdb95+_0x5cc605(0x1d2)},_0x2d025f[_0x5cc605(0x1a2)]);}else{if(_0x2d025f[_0x5cc605(0x11d)]==='getLtmData'){if(!this['isProVersion'])return this[_0x5cc605(0x1ae)](_0x2d025f['from'],_0x2d025f[_0x5cc605(0x11d)],{'success':![],'isPro':![]},_0x2d025f['callback']);let _0x273dd3={'status':_0x5cc605(0x128),'details':'','lastCheck':0x0};try{_0x273dd3[_0x5cc605(0x211)]=(await this[_0x5cc605(0x230)](LTM_DP_DRIFT_STATUS))[_0x5cc605(0x1e9)],_0x273dd3[_0x5cc605(0x21f)]=(await this[_0x5cc605(0x230)](LTM_DP_DRIFT_DETAILS))[_0x5cc605(0x1e9)],_0x273dd3[_0x5cc605(0x194)]=(await this[_0x5cc605(0x230)](LTM_DP_DRIFT_LAST_CHECK))[_0x5cc605(0x1e9)];}catch(_0x8408f){}this[_0x5cc605(0x1ae)](_0x2d025f[_0x5cc605(0x1ef)],_0x2d025f[_0x5cc605(0x11d)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x5cc605(0x1b4)],'driftAnalysis':_0x273dd3,'analysisHistory':this[_0x5cc605(0x1dd)]},_0x2d025f['callback']);}else{if(_0x2d025f['command']===_0x5cc605(0x13e)){const _0x4c69bb=await this[_0x5cc605(0x1b9)](_0x5cc605(0x1aa),_0x5cc605(0x121)),_0x1c08d2=[];if(_0x4c69bb)for(const _0x164832 in _0x4c69bb){const _0x578752=_0x4c69bb[_0x164832],_0x4f7ad1=(_0x578752[_0x5cc605(0x251)]&&typeof _0x578752[_0x5cc605(0x251)]['name']===_0x5cc605(0x1a9)?_0x578752[_0x5cc605(0x251)][_0x5cc605(0x20f)]['de']:_0x578752[_0x5cc605(0x251)][_0x5cc605(0x20f)])||_0x578752['common'][_0x5cc605(0x20f)];_0x1c08d2[_0x5cc605(0x196)]({'id':_0x164832,'name':_0x4f7ad1});}this['sendTo'](_0x2d025f[_0x5cc605(0x1ef)],_0x2d025f[_0x5cc605(0x11d)],{'success':!![],'enums':_0x1c08d2},_0x2d025f['callback']);}else{if(_0x2d025f[_0x5cc605(0x11d)]==='scanDevices'){this[_0x5cc605(0x11a)]['info']('Received\x20scanDevices\x20request\x20from\x20Admin\x20UI.');const _0x50f90f=_0x2d025f[_0x5cc605(0x13f)]||{};try{const _0x5a104e=await this['scanForDevices'](_0x50f90f);this['sendTo'](_0x2d025f[_0x5cc605(0x1ef)],_0x2d025f['command'],{'success':!![],'devices':_0x5a104e},_0x2d025f[_0x5cc605(0x1a2)]);}catch(_0x5f215b){this[_0x5cc605(0x1ae)](_0x2d025f[_0x5cc605(0x1ef)],_0x2d025f[_0x5cc605(0x11d)],{'success':![],'error':_0x5f215b['message']},_0x2d025f[_0x5cc605(0x1a2)]);}}else{if(_0x2d025f[_0x5cc605(0x11d)]===_0x5cc605(0x1f5)){const {historyId:_0x2a238f,rating:_0x50374e,comment:_0x1913b6,alertReason:_0x18dc56}=_0x2d025f[_0x5cc605(0x13f)];_0x2a238f&&_0x50374e?(await this[_0x5cc605(0x145)]({'timestamp':Date[_0x5cc605(0x186)](),'historyId':_0x2a238f,'rating':_0x50374e,'comment':_0x1913b6,'alertReason':_0x18dc56}),this[_0x5cc605(0x1ae)](_0x2d025f['from'],_0x2d025f[_0x5cc605(0x11d)],{'success':!![]},_0x2d025f['callback'])):this[_0x5cc605(0x1ae)](_0x2d025f['from'],_0x2d025f[_0x5cc605(0x11d)],{'success':![],'error':_0x5cc605(0x18b)},_0x2d025f['callback']);}}}}}}}}}function a0_0xa543(_0x365e8c,_0x5038e9){const _0x3fb244=a0_0x3848();return a0_0xa543=function(_0x346797,_0x172f4a){_0x346797=_0x346797-0x11a;let _0x384804=_0x3fb244[_0x346797];return _0x384804;},a0_0xa543(_0x365e8c,_0x5038e9);}function a0_0x3848(){const _0x5886c0=['Haust√ºr\x20Event:\x20Starte\x20Exit-Logik\x20(','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','setPresence','native','Success:\x20Compressed\x20','constructor','LTM.rawEventLog','length','analysisTimer','getEnums','message','parse','values','1297900wlaQtu','setupModeResetScheduler','activityLevel','saveFeedback','baselineDrift','Adapter','analysis.automation.description','startsWith','guest','.\x20PR√ÑSENZ:\x20','events.history','Alert\x20Reason','notifyWhatsappEnabled','getForeignObjectAsync','latitude','340vNrktK','notifyTelegramRecipient','testNotification','find','Starting\x20Autopilot\x20(','boolean','checkSystemObjects','\x20Stunden!','Cogni-Living\x20Alert','isProVersion','location','warn','analysis.trigger','modeResetJob','state','1287HjHfhv','(((.+)+)+)+$','info','Manual\x20Analysis\x20Trigger\x20detected!','2-digit','bind','toString','analysis.isEmergency','runAutopilot','Raw\x20Log','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','37732qyvYuK','Presence\x20Status','minDaysForBaseline','getSystemUUID','expire','LTM.triggerDailyDigest','testApiKey','updateAnalysisHistory','checkLtmObjects','onStateChange','sensorLastValues','[Test]\x20Notification','sound','üö®\x20Dead\x20Man\x27s\x20Switch:\x20Keine\x20Aktivit√§t\x20seit\x20','toLocaleString','onMessage','isPresent','notifySignalInstance','notifyEmailRecipient','getForeignStateAsync','LTM.driftAnalysis.baselineDrift','cleanUpZombies','Deaktiviert\x20(Pro-Feature)','geminiApiKey','N/A\x20(No\x20Activity)','isGracePeriodActive','search','now','system','setObjectNotExistsAsync','loadHistoryFromState','72927ZhouzK','Missing\x20data','‚ö†Ô∏è\x20Alarm','Feedback\x20Log','LTM.driftAnalysis.driftDetails','NORMAL','596172pxApIG','2ndpzRa','ack','debug','lastCheck','LTM.driftAnalysis','push','slice','setStateAsync','system.mode','catch','Pr√§senz-Status\x20ge√§ndert:\x20','Pattern\x20Detected','.\x20ORT:\x20','indicator.alarm','LTM.driftAnalysis.lastCheck','exports','toISOString','callback','Automation\x20Proposals','send','Comfort\x20Suggestion','\x20events\x20from\x20history.','alertReason','664QbIuvH','object','enum.functions.*','onUnload','Analysis\x20Error:\x20','button','sendTo','error','exitGraceTimer','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','response','Gemini\x20API\x20Key\x20missing.\x20AI\x20features\x20disabled.','dailyDigests','Event\x20History','s\x20Grace).','normal','analysis.history_debug_00','getForeignObjectsAsync','Last\x20raw\x20event','analysis.activitySummary','ROLLE:\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20KONTEXT:\x20','79932PujGWL','Trigger\x20Analysis','namespace','[TEST]\x20','stringify','Sending\x20notification:\x20\x22','loadDailyDigests','analysis.deviationFromBaseline','config','checkLtmDriftObjects','events.history_debug_03','delObjectAsync','ANWESEND\x20üè†','\x20events','runGeminiAnalysis','analysis.history_debug_04','notifyPushoverInstance','events.history_debug_02','processSensorEvent','createDailyDigest','unshift','\x20sent','indicator','üö®\x20EMERGENCY','ü§ñ\x20Starting\x20Gemini\x20Analysis...','livingContext','isAlert','Ignoring\x20event\x20during\x20Exit\x20Grace\x20Period:\x20','Trigger\x20Digest','notifyTelegramInstance','uuid','onReady','analysisHistory','No\x20Key','analysis.comfortSuggestion','toLowerCase','ltmJob','loadRawEventLog','Normal','cogni-living','type','version','cogni-living\x20adapter\x20starting\x20(v','Gemini\x20AI\x20initialized.','val','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','uuid-not-found','devices','setState','setupLtmScheduler','from','analysis.automation','üìç\x20Standort\x20geladen:\x20','24010YAGUPy','startExitTimer','analysis.lastResult','submitFeedback','TEST-PRO-KEY','Gemini\x20Init\x20Error:\x20','apply','events.history_debug_01','VACATION','pop','sendToAsync','Error:\x20','Deviation','15UghpyK','Success','ABWESEND\x20‚úàÔ∏è','rawEventLog','licenseKey','text.alarm','Last\x20Check','string','date','Baseline:\x20Inactive\x20(Pro\x20Feature).','systemConfig','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','Exit\x20Grace\x20Period\x20beendet.\x20√úberwache\x20nun\x20Innenraum...','generateContent','loadSystemMode','apiKey','name','analysis.isAlert','status','setupDriftAnalysisScheduler','sendNotification','\x0aFEEDBACK:\x0a','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','party','\x20min).\x20Watchdog\x20Limit:\x20','activity','analysis.history_debug_03','Konnte\x20System-Standort\x20nicht\x20laden.','‚úÖ\x20Gemini\x20Response\x20received.','systemUUID','Party','toFixed','details','feedbackHistory','ltmDriftCheckIntervalHours','trim','indicator.alarm.fire','long','extendObjectAsync','inactivityThresholdHours','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','analysis.history_debug_02','Lernphase\x20(','notifySignalEnabled','checkLicense','Drift\x20Analysis','ready','analysisInterval','updateBaselineStatus','getStateAsync','join','channel','saveRawEventLog','rating','getGenerativeModel','notifyWhatsappInstance','text','subscribeStates','notifyEmailInstance','system.isPresent','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20}\x20}','eingang','0\x203\x20*\x20*\x20*','Description','LTM','418OVNVsw','Exit-Timer\x20abgelaufen:\x20Keine\x20Bewegung\x20innen\x20erkannt\x20->\x20ABWESEND.','summary','system.meta.uuid','eventHistory','longitude','LTM.baselineStatus','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','notifyPushoverEnabled','No\x20recent\x20activity.','min\x20Timer,\x20','splice','LTM.processingStatus','ltmLtbWindowDays','ltmStbWindowDays','lastAlertState','System\x20Status\x20&\x20Control','common','includes','createAllObjects','\x22\x20was\x20','geminiModel','map','Urlaub','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','analysis.analysisHistory','Baseline\x20Status','N/A\x20(Pro\x20Feature)','analysis.alertReason','driftDetails','No\x20recorded\x20events\x20yet.','User\x20Feedback:\x20Alarm\x20\x22','Daily\x20Digests','exitTimer','vacation','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','Drift\x20Status','genAI','runBaselineDriftAnalysis','log','\x20sensors...','events.lastEvent','command','events.history_debug_00','node-schedule','Loaded\x20','enum','driftAnalysisTimer','models/gemini-flash-latest','city','scheduleJob','haust√ºr','GUEST','N/A','replace','currentSystemMode','Action','cancel','saveDailyDigests','flur','json','‚ùå\x20Gemini\x20Model\x20not\x20initialized!\x20Check\x20API\x20Key.','abortExitTimer','System\x20Mode','events.history_debug_04','Gast'];a0_0x3848=function(){return _0x5886c0;};return a0_0x3848();}if(require['main']!==module)module[a0_0x272bed(0x1a0)]=_0x576ced=>new CogniLiving(_0x576ced);else new CogniLiving();