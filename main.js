const a0_0x18625a=a0_0x3148;(function(_0x449ec7,_0xd670b5){const _0x3786f7=a0_0x3148,_0x2a7bd8=_0x449ec7();while(!![]){try{const _0x45fe77=-parseInt(_0x3786f7(0x307))/0x1*(-parseInt(_0x3786f7(0x319))/0x2)+parseInt(_0x3786f7(0x3c4))/0x3+-parseInt(_0x3786f7(0x1ea))/0x4*(-parseInt(_0x3786f7(0x286))/0x5)+-parseInt(_0x3786f7(0x2be))/0x6*(-parseInt(_0x3786f7(0x24a))/0x7)+parseInt(_0x3786f7(0x2d0))/0x8*(-parseInt(_0x3786f7(0x1d4))/0x9)+parseInt(_0x3786f7(0x3c1))/0xa*(parseInt(_0x3786f7(0x37a))/0xb)+-parseInt(_0x3786f7(0x268))/0xc;if(_0x45fe77===_0xd670b5)break;else _0x2a7bd8['push'](_0x2a7bd8['shift']());}catch(_0x3dec1){_0x2a7bd8['push'](_0x2a7bd8['shift']());}}}(a0_0x5478,0x6f432));const a0_0x6b8a06=(function(){let _0xe7a48f=!![];return function(_0x2443a3,_0x33cfab){const _0x53ab27=_0xe7a48f?function(){const _0x994cde=a0_0x3148;if(_0x33cfab){const _0x47fb2f=_0x33cfab[_0x994cde(0x3cd)](_0x2443a3,arguments);return _0x33cfab=null,_0x47fb2f;}}:function(){};return _0xe7a48f=![],_0x53ab27;};}()),a0_0x52c98e=a0_0x6b8a06(this,function(){const _0x561bce=a0_0x3148;return a0_0x52c98e['toString']()[_0x561bce(0x2c8)]('(((.+)+)+)+$')[_0x561bce(0x22f)]()[_0x561bce(0x2d9)](a0_0x52c98e)[_0x561bce(0x2c8)](_0x561bce(0x3c5));});function a0_0x5478(){const _0x523325=['push','AI\x20Training\x20Control','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','sleepScore','schalter','Training\x20only\x20available\x20in\x20Pro\x20Version.','.Summary.Current','daswetter.0','LTM.dailyDigests','toLocaleString','indicator','Guardian:\x20Sending\x20','summary','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','Health\x20Notes','setObjectNotExistsAsync','GUEST','number','unshift','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','COGNI_REQUEST_CALL','\x22\x20--break-system-packages\x20--user','Description','text','online','LTM.trainingData.thermodynamics','lights','Aktiv\x20(','\x20*\x20*\x20*','ltmJob','accuweather.0','771791kqDqad','LTM.driftAnalysis.driftDetails','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','isPresent','\x20presence\x20devices...','Kalender:\x20Deaktiviert','stderr','onReady','models/gemini-flash-latest','callback','Last\x20raw\x20event','genAI','system','weatherInstance','Briefing\x20Error:\x20','flot.','daswetter','some','2HUbrmg','LTM.rawEventLog','native','value.health','minDaysForBaseline','communicate.request','occupancy','âœ…\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','config_pending','onStateChange','payload','Error:\x20','08:00','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','city','inactivityMonitoringEnabled','targetposition','analysis.automation.autoApply','Automation\x20Proposals','Lernphase\x20(','Activity-Level','WETTER\x20ERROR:\x20','\x22\x20--break-system-packages','getForeignStateAsync','valve','analysis.triggerBriefing','getTime','analysis.feedbackHistory','No\x20Data','ANALYZE_TREND','write','child_process','Gemini\x20AI\x20initialized.','includes','val','analysis.health.trendDiagnosis','Drift\x20Status','ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','Target\x20Value','lowbat','testContext','split','firmware','system.config','role','values','channel','writable','klima','setpoint','endsWith','position','bind','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','.\x20DATEN:\x20Schlaf\x20','Raw\x20Log','analysis.history_debug_00','getEnums','Comfort\x20Summary','weather','\x20(Value\x20is\x20falsy:\x20','custom','.forecast.current.temp','getFullYear','Normal','Processing\x20Status','location','Morning\x20Briefing\x20sent.','LTM.trainingData','Alert\x20Reason','Kein\x20API\x20Key\x20eingegeben.','testNotification','sensorLastValues','switch','driftAnalysisTimer','openweathermap','material.','baselineDrift','debug','driftDetails','feedbackHistory','calendarInstance','analysis.automation.targetId','value','getCalendarNames','âŒ\x20Training\x20failed:\x20','analysis.comfortSummary','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','notifyTelegramRecipient','Restlessness\x20Level','Could\x20not\x20kill\x20Python\x20process:\x20','common','toLocaleTimeString','currentSystemMode','IGNORING\x20DUPLICATE\x20(Cached):\x20','33TfHFaV','Logbook','LTM.triggerDailyDigest','analysis.isEmergency','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','window','info.','Training\x20Data\x20Sets','analysis.automation.patternDetected','openweathermap.0','.NextHours.Location_1.Day_1.current.temp_value','@google/generative-ai','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','details','button','notifyPushoverInstance','extendObjectAsync','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','Skipped\x20(No\x20AI\x20or\x20Data)','\x20(Length:\x20','lastAlertState','object','fenster','KI-Modell\x20nicht\x20initialisiert','analysis.training.triggerSecurity','string','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','[RESULT]','âŒ\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.','system.presenceWho','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','notifyEmailInstance','Exit\x20Sensor\x20triggered\x20(','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','.\x20ZUSATZ:\x20','âŒ\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20','targetId','LTM.driftAnalysis','setHours','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','Trend\x20Value\x20(%)','Analysiere\x20ausgewogen.','Error\x20reading\x20calendar\x20table:\x20','exports','N/A','Failed:\x20','N/A\x20(Learning)','main','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','ðŸŒ…\x20Daily\x20Briefing:\x0a','System\x20Mode','Trigger\x20Briefing\x20(Test)','getMonth','Thermodynamic\x20Data\x20Points','Scheduling\x20Morning\x20Briefing\x20for\x20','analysis.automation.description','cogni-living\x20adapter\x20starting\x20(v','unload','Alarm','.Current.Temperature','LTM.baselineStatus','version','command','connection','startsWith','PRO-','dependencyInstallInProgress','systemUUID','length','event','pop','494830RQbuIV','lampe','system.','1010928YLYsXC','(((.+)+)+)+$','.forecast.current.temperature','temperature','guest','setState','map','temp','onMessage','apply','cancel','Training\x20started...','.\x0a\x20\x20\x20\x20WETTER:\x20','latitude','events.history_debug_00','slice','Pattern\x20Detected','_calName','\x20(Type\x20\x27','config','time','NORMAL','User\x20dismissed\x20automation\x20proposal.','send','analysisHistory','analysis.health','Invalid\x20JSON\x20from\x20Python:\x20','Activity\x20Summary','fill','ready','icons-mfd.','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','notifyEmailEnabled','telegram','livingContext','setForeignStateAsync','shift','actual_temperature','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','contact','rollladen','briefingJob','sensor','isGracePeriodActive','getCalendarNames\x20Error:\x20','LTM.driftAnalysis.lastCheck','Fehler:\x20','Unknown','state','vis.','analysis.activitySummary','_score','Say\x20Hello','isArray','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','getDate','45wfYwMJ','[PYTHON]\x20','[PYTHON\x20ERR]\x20','detected','devices','admin.','fault','[LOG]','TRAINING_COMPLETE','alertReason','generateContent','\x20sensors...','sendToAsync','info','analysisTimer','ðŸ\x20Stopping\x20Python\x20Sidecar...','geminiModel','Briefing\x20Sched\x20Error:\x20','No\x20instance','useWeather','exitTimer','.communicate.request','2148PgTjoW','geminiApiKey','\x20Tage)','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','.\x0a\x20\x20\x20\x20ANWESENDE_GERAETE:\x20','\x20events)...','analysis.isAlert','isAlert','generic','\x20(Value:\x20','error','dailyDigests','Adapter','heizung','uuid','getHours','doors','licht','uuid-error','presenceDevices','temperatur','stdout','weatherunderground.0','kill','getForeignObjectAsync','instance','longitude','.\x20OUTPUT:\x20Nur\x20Text.','message','scheduleJob','unknown','Urlaub','Starting\x20Autopilot\x20(','subscribeForeignStatesAsync','âœ…\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20','none','Verbindung\x20erfolgreich!\x20Antwort:\x20','automationProposal','date','\x20days\x20of\x20activity\x20data\x20to\x20Python...','blind','Error\x20checking\x20WiFi:\x20','siren','Trigger\x20Digest',').\x20Starting\x20Timer.','maintenance','Deviation','tÃ¼r','Bibliotheken\x20nicht\x20gefunden','Gemini\x20Analysis\x20Error:\x20','scanDevices','echarts.','direction','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','door','.\x20KONTEXT:\x20','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','trim','level','subscribeStates','getGenerativeModel','activityLevel','calendarSelection','from','Training\x20Status','licenseKey','Action','getStateAsync','analysis.health.trendValue','toString','exitGraceTimer','scriptProblem','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','AI\x20Emergency\x20Status','presence','type','isProVersion','outdoorSensorId','ltmDriftCheckIntervalHours','No\x20module\x20named','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Train\x20Security\x20Model\x20(LSTM)','targetValue','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','stateChange','[TEST]\x20','briefingTime','WETTER:\x20','ltmLtbWindowDays','replace','analysis.training','Event\x20History','parse','\x20=\x20','prÃ¤senz','indexOf','14HCFuBf','stringify','Sleep\x20Score\x20(0-100)','Trend\x20Diagnosis\x20(Python)','analysis.trigger','automation.triggerAction','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','join','events.history','bewegung','âš ï¸\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...','Gast','timestamp','ack','humidity','submitFeedback','system.mode','log','âœ…\x20Alles\x20OK\x20(Reset)]','python3\x20-m\x20pip\x20install\x20-r\x20\x22','now','analysis.automation.triggerAction','accuweather','âœ…\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','VACATION','Fokus\x20auf\x20Familienroutinen.','notifyTelegramEnabled','simulateButler','close','Last\x20Result','15911328ftSMuH','notifyTelegramInstance','forEach','PRIORITÃ„T:\x20Gesundheit/AAL.','.\x0a\x20\x20\x20\x20ANWESENHEITS_STATUS:\x20','retry','notifyPushoverEnabled','splice','history.','Cogni-Living','KALENDER:\x20','link_quality','boolean','analysis.automation','Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip','PRIORITÃ„T:\x20Sicherheit.','javascript.','party','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','json','catch','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','name','warn','ðŸ\x20Guardian\x20Diagnosis\x20(','setStateAsync','sendTo','aiPersona','Keiner','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','5255yIIVUM','\x20hours.\x20Potential\x20incapacitation.','Generating\x20Morning\x20Briefing...','rawEventLog','autoApply','normal','system.meta.uuid','COGNI_CONFIRM_OK','find','Fokus\x20auf\x20Komfort.','currentposition','...','Wetter:\x20Deaktiviert','set_temperature','analysis.health.notes','ltmStbWindowDays','LTM.processingStatus','LTM.trainingData.sequences','TREND_RESULT','@iobroker/adapter-core','light','health','Drift\x20Analysis','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','\x20min).','analysis.analysisHistory','):\x20','testApiKey','rssi','weatherunderground','KALENDER:\x20Keine\x20relevanten\x20Termine','.\x20Welcome\x20home.','pythonProcess','Deaktiviert\x20(Pro-Feature)','Subscribing\x20to\x20','enum.functions.*','service.py','Missing\x20data','analysis.health.sleepScore','response','Sending\x20notification:\x20\x22','Health\x20&\x20Sleep\x20Analysis','sort','ðŸš¨\x20EMERGENCY','No\x20module\x20named\x20pip','toLowerCase','PARTY','analysis.comfortSuggestion','dismissAutomation','0\x204\x20*\x20*\x20*',').\x20Saving\x20to\x20Training\x20Data.','getOverviewData','events.lastEvent','status','eventHistory','motion','1238298gHOCCC','dutycycle','substring','filter','getLtmData','KALENDER:\x20Keine\x20Daten','toISOString','System\x20Status\x20&\x20Control','inactivityThresholdHours','data','search','Keine\x20Analyse.','\x20for\x20interactive\x20buttons...','analysis.training.status','indicator.alarm','systemConfig','Event\x20received:\x20','Entry\x20detected\x20via\x20','724312vvLzfD','modeResetJob','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','sound','analysis.automation.targetValue','Training\x20Error:\x20','indicator.alarm.fire','power','Success:\x20Compressed\x20','constructor','dimmer','text.alarm','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','requirements.txt','analysis.alertReason','loc','\x20|\x20','triggerBriefing','.forecast.current.state','âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.','getForeignObjectsAsync','unreach','path','Feedback\x20Log'];a0_0x5478=function(){return _0x523325;};return a0_0x5478();}a0_0x52c98e();'use strict';const utils=require(a0_0x18625a(0x299)),{GoogleGenerativeAI}=require(a0_0x18625a(0x385)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x18625a(0x338)),path=require(a0_0x18625a(0x2e6)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x18625a(0x30f),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x18625a(0x2b7),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x18625a(0x31a),LTM_DP_DAILY_DIGESTS=a0_0x18625a(0x2f0),LTM_DP_STATUS=a0_0x18625a(0x296),LTM_DP_TRIGGER_DIGEST=a0_0x18625a(0x37c),LTM_DP_BASELINE_STATUS=a0_0x18625a(0x3b6),LTM_DP_DRIFT_CHANNEL=a0_0x18625a(0x39f),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x18625a(0x308),LTM_DP_DRIFT_LAST_CHECK=a0_0x18625a(0x1c9),SYSTEM_DP_MODE=a0_0x18625a(0x25a),HARD_IGNORE_TERMS=[a0_0x18625a(0x231),'scriptEnabled','update',a0_0x18625a(0x2e5),a0_0x18625a(0x340),a0_0x18625a(0x2a2),a0_0x18625a(0x3b9),a0_0x18625a(0x217),a0_0x18625a(0x1f4),a0_0x18625a(0x1da),'working',a0_0x18625a(0x21e),'stick_unreach',a0_0x18625a(0x321),a0_0x18625a(0x2bf),a0_0x18625a(0x343),'reachable',a0_0x18625a(0x273)],BAD_NAMES=[a0_0x18625a(0x329),a0_0x18625a(0x290),a0_0x18625a(0x1cc),a0_0x18625a(0x224),a0_0x18625a(0x36e),'brightness','on','off','switch',a0_0x18625a(0x34c),'shutter','blind','cover','status',a0_0x18625a(0x2bd),a0_0x18625a(0x234),'occupancy','temperature',a0_0x18625a(0x258),a0_0x18625a(0x2d7),'energy',a0_0x18625a(0x34a),a0_0x18625a(0x331),a0_0x18625a(0x1c1),a0_0x18625a(0x293)],ADAPTER_BLACKLIST=[a0_0x18625a(0x3c3),a0_0x18625a(0x1d9),a0_0x18625a(0x380),a0_0x18625a(0x1cd),a0_0x18625a(0x270),a0_0x18625a(0x367),a0_0x18625a(0x1ba),a0_0x18625a(0x316),a0_0x18625a(0x21d),a0_0x18625a(0x278),'simple-api.'],SYSTEM_MODES={'NORMAL':a0_0x18625a(0x28b),'VACATION':'vacation','PARTY':a0_0x18625a(0x279),'GUEST':a0_0x18625a(0x3c8)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x18625a(0x2f8)]],PERSONA_MAPPING={'generic':a0_0x18625a(0x3a3),'senior_aal':a0_0x18625a(0x26b),'family':a0_0x18625a(0x263),'single_comfort':a0_0x18625a(0x28f),'security':a0_0x18625a(0x277)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x20b4bd){const _0x5e208a=a0_0x18625a;try{const _0x40c90d=[_0x5e208a(0x353),_0x5e208a(0x3d2)];for(const _0x5c9ce8 of _0x40c90d){try{const _0x41e099=await _0x20b4bd['getObjectAsync'](_0x5c9ce8);_0x41e099&&await _0x20b4bd['delObjectAsync'](_0x5c9ce8);}catch(_0x4b5d60){}}}catch(_0x233a44){}}async function initHistory(_0x12a150){const _0x5d72f1=a0_0x18625a;try{const _0x1251f0=await _0x12a150['getStateAsync']('events.history');_0x1251f0&&_0x1251f0[_0x5d72f1(0x33b)]&&(_0x12a150[_0x5d72f1(0x2bc)]=JSON[_0x5d72f1(0x246)](_0x1251f0[_0x5d72f1(0x33b)][_0x5d72f1(0x22f)]()));}catch(_0x2158d5){_0x12a150[_0x5d72f1(0x2bc)]=[];}try{const _0x47cd5d=await _0x12a150['getStateAsync'](_0x5d72f1(0x29f));if(_0x47cd5d&&_0x47cd5d[_0x5d72f1(0x33b)])_0x12a150[_0x5d72f1(0x3dc)]=JSON[_0x5d72f1(0x246)](_0x47cd5d[_0x5d72f1(0x33b)][_0x5d72f1(0x22f)]());}catch(_0x317e84){_0x12a150[_0x5d72f1(0x3dc)]=[];}if(_0x12a150[_0x5d72f1(0x2bc)]&&_0x12a150[_0x5d72f1(0x2bc)][_0x5d72f1(0x3be)]>0x0){_0x12a150['log']['info']('Restoring\x20sensor\x20cache\x20from\x20history\x20('+_0x12a150[_0x5d72f1(0x2bc)][_0x5d72f1(0x3be)]+_0x5d72f1(0x1ef));for(let _0x14e6f0=_0x12a150[_0x5d72f1(0x2bc)][_0x5d72f1(0x3be)]-0x1;_0x14e6f0>=0x0;_0x14e6f0--){const _0x31db49=_0x12a150[_0x5d72f1(0x2bc)][_0x14e6f0];_0x31db49&&_0x31db49['id']!==undefined&&_0x31db49[_0x5d72f1(0x36e)]!==undefined&&(_0x12a150['sensorLastValues'][_0x31db49['id']]=_0x31db49[_0x5d72f1(0x36e)]);}}}async function initSystemConfig(_0x18c7e5){const _0x560140=a0_0x18625a;try{const _0x29bcfd=await _0x18c7e5[_0x560140(0x202)](_0x560140(0x344));_0x29bcfd&&_0x29bcfd['common']&&(_0x18c7e5[_0x560140(0x2cd)]={'latitude':_0x29bcfd['common'][_0x560140(0x3d1)]||0x0,'longitude':_0x29bcfd[_0x560140(0x376)][_0x560140(0x204)]||0x0,'city':_0x29bcfd['common'][_0x560140(0x327)]||''});}catch(_0x4832bf){}}async function checkLicense(_0x5c5f7f,_0x2369c4){const _0x1732dc=a0_0x18625a;if(!_0x2369c4)return![];_0x5c5f7f[_0x1732dc(0x3bd)]=await getSystemUUID(_0x5c5f7f);if(_0x2369c4==='TEST-PRO-KEY'||_0x2369c4[_0x1732dc(0x3ba)](_0x1732dc(0x3bb)))return!![];return![];}async function getSystemUUID(_0x5cd641){const _0x4de78a=a0_0x18625a;try{const _0x26b462=await _0x5cd641[_0x4de78a(0x202)](_0x4de78a(0x28c));if(_0x26b462&&_0x26b462[_0x4de78a(0x31b)]&&_0x26b462[_0x4de78a(0x31b)][_0x4de78a(0x1f8)])return _0x26b462[_0x4de78a(0x31b)][_0x4de78a(0x1f8)];return'uuid-not-found';}catch(_0x4ff494){return _0x4de78a(0x1fc);}}async function createAllObjects(_0xff82bf){const _0x5eb258=a0_0x18625a;await checkSystemObjects(_0xff82bf),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x397),{'type':'state','common':{'name':'Who\x20is\x20present?','type':_0x5eb258(0x393),'role':_0x5eb258(0x2ff),'read':!![],'write':![],'def':''},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('events.lastEvent',{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x311),'type':_0x5eb258(0x393),'role':_0x5eb258(0x27b),'read':!![],'write':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('events.history',{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x245),'type':_0x5eb258(0x393),'role':_0x5eb258(0x27b),'read':!![],'write':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x24e),{'type':_0x5eb258(0x1cc),'common':{'name':'Trigger\x20Analysis','type':_0x5eb258(0x274),'role':_0x5eb258(0x388),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x332),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x3ad),'type':'boolean','role':_0x5eb258(0x388),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x38a)](_0x5eb258(0x244),{'type':'channel','common':{'name':_0x5eb258(0x2e9)},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x392),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x23b),'type':_0x5eb258(0x274),'role':_0x5eb258(0x388),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('analysis.training.status',{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x22a),'type':_0x5eb258(0x393),'role':_0x5eb258(0x2ff),'read':!![],'write':![],'def':'Idle'},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('analysis.lastResult',{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x267),'type':_0x5eb258(0x393),'role':_0x5eb258(0x27b),'read':!![],'write':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x1f0),{'type':_0x5eb258(0x1cc),'common':{'name':'AI\x20Alert\x20Status','type':'boolean','role':_0x5eb258(0x2cc),'read':!![],'write':![],'def':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x37d),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x233),'type':_0x5eb258(0x274),'role':_0x5eb258(0x2d6),'read':!![],'write':![],'def':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('analysis.alertReason',{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x360),'type':_0x5eb258(0x393),'role':_0x5eb258(0x2db),'read':!![],'write':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x1ce),{'type':'state','common':{'name':_0x5eb258(0x3df),'type':_0x5eb258(0x393),'role':_0x5eb258(0x2ff),'read':!![],'write':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('analysis.deviationFromBaseline',{'type':'state','common':{'name':_0x5eb258(0x218),'type':_0x5eb258(0x393),'role':_0x5eb258(0x1cc),'read':!![],'write':![],'def':_0x5eb258(0x3a6)},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x371),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x355),'type':_0x5eb258(0x393),'role':_0x5eb258(0x2ff),'read':!![],'write':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x2b5),{'type':_0x5eb258(0x1cc),'common':{'name':'Comfort\x20Suggestion','type':'string','role':_0x5eb258(0x2ff),'read':!![],'write':![]},'native':{}}),await _0xff82bf['extendObjectAsync'](_0x5eb258(0x275),{'type':_0x5eb258(0x347),'common':{'name':_0x5eb258(0x32b)},'native':{}}),await _0xff82bf['setObjectNotExistsAsync'](_0x5eb258(0x382),{'type':'state','common':{'name':_0x5eb258(0x3d4),'type':_0x5eb258(0x274),'role':_0x5eb258(0x2f2),'read':!![],'write':![],'def':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x3b1),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x2fe),'type':'string','role':_0x5eb258(0x2ff),'read':!![],'write':![]},'native':{}}),await _0xff82bf['setObjectNotExistsAsync']('analysis.automation.suggestedAction',{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x22c),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('analysis.automation.targetId',{'type':_0x5eb258(0x1cc),'common':{'name':'Target\x20ID','type':_0x5eb258(0x393),'role':'text','read':!![],'write':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('analysis.automation.targetValue',{'type':'state','common':{'name':_0x5eb258(0x33f),'type':_0x5eb258(0x393),'role':_0x5eb258(0x2ff),'read':!![],'write':![]},'native':{}}),await _0xff82bf['setObjectNotExistsAsync'](_0x5eb258(0x32a),{'type':_0x5eb258(0x1cc),'common':{'name':'Auto\x20Apply\x20Rule','type':_0x5eb258(0x274),'role':_0x5eb258(0x364),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x25f),{'type':'state','common':{'name':'Trigger\x20Action\x20Now','type':_0x5eb258(0x274),'role':_0x5eb258(0x388),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xff82bf['setObjectNotExistsAsync'](_0x5eb258(0x29f),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x37b),'type':_0x5eb258(0x393),'role':_0x5eb258(0x27b),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x334),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x2e7),'type':_0x5eb258(0x393),'role':_0x5eb258(0x27b),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0xff82bf[_0x5eb258(0x38a)](_0x5eb258(0x3dd),{'type':'channel','common':{'name':_0x5eb258(0x2af)},'native':{}}),await _0xff82bf['setObjectNotExistsAsync'](_0x5eb258(0x2ac),{'type':'state','common':{'name':_0x5eb258(0x24c),'type':'number','role':_0x5eb258(0x31c),'read':!![],'write':![],'def':0x0},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('analysis.health.restlessness',{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x374),'type':'string','role':_0x5eb258(0x2ff),'read':!![],'write':![],'def':_0x5eb258(0x20d)},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x294),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x2f6),'type':_0x5eb258(0x393),'role':_0x5eb258(0x2ff),'read':!![],'write':![],'def':''},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x33c),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x24d),'type':'string','role':'text','read':!![],'write':![],'def':_0x5eb258(0x3a6)},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x22e),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x3a2),'type':_0x5eb258(0x2f9),'role':_0x5eb258(0x36e),'read':!![],'write':![],'def':0x0},'native':{}}),await _0xff82bf[_0x5eb258(0x38a)](_0x5eb258(0x35f),{'type':'channel','common':{'name':_0x5eb258(0x381)},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)]('LTM.trainingData.sequences',{'type':'state','common':{'name':'Recorded\x20Motion\x20Sequences','type':_0x5eb258(0x393),'role':_0x5eb258(0x27b),'read':!![],'write':![],'def':'[]','desc':_0x5eb258(0x285)},'native':{}}),await _0xff82bf[_0x5eb258(0x2f7)](_0x5eb258(0x301),{'type':_0x5eb258(0x1cc),'common':{'name':_0x5eb258(0x3af),'type':_0x5eb258(0x393),'role':_0x5eb258(0x27b),'read':!![],'write':![],'def':'[]','desc':_0x5eb258(0x1ed)},'native':{}}),await checkLtmObjects(_0xff82bf),await checkLtmDriftObjects(_0xff82bf);}async function checkSystemObjects(_0x60f775){const _0x7160c3=a0_0x18625a;await _0x60f775['extendObjectAsync'](_0x7160c3(0x313),{'type':_0x7160c3(0x347),'common':{'name':_0x7160c3(0x2c5)},'native':{}}),await _0x60f775[_0x7160c3(0x38a)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x7160c3(0x3ac),'type':'string','role':_0x7160c3(0x1cc),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x7160c3(0x3d9)],'states':{[SYSTEM_MODES[_0x7160c3(0x3d9)]]:_0x7160c3(0x35b),[SYSTEM_MODES[_0x7160c3(0x262)]]:_0x7160c3(0x209),[SYSTEM_MODES[_0x7160c3(0x2b4)]]:'Party',[SYSTEM_MODES[_0x7160c3(0x2f8)]]:_0x7160c3(0x255)}},'native':{}});}async function checkLtmObjects(_0xd808c3){const _0x2d6268=a0_0x18625a;await _0xd808c3[_0x2d6268(0x38a)]('LTM',{'type':'channel','common':{'name':'LTM'},'native':{}}),await _0xd808c3[_0x2d6268(0x38a)](LTM_DP_RAW_LOG,{'type':_0x2d6268(0x1cc),'common':{'name':_0x2d6268(0x352),'type':_0x2d6268(0x393),'role':_0x2d6268(0x27b),'read':!![],'write':![]},'native':{}}),await _0xd808c3[_0x2d6268(0x38a)](LTM_DP_DAILY_DIGESTS,{'type':_0x2d6268(0x1cc),'common':{'name':'Daily\x20Digests','type':_0x2d6268(0x393),'role':_0x2d6268(0x27b),'read':!![],'write':![]},'native':{}}),await _0xd808c3[_0x2d6268(0x38a)](LTM_DP_STATUS,{'type':'state','common':{'name':_0x2d6268(0x35c),'type':'string','role':_0x2d6268(0x2ff),'read':!![],'write':![]},'native':{}}),await _0xd808c3['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x2d6268(0x1cc),'common':{'name':_0x2d6268(0x215),'type':_0x2d6268(0x274),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0xd808c3[_0x2d6268(0x38a)](LTM_DP_BASELINE_STATUS,{'type':_0x2d6268(0x1cc),'common':{'name':'Baseline\x20Status','type':_0x2d6268(0x393),'role':_0x2d6268(0x2ff),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4f53f1){const _0x118c6a=a0_0x18625a;await _0x4f53f1[_0x118c6a(0x38a)](LTM_DP_DRIFT_CHANNEL,{'type':_0x118c6a(0x347),'common':{'name':_0x118c6a(0x29c)},'native':{}}),await _0x4f53f1[_0x118c6a(0x38a)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x118c6a(0x33d),'type':_0x118c6a(0x393),'role':_0x118c6a(0x1cc),'read':!![],'write':![],'def':_0x118c6a(0x3a6)},'native':{}}),await _0x4f53f1['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':_0x118c6a(0x393),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4f53f1['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x118c6a(0x1cc),'common':{'name':'Last\x20Check','type':_0x118c6a(0x2f9),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x1f2e8d){const _0x1139cb=a0_0x18625a;try{const _0x1e5cdc=await _0x1f2e8d[_0x1139cb(0x22d)](SYSTEM_DP_MODE);_0x1e5cdc&&_0x1e5cdc[_0x1139cb(0x33b)]&&Object[_0x1139cb(0x346)](SYSTEM_MODES)['includes'](_0x1e5cdc[_0x1139cb(0x33b)])?_0x1f2e8d[_0x1139cb(0x378)]=_0x1e5cdc[_0x1139cb(0x33b)]:(_0x1f2e8d['currentSystemMode']=SYSTEM_MODES[_0x1139cb(0x3d9)],await _0x1f2e8d['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1139cb(0x3d9)],'ack':!![]}));}catch(_0x3073c8){_0x1f2e8d[_0x1139cb(0x378)]=SYSTEM_MODES[_0x1139cb(0x3d9)];}}async function loadRawEventLog(_0x4c17c0){const _0x3297c6=a0_0x18625a;try{const _0x54dfdd=await _0x4c17c0[_0x3297c6(0x22d)](LTM_DP_RAW_LOG);if(_0x54dfdd&&_0x54dfdd['val'])_0x4c17c0[_0x3297c6(0x289)]=JSON['parse'](_0x54dfdd['val']);}catch(_0x5274e8){_0x4c17c0[_0x3297c6(0x289)]=[];}}async function saveRawEventLog(_0x1aa4b7){const _0x41ae45=a0_0x18625a;_0x1aa4b7[_0x41ae45(0x289)][_0x41ae45(0x3be)]>RAW_LOG_MAX_SIZE&&_0x1aa4b7[_0x41ae45(0x289)]['splice'](0x0,_0x1aa4b7[_0x41ae45(0x289)][_0x41ae45(0x3be)]-RAW_LOG_MAX_SIZE),await _0x1aa4b7['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x41ae45(0x24b)](_0x1aa4b7['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x466108){const _0x3f6065=a0_0x18625a;try{const _0x7965a9=await _0x466108[_0x3f6065(0x22d)](LTM_DP_DAILY_DIGESTS);if(_0x7965a9&&_0x7965a9[_0x3f6065(0x33b)])_0x466108[_0x3f6065(0x1f5)]=JSON[_0x3f6065(0x246)](_0x7965a9['val']);}catch(_0x2de908){_0x466108[_0x3f6065(0x1f5)]=[];}await updateBaselineStatus(_0x466108);}async function saveDailyDigests(_0x27b5bf,_0x5011d4=!![]){const _0x3a32d8=a0_0x18625a,_0x27ce8f=_0x27b5bf[_0x3a32d8(0x3d7)][_0x3a32d8(0x242)]||0x3c;_0x27b5bf[_0x3a32d8(0x1f5)][_0x3a32d8(0x3be)]>_0x27ce8f&&_0x27b5bf[_0x3a32d8(0x1f5)][_0x3a32d8(0x26f)](0x0,_0x27b5bf['dailyDigests']['length']-_0x27ce8f);await _0x27b5bf[_0x3a32d8(0x281)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x27b5bf[_0x3a32d8(0x1f5)]),'ack':!![]});if(_0x5011d4)await updateBaselineStatus(_0x27b5bf);}async function updateAnalysisHistory(_0x589a4f,_0x55bbed){const _0x58d216=a0_0x18625a;_0x589a4f[_0x58d216(0x3dc)][_0x58d216(0x2fa)](_0x55bbed);if(_0x589a4f['analysisHistory'][_0x58d216(0x3be)]>ANALYSIS_HISTORY_MAX_SIZE)_0x589a4f[_0x58d216(0x3dc)]['pop']();await _0x589a4f['setStateAsync']('analysis.analysisHistory',{'val':JSON[_0x58d216(0x24b)](_0x589a4f[_0x58d216(0x3dc)]),'ack':!![]});}async function updateBaselineStatus(_0x12fb16){const _0x5923e3=a0_0x18625a;if(!_0x12fb16[_0x5923e3(0x236)]){await _0x12fb16[_0x5923e3(0x281)](LTM_DP_BASELINE_STATUS,{'val':_0x5923e3(0x2a7),'ack':!![]});return;}const _0x28e488=_0x12fb16[_0x5923e3(0x1f5)][_0x5923e3(0x3be)]>=(_0x12fb16[_0x5923e3(0x3d7)][_0x5923e3(0x31d)]||0x7)?_0x5923e3(0x303)+_0x12fb16['dailyDigests'][_0x5923e3(0x3be)]+_0x5923e3(0x1ec):_0x5923e3(0x32c)+_0x12fb16[_0x5923e3(0x1f5)][_0x5923e3(0x3be)]+'/'+(_0x12fb16[_0x5923e3(0x3d7)][_0x5923e3(0x31d)]||0x7)+')';await _0x12fb16[_0x5923e3(0x281)](LTM_DP_BASELINE_STATUS,{'val':_0x28e488,'ack':!![]});}async function initSensorSubscriptions(_0x12c6bd){const _0x10b810=a0_0x18625a,_0x24377b=_0x12c6bd[_0x10b810(0x3d7)][_0x10b810(0x1d8)];if(_0x24377b&&_0x24377b[_0x10b810(0x3be)]>0x0){_0x12c6bd['log']['info'](_0x10b810(0x2a8)+_0x24377b[_0x10b810(0x3be)]+_0x10b810(0x1df));for(const _0x1fa3e4 of _0x24377b){if(_0x1fa3e4['id']){await _0x12c6bd[_0x10b810(0x20b)](_0x1fa3e4['id']);try{const _0x15d46c=await _0x12c6bd[_0x10b810(0x330)](_0x1fa3e4['id']);if(_0x15d46c)_0x12c6bd[_0x10b810(0x363)][_0x1fa3e4['id']]=_0x15d46c[_0x10b810(0x33b)];}catch(_0x2dab59){}}}}}async function initPresenceSubscriptions(_0x4f99af){const _0x2b458c=a0_0x18625a,_0x4c97a0=_0x4f99af[_0x2b458c(0x3d7)][_0x2b458c(0x1fd)]||[];if(_0x4c97a0[_0x2b458c(0x3be)]>0x0){_0x4f99af[_0x2b458c(0x25b)]['info'](_0x2b458c(0x2a8)+_0x4c97a0[_0x2b458c(0x3be)]+_0x2b458c(0x30b));for(const _0x2d936b of _0x4c97a0){await _0x4f99af['subscribeForeignStatesAsync'](_0x2d936b);}try{await checkWifiPresence(_0x4f99af);}catch(_0x575c3f){}}}async function getWeatherContext(_0x293cb2){const _0x3556a8=a0_0x18625a;try{if(!_0x293cb2['config'][_0x3556a8(0x1e7)])return _0x3556a8(0x292);let _0x46b439='';const _0x2b3ca2=_0x293cb2[_0x3556a8(0x3d7)][_0x3556a8(0x314)];if(_0x2b3ca2)try{if(_0x2b3ca2[_0x3556a8(0x33a)](_0x3556a8(0x260))){const _0x59ea80=await _0x293cb2['getForeignStateAsync'](_0x2b3ca2+'.Summary.Current');if(_0x59ea80&&_0x59ea80[_0x3556a8(0x33b)])_0x46b439=_0x59ea80['val'];}else{if(_0x2b3ca2[_0x3556a8(0x33a)](_0x3556a8(0x317))){const _0x2b2df9=await _0x293cb2[_0x3556a8(0x330)](_0x2b3ca2+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0x2b2df9&&_0x2b2df9[_0x3556a8(0x33b)])_0x46b439=_0x2b2df9['val'];}else{if(_0x2b3ca2['includes'](_0x3556a8(0x366))){const _0x678afb=await _0x293cb2[_0x3556a8(0x330)](_0x2b3ca2+_0x3556a8(0x2e2));if(_0x678afb&&_0x678afb[_0x3556a8(0x33b)])_0x46b439=_0x678afb['val'];}}}}catch(_0x4e29e1){}if(!_0x46b439){const _0xe150bb=[_0x3556a8(0x306),_0x3556a8(0x2ef),_0x3556a8(0x200),_0x3556a8(0x383)];for(const _0x21f47a of _0xe150bb){try{const _0x3999c5=await _0x293cb2[_0x3556a8(0x202)](_0x21f47a);if(_0x3999c5){if(_0x21f47a[_0x3556a8(0x33a)](_0x3556a8(0x260))){const _0x19fb26=await _0x293cb2['getForeignStateAsync'](_0x21f47a+_0x3556a8(0x2ee));if(_0x19fb26&&_0x19fb26[_0x3556a8(0x33b)]){_0x46b439=_0x19fb26[_0x3556a8(0x33b)];break;}}}}catch(_0x2f2701){}}}return _0x46b439?_0x3556a8(0x241)+_0x46b439:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x52bb97){return _0x3556a8(0x32e)+_0x52bb97[_0x3556a8(0x206)];}}async function getCalendarContext(_0x4f8b6d){const _0x5caf71=a0_0x18625a;try{if(!_0x4f8b6d[_0x5caf71(0x3d7)]['useCalendar'])return _0x5caf71(0x30c);let _0x7cab7b=_0x4f8b6d[_0x5caf71(0x3d7)][_0x5caf71(0x36c)]||'ical.0',_0x254048=_0x4f8b6d[_0x5caf71(0x3d7)][_0x5caf71(0x228)]||[];if(typeof _0x254048===_0x5caf71(0x393))_0x254048=_0x254048['split'](',');try{const _0x2bbf4f=await _0x4f8b6d['getForeignStateAsync'](_0x7cab7b+'.data.table');if(_0x2bbf4f&&_0x2bbf4f[_0x5caf71(0x33b)]){let _0x21e0f8=tryParse(_0x2bbf4f['val']);if(_0x21e0f8&&Array[_0x5caf71(0x1d1)](_0x21e0f8)){if(_0x254048[_0x5caf71(0x3be)]>0x0)_0x21e0f8=_0x21e0f8[_0x5caf71(0x2c1)](_0x423491=>_0x254048[_0x5caf71(0x33a)](_0x423491['_calName']||''));else return _0x5caf71(0x27a);if(_0x21e0f8['length']>0x0){const _0x1f0823=_0x21e0f8['slice'](0x0,0x3)[_0x5caf71(0x3ca)](_0x1169af=>{const _0x961481=_0x5caf71;let _0x2a793b=_0x1169af[_0x961481(0x210)];if(_0x1169af['time'])_0x2a793b+='\x20'+_0x1169af[_0x961481(0x3d8)];return _0x2a793b+':\x20'+_0x1169af[_0x961481(0x3bf)]+'\x20('+_0x1169af[_0x961481(0x3d5)]+')';});return _0x5caf71(0x272)+_0x1f0823[_0x5caf71(0x251)](_0x5caf71(0x2e0));}else return _0x5caf71(0x2a4);}}}catch(_0x2ff433){_0x4f8b6d[_0x5caf71(0x25b)][_0x5caf71(0x27f)](_0x5caf71(0x3a4)+_0x2ff433['message']);}return _0x5caf71(0x2c3);}catch(_0x1a7a55){return'KALENDER\x20ERROR:\x20'+_0x1a7a55[_0x5caf71(0x206)];}}async function getCalendarNames(_0x2ec851,_0x2a5a92){const _0x53b816=a0_0x18625a;try{const _0x3b0a92=await _0x2ec851[_0x53b816(0x330)](_0x2a5a92+'.data.table');if(_0x3b0a92&&_0x3b0a92[_0x53b816(0x33b)]){const _0x5499e9=tryParse(_0x3b0a92[_0x53b816(0x33b)]);if(_0x5499e9&&Array[_0x53b816(0x1d1)](_0x5499e9)){const _0x111a68=[...new Set(_0x5499e9[_0x53b816(0x3ca)](_0x5ce37f=>_0x5ce37f[_0x53b816(0x3d5)])[_0x53b816(0x2c1)](Boolean))];return _0x111a68['sort']();}}return[];}catch(_0x57de80){return _0x2ec851['log'][_0x53b816(0x1f4)](_0x53b816(0x1c8)+_0x57de80['message']),[];}}async function checkWifiPresence(_0x8b2a4f){const _0x2e3f59=a0_0x18625a;try{const _0x325ab7=_0x8b2a4f[_0x2e3f59(0x3d7)]['presenceDevices']||[];let _0x3d54fe=![];const _0x5afea7=[];for(const _0xdbf6d4 of _0x325ab7){try{const _0x80ef33=await _0x8b2a4f[_0x2e3f59(0x330)](_0xdbf6d4);if(_0x80ef33&&(_0x80ef33[_0x2e3f59(0x33b)]===!![]||_0x80ef33['val']===_0x2e3f59(0x300)||_0x80ef33[_0x2e3f59(0x33b)]===0x1)){_0x3d54fe=!![];const _0x15a618=await _0x8b2a4f[_0x2e3f59(0x202)](_0xdbf6d4);let _0x336bec=_0xdbf6d4;_0x15a618&&_0x15a618[_0x2e3f59(0x376)]&&_0x15a618[_0x2e3f59(0x376)][_0x2e3f59(0x27e)]&&(_0x336bec=typeof _0x15a618[_0x2e3f59(0x376)][_0x2e3f59(0x27e)]==='object'?_0x15a618[_0x2e3f59(0x376)][_0x2e3f59(0x27e)]['de']||_0x15a618['common'][_0x2e3f59(0x27e)]['en']:_0x15a618['common']['name']),_0x5afea7[_0x2e3f59(0x2e8)](_0x336bec);}}catch(_0x5df73f){}}return await _0x8b2a4f['setStateAsync']('system.presenceWho',{'val':_0x5afea7[_0x2e3f59(0x251)](',\x20'),'ack':!![]}),_0x3d54fe&&(_0x8b2a4f[_0x2e3f59(0x1e8)]&&(_0x8b2a4f[_0x2e3f59(0x25b)]['info'](_0x2e3f59(0x27d)),abortExitTimer(_0x8b2a4f)),!_0x8b2a4f[_0x2e3f59(0x30a)]&&_0x8b2a4f['currentSystemMode']===SYSTEM_MODES[_0x2e3f59(0x3d9)]&&await setPresence(_0x8b2a4f,!![])),_0x3d54fe;}catch(_0x40b96d){return _0x8b2a4f['log'][_0x2e3f59(0x1f4)](_0x2e3f59(0x213)+_0x40b96d[_0x2e3f59(0x206)]),![];}}function startExitTimer(_0x1e7149){const _0x3f13c9=a0_0x18625a;abortExitTimer(_0x1e7149),_0x1e7149['isGracePeriodActive']=!![],_0x1e7149[_0x3f13c9(0x230)]=setTimeout(()=>{const _0x460509=_0x3f13c9;_0x1e7149[_0x460509(0x1c7)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x1e7149[_0x3f13c9(0x1e8)]=setTimeout(()=>{const _0x2ce865=_0x3f13c9;setPresence(_0x1e7149,![]),_0x1e7149[_0x2ce865(0x1e8)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x42b10d){const _0x4f7fe9=a0_0x18625a;if(_0x42b10d[_0x4f7fe9(0x1e8)])clearTimeout(_0x42b10d['exitTimer']);if(_0x42b10d[_0x4f7fe9(0x230)])clearTimeout(_0x42b10d[_0x4f7fe9(0x230)]);_0x42b10d['exitTimer']=null,_0x42b10d[_0x4f7fe9(0x230)]=null,_0x42b10d[_0x4f7fe9(0x1c7)]=![];}async function setPresence(_0x10c60b,_0x50116f){const _0x412302=a0_0x18625a;if(_0x10c60b['isPresent']===_0x50116f)return;_0x10c60b[_0x412302(0x30a)]=_0x50116f,await _0x10c60b[_0x412302(0x281)]('system.isPresent',{'val':_0x50116f,'ack':!![]});}async function saveFeedback(_0x30975a,_0x1ab01c){const _0x5de35f=a0_0x18625a;_0x30975a[_0x5de35f(0x25b)][_0x5de35f(0x1e1)]('Feedback\x20saved:\x20'+JSON['stringify'](_0x1ab01c));}async function runBaselineDriftAnalysis(_0x5e51cd){const _0x4a3290=a0_0x18625a;if(!_0x5e51cd['isProVersion']||!_0x5e51cd[_0x4a3290(0x1e4)])return;const _0x582d14=_0x5e51cd[_0x4a3290(0x3d7)][_0x4a3290(0x295)]||0xe;if(_0x5e51cd[_0x4a3290(0x1f5)][_0x4a3290(0x3be)]<_0x582d14+(_0x5e51cd[_0x4a3290(0x3d7)][_0x4a3290(0x31d)]||0x7)){await _0x5e51cd['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x4a3290(0x3a8),'ack':!![]});return;}const _0x54777f=_0x5e51cd[_0x4a3290(0x1f5)][_0x4a3290(0x3d3)](-_0x582d14),_0x53da27=_0x5e51cd[_0x4a3290(0x1f5)][_0x4a3290(0x3d3)](0x0,_0x5e51cd[_0x4a3290(0x1f5)][_0x4a3290(0x3be)]-_0x582d14),_0xed815c=_0x4a3290(0x23a)+JSON[_0x4a3290(0x24b)](_0x53da27)+'\x0aSTB:\x20'+JSON[_0x4a3290(0x24b)](_0x54777f);try{const _0x4bc9da=await _0x5e51cd[_0x4a3290(0x1e4)]['generateContent'](_0xed815c),_0xcc1c6c=JSON[_0x4a3290(0x246)](_0x4bc9da[_0x4a3290(0x2ad)][_0x4a3290(0x2ff)]()[_0x4a3290(0x243)](/```json|```/g,'')[_0x4a3290(0x223)]());_0xcc1c6c[_0x4a3290(0x368)]&&(await _0x5e51cd['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0xcc1c6c[_0x4a3290(0x368)],'ack':!![]}),await _0x5e51cd[_0x4a3290(0x281)](LTM_DP_DRIFT_DETAILS,{'val':_0xcc1c6c[_0x4a3290(0x36a)],'ack':!![]}),await _0x5e51cd[_0x4a3290(0x281)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4a3290(0x25e)](),'ack':!![]}));}catch(_0xdbf58f){}}function setupLtmScheduler(_0x4c7975){const _0x58a319=a0_0x18625a;try{if(_0x4c7975[_0x58a319(0x305)])_0x4c7975['ltmJob'][_0x58a319(0x3ce)]();if(!_0x4c7975[_0x58a319(0x236)]){_0x4c7975[_0x58a319(0x281)](LTM_DP_STATUS,{'val':_0x58a319(0x2a7),'ack':!![]});return;}_0x4c7975[_0x58a319(0x305)]=schedule[_0x58a319(0x207)](LTM_SCHEDULE,()=>createDailyDigest(_0x4c7975));}catch(_0x55fa14){_0x4c7975[_0x58a319(0x25b)][_0x58a319(0x1f4)]('LTM\x20Sched\x20Error:\x20'+_0x55fa14[_0x58a319(0x206)]);}}function setupModeResetScheduler(_0x4a0d62){const _0x59ffd4=a0_0x18625a;try{if(_0x4a0d62[_0x59ffd4(0x2d1)])_0x4a0d62[_0x59ffd4(0x2d1)][_0x59ffd4(0x3ce)]();_0x4a0d62[_0x59ffd4(0x2d1)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x3792c4=_0x59ffd4;await loadSystemMode(_0x4a0d62),AUTO_RESET_MODES[_0x3792c4(0x33a)](_0x4a0d62[_0x3792c4(0x378)])&&await _0x4a0d62[_0x3792c4(0x281)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0xb0f0ef){_0x4a0d62[_0x59ffd4(0x25b)][_0x59ffd4(0x1f4)]('Reset\x20Sched\x20Error:\x20'+_0xb0f0ef[_0x59ffd4(0x206)]);}}function setupDriftAnalysisScheduler(_0x53e4cb){const _0x55daed=a0_0x18625a;try{if(_0x53e4cb[_0x55daed(0x365)])clearInterval(_0x53e4cb['driftAnalysisTimer']);if(!_0x53e4cb[_0x55daed(0x236)])return;_0x53e4cb['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x53e4cb),(_0x53e4cb[_0x55daed(0x3d7)][_0x55daed(0x238)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x53e4cb),0x1388);}catch(_0x3167c1){_0x53e4cb['log'][_0x55daed(0x1f4)]('Drift\x20Sched\x20Error:\x20'+_0x3167c1[_0x55daed(0x206)]);}}function setupBriefingScheduler(_0x2e9f37){const _0x14ea2e=a0_0x18625a;try{if(_0x2e9f37['briefingJob'])_0x2e9f37[_0x14ea2e(0x1c5)][_0x14ea2e(0x3ce)]();if(!_0x2e9f37[_0x14ea2e(0x3d7)]['briefingEnabled'])return;const _0x5dbfa1=(_0x2e9f37[_0x14ea2e(0x3d7)][_0x14ea2e(0x240)]||_0x14ea2e(0x325))[_0x14ea2e(0x342)](':'),_0x1cdfef=parseInt(_0x5dbfa1[0x0])||0x8,_0x172ebc=parseInt(_0x5dbfa1[0x1])||0x0,_0xbc845c=_0x172ebc+'\x20'+_0x1cdfef+_0x14ea2e(0x304);_0x2e9f37[_0x14ea2e(0x25b)]['info'](_0x14ea2e(0x3b0)+_0x1cdfef+':'+(_0x172ebc<0xa?'0'+_0x172ebc:_0x172ebc)),_0x2e9f37[_0x14ea2e(0x1c5)]=schedule[_0x14ea2e(0x207)](_0xbc845c,()=>{sendMorningBriefing(_0x2e9f37);});}catch(_0x58ea3f){_0x2e9f37[_0x14ea2e(0x25b)]['error'](_0x14ea2e(0x1e5)+_0x58ea3f['message']);}}async function sendNotification(_0x3f3d08,_0x19ad6d,_0x36da9b=![],_0x5d0a5c=![]){const _0x5b7128=a0_0x18625a;_0x3f3d08[_0x5b7128(0x25b)][_0x5b7128(0x1e1)]((_0x36da9b?_0x5b7128(0x23f):'')+_0x5b7128(0x2ae)+_0x19ad6d+'\x22');const _0x2ce311=_0x3f3d08[_0x5b7128(0x3d7)];let _0x55b8bd=0x0;if(_0x2ce311[_0x5b7128(0x264)]){let _0x29d8b1={};(_0x19ad6d['includes'](_0x5b7128(0x3b4))||_0x5d0a5c)&&(_0x29d8b1={'reply_markup':{'inline_keyboard':[[{'text':_0x5b7128(0x25c),'callback_data':_0x5b7128(0x28d)}],[{'text':_0x5b7128(0x2dc),'callback_data':_0x5b7128(0x2fc)}]]}}),await _0x3f3d08[_0x5b7128(0x1e0)](_0x2ce311[_0x5b7128(0x269)],_0x5b7128(0x3db),{'text':_0x19ad6d,'user':_0x2ce311[_0x5b7128(0x373)],..._0x29d8b1}),_0x55b8bd++;}if(_0x2ce311[_0x5b7128(0x26e)]){let _0x19093c={'message':_0x19ad6d,'title':_0x5d0a5c?_0x5b7128(0x2b1):_0x5b7128(0x271),'priority':_0x5d0a5c?0x2:0x1,'device':_0x2ce311['notifyPushoverRecipient']};_0x5d0a5c&&(_0x19093c[_0x5b7128(0x26d)]=0x1e,_0x19093c['expire']=0xe10,_0x19093c[_0x5b7128(0x2d3)]=_0x5b7128(0x214)),await _0x3f3d08[_0x5b7128(0x1e0)](_0x2ce311[_0x5b7128(0x389)],_0x5b7128(0x3db),_0x19093c),_0x55b8bd++;}return _0x2ce311[_0x5b7128(0x1bc)]&&(await _0x3f3d08[_0x5b7128(0x1e0)](_0x2ce311[_0x5b7128(0x399)],_0x5b7128(0x3db),{'text':_0x19ad6d,'to':_0x2ce311['notifyEmailRecipient']}),_0x55b8bd++),_0x55b8bd;}async function setupTelegramListener(_0x3b255c){const _0x1cea33=a0_0x18625a,_0x4c1f8a=_0x3b255c['config'][_0x1cea33(0x269)];_0x3b255c[_0x1cea33(0x3d7)][_0x1cea33(0x264)]&&_0x4c1f8a&&(_0x3b255c['log'][_0x1cea33(0x1e1)]('ðŸ“¡\x20Hooking\x20into\x20'+_0x4c1f8a+_0x1cea33(0x2ca)),await _0x3b255c[_0x1cea33(0x20b)](_0x4c1f8a+_0x1cea33(0x1e9)));}async function handleTelegramResponse(_0x1f2c78,_0xf10c58){const _0x1fec2c=a0_0x18625a;let _0x5b9d97=_0xf10c58;_0xf10c58[_0x1fec2c(0x3ba)]('[')&&(_0x5b9d97=_0xf10c58['substring'](_0xf10c58[_0x1fec2c(0x249)](']')+0x1));if(_0x5b9d97===_0x1fec2c(0x28d))_0x1f2c78[_0x1fec2c(0x25b)]['info']('âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.'),await _0x1f2c78['setStateAsync'](_0x1fec2c(0x1f0),{'val':![],'ack':!![]}),await _0x1f2c78['setStateAsync'](_0x1fec2c(0x2de),{'val':_0x1fec2c(0x21f),'ack':!![]}),_0x1f2c78['lastAlertState']=![],sendNotification(_0x1f2c78,_0x1fec2c(0x394),![]);else _0x5b9d97===_0x1fec2c(0x2fc)&&(_0x1f2c78[_0x1fec2c(0x25b)][_0x1fec2c(0x27f)]('ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x1f2c78,'ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]));}async function runAutopilot(_0xfdb02a){const _0x185423=a0_0x18625a,_0x502e7a=_0xfdb02a[_0x185423(0x3d7)][_0x185423(0x2c6)],_0x7860a8=_0xfdb02a[_0x185423(0x2bc)][_0x185423(0x3be)]>0x0?_0xfdb02a[_0x185423(0x2bc)][0x0][_0x185423(0x256)]:Date['now'](),_0x2f3935=(Date[_0x185423(0x25e)]()-_0x7860a8)/(0x3e8*0x3c*0x3c);let _0x279271='';_0xfdb02a[_0x185423(0x3d7)][_0x185423(0x328)]&&_0xfdb02a['currentSystemMode']===SYSTEM_MODES[_0x185423(0x3d9)]&&_0xfdb02a[_0x185423(0x30a)]&&(_0x2f3935>_0x502e7a&&(_0x279271=_0x185423(0x37e)+_0x2f3935['toFixed'](0x1)+_0x185423(0x287))),runGeminiAnalysis(_0xfdb02a,_0x279271)[_0x185423(0x27c)](_0x5233b3=>_0xfdb02a[_0x185423(0x25b)][_0x185423(0x1f4)](_0x5233b3));}async function createDailyDigest(_0x47f772){const _0x1d4fe4=a0_0x18625a;if(!_0x47f772[_0x1d4fe4(0x236)])return;await _0x47f772['setStateAsync'](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()[_0x1d4fe4(0x2f1)](),'ack':!![]});if(!_0x47f772[_0x1d4fe4(0x1e4)]||_0x47f772[_0x1d4fe4(0x289)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x47f772['setStateAsync'](LTM_DP_STATUS,{'val':_0x1d4fe4(0x38c),'ack':!![]});return;}const _0xed11c3=JSON[_0x1d4fe4(0x246)](JSON[_0x1d4fe4(0x24b)](_0x47f772[_0x1d4fe4(0x289)])),_0x3ccdd0=_0xed11c3['length'],_0x1a3742=_0x1d4fe4(0x1c2)+JSON[_0x1d4fe4(0x24b)](_0xed11c3);try{const _0x482794=await _0x47f772[_0x1d4fe4(0x1e4)]['generateContent'](_0x1a3742),_0x2276c0=JSON[_0x1d4fe4(0x246)](_0x482794['response']['text']()[_0x1d4fe4(0x243)](/```json|```/g,'')['trim']());_0x2276c0[_0x1d4fe4(0x2f4)]&&(_0x47f772[_0x1d4fe4(0x1f5)][_0x1d4fe4(0x2e8)]({'timestamp':new Date()[_0x1d4fe4(0x2c4)](),'eventCount':_0x3ccdd0,'summary':_0x2276c0[_0x1d4fe4(0x2f4)],'activityLevel':_0x2276c0[_0x1d4fe4(0x227)],'systemMode':_0x47f772[_0x1d4fe4(0x378)]}),await saveDailyDigests(_0x47f772),_0x47f772[_0x1d4fe4(0x289)]=[],await saveRawEventLog(_0x47f772),await _0x47f772[_0x1d4fe4(0x281)](LTM_DP_STATUS,{'val':_0x1d4fe4(0x2d8)+_0x3ccdd0+'\x20events','ack':!![]}),runPythonHealthCheck(_0x47f772));}catch(_0x2642be){await _0x47f772['setStateAsync'](LTM_DP_STATUS,{'val':_0x1d4fe4(0x324)+_0x2642be[_0x1d4fe4(0x206)],'ack':!![]});}}async function sendMorningBriefing(_0x36a526){const _0x4e8524=a0_0x18625a;if(!_0x36a526[_0x4e8524(0x1e4)])return;_0x36a526[_0x4e8524(0x25b)]['info'](_0x4e8524(0x288));const _0x2e9619=_0x36a526['dailyDigests'][_0x4e8524(0x3be)]>0x0?_0x36a526[_0x4e8524(0x1f5)][_0x36a526[_0x4e8524(0x1f5)][_0x4e8524(0x3be)]-0x1]:null,_0x265629=_0x2e9619&&_0x2e9619[_0x4e8524(0x29b)]?_0x2e9619[_0x4e8524(0x29b)][_0x4e8524(0x2eb)]:_0x4e8524(0x3a6),_0x37b2ca=new Date();_0x37b2ca[_0x4e8524(0x3a0)](0x4,0x0,0x0,0x0);const _0x3a2f07=_0x36a526['eventHistory'][_0x4e8524(0x2c1)](_0x42f322=>new Date(_0x42f322[_0x4e8524(0x256)])>_0x37b2ca),_0x4f35c4=PERSONA_MAPPING[_0x36a526[_0x4e8524(0x3d7)][_0x4e8524(0x283)]||_0x4e8524(0x1f2)],_0x3e2fa6=_0x36a526[_0x4e8524(0x3d7)]['livingContext']||'',_0x2680a4=await getWeatherContext(_0x36a526),_0x19d4cc=await getCalendarContext(_0x36a526),_0x55ae4f=_0x4e8524(0x34f)+_0x4f35c4+_0x4e8524(0x221)+_0x3e2fa6+_0x4e8524(0x39c)+_0x2680a4+'\x20'+_0x19d4cc+_0x4e8524(0x351)+_0x265629+_0x4e8524(0x3a1)+JSON[_0x4e8524(0x24b)](_0x3a2f07['slice'](0x0,0xa))+_0x4e8524(0x205);try{const _0x11ffa5=await _0x36a526[_0x4e8524(0x1e4)][_0x4e8524(0x1de)](_0x55ae4f),_0x214e07=_0x4e8524(0x3ab)+_0x11ffa5['response'][_0x4e8524(0x2ff)]()['trim']();sendNotification(_0x36a526,_0x214e07),_0x36a526[_0x4e8524(0x25b)][_0x4e8524(0x1e1)](_0x4e8524(0x35e));}catch(_0x37b664){_0x36a526[_0x4e8524(0x25b)]['error'](_0x4e8524(0x315)+_0x37b664[_0x4e8524(0x206)]);}}function a0_0x3148(_0x288181,_0x39751c){const _0x48382f=a0_0x5478();return a0_0x3148=function(_0x52c98e,_0x6b8a06){_0x52c98e=_0x52c98e-0x1ba;let _0x54787a=_0x48382f[_0x52c98e];return _0x54787a;},a0_0x3148(_0x288181,_0x39751c);}async function scanForDevices(_0x1f3f0e,_0x3bd74f){const _0x206437=a0_0x18625a;_0x1f3f0e[_0x206437(0x25b)]['info'](_0x206437(0x222));const _0x31d1d4=[],_0x375133=await _0x1f3f0e[_0x206437(0x2e4)]('*'),_0x51a591=await _0x1f3f0e['getForeignObjectsAsync'](_0x206437(0x2a9),'enum'),_0x1e5056=await _0x1f3f0e[_0x206437(0x2e4)]('enum.rooms.*','enum'),_0x102745={};if(_0x51a591)for(const _0x1e9d34 in _0x51a591){const _0x46c539=_0x51a591[_0x1e9d34][_0x206437(0x376)]['members']||[];_0x46c539['forEach'](_0x5cacd4=>{if(!_0x102745[_0x5cacd4])_0x102745[_0x5cacd4]=[];_0x102745[_0x5cacd4]['push'](_0x1e9d34);});}const _0x2927b1={};if(_0x1e5056)for(const _0x1cfa50 in _0x1e5056){const _0x298071=_0x1e5056[_0x1cfa50][_0x206437(0x376)]['members']||[],_0x2874fe=typeof _0x1e5056[_0x1cfa50][_0x206437(0x376)][_0x206437(0x27e)]==='object'?_0x1e5056[_0x1cfa50]['common']['name']['de']:_0x1e5056[_0x1cfa50][_0x206437(0x376)]['name'];_0x298071[_0x206437(0x26a)](_0x1000a9=>_0x2927b1[_0x1000a9]=_0x2874fe);}const _0x22268b=_0x3bd74f['selectedFunctionIds']||[],_0x378a20=_0x3bd74f[_0x206437(0x2bd)]!==![],_0x3ee530=_0x3bd74f[_0x206437(0x1fa)]!==![],_0x271bcd=_0x3bd74f[_0x206437(0x302)]!==![],_0x2646e5=_0x3bd74f[_0x206437(0x3c7)]===!![],_0x4bca14=_0x3bd74f[_0x206437(0x356)]===!![];for(const _0x45ec14 in _0x375133){const _0x52db0c=_0x375133[_0x45ec14];if(_0x52db0c['type']!==_0x206437(0x1cc)||!_0x52db0c['common'])continue;if(ADAPTER_BLACKLIST['some'](_0x47e16b=>_0x45ec14[_0x206437(0x3ba)](_0x47e16b))&&!_0x4bca14)continue;const _0x536b5f=(_0x52db0c[_0x206437(0x376)][_0x206437(0x345)]||'')['toLowerCase']();let _0x45e5d6=(typeof _0x52db0c[_0x206437(0x376)][_0x206437(0x27e)]===_0x206437(0x38f)?_0x52db0c[_0x206437(0x376)]['name']['de']:_0x52db0c['common'][_0x206437(0x27e)])||_0x45ec14;const _0x3bb922=_0x45e5d6[_0x206437(0x2b3)]();let _0x423801=![],_0x17b1c5=![];if(_0x22268b[_0x206437(0x3be)]>0x0){const _0x2cf6d9=_0x102745[_0x45ec14]||[],_0x85abcd=_0x45ec14[_0x206437(0x342)]('.')['slice'](0x0,-0x1)[_0x206437(0x251)]('.'),_0x1bcce8=_0x102745[_0x85abcd]||[];(_0x2cf6d9[_0x206437(0x318)](_0x54e935=>_0x22268b[_0x206437(0x33a)](_0x54e935))||_0x1bcce8[_0x206437(0x318)](_0x2bed29=>_0x22268b[_0x206437(0x33a)](_0x2bed29)))&&(_0x423801=!![],_0x17b1c5=!![]);}if(!_0x423801&&!_0x4bca14){if(HARD_IGNORE_TERMS[_0x206437(0x318)](_0xf1b670=>_0x45ec14[_0x206437(0x33a)](_0xf1b670)||_0x3bb922[_0x206437(0x33a)](_0xf1b670['toLowerCase']())))continue;}if(BAD_NAMES[_0x206437(0x318)](_0x239b28=>_0x3bb922===_0x239b28||_0x3bb922[_0x206437(0x34b)]('.'+_0x239b28))){const _0x1d1547=_0x45ec14[_0x206437(0x342)]('.');if(_0x1d1547[_0x206437(0x3be)]>0x2){const _0x37319c=_0x1d1547['slice'](0x0,-0x1)[_0x206437(0x251)]('.'),_0x1c1847=_0x375133[_0x37319c];if(_0x1c1847&&_0x1c1847[_0x206437(0x376)]&&_0x1c1847['common']['name']){const _0x4e7f57=typeof _0x1c1847[_0x206437(0x376)][_0x206437(0x27e)]===_0x206437(0x38f)?_0x1c1847[_0x206437(0x376)][_0x206437(0x27e)]['de']:_0x1c1847[_0x206437(0x376)]['name'];_0x4e7f57&&!_0x45e5d6[_0x206437(0x33a)](_0x4e7f57)&&(_0x45e5d6=_0x4e7f57+'\x20'+_0x45e5d6);}}}let _0x2305b6='';if(_0x378a20&&(_0x536b5f['includes'](_0x206437(0x2bd))||_0x536b5f[_0x206437(0x33a)](_0x206437(0x31f))||_0x3bb922[_0x206437(0x33a)](_0x206437(0x253))||_0x3bb922[_0x206437(0x33a)](_0x206437(0x248))))_0x2305b6=_0x206437(0x2bd);else{if(!_0x2305b6&&_0x3ee530&&(_0x536b5f[_0x206437(0x33a)](_0x206437(0x220))||_0x536b5f[_0x206437(0x33a)](_0x206437(0x37f))||_0x536b5f[_0x206437(0x33a)]('lock')||_0x536b5f[_0x206437(0x33a)](_0x206437(0x212))||_0x536b5f[_0x206437(0x33a)]('shutter')||_0x3bb922[_0x206437(0x33a)](_0x206437(0x390))||_0x3bb922[_0x206437(0x33a)](_0x206437(0x219))||_0x3bb922[_0x206437(0x33a)](_0x206437(0x1c4))))_0x2305b6=_0x206437(0x220);else{if(!_0x2305b6&&_0x271bcd&&(_0x536b5f[_0x206437(0x33a)](_0x206437(0x29a))||_0x536b5f[_0x206437(0x33a)](_0x206437(0x364))||_0x536b5f[_0x206437(0x33a)](_0x206437(0x2da))||_0x3bb922[_0x206437(0x33a)]('licht')||_0x3bb922[_0x206437(0x33a)](_0x206437(0x3c2))||_0x3bb922[_0x206437(0x33a)](_0x206437(0x2ec)))){if(_0x52db0c[_0x206437(0x376)][_0x206437(0x337)]||_0x536b5f[_0x206437(0x33a)](_0x206437(0x1c6)))_0x2305b6='light';}else{if(!_0x2305b6&&_0x2646e5&&(_0x536b5f[_0x206437(0x33a)](_0x206437(0x3c7))||_0x536b5f[_0x206437(0x33a)](_0x206437(0x258))||_0x536b5f[_0x206437(0x33a)]('thermostat')||_0x3bb922[_0x206437(0x33a)](_0x206437(0x3cb))||_0x3bb922['includes'](_0x206437(0x349))||_0x3bb922['includes'](_0x206437(0x1f7))))_0x2305b6=_0x206437(0x3c7);else{if(!_0x2305b6&&_0x17b1c5)_0x2305b6=_0x206437(0x358);}}}}if(_0x2305b6){let _0x489f91=_0x2927b1[_0x45ec14]||'';if(!_0x489f91){let _0x5abe62=_0x45ec14;for(let _0x65cb11=0x0;_0x65cb11<0x3;_0x65cb11++){const _0x375cf4=_0x5abe62['lastIndexOf']('.');if(_0x375cf4===-0x1)break;_0x5abe62=_0x5abe62[_0x206437(0x2c0)](0x0,_0x375cf4);if(_0x2927b1[_0x5abe62]){_0x489f91=_0x2927b1[_0x5abe62];break;}}}_0x31d1d4[_0x206437(0x2e8)]({'id':_0x45ec14,'name':_0x45e5d6,'location':_0x489f91,'type':_0x2305b6,'logDuplicates':_0x2305b6===_0x206437(0x2bd),'isExit':![],'_score':_0x489f91?0x50:_0x2305b6===_0x206437(0x358)?0x5a:0x28});}}return _0x31d1d4[_0x206437(0x2b0)]((_0x4af59d,_0x113d56)=>_0x113d56[_0x206437(0x1cf)]-_0x4af59d['_score']),_0x31d1d4;}async function executeAutomationAction(_0x488044){const _0x1c7f8e=a0_0x18625a;try{const _0x263c4e=await _0x488044[_0x1c7f8e(0x22d)](_0x1c7f8e(0x36d)),_0x20b4b6=await _0x488044[_0x1c7f8e(0x22d)](_0x1c7f8e(0x2d4));if(_0x263c4e&&_0x263c4e['val']&&_0x20b4b6){const _0x3a585b=_0x263c4e[_0x1c7f8e(0x33b)];let _0x2fa81d=_0x20b4b6[_0x1c7f8e(0x33b)];try{_0x2fa81d=JSON[_0x1c7f8e(0x246)](_0x2fa81d);}catch(_0x1b6fdf){}_0x488044['log'][_0x1c7f8e(0x1e1)](_0x1c7f8e(0x2d2)+_0x3a585b+'\x20=\x20'+_0x2fa81d),await _0x488044[_0x1c7f8e(0x1bf)](_0x3a585b,_0x2fa81d);}else _0x488044[_0x1c7f8e(0x25b)][_0x1c7f8e(0x27f)](_0x1c7f8e(0x386));}catch(_0x999971){_0x488044[_0x1c7f8e(0x25b)][_0x1c7f8e(0x1f4)]('BUTLER\x20Execution\x20Error:\x20'+_0x999971['message']);}}function tryParse(_0xeab486){const _0x2907b9=a0_0x18625a;try{return JSON[_0x2907b9(0x246)](_0xeab486);}catch(_0x558e39){return null;}}async function recordSequence(_0x27eee0,_0x4b9206){const _0x2f93b2=a0_0x18625a,_0x2ebea7=(_0x4b9206['type']||'')['toLowerCase'](),_0x250b16=[_0x2f93b2(0x2bd),'bewegung',_0x2f93b2(0x248),_0x2f93b2(0x234),_0x2f93b2(0x31f),_0x2f93b2(0x220),_0x2f93b2(0x219),_0x2f93b2(0x37f),_0x2f93b2(0x390),_0x2f93b2(0x1c3),'kontakt',_0x2f93b2(0x29a),_0x2f93b2(0x1fb),_0x2f93b2(0x364),_0x2f93b2(0x2ec),_0x2f93b2(0x2da),_0x2f93b2(0x3c2)];if(!_0x250b16[_0x2f93b2(0x318)](_0x56b8a3=>_0x2ebea7[_0x2f93b2(0x33a)](_0x56b8a3))){_0x27eee0['log']['debug'](_0x2f93b2(0x398)+_0x4b9206['id']+_0x2f93b2(0x3d6)+_0x4b9206['type']+'\x27\x20not\x20in\x20allowed\x20list)');return;}if(!_0x4b9206[_0x2f93b2(0x36e)]){_0x27eee0[_0x2f93b2(0x25b)]['debug'](_0x2f93b2(0x398)+_0x4b9206['id']+_0x2f93b2(0x357)+_0x4b9206[_0x2f93b2(0x36e)]+')');return;}_0x27eee0[_0x2f93b2(0x25b)][_0x2f93b2(0x369)](_0x2f93b2(0x1bb)+_0x4b9206['id']+'\x20('+_0x4b9206['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x4450b3={'loc':_0x4b9206[_0x2f93b2(0x35d)]||_0x2f93b2(0x1cb),'id':_0x4b9206['id'],'ts':Date[_0x2f93b2(0x25e)]()};activeSequence[_0x2f93b2(0x2e8)](_0x4450b3),_0x27eee0[_0x2f93b2(0x25b)]['debug'](_0x2f93b2(0x232)+_0x4450b3[_0x2f93b2(0x2df)]+_0x2f93b2(0x38d)+activeSequence[_0x2f93b2(0x3be)]+')'),sequenceTimer=setTimeout(async()=>{const _0x1277a0=_0x2f93b2;activeSequence[_0x1277a0(0x3be)]>0x1?await saveCompletedSequence(_0x27eee0):(_0x27eee0[_0x1277a0(0x25b)][_0x1277a0(0x369)]('[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20'+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x4b8ec5){const _0x5d4351=a0_0x18625a;try{_0x4b8ec5[_0x5d4351(0x25b)][_0x5d4351(0x1e1)](_0x5d4351(0x38b)+activeSequence[_0x5d4351(0x3be)]+_0x5d4351(0x2b8));const _0x17aeca=await _0x4b8ec5['getStateAsync'](_0x5d4351(0x297));let _0x26cfcd=[];if(_0x17aeca&&_0x17aeca[_0x5d4351(0x33b)])try{_0x26cfcd=JSON['parse'](_0x17aeca[_0x5d4351(0x33b)]);}catch(_0x401b66){}const _0x4d69ed=activeSequence[0x0]['ts'],_0x37260a=activeSequence[_0x5d4351(0x3ca)](_0x350d03=>({'loc':_0x350d03['loc'],'t_delta':Math['round']((_0x350d03['ts']-_0x4d69ed)/0x3e8)})),_0x33d1bd={'timestamp':new Date(_0x4d69ed)[_0x5d4351(0x2c4)](),'steps':_0x37260a,'duration':Math['round']((activeSequence[activeSequence[_0x5d4351(0x3be)]-0x1]['ts']-_0x4d69ed)/0x3e8),'daytime':new Date(_0x4d69ed)['getHours']()};_0x26cfcd[_0x5d4351(0x2e8)](_0x33d1bd),_0x26cfcd[_0x5d4351(0x3be)]>MAX_TRAINING_SET_SIZE&&_0x26cfcd[_0x5d4351(0x1c0)](),await _0x4b8ec5[_0x5d4351(0x281)](_0x5d4351(0x297),{'val':JSON[_0x5d4351(0x24b)](_0x26cfcd),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x47de9a){_0x4b8ec5['log'][_0x5d4351(0x1f4)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x47de9a[_0x5d4351(0x206)]);}}async function getOutsideTemperatureNumeric(_0x4601ee){const _0x17f699=a0_0x18625a;if(_0x4601ee[_0x17f699(0x3d7)][_0x17f699(0x237)])try{const _0x44ed9e=await _0x4601ee[_0x17f699(0x330)](_0x4601ee[_0x17f699(0x3d7)][_0x17f699(0x237)]);if(_0x44ed9e&&_0x44ed9e[_0x17f699(0x33b)]!==undefined&&_0x44ed9e[_0x17f699(0x33b)]!==null){const _0x5cfbf3=parseFloat(_0x44ed9e['val']);if(!isNaN(_0x5cfbf3))return _0x5cfbf3;}}catch(_0x4fa36a){_0x4601ee['log'][_0x17f699(0x27f)]('Error\x20reading\x20outdoor\x20sensor\x20'+_0x4601ee[_0x17f699(0x3d7)][_0x17f699(0x237)]+':\x20'+_0x4fa36a[_0x17f699(0x206)]);}const _0x3ddc3e=_0x4601ee[_0x17f699(0x3d7)][_0x17f699(0x314)];if(!_0x4601ee[_0x17f699(0x3d7)]['useWeather']||!_0x3ddc3e)return null;try{let _0x4a1eac='';if(_0x3ddc3e['includes']('accuweather'))_0x4a1eac=_0x3ddc3e+_0x17f699(0x3b5);else{if(_0x3ddc3e[_0x17f699(0x33a)](_0x17f699(0x317)))_0x4a1eac=_0x3ddc3e+_0x17f699(0x384);else{if(_0x3ddc3e[_0x17f699(0x33a)](_0x17f699(0x366)))_0x4a1eac=_0x3ddc3e+_0x17f699(0x3c6);else{if(_0x3ddc3e['includes'](_0x17f699(0x2a3)))_0x4a1eac=_0x3ddc3e+_0x17f699(0x359);}}}if(_0x4a1eac){const _0x3197f3=await _0x4601ee[_0x17f699(0x330)](_0x4a1eac);if(_0x3197f3&&_0x3197f3[_0x17f699(0x33b)]!==undefined&&_0x3197f3[_0x17f699(0x33b)]!==null)return parseFloat(_0x3197f3[_0x17f699(0x33b)]);}}catch(_0x31710d){}return null;}async function recordThermodynamics(_0x131fa4,_0x4f4880,_0x31e34d,_0x19973e){const _0x268161=a0_0x18625a,_0x3de070=await getOutsideTemperatureNumeric(_0x131fa4),_0x5af6e6=await _0x131fa4[_0x268161(0x22d)](_0x268161(0x301));let _0x4fae63=[];if(_0x5af6e6&&_0x5af6e6[_0x268161(0x33b)])try{_0x4fae63=JSON[_0x268161(0x246)](_0x5af6e6[_0x268161(0x33b)]);}catch(_0x458088){}_0x4fae63['push']({'ts':Date[_0x268161(0x25e)](),'room':_0x19973e||_0x268161(0x1cb),'t_in':_0x31e34d,'t_out':_0x3de070});if(_0x4fae63['length']>THERMO_LOG_SIZE)_0x4fae63[_0x268161(0x1c0)]();await _0x131fa4[_0x268161(0x281)](_0x268161(0x301),{'val':JSON['stringify'](_0x4fae63),'ack':!![]});}async function processSensorEvent(_0x431bae,_0x52c750,_0x498cdf,_0x1e5d2e){const _0x3c2b4e=a0_0x18625a;if(!_0x1e5d2e)return;const _0x201208=_0x498cdf[_0x3c2b4e(0x33b)],_0x364cd8=Date['now']();_0x431bae[_0x3c2b4e(0x25b)][_0x3c2b4e(0x369)](_0x3c2b4e(0x2ce)+_0x52c750+_0x3c2b4e(0x247)+_0x201208);const _0xa9481c=_0x431bae[_0x3c2b4e(0x363)][_0x52c750];_0x431bae[_0x3c2b4e(0x363)][_0x52c750]=_0x201208;if(!_0x1e5d2e['logDuplicates']&&_0xa9481c!=undefined&&_0xa9481c==_0x201208){_0x431bae[_0x3c2b4e(0x25b)][_0x3c2b4e(0x369)](_0x3c2b4e(0x379)+_0x1e5d2e[_0x3c2b4e(0x27e)]+_0x3c2b4e(0x1f3)+_0x201208+')');return;}const _0x1e4aa7=(_0x1e5d2e[_0x3c2b4e(0x235)]||'')[_0x3c2b4e(0x2b3)](),_0x54c754=_0x1e4aa7[_0x3c2b4e(0x33a)](_0x3c2b4e(0x3c7))||_0x1e4aa7[_0x3c2b4e(0x33a)](_0x3c2b4e(0x1fe))||_0x1e4aa7['includes'](_0x3c2b4e(0x349))||_0x1e4aa7[_0x3c2b4e(0x33a)](_0x3c2b4e(0x1f7));_0x431bae['isProVersion']&&_0x54c754&&recordThermodynamics(_0x431bae,_0x52c750,_0x201208,_0x1e5d2e[_0x3c2b4e(0x35d)]);const _0x168535={'timestamp':_0x364cd8,'id':_0x52c750,'name':_0x1e5d2e['name'],'type':_0x1e5d2e[_0x3c2b4e(0x235)],'location':_0x1e5d2e[_0x3c2b4e(0x35d)],'value':_0x201208};_0x431bae[_0x3c2b4e(0x2bc)][_0x3c2b4e(0x2fa)](_0x168535);if(_0x431bae[_0x3c2b4e(0x2bc)][_0x3c2b4e(0x3be)]>HISTORY_MAX_SIZE)_0x431bae[_0x3c2b4e(0x2bc)][_0x3c2b4e(0x3c0)]();await _0x431bae['setStateAsync'](_0x3c2b4e(0x2ba),{'val':JSON[_0x3c2b4e(0x24b)](_0x168535),'ack':!![]}),await _0x431bae[_0x3c2b4e(0x281)](_0x3c2b4e(0x252),{'val':JSON[_0x3c2b4e(0x24b)](_0x431bae['eventHistory']),'ack':!![]});_0x431bae[_0x3c2b4e(0x236)]&&(_0x431bae[_0x3c2b4e(0x289)][_0x3c2b4e(0x2e8)](_0x168535),await saveRawEventLog(_0x431bae),recordSequence(_0x431bae,_0x168535));if(_0x1e5d2e['isExit']&&_0x201208===!![]){if(_0x431bae[_0x3c2b4e(0x30a)]&&!_0x431bae[_0x3c2b4e(0x1c7)])_0x431bae[_0x3c2b4e(0x25b)][_0x3c2b4e(0x1e1)](_0x3c2b4e(0x39a)+_0x1e5d2e['name']+_0x3c2b4e(0x216)),startExitTimer(_0x431bae);else!_0x431bae[_0x3c2b4e(0x30a)]&&(_0x431bae[_0x3c2b4e(0x25b)][_0x3c2b4e(0x1e1)](_0x3c2b4e(0x2cf)+_0x1e5d2e['name']+_0x3c2b4e(0x2a5)),await setPresence(_0x431bae,!![]));}else _0x1e5d2e[_0x3c2b4e(0x235)]===_0x3c2b4e(0x2bd)&&_0x201208===!![]&&(_0x431bae[_0x3c2b4e(0x1e8)]&&(_0x431bae['log'][_0x3c2b4e(0x1e1)](_0x3c2b4e(0x34e)),abortExitTimer(_0x431bae)),!_0x431bae['isPresent']&&_0x431bae[_0x3c2b4e(0x378)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x431bae,!![]));}async function runGeminiAnalysis(_0x424786,_0x1fd9d7=''){const _0x3cdd84=a0_0x18625a;if(!_0x424786['geminiModel'])return;if(_0x424786[_0x3cdd84(0x2bc)][_0x3cdd84(0x3be)]===0x0)return;const _0x55fc1b=_0x424786[_0x3cdd84(0x2bc)][_0x3cdd84(0x3d3)](0x0,0xf),_0x3bf708=await getWeatherContext(_0x424786),_0x698280=_0x424786['currentSystemMode'],_0x21045d=PERSONA_MAPPING[_0x424786[_0x3cdd84(0x3d7)][_0x3cdd84(0x283)]||_0x3cdd84(0x1f2)],_0x54154d=_0x424786[_0x3cdd84(0x3d7)][_0x3cdd84(0x1be)]||'Keine\x20Details.';let _0x41a361='Unbekannt';try{const _0x2f4688=await _0x424786[_0x3cdd84(0x22d)](_0x3cdd84(0x397));if(_0x2f4688&&_0x2f4688['val'])_0x41a361=_0x2f4688[_0x3cdd84(0x33b)];}catch(_0x52a2c9){}let _0x2af3fe=![];try{const _0x1ab18b=await _0x424786['getStateAsync'](_0x3cdd84(0x32a));if(_0x1ab18b&&_0x1ab18b['val'])_0x2af3fe=!![];}catch(_0x27bdae){}const _0x496666=_0x3cdd84(0x29d)+_0x21045d+'.\x0a\x20\x20\x20\x20KONTEXT:\x20'+_0x54154d+_0x3cdd84(0x372)+_0x698280+_0x3cdd84(0x3d0)+_0x3bf708+_0x3cdd84(0x309)+(_0x1fd9d7||_0x3cdd84(0x284))+_0x3cdd84(0x26c)+(_0x424786[_0x3cdd84(0x30a)]?'Anwesend':'ABWESEND')+_0x3cdd84(0x1ee)+_0x41a361+_0x3cdd84(0x1d2)+JSON[_0x3cdd84(0x24b)](_0x55fc1b)+_0x3cdd84(0x326);try{const _0x2c58ea=await _0x424786[_0x3cdd84(0x1e4)][_0x3cdd84(0x1de)](_0x496666),_0x3cb2c5=_0x2c58ea[_0x3cdd84(0x2ad)][_0x3cdd84(0x2ff)]()[_0x3cdd84(0x243)](/```json|```/g,'')[_0x3cdd84(0x223)](),_0x3a1e8a=JSON[_0x3cdd84(0x246)](_0x3cb2c5);await _0x424786['setStateAsync']('analysis.lastResult',{'val':JSON[_0x3cdd84(0x24b)](_0x3a1e8a),'ack':!![]});_0x3a1e8a[_0x3cdd84(0x2f4)]&&await _0x424786[_0x3cdd84(0x281)](_0x3cdd84(0x1ce),{'val':_0x3a1e8a[_0x3cdd84(0x2f4)],'ack':!![]});const _0x3ba0f8={'timestamp':Date[_0x3cdd84(0x25e)](),'id':Date[_0x3cdd84(0x25e)]()[_0x3cdd84(0x22f)](),'analysis':{'activity':{'summary':_0x3a1e8a[_0x3cdd84(0x2f4)]||_0x3cdd84(0x2c9),'isAlert':_0x3a1e8a[_0x3cdd84(0x1f1)]||![],'alertReason':_0x3a1e8a[_0x3cdd84(0x1dd)]},'comfort':{'automationProposal':_0x3a1e8a['automationProposal']}}};await updateAnalysisHistory(_0x424786,_0x3ba0f8);const _0x4b7020=_0x3a1e8a[_0x3cdd84(0x1f1)]||![];_0x4b7020!==_0x424786[_0x3cdd84(0x38e)]&&(await _0x424786[_0x3cdd84(0x281)](_0x3cdd84(0x1f0),{'val':_0x4b7020,'ack':!![]}),_0x424786[_0x3cdd84(0x38e)]=_0x4b7020,_0x4b7020&&(await _0x424786[_0x3cdd84(0x281)](_0x3cdd84(0x2de),{'val':_0x3a1e8a['alertReason'],'ack':!![]}),sendNotification(_0x424786,'âš ï¸\x20ALARM:\x20'+_0x3a1e8a[_0x3cdd84(0x1dd)],![],_0x3a1e8a['isEmergency']))),_0x3a1e8a[_0x3cdd84(0x20f)]&&_0x3a1e8a[_0x3cdd84(0x20f)][_0x3cdd84(0x1d7)]&&_0x3a1e8a[_0x3cdd84(0x20f)][_0x3cdd84(0x39e)]&&(_0x424786[_0x3cdd84(0x25b)][_0x3cdd84(0x1e1)]('ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20'+_0x3a1e8a[_0x3cdd84(0x20f)]['description']),await _0x424786['setStateAsync'](_0x3cdd84(0x382),{'val':!![],'ack':!![]}),await _0x424786[_0x3cdd84(0x281)](_0x3cdd84(0x3b1),{'val':_0x3a1e8a[_0x3cdd84(0x20f)]['description'],'ack':!![]}),await _0x424786['setStateAsync'](_0x3cdd84(0x36d),{'val':_0x3a1e8a[_0x3cdd84(0x20f)]['targetId'],'ack':!![]}),await _0x424786[_0x3cdd84(0x281)]('analysis.automation.targetValue',{'val':JSON[_0x3cdd84(0x24b)](_0x3a1e8a[_0x3cdd84(0x20f)][_0x3cdd84(0x23c)]),'ack':!![]}),_0x2af3fe&&(_0x424786[_0x3cdd84(0x25b)][_0x3cdd84(0x1e1)](_0x3cdd84(0x2f5)+_0x3a1e8a[_0x3cdd84(0x20f)]['targetId']+_0x3cdd84(0x291)),await executeAutomationAction(_0x424786)));}catch(_0x66f5f7){_0x424786[_0x3cdd84(0x25b)]['error'](_0x3cdd84(0x21b)+_0x66f5f7[_0x3cdd84(0x206)]);}}function installPythonDependencies(_0x593aaf){const _0x1daf11=a0_0x18625a;if(_0x593aaf[_0x1daf11(0x3bc)])return;_0x593aaf[_0x1daf11(0x3bc)]=!![];const _0x433e7d=path[_0x1daf11(0x251)](__dirname,'python_service',_0x1daf11(0x2dd));_0x593aaf[_0x1daf11(0x25b)][_0x1daf11(0x1e1)]('ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20'+_0x433e7d+_0x1daf11(0x291)),stopPythonService(_0x593aaf);const _0x282273=_0x1daf11(0x25d)+_0x433e7d+_0x1daf11(0x32f);exec(_0x282273,(_0x5a88c4,_0x54d0af,_0x4a2d18)=>{const _0x59ee4b=_0x1daf11,_0x1a580a=_0x4a2d18&&_0x4a2d18[_0x59ee4b(0x33a)](_0x59ee4b(0x2b2))||_0x5a88c4&&_0x5a88c4[_0x59ee4b(0x206)]['includes'](_0x59ee4b(0x2b2));if(_0x1a580a){_0x593aaf[_0x59ee4b(0x25b)][_0x59ee4b(0x27f)](_0x59ee4b(0x254)),exec(_0x59ee4b(0x2ea),(_0x24b109,_0xb21711,_0x39272c)=>{const _0x3a429d=_0x59ee4b;_0x24b109?(_0x593aaf[_0x3a429d(0x25b)][_0x3a429d(0x1f4)](_0x3a429d(0x396)),_0x593aaf[_0x3a429d(0x25b)][_0x3a429d(0x1f4)](_0x3a429d(0x276)),_0x593aaf[_0x3a429d(0x3bc)]=![]):(_0x593aaf[_0x3a429d(0x25b)]['info'](_0x3a429d(0x320)),exec(_0x3a429d(0x25d)+_0x433e7d+_0x3a429d(0x2fd),(_0x6d3b7a,_0x964100,_0x29d9fa)=>{const _0x50a453=_0x3a429d;_0x6d3b7a?_0x593aaf[_0x50a453(0x25b)][_0x50a453(0x1f4)](_0x50a453(0x39d)+_0x6d3b7a[_0x50a453(0x206)]):(_0x593aaf[_0x50a453(0x25b)][_0x50a453(0x1e1)](_0x50a453(0x261)),startPythonService(_0x593aaf)),_0x593aaf[_0x50a453(0x3bc)]=![];}));});return;}_0x593aaf[_0x59ee4b(0x3bc)]=![],_0x5a88c4?(_0x593aaf[_0x59ee4b(0x25b)][_0x59ee4b(0x1f4)](_0x59ee4b(0x2e3)),_0x593aaf[_0x59ee4b(0x25b)]['error']('Details:\x20'+(_0x4a2d18||_0x5a88c4[_0x59ee4b(0x206)]))):(_0x593aaf['log'][_0x59ee4b(0x1e1)](_0x59ee4b(0x350)),startPythonService(_0x593aaf));});}function sendToPython(_0x1c71e2,_0x3d3a18,_0x2c79b6={}){const _0x1f2e04=a0_0x18625a;if(!_0x1c71e2[_0x1f2e04(0x2a6)]||!_0x1c71e2[_0x1f2e04(0x2a6)]['stdin'][_0x1f2e04(0x348)])return;const _0x4b8cc9=JSON[_0x1f2e04(0x24b)]({'command':_0x3d3a18,..._0x2c79b6});try{_0x1c71e2[_0x1f2e04(0x2a6)]['stdin'][_0x1f2e04(0x337)](_0x4b8cc9+'\x0a');}catch(_0x2d4681){_0x1c71e2['log']['error']('Failed\x20to\x20send\x20to\x20Python:\x20'+_0x2d4681[_0x1f2e04(0x206)]);}}function runPythonHealthCheck(_0x24fd5f){const _0x5bcb85=a0_0x18625a;if(!_0x24fd5f[_0x5bcb85(0x1f5)]||_0x24fd5f[_0x5bcb85(0x1f5)][_0x5bcb85(0x3be)]<0x2){_0x24fd5f[_0x5bcb85(0x25b)]['info'](_0x5bcb85(0x23d));return;}const _0x367e23=_0x24fd5f[_0x5bcb85(0x1f5)]['map'](_0x311f3e=>{const _0x3971b9=_0x5bcb85,_0xb88a2b=(_0x311f3e[_0x3971b9(0x227)]||'')[_0x3971b9(0x2b3)]();return ACTIVITY_LEVEL_MAP[_0xb88a2b]||0x32;});_0x24fd5f['log']['info'](_0x5bcb85(0x2f3)+_0x367e23[_0x5bcb85(0x3be)]+_0x5bcb85(0x211)),sendToPython(_0x24fd5f,_0x5bcb85(0x336),{'values':_0x367e23,'tag':_0x5bcb85(0x32d)});}function handlePythonResult(_0x56325e,_0x363e75){const _0x1f63ba=a0_0x18625a;if(_0x363e75[_0x1f63ba(0x235)]==='PONG')_0x56325e['log'][_0x1f63ba(0x369)](_0x1f63ba(0x33e));else{if(_0x363e75[_0x1f63ba(0x235)]===_0x1f63ba(0x298)){const {tag:_0x449f14,diagnosis:_0x59da15,change_percent:_0x16bcba}=_0x363e75[_0x1f63ba(0x323)];_0x56325e['log'][_0x1f63ba(0x1e1)](_0x1f63ba(0x280)+_0x449f14+_0x1f63ba(0x2a0)+_0x59da15+'\x20('+_0x16bcba+'%)'),_0x56325e['setStateAsync'](_0x1f63ba(0x33c),{'val':_0x59da15,'ack':!![]}),_0x56325e[_0x1f63ba(0x281)](_0x1f63ba(0x22e),{'val':_0x16bcba,'ack':!![]});}else{if(_0x363e75['type']===_0x1f63ba(0x1dc)){const {success:_0x380a9b,details:_0x2cfd89}=_0x363e75[_0x1f63ba(0x323)];_0x380a9b?(_0x56325e[_0x1f63ba(0x25b)]['info'](_0x1f63ba(0x20c)+_0x2cfd89),_0x56325e['setStateAsync']('analysis.training.status',{'val':'Success:\x20'+new Date()[_0x1f63ba(0x377)](),'ack':!![]})):(_0x56325e['log'][_0x1f63ba(0x1f4)](_0x1f63ba(0x370)+(_0x2cfd89||'Unknown\x20error')),_0x56325e[_0x1f63ba(0x281)](_0x1f63ba(0x2cb),{'val':_0x1f63ba(0x3a7)+_0x2cfd89,'ack':!![]}));}}}}function startPythonService(_0x2a8952){const _0x5c5ba7=a0_0x18625a;try{const _0x31efb1=path[_0x5c5ba7(0x251)](__dirname,'python_service',_0x5c5ba7(0x2aa));_0x2a8952[_0x5c5ba7(0x25b)][_0x5c5ba7(0x1e1)]('ðŸ\x20Starting\x20Python\x20Sidecar:\x20'+_0x31efb1),_0x2a8952[_0x5c5ba7(0x2a6)]=spawn('python3',[_0x31efb1]),_0x2a8952[_0x5c5ba7(0x2a6)][_0x5c5ba7(0x1ff)]['on'](_0x5c5ba7(0x2c7),_0x5fe44d=>{const _0x1c279d=_0x5c5ba7,_0x4cb79f=_0x5fe44d[_0x1c279d(0x22f)]()['split']('\x0a');_0x4cb79f['forEach'](_0x3510f1=>{const _0x3294f3=_0x1c279d,_0x2b77c0=_0x3510f1[_0x3294f3(0x223)]();if(!_0x2b77c0)return;if(_0x2b77c0[_0x3294f3(0x3ba)](_0x3294f3(0x1db)))_0x2a8952[_0x3294f3(0x25b)]['debug'](_0x3294f3(0x1d5)+_0x2b77c0[_0x3294f3(0x2c0)](0x5)[_0x3294f3(0x223)]());else{if(_0x2b77c0['startsWith'](_0x3294f3(0x395)))try{const _0xeaa99f=JSON['parse'](_0x2b77c0[_0x3294f3(0x2c0)](0x8)['trim']());handlePythonResult(_0x2a8952,_0xeaa99f);}catch(_0x3a9203){_0x2a8952['log']['warn'](_0x3294f3(0x3de)+_0x2b77c0);}}(_0x2b77c0['includes'](_0x3294f3(0x239))||_0x2b77c0[_0x3294f3(0x33a)](_0x3294f3(0x21a))||_0x2b77c0[_0x3294f3(0x33a)]('ML-Libs\x20fehlen'))&&(_0x2a8952[_0x3294f3(0x25b)]['warn'](_0x3294f3(0x39b)),installPythonDependencies(_0x2a8952));});}),_0x2a8952[_0x5c5ba7(0x2a6)][_0x5c5ba7(0x30d)]['on'](_0x5c5ba7(0x2c7),_0x745fa5=>{const _0x4ab6d7=_0x5c5ba7,_0x26498c=_0x745fa5[_0x4ab6d7(0x22f)]()[_0x4ab6d7(0x223)]();_0x2a8952[_0x4ab6d7(0x25b)][_0x4ab6d7(0x1f4)](_0x4ab6d7(0x1d6)+_0x26498c);}),_0x2a8952[_0x5c5ba7(0x2a6)]['on'](_0x5c5ba7(0x266),_0x5ed170=>{const _0x47ebb1=_0x5c5ba7;_0x2a8952[_0x47ebb1(0x25b)][_0x47ebb1(0x1e1)]('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x5ed170),_0x2a8952[_0x47ebb1(0x2a6)]=null;}),_0x2a8952['pythonProcess']['on'](_0x5c5ba7(0x1f4),_0x51ac63=>{const _0x2abd66=_0x5c5ba7;_0x2a8952[_0x2abd66(0x25b)][_0x2abd66(0x27f)](_0x2abd66(0x3aa)+_0x51ac63[_0x2abd66(0x206)]);});}catch(_0x157b33){_0x2a8952[_0x5c5ba7(0x25b)][_0x5c5ba7(0x1f4)]('Error\x20launching\x20Python\x20service:\x20'+_0x157b33[_0x5c5ba7(0x206)]);}}function stopPythonService(_0x1639c1){const _0x5c5e98=a0_0x18625a;if(_0x1639c1[_0x5c5e98(0x2a6)]){_0x1639c1[_0x5c5e98(0x25b)][_0x5c5e98(0x1e1)](_0x5c5e98(0x1e3));try{_0x1639c1[_0x5c5e98(0x2a6)][_0x5c5e98(0x201)]();}catch(_0x55abe9){_0x1639c1['log'][_0x5c5e98(0x27f)](_0x5c5e98(0x375)+_0x55abe9[_0x5c5e98(0x206)]);}_0x1639c1[_0x5c5e98(0x2a6)]=null;}}class CogniLiving extends utils[a0_0x18625a(0x1f6)]{constructor(_0x13dd99){const _0x488bc5=a0_0x18625a;super({..._0x13dd99,'name':'cogni-living'}),this[_0x488bc5(0x2bc)]=[],this[_0x488bc5(0x3dc)]=[],this[_0x488bc5(0x36b)]=[],this[_0x488bc5(0x289)]=[],this[_0x488bc5(0x1f5)]=[],this['sensorLastValues']={},this[_0x488bc5(0x2cd)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this[_0x488bc5(0x312)]=null,this[_0x488bc5(0x1e4)]=null,this[_0x488bc5(0x378)]=SYSTEM_MODES[_0x488bc5(0x3d9)],this[_0x488bc5(0x236)]=![],this['lastAlertState']=![],this[_0x488bc5(0x3bd)]=_0x488bc5(0x208),this['analysisTimer']=null,this['ltmJob']=null,this['modeResetJob']=null,this[_0x488bc5(0x365)]=null,this[_0x488bc5(0x1c5)]=null,this[_0x488bc5(0x2a6)]=null,this[_0x488bc5(0x3bc)]=![],this['on'](_0x488bc5(0x3e1),this[_0x488bc5(0x30e)][_0x488bc5(0x34d)](this)),this['on'](_0x488bc5(0x23e),this['onStateChange']['bind'](this)),this['on'](_0x488bc5(0x3b3),this['onUnload'][_0x488bc5(0x34d)](this)),this['on'](_0x488bc5(0x206),this['onMessage'][_0x488bc5(0x34d)](this));}async[a0_0x18625a(0x30e)](){const _0x3f8ed9=a0_0x18625a;this['log'][_0x3f8ed9(0x1e1)](_0x3f8ed9(0x3b2)+this[_0x3f8ed9(0x3b7)]+')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE'),await initZombies(this),this['config'][_0x3f8ed9(0x22b)]=this[_0x3f8ed9(0x3d7)][_0x3f8ed9(0x22b)]||'';try{this[_0x3f8ed9(0x236)]=await checkLicense(this,this[_0x3f8ed9(0x3d7)][_0x3f8ed9(0x22b)]);}catch(_0x1f66c6){}if(!this[_0x3f8ed9(0x3d7)][_0x3f8ed9(0x2c6)]||this[_0x3f8ed9(0x3d7)][_0x3f8ed9(0x2c6)]<0.1)this['config']['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x3f8ed9(0x3d7)]['geminiApiKey'])try{this[_0x3f8ed9(0x312)]=new GoogleGenerativeAI(this[_0x3f8ed9(0x3d7)][_0x3f8ed9(0x1eb)]),this['geminiModel']=this[_0x3f8ed9(0x312)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x3f8ed9(0x25b)]['info'](_0x3f8ed9(0x339));}catch(_0x1e3a06){this['log'][_0x3f8ed9(0x1f4)]('Gemini\x20Init\x20Error:\x20'+_0x1e3a06[_0x3f8ed9(0x206)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates']('analysis.trigger'),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x3f8ed9(0x25a)),this['subscribeStates'](_0x3f8ed9(0x332)),this[_0x3f8ed9(0x225)](_0x3f8ed9(0x25f)),this['subscribeStates'](_0x3f8ed9(0x32a)),this['subscribeStates'](_0x3f8ed9(0x392)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x3f8ed9(0x1e2)])clearInterval(this[_0x3f8ed9(0x1e2)]);const _0x3e9ae3=this[_0x3f8ed9(0x3d7)]['analysisInterval']||0xf;_0x3e9ae3>0x0&&(this['log'][_0x3f8ed9(0x1e1)](_0x3f8ed9(0x20a)+_0x3e9ae3+_0x3f8ed9(0x29e)),this[_0x3f8ed9(0x1e2)]=setInterval(()=>{runAutopilot(this);},_0x3e9ae3*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x2e40d6=_0x3f8ed9;this[_0x2e40d6(0x2a6)]&&runPythonHealthCheck(this);},0x1388);}['onUnload'](_0x540975){const _0x2531ca=a0_0x18625a;if(this[_0x2531ca(0x1e2)])clearInterval(this['analysisTimer']);if(this[_0x2531ca(0x365)])clearInterval(this[_0x2531ca(0x365)]);if(this[_0x2531ca(0x305)])this[_0x2531ca(0x305)][_0x2531ca(0x3ce)]();if(this[_0x2531ca(0x2d1)])this[_0x2531ca(0x2d1)]['cancel']();if(this[_0x2531ca(0x1c5)])this[_0x2531ca(0x1c5)][_0x2531ca(0x3ce)]();if(this[_0x2531ca(0x1e8)])clearTimeout(this['exitTimer']);if(this[_0x2531ca(0x230)])clearTimeout(this[_0x2531ca(0x230)]);stopPythonService(this),_0x540975();}async[a0_0x18625a(0x322)](_0x162fad,_0x2630d1){const _0x417f1e=a0_0x18625a;if(!_0x2630d1)return;if(_0x162fad[_0x417f1e(0x33a)](_0x417f1e(0x1bd))&&_0x162fad[_0x417f1e(0x34b)](_0x417f1e(0x31e))&&_0x2630d1['val']){await handleTelegramResponse(this,_0x2630d1[_0x417f1e(0x33b)]);return;}if(_0x162fad===this['namespace']+'.'+SYSTEM_DP_MODE){_0x2630d1[_0x417f1e(0x33b)]&&Object[_0x417f1e(0x346)](SYSTEM_MODES)[_0x417f1e(0x33a)](_0x2630d1[_0x417f1e(0x33b)])&&(this[_0x417f1e(0x378)]=_0x2630d1['val'],_0x2630d1['val']===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x2630d1['ack'])this['setState'](_0x162fad,{'val':this[_0x417f1e(0x378)],'ack':!![]});return;}if(!_0x2630d1[_0x417f1e(0x257)]){_0x162fad[_0x417f1e(0x33a)]('analysis.trigger')&&_0x2630d1[_0x417f1e(0x33b)]&&(this[_0x417f1e(0x3c9)](_0x162fad,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x162fad[_0x417f1e(0x33a)]('triggerDailyDigest')&&_0x2630d1[_0x417f1e(0x33b)]){this['setState'](_0x162fad,{'val':![],'ack':!![]});if(this[_0x417f1e(0x236)])createDailyDigest(this);}_0x162fad[_0x417f1e(0x33a)](_0x417f1e(0x2e1))&&_0x2630d1[_0x417f1e(0x33b)]&&(this[_0x417f1e(0x3c9)](_0x162fad,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x162fad['includes'](_0x417f1e(0x24f))&&_0x2630d1[_0x417f1e(0x33b)]&&(this['setState'](_0x162fad,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x162fad[_0x417f1e(0x33a)]('analysis.training.triggerSecurity')&&_0x2630d1[_0x417f1e(0x33b)]){this[_0x417f1e(0x3c9)](_0x162fad,{'val':![],'ack':!![]});if(!this[_0x417f1e(0x236)]){this['log']['warn'](_0x417f1e(0x2ed));return;}try{const _0x1e57b2=await this['getStateAsync']('LTM.trainingData.sequences');if(_0x1e57b2&&_0x1e57b2[_0x417f1e(0x33b)]){const _0x5b6695=JSON[_0x417f1e(0x246)](_0x1e57b2[_0x417f1e(0x33b)]);this[_0x417f1e(0x25b)][_0x417f1e(0x1e1)]('ðŸ§ \x20Triggering\x20Security\x20Training\x20with\x20'+_0x5b6695['length']+'\x20sequences...'),this['setStateAsync'](_0x417f1e(0x2cb),{'val':_0x417f1e(0x3cf),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x5b6695});}else this[_0x417f1e(0x25b)]['warn']('No\x20training\x20sequences\x20found.'),this[_0x417f1e(0x281)]('analysis.training.status',{'val':_0x417f1e(0x335),'ack':!![]});}catch(_0x39a8f6){this[_0x417f1e(0x25b)][_0x417f1e(0x1f4)](_0x417f1e(0x2d5)+_0x39a8f6['message']);}}return;}if(this[_0x417f1e(0x3d7)]['presenceDevices']&&this[_0x417f1e(0x3d7)][_0x417f1e(0x1fd)]['includes'](_0x162fad)){await checkWifiPresence(this);return;}const _0x35858f=(this[_0x417f1e(0x3d7)]['devices']||[])[_0x417f1e(0x28e)](_0x509be9=>_0x509be9['id']===_0x162fad);if(_0x35858f)processSensorEvent(this,_0x162fad,_0x2630d1,_0x35858f);}async[a0_0x18625a(0x3cc)](_0x1ecdb1){const _0x3d7669=a0_0x18625a;if(typeof _0x1ecdb1===_0x3d7669(0x38f)&&_0x1ecdb1[_0x3d7669(0x206)])try{if(_0x1ecdb1['command']===_0x3d7669(0x2a1)){const _0x40d97b=_0x1ecdb1[_0x3d7669(0x206)]['apiKey']||this[_0x3d7669(0x3d7)][_0x3d7669(0x1eb)];if(!_0x40d97b)return this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':![],'message':_0x3d7669(0x361)},_0x1ecdb1[_0x3d7669(0x310)]);try{const _0x46483b=new GoogleGenerativeAI(_0x40d97b),_0x16c460=_0x46483b[_0x3d7669(0x226)]({'model':GEMINI_MODEL}),_0xb59418=await _0x16c460[_0x3d7669(0x1de)](_0x3d7669(0x1d0)),_0x1d5dd7=await _0xb59418[_0x3d7669(0x2ad)],_0x5e17ce=_0x1d5dd7['text']();this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':!![],'message':_0x3d7669(0x20e)+_0x5e17ce[_0x3d7669(0x2c0)](0x0,0x14)+'...'},_0x1ecdb1[_0x3d7669(0x310)]);}catch(_0x4d7b2c){this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1['command'],{'success':![],'message':_0x3d7669(0x1ca)+_0x4d7b2c['message']},_0x1ecdb1['callback']);}}else{if(_0x1ecdb1['command']===_0x3d7669(0x341)){const _0x3bd572=await getWeatherContext(this),_0x1d688e=await getCalendarContext(this);this[_0x3d7669(0x282)](_0x1ecdb1['from'],_0x1ecdb1['command'],{'success':!![],'weather':_0x3bd572,'calendar':_0x1d688e},_0x1ecdb1[_0x3d7669(0x310)]);}else{if(_0x1ecdb1[_0x3d7669(0x3b8)]===_0x3d7669(0x362)){}else{if(_0x1ecdb1[_0x3d7669(0x3b8)]===_0x3d7669(0x2c2)){if(!this[_0x3d7669(0x236)])return this[_0x3d7669(0x282)](_0x1ecdb1['from'],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':![],'isPro':![]},_0x1ecdb1[_0x3d7669(0x310)]);let _0x23a888={'status':_0x3d7669(0x3a6),'details':'','lastCheck':0x0};try{_0x23a888[_0x3d7669(0x2bb)]=(await this[_0x3d7669(0x22d)](LTM_DP_DRIFT_STATUS))[_0x3d7669(0x33b)],_0x23a888[_0x3d7669(0x387)]=(await this[_0x3d7669(0x22d)](LTM_DP_DRIFT_DETAILS))[_0x3d7669(0x33b)],_0x23a888['lastCheck']=(await this[_0x3d7669(0x22d)](LTM_DP_DRIFT_LAST_CHECK))[_0x3d7669(0x33b)];}catch(_0xf31c9c){}const _0x2e7ad2=this[_0x3d7669(0x3dc)]||[];this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x23a888,'analysisHistory':_0x2e7ad2},_0x1ecdb1['callback']);}else{if(_0x1ecdb1['command']===_0x3d7669(0x2b9)){const _0x278ec5=this['dailyDigests'][_0x3d7669(0x3be)],_0x292407=new Date(),_0x356be4=new Date(_0x292407[_0x3d7669(0x35a)](),_0x292407[_0x3d7669(0x3ae)](),_0x292407[_0x3d7669(0x1d3)]())[_0x3d7669(0x333)](),_0x344142=this['rawEventLog'][_0x3d7669(0x2c1)](_0x47fefd=>new Date(_0x47fefd[_0x3d7669(0x256)])[_0x3d7669(0x333)]()>_0x356be4)[_0x3d7669(0x3be)],_0x3534ee=new Array(0x18)[_0x3d7669(0x3e0)](0x0);this[_0x3d7669(0x289)][_0x3d7669(0x26a)](_0xc56d09=>{const _0x19be89=_0x3d7669,_0x29e5a0=new Date(_0xc56d09['timestamp']);if(_0x29e5a0[_0x19be89(0x333)]()>_0x356be4)_0x3534ee[_0x29e5a0[_0x19be89(0x1f9)]()]++;});let _0x1fab20={'status':_0x3d7669(0x3a6)};try{_0x1fab20['status']=(await this[_0x3d7669(0x22d)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x105cee){}let _0x47535d='';try{const _0x770f16=await this['getStateAsync'](_0x3d7669(0x397));_0x47535d=_0x770f16?_0x770f16['val']:'';}catch(_0x7ea390){}let _0x49d064=null;!this['geminiModel']&&(_0x49d064=this[_0x3d7669(0x3d7)][_0x3d7669(0x1eb)]?_0x3d7669(0x391):'Kein\x20API\x20Key!');let _0xce1478={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x5424a0=await this[_0x3d7669(0x22d)]('analysis.automation.patternDetected'),_0x243e4b=await this['getStateAsync'](_0x3d7669(0x3b1)),_0x281b98=await this['getStateAsync']('analysis.automation.targetId'),_0x4a9521=await this[_0x3d7669(0x22d)]('analysis.automation.targetValue'),_0x318aaf=await this[_0x3d7669(0x22d)](_0x3d7669(0x32a));_0x5424a0&&_0x5424a0[_0x3d7669(0x33b)]&&(_0xce1478['detected']=!![],_0xce1478['description']=_0x243e4b?_0x243e4b['val']:'',_0xce1478['targetId']=_0x281b98?_0x281b98[_0x3d7669(0x33b)]:'',_0xce1478[_0x3d7669(0x23c)]=_0x4a9521?_0x4a9521['val']:''),_0xce1478[_0x3d7669(0x28a)]=_0x318aaf?!!_0x318aaf[_0x3d7669(0x33b)]:![];}catch(_0x3c479){}this[_0x3d7669(0x282)](_0x1ecdb1['from'],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':!![],'eventHistory':this[_0x3d7669(0x2bc)]['slice'](0x0,0xf),'stats':{'digestCount':_0x278ec5,'eventCountToday':_0x344142,'hourlyActivity':_0x3534ee,'driftStatus':_0x1fab20[_0x3d7669(0x2bb)],'isPresent':this[_0x3d7669(0x30a)],'presenceWho':_0x47535d,'minDays':this[_0x3d7669(0x3d7)]['minDaysForBaseline']||0x7,'stbDays':this[_0x3d7669(0x3d7)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x3d7669(0x3d7)][_0x3d7669(0x242)]||0x3c,'systemError':_0x49d064},'automation':_0xce1478},_0x1ecdb1[_0x3d7669(0x310)]);}else{if(_0x1ecdb1[_0x3d7669(0x3b8)]===_0x3d7669(0x354)){const _0x3fd0b9=await this[_0x3d7669(0x2e4)](_0x3d7669(0x2a9),'enum'),_0x4821e3=[];if(_0x3fd0b9)for(const _0x47f576 in _0x3fd0b9){const _0x14d748=_0x3fd0b9[_0x47f576],_0x193d67=(_0x14d748[_0x3d7669(0x376)]&&typeof _0x14d748[_0x3d7669(0x376)][_0x3d7669(0x27e)]===_0x3d7669(0x38f)?_0x14d748[_0x3d7669(0x376)]['name']['de']:_0x14d748[_0x3d7669(0x376)][_0x3d7669(0x27e)])||_0x14d748[_0x3d7669(0x376)][_0x3d7669(0x27e)];_0x4821e3[_0x3d7669(0x2e8)]({'id':_0x47f576,'name':_0x193d67});}this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':!![],'enums':_0x4821e3},_0x1ecdb1[_0x3d7669(0x310)]);}else{if(_0x1ecdb1[_0x3d7669(0x3b8)]===_0x3d7669(0x21c))try{const _0x2604cd=await scanForDevices(this,_0x1ecdb1[_0x3d7669(0x206)]||{});this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1['command'],{'success':!![],'devices':_0x2604cd},_0x1ecdb1[_0x3d7669(0x310)]);}catch(_0x131858){this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':![],'error':_0x131858[_0x3d7669(0x206)]},_0x1ecdb1[_0x3d7669(0x310)]);}else{if(_0x1ecdb1[_0x3d7669(0x3b8)]===_0x3d7669(0x36f)){const _0x5a507e=_0x1ecdb1[_0x3d7669(0x206)][_0x3d7669(0x203)];if(!_0x5a507e)return this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1['command'],{'success':![],'error':_0x3d7669(0x1e6)},_0x1ecdb1[_0x3d7669(0x310)]);const _0x5baf75=await getCalendarNames(this,_0x5a507e);this['sendTo'](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1['command'],{'success':!![],'names':_0x5baf75},_0x1ecdb1['callback']);}else{if(_0x1ecdb1[_0x3d7669(0x3b8)]===_0x3d7669(0x265)){const {targetId:_0x5b0c11,targetValue:_0x2eb724}=_0x1ecdb1['message'];this[_0x3d7669(0x25b)][_0x3d7669(0x1e1)](_0x3d7669(0x2fb)+_0x5b0c11+'\x20=\x20'+_0x2eb724),await this[_0x3d7669(0x281)](_0x3d7669(0x382),{'val':!![],'ack':!![]}),await this[_0x3d7669(0x281)](_0x3d7669(0x3b1),{'val':_0x3d7669(0x250)+_0x5b0c11,'ack':!![]}),await this[_0x3d7669(0x281)]('analysis.automation.targetId',{'val':_0x5b0c11,'ack':!![]}),await this[_0x3d7669(0x281)](_0x3d7669(0x2d4),{'val':_0x2eb724,'ack':!![]}),this[_0x3d7669(0x282)](_0x1ecdb1['from'],_0x1ecdb1['command'],{'success':!![]},_0x1ecdb1[_0x3d7669(0x310)]);}else{if(_0x1ecdb1[_0x3d7669(0x3b8)]===_0x3d7669(0x259)){const {historyId:_0x27fc5e,rating:_0x2526ca,comment:_0x36c709,alertReason:_0x3e58cd}=_0x1ecdb1[_0x3d7669(0x206)];_0x27fc5e&&_0x2526ca?(await saveFeedback(this,{'timestamp':Date[_0x3d7669(0x25e)](),'historyId':_0x27fc5e,'rating':_0x2526ca,'comment':_0x36c709,'alertReason':_0x3e58cd}),this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':!![]},_0x1ecdb1[_0x3d7669(0x310)])):this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':![],'error':_0x3d7669(0x2ab)},_0x1ecdb1[_0x3d7669(0x310)]);}else _0x1ecdb1[_0x3d7669(0x3b8)]===_0x3d7669(0x2b6)&&(this['log'][_0x3d7669(0x1e1)](_0x3d7669(0x3da)),await this['setStateAsync']('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x3d7669(0x281)](_0x3d7669(0x3b1),{'val':'','ack':!![]}),this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':!![]},_0x1ecdb1['callback']));}}}}}}}}}}catch(_0x71d9e9){this[_0x3d7669(0x25b)][_0x3d7669(0x1f4)]('Error\x20in\x20onMessage\x20command\x20'+_0x1ecdb1[_0x3d7669(0x3b8)]+':\x20'+_0x71d9e9[_0x3d7669(0x206)]);if(_0x1ecdb1['callback'])this[_0x3d7669(0x282)](_0x1ecdb1[_0x3d7669(0x229)],_0x1ecdb1[_0x3d7669(0x3b8)],{'success':![],'error':_0x71d9e9[_0x3d7669(0x206)]},_0x1ecdb1[_0x3d7669(0x310)]);}}}if(require[a0_0x18625a(0x3a9)]!==module)module[a0_0x18625a(0x3a5)]=_0x5012a5=>new CogniLiving(_0x5012a5);else new CogniLiving();