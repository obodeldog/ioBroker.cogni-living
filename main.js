const a0_0x249d00=a0_0x282f;(function(_0x5e0ef1,_0x4cfa2a){const _0x303b79=a0_0x282f,_0xb13b6a=_0x5e0ef1();while(!![]){try{const _0x493307=-parseInt(_0x303b79(0x1d4))/0x1+-parseInt(_0x303b79(0xdb))/0x2+parseInt(_0x303b79(0xda))/0x3+-parseInt(_0x303b79(0x1f1))/0x4+parseInt(_0x303b79(0x1ad))/0x5+-parseInt(_0x303b79(0x125))/0x6*(-parseInt(_0x303b79(0x108))/0x7)+parseInt(_0x303b79(0x243))/0x8;if(_0x493307===_0x4cfa2a)break;else _0xb13b6a['push'](_0xb13b6a['shift']());}catch(_0x435dd8){_0xb13b6a['push'](_0xb13b6a['shift']());}}}(a0_0x1328,0x8c075));const a0_0x3d68ab=(function(){let _0x1dbe2f=!![];return function(_0x41ba20,_0x281b18){const _0x58254e=_0x1dbe2f?function(){if(_0x281b18){const _0x5abdcc=_0x281b18['apply'](_0x41ba20,arguments);return _0x281b18=null,_0x5abdcc;}}:function(){};return _0x1dbe2f=![],_0x58254e;};}()),a0_0x876e82=a0_0x3d68ab(this,function(){const _0xdb49b5=a0_0x282f;return a0_0x876e82[_0xdb49b5(0x1d6)]()[_0xdb49b5(0x1e6)](_0xdb49b5(0x1fa))[_0xdb49b5(0x1d6)]()[_0xdb49b5(0x102)](a0_0x876e82)[_0xdb49b5(0x1e6)](_0xdb49b5(0x1fa));});a0_0x876e82();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x249d00(0xdd)),{spawn}=require('child_process'),path=require(a0_0x249d00(0x104)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x249d00(0x1ef),LTM_SCHEDULE=a0_0x249d00(0xd3),MODE_RESET_SCHEDULE=a0_0x249d00(0x21c),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x249d00(0x23b),LTM_DP_DAILY_DIGESTS=a0_0x249d00(0x159),LTM_DP_STATUS=a0_0x249d00(0x194),LTM_DP_TRIGGER_DIGEST=a0_0x249d00(0x143),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x249d00(0x103),LTM_DP_DRIFT_STATUS=a0_0x249d00(0x24e),LTM_DP_DRIFT_DETAILS=a0_0x249d00(0xbf),LTM_DP_DRIFT_LAST_CHECK=a0_0x249d00(0x1ec),SYSTEM_DP_MODE=a0_0x249d00(0x240),HARD_IGNORE_TERMS=[a0_0x249d00(0x275),'scriptEnabled',a0_0x249d00(0xc9),'unreach','lowbat','rssi','connection','maintenance',a0_0x249d00(0x18d),a0_0x249d00(0x19a),a0_0x249d00(0x1eb),a0_0x249d00(0x1de),a0_0x249d00(0x1a1),a0_0x249d00(0xd6),'dutycycle',a0_0x249d00(0x17a),'reachable',a0_0x249d00(0x14a)],BAD_NAMES=[a0_0x249d00(0x1c3),'currentposition','state',a0_0x249d00(0xe6),a0_0x249d00(0x1b3),'brightness','on',a0_0x249d00(0xd8),a0_0x249d00(0x182),a0_0x249d00(0x23d),a0_0x249d00(0x11d),a0_0x249d00(0x26a),a0_0x249d00(0x146),a0_0x249d00(0xc7),a0_0x249d00(0x196),a0_0x249d00(0x233),'occupancy','temperature',a0_0x249d00(0x1bc),a0_0x249d00(0x15b),a0_0x249d00(0x13e),a0_0x249d00(0x185),'valve',a0_0x249d00(0x1cb),a0_0x249d00(0x1f2)],ADAPTER_BLACKLIST=[a0_0x249d00(0xd2),a0_0x249d00(0x1e3),'info.','vis.','history.',a0_0x249d00(0x214),a0_0x249d00(0x22c),a0_0x249d00(0x246),a0_0x249d00(0x204),'javascript.','simple-api.'],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x249d00(0xe1),'PARTY':a0_0x249d00(0x10b),'GUEST':a0_0x249d00(0xf4)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x249d00(0x20f)],SYSTEM_MODES[a0_0x249d00(0xe8)]],PERSONA_MAPPING={'generic':a0_0x249d00(0xe9),'senior_aal':a0_0x249d00(0x15a),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x249d00(0x239),'security':a0_0x249d00(0x173)};async function initZombies(_0x8965c9){const _0x128815=a0_0x249d00;try{const _0x4b93ca=[_0x128815(0x1d5),_0x128815(0x256)];for(const _0xeb6f0e of _0x4b93ca){try{const _0x28297b=await _0x8965c9[_0x128815(0x206)](_0xeb6f0e);_0x28297b&&await _0x8965c9[_0x128815(0x22a)](_0xeb6f0e);}catch(_0x39a03b){}}}catch(_0x309c){}}async function initHistory(_0x5d6677){const _0x594bd2=a0_0x249d00;try{const _0x19e818=await _0x5d6677[_0x594bd2(0x120)](_0x594bd2(0x254));_0x19e818&&_0x19e818[_0x594bd2(0x221)]&&(_0x5d6677[_0x594bd2(0xc5)]=JSON['parse'](_0x19e818['val']['toString']()));}catch(_0x1ba575){_0x5d6677[_0x594bd2(0xc5)]=[];}try{const _0x2e8bf2=await _0x5d6677['getStateAsync'](_0x594bd2(0x203));if(_0x2e8bf2&&_0x2e8bf2[_0x594bd2(0x221)])_0x5d6677[_0x594bd2(0xeb)]=JSON[_0x594bd2(0x147)](_0x2e8bf2[_0x594bd2(0x221)][_0x594bd2(0x1d6)]());}catch(_0x5ea39f){_0x5d6677[_0x594bd2(0xeb)]=[];}}async function initSystemConfig(_0x539cb9){const _0x149f5e=a0_0x249d00;try{const _0x14f47a=await _0x539cb9['getForeignObjectAsync'](_0x149f5e(0x252));_0x14f47a&&_0x14f47a[_0x149f5e(0x192)]&&(_0x539cb9[_0x149f5e(0x164)]={'latitude':_0x14f47a['common'][_0x149f5e(0xee)]||0x0,'longitude':_0x14f47a[_0x149f5e(0x192)][_0x149f5e(0xbe)]||0x0,'city':_0x14f47a[_0x149f5e(0x192)][_0x149f5e(0x1c2)]||''});}catch(_0x1daef3){}}async function checkLicense(_0x556d66,_0x475fc7){const _0x428fb6=a0_0x249d00;if(!_0x475fc7)return![];_0x556d66[_0x428fb6(0xdf)]=await getSystemUUID(_0x556d66);if(_0x475fc7===_0x428fb6(0x190)||_0x475fc7[_0x428fb6(0x1e8)](_0x428fb6(0x160)))return!![];return![];}async function getSystemUUID(_0x5b4840){const _0x3836ea=a0_0x249d00;try{const _0x3cc6d4=await _0x5b4840['getForeignObjectAsync'](_0x3836ea(0x22d));if(_0x3cc6d4&&_0x3cc6d4[_0x3836ea(0x17e)]&&_0x3cc6d4[_0x3836ea(0x17e)]['uuid'])return _0x3cc6d4['native'][_0x3836ea(0x1ab)];return _0x3836ea(0x1ea);}catch(_0x167e47){return _0x3836ea(0xfd);}}async function createAllObjects(_0x4d3549){const _0x477658=a0_0x249d00;await checkSystemObjects(_0x4d3549),await _0x4d3549[_0x477658(0x189)]('system.presenceWho',{'type':_0x477658(0x217),'common':{'name':_0x477658(0x271),'type':_0x477658(0x162),'role':_0x477658(0x1d0),'read':!![],'write':![],'def':''},'native':{}}),await _0x4d3549['setObjectNotExistsAsync']('events.lastEvent',{'type':_0x477658(0x217),'common':{'name':_0x477658(0x106),'type':_0x477658(0x162),'role':_0x477658(0x1bd),'read':!![],'write':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x254),{'type':_0x477658(0x217),'common':{'name':_0x477658(0x123),'type':_0x477658(0x162),'role':_0x477658(0x1bd),'read':!![],'write':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x272),{'type':'state','common':{'name':_0x477658(0x12e),'type':_0x477658(0x26d),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x19d),{'type':_0x477658(0x217),'common':{'name':_0x477658(0x232),'type':_0x477658(0x26d),'role':_0x477658(0x14c),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4d3549['setObjectNotExistsAsync'](_0x477658(0xf3),{'type':_0x477658(0x217),'common':{'name':_0x477658(0x137),'type':_0x477658(0x162),'role':_0x477658(0x1bd),'read':!![],'write':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x14f),{'type':'state','common':{'name':_0x477658(0x1c8),'type':_0x477658(0x26d),'role':_0x477658(0x19f),'read':!![],'write':![],'def':![]},'native':{}}),await _0x4d3549['setObjectNotExistsAsync'](_0x477658(0x180),{'type':'state','common':{'name':_0x477658(0x260),'type':_0x477658(0x26d),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)]('analysis.alertReason',{'type':_0x477658(0x217),'common':{'name':_0x477658(0x227),'type':_0x477658(0x162),'role':_0x477658(0x11e),'read':!![],'write':![]},'native':{}}),await _0x4d3549['setObjectNotExistsAsync'](_0x477658(0x218),{'type':_0x477658(0x217),'common':{'name':_0x477658(0x1e0),'type':'string','role':_0x477658(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x1fe),{'type':_0x477658(0x217),'common':{'name':'Deviation','type':_0x477658(0x162),'role':'state','read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x4d3549['setObjectNotExistsAsync'](_0x477658(0x25b),{'type':_0x477658(0x217),'common':{'name':_0x477658(0x242),'type':_0x477658(0x162),'role':_0x477658(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x4d3549['setObjectNotExistsAsync']('analysis.comfortSuggestion',{'type':_0x477658(0x217),'common':{'name':_0x477658(0x253),'type':'string','role':_0x477658(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x4d3549[_0x477658(0x1c1)](_0x477658(0x10a),{'type':_0x477658(0x165),'common':{'name':_0x477658(0xe7)},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0xde),{'type':'state','common':{'name':_0x477658(0x20e),'type':'boolean','role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x16e),{'type':_0x477658(0x217),'common':{'name':'Description','type':_0x477658(0x162),'role':_0x477658(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x4d3549['setObjectNotExistsAsync'](_0x477658(0x1d3),{'type':'state','common':{'name':_0x477658(0x15c),'type':'string','role':_0x477658(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x4d3549['setObjectNotExistsAsync'](_0x477658(0x1bb),{'type':_0x477658(0x217),'common':{'name':_0x477658(0x105),'type':'string','role':_0x477658(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x236),{'type':_0x477658(0x217),'common':{'name':_0x477658(0x18c),'type':_0x477658(0x162),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x207),{'type':'state','common':{'name':'Auto\x20Apply\x20Rule','type':_0x477658(0x26d),'role':_0x477658(0x182),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x154),{'type':'state','common':{'name':_0x477658(0x1aa),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x203),{'type':'state','common':{'name':_0x477658(0x142),'type':_0x477658(0x162),'role':_0x477658(0x1bd),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x4d3549[_0x477658(0x189)]('analysis.feedbackHistory',{'type':'state','common':{'name':'Feedback\x20Log','type':_0x477658(0x162),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x4d3549[_0x477658(0x1c1)](_0x477658(0xc4),{'type':'channel','common':{'name':_0x477658(0x274)},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x249),{'type':'state','common':{'name':_0x477658(0x216),'type':_0x477658(0x14d),'role':_0x477658(0x124),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0xc3),{'type':_0x477658(0x217),'common':{'name':_0x477658(0xcd),'type':_0x477658(0x162),'role':_0x477658(0x1d0),'read':!![],'write':![],'def':_0x477658(0x118)},'native':{}}),await _0x4d3549[_0x477658(0x189)](_0x477658(0x198),{'type':_0x477658(0x217),'common':{'name':'Health\x20Notes','type':'string','role':_0x477658(0x1d0),'read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x4d3549),await checkLtmDriftObjects(_0x4d3549);}async function checkSystemObjects(_0x27a50c){const _0x33539e=a0_0x249d00;await _0x27a50c[_0x33539e(0x1c1)](_0x33539e(0x220),{'type':'channel','common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0x27a50c[_0x33539e(0x1c1)](SYSTEM_DP_MODE,{'type':_0x33539e(0x217),'common':{'name':_0x33539e(0x26b),'type':_0x33539e(0x162),'role':_0x33539e(0x217),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x33539e(0x248)],'states':{[SYSTEM_MODES['NORMAL']]:_0x33539e(0x166),[SYSTEM_MODES['VACATION']]:_0x33539e(0x130),[SYSTEM_MODES[_0x33539e(0x20f)]]:_0x33539e(0x167),[SYSTEM_MODES[_0x33539e(0xe8)]]:_0x33539e(0x128)}},'native':{}});}async function checkLtmObjects(_0x5540cf){const _0x49db5c=a0_0x249d00;await _0x5540cf[_0x49db5c(0x1c1)](_0x49db5c(0x1ee),{'type':_0x49db5c(0x165),'common':{'name':'LTM'},'native':{}}),await _0x5540cf[_0x49db5c(0x1c1)](LTM_DP_RAW_LOG,{'type':_0x49db5c(0x217),'common':{'name':_0x49db5c(0x219),'type':'string','role':_0x49db5c(0x1bd),'read':!![],'write':![]},'native':{}}),await _0x5540cf['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x49db5c(0x217),'common':{'name':_0x49db5c(0x238),'type':_0x49db5c(0x162),'role':_0x49db5c(0x1bd),'read':!![],'write':![]},'native':{}}),await _0x5540cf[_0x49db5c(0x1c1)](LTM_DP_STATUS,{'type':_0x49db5c(0x217),'common':{'name':_0x49db5c(0x1a6),'type':_0x49db5c(0x162),'role':_0x49db5c(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x5540cf['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x49db5c(0x217),'common':{'name':'Trigger\x20Digest','type':_0x49db5c(0x26d),'role':_0x49db5c(0x14c),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5540cf['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x49db5c(0x217),'common':{'name':_0x49db5c(0x250),'type':_0x49db5c(0x162),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x27e617){const _0x466310=a0_0x249d00;await _0x27e617[_0x466310(0x1c1)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x466310(0x1d2)},'native':{}}),await _0x27e617[_0x466310(0x1c1)](LTM_DP_DRIFT_STATUS,{'type':_0x466310(0x217),'common':{'name':_0x466310(0xef),'type':'string','role':_0x466310(0x217),'read':!![],'write':![],'def':_0x466310(0x13d)},'native':{}}),await _0x27e617[_0x466310(0x1c1)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x466310(0x25c),'type':_0x466310(0x162),'role':_0x466310(0x1d0),'read':!![],'write':![]},'native':{}}),await _0x27e617[_0x466310(0x1c1)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x466310(0x217),'common':{'name':_0x466310(0x13a),'type':'number','role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x42a811){const _0x54be8e=a0_0x249d00;try{const _0x3beacb=await _0x42a811[_0x54be8e(0x120)](SYSTEM_DP_MODE);_0x3beacb&&_0x3beacb[_0x54be8e(0x221)]&&Object[_0x54be8e(0x197)](SYSTEM_MODES)[_0x54be8e(0x22b)](_0x3beacb[_0x54be8e(0x221)])?_0x42a811[_0x54be8e(0x111)]=_0x3beacb[_0x54be8e(0x221)]:(_0x42a811[_0x54be8e(0x111)]=SYSTEM_MODES[_0x54be8e(0x248)],await _0x42a811[_0x54be8e(0x16c)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x54be8e(0x248)],'ack':!![]}));}catch(_0x11c868){_0x42a811[_0x54be8e(0x111)]=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x48390c){const _0x5ac7bc=a0_0x249d00;try{const _0x413759=await _0x48390c[_0x5ac7bc(0x120)](LTM_DP_RAW_LOG);if(_0x413759&&_0x413759[_0x5ac7bc(0x221)])_0x48390c[_0x5ac7bc(0x18a)]=JSON[_0x5ac7bc(0x147)](_0x413759[_0x5ac7bc(0x221)]);}catch(_0x361785){_0x48390c[_0x5ac7bc(0x18a)]=[];}}async function saveRawEventLog(_0x9eeaa8){const _0x4c0b01=a0_0x249d00;_0x9eeaa8[_0x4c0b01(0x18a)][_0x4c0b01(0x1c0)]>RAW_LOG_MAX_SIZE&&_0x9eeaa8[_0x4c0b01(0x18a)][_0x4c0b01(0x1e2)](0x0,_0x9eeaa8['rawEventLog'][_0x4c0b01(0x1c0)]-RAW_LOG_MAX_SIZE),await _0x9eeaa8['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x4c0b01(0x229)](_0x9eeaa8[_0x4c0b01(0x18a)]),'ack':!![]});}async function loadDailyDigests(_0x577524){const _0x4bba2f=a0_0x249d00;try{const _0x56c98b=await _0x577524['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x56c98b&&_0x56c98b[_0x4bba2f(0x221)])_0x577524['dailyDigests']=JSON[_0x4bba2f(0x147)](_0x56c98b[_0x4bba2f(0x221)]);}catch(_0x4b9f36){_0x577524[_0x4bba2f(0x258)]=[];}await updateBaselineStatus(_0x577524);}async function saveDailyDigests(_0x57117c,_0xef94d4=!![]){const _0x5d5f5b=a0_0x249d00,_0x2129f1=_0x57117c['config'][_0x5d5f5b(0x257)]||0x3c;_0x57117c[_0x5d5f5b(0x258)][_0x5d5f5b(0x1c0)]>_0x2129f1&&_0x57117c[_0x5d5f5b(0x258)][_0x5d5f5b(0x1e2)](0x0,_0x57117c['dailyDigests'][_0x5d5f5b(0x1c0)]-_0x2129f1);await _0x57117c['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5d5f5b(0x229)](_0x57117c['dailyDigests']),'ack':!![]});if(_0xef94d4)await updateBaselineStatus(_0x57117c);}async function updateAnalysisHistory(_0x38c94a,_0x26a75a){const _0x4cd83c=a0_0x249d00;_0x38c94a[_0x4cd83c(0xeb)][_0x4cd83c(0x145)](_0x26a75a);if(_0x38c94a[_0x4cd83c(0xeb)]['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x38c94a[_0x4cd83c(0xeb)][_0x4cd83c(0x17d)]();await _0x38c94a[_0x4cd83c(0x16c)](_0x4cd83c(0x203),{'val':JSON[_0x4cd83c(0x229)](_0x38c94a['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x10f362){const _0x541c2=a0_0x249d00;if(!_0x10f362[_0x541c2(0x1be)]){await _0x10f362['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x541c2(0x235),'ack':!![]});return;}const _0x58316a=_0x10f362[_0x541c2(0x258)][_0x541c2(0x1c0)]>=(_0x10f362[_0x541c2(0x211)]['minDaysForBaseline']||0x7)?'Aktiv\x20('+_0x10f362[_0x541c2(0x258)][_0x541c2(0x1c0)]+'\x20Tage)':'Lernphase\x20('+_0x10f362[_0x541c2(0x258)]['length']+'/'+(_0x10f362[_0x541c2(0x211)][_0x541c2(0xf1)]||0x7)+')';await _0x10f362[_0x541c2(0x16c)](LTM_DP_BASELINE_STATUS,{'val':_0x58316a,'ack':!![]});}async function initSensorSubscriptions(_0x35761b){const _0x208cd7=a0_0x249d00,_0x3f0389=_0x35761b[_0x208cd7(0x211)][_0x208cd7(0x14b)];if(_0x3f0389&&_0x3f0389[_0x208cd7(0x1c0)]>0x0){_0x35761b['log'][_0x208cd7(0xcc)](_0x208cd7(0x12d)+_0x3f0389[_0x208cd7(0x1c0)]+'\x20sensors...');for(const _0xdde1f of _0x3f0389){if(_0xdde1f['id']){await _0x35761b[_0x208cd7(0x15e)](_0xdde1f['id']);try{const _0x256638=await _0x35761b[_0x208cd7(0x1f6)](_0xdde1f['id']);if(_0x256638)_0x35761b[_0x208cd7(0x1ae)][_0xdde1f['id']]=_0x256638['val'];}catch(_0x20801b){}}}}}async function initPresenceSubscriptions(_0x598fcc){const _0x4da926=a0_0x249d00,_0xceef6a=_0x598fcc['config'][_0x4da926(0x251)]||[];if(_0xceef6a['length']>0x0){_0x598fcc[_0x4da926(0x213)][_0x4da926(0xcc)]('Subscribing\x20to\x20'+_0xceef6a[_0x4da926(0x1c0)]+_0x4da926(0x117));for(const _0x322063 of _0xceef6a){await _0x598fcc[_0x4da926(0x15e)](_0x322063);}try{await checkWifiPresence(_0x598fcc);}catch(_0x3ce967){}}}async function getWeatherContext(_0x5a0ead){const _0x555c77=a0_0x249d00;try{if(!_0x5a0ead[_0x555c77(0x211)][_0x555c77(0x129)])return _0x555c77(0xfa);let _0x388dee='';const _0x2ba3ed=_0x5a0ead[_0x555c77(0x211)][_0x555c77(0x1a9)];if(_0x2ba3ed)try{if(_0x2ba3ed[_0x555c77(0x22b)]('accuweather')){const _0x2072af=await _0x5a0ead['getForeignStateAsync'](_0x2ba3ed+_0x555c77(0x20b));if(_0x2072af&&_0x2072af[_0x555c77(0x221)])_0x388dee=_0x2072af[_0x555c77(0x221)];}else{if(_0x2ba3ed[_0x555c77(0x22b)]('daswetter')){const _0x5c9bcd=await _0x5a0ead[_0x555c77(0x1f6)](_0x2ba3ed+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0x5c9bcd&&_0x5c9bcd['val'])_0x388dee=_0x5c9bcd[_0x555c77(0x221)];}else{if(_0x2ba3ed[_0x555c77(0x22b)]('openweathermap')){const _0x5fc513=await _0x5a0ead[_0x555c77(0x1f6)](_0x2ba3ed+_0x555c77(0x10d));if(_0x5fc513&&_0x5fc513['val'])_0x388dee=_0x5fc513[_0x555c77(0x221)];}}}}catch(_0x161af5){}if(!_0x388dee){const _0x4abf2b=['accuweather.0',_0x555c77(0x1e1),'weatherunderground.0','openweathermap.0'];for(const _0x1eaa4d of _0x4abf2b){try{const _0x25e785=await _0x5a0ead[_0x555c77(0x181)](_0x1eaa4d);if(_0x25e785){if(_0x1eaa4d[_0x555c77(0x22b)]('accuweather')){const _0x401312=await _0x5a0ead[_0x555c77(0x1f6)](_0x1eaa4d+_0x555c77(0x20b));if(_0x401312&&_0x401312[_0x555c77(0x221)]){_0x388dee=_0x401312[_0x555c77(0x221)];break;}}}}catch(_0x2cafdf){}}}return _0x388dee?'WETTER:\x20'+_0x388dee:_0x555c77(0x114);}catch(_0x2d23cc){return _0x555c77(0x1b2)+_0x2d23cc[_0x555c77(0x184)];}}async function getCalendarContext(_0x5eec01){const _0x58f877=a0_0x249d00;try{if(!_0x5eec01['config'][_0x58f877(0x25d)])return'Kalender:\x20Deaktiviert';let _0x5236cc=_0x5eec01[_0x58f877(0x211)]['calendarInstance']||'ical.0',_0x1acfbb=_0x5eec01[_0x58f877(0x211)][_0x58f877(0x247)]||[];if(typeof _0x1acfbb===_0x58f877(0x162))_0x1acfbb=_0x1acfbb[_0x58f877(0xe4)](',');try{const _0x289afa=await _0x5eec01[_0x58f877(0x1f6)](_0x5236cc+_0x58f877(0x269));if(_0x289afa&&_0x289afa[_0x58f877(0x221)]){let _0x257ace=tryParse(_0x289afa[_0x58f877(0x221)]);if(_0x257ace&&Array['isArray'](_0x257ace)){if(_0x1acfbb[_0x58f877(0x1c0)]>0x0)_0x257ace=_0x257ace['filter'](_0x592390=>_0x1acfbb['includes'](_0x592390[_0x58f877(0x1fc)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x257ace[_0x58f877(0x1c0)]>0x0){const _0x45bb5f=_0x257ace[_0x58f877(0x113)](0x0,0x3)[_0x58f877(0x171)](_0xa4b349=>{const _0x33c96d=_0x58f877;let _0x4613e3=_0xa4b349[_0x33c96d(0x255)];if(_0xa4b349['time'])_0x4613e3+='\x20'+_0xa4b349['time'];return _0x4613e3+':\x20'+_0xa4b349['event']+'\x20('+_0xa4b349[_0x33c96d(0x1fc)]+')';});return _0x58f877(0x22f)+_0x45bb5f[_0x58f877(0x101)](_0x58f877(0x1f9));}else return _0x58f877(0x163);}}}catch(_0xa44da6){_0x5eec01[_0x58f877(0x213)][_0x58f877(0x23e)]('Error\x20reading\x20calendar\x20table:\x20'+_0xa44da6[_0x58f877(0x184)]);}return _0x58f877(0x268);}catch(_0x3da6d0){return _0x58f877(0x262)+_0x3da6d0[_0x58f877(0x184)];}}async function getCalendarNames(_0x2ccfcb,_0x17e03c){const _0x45ce1e=a0_0x249d00;try{const _0x18f44d=await _0x2ccfcb[_0x45ce1e(0x1f6)](_0x17e03c+_0x45ce1e(0x269));if(_0x18f44d&&_0x18f44d['val']){const _0x289bca=tryParse(_0x18f44d[_0x45ce1e(0x221)]);if(_0x289bca&&Array[_0x45ce1e(0xe3)](_0x289bca)){const _0x2372af=[...new Set(_0x289bca['map'](_0x1d3333=>_0x1d3333['_calName'])[_0x45ce1e(0x1e7)](Boolean))];return _0x2372af[_0x45ce1e(0x224)]();}}return[];}catch(_0x5685b7){return _0x2ccfcb['log'][_0x45ce1e(0x18d)]('getCalendarNames\x20Error:\x20'+_0x5685b7[_0x45ce1e(0x184)]),[];}}async function checkWifiPresence(_0x5de201){const _0x49021e=a0_0x249d00;try{const _0xbd1f26=_0x5de201[_0x49021e(0x211)]['presenceDevices']||[];let _0x4936ea=![];const _0x405a42=[];for(const _0x7944fb of _0xbd1f26){try{const _0x442e1b=await _0x5de201[_0x49021e(0x1f6)](_0x7944fb);if(_0x442e1b&&(_0x442e1b[_0x49021e(0x221)]===!![]||_0x442e1b[_0x49021e(0x221)]===_0x49021e(0x115)||_0x442e1b['val']===0x1)){_0x4936ea=!![];const _0x5ae569=await _0x5de201['getForeignObjectAsync'](_0x7944fb);let _0x4da443=_0x7944fb;_0x5ae569&&_0x5ae569['common']&&_0x5ae569['common'][_0x49021e(0x177)]&&(_0x4da443=typeof _0x5ae569[_0x49021e(0x192)][_0x49021e(0x177)]==='object'?_0x5ae569['common'][_0x49021e(0x177)]['de']||_0x5ae569[_0x49021e(0x192)][_0x49021e(0x177)]['en']:_0x5ae569[_0x49021e(0x192)][_0x49021e(0x177)]),_0x405a42[_0x49021e(0x100)](_0x4da443);}}catch(_0x90d0c){}}return await _0x5de201['setStateAsync'](_0x49021e(0x209),{'val':_0x405a42[_0x49021e(0x101)](',\x20'),'ack':!![]}),_0x4936ea&&(_0x5de201[_0x49021e(0x245)]&&(_0x5de201[_0x49021e(0x213)][_0x49021e(0xcc)](_0x49021e(0x172)),abortExitTimer(_0x5de201)),!_0x5de201[_0x49021e(0x14e)]&&_0x5de201[_0x49021e(0x111)]===SYSTEM_MODES[_0x49021e(0x248)]&&await setPresence(_0x5de201,!![])),_0x4936ea;}catch(_0x2d400d){return _0x5de201['log']['error']('Error\x20checking\x20WiFi:\x20'+_0x2d400d[_0x49021e(0x184)]),![];}}function startExitTimer(_0xdba349){const _0x34923f=a0_0x249d00;abortExitTimer(_0xdba349),_0xdba349[_0x34923f(0x1b1)]=!![],_0xdba349[_0x34923f(0x1c6)]=setTimeout(()=>{const _0x16b6f3=_0x34923f;_0xdba349[_0x16b6f3(0x1b1)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0xdba349[_0x34923f(0x245)]=setTimeout(()=>{const _0x337e62=_0x34923f;setPresence(_0xdba349,![]),_0xdba349[_0x337e62(0x245)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x19f7d9){const _0x1aa63e=a0_0x249d00;if(_0x19f7d9['exitTimer'])clearTimeout(_0x19f7d9['exitTimer']);if(_0x19f7d9[_0x1aa63e(0x1c6)])clearTimeout(_0x19f7d9['exitGraceTimer']);_0x19f7d9[_0x1aa63e(0x245)]=null,_0x19f7d9['exitGraceTimer']=null,_0x19f7d9['isGracePeriodActive']=![];}async function setPresence(_0x3f1da9,_0x538223){const _0x20c708=a0_0x249d00;if(_0x3f1da9[_0x20c708(0x14e)]===_0x538223)return;_0x3f1da9[_0x20c708(0x14e)]=_0x538223,await _0x3f1da9[_0x20c708(0x16c)](_0x20c708(0x12b),{'val':_0x538223,'ack':!![]});}async function saveFeedback(_0x553e35,_0x112747){const _0x335b37=a0_0x249d00;_0x553e35[_0x335b37(0x213)]['info'](_0x335b37(0xff)+JSON[_0x335b37(0x229)](_0x112747));}async function runBaselineDriftAnalysis(_0x45e094){const _0x714d33=a0_0x249d00;if(!_0x45e094[_0x714d33(0x1be)]||!_0x45e094[_0x714d33(0x12c)])return;const _0xa0786c=_0x45e094[_0x714d33(0x211)][_0x714d33(0x1f8)]||0xe;if(_0x45e094[_0x714d33(0x258)][_0x714d33(0x1c0)]<_0xa0786c+(_0x45e094[_0x714d33(0x211)]['minDaysForBaseline']||0x7)){await _0x45e094['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x3198da=_0x45e094[_0x714d33(0x258)]['slice'](-_0xa0786c),_0x3efe00=_0x45e094[_0x714d33(0x258)][_0x714d33(0x113)](0x0,_0x45e094[_0x714d33(0x258)]['length']-_0xa0786c),_0x574962=_0x714d33(0x151)+JSON['stringify'](_0x3efe00)+_0x714d33(0x267)+JSON[_0x714d33(0x229)](_0x3198da);try{const _0x25b035=await _0x45e094[_0x714d33(0x12c)][_0x714d33(0x1f5)](_0x574962),_0x495511=JSON[_0x714d33(0x147)](_0x25b035[_0x714d33(0x23f)][_0x714d33(0x1d0)]()[_0x714d33(0x24f)](/```json|```/g,'')['trim']());_0x495511[_0x714d33(0x1b6)]&&(await _0x45e094[_0x714d33(0x16c)](LTM_DP_DRIFT_STATUS,{'val':_0x495511[_0x714d33(0x1b6)],'ack':!![]}),await _0x45e094[_0x714d33(0x16c)](LTM_DP_DRIFT_DETAILS,{'val':_0x495511[_0x714d33(0x135)],'ack':!![]}),await _0x45e094['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x89126){}}function setupLtmScheduler(_0xe5fe47){const _0x35a6ee=a0_0x249d00;try{if(_0xe5fe47[_0x35a6ee(0x201)])_0xe5fe47['ltmJob'][_0x35a6ee(0x20d)]();if(!_0xe5fe47[_0x35a6ee(0x1be)]){_0xe5fe47['setStateAsync'](LTM_DP_STATUS,{'val':_0x35a6ee(0x235),'ack':!![]});return;}_0xe5fe47[_0x35a6ee(0x201)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0xe5fe47));}catch(_0x4cecdc){_0xe5fe47[_0x35a6ee(0x213)][_0x35a6ee(0x18d)](_0x35a6ee(0x1ce)+_0x4cecdc[_0x35a6ee(0x184)]);}}function setupModeResetScheduler(_0x5273c8){const _0xc8dbb0=a0_0x249d00;try{if(_0x5273c8['modeResetJob'])_0x5273c8[_0xc8dbb0(0xf5)]['cancel']();_0x5273c8[_0xc8dbb0(0xf5)]=schedule[_0xc8dbb0(0x244)](MODE_RESET_SCHEDULE,async()=>{const _0x1b3941=_0xc8dbb0;await loadSystemMode(_0x5273c8),AUTO_RESET_MODES[_0x1b3941(0x22b)](_0x5273c8[_0x1b3941(0x111)])&&await _0x5273c8[_0x1b3941(0x16c)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1b3941(0x248)],'ack':![]});});}catch(_0x3657c8){_0x5273c8['log'][_0xc8dbb0(0x18d)](_0xc8dbb0(0x13c)+_0x3657c8[_0xc8dbb0(0x184)]);}}function setupDriftAnalysisScheduler(_0x1436f5){const _0x270476=a0_0x249d00;try{if(_0x1436f5['driftAnalysisTimer'])clearInterval(_0x1436f5['driftAnalysisTimer']);if(!_0x1436f5[_0x270476(0x1be)])return;_0x1436f5[_0x270476(0x264)]=setInterval(()=>runBaselineDriftAnalysis(_0x1436f5),(_0x1436f5[_0x270476(0x211)][_0x270476(0x187)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x1436f5),0x1388);}catch(_0x324291){_0x1436f5[_0x270476(0x213)]['error'](_0x270476(0x228)+_0x324291[_0x270476(0x184)]);}}function setupBriefingScheduler(_0x319d97){const _0x2e8b97=a0_0x249d00;try{if(_0x319d97[_0x2e8b97(0x1cd)])_0x319d97[_0x2e8b97(0x1cd)]['cancel']();if(!_0x319d97['config'][_0x2e8b97(0xc8)])return;const _0x40b537=(_0x319d97[_0x2e8b97(0x211)][_0x2e8b97(0x168)]||_0x2e8b97(0x161))[_0x2e8b97(0xe4)](':'),_0x267598=parseInt(_0x40b537[0x0])||0x8,_0x4e8b2c=parseInt(_0x40b537[0x1])||0x0,_0x800929=_0x4e8b2c+'\x20'+_0x267598+'\x20*\x20*\x20*';_0x319d97['log'][_0x2e8b97(0xcc)](_0x2e8b97(0x169)+_0x267598+':'+(_0x4e8b2c<0xa?'0'+_0x4e8b2c:_0x4e8b2c)),_0x319d97['briefingJob']=schedule[_0x2e8b97(0x244)](_0x800929,()=>{sendMorningBriefing(_0x319d97);});}catch(_0x100fc1){_0x319d97['log'][_0x2e8b97(0x18d)](_0x2e8b97(0x1d7)+_0x100fc1['message']);}}async function sendNotification(_0xb62aa5,_0x4899ea,_0x1d1eaf=![],_0x294c31=![]){const _0x1f291b=a0_0x249d00;_0xb62aa5[_0x1f291b(0x213)][_0x1f291b(0xcc)]((_0x1d1eaf?'[TEST]\x20':'')+_0x1f291b(0x24a)+_0x4899ea+'\x22');const _0x19f1eb=_0xb62aa5[_0x1f291b(0x211)];let _0x37d31d=0x0;if(_0x19f1eb[_0x1f291b(0x1d1)]){let _0x5e4ecb={};(_0x4899ea['includes'](_0x1f291b(0x1ba))||_0x294c31)&&(_0x5e4ecb={'reply_markup':{'inline_keyboard':[[{'text':_0x1f291b(0x132),'callback_data':_0x1f291b(0xfe)}],[{'text':_0x1f291b(0x186),'callback_data':_0x1f291b(0x1b4)}]]}}),await _0xb62aa5['sendToAsync'](_0x19f1eb[_0x1f291b(0x11a)],_0x1f291b(0x212),{'text':_0x4899ea,'user':_0x19f1eb[_0x1f291b(0x26f)],..._0x5e4ecb}),_0x37d31d++;}if(_0x19f1eb[_0x1f291b(0x1b0)]){let _0x246743={'message':_0x4899ea,'title':_0x294c31?_0x1f291b(0xd7):_0x1f291b(0x22e),'priority':_0x294c31?0x2:0x1,'device':_0x19f1eb['notifyPushoverRecipient']};_0x294c31&&(_0x246743[_0x1f291b(0xf8)]=0x1e,_0x246743['expire']=0xe10,_0x246743[_0x1f291b(0x210)]=_0x1f291b(0xd1)),await _0xb62aa5['sendToAsync'](_0x19f1eb['notifyPushoverInstance'],_0x1f291b(0x212),_0x246743),_0x37d31d++;}return _0x19f1eb[_0x1f291b(0x223)]&&(await _0xb62aa5[_0x1f291b(0x157)](_0x19f1eb[_0x1f291b(0x200)],_0x1f291b(0x212),{'text':_0x4899ea,'to':_0x19f1eb['notifyEmailRecipient']}),_0x37d31d++),_0x37d31d;}async function setupTelegramListener(_0x21be63){const _0x4ceaae=a0_0x249d00,_0xe5a545=_0x21be63[_0x4ceaae(0x211)]['notifyTelegramInstance'];_0x21be63['config'][_0x4ceaae(0x1d1)]&&_0xe5a545&&(_0x21be63['log'][_0x4ceaae(0xcc)](_0x4ceaae(0x21d)+_0xe5a545+'\x20for\x20interactive\x20buttons...'),await _0x21be63[_0x4ceaae(0x15e)](_0xe5a545+_0x4ceaae(0x215)));}async function handleTelegramResponse(_0x197daa,_0x22887a){const _0x3fe162=a0_0x249d00;let _0x44ddd1=_0x22887a;_0x22887a['startsWith']('[')&&(_0x44ddd1=_0x22887a[_0x3fe162(0x16a)](_0x22887a[_0x3fe162(0x1db)](']')+0x1));if(_0x44ddd1===_0x3fe162(0xfe))_0x197daa[_0x3fe162(0x213)][_0x3fe162(0xcc)](_0x3fe162(0x10c)),await _0x197daa[_0x3fe162(0x16c)](_0x3fe162(0x14f),{'val':![],'ack':!![]}),await _0x197daa[_0x3fe162(0x16c)](_0x3fe162(0x1b7),{'val':'Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ack':!![]}),_0x197daa[_0x3fe162(0x155)]=![],sendNotification(_0x197daa,'âœ…\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x44ddd1===_0x3fe162(0x1b4)&&(_0x197daa[_0x3fe162(0x213)][_0x3fe162(0x23e)]('ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x197daa,_0x3fe162(0x12a),![],!![]));}async function runAutopilot(_0x2588fa){const _0x8fb125=a0_0x249d00,_0x3857d5=_0x2588fa['config'][_0x8fb125(0x263)],_0x3b1548=_0x2588fa[_0x8fb125(0xc5)]['length']>0x0?_0x2588fa[_0x8fb125(0xc5)][0x0][_0x8fb125(0x1a5)]:Date[_0x8fb125(0x259)](),_0xa14fc7=(Date[_0x8fb125(0x259)]()-_0x3b1548)/(0x3e8*0x3c*0x3c);let _0x13ebb4='';_0x2588fa['config'][_0x8fb125(0xc6)]&&_0x2588fa[_0x8fb125(0x111)]===SYSTEM_MODES['NORMAL']&&_0x2588fa[_0x8fb125(0x14e)]&&(_0xa14fc7>_0x3857d5&&(_0x13ebb4=_0x8fb125(0x107)+_0xa14fc7[_0x8fb125(0x1ca)](0x1)+_0x8fb125(0x131))),runGeminiAnalysis(_0x2588fa,_0x13ebb4)['catch'](_0x5c95aa=>_0x2588fa[_0x8fb125(0x213)][_0x8fb125(0x18d)](_0x5c95aa));}async function createDailyDigest(_0x438140){const _0x54706c=a0_0x249d00;if(!_0x438140['isProVersion'])return;await _0x438140[_0x54706c(0x16c)](LTM_DP_STATUS,{'val':_0x54706c(0x21e)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x438140['geminiModel']||_0x438140[_0x54706c(0x18a)][_0x54706c(0x1c0)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x438140[_0x54706c(0x16c)](LTM_DP_STATUS,{'val':_0x54706c(0x16b),'ack':!![]});return;}const _0x1c5054=JSON[_0x54706c(0x147)](JSON['stringify'](_0x438140[_0x54706c(0x18a)])),_0x2a5918=_0x1c5054[_0x54706c(0x1c0)],_0x3d5065='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON['stringify'](_0x1c5054);try{const _0x3b2afa=await _0x438140[_0x54706c(0x12c)][_0x54706c(0x1f5)](_0x3d5065),_0x98603c=JSON['parse'](_0x3b2afa['response'][_0x54706c(0x1d0)]()[_0x54706c(0x24f)](/```json|```/g,'')[_0x54706c(0x222)]());_0x98603c[_0x54706c(0x1f0)]&&(_0x438140[_0x54706c(0x258)][_0x54706c(0x100)]({'timestamp':new Date()['toISOString'](),'eventCount':_0x2a5918,'summary':_0x98603c[_0x54706c(0x1f0)],'activityLevel':_0x98603c[_0x54706c(0x116)],'systemMode':_0x438140[_0x54706c(0x111)]}),await saveDailyDigests(_0x438140),_0x438140[_0x54706c(0x18a)]=[],await saveRawEventLog(_0x438140),await _0x438140['setStateAsync'](LTM_DP_STATUS,{'val':_0x54706c(0x1a8)+_0x2a5918+'\x20events','ack':!![]}));}catch(_0x3c3415){await _0x438140[_0x54706c(0x16c)](LTM_DP_STATUS,{'val':'Error:\x20'+_0x3c3415[_0x54706c(0x184)],'ack':!![]});}}async function sendMorningBriefing(_0x52f945){const _0x2b85d5=a0_0x249d00;if(!_0x52f945[_0x2b85d5(0x12c)])return;_0x52f945['log']['info'](_0x2b85d5(0xd9));const _0x3da28d=_0x52f945[_0x2b85d5(0x258)][_0x2b85d5(0x1c0)]>0x0?_0x52f945[_0x2b85d5(0x258)][_0x52f945[_0x2b85d5(0x258)][_0x2b85d5(0x1c0)]-0x1]:null,_0x316d30=_0x3da28d&&_0x3da28d[_0x2b85d5(0x133)]?_0x3da28d[_0x2b85d5(0x133)][_0x2b85d5(0x16d)]:_0x2b85d5(0x13d),_0x5875f1=new Date();_0x5875f1['setHours'](0x4,0x0,0x0,0x0);const _0x244a9a=_0x52f945[_0x2b85d5(0xc5)][_0x2b85d5(0x1e7)](_0x91119d=>new Date(_0x91119d[_0x2b85d5(0x1a5)])>_0x5875f1),_0x3b65eb=PERSONA_MAPPING[_0x52f945[_0x2b85d5(0x211)][_0x2b85d5(0x230)]||_0x2b85d5(0xe0)],_0xc08570=_0x52f945[_0x2b85d5(0x211)][_0x2b85d5(0x1a0)]||'',_0x532dab=await getWeatherContext(_0x52f945),_0x40e671=await getCalendarContext(_0x52f945),_0x34e928='ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20'+_0x3b65eb+_0x2b85d5(0x26c)+_0xc08570+_0x2b85d5(0x261)+_0x532dab+'\x20'+_0x40e671+_0x2b85d5(0xc1)+_0x316d30+_0x2b85d5(0x237)+JSON['stringify'](_0x244a9a[_0x2b85d5(0x113)](0x0,0xa))+_0x2b85d5(0x18b);try{const _0x3a1ef5=await _0x52f945[_0x2b85d5(0x12c)][_0x2b85d5(0x1f5)](_0x34e928),_0x2da165=_0x2b85d5(0x231)+_0x3a1ef5['response'][_0x2b85d5(0x1d0)]()[_0x2b85d5(0x222)]();sendNotification(_0x52f945,_0x2da165),_0x52f945[_0x2b85d5(0x213)][_0x2b85d5(0xcc)](_0x2b85d5(0x15f));}catch(_0xe054bb){_0x52f945[_0x2b85d5(0x213)][_0x2b85d5(0x18d)](_0x2b85d5(0x1c9)+_0xe054bb['message']);}}async function scanForDevices(_0x2af217,_0x2bdc31){const _0x8eed9d=a0_0x249d00;_0x2af217[_0x8eed9d(0x213)][_0x8eed9d(0xcc)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x767822=[],_0x2ce4ff=await _0x2af217['getForeignObjectsAsync']('*'),_0x171e41=await _0x2af217[_0x8eed9d(0xfc)](_0x8eed9d(0x110),_0x8eed9d(0x1af)),_0x55930e=await _0x2af217[_0x8eed9d(0xfc)](_0x8eed9d(0x119),_0x8eed9d(0x1af)),_0x53543c={};if(_0x171e41)for(const _0x44dfec in _0x171e41){const _0x2f8662=_0x171e41[_0x44dfec]['common'][_0x8eed9d(0x17b)]||[];_0x2f8662[_0x8eed9d(0x1f3)](_0x3c286f=>{const _0x4da8db=_0x8eed9d;if(!_0x53543c[_0x3c286f])_0x53543c[_0x3c286f]=[];_0x53543c[_0x3c286f][_0x4da8db(0x100)](_0x44dfec);});}const _0x42532e={};if(_0x55930e)for(const _0x50e431 in _0x55930e){const _0x13c268=_0x55930e[_0x50e431][_0x8eed9d(0x192)][_0x8eed9d(0x17b)]||[],_0x5a063c=typeof _0x55930e[_0x50e431][_0x8eed9d(0x192)][_0x8eed9d(0x177)]===_0x8eed9d(0x141)?_0x55930e[_0x50e431]['common'][_0x8eed9d(0x177)]['de']:_0x55930e[_0x50e431][_0x8eed9d(0x192)][_0x8eed9d(0x177)];_0x13c268[_0x8eed9d(0x1f3)](_0x5ebbab=>_0x42532e[_0x5ebbab]=_0x5a063c);}const _0x1d6f83=_0x2bdc31[_0x8eed9d(0x276)]||[],_0x570f27=_0x2bdc31['motion']!==![],_0x15f914=_0x2bdc31[_0x8eed9d(0x136)]!==![],_0x4a3d33=_0x2bdc31['lights']!==![],_0x119ac6=_0x2bdc31[_0x8eed9d(0x19e)]===!![],_0x809617=_0x2bdc31[_0x8eed9d(0x1b9)]===!![];for(const _0x503352 in _0x2ce4ff){const _0x4d544a=_0x2ce4ff[_0x503352];if(_0x4d544a[_0x8eed9d(0x266)]!==_0x8eed9d(0x217)||!_0x4d544a[_0x8eed9d(0x192)])continue;if(ADAPTER_BLACKLIST['some'](_0x1445a0=>_0x503352[_0x8eed9d(0x1e8)](_0x1445a0))&&!_0x809617)continue;const _0x5a138d=(_0x4d544a[_0x8eed9d(0x192)]['role']||'')['toLowerCase']();let _0xe77394=(typeof _0x4d544a[_0x8eed9d(0x192)]['name']===_0x8eed9d(0x141)?_0x4d544a[_0x8eed9d(0x192)][_0x8eed9d(0x177)]['de']:_0x4d544a[_0x8eed9d(0x192)][_0x8eed9d(0x177)])||_0x503352;const _0x5707b3=_0xe77394[_0x8eed9d(0x148)]();let _0x5d437b=![],_0x4e9b4d=![];if(_0x1d6f83[_0x8eed9d(0x1c0)]>0x0){const _0x1a4ccf=_0x53543c[_0x503352]||[],_0x1f0ae5=_0x503352[_0x8eed9d(0xe4)]('.')[_0x8eed9d(0x113)](0x0,-0x1)[_0x8eed9d(0x101)]('.'),_0x3c1ca1=_0x53543c[_0x1f0ae5]||[];(_0x1a4ccf['some'](_0x516e40=>_0x1d6f83[_0x8eed9d(0x22b)](_0x516e40))||_0x3c1ca1[_0x8eed9d(0x134)](_0x4b9c2b=>_0x1d6f83[_0x8eed9d(0x22b)](_0x4b9c2b)))&&(_0x5d437b=!![],_0x4e9b4d=!![]);}if(!_0x5d437b&&!_0x809617){if(HARD_IGNORE_TERMS['some'](_0x10e540=>_0x503352['includes'](_0x10e540)||_0x5707b3[_0x8eed9d(0x22b)](_0x10e540['toLowerCase']())))continue;}if(BAD_NAMES[_0x8eed9d(0x134)](_0x41c454=>_0x5707b3===_0x41c454||_0x5707b3[_0x8eed9d(0x1d9)]('.'+_0x41c454))){const _0x3fe96f=_0x503352[_0x8eed9d(0xe4)]('.');if(_0x3fe96f['length']>0x2){const _0x2575fb=_0x3fe96f[_0x8eed9d(0x113)](0x0,-0x1)[_0x8eed9d(0x101)]('.'),_0x4a4e53=_0x2ce4ff[_0x2575fb];if(_0x4a4e53&&_0x4a4e53[_0x8eed9d(0x192)]&&_0x4a4e53[_0x8eed9d(0x192)][_0x8eed9d(0x177)]){const _0x3605d8=typeof _0x4a4e53[_0x8eed9d(0x192)]['name']==='object'?_0x4a4e53[_0x8eed9d(0x192)][_0x8eed9d(0x177)]['de']:_0x4a4e53['common']['name'];_0x3605d8&&!_0xe77394[_0x8eed9d(0x22b)](_0x3605d8)&&(_0xe77394=_0x3605d8+'\x20'+_0xe77394);}}}let _0x120fcb='';if(_0x570f27&&(_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x196))||_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x270))||_0x5707b3['includes'](_0x8eed9d(0xe2))||_0x5707b3['includes'](_0x8eed9d(0xf2))))_0x120fcb='motion';else{if(!_0x120fcb&&_0x15f914&&(_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x144))||_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x1b5))||_0x5a138d[_0x8eed9d(0x22b)]('lock')||_0x5a138d['includes'](_0x8eed9d(0x26a))||_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x11d))||_0x5707b3[_0x8eed9d(0x22b)](_0x8eed9d(0x23a))||_0x5707b3[_0x8eed9d(0x22b)](_0x8eed9d(0x199))||_0x5707b3[_0x8eed9d(0x22b)](_0x8eed9d(0x18f))))_0x120fcb='door';else{if(!_0x120fcb&&_0x4a3d33&&(_0x5a138d[_0x8eed9d(0x22b)]('light')||_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x182))||_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x21f))||_0x5707b3['includes'](_0x8eed9d(0x1a7))||_0x5707b3[_0x8eed9d(0x22b)](_0x8eed9d(0x19c))||_0x5707b3[_0x8eed9d(0x22b)](_0x8eed9d(0x1c7)))){if(_0x4d544a[_0x8eed9d(0x192)][_0x8eed9d(0x265)]||_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x174)))_0x120fcb=_0x8eed9d(0x158);}else{if(!_0x120fcb&&_0x119ac6&&(_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x19e))||_0x5a138d['includes'](_0x8eed9d(0x1bc))||_0x5a138d[_0x8eed9d(0x22b)](_0x8eed9d(0x23c))||_0x5707b3['includes'](_0x8eed9d(0x17f))||_0x5707b3[_0x8eed9d(0x22b)](_0x8eed9d(0x24d))||_0x5707b3[_0x8eed9d(0x22b)](_0x8eed9d(0x170))))_0x120fcb=_0x8eed9d(0x19e);else{if(!_0x120fcb&&_0x4e9b4d)_0x120fcb=_0x8eed9d(0x188);}}}}if(_0x120fcb){let _0x387d87=_0x42532e[_0x503352]||'';if(!_0x387d87){let _0xea832b=_0x503352;for(let _0x411ee7=0x0;_0x411ee7<0x3;_0x411ee7++){const _0x28ac92=_0xea832b[_0x8eed9d(0xd5)]('.');if(_0x28ac92===-0x1)break;_0xea832b=_0xea832b[_0x8eed9d(0x16a)](0x0,_0x28ac92);if(_0x42532e[_0xea832b]){_0x387d87=_0x42532e[_0xea832b];break;}}}_0x767822[_0x8eed9d(0x100)]({'id':_0x503352,'name':_0xe77394,'location':_0x387d87,'type':_0x120fcb,'logDuplicates':_0x120fcb==='motion','isExit':![],'_score':_0x387d87?0x50:_0x120fcb===_0x8eed9d(0x188)?0x5a:0x28});}}return _0x767822['sort']((_0x2fe857,_0xca89ce)=>_0xca89ce[_0x8eed9d(0x12f)]-_0x2fe857['_score']),_0x767822;}async function executeAutomationAction(_0x4acbfe){const _0x4a2fd6=a0_0x249d00;try{const _0x5bc578=await _0x4acbfe[_0x4a2fd6(0x120)]('analysis.automation.targetId'),_0x1d0268=await _0x4acbfe[_0x4a2fd6(0x120)](_0x4a2fd6(0x236));if(_0x5bc578&&_0x5bc578['val']&&_0x1d0268){const _0xbe5548=_0x5bc578[_0x4a2fd6(0x221)];let _0x26055f=_0x1d0268[_0x4a2fd6(0x221)];try{_0x26055f=JSON[_0x4a2fd6(0x147)](_0x26055f);}catch(_0x1c8fcb){}_0x4acbfe[_0x4a2fd6(0x213)][_0x4a2fd6(0xcc)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0xbe5548+_0x4a2fd6(0x241)+_0x26055f),await _0x4acbfe['setForeignStateAsync'](_0xbe5548,_0x26055f);}else _0x4acbfe['log'][_0x4a2fd6(0x23e)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x14f5b0){_0x4acbfe[_0x4a2fd6(0x213)][_0x4a2fd6(0x18d)](_0x4a2fd6(0x1fb)+_0x14f5b0[_0x4a2fd6(0x184)]);}}function tryParse(_0x1a7e00){const _0x5f4230=a0_0x249d00;try{return JSON[_0x5f4230(0x147)](_0x1a7e00);}catch(_0x3b952f){return null;}}function a0_0x282f(_0x12fbd4,_0x20873b){const _0x40a4c0=a0_0x1328();return a0_0x282f=function(_0x876e82,_0x3d68ab){_0x876e82=_0x876e82-0xbe;let _0x132851=_0x40a4c0[_0x876e82];return _0x132851;},a0_0x282f(_0x12fbd4,_0x20873b);}async function processSensorEvent(_0x1f26b4,_0x1c88e5,_0x4c9d76,_0x527ee3){const _0x251f24=a0_0x249d00;if(!_0x527ee3)return;const _0x30e68f=_0x4c9d76[_0x251f24(0x221)],_0x3a847f=Date['now']();_0x1f26b4[_0x251f24(0x213)][_0x251f24(0x226)]('Event\x20received:\x20'+_0x1c88e5+_0x251f24(0x241)+_0x30e68f),_0x1f26b4[_0x251f24(0x1ae)][_0x1c88e5]=_0x30e68f;if(!_0x527ee3['logDuplicates']&&_0x1f26b4[_0x251f24(0xc5)]&&_0x1f26b4['eventHistory'][_0x251f24(0x1c0)]>0x0){const _0xbe2ab1=_0x1f26b4[_0x251f24(0xc5)][0x0];if(_0xbe2ab1['id']===_0x1c88e5&&_0xbe2ab1[_0x251f24(0x1b3)]===_0x30e68f&&_0x3a847f-_0xbe2ab1[_0x251f24(0x1a5)]<0x7d0)return;}const _0x4680f6={'timestamp':_0x3a847f,'id':_0x1c88e5,'name':_0x527ee3[_0x251f24(0x177)],'type':_0x527ee3['type'],'location':_0x527ee3['location'],'value':_0x30e68f};_0x1f26b4['eventHistory']['unshift'](_0x4680f6);if(_0x1f26b4[_0x251f24(0xc5)][_0x251f24(0x1c0)]>HISTORY_MAX_SIZE)_0x1f26b4[_0x251f24(0xc5)][_0x251f24(0x17d)]();await _0x1f26b4[_0x251f24(0x16c)]('events.lastEvent',{'val':JSON[_0x251f24(0x229)](_0x4680f6),'ack':!![]}),await _0x1f26b4['setStateAsync'](_0x251f24(0x254),{'val':JSON[_0x251f24(0x229)](_0x1f26b4[_0x251f24(0xc5)]),'ack':!![]});_0x1f26b4[_0x251f24(0x1be)]&&(_0x1f26b4[_0x251f24(0x18a)][_0x251f24(0x100)](_0x4680f6),await saveRawEventLog(_0x1f26b4));if(_0x527ee3['isExit']&&_0x30e68f===!![]){if(_0x1f26b4[_0x251f24(0x14e)]&&!_0x1f26b4[_0x251f24(0x1b1)])_0x1f26b4[_0x251f24(0x213)][_0x251f24(0xcc)](_0x251f24(0x178)+_0x527ee3[_0x251f24(0x177)]+').\x20Starting\x20Timer.'),startExitTimer(_0x1f26b4);else!_0x1f26b4[_0x251f24(0x14e)]&&(_0x1f26b4[_0x251f24(0x213)]['info'](_0x251f24(0x19b)+_0x527ee3[_0x251f24(0x177)]+_0x251f24(0x1c4)),await setPresence(_0x1f26b4,!![]));}else _0x527ee3[_0x251f24(0x266)]===_0x251f24(0x196)&&_0x30e68f===!![]&&(_0x1f26b4[_0x251f24(0x245)]&&(_0x1f26b4['log'][_0x251f24(0xcc)](_0x251f24(0xf9)),abortExitTimer(_0x1f26b4)),!_0x1f26b4[_0x251f24(0x14e)]&&_0x1f26b4[_0x251f24(0x111)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x1f26b4,!![]));}function a0_0x1328(){const _0x1fc0a0=['dailyDigests','now','python_service','analysis.comfortSummary','Drift\x20Details','useCalendar','analysisInterval','version','AI\x20Emergency\x20Status','.\x20ZUSATZ:\x20','KALENDER\x20ERROR:\x20','inactivityThresholdHours','driftAnalysisTimer','write','type','\x0aSTB:\x20','KALENDER:\x20Keine\x20Daten','.data.table','blind','System\x20Mode','.\x20KONTEXT:\x20','boolean','stderr','notifyTelegramRecipient','occupancy','Who\x20is\x20present?','analysis.trigger','service.py','Health\x20&\x20Sleep\x20Analysis','scriptProblem','selectedFunctionIds','longitude','LTM.driftAnalysis.driftDetails','cogni-living\x20adapter\x20starting\x20(v','.\x20DATEN:\x20Schlaf\x20','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','analysis.health.restlessness','analysis.health','eventHistory','inactivityMonitoringEnabled','status','briefingEnabled','update','[PYTHON\x20ERR]\x20','Gemini\x20Init\x20Error:\x20','info','Restlessness\x20Level','getTime','namespace','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','siren','system.','0\x203\x20*\x20*\x20*','main','lastIndexOf','config_pending','ðŸš¨\x20EMERGENCY','off','Generating\x20Morning\x20Briefing...','1545432arxnxC','836066ByYbWH','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','node-schedule','analysis.automation.patternDetected','systemUUID','generic','vacation','bewegung','isArray','split','stateChange','level','Automation\x20Proposals','GUEST','Analysiere\x20ausgewogen.','Starting\x20Autopilot\x20(','analysisHistory','kill','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','latitude','Drift\x20Status','communicate.request','minDaysForBaseline','prÃ¤senz','analysis.lastResult','guest','modeResetJob','Keine\x20Details.','exports','retry','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','Wetter:\x20Deaktiviert','command','getForeignObjectsAsync','uuid-error','COGNI_CONFIRM_OK','Feedback\x20saved:\x20','push','join','constructor','LTM.driftAnalysis','path','Target\x20ID','Last\x20raw\x20event','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','410431CPeoyV','getOverviewData','analysis.automation','party','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','.forecast.current.state','onStateChange','geminiApiKey','enum.functions.*','currentSystemMode','fill','slice','WETTER:\x20Keine\x20Daten\x20gefunden','online','activityLevel','\x20presence\x20devices...','none','enum.rooms.*','notifyTelegramInstance','Could\x20not\x20kill\x20Python\x20process:\x20','application/json','shutter','text.alarm','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','getStateAsync','Error\x20launching\x20Python\x20service:\x20','unknown','Event\x20History','value.health','12vIgJAx','getHours','getEnums','Gast','useWeather','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','system.isPresent','geminiModel','Subscribing\x20to\x20','Trigger\x20Analysis','_score','Urlaub','\x20hours.\x20Potential\x20incapacitation.','âœ…\x20Alles\x20OK\x20(Reset)','health','some','driftDetails','doors','Last\x20Result','ready','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','Last\x20Check','onUnload','Reset\x20Sched\x20Error:\x20','N/A','energy','KI-Modell\x20nicht\x20initialisiert','subscribeStates','object','Logbook','LTM.triggerDailyDigest','door','unshift','cover','parse','toLowerCase','triggerBriefing','link_quality','devices','button','number','isPresent','analysis.isAlert','automation.triggerAction','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','alertReason','genAI','analysis.automation.triggerAction','lastAlertState','VACATION','sendToAsync','light','LTM.dailyDigests','PRIORITÃ„T:\x20Gesundheit/AAL.','power','Action','analysisTimer','subscribeForeignStatesAsync','Morning\x20Briefing\x20sent.','PRO-','08:00','string','KALENDER:\x20Keine\x20relevanten\x20Termine','systemConfig','channel','Normal','Party','briefingTime','Scheduling\x20Morning\x20Briefing\x20for\x20','substring','Skipped\x20(No\x20AI\x20or\x20Data)','setStateAsync','sleepScore','analysis.automation.description','data','heizung','map','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','PRIORITÃ„T:\x20Sicherheit.','sensor','isAlert','\x20min).','name','Exit\x20Sensor\x20triggered\x20(','automationProposal','firmware','members','ack','pop','native','temp','analysis.isEmergency','getForeignObjectAsync','switch','scanDevices','message','setpoint','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','ltmDriftCheckIntervalHours','custom','setObjectNotExistsAsync','rawEventLog','.\x20OUTPUT:\x20Nur\x20Text.','Target\x20Value','error','cogni-living','rollladen','TEST-PRO-KEY','getDate','common','Adapter','LTM.processingStatus','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','motion','values','analysis.health.notes','tÃ¼r','fault','Entry\x20detected\x20via\x20','lampe','analysis.triggerBriefing','temperature','indicator.alarm','livingContext','stick_unreach','unload','Gemini\x20Analysis\x20Error:\x20','targetValue','timestamp','Processing\x20Status','licht','Success:\x20Compressed\x20','weatherInstance','Trigger\x20Action\x20Now','uuid','autoApply','759745ohkbUz','sensorLastValues','enum','notifyPushoverEnabled','isGracePeriodActive','WETTER\x20ERROR:\x20','value','COGNI_REQUEST_CALL','window','baselineDrift','analysis.alertReason','setState','weather','Alarm','analysis.automation.targetId','humidity','json','isProVersion','targetId','length','extendObjectAsync','city','targetposition','.\x20Welcome\x20home.','simulateButler','exitGraceTimer','schalter','AI\x20Alert\x20Status','Briefing\x20Error:\x20','toFixed','actual_temperature','dismissAutomation','briefingJob','LTM\x20Sched\x20Error:\x20','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','text','notifyTelegramEnabled','Drift\x20Analysis','analysis.automation.suggestedAction','892678WmUJge','analysis.history_debug_00','toString','Briefing\x20Sched\x20Error:\x20','close','endsWith','find','indexOf','detected','Keiner','direction','onReady','Activity\x20Summary','daswetter.0','splice','admin.','Error\x20in\x20onMessage\x20command\x20','sendTo','search','filter','startsWith','callback','uuid-not-found','working','LTM.driftAnalysis.lastCheck','Missing\x20data','LTM','models/gemini-flash-latest','summary','684204XCaEXo','set_temperature','forEach','pythonProcess','generateContent','getForeignStateAsync','testApiKey','ltmStbWindowDays','\x20|\x20','(((.+)+)+)+$','BUTLER\x20Execution\x20Error:\x20','_calName','getLtmData','analysis.deviationFromBaseline','description','notifyEmailInstance','ltmJob','from','analysis.analysisHistory','echarts.','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','getObjectAsync','analysis.automation.autoApply','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','system.presenceWho','getGenerativeModel','.Summary.Current','.\x0a\x20\x20\x20\x20KONTEXT:\x20','cancel','Pattern\x20Detected','PARTY','sound','config','send','log','material.','.communicate.request','Sleep\x20Score\x20(0-100)','state','analysis.activitySummary','Raw\x20Log','bind','getFullYear','0\x204\x20*\x20*\x20*','ðŸ“¡\x20Hooking\x20into\x20','Started\x20at\x20','dimmer','system','val','trim','notifyEmailEnabled','sort','details','debug','Alert\x20Reason','Drift\x20Sched\x20Error:\x20','stringify','delObjectAsync','includes','icons-mfd.','system.meta.uuid','Cogni-Living','KALENDER:\x20','aiPersona','ðŸŒ…\x20Daily\x20Briefing:\x0a','Trigger\x20Briefing\x20(Test)','presence','licenseKey','Deaktiviert\x20(Pro-Feature)','analysis.automation.targetValue','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','Daily\x20Digests','Fokus\x20auf\x20Komfort.','fenster','LTM.rawEventLog','thermostat','position','warn','response','system.mode','\x20=\x20','Comfort\x20Summary','10167680jVfyHG','scheduleJob','exitTimer','flot.','calendarSelection','NORMAL','analysis.health.sleepScore','Sending\x20notification:\x20\x22','triggerDailyDigest','[PYTHON]\x20','klima','LTM.driftAnalysis.baselineDrift','replace','Baseline\x20Status','presenceDevices','system.config','Comfort\x20Suggestion','events.history','date','events.history_debug_00','ltmLtbWindowDays'];a0_0x1328=function(){return _0x1fc0a0;};return a0_0x1328();}async function runGeminiAnalysis(_0x2bb3e1,_0x41b61c=''){const _0x31c081=a0_0x249d00;if(!_0x2bb3e1['geminiModel'])return;if(_0x2bb3e1[_0x31c081(0xc5)][_0x31c081(0x1c0)]===0x0)return;const _0x3b8770=_0x2bb3e1[_0x31c081(0xc5)][_0x31c081(0x113)](0x0,0xf),_0x51039b=await getWeatherContext(_0x2bb3e1),_0x59e738=_0x2bb3e1[_0x31c081(0x111)],_0x1d6d16=PERSONA_MAPPING[_0x2bb3e1[_0x31c081(0x211)][_0x31c081(0x230)]||_0x31c081(0xe0)],_0x55a18e=_0x2bb3e1[_0x31c081(0x211)][_0x31c081(0x1a0)]||_0x31c081(0xf6);let _0x3d111b=![];try{const _0x2d392c=await _0x2bb3e1[_0x31c081(0x120)]('analysis.automation.autoApply');if(_0x2d392c&&_0x2d392c['val'])_0x3d111b=!![];}catch(_0x4b26be){}const _0x5563ff=_0x31c081(0x195)+_0x1d6d16+_0x31c081(0x20c)+_0x55a18e+_0x31c081(0x11f)+_0x59e738+'.\x0a\x20\x20\x20\x20WETTER:\x20'+_0x51039b+'.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20'+(_0x41b61c||_0x31c081(0x1dd))+_0x31c081(0xc2)+JSON[_0x31c081(0x229)](_0x3b8770)+_0x31c081(0x1cf);try{const _0xfac2bc=await _0x2bb3e1[_0x31c081(0x12c)][_0x31c081(0x1f5)](_0x5563ff),_0x4a3c9a=_0xfac2bc[_0x31c081(0x23f)][_0x31c081(0x1d0)]()['replace'](/```json|```/g,'')[_0x31c081(0x222)](),_0x168984=JSON[_0x31c081(0x147)](_0x4a3c9a);await _0x2bb3e1[_0x31c081(0x16c)]('analysis.lastResult',{'val':JSON[_0x31c081(0x229)](_0x168984),'ack':!![]});const _0x26139a=_0x168984[_0x31c081(0x175)]||![];_0x26139a!==_0x2bb3e1[_0x31c081(0x155)]&&(await _0x2bb3e1[_0x31c081(0x16c)](_0x31c081(0x14f),{'val':_0x26139a,'ack':!![]}),_0x2bb3e1['lastAlertState']=_0x26139a,_0x26139a&&(await _0x2bb3e1[_0x31c081(0x16c)](_0x31c081(0x1b7),{'val':_0x168984[_0x31c081(0x152)],'ack':!![]}),sendNotification(_0x2bb3e1,'âš ï¸\x20ALARM:\x20'+_0x168984[_0x31c081(0x152)],![],_0x168984['isEmergency']))),_0x168984['automationProposal']&&_0x168984[_0x31c081(0x179)][_0x31c081(0x1dc)]&&_0x168984['automationProposal'][_0x31c081(0x1bf)]&&(_0x2bb3e1[_0x31c081(0x213)][_0x31c081(0xcc)]('ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20'+_0x168984[_0x31c081(0x179)]['description']),await _0x2bb3e1['setStateAsync'](_0x31c081(0xde),{'val':!![],'ack':!![]}),await _0x2bb3e1[_0x31c081(0x16c)](_0x31c081(0x16e),{'val':_0x168984[_0x31c081(0x179)][_0x31c081(0x1ff)],'ack':!![]}),await _0x2bb3e1[_0x31c081(0x16c)]('analysis.automation.targetId',{'val':_0x168984[_0x31c081(0x179)][_0x31c081(0x1bf)],'ack':!![]}),await _0x2bb3e1['setStateAsync'](_0x31c081(0x236),{'val':JSON[_0x31c081(0x229)](_0x168984[_0x31c081(0x179)][_0x31c081(0x1a4)]),'ack':!![]}),_0x3d111b&&(_0x2bb3e1['log']['info'](_0x31c081(0x139)+_0x168984[_0x31c081(0x179)][_0x31c081(0x1bf)]+'...'),await executeAutomationAction(_0x2bb3e1)));}catch(_0x382adf){_0x2bb3e1[_0x31c081(0x213)][_0x31c081(0x18d)](_0x31c081(0x1a3)+_0x382adf['message']);}}function startPythonService(_0x5172f5){const _0x54144f=a0_0x249d00;try{const _0x3523a6=path[_0x54144f(0x101)](__dirname,_0x54144f(0x25a),_0x54144f(0x273));_0x5172f5[_0x54144f(0x213)][_0x54144f(0xcc)](_0x54144f(0xed)+_0x3523a6),_0x5172f5[_0x54144f(0x1f4)]=spawn('python3',[_0x3523a6]),_0x5172f5[_0x54144f(0x1f4)]['stdout']['on'](_0x54144f(0x16f),_0x3e7bee=>{const _0x49093a=_0x54144f,_0x504972=_0x3e7bee[_0x49093a(0x1d6)]()['trim']();_0x5172f5[_0x49093a(0x213)][_0x49093a(0x226)](_0x49093a(0x24c)+_0x504972);}),_0x5172f5[_0x54144f(0x1f4)][_0x54144f(0x26e)]['on'](_0x54144f(0x16f),_0x4a0b36=>{const _0x5484ae=_0x54144f,_0x23638e=_0x4a0b36[_0x5484ae(0x1d6)]()['trim']();_0x5172f5[_0x5484ae(0x213)]['error'](_0x5484ae(0xca)+_0x23638e);}),_0x5172f5['pythonProcess']['on'](_0x54144f(0x1d8),_0x1546d4=>{const _0x3f89cc=_0x54144f;_0x5172f5[_0x3f89cc(0x213)][_0x3f89cc(0xcc)](_0x3f89cc(0xdc)+_0x1546d4),_0x5172f5[_0x3f89cc(0x1f4)]=null;}),_0x5172f5[_0x54144f(0x1f4)]['on'](_0x54144f(0x18d),_0x434adf=>{const _0x3daa27=_0x54144f;_0x5172f5[_0x3daa27(0x213)][_0x3daa27(0x23e)](_0x3daa27(0x208)+_0x434adf[_0x3daa27(0x184)]);});}catch(_0x43dcca){_0x5172f5[_0x54144f(0x213)]['error'](_0x54144f(0x121)+_0x43dcca['message']);}}function stopPythonService(_0x2b9ead){const _0x79263b=a0_0x249d00;if(_0x2b9ead[_0x79263b(0x1f4)]){_0x2b9ead[_0x79263b(0x213)]['info']('ðŸ\x20Stopping\x20Python\x20Sidecar...');try{_0x2b9ead[_0x79263b(0x1f4)][_0x79263b(0xec)]();}catch(_0x1ccc2e){_0x2b9ead[_0x79263b(0x213)][_0x79263b(0x23e)](_0x79263b(0x11b)+_0x1ccc2e[_0x79263b(0x184)]);}_0x2b9ead[_0x79263b(0x1f4)]=null;}}class CogniLiving extends utils[a0_0x249d00(0x193)]{constructor(_0x468564){const _0x463da2=a0_0x249d00;super({..._0x468564,'name':_0x463da2(0x18e)}),this[_0x463da2(0xc5)]=[],this['analysisHistory']=[],this['feedbackHistory']=[],this[_0x463da2(0x18a)]=[],this[_0x463da2(0x258)]=[],this['sensorLastValues']={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x463da2(0x245)]=null,this[_0x463da2(0x1c6)]=null,this[_0x463da2(0x1b1)]=![],this['genAI']=null,this[_0x463da2(0x12c)]=null,this[_0x463da2(0x111)]=SYSTEM_MODES[_0x463da2(0x248)],this['isProVersion']=![],this[_0x463da2(0x155)]=![],this[_0x463da2(0xdf)]=_0x463da2(0x122),this['analysisTimer']=null,this[_0x463da2(0x201)]=null,this[_0x463da2(0xf5)]=null,this[_0x463da2(0x264)]=null,this[_0x463da2(0x1cd)]=null,this[_0x463da2(0x1f4)]=null,this['on'](_0x463da2(0x138),this['onReady'][_0x463da2(0x21a)](this)),this['on'](_0x463da2(0xe5),this[_0x463da2(0x10e)][_0x463da2(0x21a)](this)),this['on'](_0x463da2(0x1a2),this[_0x463da2(0x13b)]['bind'](this)),this['on'](_0x463da2(0x184),this['onMessage'][_0x463da2(0x21a)](this));}async[a0_0x249d00(0x1df)](){const _0x55f4bf=a0_0x249d00;this[_0x55f4bf(0x213)][_0x55f4bf(0xcc)](_0x55f4bf(0xc0)+this[_0x55f4bf(0x25f)]+')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE'),await initZombies(this),this[_0x55f4bf(0x211)][_0x55f4bf(0x234)]=this['config'][_0x55f4bf(0x234)]||'';try{this[_0x55f4bf(0x1be)]=await checkLicense(this,this[_0x55f4bf(0x211)][_0x55f4bf(0x234)]);}catch(_0x1cf0af){}if(!this[_0x55f4bf(0x211)][_0x55f4bf(0x263)]||this['config'][_0x55f4bf(0x263)]<0.1)this['config']['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x55f4bf(0x211)][_0x55f4bf(0x10f)])try{this['genAI']=new GoogleGenerativeAI(this[_0x55f4bf(0x211)][_0x55f4bf(0x10f)]),this['geminiModel']=this[_0x55f4bf(0x153)][_0x55f4bf(0x20a)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x55f4bf(0x11c)}}),this['log']['info']('Gemini\x20AI\x20initialized.');}catch(_0xcda510){this['log'][_0x55f4bf(0x18d)](_0x55f4bf(0xcb)+_0xcda510[_0x55f4bf(0x184)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates'](_0x55f4bf(0x272)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x55f4bf(0x240)),this[_0x55f4bf(0x140)](_0x55f4bf(0x19d)),this['subscribeStates'](_0x55f4bf(0x154)),this[_0x55f4bf(0x140)](_0x55f4bf(0x207)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0x55f4bf(0x15d)]);const _0x5eb8a7=this[_0x55f4bf(0x211)][_0x55f4bf(0x25e)]||0xf;_0x5eb8a7>0x0&&(this[_0x55f4bf(0x213)][_0x55f4bf(0xcc)](_0x55f4bf(0xea)+_0x5eb8a7+_0x55f4bf(0x176)),this['analysisTimer']=setInterval(()=>{runAutopilot(this);},_0x5eb8a7*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this);}['onUnload'](_0x4fdc03){const _0x53b593=a0_0x249d00;if(this[_0x53b593(0x15d)])clearInterval(this['analysisTimer']);if(this[_0x53b593(0x264)])clearInterval(this[_0x53b593(0x264)]);if(this[_0x53b593(0x201)])this[_0x53b593(0x201)][_0x53b593(0x20d)]();if(this[_0x53b593(0xf5)])this['modeResetJob']['cancel']();if(this[_0x53b593(0x1cd)])this[_0x53b593(0x1cd)]['cancel']();if(this[_0x53b593(0x245)])clearTimeout(this['exitTimer']);if(this[_0x53b593(0x1c6)])clearTimeout(this[_0x53b593(0x1c6)]);stopPythonService(this),_0x4fdc03();}async[a0_0x249d00(0x10e)](_0x5ccdde,_0x1514ef){const _0x30afce=a0_0x249d00;if(!_0x1514ef)return;if(_0x5ccdde['includes']('telegram')&&_0x5ccdde[_0x30afce(0x1d9)](_0x30afce(0xf0))&&_0x1514ef['val']){await handleTelegramResponse(this,_0x1514ef[_0x30afce(0x221)]);return;}if(_0x5ccdde===this[_0x30afce(0xcf)]+'.'+SYSTEM_DP_MODE){_0x1514ef[_0x30afce(0x221)]&&Object[_0x30afce(0x197)](SYSTEM_MODES)[_0x30afce(0x22b)](_0x1514ef[_0x30afce(0x221)])&&(this[_0x30afce(0x111)]=_0x1514ef['val'],_0x1514ef[_0x30afce(0x221)]===SYSTEM_MODES[_0x30afce(0x156)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x1514ef[_0x30afce(0x17c)])this[_0x30afce(0x1b8)](_0x5ccdde,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x1514ef['ack']){_0x5ccdde[_0x30afce(0x22b)](_0x30afce(0x272))&&_0x1514ef[_0x30afce(0x221)]&&(this[_0x30afce(0x1b8)](_0x5ccdde,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x5ccdde[_0x30afce(0x22b)](_0x30afce(0x24b))&&_0x1514ef[_0x30afce(0x221)]){this[_0x30afce(0x1b8)](_0x5ccdde,{'val':![],'ack':!![]});if(this[_0x30afce(0x1be)])createDailyDigest(this);}_0x5ccdde['includes'](_0x30afce(0x149))&&_0x1514ef[_0x30afce(0x221)]&&(this[_0x30afce(0x1b8)](_0x5ccdde,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x5ccdde[_0x30afce(0x22b)](_0x30afce(0x150))&&_0x1514ef[_0x30afce(0x221)]&&(this[_0x30afce(0x1b8)](_0x5ccdde,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this['config'][_0x30afce(0x251)]&&this['config']['presenceDevices']['includes'](_0x5ccdde)){await checkWifiPresence(this);return;}const _0x49a9d0=(this[_0x30afce(0x211)][_0x30afce(0x14b)]||[])[_0x30afce(0x1da)](_0x12849b=>_0x12849b['id']===_0x5ccdde);if(_0x49a9d0)processSensorEvent(this,_0x5ccdde,_0x1514ef,_0x49a9d0);}async['onMessage'](_0xa70b57){const _0x21a569=a0_0x249d00;if(typeof _0xa70b57===_0x21a569(0x141)&&_0xa70b57['message'])try{if(_0xa70b57[_0x21a569(0xfb)]===_0x21a569(0x1f7)){}else{if(_0xa70b57[_0x21a569(0xfb)]==='testNotification'){}else{if(_0xa70b57[_0x21a569(0xfb)]===_0x21a569(0x1fd)){if(!this[_0x21a569(0x1be)])return this['sendTo'](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':![],'isPro':![]},_0xa70b57[_0x21a569(0x1e9)]);let _0xc01568={'status':_0x21a569(0x13d),'details':'','lastCheck':0x0};try{_0xc01568[_0x21a569(0xc7)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x21a569(0x221)],_0xc01568[_0x21a569(0x225)]=(await this[_0x21a569(0x120)](LTM_DP_DRIFT_DETAILS))[_0x21a569(0x221)],_0xc01568['lastCheck']=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x16cd05){}const _0x2aa7c2=this[_0x21a569(0xeb)]||[];this[_0x21a569(0x1e5)](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x21a569(0x258)],'driftAnalysis':_0xc01568,'analysisHistory':_0x2aa7c2},_0xa70b57[_0x21a569(0x1e9)]);}else{if(_0xa70b57['command']===_0x21a569(0x109)){const _0x47d939=this[_0x21a569(0x258)]['length'],_0x3b2d16=new Date(),_0x484a47=new Date(_0x3b2d16[_0x21a569(0x21b)](),_0x3b2d16['getMonth'](),_0x3b2d16[_0x21a569(0x191)]())[_0x21a569(0xce)](),_0x48595f=this[_0x21a569(0x18a)][_0x21a569(0x1e7)](_0x119113=>new Date(_0x119113[_0x21a569(0x1a5)])[_0x21a569(0xce)]()>_0x484a47)[_0x21a569(0x1c0)],_0x2488ce=new Array(0x18)[_0x21a569(0x112)](0x0);this[_0x21a569(0x18a)][_0x21a569(0x1f3)](_0x425a2e=>{const _0xa1361d=_0x21a569,_0x350930=new Date(_0x425a2e[_0xa1361d(0x1a5)]);if(_0x350930[_0xa1361d(0xce)]()>_0x484a47)_0x2488ce[_0x350930[_0xa1361d(0x126)]()]++;});let _0x57b332={'status':_0x21a569(0x13d)};try{_0x57b332['status']=(await this[_0x21a569(0x120)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x4197f9){}let _0x443aac='';try{const _0x320fec=await this['getStateAsync'](_0x21a569(0x209));_0x443aac=_0x320fec?_0x320fec[_0x21a569(0x221)]:'';}catch(_0x5da74e){}let _0x45abac=null;!this[_0x21a569(0x12c)]&&(_0x45abac=this[_0x21a569(0x211)][_0x21a569(0x10f)]?_0x21a569(0x13f):'Kein\x20API\x20Key!');let _0x2b9140={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x33578e=await this[_0x21a569(0x120)](_0x21a569(0xde)),_0x3758d2=await this[_0x21a569(0x120)](_0x21a569(0x16e)),_0x2fbea2=await this[_0x21a569(0x120)](_0x21a569(0x1bb)),_0xc6d11e=await this[_0x21a569(0x120)](_0x21a569(0x236)),_0x5eac5f=await this['getStateAsync'](_0x21a569(0x207));_0x33578e&&_0x33578e['val']&&(_0x2b9140[_0x21a569(0x1dc)]=!![],_0x2b9140[_0x21a569(0x1ff)]=_0x3758d2?_0x3758d2[_0x21a569(0x221)]:'',_0x2b9140[_0x21a569(0x1bf)]=_0x2fbea2?_0x2fbea2[_0x21a569(0x221)]:'',_0x2b9140[_0x21a569(0x1a4)]=_0xc6d11e?_0xc6d11e['val']:''),_0x2b9140[_0x21a569(0x1ac)]=_0x5eac5f?!!_0x5eac5f[_0x21a569(0x221)]:![];}catch(_0x2520a4){}this[_0x21a569(0x1e5)](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':!![],'eventHistory':this[_0x21a569(0xc5)][_0x21a569(0x113)](0x0,0xf),'stats':{'digestCount':_0x47d939,'eventCountToday':_0x48595f,'hourlyActivity':_0x2488ce,'driftStatus':_0x57b332[_0x21a569(0xc7)],'isPresent':this[_0x21a569(0x14e)],'presenceWho':_0x443aac,'minDays':this['config'][_0x21a569(0xf1)]||0x7,'stbDays':this[_0x21a569(0x211)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x21a569(0x211)][_0x21a569(0x257)]||0x3c,'systemError':_0x45abac},'automation':_0x2b9140},_0xa70b57[_0x21a569(0x1e9)]);}else{if(_0xa70b57[_0x21a569(0xfb)]===_0x21a569(0x127)){const _0x577efa=await this['getForeignObjectsAsync'](_0x21a569(0x110),_0x21a569(0x1af)),_0xdd5c97=[];if(_0x577efa)for(const _0x141388 in _0x577efa){const _0x17e8a8=_0x577efa[_0x141388],_0x3e9677=(_0x17e8a8['common']&&typeof _0x17e8a8[_0x21a569(0x192)]['name']===_0x21a569(0x141)?_0x17e8a8[_0x21a569(0x192)][_0x21a569(0x177)]['de']:_0x17e8a8[_0x21a569(0x192)][_0x21a569(0x177)])||_0x17e8a8[_0x21a569(0x192)][_0x21a569(0x177)];_0xdd5c97[_0x21a569(0x100)]({'id':_0x141388,'name':_0x3e9677});}this[_0x21a569(0x1e5)](_0xa70b57[_0x21a569(0x202)],_0xa70b57['command'],{'success':!![],'enums':_0xdd5c97},_0xa70b57[_0x21a569(0x1e9)]);}else{if(_0xa70b57[_0x21a569(0xfb)]===_0x21a569(0x183))try{const _0x49b922=await scanForDevices(this,_0xa70b57[_0x21a569(0x184)]||{});this[_0x21a569(0x1e5)](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':!![],'devices':_0x49b922},_0xa70b57['callback']);}catch(_0x3cb0e6){this[_0x21a569(0x1e5)](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':![],'error':_0x3cb0e6['message']},_0xa70b57['callback']);}else{if(_0xa70b57['command']==='getCalendarNames'){const _0x5b7f5f=_0xa70b57[_0x21a569(0x184)]['instance'];if(!_0x5b7f5f)return this['sendTo'](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':![],'error':'No\x20instance'},_0xa70b57[_0x21a569(0x1e9)]);const _0x501556=await getCalendarNames(this,_0x5b7f5f);this['sendTo'](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':!![],'names':_0x501556},_0xa70b57['callback']);}else{if(_0xa70b57[_0x21a569(0xfb)]===_0x21a569(0x1c5)){const {targetId:_0x51b88c,targetValue:_0x17856b}=_0xa70b57[_0x21a569(0x184)];this[_0x21a569(0x213)]['info'](_0x21a569(0x205)+_0x51b88c+_0x21a569(0x241)+_0x17856b),await this[_0x21a569(0x16c)](_0x21a569(0xde),{'val':!![],'ack':!![]}),await this[_0x21a569(0x16c)](_0x21a569(0x16e),{'val':_0x21a569(0xd0)+_0x51b88c,'ack':!![]}),await this['setStateAsync'](_0x21a569(0x1bb),{'val':_0x51b88c,'ack':!![]}),await this[_0x21a569(0x16c)](_0x21a569(0x236),{'val':_0x17856b,'ack':!![]}),this['sendTo'](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':!![]},_0xa70b57[_0x21a569(0x1e9)]);}else{if(_0xa70b57[_0x21a569(0xfb)]==='submitFeedback'){const {historyId:_0x7c1f14,rating:_0x3e04d9,comment:_0xf38783,alertReason:_0x1b7fc0}=_0xa70b57[_0x21a569(0x184)];_0x7c1f14&&_0x3e04d9?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x7c1f14,'rating':_0x3e04d9,'comment':_0xf38783,'alertReason':_0x1b7fc0}),this[_0x21a569(0x1e5)](_0xa70b57['from'],_0xa70b57[_0x21a569(0xfb)],{'success':!![]},_0xa70b57[_0x21a569(0x1e9)])):this[_0x21a569(0x1e5)](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':![],'error':_0x21a569(0x1ed)},_0xa70b57[_0x21a569(0x1e9)]);}else _0xa70b57[_0x21a569(0xfb)]===_0x21a569(0x1cc)&&(this[_0x21a569(0x213)]['info']('User\x20dismissed\x20automation\x20proposal.'),await this[_0x21a569(0x16c)](_0x21a569(0xde),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x21a569(0x16e),{'val':'','ack':!![]}),this[_0x21a569(0x1e5)](_0xa70b57[_0x21a569(0x202)],_0xa70b57[_0x21a569(0xfb)],{'success':!![]},_0xa70b57[_0x21a569(0x1e9)]));}}}}}}}}}catch(_0x418fb6){this[_0x21a569(0x213)][_0x21a569(0x18d)](_0x21a569(0x1e4)+_0xa70b57['command']+':\x20'+_0x418fb6[_0x21a569(0x184)]);if(_0xa70b57[_0x21a569(0x1e9)])this[_0x21a569(0x1e5)](_0xa70b57['from'],_0xa70b57['command'],{'success':![],'error':_0x418fb6['message']},_0xa70b57[_0x21a569(0x1e9)]);}}}if(require[a0_0x249d00(0xd4)]!==module)module[a0_0x249d00(0xf7)]=_0x5e6f17=>new CogniLiving(_0x5e6f17);else new CogniLiving();