const a0_0x5dda4a=a0_0x4135;(function(_0x1e5c56,_0x4d54af){const _0x23050d=a0_0x4135,_0x1e617a=_0x1e5c56();while(!![]){try{const _0xb86a7=-parseInt(_0x23050d(0x125))/0x1+-parseInt(_0x23050d(0x1a3))/0x2*(parseInt(_0x23050d(0x18f))/0x3)+parseInt(_0x23050d(0x101))/0x4+parseInt(_0x23050d(0x1ae))/0x5*(-parseInt(_0x23050d(0x164))/0x6)+parseInt(_0x23050d(0x148))/0x7+-parseInt(_0x23050d(0x1b7))/0x8+parseInt(_0x23050d(0x17c))/0x9;if(_0xb86a7===_0x4d54af)break;else _0x1e617a['push'](_0x1e617a['shift']());}catch(_0x41d6df){_0x1e617a['push'](_0x1e617a['shift']());}}}(a0_0x5365,0x2f4e0));const a0_0x2ee840=(function(){let _0x46f41a=!![];return function(_0x12fb1e,_0x22a497){const _0x4840b6=_0x46f41a?function(){const _0x222915=a0_0x4135;if(_0x22a497){const _0x17ce6d=_0x22a497[_0x222915(0x1d4)](_0x12fb1e,arguments);return _0x22a497=null,_0x17ce6d;}}:function(){};return _0x46f41a=![],_0x4840b6;};}()),a0_0x3dd154=a0_0x2ee840(this,function(){const _0x2dcbfe=a0_0x4135;return a0_0x3dd154[_0x2dcbfe(0x15d)]()[_0x2dcbfe(0x1cf)]('(((.+)+)+)+$')[_0x2dcbfe(0x15d)]()[_0x2dcbfe(0x11c)](a0_0x3dd154)[_0x2dcbfe(0x1cf)](_0x2dcbfe(0x116));});a0_0x3dd154();function a0_0x4135(_0x35ed94,_0x1863db){const _0x3209c6=a0_0x5365();return a0_0x4135=function(_0x3dd154,_0x2ee840){_0x3dd154=_0x3dd154-0xe9;let _0x536530=_0x3209c6[_0x3dd154];return _0x536530;},a0_0x4135(_0x35ed94,_0x1863db);}'use strict';function a0_0x5365(){const _0x1d65ac=['analysis.triggerBriefing','notifyTelegramEnabled','parse','LTM.triggerDailyDigest','testContext','geminiModel','unload','LTM.dailyDigests','LTM.trainingData.thermodynamics','val','setupDriftAnalysisScheduler','analysisInterval','analysis.training.triggerSecurity','Gemini\x20Init\x20Error:\x20','\x20min\x20ausbleiben.','motion','dismissAutomation','rawEventLog','VACATION','forecast.current.weather','accuweather.0','sonn','automation.triggerAction','getGenerativeModel','./lib/automation','onMessage','TRAIN_HEALTH','exitGraceTimer','Fehler:\x20','checkAndInstall','OPTIMIZE_ENERGY','calendarName','1617861sLYsVw','abs','analysis.automation.description','executeAutomationAction','getHours','bind','analysis.automation.patternDetected','analysis.topology.structure','info','triggerGaitAnalysis','simulateButler','sort','system.mode','minutes_safe','LTM.rawEventLog','onStateChange','checkWifiPresence','getCalendarNames','klar','.communicate.request','callback','toString','command','licenseKey','object','system.presenceWho','getForeignStateAsync','type','227586zRqGWQ','enum.rooms.*','fill','isPresent','common','updateTopology','genAI','currentSystemMode','isSolar','loadSystemMode','./lib/scanner','startSystem','./lib/installer','@google/generative-ai','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','abortExitTimer','getOverviewData','initHistory','isProVersion','apiKey','inactivityThresholdHours','enum.functions.*','Activity-Level','setPresence','5591682IYQOjN','stringify','SYSTEM_MODES','Kein\x20Kalender-Adapter','TRAIN_COMFORT','devices','cogni-living\x20adapter\x20starting\x20(v','Aktiv\x20(','application/json','exitTimer','geminiApiKey','getTime','scanForDevices','minDaysForBaseline','cogni-living','runAutopilot','sendTo','analysisHistory','getForeignObjectsAsync','1635udPGOw','clear','response','./lib/setup','ready','briefingJob','Gemini\x20AI\x20initialized.','analysis.automation.targetValue','timestamp','./lib/recorder','scanThermostats','isGracePeriodActive','Kein\x20API\x20Key\x20Ã¼bergeben','keys','floor','TRAIN_ENERGY','dependencyInstallInProgress','triggerBriefing','getMinutes','sensorLastValues','1076thuXHH','SET_TOPOLOGY','models/gemini-flash-latest','Test','\x20Tage)','communicate.request','Keine\x20Antwort\x20von\x20Gemini','analysis.training.triggerTopology','NORMAL','Sec-Training\x20started...','initSystemConfig','35RdySpq','ltmJob','setupModeResetScheduler','exports','version','toLowerCase','checkSolarCondition','stateChange','sunny','917224cCSZwl','online','sendNotification','system.adapter.','getState','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','entries','.data.table','enum','setupLtmScheduler','eventHistory','push','createAllObjects','pop','SYSTEM_DP_MODE','analysis.training.triggerHealth','setHours','ack','Instanz\x20nicht\x20gefunden','Daten\x20nicht\x20verfÃ¼gbar','ANALYZE_GAIT','runGeminiAnalysis','values','Simulation\x20durch\x20Admin\x20(Test)','search','from','Current.WeatherText','LTM.trainingData.sequences','sendMorningBriefing','apply','updateLocation','runPythonHealthCheck','presenceDevices','slice','modeResetJob','updateHealthVector','calendarInstance','activityLevel','name','triggerDailyDigest','subscribeForeignStatesAsync','getOutsideTemperatureNumeric','checkLicense','find','subscribeStates','initZombies','main','Gesendet','triggerEnergyPrediction','analysis.health.todayVector','forEach','dailyDigests','@iobroker/adapter-core','message','Notification\x20Test\x20Failed:\x20','createDailyDigest','cancel','driftAnalysisTimer','369856VJeFcG','./lib/topology','./lib/scheduler','map','WiFi\x20Presence\x20detected.','analysis.training.triggerComfort','Standard','updateTopologyMatrix','join','analysis.automation.targetId','length','stopService','getStateAsync','analysis.energy.insulationScore','config','NextHours.Location_1.Day_1.current.symbol_desc','.system.mode','namespace','log','add','_calName','(((.+)+)+)+$','includes','telegram','analysis.automation.autoApply','onReady','ANALYZE_TREND','constructor','location','setState','testNotification','getForeignObjectAsync','analysisTimer','temperature','notifyTelegramInstance','debug','77745ixqLDS','setStateAsync','send'];a0_0x5365=function(){return _0x1d65ac;};return a0_0x5365();}const utils=require(a0_0x5dda4a(0xfb)),{GoogleGenerativeAI}=require(a0_0x5dda4a(0x171)),installer=require(a0_0x5dda4a(0x170)),scanner=require(a0_0x5dda4a(0x16e)),schedulers=require(a0_0x5dda4a(0x103)),topology=require(a0_0x5dda4a(0x102)),setup=require(a0_0x5dda4a(0x192)),recorder=require(a0_0x5dda4a(0x198)),pythonBridge=require('./lib/python_bridge'),aiAgent=require('./lib/ai_agent'),deadMan=require('./lib/dead_man'),automation=require(a0_0x5dda4a(0x140)),GEMINI_MODEL=a0_0x5dda4a(0x1a5),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils['Adapter']{constructor(_0x5806e0){const _0x5d3024=a0_0x5dda4a;super({..._0x5806e0,'name':_0x5d3024(0x18a)}),this[_0x5d3024(0x1c1)]=[],this[_0x5d3024(0x18d)]=[],this[_0x5d3024(0x139)]=[],this[_0x5d3024(0xfa)]=[],this[_0x5d3024(0x1a2)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x5d3024(0x167)]=!![],this[_0x5d3024(0x185)]=null,this[_0x5d3024(0x143)]=null,this[_0x5d3024(0x19a)]=![],this[_0x5d3024(0x16a)]=null,this['geminiModel']=null,this[_0x5d3024(0x16b)]=setup['SYSTEM_MODES'][_0x5d3024(0x1ab)],this[_0x5d3024(0x176)]=![],this['lastAlertState']=![],this['analysisTimer']=null,this['ltmJob']=null,this[_0x5d3024(0xe9)]=null,this[_0x5d3024(0x100)]=null,this[_0x5d3024(0x194)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x5d3024(0x193),this['onReady'][_0x5d3024(0x14d)](this)),this['on'](_0x5d3024(0x1b5),this[_0x5d3024(0x157)][_0x5d3024(0x14d)](this)),this['on'](_0x5d3024(0x12e),this['onUnload']['bind'](this)),this['on'](_0x5d3024(0xfc),this[_0x5d3024(0x141)][_0x5d3024(0x14d)](this));}async[a0_0x5dda4a(0x11a)](){const _0x46aa18=a0_0x5dda4a;this[_0x46aa18(0x113)][_0x46aa18(0x150)](_0x46aa18(0x182)+this[_0x46aa18(0x1b2)]+')\x20-\x20Phase\x20C\x20(PINN\x20Neural\x20Core)');if(!installer[_0x46aa18(0x145)](this,()=>this['startSystem']()))return;}async[a0_0x5dda4a(0x16f)](){const _0x525d8a=a0_0x5dda4a;await setup[_0x525d8a(0xf4)](this);try{this[_0x525d8a(0x176)]=await setup[_0x525d8a(0xf1)](this['config'][_0x525d8a(0x15f)]);}catch(_0x48cead){}if(!this['config'][_0x525d8a(0x178)]||this[_0x525d8a(0x10f)][_0x525d8a(0x178)]<0.1)this[_0x525d8a(0x10f)][_0x525d8a(0x178)]=0xc;await setup[_0x525d8a(0x175)](this),await setup[_0x525d8a(0x1ad)](this);if(this[_0x525d8a(0x10f)][_0x525d8a(0x186)])try{this[_0x525d8a(0x16a)]=new GoogleGenerativeAI(this[_0x525d8a(0x10f)]['geminiApiKey']),this[_0x525d8a(0x12d)]=this[_0x525d8a(0x16a)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x525d8a(0x184)}}),this[_0x525d8a(0x113)]['info'](_0x525d8a(0x195));}catch(_0x2c572d){this[_0x525d8a(0x113)]['error'](_0x525d8a(0x135)+_0x2c572d[_0x525d8a(0xfc)]);}await setup[_0x525d8a(0x1c3)](this),await this[_0x525d8a(0x16d)]();try{const _0xab56cd=await this['getStateAsync'](_0x525d8a(0x156));if(_0xab56cd&&_0xab56cd[_0x525d8a(0x131)])this[_0x525d8a(0x139)]=JSON[_0x525d8a(0x12a)](_0xab56cd[_0x525d8a(0x131)]);}catch(_0x2896b1){this[_0x525d8a(0x139)]=[];}try{const _0x6c46b=await this[_0x525d8a(0x10d)](_0x525d8a(0x12f));if(_0x6c46b&&_0x6c46b[_0x525d8a(0x131)])this[_0x525d8a(0xfa)]=JSON[_0x525d8a(0x12a)](_0x6c46b[_0x525d8a(0x131)]);}catch(_0x205db3){this[_0x525d8a(0xfa)]=[];}const _0x12c69c=this[_0x525d8a(0xfa)][_0x525d8a(0x10b)]>=(this[_0x525d8a(0x10f)][_0x525d8a(0x189)]||0x7)?_0x525d8a(0x183)+this[_0x525d8a(0xfa)][_0x525d8a(0x10b)]+_0x525d8a(0x1a7):'Lernphase\x20('+this[_0x525d8a(0xfa)][_0x525d8a(0x10b)]+'/'+(this['config'][_0x525d8a(0x189)]||0x7)+')';await this[_0x525d8a(0x126)]('LTM.baselineStatus',{'val':_0x12c69c,'ack':!![]}),this[_0x525d8a(0xf3)]('analysis.trigger'),this['subscribeStates'](_0x525d8a(0x12b)),this[_0x525d8a(0xf3)](_0x525d8a(0x154)),this[_0x525d8a(0xf3)](_0x525d8a(0x128)),this[_0x525d8a(0xf3)]('analysis.automation.triggerAction'),this[_0x525d8a(0xf3)](_0x525d8a(0x119)),this[_0x525d8a(0xf3)](_0x525d8a(0x134)),this['subscribeStates'](_0x525d8a(0x1c6)),this[_0x525d8a(0xf3)]('analysis.training.triggerEnergy'),this[_0x525d8a(0xf3)](_0x525d8a(0x106)),this[_0x525d8a(0xf3)](_0x525d8a(0x1aa)),this[_0x525d8a(0xf3)]('analysis.energy.mpcActive');const _0xb2b097=this[_0x525d8a(0x10f)][_0x525d8a(0x181)];if(_0xb2b097)for(const _0x2f19c4 of _0xb2b097){await this[_0x525d8a(0xef)](_0x2f19c4['id']);}const _0x37e53e=this[_0x525d8a(0x10f)][_0x525d8a(0x1d7)];if(_0x37e53e)for(const _0x86e928 of _0x37e53e){await this[_0x525d8a(0xef)](_0x86e928);}if(this['config'][_0x525d8a(0x129)]&&this['config'][_0x525d8a(0x123)])await this[_0x525d8a(0xef)](this[_0x525d8a(0x10f)][_0x525d8a(0x123)]+_0x525d8a(0x15b));setTimeout(()=>this[_0x525d8a(0x158)](),0x1388);if(this['analysisTimer'])clearInterval(this[_0x525d8a(0x121)]);const _0x3d8704=this[_0x525d8a(0x10f)][_0x525d8a(0x133)]||0xf;_0x3d8704>0x0&&(this[_0x525d8a(0x121)]=setInterval(()=>{const _0x4d2151=_0x525d8a;this[_0x4d2151(0x18b)]();},_0x3d8704*0x3c*0x3e8)),schedulers[_0x525d8a(0x1c0)](this,()=>aiAgent['createDailyDigest'](this,pythonBridge)),schedulers[_0x525d8a(0x1b0)](this),schedulers[_0x525d8a(0x132)](this,()=>aiAgent['runBaselineDriftAnalysis'](this)),schedulers['setupBriefingScheduler'](this,()=>aiAgent[_0x525d8a(0x1d3)](this)),pythonBridge['startService'](this,installer['PYTHON_EXE']),setTimeout(async()=>{const _0x51a9b1=_0x525d8a;await topology[_0x51a9b1(0x169)](this);try{const _0x5d162f=await this['getStateAsync']('analysis.topology.structure');if(_0x5d162f&&_0x5d162f[_0x51a9b1(0x131)])pythonBridge[_0x51a9b1(0x127)](this,_0x51a9b1(0x1a4),JSON[_0x51a9b1(0x12a)](_0x5d162f[_0x51a9b1(0x131)]));}catch(_0x15906f){}this[_0x51a9b1(0x1d6)](),this[_0x51a9b1(0x151)](),this[_0x51a9b1(0xf7)](),this[_0x51a9b1(0xea)]();},0x1388);}['onUnload'](_0x3bdc54){const _0x9ddc90=a0_0x5dda4a;if(this[_0x9ddc90(0x121)])clearInterval(this['analysisTimer']);if(this[_0x9ddc90(0x100)])clearInterval(this[_0x9ddc90(0x100)]);if(this['ltmJob'])this[_0x9ddc90(0x1af)][_0x9ddc90(0xff)]();if(this[_0x9ddc90(0xe9)])this[_0x9ddc90(0xe9)]['cancel']();if(this['briefingJob'])this['briefingJob'][_0x9ddc90(0xff)]();recorder[_0x9ddc90(0x173)](this),pythonBridge[_0x9ddc90(0x10c)](this),_0x3bdc54();}async['onStateChange'](_0x4def8f,_0x527a39){const _0x5d711d=a0_0x5dda4a;if(!_0x527a39||this[_0x5d711d(0x19f)])return;if(_0x4def8f[_0x5d711d(0x117)](_0x5d711d(0x118))&&_0x4def8f['endsWith'](_0x5d711d(0x1a8))&&_0x527a39[_0x5d711d(0x131)])return;if(_0x4def8f===this[_0x5d711d(0x112)]+_0x5d711d(0x111)){if(_0x527a39[_0x5d711d(0x131)]&&Object[_0x5d711d(0x1cd)](setup[_0x5d711d(0x17e)])[_0x5d711d(0x117)](_0x527a39[_0x5d711d(0x131)])){this['currentSystemMode']=_0x527a39[_0x5d711d(0x131)];if(_0x527a39[_0x5d711d(0x131)]===setup['SYSTEM_MODES'][_0x5d711d(0x13a)])await recorder[_0x5d711d(0x17b)](this,![]);else await recorder[_0x5d711d(0x17b)](this,!![]);}if(!_0x527a39[_0x5d711d(0x1c8)])this[_0x5d711d(0x11e)](_0x4def8f,{'val':this[_0x5d711d(0x16b)],'ack':!![]});return;}if(!_0x527a39[_0x5d711d(0x1c8)]){_0x4def8f['includes']('analysis.trigger')&&_0x527a39['val']&&(this[_0x5d711d(0x11e)](_0x4def8f,{'val':![],'ack':!![]}),aiAgent[_0x5d711d(0x1cc)](this));if(_0x4def8f[_0x5d711d(0x117)](_0x5d711d(0xee))&&_0x527a39['val']){this['setState'](_0x4def8f,{'val':![],'ack':!![]});if(this[_0x5d711d(0x176)])aiAgent[_0x5d711d(0xfe)](this,pythonBridge);}_0x4def8f[_0x5d711d(0x117)](_0x5d711d(0x1a0))&&_0x527a39[_0x5d711d(0x131)]&&(this[_0x5d711d(0x11e)](_0x4def8f,{'val':![],'ack':!![]}),aiAgent[_0x5d711d(0x1d3)](this));_0x4def8f[_0x5d711d(0x117)](_0x5d711d(0x13e))&&_0x527a39['val']&&(this[_0x5d711d(0x11e)](_0x4def8f,{'val':![],'ack':!![]}),aiAgent[_0x5d711d(0x14b)](this));if(_0x4def8f[_0x5d711d(0x117)](_0x5d711d(0x134))&&_0x527a39[_0x5d711d(0x131)]){this['setState'](_0x4def8f,{'val':![],'ack':!![]});if(this[_0x5d711d(0x176)])try{const _0x23c61b=await this[_0x5d711d(0x10d)](_0x5d711d(0x1d2));if(_0x23c61b&&_0x23c61b[_0x5d711d(0x131)]){const _0x1e2c38=JSON['parse'](_0x23c61b[_0x5d711d(0x131)]);this[_0x5d711d(0x126)]('analysis.training.status',{'val':_0x5d711d(0x1ac),'ack':!![]}),pythonBridge[_0x5d711d(0x127)](this,'TRAIN_SECURITY',{'sequences':_0x1e2c38});}}catch(_0x4650a9){}}if(_0x4def8f[_0x5d711d(0x117)]('analysis.training.triggerHealth')&&_0x527a39[_0x5d711d(0x131)]){this['setState'](_0x4def8f,{'val':![],'ack':!![]});if(this[_0x5d711d(0x176)])try{const _0x551797=await this[_0x5d711d(0x10d)](_0x5d711d(0x12f));if(_0x551797&&_0x551797[_0x5d711d(0x131)])pythonBridge[_0x5d711d(0x127)](this,_0x5d711d(0x142),{'digests':JSON[_0x5d711d(0x12a)](_0x551797['val'])});}catch(_0xa1f2ae){}}if(_0x4def8f[_0x5d711d(0x117)]('analysis.training.triggerEnergy')&&_0x527a39[_0x5d711d(0x131)]){this[_0x5d711d(0x11e)](_0x4def8f,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x1791db=await this[_0x5d711d(0x10d)](_0x5d711d(0x130));if(_0x1791db&&_0x1791db[_0x5d711d(0x131)])pythonBridge[_0x5d711d(0x127)](this,_0x5d711d(0x19e),{'points':JSON[_0x5d711d(0x12a)](_0x1791db[_0x5d711d(0x131)])});}catch(_0x4d9708){}}if(_0x4def8f[_0x5d711d(0x117)]('analysis.training.triggerComfort')&&_0x527a39[_0x5d711d(0x131)]){this[_0x5d711d(0x11e)](_0x4def8f,{'val':![],'ack':!![]});if(this[_0x5d711d(0x176)])try{const _0x1abac3=await this[_0x5d711d(0x10d)](_0x5d711d(0x156));if(_0x1abac3&&_0x1abac3[_0x5d711d(0x131)])pythonBridge[_0x5d711d(0x127)](this,_0x5d711d(0x180),{'events':JSON[_0x5d711d(0x12a)](_0x1abac3['val'])});}catch(_0x122159){}}_0x4def8f[_0x5d711d(0x117)](_0x5d711d(0x1aa))&&_0x527a39[_0x5d711d(0x131)]&&(this[_0x5d711d(0x11e)](_0x4def8f,{'val':![],'ack':!![]}),topology[_0x5d711d(0x169)](this));return;}if(this['config'][_0x5d711d(0x1d7)]&&this[_0x5d711d(0x10f)][_0x5d711d(0x1d7)]['includes'](_0x4def8f)){await this[_0x5d711d(0x158)]();return;}const _0x441513=(this[_0x5d711d(0x10f)][_0x5d711d(0x181)]||[])[_0x5d711d(0xf2)](_0x4d06f2=>_0x4d06f2['id']===_0x4def8f);if(_0x441513){const _0x32728b=await recorder['processSensorEvent'](this,_0x4def8f,_0x527a39,_0x441513);_0x32728b&&_0x32728b['type']===_0x5d711d(0x137)&&_0x32728b[_0x5d711d(0x11d)]&&this[_0x5d711d(0x176)]&&deadMan[_0x5d711d(0x1d5)](this,_0x32728b[_0x5d711d(0x11d)]);}}async[a0_0x5dda4a(0x141)](_0x2f5e5b){const _0x73f0b1=a0_0x5dda4a;if(typeof _0x2f5e5b===_0x73f0b1(0x160)&&_0x2f5e5b[_0x73f0b1(0xfc)]){if(_0x2f5e5b['command']==='checkThermostats')try{const _0x4e3918=await automation[_0x73f0b1(0x199)](this);this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b['command'],{'success':!![],'results':_0x4e3918},_0x2f5e5b[_0x73f0b1(0x15c)]);}catch(_0x5db4c7){this['sendTo'](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b['command'],{'success':![],'error':_0x5db4c7[_0x73f0b1(0xfc)]},_0x2f5e5b[_0x73f0b1(0x15c)]);}else{if(_0x2f5e5b[_0x73f0b1(0x15e)]==='simulateEnergyMPC')try{const {current_temps:_0x119c3e,t_out:_0x1ce0a9,targets:_0x1e50d3,t_forecast:_0x28190f}=_0x2f5e5b['message'],_0x112e43=[];let _0x4fa51e={};try{const _0x595e67=await this[_0x73f0b1(0x10d)](_0x73f0b1(0x10e));if(_0x595e67&&_0x595e67[_0x73f0b1(0x131)]){const _0xc84f3e=JSON[_0x73f0b1(0x12a)](_0x595e67['val']);_0x4fa51e=_0xc84f3e['scores']||_0xc84f3e;}}catch(_0x2a9fe4){}const _0x276e05=_0x28190f!==undefined&&_0x28190f!==null?(_0x1ce0a9+_0x28190f)/0x2:_0x1ce0a9;for(const [_0x37ed91,_0x395eef]of Object[_0x73f0b1(0x1bd)](_0x119c3e)){const _0x4ca9d6=_0x1e50d3[_0x37ed91]||0x15;if(_0x395eef<=_0x4ca9d6)continue;let _0x41af15=_0x4fa51e[_0x37ed91]||-0.5;if(_0x41af15>=0x0)_0x41af15=-0.5;const _0x1d664f=Math[_0x73f0b1(0x149)](_0x41af15),_0x387ad5=_0x395eef-_0x4ca9d6;let _0x39f869=Math[_0x73f0b1(0x19d)](_0x387ad5/_0x1d664f*0x3c);const _0x3e14ad=_0x395eef-_0x1ce0a9,_0x48ee9b=_0x395eef-_0x276e05;if(_0x48ee9b!==0x0&&_0x3e14ad!==0x0){const _0x3047e9=_0x3e14ad/_0x48ee9b;_0x39f869=Math[_0x73f0b1(0x19d)](_0x39f869*_0x3047e9);}if(_0x39f869>0xf){if(_0x39f869>0xf0)_0x39f869=0xf0;_0x112e43[_0x73f0b1(0x1c2)]({'room':_0x37ed91,'minutes_safe':_0x39f869,'target':_0x4ca9d6,'current':_0x395eef,'savings_msg':'Heizung\x20kann\x20'+_0x39f869+_0x73f0b1(0x136)});}}_0x112e43['sort']((_0x169672,_0x402ced)=>_0x402ced[_0x73f0b1(0x155)]-_0x169672[_0x73f0b1(0x155)]),this['sendTo'](_0x2f5e5b['from'],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'proposals':_0x112e43},_0x2f5e5b[_0x73f0b1(0x15c)]);}catch(_0x204033){this['sendTo'](_0x2f5e5b['from'],_0x2f5e5b['command'],{'success':![],'error':_0x204033[_0x73f0b1(0xfc)]},_0x2f5e5b[_0x73f0b1(0x15c)]);}else{if(_0x2f5e5b[_0x73f0b1(0x15e)]===_0x73f0b1(0x138))await this[_0x73f0b1(0x126)](_0x73f0b1(0x14e),{'val':![],'ack':!![]}),await this[_0x73f0b1(0x126)](_0x73f0b1(0x14a),{'val':'','ack':!![]}),await this[_0x73f0b1(0x126)](_0x73f0b1(0x10a),{'val':'','ack':!![]}),this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b['command'],{'success':!![]},_0x2f5e5b[_0x73f0b1(0x15c)]);else{if(_0x2f5e5b[_0x73f0b1(0x15e)]===_0x73f0b1(0x152)){const {targetId:_0x1c3179,targetValue:_0x451ce5}=_0x2f5e5b['message'];await this[_0x73f0b1(0x126)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x73f0b1(0x126)](_0x73f0b1(0x14a),{'val':_0x73f0b1(0x1ce),'ack':!![]}),await this[_0x73f0b1(0x126)](_0x73f0b1(0x10a),{'val':_0x1c3179,'ack':!![]}),await this[_0x73f0b1(0x126)](_0x73f0b1(0x196),{'val':String(_0x451ce5),'ack':!![]}),this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b['command'],{'success':!![]},_0x2f5e5b[_0x73f0b1(0x15c)]);}else{if(_0x2f5e5b[_0x73f0b1(0x15e)]==='testApiKey')try{const _0x192fd6=_0x2f5e5b[_0x73f0b1(0xfc)][_0x73f0b1(0x177)];if(!_0x192fd6)throw new Error(_0x73f0b1(0x19b));const _0x5853fa=new GoogleGenerativeAI(_0x192fd6),_0x5b0236=_0x5853fa[_0x73f0b1(0x13f)]({'model':GEMINI_MODEL}),_0x71ac9c=await _0x5b0236['generateContent'](_0x73f0b1(0x1a6)),_0x135865=await _0x71ac9c[_0x73f0b1(0x191)];if(_0x135865['text']())this['sendTo'](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'message':'Verbindung\x20erfolgreich!'},_0x2f5e5b['callback']);else throw new Error(_0x73f0b1(0x1a9));}catch(_0x42ad86){this['sendTo'](_0x2f5e5b['from'],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':![],'message':_0x42ad86[_0x73f0b1(0xfc)]},_0x2f5e5b['callback']);}else{if(_0x2f5e5b[_0x73f0b1(0x15e)]==='scanDevices')try{const _0x39e2a4=await scanner[_0x73f0b1(0x188)](this,_0x2f5e5b[_0x73f0b1(0xfc)]||{});this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'devices':_0x39e2a4},_0x2f5e5b[_0x73f0b1(0x15c)]);}catch(_0x161ac5){this['sendTo'](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':![],'error':_0x161ac5['message']},_0x2f5e5b[_0x73f0b1(0x15c)]);}else{if(_0x2f5e5b[_0x73f0b1(0x15e)]===_0x73f0b1(0x108))try{const {matrix:_0x532725}=_0x2f5e5b[_0x73f0b1(0xfc)],_0x13476d=await this[_0x73f0b1(0x10d)]('analysis.topology.structure');if(_0x13476d&&_0x13476d[_0x73f0b1(0x131)]){const _0x2b6bb4=JSON[_0x73f0b1(0x12a)](_0x13476d[_0x73f0b1(0x131)]);_0x2b6bb4['matrix']=_0x532725,_0x2b6bb4['updated']=Date['now'](),await this[_0x73f0b1(0x126)](_0x73f0b1(0x14f),{'val':JSON['stringify'](_0x2b6bb4),'ack':!![]}),pythonBridge[_0x73f0b1(0x127)](this,_0x73f0b1(0x1a4),_0x2b6bb4);}this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![]},_0x2f5e5b[_0x73f0b1(0x15c)]);}catch(_0x202105){this[_0x73f0b1(0x113)]['error'](_0x202105);}else{if(_0x2f5e5b[_0x73f0b1(0x15e)]==='getLtmData')this['sendTo'](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'dailyDigests':this[_0x73f0b1(0xfa)]||[],'analysisHistory':this[_0x73f0b1(0x18d)]||[]},_0x2f5e5b[_0x73f0b1(0x15c)]);else{if(_0x2f5e5b[_0x73f0b1(0x15e)]===_0x73f0b1(0x174)){const _0x90f9c7=this[_0x73f0b1(0xfa)][_0x73f0b1(0x10b)],_0x25b36e=new Array(0x18)[_0x73f0b1(0x166)](0x0),_0x1353be=new Date()[_0x73f0b1(0x1c7)](0x0,0x0,0x0,0x0);this[_0x73f0b1(0x1c1)]&&this['eventHistory']['forEach'](_0x3b1ee6=>{const _0xcfcc14=_0x73f0b1;if(_0x3b1ee6['timestamp']>=_0x1353be){const _0x5c8498=new Date(_0x3b1ee6[_0xcfcc14(0x197)])[_0xcfcc14(0x14c)]();if(_0x5c8498>=0x0&&_0x5c8498<0x18)_0x25b36e[_0x5c8498]++;}});let _0x2f0214=![],_0x43b137='',_0x2a3150='',_0x3b78e3='';try{const _0x546cb3=await this[_0x73f0b1(0x10d)]('analysis.automation.patternDetected');if(_0x546cb3&&_0x546cb3[_0x73f0b1(0x131)]){_0x2f0214=!![];const _0x58f774=await this[_0x73f0b1(0x10d)](_0x73f0b1(0x14a));_0x43b137=_0x58f774?_0x58f774[_0x73f0b1(0x131)]:'';const _0x5da95b=await this[_0x73f0b1(0x10d)](_0x73f0b1(0x10a));_0x2a3150=_0x5da95b?_0x5da95b[_0x73f0b1(0x131)]:'';const _0xceb4e7=await this[_0x73f0b1(0x10d)](_0x73f0b1(0x196));_0x3b78e3=_0xceb4e7?_0xceb4e7[_0x73f0b1(0x131)]:'';}}catch(_0x27ff61){}const _0x466160=await this[_0x73f0b1(0x1b4)](),_0xfdcaf4=(this[_0x73f0b1(0x10f)][_0x73f0b1(0x181)]||[])['some'](_0x446bec=>_0x446bec[_0x73f0b1(0x16c)]),_0x293bc4=_0x466160&&_0xfdcaf4;this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'eventHistory':this[_0x73f0b1(0x1c1)][_0x73f0b1(0x1d8)](0x0,0xf),'stats':{'digestCount':_0x90f9c7,'isPresent':this[_0x73f0b1(0x167)],'hourlyActivity':_0x25b36e,'solarActive':_0x293bc4},'automation':{'detected':_0x2f0214,'description':_0x43b137,'targetId':_0x2a3150,'targetValue':_0x3b78e3}},_0x2f5e5b[_0x73f0b1(0x15c)]);}else{if(_0x2f5e5b['command']==='getEnums'){const _0x2e1358=await this['getForeignObjectsAsync'](_0x73f0b1(0x179),_0x73f0b1(0x1bf)),_0x1dcc51=[];if(_0x2e1358)for(const _0x172ac6 in _0x2e1358){const _0x3d34cb=_0x2e1358[_0x172ac6],_0x13cc16=(_0x3d34cb[_0x73f0b1(0x168)]&&typeof _0x3d34cb[_0x73f0b1(0x168)][_0x73f0b1(0xed)]==='object'?_0x3d34cb[_0x73f0b1(0x168)]['name']['de']:_0x3d34cb['common'][_0x73f0b1(0xed)])||_0x3d34cb[_0x73f0b1(0x168)]['name'];_0x1dcc51[_0x73f0b1(0x1c2)]({'id':_0x172ac6,'name':_0x13cc16});}const _0x4ae49c=await this[_0x73f0b1(0x18e)](_0x73f0b1(0x165),_0x73f0b1(0x1bf)),_0x4dd596=[];if(_0x4ae49c)for(const _0x1e1b09 in _0x4ae49c){const _0x3d0bd4=_0x4ae49c[_0x1e1b09],_0x37695b=(_0x3d0bd4['common']&&typeof _0x3d0bd4[_0x73f0b1(0x168)][_0x73f0b1(0xed)]===_0x73f0b1(0x160)?_0x3d0bd4[_0x73f0b1(0x168)]['name']['de']:_0x3d0bd4[_0x73f0b1(0x168)][_0x73f0b1(0xed)])||_0x1e1b09['split']('.')[_0x73f0b1(0x1c4)]();_0x4dd596[_0x73f0b1(0x1c2)](_0x37695b);}this[_0x73f0b1(0x18c)](_0x2f5e5b['from'],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'enums':_0x1dcc51,'rooms':_0x4dd596},_0x2f5e5b['callback']);}else{if(_0x2f5e5b['command']===_0x73f0b1(0x12c))try{let _0x217ee9='Kein\x20Wetter-Adapter',_0x2feae6=_0x73f0b1(0x17f);if(this['config']['weatherInstance']){const _0x260e26=await recorder[_0x73f0b1(0xf0)](this);_0x217ee9=_0x260e26!==null?_0x260e26+'Â°C':_0x73f0b1(0x1ca);}if(this['config'][_0x73f0b1(0xeb)]){const _0x4a1dcf=await this[_0x73f0b1(0x120)](_0x73f0b1(0x1ba)+this[_0x73f0b1(0x10f)]['calendarInstance']);_0x2feae6=_0x4a1dcf?'Verbunden':_0x73f0b1(0x1c9);}this['sendTo'](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'weather':_0x217ee9,'calendar':_0x2feae6},_0x2f5e5b[_0x73f0b1(0x15c)]);}catch(_0x1fe0ff){this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':![],'error':_0x1fe0ff[_0x73f0b1(0xfc)]},_0x2f5e5b[_0x73f0b1(0x15c)]);}else{if(_0x2f5e5b['command']===_0x73f0b1(0x159))try{const _0x284c49=_0x2f5e5b[_0x73f0b1(0xfc)]['instance'],_0x26cf1e=await this['getForeignStateAsync'](_0x284c49+_0x73f0b1(0x1be));let _0x4a2cd4=[];if(_0x26cf1e&&_0x26cf1e[_0x73f0b1(0x131)]){const _0x4b2950=JSON[_0x73f0b1(0x12a)](_0x26cf1e[_0x73f0b1(0x131)]),_0x4d6587=new Set();Array['isArray'](_0x4b2950)&&_0x4b2950[_0x73f0b1(0xf9)](_0xacf061=>{const _0x20f929=_0x73f0b1;if(_0xacf061[_0x20f929(0x115)])_0x4d6587[_0x20f929(0x114)](_0xacf061[_0x20f929(0x115)]);else{if(_0xacf061[_0x20f929(0x147)])_0x4d6587[_0x20f929(0x114)](_0xacf061[_0x20f929(0x147)]);}}),_0x4a2cd4=Array[_0x73f0b1(0x1d0)](_0x4d6587)[_0x73f0b1(0x153)]();}if(_0x4a2cd4[_0x73f0b1(0x10b)]===0x0)_0x4a2cd4=[_0x73f0b1(0x107)];this['sendTo'](_0x2f5e5b['from'],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'names':_0x4a2cd4},_0x2f5e5b[_0x73f0b1(0x15c)]);}catch(_0x457628){this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b['command'],{'success':![],'error':_0x457628[_0x73f0b1(0xfc)]},_0x2f5e5b[_0x73f0b1(0x15c)]);}else{if(_0x2f5e5b[_0x73f0b1(0x15e)]===_0x73f0b1(0x11f))try{await setup[_0x73f0b1(0x1b9)](this,_0x73f0b1(0x1bc),![],![]),this['sendTo'](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':!![],'message':_0x73f0b1(0xf6)},_0x2f5e5b[_0x73f0b1(0x15c)]);}catch(_0x39257a){this[_0x73f0b1(0x113)]['error'](_0x73f0b1(0xfd)+_0x39257a[_0x73f0b1(0xfc)]),this[_0x73f0b1(0x18c)](_0x2f5e5b[_0x73f0b1(0x1d0)],_0x2f5e5b[_0x73f0b1(0x15e)],{'success':![],'message':_0x73f0b1(0x144)+_0x39257a[_0x73f0b1(0xfc)]},_0x2f5e5b[_0x73f0b1(0x15c)]);}}}}}}}}}}}}}}}async[a0_0x5dda4a(0x16d)](){const _0x1b5b0d=a0_0x5dda4a;try{const _0x203ed4=await this[_0x1b5b0d(0x10d)](setup[_0x1b5b0d(0x1c5)]);_0x203ed4&&_0x203ed4[_0x1b5b0d(0x131)]&&Object[_0x1b5b0d(0x1cd)](setup[_0x1b5b0d(0x17e)])[_0x1b5b0d(0x117)](_0x203ed4['val'])?this[_0x1b5b0d(0x16b)]=_0x203ed4[_0x1b5b0d(0x131)]:(this['currentSystemMode']=setup['SYSTEM_MODES'][_0x1b5b0d(0x1ab)],await this[_0x1b5b0d(0x126)](setup[_0x1b5b0d(0x1c5)],{'val':setup[_0x1b5b0d(0x17e)][_0x1b5b0d(0x1ab)],'ack':!![]}));}catch(_0x34de1c){this['currentSystemMode']=setup[_0x1b5b0d(0x17e)][_0x1b5b0d(0x1ab)];}}async[a0_0x5dda4a(0x158)](){const _0x97432e=a0_0x5dda4a;try{const _0x1e9904=this[_0x97432e(0x10f)][_0x97432e(0x1d7)]||[];let _0x23cb7f=![];const _0x329f20=[];for(const _0x54b268 of _0x1e9904){try{const _0x55621f=await this[_0x97432e(0x162)](_0x54b268);_0x55621f&&(_0x55621f['val']===!![]||_0x55621f[_0x97432e(0x131)]===_0x97432e(0x1b8)||_0x55621f['val']===0x1)&&(_0x23cb7f=!![],_0x329f20[_0x97432e(0x1c2)](_0x54b268));}catch(_0x336ed5){}}return await this[_0x97432e(0x126)](_0x97432e(0x161),{'val':_0x329f20[_0x97432e(0x109)](',\x20'),'ack':!![]}),_0x23cb7f&&(this[_0x97432e(0x185)]&&(this[_0x97432e(0x113)][_0x97432e(0x150)](_0x97432e(0x105)),recorder['abortExitTimer'](this)),!this[_0x97432e(0x167)]&&this[_0x97432e(0x16b)]===setup['SYSTEM_MODES'][_0x97432e(0x1ab)]&&await recorder[_0x97432e(0x17b)](this,!![])),_0x23cb7f;}catch(_0x17b7cc){return![];}}async['runAutopilot'](){const _0x7928f3=a0_0x5dda4a;this[_0x7928f3(0x113)][_0x7928f3(0x124)](_0x7928f3(0x172)),await aiAgent[_0x7928f3(0x1cc)](this),this[_0x7928f3(0xea)](),this[_0x7928f3(0x151)](),this[_0x7928f3(0xf7)]();}async[a0_0x5dda4a(0x1b4)](){const _0xc6b83b=a0_0x5dda4a,_0x33f713=['weatherunderground.0',_0xc6b83b(0x13c),'daswetter.0'],_0x2918e2=[_0xc6b83b(0x13b),_0xc6b83b(0x1d1),_0xc6b83b(0x110)];for(const _0xf822a8 of _0x33f713){for(const _0x6479d3 of _0x2918e2){try{const _0x18ae6b=_0xf822a8+'.'+_0x6479d3,_0x51afef=await this[_0xc6b83b(0x162)](_0x18ae6b);if(_0x51afef&&_0x51afef[_0xc6b83b(0x131)]){const _0x2a001b=String(_0x51afef[_0xc6b83b(0x131)])[_0xc6b83b(0x1b3)]();if(_0x2a001b['includes'](_0xc6b83b(0x13d))||_0x2a001b[_0xc6b83b(0x117)](_0xc6b83b(0x1b6))||_0x2a001b[_0xc6b83b(0x117)](_0xc6b83b(0x15a))||_0x2a001b['includes'](_0xc6b83b(0x190))||_0x2a001b[_0xc6b83b(0x117)]('heiter'))return!![];}}catch(_0x1bddc2){}}}return![];}[a0_0x5dda4a(0x151)](){const _0x276b77=a0_0x5dda4a;if(!this[_0x276b77(0x176)])return;try{this[_0x276b77(0x1bb)](_0x276b77(0x1d2),(_0x54f4d1,_0x2830cb)=>{const _0x4d3f21=_0x276b77;_0x2830cb&&_0x2830cb['val']&&pythonBridge[_0x4d3f21(0x127)](this,_0x4d3f21(0x1cb),{'sequences':JSON[_0x4d3f21(0x12a)](_0x2830cb['val'])});});}catch(_0x22d9e6){}}async[a0_0x5dda4a(0xf7)](){const _0x473f3d=a0_0x5dda4a;if(!this[_0x473f3d(0x176)])return;try{const _0x40f467=await recorder['getOutsideTemperatureNumeric'](this);if(_0x40f467===null)return;const _0x4cb034={},_0x3be445={},_0x528b79=this[_0x473f3d(0x10f)]['devices']||[];for(const _0x2225f5 of _0x528b79){if(_0x2225f5[_0x473f3d(0x163)]===_0x473f3d(0x122)&&_0x2225f5[_0x473f3d(0x11d)]){const _0xeec7d4=this[_0x473f3d(0x1a2)][_0x2225f5['id']];if(_0xeec7d4!==undefined)_0x4cb034[_0x2225f5['location']]=_0xeec7d4;if(_0x2225f5[_0x473f3d(0x16c)])_0x3be445[_0x2225f5[_0x473f3d(0x11d)]]=!![];}}const _0x4461f1=await this[_0x473f3d(0x1b4)]();Object[_0x473f3d(0x19c)](_0x4cb034)[_0x473f3d(0x10b)]>0x0&&(pythonBridge[_0x473f3d(0x127)](this,'PREDICT_ENERGY',{'current_temps':_0x4cb034,'t_out':_0x40f467,'is_sunny':_0x4461f1,'solar_flags':_0x3be445}),pythonBridge[_0x473f3d(0x127)](this,_0x473f3d(0x146),{'current_temps':_0x4cb034,'t_out':_0x40f467,'targets':{}}));}catch(_0x1eb92d){}}[a0_0x5dda4a(0xea)](){const _0x4a3e18=a0_0x5dda4a;if(!this[_0x4a3e18(0x139)]||this[_0x4a3e18(0x139)][_0x4a3e18(0x10b)]===0x0)return;const _0x14e7d6=new Array(0x60)[_0x4a3e18(0x166)](0x0),_0x200952=new Date()[_0x4a3e18(0x1c7)](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x4a3e18(0xf9)](_0x399fd5=>{const _0x5b3c46=_0x4a3e18,_0x351e9b=new Date(_0x399fd5[_0x5b3c46(0x197)]);if(_0x351e9b[_0x5b3c46(0x187)]()>=_0x200952){const _0x54d252=_0x351e9b['getHours'](),_0x1cd70a=_0x351e9b[_0x5b3c46(0x1a1)](),_0x42aa06=_0x54d252*0x4+Math[_0x5b3c46(0x19d)](_0x1cd70a/0xf);if(_0x42aa06>=0x0&&_0x42aa06<0x60)_0x14e7d6[_0x42aa06]++;}}),this[_0x4a3e18(0x126)](_0x4a3e18(0xf8),{'val':JSON[_0x4a3e18(0x17d)](_0x14e7d6),'ack':!![]});}[a0_0x5dda4a(0x1d6)](){const _0x371961=a0_0x5dda4a;if(!this[_0x371961(0xfa)]||this['dailyDigests']['length']<0x2)return;const _0x3d57f1=this[_0x371961(0xfa)][_0x371961(0x104)](_0x5f4655=>{const _0x5d5dd5=_0x371961,_0x11066a=(_0x5f4655[_0x5d5dd5(0xec)]||'')[_0x5d5dd5(0x1b3)]();return ACTIVITY_LEVEL_MAP[_0x11066a]||0x32;});pythonBridge[_0x371961(0x127)](this,_0x371961(0x11b),{'values':_0x3d57f1,'tag':_0x371961(0x17a)});}}if(require[a0_0x5dda4a(0xf5)]!==module)module[a0_0x5dda4a(0x1b1)]=_0xc07a31=>new CogniLiving(_0xc07a31);else new CogniLiving();