const a0_0x404310=a0_0x5337;(function(_0x18dedc,_0x39a186){const _0x3799b1=a0_0x5337,_0x44b17f=_0x18dedc();while(!![]){try{const _0x459731=-parseInt(_0x3799b1(0x380))/0x1*(-parseInt(_0x3799b1(0x1c0))/0x2)+-parseInt(_0x3799b1(0x370))/0x3+-parseInt(_0x3799b1(0x315))/0x4*(-parseInt(_0x3799b1(0x28f))/0x5)+-parseInt(_0x3799b1(0x326))/0x6+-parseInt(_0x3799b1(0x1df))/0x7+-parseInt(_0x3799b1(0x24e))/0x8+parseInt(_0x3799b1(0x24b))/0x9*(parseInt(_0x3799b1(0x2f2))/0xa);if(_0x459731===_0x39a186)break;else _0x44b17f['push'](_0x44b17f['shift']());}catch(_0x59ee4d){_0x44b17f['push'](_0x44b17f['shift']());}}}(a0_0x3440,0x2bd0f));const a0_0x1e07b4=(function(){let _0x172d6c=!![];return function(_0x4459aa,_0x1fa28d){const _0x443465=_0x172d6c?function(){const _0x49f792=a0_0x5337;if(_0x1fa28d){const _0x181bf8=_0x1fa28d[_0x49f792(0x1b2)](_0x4459aa,arguments);return _0x1fa28d=null,_0x181bf8;}}:function(){};return _0x172d6c=![],_0x443465;};}()),a0_0x5b91f7=a0_0x1e07b4(this,function(){const _0x355080=a0_0x5337;return a0_0x5b91f7['toString']()[_0x355080(0x33d)]('(((.+)+)+)+$')[_0x355080(0x22b)]()[_0x355080(0x2fb)](a0_0x5b91f7)[_0x355080(0x33d)](_0x355080(0x30d));});a0_0x5b91f7();'use strict';const utils=require(a0_0x404310(0x25d)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x404310(0x2ee)),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x404310(0x27d),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',LTM_DP_RAW_LOG=a0_0x404310(0x1f1),LTM_DP_DAILY_DIGESTS=a0_0x404310(0x273),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x404310(0x369),LTM_DP_BASELINE_STATUS=a0_0x404310(0x251),LTM_DP_DRIFT_CHANNEL=a0_0x404310(0x300),LTM_DP_DRIFT_STATUS=a0_0x404310(0x352),LTM_DP_DRIFT_DETAILS=a0_0x404310(0x376),LTM_DP_DRIFT_LAST_CHECK=a0_0x404310(0x2f0),SYSTEM_DP_MODE=a0_0x404310(0x1e2),SYSTEM_MODES={'NORMAL':a0_0x404310(0x215),'VACATION':'vacation','PARTY':'party','GUEST':a0_0x404310(0x2f1)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x404310(0x392)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x404310(0x353),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','family':a0_0x404310(0x2c7),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':'PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.'};class CogniLiving extends utils[a0_0x404310(0x290)]{constructor(_0x5cc2f1){const _0x5e99f8=a0_0x404310;super({..._0x5cc2f1,'name':'cogni-living'}),this['eventHistory']=[],this[_0x5e99f8(0x33f)]=[],this['feedbackHistory']=[],this[_0x5e99f8(0x2e0)]=[],this[_0x5e99f8(0x229)]=[],this[_0x5e99f8(0x360)]={},this[_0x5e99f8(0x373)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x5e99f8(0x27e)]=![],this[_0x5e99f8(0x275)]=null,this['geminiModel']=null,this[_0x5e99f8(0x365)]=SYSTEM_MODES[_0x5e99f8(0x288)],this[_0x5e99f8(0x351)]=![],this['lastAlertState']=![],this[_0x5e99f8(0x36b)]='unknown',this['analysisTimer']=null,this['ltmJob']=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this['briefingJob']=null,this['on'](_0x5e99f8(0x23e),this['onReady'][_0x5e99f8(0x332)](this)),this['on'](_0x5e99f8(0x2cc),this[_0x5e99f8(0x2f6)][_0x5e99f8(0x332)](this)),this['on']('unload',this[_0x5e99f8(0x2d7)][_0x5e99f8(0x332)](this)),this['on'](_0x5e99f8(0x2b7),this[_0x5e99f8(0x25c)][_0x5e99f8(0x332)](this));}async['onReady'](){const _0x1429a9=a0_0x404310;this[_0x1429a9(0x1bc)]['info'](_0x1429a9(0x20d)+this[_0x1429a9(0x337)]+')');const _0xf131bc=[_0x1429a9(0x2af),'analysis.history_debug_01','analysis.history_debug_02','analysis.history_debug_03','analysis.history_debug_04',_0x1429a9(0x36f),_0x1429a9(0x25b),'events.history_debug_02',_0x1429a9(0x216),_0x1429a9(0x271)];for(const _0x15d9f0 of _0xf131bc){try{const _0x196f2a=await this[_0x1429a9(0x2c3)](_0x15d9f0);_0x196f2a&&await this[_0x1429a9(0x1c9)](_0x15d9f0);}catch(_0x70aa77){}}this['config'][_0x1429a9(0x378)]=this[_0x1429a9(0x1d8)][_0x1429a9(0x378)]||'',this[_0x1429a9(0x351)]=await this[_0x1429a9(0x1e3)](this[_0x1429a9(0x1d8)][_0x1429a9(0x378)]);if(!this[_0x1429a9(0x1d8)][_0x1429a9(0x34c)]||this['config'][_0x1429a9(0x34c)]<0.1)this[_0x1429a9(0x1d8)]['inactivityThresholdHours']=0xc;await this[_0x1429a9(0x1ff)]();try{const _0x2561e3=await this[_0x1429a9(0x2ce)]('system.config');_0x2561e3&&_0x2561e3['common']&&(this[_0x1429a9(0x373)]={'latitude':_0x2561e3[_0x1429a9(0x231)]['latitude']||0x0,'longitude':_0x2561e3[_0x1429a9(0x231)][_0x1429a9(0x1bd)]||0x0,'city':_0x2561e3['common'][_0x1429a9(0x35b)]||''});}catch(_0x464f0e){}if(this['config'][_0x1429a9(0x34b)])try{this[_0x1429a9(0x275)]=new GoogleGenerativeAI(this[_0x1429a9(0x1d8)]['geminiApiKey']),this['geminiModel']=this['genAI'][_0x1429a9(0x2db)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x1429a9(0x359)}}),this['log'][_0x1429a9(0x2b1)](_0x1429a9(0x325));}catch(_0x16597b){this[_0x1429a9(0x1bc)][_0x1429a9(0x372)](_0x1429a9(0x260)+_0x16597b[_0x1429a9(0x2b7)]);}await this['createAllObjects'](),await this[_0x1429a9(0x1f0)](),await this[_0x1429a9(0x323)](),await this[_0x1429a9(0x2cd)](),this[_0x1429a9(0x21f)](_0x1429a9(0x340)),this[_0x1429a9(0x21f)](LTM_DP_TRIGGER_DIGEST),this[_0x1429a9(0x21f)](_0x1429a9(0x1e2)),this[_0x1429a9(0x21f)](_0x1429a9(0x2f7));const _0x28d154=this[_0x1429a9(0x1d8)][_0x1429a9(0x28a)];if(_0x28d154&&_0x28d154['length']>0x0){this[_0x1429a9(0x1bc)][_0x1429a9(0x2b1)](_0x1429a9(0x343)+_0x28d154[_0x1429a9(0x2fa)]+_0x1429a9(0x1fe));for(const _0x306850 of _0x28d154){if(_0x306850['id']){await this[_0x1429a9(0x1d4)](_0x306850['id']);try{const _0x55c8bf=await this[_0x1429a9(0x222)](_0x306850['id']);if(_0x55c8bf)this[_0x1429a9(0x360)][_0x306850['id']]=_0x55c8bf[_0x1429a9(0x341)];}catch(_0x394553){}}}}const _0x40fa6a=this[_0x1429a9(0x1d8)][_0x1429a9(0x1d0)]||[];if(_0x40fa6a[_0x1429a9(0x2fa)]>0x0){this[_0x1429a9(0x1bc)][_0x1429a9(0x2b1)](_0x1429a9(0x343)+_0x40fa6a[_0x1429a9(0x2fa)]+_0x1429a9(0x235));for(const _0x265a16 of _0x40fa6a){await this[_0x1429a9(0x1d4)](_0x265a16);}await this['checkWifiPresence']();}if(this[_0x1429a9(0x270)])clearInterval(this[_0x1429a9(0x270)]);const _0x553913=this['config'][_0x1429a9(0x2c5)]||0xf;_0x553913>0x0&&(this[_0x1429a9(0x1bc)][_0x1429a9(0x2b1)](_0x1429a9(0x2cb)+_0x553913+_0x1429a9(0x354)+this['config'][_0x1429a9(0x34c)]+'h.'),this[_0x1429a9(0x270)]=setInterval(()=>this[_0x1429a9(0x329)](),_0x553913*0x3c*0x3e8)),this[_0x1429a9(0x322)](),this[_0x1429a9(0x30e)](),this[_0x1429a9(0x2bc)](),this['setupBriefingScheduler']();}async[a0_0x404310(0x339)](){const _0xb8a980=a0_0x404310;if(!this['config'][_0xb8a980(0x304)])return'';let _0x146e72='';if(this[_0xb8a980(0x1d8)][_0xb8a980(0x2e9)])try{if(this['config']['weatherInstance'][_0xb8a980(0x291)](_0xb8a980(0x1cc))){const _0x1296f5=await this['getForeignStateAsync'](this['config'][_0xb8a980(0x2e9)]+_0xb8a980(0x307));if(_0x1296f5&&_0x1296f5['val'])_0x146e72=_0x1296f5[_0xb8a980(0x341)];}else{if(this[_0xb8a980(0x1d8)][_0xb8a980(0x2e9)]['includes'](_0xb8a980(0x301))){const _0x55e059=await this['getForeignStateAsync'](this[_0xb8a980(0x1d8)]['weatherInstance']+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0x55e059&&_0x55e059[_0xb8a980(0x341)])_0x146e72=_0x55e059[_0xb8a980(0x341)];}else{if(this[_0xb8a980(0x1d8)][_0xb8a980(0x2e9)][_0xb8a980(0x291)](_0xb8a980(0x285))){const _0x42b209=await this[_0xb8a980(0x222)](this['config']['weatherInstance']+_0xb8a980(0x1db));if(_0x42b209&&_0x42b209[_0xb8a980(0x341)])_0x146e72=_0x42b209[_0xb8a980(0x341)];}}}}catch(_0x3ad934){}if(!_0x146e72){const _0x6a596a=[_0xb8a980(0x1e7),'daswetter.0',_0xb8a980(0x282),_0xb8a980(0x2b6)];for(const _0xf7bfc6 of _0x6a596a){try{const _0x557d26=await this[_0xb8a980(0x2ce)](_0xf7bfc6);if(_0x557d26){if(_0xf7bfc6['includes'](_0xb8a980(0x1cc))){const _0x37dc03=await this['getForeignStateAsync'](_0xf7bfc6+_0xb8a980(0x307));if(_0x37dc03){_0x146e72=_0x37dc03[_0xb8a980(0x341)];break;}}}}catch(_0x109d7c){}}}return _0x146e72?'WETTER\x20(Drau√üen):\x20'+_0x146e72:_0xb8a980(0x2d4);}async[a0_0x404310(0x1b9)](){const _0x19d95a=a0_0x404310;if(!this[_0x19d95a(0x1d8)][_0x19d95a(0x320)])return'';let _0x185cd2='',_0x400261=this[_0x19d95a(0x1d8)][_0x19d95a(0x2f9)]||_0x19d95a(0x21d);try{const _0x2d34a6=await this[_0x19d95a(0x222)](_0x400261+_0x19d95a(0x2fd));if(_0x2d34a6&&_0x2d34a6['val'])_0x185cd2=_0x2d34a6['val'];else{const _0x277a7b=await this[_0x19d95a(0x222)](_0x400261+_0x19d95a(0x38f));_0x277a7b&&_0x277a7b['val']&&Array['isArray'](_0x277a7b['val'])&&_0x277a7b['val']['length']>0x0&&(_0x185cd2=_0x277a7b['val']['slice'](0x0,0x3)[_0x19d95a(0x381)](_0x1c21b9=>_0x1c21b9[_0x19d95a(0x20e)]+'\x20'+_0x1c21b9[_0x19d95a(0x2ae)])[_0x19d95a(0x37c)](',\x20'));}}catch(_0xdb43bf){}return _0x185cd2?_0x19d95a(0x2a0)+_0x185cd2:_0x19d95a(0x362);}async[a0_0x404310(0x1af)](_0x4a6025={}){const _0x42fbf0=a0_0x404310;this[_0x42fbf0(0x1bc)][_0x42fbf0(0x2b1)](_0x42fbf0(0x37e)+JSON[_0x42fbf0(0x29f)](_0x4a6025));const _0x5066ac=[],_0x41eab9=_0x4a6025[_0x42fbf0(0x32d)]!==![],_0x146d88=_0x4a6025['doors']!==![],_0x5be59b=_0x4a6025[_0x42fbf0(0x312)]!==![],_0x69cbd4=_0x4a6025[_0x42fbf0(0x368)]===!![],_0x5731fa=_0x4a6025[_0x42fbf0(0x1c5)]===!![],_0x39b4f5=_0x4a6025[_0x42fbf0(0x37f)]||[],_0xcf8c75=await this['getForeignObjectsAsync'](_0x42fbf0(0x1da),_0x42fbf0(0x1f6)),_0x5c83d6=await this['getForeignObjectsAsync'](_0x42fbf0(0x364),_0x42fbf0(0x1f6)),_0x340da5={},_0x215149={},_0x5d77e1={},_0x286325=(_0x72afb,_0x3e1de1,_0xec605d=![])=>{const _0x5a7901=_0x42fbf0;if(!_0x72afb)return;for(const _0x494b06 in _0x72afb){const _0x42c3c5=_0x72afb[_0x494b06];if(_0x42c3c5&&_0x42c3c5[_0x5a7901(0x231)]&&_0x42c3c5['common'][_0x5a7901(0x346)]){const _0x57eda4=(typeof _0x42c3c5[_0x5a7901(0x231)][_0x5a7901(0x2e3)]===_0x5a7901(0x26e)?_0x42c3c5[_0x5a7901(0x231)][_0x5a7901(0x2e3)]['de']:_0x42c3c5[_0x5a7901(0x231)][_0x5a7901(0x2e3)])||_0x42c3c5[_0x5a7901(0x231)][_0x5a7901(0x2e3)];if(_0xec605d)_0x5d77e1[_0x494b06]=_0x57eda4;for(const _0xddd9cb of _0x42c3c5['common'][_0x5a7901(0x346)]){if(_0xec605d){if(!_0x3e1de1[_0xddd9cb])_0x3e1de1[_0xddd9cb]=[];_0x3e1de1[_0xddd9cb][_0x5a7901(0x22c)](_0x494b06);}else _0x3e1de1[_0xddd9cb]=_0x57eda4;}}}};_0x286325(_0xcf8c75,_0x340da5),_0x286325(_0x5c83d6,_0x215149,!![]);const _0xfdfcc3=await this[_0x42fbf0(0x286)]('*',_0x42fbf0(0x1f7)),_0x308af8=[_0x42fbf0(0x29c),_0x42fbf0(0x389),'RSSI',_0x42fbf0(0x20b),_0x42fbf0(0x2dd),_0x42fbf0(0x34a),_0x42fbf0(0x33e),'CONFIG_PENDING',_0x42fbf0(0x2c0),'WORKING',_0x42fbf0(0x20a),'STICKY_UNREACH',_0x42fbf0(0x327),_0x42fbf0(0x36d),_0x42fbf0(0x22a),_0x42fbf0(0x1ba),_0x42fbf0(0x374),'ON_TIME',_0x42fbf0(0x1fb),_0x42fbf0(0x30a),'PROCESS',_0x42fbf0(0x2dc),'CONNECTION',_0x42fbf0(0x2e8),_0x42fbf0(0x256),_0x42fbf0(0x1ee),'update','firmware','version',_0x42fbf0(0x223),_0x42fbf0(0x2b1),_0x42fbf0(0x37b),_0x42fbf0(0x24a),_0x42fbf0(0x391),_0x42fbf0(0x38b),'alert',_0x42fbf0(0x233),_0x42fbf0(0x2ab),'effect','xy','ct',_0x42fbf0(0x1ae),_0x42fbf0(0x361),_0x42fbf0(0x2aa),_0x42fbf0(0x284),_0x42fbf0(0x31c),_0x42fbf0(0x214),'command',_0x42fbf0(0x209),_0x42fbf0(0x2f4),_0x42fbf0(0x1d6),_0x42fbf0(0x2c8),'scriptEnabled',_0x42fbf0(0x2c4),_0x42fbf0(0x26d),_0x42fbf0(0x2a6),_0x42fbf0(0x30c),_0x42fbf0(0x1b6),'history',_0x42fbf0(0x24d),_0x42fbf0(0x2b1),_0x42fbf0(0x2b3)];if(!_0x5731fa)_0x308af8[_0x42fbf0(0x22c)](_0x42fbf0(0x21e),_0x42fbf0(0x1c5),_0x42fbf0(0x384),_0x42fbf0(0x1be),'uv',_0x42fbf0(0x2a1),_0x42fbf0(0x296));const _0x550859=['system.','admin.',_0x42fbf0(0x306),'vis.',_0x42fbf0(0x249),_0x42fbf0(0x2d5),'icons-mfd.','flot.'];if(!_0x5731fa)_0x550859[_0x42fbf0(0x22c)](_0x42fbf0(0x1d9),'weatherunderground.',_0x42fbf0(0x211),_0x42fbf0(0x236),'openweathermap.');const _0xf4432=(_0x28b163,_0x2788cb,_0x1797a0=![])=>{const _0xb4c23c=_0x42fbf0,_0x809be6=_0x28b163[_0xb4c23c(0x31f)]('.');if(_0x2788cb[_0x28b163])return _0x2788cb[_0x28b163];if(_0x809be6[_0xb4c23c(0x2fa)]>0x2&&_0x2788cb[_0x809be6[_0xb4c23c(0x2a4)](0x0,-0x1)[_0xb4c23c(0x37c)]('.')])return _0x2788cb[_0x809be6[_0xb4c23c(0x2a4)](0x0,-0x1)['join']('.')];if(_0x809be6[_0xb4c23c(0x2fa)]>0x3&&_0x2788cb[_0x809be6['slice'](0x0,-0x2)[_0xb4c23c(0x37c)]('.')])return _0x2788cb[_0x809be6['slice'](0x0,-0x2)[_0xb4c23c(0x37c)]('.')];return _0x1797a0?[]:null;};for(const _0x116c7a in _0xfdfcc3){const _0x50b412=_0xfdfcc3[_0x116c7a];if(!_0x50b412||!_0x50b412[_0x42fbf0(0x231)])continue;if(_0x550859[_0x42fbf0(0x295)](_0x9e4c4b=>_0x116c7a['startsWith'](_0x9e4c4b)))continue;const _0x2e1221=_0x50b412[_0x42fbf0(0x231)][_0x42fbf0(0x25a)]||'',_0x1c61bc=(_0x50b412['common']['name']&&typeof _0x50b412['common'][_0x42fbf0(0x2e3)]===_0x42fbf0(0x26e)?_0x50b412[_0x42fbf0(0x231)][_0x42fbf0(0x2e3)]['de']:_0x50b412[_0x42fbf0(0x231)][_0x42fbf0(0x2e3)])||'',_0xdd7f88=_0x1c61bc?_0x1c61bc[_0x42fbf0(0x328)]():'',_0x1563ec=_0x116c7a['toLowerCase'](),_0x422753=_0xf4432(_0x116c7a,_0x340da5),_0x465b83=_0xf4432(_0x116c7a,_0x215149,!![]);let _0x16f07d=null,_0x1ca263=![];if(_0x465b83&&_0x465b83['length']>0x0){const _0x2b2ed3=_0x465b83['find'](_0x1ec815=>_0x39b4f5[_0x42fbf0(0x291)](_0x1ec815));if(_0x2b2ed3){_0x1ca263=!![];const _0x416942=_0x5d77e1[_0x2b2ed3];if(_0x1563ec['includes'](_0x42fbf0(0x220))||_0x1563ec[_0x42fbf0(0x291)](_0x42fbf0(0x32d)))_0x16f07d='Bewegung';else{if(_0x1563ec['includes']('smoke')||_0x1563ec[_0x42fbf0(0x291)](_0x42fbf0(0x242))||_0xdd7f88['includes']('rauch'))_0x16f07d=_0x42fbf0(0x21b);else{if(_0x1563ec[_0x42fbf0(0x291)](_0x42fbf0(0x1f7))||_0x1563ec[_0x42fbf0(0x291)](_0x42fbf0(0x2b9))||_0x1563ec[_0x42fbf0(0x291)]('on'))_0x16f07d=_0x42fbf0(0x1e1);else _0x16f07d=_0x416942;}}}}if(!_0x1ca263&&!_0x5731fa){if(_0x308af8[_0x42fbf0(0x295)](_0x17b65d=>_0xdd7f88[_0x42fbf0(0x291)](_0x17b65d)||_0x116c7a['toUpperCase']()[_0x42fbf0(0x291)](_0x17b65d)))continue;}if(!_0x16f07d&&_0x41eab9){if(_0x2e1221[_0x42fbf0(0x291)]('sensor.motion')||_0x2e1221[_0x42fbf0(0x291)](_0x42fbf0(0x26f))||_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x34d))||_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x1e9)))_0x16f07d=_0x42fbf0(0x342);}!_0x16f07d&&_0x146d88&&((_0x1563ec['includes']('shutter_contact')||_0x2e1221['includes']('sensor.door')||_0x2e1221[_0x42fbf0(0x291)](_0x42fbf0(0x27f))||(_0xdd7f88[_0x42fbf0(0x291)]('fenster')||_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x1cb)))&&!_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x357))&&!_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x293))&&(_0x50b412[_0x42fbf0(0x231)][_0x42fbf0(0x25f)]===_0x42fbf0(0x1b4)||_0x50b412['common'][_0x42fbf0(0x25f)]==='number'))&&(_0x16f07d=_0x42fbf0(0x280)));if(!_0x16f07d&&_0x5be59b){if((_0x2e1221[_0x42fbf0(0x291)](_0x42fbf0(0x2b4))||_0x2e1221[_0x42fbf0(0x291)](_0x42fbf0(0x202))||_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x268))||_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x1ad)))&&_0x50b412[_0x42fbf0(0x231)]['write'])_0x16f07d=_0x42fbf0(0x21a);}if(!_0x16f07d&&_0x69cbd4){if(_0x2e1221[_0x42fbf0(0x291)](_0x42fbf0(0x33a))||_0x2e1221[_0x42fbf0(0x291)](_0x42fbf0(0x22e))||_0xdd7f88[_0x42fbf0(0x291)]('temperatur'))_0x16f07d=_0x42fbf0(0x32c);}if(_0x16f07d){let _0x17cd2c=_0x422753||'';if(!_0x17cd2c){if(_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x1eb)))_0x17cd2c='Badezimmer';else{if(_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x29a)))_0x17cd2c=_0x42fbf0(0x274);else{if(_0xdd7f88['includes'](_0x42fbf0(0x308)))_0x17cd2c=_0x42fbf0(0x29d);else{if(_0xdd7f88['includes'](_0x42fbf0(0x2e7)))_0x17cd2c=_0x42fbf0(0x2a9);else{if(_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x35f))||_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x227)))_0x17cd2c=_0x42fbf0(0x394);else{if(_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x358)))_0x17cd2c=_0x42fbf0(0x226);}}}}}}let _0x39cf1d=![];_0x16f07d===_0x42fbf0(0x280)&&((_0xdd7f88['includes'](_0x42fbf0(0x305))||_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x309))||_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x2e6))||_0x17cd2c&&_0x17cd2c[_0x42fbf0(0x328)]()[_0x42fbf0(0x291)]('flur')&&_0xdd7f88[_0x42fbf0(0x291)](_0x42fbf0(0x1cb)))&&(_0x39cf1d=!![]));let _0x476b91=0x0;if(_0x1ca263)_0x476b91+=0x1e;else{if(_0x422753)_0x476b91+=0x14;else{if(_0x17cd2c)_0x476b91+=0xa;}}if(_0x39cf1d)_0x476b91+=0x5;_0x5066ac[_0x42fbf0(0x22c)]({'id':_0x116c7a,'name':_0x1c61bc||_0x116c7a,'type':_0x16f07d,'location':_0x17cd2c,'logDuplicates':_0x16f07d===_0x42fbf0(0x342),'isExit':_0x39cf1d,'_score':_0x476b91});}}return _0x5066ac[_0x42fbf0(0x385)]((_0xed104c,_0x3ee8b3)=>_0x3ee8b3[_0x42fbf0(0x345)]-_0xed104c[_0x42fbf0(0x345)]),_0x5066ac;}async[a0_0x404310(0x287)](){const _0x161564=a0_0x404310,_0x404978=this[_0x161564(0x1d8)][_0x161564(0x1d0)]||[];let _0x10850b=![];for(const _0x4fb3d2 of _0x404978){try{const _0x2b6d6a=await this[_0x161564(0x222)](_0x4fb3d2);if(_0x2b6d6a&&(_0x2b6d6a['val']===!![]||_0x2b6d6a[_0x161564(0x341)]===_0x161564(0x1ef)||_0x2b6d6a[_0x161564(0x341)]===0x1)){_0x10850b=!![];break;}}catch(_0x4f8eba){}}return _0x10850b&&(this[_0x161564(0x348)]&&(this[_0x161564(0x1bc)][_0x161564(0x2b1)](_0x161564(0x1f8)),this[_0x161564(0x240)]()),!this[_0x161564(0x1b1)]&&this['currentSystemMode']===SYSTEM_MODES[_0x161564(0x288)]&&this[_0x161564(0x200)](!![])),_0x10850b;}async['onStateChange'](_0x185b6d,_0x44f9f0){const _0x4400bd=a0_0x404310;if(!_0x44f9f0)return;if(_0x185b6d===this[_0x4400bd(0x2cf)]+'.'+SYSTEM_DP_MODE){_0x44f9f0['val']&&Object['values'](SYSTEM_MODES)[_0x4400bd(0x291)](_0x44f9f0[_0x4400bd(0x341)])&&(this[_0x4400bd(0x365)]=_0x44f9f0['val'],_0x44f9f0['val']===SYSTEM_MODES['VACATION']?this[_0x4400bd(0x200)](![]):this[_0x4400bd(0x200)](!![]));if(!_0x44f9f0[_0x4400bd(0x2b0)])this['setState'](_0x185b6d,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x44f9f0['ack']){_0x185b6d[_0x4400bd(0x291)](_0x4400bd(0x340))&&_0x44f9f0[_0x4400bd(0x341)]&&(this[_0x4400bd(0x375)](_0x185b6d,{'val':![],'ack':!![]}),this[_0x4400bd(0x2a5)]());if(_0x185b6d[_0x4400bd(0x291)](_0x4400bd(0x23c))&&_0x44f9f0[_0x4400bd(0x341)]){this[_0x4400bd(0x375)](_0x185b6d,{'val':![],'ack':!![]});if(this[_0x4400bd(0x351)])this[_0x4400bd(0x313)]();}_0x185b6d[_0x4400bd(0x291)]('triggerBriefing')&&_0x44f9f0[_0x4400bd(0x341)]&&(this[_0x4400bd(0x375)](_0x185b6d,{'val':![],'ack':!![]}),this[_0x4400bd(0x277)]());return;}if(this['config']['presenceDevices']&&this[_0x4400bd(0x1d8)]['presenceDevices'][_0x4400bd(0x291)](_0x185b6d)){await this['checkWifiPresence']();return;}const _0x429b39=(this[_0x4400bd(0x1d8)]['devices']||[])[_0x4400bd(0x1ca)](_0x4351d9=>_0x4351d9['id']===_0x185b6d);if(_0x429b39)this[_0x4400bd(0x281)](_0x185b6d,_0x44f9f0,_0x429b39);}async[a0_0x404310(0x281)](_0x8103b5,_0x538341,_0x58c3c4){const _0x17b799=a0_0x404310;if(!_0x58c3c4[_0x17b799(0x1de)]&&this[_0x17b799(0x360)][_0x8103b5]===_0x538341['val'])return;this['sensorLastValues'][_0x8103b5]=_0x538341['val'];if(this[_0x17b799(0x27e)])return;const _0x9a327e=await this[_0x17b799(0x287)]();if(_0x9a327e){if(!this[_0x17b799(0x1b1)])this['setPresence'](!![]);}else{const _0x35678d=_0x58c3c4[_0x17b799(0x2e2)]===!![];_0x35678d?this[_0x17b799(0x261)]():(this[_0x17b799(0x348)]&&(this[_0x17b799(0x1bc)][_0x17b799(0x2b1)]('Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.'),this[_0x17b799(0x240)]()),!this[_0x17b799(0x1b1)]&&this['currentSystemMode']===SYSTEM_MODES[_0x17b799(0x288)]&&this[_0x17b799(0x200)](!![]));}const _0xa4517a={'timestamp':_0x538341['ts'],'id':_0x8103b5,'name':_0x58c3c4[_0x17b799(0x2e3)],'value':_0x538341[_0x17b799(0x341)],'location':_0x58c3c4[_0x17b799(0x243)],'type':_0x58c3c4[_0x17b799(0x25f)]};this['eventHistory']['unshift'](_0xa4517a);if(this[_0x17b799(0x347)][_0x17b799(0x2fa)]>HISTORY_MAX_SIZE)this[_0x17b799(0x347)][_0x17b799(0x2eb)]();await this['setStateAsync'](_0x17b799(0x30f),{'val':JSON[_0x17b799(0x29f)](_0xa4517a),'ack':!![]}),await this['setStateAsync']('events.history',{'val':JSON['stringify'](this[_0x17b799(0x347)]),'ack':!![]}),this[_0x17b799(0x2e0)][_0x17b799(0x22c)]({'timestamp':new Date(_0x538341['ts'])['toISOString'](),'sensorName':_0x58c3c4[_0x17b799(0x2e3)],'location':_0x58c3c4[_0x17b799(0x243)],'value':_0x538341[_0x17b799(0x341)]}),await this[_0x17b799(0x1d2)]();}[a0_0x404310(0x261)](){const _0x516f68=a0_0x404310;this['abortExitTimer'](),this['isGracePeriodActive']=!![],this[_0x516f68(0x2f8)]=setTimeout(()=>{this['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x516f68(0x348)]=setTimeout(()=>{const _0x30c4bd=_0x516f68;this['setPresence'](![]),this[_0x30c4bd(0x348)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x404310(0x240)](){const _0x1999e4=a0_0x404310;if(this[_0x1999e4(0x348)])clearTimeout(this['exitTimer']);if(this[_0x1999e4(0x2f8)])clearTimeout(this['exitGraceTimer']);this[_0x1999e4(0x348)]=null,this[_0x1999e4(0x2f8)]=null,this[_0x1999e4(0x27e)]=![];}async['setPresence'](_0x1506da){const _0x1d00d1=a0_0x404310;if(this['isPresent']===_0x1506da)return;this[_0x1d00d1(0x1b1)]=_0x1506da,await this['setStateAsync'](_0x1d00d1(0x367),{'val':_0x1506da,'ack':!![]});}['runAutopilot'](){const _0x3ff722=a0_0x404310,_0x495743=this[_0x3ff722(0x1d8)][_0x3ff722(0x34c)],_0x3c93ce=this[_0x3ff722(0x1d8)][_0x3ff722(0x303)],_0x500382=this[_0x3ff722(0x347)][_0x3ff722(0x2fa)]>0x0?this[_0x3ff722(0x347)][0x0]['timestamp']:Date[_0x3ff722(0x2ea)](),_0x4bf526=(Date[_0x3ff722(0x2ea)]()-_0x500382)/(0x3e8*0x3c*0x3c);let _0xef91c3='';_0x3c93ce&&this['currentSystemMode']===SYSTEM_MODES['NORMAL']&&this['isPresent']&&(_0x4bf526>_0x495743&&(_0xef91c3=_0x3ff722(0x1d5)+_0x4bf526[_0x3ff722(0x33c)](0x1)+_0x3ff722(0x32b)));if(_0xef91c3){this[_0x3ff722(0x2a5)](_0xef91c3)[_0x3ff722(0x258)](_0x500005=>this[_0x3ff722(0x1bc)][_0x3ff722(0x372)](_0x500005));return;}const _0x1c0703=Date[_0x3ff722(0x2ea)](),_0x590d68=_0x1c0703-_0x500382,_0x1599cc=(this[_0x3ff722(0x1d8)][_0x3ff722(0x2c5)]||0xf)*0x3c*0x3e8;this['eventHistory'][_0x3ff722(0x2fa)]>0x0&&_0x590d68<=_0x1599cc?this[_0x3ff722(0x2a5)]()[_0x3ff722(0x258)](_0x2edff7=>this[_0x3ff722(0x1bc)][_0x3ff722(0x372)](_0x2edff7)):!this['lastAlertState']&&(this[_0x3ff722(0x375)](_0x3ff722(0x2a7),{'val':![],'ack':!![]}),this[_0x3ff722(0x375)](_0x3ff722(0x1c8),{'val':![],'ack':!![]}));}async[a0_0x404310(0x2a5)](_0x10e5b2=''){const _0x49dff4=a0_0x404310;if(!this[_0x49dff4(0x1bb)])return;const _0x2e03f2=this[_0x49dff4(0x347)]['length']>0x0?this[_0x49dff4(0x347)]:[{'note':_0x49dff4(0x36e)}],_0xc73694=PERSONA_MAPPING[this['config'][_0x49dff4(0x1d7)]||_0x49dff4(0x1d1)],_0x5b9957=this[_0x49dff4(0x1d8)][_0x49dff4(0x210)]||'',_0x38ad5c=this[_0x49dff4(0x365)],_0x6843c4=await this[_0x49dff4(0x339)](),_0x59c4e1=await this['getCalendarContext'](),_0x2ff4e6=(_0x6843c4+'\x20'+_0x59c4e1)['trim'](),_0x170290=new Date(),_0x5559bd=_0x170290[_0x49dff4(0x2da)](_0x49dff4(0x2e1),{'weekday':_0x49dff4(0x1e6),'hour':_0x49dff4(0x1fa),'minute':_0x49dff4(0x1fa)}),_0x258074=this['systemConfig'];let _0x353ac3='';if(this[_0x49dff4(0x38e)][_0x49dff4(0x2fa)]>0x0){const _0x189d72=this[_0x49dff4(0x38e)][_0x49dff4(0x2a4)](0x0,0x3)['map'](_0x30d3ab=>_0x49dff4(0x316)+_0x30d3ab[_0x49dff4(0x2ba)]+_0x49dff4(0x386)+_0x30d3ab['rating']+'.')[_0x49dff4(0x37c)]('\x0a');_0x353ac3=_0x49dff4(0x2c2)+_0x189d72+'\x0a';}const _0x103ae7=_0x10e5b2?_0x49dff4(0x36c)+_0x10e5b2+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x158453=_0x49dff4(0x1b7),_0x4a78a7=_0x49dff4(0x2b5)+_0x5559bd+'.\x20ORT:\x20'+_0x258074['city']+_0x49dff4(0x252)+_0x38ad5c+_0x49dff4(0x263)+(this[_0x49dff4(0x1b1)]?'Ja':_0x49dff4(0x34f))+_0x49dff4(0x37a)+_0x5b9957+_0x49dff4(0x28b)+_0xc73694+_0x49dff4(0x2bd)+_0x2ff4e6+_0x49dff4(0x379)+_0x158453+'\x20'+_0x353ac3+'\x20'+_0x103ae7+_0x49dff4(0x221)+JSON['stringify'](_0x2e03f2)+_0x49dff4(0x2c9);try{const _0x5a1b9d=await this['geminiModel']['generateContent'](_0x4a78a7),_0x35c042=_0x5a1b9d['response'][_0x49dff4(0x224)]()[_0x49dff4(0x244)](/```json|```/g,'')[_0x49dff4(0x219)](),_0x4ca97f=JSON[_0x49dff4(0x22f)](_0x35c042);await this[_0x49dff4(0x383)](_0x49dff4(0x29e),{'val':_0x35c042,'ack':!![]}),await this[_0x49dff4(0x383)](_0x49dff4(0x232),{'val':_0x4ca97f['activity'][_0x49dff4(0x2ba)]||'','ack':!![]}),await this[_0x49dff4(0x383)](_0x49dff4(0x1f3),{'val':_0x4ca97f[_0x49dff4(0x2be)]['summary']||'N/A','ack':!![]}),await this[_0x49dff4(0x383)](_0x49dff4(0x1e4),{'val':_0x4ca97f[_0x49dff4(0x2be)][_0x49dff4(0x292)]||'N/A','ack':!![]});_0x4ca97f[_0x49dff4(0x255)]&&(await this[_0x49dff4(0x383)](_0x49dff4(0x1ce),{'val':_0x4ca97f[_0x49dff4(0x255)][_0x49dff4(0x30c)]||'','ack':!![]}),await this['setStateAsync'](_0x49dff4(0x23f),{'val':_0x4ca97f['comfort'][_0x49dff4(0x2b8)]||'','ack':!![]}),_0x4ca97f[_0x49dff4(0x255)]['automationProposal']&&(await this[_0x49dff4(0x383)](_0x49dff4(0x318),{'val':_0x4ca97f['comfort'][_0x49dff4(0x208)][_0x49dff4(0x279)]||![],'ack':!![]}),await this[_0x49dff4(0x383)]('analysis.automation.description',{'val':_0x4ca97f[_0x49dff4(0x255)][_0x49dff4(0x208)][_0x49dff4(0x2f4)]||'','ack':!![]}),await this['setStateAsync'](_0x49dff4(0x241),{'val':_0x4ca97f[_0x49dff4(0x255)][_0x49dff4(0x208)]['suggestedAction']||'','ack':!![]})));_0x4ca97f['health']&&(await this['setStateAsync']('analysis.health.sleepScore',{'val':typeof _0x4ca97f[_0x49dff4(0x201)][_0x49dff4(0x317)]==='number'?_0x4ca97f[_0x49dff4(0x201)][_0x49dff4(0x317)]:0x0,'ack':!![]}),await this[_0x49dff4(0x383)]('analysis.health.restlessness',{'val':_0x4ca97f[_0x49dff4(0x201)][_0x49dff4(0x205)]||'none','ack':!![]}),await this[_0x49dff4(0x383)](_0x49dff4(0x1d3),{'val':_0x4ca97f[_0x49dff4(0x201)][_0x49dff4(0x35a)]||'','ack':!![]}));const _0x54f72c=_0x4ca97f[_0x49dff4(0x2be)][_0x49dff4(0x314)]||![],_0x18e95f=_0x4ca97f[_0x49dff4(0x2be)][_0x49dff4(0x213)]||![];if(_0x54f72c||_0x18e95f){await this[_0x49dff4(0x383)](_0x49dff4(0x2a7),{'val':!![],'ack':!![]}),await this[_0x49dff4(0x383)](_0x49dff4(0x1c8),{'val':_0x18e95f,'ack':!![]});if(!this['lastAlertState']||_0x18e95f){const _0x296720=_0x18e95f?_0x49dff4(0x324):_0x49dff4(0x1c4);this[_0x49dff4(0x390)](_0x296720+':\x20'+_0x4ca97f[_0x49dff4(0x2be)][_0x49dff4(0x2ba)],![],_0x18e95f);}}else await this[_0x49dff4(0x383)]('analysis.isAlert',{'val':![],'ack':!![]}),await this[_0x49dff4(0x383)]('analysis.isEmergency',{'val':![],'ack':!![]});this[_0x49dff4(0x1f2)]=_0x54f72c||_0x18e95f;const _0x1beb67={'timestamp':Date[_0x49dff4(0x2ea)](),'id':Date[_0x49dff4(0x2ea)]()['toString'](),'analysis':_0x4ca97f,'systemMode':_0x38ad5c,'isPro':this[_0x49dff4(0x351)]};this[_0x49dff4(0x289)](_0x1beb67);}catch(_0x4955e2){this['log'][_0x49dff4(0x372)](_0x49dff4(0x29b)+_0x4955e2['message']);}}async[a0_0x404310(0x313)](){const _0x2b5aed=a0_0x404310;if(!this[_0x2b5aed(0x1bb)]||this[_0x2b5aed(0x2e0)][_0x2b5aed(0x2fa)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x2b5aed(0x383)](LTM_DP_STATUS,{'val':_0x2b5aed(0x393),'ack':!![]});return;}this['log'][_0x2b5aed(0x2b1)](_0x2b5aed(0x2b2)+this[_0x2b5aed(0x2e0)]['length']+_0x2b5aed(0x28d)),await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x2b5aed(0x330),'ack':!![]});const _0x2663f3=this['rawEventLog']['length']>0x320?this[_0x2b5aed(0x2e0)][_0x2b5aed(0x2a4)](this['rawEventLog']['length']-0x320):this['rawEventLog'],_0x107114=PERSONA_MAPPING[this[_0x2b5aed(0x1d8)][_0x2b5aed(0x1d7)]||_0x2b5aed(0x1d1)],_0x3ee5b0=_0x2b5aed(0x1c3)+_0x107114+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20'+JSON[_0x2b5aed(0x29f)](_0x2663f3)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}';try{const _0x214320=await this[_0x2b5aed(0x1bb)][_0x2b5aed(0x1cf)](_0x3ee5b0),_0x5e3f88=_0x214320[_0x2b5aed(0x1c7)]['text']()['replace'](/```json|```/g,'')[_0x2b5aed(0x219)](),_0x22fd43=JSON[_0x2b5aed(0x22f)](_0x5e3f88),_0x5d9710={'timestamp':new Date()['toISOString'](),'eventCount':this[_0x2b5aed(0x2e0)]['length'],'summary':_0x22fd43[_0x2b5aed(0x30c)],'activityLevel':_0x22fd43[_0x2b5aed(0x2e5)],'health':{'sleepScore':_0x22fd43[_0x2b5aed(0x201)]?_0x22fd43[_0x2b5aed(0x201)][_0x2b5aed(0x317)]:0x0,'restlessness':_0x22fd43[_0x2b5aed(0x201)]?_0x22fd43['health'][_0x2b5aed(0x205)]:_0x2b5aed(0x382)},'systemMode':this['currentSystemMode']};this['dailyDigests'][_0x2b5aed(0x22c)](_0x5d9710),await this['saveDailyDigests'](),this[_0x2b5aed(0x2e0)]=[],await this[_0x2b5aed(0x1d2)](),await this[_0x2b5aed(0x383)](LTM_DP_STATUS,{'val':_0x2b5aed(0x21c),'ack':!![]}),this[_0x2b5aed(0x1bc)][_0x2b5aed(0x2b1)](_0x2b5aed(0x27c));}catch(_0x36a05d){this[_0x2b5aed(0x1bc)][_0x2b5aed(0x372)](_0x2b5aed(0x23b)+_0x36a05d[_0x2b5aed(0x2b7)]),await this[_0x2b5aed(0x383)](LTM_DP_STATUS,{'val':_0x2b5aed(0x2f5)+_0x36a05d['message'],'ack':!![]});}}[a0_0x404310(0x217)](){const _0x5bd8fd=a0_0x404310;if(this['briefingJob'])this[_0x5bd8fd(0x333)]['cancel']();if(!this[_0x5bd8fd(0x1d8)][_0x5bd8fd(0x246)])return;const _0x2ca711=(this[_0x5bd8fd(0x1d8)][_0x5bd8fd(0x336)]||_0x5bd8fd(0x2f3))[_0x5bd8fd(0x31f)](':'),_0x2d78ee=parseInt(_0x2ca711[0x0])||0x8,_0x16d8bf=parseInt(_0x2ca711[0x1])||0x0,_0x45fc5b=_0x16d8bf+'\x20'+_0x2d78ee+_0x5bd8fd(0x1f9);this['log'][_0x5bd8fd(0x2b1)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x2d78ee+':'+(_0x16d8bf<0xa?'0'+_0x16d8bf:_0x16d8bf)),this['briefingJob']=schedule[_0x5bd8fd(0x228)](_0x45fc5b,()=>{this['sendMorningBriefing']();});}async[a0_0x404310(0x277)](){const _0x9d4571=a0_0x404310;if(!this[_0x9d4571(0x1bb)])return;this[_0x9d4571(0x1bc)][_0x9d4571(0x2b1)]('Generating\x20Morning\x20Briefing...');const _0x238c6e=this['dailyDigests'][_0x9d4571(0x2fa)]>0x0?this[_0x9d4571(0x229)][this[_0x9d4571(0x229)]['length']-0x1]:null,_0x4b1c0e=_0x238c6e&&_0x238c6e[_0x9d4571(0x201)]?_0x238c6e[_0x9d4571(0x201)]['sleepScore']:_0x9d4571(0x2a2),_0x2e6426=new Date();_0x2e6426[_0x9d4571(0x2d0)](0x4,0x0,0x0,0x0);const _0x470f52=this[_0x9d4571(0x347)][_0x9d4571(0x331)](_0x332c72=>new Date(_0x332c72[_0x9d4571(0x2e4)])>_0x2e6426),_0x54d0fb=PERSONA_MAPPING[this[_0x9d4571(0x1d8)][_0x9d4571(0x1d7)]||'generic'],_0x569314=this[_0x9d4571(0x1d8)][_0x9d4571(0x210)]||'',_0x55d301=await this['getWeatherContext'](),_0x3e7193=await this[_0x9d4571(0x1b9)](),_0x4e6861=_0x9d4571(0x2de)+_0x54d0fb+_0x9d4571(0x299)+_0x569314+_0x9d4571(0x250)+_0x55d301+'\x20'+_0x3e7193+_0x9d4571(0x2ec)+_0x4b1c0e+_0x9d4571(0x1ea)+JSON['stringify'](_0x470f52[_0x9d4571(0x2a4)](0x0,0xa))+_0x9d4571(0x355);try{const _0x45f971=await this[_0x9d4571(0x1bb)][_0x9d4571(0x1cf)](_0x4e6861),_0x5705a4=_0x9d4571(0x35e)+_0x45f971[_0x9d4571(0x1c7)][_0x9d4571(0x224)]()[_0x9d4571(0x219)]();this[_0x9d4571(0x390)](_0x5705a4),this[_0x9d4571(0x1bc)]['info']('Morning\x20Briefing\x20sent.');}catch(_0x2005b5){this[_0x9d4571(0x1bc)][_0x9d4571(0x372)](_0x9d4571(0x319)+_0x2005b5['message']);}}async[a0_0x404310(0x1ff)](){const _0x35d364=a0_0x404310;try{const _0x584ffe=await this[_0x35d364(0x207)](_0x35d364(0x36a));_0x584ffe&&_0x584ffe[_0x35d364(0x341)]&&(this[_0x35d364(0x347)]=JSON['parse'](_0x584ffe[_0x35d364(0x341)][_0x35d364(0x22b)]()));}catch(_0x2b9246){this['eventHistory']=[];}try{const _0x2a2fa7=await this['getStateAsync'](_0x35d364(0x1f5));if(_0x2a2fa7&&_0x2a2fa7[_0x35d364(0x341)])this[_0x35d364(0x33f)]=JSON[_0x35d364(0x22f)](_0x2a2fa7[_0x35d364(0x341)][_0x35d364(0x22b)]());}catch(_0x547f51){this[_0x35d364(0x33f)]=[];}}async[a0_0x404310(0x247)](){const _0x1fcb1a=a0_0x404310;await this[_0x1fcb1a(0x335)](),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x367),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x254),'type':'boolean','role':_0x1fcb1a(0x321),'read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x30f),{'type':_0x1fcb1a(0x1f7),'common':{'name':'Last\x20raw\x20event','type':_0x1fcb1a(0x203),'role':_0x1fcb1a(0x2b3),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('events.history',{'type':'state','common':{'name':_0x1fcb1a(0x1fc),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x1fcb1a(0x340),{'type':'state','common':{'name':_0x1fcb1a(0x35d),'type':_0x1fcb1a(0x1b4),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x2f7),{'type':'state','common':{'name':_0x1fcb1a(0x31b),'type':'boolean','role':_0x1fcb1a(0x294),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x29e),{'type':'state','common':{'name':_0x1fcb1a(0x31a),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x2a7),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x1e5),'type':_0x1fcb1a(0x1b4),'role':_0x1fcb1a(0x248),'read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x1fcb1a(0x1c8),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x245),'type':_0x1fcb1a(0x1b4),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x1fcb1a(0x2ff)]('analysis.alertReason',{'type':'state','common':{'name':'Alert\x20Reason','type':_0x1fcb1a(0x203),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.activitySummary',{'type':'state','common':{'name':'Activity\x20Summary','type':_0x1fcb1a(0x203),'role':_0x1fcb1a(0x224),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x1fcb1a(0x1e4),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x259),'type':_0x1fcb1a(0x203),'role':_0x1fcb1a(0x1f7),'read':!![],'write':![],'def':_0x1fcb1a(0x2a2)},'native':{}}),await this['setObjectNotExistsAsync'](_0x1fcb1a(0x1ce),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x366),'type':_0x1fcb1a(0x203),'role':_0x1fcb1a(0x224),'read':!![],'write':![]},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x23f),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x26b),'type':'string','role':_0x1fcb1a(0x224),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](_0x1fcb1a(0x20c),{'type':_0x1fcb1a(0x30b),'common':{'name':'Automation\x20Proposals'},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x318),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x265),'type':_0x1fcb1a(0x1b4),'role':_0x1fcb1a(0x321),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x1fcb1a(0x2ff)]('analysis.automation.description',{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x24f),'type':_0x1fcb1a(0x203),'role':_0x1fcb1a(0x224),'read':!![],'write':![]},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x241),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x2d2),'type':'string','role':_0x1fcb1a(0x224),'read':!![],'write':![]},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x1f5),{'type':'state','common':{'name':'Logbook','type':_0x1fcb1a(0x203),'role':_0x1fcb1a(0x2b3),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x24c),{'type':'state','common':{'name':_0x1fcb1a(0x2d1),'type':_0x1fcb1a(0x203),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1fcb1a(0x338)](_0x1fcb1a(0x377),{'type':_0x1fcb1a(0x30b),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await this[_0x1fcb1a(0x2ff)](_0x1fcb1a(0x1bf),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x350),'type':_0x1fcb1a(0x297),'role':_0x1fcb1a(0x1ec),'read':!![],'write':![],'def':0x0},'native':{}}),await this[_0x1fcb1a(0x2ff)]('analysis.health.restlessness',{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x2d8),'type':_0x1fcb1a(0x203),'role':_0x1fcb1a(0x224),'read':!![],'write':![],'def':'none'},'native':{}}),await this['setObjectNotExistsAsync'](_0x1fcb1a(0x1d3),{'type':_0x1fcb1a(0x1f7),'common':{'name':_0x1fcb1a(0x267),'type':_0x1fcb1a(0x203),'role':_0x1fcb1a(0x224),'read':!![],'write':![],'def':''},'native':{}}),await this[_0x1fcb1a(0x20f)](),await this[_0x1fcb1a(0x1f4)]();}async['checkSystemObjects'](){const _0x13a8de=a0_0x404310;await this[_0x13a8de(0x338)](_0x13a8de(0x2fe),{'type':_0x13a8de(0x30b),'common':{'name':_0x13a8de(0x31d)},'native':{}}),await this[_0x13a8de(0x338)](SYSTEM_DP_MODE,{'type':_0x13a8de(0x1f7),'common':{'name':_0x13a8de(0x230),'type':_0x13a8de(0x203),'role':_0x13a8de(0x1f7),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x13a8de(0x288)]]:_0x13a8de(0x22d),[SYSTEM_MODES['VACATION']]:_0x13a8de(0x38c),[SYSTEM_MODES[_0x13a8de(0x1c6)]]:_0x13a8de(0x28c),[SYSTEM_MODES[_0x13a8de(0x392)]]:_0x13a8de(0x234)}},'native':{}});}async[a0_0x404310(0x390)](_0x3d62c5,_0x5d1128=![],_0x17a2cb=![]){const _0x1cfa35=a0_0x404310;this[_0x1cfa35(0x1bc)]['info']((_0x5d1128?'[TEST]\x20':'')+_0x1cfa35(0x276)+_0x3d62c5+'\x22'+(_0x17a2cb?_0x1cfa35(0x2d9):''));const _0x5669d7=this['config'];let _0xdebfe6=0x0;_0x5669d7['notifyTelegramEnabled']&&_0x5669d7[_0x1cfa35(0x25e)]&&(await this[_0x1cfa35(0x27b)](_0x5669d7[_0x1cfa35(0x25e)],_0x1cfa35(0x2fc),{'text':_0x3d62c5,'user':_0x5669d7[_0x1cfa35(0x2df)]}),_0xdebfe6++);if(_0x5669d7[_0x1cfa35(0x33b)]&&_0x5669d7[_0x1cfa35(0x298)]){let _0x4246bc={'message':_0x3d62c5,'title':_0x17a2cb?'üö®\x20EMERGENCY':_0x1cfa35(0x212),'priority':_0x17a2cb?0x2:0x1,'device':_0x5669d7[_0x1cfa35(0x32f)]};_0x17a2cb&&(_0x4246bc['retry']=0x1e,_0x4246bc[_0x1cfa35(0x1dc)]=0xe10,_0x4246bc[_0x1cfa35(0x283)]=_0x1cfa35(0x272)),await this[_0x1cfa35(0x27b)](_0x5669d7[_0x1cfa35(0x298)],'send',_0x4246bc),_0xdebfe6++;}return _0x5669d7[_0x1cfa35(0x1b8)]&&_0x5669d7[_0x1cfa35(0x1c1)]&&(await this[_0x1cfa35(0x27b)](_0x5669d7[_0x1cfa35(0x1c1)],_0x1cfa35(0x2fc),{'text':_0x3d62c5,'to':_0x5669d7[_0x1cfa35(0x237)]}),_0xdebfe6++),_0x5669d7['notifyWhatsappEnabled']&&_0x5669d7[_0x1cfa35(0x225)]&&(await this[_0x1cfa35(0x27b)](_0x5669d7[_0x1cfa35(0x225)],_0x1cfa35(0x2fc),{'text':_0x3d62c5,'phone':_0x5669d7[_0x1cfa35(0x257)]}),_0xdebfe6++),_0x5669d7[_0x1cfa35(0x23a)]&&_0x5669d7[_0x1cfa35(0x1b0)]&&(await this[_0x1cfa35(0x27b)](_0x5669d7[_0x1cfa35(0x1b0)],_0x1cfa35(0x2fc),{'text':_0x3d62c5,'phone':_0x5669d7[_0x1cfa35(0x1ed)]}),_0xdebfe6++),_0xdebfe6;}async[a0_0x404310(0x323)](){const _0x4e5502=a0_0x404310;try{const _0xd4e974=await this[_0x4e5502(0x207)](LTM_DP_RAW_LOG);if(_0xd4e974&&_0xd4e974['val'])this['rawEventLog']=JSON['parse'](_0xd4e974[_0x4e5502(0x341)]);}catch(_0x594dcc){this[_0x4e5502(0x2e0)]=[];}}async[a0_0x404310(0x1d2)](){const _0x231ccb=a0_0x404310;this[_0x231ccb(0x2e0)][_0x231ccb(0x2fa)]>RAW_LOG_MAX_SIZE&&this[_0x231ccb(0x2e0)][_0x231ccb(0x1fd)](0x0,this['rawEventLog'][_0x231ccb(0x2fa)]-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON['stringify'](this['rawEventLog']),'ack':!![]});}async['loadDailyDigests'](){const _0x42223d=a0_0x404310;try{const _0x1927f8=await this[_0x42223d(0x207)](LTM_DP_DAILY_DIGESTS);if(_0x1927f8&&_0x1927f8['val'])this[_0x42223d(0x229)]=JSON[_0x42223d(0x22f)](_0x1927f8[_0x42223d(0x341)]);}catch(_0x3e3cd6){this[_0x42223d(0x229)]=[];}await this['updateBaselineStatus']();}async[a0_0x404310(0x2bf)](_0x2a9652=!![]){const _0x3d7535=a0_0x404310,_0x2c2a39=this['config'][_0x3d7535(0x2ca)]||0x3c;this[_0x3d7535(0x229)][_0x3d7535(0x2fa)]>_0x2c2a39&&this[_0x3d7535(0x229)][_0x3d7535(0x1fd)](0x0,this['dailyDigests'][_0x3d7535(0x2fa)]-_0x2c2a39);await this[_0x3d7535(0x383)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](this[_0x3d7535(0x229)]),'ack':!![]});if(_0x2a9652)await this[_0x3d7535(0x206)]();}[a0_0x404310(0x322)](){const _0x2ce924=a0_0x404310;if(this[_0x2ce924(0x2a3)])this[_0x2ce924(0x2a3)][_0x2ce924(0x310)]();if(!this[_0x2ce924(0x351)]){this[_0x2ce924(0x383)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this['ltmJob']=schedule[_0x2ce924(0x228)](LTM_SCHEDULE,()=>this[_0x2ce924(0x313)]());}[a0_0x404310(0x2bc)](){const _0x1b9322=a0_0x404310;if(this['driftAnalysisTimer'])clearInterval(this[_0x1b9322(0x1cd)]);if(!this[_0x1b9322(0x351)])return;this[_0x1b9322(0x1cd)]=setInterval(()=>this[_0x1b9322(0x218)](),(this[_0x1b9322(0x1d8)][_0x1b9322(0x2d3)]||0x18)*0x36ee80),setTimeout(()=>this[_0x1b9322(0x218)](),0x1388);}async['updateBaselineStatus'](){const _0x2f7e3c=a0_0x404310;if(!this[_0x2f7e3c(0x351)]){await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x2f7e3c(0x363),'ack':!![]});return;}const _0x46d1bf=this[_0x2f7e3c(0x229)][_0x2f7e3c(0x2fa)]>=(this[_0x2f7e3c(0x1d8)][_0x2f7e3c(0x31e)]||0x7)?'Aktiv\x20('+this[_0x2f7e3c(0x229)]['length']+_0x2f7e3c(0x2c6):_0x2f7e3c(0x269)+this[_0x2f7e3c(0x229)][_0x2f7e3c(0x2fa)]+'/'+(this[_0x2f7e3c(0x1d8)][_0x2f7e3c(0x31e)]||0x7)+')';await this[_0x2f7e3c(0x383)](LTM_DP_BASELINE_STATUS,{'val':_0x46d1bf,'ack':!![]});}async[a0_0x404310(0x289)](_0x35538e){const _0xd8bfda=a0_0x404310;this[_0xd8bfda(0x33f)][_0xd8bfda(0x349)](_0x35538e);if(this['analysisHistory'][_0xd8bfda(0x2fa)]>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0xd8bfda(0x2eb)]();await this[_0xd8bfda(0x383)](_0xd8bfda(0x1f5),{'val':JSON[_0xd8bfda(0x29f)](this[_0xd8bfda(0x33f)]),'ack':!![]});}[a0_0x404310(0x30e)](){const _0x342dcd=a0_0x404310;if(this[_0x342dcd(0x278)])this['modeResetJob']['cancel']();this['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x19cb4c=_0x342dcd;await this[_0x19cb4c(0x1f0)](),AUTO_RESET_MODES['includes'](this[_0x19cb4c(0x365)])&&await this[_0x19cb4c(0x383)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}async['resetAnalysisStates'](){const _0x1bd5ca=a0_0x404310;await this[_0x1bd5ca(0x383)](_0x1bd5ca(0x1f3),{'val':_0x1bd5ca(0x356),'ack':!![]}),await this[_0x1bd5ca(0x383)](_0x1bd5ca(0x1e4),{'val':this[_0x1bd5ca(0x351)]?_0x1bd5ca(0x32e):_0x1bd5ca(0x239),'ack':!![]}),await this['setStateAsync'](_0x1bd5ca(0x2a7),{'val':![],'ack':!![]}),await this[_0x1bd5ca(0x383)](_0x1bd5ca(0x1c8),{'val':![],'ack':!![]}),this[_0x1bd5ca(0x1f2)]=![];}async[a0_0x404310(0x20f)](){const _0x325d77=a0_0x404310;await this[_0x325d77(0x338)](_0x325d77(0x1b5),{'type':_0x325d77(0x30b),'common':{'name':'LTM'},'native':{}}),await this['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x325d77(0x1c2),'type':_0x325d77(0x203),'role':_0x325d77(0x2b3),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x325d77(0x1f7),'common':{'name':_0x325d77(0x388),'type':_0x325d77(0x203),'role':_0x325d77(0x2b3),'read':!![],'write':![]},'native':{}}),await this[_0x325d77(0x338)](LTM_DP_STATUS,{'type':_0x325d77(0x1f7),'common':{'name':'Processing\x20Status','type':'string','role':_0x325d77(0x224),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x325d77(0x2ad),'type':_0x325d77(0x1b4),'role':_0x325d77(0x294),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x325d77(0x338)](LTM_DP_BASELINE_STATUS,{'type':_0x325d77(0x1f7),'common':{'name':_0x325d77(0x2d6),'type':_0x325d77(0x203),'role':_0x325d77(0x224),'read':!![],'write':![]},'native':{}});}async[a0_0x404310(0x1f4)](){const _0x5154c2=a0_0x404310;await this[_0x5154c2(0x338)](LTM_DP_DRIFT_CHANNEL,{'type':_0x5154c2(0x30b),'common':{'name':'Drift\x20Analysis'},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x5154c2(0x1f7),'common':{'name':_0x5154c2(0x28e),'type':_0x5154c2(0x203),'role':'state','read':!![],'write':![],'def':_0x5154c2(0x2a2)},'native':{}}),await this[_0x5154c2(0x338)](LTM_DP_DRIFT_DETAILS,{'type':_0x5154c2(0x1f7),'common':{'name':_0x5154c2(0x2ed),'type':_0x5154c2(0x203),'role':_0x5154c2(0x224),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x5154c2(0x302),'type':_0x5154c2(0x297),'role':_0x5154c2(0x20e),'read':!![],'write':![]},'native':{}});}async[a0_0x404310(0x218)](){const _0x481161=a0_0x404310;if(!this[_0x481161(0x351)]||!this[_0x481161(0x1bb)])return;const _0x2567d1=this[_0x481161(0x1d8)][_0x481161(0x1e0)]||0xe;if(this[_0x481161(0x229)][_0x481161(0x2fa)]<_0x2567d1+(this[_0x481161(0x1d8)][_0x481161(0x31e)]||0x7)){await this[_0x481161(0x383)](LTM_DP_DRIFT_STATUS,{'val':_0x481161(0x371),'ack':!![]});return;}const _0x480093=this[_0x481161(0x229)]['slice'](-_0x2567d1),_0x54aec2=this[_0x481161(0x229)][_0x481161(0x2a4)](0x0,this[_0x481161(0x229)]['length']-_0x2567d1),_0x2b09f1=_0x481161(0x26c)+JSON[_0x481161(0x29f)](_0x54aec2)+_0x481161(0x38a)+JSON[_0x481161(0x29f)](_0x480093);try{const _0x478b98=await this[_0x481161(0x1bb)][_0x481161(0x1cf)](_0x2b09f1),_0x2f0919=JSON[_0x481161(0x22f)](_0x478b98[_0x481161(0x1c7)][_0x481161(0x224)]()[_0x481161(0x244)](/```json|```/g,'')[_0x481161(0x219)]());_0x2f0919[_0x481161(0x2ef)]&&(await this[_0x481161(0x383)](LTM_DP_DRIFT_STATUS,{'val':_0x2f0919[_0x481161(0x2ef)],'ack':!![]}),await this[_0x481161(0x383)](LTM_DP_DRIFT_DETAILS,{'val':_0x2f0919[_0x481161(0x35c)],'ack':!![]}),await this[_0x481161(0x383)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x481161(0x2ea)](),'ack':!![]}));}catch(_0x5f15cf){}}async[a0_0x404310(0x1f0)](){const _0xa2783b=a0_0x404310;try{const _0x1e2765=await this[_0xa2783b(0x207)](SYSTEM_DP_MODE);_0x1e2765&&_0x1e2765['val']&&Object[_0xa2783b(0x238)](SYSTEM_MODES)[_0xa2783b(0x291)](_0x1e2765['val'])?this['currentSystemMode']=_0x1e2765[_0xa2783b(0x341)]:(this[_0xa2783b(0x365)]=SYSTEM_MODES['NORMAL'],await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x553c66){this[_0xa2783b(0x365)]=SYSTEM_MODES['NORMAL'];}}async[a0_0x404310(0x387)](){const _0x55de13=a0_0x404310;try{const _0x36be53=await this['getForeignObjectAsync'](_0x55de13(0x32a));if(_0x36be53&&_0x36be53[_0x55de13(0x334)]&&_0x36be53['native'][_0x55de13(0x2ac)])return _0x36be53[_0x55de13(0x334)][_0x55de13(0x2ac)];return'uuid-not-found';}catch(_0x4d8aea){return _0x55de13(0x264);}}async[a0_0x404310(0x1e3)](_0x23a826){const _0xab8380=a0_0x404310;if(!_0x23a826)return![];this[_0xab8380(0x36b)]=await this[_0xab8380(0x387)]();if(_0x23a826===_0xab8380(0x1e8)||_0x23a826[_0xab8380(0x253)]('PRO-'))return!![];return![];}['onUnload'](_0xb2b1bc){const _0x57f74d=a0_0x404310;if(this['analysisTimer'])clearInterval(this[_0x57f74d(0x270)]);if(this[_0x57f74d(0x1cd)])clearInterval(this[_0x57f74d(0x1cd)]);if(this['ltmJob'])this['ltmJob'][_0x57f74d(0x310)]();if(this['modeResetJob'])this[_0x57f74d(0x278)][_0x57f74d(0x310)]();if(this['briefingJob'])this[_0x57f74d(0x333)][_0x57f74d(0x310)]();if(this[_0x57f74d(0x348)])clearTimeout(this['exitTimer']);if(this[_0x57f74d(0x2f8)])clearTimeout(this[_0x57f74d(0x2f8)]);_0xb2b1bc();}async[a0_0x404310(0x25c)](_0x44973c){const _0x2d874c=a0_0x404310;if(typeof _0x44973c===_0x2d874c(0x26e)&&_0x44973c[_0x2d874c(0x2b7)]){if(_0x44973c[_0x2d874c(0x262)]==='testApiKey'){if(!_0x44973c['message'][_0x2d874c(0x311)])return this[_0x2d874c(0x1b3)](_0x44973c[_0x2d874c(0x2a8)],_0x44973c['command'],{'success':![],'message':_0x2d874c(0x23d)},_0x44973c['callback']);try{const _0x5bbfeb=new GoogleGenerativeAI(_0x44973c[_0x2d874c(0x2b7)][_0x2d874c(0x311)])['getGenerativeModel']({'model':'models/gemini-flash-latest'});await _0x5bbfeb[_0x2d874c(0x1cf)](_0x2d874c(0x26a)),this['sendTo'](_0x44973c[_0x2d874c(0x2a8)],_0x44973c[_0x2d874c(0x262)],{'success':!![],'message':_0x2d874c(0x2c1)},_0x44973c[_0x2d874c(0x38d)]);}catch(_0x610de){this[_0x2d874c(0x1b3)](_0x44973c['from'],_0x44973c['command'],{'success':![],'message':_0x610de['message']},_0x44973c[_0x2d874c(0x38d)]);}}else{if(_0x44973c['command']===_0x2d874c(0x1dd)){const _0x3c9384=await this['sendNotification'](_0x2d874c(0x37d),!![]);this[_0x2d874c(0x1b3)](_0x44973c[_0x2d874c(0x2a8)],_0x44973c['command'],{'success':_0x3c9384>0x0,'message':_0x3c9384+_0x2d874c(0x2bb)},_0x44973c[_0x2d874c(0x38d)]);}else{if(_0x44973c[_0x2d874c(0x262)]==='getLtmData'){if(!this[_0x2d874c(0x351)])return this['sendTo'](_0x44973c[_0x2d874c(0x2a8)],_0x44973c[_0x2d874c(0x262)],{'success':![],'isPro':![]},_0x44973c[_0x2d874c(0x38d)]);let _0x498569={'status':_0x2d874c(0x2a2),'details':'','lastCheck':0x0};try{_0x498569[_0x2d874c(0x204)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x2d874c(0x341)],_0x498569['details']=(await this[_0x2d874c(0x207)](LTM_DP_DRIFT_DETAILS))[_0x2d874c(0x341)],_0x498569['lastCheck']=(await this[_0x2d874c(0x207)](LTM_DP_DRIFT_LAST_CHECK))[_0x2d874c(0x341)];}catch(_0x3df5bb){}this[_0x2d874c(0x1b3)](_0x44973c[_0x2d874c(0x2a8)],_0x44973c[_0x2d874c(0x262)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x2d874c(0x229)],'driftAnalysis':_0x498569,'analysisHistory':this[_0x2d874c(0x33f)]},_0x44973c[_0x2d874c(0x38d)]);}else{if(_0x44973c[_0x2d874c(0x262)]===_0x2d874c(0x27a)){const _0x3dcb9f=await this[_0x2d874c(0x286)](_0x2d874c(0x364),_0x2d874c(0x1f6)),_0x557087=[];if(_0x3dcb9f)for(const _0x53924a in _0x3dcb9f){const _0x2c2dd3=_0x3dcb9f[_0x53924a],_0x185468=(_0x2c2dd3[_0x2d874c(0x231)]&&typeof _0x2c2dd3['common'][_0x2d874c(0x2e3)]===_0x2d874c(0x26e)?_0x2c2dd3['common'][_0x2d874c(0x2e3)]['de']:_0x2c2dd3[_0x2d874c(0x231)][_0x2d874c(0x2e3)])||_0x2c2dd3['common'][_0x2d874c(0x2e3)];_0x557087['push']({'id':_0x53924a,'name':_0x185468});}this['sendTo'](_0x44973c[_0x2d874c(0x2a8)],_0x44973c[_0x2d874c(0x262)],{'success':!![],'enums':_0x557087},_0x44973c['callback']);}else{if(_0x44973c[_0x2d874c(0x262)]===_0x2d874c(0x266))try{const _0x27a72c=await this[_0x2d874c(0x1af)](_0x44973c[_0x2d874c(0x2b7)]||{});this[_0x2d874c(0x1b3)](_0x44973c[_0x2d874c(0x2a8)],_0x44973c[_0x2d874c(0x262)],{'success':!![],'devices':_0x27a72c},_0x44973c[_0x2d874c(0x38d)]);}catch(_0x2cd8f6){this[_0x2d874c(0x1b3)](_0x44973c['from'],_0x44973c['command'],{'success':![],'error':_0x2cd8f6[_0x2d874c(0x2b7)]},_0x44973c['callback']);}else{if(_0x44973c[_0x2d874c(0x262)]==='submitFeedback'){const {historyId:_0x54a6cb,rating:_0x79e0e1,comment:_0x44f329,alertReason:_0x337b12}=_0x44973c[_0x2d874c(0x2b7)];_0x54a6cb&&_0x79e0e1?(await this['saveFeedback']({'timestamp':Date['now'](),'historyId':_0x54a6cb,'rating':_0x79e0e1,'comment':_0x44f329,'alertReason':_0x337b12}),this[_0x2d874c(0x1b3)](_0x44973c[_0x2d874c(0x2a8)],_0x44973c['command'],{'success':!![]},_0x44973c['callback'])):this[_0x2d874c(0x1b3)](_0x44973c['from'],_0x44973c['command'],{'success':![],'error':_0x2d874c(0x34e)},_0x44973c['callback']);}}}}}}}}}if(require['main']!==module)module[a0_0x404310(0x344)]=_0x16277c=>new CogniLiving(_0x16277c);else new CogniLiving();function a0_0x5337(_0x21d813,_0x5d705a){const _0x12e39f=a0_0x3440();return a0_0x5337=function(_0x5b91f7,_0x1e07b4){_0x5b91f7=_0x5b91f7-0x1ad;let _0x34407d=_0x12e39f[_0x5b91f7];return _0x34407d;},a0_0x5337(_0x21d813,_0x5d705a);}function a0_0x3440(){const _0xfd7fd4=['loadDailyDigests','getForeignObjectAsync','namespace','setHours','Feedback\x20Log','Action','ltmDriftCheckIntervalHours','WETTER:\x20Unbekannt','material.','Baseline\x20Status','onUnload','Restlessness\x20Level','\x20(EMERGENCY)','toLocaleString','getGenerativeModel','AES_KEY','FAULT','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','notifyTelegramRecipient','rawEventLog','de-DE','isExit','name','timestamp','activityLevel','wohnungst√ºr','schlaf','reachable','weatherInstance','now','pop','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20','Drift\x20Details','node-schedule','baselineDrift','LTM.driftAnalysis.lastCheck','guest','110arkEDE','08:00','description','Fehler:\x20','onStateChange','analysis.triggerBriefing','exitGraceTimer','calendarInstance','length','constructor','send','.data.text','system','setObjectNotExistsAsync','LTM.driftAnalysis','daswetter','Last\x20Check','inactivityMonitoringEnabled','useWeather','haust√ºr','info.','.Summary.Current','wohn','eingang','ERROR_CODE','channel','summary','(((.+)+)+)+$','setupModeResetScheduler','events.lastEvent','cancel','apiKey','lights','createDailyDigest','isAlert','100676DAgbNj','User\x20Feedback:\x20Alarm\x20\x22','sleepScore','analysis.automation.patternDetected','Briefing\x20Error:\x20','Last\x20Result','Trigger\x20Briefing\x20(Test)','modelid','System\x20Status\x20&\x20Control','minDaysForBaseline','split','useCalendar','indicator','setupLtmScheduler','loadRawEventLog','üö®üö®\x20NOTFALL','Gemini\x20AI\x20initialized.','971526Ibqxyo','OPERATING_VOLTAGE','toLowerCase','runAutopilot','system.meta.uuid','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','Temperatur','motion','N/A\x20(No\x20Activity)','notifyPushoverRecipient','Analysiere\x20Tag...','filter','bind','briefingJob','native','checkSystemObjects','briefingTime','version','extendObjectAsync','getWeatherContext','value.temperature','notifyPushoverEnabled','toFixed','search','ALARM','analysisHistory','analysis.trigger','val','Bewegung','Subscribing\x20to\x20','exports','_score','members','eventHistory','exitTimer','unshift','SABOTAGE','geminiApiKey','inactivityThresholdHours','bewegung','Missing\x20data','Nein','Sleep\x20Score\x20(0-100)','isProVersion','LTM.driftAnalysis.baselineDrift','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','\x20min).\x20Watchdog\x20Limit:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','No\x20recent\x20activity.','temp','garten','application/json','notes','city','driftDetails','Trigger\x20Analysis','üåÖ\x20Daily\x20Briefing:\x0a','flur','sensorLastValues','sat','KALENDER:\x20Keine\x20Termine','Deaktiviert\x20(Pro-Feature)','enum.functions.*','currentSystemMode','Comfort\x20Summary','system.isPresent','temperature','LTM.triggerDailyDigest','events.history','systemUUID','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','VIRTUAL_CHANNEL','No\x20recorded\x20events\x20yet.','events.history_debug_00','705282sKfzwd','N/A\x20(Learning)','error','systemConfig','WEEK_PROGRAM','setState','LTM.driftAnalysis.driftDetails','analysis.health','licenseKey','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','signal','join','[Test]\x20Notification','Starting\x20Smart\x20Scan\x20with\x20filters:\x20','selectedFunctionIds','1bPjhkL','map','none','setStateAsync','wind','sort','\x22\x20was\x20','getSystemUUID','Daily\x20Digests','LOWBAT','\x0a\x0aA\x20(STB):\x0a','archetype','Urlaub','callback','feedbackHistory','.data.table','sendNotification','last\x20action','GUEST','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','Flur','lampe','hue','scanForDevices','notifySignalInstance','isPresent','apply','sendTo','boolean','LTM','icon','Baseline:\x20Inactive\x20(Pro\x20Feature).','notifyEmailEnabled','getCalendarContext','COMBINED_PARAMETER','geminiModel','log','longitude','pressure','analysis.health.sleepScore','664022UMlrXt','notifyEmailInstance','Raw\x20Log','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','‚ö†Ô∏è\x20Alarm','weather','PARTY','response','analysis.isEmergency','delObjectAsync','find','t√ºr','accuweather','driftAnalysisTimer','analysis.comfortSummary','generateContent','presenceDevices','generic','saveRawEventLog','analysis.health.notes','subscribeForeignStatesAsync','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','capabilities','aiPersona','config','daswetter.','enum.rooms.*','.forecast.current.state','expire','testNotification','logDuplicates','1877946XtFuoK','ltmStbWindowDays','Schalter/Licht','system.mode','checkLicense','analysis.deviationFromBaseline','AI\x20Alert\x20Status','long','accuweather.0','TEST-PRO-KEY','pr√§senz','/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20','bad','value.health','notifySignalRecipient','battery','online','loadSystemMode','LTM.rawEventLog','lastAlertState','analysis.activitySummary','checkLtmDriftObjects','analysis.analysisHistory','enum','state','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','\x20*\x20*\x20*','2-digit','SECTION','Event\x20History','splice','\x20sensors...','loadHistoryFromState','setPresence','health','level.dimmer','string','status','restlessness','updateBaselineStatus','getStateAsync','automationProposal','mac\x20address','DIRECTION','ERROR','analysis.automation','cogni-living\x20adapter\x20starting\x20(v','date','checkLtmObjects','livingContext','accuweather.','Cogni-Living\x20Alert','isEmergency','uniqueid','normal','events.history_debug_03','setupBriefingScheduler','runBaselineDriftAnalysis','trim','Licht','Rauchmelder','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','ical.0','wetter','subscribeStates','presence','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','getForeignStateAsync','connection','text','notifyWhatsappInstance','Garten','diele','scheduleJob','dailyDigests','INSTALL_TEST','toString','push','Normal','value.humidity','parse','System\x20Mode','common','analysis.alertReason','mode','Gast','\x20presence\x20devices...','yr.','notifyEmailRecipient','values','N/A\x20(Pro\x20Feature)','notifySignalEnabled','Daily\x20Digest\x20Error:\x20','triggerDailyDigest','No\x20Key','ready','analysis.comfortSuggestion','abortExitTimer','analysis.automation.suggestedAction','fire','location','replace','AI\x20Emergency\x20Status','briefingEnabled','createAllObjects','indicator.alarm','history.','last_seen','577782zsRgxp','analysis.feedbackHistory','forecast','1748752EoRcyT','Description','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','LTM.baselineStatus','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','startsWith','Presence\x20Status','comfort','link_quality','notifyWhatsappRecipient','catch','Deviation','role','events.history_debug_01','onMessage','@iobroker/adapter-core','notifyTelegramInstance','type','Gemini\x20Init\x20Error:\x20','startExitTimer','command','.\x20PR√ÑSENZ:\x20','uuid-error','Pattern\x20Detected','scanDevices','Health\x20Notes','licht','Lernphase\x20(','test','Comfort\x20Suggestion','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','javascript.0.script','object','occupancy','analysisTimer','events.history_debug_04','siren','LTM.dailyDigests','K√ºche','genAI','Sending\x20notification:\x20\x22','sendMorningBriefing','modeResetJob','patternDetected','getEnums','sendToAsync','Daily\x20Digest\x20created\x20successfully.','models/gemini-flash-latest','isGracePeriodActive','sensor.window','Fenster/T√ºr','processSensorEvent','weatherunderground.0','sound','manufacturer','openweathermap','getForeignObjectsAsync','checkWifiPresence','NORMAL','updateAnalysisHistory','devices','.\x20PERSONA:\x20','Party','\x20raw\x20events...','Drift\x20Status','5VcLplv','Adapter','includes','deviationFromBaseline','griff','button','some','precip','number','notifyPushoverInstance','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','k√ºche','Analysis\x20Error:\x20','UNREACH','Wohnzimmer','analysis.lastResult','stringify','KALENDER\x20(Termine):\x20','rain','N/A','ltmJob','slice','runGeminiAnalysis','detectionState','analysis.isAlert','from','Schlafzimmer','productname','colormode','uuid','Trigger\x20Digest','event','analysis.history_debug_00','ack','info','Creating\x20Daily\x20Digest\x20from\x20','json','switch.light','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','openweathermap.0','message','suggestion','level','alertReason','\x20sent','setupDriftAnalysisScheduler','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','activity','saveDailyDigests','DUTYCYCLE','Success','\x0aFEEDBACK:\x0a','getObjectAsync','scriptProblem','analysisInterval','\x20Tage)','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','process','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','ltmLtbWindowDays','Starting\x20Autopilot\x20(','stateChange'];a0_0x3440=function(){return _0xfd7fd4;};return a0_0x3440();}