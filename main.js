const a0_0x187488=a0_0xb9a0;(function(_0xeb6ef,_0x27d654){const _0x4a0012=a0_0xb9a0,_0x1c12d0=_0xeb6ef();while(!![]){try{const _0x16c60b=parseInt(_0x4a0012(0x2aa))/0x1*(parseInt(_0x4a0012(0x2b9))/0x2)+-parseInt(_0x4a0012(0x22a))/0x3+-parseInt(_0x4a0012(0x16d))/0x4+-parseInt(_0x4a0012(0x2b2))/0x5+-parseInt(_0x4a0012(0x2ee))/0x6+-parseInt(_0x4a0012(0x282))/0x7*(-parseInt(_0x4a0012(0x15f))/0x8)+parseInt(_0x4a0012(0x15a))/0x9*(parseInt(_0x4a0012(0x229))/0xa);if(_0x16c60b===_0x27d654)break;else _0x1c12d0['push'](_0x1c12d0['shift']());}catch(_0x4cd9fc){_0x1c12d0['push'](_0x1c12d0['shift']());}}}(a0_0x3991,0xd1fd6));const a0_0x5530ed=(function(){let _0x58b0fb=!![];return function(_0xaa89ea,_0x1b9e50){const _0x508abe=_0x58b0fb?function(){if(_0x1b9e50){const _0xb6b8d=_0x1b9e50['apply'](_0xaa89ea,arguments);return _0x1b9e50=null,_0xb6b8d;}}:function(){};return _0x58b0fb=![],_0x508abe;};}()),a0_0xee9038=a0_0x5530ed(this,function(){const _0xf8fe62=a0_0xb9a0;return a0_0xee9038[_0xf8fe62(0x11e)]()[_0xf8fe62(0x209)]('(((.+)+)+)+$')[_0xf8fe62(0x11e)]()[_0xf8fe62(0x28b)](a0_0xee9038)[_0xf8fe62(0x209)](_0xf8fe62(0x338));});a0_0xee9038();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x187488(0x1cf)),schedule=require(a0_0x187488(0x1e3)),{spawn,exec}=require(a0_0x187488(0x180)),path=require(a0_0x187488(0x24d)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x187488(0x27a),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x187488(0x281),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x187488(0x2ac),LTM_DP_DAILY_DIGESTS=a0_0x187488(0x114),LTM_DP_STATUS=a0_0x187488(0x179),LTM_DP_TRIGGER_DIGEST=a0_0x187488(0x303),LTM_DP_BASELINE_STATUS=a0_0x187488(0x22e),LTM_DP_DRIFT_CHANNEL=a0_0x187488(0x330),LTM_DP_DRIFT_STATUS=a0_0x187488(0x1e2),LTM_DP_DRIFT_DETAILS=a0_0x187488(0x23c),LTM_DP_DRIFT_LAST_CHECK=a0_0x187488(0x25c),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x187488(0x24e),'scriptEnabled','update',a0_0x187488(0x236),'lowbat',a0_0x187488(0x239),a0_0x187488(0x341),'maintenance',a0_0x187488(0x1ce),a0_0x187488(0x204),a0_0x187488(0x261),a0_0x187488(0x1ae),a0_0x187488(0x318),'config_pending',a0_0x187488(0x14f),'firmware','reachable',a0_0x187488(0x233)],BAD_NAMES=[a0_0x187488(0x301),a0_0x187488(0x316),'state',a0_0x187488(0x1a2),'value','brightness','on',a0_0x187488(0x207),a0_0x187488(0x32b),a0_0x187488(0x289),a0_0x187488(0x310),'blind','cover',a0_0x187488(0x154),'motion','presence',a0_0x187488(0x284),a0_0x187488(0x24f),a0_0x187488(0x2fd),a0_0x187488(0x26d),a0_0x187488(0x260),a0_0x187488(0x130),a0_0x187488(0x314),'actual_temperature','set_temperature'],ADAPTER_BLACKLIST=[a0_0x187488(0x10b),a0_0x187488(0x31c),'info.',a0_0x187488(0x223),a0_0x187488(0x1d4),a0_0x187488(0x160),a0_0x187488(0x1fd),a0_0x187488(0x1d9),'echarts.',a0_0x187488(0x1d2),a0_0x187488(0x297)],SYSTEM_MODES={'NORMAL':a0_0x187488(0x279),'VACATION':a0_0x187488(0x1b8),'PARTY':a0_0x187488(0x228),'GUEST':a0_0x187488(0x214)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x187488(0x23a)],SYSTEM_MODES[a0_0x187488(0x304)]],PERSONA_MAPPING={'generic':a0_0x187488(0x1df),'senior_aal':a0_0x187488(0x2d1),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x187488(0x2af),'security':a0_0x187488(0x2ca)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x5a8b02){const _0xb81408=a0_0x187488;try{const _0x4ac203=[_0xb81408(0x115),_0xb81408(0x144)];for(const _0x52984e of _0x4ac203){try{const _0x20f30e=await _0x5a8b02['getObjectAsync'](_0x52984e);_0x20f30e&&await _0x5a8b02[_0xb81408(0x2e2)](_0x52984e);}catch(_0x488917){}}}catch(_0x1ea5b7){}}async function initHistory(_0x1feb73){const _0x10c62b=a0_0x187488;try{const _0x3093b1=await _0x1feb73['getStateAsync']('events.history');_0x3093b1&&_0x3093b1[_0x10c62b(0x2f3)]&&(_0x1feb73[_0x10c62b(0x278)]=JSON[_0x10c62b(0x162)](_0x3093b1[_0x10c62b(0x2f3)][_0x10c62b(0x11e)]()));}catch(_0x335fd8){_0x1feb73[_0x10c62b(0x278)]=[];}try{const _0x544aed=await _0x1feb73[_0x10c62b(0x2a5)](_0x10c62b(0x2ab));if(_0x544aed&&_0x544aed[_0x10c62b(0x2f3)])_0x1feb73['analysisHistory']=JSON[_0x10c62b(0x162)](_0x544aed['val']['toString']());}catch(_0x5555c3){_0x1feb73['analysisHistory']=[];}if(_0x1feb73[_0x10c62b(0x278)]&&_0x1feb73['eventHistory']['length']>0x0){_0x1feb73[_0x10c62b(0x263)]['info'](_0x10c62b(0x256)+_0x1feb73[_0x10c62b(0x278)][_0x10c62b(0x27c)]+'\x20events)...');for(let _0x3afc47=_0x1feb73[_0x10c62b(0x278)]['length']-0x1;_0x3afc47>=0x0;_0x3afc47--){const _0x4e137e=_0x1feb73[_0x10c62b(0x278)][_0x3afc47];_0x4e137e&&_0x4e137e['id']!==undefined&&_0x4e137e[_0x10c62b(0x1cb)]!==undefined&&(_0x1feb73['sensorLastValues'][_0x4e137e['id']]=_0x4e137e[_0x10c62b(0x1cb)]);}}}async function initSystemConfig(_0xa9fb1c){const _0x272be3=a0_0x187488;try{const _0x33f5bc=await _0xa9fb1c[_0x272be3(0x10a)](_0x272be3(0x336));_0x33f5bc&&_0x33f5bc[_0x272be3(0x32a)]&&(_0xa9fb1c[_0x272be3(0x13c)]={'latitude':_0x33f5bc['common'][_0x272be3(0x2d4)]||0x0,'longitude':_0x33f5bc['common'][_0x272be3(0x226)]||0x0,'city':_0x33f5bc['common'][_0x272be3(0x1ba)]||''});}catch(_0x33d433){}}async function checkLicense(_0x508c6b,_0x42d863){const _0x41faae=a0_0x187488;if(!_0x42d863)return![];_0x508c6b[_0x41faae(0x1be)]=await getSystemUUID(_0x508c6b);if(_0x42d863===_0x41faae(0x254)||_0x42d863[_0x41faae(0x2e8)](_0x41faae(0x25f)))return!![];return![];}async function getSystemUUID(_0x260dcb){const _0x5e62d8=a0_0x187488;try{const _0x34ddea=await _0x260dcb[_0x5e62d8(0x10a)](_0x5e62d8(0x1c8));if(_0x34ddea&&_0x34ddea['native']&&_0x34ddea[_0x5e62d8(0x331)][_0x5e62d8(0x116)])return _0x34ddea['native'][_0x5e62d8(0x116)];return _0x5e62d8(0x1f2);}catch(_0x187bed){return'uuid-error';}}async function createAllObjects(_0x45b4a9){const _0x118610=a0_0x187488;await checkSystemObjects(_0x45b4a9),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x1b4),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x1ad),'type':'string','role':_0x118610(0x152),'read':!![],'write':![],'def':''},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync']('events.lastEvent',{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x189),'type':_0x118610(0x295),'role':_0x118610(0x19a),'read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x1e6),{'type':'state','common':{'name':_0x118610(0x13e),'type':_0x118610(0x295),'role':_0x118610(0x19a),'read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x1a5),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x153),'type':_0x118610(0x244),'role':_0x118610(0x2d6),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x1a6),{'type':'state','common':{'name':_0x118610(0x342),'type':'boolean','role':_0x118610(0x2d6),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x45b4a9['extendObjectAsync'](_0x118610(0x31b),{'type':_0x118610(0x2c8),'common':{'name':_0x118610(0x22f)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x28c),{'type':'state','common':{'name':'Train\x20Security\x20Model\x20(LSTM)','type':_0x118610(0x244),'role':_0x118610(0x2d6),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x1e1),{'type':'state','common':{'name':_0x118610(0x2a2),'type':_0x118610(0x244),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync']('analysis.training.triggerEnergy',{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x2bf),'type':_0x118610(0x244),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x2f9),{'type':'state','common':{'name':_0x118610(0x17a),'type':_0x118610(0x295),'role':_0x118610(0x152),'read':!![],'write':![],'def':'Idle'},'native':{}}),await _0x45b4a9[_0x118610(0x1af)](_0x118610(0x29b),{'type':_0x118610(0x2c8),'common':{'name':_0x118610(0x2f4)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x1d7),{'type':'state','common':{'name':_0x118610(0x181),'type':_0x118610(0x184),'role':_0x118610(0x1cb),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x2d3),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x337),'type':'string','role':_0x118610(0x322),'read':!![],'write':![],'def':''},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x11a),{'type':'state','common':{'name':_0x118610(0x24a),'type':_0x118610(0x295),'role':_0x118610(0x322),'read':!![],'write':![],'def':''},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x2bb),{'type':_0x118610(0x16e),'common':{'name':'Health\x20Anomaly\x20Detected','type':'boolean','role':_0x118610(0x31d),'read':!![],'write':![],'def':![]},'native':{}}),await _0x45b4a9[_0x118610(0x1af)](_0x118610(0x1cc),{'type':'channel','common':{'name':_0x118610(0x161)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x2bd),{'type':_0x118610(0x16e),'common':{'name':'Building\x20Insulation\x20Score','type':_0x118610(0x295),'role':_0x118610(0x152),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x2b8),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x321),'type':_0x118610(0x295),'role':_0x118610(0x152),'read':!![],'write':![],'def':_0x118610(0x32c)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x1f1),{'type':'state','common':{'name':_0x118610(0x1c1),'type':_0x118610(0x295),'role':_0x118610(0x19a),'read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)]('analysis.isAlert',{'type':_0x118610(0x16e),'common':{'name':'AI\x20Alert\x20Status','type':_0x118610(0x244),'role':_0x118610(0x163),'read':!![],'write':![],'def':![]},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x14c),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x12f),'type':'boolean','role':_0x118610(0x274),'read':!![],'write':![],'def':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x20e),{'type':_0x118610(0x16e),'common':{'name':'Alert\x20Reason','type':_0x118610(0x295),'role':_0x118610(0x292),'read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x307),{'type':'state','common':{'name':_0x118610(0x30a),'type':_0x118610(0x295),'role':_0x118610(0x152),'read':!![],'write':![]},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync']('analysis.deviationFromBaseline',{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x26f),'type':'string','role':_0x118610(0x16e),'read':!![],'write':![],'def':_0x118610(0x32c)},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x14b),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x24b),'type':'string','role':_0x118610(0x152),'read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)]('analysis.comfortSuggestion',{'type':'state','common':{'name':_0x118610(0x1fe),'type':'string','role':_0x118610(0x152),'read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x1af)]('analysis.automation',{'type':'channel','common':{'name':_0x118610(0x286)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x20b),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x2a7),'type':'boolean','role':_0x118610(0x2f0),'read':!![],'write':![],'def':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)]('analysis.automation.description',{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x315),'type':_0x118610(0x295),'role':_0x118610(0x152),'read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x177),{'type':_0x118610(0x16e),'common':{'name':'Action','type':_0x118610(0x295),'role':'text','read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)]('analysis.automation.targetId',{'type':'state','common':{'name':_0x118610(0x24c),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x222),{'type':'state','common':{'name':_0x118610(0x1a8),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)]('analysis.automation.autoApply',{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x19c),'type':_0x118610(0x244),'role':_0x118610(0x32b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x112),{'type':_0x118610(0x16e),'common':{'name':'Trigger\x20Action\x20Now','type':_0x118610(0x244),'role':_0x118610(0x2d6),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x45b4a9[_0x118610(0x238)]('analysis.analysisHistory',{'type':'state','common':{'name':_0x118610(0x185),'type':_0x118610(0x295),'role':_0x118610(0x19a),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x146),{'type':_0x118610(0x16e),'common':{'name':'Feedback\x20Log','type':_0x118610(0x295),'role':_0x118610(0x19a),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x45b4a9[_0x118610(0x1af)](_0x118610(0x2c1),{'type':_0x118610(0x2c8),'common':{'name':_0x118610(0x234)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x230),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x237),'type':_0x118610(0x184),'role':_0x118610(0x1e4),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x1a3),{'type':'state','common':{'name':_0x118610(0x17d),'type':'string','role':_0x118610(0x152),'read':!![],'write':![],'def':_0x118610(0x10f)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x2d5),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x128),'type':_0x118610(0x295),'role':_0x118610(0x152),'read':!![],'write':![],'def':''},'native':{}}),await _0x45b4a9[_0x118610(0x238)]('analysis.health.trendDiagnosis',{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x10c),'type':_0x118610(0x295),'role':'text','read':!![],'write':![],'def':_0x118610(0x32c)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x247),{'type':'state','common':{'name':_0x118610(0x1dd),'type':_0x118610(0x184),'role':_0x118610(0x1cb),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x45b4a9[_0x118610(0x1af)](_0x118610(0x2a4),{'type':'channel','common':{'name':_0x118610(0x11f)},'native':{}}),await _0x45b4a9[_0x118610(0x238)](_0x118610(0x2c3),{'type':_0x118610(0x16e),'common':{'name':'Recorded\x20Motion\x20Sequences','type':_0x118610(0x295),'role':_0x118610(0x19a),'read':!![],'write':![],'def':'[]','desc':'Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training'},'native':{}}),await _0x45b4a9['setObjectNotExistsAsync'](_0x118610(0x1ea),{'type':_0x118610(0x16e),'common':{'name':_0x118610(0x28f),'type':_0x118610(0x295),'role':_0x118610(0x19a),'read':!![],'write':![],'def':'[]','desc':_0x118610(0x283)},'native':{}}),await checkLtmObjects(_0x45b4a9),await checkLtmDriftObjects(_0x45b4a9);}async function checkSystemObjects(_0x373a33){const _0xf2536c=a0_0x187488;await _0x373a33['extendObjectAsync'](_0xf2536c(0x249),{'type':'channel','common':{'name':_0xf2536c(0x18e)},'native':{}}),await _0x373a33[_0xf2536c(0x1af)](SYSTEM_DP_MODE,{'type':'state','common':{'name':'System\x20Mode','type':_0xf2536c(0x295),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0xf2536c(0x311)],'states':{[SYSTEM_MODES[_0xf2536c(0x311)]]:'Normal',[SYSTEM_MODES['VACATION']]:_0xf2536c(0x25d),[SYSTEM_MODES[_0xf2536c(0x23a)]]:_0xf2536c(0x1ed),[SYSTEM_MODES[_0xf2536c(0x304)]]:_0xf2536c(0x16a)}},'native':{}});}async function checkLtmObjects(_0x52be0){const _0x2bc06c=a0_0x187488;await _0x52be0[_0x2bc06c(0x1af)]('LTM',{'type':_0x2bc06c(0x2c8),'common':{'name':_0x2bc06c(0x2fe)},'native':{}}),await _0x52be0[_0x2bc06c(0x1af)](LTM_DP_RAW_LOG,{'type':_0x2bc06c(0x16e),'common':{'name':'Raw\x20Log','type':_0x2bc06c(0x295),'role':_0x2bc06c(0x19a),'read':!![],'write':![]},'native':{}}),await _0x52be0[_0x2bc06c(0x1af)](LTM_DP_DAILY_DIGESTS,{'type':_0x2bc06c(0x16e),'common':{'name':_0x2bc06c(0x1fc),'type':'string','role':_0x2bc06c(0x19a),'read':!![],'write':![]},'native':{}}),await _0x52be0['extendObjectAsync'](LTM_DP_STATUS,{'type':'state','common':{'name':_0x2bc06c(0x31a),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x52be0[_0x2bc06c(0x1af)](LTM_DP_TRIGGER_DIGEST,{'type':_0x2bc06c(0x16e),'common':{'name':_0x2bc06c(0x29c),'type':_0x2bc06c(0x244),'role':_0x2bc06c(0x2d6),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x52be0[_0x2bc06c(0x1af)](LTM_DP_BASELINE_STATUS,{'type':_0x2bc06c(0x16e),'common':{'name':_0x2bc06c(0x132),'type':_0x2bc06c(0x295),'role':_0x2bc06c(0x152),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4c59dc){const _0x212d2b=a0_0x187488;await _0x4c59dc[_0x212d2b(0x1af)](LTM_DP_DRIFT_CHANNEL,{'type':_0x212d2b(0x2c8),'common':{'name':_0x212d2b(0x1b9)},'native':{}}),await _0x4c59dc[_0x212d2b(0x1af)](LTM_DP_DRIFT_STATUS,{'type':_0x212d2b(0x16e),'common':{'name':'Drift\x20Status','type':_0x212d2b(0x295),'role':_0x212d2b(0x16e),'read':!![],'write':![],'def':_0x212d2b(0x32c)},'native':{}}),await _0x4c59dc['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x212d2b(0x16e),'common':{'name':_0x212d2b(0x327),'type':_0x212d2b(0x295),'role':_0x212d2b(0x152),'read':!![],'write':![]},'native':{}}),await _0x4c59dc[_0x212d2b(0x1af)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x212d2b(0x16e),'common':{'name':_0x212d2b(0x308),'type':_0x212d2b(0x184),'role':_0x212d2b(0x322),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x50a57e){const _0x77a7fc=a0_0x187488;try{const _0x2725ea=await _0x50a57e['getStateAsync'](SYSTEM_DP_MODE);_0x2725ea&&_0x2725ea[_0x77a7fc(0x2f3)]&&Object[_0x77a7fc(0x232)](SYSTEM_MODES)[_0x77a7fc(0x290)](_0x2725ea['val'])?_0x50a57e[_0x77a7fc(0x17b)]=_0x2725ea[_0x77a7fc(0x2f3)]:(_0x50a57e[_0x77a7fc(0x17b)]=SYSTEM_MODES[_0x77a7fc(0x311)],await _0x50a57e[_0x77a7fc(0x151)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x77a7fc(0x311)],'ack':!![]}));}catch(_0x4bbaad){_0x50a57e[_0x77a7fc(0x17b)]=SYSTEM_MODES[_0x77a7fc(0x311)];}}async function loadRawEventLog(_0x4a2e45){const _0x35cc22=a0_0x187488;try{const _0x4c458c=await _0x4a2e45[_0x35cc22(0x2a5)](LTM_DP_RAW_LOG);if(_0x4c458c&&_0x4c458c['val'])_0x4a2e45[_0x35cc22(0x203)]=JSON[_0x35cc22(0x162)](_0x4c458c[_0x35cc22(0x2f3)]);}catch(_0x216aa0){_0x4a2e45[_0x35cc22(0x203)]=[];}}async function saveRawEventLog(_0x989b9b){const _0x4615a7=a0_0x187488;_0x989b9b[_0x4615a7(0x203)]['length']>RAW_LOG_MAX_SIZE&&_0x989b9b[_0x4615a7(0x203)][_0x4615a7(0x2b6)](0x0,_0x989b9b['rawEventLog'][_0x4615a7(0x27c)]-RAW_LOG_MAX_SIZE),await _0x989b9b[_0x4615a7(0x151)](LTM_DP_RAW_LOG,{'val':JSON[_0x4615a7(0x272)](_0x989b9b[_0x4615a7(0x203)]),'ack':!![]});}function a0_0xb9a0(_0xcce5a8,_0x48455d){const _0x2bf05e=a0_0x3991();return a0_0xb9a0=function(_0xee9038,_0x5530ed){_0xee9038=_0xee9038-0x105;let _0x399165=_0x2bf05e[_0xee9038];return _0x399165;},a0_0xb9a0(_0xcce5a8,_0x48455d);}async function loadDailyDigests(_0x1ff9b9){const _0x545b35=a0_0x187488;try{const _0x375fd9=await _0x1ff9b9[_0x545b35(0x2a5)](LTM_DP_DAILY_DIGESTS);if(_0x375fd9&&_0x375fd9['val'])_0x1ff9b9[_0x545b35(0x14d)]=JSON[_0x545b35(0x162)](_0x375fd9['val']);}catch(_0x4be7dd){_0x1ff9b9[_0x545b35(0x14d)]=[];}await updateBaselineStatus(_0x1ff9b9);}async function saveDailyDigests(_0x5d6637,_0x2504cb=!![]){const _0x3b62af=a0_0x187488,_0x5e3c8c=_0x5d6637[_0x3b62af(0x105)][_0x3b62af(0x1f5)]||0x3c;_0x5d6637['dailyDigests']['length']>_0x5e3c8c&&_0x5d6637['dailyDigests'][_0x3b62af(0x2b6)](0x0,_0x5d6637['dailyDigests']['length']-_0x5e3c8c);await _0x5d6637[_0x3b62af(0x151)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x3b62af(0x272)](_0x5d6637['dailyDigests']),'ack':!![]});if(_0x2504cb)await updateBaselineStatus(_0x5d6637);}async function updateAnalysisHistory(_0x5297c0,_0x29df97){const _0x3c6f70=a0_0x187488;_0x5297c0[_0x3c6f70(0x188)]['unshift'](_0x29df97);if(_0x5297c0['analysisHistory'][_0x3c6f70(0x27c)]>ANALYSIS_HISTORY_MAX_SIZE)_0x5297c0[_0x3c6f70(0x188)]['pop']();await _0x5297c0[_0x3c6f70(0x151)](_0x3c6f70(0x2ab),{'val':JSON[_0x3c6f70(0x272)](_0x5297c0[_0x3c6f70(0x188)]),'ack':!![]});}async function updateBaselineStatus(_0x542562){const _0x5b88a4=a0_0x187488;if(!_0x542562['isProVersion']){await _0x542562[_0x5b88a4(0x151)](LTM_DP_BASELINE_STATUS,{'val':_0x5b88a4(0x27d),'ack':!![]});return;}const _0x21677f=_0x542562[_0x5b88a4(0x14d)][_0x5b88a4(0x27c)]>=(_0x542562['config'][_0x5b88a4(0x1dc)]||0x7)?_0x5b88a4(0x133)+_0x542562[_0x5b88a4(0x14d)][_0x5b88a4(0x27c)]+_0x5b88a4(0x127):_0x5b88a4(0x2c2)+_0x542562[_0x5b88a4(0x14d)]['length']+'/'+(_0x542562[_0x5b88a4(0x105)][_0x5b88a4(0x1dc)]||0x7)+')';await _0x542562[_0x5b88a4(0x151)](LTM_DP_BASELINE_STATUS,{'val':_0x21677f,'ack':!![]});}async function initSensorSubscriptions(_0x4a697d){const _0x3067f9=a0_0x187488,_0x48a561=_0x4a697d[_0x3067f9(0x105)][_0x3067f9(0x120)];if(_0x48a561&&_0x48a561[_0x3067f9(0x27c)]>0x0){_0x4a697d[_0x3067f9(0x263)][_0x3067f9(0x2a1)](_0x3067f9(0x16c)+_0x48a561[_0x3067f9(0x27c)]+_0x3067f9(0x1e5));for(const _0x3af26b of _0x48a561){if(_0x3af26b['id']){await _0x4a697d[_0x3067f9(0x1fb)](_0x3af26b['id']);try{const _0x44caaa=await _0x4a697d[_0x3067f9(0x2a3)](_0x3af26b['id']);if(_0x44caaa)_0x4a697d['sensorLastValues'][_0x3af26b['id']]=_0x44caaa[_0x3067f9(0x2f3)];}catch(_0x46b3eb){}}}}}async function initPresenceSubscriptions(_0x19997a){const _0xf8da5=a0_0x187488,_0x2d4c4=_0x19997a[_0xf8da5(0x105)]['presenceDevices']||[];if(_0x2d4c4['length']>0x0){_0x19997a['log'][_0xf8da5(0x2a1)](_0xf8da5(0x16c)+_0x2d4c4['length']+_0xf8da5(0x1aa));for(const _0x21b039 of _0x2d4c4){await _0x19997a['subscribeForeignStatesAsync'](_0x21b039);}try{await checkWifiPresence(_0x19997a);}catch(_0x2277e2){}}}async function getWeatherContext(_0xecc3f3){const _0x5e9baa=a0_0x187488;try{if(!_0xecc3f3[_0x5e9baa(0x105)][_0x5e9baa(0x140)])return'Wetter:\x20Deaktiviert';let _0x5538c9='';const _0x385d34=_0xecc3f3[_0x5e9baa(0x105)][_0x5e9baa(0x255)];if(_0x385d34)try{if(_0x385d34[_0x5e9baa(0x290)](_0x5e9baa(0x200))){const _0x18323e=await _0xecc3f3[_0x5e9baa(0x2a3)](_0x385d34+_0x5e9baa(0x276));if(_0x18323e&&_0x18323e[_0x5e9baa(0x2f3)])_0x5538c9=_0x18323e[_0x5e9baa(0x2f3)];}else{if(_0x385d34[_0x5e9baa(0x290)]('daswetter')){const _0x34f8c6=await _0xecc3f3[_0x5e9baa(0x2a3)](_0x385d34+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0x34f8c6&&_0x34f8c6[_0x5e9baa(0x2f3)])_0x5538c9=_0x34f8c6['val'];}else{if(_0x385d34['includes'](_0x5e9baa(0x2b5))){const _0x1b0577=await _0xecc3f3[_0x5e9baa(0x2a3)](_0x385d34+'.forecast.current.state');if(_0x1b0577&&_0x1b0577['val'])_0x5538c9=_0x1b0577[_0x5e9baa(0x2f3)];}}}}catch(_0x7097b0){}if(!_0x5538c9){const _0x5467b9=[_0x5e9baa(0x241),_0x5e9baa(0x2fa),_0x5e9baa(0x1ee),_0x5e9baa(0x2e1)];for(const _0x7a9701 of _0x5467b9){try{const _0x2fb7d0=await _0xecc3f3[_0x5e9baa(0x10a)](_0x7a9701);if(_0x2fb7d0){if(_0x7a9701[_0x5e9baa(0x290)](_0x5e9baa(0x200))){const _0x24fded=await _0xecc3f3[_0x5e9baa(0x2a3)](_0x7a9701+_0x5e9baa(0x276));if(_0x24fded&&_0x24fded['val']){_0x5538c9=_0x24fded[_0x5e9baa(0x2f3)];break;}}}}catch(_0x7b7a12){}}}return _0x5538c9?_0x5e9baa(0x217)+_0x5538c9:_0x5e9baa(0x2b0);}catch(_0x4a3f2a){return'WETTER\x20ERROR:\x20'+_0x4a3f2a[_0x5e9baa(0x113)];}}async function getCalendarContext(_0x3381ad){const _0x6f3dd2=a0_0x187488;try{if(!_0x3381ad[_0x6f3dd2(0x105)][_0x6f3dd2(0x306)])return _0x6f3dd2(0x111);let _0x3ee15c=_0x3381ad['config'][_0x6f3dd2(0x134)]||_0x6f3dd2(0x26a),_0x48e098=_0x3381ad[_0x6f3dd2(0x105)]['calendarSelection']||[];if(typeof _0x48e098==='string')_0x48e098=_0x48e098[_0x6f3dd2(0x195)](',');try{const _0x5b5f6e=await _0x3381ad[_0x6f3dd2(0x2a3)](_0x3ee15c+'.data.table');if(_0x5b5f6e&&_0x5b5f6e['val']){let _0xcc96e2=tryParse(_0x5b5f6e[_0x6f3dd2(0x2f3)]);if(_0xcc96e2&&Array[_0x6f3dd2(0x2cf)](_0xcc96e2)){if(_0x48e098['length']>0x0)_0xcc96e2=_0xcc96e2['filter'](_0x4b0cf8=>_0x48e098[_0x6f3dd2(0x290)](_0x4b0cf8[_0x6f3dd2(0x12a)]||''));else return _0x6f3dd2(0x325);if(_0xcc96e2[_0x6f3dd2(0x27c)]>0x0){const _0x3d3794=_0xcc96e2[_0x6f3dd2(0x1bc)](0x0,0x3)[_0x6f3dd2(0x20f)](_0x421efb=>{const _0x30f470=_0x6f3dd2;let _0x456c82=_0x421efb[_0x30f470(0x322)];if(_0x421efb[_0x30f470(0x2ad)])_0x456c82+='\x20'+_0x421efb[_0x30f470(0x2ad)];return _0x456c82+':\x20'+_0x421efb[_0x30f470(0x124)]+'\x20('+_0x421efb[_0x30f470(0x12a)]+')';});return _0x6f3dd2(0x1d3)+_0x3d3794[_0x6f3dd2(0x225)]('\x20|\x20');}else return _0x6f3dd2(0x11c);}}}catch(_0x25802d){_0x3381ad[_0x6f3dd2(0x263)]['warn']('Error\x20reading\x20calendar\x20table:\x20'+_0x25802d['message']);}return _0x6f3dd2(0x1f6);}catch(_0x8dc680){return _0x6f3dd2(0x2a0)+_0x8dc680[_0x6f3dd2(0x113)];}}async function getCalendarNames(_0xa45d4b,_0x2e512b){const _0x2a1718=a0_0x187488;try{const _0x3bf696=await _0xa45d4b[_0x2a1718(0x2a3)](_0x2e512b+_0x2a1718(0x265));if(_0x3bf696&&_0x3bf696[_0x2a1718(0x2f3)]){const _0x150276=tryParse(_0x3bf696[_0x2a1718(0x2f3)]);if(_0x150276&&Array[_0x2a1718(0x2cf)](_0x150276)){const _0x499fde=[...new Set(_0x150276[_0x2a1718(0x20f)](_0x42a79e=>_0x42a79e[_0x2a1718(0x12a)])[_0x2a1718(0x2dc)](Boolean))];return _0x499fde[_0x2a1718(0x26e)]();}}return[];}catch(_0x3b7373){return _0xa45d4b['log'][_0x2a1718(0x1ce)](_0x2a1718(0x309)+_0x3b7373[_0x2a1718(0x113)]),[];}}async function checkWifiPresence(_0x22ac25){const _0x2c64b2=a0_0x187488;try{const _0x9bbfa5=_0x22ac25[_0x2c64b2(0x105)][_0x2c64b2(0x20a)]||[];let _0x5a3e6d=![];const _0x1072f4=[];for(const _0x409f21 of _0x9bbfa5){try{const _0x295ae4=await _0x22ac25[_0x2c64b2(0x2a3)](_0x409f21);if(_0x295ae4&&(_0x295ae4[_0x2c64b2(0x2f3)]===!![]||_0x295ae4[_0x2c64b2(0x2f3)]===_0x2c64b2(0x15d)||_0x295ae4[_0x2c64b2(0x2f3)]===0x1)){_0x5a3e6d=!![];const _0xc05d2d=await _0x22ac25[_0x2c64b2(0x10a)](_0x409f21);let _0x4ac391=_0x409f21;_0xc05d2d&&_0xc05d2d[_0x2c64b2(0x32a)]&&_0xc05d2d['common'][_0x2c64b2(0x22c)]&&(_0x4ac391=typeof _0xc05d2d[_0x2c64b2(0x32a)][_0x2c64b2(0x22c)]==='object'?_0xc05d2d[_0x2c64b2(0x32a)][_0x2c64b2(0x22c)]['de']||_0xc05d2d[_0x2c64b2(0x32a)][_0x2c64b2(0x22c)]['en']:_0xc05d2d[_0x2c64b2(0x32a)]['name']),_0x1072f4[_0x2c64b2(0x18f)](_0x4ac391);}}catch(_0x22c5a9){}}return await _0x22ac25[_0x2c64b2(0x151)](_0x2c64b2(0x1b4),{'val':_0x1072f4['join'](',\x20'),'ack':!![]}),_0x5a3e6d&&(_0x22ac25[_0x2c64b2(0x2da)]&&(_0x22ac25[_0x2c64b2(0x263)]['info'](_0x2c64b2(0x2eb)),abortExitTimer(_0x22ac25)),!_0x22ac25[_0x2c64b2(0x1c9)]&&_0x22ac25[_0x2c64b2(0x17b)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x22ac25,!![])),_0x5a3e6d;}catch(_0x3c4cf5){return _0x22ac25['log'][_0x2c64b2(0x1ce)](_0x2c64b2(0x305)+_0x3c4cf5[_0x2c64b2(0x113)]),![];}}function startExitTimer(_0x2a5aa0){const _0x3e0926=a0_0x187488;abortExitTimer(_0x2a5aa0),_0x2a5aa0['isGracePeriodActive']=!![],_0x2a5aa0[_0x3e0926(0x121)]=setTimeout(()=>{const _0x1e8961=_0x3e0926;_0x2a5aa0[_0x1e8961(0x2f5)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x2a5aa0[_0x3e0926(0x2da)]=setTimeout(()=>{const _0x4ddcca=_0x3e0926;setPresence(_0x2a5aa0,![]),_0x2a5aa0[_0x4ddcca(0x2da)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x100349){const _0x50a3ee=a0_0x187488;if(_0x100349[_0x50a3ee(0x2da)])clearTimeout(_0x100349[_0x50a3ee(0x2da)]);if(_0x100349[_0x50a3ee(0x121)])clearTimeout(_0x100349['exitGraceTimer']);_0x100349[_0x50a3ee(0x2da)]=null,_0x100349[_0x50a3ee(0x121)]=null,_0x100349[_0x50a3ee(0x2f5)]=![];}async function setPresence(_0x3d7ebd,_0x2937c3){const _0x40c173=a0_0x187488;if(_0x3d7ebd[_0x40c173(0x1c9)]===_0x2937c3)return;_0x3d7ebd[_0x40c173(0x1c9)]=_0x2937c3,await _0x3d7ebd[_0x40c173(0x151)](_0x40c173(0x1de),{'val':_0x2937c3,'ack':!![]});}async function saveFeedback(_0x2a857d,_0x400642){const _0x303e22=a0_0x187488;_0x2a857d[_0x303e22(0x263)][_0x303e22(0x2a1)](_0x303e22(0x251)+JSON[_0x303e22(0x272)](_0x400642));}async function runBaselineDriftAnalysis(_0x208360){const _0x5bc5c1=a0_0x187488;if(!_0x208360[_0x5bc5c1(0x2ef)]||!_0x208360[_0x5bc5c1(0x2b1)])return;const _0x30a2d9=_0x208360[_0x5bc5c1(0x105)][_0x5bc5c1(0x156)]||0xe;if(_0x208360[_0x5bc5c1(0x14d)]['length']<_0x30a2d9+(_0x208360['config'][_0x5bc5c1(0x1dc)]||0x7)){await _0x208360[_0x5bc5c1(0x151)](LTM_DP_DRIFT_STATUS,{'val':_0x5bc5c1(0x13b),'ack':!![]});return;}const _0xb57770=_0x208360[_0x5bc5c1(0x14d)][_0x5bc5c1(0x1bc)](-_0x30a2d9),_0x8ffd7b=_0x208360['dailyDigests'][_0x5bc5c1(0x1bc)](0x0,_0x208360[_0x5bc5c1(0x14d)][_0x5bc5c1(0x27c)]-_0x30a2d9),_0x2d7c0e=_0x5bc5c1(0x138)+JSON['stringify'](_0x8ffd7b)+_0x5bc5c1(0x18b)+JSON['stringify'](_0xb57770);try{const _0x5a4f5a=await _0x208360[_0x5bc5c1(0x2b1)][_0x5bc5c1(0x1e9)](_0x2d7c0e),_0x38e375=JSON[_0x5bc5c1(0x162)](_0x5a4f5a[_0x5bc5c1(0x2d9)]['text']()[_0x5bc5c1(0x1ab)](/```json|```/g,'')[_0x5bc5c1(0x202)]());_0x38e375['baselineDrift']&&(await _0x208360[_0x5bc5c1(0x151)](LTM_DP_DRIFT_STATUS,{'val':_0x38e375['baselineDrift'],'ack':!![]}),await _0x208360['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x38e375[_0x5bc5c1(0x32e)],'ack':!![]}),await _0x208360[_0x5bc5c1(0x151)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x5bc5c1(0x1b7)](),'ack':!![]}));}catch(_0x44a7f9){}}function setupLtmScheduler(_0x2ddb6a){const _0x10b4fa=a0_0x187488;try{if(_0x2ddb6a['ltmJob'])_0x2ddb6a[_0x10b4fa(0x1c0)][_0x10b4fa(0x14a)]();if(!_0x2ddb6a['isProVersion']){_0x2ddb6a[_0x10b4fa(0x151)](LTM_DP_STATUS,{'val':_0x10b4fa(0x27d),'ack':!![]});return;}_0x2ddb6a[_0x10b4fa(0x1c0)]=schedule[_0x10b4fa(0x1ec)](LTM_SCHEDULE,()=>createDailyDigest(_0x2ddb6a));}catch(_0x5a5dbe){_0x2ddb6a[_0x10b4fa(0x263)][_0x10b4fa(0x1ce)]('LTM\x20Sched\x20Error:\x20'+_0x5a5dbe[_0x10b4fa(0x113)]);}}function setupModeResetScheduler(_0x4b6ada){const _0x163e71=a0_0x187488;try{if(_0x4b6ada[_0x163e71(0x31e)])_0x4b6ada[_0x163e71(0x31e)][_0x163e71(0x14a)]();_0x4b6ada[_0x163e71(0x31e)]=schedule[_0x163e71(0x1ec)](MODE_RESET_SCHEDULE,async()=>{const _0x1b5cbb=_0x163e71;await loadSystemMode(_0x4b6ada),AUTO_RESET_MODES['includes'](_0x4b6ada[_0x1b5cbb(0x17b)])&&await _0x4b6ada['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1b5cbb(0x311)],'ack':![]});});}catch(_0x38ce8b){_0x4b6ada[_0x163e71(0x263)]['error'](_0x163e71(0x1c3)+_0x38ce8b[_0x163e71(0x113)]);}}function setupDriftAnalysisScheduler(_0x13bfef){const _0x472ffa=a0_0x187488;try{if(_0x13bfef['driftAnalysisTimer'])clearInterval(_0x13bfef['driftAnalysisTimer']);if(!_0x13bfef[_0x472ffa(0x2ef)])return;_0x13bfef[_0x472ffa(0x149)]=setInterval(()=>runBaselineDriftAnalysis(_0x13bfef),(_0x13bfef['config'][_0x472ffa(0x288)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x13bfef),0x1388);}catch(_0xd50795){_0x13bfef[_0x472ffa(0x263)]['error'](_0x472ffa(0x33a)+_0xd50795[_0x472ffa(0x113)]);}}function setupBriefingScheduler(_0x189d4f){const _0x458f97=a0_0x187488;try{if(_0x189d4f[_0x458f97(0x2e6)])_0x189d4f[_0x458f97(0x2e6)][_0x458f97(0x14a)]();if(!_0x189d4f[_0x458f97(0x105)][_0x458f97(0x1cd)])return;const _0x1d8b2a=(_0x189d4f[_0x458f97(0x105)][_0x458f97(0x2e9)]||_0x458f97(0x2be))[_0x458f97(0x195)](':'),_0x4a2f17=parseInt(_0x1d8b2a[0x0])||0x8,_0x450f4d=parseInt(_0x1d8b2a[0x1])||0x0,_0x3c5f84=_0x450f4d+'\x20'+_0x4a2f17+_0x458f97(0x30f);_0x189d4f[_0x458f97(0x263)][_0x458f97(0x2a1)](_0x458f97(0x293)+_0x4a2f17+':'+(_0x450f4d<0xa?'0'+_0x450f4d:_0x450f4d)),_0x189d4f[_0x458f97(0x2e6)]=schedule['scheduleJob'](_0x3c5f84,()=>{sendMorningBriefing(_0x189d4f);});}catch(_0x35b69f){_0x189d4f[_0x458f97(0x263)][_0x458f97(0x1ce)]('Briefing\x20Sched\x20Error:\x20'+_0x35b69f[_0x458f97(0x113)]);}}async function sendNotification(_0x529c92,_0x2c063a,_0x544c34=![],_0x1c2625=![]){const _0x36a309=a0_0x187488;_0x529c92[_0x36a309(0x263)][_0x36a309(0x2a1)]((_0x544c34?'[TEST]\x20':'')+_0x36a309(0x137)+_0x2c063a+'\x22');const _0x10b10a=_0x529c92['config'];let _0x54f648=0x0;if(_0x10b10a[_0x36a309(0x211)]){let _0x47d7f6={};(_0x2c063a[_0x36a309(0x290)](_0x36a309(0x12b))||_0x1c2625)&&(_0x47d7f6={'reply_markup':{'inline_keyboard':[[{'text':_0x36a309(0x1a0),'callback_data':_0x36a309(0x323)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x36a309(0x328)}]]}}),await _0x529c92[_0x36a309(0x2b3)](_0x10b10a[_0x36a309(0x269)],_0x36a309(0x30e),{'text':_0x2c063a,'user':_0x10b10a[_0x36a309(0x271)],..._0x47d7f6}),_0x54f648++;}if(_0x10b10a[_0x36a309(0x187)]){let _0x4227bc={'message':_0x2c063a,'title':_0x1c2625?_0x36a309(0x206):'Cogni-Living','priority':_0x1c2625?0x2:0x1,'device':_0x10b10a[_0x36a309(0x1b2)]};_0x1c2625&&(_0x4227bc['retry']=0x1e,_0x4227bc[_0x36a309(0x28d)]=0xe10,_0x4227bc['sound']=_0x36a309(0x23e)),await _0x529c92[_0x36a309(0x2b3)](_0x10b10a[_0x36a309(0x1bd)],_0x36a309(0x30e),_0x4227bc),_0x54f648++;}return _0x10b10a['notifyEmailEnabled']&&(await _0x529c92['sendToAsync'](_0x10b10a[_0x36a309(0x110)],'send',{'text':_0x2c063a,'to':_0x10b10a[_0x36a309(0x23b)]}),_0x54f648++),_0x54f648;}async function setupTelegramListener(_0x30d1e0){const _0x848b23=a0_0x187488,_0x3b8e91=_0x30d1e0[_0x848b23(0x105)][_0x848b23(0x269)];_0x30d1e0[_0x848b23(0x105)][_0x848b23(0x211)]&&_0x3b8e91&&(_0x30d1e0[_0x848b23(0x263)][_0x848b23(0x2a1)](_0x848b23(0x2cb)+_0x3b8e91+_0x848b23(0x1e7)),await _0x30d1e0[_0x848b23(0x1fb)](_0x3b8e91+_0x848b23(0x213)));}function a0_0x3991(){const _0x13a1e5=['triggerDailyDigest','temp','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','No\x20instance','system.meta.uuid','isPresent','setState','value','analysis.energy','briefingEnabled','error','@google/generative-ai','alertReason','enum.rooms.*','javascript.','KALENDER:\x20','history.','[PYTHON\x20ERR]\x20','bewegung','analysis.security.lastScore','close','flot.','generic','light','minDaysForBaseline','Trend\x20Value\x20(%)','system.isPresent','Analysiere\x20ausgewogen.','analysis.training.triggerEnergy','analysis.training.triggerHealth','LTM.driftAnalysis.baselineDrift','node-schedule','value.health','\x20sensors...','events.history','\x20for\x20interactive\x20buttons...','âœ…\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20','generateContent','LTM.trainingData.thermodynamics','rollladen','scheduleJob','Party','weatherunderground.0','ðŸƒ\x20Triggering\x20Energy\x20Training...','No\x20module\x20named\x20pip','analysis.lastResult','uuid-not-found','.\x20NOTFALL-KONTEXT:\x20','genAI','ltmLtbWindowDays','KALENDER:\x20Keine\x20Daten','.\x20WETTER:\x20','details','klima','submitFeedback','subscribeForeignStatesAsync','Daily\x20Digests','icons-mfd.','Comfort\x20Suggestion','_score','accuweather','\x20=\x20','trim','rawEventLog','fault','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','ðŸš¨\x20EMERGENCY','off','communicate.request','search','presenceDevices','analysis.automation.patternDetected','insulation','Could\x20not\x20kill\x20Python\x20process:\x20','analysis.alertReason','map','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','notifyTelegramEnabled','licenseKey','.communicate.request','guest','triggerBriefing','writable','WETTER:\x20','Success:\x20','window','getLtmData','toFixed','enum','dimmer','TRAIN_SECURITY','analysisTimer','.forecast.current.temperature','endsWith','analysis.automation.targetValue','vis.','prÃ¤senz','join','longitude','getMonth','party','90ECvsGw','1560867bnPdto','cogni-living','name','analysis.automation.description','LTM.baselineStatus','AI\x20Training\x20Control','analysis.health.sleepScore','Anwesend','values','link_quality','Health\x20&\x20Sleep\x20Analysis','events.lastEvent','unreach','Sleep\x20Score\x20(0-100)','setObjectNotExistsAsync','rssi','PARTY','notifyEmailRecipient','LTM.driftAnalysis.driftDetails','isAlert','siren','schalter','Kein\x20API\x20Key\x20eingegeben.','accuweather.0','timestamp','sendTo','boolean','âš ï¸\x20ALARM:\x20','ready','analysis.health.trendValue',').\x20Saving\x20to\x20Training\x20Data.','system','Health\x20Last\x20Check','Comfort\x20Summary','Target\x20ID','path','scriptProblem','temperature','Kein\x20API\x20Key!','Feedback\x20saved:\x20','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','licht','TEST-PRO-KEY','weatherInstance','Restoring\x20sensor\x20cache\x20from\x20history\x20(','onStateChange','lastCheck','âŒ\x20Energy\x20Training\x20Failed:\x20','Failed\x20to\x20send\x20to\x20Python:\x20','members','LTM.driftAnalysis.lastCheck','Urlaub','.\x20ZUSATZ:\x20','PRO-','energy','working','getGenerativeModel','log','stdin','.data.table','Unknown\x20error','.\x20KONTEXT:\x20','unshift','notifyTelegramInstance','ical.0','\x20days\x20of\x20activity\x20data\x20to\x20Python...','âœ…\x20PIP\x20bootstrapped.\x20Retrying\x20installation...','power','sort','Deviation','Error:\x20','notifyTelegramRecipient','stringify','getCalendarNames','indicator.alarm.fire','[RESULT]','.Summary.Current','.\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x20','eventHistory','normal','models/gemini-flash-latest','getTime','length','Deaktiviert\x20(Pro-Feature)','setHours','PONG','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','0\x204\x20*\x20*\x20*','7956452PDWpxX','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','occupancy','motion','Automation\x20Proposals','sensorLastValues','ltmDriftCheckIntervalHours','position','sensor','constructor','analysis.training.triggerSecurity','expire','getFullYear','Thermodynamic\x20Data\x20Points','includes','âŒ\x20AUTO-FIX\x20FAILED:\x20','text.alarm','Scheduling\x20Morning\x20Briefing\x20for\x20','write','string','some','simple-api.','getForeignObjectsAsync','âœ…\x20SUCCESS.\x20Dependencies\x20installed.','role','analysis.security','Trigger\x20Digest','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','.\x20ANWESENHEITS_STATUS:\x20','activityLevel','KALENDER\x20ERROR:\x20','info','Train\x20Health\x20Model\x20(IsoForest)','getForeignStateAsync','LTM.trainingData','getStateAsync','inactivityThresholdHours','Pattern\x20Detected','ENERGY_TRAIN_RESULT','stdout','1480nZaaqm','analysis.analysisHistory','LTM.rawEventLog','time','.forecast.current.temp','Fokus\x20auf\x20Komfort.','WETTER:\x20Keine\x20Daten\x20gefunden','geminiModel','4622175AmLbol','sendToAsync','presence','openweathermap','splice','heizung','analysis.energy.heatingScore','574ZpNzFr','telegram','analysis.health.isAnomaly','heating','analysis.energy.insulationScore','08:00','Train\x20Energy\x20Model\x20(Regression)','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','analysis.health','Lernphase\x20(','LTM.trainingData.sequences','ðŸ\x20Python\x20Pong\x20received!','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','.\x20ANWESENDE_GERAETE:\x20','targetValue','channel','automation.triggerAction','PRIORITÃ„T:\x20Sicherheit.','ðŸ“¡\x20Hooking\x20into\x20','analysis.isAlert','weather','toLocaleTimeString','isArray','blind','PRIORITÃ„T:\x20Gesundheit/AAL.','Activity-Level','analysis.security.lastCheck','latitude','analysis.health.notes','button','object','Error\x20launching\x20Python\x20service:\x20','response','exitTimer','weatherunderground','filter','kill','forEach','SECURITY_RESULT','enum.functions.*','openweathermap.0','delObjectAsync','getHours','...','âœ…\x20AUTO-FIX\x20SUCCESS.','briefingJob','isEmergency','startsWith','briefingTime','Guardian:\x20Sending\x20','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','ANALYZE_HEALTH','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','8983140RLdZHi','isProVersion','indicator','tÃ¼r','\x20events','val','Live\x20Security\x20Monitor','isGracePeriodActive','\x20hours.\x20Potential\x20incapacitation.','Say\x20Hello','command','analysis.training.status','daswetter.0','âŒ\x20CRITICAL:\x20Self-healing\x20failed.','type','humidity','LTM','\x27\x20not\x20in\x20allowed\x20list)','TRAIN_ENERGY','targetposition','Keine\x20Details.','LTM.triggerDailyDigest','GUEST','Error\x20checking\x20WiFi:\x20','useCalendar','analysis.activitySummary','Last\x20Check','getCalendarNames\x20Error:\x20','Activity\x20Summary','from','analysisInterval','custom','send','\x20*\x20*\x20*','shutter','NORMAL','ðŸ©º\x20Triggering\x20Health\x20Analysis\x20on\x20new\x20Digest...','cogni-living\x20adapter\x20starting\x20(v','valve','Description','currentposition','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','stick_unreach','logDuplicates','Processing\x20Status','analysis.training','admin.','indicator.health','modeResetJob','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','Heating\x20Rate\x20Score','date','COGNI_CONFIRM_OK','[LOG]','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','kontakt','Drift\x20Details','COGNI_REQUEST_CALL','Error\x20in\x20onMessage\x20command\x20','common','switch','N/A','callback','driftDetails','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','LTM.driftAnalysis','native','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','find','summary','system.config','Last\x20Check\x20Time','(((.+)+)+)+$','\x20(Length:\x20','Drift\x20Sched\x20Error:\x20','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','ðŸ›¡ï¸\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','automationProposal','shift','Bibliotheken\x20nicht\x20gefunden','ðŸ\x20Guardian\x20Diagnosis\x20(','connection','Trigger\x20Briefing\x20(Test)','config','aiPersona','subscribeStates','ANALYZE_SEQUENCE','toLocaleString','getForeignObjectAsync','system.','Trend\x20Diagnosis\x20(Python)','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','ðŸ©º\x20HEALTH\x20WARNING:\x20','none','notifyEmailInstance','Kalender:\x20Deaktiviert','analysis.automation.triggerAction','message','LTM.dailyDigests','analysis.history_debug_00','uuid','toISOString','catch','testContext','analysis.health.lastCheck','warn','KALENDER:\x20Keine\x20relevanten\x20Termine','application/json','toString','Training\x20Data\x20Sets','devices','exitGraceTimer','testApiKey','inactivityMonitoringEnabled','event','Adapter','lastAlertState','\x20Tage)','Health\x20Notes','analysis.automation.autoApply','_calName','Alarm','unload','health','python3\x20-m\x20pip\x20install\x20-r\x20\x22','AI\x20Emergency\x20Status','setpoint','lampe','Baseline\x20Status','Aktiv\x20(','calendarInstance','system.mode','Briefing\x20Error:\x20','Sending\x20notification:\x20\x22','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Started\x20at\x20','simulateButler','N/A\x20(Learning)','systemConfig','substring','Event\x20History','HEALTH_TRAIN_RESULT','useWeather','Generating\x20Morning\x20Briefing...','unknown','feedbackHistory','events.history_debug_00','analysis.automation.targetId','analysis.feedbackHistory','dependencyInstallInProgress','daswetter','driftAnalysisTimer','cancel','analysis.comfortSummary','analysis.isEmergency','dailyDigests','geminiApiKey','dutycycle','lights','setStateAsync','text','Trigger\x20Analysis','status','âœ…\x20HEALTH\x20MODEL\x20TRAINED!\x20','ltmStbWindowDays','Training\x20Error:\x20','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','selectedFunctionIds','3839733DmMZFc','\x20(Threshold:\x20','door','online','âŒ\x20Installation\x20failed:\x20','8YFGlZn','material.','Energy\x20Intelligence','parse','indicator.alarm','round','temperatur','scanDevices','location','ABWESEND','main','Gast','doors','Subscribing\x20to\x20','6396388zCZqkc','state','setForeignStateAsync','pop','onMessage','targetId','getEnums','\x20(Value\x20is\x20falsy:\x20','pythonProcess','description','analysis.automation.suggestedAction','\x22\x20--break-system-packages','LTM.processingStatus','Training\x20Status','currentSystemMode','Failed:\x20','Restlessness\x20Level','fenster','\x20AUFGABE:\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken.\x202.\x20Analysiere\x20auf\x20Komfort.\x20FORMAT\x20(JSON\x20Only):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','child_process','Last\x20Anomaly\x20Score','data','UngewÃ¶hnliches\x20Bewegungsmuster\x20erkannt!\x20(Score:\x20','number','Logbook','âœ…\x20ENERGY\x20MODEL\x20TRAINED!','notifyPushoverEnabled','analysisHistory','Last\x20raw\x20event','Unknown','\x0aSTB:\x20','toLowerCase','outdoorSensorId','System\x20Status\x20&\x20Control','push','payload','loc','Energy\x20Train\x20Error:\x20','[PYTHON]\x20','analysis.health.trendDiagnosis','split','python3','KI-Modell\x20nicht\x20initialisiert','detected','):\x20','json','.Current.Temperature','Auto\x20Apply\x20Rule','ðŸŒ…\x20Daily\x20Briefing:\x0a','livingContext','onUnload','âœ…\x20Alles\x20OK\x20(Reset)]','âŒ\x20Training\x20failed:\x20','level','analysis.health.restlessness','Gemini\x20Analysis\x20Error:\x20','analysis.trigger','analysis.triggerBriefing','ðŸ\x20Stopping\x20Python\x20Sidecar...','Target\x20Value','bind','\x20presence\x20devices...','replace','isExit','Who\x20is\x20present?','direction','extendObjectAsync','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','âš ï¸\x20SECURITY\x20ALARM:\x20','notifyPushoverRecipient','apiKey','system.presenceWho','Keiner','\x22\x20--break-system-packages\x20--user','now','vacation','Drift\x20Analysis','city','debug','slice','notifyPushoverInstance','systemUUID','version','ltmJob','Last\x20Result','onReady','Reset\x20Sched\x20Error:\x20'];a0_0x3991=function(){return _0x13a1e5;};return a0_0x3991();}async function handleTelegramResponse(_0x64e643,_0x1c7165){const _0xb3e15d=a0_0x187488;let _0x1ea04e=_0x1c7165;_0x1c7165['startsWith']('[')&&(_0x1ea04e=_0x1c7165[_0xb3e15d(0x13d)](_0x1c7165['indexOf'](']')+0x1));if(_0x1ea04e===_0xb3e15d(0x323))_0x64e643[_0xb3e15d(0x263)][_0xb3e15d(0x2a1)](_0xb3e15d(0x31f)),await _0x64e643[_0xb3e15d(0x151)](_0xb3e15d(0x2cc),{'val':![],'ack':!![]}),await _0x64e643[_0xb3e15d(0x151)](_0xb3e15d(0x20e),{'val':_0xb3e15d(0x2c0),'ack':!![]}),_0x64e643[_0xb3e15d(0x126)]=![],sendNotification(_0x64e643,'âœ…\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x1ea04e===_0xb3e15d(0x328)&&(_0x64e643['log'][_0xb3e15d(0x11b)](_0xb3e15d(0x29d)),sendNotification(_0x64e643,_0xb3e15d(0x33b),![],!![]));}async function runAutopilot(_0x414eb1){const _0x554a27=a0_0x187488,_0x19fac2=_0x414eb1['config'][_0x554a27(0x2a6)],_0x154171=_0x414eb1[_0x554a27(0x278)][_0x554a27(0x27c)]>0x0?_0x414eb1[_0x554a27(0x278)][0x0]['timestamp']:Date[_0x554a27(0x1b7)](),_0x2df0fa=(Date[_0x554a27(0x1b7)]()-_0x154171)/(0x3e8*0x3c*0x3c);let _0x49be01='';_0x414eb1[_0x554a27(0x105)][_0x554a27(0x123)]&&_0x414eb1[_0x554a27(0x17b)]===SYSTEM_MODES[_0x554a27(0x311)]&&_0x414eb1[_0x554a27(0x1c9)]&&(_0x2df0fa>_0x19fac2&&(_0x49be01=_0x554a27(0x280)+_0x2df0fa[_0x554a27(0x21b)](0x1)+_0x554a27(0x2f6))),runGeminiAnalysis(_0x414eb1,_0x49be01)[_0x554a27(0x118)](_0xa4e89b=>_0x414eb1['log'][_0x554a27(0x1ce)](_0xa4e89b));}async function createDailyDigest(_0x3f6009){const _0x5b0e9a=a0_0x187488;if(!_0x3f6009[_0x5b0e9a(0x2ef)])return;await _0x3f6009[_0x5b0e9a(0x151)](LTM_DP_STATUS,{'val':_0x5b0e9a(0x139)+new Date()[_0x5b0e9a(0x109)](),'ack':!![]});if(!_0x3f6009[_0x5b0e9a(0x2b1)]||_0x3f6009[_0x5b0e9a(0x203)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3f6009['setStateAsync'](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x5baece=JSON['parse'](JSON[_0x5b0e9a(0x272)](_0x3f6009[_0x5b0e9a(0x203)])),_0x4a21dc=_0x5baece[_0x5b0e9a(0x27c)],_0x116744=_0x5b0e9a(0x1b0)+JSON['stringify'](_0x5baece);try{const _0x30d7f9=await _0x3f6009[_0x5b0e9a(0x2b1)]['generateContent'](_0x116744),_0x1108a0=JSON[_0x5b0e9a(0x162)](_0x30d7f9[_0x5b0e9a(0x2d9)][_0x5b0e9a(0x152)]()[_0x5b0e9a(0x1ab)](/```json|```/g,'')[_0x5b0e9a(0x202)]());if(_0x1108a0[_0x5b0e9a(0x335)]){const _0x5302ec={'timestamp':new Date()['toISOString'](),'eventCount':_0x4a21dc,'summary':_0x1108a0['summary'],'activityLevel':_0x1108a0[_0x5b0e9a(0x29f)],'systemMode':_0x3f6009[_0x5b0e9a(0x17b)]};_0x3f6009[_0x5b0e9a(0x14d)]['push'](_0x5302ec),await saveDailyDigests(_0x3f6009),_0x3f6009[_0x5b0e9a(0x203)]=[],await saveRawEventLog(_0x3f6009),await _0x3f6009[_0x5b0e9a(0x151)](LTM_DP_STATUS,{'val':'Success:\x20Compressed\x20'+_0x4a21dc+_0x5b0e9a(0x2f2),'ack':!![]}),_0x3f6009['isProVersion']&&(_0x3f6009[_0x5b0e9a(0x263)][_0x5b0e9a(0x2a1)](_0x5b0e9a(0x312)),sendToPython(_0x3f6009,_0x5b0e9a(0x2ec),{'digest':_0x5302ec}));}}catch(_0x117201){await _0x3f6009['setStateAsync'](LTM_DP_STATUS,{'val':_0x5b0e9a(0x270)+_0x117201['message'],'ack':!![]});}}async function sendMorningBriefing(_0x459799){const _0x1f68e5=a0_0x187488;if(!_0x459799[_0x1f68e5(0x2b1)])return;_0x459799[_0x1f68e5(0x263)][_0x1f68e5(0x2a1)](_0x1f68e5(0x141));const _0x41da54=_0x459799['dailyDigests'][_0x1f68e5(0x27c)]>0x0?_0x459799['dailyDigests'][_0x459799[_0x1f68e5(0x14d)][_0x1f68e5(0x27c)]-0x1]:null,_0x4c4cab=_0x41da54&&_0x41da54[_0x1f68e5(0x12d)]?_0x41da54[_0x1f68e5(0x12d)]['sleepScore']:_0x1f68e5(0x32c),_0x1abc76=new Date();_0x1abc76[_0x1f68e5(0x27e)](0x4,0x0,0x0,0x0);const _0x2cbd47=_0x459799[_0x1f68e5(0x278)][_0x1f68e5(0x2dc)](_0x548b30=>new Date(_0x548b30[_0x1f68e5(0x242)])>_0x1abc76),_0x14c386=PERSONA_MAPPING[_0x459799[_0x1f68e5(0x105)][_0x1f68e5(0x106)]||_0x1f68e5(0x1da)],_0x27c0a9=_0x459799[_0x1f68e5(0x105)][_0x1f68e5(0x19e)]||'',_0x1638b7=await getWeatherContext(_0x459799),_0x953f49=await getCalendarContext(_0x459799),_0x253cbc=_0x1f68e5(0x1c6)+_0x14c386+_0x1f68e5(0x267)+_0x27c0a9+_0x1f68e5(0x25e)+_0x1638b7+'\x20'+_0x953f49+'.\x20DATEN:\x20Schlaf\x20'+_0x4c4cab+_0x1f68e5(0x332)+JSON[_0x1f68e5(0x272)](_0x2cbd47[_0x1f68e5(0x1bc)](0x0,0xa))+'.\x20OUTPUT:\x20Nur\x20Text.';try{const _0x5ae9ad=await _0x459799['geminiModel'][_0x1f68e5(0x1e9)](_0x253cbc),_0x594dc6=_0x1f68e5(0x19d)+_0x5ae9ad[_0x1f68e5(0x2d9)][_0x1f68e5(0x152)]()[_0x1f68e5(0x202)]();sendNotification(_0x459799,_0x594dc6),_0x459799[_0x1f68e5(0x263)][_0x1f68e5(0x2a1)]('Morning\x20Briefing\x20sent.');}catch(_0x58b95){_0x459799['log'][_0x1f68e5(0x1ce)](_0x1f68e5(0x136)+_0x58b95[_0x1f68e5(0x113)]);}}async function scanForDevices(_0x1a580f,_0x51c340){const _0x52bd48=a0_0x187488;_0x1a580f[_0x52bd48(0x263)][_0x52bd48(0x2a1)](_0x52bd48(0x158));const _0x502016=[],_0x4bb714=await _0x1a580f[_0x52bd48(0x298)]('*'),_0xd37227=await _0x1a580f[_0x52bd48(0x298)](_0x52bd48(0x2e0),_0x52bd48(0x21c)),_0x201c00=await _0x1a580f[_0x52bd48(0x298)](_0x52bd48(0x1d1),_0x52bd48(0x21c)),_0x463dec={};if(_0xd37227)for(const _0x52aa3a in _0xd37227){const _0x68785e=_0xd37227[_0x52aa3a][_0x52bd48(0x32a)]['members']||[];_0x68785e['forEach'](_0x27c2ae=>{const _0x4dfc2d=_0x52bd48;if(!_0x463dec[_0x27c2ae])_0x463dec[_0x27c2ae]=[];_0x463dec[_0x27c2ae][_0x4dfc2d(0x18f)](_0x52aa3a);});}const _0x448d49={};if(_0x201c00)for(const _0x4e7c70 in _0x201c00){const _0x1f7798=_0x201c00[_0x4e7c70][_0x52bd48(0x32a)][_0x52bd48(0x25b)]||[],_0x5cf5f0=typeof _0x201c00[_0x4e7c70]['common']['name']===_0x52bd48(0x2d7)?_0x201c00[_0x4e7c70][_0x52bd48(0x32a)]['name']['de']:_0x201c00[_0x4e7c70][_0x52bd48(0x32a)][_0x52bd48(0x22c)];_0x1f7798['forEach'](_0x57c509=>_0x448d49[_0x57c509]=_0x5cf5f0);}const _0x1dedfe=_0x51c340[_0x52bd48(0x159)]||[],_0x503a33=_0x51c340[_0x52bd48(0x285)]!==![],_0x15d431=_0x51c340[_0x52bd48(0x16b)]!==![],_0x33edef=_0x51c340[_0x52bd48(0x150)]!==![],_0x9e0dd7=_0x51c340[_0x52bd48(0x24f)]===!![],_0x20f6fd=_0x51c340[_0x52bd48(0x2cd)]===!![];for(const _0x41ac5e in _0x4bb714){const _0x43a4c0=_0x4bb714[_0x41ac5e];if(_0x43a4c0[_0x52bd48(0x2fc)]!=='state'||!_0x43a4c0[_0x52bd48(0x32a)])continue;if(ADAPTER_BLACKLIST['some'](_0x2f9307=>_0x41ac5e[_0x52bd48(0x2e8)](_0x2f9307))&&!_0x20f6fd)continue;const _0x426661=(_0x43a4c0[_0x52bd48(0x32a)][_0x52bd48(0x29a)]||'')[_0x52bd48(0x18c)]();let _0x3b89c4=(typeof _0x43a4c0[_0x52bd48(0x32a)][_0x52bd48(0x22c)]===_0x52bd48(0x2d7)?_0x43a4c0[_0x52bd48(0x32a)][_0x52bd48(0x22c)]['de']:_0x43a4c0[_0x52bd48(0x32a)][_0x52bd48(0x22c)])||_0x41ac5e;const _0x39c21=_0x3b89c4[_0x52bd48(0x18c)]();let _0x3345a6=![],_0xe7ab19=![];if(_0x1dedfe[_0x52bd48(0x27c)]>0x0){const _0x51f15d=_0x463dec[_0x41ac5e]||[],_0x440e73=_0x41ac5e[_0x52bd48(0x195)]('.')[_0x52bd48(0x1bc)](0x0,-0x1)[_0x52bd48(0x225)]('.'),_0x5ee1c4=_0x463dec[_0x440e73]||[];(_0x51f15d[_0x52bd48(0x296)](_0x4a817b=>_0x1dedfe[_0x52bd48(0x290)](_0x4a817b))||_0x5ee1c4[_0x52bd48(0x296)](_0x166fdd=>_0x1dedfe[_0x52bd48(0x290)](_0x166fdd)))&&(_0x3345a6=!![],_0xe7ab19=!![]);}if(!_0x3345a6&&!_0x20f6fd){if(HARD_IGNORE_TERMS['some'](_0xae2c0e=>_0x41ac5e['includes'](_0xae2c0e)||_0x39c21[_0x52bd48(0x290)](_0xae2c0e[_0x52bd48(0x18c)]())))continue;}if(BAD_NAMES['some'](_0x55ebab=>_0x39c21===_0x55ebab||_0x39c21[_0x52bd48(0x221)]('.'+_0x55ebab))){const _0x3451a3=_0x41ac5e[_0x52bd48(0x195)]('.');if(_0x3451a3['length']>0x2){const _0x27d69a=_0x3451a3[_0x52bd48(0x1bc)](0x0,-0x1)[_0x52bd48(0x225)]('.'),_0x578117=_0x4bb714[_0x27d69a];if(_0x578117&&_0x578117[_0x52bd48(0x32a)]&&_0x578117[_0x52bd48(0x32a)][_0x52bd48(0x22c)]){const _0x164a0f=typeof _0x578117[_0x52bd48(0x32a)][_0x52bd48(0x22c)]===_0x52bd48(0x2d7)?_0x578117[_0x52bd48(0x32a)][_0x52bd48(0x22c)]['de']:_0x578117[_0x52bd48(0x32a)]['name'];_0x164a0f&&!_0x3b89c4[_0x52bd48(0x290)](_0x164a0f)&&(_0x3b89c4=_0x164a0f+'\x20'+_0x3b89c4);}}}let _0x27f786='';if(_0x503a33&&(_0x426661['includes'](_0x52bd48(0x285))||_0x426661[_0x52bd48(0x290)](_0x52bd48(0x284))||_0x39c21[_0x52bd48(0x290)]('bewegung')||_0x39c21['includes'](_0x52bd48(0x224))))_0x27f786=_0x52bd48(0x285);else{if(!_0x27f786&&_0x15d431&&(_0x426661[_0x52bd48(0x290)](_0x52bd48(0x15c))||_0x426661['includes']('window')||_0x426661[_0x52bd48(0x290)]('lock')||_0x426661[_0x52bd48(0x290)](_0x52bd48(0x2d0))||_0x426661[_0x52bd48(0x290)](_0x52bd48(0x310))||_0x39c21[_0x52bd48(0x290)](_0x52bd48(0x17e))||_0x39c21[_0x52bd48(0x290)](_0x52bd48(0x2f1))||_0x39c21[_0x52bd48(0x290)](_0x52bd48(0x1eb))))_0x27f786='door';else{if(!_0x27f786&&_0x33edef&&(_0x426661['includes'](_0x52bd48(0x1db))||_0x426661[_0x52bd48(0x290)]('switch')||_0x426661[_0x52bd48(0x290)](_0x52bd48(0x21d))||_0x39c21[_0x52bd48(0x290)](_0x52bd48(0x253))||_0x39c21[_0x52bd48(0x290)](_0x52bd48(0x131))||_0x39c21['includes'](_0x52bd48(0x23f)))){if(_0x43a4c0[_0x52bd48(0x32a)][_0x52bd48(0x294)]||_0x426661[_0x52bd48(0x290)](_0x52bd48(0x28a)))_0x27f786=_0x52bd48(0x1db);}else{if(!_0x27f786&&_0x9e0dd7&&(_0x426661[_0x52bd48(0x290)](_0x52bd48(0x24f))||_0x426661['includes']('humidity')||_0x426661[_0x52bd48(0x290)]('thermostat')||_0x39c21[_0x52bd48(0x290)](_0x52bd48(0x1c5))||_0x39c21[_0x52bd48(0x290)](_0x52bd48(0x1f9))||_0x39c21[_0x52bd48(0x290)](_0x52bd48(0x2b7))))_0x27f786=_0x52bd48(0x24f);else{if(!_0x27f786&&_0xe7ab19)_0x27f786=_0x52bd48(0x30d);}}}}if(_0x27f786){let _0x5a693e=_0x448d49[_0x41ac5e]||'';if(!_0x5a693e){let _0x13b193=_0x41ac5e;for(let _0x7974e1=0x0;_0x7974e1<0x3;_0x7974e1++){const _0x182ad8=_0x13b193['lastIndexOf']('.');if(_0x182ad8===-0x1)break;_0x13b193=_0x13b193[_0x52bd48(0x13d)](0x0,_0x182ad8);if(_0x448d49[_0x13b193]){_0x5a693e=_0x448d49[_0x13b193];break;}}}_0x502016['push']({'id':_0x41ac5e,'name':_0x3b89c4,'location':_0x5a693e,'type':_0x27f786,'logDuplicates':_0x27f786===_0x52bd48(0x285),'isExit':![],'_score':_0x5a693e?0x50:_0x27f786===_0x52bd48(0x30d)?0x5a:0x28});}}return _0x502016[_0x52bd48(0x26e)]((_0x7ab396,_0x58892d)=>_0x58892d[_0x52bd48(0x1ff)]-_0x7ab396[_0x52bd48(0x1ff)]),_0x502016;}async function executeAutomationAction(_0x12306b){const _0x55e6c8=a0_0x187488;try{const _0x254cfd=await _0x12306b[_0x55e6c8(0x2a5)]('analysis.automation.targetId'),_0xc5be14=await _0x12306b[_0x55e6c8(0x2a5)]('analysis.automation.targetValue');if(_0x254cfd&&_0x254cfd[_0x55e6c8(0x2f3)]&&_0xc5be14){const _0x21410f=_0x254cfd[_0x55e6c8(0x2f3)];let _0x3ecee4=_0xc5be14[_0x55e6c8(0x2f3)];try{_0x3ecee4=JSON['parse'](_0x3ecee4);}catch(_0xdc82aa){}_0x12306b['log'][_0x55e6c8(0x2a1)](_0x55e6c8(0x205)+_0x21410f+'\x20=\x20'+_0x3ecee4),await _0x12306b[_0x55e6c8(0x16f)](_0x21410f,_0x3ecee4);}else _0x12306b['log']['warn'](_0x55e6c8(0x2c5));}catch(_0x3874cb){_0x12306b[_0x55e6c8(0x263)][_0x55e6c8(0x1ce)]('BUTLER\x20Execution\x20Error:\x20'+_0x3874cb['message']);}}function tryParse(_0x3c5546){try{return JSON['parse'](_0x3c5546);}catch(_0x45cc04){return null;}}async function recordSequence(_0x3ea989,_0xd2bb28){const _0x467783=a0_0x187488,_0x142d37=(_0xd2bb28[_0x467783(0x2fc)]||'')[_0x467783(0x18c)](),_0x1b4d75=[_0x467783(0x285),_0x467783(0x1d6),_0x467783(0x224),_0x467783(0x2b4),'occupancy',_0x467783(0x15c),_0x467783(0x2f1),_0x467783(0x219),_0x467783(0x17e),'contact',_0x467783(0x326),_0x467783(0x1db),'licht','switch',_0x467783(0x23f),_0x467783(0x21d),_0x467783(0x131)];if(!_0x1b4d75[_0x467783(0x296)](_0x10f1a7=>_0x142d37[_0x467783(0x290)](_0x10f1a7))){_0x3ea989[_0x467783(0x263)][_0x467783(0x1bb)](_0x467783(0x333)+_0xd2bb28['id']+'\x20(Type\x20\x27'+_0xd2bb28['type']+_0x467783(0x2ff));return;}if(!_0xd2bb28[_0x467783(0x1cb)]){_0x3ea989[_0x467783(0x263)][_0x467783(0x1bb)](_0x467783(0x333)+_0xd2bb28['id']+_0x467783(0x174)+_0xd2bb28[_0x467783(0x1cb)]+')');return;}_0x3ea989[_0x467783(0x263)][_0x467783(0x1bb)]('[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20'+_0xd2bb28['id']+'\x20('+_0xd2bb28[_0x467783(0x167)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x3b7480={'loc':_0xd2bb28[_0x467783(0x167)]||_0x467783(0x18a),'id':_0xd2bb28['id'],'ts':Date[_0x467783(0x1b7)]()};activeSequence['push'](_0x3b7480),_0x3ea989['log'][_0x467783(0x1bb)](_0x467783(0x2ed)+_0x3b7480['loc']+_0x467783(0x339)+activeSequence[_0x467783(0x27c)]+')'),sequenceTimer=setTimeout(async()=>{const _0xb66c04=_0x467783;activeSequence['length']>0x1?await saveCompletedSequence(_0x3ea989):(_0x3ea989['log'][_0xb66c04(0x1bb)]('[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20'+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x383333){const _0x254582=a0_0x187488;try{_0x383333[_0x254582(0x263)]['info'](_0x254582(0x10d)+activeSequence[_0x254582(0x27c)]+_0x254582(0x248));const _0x341afe=await _0x383333['getStateAsync'](_0x254582(0x2c3));let _0x102803=[];if(_0x341afe&&_0x341afe[_0x254582(0x2f3)])try{_0x102803=JSON[_0x254582(0x162)](_0x341afe[_0x254582(0x2f3)]);}catch(_0xc48460){}const _0x458d32=activeSequence[0x0]['ts'],_0x2d1d4a=activeSequence[_0x254582(0x20f)](_0x4f0113=>({'loc':_0x4f0113[_0x254582(0x191)],'t_delta':Math['round']((_0x4f0113['ts']-_0x458d32)/0x3e8)})),_0x828eb0={'timestamp':new Date(_0x458d32)['toISOString'](),'steps':_0x2d1d4a,'duration':Math[_0x254582(0x164)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x458d32)/0x3e8),'daytime':new Date(_0x458d32)[_0x254582(0x2e3)]()};_0x102803[_0x254582(0x18f)](_0x828eb0),_0x102803[_0x254582(0x27c)]>MAX_TRAINING_SET_SIZE&&_0x102803[_0x254582(0x33e)](),await _0x383333['setStateAsync'](_0x254582(0x2c3),{'val':JSON['stringify'](_0x102803),'ack':!![]}),runSecurityCheck(_0x383333,_0x828eb0),activeSequence=[],sequenceTimer=null;}catch(_0x18bbae){_0x383333[_0x254582(0x263)][_0x254582(0x1ce)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x18bbae[_0x254582(0x113)]);}}function runSecurityCheck(_0x38803f,_0x432600){const _0x42e439=a0_0x187488;if(!_0x38803f['isProVersion'])return;_0x38803f['log']['debug'](_0x42e439(0x33c)),sendToPython(_0x38803f,_0x42e439(0x108),{'sequence':_0x432600});}async function getOutsideTemperatureNumeric(_0x1ca5d6){const _0x185890=a0_0x187488;if(_0x1ca5d6[_0x185890(0x105)][_0x185890(0x18d)])try{const _0x1ec31a=await _0x1ca5d6[_0x185890(0x2a3)](_0x1ca5d6[_0x185890(0x105)][_0x185890(0x18d)]);if(_0x1ec31a&&_0x1ec31a[_0x185890(0x2f3)]!==undefined&&_0x1ec31a['val']!==null){const _0x4828b9=parseFloat(_0x1ec31a[_0x185890(0x2f3)]);if(!isNaN(_0x4828b9))return _0x4828b9;}}catch(_0x195fb9){}const _0x4e59cf=_0x1ca5d6[_0x185890(0x105)][_0x185890(0x255)];if(!_0x1ca5d6[_0x185890(0x105)][_0x185890(0x140)]||!_0x4e59cf)return null;try{let _0x2599fd='';if(_0x4e59cf['includes']('accuweather'))_0x2599fd=_0x4e59cf+_0x185890(0x19b);else{if(_0x4e59cf[_0x185890(0x290)](_0x185890(0x148)))_0x2599fd=_0x4e59cf+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x4e59cf[_0x185890(0x290)](_0x185890(0x2b5)))_0x2599fd=_0x4e59cf+_0x185890(0x220);else{if(_0x4e59cf[_0x185890(0x290)](_0x185890(0x2db)))_0x2599fd=_0x4e59cf+_0x185890(0x2ae);}}}if(_0x2599fd){const _0x537d90=await _0x1ca5d6[_0x185890(0x2a3)](_0x2599fd);if(_0x537d90&&_0x537d90['val']!==undefined&&_0x537d90[_0x185890(0x2f3)]!==null)return parseFloat(_0x537d90['val']);}}catch(_0xb01a24){}return null;}async function recordThermodynamics(_0x3ee1be,_0x2388d9,_0x2c84c9,_0x21b308){const _0x291aca=a0_0x187488,_0x203f39=await getOutsideTemperatureNumeric(_0x3ee1be),_0x30b1f1=await _0x3ee1be[_0x291aca(0x2a5)]('LTM.trainingData.thermodynamics');let _0xab1821=[];if(_0x30b1f1&&_0x30b1f1[_0x291aca(0x2f3)])try{_0xab1821=JSON['parse'](_0x30b1f1[_0x291aca(0x2f3)]);}catch(_0x20d1e0){}_0xab1821[_0x291aca(0x18f)]({'ts':Date[_0x291aca(0x1b7)](),'room':_0x21b308||_0x291aca(0x18a),'t_in':_0x2c84c9,'t_out':_0x203f39});if(_0xab1821[_0x291aca(0x27c)]>THERMO_LOG_SIZE)_0xab1821[_0x291aca(0x33e)]();await _0x3ee1be[_0x291aca(0x151)](_0x291aca(0x1ea),{'val':JSON['stringify'](_0xab1821),'ack':!![]});}async function processSensorEvent(_0x2a319e,_0x36caf5,_0x2c45f7,_0xc26612){const _0x1943e8=a0_0x187488;if(!_0xc26612)return;const _0x597ca0=_0x2c45f7[_0x1943e8(0x2f3)],_0x270cc9=Date[_0x1943e8(0x1b7)](),_0x5f282d=_0x2a319e[_0x1943e8(0x287)][_0x36caf5];_0x2a319e[_0x1943e8(0x287)][_0x36caf5]=_0x597ca0;if(!_0xc26612[_0x1943e8(0x319)]&&_0x5f282d!=undefined&&_0x5f282d==_0x597ca0)return;const _0x1fe151=(_0xc26612[_0x1943e8(0x2fc)]||'')[_0x1943e8(0x18c)](),_0x266455=_0x1fe151[_0x1943e8(0x290)](_0x1943e8(0x24f))||_0x1fe151[_0x1943e8(0x290)](_0x1943e8(0x165))||_0x1fe151[_0x1943e8(0x290)](_0x1943e8(0x1f9))||_0x1fe151[_0x1943e8(0x290)](_0x1943e8(0x2b7));_0x2a319e['isProVersion']&&_0x266455&&recordThermodynamics(_0x2a319e,_0x36caf5,_0x597ca0,_0xc26612['location']);const _0x3624ad={'timestamp':_0x270cc9,'id':_0x36caf5,'name':_0xc26612['name'],'type':_0xc26612[_0x1943e8(0x2fc)],'location':_0xc26612[_0x1943e8(0x167)],'value':_0x597ca0};_0x2a319e['eventHistory'][_0x1943e8(0x268)](_0x3624ad);if(_0x2a319e[_0x1943e8(0x278)][_0x1943e8(0x27c)]>HISTORY_MAX_SIZE)_0x2a319e[_0x1943e8(0x278)][_0x1943e8(0x170)]();await _0x2a319e[_0x1943e8(0x151)](_0x1943e8(0x235),{'val':JSON[_0x1943e8(0x272)](_0x3624ad),'ack':!![]}),await _0x2a319e['setStateAsync'](_0x1943e8(0x1e6),{'val':JSON[_0x1943e8(0x272)](_0x2a319e[_0x1943e8(0x278)]),'ack':!![]});_0x2a319e['isProVersion']&&(_0x2a319e[_0x1943e8(0x203)][_0x1943e8(0x18f)](_0x3624ad),await saveRawEventLog(_0x2a319e),recordSequence(_0x2a319e,_0x3624ad));if(_0xc26612[_0x1943e8(0x1ac)]&&_0x597ca0===!![]){if(_0x2a319e[_0x1943e8(0x1c9)]&&!_0x2a319e[_0x1943e8(0x2f5)])startExitTimer(_0x2a319e);else{if(!_0x2a319e[_0x1943e8(0x1c9)])setPresence(_0x2a319e,!![]);}}else{if(_0xc26612[_0x1943e8(0x2fc)]==='motion'&&_0x597ca0===!![]){if(_0x2a319e[_0x1943e8(0x2da)])abortExitTimer(_0x2a319e);if(!_0x2a319e['isPresent']&&_0x2a319e[_0x1943e8(0x17b)]===SYSTEM_MODES[_0x1943e8(0x311)])setPresence(_0x2a319e,!![]);}}}async function runGeminiAnalysis(_0x3d718f,_0x3227da=''){const _0x1e4f17=a0_0x187488;if(!_0x3d718f['geminiModel'])return;if(_0x3d718f[_0x1e4f17(0x278)]['length']===0x0)return;const _0x32e5d0=_0x3d718f[_0x1e4f17(0x278)][_0x1e4f17(0x1bc)](0x0,0xf),_0x261feb=await getWeatherContext(_0x3d718f),_0xaf2b66=_0x3d718f[_0x1e4f17(0x17b)],_0x570e11=PERSONA_MAPPING[_0x3d718f[_0x1e4f17(0x105)][_0x1e4f17(0x106)]||_0x1e4f17(0x1da)],_0x23509b=_0x3d718f['config']['livingContext']||_0x1e4f17(0x302);let _0x13b17d='Unbekannt';try{const _0x11ed5a=await _0x3d718f[_0x1e4f17(0x2a5)]('system.presenceWho');if(_0x11ed5a&&_0x11ed5a[_0x1e4f17(0x2f3)])_0x13b17d=_0x11ed5a[_0x1e4f17(0x2f3)];}catch(_0x28d266){}let _0x368e76=![];try{const _0x16cd33=await _0x3d718f[_0x1e4f17(0x2a5)](_0x1e4f17(0x129));if(_0x16cd33&&_0x16cd33[_0x1e4f17(0x2f3)])_0x368e76=!![];}catch(_0x52b30b){}const _0x4441e5='ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x20PERSONA:\x20'+_0x570e11+_0x1e4f17(0x267)+_0x23509b+'.\x20SYSTEM_MODE:\x20'+_0xaf2b66+_0x1e4f17(0x1f7)+_0x261feb+_0x1e4f17(0x1f3)+(_0x3227da||_0x1e4f17(0x1b5))+_0x1e4f17(0x29e)+(_0x3d718f[_0x1e4f17(0x1c9)]?_0x1e4f17(0x231):_0x1e4f17(0x168))+_0x1e4f17(0x2c6)+_0x13b17d+_0x1e4f17(0x277)+JSON[_0x1e4f17(0x272)](_0x32e5d0)+_0x1e4f17(0x17f);try{const _0x17ed21=await _0x3d718f[_0x1e4f17(0x2b1)][_0x1e4f17(0x1e9)](_0x4441e5),_0x22b19f=_0x17ed21[_0x1e4f17(0x2d9)][_0x1e4f17(0x152)]()['replace'](/```json|```/g,'')['trim'](),_0x1b1439=JSON[_0x1e4f17(0x162)](_0x22b19f);await _0x3d718f[_0x1e4f17(0x151)](_0x1e4f17(0x1f1),{'val':JSON[_0x1e4f17(0x272)](_0x1b1439),'ack':!![]});if(_0x1b1439[_0x1e4f17(0x335)])await _0x3d718f[_0x1e4f17(0x151)](_0x1e4f17(0x307),{'val':_0x1b1439[_0x1e4f17(0x335)],'ack':!![]});const _0x183e43={'timestamp':Date[_0x1e4f17(0x1b7)](),'id':Date['now']()['toString'](),'analysis':{'activity':{'summary':_0x1b1439[_0x1e4f17(0x335)]||'Keine\x20Analyse.','isAlert':_0x1b1439['isAlert']||![],'alertReason':_0x1b1439[_0x1e4f17(0x1d0)]},'comfort':{'automationProposal':_0x1b1439['automationProposal']}}};await updateAnalysisHistory(_0x3d718f,_0x183e43);const _0x551dc8=_0x1b1439[_0x1e4f17(0x23d)]||![];_0x551dc8!==_0x3d718f['lastAlertState']&&(await _0x3d718f[_0x1e4f17(0x151)]('analysis.isAlert',{'val':_0x551dc8,'ack':!![]}),_0x3d718f[_0x1e4f17(0x126)]=_0x551dc8,_0x551dc8&&(await _0x3d718f[_0x1e4f17(0x151)]('analysis.alertReason',{'val':_0x1b1439[_0x1e4f17(0x1d0)],'ack':!![]}),sendNotification(_0x3d718f,_0x1e4f17(0x245)+_0x1b1439[_0x1e4f17(0x1d0)],![],_0x1b1439[_0x1e4f17(0x2e7)]))),_0x1b1439[_0x1e4f17(0x33d)]&&_0x1b1439[_0x1e4f17(0x33d)][_0x1e4f17(0x198)]&&_0x1b1439[_0x1e4f17(0x33d)][_0x1e4f17(0x172)]&&(await _0x3d718f['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x3d718f['setStateAsync'](_0x1e4f17(0x22d),{'val':_0x1b1439[_0x1e4f17(0x33d)][_0x1e4f17(0x176)],'ack':!![]}),await _0x3d718f[_0x1e4f17(0x151)](_0x1e4f17(0x145),{'val':_0x1b1439[_0x1e4f17(0x33d)][_0x1e4f17(0x172)],'ack':!![]}),await _0x3d718f['setStateAsync'](_0x1e4f17(0x222),{'val':JSON[_0x1e4f17(0x272)](_0x1b1439['automationProposal'][_0x1e4f17(0x2c7)]),'ack':!![]}),_0x368e76&&await executeAutomationAction(_0x3d718f));}catch(_0x22f191){_0x3d718f[_0x1e4f17(0x263)][_0x1e4f17(0x1ce)](_0x1e4f17(0x1a4)+_0x22f191[_0x1e4f17(0x113)]);}}function installPythonDependencies(_0x443be7){const _0x441ef7=a0_0x187488;if(_0x443be7[_0x441ef7(0x147)])return;_0x443be7[_0x441ef7(0x147)]=!![];const _0x1bb684=path['join'](__dirname,'python_service','requirements.txt');_0x443be7['log']['info'](_0x441ef7(0x210)+_0x1bb684+'...'),stopPythonService(_0x443be7);const _0x4fd6c1=_0x441ef7(0x12e)+_0x1bb684+_0x441ef7(0x178);exec(_0x4fd6c1,(_0x28074f,_0x3a0c28,_0x23f41e)=>{const _0x45e178=_0x441ef7,_0x211a71=_0x23f41e&&_0x23f41e[_0x45e178(0x290)](_0x45e178(0x1f0))||_0x28074f&&_0x28074f[_0x45e178(0x113)][_0x45e178(0x290)](_0x45e178(0x1f0));if(_0x211a71){_0x443be7[_0x45e178(0x263)][_0x45e178(0x11b)]('âš ï¸\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing...'),exec(_0x45e178(0x320),(_0x2a9c7f,_0x172989,_0x276ee0)=>{const _0x493932=_0x45e178;_0x2a9c7f?(_0x443be7[_0x493932(0x263)][_0x493932(0x1ce)](_0x493932(0x2fb)),_0x443be7[_0x493932(0x147)]=![]):(_0x443be7[_0x493932(0x263)]['info'](_0x493932(0x26c)),exec('python3\x20-m\x20pip\x20install\x20-r\x20\x22'+_0x1bb684+_0x493932(0x1b6),(_0x18b170,_0x1670ed,_0x3f74b7)=>{const _0x5b80e7=_0x493932;_0x18b170?_0x443be7[_0x5b80e7(0x263)][_0x5b80e7(0x1ce)](_0x5b80e7(0x15e)+_0x18b170['message']):(_0x443be7[_0x5b80e7(0x263)]['info'](_0x5b80e7(0x299)),startPythonService(_0x443be7)),_0x443be7['dependencyInstallInProgress']=![];}));});return;}_0x443be7[_0x45e178(0x147)]=![],_0x28074f?_0x443be7[_0x45e178(0x263)]['error'](_0x45e178(0x291)+(_0x23f41e||_0x28074f[_0x45e178(0x113)])):(_0x443be7[_0x45e178(0x263)]['info'](_0x45e178(0x2e5)),startPythonService(_0x443be7));});}function sendToPython(_0x36678d,_0x231249,_0x4097d1={}){const _0x2d8742=a0_0x187488;if(!_0x36678d[_0x2d8742(0x175)]||!_0x36678d['pythonProcess'][_0x2d8742(0x264)][_0x2d8742(0x216)])return;const _0x38de82=JSON[_0x2d8742(0x272)]({'command':_0x231249,..._0x4097d1});try{_0x36678d[_0x2d8742(0x175)][_0x2d8742(0x264)][_0x2d8742(0x294)](_0x38de82+'\x0a');}catch(_0x2569af){_0x36678d[_0x2d8742(0x263)]['error'](_0x2d8742(0x25a)+_0x2569af['message']);}}function runPythonHealthCheck(_0x3319bd){const _0x23cd6c=a0_0x187488;if(!_0x3319bd[_0x23cd6c(0x14d)]||_0x3319bd[_0x23cd6c(0x14d)][_0x23cd6c(0x27c)]<0x2)return;const _0x490438=_0x3319bd['dailyDigests']['map'](_0x423abc=>{const _0xf68fd4=_0x23cd6c,_0x3bcb17=(_0x423abc[_0xf68fd4(0x29f)]||'')[_0xf68fd4(0x18c)]();return ACTIVITY_LEVEL_MAP[_0x3bcb17]||0x32;});_0x3319bd[_0x23cd6c(0x263)]['info'](_0x23cd6c(0x2ea)+_0x490438[_0x23cd6c(0x27c)]+_0x23cd6c(0x26b)),sendToPython(_0x3319bd,'ANALYZE_TREND',{'values':_0x490438,'tag':_0x23cd6c(0x2d2)});}function handlePythonResult(_0x29236f,_0x22bd36){const _0x3c0723=a0_0x187488;if(_0x22bd36[_0x3c0723(0x2fc)]===_0x3c0723(0x27f))_0x29236f[_0x3c0723(0x263)]['debug'](_0x3c0723(0x2c4));else{if(_0x22bd36[_0x3c0723(0x2fc)]==='TREND_RESULT'){const {tag:_0x5e7560,diagnosis:_0x39a30b,change_percent:_0x886b49}=_0x22bd36[_0x3c0723(0x190)];_0x29236f[_0x3c0723(0x263)][_0x3c0723(0x2a1)](_0x3c0723(0x340)+_0x5e7560+_0x3c0723(0x199)+_0x39a30b+'\x20('+_0x886b49+'%)'),_0x29236f[_0x3c0723(0x151)](_0x3c0723(0x194),{'val':_0x39a30b,'ack':!![]}),_0x29236f['setStateAsync'](_0x3c0723(0x247),{'val':_0x886b49,'ack':!![]});}else{if(_0x22bd36[_0x3c0723(0x2fc)]==='TRAINING_COMPLETE'){const {success:_0x28550a,details:_0x5db0d4}=_0x22bd36['payload'];_0x28550a?(_0x29236f[_0x3c0723(0x263)][_0x3c0723(0x2a1)](_0x3c0723(0x1e8)+_0x5db0d4),_0x29236f['setStateAsync'](_0x3c0723(0x2f9),{'val':_0x3c0723(0x218)+new Date()[_0x3c0723(0x2ce)]()+'\x20('+_0x5db0d4+')','ack':!![]})):(_0x29236f[_0x3c0723(0x263)]['error'](_0x3c0723(0x1a1)+(_0x5db0d4||_0x3c0723(0x266))),_0x29236f['setStateAsync'](_0x3c0723(0x2f9),{'val':_0x3c0723(0x17c)+_0x5db0d4,'ack':!![]}));}else{if(_0x22bd36[_0x3c0723(0x2fc)]===_0x3c0723(0x13f)){const {success:_0x563a51,details:_0x4cae82}=_0x22bd36[_0x3c0723(0x190)];if(_0x563a51)_0x29236f[_0x3c0723(0x263)]['info'](_0x3c0723(0x155)+_0x4cae82);else _0x29236f['log'][_0x3c0723(0x1ce)]('âŒ\x20Health\x20Training\x20Failed:\x20'+_0x4cae82);}else{if(_0x22bd36[_0x3c0723(0x2fc)]==='HEALTH_RESULT'){const {is_anomaly:_0x6aed17,details:_0x2e5c2b}=_0x22bd36[_0x3c0723(0x190)];_0x29236f['setStateAsync'](_0x3c0723(0x11a),{'val':new Date()[_0x3c0723(0x117)](),'ack':!![]}),_0x29236f[_0x3c0723(0x151)](_0x3c0723(0x2bb),{'val':_0x6aed17,'ack':!![]});if(_0x6aed17)_0x29236f[_0x3c0723(0x263)][_0x3c0723(0x11b)](_0x3c0723(0x10e)+_0x2e5c2b);}else{if(_0x22bd36[_0x3c0723(0x2fc)]===_0x3c0723(0x2a8)){const {success:_0xa8f43e,details:_0x11fdce}=_0x22bd36[_0x3c0723(0x190)];if(_0xa8f43e){_0x29236f[_0x3c0723(0x263)]['info'](_0x3c0723(0x186));try{const _0x4074e5=JSON[_0x3c0723(0x162)](_0x11fdce);_0x4074e5['insulation']&&_0x29236f[_0x3c0723(0x151)]('analysis.energy.insulationScore',{'val':JSON[_0x3c0723(0x272)](_0x4074e5[_0x3c0723(0x20c)]),'ack':!![]}),_0x4074e5[_0x3c0723(0x2bc)]&&_0x29236f[_0x3c0723(0x151)]('analysis.energy.heatingScore',{'val':JSON[_0x3c0723(0x272)](_0x4074e5[_0x3c0723(0x2bc)]),'ack':!![]});}catch(_0xed3d79){_0x29236f[_0x3c0723(0x263)][_0x3c0723(0x1ce)]('Failed\x20to\x20parse\x20energy\x20training\x20result:\x20'+_0xed3d79[_0x3c0723(0x113)]);}}else _0x29236f['log']['error'](_0x3c0723(0x259)+_0x11fdce);}else{if(_0x22bd36['type']===_0x3c0723(0x2df)){const {anomaly_score:_0x4cc4af,is_anomaly:_0x5845ec,threshold:_0x30122f}=_0x22bd36[_0x3c0723(0x190)];_0x29236f['log'][_0x3c0723(0x2a1)]('ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20'+_0x4cc4af['toFixed'](0x5)+_0x3c0723(0x15b)+_0x30122f+')\x20->\x20'+(_0x5845ec?'ANOMALY':'OK')),_0x29236f[_0x3c0723(0x151)]('analysis.security.lastScore',{'val':_0x4cc4af,'ack':!![]}),_0x29236f[_0x3c0723(0x151)](_0x3c0723(0x2d3),{'val':new Date()[_0x3c0723(0x117)](),'ack':!![]});if(_0x5845ec){const _0x574ac1=_0x3c0723(0x183)+_0x4cc4af[_0x3c0723(0x21b)](0x4)+')';_0x29236f['setStateAsync']('analysis.isAlert',{'val':!![],'ack':!![]}),_0x29236f[_0x3c0723(0x151)](_0x3c0723(0x20e),{'val':_0x574ac1,'ack':!![]}),sendNotification(_0x29236f,_0x3c0723(0x1b1)+_0x574ac1,![],!![]);}}}}}}}}}function startPythonService(_0x5d3292){const _0x5511d0=a0_0x187488;try{const _0xfa1c23=path['join'](__dirname,'python_service','service.py');_0x5d3292['log'][_0x5511d0(0x2a1)]('ðŸ\x20Starting\x20Python\x20Sidecar:\x20'+_0xfa1c23),_0x5d3292[_0x5511d0(0x175)]=spawn(_0x5511d0(0x196),[_0xfa1c23]),_0x5d3292[_0x5511d0(0x175)][_0x5511d0(0x2a9)]['on'](_0x5511d0(0x182),_0x371c79=>{const _0x3c6747=_0x5511d0,_0x5ac7e3=_0x371c79[_0x3c6747(0x11e)]()[_0x3c6747(0x195)]('\x0a');_0x5ac7e3['forEach'](_0x281867=>{const _0x20ed53=_0x3c6747,_0x24b033=_0x281867['trim']();if(!_0x24b033)return;if(_0x24b033['startsWith'](_0x20ed53(0x324)))_0x5d3292[_0x20ed53(0x263)]['debug'](_0x20ed53(0x193)+_0x24b033[_0x20ed53(0x13d)](0x5)[_0x20ed53(0x202)]());else{if(_0x24b033[_0x20ed53(0x2e8)](_0x20ed53(0x275)))try{const _0x156713=JSON[_0x20ed53(0x162)](_0x24b033[_0x20ed53(0x13d)](0x8)[_0x20ed53(0x202)]());handlePythonResult(_0x5d3292,_0x156713);}catch(_0xe950bb){_0x5d3292[_0x20ed53(0x263)][_0x20ed53(0x11b)]('Invalid\x20JSON\x20from\x20Python:\x20'+_0x24b033);}}(_0x24b033[_0x20ed53(0x290)]('No\x20module\x20named')||_0x24b033[_0x20ed53(0x290)](_0x20ed53(0x33f)))&&(_0x5d3292[_0x20ed53(0x263)]['warn'](_0x20ed53(0x32f)),installPythonDependencies(_0x5d3292));});}),_0x5d3292[_0x5511d0(0x175)]['stderr']['on'](_0x5511d0(0x182),_0x3d2f34=>{const _0x528446=_0x5511d0,_0x340df0=_0x3d2f34[_0x528446(0x11e)]()['trim']();_0x5d3292['log'][_0x528446(0x1ce)](_0x528446(0x1d5)+_0x340df0);}),_0x5d3292[_0x5511d0(0x175)]['on'](_0x5511d0(0x1d8),_0x536bbd=>{const _0x1e1281=_0x5511d0;_0x5d3292[_0x1e1281(0x263)]['info']('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x536bbd),_0x5d3292[_0x1e1281(0x175)]=null;}),_0x5d3292[_0x5511d0(0x175)]['on']('error',_0x2cad0f=>{const _0x34738c=_0x5511d0;_0x5d3292[_0x34738c(0x263)]['warn']('[PYTHON]\x20Failed\x20to\x20start:\x20'+_0x2cad0f[_0x34738c(0x113)]);});}catch(_0x18452f){_0x5d3292['log'][_0x5511d0(0x1ce)](_0x5511d0(0x2d8)+_0x18452f[_0x5511d0(0x113)]);}}function stopPythonService(_0x561e5e){const _0x5a3c7a=a0_0x187488;if(_0x561e5e[_0x5a3c7a(0x175)]){_0x561e5e['log']['info'](_0x5a3c7a(0x1a7));try{_0x561e5e[_0x5a3c7a(0x175)][_0x5a3c7a(0x2dd)]();}catch(_0x430350){_0x561e5e[_0x5a3c7a(0x263)][_0x5a3c7a(0x11b)](_0x5a3c7a(0x20d)+_0x430350[_0x5a3c7a(0x113)]);}_0x561e5e['pythonProcess']=null;}}class CogniLiving extends utils[a0_0x187488(0x125)]{constructor(_0x2b921f){const _0x40e297=a0_0x187488;super({..._0x2b921f,'name':_0x40e297(0x22b)}),this[_0x40e297(0x278)]=[],this[_0x40e297(0x188)]=[],this[_0x40e297(0x143)]=[],this[_0x40e297(0x203)]=[],this['dailyDigests']=[],this[_0x40e297(0x287)]={},this[_0x40e297(0x13c)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x40e297(0x2da)]=null,this[_0x40e297(0x121)]=null,this[_0x40e297(0x2f5)]=![],this[_0x40e297(0x1f4)]=null,this['geminiModel']=null,this[_0x40e297(0x17b)]=SYSTEM_MODES[_0x40e297(0x311)],this['isProVersion']=![],this[_0x40e297(0x126)]=![],this[_0x40e297(0x1be)]=_0x40e297(0x142),this[_0x40e297(0x21f)]=null,this[_0x40e297(0x1c0)]=null,this[_0x40e297(0x31e)]=null,this['driftAnalysisTimer']=null,this[_0x40e297(0x2e6)]=null,this[_0x40e297(0x175)]=null,this[_0x40e297(0x147)]=![],this['on'](_0x40e297(0x246),this[_0x40e297(0x1c2)][_0x40e297(0x1a9)](this)),this['on']('stateChange',this['onStateChange'][_0x40e297(0x1a9)](this)),this['on'](_0x40e297(0x12c),this[_0x40e297(0x19f)]['bind'](this)),this['on'](_0x40e297(0x113),this[_0x40e297(0x171)]['bind'](this));}async[a0_0x187488(0x1c2)](){const _0x586743=a0_0x187488;this[_0x586743(0x263)][_0x586743(0x2a1)](_0x586743(0x313)+this[_0x586743(0x1bf)]+')'),await initZombies(this),this[_0x586743(0x105)][_0x586743(0x212)]=this[_0x586743(0x105)][_0x586743(0x212)]||'';try{this[_0x586743(0x2ef)]=await checkLicense(this,this[_0x586743(0x105)]['licenseKey']);}catch(_0xbf953b){}if(!this['config'][_0x586743(0x2a6)]||this['config'][_0x586743(0x2a6)]<0.1)this[_0x586743(0x105)][_0x586743(0x2a6)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x586743(0x105)]['geminiApiKey'])try{this[_0x586743(0x1f4)]=new GoogleGenerativeAI(this[_0x586743(0x105)][_0x586743(0x14e)]),this[_0x586743(0x2b1)]=this['genAI'][_0x586743(0x262)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x586743(0x11d)}}),this[_0x586743(0x263)][_0x586743(0x2a1)]('Gemini\x20AI\x20initialized.');}catch(_0x436de5){this[_0x586743(0x263)][_0x586743(0x1ce)]('Gemini\x20Init\x20Error:\x20'+_0x436de5[_0x586743(0x113)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x586743(0x107)]('analysis.trigger'),this[_0x586743(0x107)](LTM_DP_TRIGGER_DIGEST),this[_0x586743(0x107)](_0x586743(0x135)),this['subscribeStates'](_0x586743(0x1a6)),this[_0x586743(0x107)](_0x586743(0x112)),this['subscribeStates'](_0x586743(0x129)),this[_0x586743(0x107)]('analysis.training.triggerSecurity'),this['subscribeStates'](_0x586743(0x1e1)),this[_0x586743(0x107)](_0x586743(0x1e0)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0x586743(0x21f)]);const _0xe3b57b=this[_0x586743(0x105)][_0x586743(0x30c)]||0xf;_0xe3b57b>0x0&&(this[_0x586743(0x21f)]=setInterval(()=>{runAutopilot(this);},_0xe3b57b*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x44e3a8=_0x586743;if(this[_0x44e3a8(0x175)])runPythonHealthCheck(this);},0x1388);}[a0_0x187488(0x19f)](_0x55651d){const _0x193e3e=a0_0x187488;if(this['analysisTimer'])clearInterval(this[_0x193e3e(0x21f)]);if(this[_0x193e3e(0x149)])clearInterval(this[_0x193e3e(0x149)]);if(this['ltmJob'])this[_0x193e3e(0x1c0)][_0x193e3e(0x14a)]();if(this[_0x193e3e(0x31e)])this[_0x193e3e(0x31e)]['cancel']();if(this[_0x193e3e(0x2e6)])this[_0x193e3e(0x2e6)][_0x193e3e(0x14a)]();if(this[_0x193e3e(0x2da)])clearTimeout(this['exitTimer']);if(this[_0x193e3e(0x121)])clearTimeout(this[_0x193e3e(0x121)]);stopPythonService(this),_0x55651d();}async[a0_0x187488(0x257)](_0x461eb8,_0x3f622e){const _0x22d6dc=a0_0x187488;if(!_0x3f622e)return;if(_0x461eb8['includes'](_0x22d6dc(0x2ba))&&_0x461eb8[_0x22d6dc(0x221)](_0x22d6dc(0x208))&&_0x3f622e[_0x22d6dc(0x2f3)]){await handleTelegramResponse(this,_0x3f622e['val']);return;}if(_0x461eb8===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0x3f622e[_0x22d6dc(0x2f3)]&&Object[_0x22d6dc(0x232)](SYSTEM_MODES)[_0x22d6dc(0x290)](_0x3f622e['val'])){this[_0x22d6dc(0x17b)]=_0x3f622e[_0x22d6dc(0x2f3)];if(_0x3f622e[_0x22d6dc(0x2f3)]===SYSTEM_MODES['VACATION'])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x3f622e['ack'])this[_0x22d6dc(0x1ca)](_0x461eb8,{'val':this[_0x22d6dc(0x17b)],'ack':!![]});return;}if(!_0x3f622e['ack']){_0x461eb8[_0x22d6dc(0x290)](_0x22d6dc(0x1a5))&&_0x3f622e[_0x22d6dc(0x2f3)]&&(this[_0x22d6dc(0x1ca)](_0x461eb8,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x461eb8[_0x22d6dc(0x290)](_0x22d6dc(0x1c4))&&_0x3f622e[_0x22d6dc(0x2f3)]){this[_0x22d6dc(0x1ca)](_0x461eb8,{'val':![],'ack':!![]});if(this[_0x22d6dc(0x2ef)])createDailyDigest(this);}_0x461eb8[_0x22d6dc(0x290)](_0x22d6dc(0x215))&&_0x3f622e[_0x22d6dc(0x2f3)]&&(this[_0x22d6dc(0x1ca)](_0x461eb8,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x461eb8[_0x22d6dc(0x290)](_0x22d6dc(0x2c9))&&_0x3f622e[_0x22d6dc(0x2f3)]&&(this['setState'](_0x461eb8,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x461eb8[_0x22d6dc(0x290)](_0x22d6dc(0x28c))&&_0x3f622e[_0x22d6dc(0x2f3)]){this['setState'](_0x461eb8,{'val':![],'ack':!![]});if(!this[_0x22d6dc(0x2ef)])return;try{const _0x39d101=await this['getStateAsync'](_0x22d6dc(0x2c3));if(_0x39d101&&_0x39d101['val']){const _0x2dbfb7=JSON[_0x22d6dc(0x162)](_0x39d101[_0x22d6dc(0x2f3)]);this[_0x22d6dc(0x263)][_0x22d6dc(0x2a1)]('ðŸ§ \x20Triggering\x20Security\x20Training...'),this['setStateAsync']('analysis.training.status',{'val':'Sec-Training\x20started...','ack':!![]}),sendToPython(this,_0x22d6dc(0x21e),{'sequences':_0x2dbfb7});}}catch(_0x6f9328){this['log'][_0x22d6dc(0x1ce)](_0x22d6dc(0x157)+_0x6f9328['message']);}}if(_0x461eb8[_0x22d6dc(0x290)](_0x22d6dc(0x1e1))&&_0x3f622e['val']){this['setState'](_0x461eb8,{'val':![],'ack':!![]});if(!this['isProVersion'])return;try{const _0x1b09fe=await this[_0x22d6dc(0x2a5)](LTM_DP_DAILY_DIGESTS);if(_0x1b09fe&&_0x1b09fe[_0x22d6dc(0x2f3)]){const _0x2d3d19=JSON[_0x22d6dc(0x162)](_0x1b09fe[_0x22d6dc(0x2f3)]);this[_0x22d6dc(0x263)][_0x22d6dc(0x2a1)]('ðŸ©º\x20Triggering\x20Health\x20Training...'),sendToPython(this,'TRAIN_HEALTH',{'digests':_0x2d3d19});}}catch(_0x5e2328){this[_0x22d6dc(0x263)][_0x22d6dc(0x1ce)]('Health\x20Train\x20Error:\x20'+_0x5e2328[_0x22d6dc(0x113)]);}}if(_0x461eb8[_0x22d6dc(0x290)](_0x22d6dc(0x1e0))&&_0x3f622e[_0x22d6dc(0x2f3)]){this[_0x22d6dc(0x1ca)](_0x461eb8,{'val':![],'ack':!![]});if(!this[_0x22d6dc(0x2ef)])return;try{const _0x2cfa09=await this[_0x22d6dc(0x2a5)]('LTM.trainingData.thermodynamics');if(_0x2cfa09&&_0x2cfa09[_0x22d6dc(0x2f3)]){const _0x18c0c2=JSON[_0x22d6dc(0x162)](_0x2cfa09[_0x22d6dc(0x2f3)]);this[_0x22d6dc(0x263)][_0x22d6dc(0x2a1)](_0x22d6dc(0x1ef)),sendToPython(this,_0x22d6dc(0x300),{'points':_0x18c0c2});}}catch(_0x48a637){this[_0x22d6dc(0x263)]['error'](_0x22d6dc(0x192)+_0x48a637[_0x22d6dc(0x113)]);}}return;}if(this['config']['presenceDevices']&&this[_0x22d6dc(0x105)][_0x22d6dc(0x20a)][_0x22d6dc(0x290)](_0x461eb8)){await checkWifiPresence(this);return;}const _0x47c525=(this['config']['devices']||[])[_0x22d6dc(0x334)](_0x537b17=>_0x537b17['id']===_0x461eb8);if(_0x47c525)processSensorEvent(this,_0x461eb8,_0x3f622e,_0x47c525);}async['onMessage'](_0x9e72e8){const _0x405259=a0_0x187488;if(typeof _0x9e72e8==='object'&&_0x9e72e8[_0x405259(0x113)])try{if(_0x9e72e8[_0x405259(0x2f8)]===_0x405259(0x122)){const _0x2d4213=_0x9e72e8['message'][_0x405259(0x1b3)]||this[_0x405259(0x105)][_0x405259(0x14e)];if(!_0x2d4213)return this['sendTo'](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':![],'message':_0x405259(0x240)},_0x9e72e8[_0x405259(0x32d)]);try{const _0x496dd1=new GoogleGenerativeAI(_0x2d4213),_0x288741=_0x496dd1[_0x405259(0x262)]({'model':GEMINI_MODEL}),_0x1662d0=await _0x288741[_0x405259(0x1e9)](_0x405259(0x2f7)),_0x45c01b=await _0x1662d0['response'],_0xc6e955=_0x45c01b['text']();this['sendTo'](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![],'message':'Verbindung\x20erfolgreich!\x20Antwort:\x20'+_0xc6e955[_0x405259(0x13d)](0x0,0x14)+_0x405259(0x2e4)},_0x9e72e8['callback']);}catch(_0x326b52){this['sendTo'](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':![],'message':'Fehler:\x20'+_0x326b52[_0x405259(0x113)]},_0x9e72e8[_0x405259(0x32d)]);}}else{if(_0x9e72e8['command']===_0x405259(0x119)){const _0xa8dac0=await getWeatherContext(this),_0xfd3fca=await getCalendarContext(this);this[_0x405259(0x243)](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![],'weather':_0xa8dac0,'calendar':_0xfd3fca},_0x9e72e8['callback']);}else{if(_0x9e72e8[_0x405259(0x2f8)]==='testNotification'){}else{if(_0x9e72e8['command']===_0x405259(0x21a)){if(!this[_0x405259(0x2ef)])return this['sendTo'](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':![],'isPro':![]},_0x9e72e8['callback']);let _0x461fd0={'status':_0x405259(0x32c),'details':'','lastCheck':0x0};try{_0x461fd0[_0x405259(0x154)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))['val'],_0x461fd0[_0x405259(0x1f8)]=(await this[_0x405259(0x2a5)](LTM_DP_DRIFT_DETAILS))[_0x405259(0x2f3)],_0x461fd0[_0x405259(0x258)]=(await this[_0x405259(0x2a5)](LTM_DP_DRIFT_LAST_CHECK))[_0x405259(0x2f3)];}catch(_0x4de750){}const _0x54e8db=this['analysisHistory']||[];this[_0x405259(0x243)](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x461fd0,'analysisHistory':_0x54e8db},_0x9e72e8[_0x405259(0x32d)]);}else{if(_0x9e72e8[_0x405259(0x2f8)]==='getOverviewData'){const _0x11c720=this['dailyDigests']['length'],_0x560552=new Date(),_0x2bf619=new Date(_0x560552[_0x405259(0x28e)](),_0x560552[_0x405259(0x227)](),_0x560552['getDate']())[_0x405259(0x27b)](),_0x1c3114=this[_0x405259(0x203)][_0x405259(0x2dc)](_0x4983f6=>new Date(_0x4983f6['timestamp'])[_0x405259(0x27b)]()>_0x2bf619)[_0x405259(0x27c)],_0x39a464=new Array(0x18)['fill'](0x0);this[_0x405259(0x203)][_0x405259(0x2de)](_0x4cc93f=>{const _0x145004=_0x405259,_0x22afe3=new Date(_0x4cc93f[_0x145004(0x242)]);if(_0x22afe3['getTime']()>_0x2bf619)_0x39a464[_0x22afe3['getHours']()]++;});let _0x1d7502={'status':_0x405259(0x32c)};try{_0x1d7502[_0x405259(0x154)]=(await this[_0x405259(0x2a5)](LTM_DP_DRIFT_STATUS))[_0x405259(0x2f3)];}catch(_0xfb0307){}let _0x315f9c='';try{const _0x5d296d=await this[_0x405259(0x2a5)](_0x405259(0x1b4));_0x315f9c=_0x5d296d?_0x5d296d[_0x405259(0x2f3)]:'';}catch(_0x3258e8){}let _0x104f9b=null;!this[_0x405259(0x2b1)]&&(_0x104f9b=this[_0x405259(0x105)][_0x405259(0x14e)]?_0x405259(0x197):_0x405259(0x250));let _0x32591f={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x388f06=await this[_0x405259(0x2a5)](_0x405259(0x20b)),_0x4f3b49=await this[_0x405259(0x2a5)](_0x405259(0x22d)),_0x1ad607=await this[_0x405259(0x2a5)]('analysis.automation.targetId'),_0x5560c4=await this['getStateAsync'](_0x405259(0x222)),_0x2ecd31=await this[_0x405259(0x2a5)](_0x405259(0x129));_0x388f06&&_0x388f06[_0x405259(0x2f3)]&&(_0x32591f['detected']=!![],_0x32591f[_0x405259(0x176)]=_0x4f3b49?_0x4f3b49[_0x405259(0x2f3)]:'',_0x32591f[_0x405259(0x172)]=_0x1ad607?_0x1ad607[_0x405259(0x2f3)]:'',_0x32591f[_0x405259(0x2c7)]=_0x5560c4?_0x5560c4[_0x405259(0x2f3)]:''),_0x32591f['autoApply']=_0x2ecd31?!!_0x2ecd31[_0x405259(0x2f3)]:![];}catch(_0x30fbc6){}this[_0x405259(0x243)](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0xf),'stats':{'digestCount':_0x11c720,'eventCountToday':_0x1c3114,'hourlyActivity':_0x39a464,'driftStatus':_0x1d7502[_0x405259(0x154)],'isPresent':this[_0x405259(0x1c9)],'presenceWho':_0x315f9c,'minDays':this[_0x405259(0x105)][_0x405259(0x1dc)]||0x7,'stbDays':this[_0x405259(0x105)][_0x405259(0x156)]||0xe,'ltbDays':this['config'][_0x405259(0x1f5)]||0x3c,'systemError':_0x104f9b},'automation':_0x32591f},_0x9e72e8[_0x405259(0x32d)]);}else{if(_0x9e72e8[_0x405259(0x2f8)]===_0x405259(0x173)){const _0x758ac3=await this[_0x405259(0x298)](_0x405259(0x2e0),_0x405259(0x21c)),_0x2f5449=[];if(_0x758ac3)for(const _0x6b2926 in _0x758ac3){const _0x156e72=_0x758ac3[_0x6b2926],_0x5e2453=(_0x156e72['common']&&typeof _0x156e72[_0x405259(0x32a)][_0x405259(0x22c)]===_0x405259(0x2d7)?_0x156e72[_0x405259(0x32a)]['name']['de']:_0x156e72['common'][_0x405259(0x22c)])||_0x156e72[_0x405259(0x32a)][_0x405259(0x22c)];_0x2f5449['push']({'id':_0x6b2926,'name':_0x5e2453});}this[_0x405259(0x243)](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![],'enums':_0x2f5449},_0x9e72e8['callback']);}else{if(_0x9e72e8['command']===_0x405259(0x166))try{const _0x369e4f=await scanForDevices(this,_0x9e72e8[_0x405259(0x113)]||{});this['sendTo'](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![],'devices':_0x369e4f},_0x9e72e8[_0x405259(0x32d)]);}catch(_0x2a1ad7){this[_0x405259(0x243)](_0x9e72e8['from'],_0x9e72e8[_0x405259(0x2f8)],{'success':![],'error':_0x2a1ad7[_0x405259(0x113)]},_0x9e72e8[_0x405259(0x32d)]);}else{if(_0x9e72e8[_0x405259(0x2f8)]===_0x405259(0x273)){const _0x43a776=_0x9e72e8[_0x405259(0x113)]['instance'];if(!_0x43a776)return this[_0x405259(0x243)](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':![],'error':_0x405259(0x1c7)},_0x9e72e8[_0x405259(0x32d)]);const _0x4d5b0d=await getCalendarNames(this,_0x43a776);this[_0x405259(0x243)](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![],'names':_0x4d5b0d},_0x9e72e8[_0x405259(0x32d)]);}else{if(_0x9e72e8['command']===_0x405259(0x13a)){const {targetId:_0x7b71cc,targetValue:_0x4a9370}=_0x9e72e8[_0x405259(0x113)];this[_0x405259(0x263)][_0x405259(0x2a1)](_0x405259(0x317)+_0x7b71cc+_0x405259(0x201)+_0x4a9370),await this[_0x405259(0x151)](_0x405259(0x20b),{'val':!![],'ack':!![]}),await this[_0x405259(0x151)](_0x405259(0x22d),{'val':_0x405259(0x252)+_0x7b71cc,'ack':!![]}),await this[_0x405259(0x151)]('analysis.automation.targetId',{'val':_0x7b71cc,'ack':!![]}),await this[_0x405259(0x151)]('analysis.automation.targetValue',{'val':_0x4a9370,'ack':!![]}),this['sendTo'](_0x9e72e8['from'],_0x9e72e8['command'],{'success':!![]},_0x9e72e8[_0x405259(0x32d)]);}else{if(_0x9e72e8['command']===_0x405259(0x1fa)){const {historyId:_0x358ab0,rating:_0x43a804,comment:_0x495ff6,alertReason:_0x50f3d3}=_0x9e72e8[_0x405259(0x113)];_0x358ab0&&_0x43a804?(await saveFeedback(this,{'timestamp':Date[_0x405259(0x1b7)](),'historyId':_0x358ab0,'rating':_0x43a804,'comment':_0x495ff6,'alertReason':_0x50f3d3}),this['sendTo'](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![]},_0x9e72e8['callback'])):this['sendTo'](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':![],'error':'Missing\x20data'},_0x9e72e8[_0x405259(0x32d)]);}else _0x9e72e8['command']==='dismissAutomation'&&(this['log'][_0x405259(0x2a1)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x405259(0x151)](_0x405259(0x20b),{'val':![],'ack':!![]}),await this[_0x405259(0x151)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x405259(0x243)](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':!![]},_0x9e72e8[_0x405259(0x32d)]));}}}}}}}}}}catch(_0x4392bd){this[_0x405259(0x263)][_0x405259(0x1ce)](_0x405259(0x329)+_0x9e72e8[_0x405259(0x2f8)]+':\x20'+_0x4392bd[_0x405259(0x113)]);if(_0x9e72e8[_0x405259(0x32d)])this[_0x405259(0x243)](_0x9e72e8[_0x405259(0x30b)],_0x9e72e8[_0x405259(0x2f8)],{'success':![],'error':_0x4392bd[_0x405259(0x113)]},_0x9e72e8[_0x405259(0x32d)]);}}}if(require[a0_0x187488(0x169)]!==module)module['exports']=_0x5e9e0b=>new CogniLiving(_0x5e9e0b);else new CogniLiving();