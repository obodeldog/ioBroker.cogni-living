const a0_0x221687=a0_0x5911;function a0_0x4635(){const _0x329594=['currentSystemMode','values','window','üíæ\x20Saving\x20Daily\x20History\x20for\x20','from','Niemand','Sec-Training\x20started...','analysis.energy.warmupSources','history','replayTodayEvents','TRAIN_COMFORT','Gemini\x20Init\x20Error:\x20','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','ANALYZE_GAIT','sendTo','type','setPresence','loadSystemMode','analysis.activity.roomStats','üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20','.uptime','.venv','reduce','getHours','¬∞C\x20(Innen:\x20','mkdirSync','126980xwHgwj','History\x20Save\x20Error:\x20','party','historyJob','config','CALCULATE_HEALTH_TREND','outdoorSensorId','integrateRoomTime','terrasse','analysis.prediction.trackerConfidence','getCalendarNames','toLowerCase','rawEventLog','useCalendar','presenceDevices','checkWifiPresence:\x20Error\x20checking\x20','runPythonHealthCheck','initHistory','stopService','modeResetJob','getStateAsync',':\x20Temp-Differenz\x20','lastTrackerEventTime','calendarName','\x20sequences','{\x22history\x22:{}}','./lib/scheduler','Gemini\x20Report\x20Night','guest','30505DnXqSL','events.history','moduleEnergy','enum.functions.*','presenceCheckTimer','isGracePeriodActive','cogni-living\x20adapter\x20starting\x20(v','testContext','abortExitTimer','\x20Kalender-Adapter\x20gefunden.','analysis.health.geminiDay','analysis.prediction.trackerTopRoom','analysis.trigger','üí®\x20L√ºftung\x20in\x20','20kNEsSq','telegram','2056995oGSVlF','temperature','parse','manual','Warte\x20auf\x20Analyse...','system.adapter.ical.','substring','moduleSecurity','value','./lib/setup','handleInfrasound','name','infrasoundEnabled','analysis.energy.warmupTargets','initSchedules','\x20rooms)','analysis.health.todayVector','Warm-Up\x20Time','find','error','genAI','geminiModel','subscribeStates','onUnload','triggerEnergyPrediction\x20Error:\x20','toString','pythonBridge','LTM.dailyDigests','startSystem','analysis.automation.patternDetected','writeFileSync','briefingJob','pulse','[PythonBridge]\x20Forwarding\x20command:\x20','isProVersion','Live\x20Event\x20Pulse','Adapter','updateHealthVector','comfort','daswetter.0','namespace','system.presenceWho','generateContent','checkThermostats','Init...','‚Ü∫\x20Replaying\x20','length','isRelevantActivity','enum','location','.system.mode','includes','protectAiMemory','Lernphase\x20(','analysis.security.learningStatus','analysis.health.todayRoomDetails','scheduleJob','motion','triggerGaitAnalysis\x20parse\x20error:\x20','getDate','search','sunny','TRAIN_SECURITY','toISOString','map','toFixed','accuweather.0','.json','SYSTEM_DP_MODE','system.adapter.ical.È¶ô','üîä\x20Infraschall:\x20','state','analysis.training.triggerHealth','LTM.triggerDailyDigest','now','sensorLastValues','licenseKey','energy','instance','Party\x20Mode','open','activeModules','abs','endsWith','bootTime','systemConfig','analysis.health.geminiNight','getTime','isPresent','2-digit','ltmJob','runGeminiAnalysis','Say\x20Hello','setHours','LTM.trainingData.sequences','max','263416EiplBb','saveDailyHistory','unload','LTM.rawEventLog','Corrupt','üì¶\x20Restored\x20','triggerEnergyPrediction','application/json','infrasoundThreshold','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','min','pop','ready','./lib/installer','1692075MUeGon','analysis.training.status','onMessage','todayVector','‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','exitGraceTimer','üîÆ\x20Energy\x20Prediction\x20triggered\x20(','NextHours.Location_1.Day_1.current.symbol_desc','./lib/recorder','PREDICT_ENERGY','Unbekannt','scanDevices','message','online','inactivityThresholdHours','main','eventHistory','getObjectViewAsync','object','219886kMGBku','(((.+)+)+)+$','fill','weatherTempId','then','haust√ºr','getOverviewData','memoryCache','times','./lib/python_bridge','slice','python','all','debug','SYSTEM_MODES','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','ack','getMinutes','stateChange','command','keys','cancel','checkCalendarTriggers','Guest\x20Mode','existsSync','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','Daily\x20Activity\x20Vector\x20(48x30min)','callback','infrasoundLocked','NORMAL','updateTopology','getGenerativeModel','toLocaleDateString','add','91077ZqfnoQ','rows','analysis.automation.targetId',',\x20Events:\x0a','\x20Tage)','onReady','analysis.automation.targetValue','./lib/automation','Verbindung\x20erfolgreich:\x20','12ENnOqC','floor','thermostat','infrasoundSensorId','cogni-living','exitTimer','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','analysis.health.activityTrend','analysis.visualization.pulse','timestamp','number','Keine\x20Daten','üìù\x20Manual\x20event\x20logged:\x20','subscribeForeignStates','getForeignObjectsAsync','info','sonn','modules','forEach','trackerHeartbeat','subscribeForeignStatesAsync','enum.rooms.*','analysis.safety.infrasoundAlert','./lib/ai_agent','üîä\x20Infraschall-Alarm:\x20','system.adapter.','processSensorEvent','General\x20Activity\x20Trend','TRAIN_HEALTH','devices','filter','bind','text','NIGHT','moduleHealth','send','getAbsoluteDefaultDataDir','log','\x20-\x20','json','geminiApiKey','analysis.energy.warmupTimes','utf8','constructor','Unknown','.data.table','roomIntegratorTimer','isSolar','getForeignStateAsync','analysisTimer','generateHealthReport','infrasoundArmingId','common','healthTrendInterval','cleanupGhostInterventions','sendNotification','join','updateSchedulePreview','pressureBuffer','‚úÖ\x20History\x20saved:\x20','setState','SET_LEARNING_MODE','clear','@google/generative-ai','testApiKey','scanThermostats','checkSolarCondition','node-schedule','version','setStateAsync','dailyDigests','triggerInfrasoundCorrelation','replace','split','...','checkLicense','\x20events\x20from\x20today...','Gemini\x20Report\x20Day','models/gemini-flash-latest','\x20events\x20from\x20standard\x20storage.','executeAutomationAction','triggerGaitAnalysis','response','de-DE','string','bin','date','door','stringify','readFileSync',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','moduleComfort','initZombies','weatherunderground.0','push','onStateChange','refreshCalendar\x20failed:\x20','analyzeWindowOpening','setObjectNotExistsAsync','sources','checkWifiPresence','warn','triggerHealth\x20error:\x20','Manual\x20Event','\x22history\x22:{}','automation.triggerAction','DAY','Event','dependencyInstallInProgress','unshift','.isOnline','¬∞C)','val','security','health','Aktiv\x20(','calendarCheckTimer','toLocaleTimeString','system','analysis.activity.roomHistory','.last_seen'];a0_0x4635=function(){return _0x329594;};return a0_0x4635();}(function(_0x334463,_0x197ca0){const _0x426e90=a0_0x5911,_0x580076=_0x334463();while(!![]){try{const _0x3be281=-parseInt(_0x426e90(0x10f))/0x1+parseInt(_0x426e90(0x1be))/0x2+-parseInt(_0x426e90(0x1e0))/0x3*(-parseInt(_0x426e90(0x13a))/0x4)+-parseInt(_0x426e90(0x12c))/0x5*(-parseInt(_0x426e90(0x1e9))/0x6)+parseInt(_0x426e90(0x1aa))/0x7+-parseInt(_0x426e90(0x19c))/0x8+-parseInt(_0x426e90(0x13c))/0x9;if(_0x3be281===_0x197ca0)break;else _0x580076['push'](_0x580076['shift']());}catch(_0x2b3eee){_0x580076['push'](_0x580076['shift']());}}}(a0_0x4635,0x1f0e3));const a0_0xa8373d=(function(){let _0x271115=!![];return function(_0x422478,_0x35b480){const _0x58c545=_0x271115?function(){if(_0x35b480){const _0x234e83=_0x35b480['apply'](_0x422478,arguments);return _0x35b480=null,_0x234e83;}}:function(){};return _0x271115=![],_0x58c545;};}()),a0_0x2c7650=a0_0xa8373d(this,function(){const _0x2543f5=a0_0x5911;return a0_0x2c7650['toString']()[_0x2543f5(0x178)](_0x2543f5(0x1bf))[_0x2543f5(0x155)]()[_0x2543f5(0xa7)](a0_0x2c7650)[_0x2543f5(0x178)](_0x2543f5(0x1bf));});a0_0x2c7650();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x221687(0xbb)),path=require('path'),fs=require('fs'),installer=require(a0_0x221687(0x1a9)),scanner=require('./lib/scanner'),schedulers=require(a0_0x221687(0x129)),topology=require('./lib/topology'),setup=require(a0_0x221687(0x145)),recorder=require(a0_0x221687(0x1b3)),pythonBridge=require(a0_0x221687(0x1c7)),aiAgent=require(a0_0x221687(0x93)),deadMan=require('./lib/dead_man'),automation=require(a0_0x221687(0x1e7)),GEMINI_MODEL=a0_0x221687(0xca);function a0_0x5911(_0x40aab1,_0xe632d1){const _0x1aa284=a0_0x4635();return a0_0x5911=function(_0x2c7650,_0xa8373d){_0x2c7650=_0x2c7650-0x82;let _0x4635cf=_0x1aa284[_0x2c7650];return _0x4635cf;},a0_0x5911(_0x40aab1,_0xe632d1);}class CogniLiving extends utils[a0_0x221687(0x160)]{constructor(_0x3f4704){const _0x4b6dfc=a0_0x221687;super({..._0x3f4704,'name':_0x4b6dfc(0x1ed)}),this[_0x4b6dfc(0x1bb)]=[],this['analysisHistory']=[],this[_0x4b6dfc(0x11b)]=[],this[_0x4b6dfc(0xc2)]=[],this['sensorLastValues']={},this[_0x4b6dfc(0x191)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x4b6dfc(0x194)]=!![],this[_0x4b6dfc(0x1ee)]=null,this[_0x4b6dfc(0x1b0)]=null,this[_0x4b6dfc(0x131)]=![],this[_0x4b6dfc(0x150)]=null,this[_0x4b6dfc(0x151)]=null,this[_0x4b6dfc(0xf5)]=setup[_0x4b6dfc(0x1cc)][_0x4b6dfc(0x1db)],this['isProVersion']=![],this['lastAlertState']=![],this['analysisTimer']=null,this[_0x4b6dfc(0xf0)]=null,this[_0x4b6dfc(0x130)]=null,this[_0x4b6dfc(0x196)]=null,this[_0x4b6dfc(0x122)]=null,this['driftAnalysisTimer']=null,this[_0x4b6dfc(0x15b)]=null,this[_0x4b6dfc(0x112)]=null,this[_0x4b6dfc(0x8f)]=null,this[_0x4b6dfc(0xb1)]=null,this[_0x4b6dfc(0xaa)]=null,this['dependencyInstallInProgress']=![],this[_0x4b6dfc(0x125)]=Date['now'](),this[_0x4b6dfc(0x1c5)]=null,this[_0x4b6dfc(0x190)]=Date['now'](),this[_0x4b6dfc(0x1da)]=![],this[_0x4b6dfc(0xb6)]=[],this[_0x4b6dfc(0x18d)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x4b6dfc(0x1a8),this['onReady'][_0x4b6dfc(0x9b)](this)),this['on'](_0x4b6dfc(0x1d0),this['onStateChange']['bind'](this)),this['on'](_0x4b6dfc(0x19e),this['onUnload'][_0x4b6dfc(0x9b)](this)),this['on'](_0x4b6dfc(0x1b7),this[_0x4b6dfc(0x1ac)][_0x4b6dfc(0x9b)](this));}async[a0_0x221687(0x1e5)](){const _0x497ab7=a0_0x221687;this[_0x497ab7(0xa1)][_0x497ab7(0x8b)](_0x497ab7(0x132)+this[_0x497ab7(0xc0)]+_0x497ab7(0xd6));if(this[_0x497ab7(0x113)][_0x497ab7(0x9e)]!==undefined)this['activeModules'][_0x497ab7(0xee)]=this[_0x497ab7(0x113)][_0x497ab7(0x9e)];if(this['config'][_0x497ab7(0x143)]!==undefined)this[_0x497ab7(0x18d)][_0x497ab7(0xed)]=this[_0x497ab7(0x113)][_0x497ab7(0x143)];if(this[_0x497ab7(0x113)][_0x497ab7(0x12e)]!==undefined)this['activeModules'][_0x497ab7(0x189)]=this[_0x497ab7(0x113)][_0x497ab7(0x12e)];if(this[_0x497ab7(0x113)]['moduleComfort']!==undefined)this['activeModules'][_0x497ab7(0x162)]=this['config'][_0x497ab7(0xd7)];if(this[_0x497ab7(0x113)][_0x497ab7(0x8d)])this[_0x497ab7(0x18d)]={...this[_0x497ab7(0x18d)],...this[_0x497ab7(0x113)]['modules']};this[_0x497ab7(0x158)]();}async[a0_0x221687(0x158)](){const _0x1d595c=a0_0x221687;await setup[_0x1d595c(0xd8)](this);try{this['isProVersion']=await setup[_0x1d595c(0xc7)](this[_0x1d595c(0x113)][_0x1d595c(0x188)]);}catch(_0x5ad032){}if(!this['config'][_0x1d595c(0x1b9)]||this[_0x1d595c(0x113)][_0x1d595c(0x1b9)]<0.1)this['config'][_0x1d595c(0x1b9)]=0xc;await setup[_0x1d595c(0x120)](this),await setup['initSystemConfig'](this),topology[_0x1d595c(0x1dc)](this);try{const _0x32eb96=await this['getStateAsync']('analysis.energy.warmupTimes'),_0x1c16d9=await this[_0x1d595c(0x123)](_0x1d595c(0xfc));_0x32eb96&&_0x32eb96[_0x1d595c(0xec)]&&_0x1c16d9&&_0x1c16d9[_0x1d595c(0xec)]&&(Date[_0x1d595c(0x186)]()-_0x32eb96['ts']<0x4*0xe10*0x3e8&&(this[_0x1d595c(0x1c5)]={'times':JSON[_0x1d595c(0x13e)](_0x32eb96[_0x1d595c(0xec)]),'sources':JSON['parse'](_0x1c16d9[_0x1d595c(0xec)])}));}catch(_0x1c7ae4){}if(this[_0x1d595c(0x113)][_0x1d595c(0xa4)])try{this[_0x1d595c(0x150)]=new GoogleGenerativeAI(this[_0x1d595c(0x113)][_0x1d595c(0xa4)]),this['geminiModel']=this['genAI'][_0x1d595c(0x1dd)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x1d595c(0x1a3)}});}catch(_0x241ed3){this[_0x1d595c(0xa1)][_0x1d595c(0x14f)](_0x1d595c(0x100)+_0x241ed3[_0x1d595c(0x1b7)]);}await setup['createAllObjects'](this),await this[_0x1d595c(0x106)](),schedulers[_0x1d595c(0x14a)](this),await this[_0x1d595c(0xde)](_0x1d595c(0x84),{'type':'state','common':{'name':_0x1d595c(0x15f),'type':_0x1d595c(0x86),'role':_0x1d595c(0x144),'read':!![],'write':![]},'native':{}}),await this[_0x1d595c(0xde)]('analysis.activity.roomStats',{'type':_0x1d595c(0x183),'common':{'name':'Room\x20Dwell\x20Time\x20Stats','type':_0x1d595c(0xd0),'role':_0x1d595c(0xa3),'read':!![],'write':![],'def':_0x1d595c(0x1cd)},'native':{}}),await this[_0x1d595c(0xde)](_0x1d595c(0xf3),{'type':'state','common':{'name':'Room\x20History\x20(24h\x20Buckets)','type':'string','role':_0x1d595c(0xa3),'read':!![],'write':![],'def':_0x1d595c(0x128)},'native':{}}),await this[_0x1d595c(0xde)](_0x1d595c(0x192),{'type':'state','common':{'name':_0x1d595c(0x12a),'type':_0x1d595c(0xd0),'role':_0x1d595c(0x9c),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x1d595c(0xde)](_0x1d595c(0x136),{'type':_0x1d595c(0x183),'common':{'name':_0x1d595c(0xc9),'type':'string','role':_0x1d595c(0x9c),'read':!![],'write':![],'def':_0x1d595c(0x140)},'native':{}}),await this[_0x1d595c(0xde)](_0x1d595c(0x14c),{'type':'state','common':{'name':_0x1d595c(0x1d8),'type':'string','role':_0x1d595c(0xa3),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1d595c(0xde)]('analysis.health.todayRoomDetails',{'type':_0x1d595c(0x183),'common':{'name':'Daily\x20Room\x20Details\x20(48x30min)','type':_0x1d595c(0xd0),'role':_0x1d595c(0xa3),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1d595c(0xde)](_0x1d595c(0x83),{'type':_0x1d595c(0x183),'common':{'name':_0x1d595c(0x97),'type':_0x1d595c(0x86),'role':'value','unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x1d595c(0xde)](_0x1d595c(0xa5),{'type':'state','common':{'name':_0x1d595c(0x14d),'type':_0x1d595c(0xd0),'role':_0x1d595c(0xa3),'read':!![],'write':![]},'native':{}});try{const _0x5bc225=await this['getStateAsync'](_0x1d595c(0x12d));if(_0x5bc225&&_0x5bc225[_0x1d595c(0xec)]){this[_0x1d595c(0x1bb)]=JSON['parse'](_0x5bc225[_0x1d595c(0xec)]);if(this[_0x1d595c(0x15e)]){const _0x4e7190=await this[_0x1d595c(0x123)](_0x1d595c(0x19f));if(_0x4e7190&&_0x4e7190[_0x1d595c(0xec)])this[_0x1d595c(0x11b)]=JSON[_0x1d595c(0x13e)](_0x4e7190['val']);}this[_0x1d595c(0xa1)][_0x1d595c(0x8b)](_0x1d595c(0x1a1)+this[_0x1d595c(0x1bb)][_0x1d595c(0x16a)]+_0x1d595c(0xcb));}}catch(_0x3be353){this[_0x1d595c(0x1bb)]=[];}try{const _0x344c62=await this[_0x1d595c(0x123)]('LTM.dailyDigests');if(_0x344c62&&_0x344c62[_0x1d595c(0xec)])this[_0x1d595c(0xc2)]=JSON[_0x1d595c(0x13e)](_0x344c62[_0x1d595c(0xec)]);}catch(_0x652b39){this[_0x1d595c(0xc2)]=[];}const _0x3f202f=this[_0x1d595c(0xc2)][_0x1d595c(0x16a)]>=(this[_0x1d595c(0x113)]['minDaysForBaseline']||0x7)?_0x1d595c(0xef)+this['dailyDigests']['length']+_0x1d595c(0x1e4):_0x1d595c(0x171)+this['dailyDigests'][_0x1d595c(0x16a)]+'/'+(this[_0x1d595c(0x113)]['minDaysForBaseline']||0x7)+')';await this[_0x1d595c(0xc1)]('LTM.baselineStatus',{'val':_0x3f202f,'ack':!![]}),this[_0x1d595c(0x152)](_0x1d595c(0x138)),this['subscribeStates'](_0x1d595c(0x185)),this['subscribeStates'](_0x1d595c(0x184));this[_0x1d595c(0x113)]['infrasoundEnabled']&&this[_0x1d595c(0x113)][_0x1d595c(0x1ec)]&&this[_0x1d595c(0x18d)][_0x1d595c(0xed)]&&this[_0x1d595c(0x89)](this[_0x1d595c(0x113)]['infrasoundSensorId']);const _0x4cb9cf=this[_0x1d595c(0x113)][_0x1d595c(0x99)];if(_0x4cb9cf)for(const _0xb5fe2 of _0x4cb9cf){await this[_0x1d595c(0x90)](_0xb5fe2['id']);}const _0x54f800=this[_0x1d595c(0x113)][_0x1d595c(0x11d)];if(_0x54f800)for(const _0x7facd5 of _0x54f800){await this[_0x1d595c(0x90)](_0x7facd5);}const _0xde3852=require(_0x1d595c(0xbf));if(this[_0x1d595c(0x112)])this[_0x1d595c(0x112)][_0x1d595c(0x1d3)]();this[_0x1d595c(0x112)]=_0xde3852[_0x1d595c(0x174)]('59\x2023\x20*\x20*\x20*',()=>{const _0x3e7606=_0x1d595c;this[_0x3e7606(0x19d)]();}),setTimeout(()=>this[_0x1d595c(0xfe)](),0x1388);if(this['roomIntegratorTimer'])clearInterval(this[_0x1d595c(0xaa)]);this[_0x1d595c(0x116)](),this['roomIntegratorTimer']=setInterval(async()=>{const _0x339b23=_0x1d595c;await this[_0x339b23(0x116)]();},0x3c*0x3e8);if(this[_0x1d595c(0xb1)])clearInterval(this[_0x1d595c(0xb1)]);this['healthTrendInterval']=setInterval(()=>{const _0x56e681=_0x1d595c;this['isProVersion']&&this[_0x56e681(0x18d)]['health']&&this['runPythonHealthCheck']();},0x4*0x3c*0x3c*0x3e8);if(this[_0x1d595c(0xad)])clearInterval(this[_0x1d595c(0xad)]);this[_0x1d595c(0x18d)][_0x1d595c(0x189)]&&(this[_0x1d595c(0xad)]=setInterval(()=>{const _0x35a7e1=_0x1d595c;this[_0x35a7e1(0x1a2)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x1d595c(0x1a2)](),0x2710));if(this['calendarCheckTimer'])clearInterval(this['calendarCheckTimer']);this['config'][_0x1d595c(0x11c)]&&this[_0x1d595c(0x18d)][_0x1d595c(0x189)]&&(this[_0x1d595c(0xf0)]=setInterval(()=>{const _0x2f1099=_0x1d595c;automation[_0x2f1099(0x1d4)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x1d595c(0x1d4)](this),0x3a98));if(this[_0x1d595c(0x130)])clearInterval(this[_0x1d595c(0x130)]);this[_0x1d595c(0x113)][_0x1d595c(0x11d)]&&this[_0x1d595c(0x113)][_0x1d595c(0x11d)]['length']>0x0&&(this['presenceCheckTimer']=setInterval(async()=>{const _0x9cdb1=_0x1d595c;await this[_0x9cdb1(0xe0)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0x1d595c(0xe0)](),0x1388));const _0xc10fb3=path[_0x1d595c(0xb4)](__dirname,_0x1d595c(0x10a),_0x1d595c(0xd1),_0x1d595c(0x1c9));pythonBridge['startService'](this,_0xc10fb3);}[a0_0x221687(0x153)](_0x2ef540){const _0x15b6bd=a0_0x221687;if(this[_0x15b6bd(0x112)])this[_0x15b6bd(0x112)][_0x15b6bd(0x1d3)]();this[_0x15b6bd(0x19d)]()[_0x15b6bd(0x1c2)](()=>{const _0x26c334=_0x15b6bd;if(this[_0x26c334(0xad)])clearInterval(this[_0x26c334(0xad)]);if(this['calendarCheckTimer'])clearInterval(this[_0x26c334(0xf0)]);if(this[_0x26c334(0x130)])clearInterval(this[_0x26c334(0x130)]);if(this[_0x26c334(0xaa)])clearInterval(this[_0x26c334(0xaa)]);recorder[_0x26c334(0x134)](this),pythonBridge[_0x26c334(0x121)](this),_0x2ef540();});}async[a0_0x221687(0xfe)](){const _0x1f1b4a=a0_0x221687;if(!this[_0x1f1b4a(0x1bb)]||this[_0x1f1b4a(0x1bb)]['length']===0x0){this[_0x1f1b4a(0xa1)][_0x1f1b4a(0xe1)](_0x1f1b4a(0x82));return;}this[_0x1f1b4a(0xa1)]['info'](_0x1f1b4a(0x169)+this[_0x1f1b4a(0x1bb)][_0x1f1b4a(0x16a)]+_0x1f1b4a(0xc8));const _0x3fbf4a=new Date()['setHours'](0x0,0x0,0x0,0x0),_0x704b39=_0x1f1b4a(0xf3);let _0x5cf4dd={'history':{},'date':new Date()[_0x1f1b4a(0x1de)]()};const _0x351455=_0x1f1b4a(0x14c),_0x294c10=_0x1f1b4a(0x173);let _0x1bf628=new Array(0x30)[_0x1f1b4a(0x1c0)](0x0),_0x3dc40a=Array[_0x1f1b4a(0xf9)]({'length':0x30},()=>[]);this['eventHistory'][_0x1f1b4a(0x8e)](_0x171b1c=>{const _0x5d1101=_0x1f1b4a;if(_0x171b1c['timestamp']>=_0x3fbf4a){if(recorder[_0x5d1101(0x16b)](_0x171b1c['type'],_0x171b1c[_0x5d1101(0x144)])){const _0x41436d=new Date(_0x171b1c[_0x5d1101(0x85)]),_0x110b50=_0x41436d['getHours']()*0x2+(_0x41436d[_0x5d1101(0x1cf)]()>=0x1e?0x1:0x0);if(_0x110b50<0x30){_0x1bf628[_0x110b50]++;const _0x6d1442=_0x171b1c[_0x5d1101(0x16d)]||_0x171b1c['name']||'?';let _0x188069=_0x3dc40a[_0x110b50];!_0x188069[_0x5d1101(0x16f)](_0x6d1442)&&_0x188069[_0x5d1101(0xda)](_0x6d1442);}const _0x5bbed0=_0x41436d[_0x5d1101(0x10c)]();let _0x3c8e63=_0x171b1c['location']||_0x5d1101(0xa8);const _0x4b6a32=(this[_0x5d1101(0x113)][_0x5d1101(0x99)]||[])[_0x5d1101(0x14e)](_0x35274d=>_0x35274d[_0x5d1101(0x16d)]===_0x3c8e63);if(_0x4b6a32)_0x3c8e63=_0x4b6a32[_0x5d1101(0x16d)];if(!_0x5cf4dd[_0x5d1101(0xfd)][_0x3c8e63])_0x5cf4dd['history'][_0x3c8e63]=new Array(0x18)['fill'](0x0);if(_0x5cf4dd['history'][_0x3c8e63][_0x5bbed0]<0x3c)_0x5cf4dd[_0x5d1101(0xfd)][_0x3c8e63][_0x5bbed0]++;}}});const _0x58486f=await this[_0x1f1b4a(0x123)](_0x704b39);(!_0x58486f||!_0x58486f['val']||_0x58486f[_0x1f1b4a(0xec)]==='{}'||_0x58486f[_0x1f1b4a(0xec)]['includes'](_0x1f1b4a(0xe4)))&&await this[_0x1f1b4a(0xc1)](_0x704b39,{'val':JSON[_0x1f1b4a(0xd4)](_0x5cf4dd),'ack':!![]}),await this[_0x1f1b4a(0xc1)](_0x351455,{'val':JSON[_0x1f1b4a(0xd4)](_0x1bf628),'ack':!![]}),await this[_0x1f1b4a(0xc1)](_0x294c10,{'val':JSON[_0x1f1b4a(0xd4)](_0x3dc40a),'ack':!![]}),this['log'][_0x1f1b4a(0x8b)](_0x1f1b4a(0x1d7));}async[a0_0x221687(0x19d)](){const _0x1e8345=a0_0x221687;if(!this[_0x1e8345(0x18d)][_0x1e8345(0xee)])return;const _0xbe3529=new Date()[_0x1e8345(0x17b)]()[_0x1e8345(0xc5)]('T')[0x0];this['log'][_0x1e8345(0x1cb)](_0x1e8345(0xf8)+_0xbe3529+_0x1e8345(0xc6));try{const [_0x533e6a,_0x18db40,_0x3de478,_0x45e7ef,_0x394165,_0xc9c57c]=await Promise[_0x1e8345(0x1ca)]([this[_0x1e8345(0x123)](_0x1e8345(0xf3)),this[_0x1e8345(0x123)](_0x1e8345(0x192)),this[_0x1e8345(0x123)](_0x1e8345(0x136)),this[_0x1e8345(0x123)]('analysis.security.lastScore'),this['getStateAsync'](_0x1e8345(0x14c)),this[_0x1e8345(0x123)](_0x1e8345(0x83))]),_0x4615a8=this[_0x1e8345(0x1bb)][_0x1e8345(0x9a)](_0x5cbef2=>_0x5cbef2[_0x1e8345(0x85)]>=new Date()[_0x1e8345(0x199)](0x0,0x0,0x0,0x0)&&(_0x5cbef2[_0x1e8345(0x147)][_0x1e8345(0x11a)]()[_0x1e8345(0x16f)](_0x1e8345(0x1c3))||_0x5cbef2[_0x1e8345(0x147)]['toLowerCase']()[_0x1e8345(0x16f)](_0x1e8345(0x117)))&&(_0x5cbef2['value']===!![]||_0x5cbef2['value']===_0x1e8345(0x18c)))[_0x1e8345(0x16a)];let _0x47ba78=0x55;if(_0xc9c57c&&_0xc9c57c[_0x1e8345(0xec)]!==undefined)_0x47ba78=Math[_0x1e8345(0x1a6)](0x64,Math[_0x1e8345(0x19b)](0x14,Math['round'](0x50+Number(_0xc9c57c['val'])*0x5)));const _0x228a13={'date':_0xbe3529,'timestamp':Date['now'](),'roomHistory':_0x533e6a?.[_0x1e8345(0xec)]?JSON['parse'](_0x533e6a[_0x1e8345(0xec)]):{},'geminiNight':_0x18db40?.[_0x1e8345(0xec)]||_0x1e8345(0x87),'geminiDay':_0x3de478?.[_0x1e8345(0xec)]||'Keine\x20Daten','anomalyScore':_0x45e7ef?.[_0x1e8345(0xec)]||0.1,'todayVector':_0x394165?.[_0x1e8345(0xec)]?JSON['parse'](_0x394165[_0x1e8345(0xec)]):new Array(0x30)[_0x1e8345(0x1c0)](0x0),'batteryLevel':_0x47ba78,'freshAirCount':_0x4615a8,'eventHistory':this[_0x1e8345(0x1bb)]},_0x577896=utils[_0x1e8345(0xa0)](),_0x547a73=path['join'](_0x577896,_0x1e8345(0x1ed),_0x1e8345(0xfd));if(!fs[_0x1e8345(0x1d6)](_0x547a73))fs[_0x1e8345(0x10e)](_0x547a73,{'recursive':!![]});const _0x43acd9=path['join'](_0x547a73,_0xbe3529+_0x1e8345(0x17f));fs[_0x1e8345(0x15a)](_0x43acd9,JSON['stringify'](_0x228a13)),this[_0x1e8345(0xa1)]['info'](_0x1e8345(0xb7)+_0x43acd9);}catch(_0x3f2307){this[_0x1e8345(0xa1)][_0x1e8345(0x14f)](_0x1e8345(0x110)+_0x3f2307['message']);}}async[a0_0x221687(0x116)](){const _0x6bcbd3=a0_0x221687;if(!this[_0x6bcbd3(0x194)])return;try{let _0x3f252f=null;try{const _0xf28012=await this[_0x6bcbd3(0x123)](_0x6bcbd3(0x137)),_0x175ce3=await this['getStateAsync'](_0x6bcbd3(0x118));if(_0xf28012&&_0xf28012['val']&&_0x175ce3&&_0x175ce3[_0x6bcbd3(0xec)]&&_0x175ce3['val']>0.3){if(_0xf28012[_0x6bcbd3(0xec)]!==_0x6bcbd3(0xa8)&&_0xf28012[_0x6bcbd3(0xec)]!==_0x6bcbd3(0x168))_0x3f252f=_0xf28012[_0x6bcbd3(0xec)];}}catch(_0x3416a4){}if(!_0x3f252f){const _0x3b8f8d=this[_0x6bcbd3(0x113)][_0x6bcbd3(0x99)]||[];for(const _0xa9fc71 of _0x3b8f8d){if(_0xa9fc71[_0x6bcbd3(0x104)]==='motion'&&_0xa9fc71[_0x6bcbd3(0x16d)])try{const _0x48c3ec=await this[_0x6bcbd3(0xac)](_0xa9fc71['id']);if(_0x48c3ec&&(_0x48c3ec[_0x6bcbd3(0xec)]===!![]||_0x48c3ec[_0x6bcbd3(0xec)]==='on'||_0x48c3ec[_0x6bcbd3(0xec)]===0x1)){_0x3f252f=_0xa9fc71[_0x6bcbd3(0x16d)];break;}}catch(_0x4e4c85){}}}if(!_0x3f252f)return;const _0x4835bd=this[_0x6bcbd3(0x113)][_0x6bcbd3(0x99)]||[];let _0x44a8cd=_0x3f252f;const _0x490c64=_0x4835bd[_0x6bcbd3(0x14e)](_0x487f82=>_0x487f82[_0x6bcbd3(0x16d)]&&_0x487f82[_0x6bcbd3(0x16d)]['toLowerCase']()===_0x3f252f[_0x6bcbd3(0x11a)]());if(_0x490c64)_0x44a8cd=_0x490c64[_0x6bcbd3(0x16d)];const _0x47af7f=_0x6bcbd3(0xf3),_0x315836=await this['getStateAsync'](_0x47af7f),_0x28df58=new Date()[_0x6bcbd3(0x1de)]();let _0xcd203a={'history':{},'date':_0x28df58};if(_0x315836&&_0x315836[_0x6bcbd3(0xec)])try{_0xcd203a=JSON[_0x6bcbd3(0x13e)](_0x315836[_0x6bcbd3(0xec)]);}catch(_0x5f3877){}_0xcd203a[_0x6bcbd3(0xd2)]!==_0x28df58&&(_0xcd203a[_0x6bcbd3(0xfd)]={},_0xcd203a[_0x6bcbd3(0xd2)]=_0x28df58);if(!_0xcd203a['history'][_0x44a8cd])_0xcd203a[_0x6bcbd3(0xfd)][_0x44a8cd]=new Array(0x18)['fill'](0x0);const _0x9b8a4a=new Date()[_0x6bcbd3(0x10c)]();if(_0xcd203a[_0x6bcbd3(0xfd)][_0x44a8cd][_0x9b8a4a]<0x3c)_0xcd203a[_0x6bcbd3(0xfd)][_0x44a8cd][_0x9b8a4a]++;await this['setStateAsync'](_0x47af7f,{'val':JSON[_0x6bcbd3(0xd4)](_0xcd203a),'ack':!![]});}catch(_0x1384f8){this['log'][_0x6bcbd3(0xe1)]('[Integrator]\x20Error:\x20'+_0x1384f8[_0x6bcbd3(0x1b7)]);}}async[a0_0x221687(0x1ac)](_0x3778f4){const _0x32cb6=a0_0x221687;if(typeof _0x3778f4===_0x32cb6(0x1bd)&&_0x3778f4[_0x32cb6(0x1b7)]){if(_0x3778f4[_0x32cb6(0x1d1)]==='getHistoryData'){const _0x5ea924=_0x3778f4[_0x32cb6(0x1b7)][_0x32cb6(0xd2)],_0x1f8da0=utils[_0x32cb6(0xa0)](),_0x155f08=path[_0x32cb6(0xb4)](_0x1f8da0,'cogni-living',_0x32cb6(0xfd),_0x5ea924+_0x32cb6(0x17f));if(fs[_0x32cb6(0x1d6)](_0x155f08))try{const _0x103a1d=JSON[_0x32cb6(0x13e)](fs[_0x32cb6(0xd5)](_0x155f08,_0x32cb6(0xa6)));this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'success':!![],'data':_0x103a1d},_0x3778f4['callback']);}catch(_0xe0bf35){this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'success':![],'error':_0x32cb6(0x1a0)},_0x3778f4['callback']);}else this['sendTo'](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'success':![],'error':'No\x20data'},_0x3778f4[_0x32cb6(0x1d9)]);}else{if(_0x3778f4['command']===_0x32cb6(0x1c4)){const _0x5ceabd=this[_0x32cb6(0xc2)][_0x32cb6(0x16a)];let _0x1b7fc4=new Array(0x30)['fill'](0x0),_0x2ec7a5=Array[_0x32cb6(0xf9)]({'length':0x30},()=>[]);try{const _0x2cffb4=await this[_0x32cb6(0x123)](_0x32cb6(0x14c));if(_0x2cffb4&&_0x2cffb4[_0x32cb6(0xec)])_0x1b7fc4=JSON[_0x32cb6(0x13e)](_0x2cffb4[_0x32cb6(0xec)]);const _0x3de753=await this[_0x32cb6(0x123)]('analysis.health.todayRoomDetails');if(_0x3de753&&_0x3de753[_0x32cb6(0xec)])_0x2ec7a5=JSON[_0x32cb6(0x13e)](_0x3de753[_0x32cb6(0xec)]);}catch(_0x573b6f){}let _0x2506f4=new Array(0x30)['fill'](0x0);try{const _0x31f3cb=new Date();_0x31f3cb['setDate'](_0x31f3cb[_0x32cb6(0x177)]()-0x1);const _0x57f55e=_0x31f3cb['toISOString']()[_0x32cb6(0xc5)]('T')[0x0],_0x4255ba=utils[_0x32cb6(0xa0)](),_0x3d36b6=path[_0x32cb6(0xb4)](_0x4255ba,_0x32cb6(0x1ed),_0x32cb6(0xfd),_0x57f55e+_0x32cb6(0x17f));if(fs[_0x32cb6(0x1d6)](_0x3d36b6)){const _0xf508ab=JSON['parse'](fs['readFileSync'](_0x3d36b6,_0x32cb6(0xa6)));if(_0xf508ab&&_0xf508ab['todayVector'])_0x2506f4=_0xf508ab[_0x32cb6(0x1ad)];}}catch(_0xacd940){}let _0xf4efce={'today':{},'yesterday':{}};try{const _0x54f135=await this[_0x32cb6(0x123)](_0x32cb6(0x107));if(_0x54f135&&_0x54f135[_0x32cb6(0xec)])_0xf4efce=JSON[_0x32cb6(0x13e)](_0x54f135[_0x32cb6(0xec)]);}catch(_0x1d77b6){}let _0x146963=null;try{const _0x1536da=await this[_0x32cb6(0x123)](_0x32cb6(0x83));if(_0x1536da)_0x146963=_0x1536da['val'];}catch(_0x358bb0){}if(_0x146963===undefined||_0x146963===null){const _0x5b1afe=_0x1b7fc4[_0x32cb6(0x10b)]((_0x392753,_0x1b1196)=>_0x392753+_0x1b1196,0x0),_0x2fa0d8=Math[_0x32cb6(0x1a6)](0x2,Math[_0x32cb6(0x19b)](-0x2,(0x64-_0x5b1afe)/0x32));_0x146963=_0x2fa0d8;}let _0x30966e=![],_0x4efbf5='',_0x3303f3='',_0x4db4ab='';try{const _0x597064=await this[_0x32cb6(0x123)](_0x32cb6(0x159));if(_0x597064&&_0x597064[_0x32cb6(0xec)]){_0x30966e=!![];const _0x495a71=await this[_0x32cb6(0x123)]('analysis.automation.description');_0x4efbf5=_0x495a71?_0x495a71[_0x32cb6(0xec)]:'';const _0x100607=await this[_0x32cb6(0x123)](_0x32cb6(0x1e2));_0x3303f3=_0x100607?_0x100607['val']:'';const _0x4156c9=await this[_0x32cb6(0x123)](_0x32cb6(0x1e6));_0x4db4ab=_0x4156c9?_0x4156c9[_0x32cb6(0xec)]:'';}}catch(_0x19d248){}const _0x4a25e5=await this[_0x32cb6(0xbe)](),_0x3a8d4f=(this[_0x32cb6(0x113)]['devices']||[])['some'](_0x3f2bff=>_0x3f2bff[_0x32cb6(0xab)]),_0x1027c1=_0x4a25e5&&_0x3a8d4f;let _0x552a0a='';try{const _0x688e62=await this[_0x32cb6(0x123)](_0x32cb6(0x165));if(_0x688e62&&_0x688e62[_0x32cb6(0xec)])_0x552a0a=_0x688e62[_0x32cb6(0xec)];}catch(_0x11c6d0){}this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4['command'],{'success':!![],'eventHistory':this[_0x32cb6(0x1bb)]['slice'](0x0,0x7d0),'stats':{'digestCount':_0x5ceabd,'isPresent':this[_0x32cb6(0x194)],'hourlyActivity':_0x1b7fc4,'hourlyDetails':_0x2ec7a5,'yesterdayActivity':_0x2506f4,'solarActive':_0x1027c1,'presenceWho':_0x552a0a,'roomStats':_0xf4efce,'activityTrend':_0x146963,'modules':this[_0x32cb6(0x18d)]},'automation':{'detected':_0x30966e,'description':_0x4efbf5,'targetId':_0x3303f3,'targetValue':_0x4db4ab}},_0x3778f4[_0x32cb6(0x1d9)]);}else{if(_0x3778f4[_0x32cb6(0x1d1)]===_0x32cb6(0x167))try{const _0x31f161=await automation[_0x32cb6(0xbd)](this);this['sendTo'](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'success':!![],'results':_0x31f161},_0x3778f4[_0x32cb6(0x1d9)]);}catch(_0x47c16c){this[_0x32cb6(0x103)](_0x3778f4['from'],_0x3778f4[_0x32cb6(0x1d1)],{'success':![],'error':_0x47c16c[_0x32cb6(0x1b7)]},_0x3778f4[_0x32cb6(0x1d9)]);}else{if(_0x3778f4['command']===_0x32cb6(0x1b6))try{const _0x4d4773=await scanner['scanForDevices'](this,_0x3778f4[_0x32cb6(0x1b7)]||{});this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4['command'],{'success':!![],'devices':_0x4d4773},_0x3778f4['callback']);}catch(_0x2d5f32){}else{if(_0x3778f4[_0x32cb6(0x1d1)]==='getEnums'){const _0x39f1df=await this[_0x32cb6(0x8a)](_0x32cb6(0x12f),_0x32cb6(0x16c)),_0x1e4b52=[];if(_0x39f1df)for(const _0x42f3b1 in _0x39f1df){let _0x173bb3=_0x39f1df[_0x42f3b1]['common']['name'];if(_0x173bb3&&typeof _0x173bb3===_0x32cb6(0x1bd))_0x173bb3=_0x173bb3['de']||_0x173bb3['en']||Object['values'](_0x173bb3)[0x0]||JSON[_0x32cb6(0xd4)](_0x173bb3);_0x1e4b52[_0x32cb6(0xda)]({'id':_0x42f3b1,'name':String(_0x173bb3||_0x42f3b1)});}const _0x12b939=await this[_0x32cb6(0x8a)](_0x32cb6(0x91),_0x32cb6(0x16c)),_0x577649=[];if(_0x12b939)for(const _0x10315f in _0x12b939){let _0x3faa04=_0x12b939[_0x10315f][_0x32cb6(0xb0)]['name'];if(_0x3faa04&&typeof _0x3faa04==='object')_0x3faa04=_0x3faa04['de']||_0x3faa04['en']||Object[_0x32cb6(0xf6)](_0x3faa04)[0x0]||JSON[_0x32cb6(0xd4)](_0x3faa04);_0x577649[_0x32cb6(0xda)](String(_0x3faa04||_0x10315f[_0x32cb6(0xc5)]('.')[_0x32cb6(0x1a7)]()));}this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4['command'],{'success':!![],'enums':_0x1e4b52,'rooms':_0x577649},_0x3778f4['callback']);}else{if(_0x3778f4[_0x32cb6(0x1d1)]===_0x32cb6(0x119))try{const _0x26c699=await this[_0x32cb6(0x1bc)](_0x32cb6(0xf2),'instance',{'startkey':'system.adapter.ical.','endkey':_0x32cb6(0x181)}),_0x5694f2=new Set();if(_0x26c699&&_0x26c699[_0x32cb6(0x1e1)])for(const _0x4abd78 of _0x26c699[_0x32cb6(0x1e1)]){const _0x4b9937=_0x4abd78['id'][_0x32cb6(0xc4)](_0x32cb6(0x95),''),_0x2f8ddb=await this[_0x32cb6(0xac)](_0x4b9937+_0x32cb6(0xa9));let _0x232d38=![];if(_0x2f8ddb&&_0x2f8ddb['val']){const _0x86b132=typeof _0x2f8ddb['val']===_0x32cb6(0xd0)?JSON[_0x32cb6(0x13e)](_0x2f8ddb[_0x32cb6(0xec)]):_0x2f8ddb['val'];Array['isArray'](_0x86b132)&&_0x86b132[_0x32cb6(0x8e)](_0x43ae2e=>{const _0x1dc706=_0x32cb6;_0x43ae2e[_0x1dc706(0x126)]&&(_0x5694f2[_0x1dc706(0x1df)](_0x43ae2e[_0x1dc706(0x126)]),_0x232d38=!![]);});}!_0x232d38&&_0x5694f2['add'](_0x4b9937);}const _0x45b3bf=Array[_0x32cb6(0xf9)](_0x5694f2);if(_0x45b3bf[_0x32cb6(0x16a)]===0x0)_0x45b3bf['push']('Standard');this['sendTo'](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'success':!![],'names':_0x45b3bf},_0x3778f4['callback']);}catch(_0x50fd09){this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'success':![],'error':'Scan\x20Error:\x20'+_0x50fd09[_0x32cb6(0x1b7)]},_0x3778f4[_0x32cb6(0x1d9)]);}else{if(_0x3778f4[_0x32cb6(0x1d1)]==='refreshCalendar')try{await automation[_0x32cb6(0xb5)](this),this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4['command'],{'success':!![]},_0x3778f4[_0x32cb6(0x1d9)]);}catch(_0x451dc8){this['log'][_0x32cb6(0xe1)](_0x32cb6(0xdc)+_0x451dc8['message']),this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4['command'],{'success':![],'error':_0x451dc8[_0x32cb6(0x1b7)]},_0x3778f4[_0x32cb6(0x1d9)]);}else{if(_0x3778f4[_0x32cb6(0x1d1)]===_0x32cb6(0x156))try{const _0xf018bc=_0x3778f4['message'][_0x32cb6(0x1d1)],_0xc2f74d=_0x3778f4[_0x32cb6(0x1b7)];this[_0x32cb6(0xa1)]['debug'](_0x32cb6(0x15d)+_0xf018bc),pythonBridge[_0x32cb6(0x9f)](this,_0xf018bc,_0xc2f74d,_0x9c751b=>{const _0x149e2e=_0x32cb6;this[_0x149e2e(0x103)](_0x3778f4[_0x149e2e(0xf9)],_0x3778f4['command'],_0x9c751b,_0x3778f4[_0x149e2e(0x1d9)]);});}catch(_0x599a48){this['log'][_0x32cb6(0xe1)]('pythonBridge\x20command\x20failed:\x20'+_0x599a48[_0x32cb6(0x1b7)]),this['sendTo'](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'type':'ERROR','payload':_0x599a48[_0x32cb6(0x1b7)]},_0x3778f4[_0x32cb6(0x1d9)]);}else{if(_0x3778f4[_0x32cb6(0x1d1)]===_0x32cb6(0xbc))try{const _0x5b5534=_0x3778f4['message']?_0x3778f4['message']['apiKey']:'';if(!_0x5b5534)throw new Error('Kein\x20API\x20Key\x20√ºbergeben.');const _0x588c7c=new GoogleGenerativeAI(_0x5b5534),_0x2dfff3=_0x588c7c['getGenerativeModel']({'model':GEMINI_MODEL}),_0x4d6254=await _0x2dfff3[_0x32cb6(0x166)](_0x32cb6(0x198)),_0x501b73=await _0x4d6254[_0x32cb6(0xce)],_0x557bfa=_0x501b73[_0x32cb6(0x9c)]();this['sendTo'](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4['command'],{'success':!![],'message':_0x32cb6(0x1e8)+_0x557bfa[_0x32cb6(0x142)](0x0,0x14)+_0x32cb6(0xc6)},_0x3778f4['callback']);}catch(_0x18b757){this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'success':![],'message':_0x18b757[_0x32cb6(0x1b7)]},_0x3778f4[_0x32cb6(0x1d9)]);}else{if(_0x3778f4[_0x32cb6(0x1d1)]===_0x32cb6(0x133))try{const _0x49100c=await this['checkSolarCondition'](),_0x1b8524=await this[_0x32cb6(0x1bc)](_0x32cb6(0xf2),_0x32cb6(0x18a),{'startkey':_0x32cb6(0x141),'endkey':_0x32cb6(0x181)}),_0x527854=_0x1b8524&&_0x1b8524[_0x32cb6(0x1e1)]?_0x1b8524[_0x32cb6(0x1e1)][_0x32cb6(0x16a)]:0x0;this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4[_0x32cb6(0x1d1)],{'success':!![],'weather':'Sonne:\x20'+_0x49100c+',\x20Temp:\x20'+(this[_0x32cb6(0x187)][this[_0x32cb6(0x113)][_0x32cb6(0x115)]]||'?')+'¬∞C','calendar':_0x527854+_0x32cb6(0x135)},_0x3778f4[_0x32cb6(0x1d9)]);}catch(_0x4c5edf){this[_0x32cb6(0x103)](_0x3778f4[_0x32cb6(0xf9)],_0x3778f4['command'],{'success':![]},_0x3778f4[_0x32cb6(0x1d9)]);}}}}}}}}}}}}[a0_0x221687(0x11f)](){const _0x5451ca=a0_0x221687;if(!this[_0x5451ca(0x18d)]['health'])return;this[_0x5451ca(0xa1)][_0x5451ca(0x1cb)](_0x5451ca(0x1a5));try{const _0x61623d=this[_0x5451ca(0x11b)]||[];pythonBridge[_0x5451ca(0x9f)](this,_0x5451ca(0x114),{'events':_0x61623d});}catch(_0x3c3e47){this['log'][_0x5451ca(0xe1)]('Failed\x20to\x20trigger\x20Python\x20Health\x20Check');}}async[a0_0x221687(0xdb)](_0x3316fb,_0x4bede1){const _0x4c2ea2=a0_0x221687;if(!_0x4bede1||this[_0x4c2ea2(0xe8)])return;if(_0x3316fb[_0x4c2ea2(0x16f)](_0x4c2ea2(0x13b))&&_0x3316fb['endsWith']('communicate.request')&&_0x4bede1[_0x4c2ea2(0xec)])return;if(this['config'][_0x4c2ea2(0x148)]&&_0x3316fb===this['config'][_0x4c2ea2(0x1ec)]&&this[_0x4c2ea2(0x18d)]['security']){this['handleInfrasound'](_0x4bede1[_0x4c2ea2(0xec)]);return;}if(_0x4bede1[_0x4c2ea2(0x1ce)]&&_0x3316fb[_0x4c2ea2(0x18f)](_0x4c2ea2(0x15c)))return;if(_0x3316fb===this[_0x4c2ea2(0x164)]+_0x4c2ea2(0x16e)){if(_0x4bede1[_0x4c2ea2(0xec)]&&Object[_0x4c2ea2(0xf6)](setup['SYSTEM_MODES'])[_0x4c2ea2(0x16f)](_0x4bede1[_0x4c2ea2(0xec)])){this['currentSystemMode']=_0x4bede1['val'];if(_0x4bede1['val']===setup[_0x4c2ea2(0x1cc)]['VACATION'])await recorder[_0x4c2ea2(0x105)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x4c2ea2(0x15e)]){let _0x71fc8d=![],_0x3174ea=0x0,_0x5e8507=_0x4c2ea2(0x13f);if(this['currentSystemMode']===_0x4c2ea2(0x111))_0x71fc8d=!![],_0x3174ea=0x168,_0x5e8507=_0x4c2ea2(0x18b);else this[_0x4c2ea2(0xf5)]===_0x4c2ea2(0x12b)&&(_0x71fc8d=!![],_0x3174ea=0x5a0,_0x5e8507=_0x4c2ea2(0x1d5));pythonBridge[_0x4c2ea2(0x9f)](this,_0x4c2ea2(0xb9),{'active':_0x71fc8d,'duration':_0x3174ea,'label':_0x5e8507}),await this[_0x4c2ea2(0xc1)](_0x4c2ea2(0x172),{'val':JSON[_0x4c2ea2(0xd4)]({'active':_0x71fc8d,'label':_0x5e8507,'timestamp':Date[_0x4c2ea2(0x186)]()}),'ack':!![]});}}if(!_0x4bede1[_0x4c2ea2(0x1ce)])this[_0x4c2ea2(0xb8)](_0x3316fb,{'val':this['currentSystemMode'],'ack':!![]});return;}if(_0x3316fb[_0x4c2ea2(0x18f)](_0x4c2ea2(0xfc))&&_0x4bede1[_0x4c2ea2(0x1ce)])this[_0x4c2ea2(0x170)](_0x4bede1['val']);if(_0x3316fb['endsWith'](_0x4c2ea2(0xa5))&&_0x4bede1[_0x4c2ea2(0x1ce)]&&this['activeModules'][_0x4c2ea2(0x189)])automation[_0x4c2ea2(0x1d4)](this);if(!_0x4bede1[_0x4c2ea2(0x1ce)]){if(_0x3316fb[_0x4c2ea2(0x16f)]('analysis.trigger')&&_0x4bede1[_0x4c2ea2(0xec)]){this[_0x4c2ea2(0xb8)](_0x3316fb,{'val':![],'ack':!![]}),aiAgent[_0x4c2ea2(0x197)](this);return;}if(_0x3316fb[_0x4c2ea2(0x16f)]('triggerDailyDigest')&&_0x4bede1[_0x4c2ea2(0xec)]){this[_0x4c2ea2(0xb8)](_0x3316fb,{'val':![],'ack':!![]});if(this[_0x4c2ea2(0x15e)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x3316fb[_0x4c2ea2(0x16f)]('triggerBriefing')&&_0x4bede1['val']){this['setState'](_0x3316fb,{'val':![],'ack':!![]}),aiAgent['sendMorningBriefing'](this);return;}if(_0x3316fb['includes'](_0x4c2ea2(0xe5))&&_0x4bede1['val']){this['setState'](_0x3316fb,{'val':![],'ack':!![]}),aiAgent[_0x4c2ea2(0xcc)](this);return;}if(_0x3316fb[_0x4c2ea2(0x16f)]('analysis.training.triggerSecurity')&&_0x4bede1[_0x4c2ea2(0xec)]){this[_0x4c2ea2(0xb8)](_0x3316fb,{'val':![],'ack':!![]});if(this[_0x4c2ea2(0x15e)])try{const _0x24e8c6=await this[_0x4c2ea2(0x123)](_0x4c2ea2(0x19a));if(_0x24e8c6&&_0x24e8c6[_0x4c2ea2(0xec)]){const _0x116e1e=JSON[_0x4c2ea2(0x13e)](_0x24e8c6['val']);this[_0x4c2ea2(0xc1)](_0x4c2ea2(0x1ab),{'val':_0x4c2ea2(0xfb),'ack':!![]}),pythonBridge[_0x4c2ea2(0x9f)](this,_0x4c2ea2(0x17a),{'sequences':_0x116e1e});}}catch(_0x1c7047){}return;}if(_0x3316fb[_0x4c2ea2(0x16f)]('analysis.training.triggerHealth')&&_0x4bede1[_0x4c2ea2(0xec)]){this['setState'](_0x3316fb,{'val':![],'ack':!![]});try{aiAgent[_0x4c2ea2(0xae)](this,_0x4c2ea2(0x9d)),setTimeout(()=>aiAgent[_0x4c2ea2(0xae)](this,_0x4c2ea2(0xe6)),0x2ee0);if(this[_0x4c2ea2(0x15e)]){this[_0x4c2ea2(0x11f)]();const _0x5a9ec1=await this[_0x4c2ea2(0x123)](_0x4c2ea2(0x157));if(_0x5a9ec1&&_0x5a9ec1[_0x4c2ea2(0xec)])pythonBridge[_0x4c2ea2(0x9f)](this,_0x4c2ea2(0x98),{'digests':JSON[_0x4c2ea2(0x13e)](_0x5a9ec1['val'])});}}catch(_0x182254){this[_0x4c2ea2(0xa1)][_0x4c2ea2(0xe1)](_0x4c2ea2(0xe2)+_0x182254[_0x4c2ea2(0x1b7)]);}return;}if(_0x3316fb[_0x4c2ea2(0x16f)]('analysis.training.triggerEnergy')&&_0x4bede1[_0x4c2ea2(0xec)]){this[_0x4c2ea2(0xb8)](_0x3316fb,{'val':![],'ack':!![]}),await this['triggerEnergyPrediction']();return;}if(_0x3316fb['includes']('analysis.training.triggerComfort')&&_0x4bede1['val']){this['setState'](_0x3316fb,{'val':![],'ack':!![]});if(this[_0x4c2ea2(0x15e)])try{const _0x1b7795=await this[_0x4c2ea2(0x123)]('LTM.rawEventLog');if(_0x1b7795&&_0x1b7795['val']){const _0x455fef={};if(this['config'][_0x4c2ea2(0x99)])this['config'][_0x4c2ea2(0x99)][_0x4c2ea2(0x8e)](_0x5e0729=>{const _0x180a31=_0x4c2ea2;if(_0x5e0729['id']&&_0x5e0729[_0x180a31(0x104)])_0x455fef[_0x5e0729['id']]=_0x5e0729[_0x180a31(0x104)];});pythonBridge[_0x4c2ea2(0x9f)](this,_0x4c2ea2(0xff),{'events':JSON['parse'](_0x1b7795[_0x4c2ea2(0xec)]),'deviceMap':_0x455fef});}}catch(_0x53cf5d){}return;}if(_0x3316fb[_0x4c2ea2(0x16f)]('analysis.training.triggerTopology')&&_0x4bede1[_0x4c2ea2(0xec)]){this[_0x4c2ea2(0xb8)](_0x3316fb,{'val':![],'ack':!![]}),topology[_0x4c2ea2(0x1dc)](this);if(this[_0x4c2ea2(0x15e)])try{const _0x24c5f1=await this['getStateAsync'](_0x4c2ea2(0x19a));if(_0x24c5f1&&_0x24c5f1['val'])pythonBridge[_0x4c2ea2(0x9f)](this,'TRAIN_TOPOLOGY',{'sequences':JSON['parse'](_0x24c5f1[_0x4c2ea2(0xec)])});}catch(_0x5cd140){}return;}}const _0x2bada9=(this[_0x4c2ea2(0x113)]['devices']||[])[_0x4c2ea2(0x14e)](_0x96a1fb=>_0x96a1fb['id']===_0x3316fb);if(_0x2bada9){const _0x3e69c1=await recorder[_0x4c2ea2(0x96)](this,_0x3316fb,_0x4bede1,_0x2bada9);_0x3e69c1&&this[_0x4c2ea2(0xb8)](_0x4c2ea2(0x84),{'val':Date[_0x4c2ea2(0x186)](),'ack':!![]});_0x3e69c1&&_0x3e69c1[_0x4c2ea2(0x104)]===_0x4c2ea2(0x175)&&_0x3e69c1[_0x4c2ea2(0x16d)]&&this[_0x4c2ea2(0x15e)]&&deadMan['updateLocation'](this,_0x3e69c1[_0x4c2ea2(0x16d)]);_0x4bede1[_0x4c2ea2(0xec)]&&(_0x4bede1['val']===!![]||_0x4bede1[_0x4c2ea2(0xec)]===0x1||String(_0x4bede1[_0x4c2ea2(0xec)])[_0x4c2ea2(0x11a)]()===_0x4c2ea2(0x18c))&&(_0x2bada9['type']&&(_0x2bada9[_0x4c2ea2(0x104)][_0x4c2ea2(0x16f)](_0x4c2ea2(0xf7))||_0x2bada9[_0x4c2ea2(0x104)][_0x4c2ea2(0x16f)](_0x4c2ea2(0xd3)))&&this[_0x4c2ea2(0xdd)](_0x2bada9));if(_0x2bada9[_0x4c2ea2(0x104)]==='temperature'||_0x2bada9[_0x4c2ea2(0x104)]===_0x4c2ea2(0x1eb)){if(this[_0x4c2ea2(0x18d)]['energy'])automation[_0x4c2ea2(0xb2)](this);}}}async[a0_0x221687(0x170)](_0x56d9e7){const _0x503b45=a0_0x221687;if(!this[_0x503b45(0x1c5)]||Date['now']()-this[_0x503b45(0x190)]>0x493e0)return;try{const _0xa7e857=JSON[_0x503b45(0x13e)](_0x56d9e7),_0x27c65b=this[_0x503b45(0x1c5)][_0x503b45(0xdf)];let _0x5971e6=![];for(const _0x51916f in _0x27c65b){if(_0x27c65b[_0x51916f][_0x503b45(0x16f)]('AI')&&_0xa7e857[_0x51916f]&&!_0xa7e857[_0x51916f][_0x503b45(0x16f)]('AI')){_0x5971e6=!![];break;}}_0x5971e6&&(await this[_0x503b45(0xc1)](_0x503b45(0xa5),{'val':JSON[_0x503b45(0xd4)](this[_0x503b45(0x1c5)][_0x503b45(0x1c6)]),'ack':!![]}),await this[_0x503b45(0xc1)]('analysis.energy.warmupSources',{'val':JSON[_0x503b45(0xd4)](this[_0x503b45(0x1c5)][_0x503b45(0xdf)]),'ack':!![]}));}catch(_0x182fbe){}}async[a0_0x221687(0x106)](){const _0x10d45b=a0_0x221687;try{const _0x5ed6d7=await this[_0x10d45b(0x123)](setup[_0x10d45b(0x180)]);if(_0x5ed6d7&&_0x5ed6d7['val'])this[_0x10d45b(0xf5)]=_0x5ed6d7[_0x10d45b(0xec)];}catch(_0x9a7c75){this['currentSystemMode']=setup[_0x10d45b(0x1cc)][_0x10d45b(0x1db)];}}async[a0_0x221687(0xe0)](){const _0x366ff2=a0_0x221687,_0xc715eb=this[_0x366ff2(0x113)][_0x366ff2(0x11d)]||[];if(_0xc715eb[_0x366ff2(0x16a)]===0x0)return![];const _0x352fc6=[],_0x114fb0=Date['now'](),_0x618018=0x5*0x3c*0x3e8;for(const _0xb08b24 of _0xc715eb){try{let _0x2385f=![];try{const _0x4b6c5f=await this[_0x366ff2(0xac)](_0xb08b24+_0x366ff2(0xea));if(_0x4b6c5f&&_0x4b6c5f[_0x366ff2(0xec)]===!![])_0x2385f=!![];}catch(_0x272503){}if(!_0x2385f)try{const _0x258d34=await this[_0x366ff2(0xac)](_0xb08b24+_0x366ff2(0xf4));if(_0x258d34&&_0x258d34['ts']){const _0x4c3c8a=_0x114fb0-_0x258d34['ts'];if(_0x4c3c8a<_0x618018)_0x2385f=!![];}}catch(_0x4f788d){}if(!_0x2385f)try{const _0x264d10=await this[_0x366ff2(0xac)](_0xb08b24+_0x366ff2(0x109));if(_0x264d10&&typeof _0x264d10[_0x366ff2(0xec)]==='number'&&_0x264d10['val']>0x0)_0x2385f=!![];}catch(_0x6fb187){}if(!_0x2385f)try{const _0x21629f=await this[_0x366ff2(0xac)](_0xb08b24);if(_0x21629f){const _0x153457=_0x114fb0-(_0x21629f['ts']||0x0);_0x153457<_0x618018&&(_0x21629f[_0x366ff2(0xec)]===!![]||_0x21629f['val']===_0x366ff2(0x1b8)||_0x21629f[_0x366ff2(0xec)]===0x1)&&(_0x2385f=!![]);}}catch(_0x168a9f){}if(_0x2385f){const _0x5cd60c=_0xb08b24[_0x366ff2(0xc5)]('.'),_0x32edb8=_0x5cd60c[_0x5cd60c[_0x366ff2(0x16a)]-0x1]||_0xb08b24;_0x352fc6['push'](_0x32edb8);}}catch(_0x347b3e){this[_0x366ff2(0xa1)][_0x366ff2(0xe1)](_0x366ff2(0x11e)+_0xb08b24+':\x20'+_0x347b3e[_0x366ff2(0x1b7)]);}}const _0x46f457=_0x352fc6[_0x366ff2(0x16a)]>0x0?_0x352fc6[_0x366ff2(0xb4)](',\x20'):_0x366ff2(0xfa);return await this[_0x366ff2(0xc1)]('system.presenceWho',{'val':_0x46f457,'ack':!![]}),_0x352fc6[_0x366ff2(0x16a)]>0x0;}async['runAutopilot'](){const _0x5067d1=a0_0x221687;await aiAgent['runGeminiAnalysis'](this);this['activeModules'][_0x5067d1(0xee)]&&(this[_0x5067d1(0x161)](),this[_0x5067d1(0xcd)]());if(this[_0x5067d1(0x18d)][_0x5067d1(0x189)])this[_0x5067d1(0x1a2)]();}async['checkSolarCondition'](){const _0x42df58=a0_0x221687,_0x51dbfd=[_0x42df58(0xd9),_0x42df58(0x17e),_0x42df58(0x163)],_0x20ec98=['forecast.current.weather','Current.WeatherText',_0x42df58(0x1b2)];for(const _0x40cbe5 of _0x51dbfd){for(const _0x32f51f of _0x20ec98){try{const _0x43b839=_0x40cbe5+'.'+_0x32f51f,_0x29d5c3=await this['getForeignStateAsync'](_0x43b839);if(_0x29d5c3&&_0x29d5c3[_0x42df58(0xec)]){const _0x1f3f97=String(_0x29d5c3[_0x42df58(0xec)])[_0x42df58(0x11a)]();if(_0x1f3f97['includes'](_0x42df58(0x179))||_0x1f3f97[_0x42df58(0x16f)]('heiter')||_0x1f3f97['includes']('klar')||_0x1f3f97[_0x42df58(0x16f)](_0x42df58(0x8c))||_0x1f3f97['includes'](_0x42df58(0xba)))return this[_0x42df58(0xa1)][_0x42df58(0x1cb)](_0x42df58(0x1ae)+_0x43b839),!![];}}catch(_0x3bddb4){}}}return![];}[a0_0x221687(0xcd)](){const _0x3210fd=a0_0x221687;if(!this[_0x3210fd(0x15e)])return;try{this[_0x3210fd(0x123)](_0x3210fd(0x19a),(_0x1bfccf,_0x1744cd)=>{const _0x20f286=_0x3210fd;if(_0x1bfccf||!_0x1744cd||!_0x1744cd[_0x20f286(0xec)])return;try{const _0xf83e99=JSON[_0x20f286(0x13e)](_0x1744cd[_0x20f286(0xec)]);if(!_0xf83e99||_0xf83e99[_0x20f286(0x16a)]===0x0)return;pythonBridge[_0x20f286(0x9f)](this,_0x20f286(0x102),{'sequences':_0xf83e99}),this['log'][_0x20f286(0x1cb)](_0x20f286(0x108)+_0xf83e99[_0x20f286(0x16a)]+_0x20f286(0x127));}catch(_0x26ee92){this[_0x20f286(0xa1)]['warn'](_0x20f286(0x176)+_0x26ee92[_0x20f286(0x1b7)]);}});}catch(_0x25e021){this[_0x3210fd(0xa1)][_0x3210fd(0xe1)]('triggerGaitAnalysis\x20error:\x20'+_0x25e021[_0x3210fd(0x1b7)]);}}async['triggerEnergyPrediction'](){const _0x237b6b=a0_0x221687;if(!this['isProVersion']||!this[_0x237b6b(0x18d)][_0x237b6b(0x189)])return;try{const _0x473e2e={},_0x2df112={},_0x451b67=this['config'][_0x237b6b(0x99)]||[];for(const _0xa1a2b5 of _0x451b67){if((_0xa1a2b5[_0x237b6b(0x104)]==='temperature'||_0xa1a2b5[_0x237b6b(0x104)]===_0x237b6b(0x1eb))&&_0xa1a2b5[_0x237b6b(0x16d)])try{const _0x3f2756=await this[_0x237b6b(0xac)](_0xa1a2b5['id']);_0x3f2756&&typeof _0x3f2756[_0x237b6b(0xec)]===_0x237b6b(0x86)&&(_0x473e2e[_0xa1a2b5[_0x237b6b(0x16d)]]=_0x3f2756[_0x237b6b(0xec)],_0x2df112[_0xa1a2b5[_0x237b6b(0x16d)]]=_0xa1a2b5['isSolar']||![]);}catch(_0x444eaf){}}let _0x2c7405=0xa;if(this[_0x237b6b(0x113)]['weatherTempId'])try{const _0x50b092=await this[_0x237b6b(0xac)](this[_0x237b6b(0x113)][_0x237b6b(0x1c1)]);if(_0x50b092&&typeof _0x50b092[_0x237b6b(0xec)]==='number')_0x2c7405=_0x50b092[_0x237b6b(0xec)];}catch(_0x14fe88){}const _0x256e8a=await this['checkSolarCondition']();let _0x11dac1={};try{const _0x2fa5d6=await this[_0x237b6b(0x123)](_0x237b6b(0x149));if(_0x2fa5d6&&_0x2fa5d6[_0x237b6b(0xec)])_0x11dac1=JSON[_0x237b6b(0x13e)](_0x2fa5d6['val']);}catch(_0x2d6259){}pythonBridge[_0x237b6b(0x9f)](this,_0x237b6b(0x1b4),{'current_temps':_0x473e2e,'t_out':_0x2c7405,'is_sunny':_0x256e8a,'solar_flags':_0x2df112,'warmup_targets':_0x11dac1}),this['log'][_0x237b6b(0x8b)](_0x237b6b(0x1b1)+Object[_0x237b6b(0x1d2)](_0x473e2e)[_0x237b6b(0x16a)]+_0x237b6b(0x14b));}catch(_0x58a687){this[_0x237b6b(0xa1)][_0x237b6b(0xe1)](_0x237b6b(0x154)+_0x58a687[_0x237b6b(0x1b7)]);}}[a0_0x221687(0x161)](){const _0x3de3df=a0_0x221687;if(!this[_0x3de3df(0x11b)]||this[_0x3de3df(0x11b)]['length']===0x0)return;const _0xb811de=new Array(0x30)[_0x3de3df(0x1c0)](0x0),_0x74c6ef=Array[_0x3de3df(0xf9)]({'length':0x30},()=>[]),_0x4705d6=new Date()[_0x3de3df(0x199)](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x3de3df(0x8e)](_0xa30dec=>{const _0x87b64b=_0x3de3df,_0x2dbf5c=new Date(_0xa30dec[_0x87b64b(0x85)]);if(_0x2dbf5c[_0x87b64b(0x193)]()>=_0x4705d6){const _0x13ad7d=_0x2dbf5c['getHours'](),_0x17bbc1=_0x2dbf5c[_0x87b64b(0x1cf)](),_0xb70272=_0x13ad7d*0x2+Math[_0x87b64b(0x1ea)](_0x17bbc1/0x1e);_0xb70272>=0x0&&_0xb70272<0x30&&(_0xb811de[_0xb70272]++,_0x74c6ef[_0xb70272][_0x87b64b(0xda)]({'time':_0x2dbf5c[_0x87b64b(0xf1)](_0x87b64b(0xcf),{'hour':_0x87b64b(0x195),'minute':_0x87b64b(0x195)}),'location':_0xa30dec[_0x87b64b(0x16d)]||_0x87b64b(0x1b5),'type':_0xa30dec[_0x87b64b(0x104)]||_0x87b64b(0xe7)}));}}),this['setStateAsync'](_0x3de3df(0x14c),{'val':JSON[_0x3de3df(0xd4)](_0xb811de),'ack':!![]}),this['setStateAsync'](_0x3de3df(0x173),{'val':JSON[_0x3de3df(0xd4)](_0x74c6ef),'ack':!![]});}async[a0_0x221687(0x146)](_0x26dded){const _0xcdbcd6=a0_0x221687;if(!this[_0xcdbcd6(0x113)][_0xcdbcd6(0x148)]||typeof _0x26dded!==_0xcdbcd6(0x86))return;const _0x7213e0=this[_0xcdbcd6(0x113)][_0xcdbcd6(0x1a4)]||0.04;this['pressureBuffer'][_0xcdbcd6(0xda)]({'timestamp':Date[_0xcdbcd6(0x186)](),'value':_0x26dded}),this[_0xcdbcd6(0xb6)]['length']>0x64&&this[_0xcdbcd6(0xb6)]['shift'](),_0x26dded>_0x7213e0&&!this[_0xcdbcd6(0x1da)]&&(this[_0xcdbcd6(0x1da)]=!![],this['log']['warn'](_0xcdbcd6(0x94)+_0x26dded[_0xcdbcd6(0x17d)](0x4)+'\x20>\x20'+_0x7213e0+'\x20(Threshold)'),await this[_0xcdbcd6(0xc3)](_0x26dded,'threshold_exceeded'),setTimeout(()=>{const _0x115a63=_0xcdbcd6;this[_0x115a63(0x1da)]=![];},0x5*0x3c*0x3e8));}async[a0_0x221687(0xc3)](_0x104d3d,_0x205762){const _0x4f91b3=a0_0x221687;if(!this[_0x4f91b3(0x194)]){const _0x2765f2=this[_0x4f91b3(0x1bb)][_0x4f91b3(0x1c8)](0x0,0xa),_0xfaf30f=_0x2765f2[_0x4f91b3(0x17c)](_0xd7ebbe=>new Date(_0xd7ebbe[_0x4f91b3(0x85)])[_0x4f91b3(0xf1)](_0x4f91b3(0xcf))+_0x4f91b3(0xa2)+(_0xd7ebbe[_0x4f91b3(0x16d)]||_0x4f91b3(0xa8))+':\x20'+_0xd7ebbe[_0x4f91b3(0x147)])[_0x4f91b3(0xb4)]('\x0a');this[_0x4f91b3(0xa1)]['warn'](_0x4f91b3(0x101)+_0x104d3d[_0x4f91b3(0x17d)](0x4)+_0x4f91b3(0x1e3)+_0xfaf30f);if(this[_0x4f91b3(0x113)][_0x4f91b3(0xaf)])try{const _0x15d950=await this[_0x4f91b3(0xac)](this['config'][_0x4f91b3(0xaf)]);_0x15d950&&_0x15d950[_0x4f91b3(0xec)]===!![]&&(await this['setStateAsync'](_0x4f91b3(0x92),{'val':JSON[_0x4f91b3(0xd4)]({'timestamp':Date[_0x4f91b3(0x186)](),'pressure':_0x104d3d[_0x4f91b3(0x17d)](0x4),'eventType':_0x205762,'recentEvents':_0x2765f2[_0x4f91b3(0x1c8)](0x0,0x3)}),'ack':!![]}),this[_0x4f91b3(0xa1)][_0x4f91b3(0x14f)](_0x4f91b3(0x1af)));}catch(_0x3d2e39){}}else this['log'][_0x4f91b3(0x1cb)](_0x4f91b3(0x182)+_0x104d3d[_0x4f91b3(0x17d)](0x4)+'\x20(Bewohner\x20anwesend\x20-\x20normal)');}async[a0_0x221687(0xdd)](_0x923452){const _0x3f1ed5=a0_0x221687;if(!_0x923452||!_0x923452[_0x3f1ed5(0x16d)])return;try{const _0xff6d8b=(this[_0x3f1ed5(0x113)][_0x3f1ed5(0x99)]||[])['filter'](_0x3a6c0c=>_0x3a6c0c[_0x3f1ed5(0x16d)]===_0x923452['location']&&(_0x3a6c0c[_0x3f1ed5(0x104)]===_0x3f1ed5(0x13d)||_0x3a6c0c[_0x3f1ed5(0x104)]===_0x3f1ed5(0x1eb)));if(_0xff6d8b[_0x3f1ed5(0x16a)]===0x0)return;const _0xd2320=await this['getForeignStateAsync'](_0xff6d8b[0x0]['id']);if(!_0xd2320||typeof _0xd2320[_0x3f1ed5(0xec)]!==_0x3f1ed5(0x86))return;const _0x49f084=_0xd2320[_0x3f1ed5(0xec)];let _0x228c8b=null;if(this[_0x3f1ed5(0x113)]['weatherTempId']){const _0x4f072c=await this['getForeignStateAsync'](this[_0x3f1ed5(0x113)]['weatherTempId']);_0x4f072c&&typeof _0x4f072c['val']===_0x3f1ed5(0x86)&&(_0x228c8b=_0x4f072c['val']);}if(_0x228c8b!==null){const _0x324a9a=Math[_0x3f1ed5(0x18e)](_0x49f084-_0x228c8b);_0x324a9a>0x3&&(this[_0x3f1ed5(0xa1)][_0x3f1ed5(0x1cb)](_0x3f1ed5(0x139)+_0x923452[_0x3f1ed5(0x16d)]+_0x3f1ed5(0x124)+_0x324a9a[_0x3f1ed5(0x17d)](0x1)+_0x3f1ed5(0x10d)+_0x49f084+'¬∞C,\x20Au√üen:\x20'+_0x228c8b+_0x3f1ed5(0xeb)),await this[_0x3f1ed5(0xc1)]('analysis.ventilation.lastWindow',{'val':JSON[_0x3f1ed5(0xd4)]({'room':_0x923452['location'],'timestamp':Date[_0x3f1ed5(0x186)](),'tempDiff':_0x324a9a[_0x3f1ed5(0x17d)](0x1),'recommendation':_0x324a9a>0x5?'Gute\x20L√ºftungsm√∂glichkeit!':'L√ºften\x20empfohlen'}),'ack':!![]}));}}catch(_0xa55443){this[_0x3f1ed5(0xa1)]['warn']('analyzeWindowOpening\x20error:\x20'+_0xa55443[_0x3f1ed5(0x1b7)]);}}async['appendToLog'](_0x69e01a){const _0x567b01=a0_0x221687;if(!_0x69e01a||typeof _0x69e01a!=='object')return;const _0x2ac9bd={'timestamp':_0x69e01a['timestamp']||Date[_0x567b01(0x186)](),'id':_0x69e01a['id']||Date[_0x567b01(0x186)]()['toString'](),'name':_0x69e01a[_0x567b01(0x147)]||_0x567b01(0xe3),'type':_0x69e01a['type']||'custom','location':_0x69e01a[_0x567b01(0x16d)]||_0x567b01(0xa8),'value':_0x69e01a['value']||null};this[_0x567b01(0x1bb)][_0x567b01(0xe9)](_0x2ac9bd);if(this['eventHistory'][_0x567b01(0x16a)]>0x1388)this[_0x567b01(0x1bb)]['pop']();await this[_0x567b01(0xc1)]('events.history',{'val':JSON['stringify'](this[_0x567b01(0x1bb)]),'ack':!![]}),this[_0x567b01(0xa1)][_0x567b01(0x1cb)](_0x567b01(0x88)+_0x2ac9bd[_0x567b01(0x147)]+'\x20('+_0x2ac9bd[_0x567b01(0x16d)]+')');}[a0_0x221687(0xb3)](_0xd0e361){}}if(require[a0_0x221687(0x1ba)]!==module)module['exports']=_0x3d8591=>new CogniLiving(_0x3d8591);else new CogniLiving();