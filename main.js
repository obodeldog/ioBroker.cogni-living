const a0_0x356552=a0_0x1e8a;function a0_0xa1da(){const _0x28fb9a=['analysis.security.lastScore','system.presenceWho','toString','checkWifiPresence','337281JjXNsw','outdoorSensorId','analysis.health.todayVector','Warm-Up\x20Time','setHours','warn','Say\x20Hello','exitGraceTimer','checkWifiPresence:\x20Error\x20checking\x20','Unknown','path','location','Kein\x20API\x20Key\x20√ºbergeben.','Sec-Training\x20started...','moduleSecurity','healthTrendInterval','response','exitTimer','times','json','analysis.training.triggerHealth','startService','parse','95218CZikLG','32mFSilx','Gemini\x20Init\x20Error:\x20','setStateAsync','analysis.health.geminiDay','getGenerativeModel','presenceCheckTimer','SET_LEARNING_MODE','2-digit','checkLicense','üîÆ\x20Energy\x20Prediction\x20triggered\x20(',',\x20Temp:\x20','./lib/recorder','processSensorEvent','.json','analysis.health.geminiNight','callback','enum','appendToLog','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','analysisHistory','Daily\x20Activity\x20Vector\x20(48x30min)','getHistoryData','createAllObjects','calendarName','initHistory','weatherunderground.0','getTime','isPresent','General\x20Activity\x20Trend','checkCalendarTriggers','history','isProVersion','355956czgZim','triggerGaitAnalysis\x20parse\x20error:\x20','pulse','lastTrackerEventTime','replayTodayEvents','L√ºften\x20empfohlen','generateHealthReport','inactivityThresholdHours','all','pythonBridge','geminiApiKey','system.adapter.ical.','string','todayVector','setState','getEnums','15lvqOUQ','dependencyInstallInProgress','val','de-DE','.uptime','text','eventHistory','\x20events\x20from\x20standard\x20storage.','systemConfig','updateHealthVector','door','cleanupGhostInterventions','\x20>\x20','initSchedules','isRelevantActivity','checkSolarCondition','SYSTEM_MODES','Standard','testApiKey','.data.table','constructor','[Integrator]\x20Error:\x20','analysis.safety.infrasoundAlert','readFileSync','object','analysis.topology.structure','¬∞C\x20(Innen:\x20','moduleComfort','value','mkdirSync','infrasoundThreshold','bind','timestamp','integrateRoomTime','Manual\x20Event','models/gemini-flash-latest','analysis.energy.warmupTargets','toLowerCase','updateTopologyMatrix\x20failed:\x20','infrasoundSensorId','Warte\x20auf\x20Analyse...','stopService','Event','4778592JZWEhk','Lernphase\x20(','system','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','subscribeForeignStates','‚úÖ\x20History\x20saved:\x20','.isOnline','TRAIN_TOPOLOGY','online','pressureBuffer','activeModules','Current.WeatherText','weatherTempId','isGracePeriodActive','Scan\x20Error:\x20','utf8','push','analysis.activity.roomStats','getForeignStateAsync','runGeminiAnalysis','getAbsoluteDefaultDataDir','NIGHT','shift','./lib/scanner','1389924RyATSm','runAutopilot','analysisTimer','max','triggerDailyDigest','debug','enum.functions.*','klar','enum.rooms.*','bin','toLocaleDateString','licenseKey','sources','Adapter','calendarCheckTimer','analysis.automation.targetValue','History\x20Save\x20Error:\x20','getStateAsync','sensorLastValues','1sXzerr','pop','handleInfrasound','\x22history\x22:{}','getHours','ERROR','[PythonBridge]\x20Forwarding\x20command:\x20','toLocaleTimeString','analysis.energy.warmupTimes','triggerHealth\x20error:\x20','abs','currentSystemMode','./lib/automation','historyJob','modeResetJob','analysis.security.learningStatus','\x20events\x20from\x20today...','terrasse','genAI','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','search','security','memoryCache','analysis.ventilation.lastWindow','subscribeForeignStatesAsync','analysis.prediction.trackerConfidence','startSystem','setPresence','ack','substring','‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','checkThermostats','¬∞C,\x20Au√üen:\x20','endsWith','refreshCalendar','toISOString','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','number','motion','onStateChange','find','onReady','health','manual','triggerEnergyPrediction','Keine\x20Daten','filter','\x20rooms)','unshift','communicate.request','thermostat','\x20Tage)','command','getCalendarNames','onMessage','...','setObjectNotExistsAsync','threshold_exceeded','trackerHeartbeat','stringify','analysis.activity.roomHistory','SYSTEM_DP_MODE','stateChange','analysis.trigger','moduleEnergy','initSystemConfig','32GTfCej','system.adapter.ical.È¶ô','add','sendTo','Aktiv\x20(','accuweather.0','üìù\x20Manual\x20event\x20logged:\x20','DAY','LTM.trainingData.sequences','sendNotification','onUnload','useCalendar','node-schedule','üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','updated','Verbindung\x20erfolgreich:\x20','analysis.health.activityTrend','Gute\x20L√ºftungsm√∂glichkeit!','Unbekannt','saveDailyHistory','59\x2023\x20*\x20*\x20*','slice','./lib/dead_man','No\x20topology\x20data\x20found','updateLocation','{\x22history\x22:{}}',',\x20Events:\x0a','values','cogni-living','toFixed','sunny','‚Ü∫\x20Replaying\x20','\x20sequences','analysis.training.triggerComfort','open','writeFileSync','analysis.energy.warmupSources','initZombies','üíæ\x20Saving\x20Daily\x20History\x20for\x20','üí®\x20L√ºftung\x20in\x20','presenceDevices','Daily\x20Room\x20Details\x20(48x30min)','ready','bootTime','custom','getDate','info','forecast.current.weather','analysis.training.status','error','protectAiMemory','430rBjsTN','scheduleJob','subscribeStates','infrasoundLocked','./lib/installer','cancel','application/json','getMinutes','exports','matrix','infrasoundArmingId','üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20','driftAnalysisTimer','now','@iobroker/adapter-core','date','triggerBriefing','daswetter.0','triggerInfrasoundCorrelation','dailyDigests','\x20(Bewohner\x20anwesend\x20-\x20normal)','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','includes','TRAIN_SECURITY','version','@google/generative-ai','sendMorningBriefing','log','TRAIN_HEALTH','isArray','type','Sonne:\x20','loadSystemMode','55781arjAMW','.system.mode','round','analysis.training.triggerSecurity','92037knAPBY','haust√ºr',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','from','min','generateContent','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','modules','rawEventLog','lastAlertState','message','./lib/setup','PREDICT_ENERGY','minDaysForBaseline','analysis.visualization.pulse','split','triggerEnergyPrediction\x20Error:\x20','energy','updateTopology','\x20-\x20','./lib/scheduler','executeAutomationAction','infrasoundEnabled','fill','keys','isSolar','unload','¬∞C)','apply','runPythonHealthCheck','updateTopologyMatrix','getObjectViewAsync','common','analysis.health.todayRoomDetails','name','13TPtjuq','getForeignObjectsAsync','Room\x20History\x20(24h\x20Buckets)','getOverviewData','comfort','forEach','send','telegram','ANALYZE_GAIT','roomIntegratorTimer','join','Guest\x20Mode','config','length','Gemini\x20Report\x20Night','scanForDevices','geminiModel','Room\x20Dwell\x20Time\x20Stats','(((.+)+)+)+$','analysis.automation.targetId','NORMAL','party','üîä\x20Infraschall:\x20','temperature','LTM.dailyDigests','state','existsSync','instance','rows','Live\x20Event\x20Pulse','No\x20data','devices','triggerGaitAnalysis','namespace'];a0_0xa1da=function(){return _0x28fb9a;};return a0_0xa1da();}(function(_0x418682,_0x2ec371){const _0x365170=a0_0x1e8a,_0x24aa6c=_0x418682();while(!![]){try{const _0x752627=parseInt(_0x365170(0x1f3))/0x1*(parseInt(_0x365170(0x16c))/0x2)+-parseInt(_0x365170(0x10c))/0x3*(-parseInt(_0x365170(0x235))/0x4)+parseInt(_0x365170(0x19d))/0x5*(parseInt(_0x365170(0x18d))/0x6)+-parseInt(_0x365170(0x155))/0x7*(parseInt(_0x365170(0x16d))/0x8)+-parseInt(_0x365170(0x1e0))/0x9+-parseInt(_0x365170(0xe7))/0xa*(parseInt(_0x365170(0x108))/0xb)+-parseInt(_0x365170(0x1c8))/0xc*(-parseInt(_0x365170(0x12f))/0xd);if(_0x752627===_0x2ec371)break;else _0x24aa6c['push'](_0x24aa6c['shift']());}catch(_0x23351f){_0x24aa6c['push'](_0x24aa6c['shift']());}}}(a0_0xa1da,0x4a38e));const a0_0x1f536b=(function(){let _0x528800=!![];return function(_0x16e702,_0x48710c){const _0x3bb5ac=_0x528800?function(){const _0xb0f9b8=a0_0x1e8a;if(_0x48710c){const _0x332193=_0x48710c[_0xb0f9b8(0x128)](_0x16e702,arguments);return _0x48710c=null,_0x332193;}}:function(){};return _0x528800=![],_0x3bb5ac;};}()),a0_0x144909=a0_0x1f536b(this,function(){const _0x18ac71=a0_0x1e8a;return a0_0x144909[_0x18ac71(0x153)]()[_0x18ac71(0x207)](_0x18ac71(0x141))['toString']()[_0x18ac71(0x1b1)](a0_0x144909)['search'](_0x18ac71(0x141));});a0_0x144909();function a0_0x1e8a(_0x43e5d7,_0x387654){const _0x3c3ac9=a0_0xa1da();return a0_0x1e8a=function(_0x144909,_0x1f536b){_0x144909=_0x144909-0xe1;let _0xa1da57=_0x3c3ac9[_0x144909];return _0xa1da57;},a0_0x1e8a(_0x43e5d7,_0x387654);}'use strict';const utils=require(a0_0x356552(0xf5)),{GoogleGenerativeAI}=require(a0_0x356552(0x100)),path=require(a0_0x356552(0x15f)),fs=require('fs'),installer=require(a0_0x356552(0xeb)),scanner=require(a0_0x356552(0x1df)),schedulers=require(a0_0x356552(0x120)),topology=require('./lib/topology'),setup=require(a0_0x356552(0x117)),recorder=require(a0_0x356552(0x178)),pythonBridge=require('./lib/python_bridge'),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x356552(0x24b)),automation=require(a0_0x356552(0x1ff)),GEMINI_MODEL=a0_0x356552(0x1c0);class CogniLiving extends utils[a0_0x356552(0x1ed)]{constructor(_0x46810f){const _0x2c360b=a0_0x356552;super({..._0x46810f,'name':_0x2c360b(0x251)}),this[_0x2c360b(0x1a3)]=[],this[_0x2c360b(0x180)]=[],this[_0x2c360b(0x114)]=[],this[_0x2c360b(0xfa)]=[],this[_0x2c360b(0x1f2)]={},this[_0x2c360b(0x1a5)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x2c360b(0x188)]=!![],this[_0x2c360b(0x166)]=null,this[_0x2c360b(0x15c)]=null,this[_0x2c360b(0x1d5)]=![],this[_0x2c360b(0x205)]=null,this[_0x2c360b(0x13f)]=null,this['currentSystemMode']=setup[_0x2c360b(0x1ad)][_0x2c360b(0x143)],this[_0x2c360b(0x18c)]=![],this[_0x2c360b(0x115)]=![],this['analysisTimer']=null,this[_0x2c360b(0x1ee)]=null,this[_0x2c360b(0x172)]=null,this['ltmJob']=null,this[_0x2c360b(0x201)]=null,this[_0x2c360b(0xf3)]=null,this['briefingJob']=null,this['historyJob']=null,this[_0x2c360b(0x22d)]=null,this[_0x2c360b(0x164)]=null,this[_0x2c360b(0x138)]=null,this[_0x2c360b(0x19e)]=![],this[_0x2c360b(0x190)]=Date[_0x2c360b(0xf4)](),this[_0x2c360b(0x209)]=null,this['bootTime']=Date['now'](),this[_0x2c360b(0xea)]=![],this['pressureBuffer']=[],this[_0x2c360b(0x1d2)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x2c360b(0x25f),this[_0x2c360b(0x21c)]['bind'](this)),this['on'](_0x2c360b(0x231),this[_0x2c360b(0x21a)][_0x2c360b(0x1bc)](this)),this['on'](_0x2c360b(0x126),this[_0x2c360b(0x23f)][_0x2c360b(0x1bc)](this)),this['on'](_0x2c360b(0x116),this[_0x2c360b(0x229)][_0x2c360b(0x1bc)](this));}async[a0_0x356552(0x21c)](){const _0xfd31ad=a0_0x356552;this[_0xfd31ad(0x102)]['info']('cogni-living\x20adapter\x20starting\x20(v'+this[_0xfd31ad(0xff)]+_0xfd31ad(0x10e));if(this['config']['moduleHealth']!==undefined)this['activeModules']['health']=this[_0xfd31ad(0x13b)]['moduleHealth'];if(this[_0xfd31ad(0x13b)][_0xfd31ad(0x163)]!==undefined)this[_0xfd31ad(0x1d2)][_0xfd31ad(0x208)]=this['config'][_0xfd31ad(0x163)];if(this[_0xfd31ad(0x13b)]['moduleEnergy']!==undefined)this['activeModules'][_0xfd31ad(0x11d)]=this[_0xfd31ad(0x13b)][_0xfd31ad(0x233)];if(this[_0xfd31ad(0x13b)][_0xfd31ad(0x1b8)]!==undefined)this[_0xfd31ad(0x1d2)][_0xfd31ad(0x133)]=this[_0xfd31ad(0x13b)][_0xfd31ad(0x1b8)];if(this[_0xfd31ad(0x13b)][_0xfd31ad(0x113)])this[_0xfd31ad(0x1d2)]={...this['activeModules'],...this[_0xfd31ad(0x13b)]['modules']};this['startSystem']();}async[a0_0x356552(0x20d)](){const _0x27e7ef=a0_0x356552;await setup[_0x27e7ef(0x25a)](this);try{this[_0x27e7ef(0x18c)]=await setup[_0x27e7ef(0x175)](this[_0x27e7ef(0x13b)][_0x27e7ef(0x1eb)]);}catch(_0x582d99){}if(!this[_0x27e7ef(0x13b)]['inactivityThresholdHours']||this['config']['inactivityThresholdHours']<0.1)this[_0x27e7ef(0x13b)][_0x27e7ef(0x194)]=0xc;await setup[_0x27e7ef(0x185)](this),await setup[_0x27e7ef(0x234)](this),topology[_0x27e7ef(0x11e)](this);try{const _0x56dff7=await this[_0x27e7ef(0x1f1)](_0x27e7ef(0x1fb)),_0x1d0017=await this[_0x27e7ef(0x1f1)](_0x27e7ef(0x259));_0x56dff7&&_0x56dff7[_0x27e7ef(0x19f)]&&_0x1d0017&&_0x1d0017['val']&&(Date[_0x27e7ef(0xf4)]()-_0x56dff7['ts']<0x4*0xe10*0x3e8&&(this['memoryCache']={'times':JSON[_0x27e7ef(0x16b)](_0x56dff7['val']),'sources':JSON[_0x27e7ef(0x16b)](_0x1d0017[_0x27e7ef(0x19f)])}));}catch(_0x398e88){}if(this[_0x27e7ef(0x13b)][_0x27e7ef(0x197)])try{this[_0x27e7ef(0x205)]=new GoogleGenerativeAI(this[_0x27e7ef(0x13b)][_0x27e7ef(0x197)]),this[_0x27e7ef(0x13f)]=this[_0x27e7ef(0x205)][_0x27e7ef(0x171)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x27e7ef(0xed)}});}catch(_0x371827){this[_0x27e7ef(0x102)][_0x27e7ef(0xe5)](_0x27e7ef(0x16e)+_0x371827[_0x27e7ef(0x116)]);}await setup[_0x27e7ef(0x183)](this),await this[_0x27e7ef(0x107)](),schedulers[_0x27e7ef(0x1aa)](this),await this[_0x27e7ef(0x22b)]('analysis.visualization.pulse',{'type':'state','common':{'name':_0x27e7ef(0x14c),'type':'number','role':_0x27e7ef(0x1b9),'read':!![],'write':![]},'native':{}}),await this[_0x27e7ef(0x22b)](_0x27e7ef(0x1d9),{'type':_0x27e7ef(0x148),'common':{'name':_0x27e7ef(0x140),'type':'string','role':_0x27e7ef(0x168),'read':!![],'write':![],'def':_0x27e7ef(0x112)},'native':{}}),await this['setObjectNotExistsAsync']('analysis.activity.roomHistory',{'type':_0x27e7ef(0x148),'common':{'name':_0x27e7ef(0x131),'type':_0x27e7ef(0x199),'role':_0x27e7ef(0x168),'read':!![],'write':![],'def':_0x27e7ef(0x24e)},'native':{}}),await this[_0x27e7ef(0x22b)]('analysis.health.geminiNight',{'type':_0x27e7ef(0x148),'common':{'name':_0x27e7ef(0x13d),'type':'string','role':_0x27e7ef(0x1a2),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x27e7ef(0x22b)](_0x27e7ef(0x170),{'type':_0x27e7ef(0x148),'common':{'name':'Gemini\x20Report\x20Day','type':_0x27e7ef(0x199),'role':'text','read':!![],'write':![],'def':_0x27e7ef(0x1c5)},'native':{}}),await this[_0x27e7ef(0x22b)](_0x27e7ef(0x157),{'type':_0x27e7ef(0x148),'common':{'name':_0x27e7ef(0x181),'type':_0x27e7ef(0x199),'role':_0x27e7ef(0x168),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x27e7ef(0x22b)]('analysis.health.todayRoomDetails',{'type':_0x27e7ef(0x148),'common':{'name':_0x27e7ef(0x25e),'type':_0x27e7ef(0x199),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x27e7ef(0x22b)]('analysis.health.activityTrend',{'type':_0x27e7ef(0x148),'common':{'name':_0x27e7ef(0x189),'type':_0x27e7ef(0x218),'role':_0x27e7ef(0x1b9),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x27e7ef(0x22b)](_0x27e7ef(0x1fb),{'type':'state','common':{'name':_0x27e7ef(0x158),'type':_0x27e7ef(0x199),'role':_0x27e7ef(0x168),'read':!![],'write':![]},'native':{}});try{const _0x2bc6eb=await this[_0x27e7ef(0x1f1)]('events.history');if(_0x2bc6eb&&_0x2bc6eb[_0x27e7ef(0x19f)]){this['eventHistory']=JSON['parse'](_0x2bc6eb[_0x27e7ef(0x19f)]);if(this[_0x27e7ef(0x18c)]){const _0x14a0f6=await this['getStateAsync']('LTM.rawEventLog');if(_0x14a0f6&&_0x14a0f6[_0x27e7ef(0x19f)])this[_0x27e7ef(0x114)]=JSON[_0x27e7ef(0x16b)](_0x14a0f6[_0x27e7ef(0x19f)]);}this['log'][_0x27e7ef(0xe2)]('üì¶\x20Restored\x20'+this[_0x27e7ef(0x1a3)][_0x27e7ef(0x13c)]+_0x27e7ef(0x1a4));}}catch(_0x580a56){this[_0x27e7ef(0x1a3)]=[];}try{const _0x1379bc=await this[_0x27e7ef(0x1f1)](_0x27e7ef(0x147));if(_0x1379bc&&_0x1379bc[_0x27e7ef(0x19f)])this['dailyDigests']=JSON[_0x27e7ef(0x16b)](_0x1379bc[_0x27e7ef(0x19f)]);}catch(_0x3977f8){this['dailyDigests']=[];}const _0x11086d=this[_0x27e7ef(0xfa)][_0x27e7ef(0x13c)]>=(this['config'][_0x27e7ef(0x119)]||0x7)?_0x27e7ef(0x239)+this[_0x27e7ef(0xfa)]['length']+_0x27e7ef(0x226):_0x27e7ef(0x1c9)+this[_0x27e7ef(0xfa)][_0x27e7ef(0x13c)]+'/'+(this[_0x27e7ef(0x13b)]['minDaysForBaseline']||0x7)+')';await this[_0x27e7ef(0x16f)]('LTM.baselineStatus',{'val':_0x11086d,'ack':!![]}),this[_0x27e7ef(0xe9)](_0x27e7ef(0x232)),this[_0x27e7ef(0xe9)]('LTM.triggerDailyDigest'),this[_0x27e7ef(0xe9)](_0x27e7ef(0x169));this[_0x27e7ef(0x13b)][_0x27e7ef(0x122)]&&this[_0x27e7ef(0x13b)][_0x27e7ef(0x1c4)]&&this[_0x27e7ef(0x1d2)][_0x27e7ef(0x208)]&&this[_0x27e7ef(0x1cc)](this[_0x27e7ef(0x13b)][_0x27e7ef(0x1c4)]);const _0x111563=this['config']['devices'];if(_0x111563)for(const _0xa5d955 of _0x111563){await this[_0x27e7ef(0x20b)](_0xa5d955['id']);}const _0xa75bbb=this['config'][_0x27e7ef(0x25d)];if(_0xa75bbb)for(const _0x1a52d7 of _0xa75bbb){await this['subscribeForeignStatesAsync'](_0x1a52d7);}const _0x330e02=require(_0x27e7ef(0x241));if(this['historyJob'])this[_0x27e7ef(0x200)][_0x27e7ef(0xec)]();this[_0x27e7ef(0x200)]=_0x330e02[_0x27e7ef(0xe8)](_0x27e7ef(0x249),()=>{const _0x1360f8=_0x27e7ef;this[_0x1360f8(0x248)]();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this['roomIntegratorTimer'])clearInterval(this[_0x27e7ef(0x138)]);this['integrateRoomTime'](),this[_0x27e7ef(0x138)]=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this[_0x27e7ef(0x164)])clearInterval(this[_0x27e7ef(0x164)]);this[_0x27e7ef(0x164)]=setInterval(()=>{const _0x14b497=_0x27e7ef;this[_0x14b497(0x18c)]&&this[_0x14b497(0x1d2)][_0x14b497(0x21d)]&&this[_0x14b497(0x129)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x27e7ef(0x1e2)])clearInterval(this[_0x27e7ef(0x1e2)]);this[_0x27e7ef(0x1d2)][_0x27e7ef(0x11d)]&&(this[_0x27e7ef(0x1e2)]=setInterval(()=>{this['triggerEnergyPrediction']();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x27e7ef(0x21f)](),0x2710));if(this['calendarCheckTimer'])clearInterval(this[_0x27e7ef(0x1ee)]);this[_0x27e7ef(0x13b)][_0x27e7ef(0x240)]&&this[_0x27e7ef(0x1d2)]['energy']&&(this[_0x27e7ef(0x1ee)]=setInterval(()=>{const _0x539bf2=_0x27e7ef;automation[_0x539bf2(0x18a)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x27e7ef(0x18a)](this),0x3a98));if(this[_0x27e7ef(0x172)])clearInterval(this['presenceCheckTimer']);this['config'][_0x27e7ef(0x25d)]&&this['config'][_0x27e7ef(0x25d)][_0x27e7ef(0x13c)]>0x0&&(this[_0x27e7ef(0x172)]=setInterval(async()=>{const _0x1d95d3=_0x27e7ef;await this[_0x1d95d3(0x154)]();},0x3c*0x3e8),setTimeout(async()=>await this['checkWifiPresence'](),0x1388));const _0x5c4c53=path['join'](__dirname,'.venv',_0x27e7ef(0x1e9),'python');pythonBridge[_0x27e7ef(0x16a)](this,_0x5c4c53);}[a0_0x356552(0x23f)](_0x32b2b0){const _0x205809=a0_0x356552;if(this[_0x205809(0x200)])this[_0x205809(0x200)]['cancel']();this[_0x205809(0x248)]()['then'](()=>{const _0xe4b195=_0x205809;if(this[_0xe4b195(0x1e2)])clearInterval(this[_0xe4b195(0x1e2)]);if(this[_0xe4b195(0x1ee)])clearInterval(this[_0xe4b195(0x1ee)]);if(this[_0xe4b195(0x172)])clearInterval(this[_0xe4b195(0x172)]);if(this[_0xe4b195(0x138)])clearInterval(this[_0xe4b195(0x138)]);recorder['abortExitTimer'](this),pythonBridge[_0xe4b195(0x1c6)](this),_0x32b2b0();});}async[a0_0x356552(0x191)](){const _0x50fafe=a0_0x356552;if(!this[_0x50fafe(0x1a3)]||this[_0x50fafe(0x1a3)][_0x50fafe(0x13c)]===0x0){this[_0x50fafe(0x102)]['warn'](_0x50fafe(0x1cb));return;}this['log'][_0x50fafe(0xe2)](_0x50fafe(0x254)+this['eventHistory']['length']+_0x50fafe(0x203));const _0x23cb38=new Date()[_0x50fafe(0x159)](0x0,0x0,0x0,0x0),_0x2be0f3=_0x50fafe(0x22f);let _0x13418c={'history':{},'date':new Date()[_0x50fafe(0x1ea)]()};const _0x5b42e9=_0x50fafe(0x157),_0x2d840e=_0x50fafe(0x12d);let _0x52849e=new Array(0x30)[_0x50fafe(0x123)](0x0),_0x3c852c=Array[_0x50fafe(0x10f)]({'length':0x30},()=>[]);this[_0x50fafe(0x1a3)]['forEach'](_0x50f0f7=>{const _0xe501=_0x50fafe;if(_0x50f0f7[_0xe501(0x1bd)]>=_0x23cb38){if(recorder[_0xe501(0x1ab)](_0x50f0f7['type'],_0x50f0f7[_0xe501(0x1b9)])){const _0x260e5e=new Date(_0x50f0f7[_0xe501(0x1bd)]),_0x35f159=_0x260e5e[_0xe501(0x1f7)]()*0x2+(_0x260e5e[_0xe501(0xee)]()>=0x1e?0x1:0x0);if(_0x35f159<0x30){_0x52849e[_0x35f159]++;const _0x567604=_0x50f0f7[_0xe501(0x160)]||_0x50f0f7['name']||'?';let _0x3e2db6=_0x3c852c[_0x35f159];!_0x3e2db6[_0xe501(0xfd)](_0x567604)&&_0x3e2db6[_0xe501(0x1d8)](_0x567604);}const _0x2310e5=_0x260e5e['getHours']();let _0x44dea8=_0x50f0f7['location']||_0xe501(0x15e);const _0x5ba5e1=(this[_0xe501(0x13b)][_0xe501(0x14e)]||[])[_0xe501(0x21b)](_0x197085=>_0x197085['location']===_0x44dea8);if(_0x5ba5e1)_0x44dea8=_0x5ba5e1[_0xe501(0x160)];if(!_0x13418c['history'][_0x44dea8])_0x13418c['history'][_0x44dea8]=new Array(0x18)[_0xe501(0x123)](0x0);if(_0x13418c['history'][_0x44dea8][_0x2310e5]<0x3c)_0x13418c[_0xe501(0x18b)][_0x44dea8][_0x2310e5]++;}}});const _0x16c333=await this[_0x50fafe(0x1f1)](_0x2be0f3);(!_0x16c333||!_0x16c333[_0x50fafe(0x19f)]||_0x16c333[_0x50fafe(0x19f)]==='{}'||_0x16c333[_0x50fafe(0x19f)][_0x50fafe(0xfd)](_0x50fafe(0x1f6)))&&await this[_0x50fafe(0x16f)](_0x2be0f3,{'val':JSON[_0x50fafe(0x22e)](_0x13418c),'ack':!![]}),await this[_0x50fafe(0x16f)](_0x5b42e9,{'val':JSON[_0x50fafe(0x22e)](_0x52849e),'ack':!![]}),await this['setStateAsync'](_0x2d840e,{'val':JSON[_0x50fafe(0x22e)](_0x3c852c),'ack':!![]}),this['log']['info'](_0x50fafe(0x206));}async[a0_0x356552(0x248)](){const _0x987886=a0_0x356552;if(!this['activeModules']['health'])return;const _0x5ad731=new Date()[_0x987886(0x216)]()[_0x987886(0x11b)]('T')[0x0];this[_0x987886(0x102)]['debug'](_0x987886(0x25b)+_0x5ad731+_0x987886(0x22a));try{const [_0x5079e7,_0x5c6237,_0x25ecf0,_0x537d96,_0x3dbd7d,_0x4e1a55]=await Promise[_0x987886(0x195)]([this['getStateAsync'](_0x987886(0x22f)),this['getStateAsync'](_0x987886(0x17b)),this[_0x987886(0x1f1)](_0x987886(0x170)),this[_0x987886(0x1f1)](_0x987886(0x151)),this['getStateAsync']('analysis.health.todayVector'),this[_0x987886(0x1f1)]('analysis.health.activityTrend')]),_0x320c36=new Date()[_0x987886(0x159)](0x0,0x0,0x0,0x0),_0x17c702=this[_0x987886(0x1a3)]['filter'](_0x27c115=>_0x27c115[_0x987886(0x1bd)]>=_0x320c36&&(_0x27c115[_0x987886(0x12e)][_0x987886(0x1c2)]()[_0x987886(0xfd)](_0x987886(0x10d))||_0x27c115[_0x987886(0x12e)]['toLowerCase']()['includes'](_0x987886(0x204)))&&(_0x27c115[_0x987886(0x1b9)]===!![]||_0x27c115[_0x987886(0x1b9)]==='open'))[_0x987886(0x13c)];let _0x177ccf=0x55;if(_0x4e1a55&&_0x4e1a55[_0x987886(0x19f)]!==undefined)_0x177ccf=Math[_0x987886(0x110)](0x64,Math[_0x987886(0x1e3)](0x14,Math[_0x987886(0x10a)](0x50+Number(_0x4e1a55[_0x987886(0x19f)])*0x5)));const _0x1bc45c=this['eventHistory'][_0x987886(0x221)](_0x30d1cc=>_0x30d1cc['timestamp']>=_0x320c36),_0x1d9a58={'date':_0x5ad731,'timestamp':Date[_0x987886(0xf4)](),'roomHistory':_0x5079e7?.['val']?JSON[_0x987886(0x16b)](_0x5079e7[_0x987886(0x19f)]):{},'geminiNight':_0x5c6237?.[_0x987886(0x19f)]||_0x987886(0x220),'geminiDay':_0x25ecf0?.[_0x987886(0x19f)]||'Keine\x20Daten','anomalyScore':_0x537d96?.[_0x987886(0x19f)]||0.1,'todayVector':_0x3dbd7d?.[_0x987886(0x19f)]?JSON[_0x987886(0x16b)](_0x3dbd7d[_0x987886(0x19f)]):new Array(0x30)[_0x987886(0x123)](0x0),'batteryLevel':_0x177ccf,'freshAirCount':_0x17c702,'eventHistory':_0x1bc45c},_0x51ac9b=utils[_0x987886(0x1dc)](),_0x374135=path[_0x987886(0x139)](_0x51ac9b,_0x987886(0x251),_0x987886(0x18b));if(!fs['existsSync'](_0x374135))fs[_0x987886(0x1ba)](_0x374135,{'recursive':!![]});const _0x391a32=path['join'](_0x374135,_0x5ad731+_0x987886(0x17a));fs[_0x987886(0x258)](_0x391a32,JSON['stringify'](_0x1d9a58)),this[_0x987886(0x102)][_0x987886(0xe2)](_0x987886(0x1cd)+_0x391a32);}catch(_0x48501d){this[_0x987886(0x102)][_0x987886(0xe5)](_0x987886(0x1f0)+_0x48501d[_0x987886(0x116)]);}}async[a0_0x356552(0x1be)](){const _0x4f314a=a0_0x356552;if(!this[_0x4f314a(0x188)])return;try{let _0x520f85=null;try{const _0x45f675=await this[_0x4f314a(0x1f1)]('analysis.prediction.trackerTopRoom'),_0x238479=await this['getStateAsync'](_0x4f314a(0x20c));if(_0x45f675&&_0x45f675[_0x4f314a(0x19f)]&&_0x238479&&_0x238479[_0x4f314a(0x19f)]&&_0x238479[_0x4f314a(0x19f)]>0.3){if(_0x45f675[_0x4f314a(0x19f)]!==_0x4f314a(0x15e)&&_0x45f675['val']!=='Init...')_0x520f85=_0x45f675[_0x4f314a(0x19f)];}}catch(_0x386eaf){}if(!_0x520f85){const _0x4960cb=this['config'][_0x4f314a(0x14e)]||[];for(const _0x375668 of _0x4960cb){if(_0x375668['type']===_0x4f314a(0x219)&&_0x375668['location'])try{const _0x4e7fca=await this[_0x4f314a(0x1da)](_0x375668['id']);if(_0x4e7fca&&(_0x4e7fca[_0x4f314a(0x19f)]===!![]||_0x4e7fca[_0x4f314a(0x19f)]==='on'||_0x4e7fca['val']===0x1)){_0x520f85=_0x375668['location'];break;}}catch(_0x4e1ce2){}}}if(!_0x520f85)return;const _0x3d0bcf=this['config'][_0x4f314a(0x14e)]||[];let _0x4f3ae3=_0x520f85;const _0x3c56d9=_0x3d0bcf[_0x4f314a(0x21b)](_0x3c20ec=>_0x3c20ec[_0x4f314a(0x160)]&&_0x3c20ec[_0x4f314a(0x160)][_0x4f314a(0x1c2)]()===_0x520f85[_0x4f314a(0x1c2)]());if(_0x3c56d9)_0x4f3ae3=_0x3c56d9[_0x4f314a(0x160)];const _0x4a678b=_0x4f314a(0x22f),_0x15655e=await this[_0x4f314a(0x1f1)](_0x4a678b),_0x5d3c52=new Date()[_0x4f314a(0x1ea)]();let _0x5c87f7={'history':{},'date':_0x5d3c52};if(_0x15655e&&_0x15655e[_0x4f314a(0x19f)])try{_0x5c87f7=JSON['parse'](_0x15655e[_0x4f314a(0x19f)]);}catch(_0x2066af){}_0x5c87f7[_0x4f314a(0xf6)]!==_0x5d3c52&&(_0x5c87f7[_0x4f314a(0x18b)]={},_0x5c87f7['date']=_0x5d3c52);if(!_0x5c87f7[_0x4f314a(0x18b)][_0x4f3ae3])_0x5c87f7[_0x4f314a(0x18b)][_0x4f3ae3]=new Array(0x18)[_0x4f314a(0x123)](0x0);const _0x5ba43d=new Date()['getHours']();if(_0x5c87f7[_0x4f314a(0x18b)][_0x4f3ae3][_0x5ba43d]<0x3c)_0x5c87f7[_0x4f314a(0x18b)][_0x4f3ae3][_0x5ba43d]++;await this['setStateAsync'](_0x4a678b,{'val':JSON[_0x4f314a(0x22e)](_0x5c87f7),'ack':!![]});}catch(_0x5883bc){this[_0x4f314a(0x102)][_0x4f314a(0x15a)](_0x4f314a(0x1b2)+_0x5883bc[_0x4f314a(0x116)]);}}async[a0_0x356552(0x229)](_0x308db3){const _0x3cfb95=a0_0x356552;if(typeof _0x308db3==='object'&&_0x308db3[_0x3cfb95(0x116)]){if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x182)){const _0x519a9b=_0x308db3[_0x3cfb95(0x116)]['date'],_0x4f71da=utils[_0x3cfb95(0x1dc)](),_0x34dd2e=path[_0x3cfb95(0x139)](_0x4f71da,'cogni-living',_0x3cfb95(0x18b),_0x519a9b+_0x3cfb95(0x17a));if(fs[_0x3cfb95(0x149)](_0x34dd2e))try{const _0x163de5=JSON[_0x3cfb95(0x16b)](fs[_0x3cfb95(0x1b4)](_0x34dd2e,_0x3cfb95(0x1d7)));this['sendTo'](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':!![],'data':_0x163de5},_0x308db3['callback']);}catch(_0x2266cf){this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3['command'],{'success':![],'error':'Corrupt'},_0x308db3['callback']);}else this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':![],'error':_0x3cfb95(0x14d)},_0x308db3['callback']);}else{if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x132)){const _0x55411b=this[_0x3cfb95(0xfa)]['length'];let _0x5cd628=new Array(0x30)[_0x3cfb95(0x123)](0x0),_0x2af162=Array[_0x3cfb95(0x10f)]({'length':0x30},()=>[]);try{const _0x1d4ad6=await this[_0x3cfb95(0x1f1)](_0x3cfb95(0x157));if(_0x1d4ad6&&_0x1d4ad6['val'])_0x5cd628=JSON['parse'](_0x1d4ad6['val']);const _0x2fb3ce=await this[_0x3cfb95(0x1f1)](_0x3cfb95(0x12d));if(_0x2fb3ce&&_0x2fb3ce[_0x3cfb95(0x19f)])_0x2af162=JSON[_0x3cfb95(0x16b)](_0x2fb3ce[_0x3cfb95(0x19f)]);}catch(_0x5ab787){}let _0x271886=new Array(0x30)[_0x3cfb95(0x123)](0x0);try{const _0x2f3eaf=new Date();_0x2f3eaf['setDate'](_0x2f3eaf[_0x3cfb95(0xe1)]()-0x1);const _0x53e4db=_0x2f3eaf[_0x3cfb95(0x216)]()[_0x3cfb95(0x11b)]('T')[0x0],_0x479348=utils[_0x3cfb95(0x1dc)](),_0x40f907=path['join'](_0x479348,_0x3cfb95(0x251),_0x3cfb95(0x18b),_0x53e4db+_0x3cfb95(0x17a));if(fs[_0x3cfb95(0x149)](_0x40f907)){const _0x281e23=JSON['parse'](fs['readFileSync'](_0x40f907,_0x3cfb95(0x1d7)));if(_0x281e23&&_0x281e23['todayVector'])_0x271886=_0x281e23[_0x3cfb95(0x19a)];}}catch(_0x45b1c6){}let _0x3cddd6={'today':{},'yesterday':{}};try{const _0x22808e=await this['getStateAsync'](_0x3cfb95(0x1d9));if(_0x22808e&&_0x22808e[_0x3cfb95(0x19f)])_0x3cddd6=JSON[_0x3cfb95(0x16b)](_0x22808e['val']);}catch(_0x50c4df){}let _0x1ec8b3=null;try{const _0x3bd1ba=await this[_0x3cfb95(0x1f1)](_0x3cfb95(0x245));if(_0x3bd1ba)_0x1ec8b3=_0x3bd1ba[_0x3cfb95(0x19f)];}catch(_0x331805){}if(_0x1ec8b3===undefined||_0x1ec8b3===null){const _0x2f6751=_0x5cd628['reduce']((_0x53d113,_0x108e64)=>_0x53d113+_0x108e64,0x0),_0x4adad5=Math['min'](0x2,Math[_0x3cfb95(0x1e3)](-0x2,(0x64-_0x2f6751)/0x32));_0x1ec8b3=_0x4adad5;}let _0x26ffa6=![],_0x2fd923='',_0x51a6f7='',_0x5703c3='';try{const _0x522ef6=await this[_0x3cfb95(0x1f1)]('analysis.automation.patternDetected');if(_0x522ef6&&_0x522ef6['val']){_0x26ffa6=!![];const _0x21790f=await this[_0x3cfb95(0x1f1)]('analysis.automation.description');_0x2fd923=_0x21790f?_0x21790f['val']:'';const _0x20ed9c=await this['getStateAsync'](_0x3cfb95(0x142));_0x51a6f7=_0x20ed9c?_0x20ed9c[_0x3cfb95(0x19f)]:'';const _0x27484b=await this[_0x3cfb95(0x1f1)](_0x3cfb95(0x1ef));_0x5703c3=_0x27484b?_0x27484b[_0x3cfb95(0x19f)]:'';}}catch(_0x562bfc){}const _0xb57c31=await this[_0x3cfb95(0x1ac)](),_0x248879=(this[_0x3cfb95(0x13b)][_0x3cfb95(0x14e)]||[])['some'](_0x316b4e=>_0x316b4e[_0x3cfb95(0x125)]),_0x1aa2e6=_0xb57c31&&_0x248879;let _0x9d5699='';try{const _0x54c5fb=await this[_0x3cfb95(0x1f1)]('system.presenceWho');if(_0x54c5fb&&_0x54c5fb['val'])_0x9d5699=_0x54c5fb[_0x3cfb95(0x19f)];}catch(_0x38ed28){}this[_0x3cfb95(0x238)](_0x308db3['from'],_0x308db3[_0x3cfb95(0x227)],{'success':!![],'eventHistory':this[_0x3cfb95(0x1a3)][_0x3cfb95(0x24a)](0x0,0x7d0),'stats':{'digestCount':_0x55411b,'isPresent':this['isPresent'],'hourlyActivity':_0x5cd628,'hourlyDetails':_0x2af162,'yesterdayActivity':_0x271886,'solarActive':_0x1aa2e6,'presenceWho':_0x9d5699,'roomStats':_0x3cddd6,'activityTrend':_0x1ec8b3,'modules':this[_0x3cfb95(0x1d2)]},'automation':{'detected':_0x26ffa6,'description':_0x2fd923,'targetId':_0x51a6f7,'targetValue':_0x5703c3}},_0x308db3[_0x3cfb95(0x17c)]);}else{if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x212))try{const _0x2b0306=await automation['scanThermostats'](this);this['sendTo'](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':!![],'results':_0x2b0306},_0x308db3[_0x3cfb95(0x17c)]);}catch(_0x1566f8){this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':![],'error':_0x1566f8[_0x3cfb95(0x116)]},_0x308db3[_0x3cfb95(0x17c)]);}else{if(_0x308db3[_0x3cfb95(0x227)]==='scanDevices')try{const _0x5f15df=await scanner[_0x3cfb95(0x13e)](this,_0x308db3[_0x3cfb95(0x116)]||{});this['sendTo'](_0x308db3['from'],_0x308db3[_0x3cfb95(0x227)],{'success':!![],'devices':_0x5f15df},_0x308db3[_0x3cfb95(0x17c)]);}catch(_0xf7136c){}else{if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x19c)){const _0x1f78fc=await this['getForeignObjectsAsync'](_0x3cfb95(0x1e6),_0x3cfb95(0x17d)),_0x3ee09f=[];if(_0x1f78fc)for(const _0x66d97b in _0x1f78fc){let _0x55a646=_0x1f78fc[_0x66d97b]['common'][_0x3cfb95(0x12e)];if(_0x55a646&&typeof _0x55a646===_0x3cfb95(0x1b5))_0x55a646=_0x55a646['de']||_0x55a646['en']||Object[_0x3cfb95(0x250)](_0x55a646)[0x0]||JSON['stringify'](_0x55a646);_0x3ee09f[_0x3cfb95(0x1d8)]({'id':_0x66d97b,'name':String(_0x55a646||_0x66d97b)});}const _0x5beabd=await this[_0x3cfb95(0x130)](_0x3cfb95(0x1e8),_0x3cfb95(0x17d)),_0xb4d26e=[];if(_0x5beabd)for(const _0x5a7ca7 in _0x5beabd){let _0x4c2ed0=_0x5beabd[_0x5a7ca7][_0x3cfb95(0x12c)]['name'];if(_0x4c2ed0&&typeof _0x4c2ed0===_0x3cfb95(0x1b5))_0x4c2ed0=_0x4c2ed0['de']||_0x4c2ed0['en']||Object[_0x3cfb95(0x250)](_0x4c2ed0)[0x0]||JSON[_0x3cfb95(0x22e)](_0x4c2ed0);_0xb4d26e[_0x3cfb95(0x1d8)](String(_0x4c2ed0||_0x5a7ca7[_0x3cfb95(0x11b)]('.')[_0x3cfb95(0x1f4)]()));}this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':!![],'enums':_0x3ee09f,'rooms':_0xb4d26e},_0x308db3[_0x3cfb95(0x17c)]);}else{if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x228))try{const _0x2e8c1d=await this[_0x3cfb95(0x12b)]('system','instance',{'startkey':_0x3cfb95(0x198),'endkey':_0x3cfb95(0x236)}),_0x37dc31=new Set();if(_0x2e8c1d&&_0x2e8c1d[_0x3cfb95(0x14b)])for(const _0x1da4f7 of _0x2e8c1d['rows']){const _0x4794fa=_0x1da4f7['id']['replace']('system.adapter.',''),_0x1c432d=await this[_0x3cfb95(0x1da)](_0x4794fa+_0x3cfb95(0x1b0));let _0x1e7326=![];if(_0x1c432d&&_0x1c432d[_0x3cfb95(0x19f)]){const _0x2aa213=typeof _0x1c432d['val']===_0x3cfb95(0x199)?JSON[_0x3cfb95(0x16b)](_0x1c432d[_0x3cfb95(0x19f)]):_0x1c432d[_0x3cfb95(0x19f)];Array[_0x3cfb95(0x104)](_0x2aa213)&&_0x2aa213['forEach'](_0x27bd18=>{const _0x4c7e41=_0x3cfb95;_0x27bd18[_0x4c7e41(0x184)]&&(_0x37dc31[_0x4c7e41(0x237)](_0x27bd18[_0x4c7e41(0x184)]),_0x1e7326=!![]);});}!_0x1e7326&&_0x37dc31['add'](_0x4794fa);}const _0x59a831=Array[_0x3cfb95(0x10f)](_0x37dc31);if(_0x59a831[_0x3cfb95(0x13c)]===0x0)_0x59a831['push'](_0x3cfb95(0x1ae));this['sendTo'](_0x308db3[_0x3cfb95(0x10f)],_0x308db3['command'],{'success':!![],'names':_0x59a831},_0x308db3[_0x3cfb95(0x17c)]);}catch(_0x5e3f9a){this['sendTo'](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':![],'error':_0x3cfb95(0x1d6)+_0x5e3f9a[_0x3cfb95(0x116)]},_0x308db3[_0x3cfb95(0x17c)]);}else{if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x215))try{await automation['updateSchedulePreview'](this),this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3['command'],{'success':!![]},_0x308db3[_0x3cfb95(0x17c)]);}catch(_0x5b754d){this['log'][_0x3cfb95(0x15a)]('refreshCalendar\x20failed:\x20'+_0x5b754d[_0x3cfb95(0x116)]),this['sendTo'](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':![],'error':_0x5b754d[_0x3cfb95(0x116)]},_0x308db3[_0x3cfb95(0x17c)]);}else{if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x12a))try{const _0x2f3a54=_0x308db3[_0x3cfb95(0x116)][_0x3cfb95(0xf0)];if(!_0x2f3a54||!Array[_0x3cfb95(0x104)](_0x2f3a54))throw new Error('Invalid\x20matrix\x20data');const _0x3e8597=await this['getStateAsync'](_0x3cfb95(0x1b6));if(_0x3e8597&&_0x3e8597[_0x3cfb95(0x19f)]){const _0x1faec4=JSON[_0x3cfb95(0x16b)](_0x3e8597['val']);_0x1faec4[_0x3cfb95(0xf0)]=_0x2f3a54,_0x1faec4[_0x3cfb95(0x243)]=Date['now'](),await this[_0x3cfb95(0x16f)](_0x3cfb95(0x1b6),{'val':JSON[_0x3cfb95(0x22e)](_0x1faec4),'ack':!![]}),this['log'][_0x3cfb95(0x1e5)]('üï∏Ô∏è\x20Topology\x20Matrix\x20manually\x20updated\x20by\x20user.'),this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3['command'],{'success':!![]},_0x308db3[_0x3cfb95(0x17c)]);}else throw new Error(_0x3cfb95(0x24c));}catch(_0x58195d){this['log'][_0x3cfb95(0x15a)](_0x3cfb95(0x1c3)+_0x58195d[_0x3cfb95(0x116)]),this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':![],'error':_0x58195d['message']},_0x308db3[_0x3cfb95(0x17c)]);}else{if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x196))try{const _0x4da7cb=_0x308db3[_0x3cfb95(0x116)]['command'],_0x2659c2=_0x308db3['message'];this['log']['debug'](_0x3cfb95(0x1f9)+_0x4da7cb),pythonBridge[_0x3cfb95(0x135)](this,_0x4da7cb,_0x2659c2,_0x5c1c56=>{const _0x25f872=_0x3cfb95;this[_0x25f872(0x238)](_0x308db3[_0x25f872(0x10f)],_0x308db3[_0x25f872(0x227)],_0x5c1c56,_0x308db3['callback']);});}catch(_0x4f83d4){this[_0x3cfb95(0x102)][_0x3cfb95(0x15a)]('pythonBridge\x20command\x20failed:\x20'+_0x4f83d4[_0x3cfb95(0x116)]),this[_0x3cfb95(0x238)](_0x308db3['from'],_0x308db3[_0x3cfb95(0x227)],{'type':_0x3cfb95(0x1f8),'payload':_0x4f83d4[_0x3cfb95(0x116)]},_0x308db3['callback']);}else{if(_0x308db3[_0x3cfb95(0x227)]===_0x3cfb95(0x1af))try{const _0x48d102=_0x308db3[_0x3cfb95(0x116)]?_0x308db3[_0x3cfb95(0x116)]['apiKey']:'';if(!_0x48d102)throw new Error(_0x3cfb95(0x161));const _0x4cbd84=new GoogleGenerativeAI(_0x48d102),_0x9979ea=_0x4cbd84['getGenerativeModel']({'model':GEMINI_MODEL}),_0x785654=await _0x9979ea[_0x3cfb95(0x111)](_0x3cfb95(0x15b)),_0x25dd34=await _0x785654[_0x3cfb95(0x165)],_0x1d355b=_0x25dd34[_0x3cfb95(0x1a2)]();this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':!![],'message':_0x3cfb95(0x244)+_0x1d355b[_0x3cfb95(0x210)](0x0,0x14)+_0x3cfb95(0x22a)},_0x308db3[_0x3cfb95(0x17c)]);}catch(_0x1ceece){this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3['command'],{'success':![],'message':_0x1ceece[_0x3cfb95(0x116)]},_0x308db3[_0x3cfb95(0x17c)]);}else{if(_0x308db3[_0x3cfb95(0x227)]==='testContext')try{const _0xd21bce=await this[_0x3cfb95(0x1ac)](),_0x2a7de5=await this[_0x3cfb95(0x12b)](_0x3cfb95(0x1ca),_0x3cfb95(0x14a),{'startkey':_0x3cfb95(0x198),'endkey':_0x3cfb95(0x236)}),_0x5ab29c=_0x2a7de5&&_0x2a7de5[_0x3cfb95(0x14b)]?_0x2a7de5[_0x3cfb95(0x14b)][_0x3cfb95(0x13c)]:0x0;this[_0x3cfb95(0x238)](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':!![],'weather':_0x3cfb95(0x106)+_0xd21bce+_0x3cfb95(0x177)+(this[_0x3cfb95(0x1f2)][this[_0x3cfb95(0x13b)][_0x3cfb95(0x156)]]||'?')+'¬∞C','calendar':_0x5ab29c+'\x20Kalender-Adapter\x20gefunden.'},_0x308db3[_0x3cfb95(0x17c)]);}catch(_0x36bb14){this['sendTo'](_0x308db3[_0x3cfb95(0x10f)],_0x308db3[_0x3cfb95(0x227)],{'success':![]},_0x308db3[_0x3cfb95(0x17c)]);}}}}}}}}}}}}}[a0_0x356552(0x129)](){const _0xa70649=a0_0x356552;if(!this['activeModules'][_0xa70649(0x21d)])return;this[_0xa70649(0x102)]['debug'](_0xa70649(0x17f));try{const _0x50133e=this[_0xa70649(0x114)]||[];pythonBridge[_0xa70649(0x135)](this,'CALCULATE_HEALTH_TREND',{'events':_0x50133e});}catch(_0x43ef47){this['log'][_0xa70649(0x15a)](_0xa70649(0xfc));}}async[a0_0x356552(0x21a)](_0x1e0639,_0x280b70){const _0x2bcb22=a0_0x356552;if(!_0x280b70||this[_0x2bcb22(0x19e)])return;if(_0x1e0639[_0x2bcb22(0xfd)](_0x2bcb22(0x136))&&_0x1e0639[_0x2bcb22(0x214)](_0x2bcb22(0x224))&&_0x280b70['val'])return;if(this[_0x2bcb22(0x13b)][_0x2bcb22(0x122)]&&_0x1e0639===this[_0x2bcb22(0x13b)][_0x2bcb22(0x1c4)]&&this['activeModules']['security']){this[_0x2bcb22(0x1f5)](_0x280b70[_0x2bcb22(0x19f)]);return;}if(_0x280b70[_0x2bcb22(0x20f)]&&_0x1e0639[_0x2bcb22(0x214)](_0x2bcb22(0x18f)))return;if(_0x1e0639===this[_0x2bcb22(0x150)]+_0x2bcb22(0x109)){if(_0x280b70[_0x2bcb22(0x19f)]&&Object[_0x2bcb22(0x250)](setup[_0x2bcb22(0x1ad)])[_0x2bcb22(0xfd)](_0x280b70['val'])){this[_0x2bcb22(0x1fe)]=_0x280b70[_0x2bcb22(0x19f)];if(_0x280b70['val']===setup[_0x2bcb22(0x1ad)]['VACATION'])await recorder[_0x2bcb22(0x20e)](this,![]);else await recorder[_0x2bcb22(0x20e)](this,!![]);if(this[_0x2bcb22(0x18c)]){let _0x366a90=![],_0x7746b=0x0,_0x24ac22=_0x2bcb22(0x21e);if(this[_0x2bcb22(0x1fe)]===_0x2bcb22(0x144))_0x366a90=!![],_0x7746b=0x168,_0x24ac22='Party\x20Mode';else this['currentSystemMode']==='guest'&&(_0x366a90=!![],_0x7746b=0x5a0,_0x24ac22=_0x2bcb22(0x13a));pythonBridge[_0x2bcb22(0x135)](this,_0x2bcb22(0x173),{'active':_0x366a90,'duration':_0x7746b,'label':_0x24ac22}),await this[_0x2bcb22(0x16f)](_0x2bcb22(0x202),{'val':JSON[_0x2bcb22(0x22e)]({'active':_0x366a90,'label':_0x24ac22,'timestamp':Date[_0x2bcb22(0xf4)]()}),'ack':!![]});}}if(!_0x280b70['ack'])this[_0x2bcb22(0x19b)](_0x1e0639,{'val':this[_0x2bcb22(0x1fe)],'ack':!![]});return;}if(_0x1e0639['endsWith'](_0x2bcb22(0x259))&&_0x280b70['ack'])this[_0x2bcb22(0xe6)](_0x280b70[_0x2bcb22(0x19f)]);if(_0x1e0639['endsWith']('analysis.energy.warmupTimes')&&_0x280b70['ack']&&this[_0x2bcb22(0x1d2)]['energy'])automation[_0x2bcb22(0x18a)](this);if(!_0x280b70[_0x2bcb22(0x20f)]){if(_0x1e0639[_0x2bcb22(0xfd)]('analysis.trigger')&&_0x280b70['val']){this[_0x2bcb22(0x19b)](_0x1e0639,{'val':![],'ack':!![]}),aiAgent[_0x2bcb22(0x1db)](this);return;}if(_0x1e0639[_0x2bcb22(0xfd)](_0x2bcb22(0x1e4))&&_0x280b70[_0x2bcb22(0x19f)]){this[_0x2bcb22(0x19b)](_0x1e0639,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x1e0639[_0x2bcb22(0xfd)](_0x2bcb22(0xf7))&&_0x280b70[_0x2bcb22(0x19f)]){this[_0x2bcb22(0x19b)](_0x1e0639,{'val':![],'ack':!![]}),aiAgent[_0x2bcb22(0x101)](this);return;}if(_0x1e0639[_0x2bcb22(0xfd)]('automation.triggerAction')&&_0x280b70[_0x2bcb22(0x19f)]){this[_0x2bcb22(0x19b)](_0x1e0639,{'val':![],'ack':!![]}),aiAgent[_0x2bcb22(0x121)](this);return;}if(_0x1e0639['includes'](_0x2bcb22(0x10b))&&_0x280b70['val']){this[_0x2bcb22(0x19b)](_0x1e0639,{'val':![],'ack':!![]});if(this[_0x2bcb22(0x18c)])try{const _0x528356=await this['getStateAsync'](_0x2bcb22(0x23d));if(_0x528356&&_0x528356[_0x2bcb22(0x19f)]){const _0x4ea5e=JSON[_0x2bcb22(0x16b)](_0x528356[_0x2bcb22(0x19f)]);this[_0x2bcb22(0x16f)](_0x2bcb22(0xe4),{'val':_0x2bcb22(0x162),'ack':!![]}),pythonBridge[_0x2bcb22(0x135)](this,_0x2bcb22(0xfe),{'sequences':_0x4ea5e});}}catch(_0x18571b){}return;}if(_0x1e0639[_0x2bcb22(0xfd)](_0x2bcb22(0x169))&&_0x280b70[_0x2bcb22(0x19f)]){this[_0x2bcb22(0x19b)](_0x1e0639,{'val':![],'ack':!![]});try{aiAgent[_0x2bcb22(0x193)](this,_0x2bcb22(0x1dd)),setTimeout(()=>aiAgent[_0x2bcb22(0x193)](this,_0x2bcb22(0x23c)),0x2ee0);if(this[_0x2bcb22(0x18c)]){this[_0x2bcb22(0x129)]();const _0x4991eb=await this[_0x2bcb22(0x1f1)](_0x2bcb22(0x147));if(_0x4991eb&&_0x4991eb['val'])pythonBridge[_0x2bcb22(0x135)](this,_0x2bcb22(0x103),{'digests':JSON[_0x2bcb22(0x16b)](_0x4991eb[_0x2bcb22(0x19f)])});}}catch(_0x1c57b7){this[_0x2bcb22(0x102)][_0x2bcb22(0x15a)](_0x2bcb22(0x1fc)+_0x1c57b7['message']);}return;}if(_0x1e0639['includes']('analysis.training.triggerEnergy')&&_0x280b70[_0x2bcb22(0x19f)]){this[_0x2bcb22(0x19b)](_0x1e0639,{'val':![],'ack':!![]}),await this[_0x2bcb22(0x21f)]();return;}if(_0x1e0639[_0x2bcb22(0xfd)](_0x2bcb22(0x256))&&_0x280b70[_0x2bcb22(0x19f)]){this[_0x2bcb22(0x19b)](_0x1e0639,{'val':![],'ack':!![]});if(this[_0x2bcb22(0x18c)])try{const _0x236f90=await this[_0x2bcb22(0x1f1)]('LTM.rawEventLog');if(_0x236f90&&_0x236f90[_0x2bcb22(0x19f)]){const _0x5807c0={};if(this[_0x2bcb22(0x13b)][_0x2bcb22(0x14e)])this[_0x2bcb22(0x13b)][_0x2bcb22(0x14e)][_0x2bcb22(0x134)](_0x15afdf=>{const _0x2748d2=_0x2bcb22;if(_0x15afdf['id']&&_0x15afdf[_0x2748d2(0x105)])_0x5807c0[_0x15afdf['id']]=_0x15afdf[_0x2748d2(0x105)];});pythonBridge[_0x2bcb22(0x135)](this,'TRAIN_COMFORT',{'events':JSON[_0x2bcb22(0x16b)](_0x236f90[_0x2bcb22(0x19f)]),'deviceMap':_0x5807c0});}}catch(_0x45faca){}return;}if(_0x1e0639[_0x2bcb22(0xfd)]('analysis.training.triggerTopology')&&_0x280b70[_0x2bcb22(0x19f)]){this['setState'](_0x1e0639,{'val':![],'ack':!![]}),topology['updateTopology'](this);if(this['isProVersion'])try{const _0x2422c7=await this[_0x2bcb22(0x1f1)](_0x2bcb22(0x23d));if(_0x2422c7&&_0x2422c7['val'])pythonBridge[_0x2bcb22(0x135)](this,_0x2bcb22(0x1cf),{'sequences':JSON[_0x2bcb22(0x16b)](_0x2422c7[_0x2bcb22(0x19f)])});}catch(_0x4d2d8f){}return;}}const _0xa00f21=(this['config']['devices']||[])[_0x2bcb22(0x21b)](_0x566959=>_0x566959['id']===_0x1e0639);if(_0xa00f21){const _0x4f2860=await recorder[_0x2bcb22(0x179)](this,_0x1e0639,_0x280b70,_0xa00f21);_0x4f2860&&this[_0x2bcb22(0x19b)](_0x2bcb22(0x11a),{'val':Date[_0x2bcb22(0xf4)](),'ack':!![]});_0x4f2860&&_0x4f2860[_0x2bcb22(0x105)]==='motion'&&_0x4f2860[_0x2bcb22(0x160)]&&this[_0x2bcb22(0x18c)]&&deadMan[_0x2bcb22(0x24d)](this,_0x4f2860['location']);_0x280b70[_0x2bcb22(0x19f)]&&(_0x280b70[_0x2bcb22(0x19f)]===!![]||_0x280b70[_0x2bcb22(0x19f)]===0x1||String(_0x280b70[_0x2bcb22(0x19f)])[_0x2bcb22(0x1c2)]()===_0x2bcb22(0x257))&&(_0xa00f21[_0x2bcb22(0x105)]&&(_0xa00f21[_0x2bcb22(0x105)]['includes']('window')||_0xa00f21[_0x2bcb22(0x105)][_0x2bcb22(0xfd)](_0x2bcb22(0x1a7)))&&this['analyzeWindowOpening'](_0xa00f21));if(_0xa00f21[_0x2bcb22(0x105)]===_0x2bcb22(0x146)||_0xa00f21[_0x2bcb22(0x105)]===_0x2bcb22(0x225)){if(this[_0x2bcb22(0x1d2)][_0x2bcb22(0x11d)])automation[_0x2bcb22(0x1a8)](this);}}}async[a0_0x356552(0xe6)](_0xd5c4d2){const _0x2d1e3e=a0_0x356552;if(!this['memoryCache']||Date['now']()-this[_0x2d1e3e(0x260)]>0x493e0)return;try{const _0x223a6c=JSON['parse'](_0xd5c4d2),_0x37b002=this[_0x2d1e3e(0x209)][_0x2d1e3e(0x1ec)];let _0x2977d6=![];for(const _0x5c17ce in _0x37b002){if(_0x37b002[_0x5c17ce][_0x2d1e3e(0xfd)]('AI')&&_0x223a6c[_0x5c17ce]&&!_0x223a6c[_0x5c17ce]['includes']('AI')){_0x2977d6=!![];break;}}_0x2977d6&&(await this['setStateAsync'](_0x2d1e3e(0x1fb),{'val':JSON['stringify'](this[_0x2d1e3e(0x209)][_0x2d1e3e(0x167)]),'ack':!![]}),await this['setStateAsync'](_0x2d1e3e(0x259),{'val':JSON['stringify'](this[_0x2d1e3e(0x209)][_0x2d1e3e(0x1ec)]),'ack':!![]}));}catch(_0x19e624){}}async[a0_0x356552(0x107)](){const _0x159254=a0_0x356552;try{const _0x455fa9=await this[_0x159254(0x1f1)](setup[_0x159254(0x230)]);if(_0x455fa9&&_0x455fa9[_0x159254(0x19f)])this[_0x159254(0x1fe)]=_0x455fa9[_0x159254(0x19f)];}catch(_0x1c408e){this[_0x159254(0x1fe)]=setup[_0x159254(0x1ad)]['NORMAL'];}}async[a0_0x356552(0x154)](){const _0x3cffb2=a0_0x356552,_0x4ba639=this['config']['presenceDevices']||[];if(_0x4ba639[_0x3cffb2(0x13c)]===0x0)return![];const _0x56c86f=[],_0x8ea7a=Date['now'](),_0x648d1e=0x5*0x3c*0x3e8;for(const _0x4c0f12 of _0x4ba639){try{let _0x1ef63c=![];try{const _0x24e3c0=await this['getForeignStateAsync'](_0x4c0f12+_0x3cffb2(0x1ce));if(_0x24e3c0&&_0x24e3c0['val']===!![])_0x1ef63c=!![];}catch(_0xdb7db8){}if(!_0x1ef63c)try{const _0x1d4458=await this[_0x3cffb2(0x1da)](_0x4c0f12+'.last_seen');if(_0x1d4458&&_0x1d4458['ts']){const _0x5cd443=_0x8ea7a-_0x1d4458['ts'];if(_0x5cd443<_0x648d1e)_0x1ef63c=!![];}}catch(_0x1da537){}if(!_0x1ef63c)try{const _0x169807=await this[_0x3cffb2(0x1da)](_0x4c0f12+_0x3cffb2(0x1a1));if(_0x169807&&typeof _0x169807[_0x3cffb2(0x19f)]===_0x3cffb2(0x218)&&_0x169807['val']>0x0)_0x1ef63c=!![];}catch(_0x1683d1){}if(!_0x1ef63c)try{const _0x17b03f=await this[_0x3cffb2(0x1da)](_0x4c0f12);if(_0x17b03f){const _0x44d89d=_0x8ea7a-(_0x17b03f['ts']||0x0);_0x44d89d<_0x648d1e&&(_0x17b03f[_0x3cffb2(0x19f)]===!![]||_0x17b03f[_0x3cffb2(0x19f)]===_0x3cffb2(0x1d0)||_0x17b03f[_0x3cffb2(0x19f)]===0x1)&&(_0x1ef63c=!![]);}}catch(_0x2d2cc1){}if(_0x1ef63c){const _0x4357b8=_0x4c0f12['split']('.'),_0x36f9cf=_0x4357b8[_0x4357b8[_0x3cffb2(0x13c)]-0x1]||_0x4c0f12;_0x56c86f[_0x3cffb2(0x1d8)](_0x36f9cf);}}catch(_0x541dad){this[_0x3cffb2(0x102)][_0x3cffb2(0x15a)](_0x3cffb2(0x15d)+_0x4c0f12+':\x20'+_0x541dad['message']);}}const _0x5a913e=_0x56c86f[_0x3cffb2(0x13c)]>0x0?_0x56c86f[_0x3cffb2(0x139)](',\x20'):'Niemand';return await this[_0x3cffb2(0x16f)](_0x3cffb2(0x152),{'val':_0x5a913e,'ack':!![]}),_0x56c86f['length']>0x0;}async[a0_0x356552(0x1e1)](){const _0x3aa3e6=a0_0x356552;await aiAgent[_0x3aa3e6(0x1db)](this);this[_0x3aa3e6(0x1d2)][_0x3aa3e6(0x21d)]&&(this[_0x3aa3e6(0x1a6)](),this[_0x3aa3e6(0x14f)]());if(this['activeModules']['energy'])this[_0x3aa3e6(0x21f)]();}async[a0_0x356552(0x1ac)](){const _0x4d2023=a0_0x356552,_0x5445f1=[_0x4d2023(0x186),_0x4d2023(0x23a),_0x4d2023(0xf8)],_0x185253=[_0x4d2023(0xe3),_0x4d2023(0x1d3),'NextHours.Location_1.Day_1.current.symbol_desc'];for(const _0xe47e3e of _0x5445f1){for(const _0x4bb1f1 of _0x185253){try{const _0x4adb63=_0xe47e3e+'.'+_0x4bb1f1,_0x10eac9=await this[_0x4d2023(0x1da)](_0x4adb63);if(_0x10eac9&&_0x10eac9['val']){const _0x50f9ec=String(_0x10eac9['val'])[_0x4d2023(0x1c2)]();if(_0x50f9ec[_0x4d2023(0xfd)](_0x4d2023(0x253))||_0x50f9ec[_0x4d2023(0xfd)]('heiter')||_0x50f9ec['includes'](_0x4d2023(0x1e7))||_0x50f9ec['includes']('sonn')||_0x50f9ec[_0x4d2023(0xfd)]('clear'))return this[_0x4d2023(0x102)][_0x4d2023(0x1e5)](_0x4d2023(0x211)+_0x4adb63),!![];}}catch(_0x2f842f){}}}return![];}[a0_0x356552(0x14f)](){const _0x57f19c=a0_0x356552;if(!this[_0x57f19c(0x18c)])return;try{this['getStateAsync'](_0x57f19c(0x23d),(_0x46695f,_0xf163b)=>{const _0x2be329=_0x57f19c;if(_0x46695f||!_0xf163b||!_0xf163b[_0x2be329(0x19f)])return;try{const _0x261f98=JSON['parse'](_0xf163b[_0x2be329(0x19f)]);if(!_0x261f98||_0x261f98[_0x2be329(0x13c)]===0x0)return;pythonBridge[_0x2be329(0x135)](this,_0x2be329(0x137),{'sequences':_0x261f98}),this['log'][_0x2be329(0x1e5)](_0x2be329(0xf2)+_0x261f98[_0x2be329(0x13c)]+_0x2be329(0x255));}catch(_0xa89c1a){this[_0x2be329(0x102)][_0x2be329(0x15a)](_0x2be329(0x18e)+_0xa89c1a['message']);}});}catch(_0x25dfdb){this[_0x57f19c(0x102)][_0x57f19c(0x15a)]('triggerGaitAnalysis\x20error:\x20'+_0x25dfdb[_0x57f19c(0x116)]);}}async['triggerEnergyPrediction'](){const _0x2677bd=a0_0x356552;if(!this['isProVersion']||!this[_0x2677bd(0x1d2)]['energy'])return;try{const _0x209d4c={},_0x3e024c={},_0x570873=this['config']['devices']||[];for(const _0x48ffb4 of _0x570873){if((_0x48ffb4[_0x2677bd(0x105)]==='temperature'||_0x48ffb4['type']===_0x2677bd(0x225))&&_0x48ffb4[_0x2677bd(0x160)])try{const _0x224dd7=await this[_0x2677bd(0x1da)](_0x48ffb4['id']);_0x224dd7&&typeof _0x224dd7[_0x2677bd(0x19f)]==='number'&&(_0x209d4c[_0x48ffb4[_0x2677bd(0x160)]]=_0x224dd7[_0x2677bd(0x19f)],_0x3e024c[_0x48ffb4[_0x2677bd(0x160)]]=_0x48ffb4[_0x2677bd(0x125)]||![]);}catch(_0x2e626c){}}let _0x2cf922=0xa;if(this['config'][_0x2677bd(0x1d4)])try{const _0x3168cf=await this[_0x2677bd(0x1da)](this[_0x2677bd(0x13b)][_0x2677bd(0x1d4)]);if(_0x3168cf&&typeof _0x3168cf['val']===_0x2677bd(0x218))_0x2cf922=_0x3168cf[_0x2677bd(0x19f)];}catch(_0x1b9f67){}const _0x192445=await this[_0x2677bd(0x1ac)]();let _0x4511a6={};try{const _0x1fc9fc=await this['getStateAsync'](_0x2677bd(0x1c1));if(_0x1fc9fc&&_0x1fc9fc[_0x2677bd(0x19f)])_0x4511a6=JSON[_0x2677bd(0x16b)](_0x1fc9fc[_0x2677bd(0x19f)]);}catch(_0x18614b){}pythonBridge[_0x2677bd(0x135)](this,_0x2677bd(0x118),{'current_temps':_0x209d4c,'t_out':_0x2cf922,'is_sunny':_0x192445,'solar_flags':_0x3e024c,'warmup_targets':_0x4511a6}),this[_0x2677bd(0x102)][_0x2677bd(0xe2)](_0x2677bd(0x176)+Object[_0x2677bd(0x124)](_0x209d4c)[_0x2677bd(0x13c)]+_0x2677bd(0x222));}catch(_0x35ba16){this[_0x2677bd(0x102)][_0x2677bd(0x15a)](_0x2677bd(0x11c)+_0x35ba16[_0x2677bd(0x116)]);}}[a0_0x356552(0x1a6)](){const _0x1fdad8=a0_0x356552;if(!this[_0x1fdad8(0x114)]||this[_0x1fdad8(0x114)][_0x1fdad8(0x13c)]===0x0)return;const _0x3dd651=new Array(0x30)[_0x1fdad8(0x123)](0x0),_0x367f31=Array[_0x1fdad8(0x10f)]({'length':0x30},()=>[]),_0x59ceac=new Date()[_0x1fdad8(0x159)](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x1fdad8(0x134)](_0x3adff3=>{const _0x320e46=_0x1fdad8,_0x2c3982=new Date(_0x3adff3['timestamp']);if(_0x2c3982[_0x320e46(0x187)]()>=_0x59ceac){const _0x492f17=_0x2c3982[_0x320e46(0x1f7)](),_0x58c826=_0x2c3982['getMinutes'](),_0x2a97c2=_0x492f17*0x2+Math['floor'](_0x58c826/0x1e);_0x2a97c2>=0x0&&_0x2a97c2<0x30&&(_0x3dd651[_0x2a97c2]++,_0x367f31[_0x2a97c2][_0x320e46(0x1d8)]({'time':_0x2c3982[_0x320e46(0x1fa)](_0x320e46(0x1a0),{'hour':_0x320e46(0x174),'minute':_0x320e46(0x174)}),'location':_0x3adff3['location']||_0x320e46(0x247),'type':_0x3adff3[_0x320e46(0x105)]||_0x320e46(0x1c7)}));}}),this[_0x1fdad8(0x16f)](_0x1fdad8(0x157),{'val':JSON['stringify'](_0x3dd651),'ack':!![]}),this[_0x1fdad8(0x16f)]('analysis.health.todayRoomDetails',{'val':JSON[_0x1fdad8(0x22e)](_0x367f31),'ack':!![]});}async[a0_0x356552(0x1f5)](_0x5e845e){const _0x3b92f4=a0_0x356552;if(!this[_0x3b92f4(0x13b)][_0x3b92f4(0x122)]||typeof _0x5e845e!==_0x3b92f4(0x218))return;const _0x156f2b=this[_0x3b92f4(0x13b)][_0x3b92f4(0x1bb)]||0.04;this['pressureBuffer']['push']({'timestamp':Date[_0x3b92f4(0xf4)](),'value':_0x5e845e}),this[_0x3b92f4(0x1d1)][_0x3b92f4(0x13c)]>0x64&&this[_0x3b92f4(0x1d1)][_0x3b92f4(0x1de)](),_0x5e845e>_0x156f2b&&!this['infrasoundLocked']&&(this[_0x3b92f4(0xea)]=!![],this[_0x3b92f4(0x102)][_0x3b92f4(0x15a)]('üîä\x20Infraschall-Alarm:\x20'+_0x5e845e[_0x3b92f4(0x252)](0x4)+_0x3b92f4(0x1a9)+_0x156f2b+'\x20(Threshold)'),await this[_0x3b92f4(0xf9)](_0x5e845e,_0x3b92f4(0x22c)),setTimeout(()=>{const _0x2e221b=_0x3b92f4;this[_0x2e221b(0xea)]=![];},0x5*0x3c*0x3e8));}async['triggerInfrasoundCorrelation'](_0x5199b7,_0x4ca667){const _0x52d788=a0_0x356552;if(!this[_0x52d788(0x188)]){const _0x3bde34=this[_0x52d788(0x1a3)][_0x52d788(0x24a)](0x0,0xa),_0x1f52b9=_0x3bde34['map'](_0x399d17=>new Date(_0x399d17[_0x52d788(0x1bd)])[_0x52d788(0x1fa)]('de-DE')+_0x52d788(0x11f)+(_0x399d17[_0x52d788(0x160)]||_0x52d788(0x15e))+':\x20'+_0x399d17['name'])['join']('\x0a');this['log'][_0x52d788(0x15a)](_0x52d788(0x217)+_0x5199b7[_0x52d788(0x252)](0x4)+_0x52d788(0x24f)+_0x1f52b9);if(this[_0x52d788(0x13b)]['infrasoundArmingId'])try{const _0x2cc52f=await this['getForeignStateAsync'](this[_0x52d788(0x13b)][_0x52d788(0xf1)]);_0x2cc52f&&_0x2cc52f['val']===!![]&&(await this[_0x52d788(0x16f)](_0x52d788(0x1b3),{'val':JSON[_0x52d788(0x22e)]({'timestamp':Date['now'](),'pressure':_0x5199b7[_0x52d788(0x252)](0x4),'eventType':_0x4ca667,'recentEvents':_0x3bde34['slice'](0x0,0x3)}),'ack':!![]}),this[_0x52d788(0x102)]['error'](_0x52d788(0x242)));}catch(_0x5e84b4){}}else this[_0x52d788(0x102)][_0x52d788(0x1e5)](_0x52d788(0x145)+_0x5199b7[_0x52d788(0x252)](0x4)+_0x52d788(0xfb));}async['analyzeWindowOpening'](_0x22dda0){const _0x1e9fbd=a0_0x356552;if(!_0x22dda0||!_0x22dda0['location'])return;try{const _0x342ad6=(this['config'][_0x1e9fbd(0x14e)]||[])[_0x1e9fbd(0x221)](_0x39a016=>_0x39a016['location']===_0x22dda0['location']&&(_0x39a016[_0x1e9fbd(0x105)]===_0x1e9fbd(0x146)||_0x39a016[_0x1e9fbd(0x105)]===_0x1e9fbd(0x225)));if(_0x342ad6[_0x1e9fbd(0x13c)]===0x0)return;const _0x45646f=await this[_0x1e9fbd(0x1da)](_0x342ad6[0x0]['id']);if(!_0x45646f||typeof _0x45646f[_0x1e9fbd(0x19f)]!==_0x1e9fbd(0x218))return;const _0x2ec746=_0x45646f['val'];let _0x769a33=null;if(this[_0x1e9fbd(0x13b)][_0x1e9fbd(0x1d4)]){const _0x1d5262=await this[_0x1e9fbd(0x1da)](this['config']['weatherTempId']);_0x1d5262&&typeof _0x1d5262['val']===_0x1e9fbd(0x218)&&(_0x769a33=_0x1d5262[_0x1e9fbd(0x19f)]);}if(_0x769a33!==null){const _0x39f56d=Math[_0x1e9fbd(0x1fd)](_0x2ec746-_0x769a33);_0x39f56d>0x3&&(this[_0x1e9fbd(0x102)][_0x1e9fbd(0x1e5)](_0x1e9fbd(0x25c)+_0x22dda0['location']+':\x20Temp-Differenz\x20'+_0x39f56d[_0x1e9fbd(0x252)](0x1)+_0x1e9fbd(0x1b7)+_0x2ec746+_0x1e9fbd(0x213)+_0x769a33+_0x1e9fbd(0x127)),await this[_0x1e9fbd(0x16f)](_0x1e9fbd(0x20a),{'val':JSON['stringify']({'room':_0x22dda0[_0x1e9fbd(0x160)],'timestamp':Date[_0x1e9fbd(0xf4)](),'tempDiff':_0x39f56d[_0x1e9fbd(0x252)](0x1),'recommendation':_0x39f56d>0x5?_0x1e9fbd(0x246):_0x1e9fbd(0x192)}),'ack':!![]}));}}catch(_0x5df9c4){this['log']['warn']('analyzeWindowOpening\x20error:\x20'+_0x5df9c4[_0x1e9fbd(0x116)]);}}async[a0_0x356552(0x17e)](_0x17c736){const _0x3cf2bc=a0_0x356552;if(!_0x17c736||typeof _0x17c736!==_0x3cf2bc(0x1b5))return;const _0x3e347e={'timestamp':_0x17c736[_0x3cf2bc(0x1bd)]||Date[_0x3cf2bc(0xf4)](),'id':_0x17c736['id']||Date[_0x3cf2bc(0xf4)]()[_0x3cf2bc(0x153)](),'name':_0x17c736['name']||_0x3cf2bc(0x1bf),'type':_0x17c736['type']||_0x3cf2bc(0x261),'location':_0x17c736['location']||_0x3cf2bc(0x15e),'value':_0x17c736[_0x3cf2bc(0x1b9)]||null};this[_0x3cf2bc(0x1a3)][_0x3cf2bc(0x223)](_0x3e347e);if(this[_0x3cf2bc(0x1a3)][_0x3cf2bc(0x13c)]>0x1388)this[_0x3cf2bc(0x1a3)][_0x3cf2bc(0x1f4)]();await this[_0x3cf2bc(0x16f)]('events.history',{'val':JSON[_0x3cf2bc(0x22e)](this[_0x3cf2bc(0x1a3)]),'ack':!![]}),this[_0x3cf2bc(0x102)][_0x3cf2bc(0x1e5)](_0x3cf2bc(0x23b)+_0x3e347e[_0x3cf2bc(0x12e)]+'\x20('+_0x3e347e[_0x3cf2bc(0x160)]+')');}[a0_0x356552(0x23e)](_0x386b35){}}if(require['main']!==module)module[a0_0x356552(0xef)]=_0x552340=>new CogniLiving(_0x552340);else new CogniLiving();