const a0_0x43e425=a0_0xcd11;(function(_0x51bb37,_0x1f289e){const _0x30da34=a0_0xcd11,_0x12121f=_0x51bb37();while(!![]){try{const _0x414cbd=parseInt(_0x30da34(0x1aa))/0x1+-parseInt(_0x30da34(0x348))/0x2*(-parseInt(_0x30da34(0x313))/0x3)+parseInt(_0x30da34(0x262))/0x4+-parseInt(_0x30da34(0x22c))/0x5+parseInt(_0x30da34(0x217))/0x6*(-parseInt(_0x30da34(0x2a4))/0x7)+-parseInt(_0x30da34(0x1a4))/0x8*(parseInt(_0x30da34(0x2d2))/0x9)+-parseInt(_0x30da34(0x329))/0xa*(-parseInt(_0x30da34(0x263))/0xb);if(_0x414cbd===_0x1f289e)break;else _0x12121f['push'](_0x12121f['shift']());}catch(_0x1e9420){_0x12121f['push'](_0x12121f['shift']());}}}(a0_0x4020,0x89825));const a0_0x4ccd32=(function(){let _0x2eb2df=!![];return function(_0x46d29f,_0xfbb407){const _0x1bf4d9=_0x2eb2df?function(){const _0x4059d6=a0_0xcd11;if(_0xfbb407){const _0x51927f=_0xfbb407[_0x4059d6(0x19b)](_0x46d29f,arguments);return _0xfbb407=null,_0x51927f;}}:function(){};return _0x2eb2df=![],_0x1bf4d9;};}()),a0_0x1dd38d=a0_0x4ccd32(this,function(){const _0x207bf5=a0_0xcd11;return a0_0x1dd38d['toString']()[_0x207bf5(0x273)](_0x207bf5(0x33f))['toString']()[_0x207bf5(0x1ba)](a0_0x1dd38d)[_0x207bf5(0x273)](_0x207bf5(0x33f));});a0_0x1dd38d();'use strict';const utils=require(a0_0x43e425(0x197)),{GoogleGenerativeAI}=require(a0_0x43e425(0x33c)),schedule=require(a0_0x43e425(0x32f)),{spawn,exec}=require(a0_0x43e425(0x2d7)),path=require(a0_0x43e425(0x29d)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x43e425(0x211),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x43e425(0x200),LTM_DP_DAILY_DIGESTS=a0_0x43e425(0x284),LTM_DP_STATUS=a0_0x43e425(0x2e1),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x43e425(0x3a3),LTM_DP_DRIFT_CHANNEL=a0_0x43e425(0x24f),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x43e425(0x390),LTM_DP_DRIFT_LAST_CHECK=a0_0x43e425(0x24a),SYSTEM_DP_MODE=a0_0x43e425(0x36a),HARD_IGNORE_TERMS=[a0_0x43e425(0x3a6),'scriptEnabled',a0_0x43e425(0x362),a0_0x43e425(0x36d),a0_0x43e425(0x380),a0_0x43e425(0x3b9),a0_0x43e425(0x219),a0_0x43e425(0x3a2),a0_0x43e425(0x2ca),a0_0x43e425(0x20c),a0_0x43e425(0x2fc),'direction',a0_0x43e425(0x1b1),a0_0x43e425(0x3b7),a0_0x43e425(0x30d),a0_0x43e425(0x289),a0_0x43e425(0x3cd),a0_0x43e425(0x31f)],BAD_NAMES=[a0_0x43e425(0x3c8),a0_0x43e425(0x240),a0_0x43e425(0x369),a0_0x43e425(0x3d0),'value',a0_0x43e425(0x294),'on',a0_0x43e425(0x349),a0_0x43e425(0x2d4),a0_0x43e425(0x304),a0_0x43e425(0x1d5),a0_0x43e425(0x1f9),a0_0x43e425(0x306),a0_0x43e425(0x324),'motion',a0_0x43e425(0x293),a0_0x43e425(0x396),'temperature',a0_0x43e425(0x3ba),'power',a0_0x43e425(0x330),a0_0x43e425(0x2d6),a0_0x43e425(0x2a7),a0_0x43e425(0x30a),'set_temperature'],ADAPTER_BLACKLIST=['system.','admin.','info.',a0_0x43e425(0x212),'history.','material.',a0_0x43e425(0x338),a0_0x43e425(0x2bf),a0_0x43e425(0x31a),a0_0x43e425(0x377),a0_0x43e425(0x2f1)],SYSTEM_MODES={'NORMAL':a0_0x43e425(0x288),'VACATION':a0_0x43e425(0x3b3),'PARTY':'party','GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x43e425(0x1f3)],SYSTEM_MODES[a0_0x43e425(0x2ff)]],PERSONA_MAPPING={'generic':a0_0x43e425(0x2a0),'senior_aal':a0_0x43e425(0x2a9),'family':a0_0x43e425(0x38e),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x43e425(0x209)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process['platform']===a0_0x43e425(0x2f0),VENV_PATH=path[a0_0x43e425(0x2c9)](__dirname,a0_0x43e425(0x373)),PYTHON_EXE=IS_WIN?path[a0_0x43e425(0x2c9)](VENV_PATH,'Scripts','python.exe'):path[a0_0x43e425(0x2c9)](VENV_PATH,'bin',a0_0x43e425(0x253)),PIP_EXE=IS_WIN?path[a0_0x43e425(0x2c9)](VENV_PATH,a0_0x43e425(0x1dd),a0_0x43e425(0x21d)):path[a0_0x43e425(0x2c9)](VENV_PATH,a0_0x43e425(0x26d),a0_0x43e425(0x2d8));let activeSequence=[],sequenceTimer=null;async function initZombies(_0x5cb6fb){const _0x68a285=a0_0x43e425;try{const _0x422b4a=['analysis.history_debug_00',_0x68a285(0x3c1)];for(const _0x20d611 of _0x422b4a){try{const _0x39cff1=await _0x5cb6fb['getObjectAsync'](_0x20d611);_0x39cff1&&await _0x5cb6fb[_0x68a285(0x26f)](_0x20d611);}catch(_0x4aa403){}}}catch(_0x11314f){}}async function initHistory(_0x3e342f){const _0x1b12f1=a0_0x43e425;try{const _0x621970=await _0x3e342f[_0x1b12f1(0x34e)](_0x1b12f1(0x26a));_0x621970&&_0x621970[_0x1b12f1(0x28e)]&&(_0x3e342f['eventHistory']=JSON['parse'](_0x621970[_0x1b12f1(0x28e)][_0x1b12f1(0x2a8)]()));}catch(_0x52e62b){_0x3e342f[_0x1b12f1(0x35b)]=[];}try{const _0x257dfe=await _0x3e342f[_0x1b12f1(0x34e)]('analysis.analysisHistory');if(_0x257dfe&&_0x257dfe[_0x1b12f1(0x28e)])_0x3e342f[_0x1b12f1(0x399)]=JSON['parse'](_0x257dfe[_0x1b12f1(0x28e)][_0x1b12f1(0x2a8)]());}catch(_0x3c8595){_0x3e342f[_0x1b12f1(0x399)]=[];}if(_0x3e342f[_0x1b12f1(0x35b)]&&_0x3e342f['eventHistory']['length']>0x0){_0x3e342f[_0x1b12f1(0x20e)]['info'](_0x1b12f1(0x20d)+_0x3e342f[_0x1b12f1(0x35b)][_0x1b12f1(0x36f)]+_0x1b12f1(0x223));for(let _0x2fcf14=_0x3e342f['eventHistory'][_0x1b12f1(0x36f)]-0x1;_0x2fcf14>=0x0;_0x2fcf14--){const _0x3c10ed=_0x3e342f[_0x1b12f1(0x35b)][_0x2fcf14];_0x3c10ed&&_0x3c10ed['id']!==undefined&&_0x3c10ed[_0x1b12f1(0x28a)]!==undefined&&(_0x3e342f[_0x1b12f1(0x312)][_0x3c10ed['id']]=_0x3c10ed[_0x1b12f1(0x28a)]);}}}async function initSystemConfig(_0x120d13){const _0x3a5a3e=a0_0x43e425;try{const _0x4e6de1=await _0x120d13[_0x3a5a3e(0x1f1)](_0x3a5a3e(0x31c));_0x4e6de1&&_0x4e6de1[_0x3a5a3e(0x238)]&&(_0x120d13[_0x3a5a3e(0x2ed)]={'latitude':_0x4e6de1[_0x3a5a3e(0x238)][_0x3a5a3e(0x1a9)]||0x0,'longitude':_0x4e6de1['common']['longitude']||0x0,'city':_0x4e6de1['common']['city']||''});}catch(_0xbc9203){}}async function checkLicense(_0x3e8419,_0x5ce2e7){const _0x508026=a0_0x43e425;if(!_0x5ce2e7)return![];_0x3e8419[_0x508026(0x243)]=await getSystemUUID(_0x3e8419);if(_0x5ce2e7===_0x508026(0x2f2)||_0x5ce2e7['startsWith'](_0x508026(0x397)))return!![];return![];}async function getSystemUUID(_0x1b5cf4){const _0x12f97b=a0_0x43e425;try{const _0x2cdc79=await _0x1b5cf4[_0x12f97b(0x1f1)](_0x12f97b(0x187));if(_0x2cdc79&&_0x2cdc79[_0x12f97b(0x2b3)]&&_0x2cdc79['native'][_0x12f97b(0x31d)])return _0x2cdc79['native'][_0x12f97b(0x31d)];return _0x12f97b(0x2ee);}catch(_0x54ea7a){return _0x12f97b(0x1fd);}}async function createAllObjects(_0x2c8fd2){const _0x54951c=a0_0x43e425;await checkSystemObjects(_0x2c8fd2),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x18f),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x2e3),'type':_0x54951c(0x336),'role':_0x54951c(0x3bf),'read':!![],'write':![],'def':''},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x321),{'type':'state','common':{'name':'Last\x20raw\x20event','type':_0x54951c(0x336),'role':_0x54951c(0x1a7),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)]('events.history',{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x3a1),'type':'string','role':_0x54951c(0x1a7),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x3ab),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x309),'type':_0x54951c(0x1c9),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)]('analysis.triggerBriefing',{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x290),'type':_0x54951c(0x1c9),'role':_0x54951c(0x1d9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1b3)](_0x54951c(0x2cf),{'type':'channel','common':{'name':'AI\x20Training\x20Control'},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x249),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x39c),'type':_0x54951c(0x1c9),'role':_0x54951c(0x1d9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x2cd),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x395),'type':_0x54951c(0x1c9),'role':_0x54951c(0x1d9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x36c),{'type':'state','common':{'name':'Train\x20Energy\x20Model\x20(Regression)','type':_0x54951c(0x1c9),'role':_0x54951c(0x1d9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x2e5),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x23a),'type':_0x54951c(0x336),'role':_0x54951c(0x3bf),'read':!![],'write':![],'def':'Idle'},'native':{}}),await _0x2c8fd2[_0x54951c(0x1b3)]('analysis.security',{'type':_0x54951c(0x255),'common':{'name':'Live\x20Security\x20Monitor'},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x193),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x1ef),'type':_0x54951c(0x27f),'role':_0x54951c(0x28a),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x1eb),{'type':'state','common':{'name':_0x54951c(0x379),'type':'string','role':_0x54951c(0x199),'read':!![],'write':![],'def':''},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x2b1),{'type':'state','common':{'name':_0x54951c(0x241),'type':'string','role':_0x54951c(0x199),'read':!![],'write':![],'def':''},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x3a4),{'type':'state','common':{'name':'Health\x20Anomaly\x20Detected','type':_0x54951c(0x1c9),'role':'indicator.health','read':!![],'write':![],'def':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1b3)]('analysis.energy',{'type':'channel','common':{'name':_0x54951c(0x1fa)},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)]('analysis.energy.insulationScore',{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x392),'type':_0x54951c(0x336),'role':'text','read':!![],'write':![],'def':_0x54951c(0x1f7)},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x1bd),{'type':_0x54951c(0x369),'common':{'name':'Heating\x20Rate\x20Score','type':_0x54951c(0x336),'role':_0x54951c(0x3bf),'read':!![],'write':![],'def':_0x54951c(0x1f7)},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x1ac),{'type':_0x54951c(0x369),'common':{'name':'Last\x20Result','type':_0x54951c(0x336),'role':_0x54951c(0x1a7),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x3b8),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x30e),'type':_0x54951c(0x1c9),'role':_0x54951c(0x18d),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x1b0),{'type':'state','common':{'name':_0x54951c(0x354),'type':_0x54951c(0x1c9),'role':_0x54951c(0x271),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x18e),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x3ae),'type':_0x54951c(0x336),'role':_0x54951c(0x2f9),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x1e4),{'type':_0x54951c(0x369),'common':{'name':'Activity\x20Summary','type':_0x54951c(0x336),'role':_0x54951c(0x3bf),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x233),{'type':'state','common':{'name':_0x54951c(0x1c7),'type':_0x54951c(0x336),'role':_0x54951c(0x369),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x334),{'type':'state','common':{'name':_0x54951c(0x2fe),'type':_0x54951c(0x336),'role':'text','read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)]('analysis.comfortSuggestion',{'type':_0x54951c(0x369),'common':{'name':'Comfort\x20Suggestion','type':_0x54951c(0x336),'role':_0x54951c(0x3bf),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1b3)]('analysis.automation',{'type':_0x54951c(0x255),'common':{'name':_0x54951c(0x1f6)},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)]('analysis.automation.patternDetected',{'type':_0x54951c(0x369),'common':{'name':'Pattern\x20Detected','type':_0x54951c(0x1c9),'role':_0x54951c(0x225),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x3c2),{'type':_0x54951c(0x369),'common':{'name':'Description','type':'string','role':_0x54951c(0x3bf),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x3ce),{'type':'state','common':{'name':_0x54951c(0x2ef),'type':_0x54951c(0x336),'role':_0x54951c(0x3bf),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x2e9),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x1c6),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x252),{'type':'state','common':{'name':_0x54951c(0x2fb),'type':_0x54951c(0x336),'role':_0x54951c(0x3bf),'read':!![],'write':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x1e5),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x292),'type':_0x54951c(0x1c9),'role':_0x54951c(0x2d4),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)]('analysis.automation.triggerAction',{'type':'state','common':{'name':'Trigger\x20Action\x20Now','type':_0x54951c(0x1c9),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x1e0),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x381),'type':_0x54951c(0x336),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x1a1),{'type':'state','common':{'name':_0x54951c(0x277),'type':_0x54951c(0x336),'role':_0x54951c(0x1a7),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2c8fd2[_0x54951c(0x1b3)](_0x54951c(0x2b6),{'type':_0x54951c(0x255),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x345),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x27d),'type':_0x54951c(0x27f),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x296),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x1ea),'type':_0x54951c(0x336),'role':_0x54951c(0x3bf),'read':!![],'write':![],'def':_0x54951c(0x37d)},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x268),{'type':'state','common':{'name':_0x54951c(0x3c5),'type':'string','role':'text','read':!![],'write':![],'def':''},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)]('analysis.health.trendDiagnosis',{'type':_0x54951c(0x369),'common':{'name':'Trend\x20Diagnosis\x20(Python)','type':'string','role':_0x54951c(0x3bf),'read':!![],'write':![],'def':_0x54951c(0x1f7)},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x1c5),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x31b),'type':_0x54951c(0x27f),'role':_0x54951c(0x28a),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x2c8fd2[_0x54951c(0x1b3)](_0x54951c(0x18a),{'type':_0x54951c(0x255),'common':{'name':'Training\x20Data\x20Sets'},'native':{}}),await _0x2c8fd2[_0x54951c(0x1de)](_0x54951c(0x37f),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x342),'type':_0x54951c(0x336),'role':_0x54951c(0x1a7),'read':!![],'write':![],'def':'[]','desc':'Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training'},'native':{}}),await _0x2c8fd2['setObjectNotExistsAsync'](_0x54951c(0x31e),{'type':_0x54951c(0x369),'common':{'name':_0x54951c(0x30c),'type':_0x54951c(0x336),'role':'json','read':!![],'write':![],'def':'[]','desc':'Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time'},'native':{}}),await checkLtmObjects(_0x2c8fd2),await checkLtmDriftObjects(_0x2c8fd2);}async function checkSystemObjects(_0xb281b0){const _0x5d331d=a0_0x43e425;await _0xb281b0['extendObjectAsync'](_0x5d331d(0x247),{'type':_0x5d331d(0x255),'common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0xb281b0[_0x5d331d(0x1b3)](SYSTEM_DP_MODE,{'type':_0x5d331d(0x369),'common':{'name':'System\x20Mode','type':'string','role':_0x5d331d(0x369),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x5d331d(0x24c)]]:_0x5d331d(0x319),[SYSTEM_MODES[_0x5d331d(0x1ee)]]:_0x5d331d(0x33a),[SYSTEM_MODES[_0x5d331d(0x1f3)]]:_0x5d331d(0x192),[SYSTEM_MODES[_0x5d331d(0x2ff)]]:_0x5d331d(0x398)}},'native':{}});}async function checkLtmObjects(_0x5b8ee0){const _0x2ebf32=a0_0x43e425;await _0x5b8ee0[_0x2ebf32(0x1b3)](_0x2ebf32(0x394),{'type':_0x2ebf32(0x255),'common':{'name':_0x2ebf32(0x394)},'native':{}}),await _0x5b8ee0['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x2ebf32(0x369),'common':{'name':'Raw\x20Log','type':_0x2ebf32(0x336),'role':'json','read':!![],'write':![]},'native':{}}),await _0x5b8ee0[_0x2ebf32(0x1b3)](LTM_DP_DAILY_DIGESTS,{'type':_0x2ebf32(0x369),'common':{'name':_0x2ebf32(0x1d2),'type':'string','role':_0x2ebf32(0x1a7),'read':!![],'write':![]},'native':{}}),await _0x5b8ee0[_0x2ebf32(0x1b3)](LTM_DP_STATUS,{'type':_0x2ebf32(0x369),'common':{'name':'Processing\x20Status','type':_0x2ebf32(0x336),'role':_0x2ebf32(0x3bf),'read':!![],'write':![]},'native':{}}),await _0x5b8ee0['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x2ebf32(0x369),'common':{'name':_0x2ebf32(0x35a),'type':_0x2ebf32(0x1c9),'role':_0x2ebf32(0x1d9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5b8ee0['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x2ebf32(0x369),'common':{'name':_0x2ebf32(0x2fa),'type':_0x2ebf32(0x336),'role':_0x2ebf32(0x3bf),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x3d9c47){const _0x4e30d0=a0_0x43e425;await _0x3d9c47[_0x4e30d0(0x1b3)](LTM_DP_DRIFT_CHANNEL,{'type':_0x4e30d0(0x255),'common':{'name':_0x4e30d0(0x2f7)},'native':{}}),await _0x3d9c47['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x4e30d0(0x369),'common':{'name':_0x4e30d0(0x2f5),'type':_0x4e30d0(0x336),'role':_0x4e30d0(0x369),'read':!![],'write':![],'def':_0x4e30d0(0x1f7)},'native':{}}),await _0x3d9c47[_0x4e30d0(0x1b3)](LTM_DP_DRIFT_DETAILS,{'type':_0x4e30d0(0x369),'common':{'name':_0x4e30d0(0x221),'type':_0x4e30d0(0x336),'role':_0x4e30d0(0x3bf),'read':!![],'write':![]},'native':{}}),await _0x3d9c47[_0x4e30d0(0x1b3)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x4e30d0(0x369),'common':{'name':_0x4e30d0(0x38f),'type':'number','role':_0x4e30d0(0x199),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x308fec){const _0x40cb4e=a0_0x43e425;try{const _0x37f54d=await _0x308fec[_0x40cb4e(0x34e)](SYSTEM_DP_MODE);_0x37f54d&&_0x37f54d[_0x40cb4e(0x28e)]&&Object[_0x40cb4e(0x272)](SYSTEM_MODES)['includes'](_0x37f54d[_0x40cb4e(0x28e)])?_0x308fec['currentSystemMode']=_0x37f54d['val']:(_0x308fec[_0x40cb4e(0x21a)]=SYSTEM_MODES[_0x40cb4e(0x24c)],await _0x308fec[_0x40cb4e(0x2c7)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x388e9c){_0x308fec[_0x40cb4e(0x21a)]=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x1aa6ab){const _0x31aca9=a0_0x43e425;try{const _0x313bf5=await _0x1aa6ab[_0x31aca9(0x34e)](LTM_DP_RAW_LOG);if(_0x313bf5&&_0x313bf5[_0x31aca9(0x28e)])_0x1aa6ab[_0x31aca9(0x297)]=JSON[_0x31aca9(0x227)](_0x313bf5[_0x31aca9(0x28e)]);}catch(_0x584974){_0x1aa6ab[_0x31aca9(0x297)]=[];}}async function saveRawEventLog(_0x4c0434){const _0x438132=a0_0x43e425;_0x4c0434[_0x438132(0x297)][_0x438132(0x36f)]>RAW_LOG_MAX_SIZE&&_0x4c0434[_0x438132(0x297)]['splice'](0x0,_0x4c0434[_0x438132(0x297)]['length']-RAW_LOG_MAX_SIZE),await _0x4c0434[_0x438132(0x2c7)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x4c0434[_0x438132(0x297)]),'ack':!![]});}async function loadDailyDigests(_0x226a21){const _0x52cc42=a0_0x43e425;try{const _0x469a9d=await _0x226a21[_0x52cc42(0x34e)](LTM_DP_DAILY_DIGESTS);if(_0x469a9d&&_0x469a9d[_0x52cc42(0x28e)])_0x226a21[_0x52cc42(0x259)]=JSON[_0x52cc42(0x227)](_0x469a9d[_0x52cc42(0x28e)]);}catch(_0x240c5d){_0x226a21[_0x52cc42(0x259)]=[];}await updateBaselineStatus(_0x226a21);}async function saveDailyDigests(_0xeaff92,_0x1e8f75=!![]){const _0x1377f2=a0_0x43e425,_0x43bd56=_0xeaff92['config'][_0x1377f2(0x285)]||0x3c;_0xeaff92['dailyDigests'][_0x1377f2(0x36f)]>_0x43bd56&&_0xeaff92['dailyDigests']['splice'](0x0,_0xeaff92[_0x1377f2(0x259)][_0x1377f2(0x36f)]-_0x43bd56);await _0xeaff92['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1377f2(0x23c)](_0xeaff92[_0x1377f2(0x259)]),'ack':!![]});if(_0x1e8f75)await updateBaselineStatus(_0xeaff92);}async function updateAnalysisHistory(_0x338d48,_0x1699c0){const _0x268c72=a0_0x43e425;_0x338d48[_0x268c72(0x399)][_0x268c72(0x326)](_0x1699c0);if(_0x338d48['analysisHistory'][_0x268c72(0x36f)]>ANALYSIS_HISTORY_MAX_SIZE)_0x338d48['analysisHistory'][_0x268c72(0x363)]();await _0x338d48[_0x268c72(0x2c7)](_0x268c72(0x1e0),{'val':JSON[_0x268c72(0x23c)](_0x338d48['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x4199d7){const _0x23be7d=a0_0x43e425;if(!_0x4199d7['isProVersion']){await _0x4199d7[_0x23be7d(0x2c7)](LTM_DP_BASELINE_STATUS,{'val':_0x23be7d(0x3bd),'ack':!![]});return;}const _0x223bb1=_0x4199d7[_0x23be7d(0x259)]['length']>=(_0x4199d7[_0x23be7d(0x278)][_0x23be7d(0x1b8)]||0x7)?_0x23be7d(0x3c4)+_0x4199d7['dailyDigests'][_0x23be7d(0x36f)]+_0x23be7d(0x23e):_0x23be7d(0x2cc)+_0x4199d7[_0x23be7d(0x259)][_0x23be7d(0x36f)]+'/'+(_0x4199d7[_0x23be7d(0x278)][_0x23be7d(0x1b8)]||0x7)+')';await _0x4199d7['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x223bb1,'ack':!![]});}async function initSensorSubscriptions(_0x4e7532){const _0x368e4c=a0_0x43e425,_0x43923c=_0x4e7532[_0x368e4c(0x278)][_0x368e4c(0x2f6)];if(_0x43923c&&_0x43923c['length']>0x0){_0x4e7532[_0x368e4c(0x20e)][_0x368e4c(0x237)]('Subscribing\x20to\x20'+_0x43923c[_0x368e4c(0x36f)]+_0x368e4c(0x224));for(const _0x195dca of _0x43923c){if(_0x195dca['id']){await _0x4e7532[_0x368e4c(0x287)](_0x195dca['id']);try{const _0x71d77d=await _0x4e7532[_0x368e4c(0x21c)](_0x195dca['id']);if(_0x71d77d)_0x4e7532[_0x368e4c(0x312)][_0x195dca['id']]=_0x71d77d[_0x368e4c(0x28e)];}catch(_0x19e932){}}}}}async function initPresenceSubscriptions(_0x2a1602){const _0x2b5f42=a0_0x43e425,_0x311ae2=_0x2a1602['config'][_0x2b5f42(0x371)]||[];if(_0x311ae2[_0x2b5f42(0x36f)]>0x0){_0x2a1602['log'][_0x2b5f42(0x237)](_0x2b5f42(0x19f)+_0x311ae2[_0x2b5f42(0x36f)]+_0x2b5f42(0x3c3));for(const _0x16796c of _0x311ae2){await _0x2a1602[_0x2b5f42(0x287)](_0x16796c);}try{await checkWifiPresence(_0x2a1602);}catch(_0x3bf90f){}}}async function getWeatherContext(_0xa880bf){const _0x22023a=a0_0x43e425;try{if(!_0xa880bf[_0x22023a(0x278)][_0x22023a(0x30b)])return _0x22023a(0x2d3);let _0x3aeb4b='';const _0x8af52e=_0xa880bf[_0x22023a(0x278)]['weatherInstance'];if(_0x8af52e)try{if(_0x8af52e['includes']('accuweather')){const _0x485721=await _0xa880bf[_0x22023a(0x21c)](_0x8af52e+'.Summary.Current');if(_0x485721&&_0x485721[_0x22023a(0x28e)])_0x3aeb4b=_0x485721[_0x22023a(0x28e)];}else{if(_0x8af52e['includes'](_0x22023a(0x1fc))){const _0x36d9de=await _0xa880bf['getForeignStateAsync'](_0x8af52e+_0x22023a(0x299));if(_0x36d9de&&_0x36d9de[_0x22023a(0x28e)])_0x3aeb4b=_0x36d9de[_0x22023a(0x28e)];}else{if(_0x8af52e[_0x22023a(0x364)]('openweathermap')){const _0x2b0e59=await _0xa880bf[_0x22023a(0x21c)](_0x8af52e+_0x22023a(0x1f4));if(_0x2b0e59&&_0x2b0e59[_0x22023a(0x28e)])_0x3aeb4b=_0x2b0e59['val'];}}}}catch(_0x4d8dd5){}if(!_0x3aeb4b){const _0x34a657=['accuweather.0',_0x22023a(0x340),_0x22023a(0x25c),_0x22023a(0x24b)];for(const _0x11b6d9 of _0x34a657){try{const _0x14b895=await _0xa880bf[_0x22023a(0x1f1)](_0x11b6d9);if(_0x14b895){if(_0x11b6d9[_0x22023a(0x364)](_0x22023a(0x215))){const _0x2afc97=await _0xa880bf[_0x22023a(0x21c)](_0x11b6d9+_0x22023a(0x2b0));if(_0x2afc97&&_0x2afc97[_0x22023a(0x28e)]){_0x3aeb4b=_0x2afc97[_0x22023a(0x28e)];break;}}}}catch(_0x4ec4c4){}}}return _0x3aeb4b?_0x22023a(0x283)+_0x3aeb4b:_0x22023a(0x2c2);}catch(_0x45bced){return'WETTER\x20ERROR:\x20'+_0x45bced[_0x22023a(0x3b1)];}}async function getCalendarContext(_0xb38b30){const _0x22ef0e=a0_0x43e425;try{if(!_0xb38b30[_0x22ef0e(0x278)][_0x22ef0e(0x1d6)])return _0x22ef0e(0x1bb);let _0xaee0ee=_0xb38b30['config']['calendarInstance']||_0x22ef0e(0x29b),_0x47eb7e=_0xb38b30[_0x22ef0e(0x278)][_0x22ef0e(0x286)]||[];if(typeof _0x47eb7e===_0x22ef0e(0x336))_0x47eb7e=_0x47eb7e[_0x22ef0e(0x1a6)](',');try{const _0x2c27e5=await _0xb38b30['getForeignStateAsync'](_0xaee0ee+_0x22ef0e(0x214));if(_0x2c27e5&&_0x2c27e5[_0x22ef0e(0x28e)]){let _0xf23080=tryParse(_0x2c27e5[_0x22ef0e(0x28e)]);if(_0xf23080&&Array[_0x22ef0e(0x29f)](_0xf23080)){if(_0x47eb7e[_0x22ef0e(0x36f)]>0x0)_0xf23080=_0xf23080[_0x22ef0e(0x2d1)](_0x3a5ead=>_0x47eb7e[_0x22ef0e(0x364)](_0x3a5ead['_calName']||''));else return _0x22ef0e(0x357);if(_0xf23080['length']>0x0){const _0x133f4e=_0xf23080[_0x22ef0e(0x2ad)](0x0,0x3)[_0x22ef0e(0x305)](_0x19d273=>{const _0x41fdb3=_0x22ef0e;let _0x2456cd=_0x19d273['date'];if(_0x19d273[_0x41fdb3(0x29a)])_0x2456cd+='\x20'+_0x19d273[_0x41fdb3(0x29a)];return _0x2456cd+':\x20'+_0x19d273[_0x41fdb3(0x1cc)]+'\x20('+_0x19d273['_calName']+')';});return'KALENDER:\x20'+_0x133f4e[_0x22ef0e(0x2c9)]('\x20|\x20');}else return _0x22ef0e(0x1bf);}}}catch(_0x2e16ca){_0xb38b30[_0x22ef0e(0x20e)][_0x22ef0e(0x1b9)]('Error\x20reading\x20calendar\x20table:\x20'+_0x2e16ca['message']);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x5bb84d){return _0x22ef0e(0x201)+_0x5bb84d[_0x22ef0e(0x3b1)];}}async function getCalendarNames(_0x13904a,_0x10e589){const _0x55e032=a0_0x43e425;try{const _0x172944=await _0x13904a[_0x55e032(0x21c)](_0x10e589+'.data.table');if(_0x172944&&_0x172944[_0x55e032(0x28e)]){const _0x56cff6=tryParse(_0x172944[_0x55e032(0x28e)]);if(_0x56cff6&&Array[_0x55e032(0x29f)](_0x56cff6)){const _0x3067ba=[...new Set(_0x56cff6[_0x55e032(0x305)](_0x5d9cc7=>_0x5d9cc7[_0x55e032(0x29e)])['filter'](Boolean))];return _0x3067ba['sort']();}}return[];}catch(_0x4e337c){return _0x13904a[_0x55e032(0x20e)][_0x55e032(0x2ca)](_0x55e032(0x1a0)+_0x4e337c[_0x55e032(0x3b1)]),[];}}function a0_0xcd11(_0xc40fa6,_0x3c0d87){const _0x5e362c=a0_0x4020();return a0_0xcd11=function(_0x1dd38d,_0x4ccd32){_0x1dd38d=_0x1dd38d-0x186;let _0x40202c=_0x5e362c[_0x1dd38d];return _0x40202c;},a0_0xcd11(_0xc40fa6,_0x3c0d87);}async function checkWifiPresence(_0x4f55a6){const _0x394b7f=a0_0x43e425;try{const _0x57066b=_0x4f55a6[_0x394b7f(0x278)][_0x394b7f(0x371)]||[];let _0x5e2352=![];const _0x159a1a=[];for(const _0x25bfd4 of _0x57066b){try{const _0x5da8b3=await _0x4f55a6[_0x394b7f(0x21c)](_0x25bfd4);if(_0x5da8b3&&(_0x5da8b3[_0x394b7f(0x28e)]===!![]||_0x5da8b3[_0x394b7f(0x28e)]===_0x394b7f(0x22b)||_0x5da8b3[_0x394b7f(0x28e)]===0x1)){_0x5e2352=!![];const _0x18190e=await _0x4f55a6[_0x394b7f(0x1f1)](_0x25bfd4);let _0x144252=_0x25bfd4;_0x18190e&&_0x18190e[_0x394b7f(0x238)]&&_0x18190e[_0x394b7f(0x238)][_0x394b7f(0x245)]&&(_0x144252=typeof _0x18190e['common'][_0x394b7f(0x245)]==='object'?_0x18190e[_0x394b7f(0x238)]['name']['de']||_0x18190e[_0x394b7f(0x238)][_0x394b7f(0x245)]['en']:_0x18190e[_0x394b7f(0x238)]['name']),_0x159a1a['push'](_0x144252);}}catch(_0x11a311){}}return await _0x4f55a6[_0x394b7f(0x2c7)](_0x394b7f(0x18f),{'val':_0x159a1a[_0x394b7f(0x2c9)](',\x20'),'ack':!![]}),_0x5e2352&&(_0x4f55a6[_0x394b7f(0x2d9)]&&(_0x4f55a6['log'][_0x394b7f(0x237)]('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),abortExitTimer(_0x4f55a6)),!_0x4f55a6[_0x394b7f(0x198)]&&_0x4f55a6[_0x394b7f(0x21a)]===SYSTEM_MODES[_0x394b7f(0x24c)]&&await setPresence(_0x4f55a6,!![])),_0x5e2352;}catch(_0x1280d7){return _0x4f55a6[_0x394b7f(0x20e)]['error'](_0x394b7f(0x1be)+_0x1280d7[_0x394b7f(0x3b1)]),![];}}function startExitTimer(_0x47a37b){const _0x13c328=a0_0x43e425;abortExitTimer(_0x47a37b),_0x47a37b[_0x13c328(0x2bb)]=!![],_0x47a37b[_0x13c328(0x1a2)]=setTimeout(()=>{const _0x436991=_0x13c328;_0x47a37b[_0x436991(0x2bb)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x47a37b['exitTimer']=setTimeout(()=>{setPresence(_0x47a37b,![]),_0x47a37b['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x5cf294){const _0x38d6ee=a0_0x43e425;if(_0x5cf294[_0x38d6ee(0x2d9)])clearTimeout(_0x5cf294[_0x38d6ee(0x2d9)]);if(_0x5cf294[_0x38d6ee(0x1a2)])clearTimeout(_0x5cf294[_0x38d6ee(0x1a2)]);_0x5cf294[_0x38d6ee(0x2d9)]=null,_0x5cf294[_0x38d6ee(0x1a2)]=null,_0x5cf294[_0x38d6ee(0x2bb)]=![];}async function setPresence(_0x20c4b2,_0x5c83b4){const _0x57aa9c=a0_0x43e425;if(_0x20c4b2[_0x57aa9c(0x198)]===_0x5c83b4)return;_0x20c4b2[_0x57aa9c(0x198)]=_0x5c83b4,await _0x20c4b2['setStateAsync'](_0x57aa9c(0x333),{'val':_0x5c83b4,'ack':!![]});}async function saveFeedback(_0x493867,_0x454278){const _0xb5668d=a0_0x43e425;_0x493867[_0xb5668d(0x20e)][_0xb5668d(0x237)](_0xb5668d(0x3a9)+JSON['stringify'](_0x454278));}async function runBaselineDriftAnalysis(_0x56e75e){const _0x3cae66=a0_0x43e425;if(!_0x56e75e[_0x3cae66(0x203)]||!_0x56e75e[_0x3cae66(0x22d)])return;const _0x408c73=_0x56e75e[_0x3cae66(0x278)][_0x3cae66(0x37e)]||0xe;if(_0x56e75e[_0x3cae66(0x259)][_0x3cae66(0x36f)]<_0x408c73+(_0x56e75e[_0x3cae66(0x278)][_0x3cae66(0x1b8)]||0x7)){await _0x56e75e[_0x3cae66(0x2c7)](LTM_DP_DRIFT_STATUS,{'val':_0x3cae66(0x33e),'ack':!![]});return;}const _0x33d402=_0x56e75e[_0x3cae66(0x259)][_0x3cae66(0x2ad)](-_0x408c73),_0x8c0e9b=_0x56e75e[_0x3cae66(0x259)]['slice'](0x0,_0x56e75e[_0x3cae66(0x259)][_0x3cae66(0x36f)]-_0x408c73),_0x154d94=_0x3cae66(0x393)+JSON[_0x3cae66(0x23c)](_0x8c0e9b)+_0x3cae66(0x190)+JSON[_0x3cae66(0x23c)](_0x33d402);try{const _0x17699c=await _0x56e75e[_0x3cae66(0x22d)]['generateContent'](_0x154d94),_0x5b4f5b=JSON['parse'](_0x17699c['response'][_0x3cae66(0x3bf)]()[_0x3cae66(0x325)](/```json|```/g,'')['trim']());_0x5b4f5b[_0x3cae66(0x1dc)]&&(await _0x56e75e[_0x3cae66(0x2c7)](LTM_DP_DRIFT_STATUS,{'val':_0x5b4f5b[_0x3cae66(0x1dc)],'ack':!![]}),await _0x56e75e[_0x3cae66(0x2c7)](LTM_DP_DRIFT_DETAILS,{'val':_0x5b4f5b[_0x3cae66(0x382)],'ack':!![]}),await _0x56e75e[_0x3cae66(0x2c7)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x3cae66(0x186)](),'ack':!![]}));}catch(_0x3695d5){}}function setupLtmScheduler(_0x10788e){const _0xd3c2a4=a0_0x43e425;try{if(_0x10788e[_0xd3c2a4(0x2dd)])_0x10788e[_0xd3c2a4(0x2dd)][_0xd3c2a4(0x20b)]();if(!_0x10788e[_0xd3c2a4(0x203)]){_0x10788e[_0xd3c2a4(0x2c7)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x10788e[_0xd3c2a4(0x2dd)]=schedule[_0xd3c2a4(0x25f)](LTM_SCHEDULE,()=>createDailyDigest(_0x10788e));}catch(_0x89e985){_0x10788e[_0xd3c2a4(0x20e)]['error'](_0xd3c2a4(0x1df)+_0x89e985[_0xd3c2a4(0x3b1)]);}}function setupModeResetScheduler(_0x47ea9b){const _0x61a61d=a0_0x43e425;try{if(_0x47ea9b[_0x61a61d(0x218)])_0x47ea9b[_0x61a61d(0x218)]['cancel']();_0x47ea9b[_0x61a61d(0x218)]=schedule[_0x61a61d(0x25f)](MODE_RESET_SCHEDULE,async()=>{const _0x1f1ae8=_0x61a61d;await loadSystemMode(_0x47ea9b),AUTO_RESET_MODES['includes'](_0x47ea9b[_0x1f1ae8(0x21a)])&&await _0x47ea9b[_0x1f1ae8(0x2c7)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1f1ae8(0x24c)],'ack':![]});});}catch(_0x1459ed){_0x47ea9b[_0x61a61d(0x20e)][_0x61a61d(0x2ca)]('Reset\x20Sched\x20Error:\x20'+_0x1459ed[_0x61a61d(0x3b1)]);}}function setupDriftAnalysisScheduler(_0xd2d30a){const _0x1fa049=a0_0x43e425;try{if(_0xd2d30a[_0x1fa049(0x2af)])clearInterval(_0xd2d30a[_0x1fa049(0x2af)]);if(!_0xd2d30a[_0x1fa049(0x203)])return;_0xd2d30a[_0x1fa049(0x2af)]=setInterval(()=>runBaselineDriftAnalysis(_0xd2d30a),(_0xd2d30a[_0x1fa049(0x278)][_0x1fa049(0x23b)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0xd2d30a),0x1388);}catch(_0x48f8ca){_0xd2d30a['log']['error'](_0x1fa049(0x1bc)+_0x48f8ca['message']);}}function setupBriefingScheduler(_0x3a4bc6){const _0x9c6e32=a0_0x43e425;try{if(_0x3a4bc6['briefingJob'])_0x3a4bc6[_0x9c6e32(0x1e9)][_0x9c6e32(0x20b)]();if(!_0x3a4bc6[_0x9c6e32(0x278)][_0x9c6e32(0x30f)])return;const _0x316833=(_0x3a4bc6[_0x9c6e32(0x278)][_0x9c6e32(0x322)]||_0x9c6e32(0x244))['split'](':'),_0x32149e=parseInt(_0x316833[0x0])||0x8,_0x512ed7=parseInt(_0x316833[0x1])||0x0,_0x5db2f1=_0x512ed7+'\x20'+_0x32149e+_0x9c6e32(0x353);_0x3a4bc6['log'][_0x9c6e32(0x237)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x32149e+':'+(_0x512ed7<0xa?'0'+_0x512ed7:_0x512ed7)),_0x3a4bc6[_0x9c6e32(0x1e9)]=schedule[_0x9c6e32(0x25f)](_0x5db2f1,()=>{sendMorningBriefing(_0x3a4bc6);});}catch(_0x1ff2be){_0x3a4bc6[_0x9c6e32(0x20e)][_0x9c6e32(0x2ca)]('Briefing\x20Sched\x20Error:\x20'+_0x1ff2be[_0x9c6e32(0x3b1)]);}}async function sendNotification(_0x19c1c2,_0x584a70,_0x4d9241=![],_0x3b3189=![]){const _0x2fb893=a0_0x43e425;_0x19c1c2[_0x2fb893(0x20e)][_0x2fb893(0x237)]((_0x4d9241?_0x2fb893(0x191):'')+'Sending\x20notification:\x20\x22'+_0x584a70+'\x22');const _0x183d69=_0x19c1c2[_0x2fb893(0x278)];let _0x4c2e72=0x0;if(_0x183d69['notifyTelegramEnabled']){let _0x2dae0d={};(_0x584a70['includes'](_0x2fb893(0x2ac))||_0x3b3189)&&(_0x2dae0d={'reply_markup':{'inline_keyboard':[[{'text':_0x2fb893(0x320),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x2fb893(0x19c),'callback_data':_0x2fb893(0x39a)}]]}}),await _0x19c1c2['sendToAsync'](_0x183d69[_0x2fb893(0x202)],_0x2fb893(0x20f),{'text':_0x584a70,'user':_0x183d69[_0x2fb893(0x2c8)],..._0x2dae0d}),_0x4c2e72++;}if(_0x183d69[_0x2fb893(0x267)]){let _0x5dd91b={'message':_0x584a70,'title':_0x3b3189?_0x2fb893(0x279):_0x2fb893(0x303),'priority':_0x3b3189?0x2:0x1,'device':_0x183d69[_0x2fb893(0x213)]};_0x3b3189&&(_0x5dd91b[_0x2fb893(0x270)]=0x1e,_0x5dd91b['expire']=0xe10,_0x5dd91b[_0x2fb893(0x355)]=_0x2fb893(0x37c)),await _0x19c1c2[_0x2fb893(0x314)](_0x183d69[_0x2fb893(0x2f4)],_0x2fb893(0x20f),_0x5dd91b),_0x4c2e72++;}return _0x183d69[_0x2fb893(0x365)]&&(await _0x19c1c2['sendToAsync'](_0x183d69[_0x2fb893(0x3cb)],'send',{'text':_0x584a70,'to':_0x183d69[_0x2fb893(0x2cb)]}),_0x4c2e72++),_0x4c2e72;}async function setupTelegramListener(_0xaefae8){const _0xb8f73=a0_0x43e425,_0x45dde9=_0xaefae8[_0xb8f73(0x278)][_0xb8f73(0x202)];_0xaefae8[_0xb8f73(0x278)][_0xb8f73(0x25b)]&&_0x45dde9&&(_0xaefae8[_0xb8f73(0x20e)][_0xb8f73(0x237)](_0xb8f73(0x205)+_0x45dde9+_0xb8f73(0x35e)),await _0xaefae8[_0xb8f73(0x287)](_0x45dde9+_0xb8f73(0x1d3)));}async function handleTelegramResponse(_0x58f9df,_0x574ad7){const _0xf3ecee=a0_0x43e425;let _0x387076=_0x574ad7;_0x574ad7[_0xf3ecee(0x315)]('[')&&(_0x387076=_0x574ad7[_0xf3ecee(0x220)](_0x574ad7[_0xf3ecee(0x266)](']')+0x1));if(_0x387076===_0xf3ecee(0x1b4))_0x58f9df[_0xf3ecee(0x20e)][_0xf3ecee(0x237)](_0xf3ecee(0x351)),await _0x58f9df[_0xf3ecee(0x2c7)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x58f9df[_0xf3ecee(0x2c7)](_0xf3ecee(0x18e),{'val':_0xf3ecee(0x301),'ack':!![]}),_0x58f9df[_0xf3ecee(0x372)]=![],sendNotification(_0x58f9df,'‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x387076===_0xf3ecee(0x39a)&&(_0x58f9df['log'][_0xf3ecee(0x1b9)]('üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x58f9df,_0xf3ecee(0x26e),![],!![]));}async function runAutopilot(_0x33f5c1){const _0x4d8d67=a0_0x43e425,_0x595bdf=_0x33f5c1['config'][_0x4d8d67(0x1d1)],_0x323121=_0x33f5c1[_0x4d8d67(0x35b)]['length']>0x0?_0x33f5c1[_0x4d8d67(0x35b)][0x0][_0x4d8d67(0x2e7)]:Date[_0x4d8d67(0x186)](),_0x1cff1f=(Date['now']()-_0x323121)/(0x3e8*0x3c*0x3c);let _0x44eae6='';_0x33f5c1[_0x4d8d67(0x278)][_0x4d8d67(0x3b5)]&&_0x33f5c1[_0x4d8d67(0x21a)]===SYSTEM_MODES[_0x4d8d67(0x24c)]&&_0x33f5c1[_0x4d8d67(0x198)]&&(_0x1cff1f>_0x595bdf&&(_0x44eae6='HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0x1cff1f[_0x4d8d67(0x35f)](0x1)+_0x4d8d67(0x26b))),runGeminiAnalysis(_0x33f5c1,_0x44eae6)[_0x4d8d67(0x1da)](_0x3385f9=>_0x33f5c1[_0x4d8d67(0x20e)]['error'](_0x3385f9));}async function createDailyDigest(_0x4080c8){const _0x221e06=a0_0x43e425;if(!_0x4080c8[_0x221e06(0x203)])return;await _0x4080c8[_0x221e06(0x2c7)](LTM_DP_STATUS,{'val':_0x221e06(0x2aa)+new Date()[_0x221e06(0x388)](),'ack':!![]});if(!_0x4080c8[_0x221e06(0x22d)]||_0x4080c8['rawEventLog']['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4080c8[_0x221e06(0x2c7)](LTM_DP_STATUS,{'val':_0x221e06(0x295),'ack':!![]});return;}const _0x1c31c7=JSON['parse'](JSON[_0x221e06(0x23c)](_0x4080c8[_0x221e06(0x297)])),_0x49e0a3=_0x1c31c7['length'],_0x444072=_0x221e06(0x375)+JSON[_0x221e06(0x23c)](_0x1c31c7);try{const _0xec04e7=await _0x4080c8[_0x221e06(0x22d)][_0x221e06(0x378)](_0x444072),_0x442eff=JSON[_0x221e06(0x227)](_0xec04e7[_0x221e06(0x194)][_0x221e06(0x3bf)]()[_0x221e06(0x325)](/```json|```/g,'')[_0x221e06(0x257)]());if(_0x442eff[_0x221e06(0x2da)]){const _0x120533={'timestamp':new Date()[_0x221e06(0x300)](),'eventCount':_0x49e0a3,'summary':_0x442eff[_0x221e06(0x2da)],'activityLevel':_0x442eff[_0x221e06(0x2a6)],'systemMode':_0x4080c8[_0x221e06(0x21a)]};_0x4080c8[_0x221e06(0x259)]['push'](_0x120533),await saveDailyDigests(_0x4080c8),_0x4080c8[_0x221e06(0x297)]=[],await saveRawEventLog(_0x4080c8),await _0x4080c8['setStateAsync'](LTM_DP_STATUS,{'val':'Success:\x20Compressed\x20'+_0x49e0a3+_0x221e06(0x1e8),'ack':!![]}),_0x4080c8['isProVersion']&&(_0x4080c8[_0x221e06(0x20e)][_0x221e06(0x237)](_0x221e06(0x339)),sendToPython(_0x4080c8,_0x221e06(0x1ce),{'digest':_0x120533}));}}catch(_0x1d1422){await _0x4080c8[_0x221e06(0x2c7)](LTM_DP_STATUS,{'val':_0x221e06(0x3cf)+_0x1d1422[_0x221e06(0x3b1)],'ack':!![]});}}async function sendMorningBriefing(_0x141b1c){const _0x4baa6a=a0_0x43e425;if(!_0x141b1c[_0x4baa6a(0x22d)])return;_0x141b1c['log'][_0x4baa6a(0x237)](_0x4baa6a(0x208));const _0x5202c7=_0x141b1c[_0x4baa6a(0x259)]['length']>0x0?_0x141b1c['dailyDigests'][_0x141b1c[_0x4baa6a(0x259)][_0x4baa6a(0x36f)]-0x1]:null,_0x45b79c=_0x5202c7&&_0x5202c7[_0x4baa6a(0x39d)]?_0x5202c7[_0x4baa6a(0x39d)][_0x4baa6a(0x242)]:_0x4baa6a(0x1f7),_0x18786f=new Date();_0x18786f[_0x4baa6a(0x2e8)](0x4,0x0,0x0,0x0);const _0x2c29fe=_0x141b1c[_0x4baa6a(0x35b)][_0x4baa6a(0x2d1)](_0x1b0941=>new Date(_0x1b0941[_0x4baa6a(0x2e7)])>_0x18786f),_0x62a938=PERSONA_MAPPING[_0x141b1c[_0x4baa6a(0x278)]['aiPersona']||_0x4baa6a(0x196)],_0x28329b=_0x141b1c[_0x4baa6a(0x278)]['livingContext']||'',_0x53f056=await getWeatherContext(_0x141b1c),_0x442ba6=await getCalendarContext(_0x141b1c),_0x56414c='ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20'+_0x62a938+'.\x20KONTEXT:\x20'+_0x28329b+_0x4baa6a(0x1ab)+_0x53f056+'\x20'+_0x442ba6+_0x4baa6a(0x337)+_0x45b79c+_0x4baa6a(0x310)+JSON[_0x4baa6a(0x23c)](_0x2c29fe[_0x4baa6a(0x2ad)](0x0,0xa))+_0x4baa6a(0x2b9);try{const _0x2cc032=await _0x141b1c[_0x4baa6a(0x22d)][_0x4baa6a(0x378)](_0x56414c),_0x2f6976='üåÖ\x20Daily\x20Briefing:\x0a'+_0x2cc032['response'][_0x4baa6a(0x3bf)]()['trim']();sendNotification(_0x141b1c,_0x2f6976),_0x141b1c[_0x4baa6a(0x20e)][_0x4baa6a(0x237)](_0x4baa6a(0x26c));}catch(_0x2da399){_0x141b1c[_0x4baa6a(0x20e)][_0x4baa6a(0x2ca)](_0x4baa6a(0x27a)+_0x2da399['message']);}}async function scanForDevices(_0x4bc041,_0xb7f37b){const _0x118aa2=a0_0x43e425;_0x4bc041['log'][_0x118aa2(0x237)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x3f3eee=[],_0xe84ff6=await _0x4bc041[_0x118aa2(0x246)]('*'),_0x2cc409=await _0x4bc041[_0x118aa2(0x246)](_0x118aa2(0x18b),'enum'),_0x5bbccd=await _0x4bc041[_0x118aa2(0x246)](_0x118aa2(0x36b),_0x118aa2(0x34c)),_0x270254={};if(_0x2cc409)for(const _0x493df8 in _0x2cc409){const _0x35b6b8=_0x2cc409[_0x493df8][_0x118aa2(0x238)][_0x118aa2(0x2ab)]||[];_0x35b6b8[_0x118aa2(0x368)](_0x14e3da=>{const _0x47d5d3=_0x118aa2;if(!_0x270254[_0x14e3da])_0x270254[_0x14e3da]=[];_0x270254[_0x14e3da][_0x47d5d3(0x328)](_0x493df8);});}const _0x450ddc={};if(_0x5bbccd)for(const _0x5d2c8c in _0x5bbccd){const _0x38fec9=_0x5bbccd[_0x5d2c8c]['common'][_0x118aa2(0x2ab)]||[],_0x2e6fc3=typeof _0x5bbccd[_0x5d2c8c][_0x118aa2(0x238)]['name']==='object'?_0x5bbccd[_0x5d2c8c]['common'][_0x118aa2(0x245)]['de']:_0x5bbccd[_0x5d2c8c][_0x118aa2(0x238)]['name'];_0x38fec9[_0x118aa2(0x368)](_0x4f74b0=>_0x450ddc[_0x4f74b0]=_0x2e6fc3);}const _0x3c93ff=_0xb7f37b[_0x118aa2(0x234)]||[],_0xe5436a=_0xb7f37b[_0x118aa2(0x346)]!==![],_0x1fafff=_0xb7f37b['doors']!==![],_0x112adb=_0xb7f37b[_0x118aa2(0x231)]!==![],_0xf3093e=_0xb7f37b[_0x118aa2(0x18c)]===!![],_0x5e7818=_0xb7f37b[_0x118aa2(0x22a)]===!![];for(const _0x1f9def in _0xe84ff6){const _0x2f9687=_0xe84ff6[_0x1f9def];if(_0x2f9687['type']!==_0x118aa2(0x369)||!_0x2f9687[_0x118aa2(0x238)])continue;if(ADAPTER_BLACKLIST[_0x118aa2(0x2c3)](_0x52a24c=>_0x1f9def['startsWith'](_0x52a24c))&&!_0x5e7818)continue;const _0x3d95c7=(_0x2f9687['common'][_0x118aa2(0x1c0)]||'')[_0x118aa2(0x195)]();let _0x54900e=(typeof _0x2f9687[_0x118aa2(0x238)][_0x118aa2(0x245)]===_0x118aa2(0x1ec)?_0x2f9687[_0x118aa2(0x238)]['name']['de']:_0x2f9687[_0x118aa2(0x238)][_0x118aa2(0x245)])||_0x1f9def;const _0xb5ff57=_0x54900e['toLowerCase']();let _0x5529df=![],_0x20ff4c=![];if(_0x3c93ff[_0x118aa2(0x36f)]>0x0){const _0x3fec45=_0x270254[_0x1f9def]||[],_0x4d32b1=_0x1f9def['split']('.')[_0x118aa2(0x2ad)](0x0,-0x1)[_0x118aa2(0x2c9)]('.'),_0x2bc3cd=_0x270254[_0x4d32b1]||[];(_0x3fec45[_0x118aa2(0x2c3)](_0xfb14ae=>_0x3c93ff[_0x118aa2(0x364)](_0xfb14ae))||_0x2bc3cd[_0x118aa2(0x2c3)](_0x1f1f51=>_0x3c93ff[_0x118aa2(0x364)](_0x1f1f51)))&&(_0x5529df=!![],_0x20ff4c=!![]);}if(!_0x5529df&&!_0x5e7818){if(HARD_IGNORE_TERMS['some'](_0x376639=>_0x1f9def[_0x118aa2(0x364)](_0x376639)||_0xb5ff57[_0x118aa2(0x364)](_0x376639[_0x118aa2(0x195)]())))continue;}if(BAD_NAMES[_0x118aa2(0x2c3)](_0x12908f=>_0xb5ff57===_0x12908f||_0xb5ff57['endsWith']('.'+_0x12908f))){const _0x12bc07=_0x1f9def['split']('.');if(_0x12bc07[_0x118aa2(0x36f)]>0x2){const _0x4ea15c=_0x12bc07[_0x118aa2(0x2ad)](0x0,-0x1)['join']('.'),_0x2e245d=_0xe84ff6[_0x4ea15c];if(_0x2e245d&&_0x2e245d[_0x118aa2(0x238)]&&_0x2e245d['common']['name']){const _0x46bf54=typeof _0x2e245d[_0x118aa2(0x238)][_0x118aa2(0x245)]===_0x118aa2(0x1ec)?_0x2e245d[_0x118aa2(0x238)][_0x118aa2(0x245)]['de']:_0x2e245d[_0x118aa2(0x238)][_0x118aa2(0x245)];_0x46bf54&&!_0x54900e['includes'](_0x46bf54)&&(_0x54900e=_0x46bf54+'\x20'+_0x54900e);}}}let _0x532e9b='';if(_0xe5436a&&(_0x3d95c7[_0x118aa2(0x364)]('motion')||_0x3d95c7[_0x118aa2(0x364)]('occupancy')||_0xb5ff57[_0x118aa2(0x364)](_0x118aa2(0x34a))||_0xb5ff57[_0x118aa2(0x364)](_0x118aa2(0x37a))))_0x532e9b=_0x118aa2(0x346);else{if(!_0x532e9b&&_0x1fafff&&(_0x3d95c7[_0x118aa2(0x364)](_0x118aa2(0x3a8))||_0x3d95c7[_0x118aa2(0x364)](_0x118aa2(0x1e2))||_0x3d95c7['includes'](_0x118aa2(0x1fb))||_0x3d95c7[_0x118aa2(0x364)](_0x118aa2(0x1f9))||_0x3d95c7[_0x118aa2(0x364)](_0x118aa2(0x1d5))||_0xb5ff57[_0x118aa2(0x364)](_0x118aa2(0x210))||_0xb5ff57[_0x118aa2(0x364)](_0x118aa2(0x258))||_0xb5ff57['includes']('rollladen')))_0x532e9b=_0x118aa2(0x3a8);else{if(!_0x532e9b&&_0x112adb&&(_0x3d95c7[_0x118aa2(0x364)](_0x118aa2(0x24d))||_0x3d95c7[_0x118aa2(0x364)](_0x118aa2(0x2d4))||_0x3d95c7[_0x118aa2(0x364)](_0x118aa2(0x23d))||_0xb5ff57[_0x118aa2(0x364)]('licht')||_0xb5ff57['includes'](_0x118aa2(0x264))||_0xb5ff57[_0x118aa2(0x364)](_0x118aa2(0x228)))){if(_0x2f9687[_0x118aa2(0x238)][_0x118aa2(0x389)]||_0x3d95c7[_0x118aa2(0x364)](_0x118aa2(0x2b7)))_0x532e9b=_0x118aa2(0x24d);}else{if(!_0x532e9b&&_0xf3093e&&(_0x3d95c7['includes'](_0x118aa2(0x18c))||_0x3d95c7['includes'](_0x118aa2(0x3ba))||_0x3d95c7[_0x118aa2(0x364)]('thermostat')||_0xb5ff57[_0x118aa2(0x364)](_0x118aa2(0x2d0))||_0xb5ff57[_0x118aa2(0x364)](_0x118aa2(0x323))||_0xb5ff57[_0x118aa2(0x364)](_0x118aa2(0x32a))))_0x532e9b=_0x118aa2(0x18c);else{if(!_0x532e9b&&_0x20ff4c)_0x532e9b=_0x118aa2(0x189);}}}}if(_0x532e9b){let _0x458240=_0x450ddc[_0x1f9def]||'';if(!_0x458240){let _0x3d4284=_0x1f9def;for(let _0x223857=0x0;_0x223857<0x3;_0x223857++){const _0x2bcce0=_0x3d4284['lastIndexOf']('.');if(_0x2bcce0===-0x1)break;_0x3d4284=_0x3d4284[_0x118aa2(0x220)](0x0,_0x2bcce0);if(_0x450ddc[_0x3d4284]){_0x458240=_0x450ddc[_0x3d4284];break;}}}_0x3f3eee[_0x118aa2(0x328)]({'id':_0x1f9def,'name':_0x54900e,'location':_0x458240,'type':_0x532e9b,'logDuplicates':_0x532e9b===_0x118aa2(0x346),'isExit':![],'_score':_0x458240?0x50:_0x532e9b===_0x118aa2(0x189)?0x5a:0x28});}}return _0x3f3eee[_0x118aa2(0x2ce)]((_0x204261,_0x1ab224)=>_0x1ab224['_score']-_0x204261[_0x118aa2(0x2f8)]),_0x3f3eee;}async function executeAutomationAction(_0x4f9dc9){const _0x2d5980=a0_0x43e425;try{const _0x424076=await _0x4f9dc9[_0x2d5980(0x34e)](_0x2d5980(0x2e9)),_0x2f430e=await _0x4f9dc9[_0x2d5980(0x34e)](_0x2d5980(0x252));if(_0x424076&&_0x424076[_0x2d5980(0x28e)]&&_0x2f430e){const _0x17c78a=_0x424076[_0x2d5980(0x28e)];let _0x184039=_0x2f430e[_0x2d5980(0x28e)];try{_0x184039=JSON[_0x2d5980(0x227)](_0x184039);}catch(_0x3fca51){}_0x4f9dc9[_0x2d5980(0x20e)][_0x2d5980(0x237)](_0x2d5980(0x3b2)+_0x17c78a+'\x20=\x20'+_0x184039),await _0x4f9dc9[_0x2d5980(0x1f5)](_0x17c78a,_0x184039);}else _0x4f9dc9[_0x2d5980(0x20e)][_0x2d5980(0x1b9)](_0x2d5980(0x261));}catch(_0x50e25a){_0x4f9dc9[_0x2d5980(0x20e)][_0x2d5980(0x2ca)](_0x2d5980(0x1f0)+_0x50e25a[_0x2d5980(0x3b1)]);}}function tryParse(_0x3df1f2){try{return JSON['parse'](_0x3df1f2);}catch(_0x45498d){return null;}}async function recordSequence(_0x42a4ac,_0x286e33){const _0x58fcb8=a0_0x43e425,_0x273609=(_0x286e33[_0x58fcb8(0x34d)]||'')[_0x58fcb8(0x195)](),_0x2c08d0=[_0x58fcb8(0x346),'bewegung',_0x58fcb8(0x37a),'presence',_0x58fcb8(0x396),'door',_0x58fcb8(0x258),'window',_0x58fcb8(0x210),_0x58fcb8(0x331),_0x58fcb8(0x370),'light',_0x58fcb8(0x22f),_0x58fcb8(0x2d4),_0x58fcb8(0x228),'dimmer',_0x58fcb8(0x264)];if(!_0x2c08d0['some'](_0x3536f5=>_0x273609[_0x58fcb8(0x364)](_0x3536f5))){_0x42a4ac[_0x58fcb8(0x20e)][_0x58fcb8(0x251)](_0x58fcb8(0x2bd)+_0x286e33['id']+_0x58fcb8(0x1c8)+_0x286e33[_0x58fcb8(0x34d)]+'\x27\x20not\x20in\x20allowed\x20list)');return;}if(!_0x286e33['value']){_0x42a4ac[_0x58fcb8(0x20e)][_0x58fcb8(0x251)](_0x58fcb8(0x2bd)+_0x286e33['id']+'\x20(Value\x20is\x20falsy:\x20'+_0x286e33[_0x58fcb8(0x28a)]+')');return;}_0x42a4ac[_0x58fcb8(0x20e)][_0x58fcb8(0x251)](_0x58fcb8(0x222)+_0x286e33['id']+'\x20('+_0x286e33[_0x58fcb8(0x33d)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x2d973a={'loc':_0x286e33[_0x58fcb8(0x33d)]||'Unknown','id':_0x286e33['id'],'ts':Date[_0x58fcb8(0x186)]()};activeSequence['push'](_0x2d973a),_0x42a4ac[_0x58fcb8(0x20e)][_0x58fcb8(0x251)]('[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20'+_0x2d973a['loc']+_0x58fcb8(0x316)+activeSequence['length']+')'),sequenceTimer=setTimeout(async()=>{const _0x5b3360=_0x58fcb8;activeSequence['length']>0x1?await saveCompletedSequence(_0x42a4ac):(_0x42a4ac[_0x5b3360(0x20e)][_0x5b3360(0x251)]('[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20'+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x2a558c){const _0x205857=a0_0x43e425;try{_0x2a558c[_0x205857(0x20e)][_0x205857(0x237)]('[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20'+activeSequence[_0x205857(0x36f)]+_0x205857(0x19a));const _0x17685a=await _0x2a558c[_0x205857(0x34e)](_0x205857(0x37f));let _0x529458=[];if(_0x17685a&&_0x17685a[_0x205857(0x28e)])try{_0x529458=JSON[_0x205857(0x227)](_0x17685a['val']);}catch(_0x4cb157){}const _0x2c7f0b=activeSequence[0x0]['ts'],_0x10b77c=activeSequence[_0x205857(0x305)](_0x3ce9b0=>({'loc':_0x3ce9b0[_0x205857(0x2df)],'t_delta':Math['round']((_0x3ce9b0['ts']-_0x2c7f0b)/0x3e8)})),_0x52d65d={'timestamp':new Date(_0x2c7f0b)[_0x205857(0x300)](),'steps':_0x10b77c,'duration':Math[_0x205857(0x2e0)]((activeSequence[activeSequence[_0x205857(0x36f)]-0x1]['ts']-_0x2c7f0b)/0x3e8),'daytime':new Date(_0x2c7f0b)[_0x205857(0x32b)]()};_0x529458[_0x205857(0x328)](_0x52d65d),_0x529458[_0x205857(0x36f)]>MAX_TRAINING_SET_SIZE&&_0x529458['shift'](),await _0x2a558c[_0x205857(0x2c7)](_0x205857(0x37f),{'val':JSON['stringify'](_0x529458),'ack':!![]}),runSecurityCheck(_0x2a558c,_0x52d65d),activeSequence=[],sequenceTimer=null;}catch(_0x1f2abb){_0x2a558c[_0x205857(0x20e)][_0x205857(0x2ca)](_0x205857(0x2dc)+_0x1f2abb[_0x205857(0x3b1)]);}}function a0_0x4020(){const _0x40673c=['online','2224140yiZUbY','geminiModel','feedbackHistory','licht','.\x20KONTEXT:\x20','lights','Could\x20not\x20kill\x20Python\x20process:\x20','analysis.deviationFromBaseline','selectedFunctionIds','[LOG]','Gemini\x20Analysis\x20Error:\x20','info','common','genAI','Training\x20Status','ltmDriftCheckIntervalHours','stringify','dimmer','\x20Tage)','TRAIN_ENERGY','currentposition','Health\x20Last\x20Check','sleepScore','systemUUID','08:00','name','getForeignObjectsAsync','system','ABWESEND','analysis.training.triggerSecurity','LTM.driftAnalysis.lastCheck','openweathermap.0','NORMAL','light','targetValue','LTM.driftAnalysis','instance','debug','analysis.automation.targetValue','python','data','channel','ü©∫\x20Triggering\x20Health\x20Training...','trim','t√ºr','dailyDigests','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','notifyTelegramEnabled','weatherunderground.0','analysisInterval','‚úÖ\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20','scheduleJob','getMonth','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','4320276OAwWRx','11ZaZtBA','lampe','aiPersona','indexOf','notifyPushoverEnabled','analysis.health.notes','üß™\x20Simulating\x20Butler\x20Proposal:\x20','events.history','\x20hours.\x20Potential\x20incapacitation.','Morning\x20Briefing\x20sent.','bin','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','delObjectAsync','retry','indicator.alarm.fire','values','search','.\x20NOTFALL-KONTEXT:\x20','details','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','Feedback\x20Log','config','üö®\x20EMERGENCY','Briefing\x20Error:\x20','Failed\x20to\x20parse\x20energy\x20result:\x20','existsSync','Sleep\x20Score\x20(0-100)','.NextHours.Location_1.Day_1.current.temp_value','number','automation.triggerAction','stderr','main','WETTER:\x20','LTM.dailyDigests','ltmLtbWindowDays','calendarSelection','subscribeForeignStatesAsync','normal','firmware','value','PONG','[PYTHON]\x20Failed\x20to\x20start:\x20','unknown','val','onMessage','Trigger\x20Briefing\x20(Test)','payload','Auto\x20Apply\x20Rule','presence','brightness','Skipped\x20(No\x20AI\x20or\x20Data)','analysis.health.restlessness','rawEventLog','communicate.request','.NextHours.Location_1.Day_1.current.symbol_desc','time','ical.0','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','path','_calName','isArray','Analysiere\x20ausgewogen.','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','subscribeStates','‚ùå\x20Training\x20failed:\x20','830949ROPKbn','HEALTH_RESULT','activityLevel','valve','toString','PRIORIT√ÑT:\x20Gesundheit/AAL.','Started\x20at\x20','members','Alarm','slice','stateChange','driftAnalysisTimer','.Summary.Current','analysis.health.lastCheck','requirements.txt','native','triggerBriefing','Unknown\x20error','analysis.health','sensor','Invalid\x20JSON\x20from\x20Python:\x20','.\x20OUTPUT:\x20Nur\x20Text.','from','isGracePeriodActive','heating','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','Error\x20in\x20onMessage\x20command\x20','flot.','.\x20ANWESENHEITS_STATUS:\x20','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','WETTER:\x20Keine\x20Daten\x20gefunden','some','Say\x20Hello','isAlert','testContext','setStateAsync','notifyTelegramRecipient','join','error','notifyEmailRecipient','Lernphase\x20(','analysis.training.triggerHealth','sort','analysis.training','temp','filter','4343337lyKdlV','Wetter:\x20Deaktiviert','switch','.\x20SYSTEM_MODE:\x20','setpoint','child_process','pip','exitTimer','summary','Installing\x20dependencies\x20into\x20venv...','[RECORDER]\x20Error\x20saving\x20sequence:\x20','ltmJob','Anwesend','loc','round','LTM.processingStatus','getTime','Who\x20is\x20present?','Verbindung\x20erfolgreich!\x20Antwort:\x20','analysis.training.status','No\x20module\x20named','timestamp','setHours','analysis.automation.targetId','üêç\x20Guardian\x20Diagnosis\x20(','Sec-Training\x20started...','Unknown','systemConfig','uuid-not-found','Action','win32','simple-api.','TEST-PRO-KEY','service.py','notifyPushoverInstance','Drift\x20Status','devices','Drift\x20Analysis','_score','text.alarm','Baseline\x20Status','Target\x20Value','working','kill','Comfort\x20Summary','GUEST','toISOString','Vom\x20Benutzer\x20best√§tigt\x20(OK).','description','Cogni-Living','position','map','cover','fill','Adapter','Trigger\x20Analysis','actual_temperature','useWeather','Thermodynamic\x20Data\x20Points','dutycycle','AI\x20Alert\x20Status','briefingEnabled','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','unload','sensorLastValues','6BProGd','sendToAsync','startsWith','\x20(Length:\x20','writable','weatherunderground','Normal','echarts.','Trend\x20Value\x20(%)','system.config','uuid','LTM.trainingData.thermodynamics','link_quality','‚úÖ\x20Alles\x20OK\x20(Reset)]','events.lastEvent','briefingTime','klima','status','replace','unshift','targetId','push','7968850kYLYmJ','heizung','getHours','alertReason','[PYTHON]\x20','Energy\x20Train\x20Error:\x20','node-schedule','energy','contact','ü©∫\x20HEALTH\x20WARNING:\x20','system.isPresent','analysis.comfortSummary','analysis.automation.triggerAction','string','.\x20DATEN:\x20Schlaf\x20','icons-mfd.','ü©∫\x20Triggering\x20Health\x20Analysis\x20on\x20new\x20Digest...','Urlaub','üêç\x20Stopping\x20Python\x20Sidecar...','@google/generative-ai','location','N/A\x20(Learning)','(((.+)+)+)+$','daswetter.0','setState','Recorded\x20Motion\x20Sequences','\x20AUFGABE:\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken.\x202.\x20Analysiere\x20auf\x20Komfort.\x20FORMAT\x20(JSON\x20Only):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','pythonProcess','analysis.health.sleepScore','motion','.forecast.current.temperature','73198PeLiBw','off','bewegung','üêç\x20Python\x20Pong\x20received!','enum','type','getStateAsync','getLtmData','Activity-Level','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','testNotification','\x20*\x20*\x20*','AI\x20Emergency\x20Status','sound','namespace','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','bind','shift','Trigger\x20Digest','eventHistory','scanDevices','getFullYear','\x20for\x20interactive\x20buttons...','toFixed','exports','stdin','update','pop','includes','notifyEmailEnabled','üõ°Ô∏è\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','TREND_RESULT','forEach','state','system.mode','enum.rooms.*','analysis.training.triggerEnergy','unreach','endsWith','length','kontakt','presenceDevices','lastAlertState','.venv','isExit','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','TRAINING_COMPLETE','javascript.','generateContent','Last\x20Check\x20Time','pr√§senz','onReady','siren','none','ltmStbWindowDays','LTM.trainingData.sequences','lowbat','Logbook','driftDetails','logDuplicates','.Current.Temperature','insulation','onStateChange','Bibliotheken\x20nicht\x20gefunden','toLocaleString','write','onUnload','\x20days\x20of\x20activity\x20data\x20to\x20Python...','SECURITY_RESULT','python3\x20-m\x20venv\x20\x22','Fokus\x20auf\x20Familienroutinen.','Last\x20Check','LTM.driftAnalysis.driftDetails','ANOMALY','Building\x20Insulation\x20Score','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','LTM','Train\x20Health\x20Model\x20(IsoForest)','occupancy','PRO-','Gast','analysisHistory','COGNI_REQUEST_CALL','.\x20WETTER:\x20','Train\x20Security\x20Model\x20(LSTM)','health','Unbekannt','Error\x20launching\x20Python\x20service:\x20','No\x20instance','Event\x20History','maintenance','LTM.baselineStatus','analysis.health.isAnomaly','...','scriptProblem','isEmergency','door','Feedback\x20saved:\x20','Keiner','analysis.trigger','ENERGY_TRAIN_RESULT','[PYTHON\x20ERR]\x20','Alert\x20Reason','sendTo','command','message','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','vacation','):\x20','inactivityMonitoringEnabled','automationProposal','config_pending','analysis.isAlert','rssi','humidity','üêç\x20Using\x20Isolated\x20VENV\x20Python:\x20','livingContext','Deaktiviert\x20(Pro-Feature)','KI-Modell\x20nicht\x20initialisiert','text','triggerDailyDigest','events.history_debug_00','analysis.automation.description','\x20presence\x20devices...','Aktiv\x20(','Health\x20Notes','licenseKey','Training\x20Error:\x20','targetposition','python_service','ack','notifyEmailInstance','ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x20PERSONA:\x20','reachable','analysis.automation.suggestedAction','Error:\x20','level','now','system.meta.uuid','TRAIN_HEALTH','custom','LTM.trainingData','enum.functions.*','temperature','indicator.alarm','analysis.alertReason','system.presenceWho','\x0aSTB:\x20','[TEST]\x20','Party','analysis.security.lastScore','response','toLowerCase','generic','@iobroker/adapter-core','isPresent','date',').\x20Saving\x20to\x20Training\x20Data.','apply','üìû\x20R√ºckruf\x20anfordern','cogni-living\x20adapter\x20starting\x20(v','application/json','Subscribing\x20to\x20','getCalendarNames\x20Error:\x20','analysis.feedbackHistory','exitGraceTimer','find','8GyIQSF','‚úÖ\x20INFRASTRUCTURE\x20READY.\x20Starting\x20Service...','split','json','Success:\x20','latitude','608869RfNDfN','.\x20ZUSATZ:\x20','analysis.lastResult','analysis.triggerBriefing','dependencyInstallInProgress','callback','analysis.isEmergency','stick_unreach','Failed\x20to\x20send\x20to\x20Python:\x20','extendObjectAsync','COGNI_CONFIRM_OK','outdoorSensorId','‚ö†Ô∏è\x20ALARM:\x20','analysis.energy.insulationScore','minDaysForBaseline','warn','constructor','Kalender:\x20Deaktiviert','Drift\x20Sched\x20Error:\x20','analysis.energy.heatingScore','Error\x20checking\x20WiFi:\x20','KALENDER:\x20Keine\x20relevanten\x20Termine','role','getOverviewData','\x22\x20install\x20-r\x20\x22','analysis.automation.patternDetected','\x20(Threshold:\x20','analysis.health.trendValue','Target\x20ID','Deviation','\x20(Type\x20\x27','boolean','testApiKey','Ungew√∂hnliches\x20Bewegungsmuster\x20erkannt!\x20(Score:\x20','event','‚úÖ\x20HEALTH\x20MODEL\x20TRAINED!\x20','ANALYZE_HEALTH','Guardian:\x20Sending\x20','Gemini\x20Init\x20Error:\x20','inactivityThresholdHours','Daily\x20Digests','.communicate.request','‚ùå\x20Health\x20Training\x20Failed:\x20','shutter','useCalendar','cogni-living','ANALYZE_SEQUENCE','button','catch','‚ùå\x20PIP\x20INSTALL\x20FAILED:\x20','baselineDrift','Scripts','setObjectNotExistsAsync','LTM\x20Sched\x20Error:\x20','analysis.analysisHistory','üõ†Ô∏è\x20INFRASTRUCTURE\x20HARDENING:\x20Setting\x20up\x20isolated\x20Python\x20environment\x20(venv)...','window','geminiApiKey','analysis.activitySummary','analysis.automation.autoApply','getDate','close','\x20events','briefingJob','Restlessness\x20Level','analysis.security.lastCheck','object','python3','VACATION','Last\x20Anomaly\x20Score','BUTLER\x20Execution\x20Error:\x20','getForeignObjectAsync','‚ùå\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv','PARTY','.forecast.current.state','setForeignStateAsync','Automation\x20Proposals','N/A','simulateButler','blind','Energy\x20Intelligence','lock','daswetter','uuid-error','Keine\x20Details.','Missing\x20data','LTM.rawEventLog','KALENDER\x20ERROR:\x20','notifyTelegramInstance','isProVersion','temperatur','üì°\x20Hooking\x20into\x20','Keine\x20Analyse.','Details:\x20','Generating\x20Morning\x20Briefing...','PRIORIT√ÑT:\x20Sicherheit.','analysisTimer','cancel','fault','Restoring\x20sensor\x20cache\x20from\x20history\x20(','log','send','fenster','models/gemini-flash-latest','vis.','notifyPushoverRecipient','.data.table','accuweather','.forecast.current.temp','54kOwieN','modeResetJob','connection','currentSystemMode','.\x20ANWESENDE_GERAETE:\x20','getForeignStateAsync','pip.exe','lastCheck','cpu_feature_guard','substring','Drift\x20Details','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','\x20events)...','\x20sensors...','indicator','[RESULT]','parse','schalter','detected','weather'];a0_0x4020=function(){return _0x40673c;};return a0_0x4020();}function runSecurityCheck(_0x46eb69,_0x2cdc9e){const _0x7b811e=a0_0x43e425;if(!_0x46eb69[_0x7b811e(0x203)])return;_0x46eb69[_0x7b811e(0x20e)][_0x7b811e(0x251)](_0x7b811e(0x366)),sendToPython(_0x46eb69,_0x7b811e(0x1d8),{'sequence':_0x2cdc9e});}async function getOutsideTemperatureNumeric(_0x479022){const _0x19d2fb=a0_0x43e425;if(_0x479022[_0x19d2fb(0x278)][_0x19d2fb(0x1b5)])try{const _0x2d6b9a=await _0x479022[_0x19d2fb(0x21c)](_0x479022['config'][_0x19d2fb(0x1b5)]);if(_0x2d6b9a&&_0x2d6b9a['val']!==undefined&&_0x2d6b9a[_0x19d2fb(0x28e)]!==null){const _0x1a47ad=parseFloat(_0x2d6b9a[_0x19d2fb(0x28e)]);if(!isNaN(_0x1a47ad))return _0x1a47ad;}}catch(_0x4764d7){}const _0x5073c9=_0x479022[_0x19d2fb(0x278)]['weatherInstance'];if(!_0x479022[_0x19d2fb(0x278)][_0x19d2fb(0x30b)]||!_0x5073c9)return null;try{let _0xabb1de='';if(_0x5073c9['includes']('accuweather'))_0xabb1de=_0x5073c9+_0x19d2fb(0x384);else{if(_0x5073c9[_0x19d2fb(0x364)]('daswetter'))_0xabb1de=_0x5073c9+_0x19d2fb(0x27e);else{if(_0x5073c9[_0x19d2fb(0x364)]('openweathermap'))_0xabb1de=_0x5073c9+_0x19d2fb(0x347);else{if(_0x5073c9[_0x19d2fb(0x364)](_0x19d2fb(0x318)))_0xabb1de=_0x5073c9+_0x19d2fb(0x216);}}}if(_0xabb1de){const _0x482bd7=await _0x479022[_0x19d2fb(0x21c)](_0xabb1de);if(_0x482bd7&&_0x482bd7[_0x19d2fb(0x28e)]!==undefined&&_0x482bd7['val']!==null)return parseFloat(_0x482bd7[_0x19d2fb(0x28e)]);}}catch(_0x34f57c){}return null;}async function recordThermodynamics(_0x187217,_0x40bd40,_0x3a8b4d,_0x1941ac){const _0x58d863=a0_0x43e425,_0x2f6311=await getOutsideTemperatureNumeric(_0x187217),_0x3d1a4b=await _0x187217[_0x58d863(0x34e)]('LTM.trainingData.thermodynamics');let _0x2af064=[];if(_0x3d1a4b&&_0x3d1a4b['val'])try{_0x2af064=JSON['parse'](_0x3d1a4b[_0x58d863(0x28e)]);}catch(_0x2c10f4){}_0x2af064[_0x58d863(0x328)]({'ts':Date[_0x58d863(0x186)](),'room':_0x1941ac||_0x58d863(0x2ec),'t_in':_0x3a8b4d,'t_out':_0x2f6311});if(_0x2af064[_0x58d863(0x36f)]>THERMO_LOG_SIZE)_0x2af064[_0x58d863(0x359)]();await _0x187217[_0x58d863(0x2c7)](_0x58d863(0x31e),{'val':JSON['stringify'](_0x2af064),'ack':!![]});}async function processSensorEvent(_0x2e532d,_0x181468,_0x4f6a8d,_0x155741){const _0x5ed592=a0_0x43e425;if(!_0x155741)return;const _0x377c42=_0x4f6a8d[_0x5ed592(0x28e)],_0x48acb0=Date['now'](),_0x2e5eb7=_0x2e532d[_0x5ed592(0x312)][_0x181468];_0x2e532d['sensorLastValues'][_0x181468]=_0x377c42;if(!_0x155741[_0x5ed592(0x383)]&&_0x2e5eb7!=undefined&&_0x2e5eb7==_0x377c42)return;const _0x561ad8=(_0x155741[_0x5ed592(0x34d)]||'')[_0x5ed592(0x195)](),_0x50b7bc=_0x561ad8[_0x5ed592(0x364)](_0x5ed592(0x18c))||_0x561ad8['includes'](_0x5ed592(0x204))||_0x561ad8[_0x5ed592(0x364)](_0x5ed592(0x323))||_0x561ad8[_0x5ed592(0x364)]('heizung');_0x2e532d['isProVersion']&&_0x50b7bc&&recordThermodynamics(_0x2e532d,_0x181468,_0x377c42,_0x155741['location']);const _0x480ed0={'timestamp':_0x48acb0,'id':_0x181468,'name':_0x155741['name'],'type':_0x155741['type'],'location':_0x155741[_0x5ed592(0x33d)],'value':_0x377c42};_0x2e532d[_0x5ed592(0x35b)][_0x5ed592(0x326)](_0x480ed0);if(_0x2e532d[_0x5ed592(0x35b)][_0x5ed592(0x36f)]>HISTORY_MAX_SIZE)_0x2e532d[_0x5ed592(0x35b)][_0x5ed592(0x363)]();await _0x2e532d['setStateAsync']('events.lastEvent',{'val':JSON[_0x5ed592(0x23c)](_0x480ed0),'ack':!![]}),await _0x2e532d[_0x5ed592(0x2c7)](_0x5ed592(0x26a),{'val':JSON[_0x5ed592(0x23c)](_0x2e532d['eventHistory']),'ack':!![]});_0x2e532d[_0x5ed592(0x203)]&&(_0x2e532d['rawEventLog']['push'](_0x480ed0),await saveRawEventLog(_0x2e532d),recordSequence(_0x2e532d,_0x480ed0));if(_0x155741[_0x5ed592(0x374)]&&_0x377c42===!![]){if(_0x2e532d[_0x5ed592(0x198)]&&!_0x2e532d[_0x5ed592(0x2bb)])startExitTimer(_0x2e532d);else{if(!_0x2e532d['isPresent'])setPresence(_0x2e532d,!![]);}}else{if(_0x155741['type']==='motion'&&_0x377c42===!![]){if(_0x2e532d[_0x5ed592(0x2d9)])abortExitTimer(_0x2e532d);if(!_0x2e532d[_0x5ed592(0x198)]&&_0x2e532d[_0x5ed592(0x21a)]===SYSTEM_MODES[_0x5ed592(0x24c)])setPresence(_0x2e532d,!![]);}}}async function runGeminiAnalysis(_0x47d9de,_0x318feb=''){const _0x17c300=a0_0x43e425;if(!_0x47d9de[_0x17c300(0x22d)])return;if(_0x47d9de[_0x17c300(0x35b)]['length']===0x0)return;const _0x50bb18=_0x47d9de[_0x17c300(0x35b)][_0x17c300(0x2ad)](0x0,0xf),_0x52e904=await getWeatherContext(_0x47d9de),_0x3b20fb=_0x47d9de[_0x17c300(0x21a)],_0x26a3ca=PERSONA_MAPPING[_0x47d9de['config'][_0x17c300(0x265)]||_0x17c300(0x196)],_0x25e33f=_0x47d9de[_0x17c300(0x278)][_0x17c300(0x3bc)]||_0x17c300(0x1fe);let _0x38e80e=_0x17c300(0x39e);try{const _0x6ee3ac=await _0x47d9de[_0x17c300(0x34e)](_0x17c300(0x18f));if(_0x6ee3ac&&_0x6ee3ac['val'])_0x38e80e=_0x6ee3ac['val'];}catch(_0x36b297){}let _0x4c92a6=![];try{const _0xf37e8a=await _0x47d9de[_0x17c300(0x34e)](_0x17c300(0x1e5));if(_0xf37e8a&&_0xf37e8a[_0x17c300(0x28e)])_0x4c92a6=!![];}catch(_0x4fbe24){}const _0x224001=_0x17c300(0x3cc)+_0x26a3ca+_0x17c300(0x230)+_0x25e33f+_0x17c300(0x2d5)+_0x3b20fb+_0x17c300(0x39b)+_0x52e904+_0x17c300(0x274)+(_0x318feb||_0x17c300(0x3aa))+_0x17c300(0x2c0)+(_0x47d9de['isPresent']?_0x17c300(0x2de):_0x17c300(0x248))+_0x17c300(0x21b)+_0x38e80e+'.\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x20'+JSON[_0x17c300(0x23c)](_0x50bb18)+_0x17c300(0x343);try{const _0x252d02=await _0x47d9de['geminiModel']['generateContent'](_0x224001),_0x2d1086=_0x252d02[_0x17c300(0x194)]['text']()['replace'](/```json|```/g,'')['trim'](),_0x43bec4=JSON[_0x17c300(0x227)](_0x2d1086);await _0x47d9de[_0x17c300(0x2c7)]('analysis.lastResult',{'val':JSON[_0x17c300(0x23c)](_0x43bec4),'ack':!![]});if(_0x43bec4[_0x17c300(0x2da)])await _0x47d9de['setStateAsync'](_0x17c300(0x1e4),{'val':_0x43bec4[_0x17c300(0x2da)],'ack':!![]});const _0x4e5691={'timestamp':Date[_0x17c300(0x186)](),'id':Date[_0x17c300(0x186)]()['toString'](),'analysis':{'activity':{'summary':_0x43bec4[_0x17c300(0x2da)]||_0x17c300(0x206),'isAlert':_0x43bec4[_0x17c300(0x2c5)]||![],'alertReason':_0x43bec4[_0x17c300(0x32c)]},'comfort':{'automationProposal':_0x43bec4['automationProposal']}}};await updateAnalysisHistory(_0x47d9de,_0x4e5691);const _0x393e9b=_0x43bec4[_0x17c300(0x2c5)]||![];_0x393e9b!==_0x47d9de[_0x17c300(0x372)]&&(await _0x47d9de[_0x17c300(0x2c7)]('analysis.isAlert',{'val':_0x393e9b,'ack':!![]}),_0x47d9de[_0x17c300(0x372)]=_0x393e9b,_0x393e9b&&(await _0x47d9de[_0x17c300(0x2c7)](_0x17c300(0x18e),{'val':_0x43bec4[_0x17c300(0x32c)],'ack':!![]}),sendNotification(_0x47d9de,_0x17c300(0x1b6)+_0x43bec4['alertReason'],![],_0x43bec4[_0x17c300(0x3a7)]))),_0x43bec4['automationProposal']&&_0x43bec4['automationProposal']['detected']&&_0x43bec4[_0x17c300(0x3b6)][_0x17c300(0x327)]&&(await _0x47d9de[_0x17c300(0x2c7)](_0x17c300(0x1c3),{'val':!![],'ack':!![]}),await _0x47d9de['setStateAsync'](_0x17c300(0x3c2),{'val':_0x43bec4[_0x17c300(0x3b6)][_0x17c300(0x302)],'ack':!![]}),await _0x47d9de[_0x17c300(0x2c7)](_0x17c300(0x2e9),{'val':_0x43bec4[_0x17c300(0x3b6)][_0x17c300(0x327)],'ack':!![]}),await _0x47d9de[_0x17c300(0x2c7)](_0x17c300(0x252),{'val':JSON[_0x17c300(0x23c)](_0x43bec4[_0x17c300(0x3b6)][_0x17c300(0x24e)]),'ack':!![]}),_0x4c92a6&&await executeAutomationAction(_0x47d9de));}catch(_0x757cdb){_0x47d9de[_0x17c300(0x20e)][_0x17c300(0x2ca)](_0x17c300(0x236)+_0x757cdb[_0x17c300(0x3b1)]);}}function installPythonDependencies(_0x3176f3){const _0xb7fb9=a0_0x43e425;if(_0x3176f3['dependencyInstallInProgress'])return;_0x3176f3[_0xb7fb9(0x1ae)]=!![];const _0x3f9b31=path[_0xb7fb9(0x2c9)](__dirname,_0xb7fb9(0x3c9),_0xb7fb9(0x2b2));_0x3176f3['log'][_0xb7fb9(0x237)](_0xb7fb9(0x1e1)),stopPythonService(_0x3176f3),!fs[_0xb7fb9(0x27c)](VENV_PATH)?(_0x3176f3['log'][_0xb7fb9(0x237)]('Creating\x20venv\x20at\x20'+VENV_PATH+_0xb7fb9(0x3a5)),exec(_0xb7fb9(0x38d)+VENV_PATH+'\x22',(_0x5737ed,_0x4a9605,_0x151bfc)=>{const _0x40d695=_0xb7fb9;if(_0x5737ed){_0x3176f3[_0x40d695(0x20e)][_0x40d695(0x2ca)](_0x40d695(0x1f2)),_0x3176f3['log'][_0x40d695(0x2ca)](_0x40d695(0x207)+(_0x151bfc||_0x5737ed[_0x40d695(0x3b1)])),_0x3176f3[_0x40d695(0x1ae)]=![];return;}installRequirementsInVenv(_0x3176f3,_0x3f9b31);})):installRequirementsInVenv(_0x3176f3,_0x3f9b31);}function installRequirementsInVenv(_0x311b83,_0x54ca39){const _0x45c911=a0_0x43e425;_0x311b83[_0x45c911(0x20e)][_0x45c911(0x237)](_0x45c911(0x2db));const _0x1f3c59='\x22'+PIP_EXE+_0x45c911(0x1c2)+_0x54ca39+'\x22';exec(_0x1f3c59,(_0x361810,_0x437e57,_0x51e752)=>{const _0x1198e8=_0x45c911;_0x311b83['dependencyInstallInProgress']=![],_0x361810?_0x311b83['log'][_0x1198e8(0x2ca)](_0x1198e8(0x1db)+(_0x51e752||_0x361810[_0x1198e8(0x3b1)])):(_0x311b83['log'][_0x1198e8(0x237)](_0x1198e8(0x1a5)),startPythonService(_0x311b83));});}function sendToPython(_0x7b41a6,_0x19aec6,_0x4280ec={}){const _0x39ab18=a0_0x43e425;if(!_0x7b41a6[_0x39ab18(0x344)]||!_0x7b41a6[_0x39ab18(0x344)][_0x39ab18(0x361)][_0x39ab18(0x317)])return;const _0x169eca=JSON[_0x39ab18(0x23c)]({'command':_0x19aec6,..._0x4280ec});try{_0x7b41a6[_0x39ab18(0x344)][_0x39ab18(0x361)][_0x39ab18(0x389)](_0x169eca+'\x0a');}catch(_0xb9acc){_0x7b41a6[_0x39ab18(0x20e)][_0x39ab18(0x2ca)](_0x39ab18(0x1b2)+_0xb9acc['message']);}}function runPythonHealthCheck(_0x4d0cd0){const _0x5b6e93=a0_0x43e425;if(!_0x4d0cd0[_0x5b6e93(0x259)]||_0x4d0cd0[_0x5b6e93(0x259)][_0x5b6e93(0x36f)]<0x2)return;const _0x2ba42f=_0x4d0cd0['dailyDigests'][_0x5b6e93(0x305)](_0x271c16=>{const _0x596f04=_0x5b6e93,_0x270c4d=(_0x271c16['activityLevel']||'')[_0x596f04(0x195)]();return ACTIVITY_LEVEL_MAP[_0x270c4d]||0x32;});_0x4d0cd0[_0x5b6e93(0x20e)]['info'](_0x5b6e93(0x1cf)+_0x2ba42f[_0x5b6e93(0x36f)]+_0x5b6e93(0x38b)),sendToPython(_0x4d0cd0,'ANALYZE_TREND',{'values':_0x2ba42f,'tag':_0x5b6e93(0x350)});}function handlePythonResult(_0x452b9c,_0x3ba5ce){const _0x4c6c22=a0_0x43e425;if(_0x3ba5ce['type']===_0x4c6c22(0x28b))_0x452b9c[_0x4c6c22(0x20e)][_0x4c6c22(0x251)](_0x4c6c22(0x34b));else{if(_0x3ba5ce['type']===_0x4c6c22(0x367)){const {tag:_0x14dbb7,diagnosis:_0x3b33e7,change_percent:_0x5c422d}=_0x3ba5ce[_0x4c6c22(0x291)];_0x452b9c[_0x4c6c22(0x20e)][_0x4c6c22(0x237)](_0x4c6c22(0x2ea)+_0x14dbb7+_0x4c6c22(0x3b4)+_0x3b33e7+'\x20('+_0x5c422d+'%)'),_0x452b9c[_0x4c6c22(0x2c7)]('analysis.health.trendDiagnosis',{'val':_0x3b33e7,'ack':!![]}),_0x452b9c[_0x4c6c22(0x2c7)](_0x4c6c22(0x1c5),{'val':_0x5c422d,'ack':!![]});}else{if(_0x3ba5ce[_0x4c6c22(0x34d)]===_0x4c6c22(0x376)){const {success:_0x5c77fd,details:_0x2f89bc}=_0x3ba5ce['payload'];_0x5c77fd?(_0x452b9c['log'][_0x4c6c22(0x237)](_0x4c6c22(0x25e)+_0x2f89bc),_0x452b9c['setStateAsync'](_0x4c6c22(0x2e5),{'val':_0x4c6c22(0x1a8)+new Date()['toLocaleTimeString']()+'\x20('+_0x2f89bc+')','ack':!![]})):(_0x452b9c[_0x4c6c22(0x20e)][_0x4c6c22(0x2ca)](_0x4c6c22(0x2a3)+(_0x2f89bc||_0x4c6c22(0x2b5))),_0x452b9c[_0x4c6c22(0x2c7)](_0x4c6c22(0x2e5),{'val':'Failed:\x20'+_0x2f89bc,'ack':!![]}));}else{if(_0x3ba5ce[_0x4c6c22(0x34d)]==='HEALTH_TRAIN_RESULT'){const {success:_0x25aeeb,details:_0x5ae11b}=_0x3ba5ce[_0x4c6c22(0x291)];if(_0x25aeeb)_0x452b9c[_0x4c6c22(0x20e)]['info'](_0x4c6c22(0x1cd)+_0x5ae11b);else _0x452b9c[_0x4c6c22(0x20e)][_0x4c6c22(0x2ca)](_0x4c6c22(0x1d4)+_0x5ae11b);}else{if(_0x3ba5ce['type']===_0x4c6c22(0x2a5)){const {is_anomaly:_0x2e0f73,details:_0x5e323d}=_0x3ba5ce[_0x4c6c22(0x291)];_0x452b9c[_0x4c6c22(0x2c7)](_0x4c6c22(0x2b1),{'val':new Date()[_0x4c6c22(0x300)](),'ack':!![]}),_0x452b9c[_0x4c6c22(0x2c7)](_0x4c6c22(0x3a4),{'val':_0x2e0f73,'ack':!![]});if(_0x2e0f73)_0x452b9c[_0x4c6c22(0x20e)][_0x4c6c22(0x1b9)](_0x4c6c22(0x332)+_0x5e323d);}else{if(_0x3ba5ce[_0x4c6c22(0x34d)]===_0x4c6c22(0x3ac)){const {success:_0x4d25b7,details:_0x42f718}=_0x3ba5ce[_0x4c6c22(0x291)];if(_0x4d25b7){_0x452b9c[_0x4c6c22(0x20e)][_0x4c6c22(0x237)]('‚úÖ\x20ENERGY\x20MODEL\x20TRAINED!');try{const _0x2703f8=JSON[_0x4c6c22(0x227)](_0x42f718);if(_0x2703f8['insulation'])_0x452b9c[_0x4c6c22(0x2c7)](_0x4c6c22(0x1b7),{'val':JSON['stringify'](_0x2703f8[_0x4c6c22(0x385)]),'ack':!![]});if(_0x2703f8[_0x4c6c22(0x2bc)])_0x452b9c[_0x4c6c22(0x2c7)](_0x4c6c22(0x1bd),{'val':JSON[_0x4c6c22(0x23c)](_0x2703f8[_0x4c6c22(0x2bc)]),'ack':!![]});}catch(_0x2dd0c9){_0x452b9c[_0x4c6c22(0x20e)][_0x4c6c22(0x2ca)](_0x4c6c22(0x27b)+_0x2dd0c9[_0x4c6c22(0x3b1)]);}}else _0x452b9c['log'][_0x4c6c22(0x2ca)]('‚ùå\x20Energy\x20Training\x20Failed:\x20'+_0x42f718);}else{if(_0x3ba5ce[_0x4c6c22(0x34d)]===_0x4c6c22(0x38c)){const {anomaly_score:_0x22bb7e,is_anomaly:_0x3c1b7d,threshold:_0x38638b}=_0x3ba5ce[_0x4c6c22(0x291)];_0x452b9c[_0x4c6c22(0x20e)][_0x4c6c22(0x237)](_0x4c6c22(0x29c)+_0x22bb7e[_0x4c6c22(0x35f)](0x5)+_0x4c6c22(0x1c4)+_0x38638b+')\x20->\x20'+(_0x3c1b7d?_0x4c6c22(0x391):'OK')),_0x452b9c[_0x4c6c22(0x2c7)]('analysis.security.lastScore',{'val':_0x22bb7e,'ack':!![]}),_0x452b9c['setStateAsync']('analysis.security.lastCheck',{'val':new Date()['toISOString'](),'ack':!![]});if(_0x3c1b7d){const _0x15d40a=_0x4c6c22(0x1cb)+_0x22bb7e['toFixed'](0x4)+')';_0x452b9c[_0x4c6c22(0x2c7)](_0x4c6c22(0x3b8),{'val':!![],'ack':!![]}),_0x452b9c[_0x4c6c22(0x2c7)](_0x4c6c22(0x18e),{'val':_0x15d40a,'ack':!![]}),sendNotification(_0x452b9c,_0x4c6c22(0x2c1)+_0x15d40a,![],!![]);}}}}}}}}}function startPythonService(_0x176c8c){const _0x4ad324=a0_0x43e425;let _0x306de4=_0x4ad324(0x1ed);if(fs[_0x4ad324(0x27c)](PYTHON_EXE))_0x176c8c[_0x4ad324(0x20e)][_0x4ad324(0x237)](_0x4ad324(0x3bb)+PYTHON_EXE),_0x306de4=PYTHON_EXE;else{_0x176c8c[_0x4ad324(0x20e)][_0x4ad324(0x1b9)]('‚ö†Ô∏è\x20VENV\x20not\x20found.\x20Falling\x20back\x20to\x20system\x20python3\x20(RISKY).');if(!_0x176c8c['dependencyInstallInProgress'])installPythonDependencies(_0x176c8c);}try{const _0x4cfb46=path[_0x4ad324(0x2c9)](__dirname,_0x4ad324(0x3c9),_0x4ad324(0x2f3));_0x176c8c['pythonProcess']=spawn(_0x306de4,[_0x4cfb46]),_0x176c8c['pythonProcess']['stdout']['on'](_0x4ad324(0x254),_0x4075a8=>{const _0x3fe57a=_0x4ad324,_0x368f25=_0x4075a8[_0x3fe57a(0x2a8)]()[_0x3fe57a(0x1a6)]('\x0a');_0x368f25[_0x3fe57a(0x368)](_0x6167cc=>{const _0x2b0c1d=_0x3fe57a,_0x4543bd=_0x6167cc[_0x2b0c1d(0x257)]();if(!_0x4543bd)return;if(_0x4543bd[_0x2b0c1d(0x315)](_0x2b0c1d(0x235)))_0x176c8c['log'][_0x2b0c1d(0x251)](_0x2b0c1d(0x32d)+_0x4543bd[_0x2b0c1d(0x220)](0x5)['trim']());else{if(_0x4543bd[_0x2b0c1d(0x315)](_0x2b0c1d(0x226)))try{const _0x2483f7=JSON[_0x2b0c1d(0x227)](_0x4543bd[_0x2b0c1d(0x220)](0x8)[_0x2b0c1d(0x257)]());handlePythonResult(_0x176c8c,_0x2483f7);}catch(_0x5d6755){_0x176c8c[_0x2b0c1d(0x20e)][_0x2b0c1d(0x1b9)](_0x2b0c1d(0x2b8)+_0x4543bd);}}(_0x4543bd[_0x2b0c1d(0x364)](_0x2b0c1d(0x2e6))||_0x4543bd[_0x2b0c1d(0x364)](_0x2b0c1d(0x387)))&&(_0x176c8c['log']['warn'](_0x2b0c1d(0x2a1)),installPythonDependencies(_0x176c8c));});}),_0x176c8c['pythonProcess'][_0x4ad324(0x281)]['on'](_0x4ad324(0x254),_0x55ca46=>{const _0x54d806=_0x4ad324,_0x2ed111=_0x55ca46[_0x54d806(0x2a8)]()[_0x54d806(0x257)]();!_0x2ed111[_0x54d806(0x364)](_0x54d806(0x21f))&&_0x176c8c['log'][_0x54d806(0x2ca)](_0x54d806(0x3ad)+_0x2ed111);}),_0x176c8c[_0x4ad324(0x344)]['on'](_0x4ad324(0x1e7),_0xda5044=>{const _0x3a698e=_0x4ad324;_0x176c8c[_0x3a698e(0x20e)][_0x3a698e(0x237)](_0x3a698e(0x276)+_0xda5044),_0x176c8c['pythonProcess']=null;}),_0x176c8c[_0x4ad324(0x344)]['on'](_0x4ad324(0x2ca),_0x23d305=>{const _0x29ec8c=_0x4ad324;_0x176c8c[_0x29ec8c(0x20e)][_0x29ec8c(0x1b9)](_0x29ec8c(0x28c)+_0x23d305[_0x29ec8c(0x3b1)]);});}catch(_0x2c0cf8){_0x176c8c[_0x4ad324(0x20e)]['error'](_0x4ad324(0x39f)+_0x2c0cf8[_0x4ad324(0x3b1)]);}}function stopPythonService(_0x510f6d){const _0x229459=a0_0x43e425;if(_0x510f6d[_0x229459(0x344)]){_0x510f6d[_0x229459(0x20e)][_0x229459(0x237)](_0x229459(0x33b));try{_0x510f6d[_0x229459(0x344)][_0x229459(0x2fd)]();}catch(_0x2b61b1){_0x510f6d[_0x229459(0x20e)][_0x229459(0x1b9)](_0x229459(0x232)+_0x2b61b1[_0x229459(0x3b1)]);}_0x510f6d['pythonProcess']=null;}}class CogniLiving extends utils[a0_0x43e425(0x308)]{constructor(_0x18468a){const _0x27ee12=a0_0x43e425;super({..._0x18468a,'name':_0x27ee12(0x1d7)}),this[_0x27ee12(0x35b)]=[],this[_0x27ee12(0x399)]=[],this[_0x27ee12(0x22e)]=[],this[_0x27ee12(0x297)]=[],this['dailyDigests']=[],this[_0x27ee12(0x312)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x27ee12(0x198)]=!![],this[_0x27ee12(0x2d9)]=null,this['exitGraceTimer']=null,this[_0x27ee12(0x2bb)]=![],this['genAI']=null,this[_0x27ee12(0x22d)]=null,this[_0x27ee12(0x21a)]=SYSTEM_MODES['NORMAL'],this[_0x27ee12(0x203)]=![],this[_0x27ee12(0x372)]=![],this[_0x27ee12(0x243)]=_0x27ee12(0x28d),this[_0x27ee12(0x20a)]=null,this[_0x27ee12(0x2dd)]=null,this[_0x27ee12(0x218)]=null,this[_0x27ee12(0x2af)]=null,this[_0x27ee12(0x1e9)]=null,this[_0x27ee12(0x344)]=null,this['dependencyInstallInProgress']=![],this['on']('ready',this[_0x27ee12(0x37b)][_0x27ee12(0x358)](this)),this['on'](_0x27ee12(0x2ae),this[_0x27ee12(0x386)][_0x27ee12(0x358)](this)),this['on'](_0x27ee12(0x311),this['onUnload'][_0x27ee12(0x358)](this)),this['on'](_0x27ee12(0x3b1),this[_0x27ee12(0x28f)][_0x27ee12(0x358)](this));}async[a0_0x43e425(0x37b)](){const _0x219f7e=a0_0x43e425;this[_0x219f7e(0x20e)][_0x219f7e(0x237)](_0x219f7e(0x19d)+this['version']+')'),await initZombies(this),this['config'][_0x219f7e(0x3c6)]=this['config'][_0x219f7e(0x3c6)]||'';try{this['isProVersion']=await checkLicense(this,this['config'][_0x219f7e(0x3c6)]);}catch(_0x589ba5){}if(!this[_0x219f7e(0x278)][_0x219f7e(0x1d1)]||this[_0x219f7e(0x278)][_0x219f7e(0x1d1)]<0.1)this[_0x219f7e(0x278)][_0x219f7e(0x1d1)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x219f7e(0x278)]['geminiApiKey'])try{this['genAI']=new GoogleGenerativeAI(this[_0x219f7e(0x278)]['geminiApiKey']),this[_0x219f7e(0x22d)]=this[_0x219f7e(0x239)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x219f7e(0x19e)}}),this['log'][_0x219f7e(0x237)]('Gemini\x20AI\x20initialized.');}catch(_0x5ecdc5){this[_0x219f7e(0x20e)][_0x219f7e(0x2ca)](_0x219f7e(0x1d0)+_0x5ecdc5[_0x219f7e(0x3b1)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x219f7e(0x2a2)](_0x219f7e(0x3ab)),this[_0x219f7e(0x2a2)](LTM_DP_TRIGGER_DIGEST),this[_0x219f7e(0x2a2)](_0x219f7e(0x36a)),this[_0x219f7e(0x2a2)](_0x219f7e(0x1ad)),this[_0x219f7e(0x2a2)](_0x219f7e(0x335)),this['subscribeStates'](_0x219f7e(0x1e5)),this[_0x219f7e(0x2a2)](_0x219f7e(0x249)),this[_0x219f7e(0x2a2)](_0x219f7e(0x2cd)),this[_0x219f7e(0x2a2)](_0x219f7e(0x36c)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0x219f7e(0x20a)]);const _0x21cfc9=this[_0x219f7e(0x278)][_0x219f7e(0x25d)]||0xf;_0x21cfc9>0x0&&(this[_0x219f7e(0x20a)]=setInterval(()=>{runAutopilot(this);},_0x21cfc9*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x3b63ca=_0x219f7e;if(this[_0x3b63ca(0x344)])runPythonHealthCheck(this);},0x1388);}[a0_0x43e425(0x38a)](_0x158ef1){const _0xbe1974=a0_0x43e425;if(this[_0xbe1974(0x20a)])clearInterval(this[_0xbe1974(0x20a)]);if(this[_0xbe1974(0x2af)])clearInterval(this[_0xbe1974(0x2af)]);if(this['ltmJob'])this[_0xbe1974(0x2dd)][_0xbe1974(0x20b)]();if(this[_0xbe1974(0x218)])this[_0xbe1974(0x218)][_0xbe1974(0x20b)]();if(this[_0xbe1974(0x1e9)])this[_0xbe1974(0x1e9)][_0xbe1974(0x20b)]();if(this['exitTimer'])clearTimeout(this[_0xbe1974(0x2d9)]);if(this[_0xbe1974(0x1a2)])clearTimeout(this[_0xbe1974(0x1a2)]);stopPythonService(this),_0x158ef1();}async[a0_0x43e425(0x386)](_0x43b85f,_0xcb6ef7){const _0x2e4ce8=a0_0x43e425;if(!_0xcb6ef7)return;if(_0x43b85f['includes']('telegram')&&_0x43b85f[_0x2e4ce8(0x36e)](_0x2e4ce8(0x298))&&_0xcb6ef7[_0x2e4ce8(0x28e)]){await handleTelegramResponse(this,_0xcb6ef7['val']);return;}if(_0x43b85f===this[_0x2e4ce8(0x356)]+'.'+SYSTEM_DP_MODE){if(_0xcb6ef7[_0x2e4ce8(0x28e)]&&Object['values'](SYSTEM_MODES)[_0x2e4ce8(0x364)](_0xcb6ef7[_0x2e4ce8(0x28e)])){this[_0x2e4ce8(0x21a)]=_0xcb6ef7['val'];if(_0xcb6ef7[_0x2e4ce8(0x28e)]===SYSTEM_MODES[_0x2e4ce8(0x1ee)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0xcb6ef7['ack'])this[_0x2e4ce8(0x341)](_0x43b85f,{'val':this[_0x2e4ce8(0x21a)],'ack':!![]});return;}if(!_0xcb6ef7[_0x2e4ce8(0x3ca)]){_0x43b85f[_0x2e4ce8(0x364)](_0x2e4ce8(0x3ab))&&_0xcb6ef7[_0x2e4ce8(0x28e)]&&(this[_0x2e4ce8(0x341)](_0x43b85f,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x43b85f[_0x2e4ce8(0x364)](_0x2e4ce8(0x3c0))&&_0xcb6ef7[_0x2e4ce8(0x28e)]){this[_0x2e4ce8(0x341)](_0x43b85f,{'val':![],'ack':!![]});if(this[_0x2e4ce8(0x203)])createDailyDigest(this);}_0x43b85f[_0x2e4ce8(0x364)](_0x2e4ce8(0x2b4))&&_0xcb6ef7[_0x2e4ce8(0x28e)]&&(this[_0x2e4ce8(0x341)](_0x43b85f,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x43b85f[_0x2e4ce8(0x364)](_0x2e4ce8(0x280))&&_0xcb6ef7[_0x2e4ce8(0x28e)]&&(this[_0x2e4ce8(0x341)](_0x43b85f,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x43b85f['includes']('analysis.training.triggerSecurity')&&_0xcb6ef7[_0x2e4ce8(0x28e)]){this[_0x2e4ce8(0x341)](_0x43b85f,{'val':![],'ack':!![]});if(!this[_0x2e4ce8(0x203)])return;try{const _0x4d167f=await this[_0x2e4ce8(0x34e)]('LTM.trainingData.sequences');if(_0x4d167f&&_0x4d167f[_0x2e4ce8(0x28e)]){const _0x5e8f94=JSON[_0x2e4ce8(0x227)](_0x4d167f['val']);this[_0x2e4ce8(0x20e)][_0x2e4ce8(0x237)]('üß†\x20Triggering\x20Security\x20Training...'),this[_0x2e4ce8(0x2c7)]('analysis.training.status',{'val':_0x2e4ce8(0x2eb),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x5e8f94});}}catch(_0x4ed6a2){this[_0x2e4ce8(0x20e)][_0x2e4ce8(0x2ca)](_0x2e4ce8(0x3c7)+_0x4ed6a2[_0x2e4ce8(0x3b1)]);}}if(_0x43b85f[_0x2e4ce8(0x364)](_0x2e4ce8(0x2cd))&&_0xcb6ef7['val']){this[_0x2e4ce8(0x341)](_0x43b85f,{'val':![],'ack':!![]});if(!this[_0x2e4ce8(0x203)])return;try{const _0x218471=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x218471&&_0x218471[_0x2e4ce8(0x28e)]){const _0x32b48e=JSON[_0x2e4ce8(0x227)](_0x218471[_0x2e4ce8(0x28e)]);this['log'][_0x2e4ce8(0x237)](_0x2e4ce8(0x256)),sendToPython(this,_0x2e4ce8(0x188),{'digests':_0x32b48e});}}catch(_0x55f444){this[_0x2e4ce8(0x20e)][_0x2e4ce8(0x2ca)]('Health\x20Train\x20Error:\x20'+_0x55f444[_0x2e4ce8(0x3b1)]);}}if(_0x43b85f[_0x2e4ce8(0x364)](_0x2e4ce8(0x36c))&&_0xcb6ef7[_0x2e4ce8(0x28e)]){this[_0x2e4ce8(0x341)](_0x43b85f,{'val':![],'ack':!![]});if(!this[_0x2e4ce8(0x203)])return;try{const _0x3a1088=await this[_0x2e4ce8(0x34e)](_0x2e4ce8(0x31e));if(_0x3a1088&&_0x3a1088[_0x2e4ce8(0x28e)]){const _0x2837cd=JSON['parse'](_0x3a1088[_0x2e4ce8(0x28e)]);this[_0x2e4ce8(0x20e)]['info']('üçÉ\x20Triggering\x20Energy\x20Training...'),sendToPython(this,_0x2e4ce8(0x23f),{'points':_0x2837cd});}}catch(_0x3d1ab6){this[_0x2e4ce8(0x20e)][_0x2e4ce8(0x2ca)](_0x2e4ce8(0x32e)+_0x3d1ab6['message']);}}return;}if(this[_0x2e4ce8(0x278)][_0x2e4ce8(0x371)]&&this[_0x2e4ce8(0x278)]['presenceDevices'][_0x2e4ce8(0x364)](_0x43b85f)){await checkWifiPresence(this);return;}const _0x2d5f83=(this['config'][_0x2e4ce8(0x2f6)]||[])[_0x2e4ce8(0x1a3)](_0x3f52d5=>_0x3f52d5['id']===_0x43b85f);if(_0x2d5f83)processSensorEvent(this,_0x43b85f,_0xcb6ef7,_0x2d5f83);}async[a0_0x43e425(0x28f)](_0x505e02){const _0x2cf4ee=a0_0x43e425;if(typeof _0x505e02===_0x2cf4ee(0x1ec)&&_0x505e02['message'])try{if(_0x505e02[_0x2cf4ee(0x3b0)]===_0x2cf4ee(0x1ca)){const _0x26726b=_0x505e02['message']['apiKey']||this[_0x2cf4ee(0x278)][_0x2cf4ee(0x1e3)];if(!_0x26726b)return this[_0x2cf4ee(0x3af)](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02[_0x2cf4ee(0x3b0)],{'success':![],'message':'Kein\x20API\x20Key\x20eingegeben.'},_0x505e02[_0x2cf4ee(0x1af)]);try{const _0x10e6b5=new GoogleGenerativeAI(_0x26726b),_0x4e03e3=_0x10e6b5['getGenerativeModel']({'model':GEMINI_MODEL}),_0x272dce=await _0x4e03e3[_0x2cf4ee(0x378)](_0x2cf4ee(0x2c4)),_0x17a149=await _0x272dce[_0x2cf4ee(0x194)],_0x1b297f=_0x17a149[_0x2cf4ee(0x3bf)]();this[_0x2cf4ee(0x3af)](_0x505e02['from'],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![],'message':_0x2cf4ee(0x2e4)+_0x1b297f[_0x2cf4ee(0x220)](0x0,0x14)+_0x2cf4ee(0x3a5)},_0x505e02['callback']);}catch(_0x42160c){this[_0x2cf4ee(0x3af)](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02['command'],{'success':![],'message':'Fehler:\x20'+_0x42160c['message']},_0x505e02[_0x2cf4ee(0x1af)]);}}else{if(_0x505e02[_0x2cf4ee(0x3b0)]===_0x2cf4ee(0x2c6)){const _0x3a4159=await getWeatherContext(this),_0xb788f0=await getCalendarContext(this);this[_0x2cf4ee(0x3af)](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![],'weather':_0x3a4159,'calendar':_0xb788f0},_0x505e02[_0x2cf4ee(0x1af)]);}else{if(_0x505e02[_0x2cf4ee(0x3b0)]===_0x2cf4ee(0x352)){}else{if(_0x505e02['command']===_0x2cf4ee(0x34f)){if(!this[_0x2cf4ee(0x203)])return this[_0x2cf4ee(0x3af)](_0x505e02['from'],_0x505e02[_0x2cf4ee(0x3b0)],{'success':![],'isPro':![]},_0x505e02[_0x2cf4ee(0x1af)]);let _0x73075a={'status':_0x2cf4ee(0x1f7),'details':'','lastCheck':0x0};try{_0x73075a['status']=(await this[_0x2cf4ee(0x34e)](LTM_DP_DRIFT_STATUS))[_0x2cf4ee(0x28e)],_0x73075a[_0x2cf4ee(0x275)]=(await this[_0x2cf4ee(0x34e)](LTM_DP_DRIFT_DETAILS))[_0x2cf4ee(0x28e)],_0x73075a[_0x2cf4ee(0x21e)]=(await this[_0x2cf4ee(0x34e)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x483ed6){}const _0x4ae0b2=this[_0x2cf4ee(0x399)]||[];this[_0x2cf4ee(0x3af)](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x73075a,'analysisHistory':_0x4ae0b2},_0x505e02[_0x2cf4ee(0x1af)]);}else{if(_0x505e02[_0x2cf4ee(0x3b0)]===_0x2cf4ee(0x1c1)){const _0x2a9ab0=this[_0x2cf4ee(0x259)][_0x2cf4ee(0x36f)],_0x1415f2=new Date(),_0x2f35f0=new Date(_0x1415f2[_0x2cf4ee(0x35d)](),_0x1415f2[_0x2cf4ee(0x260)](),_0x1415f2[_0x2cf4ee(0x1e6)]())[_0x2cf4ee(0x2e2)](),_0x34e44d=this[_0x2cf4ee(0x297)]['filter'](_0xb12881=>new Date(_0xb12881[_0x2cf4ee(0x2e7)])['getTime']()>_0x2f35f0)[_0x2cf4ee(0x36f)],_0x3cf99d=new Array(0x18)[_0x2cf4ee(0x307)](0x0);this['rawEventLog'][_0x2cf4ee(0x368)](_0x4238d4=>{const _0xb09d35=_0x2cf4ee,_0xb3f786=new Date(_0x4238d4[_0xb09d35(0x2e7)]);if(_0xb3f786['getTime']()>_0x2f35f0)_0x3cf99d[_0xb3f786[_0xb09d35(0x32b)]()]++;});let _0x523f32={'status':'N/A'};try{_0x523f32[_0x2cf4ee(0x324)]=(await this[_0x2cf4ee(0x34e)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x44737f){}let _0x269fe7='';try{const _0x414ff2=await this[_0x2cf4ee(0x34e)]('system.presenceWho');_0x269fe7=_0x414ff2?_0x414ff2[_0x2cf4ee(0x28e)]:'';}catch(_0x1aaeda){}let _0x51bfbe=null;!this[_0x2cf4ee(0x22d)]&&(_0x51bfbe=this[_0x2cf4ee(0x278)][_0x2cf4ee(0x1e3)]?_0x2cf4ee(0x3be):'Kein\x20API\x20Key!');let _0x25ea43={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x11264e=await this[_0x2cf4ee(0x34e)](_0x2cf4ee(0x1c3)),_0x2a7173=await this[_0x2cf4ee(0x34e)]('analysis.automation.description'),_0x258ca3=await this[_0x2cf4ee(0x34e)](_0x2cf4ee(0x2e9)),_0x209a45=await this[_0x2cf4ee(0x34e)](_0x2cf4ee(0x252)),_0x424a6a=await this['getStateAsync'](_0x2cf4ee(0x1e5));_0x11264e&&_0x11264e[_0x2cf4ee(0x28e)]&&(_0x25ea43[_0x2cf4ee(0x229)]=!![],_0x25ea43[_0x2cf4ee(0x302)]=_0x2a7173?_0x2a7173[_0x2cf4ee(0x28e)]:'',_0x25ea43[_0x2cf4ee(0x327)]=_0x258ca3?_0x258ca3[_0x2cf4ee(0x28e)]:'',_0x25ea43['targetValue']=_0x209a45?_0x209a45[_0x2cf4ee(0x28e)]:''),_0x25ea43['autoApply']=_0x424a6a?!!_0x424a6a[_0x2cf4ee(0x28e)]:![];}catch(_0x13cbdc){}this[_0x2cf4ee(0x3af)](_0x505e02['from'],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![],'eventHistory':this[_0x2cf4ee(0x35b)][_0x2cf4ee(0x2ad)](0x0,0xf),'stats':{'digestCount':_0x2a9ab0,'eventCountToday':_0x34e44d,'hourlyActivity':_0x3cf99d,'driftStatus':_0x523f32['status'],'isPresent':this[_0x2cf4ee(0x198)],'presenceWho':_0x269fe7,'minDays':this['config'][_0x2cf4ee(0x1b8)]||0x7,'stbDays':this[_0x2cf4ee(0x278)][_0x2cf4ee(0x37e)]||0xe,'ltbDays':this[_0x2cf4ee(0x278)][_0x2cf4ee(0x285)]||0x3c,'systemError':_0x51bfbe},'automation':_0x25ea43},_0x505e02[_0x2cf4ee(0x1af)]);}else{if(_0x505e02[_0x2cf4ee(0x3b0)]==='getEnums'){const _0x8c3201=await this['getForeignObjectsAsync'](_0x2cf4ee(0x18b),_0x2cf4ee(0x34c)),_0x478d06=[];if(_0x8c3201)for(const _0x4901f2 in _0x8c3201){const _0x5bd037=_0x8c3201[_0x4901f2],_0x427f8d=(_0x5bd037[_0x2cf4ee(0x238)]&&typeof _0x5bd037[_0x2cf4ee(0x238)][_0x2cf4ee(0x245)]===_0x2cf4ee(0x1ec)?_0x5bd037[_0x2cf4ee(0x238)][_0x2cf4ee(0x245)]['de']:_0x5bd037[_0x2cf4ee(0x238)][_0x2cf4ee(0x245)])||_0x5bd037[_0x2cf4ee(0x238)][_0x2cf4ee(0x245)];_0x478d06[_0x2cf4ee(0x328)]({'id':_0x4901f2,'name':_0x427f8d});}this[_0x2cf4ee(0x3af)](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![],'enums':_0x478d06},_0x505e02[_0x2cf4ee(0x1af)]);}else{if(_0x505e02[_0x2cf4ee(0x3b0)]===_0x2cf4ee(0x35c))try{const _0x2f8ded=await scanForDevices(this,_0x505e02[_0x2cf4ee(0x3b1)]||{});this['sendTo'](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![],'devices':_0x2f8ded},_0x505e02[_0x2cf4ee(0x1af)]);}catch(_0x3c09a5){this['sendTo'](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02['command'],{'success':![],'error':_0x3c09a5[_0x2cf4ee(0x3b1)]},_0x505e02['callback']);}else{if(_0x505e02[_0x2cf4ee(0x3b0)]==='getCalendarNames'){const _0x5d8546=_0x505e02[_0x2cf4ee(0x3b1)][_0x2cf4ee(0x250)];if(!_0x5d8546)return this[_0x2cf4ee(0x3af)](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02['command'],{'success':![],'error':_0x2cf4ee(0x3a0)},_0x505e02[_0x2cf4ee(0x1af)]);const _0x2673cd=await getCalendarNames(this,_0x5d8546);this[_0x2cf4ee(0x3af)](_0x505e02['from'],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![],'names':_0x2673cd},_0x505e02['callback']);}else{if(_0x505e02[_0x2cf4ee(0x3b0)]===_0x2cf4ee(0x1f8)){const {targetId:_0x2ab6f1,targetValue:_0x40b4fb}=_0x505e02[_0x2cf4ee(0x3b1)];this[_0x2cf4ee(0x20e)][_0x2cf4ee(0x237)](_0x2cf4ee(0x269)+_0x2ab6f1+'\x20=\x20'+_0x40b4fb),await this[_0x2cf4ee(0x2c7)](_0x2cf4ee(0x1c3),{'val':!![],'ack':!![]}),await this[_0x2cf4ee(0x2c7)](_0x2cf4ee(0x3c2),{'val':_0x2cf4ee(0x25a)+_0x2ab6f1,'ack':!![]}),await this[_0x2cf4ee(0x2c7)](_0x2cf4ee(0x2e9),{'val':_0x2ab6f1,'ack':!![]}),await this['setStateAsync'](_0x2cf4ee(0x252),{'val':_0x40b4fb,'ack':!![]}),this[_0x2cf4ee(0x3af)](_0x505e02['from'],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![]},_0x505e02[_0x2cf4ee(0x1af)]);}else{if(_0x505e02[_0x2cf4ee(0x3b0)]==='submitFeedback'){const {historyId:_0x2c4fc1,rating:_0x4e735b,comment:_0x262ff0,alertReason:_0x4a61f0}=_0x505e02[_0x2cf4ee(0x3b1)];_0x2c4fc1&&_0x4e735b?(await saveFeedback(this,{'timestamp':Date[_0x2cf4ee(0x186)](),'historyId':_0x2c4fc1,'rating':_0x4e735b,'comment':_0x262ff0,'alertReason':_0x4a61f0}),this[_0x2cf4ee(0x3af)](_0x505e02['from'],_0x505e02['command'],{'success':!![]},_0x505e02[_0x2cf4ee(0x1af)])):this[_0x2cf4ee(0x3af)](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02['command'],{'success':![],'error':_0x2cf4ee(0x1ff)},_0x505e02['callback']);}else _0x505e02[_0x2cf4ee(0x3b0)]==='dismissAutomation'&&(this['log'][_0x2cf4ee(0x237)]('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x2cf4ee(0x1c3),{'val':![],'ack':!![]}),await this[_0x2cf4ee(0x2c7)](_0x2cf4ee(0x3c2),{'val':'','ack':!![]}),this['sendTo'](_0x505e02[_0x2cf4ee(0x2ba)],_0x505e02[_0x2cf4ee(0x3b0)],{'success':!![]},_0x505e02[_0x2cf4ee(0x1af)]));}}}}}}}}}}catch(_0x36e530){this[_0x2cf4ee(0x20e)][_0x2cf4ee(0x2ca)](_0x2cf4ee(0x2be)+_0x505e02[_0x2cf4ee(0x3b0)]+':\x20'+_0x36e530[_0x2cf4ee(0x3b1)]);if(_0x505e02[_0x2cf4ee(0x1af)])this[_0x2cf4ee(0x3af)](_0x505e02['from'],_0x505e02['command'],{'success':![],'error':_0x36e530[_0x2cf4ee(0x3b1)]},_0x505e02['callback']);}}}if(require[a0_0x43e425(0x282)]!==module)module[a0_0x43e425(0x360)]=_0x11946e=>new CogniLiving(_0x11946e);else new CogniLiving();