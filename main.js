const a0_0x444fb3=a0_0x435f;(function(_0x928565,_0x3089fb){const _0x22b985=a0_0x435f,_0xe1fd09=_0x928565();while(!![]){try{const _0x589289=parseInt(_0x22b985(0x1f0))/0x1+-parseInt(_0x22b985(0x257))/0x2+-parseInt(_0x22b985(0x367))/0x3*(-parseInt(_0x22b985(0x346))/0x4)+-parseInt(_0x22b985(0x27b))/0x5*(-parseInt(_0x22b985(0x250))/0x6)+-parseInt(_0x22b985(0x1ee))/0x7*(parseInt(_0x22b985(0x2a5))/0x8)+-parseInt(_0x22b985(0x332))/0x9+parseInt(_0x22b985(0x258))/0xa;if(_0x589289===_0x3089fb)break;else _0xe1fd09['push'](_0xe1fd09['shift']());}catch(_0x47ef4b){_0xe1fd09['push'](_0xe1fd09['shift']());}}}(a0_0x1cdf,0x8cb4c));function a0_0x1cdf(){const _0xfa4fb7=['isArray','sensor.window','initHistory','_calName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20','sendNotification','send','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','.Summary.Current','createAllObjects\x20failed:\x20','toFixed','Fehler:\x20','catch','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','getSystemUUID','genAI','loadDailyDigests','bewegung','SECTION','values','ERROR','2352602rhBHmS','analysis.history_debug_00','356354zpmENN','isEmergency','DUTYCYCLE','ERROR_CODE','events.history_debug_02','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','Starting\x20Autopilot\x20(','rawEventLog','analysis.lastResult','WETTER\x20ERROR:\x20','toUpperCase','analysis.health.restlessness','WETTER:\x20Keine\x20Daten\x20gefunden','ical.0','runGeminiAnalysis','schlaf','lastAlertState','Processing\x20Status','setupModeResetScheduler','Schlafzimmer','/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20','submitFeedback','onReady','firmware','unload','analysis.history_debug_03','runBaselineDriftAnalysis','DIRECTION','notifySignalInstance','notifySignalEnabled','notifyWhatsappEnabled','find','splice','filter','analysis.alertReason','testApiKey','LOWBAT','INSTALL_TEST','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','archetype','analysis.history_debug_01','state','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','isGracePeriodActive','version','generateContent','parse','resetAnalysisStates','SABOTAGE','summary','KALENDER:\x20Keine\x20relevanten\x20Termine','siren','onMessage','city','License\x20Check\x20failed:\x20','yr.','@google/generative-ai','notifyWhatsappRecipient','Adapter','UNREACH','dailyDigests','members','alertReason','accuweather.0','N/A\x20(Pro\x20Feature)','Analysis\x20Error:\x20','enum.rooms.*','briefingEnabled','setHours','calendarSelection','Baseline\x20Status','toString','occupancy','onStateChange','isProVersion','Error\x20initHistory:\x20','toLocaleString','uuid','weatherInstance','saveDailyDigests','getForeignObjectAsync','onUnload','setupBriefingScheduler','WEEK_PROGRAM','openweathermap.','status','Briefing\x20Error:\x20','analysisTimer','pop','lastCheck','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','scheduleJob','loadSystemMode\x20failed:\x20','command','vacation','time','6045246jLwHbN','N/A\x20(No\x20Activity)','AES_KEY','boolean','doors','devices','isAlert','861190bpomjX','5453260gwZeoC','icon','extendObjectAsync','\x20sensors...','\x20sent','checkLicense','daswetter.0','restlessness','Urlaub','tryParse','PRO-','driftAnalysisTimer','No\x20recent\x20activity.','RSSI','weatherunderground.0','battery','loadRawEventLog\x20failed:\x20','last\x20action','üö®üö®\x20NOTFALL','length','expire','useCalendar','reachable','analysis.isAlert','updateAnalysisHistory','unshift','logDuplicates','notifyPushoverInstance','N/A\x20(Learning)','Licht','scanDevices','generic','patternDetected','analysis.automation.patternDetected','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','5zNYqqL','\x22\x20was\x20','split','createAllObjects','ON_TIME','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','ALARM','notifyTelegramInstance','triggerBriefing','log','motion','.\x20PR√ÑSENZ:\x20','value.temperature','getWeatherContext','callback','icons-mfd.','getForeignObjectsAsync','setState','search','Normal','ltmStbWindowDays','events.history_debug_00','level.dimmer','0\x204\x20*\x20*\x20*','analysisInterval','common','analysis.automation.suggestedAction','garten','updateBaselineStatus','test','Daily\x20Digest\x20Error:\x20','griff','LTM.baselineStatus','includes','\x20*\x20*\x20*','write','Scheduling\x20Morning\x20Briefing\x20for\x20','setupDriftAnalysisScheduler','error','getCalendarNames','weatherunderground.','16oMieBR','Analysiere\x20Tag...','normal','cancel','saveFeedback','Kalender:\x20Deaktiviert','analysis.health.sleepScore','lights','object','.\x20PERSONA:\x20','getLtmData','Daily\x20Digest\x20created\x20successfully.','_score','history.','online','notifyPushoverEnabled','checkLtmObjects','briefingTime','openweathermap','isPresent','system.mode','sound','t√ºr','Briefing\x20Sched\x20Error:\x20','enum','\x20|\x20','LTM.driftAnalysis','fire','Gast','history','getObjectAsync','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','message','notifyTelegramRecipient','Raw\x20Log','geminiApiKey','analysis.isEmergency','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','events.history','join','[TEST]\x20','mac\x20address','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','LTM.dailyDigests','abortExitTimer','getCalendarContext','channel','sort','.NextHours.Location_1.Day_1.current.symbol_desc','accuweather.','Nein','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','Last\x20Check','0\x203\x20*\x20*\x20*','details','location','sendToAsync','Drift\x20Analysis','No\x20instance','Drift\x20Details','from','level','timestamp','\x0aFEEDBACK:\x0a','apiKey','longitude','activity','.data.table','‚ö†Ô∏è\x20Alarm','FAULT','[Test]\x20Notification','event','aiPersona','loadDailyDigests\x20failed:\x20','k√ºche','analysisHistory','Starting\x20Smart\x20Scan\x20with\x20filters:\x20','apply','analysis.analysisHistory','retry','health','namespace','map','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','native','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','node-schedule','Aktiv\x20(','name','scanForDevices','events.history_debug_03','2-digit','modeResetJob','long','setPresence','slice','saveRawEventLog','subscribeStates','weather','system.meta.uuid','trim','.forecast.current.state','replace','analysis.history_debug_02','LTM.processingStatus','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','notes','json','TEST-PRO-KEY','Daily\x20Digests','cogni-living','config','processSensorEvent','startsWith','some','notifyWhatsappInstance','flot.','minDaysForBaseline','Deaktiviert\x20(Pro-Feature)','sat','setStateAsync','geminiModel','bind','Reset\x20Sched\x20Error:\x20','sendMorningBriefing','checkWifiPresence','description','system.isPresent','analysis.history_debug_04','now','flur','testNotification','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','systemConfig','accuweather','Autopilot\x20error:\x20','startExitTimer','loadSystemMode','presenceDevices','Error\x20checking\x20WiFi:\x20','info','6930099NJCFJC','suggestion','System\x20Status\x20&\x20Control','sensor.motion','notifyEmailInstance','temperatur','uuid-not-found','Subscribing\x20to\x20','VIRTUAL_CHANNEL','useWeather','response','baselineDrift','\x20raw\x20events...','Cogni-Living\x20Alert','notifyEmailRecipient','Party','temp','WETTER:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','getGenerativeModel','2159556VYIKXE','sensorLastValues','javascript.0.script','VACATION','link_quality','uniqueid','Schalter/Licht','admin.','rauch','exports','guest','de-DE','detectionState','enum.functions.*','analysis.activitySummary','rating','(((.+)+)+)+$','analysis.deviationFromBaseline','N/A','comfort','runAutopilot','push','analysis.trigger','selectedFunctionIds','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','STICKY_UNREACH','Success','LTM\x20Sched\x20Error:\x20','getCalendarNames\x20Error:\x20','analysis.automation.description','toLowerCase','Missing\x20data','LTM','3UKBcip','haust√ºr','feedbackHistory','val','\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}','KALENDER\x20ERROR:\x20','material.','livingContext','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','Bewegung','sleepScore','party','setupLtmScheduler','suggestedAction','GUEST','checkLtmDriftObjects','last_seen','CONFIG_PENDING','string','exitGraceTimer','events.history_debug_04','getStateAsync','cogni-living\x20adapter\x20starting\x20(v','ltmDriftCheckIntervalHours','getForeignStateAsync','type','sendTo','text','Gemini\x20AI\x20initialized.','notifySignalRecipient','ltmJob','briefingJob','sensor.door','system.config','K√ºche','notifyTelegramEnabled','Temperatur','testContext','calendarInstance','Fenster/T√ºr','eventHistory','currentSystemMode','createDailyDigest','inactivityThresholdHours','Drift\x20Status','ready','models/gemini-flash-latest','NORMAL','LTM.driftAnalysis.baselineDrift','licenseKey','none','events.lastEvent','automationProposal','PROCESS','button','\x20presence\x20devices...','Baseline:\x20Inactive\x20(Pro\x20Feature).','COMBINED_PARAMETER','\x0a\x0aA\x20(STB):\x0a','stringify','PARTY','bad','role','shutter_contact','number','systemUUID','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','wohnungst√ºr','main','exitTimer','vis.','driftDetails','daswetter.','licht','constructor','manufacturer','date','scriptProblem','subscribeForeignStatesAsync','CONNECTION','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.\x20ORT:\x20','toISOString'];a0_0x1cdf=function(){return _0xfa4fb7;};return a0_0x1cdf();}const a0_0x4e653a=(function(){let _0x9c83f=!![];return function(_0x11304a,_0xc019c3){const _0x357c4c=_0x9c83f?function(){const _0x3171e5=a0_0x435f;if(_0xc019c3){const _0x3dd294=_0xc019c3[_0x3171e5(0x2f2)](_0x11304a,arguments);return _0xc019c3=null,_0x3dd294;}}:function(){};return _0x9c83f=![],_0x357c4c;};}()),a0_0x3f81b9=a0_0x4e653a(this,function(){const _0x22ab39=a0_0x435f;return a0_0x3f81b9[_0x22ab39(0x237)]()[_0x22ab39(0x28e)]('(((.+)+)+)+$')[_0x22ab39(0x237)]()[_0x22ab39(0x1d0)](a0_0x3f81b9)[_0x22ab39(0x28e)](_0x22ab39(0x356));});a0_0x3f81b9();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x444fb3(0x228)),schedule=require(a0_0x444fb3(0x2fb)),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x444fb3(0x2da),MODE_RESET_SCHEDULE=a0_0x444fb3(0x293),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x444fb3(0x2d0),LTM_DP_STATUS=a0_0x444fb3(0x30d),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x444fb3(0x29c),LTM_DP_DRIFT_CHANNEL=a0_0x444fb3(0x2bf),LTM_DP_DRIFT_STATUS=a0_0x444fb3(0x1b6),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x444fb3(0x2b9),SYSTEM_MODES={'NORMAL':a0_0x444fb3(0x2a7),'VACATION':a0_0x444fb3(0x24e),'PARTY':a0_0x444fb3(0x372),'GUEST':a0_0x444fb3(0x350)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x444fb3(0x1c2)],SYSTEM_MODES[a0_0x444fb3(0x375)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x444fb3(0x2d8),'senior_aal':a0_0x444fb3(0x280),'family':'Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','single_comfort':a0_0x444fb3(0x24a),'security':a0_0x444fb3(0x329)};class CogniLiving extends utils[a0_0x444fb3(0x22a)]{constructor(_0x3a8174){const _0x2c2d10=a0_0x444fb3;super({..._0x3a8174,'name':_0x2c2d10(0x313)}),this[_0x2c2d10(0x1ae)]=[],this[_0x2c2d10(0x2f0)]=[],this['feedbackHistory']=[],this[_0x2c2d10(0x1f7)]=[],this[_0x2c2d10(0x22c)]=[],this['sensorLastValues']={},this[_0x2c2d10(0x32a)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x2c2d10(0x1cb)]=null,this[_0x2c2d10(0x37a)]=null,this[_0x2c2d10(0x21b)]=![],this[_0x2c2d10(0x1e8)]=null,this[_0x2c2d10(0x31e)]=null,this[_0x2c2d10(0x1af)]=SYSTEM_MODES[_0x2c2d10(0x1b5)],this['isProVersion']=![],this[_0x2c2d10(0x200)]=![],this['systemUUID']='unknown',this['analysisTimer']=null,this[_0x2c2d10(0x1a4)]=null,this['modeResetJob']=null,this[_0x2c2d10(0x263)]=null,this[_0x2c2d10(0x1a5)]=null,this['on'](_0x2c2d10(0x1b3),this[_0x2c2d10(0x206)][_0x2c2d10(0x31f)](this)),this['on']('stateChange',this[_0x2c2d10(0x239)][_0x2c2d10(0x31f)](this)),this['on'](_0x2c2d10(0x208),this[_0x2c2d10(0x241)][_0x2c2d10(0x31f)](this)),this['on'](_0x2c2d10(0x2c5),this[_0x2c2d10(0x224)][_0x2c2d10(0x31f)](this));}async[a0_0x444fb3(0x206)](){const _0x5ebb14=a0_0x444fb3;this['log'][_0x5ebb14(0x331)](_0x5ebb14(0x19c)+this[_0x5ebb14(0x21c)]+')');try{const _0x472fe4=[_0x5ebb14(0x1ef),_0x5ebb14(0x218),_0x5ebb14(0x30c),_0x5ebb14(0x209),_0x5ebb14(0x325),_0x5ebb14(0x291),'events.history_debug_01',_0x5ebb14(0x1f4),_0x5ebb14(0x2ff),_0x5ebb14(0x37b)];for(const _0x310c33 of _0x472fe4){try{const _0x21d96c=await this[_0x5ebb14(0x2c3)](_0x310c33);_0x21d96c&&await this['delObjectAsync'](_0x310c33);}catch(_0x48a194){}}}catch(_0x306256){}this['config'][_0x5ebb14(0x1b7)]=this[_0x5ebb14(0x314)][_0x5ebb14(0x1b7)]||'';try{this[_0x5ebb14(0x23a)]=await this[_0x5ebb14(0x25d)](this[_0x5ebb14(0x314)]['licenseKey']);}catch(_0x5b592a){this[_0x5ebb14(0x285)][_0x5ebb14(0x2a2)](_0x5ebb14(0x226)+_0x5b592a[_0x5ebb14(0x2c5)]);}if(!this[_0x5ebb14(0x314)][_0x5ebb14(0x1b1)]||this[_0x5ebb14(0x314)]['inactivityThresholdHours']<0.1)this[_0x5ebb14(0x314)][_0x5ebb14(0x1b1)]=0xc;try{await this[_0x5ebb14(0x1db)]();}catch(_0xe1aa22){this['log']['error'](_0x5ebb14(0x23b)+_0xe1aa22[_0x5ebb14(0x2c5)]);}try{const _0x3ab9ce=await this[_0x5ebb14(0x240)](_0x5ebb14(0x1a7));_0x3ab9ce&&_0x3ab9ce[_0x5ebb14(0x295)]&&(this[_0x5ebb14(0x32a)]={'latitude':_0x3ab9ce[_0x5ebb14(0x295)]['latitude']||0x0,'longitude':_0x3ab9ce['common'][_0x5ebb14(0x2e6)]||0x0,'city':_0x3ab9ce[_0x5ebb14(0x295)][_0x5ebb14(0x225)]||''});}catch(_0x4947a8){}if(this[_0x5ebb14(0x314)][_0x5ebb14(0x2c8)])try{this[_0x5ebb14(0x1e8)]=new GoogleGenerativeAI(this[_0x5ebb14(0x314)][_0x5ebb14(0x2c8)]),this[_0x5ebb14(0x31e)]=this[_0x5ebb14(0x1e8)][_0x5ebb14(0x345)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x5ebb14(0x285)][_0x5ebb14(0x331)](_0x5ebb14(0x1a2));}catch(_0x540232){this[_0x5ebb14(0x285)][_0x5ebb14(0x2a2)]('Gemini\x20Init\x20Error:\x20'+_0x540232[_0x5ebb14(0x2c5)]);}try{await this[_0x5ebb14(0x27e)]();}catch(_0x13679f){this[_0x5ebb14(0x285)][_0x5ebb14(0x2a2)](_0x5ebb14(0x1e2)+_0x13679f['message']);}try{await this[_0x5ebb14(0x32e)]();}catch(_0x2c1975){this['log'][_0x5ebb14(0x2a2)](_0x5ebb14(0x24c)+_0x2c1975[_0x5ebb14(0x2c5)]);}try{await this['loadRawEventLog']();}catch(_0x673ae1){this['log']['error'](_0x5ebb14(0x268)+_0x673ae1['message']);}try{await this[_0x5ebb14(0x1e9)]();}catch(_0x4c561a){this[_0x5ebb14(0x285)][_0x5ebb14(0x2a2)](_0x5ebb14(0x2ee)+_0x4c561a[_0x5ebb14(0x2c5)]);}this['subscribeStates'](_0x5ebb14(0x35c)),this[_0x5ebb14(0x306)](LTM_DP_TRIGGER_DIGEST),this[_0x5ebb14(0x306)](_0x5ebb14(0x2b9)),this['subscribeStates']('analysis.triggerBriefing');const _0x372df5=this[_0x5ebb14(0x314)][_0x5ebb14(0x255)];if(_0x372df5&&_0x372df5['length']>0x0){this['log'][_0x5ebb14(0x331)](_0x5ebb14(0x339)+_0x372df5[_0x5ebb14(0x26b)]+_0x5ebb14(0x25b));for(const _0x485a08 of _0x372df5){if(_0x485a08['id']){await this[_0x5ebb14(0x1d4)](_0x485a08['id']);try{const _0x25d153=await this[_0x5ebb14(0x19e)](_0x485a08['id']);if(_0x25d153)this[_0x5ebb14(0x347)][_0x485a08['id']]=_0x25d153[_0x5ebb14(0x36a)];}catch(_0x5277c0){}}}}const _0x263f85=this[_0x5ebb14(0x314)][_0x5ebb14(0x32f)]||[];if(_0x263f85[_0x5ebb14(0x26b)]>0x0){this[_0x5ebb14(0x285)][_0x5ebb14(0x331)](_0x5ebb14(0x339)+_0x263f85['length']+_0x5ebb14(0x1bd));for(const _0xc7695f of _0x263f85){await this[_0x5ebb14(0x1d4)](_0xc7695f);}try{await this[_0x5ebb14(0x322)]();}catch(_0x92921f){}}if(this[_0x5ebb14(0x247)])clearInterval(this[_0x5ebb14(0x247)]);const _0x26c5ff=this[_0x5ebb14(0x314)][_0x5ebb14(0x294)]||0xf;_0x26c5ff>0x0&&(this[_0x5ebb14(0x285)]['info'](_0x5ebb14(0x1f6)+_0x26c5ff+'\x20min).\x20Watchdog\x20Limit:\x20'+this[_0x5ebb14(0x314)]['inactivityThresholdHours']+'h.'),this[_0x5ebb14(0x247)]=setInterval(()=>{const _0x420093=_0x5ebb14;try{this['runAutopilot']();}catch(_0xeb926e){this['log'][_0x420093(0x2a2)](_0x420093(0x32c)+_0xeb926e[_0x420093(0x2c5)]);}},_0x26c5ff*0x3c*0x3e8)),this[_0x5ebb14(0x373)](),this[_0x5ebb14(0x202)](),this[_0x5ebb14(0x2a1)](),this[_0x5ebb14(0x242)]();}[a0_0x444fb3(0x241)](_0x9aa876){const _0x499147=a0_0x444fb3;if(this[_0x499147(0x247)])clearInterval(this[_0x499147(0x247)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x499147(0x263)]);if(this['ltmJob'])this[_0x499147(0x1a4)]['cancel']();if(this[_0x499147(0x301)])this[_0x499147(0x301)][_0x499147(0x2a8)]();if(this[_0x499147(0x1a5)])this[_0x499147(0x1a5)][_0x499147(0x2a8)]();if(this['exitTimer'])clearTimeout(this[_0x499147(0x1cb)]);if(this[_0x499147(0x37a)])clearTimeout(this[_0x499147(0x37a)]);_0x9aa876();}async['onStateChange'](_0x41b3ce,_0xfc504){const _0x5528a7=a0_0x444fb3;if(!_0xfc504)return;if(_0x41b3ce===this[_0x5528a7(0x2f6)]+'.'+SYSTEM_DP_MODE){_0xfc504[_0x5528a7(0x36a)]&&Object[_0x5528a7(0x1ec)](SYSTEM_MODES)[_0x5528a7(0x29d)](_0xfc504[_0x5528a7(0x36a)])&&(this[_0x5528a7(0x1af)]=_0xfc504[_0x5528a7(0x36a)],_0xfc504[_0x5528a7(0x36a)]===SYSTEM_MODES[_0x5528a7(0x349)]?this[_0x5528a7(0x303)](![]):this[_0x5528a7(0x303)](!![]));if(!_0xfc504['ack'])this['setState'](_0x41b3ce,{'val':this[_0x5528a7(0x1af)],'ack':!![]});return;}if(!_0xfc504['ack']){_0x41b3ce[_0x5528a7(0x29d)](_0x5528a7(0x35c))&&_0xfc504[_0x5528a7(0x36a)]&&(this[_0x5528a7(0x28d)](_0x41b3ce,{'val':![],'ack':!![]}),this['runGeminiAnalysis']());if(_0x41b3ce[_0x5528a7(0x29d)]('triggerDailyDigest')&&_0xfc504[_0x5528a7(0x36a)]){this[_0x5528a7(0x28d)](_0x41b3ce,{'val':![],'ack':!![]});if(this['isProVersion'])this[_0x5528a7(0x1b0)]();}_0x41b3ce['includes'](_0x5528a7(0x284))&&_0xfc504[_0x5528a7(0x36a)]&&(this['setState'](_0x41b3ce,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this[_0x5528a7(0x314)][_0x5528a7(0x32f)]&&this['config'][_0x5528a7(0x32f)][_0x5528a7(0x29d)](_0x41b3ce)){await this[_0x5528a7(0x322)]();return;}const _0x5ec75b=(this['config'][_0x5528a7(0x255)]||[])['find'](_0x2aed5e=>_0x2aed5e['id']===_0x41b3ce);if(_0x5ec75b)this[_0x5528a7(0x315)](_0x41b3ce,_0xfc504,_0x5ec75b);}async['onMessage'](_0x2f61c9){const _0x5f24bb=a0_0x444fb3;if(typeof _0x2f61c9===_0x5f24bb(0x2ad)&&_0x2f61c9[_0x5f24bb(0x2c5)])try{if(_0x2f61c9['command']===_0x5f24bb(0x213)){if(!_0x2f61c9[_0x5f24bb(0x2c5)][_0x5f24bb(0x2e5)])return this[_0x5f24bb(0x1a0)](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9[_0x5f24bb(0x24d)],{'success':![],'message':'No\x20Key'},_0x2f61c9['callback']);try{const _0x26363c=new GoogleGenerativeAI(_0x2f61c9[_0x5f24bb(0x2c5)][_0x5f24bb(0x2e5)])[_0x5f24bb(0x345)]({'model':_0x5f24bb(0x1b4)});await _0x26363c[_0x5f24bb(0x21d)](_0x5f24bb(0x299)),this[_0x5f24bb(0x1a0)](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9[_0x5f24bb(0x24d)],{'success':!![],'message':_0x5f24bb(0x360)},_0x2f61c9[_0x5f24bb(0x28a)]);}catch(_0x29a34a){this['sendTo'](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9[_0x5f24bb(0x24d)],{'success':![],'message':_0x29a34a[_0x5f24bb(0x2c5)]},_0x2f61c9['callback']);}}else{if(_0x2f61c9[_0x5f24bb(0x24d)]===_0x5f24bb(0x328)){const _0x329bdd=await this['sendNotification'](_0x5f24bb(0x2eb),!![]);this[_0x5f24bb(0x1a0)](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9['command'],{'success':_0x329bdd>0x0,'message':_0x329bdd+_0x5f24bb(0x25c)},_0x2f61c9[_0x5f24bb(0x28a)]);}else{if(_0x2f61c9[_0x5f24bb(0x24d)]===_0x5f24bb(0x2af)){if(!this['isProVersion'])return this[_0x5f24bb(0x1a0)](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9[_0x5f24bb(0x24d)],{'success':![],'isPro':![]},_0x2f61c9[_0x5f24bb(0x28a)]);let _0x46ebcc={'status':_0x5f24bb(0x358),'details':'','lastCheck':0x0};try{_0x46ebcc[_0x5f24bb(0x245)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x5f24bb(0x36a)],_0x46ebcc[_0x5f24bb(0x2db)]=(await this[_0x5f24bb(0x19b)](LTM_DP_DRIFT_DETAILS))[_0x5f24bb(0x36a)],_0x46ebcc[_0x5f24bb(0x249)]=(await this[_0x5f24bb(0x19b)](LTM_DP_DRIFT_LAST_CHECK))[_0x5f24bb(0x36a)];}catch(_0x2224c1){}this[_0x5f24bb(0x1a0)](_0x2f61c9['from'],_0x2f61c9[_0x5f24bb(0x24d)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x5f24bb(0x22c)],'driftAnalysis':_0x46ebcc,'analysisHistory':this[_0x5f24bb(0x2f0)]},_0x2f61c9['callback']);}else{if(_0x2f61c9[_0x5f24bb(0x24d)]==='getEnums'){const _0xf0e031=await this[_0x5f24bb(0x28c)](_0x5f24bb(0x353),'enum'),_0x4f5974=[];if(_0xf0e031)for(const _0xb4b68f in _0xf0e031){const _0xc0b635=_0xf0e031[_0xb4b68f],_0x4efa6e=(_0xc0b635[_0x5f24bb(0x295)]&&typeof _0xc0b635['common'][_0x5f24bb(0x2fd)]===_0x5f24bb(0x2ad)?_0xc0b635[_0x5f24bb(0x295)][_0x5f24bb(0x2fd)]['de']:_0xc0b635['common'][_0x5f24bb(0x2fd)])||_0xc0b635['common'][_0x5f24bb(0x2fd)];_0x4f5974[_0x5f24bb(0x35b)]({'id':_0xb4b68f,'name':_0x4efa6e});}this[_0x5f24bb(0x1a0)](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9['command'],{'success':!![],'enums':_0x4f5974},_0x2f61c9[_0x5f24bb(0x28a)]);}else{if(_0x2f61c9[_0x5f24bb(0x24d)]===_0x5f24bb(0x276))try{const _0x11aca1=await this[_0x5f24bb(0x2fe)](_0x2f61c9['message']||{});this[_0x5f24bb(0x1a0)](_0x2f61c9['from'],_0x2f61c9[_0x5f24bb(0x24d)],{'success':!![],'devices':_0x11aca1},_0x2f61c9['callback']);}catch(_0x40a10f){this[_0x5f24bb(0x1a0)](_0x2f61c9['from'],_0x2f61c9['command'],{'success':![],'error':_0x40a10f[_0x5f24bb(0x2c5)]},_0x2f61c9['callback']);}else{if(_0x2f61c9['command']===_0x5f24bb(0x205)){const {historyId:_0x216b67,rating:_0x407673,comment:_0x388e85,alertReason:_0x193d7f}=_0x2f61c9['message'];_0x216b67&&_0x407673?(await this[_0x5f24bb(0x2a9)]({'timestamp':Date['now'](),'historyId':_0x216b67,'rating':_0x407673,'comment':_0x388e85,'alertReason':_0x193d7f}),this['sendTo'](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9[_0x5f24bb(0x24d)],{'success':!![]},_0x2f61c9[_0x5f24bb(0x28a)])):this[_0x5f24bb(0x1a0)](_0x2f61c9['from'],_0x2f61c9['command'],{'success':![],'error':_0x5f24bb(0x365)},_0x2f61c9[_0x5f24bb(0x28a)]);}else{if(_0x2f61c9[_0x5f24bb(0x24d)]===_0x5f24bb(0x1ab)){const _0xe5abc8=await this[_0x5f24bb(0x289)](),_0x2b8200=await this[_0x5f24bb(0x2d2)]();this[_0x5f24bb(0x1a0)](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9[_0x5f24bb(0x24d)],{'success':!![],'weather':_0xe5abc8,'calendar':_0x2b8200},_0x2f61c9[_0x5f24bb(0x28a)]);}else{if(_0x2f61c9[_0x5f24bb(0x24d)]===_0x5f24bb(0x2a3)){const _0x794c1f=_0x2f61c9[_0x5f24bb(0x2c5)]['instance'];if(!_0x794c1f)return this[_0x5f24bb(0x1a0)](_0x2f61c9[_0x5f24bb(0x2e1)],_0x2f61c9['command'],{'success':![],'error':_0x5f24bb(0x2df)},_0x2f61c9[_0x5f24bb(0x28a)]);const _0x5d893a=await this[_0x5f24bb(0x2a3)](_0x794c1f);this[_0x5f24bb(0x1a0)](_0x2f61c9['from'],_0x2f61c9[_0x5f24bb(0x24d)],{'success':!![],'names':_0x5d893a},_0x2f61c9[_0x5f24bb(0x28a)]);}}}}}}}}}catch(_0x2e26e9){if(_0x2f61c9['callback'])this[_0x5f24bb(0x1a0)](_0x2f61c9['from'],_0x2f61c9[_0x5f24bb(0x24d)],{'success':![],'error':_0x2e26e9[_0x5f24bb(0x2c5)]},_0x2f61c9[_0x5f24bb(0x28a)]);}}async[a0_0x444fb3(0x315)](_0x425ebe,_0x33d330,_0x12d314){const _0x14bc0a=a0_0x444fb3;if(!_0x12d314[_0x14bc0a(0x272)]&&this[_0x14bc0a(0x347)][_0x425ebe]===_0x33d330[_0x14bc0a(0x36a)])return;this[_0x14bc0a(0x347)][_0x425ebe]=_0x33d330[_0x14bc0a(0x36a)];if(this[_0x14bc0a(0x21b)])return;const _0x33c2ec=await this['checkWifiPresence']();if(_0x33c2ec){if(!this[_0x14bc0a(0x2b8)])this[_0x14bc0a(0x303)](!![]);}else{const _0x9f6ba6=_0x12d314['isExit']===!![];_0x9f6ba6?this[_0x14bc0a(0x32d)]():(this[_0x14bc0a(0x1cb)]&&(this[_0x14bc0a(0x285)][_0x14bc0a(0x331)]('Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.'),this['abortExitTimer']()),!this['isPresent']&&this['currentSystemMode']===SYSTEM_MODES[_0x14bc0a(0x1b5)]&&this[_0x14bc0a(0x303)](!![]));}const _0x1345ac={'timestamp':_0x33d330['ts'],'id':_0x425ebe,'name':_0x12d314['name'],'value':_0x33d330[_0x14bc0a(0x36a)],'location':_0x12d314[_0x14bc0a(0x2dc)],'type':_0x12d314[_0x14bc0a(0x19f)]};this[_0x14bc0a(0x1ae)][_0x14bc0a(0x271)](_0x1345ac);if(this[_0x14bc0a(0x1ae)][_0x14bc0a(0x26b)]>HISTORY_MAX_SIZE)this['eventHistory'][_0x14bc0a(0x248)]();await this['setStateAsync'](_0x14bc0a(0x1b9),{'val':JSON['stringify'](_0x1345ac),'ack':!![]}),await this[_0x14bc0a(0x31d)](_0x14bc0a(0x2cb),{'val':JSON[_0x14bc0a(0x1c1)](this['eventHistory']),'ack':!![]}),this['rawEventLog']['push']({'timestamp':new Date(_0x33d330['ts'])[_0x14bc0a(0x1d8)](),'sensorName':_0x12d314[_0x14bc0a(0x2fd)],'location':_0x12d314[_0x14bc0a(0x2dc)],'value':_0x33d330[_0x14bc0a(0x36a)]}),await this[_0x14bc0a(0x305)]();}async['checkWifiPresence'](){const _0x3f3f66=a0_0x444fb3;try{const _0x4d066a=this[_0x3f3f66(0x314)]['presenceDevices']||[];let _0x30a4f7=![];for(const _0x4561d9 of _0x4d066a){try{const _0x1d5204=await this['getForeignStateAsync'](_0x4561d9);if(_0x1d5204&&(_0x1d5204[_0x3f3f66(0x36a)]===!![]||_0x1d5204[_0x3f3f66(0x36a)]===_0x3f3f66(0x2b3)||_0x1d5204[_0x3f3f66(0x36a)]===0x1)){_0x30a4f7=!![];break;}}catch(_0x170317){}}return _0x30a4f7&&(this['exitTimer']&&(this[_0x3f3f66(0x285)][_0x3f3f66(0x331)](_0x3f3f66(0x2cf)),this[_0x3f3f66(0x2d1)]()),!this[_0x3f3f66(0x2b8)]&&this['currentSystemMode']===SYSTEM_MODES[_0x3f3f66(0x1b5)]&&this[_0x3f3f66(0x303)](!![])),_0x30a4f7;}catch(_0x3da480){return this[_0x3f3f66(0x285)][_0x3f3f66(0x2a2)](_0x3f3f66(0x330)+_0x3da480[_0x3f3f66(0x2c5)]),![];}}[a0_0x444fb3(0x32d)](){const _0x3a15d9=a0_0x444fb3;this[_0x3a15d9(0x2d1)](),this[_0x3a15d9(0x21b)]=!![],this[_0x3a15d9(0x37a)]=setTimeout(()=>{const _0x3773ed=_0x3a15d9;this[_0x3773ed(0x21b)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this['exitTimer']=setTimeout(()=>{const _0x141f22=_0x3a15d9;this[_0x141f22(0x303)](![]),this[_0x141f22(0x1cb)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x444fb3(0x2d1)](){const _0x22657e=a0_0x444fb3;if(this[_0x22657e(0x1cb)])clearTimeout(this[_0x22657e(0x1cb)]);if(this[_0x22657e(0x37a)])clearTimeout(this[_0x22657e(0x37a)]);this[_0x22657e(0x1cb)]=null,this[_0x22657e(0x37a)]=null,this[_0x22657e(0x21b)]=![];}async['setPresence'](_0x1ed072){const _0x1273ae=a0_0x444fb3;if(this[_0x1273ae(0x2b8)]===_0x1ed072)return;this[_0x1273ae(0x2b8)]=_0x1ed072,await this[_0x1273ae(0x31d)](_0x1273ae(0x324),{'val':_0x1ed072,'ack':!![]});}[a0_0x444fb3(0x35a)](){const _0x58715c=a0_0x444fb3,_0x61d1b8=this['config'][_0x58715c(0x1b1)],_0x2e8788=this[_0x58715c(0x314)]['inactivityMonitoringEnabled'],_0x418ab7=this[_0x58715c(0x1ae)][_0x58715c(0x26b)]>0x0?this[_0x58715c(0x1ae)][0x0][_0x58715c(0x2e3)]:Date['now'](),_0x48425a=(Date[_0x58715c(0x326)]()-_0x418ab7)/(0x3e8*0x3c*0x3c);let _0x2fa6f8='';_0x2e8788&&this[_0x58715c(0x1af)]===SYSTEM_MODES[_0x58715c(0x1b5)]&&this[_0x58715c(0x2b8)]&&(_0x48425a>_0x61d1b8&&(_0x2fa6f8=_0x58715c(0x1c8)+_0x48425a[_0x58715c(0x1e3)](0x1)+_0x58715c(0x281)));if(_0x2fa6f8){this['runGeminiAnalysis'](_0x2fa6f8)[_0x58715c(0x1e5)](_0x5044ae=>this[_0x58715c(0x285)][_0x58715c(0x2a2)](_0x5044ae));return;}const _0x477711=Date[_0x58715c(0x326)](),_0x5e349f=_0x477711-_0x418ab7,_0x5357e4=(this[_0x58715c(0x314)][_0x58715c(0x294)]||0xf)*0x3c*0x3e8;this['eventHistory'][_0x58715c(0x26b)]>0x0&&_0x5e349f<=_0x5357e4?this[_0x58715c(0x1fe)]()[_0x58715c(0x1e5)](_0xed289d=>this[_0x58715c(0x285)][_0x58715c(0x2a2)](_0xed289d)):!this[_0x58715c(0x200)]&&(this[_0x58715c(0x28d)](_0x58715c(0x26f),{'val':![],'ack':!![]}),this['setState'](_0x58715c(0x2c9),{'val':![],'ack':!![]}));}async[a0_0x444fb3(0x1fe)](_0x371ec7=''){const _0x64524a=a0_0x444fb3;if(!this[_0x64524a(0x31e)])return;const _0x315fad=this[_0x64524a(0x1ae)][_0x64524a(0x26b)]>0x0?this[_0x64524a(0x1ae)]:[{'note':'No\x20recorded\x20events\x20yet.'}],_0x4be750=PERSONA_MAPPING[this[_0x64524a(0x314)]['aiPersona']||_0x64524a(0x277)],_0x499cdc=this[_0x64524a(0x314)]['livingContext']||'',_0x4479b7=this[_0x64524a(0x1af)],_0xde34aa=await this['getWeatherContext'](),_0x8283d3=await this[_0x64524a(0x2d2)](),_0x1a545c=(_0xde34aa+'\x20'+_0x8283d3)['trim'](),_0x3d12d9=new Date(),_0x47a322=_0x3d12d9[_0x64524a(0x23c)](_0x64524a(0x351),{'weekday':_0x64524a(0x302),'hour':_0x64524a(0x300),'minute':'2-digit'}),_0x2f620f=this['systemConfig'];let _0x2e4a32='';if(this[_0x64524a(0x369)][_0x64524a(0x26b)]>0x0){const _0x4c06ca=this[_0x64524a(0x369)][_0x64524a(0x304)](0x0,0x3)[_0x64524a(0x2f7)](_0x5801d6=>'User\x20Feedback:\x20Alarm\x20\x22'+_0x5801d6['alertReason']+_0x64524a(0x27c)+_0x5801d6[_0x64524a(0x355)]+'.')[_0x64524a(0x2cc)]('\x0a');_0x2e4a32=_0x64524a(0x2e4)+_0x4c06ca+'\x0a';}const _0x27702a=_0x371ec7?_0x64524a(0x30e)+_0x371ec7+_0x64524a(0x1e0):'',_0x5437c2=_0x64524a(0x1be),_0x1157d1=_0x64524a(0x216)+_0x47a322+_0x64524a(0x1d7)+_0x2f620f[_0x64524a(0x225)]+_0x64524a(0x2c4)+_0x4479b7+_0x64524a(0x287)+(this[_0x64524a(0x2b8)]?'Ja':_0x64524a(0x2d7))+'.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20'+_0x499cdc+_0x64524a(0x2ae)+_0x4be750+_0x64524a(0x21a)+_0x1a545c+_0x64524a(0x1d6)+_0x5437c2+'\x20'+_0x2e4a32+'\x20'+_0x27702a+_0x64524a(0x2f8)+JSON[_0x64524a(0x1c1)](_0x315fad)+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}';try{const _0x508c84=await this[_0x64524a(0x31e)][_0x64524a(0x21d)](_0x1157d1),_0x2eca4b=_0x508c84[_0x64524a(0x33c)][_0x64524a(0x1a1)]()[_0x64524a(0x30b)](/```json|```/g,'')['trim'](),_0x5112e0=JSON['parse'](_0x2eca4b);await this['setStateAsync'](_0x64524a(0x1f8),{'val':_0x2eca4b,'ack':!![]}),await this[_0x64524a(0x31d)](_0x64524a(0x212),{'val':_0x5112e0[_0x64524a(0x2e7)][_0x64524a(0x22e)]||'','ack':!![]}),await this[_0x64524a(0x31d)](_0x64524a(0x354),{'val':_0x5112e0['activity'][_0x64524a(0x221)]||_0x64524a(0x358),'ack':!![]}),await this['setStateAsync'](_0x64524a(0x357),{'val':_0x5112e0[_0x64524a(0x2e7)]['deviationFromBaseline']||_0x64524a(0x358),'ack':!![]});_0x5112e0['comfort']&&(await this[_0x64524a(0x31d)]('analysis.comfortSummary',{'val':_0x5112e0[_0x64524a(0x359)][_0x64524a(0x221)]||'','ack':!![]}),await this[_0x64524a(0x31d)]('analysis.comfortSuggestion',{'val':_0x5112e0[_0x64524a(0x359)][_0x64524a(0x333)]||'','ack':!![]}),_0x5112e0[_0x64524a(0x359)][_0x64524a(0x1ba)]&&(await this[_0x64524a(0x31d)](_0x64524a(0x279),{'val':_0x5112e0[_0x64524a(0x359)][_0x64524a(0x1ba)][_0x64524a(0x278)]||![],'ack':!![]}),await this[_0x64524a(0x31d)](_0x64524a(0x363),{'val':_0x5112e0[_0x64524a(0x359)][_0x64524a(0x1ba)]['description']||'','ack':!![]}),await this[_0x64524a(0x31d)](_0x64524a(0x296),{'val':_0x5112e0[_0x64524a(0x359)]['automationProposal'][_0x64524a(0x374)]||'','ack':!![]})));_0x5112e0['health']&&(await this[_0x64524a(0x31d)](_0x64524a(0x2ab),{'val':typeof _0x5112e0[_0x64524a(0x2f5)]['sleepScore']===_0x64524a(0x1c6)?_0x5112e0[_0x64524a(0x2f5)][_0x64524a(0x371)]:0x0,'ack':!![]}),await this[_0x64524a(0x31d)](_0x64524a(0x1fb),{'val':_0x5112e0[_0x64524a(0x2f5)][_0x64524a(0x25f)]||_0x64524a(0x1b8),'ack':!![]}),await this[_0x64524a(0x31d)]('analysis.health.notes',{'val':_0x5112e0[_0x64524a(0x2f5)][_0x64524a(0x30f)]||'','ack':!![]}));const _0x544ea1=_0x5112e0[_0x64524a(0x2e7)][_0x64524a(0x256)]||![],_0x261ea1=_0x5112e0[_0x64524a(0x2e7)][_0x64524a(0x1f1)]||![];if(_0x544ea1||_0x261ea1){await this[_0x64524a(0x31d)](_0x64524a(0x26f),{'val':!![],'ack':!![]}),await this[_0x64524a(0x31d)](_0x64524a(0x2c9),{'val':_0x261ea1,'ack':!![]});if(!this[_0x64524a(0x200)]||_0x261ea1){const _0x2dd4fd=_0x261ea1?_0x64524a(0x26a):_0x64524a(0x2e9);this['sendNotification'](_0x2dd4fd+':\x20'+_0x5112e0[_0x64524a(0x2e7)][_0x64524a(0x22e)],![],_0x261ea1);}}else await this['setStateAsync']('analysis.isAlert',{'val':![],'ack':!![]}),await this['setStateAsync'](_0x64524a(0x2c9),{'val':![],'ack':!![]});this[_0x64524a(0x200)]=_0x544ea1||_0x261ea1;const _0x287ae0={'timestamp':Date[_0x64524a(0x326)](),'id':Date[_0x64524a(0x326)]()[_0x64524a(0x237)](),'analysis':_0x5112e0,'systemMode':_0x4479b7,'isPro':this[_0x64524a(0x23a)]};this[_0x64524a(0x270)](_0x287ae0);}catch(_0x1b08c7){this['log'][_0x64524a(0x2a2)](_0x64524a(0x231)+_0x1b08c7[_0x64524a(0x2c5)]);}}async[a0_0x444fb3(0x1b0)](){const _0x2fbef0=a0_0x444fb3;if(!this[_0x2fbef0(0x31e)]||this[_0x2fbef0(0x1f7)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x2fbef0(0x31d)](LTM_DP_STATUS,{'val':_0x2fbef0(0x1e6),'ack':!![]});return;}this['log'][_0x2fbef0(0x331)]('Creating\x20Daily\x20Digest\x20from\x20'+this[_0x2fbef0(0x1f7)][_0x2fbef0(0x26b)]+_0x2fbef0(0x33e)),await this[_0x2fbef0(0x31d)](LTM_DP_STATUS,{'val':_0x2fbef0(0x2a6),'ack':!![]});const _0x3d6084=this['rawEventLog'][_0x2fbef0(0x26b)]>0x320?this['rawEventLog']['slice'](this[_0x2fbef0(0x1f7)][_0x2fbef0(0x26b)]-0x320):this['rawEventLog'],_0x24fc84=PERSONA_MAPPING[this[_0x2fbef0(0x314)][_0x2fbef0(0x2ed)]||_0x2fbef0(0x277)],_0x5359bc='ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20'+_0x24fc84+_0x2fbef0(0x344)+JSON['stringify'](_0x3d6084)+_0x2fbef0(0x36b);try{const _0x86c917=await this[_0x2fbef0(0x31e)][_0x2fbef0(0x21d)](_0x5359bc),_0x3b10ff=_0x86c917[_0x2fbef0(0x33c)][_0x2fbef0(0x1a1)]()['replace'](/```json|```/g,'')[_0x2fbef0(0x309)](),_0x5c8ed2=JSON[_0x2fbef0(0x21e)](_0x3b10ff),_0x299c06={'timestamp':new Date()[_0x2fbef0(0x1d8)](),'eventCount':this['rawEventLog'][_0x2fbef0(0x26b)],'summary':_0x5c8ed2[_0x2fbef0(0x221)],'activityLevel':_0x5c8ed2['activityLevel'],'health':{'sleepScore':_0x5c8ed2[_0x2fbef0(0x2f5)]?_0x5c8ed2[_0x2fbef0(0x2f5)]['sleepScore']:0x0,'restlessness':_0x5c8ed2[_0x2fbef0(0x2f5)]?_0x5c8ed2['health']['restlessness']:_0x2fbef0(0x1b8)},'systemMode':this[_0x2fbef0(0x1af)]};this[_0x2fbef0(0x22c)]['push'](_0x299c06),await this[_0x2fbef0(0x23f)](),this[_0x2fbef0(0x1f7)]=[],await this[_0x2fbef0(0x305)](),await this[_0x2fbef0(0x31d)](LTM_DP_STATUS,{'val':_0x2fbef0(0x36f),'ack':!![]}),this['log'][_0x2fbef0(0x331)](_0x2fbef0(0x2b0));}catch(_0x297b0f){this[_0x2fbef0(0x285)][_0x2fbef0(0x2a2)](_0x2fbef0(0x29a)+_0x297b0f[_0x2fbef0(0x2c5)]),await this[_0x2fbef0(0x31d)](LTM_DP_STATUS,{'val':_0x2fbef0(0x1e4)+_0x297b0f[_0x2fbef0(0x2c5)],'ack':!![]});}}async[a0_0x444fb3(0x321)](){const _0x5e6c4f=a0_0x444fb3;if(!this[_0x5e6c4f(0x31e)])return;this['log'][_0x5e6c4f(0x331)]('Generating\x20Morning\x20Briefing...');const _0xcf2da4=this['dailyDigests']['length']>0x0?this[_0x5e6c4f(0x22c)][this[_0x5e6c4f(0x22c)]['length']-0x1]:null,_0x4b92da=_0xcf2da4&&_0xcf2da4[_0x5e6c4f(0x2f5)]?_0xcf2da4[_0x5e6c4f(0x2f5)][_0x5e6c4f(0x371)]:'N/A',_0x4adbb1=new Date();_0x4adbb1[_0x5e6c4f(0x234)](0x4,0x0,0x0,0x0);const _0x282737=this[_0x5e6c4f(0x1ae)][_0x5e6c4f(0x211)](_0x542103=>new Date(_0x542103[_0x5e6c4f(0x2e3)])>_0x4adbb1),_0x467d2d=PERSONA_MAPPING[this[_0x5e6c4f(0x314)][_0x5e6c4f(0x2ed)]||_0x5e6c4f(0x277)],_0x3842ee=this[_0x5e6c4f(0x314)][_0x5e6c4f(0x36e)]||'',_0x1877f3=await this[_0x5e6c4f(0x289)](),_0x2e8bde=await this[_0x5e6c4f(0x2d2)](),_0x356e00='ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20'+_0x467d2d+_0x5e6c4f(0x35e)+_0x3842ee+_0x5e6c4f(0x1f5)+_0x1877f3+'\x20'+_0x2e8bde+_0x5e6c4f(0x1dd)+_0x4b92da+_0x5e6c4f(0x204)+JSON[_0x5e6c4f(0x1c1)](_0x282737[_0x5e6c4f(0x304)](0x0,0xa))+_0x5e6c4f(0x2ca);try{const _0x38b024=await this[_0x5e6c4f(0x31e)][_0x5e6c4f(0x21d)](_0x356e00),_0x17d4e7='üåÖ\x20Daily\x20Briefing:\x0a'+_0x38b024[_0x5e6c4f(0x33c)]['text']()['trim']();this['sendNotification'](_0x17d4e7),this[_0x5e6c4f(0x285)][_0x5e6c4f(0x331)]('Morning\x20Briefing\x20sent.');}catch(_0x2a6660){this['log'][_0x5e6c4f(0x2a2)](_0x5e6c4f(0x246)+_0x2a6660[_0x5e6c4f(0x2c5)]);}}async[a0_0x444fb3(0x1db)](){const _0x36febe=a0_0x444fb3;try{const _0x573158=await this[_0x36febe(0x19b)](_0x36febe(0x2cb));_0x573158&&_0x573158[_0x36febe(0x36a)]&&(this['eventHistory']=JSON['parse'](_0x573158[_0x36febe(0x36a)][_0x36febe(0x237)]()));}catch(_0x3eb4df){this[_0x36febe(0x1ae)]=[];}try{const _0xa877d5=await this[_0x36febe(0x19b)](_0x36febe(0x2f3));if(_0xa877d5&&_0xa877d5['val'])this[_0x36febe(0x2f0)]=JSON[_0x36febe(0x21e)](_0xa877d5['val'][_0x36febe(0x237)]());}catch(_0x518651){this[_0x36febe(0x2f0)]=[];}}async['loadRawEventLog'](){const _0x44bf89=a0_0x444fb3;try{const _0xd24e68=await this['getStateAsync'](LTM_DP_RAW_LOG);if(_0xd24e68&&_0xd24e68[_0x44bf89(0x36a)])this[_0x44bf89(0x1f7)]=JSON['parse'](_0xd24e68[_0x44bf89(0x36a)]);}catch(_0x28784c){this[_0x44bf89(0x1f7)]=[];}}async[a0_0x444fb3(0x1e9)](){const _0x18fbae=a0_0x444fb3;try{const _0x303d82=await this[_0x18fbae(0x19b)](LTM_DP_DAILY_DIGESTS);if(_0x303d82&&_0x303d82[_0x18fbae(0x36a)])this[_0x18fbae(0x22c)]=JSON[_0x18fbae(0x21e)](_0x303d82[_0x18fbae(0x36a)]);}catch(_0x575011){this[_0x18fbae(0x22c)]=[];}await this[_0x18fbae(0x298)]();}async[a0_0x444fb3(0x305)](){const _0x36b3f9=a0_0x444fb3;this[_0x36b3f9(0x1f7)][_0x36b3f9(0x26b)]>RAW_LOG_MAX_SIZE&&this[_0x36b3f9(0x1f7)][_0x36b3f9(0x210)](0x0,this[_0x36b3f9(0x1f7)][_0x36b3f9(0x26b)]-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x36b3f9(0x1c1)](this[_0x36b3f9(0x1f7)]),'ack':!![]});}async[a0_0x444fb3(0x23f)](_0x19d367=!![]){const _0x1c8d58=a0_0x444fb3,_0x11a12a=this[_0x1c8d58(0x314)]['ltmLtbWindowDays']||0x3c;this['dailyDigests'][_0x1c8d58(0x26b)]>_0x11a12a&&this[_0x1c8d58(0x22c)]['splice'](0x0,this[_0x1c8d58(0x22c)][_0x1c8d58(0x26b)]-_0x11a12a);await this['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](this[_0x1c8d58(0x22c)]),'ack':!![]});if(_0x19d367)await this[_0x1c8d58(0x298)]();}async[a0_0x444fb3(0x270)](_0x56eafc){const _0x1da763=a0_0x444fb3;this[_0x1da763(0x2f0)][_0x1da763(0x271)](_0x56eafc);if(this['analysisHistory']['length']>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0x1da763(0x248)]();await this[_0x1da763(0x31d)](_0x1da763(0x2f3),{'val':JSON[_0x1da763(0x1c1)](this[_0x1da763(0x2f0)]),'ack':!![]});}async[a0_0x444fb3(0x21f)](){const _0x881b40=a0_0x444fb3;await this[_0x881b40(0x31d)](_0x881b40(0x354),{'val':_0x881b40(0x264),'ack':!![]}),await this[_0x881b40(0x31d)](_0x881b40(0x357),{'val':this[_0x881b40(0x23a)]?_0x881b40(0x251):_0x881b40(0x230),'ack':!![]}),await this[_0x881b40(0x31d)](_0x881b40(0x26f),{'val':![],'ack':!![]}),await this[_0x881b40(0x31d)](_0x881b40(0x2c9),{'val':![],'ack':!![]}),this[_0x881b40(0x200)]=![];}async[a0_0x444fb3(0x298)](){const _0x4c7766=a0_0x444fb3;if(!this[_0x4c7766(0x23a)]){await this[_0x4c7766(0x31d)](LTM_DP_BASELINE_STATUS,{'val':_0x4c7766(0x31b),'ack':!![]});return;}const _0x112175=this[_0x4c7766(0x22c)]['length']>=(this[_0x4c7766(0x314)][_0x4c7766(0x31a)]||0x7)?_0x4c7766(0x2fc)+this[_0x4c7766(0x22c)][_0x4c7766(0x26b)]+'\x20Tage)':'Lernphase\x20('+this[_0x4c7766(0x22c)][_0x4c7766(0x26b)]+'/'+(this[_0x4c7766(0x314)][_0x4c7766(0x31a)]||0x7)+')';await this[_0x4c7766(0x31d)](LTM_DP_BASELINE_STATUS,{'val':_0x112175,'ack':!![]});}['tryParse'](_0x757a61){const _0x1c7e84=a0_0x444fb3;if(typeof _0x757a61==='object')return _0x757a61;try{return JSON[_0x1c7e84(0x21e)](_0x757a61);}catch(_0x36d6a3){return null;}}async[a0_0x444fb3(0x289)](){const _0x2e4f75=a0_0x444fb3;try{if(!this[_0x2e4f75(0x314)][_0x2e4f75(0x33b)])return'Wetter:\x20Deaktiviert';let _0x16e14d='';const _0x52fb1f=this[_0x2e4f75(0x314)][_0x2e4f75(0x23e)];if(_0x52fb1f)try{if(_0x52fb1f[_0x2e4f75(0x29d)]('accuweather')){const _0xb499c6=await this['getForeignStateAsync'](_0x52fb1f+_0x2e4f75(0x1e1));if(_0xb499c6&&_0xb499c6[_0x2e4f75(0x36a)])_0x16e14d=_0xb499c6[_0x2e4f75(0x36a)];}else{if(_0x52fb1f['includes']('daswetter')){const _0x556412=await this[_0x2e4f75(0x19e)](_0x52fb1f+_0x2e4f75(0x2d5));if(_0x556412&&_0x556412[_0x2e4f75(0x36a)])_0x16e14d=_0x556412[_0x2e4f75(0x36a)];}else{if(_0x52fb1f[_0x2e4f75(0x29d)](_0x2e4f75(0x2b7))){const _0x424865=await this[_0x2e4f75(0x19e)](_0x52fb1f+_0x2e4f75(0x30a));if(_0x424865&&_0x424865[_0x2e4f75(0x36a)])_0x16e14d=_0x424865['val'];}}}}catch(_0x3b7bd9){}if(!_0x16e14d){const _0x4e5132=[_0x2e4f75(0x22f),_0x2e4f75(0x25e),_0x2e4f75(0x266),'openweathermap.0'];for(const _0x6e8619 of _0x4e5132){try{const _0xff3dbb=await this[_0x2e4f75(0x240)](_0x6e8619);if(_0xff3dbb){if(_0x6e8619[_0x2e4f75(0x29d)](_0x2e4f75(0x32b))){const _0x3a2e1f=await this['getForeignStateAsync'](_0x6e8619+_0x2e4f75(0x1e1));if(_0x3a2e1f&&_0x3a2e1f['val']){_0x16e14d=_0x3a2e1f[_0x2e4f75(0x36a)];break;}}}}catch(_0x333dd6){}}}return _0x16e14d?_0x2e4f75(0x343)+_0x16e14d:_0x2e4f75(0x1fc);}catch(_0x5c9ef8){return _0x2e4f75(0x1f9)+_0x5c9ef8[_0x2e4f75(0x2c5)];}}async[a0_0x444fb3(0x2d2)](){const _0x128430=a0_0x444fb3;try{if(!this[_0x128430(0x314)][_0x128430(0x26d)])return _0x128430(0x2aa);let _0x203aeb=this['config'][_0x128430(0x1ac)]||_0x128430(0x1fd),_0x45edcb=this['config'][_0x128430(0x235)]||[];if(typeof _0x45edcb===_0x128430(0x379))_0x45edcb=_0x45edcb['split'](',');try{const _0x2cf09a=await this[_0x128430(0x19e)](_0x203aeb+'.data.table');if(_0x2cf09a&&_0x2cf09a[_0x128430(0x36a)]){let _0x13e5fc=this[_0x128430(0x261)](_0x2cf09a[_0x128430(0x36a)]);if(_0x13e5fc&&Array[_0x128430(0x1d9)](_0x13e5fc)){if(_0x45edcb[_0x128430(0x26b)]>0x0)_0x13e5fc=_0x13e5fc['filter'](_0x32e47a=>_0x45edcb[_0x128430(0x29d)](_0x32e47a['_calName']||''));else return _0x128430(0x2fa);if(_0x13e5fc[_0x128430(0x26b)]>0x0){const _0x39f47e=_0x13e5fc['slice'](0x0,0x3)[_0x128430(0x2f7)](_0xff55d6=>{const _0x21e13f=_0x128430;let _0x43e48d=_0xff55d6['date'];if(_0xff55d6[_0x21e13f(0x24f)])_0x43e48d+='\x20'+_0xff55d6['time'];return _0x43e48d+':\x20'+_0xff55d6[_0x21e13f(0x2ec)]+'\x20('+_0xff55d6['_calName']+')';});return'KALENDER:\x20'+_0x39f47e[_0x128430(0x2cc)](_0x128430(0x2be));}else return _0x128430(0x222);}}}catch(_0x5c2eb2){}return'KALENDER:\x20Keine\x20Daten';}catch(_0x9f7a8c){return _0x128430(0x36c)+_0x9f7a8c[_0x128430(0x2c5)];}}async[a0_0x444fb3(0x2a3)](_0x40bc71){const _0x1e24df=a0_0x444fb3;try{const _0x5a0fb3=await this['getForeignStateAsync'](_0x40bc71+_0x1e24df(0x2e8));if(_0x5a0fb3&&_0x5a0fb3[_0x1e24df(0x36a)]){const _0x229a56=this[_0x1e24df(0x261)](_0x5a0fb3['val']);if(_0x229a56&&Array['isArray'](_0x229a56)){const _0x296cf1=[...new Set(_0x229a56[_0x1e24df(0x2f7)](_0x53c5cc=>_0x53c5cc[_0x1e24df(0x1dc)])[_0x1e24df(0x211)](Boolean))];return _0x296cf1[_0x1e24df(0x2d4)]();}}return[];}catch(_0x18733d){return this[_0x1e24df(0x285)][_0x1e24df(0x2a2)](_0x1e24df(0x362)+_0x18733d['message']),[];}}async['getSystemUUID'](){const _0x43fcf0=a0_0x444fb3;try{const _0x429348=await this[_0x43fcf0(0x240)](_0x43fcf0(0x308));if(_0x429348&&_0x429348['native']&&_0x429348[_0x43fcf0(0x2f9)][_0x43fcf0(0x23d)])return _0x429348[_0x43fcf0(0x2f9)][_0x43fcf0(0x23d)];return _0x43fcf0(0x338);}catch(_0x202496){return'uuid-error';}}async[a0_0x444fb3(0x25d)](_0x1e88ad){const _0x1fd43a=a0_0x444fb3;if(!_0x1e88ad)return![];this[_0x1fd43a(0x1c7)]=await this[_0x1fd43a(0x1e7)]();if(_0x1e88ad===_0x1fd43a(0x311)||_0x1e88ad[_0x1fd43a(0x316)](_0x1fd43a(0x262)))return!![];return![];}async[a0_0x444fb3(0x2b5)](){const _0x426a92=a0_0x444fb3;await this['extendObjectAsync'](_0x426a92(0x366),{'type':_0x426a92(0x2d3),'common':{'name':_0x426a92(0x366)},'native':{}}),await this[_0x426a92(0x25a)](LTM_DP_RAW_LOG,{'type':_0x426a92(0x219),'common':{'name':_0x426a92(0x2c7),'type':'string','role':_0x426a92(0x310),'read':!![],'write':![]},'native':{}}),await this[_0x426a92(0x25a)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x426a92(0x312),'type':_0x426a92(0x379),'role':_0x426a92(0x310),'read':!![],'write':![]},'native':{}}),await this[_0x426a92(0x25a)](LTM_DP_STATUS,{'type':'state','common':{'name':_0x426a92(0x201),'type':_0x426a92(0x379),'role':_0x426a92(0x1a1),'read':!![],'write':![]},'native':{}}),await this[_0x426a92(0x25a)](LTM_DP_TRIGGER_DIGEST,{'type':_0x426a92(0x219),'common':{'name':'Trigger\x20Digest','type':'boolean','role':_0x426a92(0x1bc),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x426a92(0x25a)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':_0x426a92(0x236),'type':_0x426a92(0x379),'role':_0x426a92(0x1a1),'read':!![],'write':![]},'native':{}});}async[a0_0x444fb3(0x376)](){const _0x9a0e16=a0_0x444fb3;await this[_0x9a0e16(0x25a)](LTM_DP_DRIFT_CHANNEL,{'type':_0x9a0e16(0x2d3),'common':{'name':_0x9a0e16(0x2de)},'native':{}}),await this[_0x9a0e16(0x25a)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x9a0e16(0x1b2),'type':_0x9a0e16(0x379),'role':'state','read':!![],'write':![],'def':_0x9a0e16(0x358)},'native':{}}),await this[_0x9a0e16(0x25a)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x9a0e16(0x2e0),'type':_0x9a0e16(0x379),'role':_0x9a0e16(0x1a1),'read':!![],'write':![]},'native':{}}),await this[_0x9a0e16(0x25a)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x9a0e16(0x2d9),'type':'number','role':_0x9a0e16(0x1d2),'read':!![],'write':![]},'native':{}});}async['checkSystemObjects'](){const _0x46b96f=a0_0x444fb3;await this[_0x46b96f(0x25a)]('system',{'type':_0x46b96f(0x2d3),'common':{'name':_0x46b96f(0x334)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x46b96f(0x219),'common':{'name':'System\x20Mode','type':'string','role':_0x46b96f(0x219),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x46b96f(0x1b5)],'states':{[SYSTEM_MODES['NORMAL']]:_0x46b96f(0x28f),[SYSTEM_MODES['VACATION']]:_0x46b96f(0x260),[SYSTEM_MODES['PARTY']]:_0x46b96f(0x341),[SYSTEM_MODES[_0x46b96f(0x375)]]:_0x46b96f(0x2c1)}},'native':{}});}async[a0_0x444fb3(0x1de)](_0x3bd004,_0x1a11ea=![],_0x4e5511=![]){const _0x47a299=a0_0x444fb3;this[_0x47a299(0x285)][_0x47a299(0x331)]((_0x1a11ea?_0x47a299(0x2cd):'')+'Sending\x20notification:\x20\x22'+_0x3bd004+'\x22'+(_0x4e5511?'\x20(EMERGENCY)':''));const _0x9d86e7=this[_0x47a299(0x314)];let _0x4b00ce=0x0;_0x9d86e7[_0x47a299(0x1a9)]&&_0x9d86e7['notifyTelegramInstance']&&(await this[_0x47a299(0x2dd)](_0x9d86e7[_0x47a299(0x283)],'send',{'text':_0x3bd004,'user':_0x9d86e7[_0x47a299(0x2c6)]}),_0x4b00ce++);if(_0x9d86e7[_0x47a299(0x2b4)]&&_0x9d86e7['notifyPushoverInstance']){let _0x54ac6b={'message':_0x3bd004,'title':_0x4e5511?'üö®\x20EMERGENCY':_0x47a299(0x33f),'priority':_0x4e5511?0x2:0x1,'device':_0x9d86e7['notifyPushoverRecipient']};_0x4e5511&&(_0x54ac6b[_0x47a299(0x2f4)]=0x1e,_0x54ac6b[_0x47a299(0x26c)]=0xe10,_0x54ac6b[_0x47a299(0x2ba)]=_0x47a299(0x223)),await this[_0x47a299(0x2dd)](_0x9d86e7[_0x47a299(0x273)],'send',_0x54ac6b),_0x4b00ce++;}return _0x9d86e7['notifyEmailEnabled']&&_0x9d86e7['notifyEmailInstance']&&(await this[_0x47a299(0x2dd)](_0x9d86e7[_0x47a299(0x336)],_0x47a299(0x1df),{'text':_0x3bd004,'to':_0x9d86e7[_0x47a299(0x340)]}),_0x4b00ce++),_0x9d86e7[_0x47a299(0x20e)]&&_0x9d86e7[_0x47a299(0x318)]&&(await this[_0x47a299(0x2dd)](_0x9d86e7[_0x47a299(0x318)],_0x47a299(0x1df),{'text':_0x3bd004,'phone':_0x9d86e7[_0x47a299(0x229)]}),_0x4b00ce++),_0x9d86e7[_0x47a299(0x20d)]&&_0x9d86e7[_0x47a299(0x20c)]&&(await this[_0x47a299(0x2dd)](_0x9d86e7[_0x47a299(0x20c)],_0x47a299(0x1df),{'text':_0x3bd004,'phone':_0x9d86e7[_0x47a299(0x1a3)]}),_0x4b00ce++),_0x4b00ce;}async[a0_0x444fb3(0x2fe)](_0x2c949d={}){const _0x1fca82=a0_0x444fb3;this['log'][_0x1fca82(0x331)](_0x1fca82(0x2f1)+JSON[_0x1fca82(0x1c1)](_0x2c949d));const _0x5650e2=[],_0x59fe05=_0x2c949d[_0x1fca82(0x286)]!==![],_0x51387d=_0x2c949d[_0x1fca82(0x254)]!==![],_0x5b34a8=_0x2c949d[_0x1fca82(0x2ac)]!==![],_0x94c698=_0x2c949d['temperature']===!![],_0x51c953=_0x2c949d[_0x1fca82(0x307)]===!![],_0x50868d=_0x2c949d[_0x1fca82(0x35d)]||[],_0x2698b7=await this[_0x1fca82(0x28c)](_0x1fca82(0x232),'enum'),_0x5d5fb7=await this[_0x1fca82(0x28c)](_0x1fca82(0x353),_0x1fca82(0x2bd)),_0x411561={},_0x587e8a={},_0x4aa6f1={},_0x2f5716=(_0x436270,_0x1f9107,_0x9f69db=![])=>{const _0x81499b=_0x1fca82;if(!_0x436270)return;for(const _0x59d2cd in _0x436270){const _0x53b7bb=_0x436270[_0x59d2cd];if(_0x53b7bb&&_0x53b7bb[_0x81499b(0x295)]&&_0x53b7bb[_0x81499b(0x295)][_0x81499b(0x22d)]){const _0x11fff5=(typeof _0x53b7bb['common'][_0x81499b(0x2fd)]===_0x81499b(0x2ad)?_0x53b7bb[_0x81499b(0x295)][_0x81499b(0x2fd)]['de']:_0x53b7bb[_0x81499b(0x295)][_0x81499b(0x2fd)])||_0x53b7bb[_0x81499b(0x295)][_0x81499b(0x2fd)];if(_0x9f69db)_0x4aa6f1[_0x59d2cd]=_0x11fff5;for(const _0x1136aa of _0x53b7bb[_0x81499b(0x295)]['members']){if(_0x9f69db){if(!_0x1f9107[_0x1136aa])_0x1f9107[_0x1136aa]=[];_0x1f9107[_0x1136aa]['push'](_0x59d2cd);}else _0x1f9107[_0x1136aa]=_0x11fff5;}}}};_0x2f5716(_0x2698b7,_0x411561),_0x2f5716(_0x5d5fb7,_0x587e8a,!![]);const _0x2c9104=await this[_0x1fca82(0x28c)]('*',_0x1fca82(0x219)),_0x1808df=['system.',_0x1fca82(0x34d),'info.',_0x1fca82(0x1cc),_0x1fca82(0x2b2),_0x1fca82(0x36d),_0x1fca82(0x28b),_0x1fca82(0x319)];if(!_0x51c953)_0x1808df['push'](_0x1fca82(0x1ce),_0x1fca82(0x2a4),_0x1fca82(0x2d6),_0x1fca82(0x227),_0x1fca82(0x244));const _0x27fddb=[_0x1fca82(0x22b),_0x1fca82(0x214),_0x1fca82(0x265),_0x1fca82(0x1ed),_0x1fca82(0x2ea),_0x1fca82(0x220),_0x1fca82(0x282),_0x1fca82(0x378),_0x1fca82(0x1f2),'WORKING',_0x1fca82(0x20b),_0x1fca82(0x35f),'OPERATING_VOLTAGE',_0x1fca82(0x33a),_0x1fca82(0x215),_0x1fca82(0x1bf),_0x1fca82(0x243),_0x1fca82(0x27f),_0x1fca82(0x1eb),_0x1fca82(0x1f3),_0x1fca82(0x1bb),_0x1fca82(0x252),_0x1fca82(0x1d5),_0x1fca82(0x26e),_0x1fca82(0x34a),_0x1fca82(0x267),'update',_0x1fca82(0x207),_0x1fca82(0x21c),'connection',_0x1fca82(0x331),'signal',_0x1fca82(0x377),_0x1fca82(0x269),_0x1fca82(0x217),'alert','mode','colormode','effect','xy','ct','hue',_0x1fca82(0x31c),'productname',_0x1fca82(0x1d1),'modelid',_0x1fca82(0x34b),_0x1fca82(0x24d),_0x1fca82(0x2ce),_0x1fca82(0x323),'capabilities','process','scriptEnabled',_0x1fca82(0x1d3),_0x1fca82(0x348),_0x1fca82(0x352),_0x1fca82(0x221),_0x1fca82(0x259),_0x1fca82(0x2c2),'forecast',_0x1fca82(0x331),_0x1fca82(0x310)],_0x1552f9=(_0x311b9b,_0x3ebb3d,_0x9d6056=![])=>{const _0x1fc3d8=_0x1fca82,_0x3b56df=_0x311b9b[_0x1fc3d8(0x27d)]('.');if(_0x3ebb3d[_0x311b9b])return _0x3ebb3d[_0x311b9b];if(_0x3b56df[_0x1fc3d8(0x26b)]>0x2&&_0x3ebb3d[_0x3b56df['slice'](0x0,-0x1)[_0x1fc3d8(0x2cc)]('.')])return _0x3ebb3d[_0x3b56df[_0x1fc3d8(0x304)](0x0,-0x1)[_0x1fc3d8(0x2cc)]('.')];if(_0x3b56df['length']>0x3&&_0x3ebb3d[_0x3b56df[_0x1fc3d8(0x304)](0x0,-0x2)[_0x1fc3d8(0x2cc)]('.')])return _0x3ebb3d[_0x3b56df[_0x1fc3d8(0x304)](0x0,-0x2)[_0x1fc3d8(0x2cc)]('.')];return _0x9d6056?[]:null;};for(const _0x40070a in _0x2c9104){const _0x4c9ecd=_0x2c9104[_0x40070a];if(!_0x4c9ecd||!_0x4c9ecd[_0x1fca82(0x295)])continue;if(_0x1808df['some'](_0x5d1cf9=>_0x40070a[_0x1fca82(0x316)](_0x5d1cf9)))continue;const _0x32944b=_0x4c9ecd[_0x1fca82(0x295)][_0x1fca82(0x1c4)]||'',_0xfb8821=(_0x4c9ecd[_0x1fca82(0x295)]['name']&&typeof _0x4c9ecd[_0x1fca82(0x295)][_0x1fca82(0x2fd)]==='object'?_0x4c9ecd[_0x1fca82(0x295)][_0x1fca82(0x2fd)]['de']:_0x4c9ecd['common'][_0x1fca82(0x2fd)])||'',_0x2aa729=_0xfb8821?_0xfb8821[_0x1fca82(0x364)]():'',_0x2ac760=_0x40070a[_0x1fca82(0x364)](),_0x23a134=_0x1552f9(_0x40070a,_0x411561),_0x499763=_0x1552f9(_0x40070a,_0x587e8a,!![]);let _0x474e59=null,_0x24ed40=![];if(_0x499763&&_0x499763[_0x1fca82(0x26b)]>0x0){const _0x55f1ab=_0x499763[_0x1fca82(0x20f)](_0x517d46=>_0x50868d['includes'](_0x517d46));if(_0x55f1ab){_0x24ed40=!![];const _0x2218a8=_0x4aa6f1[_0x55f1ab];if(_0x2ac760[_0x1fca82(0x29d)]('presence')||_0x2ac760[_0x1fca82(0x29d)](_0x1fca82(0x286)))_0x474e59=_0x1fca82(0x370);else{if(_0x2ac760[_0x1fca82(0x29d)]('smoke')||_0x2ac760[_0x1fca82(0x29d)](_0x1fca82(0x2c0))||_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x34e)))_0x474e59='Rauchmelder';else{if(_0x2ac760[_0x1fca82(0x29d)](_0x1fca82(0x219))||_0x2ac760[_0x1fca82(0x29d)](_0x1fca82(0x2e2))||_0x2ac760[_0x1fca82(0x29d)]('on'))_0x474e59=_0x1fca82(0x34c);else _0x474e59=_0x2218a8;}}}}if(!_0x24ed40&&!_0x51c953){if(_0x27fddb[_0x1fca82(0x317)](_0x2b94ad=>_0x2aa729[_0x1fca82(0x29d)](_0x2b94ad)||_0x40070a[_0x1fca82(0x1fa)]()['includes'](_0x2b94ad)))continue;}if(!_0x474e59&&_0x59fe05){if(_0x32944b[_0x1fca82(0x29d)](_0x1fca82(0x335))||_0x32944b[_0x1fca82(0x29d)](_0x1fca82(0x238))||_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x1ea))||_0x2aa729[_0x1fca82(0x29d)]('pr√§senz'))_0x474e59='Bewegung';}!_0x474e59&&_0x51387d&&((_0x2ac760[_0x1fca82(0x29d)](_0x1fca82(0x1c5))||_0x32944b[_0x1fca82(0x29d)](_0x1fca82(0x1a6))||_0x32944b[_0x1fca82(0x29d)](_0x1fca82(0x1da))||(_0x2aa729[_0x1fca82(0x29d)]('fenster')||_0x2aa729['includes'](_0x1fca82(0x2bb)))&&!_0x2aa729['includes'](_0x1fca82(0x342))&&!_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x29b))&&(_0x4c9ecd[_0x1fca82(0x295)]['type']===_0x1fca82(0x253)||_0x4c9ecd[_0x1fca82(0x295)][_0x1fca82(0x19f)]===_0x1fca82(0x1c6)))&&(_0x474e59=_0x1fca82(0x1ad)));if(!_0x474e59&&_0x5b34a8){if((_0x32944b[_0x1fca82(0x29d)]('switch.light')||_0x32944b[_0x1fca82(0x29d)](_0x1fca82(0x292))||_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x1cf))||_0x2aa729[_0x1fca82(0x29d)]('lampe'))&&_0x4c9ecd[_0x1fca82(0x295)][_0x1fca82(0x29f)])_0x474e59=_0x1fca82(0x275);}if(!_0x474e59&&_0x94c698){if(_0x32944b['includes'](_0x1fca82(0x288))||_0x32944b[_0x1fca82(0x29d)]('value.humidity')||_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x337)))_0x474e59=_0x1fca82(0x1aa);}if(_0x474e59){let _0x356d75=_0x23a134||'';if(!_0x356d75){if(_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x1c3)))_0x356d75='Badezimmer';else{if(_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x2ef)))_0x356d75=_0x1fca82(0x1a8);else{if(_0x2aa729['includes']('wohn'))_0x356d75='Wohnzimmer';else{if(_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x1ff)))_0x356d75=_0x1fca82(0x203);else{if(_0x2aa729['includes'](_0x1fca82(0x327))||_0x2aa729[_0x1fca82(0x29d)]('diele'))_0x356d75='Flur';else{if(_0x2aa729['includes'](_0x1fca82(0x297)))_0x356d75='Garten';}}}}}}let _0x4c12c8=![];_0x474e59===_0x1fca82(0x1ad)&&((_0x2aa729['includes'](_0x1fca82(0x368))||_0x2aa729[_0x1fca82(0x29d)]('eingang')||_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x1c9))||_0x356d75&&_0x356d75['toLowerCase']()['includes'](_0x1fca82(0x327))&&_0x2aa729[_0x1fca82(0x29d)](_0x1fca82(0x2bb)))&&(_0x4c12c8=!![]));let _0x383d99=0x0;if(_0x24ed40)_0x383d99+=0x1e;else{if(_0x23a134)_0x383d99+=0x14;else{if(_0x356d75)_0x383d99+=0xa;}}if(_0x4c12c8)_0x383d99+=0x5;_0x5650e2[_0x1fca82(0x35b)]({'id':_0x40070a,'name':_0xfb8821||_0x40070a,'type':_0x474e59,'location':_0x356d75,'logDuplicates':_0x474e59===_0x1fca82(0x370),'isExit':_0x4c12c8,'_score':_0x383d99});}}return _0x5650e2[_0x1fca82(0x2d4)]((_0x1833e9,_0x13e832)=>_0x13e832[_0x1fca82(0x2b1)]-_0x1833e9[_0x1fca82(0x2b1)]),_0x5650e2;}[a0_0x444fb3(0x373)](){const _0x53a87b=a0_0x444fb3;try{if(this[_0x53a87b(0x1a4)])this['ltmJob'][_0x53a87b(0x2a8)]();if(!this['isProVersion']){this[_0x53a87b(0x31d)](LTM_DP_STATUS,{'val':_0x53a87b(0x31b),'ack':!![]});return;}this[_0x53a87b(0x1a4)]=schedule[_0x53a87b(0x24b)](LTM_SCHEDULE,()=>this[_0x53a87b(0x1b0)]());}catch(_0x75f18b){this[_0x53a87b(0x285)][_0x53a87b(0x2a2)](_0x53a87b(0x361)+_0x75f18b[_0x53a87b(0x2c5)]);}}[a0_0x444fb3(0x202)](){const _0x105416=a0_0x444fb3;try{if(this[_0x105416(0x301)])this[_0x105416(0x301)][_0x105416(0x2a8)]();this[_0x105416(0x301)]=schedule[_0x105416(0x24b)](MODE_RESET_SCHEDULE,async()=>{const _0x1e778e=_0x105416;await this[_0x1e778e(0x32e)](),AUTO_RESET_MODES[_0x1e778e(0x29d)](this[_0x1e778e(0x1af)])&&await this[_0x1e778e(0x31d)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1e778e(0x1b5)],'ack':![]});});}catch(_0x3e74b2){this[_0x105416(0x285)]['error'](_0x105416(0x320)+_0x3e74b2['message']);}}[a0_0x444fb3(0x2a1)](){const _0xb4e81=a0_0x444fb3;try{if(this['driftAnalysisTimer'])clearInterval(this[_0xb4e81(0x263)]);if(!this[_0xb4e81(0x23a)])return;this[_0xb4e81(0x263)]=setInterval(()=>this['runBaselineDriftAnalysis'](),(this[_0xb4e81(0x314)][_0xb4e81(0x19d)]||0x18)*0x36ee80),setTimeout(()=>this[_0xb4e81(0x20a)](),0x1388);}catch(_0x1085cb){this[_0xb4e81(0x285)]['error']('Drift\x20Sched\x20Error:\x20'+_0x1085cb[_0xb4e81(0x2c5)]);}}[a0_0x444fb3(0x242)](){const _0xa62cb5=a0_0x444fb3;try{if(this[_0xa62cb5(0x1a5)])this[_0xa62cb5(0x1a5)][_0xa62cb5(0x2a8)]();if(!this['config'][_0xa62cb5(0x233)])return;const _0x122756=(this[_0xa62cb5(0x314)][_0xa62cb5(0x2b6)]||'08:00')['split'](':'),_0x31cd77=parseInt(_0x122756[0x0])||0x8,_0x10594a=parseInt(_0x122756[0x1])||0x0,_0x2b68d8=_0x10594a+'\x20'+_0x31cd77+_0xa62cb5(0x29e);this[_0xa62cb5(0x285)][_0xa62cb5(0x331)](_0xa62cb5(0x2a0)+_0x31cd77+':'+(_0x10594a<0xa?'0'+_0x10594a:_0x10594a)),this[_0xa62cb5(0x1a5)]=schedule[_0xa62cb5(0x24b)](_0x2b68d8,()=>{const _0x3ba2b4=_0xa62cb5;this[_0x3ba2b4(0x321)]();});}catch(_0x157442){this[_0xa62cb5(0x285)][_0xa62cb5(0x2a2)](_0xa62cb5(0x2bc)+_0x157442[_0xa62cb5(0x2c5)]);}}async[a0_0x444fb3(0x20a)](){const _0x5eadd7=a0_0x444fb3;if(!this[_0x5eadd7(0x23a)]||!this[_0x5eadd7(0x31e)])return;const _0x4fe50f=this[_0x5eadd7(0x314)][_0x5eadd7(0x290)]||0xe;if(this[_0x5eadd7(0x22c)][_0x5eadd7(0x26b)]<_0x4fe50f+(this[_0x5eadd7(0x314)]['minDaysForBaseline']||0x7)){await this[_0x5eadd7(0x31d)](LTM_DP_DRIFT_STATUS,{'val':_0x5eadd7(0x274),'ack':!![]});return;}const _0x349a5a=this['dailyDigests'][_0x5eadd7(0x304)](-_0x4fe50f),_0x3b40fe=this[_0x5eadd7(0x22c)]['slice'](0x0,this['dailyDigests'][_0x5eadd7(0x26b)]-_0x4fe50f),_0x51d213=_0x5eadd7(0x27a)+JSON['stringify'](_0x3b40fe)+_0x5eadd7(0x1c0)+JSON['stringify'](_0x349a5a);try{const _0x368833=await this['geminiModel'][_0x5eadd7(0x21d)](_0x51d213),_0x1379db=JSON[_0x5eadd7(0x21e)](_0x368833[_0x5eadd7(0x33c)][_0x5eadd7(0x1a1)]()[_0x5eadd7(0x30b)](/```json|```/g,'')[_0x5eadd7(0x309)]());_0x1379db['baselineDrift']&&(await this[_0x5eadd7(0x31d)](LTM_DP_DRIFT_STATUS,{'val':_0x1379db[_0x5eadd7(0x33d)],'ack':!![]}),await this[_0x5eadd7(0x31d)](LTM_DP_DRIFT_DETAILS,{'val':_0x1379db[_0x5eadd7(0x1cd)],'ack':!![]}),await this[_0x5eadd7(0x31d)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x5eadd7(0x326)](),'ack':!![]}));}catch(_0x5cf8cf){}}}function a0_0x435f(_0x5b8cbd,_0x794d5f){const _0x193a04=a0_0x1cdf();return a0_0x435f=function(_0x3f81b9,_0x4e653a){_0x3f81b9=_0x3f81b9-0x19b;let _0x1cdf21=_0x193a04[_0x3f81b9];return _0x1cdf21;},a0_0x435f(_0x5b8cbd,_0x794d5f);}if(require[a0_0x444fb3(0x1ca)]!==module)module[a0_0x444fb3(0x34f)]=_0x12bb82=>new CogniLiving(_0x12bb82);else new CogniLiving();