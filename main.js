function a0_0x40ea(_0x17ae62,_0x266467){const _0x437670=a0_0x3a1c();return a0_0x40ea=function(_0x5346ac,_0x2cc1af){_0x5346ac=_0x5346ac-0x139;let _0x3a1c25=_0x437670[_0x5346ac];return _0x3a1c25;},a0_0x40ea(_0x17ae62,_0x266467);}const a0_0x570e77=a0_0x40ea;(function(_0x4151ea,_0x1aa806){const _0x24a814=a0_0x40ea,_0x210e04=_0x4151ea();while(!![]){try{const _0x526952=-parseInt(_0x24a814(0x149))/0x1+-parseInt(_0x24a814(0x13c))/0x2+-parseInt(_0x24a814(0x21a))/0x3+parseInt(_0x24a814(0x1a7))/0x4+parseInt(_0x24a814(0x249))/0x5+parseInt(_0x24a814(0x1f1))/0x6+parseInt(_0x24a814(0x234))/0x7;if(_0x526952===_0x1aa806)break;else _0x210e04['push'](_0x210e04['shift']());}catch(_0x1b4c62){_0x210e04['push'](_0x210e04['shift']());}}}(a0_0x3a1c,0x47c79));const a0_0x2cc1af=(function(){let _0x2acf4e=!![];return function(_0x2bba2a,_0x545fff){const _0x4bf8d6=_0x2acf4e?function(){const _0x26454e=a0_0x40ea;if(_0x545fff){const _0x22c8e8=_0x545fff[_0x26454e(0x14d)](_0x2bba2a,arguments);return _0x545fff=null,_0x22c8e8;}}:function(){};return _0x2acf4e=![],_0x4bf8d6;};}()),a0_0x5346ac=a0_0x2cc1af(this,function(){const _0x13af3b=a0_0x40ea;return a0_0x5346ac[_0x13af3b(0x196)]()[_0x13af3b(0x17e)]('(((.+)+)+)+$')[_0x13af3b(0x196)]()['constructor'](a0_0x5346ac)[_0x13af3b(0x17e)](_0x13af3b(0x1c0));});function a0_0x3a1c(){const _0x1ccbd4=['floor','lastAlertState','./lib/setup','getGenerativeModel','Keine\x20Sensor-AktivitÃ¤t','Daily\x20Activity\x20Vector\x20(24h)','updateHealthVector','Daten\x20nicht\x20verfÃ¼gbar','pressureBuffer','\x20hPa.\x20Einbruch\x20wahrscheinlich.','analysis.energy.insulationScore','infrasoundThreshold','analysis.training.triggerTopology','dailyDigests','setupModeResetScheduler','analysis.health.activityTrend','search','ðŸš¨\x20DRUCKWELLEN-ALARM!\x20StÃ¤rke:\x20','dependencyInstallInProgress','.data.table','Notification\x20Test\x20Failed:\x20','Sensors\x20used\x20for\x20Gait\x20Analysis','sendTo','bind','\x20opened.\x20Peak\x20Pressure:\x20','Fenster\x20geÃ¶ffnet:\x20','Gemini\x20AI\x20initialized.','appendToLog','processSensorEvent','checkThermostats','checkLicense','triggerGaitAnalysis','LTM.triggerDailyDigest',')\x20-\x20Phase\x20D\x20(Comfort\x20Refinement)','calendarInstance','genAI','Gesendet','presenceDevices','ANALYZE_TREND','Lernphase\x20(','toString','onMessage','reed','startService','state','Standard','initHistory','toLowerCase','createDailyDigest','licenseKey','analysis.energy.warmupSources','infrasoundArmingId','healthTrendInterval','\x20Tage)','useWeather','testApiKey','object','776576aIpCzW','infrasoundEnabled','length','NextHours.Location_1.Day_1.current.symbol_desc','timestamp','scanDevices','bootTime','filter','ANOMALY\x20(Real\x20Threat?)','Active\x20Calendar\x20Enforcements\x20(Locks)','setState','door','_calName','sensorLastValues','updateLocation','fill','keys','setPresence','Gemini\x20Init\x20Error:\x20','[Infrasound]\x20ðŸŸ¡\x20Debug-Mode:\x20Alarm\x20detected\x20but\x20suppressed\x20because\x20presence=true.','sources','analysis.energy.pinnForecast','split','refreshCalendar','endsWith','(((.+)+)+)+$','Warm-Up\x20Time\x20(Minutes\x20to\x20Target)','onUnload','runAutopilot','subscribeStates','analysis.energy.activeEnforcements','.system.mode','callback','analysis.automation.description','calendarName','system.presenceWho','CALIB','join','analysisTimer','memoryCache','Kein\x20Kalender-Adapter','Fehler:\x20','lastTrackerEventTime','setupDriftAnalysisScheduler','sensor.door','ltmJob','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','times','push','[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]','generateContent','triggerDailyDigest','systemConfig','message','command','startSystem','\x20hPa\x20(Threshold:\x20','LTM.baselineStatus','forEach','getState','Comfort\x20Train\x20Error:\x20','manual','LTM.rawEventLog','analysis.energy.warmupTimes','analysis.topology.structure','text','now','isGracePeriodActive','Active\x20Ventilation\x20Alerts','driftAnalysisTimer','role','createAllObjects','setHours','analysis.automation.targetValue','1638162ccIocU','log','\x20sequences...','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','checkCalendarTriggers','location','some','enum.rooms.*','NORMAL','motion','add','getForeignObjectsAsync','accuweather.0','stopService','devices','Aktiv\x20(','minDaysForBaseline','instance','isSolar','isArray','setStateAsync','TRAIN_TOPOLOGY','dismissAutomation','geminiModel','info','type','[Calibration]\x20Window\x20','ack','LTM.dailyDigests','handleInfrasound','analysis.energy.ventilationAlerts','PINN\x20AI\x20Forecast','getStateAsync','analysisHistory','exitTimer','checkSolarCondition','Party\x20Mode','cogni-living','ðŸ¤–\x20Butler\x20Training\x20started.\x20Injecting\x20knowledge\x20about\x20','error','number','1623132clOuYp','Nuukanni\x20Security','analysis.automation.triggerAction','val','heiter','Instanz\x20nicht\x20gefunden','ErklÃ¤rt\x20durch:\x20','getEnums','analysis.triggerBriefing','getOverviewData','entries','rawEventLog','âš ï¸\x20Graph-Brain:\x20No\x20training\x20sequences\x20found\x20in\x20LTM.','\x20hPa\x20(Limit:\x20','checkWifiPresence','[Forensics]\x20Infrasound\x20Event\x20correlated:\x20','response','models/gemini-flash-latest','common','debug','sonn','[Forensics]\x20Save\x20failed:\x20','â¤ï¸\x20Auto-Heartbeat:\x20Aktualisiere\x20Gesundheits-Trends...','getOutsideTemperatureNumeric','online','parse','2446745HfFIQC','TRAIN_HEALTH','analysis.training.triggerEnergy','analysis.training.triggerSecurity','guest','ðŸ§ \x20Graph-Brain:\x20Training\x20Behaviour\x20Matrix\x20based\x20on\x20','cancel','analysis.training.triggerHealth','analysisInterval','geminiApiKey','daswetter.0','key','scanThermostats','simulateEnergyMPC','thermostat','Memory\x20Hydration\x20Failed:\x20','monitorEnforcements','updateTopologyMatrix','./lib/dead_man','toFixed','Could\x20not\x20read\x20daily\x20vector:\x20','1957610JNUqML','eventHistory','infrasoundSensorId','ðŸ§ \x20Memory\x20Protection:\x20Restoring\x20persisted\x20AI-Calculations\x20(preventing\x20\x27Cold\x20Start\x27\x20amnesia).','SYSTEM_MODES','analysis.automation.targetId','runPythonHealthCheck','onReady','ðŸŽ“\x20[RL-RESET]\x20Lern-Sperre\x20(Penalty)\x20fÃ¼r\x20\x27','slice','magnet','includes','warn','window','exports','infrasoundLocked','scores','isPresent','\x27\x20wurde\x20manuell\x20vom\x20Benutzer\x20gelÃ¶scht.','stateChange','analysis.energy.rlPenalties','getLtmData','Forensic\x20Infrasound\x20Log','minutes_safe','notifyPushoverInstance','\x20devices.','subscribeForeignStatesAsync','trackerHeartbeat','analysis.health.gaitDebug','analysis.health.todayVector','loadSystemMode','triggerBriefing','[Infrasound]\x20Subscribing\x20to\x20external\x20sensor:\x20','inactivityThresholdHours','Graph-Brain\x20Train\x20Error:\x20','analyzeWindowOpening','setupLtmScheduler','trackerEnabled','sendNotification','enum','exitGraceTimer','temperature','ANALYZE_GAIT','ready','analysis.energy.warmupTargets','updated','resetRLPenalty','LTM.trainingData.sequences','analysis.trigger','SET_LEARNING_MODE','./lib/scanner','currentSystemMode','protectAiMemory','name','automation.triggerAction','from','\x20min\x20ausbleiben.','getForeignStateAsync','getMinutes','map','unshift','application/json','abortExitTimer','json','stringify','Adapter','analysis.security.learningStatus','string','SET_TOPOLOGY','abs','TRAIN_SECURITY','./lib/python_bridge','680336LkXUIe','analysis.training.triggerComfort','send','activityLevel','subscribeForeignStates','Gait\x20Speed\x20Calculation\x20Proof','TRAIN_COMFORT','open','runGeminiAnalysis','PREDICT_ENERGY','Verbunden','\x20rooms\x20(preventing\x20Cold\x20Start\x20Amnesia).','isProVersion','33007zdsIMY','notifyTelegramEnabled','modeResetJob','getCalendarNames','apply','party','analysis.automation.patternDetected','Heizung\x20kann\x20','clear','briefingJob','SYSTEM_DP_MODE','{\x22default\x22:\x2021}','analysis.automation.autoApply','.communicate.request','getTime','notifyTelegramInstance','ALARM','Guest\x20Mode','version','sort','value','namespace','triggerEnergyPrediction','getHours','weatherunderground.0','@google/generative-ai','setObjectNotExistsAsync','config','klar','values','PYTHON_EXE','find','analysis.training.status','Verbindung\x20erfolgreich!','./lib/automation','onStateChange','analysis.security.infrasoundLog'];a0_0x3a1c=function(){return _0x1ccbd4;};return a0_0x3a1c();}a0_0x5346ac();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x570e77(0x162)),installer=require('./lib/installer'),scanner=require(a0_0x570e77(0x27b)),schedulers=require('./lib/scheduler'),topology=require('./lib/topology'),setup=require(a0_0x570e77(0x170)),recorder=require('./lib/recorder'),pythonBridge=require(a0_0x570e77(0x13b)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x570e77(0x246)),automation=require(a0_0x570e77(0x16b)),GEMINI_MODEL=a0_0x570e77(0x22b),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils[a0_0x570e77(0x28a)]{constructor(_0x55a05e){const _0x5a1e22=a0_0x570e77;super({..._0x55a05e,'name':_0x5a1e22(0x216)}),this[_0x5a1e22(0x24a)]=[],this[_0x5a1e22(0x212)]=[],this['rawEventLog']=[],this[_0x5a1e22(0x17b)]=[],this[_0x5a1e22(0x1b4)]={},this[_0x5a1e22(0x1db)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this[_0x5a1e22(0x271)]=null,this[_0x5a1e22(0x1ea)]=![],this['genAI']=null,this[_0x5a1e22(0x208)]=null,this[_0x5a1e22(0x27c)]=setup[_0x5a1e22(0x24d)][_0x5a1e22(0x1f9)],this[_0x5a1e22(0x148)]=![],this[_0x5a1e22(0x16f)]=![],this['analysisTimer']=null,this[_0x5a1e22(0x1d4)]=null,this[_0x5a1e22(0x14b)]=null,this[_0x5a1e22(0x1ec)]=null,this['briefingJob']=null,this[_0x5a1e22(0x264)]=null,this[_0x5a1e22(0x1a2)]=null,this[_0x5a1e22(0x180)]=![],this[_0x5a1e22(0x1d1)]=Date['now'](),this[_0x5a1e22(0x1ce)]=null,this[_0x5a1e22(0x1ad)]=Date[_0x5a1e22(0x1e9)](),this[_0x5a1e22(0x258)]=![],this[_0x5a1e22(0x176)]=[],this['on'](_0x5a1e22(0x274),this[_0x5a1e22(0x250)][_0x5a1e22(0x185)](this)),this['on'](_0x5a1e22(0x25c),this[_0x5a1e22(0x16c)][_0x5a1e22(0x185)](this)),this['on']('unload',this[_0x5a1e22(0x1c2)][_0x5a1e22(0x185)](this)),this['on'](_0x5a1e22(0x1dc),this[_0x5a1e22(0x197)][_0x5a1e22(0x185)](this));}async[a0_0x570e77(0x250)](){const _0x5bc421=a0_0x570e77;this['log']['info']('cogni-living\x20adapter\x20starting\x20(v'+this[_0x5bc421(0x15b)]+_0x5bc421(0x18f));if(!installer['checkAndInstall'](this,()=>this[_0x5bc421(0x1de)]()))return;}async['startSystem'](){const _0x2ea15e=a0_0x570e77;await setup['initZombies'](this);try{this[_0x2ea15e(0x148)]=await setup[_0x2ea15e(0x18c)](this[_0x2ea15e(0x164)][_0x2ea15e(0x19f)]);}catch(_0x427ce7){}if(!this[_0x2ea15e(0x164)][_0x2ea15e(0x26a)]||this[_0x2ea15e(0x164)][_0x2ea15e(0x26a)]<0.1)this['config'][_0x2ea15e(0x26a)]=0xc;await setup[_0x2ea15e(0x19c)](this),await setup['initSystemConfig'](this);try{const _0x337da3=await this[_0x2ea15e(0x211)](_0x2ea15e(0x1e6)),_0x5cc390=await this[_0x2ea15e(0x211)]('analysis.energy.warmupSources');_0x337da3&&_0x337da3[_0x2ea15e(0x21d)]&&_0x5cc390&&_0x5cc390[_0x2ea15e(0x21d)]&&(Date[_0x2ea15e(0x1e9)]()-_0x337da3['ts']<0x4*0xe10*0x3e8&&(this['memoryCache']={'times':JSON[_0x2ea15e(0x233)](_0x337da3['val']),'sources':JSON[_0x2ea15e(0x233)](_0x5cc390[_0x2ea15e(0x21d)])},this[_0x2ea15e(0x1f2)][_0x2ea15e(0x209)]('ðŸ§ \x20Memory:\x20Cache\x20hydrated\x20with\x20'+Object[_0x2ea15e(0x1b7)](this[_0x2ea15e(0x1ce)][_0x2ea15e(0x1d6)])[_0x2ea15e(0x1a9)]+_0x2ea15e(0x147))));}catch(_0x2940a0){this['log'][_0x2ea15e(0x255)](_0x2ea15e(0x243)+_0x2940a0[_0x2ea15e(0x1dc)]);}if(this[_0x2ea15e(0x164)][_0x2ea15e(0x23d)])try{this[_0x2ea15e(0x191)]=new GoogleGenerativeAI(this[_0x2ea15e(0x164)]['geminiApiKey']),this[_0x2ea15e(0x208)]=this['genAI'][_0x2ea15e(0x171)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2ea15e(0x286)}}),this[_0x2ea15e(0x1f2)][_0x2ea15e(0x209)](_0x2ea15e(0x188));}catch(_0x1cf01a){this[_0x2ea15e(0x1f2)][_0x2ea15e(0x218)](_0x2ea15e(0x1b9)+_0x1cf01a[_0x2ea15e(0x1dc)]);}await setup[_0x2ea15e(0x1ee)](this),await this[_0x2ea15e(0x267)](),await this[_0x2ea15e(0x163)](_0x2ea15e(0x1bc),{'type':_0x2ea15e(0x19a),'common':{'name':_0x2ea15e(0x210),'type':_0x2ea15e(0x28c),'role':_0x2ea15e(0x288),'read':!![],'write':![]},'native':{}}),await this[_0x2ea15e(0x163)](_0x2ea15e(0x20f),{'type':_0x2ea15e(0x19a),'common':{'name':_0x2ea15e(0x1eb),'type':_0x2ea15e(0x28c),'role':'json','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.energy.warmupTimes',{'type':'state','common':{'name':_0x2ea15e(0x1c1),'type':_0x2ea15e(0x28c),'role':_0x2ea15e(0x288),'read':!![],'write':![]},'native':{}}),await this[_0x2ea15e(0x163)](_0x2ea15e(0x275),{'type':_0x2ea15e(0x19a),'common':{'name':'Warm-Up\x20Target\x20Temps\x20(JSON)','type':_0x2ea15e(0x28c),'role':_0x2ea15e(0x288),'read':!![],'write':!![],'def':_0x2ea15e(0x154)},'native':{}}),await this[_0x2ea15e(0x163)](_0x2ea15e(0x25d),{'type':_0x2ea15e(0x19a),'common':{'name':'Reinforcement\x20Learning\x20Penalties','type':_0x2ea15e(0x28c),'role':_0x2ea15e(0x288),'read':!![],'write':![],'def':'{}'},'native':{}}),await this['setObjectNotExistsAsync'](_0x2ea15e(0x17d),{'type':_0x2ea15e(0x19a),'common':{'name':'General\x20Activity\x20Trend\x20(%)','type':_0x2ea15e(0x219),'role':_0x2ea15e(0x15d),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x2ea15e(0x163)]('analysis.health.gaitSensors',{'type':_0x2ea15e(0x19a),'common':{'name':_0x2ea15e(0x183),'type':'string','role':_0x2ea15e(0x1e8),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2ea15e(0x1c5),{'type':_0x2ea15e(0x19a),'common':{'name':_0x2ea15e(0x1b0),'type':_0x2ea15e(0x28c),'role':_0x2ea15e(0x288),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x2ea15e(0x16d),{'type':_0x2ea15e(0x19a),'common':{'name':_0x2ea15e(0x25f),'type':_0x2ea15e(0x28c),'role':_0x2ea15e(0x288),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x2ea15e(0x163)](_0x2ea15e(0x265),{'type':_0x2ea15e(0x19a),'common':{'name':_0x2ea15e(0x141),'type':_0x2ea15e(0x28c),'role':_0x2ea15e(0x1e8),'read':!![],'write':![]},'native':{}}),await this[_0x2ea15e(0x163)](_0x2ea15e(0x266),{'type':'state','common':{'name':_0x2ea15e(0x173),'type':_0x2ea15e(0x28c),'role':_0x2ea15e(0x288),'read':!![],'write':![],'def':_0x2ea15e(0x1d8)},'native':{}});try{const _0x20e0fe=await this[_0x2ea15e(0x211)](_0x2ea15e(0x1e5));if(_0x20e0fe&&_0x20e0fe[_0x2ea15e(0x21d)])this['rawEventLog']=JSON['parse'](_0x20e0fe[_0x2ea15e(0x21d)]);}catch(_0x48a6bc){this[_0x2ea15e(0x225)]=[];}try{const _0x3d4e01=await this[_0x2ea15e(0x211)](_0x2ea15e(0x20d));if(_0x3d4e01&&_0x3d4e01['val'])this[_0x2ea15e(0x17b)]=JSON['parse'](_0x3d4e01[_0x2ea15e(0x21d)]);}catch(_0x5b051c){this[_0x2ea15e(0x17b)]=[];}const _0x21176f=this[_0x2ea15e(0x17b)][_0x2ea15e(0x1a9)]>=(this[_0x2ea15e(0x164)][_0x2ea15e(0x201)]||0x7)?_0x2ea15e(0x200)+this[_0x2ea15e(0x17b)][_0x2ea15e(0x1a9)]+_0x2ea15e(0x1a3):_0x2ea15e(0x195)+this['dailyDigests'][_0x2ea15e(0x1a9)]+'/'+(this[_0x2ea15e(0x164)][_0x2ea15e(0x201)]||0x7)+')';await this[_0x2ea15e(0x205)](_0x2ea15e(0x1e0),{'val':_0x21176f,'ack':!![]}),this[_0x2ea15e(0x1c4)](_0x2ea15e(0x279)),this[_0x2ea15e(0x1c4)](_0x2ea15e(0x18e)),this['subscribeStates']('system.mode'),this[_0x2ea15e(0x1c4)](_0x2ea15e(0x222)),this[_0x2ea15e(0x1c4)](_0x2ea15e(0x21c)),this[_0x2ea15e(0x1c4)](_0x2ea15e(0x155)),this[_0x2ea15e(0x1c4)](_0x2ea15e(0x237)),this['subscribeStates'](_0x2ea15e(0x23b)),this[_0x2ea15e(0x1c4)](_0x2ea15e(0x236)),this[_0x2ea15e(0x1c4)]('analysis.training.triggerComfort'),this['subscribeStates']('analysis.training.triggerTopology'),this[_0x2ea15e(0x1c4)]('analysis.energy.mpcActive'),this[_0x2ea15e(0x1c4)](_0x2ea15e(0x1a0));this[_0x2ea15e(0x164)][_0x2ea15e(0x1a8)]&&this['config'][_0x2ea15e(0x24b)]&&(this['log'][_0x2ea15e(0x209)](_0x2ea15e(0x269)+this[_0x2ea15e(0x164)][_0x2ea15e(0x24b)]),this[_0x2ea15e(0x140)](this['config'][_0x2ea15e(0x24b)]));const _0xcf0b4c=this[_0x2ea15e(0x164)][_0x2ea15e(0x1ff)];if(_0xcf0b4c)for(const _0x3a74a1 of _0xcf0b4c){await this[_0x2ea15e(0x263)](_0x3a74a1['id']);}const _0x3c5759=this[_0x2ea15e(0x164)][_0x2ea15e(0x193)];if(_0x3c5759)for(const _0x2fc550 of _0x3c5759){await this[_0x2ea15e(0x263)](_0x2fc550);}if(this['config'][_0x2ea15e(0x14a)]&&this[_0x2ea15e(0x164)][_0x2ea15e(0x158)])await this['subscribeForeignStatesAsync'](this[_0x2ea15e(0x164)][_0x2ea15e(0x158)]+_0x2ea15e(0x156));setTimeout(()=>this[_0x2ea15e(0x228)](),0x1388);if(this['analysisTimer'])clearInterval(this[_0x2ea15e(0x1cd)]);const _0x485db7=this[_0x2ea15e(0x164)][_0x2ea15e(0x23c)]||0xf;_0x485db7>0x0&&(this['analysisTimer']=setInterval(()=>{const _0x7e1ea6=_0x2ea15e;this[_0x7e1ea6(0x1c3)](),automation['checkCalendarTriggers'](this),automation[_0x7e1ea6(0x244)](this);},_0x485db7*0x3c*0x3e8));setTimeout(()=>{const _0x56376b=_0x2ea15e;automation[_0x56376b(0x1f5)](this),automation[_0x56376b(0x244)](this);},0x2710);this[_0x2ea15e(0x164)][_0x2ea15e(0x26e)]!==![]&&(this[_0x2ea15e(0x264)]=setInterval(()=>{const _0x17a67b=_0x2ea15e;if(this['isProVersion']){const _0x1f2039=Date[_0x17a67b(0x1e9)](),_0x266302=this[_0x17a67b(0x1d1)]||_0x1f2039,_0xaff40c=(_0x1f2039-_0x266302)/0x3e8;_0xaff40c>0x2&&(this[_0x17a67b(0x1d1)]=_0x1f2039,pythonBridge[_0x17a67b(0x13e)](this,'TRACK_EVENT',{'room':null,'dt':_0xaff40c}));}},0xbb8));if(this['healthTrendInterval'])clearInterval(this['healthTrendInterval']);this[_0x2ea15e(0x1a2)]=setInterval(()=>{const _0x296d85=_0x2ea15e;this['isProVersion']&&(this[_0x296d85(0x1f2)][_0x296d85(0x209)](_0x296d85(0x230)),this[_0x296d85(0x24f)]());},0x4*0x3c*0x3c*0x3e8),schedulers[_0x2ea15e(0x26d)](this,()=>aiAgent['createDailyDigest'](this,pythonBridge)),schedulers[_0x2ea15e(0x17c)](this),schedulers[_0x2ea15e(0x1d2)](this,()=>aiAgent['runBaselineDriftAnalysis'](this)),schedulers['setupBriefingScheduler'](this,()=>aiAgent['sendMorningBriefing'](this)),pythonBridge[_0x2ea15e(0x199)](this,installer[_0x2ea15e(0x167)]),setTimeout(async()=>{const _0x3754ea=_0x2ea15e;await topology['updateTopology'](this);try{const _0x3ae2f8=await this[_0x3754ea(0x211)](_0x3754ea(0x1e7));if(_0x3ae2f8&&_0x3ae2f8['val'])pythonBridge[_0x3754ea(0x13e)](this,_0x3754ea(0x28d),JSON[_0x3754ea(0x233)](_0x3ae2f8['val']));}catch(_0x21b01f){}this[_0x3754ea(0x24f)](),this[_0x3754ea(0x18d)](),this[_0x3754ea(0x15f)](),this['updateHealthVector']();},0x1388);}['onUnload'](_0x3e09d4){const _0x5abb17=a0_0x570e77;if(this[_0x5abb17(0x1cd)])clearInterval(this[_0x5abb17(0x1cd)]);if(this[_0x5abb17(0x1ec)])clearInterval(this[_0x5abb17(0x1ec)]);if(this[_0x5abb17(0x264)])clearInterval(this['trackerHeartbeat']);if(this['healthTrendInterval'])clearInterval(this[_0x5abb17(0x1a2)]);if(this[_0x5abb17(0x1d4)])this[_0x5abb17(0x1d4)]['cancel']();if(this[_0x5abb17(0x14b)])this[_0x5abb17(0x14b)]['cancel']();if(this[_0x5abb17(0x152)])this[_0x5abb17(0x152)][_0x5abb17(0x23a)]();recorder[_0x5abb17(0x287)](this),pythonBridge[_0x5abb17(0x1fe)](this),_0x3e09d4();}async['onStateChange'](_0x379631,_0x1b689b){const _0x178f60=a0_0x570e77;if(!_0x1b689b||this['dependencyInstallInProgress'])return;if(_0x379631[_0x178f60(0x254)]('telegram')&&_0x379631[_0x178f60(0x1bf)]('communicate.request')&&_0x1b689b[_0x178f60(0x21d)])return;if(this[_0x178f60(0x164)][_0x178f60(0x1a8)]&&_0x379631===this[_0x178f60(0x164)][_0x178f60(0x24b)]){this[_0x178f60(0x20e)](_0x1b689b[_0x178f60(0x21d)]);return;}if(_0x379631===this[_0x178f60(0x15e)]+_0x178f60(0x1c6)){if(_0x1b689b['val']&&Object[_0x178f60(0x166)](setup[_0x178f60(0x24d)])[_0x178f60(0x254)](_0x1b689b['val'])){this['currentSystemMode']=_0x1b689b[_0x178f60(0x21d)];if(_0x1b689b['val']===setup[_0x178f60(0x24d)]['VACATION'])await recorder[_0x178f60(0x1b8)](this,![]);else await recorder[_0x178f60(0x1b8)](this,!![]);if(this['isProVersion']){let _0xd55a51=![],_0x5f6146=0x0,_0x2f43bf=_0x178f60(0x1e4);if(this[_0x178f60(0x27c)]===_0x178f60(0x14e))_0xd55a51=!![],_0x5f6146=0x168,_0x2f43bf=_0x178f60(0x215);else this[_0x178f60(0x27c)]===_0x178f60(0x238)&&(_0xd55a51=!![],_0x5f6146=0x5a0,_0x2f43bf=_0x178f60(0x15a));pythonBridge['send'](this,_0x178f60(0x27a),{'active':_0xd55a51,'duration':_0x5f6146,'label':_0x2f43bf}),await this[_0x178f60(0x205)](_0x178f60(0x28b),{'val':JSON[_0x178f60(0x289)]({'active':_0xd55a51,'label':_0x2f43bf,'timestamp':Date['now']()}),'ack':!![]});}}if(!_0x1b689b[_0x178f60(0x20c)])this[_0x178f60(0x1b1)](_0x379631,{'val':this[_0x178f60(0x27c)],'ack':!![]});return;}_0x379631[_0x178f60(0x1bf)](_0x178f60(0x1a0))&&_0x1b689b[_0x178f60(0x20c)]&&this[_0x178f60(0x27d)](_0x1b689b[_0x178f60(0x21d)]);if(!_0x1b689b[_0x178f60(0x20c)]){if(_0x379631[_0x178f60(0x254)](_0x178f60(0x279))&&_0x1b689b[_0x178f60(0x21d)]){this[_0x178f60(0x1b1)](_0x379631,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this);return;}if(_0x379631['includes'](_0x178f60(0x1da))&&_0x1b689b[_0x178f60(0x21d)]){this[_0x178f60(0x1b1)](_0x379631,{'val':![],'ack':!![]});if(this[_0x178f60(0x148)])aiAgent[_0x178f60(0x19e)](this,pythonBridge);return;}if(_0x379631[_0x178f60(0x254)](_0x178f60(0x268))&&_0x1b689b['val']){this[_0x178f60(0x1b1)](_0x379631,{'val':![],'ack':!![]}),aiAgent['sendMorningBriefing'](this);return;}if(_0x379631[_0x178f60(0x254)](_0x178f60(0x27f))&&_0x1b689b[_0x178f60(0x21d)]){this['setState'](_0x379631,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x379631['includes'](_0x178f60(0x237))&&_0x1b689b[_0x178f60(0x21d)]){this['setState'](_0x379631,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x55f136=await this[_0x178f60(0x211)]('LTM.trainingData.sequences');if(_0x55f136&&_0x55f136[_0x178f60(0x21d)]){const _0x2e92c7=JSON[_0x178f60(0x233)](_0x55f136[_0x178f60(0x21d)]);this['setStateAsync'](_0x178f60(0x169),{'val':'Sec-Training\x20started...','ack':!![]}),pythonBridge['send'](this,_0x178f60(0x13a),{'sequences':_0x2e92c7});}}catch(_0x4eeb5f){}return;}if(_0x379631[_0x178f60(0x254)](_0x178f60(0x23b))&&_0x1b689b[_0x178f60(0x21d)]){this[_0x178f60(0x1b1)](_0x379631,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x245724=await this[_0x178f60(0x211)](_0x178f60(0x20d));if(_0x245724&&_0x245724[_0x178f60(0x21d)])pythonBridge['send'](this,_0x178f60(0x235),{'digests':JSON['parse'](_0x245724[_0x178f60(0x21d)])});}catch(_0x54fb5c){}return;}if(_0x379631[_0x178f60(0x254)](_0x178f60(0x236))&&_0x1b689b['val']){this[_0x178f60(0x1b1)](_0x379631,{'val':![],'ack':!![]});if(this[_0x178f60(0x148)])try{const _0x11940c=await this['getStateAsync']('LTM.trainingData.thermodynamics');if(_0x11940c&&_0x11940c[_0x178f60(0x21d)])pythonBridge[_0x178f60(0x13e)](this,'TRAIN_ENERGY',{'points':JSON[_0x178f60(0x233)](_0x11940c[_0x178f60(0x21d)])});}catch(_0x54f2e6){}return;}if(_0x379631[_0x178f60(0x254)](_0x178f60(0x13d))&&_0x1b689b[_0x178f60(0x21d)]){this[_0x178f60(0x1b1)](_0x379631,{'val':![],'ack':!![]});if(this[_0x178f60(0x148)])try{const _0x344d52=await this['getStateAsync'](_0x178f60(0x1e5));if(_0x344d52&&_0x344d52[_0x178f60(0x21d)]){const _0x347ab0={};this['config'][_0x178f60(0x1ff)]&&Array[_0x178f60(0x204)](this[_0x178f60(0x164)][_0x178f60(0x1ff)])&&this['config'][_0x178f60(0x1ff)]['forEach'](_0x3bd382=>{const _0x2567c0=_0x178f60;if(_0x3bd382['id']&&_0x3bd382[_0x2567c0(0x20a)])_0x347ab0[_0x3bd382['id']]=_0x3bd382[_0x2567c0(0x20a)];}),this['log'][_0x178f60(0x209)](_0x178f60(0x217)+Object[_0x178f60(0x1b7)](_0x347ab0)['length']+_0x178f60(0x262)),pythonBridge['send'](this,_0x178f60(0x142),{'events':JSON[_0x178f60(0x233)](_0x344d52[_0x178f60(0x21d)]),'deviceMap':_0x347ab0});}}catch(_0x4098dc){this[_0x178f60(0x1f2)]['error'](_0x178f60(0x1e3)+_0x4098dc[_0x178f60(0x1dc)]);}return;}if(_0x379631['includes'](_0x178f60(0x17a))&&_0x1b689b['val']){this[_0x178f60(0x1b1)](_0x379631,{'val':![],'ack':!![]}),topology['updateTopology'](this);if(this[_0x178f60(0x148)])try{const _0x37a8a4=await this[_0x178f60(0x211)](_0x178f60(0x278));if(_0x37a8a4&&_0x37a8a4['val']){const _0x270354=JSON['parse'](_0x37a8a4['val']);this[_0x178f60(0x1f2)][_0x178f60(0x209)](_0x178f60(0x239)+_0x270354['length']+_0x178f60(0x1f3)),pythonBridge[_0x178f60(0x13e)](this,_0x178f60(0x206),{'sequences':_0x270354});}else this[_0x178f60(0x1f2)]['warn'](_0x178f60(0x226));}catch(_0x207fac){this[_0x178f60(0x1f2)][_0x178f60(0x218)](_0x178f60(0x26b)+_0x207fac[_0x178f60(0x1dc)]);}return;}}if(this['config'][_0x178f60(0x193)]&&this[_0x178f60(0x164)][_0x178f60(0x193)]['includes'](_0x379631)){await this[_0x178f60(0x228)]();return;}const _0x32a676=(this[_0x178f60(0x164)]['devices']||[])[_0x178f60(0x168)](_0x3392d3=>_0x3392d3['id']===_0x379631);if(_0x32a676){const _0x5de4e8=await recorder[_0x178f60(0x18a)](this,_0x379631,_0x1b689b,_0x32a676);_0x5de4e8&&_0x5de4e8[_0x178f60(0x20a)]===_0x178f60(0x1fa)&&_0x5de4e8[_0x178f60(0x1f6)]&&this[_0x178f60(0x148)]&&deadMan[_0x178f60(0x1b5)](this,_0x5de4e8[_0x178f60(0x1f6)]),_0x1b689b['val']&&(_0x1b689b['val']===!![]||_0x1b689b[_0x178f60(0x21d)]===0x1||String(_0x1b689b[_0x178f60(0x21d)])['toLowerCase']()===_0x178f60(0x143))&&(_0x32a676['type']&&(_0x32a676[_0x178f60(0x20a)]['includes'](_0x178f60(0x256))||_0x32a676[_0x178f60(0x20a)]['includes']('door')||_0x32a676[_0x178f60(0x20a)][_0x178f60(0x254)](_0x178f60(0x253)))&&this[_0x178f60(0x26c)](_0x32a676)),(_0x32a676[_0x178f60(0x20a)]==='temperature'||_0x32a676['type']===_0x178f60(0x242))&&automation['cleanupGhostInterventions'](this);}}async[a0_0x570e77(0x27d)](_0x5dae3e){const _0xa685fb=a0_0x570e77;if(!this[_0xa685fb(0x1ce)]||Date[_0xa685fb(0x1e9)]()-this[_0xa685fb(0x1ad)]>0x493e0)return;if(!this['memoryCache'][_0xa685fb(0x1bb)]||!this[_0xa685fb(0x1ce)]['times'])return;try{const _0xdca075=JSON[_0xa685fb(0x233)](_0x5dae3e),_0x4b79f2=this[_0xa685fb(0x1ce)][_0xa685fb(0x1bb)];let _0xc567a=![];for(const _0x1bd3ed in _0x4b79f2){if(_0x4b79f2[_0x1bd3ed][_0xa685fb(0x254)]('AI')&&_0xdca075[_0x1bd3ed]&&!_0xdca075[_0x1bd3ed][_0xa685fb(0x254)]('AI')){_0xc567a=!![];break;}}_0xc567a&&(this['log'][_0xa685fb(0x209)](_0xa685fb(0x24c)),await this[_0xa685fb(0x205)]('analysis.energy.warmupTimes',{'val':JSON[_0xa685fb(0x289)](this[_0xa685fb(0x1ce)]['times']),'ack':!![]}),await this[_0xa685fb(0x205)]('analysis.energy.warmupSources',{'val':JSON[_0xa685fb(0x289)](this['memoryCache'][_0xa685fb(0x1bb)]),'ack':!![]}));}catch(_0x513b94){}}async[a0_0x570e77(0x197)](_0x111f68){const _0x34e574=a0_0x570e77;if(typeof _0x111f68==='object'&&_0x111f68[_0x34e574(0x1dc)]){if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x18b))try{const _0x38d23b=await automation[_0x34e574(0x240)](this);this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'results':_0x38d23b},_0x111f68['callback']);}catch(_0x22c9e3){this[_0x34e574(0x184)](_0x111f68['from'],_0x111f68[_0x34e574(0x1dd)],{'success':![],'error':_0x22c9e3['message']},_0x111f68['callback']);}else{if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x241))try{const {current_temps:_0x4e6e59,t_out:_0x3ba65f,targets:_0x1cf8fe,t_forecast:_0xfbc4bc}=_0x111f68[_0x34e574(0x1dc)],_0x3b4479=[];let _0x4ec396={};try{const _0x2bb090=await this['getStateAsync'](_0x34e574(0x178));if(_0x2bb090&&_0x2bb090[_0x34e574(0x21d)]){const _0x25ed21=JSON[_0x34e574(0x233)](_0x2bb090['val']);_0x4ec396=_0x25ed21[_0x34e574(0x259)]||_0x25ed21;}}catch(_0x2e47ff){}const _0x5be59b=_0xfbc4bc!==undefined&&_0xfbc4bc!==null?(_0x3ba65f+_0xfbc4bc)/0x2:_0x3ba65f;for(const [_0x1a0e78,_0x263e6d]of Object[_0x34e574(0x224)](_0x4e6e59)){const _0x45ff53=_0x1cf8fe[_0x1a0e78]||0x15;if(_0x263e6d<=_0x45ff53)continue;let _0x1f5bf1=_0x4ec396[_0x1a0e78]||-0.5;if(_0x1f5bf1>=0x0)_0x1f5bf1=-0.5;const _0x38152f=Math[_0x34e574(0x139)](_0x1f5bf1),_0x285e18=_0x263e6d-_0x45ff53;let _0x3cb872=Math['floor'](_0x285e18/_0x38152f*0x3c);const _0x15e8c4=_0x263e6d-_0x3ba65f,_0x5da12b=_0x263e6d-_0x5be59b;if(_0x5da12b!==0x0&&_0x15e8c4!==0x0){const _0x508ba3=_0x15e8c4/_0x5da12b;_0x3cb872=Math[_0x34e574(0x16e)](_0x3cb872*_0x508ba3);}if(_0x3cb872>0xf){if(_0x3cb872>0xf0)_0x3cb872=0xf0;_0x3b4479[_0x34e574(0x1d7)]({'room':_0x1a0e78,'minutes_safe':_0x3cb872,'target':_0x45ff53,'current':_0x263e6d,'savings_msg':_0x34e574(0x150)+_0x3cb872+_0x34e574(0x281)});}}_0x3b4479[_0x34e574(0x15c)]((_0x1fe3e9,_0x1f7b4d)=>_0x1f7b4d[_0x34e574(0x260)]-_0x1fe3e9['minutes_safe']),this[_0x34e574(0x184)](_0x111f68['from'],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'proposals':_0x3b4479},_0x111f68[_0x34e574(0x1c7)]);}catch(_0x15a294){this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68['command'],{'success':![],'error':_0x15a294[_0x34e574(0x1dc)]},_0x111f68[_0x34e574(0x1c7)]);}else{if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x1be))try{await automation['updateSchedulePreview'](this),this['sendTo'](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![]},_0x111f68['callback']);}catch(_0x2ae177){this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':![],'error':_0x2ae177[_0x34e574(0x1dc)]},_0x111f68[_0x34e574(0x1c7)]);}else{if(_0x111f68['command']===_0x34e574(0x277))try{const _0x3aa1c1=_0x111f68[_0x34e574(0x1dc)][_0x34e574(0x23f)],_0xf75c50='analysis.energy.rlPenalties',_0x1a26c1=await this[_0x34e574(0x211)](_0xf75c50);let _0x3c328d={};if(_0x1a26c1&&_0x1a26c1[_0x34e574(0x21d)])try{_0x3c328d=JSON['parse'](_0x1a26c1['val']);}catch(_0x1ca441){}_0x3aa1c1&&_0x3c328d[_0x3aa1c1]?(delete _0x3c328d[_0x3aa1c1],await this['setStateAsync'](_0xf75c50,{'val':JSON['stringify'](_0x3c328d),'ack':!![]}),this[_0x34e574(0x1f2)]['info'](_0x34e574(0x251)+_0x3aa1c1+_0x34e574(0x25b)),this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![]},_0x111f68[_0x34e574(0x1c7)])):this['sendTo'](_0x111f68[_0x34e574(0x280)],_0x111f68['command'],{'success':![],'error':'Key\x20not\x20found\x20or\x20not\x20provided'},_0x111f68[_0x34e574(0x1c7)]);}catch(_0x5575d5){this['sendTo'](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':![],'error':_0x5575d5[_0x34e574(0x1dc)]},_0x111f68[_0x34e574(0x1c7)]);}else{if(_0x111f68['command']===_0x34e574(0x207))await this[_0x34e574(0x205)](_0x34e574(0x14f),{'val':![],'ack':!![]}),await this[_0x34e574(0x205)]('analysis.automation.description',{'val':'','ack':!![]}),await this[_0x34e574(0x205)](_0x34e574(0x24e),{'val':'','ack':!![]}),this['sendTo'](_0x111f68['from'],_0x111f68[_0x34e574(0x1dd)],{'success':!![]},_0x111f68[_0x34e574(0x1c7)]);else{if(_0x111f68[_0x34e574(0x1dd)]==='simulateButler'){const {targetId:_0x5ec939,targetValue:_0x222758}=_0x111f68[_0x34e574(0x1dc)];await this[_0x34e574(0x205)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x34e574(0x205)](_0x34e574(0x1c8),{'val':'Simulation\x20durch\x20Admin\x20(Test)','ack':!![]}),await this[_0x34e574(0x205)](_0x34e574(0x24e),{'val':_0x5ec939,'ack':!![]}),await this[_0x34e574(0x205)](_0x34e574(0x1f0),{'val':String(_0x222758),'ack':!![]}),this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![]},_0x111f68[_0x34e574(0x1c7)]);}else{if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x1a5))try{const _0x255689=_0x111f68[_0x34e574(0x1dc)]['apiKey'];if(!_0x255689)throw new Error('Kein\x20API\x20Key\x20Ã¼bergeben');const _0x58a08b=new GoogleGenerativeAI(_0x255689),_0x25076c=_0x58a08b[_0x34e574(0x171)]({'model':GEMINI_MODEL}),_0x3719e0=await _0x25076c[_0x34e574(0x1d9)]('Test'),_0x1486c8=await _0x3719e0[_0x34e574(0x22a)];if(_0x1486c8[_0x34e574(0x1e8)]())this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'message':_0x34e574(0x16a)},_0x111f68['callback']);else throw new Error('Keine\x20Antwort\x20von\x20Gemini');}catch(_0x9321e){this[_0x34e574(0x184)](_0x111f68['from'],_0x111f68['command'],{'success':![],'message':_0x9321e['message']},_0x111f68['callback']);}else{if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x1ac))try{const _0x5ca6de=await scanner['scanForDevices'](this,_0x111f68[_0x34e574(0x1dc)]||{});this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'devices':_0x5ca6de},_0x111f68[_0x34e574(0x1c7)]);}catch(_0x184e88){this[_0x34e574(0x184)](_0x111f68['from'],_0x111f68[_0x34e574(0x1dd)],{'success':![],'error':_0x184e88[_0x34e574(0x1dc)]},_0x111f68['callback']);}else{if(_0x111f68['command']===_0x34e574(0x245))try{const {matrix:_0x3d956d}=_0x111f68[_0x34e574(0x1dc)],_0x433ae3=await this[_0x34e574(0x211)](_0x34e574(0x1e7));if(_0x433ae3&&_0x433ae3[_0x34e574(0x21d)]){const _0x4b46a7=JSON['parse'](_0x433ae3['val']);_0x4b46a7['matrix']=_0x3d956d,_0x4b46a7[_0x34e574(0x276)]=Date[_0x34e574(0x1e9)](),await this['setStateAsync']('analysis.topology.structure',{'val':JSON[_0x34e574(0x289)](_0x4b46a7),'ack':!![]}),pythonBridge['send'](this,_0x34e574(0x28d),_0x4b46a7);}this['sendTo'](_0x111f68['from'],_0x111f68['command'],{'success':!![]},_0x111f68[_0x34e574(0x1c7)]);}catch(_0x2e62e9){this[_0x34e574(0x1f2)][_0x34e574(0x218)](_0x2e62e9);}else{if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x25e))this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'dailyDigests':this[_0x34e574(0x17b)]||[],'analysisHistory':this['analysisHistory']||[]},_0x111f68[_0x34e574(0x1c7)]);else{if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x223)){const _0x5125f6=this[_0x34e574(0x17b)][_0x34e574(0x1a9)];let _0x426068=new Array(0x18)[_0x34e574(0x1b6)](0x0);try{const _0x104b5e=await this[_0x34e574(0x211)](_0x34e574(0x266));if(_0x104b5e&&_0x104b5e[_0x34e574(0x21d)])_0x426068=JSON[_0x34e574(0x233)](_0x104b5e[_0x34e574(0x21d)]);else{const _0x4a7bd7=new Date()[_0x34e574(0x1ef)](0x0,0x0,0x0,0x0);this[_0x34e574(0x24a)]&&this[_0x34e574(0x24a)][_0x34e574(0x1e1)](_0x408bc6=>{const _0x10c788=_0x34e574;if(_0x408bc6[_0x10c788(0x1ab)]>=_0x4a7bd7){const _0x236750=new Date(_0x408bc6[_0x10c788(0x1ab)])[_0x10c788(0x160)]();if(_0x236750>=0x0&&_0x236750<0x18)_0x426068[_0x236750]++;}});}}catch(_0x14fe92){this[_0x34e574(0x1f2)][_0x34e574(0x255)](_0x34e574(0x248)+_0x14fe92['message']);}let _0x12172a=![],_0x36f235='',_0x443ae0='',_0x34a069='';try{const _0x4df52c=await this['getStateAsync'](_0x34e574(0x14f));if(_0x4df52c&&_0x4df52c[_0x34e574(0x21d)]){_0x12172a=!![];const _0x53f914=await this['getStateAsync']('analysis.automation.description');_0x36f235=_0x53f914?_0x53f914[_0x34e574(0x21d)]:'';const _0x1d224f=await this[_0x34e574(0x211)](_0x34e574(0x24e));_0x443ae0=_0x1d224f?_0x1d224f[_0x34e574(0x21d)]:'';const _0x594dcd=await this[_0x34e574(0x211)](_0x34e574(0x1f0));_0x34a069=_0x594dcd?_0x594dcd[_0x34e574(0x21d)]:'';}}catch(_0x4fbc8d){}const _0x4bbbc0=await this[_0x34e574(0x214)](),_0x4577e0=(this[_0x34e574(0x164)][_0x34e574(0x1ff)]||[])[_0x34e574(0x1f7)](_0x2fc3ad=>_0x2fc3ad[_0x34e574(0x203)]),_0x4b5ef0=_0x4bbbc0&&_0x4577e0;let _0x136110='';try{const _0x40db13=await this['getStateAsync'](_0x34e574(0x1ca));if(_0x40db13&&_0x40db13[_0x34e574(0x21d)])_0x136110=_0x40db13['val'];}catch(_0x34b3e9){}this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68['command'],{'success':!![],'eventHistory':this[_0x34e574(0x24a)][_0x34e574(0x252)](0x0,0xf),'stats':{'digestCount':_0x5125f6,'isPresent':this['isPresent'],'hourlyActivity':_0x426068,'solarActive':_0x4b5ef0,'presenceWho':_0x136110},'automation':{'detected':_0x12172a,'description':_0x36f235,'targetId':_0x443ae0,'targetValue':_0x34a069}},_0x111f68['callback']);}else{if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x221)){const _0x353706=await this[_0x34e574(0x1fc)]('enum.functions.*',_0x34e574(0x270)),_0x2d9a21=[];if(_0x353706)for(const _0x2c98e8 in _0x353706){const _0x3922e2=_0x353706[_0x2c98e8],_0x503dbc=(_0x3922e2[_0x34e574(0x22c)]&&typeof _0x3922e2['common']['name']===_0x34e574(0x1a6)?_0x3922e2[_0x34e574(0x22c)][_0x34e574(0x27e)]['de']:_0x3922e2[_0x34e574(0x22c)]['name'])||_0x3922e2[_0x34e574(0x22c)][_0x34e574(0x27e)];_0x2d9a21[_0x34e574(0x1d7)]({'id':_0x2c98e8,'name':_0x503dbc});}const _0x5d701d=await this['getForeignObjectsAsync'](_0x34e574(0x1f8),_0x34e574(0x270)),_0x5bc959=[];if(_0x5d701d)for(const _0x55ed0f in _0x5d701d){const _0x5ca12a=_0x5d701d[_0x55ed0f],_0x2d9e8a=(_0x5ca12a[_0x34e574(0x22c)]&&typeof _0x5ca12a['common'][_0x34e574(0x27e)]===_0x34e574(0x1a6)?_0x5ca12a[_0x34e574(0x22c)]['name']['de']:_0x5ca12a['common']['name'])||_0x55ed0f['split']('.')['pop']();_0x5bc959[_0x34e574(0x1d7)](_0x2d9e8a);}this[_0x34e574(0x184)](_0x111f68['from'],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'enums':_0x2d9a21,'rooms':_0x5bc959},_0x111f68[_0x34e574(0x1c7)]);}else{if(_0x111f68['command']==='testContext')try{let _0x39828d='Kein\x20Wetter-Adapter',_0x4d9710=_0x34e574(0x1cf);if(this[_0x34e574(0x164)][_0x34e574(0x1a4)]){const _0x3e9422=await recorder[_0x34e574(0x231)](this);_0x39828d=_0x3e9422!==null?_0x3e9422+'Â°C':_0x34e574(0x175);}if(this[_0x34e574(0x164)]['calendarInstance']){const _0x3af7cf=await this['getForeignObjectAsync']('system.adapter.'+this[_0x34e574(0x164)][_0x34e574(0x190)]);_0x4d9710=_0x3af7cf?_0x34e574(0x146):_0x34e574(0x21f);}this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'weather':_0x39828d,'calendar':_0x4d9710},_0x111f68['callback']);}catch(_0x24b994){this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68['command'],{'success':![],'error':_0x24b994[_0x34e574(0x1dc)]},_0x111f68[_0x34e574(0x1c7)]);}else{if(_0x111f68[_0x34e574(0x1dd)]===_0x34e574(0x14c))try{const _0x53d2f8=_0x111f68[_0x34e574(0x1dc)][_0x34e574(0x202)],_0x204ada=await this['getForeignStateAsync'](_0x53d2f8+_0x34e574(0x181));let _0x1214cc=[];if(_0x204ada&&_0x204ada['val']){const _0x3f2c27=JSON['parse'](_0x204ada['val']),_0x178ed6=new Set();Array[_0x34e574(0x204)](_0x3f2c27)&&_0x3f2c27[_0x34e574(0x1e1)](_0x4bb78d=>{const _0x544752=_0x34e574;if(_0x4bb78d[_0x544752(0x1b3)])_0x178ed6['add'](_0x4bb78d[_0x544752(0x1b3)]);else{if(_0x4bb78d[_0x544752(0x1c9)])_0x178ed6[_0x544752(0x1fb)](_0x4bb78d['calendarName']);}}),_0x1214cc=Array[_0x34e574(0x280)](_0x178ed6)['sort']();}if(_0x1214cc[_0x34e574(0x1a9)]===0x0)_0x1214cc=[_0x34e574(0x19b)];this['sendTo'](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'names':_0x1214cc},_0x111f68[_0x34e574(0x1c7)]);}catch(_0x30dc63){this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':![],'error':_0x30dc63[_0x34e574(0x1dc)]},_0x111f68[_0x34e574(0x1c7)]);}else{if(_0x111f68[_0x34e574(0x1dd)]==='testNotification')try{await setup['sendNotification'](this,_0x34e574(0x1d5),![],![]),this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':!![],'message':_0x34e574(0x192)},_0x111f68[_0x34e574(0x1c7)]);}catch(_0x1a25c9){this[_0x34e574(0x1f2)][_0x34e574(0x218)](_0x34e574(0x182)+_0x1a25c9[_0x34e574(0x1dc)]),this[_0x34e574(0x184)](_0x111f68[_0x34e574(0x280)],_0x111f68[_0x34e574(0x1dd)],{'success':![],'message':_0x34e574(0x1d0)+_0x1a25c9[_0x34e574(0x1dc)]},_0x111f68[_0x34e574(0x1c7)]);}}}}}}}}}}}}}}}}}async[a0_0x570e77(0x267)](){const _0xd060a=a0_0x570e77;try{const _0x2c973a=await this[_0xd060a(0x211)](setup[_0xd060a(0x153)]);_0x2c973a&&_0x2c973a[_0xd060a(0x21d)]&&Object['values'](setup[_0xd060a(0x24d)])[_0xd060a(0x254)](_0x2c973a[_0xd060a(0x21d)])?this['currentSystemMode']=_0x2c973a['val']:(this[_0xd060a(0x27c)]=setup[_0xd060a(0x24d)][_0xd060a(0x1f9)],await this[_0xd060a(0x205)](setup[_0xd060a(0x153)],{'val':setup[_0xd060a(0x24d)]['NORMAL'],'ack':!![]}));}catch(_0xcb008f){this[_0xd060a(0x27c)]=setup['SYSTEM_MODES']['NORMAL'];}}async[a0_0x570e77(0x228)](){const _0x4b72b7=a0_0x570e77;try{const _0x3bdc41=this[_0x4b72b7(0x164)]['presenceDevices']||[];let _0x3d0027=![];const _0x28609b=[];for(const _0x146406 of _0x3bdc41){try{const _0x19174b=await this[_0x4b72b7(0x282)](_0x146406);_0x19174b&&(_0x19174b['val']===!![]||_0x19174b[_0x4b72b7(0x21d)]===_0x4b72b7(0x232)||_0x19174b[_0x4b72b7(0x21d)]===0x1)&&(_0x3d0027=!![],_0x28609b[_0x4b72b7(0x1d7)](_0x146406));}catch(_0x4f75ae){}}return await this['setStateAsync']('system.presenceWho',{'val':_0x28609b[_0x4b72b7(0x1cc)](',\x20'),'ack':!![]}),_0x3d0027&&(this[_0x4b72b7(0x213)]&&(this[_0x4b72b7(0x1f2)][_0x4b72b7(0x209)]('WiFi\x20Presence\x20detected.'),recorder[_0x4b72b7(0x287)](this)),!this['isPresent']&&this[_0x4b72b7(0x27c)]===setup[_0x4b72b7(0x24d)]['NORMAL']&&await recorder[_0x4b72b7(0x1b8)](this,!![])),_0x3d0027;}catch(_0x369b03){return![];}}async['runAutopilot'](){const _0x244b70=a0_0x570e77;this[_0x244b70(0x1f2)][_0x244b70(0x22d)](_0x244b70(0x1f4)),await aiAgent[_0x244b70(0x144)](this),this['updateHealthVector'](),this['triggerGaitAnalysis'](),this[_0x244b70(0x15f)]();}async[a0_0x570e77(0x214)](){const _0x618e09=a0_0x570e77,_0x4c567d=[_0x618e09(0x161),_0x618e09(0x1fd),_0x618e09(0x23e)],_0x452b9b=['forecast.current.weather','Current.WeatherText',_0x618e09(0x1aa)];for(const _0xd37576 of _0x4c567d){for(const _0x158931 of _0x452b9b){try{const _0x4c4732=_0xd37576+'.'+_0x158931,_0x4c5c52=await this[_0x618e09(0x282)](_0x4c4732);if(_0x4c5c52&&_0x4c5c52[_0x618e09(0x21d)]){const _0x50273b=String(_0x4c5c52[_0x618e09(0x21d)])[_0x618e09(0x19d)]();if(_0x50273b[_0x618e09(0x254)](_0x618e09(0x22e))||_0x50273b[_0x618e09(0x254)]('sunny')||_0x50273b[_0x618e09(0x254)](_0x618e09(0x165))||_0x50273b[_0x618e09(0x254)](_0x618e09(0x151))||_0x50273b[_0x618e09(0x254)](_0x618e09(0x21e)))return!![];}}catch(_0x4d2921){}}}return![];}[a0_0x570e77(0x18d)](){const _0x55fb11=a0_0x570e77;if(!this[_0x55fb11(0x148)])return;try{this[_0x55fb11(0x1e2)](_0x55fb11(0x278),(_0x4ec6a2,_0x621eb5)=>{const _0x37587e=_0x55fb11;_0x621eb5&&_0x621eb5[_0x37587e(0x21d)]&&pythonBridge[_0x37587e(0x13e)](this,_0x37587e(0x273),{'sequences':JSON[_0x37587e(0x233)](_0x621eb5['val'])});});}catch(_0x41fde1){}}async[a0_0x570e77(0x15f)](){const _0x5996c9=a0_0x570e77;if(!this[_0x5996c9(0x148)])return;try{const _0x333024=await recorder[_0x5996c9(0x231)](this);if(_0x333024===null)return;const _0x1024f7={},_0x56a7bc={},_0x44b507=this[_0x5996c9(0x164)]['devices']||[];for(const _0x28e091 of _0x44b507){if(_0x28e091[_0x5996c9(0x20a)]===_0x5996c9(0x272)&&_0x28e091[_0x5996c9(0x1f6)]){const _0x2bb337=this['sensorLastValues'][_0x28e091['id']];if(_0x2bb337!==undefined)_0x1024f7[_0x28e091[_0x5996c9(0x1f6)]]=_0x2bb337;if(_0x28e091[_0x5996c9(0x203)])_0x56a7bc[_0x28e091[_0x5996c9(0x1f6)]]=!![];}}const _0x347f45=await this['checkSolarCondition']();let _0x442d84={};try{const _0x5c32bd=await this[_0x5996c9(0x211)](_0x5996c9(0x275));if(_0x5c32bd&&_0x5c32bd[_0x5996c9(0x21d)])_0x442d84=JSON[_0x5996c9(0x233)](_0x5c32bd[_0x5996c9(0x21d)]);}catch(_0x298ea8){}Object[_0x5996c9(0x1b7)](_0x1024f7)[_0x5996c9(0x1a9)]>0x0&&(pythonBridge['send'](this,_0x5996c9(0x145),{'current_temps':_0x1024f7,'t_out':_0x333024,'is_sunny':_0x347f45,'solar_flags':_0x56a7bc,'warmup_targets':_0x442d84}),pythonBridge['send'](this,'OPTIMIZE_ENERGY',{'current_temps':_0x1024f7,'t_out':_0x333024,'targets':{}}));}catch(_0x223965){}}[a0_0x570e77(0x174)](){const _0x220d48=a0_0x570e77;if(!this[_0x220d48(0x225)]||this[_0x220d48(0x225)]['length']===0x0)return;const _0x108261=new Array(0x60)[_0x220d48(0x1b6)](0x0),_0x39feb4=new Date()[_0x220d48(0x1ef)](0x0,0x0,0x0,0x0);this[_0x220d48(0x225)]['forEach'](_0x459b81=>{const _0x54a662=_0x220d48,_0x4b7176=new Date(_0x459b81[_0x54a662(0x1ab)]);if(_0x4b7176[_0x54a662(0x157)]()>=_0x39feb4){const _0x219160=_0x4b7176[_0x54a662(0x160)](),_0x27047b=_0x4b7176[_0x54a662(0x283)](),_0x10e913=_0x219160*0x4+Math[_0x54a662(0x16e)](_0x27047b/0xf);if(_0x10e913>=0x0&&_0x10e913<0x60)_0x108261[_0x10e913]++;}});}[a0_0x570e77(0x24f)](){const _0x27a8b0=a0_0x570e77;if(!this['dailyDigests']||this[_0x27a8b0(0x17b)]['length']<0x2)return;const _0x4f8ae3=this[_0x27a8b0(0x17b)][_0x27a8b0(0x284)](_0x57788f=>{const _0x209228=_0x27a8b0,_0x2a78b0=(_0x57788f[_0x209228(0x13f)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x2a78b0]||0x32;});pythonBridge[_0x27a8b0(0x13e)](this,_0x27a8b0(0x194),{'values':_0x4f8ae3,'tag':'Activity-Level'});}async['handleInfrasound'](_0x3378b6){const _0x56a51f=a0_0x570e77;if(_0x3378b6==null||typeof _0x3378b6!=='number')return;const _0x43a6be=Date[_0x56a51f(0x1e9)]();this[_0x56a51f(0x176)]['push']({'ts':_0x43a6be,'val':_0x3378b6}),this[_0x56a51f(0x176)]=this[_0x56a51f(0x176)]['filter'](_0xf878dd=>_0x43a6be-_0xf878dd['ts']<0x1388);if(this[_0x56a51f(0x258)])return;if(this['config'][_0x56a51f(0x1a1)]){const _0x5bb0e0=await this[_0x56a51f(0x282)](this[_0x56a51f(0x164)][_0x56a51f(0x1a1)]);if(_0x5bb0e0&&!_0x5bb0e0[_0x56a51f(0x21d)])return;}const _0x2c6b15=this[_0x56a51f(0x164)][_0x56a51f(0x179)]||0.04;if(Math['abs'](_0x3378b6)>=_0x2c6b15){this[_0x56a51f(0x1f2)]['warn']('[Infrasound]\x20ðŸš¨\x20ALARM\x20TRIGGERED!\x20Pressure\x20Wave:\x20'+_0x3378b6+_0x56a51f(0x227)+_0x2c6b15+')'),await this[_0x56a51f(0x205)]('security.alarm_triggered',{'val':!![],'ack':!![]});const _0x51577c=this[_0x56a51f(0x25a)];_0x51577c?(this[_0x56a51f(0x1f2)][_0x56a51f(0x209)](_0x56a51f(0x1ba)),this['triggerInfrasoundCorrelation'](_0x3378b6,'INTERNAL')):(this['triggerInfrasoundCorrelation'](_0x3378b6,'ALARM'),this['sendNotification'](_0x56a51f(0x17f)+_0x3378b6+_0x56a51f(0x177))),this['infrasoundLocked']=!![],setTimeout(()=>{this['infrasoundLocked']=![];},0x2710);}}async['triggerInfrasoundCorrelation'](_0x412a28,_0x56c651=a0_0x570e77(0x159)){const _0x39cf0d=a0_0x570e77,_0xa4dc9d=Date[_0x39cf0d(0x1e9)](),_0x3fad24=this[_0x39cf0d(0x164)][_0x39cf0d(0x1ff)]||[];setTimeout(async()=>{const _0x58f5bf=_0x39cf0d;let _0x22f244=null,_0x2c9f7c=_0x58f5bf(0x172);const _0xaf5510=_0x3fad24[_0x58f5bf(0x1ae)](_0x267748=>_0x267748['type']&&(_0x267748[_0x58f5bf(0x20a)][_0x58f5bf(0x254)](_0x58f5bf(0x256))||_0x267748[_0x58f5bf(0x20a)]['includes'](_0x58f5bf(0x1b2))||_0x267748[_0x58f5bf(0x20a)]['includes'](_0x58f5bf(0x253))||_0x267748[_0x58f5bf(0x20a)][_0x58f5bf(0x254)](_0x58f5bf(0x198)))||_0x267748[_0x58f5bf(0x1ed)]&&(_0x267748[_0x58f5bf(0x1ed)][_0x58f5bf(0x254)]('sensor.window')||_0x267748[_0x58f5bf(0x1ed)][_0x58f5bf(0x254)](_0x58f5bf(0x1d3))));for(const _0x53f978 of _0xaf5510){try{const _0x430f2c=await this[_0x58f5bf(0x282)](_0x53f978['id']);if(_0x430f2c){if(_0x430f2c['ts']>=_0xa4dc9d-0x7d0){_0x22f244=_0x53f978[_0x58f5bf(0x27e)]||_0x53f978['id'],_0x2c9f7c=_0x58f5bf(0x220)+_0x22f244;break;}}}catch(_0x5f59d9){}}const _0x5e35c3={'timestamp':_0xa4dc9d,'pressure':_0x412a28,'isMatch':!!_0x22f244,'explanation':_0x2c9f7c,'type':_0x56c651};await this[_0x58f5bf(0x189)](_0x5e35c3),this[_0x58f5bf(0x1f2)][_0x58f5bf(0x209)](_0x58f5bf(0x229)+(!!_0x22f244?'MATCH\x20(False\x20Positive)':_0x58f5bf(0x1af)));},0x1388);}async['analyzeWindowOpening'](_0x10ffce){const _0x14e513=a0_0x570e77,_0x27afae=Date[_0x14e513(0x1e9)](),_0x3750ed=_0x10ffce['name']||_0x10ffce['id'][_0x14e513(0x1bd)]('.')['pop']();let _0x495f81=0x0;setTimeout(async()=>{const _0x2a5ab0=_0x14e513;this[_0x2a5ab0(0x176)][_0x2a5ab0(0x1e1)](_0x2a1172=>{const _0x1b1cb8=_0x2a5ab0;_0x2a1172['ts']>=_0x27afae-0xfa0&&_0x2a1172['ts']<=_0x27afae+0x3e8&&(Math[_0x1b1cb8(0x139)](_0x2a1172['val'])>Math[_0x1b1cb8(0x139)](_0x495f81)&&(_0x495f81=_0x2a1172[_0x1b1cb8(0x21d)]));});const _0x364d6c=this[_0x2a5ab0(0x164)]['infrasoundThreshold']||0.04,_0x278ca2=Math[_0x2a5ab0(0x139)](_0x495f81)>=_0x364d6c,_0x5df99e={'timestamp':_0x27afae,'pressure':_0x495f81,'isMatch':_0x278ca2,'explanation':_0x2a5ab0(0x187)+_0x3750ed,'type':_0x2a5ab0(0x1cb)};await this[_0x2a5ab0(0x189)](_0x5df99e),this[_0x2a5ab0(0x1f2)][_0x2a5ab0(0x22d)](_0x2a5ab0(0x20b)+_0x3750ed+_0x2a5ab0(0x186)+_0x495f81[_0x2a5ab0(0x247)](0x4)+_0x2a5ab0(0x1df)+_0x364d6c+')');},0x1f4);}async[a0_0x570e77(0x189)](_0x5694c8){const _0x36b261=a0_0x570e77;try{const _0x4f08a9=await this[_0x36b261(0x211)]('analysis.security.infrasoundLog');let _0x175e5c=[];if(_0x4f08a9&&_0x4f08a9[_0x36b261(0x21d)])_0x175e5c=JSON[_0x36b261(0x233)](_0x4f08a9[_0x36b261(0x21d)]);_0x175e5c[_0x36b261(0x285)](_0x5694c8);if(_0x175e5c['length']>0x14)_0x175e5c=_0x175e5c[_0x36b261(0x252)](0x0,0x14);await this[_0x36b261(0x205)]('analysis.security.infrasoundLog',{'val':JSON[_0x36b261(0x289)](_0x175e5c),'ack':!![]});}catch(_0x3b2db1){this[_0x36b261(0x1f2)][_0x36b261(0x218)](_0x36b261(0x22f)+_0x3b2db1['message']);}}[a0_0x570e77(0x26f)](_0x446616){const _0x5bcb93=a0_0x570e77;this[_0x5bcb93(0x164)]['notifyPushoverEnabled']&&this[_0x5bcb93(0x164)][_0x5bcb93(0x261)]&&this[_0x5bcb93(0x184)](this['config']['notifyPushoverInstance'],_0x5bcb93(0x13e),{'message':_0x446616,'title':_0x5bcb93(0x21b),'priority':0x1}),this[_0x5bcb93(0x164)][_0x5bcb93(0x14a)]&&this[_0x5bcb93(0x164)][_0x5bcb93(0x158)]&&this[_0x5bcb93(0x184)](this[_0x5bcb93(0x164)][_0x5bcb93(0x158)],_0x5bcb93(0x13e),{'text':_0x446616});}}if(require['main']!==module)module[a0_0x570e77(0x257)]=_0x4c85f6=>new CogniLiving(_0x4c85f6);else new CogniLiving();