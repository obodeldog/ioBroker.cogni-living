const a0_0x336bd2=a0_0x414c;(function(_0x3a57b8,_0xe4e710){const _0x51eaea=a0_0x414c,_0x2ee3c5=_0x3a57b8();while(!![]){try{const _0x15096c=-parseInt(_0x51eaea(0x1f5))/0x1*(-parseInt(_0x51eaea(0x30c))/0x2)+parseInt(_0x51eaea(0x1a0))/0x3*(-parseInt(_0x51eaea(0x1d1))/0x4)+-parseInt(_0x51eaea(0x192))/0x5+parseInt(_0x51eaea(0x30f))/0x6*(-parseInt(_0x51eaea(0x24a))/0x7)+parseInt(_0x51eaea(0x2bd))/0x8*(parseInt(_0x51eaea(0x19f))/0x9)+parseInt(_0x51eaea(0x2f9))/0xa*(parseInt(_0x51eaea(0x22e))/0xb)+parseInt(_0x51eaea(0x204))/0xc;if(_0x15096c===_0xe4e710)break;else _0x2ee3c5['push'](_0x2ee3c5['shift']());}catch(_0x47a9f6){_0x2ee3c5['push'](_0x2ee3c5['shift']());}}}(a0_0x5013,0x6e4da));const a0_0x2ac6ed=(function(){let _0x556792=!![];return function(_0x903d71,_0x575094){const _0x1f0d67=_0x556792?function(){if(_0x575094){const _0x12a3ce=_0x575094['apply'](_0x903d71,arguments);return _0x575094=null,_0x12a3ce;}}:function(){};return _0x556792=![],_0x1f0d67;};}()),a0_0x42bc91=a0_0x2ac6ed(this,function(){const _0x12e0c1=a0_0x414c;return a0_0x42bc91['toString']()[_0x12e0c1(0x22a)]('(((.+)+)+)+$')[_0x12e0c1(0x1b5)]()[_0x12e0c1(0x268)](a0_0x42bc91)[_0x12e0c1(0x22a)](_0x12e0c1(0x198));});a0_0x42bc91();'use strict';const utils=require(a0_0x336bd2(0x1c7)),{GoogleGenerativeAI}=require(a0_0x336bd2(0x296)),schedule=require(a0_0x336bd2(0x2ae)),{spawn,exec}=require(a0_0x336bd2(0x1d9)),path=require(a0_0x336bd2(0x2f5)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x336bd2(0x17a),LTM_SCHEDULE=a0_0x336bd2(0x294),MODE_RESET_SCHEDULE=a0_0x336bd2(0x1d4),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x336bd2(0x22c),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x336bd2(0x1cf),LTM_DP_TRIGGER_DIGEST=a0_0x336bd2(0x1eb),LTM_DP_BASELINE_STATUS=a0_0x336bd2(0x2b6),LTM_DP_DRIFT_CHANNEL=a0_0x336bd2(0x226),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x336bd2(0x19a),LTM_DP_DRIFT_LAST_CHECK=a0_0x336bd2(0x2a6),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x336bd2(0x264),'VACATION':'vacation','PARTY':a0_0x336bd2(0x194),'GUEST':a0_0x336bd2(0x1d6)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x336bd2(0x257)],SYSTEM_MODES[a0_0x336bd2(0x1b7)]],PERSONA_MAPPING={'generic':a0_0x336bd2(0x2b5),'senior_aal':a0_0x336bd2(0x313),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x336bd2(0x207),'security':a0_0x336bd2(0x280)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x336bd2(0x1c6)]===a0_0x336bd2(0x1a1),PERSISTENT_DIR=path['join'](__dirname,a0_0x336bd2(0x19d)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x336bd2(0x262),'python.exe'):path['join'](VENV_PATH,'bin',a0_0x336bd2(0x2d8)),PIP_EXE=IS_WIN?path[a0_0x336bd2(0x1e6)](VENV_PATH,a0_0x336bd2(0x262),a0_0x336bd2(0x1ee)):path[a0_0x336bd2(0x1e6)](VENV_PATH,a0_0x336bd2(0x2b7),a0_0x336bd2(0x2ad));let activeSequence=[],sequenceTimer=null;async function startSystem(_0x5f1d41){const _0x304fbc=a0_0x336bd2;_0x5f1d41['log'][_0x304fbc(0x2eb)](_0x304fbc(0x30a)),await initZombies(_0x5f1d41);try{_0x5f1d41['isProVersion']=await checkLicense(_0x5f1d41[_0x304fbc(0x15f)][_0x304fbc(0x2ce)]);}catch(_0x4bd0f3){}if(!_0x5f1d41[_0x304fbc(0x15f)][_0x304fbc(0x1f9)]||_0x5f1d41[_0x304fbc(0x15f)]['inactivityThresholdHours']<0.1)_0x5f1d41[_0x304fbc(0x15f)]['inactivityThresholdHours']=0xc;await initHistory(_0x5f1d41),await initSystemConfig(_0x5f1d41);if(_0x5f1d41['config'][_0x304fbc(0x18d)])try{_0x5f1d41[_0x304fbc(0x291)]=new GoogleGenerativeAI(_0x5f1d41[_0x304fbc(0x15f)]['geminiApiKey']),_0x5f1d41[_0x304fbc(0x2a9)]=_0x5f1d41['genAI'][_0x304fbc(0x1e0)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x304fbc(0x278)}}),_0x5f1d41[_0x304fbc(0x2ec)][_0x304fbc(0x2eb)]('Gemini\x20AI\x20initialized.');}catch(_0x13d4c5){_0x5f1d41['log'][_0x304fbc(0x21c)]('Gemini\x20Init\x20Error:\x20'+_0x13d4c5[_0x304fbc(0x2b8)]);}await createAllObjects(_0x5f1d41),await loadSystemMode(_0x5f1d41),await loadRawEventLog(_0x5f1d41),await loadDailyDigests(_0x5f1d41),_0x5f1d41[_0x304fbc(0x1b8)](_0x304fbc(0x23b)),_0x5f1d41[_0x304fbc(0x1b8)](LTM_DP_TRIGGER_DIGEST),_0x5f1d41[_0x304fbc(0x1b8)]('system.mode'),_0x5f1d41['subscribeStates'](_0x304fbc(0x2f8)),_0x5f1d41[_0x304fbc(0x1b8)](_0x304fbc(0x292)),_0x5f1d41['subscribeStates'](_0x304fbc(0x27d)),_0x5f1d41[_0x304fbc(0x1b8)](_0x304fbc(0x2e3)),_0x5f1d41[_0x304fbc(0x1b8)]('analysis.training.triggerHealth'),_0x5f1d41[_0x304fbc(0x1b8)](_0x304fbc(0x19b)),_0x5f1d41[_0x304fbc(0x1b8)]('analysis.training.triggerComfort'),await initSensorSubscriptions(_0x5f1d41),await initPresenceSubscriptions(_0x5f1d41),await setupTelegramListener(_0x5f1d41),setTimeout(()=>checkWifiPresence(_0x5f1d41),0x1388);if(_0x5f1d41['analysisTimer'])clearInterval(_0x5f1d41[_0x304fbc(0x2f1)]);const _0x41b89a=_0x5f1d41['config'][_0x304fbc(0x2c2)]||0xf;_0x41b89a>0x0&&(_0x5f1d41['analysisTimer']=setInterval(()=>{runAutopilot(_0x5f1d41);},_0x41b89a*0x3c*0x3e8)),setupLtmScheduler(_0x5f1d41),setupModeResetScheduler(_0x5f1d41),setupDriftAnalysisScheduler(_0x5f1d41),setupBriefingScheduler(_0x5f1d41),startPythonService(_0x5f1d41),setTimeout(()=>{if(_0x5f1d41['pythonProcess'])runPythonHealthCheck(_0x5f1d41);},0x1388);}async function runAutopilot(_0x50cfb8){_0x50cfb8['log']['debug']('ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...'),await runGeminiAnalysis(_0x50cfb8);}async function scanForDevices(_0x3c68ac,_0x201040){const _0x51e859=a0_0x336bd2;_0x3c68ac['log'][_0x51e859(0x2eb)](_0x51e859(0x2dd));const _0x38b2bb=[],_0x3c8941=await _0x3c68ac[_0x51e859(0x2fc)]('*');for(const _0x23e755 in _0x3c8941){const _0x27167f=_0x3c8941[_0x23e755];if(_0x27167f&&_0x27167f[_0x51e859(0x17e)]&&_0x27167f[_0x51e859(0x1f8)]==='state'){const _0x49fbc0=(_0x27167f[_0x51e859(0x17e)][_0x51e859(0x191)]&&typeof _0x27167f[_0x51e859(0x17e)]['name']==='object'?_0x27167f[_0x51e859(0x17e)][_0x51e859(0x191)]['de']:_0x27167f[_0x51e859(0x17e)][_0x51e859(0x191)])||'',_0x2447d5=_0x27167f[_0x51e859(0x17e)][_0x51e859(0x210)]||'';let _0x4aaab5=null;if(_0x201040[_0x51e859(0x2fe)]&&(_0x2447d5[_0x51e859(0x1df)](_0x51e859(0x2fe))||_0x49fbc0[_0x51e859(0x16a)]()[_0x51e859(0x1df)]('bewegung')))_0x4aaab5=_0x51e859(0x2fe);else{if(_0x201040[_0x51e859(0x1ef)]&&(_0x2447d5[_0x51e859(0x1df)](_0x51e859(0x1b2))||_0x2447d5['includes'](_0x51e859(0x1ff))||_0x49fbc0[_0x51e859(0x16a)]()[_0x51e859(0x1df)](_0x51e859(0x2ea))||_0x49fbc0[_0x51e859(0x16a)]()[_0x51e859(0x1df)](_0x51e859(0x1bf))))_0x4aaab5=_0x51e859(0x1b2);else{if(_0x201040[_0x51e859(0x2c6)]&&(_0x2447d5[_0x51e859(0x1df)]('light')||_0x2447d5[_0x51e859(0x1df)](_0x51e859(0x28d))||_0x49fbc0[_0x51e859(0x16a)]()['includes'](_0x51e859(0x306))))_0x4aaab5='light';else{if(_0x201040[_0x51e859(0x1c9)]&&(_0x2447d5['includes'](_0x51e859(0x1c9))||_0x49fbc0[_0x51e859(0x16a)]()[_0x51e859(0x1df)](_0x51e859(0x1d3))))_0x4aaab5=_0x51e859(0x1c9);}}}if(_0x4aaab5){let _0x5569e4='';const _0x4b4a3b=_0x23e755[_0x51e859(0x261)]('.');if(_0x4b4a3b['length']>0x2)_0x5569e4=_0x4b4a3b[0x2];_0x38b2bb['push']({'id':_0x23e755,'name':_0x49fbc0||_0x23e755,'type':_0x4aaab5,'location':_0x5569e4,'_score':0x32});}}}return _0x38b2bb;}async function getWeatherContext(_0x317933){const _0x282349=a0_0x336bd2;if(!_0x317933[_0x282349(0x15f)][_0x282349(0x266)]||!_0x317933[_0x282349(0x15f)][_0x282349(0x1ab)])return _0x282349(0x26f);try{const _0x55fc23=_0x317933[_0x282349(0x15f)][_0x282349(0x1ab)];let _0x1190aa=await _0x317933['getForeignStateAsync'](_0x55fc23+_0x282349(0x26d));if(!_0x1190aa)_0x1190aa=await _0x317933[_0x282349(0x29a)](_0x55fc23+_0x282349(0x17b));let _0x5bfe05=await _0x317933[_0x282349(0x29a)](_0x55fc23+_0x282349(0x2fb));if(!_0x5bfe05)_0x5bfe05=await _0x317933[_0x282349(0x29a)](_0x55fc23+'.forecast.current.state');if(_0x1190aa&&_0x5bfe05)return _0x1190aa['val']+_0x282349(0x1ba)+_0x5bfe05[_0x282349(0x307)];}catch(_0x643b4f){}return _0x282349(0x23a);}async function getCalendarContext(_0x383d76){const _0x485600=a0_0x336bd2;if(!_0x383d76[_0x485600(0x15f)][_0x485600(0x2a4)]||!_0x383d76[_0x485600(0x15f)]['calendarInstance'])return _0x485600(0x169);return'Keine\x20Termine.';}async function getCalendarNames(_0x3b29a6,_0x370f5d){return[];}async function saveFeedback(_0x439502,_0x6c7e92){const _0x42defa=a0_0x336bd2;_0x439502[_0x42defa(0x2ec)]['info'](_0x42defa(0x223)+_0x6c7e92['rating']);}async function sendMorningBriefing(_0x321a2a){const _0x53df5f=a0_0x336bd2;if(!_0x321a2a[_0x53df5f(0x2a9)])return;try{const _0x47dedb=_0x53df5f(0x1d0),_0x56455a=await _0x321a2a[_0x53df5f(0x2a9)][_0x53df5f(0x172)](_0x47dedb),_0x2e0046=_0x56455a['response']['text']();sendNotification(_0x321a2a,'üåÖ\x20Morning\x20Briefing:\x0a'+_0x2e0046);}catch(_0x4e8642){_0x321a2a['log']['error']('Briefing\x20Error:\x20'+_0x4e8642[_0x53df5f(0x2b8)]);}}function checkAndInstall(_0x3eb83b){const _0x4be5f5=a0_0x336bd2;if(!fs[_0x4be5f5(0x311)](VENV_PATH)||!fs[_0x4be5f5(0x311)](PIP_EXE))return _0x3eb83b[_0x4be5f5(0x2ec)][_0x4be5f5(0x168)]('‚ö†Ô∏è\x20Python\x20VENV\x20missing.\x20Installing\x20locally...'),installPythonDependencies(_0x3eb83b),![];return!![];}function installPythonDependencies(_0x242b4b){const _0x3603c0=a0_0x336bd2;if(_0x242b4b[_0x3603c0(0x28a)])return;_0x242b4b[_0x3603c0(0x28a)]=!![];const _0x14728a=path[_0x3603c0(0x1e6)](__dirname,'python_service',_0x3603c0(0x1db));stopPythonService(_0x242b4b);if(fs[_0x3603c0(0x311)](VENV_PATH))try{fs[_0x3603c0(0x239)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x4a9c74){}exec(_0x3603c0(0x1d5)+VENV_PATH+'\x22',_0x4ad2bc=>{const _0x20861d=_0x3603c0;if(_0x4ad2bc){_0x242b4b[_0x20861d(0x2ec)][_0x20861d(0x21c)](_0x20861d(0x1fc)+_0x4ad2bc[_0x20861d(0x2b8)]),_0x242b4b[_0x20861d(0x28a)]=![];return;}installRequirementsInVenv(_0x242b4b,_0x14728a);});}function installRequirementsInVenv(_0x56a5d8,_0x5a6d27){const _0x70787=a0_0x336bd2;_0x56a5d8[_0x70787(0x2ec)][_0x70787(0x2eb)](_0x70787(0x28f));const _0x101ce4='\x22'+PIP_EXE+'\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22'+_0x5a6d27+'\x22';exec(_0x101ce4,{'timeout':0x124f80},(_0x15f675,_0x843ec,_0x91c883)=>{const _0x1e985b=_0x70787;_0x56a5d8[_0x1e985b(0x28a)]=![],_0x15f675?_0x56a5d8['log']['error'](_0x1e985b(0x2c0)+(_0x91c883||_0x15f675['message'])):(_0x56a5d8[_0x1e985b(0x2ec)][_0x1e985b(0x2eb)](_0x1e985b(0x23d)),startSystem(_0x56a5d8));});}async function initZombies(_0x4cb2ac){const _0x2ee275=a0_0x336bd2;try{const _0x189867=[_0x2ee275(0x259),_0x2ee275(0x2c5)];for(const _0x3c44c6 of _0x189867){try{const _0x1f909c=await _0x4cb2ac[_0x2ee275(0x252)](_0x3c44c6);if(_0x1f909c)await _0x4cb2ac[_0x2ee275(0x1b4)](_0x3c44c6);}catch(_0x8118b9){}}}catch(_0x57af9c){}}async function checkLicense(_0x3a1673){return!![];}async function initHistory(_0x4c1205){const _0x3aecbe=a0_0x336bd2;try{const _0x53709b=await _0x4c1205[_0x3aecbe(0x23c)](_0x3aecbe(0x277));_0x53709b&&_0x53709b[_0x3aecbe(0x307)]&&(_0x4c1205['eventHistory']=JSON[_0x3aecbe(0x18b)](_0x53709b[_0x3aecbe(0x307)]['toString']()));}catch(_0x2109dc){_0x4c1205['eventHistory']=[];}try{const _0x4ed4ad=await _0x4c1205[_0x3aecbe(0x23c)](_0x3aecbe(0x283));if(_0x4ed4ad&&_0x4ed4ad['val'])_0x4c1205[_0x3aecbe(0x1de)]=JSON[_0x3aecbe(0x18b)](_0x4ed4ad[_0x3aecbe(0x307)][_0x3aecbe(0x1b5)]());}catch(_0x5da863){_0x4c1205[_0x3aecbe(0x1de)]=[];}if(_0x4c1205['eventHistory']&&_0x4c1205[_0x3aecbe(0x18a)][_0x3aecbe(0x1c3)]>0x0){_0x4c1205[_0x3aecbe(0x2ec)][_0x3aecbe(0x2eb)]('Restoring\x20sensor\x20cache...');for(let _0x15daf1=_0x4c1205[_0x3aecbe(0x18a)]['length']-0x1;_0x15daf1>=0x0;_0x15daf1--){const _0x2e81c6=_0x4c1205['eventHistory'][_0x15daf1];if(_0x2e81c6&&_0x2e81c6['id']!==undefined&&_0x2e81c6[_0x3aecbe(0x305)]!==undefined)_0x4c1205['sensorLastValues'][_0x2e81c6['id']]=_0x2e81c6[_0x3aecbe(0x305)];}}}async function initSystemConfig(_0x3fba87){const _0x370564=a0_0x336bd2;try{const _0x215425=await _0x3fba87['getForeignObjectAsync'](_0x370564(0x2ef));if(_0x215425&&_0x215425[_0x370564(0x17e)])_0x3fba87[_0x370564(0x1fd)]={'latitude':_0x215425[_0x370564(0x17e)][_0x370564(0x2c3)]||0x0,'longitude':_0x215425[_0x370564(0x17e)][_0x370564(0x2f0)]||0x0,'city':_0x215425[_0x370564(0x17e)][_0x370564(0x23e)]||''};}catch(_0x239c52){}}async function createAllObjects(_0x4c39ac){const _0x3c209c=a0_0x336bd2;await _0x4c39ac['extendObjectAsync'](_0x3c209c(0x275),{'type':_0x3c209c(0x2ee),'common':{'name':_0x3c209c(0x1b0)},'native':{}}),await _0x4c39ac[_0x3c209c(0x29c)](SYSTEM_DP_MODE,{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x212),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x16c),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL']},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)]('system.presenceWho',{'type':'state','common':{'name':_0x3c209c(0x303),'type':'string','role':_0x3c209c(0x2b4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x27e),{'type':'state','common':{'name':'Last\x20raw\x20event','type':'string','role':_0x3c209c(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x277),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x215),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x4c39ac['extendObjectAsync'](_0x3c209c(0x237),{'type':_0x3c209c(0x2ee),'common':{'name':_0x3c209c(0x241)},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)]('analysis.training.triggerSecurity',{'type':_0x3c209c(0x16c),'common':{'name':'Train\x20Security','type':_0x3c209c(0x2a7),'role':_0x3c209c(0x238),'read':!![],'write':!![]},'native':{}}),await _0x4c39ac['setObjectNotExistsAsync'](_0x3c209c(0x224),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x1bd),'type':_0x3c209c(0x2a7),'role':_0x3c209c(0x238),'read':!![],'write':!![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)]('analysis.training.triggerEnergy',{'type':'state','common':{'name':'Train\x20Energy','type':_0x3c209c(0x2a7),'role':_0x3c209c(0x238),'read':!![],'write':!![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x243),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x218),'type':_0x3c209c(0x2a7),'role':_0x3c209c(0x238),'read':!![],'write':!![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x1c2),{'type':'state','common':{'name':_0x3c209c(0x1a8),'type':'string','role':_0x3c209c(0x2b4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x29c)](_0x3c209c(0x2e2),{'type':_0x3c209c(0x2ee),'common':{'name':_0x3c209c(0x229)},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x2cd),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x1ea),'type':_0x3c209c(0x213),'role':'value','read':!![],'write':![]},'native':{}}),await _0x4c39ac['setObjectNotExistsAsync'](_0x3c209c(0x17d),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x2ac),'type':_0x3c209c(0x213),'role':_0x3c209c(0x305),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x2ba),{'type':'state','common':{'name':_0x3c209c(0x1dc),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x29c)](_0x3c209c(0x209),{'type':'channel','common':{'name':_0x3c209c(0x2f7)},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x1cd),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x1dc),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x1f4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x222),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x250),'type':'boolean','role':_0x3c209c(0x270),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x20c),{'type':_0x3c209c(0x16c),'common':{'name':'Trend','type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x20b),{'type':'state','common':{'name':'Trend\x20Value','type':_0x3c209c(0x213),'role':_0x3c209c(0x305),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x29c)](_0x3c209c(0x236),{'type':_0x3c209c(0x2ee),'common':{'name':_0x3c209c(0x284)},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)]('analysis.energy.insulationScore',{'type':'state','common':{'name':'Insulation\x20Score','type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x1b6),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x182),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x29c)](_0x3c209c(0x161),{'type':'channel','common':{'name':_0x3c209c(0x161)},'native':{}}),await _0x4c39ac[_0x3c209c(0x29c)](LTM_DP_RAW_LOG,{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x230),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x29c)](LTM_DP_DAILY_DIGESTS,{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x17c),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x2e7),{'type':'state','common':{'name':'Sequences','type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)]('LTM.trainingData.thermodynamics',{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x201),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x23b),{'type':_0x3c209c(0x16c),'common':{'name':'Trigger\x20Analysis','type':'boolean','role':_0x3c209c(0x238),'read':!![],'write':!![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x2f8),{'type':_0x3c209c(0x16c),'common':{'name':'Trigger\x20Briefing','type':_0x3c209c(0x2a7),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x16d),{'type':_0x3c209c(0x16c),'common':{'name':'Alert\x20Status','type':'boolean','role':_0x3c209c(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x2dc),{'type':_0x3c209c(0x16c),'common':{'name':'Alert\x20Reason','type':_0x3c209c(0x2d7),'role':_0x3c209c(0x18c),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)]('analysis.activitySummary',{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x1e9),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)]('analysis.automation.patternDetected',{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x30d),'type':_0x3c209c(0x2a7),'role':_0x3c209c(0x270),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x2e8),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x298),'type':_0x3c209c(0x2d7),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)]('analysis.automation.detectedPatterns',{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x216),'type':'string','role':_0x3c209c(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x4c39ac['setObjectNotExistsAsync'](_0x3c209c(0x289),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x186),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x21e),{'type':'state','common':{'name':_0x3c209c(0x2de),'type':_0x3c209c(0x2d7),'role':_0x3c209c(0x2b4),'read':!![],'write':![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x27d),{'type':_0x3c209c(0x16c),'common':{'name':_0x3c209c(0x164),'type':_0x3c209c(0x2a7),'role':_0x3c209c(0x28d),'read':!![],'write':!![]},'native':{}}),await _0x4c39ac[_0x3c209c(0x2bb)](_0x3c209c(0x292),{'type':_0x3c209c(0x16c),'common':{'name':'Trigger\x20Action','type':_0x3c209c(0x2a7),'role':_0x3c209c(0x238),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x29cb41){const _0x50c105=a0_0x336bd2;try{const _0x20de49=await _0x29cb41[_0x50c105(0x23c)](SYSTEM_DP_MODE);_0x20de49&&_0x20de49[_0x50c105(0x307)]&&Object['values'](SYSTEM_MODES)[_0x50c105(0x1df)](_0x20de49[_0x50c105(0x307)])?_0x29cb41[_0x50c105(0x22d)]=_0x20de49[_0x50c105(0x307)]:(_0x29cb41[_0x50c105(0x22d)]=SYSTEM_MODES[_0x50c105(0x1c0)],await _0x29cb41[_0x50c105(0x25b)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0xa9c3ae){_0x29cb41[_0x50c105(0x22d)]=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x59b013){const _0x1ce798=a0_0x336bd2;try{const _0x1f8052=await _0x59b013[_0x1ce798(0x23c)](LTM_DP_RAW_LOG);if(_0x1f8052&&_0x1f8052[_0x1ce798(0x307)])_0x59b013['rawEventLog']=JSON['parse'](_0x1f8052[_0x1ce798(0x307)]);}catch(_0xa84d5a){_0x59b013[_0x1ce798(0x21b)]=[];}}async function saveRawEventLog(_0x201cb7){const _0x2f3924=a0_0x336bd2;if(_0x201cb7[_0x2f3924(0x21b)][_0x2f3924(0x1c3)]>RAW_LOG_MAX_SIZE)_0x201cb7[_0x2f3924(0x21b)]['splice'](0x0,_0x201cb7[_0x2f3924(0x21b)][_0x2f3924(0x1c3)]-RAW_LOG_MAX_SIZE);await _0x201cb7[_0x2f3924(0x25b)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x201cb7['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x2ac05c){const _0x284d90=a0_0x336bd2;try{const _0x2b6d12=await _0x2ac05c[_0x284d90(0x23c)](LTM_DP_DAILY_DIGESTS);if(_0x2b6d12&&_0x2b6d12[_0x284d90(0x307)])_0x2ac05c[_0x284d90(0x24b)]=JSON['parse'](_0x2b6d12[_0x284d90(0x307)]);}catch(_0x33bc1d){_0x2ac05c[_0x284d90(0x24b)]=[];}await updateBaselineStatus(_0x2ac05c);}async function saveDailyDigests(_0x2a4190,_0x26da2e=!![]){const _0x736d93=a0_0x336bd2,_0x4260cc=_0x2a4190[_0x736d93(0x15f)][_0x736d93(0x195)]||0x3c;_0x2a4190[_0x736d93(0x24b)]['length']>_0x4260cc&&_0x2a4190['dailyDigests'][_0x736d93(0x1d2)](0x0,_0x2a4190[_0x736d93(0x24b)][_0x736d93(0x1c3)]-_0x4260cc);await _0x2a4190[_0x736d93(0x25b)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x736d93(0x1bb)](_0x2a4190[_0x736d93(0x24b)]),'ack':!![]});if(_0x26da2e)await updateBaselineStatus(_0x2a4190);}async function updateAnalysisHistory(_0xfb661a,_0x4fae5e){const _0x58ed70=a0_0x336bd2;_0xfb661a['analysisHistory'][_0x58ed70(0x302)](_0x4fae5e);if(_0xfb661a[_0x58ed70(0x1de)][_0x58ed70(0x1c3)]>HISTORY_MAX_SIZE)_0xfb661a[_0x58ed70(0x1de)][_0x58ed70(0x2bc)]();await _0xfb661a['setStateAsync'](_0x58ed70(0x283),{'val':JSON[_0x58ed70(0x1bb)](_0xfb661a[_0x58ed70(0x1de)]),'ack':!![]});}async function updateBaselineStatus(_0xe91abf){const _0x1e4d54=a0_0x336bd2;if(!_0xe91abf[_0x1e4d54(0x2e9)]){await _0xe91abf[_0x1e4d54(0x25b)](LTM_DP_BASELINE_STATUS,{'val':_0x1e4d54(0x304),'ack':!![]});return;}const _0x51b476=_0xe91abf[_0x1e4d54(0x24b)][_0x1e4d54(0x1c3)]>=(_0xe91abf[_0x1e4d54(0x15f)][_0x1e4d54(0x205)]||0x7)?_0x1e4d54(0x21f)+_0xe91abf[_0x1e4d54(0x24b)]['length']+_0x1e4d54(0x1e4):'Lernphase\x20('+_0xe91abf['dailyDigests'][_0x1e4d54(0x1c3)]+'/'+(_0xe91abf[_0x1e4d54(0x15f)][_0x1e4d54(0x205)]||0x7)+')';await _0xe91abf[_0x1e4d54(0x25b)](LTM_DP_BASELINE_STATUS,{'val':_0x51b476,'ack':!![]});}async function initSensorSubscriptions(_0x3278d4){const _0x23e6b6=a0_0x336bd2,_0x49e348=_0x3278d4[_0x23e6b6(0x15f)][_0x23e6b6(0x244)];if(_0x49e348)for(const _0x118e48 of _0x49e348){await _0x3278d4[_0x23e6b6(0x2fa)](_0x118e48['id']);}}async function initPresenceSubscriptions(_0x22454a){const _0x86d85a=a0_0x336bd2,_0x13e819=_0x22454a[_0x86d85a(0x15f)][_0x86d85a(0x190)];if(_0x13e819)for(const _0x55c42b of _0x13e819){await _0x22454a['subscribeForeignStatesAsync'](_0x55c42b);}}async function setupTelegramListener(_0x3f9551){const _0x382bef=a0_0x336bd2,_0x47e0e4=_0x3f9551[_0x382bef(0x15f)]['notifyTelegramInstance'];if(_0x3f9551[_0x382bef(0x15f)][_0x382bef(0x167)]&&_0x47e0e4)await _0x3f9551[_0x382bef(0x2fa)](_0x47e0e4+_0x382bef(0x174));}async function checkWifiPresence(_0x20ce98){const _0x1b46f5=a0_0x336bd2;try{const _0x204399=_0x20ce98[_0x1b46f5(0x15f)][_0x1b46f5(0x190)]||[];let _0x9166de=![];const _0x296b4e=[];for(const _0x140b0d of _0x204399){try{const _0x38823d=await _0x20ce98[_0x1b46f5(0x29a)](_0x140b0d);_0x38823d&&(_0x38823d[_0x1b46f5(0x307)]===!![]||_0x38823d[_0x1b46f5(0x307)]===_0x1b46f5(0x1ac)||_0x38823d[_0x1b46f5(0x307)]===0x1)&&(_0x9166de=!![],_0x296b4e[_0x1b46f5(0x1c8)](_0x140b0d));}catch(_0x171e8f){}}return await _0x20ce98[_0x1b46f5(0x25b)]('system.presenceWho',{'val':_0x296b4e['join'](',\x20'),'ack':!![]}),_0x9166de&&(_0x20ce98[_0x1b46f5(0x2a8)]&&(_0x20ce98[_0x1b46f5(0x2ec)][_0x1b46f5(0x2eb)](_0x1b46f5(0x217)),abortExitTimer(_0x20ce98)),!_0x20ce98[_0x1b46f5(0x22f)]&&_0x20ce98['currentSystemMode']===SYSTEM_MODES[_0x1b46f5(0x1c0)]&&await setPresence(_0x20ce98,!![])),_0x9166de;}catch(_0x6d0d18){return![];}}function startExitTimer(_0x544d8c){const _0x40c1b6=a0_0x336bd2;abortExitTimer(_0x544d8c),_0x544d8c[_0x40c1b6(0x285)]=!![],_0x544d8c['exitGraceTimer']=setTimeout(()=>{const _0x29c2ff=_0x40c1b6;_0x544d8c[_0x29c2ff(0x285)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x544d8c['exitTimer']=setTimeout(()=>{setPresence(_0x544d8c,![]),_0x544d8c['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x94c91a){const _0x1c0191=a0_0x336bd2;if(_0x94c91a[_0x1c0191(0x2a8)])clearTimeout(_0x94c91a[_0x1c0191(0x2a8)]);if(_0x94c91a[_0x1c0191(0x1f0)])clearTimeout(_0x94c91a[_0x1c0191(0x1f0)]);_0x94c91a['exitTimer']=null,_0x94c91a[_0x1c0191(0x1f0)]=null,_0x94c91a[_0x1c0191(0x285)]=![];}async function setPresence(_0x4b24be,_0x90b68d){const _0x14a62=a0_0x336bd2;if(_0x4b24be[_0x14a62(0x22f)]===_0x90b68d)return;_0x4b24be[_0x14a62(0x22f)]=_0x90b68d,await _0x4b24be[_0x14a62(0x25b)](_0x14a62(0x2a3),{'val':_0x90b68d,'ack':!![]});}async function executeAutomationAction(_0x23eaf0){const _0x4ec872=a0_0x336bd2;try{const _0x348cf5=await _0x23eaf0[_0x4ec872(0x23c)](_0x4ec872(0x289)),_0x9fc1cb=await _0x23eaf0[_0x4ec872(0x23c)](_0x4ec872(0x21e));if(_0x348cf5&&_0x348cf5[_0x4ec872(0x307)]&&_0x9fc1cb){const _0xe352b5=_0x348cf5[_0x4ec872(0x307)];let _0x433514=_0x9fc1cb[_0x4ec872(0x307)];try{_0x433514=JSON['parse'](_0x433514);}catch(_0x4eef10){}_0x23eaf0['log']['info']('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0xe352b5+_0x4ec872(0x1b9)+_0x433514),await _0x23eaf0[_0x4ec872(0x1e8)](_0xe352b5,_0x433514);}else _0x23eaf0[_0x4ec872(0x2ec)]['warn']('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x20ac7a){_0x23eaf0[_0x4ec872(0x2ec)][_0x4ec872(0x21c)](_0x4ec872(0x256)+_0x20ac7a['message']);}}async function processSensorEvent(_0x17fc8d,_0x4596ad,_0x3bcac1,_0x40c1aa){const _0x24b227=a0_0x336bd2;if(!_0x40c1aa)return;const _0x44646f=_0x3bcac1[_0x24b227(0x307)],_0x2af011=Date[_0x24b227(0x2d4)](),_0x540490=_0x17fc8d[_0x24b227(0x20d)][_0x4596ad];_0x17fc8d[_0x24b227(0x20d)][_0x4596ad]=_0x44646f;if(!_0x40c1aa[_0x24b227(0x208)]&&_0x540490!=undefined&&_0x540490==_0x44646f)return;const _0x22ddab=(_0x40c1aa['type']||'')[_0x24b227(0x16a)](),_0x4e2bce=_0x22ddab[_0x24b227(0x1df)]('temperature')||_0x22ddab[_0x24b227(0x1df)](_0x24b227(0x1d3))||_0x22ddab['includes'](_0x24b227(0x2b2))||_0x22ddab[_0x24b227(0x1df)](_0x24b227(0x24c));_0x17fc8d[_0x24b227(0x2e9)]&&_0x4e2bce&&recordThermodynamics(_0x17fc8d,_0x4596ad,_0x44646f,_0x40c1aa[_0x24b227(0x234)]);const _0x173f5d={'timestamp':_0x2af011,'id':_0x4596ad,'name':_0x40c1aa[_0x24b227(0x191)],'type':_0x40c1aa[_0x24b227(0x1f8)],'location':_0x40c1aa[_0x24b227(0x234)],'value':_0x44646f};_0x17fc8d[_0x24b227(0x18a)][_0x24b227(0x302)](_0x173f5d);if(_0x17fc8d['eventHistory'][_0x24b227(0x1c3)]>HISTORY_MAX_SIZE)_0x17fc8d[_0x24b227(0x18a)][_0x24b227(0x2bc)]();await _0x17fc8d[_0x24b227(0x25b)]('events.lastEvent',{'val':JSON[_0x24b227(0x1bb)](_0x173f5d),'ack':!![]}),await _0x17fc8d['setStateAsync'](_0x24b227(0x277),{'val':JSON[_0x24b227(0x1bb)](_0x17fc8d[_0x24b227(0x18a)]),'ack':!![]});_0x17fc8d[_0x24b227(0x2e9)]&&(_0x17fc8d['rawEventLog'][_0x24b227(0x1c8)](_0x173f5d),await saveRawEventLog(_0x17fc8d),recordSequence(_0x17fc8d,_0x173f5d));if(_0x40c1aa[_0x24b227(0x199)]&&_0x44646f===!![]){if(_0x17fc8d['isPresent']&&!_0x17fc8d[_0x24b227(0x285)])startExitTimer(_0x17fc8d);else{if(!_0x17fc8d[_0x24b227(0x22f)])setPresence(_0x17fc8d,!![]);}}else{if(_0x40c1aa[_0x24b227(0x1f8)]==='motion'&&_0x44646f===!![]){if(_0x17fc8d['exitTimer'])abortExitTimer(_0x17fc8d);if(!_0x17fc8d[_0x24b227(0x22f)]&&_0x17fc8d[_0x24b227(0x22d)]===SYSTEM_MODES[_0x24b227(0x1c0)])setPresence(_0x17fc8d,!![]);}}}async function recordThermodynamics(_0x4998b9,_0x1af42f,_0x2b5a2,_0x4cf150){const _0x2da7ef=a0_0x336bd2,_0x31958f=await getOutsideTemperatureNumeric(_0x4998b9),_0x5ea9b9=await _0x4998b9[_0x2da7ef(0x23c)](_0x2da7ef(0x16e));let _0x13833b=[];if(_0x5ea9b9&&_0x5ea9b9[_0x2da7ef(0x307)])try{_0x13833b=JSON[_0x2da7ef(0x18b)](_0x5ea9b9[_0x2da7ef(0x307)]);}catch(_0x392e92){}_0x13833b[_0x2da7ef(0x1c8)]({'ts':Date[_0x2da7ef(0x2d4)](),'room':_0x4cf150||'Unknown','t_in':_0x2b5a2,'t_out':_0x31958f});if(_0x13833b['length']>THERMO_LOG_SIZE)_0x13833b[_0x2da7ef(0x276)]();await _0x4998b9[_0x2da7ef(0x25b)](_0x2da7ef(0x16e),{'val':JSON[_0x2da7ef(0x1bb)](_0x13833b),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x4fdf6){const _0x4d9fae=a0_0x336bd2;if(_0x4fdf6[_0x4d9fae(0x15f)][_0x4d9fae(0x1ec)])try{const _0x141e9e=await _0x4fdf6[_0x4d9fae(0x29a)](_0x4fdf6[_0x4d9fae(0x15f)][_0x4d9fae(0x1ec)]);if(_0x141e9e&&_0x141e9e['val']!==undefined&&_0x141e9e[_0x4d9fae(0x307)]!==null)return parseFloat(_0x141e9e[_0x4d9fae(0x307)]);}catch(_0x4afba5){}const _0x52d545=_0x4fdf6['config'][_0x4d9fae(0x1ab)];if(!_0x4fdf6[_0x4d9fae(0x15f)][_0x4d9fae(0x266)]||!_0x52d545)return null;try{let _0x554cbe='';if(_0x52d545[_0x4d9fae(0x1df)](_0x4d9fae(0x287)))_0x554cbe=_0x52d545+_0x4d9fae(0x26d);else{if(_0x52d545['includes'](_0x4d9fae(0x299)))_0x554cbe=_0x52d545+_0x4d9fae(0x301);else{if(_0x52d545['includes'](_0x4d9fae(0x300)))_0x554cbe=_0x52d545+_0x4d9fae(0x17b);else{if(_0x52d545[_0x4d9fae(0x1df)](_0x4d9fae(0x265)))_0x554cbe=_0x52d545+'.forecast.current.temp';}}}if(_0x554cbe){const _0x1b8dda=await _0x4fdf6['getForeignStateAsync'](_0x554cbe);if(_0x1b8dda&&_0x1b8dda[_0x4d9fae(0x307)]!==undefined&&_0x1b8dda[_0x4d9fae(0x307)]!==null)return parseFloat(_0x1b8dda[_0x4d9fae(0x307)]);}}catch(_0x377635){}return null;}async function recordSequence(_0x12d798,_0x2b6669){const _0x2136bb=a0_0x336bd2,_0x3c49d0=(_0x2b6669[_0x2136bb(0x1f8)]||'')[_0x2136bb(0x16a)](),_0x1dadbc=['motion',_0x2136bb(0x20e),'pr√§senz',_0x2136bb(0x175),_0x2136bb(0x1c4),_0x2136bb(0x1b2),_0x2136bb(0x2ea),_0x2136bb(0x1ff),_0x2136bb(0x1bf),_0x2136bb(0x165),'kontakt',_0x2136bb(0x288),_0x2136bb(0x306),'switch',_0x2136bb(0x189),_0x2136bb(0x2b9),'lampe'];if(!_0x1dadbc[_0x2136bb(0x2c8)](_0xf02905=>_0x3c49d0[_0x2136bb(0x1df)](_0xf02905)))return;if(!_0x2b6669['value'])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x2b6669[_0x2136bb(0x234)]||_0x2136bb(0x171),'id':_0x2b6669['id'],'ts':Date[_0x2136bb(0x2d4)]()}),sequenceTimer=setTimeout(async()=>{const _0x4dfc76=_0x2136bb;if(activeSequence[_0x4dfc76(0x1c3)]>0x1)await saveCompletedSequence(_0x12d798);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x5298df){const _0x312d4d=a0_0x336bd2;try{const _0x638151=await _0x5298df[_0x312d4d(0x23c)](_0x312d4d(0x2e7));let _0x5214eb=[];if(_0x638151&&_0x638151[_0x312d4d(0x307)])try{_0x5214eb=JSON['parse'](_0x638151[_0x312d4d(0x307)]);}catch(_0x3b0765){}const _0x1f1a88=activeSequence[0x0]['ts'],_0x39f907=activeSequence[_0x312d4d(0x2d0)](_0x14696b=>({'loc':_0x14696b[_0x312d4d(0x2ab)],'t_delta':Math[_0x312d4d(0x29b)]((_0x14696b['ts']-_0x1f1a88)/0x3e8)})),_0x458227={'timestamp':new Date(_0x1f1a88)[_0x312d4d(0x162)](),'steps':_0x39f907,'duration':Math[_0x312d4d(0x29b)]((activeSequence[activeSequence[_0x312d4d(0x1c3)]-0x1]['ts']-_0x1f1a88)/0x3e8),'daytime':new Date(_0x1f1a88)[_0x312d4d(0x1a4)]()};_0x5214eb[_0x312d4d(0x1c8)](_0x458227);if(_0x5214eb[_0x312d4d(0x1c3)]>MAX_TRAINING_SET_SIZE)_0x5214eb[_0x312d4d(0x276)]();await _0x5298df[_0x312d4d(0x25b)]('LTM.trainingData.sequences',{'val':JSON[_0x312d4d(0x1bb)](_0x5214eb),'ack':!![]}),runSecurityCheck(_0x5298df,_0x458227);}catch(_0x7bc039){_0x5298df[_0x312d4d(0x2ec)]['error'](_0x312d4d(0x2d2)+_0x7bc039[_0x312d4d(0x2b8)]);}}function runSecurityCheck(_0x1533dd,_0x2f5097){const _0x4bdd61=a0_0x336bd2;if(!_0x1533dd['isProVersion'])return;sendToPython(_0x1533dd,_0x4bdd61(0x24f),{'sequence':_0x2f5097});}function sendToPython(_0x1ae55b,_0x47e9b8,_0x3f6510={}){const _0x45f898=a0_0x336bd2;if(!_0x1ae55b['pythonProcess']||!_0x1ae55b[_0x45f898(0x26a)]['stdin'][_0x45f898(0x184)])return;const _0x30c71c=JSON['stringify']({'command':_0x47e9b8,..._0x3f6510});try{_0x1ae55b[_0x45f898(0x26a)][_0x45f898(0x30b)][_0x45f898(0x295)](_0x30c71c+'\x0a');}catch(_0x1de8f3){}}function startPythonService(_0x470e82){const _0x2c6137=a0_0x336bd2;let _0x3ec12d='python3';if(fs[_0x2c6137(0x311)](PYTHON_EXE))_0x3ec12d=PYTHON_EXE;try{const _0x3b6c7e=path['join'](__dirname,_0x2c6137(0x2f2),'service.py');_0x470e82[_0x2c6137(0x26a)]=spawn(_0x3ec12d,[_0x3b6c7e]),_0x470e82['pythonProcess'][_0x2c6137(0x1a6)]['on'](_0x2c6137(0x248),_0x3dbd5d=>{const _0x524e91=_0x2c6137,_0x16e237=_0x3dbd5d[_0x524e91(0x1b5)]()[_0x524e91(0x261)]('\x0a');_0x16e237['forEach'](_0x15c9ba=>{const _0xcd67d7=_0x524e91,_0x1c646b=_0x15c9ba[_0xcd67d7(0x310)]();if(!_0x1c646b)return;if(_0x1c646b[_0xcd67d7(0x187)](_0xcd67d7(0x245)))_0x470e82[_0xcd67d7(0x2ec)][_0xcd67d7(0x202)](_0xcd67d7(0x273)+_0x1c646b['substring'](0x5)['trim']());else{if(_0x1c646b[_0xcd67d7(0x187)]('[RESULT]'))try{const _0x287290=JSON[_0xcd67d7(0x18b)](_0x1c646b['substring'](0x8)['trim']());handlePythonResult(_0x470e82,_0x287290);}catch(_0x40069b){}}});}),_0x470e82[_0x2c6137(0x26a)]['on']('close',_0x1cee39=>{const _0x275b0e=_0x2c6137;_0x470e82[_0x275b0e(0x26a)]=null;});}catch(_0x49066b){_0x470e82['log'][_0x2c6137(0x21c)](_0x2c6137(0x2da)+_0x49066b[_0x2c6137(0x2b8)]);}}function stopPythonService(_0x27513e){const _0x4f63fa=a0_0x336bd2;if(_0x27513e[_0x4f63fa(0x26a)]){try{_0x27513e[_0x4f63fa(0x26a)]['kill']();}catch(_0xd3dfad){}_0x27513e[_0x4f63fa(0x26a)]=null;}}function handlePythonResult(_0x3ad411,_0x4a875e){const _0x57bf46=a0_0x336bd2;if(_0x4a875e[_0x57bf46(0x1f8)]===_0x57bf46(0x17f))_0x3ad411[_0x57bf46(0x2ec)]['debug'](_0x57bf46(0x312));else{if(_0x4a875e['type']===_0x57bf46(0x1a9)){const {anomaly_score:_0x194cfc,is_anomaly:_0x21fdb5,threshold:_0x5148ed,explanation:_0x2e8c2e}=_0x4a875e[_0x57bf46(0x2e6)];_0x3ad411[_0x57bf46(0x2ec)][_0x57bf46(0x2eb)](_0x57bf46(0x1ad)+_0x194cfc['toFixed'](0x5)+'\x20->\x20'+(_0x21fdb5?'ANOMALY':'OK')),_0x3ad411[_0x57bf46(0x25b)]('analysis.security.lastScore',{'val':_0x194cfc,'ack':!![]}),_0x3ad411[_0x57bf46(0x25b)]('analysis.security.lastCheck',{'val':new Date()[_0x57bf46(0x162)](),'ack':!![]});if(_0x5148ed)_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x17d),{'val':_0x5148ed,'ack':!![]});if(_0x21fdb5){let _0x22ca2f=_0x57bf46(0x1c5)+_0x194cfc[_0x57bf46(0x27a)](0x4)+')';if(_0x2e8c2e&&_0x2e8c2e!==_0x57bf46(0x171))_0x22ca2f+='\x0aGrund:\x20'+_0x2e8c2e;_0x3ad411[_0x57bf46(0x25b)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x2dc),{'val':_0x22ca2f,'ack':!![]}),sendNotification(_0x3ad411,'‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20'+_0x22ca2f,![],!![]);}}else{if(_0x4a875e['type']===_0x57bf46(0x160)){const _0x2438a7=_0x4a875e['payload'][_0x57bf46(0x1f6)]||'',_0x511629=_0x4a875e[_0x57bf46(0x2e6)][_0x57bf46(0x1ca)],_0x372b57=_0x4a875e[_0x57bf46(0x2e6)][_0x57bf46(0x1d7)]?'Success:\x20'+new Date()['toLocaleTimeString']()+'\x20('+_0x2438a7+')':_0x57bf46(0x29d)+_0x4a875e['payload'][_0x57bf46(0x16f)];_0x3ad411['setStateAsync'](_0x57bf46(0x1c2),{'val':_0x372b57,'ack':!![]});if(_0x4a875e[_0x57bf46(0x2e6)][_0x57bf46(0x1d7)]&&_0x511629)_0x3ad411[_0x57bf46(0x25b)]('analysis.security.currentThreshold',{'val':_0x511629,'ack':!![]});}else{if(_0x4a875e[_0x57bf46(0x1f8)]===_0x57bf46(0x177)){const {patterns:_0x5ab986}=_0x4a875e['payload'];if(_0x5ab986&&_0x5ab986['length']>0x0){_0x3ad411[_0x57bf46(0x2ec)]['info'](_0x57bf46(0x19e)+_0x5ab986[_0x57bf46(0x1c3)]+_0x57bf46(0x233)),_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x25a),{'val':JSON['stringify'](_0x5ab986),'ack':!![]});const _0x1a43e8=_0x5ab986[0x0],_0x534819=_0x57bf46(0x1c1)+_0x1a43e8['rule']+'\x20('+(_0x1a43e8[_0x57bf46(0x290)]*0x64)[_0x57bf46(0x27a)](0x0)+'%)';_0x3ad411['setStateAsync'](_0x57bf46(0x247),{'val':!![],'ack':!![]}),_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x2e8),{'val':_0x534819,'ack':!![]});}else _0x3ad411[_0x57bf46(0x2ec)][_0x57bf46(0x2eb)](_0x57bf46(0x27f)),_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x247),{'val':![],'ack':!![]}),_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x25a),{'val':'[]','ack':!![]});}else{if(_0x4a875e['type']===_0x57bf46(0x1d8)){if(_0x4a875e[_0x57bf46(0x2e6)]['success'])try{const _0x5cf275=JSON[_0x57bf46(0x18b)](_0x4a875e[_0x57bf46(0x2e6)][_0x57bf46(0x1f6)]);if(_0x5cf275[_0x57bf46(0x2e5)])_0x3ad411['setStateAsync']('analysis.energy.insulationScore',{'val':JSON[_0x57bf46(0x1bb)](_0x5cf275[_0x57bf46(0x2e5)]),'ack':!![]});if(_0x5cf275[_0x57bf46(0x279)])_0x3ad411['setStateAsync'](_0x57bf46(0x1b6),{'val':JSON[_0x57bf46(0x1bb)](_0x5cf275[_0x57bf46(0x279)]),'ack':!![]});}catch(_0xeef676){}}else{if(_0x4a875e[_0x57bf46(0x1f8)]===_0x57bf46(0x308)){if(_0x4a875e[_0x57bf46(0x2e6)][_0x57bf46(0x1d7)])_0x3ad411['log'][_0x57bf46(0x2eb)]('‚úÖ\x20HEALTH\x20TRAINED.');}else{if(_0x4a875e[_0x57bf46(0x1f8)]===_0x57bf46(0x2a0))_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x1cd),{'val':new Date()[_0x57bf46(0x162)](),'ack':!![]}),_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x222),{'val':_0x4a875e[_0x57bf46(0x2e6)][_0x57bf46(0x1ae)],'ack':!![]});else _0x4a875e['type']==='TREND_RESULT'&&(_0x3ad411[_0x57bf46(0x25b)](_0x57bf46(0x20c),{'val':_0x4a875e[_0x57bf46(0x2e6)]['diagnosis'],'ack':!![]}),_0x3ad411['setStateAsync'](_0x57bf46(0x20b),{'val':_0x4a875e['payload']['change_percent'],'ack':!![]}));}}}}}}}function runPythonHealthCheck(_0xe5aa43){const _0xe20f93=a0_0x336bd2;if(!_0xe5aa43[_0xe20f93(0x24b)]||_0xe5aa43[_0xe20f93(0x24b)][_0xe20f93(0x1c3)]<0x2)return;const _0x3b5d02=_0xe5aa43['dailyDigests'][_0xe20f93(0x2d0)](_0x7f2cc6=>{const _0x1c657e=_0xe20f93,_0x44890b=(_0x7f2cc6[_0x1c657e(0x2df)]||'')[_0x1c657e(0x16a)]();return ACTIVITY_LEVEL_MAP[_0x44890b]||0x32;});sendToPython(_0xe5aa43,_0xe20f93(0x18e),{'values':_0x3b5d02,'tag':_0xe20f93(0x19c)});}async function handleTelegramResponse(_0x595dca,_0x30c98d){const _0x114ca3=a0_0x336bd2;let _0x47455b=_0x30c98d;_0x30c98d['startsWith']('[')&&(_0x47455b=_0x30c98d['substring'](_0x30c98d[_0x114ca3(0x21a)](']')+0x1));if(_0x47455b===_0x114ca3(0x219))await _0x595dca['setStateAsync'](_0x114ca3(0x16d),{'val':![],'ack':!![]}),await _0x595dca[_0x114ca3(0x25b)](_0x114ca3(0x2dc),{'val':_0x114ca3(0x2ff),'ack':!![]}),_0x595dca[_0x114ca3(0x23f)]=![],sendNotification(_0x595dca,'‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x47455b===_0x114ca3(0x1e5)&&sendNotification(_0x595dca,_0x114ca3(0x263),![],!![]);}async function sendNotification(_0x599da3,_0x1403d3,_0x4ceb10=![],_0x20a565=![]){const _0x2b755b=a0_0x336bd2,_0x5a009c=_0x599da3['config'];if(_0x5a009c[_0x2b755b(0x167)]){let _0x466537={};(_0x1403d3[_0x2b755b(0x1df)](_0x2b755b(0x1ce))||_0x20a565)&&(_0x466537={'reply_markup':{'inline_keyboard':[[{'text':_0x2b755b(0x29e),'callback_data':_0x2b755b(0x219)}],[{'text':_0x2b755b(0x21d),'callback_data':_0x2b755b(0x1e5)}]]}}),await _0x599da3[_0x2b755b(0x163)](_0x5a009c['notifyTelegramInstance'],_0x2b755b(0x26c),{'text':_0x1403d3,'user':_0x5a009c['notifyTelegramRecipient'],..._0x466537});}if(_0x5a009c[_0x2b755b(0x2c9)]){let _0x2e670f={'message':_0x1403d3,'title':_0x20a565?'üö®\x20EMERGENCY':_0x2b755b(0x2c7),'priority':_0x20a565?0x2:0x1,'device':_0x5a009c[_0x2b755b(0x1aa)]};_0x20a565&&(_0x2e670f[_0x2b755b(0x29f)]=0x1e,_0x2e670f[_0x2b755b(0x1a7)]=0xe10,_0x2e670f['sound']=_0x2b755b(0x193)),await _0x599da3[_0x2b755b(0x163)](_0x5a009c[_0x2b755b(0x1fb)],'send',_0x2e670f);}_0x5a009c[_0x2b755b(0x2c4)]&&await _0x599da3[_0x2b755b(0x163)](_0x5a009c[_0x2b755b(0x2aa)],'send',{'text':_0x1403d3,'to':_0x5a009c[_0x2b755b(0x286)]});}function a0_0x5013(){const _0x1d5525=['timestamp','send','.Current.Temperature','getTime','Wetterdaten\x20deaktiviert.','indicator','briefingJob','ltmDriftCheckIntervalHours','[PYTHON]\x20','.\x20EMERGENCY:\x20','system','shift','events.history','application/json','heating','toFixed','Sec-Training\x20started...','Kein\x20API\x20Key!','analysis.automation.autoApply','events.lastEvent','üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','PRIORIT√ÑT:\x20Sicherheit.','Unbekannt','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','analysis.analysisHistory','Energy\x20Intelligence','isGracePeriodActive','notifyEmailRecipient','accuweather','light','analysis.automation.targetId','dependencyInstallInProgress','Success','callback','switch','systemUUID','Installing\x20pip\x20packages...','confidence','genAI','analysis.automation.triggerAction','isAlert','0\x203\x20*\x20*\x20*','write','@google/generative-ai','alertReason','Description','daswetter','getForeignStateAsync','round','extendObjectAsync','Failed:\x20','‚úÖ\x20Alles\x20OK\x20(Reset)','retry','HEALTH_RESULT','unload','detected','system.isPresent','useCalendar','N/A','LTM.driftAnalysis.lastCheck','boolean','exitTimer','geminiModel','notifyEmailInstance','loc','Current\x20Threshold','pip','node-schedule','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','VACATION','json','klima','endsWith','text','Analysiere\x20ausgewogen.','LTM.baselineStatus','bin','message','dimmer','analysis.security.lastCheck','setObjectNotExistsAsync','pop','184zVabma','description','main','‚ùå\x20INSTALL\x20FAILED:\x20','cogni-living\x20adapter\x20starting\x20(v','analysisInterval','latitude','notifyEmailEnabled','events.history_debug_00','lights','Cogni-Living','some','notifyPushoverEnabled','setState','.\x20EVENTS:\x20','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','analysis.security.lastScore','licenseKey','TRAIN_SECURITY','map','namespace','[RECORDER]\x20Error:\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','now','find','onUnload','string','python','ltmJob','Error\x20launching\x20Python:\x20','\x0aSTB:\x20','analysis.alertReason','üîç\x20Scanning\x20for\x20devices...','Target\x20Value','activityLevel','indicator.alarm','User\x20dismissed\x20automation\x20proposal.','analysis.security','analysis.training.triggerSecurity','Err:\x20','insulation','payload','LTM.trainingData.sequences','analysis.automation.description','isProVersion','t√ºr','info','log','Reset\x20Sched\x20Error:\x20','channel','system.config','longitude','analysisTimer','python_service','stateChange','enum','path','aiPersona','Health\x20Analysis','analysis.triggerBriefing','150070TgGBbK','subscribeForeignStatesAsync','.Current.WeatherText','getForeignObjectsAsync','telegram','motion','Vom\x20Benutzer\x20best√§tigt\x20(OK).','openweathermap','.NextHours.Location_1.Day_1.current.temp_value','unshift','Who\x20is\x20present?','Deaktiviert\x20(Pro-Feature)','value','licht','val','HEALTH_TRAIN_RESULT','üß™\x20Simulating\x20Butler\x20Proposal:\x20','üöÄ\x20Starting\x20System\x20Logic...','stdin','252VpvXRp','Pattern\x20Detected','object','360024iFQmOA','trim','existsSync','üêç\x20Python\x20Pong','PRIORIT√ÑT:\x20Gesundheit/AAL.','config','TRAINING_COMPLETE','LTM','toISOString','sendToAsync','Auto\x20Apply','contact','ack','notifyTelegramEnabled','warn','Kalender\x20deaktiviert.','toLowerCase','Training\x20Error:\x20','state','analysis.isAlert','LTM.trainingData.thermodynamics','reason','bind','Unknown','generateContent','exports','.communicate.request','presence','Kein\x20API\x20Key.','COMFORT_RESULT','N/A\x20(Learning)','response','models/gemini-flash-latest','.forecast.current.temperature','Daily\x20Digests','analysis.security.currentThreshold','common','PONG','Keine\x20Details.','targetValue','Heating\x20Score','cogni-living','writable','getDate','Target\x20ID','startsWith','ltmStbWindowDays','schalter','eventHistory','parse','text.alarm','geminiApiKey','ANALYZE_TREND','scanDevices','presenceDevices','name','1875105FLFcuF','siren','party','ltmLtbWindowDays','fill','automationProposal','(((.+)+)+)+$','isExit','LTM.driftAnalysis.driftDetails','analysis.training.triggerEnergy','Activity-Level','.venv','üõãÔ∏è\x20BUTLER:\x20Found\x20','59310TnpFmJ','807okIbIm','win32','No\x20instance','getOverviewData','getHours','Skipped\x20(No\x20AI\x20or\x20Data)','stdout','expire','Training\x20Status','SECURITY_RESULT','notifyPushoverRecipient','weatherInstance','online','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','is_anomaly','Started...','System','onMessage','door','Drift\x20Sched\x20Error:\x20','delObjectAsync','toString','analysis.energy.heatingScore','GUEST','subscribeStates','\x20=\x20','¬∞C,\x20','stringify','Digest','Train\x20Health','slice','fenster','NORMAL','Regel\x20erkannt:\x20','analysis.training.status','length','occupancy','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','platform','@iobroker/adapter-core','push','temperature','threshold','instance','summary','analysis.health.lastCheck','Alarm','LTM.processingStatus','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','172OLgrwf','splice','temperatur','0\x204\x20*\x20*\x20*','python3\x20-m\x20venv\x20\x22','guest','success','ENERGY_TRAIN_RESULT','child_process','üß†\x20Triggering\x20Security\x20Training...','requirements.txt','Last\x20Check','Missing\x20data','analysisHistory','includes','getGenerativeModel','apiKey','analysis.lastResult','from','\x20Tage)','COGNI_REQUEST_CALL','join','ready','setForeignStateAsync','Activity\x20Summary','Anomaly\x20Score','LTM.triggerDailyDigest','outdoorSensorId','dismissAutomation','pip.exe','doors','exitGraceTimer','onStateChange','status','cancel','date','5681rrWFBc','details','replace','type','inactivityThresholdHours','livingContext','notifyPushoverInstance','‚ùå\x20VENV\x20FAILED:\x20','systemConfig','analysis.activitySummary','window','getLtmData','Thermodynamics','debug','getCalendarNames','5410536TgKBtY','minDaysForBaseline','08:00','Fokus\x20auf\x20Komfort.','logDuplicates','analysis.health','LTM\x20Sched\x20Error:\x20','analysis.health.trendValue','analysis.health.trendDiagnosis','sensorLastValues','bewegung','filter','role','baselineDrift','System\x20Mode','number','KI-Modell\x20nicht\x20initialisiert','Event\x20History','Detected\x20Patterns','WiFi\x20Presence\x20detected.','Train\x20Comfort','COGNI_CONFIRM_OK','indexOf','rawEventLog','error','üìû\x20R√ºckruf\x20anfordern','analysis.automation.targetValue','Aktiv\x20(','briefingTime','getEnums','analysis.health.isAnomaly','üìù\x20Feedback\x20received:\x20','analysis.training.triggerHealth','Adapter','LTM.driftAnalysis','submitFeedback','unknown','Security\x20Monitor','search','isEmergency','LTM.rawEventLog','currentSystemMode','308IOkPRE','isPresent','Raw\x20Log','simulateButler','\x20*\x20*\x20*','\x20new\x20patterns.','location','driftDetails','analysis.energy','analysis.training','button','rmSync','Keine\x20Wetterdaten\x20verf√ºgbar.','analysis.trigger','getStateAsync','‚úÖ\x20INSTALL\x20SUCCESS.','city','lastAlertState','.\x20KONTEXT:\x20','AI\x20Training','modeResetJob','analysis.training.triggerComfort','devices','[LOG]',')\x20-\x20SAFE\x20BOOT','analysis.automation.patternDetected','data','automation.triggerAction','105FVrLTS','dailyDigests','heizung','.\x20ANWESEND:\x20','getFullYear','ANALYZE_SEQUENCE','Anomaly\x20Detected','onReady','getObjectAsync','targetId','command','driftAnalysisTimer','BUTLER\x20Execution\x20Error:\x20','PARTY','sendTo','analysis.history_debug_00','analysis.automation.detectedPatterns','setStateAsync','.\x20SYSTEM_MODE:\x20','communicate.request','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','system.presenceWho','scheduleJob','split','Scripts','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','normal','weatherunderground','useWeather','testApiKey','constructor','OK:\x20','pythonProcess'];a0_0x5013=function(){return _0x1d5525;};return a0_0x5013();}async function runGeminiAnalysis(_0x3f5221,_0xa31918=''){const _0x101314=a0_0x336bd2;if(!_0x3f5221[_0x101314(0x2a9)])return;if(_0x3f5221[_0x101314(0x18a)][_0x101314(0x1c3)]===0x0)return;const _0x501fcd=_0x3f5221[_0x101314(0x18a)]['slice'](0x0,0xf),_0x58269a=await getWeatherContext(_0x3f5221),_0x528aaf=_0x3f5221[_0x101314(0x22d)],_0x22e490=PERSONA_MAPPING[_0x3f5221['config'][_0x101314(0x2f6)]||'generic'],_0x5500c8=_0x3f5221[_0x101314(0x15f)][_0x101314(0x1fa)]||_0x101314(0x180);let _0x451d48=_0x101314(0x281);try{const _0x18f5b6=await _0x3f5221[_0x101314(0x23c)](_0x101314(0x25f));if(_0x18f5b6&&_0x18f5b6[_0x101314(0x307)])_0x451d48=_0x18f5b6[_0x101314(0x307)];}catch(_0x5124a3){}let _0x218900=![];try{const _0x40de90=await _0x3f5221[_0x101314(0x23c)]('analysis.automation.autoApply');if(_0x40de90&&_0x40de90[_0x101314(0x307)])_0x218900=!![];}catch(_0x5d05ba){}const _0x3103c8=_0x101314(0x2af)+_0x22e490+_0x101314(0x240)+_0x5500c8+_0x101314(0x25c)+_0x528aaf+'.\x20WETTER:\x20'+_0x58269a+_0x101314(0x24d)+_0x451d48+_0x101314(0x2cb)+JSON[_0x101314(0x1bb)](_0x501fcd)+_0x101314(0x274)+_0xa31918+_0x101314(0x25e);try{const _0x25f509=await _0x3f5221['geminiModel'][_0x101314(0x172)](_0x3103c8),_0x3b8c2b=JSON[_0x101314(0x18b)](_0x25f509[_0x101314(0x179)][_0x101314(0x2b4)]()['replace'](/```json|```/g,'')[_0x101314(0x310)]());await _0x3f5221[_0x101314(0x25b)](_0x101314(0x1e2),{'val':JSON[_0x101314(0x1bb)](_0x3b8c2b),'ack':!![]});if(_0x3b8c2b[_0x101314(0x1cc)])await _0x3f5221['setStateAsync'](_0x101314(0x1fe),{'val':_0x3b8c2b[_0x101314(0x1cc)],'ack':!![]});const _0x103761={'timestamp':Date[_0x101314(0x2d4)](),'id':Date[_0x101314(0x2d4)]()[_0x101314(0x1b5)](),'analysis':{'activity':{'summary':_0x3b8c2b[_0x101314(0x1cc)],'isAlert':_0x3b8c2b[_0x101314(0x293)],'alertReason':_0x3b8c2b[_0x101314(0x297)]},'comfort':{'automationProposal':_0x3b8c2b[_0x101314(0x197)]}}};await updateAnalysisHistory(_0x3f5221,_0x103761);const _0x50b04e=_0x3b8c2b[_0x101314(0x293)]||![];_0x50b04e!==_0x3f5221[_0x101314(0x23f)]&&(await _0x3f5221['setStateAsync'](_0x101314(0x16d),{'val':_0x50b04e,'ack':!![]}),_0x3f5221[_0x101314(0x23f)]=_0x50b04e,_0x50b04e&&(await _0x3f5221[_0x101314(0x25b)](_0x101314(0x2dc),{'val':_0x3b8c2b[_0x101314(0x297)],'ack':!![]}),sendNotification(_0x3f5221,'‚ö†Ô∏è\x20ALARM:\x20'+_0x3b8c2b['alertReason'],![],_0x3b8c2b[_0x101314(0x22b)])));if(_0x3b8c2b['automationProposal']&&_0x3b8c2b[_0x101314(0x197)][_0x101314(0x2a2)]){await _0x3f5221['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x3f5221[_0x101314(0x25b)]('analysis.automation.description',{'val':_0x3b8c2b[_0x101314(0x197)][_0x101314(0x2be)],'ack':!![]}),await _0x3f5221[_0x101314(0x25b)](_0x101314(0x289),{'val':_0x3b8c2b['automationProposal']['targetId'],'ack':!![]}),await _0x3f5221[_0x101314(0x25b)](_0x101314(0x21e),{'val':JSON[_0x101314(0x1bb)](_0x3b8c2b[_0x101314(0x197)][_0x101314(0x181)]),'ack':!![]});if(_0x218900)executeAutomationAction(_0x3f5221);}}catch(_0x4079aa){_0x3f5221[_0x101314(0x2ec)][_0x101314(0x21c)]('Gemini\x20Error:\x20'+_0x4079aa['message']);}}async function createDailyDigest(_0x39ee5d){const _0x2262cf=a0_0x336bd2;if(!_0x39ee5d[_0x2262cf(0x2e9)])return;await _0x39ee5d[_0x2262cf(0x25b)](LTM_DP_STATUS,{'val':_0x2262cf(0x1af),'ack':!![]});if(!_0x39ee5d[_0x2262cf(0x2a9)]||_0x39ee5d[_0x2262cf(0x21b)][_0x2262cf(0x1c3)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x39ee5d[_0x2262cf(0x25b)](LTM_DP_STATUS,{'val':_0x2262cf(0x1a5),'ack':!![]});return;}const _0x48f5e3=JSON['parse'](JSON[_0x2262cf(0x1bb)](_0x39ee5d[_0x2262cf(0x21b)])),_0x22256b=_0x48f5e3['length'],_0x164154=_0x2262cf(0x2d3)+JSON['stringify'](_0x48f5e3);try{const _0x59c945=await _0x39ee5d[_0x2262cf(0x2a9)]['generateContent'](_0x164154),_0x75a7de=JSON[_0x2262cf(0x18b)](_0x59c945['response'][_0x2262cf(0x2b4)]()[_0x2262cf(0x1f7)](/```json|```/g,'')[_0x2262cf(0x310)]()),_0x63e55c={'timestamp':new Date()[_0x2262cf(0x162)](),'eventCount':_0x22256b,'summary':_0x75a7de[_0x2262cf(0x1cc)]||_0x2262cf(0x1bc),'activityLevel':_0x75a7de[_0x2262cf(0x2df)]||_0x2262cf(0x264),'systemMode':_0x39ee5d[_0x2262cf(0x22d)]};_0x39ee5d[_0x2262cf(0x24b)][_0x2262cf(0x1c8)](_0x63e55c),await saveDailyDigests(_0x39ee5d),_0x39ee5d[_0x2262cf(0x21b)]=[],await saveRawEventLog(_0x39ee5d),await _0x39ee5d[_0x2262cf(0x25b)](LTM_DP_STATUS,{'val':_0x2262cf(0x28b),'ack':!![]});if(_0x39ee5d[_0x2262cf(0x2e9)])sendToPython(_0x39ee5d,'ANALYZE_HEALTH',{'digest':_0x63e55c});}catch(_0x14d0cf){_0x39ee5d[_0x2262cf(0x2ec)][_0x2262cf(0x21c)](_0x14d0cf[_0x2262cf(0x2b8)]);}}function setupLtmScheduler(_0x5f3b58){const _0xc5fde8=a0_0x336bd2;try{if(_0x5f3b58[_0xc5fde8(0x2d9)])_0x5f3b58['ltmJob'][_0xc5fde8(0x1f3)]();if(!_0x5f3b58[_0xc5fde8(0x2e9)])return;_0x5f3b58[_0xc5fde8(0x2d9)]=schedule[_0xc5fde8(0x260)](LTM_SCHEDULE,()=>createDailyDigest(_0x5f3b58));}catch(_0x5ee3cb){_0x5f3b58['log'][_0xc5fde8(0x21c)](_0xc5fde8(0x20a)+_0x5ee3cb[_0xc5fde8(0x2b8)]);}}function setupModeResetScheduler(_0x1cbab2){const _0x174bb5=a0_0x336bd2;try{if(_0x1cbab2['modeResetJob'])_0x1cbab2[_0x174bb5(0x242)][_0x174bb5(0x1f3)]();_0x1cbab2['modeResetJob']=schedule[_0x174bb5(0x260)](MODE_RESET_SCHEDULE,async()=>{const _0x280c58=_0x174bb5;await loadSystemMode(_0x1cbab2),AUTO_RESET_MODES[_0x280c58(0x1df)](_0x1cbab2[_0x280c58(0x22d)])&&await _0x1cbab2[_0x280c58(0x25b)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x280c58(0x1c0)],'ack':![]});});}catch(_0x456e9b){_0x1cbab2[_0x174bb5(0x2ec)][_0x174bb5(0x21c)](_0x174bb5(0x2ed)+_0x456e9b[_0x174bb5(0x2b8)]);}}function setupDriftAnalysisScheduler(_0x51d21b){const _0x14aa68=a0_0x336bd2;try{if(_0x51d21b[_0x14aa68(0x255)])clearInterval(_0x51d21b['driftAnalysisTimer']);if(!_0x51d21b[_0x14aa68(0x2e9)])return;_0x51d21b[_0x14aa68(0x255)]=setInterval(()=>runBaselineDriftAnalysis(_0x51d21b),(_0x51d21b['config'][_0x14aa68(0x272)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x51d21b),0x1388);}catch(_0x291be9){_0x51d21b[_0x14aa68(0x2ec)][_0x14aa68(0x21c)](_0x14aa68(0x1b3)+_0x291be9[_0x14aa68(0x2b8)]);}}function setupBriefingScheduler(_0x24fcbe){const _0x447d3d=a0_0x336bd2;try{if(_0x24fcbe[_0x447d3d(0x271)])_0x24fcbe[_0x447d3d(0x271)][_0x447d3d(0x1f3)]();if(!_0x24fcbe[_0x447d3d(0x15f)]['briefingEnabled'])return;const _0x1eb508=(_0x24fcbe['config'][_0x447d3d(0x220)]||_0x447d3d(0x206))[_0x447d3d(0x261)](':'),_0x222f04=parseInt(_0x1eb508[0x0])||0x8,_0x5e959f=parseInt(_0x1eb508[0x1])||0x0,_0x23acb3=_0x5e959f+'\x20'+_0x222f04+_0x447d3d(0x232);_0x24fcbe['briefingJob']=schedule['scheduleJob'](_0x23acb3,()=>{sendMorningBriefing(_0x24fcbe);});}catch(_0x4e728b){_0x24fcbe[_0x447d3d(0x2ec)][_0x447d3d(0x21c)]('Briefing\x20Sched\x20Error:\x20'+_0x4e728b['message']);}}function a0_0x414c(_0x1c21ad,_0x4c49d0){const _0x4a071a=a0_0x5013();return a0_0x414c=function(_0x42bc91,_0x2ac6ed){_0x42bc91=_0x42bc91-0x15f;let _0x5013e3=_0x4a071a[_0x42bc91];return _0x5013e3;},a0_0x414c(_0x1c21ad,_0x4c49d0);}async function runBaselineDriftAnalysis(_0x521024){const _0x5439d8=a0_0x336bd2;if(!_0x521024[_0x5439d8(0x2e9)]||!_0x521024[_0x5439d8(0x2a9)])return;const _0x4abff7=_0x521024[_0x5439d8(0x15f)][_0x5439d8(0x188)]||0xe;if(_0x521024[_0x5439d8(0x24b)]['length']<_0x4abff7+0x7){await _0x521024['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x5439d8(0x178),'ack':!![]});return;}const _0x1a15f5=_0x521024['dailyDigests']['slice'](-_0x4abff7),_0x23bc83=_0x521024[_0x5439d8(0x24b)]['slice'](0x0,_0x521024[_0x5439d8(0x24b)]['length']-_0x4abff7),_0x493ecd=_0x5439d8(0x282)+JSON[_0x5439d8(0x1bb)](_0x23bc83)+_0x5439d8(0x2db)+JSON[_0x5439d8(0x1bb)](_0x1a15f5);try{const _0x5ee5c6=await _0x521024[_0x5439d8(0x2a9)]['generateContent'](_0x493ecd),_0x5d7ca6=JSON[_0x5439d8(0x18b)](_0x5ee5c6['response']['text']()[_0x5439d8(0x1f7)](/```json|```/g,'')['trim']());_0x5d7ca6['baselineDrift']&&(await _0x521024[_0x5439d8(0x25b)](LTM_DP_DRIFT_STATUS,{'val':_0x5d7ca6[_0x5439d8(0x211)],'ack':!![]}),await _0x521024['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x5d7ca6[_0x5439d8(0x235)],'ack':!![]}),await _0x521024[_0x5439d8(0x25b)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x5439d8(0x2d4)](),'ack':!![]}));}catch(_0x4147c5){}}class CogniLiving extends utils[a0_0x336bd2(0x225)]{constructor(_0x45d220){const _0x55f510=a0_0x336bd2;super({..._0x45d220,'name':_0x55f510(0x183)}),this[_0x55f510(0x18a)]=[],this[_0x55f510(0x1de)]=[],this[_0x55f510(0x21b)]=[],this['dailyDigests']=[],this[_0x55f510(0x20d)]={},this[_0x55f510(0x1fd)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x55f510(0x22f)]=!![],this[_0x55f510(0x2a8)]=null,this[_0x55f510(0x1f0)]=null,this['isGracePeriodActive']=![],this['genAI']=null,this[_0x55f510(0x2a9)]=null,this[_0x55f510(0x22d)]=SYSTEM_MODES[_0x55f510(0x1c0)],this[_0x55f510(0x2e9)]=![],this[_0x55f510(0x23f)]=![],this[_0x55f510(0x28e)]=_0x55f510(0x228),this[_0x55f510(0x2f1)]=null,this[_0x55f510(0x2d9)]=null,this[_0x55f510(0x242)]=null,this[_0x55f510(0x255)]=null,this[_0x55f510(0x271)]=null,this[_0x55f510(0x26a)]=null,this[_0x55f510(0x28a)]=![],this['on'](_0x55f510(0x1e7),this[_0x55f510(0x251)][_0x55f510(0x170)](this)),this['on'](_0x55f510(0x2f3),this['onStateChange']['bind'](this)),this['on'](_0x55f510(0x2a1),this['onUnload'][_0x55f510(0x170)](this)),this['on'](_0x55f510(0x2b8),this[_0x55f510(0x1b1)][_0x55f510(0x170)](this));}async[a0_0x336bd2(0x251)](){const _0xc4e4ac=a0_0x336bd2;this[_0xc4e4ac(0x2ec)]['info'](_0xc4e4ac(0x2c1)+this['version']+_0xc4e4ac(0x246));if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x336bd2(0x2d6)](_0x22b880){const _0x407c4d=a0_0x336bd2;if(this[_0x407c4d(0x2f1)])clearInterval(this['analysisTimer']);if(this[_0x407c4d(0x255)])clearInterval(this[_0x407c4d(0x255)]);if(this[_0x407c4d(0x2d9)])this[_0x407c4d(0x2d9)][_0x407c4d(0x1f3)]();if(this['modeResetJob'])this[_0x407c4d(0x242)][_0x407c4d(0x1f3)]();if(this[_0x407c4d(0x271)])this[_0x407c4d(0x271)][_0x407c4d(0x1f3)]();if(this['exitTimer'])clearTimeout(this[_0x407c4d(0x2a8)]);if(this[_0x407c4d(0x1f0)])clearTimeout(this[_0x407c4d(0x1f0)]);stopPythonService(this),_0x22b880();}async[a0_0x336bd2(0x1f1)](_0xebed83,_0x35423f){const _0x1d9816=a0_0x336bd2;if(!_0x35423f||this[_0x1d9816(0x28a)])return;if(_0xebed83[_0x1d9816(0x1df)](_0x1d9816(0x2fd))&&_0xebed83[_0x1d9816(0x2b3)](_0x1d9816(0x25d))&&_0x35423f['val']){await handleTelegramResponse(this,_0x35423f[_0x1d9816(0x307)]);return;}if(_0xebed83===this[_0x1d9816(0x2d1)]+'.'+SYSTEM_DP_MODE){if(_0x35423f[_0x1d9816(0x307)]&&Object['values'](SYSTEM_MODES)['includes'](_0x35423f[_0x1d9816(0x307)])){this[_0x1d9816(0x22d)]=_0x35423f[_0x1d9816(0x307)];if(_0x35423f[_0x1d9816(0x307)]===SYSTEM_MODES[_0x1d9816(0x2b0)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x35423f['ack'])this[_0x1d9816(0x2ca)](_0xebed83,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x35423f[_0x1d9816(0x166)]){_0xebed83[_0x1d9816(0x1df)](_0x1d9816(0x23b))&&_0x35423f[_0x1d9816(0x307)]&&(this[_0x1d9816(0x2ca)](_0xebed83,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0xebed83[_0x1d9816(0x1df)]('triggerDailyDigest')&&_0x35423f[_0x1d9816(0x307)]){this[_0x1d9816(0x2ca)](_0xebed83,{'val':![],'ack':!![]});if(this[_0x1d9816(0x2e9)])createDailyDigest(this);}_0xebed83[_0x1d9816(0x1df)]('triggerBriefing')&&_0x35423f[_0x1d9816(0x307)]&&(this[_0x1d9816(0x2ca)](_0xebed83,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0xebed83[_0x1d9816(0x1df)](_0x1d9816(0x249))&&_0x35423f[_0x1d9816(0x307)]&&(this[_0x1d9816(0x2ca)](_0xebed83,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0xebed83['includes'](_0x1d9816(0x2e3))&&_0x35423f[_0x1d9816(0x307)]){this[_0x1d9816(0x2ca)](_0xebed83,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x41604f=await this[_0x1d9816(0x23c)](_0x1d9816(0x2e7));if(_0x41604f&&_0x41604f[_0x1d9816(0x307)]){const _0x13bd03=JSON[_0x1d9816(0x18b)](_0x41604f['val']);this[_0x1d9816(0x2ec)]['info'](_0x1d9816(0x1da)),this[_0x1d9816(0x25b)]('analysis.training.status',{'val':_0x1d9816(0x27b),'ack':!![]}),sendToPython(this,_0x1d9816(0x2cf),{'sequences':_0x13bd03});}}catch(_0x311b70){this[_0x1d9816(0x2ec)][_0x1d9816(0x21c)](_0x1d9816(0x16b)+_0x311b70['message']);}}if(_0xebed83[_0x1d9816(0x1df)](_0x1d9816(0x224))&&_0x35423f[_0x1d9816(0x307)]){this[_0x1d9816(0x2ca)](_0xebed83,{'val':![],'ack':!![]});if(this[_0x1d9816(0x2e9)])try{const _0x285cc1=await this[_0x1d9816(0x23c)](LTM_DP_DAILY_DIGESTS);if(_0x285cc1&&_0x285cc1[_0x1d9816(0x307)])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0x1d9816(0x18b)](_0x285cc1[_0x1d9816(0x307)])});}catch(_0x2e54ba){}}if(_0xebed83[_0x1d9816(0x1df)](_0x1d9816(0x19b))&&_0x35423f[_0x1d9816(0x307)]){this[_0x1d9816(0x2ca)](_0xebed83,{'val':![],'ack':!![]});if(this[_0x1d9816(0x2e9)])try{const _0x3d87f9=await this[_0x1d9816(0x23c)](_0x1d9816(0x16e));if(_0x3d87f9&&_0x3d87f9[_0x1d9816(0x307)])sendToPython(this,'TRAIN_ENERGY',{'points':JSON['parse'](_0x3d87f9[_0x1d9816(0x307)])});}catch(_0x46d5e7){}}if(_0xebed83['includes'](_0x1d9816(0x243))&&_0x35423f[_0x1d9816(0x307)]){this['setState'](_0xebed83,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x37eb30=await this[_0x1d9816(0x23c)](LTM_DP_RAW_LOG);_0x37eb30&&_0x37eb30[_0x1d9816(0x307)]&&(this[_0x1d9816(0x2ec)][_0x1d9816(0x2eb)]('üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...'),sendToPython(this,'TRAIN_COMFORT',{'events':JSON[_0x1d9816(0x18b)](_0x37eb30[_0x1d9816(0x307)])}));}catch(_0x2092a8){}}return;}if(this[_0x1d9816(0x15f)][_0x1d9816(0x190)]&&this[_0x1d9816(0x15f)][_0x1d9816(0x190)][_0x1d9816(0x1df)](_0xebed83)){await checkWifiPresence(this);return;}const _0x33fc1a=(this[_0x1d9816(0x15f)][_0x1d9816(0x244)]||[])[_0x1d9816(0x2d5)](_0x597846=>_0x597846['id']===_0xebed83);if(_0x33fc1a)processSensorEvent(this,_0xebed83,_0x35423f,_0x33fc1a);}async[a0_0x336bd2(0x1b1)](_0x5ea3f1){const _0x1e9a98=a0_0x336bd2;if(typeof _0x5ea3f1===_0x1e9a98(0x30e)&&_0x5ea3f1['message']){if(_0x5ea3f1[_0x1e9a98(0x254)]===_0x1e9a98(0x267)){const _0x81af5a=_0x5ea3f1[_0x1e9a98(0x2b8)][_0x1e9a98(0x1e1)]||this[_0x1e9a98(0x15f)]['geminiApiKey'];if(!_0x81af5a)return this[_0x1e9a98(0x258)](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1['command'],{'success':![],'message':_0x1e9a98(0x176)},_0x5ea3f1[_0x1e9a98(0x28c)]);try{const _0x40d220=new GoogleGenerativeAI(_0x81af5a),_0x52895d=_0x40d220['getGenerativeModel']({'model':GEMINI_MODEL}),_0x3ea945=await _0x52895d[_0x1e9a98(0x172)]('Hi');this[_0x1e9a98(0x258)](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![],'message':_0x1e9a98(0x269)+_0x3ea945[_0x1e9a98(0x179)][_0x1e9a98(0x2b4)]()},_0x5ea3f1[_0x1e9a98(0x28c)]);}catch(_0x585280){this['sendTo'](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1['command'],{'success':![],'message':_0x1e9a98(0x2e4)+_0x585280['message']},_0x5ea3f1[_0x1e9a98(0x28c)]);}}else{if(_0x5ea3f1['command']==='testContext'){const _0x1f1993=await getWeatherContext(this),_0x308924=await getCalendarContext(this);this[_0x1e9a98(0x258)](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![],'weather':_0x1f1993,'calendar':_0x308924},_0x5ea3f1[_0x1e9a98(0x28c)]);}else{if(_0x5ea3f1[_0x1e9a98(0x254)]===_0x1e9a98(0x200)){if(!this[_0x1e9a98(0x2e9)])return this[_0x1e9a98(0x258)](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1['command'],{'success':![],'isPro':![]},_0x5ea3f1[_0x1e9a98(0x28c)]);let _0x299082={'status':_0x1e9a98(0x2a5)};try{const _0x483bbf=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x299082['status']=_0x483bbf?_0x483bbf[_0x1e9a98(0x307)]:_0x1e9a98(0x2a5);}catch(_0x2e4b7b){}this['sendTo'](_0x5ea3f1['from'],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x1e9a98(0x24b)],'driftAnalysis':_0x299082,'analysisHistory':this[_0x1e9a98(0x1de)]},_0x5ea3f1[_0x1e9a98(0x28c)]);}else{if(_0x5ea3f1[_0x1e9a98(0x254)]===_0x1e9a98(0x1a3)){const _0x3c42c3=this[_0x1e9a98(0x24b)][_0x1e9a98(0x1c3)],_0x36f976=new Date(),_0x51698e=new Date(_0x36f976[_0x1e9a98(0x24e)](),_0x36f976['getMonth'](),_0x36f976[_0x1e9a98(0x185)]())['getTime'](),_0x121837=this['rawEventLog'][_0x1e9a98(0x20f)](_0x49eb92=>new Date(_0x49eb92['timestamp'])[_0x1e9a98(0x26e)]()>_0x51698e)[_0x1e9a98(0x1c3)],_0x8a0000=new Array(0x18)[_0x1e9a98(0x196)](0x0);this[_0x1e9a98(0x21b)]['forEach'](_0x201ef4=>{const _0x42c41c=_0x1e9a98,_0x1faf81=new Date(_0x201ef4[_0x42c41c(0x26b)]);if(_0x1faf81[_0x42c41c(0x26e)]()>_0x51698e)_0x8a0000[_0x1faf81['getHours']()]++;});let _0x1dfbef={'status':_0x1e9a98(0x2a5)};try{const _0x191332=await this[_0x1e9a98(0x23c)](LTM_DP_DRIFT_STATUS);_0x1dfbef[_0x1e9a98(0x1f2)]=_0x191332?_0x191332['val']:_0x1e9a98(0x2a5);}catch(_0x191962){}let _0x441d67='';try{const _0x23e952=await this[_0x1e9a98(0x23c)](_0x1e9a98(0x25f));_0x441d67=_0x23e952?_0x23e952[_0x1e9a98(0x307)]:'';}catch(_0x294af2){}let _0x5d526d=null;!this['geminiModel']&&(_0x5d526d=this[_0x1e9a98(0x15f)]['geminiApiKey']?_0x1e9a98(0x214):_0x1e9a98(0x27c));let _0x34b0e5={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x4253c4=await this['getStateAsync']('analysis.automation.patternDetected');if(_0x4253c4&&_0x4253c4[_0x1e9a98(0x307)]){_0x34b0e5['detected']=!![];const _0x35f49e=await this[_0x1e9a98(0x23c)]('analysis.automation.description');_0x34b0e5['description']=_0x35f49e?_0x35f49e['val']:'';const _0x5f11f9=await this[_0x1e9a98(0x23c)](_0x1e9a98(0x289));_0x34b0e5[_0x1e9a98(0x253)]=_0x5f11f9?_0x5f11f9[_0x1e9a98(0x307)]:'';const _0x4cfac4=await this[_0x1e9a98(0x23c)](_0x1e9a98(0x21e));_0x34b0e5[_0x1e9a98(0x181)]=_0x4cfac4?_0x4cfac4['val']:'';}const _0x17b1af=await this['getStateAsync'](_0x1e9a98(0x27d));_0x34b0e5['autoApply']=_0x17b1af?!!_0x17b1af[_0x1e9a98(0x307)]:![];}catch(_0x493d53){}this['sendTo'](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![],'eventHistory':this[_0x1e9a98(0x18a)][_0x1e9a98(0x1be)](0x0,0xf),'stats':{'digestCount':_0x3c42c3,'eventCountToday':_0x121837,'hourlyActivity':_0x8a0000,'driftStatus':_0x1dfbef[_0x1e9a98(0x1f2)],'isPresent':this[_0x1e9a98(0x22f)],'presenceWho':_0x441d67,'minDays':this['config'][_0x1e9a98(0x205)]||0x7,'stbDays':this['config'][_0x1e9a98(0x188)]||0xe,'ltbDays':this[_0x1e9a98(0x15f)][_0x1e9a98(0x195)]||0x3c,'systemError':_0x5d526d},'automation':_0x34b0e5},_0x5ea3f1[_0x1e9a98(0x28c)]);}else{if(_0x5ea3f1['command']===_0x1e9a98(0x18f))try{const _0x1e20ab=await scanForDevices(this,_0x5ea3f1[_0x1e9a98(0x2b8)]||{});this[_0x1e9a98(0x258)](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![],'devices':_0x1e20ab},_0x5ea3f1[_0x1e9a98(0x28c)]);}catch(_0x13e2a5){this[_0x1e9a98(0x258)](_0x5ea3f1['from'],_0x5ea3f1['command'],{'success':![],'error':_0x13e2a5[_0x1e9a98(0x2b8)]},_0x5ea3f1[_0x1e9a98(0x28c)]);}else{if(_0x5ea3f1[_0x1e9a98(0x254)]===_0x1e9a98(0x221)){const _0x2c86cf=await this['getForeignObjectsAsync']('enum.functions.*',_0x1e9a98(0x2f4)),_0x348ee3=[];if(_0x2c86cf)for(const _0x70cad3 in _0x2c86cf){const _0x33d80b=_0x2c86cf[_0x70cad3],_0x5cbfe0=(_0x33d80b[_0x1e9a98(0x17e)]&&typeof _0x33d80b[_0x1e9a98(0x17e)][_0x1e9a98(0x191)]===_0x1e9a98(0x30e)?_0x33d80b[_0x1e9a98(0x17e)][_0x1e9a98(0x191)]['de']:_0x33d80b[_0x1e9a98(0x17e)]['name'])||_0x33d80b[_0x1e9a98(0x17e)][_0x1e9a98(0x191)];_0x348ee3['push']({'id':_0x70cad3,'name':_0x5cbfe0});}this[_0x1e9a98(0x258)](_0x5ea3f1['from'],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![],'enums':_0x348ee3},_0x5ea3f1['callback']);}else{if(_0x5ea3f1[_0x1e9a98(0x254)]===_0x1e9a98(0x203)){const _0x711315=_0x5ea3f1[_0x1e9a98(0x2b8)][_0x1e9a98(0x1cb)];if(!_0x711315)return this[_0x1e9a98(0x258)](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1['command'],{'success':![],'error':_0x1e9a98(0x1a2)},_0x5ea3f1[_0x1e9a98(0x28c)]);const _0xac386d=await getCalendarNames(this,_0x711315);this['sendTo'](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![],'names':_0xac386d},_0x5ea3f1[_0x1e9a98(0x28c)]);}else{if(_0x5ea3f1[_0x1e9a98(0x254)]===_0x1e9a98(0x231)){const {targetId:_0x328f75,targetValue:_0xc75a5e}=_0x5ea3f1[_0x1e9a98(0x2b8)];this['log']['info'](_0x1e9a98(0x309)+_0x328f75+_0x1e9a98(0x1b9)+_0xc75a5e),await this[_0x1e9a98(0x25b)](_0x1e9a98(0x247),{'val':!![],'ack':!![]}),await this[_0x1e9a98(0x25b)](_0x1e9a98(0x2e8),{'val':_0x1e9a98(0x2cc)+_0x328f75,'ack':!![]}),await this[_0x1e9a98(0x25b)](_0x1e9a98(0x289),{'val':_0x328f75,'ack':!![]}),await this[_0x1e9a98(0x25b)]('analysis.automation.targetValue',{'val':_0xc75a5e,'ack':!![]}),this['sendTo'](_0x5ea3f1['from'],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![]},_0x5ea3f1['callback']);}else{if(_0x5ea3f1[_0x1e9a98(0x254)]===_0x1e9a98(0x227)){const {historyId:_0xb16fd8,rating:_0x2f82cd,comment:_0x2d9c9a,alertReason:_0x23e6e2}=_0x5ea3f1['message'];_0xb16fd8&&_0x2f82cd?(await saveFeedback(this,{'timestamp':Date[_0x1e9a98(0x2d4)](),'historyId':_0xb16fd8,'rating':_0x2f82cd,'comment':_0x2d9c9a,'alertReason':_0x23e6e2}),this[_0x1e9a98(0x258)](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![]},_0x5ea3f1[_0x1e9a98(0x28c)])):this['sendTo'](_0x5ea3f1[_0x1e9a98(0x1e3)],_0x5ea3f1[_0x1e9a98(0x254)],{'success':![],'error':_0x1e9a98(0x1dd)},_0x5ea3f1['callback']);}else _0x5ea3f1[_0x1e9a98(0x254)]===_0x1e9a98(0x1ed)&&(this[_0x1e9a98(0x2ec)][_0x1e9a98(0x2eb)](_0x1e9a98(0x2e1)),await this[_0x1e9a98(0x25b)](_0x1e9a98(0x247),{'val':![],'ack':!![]}),await this[_0x1e9a98(0x25b)](_0x1e9a98(0x2e8),{'val':'','ack':!![]}),this[_0x1e9a98(0x258)](_0x5ea3f1['from'],_0x5ea3f1[_0x1e9a98(0x254)],{'success':!![]},_0x5ea3f1[_0x1e9a98(0x28c)]));}}}}}}}}}}}if(require[a0_0x336bd2(0x2bf)]!==module)module[a0_0x336bd2(0x173)]=_0x4824b3=>new CogniLiving(_0x4824b3);else new CogniLiving();