const a0_0x559667=a0_0x2d68;(function(_0x1eeb0f,_0x2274ba){const _0x5bab57=a0_0x2d68,_0x31dc67=_0x1eeb0f();while(!![]){try{const _0x28f921=-parseInt(_0x5bab57(0x227))/0x1*(parseInt(_0x5bab57(0x2bc))/0x2)+parseInt(_0x5bab57(0x27b))/0x3+-parseInt(_0x5bab57(0x2b9))/0x4*(-parseInt(_0x5bab57(0x27f))/0x5)+-parseInt(_0x5bab57(0x2b3))/0x6*(-parseInt(_0x5bab57(0x267))/0x7)+parseInt(_0x5bab57(0x305))/0x8*(-parseInt(_0x5bab57(0x312))/0x9)+parseInt(_0x5bab57(0x2c3))/0xa*(parseInt(_0x5bab57(0x2e7))/0xb)+-parseInt(_0x5bab57(0x2d5))/0xc;if(_0x28f921===_0x2274ba)break;else _0x31dc67['push'](_0x31dc67['shift']());}catch(_0x495c9a){_0x31dc67['push'](_0x31dc67['shift']());}}}(a0_0x50f0,0xde1ed));const a0_0x174996=(function(){let _0x433c0b=!![];return function(_0x1051ab,_0x465a79){const _0x1c70c4=_0x433c0b?function(){const _0x42002f=a0_0x2d68;if(_0x465a79){const _0x88e969=_0x465a79[_0x42002f(0x2ca)](_0x1051ab,arguments);return _0x465a79=null,_0x88e969;}}:function(){};return _0x433c0b=![],_0x1c70c4;};}()),a0_0xb8863a=a0_0x174996(this,function(){const _0x21583f=a0_0x2d68;return a0_0xb8863a[_0x21583f(0x30b)]()[_0x21583f(0x2e8)]('(((.+)+)+)+$')[_0x21583f(0x30b)]()[_0x21583f(0x1f0)](a0_0xb8863a)['search'](_0x21583f(0x290));});a0_0xb8863a();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),path=require(a0_0x559667(0x206)),fs=require('fs'),installer=require('./lib/installer'),scanner=require(a0_0x559667(0x23c)),schedulers=require('./lib/scheduler'),topology=require(a0_0x559667(0x2c4)),setup=require('./lib/setup'),recorder=require(a0_0x559667(0x27d)),pythonBridge=require(a0_0x559667(0x1f8)),aiAgent=require(a0_0x559667(0x2f4)),deadMan=require(a0_0x559667(0x285)),automation=require(a0_0x559667(0x2e2)),GEMINI_MODEL='models/gemini-flash-latest';function a0_0x2d68(_0x38c94d,_0x5b3649){const _0x58a2de=a0_0x50f0();return a0_0x2d68=function(_0xb8863a,_0x174996){_0xb8863a=_0xb8863a-0x1e0;let _0x50f0cb=_0x58a2de[_0xb8863a];return _0x50f0cb;},a0_0x2d68(_0x38c94d,_0x5b3649);}function a0_0x50f0(){const _0x3d7e47=['ðŸ’¾\x20Saving\x20Daily\x20History\x20for\x20','scheduleJob','SET_LEARNING_MODE','analysis.health.geminiNight','analysis.training.triggerEnergy','(((.+)+)+)+$','infrasoundLocked','timestamp','modules','parse','getStateAsync','isPresent','readFileSync','writeFileSync','runGeminiAnalysis','rows','ðŸ”®\x20Energy\x20Prediction\x20triggered\x20(','getHours','info','Daily\x20Activity\x20Vector\x20(48x30min)','abortExitTimer','endsWith','...','getCalendarNames','fill','Gemini\x20Init\x20Error:\x20','enum.rooms.*','isProVersion','testApiKey','sources','isArray','system.adapter.','join','values','enum','find','analysisTimer','number','trackerHeartbeat','presenceDevices','657366LlahGW','Keine\x20Daten','saveDailyHistory','subscribeStates','toLowerCase','toLocaleDateString','729248EubIye','âœ…\x20History\x20saved:\x20','setStateAsync','20LkFHtS','appendToLog','round','setState','date','subscribeForeignStatesAsync','party','20kstanT','./lib/topology','historyJob','genAI','refreshCalendar','toISOString','.venv','apply','moduleHealth','VACATION','send','history','History\x20Save\x20Error:\x20','Gemini\x20Report\x20Day','ðŸ“¦\x20Restored\x20','SYSTEM_DP_MODE','driftAnalysisTimer','startSystem','40881996JIhfQY','node-schedule','exports','outdoorSensorId','analysis.health.todayVector','DAY','dailyDigests','python','state','geminiModel','getMinutes','unload','scanForDevices','./lib/automation','moduleEnergy','â†º\x20Replaying\x20','memoryCache','some','9893543JiyFzH','search','briefingJob','NIGHT','Sonne:\x20','sendNotification','Guest\x20Mode','analysisHistory','system.adapter.ical.é¦™','now','triggerEnergyPrediction','mkdirSync','getHistoryData','./lib/ai_agent','âš \x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','Warte\x20auf\x20Analyse...','name','add','analysis.health.activityTrend','roomIntegratorTimer','config','analysis.security.learningStatus','application/json','main','\x20events\x20from\x20standard\x20storage.','replace','stopService','comfort','json','Verbindung\x20erfolgreich:\x20','16IDbZBM','Say\x20Hello','cogni-living','energy','infrasoundEnabled','isRelevantActivity','toString','createAllObjects','checkLicense','door','dependencyInstallInProgress','system','ready','2881881biiekH',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','healthTrendInterval','cogni-living\x20adapter\x20starting\x20(v','{\x22history\x22:{}}','system.adapter.ical.','debug','processSensorEvent','length','loadSystemMode','No\x20data','events.history','LTM.trainingData.sequences','lastTrackerEventTime','command','protectAiMemory','inactivityThresholdHours','geminiApiKey','TRAIN_COMFORT','analysis.automation.description','onReady','sendMorningBriefing','min','pop','analysis.security.lastScore','SYSTEM_MODES','constructor','slice','analysis.training.status','LTM.baselineStatus','keys','analysis.training.triggerSecurity','security','health','./lib/python_bridge','bootTime','telegram','updateHealthVector','Aktiv\x20(','analysis.energy.warmupSources','systemConfig','analysis.visualization.pulse','Party\x20Mode','manual','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','eventHistory','haustÃ¼r','checkSolarCondition','path','updateTopology','[Integrator]\x20Error:\x20',',\x20Temp:\x20','Room\x20History\x20(24h\x20Buckets)','activeModules','error','analysis.energy.warmupTimes','startService','ack','analysis.automation.targetValue','getForeignStateAsync','analysis.training.triggerTopology','NORMAL','moduleComfort','warn','getDate','isGracePeriodActive','initHistory','licenseKey','devices','LTM.rawEventLog','Gemini\x20Report\x20Night','onMessage','runPythonHealthCheck','.data.table','motion','stringify','Unknown','refreshCalendar\x20failed:\x20','substring','minDaysForBaseline','instance','21045wVzDkY','bind','text','\x20events\x20from\x20today...','TRAIN_SECURITY','analyzeWindowOpening','common','generateContent','setHours','temperature','pulse','log','includes','\x22history\x22:{}','replayTodayEvents','getAbsoluteDefaultDataDir','testContext','LTM.dailyDigests','namespace','currentSystemMode','generateHealthReport','./lib/scanner','object','TRAIN_TOPOLOGY','analysis.activity.roomHistory','analysis.energy.warmupTargets','split','LTM.triggerDailyDigest','value','exitGraceTimer','handleInfrasound','push','bin','integrateRoomTime','open','moduleSecurity','.system.mode','initSystemConfig','getForeignObjectsAsync','isSolar','utf8','type','weatherTempId','getObjectViewAsync','onUnload','analysis.training.triggerHealth','triggerGaitAnalysis','message','analysis.activity.roomStats','Live\x20Event\x20Pulse','calendarName','subscribeForeignStates','enum.functions.*','sendTo','setPresence','location','Kein\x20API\x20Key\x20Ã¼bergeben.','analysis.automation.patternDetected','cancel','apiKey','max','analysis.trigger','callback','analysis.prediction.trackerTopRoom','70BsXWYU','calendarCheckTimer','Scan\x20Error:\x20','updateLocation','checkWifiPresence','triggerBriefing','reduce','guest','Sec-Training\x20started...','thermostat','infrasoundSensorId','getEnums','scanThermostats','analysis.automation.targetId','exitTimer','forEach','scanDevices','âœ…\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','checkCalendarTriggers','getOverviewData','4084530TMsinw','setObjectNotExistsAsync','./lib/recorder','.json','25qQfazJ','onStateChange','updateSchedulePreview','Standard','analysis.health.geminiDay','val','./lib/dead_man','string','existsSync','from','communicate.request','analysis.health.todayRoomDetails'];a0_0x50f0=function(){return _0x3d7e47;};return a0_0x50f0();}class CogniLiving extends utils['Adapter']{constructor(_0x3a6cc2){const _0x526dbe=a0_0x559667;super({..._0x3a6cc2,'name':'cogni-living'}),this[_0x526dbe(0x203)]=[],this[_0x526dbe(0x2ee)]=[],this['rawEventLog']=[],this[_0x526dbe(0x2db)]=[],this['sensorLastValues']={},this[_0x526dbe(0x1fe)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x526dbe(0x296)]=!![],this[_0x526dbe(0x275)]=null,this[_0x526dbe(0x244)]=null,this[_0x526dbe(0x217)]=![],this[_0x526dbe(0x2c6)]=null,this['geminiModel']=null,this['currentSystemMode']=setup[_0x526dbe(0x1ef)][_0x526dbe(0x213)],this[_0x526dbe(0x2a6)]=![],this['lastAlertState']=![],this[_0x526dbe(0x2af)]=null,this['calendarCheckTimer']=null,this['ltmJob']=null,this['modeResetJob']=null,this[_0x526dbe(0x2d3)]=null,this[_0x526dbe(0x2e9)]=null,this[_0x526dbe(0x2c5)]=null,this[_0x526dbe(0x2b1)]=null,this[_0x526dbe(0x314)]=null,this[_0x526dbe(0x2fa)]=null,this[_0x526dbe(0x30f)]=![],this[_0x526dbe(0x1e3)]=Date[_0x526dbe(0x2f0)](),this[_0x526dbe(0x2e5)]=null,this[_0x526dbe(0x1f9)]=Date[_0x526dbe(0x2f0)](),this[_0x526dbe(0x291)]=![],this['pressureBuffer']=[],this['activeModules']={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x526dbe(0x311),this[_0x526dbe(0x1ea)][_0x526dbe(0x228)](this)),this['on']('stateChange',this[_0x526dbe(0x280)][_0x526dbe(0x228)](this)),this['on'](_0x526dbe(0x2e0),this['onUnload'][_0x526dbe(0x228)](this)),this['on'](_0x526dbe(0x256),this['onMessage'][_0x526dbe(0x228)](this));}async[a0_0x559667(0x1ea)](){const _0x6863ac=a0_0x559667;this[_0x6863ac(0x232)][_0x6863ac(0x29d)](_0x6863ac(0x315)+this['version']+_0x6863ac(0x313));if(this[_0x6863ac(0x2fb)][_0x6863ac(0x2cb)]!==undefined)this['activeModules']['health']=this[_0x6863ac(0x2fb)][_0x6863ac(0x2cb)];if(this['config']['moduleSecurity']!==undefined)this[_0x6863ac(0x20b)][_0x6863ac(0x1f6)]=this[_0x6863ac(0x2fb)][_0x6863ac(0x24a)];if(this[_0x6863ac(0x2fb)]['moduleEnergy']!==undefined)this[_0x6863ac(0x20b)][_0x6863ac(0x308)]=this['config'][_0x6863ac(0x2e3)];if(this[_0x6863ac(0x2fb)][_0x6863ac(0x214)]!==undefined)this[_0x6863ac(0x20b)][_0x6863ac(0x302)]=this[_0x6863ac(0x2fb)][_0x6863ac(0x214)];if(this[_0x6863ac(0x2fb)][_0x6863ac(0x293)])this[_0x6863ac(0x20b)]={...this[_0x6863ac(0x20b)],...this[_0x6863ac(0x2fb)]['modules']};this[_0x6863ac(0x2d4)]();}async[a0_0x559667(0x2d4)](){const _0x3e9069=a0_0x559667;await setup['initZombies'](this);try{this['isProVersion']=await setup[_0x3e9069(0x30d)](this[_0x3e9069(0x2fb)][_0x3e9069(0x219)]);}catch(_0x2f7f4d){}if(!this[_0x3e9069(0x2fb)][_0x3e9069(0x1e6)]||this[_0x3e9069(0x2fb)][_0x3e9069(0x1e6)]<0.1)this[_0x3e9069(0x2fb)]['inactivityThresholdHours']=0xc;await setup[_0x3e9069(0x218)](this),await setup[_0x3e9069(0x24c)](this);try{const _0x47f300=await this[_0x3e9069(0x295)]('analysis.energy.warmupTimes'),_0x5a168b=await this[_0x3e9069(0x295)]('analysis.energy.warmupSources');_0x47f300&&_0x47f300['val']&&_0x5a168b&&_0x5a168b[_0x3e9069(0x284)]&&(Date['now']()-_0x47f300['ts']<0x4*0xe10*0x3e8&&(this[_0x3e9069(0x2e5)]={'times':JSON[_0x3e9069(0x294)](_0x47f300[_0x3e9069(0x284)]),'sources':JSON[_0x3e9069(0x294)](_0x5a168b[_0x3e9069(0x284)])}));}catch(_0x497f64){}if(this['config'][_0x3e9069(0x1e7)])try{this['genAI']=new GoogleGenerativeAI(this['config']['geminiApiKey']),this[_0x3e9069(0x2de)]=this[_0x3e9069(0x2c6)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x3e9069(0x2fd)}});}catch(_0x4dfe96){this[_0x3e9069(0x232)][_0x3e9069(0x20c)](_0x3e9069(0x2a4)+_0x4dfe96['message']);}await setup[_0x3e9069(0x30c)](this),await this[_0x3e9069(0x31b)](),schedulers['initSchedules'](this),await this[_0x3e9069(0x27c)](_0x3e9069(0x1ff),{'type':_0x3e9069(0x2dd),'common':{'name':_0x3e9069(0x258),'type':'number','role':'value','read':!![],'write':![]},'native':{}}),await this[_0x3e9069(0x27c)](_0x3e9069(0x257),{'type':'state','common':{'name':'Room\x20Dwell\x20Time\x20Stats','type':'string','role':'json','read':!![],'write':![],'def':_0x3e9069(0x202)},'native':{}}),await this[_0x3e9069(0x27c)](_0x3e9069(0x23f),{'type':_0x3e9069(0x2dd),'common':{'name':_0x3e9069(0x20a),'type':_0x3e9069(0x286),'role':'json','read':!![],'write':![],'def':_0x3e9069(0x316)},'native':{}}),await this[_0x3e9069(0x27c)](_0x3e9069(0x28e),{'type':'state','common':{'name':_0x3e9069(0x21c),'type':_0x3e9069(0x286),'role':'text','read':!![],'write':![],'def':_0x3e9069(0x2f6)},'native':{}}),await this[_0x3e9069(0x27c)](_0x3e9069(0x283),{'type':_0x3e9069(0x2dd),'common':{'name':_0x3e9069(0x2d0),'type':_0x3e9069(0x286),'role':'text','read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this['setObjectNotExistsAsync'](_0x3e9069(0x2d9),{'type':_0x3e9069(0x2dd),'common':{'name':_0x3e9069(0x29e),'type':_0x3e9069(0x286),'role':_0x3e9069(0x303),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x3e9069(0x27c)](_0x3e9069(0x28a),{'type':_0x3e9069(0x2dd),'common':{'name':'Daily\x20Room\x20Details\x20(48x30min)','type':_0x3e9069(0x286),'role':_0x3e9069(0x303),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x3e9069(0x27c)](_0x3e9069(0x2f9),{'type':_0x3e9069(0x2dd),'common':{'name':'General\x20Activity\x20Trend','type':'number','role':_0x3e9069(0x243),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x3e9069(0x27c)](_0x3e9069(0x20d),{'type':_0x3e9069(0x2dd),'common':{'name':'Warm-Up\x20Time','type':_0x3e9069(0x286),'role':'json','read':!![],'write':![]},'native':{}});try{const _0x5ee929=await this['getStateAsync'](_0x3e9069(0x1e1));if(_0x5ee929&&_0x5ee929['val']){this['eventHistory']=JSON[_0x3e9069(0x294)](_0x5ee929[_0x3e9069(0x284)]);if(this[_0x3e9069(0x2a6)]){const _0x102112=await this['getStateAsync'](_0x3e9069(0x21b));if(_0x102112&&_0x102112[_0x3e9069(0x284)])this['rawEventLog']=JSON['parse'](_0x102112['val']);}this[_0x3e9069(0x232)][_0x3e9069(0x29d)](_0x3e9069(0x2d1)+this[_0x3e9069(0x203)]['length']+_0x3e9069(0x2ff));}}catch(_0x29cf9f){this[_0x3e9069(0x203)]=[];}try{const _0x499bb3=await this['getStateAsync'](_0x3e9069(0x238));if(_0x499bb3&&_0x499bb3[_0x3e9069(0x284)])this[_0x3e9069(0x2db)]=JSON['parse'](_0x499bb3[_0x3e9069(0x284)]);}catch(_0x2320ed){this[_0x3e9069(0x2db)]=[];}const _0x32b94b=this['dailyDigests']['length']>=(this['config'][_0x3e9069(0x225)]||0x7)?_0x3e9069(0x1fc)+this[_0x3e9069(0x2db)]['length']+'\x20Tage)':'Lernphase\x20('+this[_0x3e9069(0x2db)][_0x3e9069(0x31a)]+'/'+(this[_0x3e9069(0x2fb)][_0x3e9069(0x225)]||0x7)+')';await this[_0x3e9069(0x2bb)](_0x3e9069(0x1f3),{'val':_0x32b94b,'ack':!![]}),this[_0x3e9069(0x2b6)](_0x3e9069(0x264)),this[_0x3e9069(0x2b6)](_0x3e9069(0x242)),this[_0x3e9069(0x2b6)]('analysis.training.triggerHealth');this['config'][_0x3e9069(0x309)]&&this[_0x3e9069(0x2fb)]['infrasoundSensorId']&&this[_0x3e9069(0x20b)][_0x3e9069(0x1f6)]&&this[_0x3e9069(0x25a)](this[_0x3e9069(0x2fb)][_0x3e9069(0x271)]);const _0x2868c7=this[_0x3e9069(0x2fb)][_0x3e9069(0x21a)];if(_0x2868c7)for(const _0x194656 of _0x2868c7){await this[_0x3e9069(0x2c1)](_0x194656['id']);}const _0x1cbddb=this[_0x3e9069(0x2fb)][_0x3e9069(0x2b2)];if(_0x1cbddb)for(const _0x1acb3e of _0x1cbddb){await this['subscribeForeignStatesAsync'](_0x1acb3e);}const _0x2839ff=require(_0x3e9069(0x2d6));if(this['historyJob'])this['historyJob'][_0x3e9069(0x261)]();this[_0x3e9069(0x2c5)]=_0x2839ff[_0x3e9069(0x28c)]('59\x2023\x20*\x20*\x20*',()=>{this['saveDailyHistory']();}),setTimeout(()=>this[_0x3e9069(0x235)](),0x1388);if(this[_0x3e9069(0x2fa)])clearInterval(this[_0x3e9069(0x2fa)]);this['integrateRoomTime'](),this[_0x3e9069(0x2fa)]=setInterval(async()=>{const _0xe0384c=_0x3e9069;await this[_0xe0384c(0x248)]();},0x3c*0x3e8);if(this[_0x3e9069(0x314)])clearInterval(this[_0x3e9069(0x314)]);this['healthTrendInterval']=setInterval(()=>{const _0x592fa6=_0x3e9069;this[_0x592fa6(0x2a6)]&&this[_0x592fa6(0x20b)][_0x592fa6(0x1f7)]&&this[_0x592fa6(0x21e)]();},0x4*0x3c*0x3c*0x3e8);if(this['analysisTimer'])clearInterval(this['analysisTimer']);this[_0x3e9069(0x20b)]['energy']&&(this[_0x3e9069(0x2af)]=setInterval(()=>{const _0x29c955=_0x3e9069;this[_0x29c955(0x2f1)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x3e9069(0x2f1)](),0x2710));if(this[_0x3e9069(0x268)])clearInterval(this[_0x3e9069(0x268)]);this['config']['useCalendar']&&this['activeModules'][_0x3e9069(0x308)]&&(this[_0x3e9069(0x268)]=setInterval(()=>{const _0x16e1df=_0x3e9069;automation[_0x16e1df(0x279)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x3e9069(0x279)](this),0x3a98));const _0x3eb7c4=path[_0x3e9069(0x2ab)](__dirname,_0x3e9069(0x2c9),_0x3e9069(0x247),_0x3e9069(0x2dc));pythonBridge[_0x3e9069(0x20e)](this,_0x3eb7c4);}[a0_0x559667(0x253)](_0x1fcb73){const _0x4725ae=a0_0x559667;if(this[_0x4725ae(0x2c5)])this[_0x4725ae(0x2c5)]['cancel']();this[_0x4725ae(0x2b5)]()['then'](()=>{const _0x363c6d=_0x4725ae;if(this[_0x363c6d(0x2af)])clearInterval(this['analysisTimer']);if(this['calendarCheckTimer'])clearInterval(this[_0x363c6d(0x268)]);if(this[_0x363c6d(0x2fa)])clearInterval(this[_0x363c6d(0x2fa)]);recorder[_0x363c6d(0x29f)](this),pythonBridge[_0x363c6d(0x301)](this),_0x1fcb73();});}async[a0_0x559667(0x235)](){const _0x3ddece=a0_0x559667;if(!this['eventHistory']||this['eventHistory'][_0x3ddece(0x31a)]===0x0){this[_0x3ddece(0x232)][_0x3ddece(0x215)](_0x3ddece(0x2f5));return;}this[_0x3ddece(0x232)][_0x3ddece(0x29d)](_0x3ddece(0x2e4)+this['eventHistory'][_0x3ddece(0x31a)]+_0x3ddece(0x22a));const _0x4ba7f5=new Date()['setHours'](0x0,0x0,0x0,0x0),_0x22a63f=_0x3ddece(0x23f);let _0x48cbcb={'history':{},'date':new Date()[_0x3ddece(0x2b8)]()};const _0x2d4ffe=_0x3ddece(0x2d9),_0x102121=_0x3ddece(0x28a);let _0x5ade68=new Array(0x30)[_0x3ddece(0x2a3)](0x0),_0x3be83c=Array[_0x3ddece(0x288)]({'length':0x30},()=>[]);this[_0x3ddece(0x203)]['forEach'](_0x5ba620=>{const _0x2e8310=_0x3ddece;if(_0x5ba620[_0x2e8310(0x292)]>=_0x4ba7f5){if(recorder[_0x2e8310(0x30a)](_0x5ba620[_0x2e8310(0x250)],_0x5ba620[_0x2e8310(0x243)])){const _0x2cb17d=new Date(_0x5ba620[_0x2e8310(0x292)]),_0x2861a6=_0x2cb17d[_0x2e8310(0x29c)]()*0x2+(_0x2cb17d[_0x2e8310(0x2df)]()>=0x1e?0x1:0x0);if(_0x2861a6<0x30){_0x5ade68[_0x2861a6]++;const _0x5e8b4f=_0x5ba620[_0x2e8310(0x25e)]||_0x5ba620['name']||'?';let _0x3d085f=_0x3be83c[_0x2861a6];!_0x3d085f[_0x2e8310(0x233)](_0x5e8b4f)&&_0x3d085f[_0x2e8310(0x246)](_0x5e8b4f);}const _0x3eeaf0=_0x2cb17d['getHours']();let _0x4642a6=_0x5ba620['location']||_0x2e8310(0x222);const _0x3bac04=(this[_0x2e8310(0x2fb)][_0x2e8310(0x21a)]||[])['find'](_0x576ade=>_0x576ade[_0x2e8310(0x25e)]===_0x4642a6);if(_0x3bac04)_0x4642a6=_0x3bac04[_0x2e8310(0x25e)];if(!_0x48cbcb[_0x2e8310(0x2ce)][_0x4642a6])_0x48cbcb[_0x2e8310(0x2ce)][_0x4642a6]=new Array(0x18)[_0x2e8310(0x2a3)](0x0);if(_0x48cbcb[_0x2e8310(0x2ce)][_0x4642a6][_0x3eeaf0]<0x3c)_0x48cbcb['history'][_0x4642a6][_0x3eeaf0]++;}}});const _0x15b127=await this[_0x3ddece(0x295)](_0x22a63f);(!_0x15b127||!_0x15b127[_0x3ddece(0x284)]||_0x15b127['val']==='{}'||_0x15b127[_0x3ddece(0x284)][_0x3ddece(0x233)](_0x3ddece(0x234)))&&await this[_0x3ddece(0x2bb)](_0x22a63f,{'val':JSON[_0x3ddece(0x221)](_0x48cbcb),'ack':!![]}),await this['setStateAsync'](_0x2d4ffe,{'val':JSON[_0x3ddece(0x221)](_0x5ade68),'ack':!![]}),await this[_0x3ddece(0x2bb)](_0x102121,{'val':JSON['stringify'](_0x3be83c),'ack':!![]}),this[_0x3ddece(0x232)][_0x3ddece(0x29d)](_0x3ddece(0x278));}async[a0_0x559667(0x2b5)](){const _0x3dcc40=a0_0x559667;if(!this[_0x3dcc40(0x20b)][_0x3dcc40(0x1f7)])return;const _0x41bc42=new Date()['toISOString']()['split']('T')[0x0];this['log'][_0x3dcc40(0x318)](_0x3dcc40(0x28b)+_0x41bc42+_0x3dcc40(0x2a1));try{const [_0x361024,_0x27f0b7,_0x207b46,_0x4e2586,_0x3bbb96,_0x482c83]=await Promise['all']([this[_0x3dcc40(0x295)](_0x3dcc40(0x23f)),this[_0x3dcc40(0x295)](_0x3dcc40(0x28e)),this['getStateAsync']('analysis.health.geminiDay'),this['getStateAsync'](_0x3dcc40(0x1ee)),this[_0x3dcc40(0x295)](_0x3dcc40(0x2d9)),this[_0x3dcc40(0x295)](_0x3dcc40(0x2f9))]),_0x34df3c=this[_0x3dcc40(0x203)]['filter'](_0x415153=>_0x415153[_0x3dcc40(0x292)]>=new Date()[_0x3dcc40(0x22f)](0x0,0x0,0x0,0x0)&&(_0x415153[_0x3dcc40(0x2f7)]['toLowerCase']()[_0x3dcc40(0x233)](_0x3dcc40(0x204))||_0x415153['name'][_0x3dcc40(0x2b7)]()[_0x3dcc40(0x233)]('terrasse'))&&(_0x415153['value']===!![]||_0x415153['value']==='open'))[_0x3dcc40(0x31a)];let _0x949dc3=0x55;if(_0x482c83&&_0x482c83['val']!==undefined)_0x949dc3=Math[_0x3dcc40(0x1ec)](0x64,Math[_0x3dcc40(0x263)](0x14,Math[_0x3dcc40(0x2be)](0x50+Number(_0x482c83[_0x3dcc40(0x284)])*0x5)));const _0x145362={'date':_0x41bc42,'timestamp':Date[_0x3dcc40(0x2f0)](),'roomHistory':_0x361024?.[_0x3dcc40(0x284)]?JSON[_0x3dcc40(0x294)](_0x361024[_0x3dcc40(0x284)]):{},'geminiNight':_0x27f0b7?.[_0x3dcc40(0x284)]||_0x3dcc40(0x2b4),'geminiDay':_0x207b46?.[_0x3dcc40(0x284)]||_0x3dcc40(0x2b4),'anomalyScore':_0x4e2586?.['val']||0.1,'todayVector':_0x3bbb96?.[_0x3dcc40(0x284)]?JSON[_0x3dcc40(0x294)](_0x3bbb96[_0x3dcc40(0x284)]):new Array(0x30)[_0x3dcc40(0x2a3)](0x0),'batteryLevel':_0x949dc3,'freshAirCount':_0x34df3c,'eventHistory':this[_0x3dcc40(0x203)]},_0x45d4b1=utils[_0x3dcc40(0x236)](),_0x3de1de=path[_0x3dcc40(0x2ab)](_0x45d4b1,'cogni-living','history');if(!fs['existsSync'](_0x3de1de))fs[_0x3dcc40(0x2f2)](_0x3de1de,{'recursive':!![]});const _0xb01186=path['join'](_0x3de1de,_0x41bc42+_0x3dcc40(0x27e));fs[_0x3dcc40(0x298)](_0xb01186,JSON['stringify'](_0x145362)),this[_0x3dcc40(0x232)][_0x3dcc40(0x29d)](_0x3dcc40(0x2ba)+_0xb01186);}catch(_0x5825ed){this[_0x3dcc40(0x232)][_0x3dcc40(0x20c)](_0x3dcc40(0x2cf)+_0x5825ed[_0x3dcc40(0x256)]);}}async[a0_0x559667(0x248)](){const _0x326b51=a0_0x559667;if(!this[_0x326b51(0x296)])return;try{let _0x2e9ff5=null;try{const _0x27c546=await this[_0x326b51(0x295)](_0x326b51(0x266)),_0x1b0aa3=await this['getStateAsync']('analysis.prediction.trackerConfidence');if(_0x27c546&&_0x27c546[_0x326b51(0x284)]&&_0x1b0aa3&&_0x1b0aa3[_0x326b51(0x284)]&&_0x1b0aa3[_0x326b51(0x284)]>0.3){if(_0x27c546[_0x326b51(0x284)]!=='Unknown'&&_0x27c546[_0x326b51(0x284)]!=='Init...')_0x2e9ff5=_0x27c546[_0x326b51(0x284)];}}catch(_0x1db73e){}if(!_0x2e9ff5){const _0x425520=this[_0x326b51(0x2fb)][_0x326b51(0x21a)]||[];for(const _0x464c24 of _0x425520){if(_0x464c24[_0x326b51(0x250)]==='motion'&&_0x464c24[_0x326b51(0x25e)])try{const _0xfeffde=await this[_0x326b51(0x211)](_0x464c24['id']);if(_0xfeffde&&(_0xfeffde[_0x326b51(0x284)]===!![]||_0xfeffde[_0x326b51(0x284)]==='on'||_0xfeffde[_0x326b51(0x284)]===0x1)){_0x2e9ff5=_0x464c24[_0x326b51(0x25e)];break;}}catch(_0x1e7e29){}}}if(!_0x2e9ff5)return;const _0x5eb897=this[_0x326b51(0x2fb)]['devices']||[];let _0x3586c6=_0x2e9ff5;const _0x5bfb2c=_0x5eb897[_0x326b51(0x2ae)](_0x244303=>_0x244303[_0x326b51(0x25e)]&&_0x244303['location'][_0x326b51(0x2b7)]()===_0x2e9ff5['toLowerCase']());if(_0x5bfb2c)_0x3586c6=_0x5bfb2c[_0x326b51(0x25e)];const _0x1316e8=_0x326b51(0x23f),_0x55cddf=await this['getStateAsync'](_0x1316e8),_0x7c9a3f=new Date()[_0x326b51(0x2b8)]();let _0x2fa481={'history':{},'date':_0x7c9a3f};if(_0x55cddf&&_0x55cddf[_0x326b51(0x284)])try{_0x2fa481=JSON['parse'](_0x55cddf['val']);}catch(_0x356fef){}_0x2fa481[_0x326b51(0x2c0)]!==_0x7c9a3f&&(_0x2fa481[_0x326b51(0x2ce)]={},_0x2fa481[_0x326b51(0x2c0)]=_0x7c9a3f);if(!_0x2fa481['history'][_0x3586c6])_0x2fa481[_0x326b51(0x2ce)][_0x3586c6]=new Array(0x18)['fill'](0x0);const _0x35f8bb=new Date()[_0x326b51(0x29c)]();if(_0x2fa481[_0x326b51(0x2ce)][_0x3586c6][_0x35f8bb]<0x3c)_0x2fa481[_0x326b51(0x2ce)][_0x3586c6][_0x35f8bb]++;await this['setStateAsync'](_0x1316e8,{'val':JSON['stringify'](_0x2fa481),'ack':!![]});}catch(_0x150861){this[_0x326b51(0x232)][_0x326b51(0x215)](_0x326b51(0x208)+_0x150861['message']);}}async[a0_0x559667(0x21d)](_0x484e4d){const _0x8778d1=a0_0x559667;if(typeof _0x484e4d==='object'&&_0x484e4d[_0x8778d1(0x256)]){if(_0x484e4d[_0x8778d1(0x1e4)]===_0x8778d1(0x2f3)){const _0x4911d4=_0x484e4d[_0x8778d1(0x256)]['date'],_0x4bc3a2=utils[_0x8778d1(0x236)](),_0x333e0d=path[_0x8778d1(0x2ab)](_0x4bc3a2,_0x8778d1(0x307),_0x8778d1(0x2ce),_0x4911d4+'.json');if(fs[_0x8778d1(0x287)](_0x333e0d))try{const _0x344daf=JSON['parse'](fs[_0x8778d1(0x297)](_0x333e0d,_0x8778d1(0x24f)));this[_0x8778d1(0x25c)](_0x484e4d['from'],_0x484e4d[_0x8778d1(0x1e4)],{'success':!![],'data':_0x344daf},_0x484e4d[_0x8778d1(0x265)]);}catch(_0x4eecad){this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d['command'],{'success':![],'error':'Corrupt'},_0x484e4d[_0x8778d1(0x265)]);}else this['sendTo'](_0x484e4d[_0x8778d1(0x288)],_0x484e4d[_0x8778d1(0x1e4)],{'success':![],'error':_0x8778d1(0x1e0)},_0x484e4d[_0x8778d1(0x265)]);}else{if(_0x484e4d['command']===_0x8778d1(0x27a)){const _0x4ea1fd=this[_0x8778d1(0x2db)][_0x8778d1(0x31a)];let _0x1c0ba3=new Array(0x30)[_0x8778d1(0x2a3)](0x0),_0x336131=Array[_0x8778d1(0x288)]({'length':0x30},()=>[]);try{const _0x6a5cbc=await this[_0x8778d1(0x295)]('analysis.health.todayVector');if(_0x6a5cbc&&_0x6a5cbc[_0x8778d1(0x284)])_0x1c0ba3=JSON[_0x8778d1(0x294)](_0x6a5cbc[_0x8778d1(0x284)]);const _0x5686ad=await this[_0x8778d1(0x295)](_0x8778d1(0x28a));if(_0x5686ad&&_0x5686ad[_0x8778d1(0x284)])_0x336131=JSON[_0x8778d1(0x294)](_0x5686ad[_0x8778d1(0x284)]);}catch(_0x122233){}let _0x46f371=new Array(0x30)[_0x8778d1(0x2a3)](0x0);try{const _0x11b2b7=new Date();_0x11b2b7['setDate'](_0x11b2b7[_0x8778d1(0x216)]()-0x1);const _0x1b07e4=_0x11b2b7[_0x8778d1(0x2c8)]()[_0x8778d1(0x241)]('T')[0x0],_0x3d577f=utils[_0x8778d1(0x236)](),_0x357d9b=path[_0x8778d1(0x2ab)](_0x3d577f,'cogni-living',_0x8778d1(0x2ce),_0x1b07e4+_0x8778d1(0x27e));if(fs[_0x8778d1(0x287)](_0x357d9b)){const _0x29c6c8=JSON[_0x8778d1(0x294)](fs['readFileSync'](_0x357d9b,'utf8'));if(_0x29c6c8&&_0x29c6c8['todayVector'])_0x46f371=_0x29c6c8['todayVector'];}}catch(_0xa1096a){}let _0x34dee1={'today':{},'yesterday':{}};try{const _0x2ae158=await this[_0x8778d1(0x295)](_0x8778d1(0x257));if(_0x2ae158&&_0x2ae158['val'])_0x34dee1=JSON['parse'](_0x2ae158[_0x8778d1(0x284)]);}catch(_0x19dfd9){}let _0x6c05f9=null;try{const _0x51454f=await this[_0x8778d1(0x295)]('analysis.health.activityTrend');if(_0x51454f)_0x6c05f9=_0x51454f[_0x8778d1(0x284)];}catch(_0x2d8166){}if(_0x6c05f9===undefined||_0x6c05f9===null){const _0x181fa3=_0x1c0ba3[_0x8778d1(0x26d)]((_0x27587d,_0x15d8f6)=>_0x27587d+_0x15d8f6,0x0),_0x4c1106=Math['min'](0x2,Math[_0x8778d1(0x263)](-0x2,(0x64-_0x181fa3)/0x32));_0x6c05f9=_0x4c1106;}let _0x37f235=![],_0x53aa1f='',_0x3e2e71='',_0x38420c='';try{const _0x5434ed=await this[_0x8778d1(0x295)](_0x8778d1(0x260));if(_0x5434ed&&_0x5434ed[_0x8778d1(0x284)]){_0x37f235=!![];const _0x192d76=await this[_0x8778d1(0x295)](_0x8778d1(0x1e9));_0x53aa1f=_0x192d76?_0x192d76[_0x8778d1(0x284)]:'';const _0x54383f=await this[_0x8778d1(0x295)](_0x8778d1(0x274));_0x3e2e71=_0x54383f?_0x54383f[_0x8778d1(0x284)]:'';const _0x328379=await this[_0x8778d1(0x295)](_0x8778d1(0x210));_0x38420c=_0x328379?_0x328379['val']:'';}}catch(_0xf7ce49){}const _0x5a06ed=await this[_0x8778d1(0x205)](),_0x332fff=(this['config'][_0x8778d1(0x21a)]||[])[_0x8778d1(0x2e6)](_0x550c18=>_0x550c18['isSolar']),_0x693506=_0x5a06ed&&_0x332fff;let _0xa7ca2f='';try{const _0x3c6c6b=await this[_0x8778d1(0x295)]('system.presenceWho');if(_0x3c6c6b&&_0x3c6c6b['val'])_0xa7ca2f=_0x3c6c6b[_0x8778d1(0x284)];}catch(_0x287816){}this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d['command'],{'success':!![],'eventHistory':this[_0x8778d1(0x203)][_0x8778d1(0x1f1)](0x0,0x7d0),'stats':{'digestCount':_0x4ea1fd,'isPresent':this[_0x8778d1(0x296)],'hourlyActivity':_0x1c0ba3,'hourlyDetails':_0x336131,'yesterdayActivity':_0x46f371,'solarActive':_0x693506,'presenceWho':_0xa7ca2f,'roomStats':_0x34dee1,'activityTrend':_0x6c05f9,'modules':this['activeModules']},'automation':{'detected':_0x37f235,'description':_0x53aa1f,'targetId':_0x3e2e71,'targetValue':_0x38420c}},_0x484e4d[_0x8778d1(0x265)]);}else{if(_0x484e4d[_0x8778d1(0x1e4)]==='checkThermostats')try{const _0x5897b4=await automation[_0x8778d1(0x273)](this);this['sendTo'](_0x484e4d[_0x8778d1(0x288)],_0x484e4d[_0x8778d1(0x1e4)],{'success':!![],'results':_0x5897b4},_0x484e4d['callback']);}catch(_0x2ec884){this[_0x8778d1(0x25c)](_0x484e4d['from'],_0x484e4d[_0x8778d1(0x1e4)],{'success':![],'error':_0x2ec884[_0x8778d1(0x256)]},_0x484e4d[_0x8778d1(0x265)]);}else{if(_0x484e4d[_0x8778d1(0x1e4)]===_0x8778d1(0x277))try{const _0x549160=await scanner[_0x8778d1(0x2e1)](this,_0x484e4d[_0x8778d1(0x256)]||{});this[_0x8778d1(0x25c)](_0x484e4d['from'],_0x484e4d[_0x8778d1(0x1e4)],{'success':!![],'devices':_0x549160},_0x484e4d[_0x8778d1(0x265)]);}catch(_0x3c7e0b){}else{if(_0x484e4d[_0x8778d1(0x1e4)]===_0x8778d1(0x272)){const _0x4890ec=await this['getForeignObjectsAsync'](_0x8778d1(0x25b),_0x8778d1(0x2ad)),_0x322055=[];if(_0x4890ec)for(const _0x318c33 in _0x4890ec){let _0x30049e=_0x4890ec[_0x318c33]['common']['name'];if(_0x30049e&&typeof _0x30049e===_0x8778d1(0x23d))_0x30049e=_0x30049e['de']||_0x30049e['en']||Object['values'](_0x30049e)[0x0]||JSON[_0x8778d1(0x221)](_0x30049e);_0x322055['push']({'id':_0x318c33,'name':String(_0x30049e||_0x318c33)});}const _0x12f0f4=await this[_0x8778d1(0x24d)](_0x8778d1(0x2a5),_0x8778d1(0x2ad)),_0x2480a7=[];if(_0x12f0f4)for(const _0x21d745 in _0x12f0f4){let _0x5e7cb6=_0x12f0f4[_0x21d745][_0x8778d1(0x22d)][_0x8778d1(0x2f7)];if(_0x5e7cb6&&typeof _0x5e7cb6===_0x8778d1(0x23d))_0x5e7cb6=_0x5e7cb6['de']||_0x5e7cb6['en']||Object[_0x8778d1(0x2ac)](_0x5e7cb6)[0x0]||JSON['stringify'](_0x5e7cb6);_0x2480a7[_0x8778d1(0x246)](String(_0x5e7cb6||_0x21d745[_0x8778d1(0x241)]('.')[_0x8778d1(0x1ed)]()));}this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d[_0x8778d1(0x1e4)],{'success':!![],'enums':_0x322055,'rooms':_0x2480a7},_0x484e4d[_0x8778d1(0x265)]);}else{if(_0x484e4d['command']===_0x8778d1(0x2a2))try{const _0x5e0760=await this[_0x8778d1(0x252)](_0x8778d1(0x310),_0x8778d1(0x226),{'startkey':_0x8778d1(0x317),'endkey':'system.adapter.ical.é¦™'}),_0x3662cf=new Set();if(_0x5e0760&&_0x5e0760[_0x8778d1(0x29a)])for(const _0x4f0d8b of _0x5e0760[_0x8778d1(0x29a)]){const _0x2f6c9d=_0x4f0d8b['id'][_0x8778d1(0x300)](_0x8778d1(0x2aa),''),_0x5102d7=await this[_0x8778d1(0x211)](_0x2f6c9d+_0x8778d1(0x21f));let _0x571fd3=![];if(_0x5102d7&&_0x5102d7[_0x8778d1(0x284)]){const _0x258749=typeof _0x5102d7[_0x8778d1(0x284)]===_0x8778d1(0x286)?JSON[_0x8778d1(0x294)](_0x5102d7['val']):_0x5102d7[_0x8778d1(0x284)];Array[_0x8778d1(0x2a9)](_0x258749)&&_0x258749[_0x8778d1(0x276)](_0xab3597=>{const _0x27b2e4=_0x8778d1;_0xab3597[_0x27b2e4(0x259)]&&(_0x3662cf[_0x27b2e4(0x2f8)](_0xab3597[_0x27b2e4(0x259)]),_0x571fd3=!![]);});}!_0x571fd3&&_0x3662cf[_0x8778d1(0x2f8)](_0x2f6c9d);}const _0x43035a=Array[_0x8778d1(0x288)](_0x3662cf);if(_0x43035a['length']===0x0)_0x43035a[_0x8778d1(0x246)](_0x8778d1(0x282));this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d['command'],{'success':!![],'names':_0x43035a},_0x484e4d[_0x8778d1(0x265)]);}catch(_0x4b42ea){this['sendTo'](_0x484e4d[_0x8778d1(0x288)],_0x484e4d[_0x8778d1(0x1e4)],{'success':![],'error':_0x8778d1(0x269)+_0x4b42ea[_0x8778d1(0x256)]},_0x484e4d[_0x8778d1(0x265)]);}else{if(_0x484e4d[_0x8778d1(0x1e4)]===_0x8778d1(0x2c7))try{await automation[_0x8778d1(0x281)](this),this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d['command'],{'success':!![]},_0x484e4d[_0x8778d1(0x265)]);}catch(_0x5e8c76){this['log'][_0x8778d1(0x215)](_0x8778d1(0x223)+_0x5e8c76['message']),this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d['command'],{'success':![],'error':_0x5e8c76[_0x8778d1(0x256)]},_0x484e4d[_0x8778d1(0x265)]);}else{if(_0x484e4d['command']===_0x8778d1(0x2a7))try{const _0x28f078=_0x484e4d[_0x8778d1(0x256)]?_0x484e4d[_0x8778d1(0x256)][_0x8778d1(0x262)]:'';if(!_0x28f078)throw new Error(_0x8778d1(0x25f));const _0x4f4aa5=new GoogleGenerativeAI(_0x28f078),_0x4e8d01=_0x4f4aa5['getGenerativeModel']({'model':GEMINI_MODEL}),_0x1d7c46=await _0x4e8d01[_0x8778d1(0x22e)](_0x8778d1(0x306)),_0x44ef3=await _0x1d7c46['response'],_0x15e160=_0x44ef3[_0x8778d1(0x229)]();this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d[_0x8778d1(0x1e4)],{'success':!![],'message':_0x8778d1(0x304)+_0x15e160[_0x8778d1(0x224)](0x0,0x14)+'...'},_0x484e4d[_0x8778d1(0x265)]);}catch(_0x2d3ff3){this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d[_0x8778d1(0x1e4)],{'success':![],'message':_0x2d3ff3[_0x8778d1(0x256)]},_0x484e4d['callback']);}else{if(_0x484e4d[_0x8778d1(0x1e4)]===_0x8778d1(0x237))try{const _0x3586e7=await this[_0x8778d1(0x205)](),_0x3bda2c=await this['getObjectViewAsync'](_0x8778d1(0x310),_0x8778d1(0x226),{'startkey':_0x8778d1(0x317),'endkey':_0x8778d1(0x2ef)}),_0x3a20c2=_0x3bda2c&&_0x3bda2c['rows']?_0x3bda2c[_0x8778d1(0x29a)][_0x8778d1(0x31a)]:0x0;this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d[_0x8778d1(0x1e4)],{'success':!![],'weather':_0x8778d1(0x2eb)+_0x3586e7+_0x8778d1(0x209)+(this['sensorLastValues'][this[_0x8778d1(0x2fb)][_0x8778d1(0x2d8)]]||'?')+'Â°C','calendar':_0x3a20c2+'\x20Kalender-Adapter\x20gefunden.'},_0x484e4d[_0x8778d1(0x265)]);}catch(_0x5e6084){this[_0x8778d1(0x25c)](_0x484e4d[_0x8778d1(0x288)],_0x484e4d[_0x8778d1(0x1e4)],{'success':![]},_0x484e4d[_0x8778d1(0x265)]);}}}}}}}}}}}['runPythonHealthCheck'](){const _0x312a50=a0_0x559667;if(!this[_0x312a50(0x20b)][_0x312a50(0x1f7)])return;this[_0x312a50(0x232)]['debug']('ðŸ\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...');try{const _0x3bd4c4=this['rawEventLog']||[];pythonBridge[_0x312a50(0x2cd)](this,'CALCULATE_HEALTH_TREND',{'events':_0x3bd4c4});}catch(_0xf7148f){this['log'][_0x312a50(0x215)]('Failed\x20to\x20trigger\x20Python\x20Health\x20Check');}}async[a0_0x559667(0x280)](_0x3b6464,_0x5645e1){const _0x5e46d4=a0_0x559667;if(!_0x5645e1||this[_0x5e46d4(0x30f)])return;if(_0x3b6464[_0x5e46d4(0x233)](_0x5e46d4(0x1fa))&&_0x3b6464['endsWith'](_0x5e46d4(0x289))&&_0x5645e1['val'])return;if(this[_0x5e46d4(0x2fb)][_0x5e46d4(0x309)]&&_0x3b6464===this[_0x5e46d4(0x2fb)][_0x5e46d4(0x271)]&&this['activeModules']['security']){this['handleInfrasound'](_0x5645e1[_0x5e46d4(0x284)]);return;}if(_0x5645e1['ack']&&_0x3b6464['endsWith'](_0x5e46d4(0x231)))return;if(_0x3b6464===this[_0x5e46d4(0x239)]+_0x5e46d4(0x24b)){if(_0x5645e1['val']&&Object[_0x5e46d4(0x2ac)](setup[_0x5e46d4(0x1ef)])[_0x5e46d4(0x233)](_0x5645e1[_0x5e46d4(0x284)])){this['currentSystemMode']=_0x5645e1[_0x5e46d4(0x284)];if(_0x5645e1['val']===setup[_0x5e46d4(0x1ef)][_0x5e46d4(0x2cc)])await recorder[_0x5e46d4(0x25d)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x5e46d4(0x2a6)]){let _0x4a6ae0=![],_0x2dfb94=0x0,_0xd63b94=_0x5e46d4(0x201);if(this[_0x5e46d4(0x23a)]===_0x5e46d4(0x2c2))_0x4a6ae0=!![],_0x2dfb94=0x168,_0xd63b94=_0x5e46d4(0x200);else this[_0x5e46d4(0x23a)]===_0x5e46d4(0x26e)&&(_0x4a6ae0=!![],_0x2dfb94=0x5a0,_0xd63b94=_0x5e46d4(0x2ed));pythonBridge[_0x5e46d4(0x2cd)](this,_0x5e46d4(0x28d),{'active':_0x4a6ae0,'duration':_0x2dfb94,'label':_0xd63b94}),await this[_0x5e46d4(0x2bb)](_0x5e46d4(0x2fc),{'val':JSON['stringify']({'active':_0x4a6ae0,'label':_0xd63b94,'timestamp':Date[_0x5e46d4(0x2f0)]()}),'ack':!![]});}}if(!_0x5645e1['ack'])this['setState'](_0x3b6464,{'val':this[_0x5e46d4(0x23a)],'ack':!![]});return;}if(_0x3b6464[_0x5e46d4(0x2a0)]('analysis.energy.warmupSources')&&_0x5645e1[_0x5e46d4(0x20f)])this[_0x5e46d4(0x1e5)](_0x5645e1[_0x5e46d4(0x284)]);if(_0x3b6464['endsWith'](_0x5e46d4(0x20d))&&_0x5645e1[_0x5e46d4(0x20f)]&&this[_0x5e46d4(0x20b)][_0x5e46d4(0x308)])automation[_0x5e46d4(0x279)](this);if(!_0x5645e1[_0x5e46d4(0x20f)]){if(_0x3b6464[_0x5e46d4(0x233)](_0x5e46d4(0x264))&&_0x5645e1[_0x5e46d4(0x284)]){this['setState'](_0x3b6464,{'val':![],'ack':!![]}),aiAgent[_0x5e46d4(0x299)](this);return;}if(_0x3b6464['includes']('triggerDailyDigest')&&_0x5645e1[_0x5e46d4(0x284)]){this[_0x5e46d4(0x2bf)](_0x3b6464,{'val':![],'ack':!![]});if(this[_0x5e46d4(0x2a6)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x3b6464['includes'](_0x5e46d4(0x26c))&&_0x5645e1[_0x5e46d4(0x284)]){this[_0x5e46d4(0x2bf)](_0x3b6464,{'val':![],'ack':!![]}),aiAgent[_0x5e46d4(0x1eb)](this);return;}if(_0x3b6464[_0x5e46d4(0x233)]('automation.triggerAction')&&_0x5645e1[_0x5e46d4(0x284)]){this[_0x5e46d4(0x2bf)](_0x3b6464,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x3b6464[_0x5e46d4(0x233)](_0x5e46d4(0x1f5))&&_0x5645e1[_0x5e46d4(0x284)]){this[_0x5e46d4(0x2bf)](_0x3b6464,{'val':![],'ack':!![]});if(this[_0x5e46d4(0x2a6)])try{const _0x198821=await this[_0x5e46d4(0x295)](_0x5e46d4(0x1e2));if(_0x198821&&_0x198821['val']){const _0x8f7ce0=JSON[_0x5e46d4(0x294)](_0x198821['val']);this[_0x5e46d4(0x2bb)](_0x5e46d4(0x1f2),{'val':_0x5e46d4(0x26f),'ack':!![]}),pythonBridge[_0x5e46d4(0x2cd)](this,_0x5e46d4(0x22b),{'sequences':_0x8f7ce0});}}catch(_0x5e44c5){}return;}if(_0x3b6464['includes'](_0x5e46d4(0x254))&&_0x5645e1[_0x5e46d4(0x284)]){this[_0x5e46d4(0x2bf)](_0x3b6464,{'val':![],'ack':!![]});if(this['isProVersion'])try{this[_0x5e46d4(0x21e)]();const _0xa350c5=await this[_0x5e46d4(0x295)](_0x5e46d4(0x238));if(_0xa350c5&&_0xa350c5[_0x5e46d4(0x284)])pythonBridge[_0x5e46d4(0x2cd)](this,'TRAIN_HEALTH',{'digests':JSON['parse'](_0xa350c5['val'])});aiAgent[_0x5e46d4(0x23b)](this,_0x5e46d4(0x2ea)),setTimeout(()=>aiAgent[_0x5e46d4(0x23b)](this,_0x5e46d4(0x2da)),0x2ee0);}catch(_0x2fc7e4){}return;}if(_0x3b6464[_0x5e46d4(0x233)](_0x5e46d4(0x28f))&&_0x5645e1[_0x5e46d4(0x284)]){this[_0x5e46d4(0x2bf)](_0x3b6464,{'val':![],'ack':!![]}),await this['triggerEnergyPrediction']();return;}if(_0x3b6464[_0x5e46d4(0x233)]('analysis.training.triggerComfort')&&_0x5645e1['val']){this[_0x5e46d4(0x2bf)](_0x3b6464,{'val':![],'ack':!![]});if(this[_0x5e46d4(0x2a6)])try{const _0x52eaa9=await this[_0x5e46d4(0x295)](_0x5e46d4(0x21b));if(_0x52eaa9&&_0x52eaa9[_0x5e46d4(0x284)]){const _0x2c94fd={};if(this['config']['devices'])this['config'][_0x5e46d4(0x21a)][_0x5e46d4(0x276)](_0x13b05a=>{const _0x354cc7=_0x5e46d4;if(_0x13b05a['id']&&_0x13b05a[_0x354cc7(0x250)])_0x2c94fd[_0x13b05a['id']]=_0x13b05a[_0x354cc7(0x250)];});pythonBridge[_0x5e46d4(0x2cd)](this,_0x5e46d4(0x1e8),{'events':JSON[_0x5e46d4(0x294)](_0x52eaa9[_0x5e46d4(0x284)]),'deviceMap':_0x2c94fd});}}catch(_0x35100f){}return;}if(_0x3b6464[_0x5e46d4(0x233)](_0x5e46d4(0x212))&&_0x5645e1[_0x5e46d4(0x284)]){this[_0x5e46d4(0x2bf)](_0x3b6464,{'val':![],'ack':!![]}),topology[_0x5e46d4(0x207)](this);if(this[_0x5e46d4(0x2a6)])try{const _0x453dbc=await this[_0x5e46d4(0x295)](_0x5e46d4(0x1e2));if(_0x453dbc&&_0x453dbc[_0x5e46d4(0x284)])pythonBridge[_0x5e46d4(0x2cd)](this,_0x5e46d4(0x23e),{'sequences':JSON[_0x5e46d4(0x294)](_0x453dbc[_0x5e46d4(0x284)])});}catch(_0x4b4d6c){}return;}}const _0x309c90=(this[_0x5e46d4(0x2fb)][_0x5e46d4(0x21a)]||[])[_0x5e46d4(0x2ae)](_0x5d28ef=>_0x5d28ef['id']===_0x3b6464);if(_0x309c90){const _0x4ea793=await recorder[_0x5e46d4(0x319)](this,_0x3b6464,_0x5645e1,_0x309c90);_0x4ea793&&this[_0x5e46d4(0x2bf)](_0x5e46d4(0x1ff),{'val':Date[_0x5e46d4(0x2f0)](),'ack':!![]});_0x4ea793&&_0x4ea793['type']===_0x5e46d4(0x220)&&_0x4ea793[_0x5e46d4(0x25e)]&&this['isProVersion']&&deadMan[_0x5e46d4(0x26a)](this,_0x4ea793['location']);_0x5645e1[_0x5e46d4(0x284)]&&(_0x5645e1['val']===!![]||_0x5645e1[_0x5e46d4(0x284)]===0x1||String(_0x5645e1[_0x5e46d4(0x284)])[_0x5e46d4(0x2b7)]()===_0x5e46d4(0x249))&&(_0x309c90[_0x5e46d4(0x250)]&&(_0x309c90['type'][_0x5e46d4(0x233)]('window')||_0x309c90[_0x5e46d4(0x250)][_0x5e46d4(0x233)](_0x5e46d4(0x30e)))&&this[_0x5e46d4(0x22c)](_0x309c90));if(_0x309c90[_0x5e46d4(0x250)]===_0x5e46d4(0x230)||_0x309c90[_0x5e46d4(0x250)]===_0x5e46d4(0x270)){if(this[_0x5e46d4(0x20b)][_0x5e46d4(0x308)])automation['cleanupGhostInterventions'](this);}}}async['protectAiMemory'](_0x27b53c){const _0x206128=a0_0x559667;if(!this[_0x206128(0x2e5)]||Date[_0x206128(0x2f0)]()-this[_0x206128(0x1f9)]>0x493e0)return;try{const _0x1453b3=JSON[_0x206128(0x294)](_0x27b53c),_0x4b0818=this[_0x206128(0x2e5)][_0x206128(0x2a8)];let _0x1c4c9c=![];for(const _0x5c181b in _0x4b0818){if(_0x4b0818[_0x5c181b]['includes']('AI')&&_0x1453b3[_0x5c181b]&&!_0x1453b3[_0x5c181b][_0x206128(0x233)]('AI')){_0x1c4c9c=!![];break;}}_0x1c4c9c&&(await this[_0x206128(0x2bb)]('analysis.energy.warmupTimes',{'val':JSON[_0x206128(0x221)](this[_0x206128(0x2e5)]['times']),'ack':!![]}),await this[_0x206128(0x2bb)](_0x206128(0x1fd),{'val':JSON[_0x206128(0x221)](this[_0x206128(0x2e5)][_0x206128(0x2a8)]),'ack':!![]}));}catch(_0xc19ccd){}}async[a0_0x559667(0x31b)](){const _0xd181af=a0_0x559667;try{const _0x26ade1=await this[_0xd181af(0x295)](setup[_0xd181af(0x2d2)]);if(_0x26ade1&&_0x26ade1[_0xd181af(0x284)])this['currentSystemMode']=_0x26ade1[_0xd181af(0x284)];}catch(_0x11e531){this[_0xd181af(0x23a)]=setup[_0xd181af(0x1ef)][_0xd181af(0x213)];}}async[a0_0x559667(0x26b)](){return![];}async['runAutopilot'](){const _0x513965=a0_0x559667;await aiAgent[_0x513965(0x299)](this);this[_0x513965(0x20b)][_0x513965(0x1f7)]&&(this[_0x513965(0x1fb)](),this['triggerGaitAnalysis']());if(this[_0x513965(0x20b)][_0x513965(0x308)])this['triggerEnergyPrediction']();}async[a0_0x559667(0x205)](){return![];}[a0_0x559667(0x255)](){const _0x329711=a0_0x559667;if(!this[_0x329711(0x2a6)])return;}async[a0_0x559667(0x2f1)](){const _0x219732=a0_0x559667;if(!this[_0x219732(0x2a6)]||!this[_0x219732(0x20b)][_0x219732(0x308)])return;try{const _0x394870={},_0x21c1ec={},_0x1aaa10=this[_0x219732(0x2fb)][_0x219732(0x21a)]||[];for(const _0x4094bb of _0x1aaa10){if((_0x4094bb[_0x219732(0x250)]===_0x219732(0x230)||_0x4094bb[_0x219732(0x250)]===_0x219732(0x270))&&_0x4094bb['location'])try{const _0x280d89=await this[_0x219732(0x211)](_0x4094bb['id']);_0x280d89&&typeof _0x280d89['val']===_0x219732(0x2b0)&&(_0x394870[_0x4094bb['location']]=_0x280d89[_0x219732(0x284)],_0x21c1ec[_0x4094bb['location']]=_0x4094bb[_0x219732(0x24e)]||![]);}catch(_0x2cd9c6){}}let _0x2e78bd=0xa;if(this[_0x219732(0x2fb)][_0x219732(0x251)])try{const _0x33d9ec=await this[_0x219732(0x211)](this[_0x219732(0x2fb)][_0x219732(0x251)]);if(_0x33d9ec&&typeof _0x33d9ec['val']===_0x219732(0x2b0))_0x2e78bd=_0x33d9ec[_0x219732(0x284)];}catch(_0x4153ad){}const _0x54c6f8=await this['checkSolarCondition']();let _0x380c0f={};try{const _0x5269db=await this[_0x219732(0x295)](_0x219732(0x240));if(_0x5269db&&_0x5269db[_0x219732(0x284)])_0x380c0f=JSON[_0x219732(0x294)](_0x5269db[_0x219732(0x284)]);}catch(_0x32ff6d){}pythonBridge['send'](this,'PREDICT_ENERGY',{'current_temps':_0x394870,'t_out':_0x2e78bd,'is_sunny':_0x54c6f8,'solar_flags':_0x21c1ec,'warmup_targets':_0x380c0f}),this['log']['info'](_0x219732(0x29b)+Object[_0x219732(0x1f4)](_0x394870)[_0x219732(0x31a)]+'\x20rooms)');}catch(_0x5977a5){this['log'][_0x219732(0x215)]('triggerEnergyPrediction\x20Error:\x20'+_0x5977a5[_0x219732(0x256)]);}}['updateHealthVector'](){}async[a0_0x559667(0x245)](_0xbfef33){}async['triggerInfrasoundCorrelation'](_0x27a1cf,_0x225f57){}async['analyzeWindowOpening'](_0x20a588){}async[a0_0x559667(0x2bd)](_0x28b07b){}[a0_0x559667(0x2ec)](_0x64d5f1){}}if(require[a0_0x559667(0x2fe)]!==module)module[a0_0x559667(0x2d7)]=_0x3b7054=>new CogniLiving(_0x3b7054);else new CogniLiving();