const a0_0x3ee61f=a0_0x3f5f;(function(_0x4ac458,_0x1f96fb){const _0x5745a8=a0_0x3f5f,_0x40f62d=_0x4ac458();while(!![]){try{const _0x58f5b6=parseInt(_0x5745a8(0x189))/0x1+parseInt(_0x5745a8(0x260))/0x2*(-parseInt(_0x5745a8(0x1fb))/0x3)+parseInt(_0x5745a8(0x1f8))/0x4+parseInt(_0x5745a8(0x1ff))/0x5*(-parseInt(_0x5745a8(0x239))/0x6)+-parseInt(_0x5745a8(0x8e))/0x7*(parseInt(_0x5745a8(0x130))/0x8)+parseInt(_0x5745a8(0x122))/0x9*(-parseInt(_0x5745a8(0x28b))/0xa)+parseInt(_0x5745a8(0xd5))/0xb*(parseInt(_0x5745a8(0x245))/0xc);if(_0x58f5b6===_0x1f96fb)break;else _0x40f62d['push'](_0x40f62d['shift']());}catch(_0x2875fd){_0x40f62d['push'](_0x40f62d['shift']());}}}(a0_0x2dff,0xe7826));const a0_0x4fe4bb=(function(){let _0x3caafb=!![];return function(_0x2955b8,_0x4e3304){const _0x4cf041=_0x3caafb?function(){const _0x591614=a0_0x3f5f;if(_0x4e3304){const _0x58306c=_0x4e3304[_0x591614(0x21d)](_0x2955b8,arguments);return _0x4e3304=null,_0x58306c;}}:function(){};return _0x3caafb=![],_0x4cf041;};}()),a0_0x103aa3=a0_0x4fe4bb(this,function(){const _0x59314b=a0_0x3f5f;return a0_0x103aa3['toString']()[_0x59314b(0x257)](_0x59314b(0xe6))['toString']()[_0x59314b(0x172)](a0_0x103aa3)[_0x59314b(0x257)](_0x59314b(0xe6));});a0_0x103aa3();'use strict';const utils=require(a0_0x3ee61f(0x134)),{GoogleGenerativeAI}=require(a0_0x3ee61f(0xab)),schedule=require(a0_0x3ee61f(0xa4)),{spawn,exec}=require('child_process'),path=require(a0_0x3ee61f(0x26b)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x3ee61f(0x25a),LTM_SCHEDULE=a0_0x3ee61f(0x20e),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x3ee61f(0xb7),LTM_DP_STATUS=a0_0x3ee61f(0x109),LTM_DP_TRIGGER_DIGEST=a0_0x3ee61f(0x156),LTM_DP_BASELINE_STATUS=a0_0x3ee61f(0x295),LTM_DP_DRIFT_CHANNEL=a0_0x3ee61f(0xf7),LTM_DP_DRIFT_STATUS=a0_0x3ee61f(0x86),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x3ee61f(0xaf),SYSTEM_DP_MODE=a0_0x3ee61f(0x262),HARD_IGNORE_TERMS=[a0_0x3ee61f(0x146),a0_0x3ee61f(0x18a),a0_0x3ee61f(0xfe),a0_0x3ee61f(0x145),a0_0x3ee61f(0x137),a0_0x3ee61f(0x243),'connection',a0_0x3ee61f(0x1e1),a0_0x3ee61f(0x2a2),a0_0x3ee61f(0x154),a0_0x3ee61f(0x1c2),'direction',a0_0x3ee61f(0x1b4),a0_0x3ee61f(0x90),a0_0x3ee61f(0x232),a0_0x3ee61f(0x196),'reachable','link_quality'],BAD_NAMES=['targetposition',a0_0x3ee61f(0x183),'state',a0_0x3ee61f(0x14d),a0_0x3ee61f(0x23d),a0_0x3ee61f(0xe0),'on',a0_0x3ee61f(0x11d),a0_0x3ee61f(0x175),'position',a0_0x3ee61f(0x114),a0_0x3ee61f(0x151),a0_0x3ee61f(0x1c6),a0_0x3ee61f(0x19b),a0_0x3ee61f(0x11e),'presence',a0_0x3ee61f(0x24e),'temperature','humidity',a0_0x3ee61f(0x299),a0_0x3ee61f(0xcd),a0_0x3ee61f(0x269),a0_0x3ee61f(0x28d),'actual_temperature',a0_0x3ee61f(0x150)],ADAPTER_BLACKLIST=[a0_0x3ee61f(0x1e3),a0_0x3ee61f(0x16f),a0_0x3ee61f(0xe7),a0_0x3ee61f(0x1d8),a0_0x3ee61f(0x159),a0_0x3ee61f(0x1bf),a0_0x3ee61f(0x207),'flot.',a0_0x3ee61f(0x148),a0_0x3ee61f(0x173),'simple-api.'],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x3ee61f(0x201),'PARTY':a0_0x3ee61f(0x1ae),'GUEST':a0_0x3ee61f(0x147)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x3ee61f(0xfc)]],PERSONA_MAPPING={'generic':a0_0x3ee61f(0xa6),'senior_aal':a0_0x3ee61f(0x20a),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x3ee61f(0x1f6),'security':'PRIORITÃ„T:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;function a0_0x3f5f(_0x17b046,_0x554760){const _0x28b63c=a0_0x2dff();return a0_0x3f5f=function(_0x103aa3,_0x4fe4bb){_0x103aa3=_0x103aa3-0x7f;let _0x2dfff8=_0x28b63c[_0x103aa3];return _0x2dfff8;},a0_0x3f5f(_0x17b046,_0x554760);}async function initZombies(_0x2352c5){const _0x2bd66e=a0_0x3ee61f;try{const _0x3dcd45=[_0x2bd66e(0x1e7),_0x2bd66e(0x1b7)];for(const _0x457f75 of _0x3dcd45){try{const _0x17caa4=await _0x2352c5['getObjectAsync'](_0x457f75);_0x17caa4&&await _0x2352c5['delObjectAsync'](_0x457f75);}catch(_0x272640){}}}catch(_0x58f0b2){}}async function initHistory(_0x340396){const _0x28166f=a0_0x3ee61f;try{const _0x165a58=await _0x340396[_0x28166f(0x9c)](_0x28166f(0x1e2));_0x165a58&&_0x165a58[_0x28166f(0x279)]&&(_0x340396[_0x28166f(0x236)]=JSON[_0x28166f(0x17e)](_0x165a58[_0x28166f(0x279)][_0x28166f(0x12a)]()));}catch(_0x3ad81e){_0x340396['eventHistory']=[];}try{const _0x225da0=await _0x340396[_0x28166f(0x9c)](_0x28166f(0x7f));if(_0x225da0&&_0x225da0[_0x28166f(0x279)])_0x340396[_0x28166f(0xdf)]=JSON[_0x28166f(0x17e)](_0x225da0[_0x28166f(0x279)][_0x28166f(0x12a)]());}catch(_0x40244f){_0x340396[_0x28166f(0xdf)]=[];}if(_0x340396[_0x28166f(0x236)]&&_0x340396[_0x28166f(0x236)][_0x28166f(0x215)]>0x0){_0x340396['log'][_0x28166f(0x160)](_0x28166f(0x294)+_0x340396['eventHistory'][_0x28166f(0x215)]+_0x28166f(0x29f));for(let _0x5bdc87=_0x340396['eventHistory'][_0x28166f(0x215)]-0x1;_0x5bdc87>=0x0;_0x5bdc87--){const _0x3f272f=_0x340396[_0x28166f(0x236)][_0x5bdc87];_0x3f272f&&_0x3f272f['id']!==undefined&&_0x3f272f[_0x28166f(0x23d)]!==undefined&&(_0x340396[_0x28166f(0xb0)][_0x3f272f['id']]=_0x3f272f['value']);}}}async function initSystemConfig(_0x320c28){const _0x23eb61=a0_0x3ee61f;try{const _0x1735f9=await _0x320c28['getForeignObjectAsync']('system.config');_0x1735f9&&_0x1735f9[_0x23eb61(0x1b3)]&&(_0x320c28[_0x23eb61(0x17f)]={'latitude':_0x1735f9[_0x23eb61(0x1b3)]['latitude']||0x0,'longitude':_0x1735f9['common'][_0x23eb61(0x27e)]||0x0,'city':_0x1735f9[_0x23eb61(0x1b3)][_0x23eb61(0x10d)]||''});}catch(_0x469c19){}}async function checkLicense(_0x3f5395,_0x1f79e1){const _0x5d0104=a0_0x3ee61f;if(!_0x1f79e1)return![];_0x3f5395[_0x5d0104(0x23e)]=await getSystemUUID(_0x3f5395);if(_0x1f79e1==='TEST-PRO-KEY'||_0x1f79e1[_0x5d0104(0xe5)]('PRO-'))return!![];return![];}async function getSystemUUID(_0x54674f){const _0x42886d=a0_0x3ee61f;try{const _0x1a524c=await _0x54674f['getForeignObjectAsync'](_0x42886d(0x12e));if(_0x1a524c&&_0x1a524c['native']&&_0x1a524c['native'][_0x42886d(0x8c)])return _0x1a524c['native'][_0x42886d(0x8c)];return _0x42886d(0x20b);}catch(_0x316df9){return'uuid-error';}}async function createAllObjects(_0x480578){const _0x401f73=a0_0x3ee61f;await checkSystemObjects(_0x480578),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x237),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x1cf),'type':_0x401f73(0x182),'role':_0x401f73(0x185),'read':!![],'write':![],'def':''},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0xa9),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x133),'type':_0x401f73(0x182),'role':_0x401f73(0x83),'read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x1e2),{'type':_0x401f73(0xf9),'common':{'name':'Event\x20History','type':_0x401f73(0x182),'role':_0x401f73(0x83),'read':!![],'write':![]},'native':{}}),await _0x480578['setObjectNotExistsAsync']('analysis.trigger',{'type':'state','common':{'name':_0x401f73(0x1e9),'type':'boolean','role':_0x401f73(0x296),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x1de),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x2a5),'type':_0x401f73(0x238),'role':_0x401f73(0x296),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x480578[_0x401f73(0x220)]('analysis.training',{'type':_0x401f73(0x165),'common':{'name':_0x401f73(0x85)},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x10b),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0xa1),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x1c9),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0xfb),'type':'string','role':_0x401f73(0x185),'read':!![],'write':![],'def':'Idle'},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x1d5),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0xd7),'type':_0x401f73(0x182),'role':_0x401f73(0x83),'read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x281),{'type':_0x401f73(0xf9),'common':{'name':'AI\x20Alert\x20Status','type':_0x401f73(0x238),'role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x480578['setObjectNotExistsAsync'](_0x401f73(0x1b6),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x22e),'type':'boolean','role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0xfd),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0xdc),'type':_0x401f73(0x182),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x13e),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0xf2),'type':_0x401f73(0x182),'role':_0x401f73(0x185),'read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)]('analysis.deviationFromBaseline',{'type':_0x401f73(0xf9),'common':{'name':'Deviation','type':_0x401f73(0x182),'role':_0x401f73(0xf9),'read':!![],'write':![],'def':_0x401f73(0x274)},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0xbf),{'type':_0x401f73(0xf9),'common':{'name':'Comfort\x20Summary','type':_0x401f73(0x182),'role':'text','read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)]('analysis.comfortSuggestion',{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x9d),'type':_0x401f73(0x182),'role':_0x401f73(0x185),'read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x220)](_0x401f73(0x18b),{'type':_0x401f73(0x165),'common':{'name':_0x401f73(0x247)},'native':{}}),await _0x480578['setObjectNotExistsAsync'](_0x401f73(0x266),{'type':_0x401f73(0xf9),'common':{'name':'Pattern\x20Detected','type':'boolean','role':_0x401f73(0x267),'read':!![],'write':![],'def':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x15f),{'type':'state','common':{'name':'Description','type':_0x401f73(0x182),'role':_0x401f73(0x185),'read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)]('analysis.automation.suggestedAction',{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x180),'type':'string','role':_0x401f73(0x185),'read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)]('analysis.automation.targetId',{'type':'state','common':{'name':_0x401f73(0x113),'type':'string','role':_0x401f73(0x185),'read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)]('analysis.automation.targetValue',{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x198),'type':_0x401f73(0x182),'role':_0x401f73(0x185),'read':!![],'write':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x111),{'type':_0x401f73(0xf9),'common':{'name':'Auto\x20Apply\x20Rule','type':_0x401f73(0x238),'role':_0x401f73(0x175),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x12d),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0xde),'type':_0x401f73(0x238),'role':_0x401f73(0x296),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x480578[_0x401f73(0x9b)]('analysis.analysisHistory',{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x18f),'type':_0x401f73(0x182),'role':_0x401f73(0x83),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x166),{'type':_0x401f73(0xf9),'common':{'name':'Feedback\x20Log','type':_0x401f73(0x182),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x480578[_0x401f73(0x220)](_0x401f73(0xc2),{'type':'channel','common':{'name':_0x401f73(0xeb)},'native':{}}),await _0x480578['setObjectNotExistsAsync'](_0x401f73(0xd0),{'type':'state','common':{'name':_0x401f73(0x216),'type':'number','role':_0x401f73(0x1f2),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x1b1),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x10f),'type':_0x401f73(0x182),'role':_0x401f73(0x185),'read':!![],'write':![],'def':_0x401f73(0x1f5)},'native':{}}),await _0x480578[_0x401f73(0x9b)]('analysis.health.notes',{'type':_0x401f73(0xf9),'common':{'name':'Health\x20Notes','type':'string','role':_0x401f73(0x185),'read':!![],'write':![],'def':''},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x136),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0xf6),'type':_0x401f73(0x182),'role':_0x401f73(0x185),'read':!![],'write':![],'def':_0x401f73(0x274)},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x1c1),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0xc9),'type':_0x401f73(0x155),'role':'value','read':!![],'write':![],'def':0x0},'native':{}}),await _0x480578['extendObjectAsync'](_0x401f73(0xd6),{'type':_0x401f73(0x165),'common':{'name':_0x401f73(0x206)},'native':{}}),await _0x480578[_0x401f73(0x9b)](_0x401f73(0x1a3),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x98),'type':'string','role':_0x401f73(0x83),'read':!![],'write':![],'def':'[]','desc':'Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training'},'native':{}}),await _0x480578['setObjectNotExistsAsync'](_0x401f73(0x248),{'type':_0x401f73(0xf9),'common':{'name':_0x401f73(0x18c),'type':_0x401f73(0x182),'role':'json','read':!![],'write':![],'def':'[]','desc':'Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time'},'native':{}}),await checkLtmObjects(_0x480578),await checkLtmDriftObjects(_0x480578);}async function checkSystemObjects(_0x5408d7){const _0x5e9115=a0_0x3ee61f;await _0x5408d7[_0x5e9115(0x220)](_0x5e9115(0x1a4),{'type':_0x5e9115(0x165),'common':{'name':_0x5e9115(0x116)},'native':{}}),await _0x5408d7['extendObjectAsync'](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x5e9115(0x29a),'type':'string','role':_0x5e9115(0xf9),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x5e9115(0x19f)],'states':{[SYSTEM_MODES[_0x5e9115(0x19f)]]:_0x5e9115(0xac),[SYSTEM_MODES[_0x5e9115(0x241)]]:_0x5e9115(0x19a),[SYSTEM_MODES[_0x5e9115(0xd2)]]:_0x5e9115(0x118),[SYSTEM_MODES[_0x5e9115(0xfc)]]:_0x5e9115(0x282)}},'native':{}});}async function checkLtmObjects(_0x4cfd3f){const _0x4fc6ff=a0_0x3ee61f;await _0x4cfd3f['extendObjectAsync'](_0x4fc6ff(0xca),{'type':_0x4fc6ff(0x165),'common':{'name':_0x4fc6ff(0xca)},'native':{}}),await _0x4cfd3f[_0x4fc6ff(0x220)](LTM_DP_RAW_LOG,{'type':_0x4fc6ff(0xf9),'common':{'name':_0x4fc6ff(0x21e),'type':_0x4fc6ff(0x182),'role':_0x4fc6ff(0x83),'read':!![],'write':![]},'native':{}}),await _0x4cfd3f[_0x4fc6ff(0x220)](LTM_DP_DAILY_DIGESTS,{'type':_0x4fc6ff(0xf9),'common':{'name':_0x4fc6ff(0xbb),'type':_0x4fc6ff(0x182),'role':'json','read':!![],'write':![]},'native':{}}),await _0x4cfd3f[_0x4fc6ff(0x220)](LTM_DP_STATUS,{'type':_0x4fc6ff(0xf9),'common':{'name':_0x4fc6ff(0x13d),'type':_0x4fc6ff(0x182),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4cfd3f[_0x4fc6ff(0x220)](LTM_DP_TRIGGER_DIGEST,{'type':_0x4fc6ff(0xf9),'common':{'name':_0x4fc6ff(0x11c),'type':_0x4fc6ff(0x238),'role':_0x4fc6ff(0x296),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4cfd3f[_0x4fc6ff(0x220)](LTM_DP_BASELINE_STATUS,{'type':_0x4fc6ff(0xf9),'common':{'name':_0x4fc6ff(0x265),'type':_0x4fc6ff(0x182),'role':_0x4fc6ff(0x185),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x109819){const _0x22d31e=a0_0x3ee61f;await _0x109819[_0x22d31e(0x220)](LTM_DP_DRIFT_CHANNEL,{'type':_0x22d31e(0x165),'common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x109819['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x22d31e(0xf9),'common':{'name':_0x22d31e(0x19c),'type':_0x22d31e(0x182),'role':_0x22d31e(0xf9),'read':!![],'write':![],'def':_0x22d31e(0x274)},'native':{}}),await _0x109819[_0x22d31e(0x220)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':'string','role':_0x22d31e(0x185),'read':!![],'write':![]},'native':{}}),await _0x109819[_0x22d31e(0x220)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x22d31e(0x138),'type':_0x22d31e(0x155),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x2bb74e){const _0xe7777c=a0_0x3ee61f;try{const _0xecf36e=await _0x2bb74e['getStateAsync'](SYSTEM_DP_MODE);_0xecf36e&&_0xecf36e['val']&&Object['values'](SYSTEM_MODES)[_0xe7777c(0xb1)](_0xecf36e[_0xe7777c(0x279)])?_0x2bb74e[_0xe7777c(0x168)]=_0xecf36e['val']:(_0x2bb74e[_0xe7777c(0x168)]=SYSTEM_MODES[_0xe7777c(0x19f)],await _0x2bb74e[_0xe7777c(0x28a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x22883e){_0x2bb74e[_0xe7777c(0x168)]=SYSTEM_MODES[_0xe7777c(0x19f)];}}async function loadRawEventLog(_0x4ce479){const _0xb64722=a0_0x3ee61f;try{const _0x469b5e=await _0x4ce479[_0xb64722(0x9c)](LTM_DP_RAW_LOG);if(_0x469b5e&&_0x469b5e['val'])_0x4ce479[_0xb64722(0x28f)]=JSON['parse'](_0x469b5e[_0xb64722(0x279)]);}catch(_0x5ea25c){_0x4ce479[_0xb64722(0x28f)]=[];}}async function saveRawEventLog(_0x17b97d){const _0x369be8=a0_0x3ee61f;_0x17b97d[_0x369be8(0x28f)]['length']>RAW_LOG_MAX_SIZE&&_0x17b97d['rawEventLog'][_0x369be8(0x217)](0x0,_0x17b97d['rawEventLog'][_0x369be8(0x215)]-RAW_LOG_MAX_SIZE),await _0x17b97d[_0x369be8(0x28a)](LTM_DP_RAW_LOG,{'val':JSON[_0x369be8(0x229)](_0x17b97d['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x599528){const _0x5eed9d=a0_0x3ee61f;try{const _0x4dbee0=await _0x599528['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x4dbee0&&_0x4dbee0[_0x5eed9d(0x279)])_0x599528['dailyDigests']=JSON[_0x5eed9d(0x17e)](_0x4dbee0[_0x5eed9d(0x279)]);}catch(_0x1e1cec){_0x599528[_0x5eed9d(0x288)]=[];}await updateBaselineStatus(_0x599528);}async function saveDailyDigests(_0x376bdc,_0xf646e2=!![]){const _0x418bb8=a0_0x3ee61f,_0x343489=_0x376bdc['config']['ltmLtbWindowDays']||0x3c;_0x376bdc[_0x418bb8(0x288)]['length']>_0x343489&&_0x376bdc['dailyDigests'][_0x418bb8(0x217)](0x0,_0x376bdc['dailyDigests'][_0x418bb8(0x215)]-_0x343489);await _0x376bdc['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x418bb8(0x229)](_0x376bdc[_0x418bb8(0x288)]),'ack':!![]});if(_0xf646e2)await updateBaselineStatus(_0x376bdc);}async function updateAnalysisHistory(_0x3ac631,_0x1d93ea){const _0x1cd0f7=a0_0x3ee61f;_0x3ac631[_0x1cd0f7(0xdf)][_0x1cd0f7(0x25d)](_0x1d93ea);if(_0x3ac631['analysisHistory']['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x3ac631[_0x1cd0f7(0xdf)]['pop']();await _0x3ac631[_0x1cd0f7(0x28a)](_0x1cd0f7(0x7f),{'val':JSON[_0x1cd0f7(0x229)](_0x3ac631['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x4a5b73){const _0x49ae77=a0_0x3ee61f;if(!_0x4a5b73['isProVersion']){await _0x4a5b73[_0x49ae77(0x28a)](LTM_DP_BASELINE_STATUS,{'val':_0x49ae77(0xe9),'ack':!![]});return;}const _0x355e69=_0x4a5b73[_0x49ae77(0x288)]['length']>=(_0x4a5b73['config'][_0x49ae77(0x10c)]||0x7)?_0x49ae77(0xd8)+_0x4a5b73['dailyDigests'][_0x49ae77(0x215)]+'\x20Tage)':_0x49ae77(0x285)+_0x4a5b73[_0x49ae77(0x288)][_0x49ae77(0x215)]+'/'+(_0x4a5b73[_0x49ae77(0x1f4)][_0x49ae77(0x10c)]||0x7)+')';await _0x4a5b73[_0x49ae77(0x28a)](LTM_DP_BASELINE_STATUS,{'val':_0x355e69,'ack':!![]});}async function initSensorSubscriptions(_0x3cb995){const _0x48fd8f=a0_0x3ee61f,_0x43765f=_0x3cb995[_0x48fd8f(0x1f4)]['devices'];if(_0x43765f&&_0x43765f[_0x48fd8f(0x215)]>0x0){_0x3cb995['log'][_0x48fd8f(0x160)]('Subscribing\x20to\x20'+_0x43765f[_0x48fd8f(0x215)]+_0x48fd8f(0xd3));for(const _0x3fe8db of _0x43765f){if(_0x3fe8db['id']){await _0x3cb995[_0x48fd8f(0x92)](_0x3fe8db['id']);try{const _0x4ae704=await _0x3cb995[_0x48fd8f(0x214)](_0x3fe8db['id']);if(_0x4ae704)_0x3cb995[_0x48fd8f(0xb0)][_0x3fe8db['id']]=_0x4ae704[_0x48fd8f(0x279)];}catch(_0x5bc2d9){}}}}}async function initPresenceSubscriptions(_0x8dd680){const _0x8569f=a0_0x3ee61f,_0x281e51=_0x8dd680['config']['presenceDevices']||[];if(_0x281e51[_0x8569f(0x215)]>0x0){_0x8dd680[_0x8569f(0x149)][_0x8569f(0x160)]('Subscribing\x20to\x20'+_0x281e51[_0x8569f(0x215)]+'\x20presence\x20devices...');for(const _0x200b6a of _0x281e51){await _0x8dd680['subscribeForeignStatesAsync'](_0x200b6a);}try{await checkWifiPresence(_0x8dd680);}catch(_0x29338e){}}}async function getWeatherContext(_0x48170b){const _0x21bfc8=a0_0x3ee61f;try{if(!_0x48170b[_0x21bfc8(0x1f4)][_0x21bfc8(0x29e)])return'Wetter:\x20Deaktiviert';let _0x57d4a4='';const _0x551ab4=_0x48170b[_0x21bfc8(0x1f4)][_0x21bfc8(0x144)];if(_0x551ab4)try{if(_0x551ab4[_0x21bfc8(0xb1)](_0x21bfc8(0x284))){const _0x19a286=await _0x48170b[_0x21bfc8(0x214)](_0x551ab4+_0x21bfc8(0xea));if(_0x19a286&&_0x19a286['val'])_0x57d4a4=_0x19a286[_0x21bfc8(0x279)];}else{if(_0x551ab4['includes']('daswetter')){const _0x5e3853=await _0x48170b[_0x21bfc8(0x214)](_0x551ab4+_0x21bfc8(0xe1));if(_0x5e3853&&_0x5e3853['val'])_0x57d4a4=_0x5e3853[_0x21bfc8(0x279)];}else{if(_0x551ab4['includes']('openweathermap')){const _0x1d8079=await _0x48170b['getForeignStateAsync'](_0x551ab4+_0x21bfc8(0x27c));if(_0x1d8079&&_0x1d8079[_0x21bfc8(0x279)])_0x57d4a4=_0x1d8079['val'];}}}}catch(_0x39fd00){}if(!_0x57d4a4){const _0x48aff4=['accuweather.0',_0x21bfc8(0x17b),_0x21bfc8(0x251),'openweathermap.0'];for(const _0x35d6f4 of _0x48aff4){try{const _0x4e1109=await _0x48170b['getForeignObjectAsync'](_0x35d6f4);if(_0x4e1109){if(_0x35d6f4[_0x21bfc8(0xb1)](_0x21bfc8(0x284))){const _0x2407b2=await _0x48170b[_0x21bfc8(0x214)](_0x35d6f4+'.Summary.Current');if(_0x2407b2&&_0x2407b2[_0x21bfc8(0x279)]){_0x57d4a4=_0x2407b2['val'];break;}}}}catch(_0x5e48b2){}}}return _0x57d4a4?_0x21bfc8(0x26e)+_0x57d4a4:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x34d79a){return'WETTER\x20ERROR:\x20'+_0x34d79a[_0x21bfc8(0xc5)];}}async function getCalendarContext(_0x347839){const _0x5d65ee=a0_0x3ee61f;try{if(!_0x347839[_0x5d65ee(0x1f4)]['useCalendar'])return _0x5d65ee(0x26f);let _0x36d37b=_0x347839['config'][_0x5d65ee(0x1b9)]||'ical.0',_0x2e1458=_0x347839[_0x5d65ee(0x1f4)][_0x5d65ee(0x108)]||[];if(typeof _0x2e1458===_0x5d65ee(0x182))_0x2e1458=_0x2e1458[_0x5d65ee(0x96)](',');try{const _0x1d527=await _0x347839[_0x5d65ee(0x214)](_0x36d37b+_0x5d65ee(0x1ec));if(_0x1d527&&_0x1d527[_0x5d65ee(0x279)]){let _0x20a8ed=tryParse(_0x1d527['val']);if(_0x20a8ed&&Array[_0x5d65ee(0x15b)](_0x20a8ed)){if(_0x2e1458['length']>0x0)_0x20a8ed=_0x20a8ed['filter'](_0x56c504=>_0x2e1458[_0x5d65ee(0xb1)](_0x56c504[_0x5d65ee(0x89)]||''));else return _0x5d65ee(0xcf);if(_0x20a8ed[_0x5d65ee(0x215)]>0x0){const _0x537068=_0x20a8ed[_0x5d65ee(0xc6)](0x0,0x3)[_0x5d65ee(0x1ba)](_0x5ec2c7=>{const _0x3f999f=_0x5d65ee;let _0x334129=_0x5ec2c7[_0x3f999f(0x84)];if(_0x5ec2c7[_0x3f999f(0xaa)])_0x334129+='\x20'+_0x5ec2c7[_0x3f999f(0xaa)];return _0x334129+':\x20'+_0x5ec2c7['event']+'\x20('+_0x5ec2c7['_calName']+')';});return _0x5d65ee(0xc1)+_0x537068[_0x5d65ee(0xf1)](_0x5d65ee(0x14c));}else return _0x5d65ee(0x1d6);}}}catch(_0x12cd3a){_0x347839[_0x5d65ee(0x149)]['warn'](_0x5d65ee(0x186)+_0x12cd3a[_0x5d65ee(0xc5)]);}return _0x5d65ee(0xa8);}catch(_0x5a0479){return _0x5d65ee(0x97)+_0x5a0479[_0x5d65ee(0xc5)];}}async function getCalendarNames(_0x424139,_0x3dc9da){const _0x3f6dad=a0_0x3ee61f;try{const _0xfb8090=await _0x424139[_0x3f6dad(0x214)](_0x3dc9da+_0x3f6dad(0x1ec));if(_0xfb8090&&_0xfb8090['val']){const _0x32c58a=tryParse(_0xfb8090[_0x3f6dad(0x279)]);if(_0x32c58a&&Array['isArray'](_0x32c58a)){const _0x72bf61=[...new Set(_0x32c58a[_0x3f6dad(0x1ba)](_0x5b9ea0=>_0x5b9ea0[_0x3f6dad(0x89)])[_0x3f6dad(0x21b)](Boolean))];return _0x72bf61[_0x3f6dad(0x13a)]();}}return[];}catch(_0x533975){return _0x424139['log'][_0x3f6dad(0x2a2)](_0x3f6dad(0x1a1)+_0x533975[_0x3f6dad(0xc5)]),[];}}async function checkWifiPresence(_0x2fcfe6){const _0x5e5f33=a0_0x3ee61f;try{const _0x32a614=_0x2fcfe6[_0x5e5f33(0x1f4)][_0x5e5f33(0x1e0)]||[];let _0x4c5b09=![];const _0x3f4552=[];for(const _0x1083f3 of _0x32a614){try{const _0x283c38=await _0x2fcfe6[_0x5e5f33(0x214)](_0x1083f3);if(_0x283c38&&(_0x283c38[_0x5e5f33(0x279)]===!![]||_0x283c38[_0x5e5f33(0x279)]===_0x5e5f33(0x1a9)||_0x283c38['val']===0x1)){_0x4c5b09=!![];const _0x5d9759=await _0x2fcfe6[_0x5e5f33(0x27f)](_0x1083f3);let _0x53a0a1=_0x1083f3;_0x5d9759&&_0x5d9759[_0x5e5f33(0x1b3)]&&_0x5d9759['common']['name']&&(_0x53a0a1=typeof _0x5d9759[_0x5e5f33(0x1b3)][_0x5e5f33(0x224)]===_0x5e5f33(0xa3)?_0x5d9759['common'][_0x5e5f33(0x224)]['de']||_0x5d9759[_0x5e5f33(0x1b3)]['name']['en']:_0x5d9759[_0x5e5f33(0x1b3)]['name']),_0x3f4552[_0x5e5f33(0x1c5)](_0x53a0a1);}}catch(_0x350dd7){}}return await _0x2fcfe6[_0x5e5f33(0x28a)](_0x5e5f33(0x237),{'val':_0x3f4552[_0x5e5f33(0xf1)](',\x20'),'ack':!![]}),_0x4c5b09&&(_0x2fcfe6[_0x5e5f33(0x289)]&&(_0x2fcfe6['log'][_0x5e5f33(0x160)](_0x5e5f33(0x13c)),abortExitTimer(_0x2fcfe6)),!_0x2fcfe6['isPresent']&&_0x2fcfe6[_0x5e5f33(0x168)]===SYSTEM_MODES[_0x5e5f33(0x19f)]&&await setPresence(_0x2fcfe6,!![])),_0x4c5b09;}catch(_0x52221e){return _0x2fcfe6['log'][_0x5e5f33(0x2a2)](_0x5e5f33(0x16d)+_0x52221e[_0x5e5f33(0xc5)]),![];}}function startExitTimer(_0x37198c){const _0x891888=a0_0x3ee61f;abortExitTimer(_0x37198c),_0x37198c[_0x891888(0x124)]=!![],_0x37198c[_0x891888(0x26a)]=setTimeout(()=>{_0x37198c['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x37198c[_0x891888(0x289)]=setTimeout(()=>{const _0x4a2559=_0x891888;setPresence(_0x37198c,![]),_0x37198c[_0x4a2559(0x289)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x54122b){const _0x38a04e=a0_0x3ee61f;if(_0x54122b['exitTimer'])clearTimeout(_0x54122b['exitTimer']);if(_0x54122b[_0x38a04e(0x26a)])clearTimeout(_0x54122b[_0x38a04e(0x26a)]);_0x54122b['exitTimer']=null,_0x54122b[_0x38a04e(0x26a)]=null,_0x54122b['isGracePeriodActive']=![];}async function setPresence(_0x1e3bfb,_0x38430c){const _0x4f7e24=a0_0x3ee61f;if(_0x1e3bfb[_0x4f7e24(0x187)]===_0x38430c)return;_0x1e3bfb[_0x4f7e24(0x187)]=_0x38430c,await _0x1e3bfb[_0x4f7e24(0x28a)](_0x4f7e24(0x2a8),{'val':_0x38430c,'ack':!![]});}async function saveFeedback(_0x5f1c53,_0x50d563){const _0xb2ae2c=a0_0x3ee61f;_0x5f1c53[_0xb2ae2c(0x149)][_0xb2ae2c(0x160)](_0xb2ae2c(0x1a7)+JSON[_0xb2ae2c(0x229)](_0x50d563));}async function runBaselineDriftAnalysis(_0xeb0dc6){const _0x24ce50=a0_0x3ee61f;if(!_0xeb0dc6[_0x24ce50(0x126)]||!_0xeb0dc6[_0x24ce50(0x10a)])return;const _0x4d2ea1=_0xeb0dc6[_0x24ce50(0x1f4)][_0x24ce50(0x1fd)]||0xe;if(_0xeb0dc6[_0x24ce50(0x288)][_0x24ce50(0x215)]<_0x4d2ea1+(_0xeb0dc6[_0x24ce50(0x1f4)][_0x24ce50(0x10c)]||0x7)){await _0xeb0dc6['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x24ce50(0x1df),'ack':!![]});return;}const _0x943621=_0xeb0dc6[_0x24ce50(0x288)][_0x24ce50(0xc6)](-_0x4d2ea1),_0x1e07ca=_0xeb0dc6[_0x24ce50(0x288)][_0x24ce50(0xc6)](0x0,_0xeb0dc6[_0x24ce50(0x288)]['length']-_0x4d2ea1),_0x534b26=_0x24ce50(0x12f)+JSON[_0x24ce50(0x229)](_0x1e07ca)+_0x24ce50(0x1be)+JSON[_0x24ce50(0x229)](_0x943621);try{const _0x3bbff3=await _0xeb0dc6[_0x24ce50(0x10a)][_0x24ce50(0xd4)](_0x534b26),_0x1f0262=JSON['parse'](_0x3bbff3[_0x24ce50(0x11a)][_0x24ce50(0x185)]()['replace'](/```json|```/g,'')[_0x24ce50(0x253)]());_0x1f0262[_0x24ce50(0x202)]&&(await _0xeb0dc6[_0x24ce50(0x28a)](LTM_DP_DRIFT_STATUS,{'val':_0x1f0262[_0x24ce50(0x202)],'ack':!![]}),await _0xeb0dc6[_0x24ce50(0x28a)](LTM_DP_DRIFT_DETAILS,{'val':_0x1f0262[_0x24ce50(0x8b)],'ack':!![]}),await _0xeb0dc6[_0x24ce50(0x28a)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x24ce50(0xb6)](),'ack':!![]}));}catch(_0x1db5e9){}}function setupLtmScheduler(_0x45c46d){const _0xb0f1ad=a0_0x3ee61f;try{if(_0x45c46d[_0xb0f1ad(0xdd)])_0x45c46d['ltmJob'][_0xb0f1ad(0x103)]();if(!_0x45c46d['isProVersion']){_0x45c46d[_0xb0f1ad(0x28a)](LTM_DP_STATUS,{'val':_0xb0f1ad(0xe9),'ack':!![]});return;}_0x45c46d[_0xb0f1ad(0xdd)]=schedule[_0xb0f1ad(0x28c)](LTM_SCHEDULE,()=>createDailyDigest(_0x45c46d));}catch(_0x147018){_0x45c46d[_0xb0f1ad(0x149)]['error']('LTM\x20Sched\x20Error:\x20'+_0x147018[_0xb0f1ad(0xc5)]);}}function setupModeResetScheduler(_0x1bf9ac){const _0x134be0=a0_0x3ee61f;try{if(_0x1bf9ac['modeResetJob'])_0x1bf9ac[_0x134be0(0x95)][_0x134be0(0x103)]();_0x1bf9ac[_0x134be0(0x95)]=schedule[_0x134be0(0x28c)](MODE_RESET_SCHEDULE,async()=>{const _0x339798=_0x134be0;await loadSystemMode(_0x1bf9ac),AUTO_RESET_MODES['includes'](_0x1bf9ac[_0x339798(0x168)])&&await _0x1bf9ac[_0x339798(0x28a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x339798(0x19f)],'ack':![]});});}catch(_0x5474cf){_0x1bf9ac[_0x134be0(0x149)][_0x134be0(0x2a2)](_0x134be0(0x170)+_0x5474cf[_0x134be0(0xc5)]);}}function setupDriftAnalysisScheduler(_0x12576c){const _0x3d1baf=a0_0x3ee61f;try{if(_0x12576c[_0x3d1baf(0x1e4)])clearInterval(_0x12576c['driftAnalysisTimer']);if(!_0x12576c[_0x3d1baf(0x126)])return;_0x12576c[_0x3d1baf(0x1e4)]=setInterval(()=>runBaselineDriftAnalysis(_0x12576c),(_0x12576c[_0x3d1baf(0x1f4)][_0x3d1baf(0x272)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x12576c),0x1388);}catch(_0x3e26fc){_0x12576c['log'][_0x3d1baf(0x2a2)]('Drift\x20Sched\x20Error:\x20'+_0x3e26fc[_0x3d1baf(0xc5)]);}}function setupBriefingScheduler(_0x274d6b){const _0x54c115=a0_0x3ee61f;try{if(_0x274d6b['briefingJob'])_0x274d6b[_0x54c115(0xb3)]['cancel']();if(!_0x274d6b[_0x54c115(0x1f4)][_0x54c115(0x292)])return;const _0x260d66=(_0x274d6b[_0x54c115(0x1f4)][_0x54c115(0x167)]||_0x54c115(0xee))[_0x54c115(0x96)](':'),_0x55a245=parseInt(_0x260d66[0x0])||0x8,_0x3e20f8=parseInt(_0x260d66[0x1])||0x0,_0x50f7c2=_0x3e20f8+'\x20'+_0x55a245+'\x20*\x20*\x20*';_0x274d6b[_0x54c115(0x149)][_0x54c115(0x160)](_0x54c115(0x212)+_0x55a245+':'+(_0x3e20f8<0xa?'0'+_0x3e20f8:_0x3e20f8)),_0x274d6b['briefingJob']=schedule[_0x54c115(0x28c)](_0x50f7c2,()=>{sendMorningBriefing(_0x274d6b);});}catch(_0x27bd79){_0x274d6b['log'][_0x54c115(0x2a2)](_0x54c115(0x19e)+_0x27bd79['message']);}}async function sendNotification(_0xbdf037,_0x6e6d03,_0x21da92=![],_0x452590=![]){const _0x4ddfbc=a0_0x3ee61f;_0xbdf037[_0x4ddfbc(0x149)]['info']((_0x21da92?_0x4ddfbc(0x1d9):'')+_0x4ddfbc(0x227)+_0x6e6d03+'\x22');const _0x423693=_0xbdf037[_0x4ddfbc(0x1f4)];let _0xbb4b17=0x0;if(_0x423693[_0x4ddfbc(0x23a)]){let _0x5d9316={};(_0x6e6d03[_0x4ddfbc(0xb1)]('Alarm')||_0x452590)&&(_0x5d9316={'reply_markup':{'inline_keyboard':[[{'text':_0x4ddfbc(0x128),'callback_data':_0x4ddfbc(0x1b8)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x4ddfbc(0xe2)}]]}}),await _0xbdf037[_0x4ddfbc(0x27a)](_0x423693[_0x4ddfbc(0x1b0)],'send',{'text':_0x6e6d03,'user':_0x423693[_0x4ddfbc(0x120)],..._0x5d9316}),_0xbb4b17++;}if(_0x423693[_0x4ddfbc(0x1a2)]){let _0x367aea={'message':_0x6e6d03,'title':_0x452590?_0x4ddfbc(0x1db):_0x4ddfbc(0xf8),'priority':_0x452590?0x2:0x1,'device':_0x423693['notifyPushoverRecipient']};_0x452590&&(_0x367aea[_0x4ddfbc(0x1ca)]=0x1e,_0x367aea[_0x4ddfbc(0x1dd)]=0xe10,_0x367aea[_0x4ddfbc(0x287)]=_0x4ddfbc(0x24a)),await _0xbdf037[_0x4ddfbc(0x27a)](_0x423693['notifyPushoverInstance'],_0x4ddfbc(0x242),_0x367aea),_0xbb4b17++;}return _0x423693['notifyEmailEnabled']&&(await _0xbdf037[_0x4ddfbc(0x27a)](_0x423693['notifyEmailInstance'],_0x4ddfbc(0x242),{'text':_0x6e6d03,'to':_0x423693[_0x4ddfbc(0x139)]}),_0xbb4b17++),_0xbb4b17;}function a0_0x2dff(){const _0x3f88bd=['Failed:\x20','notifyTelegramInstance','analysis.health.restlessness','\x22\x20--break-system-packages','common','stick_unreach','Error:\x20','analysis.isEmergency','events.history_debug_00','COGNI_CONFIRM_OK','calendarInstance','map','ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','inactivityThresholdHours','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','\x0aSTB:\x20','material.','sleepScore','analysis.health.trendValue','working','analysis.automation.targetValue','\x20for\x20interactive\x20buttons...','push','cover','Unknown\x20error','data','analysis.training.status','retry','exports','setForeignStateAsync','communicate.request','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','Who\x20is\x20present?','Anwesend','targetValue','stderr','\x20(Value:\x20','outdoorSensorId','analysis.lastResult','KALENDER:\x20Keine\x20relevanten\x20Termine','Adapter','vis.','[TEST]\x20','\x27\x20not\x20in\x20allowed\x20list)','ðŸš¨\x20EMERGENCY','python_service','expire','analysis.triggerBriefing','N/A\x20(Learning)','presenceDevices','maintenance','events.history','system.','driftAnalysisTimer','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','debug','analysis.history_debug_00','Error\x20reading\x20outdoor\x20sensor\x20','Trigger\x20Analysis','getEnums',').\x20Saving\x20to\x20Training\x20Data.','.data.table','command','Failed\x20to\x20send\x20to\x20Python:\x20','toISOString','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','ready','value.health','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','config','none','Fokus\x20auf\x20Komfort.','kill','6684852BTdSrd','toLowerCase','âš ï¸\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...','3kdZYua','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','ltmStbWindowDays','temp','91635jtPAwH','No\x20training\x20sequences\x20found.','vacation','baselineDrift','Briefing\x20Error:\x20','Guardian:\x20Sending\x20','\x20events','Training\x20Data\x20Sets','icons-mfd.','KI-Modell\x20nicht\x20initialisiert','licenseKey','PRIORITÃ„T:\x20Gesundheit/AAL.','uuid-not-found','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','from','0\x203\x20*\x20*\x20*','testNotification','lampe','Success:\x20Compressed\x20','Scheduling\x20Morning\x20Briefing\x20for\x20','enum.rooms.*','getForeignStateAsync','length','Sleep\x20Score\x20(0-100)','splice','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','No\x20module\x20named\x20pip','Say\x20Hello','filter','.Current.Temperature','apply','Raw\x20Log','automation.triggerAction','extendObjectAsync','custom','onUnload','âš ï¸\x20SECURITY\x20ALARM:\x20','name','application/json','Exit\x20Sensor\x20triggered\x20(','Sending\x20notification:\x20\x22','.communicate.request','stringify','âŒ\x20Training\x20failed:\x20','[PYTHON]\x20','stdout','âœ…\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','AI\x20Emergency\x20Status','close','ABWESEND','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','dutycycle','lastCheck','getMonth','Morning\x20Briefing\x20sent.','eventHistory','system.presenceWho','boolean','390ShrKMy','notifyTelegramEnabled','UngewÃ¶hnliches\x20Bewegungsmuster\x20erkannt!\x20(Score:\x20','payload','value','systemUUID','Generating\x20Morning\x20Briefing...','Error\x20launching\x20Python\x20service:\x20','VACATION','send','rssi','service.py','5748PeEgRX','onReady','Automation\x20Proposals','LTM.trainingData.thermodynamics','sendTo','siren','âš ï¸\x20ALARM:\x20','instance','ðŸ§ \x20Triggering\x20Security\x20Training\x20with\x20','occupancy','devices','shift','weatherunderground.0','summary','trim','dependencyInstallInProgress','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','No\x20Data','search','Keiner','thermostat','models/gemini-flash-latest','dimmer','description','unshift','getHours','Unknown','1210482QofcLn','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','system.mode','getCalendarNames','Keine\x20Analyse.','Baseline\x20Status','analysis.automation.patternDetected','indicator','some','setpoint','exitGraceTimer','path','python3\x20-m\x20pip\x20install\x20-r\x20\x22','sensor','WETTER:\x20','Kalender:\x20Deaktiviert','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','SECURITY_RESULT','ltmDriftCheckIntervalHours','stateChange','N/A','inactivityMonitoringEnabled','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','openweathermap','\x20min).','val','sendToAsync','scanDevices','.forecast.current.state','Gemini\x20Init\x20Error:\x20','longitude','getForeignObjectAsync','toFixed','analysis.isAlert','Gast','temperature','accuweather','Lernphase\x20(','TRAIN_SECURITY','sound','dailyDigests','exitTimer','setStateAsync','14506190kcExlY','scheduleJob','valve','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','rawEventLog','python3','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','briefingEnabled','testApiKey','Restoring\x20sensor\x20cache\x20from\x20history\x20(','LTM.baselineStatus','button','type','getForeignObjectsAsync','power','System\x20Mode','genAI','activityLevel','door','useWeather','\x20events)...','.\x0a\x20\x20\x20\x20WETTER:\x20','prÃ¤senz','error','replace','presence','Trigger\x20Briefing\x20(Test)','stdin','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','system.isPresent','analysis.analysisHistory','geminiApiKey','Gemini\x20AI\x20initialized.','cogni-living\x20adapter\x20starting\x20(v','json','date','AI\x20Training\x20Control','LTM.driftAnalysis.baselineDrift','catch','location','_calName','alertReason','driftDetails','uuid','âœ…\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','7sNrgre','tÃ¼r','config_pending','enum','subscribeForeignStatesAsync','\x20=\x20','.\x0a\x20\x20\x20\x20KONTEXT:\x20','modeResetJob','split','KALENDER\x20ERROR:\x20','Recorded\x20Motion\x20Sequences','timestamp','heizung','setObjectNotExistsAsync','getStateAsync','Comfort\x20Suggestion','loc','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','detected','Train\x20Security\x20Model\x20(LSTM)','triggerBriefing','object','node-schedule','ML-Libs\x20fehlen','Analysiere\x20ausgewogen.','subscribeStates','KALENDER:\x20Keine\x20Daten','events.lastEvent','time','@google/generative-ai','Normal','warn','analysisInterval','LTM.driftAnalysis.lastCheck','sensorLastValues','includes','[RESULT]','briefingJob','setState','.\x20Welcome\x20home.','now','LTM.dailyDigests','BUTLER\x20Execution\x20Error:\x20','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','onStateChange','Daily\x20Digests','main','unload','ðŸŒ…\x20Daily\x20Briefing:\x0a','analysis.comfortSummary','getOverviewData','KALENDER:\x20','analysis.health','namespace','.forecast.current.temp','message','slice','contact','kontakt','Trend\x20Value\x20(%)','LTM','members','forEach','energy','getLtmData','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','analysis.health.sleepScore','\x20(Value\x20is\x20falsy:\x20','PARTY','\x20sensors...','generateContent','69278lTeWJr','LTM.trainingData','Last\x20Result','Aktiv\x20(','selectedFunctionIds','enum.functions.*','feedbackHistory','Alert\x20Reason','ltmJob','Trigger\x20Action\x20Now','analysisHistory','brightness','.NextHours.Location_1.Day_1.current.symbol_desc','COGNI_REQUEST_CALL','Training\x20only\x20available\x20in\x20Pro\x20Version.','substring','startsWith','(((.+)+)+)+$','info.','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','Deaktiviert\x20(Pro-Feature)','.Summary.Current','Health\x20&\x20Sleep\x20Analysis','Training\x20started...','ltmLtbWindowDays','08:00','TREND_RESULT',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','join','Activity\x20Summary','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','User\x20dismissed\x20automation\x20proposal.','round','Trend\x20Diagnosis\x20(Python)','LTM.driftAnalysis','Cogni-Living','state','fill','Training\x20Status','GUEST','analysis.alertReason','update',')\x20->\x20','analysisTimer','bewegung','Details:\x20','cancel','âœ…\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20','automationProposal','fenster','ANOMALY','calendarSelection','LTM.processingStatus','geminiModel','analysis.training.triggerSecurity','minDaysForBaseline','city','\x20days\x20of\x20activity\x20data\x20to\x20Python...','Restlessness\x20Level','light','analysis.automation.autoApply','getGenerativeModel','Target\x20ID','shutter','TRAINING_COMPLETE','System\x20Status\x20&\x20Control','ðŸ“¡\x20Hooking\x20into\x20','Party','Fehler:\x20','response','callback','Trigger\x20Digest','off','motion','pop','notifyTelegramRecipient','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','9BzuJZl','ANALYZE_TREND','isGracePeriodActive','[PYTHON\x20ERR]\x20','isProVersion','livingContext','âœ…\x20Alles\x20OK\x20(Reset)]','isEmergency','toString','getTime','IGNORING\x20DUPLICATE\x20(Cached):\x20','analysis.automation.triggerAction','system.meta.uuid','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','12716008GkkBvT','schalter','aiPersona','Last\x20raw\x20event','@iobroker/adapter-core','Gemini\x20Analysis\x20Error:\x20','analysis.health.trendDiagnosis','lowbat','Last\x20Check','notifyEmailRecipient','sort','_score','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','Processing\x20Status','analysis.activitySummary','No\x20instance','ðŸ\x20Guardian\x20Diagnosis\x20(','targetId','dismissAutomation','Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip','weatherInstance','unreach','scriptProblem','guest','echarts.','log','write','PONG','\x20|\x20','level','requirements.txt','Started\x20at\x20','set_temperature','blind','Invalid\x20JSON\x20from\x20Python:\x20','Kein\x20API\x20Key!','fault','number','LTM.triggerDailyDigest','ðŸ›¡ï¸\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','doors','history.','telegram','isArray','indexOf','Entry\x20detected\x20via\x20','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','analysis.automation.description','info','daswetter',').\x20Starting\x20Timer.','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','channel','analysis.feedbackHistory','briefingTime','currentSystemMode','\x20(Length:\x20','rollladen','Error\x20in\x20onMessage\x20command\x20','window','Error\x20checking\x20WiFi:\x20','Kein\x20API\x20Key\x20eingegeben.','admin.','Reset\x20Sched\x20Error:\x20','getFullYear','constructor','javascript.','Unbekannt','switch','No\x20module\x20named','setHours','lastAlertState','analysis.trigger','âŒ\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20','daswetter.0','.\x20DATEN:\x20Schlaf\x20','licht','parse','systemConfig','Action','bind','string','currentposition','version','text','Error\x20reading\x20calendar\x20table:\x20','isPresent','weather','1096923dpxtzz','scriptEnabled','analysis.automation','Thermodynamic\x20Data\x20Points','\x20(Type\x20\x27','pythonProcess','Logbook','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','Activity-Level','âŒ\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.','...','analysis.automation.targetId','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','firmware','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','Target\x20Value','\x22\x20--break-system-packages\x20--user','Urlaub','status','Drift\x20Status','klima','Briefing\x20Sched\x20Error:\x20','NORMAL','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','getCalendarNames\x20Error:\x20','notifyPushoverEnabled','LTM.trainingData.sequences','system','.forecast.current.temperature','health','Feedback\x20saved:\x20','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','online','generic','Verbindung\x20erfolgreich!\x20Antwort:\x20','.\x0a\x20\x20\x20\x20ANWESENHEITS_STATUS:\x20','getDate','party'];a0_0x2dff=function(){return _0x3f88bd;};return a0_0x2dff();}async function setupTelegramListener(_0x28e245){const _0x5cb939=a0_0x3ee61f,_0x1c5252=_0x28e245[_0x5cb939(0x1f4)][_0x5cb939(0x1b0)];_0x28e245[_0x5cb939(0x1f4)][_0x5cb939(0x23a)]&&_0x1c5252&&(_0x28e245[_0x5cb939(0x149)]['info'](_0x5cb939(0x117)+_0x1c5252+_0x5cb939(0x1c4)),await _0x28e245[_0x5cb939(0x92)](_0x1c5252+_0x5cb939(0x228)));}async function handleTelegramResponse(_0x34c4ed,_0x1c61a3){const _0x5ea161=a0_0x3ee61f;let _0x5b691d=_0x1c61a3;_0x1c61a3['startsWith']('[')&&(_0x5b691d=_0x1c61a3[_0x5ea161(0xe4)](_0x1c61a3[_0x5ea161(0x15c)](']')+0x1));if(_0x5b691d==='COGNI_CONFIRM_OK')_0x34c4ed[_0x5ea161(0x149)][_0x5ea161(0x160)](_0x5ea161(0xb9)),await _0x34c4ed[_0x5ea161(0x28a)](_0x5ea161(0x281),{'val':![],'ack':!![]}),await _0x34c4ed[_0x5ea161(0x28a)](_0x5ea161(0xfd),{'val':_0x5ea161(0x9f),'ack':!![]}),_0x34c4ed[_0x5ea161(0x178)]=![],sendNotification(_0x34c4ed,_0x5ea161(0x28e),![]);else _0x5b691d===_0x5ea161(0xe2)&&(_0x34c4ed[_0x5ea161(0x149)][_0x5ea161(0xad)](_0x5ea161(0x190)),sendNotification(_0x34c4ed,_0x5ea161(0x261),![],!![]));}async function runAutopilot(_0xb58928){const _0x2653cb=a0_0x3ee61f,_0xc9c9ed=_0xb58928['config']['inactivityThresholdHours'],_0x3ec878=_0xb58928['eventHistory'][_0x2653cb(0x215)]>0x0?_0xb58928[_0x2653cb(0x236)][0x0]['timestamp']:Date[_0x2653cb(0xb6)](),_0xc0a91=(Date[_0x2653cb(0xb6)]()-_0x3ec878)/(0x3e8*0x3c*0x3c);let _0x5948eb='';_0xb58928[_0x2653cb(0x1f4)][_0x2653cb(0x275)]&&_0xb58928['currentSystemMode']===SYSTEM_MODES[_0x2653cb(0x19f)]&&_0xb58928[_0x2653cb(0x187)]&&(_0xc0a91>_0xc9c9ed&&(_0x5948eb=_0x2653cb(0x218)+_0xc0a91[_0x2653cb(0x280)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0xb58928,_0x5948eb)[_0x2653cb(0x87)](_0x35c2a9=>_0xb58928[_0x2653cb(0x149)][_0x2653cb(0x2a2)](_0x35c2a9));}async function createDailyDigest(_0x538ace){const _0x3f5c9a=a0_0x3ee61f;if(!_0x538ace[_0x3f5c9a(0x126)])return;await _0x538ace[_0x3f5c9a(0x28a)](LTM_DP_STATUS,{'val':_0x3f5c9a(0x14f)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x538ace[_0x3f5c9a(0x10a)]||_0x538ace[_0x3f5c9a(0x28f)][_0x3f5c9a(0x215)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x538ace[_0x3f5c9a(0x28a)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x4b4e7b=JSON['parse'](JSON[_0x3f5c9a(0x229)](_0x538ace[_0x3f5c9a(0x28f)])),_0x577a9c=_0x4b4e7b[_0x3f5c9a(0x215)],_0x49f0d7=_0x3f5c9a(0x1f3)+JSON[_0x3f5c9a(0x229)](_0x4b4e7b);try{const _0x388655=await _0x538ace[_0x3f5c9a(0x10a)]['generateContent'](_0x49f0d7),_0x8467b6=JSON['parse'](_0x388655[_0x3f5c9a(0x11a)][_0x3f5c9a(0x185)]()[_0x3f5c9a(0x2a3)](/```json|```/g,'')[_0x3f5c9a(0x253)]());_0x8467b6[_0x3f5c9a(0x252)]&&(_0x538ace[_0x3f5c9a(0x288)][_0x3f5c9a(0x1c5)]({'timestamp':new Date()[_0x3f5c9a(0x1ef)](),'eventCount':_0x577a9c,'summary':_0x8467b6[_0x3f5c9a(0x252)],'activityLevel':_0x8467b6[_0x3f5c9a(0x29c)],'systemMode':_0x538ace[_0x3f5c9a(0x168)]}),await saveDailyDigests(_0x538ace),_0x538ace['rawEventLog']=[],await saveRawEventLog(_0x538ace),await _0x538ace['setStateAsync'](LTM_DP_STATUS,{'val':_0x3f5c9a(0x211)+_0x577a9c+_0x3f5c9a(0x205),'ack':!![]}),runPythonHealthCheck(_0x538ace));}catch(_0x59e947){await _0x538ace[_0x3f5c9a(0x28a)](LTM_DP_STATUS,{'val':_0x3f5c9a(0x1b5)+_0x59e947[_0x3f5c9a(0xc5)],'ack':!![]});}}async function sendMorningBriefing(_0x45d5a1){const _0x2305a1=a0_0x3ee61f;if(!_0x45d5a1[_0x2305a1(0x10a)])return;_0x45d5a1[_0x2305a1(0x149)][_0x2305a1(0x160)](_0x2305a1(0x23f));const _0xcb9fcc=_0x45d5a1[_0x2305a1(0x288)][_0x2305a1(0x215)]>0x0?_0x45d5a1['dailyDigests'][_0x45d5a1[_0x2305a1(0x288)][_0x2305a1(0x215)]-0x1]:null,_0x3a7d14=_0xcb9fcc&&_0xcb9fcc[_0x2305a1(0x1a6)]?_0xcb9fcc['health'][_0x2305a1(0x1c0)]:_0x2305a1(0x274),_0x1f86c5=new Date();_0x1f86c5[_0x2305a1(0x177)](0x4,0x0,0x0,0x0);const _0x37e8ec=_0x45d5a1['eventHistory'][_0x2305a1(0x21b)](_0x1548fc=>new Date(_0x1548fc[_0x2305a1(0x99)])>_0x1f86c5),_0x4cd35d=PERSONA_MAPPING[_0x45d5a1[_0x2305a1(0x1f4)][_0x2305a1(0x132)]||'generic'],_0x1ba878=_0x45d5a1[_0x2305a1(0x1f4)][_0x2305a1(0x127)]||'',_0x41859f=await getWeatherContext(_0x45d5a1),_0x303207=await getCalendarContext(_0x45d5a1),_0x4568e8=_0x2305a1(0x20c)+_0x4cd35d+'.\x20KONTEXT:\x20'+_0x1ba878+'.\x20ZUSATZ:\x20'+_0x41859f+'\x20'+_0x303207+_0x2305a1(0x17c)+_0x3a7d14+_0x2305a1(0x291)+JSON['stringify'](_0x37e8ec[_0x2305a1(0xc6)](0x0,0xa))+'.\x20OUTPUT:\x20Nur\x20Text.';try{const _0x3ec807=await _0x45d5a1[_0x2305a1(0x10a)]['generateContent'](_0x4568e8),_0x3e31e2=_0x2305a1(0xbe)+_0x3ec807['response'][_0x2305a1(0x185)]()['trim']();sendNotification(_0x45d5a1,_0x3e31e2),_0x45d5a1[_0x2305a1(0x149)]['info'](_0x2305a1(0x235));}catch(_0x478ee4){_0x45d5a1[_0x2305a1(0x149)][_0x2305a1(0x2a2)](_0x2305a1(0x203)+_0x478ee4[_0x2305a1(0xc5)]);}}async function scanForDevices(_0x386835,_0x2b2a6c){const _0x2252e5=a0_0x3ee61f;_0x386835[_0x2252e5(0x149)][_0x2252e5(0x160)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x2c0ae2=[],_0x5604cd=await _0x386835[_0x2252e5(0x298)]('*'),_0x4b00a2=await _0x386835['getForeignObjectsAsync'](_0x2252e5(0xda),_0x2252e5(0x91)),_0xcb7a1e=await _0x386835['getForeignObjectsAsync'](_0x2252e5(0x213),_0x2252e5(0x91)),_0x47f695={};if(_0x4b00a2)for(const _0x223ecb in _0x4b00a2){const _0x20b158=_0x4b00a2[_0x223ecb][_0x2252e5(0x1b3)][_0x2252e5(0xcb)]||[];_0x20b158[_0x2252e5(0xcc)](_0x1971ca=>{const _0x37cf09=_0x2252e5;if(!_0x47f695[_0x1971ca])_0x47f695[_0x1971ca]=[];_0x47f695[_0x1971ca][_0x37cf09(0x1c5)](_0x223ecb);});}const _0x24754a={};if(_0xcb7a1e)for(const _0xa1e1cb in _0xcb7a1e){const _0x7e7ee8=_0xcb7a1e[_0xa1e1cb]['common'][_0x2252e5(0xcb)]||[],_0x39b301=typeof _0xcb7a1e[_0xa1e1cb]['common'][_0x2252e5(0x224)]===_0x2252e5(0xa3)?_0xcb7a1e[_0xa1e1cb][_0x2252e5(0x1b3)]['name']['de']:_0xcb7a1e[_0xa1e1cb][_0x2252e5(0x1b3)][_0x2252e5(0x224)];_0x7e7ee8[_0x2252e5(0xcc)](_0x65da52=>_0x24754a[_0x65da52]=_0x39b301);}const _0x30f900=_0x2b2a6c[_0x2252e5(0xd9)]||[],_0x4c0be8=_0x2b2a6c[_0x2252e5(0x11e)]!==![],_0x3b1219=_0x2b2a6c[_0x2252e5(0x158)]!==![],_0x1efe80=_0x2b2a6c['lights']!==![],_0x1d52eb=_0x2b2a6c[_0x2252e5(0x283)]===!![],_0x2b10a2=_0x2b2a6c[_0x2252e5(0x188)]===!![];for(const _0x12b806 in _0x5604cd){const _0x2db8e5=_0x5604cd[_0x12b806];if(_0x2db8e5[_0x2252e5(0x297)]!=='state'||!_0x2db8e5[_0x2252e5(0x1b3)])continue;if(ADAPTER_BLACKLIST[_0x2252e5(0x268)](_0x34050b=>_0x12b806[_0x2252e5(0xe5)](_0x34050b))&&!_0x2b10a2)continue;const _0x11fa93=(_0x2db8e5[_0x2252e5(0x1b3)]['role']||'')['toLowerCase']();let _0x234f25=(typeof _0x2db8e5[_0x2252e5(0x1b3)]['name']===_0x2252e5(0xa3)?_0x2db8e5[_0x2252e5(0x1b3)][_0x2252e5(0x224)]['de']:_0x2db8e5[_0x2252e5(0x1b3)]['name'])||_0x12b806;const _0x24bb0f=_0x234f25[_0x2252e5(0x1f9)]();let _0x118f41=![],_0x2729d9=![];if(_0x30f900[_0x2252e5(0x215)]>0x0){const _0x422d43=_0x47f695[_0x12b806]||[],_0x424b6c=_0x12b806[_0x2252e5(0x96)]('.')[_0x2252e5(0xc6)](0x0,-0x1)[_0x2252e5(0xf1)]('.'),_0x40c937=_0x47f695[_0x424b6c]||[];(_0x422d43['some'](_0xfebb75=>_0x30f900[_0x2252e5(0xb1)](_0xfebb75))||_0x40c937[_0x2252e5(0x268)](_0x2ba4de=>_0x30f900['includes'](_0x2ba4de)))&&(_0x118f41=!![],_0x2729d9=!![]);}if(!_0x118f41&&!_0x2b10a2){if(HARD_IGNORE_TERMS[_0x2252e5(0x268)](_0x1f5a01=>_0x12b806[_0x2252e5(0xb1)](_0x1f5a01)||_0x24bb0f[_0x2252e5(0xb1)](_0x1f5a01[_0x2252e5(0x1f9)]())))continue;}if(BAD_NAMES[_0x2252e5(0x268)](_0x189d14=>_0x24bb0f===_0x189d14||_0x24bb0f['endsWith']('.'+_0x189d14))){const _0x30df99=_0x12b806['split']('.');if(_0x30df99[_0x2252e5(0x215)]>0x2){const _0x1ff29f=_0x30df99[_0x2252e5(0xc6)](0x0,-0x1)[_0x2252e5(0xf1)]('.'),_0x13813b=_0x5604cd[_0x1ff29f];if(_0x13813b&&_0x13813b[_0x2252e5(0x1b3)]&&_0x13813b[_0x2252e5(0x1b3)][_0x2252e5(0x224)]){const _0x12478d=typeof _0x13813b[_0x2252e5(0x1b3)][_0x2252e5(0x224)]==='object'?_0x13813b[_0x2252e5(0x1b3)][_0x2252e5(0x224)]['de']:_0x13813b[_0x2252e5(0x1b3)][_0x2252e5(0x224)];_0x12478d&&!_0x234f25[_0x2252e5(0xb1)](_0x12478d)&&(_0x234f25=_0x12478d+'\x20'+_0x234f25);}}}let _0x42446a='';if(_0x4c0be8&&(_0x11fa93[_0x2252e5(0xb1)]('motion')||_0x11fa93[_0x2252e5(0xb1)](_0x2252e5(0x24e))||_0x24bb0f[_0x2252e5(0xb1)](_0x2252e5(0x101))||_0x24bb0f['includes'](_0x2252e5(0x2a1))))_0x42446a=_0x2252e5(0x11e);else{if(!_0x42446a&&_0x3b1219&&(_0x11fa93[_0x2252e5(0xb1)](_0x2252e5(0x29d))||_0x11fa93[_0x2252e5(0xb1)](_0x2252e5(0x16c))||_0x11fa93[_0x2252e5(0xb1)]('lock')||_0x11fa93['includes'](_0x2252e5(0x151))||_0x11fa93[_0x2252e5(0xb1)]('shutter')||_0x24bb0f[_0x2252e5(0xb1)](_0x2252e5(0x106))||_0x24bb0f['includes'](_0x2252e5(0x8f))||_0x24bb0f['includes'](_0x2252e5(0x16a))))_0x42446a=_0x2252e5(0x29d);else{if(!_0x42446a&&_0x1efe80&&(_0x11fa93['includes'](_0x2252e5(0x110))||_0x11fa93[_0x2252e5(0xb1)](_0x2252e5(0x175))||_0x11fa93[_0x2252e5(0xb1)](_0x2252e5(0x25b))||_0x24bb0f[_0x2252e5(0xb1)](_0x2252e5(0x17d))||_0x24bb0f['includes'](_0x2252e5(0x210))||_0x24bb0f[_0x2252e5(0xb1)](_0x2252e5(0x131)))){if(_0x2db8e5['common'][_0x2252e5(0x14a)]||_0x11fa93[_0x2252e5(0xb1)](_0x2252e5(0x26d)))_0x42446a=_0x2252e5(0x110);}else{if(!_0x42446a&&_0x1d52eb&&(_0x11fa93[_0x2252e5(0xb1)](_0x2252e5(0x283))||_0x11fa93[_0x2252e5(0xb1)]('humidity')||_0x11fa93[_0x2252e5(0xb1)](_0x2252e5(0x259))||_0x24bb0f[_0x2252e5(0xb1)](_0x2252e5(0x1fe))||_0x24bb0f[_0x2252e5(0xb1)](_0x2252e5(0x19d))||_0x24bb0f[_0x2252e5(0xb1)](_0x2252e5(0x9a))))_0x42446a=_0x2252e5(0x283);else{if(!_0x42446a&&_0x2729d9)_0x42446a=_0x2252e5(0x221);}}}}if(_0x42446a){let _0x5113d8=_0x24754a[_0x12b806]||'';if(!_0x5113d8){let _0x202297=_0x12b806;for(let _0x1adf1b=0x0;_0x1adf1b<0x3;_0x1adf1b++){const _0xc1ec0d=_0x202297['lastIndexOf']('.');if(_0xc1ec0d===-0x1)break;_0x202297=_0x202297[_0x2252e5(0xe4)](0x0,_0xc1ec0d);if(_0x24754a[_0x202297]){_0x5113d8=_0x24754a[_0x202297];break;}}}_0x2c0ae2['push']({'id':_0x12b806,'name':_0x234f25,'location':_0x5113d8,'type':_0x42446a,'logDuplicates':_0x42446a===_0x2252e5(0x11e),'isExit':![],'_score':_0x5113d8?0x50:_0x42446a==='custom'?0x5a:0x28});}}return _0x2c0ae2['sort']((_0x141aa5,_0x1a5098)=>_0x1a5098['_score']-_0x141aa5[_0x2252e5(0x13b)]),_0x2c0ae2;}async function executeAutomationAction(_0x4b59fa){const _0x301a03=a0_0x3ee61f;try{const _0x14eefb=await _0x4b59fa[_0x301a03(0x9c)]('analysis.automation.targetId'),_0x2ba99d=await _0x4b59fa[_0x301a03(0x9c)](_0x301a03(0x1c3));if(_0x14eefb&&_0x14eefb[_0x301a03(0x279)]&&_0x2ba99d){const _0x2ff6ef=_0x14eefb[_0x301a03(0x279)];let _0x250a7e=_0x2ba99d['val'];try{_0x250a7e=JSON[_0x301a03(0x17e)](_0x250a7e);}catch(_0x2c9f7f){}_0x4b59fa[_0x301a03(0x149)][_0x301a03(0x160)](_0x301a03(0x270)+_0x2ff6ef+_0x301a03(0x93)+_0x250a7e),await _0x4b59fa[_0x301a03(0x1cc)](_0x2ff6ef,_0x250a7e);}else _0x4b59fa[_0x301a03(0x149)][_0x301a03(0xad)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x3d40c1){_0x4b59fa['log']['error'](_0x301a03(0xb8)+_0x3d40c1[_0x301a03(0xc5)]);}}function tryParse(_0xe015d5){try{return JSON['parse'](_0xe015d5);}catch(_0x5ae972){return null;}}async function recordSequence(_0x20e3f6,_0x55acfb){const _0xa3ceda=a0_0x3ee61f,_0x11422d=(_0x55acfb[_0xa3ceda(0x297)]||'')[_0xa3ceda(0x1f9)](),_0x27ee42=[_0xa3ceda(0x11e),_0xa3ceda(0x101),_0xa3ceda(0x2a1),_0xa3ceda(0x2a4),_0xa3ceda(0x24e),_0xa3ceda(0x29d),_0xa3ceda(0x8f),_0xa3ceda(0x16c),'fenster',_0xa3ceda(0xc7),_0xa3ceda(0xc8),'light',_0xa3ceda(0x17d),_0xa3ceda(0x175),_0xa3ceda(0x131),_0xa3ceda(0x25b),_0xa3ceda(0x210)];if(!_0x27ee42[_0xa3ceda(0x268)](_0x28c26b=>_0x11422d[_0xa3ceda(0xb1)](_0x28c26b))){_0x20e3f6[_0xa3ceda(0x149)][_0xa3ceda(0x1e6)]('[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20'+_0x55acfb['id']+_0xa3ceda(0x18d)+_0x55acfb[_0xa3ceda(0x297)]+_0xa3ceda(0x1da));return;}if(!_0x55acfb[_0xa3ceda(0x23d)]){_0x20e3f6['log'][_0xa3ceda(0x1e6)](_0xa3ceda(0x1bd)+_0x55acfb['id']+_0xa3ceda(0xd1)+_0x55acfb[_0xa3ceda(0x23d)]+')');return;}_0x20e3f6['log']['debug'](_0xa3ceda(0xf3)+_0x55acfb['id']+'\x20('+_0x55acfb[_0xa3ceda(0x88)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x22beb4={'loc':_0x55acfb['location']||_0xa3ceda(0x25f),'id':_0x55acfb['id'],'ts':Date[_0xa3ceda(0xb6)]()};activeSequence['push'](_0x22beb4),_0x20e3f6[_0xa3ceda(0x149)][_0xa3ceda(0x1e6)](_0xa3ceda(0x197)+_0x22beb4[_0xa3ceda(0x9e)]+_0xa3ceda(0x169)+activeSequence[_0xa3ceda(0x215)]+')'),sequenceTimer=setTimeout(async()=>{const _0x1e0f60=_0xa3ceda;activeSequence[_0x1e0f60(0x215)]>0x1?await saveCompletedSequence(_0x20e3f6):(_0x20e3f6[_0x1e0f60(0x149)]['debug'](_0x1e0f60(0x1a0)+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0xd2ad2d){const _0x510a4d=a0_0x3ee61f;try{_0xd2ad2d['log'][_0x510a4d(0x160)](_0x510a4d(0x231)+activeSequence[_0x510a4d(0x215)]+_0x510a4d(0x1eb));const _0x587bba=await _0xd2ad2d['getStateAsync'](_0x510a4d(0x1a3));let _0x59f802=[];if(_0x587bba&&_0x587bba[_0x510a4d(0x279)])try{_0x59f802=JSON['parse'](_0x587bba[_0x510a4d(0x279)]);}catch(_0xf715af){}const _0x1e2c97=activeSequence[0x0]['ts'],_0x50e80b=activeSequence[_0x510a4d(0x1ba)](_0x1e6df2=>({'loc':_0x1e6df2[_0x510a4d(0x9e)],'t_delta':Math['round']((_0x1e6df2['ts']-_0x1e2c97)/0x3e8)})),_0x23edf0={'timestamp':new Date(_0x1e2c97)['toISOString'](),'steps':_0x50e80b,'duration':Math[_0x510a4d(0xf5)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x1e2c97)/0x3e8),'daytime':new Date(_0x1e2c97)[_0x510a4d(0x25e)]()};_0x59f802[_0x510a4d(0x1c5)](_0x23edf0),_0x59f802[_0x510a4d(0x215)]>MAX_TRAINING_SET_SIZE&&_0x59f802['shift'](),await _0xd2ad2d['setStateAsync']('LTM.trainingData.sequences',{'val':JSON[_0x510a4d(0x229)](_0x59f802),'ack':!![]}),runSecurityCheck(_0xd2ad2d,_0x23edf0),activeSequence=[],sequenceTimer=null;}catch(_0x5b2525){_0xd2ad2d[_0x510a4d(0x149)][_0x510a4d(0x2a2)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x5b2525['message']);}}function runSecurityCheck(_0x40d468,_0x252638){const _0x1df9b9=a0_0x3ee61f;if(!_0x40d468[_0x1df9b9(0x126)])return;_0x40d468[_0x1df9b9(0x149)][_0x1df9b9(0x1e6)](_0x1df9b9(0x157)),sendToPython(_0x40d468,'ANALYZE_SEQUENCE',{'sequence':_0x252638});}async function getOutsideTemperatureNumeric(_0xc25696){const _0x54a80a=a0_0x3ee61f;if(_0xc25696[_0x54a80a(0x1f4)][_0x54a80a(0x1d4)])try{const _0x127c39=await _0xc25696['getForeignStateAsync'](_0xc25696[_0x54a80a(0x1f4)][_0x54a80a(0x1d4)]);if(_0x127c39&&_0x127c39['val']!==undefined&&_0x127c39[_0x54a80a(0x279)]!==null){const _0x1cafe6=parseFloat(_0x127c39['val']);if(!isNaN(_0x1cafe6))return _0x1cafe6;}}catch(_0x18e145){_0xc25696[_0x54a80a(0x149)][_0x54a80a(0xad)](_0x54a80a(0x1e8)+_0xc25696['config'][_0x54a80a(0x1d4)]+':\x20'+_0x18e145['message']);}const _0xc29dfa=_0xc25696[_0x54a80a(0x1f4)]['weatherInstance'];if(!_0xc25696['config'][_0x54a80a(0x29e)]||!_0xc29dfa)return null;try{let _0x154227='';if(_0xc29dfa[_0x54a80a(0xb1)](_0x54a80a(0x284)))_0x154227=_0xc29dfa+_0x54a80a(0x21c);else{if(_0xc29dfa['includes'](_0x54a80a(0x161)))_0x154227=_0xc29dfa+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0xc29dfa[_0x54a80a(0xb1)](_0x54a80a(0x277)))_0x154227=_0xc29dfa+_0x54a80a(0x1a5);else{if(_0xc29dfa[_0x54a80a(0xb1)]('weatherunderground'))_0x154227=_0xc29dfa+_0x54a80a(0xc4);}}}if(_0x154227){const _0x5428fe=await _0xc25696[_0x54a80a(0x214)](_0x154227);if(_0x5428fe&&_0x5428fe['val']!==undefined&&_0x5428fe[_0x54a80a(0x279)]!==null)return parseFloat(_0x5428fe[_0x54a80a(0x279)]);}}catch(_0x48a41a){}return null;}async function recordThermodynamics(_0x1972b7,_0x411bf5,_0x1dd902,_0x16156e){const _0x35589a=a0_0x3ee61f,_0x3fb867=await getOutsideTemperatureNumeric(_0x1972b7),_0x204418=await _0x1972b7[_0x35589a(0x9c)](_0x35589a(0x248));let _0x431c4a=[];if(_0x204418&&_0x204418['val'])try{_0x431c4a=JSON['parse'](_0x204418[_0x35589a(0x279)]);}catch(_0x50b457){}_0x431c4a['push']({'ts':Date[_0x35589a(0xb6)](),'room':_0x16156e||_0x35589a(0x25f),'t_in':_0x1dd902,'t_out':_0x3fb867});if(_0x431c4a[_0x35589a(0x215)]>THERMO_LOG_SIZE)_0x431c4a[_0x35589a(0x250)]();await _0x1972b7['setStateAsync']('LTM.trainingData.thermodynamics',{'val':JSON[_0x35589a(0x229)](_0x431c4a),'ack':!![]});}async function processSensorEvent(_0x3b3955,_0x3a48e5,_0x3afc69,_0x517445){const _0x13ef5c=a0_0x3ee61f;if(!_0x517445)return;const _0x2689f3=_0x3afc69[_0x13ef5c(0x279)],_0x42b3a2=Date[_0x13ef5c(0xb6)]();_0x3b3955[_0x13ef5c(0x149)][_0x13ef5c(0x1e6)]('Event\x20received:\x20'+_0x3a48e5+_0x13ef5c(0x93)+_0x2689f3);const _0x377083=_0x3b3955[_0x13ef5c(0xb0)][_0x3a48e5];_0x3b3955['sensorLastValues'][_0x3a48e5]=_0x2689f3;if(!_0x517445['logDuplicates']&&_0x377083!=undefined&&_0x377083==_0x2689f3){_0x3b3955['log'][_0x13ef5c(0x1e6)](_0x13ef5c(0x12c)+_0x517445[_0x13ef5c(0x224)]+_0x13ef5c(0x1d3)+_0x2689f3+')');return;}const _0x520107=(_0x517445['type']||'')[_0x13ef5c(0x1f9)](),_0x378647=_0x520107[_0x13ef5c(0xb1)](_0x13ef5c(0x283))||_0x520107[_0x13ef5c(0xb1)]('temperatur')||_0x520107[_0x13ef5c(0xb1)](_0x13ef5c(0x19d))||_0x520107[_0x13ef5c(0xb1)](_0x13ef5c(0x9a));_0x3b3955[_0x13ef5c(0x126)]&&_0x378647&&recordThermodynamics(_0x3b3955,_0x3a48e5,_0x2689f3,_0x517445[_0x13ef5c(0x88)]);const _0x4e7749={'timestamp':_0x42b3a2,'id':_0x3a48e5,'name':_0x517445[_0x13ef5c(0x224)],'type':_0x517445[_0x13ef5c(0x297)],'location':_0x517445[_0x13ef5c(0x88)],'value':_0x2689f3};_0x3b3955[_0x13ef5c(0x236)][_0x13ef5c(0x25d)](_0x4e7749);if(_0x3b3955['eventHistory'][_0x13ef5c(0x215)]>HISTORY_MAX_SIZE)_0x3b3955[_0x13ef5c(0x236)][_0x13ef5c(0x11f)]();await _0x3b3955[_0x13ef5c(0x28a)](_0x13ef5c(0xa9),{'val':JSON[_0x13ef5c(0x229)](_0x4e7749),'ack':!![]}),await _0x3b3955[_0x13ef5c(0x28a)]('events.history',{'val':JSON['stringify'](_0x3b3955[_0x13ef5c(0x236)]),'ack':!![]});_0x3b3955[_0x13ef5c(0x126)]&&(_0x3b3955[_0x13ef5c(0x28f)]['push'](_0x4e7749),await saveRawEventLog(_0x3b3955),recordSequence(_0x3b3955,_0x4e7749));if(_0x517445['isExit']&&_0x2689f3===!![]){if(_0x3b3955['isPresent']&&!_0x3b3955['isGracePeriodActive'])_0x3b3955[_0x13ef5c(0x149)][_0x13ef5c(0x160)](_0x13ef5c(0x226)+_0x517445['name']+_0x13ef5c(0x162)),startExitTimer(_0x3b3955);else!_0x3b3955[_0x13ef5c(0x187)]&&(_0x3b3955['log'][_0x13ef5c(0x160)](_0x13ef5c(0x15d)+_0x517445[_0x13ef5c(0x224)]+_0x13ef5c(0xb5)),await setPresence(_0x3b3955,!![]));}else _0x517445[_0x13ef5c(0x297)]==='motion'&&_0x2689f3===!![]&&(_0x3b3955[_0x13ef5c(0x289)]&&(_0x3b3955[_0x13ef5c(0x149)][_0x13ef5c(0x160)](_0x13ef5c(0x15e)),abortExitTimer(_0x3b3955)),!_0x3b3955[_0x13ef5c(0x187)]&&_0x3b3955[_0x13ef5c(0x168)]===SYSTEM_MODES[_0x13ef5c(0x19f)]&&await setPresence(_0x3b3955,!![]));}async function runGeminiAnalysis(_0x450006,_0x55e5e7=''){const _0x4ea61c=a0_0x3ee61f;if(!_0x450006[_0x4ea61c(0x10a)])return;if(_0x450006[_0x4ea61c(0x236)][_0x4ea61c(0x215)]===0x0)return;const _0x4d15e7=_0x450006[_0x4ea61c(0x236)][_0x4ea61c(0xc6)](0x0,0xf),_0x39046a=await getWeatherContext(_0x450006),_0x3144c9=_0x450006['currentSystemMode'],_0xbef81a=PERSONA_MAPPING[_0x450006[_0x4ea61c(0x1f4)]['aiPersona']||_0x4ea61c(0x1aa)],_0x1f72e9=_0x450006['config']['livingContext']||'Keine\x20Details.';let _0xe68494=_0x4ea61c(0x174);try{const _0x5bf2a3=await _0x450006[_0x4ea61c(0x9c)](_0x4ea61c(0x237));if(_0x5bf2a3&&_0x5bf2a3[_0x4ea61c(0x279)])_0xe68494=_0x5bf2a3[_0x4ea61c(0x279)];}catch(_0xe2e9f9){}let _0x21f9d7=![];try{const _0x53df07=await _0x450006[_0x4ea61c(0x9c)](_0x4ea61c(0x111));if(_0x53df07&&_0x53df07['val'])_0x21f9d7=!![];}catch(_0x5bae1f){}const _0xf400b3=_0x4ea61c(0x1e5)+_0xbef81a+_0x4ea61c(0x94)+_0x1f72e9+_0x4ea61c(0xe8)+_0x3144c9+_0x4ea61c(0x2a0)+_0x39046a+_0x4ea61c(0x163)+(_0x55e5e7||_0x4ea61c(0x258))+_0x4ea61c(0x1ac)+(_0x450006[_0x4ea61c(0x187)]?_0x4ea61c(0x1d0):_0x4ea61c(0x230))+'.\x0a\x20\x20\x20\x20ANWESENDE_GERAETE:\x20'+_0xe68494+_0x4ea61c(0x1ce)+JSON[_0x4ea61c(0x229)](_0x4d15e7)+_0x4ea61c(0x1fc);try{const _0x11fc7a=await _0x450006['geminiModel'][_0x4ea61c(0xd4)](_0xf400b3),_0x27517e=_0x11fc7a[_0x4ea61c(0x11a)]['text']()[_0x4ea61c(0x2a3)](/```json|```/g,'')[_0x4ea61c(0x253)](),_0x3cbfd7=JSON[_0x4ea61c(0x17e)](_0x27517e);await _0x450006[_0x4ea61c(0x28a)](_0x4ea61c(0x1d5),{'val':JSON['stringify'](_0x3cbfd7),'ack':!![]});_0x3cbfd7[_0x4ea61c(0x252)]&&await _0x450006[_0x4ea61c(0x28a)]('analysis.activitySummary',{'val':_0x3cbfd7[_0x4ea61c(0x252)],'ack':!![]});const _0x1eafdd={'timestamp':Date[_0x4ea61c(0xb6)](),'id':Date[_0x4ea61c(0xb6)]()[_0x4ea61c(0x12a)](),'analysis':{'activity':{'summary':_0x3cbfd7['summary']||_0x4ea61c(0x264),'isAlert':_0x3cbfd7['isAlert']||![],'alertReason':_0x3cbfd7['alertReason']},'comfort':{'automationProposal':_0x3cbfd7[_0x4ea61c(0x105)]}}};await updateAnalysisHistory(_0x450006,_0x1eafdd);const _0x3c64f9=_0x3cbfd7['isAlert']||![];_0x3c64f9!==_0x450006[_0x4ea61c(0x178)]&&(await _0x450006['setStateAsync']('analysis.isAlert',{'val':_0x3c64f9,'ack':!![]}),_0x450006[_0x4ea61c(0x178)]=_0x3c64f9,_0x3c64f9&&(await _0x450006[_0x4ea61c(0x28a)]('analysis.alertReason',{'val':_0x3cbfd7[_0x4ea61c(0x8a)],'ack':!![]}),sendNotification(_0x450006,_0x4ea61c(0x24b)+_0x3cbfd7[_0x4ea61c(0x8a)],![],_0x3cbfd7[_0x4ea61c(0x129)]))),_0x3cbfd7[_0x4ea61c(0x105)]&&_0x3cbfd7[_0x4ea61c(0x105)][_0x4ea61c(0xa0)]&&_0x3cbfd7['automationProposal']['targetId']&&(_0x450006[_0x4ea61c(0x149)][_0x4ea61c(0x160)](_0x4ea61c(0x195)+_0x3cbfd7['automationProposal'][_0x4ea61c(0x25c)]),await _0x450006[_0x4ea61c(0x28a)](_0x4ea61c(0x266),{'val':!![],'ack':!![]}),await _0x450006[_0x4ea61c(0x28a)](_0x4ea61c(0x15f),{'val':_0x3cbfd7[_0x4ea61c(0x105)]['description'],'ack':!![]}),await _0x450006[_0x4ea61c(0x28a)](_0x4ea61c(0x194),{'val':_0x3cbfd7[_0x4ea61c(0x105)][_0x4ea61c(0x141)],'ack':!![]}),await _0x450006[_0x4ea61c(0x28a)](_0x4ea61c(0x1c3),{'val':JSON[_0x4ea61c(0x229)](_0x3cbfd7['automationProposal'][_0x4ea61c(0x1d1)]),'ack':!![]}),_0x21f9d7&&(_0x450006['log'][_0x4ea61c(0x160)](_0x4ea61c(0x1a8)+_0x3cbfd7[_0x4ea61c(0x105)][_0x4ea61c(0x141)]+_0x4ea61c(0x193)),await executeAutomationAction(_0x450006)));}catch(_0x37498e){_0x450006[_0x4ea61c(0x149)]['error'](_0x4ea61c(0x135)+_0x37498e[_0x4ea61c(0xc5)]);}}function installPythonDependencies(_0x12465a){const _0x340aba=a0_0x3ee61f;if(_0x12465a[_0x340aba(0x254)])return;_0x12465a[_0x340aba(0x254)]=!![];const _0x187bf0=path['join'](__dirname,_0x340aba(0x1dc),_0x340aba(0x14e));_0x12465a[_0x340aba(0x149)]['info'](_0x340aba(0x276)+_0x187bf0+'...'),stopPythonService(_0x12465a);const _0x41f7ed=_0x340aba(0x26c)+_0x187bf0+_0x340aba(0x1b2);exec(_0x41f7ed,(_0x55b04d,_0x2479bd,_0x409a10)=>{const _0x13d524=_0x340aba,_0x4c36a7=_0x409a10&&_0x409a10[_0x13d524(0xb1)](_0x13d524(0x219))||_0x55b04d&&_0x55b04d[_0x13d524(0xc5)][_0x13d524(0xb1)](_0x13d524(0x219));if(_0x4c36a7){_0x12465a[_0x13d524(0x149)][_0x13d524(0xad)](_0x13d524(0x1fa)),exec(_0x13d524(0x2a7),(_0x4e035a,_0x4a341e,_0x4863e0)=>{const _0x5b3e37=_0x13d524;_0x4e035a?(_0x12465a[_0x5b3e37(0x149)][_0x5b3e37(0x2a2)](_0x5b3e37(0x192)),_0x12465a[_0x5b3e37(0x149)][_0x5b3e37(0x2a2)](_0x5b3e37(0x143)),_0x12465a[_0x5b3e37(0x254)]=![]):(_0x12465a[_0x5b3e37(0x149)][_0x5b3e37(0x160)](_0x5b3e37(0x8d)),exec(_0x5b3e37(0x26c)+_0x187bf0+_0x5b3e37(0x199),(_0xee3697,_0x6d61,_0x346798)=>{const _0x418def=_0x5b3e37;_0xee3697?_0x12465a[_0x418def(0x149)][_0x418def(0x2a2)](_0x418def(0x17a)+_0xee3697[_0x418def(0xc5)]):(_0x12465a[_0x418def(0x149)]['info'](_0x418def(0x22d)),startPythonService(_0x12465a)),_0x12465a[_0x418def(0x254)]=![];}));});return;}_0x12465a['dependencyInstallInProgress']=![],_0x55b04d?(_0x12465a[_0x13d524(0x149)][_0x13d524(0x2a2)]('âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.'),_0x12465a[_0x13d524(0x149)][_0x13d524(0x2a2)](_0x13d524(0x102)+(_0x409a10||_0x55b04d['message']))):(_0x12465a[_0x13d524(0x149)][_0x13d524(0x160)](_0x13d524(0x164)),startPythonService(_0x12465a));});}function sendToPython(_0x1ed0cf,_0x4d30d5,_0x415ef5={}){const _0x18fd8c=a0_0x3ee61f;if(!_0x1ed0cf['pythonProcess']||!_0x1ed0cf['pythonProcess'][_0x18fd8c(0x2a6)]['writable'])return;const _0x6ce370=JSON['stringify']({'command':_0x4d30d5,..._0x415ef5});try{_0x1ed0cf[_0x18fd8c(0x18e)][_0x18fd8c(0x2a6)]['write'](_0x6ce370+'\x0a');}catch(_0x1bfd54){_0x1ed0cf[_0x18fd8c(0x149)]['error'](_0x18fd8c(0x1ee)+_0x1bfd54['message']);}}function runPythonHealthCheck(_0x6e646e){const _0x5916c2=a0_0x3ee61f;if(!_0x6e646e[_0x5916c2(0x288)]||_0x6e646e[_0x5916c2(0x288)][_0x5916c2(0x215)]<0x2){_0x6e646e[_0x5916c2(0x149)][_0x5916c2(0x160)](_0x5916c2(0x1f0));return;}const _0x4a451c=_0x6e646e[_0x5916c2(0x288)]['map'](_0x1a368d=>{const _0x1c198a=_0x5916c2,_0x3cb106=(_0x1a368d[_0x1c198a(0x29c)]||'')[_0x1c198a(0x1f9)]();return ACTIVITY_LEVEL_MAP[_0x3cb106]||0x32;});_0x6e646e[_0x5916c2(0x149)][_0x5916c2(0x160)](_0x5916c2(0x204)+_0x4a451c['length']+_0x5916c2(0x10e)),sendToPython(_0x6e646e,_0x5916c2(0x123),{'values':_0x4a451c,'tag':_0x5916c2(0x191)});}function handlePythonResult(_0x6c5e86,_0x5baefa){const _0x57084d=a0_0x3ee61f;if(_0x5baefa['type']===_0x57084d(0x14b))_0x6c5e86[_0x57084d(0x149)][_0x57084d(0x1e6)](_0x57084d(0x1bb));else{if(_0x5baefa[_0x57084d(0x297)]===_0x57084d(0xef)){const {tag:_0x43aa1d,diagnosis:_0x37e616,change_percent:_0x424e21}=_0x5baefa[_0x57084d(0x23c)];_0x6c5e86[_0x57084d(0x149)][_0x57084d(0x160)](_0x57084d(0x140)+_0x43aa1d+'):\x20'+_0x37e616+'\x20('+_0x424e21+'%)'),_0x6c5e86[_0x57084d(0x28a)](_0x57084d(0x136),{'val':_0x37e616,'ack':!![]}),_0x6c5e86[_0x57084d(0x28a)]('analysis.health.trendValue',{'val':_0x424e21,'ack':!![]});}else{if(_0x5baefa[_0x57084d(0x297)]===_0x57084d(0x115)){const {success:_0x4b49b0,details:_0x2b835c}=_0x5baefa[_0x57084d(0x23c)];_0x4b49b0?(_0x6c5e86[_0x57084d(0x149)][_0x57084d(0x160)](_0x57084d(0x104)+_0x2b835c),_0x6c5e86[_0x57084d(0x28a)](_0x57084d(0x1c9),{'val':'Success:\x20'+new Date()['toLocaleTimeString']()+'\x20('+_0x2b835c+')','ack':!![]})):(_0x6c5e86[_0x57084d(0x149)][_0x57084d(0x2a2)](_0x57084d(0x22a)+(_0x2b835c||_0x57084d(0x1c7))),_0x6c5e86[_0x57084d(0x28a)](_0x57084d(0x1c9),{'val':_0x57084d(0x1af)+_0x2b835c,'ack':!![]}));}else{if(_0x5baefa[_0x57084d(0x297)]===_0x57084d(0x271)){const {anomaly_score:_0x3076cc,is_anomaly:_0x454735,threshold:_0x3fafbd}=_0x5baefa[_0x57084d(0x23c)];_0x6c5e86[_0x57084d(0x149)][_0x57084d(0x160)]('ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20'+_0x3076cc[_0x57084d(0x280)](0x5)+'\x20(Threshold:\x20'+_0x3fafbd+_0x57084d(0xff)+(_0x454735?_0x57084d(0x107):'OK'));if(_0x454735){const _0x2ed77f=_0x57084d(0x23b)+_0x3076cc[_0x57084d(0x280)](0x4)+')';_0x6c5e86[_0x57084d(0x28a)](_0x57084d(0x281),{'val':!![],'ack':!![]}),_0x6c5e86[_0x57084d(0x28a)](_0x57084d(0xfd),{'val':_0x2ed77f,'ack':!![]}),sendNotification(_0x6c5e86,_0x57084d(0x223)+_0x2ed77f,![],!![]);}}}}}}function startPythonService(_0x3764a3){const _0x5dc764=a0_0x3ee61f;try{const _0x29147f=path[_0x5dc764(0xf1)](__dirname,_0x5dc764(0x1dc),_0x5dc764(0x244));_0x3764a3[_0x5dc764(0x149)]['info']('ðŸ\x20Starting\x20Python\x20Sidecar:\x20'+_0x29147f),_0x3764a3[_0x5dc764(0x18e)]=spawn(_0x5dc764(0x290),[_0x29147f]),_0x3764a3[_0x5dc764(0x18e)][_0x5dc764(0x22c)]['on'](_0x5dc764(0x1c8),_0x5da99c=>{const _0x46cf35=_0x5dc764,_0x109069=_0x5da99c[_0x46cf35(0x12a)]()['split']('\x0a');_0x109069['forEach'](_0xb26c5c=>{const _0x54675a=_0x46cf35,_0x422f0d=_0xb26c5c[_0x54675a(0x253)]();if(!_0x422f0d)return;if(_0x422f0d[_0x54675a(0xe5)]('[LOG]'))_0x3764a3['log'][_0x54675a(0x1e6)](_0x54675a(0x22b)+_0x422f0d[_0x54675a(0xe4)](0x5)[_0x54675a(0x253)]());else{if(_0x422f0d[_0x54675a(0xe5)](_0x54675a(0xb2)))try{const _0x168b66=JSON[_0x54675a(0x17e)](_0x422f0d['substring'](0x8)[_0x54675a(0x253)]());handlePythonResult(_0x3764a3,_0x168b66);}catch(_0x1c065f){_0x3764a3[_0x54675a(0x149)][_0x54675a(0xad)](_0x54675a(0x152)+_0x422f0d);}}(_0x422f0d[_0x54675a(0xb1)](_0x54675a(0x176))||_0x422f0d[_0x54675a(0xb1)]('Bibliotheken\x20nicht\x20gefunden')||_0x422f0d[_0x54675a(0xb1)](_0x54675a(0xa5)))&&(_0x3764a3['log']['warn'](_0x54675a(0x255)),installPythonDependencies(_0x3764a3));});}),_0x3764a3[_0x5dc764(0x18e)][_0x5dc764(0x1d2)]['on'](_0x5dc764(0x1c8),_0xaf3ca9=>{const _0x26d3af=_0x5dc764,_0xc3b620=_0xaf3ca9[_0x26d3af(0x12a)]()['trim']();_0x3764a3[_0x26d3af(0x149)][_0x26d3af(0x2a2)](_0x26d3af(0x125)+_0xc3b620);}),_0x3764a3[_0x5dc764(0x18e)]['on'](_0x5dc764(0x22f),_0x170be8=>{const _0x9e474=_0x5dc764;_0x3764a3[_0x9e474(0x149)]['info'](_0x9e474(0x121)+_0x170be8),_0x3764a3[_0x9e474(0x18e)]=null;}),_0x3764a3[_0x5dc764(0x18e)]['on'](_0x5dc764(0x2a2),_0x3ea037=>{const _0x2b4397=_0x5dc764;_0x3764a3[_0x2b4397(0x149)]['warn']('[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20'+_0x3ea037[_0x2b4397(0xc5)]);});}catch(_0x1dcbe2){_0x3764a3[_0x5dc764(0x149)][_0x5dc764(0x2a2)](_0x5dc764(0x240)+_0x1dcbe2[_0x5dc764(0xc5)]);}}function stopPythonService(_0x40b13b){const _0x3937=a0_0x3ee61f;if(_0x40b13b[_0x3937(0x18e)]){_0x40b13b[_0x3937(0x149)][_0x3937(0x160)]('ðŸ\x20Stopping\x20Python\x20Sidecar...');try{_0x40b13b[_0x3937(0x18e)][_0x3937(0x1f7)]();}catch(_0x46360c){_0x40b13b[_0x3937(0x149)]['warn']('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x46360c[_0x3937(0xc5)]);}_0x40b13b[_0x3937(0x18e)]=null;}}class CogniLiving extends utils[a0_0x3ee61f(0x1d7)]{constructor(_0x494c0c){const _0x1c4984=a0_0x3ee61f;super({..._0x494c0c,'name':'cogni-living'}),this[_0x1c4984(0x236)]=[],this[_0x1c4984(0xdf)]=[],this[_0x1c4984(0xdb)]=[],this[_0x1c4984(0x28f)]=[],this['dailyDigests']=[],this['sensorLastValues']={},this[_0x1c4984(0x17f)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x1c4984(0x187)]=!![],this[_0x1c4984(0x289)]=null,this[_0x1c4984(0x26a)]=null,this[_0x1c4984(0x124)]=![],this['genAI']=null,this[_0x1c4984(0x10a)]=null,this[_0x1c4984(0x168)]=SYSTEM_MODES['NORMAL'],this[_0x1c4984(0x126)]=![],this[_0x1c4984(0x178)]=![],this[_0x1c4984(0x23e)]='unknown',this[_0x1c4984(0x100)]=null,this[_0x1c4984(0xdd)]=null,this['modeResetJob']=null,this[_0x1c4984(0x1e4)]=null,this[_0x1c4984(0xb3)]=null,this[_0x1c4984(0x18e)]=null,this[_0x1c4984(0x254)]=![],this['on'](_0x1c4984(0x1f1),this['onReady']['bind'](this)),this['on'](_0x1c4984(0x273),this[_0x1c4984(0xba)][_0x1c4984(0x181)](this)),this['on'](_0x1c4984(0xbd),this[_0x1c4984(0x222)][_0x1c4984(0x181)](this)),this['on'](_0x1c4984(0xc5),this['onMessage'][_0x1c4984(0x181)](this));}async[a0_0x3ee61f(0x246)](){const _0x34d1b5=a0_0x3ee61f;this[_0x34d1b5(0x149)][_0x34d1b5(0x160)](_0x34d1b5(0x82)+this[_0x34d1b5(0x184)]+_0x34d1b5(0xf0)),await initZombies(this),this[_0x34d1b5(0x1f4)][_0x34d1b5(0x209)]=this[_0x34d1b5(0x1f4)][_0x34d1b5(0x209)]||'';try{this[_0x34d1b5(0x126)]=await checkLicense(this,this['config'][_0x34d1b5(0x209)]);}catch(_0x1bf3e8){}if(!this[_0x34d1b5(0x1f4)]['inactivityThresholdHours']||this[_0x34d1b5(0x1f4)][_0x34d1b5(0x1bc)]<0.1)this['config'][_0x34d1b5(0x1bc)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config']['geminiApiKey'])try{this[_0x34d1b5(0x29b)]=new GoogleGenerativeAI(this[_0x34d1b5(0x1f4)][_0x34d1b5(0x80)]),this['geminiModel']=this[_0x34d1b5(0x29b)][_0x34d1b5(0x112)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x34d1b5(0x225)}}),this[_0x34d1b5(0x149)][_0x34d1b5(0x160)](_0x34d1b5(0x81));}catch(_0x552f0a){this[_0x34d1b5(0x149)][_0x34d1b5(0x2a2)](_0x34d1b5(0x27d)+_0x552f0a[_0x34d1b5(0xc5)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x34d1b5(0xa7)](_0x34d1b5(0x179)),this[_0x34d1b5(0xa7)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates']('system.mode'),this['subscribeStates'](_0x34d1b5(0x1de)),this['subscribeStates']('analysis.automation.triggerAction'),this['subscribeStates'](_0x34d1b5(0x111)),this['subscribeStates'](_0x34d1b5(0x10b)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x34d1b5(0x100)])clearInterval(this['analysisTimer']);const _0xe3997b=this[_0x34d1b5(0x1f4)][_0x34d1b5(0xae)]||0xf;_0xe3997b>0x0&&(this[_0x34d1b5(0x149)][_0x34d1b5(0x160)]('Starting\x20Autopilot\x20('+_0xe3997b+_0x34d1b5(0x278)),this[_0x34d1b5(0x100)]=setInterval(()=>{runAutopilot(this);},_0xe3997b*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x412675=_0x34d1b5;this[_0x412675(0x18e)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x3ee61f(0x222)](_0x57a79b){const _0x24930c=a0_0x3ee61f;if(this[_0x24930c(0x100)])clearInterval(this[_0x24930c(0x100)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x24930c(0x1e4)]);if(this[_0x24930c(0xdd)])this[_0x24930c(0xdd)][_0x24930c(0x103)]();if(this['modeResetJob'])this[_0x24930c(0x95)][_0x24930c(0x103)]();if(this['briefingJob'])this[_0x24930c(0xb3)][_0x24930c(0x103)]();if(this[_0x24930c(0x289)])clearTimeout(this[_0x24930c(0x289)]);if(this[_0x24930c(0x26a)])clearTimeout(this[_0x24930c(0x26a)]);stopPythonService(this),_0x57a79b();}async[a0_0x3ee61f(0xba)](_0x5425da,_0x5c979e){const _0x4e7acc=a0_0x3ee61f;if(!_0x5c979e)return;if(_0x5425da['includes'](_0x4e7acc(0x15a))&&_0x5425da['endsWith'](_0x4e7acc(0x1cd))&&_0x5c979e[_0x4e7acc(0x279)]){await handleTelegramResponse(this,_0x5c979e[_0x4e7acc(0x279)]);return;}if(_0x5425da===this[_0x4e7acc(0xc3)]+'.'+SYSTEM_DP_MODE){_0x5c979e[_0x4e7acc(0x279)]&&Object['values'](SYSTEM_MODES)['includes'](_0x5c979e[_0x4e7acc(0x279)])&&(this[_0x4e7acc(0x168)]=_0x5c979e[_0x4e7acc(0x279)],_0x5c979e[_0x4e7acc(0x279)]===SYSTEM_MODES[_0x4e7acc(0x241)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x5c979e['ack'])this[_0x4e7acc(0xb4)](_0x5425da,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x5c979e['ack']){_0x5425da['includes'](_0x4e7acc(0x179))&&_0x5c979e[_0x4e7acc(0x279)]&&(this[_0x4e7acc(0xb4)](_0x5425da,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x5425da['includes']('triggerDailyDigest')&&_0x5c979e[_0x4e7acc(0x279)]){this[_0x4e7acc(0xb4)](_0x5425da,{'val':![],'ack':!![]});if(this[_0x4e7acc(0x126)])createDailyDigest(this);}_0x5425da[_0x4e7acc(0xb1)](_0x4e7acc(0xa2))&&_0x5c979e[_0x4e7acc(0x279)]&&(this[_0x4e7acc(0xb4)](_0x5425da,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x5425da['includes'](_0x4e7acc(0x21f))&&_0x5c979e[_0x4e7acc(0x279)]&&(this[_0x4e7acc(0xb4)](_0x5425da,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x5425da[_0x4e7acc(0xb1)]('analysis.training.triggerSecurity')&&_0x5c979e[_0x4e7acc(0x279)]){this[_0x4e7acc(0xb4)](_0x5425da,{'val':![],'ack':!![]});if(!this[_0x4e7acc(0x126)]){this[_0x4e7acc(0x149)][_0x4e7acc(0xad)](_0x4e7acc(0xe3));return;}try{const _0x38e65f=await this[_0x4e7acc(0x9c)](_0x4e7acc(0x1a3));if(_0x38e65f&&_0x38e65f[_0x4e7acc(0x279)]){const _0x3aca8a=JSON[_0x4e7acc(0x17e)](_0x38e65f[_0x4e7acc(0x279)]);this[_0x4e7acc(0x149)][_0x4e7acc(0x160)](_0x4e7acc(0x24d)+_0x3aca8a[_0x4e7acc(0x215)]+'\x20sequences...'),this[_0x4e7acc(0x28a)](_0x4e7acc(0x1c9),{'val':_0x4e7acc(0xec),'ack':!![]}),sendToPython(this,_0x4e7acc(0x286),{'sequences':_0x3aca8a});}else this[_0x4e7acc(0x149)]['warn'](_0x4e7acc(0x200)),this['setStateAsync']('analysis.training.status',{'val':_0x4e7acc(0x256),'ack':!![]});}catch(_0x54a290){this[_0x4e7acc(0x149)]['error']('Training\x20Error:\x20'+_0x54a290[_0x4e7acc(0xc5)]);}}return;}if(this[_0x4e7acc(0x1f4)][_0x4e7acc(0x1e0)]&&this[_0x4e7acc(0x1f4)]['presenceDevices'][_0x4e7acc(0xb1)](_0x5425da)){await checkWifiPresence(this);return;}const _0x28eb54=(this['config'][_0x4e7acc(0x24f)]||[])['find'](_0x6577f8=>_0x6577f8['id']===_0x5425da);if(_0x28eb54)processSensorEvent(this,_0x5425da,_0x5c979e,_0x28eb54);}async['onMessage'](_0x16653b){const _0x29596b=a0_0x3ee61f;if(typeof _0x16653b===_0x29596b(0xa3)&&_0x16653b[_0x29596b(0xc5)])try{if(_0x16653b[_0x29596b(0x1ed)]===_0x29596b(0x293)){const _0x4f0622=_0x16653b['message']['apiKey']||this[_0x29596b(0x1f4)][_0x29596b(0x80)];if(!_0x4f0622)return this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':![],'message':_0x29596b(0x16e)},_0x16653b[_0x29596b(0x11b)]);try{const _0x2f74ca=new GoogleGenerativeAI(_0x4f0622),_0x351816=_0x2f74ca[_0x29596b(0x112)]({'model':GEMINI_MODEL}),_0x5c8ddd=await _0x351816[_0x29596b(0xd4)](_0x29596b(0x21a)),_0x446882=await _0x5c8ddd['response'],_0x215c35=_0x446882[_0x29596b(0x185)]();this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':!![],'message':_0x29596b(0x1ab)+_0x215c35[_0x29596b(0xe4)](0x0,0x14)+_0x29596b(0x193)},_0x16653b[_0x29596b(0x11b)]);}catch(_0x51c1c5){this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':![],'message':_0x29596b(0x119)+_0x51c1c5[_0x29596b(0xc5)]},_0x16653b[_0x29596b(0x11b)]);}}else{if(_0x16653b[_0x29596b(0x1ed)]==='testContext'){const _0x49c222=await getWeatherContext(this),_0x5c2163=await getCalendarContext(this);this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':!![],'weather':_0x49c222,'calendar':_0x5c2163},_0x16653b['callback']);}else{if(_0x16653b[_0x29596b(0x1ed)]===_0x29596b(0x20f)){}else{if(_0x16653b[_0x29596b(0x1ed)]===_0x29596b(0xce)){if(!this[_0x29596b(0x126)])return this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':![],'isPro':![]},_0x16653b[_0x29596b(0x11b)]);let _0xdac3c5={'status':_0x29596b(0x274),'details':'','lastCheck':0x0};try{_0xdac3c5[_0x29596b(0x19b)]=(await this[_0x29596b(0x9c)](LTM_DP_DRIFT_STATUS))[_0x29596b(0x279)],_0xdac3c5['details']=(await this[_0x29596b(0x9c)](LTM_DP_DRIFT_DETAILS))[_0x29596b(0x279)],_0xdac3c5[_0x29596b(0x233)]=(await this[_0x29596b(0x9c)](LTM_DP_DRIFT_LAST_CHECK))[_0x29596b(0x279)];}catch(_0x4a012a){}const _0x2cb415=this['analysisHistory']||[];this['sendTo'](_0x16653b[_0x29596b(0x20d)],_0x16653b['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x29596b(0x288)],'driftAnalysis':_0xdac3c5,'analysisHistory':_0x2cb415},_0x16653b['callback']);}else{if(_0x16653b['command']===_0x29596b(0xc0)){const _0xbc1ac7=this[_0x29596b(0x288)][_0x29596b(0x215)],_0x51dea2=new Date(),_0x342628=new Date(_0x51dea2[_0x29596b(0x171)](),_0x51dea2[_0x29596b(0x234)](),_0x51dea2[_0x29596b(0x1ad)]())[_0x29596b(0x12b)](),_0xc14b6a=this[_0x29596b(0x28f)][_0x29596b(0x21b)](_0x1fdceb=>new Date(_0x1fdceb[_0x29596b(0x99)])['getTime']()>_0x342628)['length'],_0x262374=new Array(0x18)[_0x29596b(0xfa)](0x0);this[_0x29596b(0x28f)][_0x29596b(0xcc)](_0x43e5a3=>{const _0x43b2b8=_0x29596b,_0x55297b=new Date(_0x43e5a3[_0x43b2b8(0x99)]);if(_0x55297b[_0x43b2b8(0x12b)]()>_0x342628)_0x262374[_0x55297b[_0x43b2b8(0x25e)]()]++;});let _0x2897fb={'status':'N/A'};try{_0x2897fb[_0x29596b(0x19b)]=(await this[_0x29596b(0x9c)](LTM_DP_DRIFT_STATUS))[_0x29596b(0x279)];}catch(_0xe4d98d){}let _0x364ea6='';try{const _0x50a670=await this[_0x29596b(0x9c)](_0x29596b(0x237));_0x364ea6=_0x50a670?_0x50a670['val']:'';}catch(_0x2989fd){}let _0x40b875=null;!this[_0x29596b(0x10a)]&&(_0x40b875=this['config'][_0x29596b(0x80)]?_0x29596b(0x208):_0x29596b(0x153));let _0x5e9d15={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x3c6b61=await this[_0x29596b(0x9c)](_0x29596b(0x266)),_0x539bea=await this[_0x29596b(0x9c)](_0x29596b(0x15f)),_0x4eaed7=await this['getStateAsync']('analysis.automation.targetId'),_0x59bdbd=await this[_0x29596b(0x9c)](_0x29596b(0x1c3)),_0x5a3305=await this['getStateAsync'](_0x29596b(0x111));_0x3c6b61&&_0x3c6b61[_0x29596b(0x279)]&&(_0x5e9d15[_0x29596b(0xa0)]=!![],_0x5e9d15[_0x29596b(0x25c)]=_0x539bea?_0x539bea[_0x29596b(0x279)]:'',_0x5e9d15['targetId']=_0x4eaed7?_0x4eaed7[_0x29596b(0x279)]:'',_0x5e9d15['targetValue']=_0x59bdbd?_0x59bdbd[_0x29596b(0x279)]:''),_0x5e9d15['autoApply']=_0x5a3305?!!_0x5a3305[_0x29596b(0x279)]:![];}catch(_0x2b33ab){}this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':!![],'eventHistory':this[_0x29596b(0x236)][_0x29596b(0xc6)](0x0,0xf),'stats':{'digestCount':_0xbc1ac7,'eventCountToday':_0xc14b6a,'hourlyActivity':_0x262374,'driftStatus':_0x2897fb[_0x29596b(0x19b)],'isPresent':this[_0x29596b(0x187)],'presenceWho':_0x364ea6,'minDays':this[_0x29596b(0x1f4)][_0x29596b(0x10c)]||0x7,'stbDays':this[_0x29596b(0x1f4)][_0x29596b(0x1fd)]||0xe,'ltbDays':this[_0x29596b(0x1f4)][_0x29596b(0xed)]||0x3c,'systemError':_0x40b875},'automation':_0x5e9d15},_0x16653b[_0x29596b(0x11b)]);}else{if(_0x16653b[_0x29596b(0x1ed)]===_0x29596b(0x1ea)){const _0x163b63=await this[_0x29596b(0x298)](_0x29596b(0xda),_0x29596b(0x91)),_0x4bb66c=[];if(_0x163b63)for(const _0x17d356 in _0x163b63){const _0x55a4db=_0x163b63[_0x17d356],_0xa1fc13=(_0x55a4db['common']&&typeof _0x55a4db[_0x29596b(0x1b3)][_0x29596b(0x224)]===_0x29596b(0xa3)?_0x55a4db[_0x29596b(0x1b3)][_0x29596b(0x224)]['de']:_0x55a4db[_0x29596b(0x1b3)]['name'])||_0x55a4db[_0x29596b(0x1b3)][_0x29596b(0x224)];_0x4bb66c[_0x29596b(0x1c5)]({'id':_0x17d356,'name':_0xa1fc13});}this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':!![],'enums':_0x4bb66c},_0x16653b['callback']);}else{if(_0x16653b['command']===_0x29596b(0x27b))try{const _0x31822d=await scanForDevices(this,_0x16653b[_0x29596b(0xc5)]||{});this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b['command'],{'success':!![],'devices':_0x31822d},_0x16653b['callback']);}catch(_0x4b48b2){this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':![],'error':_0x4b48b2['message']},_0x16653b[_0x29596b(0x11b)]);}else{if(_0x16653b[_0x29596b(0x1ed)]===_0x29596b(0x263)){const _0x1555ba=_0x16653b[_0x29596b(0xc5)][_0x29596b(0x24c)];if(!_0x1555ba)return this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':![],'error':_0x29596b(0x13f)},_0x16653b[_0x29596b(0x11b)]);const _0x16133f=await getCalendarNames(this,_0x1555ba);this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':!![],'names':_0x16133f},_0x16653b[_0x29596b(0x11b)]);}else{if(_0x16653b[_0x29596b(0x1ed)]==='simulateButler'){const {targetId:_0x46ff26,targetValue:_0x5d25d0}=_0x16653b['message'];this['log'][_0x29596b(0x160)]('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0x46ff26+_0x29596b(0x93)+_0x5d25d0),await this['setStateAsync'](_0x29596b(0x266),{'val':!![],'ack':!![]}),await this[_0x29596b(0x28a)]('analysis.automation.description',{'val':'SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20'+_0x46ff26,'ack':!![]}),await this[_0x29596b(0x28a)](_0x29596b(0x194),{'val':_0x46ff26,'ack':!![]}),await this[_0x29596b(0x28a)]('analysis.automation.targetValue',{'val':_0x5d25d0,'ack':!![]}),this['sendTo'](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':!![]},_0x16653b['callback']);}else{if(_0x16653b[_0x29596b(0x1ed)]==='submitFeedback'){const {historyId:_0x38e9ea,rating:_0xd2947d,comment:_0xdcbc4c,alertReason:_0x3278d3}=_0x16653b[_0x29596b(0xc5)];_0x38e9ea&&_0xd2947d?(await saveFeedback(this,{'timestamp':Date[_0x29596b(0xb6)](),'historyId':_0x38e9ea,'rating':_0xd2947d,'comment':_0xdcbc4c,'alertReason':_0x3278d3}),this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':!![]},_0x16653b[_0x29596b(0x11b)])):this[_0x29596b(0x249)](_0x16653b['from'],_0x16653b[_0x29596b(0x1ed)],{'success':![],'error':'Missing\x20data'},_0x16653b[_0x29596b(0x11b)]);}else _0x16653b[_0x29596b(0x1ed)]===_0x29596b(0x142)&&(this[_0x29596b(0x149)][_0x29596b(0x160)](_0x29596b(0xf4)),await this[_0x29596b(0x28a)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x29596b(0x28a)](_0x29596b(0x15f),{'val':'','ack':!![]}),this[_0x29596b(0x249)](_0x16653b[_0x29596b(0x20d)],_0x16653b[_0x29596b(0x1ed)],{'success':!![]},_0x16653b[_0x29596b(0x11b)]));}}}}}}}}}}catch(_0x423674){this[_0x29596b(0x149)][_0x29596b(0x2a2)](_0x29596b(0x16b)+_0x16653b[_0x29596b(0x1ed)]+':\x20'+_0x423674['message']);if(_0x16653b[_0x29596b(0x11b)])this[_0x29596b(0x249)](_0x16653b['from'],_0x16653b['command'],{'success':![],'error':_0x423674[_0x29596b(0xc5)]},_0x16653b['callback']);}}}if(require[a0_0x3ee61f(0xbc)]!==module)module[a0_0x3ee61f(0x1cb)]=_0x451ddc=>new CogniLiving(_0x451ddc);else new CogniLiving();