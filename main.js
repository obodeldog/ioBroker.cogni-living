function a0_0x3944(){const _0xd254fe=['motion','\x0aSTB:\x20','updateAnalysisHistory','online','\x20sensors...','startsWith','initHistory','setupBriefingScheduler','2-digit','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','LTM.driftAnalysis.driftDetails','NORMAL','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','0\x203\x20*\x20*\x20*','subscribeStates','channel','system.isPresent','endsWith','dutycycle','lastCheck','@google/generative-ai','.\x20MODUS:\x20','KALENDER\x20ERROR:\x20','Party','notifyTelegramInstance','activity','isEmergency','getStateAsync','cover','driftAnalysisTimer','expire','notifyEmailRecipient','stateChange','Sending\x20notification:\x20\x22','useCalendar','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20}','checkLicense','error','accuweather.0','ltmLtbWindowDays','application/json','sendMorningBriefing','LTM.triggerDailyDigest','val','geminiApiKey','filter','warn','COGNI_REQUEST_CALL','summary','from','getLtmData','isGracePeriodActive','replace','notifyPushoverEnabled','LTM.driftAnalysis.lastCheck','details','constructor','alertReason','analysis.triggerBriefing','setPresence','bind','retry','catch','event','analysis.isAlert','Daily\x20Digests','Scheduling\x20Morning\x20Briefing\x20for\x20','initZombies','getForeignObjectAsync','analysis.automation.description','testApiKey','onStateChange','indexOf','timestamp','openweathermap.0','scanDevices','detected','generateContent','unshift','set_temperature','606715sSTzJm','blind','[Test]\x20Interaktiver\x20Alarm','modeResetJob','24002JoKLrf','notifyTelegramEnabled','Urlaub','object','getForeignStateAsync','ðŸš¨ðŸš¨\x20NOTFALL','lastAlertState','0\x204\x20*\x20*\x20*','ltmStbWindowDays','off','Error\x20checking\x20WiFi:\x20','testNotification','handleTelegramResponse','isProVersion','triggerDailyDigest','notifyPushoverRecipient','setpoint','split','brightness','Alarm','daswetter','runBaselineDriftAnalysis','vis.','N/A','scriptProblem','generic','WETTER:\x20Keine\x20Daten\x20gefunden','info','trim','toISOString','javascript.','text','weatherunderground.0','analysisHistory','getGenerativeModel','loadSystemMode','notifyEmailInstance','briefingTime','communicate.request','sendNotification','system.mode','main','exitGraceTimer','9117yxLnsB','currentposition','analysis.activitySummary','includes','openweathermap','startExitTimer','isAlert','\x0a\x20\x20\x20\x20\x20\x20\x20\x20CRITICAL\x20SAFETY\x20CHECK:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20Sofort/Ad-Hoc:\x20Ist\x20es\x20jetzt\x20(','aiPersona','status','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','driftDetails','scanForDevices','\x20presence\x20devices...','processSensorEvent','fault','.Summary.Current','boolean','vacation','createDailyDigest','briefingJob','cogni-living','value','6EPLtub','rawEventLog','Drift\x20Analysis','feedbackHistory','simple-api.','\x20sent','ðŸš¨\x20EMERGENCY','ltmDriftCheckIntervalHours','stringify','uuid-error','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','\x20hours.\x20Potential\x20incapacitation.','\x20*\x20*\x20*','telegram','position','\x20|\x20','analysis.analysisHistory','push','saveRawEventLog','unreach','admin.','triggerBriefing','dailyDigests','genAI','now','.forecast.current.state','setHours','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','setupModeResetScheduler','runGeminiAnalysis','party','ltmJob','checkWifiPresence','KI-Modell\x20nicht\x20initialisiert\x20(Neustart\x20erforderlich?)','logDuplicates','config_pending','toString','energy','comfort','notifyEmailEnabled','sendToAsync','briefingEnabled','960ePpBpw','systemConfig','node-schedule','baselineDrift','WETTER:\x20','Keine\x20neuen\x20Automatisierungs-Muster\x20erkannt.','analysisInterval','saveDailyDigests','info.','values','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','parse','System\x20Mode','KALENDER:\x20Keine\x20Daten','echarts.','PRIORITÃ„T:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungewÃ¶hnliche\x20Anwesenheit.','exitTimer','notifyPushoverInstance','response','GUEST','Error\x20reading\x20calendar\x20table:\x20','system.config','message','_calName','splice','toFixed','callback','command','events.history','scheduleJob','Gast','.NextHours.Location_1.Day_1.current.symbol_desc','length','string','getEnums','button','level','slice','scriptEnabled','TEST-PRO-KEY','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','siren','sendTo','KALENDER:\x20','unknown','send','description','getSystemUUID','analysis.alertReason','calendarSelection','licenseKey','common','No\x20recorded\x20events\x20yet.','LTM.baselineStatus','194dOQtyy','sensorLastValues','Gemini\x20Init\x20Error:\x20','Kein\x20API\x20Key\x20konfiguriert!','Kalender:\x20Deaktiviert','analysisTimer','setState','map','ðŸ“¡\x20Hooking\x20into\x20','ical.0','presence','patternDetected','Lernphase\x20(','getOverviewData','LTM.processingStatus','automationProposal','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','cogni-living\x20adapter\x20starting\x20(v','setupLtmScheduler','WETTER\x20ERROR:\x20','weatherInstance','system.meta.uuid','onMessage','loadRawEventLog','PARTY','Baseline\x20Status','Wetter:\x20Deaktiviert','livingContext','link_quality','firmware','unload','targetposition','exports','time','uuid','pop','initPresenceSubscriptions','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','calendarInstance','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','tryParse','namespace','uuid-not-found','setupDriftAnalysisScheduler','notifyTelegramRecipient','switch','devices','minDaysForBaseline','08:00','setStateAsync','useWeather','.data.table','Aktiv\x20(','\x20Tage)','initSensorSubscriptions','isArray','isExit','KALENDER:\x20Keine\x20relevanten\x20Termine','Adapter','system','geminiModel','state','updateBaselineStatus','N/A\x20(Learning)','log','LTM\x20Sched\x20Error:\x20','8VYIbYq','Normal','Deaktiviert\x20(Pro-Feature)','temperature','sound','ready','normal','runAutopilot','analysis.trigger','join','valve','reachable','systemUUID','currentSystemMode','city','ack','onReady','getCalendarNames','8393959ZHLTXY',')\x20-\x20PHASE\x202b:\x20INTERACTIVE','history.','location','models/gemini-flash-latest','abortExitTimer','lowbat','.\x20PERSONA:\x20','extendObjectAsync','1950Hszdqu','Cogni-Living','checkSystemObjects','PRIORITÃ„T:\x20Gesundheit\x20und\x20Sicherheit\x20fÃ¼r\x20Senioren\x20(AAL).\x20Erkenne\x20InaktivitÃ¤t,\x20potenzielle\x20StÃ¼rze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20nÃ¤chtliche\x20Unruhe.','subscribeForeignStatesAsync','5784450yvAxqi','initSystemConfig','Phase\x202:\x20ACUTE\x20MONITORING.\x20STB\x20(Last\x2014d):\x20','isPresent','1061834iNLVJQ','presenceDevices','LTM','COGNI_CONFIRM_OK','VACATION','config','occupancy','LTM.rawEventLog','10584FuPnCF','cancel','date','Starting\x20Autopilot\x20(','\x20Phase\x203:\x20DRIFT\x20ACTIVE.\x20Compare\x20recent\x20events\x20against\x20long-term\x20patterns.','setupTelegramListener','name','createAllObjects','apply','accuweather','eventHistory','search','.communicate.request','PRO-','json','material.','\x20min).','getCalendarContext','Nein','icons-mfd.'];a0_0x3944=function(){return _0xd254fe;};return a0_0x3944();}const a0_0x39faf7=a0_0x4b40;(function(_0x1b1b02,_0x4310f8){const _0x5083ce=a0_0x4b40,_0x49bad5=_0x1b1b02();while(!![]){try{const _0xd1079a=parseInt(_0x5083ce(0x18b))/0x1+parseInt(_0x5083ce(0x125))/0x2*(parseInt(_0x5083ce(0x182))/0x3)+-parseInt(_0x5083ce(0x167))/0x4*(-parseInt(_0x5083ce(0x1f7))/0x5)+-parseInt(_0x5083ce(0xc5))/0x6*(-parseInt(_0x5083ce(0x179))/0x7)+-parseInt(_0x5083ce(0x193))/0x8*(parseInt(_0x5083ce(0xae))/0x9)+-parseInt(_0x5083ce(0x187))/0xa+-parseInt(_0x5083ce(0x1fb))/0xb*(-parseInt(_0x5083ce(0xef))/0xc);if(_0xd1079a===_0x4310f8)break;else _0x49bad5['push'](_0x49bad5['shift']());}catch(_0x167557){_0x49bad5['push'](_0x49bad5['shift']());}}}(a0_0x3944,0xc8d5f));const a0_0x551b4d=(function(){let _0xccd7cd=!![];return function(_0x40473b,_0x4119ec){const _0x2a952b=_0xccd7cd?function(){const _0x141bde=a0_0x4b40;if(_0x4119ec){const _0x52ebcb=_0x4119ec[_0x141bde(0x19b)](_0x40473b,arguments);return _0x4119ec=null,_0x52ebcb;}}:function(){};return _0xccd7cd=![],_0x2a952b;};}()),a0_0x508f11=a0_0x551b4d(this,function(){const _0x1217a5=a0_0x4b40;return a0_0x508f11[_0x1217a5(0xe9)]()[_0x1217a5(0x19e)]('(((.+)+)+)+$')[_0x1217a5(0xe9)]()[_0x1217a5(0x1df)](a0_0x508f11)[_0x1217a5(0x19e)]('(((.+)+)+)+$');});a0_0x508f11();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x39faf7(0x1bb)),schedule=require(a0_0x39faf7(0xf1)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x39faf7(0x17d),LTM_SCHEDULE=a0_0x39faf7(0x1b4),MODE_RESET_SCHEDULE=a0_0x39faf7(0x8a),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x39faf7(0x192),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x39faf7(0x133),LTM_DP_TRIGGER_DIGEST=a0_0x39faf7(0x1d1),LTM_DP_BASELINE_STATUS=a0_0x39faf7(0x124),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x39faf7(0x1b1),LTM_DP_DRIFT_LAST_CHECK=a0_0x39faf7(0x1dd),SYSTEM_DP_MODE=a0_0x39faf7(0xab),HARD_IGNORE_TERMS=[a0_0x39faf7(0x9b),a0_0x39faf7(0x115),'update',a0_0x39faf7(0xd8),a0_0x39faf7(0x17f),'rssi','connection','maintenance',a0_0x39faf7(0x1cc),a0_0x39faf7(0xbd),'working','direction','stick_unreach',a0_0x39faf7(0xe8),a0_0x39faf7(0x1b9),a0_0x39faf7(0x142),a0_0x39faf7(0x172),a0_0x39faf7(0x141)],GENERIC_NAMES=[a0_0x39faf7(0x144),a0_0x39faf7(0xaf),a0_0x39faf7(0x162),a0_0x39faf7(0x113),a0_0x39faf7(0xc4),a0_0x39faf7(0x95),'on',a0_0x39faf7(0x8c),a0_0x39faf7(0x152),a0_0x39faf7(0xd3),'shutter',a0_0x39faf7(0x1f8),a0_0x39faf7(0x1c3),a0_0x39faf7(0xb7),a0_0x39faf7(0x1a7),a0_0x39faf7(0x12f),a0_0x39faf7(0x191),a0_0x39faf7(0x16a),'humidity','power',a0_0x39faf7(0xea),a0_0x39faf7(0x93),a0_0x39faf7(0x171),'actual_temperature',a0_0x39faf7(0x1f6)],ADAPTER_BLACKLIST=['system.',a0_0x39faf7(0xd9),a0_0x39faf7(0xf7),a0_0x39faf7(0x99),a0_0x39faf7(0x17b),a0_0x39faf7(0x1a2),a0_0x39faf7(0x1a6),'flot.',a0_0x39faf7(0xfd),a0_0x39faf7(0xa1),a0_0x39faf7(0xc9)],SYSTEM_MODES={'NORMAL':a0_0x39faf7(0x16d),'VACATION':a0_0x39faf7(0xc0),'PARTY':a0_0x39faf7(0xe3),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x39faf7(0x102)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':a0_0x39faf7(0x185),'family':'Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','single_comfort':a0_0x39faf7(0xb8),'security':a0_0x39faf7(0xfe)};class CogniLiving extends utils[a0_0x39faf7(0x15f)]{constructor(_0x17ff8f){const _0x22d738=a0_0x39faf7;super({..._0x17ff8f,'name':_0x22d738(0xc3)}),this[_0x22d738(0x19d)]=[],this[_0x22d738(0xa4)]=[],this[_0x22d738(0xc8)]=[],this[_0x22d738(0xc6)]=[],this[_0x22d738(0xdb)]=[],this[_0x22d738(0x126)]={},this[_0x22d738(0xf0)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x22d738(0x18a)]=!![],this[_0x22d738(0xff)]=null,this[_0x22d738(0xad)]=null,this[_0x22d738(0x1da)]=![],this[_0x22d738(0xdc)]=null,this['geminiModel']=null,this['currentSystemMode']=SYSTEM_MODES[_0x22d738(0x1b2)],this[_0x22d738(0x90)]=![],this[_0x22d738(0x201)]=![],this['systemUUID']=_0x22d738(0x11b),this[_0x22d738(0x12a)]=null,this[_0x22d738(0xe4)]=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this[_0x22d738(0xc2)]=null,this['on'](_0x22d738(0x16c),this[_0x22d738(0x177)][_0x22d738(0x1e3)](this)),this['on'](_0x22d738(0x1c7),this['onStateChange'][_0x22d738(0x1e3)](this)),this['on'](_0x22d738(0x143),this['onUnload'][_0x22d738(0x1e3)](this)),this['on']('message',this[_0x22d738(0x13b)]['bind'](this));}async[a0_0x39faf7(0x177)](){const _0x2dae7f=a0_0x39faf7;this[_0x2dae7f(0x165)]['info'](_0x2dae7f(0x136)+this['version']+_0x2dae7f(0x17a)),await this[_0x2dae7f(0x1ea)](),this[_0x2dae7f(0x190)][_0x2dae7f(0x121)]=this[_0x2dae7f(0x190)][_0x2dae7f(0x121)]||'';try{this[_0x2dae7f(0x90)]=await this[_0x2dae7f(0x1cb)](this['config'][_0x2dae7f(0x121)]);}catch(_0x1e924a){}if(!this[_0x2dae7f(0x190)]['inactivityThresholdHours']||this['config']['inactivityThresholdHours']<0.1)this[_0x2dae7f(0x190)]['inactivityThresholdHours']=0xc;await this[_0x2dae7f(0x1ad)](),await this[_0x2dae7f(0x188)]();if(this[_0x2dae7f(0x190)][_0x2dae7f(0x1d3)])try{this['genAI']=new GoogleGenerativeAI(this['config'][_0x2dae7f(0x1d3)]),this['geminiModel']=this[_0x2dae7f(0xdc)][_0x2dae7f(0xa5)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2dae7f(0x1cf)}}),this[_0x2dae7f(0x165)][_0x2dae7f(0x9e)]('Gemini\x20AI\x20initialized.');}catch(_0x451378){this[_0x2dae7f(0x165)][_0x2dae7f(0x1cc)](_0x2dae7f(0x127)+_0x451378[_0x2dae7f(0x105)]);}await this[_0x2dae7f(0x19a)](),await this[_0x2dae7f(0xa6)](),await this[_0x2dae7f(0x13c)](),await this['loadDailyDigests'](),this[_0x2dae7f(0x1b5)](_0x2dae7f(0x16f)),this[_0x2dae7f(0x1b5)](LTM_DP_TRIGGER_DIGEST),this[_0x2dae7f(0x1b5)]('system.mode'),this[_0x2dae7f(0x1b5)](_0x2dae7f(0x1e1)),this[_0x2dae7f(0x1b5)]('analysis.isAlert'),await this[_0x2dae7f(0x15b)](),await this[_0x2dae7f(0x149)](),await this[_0x2dae7f(0x198)]();if(this[_0x2dae7f(0x12a)])clearInterval(this[_0x2dae7f(0x12a)]);const _0x103191=this[_0x2dae7f(0x190)][_0x2dae7f(0xf5)]||0xf;_0x103191>0x0&&(this[_0x2dae7f(0x165)]['info'](_0x2dae7f(0x196)+_0x103191+_0x2dae7f(0x1a3)),this[_0x2dae7f(0x12a)]=setInterval(()=>{const _0x1836fe=_0x2dae7f;this[_0x1836fe(0x16e)]();},_0x103191*0x3c*0x3e8)),this[_0x2dae7f(0x137)](),this[_0x2dae7f(0xe1)](),this[_0x2dae7f(0x150)](),this[_0x2dae7f(0x1ae)]();}['onUnload'](_0x2eef40){const _0x4cee13=a0_0x39faf7;if(this[_0x4cee13(0x12a)])clearInterval(this[_0x4cee13(0x12a)]);if(this[_0x4cee13(0x1c4)])clearInterval(this[_0x4cee13(0x1c4)]);if(this[_0x4cee13(0xe4)])this['ltmJob'][_0x4cee13(0x194)]();if(this[_0x4cee13(0x1fa)])this[_0x4cee13(0x1fa)][_0x4cee13(0x194)]();if(this['briefingJob'])this[_0x4cee13(0xc2)][_0x4cee13(0x194)]();if(this[_0x4cee13(0xff)])clearTimeout(this['exitTimer']);if(this[_0x4cee13(0xad)])clearTimeout(this[_0x4cee13(0xad)]);_0x2eef40();}async[a0_0x39faf7(0x1ee)](_0x4d269a,_0x4fd703){const _0x28b305=a0_0x39faf7;if(!_0x4fd703)return;if(_0x4d269a[_0x28b305(0xb1)](_0x28b305(0xd2))&&_0x4d269a[_0x28b305(0x1b8)](_0x28b305(0xa9))&&_0x4fd703[_0x28b305(0x1d2)]){await this[_0x28b305(0x8f)](_0x4fd703[_0x28b305(0x1d2)]);return;}if(_0x4d269a===this[_0x28b305(0x14e)]+'.'+SYSTEM_DP_MODE){_0x4fd703[_0x28b305(0x1d2)]&&Object[_0x28b305(0xf8)](SYSTEM_MODES)[_0x28b305(0xb1)](_0x4fd703[_0x28b305(0x1d2)])&&(this[_0x28b305(0x174)]=_0x4fd703['val'],_0x4fd703['val']===SYSTEM_MODES[_0x28b305(0x18f)]?await this[_0x28b305(0x1e2)](![]):await this['setPresence'](!![]));if(!_0x4fd703[_0x28b305(0x176)])this[_0x28b305(0x12b)](_0x4d269a,{'val':this[_0x28b305(0x174)],'ack':!![]});return;}if(!_0x4fd703['ack']){_0x4d269a[_0x28b305(0xb1)](_0x28b305(0x16f))&&_0x4fd703[_0x28b305(0x1d2)]&&(this[_0x28b305(0x12b)](_0x4d269a,{'val':![],'ack':!![]}),this[_0x28b305(0xe2)]());if(_0x4d269a[_0x28b305(0xb1)](_0x28b305(0x91))&&_0x4fd703['val']){this[_0x28b305(0x12b)](_0x4d269a,{'val':![],'ack':!![]});if(this[_0x28b305(0x90)])this[_0x28b305(0xc1)]();}_0x4d269a[_0x28b305(0xb1)](_0x28b305(0xda))&&_0x4fd703[_0x28b305(0x1d2)]&&(this[_0x28b305(0x12b)](_0x4d269a,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this[_0x28b305(0x190)][_0x28b305(0x18c)]&&this[_0x28b305(0x190)][_0x28b305(0x18c)][_0x28b305(0xb1)](_0x4d269a)){await this[_0x28b305(0xe5)]();return;}const _0x589f74=(this[_0x28b305(0x190)][_0x28b305(0x153)]||[])['find'](_0x368acb=>_0x368acb['id']===_0x4d269a);if(_0x589f74)this['processSensorEvent'](_0x4d269a,_0x4fd703,_0x589f74);}async[a0_0x39faf7(0x198)](){const _0x1cead8=a0_0x39faf7,_0x2126c7=this['config'][_0x1cead8(0x1bf)];this[_0x1cead8(0x190)][_0x1cead8(0x1fc)]&&_0x2126c7&&(this['log'][_0x1cead8(0x9e)](_0x1cead8(0x12d)+_0x2126c7+'\x20for\x20interactive\x20buttons...'),await this[_0x1cead8(0x186)](_0x2126c7+_0x1cead8(0x19f)));}async[a0_0x39faf7(0x8f)](_0x289be0){const _0x36f048=a0_0x39faf7;let _0x416931=_0x289be0;_0x289be0['startsWith']('[')&&(_0x416931=_0x289be0['substring'](_0x289be0[_0x36f048(0x1ef)](']')+0x1));if(_0x416931===_0x36f048(0x18e))this[_0x36f048(0x165)]['info']('âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.'),await this[_0x36f048(0x156)](_0x36f048(0x1e7),{'val':![],'ack':!![]}),await this[_0x36f048(0x156)](_0x36f048(0x11f),{'val':'Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ack':!![]}),this[_0x36f048(0x201)]=![],this['sendNotification'](_0x36f048(0x117),![]);else _0x416931==='COGNI_REQUEST_CALL'&&(this[_0x36f048(0x165)]['warn'](_0x36f048(0x14c)),this[_0x36f048(0xaa)]('ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]));}async[a0_0x39faf7(0x13b)](_0x50576e){const _0x463391=a0_0x39faf7;if(typeof _0x50576e===_0x463391(0x1fe)&&_0x50576e['message'])try{if(_0x50576e[_0x463391(0x10a)]===_0x463391(0x1ed)){}else{if(_0x50576e['command']===_0x463391(0x8e)){const _0x5d3188=await this[_0x463391(0xaa)](_0x463391(0x1f9),!![],!![]);this[_0x463391(0x119)](_0x50576e[_0x463391(0x1d8)],_0x50576e[_0x463391(0x10a)],{'success':_0x5d3188>0x0,'message':_0x5d3188+_0x463391(0xca)},_0x50576e[_0x463391(0x109)]);}else{if(_0x50576e[_0x463391(0x10a)]===_0x463391(0x1d9)){if(!this['isProVersion'])return this['sendTo'](_0x50576e[_0x463391(0x1d8)],_0x50576e['command'],{'success':![],'isPro':![]},_0x50576e[_0x463391(0x109)]);let _0x1e4e14={'status':_0x463391(0x9a),'details':'','lastCheck':0x0};try{_0x1e4e14['status']=(await this[_0x463391(0x1c2)](LTM_DP_DRIFT_STATUS))[_0x463391(0x1d2)],_0x1e4e14[_0x463391(0x1de)]=(await this[_0x463391(0x1c2)](LTM_DP_DRIFT_DETAILS))['val'],_0x1e4e14[_0x463391(0x1ba)]=(await this[_0x463391(0x1c2)](LTM_DP_DRIFT_LAST_CHECK))[_0x463391(0x1d2)];}catch(_0x4b4d5a){}const _0x13d446=this[_0x463391(0xa4)]||[];this[_0x463391(0x119)](_0x50576e['from'],_0x50576e[_0x463391(0x10a)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x463391(0xdb)],'driftAnalysis':_0x1e4e14,'analysisHistory':_0x13d446},_0x50576e[_0x463391(0x109)]);}else{if(_0x50576e['command']===_0x463391(0x132)){const _0x2873f0=this[_0x463391(0xdb)][_0x463391(0x10f)],_0x4f1901=this[_0x463391(0x19d)]['filter'](_0x20f25c=>_0x20f25c['timestamp']>new Date()[_0x463391(0xdf)](0x0,0x0,0x0,0x0))['length'];let _0x1d7439={'status':_0x463391(0x9a)};try{_0x1d7439[_0x463391(0xb7)]=(await this[_0x463391(0x1c2)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x2b59cb){}let _0x5c1512=null;!this[_0x463391(0x161)]&&(_0x5c1512=this['config'][_0x463391(0x1d3)]?_0x463391(0xe6):_0x463391(0x128));let _0x47f1c1={'detected':![],'description':''};try{const _0x4d202a=await this['getStateAsync']('analysis.automation.patternDetected'),_0x2d7f82=await this[_0x463391(0x1c2)](_0x463391(0x1ec));_0x4d202a&&_0x4d202a[_0x463391(0x1d2)]&&(_0x47f1c1[_0x463391(0x1f3)]=!![],_0x47f1c1[_0x463391(0x11d)]=_0x2d7f82?_0x2d7f82[_0x463391(0x1d2)]:'');}catch(_0x12eae2){}this['sendTo'](_0x50576e[_0x463391(0x1d8)],_0x50576e['command'],{'success':!![],'eventHistory':this[_0x463391(0x19d)][_0x463391(0x114)](0x0,0xf),'stats':{'digestCount':_0x2873f0,'eventCountToday':_0x4f1901,'driftStatus':_0x1d7439['status'],'isPresent':this[_0x463391(0x18a)],'minDays':this['config'][_0x463391(0x154)]||0x7,'stbDays':this[_0x463391(0x190)][_0x463391(0x8b)]||0xe,'ltbDays':this[_0x463391(0x190)][_0x463391(0x1ce)]||0x3c,'systemError':_0x5c1512},'automation':_0x47f1c1},_0x50576e[_0x463391(0x109)]);}else{if(_0x50576e[_0x463391(0x10a)]===_0x463391(0x111)){}else{if(_0x50576e[_0x463391(0x10a)]===_0x463391(0x1f2))try{const _0x272709=await this[_0x463391(0xba)](_0x50576e[_0x463391(0x105)]||{});this[_0x463391(0x119)](_0x50576e['from'],_0x50576e['command'],{'success':!![],'devices':_0x272709},_0x50576e[_0x463391(0x109)]);}catch(_0x51893b){this['sendTo'](_0x50576e['from'],_0x50576e[_0x463391(0x10a)],{'success':![],'error':_0x51893b[_0x463391(0x105)]},_0x50576e[_0x463391(0x109)]);}}}}}}}catch(_0x2376c7){}}async[a0_0x39faf7(0xbc)](_0x253b5d,_0x130b1f,_0x5caa06){const _0x594721=a0_0x39faf7;if(!_0x5caa06[_0x594721(0xe7)]&&this[_0x594721(0x126)][_0x253b5d]===_0x130b1f['val'])return;this['sensorLastValues'][_0x253b5d]=_0x130b1f[_0x594721(0x1d2)];if(this[_0x594721(0x1da)])return;const _0x5c40c0=await this['checkWifiPresence']();if(_0x5c40c0){if(!this[_0x594721(0x18a)])await this[_0x594721(0x1e2)](!![]);}else{const _0x483466=_0x5caa06[_0x594721(0x15d)]===!![];if(_0x483466)this[_0x594721(0xb3)]();else{if(this['exitTimer'])this[_0x594721(0x17e)]();if(!this[_0x594721(0x18a)]&&this['currentSystemMode']===SYSTEM_MODES['NORMAL'])await this[_0x594721(0x1e2)](!![]);}}const _0x42ce8a={'timestamp':_0x130b1f['ts'],'id':_0x253b5d,'name':_0x5caa06['name'],'value':_0x130b1f['val'],'location':_0x5caa06[_0x594721(0x17c)],'type':_0x5caa06['type']};this['eventHistory'][_0x594721(0x1f5)](_0x42ce8a);if(this[_0x594721(0x19d)][_0x594721(0x10f)]>HISTORY_MAX_SIZE)this[_0x594721(0x19d)]['pop']();await this['setStateAsync']('events.lastEvent',{'val':JSON[_0x594721(0xcd)](_0x42ce8a),'ack':!![]}),await this['setStateAsync']('events.history',{'val':JSON[_0x594721(0xcd)](this[_0x594721(0x19d)]),'ack':!![]}),this[_0x594721(0xc6)][_0x594721(0xd6)]({'timestamp':new Date(_0x130b1f['ts'])[_0x594721(0xa0)](),'sensorName':_0x5caa06[_0x594721(0x199)],'location':_0x5caa06[_0x594721(0x17c)],'value':_0x130b1f[_0x594721(0x1d2)]}),await this[_0x594721(0xd7)]();}async[a0_0x39faf7(0xe2)](_0x2d9d7a=''){const _0x5ca449=a0_0x39faf7;if(!this['geminiModel']){this['log'][_0x5ca449(0x1d5)]('Triggered\x20analysis\x20but\x20Gemini\x20AI\x20is\x20not\x20initialized!\x20Check\x20API\x20Key.');return;}const _0x49e40f=this[_0x5ca449(0x19d)][_0x5ca449(0x10f)]>0x0?this[_0x5ca449(0x19d)]:[{'note':_0x5ca449(0x123)}],_0x3bff4d=PERSONA_MAPPING[this[_0x5ca449(0x190)][_0x5ca449(0xb6)]||_0x5ca449(0x9c)],_0x524ada=this[_0x5ca449(0x190)][_0x5ca449(0x140)]||'',_0x598a4e=this['currentSystemMode'],_0x4bbfb4=await this['getWeatherContext'](),_0x104540=await this[_0x5ca449(0x1a4)](),_0x4f9eb1=(_0x4bbfb4+'\x20'+_0x104540)[_0x5ca449(0x9f)](),_0x5c42f8=new Date(),_0x107879=_0x5c42f8['toLocaleString']('de-DE',{'weekday':'long','hour':'2-digit','minute':_0x5ca449(0x1af)});let _0x2711ae='Phase\x201:\x20Learning\x20(No\x20Baseline).\x20Rely\x20on\x20common\x20sense.';const _0x185afb=this[_0x5ca449(0xdb)][_0x5ca449(0x10f)];if(this['isProVersion']&&_0x185afb>=(this[_0x5ca449(0x190)][_0x5ca449(0x154)]||0x7)){const _0x5e5e65=this[_0x5ca449(0xdb)][_0x5ca449(0x114)](-(this[_0x5ca449(0x190)]['ltmStbWindowDays']||0xe));_0x2711ae=_0x5ca449(0x189)+JSON[_0x5ca449(0xcd)](_0x5e5e65)+'.';if(_0x185afb>=0x1e)_0x2711ae+=_0x5ca449(0x197);}const _0x3c9794=_0x5ca449(0xb5)+_0x107879+')\x20verdÃ¤chtig\x20still?\x20Erwartest\x20du\x20basierend\x20auf\x20der\x20Tageszeit\x20AktivitÃ¤t\x20(z.B.\x20Morgens\x20Aufstehen)?\x20Wenn\x20ja\x20->\x20ALARM.\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20Akut\x20(vs.\x20STB):\x20Weicht\x20das\x20heutige\x20Verhalten\x20stark\x20von\x20den\x20letzten\x2014\x20Tagen\x20ab?\x20(z.B.\x205x\x20Toilette\x20statt\x203x).\x20Wenn\x20ja\x20->\x20WARNUNG.\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20Schleichend\x20(Drift):\x20(Nur\x20relevant\x20wenn\x20Phase\x203\x20aktiv)\x20Gibt\x20es\x20einen\x20langsamen\x20Trend\x20ins\x20Negative?\x0a\x20\x20\x20\x20\x20\x20\x20\x20Ignoriere\x20Fehlalarme\x20durch\x20Kontext:\x20'+_0x4f9eb1+_0x5ca449(0x1b0),_0x4277a9=_0x5ca449(0xf9)+_0x107879+_0x5ca449(0x1bc)+_0x598a4e+'.\x20PRÃ„SENZ:\x20'+(this[_0x5ca449(0x18a)]?'Ja':_0x5ca449(0x1a5))+'.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20'+_0x524ada+_0x5ca449(0x180)+_0x3bff4d+_0x5ca449(0x1b3)+_0x2711ae+'\x20'+(_0x2d9d7a?_0x2d9d7a:'')+_0x5ca449(0x1b0)+_0x3c9794+_0x5ca449(0xe0)+JSON[_0x5ca449(0xcd)](_0x49e40f)+_0x5ca449(0x1ca);try{const _0x2a2d9f=await this[_0x5ca449(0x161)][_0x5ca449(0x1f4)](_0x4277a9),_0xb73040=_0x2a2d9f['response'][_0x5ca449(0xa2)]()['replace'](/```json|```/g,'')[_0x5ca449(0x9f)](),_0x542b3c=JSON[_0x5ca449(0xfa)](_0xb73040);await this[_0x5ca449(0x156)]('analysis.lastResult',{'val':_0xb73040,'ack':!![]}),await this[_0x5ca449(0x156)](_0x5ca449(0x11f),{'val':_0x542b3c[_0x5ca449(0x1c0)][_0x5ca449(0x1e0)]||'','ack':!![]}),await this[_0x5ca449(0x156)](_0x5ca449(0xb0),{'val':_0x542b3c['activity'][_0x5ca449(0x1d7)]||_0x5ca449(0x9a),'ack':!![]});const _0x126e41=_0x542b3c[_0x5ca449(0xeb)][_0x5ca449(0x134)],_0x34b6c8=this[_0x5ca449(0x90)]?_0x126e41[_0x5ca449(0x130)]:![];await this[_0x5ca449(0x156)]('analysis.automation.patternDetected',{'val':_0x34b6c8,'ack':!![]});let _0x2d0cef='Pro\x20Feature';if(this[_0x5ca449(0x90)])_0x2d0cef=_0x34b6c8?_0x126e41[_0x5ca449(0x11d)]:_0x5ca449(0xf4);await this[_0x5ca449(0x156)]('analysis.automation.description',{'val':_0x2d0cef,'ack':!![]});if(_0x542b3c[_0x5ca449(0x1c0)][_0x5ca449(0xb4)]||_0x542b3c['activity'][_0x5ca449(0x1c1)]){await this[_0x5ca449(0x156)]('analysis.isAlert',{'val':!![],'ack':!![]});if(!this['lastAlertState']||_0x542b3c[_0x5ca449(0x1c0)][_0x5ca449(0x1c1)]){const _0x74dcd5=_0x542b3c['activity'][_0x5ca449(0x1c1)]?_0x5ca449(0x200):'âš ï¸\x20Alarm';this[_0x5ca449(0xaa)](_0x74dcd5+':\x20'+_0x542b3c['activity'][_0x5ca449(0x1e0)],![],_0x542b3c[_0x5ca449(0x1c0)][_0x5ca449(0x1c1)]);}}else await this['setStateAsync'](_0x5ca449(0x1e7),{'val':![],'ack':!![]});this[_0x5ca449(0x201)]=_0x542b3c[_0x5ca449(0x1c0)]['isAlert']||_0x542b3c[_0x5ca449(0x1c0)][_0x5ca449(0x1c1)];const _0x120985={'timestamp':Date[_0x5ca449(0xdd)](),'id':Date[_0x5ca449(0xdd)]()[_0x5ca449(0xe9)](),'analysis':_0x542b3c,'systemMode':_0x598a4e,'isPro':this[_0x5ca449(0x90)]};this[_0x5ca449(0x1a9)](_0x120985);}catch(_0x5224f8){this['log'][_0x5ca449(0x1cc)]('Analysis\x20Error:\x20'+_0x5224f8[_0x5ca449(0x105)]);}}async[a0_0x39faf7(0x16e)](){const _0x5c7e24=a0_0x39faf7,_0x81f88f=this[_0x5c7e24(0x190)]['inactivityThresholdHours'],_0x152a70=this['eventHistory'][_0x5c7e24(0x10f)]>0x0?this[_0x5c7e24(0x19d)][0x0][_0x5c7e24(0x1f0)]:Date[_0x5c7e24(0xdd)](),_0x2888b1=(Date[_0x5c7e24(0xdd)]()-_0x152a70)/(0x3e8*0x3c*0x3c);let _0x46ece2='';this[_0x5c7e24(0x190)]['inactivityMonitoringEnabled']&&this[_0x5c7e24(0x174)]===SYSTEM_MODES[_0x5c7e24(0x1b2)]&&this[_0x5c7e24(0x18a)]&&(_0x2888b1>_0x81f88f&&(_0x46ece2=_0x5c7e24(0x135)+_0x2888b1[_0x5c7e24(0x108)](0x1)+_0x5c7e24(0xd0))),this[_0x5c7e24(0xe2)](_0x46ece2)[_0x5c7e24(0x1e5)](_0xd9b8b7=>this[_0x5c7e24(0x165)][_0x5c7e24(0x1cc)](_0xd9b8b7));}async[a0_0x39faf7(0xc1)](){}async[a0_0x39faf7(0x1d0)](){}async['scanForDevices'](_0x52ec94){return[];}[a0_0x39faf7(0x14d)](_0x4fb7cb){const _0x23d5a6=a0_0x39faf7;if(typeof _0x4fb7cb==='object')return _0x4fb7cb;try{return JSON[_0x23d5a6(0xfa)](_0x4fb7cb);}catch(_0x131095){return null;}}async[a0_0x39faf7(0x1ea)](){}async[a0_0x39faf7(0x1ad)](){const _0x283cbc=a0_0x39faf7;try{const _0x3dfb5c=await this[_0x283cbc(0x1c2)](_0x283cbc(0x10b));_0x3dfb5c&&_0x3dfb5c[_0x283cbc(0x1d2)]&&(this[_0x283cbc(0x19d)]=JSON[_0x283cbc(0xfa)](_0x3dfb5c[_0x283cbc(0x1d2)][_0x283cbc(0xe9)]()));}catch(_0xb4c1){this['eventHistory']=[];}try{const _0x52879c=await this[_0x283cbc(0x1c2)](_0x283cbc(0xd5));if(_0x52879c&&_0x52879c[_0x283cbc(0x1d2)])this[_0x283cbc(0xa4)]=JSON[_0x283cbc(0xfa)](_0x52879c[_0x283cbc(0x1d2)][_0x283cbc(0xe9)]());}catch(_0x2538ed){this[_0x283cbc(0xa4)]=[];}}async[a0_0x39faf7(0x188)](){const _0x5474a7=a0_0x39faf7;try{const _0x5a2124=await this[_0x5474a7(0x1eb)](_0x5474a7(0x104));_0x5a2124&&_0x5a2124[_0x5474a7(0x122)]&&(this[_0x5474a7(0xf0)]={'latitude':_0x5a2124[_0x5474a7(0x122)]['latitude']||0x0,'longitude':_0x5a2124['common']['longitude']||0x0,'city':_0x5a2124[_0x5474a7(0x122)][_0x5474a7(0x175)]||''});}catch(_0x1d1e6c){}}async['checkLicense'](_0x6fe5a2){const _0x1a527f=a0_0x39faf7;if(!_0x6fe5a2)return![];this[_0x1a527f(0x173)]=await this['getSystemUUID']();if(_0x6fe5a2===_0x1a527f(0x116)||_0x6fe5a2[_0x1a527f(0x1ac)](_0x1a527f(0x1a0)))return!![];return![];}async[a0_0x39faf7(0x11e)](){const _0x3d9e28=a0_0x39faf7;try{const _0x60da3f=await this[_0x3d9e28(0x1eb)](_0x3d9e28(0x13a));if(_0x60da3f&&_0x60da3f['native']&&_0x60da3f['native']['uuid'])return _0x60da3f['native'][_0x3d9e28(0x147)];return _0x3d9e28(0x14f);}catch(_0xa78d11){return _0x3d9e28(0xce);}}async[a0_0x39faf7(0x19a)](){}async[a0_0x39faf7(0x184)](){const _0x30b32a=a0_0x39faf7;await this[_0x30b32a(0x181)](_0x30b32a(0x160),{'type':_0x30b32a(0x1b6),'common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x30b32a(0x162),'common':{'name':_0x30b32a(0xfb),'type':_0x30b32a(0x110),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x30b32a(0x1b2)],'states':{[SYSTEM_MODES[_0x30b32a(0x1b2)]]:_0x30b32a(0x168),[SYSTEM_MODES[_0x30b32a(0x18f)]]:_0x30b32a(0x1fd),[SYSTEM_MODES[_0x30b32a(0x13d)]]:_0x30b32a(0x1be),[SYSTEM_MODES[_0x30b32a(0x102)]]:_0x30b32a(0x10d)}},'native':{}});}async['checkLtmObjects'](){const _0x8e72d0=a0_0x39faf7;await this[_0x8e72d0(0x181)](_0x8e72d0(0x18d),{'type':_0x8e72d0(0x1b6),'common':{'name':_0x8e72d0(0x18d)},'native':{}}),await this[_0x8e72d0(0x181)](LTM_DP_RAW_LOG,{'type':_0x8e72d0(0x162),'common':{'name':'Raw\x20Log','type':'string','role':_0x8e72d0(0x1a1),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x8e72d0(0x162),'common':{'name':_0x8e72d0(0x1e8),'type':'string','role':_0x8e72d0(0x1a1),'read':!![],'write':![]},'native':{}}),await this[_0x8e72d0(0x181)](LTM_DP_STATUS,{'type':'state','common':{'name':'Processing\x20Status','type':_0x8e72d0(0x110),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x8e72d0(0x181)](LTM_DP_TRIGGER_DIGEST,{'type':_0x8e72d0(0x162),'common':{'name':'Trigger\x20Digest','type':_0x8e72d0(0xbf),'role':_0x8e72d0(0x112),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x8e72d0(0x181)](LTM_DP_BASELINE_STATUS,{'type':_0x8e72d0(0x162),'common':{'name':_0x8e72d0(0x13e),'type':'string','role':_0x8e72d0(0xa2),'read':!![],'write':![]},'native':{}});}async['checkLtmDriftObjects'](){const _0x2d2170=a0_0x39faf7;await this[_0x2d2170(0x181)](LTM_DP_DRIFT_CHANNEL,{'type':_0x2d2170(0x1b6),'common':{'name':_0x2d2170(0xc7)},'native':{}}),await this[_0x2d2170(0x181)](LTM_DP_DRIFT_STATUS,{'type':_0x2d2170(0x162),'common':{'name':'Drift\x20Status','type':_0x2d2170(0x110),'role':'state','read':!![],'write':![],'def':_0x2d2170(0x9a)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':_0x2d2170(0x110),'role':_0x2d2170(0xa2),'read':!![],'write':![]},'native':{}}),await this[_0x2d2170(0x181)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x2d2170(0x162),'common':{'name':'Last\x20Check','type':'number','role':_0x2d2170(0x195),'read':!![],'write':![]},'native':{}});}async[a0_0x39faf7(0xa6)](){const _0x94502c=a0_0x39faf7;try{const _0x5e60fc=await this['getStateAsync'](SYSTEM_DP_MODE);_0x5e60fc&&_0x5e60fc[_0x94502c(0x1d2)]&&Object[_0x94502c(0xf8)](SYSTEM_MODES)[_0x94502c(0xb1)](_0x5e60fc[_0x94502c(0x1d2)])?this[_0x94502c(0x174)]=_0x5e60fc[_0x94502c(0x1d2)]:(this[_0x94502c(0x174)]=SYSTEM_MODES[_0x94502c(0x1b2)],await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x94502c(0x1b2)],'ack':!![]}));}catch(_0x25e64a){this['currentSystemMode']=SYSTEM_MODES[_0x94502c(0x1b2)];}}async[a0_0x39faf7(0x13c)](){const _0x19c8bb=a0_0x39faf7;try{const _0x4a41f6=await this[_0x19c8bb(0x1c2)](LTM_DP_RAW_LOG);if(_0x4a41f6&&_0x4a41f6['val'])this['rawEventLog']=JSON[_0x19c8bb(0xfa)](_0x4a41f6[_0x19c8bb(0x1d2)]);}catch(_0x16d8a9){this[_0x19c8bb(0xc6)]=[];}}async['saveRawEventLog'](){const _0x21002a=a0_0x39faf7;this[_0x21002a(0xc6)]['length']>RAW_LOG_MAX_SIZE&&this[_0x21002a(0xc6)][_0x21002a(0x107)](0x0,this[_0x21002a(0xc6)][_0x21002a(0x10f)]-RAW_LOG_MAX_SIZE),await this[_0x21002a(0x156)](LTM_DP_RAW_LOG,{'val':JSON[_0x21002a(0xcd)](this[_0x21002a(0xc6)]),'ack':!![]});}async['loadDailyDigests'](){const _0x488bde=a0_0x39faf7;try{const _0xb77ad1=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0xb77ad1&&_0xb77ad1[_0x488bde(0x1d2)])this[_0x488bde(0xdb)]=JSON['parse'](_0xb77ad1[_0x488bde(0x1d2)]);}catch(_0x4ac87f){this[_0x488bde(0xdb)]=[];}await this['updateBaselineStatus']();}async[a0_0x39faf7(0xf6)](_0x4ac936=!![]){const _0x5669fa=a0_0x39faf7,_0x2f3fbc=this['config'][_0x5669fa(0x1ce)]||0x3c;this[_0x5669fa(0xdb)]['length']>_0x2f3fbc&&this[_0x5669fa(0xdb)][_0x5669fa(0x107)](0x0,this['dailyDigests']['length']-_0x2f3fbc);await this[_0x5669fa(0x156)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5669fa(0xcd)](this[_0x5669fa(0xdb)]),'ack':!![]});if(_0x4ac936)await this['updateBaselineStatus']();}async[a0_0x39faf7(0x1a9)](_0x4bd6a){const _0x27515f=a0_0x39faf7;this[_0x27515f(0xa4)][_0x27515f(0x1f5)](_0x4bd6a);if(this[_0x27515f(0xa4)][_0x27515f(0x10f)]>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0x27515f(0x148)]();await this[_0x27515f(0x156)](_0x27515f(0xd5),{'val':JSON[_0x27515f(0xcd)](this[_0x27515f(0xa4)]),'ack':!![]});}async[a0_0x39faf7(0x163)](){const _0x5e3069=a0_0x39faf7;if(!this[_0x5e3069(0x90)]){await this[_0x5e3069(0x156)](LTM_DP_BASELINE_STATUS,{'val':_0x5e3069(0x169),'ack':!![]});return;}const _0x52f4b4=this[_0x5e3069(0xdb)]['length']>=(this[_0x5e3069(0x190)]['minDaysForBaseline']||0x7)?_0x5e3069(0x159)+this[_0x5e3069(0xdb)][_0x5e3069(0x10f)]+_0x5e3069(0x15a):_0x5e3069(0x131)+this['dailyDigests'][_0x5e3069(0x10f)]+'/'+(this['config']['minDaysForBaseline']||0x7)+')';await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x52f4b4,'ack':!![]});}async[a0_0x39faf7(0x15b)](){const _0x247427=a0_0x39faf7,_0x3089d3=this[_0x247427(0x190)]['devices'];if(_0x3089d3&&_0x3089d3[_0x247427(0x10f)]>0x0){this[_0x247427(0x165)]['info']('Subscribing\x20to\x20'+_0x3089d3[_0x247427(0x10f)]+_0x247427(0x1ab));for(const _0x333d71 of _0x3089d3){if(_0x333d71['id']){await this[_0x247427(0x186)](_0x333d71['id']);try{const _0x18ebd9=await this['getForeignStateAsync'](_0x333d71['id']);if(_0x18ebd9)this[_0x247427(0x126)][_0x333d71['id']]=_0x18ebd9[_0x247427(0x1d2)];}catch(_0x36903e){}}}}}async[a0_0x39faf7(0x149)](){const _0x29a1ae=a0_0x39faf7,_0x3ccd2b=this[_0x29a1ae(0x190)][_0x29a1ae(0x18c)]||[];if(_0x3ccd2b[_0x29a1ae(0x10f)]>0x0){this[_0x29a1ae(0x165)]['info']('Subscribing\x20to\x20'+_0x3ccd2b['length']+_0x29a1ae(0xbb));for(const _0x6905a3 of _0x3ccd2b){await this[_0x29a1ae(0x186)](_0x6905a3);}try{await this[_0x29a1ae(0xe5)]();}catch(_0x3f82f7){}}}async['getWeatherContext'](){const _0x5eda17=a0_0x39faf7;try{if(!this[_0x5eda17(0x190)][_0x5eda17(0x157)])return _0x5eda17(0x13f);let _0x82e2b6='';const _0x34248f=this[_0x5eda17(0x190)][_0x5eda17(0x139)];if(_0x34248f)try{if(_0x34248f[_0x5eda17(0xb1)](_0x5eda17(0x19c))){const _0x180db9=await this[_0x5eda17(0x1ff)](_0x34248f+_0x5eda17(0xbe));if(_0x180db9&&_0x180db9[_0x5eda17(0x1d2)])_0x82e2b6=_0x180db9[_0x5eda17(0x1d2)];}else{if(_0x34248f[_0x5eda17(0xb1)](_0x5eda17(0x97))){const _0x5822c6=await this[_0x5eda17(0x1ff)](_0x34248f+_0x5eda17(0x10e));if(_0x5822c6&&_0x5822c6[_0x5eda17(0x1d2)])_0x82e2b6=_0x5822c6[_0x5eda17(0x1d2)];}else{if(_0x34248f[_0x5eda17(0xb1)](_0x5eda17(0xb2))){const _0x5148de=await this['getForeignStateAsync'](_0x34248f+_0x5eda17(0xde));if(_0x5148de&&_0x5148de['val'])_0x82e2b6=_0x5148de['val'];}}}}catch(_0x2fde6d){}if(!_0x82e2b6){const _0x379b4e=[_0x5eda17(0x1cd),'daswetter.0',_0x5eda17(0xa3),_0x5eda17(0x1f1)];for(const _0x41a471 of _0x379b4e){try{const _0xcba53c=await this['getForeignObjectAsync'](_0x41a471);if(_0xcba53c){if(_0x41a471[_0x5eda17(0xb1)](_0x5eda17(0x19c))){const _0x1128e0=await this['getForeignStateAsync'](_0x41a471+_0x5eda17(0xbe));if(_0x1128e0&&_0x1128e0['val']){_0x82e2b6=_0x1128e0[_0x5eda17(0x1d2)];break;}}}}catch(_0x1b5955){}}}return _0x82e2b6?_0x5eda17(0xf3)+_0x82e2b6:_0x5eda17(0x9d);}catch(_0x2dd9ec){return _0x5eda17(0x138)+_0x2dd9ec[_0x5eda17(0x105)];}}async[a0_0x39faf7(0x1a4)](){const _0x24b1a6=a0_0x39faf7;try{if(!this[_0x24b1a6(0x190)][_0x24b1a6(0x1c9)])return _0x24b1a6(0x129);let _0x585fb2=this[_0x24b1a6(0x190)][_0x24b1a6(0x14b)]||_0x24b1a6(0x12e),_0x1d8a97=this[_0x24b1a6(0x190)][_0x24b1a6(0x120)]||[];if(typeof _0x1d8a97===_0x24b1a6(0x110))_0x1d8a97=_0x1d8a97['split'](',');try{const _0x2d6b24=await this[_0x24b1a6(0x1ff)](_0x585fb2+_0x24b1a6(0x158));if(_0x2d6b24&&_0x2d6b24[_0x24b1a6(0x1d2)]){let _0x294316=this[_0x24b1a6(0x14d)](_0x2d6b24[_0x24b1a6(0x1d2)]);if(_0x294316&&Array[_0x24b1a6(0x15c)](_0x294316)){if(_0x1d8a97[_0x24b1a6(0x10f)]>0x0)_0x294316=_0x294316[_0x24b1a6(0x1d4)](_0x27381b=>_0x1d8a97[_0x24b1a6(0xb1)](_0x27381b[_0x24b1a6(0x106)]||''));else return _0x24b1a6(0xcf);if(_0x294316[_0x24b1a6(0x10f)]>0x0){const _0xfb3bed=_0x294316[_0x24b1a6(0x114)](0x0,0x3)[_0x24b1a6(0x12c)](_0x344add=>{const _0x274c7b=_0x24b1a6;let _0x1f0f28=_0x344add[_0x274c7b(0x195)];if(_0x344add[_0x274c7b(0x146)])_0x1f0f28+='\x20'+_0x344add[_0x274c7b(0x146)];return _0x1f0f28+':\x20'+_0x344add[_0x274c7b(0x1e6)]+'\x20('+_0x344add['_calName']+')';});return _0x24b1a6(0x11a)+_0xfb3bed[_0x24b1a6(0x170)](_0x24b1a6(0xd4));}else return _0x24b1a6(0x15e);}}}catch(_0x41e097){this['log'][_0x24b1a6(0x1d5)](_0x24b1a6(0x103)+_0x41e097[_0x24b1a6(0x105)]);}return _0x24b1a6(0xfc);}catch(_0x549f70){return _0x24b1a6(0x1bd)+_0x549f70[_0x24b1a6(0x105)];}}async[a0_0x39faf7(0x178)](_0x410a7d){const _0xb2c12a=a0_0x39faf7;try{const _0x54d1ed=await this[_0xb2c12a(0x1ff)](_0x410a7d+_0xb2c12a(0x158));if(_0x54d1ed&&_0x54d1ed[_0xb2c12a(0x1d2)]){const _0x479666=this[_0xb2c12a(0x14d)](_0x54d1ed[_0xb2c12a(0x1d2)]);if(_0x479666&&Array['isArray'](_0x479666)){const _0x65996d=[...new Set(_0x479666[_0xb2c12a(0x12c)](_0x4e7f16=>_0x4e7f16[_0xb2c12a(0x106)])[_0xb2c12a(0x1d4)](Boolean))];return _0x65996d['sort']();}}return[];}catch(_0x37046e){return this[_0xb2c12a(0x165)]['error']('getCalendarNames\x20Error:\x20'+_0x37046e[_0xb2c12a(0x105)]),[];}}async[a0_0x39faf7(0xe5)](){const _0x7efa3a=a0_0x39faf7;try{const _0x38d7ca=this['config'][_0x7efa3a(0x18c)]||[];let _0x79f597=![];for(const _0x2b24f4 of _0x38d7ca){try{const _0x15acda=await this[_0x7efa3a(0x1ff)](_0x2b24f4);if(_0x15acda&&(_0x15acda[_0x7efa3a(0x1d2)]===!![]||_0x15acda[_0x7efa3a(0x1d2)]===_0x7efa3a(0x1aa)||_0x15acda[_0x7efa3a(0x1d2)]===0x1)){_0x79f597=!![];break;}}catch(_0x127190){}}return _0x79f597&&(this['exitTimer']&&(this[_0x7efa3a(0x165)]['info']('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),this['abortExitTimer']()),!this[_0x7efa3a(0x18a)]&&this[_0x7efa3a(0x174)]===SYSTEM_MODES[_0x7efa3a(0x1b2)]&&await this['setPresence'](!![])),_0x79f597;}catch(_0x37ef97){return this[_0x7efa3a(0x165)][_0x7efa3a(0x1cc)](_0x7efa3a(0x8d)+_0x37ef97['message']),![];}}[a0_0x39faf7(0xb3)](){const _0x40eeea=a0_0x39faf7;this['abortExitTimer'](),this[_0x40eeea(0x1da)]=!![],this[_0x40eeea(0xad)]=setTimeout(()=>{this['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x40eeea(0xff)]=setTimeout(()=>{const _0x2e9885=_0x40eeea;this[_0x2e9885(0x1e2)](![]),this[_0x2e9885(0xff)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x39faf7(0x17e)](){const _0x5143ea=a0_0x39faf7;if(this[_0x5143ea(0xff)])clearTimeout(this[_0x5143ea(0xff)]);if(this[_0x5143ea(0xad)])clearTimeout(this[_0x5143ea(0xad)]);this[_0x5143ea(0xff)]=null,this[_0x5143ea(0xad)]=null,this[_0x5143ea(0x1da)]=![];}async['setPresence'](_0x3719c3){const _0x432eca=a0_0x39faf7;if(this[_0x432eca(0x18a)]===_0x3719c3)return;this['isPresent']=_0x3719c3,await this[_0x432eca(0x156)](_0x432eca(0x1b7),{'val':_0x3719c3,'ack':!![]});}async['saveFeedback'](_0x120116){const _0x4bd996=a0_0x39faf7;this[_0x4bd996(0x165)]['info']('Feedback\x20saved:\x20'+JSON['stringify'](_0x120116));}async[a0_0x39faf7(0x98)](){const _0x4153bc=a0_0x39faf7;if(!this[_0x4153bc(0x90)]||!this[_0x4153bc(0x161)])return;const _0xead28c=this[_0x4153bc(0x190)][_0x4153bc(0x8b)]||0xe;if(this[_0x4153bc(0xdb)]['length']<_0xead28c+(this[_0x4153bc(0x190)][_0x4153bc(0x154)]||0x7)){await this[_0x4153bc(0x156)](LTM_DP_DRIFT_STATUS,{'val':_0x4153bc(0x164),'ack':!![]});return;}const _0x2d12e5=this[_0x4153bc(0xdb)][_0x4153bc(0x114)](-_0xead28c),_0x5dcdff=this[_0x4153bc(0xdb)][_0x4153bc(0x114)](0x0,this[_0x4153bc(0xdb)][_0x4153bc(0x10f)]-_0xead28c),_0x231bdd=_0x4153bc(0x14a)+JSON['stringify'](_0x5dcdff)+_0x4153bc(0x1a8)+JSON[_0x4153bc(0xcd)](_0x2d12e5);try{const _0x1408eb=await this[_0x4153bc(0x161)][_0x4153bc(0x1f4)](_0x231bdd),_0x1a79c8=JSON[_0x4153bc(0xfa)](_0x1408eb[_0x4153bc(0x101)][_0x4153bc(0xa2)]()[_0x4153bc(0x1db)](/```json|```/g,'')[_0x4153bc(0x9f)]());_0x1a79c8['baselineDrift']&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x1a79c8[_0x4153bc(0xf2)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x1a79c8[_0x4153bc(0xb9)],'ack':!![]}),await this[_0x4153bc(0x156)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4153bc(0xdd)](),'ack':!![]}));}catch(_0x14cb62){}}['setupLtmScheduler'](){const _0x3543f7=a0_0x39faf7;try{if(this[_0x3543f7(0xe4)])this[_0x3543f7(0xe4)]['cancel']();if(!this['isProVersion']){this[_0x3543f7(0x156)](LTM_DP_STATUS,{'val':_0x3543f7(0x169),'ack':!![]});return;}this['ltmJob']=schedule[_0x3543f7(0x10c)](LTM_SCHEDULE,()=>this['createDailyDigest']());}catch(_0x39a45f){this[_0x3543f7(0x165)][_0x3543f7(0x1cc)](_0x3543f7(0x166)+_0x39a45f[_0x3543f7(0x105)]);}}[a0_0x39faf7(0xe1)](){const _0xf72db7=a0_0x39faf7;try{if(this[_0xf72db7(0x1fa)])this[_0xf72db7(0x1fa)]['cancel']();this['modeResetJob']=schedule[_0xf72db7(0x10c)](MODE_RESET_SCHEDULE,async()=>{const _0x55b8f9=_0xf72db7;await this[_0x55b8f9(0xa6)](),AUTO_RESET_MODES[_0x55b8f9(0xb1)](this[_0x55b8f9(0x174)])&&await this[_0x55b8f9(0x156)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x1ca7e1){this[_0xf72db7(0x165)][_0xf72db7(0x1cc)]('Reset\x20Sched\x20Error:\x20'+_0x1ca7e1['message']);}}[a0_0x39faf7(0x150)](){const _0x485d88=a0_0x39faf7;try{if(this[_0x485d88(0x1c4)])clearInterval(this['driftAnalysisTimer']);if(!this[_0x485d88(0x90)])return;this[_0x485d88(0x1c4)]=setInterval(()=>this['runBaselineDriftAnalysis'](),(this['config'][_0x485d88(0xcc)]||0x18)*0x36ee80),setTimeout(()=>this[_0x485d88(0x98)](),0x1388);}catch(_0x57b360){this[_0x485d88(0x165)][_0x485d88(0x1cc)]('Drift\x20Sched\x20Error:\x20'+_0x57b360[_0x485d88(0x105)]);}}['setupBriefingScheduler'](){const _0x105513=a0_0x39faf7;try{if(this['briefingJob'])this[_0x105513(0xc2)]['cancel']();if(!this[_0x105513(0x190)][_0x105513(0xee)])return;const _0xf8076f=(this[_0x105513(0x190)][_0x105513(0xa8)]||_0x105513(0x155))[_0x105513(0x94)](':'),_0x3fed82=parseInt(_0xf8076f[0x0])||0x8,_0x3cd470=parseInt(_0xf8076f[0x1])||0x0,_0x43c317=_0x3cd470+'\x20'+_0x3fed82+_0x105513(0xd1);this[_0x105513(0x165)][_0x105513(0x9e)](_0x105513(0x1e9)+_0x3fed82+':'+(_0x3cd470<0xa?'0'+_0x3cd470:_0x3cd470)),this[_0x105513(0xc2)]=schedule['scheduleJob'](_0x43c317,()=>{const _0x3949d5=_0x105513;this[_0x3949d5(0x1d0)]();});}catch(_0x552805){this[_0x105513(0x165)][_0x105513(0x1cc)]('Briefing\x20Sched\x20Error:\x20'+_0x552805[_0x105513(0x105)]);}}async[a0_0x39faf7(0xaa)](_0x17aa5d,_0x54e2dc=![],_0x2a2459=![]){const _0x57b009=a0_0x39faf7;this[_0x57b009(0x165)][_0x57b009(0x9e)]((_0x54e2dc?'[TEST]\x20':'')+_0x57b009(0x1c8)+_0x17aa5d+'\x22');const _0x1f22cf=this[_0x57b009(0x190)];let _0x12cf4f=0x0;if(_0x1f22cf[_0x57b009(0x1fc)]&&_0x1f22cf[_0x57b009(0x1bf)]){let _0x495105={};(_0x17aa5d[_0x57b009(0xb1)](_0x57b009(0x96))||_0x2a2459)&&(_0x495105={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':_0x57b009(0x18e)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x57b009(0x1d6)}]]}}),await this[_0x57b009(0xed)](_0x1f22cf[_0x57b009(0x1bf)],_0x57b009(0x11c),{'text':_0x17aa5d,'user':_0x1f22cf[_0x57b009(0x151)],..._0x495105}),_0x12cf4f++;}if(_0x1f22cf[_0x57b009(0x1dc)]&&_0x1f22cf[_0x57b009(0x100)]){let _0x423762={'message':_0x17aa5d,'title':_0x2a2459?_0x57b009(0xcb):_0x57b009(0x183),'priority':_0x2a2459?0x2:0x1,'device':_0x1f22cf[_0x57b009(0x92)]};_0x2a2459&&(_0x423762[_0x57b009(0x1e4)]=0x1e,_0x423762[_0x57b009(0x1c5)]=0xe10,_0x423762[_0x57b009(0x16b)]=_0x57b009(0x118)),await this[_0x57b009(0xed)](_0x1f22cf[_0x57b009(0x100)],_0x57b009(0x11c),_0x423762),_0x12cf4f++;}return _0x1f22cf[_0x57b009(0xec)]&&_0x1f22cf[_0x57b009(0xa7)]&&(await this[_0x57b009(0xed)](_0x1f22cf['notifyEmailInstance'],_0x57b009(0x11c),{'text':_0x17aa5d,'to':_0x1f22cf[_0x57b009(0x1c6)]}),_0x12cf4f++),_0x12cf4f;}}function a0_0x4b40(_0x5633b6,_0x11b34e){const _0x581070=a0_0x3944();return a0_0x4b40=function(_0x508f11,_0x551b4d){_0x508f11=_0x508f11-0x8a;let _0x39445d=_0x581070[_0x508f11];return _0x39445d;},a0_0x4b40(_0x5633b6,_0x11b34e);}if(require[a0_0x39faf7(0xac)]!==module)module[a0_0x39faf7(0x145)]=_0x2f4943=>new CogniLiving(_0x2f4943);else new CogniLiving();