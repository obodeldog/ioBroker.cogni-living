function a0_0x2bf6(){const _0x35da37=['object','now','analysis.energy.insulationScore','createAllObjects','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','geminiModel','startSystem','sort','Current.WeatherText','setPresence','scanDevices','notifyTelegramInstance','scanForDevices','exitGraceTimer','158934rYhDCU','145857umvVRZ','forEach','motion','system.presenceWho','subscribeForeignStatesAsync','checkThermostats','isPresent','\x20min\x20ausbleiben.','triggerGaitAnalysis','timestamp','version','abortExitTimer','system.mode','SYSTEM_MODES','initHistory','main','analysisInterval','system.adapter.','getCalendarNames','.system.mode','analysis.training.triggerComfort','getForeignObjectAsync','automation.triggerAction','updateLocation','inactivityThresholdHours','matrix','pop','sunny','some','analysis.trigger','triggerBriefing','map','unload','TRAIN_SECURITY','temperature','8474488NNJNLW','sendMorningBriefing','runAutopilot','string','LTM.rawEventLog','enum.functions.*','./lib/recorder','toLowerCase','Adapter','analysis.energy.warmupTimes','runBaselineDriftAnalysis','processSensorEvent','getForeignStateAsync','constructor','updateTopologyMatrix','models/gemini-flash-latest','callback','common','analysis.energy.pinnForecast','checkSolarCondition','./lib/python_bridge','isGracePeriodActive','isSolar','onStateChange','lastAlertState','Lernphase\x20(','name','abs','PYTHON_EXE','sensorLastValues','state','info','dailyDigests','getForeignObjectsAsync','enum','onReady','location','TRAIN_COMFORT','toString','TRAIN_ENERGY','getLtmData','driftAnalysisTimer','ltmJob','./lib/scanner','2074385ztCmUT','currentSystemMode','startService','communicate.request','triggerEnergyPrediction','analysis.automation.targetValue','Gemini\x20AI\x20initialized.','command','simulateButler','Notification\x20Test\x20Failed:\x20','stringify','calendarName','Verbindung\x20erfolgreich!','parse','triggerDailyDigest','enum.rooms.*','checkWifiPresence','setupDriftAnalysisScheduler','Standard','analysis.training.status','_calName','analysis.automation.targetId','PREDICT_ENERGY','Simulation\x20durch\x20Admin\x20(Test)','getTime','./lib/ai_agent','includes','Party\x20Mode','Kein\x20Kalender-Adapter','PINN\x20AI\x20Forecast','analysis.triggerBriefing','genAI','NORMAL','minutes_safe','loadSystemMode','Keine\x20Antwort\x20von\x20Gemini','(((.+)+)+)+$','clear','length','Test','analysis.training.triggerSecurity','.data.table','systemConfig','exitTimer','runGeminiAnalysis','weatherunderground.0','config','analysis.training.triggerHealth','onMessage','application/json','TRAIN_HEALTH','find','Warm-Up\x20Time\x20(Minutes\x20to\x2021Â°C)','createDailyDigest','Verbunden','add','Aktiv\x20(','32bQnSOs','ack','VACATION','./lib/installer','getOutsideTemperatureNumeric','getOverviewData','analysis.security.learningStatus','ready','getGenerativeModel','sendNotification','setHours','eventHistory','message','analysis.topology.structure','stopService','setupBriefingScheduler','from','80193fVepyO','analysis.training.triggerEnergy','updated','floor','14pKduWe','error','presenceDevices','entries','rawEventLog','sendTo','split','setObjectNotExistsAsync','analysis.automation.triggerAction','sonn','getHours','modeResetJob','dependencyInstallInProgress','analysis.automation.patternDetected','push','analysisTimer','133HigApm','apiKey','bind','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','briefingJob','getStateAsync','NextHours.Location_1.Day_1.current.symbol_desc','Guest\x20Mode','join','setStateAsync','devices','search','analysis.energy.ventilationAlerts','json','analysis.health.todayVector','LTM.baselineStatus','getMinutes','log','updateTopology','LTM.trainingData.thermodynamics','calendarInstance','val','Gemini\x20Init\x20Error:\x20','analysis.automation.description','Daten\x20nicht\x20verfÃ¼gbar','Heizung\x20kann\x20','values','ANALYZE_TREND','forecast.current.weather','checkCalendarTriggers','Kein\x20Wetter-Adapter','generateContent','fill','.communicate.request','27873220MkfGuG','Kein\x20API\x20Key\x20Ã¼bergeben','SET_TOPOLOGY','isProVersion','instance','setState','subscribeStates','party','updateHealthVector','geminiApiKey','SET_LEARNING_MODE','analysisHistory','testContext','LTM.dailyDigests','stateChange','SYSTEM_DP_MODE','activityLevel','send','139527HFvRUH','analysis.training.triggerTopology','type','Gesendet',')\x20-\x20Phase\x20C\x20(Adaptive\x20Security\x20&\x20Smart\x20Schedule)','endsWith','onUnload','analysis.energy.mpcActive','minDaysForBaseline','debug','OPTIMIZE_ENERGY','getEnums'];a0_0x2bf6=function(){return _0x35da37;};return a0_0x2bf6();}const a0_0x131c1c=a0_0x9ae4;(function(_0x7a75ba,_0x2e6f6b){const _0x1a53bc=a0_0x9ae4,_0x4ef0bc=_0x7a75ba();while(!![]){try{const _0x3e6bbe=-parseInt(_0x1a53bc(0x266))/0x1*(parseInt(_0x1a53bc(0x207))/0x2)+parseInt(_0x1a53bc(0x203))/0x3*(-parseInt(_0x1a53bc(0x1f2))/0x4)+-parseInt(_0x1a53bc(0x1b9))/0x5+parseInt(_0x1a53bc(0x265))/0x6*(parseInt(_0x1a53bc(0x217))/0x7)+-parseInt(_0x1a53bc(0x18d))/0x8+-parseInt(_0x1a53bc(0x24b))/0x9+parseInt(_0x1a53bc(0x239))/0xa;if(_0x3e6bbe===_0x2e6f6b)break;else _0x4ef0bc['push'](_0x4ef0bc['shift']());}catch(_0x1bd3a6){_0x4ef0bc['push'](_0x4ef0bc['shift']());}}}(a0_0x2bf6,0x8a33b));function a0_0x9ae4(_0x1461ad,_0x482152){const _0x87a514=a0_0x2bf6();return a0_0x9ae4=function(_0x2149e4,_0x242378){_0x2149e4=_0x2149e4-0x180;let _0x2bf695=_0x87a514[_0x2149e4];return _0x2bf695;},a0_0x9ae4(_0x1461ad,_0x482152);}const a0_0x242378=(function(){let _0x4a95fb=!![];return function(_0x4885ce,_0x49c524){const _0x2e0010=_0x4a95fb?function(){if(_0x49c524){const _0x2e322d=_0x49c524['apply'](_0x4885ce,arguments);return _0x49c524=null,_0x2e322d;}}:function(){};return _0x4a95fb=![],_0x2e0010;};}()),a0_0x2149e4=a0_0x242378(this,function(){const _0x9c61f3=a0_0x9ae4;return a0_0x2149e4[_0x9c61f3(0x1b3)]()[_0x9c61f3(0x222)](_0x9c61f3(0x1dd))[_0x9c61f3(0x1b3)]()[_0x9c61f3(0x19a)](a0_0x2149e4)['search']('(((.+)+)+)+$');});a0_0x2149e4();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),installer=require(a0_0x131c1c(0x1f5)),scanner=require(a0_0x131c1c(0x1b8)),schedulers=require('./lib/scheduler'),topology=require('./lib/topology'),setup=require('./lib/setup'),recorder=require(a0_0x131c1c(0x193)),pythonBridge=require(a0_0x131c1c(0x1a1)),aiAgent=require(a0_0x131c1c(0x1d2)),deadMan=require('./lib/dead_man'),automation=require('./lib/automation'),GEMINI_MODEL=a0_0x131c1c(0x19c),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils[a0_0x131c1c(0x195)]{constructor(_0x11697c){const _0x4ad196=a0_0x131c1c;super({..._0x11697c,'name':'cogni-living'}),this[_0x4ad196(0x1fd)]=[],this[_0x4ad196(0x244)]=[],this[_0x4ad196(0x20b)]=[],this['dailyDigests']=[],this[_0x4ad196(0x1aa)]={},this[_0x4ad196(0x1e3)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x4ad196(0x26c)]=!![],this['exitTimer']=null,this[_0x4ad196(0x264)]=null,this[_0x4ad196(0x1a2)]=![],this[_0x4ad196(0x1d8)]=null,this[_0x4ad196(0x25c)]=null,this[_0x4ad196(0x1ba)]=setup['SYSTEM_MODES'][_0x4ad196(0x1d9)],this[_0x4ad196(0x23c)]=![],this[_0x4ad196(0x1a5)]=![],this[_0x4ad196(0x216)]=null,this[_0x4ad196(0x1b7)]=null,this[_0x4ad196(0x212)]=null,this[_0x4ad196(0x1b6)]=null,this[_0x4ad196(0x21b)]=null,this[_0x4ad196(0x213)]=![],this['on'](_0x4ad196(0x1f9),this[_0x4ad196(0x1b0)][_0x4ad196(0x219)](this)),this['on'](_0x4ad196(0x247),this['onStateChange']['bind'](this)),this['on'](_0x4ad196(0x18a),this['onUnload'][_0x4ad196(0x219)](this)),this['on'](_0x4ad196(0x1fe),this['onMessage']['bind'](this));}async['onReady'](){const _0x2374e3=a0_0x131c1c;this[_0x2374e3(0x228)][_0x2374e3(0x1ac)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x2374e3(0x270)]+_0x2374e3(0x24f));if(!installer['checkAndInstall'](this,()=>this['startSystem']()))return;}async[a0_0x131c1c(0x25d)](){const _0x37202f=a0_0x131c1c;await setup['initZombies'](this);try{this[_0x37202f(0x23c)]=await setup['checkLicense'](this[_0x37202f(0x1e7)]['licenseKey']);}catch(_0x11923e){}if(!this[_0x37202f(0x1e7)][_0x37202f(0x182)]||this[_0x37202f(0x1e7)][_0x37202f(0x182)]<0.1)this[_0x37202f(0x1e7)][_0x37202f(0x182)]=0xc;await setup[_0x37202f(0x274)](this),await setup['initSystemConfig'](this);if(this[_0x37202f(0x1e7)][_0x37202f(0x242)])try{this[_0x37202f(0x1d8)]=new GoogleGenerativeAI(this[_0x37202f(0x1e7)]['geminiApiKey']),this[_0x37202f(0x25c)]=this[_0x37202f(0x1d8)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x37202f(0x1ea)}}),this[_0x37202f(0x228)]['info'](_0x37202f(0x1bf));}catch(_0x778481){this[_0x37202f(0x228)][_0x37202f(0x208)](_0x37202f(0x22d)+_0x778481[_0x37202f(0x1fe)]);}await setup[_0x37202f(0x25a)](this),await this[_0x37202f(0x1db)](),await this[_0x37202f(0x20e)](_0x37202f(0x19f),{'type':_0x37202f(0x1ab),'common':{'name':_0x37202f(0x1d6),'type':_0x37202f(0x190),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x37202f(0x20e)](_0x37202f(0x223),{'type':_0x37202f(0x1ab),'common':{'name':'Active\x20Ventilation\x20Alerts','type':_0x37202f(0x190),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x37202f(0x20e)](_0x37202f(0x196),{'type':_0x37202f(0x1ab),'common':{'name':_0x37202f(0x1ed),'type':'string','role':_0x37202f(0x224),'read':!![],'write':![]},'native':{}});try{const _0x45f8d4=await this[_0x37202f(0x21c)](_0x37202f(0x191));if(_0x45f8d4&&_0x45f8d4[_0x37202f(0x22c)])this['rawEventLog']=JSON['parse'](_0x45f8d4['val']);}catch(_0x4d2286){this[_0x37202f(0x20b)]=[];}try{const _0x2b0abf=await this[_0x37202f(0x21c)](_0x37202f(0x246));if(_0x2b0abf&&_0x2b0abf[_0x37202f(0x22c)])this['dailyDigests']=JSON[_0x37202f(0x1c6)](_0x2b0abf[_0x37202f(0x22c)]);}catch(_0x480b11){this['dailyDigests']=[];}const _0x4c64ab=this['dailyDigests']['length']>=(this['config'][_0x37202f(0x253)]||0x7)?_0x37202f(0x1f1)+this[_0x37202f(0x1ad)]['length']+'\x20Tage)':_0x37202f(0x1a6)+this[_0x37202f(0x1ad)][_0x37202f(0x1df)]+'/'+(this[_0x37202f(0x1e7)][_0x37202f(0x253)]||0x7)+')';await this[_0x37202f(0x220)](_0x37202f(0x226),{'val':_0x4c64ab,'ack':!![]}),this[_0x37202f(0x23f)](_0x37202f(0x187)),this[_0x37202f(0x23f)]('LTM.triggerDailyDigest'),this[_0x37202f(0x23f)](_0x37202f(0x272)),this[_0x37202f(0x23f)](_0x37202f(0x1d7)),this[_0x37202f(0x23f)](_0x37202f(0x20f)),this[_0x37202f(0x23f)]('analysis.automation.autoApply'),this[_0x37202f(0x23f)](_0x37202f(0x1e1)),this[_0x37202f(0x23f)](_0x37202f(0x1e8)),this['subscribeStates'](_0x37202f(0x204)),this['subscribeStates'](_0x37202f(0x27a)),this[_0x37202f(0x23f)](_0x37202f(0x24c)),this[_0x37202f(0x23f)](_0x37202f(0x252));const _0x92c36d=this[_0x37202f(0x1e7)]['devices'];if(_0x92c36d)for(const _0x13c409 of _0x92c36d){await this[_0x37202f(0x26a)](_0x13c409['id']);}const _0x4d0a58=this[_0x37202f(0x1e7)]['presenceDevices'];if(_0x4d0a58)for(const _0x35edc5 of _0x4d0a58){await this[_0x37202f(0x26a)](_0x35edc5);}if(this['config']['notifyTelegramEnabled']&&this[_0x37202f(0x1e7)][_0x37202f(0x262)])await this[_0x37202f(0x26a)](this['config']['notifyTelegramInstance']+_0x37202f(0x238));setTimeout(()=>this[_0x37202f(0x1c9)](),0x1388);if(this[_0x37202f(0x216)])clearInterval(this[_0x37202f(0x216)]);const _0x57ed32=this[_0x37202f(0x1e7)][_0x37202f(0x276)]||0xf;_0x57ed32>0x0&&(this[_0x37202f(0x216)]=setInterval(()=>{const _0x1075f1=_0x37202f;this[_0x1075f1(0x18f)](),automation[_0x1075f1(0x234)](this);},_0x57ed32*0x3c*0x3e8)),setTimeout(()=>automation[_0x37202f(0x234)](this),0x2710),schedulers['setupLtmScheduler'](this,()=>aiAgent[_0x37202f(0x1ee)](this,pythonBridge)),schedulers['setupModeResetScheduler'](this),schedulers[_0x37202f(0x1ca)](this,()=>aiAgent[_0x37202f(0x197)](this)),schedulers[_0x37202f(0x201)](this,()=>aiAgent[_0x37202f(0x18e)](this)),pythonBridge[_0x37202f(0x1bb)](this,installer[_0x37202f(0x1a9)]),setTimeout(async()=>{const _0x389063=_0x37202f;await topology[_0x389063(0x229)](this);try{const _0x3aa434=await this['getStateAsync']('analysis.topology.structure');if(_0x3aa434&&_0x3aa434[_0x389063(0x22c)])pythonBridge[_0x389063(0x24a)](this,_0x389063(0x23b),JSON['parse'](_0x3aa434[_0x389063(0x22c)]));}catch(_0x38011a){}this['runPythonHealthCheck'](),this[_0x389063(0x26e)](),this[_0x389063(0x1bd)](),this[_0x389063(0x241)]();},0x1388);}[a0_0x131c1c(0x251)](_0x2b515a){const _0x39fa18=a0_0x131c1c;if(this[_0x39fa18(0x216)])clearInterval(this['analysisTimer']);if(this[_0x39fa18(0x1b6)])clearInterval(this[_0x39fa18(0x1b6)]);if(this[_0x39fa18(0x1b7)])this['ltmJob']['cancel']();if(this[_0x39fa18(0x212)])this['modeResetJob']['cancel']();if(this[_0x39fa18(0x21b)])this[_0x39fa18(0x21b)]['cancel']();recorder[_0x39fa18(0x271)](this),pythonBridge[_0x39fa18(0x200)](this),_0x2b515a();}async[a0_0x131c1c(0x1a4)](_0x20dff1,_0x3fcbad){const _0x69aa33=a0_0x131c1c;if(!_0x3fcbad||this['dependencyInstallInProgress'])return;if(_0x20dff1[_0x69aa33(0x1d3)]('telegram')&&_0x20dff1[_0x69aa33(0x250)](_0x69aa33(0x1bc))&&_0x3fcbad[_0x69aa33(0x22c)])return;if(_0x20dff1===this['namespace']+_0x69aa33(0x279)){if(_0x3fcbad['val']&&Object[_0x69aa33(0x231)](setup[_0x69aa33(0x273)])[_0x69aa33(0x1d3)](_0x3fcbad[_0x69aa33(0x22c)])){this[_0x69aa33(0x1ba)]=_0x3fcbad['val'];if(_0x3fcbad['val']===setup[_0x69aa33(0x273)][_0x69aa33(0x1f4)])await recorder[_0x69aa33(0x260)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x69aa33(0x23c)]){let _0x479b35=![],_0x5defdd=0x0,_0x21a38f='manual';if(this[_0x69aa33(0x1ba)]===_0x69aa33(0x240))_0x479b35=!![],_0x5defdd=0x168,_0x21a38f=_0x69aa33(0x1d4);else this[_0x69aa33(0x1ba)]==='guest'&&(_0x479b35=!![],_0x5defdd=0x5a0,_0x21a38f=_0x69aa33(0x21e));pythonBridge[_0x69aa33(0x24a)](this,_0x69aa33(0x243),{'active':_0x479b35,'duration':_0x5defdd,'label':_0x21a38f}),await this[_0x69aa33(0x220)](_0x69aa33(0x1f8),{'val':JSON[_0x69aa33(0x1c3)]({'active':_0x479b35,'label':_0x21a38f,'timestamp':Date[_0x69aa33(0x258)]()}),'ack':!![]});}}if(!_0x3fcbad[_0x69aa33(0x1f3)])this[_0x69aa33(0x23e)](_0x20dff1,{'val':this[_0x69aa33(0x1ba)],'ack':!![]});return;}if(!_0x3fcbad[_0x69aa33(0x1f3)]){_0x20dff1['includes']('analysis.trigger')&&_0x3fcbad[_0x69aa33(0x22c)]&&(this[_0x69aa33(0x23e)](_0x20dff1,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this));if(_0x20dff1['includes'](_0x69aa33(0x1c7))&&_0x3fcbad[_0x69aa33(0x22c)]){this[_0x69aa33(0x23e)](_0x20dff1,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent['createDailyDigest'](this,pythonBridge);}_0x20dff1['includes'](_0x69aa33(0x188))&&_0x3fcbad[_0x69aa33(0x22c)]&&(this[_0x69aa33(0x23e)](_0x20dff1,{'val':![],'ack':!![]}),aiAgent[_0x69aa33(0x18e)](this));_0x20dff1['includes'](_0x69aa33(0x180))&&_0x3fcbad[_0x69aa33(0x22c)]&&(this['setState'](_0x20dff1,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this));if(_0x20dff1[_0x69aa33(0x1d3)](_0x69aa33(0x1e1))&&_0x3fcbad['val']){this['setState'](_0x20dff1,{'val':![],'ack':!![]});if(this[_0x69aa33(0x23c)])try{const _0x171889=await this[_0x69aa33(0x21c)]('LTM.trainingData.sequences');if(_0x171889&&_0x171889[_0x69aa33(0x22c)]){const _0x3150f8=JSON['parse'](_0x171889[_0x69aa33(0x22c)]);this['setStateAsync'](_0x69aa33(0x1cc),{'val':'Sec-Training\x20started...','ack':!![]}),pythonBridge[_0x69aa33(0x24a)](this,_0x69aa33(0x18b),{'sequences':_0x3150f8});}}catch(_0x363e14){}}if(_0x20dff1[_0x69aa33(0x1d3)]('analysis.training.triggerHealth')&&_0x3fcbad[_0x69aa33(0x22c)]){this[_0x69aa33(0x23e)](_0x20dff1,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x4ee323=await this[_0x69aa33(0x21c)](_0x69aa33(0x246));if(_0x4ee323&&_0x4ee323[_0x69aa33(0x22c)])pythonBridge['send'](this,_0x69aa33(0x1eb),{'digests':JSON[_0x69aa33(0x1c6)](_0x4ee323[_0x69aa33(0x22c)])});}catch(_0x58c050){}}if(_0x20dff1[_0x69aa33(0x1d3)](_0x69aa33(0x204))&&_0x3fcbad['val']){this[_0x69aa33(0x23e)](_0x20dff1,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x32f753=await this[_0x69aa33(0x21c)](_0x69aa33(0x22a));if(_0x32f753&&_0x32f753[_0x69aa33(0x22c)])pythonBridge[_0x69aa33(0x24a)](this,_0x69aa33(0x1b4),{'points':JSON[_0x69aa33(0x1c6)](_0x32f753[_0x69aa33(0x22c)])});}catch(_0x42d4ab){}}if(_0x20dff1['includes'](_0x69aa33(0x27a))&&_0x3fcbad[_0x69aa33(0x22c)]){this[_0x69aa33(0x23e)](_0x20dff1,{'val':![],'ack':!![]});if(this[_0x69aa33(0x23c)])try{const _0x2e0efa=await this['getStateAsync'](_0x69aa33(0x191));if(_0x2e0efa&&_0x2e0efa[_0x69aa33(0x22c)])pythonBridge[_0x69aa33(0x24a)](this,_0x69aa33(0x1b2),{'events':JSON[_0x69aa33(0x1c6)](_0x2e0efa[_0x69aa33(0x22c)])});}catch(_0x17175d){}}_0x20dff1[_0x69aa33(0x1d3)](_0x69aa33(0x24c))&&_0x3fcbad[_0x69aa33(0x22c)]&&(this['setState'](_0x20dff1,{'val':![],'ack':!![]}),topology[_0x69aa33(0x229)](this));return;}if(this[_0x69aa33(0x1e7)][_0x69aa33(0x209)]&&this[_0x69aa33(0x1e7)][_0x69aa33(0x209)][_0x69aa33(0x1d3)](_0x20dff1)){await this[_0x69aa33(0x1c9)]();return;}const _0x43acef=(this[_0x69aa33(0x1e7)][_0x69aa33(0x221)]||[])[_0x69aa33(0x1ec)](_0x231a1a=>_0x231a1a['id']===_0x20dff1);if(_0x43acef){const _0x5cfe2f=await recorder[_0x69aa33(0x198)](this,_0x20dff1,_0x3fcbad,_0x43acef);_0x5cfe2f&&_0x5cfe2f[_0x69aa33(0x24d)]===_0x69aa33(0x268)&&_0x5cfe2f[_0x69aa33(0x1b1)]&&this[_0x69aa33(0x23c)]&&deadMan[_0x69aa33(0x181)](this,_0x5cfe2f['location']);}}async[a0_0x131c1c(0x1e9)](_0x577bd4){const _0x360b16=a0_0x131c1c;if(typeof _0x577bd4===_0x360b16(0x257)&&_0x577bd4['message']){if(_0x577bd4['command']===_0x360b16(0x26b))try{const _0x4ec41d=await automation['scanThermostats'](this);this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'results':_0x4ec41d},_0x577bd4['callback']);}catch(_0x5cc779){this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':![],'error':_0x5cc779[_0x360b16(0x1fe)]},_0x577bd4[_0x360b16(0x19d)]);}else{if(_0x577bd4[_0x360b16(0x1c0)]==='simulateEnergyMPC')try{const {current_temps:_0x7d740,t_out:_0xb0d436,targets:_0x36a0e9,t_forecast:_0x396eb3}=_0x577bd4[_0x360b16(0x1fe)],_0x3aaed8=[];let _0x526175={};try{const _0x3b527f=await this[_0x360b16(0x21c)](_0x360b16(0x259));if(_0x3b527f&&_0x3b527f['val']){const _0x2eb8c3=JSON[_0x360b16(0x1c6)](_0x3b527f[_0x360b16(0x22c)]);_0x526175=_0x2eb8c3['scores']||_0x2eb8c3;}}catch(_0x3df5de){}const _0x41264c=_0x396eb3!==undefined&&_0x396eb3!==null?(_0xb0d436+_0x396eb3)/0x2:_0xb0d436;for(const [_0x5d4019,_0x4e5801]of Object[_0x360b16(0x20a)](_0x7d740)){const _0x432ff1=_0x36a0e9[_0x5d4019]||0x15;if(_0x4e5801<=_0x432ff1)continue;let _0x358aeb=_0x526175[_0x5d4019]||-0.5;if(_0x358aeb>=0x0)_0x358aeb=-0.5;const _0x4510fc=Math[_0x360b16(0x1a8)](_0x358aeb),_0x243ad3=_0x4e5801-_0x432ff1;let _0x591bea=Math['floor'](_0x243ad3/_0x4510fc*0x3c);const _0x117eae=_0x4e5801-_0xb0d436,_0x108d64=_0x4e5801-_0x41264c;if(_0x108d64!==0x0&&_0x117eae!==0x0){const _0x49dd82=_0x117eae/_0x108d64;_0x591bea=Math[_0x360b16(0x206)](_0x591bea*_0x49dd82);}if(_0x591bea>0xf){if(_0x591bea>0xf0)_0x591bea=0xf0;_0x3aaed8[_0x360b16(0x215)]({'room':_0x5d4019,'minutes_safe':_0x591bea,'target':_0x432ff1,'current':_0x4e5801,'savings_msg':_0x360b16(0x230)+_0x591bea+_0x360b16(0x26d)});}}_0x3aaed8['sort']((_0x5bb091,_0x1a1959)=>_0x1a1959[_0x360b16(0x1da)]-_0x5bb091[_0x360b16(0x1da)]),this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'proposals':_0x3aaed8},_0x577bd4[_0x360b16(0x19d)]);}catch(_0x28ac6b){this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':![],'error':_0x28ac6b[_0x360b16(0x1fe)]},_0x577bd4[_0x360b16(0x19d)]);}else{if(_0x577bd4['command']==='dismissAutomation')await this['setStateAsync']('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this['setStateAsync'](_0x360b16(0x22e),{'val':'','ack':!![]}),await this[_0x360b16(0x220)](_0x360b16(0x1ce),{'val':'','ack':!![]}),this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![]},_0x577bd4['callback']);else{if(_0x577bd4['command']===_0x360b16(0x1c1)){const {targetId:_0x554d16,targetValue:_0x7d66f8}=_0x577bd4[_0x360b16(0x1fe)];await this['setStateAsync'](_0x360b16(0x214),{'val':!![],'ack':!![]}),await this[_0x360b16(0x220)](_0x360b16(0x22e),{'val':_0x360b16(0x1d0),'ack':!![]}),await this[_0x360b16(0x220)](_0x360b16(0x1ce),{'val':_0x554d16,'ack':!![]}),await this[_0x360b16(0x220)](_0x360b16(0x1be),{'val':String(_0x7d66f8),'ack':!![]}),this['sendTo'](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![]},_0x577bd4[_0x360b16(0x19d)]);}else{if(_0x577bd4[_0x360b16(0x1c0)]==='testApiKey')try{const _0x5ccfee=_0x577bd4[_0x360b16(0x1fe)][_0x360b16(0x218)];if(!_0x5ccfee)throw new Error(_0x360b16(0x23a));const _0x46ed32=new GoogleGenerativeAI(_0x5ccfee),_0x39aea7=_0x46ed32[_0x360b16(0x1fa)]({'model':GEMINI_MODEL}),_0x2871b8=await _0x39aea7[_0x360b16(0x236)](_0x360b16(0x1e0)),_0x3c1b1e=await _0x2871b8['response'];if(_0x3c1b1e['text']())this['sendTo'](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'message':_0x360b16(0x1c5)},_0x577bd4[_0x360b16(0x19d)]);else throw new Error(_0x360b16(0x1dc));}catch(_0x5f1607){this['sendTo'](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':![],'message':_0x5f1607[_0x360b16(0x1fe)]},_0x577bd4['callback']);}else{if(_0x577bd4[_0x360b16(0x1c0)]===_0x360b16(0x261))try{const _0xbecc43=await scanner[_0x360b16(0x263)](this,_0x577bd4[_0x360b16(0x1fe)]||{});this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'devices':_0xbecc43},_0x577bd4['callback']);}catch(_0x2dc4f5){this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':![],'error':_0x2dc4f5[_0x360b16(0x1fe)]},_0x577bd4[_0x360b16(0x19d)]);}else{if(_0x577bd4[_0x360b16(0x1c0)]===_0x360b16(0x19b))try{const {matrix:_0x46ddbe}=_0x577bd4[_0x360b16(0x1fe)],_0x474bfb=await this[_0x360b16(0x21c)](_0x360b16(0x1ff));if(_0x474bfb&&_0x474bfb['val']){const _0x2f446d=JSON['parse'](_0x474bfb['val']);_0x2f446d[_0x360b16(0x183)]=_0x46ddbe,_0x2f446d[_0x360b16(0x205)]=Date[_0x360b16(0x258)](),await this['setStateAsync'](_0x360b16(0x1ff),{'val':JSON[_0x360b16(0x1c3)](_0x2f446d),'ack':!![]}),pythonBridge[_0x360b16(0x24a)](this,_0x360b16(0x23b),_0x2f446d);}this[_0x360b16(0x20c)](_0x577bd4['from'],_0x577bd4['command'],{'success':!![]},_0x577bd4[_0x360b16(0x19d)]);}catch(_0x34a5f3){this[_0x360b16(0x228)][_0x360b16(0x208)](_0x34a5f3);}else{if(_0x577bd4[_0x360b16(0x1c0)]===_0x360b16(0x1b5))this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'dailyDigests':this[_0x360b16(0x1ad)]||[],'analysisHistory':this[_0x360b16(0x244)]||[]},_0x577bd4['callback']);else{if(_0x577bd4['command']===_0x360b16(0x1f7)){const _0x564b5c=this['dailyDigests'][_0x360b16(0x1df)],_0x32c8b0=new Array(0x18)[_0x360b16(0x237)](0x0),_0x8ae719=new Date()[_0x360b16(0x1fc)](0x0,0x0,0x0,0x0);this['eventHistory']&&this[_0x360b16(0x1fd)][_0x360b16(0x267)](_0x37b5dc=>{const _0x6a598e=_0x360b16;if(_0x37b5dc['timestamp']>=_0x8ae719){const _0x5e985a=new Date(_0x37b5dc[_0x6a598e(0x26f)])[_0x6a598e(0x211)]();if(_0x5e985a>=0x0&&_0x5e985a<0x18)_0x32c8b0[_0x5e985a]++;}});let _0x31e3a9=![],_0x324525='',_0x39638d='',_0x2d7f97='';try{const _0x492649=await this[_0x360b16(0x21c)](_0x360b16(0x214));if(_0x492649&&_0x492649[_0x360b16(0x22c)]){_0x31e3a9=!![];const _0x1c1642=await this[_0x360b16(0x21c)](_0x360b16(0x22e));_0x324525=_0x1c1642?_0x1c1642[_0x360b16(0x22c)]:'';const _0x1828f5=await this[_0x360b16(0x21c)](_0x360b16(0x1ce));_0x39638d=_0x1828f5?_0x1828f5['val']:'';const _0x245fcf=await this[_0x360b16(0x21c)](_0x360b16(0x1be));_0x2d7f97=_0x245fcf?_0x245fcf[_0x360b16(0x22c)]:'';}}catch(_0x4ca878){}const _0x1291b3=await this[_0x360b16(0x1a0)](),_0x10812e=(this[_0x360b16(0x1e7)][_0x360b16(0x221)]||[])[_0x360b16(0x186)](_0x38aaab=>_0x38aaab[_0x360b16(0x1a3)]),_0x4c4da2=_0x1291b3&&_0x10812e;this['sendTo'](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'eventHistory':this[_0x360b16(0x1fd)]['slice'](0x0,0xf),'stats':{'digestCount':_0x564b5c,'isPresent':this[_0x360b16(0x26c)],'hourlyActivity':_0x32c8b0,'solarActive':_0x4c4da2},'automation':{'detected':_0x31e3a9,'description':_0x324525,'targetId':_0x39638d,'targetValue':_0x2d7f97}},_0x577bd4[_0x360b16(0x19d)]);}else{if(_0x577bd4[_0x360b16(0x1c0)]===_0x360b16(0x256)){const _0x1732b6=await this[_0x360b16(0x1ae)](_0x360b16(0x192),_0x360b16(0x1af)),_0x23ac98=[];if(_0x1732b6)for(const _0x449125 in _0x1732b6){const _0xdde38c=_0x1732b6[_0x449125],_0x3b7273=(_0xdde38c['common']&&typeof _0xdde38c[_0x360b16(0x19e)][_0x360b16(0x1a7)]===_0x360b16(0x257)?_0xdde38c[_0x360b16(0x19e)]['name']['de']:_0xdde38c['common'][_0x360b16(0x1a7)])||_0xdde38c[_0x360b16(0x19e)][_0x360b16(0x1a7)];_0x23ac98[_0x360b16(0x215)]({'id':_0x449125,'name':_0x3b7273});}const _0x3e5465=await this[_0x360b16(0x1ae)](_0x360b16(0x1c8),_0x360b16(0x1af)),_0x540c7b=[];if(_0x3e5465)for(const _0x25209b in _0x3e5465){const _0x5a4649=_0x3e5465[_0x25209b],_0x5b1efd=(_0x5a4649['common']&&typeof _0x5a4649[_0x360b16(0x19e)][_0x360b16(0x1a7)]===_0x360b16(0x257)?_0x5a4649['common'][_0x360b16(0x1a7)]['de']:_0x5a4649[_0x360b16(0x19e)][_0x360b16(0x1a7)])||_0x25209b[_0x360b16(0x20d)]('.')[_0x360b16(0x184)]();_0x540c7b[_0x360b16(0x215)](_0x5b1efd);}this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'enums':_0x23ac98,'rooms':_0x540c7b},_0x577bd4[_0x360b16(0x19d)]);}else{if(_0x577bd4['command']===_0x360b16(0x245))try{let _0x4d1b0b=_0x360b16(0x235),_0x599ead=_0x360b16(0x1d5);if(this[_0x360b16(0x1e7)]['useWeather']){const _0x4a5629=await recorder[_0x360b16(0x1f6)](this);_0x4d1b0b=_0x4a5629!==null?_0x4a5629+'Â°C':_0x360b16(0x22f);}if(this['config'][_0x360b16(0x22b)]){const _0x1e8e32=await this[_0x360b16(0x27b)](_0x360b16(0x277)+this[_0x360b16(0x1e7)]['calendarInstance']);_0x599ead=_0x1e8e32?_0x360b16(0x1ef):'Instanz\x20nicht\x20gefunden';}this[_0x360b16(0x20c)](_0x577bd4['from'],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'weather':_0x4d1b0b,'calendar':_0x599ead},_0x577bd4[_0x360b16(0x19d)]);}catch(_0xf36aaf){this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4['command'],{'success':![],'error':_0xf36aaf['message']},_0x577bd4[_0x360b16(0x19d)]);}else{if(_0x577bd4[_0x360b16(0x1c0)]===_0x360b16(0x278))try{const _0x45ade2=_0x577bd4[_0x360b16(0x1fe)][_0x360b16(0x23d)],_0x5ac0db=await this['getForeignStateAsync'](_0x45ade2+_0x360b16(0x1e2));let _0x2ba794=[];if(_0x5ac0db&&_0x5ac0db[_0x360b16(0x22c)]){const _0x12e1a1=JSON[_0x360b16(0x1c6)](_0x5ac0db[_0x360b16(0x22c)]),_0xca1c27=new Set();Array['isArray'](_0x12e1a1)&&_0x12e1a1[_0x360b16(0x267)](_0x46a286=>{const _0x3efcfa=_0x360b16;if(_0x46a286[_0x3efcfa(0x1cd)])_0xca1c27['add'](_0x46a286[_0x3efcfa(0x1cd)]);else{if(_0x46a286[_0x3efcfa(0x1c4)])_0xca1c27[_0x3efcfa(0x1f0)](_0x46a286['calendarName']);}}),_0x2ba794=Array[_0x360b16(0x202)](_0xca1c27)[_0x360b16(0x25e)]();}if(_0x2ba794[_0x360b16(0x1df)]===0x0)_0x2ba794=[_0x360b16(0x1cb)];this['sendTo'](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':!![],'names':_0x2ba794},_0x577bd4[_0x360b16(0x19d)]);}catch(_0xc9e68a){this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4[_0x360b16(0x1c0)],{'success':![],'error':_0xc9e68a['message']},_0x577bd4[_0x360b16(0x19d)]);}else{if(_0x577bd4[_0x360b16(0x1c0)]==='testNotification')try{await setup[_0x360b16(0x1fb)](this,_0x360b16(0x25b),![],![]),this[_0x360b16(0x20c)](_0x577bd4[_0x360b16(0x202)],_0x577bd4['command'],{'success':!![],'message':_0x360b16(0x24e)},_0x577bd4[_0x360b16(0x19d)]);}catch(_0x37402f){this[_0x360b16(0x228)][_0x360b16(0x208)](_0x360b16(0x1c2)+_0x37402f[_0x360b16(0x1fe)]),this[_0x360b16(0x20c)](_0x577bd4['from'],_0x577bd4['command'],{'success':![],'message':'Fehler:\x20'+_0x37402f[_0x360b16(0x1fe)]},_0x577bd4[_0x360b16(0x19d)]);}}}}}}}}}}}}}}}async[a0_0x131c1c(0x1db)](){const _0x11a0b3=a0_0x131c1c;try{const _0x2c1eb8=await this[_0x11a0b3(0x21c)](setup['SYSTEM_DP_MODE']);_0x2c1eb8&&_0x2c1eb8[_0x11a0b3(0x22c)]&&Object['values'](setup[_0x11a0b3(0x273)])['includes'](_0x2c1eb8[_0x11a0b3(0x22c)])?this[_0x11a0b3(0x1ba)]=_0x2c1eb8[_0x11a0b3(0x22c)]:(this[_0x11a0b3(0x1ba)]=setup[_0x11a0b3(0x273)]['NORMAL'],await this[_0x11a0b3(0x220)](setup[_0x11a0b3(0x248)],{'val':setup['SYSTEM_MODES'][_0x11a0b3(0x1d9)],'ack':!![]}));}catch(_0x11700e){this[_0x11a0b3(0x1ba)]=setup['SYSTEM_MODES'][_0x11a0b3(0x1d9)];}}async[a0_0x131c1c(0x1c9)](){const _0x1f264c=a0_0x131c1c;try{const _0x4c71c2=this[_0x1f264c(0x1e7)][_0x1f264c(0x209)]||[];let _0x8e8558=![];const _0x10fc91=[];for(const _0x264713 of _0x4c71c2){try{const _0x46a0ef=await this[_0x1f264c(0x199)](_0x264713);_0x46a0ef&&(_0x46a0ef[_0x1f264c(0x22c)]===!![]||_0x46a0ef[_0x1f264c(0x22c)]==='online'||_0x46a0ef[_0x1f264c(0x22c)]===0x1)&&(_0x8e8558=!![],_0x10fc91[_0x1f264c(0x215)](_0x264713));}catch(_0x16011a){}}return await this[_0x1f264c(0x220)](_0x1f264c(0x269),{'val':_0x10fc91[_0x1f264c(0x21f)](',\x20'),'ack':!![]}),_0x8e8558&&(this[_0x1f264c(0x1e4)]&&(this[_0x1f264c(0x228)]['info']('WiFi\x20Presence\x20detected.'),recorder['abortExitTimer'](this)),!this['isPresent']&&this[_0x1f264c(0x1ba)]===setup[_0x1f264c(0x273)][_0x1f264c(0x1d9)]&&await recorder[_0x1f264c(0x260)](this,!![])),_0x8e8558;}catch(_0x36c576){return![];}}async[a0_0x131c1c(0x18f)](){const _0x4dfdea=a0_0x131c1c;this['log'][_0x4dfdea(0x254)](_0x4dfdea(0x21a)),await aiAgent[_0x4dfdea(0x1e5)](this),this['updateHealthVector'](),this['triggerGaitAnalysis'](),this[_0x4dfdea(0x1bd)]();}async['checkSolarCondition'](){const _0x3076d2=a0_0x131c1c,_0xddcf2c=[_0x3076d2(0x1e6),'accuweather.0','daswetter.0'],_0x2e31a1=[_0x3076d2(0x233),_0x3076d2(0x25f),_0x3076d2(0x21d)];for(const _0x381d11 of _0xddcf2c){for(const _0x231adb of _0x2e31a1){try{const _0x2ee01b=_0x381d11+'.'+_0x231adb,_0x13a461=await this[_0x3076d2(0x199)](_0x2ee01b);if(_0x13a461&&_0x13a461['val']){const _0x56ad01=String(_0x13a461['val'])[_0x3076d2(0x194)]();if(_0x56ad01[_0x3076d2(0x1d3)](_0x3076d2(0x210))||_0x56ad01[_0x3076d2(0x1d3)](_0x3076d2(0x185))||_0x56ad01[_0x3076d2(0x1d3)]('klar')||_0x56ad01[_0x3076d2(0x1d3)](_0x3076d2(0x1de))||_0x56ad01[_0x3076d2(0x1d3)]('heiter'))return!![];}}catch(_0xda63e8){}}}return![];}[a0_0x131c1c(0x26e)](){if(!this['isProVersion'])return;try{this['getState']('LTM.trainingData.sequences',(_0x1b1dde,_0x38c19b)=>{const _0x56ac9f=a0_0x9ae4;_0x38c19b&&_0x38c19b[_0x56ac9f(0x22c)]&&pythonBridge[_0x56ac9f(0x24a)](this,'ANALYZE_GAIT',{'sequences':JSON[_0x56ac9f(0x1c6)](_0x38c19b[_0x56ac9f(0x22c)])});});}catch(_0x138596){}}async[a0_0x131c1c(0x1bd)](){const _0x2d6c2b=a0_0x131c1c;if(!this['isProVersion'])return;try{const _0x919b99=await recorder[_0x2d6c2b(0x1f6)](this);if(_0x919b99===null)return;const _0x235679={},_0x447340={},_0x46cf5c=this['config'][_0x2d6c2b(0x221)]||[];for(const _0x1800c9 of _0x46cf5c){if(_0x1800c9[_0x2d6c2b(0x24d)]===_0x2d6c2b(0x18c)&&_0x1800c9[_0x2d6c2b(0x1b1)]){const _0xf854a7=this[_0x2d6c2b(0x1aa)][_0x1800c9['id']];if(_0xf854a7!==undefined)_0x235679[_0x1800c9[_0x2d6c2b(0x1b1)]]=_0xf854a7;if(_0x1800c9[_0x2d6c2b(0x1a3)])_0x447340[_0x1800c9[_0x2d6c2b(0x1b1)]]=!![];}}const _0x235b65=await this[_0x2d6c2b(0x1a0)]();Object['keys'](_0x235679)[_0x2d6c2b(0x1df)]>0x0&&(pythonBridge[_0x2d6c2b(0x24a)](this,_0x2d6c2b(0x1cf),{'current_temps':_0x235679,'t_out':_0x919b99,'is_sunny':_0x235b65,'solar_flags':_0x447340}),pythonBridge['send'](this,_0x2d6c2b(0x255),{'current_temps':_0x235679,'t_out':_0x919b99,'targets':{}}));}catch(_0x485263){}}['updateHealthVector'](){const _0x36254a=a0_0x131c1c;if(!this[_0x36254a(0x20b)]||this[_0x36254a(0x20b)][_0x36254a(0x1df)]===0x0)return;const _0x13dfd1=new Array(0x60)[_0x36254a(0x237)](0x0),_0x2429d5=new Date()['setHours'](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x36254a(0x267)](_0x4b9506=>{const _0xf6f738=_0x36254a,_0x4a8a4=new Date(_0x4b9506[_0xf6f738(0x26f)]);if(_0x4a8a4[_0xf6f738(0x1d1)]()>=_0x2429d5){const _0x5402cc=_0x4a8a4[_0xf6f738(0x211)](),_0x2cb58d=_0x4a8a4[_0xf6f738(0x227)](),_0xcd201a=_0x5402cc*0x4+Math['floor'](_0x2cb58d/0xf);if(_0xcd201a>=0x0&&_0xcd201a<0x60)_0x13dfd1[_0xcd201a]++;}}),this[_0x36254a(0x220)](_0x36254a(0x225),{'val':JSON['stringify'](_0x13dfd1),'ack':!![]});}['runPythonHealthCheck'](){const _0x31684e=a0_0x131c1c;if(!this[_0x31684e(0x1ad)]||this[_0x31684e(0x1ad)][_0x31684e(0x1df)]<0x2)return;const _0x541fd5=this['dailyDigests'][_0x31684e(0x189)](_0x2ffa06=>{const _0x50c660=_0x31684e,_0x4a94ca=(_0x2ffa06[_0x50c660(0x249)]||'')[_0x50c660(0x194)]();return ACTIVITY_LEVEL_MAP[_0x4a94ca]||0x32;});pythonBridge[_0x31684e(0x24a)](this,_0x31684e(0x232),{'values':_0x541fd5,'tag':'Activity-Level'});}}if(require[a0_0x131c1c(0x275)]!==module)module['exports']=_0x4c2647=>new CogniLiving(_0x4c2647);else new CogniLiving();