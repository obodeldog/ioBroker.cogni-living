const a0_0x56cb60=a0_0x17ba;(function(_0x4221ac,_0x38fe73){const _0x2cee8b=a0_0x17ba,_0x4d49c9=_0x4221ac();while(!![]){try{const _0x5487d=parseInt(_0x2cee8b(0x187))/0x1*(-parseInt(_0x2cee8b(0x255))/0x2)+-parseInt(_0x2cee8b(0x14e))/0x3+-parseInt(_0x2cee8b(0x27d))/0x4*(parseInt(_0x2cee8b(0x151))/0x5)+parseInt(_0x2cee8b(0x27f))/0x6+parseInt(_0x2cee8b(0x1e2))/0x7*(-parseInt(_0x2cee8b(0x16c))/0x8)+parseInt(_0x2cee8b(0x25e))/0x9*(parseInt(_0x2cee8b(0x130))/0xa)+-parseInt(_0x2cee8b(0x168))/0xb*(-parseInt(_0x2cee8b(0x18d))/0xc);if(_0x5487d===_0x38fe73)break;else _0x4d49c9['push'](_0x4d49c9['shift']());}catch(_0x10b146){_0x4d49c9['push'](_0x4d49c9['shift']());}}}(a0_0x5e18,0x3d7c0));const a0_0x430919=(function(){let _0xc5f920=!![];return function(_0x3655f4,_0x5e57f6){const _0x2776ff=_0xc5f920?function(){const _0x6ac825=a0_0x17ba;if(_0x5e57f6){const _0x7b6099=_0x5e57f6[_0x6ac825(0x241)](_0x3655f4,arguments);return _0x5e57f6=null,_0x7b6099;}}:function(){};return _0xc5f920=![],_0x2776ff;};}()),a0_0x14d7a0=a0_0x430919(this,function(){const _0xc02a1f=a0_0x17ba;return a0_0x14d7a0['toString']()[_0xc02a1f(0x2ab)](_0xc02a1f(0x143))[_0xc02a1f(0x195)]()[_0xc02a1f(0x268)](a0_0x14d7a0)['search']('(((.+)+)+)+$');});a0_0x14d7a0();'use strict';const utils=require(a0_0x56cb60(0x1d1)),{GoogleGenerativeAI}=require(a0_0x56cb60(0x179)),schedule=require(a0_0x56cb60(0x21f)),{spawn,exec}=require(a0_0x56cb60(0x1f0)),path=require(a0_0x56cb60(0x22d)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x56cb60(0x20d),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x56cb60(0x1d2),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x56cb60(0x2ad),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x56cb60(0x166),LTM_DP_BASELINE_STATUS=a0_0x56cb60(0x1e8),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x56cb60(0x149),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x56cb60(0x190),SYSTEM_MODES={'NORMAL':'normal','VACATION':'vacation','PARTY':a0_0x56cb60(0x24a),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x56cb60(0x233)]],PERSONA_MAPPING={'generic':a0_0x56cb60(0x263),'senior_aal':a0_0x56cb60(0x194),'family':a0_0x56cb60(0x1e7),'single_comfort':a0_0x56cb60(0x24e),'security':a0_0x56cb60(0x145)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},HARD_IGNORE_TERMS=[a0_0x56cb60(0x267),a0_0x56cb60(0x2af),a0_0x56cb60(0x116),a0_0x56cb60(0x113),a0_0x56cb60(0x2ae),a0_0x56cb60(0x2a6),a0_0x56cb60(0x226),a0_0x56cb60(0x21d),a0_0x56cb60(0x15b),'fault',a0_0x56cb60(0x298),a0_0x56cb60(0x28f),a0_0x56cb60(0x1d9),a0_0x56cb60(0x182),a0_0x56cb60(0x277),a0_0x56cb60(0x240),'reachable',a0_0x56cb60(0x23f)],BAD_NAMES=[a0_0x56cb60(0x283),a0_0x56cb60(0x1c4),a0_0x56cb60(0x2aa),a0_0x56cb60(0x18a),'value',a0_0x56cb60(0x26b),'on','off',a0_0x56cb60(0x11c),'position',a0_0x56cb60(0x1a2),a0_0x56cb60(0x24b),a0_0x56cb60(0x11f),a0_0x56cb60(0x1b5),a0_0x56cb60(0x19b),a0_0x56cb60(0x1b6),a0_0x56cb60(0x13d),a0_0x56cb60(0x23a),a0_0x56cb60(0x212),a0_0x56cb60(0x2a9),'energy',a0_0x56cb60(0x1c2),'valve',a0_0x56cb60(0x11a),a0_0x56cb60(0x183)],ADAPTER_BLACKLIST=[a0_0x56cb60(0x230),a0_0x56cb60(0x1c7),a0_0x56cb60(0x20b),a0_0x56cb60(0x1f4),a0_0x56cb60(0x1f5),a0_0x56cb60(0x17c),a0_0x56cb60(0x236),a0_0x56cb60(0x13f),a0_0x56cb60(0x221),'javascript.','simple-api.'],IS_WIN=process[a0_0x56cb60(0x264)]===a0_0x56cb60(0x1af),VENV_PATH=path[a0_0x56cb60(0x248)](__dirname,a0_0x56cb60(0x259)),PYTHON_EXE=IS_WIN?path[a0_0x56cb60(0x248)](VENV_PATH,a0_0x56cb60(0x1e4),a0_0x56cb60(0x28c)):path['join'](VENV_PATH,'bin','python'),PIP_EXE=IS_WIN?path[a0_0x56cb60(0x248)](VENV_PATH,a0_0x56cb60(0x1e4),a0_0x56cb60(0x126)):path['join'](VENV_PATH,a0_0x56cb60(0x135),'pip');let activeSequence=[],sequenceTimer=null;async function initZombies(_0x342162){const _0x574ab2=a0_0x56cb60;try{const _0x379b34=[_0x574ab2(0x172),_0x574ab2(0x23b)];for(const _0x5a1b9f of _0x379b34){try{const _0x4fd457=await _0x342162[_0x574ab2(0x280)](_0x5a1b9f);if(_0x4fd457)await _0x342162[_0x574ab2(0x140)](_0x5a1b9f);}catch(_0x2a56a3){}}}catch(_0x3ef5b1){}}async function initHistory(_0x30d757){const _0x583ae6=a0_0x56cb60;try{const _0xf1e3e9=await _0x30d757[_0x583ae6(0x1cc)](_0x583ae6(0x247));_0xf1e3e9&&_0xf1e3e9[_0x583ae6(0x25d)]&&(_0x30d757[_0x583ae6(0x129)]=JSON[_0x583ae6(0x27b)](_0xf1e3e9[_0x583ae6(0x25d)]['toString']()));}catch(_0x4ea212){_0x30d757[_0x583ae6(0x129)]=[];}try{const _0x3d0efe=await _0x30d757[_0x583ae6(0x1cc)](_0x583ae6(0x125));if(_0x3d0efe&&_0x3d0efe['val'])_0x30d757[_0x583ae6(0x191)]=JSON[_0x583ae6(0x27b)](_0x3d0efe['val'][_0x583ae6(0x195)]());}catch(_0x3db89c){_0x30d757[_0x583ae6(0x191)]=[];}if(_0x30d757[_0x583ae6(0x129)]&&_0x30d757['eventHistory'][_0x583ae6(0x2a2)]>0x0){_0x30d757['log'][_0x583ae6(0x141)](_0x583ae6(0x20e)+_0x30d757[_0x583ae6(0x129)]['length']+_0x583ae6(0x1bf));for(let _0x4a2b6f=_0x30d757[_0x583ae6(0x129)][_0x583ae6(0x2a2)]-0x1;_0x4a2b6f>=0x0;_0x4a2b6f--){const _0x11bbac=_0x30d757[_0x583ae6(0x129)][_0x4a2b6f];if(_0x11bbac&&_0x11bbac['id']!==undefined&&_0x11bbac['value']!==undefined)_0x30d757[_0x583ae6(0x1a1)][_0x11bbac['id']]=_0x11bbac['value'];}}}async function initSystemConfig(_0x1c4150){const _0x1fd0e4=a0_0x56cb60;try{const _0x3ca3b9=await _0x1c4150[_0x1fd0e4(0x1d4)](_0x1fd0e4(0x222));if(_0x3ca3b9&&_0x3ca3b9[_0x1fd0e4(0x29a)])_0x1c4150['systemConfig']={'latitude':_0x3ca3b9[_0x1fd0e4(0x29a)][_0x1fd0e4(0x2b5)]||0x0,'longitude':_0x3ca3b9['common'][_0x1fd0e4(0x199)]||0x0,'city':_0x3ca3b9[_0x1fd0e4(0x29a)]['city']||''};}catch(_0x2993c7){}}async function checkLicense(_0x152f46,_0x4ba0c6){return!![];}async function getSystemUUID(_0x5b69c1){const _0x2f7d3b=a0_0x56cb60;return _0x2f7d3b(0x24d);}async function loadRawEventLog(_0x53d957){const _0x338a47=a0_0x56cb60;try{const _0x2a22ca=await _0x53d957[_0x338a47(0x1cc)](LTM_DP_RAW_LOG);if(_0x2a22ca&&_0x2a22ca[_0x338a47(0x25d)])_0x53d957[_0x338a47(0x1d3)]=JSON[_0x338a47(0x27b)](_0x2a22ca[_0x338a47(0x25d)]);}catch(_0x354d5){_0x53d957['rawEventLog']=[];}}async function saveRawEventLog(_0x451f3b){const _0xa34fce=a0_0x56cb60;if(_0x451f3b[_0xa34fce(0x1d3)][_0xa34fce(0x2a2)]>RAW_LOG_MAX_SIZE)_0x451f3b['rawEventLog']['splice'](0x0,_0x451f3b[_0xa34fce(0x1d3)]['length']-RAW_LOG_MAX_SIZE);await _0x451f3b[_0xa34fce(0x193)](LTM_DP_RAW_LOG,{'val':JSON[_0xa34fce(0x1ac)](_0x451f3b[_0xa34fce(0x1d3)]),'ack':!![]});}async function loadDailyDigests(_0x3cc865){const _0x5d079c=a0_0x56cb60;try{const _0x185ddd=await _0x3cc865[_0x5d079c(0x1cc)](LTM_DP_DAILY_DIGESTS);if(_0x185ddd&&_0x185ddd[_0x5d079c(0x25d)])_0x3cc865[_0x5d079c(0x178)]=JSON[_0x5d079c(0x27b)](_0x185ddd[_0x5d079c(0x25d)]);}catch(_0x4a59bf){_0x3cc865['dailyDigests']=[];}await updateBaselineStatus(_0x3cc865);}async function saveDailyDigests(_0x54cf1f,_0x3fee43=!![]){const _0x36feaf=a0_0x56cb60,_0x97e274=_0x54cf1f[_0x36feaf(0x153)][_0x36feaf(0x21e)]||0x3c;_0x54cf1f[_0x36feaf(0x178)]['length']>_0x97e274&&_0x54cf1f[_0x36feaf(0x178)][_0x36feaf(0x28b)](0x0,_0x54cf1f[_0x36feaf(0x178)][_0x36feaf(0x2a2)]-_0x97e274);await _0x54cf1f['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x36feaf(0x1ac)](_0x54cf1f[_0x36feaf(0x178)]),'ack':!![]});if(_0x3fee43)await updateBaselineStatus(_0x54cf1f);}async function updateAnalysisHistory(_0x1cb061,_0x2aa8ed){const _0x5261c6=a0_0x56cb60;_0x1cb061[_0x5261c6(0x191)]['unshift'](_0x2aa8ed);if(_0x1cb061[_0x5261c6(0x191)][_0x5261c6(0x2a2)]>ANALYSIS_HISTORY_MAX_SIZE)_0x1cb061[_0x5261c6(0x191)][_0x5261c6(0x13b)]();await _0x1cb061[_0x5261c6(0x193)](_0x5261c6(0x125),{'val':JSON[_0x5261c6(0x1ac)](_0x1cb061['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0xe0ac69){const _0x314d4d=a0_0x56cb60;if(!_0xe0ac69[_0x314d4d(0x150)]){await _0xe0ac69[_0x314d4d(0x193)](LTM_DP_BASELINE_STATUS,{'val':_0x314d4d(0x224),'ack':!![]});return;}const _0xccf7a6=_0xe0ac69[_0x314d4d(0x178)][_0x314d4d(0x2a2)]>=(_0xe0ac69[_0x314d4d(0x153)][_0x314d4d(0x15c)]||0x7)?'Aktiv\x20('+_0xe0ac69[_0x314d4d(0x178)][_0x314d4d(0x2a2)]+_0x314d4d(0x23d):_0x314d4d(0x1b2)+_0xe0ac69[_0x314d4d(0x178)][_0x314d4d(0x2a2)]+'/'+(_0xe0ac69[_0x314d4d(0x153)]['minDaysForBaseline']||0x7)+')';await _0xe0ac69[_0x314d4d(0x193)](LTM_DP_BASELINE_STATUS,{'val':_0xccf7a6,'ack':!![]});}async function loadSystemMode(_0x1a9fb2){const _0x5aa851=a0_0x56cb60;try{const _0x54fe24=await _0x1a9fb2['getStateAsync'](SYSTEM_DP_MODE);_0x54fe24&&_0x54fe24[_0x5aa851(0x25d)]&&Object[_0x5aa851(0x276)](SYSTEM_MODES)['includes'](_0x54fe24[_0x5aa851(0x25d)])?_0x1a9fb2[_0x5aa851(0x1c3)]=_0x54fe24['val']:(_0x1a9fb2[_0x5aa851(0x1c3)]=SYSTEM_MODES['NORMAL'],await _0x1a9fb2[_0x5aa851(0x193)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x5aa851(0x154)],'ack':!![]}));}catch(_0x306414){_0x1a9fb2[_0x5aa851(0x1c3)]=SYSTEM_MODES[_0x5aa851(0x154)];}}async function createAllObjects(_0x7a97c0){const _0x3aa979=a0_0x56cb60;await _0x7a97c0[_0x3aa979(0x215)](_0x3aa979(0x227),{'type':'channel','common':{'name':'System'},'native':{}}),await _0x7a97c0[_0x3aa979(0x215)](SYSTEM_DP_MODE,{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x13c),'type':_0x3aa979(0x265),'role':_0x3aa979(0x2aa),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x3aa979(0x154)]},'native':{}}),await _0x7a97c0['setObjectNotExistsAsync']('system.presenceWho',{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x171),'type':_0x3aa979(0x265),'role':_0x3aa979(0x1b0),'read':!![],'write':![]},'native':{}}),await _0x7a97c0['setObjectNotExistsAsync'](_0x3aa979(0x188),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x295),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x7a97c0['setObjectNotExistsAsync'](_0x3aa979(0x247),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x1b8),'type':_0x3aa979(0x265),'role':'json','read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x215)]('analysis.training',{'type':_0x3aa979(0x22b),'common':{'name':_0x3aa979(0x1be)},'native':{}}),await _0x7a97c0['setObjectNotExistsAsync']('analysis.training.triggerSecurity',{'type':'state','common':{'name':_0x3aa979(0x136),'type':_0x3aa979(0x26c),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x1df),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x274),'type':_0x3aa979(0x26c),'role':_0x3aa979(0x1f3),'read':!![],'write':!![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x20a),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x155),'type':'boolean','role':_0x3aa979(0x1f3),'read':!![],'write':!![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x115),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x16f),'type':'string','role':_0x3aa979(0x1b0),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x215)]('analysis.security',{'type':_0x3aa979(0x22b),'common':{'name':'Security\x20Monitor'},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)]('analysis.security.lastScore',{'type':_0x3aa979(0x2aa),'common':{'name':'Anomaly\x20Score','type':'number','role':_0x3aa979(0x15e),'read':!![],'write':![]},'native':{}}),await _0x7a97c0['setObjectNotExistsAsync'](_0x3aa979(0x228),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x297),'type':_0x3aa979(0x265),'role':'date','read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x215)](_0x3aa979(0x289),{'type':_0x3aa979(0x22b),'common':{'name':'Health\x20Analysis'},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x24f),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x297),'type':_0x3aa979(0x265),'role':_0x3aa979(0x14b),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x2a8),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x148),'type':_0x3aa979(0x26c),'role':_0x3aa979(0x197),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x26f),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x162),'type':_0x3aa979(0x265),'role':_0x3aa979(0x1b0),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x1a5),{'type':'state','common':{'name':_0x3aa979(0x1fb),'type':_0x3aa979(0x246),'role':_0x3aa979(0x15e),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x215)](_0x3aa979(0x1d8),{'type':_0x3aa979(0x22b),'common':{'name':_0x3aa979(0x285)},'native':{}}),await _0x7a97c0['setObjectNotExistsAsync'](_0x3aa979(0x139),{'type':_0x3aa979(0x2aa),'common':{'name':'Insulation\x20Score','type':_0x3aa979(0x265),'role':'text','read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x2a1),{'type':_0x3aa979(0x2aa),'common':{'name':'Heating\x20Score','type':_0x3aa979(0x265),'role':_0x3aa979(0x1b0),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x215)](_0x3aa979(0x19a),{'type':'channel','common':{'name':_0x3aa979(0x19a)},'native':{}}),await _0x7a97c0[_0x3aa979(0x215)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x3aa979(0x294),'type':_0x3aa979(0x265),'role':_0x3aa979(0x137),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x215)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x3aa979(0x1db),'type':_0x3aa979(0x265),'role':'json','read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x16b),{'type':_0x3aa979(0x2aa),'common':{'name':'Sequences','type':_0x3aa979(0x265),'role':_0x3aa979(0x137),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x1e5),{'type':'state','common':{'name':'Thermodynamics','type':_0x3aa979(0x265),'role':_0x3aa979(0x137),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)]('analysis.trigger',{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x170),'type':'boolean','role':_0x3aa979(0x1f3),'read':!![],'write':!![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x1e3),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x1d6),'type':'boolean','role':_0x3aa979(0x1f3),'read':!![],'write':!![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)]('analysis.isAlert',{'type':_0x3aa979(0x2aa),'common':{'name':'Alert\x20Status','type':_0x3aa979(0x26c),'role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)]('analysis.alertReason',{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x206),'type':'string','role':_0x3aa979(0x1ec),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x26e),{'type':'state','common':{'name':_0x3aa979(0x275),'type':_0x3aa979(0x265),'role':_0x3aa979(0x1b0),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x147),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x11b),'type':'boolean','role':_0x3aa979(0x197),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x25b),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x133),'type':_0x3aa979(0x265),'role':_0x3aa979(0x1b0),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x23e),{'type':_0x3aa979(0x2aa),'common':{'name':'Target\x20ID','type':'string','role':_0x3aa979(0x1b0),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x20f),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x169),'type':_0x3aa979(0x265),'role':_0x3aa979(0x1b0),'read':!![],'write':![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x249),{'type':_0x3aa979(0x2aa),'common':{'name':'Auto\x20Apply','type':'boolean','role':'switch','read':!![],'write':!![]},'native':{}}),await _0x7a97c0[_0x3aa979(0x208)](_0x3aa979(0x225),{'type':_0x3aa979(0x2aa),'common':{'name':_0x3aa979(0x13e),'type':_0x3aa979(0x26c),'role':_0x3aa979(0x1f3),'read':!![],'write':!![]},'native':{}});}async function recordThermodynamics(_0x50eb95,_0x226363,_0x399313,_0x2cbdcf){const _0x787147=a0_0x56cb60,_0x3b1ff5=await getOutsideTemperatureNumeric(_0x50eb95),_0x12541b=await _0x50eb95[_0x787147(0x1cc)](_0x787147(0x1e5));let _0x27bd3c=[];if(_0x12541b&&_0x12541b['val'])try{_0x27bd3c=JSON[_0x787147(0x27b)](_0x12541b['val']);}catch(_0x58a537){}_0x27bd3c[_0x787147(0x1bb)]({'ts':Date[_0x787147(0x119)](),'room':_0x2cbdcf||'Unknown','t_in':_0x399313,'t_out':_0x3b1ff5});if(_0x27bd3c[_0x787147(0x2a2)]>THERMO_LOG_SIZE)_0x27bd3c[_0x787147(0x1e9)]();await _0x50eb95[_0x787147(0x193)]('LTM.trainingData.thermodynamics',{'val':JSON[_0x787147(0x1ac)](_0x27bd3c),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x25ba56){const _0x5cb804=a0_0x56cb60;if(_0x25ba56['config']['outdoorSensorId'])try{const _0x55a497=await _0x25ba56[_0x5cb804(0x1ca)](_0x25ba56[_0x5cb804(0x153)][_0x5cb804(0x14c)]);if(_0x55a497&&_0x55a497['val']!==undefined&&_0x55a497[_0x5cb804(0x25d)]!==null)return parseFloat(_0x55a497['val']);}catch(_0x2e93eb){}const _0x3850c8=_0x25ba56['config']['weatherInstance'];if(!_0x25ba56[_0x5cb804(0x153)][_0x5cb804(0x2a4)]||!_0x3850c8)return null;try{let _0x248569='';if(_0x3850c8[_0x5cb804(0x15d)](_0x5cb804(0x1ee)))_0x248569=_0x3850c8+_0x5cb804(0x29d);else{if(_0x3850c8['includes']('daswetter'))_0x248569=_0x3850c8+_0x5cb804(0x1a8);else{if(_0x3850c8[_0x5cb804(0x15d)](_0x5cb804(0x12b)))_0x248569=_0x3850c8+'.forecast.current.temperature';else{if(_0x3850c8[_0x5cb804(0x15d)](_0x5cb804(0x120)))_0x248569=_0x3850c8+_0x5cb804(0x284);}}}if(_0x248569){const _0x279ed5=await _0x25ba56[_0x5cb804(0x1ca)](_0x248569);if(_0x279ed5&&_0x279ed5[_0x5cb804(0x25d)]!==undefined&&_0x279ed5[_0x5cb804(0x25d)]!==null)return parseFloat(_0x279ed5['val']);}}catch(_0x1cb1d3){}return null;}function a0_0x5e18(){const _0x5a5436=['LTM.triggerDailyDigest','siren','11jwZyMk','Target\x20Value','autoApply','LTM.trainingData.sequences','23480kNOCUZ','expire','endsWith','Training\x20Status','Trigger\x20Analysis','Who\x20is\x20present?','analysis.history_debug_00','communicate.request','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','dependencyInstallInProgress','SECURITY_RESULT','object','dailyDigests','@google/generative-ai','analysis.trigger','cancel','material.','âœ…\x20HEALTH\x20TRAINED:\x20','getHours','python3\x20-m\x20venv\x20\x22','Gemini\x20Init\x20Error:\x20','BUTLER\x20Execution\x20Error:\x20','config_pending','set_temperature','ready','TRAIN_SECURITY','STDOUT:\x20','4oWIDoZ','events.lastEvent','name','level','TRAIN_ENERGY','location','5785692pUmCEH','loc','close','system.mode','analysisHistory','COGNI_CONFIRM_OK','setStateAsync','PRIORITÃ„T:\x20Gesundheit/AAL.','toString','ack','indicator','TREND_RESULT','longitude','LTM','motion','Alarm','cpu_feature_guard','heizung','HEALTH_TRAIN_RESULT','onUnload','sensorLastValues','shutter','dismissAutomation','startsWith','analysis.health.trendValue','Error\x20launching\x20Python:\x20','sendToAsync','.NextHours.Location_1.Day_1.current.temp_value','timestamp','light','driftAnalysisTimer','stringify','type','cogni-living\x20adapter\x20starting\x20(v','win32','text','fill','Lernphase\x20(','VACATION','enum.functions.*','status','presence','getTime','Event\x20History','notifyTelegramEnabled','application/json','push','data','python_service','AI\x20Training','\x20events)...','analysis.alertReason','Failed:\x20','setpoint','currentSystemMode','currentposition','enum','targetId','admin.','HEALTH_RESULT','stdout','getForeignStateAsync','contact','getStateAsync','klima','write','pythonProcess','inactivityMonitoringEnabled','@iobroker/adapter-core','0\x204\x20*\x20*\x20*','rawEventLog','getForeignObjectAsync','lastAlertState','Trigger\x20Briefing','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','analysis.energy','stick_unreach','ðŸ› ï¸\x20MAINTENANCE:\x20Fixing\x20Python\x20environment\x20(Delete\x20&\x20Reinstall)...','Daily\x20Digests','getGenerativeModel','triggerBriefing','ðŸ›¡ï¸\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','analysis.training.triggerHealth','toLowerCase','Gemini\x20AI\x20initialized.','1036ECDpvT','analysis.triggerBriefing','Scripts','LTM.trainingData.thermodynamics','unknown','Fokus\x20auf\x20Familienroutinen.','LTM.baselineStatus','shift','toFixed','geminiApiKey','text.alarm','scanDevices','accuweather','analysis.isAlert','child_process','No\x20module\x20named','Adapter','button','vis.','history.','debug','detected','isGracePeriodActive','insulation','subscribeForeignStatesAsync','Trend\x20Value','âœ…\x20Alles\x20OK\x20(Reset)]','Sec-Training\x20started...','some','warn','genAI','writable','ðŸ\x20Python\x20Pong','Kein\x20API\x20Key!','[PYTHON\x20ERR]\x20','[RESULT]','Alert\x20Reason','WiFi\x20Presence\x20detected.','setObjectNotExistsAsync','setState','analysis.training.triggerEnergy','info.','onStateChange','models/gemini-flash-latest','Restoring\x20sensor\x20cache\x20from\x20history\x20(','analysis.automation.targetValue','stateChange','ðŸ\x20Using\x20VENV:\x20','humidity','map','analysisTimer','extendObjectAsync','unshift','testContext','geminiModel','python3','Missing\x20data','kill','sendTo','maintenance','ltmLtbWindowDays','node-schedule','subscribeStates','echarts.','system.config','cogni-living','Deaktiviert\x20(Pro-Feature)','analysis.automation.triggerAction','connection','system','analysis.security.lastCheck',').\x20Triggering\x20FULL\x20REINSTALL.','requirements.txt','channel','modeResetJob','path','ANALYZE_TREND','No\x20instance','system.','existsSync','simulateButler','GUEST','retry','message','icons-mfd.','analysis.security.lastScore','callback','telegram','temperature','events.history_debug_00','forEach','\x20Tage)','analysis.automation.targetId','link_quality','firmware','apply','stderr','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','main','testApiKey','number','events.history','join','analysis.automation.autoApply','party','blind','bewegung','uuid','Fokus\x20auf\x20Komfort.','analysis.health.lastCheck','Cogni-Living','licenseKey','schalter','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','isExit','30896SLngXZ','notifyTelegramInstance','window','stdin','.venv','response','analysis.automation.description','ðŸ\x20Stopping\x20Python...','val','993042GZohkl','getForeignObjectsAsync','targetValue','apiKey','getMonth','Analysiere\x20ausgewogen.','platform','string','ðŸ\x20Guardian\x20Diagnosis:\x20','scriptProblem','constructor','HARD\x20WATCHDOG:\x20No\x20activity\x20for\x20','notifyPushoverRecipient','brightness','boolean','send','analysis.activitySummary','analysis.health.trendDiagnosis','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','description','getLtmData','exitGraceTimer','Train\x20Health','Activity\x20Summary','values','dutycycle','find','COGNI_REQUEST_CALL','dimmer','parse','setForeignStateAsync','48948PWABSZ','exitTimer','2198808nuXTcq','getObjectAsync','filter','isPresent','targetposition','.forecast.current.temp','Energy\x20Intelligence','generateContent','automation.triggerAction','ltmJob','analysis.health','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','splice','python.exe','logDuplicates','substring','direction','devices','sound','notifyPushoverEnabled','payload','Raw\x20Log','Last\x20raw\x20event','prÃ¤senz','Last\x20Check','working','âœ…\x20INSTALLATION\x20COMPLETE.\x20Starting\x20Service...','common','ðŸš¨\x20EMERGENCY','trim','.Current.Temperature','system.presenceWho','Training\x20Error:\x20','getCalendarNames','analysis.energy.heatingScore','length','lampe','useWeather','KI-Modell\x20nicht\x20initialisiert','rssi','Success:\x20','analysis.health.isAnomaly','power','state','search','Failed\x20to\x20delete\x20.venv:\x20','LTM.rawEventLog','lowbat','scriptEnabled','getEnums','TRAIN_HEALTH','[LOG]','command','[RECORDER]\x20Error\x20saving\x20sequence:\x20','latitude','indexOf','unreach','round','analysis.training.status','update','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','service.py','now','actual_temperature','Pattern\x20Detected','switch','ANOMALY','Kein\x20API\x20Key.','cover','weatherunderground','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','Invalid\x20JSON:\x20','activityLevel','Activity-Level','analysis.analysisHistory','pip.exe','inactivityThresholdHours','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','eventHistory','Deleted\x20old\x20.venv\x20folder.','openweathermap','unload','systemUUID','getDate','version','10GzguQd','bind','rmSync','Description','âš ï¸\x20VENV\x20missing.\x20Installing...','bin','Train\x20Security','json','from','analysis.energy.insulationScore','slice','pop','System\x20Mode','occupancy','Trigger\x20Action','flot.','delObjectAsync','info','presenceDevices','(((.+)+)+)+$','analysis.training.triggerSecurity','PRIORITÃ„T:\x20Sicherheit.','ðŸ§ \x20Triggering\x20Security\x20Training...','analysis.automation.patternDetected','Anomaly\x20Detected','LTM.driftAnalysis.baselineDrift','system.isPresent','date','outdoorSensorId','split','522672uIwriX','door','isProVersion','15LoaFPk','onMessage','config','NORMAL','Train\x20Energy','log','tÃ¼r','notifyTelegramRecipient','OK:\x20','briefingJob','error','minDaysForBaseline','includes','value','temperatur',')\x20-\x20FORCE\x20CLEAN\x20INSTALL','toISOString','Trend','ANALYZE_SEQUENCE','N/A','toLocaleTimeString'];a0_0x5e18=function(){return _0x5a5436;};return a0_0x5e18();}async function recordSequence(_0x1b2d9b,_0x2fb597){const _0x4c64dc=a0_0x56cb60,_0x3ebf23=(_0x2fb597['type']||'')[_0x4c64dc(0x1e0)](),_0xea1f4e=[_0x4c64dc(0x19b),_0x4c64dc(0x24c),_0x4c64dc(0x296),'presence',_0x4c64dc(0x13d),_0x4c64dc(0x14f),_0x4c64dc(0x157),_0x4c64dc(0x257),'fenster',_0x4c64dc(0x1cb),'kontakt',_0x4c64dc(0x1aa),'licht',_0x4c64dc(0x11c),_0x4c64dc(0x252),_0x4c64dc(0x27a),_0x4c64dc(0x2a3)];if(!_0xea1f4e[_0x4c64dc(0x1fe)](_0x186e4a=>_0x3ebf23[_0x4c64dc(0x15d)](_0x186e4a)))return;if(!_0x2fb597[_0x4c64dc(0x15e)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x4c64dc(0x1bb)]({'loc':_0x2fb597['location']||'Unknown','id':_0x2fb597['id'],'ts':Date['now']()}),_0x1b2d9b[_0x4c64dc(0x156)][_0x4c64dc(0x1f6)](_0x4c64dc(0x128)+_0x2fb597['location']+'\x20(Length:\x20'+activeSequence[_0x4c64dc(0x2a2)]+')'),sequenceTimer=setTimeout(async()=>{const _0x2f0c1f=_0x4c64dc;if(activeSequence[_0x2f0c1f(0x2a2)]>0x1)await saveCompletedSequence(_0x1b2d9b);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x45b785){const _0x5ba1ed=a0_0x56cb60;try{const _0x5d5761=await _0x45b785[_0x5ba1ed(0x1cc)](_0x5ba1ed(0x16b));let _0x32b97f=[];if(_0x5d5761&&_0x5d5761[_0x5ba1ed(0x25d)])try{_0x32b97f=JSON[_0x5ba1ed(0x27b)](_0x5d5761[_0x5ba1ed(0x25d)]);}catch(_0x1db9c3){}const _0x395415=activeSequence[0x0]['ts'],_0x45f0bc=activeSequence[_0x5ba1ed(0x213)](_0xedbab1=>({'loc':_0xedbab1[_0x5ba1ed(0x18e)],'t_delta':Math[_0x5ba1ed(0x114)]((_0xedbab1['ts']-_0x395415)/0x3e8)})),_0x809768={'timestamp':new Date(_0x395415)[_0x5ba1ed(0x161)](),'steps':_0x45f0bc,'duration':Math[_0x5ba1ed(0x114)]((activeSequence[activeSequence[_0x5ba1ed(0x2a2)]-0x1]['ts']-_0x395415)/0x3e8),'daytime':new Date(_0x395415)[_0x5ba1ed(0x17e)]()};_0x32b97f[_0x5ba1ed(0x1bb)](_0x809768);if(_0x32b97f[_0x5ba1ed(0x2a2)]>MAX_TRAINING_SET_SIZE)_0x32b97f[_0x5ba1ed(0x1e9)]();await _0x45b785[_0x5ba1ed(0x193)](_0x5ba1ed(0x16b),{'val':JSON['stringify'](_0x32b97f),'ack':!![]}),runSecurityCheck(_0x45b785,_0x809768);}catch(_0x57f6ea){_0x45b785['log'][_0x5ba1ed(0x15b)](_0x5ba1ed(0x2b4)+_0x57f6ea[_0x5ba1ed(0x235)]);}}function runSecurityCheck(_0x1ba330,_0x3fb1f7){const _0x2a17ca=a0_0x56cb60;if(!_0x1ba330[_0x2a17ca(0x150)])return;_0x1ba330[_0x2a17ca(0x156)][_0x2a17ca(0x1f6)](_0x2a17ca(0x1de)),sendToPython(_0x1ba330,_0x2a17ca(0x163),{'sequence':_0x3fb1f7});}async function processSensorEvent(_0x70c61e,_0x438cb0,_0x41743f,_0x72086b){const _0x1fe6e9=a0_0x56cb60;if(!_0x72086b)return;const _0x2a8aaa=_0x41743f[_0x1fe6e9(0x25d)],_0x449cde=Date['now'](),_0x111bff=_0x70c61e['sensorLastValues'][_0x438cb0];_0x70c61e['sensorLastValues'][_0x438cb0]=_0x2a8aaa;if(!_0x72086b[_0x1fe6e9(0x28d)]&&_0x111bff!=undefined&&_0x111bff==_0x2a8aaa)return;const _0x231c09=(_0x72086b[_0x1fe6e9(0x1ad)]||'')['toLowerCase'](),_0x30d864=_0x231c09[_0x1fe6e9(0x15d)](_0x1fe6e9(0x23a))||_0x231c09[_0x1fe6e9(0x15d)](_0x1fe6e9(0x15f))||_0x231c09[_0x1fe6e9(0x15d)](_0x1fe6e9(0x1cd))||_0x231c09[_0x1fe6e9(0x15d)](_0x1fe6e9(0x19e));_0x70c61e[_0x1fe6e9(0x150)]&&_0x30d864&&recordThermodynamics(_0x70c61e,_0x438cb0,_0x2a8aaa,_0x72086b[_0x1fe6e9(0x18c)]);const _0x44fe25={'timestamp':_0x449cde,'id':_0x438cb0,'name':_0x72086b[_0x1fe6e9(0x189)],'type':_0x72086b[_0x1fe6e9(0x1ad)],'location':_0x72086b[_0x1fe6e9(0x18c)],'value':_0x2a8aaa};_0x70c61e['eventHistory'][_0x1fe6e9(0x216)](_0x44fe25);if(_0x70c61e[_0x1fe6e9(0x129)]['length']>HISTORY_MAX_SIZE)_0x70c61e['eventHistory'][_0x1fe6e9(0x13b)]();await _0x70c61e['setStateAsync'](_0x1fe6e9(0x188),{'val':JSON['stringify'](_0x44fe25),'ack':!![]}),await _0x70c61e['setStateAsync'](_0x1fe6e9(0x247),{'val':JSON[_0x1fe6e9(0x1ac)](_0x70c61e[_0x1fe6e9(0x129)]),'ack':!![]});_0x70c61e[_0x1fe6e9(0x150)]&&(_0x70c61e[_0x1fe6e9(0x1d3)][_0x1fe6e9(0x1bb)](_0x44fe25),await saveRawEventLog(_0x70c61e),recordSequence(_0x70c61e,_0x44fe25));if(_0x72086b[_0x1fe6e9(0x254)]&&_0x2a8aaa===!![]){if(_0x70c61e['isPresent']&&!_0x70c61e['isGracePeriodActive'])startExitTimer(_0x70c61e);else{if(!_0x70c61e[_0x1fe6e9(0x282)])setPresence(_0x70c61e,!![]);}}else{if(_0x72086b[_0x1fe6e9(0x1ad)]===_0x1fe6e9(0x19b)&&_0x2a8aaa===!![]){if(_0x70c61e[_0x1fe6e9(0x27e)])abortExitTimer(_0x70c61e);if(!_0x70c61e['isPresent']&&_0x70c61e[_0x1fe6e9(0x1c3)]===SYSTEM_MODES[_0x1fe6e9(0x154)])setPresence(_0x70c61e,!![]);}}}function installPythonDependencies(_0x5c1bc5,_0x55a657=![]){const _0x1bf666=a0_0x56cb60;if(_0x5c1bc5[_0x1bf666(0x175)]&&!_0x55a657)return;_0x5c1bc5[_0x1bf666(0x175)]=!![];const _0x3955cb=path['join'](__dirname,_0x1bf666(0x1bd),_0x1bf666(0x22a));_0x5c1bc5[_0x1bf666(0x156)][_0x1bf666(0x141)](_0x1bf666(0x1da)),stopPythonService(_0x5c1bc5);if(fs[_0x1bf666(0x231)](VENV_PATH))try{fs[_0x1bf666(0x132)](VENV_PATH,{'recursive':!![],'force':!![]}),_0x5c1bc5['log'][_0x1bf666(0x141)](_0x1bf666(0x12a));}catch(_0x550f56){_0x5c1bc5['log'][_0x1bf666(0x15b)](_0x1bf666(0x2ac)+_0x550f56[_0x1bf666(0x235)]);}exec(_0x1bf666(0x17f)+VENV_PATH+'\x22',_0x5798f6=>{const _0x347b1c=_0x1bf666;if(_0x5798f6){_0x5c1bc5[_0x347b1c(0x156)]['error']('âŒ\x20VENV\x20CREATION\x20FAILED:\x20'+_0x5798f6[_0x347b1c(0x235)]),_0x5c1bc5[_0x347b1c(0x175)]=![];return;}installRequirementsInVenv(_0x5c1bc5,_0x3955cb);});}function installRequirementsInVenv(_0x2888dc,_0x27963a){const _0x502196=a0_0x56cb60;_0x2888dc[_0x502196(0x156)][_0x502196(0x141)]('Installing\x20dependencies...\x20(This\x20can\x20take\x20>5\x20min)');const _0x921b8a='\x22'+PIP_EXE+'\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22'+_0x27963a+'\x22';exec(_0x921b8a,{'timeout':0x124f80},(_0x16aa46,_0x165e0d,_0x454f0f)=>{const _0x5abcc6=_0x502196;_0x2888dc['dependencyInstallInProgress']=![],_0x16aa46?(_0x2888dc[_0x5abcc6(0x156)]['error']('âŒ\x20PIP\x20INSTALL\x20FAILED:\x20'+(_0x454f0f||_0x16aa46['message'])),_0x2888dc[_0x5abcc6(0x156)][_0x5abcc6(0x15b)](_0x5abcc6(0x186)+_0x165e0d)):(_0x2888dc[_0x5abcc6(0x156)][_0x5abcc6(0x141)](_0x5abcc6(0x299)),startPythonService(_0x2888dc));});}function startPythonService(_0x216f27){const _0x2a6afd=a0_0x56cb60;if(_0x216f27['dependencyInstallInProgress'])return;let _0x4c5e1c=_0x2a6afd(0x219);if(fs[_0x2a6afd(0x231)](PYTHON_EXE))_0x216f27[_0x2a6afd(0x156)][_0x2a6afd(0x141)](_0x2a6afd(0x211)+PYTHON_EXE),_0x4c5e1c=PYTHON_EXE;else{_0x216f27[_0x2a6afd(0x156)][_0x2a6afd(0x1ff)](_0x2a6afd(0x134)),installPythonDependencies(_0x216f27,!![]);return;}try{const _0x1cc595=path[_0x2a6afd(0x248)](__dirname,'python_service',_0x2a6afd(0x118));_0x216f27[_0x2a6afd(0x1cf)]=spawn(_0x4c5e1c,[_0x1cc595]),_0x216f27[_0x2a6afd(0x1cf)][_0x2a6afd(0x1c9)]['on'](_0x2a6afd(0x1bc),_0x4dbeab=>{const _0x4b5f5c=_0x2a6afd,_0x3eeebc=_0x4dbeab['toString']()[_0x4b5f5c(0x14d)]('\x0a');_0x3eeebc['forEach'](_0x1c5458=>{const _0xc04011=_0x4b5f5c,_0x45ec8d=_0x1c5458[_0xc04011(0x29c)]();if(!_0x45ec8d)return;if(_0x45ec8d['startsWith'](_0xc04011(0x2b2)))_0x216f27[_0xc04011(0x156)]['debug']('[PYTHON]\x20'+_0x45ec8d[_0xc04011(0x28e)](0x5)[_0xc04011(0x29c)]());else{if(_0x45ec8d[_0xc04011(0x1a4)](_0xc04011(0x205)))try{const _0x681d34=JSON['parse'](_0x45ec8d[_0xc04011(0x28e)](0x8)[_0xc04011(0x29c)]());handlePythonResult(_0x216f27,_0x681d34);}catch(_0xdfdaa1){_0x216f27[_0xc04011(0x156)][_0xc04011(0x1ff)](_0xc04011(0x122)+_0x45ec8d);}}_0x45ec8d['includes'](_0xc04011(0x1f1))&&(_0x216f27['log'][_0xc04011(0x15b)]('âš ï¸\x20Python\x20Env\x20Broken\x20('+_0x45ec8d+_0xc04011(0x229)),installPythonDependencies(_0x216f27,!![]));});}),_0x216f27[_0x2a6afd(0x1cf)][_0x2a6afd(0x242)]['on'](_0x2a6afd(0x1bc),_0x1122ad=>{const _0x2ce210=_0x2a6afd,_0xcd665a=_0x1122ad['toString']()[_0x2ce210(0x29c)]();if(!_0xcd665a[_0x2ce210(0x15d)](_0x2ce210(0x19d)))_0x216f27[_0x2ce210(0x156)][_0x2ce210(0x15b)](_0x2ce210(0x204)+_0xcd665a);}),_0x216f27[_0x2a6afd(0x1cf)]['on'](_0x2a6afd(0x18f),_0x496c03=>{const _0x3576af=_0x2a6afd;_0x216f27['log'][_0x3576af(0x141)]('[PYTHON]\x20Exited\x20code\x20'+_0x496c03),_0x216f27['pythonProcess']=null;});}catch(_0x5279e6){_0x216f27[_0x2a6afd(0x156)][_0x2a6afd(0x15b)](_0x2a6afd(0x1a6)+_0x5279e6[_0x2a6afd(0x235)]);}}function stopPythonService(_0xc21f3){const _0x1bb6f5=a0_0x56cb60;if(_0xc21f3['pythonProcess']){_0xc21f3['log'][_0x1bb6f5(0x141)](_0x1bb6f5(0x25c));try{_0xc21f3[_0x1bb6f5(0x1cf)][_0x1bb6f5(0x21b)]();}catch(_0x29e5ff){}_0xc21f3[_0x1bb6f5(0x1cf)]=null;}}function handlePythonResult(_0x16abad,_0x4c858c){const _0x18704b=a0_0x56cb60;if(_0x4c858c[_0x18704b(0x1ad)]==='PONG')_0x16abad[_0x18704b(0x156)][_0x18704b(0x1f6)](_0x18704b(0x202));else{if(_0x4c858c[_0x18704b(0x1ad)]===_0x18704b(0x176)){const {anomaly_score:_0x2f92f2,is_anomaly:_0x2255fb,threshold:_0x17ac85}=_0x4c858c[_0x18704b(0x293)];_0x16abad[_0x18704b(0x156)]['info']('ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20'+_0x2f92f2[_0x18704b(0x1ea)](0x5)+'\x20->\x20'+(_0x2255fb?_0x18704b(0x11d):'OK')),_0x16abad[_0x18704b(0x193)](_0x18704b(0x237),{'val':_0x2f92f2,'ack':!![]}),_0x16abad[_0x18704b(0x193)](_0x18704b(0x228),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x2255fb){const _0x58aeb2=_0x18704b(0x1d7)+_0x2f92f2[_0x18704b(0x1ea)](0x4)+')';_0x16abad['setStateAsync'](_0x18704b(0x1ef),{'val':!![],'ack':!![]}),_0x16abad[_0x18704b(0x193)](_0x18704b(0x1c0),{'val':_0x58aeb2,'ack':!![]}),sendNotification(_0x16abad,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x58aeb2,![],!![]);}}else{if(_0x4c858c[_0x18704b(0x1ad)]==='TRAINING_COMPLETE'){const {success:_0xa002d4,details:_0x2298ed}=_0x4c858c[_0x18704b(0x293)];_0x16abad[_0x18704b(0x193)](_0x18704b(0x115),{'val':_0xa002d4?_0x18704b(0x2a7)+new Date()[_0x18704b(0x165)]()+'\x20('+_0x2298ed+')':_0x18704b(0x1c1)+_0x2298ed,'ack':!![]});}else{if(_0x4c858c['type']==='ENERGY_TRAIN_RESULT'){const {success:_0x104f30,details:_0xc4e2ba}=_0x4c858c[_0x18704b(0x293)];if(_0x104f30)try{const _0x521e3e=JSON[_0x18704b(0x27b)](_0xc4e2ba);if(_0x521e3e[_0x18704b(0x1f9)])_0x16abad['setStateAsync'](_0x18704b(0x139),{'val':JSON[_0x18704b(0x1ac)](_0x521e3e['insulation']),'ack':!![]});if(_0x521e3e['heating'])_0x16abad[_0x18704b(0x193)](_0x18704b(0x2a1),{'val':JSON[_0x18704b(0x1ac)](_0x521e3e['heating']),'ack':!![]});}catch(_0x52e01f){}}else{if(_0x4c858c[_0x18704b(0x1ad)]===_0x18704b(0x19f)){const {success:_0x15232d,details:_0x3fc7fd}=_0x4c858c[_0x18704b(0x293)];if(_0x15232d)_0x16abad['log'][_0x18704b(0x141)](_0x18704b(0x17d)+_0x3fc7fd);}else{if(_0x4c858c[_0x18704b(0x1ad)]===_0x18704b(0x1c8)){const {is_anomaly:_0x59491c,details:_0x5ad63a}=_0x4c858c['payload'];_0x16abad[_0x18704b(0x193)](_0x18704b(0x24f),{'val':new Date()[_0x18704b(0x161)](),'ack':!![]}),_0x16abad[_0x18704b(0x193)](_0x18704b(0x2a8),{'val':_0x59491c,'ack':!![]});}else{if(_0x4c858c[_0x18704b(0x1ad)]===_0x18704b(0x198)){const {diagnosis:_0x11b0e7,change_percent:_0x401f4e}=_0x4c858c[_0x18704b(0x293)];_0x16abad[_0x18704b(0x156)][_0x18704b(0x141)](_0x18704b(0x266)+_0x11b0e7+'\x20('+_0x401f4e+'%)'),_0x16abad[_0x18704b(0x193)](_0x18704b(0x26f),{'val':_0x11b0e7,'ack':!![]}),_0x16abad['setStateAsync']('analysis.health.trendValue',{'val':_0x401f4e,'ack':!![]});}}}}}}}}function sendToPython(_0x1cb759,_0x3d1ca4,_0x2943cb={}){const _0x126c89=a0_0x56cb60;if(!_0x1cb759[_0x126c89(0x1cf)]||!_0x1cb759[_0x126c89(0x1cf)]['stdin'][_0x126c89(0x201)])return;const _0x5c328a=JSON[_0x126c89(0x1ac)]({'command':_0x3d1ca4,..._0x2943cb});try{_0x1cb759[_0x126c89(0x1cf)][_0x126c89(0x258)][_0x126c89(0x1ce)](_0x5c328a+'\x0a');}catch(_0x1783a8){}}async function initSensorSubscriptions(_0x2827f9){const _0x549c80=a0_0x56cb60,_0x4c1a10=_0x2827f9[_0x549c80(0x153)][_0x549c80(0x290)];if(_0x4c1a10)for(const _0x2a97ec of _0x4c1a10){await _0x2827f9['subscribeForeignStatesAsync'](_0x2a97ec['id']);}}async function initPresenceSubscriptions(_0xbed36c){const _0x289623=a0_0x56cb60,_0x1c959d=_0xbed36c[_0x289623(0x153)][_0x289623(0x142)];if(_0x1c959d)for(const _0x1fb836 of _0x1c959d){await _0xbed36c[_0x289623(0x1fa)](_0x1fb836);}}async function setupTelegramListener(_0x452c37){const _0x39155b=a0_0x56cb60,_0x226119=_0x452c37[_0x39155b(0x153)][_0x39155b(0x256)];if(_0x452c37[_0x39155b(0x153)][_0x39155b(0x1b9)]&&_0x226119)await _0x452c37['subscribeForeignStatesAsync'](_0x226119+'.communicate.request');}async function checkWifiPresence(_0x1296ff){const _0xe3a5d6=a0_0x56cb60;try{const _0xb55d2e=_0x1296ff[_0xe3a5d6(0x153)][_0xe3a5d6(0x142)]||[];let _0x197a35=![];const _0x1e2419=[];for(const _0x5cc31e of _0xb55d2e){try{const _0x599429=await _0x1296ff[_0xe3a5d6(0x1ca)](_0x5cc31e);_0x599429&&(_0x599429[_0xe3a5d6(0x25d)]===!![]||_0x599429[_0xe3a5d6(0x25d)]==='online'||_0x599429['val']===0x1)&&(_0x197a35=!![],_0x1e2419[_0xe3a5d6(0x1bb)](_0x5cc31e));}catch(_0x2aa60f){}}return await _0x1296ff['setStateAsync'](_0xe3a5d6(0x29e),{'val':_0x1e2419[_0xe3a5d6(0x248)](',\x20'),'ack':!![]}),_0x197a35&&(_0x1296ff[_0xe3a5d6(0x27e)]&&(_0x1296ff['log'][_0xe3a5d6(0x141)](_0xe3a5d6(0x207)),abortExitTimer(_0x1296ff)),!_0x1296ff[_0xe3a5d6(0x282)]&&_0x1296ff[_0xe3a5d6(0x1c3)]===SYSTEM_MODES[_0xe3a5d6(0x154)]&&await setPresence(_0x1296ff,!![])),_0x197a35;}catch(_0x308efa){return![];}}function startExitTimer(_0x80dd4c){const _0x35d325=a0_0x56cb60;abortExitTimer(_0x80dd4c),_0x80dd4c[_0x35d325(0x1f8)]=!![],_0x80dd4c[_0x35d325(0x273)]=setTimeout(()=>{_0x80dd4c['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x80dd4c['exitTimer']=setTimeout(()=>{const _0x41fd5d=_0x35d325;setPresence(_0x80dd4c,![]),_0x80dd4c[_0x41fd5d(0x27e)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x42b1da){const _0xee7081=a0_0x56cb60;if(_0x42b1da[_0xee7081(0x27e)])clearTimeout(_0x42b1da[_0xee7081(0x27e)]);if(_0x42b1da['exitGraceTimer'])clearTimeout(_0x42b1da[_0xee7081(0x273)]);_0x42b1da[_0xee7081(0x27e)]=null,_0x42b1da[_0xee7081(0x273)]=null,_0x42b1da[_0xee7081(0x1f8)]=![];}async function setPresence(_0x144f05,_0x29406b){const _0x3cf0ec=a0_0x56cb60;if(_0x144f05[_0x3cf0ec(0x282)]===_0x29406b)return;_0x144f05['isPresent']=_0x29406b,await _0x144f05[_0x3cf0ec(0x193)](_0x3cf0ec(0x14a),{'val':_0x29406b,'ack':!![]});}async function executeAutomationAction(_0x544620){const _0x1ecb02=a0_0x56cb60;try{const _0x48434a=await _0x544620[_0x1ecb02(0x1cc)](_0x1ecb02(0x23e)),_0x41e85c=await _0x544620[_0x1ecb02(0x1cc)]('analysis.automation.targetValue');if(_0x48434a&&_0x48434a[_0x1ecb02(0x25d)]&&_0x41e85c){const _0x412654=_0x48434a['val'];let _0x45c59e=_0x41e85c[_0x1ecb02(0x25d)];try{_0x45c59e=JSON[_0x1ecb02(0x27b)](_0x45c59e);}catch(_0x4c2e57){}_0x544620[_0x1ecb02(0x156)][_0x1ecb02(0x141)](_0x1ecb02(0x28a)+_0x412654+'\x20=\x20'+_0x45c59e),await _0x544620[_0x1ecb02(0x27c)](_0x412654,_0x45c59e);}else _0x544620[_0x1ecb02(0x156)]['warn'](_0x1ecb02(0x243));}catch(_0x580300){_0x544620[_0x1ecb02(0x156)][_0x1ecb02(0x15b)](_0x1ecb02(0x181)+_0x580300['message']);}}async function handleTelegramResponse(_0x561bf7,_0x16b898){const _0x6ee1f4=a0_0x56cb60;let _0x4a94f9=_0x16b898;_0x16b898[_0x6ee1f4(0x1a4)]('[')&&(_0x4a94f9=_0x16b898[_0x6ee1f4(0x28e)](_0x16b898[_0x6ee1f4(0x112)](']')+0x1));if(_0x4a94f9===_0x6ee1f4(0x192))await _0x561bf7[_0x6ee1f4(0x193)](_0x6ee1f4(0x1ef),{'val':![],'ack':!![]}),await _0x561bf7[_0x6ee1f4(0x193)](_0x6ee1f4(0x1c0),{'val':_0x6ee1f4(0x270),'ack':!![]}),_0x561bf7[_0x6ee1f4(0x1d5)]=![],sendNotification(_0x561bf7,'âœ…\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x4a94f9===_0x6ee1f4(0x279)&&sendNotification(_0x561bf7,_0x6ee1f4(0x117),![],!![]);}async function sendNotification(_0x12112e,_0x46496c,_0x35c461=![],_0x5b8fd8=![]){const _0x48dee3=a0_0x56cb60,_0x14cef6=_0x12112e[_0x48dee3(0x153)];if(_0x14cef6[_0x48dee3(0x1b9)]){let _0x4199a7={};(_0x46496c[_0x48dee3(0x15d)](_0x48dee3(0x19c))||_0x5b8fd8)&&(_0x4199a7={'reply_markup':{'inline_keyboard':[[{'text':_0x48dee3(0x1fc),'callback_data':_0x48dee3(0x192)}],[{'text':_0x48dee3(0x121),'callback_data':_0x48dee3(0x279)}]]}}),await _0x12112e[_0x48dee3(0x1a7)](_0x14cef6[_0x48dee3(0x256)],_0x48dee3(0x26d),{'text':_0x46496c,'user':_0x14cef6[_0x48dee3(0x158)],..._0x4199a7});}if(_0x14cef6[_0x48dee3(0x292)]){let _0x2b772b={'message':_0x46496c,'title':_0x5b8fd8?_0x48dee3(0x29b):_0x48dee3(0x250),'priority':_0x5b8fd8?0x2:0x1,'device':_0x14cef6[_0x48dee3(0x26a)]};_0x5b8fd8&&(_0x2b772b[_0x48dee3(0x234)]=0x1e,_0x2b772b[_0x48dee3(0x16d)]=0xe10,_0x2b772b[_0x48dee3(0x291)]=_0x48dee3(0x167)),await _0x12112e[_0x48dee3(0x1a7)](_0x14cef6['notifyPushoverInstance'],_0x48dee3(0x26d),_0x2b772b);}_0x14cef6['notifyEmailEnabled']&&await _0x12112e[_0x48dee3(0x1a7)](_0x14cef6['notifyEmailInstance'],_0x48dee3(0x26d),{'text':_0x46496c,'to':_0x14cef6['notifyEmailRecipient']});}function a0_0x17ba(_0x28cdde,_0xd7a351){const _0x3f8cc4=a0_0x5e18();return a0_0x17ba=function(_0x14d7a0,_0x430919){_0x14d7a0=_0x14d7a0-0x112;let _0x5e180f=_0x3f8cc4[_0x14d7a0];return _0x5e180f;},a0_0x17ba(_0x28cdde,_0xd7a351);}async function runAutopilot(_0xa9f96e){const _0x1f5daa=a0_0x56cb60,_0x25a229=_0xa9f96e[_0x1f5daa(0x153)]['inactivityThresholdHours'],_0x52222f=_0xa9f96e[_0x1f5daa(0x129)]['length']>0x0?_0xa9f96e[_0x1f5daa(0x129)][0x0][_0x1f5daa(0x1a9)]:Date['now'](),_0x12f2ae=(Date[_0x1f5daa(0x119)]()-_0x52222f)/(0x3e8*0x3c*0x3c);let _0x47fe42='';_0xa9f96e['config'][_0x1f5daa(0x1d0)]&&_0xa9f96e[_0x1f5daa(0x1c3)]===SYSTEM_MODES[_0x1f5daa(0x154)]&&_0xa9f96e[_0x1f5daa(0x282)]&&(_0x12f2ae>_0x25a229&&(_0x47fe42=_0x1f5daa(0x269)+_0x12f2ae[_0x1f5daa(0x1ea)](0x1)+'h.')),runGeminiAnalysis(_0xa9f96e,_0x47fe42);}async function runPythonHealthCheck(_0x215072){const _0x50902d=a0_0x56cb60;if(!_0x215072['dailyDigests']||_0x215072['dailyDigests'][_0x50902d(0x2a2)]<0x2)return;const _0x167bcf=_0x215072['dailyDigests'][_0x50902d(0x213)](_0x4416f9=>{const _0x2480f0=_0x50902d,_0x2d37d2=(_0x4416f9[_0x2480f0(0x123)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x2d37d2]||0x32;});sendToPython(_0x215072,_0x50902d(0x22e),{'values':_0x167bcf,'tag':_0x50902d(0x124)});}class CogniLiving extends utils[a0_0x56cb60(0x1f2)]{constructor(_0x2dbd28){const _0x457582=a0_0x56cb60;super({..._0x2dbd28,'name':_0x457582(0x223)}),this[_0x457582(0x129)]=[],this[_0x457582(0x191)]=[],this[_0x457582(0x1d3)]=[],this['dailyDigests']=[],this['sensorLastValues']={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x457582(0x282)]=!![],this[_0x457582(0x27e)]=null,this[_0x457582(0x273)]=null,this['isGracePeriodActive']=![],this['genAI']=null,this['geminiModel']=null,this[_0x457582(0x1c3)]=SYSTEM_MODES[_0x457582(0x154)],this[_0x457582(0x150)]=![],this['lastAlertState']=![],this[_0x457582(0x12d)]=_0x457582(0x1e6),this['analysisTimer']=null,this[_0x457582(0x288)]=null,this[_0x457582(0x22c)]=null,this[_0x457582(0x1ab)]=null,this['briefingJob']=null,this[_0x457582(0x1cf)]=null,this[_0x457582(0x175)]=![],this['on'](_0x457582(0x184),this['onReady'][_0x457582(0x131)](this)),this['on'](_0x457582(0x210),this['onStateChange'][_0x457582(0x131)](this)),this['on'](_0x457582(0x12c),this[_0x457582(0x1a0)][_0x457582(0x131)](this)),this['on'](_0x457582(0x235),this['onMessage'][_0x457582(0x131)](this));}async['onReady'](){const _0x4b519a=a0_0x56cb60;this[_0x4b519a(0x156)][_0x4b519a(0x141)](_0x4b519a(0x1ae)+this[_0x4b519a(0x12f)]+_0x4b519a(0x160)),await initZombies(this);try{this[_0x4b519a(0x150)]=await checkLicense(this,this[_0x4b519a(0x153)][_0x4b519a(0x251)]);}catch(_0x452b64){}if(!this[_0x4b519a(0x153)]['inactivityThresholdHours']||this[_0x4b519a(0x153)][_0x4b519a(0x127)]<0.1)this[_0x4b519a(0x153)][_0x4b519a(0x127)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x4b519a(0x153)][_0x4b519a(0x1eb)])try{this[_0x4b519a(0x200)]=new GoogleGenerativeAI(this[_0x4b519a(0x153)][_0x4b519a(0x1eb)]),this[_0x4b519a(0x218)]=this[_0x4b519a(0x200)][_0x4b519a(0x1dc)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x4b519a(0x1ba)}}),this['log'][_0x4b519a(0x141)](_0x4b519a(0x1e1));}catch(_0x4796d0){this['log'][_0x4b519a(0x15b)](_0x4b519a(0x180)+_0x4796d0['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x4b519a(0x220)](_0x4b519a(0x17a)),this[_0x4b519a(0x220)](LTM_DP_TRIGGER_DIGEST),this[_0x4b519a(0x220)](_0x4b519a(0x190)),this[_0x4b519a(0x220)]('analysis.triggerBriefing'),this[_0x4b519a(0x220)](_0x4b519a(0x225)),this[_0x4b519a(0x220)](_0x4b519a(0x249)),this[_0x4b519a(0x220)](_0x4b519a(0x144)),this[_0x4b519a(0x220)]('analysis.training.triggerHealth'),this[_0x4b519a(0x220)](_0x4b519a(0x20a)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x4b519a(0x214)])clearInterval(this['analysisTimer']);const _0x5dba56=this[_0x4b519a(0x153)]['analysisInterval']||0xf;_0x5dba56>0x0&&(this[_0x4b519a(0x214)]=setInterval(()=>{runAutopilot(this);},_0x5dba56*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x2748e0=_0x4b519a;if(this[_0x2748e0(0x1cf)])runPythonHealthCheck(this);},0x1388);}[a0_0x56cb60(0x1a0)](_0x4275d7){const _0x12d748=a0_0x56cb60;if(this['analysisTimer'])clearInterval(this[_0x12d748(0x214)]);if(this[_0x12d748(0x1ab)])clearInterval(this[_0x12d748(0x1ab)]);if(this[_0x12d748(0x288)])this[_0x12d748(0x288)][_0x12d748(0x17b)]();if(this['modeResetJob'])this['modeResetJob'][_0x12d748(0x17b)]();if(this[_0x12d748(0x15a)])this[_0x12d748(0x15a)][_0x12d748(0x17b)]();if(this[_0x12d748(0x27e)])clearTimeout(this[_0x12d748(0x27e)]);if(this[_0x12d748(0x273)])clearTimeout(this[_0x12d748(0x273)]);stopPythonService(this),_0x4275d7();}async[a0_0x56cb60(0x20c)](_0x24ace8,_0x245d02){const _0x345b69=a0_0x56cb60;if(!_0x245d02||this[_0x345b69(0x175)])return;if(_0x24ace8[_0x345b69(0x15d)](_0x345b69(0x239))&&_0x24ace8[_0x345b69(0x16e)](_0x345b69(0x173))&&_0x245d02[_0x345b69(0x25d)]){await handleTelegramResponse(this,_0x245d02[_0x345b69(0x25d)]);return;}if(_0x24ace8===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0x245d02[_0x345b69(0x25d)]&&Object[_0x345b69(0x276)](SYSTEM_MODES)[_0x345b69(0x15d)](_0x245d02[_0x345b69(0x25d)])){this[_0x345b69(0x1c3)]=_0x245d02['val'];if(_0x245d02[_0x345b69(0x25d)]===SYSTEM_MODES[_0x345b69(0x1b3)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x245d02[_0x345b69(0x196)])this['setState'](_0x24ace8,{'val':this[_0x345b69(0x1c3)],'ack':!![]});return;}if(!_0x245d02[_0x345b69(0x196)]){_0x24ace8[_0x345b69(0x15d)](_0x345b69(0x17a))&&_0x245d02['val']&&(this[_0x345b69(0x209)](_0x24ace8,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x24ace8['includes']('triggerDailyDigest')&&_0x245d02[_0x345b69(0x25d)]){this['setState'](_0x24ace8,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x24ace8[_0x345b69(0x15d)](_0x345b69(0x1dd))&&_0x245d02[_0x345b69(0x25d)]&&(this[_0x345b69(0x209)](_0x24ace8,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x24ace8['includes'](_0x345b69(0x287))&&_0x245d02[_0x345b69(0x25d)]&&(this[_0x345b69(0x209)](_0x24ace8,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x24ace8[_0x345b69(0x15d)](_0x345b69(0x144))&&_0x245d02[_0x345b69(0x25d)]){this[_0x345b69(0x209)](_0x24ace8,{'val':![],'ack':!![]});if(this[_0x345b69(0x150)])try{const _0x5ec107=await this[_0x345b69(0x1cc)](_0x345b69(0x16b));if(_0x5ec107&&_0x5ec107[_0x345b69(0x25d)]){const _0x1102ad=JSON['parse'](_0x5ec107['val']);this[_0x345b69(0x156)]['info'](_0x345b69(0x146)),this[_0x345b69(0x193)](_0x345b69(0x115),{'val':_0x345b69(0x1fd),'ack':!![]}),sendToPython(this,_0x345b69(0x185),{'sequences':_0x1102ad});}}catch(_0x1a5d45){this['log'][_0x345b69(0x15b)](_0x345b69(0x29f)+_0x1a5d45[_0x345b69(0x235)]);}}if(_0x24ace8['includes'](_0x345b69(0x1df))&&_0x245d02[_0x345b69(0x25d)]){this[_0x345b69(0x209)](_0x24ace8,{'val':![],'ack':!![]});if(this[_0x345b69(0x150)])try{const _0x3432d3=await this[_0x345b69(0x1cc)](LTM_DP_DAILY_DIGESTS);if(_0x3432d3&&_0x3432d3['val'])sendToPython(this,_0x345b69(0x2b1),{'digests':JSON['parse'](_0x3432d3[_0x345b69(0x25d)])});}catch(_0x53d633){}}if(_0x24ace8[_0x345b69(0x15d)](_0x345b69(0x20a))&&_0x245d02[_0x345b69(0x25d)]){this[_0x345b69(0x209)](_0x24ace8,{'val':![],'ack':!![]});if(this[_0x345b69(0x150)])try{const _0x16c0e6=await this[_0x345b69(0x1cc)](_0x345b69(0x1e5));if(_0x16c0e6&&_0x16c0e6['val'])sendToPython(this,_0x345b69(0x18b),{'points':JSON['parse'](_0x16c0e6[_0x345b69(0x25d)])});}catch(_0x4ea0cb){}}return;}if(this[_0x345b69(0x153)][_0x345b69(0x142)]&&this['config'][_0x345b69(0x142)][_0x345b69(0x15d)](_0x24ace8)){await checkWifiPresence(this);return;}const _0xa8a82c=(this[_0x345b69(0x153)][_0x345b69(0x290)]||[])[_0x345b69(0x278)](_0x12adbc=>_0x12adbc['id']===_0x24ace8);if(_0xa8a82c)processSensorEvent(this,_0x24ace8,_0x245d02,_0xa8a82c);}async[a0_0x56cb60(0x152)](_0x58f0a8){const _0x6eb184=a0_0x56cb60;if(typeof _0x58f0a8===_0x6eb184(0x177)&&_0x58f0a8[_0x6eb184(0x235)]){if(_0x58f0a8[_0x6eb184(0x2b3)]===_0x6eb184(0x245)){const _0x4fb691=_0x58f0a8['message'][_0x6eb184(0x261)]||this['config']['geminiApiKey'];if(!_0x4fb691)return this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8['command'],{'success':![],'message':_0x6eb184(0x11e)},_0x58f0a8[_0x6eb184(0x238)]);try{const _0x412ba1=new GoogleGenerativeAI(_0x4fb691),_0x1fabe9=_0x412ba1[_0x6eb184(0x1dc)]({'model':GEMINI_MODEL}),_0x551006=await _0x1fabe9[_0x6eb184(0x286)]('Hi');this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':!![],'message':_0x6eb184(0x159)+_0x551006[_0x6eb184(0x25a)][_0x6eb184(0x1b0)]()},_0x58f0a8['callback']);}catch(_0xb43f4e){this['sendTo'](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':![],'message':'Err:\x20'+_0xb43f4e['message']},_0x58f0a8[_0x6eb184(0x238)]);}}else{if(_0x58f0a8[_0x6eb184(0x2b3)]===_0x6eb184(0x217)){const _0x463136=await getWeatherContext(this),_0x137002=await getCalendarContext(this);this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':!![],'weather':_0x463136,'calendar':_0x137002},_0x58f0a8[_0x6eb184(0x238)]);}else{if(_0x58f0a8[_0x6eb184(0x2b3)]===_0x6eb184(0x272)){if(!this['isProVersion'])return this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8['command'],{'success':![],'isPro':![]},_0x58f0a8[_0x6eb184(0x238)]);let _0x41a346={'status':'N/A'};try{const _0x196cfd=await this[_0x6eb184(0x1cc)](LTM_DP_DRIFT_STATUS);_0x41a346[_0x6eb184(0x1b5)]=_0x196cfd?_0x196cfd[_0x6eb184(0x25d)]:'N/A';}catch(_0xce0916){}this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x6eb184(0x178)],'driftAnalysis':_0x41a346,'analysisHistory':this[_0x6eb184(0x191)]},_0x58f0a8[_0x6eb184(0x238)]);}else{if(_0x58f0a8[_0x6eb184(0x2b3)]==='getOverviewData'){const _0x1e5882=this[_0x6eb184(0x178)][_0x6eb184(0x2a2)],_0x47a725=new Date(),_0x442d10=new Date(_0x47a725['getFullYear'](),_0x47a725[_0x6eb184(0x262)](),_0x47a725[_0x6eb184(0x12e)]())[_0x6eb184(0x1b7)](),_0x37a24b=this['rawEventLog'][_0x6eb184(0x281)](_0x3af91f=>new Date(_0x3af91f[_0x6eb184(0x1a9)])[_0x6eb184(0x1b7)]()>_0x442d10)['length'],_0x4a2291=new Array(0x18)[_0x6eb184(0x1b1)](0x0);this[_0x6eb184(0x1d3)][_0x6eb184(0x23c)](_0x4ddb5c=>{const _0xd5bcd9=_0x6eb184,_0x28527c=new Date(_0x4ddb5c['timestamp']);if(_0x28527c['getTime']()>_0x442d10)_0x4a2291[_0x28527c[_0xd5bcd9(0x17e)]()]++;});let _0x24685a={'status':_0x6eb184(0x164)};try{const _0x2eccd9=await this[_0x6eb184(0x1cc)](LTM_DP_DRIFT_STATUS);_0x24685a[_0x6eb184(0x1b5)]=_0x2eccd9?_0x2eccd9['val']:_0x6eb184(0x164);}catch(_0x252e47){}let _0x1b2c07='';try{const _0x6cc8a5=await this[_0x6eb184(0x1cc)](_0x6eb184(0x29e));_0x1b2c07=_0x6cc8a5?_0x6cc8a5[_0x6eb184(0x25d)]:'';}catch(_0x531d6b){}let _0x2b806c=null;!this[_0x6eb184(0x218)]&&(_0x2b806c=this[_0x6eb184(0x153)]['geminiApiKey']?_0x6eb184(0x2a5):_0x6eb184(0x203));let _0x48003d={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x297d8e=await this['getStateAsync']('analysis.automation.patternDetected');if(_0x297d8e&&_0x297d8e[_0x6eb184(0x25d)]){_0x48003d[_0x6eb184(0x1f7)]=!![];const _0x1845e6=await this[_0x6eb184(0x1cc)](_0x6eb184(0x25b));_0x48003d[_0x6eb184(0x271)]=_0x1845e6?_0x1845e6[_0x6eb184(0x25d)]:'';const _0x5b5246=await this[_0x6eb184(0x1cc)](_0x6eb184(0x23e));_0x48003d[_0x6eb184(0x1c6)]=_0x5b5246?_0x5b5246[_0x6eb184(0x25d)]:'';const _0x49a9cb=await this['getStateAsync'](_0x6eb184(0x20f));_0x48003d[_0x6eb184(0x260)]=_0x49a9cb?_0x49a9cb[_0x6eb184(0x25d)]:'';}const _0x22a026=await this[_0x6eb184(0x1cc)](_0x6eb184(0x249));_0x48003d[_0x6eb184(0x16a)]=_0x22a026?!!_0x22a026[_0x6eb184(0x25d)]:![];}catch(_0x55313b){}this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8['command'],{'success':!![],'eventHistory':this[_0x6eb184(0x129)][_0x6eb184(0x13a)](0x0,0xf),'stats':{'digestCount':_0x1e5882,'eventCountToday':_0x37a24b,'hourlyActivity':_0x4a2291,'driftStatus':_0x24685a[_0x6eb184(0x1b5)],'isPresent':this[_0x6eb184(0x282)],'presenceWho':_0x1b2c07,'minDays':this['config']['minDaysForBaseline']||0x7,'stbDays':this[_0x6eb184(0x153)]['ltmStbWindowDays']||0xe,'ltbDays':this['config'][_0x6eb184(0x21e)]||0x3c,'systemError':_0x2b806c},'automation':_0x48003d},_0x58f0a8[_0x6eb184(0x238)]);}else{if(_0x58f0a8[_0x6eb184(0x2b3)]===_0x6eb184(0x1ed))try{const _0x434636=await scanForDevices(this,_0x58f0a8['message']||{});this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':!![],'devices':_0x434636},_0x58f0a8[_0x6eb184(0x238)]);}catch(_0x500f0f){this[_0x6eb184(0x21c)](_0x58f0a8['from'],_0x58f0a8[_0x6eb184(0x2b3)],{'success':![],'error':_0x500f0f[_0x6eb184(0x235)]},_0x58f0a8[_0x6eb184(0x238)]);}else{if(_0x58f0a8['command']===_0x6eb184(0x2b0)){const _0x59ab1f=await this[_0x6eb184(0x25f)](_0x6eb184(0x1b4),_0x6eb184(0x1c5)),_0x52393e=[];if(_0x59ab1f)for(const _0x1ab643 in _0x59ab1f){const _0x366375=_0x59ab1f[_0x1ab643],_0x322f86=(_0x366375[_0x6eb184(0x29a)]&&typeof _0x366375[_0x6eb184(0x29a)]['name']==='object'?_0x366375[_0x6eb184(0x29a)][_0x6eb184(0x189)]['de']:_0x366375['common'][_0x6eb184(0x189)])||_0x366375[_0x6eb184(0x29a)][_0x6eb184(0x189)];_0x52393e[_0x6eb184(0x1bb)]({'id':_0x1ab643,'name':_0x322f86});}this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':!![],'enums':_0x52393e},_0x58f0a8[_0x6eb184(0x238)]);}else{if(_0x58f0a8['command']===_0x6eb184(0x2a0)){const _0xa83cb0=_0x58f0a8[_0x6eb184(0x235)]['instance'];if(!_0xa83cb0)return this['sendTo'](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':![],'error':_0x6eb184(0x22f)},_0x58f0a8[_0x6eb184(0x238)]);const _0x358f2b=await getCalendarNames(this,_0xa83cb0);this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8['command'],{'success':!![],'names':_0x358f2b},_0x58f0a8[_0x6eb184(0x238)]);}else{if(_0x58f0a8[_0x6eb184(0x2b3)]===_0x6eb184(0x232)){const {targetId:_0x2cc7a9,targetValue:_0x329ed5}=_0x58f0a8[_0x6eb184(0x235)];this[_0x6eb184(0x156)][_0x6eb184(0x141)](_0x6eb184(0x253)+_0x2cc7a9+'\x20=\x20'+_0x329ed5),await this[_0x6eb184(0x193)](_0x6eb184(0x147),{'val':!![],'ack':!![]}),await this[_0x6eb184(0x193)](_0x6eb184(0x25b),{'val':_0x6eb184(0x174)+_0x2cc7a9,'ack':!![]}),await this[_0x6eb184(0x193)]('analysis.automation.targetId',{'val':_0x2cc7a9,'ack':!![]}),await this[_0x6eb184(0x193)]('analysis.automation.targetValue',{'val':_0x329ed5,'ack':!![]}),this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':!![]},_0x58f0a8['callback']);}else{if(_0x58f0a8[_0x6eb184(0x2b3)]==='submitFeedback'){const {historyId:_0x596860,rating:_0x3a1743,comment:_0x58a979,alertReason:_0x26397e}=_0x58f0a8['message'];_0x596860&&_0x3a1743?(await saveFeedback(this,{'timestamp':Date[_0x6eb184(0x119)](),'historyId':_0x596860,'rating':_0x3a1743,'comment':_0x58a979,'alertReason':_0x26397e}),this[_0x6eb184(0x21c)](_0x58f0a8['from'],_0x58f0a8[_0x6eb184(0x2b3)],{'success':!![]},_0x58f0a8[_0x6eb184(0x238)])):this['sendTo'](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':![],'error':_0x6eb184(0x21a)},_0x58f0a8[_0x6eb184(0x238)]);}else _0x58f0a8['command']===_0x6eb184(0x1a3)&&(this[_0x6eb184(0x156)][_0x6eb184(0x141)]('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x6eb184(0x147),{'val':![],'ack':!![]}),await this[_0x6eb184(0x193)](_0x6eb184(0x25b),{'val':'','ack':!![]}),this[_0x6eb184(0x21c)](_0x58f0a8[_0x6eb184(0x138)],_0x58f0a8[_0x6eb184(0x2b3)],{'success':!![]},_0x58f0a8[_0x6eb184(0x238)]));}}}}}}}}}}}if(require[a0_0x56cb60(0x244)]!==module)module['exports']=_0x22ddca=>new CogniLiving(_0x22ddca);else new CogniLiving();