const a0_0x3144e6=a0_0x2782;(function(_0x40517d,_0x93dbf5){const _0x3bb4f3=a0_0x2782,_0x16cc3e=_0x40517d();while(!![]){try{const _0x5757fc=-parseInt(_0x3bb4f3(0x1da))/0x1+-parseInt(_0x3bb4f3(0x19d))/0x2+parseInt(_0x3bb4f3(0x1ef))/0x3+-parseInt(_0x3bb4f3(0x141))/0x4+parseInt(_0x3bb4f3(0xfa))/0x5+parseInt(_0x3bb4f3(0x23d))/0x6+parseInt(_0x3bb4f3(0x16e))/0x7;if(_0x5757fc===_0x93dbf5)break;else _0x16cc3e['push'](_0x16cc3e['shift']());}catch(_0x38136a){_0x16cc3e['push'](_0x16cc3e['shift']());}}}(a0_0x4dbc,0xf010d));const a0_0x22eb72=(function(){let _0x439a5d=!![];return function(_0x490023,_0xe1ab93){const _0x536705=_0x439a5d?function(){const _0x6cd52=a0_0x2782;if(_0xe1ab93){const _0x3c0430=_0xe1ab93[_0x6cd52(0x170)](_0x490023,arguments);return _0xe1ab93=null,_0x3c0430;}}:function(){};return _0x439a5d=![],_0x536705;};}()),a0_0x289589=a0_0x22eb72(this,function(){const _0x12a9a6=a0_0x2782;return a0_0x289589[_0x12a9a6(0x18f)]()[_0x12a9a6(0x1fc)](_0x12a9a6(0x1ec))[_0x12a9a6(0x18f)]()[_0x12a9a6(0x20c)](a0_0x289589)['search'](_0x12a9a6(0x1ec));});function a0_0x4dbc(){const _0x238aeb=['setState','fill','from','3278016LgHmUw','sendMorningBriefing','filter','comfort','analysis.security.lastScore','terrasse','accuweather.0','setObjectNotExistsAsync','DAY','presenceCheckTimer','ðŸ”Š\x20Infraschall-Alarm:\x20','triggerEnergyPrediction',',\x20Temp:\x20','system.adapter.ical.','setPresence','object','VACATION','max','existsSync','analysis.energy.warmupTargets',':\x20Temp-Differenz\x20','LTM.baselineStatus','setHours','getEnums','info','onReady','checkThermostats','updateLocation','scanThermostats','find','integrateRoomTime','onMessage','Init...','stopService','modules','replayTodayEvents','abortExitTimer','triggerDailyDigest','TRAIN_COMFORT','push','.uptime','Adapter','historyJob','Event','response','4253536QoWooY','startSystem','apply','initSchedules','memoryCache','.json','createAllObjects','Lernphase\x20(','klar','scanDevices','analysis.automation.targetId','processSensorEvent','trackerHeartbeat','NIGHT','\x20Kalender-Adapter\x20gefunden.','analysis.ventilation.lastWindow','testContext','isRelevantActivity','presenceDevices','getHistoryData','then','moduleComfort','ðŸ“\x20Manual\x20event\x20logged:\x20','LTM.dailyDigests','TRAIN_HEALTH','Standard','TRAIN_TOPOLOGY','useCalendar','triggerInfrasoundCorrelation','LTM.trainingData.sequences','healthTrendInterval','infrasoundEnabled','moduleSecurity','toString','analysis.training.status','json','\x20sequences',',\x20Events:\x0a','.last_seen','abs','ANALYZE_GAIT','updateSchedulePreview','createDailyDigest','dependencyInstallInProgress','Warm-Up\x20Time','add','thermostat','584310vdvlib','analysis.prediction.trackerTopRoom','inactivityThresholdHours','message','\x20events\x20from\x20standard\x20storage.','./lib/dead_man','initSystemConfig','dailyDigests','analysis.health.geminiDay','readFileSync','manual','events.history','setDate','getHours','location','writeFileSync','checkCalendarTriggers','triggerGaitAnalysis\x20error:\x20','now','initHistory','clear','âš \x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','isPresent','log','sonn','threshold_exceeded','substring','activeModules','telegram','motion','values','unshift','error','node-schedule','exitTimer','minDaysForBaseline','rawEventLog','analysis.activity.roomStats','online','generateContent','Â°C\x20(Innen:\x20','sendNotification','slice','weatherunderground.0','analysis.energy.warmupSources','energy','date','ðŸ’¾\x20Saving\x20Daily\x20History\x20for\x20','triggerHealth\x20error:\x20','stringify','value','join','getForeignObjectsAsync','2-digit','checkWifiPresence','analysis.training.triggerHealth','onStateChange','ðŸ\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','Current.WeatherText','licenseKey','enum.rooms.*','534091eyseku','custom','stateChange','analysis.health.todayVector','floor','currentSystemMode','de-DE','namespace','eventHistory','testApiKey','SYSTEM_MODES','scanForDevices','Warte\x20auf\x20Analyse...','./lib/scanner','enum','\x20(Bewohner\x20anwesend\x20-\x20normal)','string','common','(((.+)+)+)+$','system.presenceWho','generateHealthReport','4349769WUIuAg','open','exitGraceTimer','subscribeStates','getStateAsync','geminiApiKey','toFixed','Party\x20Mode','./lib/ai_agent','health','parse','application/json','modeResetJob','search','system.adapter.','ack','subscribeForeignStates','analysis.automation.targetValue','LTM.triggerDailyDigest','./lib/scheduler','exports','all','weatherTempId','number','includes','Gemini\x20Init\x20Error:\x20','onUnload','analysis.health.todayRoomDetails','Â°C,\x20AuÃŸen:\x20','constructor','bin','loadSystemMode','{\x22history\x22:{}}','apiKey','analysis.visualization.pulse','pop','lastTrackerEventTime','moduleEnergy','â†º\x20Replaying\x20','getCalendarNames','analysis.prediction.trackerConfidence','Corrupt','rows','runPythonHealthCheck','main','analysisTimer','analysis.health.geminiNight','split','â˜€ï¸\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','driftAnalysisTimer','checkLicense','./lib/python_bridge','analysis.energy.warmupTimes','\x20(Threshold)','infrasoundArmingId','analysis.health.activityTrend','callback','saveDailyHistory','isProVersion','calendarCheckTimer','Keine\x20Daten','analysis.training.triggerComfort','General\x20Activity\x20Trend','ready','infrasoundLocked','checkSolarCondition','cogni-living\x20adapter\x20starting\x20(v','getForeignStateAsync','instance','sensorLastValues','bootTime','SET_LEARNING_MODE','ðŸš¶\x20Gait\x20Analysis\x20triggered\x20with\x20','infrasoundSensorId','toISOString','.isOnline','setStateAsync','guest','905874qVkMin','history','TRAIN_SECURITY','keys','lastAlertState','analysis.safety.infrasoundAlert','forecast.current.weather','NORMAL','getDate','NextHours.Location_1.Day_1.current.symbol_desc','forEach','analysis.trigger','@iobroker/adapter-core','ðŸ”Š\x20Infraschall:\x20','Sec-Training\x20started...','temperature','updateHealthVector','./lib/recorder','ðŸ”Š\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','analysis.training.triggerSecurity','triggerEnergyPrediction\x20Error:\x20','refreshCalendar','Guest\x20Mode','system.adapter.ical.é¦™','ðŸš¨\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','Unknown','@google/generative-ai','updateTopology','analysis.activity.roomHistory','Gute\x20LÃ¼ftungsmÃ¶glichkeit!','endsWith','command','todayVector','utf8','text','sendTo','Say\x20Hello','âœ…\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','triggerBriefing','models/gemini-flash-latest','Daily\x20Room\x20Details\x20(48x30min)','genAI','automation.triggerAction','History\x20Save\x20Error:\x20','sunny','analysis.automation.patternDetected','2102545wqYyIK','runGeminiAnalysis','path','CALCULATE_HEALTH_TREND','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','getMinutes','heiter','send','getObjectViewAsync','subscribeForeignStatesAsync','bind','geminiModel','config','replace','protectAiMemory','cancel','version','enum.functions.*','cogni-living','getGenerativeModel','length','Niemand','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','./lib/automation','party','min','./lib/topology','analysis.security.learningStatus','roomIntegratorTimer','name','cleanupGhostInterventions','.data.table','\x20>\x20','communicate.request','getAbsoluteDefaultDataDir','[Integrator]\x20Error:\x20','Â°C)','getTime','initZombies','Aktiv\x20(','\x20Tage)','toLocaleTimeString','analyzeWindowOpening','type','pressureBuffer','toLowerCase','door','Verbindung\x20erfolgreich:\x20','unload','...','timestamp','59\x2023\x20*\x20*\x20*','\x20-\x20','val','warn','debug','state','toLocaleDateString','isSolar','triggerGaitAnalysis','moduleHealth','isGracePeriodActive',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','devices','security','LTM.rawEventLog','isArray','map'];a0_0x4dbc=function(){return _0x238aeb;};return a0_0x4dbc();}a0_0x289589();'use strict';function a0_0x2782(_0x13b6ce,_0x5061e4){const _0x445feb=a0_0x4dbc();return a0_0x2782=function(_0x289589,_0x22eb72){_0x289589=_0x289589-0xe9;let _0x4dbc0f=_0x445feb[_0x289589];return _0x4dbc0f;},a0_0x2782(_0x13b6ce,_0x5061e4);}const utils=require(a0_0x3144e6(0x249)),{GoogleGenerativeAI}=require(a0_0x3144e6(0x257)),path=require(a0_0x3144e6(0xfc)),fs=require('fs'),installer=require('./lib/installer'),scanner=require(a0_0x3144e6(0x1e7)),schedulers=require(a0_0x3144e6(0x202)),topology=require(a0_0x3144e6(0x114)),setup=require('./lib/setup'),recorder=require(a0_0x3144e6(0x24e)),pythonBridge=require(a0_0x3144e6(0x222)),aiAgent=require(a0_0x3144e6(0x1f7)),deadMan=require(a0_0x3144e6(0x1a2)),automation=require(a0_0x3144e6(0x111)),GEMINI_MODEL=a0_0x3144e6(0xf3);class CogniLiving extends utils[a0_0x3144e6(0x16a)]{constructor(_0x1d36aa){const _0x144ce8=a0_0x3144e6;super({..._0x1d36aa,'name':_0x144ce8(0x10c)}),this[_0x144ce8(0x1e2)]=[],this['analysisHistory']=[],this[_0x144ce8(0x1c1)]=[],this[_0x144ce8(0x1a4)]=[],this[_0x144ce8(0x234)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x144ce8(0x1bf)]=null,this[_0x144ce8(0x1f1)]=null,this[_0x144ce8(0x137)]=![],this[_0x144ce8(0xf5)]=null,this[_0x144ce8(0x105)]=null,this['currentSystemMode']=setup['SYSTEM_MODES'][_0x144ce8(0x244)],this[_0x144ce8(0x229)]=![],this[_0x144ce8(0x241)]=![],this[_0x144ce8(0x21c)]=null,this[_0x144ce8(0x22a)]=null,this[_0x144ce8(0x14a)]=null,this['ltmJob']=null,this[_0x144ce8(0x1fb)]=null,this[_0x144ce8(0x220)]=null,this['briefingJob']=null,this['historyJob']=null,this[_0x144ce8(0x17a)]=null,this[_0x144ce8(0x18c)]=null,this[_0x144ce8(0x116)]=null,this['dependencyInstallInProgress']=![],this[_0x144ce8(0x213)]=Date['now'](),this[_0x144ce8(0x172)]=null,this[_0x144ce8(0x235)]=Date[_0x144ce8(0x1af)](),this['infrasoundLocked']=![],this[_0x144ce8(0x126)]=[],this[_0x144ce8(0x1b8)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x144ce8(0x22e),this[_0x144ce8(0x15a)]['bind'](this)),this['on'](_0x144ce8(0x1dc),this[_0x144ce8(0x1d5)][_0x144ce8(0x104)](this)),this['on'](_0x144ce8(0x12a),this[_0x144ce8(0x209)]['bind'](this)),this['on'](_0x144ce8(0x1a0),this[_0x144ce8(0x160)]['bind'](this));}async[a0_0x3144e6(0x15a)](){const _0x488d2f=a0_0x3144e6;this[_0x488d2f(0x1b4)]['info'](_0x488d2f(0x231)+this[_0x488d2f(0x10a)]+_0x488d2f(0x138));if(this['config'][_0x488d2f(0x136)]!==undefined)this[_0x488d2f(0x1b8)][_0x488d2f(0x1f8)]=this[_0x488d2f(0x106)][_0x488d2f(0x136)];if(this[_0x488d2f(0x106)]['moduleSecurity']!==undefined)this[_0x488d2f(0x1b8)]['security']=this['config'][_0x488d2f(0x18e)];if(this['config'][_0x488d2f(0x214)]!==undefined)this[_0x488d2f(0x1b8)][_0x488d2f(0x1ca)]=this[_0x488d2f(0x106)][_0x488d2f(0x214)];if(this[_0x488d2f(0x106)][_0x488d2f(0x183)]!==undefined)this[_0x488d2f(0x1b8)][_0x488d2f(0x144)]=this[_0x488d2f(0x106)][_0x488d2f(0x183)];if(this[_0x488d2f(0x106)]['modules'])this[_0x488d2f(0x1b8)]={...this[_0x488d2f(0x1b8)],...this[_0x488d2f(0x106)][_0x488d2f(0x163)]};this[_0x488d2f(0x16f)]();}async[a0_0x3144e6(0x16f)](){const _0x4aad32=a0_0x3144e6;await setup[_0x4aad32(0x120)](this);try{this[_0x4aad32(0x229)]=await setup[_0x4aad32(0x221)](this['config'][_0x4aad32(0x1d8)]);}catch(_0x23f5b9){}if(!this[_0x4aad32(0x106)][_0x4aad32(0x19f)]||this[_0x4aad32(0x106)][_0x4aad32(0x19f)]<0.1)this[_0x4aad32(0x106)][_0x4aad32(0x19f)]=0xc;await setup[_0x4aad32(0x1b0)](this),await setup[_0x4aad32(0x1a3)](this);try{const _0x3e69d1=await this['getStateAsync'](_0x4aad32(0x223)),_0x2ef6d7=await this[_0x4aad32(0x1f3)](_0x4aad32(0x1c9));_0x3e69d1&&_0x3e69d1[_0x4aad32(0x12f)]&&_0x2ef6d7&&_0x2ef6d7[_0x4aad32(0x12f)]&&(Date[_0x4aad32(0x1af)]()-_0x3e69d1['ts']<0x4*0xe10*0x3e8&&(this['memoryCache']={'times':JSON['parse'](_0x3e69d1[_0x4aad32(0x12f)]),'sources':JSON['parse'](_0x2ef6d7[_0x4aad32(0x12f)])}));}catch(_0x4fc8d){}if(this[_0x4aad32(0x106)][_0x4aad32(0x1f4)])try{this[_0x4aad32(0xf5)]=new GoogleGenerativeAI(this[_0x4aad32(0x106)][_0x4aad32(0x1f4)]),this['geminiModel']=this[_0x4aad32(0xf5)][_0x4aad32(0x10d)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x4aad32(0x1fa)}});}catch(_0x55d3da){this[_0x4aad32(0x1b4)][_0x4aad32(0x1bd)](_0x4aad32(0x208)+_0x55d3da[_0x4aad32(0x1a0)]);}await setup[_0x4aad32(0x174)](this),await this[_0x4aad32(0x20e)](),schedulers[_0x4aad32(0x171)](this),await this['setObjectNotExistsAsync'](_0x4aad32(0x211),{'type':_0x4aad32(0x132),'common':{'name':'Live\x20Event\x20Pulse','type':'number','role':_0x4aad32(0x1cf),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x4aad32(0x1c2),{'type':_0x4aad32(0x132),'common':{'name':'Room\x20Dwell\x20Time\x20Stats','type':_0x4aad32(0x1ea),'role':'json','read':!![],'write':![],'def':_0x4aad32(0x110)},'native':{}}),await this[_0x4aad32(0x148)](_0x4aad32(0x259),{'type':_0x4aad32(0x132),'common':{'name':'Room\x20History\x20(24h\x20Buckets)','type':'string','role':'json','read':!![],'write':![],'def':_0x4aad32(0x20f)},'native':{}}),await this[_0x4aad32(0x148)](_0x4aad32(0x21d),{'type':'state','common':{'name':'Gemini\x20Report\x20Night','type':_0x4aad32(0x1ea),'role':_0x4aad32(0xee),'read':!![],'write':![],'def':_0x4aad32(0x1e6)},'native':{}}),await this[_0x4aad32(0x148)](_0x4aad32(0x1a5),{'type':_0x4aad32(0x132),'common':{'name':'Gemini\x20Report\x20Day','type':_0x4aad32(0x1ea),'role':_0x4aad32(0xee),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x4aad32(0x148)]('analysis.health.todayVector',{'type':'state','common':{'name':'Daily\x20Activity\x20Vector\x20(48x30min)','type':_0x4aad32(0x1ea),'role':_0x4aad32(0x191),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x4aad32(0x148)](_0x4aad32(0x20a),{'type':_0x4aad32(0x132),'common':{'name':_0x4aad32(0xf4),'type':_0x4aad32(0x1ea),'role':_0x4aad32(0x191),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x4aad32(0x148)](_0x4aad32(0x226),{'type':_0x4aad32(0x132),'common':{'name':_0x4aad32(0x22d),'type':_0x4aad32(0x206),'role':'value','unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.energy.warmupTimes',{'type':_0x4aad32(0x132),'common':{'name':_0x4aad32(0x19a),'type':_0x4aad32(0x1ea),'role':_0x4aad32(0x191),'read':!![],'write':![]},'native':{}});try{const _0x506074=await this[_0x4aad32(0x1f3)](_0x4aad32(0x1a8));if(_0x506074&&_0x506074['val']){this[_0x4aad32(0x1e2)]=JSON['parse'](_0x506074[_0x4aad32(0x12f)]);if(this[_0x4aad32(0x229)]){const _0x27e0b3=await this['getStateAsync'](_0x4aad32(0x13b));if(_0x27e0b3&&_0x27e0b3[_0x4aad32(0x12f)])this[_0x4aad32(0x1c1)]=JSON[_0x4aad32(0x1f9)](_0x27e0b3[_0x4aad32(0x12f)]);}this[_0x4aad32(0x1b4)][_0x4aad32(0x159)]('ðŸ“¦\x20Restored\x20'+this[_0x4aad32(0x1e2)][_0x4aad32(0x10e)]+_0x4aad32(0x1a1));}}catch(_0x3d3585){this[_0x4aad32(0x1e2)]=[];}try{const _0x58cb2a=await this[_0x4aad32(0x1f3)]('LTM.dailyDigests');if(_0x58cb2a&&_0x58cb2a[_0x4aad32(0x12f)])this[_0x4aad32(0x1a4)]=JSON['parse'](_0x58cb2a[_0x4aad32(0x12f)]);}catch(_0x5316f2){this[_0x4aad32(0x1a4)]=[];}const _0x299611=this[_0x4aad32(0x1a4)][_0x4aad32(0x10e)]>=(this[_0x4aad32(0x106)][_0x4aad32(0x1c0)]||0x7)?_0x4aad32(0x121)+this[_0x4aad32(0x1a4)]['length']+_0x4aad32(0x122):_0x4aad32(0x175)+this[_0x4aad32(0x1a4)][_0x4aad32(0x10e)]+'/'+(this[_0x4aad32(0x106)]['minDaysForBaseline']||0x7)+')';await this[_0x4aad32(0x23b)](_0x4aad32(0x156),{'val':_0x299611,'ack':!![]}),this[_0x4aad32(0x1f2)](_0x4aad32(0x248)),this[_0x4aad32(0x1f2)](_0x4aad32(0x201)),this[_0x4aad32(0x1f2)](_0x4aad32(0x1d4));this[_0x4aad32(0x106)][_0x4aad32(0x18d)]&&this[_0x4aad32(0x106)]['infrasoundSensorId']&&this[_0x4aad32(0x1b8)]['security']&&this[_0x4aad32(0x1ff)](this[_0x4aad32(0x106)][_0x4aad32(0x238)]);const _0x41b858=this[_0x4aad32(0x106)][_0x4aad32(0x139)];if(_0x41b858)for(const _0x3757da of _0x41b858){await this[_0x4aad32(0x103)](_0x3757da['id']);}const _0x235f95=this[_0x4aad32(0x106)][_0x4aad32(0x180)];if(_0x235f95)for(const _0x41a014 of _0x235f95){await this[_0x4aad32(0x103)](_0x41a014);}const _0x937a12=require(_0x4aad32(0x1be));if(this['historyJob'])this[_0x4aad32(0x16b)][_0x4aad32(0x109)]();this[_0x4aad32(0x16b)]=_0x937a12['scheduleJob'](_0x4aad32(0x12d),()=>{const _0x43b06f=_0x4aad32;this[_0x43b06f(0x228)]();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this[_0x4aad32(0x116)])clearInterval(this[_0x4aad32(0x116)]);this['integrateRoomTime'](),this[_0x4aad32(0x116)]=setInterval(async()=>{const _0x35a1d0=_0x4aad32;await this[_0x35a1d0(0x15f)]();},0x3c*0x3e8);if(this[_0x4aad32(0x18c)])clearInterval(this[_0x4aad32(0x18c)]);this[_0x4aad32(0x18c)]=setInterval(()=>{const _0x58dcda=_0x4aad32;this[_0x58dcda(0x229)]&&this['activeModules'][_0x58dcda(0x1f8)]&&this['runPythonHealthCheck']();},0x4*0x3c*0x3c*0x3e8);if(this[_0x4aad32(0x21c)])clearInterval(this[_0x4aad32(0x21c)]);this[_0x4aad32(0x1b8)][_0x4aad32(0x1ca)]&&(this[_0x4aad32(0x21c)]=setInterval(()=>{const _0x531302=_0x4aad32;this[_0x531302(0x14c)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x4aad32(0x14c)](),0x2710));if(this[_0x4aad32(0x22a)])clearInterval(this[_0x4aad32(0x22a)]);this[_0x4aad32(0x106)][_0x4aad32(0x189)]&&this[_0x4aad32(0x1b8)][_0x4aad32(0x1ca)]&&(this['calendarCheckTimer']=setInterval(()=>{const _0x6be864=_0x4aad32;automation[_0x6be864(0x1ad)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x4aad32(0x1ad)](this),0x3a98));if(this[_0x4aad32(0x14a)])clearInterval(this['presenceCheckTimer']);this[_0x4aad32(0x106)][_0x4aad32(0x180)]&&this['config']['presenceDevices'][_0x4aad32(0x10e)]>0x0&&(this[_0x4aad32(0x14a)]=setInterval(async()=>{const _0x38dc1e=_0x4aad32;await this[_0x38dc1e(0x1d3)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0x4aad32(0x1d3)](),0x1388));const _0x54784f=path['join'](__dirname,'.venv',_0x4aad32(0x20d),'python');pythonBridge['startService'](this,_0x54784f);}[a0_0x3144e6(0x209)](_0x139350){const _0x42d8f3=a0_0x3144e6;if(this[_0x42d8f3(0x16b)])this[_0x42d8f3(0x16b)][_0x42d8f3(0x109)]();this['saveDailyHistory']()[_0x42d8f3(0x182)](()=>{const _0x8b2e0b=_0x42d8f3;if(this[_0x8b2e0b(0x21c)])clearInterval(this[_0x8b2e0b(0x21c)]);if(this['calendarCheckTimer'])clearInterval(this[_0x8b2e0b(0x22a)]);if(this['presenceCheckTimer'])clearInterval(this['presenceCheckTimer']);if(this[_0x8b2e0b(0x116)])clearInterval(this[_0x8b2e0b(0x116)]);recorder[_0x8b2e0b(0x165)](this),pythonBridge[_0x8b2e0b(0x162)](this),_0x139350();});}async[a0_0x3144e6(0x164)](){const _0x420f46=a0_0x3144e6;if(!this[_0x420f46(0x1e2)]||this['eventHistory'][_0x420f46(0x10e)]===0x0){this['log'][_0x420f46(0x130)](_0x420f46(0x1b2));return;}this['log'][_0x420f46(0x159)](_0x420f46(0x215)+this['eventHistory']['length']+'\x20events\x20from\x20today...');const _0x28806d=new Date()[_0x420f46(0x157)](0x0,0x0,0x0,0x0),_0x259388='analysis.activity.roomHistory';let _0x21d342={'history':{},'date':new Date()[_0x420f46(0x133)]()};const _0x257a60=_0x420f46(0x1dd),_0x40c035='analysis.health.todayRoomDetails';let _0x27f992=new Array(0x30)[_0x420f46(0x13f)](0x0),_0x18649e=Array[_0x420f46(0x140)]({'length':0x30},()=>[]);this[_0x420f46(0x1e2)][_0x420f46(0x247)](_0x5626ba=>{const _0x427a22=_0x420f46;if(_0x5626ba['timestamp']>=_0x28806d){if(recorder[_0x427a22(0x17f)](_0x5626ba['type'],_0x5626ba[_0x427a22(0x1cf)])){const _0x39a68b=new Date(_0x5626ba[_0x427a22(0x12c)]),_0x170b92=_0x39a68b[_0x427a22(0x1aa)]()*0x2+(_0x39a68b[_0x427a22(0xff)]()>=0x1e?0x1:0x0);if(_0x170b92<0x30){_0x27f992[_0x170b92]++;const _0x3f52a3=_0x5626ba[_0x427a22(0x1ab)]||_0x5626ba['name']||'?';let _0x4ad214=_0x18649e[_0x170b92];!_0x4ad214[_0x427a22(0x207)](_0x3f52a3)&&_0x4ad214[_0x427a22(0x168)](_0x3f52a3);}const _0x18700e=_0x39a68b['getHours']();let _0x29f37c=_0x5626ba[_0x427a22(0x1ab)]||_0x427a22(0x256);const _0x67dba6=(this[_0x427a22(0x106)][_0x427a22(0x139)]||[])[_0x427a22(0x15e)](_0x215acb=>_0x215acb['location']===_0x29f37c);if(_0x67dba6)_0x29f37c=_0x67dba6['location'];if(!_0x21d342[_0x427a22(0x23e)][_0x29f37c])_0x21d342[_0x427a22(0x23e)][_0x29f37c]=new Array(0x18)[_0x427a22(0x13f)](0x0);if(_0x21d342['history'][_0x29f37c][_0x18700e]<0x3c)_0x21d342[_0x427a22(0x23e)][_0x29f37c][_0x18700e]++;}}});const _0x364043=await this[_0x420f46(0x1f3)](_0x259388);(!_0x364043||!_0x364043[_0x420f46(0x12f)]||_0x364043[_0x420f46(0x12f)]==='{}'||_0x364043[_0x420f46(0x12f)][_0x420f46(0x207)]('\x22history\x22:{}'))&&await this['setStateAsync'](_0x259388,{'val':JSON[_0x420f46(0x1ce)](_0x21d342),'ack':!![]}),await this[_0x420f46(0x23b)](_0x257a60,{'val':JSON[_0x420f46(0x1ce)](_0x27f992),'ack':!![]}),await this[_0x420f46(0x23b)](_0x40c035,{'val':JSON[_0x420f46(0x1ce)](_0x18649e),'ack':!![]}),this['log'][_0x420f46(0x159)](_0x420f46(0xf1));}async['saveDailyHistory'](){const _0x13d57a=a0_0x3144e6;if(!this[_0x13d57a(0x1b8)][_0x13d57a(0x1f8)])return;const _0x1aba56=new Date()[_0x13d57a(0x239)]()[_0x13d57a(0x21e)]('T')[0x0];this[_0x13d57a(0x1b4)][_0x13d57a(0x131)](_0x13d57a(0x1cc)+_0x1aba56+_0x13d57a(0x12b));try{const [_0x8435e1,_0x1a8bf7,_0x5f079a,_0xd26449,_0x21b82a,_0x472d23]=await Promise[_0x13d57a(0x204)]([this['getStateAsync'](_0x13d57a(0x259)),this[_0x13d57a(0x1f3)](_0x13d57a(0x21d)),this[_0x13d57a(0x1f3)](_0x13d57a(0x1a5)),this['getStateAsync'](_0x13d57a(0x145)),this['getStateAsync']('analysis.health.todayVector'),this[_0x13d57a(0x1f3)]('analysis.health.activityTrend')]),_0x4a3b63=this[_0x13d57a(0x1e2)][_0x13d57a(0x143)](_0xa27e7c=>_0xa27e7c['timestamp']>=new Date()[_0x13d57a(0x157)](0x0,0x0,0x0,0x0)&&(_0xa27e7c[_0x13d57a(0x117)][_0x13d57a(0x127)]()[_0x13d57a(0x207)]('haustÃ¼r')||_0xa27e7c[_0x13d57a(0x117)][_0x13d57a(0x127)]()[_0x13d57a(0x207)](_0x13d57a(0x146)))&&(_0xa27e7c[_0x13d57a(0x1cf)]===!![]||_0xa27e7c['value']===_0x13d57a(0x1f0)))['length'];let _0x4e48bf=0x55;if(_0x472d23&&_0x472d23['val']!==undefined)_0x4e48bf=Math['min'](0x64,Math['max'](0x14,Math['round'](0x50+Number(_0x472d23[_0x13d57a(0x12f)])*0x5)));const _0x13d278={'date':_0x1aba56,'timestamp':Date[_0x13d57a(0x1af)](),'roomHistory':_0x8435e1?.['val']?JSON['parse'](_0x8435e1[_0x13d57a(0x12f)]):{},'geminiNight':_0x1a8bf7?.[_0x13d57a(0x12f)]||_0x13d57a(0x22b),'geminiDay':_0x5f079a?.[_0x13d57a(0x12f)]||_0x13d57a(0x22b),'anomalyScore':_0xd26449?.[_0x13d57a(0x12f)]||0.1,'todayVector':_0x21b82a?.[_0x13d57a(0x12f)]?JSON['parse'](_0x21b82a[_0x13d57a(0x12f)]):new Array(0x30)[_0x13d57a(0x13f)](0x0),'batteryLevel':_0x4e48bf,'freshAirCount':_0x4a3b63,'eventHistory':this[_0x13d57a(0x1e2)]},_0xcd225=utils['getAbsoluteDefaultDataDir'](),_0x2ed57f=path[_0x13d57a(0x1d0)](_0xcd225,_0x13d57a(0x10c),_0x13d57a(0x23e));if(!fs[_0x13d57a(0x153)](_0x2ed57f))fs['mkdirSync'](_0x2ed57f,{'recursive':!![]});const _0x371222=path[_0x13d57a(0x1d0)](_0x2ed57f,_0x1aba56+_0x13d57a(0x173));fs[_0x13d57a(0x1ac)](_0x371222,JSON[_0x13d57a(0x1ce)](_0x13d278)),this[_0x13d57a(0x1b4)]['info']('âœ…\x20History\x20saved:\x20'+_0x371222);}catch(_0x21ed8e){this['log'][_0x13d57a(0x1bd)](_0x13d57a(0xf7)+_0x21ed8e['message']);}}async[a0_0x3144e6(0x15f)](){const _0x27137e=a0_0x3144e6;if(!this[_0x27137e(0x1b3)])return;try{let _0x2b11ff=null;try{const _0x196b6d=await this[_0x27137e(0x1f3)](_0x27137e(0x19e)),_0x469bce=await this[_0x27137e(0x1f3)](_0x27137e(0x217));if(_0x196b6d&&_0x196b6d[_0x27137e(0x12f)]&&_0x469bce&&_0x469bce[_0x27137e(0x12f)]&&_0x469bce[_0x27137e(0x12f)]>0.3){if(_0x196b6d[_0x27137e(0x12f)]!==_0x27137e(0x256)&&_0x196b6d['val']!==_0x27137e(0x161))_0x2b11ff=_0x196b6d[_0x27137e(0x12f)];}}catch(_0x194beb){}if(!_0x2b11ff){const _0x530969=this[_0x27137e(0x106)]['devices']||[];for(const _0x534376 of _0x530969){if(_0x534376[_0x27137e(0x125)]===_0x27137e(0x1ba)&&_0x534376[_0x27137e(0x1ab)])try{const _0x3ab589=await this[_0x27137e(0x232)](_0x534376['id']);if(_0x3ab589&&(_0x3ab589[_0x27137e(0x12f)]===!![]||_0x3ab589[_0x27137e(0x12f)]==='on'||_0x3ab589['val']===0x1)){_0x2b11ff=_0x534376['location'];break;}}catch(_0x3de6e9){}}}if(!_0x2b11ff)return;const _0x11da33=this['config'][_0x27137e(0x139)]||[];let _0x300320=_0x2b11ff;const _0x58217e=_0x11da33['find'](_0x18a304=>_0x18a304[_0x27137e(0x1ab)]&&_0x18a304[_0x27137e(0x1ab)][_0x27137e(0x127)]()===_0x2b11ff[_0x27137e(0x127)]());if(_0x58217e)_0x300320=_0x58217e[_0x27137e(0x1ab)];const _0x520ac1=_0x27137e(0x259),_0x5977ea=await this[_0x27137e(0x1f3)](_0x520ac1),_0x194eb4=new Date()[_0x27137e(0x133)]();let _0x3a37ce={'history':{},'date':_0x194eb4};if(_0x5977ea&&_0x5977ea[_0x27137e(0x12f)])try{_0x3a37ce=JSON['parse'](_0x5977ea[_0x27137e(0x12f)]);}catch(_0x36d275){}_0x3a37ce[_0x27137e(0x1cb)]!==_0x194eb4&&(_0x3a37ce[_0x27137e(0x23e)]={},_0x3a37ce['date']=_0x194eb4);if(!_0x3a37ce[_0x27137e(0x23e)][_0x300320])_0x3a37ce['history'][_0x300320]=new Array(0x18)[_0x27137e(0x13f)](0x0);const _0x19f24e=new Date()[_0x27137e(0x1aa)]();if(_0x3a37ce['history'][_0x300320][_0x19f24e]<0x3c)_0x3a37ce[_0x27137e(0x23e)][_0x300320][_0x19f24e]++;await this[_0x27137e(0x23b)](_0x520ac1,{'val':JSON[_0x27137e(0x1ce)](_0x3a37ce),'ack':!![]});}catch(_0x588c62){this[_0x27137e(0x1b4)][_0x27137e(0x130)](_0x27137e(0x11d)+_0x588c62['message']);}}async[a0_0x3144e6(0x160)](_0x270fe6){const _0x4bc39c=a0_0x3144e6;if(typeof _0x270fe6===_0x4bc39c(0x150)&&_0x270fe6[_0x4bc39c(0x1a0)]){if(_0x270fe6['command']===_0x4bc39c(0x181)){const _0x12a72c=_0x270fe6[_0x4bc39c(0x1a0)][_0x4bc39c(0x1cb)],_0x98be51=utils[_0x4bc39c(0x11c)](),_0x343ea2=path[_0x4bc39c(0x1d0)](_0x98be51,_0x4bc39c(0x10c),'history',_0x12a72c+_0x4bc39c(0x173));if(fs[_0x4bc39c(0x153)](_0x343ea2))try{const _0x170904=JSON['parse'](fs[_0x4bc39c(0x1a6)](_0x343ea2,_0x4bc39c(0xed)));this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':!![],'data':_0x170904},_0x270fe6[_0x4bc39c(0x227)]);}catch(_0x29f0ba){this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':![],'error':_0x4bc39c(0x218)},_0x270fe6[_0x4bc39c(0x227)]);}else this['sendTo'](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':![],'error':'No\x20data'},_0x270fe6[_0x4bc39c(0x227)]);}else{if(_0x270fe6[_0x4bc39c(0xeb)]==='getOverviewData'){const _0x30e174=this[_0x4bc39c(0x1a4)]['length'];let _0x2b345f=new Array(0x30)[_0x4bc39c(0x13f)](0x0),_0x1cba4a=Array[_0x4bc39c(0x140)]({'length':0x30},()=>[]);try{const _0x37f206=await this[_0x4bc39c(0x1f3)](_0x4bc39c(0x1dd));if(_0x37f206&&_0x37f206['val'])_0x2b345f=JSON[_0x4bc39c(0x1f9)](_0x37f206[_0x4bc39c(0x12f)]);const _0x14f01a=await this['getStateAsync'](_0x4bc39c(0x20a));if(_0x14f01a&&_0x14f01a[_0x4bc39c(0x12f)])_0x1cba4a=JSON[_0x4bc39c(0x1f9)](_0x14f01a[_0x4bc39c(0x12f)]);}catch(_0x15b392){}let _0x4e9e51=new Array(0x30)['fill'](0x0);try{const _0x53c37d=new Date();_0x53c37d[_0x4bc39c(0x1a9)](_0x53c37d[_0x4bc39c(0x245)]()-0x1);const _0xd6f76c=_0x53c37d[_0x4bc39c(0x239)]()[_0x4bc39c(0x21e)]('T')[0x0],_0x1b6b57=utils['getAbsoluteDefaultDataDir'](),_0x6fe398=path[_0x4bc39c(0x1d0)](_0x1b6b57,_0x4bc39c(0x10c),_0x4bc39c(0x23e),_0xd6f76c+_0x4bc39c(0x173));if(fs[_0x4bc39c(0x153)](_0x6fe398)){const _0xfa5301=JSON[_0x4bc39c(0x1f9)](fs['readFileSync'](_0x6fe398,_0x4bc39c(0xed)));if(_0xfa5301&&_0xfa5301['todayVector'])_0x4e9e51=_0xfa5301[_0x4bc39c(0xec)];}}catch(_0x468340){}let _0x16c128={'today':{},'yesterday':{}};try{const _0x13e96f=await this[_0x4bc39c(0x1f3)]('analysis.activity.roomStats');if(_0x13e96f&&_0x13e96f['val'])_0x16c128=JSON[_0x4bc39c(0x1f9)](_0x13e96f[_0x4bc39c(0x12f)]);}catch(_0x19102b){}let _0x5bc468=null;try{const _0x246304=await this[_0x4bc39c(0x1f3)](_0x4bc39c(0x226));if(_0x246304)_0x5bc468=_0x246304[_0x4bc39c(0x12f)];}catch(_0x580241){}if(_0x5bc468===undefined||_0x5bc468===null){const _0x3fb2eb=_0x2b345f['reduce']((_0x1691d0,_0xe0350a)=>_0x1691d0+_0xe0350a,0x0),_0x286cbe=Math[_0x4bc39c(0x113)](0x2,Math[_0x4bc39c(0x152)](-0x2,(0x64-_0x3fb2eb)/0x32));_0x5bc468=_0x286cbe;}let _0x590bbd=![],_0x466d12='',_0x23e08a='',_0x590cb1='';try{const _0xfc6a6e=await this[_0x4bc39c(0x1f3)](_0x4bc39c(0xf9));if(_0xfc6a6e&&_0xfc6a6e[_0x4bc39c(0x12f)]){_0x590bbd=!![];const _0x149b9c=await this['getStateAsync']('analysis.automation.description');_0x466d12=_0x149b9c?_0x149b9c[_0x4bc39c(0x12f)]:'';const _0x21132b=await this[_0x4bc39c(0x1f3)](_0x4bc39c(0x178));_0x23e08a=_0x21132b?_0x21132b[_0x4bc39c(0x12f)]:'';const _0x400b02=await this[_0x4bc39c(0x1f3)](_0x4bc39c(0x200));_0x590cb1=_0x400b02?_0x400b02[_0x4bc39c(0x12f)]:'';}}catch(_0xb7629a){}const _0x3ea741=await this[_0x4bc39c(0x230)](),_0x1c389e=(this[_0x4bc39c(0x106)][_0x4bc39c(0x139)]||[])['some'](_0x3ccb9c=>_0x3ccb9c[_0x4bc39c(0x134)]),_0x32bbba=_0x3ea741&&_0x1c389e;let _0x3a880e='';try{const _0x4bf1e4=await this['getStateAsync']('system.presenceWho');if(_0x4bf1e4&&_0x4bf1e4[_0x4bc39c(0x12f)])_0x3a880e=_0x4bf1e4[_0x4bc39c(0x12f)];}catch(_0x2144ed){}this['sendTo'](_0x270fe6['from'],_0x270fe6['command'],{'success':!![],'eventHistory':this[_0x4bc39c(0x1e2)][_0x4bc39c(0x1c7)](0x0,0x7d0),'stats':{'digestCount':_0x30e174,'isPresent':this[_0x4bc39c(0x1b3)],'hourlyActivity':_0x2b345f,'hourlyDetails':_0x1cba4a,'yesterdayActivity':_0x4e9e51,'solarActive':_0x32bbba,'presenceWho':_0x3a880e,'roomStats':_0x16c128,'activityTrend':_0x5bc468,'modules':this[_0x4bc39c(0x1b8)]},'automation':{'detected':_0x590bbd,'description':_0x466d12,'targetId':_0x23e08a,'targetValue':_0x590cb1}},_0x270fe6['callback']);}else{if(_0x270fe6[_0x4bc39c(0xeb)]===_0x4bc39c(0x15b))try{const _0x31a66d=await automation[_0x4bc39c(0x15d)](this);this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':!![],'results':_0x31a66d},_0x270fe6[_0x4bc39c(0x227)]);}catch(_0x556dbe){this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':![],'error':_0x556dbe[_0x4bc39c(0x1a0)]},_0x270fe6[_0x4bc39c(0x227)]);}else{if(_0x270fe6['command']===_0x4bc39c(0x177))try{const _0x271264=await scanner[_0x4bc39c(0x1e5)](this,_0x270fe6[_0x4bc39c(0x1a0)]||{});this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':!![],'devices':_0x271264},_0x270fe6['callback']);}catch(_0x27d4cd){}else{if(_0x270fe6[_0x4bc39c(0xeb)]===_0x4bc39c(0x158)){const _0x1f0e81=await this[_0x4bc39c(0x1d1)](_0x4bc39c(0x10b),_0x4bc39c(0x1e8)),_0x501cd7=[];if(_0x1f0e81)for(const _0x4d1214 in _0x1f0e81){let _0x3d291b=_0x1f0e81[_0x4d1214][_0x4bc39c(0x1eb)][_0x4bc39c(0x117)];if(_0x3d291b&&typeof _0x3d291b===_0x4bc39c(0x150))_0x3d291b=_0x3d291b['de']||_0x3d291b['en']||Object['values'](_0x3d291b)[0x0]||JSON[_0x4bc39c(0x1ce)](_0x3d291b);_0x501cd7[_0x4bc39c(0x168)]({'id':_0x4d1214,'name':String(_0x3d291b||_0x4d1214)});}const _0x46660a=await this[_0x4bc39c(0x1d1)](_0x4bc39c(0x1d9),_0x4bc39c(0x1e8)),_0x16e465=[];if(_0x46660a)for(const _0x4345f9 in _0x46660a){let _0x12f1f1=_0x46660a[_0x4345f9][_0x4bc39c(0x1eb)][_0x4bc39c(0x117)];if(_0x12f1f1&&typeof _0x12f1f1===_0x4bc39c(0x150))_0x12f1f1=_0x12f1f1['de']||_0x12f1f1['en']||Object['values'](_0x12f1f1)[0x0]||JSON[_0x4bc39c(0x1ce)](_0x12f1f1);_0x16e465[_0x4bc39c(0x168)](String(_0x12f1f1||_0x4345f9[_0x4bc39c(0x21e)]('.')['pop']()));}this['sendTo'](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6['command'],{'success':!![],'enums':_0x501cd7,'rooms':_0x16e465},_0x270fe6[_0x4bc39c(0x227)]);}else{if(_0x270fe6[_0x4bc39c(0xeb)]===_0x4bc39c(0x216))try{const _0x2d80e9=await this[_0x4bc39c(0x102)]('system',_0x4bc39c(0x233),{'startkey':_0x4bc39c(0x14e),'endkey':_0x4bc39c(0x254)}),_0x4648a6=new Set();if(_0x2d80e9&&_0x2d80e9[_0x4bc39c(0x219)])for(const _0x1b2750 of _0x2d80e9[_0x4bc39c(0x219)]){const _0x5d2d07=_0x1b2750['id'][_0x4bc39c(0x107)](_0x4bc39c(0x1fd),''),_0x25245e=await this['getForeignStateAsync'](_0x5d2d07+_0x4bc39c(0x119));let _0xed66aa=![];if(_0x25245e&&_0x25245e[_0x4bc39c(0x12f)]){const _0x2f38b1=typeof _0x25245e[_0x4bc39c(0x12f)]==='string'?JSON[_0x4bc39c(0x1f9)](_0x25245e[_0x4bc39c(0x12f)]):_0x25245e[_0x4bc39c(0x12f)];Array[_0x4bc39c(0x13c)](_0x2f38b1)&&_0x2f38b1[_0x4bc39c(0x247)](_0x51097a=>{_0x51097a['calendarName']&&(_0x4648a6['add'](_0x51097a['calendarName']),_0xed66aa=!![]);});}!_0xed66aa&&_0x4648a6[_0x4bc39c(0x19b)](_0x5d2d07);}const _0x5ad14a=Array['from'](_0x4648a6);if(_0x5ad14a[_0x4bc39c(0x10e)]===0x0)_0x5ad14a[_0x4bc39c(0x168)](_0x4bc39c(0x187));this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':!![],'names':_0x5ad14a},_0x270fe6['callback']);}catch(_0x7cbc7b){this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6['command'],{'success':![],'error':'Scan\x20Error:\x20'+_0x7cbc7b[_0x4bc39c(0x1a0)]},_0x270fe6[_0x4bc39c(0x227)]);}else{if(_0x270fe6[_0x4bc39c(0xeb)]===_0x4bc39c(0x252))try{await automation[_0x4bc39c(0x197)](this),this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':!![]},_0x270fe6[_0x4bc39c(0x227)]);}catch(_0x55b093){this[_0x4bc39c(0x1b4)][_0x4bc39c(0x130)]('refreshCalendar\x20failed:\x20'+_0x55b093[_0x4bc39c(0x1a0)]),this[_0x4bc39c(0xef)](_0x270fe6['from'],_0x270fe6[_0x4bc39c(0xeb)],{'success':![],'error':_0x55b093[_0x4bc39c(0x1a0)]},_0x270fe6[_0x4bc39c(0x227)]);}else{if(_0x270fe6['command']===_0x4bc39c(0x1e3))try{const _0x3c29da=_0x270fe6['message']?_0x270fe6['message'][_0x4bc39c(0x210)]:'';if(!_0x3c29da)throw new Error('Kein\x20API\x20Key\x20Ã¼bergeben.');const _0x401752=new GoogleGenerativeAI(_0x3c29da),_0x3dfb3d=_0x401752[_0x4bc39c(0x10d)]({'model':GEMINI_MODEL}),_0x257f5f=await _0x3dfb3d[_0x4bc39c(0x1c4)](_0x4bc39c(0xf0)),_0xcb8db=await _0x257f5f[_0x4bc39c(0x16d)],_0x159b62=_0xcb8db['text']();this[_0x4bc39c(0xef)](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':!![],'message':_0x4bc39c(0x129)+_0x159b62[_0x4bc39c(0x1b7)](0x0,0x14)+'...'},_0x270fe6[_0x4bc39c(0x227)]);}catch(_0x5c6598){this[_0x4bc39c(0xef)](_0x270fe6['from'],_0x270fe6['command'],{'success':![],'message':_0x5c6598['message']},_0x270fe6[_0x4bc39c(0x227)]);}else{if(_0x270fe6[_0x4bc39c(0xeb)]===_0x4bc39c(0x17e))try{const _0x2993b2=await this[_0x4bc39c(0x230)](),_0x1b2be1=await this[_0x4bc39c(0x102)]('system',_0x4bc39c(0x233),{'startkey':_0x4bc39c(0x14e),'endkey':'system.adapter.ical.é¦™'}),_0x3592cd=_0x1b2be1&&_0x1b2be1[_0x4bc39c(0x219)]?_0x1b2be1[_0x4bc39c(0x219)][_0x4bc39c(0x10e)]:0x0;this['sendTo'](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':!![],'weather':'Sonne:\x20'+_0x2993b2+_0x4bc39c(0x14d)+(this[_0x4bc39c(0x234)][this[_0x4bc39c(0x106)]['outdoorSensorId']]||'?')+'Â°C','calendar':_0x3592cd+_0x4bc39c(0x17c)},_0x270fe6['callback']);}catch(_0x4d9494){this['sendTo'](_0x270fe6[_0x4bc39c(0x140)],_0x270fe6[_0x4bc39c(0xeb)],{'success':![]},_0x270fe6[_0x4bc39c(0x227)]);}}}}}}}}}}}[a0_0x3144e6(0x21a)](){const _0x5c0178=a0_0x3144e6;if(!this[_0x5c0178(0x1b8)][_0x5c0178(0x1f8)])return;this[_0x5c0178(0x1b4)][_0x5c0178(0x131)](_0x5c0178(0x1d6));try{const _0x22f6b4=this[_0x5c0178(0x1c1)]||[];pythonBridge[_0x5c0178(0x101)](this,_0x5c0178(0xfd),{'events':_0x22f6b4});}catch(_0x49cfc8){this[_0x5c0178(0x1b4)]['warn'](_0x5c0178(0xfe));}}async[a0_0x3144e6(0x1d5)](_0x4230d7,_0x2ee840){const _0x3866e2=a0_0x3144e6;if(!_0x2ee840||this[_0x3866e2(0x199)])return;if(_0x4230d7[_0x3866e2(0x207)](_0x3866e2(0x1b9))&&_0x4230d7[_0x3866e2(0xea)](_0x3866e2(0x11b))&&_0x2ee840['val'])return;if(this[_0x3866e2(0x106)]['infrasoundEnabled']&&_0x4230d7===this[_0x3866e2(0x106)]['infrasoundSensorId']&&this[_0x3866e2(0x1b8)][_0x3866e2(0x13a)]){this['handleInfrasound'](_0x2ee840[_0x3866e2(0x12f)]);return;}if(_0x2ee840[_0x3866e2(0x1fe)]&&_0x4230d7[_0x3866e2(0xea)]('pulse'))return;if(_0x4230d7===this[_0x3866e2(0x1e1)]+'.system.mode'){if(_0x2ee840['val']&&Object[_0x3866e2(0x1bb)](setup['SYSTEM_MODES'])[_0x3866e2(0x207)](_0x2ee840[_0x3866e2(0x12f)])){this[_0x3866e2(0x1df)]=_0x2ee840[_0x3866e2(0x12f)];if(_0x2ee840[_0x3866e2(0x12f)]===setup[_0x3866e2(0x1e4)][_0x3866e2(0x151)])await recorder[_0x3866e2(0x14f)](this,![]);else await recorder[_0x3866e2(0x14f)](this,!![]);if(this[_0x3866e2(0x229)]){let _0x71cf34=![],_0x433631=0x0,_0x274fcd=_0x3866e2(0x1a7);if(this[_0x3866e2(0x1df)]===_0x3866e2(0x112))_0x71cf34=!![],_0x433631=0x168,_0x274fcd=_0x3866e2(0x1f6);else this['currentSystemMode']===_0x3866e2(0x23c)&&(_0x71cf34=!![],_0x433631=0x5a0,_0x274fcd=_0x3866e2(0x253));pythonBridge['send'](this,_0x3866e2(0x236),{'active':_0x71cf34,'duration':_0x433631,'label':_0x274fcd}),await this[_0x3866e2(0x23b)](_0x3866e2(0x115),{'val':JSON[_0x3866e2(0x1ce)]({'active':_0x71cf34,'label':_0x274fcd,'timestamp':Date[_0x3866e2(0x1af)]()}),'ack':!![]});}}if(!_0x2ee840[_0x3866e2(0x1fe)])this[_0x3866e2(0x13e)](_0x4230d7,{'val':this[_0x3866e2(0x1df)],'ack':!![]});return;}if(_0x4230d7[_0x3866e2(0xea)](_0x3866e2(0x1c9))&&_0x2ee840[_0x3866e2(0x1fe)])this[_0x3866e2(0x108)](_0x2ee840['val']);if(_0x4230d7['endsWith'](_0x3866e2(0x223))&&_0x2ee840['ack']&&this[_0x3866e2(0x1b8)][_0x3866e2(0x1ca)])automation[_0x3866e2(0x1ad)](this);if(!_0x2ee840[_0x3866e2(0x1fe)]){if(_0x4230d7[_0x3866e2(0x207)](_0x3866e2(0x248))&&_0x2ee840[_0x3866e2(0x12f)]){this['setState'](_0x4230d7,{'val':![],'ack':!![]}),aiAgent[_0x3866e2(0xfb)](this);return;}if(_0x4230d7[_0x3866e2(0x207)](_0x3866e2(0x166))&&_0x2ee840['val']){this['setState'](_0x4230d7,{'val':![],'ack':!![]});if(this[_0x3866e2(0x229)])aiAgent[_0x3866e2(0x198)](this,pythonBridge);return;}if(_0x4230d7[_0x3866e2(0x207)](_0x3866e2(0xf2))&&_0x2ee840['val']){this[_0x3866e2(0x13e)](_0x4230d7,{'val':![],'ack':!![]}),aiAgent[_0x3866e2(0x142)](this);return;}if(_0x4230d7[_0x3866e2(0x207)](_0x3866e2(0xf6))&&_0x2ee840[_0x3866e2(0x12f)]){this['setState'](_0x4230d7,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x4230d7['includes'](_0x3866e2(0x250))&&_0x2ee840[_0x3866e2(0x12f)]){this[_0x3866e2(0x13e)](_0x4230d7,{'val':![],'ack':!![]});if(this[_0x3866e2(0x229)])try{const _0x334929=await this[_0x3866e2(0x1f3)](_0x3866e2(0x18b));if(_0x334929&&_0x334929['val']){const _0x100b24=JSON[_0x3866e2(0x1f9)](_0x334929[_0x3866e2(0x12f)]);this['setStateAsync'](_0x3866e2(0x190),{'val':_0x3866e2(0x24b),'ack':!![]}),pythonBridge['send'](this,_0x3866e2(0x23f),{'sequences':_0x100b24});}}catch(_0x343703){}return;}if(_0x4230d7['includes'](_0x3866e2(0x1d4))&&_0x2ee840[_0x3866e2(0x12f)]){this[_0x3866e2(0x13e)](_0x4230d7,{'val':![],'ack':!![]});try{aiAgent[_0x3866e2(0x1ee)](this,_0x3866e2(0x17b)),setTimeout(()=>aiAgent[_0x3866e2(0x1ee)](this,_0x3866e2(0x149)),0x2ee0);if(this[_0x3866e2(0x229)]){this['runPythonHealthCheck']();const _0xc41ac7=await this[_0x3866e2(0x1f3)](_0x3866e2(0x185));if(_0xc41ac7&&_0xc41ac7[_0x3866e2(0x12f)])pythonBridge[_0x3866e2(0x101)](this,_0x3866e2(0x186),{'digests':JSON[_0x3866e2(0x1f9)](_0xc41ac7[_0x3866e2(0x12f)])});}}catch(_0x398d29){this['log'][_0x3866e2(0x130)](_0x3866e2(0x1cd)+_0x398d29[_0x3866e2(0x1a0)]);}return;}if(_0x4230d7[_0x3866e2(0x207)]('analysis.training.triggerEnergy')&&_0x2ee840[_0x3866e2(0x12f)]){this[_0x3866e2(0x13e)](_0x4230d7,{'val':![],'ack':!![]}),await this['triggerEnergyPrediction']();return;}if(_0x4230d7[_0x3866e2(0x207)](_0x3866e2(0x22c))&&_0x2ee840[_0x3866e2(0x12f)]){this[_0x3866e2(0x13e)](_0x4230d7,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0xa5ebaa=await this[_0x3866e2(0x1f3)](_0x3866e2(0x13b));if(_0xa5ebaa&&_0xa5ebaa[_0x3866e2(0x12f)]){const _0x277de5={};if(this[_0x3866e2(0x106)][_0x3866e2(0x139)])this[_0x3866e2(0x106)]['devices'][_0x3866e2(0x247)](_0x2e250c=>{const _0x5489b1=_0x3866e2;if(_0x2e250c['id']&&_0x2e250c[_0x5489b1(0x125)])_0x277de5[_0x2e250c['id']]=_0x2e250c[_0x5489b1(0x125)];});pythonBridge[_0x3866e2(0x101)](this,_0x3866e2(0x167),{'events':JSON[_0x3866e2(0x1f9)](_0xa5ebaa[_0x3866e2(0x12f)]),'deviceMap':_0x277de5});}}catch(_0x35d498){}return;}if(_0x4230d7[_0x3866e2(0x207)]('analysis.training.triggerTopology')&&_0x2ee840['val']){this[_0x3866e2(0x13e)](_0x4230d7,{'val':![],'ack':!![]}),topology[_0x3866e2(0x258)](this);if(this[_0x3866e2(0x229)])try{const _0x239fe9=await this[_0x3866e2(0x1f3)](_0x3866e2(0x18b));if(_0x239fe9&&_0x239fe9[_0x3866e2(0x12f)])pythonBridge[_0x3866e2(0x101)](this,_0x3866e2(0x188),{'sequences':JSON[_0x3866e2(0x1f9)](_0x239fe9['val'])});}catch(_0x598f7){}return;}}const _0x67cab1=(this[_0x3866e2(0x106)][_0x3866e2(0x139)]||[])[_0x3866e2(0x15e)](_0xd72e65=>_0xd72e65['id']===_0x4230d7);if(_0x67cab1){const _0x398087=await recorder[_0x3866e2(0x179)](this,_0x4230d7,_0x2ee840,_0x67cab1);_0x398087&&this['setState'](_0x3866e2(0x211),{'val':Date['now'](),'ack':!![]});_0x398087&&_0x398087[_0x3866e2(0x125)]===_0x3866e2(0x1ba)&&_0x398087[_0x3866e2(0x1ab)]&&this[_0x3866e2(0x229)]&&deadMan[_0x3866e2(0x15c)](this,_0x398087[_0x3866e2(0x1ab)]);_0x2ee840['val']&&(_0x2ee840['val']===!![]||_0x2ee840[_0x3866e2(0x12f)]===0x1||String(_0x2ee840[_0x3866e2(0x12f)])['toLowerCase']()===_0x3866e2(0x1f0))&&(_0x67cab1[_0x3866e2(0x125)]&&(_0x67cab1[_0x3866e2(0x125)][_0x3866e2(0x207)]('window')||_0x67cab1[_0x3866e2(0x125)]['includes'](_0x3866e2(0x128)))&&this[_0x3866e2(0x124)](_0x67cab1));if(_0x67cab1[_0x3866e2(0x125)]===_0x3866e2(0x24c)||_0x67cab1[_0x3866e2(0x125)]===_0x3866e2(0x19c)){if(this[_0x3866e2(0x1b8)]['energy'])automation[_0x3866e2(0x118)](this);}}}async[a0_0x3144e6(0x108)](_0x1f26bd){const _0x52c168=a0_0x3144e6;if(!this[_0x52c168(0x172)]||Date[_0x52c168(0x1af)]()-this[_0x52c168(0x235)]>0x493e0)return;try{const _0x275e5f=JSON[_0x52c168(0x1f9)](_0x1f26bd),_0x24fef8=this[_0x52c168(0x172)]['sources'];let _0x30c619=![];for(const _0x512386 in _0x24fef8){if(_0x24fef8[_0x512386][_0x52c168(0x207)]('AI')&&_0x275e5f[_0x512386]&&!_0x275e5f[_0x512386][_0x52c168(0x207)]('AI')){_0x30c619=!![];break;}}_0x30c619&&(await this[_0x52c168(0x23b)](_0x52c168(0x223),{'val':JSON[_0x52c168(0x1ce)](this[_0x52c168(0x172)]['times']),'ack':!![]}),await this[_0x52c168(0x23b)](_0x52c168(0x1c9),{'val':JSON[_0x52c168(0x1ce)](this[_0x52c168(0x172)]['sources']),'ack':!![]}));}catch(_0x588218){}}async[a0_0x3144e6(0x20e)](){const _0x32e5be=a0_0x3144e6;try{const _0x4ff981=await this['getStateAsync'](setup['SYSTEM_DP_MODE']);if(_0x4ff981&&_0x4ff981[_0x32e5be(0x12f)])this['currentSystemMode']=_0x4ff981[_0x32e5be(0x12f)];}catch(_0x35dc9a){this[_0x32e5be(0x1df)]=setup[_0x32e5be(0x1e4)][_0x32e5be(0x244)];}}async[a0_0x3144e6(0x1d3)](){const _0x1a0be0=a0_0x3144e6,_0x257007=this['config']['presenceDevices']||[];if(_0x257007[_0x1a0be0(0x10e)]===0x0)return![];const _0x5b3dbe=[],_0x7070b8=Date[_0x1a0be0(0x1af)](),_0x3fa517=0x5*0x3c*0x3e8;for(const _0x5b3f7c of _0x257007){try{let _0x1b4f54=![];try{const _0x58703d=await this[_0x1a0be0(0x232)](_0x5b3f7c+_0x1a0be0(0x23a));if(_0x58703d&&_0x58703d[_0x1a0be0(0x12f)]===!![])_0x1b4f54=!![];}catch(_0x54e7c8){}if(!_0x1b4f54)try{const _0x3b3322=await this[_0x1a0be0(0x232)](_0x5b3f7c+_0x1a0be0(0x194));if(_0x3b3322&&_0x3b3322['ts']){const _0x125966=_0x7070b8-_0x3b3322['ts'];if(_0x125966<_0x3fa517)_0x1b4f54=!![];}}catch(_0x325e99){}if(!_0x1b4f54)try{const _0x113094=await this[_0x1a0be0(0x232)](_0x5b3f7c+_0x1a0be0(0x169));if(_0x113094&&typeof _0x113094[_0x1a0be0(0x12f)]===_0x1a0be0(0x206)&&_0x113094['val']>0x0)_0x1b4f54=!![];}catch(_0x184286){}if(!_0x1b4f54)try{const _0x3a55c1=await this[_0x1a0be0(0x232)](_0x5b3f7c);if(_0x3a55c1){const _0xb9f8fd=_0x7070b8-(_0x3a55c1['ts']||0x0);_0xb9f8fd<_0x3fa517&&(_0x3a55c1['val']===!![]||_0x3a55c1[_0x1a0be0(0x12f)]===_0x1a0be0(0x1c3)||_0x3a55c1[_0x1a0be0(0x12f)]===0x1)&&(_0x1b4f54=!![]);}}catch(_0x555753){}if(_0x1b4f54){const _0x57c1bb=_0x5b3f7c[_0x1a0be0(0x21e)]('.'),_0x3c263a=_0x57c1bb[_0x57c1bb['length']-0x1]||_0x5b3f7c;_0x5b3dbe[_0x1a0be0(0x168)](_0x3c263a);}}catch(_0x49d42b){this['log'][_0x1a0be0(0x130)]('checkWifiPresence:\x20Error\x20checking\x20'+_0x5b3f7c+':\x20'+_0x49d42b[_0x1a0be0(0x1a0)]);}}const _0x3abc2e=_0x5b3dbe[_0x1a0be0(0x10e)]>0x0?_0x5b3dbe[_0x1a0be0(0x1d0)](',\x20'):_0x1a0be0(0x10f);return await this[_0x1a0be0(0x23b)](_0x1a0be0(0x1ed),{'val':_0x3abc2e,'ack':!![]}),_0x5b3dbe['length']>0x0;}async['runAutopilot'](){const _0x1aac80=a0_0x3144e6;await aiAgent['runGeminiAnalysis'](this);this['activeModules']['health']&&(this[_0x1aac80(0x24d)](),this[_0x1aac80(0x135)]());if(this[_0x1aac80(0x1b8)][_0x1aac80(0x1ca)])this[_0x1aac80(0x14c)]();}async[a0_0x3144e6(0x230)](){const _0x564ee9=a0_0x3144e6,_0x39501e=[_0x564ee9(0x1c8),_0x564ee9(0x147),'daswetter.0'],_0x17f0c4=[_0x564ee9(0x243),_0x564ee9(0x1d7),_0x564ee9(0x246)];for(const _0x251239 of _0x39501e){for(const _0x634b8a of _0x17f0c4){try{const _0x61bdb1=_0x251239+'.'+_0x634b8a,_0x58b935=await this['getForeignStateAsync'](_0x61bdb1);if(_0x58b935&&_0x58b935[_0x564ee9(0x12f)]){const _0x5ec9bc=String(_0x58b935[_0x564ee9(0x12f)])[_0x564ee9(0x127)]();if(_0x5ec9bc[_0x564ee9(0x207)](_0x564ee9(0xf8))||_0x5ec9bc[_0x564ee9(0x207)](_0x564ee9(0x100))||_0x5ec9bc[_0x564ee9(0x207)](_0x564ee9(0x176))||_0x5ec9bc[_0x564ee9(0x207)](_0x564ee9(0x1b5))||_0x5ec9bc['includes'](_0x564ee9(0x1b1)))return this[_0x564ee9(0x1b4)]['debug'](_0x564ee9(0x21f)+_0x61bdb1),!![];}}catch(_0x1d650b){}}}return![];}[a0_0x3144e6(0x135)](){const _0x4836f1=a0_0x3144e6;if(!this['isProVersion'])return;try{this[_0x4836f1(0x1f3)](_0x4836f1(0x18b),(_0x2cc23a,_0x4f6e86)=>{const _0x5a6aaa=_0x4836f1;if(_0x2cc23a||!_0x4f6e86||!_0x4f6e86[_0x5a6aaa(0x12f)])return;try{const _0x1b1922=JSON['parse'](_0x4f6e86[_0x5a6aaa(0x12f)]);if(!_0x1b1922||_0x1b1922['length']===0x0)return;pythonBridge[_0x5a6aaa(0x101)](this,_0x5a6aaa(0x196),{'sequences':_0x1b1922}),this[_0x5a6aaa(0x1b4)][_0x5a6aaa(0x131)](_0x5a6aaa(0x237)+_0x1b1922[_0x5a6aaa(0x10e)]+_0x5a6aaa(0x192));}catch(_0x533b7a){this[_0x5a6aaa(0x1b4)][_0x5a6aaa(0x130)]('triggerGaitAnalysis\x20parse\x20error:\x20'+_0x533b7a[_0x5a6aaa(0x1a0)]);}});}catch(_0x47de18){this[_0x4836f1(0x1b4)][_0x4836f1(0x130)](_0x4836f1(0x1ae)+_0x47de18[_0x4836f1(0x1a0)]);}}async[a0_0x3144e6(0x14c)](){const _0x1a89a8=a0_0x3144e6;if(!this[_0x1a89a8(0x229)]||!this['activeModules'][_0x1a89a8(0x1ca)])return;try{const _0x2f57b9={},_0x19db02={},_0x5e3a8e=this[_0x1a89a8(0x106)]['devices']||[];for(const _0x3d73dd of _0x5e3a8e){if((_0x3d73dd[_0x1a89a8(0x125)]==='temperature'||_0x3d73dd['type']===_0x1a89a8(0x19c))&&_0x3d73dd[_0x1a89a8(0x1ab)])try{const _0x53cc0d=await this[_0x1a89a8(0x232)](_0x3d73dd['id']);_0x53cc0d&&typeof _0x53cc0d[_0x1a89a8(0x12f)]===_0x1a89a8(0x206)&&(_0x2f57b9[_0x3d73dd[_0x1a89a8(0x1ab)]]=_0x53cc0d[_0x1a89a8(0x12f)],_0x19db02[_0x3d73dd[_0x1a89a8(0x1ab)]]=_0x3d73dd[_0x1a89a8(0x134)]||![]);}catch(_0x3152f9){}}let _0x48bb6c=0xa;if(this[_0x1a89a8(0x106)][_0x1a89a8(0x205)])try{const _0x43bccc=await this['getForeignStateAsync'](this[_0x1a89a8(0x106)]['weatherTempId']);if(_0x43bccc&&typeof _0x43bccc[_0x1a89a8(0x12f)]===_0x1a89a8(0x206))_0x48bb6c=_0x43bccc[_0x1a89a8(0x12f)];}catch(_0xe59147){}const _0x48f384=await this[_0x1a89a8(0x230)]();let _0x254243={};try{const _0x1bda58=await this[_0x1a89a8(0x1f3)](_0x1a89a8(0x154));if(_0x1bda58&&_0x1bda58['val'])_0x254243=JSON[_0x1a89a8(0x1f9)](_0x1bda58['val']);}catch(_0x5bda82){}pythonBridge[_0x1a89a8(0x101)](this,'PREDICT_ENERGY',{'current_temps':_0x2f57b9,'t_out':_0x48bb6c,'is_sunny':_0x48f384,'solar_flags':_0x19db02,'warmup_targets':_0x254243}),this[_0x1a89a8(0x1b4)]['info']('ðŸ”®\x20Energy\x20Prediction\x20triggered\x20('+Object[_0x1a89a8(0x240)](_0x2f57b9)[_0x1a89a8(0x10e)]+'\x20rooms)');}catch(_0x535b9e){this[_0x1a89a8(0x1b4)][_0x1a89a8(0x130)](_0x1a89a8(0x251)+_0x535b9e[_0x1a89a8(0x1a0)]);}}[a0_0x3144e6(0x24d)](){const _0x3365ae=a0_0x3144e6;if(!this[_0x3365ae(0x1c1)]||this[_0x3365ae(0x1c1)]['length']===0x0)return;const _0x72e046=new Array(0x30)[_0x3365ae(0x13f)](0x0),_0x563a80=Array[_0x3365ae(0x140)]({'length':0x30},()=>[]),_0x40d7fc=new Date()[_0x3365ae(0x157)](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x3365ae(0x247)](_0x1c626e=>{const _0x543004=_0x3365ae,_0x29e602=new Date(_0x1c626e[_0x543004(0x12c)]);if(_0x29e602[_0x543004(0x11f)]()>=_0x40d7fc){const _0x311fcb=_0x29e602['getHours'](),_0x5dfca5=_0x29e602[_0x543004(0xff)](),_0x133d4a=_0x311fcb*0x2+Math[_0x543004(0x1de)](_0x5dfca5/0x1e);_0x133d4a>=0x0&&_0x133d4a<0x30&&(_0x72e046[_0x133d4a]++,_0x563a80[_0x133d4a][_0x543004(0x168)]({'time':_0x29e602[_0x543004(0x123)](_0x543004(0x1e0),{'hour':_0x543004(0x1d2),'minute':_0x543004(0x1d2)}),'location':_0x1c626e[_0x543004(0x1ab)]||'Unbekannt','type':_0x1c626e[_0x543004(0x125)]||_0x543004(0x16c)}));}}),this[_0x3365ae(0x23b)](_0x3365ae(0x1dd),{'val':JSON[_0x3365ae(0x1ce)](_0x72e046),'ack':!![]}),this[_0x3365ae(0x23b)](_0x3365ae(0x20a),{'val':JSON['stringify'](_0x563a80),'ack':!![]});}async['handleInfrasound'](_0x51265a){const _0x5d1fa1=a0_0x3144e6;if(!this[_0x5d1fa1(0x106)]['infrasoundEnabled']||typeof _0x51265a!==_0x5d1fa1(0x206))return;const _0x58a242=this[_0x5d1fa1(0x106)]['infrasoundThreshold']||0.04;this[_0x5d1fa1(0x126)]['push']({'timestamp':Date[_0x5d1fa1(0x1af)](),'value':_0x51265a}),this[_0x5d1fa1(0x126)][_0x5d1fa1(0x10e)]>0x64&&this[_0x5d1fa1(0x126)]['shift'](),_0x51265a>_0x58a242&&!this['infrasoundLocked']&&(this[_0x5d1fa1(0x22f)]=!![],this[_0x5d1fa1(0x1b4)][_0x5d1fa1(0x130)](_0x5d1fa1(0x14b)+_0x51265a['toFixed'](0x4)+_0x5d1fa1(0x11a)+_0x58a242+_0x5d1fa1(0x224)),await this[_0x5d1fa1(0x18a)](_0x51265a,_0x5d1fa1(0x1b6)),setTimeout(()=>{const _0x35c0db=_0x5d1fa1;this[_0x35c0db(0x22f)]=![];},0x5*0x3c*0x3e8));}async[a0_0x3144e6(0x18a)](_0x2b7778,_0x3ccc84){const _0x5c5491=a0_0x3144e6;if(!this[_0x5c5491(0x1b3)]){const _0x22db8c=this['eventHistory']['slice'](0x0,0xa),_0x4101b2=_0x22db8c[_0x5c5491(0x13d)](_0x56118d=>new Date(_0x56118d['timestamp'])[_0x5c5491(0x123)]('de-DE')+_0x5c5491(0x12e)+(_0x56118d[_0x5c5491(0x1ab)]||_0x5c5491(0x256))+':\x20'+_0x56118d[_0x5c5491(0x117)])['join']('\x0a');this[_0x5c5491(0x1b4)][_0x5c5491(0x130)](_0x5c5491(0x24f)+_0x2b7778[_0x5c5491(0x1f5)](0x4)+_0x5c5491(0x193)+_0x4101b2);if(this['config'][_0x5c5491(0x225)])try{const _0x209598=await this[_0x5c5491(0x232)](this[_0x5c5491(0x106)][_0x5c5491(0x225)]);_0x209598&&_0x209598[_0x5c5491(0x12f)]===!![]&&(await this[_0x5c5491(0x23b)](_0x5c5491(0x242),{'val':JSON[_0x5c5491(0x1ce)]({'timestamp':Date['now'](),'pressure':_0x2b7778[_0x5c5491(0x1f5)](0x4),'eventType':_0x3ccc84,'recentEvents':_0x22db8c[_0x5c5491(0x1c7)](0x0,0x3)}),'ack':!![]}),this[_0x5c5491(0x1b4)][_0x5c5491(0x1bd)](_0x5c5491(0x255)));}catch(_0x41efd0){}}else this['log']['debug'](_0x5c5491(0x24a)+_0x2b7778[_0x5c5491(0x1f5)](0x4)+_0x5c5491(0x1e9));}async[a0_0x3144e6(0x124)](_0x3bf103){const _0x1a215d=a0_0x3144e6;if(!_0x3bf103||!_0x3bf103[_0x1a215d(0x1ab)])return;try{const _0x3fd386=(this[_0x1a215d(0x106)][_0x1a215d(0x139)]||[])[_0x1a215d(0x143)](_0x39f1ca=>_0x39f1ca['location']===_0x3bf103[_0x1a215d(0x1ab)]&&(_0x39f1ca[_0x1a215d(0x125)]===_0x1a215d(0x24c)||_0x39f1ca[_0x1a215d(0x125)]===_0x1a215d(0x19c)));if(_0x3fd386[_0x1a215d(0x10e)]===0x0)return;const _0x103aaf=await this[_0x1a215d(0x232)](_0x3fd386[0x0]['id']);if(!_0x103aaf||typeof _0x103aaf['val']!==_0x1a215d(0x206))return;const _0x97abb0=_0x103aaf[_0x1a215d(0x12f)];let _0x473c5b=null;if(this[_0x1a215d(0x106)][_0x1a215d(0x205)]){const _0x42bd3d=await this['getForeignStateAsync'](this[_0x1a215d(0x106)][_0x1a215d(0x205)]);_0x42bd3d&&typeof _0x42bd3d[_0x1a215d(0x12f)]===_0x1a215d(0x206)&&(_0x473c5b=_0x42bd3d[_0x1a215d(0x12f)]);}if(_0x473c5b!==null){const _0x5159df=Math[_0x1a215d(0x195)](_0x97abb0-_0x473c5b);_0x5159df>0x3&&(this[_0x1a215d(0x1b4)][_0x1a215d(0x131)]('ðŸ’¨\x20LÃ¼ftung\x20in\x20'+_0x3bf103[_0x1a215d(0x1ab)]+_0x1a215d(0x155)+_0x5159df[_0x1a215d(0x1f5)](0x1)+_0x1a215d(0x1c5)+_0x97abb0+_0x1a215d(0x20b)+_0x473c5b+_0x1a215d(0x11e)),await this[_0x1a215d(0x23b)](_0x1a215d(0x17d),{'val':JSON[_0x1a215d(0x1ce)]({'room':_0x3bf103[_0x1a215d(0x1ab)],'timestamp':Date[_0x1a215d(0x1af)](),'tempDiff':_0x5159df[_0x1a215d(0x1f5)](0x1),'recommendation':_0x5159df>0x5?_0x1a215d(0xe9):'LÃ¼ften\x20empfohlen'}),'ack':!![]}));}}catch(_0x302c95){this[_0x1a215d(0x1b4)][_0x1a215d(0x130)]('analyzeWindowOpening\x20error:\x20'+_0x302c95['message']);}}async['appendToLog'](_0x3d45e8){const _0x557cd8=a0_0x3144e6;if(!_0x3d45e8||typeof _0x3d45e8!==_0x557cd8(0x150))return;const _0x319ed2={'timestamp':_0x3d45e8[_0x557cd8(0x12c)]||Date[_0x557cd8(0x1af)](),'id':_0x3d45e8['id']||Date[_0x557cd8(0x1af)]()['toString'](),'name':_0x3d45e8[_0x557cd8(0x117)]||'Manual\x20Event','type':_0x3d45e8[_0x557cd8(0x125)]||_0x557cd8(0x1db),'location':_0x3d45e8[_0x557cd8(0x1ab)]||'Unknown','value':_0x3d45e8[_0x557cd8(0x1cf)]||null};this[_0x557cd8(0x1e2)][_0x557cd8(0x1bc)](_0x319ed2);if(this[_0x557cd8(0x1e2)][_0x557cd8(0x10e)]>0x1388)this[_0x557cd8(0x1e2)][_0x557cd8(0x212)]();await this[_0x557cd8(0x23b)](_0x557cd8(0x1a8),{'val':JSON[_0x557cd8(0x1ce)](this['eventHistory']),'ack':!![]}),this[_0x557cd8(0x1b4)][_0x557cd8(0x131)](_0x557cd8(0x184)+_0x319ed2['name']+'\x20('+_0x319ed2[_0x557cd8(0x1ab)]+')');}[a0_0x3144e6(0x1c6)](_0x2ad7c9){}}if(require[a0_0x3144e6(0x21b)]!==module)module[a0_0x3144e6(0x203)]=_0xb53a75=>new CogniLiving(_0xb53a75);else new CogniLiving();