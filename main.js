const a0_0x54083a=a0_0x5b44;(function(_0x2c41f2,_0x7501e4){const _0x4f5864=a0_0x5b44,_0x480ed3=_0x2c41f2();while(!![]){try{const _0x1f6882=-parseInt(_0x4f5864(0x2a7))/0x1*(parseInt(_0x4f5864(0x354))/0x2)+parseInt(_0x4f5864(0x24f))/0x3+-parseInt(_0x4f5864(0x19e))/0x4*(-parseInt(_0x4f5864(0x1f1))/0x5)+-parseInt(_0x4f5864(0x17f))/0x6*(parseInt(_0x4f5864(0x212))/0x7)+-parseInt(_0x4f5864(0x254))/0x8+-parseInt(_0x4f5864(0x2c1))/0x9*(parseInt(_0x4f5864(0x218))/0xa)+parseInt(_0x4f5864(0x308))/0xb;if(_0x1f6882===_0x7501e4)break;else _0x480ed3['push'](_0x480ed3['shift']());}catch(_0x52f3e0){_0x480ed3['push'](_0x480ed3['shift']());}}}(a0_0x249c,0xa5ba7));const a0_0x42ac4a=(function(){let _0x15f69d=!![];return function(_0x42f394,_0x5973dd){const _0x5a04e6=_0x15f69d?function(){const _0x160c6f=a0_0x5b44;if(_0x5973dd){const _0x111b45=_0x5973dd[_0x160c6f(0x1ce)](_0x42f394,arguments);return _0x5973dd=null,_0x111b45;}}:function(){};return _0x15f69d=![],_0x5a04e6;};}()),a0_0x2e7040=a0_0x42ac4a(this,function(){const _0x4145d1=a0_0x5b44;return a0_0x2e7040[_0x4145d1(0x184)]()['search'](_0x4145d1(0x360))[_0x4145d1(0x184)]()[_0x4145d1(0x235)](a0_0x2e7040)[_0x4145d1(0x278)](_0x4145d1(0x360));});function a0_0x249c(){const _0xa58ff5=['Drift\x20Details','toFixed','startsWith','events.history_debug_00','boolean','getForeignStateAsync','Activity-Level','testApiKey','Reset\x20Sched\x20Error:\x20','door','TREND_RESULT','Trigger\x20Briefing\x20(Test)','analysis.health.trendValue','isGracePeriodActive','10046795ONbIlM','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','@iobroker/adapter-core','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','ready','Alarm','forEach','getLtmData','KI-Modell\x20nicht\x20initialisiert','setpoint','energy','string','indicator','Keiner','Training\x20Data\x20Sets','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','testNotification','üìû\x20R√ºckruf\x20anfordern','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','online','lastIndexOf','scheduleJob','extendObjectAsync','accuweather','Automation\x20Proposals','geminiModel','lampe','Event\x20History','\x20presence\x20devices...','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','python3\x20-m\x20pip\x20install\x20-r\x20\x22','Health\x20&\x20Sleep\x20Analysis','onMessage','N/A','LTM','[LOG]','substring','indicator.alarm','Last\x20raw\x20event','LTM.driftAnalysis.baselineDrift','Vom\x20Benutzer\x20best√§tigt\x20(OK).','LTM.driftAnalysis.lastCheck','Keine\x20Details.','Deviation','Trigger\x20Digest','toISOString','channel','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','state','LTM.trainingData.sequences','Trend\x20Diagnosis\x20(Python)',').\x20Starting\x20Timer.','[TEST]\x20','Analysiere\x20ausgewogen.','automationProposal','Trigger\x20Analysis','calendarInstance','\x20events','text.alarm','analysis.deviationFromBaseline','flot.','isPresent','getObjectAsync','notifyEmailEnabled','unload','getTime','analysis.health.restlessness','replace','node-schedule','Restlessness\x20Level','AI\x20Alert\x20Status','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','reachable','simulateButler','kill','health','2BdSJuR','currentSystemMode','analysis.comfortSummary','fenster','feedbackHistory','Error\x20checking\x20WiFi:\x20','retry','weatherInstance','Feedback\x20saved:\x20','notifyTelegramRecipient','Briefing\x20Error:\x20','PRO-','(((.+)+)+)+$','.\x0a\x20\x20\x20\x20WETTER:\x20','uuid','analysis.comfortSuggestion','üêç\x20Stopping\x20Python\x20Sidecar...','now','pop','lights','42BBplcW','humidity','GUEST','summary','window','toString','.NextHours.Location_1.Day_1.current.symbol_desc','isEmergency','cogni-living','getCalendarNames','info','javascript.','analysis.triggerBriefing','enum','[RECORDER]\x20Error\x20saving\x20sequence:\x20','detected','analysis.automation','siren','Adapter','dailyDigests','valve','expire','vacation','analysis.activitySummary','system.config','üì°\x20Hooking\x20into\x20','Comfort\x20Summary','COGNI_REQUEST_CALL','N/A\x20(Learning)','Processing\x20Status','driftDetails','2305052YIzTAb','setForeignStateAsync','setObjectNotExistsAsync','normal','delObjectAsync','Recorded\x20Motion\x20Sequences','isProVersion','üåÖ\x20Daily\x20Briefing:\x0a','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','alertReason','split','WETTER:\x20Keine\x20Daten\x20gefunden','getForeignObjectAsync','analysisHistory','üêç\x20Guardian\x20Diagnosis\x20(','ANALYZE_TREND','stateChange','requirements.txt','üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','sendTo','communicate.request','Missing\x20data','lowbat','Started\x20at\x20','ack','...','accuweather.0','system.presenceWho','Auto\x20Apply\x20Rule','switch','analysis.automation.targetValue','setState','ltmJob','system.meta.uuid','NORMAL','sendToAsync','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','exitTimer','trim','Action','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','Activity\x20Summary','licht','No\x20module\x20named','Briefing\x20Sched\x20Error:\x20','service.py','slice','devices','apply','find','material.','weatherunderground.0','dependencyInstallInProgress','Urlaub','getStateAsync','No\x20instance','bewegung','ltmLtbWindowDays','üêç\x20Starting\x20Python\x20Sidecar:\x20','stderr','position','child_process','models/gemini-flash-latest','Aktiv\x20(','loc','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','getFullYear','üö®\x20EMERGENCY','debug','analysis.automation.triggerAction','members','error','system.','val','ltmStbWindowDays','cancel','.data.table','.Summary.Current','parse','Subscribing\x20to\x20','analysis.lastResult','dutycycle','eventHistory','10EyhiKR','text','onUnload','analysis.health','splice','fault','callback','presence','getHours','common','analysis.automation.autoApply','shutter','Deaktiviert\x20(Pro-Feature)','Starting\x20Autopilot\x20(','getGenerativeModel','setStateAsync','TEST-PRO-KEY','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','\x20events)...','toLowerCase','notifyTelegramInstance','analysis.health.trendDiagnosis','time','button','modeResetJob','[PYTHON\x20ERR]\x20','getEnums','openweathermap.0','LTM.driftAnalysis.driftDetails','command','config_pending','Drift\x20Analysis','stdout','727279EIboJC','level','unknown','getForeignObjectsAsync','update','filter','6990JpoonX','Kein\x20API\x20Key!','Success:\x20Compressed\x20','daswetter','PARTY','events.lastEvent','unshift','exitGraceTimer','native','subscribeForeignStatesAsync','info.','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','cover','python_service','object','map','Target\x20Value','logDuplicates','onReady','notifyEmailRecipient','calendarSelection','driftAnalysisTimer','motion','Generating\x20Morning\x20Briefing...','sort','User\x20dismissed\x20automation\x20proposal.','scriptEnabled','.\x20DATEN:\x20Schlaf\x20','.\x20Welcome\x20home.','constructor','Health\x20Notes','value.health','python3','values','targetValue','direction','analysis.feedbackHistory','triggerBriefing','PONG','System\x20Status\x20&\x20Control','LTM.baselineStatus','genAI','vis.','analysis.automation.targetId','uuid-not-found','Feedback\x20Log','WETTER\x20ERROR:\x20','Fokus\x20auf\x20Komfort.','occupancy','0\x204\x20*\x20*\x20*','location','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','Morning\x20Briefing\x20sent.','_score','type','2712564XOveZM','notifyPushoverEnabled','getDate','pythonProcess','briefingTime','8822704GGbzNA','power','Gemini\x20AI\x20initialized.','icons-mfd.','minDaysForBaseline','notifyPushoverInstance','custom','üß™\x20Simulating\x20Butler\x20Proposal:\x20','notifyEmailInstance','Who\x20is\x20present?','analysis.automation.patternDetected','log','status','city','t√ºr','LTM\x20Sched\x20Error:\x20','namespace','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','config','round','version',').\x20Saving\x20to\x20Training\x20Data.','join','lastCheck','targetposition','‚úÖ\x20Alles\x20OK\x20(Reset)','details','send','enum.functions.*','lastAlertState','warn','KALENDER:\x20Keine\x20Daten','system','0\x203\x20*\x20*\x20*','write','search','isArray','system.isPresent','some','activityLevel','targetId','analysis.isAlert','Wetter:\x20Deaktiviert','from','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','systemUUID','Trigger\x20Action\x20Now','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','isAlert','baselineDrift','role','thermostat','\x20(Length:\x20','generic','maintenance','KALENDER:\x20','briefingJob','\x20=\x20','scriptProblem','analysis.trigger','triggerDailyDigest','systemConfig','analysisTimer','KALENDER:\x20Keine\x20relevanten\x20Termine','brightness','Bibliotheken\x20nicht\x20gefunden','.\x20OUTPUT:\x20Nur\x20Text.','aiPersona','number','analysis.automation.suggestedAction','Description','Daily\x20Digests','subscribeStates','setHours','briefingEnabled','payload','blind','Lernphase\x20(','timestamp','getOverviewData','KALENDER\x20ERROR:\x20','inactivityThresholdHours','71776wTswwr','value','selectedFunctionIds','automation.triggerAction','data','\x22\x20--break-system-packages','‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20','admin.','temp','stringify','dimmer','Drift\x20Status','COGNI_CONFIRM_OK','klima','lock','close','heizung','analysis.analysisHistory','sensorLastValues','length','date','sensor','geminiApiKey','Alert\x20Reason','bind','notifyPushoverRecipient','5013YtpOQJ','events.history','echarts.','analysis.alertReason','message','analysis.isEmergency','isExit','livingContext','.\x0a\x20\x20\x20\x20KONTEXT:\x20','event','working','Fokus\x20auf\x20Familienroutinen.','onStateChange','response','generateContent','actual_temperature','\x0aSTB:\x20','push','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','off','analysis.automation.description','AI\x20Emergency\x20Status','PRIORIT√ÑT:\x20Sicherheit.','Baseline\x20Status','Unknown','description','endsWith','light','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','presenceDevices','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','rawEventLog','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','temperature','doors','getMonth','licenseKey','LTM.trainingData','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','Entry\x20detected\x20via\x20','analysis.health.notes','history.','Skipped\x20(No\x20AI\x20or\x20Data)','name','dismissAutomation','LTM.dailyDigests','Cogni-Living','instance','json','):\x20','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','includes','BUTLER\x20Execution\x20Error:\x20','connection','notifyTelegramEnabled','Failed\x20to\x20send\x20to\x20Python:\x20','Last\x20Result'];a0_0x249c=function(){return _0xa58ff5;};return a0_0x249c();}a0_0x2e7040();'use strict';const utils=require(a0_0x54083a(0x30a)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x54083a(0x34c)),{spawn,exec}=require(a0_0x54083a(0x1db)),path=require('path'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x54083a(0x1dc),LTM_SCHEDULE=a0_0x54083a(0x276),MODE_RESET_SCHEDULE=a0_0x54083a(0x249),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x54083a(0x2ee),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x54083a(0x240),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x54083a(0x32f),LTM_DP_DRIFT_DETAILS=a0_0x54083a(0x20d),LTM_DP_DRIFT_LAST_CHECK=a0_0x54083a(0x331),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x54083a(0x28f),a0_0x54083a(0x232),a0_0x54083a(0x216),'unreach',a0_0x54083a(0x1b4),'rssi',a0_0x54083a(0x2f6),a0_0x54083a(0x28b),a0_0x54083a(0x1e5),a0_0x54083a(0x1f6),a0_0x54083a(0x2cb),a0_0x54083a(0x23b),'stick_unreach',a0_0x54083a(0x20f),a0_0x54083a(0x1ef),'firmware',a0_0x54083a(0x350),'link_quality'],BAD_NAMES=[a0_0x54083a(0x26d),'currentposition',a0_0x54083a(0x338),a0_0x54083a(0x213),a0_0x54083a(0x2a8),a0_0x54083a(0x295),'on',a0_0x54083a(0x2d4),a0_0x54083a(0x1bb),a0_0x54083a(0x1da),a0_0x54083a(0x1fc),a0_0x54083a(0x2a1),a0_0x54083a(0x224),a0_0x54083a(0x260),a0_0x54083a(0x22e),a0_0x54083a(0x1f8),a0_0x54083a(0x248),'temperature','humidity',a0_0x54083a(0x255),a0_0x54083a(0x312),a0_0x54083a(0x311),a0_0x54083a(0x193),a0_0x54083a(0x2d0),'set_temperature'],ADAPTER_BLACKLIST=[a0_0x54083a(0x1e6),a0_0x54083a(0x2ae),a0_0x54083a(0x222),a0_0x54083a(0x242),a0_0x54083a(0x2ea),a0_0x54083a(0x1d0),a0_0x54083a(0x257),a0_0x54083a(0x344),a0_0x54083a(0x2c3),a0_0x54083a(0x18a),'simple-api.'],SYSTEM_MODES={'NORMAL':a0_0x54083a(0x1a1),'VACATION':a0_0x54083a(0x195),'PARTY':'party','GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x54083a(0x181)]],PERSONA_MAPPING={'generic':a0_0x54083a(0x33d),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit/AAL.','family':a0_0x54083a(0x2cc),'single_comfort':a0_0x54083a(0x247),'security':a0_0x54083a(0x2d7)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x513e63){const _0x582799=a0_0x54083a;try{const _0x5a09f9=['analysis.history_debug_00',_0x582799(0x2fd)];for(const _0x71176f of _0x5a09f9){try{const _0x26391a=await _0x513e63[_0x582799(0x346)](_0x71176f);_0x26391a&&await _0x513e63[_0x582799(0x1a2)](_0x71176f);}catch(_0x13ad22){}}}catch(_0x37f520){}}async function initHistory(_0x133790){const _0x4f2b1e=a0_0x54083a;try{const _0x56b354=await _0x133790['getStateAsync'](_0x4f2b1e(0x2c2));_0x56b354&&_0x56b354[_0x4f2b1e(0x1e7)]&&(_0x133790[_0x4f2b1e(0x1f0)]=JSON[_0x4f2b1e(0x1ec)](_0x56b354['val'][_0x4f2b1e(0x184)]()));}catch(_0x18e1d3){_0x133790['eventHistory']=[];}try{const _0x29376e=await _0x133790[_0x4f2b1e(0x1d4)](_0x4f2b1e(0x2b8));if(_0x29376e&&_0x29376e['val'])_0x133790[_0x4f2b1e(0x1ab)]=JSON['parse'](_0x29376e[_0x4f2b1e(0x1e7)]['toString']());}catch(_0x3cfcd8){_0x133790[_0x4f2b1e(0x1ab)]=[];}if(_0x133790[_0x4f2b1e(0x1f0)]&&_0x133790[_0x4f2b1e(0x1f0)][_0x4f2b1e(0x2ba)]>0x0){_0x133790[_0x4f2b1e(0x25f)]['info']('Restoring\x20sensor\x20cache\x20from\x20history\x20('+_0x133790[_0x4f2b1e(0x1f0)][_0x4f2b1e(0x2ba)]+_0x4f2b1e(0x203));for(let _0x139396=_0x133790[_0x4f2b1e(0x1f0)][_0x4f2b1e(0x2ba)]-0x1;_0x139396>=0x0;_0x139396--){const _0x59ac3a=_0x133790[_0x4f2b1e(0x1f0)][_0x139396];_0x59ac3a&&_0x59ac3a['id']!==undefined&&_0x59ac3a[_0x4f2b1e(0x2a8)]!==undefined&&(_0x133790[_0x4f2b1e(0x2b9)][_0x59ac3a['id']]=_0x59ac3a[_0x4f2b1e(0x2a8)]);}}}async function initSystemConfig(_0x31b829){const _0x25144b=a0_0x54083a;try{const _0x277ca6=await _0x31b829['getForeignObjectAsync'](_0x25144b(0x197));_0x277ca6&&_0x277ca6[_0x25144b(0x1fa)]&&(_0x31b829[_0x25144b(0x292)]={'latitude':_0x277ca6[_0x25144b(0x1fa)]['latitude']||0x0,'longitude':_0x277ca6['common']['longitude']||0x0,'city':_0x277ca6[_0x25144b(0x1fa)][_0x25144b(0x261)]||''});}catch(_0x1cf5ba){}}async function checkLicense(_0x461f09,_0x1ee577){const _0x225d9e=a0_0x54083a;if(!_0x1ee577)return![];_0x461f09[_0x225d9e(0x282)]=await getSystemUUID(_0x461f09);if(_0x1ee577===_0x225d9e(0x201)||_0x1ee577[_0x225d9e(0x2fc)](_0x225d9e(0x35f)))return!![];return![];}async function getSystemUUID(_0x24adc9){const _0x29032a=a0_0x54083a;try{const _0x19008e=await _0x24adc9[_0x29032a(0x1aa)](_0x29032a(0x1bf));if(_0x19008e&&_0x19008e[_0x29032a(0x220)]&&_0x19008e[_0x29032a(0x220)][_0x29032a(0x362)])return _0x19008e[_0x29032a(0x220)][_0x29032a(0x362)];return _0x29032a(0x244);}catch(_0x3701df){return'uuid-error';}}async function createAllObjects(_0x34d14f){const _0xca7fd6=a0_0x54083a;await checkSystemObjects(_0x34d14f),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x1b9),{'type':'state','common':{'name':_0xca7fd6(0x25d),'type':_0xca7fd6(0x313),'role':_0xca7fd6(0x1f2),'read':!![],'write':![],'def':''},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x21d),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x32e),'type':'string','role':_0xca7fd6(0x2f1),'read':!![],'write':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x2c2),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x323),'type':_0xca7fd6(0x313),'role':'json','read':!![],'write':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)]('analysis.trigger',{'type':'state','common':{'name':_0xca7fd6(0x33f),'type':_0xca7fd6(0x2fe),'role':_0xca7fd6(0x208),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x18b),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x305),'type':_0xca7fd6(0x2fe),'role':_0xca7fd6(0x208),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x1ee),{'type':'state','common':{'name':_0xca7fd6(0x2f9),'type':_0xca7fd6(0x313),'role':_0xca7fd6(0x2f1),'read':!![],'write':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x27e),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x34e),'type':_0xca7fd6(0x2fe),'role':_0xca7fd6(0x32d),'read':!![],'write':![],'def':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x2c6),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x2d6),'type':_0xca7fd6(0x2fe),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)]('analysis.alertReason',{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x2be),'type':_0xca7fd6(0x313),'role':_0xca7fd6(0x342),'read':!![],'write':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x196),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x1c7),'type':_0xca7fd6(0x313),'role':'text','read':!![],'write':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x343),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x333),'type':_0xca7fd6(0x313),'role':_0xca7fd6(0x338),'read':!![],'write':![],'def':_0xca7fd6(0x329)},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x356),{'type':'state','common':{'name':_0xca7fd6(0x199),'type':_0xca7fd6(0x313),'role':'text','read':!![],'write':![]},'native':{}}),await _0x34d14f['setObjectNotExistsAsync'](_0xca7fd6(0x363),{'type':_0xca7fd6(0x338),'common':{'name':'Comfort\x20Suggestion','type':_0xca7fd6(0x313),'role':_0xca7fd6(0x1f2),'read':!![],'write':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x31e)](_0xca7fd6(0x18f),{'type':_0xca7fd6(0x336),'common':{'name':_0xca7fd6(0x320)},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x25e),{'type':_0xca7fd6(0x338),'common':{'name':'Pattern\x20Detected','type':_0xca7fd6(0x2fe),'role':_0xca7fd6(0x314),'read':!![],'write':![],'def':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x2d5),{'type':'state','common':{'name':_0xca7fd6(0x29b),'type':_0xca7fd6(0x313),'role':_0xca7fd6(0x1f2),'read':!![],'write':![]},'native':{}}),await _0x34d14f['setObjectNotExistsAsync'](_0xca7fd6(0x29a),{'type':'state','common':{'name':_0xca7fd6(0x1c5),'type':_0xca7fd6(0x313),'role':_0xca7fd6(0x1f2),'read':!![],'write':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x243),{'type':'state','common':{'name':'Target\x20ID','type':'string','role':_0xca7fd6(0x1f2),'read':!![],'write':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x1bc),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x228),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x34d14f['setObjectNotExistsAsync']('analysis.automation.autoApply',{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x1ba),'type':'boolean','role':_0xca7fd6(0x1bb),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x1e3),{'type':'state','common':{'name':_0xca7fd6(0x283),'type':'boolean','role':_0xca7fd6(0x208),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x2b8),{'type':'state','common':{'name':'Logbook','type':_0xca7fd6(0x313),'role':_0xca7fd6(0x2f1),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x23c),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x245),'type':'string','role':_0xca7fd6(0x2f1),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x34d14f[_0xca7fd6(0x31e)](_0xca7fd6(0x1f4),{'type':_0xca7fd6(0x336),'common':{'name':_0xca7fd6(0x327)},'native':{}}),await _0x34d14f['setObjectNotExistsAsync']('analysis.health.sleepScore',{'type':_0xca7fd6(0x338),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0xca7fd6(0x299),'role':_0xca7fd6(0x237),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x34a),{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x34d),'type':_0xca7fd6(0x313),'role':_0xca7fd6(0x1f2),'read':!![],'write':![],'def':'none'},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x2e9),{'type':'state','common':{'name':_0xca7fd6(0x236),'type':'string','role':_0xca7fd6(0x1f2),'read':!![],'write':![],'def':''},'native':{}}),await _0x34d14f['setObjectNotExistsAsync'](_0xca7fd6(0x206),{'type':'state','common':{'name':_0xca7fd6(0x33a),'type':'string','role':_0xca7fd6(0x1f2),'read':!![],'write':![],'def':_0xca7fd6(0x329)},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)](_0xca7fd6(0x306),{'type':_0xca7fd6(0x338),'common':{'name':'Trend\x20Value\x20(%)','type':'number','role':_0xca7fd6(0x2a8),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x34d14f[_0xca7fd6(0x31e)](_0xca7fd6(0x2e6),{'type':_0xca7fd6(0x336),'common':{'name':_0xca7fd6(0x316)},'native':{}}),await _0x34d14f[_0xca7fd6(0x1a0)]('LTM.trainingData.sequences',{'type':_0xca7fd6(0x338),'common':{'name':_0xca7fd6(0x1a3),'type':_0xca7fd6(0x313),'role':_0xca7fd6(0x2f1),'read':!![],'write':![],'def':'[]','desc':_0xca7fd6(0x2e7)},'native':{}}),await checkLtmObjects(_0x34d14f),await checkLtmDriftObjects(_0x34d14f);}async function checkSystemObjects(_0x436e84){const _0x5e382b=a0_0x54083a;await _0x436e84[_0x5e382b(0x31e)](_0x5e382b(0x275),{'type':'channel','common':{'name':_0x5e382b(0x23f)},'native':{}}),await _0x436e84['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x5e382b(0x338),'common':{'name':'System\x20Mode','type':_0x5e382b(0x313),'role':_0x5e382b(0x338),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x5e382b(0x1c0)],'states':{[SYSTEM_MODES['NORMAL']]:'Normal',[SYSTEM_MODES['VACATION']]:_0x5e382b(0x1d3),[SYSTEM_MODES[_0x5e382b(0x21c)]]:'Party',[SYSTEM_MODES[_0x5e382b(0x181)]]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x17c6de){const _0x10a0e4=a0_0x54083a;await _0x17c6de[_0x10a0e4(0x31e)](_0x10a0e4(0x32a),{'type':_0x10a0e4(0x336),'common':{'name':_0x10a0e4(0x32a)},'native':{}}),await _0x17c6de[_0x10a0e4(0x31e)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':'Raw\x20Log','type':_0x10a0e4(0x313),'role':_0x10a0e4(0x2f1),'read':!![],'write':![]},'native':{}}),await _0x17c6de[_0x10a0e4(0x31e)](LTM_DP_DAILY_DIGESTS,{'type':_0x10a0e4(0x338),'common':{'name':_0x10a0e4(0x29c),'type':_0x10a0e4(0x313),'role':_0x10a0e4(0x2f1),'read':!![],'write':![]},'native':{}}),await _0x17c6de[_0x10a0e4(0x31e)](LTM_DP_STATUS,{'type':_0x10a0e4(0x338),'common':{'name':_0x10a0e4(0x19c),'type':_0x10a0e4(0x313),'role':_0x10a0e4(0x1f2),'read':!![],'write':![]},'native':{}}),await _0x17c6de['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x10a0e4(0x338),'common':{'name':_0x10a0e4(0x334),'type':_0x10a0e4(0x2fe),'role':_0x10a0e4(0x208),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x17c6de[_0x10a0e4(0x31e)](LTM_DP_BASELINE_STATUS,{'type':_0x10a0e4(0x338),'common':{'name':_0x10a0e4(0x2d8),'type':'string','role':_0x10a0e4(0x1f2),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x32f2d3){const _0x21ceff=a0_0x54083a;await _0x32f2d3[_0x21ceff(0x31e)](LTM_DP_DRIFT_CHANNEL,{'type':_0x21ceff(0x336),'common':{'name':_0x21ceff(0x210)},'native':{}}),await _0x32f2d3['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x21ceff(0x338),'common':{'name':_0x21ceff(0x2b2),'type':_0x21ceff(0x313),'role':'state','read':!![],'write':![],'def':_0x21ceff(0x329)},'native':{}}),await _0x32f2d3[_0x21ceff(0x31e)](LTM_DP_DRIFT_DETAILS,{'type':_0x21ceff(0x338),'common':{'name':_0x21ceff(0x2fa),'type':_0x21ceff(0x313),'role':_0x21ceff(0x1f2),'read':!![],'write':![]},'native':{}}),await _0x32f2d3['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x21ceff(0x338),'common':{'name':'Last\x20Check','type':_0x21ceff(0x299),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x3edf34){const _0x23c850=a0_0x54083a;try{const _0x18b1a7=await _0x3edf34[_0x23c850(0x1d4)](SYSTEM_DP_MODE);_0x18b1a7&&_0x18b1a7[_0x23c850(0x1e7)]&&Object[_0x23c850(0x239)](SYSTEM_MODES)[_0x23c850(0x2f4)](_0x18b1a7[_0x23c850(0x1e7)])?_0x3edf34[_0x23c850(0x355)]=_0x18b1a7[_0x23c850(0x1e7)]:(_0x3edf34['currentSystemMode']=SYSTEM_MODES[_0x23c850(0x1c0)],await _0x3edf34[_0x23c850(0x200)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x23c850(0x1c0)],'ack':!![]}));}catch(_0x237d05){_0x3edf34[_0x23c850(0x355)]=SYSTEM_MODES[_0x23c850(0x1c0)];}}async function loadRawEventLog(_0x1dba3a){const _0x180ce5=a0_0x54083a;try{const _0x41658b=await _0x1dba3a[_0x180ce5(0x1d4)](LTM_DP_RAW_LOG);if(_0x41658b&&_0x41658b['val'])_0x1dba3a['rawEventLog']=JSON['parse'](_0x41658b[_0x180ce5(0x1e7)]);}catch(_0x68c0af){_0x1dba3a[_0x180ce5(0x2e0)]=[];}}async function saveRawEventLog(_0x28104a){const _0x568e06=a0_0x54083a;_0x28104a[_0x568e06(0x2e0)][_0x568e06(0x2ba)]>RAW_LOG_MAX_SIZE&&_0x28104a['rawEventLog'][_0x568e06(0x1f5)](0x0,_0x28104a['rawEventLog'][_0x568e06(0x2ba)]-RAW_LOG_MAX_SIZE),await _0x28104a[_0x568e06(0x200)](LTM_DP_RAW_LOG,{'val':JSON[_0x568e06(0x2b0)](_0x28104a['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x351e31){const _0x14b449=a0_0x54083a;try{const _0x4bb724=await _0x351e31[_0x14b449(0x1d4)](LTM_DP_DAILY_DIGESTS);if(_0x4bb724&&_0x4bb724['val'])_0x351e31[_0x14b449(0x192)]=JSON[_0x14b449(0x1ec)](_0x4bb724[_0x14b449(0x1e7)]);}catch(_0x222c42){_0x351e31[_0x14b449(0x192)]=[];}await updateBaselineStatus(_0x351e31);}async function saveDailyDigests(_0x27f2e1,_0x4c4972=!![]){const _0x5b9526=a0_0x54083a,_0x15aad8=_0x27f2e1[_0x5b9526(0x267)][_0x5b9526(0x1d7)]||0x3c;_0x27f2e1[_0x5b9526(0x192)][_0x5b9526(0x2ba)]>_0x15aad8&&_0x27f2e1[_0x5b9526(0x192)][_0x5b9526(0x1f5)](0x0,_0x27f2e1[_0x5b9526(0x192)][_0x5b9526(0x2ba)]-_0x15aad8);await _0x27f2e1[_0x5b9526(0x200)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5b9526(0x2b0)](_0x27f2e1[_0x5b9526(0x192)]),'ack':!![]});if(_0x4c4972)await updateBaselineStatus(_0x27f2e1);}async function updateAnalysisHistory(_0x56b5c8,_0x25c27d){const _0xb1f550=a0_0x54083a;_0x56b5c8['analysisHistory']['unshift'](_0x25c27d);if(_0x56b5c8[_0xb1f550(0x1ab)][_0xb1f550(0x2ba)]>ANALYSIS_HISTORY_MAX_SIZE)_0x56b5c8[_0xb1f550(0x1ab)]['pop']();await _0x56b5c8[_0xb1f550(0x200)]('analysis.analysisHistory',{'val':JSON[_0xb1f550(0x2b0)](_0x56b5c8[_0xb1f550(0x1ab)]),'ack':!![]});}async function updateBaselineStatus(_0x587b71){const _0x4122e6=a0_0x54083a;if(!_0x587b71[_0x4122e6(0x1a4)]){await _0x587b71['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x4122e6(0x1fd),'ack':!![]});return;}const _0x289160=_0x587b71['dailyDigests'][_0x4122e6(0x2ba)]>=(_0x587b71[_0x4122e6(0x267)][_0x4122e6(0x258)]||0x7)?_0x4122e6(0x1dd)+_0x587b71[_0x4122e6(0x192)][_0x4122e6(0x2ba)]+'\x20Tage)':_0x4122e6(0x2a2)+_0x587b71[_0x4122e6(0x192)][_0x4122e6(0x2ba)]+'/'+(_0x587b71[_0x4122e6(0x267)]['minDaysForBaseline']||0x7)+')';await _0x587b71[_0x4122e6(0x200)](LTM_DP_BASELINE_STATUS,{'val':_0x289160,'ack':!![]});}async function initSensorSubscriptions(_0x48df68){const _0x178897=a0_0x54083a,_0x30901b=_0x48df68['config']['devices'];if(_0x30901b&&_0x30901b[_0x178897(0x2ba)]>0x0){_0x48df68[_0x178897(0x25f)][_0x178897(0x189)](_0x178897(0x1ed)+_0x30901b[_0x178897(0x2ba)]+'\x20sensors...');for(const _0x5c66ec of _0x30901b){if(_0x5c66ec['id']){await _0x48df68[_0x178897(0x221)](_0x5c66ec['id']);try{const _0x999e18=await _0x48df68[_0x178897(0x2ff)](_0x5c66ec['id']);if(_0x999e18)_0x48df68[_0x178897(0x2b9)][_0x5c66ec['id']]=_0x999e18[_0x178897(0x1e7)];}catch(_0x236c6c){}}}}}async function initPresenceSubscriptions(_0x15b5f7){const _0x59277d=a0_0x54083a,_0x22c270=_0x15b5f7[_0x59277d(0x267)][_0x59277d(0x2de)]||[];if(_0x22c270[_0x59277d(0x2ba)]>0x0){_0x15b5f7['log'][_0x59277d(0x189)](_0x59277d(0x1ed)+_0x22c270[_0x59277d(0x2ba)]+_0x59277d(0x324));for(const _0x262d6d of _0x22c270){await _0x15b5f7[_0x59277d(0x221)](_0x262d6d);}try{await checkWifiPresence(_0x15b5f7);}catch(_0x169728){}}}async function getWeatherContext(_0x1b1dc1){const _0x452006=a0_0x54083a;try{if(!_0x1b1dc1[_0x452006(0x267)]['useWeather'])return _0x452006(0x27f);let _0x58c138='';const _0x358ed8=_0x1b1dc1[_0x452006(0x267)][_0x452006(0x35b)];if(_0x358ed8)try{if(_0x358ed8[_0x452006(0x2f4)](_0x452006(0x31f))){const _0x1c80c0=await _0x1b1dc1[_0x452006(0x2ff)](_0x358ed8+_0x452006(0x1eb));if(_0x1c80c0&&_0x1c80c0['val'])_0x58c138=_0x1c80c0['val'];}else{if(_0x358ed8[_0x452006(0x2f4)](_0x452006(0x21b))){const _0x37754d=await _0x1b1dc1[_0x452006(0x2ff)](_0x358ed8+_0x452006(0x185));if(_0x37754d&&_0x37754d[_0x452006(0x1e7)])_0x58c138=_0x37754d[_0x452006(0x1e7)];}else{if(_0x358ed8[_0x452006(0x2f4)]('openweathermap')){const _0xf36114=await _0x1b1dc1['getForeignStateAsync'](_0x358ed8+'.forecast.current.state');if(_0xf36114&&_0xf36114[_0x452006(0x1e7)])_0x58c138=_0xf36114['val'];}}}}catch(_0x5c4452){}if(!_0x58c138){const _0x2d7b83=[_0x452006(0x1b8),'daswetter.0',_0x452006(0x1d1),_0x452006(0x20c)];for(const _0xf0b089 of _0x2d7b83){try{const _0x477168=await _0x1b1dc1['getForeignObjectAsync'](_0xf0b089);if(_0x477168){if(_0xf0b089['includes'](_0x452006(0x31f))){const _0x1fa03d=await _0x1b1dc1[_0x452006(0x2ff)](_0xf0b089+_0x452006(0x1eb));if(_0x1fa03d&&_0x1fa03d[_0x452006(0x1e7)]){_0x58c138=_0x1fa03d[_0x452006(0x1e7)];break;}}}}catch(_0x4e5b90){}}}return _0x58c138?'WETTER:\x20'+_0x58c138:_0x452006(0x1a9);}catch(_0xdd5cd9){return _0x452006(0x246)+_0xdd5cd9[_0x452006(0x2c5)];}}async function getCalendarContext(_0x5e598f){const _0x21be9b=a0_0x54083a;try{if(!_0x5e598f['config']['useCalendar'])return'Kalender:\x20Deaktiviert';let _0x2689ba=_0x5e598f[_0x21be9b(0x267)][_0x21be9b(0x340)]||'ical.0',_0x1833a1=_0x5e598f[_0x21be9b(0x267)][_0x21be9b(0x22c)]||[];if(typeof _0x1833a1===_0x21be9b(0x313))_0x1833a1=_0x1833a1[_0x21be9b(0x1a8)](',');try{const _0xd89da1=await _0x5e598f[_0x21be9b(0x2ff)](_0x2689ba+_0x21be9b(0x1ea));if(_0xd89da1&&_0xd89da1[_0x21be9b(0x1e7)]){let _0x81c8a9=tryParse(_0xd89da1['val']);if(_0x81c8a9&&Array[_0x21be9b(0x279)](_0x81c8a9)){if(_0x1833a1[_0x21be9b(0x2ba)]>0x0)_0x81c8a9=_0x81c8a9['filter'](_0xba0f91=>_0x1833a1['includes'](_0xba0f91['_calName']||''));else return _0x21be9b(0x1a6);if(_0x81c8a9['length']>0x0){const _0x35d221=_0x81c8a9['slice'](0x0,0x3)[_0x21be9b(0x227)](_0x1a9179=>{const _0x299eee=_0x21be9b;let _0x219fa7=_0x1a9179[_0x299eee(0x2bb)];if(_0x1a9179[_0x299eee(0x207)])_0x219fa7+='\x20'+_0x1a9179[_0x299eee(0x207)];return _0x219fa7+':\x20'+_0x1a9179[_0x299eee(0x2ca)]+'\x20('+_0x1a9179['_calName']+')';});return _0x21be9b(0x28c)+_0x35d221[_0x21be9b(0x26b)]('\x20|\x20');}else return _0x21be9b(0x294);}}}catch(_0x112a30){_0x5e598f[_0x21be9b(0x25f)][_0x21be9b(0x273)]('Error\x20reading\x20calendar\x20table:\x20'+_0x112a30[_0x21be9b(0x2c5)]);}return _0x21be9b(0x274);}catch(_0x1dd438){return _0x21be9b(0x2a5)+_0x1dd438[_0x21be9b(0x2c5)];}}async function getCalendarNames(_0x2ec4cc,_0x46ce86){const _0x28efdd=a0_0x54083a;try{const _0x351de9=await _0x2ec4cc['getForeignStateAsync'](_0x46ce86+'.data.table');if(_0x351de9&&_0x351de9['val']){const _0x2cabf7=tryParse(_0x351de9['val']);if(_0x2cabf7&&Array[_0x28efdd(0x279)](_0x2cabf7)){const _0x4495da=[...new Set(_0x2cabf7[_0x28efdd(0x227)](_0xe3c570=>_0xe3c570['_calName'])['filter'](Boolean))];return _0x4495da[_0x28efdd(0x230)]();}}return[];}catch(_0x31cf49){return _0x2ec4cc[_0x28efdd(0x25f)][_0x28efdd(0x1e5)]('getCalendarNames\x20Error:\x20'+_0x31cf49[_0x28efdd(0x2c5)]),[];}}async function checkWifiPresence(_0x6eb6e){const _0x489ed6=a0_0x54083a;try{const _0x660e5f=_0x6eb6e[_0x489ed6(0x267)]['presenceDevices']||[];let _0xee6885=![];const _0x134421=[];for(const _0x1118fe of _0x660e5f){try{const _0x5cb653=await _0x6eb6e[_0x489ed6(0x2ff)](_0x1118fe);if(_0x5cb653&&(_0x5cb653['val']===!![]||_0x5cb653['val']===_0x489ed6(0x31b)||_0x5cb653[_0x489ed6(0x1e7)]===0x1)){_0xee6885=!![];const _0x32c221=await _0x6eb6e[_0x489ed6(0x1aa)](_0x1118fe);let _0x5d58a2=_0x1118fe;_0x32c221&&_0x32c221[_0x489ed6(0x1fa)]&&_0x32c221[_0x489ed6(0x1fa)][_0x489ed6(0x2ec)]&&(_0x5d58a2=typeof _0x32c221['common'][_0x489ed6(0x2ec)]===_0x489ed6(0x226)?_0x32c221[_0x489ed6(0x1fa)][_0x489ed6(0x2ec)]['de']||_0x32c221[_0x489ed6(0x1fa)][_0x489ed6(0x2ec)]['en']:_0x32c221[_0x489ed6(0x1fa)]['name']),_0x134421[_0x489ed6(0x2d2)](_0x5d58a2);}}catch(_0x5b433c){}}return await _0x6eb6e[_0x489ed6(0x200)](_0x489ed6(0x1b9),{'val':_0x134421[_0x489ed6(0x26b)](',\x20'),'ack':!![]}),_0xee6885&&(_0x6eb6e[_0x489ed6(0x1c3)]&&(_0x6eb6e[_0x489ed6(0x25f)]['info'](_0x489ed6(0x34f)),abortExitTimer(_0x6eb6e)),!_0x6eb6e[_0x489ed6(0x345)]&&_0x6eb6e['currentSystemMode']===SYSTEM_MODES[_0x489ed6(0x1c0)]&&await setPresence(_0x6eb6e,!![])),_0xee6885;}catch(_0x55922e){return _0x6eb6e['log'][_0x489ed6(0x1e5)](_0x489ed6(0x359)+_0x55922e[_0x489ed6(0x2c5)]),![];}}function startExitTimer(_0x566c60){const _0x96411f=a0_0x54083a;abortExitTimer(_0x566c60),_0x566c60[_0x96411f(0x307)]=!![],_0x566c60[_0x96411f(0x21f)]=setTimeout(()=>{const _0x5e5a3f=_0x96411f;_0x566c60[_0x5e5a3f(0x307)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x566c60[_0x96411f(0x1c3)]=setTimeout(()=>{setPresence(_0x566c60,![]),_0x566c60['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x26a6bf){const _0xe51a81=a0_0x54083a;if(_0x26a6bf[_0xe51a81(0x1c3)])clearTimeout(_0x26a6bf[_0xe51a81(0x1c3)]);if(_0x26a6bf[_0xe51a81(0x21f)])clearTimeout(_0x26a6bf[_0xe51a81(0x21f)]);_0x26a6bf[_0xe51a81(0x1c3)]=null,_0x26a6bf[_0xe51a81(0x21f)]=null,_0x26a6bf[_0xe51a81(0x307)]=![];}async function setPresence(_0x3382d6,_0x3672c9){const _0x54e224=a0_0x54083a;if(_0x3382d6[_0x54e224(0x345)]===_0x3672c9)return;_0x3382d6['isPresent']=_0x3672c9,await _0x3382d6[_0x54e224(0x200)](_0x54e224(0x27a),{'val':_0x3672c9,'ack':!![]});}async function saveFeedback(_0xbc17b0,_0x83c7f){const _0x46ebd1=a0_0x54083a;_0xbc17b0[_0x46ebd1(0x25f)][_0x46ebd1(0x189)](_0x46ebd1(0x35c)+JSON[_0x46ebd1(0x2b0)](_0x83c7f));}async function runBaselineDriftAnalysis(_0x46b175){const _0x154c70=a0_0x54083a;if(!_0x46b175[_0x154c70(0x1a4)]||!_0x46b175[_0x154c70(0x321)])return;const _0x2fff37=_0x46b175[_0x154c70(0x267)][_0x154c70(0x1e8)]||0xe;if(_0x46b175[_0x154c70(0x192)][_0x154c70(0x2ba)]<_0x2fff37+(_0x46b175[_0x154c70(0x267)][_0x154c70(0x258)]||0x7)){await _0x46b175['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x154c70(0x19b),'ack':!![]});return;}const _0x9b8413=_0x46b175[_0x154c70(0x192)][_0x154c70(0x1cc)](-_0x2fff37),_0xb2e3c1=_0x46b175[_0x154c70(0x192)][_0x154c70(0x1cc)](0x0,_0x46b175['dailyDigests'][_0x154c70(0x2ba)]-_0x2fff37),_0x9c214c=_0x154c70(0x2df)+JSON[_0x154c70(0x2b0)](_0xb2e3c1)+_0x154c70(0x2d1)+JSON['stringify'](_0x9b8413);try{const _0x165a3e=await _0x46b175[_0x154c70(0x321)][_0x154c70(0x2cf)](_0x9c214c),_0x35872b=JSON[_0x154c70(0x1ec)](_0x165a3e['response'][_0x154c70(0x1f2)]()[_0x154c70(0x34b)](/```json|```/g,'')['trim']());_0x35872b['baselineDrift']&&(await _0x46b175['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x35872b[_0x154c70(0x286)],'ack':!![]}),await _0x46b175[_0x154c70(0x200)](LTM_DP_DRIFT_DETAILS,{'val':_0x35872b[_0x154c70(0x19d)],'ack':!![]}),await _0x46b175[_0x154c70(0x200)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x15e858){}}function setupLtmScheduler(_0x45ce26){const _0x59da9d=a0_0x54083a;try{if(_0x45ce26[_0x59da9d(0x1be)])_0x45ce26[_0x59da9d(0x1be)][_0x59da9d(0x1e9)]();if(!_0x45ce26[_0x59da9d(0x1a4)]){_0x45ce26['setStateAsync'](LTM_DP_STATUS,{'val':_0x59da9d(0x1fd),'ack':!![]});return;}_0x45ce26[_0x59da9d(0x1be)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x45ce26));}catch(_0x49789a){_0x45ce26['log'][_0x59da9d(0x1e5)](_0x59da9d(0x263)+_0x49789a[_0x59da9d(0x2c5)]);}}function setupModeResetScheduler(_0x5a9def){const _0x1f67d9=a0_0x54083a;try{if(_0x5a9def['modeResetJob'])_0x5a9def[_0x1f67d9(0x209)][_0x1f67d9(0x1e9)]();_0x5a9def[_0x1f67d9(0x209)]=schedule[_0x1f67d9(0x31d)](MODE_RESET_SCHEDULE,async()=>{const _0x2ed33d=_0x1f67d9;await loadSystemMode(_0x5a9def),AUTO_RESET_MODES[_0x2ed33d(0x2f4)](_0x5a9def[_0x2ed33d(0x355)])&&await _0x5a9def['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x2ed33d(0x1c0)],'ack':![]});});}catch(_0x32e7f2){_0x5a9def[_0x1f67d9(0x25f)]['error'](_0x1f67d9(0x302)+_0x32e7f2['message']);}}function setupDriftAnalysisScheduler(_0x49bce8){const _0x3a3b30=a0_0x54083a;try{if(_0x49bce8[_0x3a3b30(0x22d)])clearInterval(_0x49bce8[_0x3a3b30(0x22d)]);if(!_0x49bce8[_0x3a3b30(0x1a4)])return;_0x49bce8[_0x3a3b30(0x22d)]=setInterval(()=>runBaselineDriftAnalysis(_0x49bce8),(_0x49bce8['config']['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x49bce8),0x1388);}catch(_0x1506f3){_0x49bce8[_0x3a3b30(0x25f)][_0x3a3b30(0x1e5)]('Drift\x20Sched\x20Error:\x20'+_0x1506f3[_0x3a3b30(0x2c5)]);}}function setupBriefingScheduler(_0x5d7ab9){const _0x201485=a0_0x54083a;try{if(_0x5d7ab9[_0x201485(0x28d)])_0x5d7ab9[_0x201485(0x28d)][_0x201485(0x1e9)]();if(!_0x5d7ab9[_0x201485(0x267)][_0x201485(0x29f)])return;const _0x512534=(_0x5d7ab9[_0x201485(0x267)][_0x201485(0x253)]||'08:00')[_0x201485(0x1a8)](':'),_0xc5f843=parseInt(_0x512534[0x0])||0x8,_0x19186c=parseInt(_0x512534[0x1])||0x0,_0x212068=_0x19186c+'\x20'+_0xc5f843+'\x20*\x20*\x20*';_0x5d7ab9[_0x201485(0x25f)][_0x201485(0x189)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0xc5f843+':'+(_0x19186c<0xa?'0'+_0x19186c:_0x19186c)),_0x5d7ab9['briefingJob']=schedule[_0x201485(0x31d)](_0x212068,()=>{sendMorningBriefing(_0x5d7ab9);});}catch(_0x4647f0){_0x5d7ab9['log'][_0x201485(0x1e5)](_0x201485(0x1ca)+_0x4647f0[_0x201485(0x2c5)]);}}async function sendNotification(_0xfd4ea5,_0x1fad46,_0x3e2cc6=![],_0x2a2637=![]){const _0x17bd93=a0_0x54083a;_0xfd4ea5[_0x17bd93(0x25f)][_0x17bd93(0x189)]((_0x3e2cc6?_0x17bd93(0x33c):'')+'Sending\x20notification:\x20\x22'+_0x1fad46+'\x22');const _0x407abb=_0xfd4ea5[_0x17bd93(0x267)];let _0x455de7=0x0;if(_0x407abb[_0x17bd93(0x2f7)]){let _0x215edf={};(_0x1fad46[_0x17bd93(0x2f4)](_0x17bd93(0x30d))||_0x2a2637)&&(_0x215edf={'reply_markup':{'inline_keyboard':[[{'text':_0x17bd93(0x26e),'callback_data':_0x17bd93(0x2b3)}],[{'text':_0x17bd93(0x319),'callback_data':_0x17bd93(0x19a)}]]}}),await _0xfd4ea5[_0x17bd93(0x1c1)](_0x407abb[_0x17bd93(0x205)],'send',{'text':_0x1fad46,'user':_0x407abb[_0x17bd93(0x35d)],..._0x215edf}),_0x455de7++;}if(_0x407abb[_0x17bd93(0x250)]){let _0x151572={'message':_0x1fad46,'title':_0x2a2637?_0x17bd93(0x1e1):_0x17bd93(0x2ef),'priority':_0x2a2637?0x2:0x1,'device':_0x407abb[_0x17bd93(0x2c0)]};_0x2a2637&&(_0x151572[_0x17bd93(0x35a)]=0x1e,_0x151572[_0x17bd93(0x194)]=0xe10,_0x151572['sound']=_0x17bd93(0x190)),await _0xfd4ea5['sendToAsync'](_0x407abb[_0x17bd93(0x259)],'send',_0x151572),_0x455de7++;}return _0x407abb[_0x17bd93(0x347)]&&(await _0xfd4ea5[_0x17bd93(0x1c1)](_0x407abb[_0x17bd93(0x25c)],_0x17bd93(0x270),{'text':_0x1fad46,'to':_0x407abb[_0x17bd93(0x22b)]}),_0x455de7++),_0x455de7;}async function setupTelegramListener(_0x11e5ba){const _0x13c61a=a0_0x54083a,_0x9e91eb=_0x11e5ba[_0x13c61a(0x267)][_0x13c61a(0x205)];_0x11e5ba[_0x13c61a(0x267)]['notifyTelegramEnabled']&&_0x9e91eb&&(_0x11e5ba[_0x13c61a(0x25f)][_0x13c61a(0x189)](_0x13c61a(0x198)+_0x9e91eb+'\x20for\x20interactive\x20buttons...'),await _0x11e5ba[_0x13c61a(0x221)](_0x9e91eb+'.communicate.request'));}async function handleTelegramResponse(_0x1d662d,_0x2df575){const _0x4dbd8f=a0_0x54083a;let _0x369aa1=_0x2df575;_0x2df575['startsWith']('[')&&(_0x369aa1=_0x2df575[_0x4dbd8f(0x32c)](_0x2df575['indexOf'](']')+0x1));if(_0x369aa1===_0x4dbd8f(0x2b3))_0x1d662d['log'][_0x4dbd8f(0x189)](_0x4dbd8f(0x2dd)),await _0x1d662d[_0x4dbd8f(0x200)](_0x4dbd8f(0x27e),{'val':![],'ack':!![]}),await _0x1d662d['setStateAsync'](_0x4dbd8f(0x2c4),{'val':_0x4dbd8f(0x330),'ack':!![]}),_0x1d662d['lastAlertState']=![],sendNotification(_0x1d662d,_0x4dbd8f(0x2f3),![]);else _0x369aa1==='COGNI_REQUEST_CALL'&&(_0x1d662d[_0x4dbd8f(0x25f)]['warn'](_0x4dbd8f(0x223)),sendNotification(_0x1d662d,'üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.',![],!![]));}async function runAutopilot(_0xfaca21){const _0xbc53de=a0_0x54083a,_0x140b5d=_0xfaca21['config'][_0xbc53de(0x2a6)],_0x44717d=_0xfaca21[_0xbc53de(0x1f0)][_0xbc53de(0x2ba)]>0x0?_0xfaca21['eventHistory'][0x0][_0xbc53de(0x2a3)]:Date[_0xbc53de(0x365)](),_0x248a34=(Date[_0xbc53de(0x365)]()-_0x44717d)/(0x3e8*0x3c*0x3c);let _0x1fa647='';_0xfaca21[_0xbc53de(0x267)]['inactivityMonitoringEnabled']&&_0xfaca21[_0xbc53de(0x355)]===SYSTEM_MODES[_0xbc53de(0x1c0)]&&_0xfaca21['isPresent']&&(_0x248a34>_0x140b5d&&(_0x1fa647='HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0x248a34[_0xbc53de(0x2fb)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0xfaca21,_0x1fa647)['catch'](_0x3b8edf=>_0xfaca21[_0xbc53de(0x25f)][_0xbc53de(0x1e5)](_0x3b8edf));}async function createDailyDigest(_0x1c0ccc){const _0x292091=a0_0x54083a;if(!_0x1c0ccc[_0x292091(0x1a4)])return;await _0x1c0ccc['setStateAsync'](LTM_DP_STATUS,{'val':_0x292091(0x1b5)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x1c0ccc[_0x292091(0x321)]||_0x1c0ccc[_0x292091(0x2e0)][_0x292091(0x2ba)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1c0ccc[_0x292091(0x200)](LTM_DP_STATUS,{'val':_0x292091(0x2eb),'ack':!![]});return;}const _0x71d499=JSON['parse'](JSON[_0x292091(0x2b0)](_0x1c0ccc[_0x292091(0x2e0)])),_0x6b9167=_0x71d499[_0x292091(0x2ba)],_0x57a049='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x292091(0x2b0)](_0x71d499);try{const _0x1a1bc1=await _0x1c0ccc[_0x292091(0x321)][_0x292091(0x2cf)](_0x57a049),_0x4fd812=JSON[_0x292091(0x1ec)](_0x1a1bc1[_0x292091(0x2ce)][_0x292091(0x1f2)]()[_0x292091(0x34b)](/```json|```/g,'')['trim']());_0x4fd812[_0x292091(0x182)]&&(_0x1c0ccc[_0x292091(0x192)][_0x292091(0x2d2)]({'timestamp':new Date()['toISOString'](),'eventCount':_0x6b9167,'summary':_0x4fd812[_0x292091(0x182)],'activityLevel':_0x4fd812[_0x292091(0x27c)],'systemMode':_0x1c0ccc[_0x292091(0x355)]}),await saveDailyDigests(_0x1c0ccc),_0x1c0ccc[_0x292091(0x2e0)]=[],await saveRawEventLog(_0x1c0ccc),await _0x1c0ccc[_0x292091(0x200)](LTM_DP_STATUS,{'val':_0x292091(0x21a)+_0x6b9167+_0x292091(0x341),'ack':!![]}),runPythonHealthCheck(_0x1c0ccc));}catch(_0x41232e){await _0x1c0ccc['setStateAsync'](LTM_DP_STATUS,{'val':'Error:\x20'+_0x41232e['message'],'ack':!![]});}}async function sendMorningBriefing(_0x2e2e36){const _0x307b4b=a0_0x54083a;if(!_0x2e2e36[_0x307b4b(0x321)])return;_0x2e2e36[_0x307b4b(0x25f)]['info'](_0x307b4b(0x22f));const _0x34b71f=_0x2e2e36[_0x307b4b(0x192)]['length']>0x0?_0x2e2e36[_0x307b4b(0x192)][_0x2e2e36[_0x307b4b(0x192)]['length']-0x1]:null,_0x183dd7=_0x34b71f&&_0x34b71f[_0x307b4b(0x353)]?_0x34b71f[_0x307b4b(0x353)]['sleepScore']:_0x307b4b(0x329),_0x2ea68c=new Date();_0x2ea68c[_0x307b4b(0x29e)](0x4,0x0,0x0,0x0);const _0x343e17=_0x2e2e36[_0x307b4b(0x1f0)][_0x307b4b(0x217)](_0x1fb3bb=>new Date(_0x1fb3bb['timestamp'])>_0x2ea68c),_0x5df7f6=PERSONA_MAPPING[_0x2e2e36[_0x307b4b(0x267)][_0x307b4b(0x298)]||_0x307b4b(0x28a)],_0x23f97a=_0x2e2e36[_0x307b4b(0x267)][_0x307b4b(0x2c8)]||'',_0x2c0b9e=await getWeatherContext(_0x2e2e36),_0x1f6d7d=await getCalendarContext(_0x2e2e36),_0xd2b216=_0x307b4b(0x266)+_0x5df7f6+'.\x20KONTEXT:\x20'+_0x23f97a+'.\x20ZUSATZ:\x20'+_0x2c0b9e+'\x20'+_0x1f6d7d+_0x307b4b(0x233)+_0x183dd7+_0x307b4b(0x309)+JSON[_0x307b4b(0x2b0)](_0x343e17[_0x307b4b(0x1cc)](0x0,0xa))+_0x307b4b(0x297);try{const _0x2fabb3=await _0x2e2e36[_0x307b4b(0x321)]['generateContent'](_0xd2b216),_0x5e4472=_0x307b4b(0x1a5)+_0x2fabb3['response'][_0x307b4b(0x1f2)]()['trim']();sendNotification(_0x2e2e36,_0x5e4472),_0x2e2e36['log'][_0x307b4b(0x189)](_0x307b4b(0x24c));}catch(_0xd04519){_0x2e2e36['log'][_0x307b4b(0x1e5)](_0x307b4b(0x35e)+_0xd04519[_0x307b4b(0x2c5)]);}}async function scanForDevices(_0x2826c6,_0x557e69){const _0x1ef83b=a0_0x54083a;_0x2826c6[_0x1ef83b(0x25f)][_0x1ef83b(0x189)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x2985a1=[],_0x1db283=await _0x2826c6[_0x1ef83b(0x215)]('*'),_0x4ec649=await _0x2826c6['getForeignObjectsAsync'](_0x1ef83b(0x271),_0x1ef83b(0x18c)),_0xff4266=await _0x2826c6[_0x1ef83b(0x215)]('enum.rooms.*','enum'),_0x3b1028={};if(_0x4ec649)for(const _0x213bfe in _0x4ec649){const _0x33a30c=_0x4ec649[_0x213bfe][_0x1ef83b(0x1fa)][_0x1ef83b(0x1e4)]||[];_0x33a30c[_0x1ef83b(0x30e)](_0x3795dc=>{const _0x14a77b=_0x1ef83b;if(!_0x3b1028[_0x3795dc])_0x3b1028[_0x3795dc]=[];_0x3b1028[_0x3795dc][_0x14a77b(0x2d2)](_0x213bfe);});}const _0x31e243={};if(_0xff4266)for(const _0x97e2c1 in _0xff4266){const _0x5c5aa4=_0xff4266[_0x97e2c1][_0x1ef83b(0x1fa)][_0x1ef83b(0x1e4)]||[],_0x356d1b=typeof _0xff4266[_0x97e2c1][_0x1ef83b(0x1fa)][_0x1ef83b(0x2ec)]===_0x1ef83b(0x226)?_0xff4266[_0x97e2c1]['common'][_0x1ef83b(0x2ec)]['de']:_0xff4266[_0x97e2c1][_0x1ef83b(0x1fa)][_0x1ef83b(0x2ec)];_0x5c5aa4[_0x1ef83b(0x30e)](_0x41efb2=>_0x31e243[_0x41efb2]=_0x356d1b);}const _0xe317c0=_0x557e69[_0x1ef83b(0x2a9)]||[],_0x23757e=_0x557e69[_0x1ef83b(0x22e)]!==![],_0x2456f0=_0x557e69[_0x1ef83b(0x2e3)]!==![],_0x2b003e=_0x557e69[_0x1ef83b(0x17e)]!==![],_0x32eb33=_0x557e69[_0x1ef83b(0x2e2)]===!![],_0x197074=_0x557e69['weather']===!![];for(const _0x432264 in _0x1db283){const _0x4caa71=_0x1db283[_0x432264];if(_0x4caa71[_0x1ef83b(0x24e)]!==_0x1ef83b(0x338)||!_0x4caa71[_0x1ef83b(0x1fa)])continue;if(ADAPTER_BLACKLIST['some'](_0xd24bb9=>_0x432264['startsWith'](_0xd24bb9))&&!_0x197074)continue;const _0x37d903=(_0x4caa71[_0x1ef83b(0x1fa)][_0x1ef83b(0x287)]||'')['toLowerCase']();let _0x282177=(typeof _0x4caa71[_0x1ef83b(0x1fa)][_0x1ef83b(0x2ec)]===_0x1ef83b(0x226)?_0x4caa71[_0x1ef83b(0x1fa)][_0x1ef83b(0x2ec)]['de']:_0x4caa71['common'][_0x1ef83b(0x2ec)])||_0x432264;const _0x5c7bfc=_0x282177[_0x1ef83b(0x204)]();let _0x3fc1f2=![],_0xaea16f=![];if(_0xe317c0[_0x1ef83b(0x2ba)]>0x0){const _0x55b702=_0x3b1028[_0x432264]||[],_0x5419a2=_0x432264['split']('.')[_0x1ef83b(0x1cc)](0x0,-0x1)[_0x1ef83b(0x26b)]('.'),_0xca9966=_0x3b1028[_0x5419a2]||[];(_0x55b702[_0x1ef83b(0x27b)](_0x41b856=>_0xe317c0['includes'](_0x41b856))||_0xca9966[_0x1ef83b(0x27b)](_0x2dddbf=>_0xe317c0['includes'](_0x2dddbf)))&&(_0x3fc1f2=!![],_0xaea16f=!![]);}if(!_0x3fc1f2&&!_0x197074){if(HARD_IGNORE_TERMS[_0x1ef83b(0x27b)](_0x10b406=>_0x432264[_0x1ef83b(0x2f4)](_0x10b406)||_0x5c7bfc['includes'](_0x10b406['toLowerCase']())))continue;}if(BAD_NAMES[_0x1ef83b(0x27b)](_0x1d67c2=>_0x5c7bfc===_0x1d67c2||_0x5c7bfc[_0x1ef83b(0x2db)]('.'+_0x1d67c2))){const _0x422f38=_0x432264[_0x1ef83b(0x1a8)]('.');if(_0x422f38[_0x1ef83b(0x2ba)]>0x2){const _0x20e296=_0x422f38[_0x1ef83b(0x1cc)](0x0,-0x1)['join']('.'),_0x57aa55=_0x1db283[_0x20e296];if(_0x57aa55&&_0x57aa55[_0x1ef83b(0x1fa)]&&_0x57aa55[_0x1ef83b(0x1fa)]['name']){const _0x9a522d=typeof _0x57aa55['common'][_0x1ef83b(0x2ec)]===_0x1ef83b(0x226)?_0x57aa55[_0x1ef83b(0x1fa)]['name']['de']:_0x57aa55[_0x1ef83b(0x1fa)][_0x1ef83b(0x2ec)];_0x9a522d&&!_0x282177[_0x1ef83b(0x2f4)](_0x9a522d)&&(_0x282177=_0x9a522d+'\x20'+_0x282177);}}}let _0x4b1022='';if(_0x23757e&&(_0x37d903[_0x1ef83b(0x2f4)](_0x1ef83b(0x22e))||_0x37d903['includes'](_0x1ef83b(0x248))||_0x5c7bfc[_0x1ef83b(0x2f4)](_0x1ef83b(0x1d6))||_0x5c7bfc[_0x1ef83b(0x2f4)]('pr√§senz')))_0x4b1022='motion';else{if(!_0x4b1022&&_0x2456f0&&(_0x37d903['includes'](_0x1ef83b(0x303))||_0x37d903[_0x1ef83b(0x2f4)](_0x1ef83b(0x183))||_0x37d903[_0x1ef83b(0x2f4)](_0x1ef83b(0x2b5))||_0x37d903[_0x1ef83b(0x2f4)](_0x1ef83b(0x2a1))||_0x37d903['includes'](_0x1ef83b(0x1fc))||_0x5c7bfc[_0x1ef83b(0x2f4)](_0x1ef83b(0x357))||_0x5c7bfc[_0x1ef83b(0x2f4)](_0x1ef83b(0x262))||_0x5c7bfc['includes']('rollladen')))_0x4b1022='door';else{if(!_0x4b1022&&_0x2b003e&&(_0x37d903[_0x1ef83b(0x2f4)](_0x1ef83b(0x2dc))||_0x37d903[_0x1ef83b(0x2f4)](_0x1ef83b(0x1bb))||_0x37d903[_0x1ef83b(0x2f4)](_0x1ef83b(0x2b1))||_0x5c7bfc[_0x1ef83b(0x2f4)](_0x1ef83b(0x1c8))||_0x5c7bfc[_0x1ef83b(0x2f4)](_0x1ef83b(0x322))||_0x5c7bfc['includes']('schalter'))){if(_0x4caa71[_0x1ef83b(0x1fa)][_0x1ef83b(0x277)]||_0x37d903['includes'](_0x1ef83b(0x2bc)))_0x4b1022=_0x1ef83b(0x2dc);}else{if(!_0x4b1022&&_0x32eb33&&(_0x37d903[_0x1ef83b(0x2f4)](_0x1ef83b(0x2e2))||_0x37d903['includes'](_0x1ef83b(0x180))||_0x37d903['includes'](_0x1ef83b(0x288))||_0x5c7bfc[_0x1ef83b(0x2f4)](_0x1ef83b(0x2af))||_0x5c7bfc[_0x1ef83b(0x2f4)](_0x1ef83b(0x2b4))||_0x5c7bfc[_0x1ef83b(0x2f4)](_0x1ef83b(0x2b7))))_0x4b1022=_0x1ef83b(0x2e2);else{if(!_0x4b1022&&_0xaea16f)_0x4b1022=_0x1ef83b(0x25a);}}}}if(_0x4b1022){let _0x223b89=_0x31e243[_0x432264]||'';if(!_0x223b89){let _0x4b4e8c=_0x432264;for(let _0x48a687=0x0;_0x48a687<0x3;_0x48a687++){const _0x54322a=_0x4b4e8c[_0x1ef83b(0x31c)]('.');if(_0x54322a===-0x1)break;_0x4b4e8c=_0x4b4e8c[_0x1ef83b(0x32c)](0x0,_0x54322a);if(_0x31e243[_0x4b4e8c]){_0x223b89=_0x31e243[_0x4b4e8c];break;}}}_0x2985a1[_0x1ef83b(0x2d2)]({'id':_0x432264,'name':_0x282177,'location':_0x223b89,'type':_0x4b1022,'logDuplicates':_0x4b1022===_0x1ef83b(0x22e),'isExit':![],'_score':_0x223b89?0x50:_0x4b1022===_0x1ef83b(0x25a)?0x5a:0x28});}}return _0x2985a1['sort']((_0x5c7490,_0x426aab)=>_0x426aab[_0x1ef83b(0x24d)]-_0x5c7490[_0x1ef83b(0x24d)]),_0x2985a1;}async function executeAutomationAction(_0x3017ea){const _0x52af3c=a0_0x54083a;try{const _0x2a1a5f=await _0x3017ea['getStateAsync'](_0x52af3c(0x243)),_0x35129b=await _0x3017ea['getStateAsync'](_0x52af3c(0x1bc));if(_0x2a1a5f&&_0x2a1a5f[_0x52af3c(0x1e7)]&&_0x35129b){const _0x386a92=_0x2a1a5f['val'];let _0x199acb=_0x35129b['val'];try{_0x199acb=JSON[_0x52af3c(0x1ec)](_0x199acb);}catch(_0x572ddb){}_0x3017ea[_0x52af3c(0x25f)][_0x52af3c(0x189)]('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x386a92+_0x52af3c(0x28e)+_0x199acb),await _0x3017ea[_0x52af3c(0x19f)](_0x386a92,_0x199acb);}else _0x3017ea['log']['warn'](_0x52af3c(0x2e1));}catch(_0x700ae8){_0x3017ea[_0x52af3c(0x25f)]['error'](_0x52af3c(0x2f5)+_0x700ae8[_0x52af3c(0x2c5)]);}}function tryParse(_0x367f9d){const _0x179a95=a0_0x54083a;try{return JSON[_0x179a95(0x1ec)](_0x367f9d);}catch(_0x2fde20){return null;}}async function recordSequence(_0x40da20,_0x232632){const _0x3b6d1e=a0_0x54083a;if(_0x232632['type']!==_0x3b6d1e(0x22e)&&_0x232632[_0x3b6d1e(0x24e)]!==_0x3b6d1e(0x303))return;if(_0x232632[_0x3b6d1e(0x2a8)]!==!![])return;if(sequenceTimer)clearTimeout(sequenceTimer);const _0xcd0b7c={'loc':_0x232632[_0x3b6d1e(0x24a)]||_0x3b6d1e(0x2d9),'id':_0x232632['id'],'ts':Date[_0x3b6d1e(0x365)]()};activeSequence[_0x3b6d1e(0x2d2)](_0xcd0b7c),_0x40da20['log'][_0x3b6d1e(0x1e2)](_0x3b6d1e(0x325)+_0xcd0b7c['loc']+_0x3b6d1e(0x289)+activeSequence[_0x3b6d1e(0x2ba)]+')'),sequenceTimer=setTimeout(async()=>{activeSequence['length']>0x1?await saveCompletedSequence(_0x40da20):activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x365941){const _0xf18af6=a0_0x54083a;try{_0x365941['log']['info'](_0xf18af6(0x1c6)+activeSequence[_0xf18af6(0x2ba)]+_0xf18af6(0x26a));const _0x597f0c=await _0x365941[_0xf18af6(0x1d4)](_0xf18af6(0x339));let _0x440ff8=[];if(_0x597f0c&&_0x597f0c[_0xf18af6(0x1e7)])try{_0x440ff8=JSON[_0xf18af6(0x1ec)](_0x597f0c[_0xf18af6(0x1e7)]);}catch(_0x2da86d){}const _0x45efaa=activeSequence[0x0]['ts'],_0x26f04e=activeSequence[_0xf18af6(0x227)](_0x2b86d9=>({'loc':_0x2b86d9[_0xf18af6(0x1de)],'t_delta':Math[_0xf18af6(0x268)]((_0x2b86d9['ts']-_0x45efaa)/0x3e8)})),_0x48d1b9={'timestamp':new Date(_0x45efaa)[_0xf18af6(0x335)](),'steps':_0x26f04e,'duration':Math[_0xf18af6(0x268)]((activeSequence[activeSequence[_0xf18af6(0x2ba)]-0x1]['ts']-_0x45efaa)/0x3e8),'daytime':new Date(_0x45efaa)[_0xf18af6(0x1f9)]()};_0x440ff8[_0xf18af6(0x2d2)](_0x48d1b9),_0x440ff8[_0xf18af6(0x2ba)]>MAX_TRAINING_SET_SIZE&&_0x440ff8['shift'](),await _0x365941['setStateAsync'](_0xf18af6(0x339),{'val':JSON[_0xf18af6(0x2b0)](_0x440ff8),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x4355c1){_0x365941['log'][_0xf18af6(0x1e5)](_0xf18af6(0x18d)+_0x4355c1[_0xf18af6(0x2c5)]);}}async function processSensorEvent(_0x5b7cd3,_0x53b40e,_0x12ff3e,_0x527130){const _0x447864=a0_0x54083a;if(!_0x527130)return;const _0x596952=_0x12ff3e[_0x447864(0x1e7)],_0x3d83aa=Date['now']();_0x5b7cd3[_0x447864(0x25f)][_0x447864(0x1e2)]('Event\x20received:\x20'+_0x53b40e+'\x20=\x20'+_0x596952);const _0xd15781=_0x5b7cd3[_0x447864(0x2b9)][_0x53b40e];_0x5b7cd3[_0x447864(0x2b9)][_0x53b40e]=_0x596952;if(!_0x527130[_0x447864(0x229)]&&_0xd15781!=undefined&&_0xd15781==_0x596952){_0x5b7cd3[_0x447864(0x25f)][_0x447864(0x1e2)]('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x527130[_0x447864(0x2ec)]+'\x20(Value:\x20'+_0x596952+')');return;}const _0x4692b1={'timestamp':_0x3d83aa,'id':_0x53b40e,'name':_0x527130[_0x447864(0x2ec)],'type':_0x527130[_0x447864(0x24e)],'location':_0x527130['location'],'value':_0x596952};_0x5b7cd3[_0x447864(0x1f0)][_0x447864(0x21e)](_0x4692b1);if(_0x5b7cd3['eventHistory'][_0x447864(0x2ba)]>HISTORY_MAX_SIZE)_0x5b7cd3[_0x447864(0x1f0)][_0x447864(0x17d)]();await _0x5b7cd3[_0x447864(0x200)]('events.lastEvent',{'val':JSON['stringify'](_0x4692b1),'ack':!![]}),await _0x5b7cd3[_0x447864(0x200)](_0x447864(0x2c2),{'val':JSON[_0x447864(0x2b0)](_0x5b7cd3[_0x447864(0x1f0)]),'ack':!![]});_0x5b7cd3[_0x447864(0x1a4)]&&(_0x5b7cd3[_0x447864(0x2e0)][_0x447864(0x2d2)](_0x4692b1),await saveRawEventLog(_0x5b7cd3),recordSequence(_0x5b7cd3,_0x4692b1));if(_0x527130[_0x447864(0x2c7)]&&_0x596952===!![]){if(_0x5b7cd3['isPresent']&&!_0x5b7cd3[_0x447864(0x307)])_0x5b7cd3[_0x447864(0x25f)]['info']('Exit\x20Sensor\x20triggered\x20('+_0x527130[_0x447864(0x2ec)]+_0x447864(0x33b)),startExitTimer(_0x5b7cd3);else!_0x5b7cd3[_0x447864(0x345)]&&(_0x5b7cd3[_0x447864(0x25f)][_0x447864(0x189)](_0x447864(0x2e8)+_0x527130[_0x447864(0x2ec)]+_0x447864(0x234)),await setPresence(_0x5b7cd3,!![]));}else _0x527130[_0x447864(0x24e)]===_0x447864(0x22e)&&_0x596952===!![]&&(_0x5b7cd3[_0x447864(0x1c3)]&&(_0x5b7cd3[_0x447864(0x25f)][_0x447864(0x189)](_0x447864(0x337)),abortExitTimer(_0x5b7cd3)),!_0x5b7cd3[_0x447864(0x345)]&&_0x5b7cd3[_0x447864(0x355)]===SYSTEM_MODES[_0x447864(0x1c0)]&&await setPresence(_0x5b7cd3,!![]));}async function runGeminiAnalysis(_0x4dfa5d,_0x14d3a3=''){const _0x3012ba=a0_0x54083a;if(!_0x4dfa5d[_0x3012ba(0x321)])return;if(_0x4dfa5d[_0x3012ba(0x1f0)]['length']===0x0)return;const _0x2336e6=_0x4dfa5d['eventHistory'][_0x3012ba(0x1cc)](0x0,0xf),_0x1da215=await getWeatherContext(_0x4dfa5d),_0x264b32=_0x4dfa5d['currentSystemMode'],_0x24756b=PERSONA_MAPPING[_0x4dfa5d['config'][_0x3012ba(0x298)]||_0x3012ba(0x28a)],_0x1fea42=_0x4dfa5d[_0x3012ba(0x267)][_0x3012ba(0x2c8)]||_0x3012ba(0x332);let _0xc3c29=![];try{const _0x40b186=await _0x4dfa5d[_0x3012ba(0x1d4)](_0x3012ba(0x1fb));if(_0x40b186&&_0x40b186['val'])_0xc3c29=!![];}catch(_0x406289){}const _0x3fcc98=_0x3012ba(0x30b)+_0x24756b+_0x3012ba(0x2c9)+_0x1fea42+_0x3012ba(0x317)+_0x264b32+_0x3012ba(0x361)+_0x1da215+_0x3012ba(0x1c2)+(_0x14d3a3||_0x3012ba(0x315))+_0x3012ba(0x31a)+JSON[_0x3012ba(0x2b0)](_0x2336e6)+_0x3012ba(0x2d3);try{const _0x94c9ba=await _0x4dfa5d['geminiModel'][_0x3012ba(0x2cf)](_0x3fcc98),_0xf072aa=_0x94c9ba['response'][_0x3012ba(0x1f2)]()['replace'](/```json|```/g,'')['trim'](),_0x1edece=JSON[_0x3012ba(0x1ec)](_0xf072aa);await _0x4dfa5d[_0x3012ba(0x200)](_0x3012ba(0x1ee),{'val':JSON[_0x3012ba(0x2b0)](_0x1edece),'ack':!![]});const _0x1e6eae=_0x1edece[_0x3012ba(0x285)]||![];_0x1e6eae!==_0x4dfa5d['lastAlertState']&&(await _0x4dfa5d[_0x3012ba(0x200)]('analysis.isAlert',{'val':_0x1e6eae,'ack':!![]}),_0x4dfa5d[_0x3012ba(0x272)]=_0x1e6eae,_0x1e6eae&&(await _0x4dfa5d[_0x3012ba(0x200)](_0x3012ba(0x2c4),{'val':_0x1edece[_0x3012ba(0x1a7)],'ack':!![]}),sendNotification(_0x4dfa5d,'‚ö†Ô∏è\x20ALARM:\x20'+_0x1edece[_0x3012ba(0x1a7)],![],_0x1edece[_0x3012ba(0x186)]))),_0x1edece[_0x3012ba(0x33e)]&&_0x1edece[_0x3012ba(0x33e)][_0x3012ba(0x18e)]&&_0x1edece[_0x3012ba(0x33e)][_0x3012ba(0x27d)]&&(_0x4dfa5d[_0x3012ba(0x25f)][_0x3012ba(0x189)](_0x3012ba(0x202)+_0x1edece['automationProposal'][_0x3012ba(0x2da)]),await _0x4dfa5d[_0x3012ba(0x200)](_0x3012ba(0x25e),{'val':!![],'ack':!![]}),await _0x4dfa5d['setStateAsync']('analysis.automation.description',{'val':_0x1edece[_0x3012ba(0x33e)][_0x3012ba(0x2da)],'ack':!![]}),await _0x4dfa5d[_0x3012ba(0x200)]('analysis.automation.targetId',{'val':_0x1edece[_0x3012ba(0x33e)]['targetId'],'ack':!![]}),await _0x4dfa5d[_0x3012ba(0x200)](_0x3012ba(0x1bc),{'val':JSON[_0x3012ba(0x2b0)](_0x1edece['automationProposal'][_0x3012ba(0x23a)]),'ack':!![]}),_0xc3c29&&(_0x4dfa5d['log'][_0x3012ba(0x189)]('ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20'+_0x1edece[_0x3012ba(0x33e)][_0x3012ba(0x27d)]+_0x3012ba(0x1b7)),await executeAutomationAction(_0x4dfa5d)));}catch(_0x4e537d){_0x4dfa5d['log'][_0x3012ba(0x1e5)]('Gemini\x20Analysis\x20Error:\x20'+_0x4e537d[_0x3012ba(0x2c5)]);}}function installPythonDependencies(_0x520220){const _0x1e044d=a0_0x54083a;if(_0x520220[_0x1e044d(0x1d2)])return;_0x520220[_0x1e044d(0x1d2)]=!![];const _0x2251bb=path['join'](__dirname,'python_service',_0x1e044d(0x1af));_0x520220[_0x1e044d(0x25f)][_0x1e044d(0x189)](_0x1e044d(0x1df)+_0x2251bb+_0x1e044d(0x1b7)),stopPythonService(_0x520220);const _0xa30608=_0x1e044d(0x326)+_0x2251bb+_0x1e044d(0x2ac);exec(_0xa30608,(_0xe38444,_0x516a18,_0x177daf)=>{const _0x1426e0=_0x1e044d;_0x520220[_0x1426e0(0x1d2)]=![],_0xe38444?(_0x520220[_0x1426e0(0x25f)][_0x1426e0(0x1e5)](_0x1426e0(0x2ad)+_0xa30608),_0x520220['log'][_0x1426e0(0x1e5)]('Details:\x20'+(_0x177daf||_0xe38444[_0x1426e0(0x2c5)]))):(_0x520220['log']['info'](_0x1426e0(0x284)),startPythonService(_0x520220));});}function a0_0x5b44(_0x7c36e9,_0x268387){const _0x3be9e5=a0_0x249c();return a0_0x5b44=function(_0x2e7040,_0x42ac4a){_0x2e7040=_0x2e7040-0x17d;let _0x249c93=_0x3be9e5[_0x2e7040];return _0x249c93;},a0_0x5b44(_0x7c36e9,_0x268387);}function sendToPython(_0x568e85,_0x34ee74,_0x267f52={}){const _0x27574b=a0_0x54083a;if(!_0x568e85[_0x27574b(0x252)]||!_0x568e85[_0x27574b(0x252)]['stdin']['writable'])return;const _0x503304=JSON[_0x27574b(0x2b0)]({'command':_0x34ee74,..._0x267f52});try{_0x568e85['pythonProcess']['stdin'][_0x27574b(0x277)](_0x503304+'\x0a');}catch(_0x22f8e4){_0x568e85[_0x27574b(0x25f)]['error'](_0x27574b(0x2f8)+_0x22f8e4[_0x27574b(0x2c5)]);}}function runPythonHealthCheck(_0x49b3a0){const _0x52c58c=a0_0x54083a;if(!_0x49b3a0[_0x52c58c(0x192)]||_0x49b3a0[_0x52c58c(0x192)]['length']<0x2){_0x49b3a0['log']['info'](_0x52c58c(0x265));return;}const _0x20b3ea=_0x49b3a0[_0x52c58c(0x192)]['map'](_0x571bc2=>{const _0x33c115=_0x52c58c,_0x25601f=(_0x571bc2[_0x33c115(0x27c)]||'')[_0x33c115(0x204)]();return ACTIVITY_LEVEL_MAP[_0x25601f]||0x32;});_0x49b3a0[_0x52c58c(0x25f)][_0x52c58c(0x189)]('Guardian:\x20Sending\x20'+_0x20b3ea['length']+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x49b3a0,_0x52c58c(0x1ad),{'values':_0x20b3ea,'tag':_0x52c58c(0x300)});}function handlePythonResult(_0xf57168,_0x162139){const _0x3a787c=a0_0x54083a;if(_0x162139[_0x3a787c(0x24e)]===_0x3a787c(0x23e))_0xf57168[_0x3a787c(0x25f)][_0x3a787c(0x1e2)](_0x3a787c(0x1b0));else{if(_0x162139[_0x3a787c(0x24e)]===_0x3a787c(0x304)){const {tag:_0x30b86e,diagnosis:_0x245042,change_percent:_0x2d9add}=_0x162139[_0x3a787c(0x2a0)];_0xf57168[_0x3a787c(0x25f)][_0x3a787c(0x189)](_0x3a787c(0x1ac)+_0x30b86e+_0x3a787c(0x2f2)+_0x245042+'\x20('+_0x2d9add+'%)'),_0xf57168['setStateAsync'](_0x3a787c(0x206),{'val':_0x245042,'ack':!![]}),_0xf57168[_0x3a787c(0x200)](_0x3a787c(0x306),{'val':_0x2d9add,'ack':!![]});}}}function startPythonService(_0x56c07d){const _0x3213df=a0_0x54083a;try{const _0x145520=path[_0x3213df(0x26b)](__dirname,_0x3213df(0x225),_0x3213df(0x1cb));_0x56c07d[_0x3213df(0x25f)]['info'](_0x3213df(0x1d8)+_0x145520),_0x56c07d[_0x3213df(0x252)]=spawn(_0x3213df(0x238),[_0x145520]),_0x56c07d[_0x3213df(0x252)][_0x3213df(0x211)]['on'](_0x3213df(0x2ab),_0xaf641c=>{const _0x47bf64=_0x3213df,_0x130c05=_0xaf641c[_0x47bf64(0x184)]()[_0x47bf64(0x1a8)]('\x0a');_0x130c05[_0x47bf64(0x30e)](_0x2feeda=>{const _0x4bc1f4=_0x47bf64,_0x196afe=_0x2feeda[_0x4bc1f4(0x1c4)]();if(!_0x196afe)return;if(_0x196afe['startsWith'](_0x4bc1f4(0x32b)))_0x56c07d[_0x4bc1f4(0x25f)]['debug']('[PYTHON]\x20'+_0x196afe[_0x4bc1f4(0x32c)](0x5)[_0x4bc1f4(0x1c4)]());else{if(_0x196afe[_0x4bc1f4(0x2fc)]('[RESULT]'))try{const _0x505109=JSON['parse'](_0x196afe[_0x4bc1f4(0x32c)](0x8)[_0x4bc1f4(0x1c4)]());handlePythonResult(_0x56c07d,_0x505109);}catch(_0x11c382){_0x56c07d[_0x4bc1f4(0x25f)][_0x4bc1f4(0x273)]('Invalid\x20JSON\x20from\x20Python:\x20'+_0x196afe);}}(_0x196afe[_0x4bc1f4(0x2f4)](_0x4bc1f4(0x1c9))||_0x196afe['includes'](_0x4bc1f4(0x296)))&&(_0x56c07d[_0x4bc1f4(0x25f)][_0x4bc1f4(0x273)](_0x4bc1f4(0x281)),installPythonDependencies(_0x56c07d));});}),_0x56c07d[_0x3213df(0x252)][_0x3213df(0x1d9)]['on'](_0x3213df(0x2ab),_0x4acd18=>{const _0x33d399=_0x3213df,_0x5eadb1=_0x4acd18[_0x33d399(0x184)]()[_0x33d399(0x1c4)]();_0x56c07d['log']['error'](_0x33d399(0x20a)+_0x5eadb1);}),_0x56c07d[_0x3213df(0x252)]['on'](_0x3213df(0x2b6),_0x21e9b6=>{const _0x167645=_0x3213df;_0x56c07d['log']['info']('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x21e9b6),_0x56c07d[_0x167645(0x252)]=null;}),_0x56c07d[_0x3213df(0x252)]['on'](_0x3213df(0x1e5),_0x54fce0=>{const _0x5ca1f9=_0x3213df;_0x56c07d[_0x5ca1f9(0x25f)][_0x5ca1f9(0x273)](_0x5ca1f9(0x24b)+_0x54fce0[_0x5ca1f9(0x2c5)]);});}catch(_0x17269d){_0x56c07d[_0x3213df(0x25f)]['error']('Error\x20launching\x20Python\x20service:\x20'+_0x17269d['message']);}}function stopPythonService(_0x39248c){const _0x1c3e13=a0_0x54083a;if(_0x39248c['pythonProcess']){_0x39248c[_0x1c3e13(0x25f)]['info'](_0x1c3e13(0x364));try{_0x39248c['pythonProcess'][_0x1c3e13(0x352)]();}catch(_0x91855d){_0x39248c[_0x1c3e13(0x25f)][_0x1c3e13(0x273)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x91855d[_0x1c3e13(0x2c5)]);}_0x39248c['pythonProcess']=null;}}class CogniLiving extends utils[a0_0x54083a(0x191)]{constructor(_0x26ad37){const _0x20c772=a0_0x54083a;super({..._0x26ad37,'name':_0x20c772(0x187)}),this[_0x20c772(0x1f0)]=[],this['analysisHistory']=[],this[_0x20c772(0x358)]=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x20c772(0x2b9)]={},this[_0x20c772(0x292)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x20c772(0x1c3)]=null,this[_0x20c772(0x21f)]=null,this[_0x20c772(0x307)]=![],this[_0x20c772(0x241)]=null,this[_0x20c772(0x321)]=null,this[_0x20c772(0x355)]=SYSTEM_MODES[_0x20c772(0x1c0)],this[_0x20c772(0x1a4)]=![],this[_0x20c772(0x272)]=![],this[_0x20c772(0x282)]=_0x20c772(0x214),this[_0x20c772(0x293)]=null,this[_0x20c772(0x1be)]=null,this[_0x20c772(0x209)]=null,this['driftAnalysisTimer']=null,this[_0x20c772(0x28d)]=null,this['pythonProcess']=null,this[_0x20c772(0x1d2)]=![],this['on'](_0x20c772(0x30c),this['onReady'][_0x20c772(0x2bf)](this)),this['on'](_0x20c772(0x1ae),this[_0x20c772(0x2cd)][_0x20c772(0x2bf)](this)),this['on'](_0x20c772(0x348),this[_0x20c772(0x1f3)][_0x20c772(0x2bf)](this)),this['on'](_0x20c772(0x2c5),this['onMessage'][_0x20c772(0x2bf)](this));}async[a0_0x54083a(0x22a)](){const _0x4a71e0=a0_0x54083a;this[_0x4a71e0(0x25f)][_0x4a71e0(0x189)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x4a71e0(0x269)]+')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE'),await initZombies(this),this['config'][_0x4a71e0(0x2e5)]=this['config'][_0x4a71e0(0x2e5)]||'';try{this['isProVersion']=await checkLicense(this,this[_0x4a71e0(0x267)]['licenseKey']);}catch(_0x4ae82e){}if(!this[_0x4a71e0(0x267)][_0x4a71e0(0x2a6)]||this[_0x4a71e0(0x267)][_0x4a71e0(0x2a6)]<0.1)this[_0x4a71e0(0x267)][_0x4a71e0(0x2a6)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config'][_0x4a71e0(0x2bd)])try{this[_0x4a71e0(0x241)]=new GoogleGenerativeAI(this[_0x4a71e0(0x267)][_0x4a71e0(0x2bd)]),this[_0x4a71e0(0x321)]=this[_0x4a71e0(0x241)][_0x4a71e0(0x1ff)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x4a71e0(0x25f)]['info'](_0x4a71e0(0x256));}catch(_0x2f0434){this[_0x4a71e0(0x25f)][_0x4a71e0(0x1e5)]('Gemini\x20Init\x20Error:\x20'+_0x2f0434[_0x4a71e0(0x2c5)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x4a71e0(0x29d)](_0x4a71e0(0x290)),this[_0x4a71e0(0x29d)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates']('system.mode'),this[_0x4a71e0(0x29d)]('analysis.triggerBriefing'),this['subscribeStates'](_0x4a71e0(0x1e3)),this['subscribeStates'](_0x4a71e0(0x1fb)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0x4a71e0(0x293)]);const _0x81d49f=this[_0x4a71e0(0x267)]['analysisInterval']||0xf;_0x81d49f>0x0&&(this[_0x4a71e0(0x25f)]['info'](_0x4a71e0(0x1fe)+_0x81d49f+'\x20min).'),this[_0x4a71e0(0x293)]=setInterval(()=>{runAutopilot(this);},_0x81d49f*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x57367b=_0x4a71e0;this[_0x57367b(0x252)]&&runPythonHealthCheck(this);},0x1388);}['onUnload'](_0x49d5bc){const _0x1b62d3=a0_0x54083a;if(this[_0x1b62d3(0x293)])clearInterval(this['analysisTimer']);if(this[_0x1b62d3(0x22d)])clearInterval(this[_0x1b62d3(0x22d)]);if(this['ltmJob'])this[_0x1b62d3(0x1be)][_0x1b62d3(0x1e9)]();if(this['modeResetJob'])this[_0x1b62d3(0x209)]['cancel']();if(this[_0x1b62d3(0x28d)])this[_0x1b62d3(0x28d)][_0x1b62d3(0x1e9)]();if(this['exitTimer'])clearTimeout(this[_0x1b62d3(0x1c3)]);if(this[_0x1b62d3(0x21f)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x49d5bc();}async[a0_0x54083a(0x2cd)](_0x337835,_0x214bbe){const _0x88cebb=a0_0x54083a;if(!_0x214bbe)return;if(_0x337835[_0x88cebb(0x2f4)]('telegram')&&_0x337835[_0x88cebb(0x2db)](_0x88cebb(0x1b2))&&_0x214bbe[_0x88cebb(0x1e7)]){await handleTelegramResponse(this,_0x214bbe[_0x88cebb(0x1e7)]);return;}if(_0x337835===this[_0x88cebb(0x264)]+'.'+SYSTEM_DP_MODE){_0x214bbe[_0x88cebb(0x1e7)]&&Object[_0x88cebb(0x239)](SYSTEM_MODES)[_0x88cebb(0x2f4)](_0x214bbe[_0x88cebb(0x1e7)])&&(this[_0x88cebb(0x355)]=_0x214bbe[_0x88cebb(0x1e7)],_0x214bbe[_0x88cebb(0x1e7)]===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x214bbe[_0x88cebb(0x1b6)])this['setState'](_0x337835,{'val':this[_0x88cebb(0x355)],'ack':!![]});return;}if(!_0x214bbe[_0x88cebb(0x1b6)]){_0x337835['includes'](_0x88cebb(0x290))&&_0x214bbe['val']&&(this[_0x88cebb(0x1bd)](_0x337835,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x337835[_0x88cebb(0x2f4)](_0x88cebb(0x291))&&_0x214bbe[_0x88cebb(0x1e7)]){this[_0x88cebb(0x1bd)](_0x337835,{'val':![],'ack':!![]});if(this[_0x88cebb(0x1a4)])createDailyDigest(this);}_0x337835[_0x88cebb(0x2f4)](_0x88cebb(0x23d))&&_0x214bbe[_0x88cebb(0x1e7)]&&(this[_0x88cebb(0x1bd)](_0x337835,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x337835['includes'](_0x88cebb(0x2aa))&&_0x214bbe[_0x88cebb(0x1e7)]&&(this[_0x88cebb(0x1bd)](_0x337835,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this['config'][_0x88cebb(0x2de)]&&this['config'][_0x88cebb(0x2de)][_0x88cebb(0x2f4)](_0x337835)){await checkWifiPresence(this);return;}const _0x1bf02a=(this[_0x88cebb(0x267)][_0x88cebb(0x1cd)]||[])[_0x88cebb(0x1cf)](_0x18b7e7=>_0x18b7e7['id']===_0x337835);if(_0x1bf02a)processSensorEvent(this,_0x337835,_0x214bbe,_0x1bf02a);}async[a0_0x54083a(0x328)](_0x41e019){const _0x1402e8=a0_0x54083a;if(typeof _0x41e019===_0x1402e8(0x226)&&_0x41e019['message'])try{if(_0x41e019[_0x1402e8(0x20e)]===_0x1402e8(0x301)){}else{if(_0x41e019['command']===_0x1402e8(0x318)){}else{if(_0x41e019['command']===_0x1402e8(0x30f)){if(!this[_0x1402e8(0x1a4)])return this['sendTo'](_0x41e019[_0x1402e8(0x280)],_0x41e019['command'],{'success':![],'isPro':![]},_0x41e019['callback']);let _0x34ac11={'status':_0x1402e8(0x329),'details':'','lastCheck':0x0};try{_0x34ac11[_0x1402e8(0x260)]=(await this[_0x1402e8(0x1d4)](LTM_DP_DRIFT_STATUS))[_0x1402e8(0x1e7)],_0x34ac11[_0x1402e8(0x26f)]=(await this[_0x1402e8(0x1d4)](LTM_DP_DRIFT_DETAILS))['val'],_0x34ac11[_0x1402e8(0x26c)]=(await this[_0x1402e8(0x1d4)](LTM_DP_DRIFT_LAST_CHECK))[_0x1402e8(0x1e7)];}catch(_0x4ae572){}const _0x1af6be=this['analysisHistory']||[];this[_0x1402e8(0x1b1)](_0x41e019['from'],_0x41e019[_0x1402e8(0x20e)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x34ac11,'analysisHistory':_0x1af6be},_0x41e019[_0x1402e8(0x1f7)]);}else{if(_0x41e019[_0x1402e8(0x20e)]===_0x1402e8(0x2a4)){const _0x28f60e=this[_0x1402e8(0x192)][_0x1402e8(0x2ba)],_0x2aad47=new Date(),_0x177d43=new Date(_0x2aad47[_0x1402e8(0x1e0)](),_0x2aad47[_0x1402e8(0x2e4)](),_0x2aad47[_0x1402e8(0x251)]())[_0x1402e8(0x349)](),_0x5a8d0e=this[_0x1402e8(0x2e0)][_0x1402e8(0x217)](_0x12db14=>new Date(_0x12db14['timestamp'])[_0x1402e8(0x349)]()>_0x177d43)[_0x1402e8(0x2ba)],_0x317802=new Array(0x18)['fill'](0x0);this[_0x1402e8(0x2e0)][_0x1402e8(0x30e)](_0x222909=>{const _0x5d5e36=_0x1402e8,_0x2454a8=new Date(_0x222909['timestamp']);if(_0x2454a8['getTime']()>_0x177d43)_0x317802[_0x2454a8[_0x5d5e36(0x1f9)]()]++;});let _0x46f88d={'status':_0x1402e8(0x329)};try{_0x46f88d[_0x1402e8(0x260)]=(await this[_0x1402e8(0x1d4)](LTM_DP_DRIFT_STATUS))[_0x1402e8(0x1e7)];}catch(_0x4a4158){}let _0x93cb76='';try{const _0x205920=await this[_0x1402e8(0x1d4)](_0x1402e8(0x1b9));_0x93cb76=_0x205920?_0x205920[_0x1402e8(0x1e7)]:'';}catch(_0x33ba22){}let _0x3548ea=null;!this[_0x1402e8(0x321)]&&(_0x3548ea=this[_0x1402e8(0x267)][_0x1402e8(0x2bd)]?_0x1402e8(0x310):_0x1402e8(0x219));let _0x3e136d={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x44c3d3=await this['getStateAsync']('analysis.automation.patternDetected'),_0x1db547=await this[_0x1402e8(0x1d4)](_0x1402e8(0x2d5)),_0x16c101=await this[_0x1402e8(0x1d4)]('analysis.automation.targetId'),_0x255b56=await this[_0x1402e8(0x1d4)]('analysis.automation.targetValue'),_0x587d12=await this['getStateAsync'](_0x1402e8(0x1fb));_0x44c3d3&&_0x44c3d3['val']&&(_0x3e136d[_0x1402e8(0x18e)]=!![],_0x3e136d[_0x1402e8(0x2da)]=_0x1db547?_0x1db547[_0x1402e8(0x1e7)]:'',_0x3e136d['targetId']=_0x16c101?_0x16c101['val']:'',_0x3e136d[_0x1402e8(0x23a)]=_0x255b56?_0x255b56[_0x1402e8(0x1e7)]:''),_0x3e136d['autoApply']=_0x587d12?!!_0x587d12[_0x1402e8(0x1e7)]:![];}catch(_0x2a7302){}this[_0x1402e8(0x1b1)](_0x41e019[_0x1402e8(0x280)],_0x41e019[_0x1402e8(0x20e)],{'success':!![],'eventHistory':this[_0x1402e8(0x1f0)][_0x1402e8(0x1cc)](0x0,0xf),'stats':{'digestCount':_0x28f60e,'eventCountToday':_0x5a8d0e,'hourlyActivity':_0x317802,'driftStatus':_0x46f88d[_0x1402e8(0x260)],'isPresent':this[_0x1402e8(0x345)],'presenceWho':_0x93cb76,'minDays':this[_0x1402e8(0x267)][_0x1402e8(0x258)]||0x7,'stbDays':this['config'][_0x1402e8(0x1e8)]||0xe,'ltbDays':this[_0x1402e8(0x267)][_0x1402e8(0x1d7)]||0x3c,'systemError':_0x3548ea},'automation':_0x3e136d},_0x41e019['callback']);}else{if(_0x41e019['command']===_0x1402e8(0x20b)){const _0xde8ffa=await this[_0x1402e8(0x215)](_0x1402e8(0x271),_0x1402e8(0x18c)),_0xd1da37=[];if(_0xde8ffa)for(const _0xb6f305 in _0xde8ffa){const _0x297e98=_0xde8ffa[_0xb6f305],_0x58e1fd=(_0x297e98['common']&&typeof _0x297e98[_0x1402e8(0x1fa)][_0x1402e8(0x2ec)]===_0x1402e8(0x226)?_0x297e98[_0x1402e8(0x1fa)][_0x1402e8(0x2ec)]['de']:_0x297e98[_0x1402e8(0x1fa)][_0x1402e8(0x2ec)])||_0x297e98[_0x1402e8(0x1fa)][_0x1402e8(0x2ec)];_0xd1da37[_0x1402e8(0x2d2)]({'id':_0xb6f305,'name':_0x58e1fd});}this[_0x1402e8(0x1b1)](_0x41e019['from'],_0x41e019[_0x1402e8(0x20e)],{'success':!![],'enums':_0xd1da37},_0x41e019[_0x1402e8(0x1f7)]);}else{if(_0x41e019['command']==='scanDevices')try{const _0x2cd9ee=await scanForDevices(this,_0x41e019[_0x1402e8(0x2c5)]||{});this[_0x1402e8(0x1b1)](_0x41e019['from'],_0x41e019['command'],{'success':!![],'devices':_0x2cd9ee},_0x41e019[_0x1402e8(0x1f7)]);}catch(_0x4986ce){this[_0x1402e8(0x1b1)](_0x41e019['from'],_0x41e019[_0x1402e8(0x20e)],{'success':![],'error':_0x4986ce['message']},_0x41e019[_0x1402e8(0x1f7)]);}else{if(_0x41e019[_0x1402e8(0x20e)]===_0x1402e8(0x188)){const _0x57e93d=_0x41e019[_0x1402e8(0x2c5)][_0x1402e8(0x2f0)];if(!_0x57e93d)return this[_0x1402e8(0x1b1)](_0x41e019['from'],_0x41e019[_0x1402e8(0x20e)],{'success':![],'error':_0x1402e8(0x1d5)},_0x41e019[_0x1402e8(0x1f7)]);const _0x53cbaf=await getCalendarNames(this,_0x57e93d);this[_0x1402e8(0x1b1)](_0x41e019['from'],_0x41e019[_0x1402e8(0x20e)],{'success':!![],'names':_0x53cbaf},_0x41e019[_0x1402e8(0x1f7)]);}else{if(_0x41e019[_0x1402e8(0x20e)]===_0x1402e8(0x351)){const {targetId:_0x122d5d,targetValue:_0x4eee6a}=_0x41e019[_0x1402e8(0x2c5)];this[_0x1402e8(0x25f)][_0x1402e8(0x189)](_0x1402e8(0x25b)+_0x122d5d+_0x1402e8(0x28e)+_0x4eee6a),await this[_0x1402e8(0x200)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x1402e8(0x200)](_0x1402e8(0x2d5),{'val':'SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20'+_0x122d5d,'ack':!![]}),await this[_0x1402e8(0x200)](_0x1402e8(0x243),{'val':_0x122d5d,'ack':!![]}),await this[_0x1402e8(0x200)](_0x1402e8(0x1bc),{'val':_0x4eee6a,'ack':!![]}),this[_0x1402e8(0x1b1)](_0x41e019[_0x1402e8(0x280)],_0x41e019[_0x1402e8(0x20e)],{'success':!![]},_0x41e019['callback']);}else{if(_0x41e019[_0x1402e8(0x20e)]==='submitFeedback'){const {historyId:_0x3dce71,rating:_0xb69bf1,comment:_0x1a9363,alertReason:_0x3640de}=_0x41e019[_0x1402e8(0x2c5)];_0x3dce71&&_0xb69bf1?(await saveFeedback(this,{'timestamp':Date[_0x1402e8(0x365)](),'historyId':_0x3dce71,'rating':_0xb69bf1,'comment':_0x1a9363,'alertReason':_0x3640de}),this[_0x1402e8(0x1b1)](_0x41e019[_0x1402e8(0x280)],_0x41e019[_0x1402e8(0x20e)],{'success':!![]},_0x41e019[_0x1402e8(0x1f7)])):this[_0x1402e8(0x1b1)](_0x41e019[_0x1402e8(0x280)],_0x41e019[_0x1402e8(0x20e)],{'success':![],'error':_0x1402e8(0x1b3)},_0x41e019[_0x1402e8(0x1f7)]);}else _0x41e019[_0x1402e8(0x20e)]===_0x1402e8(0x2ed)&&(this[_0x1402e8(0x25f)]['info'](_0x1402e8(0x231)),await this['setStateAsync']('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x1402e8(0x200)](_0x1402e8(0x2d5),{'val':'','ack':!![]}),this[_0x1402e8(0x1b1)](_0x41e019[_0x1402e8(0x280)],_0x41e019['command'],{'success':!![]},_0x41e019[_0x1402e8(0x1f7)]));}}}}}}}}}catch(_0x2e084b){this['log'][_0x1402e8(0x1e5)]('Error\x20in\x20onMessage\x20command\x20'+_0x41e019[_0x1402e8(0x20e)]+':\x20'+_0x2e084b[_0x1402e8(0x2c5)]);if(_0x41e019[_0x1402e8(0x1f7)])this[_0x1402e8(0x1b1)](_0x41e019[_0x1402e8(0x280)],_0x41e019[_0x1402e8(0x20e)],{'success':![],'error':_0x2e084b['message']},_0x41e019['callback']);}}}if(require['main']!==module)module['exports']=_0x369f9f=>new CogniLiving(_0x369f9f);else new CogniLiving();