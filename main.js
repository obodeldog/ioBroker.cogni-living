const a0_0x1495bb=a0_0x582d;(function(_0x12013c,_0x3c69ef){const _0x29e182=a0_0x582d,_0x17e459=_0x12013c();while(!![]){try{const _0x4bddeb=parseInt(_0x29e182(0x125))/0x1+parseInt(_0x29e182(0x26b))/0x2*(parseInt(_0x29e182(0x19e))/0x3)+parseInt(_0x29e182(0x2b1))/0x4+-parseInt(_0x29e182(0x2e8))/0x5*(parseInt(_0x29e182(0x15f))/0x6)+-parseInt(_0x29e182(0x21d))/0x7*(parseInt(_0x29e182(0x331))/0x8)+-parseInt(_0x29e182(0x1ca))/0x9+parseInt(_0x29e182(0x266))/0xa*(-parseInt(_0x29e182(0x2bd))/0xb);if(_0x4bddeb===_0x3c69ef)break;else _0x17e459['push'](_0x17e459['shift']());}catch(_0x4535b2){_0x17e459['push'](_0x17e459['shift']());}}}(a0_0x3878,0xd4802));const a0_0x2b05ba=(function(){let _0x2eed38=!![];return function(_0x3e8245,_0x19d1d8){const _0x5bd1a7=_0x2eed38?function(){const _0x3d34fc=a0_0x582d;if(_0x19d1d8){const _0x41e394=_0x19d1d8[_0x3d34fc(0x291)](_0x3e8245,arguments);return _0x19d1d8=null,_0x41e394;}}:function(){};return _0x2eed38=![],_0x5bd1a7;};}()),a0_0x4ff467=a0_0x2b05ba(this,function(){const _0x4d8515=a0_0x582d;return a0_0x4ff467[_0x4d8515(0x2f6)]()[_0x4d8515(0x1e5)]('(((.+)+)+)+$')[_0x4d8515(0x2f6)]()['constructor'](a0_0x4ff467)[_0x4d8515(0x1e5)](_0x4d8515(0x2a5));});a0_0x4ff467();function a0_0x582d(_0x13d217,_0x3207c0){const _0x38cb6f=a0_0x3878();return a0_0x582d=function(_0x4ff467,_0x2b05ba){_0x4ff467=_0x4ff467-0x124;let _0x387887=_0x38cb6f[_0x4ff467];return _0x387887;},a0_0x582d(_0x13d217,_0x3207c0);}'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x1495bb(0x256)),schedule=require(a0_0x1495bb(0x25c)),{spawn,exec}=require('child_process'),path=require('path'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x1495bb(0x1aa),MODE_RESET_SCHEDULE=a0_0x1495bb(0x338),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x1495bb(0x1cd),LTM_DP_DAILY_DIGESTS=a0_0x1495bb(0x2d7),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x1495bb(0x1be),LTM_DP_DRIFT_CHANNEL=a0_0x1495bb(0x2b9),LTM_DP_DRIFT_STATUS=a0_0x1495bb(0x20c),LTM_DP_DRIFT_DETAILS=a0_0x1495bb(0x2db),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x1495bb(0x2df),HARD_IGNORE_TERMS=[a0_0x1495bb(0x230),'scriptEnabled',a0_0x1495bb(0x2bc),'unreach',a0_0x1495bb(0x261),'rssi',a0_0x1495bb(0x143),'maintenance',a0_0x1495bb(0x32f),a0_0x1495bb(0x288),a0_0x1495bb(0x321),a0_0x1495bb(0x1b6),a0_0x1495bb(0x27d),a0_0x1495bb(0x21f),'dutycycle',a0_0x1495bb(0x182),a0_0x1495bb(0x29e),'link_quality'],BAD_NAMES=['targetposition',a0_0x1495bb(0x32c),'state',a0_0x1495bb(0x285),a0_0x1495bb(0x14e),a0_0x1495bb(0x265),'on',a0_0x1495bb(0x149),a0_0x1495bb(0x201),a0_0x1495bb(0x140),a0_0x1495bb(0x239),'blind',a0_0x1495bb(0x2ce),'status',a0_0x1495bb(0x2a0),a0_0x1495bb(0x1f2),'occupancy','temperature',a0_0x1495bb(0x24f),a0_0x1495bb(0x22c),'energy',a0_0x1495bb(0x2fa),'valve',a0_0x1495bb(0x30b),a0_0x1495bb(0x1ff)],ADAPTER_BLACKLIST=['system.',a0_0x1495bb(0x228),'info.',a0_0x1495bb(0x151),a0_0x1495bb(0x195),a0_0x1495bb(0x131),a0_0x1495bb(0x2ab),a0_0x1495bb(0x329),a0_0x1495bb(0x220),a0_0x1495bb(0x1c4),'simple-api.'],SYSTEM_MODES={'NORMAL':a0_0x1495bb(0x163),'VACATION':'vacation','PARTY':a0_0x1495bb(0x2e0),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x1495bb(0x28d)],SYSTEM_MODES[a0_0x1495bb(0x2a3)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x1495bb(0x16b),'family':a0_0x1495bb(0x280),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x1495bb(0x244)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x28751c){const _0x590e4f=a0_0x1495bb;try{const _0x5d2480=[_0x590e4f(0x259),'events.history_debug_00'];for(const _0x2f0fb4 of _0x5d2480){try{const _0x3504c3=await _0x28751c[_0x590e4f(0x32b)](_0x2f0fb4);_0x3504c3&&await _0x28751c[_0x590e4f(0x225)](_0x2f0fb4);}catch(_0x22e3b4){}}}catch(_0x3e4a31){}}async function initHistory(_0x49b1df){const _0x3c8b82=a0_0x1495bb;try{const _0x479904=await _0x49b1df['getStateAsync'](_0x3c8b82(0x29c));_0x479904&&_0x479904[_0x3c8b82(0x298)]&&(_0x49b1df[_0x3c8b82(0x14b)]=JSON[_0x3c8b82(0x2c4)](_0x479904[_0x3c8b82(0x298)][_0x3c8b82(0x2f6)]()));}catch(_0x2ef054){_0x49b1df[_0x3c8b82(0x14b)]=[];}try{const _0x407d99=await _0x49b1df[_0x3c8b82(0x1a0)](_0x3c8b82(0x29f));if(_0x407d99&&_0x407d99[_0x3c8b82(0x298)])_0x49b1df[_0x3c8b82(0x132)]=JSON[_0x3c8b82(0x2c4)](_0x407d99[_0x3c8b82(0x298)][_0x3c8b82(0x2f6)]());}catch(_0x5579f7){_0x49b1df['analysisHistory']=[];}if(_0x49b1df['eventHistory']&&_0x49b1df['eventHistory'][_0x3c8b82(0x1c6)]>0x0){_0x49b1df['log']['info'](_0x3c8b82(0x2cc)+_0x49b1df[_0x3c8b82(0x14b)][_0x3c8b82(0x1c6)]+_0x3c8b82(0x18c));for(let _0x302335=_0x49b1df[_0x3c8b82(0x14b)][_0x3c8b82(0x1c6)]-0x1;_0x302335>=0x0;_0x302335--){const _0x161295=_0x49b1df[_0x3c8b82(0x14b)][_0x302335];_0x161295&&_0x161295['id']!==undefined&&_0x161295[_0x3c8b82(0x14e)]!==undefined&&(_0x49b1df['sensorLastValues'][_0x161295['id']]=_0x161295[_0x3c8b82(0x14e)]);}}}async function initSystemConfig(_0x5818cb){const _0x1188af=a0_0x1495bb;try{const _0x51b95d=await _0x5818cb['getForeignObjectAsync'](_0x1188af(0x18a));_0x51b95d&&_0x51b95d[_0x1188af(0x303)]&&(_0x5818cb[_0x1188af(0x1f9)]={'latitude':_0x51b95d[_0x1188af(0x303)][_0x1188af(0x2e5)]||0x0,'longitude':_0x51b95d['common'][_0x1188af(0x1a4)]||0x0,'city':_0x51b95d[_0x1188af(0x303)]['city']||''});}catch(_0x1c06b1){}}async function checkLicense(_0xa3542c,_0x5a1329){const _0x5221a0=a0_0x1495bb;if(!_0x5a1329)return![];_0xa3542c['systemUUID']=await getSystemUUID(_0xa3542c);if(_0x5a1329===_0x5221a0(0x185)||_0x5a1329[_0x5221a0(0x311)](_0x5221a0(0x170)))return!![];return![];}async function getSystemUUID(_0x45991e){const _0x9dd794=a0_0x1495bb;try{const _0x289c59=await _0x45991e[_0x9dd794(0x1ae)]('system.meta.uuid');if(_0x289c59&&_0x289c59['native']&&_0x289c59[_0x9dd794(0x126)][_0x9dd794(0x175)])return _0x289c59['native'][_0x9dd794(0x175)];return _0x9dd794(0x199);}catch(_0x4e683e){return _0x9dd794(0x165);}}async function createAllObjects(_0x1b1bd2){const _0x2eda43=a0_0x1495bb;await checkSystemObjects(_0x1b1bd2),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x2d3),{'type':'state','common':{'name':'Who\x20is\x20present?','type':'string','role':_0x2eda43(0x24e),'read':!![],'write':![],'def':''},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)]('events.lastEvent',{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x28f),'type':_0x2eda43(0x166),'role':'json','read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x29c),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x2c2),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)]('analysis.trigger',{'type':'state','common':{'name':_0x2eda43(0x1ad),'type':'boolean','role':_0x2eda43(0x15b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x269),{'type':_0x2eda43(0x242),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x2eda43(0x160),'role':_0x2eda43(0x15b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x2ca)](_0x2eda43(0x1ab),{'type':_0x2eda43(0x23a),'common':{'name':'AI\x20Training\x20Control'},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x1a6),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x1a9),'type':_0x2eda43(0x160),'role':_0x2eda43(0x15b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b1bd2['setObjectNotExistsAsync'](_0x2eda43(0x1de),{'type':'state','common':{'name':_0x2eda43(0x190),'type':_0x2eda43(0x166),'role':_0x2eda43(0x24e),'read':!![],'write':![],'def':_0x2eda43(0x15a)},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x25d),{'type':'state','common':{'name':'Last\x20Result','type':'string','role':_0x2eda43(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)]('analysis.isAlert',{'type':_0x2eda43(0x242),'common':{'name':'AI\x20Alert\x20Status','type':_0x2eda43(0x160),'role':_0x2eda43(0x339),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x1bc),{'type':'state','common':{'name':'AI\x20Emergency\x20Status','type':_0x2eda43(0x160),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x1b1bd2['setObjectNotExistsAsync']('analysis.alertReason',{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x2d5),'type':_0x2eda43(0x166),'role':_0x2eda43(0x305),'read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x1d0),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x318),'type':_0x2eda43(0x166),'role':_0x2eda43(0x24e),'read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x218),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x2a2),'type':_0x2eda43(0x166),'role':'state','read':!![],'write':![],'def':_0x2eda43(0x268)},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x279),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x23e),'type':_0x2eda43(0x166),'role':_0x2eda43(0x24e),'read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x2c5),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x1f0),'type':_0x2eda43(0x166),'role':_0x2eda43(0x24e),'read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x2ca)](_0x2eda43(0x2fe),{'type':_0x2eda43(0x23a),'common':{'name':_0x2eda43(0x129)},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x2a1),{'type':'state','common':{'name':'Pattern\x20Detected','type':_0x2eda43(0x160),'role':_0x2eda43(0x1b5),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x297),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x1d4),'type':_0x2eda43(0x166),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x1e6),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x2ed),'type':_0x2eda43(0x166),'role':_0x2eda43(0x24e),'read':!![],'write':![]},'native':{}}),await _0x1b1bd2['setObjectNotExistsAsync'](_0x2eda43(0x202),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x1dc),'type':_0x2eda43(0x166),'role':_0x2eda43(0x24e),'read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)]('analysis.automation.targetValue',{'type':_0x2eda43(0x242),'common':{'name':'Target\x20Value','type':_0x2eda43(0x166),'role':_0x2eda43(0x24e),'read':!![],'write':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)]('analysis.automation.autoApply',{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x2c1),'type':_0x2eda43(0x160),'role':_0x2eda43(0x201),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)]('analysis.automation.triggerAction',{'type':'state','common':{'name':_0x2eda43(0x272),'type':_0x2eda43(0x160),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x29f),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x2e4),'type':_0x2eda43(0x166),'role':_0x2eda43(0x2d8),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1b1bd2['setObjectNotExistsAsync']('analysis.feedbackHistory',{'type':'state','common':{'name':_0x2eda43(0x21e),'type':_0x2eda43(0x166),'role':_0x2eda43(0x2d8),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1b1bd2[_0x2eda43(0x2ca)](_0x2eda43(0x319),{'type':'channel','common':{'name':_0x2eda43(0x1ac)},'native':{}}),await _0x1b1bd2['setObjectNotExistsAsync'](_0x2eda43(0x176),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x17f),'type':_0x2eda43(0x19f),'role':_0x2eda43(0x1a5),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x316),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x18f),'type':_0x2eda43(0x166),'role':'text','read':!![],'write':![],'def':_0x2eda43(0x2e6)},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x336),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x2ee),'type':_0x2eda43(0x166),'role':_0x2eda43(0x24e),'read':!![],'write':![],'def':''},'native':{}}),await _0x1b1bd2['setObjectNotExistsAsync']('analysis.health.trendDiagnosis',{'type':_0x2eda43(0x242),'common':{'name':'Trend\x20Diagnosis\x20(Python)','type':'string','role':_0x2eda43(0x24e),'read':!![],'write':![],'def':_0x2eda43(0x268)},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x273),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x16e),'type':_0x2eda43(0x19f),'role':_0x2eda43(0x14e),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x1b1bd2[_0x2eda43(0x2ca)](_0x2eda43(0x264),{'type':'channel','common':{'name':_0x2eda43(0x16f)},'native':{}}),await _0x1b1bd2['setObjectNotExistsAsync'](_0x2eda43(0x1f5),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x257),'type':_0x2eda43(0x166),'role':_0x2eda43(0x2d8),'read':!![],'write':![],'def':'[]','desc':_0x2eda43(0x238)},'native':{}}),await _0x1b1bd2[_0x2eda43(0x22f)](_0x2eda43(0x31a),{'type':_0x2eda43(0x242),'common':{'name':_0x2eda43(0x212),'type':_0x2eda43(0x166),'role':_0x2eda43(0x2d8),'read':!![],'write':![],'def':'[]','desc':'Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time'},'native':{}}),await checkLtmObjects(_0x1b1bd2),await checkLtmDriftObjects(_0x1b1bd2);}async function checkSystemObjects(_0x514718){const _0x23f4b0=a0_0x1495bb;await _0x514718[_0x23f4b0(0x2ca)](_0x23f4b0(0x139),{'type':_0x23f4b0(0x23a),'common':{'name':_0x23f4b0(0x2f9)},'native':{}}),await _0x514718[_0x23f4b0(0x2ca)](SYSTEM_DP_MODE,{'type':_0x23f4b0(0x242),'common':{'name':_0x23f4b0(0x15d),'type':_0x23f4b0(0x166),'role':_0x23f4b0(0x242),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES['NORMAL']]:_0x23f4b0(0x1a2),[SYSTEM_MODES[_0x23f4b0(0x171)]]:_0x23f4b0(0x229),[SYSTEM_MODES[_0x23f4b0(0x28d)]]:'Party',[SYSTEM_MODES[_0x23f4b0(0x2a3)]]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x4e41c4){const _0x4715d0=a0_0x1495bb;await _0x4e41c4[_0x4715d0(0x2ca)](_0x4715d0(0x25b),{'type':_0x4715d0(0x23a),'common':{'name':_0x4715d0(0x25b)},'native':{}}),await _0x4e41c4[_0x4715d0(0x2ca)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x4715d0(0x2fd),'type':_0x4715d0(0x166),'role':_0x4715d0(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x4e41c4[_0x4715d0(0x2ca)](LTM_DP_DAILY_DIGESTS,{'type':_0x4715d0(0x242),'common':{'name':_0x4715d0(0x2c9),'type':_0x4715d0(0x166),'role':'json','read':!![],'write':![]},'native':{}}),await _0x4e41c4['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x4715d0(0x242),'common':{'name':'Processing\x20Status','type':_0x4715d0(0x166),'role':_0x4715d0(0x24e),'read':!![],'write':![]},'native':{}}),await _0x4e41c4[_0x4715d0(0x2ca)](LTM_DP_TRIGGER_DIGEST,{'type':_0x4715d0(0x242),'common':{'name':_0x4715d0(0x247),'type':_0x4715d0(0x160),'role':_0x4715d0(0x15b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4e41c4[_0x4715d0(0x2ca)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':_0x4715d0(0x1f1),'type':_0x4715d0(0x166),'role':_0x4715d0(0x24e),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x58c893){const _0x53a83a=a0_0x1495bb;await _0x58c893[_0x53a83a(0x2ca)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x53a83a(0x2b7)},'native':{}}),await _0x58c893[_0x53a83a(0x2ca)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x53a83a(0x207),'type':'string','role':_0x53a83a(0x242),'read':!![],'write':![],'def':_0x53a83a(0x268)},'native':{}}),await _0x58c893[_0x53a83a(0x2ca)](LTM_DP_DRIFT_DETAILS,{'type':_0x53a83a(0x242),'common':{'name':_0x53a83a(0x205),'type':'string','role':_0x53a83a(0x24e),'read':!![],'write':![]},'native':{}}),await _0x58c893[_0x53a83a(0x2ca)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x53a83a(0x242),'common':{'name':'Last\x20Check','type':'number','role':_0x53a83a(0x258),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x516d8b){const _0x56c723=a0_0x1495bb;try{const _0x5edbaf=await _0x516d8b[_0x56c723(0x1a0)](SYSTEM_DP_MODE);_0x5edbaf&&_0x5edbaf['val']&&Object[_0x56c723(0x313)](SYSTEM_MODES)[_0x56c723(0x1bd)](_0x5edbaf['val'])?_0x516d8b['currentSystemMode']=_0x5edbaf[_0x56c723(0x298)]:(_0x516d8b['currentSystemMode']=SYSTEM_MODES[_0x56c723(0x1cf)],await _0x516d8b['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x56c723(0x1cf)],'ack':!![]}));}catch(_0x1c56b3){_0x516d8b[_0x56c723(0x20e)]=SYSTEM_MODES[_0x56c723(0x1cf)];}}async function loadRawEventLog(_0x256a76){const _0x1213d6=a0_0x1495bb;try{const _0x1344a4=await _0x256a76[_0x1213d6(0x1a0)](LTM_DP_RAW_LOG);if(_0x1344a4&&_0x1344a4['val'])_0x256a76['rawEventLog']=JSON[_0x1213d6(0x2c4)](_0x1344a4[_0x1213d6(0x298)]);}catch(_0x3f34ee){_0x256a76[_0x1213d6(0x18d)]=[];}}async function saveRawEventLog(_0x42c5af){const _0x5999d1=a0_0x1495bb;_0x42c5af[_0x5999d1(0x18d)][_0x5999d1(0x1c6)]>RAW_LOG_MAX_SIZE&&_0x42c5af['rawEventLog'][_0x5999d1(0x28e)](0x0,_0x42c5af[_0x5999d1(0x18d)][_0x5999d1(0x1c6)]-RAW_LOG_MAX_SIZE),await _0x42c5af[_0x5999d1(0x1b2)](LTM_DP_RAW_LOG,{'val':JSON[_0x5999d1(0x30e)](_0x42c5af['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x1f4a41){const _0x18b321=a0_0x1495bb;try{const _0x15bbad=await _0x1f4a41['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x15bbad&&_0x15bbad['val'])_0x1f4a41[_0x18b321(0x1b1)]=JSON[_0x18b321(0x2c4)](_0x15bbad[_0x18b321(0x298)]);}catch(_0x158fa6){_0x1f4a41['dailyDigests']=[];}await updateBaselineStatus(_0x1f4a41);}async function saveDailyDigests(_0x1ff8a8,_0x403c87=!![]){const _0x27f63b=a0_0x1495bb,_0x38fe35=_0x1ff8a8[_0x27f63b(0x2fb)]['ltmLtbWindowDays']||0x3c;_0x1ff8a8[_0x27f63b(0x1b1)][_0x27f63b(0x1c6)]>_0x38fe35&&_0x1ff8a8['dailyDigests'][_0x27f63b(0x28e)](0x0,_0x1ff8a8['dailyDigests']['length']-_0x38fe35);await _0x1ff8a8[_0x27f63b(0x1b2)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x27f63b(0x30e)](_0x1ff8a8[_0x27f63b(0x1b1)]),'ack':!![]});if(_0x403c87)await updateBaselineStatus(_0x1ff8a8);}async function updateAnalysisHistory(_0xd1d687,_0x5f0f2f){const _0x10680b=a0_0x1495bb;_0xd1d687[_0x10680b(0x132)][_0x10680b(0x29b)](_0x5f0f2f);if(_0xd1d687[_0x10680b(0x132)][_0x10680b(0x1c6)]>ANALYSIS_HISTORY_MAX_SIZE)_0xd1d687['analysisHistory'][_0x10680b(0x270)]();await _0xd1d687[_0x10680b(0x1b2)]('analysis.analysisHistory',{'val':JSON[_0x10680b(0x30e)](_0xd1d687[_0x10680b(0x132)]),'ack':!![]});}async function updateBaselineStatus(_0x27ab27){const _0x21d0c6=a0_0x1495bb;if(!_0x27ab27[_0x21d0c6(0x1fe)]){await _0x27ab27[_0x21d0c6(0x1b2)](LTM_DP_BASELINE_STATUS,{'val':_0x21d0c6(0x12d),'ack':!![]});return;}const _0x2ac9ed=_0x27ab27['dailyDigests'][_0x21d0c6(0x1c6)]>=(_0x27ab27[_0x21d0c6(0x2fb)][_0x21d0c6(0x1fd)]||0x7)?_0x21d0c6(0x1e0)+_0x27ab27[_0x21d0c6(0x1b1)][_0x21d0c6(0x1c6)]+_0x21d0c6(0x1d2):_0x21d0c6(0x312)+_0x27ab27['dailyDigests']['length']+'/'+(_0x27ab27[_0x21d0c6(0x2fb)][_0x21d0c6(0x1fd)]||0x7)+')';await _0x27ab27['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x2ac9ed,'ack':!![]});}async function initSensorSubscriptions(_0x218ac3){const _0x15be4e=a0_0x1495bb,_0x27c805=_0x218ac3[_0x15be4e(0x2fb)][_0x15be4e(0x133)];if(_0x27c805&&_0x27c805[_0x15be4e(0x1c6)]>0x0){_0x218ac3[_0x15be4e(0x144)][_0x15be4e(0x12a)](_0x15be4e(0x12e)+_0x27c805[_0x15be4e(0x1c6)]+'\x20sensors...');for(const _0x47b33d of _0x27c805){if(_0x47b33d['id']){await _0x218ac3[_0x15be4e(0x17b)](_0x47b33d['id']);try{const _0x510f00=await _0x218ac3['getForeignStateAsync'](_0x47b33d['id']);if(_0x510f00)_0x218ac3[_0x15be4e(0x282)][_0x47b33d['id']]=_0x510f00['val'];}catch(_0x2c1a10){}}}}}async function initPresenceSubscriptions(_0x3b6da4){const _0x55ef21=a0_0x1495bb,_0x3b4afb=_0x3b6da4[_0x55ef21(0x2fb)][_0x55ef21(0x198)]||[];if(_0x3b4afb[_0x55ef21(0x1c6)]>0x0){_0x3b6da4['log'][_0x55ef21(0x12a)](_0x55ef21(0x12e)+_0x3b4afb[_0x55ef21(0x1c6)]+_0x55ef21(0x13e));for(const _0x59551f of _0x3b4afb){await _0x3b6da4['subscribeForeignStatesAsync'](_0x59551f);}try{await checkWifiPresence(_0x3b6da4);}catch(_0x4012fc){}}}async function getWeatherContext(_0x4c2884){const _0x44b9e1=a0_0x1495bb;try{if(!_0x4c2884[_0x44b9e1(0x2fb)][_0x44b9e1(0x2c3)])return _0x44b9e1(0x1a7);let _0x115d12='';const _0x276b57=_0x4c2884[_0x44b9e1(0x2fb)][_0x44b9e1(0x136)];if(_0x276b57)try{if(_0x276b57[_0x44b9e1(0x1bd)](_0x44b9e1(0x213))){const _0x47b1ac=await _0x4c2884[_0x44b9e1(0x2ec)](_0x276b57+_0x44b9e1(0x1b7));if(_0x47b1ac&&_0x47b1ac[_0x44b9e1(0x298)])_0x115d12=_0x47b1ac[_0x44b9e1(0x298)];}else{if(_0x276b57[_0x44b9e1(0x1bd)](_0x44b9e1(0x1ce))){const _0x1509aa=await _0x4c2884[_0x44b9e1(0x2ec)](_0x276b57+_0x44b9e1(0x15e));if(_0x1509aa&&_0x1509aa[_0x44b9e1(0x298)])_0x115d12=_0x1509aa[_0x44b9e1(0x298)];}else{if(_0x276b57[_0x44b9e1(0x1bd)](_0x44b9e1(0x2cd))){const _0x5bc7ea=await _0x4c2884['getForeignStateAsync'](_0x276b57+'.forecast.current.state');if(_0x5bc7ea&&_0x5bc7ea['val'])_0x115d12=_0x5bc7ea['val'];}}}}catch(_0x334ef0){}if(!_0x115d12){const _0x2daa7d=['accuweather.0',_0x44b9e1(0x1bf),_0x44b9e1(0x19a),_0x44b9e1(0x20b)];for(const _0x59b51d of _0x2daa7d){try{const _0x1f7127=await _0x4c2884[_0x44b9e1(0x1ae)](_0x59b51d);if(_0x1f7127){if(_0x59b51d[_0x44b9e1(0x1bd)](_0x44b9e1(0x213))){const _0x10d905=await _0x4c2884[_0x44b9e1(0x2ec)](_0x59b51d+'.Summary.Current');if(_0x10d905&&_0x10d905[_0x44b9e1(0x298)]){_0x115d12=_0x10d905[_0x44b9e1(0x298)];break;}}}}catch(_0x221a29){}}}return _0x115d12?_0x44b9e1(0x20f)+_0x115d12:_0x44b9e1(0x1f8);}catch(_0x1a48a0){return _0x44b9e1(0x1e8)+_0x1a48a0['message'];}}async function getCalendarContext(_0x4052a7){const _0x536e11=a0_0x1495bb;try{if(!_0x4052a7[_0x536e11(0x2fb)]['useCalendar'])return _0x536e11(0x25a);let _0x5685fa=_0x4052a7[_0x536e11(0x2fb)][_0x536e11(0x1cc)]||_0x536e11(0x27f),_0x5bf773=_0x4052a7[_0x536e11(0x2fb)]['calendarSelection']||[];if(typeof _0x5bf773==='string')_0x5bf773=_0x5bf773[_0x536e11(0x1e4)](',');try{const _0x5e56ba=await _0x4052a7[_0x536e11(0x2ec)](_0x5685fa+_0x536e11(0x156));if(_0x5e56ba&&_0x5e56ba['val']){let _0x11714a=tryParse(_0x5e56ba[_0x536e11(0x298)]);if(_0x11714a&&Array['isArray'](_0x11714a)){if(_0x5bf773[_0x536e11(0x1c6)]>0x0)_0x11714a=_0x11714a[_0x536e11(0x1ba)](_0x3a3c39=>_0x5bf773[_0x536e11(0x1bd)](_0x3a3c39[_0x536e11(0x227)]||''));else return _0x536e11(0x278);if(_0x11714a[_0x536e11(0x1c6)]>0x0){const _0xb1f173=_0x11714a[_0x536e11(0x138)](0x0,0x3)[_0x536e11(0x15c)](_0x59ae08=>{const _0x3f949d=_0x536e11;let _0xedee20=_0x59ae08[_0x3f949d(0x258)];if(_0x59ae08[_0x3f949d(0x251)])_0xedee20+='\x20'+_0x59ae08[_0x3f949d(0x251)];return _0xedee20+':\x20'+_0x59ae08[_0x3f949d(0x29d)]+'\x20('+_0x59ae08[_0x3f949d(0x227)]+')';});return'KALENDER:\x20'+_0xb1f173['join'](_0x536e11(0x2b8));}else return _0x536e11(0x2b3);}}}catch(_0x4c6186){_0x4052a7[_0x536e11(0x144)][_0x536e11(0x322)](_0x536e11(0x1b3)+_0x4c6186['message']);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x7e0c37){return _0x536e11(0x1e3)+_0x7e0c37[_0x536e11(0x33a)];}}async function getCalendarNames(_0x479533,_0xb6df83){const _0x5a0318=a0_0x1495bb;try{const _0x67aee1=await _0x479533[_0x5a0318(0x2ec)](_0xb6df83+'.data.table');if(_0x67aee1&&_0x67aee1[_0x5a0318(0x298)]){const _0x4be515=tryParse(_0x67aee1[_0x5a0318(0x298)]);if(_0x4be515&&Array[_0x5a0318(0x137)](_0x4be515)){const _0x2f16e1=[...new Set(_0x4be515[_0x5a0318(0x15c)](_0x5cb1c2=>_0x5cb1c2['_calName'])[_0x5a0318(0x1ba)](Boolean))];return _0x2f16e1['sort']();}}return[];}catch(_0x3167a3){return _0x479533[_0x5a0318(0x144)][_0x5a0318(0x32f)](_0x5a0318(0x18b)+_0x3167a3[_0x5a0318(0x33a)]),[];}}async function checkWifiPresence(_0x449435){const _0x4ca752=a0_0x1495bb;try{const _0x3960f5=_0x449435[_0x4ca752(0x2fb)]['presenceDevices']||[];let _0x39993f=![];const _0x44b6cd=[];for(const _0x3f80ca of _0x3960f5){try{const _0x302534=await _0x449435['getForeignStateAsync'](_0x3f80ca);if(_0x302534&&(_0x302534[_0x4ca752(0x298)]===!![]||_0x302534['val']===_0x4ca752(0x24d)||_0x302534['val']===0x1)){_0x39993f=!![];const _0x1c5f05=await _0x449435[_0x4ca752(0x1ae)](_0x3f80ca);let _0x1fd102=_0x3f80ca;_0x1c5f05&&_0x1c5f05[_0x4ca752(0x303)]&&_0x1c5f05[_0x4ca752(0x303)][_0x4ca752(0x23c)]&&(_0x1fd102=typeof _0x1c5f05[_0x4ca752(0x303)][_0x4ca752(0x23c)]===_0x4ca752(0x19d)?_0x1c5f05[_0x4ca752(0x303)][_0x4ca752(0x23c)]['de']||_0x1c5f05[_0x4ca752(0x303)][_0x4ca752(0x23c)]['en']:_0x1c5f05[_0x4ca752(0x303)][_0x4ca752(0x23c)]),_0x44b6cd[_0x4ca752(0x2d9)](_0x1fd102);}}catch(_0x288708){}}return await _0x449435[_0x4ca752(0x1b2)](_0x4ca752(0x2d3),{'val':_0x44b6cd[_0x4ca752(0x306)](',\x20'),'ack':!![]}),_0x39993f&&(_0x449435[_0x4ca752(0x13c)]&&(_0x449435[_0x4ca752(0x144)][_0x4ca752(0x12a)]('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),abortExitTimer(_0x449435)),!_0x449435[_0x4ca752(0x164)]&&_0x449435['currentSystemMode']===SYSTEM_MODES[_0x4ca752(0x1cf)]&&await setPresence(_0x449435,!![])),_0x39993f;}catch(_0x35f1b9){return _0x449435[_0x4ca752(0x144)]['error'](_0x4ca752(0x30c)+_0x35f1b9[_0x4ca752(0x33a)]),![];}}function startExitTimer(_0x513d28){const _0x15981c=a0_0x1495bb;abortExitTimer(_0x513d28),_0x513d28[_0x15981c(0x216)]=!![],_0x513d28[_0x15981c(0x25e)]=setTimeout(()=>{const _0x10f515=_0x15981c;_0x513d28[_0x10f515(0x216)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x513d28[_0x15981c(0x13c)]=setTimeout(()=>{const _0x266dcd=_0x15981c;setPresence(_0x513d28,![]),_0x513d28[_0x266dcd(0x13c)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x394200){const _0xa187c0=a0_0x1495bb;if(_0x394200[_0xa187c0(0x13c)])clearTimeout(_0x394200[_0xa187c0(0x13c)]);if(_0x394200['exitGraceTimer'])clearTimeout(_0x394200[_0xa187c0(0x25e)]);_0x394200[_0xa187c0(0x13c)]=null,_0x394200['exitGraceTimer']=null,_0x394200[_0xa187c0(0x216)]=![];}async function setPresence(_0x4a14d6,_0x31d6aa){const _0x160346=a0_0x1495bb;if(_0x4a14d6[_0x160346(0x164)]===_0x31d6aa)return;_0x4a14d6['isPresent']=_0x31d6aa,await _0x4a14d6[_0x160346(0x1b2)](_0x160346(0x124),{'val':_0x31d6aa,'ack':!![]});}async function saveFeedback(_0x55ab9e,_0x392dbd){const _0x5d4a5f=a0_0x1495bb;_0x55ab9e[_0x5d4a5f(0x144)]['info'](_0x5d4a5f(0x200)+JSON[_0x5d4a5f(0x30e)](_0x392dbd));}async function runBaselineDriftAnalysis(_0x3884b6){const _0x21cc64=a0_0x1495bb;if(!_0x3884b6[_0x21cc64(0x1fe)]||!_0x3884b6[_0x21cc64(0x222)])return;const _0x13ebe2=_0x3884b6[_0x21cc64(0x2fb)][_0x21cc64(0x27b)]||0xe;if(_0x3884b6['dailyDigests'][_0x21cc64(0x1c6)]<_0x13ebe2+(_0x3884b6[_0x21cc64(0x2fb)][_0x21cc64(0x1fd)]||0x7)){await _0x3884b6[_0x21cc64(0x1b2)](LTM_DP_DRIFT_STATUS,{'val':_0x21cc64(0x2c8),'ack':!![]});return;}const _0x30efff=_0x3884b6[_0x21cc64(0x1b1)][_0x21cc64(0x138)](-_0x13ebe2),_0x345fd1=_0x3884b6[_0x21cc64(0x1b1)][_0x21cc64(0x138)](0x0,_0x3884b6[_0x21cc64(0x1b1)][_0x21cc64(0x1c6)]-_0x13ebe2),_0x350b12=_0x21cc64(0x1e1)+JSON[_0x21cc64(0x30e)](_0x345fd1)+_0x21cc64(0x275)+JSON[_0x21cc64(0x30e)](_0x30efff);try{const _0x3c7476=await _0x3884b6[_0x21cc64(0x222)][_0x21cc64(0x295)](_0x350b12),_0x4ff1bd=JSON[_0x21cc64(0x2c4)](_0x3c7476[_0x21cc64(0x2c0)]['text']()[_0x21cc64(0x1e9)](/```json|```/g,'')[_0x21cc64(0x2e3)]());_0x4ff1bd[_0x21cc64(0x203)]&&(await _0x3884b6[_0x21cc64(0x1b2)](LTM_DP_DRIFT_STATUS,{'val':_0x4ff1bd['baselineDrift'],'ack':!![]}),await _0x3884b6['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x4ff1bd[_0x21cc64(0x241)],'ack':!![]}),await _0x3884b6[_0x21cc64(0x1b2)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x21cc64(0x2f3)](),'ack':!![]}));}catch(_0xbef695){}}function setupLtmScheduler(_0xf4d25){const _0x4645fe=a0_0x1495bb;try{if(_0xf4d25[_0x4645fe(0x2d4)])_0xf4d25[_0x4645fe(0x2d4)][_0x4645fe(0x234)]();if(!_0xf4d25['isProVersion']){_0xf4d25['setStateAsync'](LTM_DP_STATUS,{'val':_0x4645fe(0x12d),'ack':!![]});return;}_0xf4d25[_0x4645fe(0x2d4)]=schedule[_0x4645fe(0x300)](LTM_SCHEDULE,()=>createDailyDigest(_0xf4d25));}catch(_0x2de527){_0xf4d25[_0x4645fe(0x144)][_0x4645fe(0x32f)](_0x4645fe(0x162)+_0x2de527[_0x4645fe(0x33a)]);}}function setupModeResetScheduler(_0xe7e03f){const _0x1dacc8=a0_0x1495bb;try{if(_0xe7e03f[_0x1dacc8(0x21b)])_0xe7e03f[_0x1dacc8(0x21b)]['cancel']();_0xe7e03f[_0x1dacc8(0x21b)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x419922=_0x1dacc8;await loadSystemMode(_0xe7e03f),AUTO_RESET_MODES[_0x419922(0x1bd)](_0xe7e03f['currentSystemMode'])&&await _0xe7e03f[_0x419922(0x1b2)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x39e362){_0xe7e03f[_0x1dacc8(0x144)][_0x1dacc8(0x32f)](_0x1dacc8(0x26c)+_0x39e362[_0x1dacc8(0x33a)]);}}function setupDriftAnalysisScheduler(_0x264cc7){const _0x265b7e=a0_0x1495bb;try{if(_0x264cc7[_0x265b7e(0x1c3)])clearInterval(_0x264cc7[_0x265b7e(0x1c3)]);if(!_0x264cc7[_0x265b7e(0x1fe)])return;_0x264cc7[_0x265b7e(0x1c3)]=setInterval(()=>runBaselineDriftAnalysis(_0x264cc7),(_0x264cc7[_0x265b7e(0x2fb)][_0x265b7e(0x145)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x264cc7),0x1388);}catch(_0x47abef){_0x264cc7[_0x265b7e(0x144)][_0x265b7e(0x32f)](_0x265b7e(0x2ad)+_0x47abef[_0x265b7e(0x33a)]);}}function setupBriefingScheduler(_0x1e9eba){const _0x624768=a0_0x1495bb;try{if(_0x1e9eba['briefingJob'])_0x1e9eba[_0x624768(0x12c)][_0x624768(0x234)]();if(!_0x1e9eba[_0x624768(0x2fb)]['briefingEnabled'])return;const _0x2c8f20=(_0x1e9eba[_0x624768(0x2fb)]['briefingTime']||_0x624768(0x18e))[_0x624768(0x1e4)](':'),_0x32fff8=parseInt(_0x2c8f20[0x0])||0x8,_0x33c873=parseInt(_0x2c8f20[0x1])||0x0,_0x5be205=_0x33c873+'\x20'+_0x32fff8+'\x20*\x20*\x20*';_0x1e9eba[_0x624768(0x144)][_0x624768(0x12a)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x32fff8+':'+(_0x33c873<0xa?'0'+_0x33c873:_0x33c873)),_0x1e9eba['briefingJob']=schedule[_0x624768(0x300)](_0x5be205,()=>{sendMorningBriefing(_0x1e9eba);});}catch(_0x8b62fe){_0x1e9eba[_0x624768(0x144)][_0x624768(0x32f)](_0x624768(0x181)+_0x8b62fe[_0x624768(0x33a)]);}}async function sendNotification(_0x2513b7,_0x11a06b,_0x43c00d=![],_0x537298=![]){const _0x1f8fc2=a0_0x1495bb;_0x2513b7[_0x1f8fc2(0x144)][_0x1f8fc2(0x12a)]((_0x43c00d?'[TEST]\x20':'')+_0x1f8fc2(0x17e)+_0x11a06b+'\x22');const _0x76fd96=_0x2513b7[_0x1f8fc2(0x2fb)];let _0x109887=0x0;if(_0x76fd96['notifyTelegramEnabled']){let _0xb1c684={};(_0x11a06b[_0x1f8fc2(0x1bd)](_0x1f8fc2(0x14a))||_0x537298)&&(_0xb1c684={'reply_markup':{'inline_keyboard':[[{'text':_0x1f8fc2(0x188),'callback_data':_0x1f8fc2(0x2f5)}],[{'text':_0x1f8fc2(0x243),'callback_data':_0x1f8fc2(0x184)}]]}}),await _0x2513b7[_0x1f8fc2(0x301)](_0x76fd96[_0x1f8fc2(0x1ee)],_0x1f8fc2(0x1c7),{'text':_0x11a06b,'user':_0x76fd96[_0x1f8fc2(0x231)],..._0xb1c684}),_0x109887++;}if(_0x76fd96[_0x1f8fc2(0x1cb)]){let _0x421b18={'message':_0x11a06b,'title':_0x537298?_0x1f8fc2(0x315):_0x1f8fc2(0x179),'priority':_0x537298?0x2:0x1,'device':_0x76fd96[_0x1f8fc2(0x1af)]};_0x537298&&(_0x421b18['retry']=0x1e,_0x421b18[_0x1f8fc2(0x14d)]=0xe10,_0x421b18[_0x1f8fc2(0x276)]=_0x1f8fc2(0x157)),await _0x2513b7[_0x1f8fc2(0x301)](_0x76fd96['notifyPushoverInstance'],_0x1f8fc2(0x1c7),_0x421b18),_0x109887++;}return _0x76fd96['notifyEmailEnabled']&&(await _0x2513b7[_0x1f8fc2(0x301)](_0x76fd96[_0x1f8fc2(0x223)],_0x1f8fc2(0x1c7),{'text':_0x11a06b,'to':_0x76fd96['notifyEmailRecipient']}),_0x109887++),_0x109887;}async function setupTelegramListener(_0x56a14e){const _0x352c46=a0_0x1495bb,_0x433543=_0x56a14e[_0x352c46(0x2fb)][_0x352c46(0x1ee)];_0x56a14e[_0x352c46(0x2fb)][_0x352c46(0x27a)]&&_0x433543&&(_0x56a14e[_0x352c46(0x144)][_0x352c46(0x12a)]('üì°\x20Hooking\x20into\x20'+_0x433543+_0x352c46(0x332)),await _0x56a14e[_0x352c46(0x17b)](_0x433543+'.communicate.request'));}async function handleTelegramResponse(_0x27ea34,_0x210771){const _0x167b80=a0_0x1495bb;let _0x17edab=_0x210771;_0x210771[_0x167b80(0x311)]('[')&&(_0x17edab=_0x210771['substring'](_0x210771[_0x167b80(0x172)](']')+0x1));if(_0x17edab==='COGNI_CONFIRM_OK')_0x27ea34[_0x167b80(0x144)]['info'](_0x167b80(0x167)),await _0x27ea34['setStateAsync'](_0x167b80(0x16c),{'val':![],'ack':!![]}),await _0x27ea34[_0x167b80(0x1b2)]('analysis.alertReason',{'val':_0x167b80(0x22a),'ack':!![]}),_0x27ea34['lastAlertState']=![],sendNotification(_0x27ea34,_0x167b80(0x31e),![]);else _0x17edab===_0x167b80(0x184)&&(_0x27ea34[_0x167b80(0x144)][_0x167b80(0x322)]('üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x27ea34,'üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.',![],!![]));}async function runAutopilot(_0x5c2212){const _0x6ed6ee=a0_0x1495bb,_0x2d4a72=_0x5c2212['config'][_0x6ed6ee(0x159)],_0x1d5d73=_0x5c2212[_0x6ed6ee(0x14b)]['length']>0x0?_0x5c2212['eventHistory'][0x0][_0x6ed6ee(0x2ae)]:Date[_0x6ed6ee(0x2f3)](),_0x5ae4c9=(Date['now']()-_0x1d5d73)/(0x3e8*0x3c*0x3c);let _0x6a272d='';_0x5c2212[_0x6ed6ee(0x2fb)][_0x6ed6ee(0x2e9)]&&_0x5c2212[_0x6ed6ee(0x20e)]===SYSTEM_MODES[_0x6ed6ee(0x1cf)]&&_0x5c2212['isPresent']&&(_0x5ae4c9>_0x2d4a72&&(_0x6a272d=_0x6ed6ee(0x2a7)+_0x5ae4c9[_0x6ed6ee(0x30a)](0x1)+_0x6ed6ee(0x2b5))),runGeminiAnalysis(_0x5c2212,_0x6a272d)[_0x6ed6ee(0x215)](_0x340b24=>_0x5c2212[_0x6ed6ee(0x144)][_0x6ed6ee(0x32f)](_0x340b24));}async function createDailyDigest(_0x289861){const _0x19a2ed=a0_0x1495bb;if(!_0x289861[_0x19a2ed(0x1fe)])return;await _0x289861[_0x19a2ed(0x1b2)](LTM_DP_STATUS,{'val':_0x19a2ed(0x150)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x289861[_0x19a2ed(0x222)]||_0x289861[_0x19a2ed(0x18d)][_0x19a2ed(0x1c6)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x289861[_0x19a2ed(0x1b2)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x2adc5a=JSON['parse'](JSON['stringify'](_0x289861['rawEventLog'])),_0x13116c=_0x2adc5a[_0x19a2ed(0x1c6)],_0x501d31=_0x19a2ed(0x14c)+JSON[_0x19a2ed(0x30e)](_0x2adc5a);try{const _0x2b6ec4=await _0x289861[_0x19a2ed(0x222)][_0x19a2ed(0x295)](_0x501d31),_0x129853=JSON['parse'](_0x2b6ec4['response'][_0x19a2ed(0x24e)]()[_0x19a2ed(0x1e9)](/```json|```/g,'')[_0x19a2ed(0x2e3)]());_0x129853[_0x19a2ed(0x17c)]&&(_0x289861[_0x19a2ed(0x1b1)][_0x19a2ed(0x2d9)]({'timestamp':new Date()[_0x19a2ed(0x1ec)](),'eventCount':_0x13116c,'summary':_0x129853[_0x19a2ed(0x17c)],'activityLevel':_0x129853[_0x19a2ed(0x237)],'systemMode':_0x289861[_0x19a2ed(0x20e)]}),await saveDailyDigests(_0x289861),_0x289861['rawEventLog']=[],await saveRawEventLog(_0x289861),await _0x289861[_0x19a2ed(0x1b2)](LTM_DP_STATUS,{'val':_0x19a2ed(0x174)+_0x13116c+_0x19a2ed(0x334),'ack':!![]}),runPythonHealthCheck(_0x289861));}catch(_0x195158){await _0x289861[_0x19a2ed(0x1b2)](LTM_DP_STATUS,{'val':_0x19a2ed(0x307)+_0x195158[_0x19a2ed(0x33a)],'ack':!![]});}}async function sendMorningBriefing(_0x282241){const _0x10ea2f=a0_0x1495bb;if(!_0x282241[_0x10ea2f(0x222)])return;_0x282241[_0x10ea2f(0x144)]['info']('Generating\x20Morning\x20Briefing...');const _0x4decab=_0x282241['dailyDigests'][_0x10ea2f(0x1c6)]>0x0?_0x282241[_0x10ea2f(0x1b1)][_0x282241[_0x10ea2f(0x1b1)][_0x10ea2f(0x1c6)]-0x1]:null,_0x4138bb=_0x4decab&&_0x4decab[_0x10ea2f(0x2f7)]?_0x4decab[_0x10ea2f(0x2f7)]['sleepScore']:_0x10ea2f(0x268),_0x30ea91=new Date();_0x30ea91['setHours'](0x4,0x0,0x0,0x0);const _0x10686a=_0x282241['eventHistory'][_0x10ea2f(0x1ba)](_0x1ef55b=>new Date(_0x1ef55b[_0x10ea2f(0x2ae)])>_0x30ea91),_0x13e889=PERSONA_MAPPING[_0x282241[_0x10ea2f(0x2fb)]['aiPersona']||'generic'],_0x11a5c6=_0x282241[_0x10ea2f(0x2fb)][_0x10ea2f(0x32e)]||'',_0xd063d3=await getWeatherContext(_0x282241),_0xbb77fc=await getCalendarContext(_0x282241),_0x8d86da=_0x10ea2f(0x21a)+_0x13e889+_0x10ea2f(0x204)+_0x11a5c6+'.\x20ZUSATZ:\x20'+_0xd063d3+'\x20'+_0xbb77fc+_0x10ea2f(0x2a8)+_0x4138bb+_0x10ea2f(0x13a)+JSON[_0x10ea2f(0x30e)](_0x10686a[_0x10ea2f(0x138)](0x0,0xa))+_0x10ea2f(0x211);try{const _0x11794b=await _0x282241[_0x10ea2f(0x222)][_0x10ea2f(0x295)](_0x8d86da),_0x264343=_0x10ea2f(0x2c7)+_0x11794b[_0x10ea2f(0x2c0)][_0x10ea2f(0x24e)]()['trim']();sendNotification(_0x282241,_0x264343),_0x282241[_0x10ea2f(0x144)][_0x10ea2f(0x12a)](_0x10ea2f(0x1dd));}catch(_0x11733b){_0x282241['log']['error'](_0x10ea2f(0x12b)+_0x11733b[_0x10ea2f(0x33a)]);}}async function scanForDevices(_0x2a1220,_0x3394b7){const _0x4cea32=a0_0x1495bb;_0x2a1220['log']['info']('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x2e2bc9=[],_0xb07029=await _0x2a1220['getForeignObjectsAsync']('*'),_0x53fab2=await _0x2a1220[_0x4cea32(0x277)](_0x4cea32(0x26f),'enum'),_0x45f14e=await _0x2a1220['getForeignObjectsAsync'](_0x4cea32(0x248),'enum'),_0x4d4a07={};if(_0x53fab2)for(const _0x2056d0 in _0x53fab2){const _0x1ce0b3=_0x53fab2[_0x2056d0][_0x4cea32(0x303)][_0x4cea32(0x1c0)]||[];_0x1ce0b3['forEach'](_0x274c28=>{const _0x5b5d13=_0x4cea32;if(!_0x4d4a07[_0x274c28])_0x4d4a07[_0x274c28]=[];_0x4d4a07[_0x274c28][_0x5b5d13(0x2d9)](_0x2056d0);});}const _0x43a459={};if(_0x45f14e)for(const _0x4a8d83 in _0x45f14e){const _0xc217ee=_0x45f14e[_0x4a8d83]['common'][_0x4cea32(0x1c0)]||[],_0x173798=typeof _0x45f14e[_0x4a8d83][_0x4cea32(0x303)][_0x4cea32(0x23c)]===_0x4cea32(0x19d)?_0x45f14e[_0x4a8d83][_0x4cea32(0x303)][_0x4cea32(0x23c)]['de']:_0x45f14e[_0x4a8d83][_0x4cea32(0x303)]['name'];_0xc217ee[_0x4cea32(0x2da)](_0x3de484=>_0x43a459[_0x3de484]=_0x173798);}const _0x4ec8c8=_0x3394b7[_0x4cea32(0x21c)]||[],_0x2ee073=_0x3394b7[_0x4cea32(0x2a0)]!==![],_0x105d1d=_0x3394b7[_0x4cea32(0x2d0)]!==![],_0x3d1d73=_0x3394b7['lights']!==![],_0x5a3abc=_0x3394b7[_0x4cea32(0x2ac)]===!![],_0x1eabf6=_0x3394b7['weather']===!![];for(const _0x194014 in _0xb07029){const _0x493cdd=_0xb07029[_0x194014];if(_0x493cdd[_0x4cea32(0x262)]!=='state'||!_0x493cdd[_0x4cea32(0x303)])continue;if(ADAPTER_BLACKLIST['some'](_0x4cc8e7=>_0x194014[_0x4cea32(0x311)](_0x4cc8e7))&&!_0x1eabf6)continue;const _0xdf6a33=(_0x493cdd[_0x4cea32(0x303)]['role']||'')['toLowerCase']();let _0x4a9dc6=(typeof _0x493cdd[_0x4cea32(0x303)][_0x4cea32(0x23c)]===_0x4cea32(0x19d)?_0x493cdd[_0x4cea32(0x303)][_0x4cea32(0x23c)]['de']:_0x493cdd[_0x4cea32(0x303)][_0x4cea32(0x23c)])||_0x194014;const _0x383d20=_0x4a9dc6[_0x4cea32(0x2e7)]();let _0x5c8fd7=![],_0x20f913=![];if(_0x4ec8c8[_0x4cea32(0x1c6)]>0x0){const _0x5bbc38=_0x4d4a07[_0x194014]||[],_0x3eb938=_0x194014[_0x4cea32(0x1e4)]('.')[_0x4cea32(0x138)](0x0,-0x1)[_0x4cea32(0x306)]('.'),_0x343644=_0x4d4a07[_0x3eb938]||[];(_0x5bbc38[_0x4cea32(0x31f)](_0x1477b8=>_0x4ec8c8[_0x4cea32(0x1bd)](_0x1477b8))||_0x343644[_0x4cea32(0x31f)](_0x1d1699=>_0x4ec8c8[_0x4cea32(0x1bd)](_0x1d1699)))&&(_0x5c8fd7=!![],_0x20f913=!![]);}if(!_0x5c8fd7&&!_0x1eabf6){if(HARD_IGNORE_TERMS[_0x4cea32(0x31f)](_0x53b792=>_0x194014[_0x4cea32(0x1bd)](_0x53b792)||_0x383d20[_0x4cea32(0x1bd)](_0x53b792[_0x4cea32(0x2e7)]())))continue;}if(BAD_NAMES['some'](_0x5f4375=>_0x383d20===_0x5f4375||_0x383d20['endsWith']('.'+_0x5f4375))){const _0x3048b2=_0x194014[_0x4cea32(0x1e4)]('.');if(_0x3048b2[_0x4cea32(0x1c6)]>0x2){const _0x14f076=_0x3048b2[_0x4cea32(0x138)](0x0,-0x1)[_0x4cea32(0x306)]('.'),_0x3d85e5=_0xb07029[_0x14f076];if(_0x3d85e5&&_0x3d85e5[_0x4cea32(0x303)]&&_0x3d85e5['common'][_0x4cea32(0x23c)]){const _0x449c9b=typeof _0x3d85e5['common']['name']===_0x4cea32(0x19d)?_0x3d85e5['common'][_0x4cea32(0x23c)]['de']:_0x3d85e5['common']['name'];_0x449c9b&&!_0x4a9dc6[_0x4cea32(0x1bd)](_0x449c9b)&&(_0x4a9dc6=_0x449c9b+'\x20'+_0x4a9dc6);}}}let _0x3e6632='';if(_0x2ee073&&(_0xdf6a33[_0x4cea32(0x1bd)](_0x4cea32(0x2a0))||_0xdf6a33[_0x4cea32(0x1bd)](_0x4cea32(0x192))||_0x383d20['includes'](_0x4cea32(0x168))||_0x383d20[_0x4cea32(0x1bd)](_0x4cea32(0x274))))_0x3e6632=_0x4cea32(0x2a0);else{if(!_0x3e6632&&_0x105d1d&&(_0xdf6a33[_0x4cea32(0x1bd)]('door')||_0xdf6a33['includes']('window')||_0xdf6a33[_0x4cea32(0x1bd)](_0x4cea32(0x1f7))||_0xdf6a33[_0x4cea32(0x1bd)](_0x4cea32(0x177))||_0xdf6a33['includes'](_0x4cea32(0x239))||_0x383d20[_0x4cea32(0x1bd)](_0x4cea32(0x173))||_0x383d20[_0x4cea32(0x1bd)](_0x4cea32(0x210))||_0x383d20[_0x4cea32(0x1bd)](_0x4cea32(0x24c))))_0x3e6632=_0x4cea32(0x1da);else{if(!_0x3e6632&&_0x3d1d73&&(_0xdf6a33[_0x4cea32(0x1bd)]('light')||_0xdf6a33[_0x4cea32(0x1bd)]('switch')||_0xdf6a33[_0x4cea32(0x1bd)]('dimmer')||_0x383d20['includes'](_0x4cea32(0x142))||_0x383d20[_0x4cea32(0x1bd)](_0x4cea32(0x326))||_0x383d20[_0x4cea32(0x1bd)](_0x4cea32(0x233)))){if(_0x493cdd['common'][_0x4cea32(0x30f)]||_0xdf6a33['includes'](_0x4cea32(0x327)))_0x3e6632=_0x4cea32(0x30d);}else{if(!_0x3e6632&&_0x5a3abc&&(_0xdf6a33[_0x4cea32(0x1bd)](_0x4cea32(0x2ac))||_0xdf6a33[_0x4cea32(0x1bd)](_0x4cea32(0x24f))||_0xdf6a33[_0x4cea32(0x1bd)](_0x4cea32(0x271))||_0x383d20[_0x4cea32(0x1bd)](_0x4cea32(0x290))||_0x383d20[_0x4cea32(0x1bd)](_0x4cea32(0x333))||_0x383d20['includes'](_0x4cea32(0x289))))_0x3e6632='temperature';else{if(!_0x3e6632&&_0x20f913)_0x3e6632=_0x4cea32(0x2eb);}}}}if(_0x3e6632){let _0x412570=_0x43a459[_0x194014]||'';if(!_0x412570){let _0x5a5f95=_0x194014;for(let _0x408f6a=0x0;_0x408f6a<0x3;_0x408f6a++){const _0x27055f=_0x5a5f95[_0x4cea32(0x292)]('.');if(_0x27055f===-0x1)break;_0x5a5f95=_0x5a5f95[_0x4cea32(0x1fc)](0x0,_0x27055f);if(_0x43a459[_0x5a5f95]){_0x412570=_0x43a459[_0x5a5f95];break;}}}_0x2e2bc9[_0x4cea32(0x2d9)]({'id':_0x194014,'name':_0x4a9dc6,'location':_0x412570,'type':_0x3e6632,'logDuplicates':_0x3e6632===_0x4cea32(0x2a0),'isExit':![],'_score':_0x412570?0x50:_0x3e6632===_0x4cea32(0x2eb)?0x5a:0x28});}}return _0x2e2bc9[_0x4cea32(0x1b4)]((_0x52dcec,_0x1f5edb)=>_0x1f5edb[_0x4cea32(0x309)]-_0x52dcec[_0x4cea32(0x309)]),_0x2e2bc9;}async function executeAutomationAction(_0x865d54){const _0xb273fc=a0_0x1495bb;try{const _0x421cb7=await _0x865d54[_0xb273fc(0x1a0)](_0xb273fc(0x202)),_0x596c5c=await _0x865d54[_0xb273fc(0x1a0)]('analysis.automation.targetValue');if(_0x421cb7&&_0x421cb7[_0xb273fc(0x298)]&&_0x596c5c){const _0x40f242=_0x421cb7['val'];let _0x3a684c=_0x596c5c[_0xb273fc(0x298)];try{_0x3a684c=JSON[_0xb273fc(0x2c4)](_0x3a684c);}catch(_0x4d1c2b){}_0x865d54[_0xb273fc(0x144)][_0xb273fc(0x12a)](_0xb273fc(0x249)+_0x40f242+_0xb273fc(0x14f)+_0x3a684c),await _0x865d54[_0xb273fc(0x186)](_0x40f242,_0x3a684c);}else _0x865d54[_0xb273fc(0x144)][_0xb273fc(0x322)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x31aadf){_0x865d54[_0xb273fc(0x144)][_0xb273fc(0x32f)](_0xb273fc(0x169)+_0x31aadf[_0xb273fc(0x33a)]);}}function tryParse(_0x54a6bf){const _0x5686e5=a0_0x1495bb;try{return JSON[_0x5686e5(0x2c4)](_0x54a6bf);}catch(_0x514cde){return null;}}async function recordSequence(_0x2fdba1,_0x524340){const _0x38254b=a0_0x1495bb,_0x4c1153=(_0x524340['type']||'')['toLowerCase'](),_0x15e536=['motion',_0x38254b(0x168),'pr√§senz','presence',_0x38254b(0x192),_0x38254b(0x1da),'t√ºr',_0x38254b(0x130),_0x38254b(0x173),_0x38254b(0x20a),'kontakt',_0x38254b(0x30d),'licht',_0x38254b(0x201),'schalter',_0x38254b(0x2bf),_0x38254b(0x326)];if(!_0x15e536[_0x38254b(0x31f)](_0x445486=>_0x4c1153[_0x38254b(0x1bd)](_0x445486))){_0x2fdba1['log'][_0x38254b(0x31b)](_0x38254b(0x27c)+_0x524340['id']+_0x38254b(0x28c)+_0x524340[_0x38254b(0x262)]+'\x27\x20not\x20in\x20allowed\x20list)');return;}if(!_0x524340['value']){_0x2fdba1[_0x38254b(0x144)][_0x38254b(0x31b)]('[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20'+_0x524340['id']+_0x38254b(0x219)+_0x524340[_0x38254b(0x14e)]+')');return;}_0x2fdba1['log'][_0x38254b(0x31b)](_0x38254b(0x2e2)+_0x524340['id']+'\x20('+_0x524340[_0x38254b(0x284)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x151d68={'loc':_0x524340[_0x38254b(0x284)]||_0x38254b(0x155),'id':_0x524340['id'],'ts':Date[_0x38254b(0x2f3)]()};activeSequence['push'](_0x151d68),_0x2fdba1[_0x38254b(0x144)][_0x38254b(0x31b)](_0x38254b(0x1ea)+_0x151d68[_0x38254b(0x20d)]+_0x38254b(0x16d)+activeSequence[_0x38254b(0x1c6)]+')'),sequenceTimer=setTimeout(async()=>{const _0x4b8350=_0x38254b;activeSequence[_0x4b8350(0x1c6)]>0x1?await saveCompletedSequence(_0x2fdba1):(_0x2fdba1[_0x4b8350(0x144)]['debug'](_0x4b8350(0x246)+activeSequence[_0x4b8350(0x1c6)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x3afe0f){const _0x4a6f44=a0_0x1495bb;try{_0x3afe0f[_0x4a6f44(0x144)][_0x4a6f44(0x12a)](_0x4a6f44(0x141)+activeSequence[_0x4a6f44(0x1c6)]+').\x20Saving\x20to\x20Training\x20Data.');const _0x11dceb=await _0x3afe0f[_0x4a6f44(0x1a0)]('LTM.trainingData.sequences');let _0x3df9d0=[];if(_0x11dceb&&_0x11dceb['val'])try{_0x3df9d0=JSON[_0x4a6f44(0x2c4)](_0x11dceb[_0x4a6f44(0x298)]);}catch(_0x36bcee){}const _0x87984=activeSequence[0x0]['ts'],_0x1bbb48=activeSequence['map'](_0x5b23d1=>({'loc':_0x5b23d1[_0x4a6f44(0x20d)],'t_delta':Math['round']((_0x5b23d1['ts']-_0x87984)/0x3e8)})),_0x50af7e={'timestamp':new Date(_0x87984)[_0x4a6f44(0x1ec)](),'steps':_0x1bbb48,'duration':Math['round']((activeSequence[activeSequence[_0x4a6f44(0x1c6)]-0x1]['ts']-_0x87984)/0x3e8),'daytime':new Date(_0x87984)[_0x4a6f44(0x217)]()};_0x3df9d0[_0x4a6f44(0x2d9)](_0x50af7e),_0x3df9d0[_0x4a6f44(0x1c6)]>MAX_TRAINING_SET_SIZE&&_0x3df9d0['shift'](),await _0x3afe0f['setStateAsync'](_0x4a6f44(0x1f5),{'val':JSON[_0x4a6f44(0x30e)](_0x3df9d0),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0xad2721){_0x3afe0f[_0x4a6f44(0x144)][_0x4a6f44(0x32f)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0xad2721['message']);}}async function getOutsideTemperatureNumeric(_0x4870ee){const _0x19e9c9=a0_0x1495bb;if(_0x4870ee[_0x19e9c9(0x2fb)][_0x19e9c9(0x304)])try{const _0x22288f=await _0x4870ee[_0x19e9c9(0x2ec)](_0x4870ee[_0x19e9c9(0x2fb)]['outdoorSensorId']);if(_0x22288f&&_0x22288f[_0x19e9c9(0x298)]!==undefined&&_0x22288f[_0x19e9c9(0x298)]!==null){const _0x1072df=parseFloat(_0x22288f[_0x19e9c9(0x298)]);if(!isNaN(_0x1072df))return _0x1072df;}}catch(_0x4e102a){_0x4870ee[_0x19e9c9(0x144)][_0x19e9c9(0x322)](_0x19e9c9(0x194)+_0x4870ee[_0x19e9c9(0x2fb)]['outdoorSensorId']+':\x20'+_0x4e102a[_0x19e9c9(0x33a)]);}const _0x1c6b72=_0x4870ee[_0x19e9c9(0x2fb)][_0x19e9c9(0x136)];if(!_0x4870ee[_0x19e9c9(0x2fb)][_0x19e9c9(0x2c3)]||!_0x1c6b72)return null;try{let _0x45fb13='';if(_0x1c6b72[_0x19e9c9(0x1bd)](_0x19e9c9(0x213)))_0x45fb13=_0x1c6b72+'.Current.Temperature';else{if(_0x1c6b72[_0x19e9c9(0x1bd)](_0x19e9c9(0x1ce)))_0x45fb13=_0x1c6b72+_0x19e9c9(0x1c8);else{if(_0x1c6b72[_0x19e9c9(0x1bd)](_0x19e9c9(0x2cd)))_0x45fb13=_0x1c6b72+_0x19e9c9(0x325);else{if(_0x1c6b72['includes'](_0x19e9c9(0x1c2)))_0x45fb13=_0x1c6b72+'.forecast.current.temp';}}}if(_0x45fb13){const _0x3f138a=await _0x4870ee['getForeignStateAsync'](_0x45fb13);if(_0x3f138a&&_0x3f138a[_0x19e9c9(0x298)]!==undefined&&_0x3f138a[_0x19e9c9(0x298)]!==null)return parseFloat(_0x3f138a[_0x19e9c9(0x298)]);}}catch(_0x38e99f){}return null;}async function recordThermodynamics(_0x57b572,_0x197163,_0x5d0657,_0x34947a){const _0x285f82=a0_0x1495bb,_0x6a7508=await getOutsideTemperatureNumeric(_0x57b572),_0x5695ae=await _0x57b572[_0x285f82(0x1a0)](_0x285f82(0x31a));let _0x2954e5=[];if(_0x5695ae&&_0x5695ae[_0x285f82(0x298)])try{_0x2954e5=JSON['parse'](_0x5695ae[_0x285f82(0x298)]);}catch(_0x2ad77e){}_0x2954e5[_0x285f82(0x2d9)]({'ts':Date['now'](),'room':_0x34947a||_0x285f82(0x155),'t_in':_0x5d0657,'t_out':_0x6a7508});if(_0x2954e5['length']>THERMO_LOG_SIZE)_0x2954e5['shift']();await _0x57b572['setStateAsync'](_0x285f82(0x31a),{'val':JSON[_0x285f82(0x30e)](_0x2954e5),'ack':!![]});}function a0_0x3878(){const _0x490f76=['inactivityThresholdHours','Idle','button','map','System\x20Mode','.NextHours.Location_1.Day_1.current.symbol_desc','187926KewhVs','boolean','unknown','LTM\x20Sched\x20Error:\x20','normal','isPresent','uuid-error','string','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','bewegung','BUTLER\x20Execution\x20Error:\x20','‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.','PRIORIT√ÑT:\x20Gesundheit/AAL.','analysis.isAlert','\x20(Length:\x20','Trend\x20Value\x20(%)','Training\x20Data\x20Sets','PRO-','VACATION','indexOf','fenster','Success:\x20Compressed\x20','uuid','analysis.health.sleepScore','blind','Success:\x20','Cogni-Living','onUnload','subscribeForeignStatesAsync','summary','submitFeedback','Sending\x20notification:\x20\x22','Sleep\x20Score\x20(0-100)','requirements.txt','Briefing\x20Sched\x20Error:\x20','firmware','onReady','COGNI_REQUEST_CALL','TEST-PRO-KEY','setForeignStateAsync','aiPersona','‚úÖ\x20Alles\x20OK\x20(Reset)]','systemUUID','system.config','getCalendarNames\x20Error:\x20','\x20events)...','rawEventLog','08:00','Restlessness\x20Level','Training\x20Status','instance','occupancy','exports','Error\x20reading\x20outdoor\x20sensor\x20','history.','close','Unknown\x20error','presenceDevices','uuid-not-found','weatherunderground.0','stateChange','‚ùå\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.','object','305751LcvBVF','number','getStateAsync','telegram','Normal','Missing\x20data','longitude','value.health','analysis.training.triggerSecurity','Wetter:\x20Deaktiviert','No\x20training\x20sequences\x20found.','Train\x20Security\x20Model\x20(LSTM)','0\x203\x20*\x20*\x20*','analysis.training','Health\x20&\x20Sleep\x20Analysis','Trigger\x20Analysis','getForeignObjectAsync','notifyPushoverRecipient','ready','dailyDigests','setStateAsync','Error\x20reading\x20calendar\x20table:\x20','sort','indicator','direction','.Summary.Current','Details:\x20','ack','filter','TREND_RESULT','analysis.isEmergency','includes','LTM.baselineStatus','daswetter.0','members',').\x20Starting\x20Timer.','weatherunderground','driftAnalysisTimer','javascript.','Activity-Level','length','send','.NextHours.Location_1.Day_1.current.temp_value','lastCheck','14048361VchuTX','notifyPushoverEnabled','calendarInstance','LTM.rawEventLog','daswetter','NORMAL','analysis.activitySummary','[RESULT]','\x20Tage)','Invalid\x20JSON\x20from\x20Python:\x20','Description',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','\x22\x20--break-system-packages\x20--user','Training\x20Error:\x20','testApiKey','genAI','door','fill','Target\x20ID','Morning\x20Briefing\x20sent.','analysis.training.status','IGNORING\x20DUPLICATE\x20(Cached):\x20','Aktiv\x20(','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Unbekannt','KALENDER\x20ERROR:\x20','split','search','analysis.automation.suggestedAction','testContext','WETTER\x20ERROR:\x20','replace','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','onMessage','toISOString','from','notifyTelegramInstance','‚ö†Ô∏è\x20ALARM:\x20','Comfort\x20Suggestion','Baseline\x20Status','presence','stdin','üêç\x20Guardian\x20Diagnosis\x20(','LTM.trainingData.sequences','getTime','lock','WETTER:\x20Keine\x20Daten\x20gefunden','systemConfig','getDate','Bibliotheken\x20nicht\x20gefunden','substring','minDaysForBaseline','isProVersion','set_temperature','Feedback\x20saved:\x20','switch','analysis.automation.targetId','baselineDrift','.\x20KONTEXT:\x20','Drift\x20Details','Error\x20launching\x20Python\x20service:\x20','Drift\x20Status','TRAINING_COMPLETE','Exit\x20Sensor\x20triggered\x20(','contact','openweathermap.0','LTM.driftAnalysis.baselineDrift','loc','currentSystemMode','WETTER:\x20','t√ºr','.\x20OUTPUT:\x20Nur\x20Text.','Thermodynamic\x20Data\x20Points','accuweather','getMonth','catch','isGracePeriodActive','getHours','analysis.deviationFromBaseline','\x20(Value\x20is\x20falsy:\x20','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','modeResetJob','selectedFunctionIds','354291yLPnXe','Feedback\x20Log','config_pending','echarts.','namespace','geminiModel','notifyEmailInstance','Anwesend','delObjectAsync','stderr','_calName','admin.','Urlaub','Vom\x20Benutzer\x20best√§tigt\x20(OK).','unload','power','bind','üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','setObjectNotExistsAsync','scriptProblem','notifyTelegramRecipient','No\x20module\x20named\x20pip','schalter','cancel','\x22\x20--break-system-packages','details','activityLevel','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','shutter','channel','No\x20instance','name','pythonProcess','Comfort\x20Summary','Verbindung\x20erfolgreich!\x20Antwort:\x20','geminiApiKey','driftDetails','state','üìû\x20R√ºckruf\x20anfordern','PRIORIT√ÑT:\x20Sicherheit.','Keine\x20Details.','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','Trigger\x20Digest','enum.rooms.*','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','KI-Modell\x20nicht\x20initialisiert','analysisTimer','rollladen','online','text','humidity','Keine\x20Analyse.','time','Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip','\x20days\x20of\x20activity\x20data\x20to\x20Python...','analysis.alertReason','getLtmData','@google/generative-ai','Recorded\x20Motion\x20Sequences','date','analysis.history_debug_00','Kalender:\x20Deaktiviert','LTM','node-schedule','analysis.lastResult','exitGraceTimer','automation.triggerAction','targetValue','lowbat','type','\x20sequences...','LTM.trainingData','brightness','10XvanmX','‚ùå\x20Training\x20failed:\x20','N/A','analysis.triggerBriefing','lastAlertState','34VjUppG','Reset\x20Sched\x20Error:\x20','targetId','licenseKey','enum.functions.*','pop','thermostat','Trigger\x20Action\x20Now','analysis.health.trendValue','pr√§senz','\x0aSTB:\x20','sound','getForeignObjectsAsync','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','analysis.comfortSummary','notifyTelegramEnabled','ltmStbWindowDays','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','stick_unreach','communicate.request','ical.0','Fokus\x20auf\x20Familienroutinen.','PONG','sensorLastValues','alertReason','location','level','main','):\x20','fault','heizung','endsWith','service.py','\x20(Type\x20\x27','PARTY','splice','Last\x20raw\x20event','temp','apply','lastIndexOf','Gemini\x20Init\x20Error:\x20','callback','generateContent','Adapter','analysis.automation.description','val','simulateButler','Training\x20only\x20available\x20in\x20Pro\x20Version.','unshift','events.history','event','reachable','analysis.analysisHistory','motion','analysis.automation.patternDetected','Deviation','GUEST','data','(((.+)+)+)+$','triggerBriefing','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','.\x20DATEN:\x20Schlaf\x20','Entry\x20detected\x20via\x20','autoApply','icons-mfd.','temperature','Drift\x20Sched\x20Error:\x20','timestamp','Fehler:\x20','No\x20module\x20named','5930384ahdlUP','Failed:\x20','KALENDER:\x20Keine\x20relevanten\x20Termine','...','\x20hours.\x20Potential\x20incapacitation.','analysis.automation.autoApply','Drift\x20Analysis','\x20|\x20','LTM.driftAnalysis','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','python3\x20-m\x20pip\x20install\x20-r\x20\x22','update','3080671krewwJ','.\x20Welcome\x20home.','dimmer','response','Auto\x20Apply\x20Rule','Event\x20History','useWeather','parse','analysis.comfortSuggestion','Failed\x20to\x20send\x20to\x20Python:\x20','üåÖ\x20Daily\x20Briefing:\x0a','N/A\x20(Learning)','Daily\x20Digests','extendObjectAsync','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','Restoring\x20sensor\x20cache\x20from\x20history\x20(','openweathermap','cover','‚úÖ\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','doors','temperatur','sendTo','system.presenceWho','ltmJob','Alert\x20Reason','python3','LTM.dailyDigests','json','push','forEach','LTM.driftAnalysis.driftDetails','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','getOverviewData','apiKey','system.mode','party','analysisInterval','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','trim','Logbook','latitude','none','toLowerCase','190qieNlQ','inactivityMonitoringEnabled','kill','custom','getForeignStateAsync','Action','Health\x20Notes','analysis.automation.triggerAction','find','command','Event\x20received:\x20','now','‚ö†Ô∏è\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...','COGNI_CONFIRM_OK','toString','health','dismissAutomation','System\x20Status\x20&\x20Control','setpoint','config','Error\x20in\x20onMessage\x20command\x20','Raw\x20Log','analysis.automation','analysis.health.trendDiagnosis','scheduleJob','sendToAsync','automationProposal','common','outdoorSensorId','text.alarm','join','Error:\x20','[PYTHON\x20ERR]\x20','_score','toFixed','actual_temperature','Error\x20checking\x20WiFi:\x20','light','stringify','write','[PYTHON]\x20','startsWith','Lernphase\x20(','values','cogni-living\x20adapter\x20starting\x20(v','üö®\x20EMERGENCY','analysis.health.restlessness','description','Activity\x20Summary','analysis.health','LTM.trainingData.thermodynamics','debug','stdout','python_service','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','some','Kein\x20API\x20Key!','working','warn','No\x20Data','getCalendarNames','.forecast.current.temperature','lampe','sensor','setState','flot.','getGenerativeModel','getObjectAsync','currentposition','\x20(Value:\x20','livingContext','error','Starting\x20Autopilot\x20(','40pmJyuT','\x20for\x20interactive\x20buttons...','klima','\x20events','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','analysis.health.notes','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','0\x204\x20*\x20*\x20*','indicator.alarm','message','system.isPresent','939470PnviTY','native','application/json','toLocaleTimeString','Automation\x20Proposals','info','Briefing\x20Error:\x20','briefingJob','Deaktiviert\x20(Pro-Feature)','Subscribing\x20to\x20','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','window','material.','analysisHistory','devices','Gemini\x20AI\x20initialized.','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','weatherInstance','isArray','slice','system','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','üß™\x20Simulating\x20Butler\x20Proposal:\x20','exitTimer','onStateChange','\x20presence\x20devices...','status','position','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','licht','connection','log','ltmDriftCheckIntervalHours','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','dependencyInstallInProgress','isAlert','off','Alarm','eventHistory','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','expire','value','\x20=\x20','Started\x20at\x20','vis.','.\x0a\x20\x20\x20\x20ANWESENDE_GERAETE:\x20','subscribeStates','analysis.automation.targetValue','Unknown','.data.table','siren','Kein\x20API\x20Key\x20eingegeben.'];a0_0x3878=function(){return _0x490f76;};return a0_0x3878();}async function processSensorEvent(_0x40c6c4,_0x1c23b2,_0x3a7677,_0x583c22){const _0x42b2fc=a0_0x1495bb;if(!_0x583c22)return;const _0x2f0db3=_0x3a7677[_0x42b2fc(0x298)],_0x20c207=Date[_0x42b2fc(0x2f3)]();_0x40c6c4['log'][_0x42b2fc(0x31b)](_0x42b2fc(0x2f2)+_0x1c23b2+_0x42b2fc(0x14f)+_0x2f0db3);const _0x5d4255=_0x40c6c4[_0x42b2fc(0x282)][_0x1c23b2];_0x40c6c4['sensorLastValues'][_0x1c23b2]=_0x2f0db3;if(!_0x583c22['logDuplicates']&&_0x5d4255!=undefined&&_0x5d4255==_0x2f0db3){_0x40c6c4['log']['debug'](_0x42b2fc(0x1df)+_0x583c22['name']+_0x42b2fc(0x32d)+_0x2f0db3+')');return;}const _0x3aeb31=(_0x583c22[_0x42b2fc(0x262)]||'')[_0x42b2fc(0x2e7)](),_0x5286d1=_0x3aeb31[_0x42b2fc(0x1bd)](_0x42b2fc(0x2ac))||_0x3aeb31[_0x42b2fc(0x1bd)](_0x42b2fc(0x2d1))||_0x3aeb31['includes'](_0x42b2fc(0x333))||_0x3aeb31[_0x42b2fc(0x1bd)](_0x42b2fc(0x289));_0x40c6c4[_0x42b2fc(0x1fe)]&&_0x5286d1&&recordThermodynamics(_0x40c6c4,_0x1c23b2,_0x2f0db3,_0x583c22[_0x42b2fc(0x284)]);const _0x30f0d8={'timestamp':_0x20c207,'id':_0x1c23b2,'name':_0x583c22[_0x42b2fc(0x23c)],'type':_0x583c22[_0x42b2fc(0x262)],'location':_0x583c22[_0x42b2fc(0x284)],'value':_0x2f0db3};_0x40c6c4[_0x42b2fc(0x14b)][_0x42b2fc(0x29b)](_0x30f0d8);if(_0x40c6c4[_0x42b2fc(0x14b)]['length']>HISTORY_MAX_SIZE)_0x40c6c4[_0x42b2fc(0x14b)][_0x42b2fc(0x270)]();await _0x40c6c4[_0x42b2fc(0x1b2)]('events.lastEvent',{'val':JSON[_0x42b2fc(0x30e)](_0x30f0d8),'ack':!![]}),await _0x40c6c4[_0x42b2fc(0x1b2)](_0x42b2fc(0x29c),{'val':JSON[_0x42b2fc(0x30e)](_0x40c6c4['eventHistory']),'ack':!![]});_0x40c6c4[_0x42b2fc(0x1fe)]&&(_0x40c6c4['rawEventLog']['push'](_0x30f0d8),await saveRawEventLog(_0x40c6c4),recordSequence(_0x40c6c4,_0x30f0d8));if(_0x583c22['isExit']&&_0x2f0db3===!![]){if(_0x40c6c4['isPresent']&&!_0x40c6c4['isGracePeriodActive'])_0x40c6c4[_0x42b2fc(0x144)][_0x42b2fc(0x12a)](_0x42b2fc(0x209)+_0x583c22['name']+_0x42b2fc(0x1c1)),startExitTimer(_0x40c6c4);else!_0x40c6c4['isPresent']&&(_0x40c6c4['log'][_0x42b2fc(0x12a)](_0x42b2fc(0x2a9)+_0x583c22[_0x42b2fc(0x23c)]+_0x42b2fc(0x2be)),await setPresence(_0x40c6c4,!![]));}else _0x583c22[_0x42b2fc(0x262)]===_0x42b2fc(0x2a0)&&_0x2f0db3===!![]&&(_0x40c6c4[_0x42b2fc(0x13c)]&&(_0x40c6c4[_0x42b2fc(0x144)][_0x42b2fc(0x12a)]('Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.'),abortExitTimer(_0x40c6c4)),!_0x40c6c4[_0x42b2fc(0x164)]&&_0x40c6c4[_0x42b2fc(0x20e)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x40c6c4,!![]));}async function runGeminiAnalysis(_0xb20fb2,_0x55ff0e=''){const _0x83da47=a0_0x1495bb;if(!_0xb20fb2['geminiModel'])return;if(_0xb20fb2['eventHistory']['length']===0x0)return;const _0x36044c=_0xb20fb2[_0x83da47(0x14b)][_0x83da47(0x138)](0x0,0xf),_0x3e2a8a=await getWeatherContext(_0xb20fb2),_0x51813b=_0xb20fb2[_0x83da47(0x20e)],_0x1a6bfb=PERSONA_MAPPING[_0xb20fb2[_0x83da47(0x2fb)][_0x83da47(0x187)]||'generic'],_0x1c8f90=_0xb20fb2[_0x83da47(0x2fb)]['livingContext']||_0x83da47(0x245);let _0x104c03=_0x83da47(0x1e2);try{const _0x51fc76=await _0xb20fb2['getStateAsync'](_0x83da47(0x2d3));if(_0x51fc76&&_0x51fc76[_0x83da47(0x298)])_0x104c03=_0x51fc76[_0x83da47(0x298)];}catch(_0x1f1a3d){}let _0xd623b=![];try{const _0x261c72=await _0xb20fb2[_0x83da47(0x1a0)](_0x83da47(0x2b6));if(_0x261c72&&_0x261c72[_0x83da47(0x298)])_0xd623b=!![];}catch(_0x29b23b){}const _0x1414ec='\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20'+_0x1a6bfb+'.\x0a\x20\x20\x20\x20KONTEXT:\x20'+_0x1c8f90+_0x83da47(0x2ba)+_0x51813b+'.\x0a\x20\x20\x20\x20WETTER:\x20'+_0x3e2a8a+_0x83da47(0x2dc)+(_0x55ff0e||'Keiner')+'.\x0a\x20\x20\x20\x20ANWESENHEITS_STATUS:\x20'+(_0xb20fb2[_0x83da47(0x164)]?_0x83da47(0x224):'ABWESEND')+_0x83da47(0x152)+_0x104c03+'.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20'+JSON[_0x83da47(0x30e)](_0x36044c)+_0x83da47(0x135);try{const _0x33f8fb=await _0xb20fb2[_0x83da47(0x222)][_0x83da47(0x295)](_0x1414ec),_0x57b8a0=_0x33f8fb[_0x83da47(0x2c0)][_0x83da47(0x24e)]()[_0x83da47(0x1e9)](/```json|```/g,'')[_0x83da47(0x2e3)](),_0x4f5dd9=JSON['parse'](_0x57b8a0);await _0xb20fb2['setStateAsync']('analysis.lastResult',{'val':JSON['stringify'](_0x4f5dd9),'ack':!![]});_0x4f5dd9[_0x83da47(0x17c)]&&await _0xb20fb2[_0x83da47(0x1b2)](_0x83da47(0x1d0),{'val':_0x4f5dd9[_0x83da47(0x17c)],'ack':!![]});const _0x427e4a={'timestamp':Date[_0x83da47(0x2f3)](),'id':Date[_0x83da47(0x2f3)]()['toString'](),'analysis':{'activity':{'summary':_0x4f5dd9['summary']||_0x83da47(0x250),'isAlert':_0x4f5dd9['isAlert']||![],'alertReason':_0x4f5dd9[_0x83da47(0x283)]},'comfort':{'automationProposal':_0x4f5dd9[_0x83da47(0x302)]}}};await updateAnalysisHistory(_0xb20fb2,_0x427e4a);const _0x56d3bb=_0x4f5dd9[_0x83da47(0x148)]||![];_0x56d3bb!==_0xb20fb2[_0x83da47(0x26a)]&&(await _0xb20fb2[_0x83da47(0x1b2)](_0x83da47(0x16c),{'val':_0x56d3bb,'ack':!![]}),_0xb20fb2['lastAlertState']=_0x56d3bb,_0x56d3bb&&(await _0xb20fb2['setStateAsync'](_0x83da47(0x254),{'val':_0x4f5dd9[_0x83da47(0x283)],'ack':!![]}),sendNotification(_0xb20fb2,_0x83da47(0x1ef)+_0x4f5dd9[_0x83da47(0x283)],![],_0x4f5dd9['isEmergency']))),_0x4f5dd9[_0x83da47(0x302)]&&_0x4f5dd9[_0x83da47(0x302)]['detected']&&_0x4f5dd9['automationProposal'][_0x83da47(0x26d)]&&(_0xb20fb2[_0x83da47(0x144)]['info']('ü§ñ\x20BUTLER\x20PROPOSAL:\x20'+_0x4f5dd9['automationProposal'][_0x83da47(0x317)]),await _0xb20fb2[_0x83da47(0x1b2)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0xb20fb2[_0x83da47(0x1b2)]('analysis.automation.description',{'val':_0x4f5dd9[_0x83da47(0x302)][_0x83da47(0x317)],'ack':!![]}),await _0xb20fb2[_0x83da47(0x1b2)](_0x83da47(0x202),{'val':_0x4f5dd9[_0x83da47(0x302)]['targetId'],'ack':!![]}),await _0xb20fb2[_0x83da47(0x1b2)]('analysis.automation.targetValue',{'val':JSON[_0x83da47(0x30e)](_0x4f5dd9[_0x83da47(0x302)][_0x83da47(0x260)]),'ack':!![]}),_0xd623b&&(_0xb20fb2[_0x83da47(0x144)][_0x83da47(0x12a)](_0x83da47(0x146)+_0x4f5dd9[_0x83da47(0x302)]['targetId']+_0x83da47(0x2b4)),await executeAutomationAction(_0xb20fb2)));}catch(_0x4a881f){_0xb20fb2[_0x83da47(0x144)]['error']('Gemini\x20Analysis\x20Error:\x20'+_0x4a881f[_0x83da47(0x33a)]);}}function installPythonDependencies(_0xf08204){const _0x9b915=a0_0x1495bb;if(_0xf08204[_0x9b915(0x147)])return;_0xf08204[_0x9b915(0x147)]=!![];const _0x206906=path['join'](__dirname,_0x9b915(0x31d),_0x9b915(0x180));_0xf08204[_0x9b915(0x144)]['info'](_0x9b915(0x12f)+_0x206906+_0x9b915(0x2b4)),stopPythonService(_0xf08204);const _0xc5ecd1=_0x9b915(0x2bb)+_0x206906+_0x9b915(0x235);exec(_0xc5ecd1,(_0x356a78,_0x1a9ae2,_0xa42688)=>{const _0x88db91=_0x9b915,_0x2ae3cc=_0xa42688&&_0xa42688[_0x88db91(0x1bd)](_0x88db91(0x232))||_0x356a78&&_0x356a78[_0x88db91(0x33a)][_0x88db91(0x1bd)](_0x88db91(0x232));if(_0x2ae3cc){_0xf08204['log'][_0x88db91(0x322)](_0x88db91(0x2f4)),exec(_0x88db91(0x337),(_0x1684ca,_0x5f5cf9,_0x156ea9)=>{const _0x2b5962=_0x88db91;_0x1684ca?(_0xf08204[_0x2b5962(0x144)][_0x2b5962(0x32f)](_0x2b5962(0x19c)),_0xf08204[_0x2b5962(0x144)][_0x2b5962(0x32f)](_0x2b5962(0x252)),_0xf08204[_0x2b5962(0x147)]=![]):(_0xf08204[_0x2b5962(0x144)][_0x2b5962(0x12a)](_0x2b5962(0x2cf)),exec(_0x2b5962(0x2bb)+_0x206906+_0x2b5962(0x1d6),(_0x4e12a4,_0x417ce4,_0x5c02f4)=>{const _0x120229=_0x2b5962;_0x4e12a4?_0xf08204[_0x120229(0x144)][_0x120229(0x32f)]('‚ùå\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20'+_0x4e12a4['message']):(_0xf08204[_0x120229(0x144)][_0x120229(0x12a)]('‚úÖ\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...'),startPythonService(_0xf08204)),_0xf08204['dependencyInstallInProgress']=![];}));});return;}_0xf08204['dependencyInstallInProgress']=![],_0x356a78?(_0xf08204[_0x88db91(0x144)]['error'](_0x88db91(0x16a)),_0xf08204['log'][_0x88db91(0x32f)](_0x88db91(0x1b8)+(_0xa42688||_0x356a78['message']))):(_0xf08204['log'][_0x88db91(0x12a)](_0x88db91(0x335)),startPythonService(_0xf08204));});}function sendToPython(_0x4b111f,_0x27b8b4,_0x25e223={}){const _0x59f9df=a0_0x1495bb;if(!_0x4b111f['pythonProcess']||!_0x4b111f[_0x59f9df(0x23d)][_0x59f9df(0x1f3)]['writable'])return;const _0x463bb9=JSON[_0x59f9df(0x30e)]({'command':_0x27b8b4,..._0x25e223});try{_0x4b111f[_0x59f9df(0x23d)]['stdin'][_0x59f9df(0x30f)](_0x463bb9+'\x0a');}catch(_0x39fa6e){_0x4b111f[_0x59f9df(0x144)][_0x59f9df(0x32f)](_0x59f9df(0x2c6)+_0x39fa6e[_0x59f9df(0x33a)]);}}function runPythonHealthCheck(_0x174cf9){const _0x377171=a0_0x1495bb;if(!_0x174cf9[_0x377171(0x1b1)]||_0x174cf9[_0x377171(0x1b1)][_0x377171(0x1c6)]<0x2){_0x174cf9[_0x377171(0x144)][_0x377171(0x12a)]('Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.');return;}const _0x38e66c=_0x174cf9[_0x377171(0x1b1)]['map'](_0x27f173=>{const _0x3a56b2=_0x377171,_0x51548c=(_0x27f173[_0x3a56b2(0x237)]||'')[_0x3a56b2(0x2e7)]();return ACTIVITY_LEVEL_MAP[_0x51548c]||0x32;});_0x174cf9[_0x377171(0x144)][_0x377171(0x12a)]('Guardian:\x20Sending\x20'+_0x38e66c[_0x377171(0x1c6)]+_0x377171(0x253)),sendToPython(_0x174cf9,'ANALYZE_TREND',{'values':_0x38e66c,'tag':_0x377171(0x1c5)});}function handlePythonResult(_0x3b336a,_0x24ca2b){const _0x39ad88=a0_0x1495bb;if(_0x24ca2b[_0x39ad88(0x262)]===_0x39ad88(0x281))_0x3b336a['log'][_0x39ad88(0x31b)](_0x39ad88(0x22e));else{if(_0x24ca2b[_0x39ad88(0x262)]===_0x39ad88(0x1bb)){const {tag:_0x560231,diagnosis:_0x105cef,change_percent:_0x4b2fc1}=_0x24ca2b['payload'];_0x3b336a['log'][_0x39ad88(0x12a)](_0x39ad88(0x1f4)+_0x560231+_0x39ad88(0x287)+_0x105cef+'\x20('+_0x4b2fc1+'%)'),_0x3b336a['setStateAsync'](_0x39ad88(0x2ff),{'val':_0x105cef,'ack':!![]}),_0x3b336a[_0x39ad88(0x1b2)](_0x39ad88(0x273),{'val':_0x4b2fc1,'ack':!![]});}else{if(_0x24ca2b[_0x39ad88(0x262)]===_0x39ad88(0x208)){const {success:_0x135f4f,details:_0x2239b6}=_0x24ca2b['payload'];_0x135f4f?(_0x3b336a[_0x39ad88(0x144)][_0x39ad88(0x12a)]('‚úÖ\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20'+_0x2239b6),_0x3b336a['setStateAsync'](_0x39ad88(0x1de),{'val':_0x39ad88(0x178)+new Date()[_0x39ad88(0x128)]()+'\x20('+_0x2239b6+')','ack':!![]})):(_0x3b336a['log'][_0x39ad88(0x32f)](_0x39ad88(0x267)+(_0x2239b6||_0x39ad88(0x197))),_0x3b336a[_0x39ad88(0x1b2)](_0x39ad88(0x1de),{'val':_0x39ad88(0x2b2)+_0x2239b6,'ack':!![]}));}}}}function startPythonService(_0x11d023){const _0x2e7421=a0_0x1495bb;try{const _0x2c58ec=path[_0x2e7421(0x306)](__dirname,_0x2e7421(0x31d),_0x2e7421(0x28b));_0x11d023[_0x2e7421(0x144)][_0x2e7421(0x12a)]('üêç\x20Starting\x20Python\x20Sidecar:\x20'+_0x2c58ec),_0x11d023[_0x2e7421(0x23d)]=spawn(_0x2e7421(0x2d6),[_0x2c58ec]),_0x11d023[_0x2e7421(0x23d)][_0x2e7421(0x31c)]['on'](_0x2e7421(0x2a4),_0xe8f559=>{const _0x1c43a1=_0x2e7421,_0x585404=_0xe8f559['toString']()[_0x1c43a1(0x1e4)]('\x0a');_0x585404[_0x1c43a1(0x2da)](_0x26f6e4=>{const _0xf21106=_0x1c43a1,_0x20d579=_0x26f6e4[_0xf21106(0x2e3)]();if(!_0x20d579)return;if(_0x20d579['startsWith']('[LOG]'))_0x11d023[_0xf21106(0x144)]['debug'](_0xf21106(0x310)+_0x20d579[_0xf21106(0x1fc)](0x5)[_0xf21106(0x2e3)]());else{if(_0x20d579[_0xf21106(0x311)](_0xf21106(0x1d1)))try{const _0x2076e1=JSON[_0xf21106(0x2c4)](_0x20d579['substring'](0x8)[_0xf21106(0x2e3)]());handlePythonResult(_0x11d023,_0x2076e1);}catch(_0x423dd2){_0x11d023[_0xf21106(0x144)]['warn'](_0xf21106(0x1d3)+_0x20d579);}}(_0x20d579[_0xf21106(0x1bd)](_0xf21106(0x2b0))||_0x20d579[_0xf21106(0x1bd)](_0xf21106(0x1fb))||_0x20d579[_0xf21106(0x1bd)]('ML-Libs\x20fehlen'))&&(_0x11d023[_0xf21106(0x144)][_0xf21106(0x322)]('‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...'),installPythonDependencies(_0x11d023));});}),_0x11d023[_0x2e7421(0x23d)][_0x2e7421(0x226)]['on'](_0x2e7421(0x2a4),_0x2ae49f=>{const _0xfc97cc=_0x2e7421,_0x3547e4=_0x2ae49f[_0xfc97cc(0x2f6)]()[_0xfc97cc(0x2e3)]();_0x11d023[_0xfc97cc(0x144)]['error'](_0xfc97cc(0x308)+_0x3547e4);}),_0x11d023['pythonProcess']['on'](_0x2e7421(0x196),_0x582960=>{const _0x1c7842=_0x2e7421;_0x11d023[_0x1c7842(0x144)][_0x1c7842(0x12a)](_0x1c7842(0x2cb)+_0x582960),_0x11d023[_0x1c7842(0x23d)]=null;}),_0x11d023[_0x2e7421(0x23d)]['on']('error',_0x47964b=>{const _0x461ad2=_0x2e7421;_0x11d023[_0x461ad2(0x144)][_0x461ad2(0x322)]('[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20'+_0x47964b[_0x461ad2(0x33a)]);});}catch(_0x2fc8dd){_0x11d023[_0x2e7421(0x144)]['error'](_0x2e7421(0x206)+_0x2fc8dd[_0x2e7421(0x33a)]);}}function stopPythonService(_0x4b2cd6){const _0xe2ad6=a0_0x1495bb;if(_0x4b2cd6[_0xe2ad6(0x23d)]){_0x4b2cd6['log'][_0xe2ad6(0x12a)]('üêç\x20Stopping\x20Python\x20Sidecar...');try{_0x4b2cd6[_0xe2ad6(0x23d)][_0xe2ad6(0x2ea)]();}catch(_0x1a7cb4){_0x4b2cd6[_0xe2ad6(0x144)]['warn']('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x1a7cb4['message']);}_0x4b2cd6[_0xe2ad6(0x23d)]=null;}}class CogniLiving extends utils[a0_0x1495bb(0x296)]{constructor(_0x5d8ab7){const _0x299400=a0_0x1495bb;super({..._0x5d8ab7,'name':'cogni-living'}),this['eventHistory']=[],this['analysisHistory']=[],this['feedbackHistory']=[],this['rawEventLog']=[],this[_0x299400(0x1b1)]=[],this[_0x299400(0x282)]={},this[_0x299400(0x1f9)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x299400(0x164)]=!![],this[_0x299400(0x13c)]=null,this[_0x299400(0x25e)]=null,this[_0x299400(0x216)]=![],this[_0x299400(0x1d9)]=null,this[_0x299400(0x222)]=null,this[_0x299400(0x20e)]=SYSTEM_MODES[_0x299400(0x1cf)],this['isProVersion']=![],this[_0x299400(0x26a)]=![],this[_0x299400(0x189)]=_0x299400(0x161),this[_0x299400(0x24b)]=null,this[_0x299400(0x2d4)]=null,this[_0x299400(0x21b)]=null,this[_0x299400(0x1c3)]=null,this[_0x299400(0x12c)]=null,this['pythonProcess']=null,this[_0x299400(0x147)]=![],this['on'](_0x299400(0x1b0),this[_0x299400(0x183)][_0x299400(0x22d)](this)),this['on'](_0x299400(0x19b),this[_0x299400(0x13d)][_0x299400(0x22d)](this)),this['on'](_0x299400(0x22b),this[_0x299400(0x17a)]['bind'](this)),this['on'](_0x299400(0x33a),this[_0x299400(0x1eb)][_0x299400(0x22d)](this));}async['onReady'](){const _0x5016bb=a0_0x1495bb;this[_0x5016bb(0x144)][_0x5016bb(0x12a)](_0x5016bb(0x314)+this['version']+_0x5016bb(0x1d5)),await initZombies(this),this['config'][_0x5016bb(0x26e)]=this[_0x5016bb(0x2fb)][_0x5016bb(0x26e)]||'';try{this[_0x5016bb(0x1fe)]=await checkLicense(this,this[_0x5016bb(0x2fb)][_0x5016bb(0x26e)]);}catch(_0x2374d7){}if(!this[_0x5016bb(0x2fb)]['inactivityThresholdHours']||this[_0x5016bb(0x2fb)][_0x5016bb(0x159)]<0.1)this[_0x5016bb(0x2fb)][_0x5016bb(0x159)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config']['geminiApiKey'])try{this[_0x5016bb(0x1d9)]=new GoogleGenerativeAI(this['config'][_0x5016bb(0x240)]),this[_0x5016bb(0x222)]=this[_0x5016bb(0x1d9)][_0x5016bb(0x32a)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5016bb(0x127)}}),this[_0x5016bb(0x144)][_0x5016bb(0x12a)](_0x5016bb(0x134));}catch(_0x2336ee){this['log'][_0x5016bb(0x32f)](_0x5016bb(0x293)+_0x2336ee['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates']('analysis.trigger'),this[_0x5016bb(0x153)](LTM_DP_TRIGGER_DIGEST),this[_0x5016bb(0x153)](_0x5016bb(0x2df)),this[_0x5016bb(0x153)]('analysis.triggerBriefing'),this[_0x5016bb(0x153)](_0x5016bb(0x2ef)),this[_0x5016bb(0x153)]('analysis.automation.autoApply'),this[_0x5016bb(0x153)](_0x5016bb(0x1a6)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x5016bb(0x24b)])clearInterval(this[_0x5016bb(0x24b)]);const _0x2f025f=this[_0x5016bb(0x2fb)][_0x5016bb(0x2e1)]||0xf;_0x2f025f>0x0&&(this['log'][_0x5016bb(0x12a)](_0x5016bb(0x330)+_0x2f025f+'\x20min).'),this[_0x5016bb(0x24b)]=setInterval(()=>{runAutopilot(this);},_0x2f025f*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x8b6aa9=_0x5016bb;this[_0x8b6aa9(0x23d)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x1495bb(0x17a)](_0x59b55f){const _0x55459d=a0_0x1495bb;if(this[_0x55459d(0x24b)])clearInterval(this[_0x55459d(0x24b)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x55459d(0x1c3)]);if(this['ltmJob'])this['ltmJob'][_0x55459d(0x234)]();if(this[_0x55459d(0x21b)])this[_0x55459d(0x21b)][_0x55459d(0x234)]();if(this[_0x55459d(0x12c)])this[_0x55459d(0x12c)][_0x55459d(0x234)]();if(this[_0x55459d(0x13c)])clearTimeout(this[_0x55459d(0x13c)]);if(this[_0x55459d(0x25e)])clearTimeout(this[_0x55459d(0x25e)]);stopPythonService(this),_0x59b55f();}async[a0_0x1495bb(0x13d)](_0x335c1e,_0x195cfe){const _0x5a1976=a0_0x1495bb;if(!_0x195cfe)return;if(_0x335c1e[_0x5a1976(0x1bd)](_0x5a1976(0x1a1))&&_0x335c1e[_0x5a1976(0x28a)](_0x5a1976(0x27e))&&_0x195cfe['val']){await handleTelegramResponse(this,_0x195cfe['val']);return;}if(_0x335c1e===this[_0x5a1976(0x221)]+'.'+SYSTEM_DP_MODE){_0x195cfe[_0x5a1976(0x298)]&&Object[_0x5a1976(0x313)](SYSTEM_MODES)[_0x5a1976(0x1bd)](_0x195cfe['val'])&&(this[_0x5a1976(0x20e)]=_0x195cfe['val'],_0x195cfe[_0x5a1976(0x298)]===SYSTEM_MODES[_0x5a1976(0x171)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x195cfe[_0x5a1976(0x1b9)])this['setState'](_0x335c1e,{'val':this[_0x5a1976(0x20e)],'ack':!![]});return;}if(!_0x195cfe['ack']){_0x335c1e[_0x5a1976(0x1bd)]('analysis.trigger')&&_0x195cfe[_0x5a1976(0x298)]&&(this[_0x5a1976(0x328)](_0x335c1e,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x335c1e['includes']('triggerDailyDigest')&&_0x195cfe['val']){this['setState'](_0x335c1e,{'val':![],'ack':!![]});if(this[_0x5a1976(0x1fe)])createDailyDigest(this);}_0x335c1e[_0x5a1976(0x1bd)](_0x5a1976(0x2a6))&&_0x195cfe[_0x5a1976(0x298)]&&(this[_0x5a1976(0x328)](_0x335c1e,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x335c1e[_0x5a1976(0x1bd)](_0x5a1976(0x25f))&&_0x195cfe['val']&&(this['setState'](_0x335c1e,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x335c1e['includes'](_0x5a1976(0x1a6))&&_0x195cfe[_0x5a1976(0x298)]){this[_0x5a1976(0x328)](_0x335c1e,{'val':![],'ack':!![]});if(!this[_0x5a1976(0x1fe)]){this[_0x5a1976(0x144)][_0x5a1976(0x322)](_0x5a1976(0x29a));return;}try{const _0x55c4b2=await this[_0x5a1976(0x1a0)](_0x5a1976(0x1f5));if(_0x55c4b2&&_0x55c4b2[_0x5a1976(0x298)]){const _0x1d9154=JSON[_0x5a1976(0x2c4)](_0x55c4b2[_0x5a1976(0x298)]);this[_0x5a1976(0x144)][_0x5a1976(0x12a)]('üß†\x20Triggering\x20Security\x20Training\x20with\x20'+_0x1d9154['length']+_0x5a1976(0x263)),this[_0x5a1976(0x1b2)]('analysis.training.status',{'val':'Training\x20started...','ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x1d9154});}else this['log'][_0x5a1976(0x322)](_0x5a1976(0x1a8)),this[_0x5a1976(0x1b2)](_0x5a1976(0x1de),{'val':_0x5a1976(0x323),'ack':!![]});}catch(_0x464202){this[_0x5a1976(0x144)]['error'](_0x5a1976(0x1d7)+_0x464202[_0x5a1976(0x33a)]);}}return;}if(this[_0x5a1976(0x2fb)][_0x5a1976(0x198)]&&this[_0x5a1976(0x2fb)][_0x5a1976(0x198)][_0x5a1976(0x1bd)](_0x335c1e)){await checkWifiPresence(this);return;}const _0x5a4a56=(this[_0x5a1976(0x2fb)][_0x5a1976(0x133)]||[])[_0x5a1976(0x2f0)](_0x111a59=>_0x111a59['id']===_0x335c1e);if(_0x5a4a56)processSensorEvent(this,_0x335c1e,_0x195cfe,_0x5a4a56);}async[a0_0x1495bb(0x1eb)](_0x1da0bc){const _0x5f13f5=a0_0x1495bb;if(typeof _0x1da0bc==='object'&&_0x1da0bc[_0x5f13f5(0x33a)])try{if(_0x1da0bc['command']===_0x5f13f5(0x1d8)){const _0x46b7c7=_0x1da0bc['message'][_0x5f13f5(0x2de)]||this['config'][_0x5f13f5(0x240)];if(!_0x46b7c7)return this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':![],'message':_0x5f13f5(0x158)},_0x1da0bc[_0x5f13f5(0x294)]);try{const _0x20755f=new GoogleGenerativeAI(_0x46b7c7),_0x4b510a=_0x20755f[_0x5f13f5(0x32a)]({'model':GEMINI_MODEL}),_0xd1adcf=await _0x4b510a[_0x5f13f5(0x295)]('Say\x20Hello'),_0x34a0b3=await _0xd1adcf['response'],_0x41f97a=_0x34a0b3[_0x5f13f5(0x24e)]();this[_0x5f13f5(0x2d2)](_0x1da0bc['from'],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':!![],'message':_0x5f13f5(0x23f)+_0x41f97a[_0x5f13f5(0x1fc)](0x0,0x14)+'...'},_0x1da0bc[_0x5f13f5(0x294)]);}catch(_0x57e4a1){this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':![],'message':_0x5f13f5(0x2af)+_0x57e4a1[_0x5f13f5(0x33a)]},_0x1da0bc['callback']);}}else{if(_0x1da0bc[_0x5f13f5(0x2f1)]===_0x5f13f5(0x1e7)){const _0x1ef1bb=await getWeatherContext(this),_0x50f7a8=await getCalendarContext(this);this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':!![],'weather':_0x1ef1bb,'calendar':_0x50f7a8},_0x1da0bc['callback']);}else{if(_0x1da0bc[_0x5f13f5(0x2f1)]==='testNotification'){}else{if(_0x1da0bc[_0x5f13f5(0x2f1)]===_0x5f13f5(0x255)){if(!this['isProVersion'])return this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':![],'isPro':![]},_0x1da0bc['callback']);let _0x576276={'status':_0x5f13f5(0x268),'details':'','lastCheck':0x0};try{_0x576276[_0x5f13f5(0x13f)]=(await this[_0x5f13f5(0x1a0)](LTM_DP_DRIFT_STATUS))[_0x5f13f5(0x298)],_0x576276[_0x5f13f5(0x236)]=(await this[_0x5f13f5(0x1a0)](LTM_DP_DRIFT_DETAILS))[_0x5f13f5(0x298)],_0x576276[_0x5f13f5(0x1c9)]=(await this[_0x5f13f5(0x1a0)](LTM_DP_DRIFT_LAST_CHECK))[_0x5f13f5(0x298)];}catch(_0x1875b3){}const _0x5b15a1=this[_0x5f13f5(0x132)]||[];this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x576276,'analysisHistory':_0x5b15a1},_0x1da0bc[_0x5f13f5(0x294)]);}else{if(_0x1da0bc[_0x5f13f5(0x2f1)]===_0x5f13f5(0x2dd)){const _0x1d2983=this[_0x5f13f5(0x1b1)][_0x5f13f5(0x1c6)],_0x5ace6d=new Date(),_0x1f57a4=new Date(_0x5ace6d['getFullYear'](),_0x5ace6d[_0x5f13f5(0x214)](),_0x5ace6d[_0x5f13f5(0x1fa)]())[_0x5f13f5(0x1f6)](),_0x1d5570=this['rawEventLog'][_0x5f13f5(0x1ba)](_0x42d615=>new Date(_0x42d615[_0x5f13f5(0x2ae)])[_0x5f13f5(0x1f6)]()>_0x1f57a4)[_0x5f13f5(0x1c6)],_0x474194=new Array(0x18)[_0x5f13f5(0x1db)](0x0);this[_0x5f13f5(0x18d)][_0x5f13f5(0x2da)](_0x14fbc9=>{const _0x4eac97=_0x5f13f5,_0x513c16=new Date(_0x14fbc9[_0x4eac97(0x2ae)]);if(_0x513c16[_0x4eac97(0x1f6)]()>_0x1f57a4)_0x474194[_0x513c16['getHours']()]++;});let _0x3b8c1e={'status':'N/A'};try{_0x3b8c1e[_0x5f13f5(0x13f)]=(await this[_0x5f13f5(0x1a0)](LTM_DP_DRIFT_STATUS))[_0x5f13f5(0x298)];}catch(_0x12112e){}let _0x486d9d='';try{const _0xf8effb=await this[_0x5f13f5(0x1a0)]('system.presenceWho');_0x486d9d=_0xf8effb?_0xf8effb[_0x5f13f5(0x298)]:'';}catch(_0x1ecbd9){}let _0x10720a=null;!this[_0x5f13f5(0x222)]&&(_0x10720a=this['config']['geminiApiKey']?_0x5f13f5(0x24a):_0x5f13f5(0x320));let _0x10d8ea={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x12394d=await this[_0x5f13f5(0x1a0)]('analysis.automation.patternDetected'),_0x2c75ee=await this[_0x5f13f5(0x1a0)]('analysis.automation.description'),_0x235d8f=await this[_0x5f13f5(0x1a0)](_0x5f13f5(0x202)),_0x1f5c6f=await this['getStateAsync'](_0x5f13f5(0x154)),_0x97d74e=await this['getStateAsync'](_0x5f13f5(0x2b6));_0x12394d&&_0x12394d[_0x5f13f5(0x298)]&&(_0x10d8ea['detected']=!![],_0x10d8ea[_0x5f13f5(0x317)]=_0x2c75ee?_0x2c75ee['val']:'',_0x10d8ea['targetId']=_0x235d8f?_0x235d8f[_0x5f13f5(0x298)]:'',_0x10d8ea['targetValue']=_0x1f5c6f?_0x1f5c6f[_0x5f13f5(0x298)]:''),_0x10d8ea[_0x5f13f5(0x2aa)]=_0x97d74e?!!_0x97d74e[_0x5f13f5(0x298)]:![];}catch(_0x134362){}this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc['command'],{'success':!![],'eventHistory':this['eventHistory'][_0x5f13f5(0x138)](0x0,0xf),'stats':{'digestCount':_0x1d2983,'eventCountToday':_0x1d5570,'hourlyActivity':_0x474194,'driftStatus':_0x3b8c1e[_0x5f13f5(0x13f)],'isPresent':this[_0x5f13f5(0x164)],'presenceWho':_0x486d9d,'minDays':this[_0x5f13f5(0x2fb)][_0x5f13f5(0x1fd)]||0x7,'stbDays':this[_0x5f13f5(0x2fb)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x5f13f5(0x2fb)]['ltmLtbWindowDays']||0x3c,'systemError':_0x10720a},'automation':_0x10d8ea},_0x1da0bc[_0x5f13f5(0x294)]);}else{if(_0x1da0bc[_0x5f13f5(0x2f1)]==='getEnums'){const _0x2faf83=await this['getForeignObjectsAsync'](_0x5f13f5(0x26f),'enum'),_0x80b53d=[];if(_0x2faf83)for(const _0x3ec0e0 in _0x2faf83){const _0x1562fb=_0x2faf83[_0x3ec0e0],_0x122f9a=(_0x1562fb[_0x5f13f5(0x303)]&&typeof _0x1562fb[_0x5f13f5(0x303)][_0x5f13f5(0x23c)]===_0x5f13f5(0x19d)?_0x1562fb[_0x5f13f5(0x303)][_0x5f13f5(0x23c)]['de']:_0x1562fb[_0x5f13f5(0x303)][_0x5f13f5(0x23c)])||_0x1562fb[_0x5f13f5(0x303)][_0x5f13f5(0x23c)];_0x80b53d[_0x5f13f5(0x2d9)]({'id':_0x3ec0e0,'name':_0x122f9a});}this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc['command'],{'success':!![],'enums':_0x80b53d},_0x1da0bc[_0x5f13f5(0x294)]);}else{if(_0x1da0bc[_0x5f13f5(0x2f1)]==='scanDevices')try{const _0xca18e2=await scanForDevices(this,_0x1da0bc[_0x5f13f5(0x33a)]||{});this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':!![],'devices':_0xca18e2},_0x1da0bc[_0x5f13f5(0x294)]);}catch(_0x185807){this[_0x5f13f5(0x2d2)](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':![],'error':_0x185807[_0x5f13f5(0x33a)]},_0x1da0bc[_0x5f13f5(0x294)]);}else{if(_0x1da0bc['command']===_0x5f13f5(0x324)){const _0xe001d0=_0x1da0bc[_0x5f13f5(0x33a)][_0x5f13f5(0x191)];if(!_0xe001d0)return this['sendTo'](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':![],'error':_0x5f13f5(0x23b)},_0x1da0bc[_0x5f13f5(0x294)]);const _0x4a049d=await getCalendarNames(this,_0xe001d0);this['sendTo'](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':!![],'names':_0x4a049d},_0x1da0bc['callback']);}else{if(_0x1da0bc[_0x5f13f5(0x2f1)]===_0x5f13f5(0x299)){const {targetId:_0x103a4b,targetValue:_0x4e8843}=_0x1da0bc[_0x5f13f5(0x33a)];this[_0x5f13f5(0x144)][_0x5f13f5(0x12a)](_0x5f13f5(0x13b)+_0x103a4b+_0x5f13f5(0x14f)+_0x4e8843),await this[_0x5f13f5(0x1b2)](_0x5f13f5(0x2a1),{'val':!![],'ack':!![]}),await this[_0x5f13f5(0x1b2)](_0x5f13f5(0x297),{'val':'SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20'+_0x103a4b,'ack':!![]}),await this[_0x5f13f5(0x1b2)]('analysis.automation.targetId',{'val':_0x103a4b,'ack':!![]}),await this['setStateAsync'](_0x5f13f5(0x154),{'val':_0x4e8843,'ack':!![]}),this[_0x5f13f5(0x2d2)](_0x1da0bc['from'],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':!![]},_0x1da0bc[_0x5f13f5(0x294)]);}else{if(_0x1da0bc[_0x5f13f5(0x2f1)]===_0x5f13f5(0x17d)){const {historyId:_0x3bd157,rating:_0x1f9118,comment:_0x2ea861,alertReason:_0x5ad489}=_0x1da0bc[_0x5f13f5(0x33a)];_0x3bd157&&_0x1f9118?(await saveFeedback(this,{'timestamp':Date[_0x5f13f5(0x2f3)](),'historyId':_0x3bd157,'rating':_0x1f9118,'comment':_0x2ea861,'alertReason':_0x5ad489}),this['sendTo'](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc['command'],{'success':!![]},_0x1da0bc[_0x5f13f5(0x294)])):this['sendTo'](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':![],'error':_0x5f13f5(0x1a3)},_0x1da0bc[_0x5f13f5(0x294)]);}else _0x1da0bc[_0x5f13f5(0x2f1)]===_0x5f13f5(0x2f8)&&(this[_0x5f13f5(0x144)][_0x5f13f5(0x12a)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x5f13f5(0x1b2)](_0x5f13f5(0x2a1),{'val':![],'ack':!![]}),await this[_0x5f13f5(0x1b2)]('analysis.automation.description',{'val':'','ack':!![]}),this['sendTo'](_0x1da0bc['from'],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':!![]},_0x1da0bc[_0x5f13f5(0x294)]));}}}}}}}}}}catch(_0xb8e4ab){this[_0x5f13f5(0x144)]['error'](_0x5f13f5(0x2fc)+_0x1da0bc[_0x5f13f5(0x2f1)]+':\x20'+_0xb8e4ab[_0x5f13f5(0x33a)]);if(_0x1da0bc['callback'])this['sendTo'](_0x1da0bc[_0x5f13f5(0x1ed)],_0x1da0bc[_0x5f13f5(0x2f1)],{'success':![],'error':_0xb8e4ab[_0x5f13f5(0x33a)]},_0x1da0bc[_0x5f13f5(0x294)]);}}}if(require[a0_0x1495bb(0x286)]!==module)module[a0_0x1495bb(0x193)]=_0x3e5e23=>new CogniLiving(_0x3e5e23);else new CogniLiving();