const a0_0x48b8a0=a0_0xb2ad;(function(_0x240711,_0x3ae87e){const _0x139c20=a0_0xb2ad,_0x104abe=_0x240711();while(!![]){try{const _0x2cf480=parseInt(_0x139c20(0x284))/0x1*(parseInt(_0x139c20(0x324))/0x2)+parseInt(_0x139c20(0x2e2))/0x3+-parseInt(_0x139c20(0x1c2))/0x4*(parseInt(_0x139c20(0x16e))/0x5)+parseInt(_0x139c20(0x20d))/0x6+-parseInt(_0x139c20(0x1c1))/0x7*(parseInt(_0x139c20(0x2fe))/0x8)+parseInt(_0x139c20(0x228))/0x9*(-parseInt(_0x139c20(0x231))/0xa)+parseInt(_0x139c20(0x227))/0xb*(-parseInt(_0x139c20(0x17a))/0xc);if(_0x2cf480===_0x3ae87e)break;else _0x104abe['push'](_0x104abe['shift']());}catch(_0x1d4d33){_0x104abe['push'](_0x104abe['shift']());}}}(a0_0x3b5f,0x2bad8));const a0_0x3594a2=(function(){let _0x58005a=!![];return function(_0x4d7d01,_0x914811){const _0x479c2d=_0x58005a?function(){const _0x387c8c=a0_0xb2ad;if(_0x914811){const _0xcd32bd=_0x914811[_0x387c8c(0x170)](_0x4d7d01,arguments);return _0x914811=null,_0xcd32bd;}}:function(){};return _0x58005a=![],_0x479c2d;};}()),a0_0x25ed81=a0_0x3594a2(this,function(){const _0x50e325=a0_0xb2ad;return a0_0x25ed81[_0x50e325(0x1a8)]()[_0x50e325(0x2ec)](_0x50e325(0x2e3))[_0x50e325(0x1a8)]()['constructor'](a0_0x25ed81)[_0x50e325(0x2ec)](_0x50e325(0x2e3));});a0_0x25ed81();'use strict';const utils=require(a0_0x48b8a0(0x180)),{GoogleGenerativeAI}=require(a0_0x48b8a0(0x1c0)),schedule=require(a0_0x48b8a0(0x2f0)),{spawn}=require('child_process'),path=require(a0_0x48b8a0(0x24a)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x48b8a0(0x22d),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x48b8a0(0x1a4),LTM_DP_DAILY_DIGESTS=a0_0x48b8a0(0x22c),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x48b8a0(0x1bb),LTM_DP_BASELINE_STATUS=a0_0x48b8a0(0x1d7),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x48b8a0(0x186),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x48b8a0(0x1f4),SYSTEM_DP_MODE=a0_0x48b8a0(0x30a),HARD_IGNORE_TERMS=[a0_0x48b8a0(0x31c),a0_0x48b8a0(0x267),a0_0x48b8a0(0x2be),a0_0x48b8a0(0x1e5),a0_0x48b8a0(0x213),'rssi','connection',a0_0x48b8a0(0x2ae),a0_0x48b8a0(0x318),a0_0x48b8a0(0x2b5),a0_0x48b8a0(0x2e9),a0_0x48b8a0(0x278),a0_0x48b8a0(0x23c),'config_pending','dutycycle',a0_0x48b8a0(0x24f),'reachable',a0_0x48b8a0(0x1d5)],BAD_NAMES=[a0_0x48b8a0(0x2dc),a0_0x48b8a0(0x2b4),a0_0x48b8a0(0x285),a0_0x48b8a0(0x1cf),'value',a0_0x48b8a0(0x2af),'on',a0_0x48b8a0(0x1a6),'switch','position','shutter',a0_0x48b8a0(0x291),a0_0x48b8a0(0x173),a0_0x48b8a0(0x1f3),a0_0x48b8a0(0x1ea),a0_0x48b8a0(0x1d4),a0_0x48b8a0(0x1db),'temperature',a0_0x48b8a0(0x1b2),'power',a0_0x48b8a0(0x2e8),a0_0x48b8a0(0x2f2),'valve',a0_0x48b8a0(0x1d9),a0_0x48b8a0(0x204)],ADAPTER_BLACKLIST=[a0_0x48b8a0(0x1ca),a0_0x48b8a0(0x1d1),a0_0x48b8a0(0x1f2),'vis.',a0_0x48b8a0(0x214),'material.',a0_0x48b8a0(0x2ee),a0_0x48b8a0(0x28a),a0_0x48b8a0(0x1fe),a0_0x48b8a0(0x264),a0_0x48b8a0(0x212)],SYSTEM_MODES={'NORMAL':a0_0x48b8a0(0x23b),'VACATION':a0_0x48b8a0(0x271),'PARTY':'party','GUEST':a0_0x48b8a0(0x1bc)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x48b8a0(0x246)],SYSTEM_MODES[a0_0x48b8a0(0x2c0)]],PERSONA_MAPPING={'generic':a0_0x48b8a0(0x16c),'senior_aal':a0_0x48b8a0(0x2f6),'family':a0_0x48b8a0(0x332),'single_comfort':a0_0x48b8a0(0x299),'security':a0_0x48b8a0(0x254)};async function initZombies(_0x3f5c89){const _0x49d927=a0_0x48b8a0;try{const _0x3613eb=[_0x49d927(0x1e8),_0x49d927(0x1a1)];for(const _0x1f8cc5 of _0x3613eb){try{const _0x19e0f7=await _0x3f5c89[_0x49d927(0x1e0)](_0x1f8cc5);_0x19e0f7&&await _0x3f5c89[_0x49d927(0x1dc)](_0x1f8cc5);}catch(_0x4227db){}}}catch(_0x48edd3){}}async function initHistory(_0x4e5642){const _0x17fb82=a0_0x48b8a0;try{const _0x14623b=await _0x4e5642[_0x17fb82(0x2c7)]('events.history');_0x14623b&&_0x14623b[_0x17fb82(0x226)]&&(_0x4e5642[_0x17fb82(0x1da)]=JSON[_0x17fb82(0x237)](_0x14623b['val']['toString']()));}catch(_0x51c372){_0x4e5642[_0x17fb82(0x1da)]=[];}try{const _0x1d505c=await _0x4e5642[_0x17fb82(0x2c7)](_0x17fb82(0x333));if(_0x1d505c&&_0x1d505c[_0x17fb82(0x226)])_0x4e5642[_0x17fb82(0x2ad)]=JSON[_0x17fb82(0x237)](_0x1d505c['val']['toString']());}catch(_0x201ae5){_0x4e5642['analysisHistory']=[];}}async function initSystemConfig(_0x26ef52){const _0x23018e=a0_0x48b8a0;try{const _0x163cea=await _0x26ef52['getForeignObjectAsync'](_0x23018e(0x30c));_0x163cea&&_0x163cea[_0x23018e(0x23e)]&&(_0x26ef52[_0x23018e(0x296)]={'latitude':_0x163cea[_0x23018e(0x23e)][_0x23018e(0x2b3)]||0x0,'longitude':_0x163cea['common'][_0x23018e(0x2ea)]||0x0,'city':_0x163cea[_0x23018e(0x23e)][_0x23018e(0x197)]||''});}catch(_0x36affa){}}function a0_0x3b5f(){const _0x3dbbde=['json','LTM.rawEventLog','.\x20Welcome\x20home.','off','exitGraceTimer','toString','main','value','testNotification','Error\x20checking\x20WiFi:\x20','getEnums','analysis.automation.patternDetected','Keine\x20Details.','.\x20OUTPUT:\x20Nur\x20Text.','Gemini\x20Analysis\x20Error:\x20','humidity','ical.0','analysis.automation.targetId','Drift\x20Analysis','alertReason','toLowerCase','No\x20instance','devices','command','LTM.triggerDailyDigest','guest','Cogni-Living','KALENDER\x20ERROR:\x20','health','@google/generative-ai','7EGvmTc','575628uLRGsq','bind','dismissAutomation','config','.forecast.current.state','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','presenceDevices','geminiApiKey','system.','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','setObjectNotExistsAsync','calendarSelection','fenster','level','notifyTelegramRecipient','admin.','namespace','response','presence','link_quality','string','LTM.baselineStatus','generateContent','actual_temperature','eventHistory','occupancy','delObjectAsync','\x20hours.\x20Potential\x20incapacitation.','thermostat','stderr','getObjectAsync','indicator.alarm','Lernphase\x20(','notifyEmailRecipient','Aktiv\x20(','unreach','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','modeResetJob','analysis.history_debug_00','event','motion','info','cogni-living\x20adapter\x20starting\x20(v','isGracePeriodActive','Vom\x20Benutzer\x20best√§tigt\x20(OK).','pythonProcess','analysisTimer','name','info.','status','LTM.driftAnalysis.lastCheck','AI\x20Emergency\x20Status','Gast','Morning\x20Briefing\x20sent.','Error\x20in\x20onMessage\x20command\x20','driftDetails','write','unshift','pop','stringify','echarts.','.\x20ZUSATZ:\x20','shutter','members','getGenerativeModel','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','set_temperature','setState','filter','Success:\x20Compressed\x20','events.lastEvent','Health\x20&\x20Sleep\x20Analysis','NORMAL','splice','üß™\x20Simulating\x20Butler\x20Proposal:\x20','1892622THNjpH','ltmJob','isArray','Alarm','startsWith','simple-api.','lowbat','history.','weatherunderground.0','split','button','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','stdout','ltmDriftCheckIntervalHours','scanDevices','length','detected','includes','Reset\x20Sched\x20Error:\x20','Comfort\x20Summary','Sending\x20notification:\x20\x22','enum','version','TEST-PRO-KEY','light','val','253dNXdUy','1060335ptWocb','Normal','analysis.lastResult','analysisInterval','LTM.dailyDigests','0\x204\x20*\x20*\x20*','üì°\x20Hooking\x20into\x20','Kein\x20API\x20Key!','switch','10uBLhLB','Event\x20received:\x20','_calName','value.health','getDate','baselineDrift','parse','[PYTHON]\x20','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','window','normal','stick_unreach','getForeignObjectAsync','common','analysis.feedbackHistory','text','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','analysis.alertReason','analysis.automation.autoApply','WETTER\x20ERROR:\x20','analysis.comfortSummary','PARTY','notifyTelegramInstance','submitFeedback','enum.functions.*','path','.data.table','Started\x20at\x20','system.presenceWho','online','firmware','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','analysis.trigger','custom','targetId','PRIORIT√ÑT:\x20Sicherheit.','date','COGNI_CONFIRM_OK','livingContext','Deaktiviert\x20(Pro-Feature)','unload','toLocaleString','setHours','time','VACATION','systemUUID','onReady','Could\x20not\x20kill\x20Python\x20process:\x20','Trigger\x20Action\x20Now','KI-Modell\x20nicht\x20initialisiert','‚ö†Ô∏è\x20ALARM:\x20','javascript.','\x20|\x20','analysis.isAlert','scriptEnabled','map','python3','_score','analysis.health','notifyEmailInstance','Raw\x20Log','rawEventLog','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','analysis.activitySummary','vacation','üö®\x20EMERGENCY','ready','extendObjectAsync','communicate.request','\x20presence\x20devices...','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','direction','location','endsWith','indexOf','channel','scheduleJob','retry','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','push','catch','trim','stateChange','5BKJjbb','state','toISOString','find','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','\x20=\x20','flot.','KALENDER:\x20','sendTo','Subscribing\x20to\x20','notifyEmailEnabled','Activity\x20Summary','N/A','blind','instance','Target\x20ID','lastAlertState','analysis.deviationFromBaseline','systemConfig','boolean','Sleep\x20Score\x20(0-100)','Fokus\x20auf\x20Komfort.','selectedFunctionIds','analysis.health.restlessness','briefingJob','Skipped\x20(No\x20AI\x20or\x20Data)','Drift\x20Sched\x20Error:\x20','analysis.health.notes','.\x0a\x20\x20\x20\x20WETTER:\x20','...','doors','Feedback\x20saved:\x20','08:00','inactivityThresholdHours','log','\x20(Value:\x20','callback','Last\x20raw\x20event','events.history','notifyPushoverInstance','Gemini\x20Init\x20Error:\x20','analysisHistory','maintenance','brightness','Description','exitTimer','BUTLER\x20Execution\x20Error:\x20','latitude','currentposition','fault','testApiKey','timestamp','logDuplicates','Trigger\x20Digest','[PYTHON\x20ERR]\x20','cogni-living','getLtmData','getMonth','update','.NextHours.Location_1.Day_1.current.symbol_desc','GUEST','Processing\x20Status','Last\x20Result','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','daswetter.0','getStateAsync','simulateButler','door','activityLevel','isProVersion','Restlessness\x20Level','briefingEnabled','service.py','WETTER:\x20','role','Briefing\x20Sched\x20Error:\x20','cancel','uuid','ack','lights','ltmStbWindowDays','notifyTelegramEnabled','system.meta.uuid','LTM\x20Sched\x20Error:\x20','openweathermap','targetValue','targetposition','getFullYear','summary','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','daswetter','sort','242013dbtItB','(((.+)+)+)+$','temperature','accuweather',').\x20Starting\x20Timer.','COGNI_REQUEST_CALL','energy','working','longitude','analysis.isEmergency','search','fill','icons-mfd.','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','node-schedule','\x20*\x20*\x20*','setpoint','triggerBriefing','isEmergency','dailyDigests','PRIORIT√ÑT:\x20Gesundheit/AAL.','data','onStateChange','send','AI\x20Alert\x20Status','currentSystemMode','Keiner','Error:\x20','756984qLVckY','LTM','number','\x20events','Missing\x20data','analysis.automation.description','automationProposal','Scheduling\x20Morning\x20Briefing\x20for\x20','‚úÖ\x20Alles\x20OK\x20(Reset)','subscribeStates','getTime','licenseKey','system.mode','siren','system.config','Action','onUnload','Briefing\x20Error:\x20','getOverviewData','sendToAsync','description','.\x20DATEN:\x20Schlaf\x20','uuid-error','Drift\x20Status','replace','indicator','error','Urlaub','analysis.automation.triggerAction','Alert\x20Reason','scriptProblem','sleepScore','unknown','.\x20KONTEXT:\x20','isPresent','Trigger\x20Analysis','Drift\x20Details','object','134574ChQRZZ','analysis.automation.targetValue','klima','some','driftAnalysisTimer','onMessage','native','now','inactivityMonitoringEnabled','geminiModel','PRO-','forEach','minDaysForBaseline','rollladen','Fokus\x20auf\x20Familienroutinen.','analysis.analysisHistory','expire','.Summary.Current','Analysiere\x20ausgewogen.','üêç\x20Starting\x20Python\x20Sidecar:\x20','5IoGVLM','sensor','apply','System\x20Status\x20&\x20Control','from','cover','setStateAsync','weatherInstance','generic','debug','getForeignObjectsAsync','N/A\x20(Learning)','102936QbrTlb','getHours','lastCheck','sound','Target\x20Value','subscribeForeignStatesAsync','@iobroker/adapter-core','Logbook','Who\x20is\x20present?','Exit\x20Sensor\x20triggered\x20(','WETTER:\x20Keine\x20Daten\x20gefunden','triggerDailyDigest','LTM.driftAnalysis.baselineDrift','Feedback\x20Log','analysis.triggerBriefing','analysis.health.sleepScore','notifyPushoverRecipient','substring','message','enum.rooms.*','slice','.communicate.request','exports','Deviation','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','genAI','feedbackHistory','Auto\x20Apply\x20Rule','Pattern\x20Detected','city','heizung','lastIndexOf','Entry\x20detected\x20via\x20','notifyPushoverEnabled','sensorLastValues','join','warn','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','weather','events.history_debug_00','getForeignStateAsync'];a0_0x3b5f=function(){return _0x3dbbde;};return a0_0x3b5f();}async function checkLicense(_0x18b47c,_0x5997ef){const _0x773619=a0_0x48b8a0;if(!_0x5997ef)return![];_0x18b47c['systemUUID']=await getSystemUUID(_0x18b47c);if(_0x5997ef===_0x773619(0x224)||_0x5997ef[_0x773619(0x211)](_0x773619(0x32e)))return!![];return![];}async function getSystemUUID(_0x585eea){const _0x4a13c7=a0_0x48b8a0;try{const _0x314cb0=await _0x585eea[_0x4a13c7(0x23d)](_0x4a13c7(0x2d8));if(_0x314cb0&&_0x314cb0[_0x4a13c7(0x32a)]&&_0x314cb0[_0x4a13c7(0x32a)]['uuid'])return _0x314cb0[_0x4a13c7(0x32a)][_0x4a13c7(0x2d3)];return'uuid-not-found';}catch(_0x54d0a3){return _0x4a13c7(0x314);}}async function createAllObjects(_0x2701d0){const _0x3ff655=a0_0x48b8a0;await checkSystemObjects(_0x2701d0),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x24d),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x182),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x240),'read':!![],'write':![],'def':''},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)]('events.lastEvent',{'type':'state','common':{'name':_0x3ff655(0x2a9),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x1a3),'read':!![],'write':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x2aa),{'type':_0x3ff655(0x285),'common':{'name':'Event\x20History','type':_0x3ff655(0x1d6),'role':_0x3ff655(0x1a3),'read':!![],'write':![]},'native':{}}),await _0x2701d0['setObjectNotExistsAsync'](_0x3ff655(0x251),{'type':'state','common':{'name':_0x3ff655(0x321),'type':'boolean','role':_0x3ff655(0x217),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x188),{'type':_0x3ff655(0x285),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x3ff655(0x297),'role':_0x3ff655(0x217),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)]('analysis.lastResult',{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x2c2),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x1a3),'read':!![],'write':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)]('analysis.isAlert',{'type':'state','common':{'name':_0x3ff655(0x2fa),'type':_0x3ff655(0x297),'role':_0x3ff655(0x1e1),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x2eb),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x1f5),'type':_0x3ff655(0x297),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x242),{'type':'state','common':{'name':_0x3ff655(0x31b),'type':'string','role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x2701d0['setObjectNotExistsAsync'](_0x3ff655(0x270),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x28f),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x240),'read':!![],'write':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x295),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x191),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x285),'read':!![],'write':![],'def':_0x3ff655(0x290)},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x245),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x220),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)]('analysis.comfortSuggestion',{'type':_0x3ff655(0x285),'common':{'name':'Comfort\x20Suggestion','type':_0x3ff655(0x1d6),'role':'text','read':!![],'write':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x274)]('analysis.automation',{'type':_0x3ff655(0x27c),'common':{'name':'Automation\x20Proposals'},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x1ae),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x196),'type':_0x3ff655(0x297),'role':_0x3ff655(0x317),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x303),{'type':'state','common':{'name':_0x3ff655(0x2b0),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x240),'read':!![],'write':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)]('analysis.automation.suggestedAction',{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x30d),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x240),'read':!![],'write':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x1b4),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x293),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x240),'read':!![],'write':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)]('analysis.automation.targetValue',{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x17e),'type':'string','role':_0x3ff655(0x240),'read':!![],'write':![]},'native':{}}),await _0x2701d0['setObjectNotExistsAsync'](_0x3ff655(0x243),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x195),'type':_0x3ff655(0x297),'role':_0x3ff655(0x230),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x31a),{'type':'state','common':{'name':_0x3ff655(0x261),'type':_0x3ff655(0x297),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x333),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x181),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x1a3),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x23f),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x187),'type':'string','role':_0x3ff655(0x1a3),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2701d0[_0x3ff655(0x274)](_0x3ff655(0x26b),{'type':_0x3ff655(0x27c),'common':{'name':_0x3ff655(0x209)},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x189),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x298),'type':'number','role':_0x3ff655(0x234),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x29b),{'type':_0x3ff655(0x285),'common':{'name':_0x3ff655(0x2cc),'type':_0x3ff655(0x1d6),'role':_0x3ff655(0x240),'read':!![],'write':![],'def':'none'},'native':{}}),await _0x2701d0[_0x3ff655(0x1cc)](_0x3ff655(0x29f),{'type':'state','common':{'name':'Health\x20Notes','type':_0x3ff655(0x1d6),'role':'text','read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x2701d0),await checkLtmDriftObjects(_0x2701d0);}async function checkSystemObjects(_0x504801){const _0x48a5f7=a0_0x48b8a0;await _0x504801[_0x48a5f7(0x274)]('system',{'type':_0x48a5f7(0x27c),'common':{'name':_0x48a5f7(0x171)},'native':{}}),await _0x504801['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x48a5f7(0x285),'common':{'name':'System\x20Mode','type':'string','role':_0x48a5f7(0x285),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x48a5f7(0x20a)]]:_0x48a5f7(0x229),[SYSTEM_MODES['VACATION']]:_0x48a5f7(0x319),[SYSTEM_MODES[_0x48a5f7(0x246)]]:'Party',[SYSTEM_MODES[_0x48a5f7(0x2c0)]]:_0x48a5f7(0x1f6)}},'native':{}});}async function checkLtmObjects(_0x285771){const _0x3be5fc=a0_0x48b8a0;await _0x285771[_0x3be5fc(0x274)](_0x3be5fc(0x2ff),{'type':_0x3be5fc(0x27c),'common':{'name':_0x3be5fc(0x2ff)},'native':{}}),await _0x285771['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x3be5fc(0x26d),'type':_0x3be5fc(0x1d6),'role':'json','read':!![],'write':![]},'native':{}}),await _0x285771[_0x3be5fc(0x274)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':'Daily\x20Digests','type':_0x3be5fc(0x1d6),'role':_0x3be5fc(0x1a3),'read':!![],'write':![]},'native':{}}),await _0x285771['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x3be5fc(0x285),'common':{'name':_0x3be5fc(0x2c1),'type':_0x3be5fc(0x1d6),'role':'text','read':!![],'write':![]},'native':{}}),await _0x285771[_0x3be5fc(0x274)](LTM_DP_TRIGGER_DIGEST,{'type':_0x3be5fc(0x285),'common':{'name':_0x3be5fc(0x2b9),'type':_0x3be5fc(0x297),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x285771['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x3be5fc(0x285),'common':{'name':'Baseline\x20Status','type':'string','role':_0x3be5fc(0x240),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x19f99e){const _0x5bf31a=a0_0x48b8a0;await _0x19f99e[_0x5bf31a(0x274)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x5bf31a(0x1b5)},'native':{}}),await _0x19f99e['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x5bf31a(0x285),'common':{'name':_0x5bf31a(0x315),'type':_0x5bf31a(0x1d6),'role':'state','read':!![],'write':![],'def':_0x5bf31a(0x290)},'native':{}}),await _0x19f99e[_0x5bf31a(0x274)](LTM_DP_DRIFT_DETAILS,{'type':_0x5bf31a(0x285),'common':{'name':_0x5bf31a(0x322),'type':_0x5bf31a(0x1d6),'role':_0x5bf31a(0x240),'read':!![],'write':![]},'native':{}}),await _0x19f99e['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':'Last\x20Check','type':_0x5bf31a(0x300),'role':_0x5bf31a(0x255),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x3a2ca1){const _0x55b958=a0_0x48b8a0;try{const _0x301874=await _0x3a2ca1[_0x55b958(0x2c7)](SYSTEM_DP_MODE);_0x301874&&_0x301874[_0x55b958(0x226)]&&Object['values'](SYSTEM_MODES)[_0x55b958(0x21e)](_0x301874['val'])?_0x3a2ca1[_0x55b958(0x2fb)]=_0x301874[_0x55b958(0x226)]:(_0x3a2ca1[_0x55b958(0x2fb)]=SYSTEM_MODES[_0x55b958(0x20a)],await _0x3a2ca1[_0x55b958(0x174)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x3c3707){_0x3a2ca1['currentSystemMode']=SYSTEM_MODES[_0x55b958(0x20a)];}}async function loadRawEventLog(_0x521917){const _0x555289=a0_0x48b8a0;try{const _0xd7db22=await _0x521917['getStateAsync'](LTM_DP_RAW_LOG);if(_0xd7db22&&_0xd7db22[_0x555289(0x226)])_0x521917[_0x555289(0x26e)]=JSON['parse'](_0xd7db22[_0x555289(0x226)]);}catch(_0x5c491f){_0x521917['rawEventLog']=[];}}async function saveRawEventLog(_0x1fac84){const _0x47ef87=a0_0x48b8a0;_0x1fac84['rawEventLog']['length']>RAW_LOG_MAX_SIZE&&_0x1fac84['rawEventLog']['splice'](0x0,_0x1fac84['rawEventLog'][_0x47ef87(0x21c)]-RAW_LOG_MAX_SIZE),await _0x1fac84[_0x47ef87(0x174)](LTM_DP_RAW_LOG,{'val':JSON[_0x47ef87(0x1fd)](_0x1fac84[_0x47ef87(0x26e)]),'ack':!![]});}async function loadDailyDigests(_0x40acc2){const _0x1add0f=a0_0x48b8a0;try{const _0xdd4c15=await _0x40acc2[_0x1add0f(0x2c7)](LTM_DP_DAILY_DIGESTS);if(_0xdd4c15&&_0xdd4c15[_0x1add0f(0x226)])_0x40acc2['dailyDigests']=JSON[_0x1add0f(0x237)](_0xdd4c15[_0x1add0f(0x226)]);}catch(_0x2c3935){_0x40acc2['dailyDigests']=[];}await updateBaselineStatus(_0x40acc2);}async function saveDailyDigests(_0x168313,_0x48a623=!![]){const _0x1d97e2=a0_0x48b8a0,_0x14fb57=_0x168313[_0x1d97e2(0x1c5)]['ltmLtbWindowDays']||0x3c;_0x168313['dailyDigests']['length']>_0x14fb57&&_0x168313[_0x1d97e2(0x2f5)][_0x1d97e2(0x20b)](0x0,_0x168313[_0x1d97e2(0x2f5)]['length']-_0x14fb57);await _0x168313['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1d97e2(0x1fd)](_0x168313[_0x1d97e2(0x2f5)]),'ack':!![]});if(_0x48a623)await updateBaselineStatus(_0x168313);}async function updateAnalysisHistory(_0x9c162d,_0x13ca40){const _0x4cb8df=a0_0x48b8a0;_0x9c162d['analysisHistory'][_0x4cb8df(0x1fb)](_0x13ca40);if(_0x9c162d['analysisHistory'][_0x4cb8df(0x21c)]>ANALYSIS_HISTORY_MAX_SIZE)_0x9c162d['analysisHistory'][_0x4cb8df(0x1fc)]();await _0x9c162d[_0x4cb8df(0x174)](_0x4cb8df(0x333),{'val':JSON['stringify'](_0x9c162d['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x1c08ab){const _0x3a59e6=a0_0x48b8a0;if(!_0x1c08ab[_0x3a59e6(0x2cb)]){await _0x1c08ab[_0x3a59e6(0x174)](LTM_DP_BASELINE_STATUS,{'val':_0x3a59e6(0x258),'ack':!![]});return;}const _0x52130a=_0x1c08ab['dailyDigests'][_0x3a59e6(0x21c)]>=(_0x1c08ab[_0x3a59e6(0x1c5)][_0x3a59e6(0x330)]||0x7)?_0x3a59e6(0x1e4)+_0x1c08ab[_0x3a59e6(0x2f5)]['length']+'\x20Tage)':_0x3a59e6(0x1e2)+_0x1c08ab[_0x3a59e6(0x2f5)][_0x3a59e6(0x21c)]+'/'+(_0x1c08ab[_0x3a59e6(0x1c5)][_0x3a59e6(0x330)]||0x7)+')';await _0x1c08ab[_0x3a59e6(0x174)](LTM_DP_BASELINE_STATUS,{'val':_0x52130a,'ack':!![]});}function a0_0xb2ad(_0x19b22e,_0x2dbd27){const _0x4ec0a7=a0_0x3b5f();return a0_0xb2ad=function(_0x25ed81,_0x3594a2){_0x25ed81=_0x25ed81-0x16b;let _0x3b5f80=_0x4ec0a7[_0x25ed81];return _0x3b5f80;},a0_0xb2ad(_0x19b22e,_0x2dbd27);}async function initSensorSubscriptions(_0x38d501){const _0x4578ed=a0_0x48b8a0,_0x53a4b0=_0x38d501[_0x4578ed(0x1c5)][_0x4578ed(0x1b9)];if(_0x53a4b0&&_0x53a4b0['length']>0x0){_0x38d501['log'][_0x4578ed(0x1eb)](_0x4578ed(0x28d)+_0x53a4b0[_0x4578ed(0x21c)]+'\x20sensors...');for(const _0x3140f0 of _0x53a4b0){if(_0x3140f0['id']){await _0x38d501[_0x4578ed(0x17f)](_0x3140f0['id']);try{const _0x1794ab=await _0x38d501[_0x4578ed(0x1a2)](_0x3140f0['id']);if(_0x1794ab)_0x38d501[_0x4578ed(0x19c)][_0x3140f0['id']]=_0x1794ab['val'];}catch(_0x4133ee){}}}}}async function initPresenceSubscriptions(_0x136016){const _0x332c78=a0_0x48b8a0,_0x3f7762=_0x136016[_0x332c78(0x1c5)][_0x332c78(0x1c8)]||[];if(_0x3f7762[_0x332c78(0x21c)]>0x0){_0x136016[_0x332c78(0x2a6)][_0x332c78(0x1eb)](_0x332c78(0x28d)+_0x3f7762['length']+_0x332c78(0x276));for(const _0x527b39 of _0x3f7762){await _0x136016[_0x332c78(0x17f)](_0x527b39);}try{await checkWifiPresence(_0x136016);}catch(_0x9ebaba){}}}async function getWeatherContext(_0x12962e){const _0x3863aa=a0_0x48b8a0;try{if(!_0x12962e[_0x3863aa(0x1c5)]['useWeather'])return'Wetter:\x20Deaktiviert';let _0x950acb='';const _0x17ac36=_0x12962e['config'][_0x3863aa(0x175)];if(_0x17ac36)try{if(_0x17ac36[_0x3863aa(0x21e)](_0x3863aa(0x2e5))){const _0x3fb875=await _0x12962e['getForeignStateAsync'](_0x17ac36+_0x3863aa(0x16b));if(_0x3fb875&&_0x3fb875[_0x3863aa(0x226)])_0x950acb=_0x3fb875[_0x3863aa(0x226)];}else{if(_0x17ac36[_0x3863aa(0x21e)](_0x3863aa(0x2e0))){const _0xd93f78=await _0x12962e['getForeignStateAsync'](_0x17ac36+_0x3863aa(0x2bf));if(_0xd93f78&&_0xd93f78[_0x3863aa(0x226)])_0x950acb=_0xd93f78['val'];}else{if(_0x17ac36['includes'](_0x3863aa(0x2da))){const _0x22b093=await _0x12962e[_0x3863aa(0x1a2)](_0x17ac36+_0x3863aa(0x1c6));if(_0x22b093&&_0x22b093['val'])_0x950acb=_0x22b093[_0x3863aa(0x226)];}}}}catch(_0x4301de){}if(!_0x950acb){const _0x367769=['accuweather.0',_0x3863aa(0x2c6),_0x3863aa(0x215),'openweathermap.0'];for(const _0x19a6cd of _0x367769){try{const _0x3bafc8=await _0x12962e[_0x3863aa(0x23d)](_0x19a6cd);if(_0x3bafc8){if(_0x19a6cd['includes'](_0x3863aa(0x2e5))){const _0x5b6e3e=await _0x12962e[_0x3863aa(0x1a2)](_0x19a6cd+_0x3863aa(0x16b));if(_0x5b6e3e&&_0x5b6e3e[_0x3863aa(0x226)]){_0x950acb=_0x5b6e3e[_0x3863aa(0x226)];break;}}}}catch(_0x1872b0){}}}return _0x950acb?_0x3863aa(0x2cf)+_0x950acb:_0x3863aa(0x184);}catch(_0x32ce3d){return _0x3863aa(0x244)+_0x32ce3d[_0x3863aa(0x18c)];}}async function getCalendarContext(_0x39766f){const _0x46df7d=a0_0x48b8a0;try{if(!_0x39766f[_0x46df7d(0x1c5)]['useCalendar'])return'Kalender:\x20Deaktiviert';let _0x4d077c=_0x39766f[_0x46df7d(0x1c5)]['calendarInstance']||_0x46df7d(0x1b3),_0x4c0dcb=_0x39766f[_0x46df7d(0x1c5)][_0x46df7d(0x1cd)]||[];if(typeof _0x4c0dcb===_0x46df7d(0x1d6))_0x4c0dcb=_0x4c0dcb[_0x46df7d(0x216)](',');try{const _0x47e0df=await _0x39766f[_0x46df7d(0x1a2)](_0x4d077c+_0x46df7d(0x24b));if(_0x47e0df&&_0x47e0df[_0x46df7d(0x226)]){let _0x1a22cf=tryParse(_0x47e0df[_0x46df7d(0x226)]);if(_0x1a22cf&&Array[_0x46df7d(0x20f)](_0x1a22cf)){if(_0x4c0dcb[_0x46df7d(0x21c)]>0x0)_0x1a22cf=_0x1a22cf[_0x46df7d(0x206)](_0x2eb7a7=>_0x4c0dcb[_0x46df7d(0x21e)](_0x2eb7a7[_0x46df7d(0x233)]||''));else return _0x46df7d(0x1e6);if(_0x1a22cf['length']>0x0){const _0x4b2c27=_0x1a22cf[_0x46df7d(0x18e)](0x0,0x3)[_0x46df7d(0x268)](_0x3f0b66=>{const _0x593c9e=_0x46df7d;let _0x36880c=_0x3f0b66[_0x593c9e(0x255)];if(_0x3f0b66[_0x593c9e(0x25c)])_0x36880c+='\x20'+_0x3f0b66[_0x593c9e(0x25c)];return _0x36880c+':\x20'+_0x3f0b66[_0x593c9e(0x1e9)]+'\x20('+_0x3f0b66['_calName']+')';});return _0x46df7d(0x28b)+_0x4b2c27['join'](_0x46df7d(0x265));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x63798){_0x39766f[_0x46df7d(0x2a6)][_0x46df7d(0x19e)]('Error\x20reading\x20calendar\x20table:\x20'+_0x63798['message']);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x4e0533){return _0x46df7d(0x1be)+_0x4e0533[_0x46df7d(0x18c)];}}async function getCalendarNames(_0x49bd05,_0x43e7f0){const _0x35f349=a0_0x48b8a0;try{const _0x2cccfe=await _0x49bd05['getForeignStateAsync'](_0x43e7f0+_0x35f349(0x24b));if(_0x2cccfe&&_0x2cccfe[_0x35f349(0x226)]){const _0xfc1230=tryParse(_0x2cccfe[_0x35f349(0x226)]);if(_0xfc1230&&Array[_0x35f349(0x20f)](_0xfc1230)){const _0x3233d7=[...new Set(_0xfc1230[_0x35f349(0x268)](_0x2a5a54=>_0x2a5a54['_calName'])[_0x35f349(0x206)](Boolean))];return _0x3233d7['sort']();}}return[];}catch(_0x5a8c26){return _0x49bd05[_0x35f349(0x2a6)][_0x35f349(0x318)]('getCalendarNames\x20Error:\x20'+_0x5a8c26[_0x35f349(0x18c)]),[];}}async function checkWifiPresence(_0x1e4165){const _0x29993b=a0_0x48b8a0;try{const _0x6efffe=_0x1e4165[_0x29993b(0x1c5)][_0x29993b(0x1c8)]||[];let _0x527d02=![];const _0x18f64f=[];for(const _0x1fe88a of _0x6efffe){try{const _0x5dca63=await _0x1e4165[_0x29993b(0x1a2)](_0x1fe88a);if(_0x5dca63&&(_0x5dca63['val']===!![]||_0x5dca63[_0x29993b(0x226)]===_0x29993b(0x24e)||_0x5dca63['val']===0x1)){_0x527d02=!![];const _0x47fb28=await _0x1e4165[_0x29993b(0x23d)](_0x1fe88a);let _0x242da6=_0x1fe88a;_0x47fb28&&_0x47fb28[_0x29993b(0x23e)]&&_0x47fb28[_0x29993b(0x23e)][_0x29993b(0x1f1)]&&(_0x242da6=typeof _0x47fb28[_0x29993b(0x23e)][_0x29993b(0x1f1)]===_0x29993b(0x323)?_0x47fb28['common']['name']['de']||_0x47fb28[_0x29993b(0x23e)]['name']['en']:_0x47fb28[_0x29993b(0x23e)][_0x29993b(0x1f1)]),_0x18f64f['push'](_0x242da6);}}catch(_0x1c7ee5){}}return await _0x1e4165[_0x29993b(0x174)]('system.presenceWho',{'val':_0x18f64f[_0x29993b(0x19d)](',\x20'),'ack':!![]}),_0x527d02&&(_0x1e4165[_0x29993b(0x2b1)]&&(_0x1e4165['log'][_0x29993b(0x1eb)](_0x29993b(0x218)),abortExitTimer(_0x1e4165)),!_0x1e4165[_0x29993b(0x320)]&&_0x1e4165[_0x29993b(0x2fb)]===SYSTEM_MODES[_0x29993b(0x20a)]&&await setPresence(_0x1e4165,!![])),_0x527d02;}catch(_0x21fddf){return _0x1e4165['log'][_0x29993b(0x318)](_0x29993b(0x1ac)+_0x21fddf['message']),![];}}function startExitTimer(_0x20be98){const _0x1aba0c=a0_0x48b8a0;abortExitTimer(_0x20be98),_0x20be98['isGracePeriodActive']=!![],_0x20be98[_0x1aba0c(0x1a7)]=setTimeout(()=>{const _0x3ba2fe=_0x1aba0c;_0x20be98[_0x3ba2fe(0x1ed)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x20be98[_0x1aba0c(0x2b1)]=setTimeout(()=>{setPresence(_0x20be98,![]),_0x20be98['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x53da32){const _0xb92ba6=a0_0x48b8a0;if(_0x53da32[_0xb92ba6(0x2b1)])clearTimeout(_0x53da32[_0xb92ba6(0x2b1)]);if(_0x53da32[_0xb92ba6(0x1a7)])clearTimeout(_0x53da32['exitGraceTimer']);_0x53da32['exitTimer']=null,_0x53da32[_0xb92ba6(0x1a7)]=null,_0x53da32[_0xb92ba6(0x1ed)]=![];}async function setPresence(_0x4ffd44,_0x202e93){const _0x160af7=a0_0x48b8a0;if(_0x4ffd44[_0x160af7(0x320)]===_0x202e93)return;_0x4ffd44[_0x160af7(0x320)]=_0x202e93,await _0x4ffd44[_0x160af7(0x174)]('system.isPresent',{'val':_0x202e93,'ack':!![]});}async function saveFeedback(_0x38425a,_0x1859f2){const _0x4466aa=a0_0x48b8a0;_0x38425a['log']['info'](_0x4466aa(0x2a3)+JSON[_0x4466aa(0x1fd)](_0x1859f2));}async function runBaselineDriftAnalysis(_0x525ac3){const _0x412186=a0_0x48b8a0;if(!_0x525ac3[_0x412186(0x2cb)]||!_0x525ac3[_0x412186(0x32d)])return;const _0xec1e76=_0x525ac3[_0x412186(0x1c5)][_0x412186(0x2d6)]||0xe;if(_0x525ac3['dailyDigests'][_0x412186(0x21c)]<_0xec1e76+(_0x525ac3[_0x412186(0x1c5)]['minDaysForBaseline']||0x7)){await _0x525ac3[_0x412186(0x174)](LTM_DP_DRIFT_STATUS,{'val':_0x412186(0x179),'ack':!![]});return;}const _0x307bca=_0x525ac3[_0x412186(0x2f5)][_0x412186(0x18e)](-_0xec1e76),_0x2dc4d7=_0x525ac3[_0x412186(0x2f5)]['slice'](0x0,_0x525ac3[_0x412186(0x2f5)][_0x412186(0x21c)]-_0xec1e76),_0x1e4ff7='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x412186(0x1fd)](_0x2dc4d7)+'\x0aSTB:\x20'+JSON[_0x412186(0x1fd)](_0x307bca);try{const _0x14b8c0=await _0x525ac3[_0x412186(0x32d)][_0x412186(0x1d8)](_0x1e4ff7),_0x5a1187=JSON[_0x412186(0x237)](_0x14b8c0['response'][_0x412186(0x240)]()['replace'](/```json|```/g,'')['trim']());_0x5a1187['baselineDrift']&&(await _0x525ac3['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x5a1187[_0x412186(0x236)],'ack':!![]}),await _0x525ac3[_0x412186(0x174)](LTM_DP_DRIFT_DETAILS,{'val':_0x5a1187[_0x412186(0x1f9)],'ack':!![]}),await _0x525ac3[_0x412186(0x174)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x412186(0x32b)](),'ack':!![]}));}catch(_0x1a926b){}}function setupLtmScheduler(_0x53cbe6){const _0x22cb0e=a0_0x48b8a0;try{if(_0x53cbe6[_0x22cb0e(0x20e)])_0x53cbe6['ltmJob'][_0x22cb0e(0x2d2)]();if(!_0x53cbe6['isProVersion']){_0x53cbe6[_0x22cb0e(0x174)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x53cbe6[_0x22cb0e(0x20e)]=schedule[_0x22cb0e(0x27d)](LTM_SCHEDULE,()=>createDailyDigest(_0x53cbe6));}catch(_0x34e17d){_0x53cbe6[_0x22cb0e(0x2a6)]['error'](_0x22cb0e(0x2d9)+_0x34e17d[_0x22cb0e(0x18c)]);}}function setupModeResetScheduler(_0x5f2ee6){const _0x58f913=a0_0x48b8a0;try{if(_0x5f2ee6['modeResetJob'])_0x5f2ee6[_0x58f913(0x1e7)][_0x58f913(0x2d2)]();_0x5f2ee6[_0x58f913(0x1e7)]=schedule[_0x58f913(0x27d)](MODE_RESET_SCHEDULE,async()=>{const _0x3976d3=_0x58f913;await loadSystemMode(_0x5f2ee6),AUTO_RESET_MODES[_0x3976d3(0x21e)](_0x5f2ee6[_0x3976d3(0x2fb)])&&await _0x5f2ee6[_0x3976d3(0x174)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x34f54d){_0x5f2ee6[_0x58f913(0x2a6)][_0x58f913(0x318)](_0x58f913(0x21f)+_0x34f54d[_0x58f913(0x18c)]);}}function setupDriftAnalysisScheduler(_0x53a9e3){const _0x2aaa5c=a0_0x48b8a0;try{if(_0x53a9e3[_0x2aaa5c(0x328)])clearInterval(_0x53a9e3[_0x2aaa5c(0x328)]);if(!_0x53a9e3['isProVersion'])return;_0x53a9e3[_0x2aaa5c(0x328)]=setInterval(()=>runBaselineDriftAnalysis(_0x53a9e3),(_0x53a9e3[_0x2aaa5c(0x1c5)][_0x2aaa5c(0x21a)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x53a9e3),0x1388);}catch(_0x36aa2e){_0x53a9e3[_0x2aaa5c(0x2a6)][_0x2aaa5c(0x318)](_0x2aaa5c(0x29e)+_0x36aa2e[_0x2aaa5c(0x18c)]);}}function setupBriefingScheduler(_0x475d46){const _0x109128=a0_0x48b8a0;try{if(_0x475d46[_0x109128(0x29c)])_0x475d46[_0x109128(0x29c)][_0x109128(0x2d2)]();if(!_0x475d46['config'][_0x109128(0x2cd)])return;const _0x1f651b=(_0x475d46[_0x109128(0x1c5)]['briefingTime']||_0x109128(0x2a4))[_0x109128(0x216)](':'),_0x379444=parseInt(_0x1f651b[0x0])||0x8,_0x5be8a5=parseInt(_0x1f651b[0x1])||0x0,_0x366026=_0x5be8a5+'\x20'+_0x379444+_0x109128(0x2f1);_0x475d46['log'][_0x109128(0x1eb)](_0x109128(0x305)+_0x379444+':'+(_0x5be8a5<0xa?'0'+_0x5be8a5:_0x5be8a5)),_0x475d46['briefingJob']=schedule[_0x109128(0x27d)](_0x366026,()=>{sendMorningBriefing(_0x475d46);});}catch(_0x69f24){_0x475d46['log'][_0x109128(0x318)](_0x109128(0x2d1)+_0x69f24[_0x109128(0x18c)]);}}async function sendNotification(_0x1af44e,_0xd9f5d3,_0x4f1d35=![],_0x47b896=![]){const _0x25d0f6=a0_0x48b8a0;_0x1af44e[_0x25d0f6(0x2a6)][_0x25d0f6(0x1eb)]((_0x4f1d35?'[TEST]\x20':'')+_0x25d0f6(0x221)+_0xd9f5d3+'\x22');const _0x26d3f9=_0x1af44e['config'];let _0x3a1387=0x0;if(_0x26d3f9['notifyTelegramEnabled']){let _0x208ddc={};(_0xd9f5d3[_0x25d0f6(0x21e)](_0x25d0f6(0x210))||_0x47b896)&&(_0x208ddc={'reply_markup':{'inline_keyboard':[[{'text':_0x25d0f6(0x306),'callback_data':_0x25d0f6(0x256)}],[{'text':'üìû\x20R√ºckruf\x20anfordern','callback_data':_0x25d0f6(0x2e7)}]]}}),await _0x1af44e[_0x25d0f6(0x311)](_0x26d3f9[_0x25d0f6(0x247)],_0x25d0f6(0x2f9),{'text':_0xd9f5d3,'user':_0x26d3f9[_0x25d0f6(0x1d0)],..._0x208ddc}),_0x3a1387++;}if(_0x26d3f9[_0x25d0f6(0x19b)]){let _0x36a7c1={'message':_0xd9f5d3,'title':_0x47b896?_0x25d0f6(0x272):_0x25d0f6(0x1bd),'priority':_0x47b896?0x2:0x1,'device':_0x26d3f9[_0x25d0f6(0x18a)]};_0x47b896&&(_0x36a7c1[_0x25d0f6(0x27e)]=0x1e,_0x36a7c1[_0x25d0f6(0x334)]=0xe10,_0x36a7c1[_0x25d0f6(0x17d)]=_0x25d0f6(0x30b)),await _0x1af44e['sendToAsync'](_0x26d3f9[_0x25d0f6(0x2ab)],_0x25d0f6(0x2f9),_0x36a7c1),_0x3a1387++;}return _0x26d3f9[_0x25d0f6(0x28e)]&&(await _0x1af44e[_0x25d0f6(0x311)](_0x26d3f9[_0x25d0f6(0x26c)],_0x25d0f6(0x2f9),{'text':_0xd9f5d3,'to':_0x26d3f9[_0x25d0f6(0x1e3)]}),_0x3a1387++),_0x3a1387;}async function setupTelegramListener(_0x5d43aa){const _0x4a9a9b=a0_0x48b8a0,_0x4b57d3=_0x5d43aa[_0x4a9a9b(0x1c5)][_0x4a9a9b(0x247)];_0x5d43aa['config'][_0x4a9a9b(0x2d7)]&&_0x4b57d3&&(_0x5d43aa[_0x4a9a9b(0x2a6)]['info'](_0x4a9a9b(0x22e)+_0x4b57d3+'\x20for\x20interactive\x20buttons...'),await _0x5d43aa['subscribeForeignStatesAsync'](_0x4b57d3+_0x4a9a9b(0x18f)));}async function handleTelegramResponse(_0x12ae47,_0xff7e0b){const _0x497568=a0_0x48b8a0;let _0x2a34f2=_0xff7e0b;_0xff7e0b['startsWith']('[')&&(_0x2a34f2=_0xff7e0b[_0x497568(0x18b)](_0xff7e0b[_0x497568(0x27b)](']')+0x1));if(_0x2a34f2===_0x497568(0x256))_0x12ae47['log'][_0x497568(0x1eb)](_0x497568(0x27f)),await _0x12ae47[_0x497568(0x174)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x12ae47[_0x497568(0x174)](_0x497568(0x242),{'val':_0x497568(0x1ee),'ack':!![]}),_0x12ae47[_0x497568(0x294)]=![],sendNotification(_0x12ae47,_0x497568(0x239),![]);else _0x2a34f2===_0x497568(0x2e7)&&(_0x12ae47['log'][_0x497568(0x19e)](_0x497568(0x288)),sendNotification(_0x12ae47,'üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.',![],!![]));}async function runAutopilot(_0x436867){const _0x2d5787=a0_0x48b8a0,_0x1a5343=_0x436867[_0x2d5787(0x1c5)][_0x2d5787(0x2a5)],_0x3d4e04=_0x436867[_0x2d5787(0x1da)][_0x2d5787(0x21c)]>0x0?_0x436867[_0x2d5787(0x1da)][0x0][_0x2d5787(0x2b7)]:Date[_0x2d5787(0x32b)](),_0xde1a12=(Date[_0x2d5787(0x32b)]()-_0x3d4e04)/(0x3e8*0x3c*0x3c);let _0x1d0fe2='';_0x436867[_0x2d5787(0x1c5)][_0x2d5787(0x32c)]&&_0x436867['currentSystemMode']===SYSTEM_MODES[_0x2d5787(0x20a)]&&_0x436867[_0x2d5787(0x320)]&&(_0xde1a12>_0x1a5343&&(_0x1d0fe2='HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0xde1a12['toFixed'](0x1)+_0x2d5787(0x1dd))),runGeminiAnalysis(_0x436867,_0x1d0fe2)[_0x2d5787(0x281)](_0x15633d=>_0x436867[_0x2d5787(0x2a6)][_0x2d5787(0x318)](_0x15633d));}async function createDailyDigest(_0x335c05){const _0x50e18f=a0_0x48b8a0;if(!_0x335c05[_0x50e18f(0x2cb)])return;await _0x335c05[_0x50e18f(0x174)](LTM_DP_STATUS,{'val':_0x50e18f(0x24c)+new Date()[_0x50e18f(0x25a)](),'ack':!![]});if(!_0x335c05[_0x50e18f(0x32d)]||_0x335c05['rawEventLog'][_0x50e18f(0x21c)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x335c05[_0x50e18f(0x174)](LTM_DP_STATUS,{'val':_0x50e18f(0x29d),'ack':!![]});return;}const _0x4957b3=JSON[_0x50e18f(0x237)](JSON[_0x50e18f(0x1fd)](_0x335c05[_0x50e18f(0x26e)])),_0x750f30=_0x4957b3['length'],_0x637c82=_0x50e18f(0x277)+JSON[_0x50e18f(0x1fd)](_0x4957b3);try{const _0x5d6117=await _0x335c05[_0x50e18f(0x32d)][_0x50e18f(0x1d8)](_0x637c82),_0x31e454=JSON[_0x50e18f(0x237)](_0x5d6117['response'][_0x50e18f(0x240)]()[_0x50e18f(0x316)](/```json|```/g,'')['trim']());_0x31e454[_0x50e18f(0x2de)]&&(_0x335c05['dailyDigests'][_0x50e18f(0x280)]({'timestamp':new Date()[_0x50e18f(0x286)](),'eventCount':_0x750f30,'summary':_0x31e454['summary'],'activityLevel':_0x31e454[_0x50e18f(0x2ca)],'systemMode':_0x335c05[_0x50e18f(0x2fb)]}),await saveDailyDigests(_0x335c05),_0x335c05['rawEventLog']=[],await saveRawEventLog(_0x335c05),await _0x335c05['setStateAsync'](LTM_DP_STATUS,{'val':_0x50e18f(0x207)+_0x750f30+_0x50e18f(0x301),'ack':!![]}));}catch(_0x3cea4c){await _0x335c05['setStateAsync'](LTM_DP_STATUS,{'val':_0x50e18f(0x2fd)+_0x3cea4c['message'],'ack':!![]});}}async function sendMorningBriefing(_0x2b2ec4){const _0x386384=a0_0x48b8a0;if(!_0x2b2ec4[_0x386384(0x32d)])return;_0x2b2ec4[_0x386384(0x2a6)][_0x386384(0x1eb)]('Generating\x20Morning\x20Briefing...');const _0x4fc7a0=_0x2b2ec4[_0x386384(0x2f5)][_0x386384(0x21c)]>0x0?_0x2b2ec4[_0x386384(0x2f5)][_0x2b2ec4[_0x386384(0x2f5)][_0x386384(0x21c)]-0x1]:null,_0x3cff1b=_0x4fc7a0&&_0x4fc7a0[_0x386384(0x1bf)]?_0x4fc7a0[_0x386384(0x1bf)][_0x386384(0x31d)]:_0x386384(0x290),_0x1ff29a=new Date();_0x1ff29a[_0x386384(0x25b)](0x4,0x0,0x0,0x0);const _0x3867ce=_0x2b2ec4[_0x386384(0x1da)][_0x386384(0x206)](_0x462da8=>new Date(_0x462da8[_0x386384(0x2b7)])>_0x1ff29a),_0x2542b8=PERSONA_MAPPING[_0x2b2ec4['config']['aiPersona']||_0x386384(0x176)],_0x29084b=_0x2b2ec4[_0x386384(0x1c5)][_0x386384(0x257)]||'',_0x1c38bb=await getWeatherContext(_0x2b2ec4),_0x528163=await getCalendarContext(_0x2b2ec4),_0x253587=_0x386384(0x2df)+_0x2542b8+_0x386384(0x31f)+_0x29084b+_0x386384(0x1ff)+_0x1c38bb+'\x20'+_0x528163+_0x386384(0x313)+_0x3cff1b+_0x386384(0x1cb)+JSON[_0x386384(0x1fd)](_0x3867ce['slice'](0x0,0xa))+_0x386384(0x1b0);try{const _0x21aef5=await _0x2b2ec4[_0x386384(0x32d)][_0x386384(0x1d8)](_0x253587),_0xe723d6='üåÖ\x20Daily\x20Briefing:\x0a'+_0x21aef5[_0x386384(0x1d3)][_0x386384(0x240)]()[_0x386384(0x282)]();sendNotification(_0x2b2ec4,_0xe723d6),_0x2b2ec4[_0x386384(0x2a6)]['info'](_0x386384(0x1f7));}catch(_0x44e054){_0x2b2ec4[_0x386384(0x2a6)][_0x386384(0x318)](_0x386384(0x30f)+_0x44e054['message']);}}async function scanForDevices(_0x42def4,_0x5bd9c3){const _0x20732f=a0_0x48b8a0;_0x42def4[_0x20732f(0x2a6)][_0x20732f(0x1eb)](_0x20732f(0x26f));const _0x157e59=[],_0x3b2665=await _0x42def4[_0x20732f(0x178)]('*'),_0x19106f=await _0x42def4[_0x20732f(0x178)](_0x20732f(0x249),_0x20732f(0x222)),_0x3a3426=await _0x42def4[_0x20732f(0x178)](_0x20732f(0x18d),'enum'),_0x119518={};if(_0x19106f)for(const _0xfcba83 in _0x19106f){const _0x59d105=_0x19106f[_0xfcba83]['common']['members']||[];_0x59d105[_0x20732f(0x32f)](_0x1fad52=>{if(!_0x119518[_0x1fad52])_0x119518[_0x1fad52]=[];_0x119518[_0x1fad52]['push'](_0xfcba83);});}const _0x36a7cb={};if(_0x3a3426)for(const _0x37ccfa in _0x3a3426){const _0x2da340=_0x3a3426[_0x37ccfa][_0x20732f(0x23e)][_0x20732f(0x201)]||[],_0x4ba703=typeof _0x3a3426[_0x37ccfa]['common']['name']===_0x20732f(0x323)?_0x3a3426[_0x37ccfa]['common'][_0x20732f(0x1f1)]['de']:_0x3a3426[_0x37ccfa][_0x20732f(0x23e)][_0x20732f(0x1f1)];_0x2da340[_0x20732f(0x32f)](_0x27255a=>_0x36a7cb[_0x27255a]=_0x4ba703);}const _0x53177c=_0x5bd9c3[_0x20732f(0x29a)]||[],_0x5c5cd7=_0x5bd9c3[_0x20732f(0x1ea)]!==![],_0x168042=_0x5bd9c3[_0x20732f(0x2a2)]!==![],_0x160812=_0x5bd9c3[_0x20732f(0x2d5)]!==![],_0x22f9b4=_0x5bd9c3['temperature']===!![],_0x2491d8=_0x5bd9c3[_0x20732f(0x1a0)]===!![];for(const _0x5392e6 in _0x3b2665){const _0x547105=_0x3b2665[_0x5392e6];if(_0x547105['type']!==_0x20732f(0x285)||!_0x547105[_0x20732f(0x23e)])continue;if(ADAPTER_BLACKLIST[_0x20732f(0x327)](_0x5354c3=>_0x5392e6[_0x20732f(0x211)](_0x5354c3))&&!_0x2491d8)continue;const _0x27c6f6=(_0x547105[_0x20732f(0x23e)][_0x20732f(0x2d0)]||'')[_0x20732f(0x1b7)]();let _0xb273a9=(typeof _0x547105[_0x20732f(0x23e)][_0x20732f(0x1f1)]===_0x20732f(0x323)?_0x547105[_0x20732f(0x23e)]['name']['de']:_0x547105[_0x20732f(0x23e)][_0x20732f(0x1f1)])||_0x5392e6;const _0x2422a8=_0xb273a9['toLowerCase']();let _0x3a37f2=![],_0x2d2c2d=![];if(_0x53177c['length']>0x0){const _0x463766=_0x119518[_0x5392e6]||[],_0x1ceb2c=_0x5392e6[_0x20732f(0x216)]('.')[_0x20732f(0x18e)](0x0,-0x1)[_0x20732f(0x19d)]('.'),_0x4bd1bf=_0x119518[_0x1ceb2c]||[];(_0x463766['some'](_0x5ce204=>_0x53177c[_0x20732f(0x21e)](_0x5ce204))||_0x4bd1bf[_0x20732f(0x327)](_0x9634c7=>_0x53177c[_0x20732f(0x21e)](_0x9634c7)))&&(_0x3a37f2=!![],_0x2d2c2d=!![]);}if(!_0x3a37f2&&!_0x2491d8){if(HARD_IGNORE_TERMS['some'](_0x1864e7=>_0x5392e6[_0x20732f(0x21e)](_0x1864e7)||_0x2422a8[_0x20732f(0x21e)](_0x1864e7['toLowerCase']())))continue;}if(BAD_NAMES[_0x20732f(0x327)](_0x3c3cbc=>_0x2422a8===_0x3c3cbc||_0x2422a8[_0x20732f(0x27a)]('.'+_0x3c3cbc))){const _0x3704a2=_0x5392e6[_0x20732f(0x216)]('.');if(_0x3704a2['length']>0x2){const _0x172034=_0x3704a2['slice'](0x0,-0x1)[_0x20732f(0x19d)]('.'),_0x384397=_0x3b2665[_0x172034];if(_0x384397&&_0x384397[_0x20732f(0x23e)]&&_0x384397[_0x20732f(0x23e)][_0x20732f(0x1f1)]){const _0x3941b8=typeof _0x384397[_0x20732f(0x23e)][_0x20732f(0x1f1)]==='object'?_0x384397[_0x20732f(0x23e)][_0x20732f(0x1f1)]['de']:_0x384397[_0x20732f(0x23e)][_0x20732f(0x1f1)];_0x3941b8&&!_0xb273a9[_0x20732f(0x21e)](_0x3941b8)&&(_0xb273a9=_0x3941b8+'\x20'+_0xb273a9);}}}let _0x9eb537='';if(_0x5c5cd7&&(_0x27c6f6[_0x20732f(0x21e)](_0x20732f(0x1ea))||_0x27c6f6[_0x20732f(0x21e)](_0x20732f(0x1db))||_0x2422a8[_0x20732f(0x21e)]('bewegung')||_0x2422a8['includes']('pr√§senz')))_0x9eb537=_0x20732f(0x1ea);else{if(!_0x9eb537&&_0x168042&&(_0x27c6f6[_0x20732f(0x21e)](_0x20732f(0x2c9))||_0x27c6f6[_0x20732f(0x21e)](_0x20732f(0x23a))||_0x27c6f6[_0x20732f(0x21e)]('lock')||_0x27c6f6[_0x20732f(0x21e)](_0x20732f(0x291))||_0x27c6f6['includes'](_0x20732f(0x200))||_0x2422a8[_0x20732f(0x21e)](_0x20732f(0x1ce))||_0x2422a8[_0x20732f(0x21e)]('t√ºr')||_0x2422a8[_0x20732f(0x21e)](_0x20732f(0x331))))_0x9eb537=_0x20732f(0x2c9);else{if(!_0x9eb537&&_0x160812&&(_0x27c6f6[_0x20732f(0x21e)](_0x20732f(0x225))||_0x27c6f6[_0x20732f(0x21e)](_0x20732f(0x230))||_0x27c6f6[_0x20732f(0x21e)]('dimmer')||_0x2422a8['includes']('licht')||_0x2422a8[_0x20732f(0x21e)]('lampe')||_0x2422a8[_0x20732f(0x21e)]('schalter'))){if(_0x547105[_0x20732f(0x23e)][_0x20732f(0x1fa)]||_0x27c6f6[_0x20732f(0x21e)](_0x20732f(0x16f)))_0x9eb537=_0x20732f(0x225);}else{if(!_0x9eb537&&_0x22f9b4&&(_0x27c6f6['includes'](_0x20732f(0x2e4))||_0x27c6f6['includes'](_0x20732f(0x1b2))||_0x27c6f6['includes'](_0x20732f(0x1de))||_0x2422a8[_0x20732f(0x21e)]('temp')||_0x2422a8[_0x20732f(0x21e)](_0x20732f(0x326))||_0x2422a8[_0x20732f(0x21e)](_0x20732f(0x198))))_0x9eb537='temperature';else{if(!_0x9eb537&&_0x2d2c2d)_0x9eb537=_0x20732f(0x252);}}}}if(_0x9eb537){let _0x28bf1f=_0x36a7cb[_0x5392e6]||'';if(!_0x28bf1f){let _0x4b44bd=_0x5392e6;for(let _0x3b94b0=0x0;_0x3b94b0<0x3;_0x3b94b0++){const _0xe8f496=_0x4b44bd[_0x20732f(0x199)]('.');if(_0xe8f496===-0x1)break;_0x4b44bd=_0x4b44bd[_0x20732f(0x18b)](0x0,_0xe8f496);if(_0x36a7cb[_0x4b44bd]){_0x28bf1f=_0x36a7cb[_0x4b44bd];break;}}}_0x157e59[_0x20732f(0x280)]({'id':_0x5392e6,'name':_0xb273a9,'location':_0x28bf1f,'type':_0x9eb537,'logDuplicates':_0x9eb537==='motion','isExit':![],'_score':_0x28bf1f?0x50:_0x9eb537===_0x20732f(0x252)?0x5a:0x28});}}return _0x157e59[_0x20732f(0x2e1)]((_0x5511bf,_0x52da40)=>_0x52da40[_0x20732f(0x26a)]-_0x5511bf['_score']),_0x157e59;}async function executeAutomationAction(_0x48c8fc){const _0x5f244e=a0_0x48b8a0;try{const _0x909f70=await _0x48c8fc[_0x5f244e(0x2c7)](_0x5f244e(0x1b4)),_0x5216ee=await _0x48c8fc[_0x5f244e(0x2c7)](_0x5f244e(0x325));if(_0x909f70&&_0x909f70[_0x5f244e(0x226)]&&_0x5216ee){const _0x35a8f5=_0x909f70[_0x5f244e(0x226)];let _0x3288b6=_0x5216ee[_0x5f244e(0x226)];try{_0x3288b6=JSON[_0x5f244e(0x237)](_0x3288b6);}catch(_0x179ef0){}_0x48c8fc[_0x5f244e(0x2a6)][_0x5f244e(0x1eb)](_0x5f244e(0x2c4)+_0x35a8f5+_0x5f244e(0x289)+_0x3288b6),await _0x48c8fc['setForeignStateAsync'](_0x35a8f5,_0x3288b6);}else _0x48c8fc[_0x5f244e(0x2a6)][_0x5f244e(0x19e)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x1e096f){_0x48c8fc[_0x5f244e(0x2a6)][_0x5f244e(0x318)](_0x5f244e(0x2b2)+_0x1e096f[_0x5f244e(0x18c)]);}}function tryParse(_0x5ce54a){const _0x1efa6e=a0_0x48b8a0;try{return JSON[_0x1efa6e(0x237)](_0x5ce54a);}catch(_0x1b185a){return null;}}async function processSensorEvent(_0x138da0,_0x5b79ba,_0x53f298,_0x30095f){const _0x35c0e1=a0_0x48b8a0;if(!_0x30095f)return;const _0x547188=_0x53f298[_0x35c0e1(0x226)],_0x52f9ef=Date[_0x35c0e1(0x32b)]();_0x138da0[_0x35c0e1(0x2a6)][_0x35c0e1(0x177)](_0x35c0e1(0x232)+_0x5b79ba+_0x35c0e1(0x289)+_0x547188),_0x138da0[_0x35c0e1(0x19c)][_0x5b79ba]=_0x547188;if(!_0x30095f[_0x35c0e1(0x2b8)]&&_0x138da0[_0x35c0e1(0x1da)]&&_0x138da0[_0x35c0e1(0x1da)][_0x35c0e1(0x21c)]>0x0){const _0x40a4c0=_0x138da0[_0x35c0e1(0x1da)][0x0];if(_0x40a4c0['id']===_0x5b79ba&&_0x40a4c0[_0x35c0e1(0x1aa)]==_0x547188){_0x138da0['log'][_0x35c0e1(0x177)]('IGNORING\x20DUPLICATE:\x20'+_0x30095f[_0x35c0e1(0x1f1)]+_0x35c0e1(0x2a7)+_0x547188+')');return;}}const _0x3cb130={'timestamp':_0x52f9ef,'id':_0x5b79ba,'name':_0x30095f[_0x35c0e1(0x1f1)],'type':_0x30095f['type'],'location':_0x30095f[_0x35c0e1(0x279)],'value':_0x547188};_0x138da0[_0x35c0e1(0x1da)][_0x35c0e1(0x1fb)](_0x3cb130);if(_0x138da0[_0x35c0e1(0x1da)][_0x35c0e1(0x21c)]>HISTORY_MAX_SIZE)_0x138da0[_0x35c0e1(0x1da)][_0x35c0e1(0x1fc)]();await _0x138da0[_0x35c0e1(0x174)](_0x35c0e1(0x208),{'val':JSON[_0x35c0e1(0x1fd)](_0x3cb130),'ack':!![]}),await _0x138da0[_0x35c0e1(0x174)]('events.history',{'val':JSON['stringify'](_0x138da0[_0x35c0e1(0x1da)]),'ack':!![]});_0x138da0[_0x35c0e1(0x2cb)]&&(_0x138da0[_0x35c0e1(0x26e)][_0x35c0e1(0x280)](_0x3cb130),await saveRawEventLog(_0x138da0));if(_0x30095f['isExit']&&_0x547188===!![]){if(_0x138da0[_0x35c0e1(0x320)]&&!_0x138da0['isGracePeriodActive'])_0x138da0['log']['info'](_0x35c0e1(0x183)+_0x30095f['name']+_0x35c0e1(0x2e6)),startExitTimer(_0x138da0);else!_0x138da0[_0x35c0e1(0x320)]&&(_0x138da0['log'][_0x35c0e1(0x1eb)](_0x35c0e1(0x19a)+_0x30095f[_0x35c0e1(0x1f1)]+_0x35c0e1(0x1a5)),await setPresence(_0x138da0,!![]));}else _0x30095f['type']===_0x35c0e1(0x1ea)&&_0x547188===!![]&&(_0x138da0[_0x35c0e1(0x2b1)]&&(_0x138da0[_0x35c0e1(0x2a6)][_0x35c0e1(0x1eb)]('Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.'),abortExitTimer(_0x138da0)),!_0x138da0[_0x35c0e1(0x320)]&&_0x138da0[_0x35c0e1(0x2fb)]===SYSTEM_MODES[_0x35c0e1(0x20a)]&&await setPresence(_0x138da0,!![]));}async function runGeminiAnalysis(_0x3ca09b,_0x4e8eab=''){const _0xe4e8c0=a0_0x48b8a0;if(!_0x3ca09b['geminiModel'])return;if(_0x3ca09b[_0xe4e8c0(0x1da)][_0xe4e8c0(0x21c)]===0x0)return;const _0x1ad4eb=_0x3ca09b[_0xe4e8c0(0x1da)][_0xe4e8c0(0x18e)](0x0,0xf),_0x52e262=await getWeatherContext(_0x3ca09b),_0x5694a7=_0x3ca09b[_0xe4e8c0(0x2fb)],_0xae3c01=PERSONA_MAPPING[_0x3ca09b[_0xe4e8c0(0x1c5)]['aiPersona']||_0xe4e8c0(0x176)],_0x18e817=_0x3ca09b['config']['livingContext']||_0xe4e8c0(0x1af);let _0x3e5ec2=![];try{const _0x3a8bac=await _0x3ca09b[_0xe4e8c0(0x2c7)]('analysis.automation.autoApply');if(_0x3a8bac&&_0x3a8bac[_0xe4e8c0(0x226)])_0x3e5ec2=!![];}catch(_0x2cfe0e){}const _0x185ade=_0xe4e8c0(0x192)+_0xae3c01+'.\x0a\x20\x20\x20\x20KONTEXT:\x20'+_0x18e817+_0xe4e8c0(0x241)+_0x5694a7+_0xe4e8c0(0x2a0)+_0x52e262+_0xe4e8c0(0x1c7)+(_0x4e8eab||_0xe4e8c0(0x2fc))+_0xe4e8c0(0x203)+JSON['stringify'](_0x1ad4eb)+'\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20';try{const _0x565d84=await _0x3ca09b[_0xe4e8c0(0x32d)][_0xe4e8c0(0x1d8)](_0x185ade),_0x369ab2=_0x565d84[_0xe4e8c0(0x1d3)]['text']()[_0xe4e8c0(0x316)](/```json|```/g,'')[_0xe4e8c0(0x282)](),_0xeccea3=JSON[_0xe4e8c0(0x237)](_0x369ab2);await _0x3ca09b[_0xe4e8c0(0x174)](_0xe4e8c0(0x22a),{'val':JSON[_0xe4e8c0(0x1fd)](_0xeccea3),'ack':!![]});const _0x50532f=_0xeccea3['isAlert']||![];_0x50532f!==_0x3ca09b['lastAlertState']&&(await _0x3ca09b[_0xe4e8c0(0x174)](_0xe4e8c0(0x266),{'val':_0x50532f,'ack':!![]}),_0x3ca09b['lastAlertState']=_0x50532f,_0x50532f&&(await _0x3ca09b['setStateAsync'](_0xe4e8c0(0x242),{'val':_0xeccea3[_0xe4e8c0(0x1b6)],'ack':!![]}),sendNotification(_0x3ca09b,_0xe4e8c0(0x263)+_0xeccea3[_0xe4e8c0(0x1b6)],![],_0xeccea3[_0xe4e8c0(0x2f4)]))),_0xeccea3[_0xe4e8c0(0x304)]&&_0xeccea3[_0xe4e8c0(0x304)][_0xe4e8c0(0x21d)]&&_0xeccea3['automationProposal'][_0xe4e8c0(0x253)]&&(_0x3ca09b[_0xe4e8c0(0x2a6)]['info'](_0xe4e8c0(0x250)+_0xeccea3[_0xe4e8c0(0x304)][_0xe4e8c0(0x312)]),await _0x3ca09b[_0xe4e8c0(0x174)](_0xe4e8c0(0x1ae),{'val':!![],'ack':!![]}),await _0x3ca09b[_0xe4e8c0(0x174)](_0xe4e8c0(0x303),{'val':_0xeccea3[_0xe4e8c0(0x304)][_0xe4e8c0(0x312)],'ack':!![]}),await _0x3ca09b['setStateAsync']('analysis.automation.targetId',{'val':_0xeccea3['automationProposal'][_0xe4e8c0(0x253)],'ack':!![]}),await _0x3ca09b[_0xe4e8c0(0x174)](_0xe4e8c0(0x325),{'val':JSON[_0xe4e8c0(0x1fd)](_0xeccea3[_0xe4e8c0(0x304)]['targetValue']),'ack':!![]}),_0x3e5ec2&&(_0x3ca09b[_0xe4e8c0(0x2a6)][_0xe4e8c0(0x1eb)]('ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20'+_0xeccea3[_0xe4e8c0(0x304)][_0xe4e8c0(0x253)]+_0xe4e8c0(0x2a1)),await executeAutomationAction(_0x3ca09b)));}catch(_0xa2e84c){_0x3ca09b[_0xe4e8c0(0x2a6)][_0xe4e8c0(0x318)](_0xe4e8c0(0x1b1)+_0xa2e84c[_0xe4e8c0(0x18c)]);}}function startPythonService(_0x399b6c){const _0x429d54=a0_0x48b8a0;try{const _0x53f25d=path[_0x429d54(0x19d)](__dirname,'python_service',_0x429d54(0x2ce));_0x399b6c[_0x429d54(0x2a6)][_0x429d54(0x1eb)](_0x429d54(0x16d)+_0x53f25d),_0x399b6c[_0x429d54(0x1ef)]=spawn(_0x429d54(0x269),[_0x53f25d]),_0x399b6c[_0x429d54(0x1ef)][_0x429d54(0x219)]['on']('data',_0x14a033=>{const _0x90e6d0=_0x429d54,_0x23c9c9=_0x14a033[_0x90e6d0(0x1a8)]()['trim']();_0x399b6c['log'][_0x90e6d0(0x177)](_0x90e6d0(0x238)+_0x23c9c9);}),_0x399b6c[_0x429d54(0x1ef)][_0x429d54(0x1df)]['on'](_0x429d54(0x2f7),_0x21440e=>{const _0xaccae8=_0x429d54,_0x44e3e6=_0x21440e[_0xaccae8(0x1a8)]()[_0xaccae8(0x282)]();_0x399b6c['log']['error'](_0xaccae8(0x2ba)+_0x44e3e6);}),_0x399b6c[_0x429d54(0x1ef)]['on']('close',_0x376151=>{const _0x142909=_0x429d54;_0x399b6c[_0x142909(0x2a6)][_0x142909(0x1eb)](_0x142909(0x19f)+_0x376151),_0x399b6c[_0x142909(0x1ef)]=null;}),_0x399b6c['pythonProcess']['on']('error',_0x391266=>{const _0x497a42=_0x429d54;_0x399b6c['log'][_0x497a42(0x19e)](_0x497a42(0x2c3)+_0x391266['message']);});}catch(_0x34f63f){_0x399b6c[_0x429d54(0x2a6)]['error']('Error\x20launching\x20Python\x20service:\x20'+_0x34f63f[_0x429d54(0x18c)]);}}function stopPythonService(_0xfe8b50){const _0x13d0ce=a0_0x48b8a0;if(_0xfe8b50[_0x13d0ce(0x1ef)]){_0xfe8b50[_0x13d0ce(0x2a6)][_0x13d0ce(0x1eb)]('üêç\x20Stopping\x20Python\x20Sidecar...');try{_0xfe8b50['pythonProcess']['kill']();}catch(_0x11bbb5){_0xfe8b50['log']['warn'](_0x13d0ce(0x260)+_0x11bbb5[_0x13d0ce(0x18c)]);}_0xfe8b50['pythonProcess']=null;}}class CogniLiving extends utils['Adapter']{constructor(_0x3fe70f){const _0x547712=a0_0x48b8a0;super({..._0x3fe70f,'name':_0x547712(0x2bb)}),this[_0x547712(0x1da)]=[],this[_0x547712(0x2ad)]=[],this[_0x547712(0x194)]=[],this[_0x547712(0x26e)]=[],this[_0x547712(0x2f5)]=[],this[_0x547712(0x19c)]={},this[_0x547712(0x296)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x547712(0x320)]=!![],this[_0x547712(0x2b1)]=null,this[_0x547712(0x1a7)]=null,this['isGracePeriodActive']=![],this[_0x547712(0x193)]=null,this[_0x547712(0x32d)]=null,this[_0x547712(0x2fb)]=SYSTEM_MODES[_0x547712(0x20a)],this[_0x547712(0x2cb)]=![],this['lastAlertState']=![],this[_0x547712(0x25e)]=_0x547712(0x31e),this[_0x547712(0x1f0)]=null,this[_0x547712(0x20e)]=null,this[_0x547712(0x1e7)]=null,this[_0x547712(0x328)]=null,this['briefingJob']=null,this[_0x547712(0x1ef)]=null,this['on'](_0x547712(0x273),this[_0x547712(0x25f)][_0x547712(0x1c3)](this)),this['on'](_0x547712(0x283),this[_0x547712(0x2f8)]['bind'](this)),this['on'](_0x547712(0x259),this['onUnload'][_0x547712(0x1c3)](this)),this['on'](_0x547712(0x18c),this[_0x547712(0x329)]['bind'](this));}async[a0_0x48b8a0(0x25f)](){const _0x594daa=a0_0x48b8a0;this[_0x594daa(0x2a6)][_0x594daa(0x1eb)](_0x594daa(0x1ec)+this[_0x594daa(0x223)]+_0x594daa(0x2c5)),await initZombies(this),this[_0x594daa(0x1c5)][_0x594daa(0x309)]=this[_0x594daa(0x1c5)][_0x594daa(0x309)]||'';try{this[_0x594daa(0x2cb)]=await checkLicense(this,this[_0x594daa(0x1c5)][_0x594daa(0x309)]);}catch(_0x19f176){}if(!this[_0x594daa(0x1c5)]['inactivityThresholdHours']||this[_0x594daa(0x1c5)][_0x594daa(0x2a5)]<0.1)this[_0x594daa(0x1c5)][_0x594daa(0x2a5)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x594daa(0x1c5)][_0x594daa(0x1c9)])try{this[_0x594daa(0x193)]=new GoogleGenerativeAI(this['config'][_0x594daa(0x1c9)]),this['geminiModel']=this['genAI'][_0x594daa(0x202)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x594daa(0x2a6)][_0x594daa(0x1eb)]('Gemini\x20AI\x20initialized.');}catch(_0x35f6f1){this[_0x594daa(0x2a6)][_0x594daa(0x318)](_0x594daa(0x2ac)+_0x35f6f1[_0x594daa(0x18c)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x594daa(0x307)](_0x594daa(0x251)),this[_0x594daa(0x307)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates']('system.mode'),this[_0x594daa(0x307)](_0x594daa(0x188)),this[_0x594daa(0x307)](_0x594daa(0x31a)),this[_0x594daa(0x307)](_0x594daa(0x243)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x594daa(0x1f0)])clearInterval(this['analysisTimer']);const _0x528da0=this['config'][_0x594daa(0x22b)]||0xf;_0x528da0>0x0&&(this['log'][_0x594daa(0x1eb)]('Starting\x20Autopilot\x20('+_0x528da0+'\x20min).'),this[_0x594daa(0x1f0)]=setInterval(()=>{runAutopilot(this);},_0x528da0*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this);}[a0_0x48b8a0(0x30e)](_0x1c5f30){const _0x7948e1=a0_0x48b8a0;if(this['analysisTimer'])clearInterval(this[_0x7948e1(0x1f0)]);if(this['driftAnalysisTimer'])clearInterval(this['driftAnalysisTimer']);if(this[_0x7948e1(0x20e)])this['ltmJob'][_0x7948e1(0x2d2)]();if(this[_0x7948e1(0x1e7)])this['modeResetJob'][_0x7948e1(0x2d2)]();if(this['briefingJob'])this[_0x7948e1(0x29c)][_0x7948e1(0x2d2)]();if(this[_0x7948e1(0x2b1)])clearTimeout(this[_0x7948e1(0x2b1)]);if(this['exitGraceTimer'])clearTimeout(this[_0x7948e1(0x1a7)]);stopPythonService(this),_0x1c5f30();}async['onStateChange'](_0x57e99d,_0x33d1c1){const _0xbb8d88=a0_0x48b8a0;if(!_0x33d1c1)return;if(_0x57e99d[_0xbb8d88(0x21e)]('telegram')&&_0x57e99d['endsWith'](_0xbb8d88(0x275))&&_0x33d1c1[_0xbb8d88(0x226)]){await handleTelegramResponse(this,_0x33d1c1[_0xbb8d88(0x226)]);return;}if(_0x57e99d===this[_0xbb8d88(0x1d2)]+'.'+SYSTEM_DP_MODE){_0x33d1c1[_0xbb8d88(0x226)]&&Object['values'](SYSTEM_MODES)[_0xbb8d88(0x21e)](_0x33d1c1[_0xbb8d88(0x226)])&&(this['currentSystemMode']=_0x33d1c1[_0xbb8d88(0x226)],_0x33d1c1[_0xbb8d88(0x226)]===SYSTEM_MODES[_0xbb8d88(0x25d)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x33d1c1['ack'])this['setState'](_0x57e99d,{'val':this[_0xbb8d88(0x2fb)],'ack':!![]});return;}if(!_0x33d1c1[_0xbb8d88(0x2d4)]){_0x57e99d[_0xbb8d88(0x21e)](_0xbb8d88(0x251))&&_0x33d1c1[_0xbb8d88(0x226)]&&(this[_0xbb8d88(0x205)](_0x57e99d,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x57e99d['includes'](_0xbb8d88(0x185))&&_0x33d1c1[_0xbb8d88(0x226)]){this[_0xbb8d88(0x205)](_0x57e99d,{'val':![],'ack':!![]});if(this[_0xbb8d88(0x2cb)])createDailyDigest(this);}_0x57e99d[_0xbb8d88(0x21e)](_0xbb8d88(0x2f3))&&_0x33d1c1[_0xbb8d88(0x226)]&&(this[_0xbb8d88(0x205)](_0x57e99d,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x57e99d[_0xbb8d88(0x21e)]('automation.triggerAction')&&_0x33d1c1[_0xbb8d88(0x226)]&&(this[_0xbb8d88(0x205)](_0x57e99d,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0xbb8d88(0x1c5)][_0xbb8d88(0x1c8)]&&this[_0xbb8d88(0x1c5)][_0xbb8d88(0x1c8)]['includes'](_0x57e99d)){await checkWifiPresence(this);return;}const _0x377e73=(this['config'][_0xbb8d88(0x1b9)]||[])[_0xbb8d88(0x287)](_0x10881d=>_0x10881d['id']===_0x57e99d);if(_0x377e73)processSensorEvent(this,_0x57e99d,_0x33d1c1,_0x377e73);}async[a0_0x48b8a0(0x329)](_0x3b0121){const _0x589a2d=a0_0x48b8a0;if(typeof _0x3b0121===_0x589a2d(0x323)&&_0x3b0121[_0x589a2d(0x18c)])try{if(_0x3b0121[_0x589a2d(0x1ba)]===_0x589a2d(0x2b6)){}else{if(_0x3b0121[_0x589a2d(0x1ba)]===_0x589a2d(0x1ab)){}else{if(_0x3b0121['command']===_0x589a2d(0x2bc)){if(!this[_0x589a2d(0x2cb)])return this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':![],'isPro':![]},_0x3b0121[_0x589a2d(0x2a8)]);let _0x191b56={'status':_0x589a2d(0x290),'details':'','lastCheck':0x0};try{_0x191b56[_0x589a2d(0x1f3)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x589a2d(0x226)],_0x191b56['details']=(await this[_0x589a2d(0x2c7)](LTM_DP_DRIFT_DETAILS))[_0x589a2d(0x226)],_0x191b56[_0x589a2d(0x17c)]=(await this[_0x589a2d(0x2c7)](LTM_DP_DRIFT_LAST_CHECK))[_0x589a2d(0x226)];}catch(_0x291b01){}const _0x604b8=this[_0x589a2d(0x2ad)]||[];this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x589a2d(0x2f5)],'driftAnalysis':_0x191b56,'analysisHistory':_0x604b8},_0x3b0121[_0x589a2d(0x2a8)]);}else{if(_0x3b0121[_0x589a2d(0x1ba)]===_0x589a2d(0x310)){const _0x2aabb9=this[_0x589a2d(0x2f5)][_0x589a2d(0x21c)],_0x12e86f=new Date(),_0x3d9a9d=new Date(_0x12e86f[_0x589a2d(0x2dd)](),_0x12e86f[_0x589a2d(0x2bd)](),_0x12e86f[_0x589a2d(0x235)]())[_0x589a2d(0x308)](),_0x370d5c=this[_0x589a2d(0x26e)][_0x589a2d(0x206)](_0x5368df=>new Date(_0x5368df[_0x589a2d(0x2b7)])[_0x589a2d(0x308)]()>_0x3d9a9d)[_0x589a2d(0x21c)],_0x2a4573=new Array(0x18)[_0x589a2d(0x2ed)](0x0);this[_0x589a2d(0x26e)][_0x589a2d(0x32f)](_0x442f07=>{const _0x3f142a=_0x589a2d,_0x8b56be=new Date(_0x442f07[_0x3f142a(0x2b7)]);if(_0x8b56be[_0x3f142a(0x308)]()>_0x3d9a9d)_0x2a4573[_0x8b56be[_0x3f142a(0x17b)]()]++;});let _0x41e0a8={'status':_0x589a2d(0x290)};try{_0x41e0a8[_0x589a2d(0x1f3)]=(await this[_0x589a2d(0x2c7)](LTM_DP_DRIFT_STATUS))[_0x589a2d(0x226)];}catch(_0x36068b){}let _0x3bbbf3='';try{const _0x2a1a58=await this['getStateAsync'](_0x589a2d(0x24d));_0x3bbbf3=_0x2a1a58?_0x2a1a58['val']:'';}catch(_0x19af06){}let _0x4b4688=null;!this[_0x589a2d(0x32d)]&&(_0x4b4688=this[_0x589a2d(0x1c5)][_0x589a2d(0x1c9)]?_0x589a2d(0x262):_0x589a2d(0x22f));let _0x563ab5={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x332d13=await this[_0x589a2d(0x2c7)](_0x589a2d(0x1ae)),_0x52ffbf=await this[_0x589a2d(0x2c7)]('analysis.automation.description'),_0x455bd5=await this['getStateAsync']('analysis.automation.targetId'),_0x350ad4=await this['getStateAsync']('analysis.automation.targetValue'),_0x559937=await this[_0x589a2d(0x2c7)](_0x589a2d(0x243));_0x332d13&&_0x332d13['val']&&(_0x563ab5[_0x589a2d(0x21d)]=!![],_0x563ab5[_0x589a2d(0x312)]=_0x52ffbf?_0x52ffbf[_0x589a2d(0x226)]:'',_0x563ab5[_0x589a2d(0x253)]=_0x455bd5?_0x455bd5['val']:'',_0x563ab5[_0x589a2d(0x2db)]=_0x350ad4?_0x350ad4['val']:''),_0x563ab5['autoApply']=_0x559937?!!_0x559937[_0x589a2d(0x226)]:![];}catch(_0x550298){}this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':!![],'eventHistory':this[_0x589a2d(0x1da)][_0x589a2d(0x18e)](0x0,0xf),'stats':{'digestCount':_0x2aabb9,'eventCountToday':_0x370d5c,'hourlyActivity':_0x2a4573,'driftStatus':_0x41e0a8[_0x589a2d(0x1f3)],'isPresent':this[_0x589a2d(0x320)],'presenceWho':_0x3bbbf3,'minDays':this['config'][_0x589a2d(0x330)]||0x7,'stbDays':this[_0x589a2d(0x1c5)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x589a2d(0x1c5)]['ltmLtbWindowDays']||0x3c,'systemError':_0x4b4688},'automation':_0x563ab5},_0x3b0121[_0x589a2d(0x2a8)]);}else{if(_0x3b0121[_0x589a2d(0x1ba)]===_0x589a2d(0x1ad)){const _0x31ab76=await this[_0x589a2d(0x178)]('enum.functions.*','enum'),_0xd5d780=[];if(_0x31ab76)for(const _0x595df3 in _0x31ab76){const _0x1d9745=_0x31ab76[_0x595df3],_0x218bfa=(_0x1d9745['common']&&typeof _0x1d9745[_0x589a2d(0x23e)][_0x589a2d(0x1f1)]==='object'?_0x1d9745['common'][_0x589a2d(0x1f1)]['de']:_0x1d9745[_0x589a2d(0x23e)]['name'])||_0x1d9745[_0x589a2d(0x23e)][_0x589a2d(0x1f1)];_0xd5d780[_0x589a2d(0x280)]({'id':_0x595df3,'name':_0x218bfa});}this[_0x589a2d(0x28c)](_0x3b0121['from'],_0x3b0121[_0x589a2d(0x1ba)],{'success':!![],'enums':_0xd5d780},_0x3b0121[_0x589a2d(0x2a8)]);}else{if(_0x3b0121[_0x589a2d(0x1ba)]===_0x589a2d(0x21b))try{const _0x1f69ab=await scanForDevices(this,_0x3b0121[_0x589a2d(0x18c)]||{});this['sendTo'](_0x3b0121['from'],_0x3b0121[_0x589a2d(0x1ba)],{'success':!![],'devices':_0x1f69ab},_0x3b0121[_0x589a2d(0x2a8)]);}catch(_0x220c58){this['sendTo'](_0x3b0121['from'],_0x3b0121[_0x589a2d(0x1ba)],{'success':![],'error':_0x220c58[_0x589a2d(0x18c)]},_0x3b0121[_0x589a2d(0x2a8)]);}else{if(_0x3b0121[_0x589a2d(0x1ba)]==='getCalendarNames'){const _0x2426bd=_0x3b0121[_0x589a2d(0x18c)][_0x589a2d(0x292)];if(!_0x2426bd)return this[_0x589a2d(0x28c)](_0x3b0121['from'],_0x3b0121[_0x589a2d(0x1ba)],{'success':![],'error':_0x589a2d(0x1b8)},_0x3b0121[_0x589a2d(0x2a8)]);const _0x1eaf98=await getCalendarNames(this,_0x2426bd);this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':!![],'names':_0x1eaf98},_0x3b0121[_0x589a2d(0x2a8)]);}else{if(_0x3b0121['command']===_0x589a2d(0x2c8)){const {targetId:_0x28bef7,targetValue:_0x44f38b}=_0x3b0121[_0x589a2d(0x18c)];this[_0x589a2d(0x2a6)][_0x589a2d(0x1eb)](_0x589a2d(0x20c)+_0x28bef7+_0x589a2d(0x289)+_0x44f38b),await this[_0x589a2d(0x174)](_0x589a2d(0x1ae),{'val':!![],'ack':!![]}),await this[_0x589a2d(0x174)]('analysis.automation.description',{'val':_0x589a2d(0x2ef)+_0x28bef7,'ack':!![]}),await this['setStateAsync'](_0x589a2d(0x1b4),{'val':_0x28bef7,'ack':!![]}),await this['setStateAsync'](_0x589a2d(0x325),{'val':_0x44f38b,'ack':!![]}),this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':!![]},_0x3b0121[_0x589a2d(0x2a8)]);}else{if(_0x3b0121[_0x589a2d(0x1ba)]===_0x589a2d(0x248)){const {historyId:_0x38c8c7,rating:_0x20e337,comment:_0x130148,alertReason:_0x30bc2c}=_0x3b0121[_0x589a2d(0x18c)];_0x38c8c7&&_0x20e337?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x38c8c7,'rating':_0x20e337,'comment':_0x130148,'alertReason':_0x30bc2c}),this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':!![]},_0x3b0121['callback'])):this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':![],'error':_0x589a2d(0x302)},_0x3b0121['callback']);}else _0x3b0121['command']===_0x589a2d(0x1c4)&&(this[_0x589a2d(0x2a6)][_0x589a2d(0x1eb)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x589a2d(0x174)](_0x589a2d(0x1ae),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x589a2d(0x303),{'val':'','ack':!![]}),this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':!![]},_0x3b0121[_0x589a2d(0x2a8)]));}}}}}}}}}catch(_0xfaaf65){this[_0x589a2d(0x2a6)][_0x589a2d(0x318)](_0x589a2d(0x1f8)+_0x3b0121[_0x589a2d(0x1ba)]+':\x20'+_0xfaaf65[_0x589a2d(0x18c)]);if(_0x3b0121['callback'])this[_0x589a2d(0x28c)](_0x3b0121[_0x589a2d(0x172)],_0x3b0121[_0x589a2d(0x1ba)],{'success':![],'error':_0xfaaf65['message']},_0x3b0121[_0x589a2d(0x2a8)]);}}}if(require[a0_0x48b8a0(0x1a9)]!==module)module[a0_0x48b8a0(0x190)]=_0x3da494=>new CogniLiving(_0x3da494);else new CogniLiving();