const a0_0x5740f0=a0_0x54ed;(function(_0x53d49f,_0x4bb4e1){const _0x48941f=a0_0x54ed,_0x2fec83=_0x53d49f();while(!![]){try{const _0x54e495=-parseInt(_0x48941f(0x236))/0x1*(-parseInt(_0x48941f(0x2d4))/0x2)+-parseInt(_0x48941f(0x15f))/0x3+-parseInt(_0x48941f(0x22e))/0x4*(-parseInt(_0x48941f(0x2cb))/0x5)+-parseInt(_0x48941f(0x1c1))/0x6+-parseInt(_0x48941f(0x234))/0x7*(-parseInt(_0x48941f(0x2a8))/0x8)+parseInt(_0x48941f(0x1ff))/0x9+parseInt(_0x48941f(0x23c))/0xa*(-parseInt(_0x48941f(0x340))/0xb);if(_0x54e495===_0x4bb4e1)break;else _0x2fec83['push'](_0x2fec83['shift']());}catch(_0x1269cf){_0x2fec83['push'](_0x2fec83['shift']());}}}(a0_0xf2fa,0x4ddf0));const a0_0x988eb=(function(){let _0x2873b1=!![];return function(_0x21d0b0,_0x3de128){const _0x435ecb=_0x2873b1?function(){const _0x46c7c5=a0_0x54ed;if(_0x3de128){const _0x231e5d=_0x3de128[_0x46c7c5(0x314)](_0x21d0b0,arguments);return _0x3de128=null,_0x231e5d;}}:function(){};return _0x2873b1=![],_0x435ecb;};}()),a0_0x2411a8=a0_0x988eb(this,function(){const _0x22aba9=a0_0x54ed;return a0_0x2411a8[_0x22aba9(0x164)]()[_0x22aba9(0x23e)](_0x22aba9(0x1f7))[_0x22aba9(0x164)]()[_0x22aba9(0x2e8)](a0_0x2411a8)[_0x22aba9(0x23e)]('(((.+)+)+)+$');});a0_0x2411a8();'use strict';const utils=require(a0_0x5740f0(0x213)),{GoogleGenerativeAI}=require(a0_0x5740f0(0x1cf)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x5740f0(0x2f2)),path=require(a0_0x5740f0(0x233)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x5740f0(0x2bb),LTM_SCHEDULE=a0_0x5740f0(0x25d),MODE_RESET_SCHEDULE=a0_0x5740f0(0x2ee),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,LTM_DP_RAW_LOG=a0_0x5740f0(0x270),LTM_DP_DAILY_DIGESTS=a0_0x5740f0(0x330),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x5740f0(0x1c8),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x5740f0(0x1ef),LTM_DP_DRIFT_LAST_CHECK=a0_0x5740f0(0x2b4),SYSTEM_DP_MODE=a0_0x5740f0(0x30b),HARD_IGNORE_TERMS=[a0_0x5740f0(0x26f),a0_0x5740f0(0x154),a0_0x5740f0(0x1b3),a0_0x5740f0(0x1ec),'lowbat','rssi',a0_0x5740f0(0x1a3),'maintenance',a0_0x5740f0(0x15e),'fault',a0_0x5740f0(0x2d2),a0_0x5740f0(0x1eb),a0_0x5740f0(0x281),a0_0x5740f0(0x222),a0_0x5740f0(0x174),a0_0x5740f0(0x258),a0_0x5740f0(0x32e),a0_0x5740f0(0x166)],BAD_NAMES=[a0_0x5740f0(0x207),a0_0x5740f0(0x327),a0_0x5740f0(0x197),'level','value',a0_0x5740f0(0x2b7),'on',a0_0x5740f0(0x221),'switch',a0_0x5740f0(0x2ff),a0_0x5740f0(0x25a),a0_0x5740f0(0x2a3),'cover',a0_0x5740f0(0x32b),a0_0x5740f0(0x2f6),a0_0x5740f0(0x226),a0_0x5740f0(0x14c),a0_0x5740f0(0x2fe),a0_0x5740f0(0x248),a0_0x5740f0(0x329),a0_0x5740f0(0x216),a0_0x5740f0(0x228),'valve',a0_0x5740f0(0x2f1),a0_0x5740f0(0x2ae)],ADAPTER_BLACKLIST=[a0_0x5740f0(0x322),a0_0x5740f0(0x1aa),a0_0x5740f0(0x225),a0_0x5740f0(0x2f4),a0_0x5740f0(0x206),a0_0x5740f0(0x1a8),a0_0x5740f0(0x204),a0_0x5740f0(0x308),a0_0x5740f0(0x28f),a0_0x5740f0(0x1e3),a0_0x5740f0(0x152)],SYSTEM_MODES={'NORMAL':a0_0x5740f0(0x21f),'VACATION':a0_0x5740f0(0x2c6),'PARTY':a0_0x5740f0(0x1a1),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x5740f0(0x326),'senior_aal':a0_0x5740f0(0x231),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x5740f0(0x193),'security':a0_0x5740f0(0x2ac)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x78a086){const _0x19ef3e=a0_0x5740f0;try{const _0x2ae4b1=[_0x19ef3e(0x20a),'events.history_debug_00'];for(const _0x3086ea of _0x2ae4b1){try{const _0x4bac1b=await _0x78a086['getObjectAsync'](_0x3086ea);_0x4bac1b&&await _0x78a086[_0x19ef3e(0x181)](_0x3086ea);}catch(_0x561f09){}}}catch(_0x1fd889){}}async function initHistory(_0x2869ae){const _0x5cbf77=a0_0x5740f0;try{const _0x180e19=await _0x2869ae['getStateAsync'](_0x5cbf77(0x1c9));_0x180e19&&_0x180e19[_0x5cbf77(0x2c0)]&&(_0x2869ae[_0x5cbf77(0x2b0)]=JSON[_0x5cbf77(0x1cb)](_0x180e19['val'][_0x5cbf77(0x164)]()));}catch(_0x1e2175){_0x2869ae['eventHistory']=[];}try{const _0x12f35d=await _0x2869ae[_0x5cbf77(0x2cd)]('analysis.analysisHistory');if(_0x12f35d&&_0x12f35d[_0x5cbf77(0x2c0)])_0x2869ae[_0x5cbf77(0x242)]=JSON[_0x5cbf77(0x1cb)](_0x12f35d[_0x5cbf77(0x2c0)][_0x5cbf77(0x164)]());}catch(_0x1c6093){_0x2869ae[_0x5cbf77(0x242)]=[];}if(_0x2869ae[_0x5cbf77(0x2b0)]&&_0x2869ae[_0x5cbf77(0x2b0)][_0x5cbf77(0x2b3)]>0x0){_0x2869ae[_0x5cbf77(0x23a)][_0x5cbf77(0x2e3)](_0x5cbf77(0x315)+_0x2869ae[_0x5cbf77(0x2b0)][_0x5cbf77(0x2b3)]+_0x5cbf77(0x283));for(let _0x41fea4=_0x2869ae[_0x5cbf77(0x2b0)][_0x5cbf77(0x2b3)]-0x1;_0x41fea4>=0x0;_0x41fea4--){const _0x366b82=_0x2869ae[_0x5cbf77(0x2b0)][_0x41fea4];_0x366b82&&_0x366b82['id']!==undefined&&_0x366b82['value']!==undefined&&(_0x2869ae[_0x5cbf77(0x29c)][_0x366b82['id']]=_0x366b82[_0x5cbf77(0x205)]);}}}async function initSystemConfig(_0x42eb95){const _0x49a452=a0_0x5740f0;try{const _0x5f8109=await _0x42eb95[_0x49a452(0x32f)](_0x49a452(0x27a));_0x5f8109&&_0x5f8109[_0x49a452(0x29f)]&&(_0x42eb95['systemConfig']={'latitude':_0x5f8109[_0x49a452(0x29f)][_0x49a452(0x1b7)]||0x0,'longitude':_0x5f8109[_0x49a452(0x29f)]['longitude']||0x0,'city':_0x5f8109[_0x49a452(0x29f)][_0x49a452(0x1e2)]||''});}catch(_0x3df7cf){}}async function checkLicense(_0x27e785,_0x34f035){const _0x391a0e=a0_0x5740f0;if(!_0x34f035)return![];_0x27e785['systemUUID']=await getSystemUUID(_0x27e785);if(_0x34f035===_0x391a0e(0x2f5)||_0x34f035[_0x391a0e(0x223)]('PRO-'))return!![];return![];}async function getSystemUUID(_0x193110){const _0x8c9609=a0_0x5740f0;try{const _0x4d292a=await _0x193110[_0x8c9609(0x32f)](_0x8c9609(0x21b));if(_0x4d292a&&_0x4d292a['native']&&_0x4d292a[_0x8c9609(0x214)][_0x8c9609(0x27b)])return _0x4d292a['native'][_0x8c9609(0x27b)];return _0x8c9609(0x334);}catch(_0x3dbacc){return'uuid-error';}}async function createAllObjects(_0x5d81ff){const _0x1fc0a7=a0_0x5740f0;await checkSystemObjects(_0x5d81ff),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x1a9),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x150),'type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x2e0),'read':!![],'write':![],'def':''},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x2c8),{'type':'state','common':{'name':_0x1fc0a7(0x2c4),'type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x16d),'read':!![],'write':![]},'native':{}}),await _0x5d81ff['setObjectNotExistsAsync'](_0x1fc0a7(0x1c9),{'type':_0x1fc0a7(0x197),'common':{'name':'Event\x20History','type':_0x1fc0a7(0x26d),'role':'json','read':!![],'write':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x189),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x145),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)]('analysis.triggerBriefing',{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x33a),'type':_0x1fc0a7(0x2bc),'role':_0x1fc0a7(0x2b1),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x1db),{'type':'state','common':{'name':_0x1fc0a7(0x33e),'type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x16d),'read':!![],'write':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x318),{'type':'state','common':{'name':_0x1fc0a7(0x293),'type':_0x1fc0a7(0x2bc),'role':_0x1fc0a7(0x1d2),'read':!![],'write':![],'def':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x20e),{'type':_0x1fc0a7(0x197),'common':{'name':'AI\x20Emergency\x20Status','type':_0x1fc0a7(0x2bc),'role':_0x1fc0a7(0x2a4),'read':!![],'write':![],'def':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)]('analysis.alertReason',{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x1e9),'type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x1b1),'read':!![],'write':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x2bd),{'type':_0x1fc0a7(0x197),'common':{'name':'Activity\x20Summary','type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x5d81ff['setObjectNotExistsAsync'](_0x1fc0a7(0x1cc),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x194),'type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x197),'read':!![],'write':![],'def':_0x1fc0a7(0x2ed)},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x19e),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x265),'type':'string','role':_0x1fc0a7(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x5d81ff['setObjectNotExistsAsync'](_0x1fc0a7(0x290),{'type':'state','common':{'name':_0x1fc0a7(0x162),'type':_0x1fc0a7(0x26d),'role':'text','read':!![],'write':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x2d0)](_0x1fc0a7(0x31b),{'type':_0x1fc0a7(0x333),'common':{'name':_0x1fc0a7(0x2c2)},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x23f),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x2ea),'type':'boolean','role':_0x1fc0a7(0x1b6),'read':!![],'write':![],'def':![]},'native':{}}),await _0x5d81ff['setObjectNotExistsAsync'](_0x1fc0a7(0x302),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x2a6),'type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)]('analysis.automation.suggestedAction',{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x2e2),'type':'string','role':_0x1fc0a7(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x1b8),{'type':'state','common':{'name':'Target\x20ID','type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x266),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x18c),'type':'string','role':_0x1fc0a7(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)]('analysis.automation.autoApply',{'type':'state','common':{'name':'Auto\x20Apply\x20Rule','type':_0x1fc0a7(0x2bc),'role':_0x1fc0a7(0x2e6),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5d81ff['setObjectNotExistsAsync']('analysis.automation.triggerAction',{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x33c),'type':_0x1fc0a7(0x2bc),'role':_0x1fc0a7(0x2b1),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x304),{'type':_0x1fc0a7(0x197),'common':{'name':'Logbook','type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x16d),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)]('analysis.feedbackHistory',{'type':'state','common':{'name':_0x1fc0a7(0x1e4),'type':'string','role':_0x1fc0a7(0x16d),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x2d0)](_0x1fc0a7(0x1e8),{'type':_0x1fc0a7(0x333),'common':{'name':_0x1fc0a7(0x1af)},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x1b9),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x2f8),'type':_0x1fc0a7(0x1c6),'role':_0x1fc0a7(0x2ce),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)]('analysis.health.restlessness',{'type':'state','common':{'name':_0x1fc0a7(0x306),'type':'string','role':'text','read':!![],'write':![],'def':_0x1fc0a7(0x220)},'native':{}}),await _0x5d81ff['setObjectNotExistsAsync']('analysis.health.notes',{'type':_0x1fc0a7(0x197),'common':{'name':'Health\x20Notes','type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x2e0),'read':!![],'write':![],'def':''},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x1dc),{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x144),'type':_0x1fc0a7(0x26d),'role':_0x1fc0a7(0x2e0),'read':!![],'write':![],'def':_0x1fc0a7(0x2ed)},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)](_0x1fc0a7(0x2af),{'type':'state','common':{'name':_0x1fc0a7(0x28c),'type':_0x1fc0a7(0x1c6),'role':_0x1fc0a7(0x205),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x2d0)](_0x1fc0a7(0x31a),{'type':'channel','common':{'name':_0x1fc0a7(0x163)},'native':{}}),await _0x5d81ff[_0x1fc0a7(0x20c)]('LTM.trainingData.sequences',{'type':_0x1fc0a7(0x197),'common':{'name':_0x1fc0a7(0x1ac),'type':'string','role':'json','read':!![],'write':![],'def':'[]','desc':_0x1fc0a7(0x24b)},'native':{}}),await checkLtmObjects(_0x5d81ff),await checkLtmDriftObjects(_0x5d81ff);}async function checkSystemObjects(_0x57d295){const _0x2bde32=a0_0x5740f0;await _0x57d295[_0x2bde32(0x2d0)](_0x2bde32(0x17c),{'type':'channel','common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0x57d295[_0x2bde32(0x2d0)](SYSTEM_DP_MODE,{'type':_0x2bde32(0x197),'common':{'name':_0x2bde32(0x195),'type':_0x2bde32(0x26d),'role':_0x2bde32(0x197),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x2bde32(0x1c5)]]:_0x2bde32(0x21c),[SYSTEM_MODES['VACATION']]:_0x2bde32(0x19d),[SYSTEM_MODES[_0x2bde32(0x30c)]]:'Party',[SYSTEM_MODES[_0x2bde32(0x27e)]]:_0x2bde32(0x2f0)}},'native':{}});}async function checkLtmObjects(_0x2e4ba3){const _0x164ed2=a0_0x5740f0;await _0x2e4ba3[_0x164ed2(0x2d0)]('LTM',{'type':_0x164ed2(0x333),'common':{'name':_0x164ed2(0x323)},'native':{}}),await _0x2e4ba3['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':'Raw\x20Log','type':_0x164ed2(0x26d),'role':_0x164ed2(0x16d),'read':!![],'write':![]},'native':{}}),await _0x2e4ba3[_0x164ed2(0x2d0)](LTM_DP_DAILY_DIGESTS,{'type':_0x164ed2(0x197),'common':{'name':_0x164ed2(0x317),'type':_0x164ed2(0x26d),'role':_0x164ed2(0x16d),'read':!![],'write':![]},'native':{}}),await _0x2e4ba3['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x164ed2(0x197),'common':{'name':_0x164ed2(0x247),'type':_0x164ed2(0x26d),'role':_0x164ed2(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x2e4ba3['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x164ed2(0x197),'common':{'name':_0x164ed2(0x2b5),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x2e4ba3[_0x164ed2(0x2d0)](LTM_DP_BASELINE_STATUS,{'type':_0x164ed2(0x197),'common':{'name':_0x164ed2(0x2b8),'type':_0x164ed2(0x26d),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x5b7209){const _0x2a62b9=a0_0x5740f0;await _0x5b7209['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x2a62b9(0x333),'common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x5b7209[_0x2a62b9(0x2d0)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x2a62b9(0x28b),'type':_0x2a62b9(0x26d),'role':'state','read':!![],'write':![],'def':_0x2a62b9(0x2ed)},'native':{}}),await _0x5b7209[_0x2a62b9(0x2d0)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x2a62b9(0x1bc),'type':_0x2a62b9(0x26d),'role':_0x2a62b9(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x5b7209[_0x2a62b9(0x2d0)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x2a62b9(0x197),'common':{'name':_0x2a62b9(0x313),'type':'number','role':_0x2a62b9(0x27f),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x2d823b){const _0x1f8324=a0_0x5740f0;try{const _0x4e0693=await _0x2d823b[_0x1f8324(0x2cd)](SYSTEM_DP_MODE);_0x4e0693&&_0x4e0693[_0x1f8324(0x2c0)]&&Object['values'](SYSTEM_MODES)[_0x1f8324(0x309)](_0x4e0693[_0x1f8324(0x2c0)])?_0x2d823b[_0x1f8324(0x2d9)]=_0x4e0693[_0x1f8324(0x2c0)]:(_0x2d823b[_0x1f8324(0x2d9)]=SYSTEM_MODES[_0x1f8324(0x1c5)],await _0x2d823b[_0x1f8324(0x24f)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1f8324(0x1c5)],'ack':!![]}));}catch(_0x179f95){_0x2d823b['currentSystemMode']=SYSTEM_MODES[_0x1f8324(0x1c5)];}}async function loadRawEventLog(_0xf91231){const _0x174648=a0_0x5740f0;try{const _0x412dc5=await _0xf91231['getStateAsync'](LTM_DP_RAW_LOG);if(_0x412dc5&&_0x412dc5[_0x174648(0x2c0)])_0xf91231['rawEventLog']=JSON[_0x174648(0x1cb)](_0x412dc5[_0x174648(0x2c0)]);}catch(_0x439a1b){_0xf91231[_0x174648(0x19f)]=[];}}async function saveRawEventLog(_0x48c626){const _0x224c59=a0_0x5740f0;_0x48c626[_0x224c59(0x19f)][_0x224c59(0x2b3)]>RAW_LOG_MAX_SIZE&&_0x48c626['rawEventLog'][_0x224c59(0x267)](0x0,_0x48c626[_0x224c59(0x19f)][_0x224c59(0x2b3)]-RAW_LOG_MAX_SIZE),await _0x48c626[_0x224c59(0x24f)](LTM_DP_RAW_LOG,{'val':JSON[_0x224c59(0x33f)](_0x48c626[_0x224c59(0x19f)]),'ack':!![]});}async function loadDailyDigests(_0x3cab4d){const _0x2158ee=a0_0x5740f0;try{const _0x46667a=await _0x3cab4d[_0x2158ee(0x2cd)](LTM_DP_DAILY_DIGESTS);if(_0x46667a&&_0x46667a['val'])_0x3cab4d[_0x2158ee(0x16f)]=JSON['parse'](_0x46667a[_0x2158ee(0x2c0)]);}catch(_0x4e719b){_0x3cab4d[_0x2158ee(0x16f)]=[];}await updateBaselineStatus(_0x3cab4d);}async function saveDailyDigests(_0x4609f2,_0x3ef3a3=!![]){const _0x41032b=a0_0x5740f0,_0x4d2f63=_0x4609f2['config'][_0x41032b(0x276)]||0x3c;_0x4609f2['dailyDigests'][_0x41032b(0x2b3)]>_0x4d2f63&&_0x4609f2[_0x41032b(0x16f)][_0x41032b(0x267)](0x0,_0x4609f2[_0x41032b(0x16f)][_0x41032b(0x2b3)]-_0x4d2f63);await _0x4609f2[_0x41032b(0x24f)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x41032b(0x33f)](_0x4609f2[_0x41032b(0x16f)]),'ack':!![]});if(_0x3ef3a3)await updateBaselineStatus(_0x4609f2);}async function updateAnalysisHistory(_0x446c79,_0x4072e3){const _0x9b3e59=a0_0x5740f0;_0x446c79[_0x9b3e59(0x242)][_0x9b3e59(0x142)](_0x4072e3);if(_0x446c79[_0x9b3e59(0x242)][_0x9b3e59(0x2b3)]>ANALYSIS_HISTORY_MAX_SIZE)_0x446c79[_0x9b3e59(0x242)][_0x9b3e59(0x21e)]();await _0x446c79[_0x9b3e59(0x24f)](_0x9b3e59(0x304),{'val':JSON['stringify'](_0x446c79[_0x9b3e59(0x242)]),'ack':!![]});}function a0_0xf2fa(){const _0x53fbd7=['exitGraceTimer','Missing\x20data','âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','WETTER:\x20Keine\x20Daten\x20gefunden','notifyTelegramEnabled','config','error','1627365alRkDz','filter','loc','Comfort\x20Suggestion','Training\x20Data\x20Sets','toString','08:00','link_quality','generateContent','analysisTimer','timestamp','notifyPushoverEnabled','send','sort','json','\x20=\x20','dailyDigests','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','kill','window','object','dutycycle','Verbindung\x20erfolgreich!\x20Antwort:\x20','push','from','notifyEmailInstance','ready','geminiApiKey','Exit\x20Sensor\x20triggered\x20(','system','namespace','klima','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','pythonProcess','delObjectAsync','setHours','notifyTelegramInstance','calendarSelection','Skipped\x20(No\x20AI\x20or\x20Data)','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','writable','dimmer','analysis.trigger','custom','health','Target\x20Value','targetId','lights','triggerDailyDigest','subscribeForeignStatesAsync','light','scheduleJob','Fokus\x20auf\x20Komfort.','Deviation','System\x20Mode','calendarInstance','state','Aktiv\x20(','triggerBriefing','onMessage','ðŸ\x20Stopping\x20Python\x20Sidecar...','sensor','Urlaub','analysis.comfortSummary','rawEventLog','\x20*\x20*\x20*','party','systemUUID','connection','slice','ltmDriftCheckIntervalHours','geminiModel','dependencyInstallInProgress','material.','system.presenceWho','admin.','.\x20OUTPUT:\x20Nur\x20Text.','Recorded\x20Motion\x20Sequences','driftDetails','getCalendarNames','Health\x20&\x20Sleep\x20Analysis','values','text.alarm','No\x20instance','update','apiKey','expire','indicator','latitude','analysis.automation.targetId','analysis.health.sleepScore','sendToAsync','licenseKey','Drift\x20Details','[RECORDER]\x20Error\x20saving\x20sequence:\x20','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','COGNI_REQUEST_CALL','summary','2812698iueBzG','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','main','payload','NORMAL','number','.\x0a\x20\x20\x20\x20WETTER:\x20','LTM.driftAnalysis','events.history','now','parse','analysis.deviationFromBaseline','detected','Deaktiviert\x20(Pro-Feature)','@google/generative-ai','ðŸš¨\x20EMERGENCY','getHours','indicator.alarm','getMonth','isProVersion',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','sleepScore','alertReason','Drift\x20Sched\x20Error:\x20','tÃ¼r','analysis.lastResult','analysis.health.trendDiagnosis','.\x20ZUSATZ:\x20','temp','\x20|\x20Status:\x20','unload','ack','city','javascript.','Feedback\x20Log','subscribeStates','[PYTHON]\x20','\x20(Value\x20is\x20falsy:\x20','analysis.health','Alert\x20Reason','exitTimer','direction','unreach','python3\x20-m\x20pip\x20install\x20-r\x20\x22','Guardian:\x20Sending\x20','LTM.driftAnalysis.driftDetails',').\x20Saving\x20to\x20Training\x20Data.','accuweather.0','baselineDrift','aiPersona','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','weather','Error\x20launching\x20Python\x20service:\x20','(((.+)+)+)+$','Sending\x20notification:\x20\x22','\x20min).','COGNI_CONFIRM_OK','toLowerCase','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','Lernphase\x20(','4640004QlVtOf','activityLevel','stderr','name','Feedback\x20saved:\x20','icons-mfd.','value','history.','targetposition','close','.\x0a\x20\x20\x20\x20KONTEXT:\x20','analysis.history_debug_00','minDaysForBaseline','setObjectNotExistsAsync','\x20presence\x20devices...','analysis.isEmergency','âŒ\x20FREE\x20MODE','getForeignObjectsAsync','python_service','isEmergency','@iobroker/adapter-core','native','ðŸ“¡\x20Hooking\x20into\x20','energy','BUTLER\x20Execution\x20Error:\x20','schalter','Briefing\x20Sched\x20Error:\x20','[TEST]\x20','system.meta.uuid','Normal','âœ…\x20Alles\x20OK\x20(Reset)','pop','normal','none','off','config_pending','startsWith','map','info.','presence','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','setpoint','doors','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','Kein\x20API\x20Key!','Error:\x20','onStateChange','26212GGIDms','cogni-living\x20adapter\x20starting\x20(v','Could\x20not\x20kill\x20Python\x20process:\x20','PRIORITÃ„T:\x20Gesundheit/AAL.','modeResetJob','path','590758KnhGqb','livingContext','4bmuqcC','\x20for\x20interactive\x20buttons...','getLtmData','[PYTHON\x20ERR]\x20','log','lastIndexOf','10RajmDm','automationProposal','search','analysis.automation.patternDetected','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','lampe','analysisHistory','\x0aSTB:\x20','WETTER:\x20','exports','join','Processing\x20Status','humidity','genAI','inactivityMonitoringEnabled','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','substring','lastCheck','instance','setStateAsync','weatherunderground.0','daswetter','write','analysis.triggerBriefing','KALENDER\x20ERROR:\x20','LTM.trainingData.sequences','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','firmware','message','shutter','Scheduling\x20Morning\x20Briefing\x20for\x20','indexOf','0\x203\x20*\x20*\x20*','autoApply','_calName','KALENDER:\x20Keine\x20Daten','replace','event','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','):\x20','Comfort\x20Summary','analysis.automation.targetValue','splice','presenceDevices','forEach','Generating\x20Morning\x20Briefing...','description','Entry\x20detected\x20via\x20','string','enum','scriptProblem','LTM.rawEventLog','Keine\x20Analyse.','notifyTelegramRecipient','\x20events','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','Unknown','ltmLtbWindowDays','openweathermap.0','getDate','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','system.config','uuid','sendTo','driftAnalysisTimer','GUEST','date','targetValue','stick_unreach','details','\x20events)...','KI-Modell\x20nicht\x20initialisiert','cancel','briefingJob','trim','Subscribing\x20to\x20','siren','getEnums','Drift\x20Status','Trend\x20Value\x20(%)','\x20|\x20','Morning\x20Briefing\x20sent.','echarts.','analysis.comfortSuggestion','systemConfig','devices','AI\x20Alert\x20Status','testNotification','No\x20module\x20named','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','automation.triggerAction','Alarm','Error\x20checking\x20WiFi:\x20','ANALYZE_TREND','PONG','sensorLastValues','getOverviewData','testApiKey','common','contact','openweathermap','debug','blind','indicator.alarm.fire','Wetter:\x20Deaktiviert','Description','.data.table','16hBUrrN','enum.rooms.*','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','time','PRIORITÃ„T:\x20Sicherheit.','âœ…\x20PRO\x20ACTIVATED','set_temperature','analysis.health.trendValue','eventHistory','button','response','length','LTM.driftAnalysis.lastCheck','Trigger\x20Digest','.Summary.Current','brightness','Baseline\x20Status','Briefing\x20Error:\x20','logDuplicates','models/gemini-flash-latest','boolean','analysis.activitySummary','analysis.alertReason','stdin','val','notifyEmailEnabled','Automation\x20Proposals','isGracePeriodActive','Last\x20raw\x20event','isArray','vacation','...','events.lastEvent','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','Keiner','335EaZFiX','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','getStateAsync','value.health','notifyEmailRecipient','extendObjectAsync','N/A\x20(Learning)','working','analysis.automation.autoApply','302200oavXxN','ltmJob','bind','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','useCalendar','currentSystemMode','split','_score','âš ï¸\x20ALARM:\x20','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','selectedFunctionIds','warn','text','Keine\x20Details.','Action','info','[LICENSE\x20CHECK]\x20Key\x20present:\x20','Kalender:\x20Deaktiviert','switch','\x20hours.\x20Potential\x20incapacitation.','constructor','simulateButler','Pattern\x20Detected','endsWith','members','N/A','0\x204\x20*\x20*\x20*','generic','Gast','actual_temperature','child_process','type','vis.','TEST-PRO-KEY','motion','toFixed','Sleep\x20Score\x20(0-100)','.NextHours.Location_1.Day_1.current.symbol_desc','stdout','ðŸŒ…\x20Daily\x20Briefing:\x0a','Say\x20Hello','submitFeedback','temperature','position','data','lastAlertState','analysis.automation.description','getForeignStateAsync','analysis.analysisHistory','round','Restlessness\x20Level','prÃ¤senz','flot.','includes','location','system.mode','PARTY','Success:\x20Compressed\x20','accuweather','setState','setForeignStateAsync','Started\x20at\x20','Error\x20reading\x20calendar\x20table:\x20','Last\x20Check','apply','Restoring\x20sensor\x20cache\x20from\x20history\x20(','toISOString','Daily\x20Digests','analysis.isAlert','kontakt','LTM.trainingData','analysis.automation','analysisInterval','feedbackHistory','notifyPushoverRecipient','Activity-Level','fill','communicate.request','system.','LTM','Cogni-Living','door','Analysiere\x20ausgewogen.','currentposition','KALENDER:\x20Keine\x20relevanten\x20Termine','power','daswetter.0','status','bewegung','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','reachable','getForeignObjectAsync','LTM.dailyDigests','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','channel','uuid-not-found','isPresent','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','licht','getGenerativeModel','notifyPushoverInstance','Trigger\x20Briefing\x20(Test)','getTime','Trigger\x20Action\x20Now','callback','Last\x20Result','stringify','4373567yMxoGW','command','unknown','Invalid\x20JSON\x20from\x20Python:\x20','unshift','TREND_RESULT','Trend\x20Diagnosis\x20(Python)','Trigger\x20Analysis','isExit','some','Gemini\x20AI\x20initialized.','onUnload','.forecast.current.state','heizung','occupancy',').\x20Starting\x20Timer.','\x20(Type\x20\x27','lock','Who\x20is\x20present?','ltmStbWindowDays','simple-api.','inactivityThresholdHours','scriptEnabled','fenster','\x20Tage)'];a0_0xf2fa=function(){return _0x53fbd7;};return a0_0xf2fa();}async function updateBaselineStatus(_0x2d9365){const _0x544c9e=a0_0x5740f0;if(!_0x2d9365['isProVersion']){await _0x2d9365['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x544c9e(0x1ce),'ack':!![]});return;}const _0x2f36d1=_0x2d9365[_0x544c9e(0x16f)][_0x544c9e(0x2b3)]>=(_0x2d9365['config'][_0x544c9e(0x20b)]||0x7)?_0x544c9e(0x198)+_0x2d9365[_0x544c9e(0x16f)][_0x544c9e(0x2b3)]+_0x544c9e(0x156):_0x544c9e(0x1fe)+_0x2d9365['dailyDigests']['length']+'/'+(_0x2d9365[_0x544c9e(0x15d)][_0x544c9e(0x20b)]||0x7)+')';await _0x2d9365[_0x544c9e(0x24f)](LTM_DP_BASELINE_STATUS,{'val':_0x2f36d1,'ack':!![]});}async function initSensorSubscriptions(_0x2f31fa){const _0x1f4848=a0_0x5740f0,_0x7a1af2=_0x2f31fa[_0x1f4848(0x15d)][_0x1f4848(0x292)];if(_0x7a1af2&&_0x7a1af2['length']>0x0){_0x2f31fa['log']['info'](_0x1f4848(0x288)+_0x7a1af2[_0x1f4848(0x2b3)]+'\x20sensors...');for(const _0x2663c0 of _0x7a1af2){if(_0x2663c0['id']){await _0x2f31fa[_0x1f4848(0x190)](_0x2663c0['id']);try{const _0x3c50a6=await _0x2f31fa[_0x1f4848(0x303)](_0x2663c0['id']);if(_0x3c50a6)_0x2f31fa['sensorLastValues'][_0x2663c0['id']]=_0x3c50a6['val'];}catch(_0x4a4c1a){}}}}}async function initPresenceSubscriptions(_0x2abdc9){const _0x39a8aa=a0_0x5740f0,_0x45478c=_0x2abdc9[_0x39a8aa(0x15d)][_0x39a8aa(0x268)]||[];if(_0x45478c[_0x39a8aa(0x2b3)]>0x0){_0x2abdc9[_0x39a8aa(0x23a)][_0x39a8aa(0x2e3)](_0x39a8aa(0x288)+_0x45478c[_0x39a8aa(0x2b3)]+_0x39a8aa(0x20d));for(const _0x1c2886 of _0x45478c){await _0x2abdc9[_0x39a8aa(0x190)](_0x1c2886);}try{await checkWifiPresence(_0x2abdc9);}catch(_0x56490f){}}}async function getWeatherContext(_0x1a6637){const _0x5f50ad=a0_0x5740f0;try{if(!_0x1a6637[_0x5f50ad(0x15d)]['useWeather'])return _0x5f50ad(0x2a5);let _0x2b636c='';const _0x2dc4bf=_0x1a6637[_0x5f50ad(0x15d)]['weatherInstance'];if(_0x2dc4bf)try{if(_0x2dc4bf['includes']('accuweather')){const _0x2a846c=await _0x1a6637[_0x5f50ad(0x303)](_0x2dc4bf+_0x5f50ad(0x2b6));if(_0x2a846c&&_0x2a846c[_0x5f50ad(0x2c0)])_0x2b636c=_0x2a846c[_0x5f50ad(0x2c0)];}else{if(_0x2dc4bf['includes'](_0x5f50ad(0x251))){const _0xde8b7a=await _0x1a6637['getForeignStateAsync'](_0x2dc4bf+_0x5f50ad(0x2f9));if(_0xde8b7a&&_0xde8b7a[_0x5f50ad(0x2c0)])_0x2b636c=_0xde8b7a[_0x5f50ad(0x2c0)];}else{if(_0x2dc4bf[_0x5f50ad(0x309)](_0x5f50ad(0x2a1))){const _0x5640b2=await _0x1a6637['getForeignStateAsync'](_0x2dc4bf+_0x5f50ad(0x14a));if(_0x5640b2&&_0x5640b2[_0x5f50ad(0x2c0)])_0x2b636c=_0x5640b2['val'];}}}}catch(_0x4e70fe){}if(!_0x2b636c){const _0x40e69b=[_0x5f50ad(0x1f1),_0x5f50ad(0x32a),_0x5f50ad(0x250),_0x5f50ad(0x277)];for(const _0x17e1cb of _0x40e69b){try{const _0x5515f2=await _0x1a6637[_0x5f50ad(0x32f)](_0x17e1cb);if(_0x5515f2){if(_0x17e1cb[_0x5f50ad(0x309)](_0x5f50ad(0x30e))){const _0x14c3d3=await _0x1a6637['getForeignStateAsync'](_0x17e1cb+_0x5f50ad(0x2b6));if(_0x14c3d3&&_0x14c3d3[_0x5f50ad(0x2c0)]){_0x2b636c=_0x14c3d3[_0x5f50ad(0x2c0)];break;}}}}catch(_0x29a8a7){}}}return _0x2b636c?_0x5f50ad(0x244)+_0x2b636c:_0x5f50ad(0x15b);}catch(_0x4ddd52){return'WETTER\x20ERROR:\x20'+_0x4ddd52[_0x5f50ad(0x259)];}}async function getCalendarContext(_0x4949b0){const _0x2e315e=a0_0x5740f0;try{if(!_0x4949b0[_0x2e315e(0x15d)][_0x2e315e(0x2d8)])return _0x2e315e(0x2e5);let _0x45aa69=_0x4949b0[_0x2e315e(0x15d)][_0x2e315e(0x196)]||'ical.0',_0x5bf84c=_0x4949b0[_0x2e315e(0x15d)][_0x2e315e(0x184)]||[];if(typeof _0x5bf84c===_0x2e315e(0x26d))_0x5bf84c=_0x5bf84c['split'](',');try{const _0x59b893=await _0x4949b0['getForeignStateAsync'](_0x45aa69+_0x2e315e(0x2a7));if(_0x59b893&&_0x59b893[_0x2e315e(0x2c0)]){let _0x532b1d=tryParse(_0x59b893['val']);if(_0x532b1d&&Array[_0x2e315e(0x2c5)](_0x532b1d)){if(_0x5bf84c['length']>0x0)_0x532b1d=_0x532b1d[_0x2e315e(0x160)](_0x237cf2=>_0x5bf84c[_0x2e315e(0x309)](_0x237cf2[_0x2e315e(0x25f)]||''));else return _0x2e315e(0x2d7);if(_0x532b1d[_0x2e315e(0x2b3)]>0x0){const _0x27b2d6=_0x532b1d['slice'](0x0,0x3)[_0x2e315e(0x224)](_0x5f00b1=>{const _0x2e39f7=_0x2e315e;let _0x45b78e=_0x5f00b1[_0x2e39f7(0x27f)];if(_0x5f00b1[_0x2e39f7(0x2ab)])_0x45b78e+='\x20'+_0x5f00b1['time'];return _0x45b78e+':\x20'+_0x5f00b1[_0x2e39f7(0x262)]+'\x20('+_0x5f00b1[_0x2e39f7(0x25f)]+')';});return'KALENDER:\x20'+_0x27b2d6[_0x2e315e(0x246)](_0x2e315e(0x28d));}else return _0x2e315e(0x328);}}}catch(_0x38c3de){_0x4949b0[_0x2e315e(0x23a)][_0x2e315e(0x2df)](_0x2e315e(0x312)+_0x38c3de[_0x2e315e(0x259)]);}return _0x2e315e(0x260);}catch(_0x812f57){return _0x2e315e(0x254)+_0x812f57[_0x2e315e(0x259)];}}async function getCalendarNames(_0x3fb7c8,_0x27c5d9){const _0x434343=a0_0x5740f0;try{const _0x132bcd=await _0x3fb7c8[_0x434343(0x303)](_0x27c5d9+_0x434343(0x2a7));if(_0x132bcd&&_0x132bcd[_0x434343(0x2c0)]){const _0x1cb584=tryParse(_0x132bcd[_0x434343(0x2c0)]);if(_0x1cb584&&Array[_0x434343(0x2c5)](_0x1cb584)){const _0x72a9be=[...new Set(_0x1cb584['map'](_0xb5ff97=>_0xb5ff97['_calName'])[_0x434343(0x160)](Boolean))];return _0x72a9be['sort']();}}return[];}catch(_0x3cbcfe){return _0x3fb7c8[_0x434343(0x23a)][_0x434343(0x15e)]('getCalendarNames\x20Error:\x20'+_0x3cbcfe[_0x434343(0x259)]),[];}}async function checkWifiPresence(_0x1c21df){const _0x57ca37=a0_0x5740f0;try{const _0x5bde5a=_0x1c21df[_0x57ca37(0x15d)][_0x57ca37(0x268)]||[];let _0x29dad4=![];const _0x46390b=[];for(const _0x45a09b of _0x5bde5a){try{const _0x132f6f=await _0x1c21df[_0x57ca37(0x303)](_0x45a09b);if(_0x132f6f&&(_0x132f6f[_0x57ca37(0x2c0)]===!![]||_0x132f6f['val']==='online'||_0x132f6f[_0x57ca37(0x2c0)]===0x1)){_0x29dad4=!![];const _0x3b9c22=await _0x1c21df['getForeignObjectAsync'](_0x45a09b);let _0x43009c=_0x45a09b;_0x3b9c22&&_0x3b9c22[_0x57ca37(0x29f)]&&_0x3b9c22[_0x57ca37(0x29f)][_0x57ca37(0x202)]&&(_0x43009c=typeof _0x3b9c22[_0x57ca37(0x29f)]['name']==='object'?_0x3b9c22[_0x57ca37(0x29f)][_0x57ca37(0x202)]['de']||_0x3b9c22[_0x57ca37(0x29f)][_0x57ca37(0x202)]['en']:_0x3b9c22[_0x57ca37(0x29f)][_0x57ca37(0x202)]),_0x46390b['push'](_0x43009c);}}catch(_0x3c3b9e){}}return await _0x1c21df[_0x57ca37(0x24f)](_0x57ca37(0x1a9),{'val':_0x46390b[_0x57ca37(0x246)](',\x20'),'ack':!![]}),_0x29dad4&&(_0x1c21df['exitTimer']&&(_0x1c21df[_0x57ca37(0x23a)][_0x57ca37(0x2e3)]('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),abortExitTimer(_0x1c21df)),!_0x1c21df[_0x57ca37(0x335)]&&_0x1c21df['currentSystemMode']===SYSTEM_MODES['NORMAL']&&await setPresence(_0x1c21df,!![])),_0x29dad4;}catch(_0xec655f){return _0x1c21df[_0x57ca37(0x23a)][_0x57ca37(0x15e)](_0x57ca37(0x299)+_0xec655f['message']),![];}}function startExitTimer(_0x409f0e){const _0x3da548=a0_0x5740f0;abortExitTimer(_0x409f0e),_0x409f0e[_0x3da548(0x2c3)]=!![],_0x409f0e[_0x3da548(0x157)]=setTimeout(()=>{const _0x24dd05=_0x3da548;_0x409f0e[_0x24dd05(0x2c3)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x409f0e[_0x3da548(0x1ea)]=setTimeout(()=>{setPresence(_0x409f0e,![]),_0x409f0e['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x35ec92){const _0x4fffdf=a0_0x5740f0;if(_0x35ec92[_0x4fffdf(0x1ea)])clearTimeout(_0x35ec92[_0x4fffdf(0x1ea)]);if(_0x35ec92[_0x4fffdf(0x157)])clearTimeout(_0x35ec92[_0x4fffdf(0x157)]);_0x35ec92[_0x4fffdf(0x1ea)]=null,_0x35ec92['exitGraceTimer']=null,_0x35ec92[_0x4fffdf(0x2c3)]=![];}async function setPresence(_0x6e520a,_0x3db05c){const _0x11c8a2=a0_0x5740f0;if(_0x6e520a['isPresent']===_0x3db05c)return;_0x6e520a[_0x11c8a2(0x335)]=_0x3db05c,await _0x6e520a[_0x11c8a2(0x24f)]('system.isPresent',{'val':_0x3db05c,'ack':!![]});}async function saveFeedback(_0x19771d,_0x11e350){const _0x4cfe90=a0_0x5740f0;_0x19771d['log'][_0x4cfe90(0x2e3)](_0x4cfe90(0x203)+JSON[_0x4cfe90(0x33f)](_0x11e350));}async function runBaselineDriftAnalysis(_0x1556de){const _0x11c5ed=a0_0x5740f0;if(!_0x1556de[_0x11c5ed(0x1d4)]||!_0x1556de['geminiModel'])return;const _0x16d56d=_0x1556de[_0x11c5ed(0x15d)]['ltmStbWindowDays']||0xe;if(_0x1556de[_0x11c5ed(0x16f)][_0x11c5ed(0x2b3)]<_0x16d56d+(_0x1556de[_0x11c5ed(0x15d)]['minDaysForBaseline']||0x7)){await _0x1556de[_0x11c5ed(0x24f)](LTM_DP_DRIFT_STATUS,{'val':_0x11c5ed(0x2d1),'ack':!![]});return;}const _0x5ecf6e=_0x1556de['dailyDigests'][_0x11c5ed(0x1a4)](-_0x16d56d),_0x4efde4=_0x1556de['dailyDigests'][_0x11c5ed(0x1a4)](0x0,_0x1556de['dailyDigests'][_0x11c5ed(0x2b3)]-_0x16d56d),_0x2b1fbd=_0x11c5ed(0x1fc)+JSON['stringify'](_0x4efde4)+_0x11c5ed(0x243)+JSON[_0x11c5ed(0x33f)](_0x5ecf6e);try{const _0x3788e4=await _0x1556de[_0x11c5ed(0x1a6)]['generateContent'](_0x2b1fbd),_0x20fdaf=JSON['parse'](_0x3788e4[_0x11c5ed(0x2b2)][_0x11c5ed(0x2e0)]()[_0x11c5ed(0x261)](/```json|```/g,'')[_0x11c5ed(0x287)]());_0x20fdaf[_0x11c5ed(0x1f2)]&&(await _0x1556de['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x20fdaf[_0x11c5ed(0x1f2)],'ack':!![]}),await _0x1556de[_0x11c5ed(0x24f)](LTM_DP_DRIFT_DETAILS,{'val':_0x20fdaf[_0x11c5ed(0x1ad)],'ack':!![]}),await _0x1556de[_0x11c5ed(0x24f)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x4dadfd){}}function a0_0x54ed(_0x54b71b,_0x5971ea){const _0x21d41e=a0_0xf2fa();return a0_0x54ed=function(_0x2411a8,_0x988eb){_0x2411a8=_0x2411a8-0x13f;let _0xf2fafa=_0x21d41e[_0x2411a8];return _0xf2fafa;},a0_0x54ed(_0x54b71b,_0x5971ea);}function setupLtmScheduler(_0x5aa7c1){const _0x5e0186=a0_0x5740f0;try{if(_0x5aa7c1[_0x5e0186(0x2d5)])_0x5aa7c1[_0x5e0186(0x2d5)][_0x5e0186(0x285)]();if(!_0x5aa7c1['isProVersion']){_0x5aa7c1['setStateAsync'](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x5aa7c1[_0x5e0186(0x2d5)]=schedule[_0x5e0186(0x192)](LTM_SCHEDULE,()=>createDailyDigest(_0x5aa7c1));}catch(_0x3b05c0){_0x5aa7c1[_0x5e0186(0x23a)]['error']('LTM\x20Sched\x20Error:\x20'+_0x3b05c0['message']);}}function setupModeResetScheduler(_0x549f53){const _0x3f0286=a0_0x5740f0;try{if(_0x549f53[_0x3f0286(0x232)])_0x549f53[_0x3f0286(0x232)][_0x3f0286(0x285)]();_0x549f53[_0x3f0286(0x232)]=schedule[_0x3f0286(0x192)](MODE_RESET_SCHEDULE,async()=>{const _0x3f274c=_0x3f0286;await loadSystemMode(_0x549f53),AUTO_RESET_MODES[_0x3f274c(0x309)](_0x549f53['currentSystemMode'])&&await _0x549f53[_0x3f274c(0x24f)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x1dae4e){_0x549f53[_0x3f0286(0x23a)][_0x3f0286(0x15e)]('Reset\x20Sched\x20Error:\x20'+_0x1dae4e['message']);}}function setupDriftAnalysisScheduler(_0x7741be){const _0x2e4c8e=a0_0x5740f0;try{if(_0x7741be[_0x2e4c8e(0x27d)])clearInterval(_0x7741be['driftAnalysisTimer']);if(!_0x7741be[_0x2e4c8e(0x1d4)])return;_0x7741be[_0x2e4c8e(0x27d)]=setInterval(()=>runBaselineDriftAnalysis(_0x7741be),(_0x7741be[_0x2e4c8e(0x15d)][_0x2e4c8e(0x1a5)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x7741be),0x1388);}catch(_0x437e17){_0x7741be['log'][_0x2e4c8e(0x15e)](_0x2e4c8e(0x1d9)+_0x437e17['message']);}}function setupBriefingScheduler(_0xfe5c76){const _0x26d9c5=a0_0x5740f0;try{if(_0xfe5c76['briefingJob'])_0xfe5c76[_0x26d9c5(0x286)][_0x26d9c5(0x285)]();if(!_0xfe5c76[_0x26d9c5(0x15d)]['briefingEnabled'])return;const _0x1f5dbc=(_0xfe5c76[_0x26d9c5(0x15d)]['briefingTime']||_0x26d9c5(0x165))[_0x26d9c5(0x2da)](':'),_0x4b719c=parseInt(_0x1f5dbc[0x0])||0x8,_0x1e2a6a=parseInt(_0x1f5dbc[0x1])||0x0,_0x1a458c=_0x1e2a6a+'\x20'+_0x4b719c+_0x26d9c5(0x1a0);_0xfe5c76[_0x26d9c5(0x23a)][_0x26d9c5(0x2e3)](_0x26d9c5(0x25b)+_0x4b719c+':'+(_0x1e2a6a<0xa?'0'+_0x1e2a6a:_0x1e2a6a)),_0xfe5c76['briefingJob']=schedule[_0x26d9c5(0x192)](_0x1a458c,()=>{sendMorningBriefing(_0xfe5c76);});}catch(_0x254f7a){_0xfe5c76[_0x26d9c5(0x23a)][_0x26d9c5(0x15e)](_0x26d9c5(0x219)+_0x254f7a[_0x26d9c5(0x259)]);}}async function sendNotification(_0x475b1e,_0x2ad13b,_0x289534=![],_0x47367f=![]){const _0x262d43=a0_0x5740f0;_0x475b1e[_0x262d43(0x23a)][_0x262d43(0x2e3)]((_0x289534?_0x262d43(0x21a):'')+_0x262d43(0x1f8)+_0x2ad13b+'\x22');const _0x2da7df=_0x475b1e[_0x262d43(0x15d)];let _0x10f24f=0x0;if(_0x2da7df[_0x262d43(0x15c)]){let _0x403b58={};(_0x2ad13b[_0x262d43(0x309)](_0x262d43(0x298))||_0x47367f)&&(_0x403b58={'reply_markup':{'inline_keyboard':[[{'text':_0x262d43(0x21d),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x262d43(0x296),'callback_data':_0x262d43(0x1bf)}]]}}),await _0x475b1e[_0x262d43(0x1ba)](_0x2da7df[_0x262d43(0x183)],_0x262d43(0x16b),{'text':_0x2ad13b,'user':_0x2da7df[_0x262d43(0x272)],..._0x403b58}),_0x10f24f++;}if(_0x2da7df[_0x262d43(0x16a)]){let _0x209aac={'message':_0x2ad13b,'title':_0x47367f?_0x262d43(0x1d0):_0x262d43(0x324),'priority':_0x47367f?0x2:0x1,'device':_0x2da7df[_0x262d43(0x31e)]};_0x47367f&&(_0x209aac['retry']=0x1e,_0x209aac[_0x262d43(0x1b5)]=0xe10,_0x209aac['sound']=_0x262d43(0x289)),await _0x475b1e['sendToAsync'](_0x2da7df[_0x262d43(0x339)],'send',_0x209aac),_0x10f24f++;}return _0x2da7df[_0x262d43(0x2c1)]&&(await _0x475b1e[_0x262d43(0x1ba)](_0x2da7df[_0x262d43(0x178)],'send',{'text':_0x2ad13b,'to':_0x2da7df[_0x262d43(0x2cf)]}),_0x10f24f++),_0x10f24f;}async function setupTelegramListener(_0x511991){const _0x12107=a0_0x5740f0,_0x6d33fb=_0x511991[_0x12107(0x15d)][_0x12107(0x183)];_0x511991[_0x12107(0x15d)][_0x12107(0x15c)]&&_0x6d33fb&&(_0x511991[_0x12107(0x23a)]['info'](_0x12107(0x215)+_0x6d33fb+_0x12107(0x237)),await _0x511991['subscribeForeignStatesAsync'](_0x6d33fb+'.communicate.request'));}async function handleTelegramResponse(_0x52fd95,_0x36676a){const _0x3d54cb=a0_0x5740f0;let _0x3392b0=_0x36676a;_0x36676a['startsWith']('[')&&(_0x3392b0=_0x36676a[_0x3d54cb(0x24c)](_0x36676a[_0x3d54cb(0x25c)](']')+0x1));if(_0x3392b0===_0x3d54cb(0x1fa))_0x52fd95[_0x3d54cb(0x23a)][_0x3d54cb(0x2e3)]('âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.'),await _0x52fd95[_0x3d54cb(0x24f)](_0x3d54cb(0x318),{'val':![],'ack':!![]}),await _0x52fd95[_0x3d54cb(0x24f)](_0x3d54cb(0x2be),{'val':_0x3d54cb(0x240),'ack':!![]}),_0x52fd95[_0x3d54cb(0x301)]=![],sendNotification(_0x52fd95,'âœ…\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x3392b0===_0x3d54cb(0x1bf)&&(_0x52fd95['log'][_0x3d54cb(0x2df)]('ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x52fd95,_0x3d54cb(0x1f4),![],!![]));}async function runAutopilot(_0xb84c63){const _0x3a119a=a0_0x5740f0,_0x4c943e=_0xb84c63[_0x3a119a(0x15d)][_0x3a119a(0x153)],_0x1cbe42=_0xb84c63[_0x3a119a(0x2b0)][_0x3a119a(0x2b3)]>0x0?_0xb84c63[_0x3a119a(0x2b0)][0x0][_0x3a119a(0x169)]:Date[_0x3a119a(0x1ca)](),_0xbd1252=(Date['now']()-_0x1cbe42)/(0x3e8*0x3c*0x3c);let _0x305d84='';_0xb84c63['config'][_0x3a119a(0x24a)]&&_0xb84c63[_0x3a119a(0x2d9)]===SYSTEM_MODES[_0x3a119a(0x1c5)]&&_0xb84c63[_0x3a119a(0x335)]&&(_0xbd1252>_0x4c943e&&(_0x305d84='HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0xbd1252[_0x3a119a(0x2f7)](0x1)+_0x3a119a(0x2e7))),runGeminiAnalysis(_0xb84c63,_0x305d84)['catch'](_0x69914f=>_0xb84c63[_0x3a119a(0x23a)][_0x3a119a(0x15e)](_0x69914f));}async function createDailyDigest(_0x5a7fa2){const _0x3f8ad4=a0_0x5740f0;if(!_0x5a7fa2[_0x3f8ad4(0x1d4)])return;await _0x5a7fa2['setStateAsync'](LTM_DP_STATUS,{'val':_0x3f8ad4(0x311)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x5a7fa2[_0x3f8ad4(0x1a6)]||_0x5a7fa2[_0x3f8ad4(0x19f)][_0x3f8ad4(0x2b3)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x5a7fa2[_0x3f8ad4(0x24f)](LTM_DP_STATUS,{'val':_0x3f8ad4(0x185),'ack':!![]});return;}const _0x5306a6=JSON[_0x3f8ad4(0x1cb)](JSON['stringify'](_0x5a7fa2[_0x3f8ad4(0x19f)])),_0xf732b7=_0x5306a6[_0x3f8ad4(0x2b3)],_0x24bb32=_0x3f8ad4(0x2c9)+JSON['stringify'](_0x5306a6);try{const _0x855d45=await _0x5a7fa2[_0x3f8ad4(0x1a6)]['generateContent'](_0x24bb32),_0x554578=JSON[_0x3f8ad4(0x1cb)](_0x855d45['response'][_0x3f8ad4(0x2e0)]()[_0x3f8ad4(0x261)](/```json|```/g,'')['trim']());_0x554578[_0x3f8ad4(0x1c0)]&&(_0x5a7fa2[_0x3f8ad4(0x16f)][_0x3f8ad4(0x176)]({'timestamp':new Date()[_0x3f8ad4(0x316)](),'eventCount':_0xf732b7,'summary':_0x554578['summary'],'activityLevel':_0x554578['activityLevel'],'systemMode':_0x5a7fa2[_0x3f8ad4(0x2d9)]}),await saveDailyDigests(_0x5a7fa2),_0x5a7fa2[_0x3f8ad4(0x19f)]=[],await saveRawEventLog(_0x5a7fa2),await _0x5a7fa2[_0x3f8ad4(0x24f)](LTM_DP_STATUS,{'val':_0x3f8ad4(0x30d)+_0xf732b7+_0x3f8ad4(0x273),'ack':!![]}),runPythonHealthCheck(_0x5a7fa2));}catch(_0x18c330){await _0x5a7fa2[_0x3f8ad4(0x24f)](LTM_DP_STATUS,{'val':_0x3f8ad4(0x22c)+_0x18c330[_0x3f8ad4(0x259)],'ack':!![]});}}async function sendMorningBriefing(_0xcf659b){const _0x27aa5d=a0_0x5740f0;if(!_0xcf659b['geminiModel'])return;_0xcf659b[_0x27aa5d(0x23a)][_0x27aa5d(0x2e3)](_0x27aa5d(0x26a));const _0x425a91=_0xcf659b[_0x27aa5d(0x16f)]['length']>0x0?_0xcf659b[_0x27aa5d(0x16f)][_0xcf659b[_0x27aa5d(0x16f)][_0x27aa5d(0x2b3)]-0x1]:null,_0x1acb85=_0x425a91&&_0x425a91[_0x27aa5d(0x18b)]?_0x425a91['health'][_0x27aa5d(0x1d7)]:_0x27aa5d(0x2ed),_0x696b55=new Date();_0x696b55[_0x27aa5d(0x182)](0x4,0x0,0x0,0x0);const _0x506663=_0xcf659b[_0x27aa5d(0x2b0)]['filter'](_0x54631a=>new Date(_0x54631a['timestamp'])>_0x696b55),_0xc0b620=PERSONA_MAPPING[_0xcf659b[_0x27aa5d(0x15d)][_0x27aa5d(0x1f3)]||_0x27aa5d(0x2ef)],_0x24f013=_0xcf659b[_0x27aa5d(0x15d)][_0x27aa5d(0x235)]||'',_0x332425=await getWeatherContext(_0xcf659b),_0x19d0dd=await getCalendarContext(_0xcf659b),_0x520aad=_0x27aa5d(0x17f)+_0xc0b620+'.\x20KONTEXT:\x20'+_0x24f013+_0x27aa5d(0x1dd)+_0x332425+'\x20'+_0x19d0dd+'.\x20DATEN:\x20Schlaf\x20'+_0x1acb85+_0x27aa5d(0x1fd)+JSON[_0x27aa5d(0x33f)](_0x506663['slice'](0x0,0xa))+_0x27aa5d(0x1ab);try{const _0x464fb0=await _0xcf659b[_0x27aa5d(0x1a6)][_0x27aa5d(0x167)](_0x520aad),_0x4d4d1a=_0x27aa5d(0x2fb)+_0x464fb0['response'][_0x27aa5d(0x2e0)]()['trim']();sendNotification(_0xcf659b,_0x4d4d1a),_0xcf659b[_0x27aa5d(0x23a)][_0x27aa5d(0x2e3)](_0x27aa5d(0x28e));}catch(_0x56ec6e){_0xcf659b['log']['error'](_0x27aa5d(0x2b9)+_0x56ec6e[_0x27aa5d(0x259)]);}}async function scanForDevices(_0x5deb3e,_0x575ba6){const _0x59c91f=a0_0x5740f0;_0x5deb3e['log'][_0x59c91f(0x2e3)](_0x59c91f(0x2dd));const _0x5c39c8=[],_0x3df09f=await _0x5deb3e['getForeignObjectsAsync']('*'),_0x3045ad=await _0x5deb3e[_0x59c91f(0x210)]('enum.functions.*','enum'),_0x240d2b=await _0x5deb3e[_0x59c91f(0x210)](_0x59c91f(0x2a9),_0x59c91f(0x26e)),_0x37be15={};if(_0x3045ad)for(const _0x5d0029 in _0x3045ad){const _0x37a98a=_0x3045ad[_0x5d0029][_0x59c91f(0x29f)][_0x59c91f(0x2ec)]||[];_0x37a98a[_0x59c91f(0x269)](_0x108916=>{const _0x1a0508=_0x59c91f;if(!_0x37be15[_0x108916])_0x37be15[_0x108916]=[];_0x37be15[_0x108916][_0x1a0508(0x176)](_0x5d0029);});}const _0x3fc0c6={};if(_0x240d2b)for(const _0x7e1a62 in _0x240d2b){const _0x5e78ad=_0x240d2b[_0x7e1a62][_0x59c91f(0x29f)]['members']||[],_0x2c2e71=typeof _0x240d2b[_0x7e1a62][_0x59c91f(0x29f)][_0x59c91f(0x202)]===_0x59c91f(0x173)?_0x240d2b[_0x7e1a62][_0x59c91f(0x29f)][_0x59c91f(0x202)]['de']:_0x240d2b[_0x7e1a62][_0x59c91f(0x29f)]['name'];_0x5e78ad[_0x59c91f(0x269)](_0x446352=>_0x3fc0c6[_0x446352]=_0x2c2e71);}const _0x3a57ab=_0x575ba6[_0x59c91f(0x2de)]||[],_0x21e9c0=_0x575ba6[_0x59c91f(0x2f6)]!==![],_0xddec27=_0x575ba6[_0x59c91f(0x229)]!==![],_0x125b47=_0x575ba6[_0x59c91f(0x18e)]!==![],_0x1d2ab1=_0x575ba6[_0x59c91f(0x2fe)]===!![],_0x185835=_0x575ba6[_0x59c91f(0x1f5)]===!![];for(const _0x1d3490 in _0x3df09f){const _0x27cbb1=_0x3df09f[_0x1d3490];if(_0x27cbb1['type']!==_0x59c91f(0x197)||!_0x27cbb1[_0x59c91f(0x29f)])continue;if(ADAPTER_BLACKLIST[_0x59c91f(0x147)](_0x3b84cf=>_0x1d3490[_0x59c91f(0x223)](_0x3b84cf))&&!_0x185835)continue;const _0x303c52=(_0x27cbb1[_0x59c91f(0x29f)]['role']||'')[_0x59c91f(0x1fb)]();let _0x2a89bb=(typeof _0x27cbb1[_0x59c91f(0x29f)]['name']===_0x59c91f(0x173)?_0x27cbb1[_0x59c91f(0x29f)][_0x59c91f(0x202)]['de']:_0x27cbb1['common']['name'])||_0x1d3490;const _0xc01313=_0x2a89bb['toLowerCase']();let _0x3fbe90=![],_0x4beae7=![];if(_0x3a57ab['length']>0x0){const _0x5e6b84=_0x37be15[_0x1d3490]||[],_0x4f12e3=_0x1d3490['split']('.')[_0x59c91f(0x1a4)](0x0,-0x1)[_0x59c91f(0x246)]('.'),_0x3ab612=_0x37be15[_0x4f12e3]||[];(_0x5e6b84[_0x59c91f(0x147)](_0x140afc=>_0x3a57ab['includes'](_0x140afc))||_0x3ab612[_0x59c91f(0x147)](_0x17b09a=>_0x3a57ab[_0x59c91f(0x309)](_0x17b09a)))&&(_0x3fbe90=!![],_0x4beae7=!![]);}if(!_0x3fbe90&&!_0x185835){if(HARD_IGNORE_TERMS[_0x59c91f(0x147)](_0x2bc23f=>_0x1d3490[_0x59c91f(0x309)](_0x2bc23f)||_0xc01313[_0x59c91f(0x309)](_0x2bc23f[_0x59c91f(0x1fb)]())))continue;}if(BAD_NAMES['some'](_0x15ab24=>_0xc01313===_0x15ab24||_0xc01313[_0x59c91f(0x2eb)]('.'+_0x15ab24))){const _0x21be21=_0x1d3490['split']('.');if(_0x21be21[_0x59c91f(0x2b3)]>0x2){const _0x247161=_0x21be21[_0x59c91f(0x1a4)](0x0,-0x1)[_0x59c91f(0x246)]('.'),_0x2971e8=_0x3df09f[_0x247161];if(_0x2971e8&&_0x2971e8[_0x59c91f(0x29f)]&&_0x2971e8[_0x59c91f(0x29f)][_0x59c91f(0x202)]){const _0x5b820e=typeof _0x2971e8[_0x59c91f(0x29f)]['name']===_0x59c91f(0x173)?_0x2971e8['common'][_0x59c91f(0x202)]['de']:_0x2971e8[_0x59c91f(0x29f)][_0x59c91f(0x202)];_0x5b820e&&!_0x2a89bb[_0x59c91f(0x309)](_0x5b820e)&&(_0x2a89bb=_0x5b820e+'\x20'+_0x2a89bb);}}}let _0x5ec531='';if(_0x21e9c0&&(_0x303c52['includes'](_0x59c91f(0x2f6))||_0x303c52[_0x59c91f(0x309)](_0x59c91f(0x14c))||_0xc01313[_0x59c91f(0x309)](_0x59c91f(0x32c))||_0xc01313[_0x59c91f(0x309)](_0x59c91f(0x307))))_0x5ec531='motion';else{if(!_0x5ec531&&_0xddec27&&(_0x303c52[_0x59c91f(0x309)](_0x59c91f(0x325))||_0x303c52[_0x59c91f(0x309)](_0x59c91f(0x172))||_0x303c52[_0x59c91f(0x309)](_0x59c91f(0x14f))||_0x303c52[_0x59c91f(0x309)](_0x59c91f(0x2a3))||_0x303c52['includes'](_0x59c91f(0x25a))||_0xc01313['includes'](_0x59c91f(0x155))||_0xc01313[_0x59c91f(0x309)]('tÃ¼r')||_0xc01313[_0x59c91f(0x309)]('rollladen')))_0x5ec531='door';else{if(!_0x5ec531&&_0x125b47&&(_0x303c52[_0x59c91f(0x309)]('light')||_0x303c52[_0x59c91f(0x309)](_0x59c91f(0x2e6))||_0x303c52[_0x59c91f(0x309)]('dimmer')||_0xc01313[_0x59c91f(0x309)](_0x59c91f(0x337))||_0xc01313[_0x59c91f(0x309)](_0x59c91f(0x241))||_0xc01313['includes']('schalter'))){if(_0x27cbb1[_0x59c91f(0x29f)][_0x59c91f(0x252)]||_0x303c52[_0x59c91f(0x309)](_0x59c91f(0x19c)))_0x5ec531='light';}else{if(!_0x5ec531&&_0x1d2ab1&&(_0x303c52[_0x59c91f(0x309)](_0x59c91f(0x2fe))||_0x303c52[_0x59c91f(0x309)]('humidity')||_0x303c52[_0x59c91f(0x309)]('thermostat')||_0xc01313[_0x59c91f(0x309)](_0x59c91f(0x1de))||_0xc01313[_0x59c91f(0x309)](_0x59c91f(0x17e))||_0xc01313[_0x59c91f(0x309)](_0x59c91f(0x14b))))_0x5ec531='temperature';else{if(!_0x5ec531&&_0x4beae7)_0x5ec531=_0x59c91f(0x18a);}}}}if(_0x5ec531){let _0x4891d8=_0x3fc0c6[_0x1d3490]||'';if(!_0x4891d8){let _0x2f6086=_0x1d3490;for(let _0x3b981a=0x0;_0x3b981a<0x3;_0x3b981a++){const _0x16a3bf=_0x2f6086[_0x59c91f(0x23b)]('.');if(_0x16a3bf===-0x1)break;_0x2f6086=_0x2f6086['substring'](0x0,_0x16a3bf);if(_0x3fc0c6[_0x2f6086]){_0x4891d8=_0x3fc0c6[_0x2f6086];break;}}}_0x5c39c8['push']({'id':_0x1d3490,'name':_0x2a89bb,'location':_0x4891d8,'type':_0x5ec531,'logDuplicates':_0x5ec531===_0x59c91f(0x2f6),'isExit':![],'_score':_0x4891d8?0x50:_0x5ec531===_0x59c91f(0x18a)?0x5a:0x28});}}return _0x5c39c8[_0x59c91f(0x16c)]((_0xe202c2,_0x294406)=>_0x294406[_0x59c91f(0x2db)]-_0xe202c2['_score']),_0x5c39c8;}async function executeAutomationAction(_0x151dfe){const _0x1b247d=a0_0x5740f0;try{const _0x3b123d=await _0x151dfe[_0x1b247d(0x2cd)](_0x1b247d(0x1b8)),_0x2f12a0=await _0x151dfe[_0x1b247d(0x2cd)]('analysis.automation.targetValue');if(_0x3b123d&&_0x3b123d[_0x1b247d(0x2c0)]&&_0x2f12a0){const _0x5d0dfe=_0x3b123d[_0x1b247d(0x2c0)];let _0xa470b=_0x2f12a0[_0x1b247d(0x2c0)];try{_0xa470b=JSON[_0x1b247d(0x1cb)](_0xa470b);}catch(_0x763e0){}_0x151dfe['log'][_0x1b247d(0x2e3)](_0x1b247d(0x331)+_0x5d0dfe+_0x1b247d(0x16e)+_0xa470b),await _0x151dfe[_0x1b247d(0x310)](_0x5d0dfe,_0xa470b);}else _0x151dfe[_0x1b247d(0x23a)][_0x1b247d(0x2df)](_0x1b247d(0x2cc));}catch(_0x11be1c){_0x151dfe[_0x1b247d(0x23a)][_0x1b247d(0x15e)](_0x1b247d(0x217)+_0x11be1c[_0x1b247d(0x259)]);}}function tryParse(_0x3ad21a){try{return JSON['parse'](_0x3ad21a);}catch(_0xb3f6a7){return null;}}async function recordSequence(_0x5b5bc9,_0x3e2f52){const _0x325def=a0_0x5740f0,_0x12f6f3=(_0x3e2f52[_0x325def(0x2f3)]||'')['toLowerCase'](),_0x4f1022=[_0x325def(0x2f6),_0x325def(0x32c),'prÃ¤senz','presence','occupancy','door',_0x325def(0x1da),_0x325def(0x172),_0x325def(0x155),_0x325def(0x2a0),_0x325def(0x319),_0x325def(0x191),'licht',_0x325def(0x2e6),_0x325def(0x218),_0x325def(0x188),_0x325def(0x241)];if(!_0x4f1022[_0x325def(0x147)](_0x390756=>_0x12f6f3[_0x325def(0x309)](_0x390756))){_0x5b5bc9[_0x325def(0x23a)][_0x325def(0x2a2)](_0x325def(0x170)+_0x3e2f52['id']+_0x325def(0x14e)+_0x3e2f52['type']+'\x27\x20not\x20in\x20allowed\x20list)');return;}if(!_0x3e2f52[_0x325def(0x205)]){_0x5b5bc9['log'][_0x325def(0x2a2)](_0x325def(0x170)+_0x3e2f52['id']+_0x325def(0x1e7)+_0x3e2f52[_0x325def(0x205)]+')');return;}_0x5b5bc9[_0x325def(0x23a)][_0x325def(0x2a2)](_0x325def(0x257)+_0x3e2f52['id']+'\x20('+_0x3e2f52[_0x325def(0x30a)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x359265={'loc':_0x3e2f52[_0x325def(0x30a)]||_0x325def(0x275),'id':_0x3e2f52['id'],'ts':Date[_0x325def(0x1ca)]()};activeSequence[_0x325def(0x176)](_0x359265),_0x5b5bc9[_0x325def(0x23a)][_0x325def(0x2a2)]('[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20'+_0x359265['loc']+'\x20(Length:\x20'+activeSequence['length']+')'),sequenceTimer=setTimeout(async()=>{const _0x3b8dd7=_0x325def;activeSequence[_0x3b8dd7(0x2b3)]>0x1?await saveCompletedSequence(_0x5b5bc9):(_0x5b5bc9[_0x3b8dd7(0x23a)][_0x3b8dd7(0x2a2)](_0x3b8dd7(0x186)+activeSequence[_0x3b8dd7(0x2b3)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x462244){const _0x2eca0f=a0_0x5740f0;try{_0x462244[_0x2eca0f(0x23a)][_0x2eca0f(0x2e3)](_0x2eca0f(0x22a)+activeSequence[_0x2eca0f(0x2b3)]+_0x2eca0f(0x1f0));const _0x5d67fc=await _0x462244['getStateAsync']('LTM.trainingData.sequences');let _0x1f1f60=[];if(_0x5d67fc&&_0x5d67fc['val'])try{_0x1f1f60=JSON[_0x2eca0f(0x1cb)](_0x5d67fc[_0x2eca0f(0x2c0)]);}catch(_0x279856){}const _0x188f4d=activeSequence[0x0]['ts'],_0x4a3109=activeSequence['map'](_0xb2bac4=>({'loc':_0xb2bac4[_0x2eca0f(0x161)],'t_delta':Math[_0x2eca0f(0x305)]((_0xb2bac4['ts']-_0x188f4d)/0x3e8)})),_0x3bfa3f={'timestamp':new Date(_0x188f4d)[_0x2eca0f(0x316)](),'steps':_0x4a3109,'duration':Math[_0x2eca0f(0x305)]((activeSequence[activeSequence[_0x2eca0f(0x2b3)]-0x1]['ts']-_0x188f4d)/0x3e8),'daytime':new Date(_0x188f4d)[_0x2eca0f(0x1d1)]()};_0x1f1f60[_0x2eca0f(0x176)](_0x3bfa3f),_0x1f1f60['length']>MAX_TRAINING_SET_SIZE&&_0x1f1f60['shift'](),await _0x462244['setStateAsync'](_0x2eca0f(0x255),{'val':JSON['stringify'](_0x1f1f60),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x285dea){_0x462244[_0x2eca0f(0x23a)][_0x2eca0f(0x15e)](_0x2eca0f(0x1bd)+_0x285dea[_0x2eca0f(0x259)]);}}async function processSensorEvent(_0x5c57eb,_0xb998a2,_0x5b1427,_0x4d84ad){const _0x294fb7=a0_0x5740f0;if(!_0x4d84ad)return;const _0x19ae5d=_0x5b1427[_0x294fb7(0x2c0)],_0x3f15b6=Date[_0x294fb7(0x1ca)]();_0x5c57eb['log']['debug']('Event\x20received:\x20'+_0xb998a2+'\x20=\x20'+_0x19ae5d);const _0x1f3c97=_0x5c57eb[_0x294fb7(0x29c)][_0xb998a2];_0x5c57eb[_0x294fb7(0x29c)][_0xb998a2]=_0x19ae5d;if(!_0x4d84ad[_0x294fb7(0x2ba)]&&_0x1f3c97!=undefined&&_0x1f3c97==_0x19ae5d){_0x5c57eb[_0x294fb7(0x23a)][_0x294fb7(0x2a2)]('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x4d84ad[_0x294fb7(0x202)]+'\x20(Value:\x20'+_0x19ae5d+')');return;}const _0x5f394f={'timestamp':_0x3f15b6,'id':_0xb998a2,'name':_0x4d84ad[_0x294fb7(0x202)],'type':_0x4d84ad[_0x294fb7(0x2f3)],'location':_0x4d84ad['location'],'value':_0x19ae5d};_0x5c57eb[_0x294fb7(0x2b0)][_0x294fb7(0x142)](_0x5f394f);if(_0x5c57eb[_0x294fb7(0x2b0)][_0x294fb7(0x2b3)]>HISTORY_MAX_SIZE)_0x5c57eb[_0x294fb7(0x2b0)]['pop']();await _0x5c57eb['setStateAsync'](_0x294fb7(0x2c8),{'val':JSON[_0x294fb7(0x33f)](_0x5f394f),'ack':!![]}),await _0x5c57eb['setStateAsync']('events.history',{'val':JSON['stringify'](_0x5c57eb['eventHistory']),'ack':!![]});_0x5c57eb['isProVersion']&&(_0x5c57eb['rawEventLog'][_0x294fb7(0x176)](_0x5f394f),await saveRawEventLog(_0x5c57eb),recordSequence(_0x5c57eb,_0x5f394f));if(_0x4d84ad[_0x294fb7(0x146)]&&_0x19ae5d===!![]){if(_0x5c57eb[_0x294fb7(0x335)]&&!_0x5c57eb[_0x294fb7(0x2c3)])_0x5c57eb[_0x294fb7(0x23a)][_0x294fb7(0x2e3)](_0x294fb7(0x17b)+_0x4d84ad['name']+_0x294fb7(0x14d)),startExitTimer(_0x5c57eb);else!_0x5c57eb['isPresent']&&(_0x5c57eb['log'][_0x294fb7(0x2e3)](_0x294fb7(0x26c)+_0x4d84ad[_0x294fb7(0x202)]+'.\x20Welcome\x20home.'),await setPresence(_0x5c57eb,!![]));}else _0x4d84ad[_0x294fb7(0x2f3)]===_0x294fb7(0x2f6)&&_0x19ae5d===!![]&&(_0x5c57eb[_0x294fb7(0x1ea)]&&(_0x5c57eb[_0x294fb7(0x23a)][_0x294fb7(0x2e3)](_0x294fb7(0x1d6)),abortExitTimer(_0x5c57eb)),!_0x5c57eb['isPresent']&&_0x5c57eb[_0x294fb7(0x2d9)]===SYSTEM_MODES[_0x294fb7(0x1c5)]&&await setPresence(_0x5c57eb,!![]));}async function runGeminiAnalysis(_0x4e19cb,_0x3b5c2b=''){const _0x48e204=a0_0x5740f0;if(!_0x4e19cb[_0x48e204(0x1a6)])return;if(_0x4e19cb[_0x48e204(0x2b0)]['length']===0x0)return;const _0x502364=_0x4e19cb[_0x48e204(0x2b0)]['slice'](0x0,0xf),_0x59af49=await getWeatherContext(_0x4e19cb),_0x3a52ff=_0x4e19cb[_0x48e204(0x2d9)],_0x510e20=PERSONA_MAPPING[_0x4e19cb[_0x48e204(0x15d)][_0x48e204(0x1f3)]||_0x48e204(0x2ef)],_0x197d46=_0x4e19cb[_0x48e204(0x15d)][_0x48e204(0x235)]||_0x48e204(0x2e1);let _0x5450eb=![];try{const _0x2969c0=await _0x4e19cb[_0x48e204(0x2cd)](_0x48e204(0x2d3));if(_0x2969c0&&_0x2969c0[_0x48e204(0x2c0)])_0x5450eb=!![];}catch(_0x768621){}const _0x241cb3=_0x48e204(0x263)+_0x510e20+_0x48e204(0x209)+_0x197d46+'.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20'+_0x3a52ff+_0x48e204(0x1c7)+_0x59af49+'.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20'+(_0x3b5c2b||_0x48e204(0x2ca))+_0x48e204(0x1c2)+JSON[_0x48e204(0x33f)](_0x502364)+_0x48e204(0x336);try{const _0x3ca10f=await _0x4e19cb[_0x48e204(0x1a6)][_0x48e204(0x167)](_0x241cb3),_0x4baa60=_0x3ca10f[_0x48e204(0x2b2)]['text']()[_0x48e204(0x261)](/```json|```/g,'')['trim'](),_0x54db42=JSON['parse'](_0x4baa60);await _0x4e19cb['setStateAsync']('analysis.lastResult',{'val':JSON[_0x48e204(0x33f)](_0x54db42),'ack':!![]});_0x54db42[_0x48e204(0x1c0)]&&await _0x4e19cb[_0x48e204(0x24f)](_0x48e204(0x2bd),{'val':_0x54db42[_0x48e204(0x1c0)],'ack':!![]});const _0x110e7a={'timestamp':Date[_0x48e204(0x1ca)](),'id':Date[_0x48e204(0x1ca)]()[_0x48e204(0x164)](),'analysis':{'activity':{'summary':_0x54db42[_0x48e204(0x1c0)]||_0x48e204(0x271),'isAlert':_0x54db42['isAlert']||![],'alertReason':_0x54db42['alertReason']},'comfort':{'automationProposal':_0x54db42[_0x48e204(0x23d)]}}};await updateAnalysisHistory(_0x4e19cb,_0x110e7a);const _0x5c172e=_0x54db42['isAlert']||![];_0x5c172e!==_0x4e19cb[_0x48e204(0x301)]&&(await _0x4e19cb[_0x48e204(0x24f)](_0x48e204(0x318),{'val':_0x5c172e,'ack':!![]}),_0x4e19cb[_0x48e204(0x301)]=_0x5c172e,_0x5c172e&&(await _0x4e19cb['setStateAsync'](_0x48e204(0x2be),{'val':_0x54db42[_0x48e204(0x1d8)],'ack':!![]}),sendNotification(_0x4e19cb,_0x48e204(0x2dc)+_0x54db42[_0x48e204(0x1d8)],![],_0x54db42[_0x48e204(0x212)]))),_0x54db42[_0x48e204(0x23d)]&&_0x54db42[_0x48e204(0x23d)][_0x48e204(0x1cd)]&&_0x54db42[_0x48e204(0x23d)][_0x48e204(0x18d)]&&(_0x4e19cb[_0x48e204(0x23a)][_0x48e204(0x2e3)]('ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20'+_0x54db42['automationProposal']['description']),await _0x4e19cb[_0x48e204(0x24f)](_0x48e204(0x23f),{'val':!![],'ack':!![]}),await _0x4e19cb['setStateAsync'](_0x48e204(0x302),{'val':_0x54db42[_0x48e204(0x23d)][_0x48e204(0x26b)],'ack':!![]}),await _0x4e19cb[_0x48e204(0x24f)](_0x48e204(0x1b8),{'val':_0x54db42[_0x48e204(0x23d)]['targetId'],'ack':!![]}),await _0x4e19cb[_0x48e204(0x24f)]('analysis.automation.targetValue',{'val':JSON[_0x48e204(0x33f)](_0x54db42[_0x48e204(0x23d)][_0x48e204(0x280)]),'ack':!![]}),_0x5450eb&&(_0x4e19cb['log'][_0x48e204(0x2e3)](_0x48e204(0x274)+_0x54db42['automationProposal'][_0x48e204(0x18d)]+'...'),await executeAutomationAction(_0x4e19cb)));}catch(_0x2552e2){_0x4e19cb[_0x48e204(0x23a)][_0x48e204(0x15e)]('Gemini\x20Analysis\x20Error:\x20'+_0x2552e2[_0x48e204(0x259)]);}}function installPythonDependencies(_0x17c7e5){const _0x174324=a0_0x5740f0;if(_0x17c7e5[_0x174324(0x1a7)])return;_0x17c7e5[_0x174324(0x1a7)]=!![];const _0x25829e=path[_0x174324(0x246)](__dirname,_0x174324(0x211),'requirements.txt');_0x17c7e5['log'][_0x174324(0x2e3)](_0x174324(0x332)+_0x25829e+_0x174324(0x2c7)),stopPythonService(_0x17c7e5);const _0x266680=_0x174324(0x1ed)+_0x25829e+'\x22\x20--break-system-packages';exec(_0x266680,(_0x4e85a1,_0x53865e,_0x4152a0)=>{const _0x5edb99=_0x174324;_0x17c7e5[_0x5edb99(0x1a7)]=![],_0x4e85a1?(_0x17c7e5['log'][_0x5edb99(0x15e)](_0x5edb99(0x159)+_0x266680),_0x17c7e5[_0x5edb99(0x23a)][_0x5edb99(0x15e)]('Details:\x20'+(_0x4152a0||_0x4e85a1[_0x5edb99(0x259)]))):(_0x17c7e5[_0x5edb99(0x23a)][_0x5edb99(0x2e3)](_0x5edb99(0x1be)),startPythonService(_0x17c7e5));});}function sendToPython(_0xcda91d,_0x48ea3b,_0x48be47={}){const _0x45cdff=a0_0x5740f0;if(!_0xcda91d['pythonProcess']||!_0xcda91d['pythonProcess'][_0x45cdff(0x2bf)][_0x45cdff(0x187)])return;const _0x1e22f6=JSON[_0x45cdff(0x33f)]({'command':_0x48ea3b,..._0x48be47});try{_0xcda91d[_0x45cdff(0x180)][_0x45cdff(0x2bf)][_0x45cdff(0x252)](_0x1e22f6+'\x0a');}catch(_0x23c376){_0xcda91d['log'][_0x45cdff(0x15e)]('Failed\x20to\x20send\x20to\x20Python:\x20'+_0x23c376['message']);}}function runPythonHealthCheck(_0x302b09){const _0x3e8e28=a0_0x5740f0;if(!_0x302b09[_0x3e8e28(0x16f)]||_0x302b09['dailyDigests'][_0x3e8e28(0x2b3)]<0x2){_0x302b09[_0x3e8e28(0x23a)][_0x3e8e28(0x2e3)](_0x3e8e28(0x15a));return;}const _0x2005f0=_0x302b09[_0x3e8e28(0x16f)][_0x3e8e28(0x224)](_0x50a475=>{const _0x5d9f1d=_0x3e8e28,_0x68670b=(_0x50a475[_0x5d9f1d(0x200)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x68670b]||0x32;});_0x302b09[_0x3e8e28(0x23a)][_0x3e8e28(0x2e3)](_0x3e8e28(0x1ee)+_0x2005f0[_0x3e8e28(0x2b3)]+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x302b09,_0x3e8e28(0x29a),{'values':_0x2005f0,'tag':_0x3e8e28(0x31f)});}function handlePythonResult(_0xef8770,_0x14ce05){const _0x539ef0=a0_0x5740f0;if(_0x14ce05[_0x539ef0(0x2f3)]===_0x539ef0(0x29b))_0xef8770['log'][_0x539ef0(0x2a2)]('ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.');else{if(_0x14ce05[_0x539ef0(0x2f3)]===_0x539ef0(0x143)){const {tag:_0x2d149a,diagnosis:_0xbcd88d,change_percent:_0x4974dc}=_0x14ce05[_0x539ef0(0x1c4)];_0xef8770[_0x539ef0(0x23a)][_0x539ef0(0x2e3)]('ðŸ\x20Guardian\x20Diagnosis\x20('+_0x2d149a+_0x539ef0(0x264)+_0xbcd88d+'\x20('+_0x4974dc+'%)'),_0xef8770['setStateAsync'](_0x539ef0(0x1dc),{'val':_0xbcd88d,'ack':!![]}),_0xef8770[_0x539ef0(0x24f)]('analysis.health.trendValue',{'val':_0x4974dc,'ack':!![]});}}}function startPythonService(_0x1ed87c){const _0x5901ae=a0_0x5740f0;try{const _0x4d9563=path[_0x5901ae(0x246)](__dirname,_0x5901ae(0x211),'service.py');_0x1ed87c[_0x5901ae(0x23a)][_0x5901ae(0x2e3)](_0x5901ae(0x279)+_0x4d9563),_0x1ed87c[_0x5901ae(0x180)]=spawn('python3',[_0x4d9563]),_0x1ed87c[_0x5901ae(0x180)][_0x5901ae(0x2fa)]['on']('data',_0x55a6d9=>{const _0x5831fe=_0x5901ae,_0x40d4e4=_0x55a6d9[_0x5831fe(0x164)]()[_0x5831fe(0x2da)]('\x0a');_0x40d4e4[_0x5831fe(0x269)](_0x195f5a=>{const _0x15acc2=_0x5831fe,_0x2908fb=_0x195f5a[_0x15acc2(0x287)]();if(!_0x2908fb)return;if(_0x2908fb[_0x15acc2(0x223)]('[LOG]'))_0x1ed87c['log']['debug'](_0x15acc2(0x1e6)+_0x2908fb[_0x15acc2(0x24c)](0x5)[_0x15acc2(0x287)]());else{if(_0x2908fb[_0x15acc2(0x223)]('[RESULT]'))try{const _0xb680da=JSON[_0x15acc2(0x1cb)](_0x2908fb[_0x15acc2(0x24c)](0x8)[_0x15acc2(0x287)]());handlePythonResult(_0x1ed87c,_0xb680da);}catch(_0x13a16){_0x1ed87c[_0x15acc2(0x23a)]['warn'](_0x15acc2(0x141)+_0x2908fb);}}(_0x2908fb['includes'](_0x15acc2(0x295))||_0x2908fb['includes']('Bibliotheken\x20nicht\x20gefunden'))&&(_0x1ed87c[_0x15acc2(0x23a)][_0x15acc2(0x2df)]('âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...'),installPythonDependencies(_0x1ed87c));});}),_0x1ed87c[_0x5901ae(0x180)][_0x5901ae(0x201)]['on'](_0x5901ae(0x300),_0x2997b8=>{const _0x556236=_0x5901ae,_0x5a0df6=_0x2997b8[_0x556236(0x164)]()[_0x556236(0x287)]();_0x1ed87c[_0x556236(0x23a)][_0x556236(0x15e)](_0x556236(0x239)+_0x5a0df6);}),_0x1ed87c[_0x5901ae(0x180)]['on'](_0x5901ae(0x208),_0x30868d=>{const _0x16a9c9=_0x5901ae;_0x1ed87c[_0x16a9c9(0x23a)][_0x16a9c9(0x2e3)](_0x16a9c9(0x256)+_0x30868d),_0x1ed87c[_0x16a9c9(0x180)]=null;}),_0x1ed87c[_0x5901ae(0x180)]['on'](_0x5901ae(0x15e),_0x1e1e01=>{const _0x7576da=_0x5901ae;_0x1ed87c[_0x7576da(0x23a)][_0x7576da(0x2df)](_0x7576da(0x2aa)+_0x1e1e01[_0x7576da(0x259)]);});}catch(_0x1f2de9){_0x1ed87c[_0x5901ae(0x23a)]['error'](_0x5901ae(0x1f6)+_0x1f2de9[_0x5901ae(0x259)]);}}function stopPythonService(_0x4afe16){const _0x316d7f=a0_0x5740f0;if(_0x4afe16[_0x316d7f(0x180)]){_0x4afe16['log']['info'](_0x316d7f(0x19b));try{_0x4afe16[_0x316d7f(0x180)][_0x316d7f(0x171)]();}catch(_0xd6f399){_0x4afe16['log'][_0x316d7f(0x2df)](_0x316d7f(0x230)+_0xd6f399[_0x316d7f(0x259)]);}_0x4afe16['pythonProcess']=null;}}class CogniLiving extends utils['Adapter']{constructor(_0x4f2a21){const _0x4af352=a0_0x5740f0;super({..._0x4f2a21,'name':'cogni-living'}),this[_0x4af352(0x2b0)]=[],this['analysisHistory']=[],this[_0x4af352(0x31d)]=[],this[_0x4af352(0x19f)]=[],this[_0x4af352(0x16f)]=[],this[_0x4af352(0x29c)]={},this[_0x4af352(0x291)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x4af352(0x335)]=!![],this[_0x4af352(0x1ea)]=null,this['exitGraceTimer']=null,this[_0x4af352(0x2c3)]=![],this['genAI']=null,this[_0x4af352(0x1a6)]=null,this['currentSystemMode']=SYSTEM_MODES[_0x4af352(0x1c5)],this[_0x4af352(0x1d4)]=![],this[_0x4af352(0x301)]=![],this[_0x4af352(0x1a2)]=_0x4af352(0x140),this[_0x4af352(0x168)]=null,this[_0x4af352(0x2d5)]=null,this['modeResetJob']=null,this[_0x4af352(0x27d)]=null,this[_0x4af352(0x286)]=null,this[_0x4af352(0x180)]=null,this[_0x4af352(0x1a7)]=![],this['on'](_0x4af352(0x179),this['onReady'][_0x4af352(0x2d6)](this)),this['on']('stateChange',this[_0x4af352(0x22d)]['bind'](this)),this['on'](_0x4af352(0x1e0),this[_0x4af352(0x149)][_0x4af352(0x2d6)](this)),this['on'](_0x4af352(0x259),this[_0x4af352(0x19a)]['bind'](this));}async['onReady'](){const _0x48a162=a0_0x5740f0;this[_0x48a162(0x23a)][_0x48a162(0x2e3)](_0x48a162(0x22f)+this['version']+_0x48a162(0x1d5)),await initZombies(this),this[_0x48a162(0x15d)]['licenseKey']=this['config'][_0x48a162(0x1bb)]||'';try{this[_0x48a162(0x1d4)]=await checkLicense(this,this[_0x48a162(0x15d)][_0x48a162(0x1bb)]);}catch(_0xcc132){}this['log'][_0x48a162(0x2e3)](_0x48a162(0x2e4)+!!this[_0x48a162(0x15d)][_0x48a162(0x1bb)]+_0x48a162(0x1df)+(this[_0x48a162(0x1d4)]?_0x48a162(0x2ad):_0x48a162(0x20f)));if(!this[_0x48a162(0x15d)][_0x48a162(0x153)]||this[_0x48a162(0x15d)]['inactivityThresholdHours']<0.1)this[_0x48a162(0x15d)][_0x48a162(0x153)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x48a162(0x15d)][_0x48a162(0x17a)])try{this[_0x48a162(0x249)]=new GoogleGenerativeAI(this['config'][_0x48a162(0x17a)]),this[_0x48a162(0x1a6)]=this['genAI'][_0x48a162(0x338)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this['log'][_0x48a162(0x2e3)](_0x48a162(0x148));}catch(_0x1e0329){this['log'][_0x48a162(0x15e)]('Gemini\x20Init\x20Error:\x20'+_0x1e0329[_0x48a162(0x259)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x48a162(0x1e5)](_0x48a162(0x189)),this[_0x48a162(0x1e5)](LTM_DP_TRIGGER_DIGEST),this[_0x48a162(0x1e5)]('system.mode'),this['subscribeStates'](_0x48a162(0x253)),this['subscribeStates']('analysis.automation.triggerAction'),this[_0x48a162(0x1e5)]('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0x48a162(0x168)]);const _0x24ebc7=this['config'][_0x48a162(0x31c)]||0xf;_0x24ebc7>0x0&&(this[_0x48a162(0x23a)][_0x48a162(0x2e3)]('Starting\x20Autopilot\x20('+_0x24ebc7+_0x48a162(0x1f9)),this[_0x48a162(0x168)]=setInterval(()=>{runAutopilot(this);},_0x24ebc7*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{this['pythonProcess']&&runPythonHealthCheck(this);},0x1388);}['onUnload'](_0x566adf){const _0x4fd229=a0_0x5740f0;if(this[_0x4fd229(0x168)])clearInterval(this[_0x4fd229(0x168)]);if(this[_0x4fd229(0x27d)])clearInterval(this[_0x4fd229(0x27d)]);if(this[_0x4fd229(0x2d5)])this['ltmJob'][_0x4fd229(0x285)]();if(this[_0x4fd229(0x232)])this['modeResetJob'][_0x4fd229(0x285)]();if(this[_0x4fd229(0x286)])this[_0x4fd229(0x286)]['cancel']();if(this['exitTimer'])clearTimeout(this['exitTimer']);if(this[_0x4fd229(0x157)])clearTimeout(this[_0x4fd229(0x157)]);stopPythonService(this),_0x566adf();}async['onStateChange'](_0xf0e62,_0x3d5c8a){const _0x5132f9=a0_0x5740f0;if(!_0x3d5c8a)return;if(_0xf0e62[_0x5132f9(0x309)]('telegram')&&_0xf0e62[_0x5132f9(0x2eb)](_0x5132f9(0x321))&&_0x3d5c8a[_0x5132f9(0x2c0)]){await handleTelegramResponse(this,_0x3d5c8a[_0x5132f9(0x2c0)]);return;}if(_0xf0e62===this[_0x5132f9(0x17d)]+'.'+SYSTEM_DP_MODE){_0x3d5c8a[_0x5132f9(0x2c0)]&&Object[_0x5132f9(0x1b0)](SYSTEM_MODES)['includes'](_0x3d5c8a[_0x5132f9(0x2c0)])&&(this[_0x5132f9(0x2d9)]=_0x3d5c8a[_0x5132f9(0x2c0)],_0x3d5c8a['val']===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x3d5c8a['ack'])this['setState'](_0xf0e62,{'val':this[_0x5132f9(0x2d9)],'ack':!![]});return;}if(!_0x3d5c8a[_0x5132f9(0x1e1)]){_0xf0e62['includes'](_0x5132f9(0x189))&&_0x3d5c8a['val']&&(this[_0x5132f9(0x30f)](_0xf0e62,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0xf0e62[_0x5132f9(0x309)](_0x5132f9(0x18f))&&_0x3d5c8a[_0x5132f9(0x2c0)]){this[_0x5132f9(0x30f)](_0xf0e62,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0xf0e62['includes'](_0x5132f9(0x199))&&_0x3d5c8a[_0x5132f9(0x2c0)]&&(this['setState'](_0xf0e62,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0xf0e62['includes'](_0x5132f9(0x297))&&_0x3d5c8a['val']&&(this[_0x5132f9(0x30f)](_0xf0e62,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x5132f9(0x15d)][_0x5132f9(0x268)]&&this[_0x5132f9(0x15d)][_0x5132f9(0x268)]['includes'](_0xf0e62)){await checkWifiPresence(this);return;}const _0x4e97fe=(this[_0x5132f9(0x15d)]['devices']||[])['find'](_0x520a22=>_0x520a22['id']===_0xf0e62);if(_0x4e97fe)processSensorEvent(this,_0xf0e62,_0x3d5c8a,_0x4e97fe);}async[a0_0x5740f0(0x19a)](_0x3496fa){const _0x38212b=a0_0x5740f0;if(typeof _0x3496fa===_0x38212b(0x173)&&_0x3496fa[_0x38212b(0x259)])try{if(_0x3496fa[_0x38212b(0x13f)]===_0x38212b(0x29e)){const _0xed25d9=_0x3496fa[_0x38212b(0x259)][_0x38212b(0x1b4)]||this['config']['geminiApiKey'];if(!_0xed25d9)return this[_0x38212b(0x27c)](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':![],'message':'Kein\x20API\x20Key\x20eingegeben.'},_0x3496fa[_0x38212b(0x33d)]);try{const _0x2fad3b=new GoogleGenerativeAI(_0xed25d9),_0x4943e1=_0x2fad3b[_0x38212b(0x338)]({'model':GEMINI_MODEL}),_0x57e006=await _0x4943e1['generateContent'](_0x38212b(0x2fc)),_0x576dc4=await _0x57e006['response'],_0xb97820=_0x576dc4[_0x38212b(0x2e0)]();this['sendTo'](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':!![],'message':_0x38212b(0x175)+_0xb97820['substring'](0x0,0x14)+_0x38212b(0x2c7)},_0x3496fa['callback']);}catch(_0x36e51e){this[_0x38212b(0x27c)](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':![],'message':'Fehler:\x20'+_0x36e51e['message']},_0x3496fa[_0x38212b(0x33d)]);}}else{if(_0x3496fa[_0x38212b(0x13f)]===_0x38212b(0x294)){}else{if(_0x3496fa[_0x38212b(0x13f)]===_0x38212b(0x238)){if(!this['isProVersion'])return this['sendTo'](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':![],'isPro':![]},_0x3496fa[_0x38212b(0x33d)]);let _0x2b4ef2={'status':_0x38212b(0x2ed),'details':'','lastCheck':0x0};try{_0x2b4ef2['status']=(await this[_0x38212b(0x2cd)](LTM_DP_DRIFT_STATUS))['val'],_0x2b4ef2[_0x38212b(0x282)]=(await this[_0x38212b(0x2cd)](LTM_DP_DRIFT_DETAILS))[_0x38212b(0x2c0)],_0x2b4ef2[_0x38212b(0x24d)]=(await this[_0x38212b(0x2cd)](LTM_DP_DRIFT_LAST_CHECK))[_0x38212b(0x2c0)];}catch(_0x5eb733){}const _0xfc0f1d=this[_0x38212b(0x242)]||[];this['sendTo'](_0x3496fa[_0x38212b(0x177)],_0x3496fa['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x38212b(0x16f)],'driftAnalysis':_0x2b4ef2,'analysisHistory':_0xfc0f1d},_0x3496fa[_0x38212b(0x33d)]);}else{if(_0x3496fa[_0x38212b(0x13f)]===_0x38212b(0x29d)){const _0x2faa5e=this[_0x38212b(0x16f)][_0x38212b(0x2b3)],_0x5e913b=new Date(),_0x564aeb=new Date(_0x5e913b['getFullYear'](),_0x5e913b[_0x38212b(0x1d3)](),_0x5e913b[_0x38212b(0x278)]())[_0x38212b(0x33b)](),_0x3f64cc=this['rawEventLog'][_0x38212b(0x160)](_0xde49ab=>new Date(_0xde49ab[_0x38212b(0x169)])[_0x38212b(0x33b)]()>_0x564aeb)[_0x38212b(0x2b3)],_0x27c36e=new Array(0x18)[_0x38212b(0x320)](0x0);this[_0x38212b(0x19f)][_0x38212b(0x269)](_0x499b30=>{const _0x19695c=_0x38212b,_0x2fb145=new Date(_0x499b30[_0x19695c(0x169)]);if(_0x2fb145[_0x19695c(0x33b)]()>_0x564aeb)_0x27c36e[_0x2fb145[_0x19695c(0x1d1)]()]++;});let _0x31fe7c={'status':_0x38212b(0x2ed)};try{_0x31fe7c[_0x38212b(0x32b)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x38212b(0x2c0)];}catch(_0x1933f3){}let _0x1489aa='';try{const _0x185348=await this[_0x38212b(0x2cd)](_0x38212b(0x1a9));_0x1489aa=_0x185348?_0x185348[_0x38212b(0x2c0)]:'';}catch(_0x1c4948){}let _0x527cf8=null;!this[_0x38212b(0x1a6)]&&(_0x527cf8=this[_0x38212b(0x15d)][_0x38212b(0x17a)]?_0x38212b(0x284):_0x38212b(0x22b));let _0x61ee2e={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x41cb72=await this[_0x38212b(0x2cd)](_0x38212b(0x23f)),_0x14e87d=await this[_0x38212b(0x2cd)](_0x38212b(0x302)),_0x214b21=await this[_0x38212b(0x2cd)](_0x38212b(0x1b8)),_0xf2443e=await this[_0x38212b(0x2cd)](_0x38212b(0x266)),_0x25630e=await this['getStateAsync'](_0x38212b(0x2d3));_0x41cb72&&_0x41cb72[_0x38212b(0x2c0)]&&(_0x61ee2e[_0x38212b(0x1cd)]=!![],_0x61ee2e['description']=_0x14e87d?_0x14e87d['val']:'',_0x61ee2e[_0x38212b(0x18d)]=_0x214b21?_0x214b21[_0x38212b(0x2c0)]:'',_0x61ee2e[_0x38212b(0x280)]=_0xf2443e?_0xf2443e['val']:''),_0x61ee2e[_0x38212b(0x25e)]=_0x25630e?!!_0x25630e['val']:![];}catch(_0x19d1b1){}this[_0x38212b(0x27c)](_0x3496fa[_0x38212b(0x177)],_0x3496fa['command'],{'success':!![],'eventHistory':this[_0x38212b(0x2b0)][_0x38212b(0x1a4)](0x0,0xf),'stats':{'digestCount':_0x2faa5e,'eventCountToday':_0x3f64cc,'hourlyActivity':_0x27c36e,'driftStatus':_0x31fe7c[_0x38212b(0x32b)],'isPresent':this[_0x38212b(0x335)],'presenceWho':_0x1489aa,'minDays':this['config'][_0x38212b(0x20b)]||0x7,'stbDays':this[_0x38212b(0x15d)][_0x38212b(0x151)]||0xe,'ltbDays':this[_0x38212b(0x15d)][_0x38212b(0x276)]||0x3c,'systemError':_0x527cf8},'automation':_0x61ee2e},_0x3496fa[_0x38212b(0x33d)]);}else{if(_0x3496fa[_0x38212b(0x13f)]===_0x38212b(0x28a)){const _0x505241=await this[_0x38212b(0x210)]('enum.functions.*',_0x38212b(0x26e)),_0x512226=[];if(_0x505241)for(const _0xcc9233 in _0x505241){const _0x4e4112=_0x505241[_0xcc9233],_0x28c5b2=(_0x4e4112[_0x38212b(0x29f)]&&typeof _0x4e4112[_0x38212b(0x29f)][_0x38212b(0x202)]==='object'?_0x4e4112[_0x38212b(0x29f)][_0x38212b(0x202)]['de']:_0x4e4112['common'][_0x38212b(0x202)])||_0x4e4112['common'][_0x38212b(0x202)];_0x512226['push']({'id':_0xcc9233,'name':_0x28c5b2});}this['sendTo'](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':!![],'enums':_0x512226},_0x3496fa['callback']);}else{if(_0x3496fa[_0x38212b(0x13f)]==='scanDevices')try{const _0x5874ca=await scanForDevices(this,_0x3496fa[_0x38212b(0x259)]||{});this[_0x38212b(0x27c)](_0x3496fa['from'],_0x3496fa[_0x38212b(0x13f)],{'success':!![],'devices':_0x5874ca},_0x3496fa[_0x38212b(0x33d)]);}catch(_0x53bebb){this['sendTo'](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':![],'error':_0x53bebb[_0x38212b(0x259)]},_0x3496fa[_0x38212b(0x33d)]);}else{if(_0x3496fa['command']===_0x38212b(0x1ae)){const _0x4f44e6=_0x3496fa[_0x38212b(0x259)][_0x38212b(0x24e)];if(!_0x4f44e6)return this[_0x38212b(0x27c)](_0x3496fa[_0x38212b(0x177)],_0x3496fa['command'],{'success':![],'error':_0x38212b(0x1b2)},_0x3496fa[_0x38212b(0x33d)]);const _0x50024a=await getCalendarNames(this,_0x4f44e6);this[_0x38212b(0x27c)](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':!![],'names':_0x50024a},_0x3496fa[_0x38212b(0x33d)]);}else{if(_0x3496fa['command']===_0x38212b(0x2e9)){const {targetId:_0x57d34b,targetValue:_0x1dbdfa}=_0x3496fa[_0x38212b(0x259)];this[_0x38212b(0x23a)][_0x38212b(0x2e3)](_0x38212b(0x32d)+_0x57d34b+_0x38212b(0x16e)+_0x1dbdfa),await this[_0x38212b(0x24f)](_0x38212b(0x23f),{'val':!![],'ack':!![]}),await this[_0x38212b(0x24f)](_0x38212b(0x302),{'val':_0x38212b(0x227)+_0x57d34b,'ack':!![]}),await this[_0x38212b(0x24f)](_0x38212b(0x1b8),{'val':_0x57d34b,'ack':!![]}),await this[_0x38212b(0x24f)](_0x38212b(0x266),{'val':_0x1dbdfa,'ack':!![]}),this[_0x38212b(0x27c)](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':!![]},_0x3496fa[_0x38212b(0x33d)]);}else{if(_0x3496fa[_0x38212b(0x13f)]===_0x38212b(0x2fd)){const {historyId:_0x2bcbc5,rating:_0x5a2303,comment:_0x2f1887,alertReason:_0x5dd57b}=_0x3496fa[_0x38212b(0x259)];_0x2bcbc5&&_0x5a2303?(await saveFeedback(this,{'timestamp':Date[_0x38212b(0x1ca)](),'historyId':_0x2bcbc5,'rating':_0x5a2303,'comment':_0x2f1887,'alertReason':_0x5dd57b}),this[_0x38212b(0x27c)](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':!![]},_0x3496fa[_0x38212b(0x33d)])):this[_0x38212b(0x27c)](_0x3496fa[_0x38212b(0x177)],_0x3496fa[_0x38212b(0x13f)],{'success':![],'error':_0x38212b(0x158)},_0x3496fa[_0x38212b(0x33d)]);}else _0x3496fa['command']==='dismissAutomation'&&(this[_0x38212b(0x23a)]['info']('User\x20dismissed\x20automation\x20proposal.'),await this[_0x38212b(0x24f)](_0x38212b(0x23f),{'val':![],'ack':!![]}),await this[_0x38212b(0x24f)](_0x38212b(0x302),{'val':'','ack':!![]}),this[_0x38212b(0x27c)](_0x3496fa['from'],_0x3496fa[_0x38212b(0x13f)],{'success':!![]},_0x3496fa[_0x38212b(0x33d)]));}}}}}}}}}catch(_0x300335){this[_0x38212b(0x23a)][_0x38212b(0x15e)]('Error\x20in\x20onMessage\x20command\x20'+_0x3496fa[_0x38212b(0x13f)]+':\x20'+_0x300335[_0x38212b(0x259)]);if(_0x3496fa[_0x38212b(0x33d)])this[_0x38212b(0x27c)](_0x3496fa['from'],_0x3496fa['command'],{'success':![],'error':_0x300335['message']},_0x3496fa[_0x38212b(0x33d)]);}}}if(require[a0_0x5740f0(0x1c3)]!==module)module[a0_0x5740f0(0x245)]=_0x13f48b=>new CogniLiving(_0x13f48b);else new CogniLiving();