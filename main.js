const a0_0x27f5f1=a0_0x4077;(function(_0x395539,_0x49d18e){const _0x2dd304=a0_0x4077,_0x2d3239=_0x395539();while(!![]){try{const _0x1264e0=-parseInt(_0x2dd304(0x268))/0x1*(parseInt(_0x2dd304(0x1a0))/0x2)+-parseInt(_0x2dd304(0x20d))/0x3+-parseInt(_0x2dd304(0x194))/0x4*(parseInt(_0x2dd304(0x1a2))/0x5)+parseInt(_0x2dd304(0x146))/0x6*(parseInt(_0x2dd304(0x13b))/0x7)+parseInt(_0x2dd304(0x1aa))/0x8*(parseInt(_0x2dd304(0x266))/0x9)+parseInt(_0x2dd304(0x26f))/0xa+-parseInt(_0x2dd304(0x187))/0xb;if(_0x1264e0===_0x49d18e)break;else _0x2d3239['push'](_0x2d3239['shift']());}catch(_0x2edb5c){_0x2d3239['push'](_0x2d3239['shift']());}}}(a0_0x3a14,0x41823));const a0_0x2a6445=(function(){let _0x2a193a=!![];return function(_0x4de91a,_0x550fde){const _0x3d7757=_0x2a193a?function(){const _0x3f30cb=a0_0x4077;if(_0x550fde){const _0x3a53f7=_0x550fde[_0x3f30cb(0x1db)](_0x4de91a,arguments);return _0x550fde=null,_0x3a53f7;}}:function(){};return _0x2a193a=![],_0x3d7757;};}()),a0_0x57250b=a0_0x2a6445(this,function(){const _0x306090=a0_0x4077;return a0_0x57250b[_0x306090(0x246)]()[_0x306090(0x18f)]('(((.+)+)+)+$')[_0x306090(0x246)]()[_0x306090(0x222)](a0_0x57250b)[_0x306090(0x18f)]('(((.+)+)+)+$');});a0_0x57250b();'use strict';const utils=require(a0_0x27f5f1(0x203)),{GoogleGenerativeAI}=require(a0_0x27f5f1(0x286)),{spawn}=require(a0_0x27f5f1(0x294)),path=require(a0_0x27f5f1(0x290)),fs=require('fs'),installer=require('./lib/installer'),scanner=require(a0_0x27f5f1(0x289)),schedulers=require(a0_0x27f5f1(0x247)),topology=require(a0_0x27f5f1(0x140)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x27f5f1(0x2a0),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x27f5f1(0x134),LTM_DP_DAILY_DIGESTS=a0_0x27f5f1(0x226),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x27f5f1(0x19a),LTM_DP_BASELINE_STATUS=a0_0x27f5f1(0x1df),LTM_DP_DRIFT_CHANNEL=a0_0x27f5f1(0x25d),LTM_DP_DRIFT_STATUS=a0_0x27f5f1(0x165),LTM_DP_DRIFT_DETAILS=a0_0x27f5f1(0x133),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x27f5f1(0x1bb),SYSTEM_MODES={'NORMAL':a0_0x27f5f1(0x1dc),'VACATION':a0_0x27f5f1(0x231),'PARTY':a0_0x27f5f1(0x236),'GUEST':a0_0x27f5f1(0x1c1)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x27f5f1(0x1a4)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x27f5f1(0x250),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x27f5f1(0x217),'security':a0_0x27f5f1(0x27f)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0xe0880e){const _0x8e2336=a0_0x27f5f1;try{const _0x463de2=[_0x8e2336(0x129),_0x8e2336(0x26a)];for(const _0x18260d of _0x463de2){try{const _0x510aa1=await _0xe0880e[_0x8e2336(0x27e)](_0x18260d);if(_0x510aa1)await _0xe0880e[_0x8e2336(0x212)](_0x18260d);}catch(_0x3ec452){}}}catch(_0x1a132a){}}async function checkLicense(_0x5e8f87){return!![];}async function initHistory(_0x518682){const _0x240584=a0_0x27f5f1;try{const _0x4f835d=await _0x518682[_0x240584(0x242)]('events.history');_0x4f835d&&_0x4f835d[_0x240584(0x12c)]&&(_0x518682['eventHistory']=JSON['parse'](_0x4f835d[_0x240584(0x12c)]['toString']()));}catch(_0x2dc24f){_0x518682['eventHistory']=[];}try{const _0x147c33=await _0x518682['getStateAsync'](_0x240584(0x154));if(_0x147c33&&_0x147c33[_0x240584(0x12c)])_0x518682['analysisHistory']=JSON[_0x240584(0x127)](_0x147c33[_0x240584(0x12c)]['toString']());}catch(_0x55b795){_0x518682[_0x240584(0x1fc)]=[];}if(_0x518682[_0x240584(0x22f)]&&_0x518682[_0x240584(0x22f)][_0x240584(0x299)]>0x0){_0x518682[_0x240584(0x1de)][_0x240584(0x1af)]('Restoring\x20sensor\x20cache...');for(let _0x21c8da=_0x518682['eventHistory']['length']-0x1;_0x21c8da>=0x0;_0x21c8da--){const _0x31936c=_0x518682['eventHistory'][_0x21c8da];if(_0x31936c&&_0x31936c['id']!==undefined&&_0x31936c[_0x240584(0x121)]!==undefined)_0x518682[_0x240584(0x130)][_0x31936c['id']]=_0x31936c[_0x240584(0x121)];}}}async function initSystemConfig(_0x47e742){const _0x291b7c=a0_0x27f5f1;try{const _0x2a0842=await _0x47e742['getForeignObjectAsync'](_0x291b7c(0x13d));if(_0x2a0842&&_0x2a0842[_0x291b7c(0x29b)])_0x47e742[_0x291b7c(0x215)]={'latitude':_0x2a0842[_0x291b7c(0x29b)][_0x291b7c(0x1ac)]||0x0,'longitude':_0x2a0842[_0x291b7c(0x29b)][_0x291b7c(0x1d4)]||0x0,'city':_0x2a0842[_0x291b7c(0x29b)]['city']||''};}catch(_0x4b9393){}}async function createAllObjects(_0x831dce){const _0x9b2d4a=a0_0x27f5f1;await _0x831dce[_0x9b2d4a(0x2ab)](_0x9b2d4a(0x1bc),{'type':_0x9b2d4a(0x1e1),'common':{'name':_0x9b2d4a(0x230)},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)](SYSTEM_DP_MODE,{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x1b5),'type':'string','role':_0x9b2d4a(0x276),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x9b2d4a(0x15f)]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x21b),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x24f),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x12a),'read':!![],'write':![]},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x297),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x138),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x137),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x148),'type':'string','role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)](_0x9b2d4a(0x1f3),{'type':'channel','common':{'name':'AI\x20Training'},'native':{}}),await _0x831dce['setObjectNotExistsAsync']('analysis.training.triggerSecurity',{'type':'state','common':{'name':'Train\x20Security','type':'boolean','role':'button','read':!![],'write':!![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x2af),{'type':'state','common':{'name':_0x9b2d4a(0x2a7),'type':_0x9b2d4a(0x182),'role':_0x9b2d4a(0x241),'read':!![],'write':!![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)]('analysis.training.triggerEnergy',{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x265),'type':_0x9b2d4a(0x182),'role':_0x9b2d4a(0x241),'read':!![],'write':!![]},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x223),{'type':'state','common':{'name':_0x9b2d4a(0x177),'type':_0x9b2d4a(0x182),'role':_0x9b2d4a(0x241),'read':!![],'write':!![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x1c9),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x277),'type':_0x9b2d4a(0x182),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x20b),{'type':'state','common':{'name':_0x9b2d4a(0x26c),'type':_0x9b2d4a(0x227),'role':'text','read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)](_0x9b2d4a(0x1da),{'type':_0x9b2d4a(0x1e1),'common':{'name':'Security\x20Monitor'},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x1a6),{'type':'state','common':{'name':'Anomaly\x20Score','type':_0x9b2d4a(0x160),'role':'value','read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x269),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x260),'type':'number','role':_0x9b2d4a(0x121),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x29e),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x1b1),'type':_0x9b2d4a(0x227),'role':'date','read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)](_0x9b2d4a(0x2ad),{'type':_0x9b2d4a(0x1e1),'common':{'name':'Graph\x20Topology'},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x14a),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x144),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x1f9),'read':!![],'write':![],'def':_0x9b2d4a(0x1d2)},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x135),{'type':'state','common':{'name':_0x9b2d4a(0x29f),'type':'string','role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)](_0x9b2d4a(0x122),{'type':_0x9b2d4a(0x1e1),'common':{'name':_0x9b2d4a(0x17a)},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x126),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x1b1),'type':'string','role':_0x9b2d4a(0x176),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x196),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x1c7),'type':_0x9b2d4a(0x182),'role':_0x9b2d4a(0x1b8),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x16a),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x264),'type':'string','role':_0x9b2d4a(0x12a),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x171),{'type':_0x9b2d4a(0x276),'common':{'name':'Trend\x20Value','type':_0x9b2d4a(0x160),'role':_0x9b2d4a(0x121),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x1d9),{'type':_0x9b2d4a(0x276),'common':{'name':'Today\x20Vector\x20(15m)','type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x1f7),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x199),'type':_0x9b2d4a(0x160),'role':_0x9b2d4a(0x121),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)](_0x9b2d4a(0x24d),{'type':_0x9b2d4a(0x1e1),'common':{'name':_0x9b2d4a(0x1d0)},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x20a),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x221),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x12a),'read':!![],'write':![]},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x272),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x233),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x12a),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)]('analysis.energy.forecast',{'type':_0x9b2d4a(0x276),'common':{'name':'Temperature\x20Forecast','type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)]('LTM',{'type':'channel','common':{'name':_0x9b2d4a(0x1d5)},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)](LTM_DP_RAW_LOG,{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x291),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x2ab)](LTM_DP_DAILY_DIGESTS,{'type':_0x9b2d4a(0x276),'common':{'name':'Daily\x20Digests','type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x1ae),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x213),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x185),{'type':_0x9b2d4a(0x276),'common':{'name':'Thermodynamics','type':'string','role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x271),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x26d),'type':'boolean','role':_0x9b2d4a(0x241),'read':!![],'write':!![]},'native':{}}),await _0x831dce['setObjectNotExistsAsync']('analysis.triggerBriefing',{'type':_0x9b2d4a(0x276),'common':{'name':'Trigger\x20Briefing','type':_0x9b2d4a(0x182),'role':_0x9b2d4a(0x241),'read':!![],'write':!![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x22b),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x1e4),'type':_0x9b2d4a(0x182),'role':_0x9b2d4a(0x131),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x164),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x206),'type':_0x9b2d4a(0x227),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x21d),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x1fd),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x12a),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)]('analysis.automation.patternDetected',{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x1cc),'type':_0x9b2d4a(0x182),'role':_0x9b2d4a(0x1b8),'read':!![],'write':![]},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x125),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x2b0),'type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x12a),'read':!![],'write':![]},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x2a8),{'type':_0x9b2d4a(0x276),'common':{'name':'Detected\x20Patterns','type':'string','role':_0x9b2d4a(0x1f9),'read':!![],'write':![]},'native':{}}),await _0x831dce['setObjectNotExistsAsync'](_0x9b2d4a(0x17d),{'type':_0x9b2d4a(0x276),'common':{'name':'Target\x20ID','type':'string','role':_0x9b2d4a(0x12a),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x13e),{'type':_0x9b2d4a(0x276),'common':{'name':'Target\x20Value','type':_0x9b2d4a(0x227),'role':_0x9b2d4a(0x12a),'read':!![],'write':![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x11b),{'type':_0x9b2d4a(0x276),'common':{'name':_0x9b2d4a(0x235),'type':_0x9b2d4a(0x182),'role':_0x9b2d4a(0x232),'read':!![],'write':!![]},'native':{}}),await _0x831dce[_0x9b2d4a(0x24c)](_0x9b2d4a(0x237),{'type':'state','common':{'name':_0x9b2d4a(0x214),'type':_0x9b2d4a(0x182),'role':'button','read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x598748){const _0x2c2982=a0_0x27f5f1;try{const _0x16979c=await _0x598748[_0x2c2982(0x242)](SYSTEM_DP_MODE);_0x16979c&&_0x16979c['val']&&Object[_0x2c2982(0x1f4)](SYSTEM_MODES)[_0x2c2982(0x20c)](_0x16979c[_0x2c2982(0x12c)])?_0x598748[_0x2c2982(0x195)]=_0x16979c[_0x2c2982(0x12c)]:(_0x598748['currentSystemMode']=SYSTEM_MODES[_0x2c2982(0x15f)],await _0x598748[_0x2c2982(0x155)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0xf02ed7){_0x598748['currentSystemMode']=SYSTEM_MODES[_0x2c2982(0x15f)];}}async function loadRawEventLog(_0x14560a){const _0x52895e=a0_0x27f5f1;try{const _0x160898=await _0x14560a[_0x52895e(0x242)](LTM_DP_RAW_LOG);if(_0x160898&&_0x160898['val'])_0x14560a[_0x52895e(0x225)]=JSON[_0x52895e(0x127)](_0x160898[_0x52895e(0x12c)]);}catch(_0x404f33){_0x14560a[_0x52895e(0x225)]=[];}}async function saveRawEventLog(_0xfc753c){const _0x8febfa=a0_0x27f5f1;if(_0xfc753c[_0x8febfa(0x225)]['length']>RAW_LOG_MAX_SIZE)_0xfc753c[_0x8febfa(0x225)][_0x8febfa(0x19e)](0x0,_0xfc753c['rawEventLog']['length']-RAW_LOG_MAX_SIZE);await _0xfc753c[_0x8febfa(0x155)](LTM_DP_RAW_LOG,{'val':JSON[_0x8febfa(0x1ab)](_0xfc753c['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x4b5c57){const _0x470153=a0_0x27f5f1;try{const _0x5352c4=await _0x4b5c57['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x5352c4&&_0x5352c4['val'])_0x4b5c57[_0x470153(0x280)]=JSON[_0x470153(0x127)](_0x5352c4[_0x470153(0x12c)]);}catch(_0x278690){_0x4b5c57[_0x470153(0x280)]=[];}await updateBaselineStatus(_0x4b5c57);}async function saveDailyDigests(_0x26e98d,_0x5af098=!![]){const _0x12d7da=a0_0x27f5f1,_0x4c081d=_0x26e98d[_0x12d7da(0x25a)]['ltmLtbWindowDays']||0x3c;_0x26e98d[_0x12d7da(0x280)][_0x12d7da(0x299)]>_0x4c081d&&_0x26e98d[_0x12d7da(0x280)][_0x12d7da(0x19e)](0x0,_0x26e98d[_0x12d7da(0x280)]['length']-_0x4c081d);await _0x26e98d[_0x12d7da(0x155)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x12d7da(0x1ab)](_0x26e98d[_0x12d7da(0x280)]),'ack':!![]});if(_0x5af098)await updateBaselineStatus(_0x26e98d);}async function updateAnalysisHistory(_0x56efe7,_0xb42710){const _0x2869b3=a0_0x27f5f1;_0x56efe7[_0x2869b3(0x1fc)][_0x2869b3(0x145)](_0xb42710);if(_0x56efe7[_0x2869b3(0x1fc)][_0x2869b3(0x299)]>HISTORY_MAX_SIZE)_0x56efe7[_0x2869b3(0x1fc)][_0x2869b3(0x200)]();await _0x56efe7[_0x2869b3(0x155)]('analysis.analysisHistory',{'val':JSON[_0x2869b3(0x1ab)](_0x56efe7[_0x2869b3(0x1fc)]),'ack':!![]});}async function updateBaselineStatus(_0x526c02){const _0x5758ed=a0_0x27f5f1;if(!_0x526c02[_0x5758ed(0x1e5)]){await _0x526c02[_0x5758ed(0x155)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x4fcc27=_0x526c02['dailyDigests'][_0x5758ed(0x299)]>=(_0x526c02['config'][_0x5758ed(0x14e)]||0x7)?'Aktiv\x20('+_0x526c02['dailyDigests']['length']+_0x5758ed(0x169):_0x5758ed(0x13f)+_0x526c02['dailyDigests'][_0x5758ed(0x299)]+'/'+(_0x526c02[_0x5758ed(0x25a)][_0x5758ed(0x14e)]||0x7)+')';await _0x526c02[_0x5758ed(0x155)](LTM_DP_BASELINE_STATUS,{'val':_0x4fcc27,'ack':!![]});}async function initSensorSubscriptions(_0xd7de90){const _0x55b162=a0_0x27f5f1,_0x154b99=_0xd7de90[_0x55b162(0x25a)][_0x55b162(0x1fb)];if(_0x154b99)for(const _0x3284ee of _0x154b99){await _0xd7de90['subscribeForeignStatesAsync'](_0x3284ee['id']);}}async function initPresenceSubscriptions(_0x9e35f4){const _0x14581e=a0_0x27f5f1,_0x2d5aed=_0x9e35f4[_0x14581e(0x25a)][_0x14581e(0x208)];if(_0x2d5aed)for(const _0x3891b0 of _0x2d5aed){await _0x9e35f4['subscribeForeignStatesAsync'](_0x3891b0);}}async function setupTelegramListener(_0x3726a6){const _0x39752a=a0_0x27f5f1,_0x3444ae=_0x3726a6[_0x39752a(0x25a)]['notifyTelegramInstance'];if(_0x3726a6[_0x39752a(0x25a)][_0x39752a(0x15b)]&&_0x3444ae)await _0x3726a6['subscribeForeignStatesAsync'](_0x3444ae+'.communicate.request');}async function checkWifiPresence(_0x2000ac){const _0x24da2d=a0_0x27f5f1;try{const _0x1b44bc=_0x2000ac[_0x24da2d(0x25a)]['presenceDevices']||[];let _0x1e27b7=![];const _0x5abed6=[];for(const _0x2cb46a of _0x1b44bc){try{const _0x360e3d=await _0x2000ac[_0x24da2d(0x1f2)](_0x2cb46a);_0x360e3d&&(_0x360e3d[_0x24da2d(0x12c)]===!![]||_0x360e3d[_0x24da2d(0x12c)]===_0x24da2d(0x18e)||_0x360e3d['val']===0x1)&&(_0x1e27b7=!![],_0x5abed6[_0x24da2d(0x179)](_0x2cb46a));}catch(_0x1386b5){}}return await _0x2000ac[_0x24da2d(0x155)]('system.presenceWho',{'val':_0x5abed6[_0x24da2d(0x156)](',\x20'),'ack':!![]}),_0x1e27b7&&(_0x2000ac['exitTimer']&&(_0x2000ac[_0x24da2d(0x1de)][_0x24da2d(0x1af)]('WiFi\x20Presence\x20detected.'),abortExitTimer(_0x2000ac)),!_0x2000ac[_0x24da2d(0x117)]&&_0x2000ac[_0x24da2d(0x195)]===SYSTEM_MODES[_0x24da2d(0x15f)]&&await setPresence(_0x2000ac,!![])),_0x1e27b7;}catch(_0x1a46e3){return![];}}function startExitTimer(_0x2bf389){const _0x178976=a0_0x27f5f1;abortExitTimer(_0x2bf389),_0x2bf389['isGracePeriodActive']=!![],_0x2bf389[_0x178976(0x168)]=setTimeout(()=>{const _0x4db1d6=_0x178976;_0x2bf389[_0x4db1d6(0x267)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x2bf389[_0x178976(0x17e)]=setTimeout(()=>{const _0x2a404c=_0x178976;setPresence(_0x2bf389,![]),_0x2bf389[_0x2a404c(0x17e)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x353ba1){const _0x56f71f=a0_0x27f5f1;if(_0x353ba1[_0x56f71f(0x17e)])clearTimeout(_0x353ba1[_0x56f71f(0x17e)]);if(_0x353ba1['exitGraceTimer'])clearTimeout(_0x353ba1['exitGraceTimer']);_0x353ba1['exitTimer']=null,_0x353ba1[_0x56f71f(0x168)]=null,_0x353ba1[_0x56f71f(0x267)]=![];}async function setPresence(_0x11b11b,_0x24caa4){const _0x44b6cc=a0_0x27f5f1;if(_0x11b11b[_0x44b6cc(0x117)]===_0x24caa4)return;_0x11b11b[_0x44b6cc(0x117)]=_0x24caa4,await _0x11b11b['setStateAsync']('system.isPresent',{'val':_0x24caa4,'ack':!![]});}function a0_0x3a14(){const _0x11d494=['driftAnalysisTimer','1657100DpQgop','telegram','analysis.trigger','analysis.energy.heatingScore','warn','trim','baselineDrift','state','Build\x20Topology','COMFORT_RESULT','ANALYZE_SEQUENCE','âš ï¸\x20ALARM:\x20','application/json','.forecast.current.temp','GAIT_RESULT','getObjectAsync','PRIORITÃ„T:\x20Sicherheit.','dailyDigests','insulation','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','map','calendarInstance','.\x20SYSTEM_MODE:\x20','@google/generative-ai','schalter','status','./lib/scanner','PYTHON_EXE','bewegung','Adapter','ANALYZE_TREND','command','summary','path','Raw\x20Log','loc','.Current.WeatherText','child_process','ltmStbWindowDays','ðŸ•¸ï¸\x20Topology\x20Graph\x20manually\x20updated\x20by\x20user.','events.lastEvent','Gemini\x20AI\x20initialized.','length','openweathermap','common','analysisTimer','systemUUID','analysis.security.lastCheck','Topology\x20Matrix\x20(Legacy)','models/gemini-flash-latest','.forecast.current.state','ltmJob','getCalendarNames','matrix','licenseKey','geminiApiKey','Train\x20Health','analysis.automation.detectedPatterns','scanForDevices','callback','extendObjectAsync','.\x20EMERGENCY:\x20','analysis.topology','TRAINING_COMPLETE','analysis.training.triggerHealth','Description','ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.','from','isPresent','analysisInterval','ENERGY_TRAIN_RESULT','SECURITY_RESULT','analysis.automation.autoApply','Digest','checkAndInstall','getForeignObjectsAsync','HEALTH_RESULT','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','value','analysis.health','getTime','.forecast.current.temperature','analysis.automation.description','analysis.health.lastCheck','parse','isEmergency','analysis.history_debug_00','text','Keine\x20Termine.','val','slice','KI-Modell\x20nicht\x20initialisiert','substring','sensorLastValues','indicator.alarm','error','LTM.driftAnalysis.driftDetails','LTM.rawEventLog','analysis.security.topologyMatrix','HEALTH_TRAIN_RESULT','events.history','Last\x20raw\x20event','[RESULT]','licht','119xrCbGW','analysis.automation.patternDetected','system.config','analysis.automation.targetValue','Lernphase\x20(','./lib/topology','write','\x20->\x20','stateChange','Graph\x20Structure\x20(Adjacency\x20Matrix)','unshift','78138PcltiR','enum','Event\x20History','light','analysis.topology.structure','setupDriftAnalysisScheduler','briefingJob','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','minDaysForBaseline','useCalendar','sendTo','kontakt','outdoorSensorId','TRAIN_HEALTH','analysis.analysisHistory','setStateAsync','join','filter','setHours','ðŸ•¸ï¸\x20Manually\x20triggering\x20Topology\x20Update...','instance','notifyTelegramEnabled','Kein\x20API\x20Key!','getMonth','occupancy','NORMAL','number','PREDICT_ENERGY','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','autoApply','analysis.alertReason','LTM.driftAnalysis.baselineDrift','setState','TREND_RESULT','exitGraceTimer','\x20Tage)','analysis.health.trendDiagnosis','ðŸ“\x20Feedback\x20received:\x20','activityLevel','onStateChange','python3','toISOString','unload','analysis.health.trendValue','service.py','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','message','scanDevices','date','Train\x20Comfort','targetValue','push','Health\x20Analysis','âœ…\x20HEALTH\x20TRAINED.','dependencyInstallInProgress','analysis.automation.targetId','exitTimer','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','response','heizung','boolean','Skipped\x20(No\x20AI\x20or\x20Data)','Missing\x20data','LTM.trainingData.thermodynamics','pythonProcess','440847qHXeLV','endsWith','change_percent','weatherInstance','ðŸ\x20Python\x20Pong','N/A\x20(Learning)','analysis.energy.forecast','online','search','cancel','tÃ¼r','existsSync','subscribeStates','208100Unqroh','currentSystemMode','analysis.health.isAnomaly','TRAIN_COMFORT','No\x20instance','Gait\x20Speed\x20Trend','LTM.triggerDailyDigest','cogni-living\x20adapter\x20starting\x20(v','door','Activity-Level','splice','generic','18636qRiria','Kalender\x20deaktiviert.','30boLzyx','getLtmData','GUEST','Topology\x20Update\x20Error:\x20','analysis.security.lastScore','type','exports','analysis.training.triggerSecurity','32152uVIXtR','stringify','latitude','weatherunderground','LTM.trainingData.sequences','info','OK:\x20','Last\x20Check','modeResetJob','payload','threshold','System\x20Mode','apiKey','forEach','indicator','startsWith','getDate','system.mode','system','âš ï¸\x20SECURITY\x20ALARM:\x20','enum.functions.*','find','.NextHours.Location_1.Day_1.current.temp_value','guest','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','heating','useWeather','window','genAI','Anomaly\x20Detected','now','analysis.training.triggerTopology','timestamp','shift','Pattern\x20Detected','toLowerCase','ðŸ§ \x20Triggering\x20Security\x20Training...','livingContext','Energy\x20Intelligence','.\x20WETTER:\x20','{\x22rooms\x22:[],\x20\x22matrix\x22:[]}','alertReason','longitude','LTM','name','success','aiPersona','analysis.health.todayVector','analysis.security','apply','normal','updateTopology','log','LTM.baselineStatus','onReady','channel','ack','User\x20dismissed\x20automation\x20proposal.','Alert\x20Status','isProVersion','simulateButler','details','main','TRAIN_SECURITY','.Current.Temperature','dismissAutomation','detected','ANOMALY','round','Unknown','testApiKey','is_anomaly','getForeignStateAsync','analysis.training','values','TRAIN_ENERGY','BUTLER\x20Execution\x20Error:\x20','analysis.health.gaitSpeed','presence','json','Regel\x20erkannt:\x20','devices','analysisHistory','Activity\x20Summary','[LOG]','description','pop','analysis.triggerBriefing','object','@iobroker/adapter-core','automationProposal','ready','Alert\x20Reason','geminiModel','presenceDevices','onMessage','analysis.energy.insulationScore','analysis.training.status','includes','47106edMpvE','ANALYZE_GAIT','driftDetails','getFullYear','isExit','delObjectAsync','Sequences','Trigger\x20Action','systemConfig','version','Fokus\x20auf\x20Komfort.','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Briefing\x20Error:\x20','ENERGY_PREDICT_RESULT','system.presenceWho','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','analysis.activitySummary','targetId','Wetterdaten\x20deaktiviert.','getGenerativeModel','Insulation\x20Score','constructor','analysis.training.triggerComfort','analysis.training.triggerEnergy','rawEventLog','LTM.dailyDigests','string','rating','setupLtmScheduler','fill','analysis.isAlert','reason','onUnload','inactivityThresholdHours','eventHistory','System','vacation','switch','Heating\x20Score','TOPOLOGY_RESULT','Auto\x20Apply','party','analysis.automation.triggerAction','split','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','stdout','lampe','motion','fenster','rule','temperature','Started...','button','getStateAsync','contact','prÃ¤senz','automation.triggerAction','toString','./lib/scheduler','Success:\x20','setForeignStateAsync','PONG','getMinutes','setObjectNotExistsAsync','analysis.energy','isAlert','Who\x20is\x20present?','PRIORITÃ„T:\x20Gesundheit/AAL.','communicate.request','\x20=\x20','location','N/A','Training\x20Error:\x20','[RECORDER]\x20Error:\x20','accuweather','generateContent','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','config','lastAlertState','toFixed','LTM.driftAnalysis','bind','VACATION','Current\x20Threshold','debug','getHours','Keine\x20Wetterdaten\x20verfÃ¼gbar.','Trend','Train\x20Energy','1017TiOVjs','isGracePeriodActive','22yqJjCR','analysis.security.currentThreshold','events.history_debug_00','triggerDailyDigest','Training\x20Status','Trigger\x20Analysis'];a0_0x3a14=function(){return _0x11d494;};return a0_0x3a14();}async function executeAutomationAction(_0x1f5097){const _0x1c1ba0=a0_0x27f5f1;try{const _0x220b25=await _0x1f5097[_0x1c1ba0(0x242)](_0x1c1ba0(0x17d)),_0x3b6d0b=await _0x1f5097[_0x1c1ba0(0x242)]('analysis.automation.targetValue');if(_0x220b25&&_0x220b25[_0x1c1ba0(0x12c)]&&_0x3b6d0b){const _0x531f87=_0x220b25[_0x1c1ba0(0x12c)];let _0x4cf908=_0x3b6d0b[_0x1c1ba0(0x12c)];try{_0x4cf908=JSON['parse'](_0x4cf908);}catch(_0x210bd6){}_0x1f5097[_0x1c1ba0(0x1de)][_0x1c1ba0(0x1af)](_0x1c1ba0(0x259)+_0x531f87+'\x20=\x20'+_0x4cf908),await _0x1f5097[_0x1c1ba0(0x249)](_0x531f87,_0x4cf908);}else _0x1f5097[_0x1c1ba0(0x1de)][_0x1c1ba0(0x273)](_0x1c1ba0(0x218));}catch(_0x2b17fe){_0x1f5097[_0x1c1ba0(0x1de)][_0x1c1ba0(0x132)](_0x1c1ba0(0x1f6)+_0x2b17fe[_0x1c1ba0(0x174)]);}}async function processSensorEvent(_0x5b37bc,_0x20c84f,_0x21d734,_0x33e64b){const _0x39f524=a0_0x27f5f1;if(!_0x33e64b)return;const _0x56c7f8=_0x21d734[_0x39f524(0x12c)],_0x36396e=Date[_0x39f524(0x1c8)](),_0x53c5d4=_0x5b37bc[_0x39f524(0x130)][_0x20c84f];_0x5b37bc[_0x39f524(0x130)][_0x20c84f]=_0x56c7f8;if(!_0x33e64b['logDuplicates']&&_0x53c5d4!=undefined&&_0x53c5d4==_0x56c7f8)return;const _0x100f5d=(_0x33e64b['type']||'')['toLowerCase'](),_0x5af9bd=_0x100f5d[_0x39f524(0x20c)](_0x39f524(0x23f))||_0x100f5d[_0x39f524(0x20c)]('temperatur')||_0x100f5d[_0x39f524(0x20c)]('klima')||_0x100f5d[_0x39f524(0x20c)](_0x39f524(0x181));_0x5b37bc[_0x39f524(0x1e5)]&&_0x5af9bd&&recordThermodynamics(_0x5b37bc,_0x20c84f,_0x56c7f8,_0x33e64b[_0x39f524(0x253)]);const _0x2f08ff={'timestamp':_0x36396e,'id':_0x20c84f,'name':_0x33e64b[_0x39f524(0x1d6)],'type':_0x33e64b[_0x39f524(0x1a7)],'location':_0x33e64b[_0x39f524(0x253)],'value':_0x56c7f8};_0x5b37bc[_0x39f524(0x22f)][_0x39f524(0x145)](_0x2f08ff);if(_0x5b37bc[_0x39f524(0x22f)][_0x39f524(0x299)]>HISTORY_MAX_SIZE)_0x5b37bc[_0x39f524(0x22f)][_0x39f524(0x200)]();await _0x5b37bc[_0x39f524(0x155)](_0x39f524(0x297),{'val':JSON[_0x39f524(0x1ab)](_0x2f08ff),'ack':!![]}),await _0x5b37bc[_0x39f524(0x155)](_0x39f524(0x137),{'val':JSON[_0x39f524(0x1ab)](_0x5b37bc[_0x39f524(0x22f)]),'ack':!![]});_0x5b37bc[_0x39f524(0x1e5)]&&(_0x5b37bc[_0x39f524(0x225)][_0x39f524(0x179)](_0x2f08ff),await saveRawEventLog(_0x5b37bc),recordSequence(_0x5b37bc,_0x2f08ff));if(_0x33e64b[_0x39f524(0x211)]&&_0x56c7f8===!![]){if(_0x5b37bc[_0x39f524(0x117)]&&!_0x5b37bc[_0x39f524(0x267)])startExitTimer(_0x5b37bc);else{if(!_0x5b37bc[_0x39f524(0x117)])setPresence(_0x5b37bc,!![]);}}else{if(_0x33e64b[_0x39f524(0x1a7)]===_0x39f524(0x23c)&&_0x56c7f8===!![]){if(_0x5b37bc['exitTimer'])abortExitTimer(_0x5b37bc);if(!_0x5b37bc[_0x39f524(0x117)]&&_0x5b37bc['currentSystemMode']===SYSTEM_MODES[_0x39f524(0x15f)])setPresence(_0x5b37bc,!![]);}}}async function recordThermodynamics(_0x1b8cf6,_0x3a814a,_0x37be26,_0x3f4554){const _0x58cba5=a0_0x27f5f1,_0x318a16=await getOutsideTemperatureNumeric(_0x1b8cf6),_0x48643f=await _0x1b8cf6['getStateAsync'](_0x58cba5(0x185));let _0x1eba0a=[];if(_0x48643f&&_0x48643f[_0x58cba5(0x12c)])try{_0x1eba0a=JSON[_0x58cba5(0x127)](_0x48643f[_0x58cba5(0x12c)]);}catch(_0x4b437d){}_0x1eba0a[_0x58cba5(0x179)]({'ts':Date[_0x58cba5(0x1c8)](),'room':_0x3f4554||_0x58cba5(0x1ef),'t_in':_0x37be26,'t_out':_0x318a16});if(_0x1eba0a[_0x58cba5(0x299)]>THERMO_LOG_SIZE)_0x1eba0a[_0x58cba5(0x1cb)]();await _0x1b8cf6['setStateAsync'](_0x58cba5(0x185),{'val':JSON[_0x58cba5(0x1ab)](_0x1eba0a),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x49b0a8){const _0x304def=a0_0x27f5f1;if(_0x49b0a8[_0x304def(0x25a)][_0x304def(0x152)])try{const _0x509515=await _0x49b0a8['getForeignStateAsync'](_0x49b0a8[_0x304def(0x25a)][_0x304def(0x152)]);if(_0x509515&&_0x509515[_0x304def(0x12c)]!==undefined&&_0x509515[_0x304def(0x12c)]!==null)return parseFloat(_0x509515['val']);}catch(_0x3a33c9){}const _0x4ca0b5=_0x49b0a8[_0x304def(0x25a)][_0x304def(0x18a)];if(!_0x49b0a8[_0x304def(0x25a)][_0x304def(0x1c4)]||!_0x4ca0b5)return null;try{let _0x1c29f5='';if(_0x4ca0b5[_0x304def(0x20c)](_0x304def(0x257)))_0x1c29f5=_0x4ca0b5+_0x304def(0x1ea);else{if(_0x4ca0b5[_0x304def(0x20c)]('daswetter'))_0x1c29f5=_0x4ca0b5+_0x304def(0x1c0);else{if(_0x4ca0b5[_0x304def(0x20c)](_0x304def(0x29a)))_0x1c29f5=_0x4ca0b5+_0x304def(0x124);else{if(_0x4ca0b5[_0x304def(0x20c)](_0x304def(0x1ad)))_0x1c29f5=_0x4ca0b5+_0x304def(0x27c);}}}if(_0x1c29f5){const _0x191418=await _0x49b0a8[_0x304def(0x1f2)](_0x1c29f5);if(_0x191418&&_0x191418[_0x304def(0x12c)]!==undefined&&_0x191418['val']!==null)return parseFloat(_0x191418[_0x304def(0x12c)]);}}catch(_0x48a0e7){}return null;}async function recordSequence(_0x3cd900,_0x5a6d12){const _0x456606=a0_0x27f5f1,_0x4e85ca=(_0x5a6d12[_0x456606(0x1a7)]||'')[_0x456606(0x1cd)](),_0x314bce=[_0x456606(0x23c),_0x456606(0x28b),_0x456606(0x244),_0x456606(0x1f8),_0x456606(0x15e),_0x456606(0x19c),_0x456606(0x191),_0x456606(0x1c5),_0x456606(0x23d),_0x456606(0x243),_0x456606(0x151),_0x456606(0x149),_0x456606(0x13a),_0x456606(0x232),_0x456606(0x287),'dimmer',_0x456606(0x23b)];if(!_0x314bce['some'](_0x31ec6b=>_0x4e85ca['includes'](_0x31ec6b)))return;if(!_0x5a6d12[_0x456606(0x121)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x5a6d12[_0x456606(0x253)]||_0x456606(0x1ef),'id':_0x5a6d12['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{const _0x377071=_0x456606;if(activeSequence[_0x377071(0x299)]>0x1)await saveCompletedSequence(_0x3cd900);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x283d1d){const _0x5b12b9=a0_0x27f5f1;try{const _0x1f87cc=await _0x283d1d[_0x5b12b9(0x242)](_0x5b12b9(0x1ae));let _0x2f81d2=[];if(_0x1f87cc&&_0x1f87cc[_0x5b12b9(0x12c)])try{_0x2f81d2=JSON[_0x5b12b9(0x127)](_0x1f87cc[_0x5b12b9(0x12c)]);}catch(_0x29fba1){}const _0x47809d=activeSequence[0x0]['ts'],_0x48e858=activeSequence[_0x5b12b9(0x283)](_0x2f5d5b=>({'loc':_0x2f5d5b[_0x5b12b9(0x292)],'t_delta':Math[_0x5b12b9(0x1ee)]((_0x2f5d5b['ts']-_0x47809d)/0x3e8)})),_0x2cfb73={'timestamp':new Date(_0x47809d)['toISOString'](),'steps':_0x48e858,'duration':Math[_0x5b12b9(0x1ee)]((activeSequence[activeSequence[_0x5b12b9(0x299)]-0x1]['ts']-_0x47809d)/0x3e8),'daytime':new Date(_0x47809d)[_0x5b12b9(0x262)]()};_0x2f81d2['push'](_0x2cfb73);if(_0x2f81d2[_0x5b12b9(0x299)]>MAX_TRAINING_SET_SIZE)_0x2f81d2[_0x5b12b9(0x1cb)]();await _0x283d1d[_0x5b12b9(0x155)](_0x5b12b9(0x1ae),{'val':JSON[_0x5b12b9(0x1ab)](_0x2f81d2),'ack':!![]}),runSecurityCheck(_0x283d1d,_0x2cfb73);}catch(_0x4a6c5b){_0x283d1d['log'][_0x5b12b9(0x132)](_0x5b12b9(0x256)+_0x4a6c5b[_0x5b12b9(0x174)]);}}function runSecurityCheck(_0x5b7b62,_0x219d97){const _0x3e02a0=a0_0x27f5f1;if(!_0x5b7b62[_0x3e02a0(0x1e5)])return;sendToPython(_0x5b7b62,_0x3e02a0(0x279),{'sequence':_0x219d97});}async function createDailyDigest(_0x5316b0){const _0x42058b=a0_0x27f5f1;if(!_0x5316b0[_0x42058b(0x1e5)])return;await _0x5316b0[_0x42058b(0x155)](LTM_DP_STATUS,{'val':_0x42058b(0x240),'ack':!![]});if(!_0x5316b0['geminiModel']||_0x5316b0[_0x42058b(0x225)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x5316b0[_0x42058b(0x155)](LTM_DP_STATUS,{'val':_0x42058b(0x183),'ack':!![]});return;}const _0x29f8cb=JSON['parse'](JSON[_0x42058b(0x1ab)](_0x5316b0[_0x42058b(0x225)])),_0x252f68=_0x29f8cb[_0x42058b(0x299)],_0x2a0b0c=_0x42058b(0x17f)+JSON['stringify'](_0x29f8cb);try{const _0x115c70=await _0x5316b0[_0x42058b(0x207)][_0x42058b(0x258)](_0x2a0b0c),_0x552e3c=JSON[_0x42058b(0x127)](_0x115c70['response'][_0x42058b(0x12a)]()['replace'](/```json|```/g,'')[_0x42058b(0x274)]()),_0x12ed15={'timestamp':new Date()[_0x42058b(0x16f)](),'eventCount':_0x252f68,'summary':_0x552e3c[_0x42058b(0x28f)]||_0x42058b(0x11c),'activityLevel':_0x552e3c['activityLevel']||_0x42058b(0x1dc),'systemMode':_0x5316b0['currentSystemMode']};_0x5316b0['dailyDigests'][_0x42058b(0x179)](_0x12ed15),await saveDailyDigests(_0x5316b0),_0x5316b0[_0x42058b(0x225)]=[],await saveRawEventLog(_0x5316b0),await _0x5316b0['setStateAsync'](LTM_DP_STATUS,{'val':'Success','ack':!![]});if(_0x5316b0[_0x42058b(0x1e5)])sendToPython(_0x5316b0,'ANALYZE_HEALTH',{'digest':_0x12ed15});}catch(_0x5a3490){_0x5316b0[_0x42058b(0x1de)]['error'](_0x5a3490[_0x42058b(0x174)]);}}async function runBaselineDriftAnalysis(_0x548bdd){const _0x4d212f=a0_0x27f5f1;if(!_0x548bdd[_0x4d212f(0x1e5)]||!_0x548bdd[_0x4d212f(0x207)])return;const _0x34310a=_0x548bdd[_0x4d212f(0x25a)][_0x4d212f(0x295)]||0xe;if(_0x548bdd['dailyDigests']['length']<_0x34310a+0x7){await _0x548bdd[_0x4d212f(0x155)](LTM_DP_DRIFT_STATUS,{'val':_0x4d212f(0x18c),'ack':!![]});return;}const _0x167def=_0x548bdd[_0x4d212f(0x280)]['slice'](-_0x34310a),_0x58b24b=_0x548bdd[_0x4d212f(0x280)]['slice'](0x0,_0x548bdd[_0x4d212f(0x280)]['length']-_0x34310a),_0x481104=_0x4d212f(0x1c2)+JSON['stringify'](_0x58b24b)+'\x0aSTB:\x20'+JSON['stringify'](_0x167def);try{const _0x390643=await _0x548bdd[_0x4d212f(0x207)]['generateContent'](_0x481104),_0x13f6bf=JSON[_0x4d212f(0x127)](_0x390643[_0x4d212f(0x180)][_0x4d212f(0x12a)]()['replace'](/```json|```/g,'')['trim']());_0x13f6bf[_0x4d212f(0x275)]&&(await _0x548bdd[_0x4d212f(0x155)](LTM_DP_DRIFT_STATUS,{'val':_0x13f6bf[_0x4d212f(0x275)],'ack':!![]}),await _0x548bdd[_0x4d212f(0x155)](LTM_DP_DRIFT_DETAILS,{'val':_0x13f6bf[_0x4d212f(0x20f)],'ack':!![]}),await _0x548bdd['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x57b20d){}}async function sendMorningBriefing(_0x186ffa){const _0x4d7e0a=a0_0x27f5f1;if(!_0x186ffa[_0x4d7e0a(0x207)])return;try{const _0x29b5f7='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x33439e=await _0x186ffa['geminiModel'][_0x4d7e0a(0x258)](_0x29b5f7),_0x309187=_0x33439e[_0x4d7e0a(0x180)][_0x4d7e0a(0x12a)]();sendNotification(_0x186ffa,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0x309187);}catch(_0x4c7056){_0x186ffa[_0x4d7e0a(0x1de)][_0x4d7e0a(0x132)](_0x4d7e0a(0x219)+_0x4c7056[_0x4d7e0a(0x174)]);}}function stopPythonService(_0x5849ed){const _0x59b787=a0_0x27f5f1;if(_0x5849ed[_0x59b787(0x186)]){try{_0x5849ed[_0x59b787(0x186)]['kill']();}catch(_0x42a58f){}_0x5849ed['pythonProcess']=null;}}function sendToPython(_0x599906,_0x8664e7,_0x36bf2e={}){const _0x291a05=a0_0x27f5f1;if(!_0x599906[_0x291a05(0x186)]||!_0x599906[_0x291a05(0x186)]['stdin']['writable'])return;const _0x3b1705=JSON[_0x291a05(0x1ab)]({'command':_0x8664e7,..._0x36bf2e});try{_0x599906[_0x291a05(0x186)]['stdin'][_0x291a05(0x141)](_0x3b1705+'\x0a');}catch(_0x2b3352){}}function runPythonHealthCheck(_0x3d756b){const _0x333f46=a0_0x27f5f1;if(!_0x3d756b[_0x333f46(0x280)]||_0x3d756b[_0x333f46(0x280)][_0x333f46(0x299)]<0x2)return;const _0x2f160b=_0x3d756b[_0x333f46(0x280)][_0x333f46(0x283)](_0xadb1d8=>{const _0x2a3786=_0x333f46,_0xe52441=(_0xadb1d8[_0x2a3786(0x16c)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0xe52441]||0x32;});sendToPython(_0x3d756b,_0x333f46(0x28d),{'values':_0x2f160b,'tag':_0x333f46(0x19d)});}function handlePythonResult(_0x15f8a6,_0x15222a){const _0x447d57=a0_0x27f5f1;if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x24a))_0x15f8a6[_0x447d57(0x1de)][_0x447d57(0x261)](_0x447d57(0x18b));else{if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x11a)){const {anomaly_score:_0xaf3423,is_anomaly:_0x4a77c7,threshold:_0x5eede4,explanation:_0x259579}=_0x15222a[_0x447d57(0x1b3)];_0x15f8a6[_0x447d57(0x1de)][_0x447d57(0x1af)]('ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20'+_0xaf3423['toFixed'](0x5)+_0x447d57(0x142)+(_0x4a77c7?_0x447d57(0x1ed):'OK')),_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x1a6),{'val':_0xaf3423,'ack':!![]}),_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x29e),{'val':new Date()[_0x447d57(0x16f)](),'ack':!![]});if(_0x5eede4)_0x15f8a6[_0x447d57(0x155)]('analysis.security.currentThreshold',{'val':_0x5eede4,'ack':!![]});if(_0x4a77c7){let _0x10dad2=_0x447d57(0x162)+_0xaf3423[_0x447d57(0x25c)](0x4)+')';if(_0x259579&&_0x259579!==_0x447d57(0x1ef))_0x10dad2+='\x0aGrund:\x20'+_0x259579;_0x15f8a6['setStateAsync']('analysis.isAlert',{'val':!![],'ack':!![]}),_0x15f8a6[_0x447d57(0x155)]('analysis.alertReason',{'val':_0x10dad2,'ack':!![]}),sendNotification(_0x15f8a6,_0x447d57(0x1bd)+_0x10dad2,![],!![]);}}else{if(_0x15222a['type']===_0x447d57(0x2ae)){const _0x4fd29f=_0x15222a['payload'][_0x447d57(0x1e7)]||'',_0x48d7c6=_0x15222a[_0x447d57(0x1b3)][_0x447d57(0x1b4)],_0x1802b1=_0x15222a[_0x447d57(0x1b3)][_0x447d57(0x1d7)]?_0x447d57(0x248)+new Date()['toLocaleTimeString']()+'\x20('+_0x4fd29f+')':'Failed:\x20'+_0x15222a['payload'][_0x447d57(0x22c)];_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x20b),{'val':_0x1802b1,'ack':!![]});if(_0x15222a[_0x447d57(0x1b3)][_0x447d57(0x1d7)]&&_0x48d7c6)_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x269),{'val':_0x48d7c6,'ack':!![]});}else{if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x278)){const {patterns:_0x2c99af}=_0x15222a[_0x447d57(0x1b3)];if(_0x2c99af&&_0x2c99af[_0x447d57(0x299)]>0x0){_0x15f8a6[_0x447d57(0x1de)][_0x447d57(0x1af)](_0x447d57(0x239)+_0x2c99af[_0x447d57(0x299)]+'\x20new\x20patterns.'),_0x15f8a6['setStateAsync'](_0x447d57(0x2a8),{'val':JSON[_0x447d57(0x1ab)](_0x2c99af),'ack':!![]});const _0x232d4a=_0x2c99af[0x0],_0x1bb4e2=_0x447d57(0x1fa)+_0x232d4a[_0x447d57(0x23e)]+'\x20('+(_0x232d4a['confidence']*0x64)[_0x447d57(0x25c)](0x0)+'%)';_0x15f8a6['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x125),{'val':_0x1bb4e2,'ack':!![]});}else _0x15f8a6[_0x447d57(0x1de)]['info'](_0x447d57(0x21c)),_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x13c),{'val':![],'ack':!![]}),_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x2a8),{'val':'[]','ack':!![]});}else{if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x119)){if(_0x15222a[_0x447d57(0x1b3)][_0x447d57(0x1d7)])try{const _0x2ce081=JSON['parse'](_0x15222a[_0x447d57(0x1b3)]['details']);if(_0x2ce081[_0x447d57(0x281)])_0x15f8a6['setStateAsync'](_0x447d57(0x20a),{'val':JSON[_0x447d57(0x1ab)](_0x2ce081[_0x447d57(0x281)]),'ack':!![]});if(_0x2ce081[_0x447d57(0x1c3)])_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x272),{'val':JSON[_0x447d57(0x1ab)](_0x2ce081[_0x447d57(0x1c3)]),'ack':!![]});}catch(_0x2321dd){}}else{if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x136)){if(_0x15222a[_0x447d57(0x1b3)][_0x447d57(0x1d7)])_0x15f8a6[_0x447d57(0x1de)]['info'](_0x447d57(0x17b));}else{if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x11f))_0x15f8a6['setStateAsync'](_0x447d57(0x126),{'val':new Date()['toISOString'](),'ack':!![]}),_0x15f8a6[_0x447d57(0x155)]('analysis.health.isAnomaly',{'val':_0x15222a['payload'][_0x447d57(0x1f1)],'ack':!![]});else{if(_0x15222a['type']===_0x447d57(0x167))_0x15f8a6[_0x447d57(0x155)]('analysis.health.trendDiagnosis',{'val':_0x15222a[_0x447d57(0x1b3)]['diagnosis'],'ack':!![]}),_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x171),{'val':_0x15222a['payload'][_0x447d57(0x189)],'ack':!![]});else{if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x27d)){const {speed_trend:_0x4f9d12}=_0x15222a['payload'];if(_0x4f9d12!==undefined)_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x1f7),{'val':_0x4f9d12,'ack':!![]});}else{if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x21a)){const {forecast:_0x395cfd}=_0x15222a[_0x447d57(0x1b3)];if(_0x395cfd)_0x15f8a6[_0x447d57(0x155)](_0x447d57(0x18d),{'val':JSON[_0x447d57(0x1ab)](_0x395cfd),'ack':!![]});}else{if(_0x15222a[_0x447d57(0x1a7)]===_0x447d57(0x234)){const {data:_0x108234}=_0x15222a[_0x447d57(0x1b3)];_0x108234&&(_0x15f8a6[_0x447d57(0x1de)][_0x447d57(0x1af)](_0x447d57(0x2b1)),_0x15f8a6['setStateAsync'](_0x447d57(0x135),{'val':JSON['stringify'](_0x108234),'ack':!![]}));}}}}}}}}}}}}function startPythonService(_0x21e39c){const _0x377aac=a0_0x27f5f1;let _0x241451=_0x377aac(0x16e);if(fs[_0x377aac(0x192)](installer[_0x377aac(0x28a)]))_0x241451=installer['PYTHON_EXE'];try{const _0x1d15bc=path[_0x377aac(0x156)](__dirname,'python_service',_0x377aac(0x172));_0x21e39c[_0x377aac(0x186)]=spawn(_0x241451,[_0x1d15bc]),_0x21e39c[_0x377aac(0x186)][_0x377aac(0x23a)]['on']('data',_0x1a9094=>{const _0x34b250=_0x377aac,_0x2acf6e=_0x1a9094[_0x34b250(0x246)]()['split']('\x0a');_0x2acf6e[_0x34b250(0x1b7)](_0x5109c5=>{const _0x5f37c7=_0x34b250,_0x4ae32e=_0x5109c5[_0x5f37c7(0x274)]();if(!_0x4ae32e)return;if(_0x4ae32e['startsWith'](_0x5f37c7(0x1fe)))_0x21e39c[_0x5f37c7(0x1de)][_0x5f37c7(0x261)]('[PYTHON]\x20'+_0x4ae32e[_0x5f37c7(0x12f)](0x5)[_0x5f37c7(0x274)]());else{if(_0x4ae32e[_0x5f37c7(0x1b9)](_0x5f37c7(0x139)))try{const _0x55fbcc=JSON[_0x5f37c7(0x127)](_0x4ae32e[_0x5f37c7(0x12f)](0x8)[_0x5f37c7(0x274)]());handlePythonResult(_0x21e39c,_0x55fbcc);}catch(_0x94d460){}}});}),_0x21e39c[_0x377aac(0x186)]['on']('close',_0x581cc9=>{const _0x2df101=_0x377aac;_0x21e39c[_0x2df101(0x186)]=null;});}catch(_0x222059){_0x21e39c[_0x377aac(0x1de)][_0x377aac(0x132)]('Error\x20launching\x20Python:\x20'+_0x222059[_0x377aac(0x174)]);}}async function runAutopilot(_0x5b52c1){const _0x2c5411=a0_0x27f5f1;_0x5b52c1[_0x2c5411(0x1de)]['debug'](_0x2c5411(0x14d)),await runGeminiAnalysis(_0x5b52c1),updateHealthVector(_0x5b52c1),triggerGaitAnalysis(_0x5b52c1),triggerEnergyPrediction(_0x5b52c1);}async function triggerGaitAnalysis(_0x50ef72){const _0x3c4650=a0_0x27f5f1;if(!_0x50ef72[_0x3c4650(0x1e5)])return;try{const _0x30bff6=await _0x50ef72[_0x3c4650(0x242)]('LTM.trainingData.sequences');_0x30bff6&&_0x30bff6[_0x3c4650(0x12c)]&&sendToPython(_0x50ef72,_0x3c4650(0x20e),{'sequences':JSON[_0x3c4650(0x127)](_0x30bff6[_0x3c4650(0x12c)])});}catch(_0x2a148d){}}async function triggerEnergyPrediction(_0x2bb524){const _0xd7af20=a0_0x27f5f1;if(!_0x2bb524[_0xd7af20(0x1e5)])return;try{const _0x48236c=await getOutsideTemperatureNumeric(_0x2bb524);if(_0x48236c===null)return;const _0x54fae2={},_0x328087=_0x2bb524[_0xd7af20(0x25a)][_0xd7af20(0x1fb)]||[];for(const _0x5db7a4 of _0x328087){if(_0x5db7a4[_0xd7af20(0x1a7)]===_0xd7af20(0x23f)&&_0x5db7a4[_0xd7af20(0x253)]){const _0x3c2811=_0x2bb524['sensorLastValues'][_0x5db7a4['id']];if(_0x3c2811!==undefined)_0x54fae2[_0x5db7a4[_0xd7af20(0x253)]]=_0x3c2811;}}Object['keys'](_0x54fae2)['length']>0x0&&sendToPython(_0x2bb524,_0xd7af20(0x161),{'current_temps':_0x54fae2,'t_out':_0x48236c});}catch(_0x17eb28){}}function updateHealthVector(_0x8eee8d){const _0x20e3d8=a0_0x27f5f1;if(!_0x8eee8d[_0x20e3d8(0x225)]||_0x8eee8d[_0x20e3d8(0x225)][_0x20e3d8(0x299)]===0x0)return;const _0x13deb0=new Array(0x60)[_0x20e3d8(0x22a)](0x0),_0x17f37c=new Date()[_0x20e3d8(0x158)](0x0,0x0,0x0,0x0);_0x8eee8d[_0x20e3d8(0x225)][_0x20e3d8(0x1b7)](_0x54ff1e=>{const _0x212dc9=_0x20e3d8,_0x2484bb=new Date(_0x54ff1e[_0x212dc9(0x1ca)]);if(_0x2484bb[_0x212dc9(0x123)]()>=_0x17f37c){const _0x300f0b=_0x2484bb['getHours'](),_0x101c4f=_0x2484bb[_0x212dc9(0x24b)](),_0x3721b7=_0x300f0b*0x4+Math['floor'](_0x101c4f/0xf);if(_0x3721b7>=0x0&&_0x3721b7<0x60)_0x13deb0[_0x3721b7]++;}}),_0x8eee8d[_0x20e3d8(0x155)]('analysis.health.todayVector',{'val':JSON['stringify'](_0x13deb0),'ack':!![]});}async function getWeatherContext(_0x2d3e6b){const _0x19d24c=a0_0x27f5f1;if(!_0x2d3e6b[_0x19d24c(0x25a)][_0x19d24c(0x1c4)]||!_0x2d3e6b[_0x19d24c(0x25a)][_0x19d24c(0x18a)])return _0x19d24c(0x21f);try{const _0xbc77be=_0x2d3e6b[_0x19d24c(0x25a)]['weatherInstance'];let _0x33d624=await _0x2d3e6b[_0x19d24c(0x1f2)](_0xbc77be+_0x19d24c(0x1ea));if(!_0x33d624)_0x33d624=await _0x2d3e6b[_0x19d24c(0x1f2)](_0xbc77be+'.forecast.current.temperature');let _0x1ff74f=await _0x2d3e6b[_0x19d24c(0x1f2)](_0xbc77be+_0x19d24c(0x293));if(!_0x1ff74f)_0x1ff74f=await _0x2d3e6b['getForeignStateAsync'](_0xbc77be+_0x19d24c(0x2a1));if(_0x33d624&&_0x1ff74f)return _0x33d624['val']+'Â°C,\x20'+_0x1ff74f['val'];}catch(_0x3a6dcb){}return _0x19d24c(0x263);}async function getCalendarContext(_0x1d0128){const _0x180db7=a0_0x27f5f1;if(!_0x1d0128[_0x180db7(0x25a)][_0x180db7(0x14f)]||!_0x1d0128[_0x180db7(0x25a)][_0x180db7(0x284)])return _0x180db7(0x1a1);return _0x180db7(0x12b);}async function getCalendarNames(_0x449986,_0x4bc6f3){return[];}async function saveFeedback(_0x5a6262,_0x2372d0){const _0x3a2308=a0_0x27f5f1;_0x5a6262[_0x3a2308(0x1de)][_0x3a2308(0x1af)](_0x3a2308(0x16b)+_0x2372d0[_0x3a2308(0x228)]);}function a0_0x4077(_0x67e5c2,_0x49f9f1){const _0x7122e1=a0_0x3a14();return a0_0x4077=function(_0x57250b,_0x2a6445){_0x57250b=_0x57250b-0x117;let _0x3a14aa=_0x7122e1[_0x57250b];return _0x3a14aa;},a0_0x4077(_0x67e5c2,_0x49f9f1);}async function runGeminiAnalysis(_0x6c2f1c,_0x31d417=''){const _0x56164e=a0_0x27f5f1;if(!_0x6c2f1c[_0x56164e(0x207)])return;if(_0x6c2f1c['eventHistory']['length']===0x0)return;const _0x3d5a54=_0x6c2f1c['eventHistory'][_0x56164e(0x12d)](0x0,0xf),_0x2d9c86=await getWeatherContext(_0x6c2f1c),_0x14ae31=_0x6c2f1c[_0x56164e(0x195)],_0x2bffba=PERSONA_MAPPING[_0x6c2f1c['config'][_0x56164e(0x1d8)]||_0x56164e(0x19f)],_0x5c212c=_0x6c2f1c[_0x56164e(0x25a)][_0x56164e(0x1cf)]||'Keine\x20Details.';let _0x11b6bb='Unbekannt';try{const _0x25de01=await _0x6c2f1c[_0x56164e(0x242)](_0x56164e(0x21b));if(_0x25de01&&_0x25de01['val'])_0x11b6bb=_0x25de01[_0x56164e(0x12c)];}catch(_0x51ff02){}let _0x2b28c5=![];try{const _0x154edd=await _0x6c2f1c[_0x56164e(0x242)](_0x56164e(0x11b));if(_0x154edd&&_0x154edd['val'])_0x2b28c5=!![];}catch(_0x7d8aac){}const _0x2c1952=_0x56164e(0x120)+_0x2bffba+'.\x20KONTEXT:\x20'+_0x5c212c+_0x56164e(0x285)+_0x14ae31+_0x56164e(0x1d1)+_0x2d9c86+'.\x20ANWESEND:\x20'+_0x11b6bb+'.\x20EVENTS:\x20'+JSON[_0x56164e(0x1ab)](_0x3d5a54)+_0x56164e(0x2ac)+_0x31d417+_0x56164e(0x282);try{const _0x11135b=await _0x6c2f1c['geminiModel'][_0x56164e(0x258)](_0x2c1952),_0x468018=JSON[_0x56164e(0x127)](_0x11135b[_0x56164e(0x180)][_0x56164e(0x12a)]()['replace'](/```json|```/g,'')[_0x56164e(0x274)]());await _0x6c2f1c[_0x56164e(0x155)]('analysis.lastResult',{'val':JSON['stringify'](_0x468018),'ack':!![]});if(_0x468018[_0x56164e(0x28f)])await _0x6c2f1c[_0x56164e(0x155)](_0x56164e(0x21d),{'val':_0x468018['summary'],'ack':!![]});const _0x3b6f55={'timestamp':Date[_0x56164e(0x1c8)](),'id':Date[_0x56164e(0x1c8)]()[_0x56164e(0x246)](),'analysis':{'activity':{'summary':_0x468018['summary'],'isAlert':_0x468018[_0x56164e(0x24e)],'alertReason':_0x468018[_0x56164e(0x1d3)]},'comfort':{'automationProposal':_0x468018[_0x56164e(0x204)]}}};await updateAnalysisHistory(_0x6c2f1c,_0x3b6f55);const _0x9755d0=_0x468018[_0x56164e(0x24e)]||![];_0x9755d0!==_0x6c2f1c[_0x56164e(0x25b)]&&(await _0x6c2f1c[_0x56164e(0x155)]('analysis.isAlert',{'val':_0x9755d0,'ack':!![]}),_0x6c2f1c[_0x56164e(0x25b)]=_0x9755d0,_0x9755d0&&(await _0x6c2f1c[_0x56164e(0x155)](_0x56164e(0x164),{'val':_0x468018[_0x56164e(0x1d3)],'ack':!![]}),sendNotification(_0x6c2f1c,_0x56164e(0x27a)+_0x468018[_0x56164e(0x1d3)],![],_0x468018[_0x56164e(0x128)])));if(_0x468018[_0x56164e(0x204)]&&_0x468018[_0x56164e(0x204)]['detected']){await _0x6c2f1c[_0x56164e(0x155)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x6c2f1c[_0x56164e(0x155)](_0x56164e(0x125),{'val':_0x468018['automationProposal'][_0x56164e(0x1ff)],'ack':!![]}),await _0x6c2f1c[_0x56164e(0x155)](_0x56164e(0x17d),{'val':_0x468018[_0x56164e(0x204)]['targetId'],'ack':!![]}),await _0x6c2f1c[_0x56164e(0x155)](_0x56164e(0x13e),{'val':JSON[_0x56164e(0x1ab)](_0x468018[_0x56164e(0x204)][_0x56164e(0x178)]),'ack':!![]});if(_0x2b28c5)executeAutomationAction(_0x6c2f1c);}}catch(_0x55ee2){_0x6c2f1c[_0x56164e(0x1de)][_0x56164e(0x132)]('Gemini\x20Error:\x20'+_0x55ee2[_0x56164e(0x174)]);}}async function startSystem(_0x311ac9){const _0x46c6a4=a0_0x27f5f1;_0x311ac9[_0x46c6a4(0x1de)][_0x46c6a4(0x1af)]('ðŸš€\x20Starting\x20NUUKANNI\x20Logic\x20(v0.14.1)...'),await initZombies(_0x311ac9);try{_0x311ac9[_0x46c6a4(0x1e5)]=await checkLicense(_0x311ac9[_0x46c6a4(0x25a)][_0x46c6a4(0x2a5)]);}catch(_0x16afc6){}if(!_0x311ac9[_0x46c6a4(0x25a)][_0x46c6a4(0x22e)]||_0x311ac9[_0x46c6a4(0x25a)][_0x46c6a4(0x22e)]<0.1)_0x311ac9[_0x46c6a4(0x25a)][_0x46c6a4(0x22e)]=0xc;await initHistory(_0x311ac9),await initSystemConfig(_0x311ac9);if(_0x311ac9['config'][_0x46c6a4(0x2a6)])try{_0x311ac9[_0x46c6a4(0x1c6)]=new GoogleGenerativeAI(_0x311ac9[_0x46c6a4(0x25a)][_0x46c6a4(0x2a6)]),_0x311ac9[_0x46c6a4(0x207)]=_0x311ac9[_0x46c6a4(0x1c6)][_0x46c6a4(0x220)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x46c6a4(0x27b)}}),_0x311ac9[_0x46c6a4(0x1de)]['info'](_0x46c6a4(0x298));}catch(_0x3c1438){_0x311ac9[_0x46c6a4(0x1de)][_0x46c6a4(0x132)]('Gemini\x20Init\x20Error:\x20'+_0x3c1438[_0x46c6a4(0x174)]);}await createAllObjects(_0x311ac9),await loadSystemMode(_0x311ac9),await loadRawEventLog(_0x311ac9),await loadDailyDigests(_0x311ac9),_0x311ac9[_0x46c6a4(0x193)]('analysis.trigger'),_0x311ac9[_0x46c6a4(0x193)](LTM_DP_TRIGGER_DIGEST),_0x311ac9[_0x46c6a4(0x193)](_0x46c6a4(0x1bb)),_0x311ac9[_0x46c6a4(0x193)](_0x46c6a4(0x201)),_0x311ac9[_0x46c6a4(0x193)](_0x46c6a4(0x237)),_0x311ac9[_0x46c6a4(0x193)](_0x46c6a4(0x11b)),_0x311ac9[_0x46c6a4(0x193)](_0x46c6a4(0x1a9)),_0x311ac9['subscribeStates'](_0x46c6a4(0x2af)),_0x311ac9[_0x46c6a4(0x193)](_0x46c6a4(0x224)),_0x311ac9[_0x46c6a4(0x193)]('analysis.training.triggerComfort'),_0x311ac9['subscribeStates'](_0x46c6a4(0x1c9)),await initSensorSubscriptions(_0x311ac9),await initPresenceSubscriptions(_0x311ac9),await setupTelegramListener(_0x311ac9),setTimeout(()=>checkWifiPresence(_0x311ac9),0x1388);if(_0x311ac9[_0x46c6a4(0x29c)])clearInterval(_0x311ac9[_0x46c6a4(0x29c)]);const _0x32fdbf=_0x311ac9[_0x46c6a4(0x25a)][_0x46c6a4(0x118)]||0xf;_0x32fdbf>0x0&&(_0x311ac9['analysisTimer']=setInterval(()=>{runAutopilot(_0x311ac9);},_0x32fdbf*0x3c*0x3e8)),schedulers[_0x46c6a4(0x229)](_0x311ac9,()=>createDailyDigest(_0x311ac9)),schedulers['setupModeResetScheduler'](_0x311ac9),schedulers[_0x46c6a4(0x14b)](_0x311ac9,()=>runBaselineDriftAnalysis(_0x311ac9)),schedulers['setupBriefingScheduler'](_0x311ac9,()=>sendMorningBriefing(_0x311ac9)),startPythonService(_0x311ac9),setTimeout(()=>{const _0x4f10b0=_0x46c6a4;topology[_0x4f10b0(0x1dd)](_0x311ac9),_0x311ac9['pythonProcess']&&(runPythonHealthCheck(_0x311ac9),triggerGaitAnalysis(_0x311ac9),triggerEnergyPrediction(_0x311ac9)),updateHealthVector(_0x311ac9);},0x1388);}class CogniLiving extends utils[a0_0x27f5f1(0x28c)]{constructor(_0x5a2323){const _0x23a209=a0_0x27f5f1;super({..._0x5a2323,'name':'cogni-living'}),this[_0x23a209(0x22f)]=[],this[_0x23a209(0x1fc)]=[],this['rawEventLog']=[],this[_0x23a209(0x280)]=[],this[_0x23a209(0x130)]={},this[_0x23a209(0x215)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x23a209(0x117)]=!![],this[_0x23a209(0x17e)]=null,this[_0x23a209(0x168)]=null,this['isGracePeriodActive']=![],this[_0x23a209(0x1c6)]=null,this['geminiModel']=null,this[_0x23a209(0x195)]=SYSTEM_MODES[_0x23a209(0x15f)],this['isProVersion']=![],this[_0x23a209(0x25b)]=![],this[_0x23a209(0x29d)]='unknown',this[_0x23a209(0x29c)]=null,this[_0x23a209(0x2a2)]=null,this[_0x23a209(0x1b2)]=null,this['driftAnalysisTimer']=null,this[_0x23a209(0x14c)]=null,this[_0x23a209(0x186)]=null,this[_0x23a209(0x17c)]=![],this['on'](_0x23a209(0x205),this[_0x23a209(0x1e0)]['bind'](this)),this['on'](_0x23a209(0x143),this[_0x23a209(0x16d)][_0x23a209(0x25e)](this)),this['on'](_0x23a209(0x170),this[_0x23a209(0x22d)][_0x23a209(0x25e)](this)),this['on'](_0x23a209(0x174),this[_0x23a209(0x209)]['bind'](this));}async[a0_0x27f5f1(0x1e0)](){const _0xa6c8f7=a0_0x27f5f1;this['log'][_0xa6c8f7(0x1af)](_0xa6c8f7(0x19b)+this[_0xa6c8f7(0x216)]+')\x20-\x20SAFE\x20BOOT');if(!installer[_0xa6c8f7(0x11d)](this,()=>startSystem(this)))return;}['onUnload'](_0x41c7e3){const _0xf05f87=a0_0x27f5f1;if(this[_0xf05f87(0x29c)])clearInterval(this[_0xf05f87(0x29c)]);if(this[_0xf05f87(0x26e)])clearInterval(this[_0xf05f87(0x26e)]);if(this[_0xf05f87(0x2a2)])this['ltmJob'][_0xf05f87(0x190)]();if(this[_0xf05f87(0x1b2)])this['modeResetJob']['cancel']();if(this[_0xf05f87(0x14c)])this[_0xf05f87(0x14c)][_0xf05f87(0x190)]();if(this[_0xf05f87(0x17e)])clearTimeout(this['exitTimer']);if(this[_0xf05f87(0x168)])clearTimeout(this[_0xf05f87(0x168)]);stopPythonService(this),_0x41c7e3();}async[a0_0x27f5f1(0x16d)](_0x44b8f4,_0x5ea1fe){const _0x222454=a0_0x27f5f1;if(!_0x5ea1fe||this[_0x222454(0x17c)])return;if(_0x44b8f4[_0x222454(0x20c)](_0x222454(0x270))&&_0x44b8f4[_0x222454(0x188)](_0x222454(0x251))&&_0x5ea1fe[_0x222454(0x12c)]){await handleTelegramResponse(this,_0x5ea1fe[_0x222454(0x12c)]);return;}if(_0x44b8f4===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0x5ea1fe[_0x222454(0x12c)]&&Object[_0x222454(0x1f4)](SYSTEM_MODES)[_0x222454(0x20c)](_0x5ea1fe[_0x222454(0x12c)])){this[_0x222454(0x195)]=_0x5ea1fe[_0x222454(0x12c)];if(_0x5ea1fe[_0x222454(0x12c)]===SYSTEM_MODES[_0x222454(0x25f)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x5ea1fe[_0x222454(0x1e2)])this[_0x222454(0x166)](_0x44b8f4,{'val':this[_0x222454(0x195)],'ack':!![]});return;}if(!_0x5ea1fe[_0x222454(0x1e2)]){_0x44b8f4[_0x222454(0x20c)](_0x222454(0x271))&&_0x5ea1fe[_0x222454(0x12c)]&&(this['setState'](_0x44b8f4,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x44b8f4[_0x222454(0x20c)](_0x222454(0x26b))&&_0x5ea1fe[_0x222454(0x12c)]){this[_0x222454(0x166)](_0x44b8f4,{'val':![],'ack':!![]});if(this[_0x222454(0x1e5)])createDailyDigest(this);}_0x44b8f4['includes']('triggerBriefing')&&_0x5ea1fe[_0x222454(0x12c)]&&(this[_0x222454(0x166)](_0x44b8f4,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x44b8f4[_0x222454(0x20c)](_0x222454(0x245))&&_0x5ea1fe['val']&&(this[_0x222454(0x166)](_0x44b8f4,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x44b8f4[_0x222454(0x20c)]('analysis.training.triggerSecurity')&&_0x5ea1fe[_0x222454(0x12c)]){this[_0x222454(0x166)](_0x44b8f4,{'val':![],'ack':!![]});if(this[_0x222454(0x1e5)])try{const _0x3f7573=await this[_0x222454(0x242)]('LTM.trainingData.sequences');if(_0x3f7573&&_0x3f7573[_0x222454(0x12c)]){const _0x4e7921=JSON[_0x222454(0x127)](_0x3f7573[_0x222454(0x12c)]);this[_0x222454(0x1de)]['info'](_0x222454(0x1ce)),this['setStateAsync'](_0x222454(0x20b),{'val':'Sec-Training\x20started...','ack':!![]}),sendToPython(this,_0x222454(0x1e9),{'sequences':_0x4e7921});}}catch(_0x5248d5){this['log'][_0x222454(0x132)](_0x222454(0x255)+_0x5248d5['message']);}}if(_0x44b8f4[_0x222454(0x20c)](_0x222454(0x2af))&&_0x5ea1fe[_0x222454(0x12c)]){this[_0x222454(0x166)](_0x44b8f4,{'val':![],'ack':!![]});if(this[_0x222454(0x1e5)])try{const _0x113dd0=await this[_0x222454(0x242)](LTM_DP_DAILY_DIGESTS);if(_0x113dd0&&_0x113dd0[_0x222454(0x12c)])sendToPython(this,_0x222454(0x153),{'digests':JSON[_0x222454(0x127)](_0x113dd0[_0x222454(0x12c)])});}catch(_0x5be49e){}}if(_0x44b8f4[_0x222454(0x20c)](_0x222454(0x224))&&_0x5ea1fe[_0x222454(0x12c)]){this[_0x222454(0x166)](_0x44b8f4,{'val':![],'ack':!![]});if(this[_0x222454(0x1e5)])try{const _0x353b5a=await this[_0x222454(0x242)](_0x222454(0x185));if(_0x353b5a&&_0x353b5a[_0x222454(0x12c)])sendToPython(this,_0x222454(0x1f5),{'points':JSON[_0x222454(0x127)](_0x353b5a[_0x222454(0x12c)])});}catch(_0x3ca4fd){}}if(_0x44b8f4[_0x222454(0x20c)](_0x222454(0x223))&&_0x5ea1fe[_0x222454(0x12c)]){this[_0x222454(0x166)](_0x44b8f4,{'val':![],'ack':!![]});if(this[_0x222454(0x1e5)])try{const _0xdb578d=await this['getStateAsync'](LTM_DP_RAW_LOG);_0xdb578d&&_0xdb578d['val']&&(this[_0x222454(0x1de)][_0x222454(0x1af)]('ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...'),sendToPython(this,_0x222454(0x197),{'events':JSON[_0x222454(0x127)](_0xdb578d[_0x222454(0x12c)])}));}catch(_0x25ab3b){}}_0x44b8f4[_0x222454(0x20c)](_0x222454(0x1c9))&&_0x5ea1fe[_0x222454(0x12c)]&&(this[_0x222454(0x166)](_0x44b8f4,{'val':![],'ack':!![]}),this[_0x222454(0x1de)][_0x222454(0x1af)](_0x222454(0x159)),topology['updateTopology'](this));return;}if(this[_0x222454(0x25a)][_0x222454(0x208)]&&this[_0x222454(0x25a)][_0x222454(0x208)][_0x222454(0x20c)](_0x44b8f4)){await checkWifiPresence(this);return;}const _0x3d791c=(this[_0x222454(0x25a)][_0x222454(0x1fb)]||[])[_0x222454(0x1bf)](_0x4f22a1=>_0x4f22a1['id']===_0x44b8f4);if(_0x3d791c)processSensorEvent(this,_0x44b8f4,_0x5ea1fe,_0x3d791c);}async[a0_0x27f5f1(0x209)](_0x26ab6c){const _0x26816c=a0_0x27f5f1;if(typeof _0x26ab6c==='object'&&_0x26ab6c[_0x26816c(0x174)]){if(_0x26ab6c[_0x26816c(0x28e)]===_0x26816c(0x1f0)){const _0x3e712e=_0x26ab6c[_0x26816c(0x174)][_0x26816c(0x1b6)]||this[_0x26816c(0x25a)]['geminiApiKey'];if(!_0x3e712e)return this['sendTo'](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c['command'],{'success':![],'message':'Kein\x20API\x20Key.'},_0x26ab6c[_0x26816c(0x2aa)]);try{const _0x212f23=new GoogleGenerativeAI(_0x3e712e),_0x17b7fc=_0x212f23[_0x26816c(0x220)]({'model':GEMINI_MODEL}),_0xa4a7a2=await _0x17b7fc[_0x26816c(0x258)]('Hi');this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c['command'],{'success':!![],'message':_0x26816c(0x1b0)+_0xa4a7a2['response'][_0x26816c(0x12a)]()},_0x26ab6c[_0x26816c(0x2aa)]);}catch(_0x89aecf){this['sendTo'](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':![],'message':'Err:\x20'+_0x89aecf[_0x26816c(0x174)]},_0x26ab6c[_0x26816c(0x2aa)]);}}else{if(_0x26ab6c[_0x26816c(0x28e)]==='testContext'){const _0x44dd42=await getWeatherContext(this),_0x2d115a=await getCalendarContext(this);this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c['command'],{'success':!![],'weather':_0x44dd42,'calendar':_0x2d115a},_0x26ab6c[_0x26816c(0x2aa)]);}else{if(_0x26ab6c['command']===_0x26816c(0x1a3)){if(!this[_0x26816c(0x1e5)])return this['sendTo'](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':![],'isPro':![]},_0x26ab6c[_0x26816c(0x2aa)]);let _0x137436={'status':'N/A'};try{const _0x3f6a54=await this[_0x26816c(0x242)](LTM_DP_DRIFT_STATUS);_0x137436[_0x26816c(0x288)]=_0x3f6a54?_0x3f6a54['val']:'N/A';}catch(_0x491d6f){}this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x137436,'analysisHistory':this[_0x26816c(0x1fc)]},_0x26ab6c[_0x26816c(0x2aa)]);}else{if(_0x26ab6c[_0x26816c(0x28e)]==='getOverviewData'){const _0x489638=this['dailyDigests']['length'],_0x1d99e6=new Date(),_0x5797a6=new Date(_0x1d99e6[_0x26816c(0x210)](),_0x1d99e6[_0x26816c(0x15d)](),_0x1d99e6[_0x26816c(0x1ba)]())[_0x26816c(0x123)](),_0x9c0373=this[_0x26816c(0x225)][_0x26816c(0x157)](_0x5b8fb6=>new Date(_0x5b8fb6[_0x26816c(0x1ca)])[_0x26816c(0x123)]()>_0x5797a6)[_0x26816c(0x299)],_0x44145b=new Array(0x18)[_0x26816c(0x22a)](0x0);this[_0x26816c(0x225)][_0x26816c(0x1b7)](_0x141795=>{const _0x13fb43=_0x26816c,_0x553682=new Date(_0x141795[_0x13fb43(0x1ca)]);if(_0x553682[_0x13fb43(0x123)]()>_0x5797a6)_0x44145b[_0x553682['getHours']()]++;});let _0x29f30b={'status':_0x26816c(0x254)};try{const _0xb9bda3=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x29f30b[_0x26816c(0x288)]=_0xb9bda3?_0xb9bda3[_0x26816c(0x12c)]:_0x26816c(0x254);}catch(_0x3a42fb){}let _0x599b53='';try{const _0x3d80f6=await this['getStateAsync']('system.presenceWho');_0x599b53=_0x3d80f6?_0x3d80f6[_0x26816c(0x12c)]:'';}catch(_0x2536a7){}let _0x365034=null;!this[_0x26816c(0x207)]&&(_0x365034=this[_0x26816c(0x25a)][_0x26816c(0x2a6)]?_0x26816c(0x12e):_0x26816c(0x15c));let _0x59ff65={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x137a68=await this['getStateAsync'](_0x26816c(0x13c));if(_0x137a68&&_0x137a68['val']){_0x59ff65[_0x26816c(0x1ec)]=!![];const _0x35b910=await this[_0x26816c(0x242)]('analysis.automation.description');_0x59ff65['description']=_0x35b910?_0x35b910[_0x26816c(0x12c)]:'';const _0xd214d=await this[_0x26816c(0x242)](_0x26816c(0x17d));_0x59ff65[_0x26816c(0x21e)]=_0xd214d?_0xd214d[_0x26816c(0x12c)]:'';const _0x276199=await this[_0x26816c(0x242)]('analysis.automation.targetValue');_0x59ff65[_0x26816c(0x178)]=_0x276199?_0x276199['val']:'';}const _0x3adf98=await this['getStateAsync'](_0x26816c(0x11b));_0x59ff65[_0x26816c(0x163)]=_0x3adf98?!!_0x3adf98[_0x26816c(0x12c)]:![];}catch(_0x3935c0){}this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':!![],'eventHistory':this[_0x26816c(0x22f)][_0x26816c(0x12d)](0x0,0xf),'stats':{'digestCount':_0x489638,'eventCountToday':_0x9c0373,'hourlyActivity':_0x44145b,'driftStatus':_0x29f30b['status'],'isPresent':this[_0x26816c(0x117)],'presenceWho':_0x599b53,'minDays':this[_0x26816c(0x25a)][_0x26816c(0x14e)]||0x7,'stbDays':this[_0x26816c(0x25a)][_0x26816c(0x295)]||0xe,'ltbDays':this['config']['ltmLtbWindowDays']||0x3c,'systemError':_0x365034},'automation':_0x59ff65},_0x26ab6c['callback']);}else{if(_0x26ab6c[_0x26816c(0x28e)]===_0x26816c(0x175))try{const _0x2bc5e1=await scanner[_0x26816c(0x2a9)](this,_0x26ab6c[_0x26816c(0x174)]||{});this['sendTo'](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c['command'],{'success':!![],'devices':_0x2bc5e1},_0x26ab6c[_0x26816c(0x2aa)]);}catch(_0x25255b){this['sendTo'](_0x26ab6c['from'],_0x26ab6c[_0x26816c(0x28e)],{'success':![],'error':_0x25255b[_0x26816c(0x174)]},_0x26ab6c[_0x26816c(0x2aa)]);}else{if(_0x26ab6c[_0x26816c(0x28e)]==='getEnums'){const _0x18856d=await this['getForeignObjectsAsync'](_0x26816c(0x1be),_0x26816c(0x147)),_0x48465d=[];if(_0x18856d)for(const _0x217f67 in _0x18856d){const _0x2acefe=_0x18856d[_0x217f67],_0x42dda5=(_0x2acefe['common']&&typeof _0x2acefe['common']['name']===_0x26816c(0x202)?_0x2acefe[_0x26816c(0x29b)][_0x26816c(0x1d6)]['de']:_0x2acefe[_0x26816c(0x29b)][_0x26816c(0x1d6)])||_0x2acefe['common']['name'];_0x48465d[_0x26816c(0x179)]({'id':_0x217f67,'name':_0x42dda5});}const _0x3f43ea=await this[_0x26816c(0x11e)]('enum.rooms.*',_0x26816c(0x147)),_0x44bfb3=[];if(_0x3f43ea)for(const _0x4ce0da in _0x3f43ea){const _0x3558af=_0x3f43ea[_0x4ce0da],_0x579ead=(_0x3558af[_0x26816c(0x29b)]&&typeof _0x3558af[_0x26816c(0x29b)][_0x26816c(0x1d6)]==='object'?_0x3558af[_0x26816c(0x29b)]['name']['de']:_0x3558af['common']['name'])||_0x4ce0da[_0x26816c(0x238)]('.')['pop']();_0x44bfb3['push'](_0x579ead);}this[_0x26816c(0x150)](_0x26ab6c['from'],_0x26ab6c[_0x26816c(0x28e)],{'success':!![],'enums':_0x48465d,'rooms':_0x44bfb3},_0x26ab6c[_0x26816c(0x2aa)]);}else{if(_0x26ab6c[_0x26816c(0x28e)]===_0x26816c(0x2a3)){const _0x202d75=_0x26ab6c[_0x26816c(0x174)][_0x26816c(0x15a)];if(!_0x202d75)return this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':![],'error':_0x26816c(0x198)},_0x26ab6c[_0x26816c(0x2aa)]);const _0x5f08dc=await getCalendarNames(this,_0x202d75);this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':!![],'names':_0x5f08dc},_0x26ab6c[_0x26816c(0x2aa)]);}else{if(_0x26ab6c['command']===_0x26816c(0x1e6)){const {targetId:_0x2ee76a,targetValue:_0x2b8629}=_0x26ab6c[_0x26816c(0x174)];this[_0x26816c(0x1de)][_0x26816c(0x1af)](_0x26816c(0x173)+_0x2ee76a+_0x26816c(0x252)+_0x2b8629),await this[_0x26816c(0x155)](_0x26816c(0x13c),{'val':!![],'ack':!![]}),await this[_0x26816c(0x155)](_0x26816c(0x125),{'val':'SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20'+_0x2ee76a,'ack':!![]}),await this[_0x26816c(0x155)](_0x26816c(0x17d),{'val':_0x2ee76a,'ack':!![]}),await this[_0x26816c(0x155)](_0x26816c(0x13e),{'val':_0x2b8629,'ack':!![]}),this['sendTo'](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':!![]},_0x26ab6c[_0x26816c(0x2aa)]);}else{if(_0x26ab6c[_0x26816c(0x28e)]==='submitFeedback'){const {historyId:_0x424848,rating:_0x45955,comment:_0x31568f,alertReason:_0x4fecbd}=_0x26ab6c[_0x26816c(0x174)];_0x424848&&_0x45955?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x424848,'rating':_0x45955,'comment':_0x31568f,'alertReason':_0x4fecbd}),this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c['command'],{'success':!![]},_0x26ab6c[_0x26816c(0x2aa)])):this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':![],'error':_0x26816c(0x184)},_0x26ab6c[_0x26816c(0x2aa)]);}else{if(_0x26ab6c[_0x26816c(0x28e)]===_0x26816c(0x1eb))this[_0x26816c(0x1de)][_0x26816c(0x1af)](_0x26816c(0x1e3)),await this[_0x26816c(0x155)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x26816c(0x155)](_0x26816c(0x125),{'val':'','ack':!![]}),this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':!![]},_0x26ab6c[_0x26816c(0x2aa)]);else{if(_0x26ab6c[_0x26816c(0x28e)]==='updateTopologyMatrix'){const {matrix:_0x10c42d}=_0x26ab6c[_0x26816c(0x174)];try{const _0x2ba4be=await this['getStateAsync'](_0x26816c(0x14a));if(_0x2ba4be&&_0x2ba4be[_0x26816c(0x12c)]){const _0x651aaf=JSON[_0x26816c(0x127)](_0x2ba4be[_0x26816c(0x12c)]);_0x651aaf[_0x26816c(0x2a4)]=_0x10c42d,_0x651aaf['updated']=Date[_0x26816c(0x1c8)](),await this['setStateAsync'](_0x26816c(0x14a),{'val':JSON[_0x26816c(0x1ab)](_0x651aaf),'ack':!![]}),this[_0x26816c(0x1de)][_0x26816c(0x1af)](_0x26816c(0x296));}this[_0x26816c(0x150)](_0x26ab6c[_0x26816c(0x2b2)],_0x26ab6c[_0x26816c(0x28e)],{'success':!![]},_0x26ab6c[_0x26816c(0x2aa)]);}catch(_0x38ee9e){this[_0x26816c(0x1de)]['error'](_0x26816c(0x1a5)+_0x38ee9e[_0x26816c(0x174)]);}}}}}}}}}}}}}}}if(require[a0_0x27f5f1(0x1e8)]!==module)module[a0_0x27f5f1(0x1a8)]=_0x468e5d=>new CogniLiving(_0x468e5d);else new CogniLiving();