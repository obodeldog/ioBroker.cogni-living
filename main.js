const a0_0x32032f=a0_0x4f8e;(function(_0x5cf19b,_0x2ef9f9){const _0x1db936=a0_0x4f8e,_0x519ef4=_0x5cf19b();while(!![]){try{const _0x3f5683=-parseInt(_0x1db936(0x21f))/0x1+parseInt(_0x1db936(0x147))/0x2+-parseInt(_0x1db936(0x173))/0x3*(parseInt(_0x1db936(0x20d))/0x4)+parseInt(_0x1db936(0x1d7))/0x5*(-parseInt(_0x1db936(0x168))/0x6)+parseInt(_0x1db936(0x294))/0x7*(-parseInt(_0x1db936(0x2b5))/0x8)+-parseInt(_0x1db936(0x2b9))/0x9+parseInt(_0x1db936(0x2ba))/0xa*(parseInt(_0x1db936(0x18e))/0xb);if(_0x3f5683===_0x2ef9f9)break;else _0x519ef4['push'](_0x519ef4['shift']());}catch(_0x1a4487){_0x519ef4['push'](_0x519ef4['shift']());}}}(a0_0x334d,0x7dafd));const a0_0x3d36e2=(function(){let _0x272b86=!![];return function(_0x2b130e,_0x10a9a0){const _0x32ea81=_0x272b86?function(){const _0x1b5c60=a0_0x4f8e;if(_0x10a9a0){const _0x3b6ec5=_0x10a9a0[_0x1b5c60(0x22b)](_0x2b130e,arguments);return _0x10a9a0=null,_0x3b6ec5;}}:function(){};return _0x272b86=![],_0x32ea81;};}()),a0_0x57386c=a0_0x3d36e2(this,function(){const _0x55cc12=a0_0x4f8e;return a0_0x57386c[_0x55cc12(0x299)]()[_0x55cc12(0x2b8)]('(((.+)+)+)+$')[_0x55cc12(0x299)]()[_0x55cc12(0x1f6)](a0_0x57386c)[_0x55cc12(0x2b8)](_0x55cc12(0x1f5));});function a0_0x334d(){const _0x2d5dc3=['Logbook','triggerBriefing','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','toISOString','includes','isArray','summary','analysis.deviationFromBaseline','getStateAsync','Lernphase\x20(','useWeather','08:00','onStateChange','inactivityMonitoringEnabled','isPresent','0\x203\x20*\x20*\x20*','Kein\x20API\x20Key!','stick_unreach','driftAnalysisTimer','252AyRSeg','unreach','stringify','button','System\x20Mode','enum.functions.*','lights','scanDevices','lastIndexOf','string','dailyDigests','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','boolean','communicate.request','.data.table','replace','autoApply','sensorLastValues','542917qDoDJb','aiPersona','members','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','now','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','.\x20OUTPUT:\x20Nur\x20Text.','link_quality','actual_temperature','getForeignObjectAsync','systemUUID','Party','apply','length','channel','KALENDER:\x20Keine\x20Daten','automation.triggerAction','PRIORITÃ„T:\x20Sicherheit.','callback','exitGraceTimer','fault','notifyPushoverRecipient','\x20|\x20','\x20events','cover','detected','setObjectNotExistsAsync','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','warn','@iobroker/adapter-core','exports','Morning\x20Briefing\x20sent.','Raw\x20Log','setState','some','KI-Modell\x20nicht\x20initialisiert','AI\x20Emergency\x20Status','\x20sensors...','system.isPresent','node-schedule','toLowerCase','analysis.automation.triggerAction','object','calendarInstance','Scheduling\x20Morning\x20Briefing\x20for\x20','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','Error\x20checking\x20WiFi:\x20','Sleep\x20Score\x20(0-100)','getOverviewData','getCalendarNames\x20Error:\x20','isProVersion','filter','notifyTelegramInstance','Description','heizung','Wetter:\x20Deaktiviert','material.','.Summary.Current','analysis.comfortSuggestion','doors','temperature','targetValue','uuid-error','Urlaub','triggerDailyDigest','update','details','enum.rooms.*','getGenerativeModel','Comfort\x20Suggestion','json','analysis.history_debug_00','User\x20dismissed\x20automation\x20proposal.','timestamp','health','@google/generative-ai','calendarSelection','normal','getForeignStateAsync','_calName','Fokus\x20auf\x20Komfort.','firmware','onReady','LTM.driftAnalysis.driftDetails','switch','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','setForeignStateAsync','config','analysisHistory','generateContent','geminiModel','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','analysis.automation.suggestedAction','number','Drift\x20Sched\x20Error:\x20','targetId','openweathermap','energy','lock','getTime','analysis.feedbackHistory','direction','state','system.presenceWho','power','rollladen','system.config','position','analysis.isEmergency','uuid','LTM.driftAnalysis.lastCheck','analysis.automation.targetId','send','analysis.automation','getEnums','endsWith','events.history','62937RneCQi','toFixed','analysis.automation.targetValue','notifyTelegramRecipient','getHours','toString','connection','briefingJob','light','testNotification','analysis.automation.description','ack','PRIORITÃ„T:\x20Gesundheit/AAL.','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','.NextHours.Location_1.Day_1.current.symbol_desc','Starting\x20Autopilot\x20(','daswetter.0','Subscribing\x20to\x20','notifyPushoverInstance','echarts.','expire','analysis.isAlert','set_temperature','custom','map','sendTo','klima','scheduleJob','presence','briefingEnabled','Missing\x20data','getLtmData','cogni-living\x20adapter\x20starting\x20(v','24YVQjwh','status','Drift\x20Details','search','3537ToLBWp','3320FPPYOU','Started\x20at\x20','unshift','application/json','ðŸš¨\x20EMERGENCY','ðŸŒ…\x20Daily\x20Briefing:\x0a','ready','feedbackHistory','0\x204\x20*\x20*\x20*','door','LTM.processingStatus','LTM.baselineStatus','exitTimer','prÃ¤senz','TEST-PRO-KEY','name','.\x20DATEN:\x20Schlaf\x20','uuid-not-found','briefingTime','cancel','[TEST]\x20','join','genAI','modeResetJob','toLocaleString','PRO-','push','Briefing\x20Sched\x20Error:\x20','Success:\x20Compressed\x20','analysis.health','analysis.trigger','online','blind','pop','cogni-living','weather','294196topFxl','party','Briefing\x20Error:\x20','brightness','city','PARTY','longitude','getObjectAsync','system','message','vis.','humidity','from','accuweather.0','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','targetposition','native','scriptProblem','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','common','value.health','Event\x20History','indexOf','Health\x20Notes','icons-mfd.','rawEventLog','text.alarm','ltmLtbWindowDays','getCalendarNames','daswetter','Deaktiviert\x20(Pro-Feature)','WETTER:\x20','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','3965874pnCMDD','namespace','eventHistory','\x20hours.\x20Potential\x20incapacitation.','notifyEmailInstance','VACATION','fill','ðŸ“¡\x20Hooking\x20into\x20','reachable','ltmJob','instance','45639DBzyDW','weatherInstance','system.mode','date','\x20Tage)','response','systemConfig','_score','openweathermap.0','generic','motion','âœ…\x20Alles\x20OK\x20(Reset)','analysis.automation.patternDetected','analysis.lastResult','setStateAsync','isGracePeriodActive','licenseKey','log','analysisInterval','latitude','Baseline\x20Status','events.history_debug_00','Comfort\x20Summary','licht','parse','error','sleepScore','84733QcEAou','find','rssi','\x20=\x20','.\x20KONTEXT:\x20','flot.','Trigger\x20Briefing\x20(Test)','Skipped\x20(No\x20AI\x20or\x20Data)','text','fenster','main','forEach','time','lowbat','substring','currentSystemMode','inactivityThresholdHours','presenceDevices','maintenance','activityLevel','vacation','sort','ltmDriftCheckIntervalHours','driftDetails','Fokus\x20auf\x20Familienroutinen.','notifyTelegramEnabled','WETTER:\x20Keine\x20Daten\x20gefunden','analysis.triggerBriefing','COGNI_CONFIRM_OK','trim','Last\x20Result','Drift\x20Status','Trigger\x20Analysis','minDaysForBaseline','retry','analysis.alertReason','valve','slice','getMonth','analysis.analysisHistory','analysis.health.notes','KALENDER\x20ERROR:\x20','\x20presence\x20devices...','enum','stateChange','onMessage','Auto\x20Apply\x20Rule','LTM.dailyDigests','Activity\x20Summary','simulateButler','Error\x20reading\x20calendar\x20table:\x20','NORMAL','accuweather','extendObjectAsync','COGNI_REQUEST_CALL',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','notifyEmailRecipient','subscribeStates','N/A','Deviation','Pattern\x20Detected','analysisTimer','Processing\x20Status','admin.','Automation\x20Proposals','split','geminiApiKey','command','LTM','Kalender:\x20Deaktiviert','onUnload','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','Feedback\x20saved:\x20','5cfEiYm','guest','thermostat','bind','info.','Gemini\x20AI\x20initialized.','val','lastAlertState','occupancy','lastCheck','startsWith','\x20for\x20interactive\x20buttons...','simple-api.','info','Target\x20Value','analysis.health.sleepScore','devices','baselineDrift','getForeignObjectsAsync','history.','models/gemini-flash-latest','values','subscribeForeignStatesAsync','sound','notifyEmailEnabled','siren','Error:\x20','Target\x20ID','tÃ¼r','setHours','(((.+)+)+)+$','constructor','sendToAsync','Restlessness\x20Level','Trigger\x20Digest'];a0_0x334d=function(){return _0x2d5dc3;};return a0_0x334d();}a0_0x57386c();'use strict';const utils=require(a0_0x32032f(0x23c)),{GoogleGenerativeAI}=require(a0_0x32032f(0x26a)),schedule=require(a0_0x32032f(0x246)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x32032f(0x1eb),LTM_SCHEDULE=a0_0x32032f(0x209),MODE_RESET_SCHEDULE=a0_0x32032f(0x2c2),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x32032f(0x1bd),LTM_DP_STATUS=a0_0x32032f(0x2c4),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x32032f(0x2c5),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x32032f(0x272),LTM_DP_DRIFT_LAST_CHECK=a0_0x32032f(0x28d),SYSTEM_DP_MODE=a0_0x32032f(0x175),HARD_IGNORE_TERMS=[a0_0x32032f(0x158),'scriptEnabled',a0_0x32032f(0x260),a0_0x32032f(0x20e),a0_0x32032f(0x19b),a0_0x32032f(0x190),a0_0x32032f(0x29a),a0_0x32032f(0x1a0),a0_0x32032f(0x18c),a0_0x32032f(0x233),'working',a0_0x32032f(0x284),a0_0x32032f(0x20b),'config_pending','dutycycle',a0_0x32032f(0x270),a0_0x32032f(0x170),a0_0x32032f(0x226)],BAD_NAMES=[a0_0x32032f(0x156),'currentposition','state','level','value',a0_0x32032f(0x14a),'on','off',a0_0x32032f(0x273),a0_0x32032f(0x28a),'shutter',a0_0x32032f(0x143),a0_0x32032f(0x237),a0_0x32032f(0x2b6),a0_0x32032f(0x17d),a0_0x32032f(0x2b0),a0_0x32032f(0x1df),a0_0x32032f(0x25b),a0_0x32032f(0x152),a0_0x32032f(0x287),a0_0x32032f(0x280),'setpoint',a0_0x32032f(0x1b2),a0_0x32032f(0x227),a0_0x32032f(0x2aa)],ADAPTER_BLACKLIST=['system.',a0_0x32032f(0x1cd),a0_0x32032f(0x1db),a0_0x32032f(0x151),a0_0x32032f(0x1ea),a0_0x32032f(0x257),a0_0x32032f(0x15f),a0_0x32032f(0x193),a0_0x32032f(0x2a7),'javascript.',a0_0x32032f(0x1e3)],SYSTEM_MODES={'NORMAL':a0_0x32032f(0x26c),'VACATION':a0_0x32032f(0x1a2),'PARTY':a0_0x32032f(0x148),'GUEST':a0_0x32032f(0x1d8)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x32032f(0x14c)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x32032f(0x2a0),'family':a0_0x32032f(0x1a6),'single_comfort':a0_0x32032f(0x26f),'security':a0_0x32032f(0x230)};async function initZombies(_0x2ee340){const _0x572c62=a0_0x32032f;try{const _0x4d2977=[_0x572c62(0x266),_0x572c62(0x188)];for(const _0x4bd1bb of _0x4d2977){try{const _0x34df95=await _0x2ee340[_0x572c62(0x14e)](_0x4bd1bb);_0x34df95&&await _0x2ee340['delObjectAsync'](_0x4bd1bb);}catch(_0x892c0d){}}}catch(_0xeac2e5){}}async function initHistory(_0x242c17){const _0x89dcef=a0_0x32032f;try{const _0x1f73c9=await _0x242c17[_0x89dcef(0x202)](_0x89dcef(0x293));_0x1f73c9&&_0x1f73c9['val']&&(_0x242c17[_0x89dcef(0x16a)]=JSON[_0x89dcef(0x18b)](_0x1f73c9[_0x89dcef(0x1dd)][_0x89dcef(0x299)]()));}catch(_0xfa690d){_0x242c17['eventHistory']=[];}try{const _0x2641a8=await _0x242c17[_0x89dcef(0x202)]('analysis.analysisHistory');if(_0x2641a8&&_0x2641a8['val'])_0x242c17[_0x89dcef(0x277)]=JSON[_0x89dcef(0x18b)](_0x2641a8[_0x89dcef(0x1dd)][_0x89dcef(0x299)]());}catch(_0x396c22){_0x242c17[_0x89dcef(0x277)]=[];}}async function initSystemConfig(_0x4568f5){const _0xff4435=a0_0x32032f;try{const _0x510433=await _0x4568f5['getForeignObjectAsync'](_0xff4435(0x289));_0x510433&&_0x510433['common']&&(_0x4568f5[_0xff4435(0x179)]={'latitude':_0x510433[_0xff4435(0x15a)][_0xff4435(0x186)]||0x0,'longitude':_0x510433[_0xff4435(0x15a)][_0xff4435(0x14d)]||0x0,'city':_0x510433[_0xff4435(0x15a)][_0xff4435(0x14b)]||''});}catch(_0x165111){}}async function checkLicense(_0x530a85,_0x3adbfd){const _0x501006=a0_0x32032f;if(!_0x3adbfd)return![];_0x530a85[_0x501006(0x229)]=await getSystemUUID(_0x530a85);if(_0x3adbfd===_0x501006(0x131)||_0x3adbfd[_0x501006(0x1e1)](_0x501006(0x13c)))return!![];return![];}async function getSystemUUID(_0x25c198){const _0x5dcc87=a0_0x32032f;try{const _0x122cd8=await _0x25c198['getForeignObjectAsync']('system.meta.uuid');if(_0x122cd8&&_0x122cd8[_0x5dcc87(0x157)]&&_0x122cd8[_0x5dcc87(0x157)][_0x5dcc87(0x28c)])return _0x122cd8[_0x5dcc87(0x157)]['uuid'];return _0x5dcc87(0x134);}catch(_0x5b97c1){return _0x5dcc87(0x25d);}}async function createAllObjects(_0x2d28aa){const _0x10a9aa=a0_0x32032f;await checkSystemObjects(_0x2d28aa),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x286),{'type':_0x10a9aa(0x285),'common':{'name':'Who\x20is\x20present?','type':_0x10a9aa(0x216),'role':'text','read':!![],'write':![],'def':''},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('events.lastEvent',{'type':'state','common':{'name':'Last\x20raw\x20event','type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x293),{'type':'state','common':{'name':_0x10a9aa(0x15c),'type':'string','role':_0x10a9aa(0x265),'read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('analysis.trigger',{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x1ae),'type':'boolean','role':_0x10a9aa(0x210),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x1a9),{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x194),'type':_0x10a9aa(0x219),'role':_0x10a9aa(0x210),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2d28aa['setObjectNotExistsAsync'](_0x10a9aa(0x180),{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x1ac),'type':'string','role':_0x10a9aa(0x265),'read':!![],'write':![]},'native':{}}),await _0x2d28aa['setObjectNotExistsAsync']('analysis.isAlert',{'type':_0x10a9aa(0x285),'common':{'name':'AI\x20Alert\x20Status','type':'boolean','role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x2d28aa['setObjectNotExistsAsync'](_0x10a9aa(0x28b),{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x243),'type':_0x10a9aa(0x219),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('analysis.alertReason',{'type':_0x10a9aa(0x285),'common':{'name':'Alert\x20Reason','type':_0x10a9aa(0x216),'role':_0x10a9aa(0x161),'read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('analysis.activitySummary',{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x1be),'type':_0x10a9aa(0x216),'role':_0x10a9aa(0x196),'read':!![],'write':![]},'native':{}}),await _0x2d28aa['setObjectNotExistsAsync'](_0x10a9aa(0x201),{'type':'state','common':{'name':_0x10a9aa(0x1c9),'type':_0x10a9aa(0x216),'role':_0x10a9aa(0x285),'read':!![],'write':![],'def':_0x10a9aa(0x1c8)},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('analysis.comfortSummary',{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x189),'type':_0x10a9aa(0x216),'role':_0x10a9aa(0x196),'read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x259),{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x264),'type':'string','role':_0x10a9aa(0x196),'read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x1c3)](_0x10a9aa(0x290),{'type':'channel','common':{'name':_0x10a9aa(0x1ce)},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x17f),{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x1ca),'type':_0x10a9aa(0x219),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('analysis.automation.description',{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x254),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x27b),{'type':_0x10a9aa(0x285),'common':{'name':'Action','type':_0x10a9aa(0x216),'role':'text','read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x28e),{'type':'state','common':{'name':_0x10a9aa(0x1f2),'type':_0x10a9aa(0x216),'role':_0x10a9aa(0x196),'read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x296),{'type':'state','common':{'name':_0x10a9aa(0x1e5),'type':_0x10a9aa(0x216),'role':_0x10a9aa(0x196),'read':!![],'write':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('analysis.automation.autoApply',{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x1bc),'type':_0x10a9aa(0x219),'role':_0x10a9aa(0x273),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x248),{'type':_0x10a9aa(0x285),'common':{'name':'Trigger\x20Action\x20Now','type':_0x10a9aa(0x219),'role':_0x10a9aa(0x210),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('analysis.analysisHistory',{'type':'state','common':{'name':_0x10a9aa(0x1fa),'type':_0x10a9aa(0x216),'role':_0x10a9aa(0x265),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x283),{'type':_0x10a9aa(0x285),'common':{'name':'Feedback\x20Log','type':'string','role':_0x10a9aa(0x265),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2d28aa[_0x10a9aa(0x1c3)](_0x10a9aa(0x140),{'type':'channel','common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)](_0x10a9aa(0x1e6),{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x24e),'type':'number','role':_0x10a9aa(0x15b),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x2d28aa[_0x10a9aa(0x239)]('analysis.health.restlessness',{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x1f8),'type':'string','role':_0x10a9aa(0x196),'read':!![],'write':![],'def':'none'},'native':{}}),await _0x2d28aa['setObjectNotExistsAsync'](_0x10a9aa(0x1b6),{'type':_0x10a9aa(0x285),'common':{'name':_0x10a9aa(0x15e),'type':_0x10a9aa(0x216),'role':'text','read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x2d28aa),await checkLtmDriftObjects(_0x2d28aa);}async function checkSystemObjects(_0x10f558){const _0x78ab52=a0_0x32032f;await _0x10f558['extendObjectAsync'](_0x78ab52(0x14f),{'type':'channel','common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0x10f558[_0x78ab52(0x1c3)](SYSTEM_DP_MODE,{'type':_0x78ab52(0x285),'common':{'name':_0x78ab52(0x211),'type':'string','role':_0x78ab52(0x285),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x78ab52(0x1c1)],'states':{[SYSTEM_MODES['NORMAL']]:'Normal',[SYSTEM_MODES[_0x78ab52(0x16d)]]:_0x78ab52(0x25e),[SYSTEM_MODES['PARTY']]:_0x78ab52(0x22a),[SYSTEM_MODES['GUEST']]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x4ab957){const _0x1114fd=a0_0x32032f;await _0x4ab957[_0x1114fd(0x1c3)](_0x1114fd(0x1d2),{'type':_0x1114fd(0x22d),'common':{'name':_0x1114fd(0x1d2)},'native':{}}),await _0x4ab957[_0x1114fd(0x1c3)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x1114fd(0x23f),'type':_0x1114fd(0x216),'role':'json','read':!![],'write':![]},'native':{}}),await _0x4ab957[_0x1114fd(0x1c3)](LTM_DP_DAILY_DIGESTS,{'type':_0x1114fd(0x285),'common':{'name':'Daily\x20Digests','type':_0x1114fd(0x216),'role':_0x1114fd(0x265),'read':!![],'write':![]},'native':{}}),await _0x4ab957['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x1114fd(0x285),'common':{'name':_0x1114fd(0x1cc),'type':'string','role':_0x1114fd(0x196),'read':!![],'write':![]},'native':{}}),await _0x4ab957['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x1114fd(0x285),'common':{'name':_0x1114fd(0x1f9),'type':_0x1114fd(0x219),'role':_0x1114fd(0x210),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4ab957[_0x1114fd(0x1c3)](LTM_DP_BASELINE_STATUS,{'type':_0x1114fd(0x285),'common':{'name':_0x1114fd(0x187),'type':_0x1114fd(0x216),'role':_0x1114fd(0x196),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4fc672){const _0x19bba1=a0_0x32032f;await _0x4fc672[_0x19bba1(0x1c3)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x4fc672[_0x19bba1(0x1c3)](LTM_DP_DRIFT_STATUS,{'type':_0x19bba1(0x285),'common':{'name':_0x19bba1(0x1ad),'type':_0x19bba1(0x216),'role':_0x19bba1(0x285),'read':!![],'write':![],'def':_0x19bba1(0x1c8)},'native':{}}),await _0x4fc672[_0x19bba1(0x1c3)](LTM_DP_DRIFT_DETAILS,{'type':_0x19bba1(0x285),'common':{'name':_0x19bba1(0x2b7),'type':_0x19bba1(0x216),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4fc672[_0x19bba1(0x1c3)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':'Last\x20Check','type':_0x19bba1(0x27c),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x2a3b12){const _0x36136c=a0_0x32032f;try{const _0x3a2178=await _0x2a3b12[_0x36136c(0x202)](SYSTEM_DP_MODE);_0x3a2178&&_0x3a2178[_0x36136c(0x1dd)]&&Object[_0x36136c(0x1ec)](SYSTEM_MODES)['includes'](_0x3a2178[_0x36136c(0x1dd)])?_0x2a3b12[_0x36136c(0x19d)]=_0x3a2178['val']:(_0x2a3b12[_0x36136c(0x19d)]=SYSTEM_MODES[_0x36136c(0x1c1)],await _0x2a3b12[_0x36136c(0x181)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x3a3b7d){_0x2a3b12['currentSystemMode']=SYSTEM_MODES[_0x36136c(0x1c1)];}}async function loadRawEventLog(_0x187842){const _0x28b442=a0_0x32032f;try{const _0x46c768=await _0x187842[_0x28b442(0x202)](LTM_DP_RAW_LOG);if(_0x46c768&&_0x46c768[_0x28b442(0x1dd)])_0x187842[_0x28b442(0x160)]=JSON['parse'](_0x46c768[_0x28b442(0x1dd)]);}catch(_0x28315b){_0x187842['rawEventLog']=[];}}async function saveRawEventLog(_0x18747d){const _0x35908e=a0_0x32032f;_0x18747d['rawEventLog'][_0x35908e(0x22c)]>RAW_LOG_MAX_SIZE&&_0x18747d[_0x35908e(0x160)]['splice'](0x0,_0x18747d['rawEventLog'][_0x35908e(0x22c)]-RAW_LOG_MAX_SIZE),await _0x18747d[_0x35908e(0x181)](LTM_DP_RAW_LOG,{'val':JSON[_0x35908e(0x20f)](_0x18747d[_0x35908e(0x160)]),'ack':!![]});}async function loadDailyDigests(_0x15873a){const _0x38e739=a0_0x32032f;try{const _0x1e6d7f=await _0x15873a[_0x38e739(0x202)](LTM_DP_DAILY_DIGESTS);if(_0x1e6d7f&&_0x1e6d7f[_0x38e739(0x1dd)])_0x15873a[_0x38e739(0x217)]=JSON[_0x38e739(0x18b)](_0x1e6d7f[_0x38e739(0x1dd)]);}catch(_0x4c7018){_0x15873a[_0x38e739(0x217)]=[];}await updateBaselineStatus(_0x15873a);}async function saveDailyDigests(_0x41f9a9,_0x260550=!![]){const _0x15a22b=a0_0x32032f,_0x4a40cf=_0x41f9a9['config'][_0x15a22b(0x162)]||0x3c;_0x41f9a9[_0x15a22b(0x217)][_0x15a22b(0x22c)]>_0x4a40cf&&_0x41f9a9[_0x15a22b(0x217)]['splice'](0x0,_0x41f9a9[_0x15a22b(0x217)]['length']-_0x4a40cf);await _0x41f9a9[_0x15a22b(0x181)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x15a22b(0x20f)](_0x41f9a9[_0x15a22b(0x217)]),'ack':!![]});if(_0x260550)await updateBaselineStatus(_0x41f9a9);}async function updateAnalysisHistory(_0xbd223d,_0x24e53c){const _0x16309d=a0_0x32032f;_0xbd223d['analysisHistory'][_0x16309d(0x2bc)](_0x24e53c);if(_0xbd223d['analysisHistory']['length']>ANALYSIS_HISTORY_MAX_SIZE)_0xbd223d[_0x16309d(0x277)][_0x16309d(0x144)]();await _0xbd223d[_0x16309d(0x181)](_0x16309d(0x1b5),{'val':JSON[_0x16309d(0x20f)](_0xbd223d[_0x16309d(0x277)]),'ack':!![]});}async function updateBaselineStatus(_0x360956){const _0x1099c6=a0_0x32032f;if(!_0x360956['isProVersion']){await _0x360956[_0x1099c6(0x181)](LTM_DP_BASELINE_STATUS,{'val':_0x1099c6(0x165),'ack':!![]});return;}const _0x313916=_0x360956['dailyDigests'][_0x1099c6(0x22c)]>=(_0x360956['config']['minDaysForBaseline']||0x7)?'Aktiv\x20('+_0x360956['dailyDigests'][_0x1099c6(0x22c)]+_0x1099c6(0x177):_0x1099c6(0x203)+_0x360956[_0x1099c6(0x217)]['length']+'/'+(_0x360956['config']['minDaysForBaseline']||0x7)+')';await _0x360956[_0x1099c6(0x181)](LTM_DP_BASELINE_STATUS,{'val':_0x313916,'ack':!![]});}async function initSensorSubscriptions(_0x9f5918){const _0x1b4407=a0_0x32032f,_0x1c77dd=_0x9f5918[_0x1b4407(0x276)][_0x1b4407(0x1e7)];if(_0x1c77dd&&_0x1c77dd[_0x1b4407(0x22c)]>0x0){_0x9f5918['log'][_0x1b4407(0x1e4)](_0x1b4407(0x2a5)+_0x1c77dd['length']+_0x1b4407(0x244));for(const _0x30c08c of _0x1c77dd){if(_0x30c08c['id']){await _0x9f5918[_0x1b4407(0x1ed)](_0x30c08c['id']);try{const _0x326580=await _0x9f5918[_0x1b4407(0x26d)](_0x30c08c['id']);if(_0x326580)_0x9f5918[_0x1b4407(0x21e)][_0x30c08c['id']]=_0x326580['val'];}catch(_0x426321){}}}}}async function initPresenceSubscriptions(_0x506049){const _0x22dba2=a0_0x32032f,_0x54958b=_0x506049[_0x22dba2(0x276)][_0x22dba2(0x19f)]||[];if(_0x54958b[_0x22dba2(0x22c)]>0x0){_0x506049[_0x22dba2(0x184)][_0x22dba2(0x1e4)](_0x22dba2(0x2a5)+_0x54958b[_0x22dba2(0x22c)]+_0x22dba2(0x1b8));for(const _0x3b41c6 of _0x54958b){await _0x506049[_0x22dba2(0x1ed)](_0x3b41c6);}try{await checkWifiPresence(_0x506049);}catch(_0x148ddc){}}}async function getWeatherContext(_0xb31d98){const _0x46c5e5=a0_0x32032f;try{if(!_0xb31d98[_0x46c5e5(0x276)][_0x46c5e5(0x204)])return _0x46c5e5(0x256);let _0x3039e0='';const _0x313f2e=_0xb31d98[_0x46c5e5(0x276)][_0x46c5e5(0x174)];if(_0x313f2e)try{if(_0x313f2e[_0x46c5e5(0x1fe)](_0x46c5e5(0x1c2))){const _0x2a3d5d=await _0xb31d98[_0x46c5e5(0x26d)](_0x313f2e+_0x46c5e5(0x258));if(_0x2a3d5d&&_0x2a3d5d[_0x46c5e5(0x1dd)])_0x3039e0=_0x2a3d5d['val'];}else{if(_0x313f2e['includes'](_0x46c5e5(0x164))){const _0x57ce1e=await _0xb31d98[_0x46c5e5(0x26d)](_0x313f2e+_0x46c5e5(0x2a2));if(_0x57ce1e&&_0x57ce1e['val'])_0x3039e0=_0x57ce1e[_0x46c5e5(0x1dd)];}else{if(_0x313f2e[_0x46c5e5(0x1fe)](_0x46c5e5(0x27f))){const _0x4a6b71=await _0xb31d98[_0x46c5e5(0x26d)](_0x313f2e+'.forecast.current.state');if(_0x4a6b71&&_0x4a6b71['val'])_0x3039e0=_0x4a6b71[_0x46c5e5(0x1dd)];}}}}catch(_0x27e43e){}if(!_0x3039e0){const _0x2640ee=[_0x46c5e5(0x154),_0x46c5e5(0x2a4),'weatherunderground.0',_0x46c5e5(0x17b)];for(const _0x1c4e4c of _0x2640ee){try{const _0x24fb5b=await _0xb31d98[_0x46c5e5(0x228)](_0x1c4e4c);if(_0x24fb5b){if(_0x1c4e4c[_0x46c5e5(0x1fe)](_0x46c5e5(0x1c2))){const _0x2b07a5=await _0xb31d98[_0x46c5e5(0x26d)](_0x1c4e4c+'.Summary.Current');if(_0x2b07a5&&_0x2b07a5[_0x46c5e5(0x1dd)]){_0x3039e0=_0x2b07a5['val'];break;}}}}catch(_0x16ca08){}}}return _0x3039e0?_0x46c5e5(0x166)+_0x3039e0:_0x46c5e5(0x1a8);}catch(_0x534df4){return'WETTER\x20ERROR:\x20'+_0x534df4['message'];}}async function getCalendarContext(_0x50c21c){const _0x505715=a0_0x32032f;try{if(!_0x50c21c[_0x505715(0x276)]['useCalendar'])return _0x505715(0x1d3);let _0x2671ec=_0x50c21c[_0x505715(0x276)][_0x505715(0x24a)]||'ical.0',_0x4d9a16=_0x50c21c[_0x505715(0x276)][_0x505715(0x26b)]||[];if(typeof _0x4d9a16==='string')_0x4d9a16=_0x4d9a16[_0x505715(0x1cf)](',');try{const _0x2254bc=await _0x50c21c[_0x505715(0x26d)](_0x2671ec+'.data.table');if(_0x2254bc&&_0x2254bc[_0x505715(0x1dd)]){let _0x12325f=tryParse(_0x2254bc[_0x505715(0x1dd)]);if(_0x12325f&&Array[_0x505715(0x1ff)](_0x12325f)){if(_0x4d9a16[_0x505715(0x22c)]>0x0)_0x12325f=_0x12325f[_0x505715(0x252)](_0x4bfff0=>_0x4d9a16['includes'](_0x4bfff0[_0x505715(0x26e)]||''));else return _0x505715(0x27a);if(_0x12325f[_0x505715(0x22c)]>0x0){const _0x156249=_0x12325f[_0x505715(0x1b3)](0x0,0x3)['map'](_0x3af646=>{const _0x26e438=_0x505715;let _0x365036=_0x3af646[_0x26e438(0x176)];if(_0x3af646[_0x26e438(0x19a)])_0x365036+='\x20'+_0x3af646['time'];return _0x365036+':\x20'+_0x3af646['event']+'\x20('+_0x3af646[_0x26e438(0x26e)]+')';});return'KALENDER:\x20'+_0x156249[_0x505715(0x138)](_0x505715(0x235));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x38cf5c){_0x50c21c[_0x505715(0x184)][_0x505715(0x23b)](_0x505715(0x1c0)+_0x38cf5c[_0x505715(0x150)]);}return _0x505715(0x22e);}catch(_0xf021b4){return _0x505715(0x1b7)+_0xf021b4[_0x505715(0x150)];}}async function getCalendarNames(_0x1c94f8,_0x497e1c){const _0x5a3af7=a0_0x32032f;try{const _0x525183=await _0x1c94f8[_0x5a3af7(0x26d)](_0x497e1c+_0x5a3af7(0x21b));if(_0x525183&&_0x525183[_0x5a3af7(0x1dd)]){const _0x17d220=tryParse(_0x525183['val']);if(_0x17d220&&Array[_0x5a3af7(0x1ff)](_0x17d220)){const _0x27f5c0=[...new Set(_0x17d220[_0x5a3af7(0x2ac)](_0x453c46=>_0x453c46[_0x5a3af7(0x26e)])[_0x5a3af7(0x252)](Boolean))];return _0x27f5c0[_0x5a3af7(0x1a3)]();}}return[];}catch(_0x2198f2){return _0x1c94f8[_0x5a3af7(0x184)][_0x5a3af7(0x18c)](_0x5a3af7(0x250)+_0x2198f2[_0x5a3af7(0x150)]),[];}}async function checkWifiPresence(_0x4cabad){const _0x39468f=a0_0x32032f;try{const _0x4fe470=_0x4cabad['config'][_0x39468f(0x19f)]||[];let _0x36d106=![];const _0x280fa4=[];for(const _0x1b1c9d of _0x4fe470){try{const _0x1c24e8=await _0x4cabad[_0x39468f(0x26d)](_0x1b1c9d);if(_0x1c24e8&&(_0x1c24e8[_0x39468f(0x1dd)]===!![]||_0x1c24e8['val']===_0x39468f(0x142)||_0x1c24e8['val']===0x1)){_0x36d106=!![];const _0x53d4d7=await _0x4cabad['getForeignObjectAsync'](_0x1b1c9d);let _0xb785ea=_0x1b1c9d;_0x53d4d7&&_0x53d4d7[_0x39468f(0x15a)]&&_0x53d4d7[_0x39468f(0x15a)]['name']&&(_0xb785ea=typeof _0x53d4d7[_0x39468f(0x15a)][_0x39468f(0x132)]===_0x39468f(0x249)?_0x53d4d7[_0x39468f(0x15a)]['name']['de']||_0x53d4d7[_0x39468f(0x15a)][_0x39468f(0x132)]['en']:_0x53d4d7[_0x39468f(0x15a)][_0x39468f(0x132)]),_0x280fa4[_0x39468f(0x13d)](_0xb785ea);}}catch(_0x3a6715){}}return await _0x4cabad[_0x39468f(0x181)]('system.presenceWho',{'val':_0x280fa4[_0x39468f(0x138)](',\x20'),'ack':!![]}),_0x36d106&&(_0x4cabad[_0x39468f(0x12f)]&&(_0x4cabad['log'][_0x39468f(0x1e4)](_0x39468f(0x1fc)),abortExitTimer(_0x4cabad)),!_0x4cabad[_0x39468f(0x208)]&&_0x4cabad[_0x39468f(0x19d)]===SYSTEM_MODES[_0x39468f(0x1c1)]&&await setPresence(_0x4cabad,!![])),_0x36d106;}catch(_0x3d7b52){return _0x4cabad[_0x39468f(0x184)][_0x39468f(0x18c)](_0x39468f(0x24d)+_0x3d7b52[_0x39468f(0x150)]),![];}}function startExitTimer(_0x4aa1d1){const _0x4cc177=a0_0x32032f;abortExitTimer(_0x4aa1d1),_0x4aa1d1[_0x4cc177(0x182)]=!![],_0x4aa1d1[_0x4cc177(0x232)]=setTimeout(()=>{_0x4aa1d1['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4aa1d1['exitTimer']=setTimeout(()=>{const _0x13f4fc=_0x4cc177;setPresence(_0x4aa1d1,![]),_0x4aa1d1[_0x13f4fc(0x12f)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x5d3c4a){const _0xba49c3=a0_0x32032f;if(_0x5d3c4a[_0xba49c3(0x12f)])clearTimeout(_0x5d3c4a[_0xba49c3(0x12f)]);if(_0x5d3c4a[_0xba49c3(0x232)])clearTimeout(_0x5d3c4a['exitGraceTimer']);_0x5d3c4a['exitTimer']=null,_0x5d3c4a[_0xba49c3(0x232)]=null,_0x5d3c4a[_0xba49c3(0x182)]=![];}async function setPresence(_0x47b734,_0x483d0c){const _0x26cb8c=a0_0x32032f;if(_0x47b734[_0x26cb8c(0x208)]===_0x483d0c)return;_0x47b734[_0x26cb8c(0x208)]=_0x483d0c,await _0x47b734[_0x26cb8c(0x181)](_0x26cb8c(0x245),{'val':_0x483d0c,'ack':!![]});}async function saveFeedback(_0x48fd05,_0x5e40d9){const _0x7e1324=a0_0x32032f;_0x48fd05['log'][_0x7e1324(0x1e4)](_0x7e1324(0x1d6)+JSON['stringify'](_0x5e40d9));}async function runBaselineDriftAnalysis(_0x4c0ce6){const _0x2ea5fd=a0_0x32032f;if(!_0x4c0ce6[_0x2ea5fd(0x251)]||!_0x4c0ce6[_0x2ea5fd(0x279)])return;const _0x1905af=_0x4c0ce6[_0x2ea5fd(0x276)]['ltmStbWindowDays']||0xe;if(_0x4c0ce6['dailyDigests']['length']<_0x1905af+(_0x4c0ce6[_0x2ea5fd(0x276)]['minDaysForBaseline']||0x7)){await _0x4c0ce6['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x53d92e=_0x4c0ce6[_0x2ea5fd(0x217)][_0x2ea5fd(0x1b3)](-_0x1905af),_0x3c38f7=_0x4c0ce6['dailyDigests'][_0x2ea5fd(0x1b3)](0x0,_0x4c0ce6['dailyDigests'][_0x2ea5fd(0x22c)]-_0x1905af),_0x3a04b1=_0x2ea5fd(0x23a)+JSON[_0x2ea5fd(0x20f)](_0x3c38f7)+'\x0aSTB:\x20'+JSON[_0x2ea5fd(0x20f)](_0x53d92e);try{const _0x3cc25a=await _0x4c0ce6['geminiModel'][_0x2ea5fd(0x278)](_0x3a04b1),_0xdeb03b=JSON[_0x2ea5fd(0x18b)](_0x3cc25a[_0x2ea5fd(0x178)][_0x2ea5fd(0x196)]()[_0x2ea5fd(0x21c)](/```json|```/g,'')[_0x2ea5fd(0x1ab)]());_0xdeb03b[_0x2ea5fd(0x1e8)]&&(await _0x4c0ce6[_0x2ea5fd(0x181)](LTM_DP_DRIFT_STATUS,{'val':_0xdeb03b[_0x2ea5fd(0x1e8)],'ack':!![]}),await _0x4c0ce6['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0xdeb03b[_0x2ea5fd(0x1a5)],'ack':!![]}),await _0x4c0ce6['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x2ea5fd(0x223)](),'ack':!![]}));}catch(_0x33a5b6){}}function setupLtmScheduler(_0x11c4a7){const _0x2d3af9=a0_0x32032f;try{if(_0x11c4a7[_0x2d3af9(0x171)])_0x11c4a7['ltmJob'][_0x2d3af9(0x136)]();if(!_0x11c4a7[_0x2d3af9(0x251)]){_0x11c4a7[_0x2d3af9(0x181)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x11c4a7['ltmJob']=schedule[_0x2d3af9(0x2af)](LTM_SCHEDULE,()=>createDailyDigest(_0x11c4a7));}catch(_0x44beb7){_0x11c4a7[_0x2d3af9(0x184)][_0x2d3af9(0x18c)]('LTM\x20Sched\x20Error:\x20'+_0x44beb7['message']);}}function setupModeResetScheduler(_0x46754d){const _0x5de399=a0_0x32032f;try{if(_0x46754d[_0x5de399(0x13a)])_0x46754d['modeResetJob'][_0x5de399(0x136)]();_0x46754d[_0x5de399(0x13a)]=schedule[_0x5de399(0x2af)](MODE_RESET_SCHEDULE,async()=>{const _0x593dc5=_0x5de399;await loadSystemMode(_0x46754d),AUTO_RESET_MODES[_0x593dc5(0x1fe)](_0x46754d[_0x593dc5(0x19d)])&&await _0x46754d[_0x593dc5(0x181)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x593dc5(0x1c1)],'ack':![]});});}catch(_0x1efb88){_0x46754d[_0x5de399(0x184)][_0x5de399(0x18c)]('Reset\x20Sched\x20Error:\x20'+_0x1efb88[_0x5de399(0x150)]);}}function a0_0x4f8e(_0x4b7eaf,_0x34a5f4){const _0x7b1406=a0_0x334d();return a0_0x4f8e=function(_0x57386c,_0x3d36e2){_0x57386c=_0x57386c-0x12f;let _0x334d20=_0x7b1406[_0x57386c];return _0x334d20;},a0_0x4f8e(_0x4b7eaf,_0x34a5f4);}function setupDriftAnalysisScheduler(_0x37c49b){const _0x172fb0=a0_0x32032f;try{if(_0x37c49b[_0x172fb0(0x20c)])clearInterval(_0x37c49b[_0x172fb0(0x20c)]);if(!_0x37c49b['isProVersion'])return;_0x37c49b[_0x172fb0(0x20c)]=setInterval(()=>runBaselineDriftAnalysis(_0x37c49b),(_0x37c49b[_0x172fb0(0x276)][_0x172fb0(0x1a4)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x37c49b),0x1388);}catch(_0x5002eb){_0x37c49b[_0x172fb0(0x184)][_0x172fb0(0x18c)](_0x172fb0(0x27d)+_0x5002eb[_0x172fb0(0x150)]);}}function setupBriefingScheduler(_0x13aca9){const _0x199a00=a0_0x32032f;try{if(_0x13aca9[_0x199a00(0x29b)])_0x13aca9[_0x199a00(0x29b)]['cancel']();if(!_0x13aca9[_0x199a00(0x276)][_0x199a00(0x2b1)])return;const _0x50a3d3=(_0x13aca9[_0x199a00(0x276)][_0x199a00(0x135)]||_0x199a00(0x205))['split'](':'),_0x910583=parseInt(_0x50a3d3[0x0])||0x8,_0x1e28fb=parseInt(_0x50a3d3[0x1])||0x0,_0x26c6a5=_0x1e28fb+'\x20'+_0x910583+'\x20*\x20*\x20*';_0x13aca9['log']['info'](_0x199a00(0x24b)+_0x910583+':'+(_0x1e28fb<0xa?'0'+_0x1e28fb:_0x1e28fb)),_0x13aca9[_0x199a00(0x29b)]=schedule[_0x199a00(0x2af)](_0x26c6a5,()=>{sendMorningBriefing(_0x13aca9);});}catch(_0x350b13){_0x13aca9[_0x199a00(0x184)]['error'](_0x199a00(0x13e)+_0x350b13[_0x199a00(0x150)]);}}async function sendNotification(_0x3caf88,_0x561527,_0x3c4ac5=![],_0x24157f=![]){const _0x4cd088=a0_0x32032f;_0x3caf88['log'][_0x4cd088(0x1e4)]((_0x3c4ac5?_0x4cd088(0x137):'')+'Sending\x20notification:\x20\x22'+_0x561527+'\x22');const _0x5efd38=_0x3caf88[_0x4cd088(0x276)];let _0x401aa9=0x0;if(_0x5efd38[_0x4cd088(0x1a7)]){let _0xdf7771={};(_0x561527[_0x4cd088(0x1fe)]('Alarm')||_0x24157f)&&(_0xdf7771={'reply_markup':{'inline_keyboard':[[{'text':_0x4cd088(0x17e),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x4cd088(0x159),'callback_data':_0x4cd088(0x1c4)}]]}}),await _0x3caf88[_0x4cd088(0x1f7)](_0x5efd38['notifyTelegramInstance'],'send',{'text':_0x561527,'user':_0x5efd38[_0x4cd088(0x297)],..._0xdf7771}),_0x401aa9++;}if(_0x5efd38['notifyPushoverEnabled']){let _0x4fe1cd={'message':_0x561527,'title':_0x24157f?_0x4cd088(0x2be):'Cogni-Living','priority':_0x24157f?0x2:0x1,'device':_0x5efd38[_0x4cd088(0x234)]};_0x24157f&&(_0x4fe1cd[_0x4cd088(0x1b0)]=0x1e,_0x4fe1cd[_0x4cd088(0x2a8)]=0xe10,_0x4fe1cd[_0x4cd088(0x1ee)]=_0x4cd088(0x1f0)),await _0x3caf88[_0x4cd088(0x1f7)](_0x5efd38[_0x4cd088(0x2a6)],_0x4cd088(0x28f),_0x4fe1cd),_0x401aa9++;}return _0x5efd38[_0x4cd088(0x1ef)]&&(await _0x3caf88[_0x4cd088(0x1f7)](_0x5efd38[_0x4cd088(0x16c)],_0x4cd088(0x28f),{'text':_0x561527,'to':_0x5efd38[_0x4cd088(0x1c6)]}),_0x401aa9++),_0x401aa9;}async function setupTelegramListener(_0x3d6db1){const _0x3d8a5a=a0_0x32032f,_0x2542e1=_0x3d6db1[_0x3d8a5a(0x276)][_0x3d8a5a(0x253)];_0x3d6db1['config'][_0x3d8a5a(0x1a7)]&&_0x2542e1&&(_0x3d6db1['log'][_0x3d8a5a(0x1e4)](_0x3d8a5a(0x16f)+_0x2542e1+_0x3d8a5a(0x1e2)),await _0x3d6db1[_0x3d8a5a(0x1ed)](_0x2542e1+'.communicate.request'));}async function handleTelegramResponse(_0x12e878,_0x14d39f){const _0x5b20bc=a0_0x32032f;let _0x109109=_0x14d39f;_0x14d39f[_0x5b20bc(0x1e1)]('[')&&(_0x109109=_0x14d39f[_0x5b20bc(0x19c)](_0x14d39f[_0x5b20bc(0x15d)](']')+0x1));if(_0x109109===_0x5b20bc(0x1aa))_0x12e878['log']['info'](_0x5b20bc(0x218)),await _0x12e878[_0x5b20bc(0x181)](_0x5b20bc(0x2a9),{'val':![],'ack':!![]}),await _0x12e878['setStateAsync'](_0x5b20bc(0x1b1),{'val':'Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ack':!![]}),_0x12e878[_0x5b20bc(0x1de)]=![],sendNotification(_0x12e878,_0x5b20bc(0x274),![]);else _0x109109===_0x5b20bc(0x1c4)&&(_0x12e878['log'][_0x5b20bc(0x23b)](_0x5b20bc(0x2a1)),sendNotification(_0x12e878,_0x5b20bc(0x222),![],!![]));}async function runAutopilot(_0x22c8de){const _0x403b4f=a0_0x32032f,_0x3f47b2=_0x22c8de[_0x403b4f(0x276)][_0x403b4f(0x19e)],_0x17c30f=_0x22c8de['eventHistory'][_0x403b4f(0x22c)]>0x0?_0x22c8de[_0x403b4f(0x16a)][0x0][_0x403b4f(0x268)]:Date[_0x403b4f(0x223)](),_0x538aeb=(Date['now']()-_0x17c30f)/(0x3e8*0x3c*0x3c);let _0x3af0e9='';_0x22c8de[_0x403b4f(0x276)][_0x403b4f(0x207)]&&_0x22c8de[_0x403b4f(0x19d)]===SYSTEM_MODES['NORMAL']&&_0x22c8de[_0x403b4f(0x208)]&&(_0x538aeb>_0x3f47b2&&(_0x3af0e9=_0x403b4f(0x224)+_0x538aeb[_0x403b4f(0x295)](0x1)+_0x403b4f(0x16b))),runGeminiAnalysis(_0x22c8de,_0x3af0e9)['catch'](_0x1ad640=>_0x22c8de[_0x403b4f(0x184)]['error'](_0x1ad640));}async function createDailyDigest(_0x4bad9e){const _0x314489=a0_0x32032f;if(!_0x4bad9e['isProVersion'])return;await _0x4bad9e[_0x314489(0x181)](LTM_DP_STATUS,{'val':_0x314489(0x2bb)+new Date()[_0x314489(0x13b)](),'ack':!![]});if(!_0x4bad9e[_0x314489(0x279)]||_0x4bad9e['rawEventLog'][_0x314489(0x22c)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4bad9e[_0x314489(0x181)](LTM_DP_STATUS,{'val':_0x314489(0x195),'ack':!![]});return;}const _0x37e9a6=JSON[_0x314489(0x18b)](JSON[_0x314489(0x20f)](_0x4bad9e[_0x314489(0x160)])),_0x1b4add=_0x37e9a6[_0x314489(0x22c)],_0x2eaab8='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x314489(0x20f)](_0x37e9a6);try{const _0x5d5c53=await _0x4bad9e[_0x314489(0x279)][_0x314489(0x278)](_0x2eaab8),_0x43132a=JSON[_0x314489(0x18b)](_0x5d5c53[_0x314489(0x178)][_0x314489(0x196)]()[_0x314489(0x21c)](/```json|```/g,'')[_0x314489(0x1ab)]());_0x43132a['summary']&&(_0x4bad9e['dailyDigests'][_0x314489(0x13d)]({'timestamp':new Date()[_0x314489(0x1fd)](),'eventCount':_0x1b4add,'summary':_0x43132a[_0x314489(0x200)],'activityLevel':_0x43132a[_0x314489(0x1a1)],'systemMode':_0x4bad9e['currentSystemMode']}),await saveDailyDigests(_0x4bad9e),_0x4bad9e[_0x314489(0x160)]=[],await saveRawEventLog(_0x4bad9e),await _0x4bad9e[_0x314489(0x181)](LTM_DP_STATUS,{'val':_0x314489(0x13f)+_0x1b4add+_0x314489(0x236),'ack':!![]}));}catch(_0x420bb1){await _0x4bad9e[_0x314489(0x181)](LTM_DP_STATUS,{'val':_0x314489(0x1f1)+_0x420bb1[_0x314489(0x150)],'ack':!![]});}}async function sendMorningBriefing(_0x1a555d){const _0x240f73=a0_0x32032f;if(!_0x1a555d['geminiModel'])return;_0x1a555d['log'][_0x240f73(0x1e4)]('Generating\x20Morning\x20Briefing...');const _0x5547c6=_0x1a555d['dailyDigests']['length']>0x0?_0x1a555d[_0x240f73(0x217)][_0x1a555d['dailyDigests'][_0x240f73(0x22c)]-0x1]:null,_0x442b5d=_0x5547c6&&_0x5547c6[_0x240f73(0x269)]?_0x5547c6['health'][_0x240f73(0x18d)]:'N/A',_0x11996b=new Date();_0x11996b[_0x240f73(0x1f4)](0x4,0x0,0x0,0x0);const _0x229625=_0x1a555d['eventHistory'][_0x240f73(0x252)](_0x4bdba8=>new Date(_0x4bdba8[_0x240f73(0x268)])>_0x11996b),_0x160cb0=PERSONA_MAPPING[_0x1a555d[_0x240f73(0x276)][_0x240f73(0x220)]||_0x240f73(0x17c)],_0x4474ec=_0x1a555d['config']['livingContext']||'',_0x131879=await getWeatherContext(_0x1a555d),_0x3aecde=await getCalendarContext(_0x1a555d),_0x33f323=_0x240f73(0x24c)+_0x160cb0+_0x240f73(0x192)+_0x4474ec+'.\x20ZUSATZ:\x20'+_0x131879+'\x20'+_0x3aecde+_0x240f73(0x133)+_0x442b5d+_0x240f73(0x155)+JSON[_0x240f73(0x20f)](_0x229625[_0x240f73(0x1b3)](0x0,0xa))+_0x240f73(0x225);try{const _0x5b5707=await _0x1a555d[_0x240f73(0x279)][_0x240f73(0x278)](_0x33f323),_0x3131b9=_0x240f73(0x2bf)+_0x5b5707[_0x240f73(0x178)][_0x240f73(0x196)]()[_0x240f73(0x1ab)]();sendNotification(_0x1a555d,_0x3131b9),_0x1a555d[_0x240f73(0x184)]['info'](_0x240f73(0x23e));}catch(_0x5c5d79){_0x1a555d[_0x240f73(0x184)]['error'](_0x240f73(0x149)+_0x5c5d79[_0x240f73(0x150)]);}}async function scanForDevices(_0x2c123e,_0x46ff66){const _0x265f65=a0_0x32032f;_0x2c123e[_0x265f65(0x184)]['info']('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x301e5c=[],_0x47e836=await _0x2c123e[_0x265f65(0x1e9)]('*'),_0x3ad4e8=await _0x2c123e[_0x265f65(0x1e9)](_0x265f65(0x212),_0x265f65(0x1b9)),_0x3bcf84=await _0x2c123e[_0x265f65(0x1e9)](_0x265f65(0x262),_0x265f65(0x1b9)),_0x2f9a28={};if(_0x3ad4e8)for(const _0x38c7d4 in _0x3ad4e8){const _0x3b6d78=_0x3ad4e8[_0x38c7d4][_0x265f65(0x15a)][_0x265f65(0x221)]||[];_0x3b6d78[_0x265f65(0x199)](_0x3dcdfc=>{const _0x406fff=_0x265f65;if(!_0x2f9a28[_0x3dcdfc])_0x2f9a28[_0x3dcdfc]=[];_0x2f9a28[_0x3dcdfc][_0x406fff(0x13d)](_0x38c7d4);});}const _0x75eefa={};if(_0x3bcf84)for(const _0x4372f9 in _0x3bcf84){const _0x1ff2d9=_0x3bcf84[_0x4372f9][_0x265f65(0x15a)][_0x265f65(0x221)]||[],_0xedc554=typeof _0x3bcf84[_0x4372f9]['common'][_0x265f65(0x132)]===_0x265f65(0x249)?_0x3bcf84[_0x4372f9][_0x265f65(0x15a)][_0x265f65(0x132)]['de']:_0x3bcf84[_0x4372f9][_0x265f65(0x15a)]['name'];_0x1ff2d9[_0x265f65(0x199)](_0x416f8f=>_0x75eefa[_0x416f8f]=_0xedc554);}const _0x21790d=_0x46ff66['selectedFunctionIds']||[],_0x1c047c=_0x46ff66[_0x265f65(0x17d)]!==![],_0x434214=_0x46ff66[_0x265f65(0x25a)]!==![],_0x101f77=_0x46ff66[_0x265f65(0x213)]!==![],_0x563b40=_0x46ff66[_0x265f65(0x25b)]===!![],_0x5c89bf=_0x46ff66[_0x265f65(0x146)]===!![];for(const _0x2182b8 in _0x47e836){const _0x4b7315=_0x47e836[_0x2182b8];if(_0x4b7315['type']!=='state'||!_0x4b7315['common'])continue;if(ADAPTER_BLACKLIST['some'](_0x17a04b=>_0x2182b8[_0x265f65(0x1e1)](_0x17a04b))&&!_0x5c89bf)continue;const _0x329901=(_0x4b7315[_0x265f65(0x15a)]['role']||'')['toLowerCase']();let _0x26094e=(typeof _0x4b7315[_0x265f65(0x15a)][_0x265f65(0x132)]===_0x265f65(0x249)?_0x4b7315[_0x265f65(0x15a)][_0x265f65(0x132)]['de']:_0x4b7315[_0x265f65(0x15a)][_0x265f65(0x132)])||_0x2182b8;const _0x3fea5b=_0x26094e['toLowerCase']();let _0x4d7728=![],_0x50904f=![];if(_0x21790d[_0x265f65(0x22c)]>0x0){const _0x2ee70a=_0x2f9a28[_0x2182b8]||[],_0x37b1db=_0x2182b8[_0x265f65(0x1cf)]('.')[_0x265f65(0x1b3)](0x0,-0x1)['join']('.'),_0x59bfc5=_0x2f9a28[_0x37b1db]||[];(_0x2ee70a[_0x265f65(0x241)](_0x1f2ef2=>_0x21790d[_0x265f65(0x1fe)](_0x1f2ef2))||_0x59bfc5[_0x265f65(0x241)](_0x3b602c=>_0x21790d[_0x265f65(0x1fe)](_0x3b602c)))&&(_0x4d7728=!![],_0x50904f=!![]);}if(!_0x4d7728&&!_0x5c89bf){if(HARD_IGNORE_TERMS[_0x265f65(0x241)](_0x563122=>_0x2182b8[_0x265f65(0x1fe)](_0x563122)||_0x3fea5b['includes'](_0x563122[_0x265f65(0x247)]())))continue;}if(BAD_NAMES[_0x265f65(0x241)](_0x57b0b4=>_0x3fea5b===_0x57b0b4||_0x3fea5b[_0x265f65(0x292)]('.'+_0x57b0b4))){const _0x2417ce=_0x2182b8['split']('.');if(_0x2417ce['length']>0x2){const _0x140748=_0x2417ce[_0x265f65(0x1b3)](0x0,-0x1)[_0x265f65(0x138)]('.'),_0xe37c=_0x47e836[_0x140748];if(_0xe37c&&_0xe37c['common']&&_0xe37c['common']['name']){const _0x2ccb82=typeof _0xe37c['common'][_0x265f65(0x132)]===_0x265f65(0x249)?_0xe37c['common']['name']['de']:_0xe37c[_0x265f65(0x15a)][_0x265f65(0x132)];_0x2ccb82&&!_0x26094e[_0x265f65(0x1fe)](_0x2ccb82)&&(_0x26094e=_0x2ccb82+'\x20'+_0x26094e);}}}let _0x167929='';if(_0x1c047c&&(_0x329901['includes'](_0x265f65(0x17d))||_0x329901['includes'](_0x265f65(0x1df))||_0x3fea5b[_0x265f65(0x1fe)]('bewegung')||_0x3fea5b['includes'](_0x265f65(0x130))))_0x167929=_0x265f65(0x17d);else{if(!_0x167929&&_0x434214&&(_0x329901[_0x265f65(0x1fe)](_0x265f65(0x2c3))||_0x329901[_0x265f65(0x1fe)]('window')||_0x329901[_0x265f65(0x1fe)](_0x265f65(0x281))||_0x329901[_0x265f65(0x1fe)](_0x265f65(0x143))||_0x329901[_0x265f65(0x1fe)]('shutter')||_0x3fea5b[_0x265f65(0x1fe)](_0x265f65(0x197))||_0x3fea5b[_0x265f65(0x1fe)](_0x265f65(0x1f3))||_0x3fea5b['includes'](_0x265f65(0x288))))_0x167929='door';else{if(!_0x167929&&_0x101f77&&(_0x329901[_0x265f65(0x1fe)](_0x265f65(0x29c))||_0x329901[_0x265f65(0x1fe)](_0x265f65(0x273))||_0x329901[_0x265f65(0x1fe)]('dimmer')||_0x3fea5b[_0x265f65(0x1fe)](_0x265f65(0x18a))||_0x3fea5b[_0x265f65(0x1fe)]('lampe')||_0x3fea5b[_0x265f65(0x1fe)]('schalter'))){if(_0x4b7315[_0x265f65(0x15a)]['write']||_0x329901['includes']('sensor'))_0x167929='light';}else{if(!_0x167929&&_0x563b40&&(_0x329901['includes'](_0x265f65(0x25b))||_0x329901['includes']('humidity')||_0x329901[_0x265f65(0x1fe)](_0x265f65(0x1d9))||_0x3fea5b['includes']('temp')||_0x3fea5b[_0x265f65(0x1fe)](_0x265f65(0x2ae))||_0x3fea5b[_0x265f65(0x1fe)](_0x265f65(0x255))))_0x167929='temperature';else{if(!_0x167929&&_0x50904f)_0x167929=_0x265f65(0x2ab);}}}}if(_0x167929){let _0x262c30=_0x75eefa[_0x2182b8]||'';if(!_0x262c30){let _0x104b5e=_0x2182b8;for(let _0x22a5df=0x0;_0x22a5df<0x3;_0x22a5df++){const _0x5e30ca=_0x104b5e[_0x265f65(0x215)]('.');if(_0x5e30ca===-0x1)break;_0x104b5e=_0x104b5e[_0x265f65(0x19c)](0x0,_0x5e30ca);if(_0x75eefa[_0x104b5e]){_0x262c30=_0x75eefa[_0x104b5e];break;}}}_0x301e5c[_0x265f65(0x13d)]({'id':_0x2182b8,'name':_0x26094e,'location':_0x262c30,'type':_0x167929,'logDuplicates':_0x167929===_0x265f65(0x17d),'isExit':![],'_score':_0x262c30?0x50:_0x167929===_0x265f65(0x2ab)?0x5a:0x28});}}return _0x301e5c['sort']((_0x28dc28,_0x2ba06e)=>_0x2ba06e[_0x265f65(0x17a)]-_0x28dc28['_score']),_0x301e5c;}async function executeAutomationAction(_0x3d6593){const _0x1e0206=a0_0x32032f;try{const _0xbdff2b=await _0x3d6593['getStateAsync'](_0x1e0206(0x28e)),_0x3f7bfc=await _0x3d6593['getStateAsync']('analysis.automation.targetValue');if(_0xbdff2b&&_0xbdff2b[_0x1e0206(0x1dd)]&&_0x3f7bfc){const _0x14390d=_0xbdff2b['val'];let _0x471b63=_0x3f7bfc[_0x1e0206(0x1dd)];try{_0x471b63=JSON[_0x1e0206(0x18b)](_0x471b63);}catch(_0x596a76){}_0x3d6593['log'][_0x1e0206(0x1e4)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x14390d+'\x20=\x20'+_0x471b63),await _0x3d6593[_0x1e0206(0x275)](_0x14390d,_0x471b63);}else _0x3d6593[_0x1e0206(0x184)][_0x1e0206(0x23b)](_0x1e0206(0x167));}catch(_0x4f5ba2){_0x3d6593[_0x1e0206(0x184)][_0x1e0206(0x18c)]('BUTLER\x20Execution\x20Error:\x20'+_0x4f5ba2['message']);}}class CogniLiving extends utils['Adapter']{constructor(_0x462a6d){const _0x127e06=a0_0x32032f;super({..._0x462a6d,'name':_0x127e06(0x145)}),this[_0x127e06(0x16a)]=[],this[_0x127e06(0x277)]=[],this[_0x127e06(0x2c1)]=[],this[_0x127e06(0x160)]=[],this[_0x127e06(0x217)]=[],this[_0x127e06(0x21e)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x127e06(0x208)]=!![],this[_0x127e06(0x12f)]=null,this[_0x127e06(0x232)]=null,this[_0x127e06(0x182)]=![],this[_0x127e06(0x139)]=null,this[_0x127e06(0x279)]=null,this[_0x127e06(0x19d)]=SYSTEM_MODES[_0x127e06(0x1c1)],this[_0x127e06(0x251)]=![],this[_0x127e06(0x1de)]=![],this['systemUUID']='unknown',this[_0x127e06(0x1cb)]=null,this[_0x127e06(0x171)]=null,this[_0x127e06(0x13a)]=null,this['driftAnalysisTimer']=null,this[_0x127e06(0x29b)]=null,this['on'](_0x127e06(0x2c0),this[_0x127e06(0x271)]['bind'](this)),this['on'](_0x127e06(0x1ba),this[_0x127e06(0x206)][_0x127e06(0x1da)](this)),this['on']('unload',this[_0x127e06(0x1d4)]['bind'](this)),this['on'](_0x127e06(0x150),this[_0x127e06(0x1bb)][_0x127e06(0x1da)](this));}async[a0_0x32032f(0x271)](){const _0x235b78=a0_0x32032f;this['log'][_0x235b78(0x1e4)](_0x235b78(0x2b4)+this['version']+_0x235b78(0x1c5)),await initZombies(this),this[_0x235b78(0x276)][_0x235b78(0x183)]=this[_0x235b78(0x276)][_0x235b78(0x183)]||'';try{this[_0x235b78(0x251)]=await checkLicense(this,this[_0x235b78(0x276)][_0x235b78(0x183)]);}catch(_0x1eac7d){}if(!this[_0x235b78(0x276)][_0x235b78(0x19e)]||this[_0x235b78(0x276)][_0x235b78(0x19e)]<0.1)this[_0x235b78(0x276)][_0x235b78(0x19e)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x235b78(0x276)][_0x235b78(0x1d0)])try{this[_0x235b78(0x139)]=new GoogleGenerativeAI(this[_0x235b78(0x276)][_0x235b78(0x1d0)]),this[_0x235b78(0x279)]=this[_0x235b78(0x139)][_0x235b78(0x263)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x235b78(0x2bd)}}),this['log']['info'](_0x235b78(0x1dc));}catch(_0x231e0c){this[_0x235b78(0x184)][_0x235b78(0x18c)]('Gemini\x20Init\x20Error:\x20'+_0x231e0c['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x235b78(0x1c7)](_0x235b78(0x141)),this[_0x235b78(0x1c7)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x235b78(0x175)),this[_0x235b78(0x1c7)]('analysis.triggerBriefing'),this['subscribeStates'](_0x235b78(0x248)),this[_0x235b78(0x1c7)]('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x235b78(0x1cb)])clearInterval(this[_0x235b78(0x1cb)]);const _0x1fe8d5=this[_0x235b78(0x276)][_0x235b78(0x185)]||0xf;_0x1fe8d5>0x0&&(this[_0x235b78(0x184)][_0x235b78(0x1e4)](_0x235b78(0x2a3)+_0x1fe8d5+'\x20min).'),this[_0x235b78(0x1cb)]=setInterval(()=>{runAutopilot(this);},_0x1fe8d5*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this);}[a0_0x32032f(0x1d4)](_0x310088){const _0x32d12d=a0_0x32032f;if(this[_0x32d12d(0x1cb)])clearInterval(this[_0x32d12d(0x1cb)]);if(this[_0x32d12d(0x20c)])clearInterval(this[_0x32d12d(0x20c)]);if(this['ltmJob'])this[_0x32d12d(0x171)][_0x32d12d(0x136)]();if(this[_0x32d12d(0x13a)])this[_0x32d12d(0x13a)]['cancel']();if(this['briefingJob'])this[_0x32d12d(0x29b)][_0x32d12d(0x136)]();if(this['exitTimer'])clearTimeout(this[_0x32d12d(0x12f)]);if(this[_0x32d12d(0x232)])clearTimeout(this[_0x32d12d(0x232)]);_0x310088();}async[a0_0x32032f(0x206)](_0x25a033,_0x23dd3f){const _0x43a853=a0_0x32032f;if(!_0x23dd3f)return;if(_0x25a033[_0x43a853(0x1fe)]('telegram')&&_0x25a033[_0x43a853(0x292)](_0x43a853(0x21a))&&_0x23dd3f['val']){await handleTelegramResponse(this,_0x23dd3f[_0x43a853(0x1dd)]);return;}if(_0x25a033===this[_0x43a853(0x169)]+'.'+SYSTEM_DP_MODE){_0x23dd3f[_0x43a853(0x1dd)]&&Object[_0x43a853(0x1ec)](SYSTEM_MODES)[_0x43a853(0x1fe)](_0x23dd3f[_0x43a853(0x1dd)])&&(this['currentSystemMode']=_0x23dd3f[_0x43a853(0x1dd)],_0x23dd3f['val']===SYSTEM_MODES[_0x43a853(0x16d)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x23dd3f[_0x43a853(0x29f)])this['setState'](_0x25a033,{'val':this[_0x43a853(0x19d)],'ack':!![]});return;}if(!_0x23dd3f[_0x43a853(0x29f)]){_0x25a033[_0x43a853(0x1fe)]('analysis.trigger')&&_0x23dd3f['val']&&(this[_0x43a853(0x240)](_0x25a033,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x25a033[_0x43a853(0x1fe)](_0x43a853(0x25f))&&_0x23dd3f[_0x43a853(0x1dd)]){this[_0x43a853(0x240)](_0x25a033,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x25a033[_0x43a853(0x1fe)](_0x43a853(0x1fb))&&_0x23dd3f['val']&&(this[_0x43a853(0x240)](_0x25a033,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x25a033[_0x43a853(0x1fe)](_0x43a853(0x22f))&&_0x23dd3f[_0x43a853(0x1dd)]&&(this[_0x43a853(0x240)](_0x25a033,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x43a853(0x276)][_0x43a853(0x19f)]&&this[_0x43a853(0x276)][_0x43a853(0x19f)]['includes'](_0x25a033)){await checkWifiPresence(this);return;}const _0x351bf6=(this[_0x43a853(0x276)]['devices']||[])[_0x43a853(0x18f)](_0x34b90b=>_0x34b90b['id']===_0x25a033);if(_0x351bf6)processSensorEvent(this,_0x25a033,_0x23dd3f,_0x351bf6);}async[a0_0x32032f(0x1bb)](_0x196884){const _0x514224=a0_0x32032f;if(typeof _0x196884===_0x514224(0x249)&&_0x196884[_0x514224(0x150)])try{if(_0x196884[_0x514224(0x1d1)]==='testApiKey'){}else{if(_0x196884['command']===_0x514224(0x29d)){}else{if(_0x196884[_0x514224(0x1d1)]===_0x514224(0x2b3)){if(!this[_0x514224(0x251)])return this['sendTo'](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':![],'isPro':![]},_0x196884[_0x514224(0x231)]);let _0x485fc4={'status':'N/A','details':'','lastCheck':0x0};try{_0x485fc4['status']=(await this[_0x514224(0x202)](LTM_DP_DRIFT_STATUS))[_0x514224(0x1dd)],_0x485fc4[_0x514224(0x261)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))['val'],_0x485fc4[_0x514224(0x1e0)]=(await this[_0x514224(0x202)](LTM_DP_DRIFT_LAST_CHECK))[_0x514224(0x1dd)];}catch(_0x14b69b){}const _0x26872c=this['analysisHistory']||[];this[_0x514224(0x2ad)](_0x196884['from'],_0x196884[_0x514224(0x1d1)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x514224(0x217)],'driftAnalysis':_0x485fc4,'analysisHistory':_0x26872c},_0x196884['callback']);}else{if(_0x196884[_0x514224(0x1d1)]===_0x514224(0x24f)){const _0x4ca34a=this[_0x514224(0x217)]['length'],_0x649e58=new Date(),_0x51bdba=new Date(_0x649e58['getFullYear'](),_0x649e58[_0x514224(0x1b4)](),_0x649e58['getDate']())[_0x514224(0x282)](),_0x11230d=this['rawEventLog'][_0x514224(0x252)](_0x5ad806=>new Date(_0x5ad806[_0x514224(0x268)])[_0x514224(0x282)]()>_0x51bdba)['length'],_0x44d162=new Array(0x18)[_0x514224(0x16e)](0x0);this[_0x514224(0x160)][_0x514224(0x199)](_0xb7864b=>{const _0x5be45b=_0x514224,_0x425dd0=new Date(_0xb7864b['timestamp']);if(_0x425dd0[_0x5be45b(0x282)]()>_0x51bdba)_0x44d162[_0x425dd0[_0x5be45b(0x298)]()]++;});let _0x163d51={'status':_0x514224(0x1c8)};try{_0x163d51[_0x514224(0x2b6)]=(await this[_0x514224(0x202)](LTM_DP_DRIFT_STATUS))[_0x514224(0x1dd)];}catch(_0xf7a59c){}let _0x211248='';try{const _0x4dfe58=await this[_0x514224(0x202)]('system.presenceWho');_0x211248=_0x4dfe58?_0x4dfe58[_0x514224(0x1dd)]:'';}catch(_0x2ccd9b){}let _0x28f446=null;!this[_0x514224(0x279)]&&(_0x28f446=this['config'][_0x514224(0x1d0)]?_0x514224(0x242):_0x514224(0x20a));let _0x45142d={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x4e3b99=await this[_0x514224(0x202)]('analysis.automation.patternDetected'),_0x1a2040=await this[_0x514224(0x202)](_0x514224(0x29e)),_0x1eb00a=await this['getStateAsync'](_0x514224(0x28e)),_0x9c40e3=await this[_0x514224(0x202)](_0x514224(0x296)),_0x5a38a9=await this[_0x514224(0x202)]('analysis.automation.autoApply');_0x4e3b99&&_0x4e3b99['val']&&(_0x45142d[_0x514224(0x238)]=!![],_0x45142d['description']=_0x1a2040?_0x1a2040[_0x514224(0x1dd)]:'',_0x45142d[_0x514224(0x27e)]=_0x1eb00a?_0x1eb00a['val']:'',_0x45142d[_0x514224(0x25c)]=_0x9c40e3?_0x9c40e3[_0x514224(0x1dd)]:''),_0x45142d[_0x514224(0x21d)]=_0x5a38a9?!!_0x5a38a9[_0x514224(0x1dd)]:![];}catch(_0x3a6402){}this[_0x514224(0x2ad)](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':!![],'eventHistory':this[_0x514224(0x16a)][_0x514224(0x1b3)](0x0,0xf),'stats':{'digestCount':_0x4ca34a,'eventCountToday':_0x11230d,'hourlyActivity':_0x44d162,'driftStatus':_0x163d51[_0x514224(0x2b6)],'isPresent':this['isPresent'],'presenceWho':_0x211248,'minDays':this[_0x514224(0x276)][_0x514224(0x1af)]||0x7,'stbDays':this[_0x514224(0x276)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x514224(0x276)][_0x514224(0x162)]||0x3c,'systemError':_0x28f446},'automation':_0x45142d},_0x196884[_0x514224(0x231)]);}else{if(_0x196884['command']===_0x514224(0x291)){const _0x338145=await this['getForeignObjectsAsync'](_0x514224(0x212),_0x514224(0x1b9)),_0x4e42a6=[];if(_0x338145)for(const _0x39b4ee in _0x338145){const _0x2cda3a=_0x338145[_0x39b4ee],_0x39bf85=(_0x2cda3a[_0x514224(0x15a)]&&typeof _0x2cda3a['common']['name']===_0x514224(0x249)?_0x2cda3a[_0x514224(0x15a)][_0x514224(0x132)]['de']:_0x2cda3a['common']['name'])||_0x2cda3a[_0x514224(0x15a)]['name'];_0x4e42a6['push']({'id':_0x39b4ee,'name':_0x39bf85});}this[_0x514224(0x2ad)](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':!![],'enums':_0x4e42a6},_0x196884[_0x514224(0x231)]);}else{if(_0x196884[_0x514224(0x1d1)]===_0x514224(0x214))try{const _0x96fbb8=await scanForDevices(this,_0x196884[_0x514224(0x150)]||{});this[_0x514224(0x2ad)](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':!![],'devices':_0x96fbb8},_0x196884[_0x514224(0x231)]);}catch(_0x2fc39a){this[_0x514224(0x2ad)](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':![],'error':_0x2fc39a['message']},_0x196884[_0x514224(0x231)]);}else{if(_0x196884['command']===_0x514224(0x163)){const _0x35a7f4=_0x196884[_0x514224(0x150)][_0x514224(0x172)];if(!_0x35a7f4)return this[_0x514224(0x2ad)](_0x196884[_0x514224(0x153)],_0x196884['command'],{'success':![],'error':'No\x20instance'},_0x196884[_0x514224(0x231)]);const _0x251c05=await getCalendarNames(this,_0x35a7f4);this[_0x514224(0x2ad)](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':!![],'names':_0x251c05},_0x196884[_0x514224(0x231)]);}else{if(_0x196884['command']===_0x514224(0x1bf)){const {targetId:_0x92674f,targetValue:_0x59822f}=_0x196884[_0x514224(0x150)];this[_0x514224(0x184)][_0x514224(0x1e4)](_0x514224(0x1d5)+_0x92674f+_0x514224(0x191)+_0x59822f),await this[_0x514224(0x181)](_0x514224(0x17f),{'val':!![],'ack':!![]}),await this[_0x514224(0x181)](_0x514224(0x29e),{'val':'SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20'+_0x92674f,'ack':!![]}),await this[_0x514224(0x181)](_0x514224(0x28e),{'val':_0x92674f,'ack':!![]}),await this[_0x514224(0x181)](_0x514224(0x296),{'val':_0x59822f,'ack':!![]}),this['sendTo'](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':!![]},_0x196884[_0x514224(0x231)]);}else{if(_0x196884[_0x514224(0x1d1)]==='submitFeedback'){const {historyId:_0x37e051,rating:_0x39540a,comment:_0x5f4087,alertReason:_0x3e79b6}=_0x196884[_0x514224(0x150)];_0x37e051&&_0x39540a?(await saveFeedback(this,{'timestamp':Date[_0x514224(0x223)](),'historyId':_0x37e051,'rating':_0x39540a,'comment':_0x5f4087,'alertReason':_0x3e79b6}),this[_0x514224(0x2ad)](_0x196884['from'],_0x196884[_0x514224(0x1d1)],{'success':!![]},_0x196884[_0x514224(0x231)])):this['sendTo'](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':![],'error':_0x514224(0x2b2)},_0x196884[_0x514224(0x231)]);}else _0x196884[_0x514224(0x1d1)]==='dismissAutomation'&&(this[_0x514224(0x184)][_0x514224(0x1e4)](_0x514224(0x267)),await this['setStateAsync'](_0x514224(0x17f),{'val':![],'ack':!![]}),await this[_0x514224(0x181)]('analysis.automation.description',{'val':'','ack':!![]}),this['sendTo'](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':!![]},_0x196884[_0x514224(0x231)]));}}}}}}}}}catch(_0xeb8236){this[_0x514224(0x184)][_0x514224(0x18c)]('Error\x20in\x20onMessage\x20command\x20'+_0x196884[_0x514224(0x1d1)]+':\x20'+_0xeb8236[_0x514224(0x150)]);if(_0x196884[_0x514224(0x231)])this[_0x514224(0x2ad)](_0x196884[_0x514224(0x153)],_0x196884[_0x514224(0x1d1)],{'success':![],'error':_0xeb8236['message']},_0x196884[_0x514224(0x231)]);}}}if(require[a0_0x32032f(0x198)]!==module)module[a0_0x32032f(0x23d)]=_0x28bf98=>new CogniLiving(_0x28bf98);else new CogniLiving();