const a0_0x2ae9cf=a0_0x5a5d;(function(_0x14f62b,_0x507520){const _0x4023eb=a0_0x5a5d,_0x377e01=_0x14f62b();while(!![]){try{const _0x4b9e58=parseInt(_0x4023eb(0xef))/0x1+-parseInt(_0x4023eb(0x102))/0x2*(parseInt(_0x4023eb(0xc7))/0x3)+-parseInt(_0x4023eb(0x193))/0x4*(-parseInt(_0x4023eb(0xab))/0x5)+-parseInt(_0x4023eb(0x1db))/0x6*(parseInt(_0x4023eb(0x168))/0x7)+-parseInt(_0x4023eb(0x18e))/0x8+-parseInt(_0x4023eb(0x125))/0x9+-parseInt(_0x4023eb(0xb8))/0xa*(-parseInt(_0x4023eb(0x114))/0xb);if(_0x4b9e58===_0x507520)break;else _0x377e01['push'](_0x377e01['shift']());}catch(_0x2b36cc){_0x377e01['push'](_0x377e01['shift']());}}}(a0_0x4b5a,0x6661c));const a0_0x11cc26=(function(){let _0x5bf6b0=!![];return function(_0x16fddd,_0xefdfa8){const _0x2a7295=_0x5bf6b0?function(){if(_0xefdfa8){const _0x238d47=_0xefdfa8['apply'](_0x16fddd,arguments);return _0xefdfa8=null,_0x238d47;}}:function(){};return _0x5bf6b0=![],_0x2a7295;};}()),a0_0x3b52cf=a0_0x11cc26(this,function(){const _0x5a1ed7=a0_0x5a5d;return a0_0x3b52cf[_0x5a1ed7(0x200)]()[_0x5a1ed7(0xa5)](_0x5a1ed7(0xd2))[_0x5a1ed7(0x200)]()[_0x5a1ed7(0x1a8)](a0_0x3b52cf)['search'](_0x5a1ed7(0xd2));});a0_0x3b52cf();'use strict';const utils=require(a0_0x2ae9cf(0x18d)),{GoogleGenerativeAI}=require(a0_0x2ae9cf(0x1b0)),{spawn}=require(a0_0x2ae9cf(0x154)),path=require(a0_0x2ae9cf(0x176)),fs=require('fs'),installer=require(a0_0x2ae9cf(0x10d)),scanner=require(a0_0x2ae9cf(0xeb)),schedulers=require(a0_0x2ae9cf(0x13a)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x2ae9cf(0x128),LTM_DP_STATUS=a0_0x2ae9cf(0xf4),LTM_DP_TRIGGER_DIGEST=a0_0x2ae9cf(0x219),LTM_DP_BASELINE_STATUS=a0_0x2ae9cf(0xd4),LTM_DP_DRIFT_CHANNEL=a0_0x2ae9cf(0x1fe),LTM_DP_DRIFT_STATUS=a0_0x2ae9cf(0x10c),LTM_DP_DRIFT_DETAILS=a0_0x2ae9cf(0x1e6),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x2ae9cf(0x19e),SYSTEM_MODES={'NORMAL':a0_0x2ae9cf(0xda),'VACATION':a0_0x2ae9cf(0x214),'PARTY':'party','GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x2ae9cf(0x1d7)],SYSTEM_MODES[a0_0x2ae9cf(0x17f)]],PERSONA_MAPPING={'generic':a0_0x2ae9cf(0x1e5),'senior_aal':a0_0x2ae9cf(0xf9),'family':a0_0x2ae9cf(0x1a3),'single_comfort':a0_0x2ae9cf(0xed),'security':a0_0x2ae9cf(0xa1)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x50b3b6){const _0x1b2ad6=a0_0x2ae9cf;try{const _0x508165=[_0x1b2ad6(0x1af),'events.history_debug_00'];for(const _0xd25c5d of _0x508165){try{const _0x5f4dee=await _0x50b3b6['getObjectAsync'](_0xd25c5d);if(_0x5f4dee)await _0x50b3b6['delObjectAsync'](_0xd25c5d);}catch(_0x2a3fc0){}}}catch(_0x1f12ef){}}async function checkLicense(_0x2ed506){return!![];}async function initHistory(_0x5294c8){const _0x1e9faa=a0_0x2ae9cf;try{const _0x4ebf55=await _0x5294c8[_0x1e9faa(0x1e2)](_0x1e9faa(0xfc));_0x4ebf55&&_0x4ebf55[_0x1e9faa(0x1ea)]&&(_0x5294c8[_0x1e9faa(0x1cd)]=JSON[_0x1e9faa(0xe4)](_0x4ebf55['val'][_0x1e9faa(0x200)]()));}catch(_0x9530fa){_0x5294c8[_0x1e9faa(0x1cd)]=[];}try{const _0xf0534d=await _0x5294c8['getStateAsync']('analysis.analysisHistory');if(_0xf0534d&&_0xf0534d['val'])_0x5294c8[_0x1e9faa(0xc9)]=JSON[_0x1e9faa(0xe4)](_0xf0534d[_0x1e9faa(0x1ea)][_0x1e9faa(0x200)]());}catch(_0x18b09c){_0x5294c8[_0x1e9faa(0xc9)]=[];}if(_0x5294c8['eventHistory']&&_0x5294c8[_0x1e9faa(0x1cd)][_0x1e9faa(0xd0)]>0x0){_0x5294c8[_0x1e9faa(0x105)]['info'](_0x1e9faa(0x164));for(let _0x5a5a80=_0x5294c8[_0x1e9faa(0x1cd)]['length']-0x1;_0x5a5a80>=0x0;_0x5a5a80--){const _0x2630b2=_0x5294c8[_0x1e9faa(0x1cd)][_0x5a5a80];if(_0x2630b2&&_0x2630b2['id']!==undefined&&_0x2630b2[_0x1e9faa(0xdf)]!==undefined)_0x5294c8['sensorLastValues'][_0x2630b2['id']]=_0x2630b2[_0x1e9faa(0xdf)];}}}async function initSystemConfig(_0x20fc1b){const _0x22b711=a0_0x2ae9cf;try{const _0x1fa1c6=await _0x20fc1b[_0x22b711(0x216)](_0x22b711(0x16a));if(_0x1fa1c6&&_0x1fa1c6[_0x22b711(0xa6)])_0x20fc1b[_0x22b711(0x208)]={'latitude':_0x1fa1c6[_0x22b711(0xa6)][_0x22b711(0x124)]||0x0,'longitude':_0x1fa1c6[_0x22b711(0xa6)][_0x22b711(0x222)]||0x0,'city':_0x1fa1c6[_0x22b711(0xa6)][_0x22b711(0xe0)]||''};}catch(_0x34ada7){}}async function createAllObjects(_0x43203c){const _0x284b94=a0_0x2ae9cf;await _0x43203c['extendObjectAsync']('system',{'type':'channel','common':{'name':_0x284b94(0x14c)},'native':{}}),await _0x43203c[_0x284b94(0x135)](SYSTEM_DP_MODE,{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x122),'type':_0x284b94(0x153),'role':_0x284b94(0xc8),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x284b94(0x11b)]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0x21d),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1f7),'type':_0x284b94(0x153),'role':_0x284b94(0x1b6),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x13e),{'type':'state','common':{'name':'Last\x20raw\x20event','type':_0x284b94(0x153),'role':_0x284b94(0xc0),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)]('events.history',{'type':_0x284b94(0xc8),'common':{'name':'Event\x20History','type':_0x284b94(0x153),'role':'json','read':!![],'write':![]},'native':{}}),await _0x43203c['extendObjectAsync'](_0x284b94(0x138),{'type':_0x284b94(0x1cc),'common':{'name':_0x284b94(0x1ac)},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0x113),{'type':'state','common':{'name':_0x284b94(0x15b),'type':'boolean','role':_0x284b94(0x1cf),'read':!![],'write':!![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0x21a),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x18a),'type':_0x284b94(0xe5),'role':_0x284b94(0x1cf),'read':!![],'write':!![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)]('analysis.training.triggerEnergy',{'type':'state','common':{'name':'Train\x20Energy','type':_0x284b94(0xe5),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)]('analysis.training.triggerComfort',{'type':'state','common':{'name':'Train\x20Comfort','type':_0x284b94(0xe5),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0x16d),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x20f),'type':_0x284b94(0xe5),'role':_0x284b94(0x1cf),'read':!![],'write':!![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0x126),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1f8),'type':_0x284b94(0x153),'role':_0x284b94(0x1b6),'read':!![],'write':![]},'native':{}}),await _0x43203c['extendObjectAsync'](_0x284b94(0x1b4),{'type':_0x284b94(0x1cc),'common':{'name':_0x284b94(0x18c)},'native':{}}),await _0x43203c[_0x284b94(0x1c1)]('analysis.security.lastScore',{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x147),'type':_0x284b94(0x143),'role':_0x284b94(0xdf),'read':!![],'write':![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0xd3),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x96),'type':_0x284b94(0x143),'role':'value','read':!![],'write':![],'def':0.05},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x1ae),{'type':'state','common':{'name':_0x284b94(0xc6),'type':'string','role':_0x284b94(0x110),'read':!![],'write':![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync']('analysis.security.topologyMatrix',{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1b2),'type':'string','role':_0x284b94(0xc0),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x135)]('analysis.health',{'type':_0x284b94(0x1cc),'common':{'name':'Health\x20Analysis'},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x19d),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0xc6),'type':_0x284b94(0x153),'role':_0x284b94(0x110),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x15e),{'type':_0x284b94(0xc8),'common':{'name':'Anomaly\x20Detected','type':_0x284b94(0xe5),'role':_0x284b94(0xd9),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x213),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1fa),'type':_0x284b94(0x153),'role':_0x284b94(0x1b6),'read':!![],'write':![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0x1ca),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1e3),'type':_0x284b94(0x143),'role':_0x284b94(0xdf),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x1dc),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0xa4),'type':_0x284b94(0x153),'role':_0x284b94(0xc0),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x20b),{'type':'state','common':{'name':_0x284b94(0xaa),'type':_0x284b94(0x143),'role':_0x284b94(0xdf),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x135)]('analysis.energy',{'type':'channel','common':{'name':_0x284b94(0x169)},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x20d),{'type':'state','common':{'name':_0x284b94(0xfd),'type':_0x284b94(0x153),'role':'text','read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0xde),{'type':_0x284b94(0xc8),'common':{'name':'Heating\x20Score','type':'string','role':_0x284b94(0x1b6),'read':!![],'write':![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0x146),{'type':'state','common':{'name':_0x284b94(0x1c2),'type':'string','role':_0x284b94(0xc0),'read':!![],'write':![]},'native':{}}),await _0x43203c['extendObjectAsync'](_0x284b94(0x12d),{'type':'channel','common':{'name':_0x284b94(0x12d)},'native':{}}),await _0x43203c[_0x284b94(0x135)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x284b94(0x186),'type':'string','role':_0x284b94(0xc0),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x135)](LTM_DP_DAILY_DIGESTS,{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x121),'type':_0x284b94(0x153),'role':_0x284b94(0xc0),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x1e7),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1e8),'type':_0x284b94(0x153),'role':'json','read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)]('LTM.trainingData.thermodynamics',{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x11f),'type':_0x284b94(0x153),'role':'json','read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0xdc),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x104),'type':_0x284b94(0xe5),'role':_0x284b94(0x1cf),'read':!![],'write':!![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x150),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x198),'type':_0x284b94(0xe5),'role':_0x284b94(0x1cf),'read':!![],'write':!![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0xa9),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1ce),'type':'boolean','role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x215),{'type':'state','common':{'name':'Alert\x20Reason','type':_0x284b94(0x153),'role':_0x284b94(0x206),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x130),{'type':_0x284b94(0xc8),'common':{'name':'Activity\x20Summary','type':_0x284b94(0x153),'role':'text','read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x115),{'type':'state','common':{'name':'Pattern\x20Detected','type':_0x284b94(0xe5),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x225),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x11e),'type':_0x284b94(0x153),'role':_0x284b94(0x1b6),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)]('analysis.automation.detectedPatterns',{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1ab),'type':'string','role':_0x284b94(0xc0),'read':!![],'write':![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0x9e),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x1fc),'type':_0x284b94(0x153),'role':_0x284b94(0x1b6),'read':!![],'write':![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync']('analysis.automation.targetValue',{'type':_0x284b94(0xc8),'common':{'name':'Target\x20Value','type':_0x284b94(0x153),'role':_0x284b94(0x1b6),'read':!![],'write':![]},'native':{}}),await _0x43203c[_0x284b94(0x1c1)](_0x284b94(0x1c8),{'type':_0x284b94(0xc8),'common':{'name':_0x284b94(0x162),'type':'boolean','role':_0x284b94(0xf7),'read':!![],'write':!![]},'native':{}}),await _0x43203c['setObjectNotExistsAsync'](_0x284b94(0xa2),{'type':'state','common':{'name':_0x284b94(0x14f),'type':_0x284b94(0xe5),'role':_0x284b94(0x1cf),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x2cba75){const _0x7dfad8=a0_0x2ae9cf;try{const _0x1ac7cd=await _0x2cba75[_0x7dfad8(0x1e2)](SYSTEM_DP_MODE);_0x1ac7cd&&_0x1ac7cd[_0x7dfad8(0x1ea)]&&Object[_0x7dfad8(0x1d1)](SYSTEM_MODES)['includes'](_0x1ac7cd[_0x7dfad8(0x1ea)])?_0x2cba75[_0x7dfad8(0xae)]=_0x1ac7cd[_0x7dfad8(0x1ea)]:(_0x2cba75[_0x7dfad8(0xae)]=SYSTEM_MODES['NORMAL'],await _0x2cba75['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x7dfad8(0x11b)],'ack':!![]}));}catch(_0x5265ed){_0x2cba75['currentSystemMode']=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x16b92d){const _0x4e377d=a0_0x2ae9cf;try{const _0x2b2423=await _0x16b92d['getStateAsync'](LTM_DP_RAW_LOG);if(_0x2b2423&&_0x2b2423[_0x4e377d(0x1ea)])_0x16b92d[_0x4e377d(0x1d4)]=JSON[_0x4e377d(0xe4)](_0x2b2423[_0x4e377d(0x1ea)]);}catch(_0x114df0){_0x16b92d[_0x4e377d(0x1d4)]=[];}}async function saveRawEventLog(_0x17c20){const _0x1e5f13=a0_0x2ae9cf;if(_0x17c20[_0x1e5f13(0x1d4)][_0x1e5f13(0xd0)]>RAW_LOG_MAX_SIZE)_0x17c20['rawEventLog'][_0x1e5f13(0x18b)](0x0,_0x17c20[_0x1e5f13(0x1d4)][_0x1e5f13(0xd0)]-RAW_LOG_MAX_SIZE);await _0x17c20[_0x1e5f13(0x1d5)](LTM_DP_RAW_LOG,{'val':JSON[_0x1e5f13(0xf5)](_0x17c20[_0x1e5f13(0x1d4)]),'ack':!![]});}async function loadDailyDigests(_0x2fd7c8){const _0x4c7549=a0_0x2ae9cf;try{const _0x4db9eb=await _0x2fd7c8[_0x4c7549(0x1e2)](LTM_DP_DAILY_DIGESTS);if(_0x4db9eb&&_0x4db9eb[_0x4c7549(0x1ea)])_0x2fd7c8[_0x4c7549(0x1a0)]=JSON[_0x4c7549(0xe4)](_0x4db9eb[_0x4c7549(0x1ea)]);}catch(_0x5ae5d0){_0x2fd7c8[_0x4c7549(0x1a0)]=[];}await updateBaselineStatus(_0x2fd7c8);}async function saveDailyDigests(_0x119c9a,_0x5e79e4=!![]){const _0x4310c5=a0_0x2ae9cf,_0x470d73=_0x119c9a[_0x4310c5(0xdb)][_0x4310c5(0x19f)]||0x3c;_0x119c9a[_0x4310c5(0x1a0)][_0x4310c5(0xd0)]>_0x470d73&&_0x119c9a[_0x4310c5(0x1a0)][_0x4310c5(0x18b)](0x0,_0x119c9a['dailyDigests'][_0x4310c5(0xd0)]-_0x470d73);await _0x119c9a[_0x4310c5(0x1d5)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x119c9a[_0x4310c5(0x1a0)]),'ack':!![]});if(_0x5e79e4)await updateBaselineStatus(_0x119c9a);}async function updateAnalysisHistory(_0x4ba529,_0x44def3){const _0x50402f=a0_0x2ae9cf;_0x4ba529[_0x50402f(0xc9)][_0x50402f(0x224)](_0x44def3);if(_0x4ba529[_0x50402f(0xc9)][_0x50402f(0xd0)]>HISTORY_MAX_SIZE)_0x4ba529[_0x50402f(0xc9)][_0x50402f(0x10b)]();await _0x4ba529[_0x50402f(0x1d5)](_0x50402f(0x204),{'val':JSON[_0x50402f(0xf5)](_0x4ba529[_0x50402f(0xc9)]),'ack':!![]});}async function updateBaselineStatus(_0x4cb672){const _0x33f206=a0_0x2ae9cf;if(!_0x4cb672[_0x33f206(0x10e)]){await _0x4cb672[_0x33f206(0x1d5)](LTM_DP_BASELINE_STATUS,{'val':_0x33f206(0x185),'ack':!![]});return;}const _0x147afb=_0x4cb672['dailyDigests']['length']>=(_0x4cb672[_0x33f206(0xdb)]['minDaysForBaseline']||0x7)?_0x33f206(0x149)+_0x4cb672[_0x33f206(0x1a0)][_0x33f206(0xd0)]+'\x20Tage)':_0x33f206(0x1d0)+_0x4cb672[_0x33f206(0x1a0)][_0x33f206(0xd0)]+'/'+(_0x4cb672['config'][_0x33f206(0x16c)]||0x7)+')';await _0x4cb672[_0x33f206(0x1d5)](LTM_DP_BASELINE_STATUS,{'val':_0x147afb,'ack':!![]});}async function initSensorSubscriptions(_0x3db9a5){const _0x53ab6c=a0_0x2ae9cf,_0x8ea169=_0x3db9a5[_0x53ab6c(0xdb)]['devices'];if(_0x8ea169)for(const _0x57d48e of _0x8ea169){await _0x3db9a5[_0x53ab6c(0x183)](_0x57d48e['id']);}}async function initPresenceSubscriptions(_0x4e895b){const _0xb63cdc=a0_0x2ae9cf,_0xb167a3=_0x4e895b['config'][_0xb63cdc(0xc4)];if(_0xb167a3)for(const _0x4d11ca of _0xb167a3){await _0x4e895b[_0xb63cdc(0x183)](_0x4d11ca);}}async function setupTelegramListener(_0x2e337b){const _0x473367=a0_0x2ae9cf,_0xe0a058=_0x2e337b['config'][_0x473367(0x1cb)];if(_0x2e337b['config']['notifyTelegramEnabled']&&_0xe0a058)await _0x2e337b[_0x473367(0x183)](_0xe0a058+'.communicate.request');}async function checkWifiPresence(_0x884a0c){const _0x3ee66b=a0_0x2ae9cf;try{const _0x1726eb=_0x884a0c['config'][_0x3ee66b(0xc4)]||[];let _0x5a94c0=![];const _0x3e0705=[];for(const _0x28a1da of _0x1726eb){try{const _0x13617f=await _0x884a0c[_0x3ee66b(0x15d)](_0x28a1da);_0x13617f&&(_0x13617f[_0x3ee66b(0x1ea)]===!![]||_0x13617f[_0x3ee66b(0x1ea)]===_0x3ee66b(0x1ff)||_0x13617f[_0x3ee66b(0x1ea)]===0x1)&&(_0x5a94c0=!![],_0x3e0705[_0x3ee66b(0xa0)](_0x28a1da));}catch(_0xe5e7d7){}}return await _0x884a0c[_0x3ee66b(0x1d5)]('system.presenceWho',{'val':_0x3e0705[_0x3ee66b(0x207)](',\x20'),'ack':!![]}),_0x5a94c0&&(_0x884a0c[_0x3ee66b(0x107)]&&(_0x884a0c[_0x3ee66b(0x105)]['info'](_0x3ee66b(0x1bd)),abortExitTimer(_0x884a0c)),!_0x884a0c['isPresent']&&_0x884a0c[_0x3ee66b(0xae)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x884a0c,!![])),_0x5a94c0;}catch(_0xdef14){return![];}}function startExitTimer(_0x34e7cf){const _0x78906c=a0_0x2ae9cf;abortExitTimer(_0x34e7cf),_0x34e7cf[_0x78906c(0x117)]=!![],_0x34e7cf[_0x78906c(0x159)]=setTimeout(()=>{const _0x2e261f=_0x78906c;_0x34e7cf[_0x2e261f(0x117)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x34e7cf[_0x78906c(0x107)]=setTimeout(()=>{const _0x339bcc=_0x78906c;setPresence(_0x34e7cf,![]),_0x34e7cf[_0x339bcc(0x107)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x3f7bd9){const _0x54f883=a0_0x2ae9cf;if(_0x3f7bd9[_0x54f883(0x107)])clearTimeout(_0x3f7bd9[_0x54f883(0x107)]);if(_0x3f7bd9[_0x54f883(0x159)])clearTimeout(_0x3f7bd9[_0x54f883(0x159)]);_0x3f7bd9['exitTimer']=null,_0x3f7bd9[_0x54f883(0x159)]=null,_0x3f7bd9[_0x54f883(0x117)]=![];}function a0_0x4b5a(){const _0x5e33c8=['length','testContext','(((.+)+)+)+$','analysis.security.currentThreshold','LTM.baselineStatus','targetId','N/A','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','enum','indicator','normal','config','analysis.trigger','heizung','analysis.energy.heatingScore','value','city','licht','sensorLastValues','ðŸ“\x20Feedback\x20received:\x20','parse','boolean','data','success','lampe','onUnload','error','./lib/scanner','daswetter','Fokus\x20auf\x20Komfort.','ANOMALY','169631rkamxG','temperatur','.forecast.current.state','find','presence','LTM.processingStatus','stringify','existsSync','switch','useWeather','PRIORITÃ„T:\x20Gesundheit/AAL.','Wetterdaten\x20deaktiviert.','\x20new\x20patterns.','events.history','Insulation\x20Score','Keine\x20Details.','lastAlertState','motion','Topology\x20Error:\x20','52ifamPh','baselineDrift','Trigger\x20Analysis','log','setHours','exitTimer','Â°C,\x20','weatherunderground','stateChange','pop','LTM.driftAnalysis.baselineDrift','./lib/installer','isProVersion','TRAINING_COMPLETE','date','unload','change_percent','analysis.training.triggerSecurity','132QByBkz','analysis.automation.patternDetected','fill','isGracePeriodActive','getGenerativeModel','analysis.training.triggerComfort','enum.functions.*','NORMAL','ANALYZE_GAIT','HEALTH_TRAIN_RESULT','Description','Thermodynamics','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Daily\x20Digests','System\x20Mode','devices','latitude','5716080RimVjT','analysis.training.status','calendarInstance','LTM.dailyDigests','replace','PONG','version','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','LTM','TOPOLOGY_RESULT','Unbekannt','analysis.activitySummary','Keine\x20Wetterdaten\x20verfÃ¼gbar.','Sec-Training\x20started...','forEach','useCalendar','extendObjectAsync','temperature','isAlert','analysis.training','some','./lib/scheduler','ltmStbWindowDays','.\x20EMERGENCY:\x20','ANALYZE_SEQUENCE','events.lastEvent','GAIT_RESULT','PYTHON_EXE','onReady','generic','number','subscribeStates','licenseKey','analysis.energy.forecast','Anomaly\x20Score','Training\x20Error:\x20','Aktiv\x20(','isPresent','now','System','toISOString','ðŸ§ \x20Triggering\x20Security\x20Training...','Trigger\x20Action','analysis.triggerBriefing','setState','briefingJob','string','child_process','getOverviewData','location','analysis.lastResult','write','exitGraceTimer','TRAIN_ENERGY','Train\x20Security','door','getForeignStateAsync','analysis.health.isAnomaly','warn','getTime','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','Auto\x20Apply','substring','Restoring\x20sensor\x20cache...','[LOG]','Adapter','âš ï¸\x20SECURITY\x20ALARM:\x20','763ODQdOz','Energy\x20Intelligence','system.config','ENERGY_TRAIN_RESULT','minDaysForBaseline','analysis.training.triggerTopology','OK:\x20','PREDICT_ENERGY','tÃ¼r','keys','âš ï¸\x20ALARM:\x20','Missing\x20data','contact','.\x20SYSTEM_MODE:\x20','path','setForeignStateAsync','onStateChange','No\x20instance','livingContext','analysis.security.lastScore','diagnosis','BUILD_TOPOLOGY','object','GUEST','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','analysis.automation.detectedPatterns','subscribeForeignStatesAsync','main','Deaktiviert\x20(Pro-Feature)','Raw\x20Log','debug','split','analysis.training.triggerEnergy','Train\x20Health','splice','Security\x20Monitor','@iobroker/adapter-core','4645416AowDPT','communicate.request','getEnums','toFixed','BUTLER\x20Execution\x20Error:\x20','47028pWKpqf','Briefing\x20Error:\x20','activityLevel','getCalendarNames','Unknown','Trigger\x20Briefing','logDuplicates','setupLtmScheduler','geminiModel','apiKey','analysis.health.lastCheck','system.mode','ltmLtbWindowDays','dailyDigests','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','inactivityThresholdHours','Fokus\x20auf\x20Familienroutinen.','response','close','generateContent','rule','constructor','Gemini\x20Error:\x20','accuweather','Detected\x20Patterns','AI\x20Training','prÃ¤senz','analysis.security.lastCheck','analysis.history_debug_00','@google/generative-ai','getLtmData','Topology\x20Matrix','telegram','analysis.security','targetValue','text','loc','namespace','bind','systemUUID','writable','cogni-living','WiFi\x20Presence\x20detected.','round','âœ…\x20HEALTH\x20TRAINED.','LTM.trainingData.thermodynamics','setObjectNotExistsAsync','Temperature\x20Forecast','sendTo','enum.rooms.*','setupBriefingScheduler','klima','callback','analysis.automation.autoApply','Regel\x20erkannt:\x20','analysis.health.trendValue','notifyTelegramInstance','channel','eventHistory','Alert\x20Status','button','Lernphase\x20(','values','scanForDevices','triggerBriefing','rawEventLog','setStateAsync','Success:\x20','PARTY','pythonProcess','ðŸš€\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.10)...','setupModeResetScheduler','30606niUQcZ','analysis.health.todayVector','confidence','TREND_RESULT','driftAnalysisTimer','details','command','getStateAsync','Trend\x20Value','automationProposal','Analysiere\x20ausgewogen.','LTM.driftAnalysis.driftDetails','LTM.trainingData.sequences','Sequences','name','val','toLowerCase','getMonth','alertReason','getHours','Success','reason','\x20=\x20','testApiKey','timestamp','cancel','trim','shift','Who\x20is\x20present?','Training\x20Status','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','Trend','ðŸŒ…\x20Morning\x20Briefing:\x0a','Target\x20ID','.forecast.current.temperature','LTM.driftAnalysis','online','toString','window','stdout','N/A\x20(Learning)','analysis.analysisHistory','weatherInstance','text.alarm','join','systemConfig','analysis.security.topologyMatrix','analysisInterval','analysis.health.gaitSpeed','checkAndInstall','analysis.energy.insulationScore','genAI','Build\x20Topology','ready','Kein\x20API\x20Key.','status','analysis.health.trendDiagnosis','vacation','analysis.alertReason','getForeignObjectAsync','modeResetJob','heating','LTM.triggerDailyDigest','analysis.training.triggerHealth','includes','.forecast.current.temp','system.presenceWho','from','.NextHours.Location_1.Day_1.current.temp_value','onMessage','Kein\x20API\x20Key!','longitude','geminiApiKey','unshift','analysis.automation.description','payload','Err:\x20','stdin','is_anomaly','.\x20WETTER:\x20','slice','outdoorSensorId','isExit','Current\x20Threshold','endsWith','description','insulation','ðŸ\x20Python\x20Pong','\x20->\x20','dependencyInstallInProgress','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','analysis.automation.targetId','triggerDailyDigest','push','PRIORITÃ„T:\x20Sicherheit.','analysis.automation.triggerAction','summary','Today\x20Vector\x20(15m)','search','common','autoApply','aiPersona','analysis.isAlert','Gait\x20Speed\x20Trend','5DgXbXO','analysis.automation.targetValue','map','currentSystemMode','Gemini\x20AI\x20initialized.','.Current.WeatherText','detected','getForeignObjectsAsync','automation.triggerAction','info','VACATION','Digest','submitFeedback','2267330emVzsE','analysisTimer','schalter','ltmJob','Keine\x20Termine.','ack','floor','isEmergency','json','filter','python_service','startsWith','presenceDevices','instance','Last\x20Check','82041OrRtMj','state','analysisHistory','Activity-Level','type','dimmer','message','TRAIN_SECURITY','kontakt'];a0_0x4b5a=function(){return _0x5e33c8;};return a0_0x4b5a();}async function setPresence(_0x37526b,_0x5739a7){const _0x490292=a0_0x2ae9cf;if(_0x37526b[_0x490292(0x14a)]===_0x5739a7)return;_0x37526b['isPresent']=_0x5739a7,await _0x37526b[_0x490292(0x1d5)]('system.isPresent',{'val':_0x5739a7,'ack':!![]});}async function executeAutomationAction(_0x11b28f){const _0xc007f6=a0_0x2ae9cf;try{const _0x5b672f=await _0x11b28f['getStateAsync'](_0xc007f6(0x9e)),_0x534b1a=await _0x11b28f[_0xc007f6(0x1e2)](_0xc007f6(0xac));if(_0x5b672f&&_0x5b672f[_0xc007f6(0x1ea)]&&_0x534b1a){const _0x5bdaf5=_0x5b672f[_0xc007f6(0x1ea)];let _0x428d60=_0x534b1a[_0xc007f6(0x1ea)];try{_0x428d60=JSON[_0xc007f6(0xe4)](_0x428d60);}catch(_0xe1c28){}_0x11b28f['log'][_0xc007f6(0xb4)](_0xc007f6(0x161)+_0x5bdaf5+'\x20=\x20'+_0x428d60),await _0x11b28f[_0xc007f6(0x177)](_0x5bdaf5,_0x428d60);}else _0x11b28f['log'][_0xc007f6(0x15f)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x45aea6){_0x11b28f[_0xc007f6(0x105)][_0xc007f6(0xea)](_0xc007f6(0x192)+_0x45aea6[_0xc007f6(0xcd)]);}}async function processSensorEvent(_0x39e75c,_0x5b5df4,_0x3e2d78,_0x10abf7){const _0x115eab=a0_0x2ae9cf;if(!_0x10abf7)return;const _0x47c329=_0x3e2d78[_0x115eab(0x1ea)],_0x6b5ee0=Date[_0x115eab(0x14b)](),_0x7eb508=_0x39e75c[_0x115eab(0xe2)][_0x5b5df4];_0x39e75c[_0x115eab(0xe2)][_0x5b5df4]=_0x47c329;if(!_0x10abf7[_0x115eab(0x199)]&&_0x7eb508!=undefined&&_0x7eb508==_0x47c329)return;const _0x17ef82=(_0x10abf7[_0x115eab(0xcb)]||'')[_0x115eab(0x1eb)](),_0x1770e=_0x17ef82[_0x115eab(0x21b)](_0x115eab(0x136))||_0x17ef82['includes'](_0x115eab(0xf0))||_0x17ef82[_0x115eab(0x21b)](_0x115eab(0x1c6))||_0x17ef82[_0x115eab(0x21b)](_0x115eab(0xdd));_0x39e75c['isProVersion']&&_0x1770e&&recordThermodynamics(_0x39e75c,_0x5b5df4,_0x47c329,_0x10abf7[_0x115eab(0x156)]);const _0x5211cc={'timestamp':_0x6b5ee0,'id':_0x5b5df4,'name':_0x10abf7['name'],'type':_0x10abf7[_0x115eab(0xcb)],'location':_0x10abf7['location'],'value':_0x47c329};_0x39e75c[_0x115eab(0x1cd)][_0x115eab(0x224)](_0x5211cc);if(_0x39e75c[_0x115eab(0x1cd)]['length']>HISTORY_MAX_SIZE)_0x39e75c[_0x115eab(0x1cd)][_0x115eab(0x10b)]();await _0x39e75c[_0x115eab(0x1d5)](_0x115eab(0x13e),{'val':JSON[_0x115eab(0xf5)](_0x5211cc),'ack':!![]}),await _0x39e75c['setStateAsync'](_0x115eab(0xfc),{'val':JSON[_0x115eab(0xf5)](_0x39e75c[_0x115eab(0x1cd)]),'ack':!![]});_0x39e75c[_0x115eab(0x10e)]&&(_0x39e75c['rawEventLog']['push'](_0x5211cc),await saveRawEventLog(_0x39e75c),recordSequence(_0x39e75c,_0x5211cc));if(_0x10abf7[_0x115eab(0x22d)]&&_0x47c329===!![]){if(_0x39e75c[_0x115eab(0x14a)]&&!_0x39e75c[_0x115eab(0x117)])startExitTimer(_0x39e75c);else{if(!_0x39e75c[_0x115eab(0x14a)])setPresence(_0x39e75c,!![]);}}else{if(_0x10abf7[_0x115eab(0xcb)]===_0x115eab(0x100)&&_0x47c329===!![]){if(_0x39e75c[_0x115eab(0x107)])abortExitTimer(_0x39e75c);if(!_0x39e75c[_0x115eab(0x14a)]&&_0x39e75c[_0x115eab(0xae)]===SYSTEM_MODES[_0x115eab(0x11b)])setPresence(_0x39e75c,!![]);}}}async function recordThermodynamics(_0x2cb83b,_0x3e5593,_0x1dbb15,_0x47ac0a){const _0x4223c8=a0_0x2ae9cf,_0x15d289=await getOutsideTemperatureNumeric(_0x2cb83b),_0x1e2d96=await _0x2cb83b[_0x4223c8(0x1e2)]('LTM.trainingData.thermodynamics');let _0x3fcaa0=[];if(_0x1e2d96&&_0x1e2d96[_0x4223c8(0x1ea)])try{_0x3fcaa0=JSON[_0x4223c8(0xe4)](_0x1e2d96['val']);}catch(_0x5a3a4a){}_0x3fcaa0[_0x4223c8(0xa0)]({'ts':Date[_0x4223c8(0x14b)](),'room':_0x47ac0a||_0x4223c8(0x197),'t_in':_0x1dbb15,'t_out':_0x15d289});if(_0x3fcaa0[_0x4223c8(0xd0)]>THERMO_LOG_SIZE)_0x3fcaa0[_0x4223c8(0x1f6)]();await _0x2cb83b[_0x4223c8(0x1d5)](_0x4223c8(0x1c0),{'val':JSON[_0x4223c8(0xf5)](_0x3fcaa0),'ack':!![]});}function a0_0x5a5d(_0x1f8a27,_0x3eefaa){const _0x5722af=a0_0x4b5a();return a0_0x5a5d=function(_0x3b52cf,_0x11cc26){_0x3b52cf=_0x3b52cf-0x96;let _0x4b5a67=_0x5722af[_0x3b52cf];return _0x4b5a67;},a0_0x5a5d(_0x1f8a27,_0x3eefaa);}async function getOutsideTemperatureNumeric(_0x37784c){const _0x5501b5=a0_0x2ae9cf;if(_0x37784c[_0x5501b5(0xdb)][_0x5501b5(0x22c)])try{const _0x12fd98=await _0x37784c[_0x5501b5(0x15d)](_0x37784c['config'][_0x5501b5(0x22c)]);if(_0x12fd98&&_0x12fd98['val']!==undefined&&_0x12fd98[_0x5501b5(0x1ea)]!==null)return parseFloat(_0x12fd98[_0x5501b5(0x1ea)]);}catch(_0x4bf637){}const _0x28380d=_0x37784c['config'][_0x5501b5(0x205)];if(!_0x37784c[_0x5501b5(0xdb)][_0x5501b5(0xf8)]||!_0x28380d)return null;try{let _0x9a49f7='';if(_0x28380d[_0x5501b5(0x21b)](_0x5501b5(0x1aa)))_0x9a49f7=_0x28380d+'.Current.Temperature';else{if(_0x28380d[_0x5501b5(0x21b)](_0x5501b5(0xec)))_0x9a49f7=_0x28380d+_0x5501b5(0x21f);else{if(_0x28380d[_0x5501b5(0x21b)]('openweathermap'))_0x9a49f7=_0x28380d+'.forecast.current.temperature';else{if(_0x28380d[_0x5501b5(0x21b)](_0x5501b5(0x109)))_0x9a49f7=_0x28380d+_0x5501b5(0x21c);}}}if(_0x9a49f7){const _0x265a08=await _0x37784c[_0x5501b5(0x15d)](_0x9a49f7);if(_0x265a08&&_0x265a08[_0x5501b5(0x1ea)]!==undefined&&_0x265a08[_0x5501b5(0x1ea)]!==null)return parseFloat(_0x265a08[_0x5501b5(0x1ea)]);}}catch(_0x5e91f7){}return null;}async function recordSequence(_0x1018c5,_0x1da042){const _0x2755e1=a0_0x2ae9cf,_0x2d5f2d=(_0x1da042[_0x2755e1(0xcb)]||'')[_0x2755e1(0x1eb)](),_0x1766e5=[_0x2755e1(0x100),'bewegung',_0x2755e1(0x1ad),_0x2755e1(0xf3),'occupancy',_0x2755e1(0x15c),_0x2755e1(0x170),_0x2755e1(0x201),'fenster',_0x2755e1(0x174),_0x2755e1(0xcf),'light',_0x2755e1(0xe1),_0x2755e1(0xf7),_0x2755e1(0xba),_0x2755e1(0xcc),_0x2755e1(0xe8)];if(!_0x1766e5[_0x2755e1(0x139)](_0x5d9afe=>_0x2d5f2d['includes'](_0x5d9afe)))return;if(!_0x1da042[_0x2755e1(0xdf)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x2755e1(0xa0)]({'loc':_0x1da042[_0x2755e1(0x156)]||_0x2755e1(0x197),'id':_0x1da042['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x1018c5);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x283a7d){const _0x2bb23e=a0_0x2ae9cf;try{const _0xeb17e=await _0x283a7d[_0x2bb23e(0x1e2)]('LTM.trainingData.sequences');let _0x8f2282=[];if(_0xeb17e&&_0xeb17e['val'])try{_0x8f2282=JSON['parse'](_0xeb17e[_0x2bb23e(0x1ea)]);}catch(_0x37d867){}const _0x3e39db=activeSequence[0x0]['ts'],_0x4210f2=activeSequence[_0x2bb23e(0xad)](_0x44582a=>({'loc':_0x44582a[_0x2bb23e(0x1b7)],'t_delta':Math[_0x2bb23e(0x1be)]((_0x44582a['ts']-_0x3e39db)/0x3e8)})),_0x2816e2={'timestamp':new Date(_0x3e39db)[_0x2bb23e(0x14d)](),'steps':_0x4210f2,'duration':Math[_0x2bb23e(0x1be)]((activeSequence[activeSequence[_0x2bb23e(0xd0)]-0x1]['ts']-_0x3e39db)/0x3e8),'daytime':new Date(_0x3e39db)[_0x2bb23e(0x1ee)]()};_0x8f2282[_0x2bb23e(0xa0)](_0x2816e2);if(_0x8f2282['length']>MAX_TRAINING_SET_SIZE)_0x8f2282[_0x2bb23e(0x1f6)]();await _0x283a7d['setStateAsync'](_0x2bb23e(0x1e7),{'val':JSON[_0x2bb23e(0xf5)](_0x8f2282),'ack':!![]}),runSecurityCheck(_0x283a7d,_0x2816e2);}catch(_0x4bd88d){_0x283a7d[_0x2bb23e(0x105)][_0x2bb23e(0xea)]('[RECORDER]\x20Error:\x20'+_0x4bd88d['message']);}}function runSecurityCheck(_0x118af0,_0x267b03){const _0x5cefb3=a0_0x2ae9cf;if(!_0x118af0[_0x5cefb3(0x10e)])return;sendToPython(_0x118af0,_0x5cefb3(0x13d),{'sequence':_0x267b03});}async function createDailyDigest(_0x3ac36d){const _0x3a6116=a0_0x2ae9cf;if(!_0x3ac36d[_0x3a6116(0x10e)])return;await _0x3ac36d[_0x3a6116(0x1d5)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x3ac36d[_0x3a6116(0x19b)]||_0x3ac36d[_0x3a6116(0x1d4)][_0x3a6116(0xd0)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3ac36d[_0x3a6116(0x1d5)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x387246=JSON['parse'](JSON['stringify'](_0x3ac36d[_0x3a6116(0x1d4)])),_0x524cf4=_0x387246['length'],_0x417027='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x3a6116(0xf5)](_0x387246);try{const _0x138073=await _0x3ac36d[_0x3a6116(0x19b)][_0x3a6116(0x1a6)](_0x417027),_0x19e833=JSON[_0x3a6116(0xe4)](_0x138073[_0x3a6116(0x1a4)][_0x3a6116(0x1b6)]()['replace'](/```json|```/g,'')[_0x3a6116(0x1f5)]()),_0x470b88={'timestamp':new Date()['toISOString'](),'eventCount':_0x524cf4,'summary':_0x19e833[_0x3a6116(0xa3)]||_0x3a6116(0xb6),'activityLevel':_0x19e833[_0x3a6116(0x195)]||'normal','systemMode':_0x3ac36d[_0x3a6116(0xae)]};_0x3ac36d[_0x3a6116(0x1a0)][_0x3a6116(0xa0)](_0x470b88),await saveDailyDigests(_0x3ac36d),_0x3ac36d[_0x3a6116(0x1d4)]=[],await saveRawEventLog(_0x3ac36d),await _0x3ac36d['setStateAsync'](LTM_DP_STATUS,{'val':_0x3a6116(0x1ef),'ack':!![]});if(_0x3ac36d['isProVersion'])sendToPython(_0x3ac36d,'ANALYZE_HEALTH',{'digest':_0x470b88});}catch(_0x466742){_0x3ac36d[_0x3a6116(0x105)][_0x3a6116(0xea)](_0x466742[_0x3a6116(0xcd)]);}}async function runBaselineDriftAnalysis(_0x305fd9){const _0x4ae0d3=a0_0x2ae9cf;if(!_0x305fd9[_0x4ae0d3(0x10e)]||!_0x305fd9[_0x4ae0d3(0x19b)])return;const _0x47457b=_0x305fd9['config'][_0x4ae0d3(0x13b)]||0xe;if(_0x305fd9[_0x4ae0d3(0x1a0)][_0x4ae0d3(0xd0)]<_0x47457b+0x7){await _0x305fd9[_0x4ae0d3(0x1d5)](LTM_DP_DRIFT_STATUS,{'val':_0x4ae0d3(0x203),'ack':!![]});return;}const _0xabdf2f=_0x305fd9['dailyDigests']['slice'](-_0x47457b),_0x101f72=_0x305fd9[_0x4ae0d3(0x1a0)]['slice'](0x0,_0x305fd9[_0x4ae0d3(0x1a0)][_0x4ae0d3(0xd0)]-_0x47457b),_0x3a7249=_0x4ae0d3(0x120)+JSON[_0x4ae0d3(0xf5)](_0x101f72)+'\x0aSTB:\x20'+JSON[_0x4ae0d3(0xf5)](_0xabdf2f);try{const _0x4dcca1=await _0x305fd9[_0x4ae0d3(0x19b)][_0x4ae0d3(0x1a6)](_0x3a7249),_0x1d1dec=JSON[_0x4ae0d3(0xe4)](_0x4dcca1[_0x4ae0d3(0x1a4)][_0x4ae0d3(0x1b6)]()[_0x4ae0d3(0x129)](/```json|```/g,'')[_0x4ae0d3(0x1f5)]());_0x1d1dec['baselineDrift']&&(await _0x305fd9[_0x4ae0d3(0x1d5)](LTM_DP_DRIFT_STATUS,{'val':_0x1d1dec[_0x4ae0d3(0x103)],'ack':!![]}),await _0x305fd9['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x1d1dec['driftDetails'],'ack':!![]}),await _0x305fd9['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4ae0d3(0x14b)](),'ack':!![]}));}catch(_0x43968e){}}async function sendMorningBriefing(_0xb8b0ff){const _0x42bc1b=a0_0x2ae9cf;if(!_0xb8b0ff[_0x42bc1b(0x19b)])return;try{const _0x55d15a=_0x42bc1b(0x180),_0x240078=await _0xb8b0ff[_0x42bc1b(0x19b)][_0x42bc1b(0x1a6)](_0x55d15a),_0x141d42=_0x240078['response'][_0x42bc1b(0x1b6)]();sendNotification(_0xb8b0ff,_0x42bc1b(0x1fb)+_0x141d42);}catch(_0x43629a){_0xb8b0ff[_0x42bc1b(0x105)][_0x42bc1b(0xea)](_0x42bc1b(0x194)+_0x43629a[_0x42bc1b(0xcd)]);}}function stopPythonService(_0x4ab3ef){const _0x37ce8e=a0_0x2ae9cf;if(_0x4ab3ef[_0x37ce8e(0x1d8)]){try{_0x4ab3ef[_0x37ce8e(0x1d8)]['kill']();}catch(_0x14a21f){}_0x4ab3ef[_0x37ce8e(0x1d8)]=null;}}function sendToPython(_0x415ccb,_0x1353c1,_0x5ae36e={}){const _0x57cf06=a0_0x2ae9cf;if(!_0x415ccb[_0x57cf06(0x1d8)]||!_0x415ccb[_0x57cf06(0x1d8)][_0x57cf06(0x228)][_0x57cf06(0x1bb)])return;const _0x54d3d8=JSON['stringify']({'command':_0x1353c1,..._0x5ae36e});try{_0x415ccb['pythonProcess'][_0x57cf06(0x228)][_0x57cf06(0x158)](_0x54d3d8+'\x0a');}catch(_0x445e2a){}}function runPythonHealthCheck(_0x361668){const _0x37c8b3=a0_0x2ae9cf;if(!_0x361668[_0x37c8b3(0x1a0)]||_0x361668[_0x37c8b3(0x1a0)][_0x37c8b3(0xd0)]<0x2)return;const _0x31dc1e=_0x361668['dailyDigests']['map'](_0x12cabd=>{const _0x40f90c=_0x37c8b3,_0xb4bc8b=(_0x12cabd[_0x40f90c(0x195)]||'')[_0x40f90c(0x1eb)]();return ACTIVITY_LEVEL_MAP[_0xb4bc8b]||0x32;});sendToPython(_0x361668,'ANALYZE_TREND',{'values':_0x31dc1e,'tag':_0x37c8b3(0xca)});}function handlePythonResult(_0x2652f8,_0x1cfae2){const _0x2e26dc=a0_0x2ae9cf;if(_0x1cfae2[_0x2e26dc(0xcb)]===_0x2e26dc(0x12a))_0x2652f8[_0x2e26dc(0x105)][_0x2e26dc(0x187)](_0x2e26dc(0x9a));else{if(_0x1cfae2[_0x2e26dc(0xcb)]==='SECURITY_RESULT'){const {anomaly_score:_0x21cb91,is_anomaly:_0x38d074,threshold:_0x93dbdc,explanation:_0x523ecf}=_0x1cfae2['payload'];_0x2652f8[_0x2e26dc(0x105)]['info'](_0x2e26dc(0x181)+_0x21cb91[_0x2e26dc(0x191)](0x5)+_0x2e26dc(0x9b)+(_0x38d074?_0x2e26dc(0xee):'OK')),_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0x17b),{'val':_0x21cb91,'ack':!![]}),_0x2652f8['setStateAsync']('analysis.security.lastCheck',{'val':new Date()['toISOString'](),'ack':!![]});if(_0x93dbdc)_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0xd3),{'val':_0x93dbdc,'ack':!![]});if(_0x38d074){let _0x4631d2=_0x2e26dc(0x12c)+_0x21cb91[_0x2e26dc(0x191)](0x4)+')';if(_0x523ecf&&_0x523ecf!==_0x2e26dc(0x197))_0x4631d2+='\x0aGrund:\x20'+_0x523ecf;_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0xa9),{'val':!![],'ack':!![]}),_0x2652f8[_0x2e26dc(0x1d5)]('analysis.alertReason',{'val':_0x4631d2,'ack':!![]}),sendNotification(_0x2652f8,_0x2e26dc(0x167)+_0x4631d2,![],!![]);}}else{if(_0x1cfae2[_0x2e26dc(0xcb)]===_0x2e26dc(0x10f)){const _0x284b37=_0x1cfae2['payload'][_0x2e26dc(0x1e0)]||'',_0x4b4ee6=_0x1cfae2[_0x2e26dc(0x226)]['threshold'],_0x307c5d=_0x1cfae2['payload'][_0x2e26dc(0xe7)]?_0x2e26dc(0x1d6)+new Date()['toLocaleTimeString']()+'\x20('+_0x284b37+')':'Failed:\x20'+_0x1cfae2[_0x2e26dc(0x226)][_0x2e26dc(0x1f0)];_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0x126),{'val':_0x307c5d,'ack':!![]});if(_0x1cfae2[_0x2e26dc(0x226)]['success']&&_0x4b4ee6)_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0xd3),{'val':_0x4b4ee6,'ack':!![]});}else{if(_0x1cfae2[_0x2e26dc(0xcb)]==='COMFORT_RESULT'){const {patterns:_0x547fb6}=_0x1cfae2[_0x2e26dc(0x226)];if(_0x547fb6&&_0x547fb6[_0x2e26dc(0xd0)]>0x0){_0x2652f8[_0x2e26dc(0x105)][_0x2e26dc(0xb4)]('ðŸ›‹ï¸\x20BUTLER:\x20Found\x20'+_0x547fb6['length']+_0x2e26dc(0xfb)),_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0x182),{'val':JSON['stringify'](_0x547fb6),'ack':!![]});const _0x1847b7=_0x547fb6[0x0],_0x49dcc8=_0x2e26dc(0x1c9)+_0x1847b7[_0x2e26dc(0x1a7)]+'\x20('+(_0x1847b7[_0x2e26dc(0x1dd)]*0x64)[_0x2e26dc(0x191)](0x0)+'%)';_0x2652f8[_0x2e26dc(0x1d5)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),_0x2652f8['setStateAsync'](_0x2e26dc(0x225),{'val':_0x49dcc8,'ack':!![]});}else _0x2652f8[_0x2e26dc(0x105)][_0x2e26dc(0xb4)]('ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x2652f8[_0x2e26dc(0x1d5)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0x182),{'val':'[]','ack':!![]});}else{if(_0x1cfae2['type']===_0x2e26dc(0x16b)){if(_0x1cfae2['payload'][_0x2e26dc(0xe7)])try{const _0x317afa=JSON[_0x2e26dc(0xe4)](_0x1cfae2[_0x2e26dc(0x226)][_0x2e26dc(0x1e0)]);if(_0x317afa[_0x2e26dc(0x99)])_0x2652f8[_0x2e26dc(0x1d5)]('analysis.energy.insulationScore',{'val':JSON[_0x2e26dc(0xf5)](_0x317afa[_0x2e26dc(0x99)]),'ack':!![]});if(_0x317afa[_0x2e26dc(0x218)])_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0xde),{'val':JSON[_0x2e26dc(0xf5)](_0x317afa[_0x2e26dc(0x218)]),'ack':!![]});}catch(_0x2d8cc5){}}else{if(_0x1cfae2[_0x2e26dc(0xcb)]===_0x2e26dc(0x11d)){if(_0x1cfae2[_0x2e26dc(0x226)][_0x2e26dc(0xe7)])_0x2652f8[_0x2e26dc(0x105)][_0x2e26dc(0xb4)](_0x2e26dc(0x1bf));}else{if(_0x1cfae2[_0x2e26dc(0xcb)]==='HEALTH_RESULT')_0x2652f8[_0x2e26dc(0x1d5)]('analysis.health.lastCheck',{'val':new Date()[_0x2e26dc(0x14d)](),'ack':!![]}),_0x2652f8[_0x2e26dc(0x1d5)]('analysis.health.isAnomaly',{'val':_0x1cfae2['payload'][_0x2e26dc(0x229)],'ack':!![]});else{if(_0x1cfae2['type']===_0x2e26dc(0x1de))_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0x213),{'val':_0x1cfae2['payload'][_0x2e26dc(0x17c)],'ack':!![]}),_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0x1ca),{'val':_0x1cfae2[_0x2e26dc(0x226)][_0x2e26dc(0x112)],'ack':!![]});else{if(_0x1cfae2[_0x2e26dc(0xcb)]===_0x2e26dc(0x13f)){const {speed_trend:_0x1f1f7c}=_0x1cfae2[_0x2e26dc(0x226)];if(_0x1f1f7c!==undefined)_0x2652f8[_0x2e26dc(0x1d5)]('analysis.health.gaitSpeed',{'val':_0x1f1f7c,'ack':!![]});}else{if(_0x1cfae2[_0x2e26dc(0xcb)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x107cd2}=_0x1cfae2[_0x2e26dc(0x226)];if(_0x107cd2)_0x2652f8[_0x2e26dc(0x1d5)]('analysis.energy.forecast',{'val':JSON['stringify'](_0x107cd2),'ack':!![]});}else{if(_0x1cfae2[_0x2e26dc(0xcb)]===_0x2e26dc(0x12e)){const {data:_0x4862a8}=_0x1cfae2[_0x2e26dc(0x226)];_0x4862a8&&(_0x2652f8[_0x2e26dc(0x105)][_0x2e26dc(0xb4)]('ðŸ•¸ï¸\x20Topology\x20Map\x20updated.'),_0x2652f8[_0x2e26dc(0x1d5)](_0x2e26dc(0x209),{'val':JSON['stringify'](_0x4862a8),'ack':!![]}));}}}}}}}}}}}}function startPythonService(_0x52de90){const _0x69e665=a0_0x2ae9cf;let _0x5ce2a3='python3';if(fs[_0x69e665(0xf6)](installer[_0x69e665(0x140)]))_0x5ce2a3=installer[_0x69e665(0x140)];try{const _0x3bd021=path[_0x69e665(0x207)](__dirname,_0x69e665(0xc2),'service.py');_0x52de90[_0x69e665(0x1d8)]=spawn(_0x5ce2a3,[_0x3bd021]),_0x52de90['pythonProcess'][_0x69e665(0x202)]['on'](_0x69e665(0xe6),_0x2416e3=>{const _0x59bc54=_0x69e665,_0x2c83c0=_0x2416e3[_0x59bc54(0x200)]()[_0x59bc54(0x188)]('\x0a');_0x2c83c0[_0x59bc54(0x133)](_0x4862aa=>{const _0x5b09a2=_0x59bc54,_0x539e61=_0x4862aa['trim']();if(!_0x539e61)return;if(_0x539e61[_0x5b09a2(0xc3)](_0x5b09a2(0x165)))_0x52de90[_0x5b09a2(0x105)][_0x5b09a2(0x187)]('[PYTHON]\x20'+_0x539e61[_0x5b09a2(0x163)](0x5)[_0x5b09a2(0x1f5)]());else{if(_0x539e61[_0x5b09a2(0xc3)]('[RESULT]'))try{const _0x46081b=JSON[_0x5b09a2(0xe4)](_0x539e61[_0x5b09a2(0x163)](0x8)[_0x5b09a2(0x1f5)]());handlePythonResult(_0x52de90,_0x46081b);}catch(_0x1ab7ca){}}});}),_0x52de90['pythonProcess']['on'](_0x69e665(0x1a5),_0x29ea4d=>{const _0x5e6741=_0x69e665;_0x52de90[_0x5e6741(0x1d8)]=null;});}catch(_0x353b22){_0x52de90[_0x69e665(0x105)][_0x69e665(0xea)]('Error\x20launching\x20Python:\x20'+_0x353b22[_0x69e665(0xcd)]);}}async function runAutopilot(_0x1c265f){const _0x1998d4=a0_0x2ae9cf;_0x1c265f[_0x1998d4(0x105)][_0x1998d4(0x187)](_0x1998d4(0x9d)),await runGeminiAnalysis(_0x1c265f),updateHealthVector(_0x1c265f),triggerGaitAnalysis(_0x1c265f),triggerEnergyPrediction(_0x1c265f);}async function triggerGaitAnalysis(_0x430c1e){const _0x549052=a0_0x2ae9cf;if(!_0x430c1e[_0x549052(0x10e)])return;try{const _0xd4571f=await _0x430c1e[_0x549052(0x1e2)](_0x549052(0x1e7));_0xd4571f&&_0xd4571f['val']&&sendToPython(_0x430c1e,_0x549052(0x11c),{'sequences':JSON['parse'](_0xd4571f[_0x549052(0x1ea)])});}catch(_0x336257){}}async function triggerEnergyPrediction(_0xcdbfab){const _0x8ccbce=a0_0x2ae9cf;if(!_0xcdbfab[_0x8ccbce(0x10e)])return;try{const _0x5f0116=await getOutsideTemperatureNumeric(_0xcdbfab);if(_0x5f0116===null)return;const _0x1476b6={},_0xe7b4c4=_0xcdbfab[_0x8ccbce(0xdb)][_0x8ccbce(0x123)]||[];for(const _0xad4c01 of _0xe7b4c4){if(_0xad4c01[_0x8ccbce(0xcb)]==='temperature'&&_0xad4c01[_0x8ccbce(0x156)]){const _0x488ed3=_0xcdbfab[_0x8ccbce(0xe2)][_0xad4c01['id']];if(_0x488ed3!==undefined)_0x1476b6[_0xad4c01[_0x8ccbce(0x156)]]=_0x488ed3;}}Object[_0x8ccbce(0x171)](_0x1476b6)[_0x8ccbce(0xd0)]>0x0&&sendToPython(_0xcdbfab,_0x8ccbce(0x16f),{'current_temps':_0x1476b6,'t_out':_0x5f0116});}catch(_0x42dcc0){}}function updateHealthVector(_0xe66c8){const _0x29d5bc=a0_0x2ae9cf;if(!_0xe66c8[_0x29d5bc(0x1d4)]||_0xe66c8[_0x29d5bc(0x1d4)][_0x29d5bc(0xd0)]===0x0)return;const _0x377306=new Array(0x60)[_0x29d5bc(0x116)](0x0),_0x236fe2=new Date()[_0x29d5bc(0x106)](0x0,0x0,0x0,0x0);_0xe66c8[_0x29d5bc(0x1d4)][_0x29d5bc(0x133)](_0x2b2eb6=>{const _0x49cb5c=_0x29d5bc,_0x2dfb2d=new Date(_0x2b2eb6[_0x49cb5c(0x1f3)]);if(_0x2dfb2d['getTime']()>=_0x236fe2){const _0x3540df=_0x2dfb2d[_0x49cb5c(0x1ee)](),_0x4aea05=_0x2dfb2d['getMinutes'](),_0xcf5c3a=_0x3540df*0x4+Math[_0x49cb5c(0xbe)](_0x4aea05/0xf);if(_0xcf5c3a>=0x0&&_0xcf5c3a<0x60)_0x377306[_0xcf5c3a]++;}}),_0xe66c8[_0x29d5bc(0x1d5)]('analysis.health.todayVector',{'val':JSON[_0x29d5bc(0xf5)](_0x377306),'ack':!![]});}async function getWeatherContext(_0x254df5){const _0x4ecd67=a0_0x2ae9cf;if(!_0x254df5[_0x4ecd67(0xdb)][_0x4ecd67(0xf8)]||!_0x254df5[_0x4ecd67(0xdb)][_0x4ecd67(0x205)])return _0x4ecd67(0xfa);try{const _0x2c5392=_0x254df5['config'][_0x4ecd67(0x205)];let _0x47e2b5=await _0x254df5[_0x4ecd67(0x15d)](_0x2c5392+'.Current.Temperature');if(!_0x47e2b5)_0x47e2b5=await _0x254df5[_0x4ecd67(0x15d)](_0x2c5392+_0x4ecd67(0x1fd));let _0x31de13=await _0x254df5['getForeignStateAsync'](_0x2c5392+_0x4ecd67(0xb0));if(!_0x31de13)_0x31de13=await _0x254df5[_0x4ecd67(0x15d)](_0x2c5392+_0x4ecd67(0xf1));if(_0x47e2b5&&_0x31de13)return _0x47e2b5['val']+_0x4ecd67(0x108)+_0x31de13[_0x4ecd67(0x1ea)];}catch(_0x2a70c5){}return _0x4ecd67(0x131);}async function getCalendarContext(_0x2bf13a){const _0x20867e=a0_0x2ae9cf;if(!_0x2bf13a[_0x20867e(0xdb)][_0x20867e(0x134)]||!_0x2bf13a[_0x20867e(0xdb)][_0x20867e(0x127)])return'Kalender\x20deaktiviert.';return _0x20867e(0xbc);}async function getCalendarNames(_0x4469a7,_0x59da6d){return[];}async function saveFeedback(_0xa1dcb7,_0x3245b2){const _0x5bee49=a0_0x2ae9cf;_0xa1dcb7[_0x5bee49(0x105)][_0x5bee49(0xb4)](_0x5bee49(0xe3)+_0x3245b2['rating']);}async function runGeminiAnalysis(_0x3a7309,_0x1e476=''){const _0x406201=a0_0x2ae9cf;if(!_0x3a7309['geminiModel'])return;if(_0x3a7309[_0x406201(0x1cd)][_0x406201(0xd0)]===0x0)return;const _0x116032=_0x3a7309['eventHistory'][_0x406201(0x22b)](0x0,0xf),_0x1307ff=await getWeatherContext(_0x3a7309),_0x255a12=_0x3a7309['currentSystemMode'],_0x59ae84=PERSONA_MAPPING[_0x3a7309['config'][_0x406201(0xa8)]||_0x406201(0x142)],_0x58d7bf=_0x3a7309[_0x406201(0xdb)][_0x406201(0x17a)]||_0x406201(0xfe);let _0x1509db=_0x406201(0x12f);try{const _0x1c496d=await _0x3a7309['getStateAsync']('system.presenceWho');if(_0x1c496d&&_0x1c496d[_0x406201(0x1ea)])_0x1509db=_0x1c496d[_0x406201(0x1ea)];}catch(_0x400f6b){}let _0x50740f=![];try{const _0x53fa48=await _0x3a7309[_0x406201(0x1e2)](_0x406201(0x1c8));if(_0x53fa48&&_0x53fa48[_0x406201(0x1ea)])_0x50740f=!![];}catch(_0x2318c2){}const _0x499640='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x59ae84+'.\x20KONTEXT:\x20'+_0x58d7bf+_0x406201(0x175)+_0x255a12+_0x406201(0x22a)+_0x1307ff+'.\x20ANWESEND:\x20'+_0x1509db+'.\x20EVENTS:\x20'+JSON['stringify'](_0x116032)+_0x406201(0x13c)+_0x1e476+_0x406201(0x1f9);try{const _0x3b2d02=await _0x3a7309[_0x406201(0x19b)]['generateContent'](_0x499640),_0x52e121=JSON[_0x406201(0xe4)](_0x3b2d02[_0x406201(0x1a4)]['text']()['replace'](/```json|```/g,'')[_0x406201(0x1f5)]());await _0x3a7309['setStateAsync'](_0x406201(0x157),{'val':JSON[_0x406201(0xf5)](_0x52e121),'ack':!![]});if(_0x52e121['summary'])await _0x3a7309[_0x406201(0x1d5)]('analysis.activitySummary',{'val':_0x52e121[_0x406201(0xa3)],'ack':!![]});const _0x48ae93={'timestamp':Date[_0x406201(0x14b)](),'id':Date[_0x406201(0x14b)]()[_0x406201(0x200)](),'analysis':{'activity':{'summary':_0x52e121['summary'],'isAlert':_0x52e121[_0x406201(0x137)],'alertReason':_0x52e121[_0x406201(0x1ed)]},'comfort':{'automationProposal':_0x52e121[_0x406201(0x1e4)]}}};await updateAnalysisHistory(_0x3a7309,_0x48ae93);const _0x2d6df6=_0x52e121[_0x406201(0x137)]||![];_0x2d6df6!==_0x3a7309[_0x406201(0xff)]&&(await _0x3a7309['setStateAsync'](_0x406201(0xa9),{'val':_0x2d6df6,'ack':!![]}),_0x3a7309[_0x406201(0xff)]=_0x2d6df6,_0x2d6df6&&(await _0x3a7309[_0x406201(0x1d5)]('analysis.alertReason',{'val':_0x52e121[_0x406201(0x1ed)],'ack':!![]}),sendNotification(_0x3a7309,_0x406201(0x172)+_0x52e121['alertReason'],![],_0x52e121[_0x406201(0xbf)])));if(_0x52e121[_0x406201(0x1e4)]&&_0x52e121[_0x406201(0x1e4)][_0x406201(0xb1)]){await _0x3a7309['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x3a7309[_0x406201(0x1d5)](_0x406201(0x225),{'val':_0x52e121[_0x406201(0x1e4)][_0x406201(0x98)],'ack':!![]}),await _0x3a7309[_0x406201(0x1d5)](_0x406201(0x9e),{'val':_0x52e121[_0x406201(0x1e4)][_0x406201(0xd5)],'ack':!![]}),await _0x3a7309['setStateAsync']('analysis.automation.targetValue',{'val':JSON[_0x406201(0xf5)](_0x52e121[_0x406201(0x1e4)][_0x406201(0x1b5)]),'ack':!![]});if(_0x50740f)executeAutomationAction(_0x3a7309);}}catch(_0x15691c){_0x3a7309[_0x406201(0x105)][_0x406201(0xea)](_0x406201(0x1a9)+_0x15691c['message']);}}async function startSystem(_0x4f7321){const _0x33434e=a0_0x2ae9cf;_0x4f7321[_0x33434e(0x105)][_0x33434e(0xb4)](_0x33434e(0x1d9)),await initZombies(_0x4f7321);try{_0x4f7321[_0x33434e(0x10e)]=await checkLicense(_0x4f7321[_0x33434e(0xdb)][_0x33434e(0x145)]);}catch(_0x43a5fc){}if(!_0x4f7321[_0x33434e(0xdb)][_0x33434e(0x1a2)]||_0x4f7321['config'][_0x33434e(0x1a2)]<0.1)_0x4f7321[_0x33434e(0xdb)][_0x33434e(0x1a2)]=0xc;await initHistory(_0x4f7321),await initSystemConfig(_0x4f7321);if(_0x4f7321[_0x33434e(0xdb)][_0x33434e(0x223)])try{_0x4f7321[_0x33434e(0x20e)]=new GoogleGenerativeAI(_0x4f7321[_0x33434e(0xdb)][_0x33434e(0x223)]),_0x4f7321[_0x33434e(0x19b)]=_0x4f7321['genAI'][_0x33434e(0x118)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),_0x4f7321[_0x33434e(0x105)]['info'](_0x33434e(0xaf));}catch(_0x135d56){_0x4f7321[_0x33434e(0x105)][_0x33434e(0xea)]('Gemini\x20Init\x20Error:\x20'+_0x135d56[_0x33434e(0xcd)]);}await createAllObjects(_0x4f7321),await loadSystemMode(_0x4f7321),await loadRawEventLog(_0x4f7321),await loadDailyDigests(_0x4f7321),_0x4f7321['subscribeStates'](_0x33434e(0xdc)),_0x4f7321[_0x33434e(0x144)](LTM_DP_TRIGGER_DIGEST),_0x4f7321['subscribeStates']('system.mode'),_0x4f7321[_0x33434e(0x144)](_0x33434e(0x150)),_0x4f7321[_0x33434e(0x144)](_0x33434e(0xa2)),_0x4f7321['subscribeStates'](_0x33434e(0x1c8)),_0x4f7321[_0x33434e(0x144)](_0x33434e(0x113)),_0x4f7321[_0x33434e(0x144)]('analysis.training.triggerHealth'),_0x4f7321['subscribeStates'](_0x33434e(0x189)),_0x4f7321[_0x33434e(0x144)](_0x33434e(0x119)),_0x4f7321[_0x33434e(0x144)]('analysis.training.triggerTopology'),await initSensorSubscriptions(_0x4f7321),await initPresenceSubscriptions(_0x4f7321),await setupTelegramListener(_0x4f7321),setTimeout(()=>checkWifiPresence(_0x4f7321),0x1388);if(_0x4f7321[_0x33434e(0xb9)])clearInterval(_0x4f7321[_0x33434e(0xb9)]);const _0x864532=_0x4f7321[_0x33434e(0xdb)][_0x33434e(0x20a)]||0xf;_0x864532>0x0&&(_0x4f7321[_0x33434e(0xb9)]=setInterval(()=>{runAutopilot(_0x4f7321);},_0x864532*0x3c*0x3e8)),schedulers[_0x33434e(0x19a)](_0x4f7321,()=>createDailyDigest(_0x4f7321)),schedulers[_0x33434e(0x1da)](_0x4f7321),schedulers['setupDriftAnalysisScheduler'](_0x4f7321,()=>runBaselineDriftAnalysis(_0x4f7321)),schedulers[_0x33434e(0x1c5)](_0x4f7321,()=>sendMorningBriefing(_0x4f7321)),startPythonService(_0x4f7321),setTimeout(()=>{_0x4f7321['pythonProcess']&&(runPythonHealthCheck(_0x4f7321),triggerGaitAnalysis(_0x4f7321),triggerEnergyPrediction(_0x4f7321)),updateHealthVector(_0x4f7321);},0x1388);}class CogniLiving extends utils[a0_0x2ae9cf(0x166)]{constructor(_0x38b04f){const _0x3ce233=a0_0x2ae9cf;super({..._0x38b04f,'name':_0x3ce233(0x1bc)}),this[_0x3ce233(0x1cd)]=[],this[_0x3ce233(0xc9)]=[],this[_0x3ce233(0x1d4)]=[],this[_0x3ce233(0x1a0)]=[],this['sensorLastValues']={},this[_0x3ce233(0x208)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x3ce233(0x14a)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this[_0x3ce233(0x20e)]=null,this[_0x3ce233(0x19b)]=null,this[_0x3ce233(0xae)]=SYSTEM_MODES[_0x3ce233(0x11b)],this[_0x3ce233(0x10e)]=![],this[_0x3ce233(0xff)]=![],this[_0x3ce233(0x1ba)]='unknown',this[_0x3ce233(0xb9)]=null,this['ltmJob']=null,this[_0x3ce233(0x217)]=null,this[_0x3ce233(0x1df)]=null,this['briefingJob']=null,this[_0x3ce233(0x1d8)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x3ce233(0x210),this[_0x3ce233(0x141)][_0x3ce233(0x1b9)](this)),this['on'](_0x3ce233(0x10a),this['onStateChange'][_0x3ce233(0x1b9)](this)),this['on'](_0x3ce233(0x111),this[_0x3ce233(0xe9)][_0x3ce233(0x1b9)](this)),this['on'](_0x3ce233(0xcd),this['onMessage'][_0x3ce233(0x1b9)](this));}async['onReady'](){const _0x201a6a=a0_0x2ae9cf;this[_0x201a6a(0x105)]['info']('cogni-living\x20adapter\x20starting\x20(v'+this[_0x201a6a(0x12b)]+')\x20-\x20SAFE\x20BOOT');if(!installer[_0x201a6a(0x20c)](this,()=>startSystem(this)))return;}[a0_0x2ae9cf(0xe9)](_0x31fe09){const _0x4360ee=a0_0x2ae9cf;if(this['analysisTimer'])clearInterval(this[_0x4360ee(0xb9)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x4360ee(0x1df)]);if(this[_0x4360ee(0xbb)])this[_0x4360ee(0xbb)][_0x4360ee(0x1f4)]();if(this[_0x4360ee(0x217)])this[_0x4360ee(0x217)]['cancel']();if(this[_0x4360ee(0x152)])this[_0x4360ee(0x152)]['cancel']();if(this[_0x4360ee(0x107)])clearTimeout(this[_0x4360ee(0x107)]);if(this[_0x4360ee(0x159)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x31fe09();}async[a0_0x2ae9cf(0x178)](_0x32ac85,_0x2c3c7b){const _0x58ae2c=a0_0x2ae9cf;if(!_0x2c3c7b||this[_0x58ae2c(0x9c)])return;if(_0x32ac85[_0x58ae2c(0x21b)](_0x58ae2c(0x1b3))&&_0x32ac85[_0x58ae2c(0x97)](_0x58ae2c(0x18f))&&_0x2c3c7b[_0x58ae2c(0x1ea)]){await handleTelegramResponse(this,_0x2c3c7b[_0x58ae2c(0x1ea)]);return;}if(_0x32ac85===this[_0x58ae2c(0x1b8)]+'.'+SYSTEM_DP_MODE){if(_0x2c3c7b[_0x58ae2c(0x1ea)]&&Object[_0x58ae2c(0x1d1)](SYSTEM_MODES)[_0x58ae2c(0x21b)](_0x2c3c7b[_0x58ae2c(0x1ea)])){this['currentSystemMode']=_0x2c3c7b[_0x58ae2c(0x1ea)];if(_0x2c3c7b[_0x58ae2c(0x1ea)]===SYSTEM_MODES[_0x58ae2c(0xb5)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x2c3c7b['ack'])this[_0x58ae2c(0x151)](_0x32ac85,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x2c3c7b[_0x58ae2c(0xbd)]){_0x32ac85[_0x58ae2c(0x21b)](_0x58ae2c(0xdc))&&_0x2c3c7b[_0x58ae2c(0x1ea)]&&(this[_0x58ae2c(0x151)](_0x32ac85,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x32ac85[_0x58ae2c(0x21b)](_0x58ae2c(0x9f))&&_0x2c3c7b[_0x58ae2c(0x1ea)]){this[_0x58ae2c(0x151)](_0x32ac85,{'val':![],'ack':!![]});if(this[_0x58ae2c(0x10e)])createDailyDigest(this);}_0x32ac85['includes'](_0x58ae2c(0x1d3))&&_0x2c3c7b['val']&&(this[_0x58ae2c(0x151)](_0x32ac85,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x32ac85['includes'](_0x58ae2c(0xb3))&&_0x2c3c7b['val']&&(this[_0x58ae2c(0x151)](_0x32ac85,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x32ac85[_0x58ae2c(0x21b)](_0x58ae2c(0x113))&&_0x2c3c7b[_0x58ae2c(0x1ea)]){this[_0x58ae2c(0x151)](_0x32ac85,{'val':![],'ack':!![]});if(this[_0x58ae2c(0x10e)])try{const _0xbd5afd=await this[_0x58ae2c(0x1e2)](_0x58ae2c(0x1e7));if(_0xbd5afd&&_0xbd5afd['val']){const _0x3500a3=JSON['parse'](_0xbd5afd['val']);this[_0x58ae2c(0x105)][_0x58ae2c(0xb4)](_0x58ae2c(0x14e)),this['setStateAsync'](_0x58ae2c(0x126),{'val':_0x58ae2c(0x132),'ack':!![]}),sendToPython(this,_0x58ae2c(0xce),{'sequences':_0x3500a3});}}catch(_0x4a5f26){this[_0x58ae2c(0x105)][_0x58ae2c(0xea)](_0x58ae2c(0x148)+_0x4a5f26[_0x58ae2c(0xcd)]);}}if(_0x32ac85[_0x58ae2c(0x21b)](_0x58ae2c(0x21a))&&_0x2c3c7b[_0x58ae2c(0x1ea)]){this[_0x58ae2c(0x151)](_0x32ac85,{'val':![],'ack':!![]});if(this[_0x58ae2c(0x10e)])try{const _0x46ed75=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x46ed75&&_0x46ed75[_0x58ae2c(0x1ea)])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0x58ae2c(0xe4)](_0x46ed75[_0x58ae2c(0x1ea)])});}catch(_0x55f7ad){}}if(_0x32ac85[_0x58ae2c(0x21b)]('analysis.training.triggerEnergy')&&_0x2c3c7b[_0x58ae2c(0x1ea)]){this['setState'](_0x32ac85,{'val':![],'ack':!![]});if(this[_0x58ae2c(0x10e)])try{const _0x2a1582=await this[_0x58ae2c(0x1e2)](_0x58ae2c(0x1c0));if(_0x2a1582&&_0x2a1582[_0x58ae2c(0x1ea)])sendToPython(this,_0x58ae2c(0x15a),{'points':JSON['parse'](_0x2a1582[_0x58ae2c(0x1ea)])});}catch(_0x116df5){}}if(_0x32ac85[_0x58ae2c(0x21b)]('analysis.training.triggerComfort')&&_0x2c3c7b['val']){this[_0x58ae2c(0x151)](_0x32ac85,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x5b2d70=await this[_0x58ae2c(0x1e2)](LTM_DP_RAW_LOG);_0x5b2d70&&_0x5b2d70[_0x58ae2c(0x1ea)]&&(this[_0x58ae2c(0x105)][_0x58ae2c(0xb4)]('ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...'),sendToPython(this,'TRAIN_COMFORT',{'events':JSON[_0x58ae2c(0xe4)](_0x5b2d70[_0x58ae2c(0x1ea)])}));}catch(_0x1ab126){}}if(_0x32ac85['includes']('analysis.training.triggerTopology')&&_0x2c3c7b['val']){this['setState'](_0x32ac85,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x1fe1f8=await this[_0x58ae2c(0x1e2)](_0x58ae2c(0x1e7));if(_0x1fe1f8&&_0x1fe1f8[_0x58ae2c(0x1ea)]){const _0x345878=JSON[_0x58ae2c(0xe4)](_0x1fe1f8[_0x58ae2c(0x1ea)]);this[_0x58ae2c(0x105)][_0x58ae2c(0xb4)]('ðŸ•¸ï¸\x20Building\x20Topology\x20Matrix...'),sendToPython(this,_0x58ae2c(0x17d),{'sequences':_0x345878});}}catch(_0x536ece){this['log'][_0x58ae2c(0xea)](_0x58ae2c(0x101)+_0x536ece[_0x58ae2c(0xcd)]);}}return;}if(this[_0x58ae2c(0xdb)][_0x58ae2c(0xc4)]&&this[_0x58ae2c(0xdb)][_0x58ae2c(0xc4)][_0x58ae2c(0x21b)](_0x32ac85)){await checkWifiPresence(this);return;}const _0x22204b=(this[_0x58ae2c(0xdb)][_0x58ae2c(0x123)]||[])[_0x58ae2c(0xf2)](_0x4ccee2=>_0x4ccee2['id']===_0x32ac85);if(_0x22204b)processSensorEvent(this,_0x32ac85,_0x2c3c7b,_0x22204b);}async[a0_0x2ae9cf(0x220)](_0x1aa30e){const _0x361411=a0_0x2ae9cf;if(typeof _0x1aa30e==='object'&&_0x1aa30e['message']){if(_0x1aa30e[_0x361411(0x1e1)]===_0x361411(0x1f2)){const _0x426f70=_0x1aa30e[_0x361411(0xcd)][_0x361411(0x19c)]||this[_0x361411(0xdb)]['geminiApiKey'];if(!_0x426f70)return this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':![],'message':_0x361411(0x211)},_0x1aa30e[_0x361411(0x1c7)]);try{const _0x3c7294=new GoogleGenerativeAI(_0x426f70),_0x1b42b1=_0x3c7294[_0x361411(0x118)]({'model':GEMINI_MODEL}),_0x487509=await _0x1b42b1[_0x361411(0x1a6)]('Hi');this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e['command'],{'success':!![],'message':_0x361411(0x16e)+_0x487509['response'][_0x361411(0x1b6)]()},_0x1aa30e[_0x361411(0x1c7)]);}catch(_0x51a7c5){this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':![],'message':_0x361411(0x227)+_0x51a7c5[_0x361411(0xcd)]},_0x1aa30e[_0x361411(0x1c7)]);}}else{if(_0x1aa30e['command']===_0x361411(0xd1)){const _0x1b8103=await getWeatherContext(this),_0x3c9ac3=await getCalendarContext(this);this[_0x361411(0x1c3)](_0x1aa30e['from'],_0x1aa30e[_0x361411(0x1e1)],{'success':!![],'weather':_0x1b8103,'calendar':_0x3c9ac3},_0x1aa30e[_0x361411(0x1c7)]);}else{if(_0x1aa30e['command']===_0x361411(0x1b1)){if(!this[_0x361411(0x10e)])return this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':![],'isPro':![]},_0x1aa30e[_0x361411(0x1c7)]);let _0x207421={'status':_0x361411(0xd6)};try{const _0x1bae41=await this[_0x361411(0x1e2)](LTM_DP_DRIFT_STATUS);_0x207421[_0x361411(0x212)]=_0x1bae41?_0x1bae41[_0x361411(0x1ea)]:_0x361411(0xd6);}catch(_0x236818){}this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x361411(0x1a0)],'driftAnalysis':_0x207421,'analysisHistory':this[_0x361411(0xc9)]},_0x1aa30e[_0x361411(0x1c7)]);}else{if(_0x1aa30e['command']===_0x361411(0x155)){const _0x325563=this[_0x361411(0x1a0)][_0x361411(0xd0)],_0x278b0f=new Date(),_0x5335ee=new Date(_0x278b0f['getFullYear'](),_0x278b0f[_0x361411(0x1ec)](),_0x278b0f['getDate']())[_0x361411(0x160)](),_0x13c989=this[_0x361411(0x1d4)][_0x361411(0xc1)](_0x2acae3=>new Date(_0x2acae3[_0x361411(0x1f3)])[_0x361411(0x160)]()>_0x5335ee)[_0x361411(0xd0)],_0x362b1d=new Array(0x18)[_0x361411(0x116)](0x0);this[_0x361411(0x1d4)]['forEach'](_0x10a92e=>{const _0x2f32c5=_0x361411,_0x2ab9e0=new Date(_0x10a92e[_0x2f32c5(0x1f3)]);if(_0x2ab9e0[_0x2f32c5(0x160)]()>_0x5335ee)_0x362b1d[_0x2ab9e0[_0x2f32c5(0x1ee)]()]++;});let _0x3606b2={'status':_0x361411(0xd6)};try{const _0x2606ea=await this[_0x361411(0x1e2)](LTM_DP_DRIFT_STATUS);_0x3606b2[_0x361411(0x212)]=_0x2606ea?_0x2606ea[_0x361411(0x1ea)]:_0x361411(0xd6);}catch(_0x54e6b9){}let _0x26bdee='';try{const _0x2e211f=await this['getStateAsync'](_0x361411(0x21d));_0x26bdee=_0x2e211f?_0x2e211f['val']:'';}catch(_0xa18c8a){}let _0x35f87f=null;!this[_0x361411(0x19b)]&&(_0x35f87f=this[_0x361411(0xdb)][_0x361411(0x223)]?'KI-Modell\x20nicht\x20initialisiert':_0x361411(0x221));let _0x1528ae={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x117a13=await this[_0x361411(0x1e2)]('analysis.automation.patternDetected');if(_0x117a13&&_0x117a13[_0x361411(0x1ea)]){_0x1528ae[_0x361411(0xb1)]=!![];const _0x3d783c=await this['getStateAsync'](_0x361411(0x225));_0x1528ae[_0x361411(0x98)]=_0x3d783c?_0x3d783c[_0x361411(0x1ea)]:'';const _0x1098b3=await this[_0x361411(0x1e2)]('analysis.automation.targetId');_0x1528ae[_0x361411(0xd5)]=_0x1098b3?_0x1098b3[_0x361411(0x1ea)]:'';const _0x4d0ef0=await this[_0x361411(0x1e2)](_0x361411(0xac));_0x1528ae['targetValue']=_0x4d0ef0?_0x4d0ef0['val']:'';}const _0x148840=await this[_0x361411(0x1e2)](_0x361411(0x1c8));_0x1528ae[_0x361411(0xa7)]=_0x148840?!!_0x148840[_0x361411(0x1ea)]:![];}catch(_0x5a6b60){}this[_0x361411(0x1c3)](_0x1aa30e['from'],_0x1aa30e[_0x361411(0x1e1)],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0xf),'stats':{'digestCount':_0x325563,'eventCountToday':_0x13c989,'hourlyActivity':_0x362b1d,'driftStatus':_0x3606b2[_0x361411(0x212)],'isPresent':this[_0x361411(0x14a)],'presenceWho':_0x26bdee,'minDays':this[_0x361411(0xdb)][_0x361411(0x16c)]||0x7,'stbDays':this[_0x361411(0xdb)]['ltmStbWindowDays']||0xe,'ltbDays':this['config']['ltmLtbWindowDays']||0x3c,'systemError':_0x35f87f},'automation':_0x1528ae},_0x1aa30e[_0x361411(0x1c7)]);}else{if(_0x1aa30e[_0x361411(0x1e1)]==='scanDevices')try{const _0x3c389=await scanner[_0x361411(0x1d2)](this,_0x1aa30e['message']||{});this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':!![],'devices':_0x3c389},_0x1aa30e['callback']);}catch(_0x4b5255){this['sendTo'](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':![],'error':_0x4b5255[_0x361411(0xcd)]},_0x1aa30e['callback']);}else{if(_0x1aa30e[_0x361411(0x1e1)]===_0x361411(0x190)){const _0x2d0251=await this[_0x361411(0xb2)](_0x361411(0x11a),'enum'),_0x153664=[];if(_0x2d0251)for(const _0x433bfe in _0x2d0251){const _0x878524=_0x2d0251[_0x433bfe],_0x37d98a=(_0x878524['common']&&typeof _0x878524[_0x361411(0xa6)]['name']==='object'?_0x878524[_0x361411(0xa6)][_0x361411(0x1e9)]['de']:_0x878524['common'][_0x361411(0x1e9)])||_0x878524[_0x361411(0xa6)][_0x361411(0x1e9)];_0x153664['push']({'id':_0x433bfe,'name':_0x37d98a});}const _0xbb5cc8=await this[_0x361411(0xb2)](_0x361411(0x1c4),_0x361411(0xd8)),_0x23bc7e=[];if(_0xbb5cc8)for(const _0x234ed4 in _0xbb5cc8){const _0x3626fb=_0xbb5cc8[_0x234ed4],_0x5624bd=(_0x3626fb['common']&&typeof _0x3626fb[_0x361411(0xa6)]['name']===_0x361411(0x17e)?_0x3626fb[_0x361411(0xa6)][_0x361411(0x1e9)]['de']:_0x3626fb['common'][_0x361411(0x1e9)])||_0x234ed4[_0x361411(0x188)]('.')[_0x361411(0x10b)]();_0x23bc7e['push'](_0x5624bd);}this[_0x361411(0x1c3)](_0x1aa30e['from'],_0x1aa30e['command'],{'success':!![],'enums':_0x153664,'rooms':_0x23bc7e},_0x1aa30e[_0x361411(0x1c7)]);}else{if(_0x1aa30e[_0x361411(0x1e1)]===_0x361411(0x196)){const _0x338a73=_0x1aa30e[_0x361411(0xcd)][_0x361411(0xc5)];if(!_0x338a73)return this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':![],'error':_0x361411(0x179)},_0x1aa30e[_0x361411(0x1c7)]);const _0x3dbf32=await getCalendarNames(this,_0x338a73);this[_0x361411(0x1c3)](_0x1aa30e['from'],_0x1aa30e[_0x361411(0x1e1)],{'success':!![],'names':_0x3dbf32},_0x1aa30e[_0x361411(0x1c7)]);}else{if(_0x1aa30e[_0x361411(0x1e1)]==='simulateButler'){const {targetId:_0x5e878d,targetValue:_0x448a2d}=_0x1aa30e['message'];this[_0x361411(0x105)][_0x361411(0xb4)](_0x361411(0x1a1)+_0x5e878d+_0x361411(0x1f1)+_0x448a2d),await this[_0x361411(0x1d5)](_0x361411(0x115),{'val':!![],'ack':!![]}),await this[_0x361411(0x1d5)]('analysis.automation.description',{'val':_0x361411(0xd7)+_0x5e878d,'ack':!![]}),await this[_0x361411(0x1d5)](_0x361411(0x9e),{'val':_0x5e878d,'ack':!![]}),await this[_0x361411(0x1d5)]('analysis.automation.targetValue',{'val':_0x448a2d,'ack':!![]}),this['sendTo'](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':!![]},_0x1aa30e[_0x361411(0x1c7)]);}else{if(_0x1aa30e[_0x361411(0x1e1)]===_0x361411(0xb7)){const {historyId:_0x4fcfa6,rating:_0x52bcec,comment:_0x327061,alertReason:_0x35244}=_0x1aa30e[_0x361411(0xcd)];_0x4fcfa6&&_0x52bcec?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x4fcfa6,'rating':_0x52bcec,'comment':_0x327061,'alertReason':_0x35244}),this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':!![]},_0x1aa30e[_0x361411(0x1c7)])):this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e['command'],{'success':![],'error':_0x361411(0x173)},_0x1aa30e[_0x361411(0x1c7)]);}else _0x1aa30e[_0x361411(0x1e1)]==='dismissAutomation'&&(this['log']['info']('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x361411(0x115),{'val':![],'ack':!![]}),await this[_0x361411(0x1d5)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x361411(0x1c3)](_0x1aa30e[_0x361411(0x21e)],_0x1aa30e[_0x361411(0x1e1)],{'success':!![]},_0x1aa30e[_0x361411(0x1c7)]));}}}}}}}}}}}if(require[a0_0x2ae9cf(0x184)]!==module)module['exports']=_0x21c8b0=>new CogniLiving(_0x21c8b0);else new CogniLiving();