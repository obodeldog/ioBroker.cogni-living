const a0_0xe721b5=a0_0x57e6;(function(_0x5b79ad,_0x383664){const _0x40bc2a=a0_0x57e6,_0x51cced=_0x5b79ad();while(!![]){try{const _0x646302=parseInt(_0x40bc2a(0x1cd))/0x1*(parseInt(_0x40bc2a(0x229))/0x2)+parseInt(_0x40bc2a(0x17c))/0x3*(-parseInt(_0x40bc2a(0x239))/0x4)+parseInt(_0x40bc2a(0x345))/0x5+parseInt(_0x40bc2a(0x24e))/0x6+parseInt(_0x40bc2a(0x22f))/0x7+parseInt(_0x40bc2a(0x24a))/0x8+parseInt(_0x40bc2a(0x304))/0x9*(-parseInt(_0x40bc2a(0x290))/0xa);if(_0x646302===_0x383664)break;else _0x51cced['push'](_0x51cced['shift']());}catch(_0x34a960){_0x51cced['push'](_0x51cced['shift']());}}}(a0_0x13e4,0xef747));const a0_0x1a782e=(function(){let _0x50711c=!![];return function(_0xa9117a,_0x24851c){const _0x3c95b4=_0x50711c?function(){const _0x52048f=a0_0x57e6;if(_0x24851c){const _0x1d0a17=_0x24851c[_0x52048f(0x262)](_0xa9117a,arguments);return _0x24851c=null,_0x1d0a17;}}:function(){};return _0x50711c=![],_0x3c95b4;};}()),a0_0x5ae043=a0_0x1a782e(this,function(){const _0x42a6c4=a0_0x57e6;return a0_0x5ae043[_0x42a6c4(0x333)]()[_0x42a6c4(0x221)](_0x42a6c4(0x310))['toString']()['constructor'](a0_0x5ae043)[_0x42a6c4(0x221)](_0x42a6c4(0x310));});a0_0x5ae043();'use strict';const utils=require(a0_0xe721b5(0x375)),{GoogleGenerativeAI}=require(a0_0xe721b5(0x1df)),schedule=require(a0_0xe721b5(0x1a4)),{spawn,exec}=require(a0_0xe721b5(0x2fd)),path=require('path'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0xe721b5(0x366),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0xe721b5(0x1b8),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0xe721b5(0x2ae),LTM_DP_DAILY_DIGESTS=a0_0xe721b5(0x173),LTM_DP_STATUS=a0_0xe721b5(0x30e),LTM_DP_TRIGGER_DIGEST=a0_0xe721b5(0x2b6),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0xe721b5(0x1f9),LTM_DP_DRIFT_STATUS=a0_0xe721b5(0x2a9),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0xe721b5(0x18b),SYSTEM_DP_MODE=a0_0xe721b5(0x347),HARD_IGNORE_TERMS=[a0_0xe721b5(0x374),a0_0xe721b5(0x22b),'update',a0_0xe721b5(0x29a),a0_0xe721b5(0x2b5),a0_0xe721b5(0x1e9),a0_0xe721b5(0x1cf),a0_0xe721b5(0x1a9),a0_0xe721b5(0x279),a0_0xe721b5(0x180),a0_0xe721b5(0x36f),a0_0xe721b5(0x285),'stick_unreach',a0_0xe721b5(0x263),a0_0xe721b5(0x1d2),'firmware',a0_0xe721b5(0x370),a0_0xe721b5(0x24f)],BAD_NAMES=[a0_0xe721b5(0x200),a0_0xe721b5(0x295),'state',a0_0xe721b5(0x278),a0_0xe721b5(0x34d),a0_0xe721b5(0x29d),'on',a0_0xe721b5(0x226),a0_0xe721b5(0x334),a0_0xe721b5(0x33d),a0_0xe721b5(0x17a),'blind','cover','status',a0_0xe721b5(0x17d),a0_0xe721b5(0x348),'occupancy',a0_0xe721b5(0x1bf),'humidity','power',a0_0xe721b5(0x1f0),a0_0xe721b5(0x1f2),a0_0xe721b5(0x2c8),a0_0xe721b5(0x1fe),'set_temperature'],ADAPTER_BLACKLIST=[a0_0xe721b5(0x330),a0_0xe721b5(0x1b2),a0_0xe721b5(0x18a),'vis.',a0_0xe721b5(0x1a1),a0_0xe721b5(0x313),a0_0xe721b5(0x2ab),'flot.',a0_0xe721b5(0x305),a0_0xe721b5(0x2cf),a0_0xe721b5(0x2f5)],SYSTEM_MODES={'NORMAL':a0_0xe721b5(0x2f9),'VACATION':a0_0xe721b5(0x2ad),'PARTY':'party','GUEST':a0_0xe721b5(0x2d1)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0xe721b5(0x238),'senior_aal':a0_0xe721b5(0x29f),'family':a0_0xe721b5(0x1b7),'single_comfort':a0_0xe721b5(0x1d4),'security':a0_0xe721b5(0x1ce)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0xc7611b){const _0x4fadfe=a0_0xe721b5;try{const _0x130358=[_0x4fadfe(0x186),_0x4fadfe(0x1c5)];for(const _0x52ef3d of _0x130358){try{const _0x82d0d4=await _0xc7611b[_0x4fadfe(0x232)](_0x52ef3d);_0x82d0d4&&await _0xc7611b[_0x4fadfe(0x26a)](_0x52ef3d);}catch(_0x110306){}}}catch(_0xb06d42){}}async function initHistory(_0x2da874){const _0x27cf34=a0_0xe721b5;try{const _0x485d55=await _0x2da874[_0x27cf34(0x1d6)](_0x27cf34(0x2dd));_0x485d55&&_0x485d55[_0x27cf34(0x2c6)]&&(_0x2da874['eventHistory']=JSON[_0x27cf34(0x34e)](_0x485d55[_0x27cf34(0x2c6)][_0x27cf34(0x333)]()));}catch(_0x5f37ad){_0x2da874['eventHistory']=[];}try{const _0x4968cf=await _0x2da874[_0x27cf34(0x1d6)](_0x27cf34(0x187));if(_0x4968cf&&_0x4968cf[_0x27cf34(0x2c6)])_0x2da874[_0x27cf34(0x198)]=JSON[_0x27cf34(0x34e)](_0x4968cf[_0x27cf34(0x2c6)][_0x27cf34(0x333)]());}catch(_0x4c1ee7){_0x2da874[_0x27cf34(0x198)]=[];}if(_0x2da874[_0x27cf34(0x28a)]&&_0x2da874[_0x27cf34(0x28a)][_0x27cf34(0x2e3)]>0x0){_0x2da874[_0x27cf34(0x191)]['info'](_0x27cf34(0x1af)+_0x2da874[_0x27cf34(0x28a)][_0x27cf34(0x2e3)]+_0x27cf34(0x1ad));for(let _0x52ad47=_0x2da874['eventHistory'][_0x27cf34(0x2e3)]-0x1;_0x52ad47>=0x0;_0x52ad47--){const _0x12f535=_0x2da874[_0x27cf34(0x28a)][_0x52ad47];_0x12f535&&_0x12f535['id']!==undefined&&_0x12f535[_0x27cf34(0x34d)]!==undefined&&(_0x2da874[_0x27cf34(0x227)][_0x12f535['id']]=_0x12f535[_0x27cf34(0x34d)]);}}}async function initSystemConfig(_0x271538){const _0x28a391=a0_0xe721b5;try{const _0x1d261d=await _0x271538[_0x28a391(0x35a)](_0x28a391(0x2fb));_0x1d261d&&_0x1d261d['common']&&(_0x271538[_0x28a391(0x323)]={'latitude':_0x1d261d[_0x28a391(0x1a7)][_0x28a391(0x2d7)]||0x0,'longitude':_0x1d261d['common'][_0x28a391(0x2e1)]||0x0,'city':_0x1d261d[_0x28a391(0x1a7)][_0x28a391(0x298)]||''});}catch(_0x241e42){}}async function checkLicense(_0x4cb456,_0x4238d5){const _0x492308=a0_0xe721b5;if(!_0x4238d5)return![];_0x4cb456['systemUUID']=await getSystemUUID(_0x4cb456);if(_0x4238d5==='TEST-PRO-KEY'||_0x4238d5[_0x492308(0x292)]('PRO-'))return!![];return![];}async function getSystemUUID(_0x5f120e){const _0x3596db=a0_0xe721b5;try{const _0x2093b7=await _0x5f120e[_0x3596db(0x35a)](_0x3596db(0x1cc));if(_0x2093b7&&_0x2093b7[_0x3596db(0x22a)]&&_0x2093b7[_0x3596db(0x22a)][_0x3596db(0x284)])return _0x2093b7['native'][_0x3596db(0x284)];return _0x3596db(0x178);}catch(_0x4e3a73){return'uuid-error';}}async function createAllObjects(_0x51c32d){const _0x580cc7=a0_0xe721b5;await checkSystemObjects(_0x51c32d),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x302),{'type':_0x580cc7(0x1a6),'common':{'name':'Who\x20is\x20present?','type':'string','role':_0x580cc7(0x2d8),'read':!![],'write':![],'def':''},'native':{}}),await _0x51c32d['setObjectNotExistsAsync'](_0x580cc7(0x276),{'type':_0x580cc7(0x1a6),'common':{'name':'Last\x20raw\x20event','type':'string','role':_0x580cc7(0x300),'read':!![],'write':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x2dd),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x17e),'type':_0x580cc7(0x183),'role':'json','read':!![],'write':![]},'native':{}}),await _0x51c32d['setObjectNotExistsAsync'](_0x580cc7(0x2e2),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x31a),'type':'boolean','role':_0x580cc7(0x311),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)]('analysis.triggerBriefing',{'type':'state','common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x580cc7(0x1da),'role':_0x580cc7(0x311),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x192),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x264),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x51c32d['setObjectNotExistsAsync'](_0x580cc7(0x2a3),{'type':_0x580cc7(0x1a6),'common':{'name':'AI\x20Alert\x20Status','type':'boolean','role':_0x580cc7(0x2b8),'read':!![],'write':![],'def':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)]('analysis.isEmergency',{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x271),'type':'boolean','role':_0x580cc7(0x170),'read':!![],'write':![],'def':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)]('analysis.alertReason',{'type':'state','common':{'name':'Alert\x20Reason','type':_0x580cc7(0x183),'role':_0x580cc7(0x360),'read':!![],'write':![]},'native':{}}),await _0x51c32d['setObjectNotExistsAsync']('analysis.activitySummary',{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x1ef),'type':_0x580cc7(0x183),'role':_0x580cc7(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)]('analysis.deviationFromBaseline',{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x2e9),'type':_0x580cc7(0x183),'role':_0x580cc7(0x1a6),'read':!![],'write':![],'def':_0x580cc7(0x2e5)},'native':{}}),await _0x51c32d['setObjectNotExistsAsync'](_0x580cc7(0x326),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x35e),'type':_0x580cc7(0x183),'role':_0x580cc7(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x288),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x2eb),'type':_0x580cc7(0x183),'role':_0x580cc7(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x171)]('analysis.automation',{'type':'channel','common':{'name':_0x580cc7(0x24d)},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)]('analysis.automation.patternDetected',{'type':_0x580cc7(0x1a6),'common':{'name':'Pattern\x20Detected','type':_0x580cc7(0x1da),'role':_0x580cc7(0x33f),'read':!![],'write':![],'def':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x204),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x365),'type':_0x580cc7(0x183),'role':_0x580cc7(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)]('analysis.automation.suggestedAction',{'type':_0x580cc7(0x1a6),'common':{'name':'Action','type':_0x580cc7(0x183),'role':_0x580cc7(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x1ea),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x176),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x318),{'type':'state','common':{'name':_0x580cc7(0x1b3),'type':_0x580cc7(0x183),'role':_0x580cc7(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x51c32d['setObjectNotExistsAsync']('analysis.automation.autoApply',{'type':_0x580cc7(0x1a6),'common':{'name':'Auto\x20Apply\x20Rule','type':'boolean','role':_0x580cc7(0x334),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x367),{'type':'state','common':{'name':'Trigger\x20Action\x20Now','type':_0x580cc7(0x1da),'role':_0x580cc7(0x311),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x187),{'type':'state','common':{'name':_0x580cc7(0x1aa),'type':_0x580cc7(0x183),'role':_0x580cc7(0x300),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x338),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x33e),'type':_0x580cc7(0x183),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x51c32d[_0x580cc7(0x171)]('analysis.health',{'type':_0x580cc7(0x231),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x1d7),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x308),'type':_0x580cc7(0x236),'role':_0x580cc7(0x193),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x51c32d['setObjectNotExistsAsync'](_0x580cc7(0x240),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x235),'type':_0x580cc7(0x183),'role':_0x580cc7(0x2d8),'read':!![],'write':![],'def':_0x580cc7(0x266)},'native':{}}),await _0x51c32d['setObjectNotExistsAsync']('analysis.health.notes',{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x2d6),'type':_0x580cc7(0x183),'role':_0x580cc7(0x2d8),'read':!![],'write':![],'def':''},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)]('analysis.health.trendDiagnosis',{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x1eb),'type':_0x580cc7(0x183),'role':'text','read':!![],'write':![],'def':_0x580cc7(0x2e5)},'native':{}}),await _0x51c32d['setObjectNotExistsAsync']('analysis.health.trendValue',{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x2b4),'type':_0x580cc7(0x236),'role':_0x580cc7(0x34d),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x51c32d[_0x580cc7(0x171)](_0x580cc7(0x1d3),{'type':_0x580cc7(0x231),'common':{'name':_0x580cc7(0x272)},'native':{}}),await _0x51c32d['setObjectNotExistsAsync'](_0x580cc7(0x257),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x1c6),'type':'string','role':'json','read':!![],'write':![],'def':'[]','desc':'Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training'},'native':{}}),await _0x51c32d[_0x580cc7(0x17f)](_0x580cc7(0x306),{'type':_0x580cc7(0x1a6),'common':{'name':_0x580cc7(0x2bb),'type':'string','role':_0x580cc7(0x300),'read':!![],'write':![],'def':'[]','desc':'Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time'},'native':{}}),await checkLtmObjects(_0x51c32d),await checkLtmDriftObjects(_0x51c32d);}async function checkSystemObjects(_0x4dce5f){const _0x10b111=a0_0xe721b5;await _0x4dce5f[_0x10b111(0x171)](_0x10b111(0x2c1),{'type':_0x10b111(0x231),'common':{'name':_0x10b111(0x1ac)},'native':{}}),await _0x4dce5f[_0x10b111(0x171)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x10b111(0x281),'type':_0x10b111(0x183),'role':_0x10b111(0x1a6),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x10b111(0x26b)],'states':{[SYSTEM_MODES['NORMAL']]:_0x10b111(0x2bf),[SYSTEM_MODES['VACATION']]:'Urlaub',[SYSTEM_MODES[_0x10b111(0x203)]]:_0x10b111(0x331),[SYSTEM_MODES[_0x10b111(0x249)]]:_0x10b111(0x303)}},'native':{}});}async function checkLtmObjects(_0x3a94f6){const _0x111a31=a0_0xe721b5;await _0x3a94f6[_0x111a31(0x171)](_0x111a31(0x32f),{'type':_0x111a31(0x231),'common':{'name':_0x111a31(0x32f)},'native':{}}),await _0x3a94f6['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x111a31(0x1a6),'common':{'name':'Raw\x20Log','type':'string','role':_0x111a31(0x300),'read':!![],'write':![]},'native':{}}),await _0x3a94f6[_0x111a31(0x171)](LTM_DP_DAILY_DIGESTS,{'type':_0x111a31(0x1a6),'common':{'name':_0x111a31(0x1d0),'type':'string','role':_0x111a31(0x300),'read':!![],'write':![]},'native':{}}),await _0x3a94f6[_0x111a31(0x171)](LTM_DP_STATUS,{'type':_0x111a31(0x1a6),'common':{'name':'Processing\x20Status','type':_0x111a31(0x183),'role':_0x111a31(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x3a94f6[_0x111a31(0x171)](LTM_DP_TRIGGER_DIGEST,{'type':_0x111a31(0x1a6),'common':{'name':'Trigger\x20Digest','type':'boolean','role':_0x111a31(0x311),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3a94f6[_0x111a31(0x171)](LTM_DP_BASELINE_STATUS,{'type':_0x111a31(0x1a6),'common':{'name':_0x111a31(0x1b5),'type':_0x111a31(0x183),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x25cec2){const _0x16272c=a0_0xe721b5;await _0x25cec2[_0x16272c(0x171)](LTM_DP_DRIFT_CHANNEL,{'type':_0x16272c(0x231),'common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x25cec2[_0x16272c(0x171)](LTM_DP_DRIFT_STATUS,{'type':_0x16272c(0x1a6),'common':{'name':_0x16272c(0x201),'type':'string','role':_0x16272c(0x1a6),'read':!![],'write':![],'def':_0x16272c(0x2e5)},'native':{}}),await _0x25cec2[_0x16272c(0x171)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':_0x16272c(0x183),'role':_0x16272c(0x2d8),'read':!![],'write':![]},'native':{}}),await _0x25cec2[_0x16272c(0x171)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x16272c(0x1f7),'type':_0x16272c(0x236),'role':_0x16272c(0x315),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x21946f){const _0x138660=a0_0xe721b5;try{const _0x5ed162=await _0x21946f[_0x138660(0x1d6)](SYSTEM_DP_MODE);_0x5ed162&&_0x5ed162['val']&&Object[_0x138660(0x29b)](SYSTEM_MODES)[_0x138660(0x28e)](_0x5ed162['val'])?_0x21946f[_0x138660(0x34f)]=_0x5ed162['val']:(_0x21946f[_0x138660(0x34f)]=SYSTEM_MODES[_0x138660(0x26b)],await _0x21946f['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x138660(0x26b)],'ack':!![]}));}catch(_0x5768fe){_0x21946f['currentSystemMode']=SYSTEM_MODES[_0x138660(0x26b)];}}async function loadRawEventLog(_0x2482b1){const _0x5e7fe5=a0_0xe721b5;try{const _0x56a2fd=await _0x2482b1[_0x5e7fe5(0x1d6)](LTM_DP_RAW_LOG);if(_0x56a2fd&&_0x56a2fd['val'])_0x2482b1[_0x5e7fe5(0x268)]=JSON[_0x5e7fe5(0x34e)](_0x56a2fd[_0x5e7fe5(0x2c6)]);}catch(_0x3f535d){_0x2482b1['rawEventLog']=[];}}async function saveRawEventLog(_0x2c00a0){const _0x3ff47=a0_0xe721b5;_0x2c00a0[_0x3ff47(0x268)][_0x3ff47(0x2e3)]>RAW_LOG_MAX_SIZE&&_0x2c00a0[_0x3ff47(0x268)][_0x3ff47(0x22c)](0x0,_0x2c00a0[_0x3ff47(0x268)][_0x3ff47(0x2e3)]-RAW_LOG_MAX_SIZE),await _0x2c00a0[_0x3ff47(0x245)](LTM_DP_RAW_LOG,{'val':JSON[_0x3ff47(0x34a)](_0x2c00a0['rawEventLog']),'ack':!![]});}function a0_0x57e6(_0x2659e4,_0x5a7125){const _0xbc944e=a0_0x13e4();return a0_0x57e6=function(_0x5ae043,_0x1a782e){_0x5ae043=_0x5ae043-0x170;let _0x13e42e=_0xbc944e[_0x5ae043];return _0x13e42e;},a0_0x57e6(_0x2659e4,_0x5a7125);}async function loadDailyDigests(_0x5c1dba){const _0x3ae8f2=a0_0xe721b5;try{const _0x3927ec=await _0x5c1dba[_0x3ae8f2(0x1d6)](LTM_DP_DAILY_DIGESTS);if(_0x3927ec&&_0x3927ec[_0x3ae8f2(0x2c6)])_0x5c1dba[_0x3ae8f2(0x28f)]=JSON[_0x3ae8f2(0x34e)](_0x3927ec['val']);}catch(_0x5c5447){_0x5c1dba[_0x3ae8f2(0x28f)]=[];}await updateBaselineStatus(_0x5c1dba);}async function saveDailyDigests(_0x5a9f77,_0x308953=!![]){const _0x5b88fd=a0_0xe721b5,_0x4cd7c0=_0x5a9f77[_0x5b88fd(0x1db)]['ltmLtbWindowDays']||0x3c;_0x5a9f77[_0x5b88fd(0x28f)]['length']>_0x4cd7c0&&_0x5a9f77[_0x5b88fd(0x28f)][_0x5b88fd(0x22c)](0x0,_0x5a9f77[_0x5b88fd(0x28f)]['length']-_0x4cd7c0);await _0x5a9f77[_0x5b88fd(0x245)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x5a9f77[_0x5b88fd(0x28f)]),'ack':!![]});if(_0x308953)await updateBaselineStatus(_0x5a9f77);}async function updateAnalysisHistory(_0x2dcd77,_0x54eb49){const _0x33c6b9=a0_0xe721b5;_0x2dcd77[_0x33c6b9(0x198)][_0x33c6b9(0x252)](_0x54eb49);if(_0x2dcd77[_0x33c6b9(0x198)][_0x33c6b9(0x2e3)]>ANALYSIS_HISTORY_MAX_SIZE)_0x2dcd77['analysisHistory']['pop']();await _0x2dcd77[_0x33c6b9(0x245)](_0x33c6b9(0x187),{'val':JSON[_0x33c6b9(0x34a)](_0x2dcd77[_0x33c6b9(0x198)]),'ack':!![]});}async function updateBaselineStatus(_0x22913b){const _0x255416=a0_0xe721b5;if(!_0x22913b[_0x255416(0x2ca)]){await _0x22913b[_0x255416(0x245)](LTM_DP_BASELINE_STATUS,{'val':_0x255416(0x181),'ack':!![]});return;}const _0x130d17=_0x22913b[_0x255416(0x28f)][_0x255416(0x2e3)]>=(_0x22913b['config'][_0x255416(0x223)]||0x7)?_0x255416(0x36d)+_0x22913b[_0x255416(0x28f)]['length']+_0x255416(0x214):_0x255416(0x259)+_0x22913b[_0x255416(0x28f)][_0x255416(0x2e3)]+'/'+(_0x22913b[_0x255416(0x1db)][_0x255416(0x223)]||0x7)+')';await _0x22913b[_0x255416(0x245)](LTM_DP_BASELINE_STATUS,{'val':_0x130d17,'ack':!![]});}async function initSensorSubscriptions(_0x5f120d){const _0x6e5b2b=a0_0xe721b5,_0x50500d=_0x5f120d[_0x6e5b2b(0x1db)][_0x6e5b2b(0x2d5)];if(_0x50500d&&_0x50500d[_0x6e5b2b(0x2e3)]>0x0){_0x5f120d['log'][_0x6e5b2b(0x199)]('Subscribing\x20to\x20'+_0x50500d[_0x6e5b2b(0x2e3)]+_0x6e5b2b(0x208));for(const _0x43812d of _0x50500d){if(_0x43812d['id']){await _0x5f120d['subscribeForeignStatesAsync'](_0x43812d['id']);try{const _0x995c1f=await _0x5f120d['getForeignStateAsync'](_0x43812d['id']);if(_0x995c1f)_0x5f120d[_0x6e5b2b(0x227)][_0x43812d['id']]=_0x995c1f[_0x6e5b2b(0x2c6)];}catch(_0x25dbbd){}}}}}async function initPresenceSubscriptions(_0x1f5397){const _0x44f6df=a0_0xe721b5,_0x2b7177=_0x1f5397['config']['presenceDevices']||[];if(_0x2b7177['length']>0x0){_0x1f5397[_0x44f6df(0x191)][_0x44f6df(0x199)](_0x44f6df(0x2e6)+_0x2b7177[_0x44f6df(0x2e3)]+_0x44f6df(0x1d8));for(const _0x107b12 of _0x2b7177){await _0x1f5397[_0x44f6df(0x20e)](_0x107b12);}try{await checkWifiPresence(_0x1f5397);}catch(_0x1a6931){}}}async function getWeatherContext(_0x480a72){const _0x5082b2=a0_0xe721b5;try{if(!_0x480a72[_0x5082b2(0x1db)][_0x5082b2(0x328)])return _0x5082b2(0x356);let _0xa7bc08='';const _0x11dfa8=_0x480a72[_0x5082b2(0x1db)]['weatherInstance'];if(_0x11dfa8)try{if(_0x11dfa8[_0x5082b2(0x28e)]('accuweather')){const _0x58f393=await _0x480a72[_0x5082b2(0x299)](_0x11dfa8+_0x5082b2(0x2fa));if(_0x58f393&&_0x58f393[_0x5082b2(0x2c6)])_0xa7bc08=_0x58f393[_0x5082b2(0x2c6)];}else{if(_0x11dfa8[_0x5082b2(0x28e)]('daswetter')){const _0x43aca3=await _0x480a72[_0x5082b2(0x299)](_0x11dfa8+_0x5082b2(0x205));if(_0x43aca3&&_0x43aca3[_0x5082b2(0x2c6)])_0xa7bc08=_0x43aca3[_0x5082b2(0x2c6)];}else{if(_0x11dfa8[_0x5082b2(0x28e)](_0x5082b2(0x243))){const _0x3392a5=await _0x480a72[_0x5082b2(0x299)](_0x11dfa8+_0x5082b2(0x254));if(_0x3392a5&&_0x3392a5[_0x5082b2(0x2c6)])_0xa7bc08=_0x3392a5[_0x5082b2(0x2c6)];}}}}catch(_0x24d86f){}if(!_0xa7bc08){const _0x4ccf9e=[_0x5082b2(0x1b0),_0x5082b2(0x179),_0x5082b2(0x217),'openweathermap.0'];for(const _0xbaf798 of _0x4ccf9e){try{const _0x29f3b6=await _0x480a72[_0x5082b2(0x35a)](_0xbaf798);if(_0x29f3b6){if(_0xbaf798[_0x5082b2(0x28e)](_0x5082b2(0x2ce))){const _0x360590=await _0x480a72[_0x5082b2(0x299)](_0xbaf798+_0x5082b2(0x2fa));if(_0x360590&&_0x360590[_0x5082b2(0x2c6)]){_0xa7bc08=_0x360590[_0x5082b2(0x2c6)];break;}}}}catch(_0x58a07f){}}}return _0xa7bc08?'WETTER:\x20'+_0xa7bc08:_0x5082b2(0x2f1);}catch(_0x385262){return _0x5082b2(0x1bb)+_0x385262['message'];}}async function getCalendarContext(_0x1ecb65){const _0x621c03=a0_0xe721b5;try{if(!_0x1ecb65['config'][_0x621c03(0x296)])return _0x621c03(0x35c);let _0x2eb415=_0x1ecb65[_0x621c03(0x1db)][_0x621c03(0x32a)]||_0x621c03(0x344),_0x1c562e=_0x1ecb65['config'][_0x621c03(0x35b)]||[];if(typeof _0x1c562e===_0x621c03(0x183))_0x1c562e=_0x1c562e[_0x621c03(0x1c8)](',');try{const _0x119ec9=await _0x1ecb65[_0x621c03(0x299)](_0x2eb415+_0x621c03(0x222));if(_0x119ec9&&_0x119ec9[_0x621c03(0x2c6)]){let _0x3d2957=tryParse(_0x119ec9[_0x621c03(0x2c6)]);if(_0x3d2957&&Array['isArray'](_0x3d2957)){if(_0x1c562e[_0x621c03(0x2e3)]>0x0)_0x3d2957=_0x3d2957[_0x621c03(0x2bc)](_0x538a3e=>_0x1c562e[_0x621c03(0x28e)](_0x538a3e[_0x621c03(0x373)]||''));else return _0x621c03(0x2e8);if(_0x3d2957[_0x621c03(0x2e3)]>0x0){const _0x361c71=_0x3d2957[_0x621c03(0x2ea)](0x0,0x3)[_0x621c03(0x21c)](_0x11ed38=>{const _0x7d652a=_0x621c03;let _0x3861dc=_0x11ed38[_0x7d652a(0x315)];if(_0x11ed38[_0x7d652a(0x258)])_0x3861dc+='\x20'+_0x11ed38['time'];return _0x3861dc+':\x20'+_0x11ed38[_0x7d652a(0x280)]+'\x20('+_0x11ed38[_0x7d652a(0x373)]+')';});return _0x621c03(0x275)+_0x361c71[_0x621c03(0x349)]('\x20|\x20');}else return _0x621c03(0x282);}}}catch(_0x54a188){_0x1ecb65[_0x621c03(0x191)][_0x621c03(0x1c1)](_0x621c03(0x2bd)+_0x54a188[_0x621c03(0x1a5)]);}return _0x621c03(0x34b);}catch(_0x4d3957){return _0x621c03(0x21d)+_0x4d3957[_0x621c03(0x1a5)];}}async function getCalendarNames(_0x4420a7,_0x2ef65d){const _0x52a8b7=a0_0xe721b5;try{const _0x35e1ad=await _0x4420a7['getForeignStateAsync'](_0x2ef65d+_0x52a8b7(0x222));if(_0x35e1ad&&_0x35e1ad[_0x52a8b7(0x2c6)]){const _0x573b77=tryParse(_0x35e1ad['val']);if(_0x573b77&&Array[_0x52a8b7(0x36e)](_0x573b77)){const _0x364de3=[...new Set(_0x573b77[_0x52a8b7(0x21c)](_0x29c702=>_0x29c702[_0x52a8b7(0x373)])[_0x52a8b7(0x2bc)](Boolean))];return _0x364de3['sort']();}}return[];}catch(_0x586531){return _0x4420a7[_0x52a8b7(0x191)][_0x52a8b7(0x279)](_0x52a8b7(0x2a2)+_0x586531[_0x52a8b7(0x1a5)]),[];}}async function checkWifiPresence(_0x88a41c){const _0xdf5cd9=a0_0xe721b5;try{const _0x3b960d=_0x88a41c[_0xdf5cd9(0x1db)][_0xdf5cd9(0x1e1)]||[];let _0x54a85e=![];const _0x5c87f4=[];for(const _0x4e778a of _0x3b960d){try{const _0x149928=await _0x88a41c[_0xdf5cd9(0x299)](_0x4e778a);if(_0x149928&&(_0x149928[_0xdf5cd9(0x2c6)]===!![]||_0x149928['val']===_0xdf5cd9(0x27b)||_0x149928[_0xdf5cd9(0x2c6)]===0x1)){_0x54a85e=!![];const _0x4513ec=await _0x88a41c[_0xdf5cd9(0x35a)](_0x4e778a);let _0x372831=_0x4e778a;_0x4513ec&&_0x4513ec[_0xdf5cd9(0x1a7)]&&_0x4513ec[_0xdf5cd9(0x1a7)][_0xdf5cd9(0x31f)]&&(_0x372831=typeof _0x4513ec[_0xdf5cd9(0x1a7)][_0xdf5cd9(0x31f)]===_0xdf5cd9(0x2a1)?_0x4513ec[_0xdf5cd9(0x1a7)][_0xdf5cd9(0x31f)]['de']||_0x4513ec['common']['name']['en']:_0x4513ec[_0xdf5cd9(0x1a7)][_0xdf5cd9(0x31f)]),_0x5c87f4[_0xdf5cd9(0x2a4)](_0x372831);}}catch(_0x1ac3fe){}}return await _0x88a41c['setStateAsync'](_0xdf5cd9(0x302),{'val':_0x5c87f4['join'](',\x20'),'ack':!![]}),_0x54a85e&&(_0x88a41c['exitTimer']&&(_0x88a41c[_0xdf5cd9(0x191)]['info']('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),abortExitTimer(_0x88a41c)),!_0x88a41c[_0xdf5cd9(0x1f4)]&&_0x88a41c[_0xdf5cd9(0x34f)]===SYSTEM_MODES[_0xdf5cd9(0x26b)]&&await setPresence(_0x88a41c,!![])),_0x54a85e;}catch(_0x5a6071){return _0x88a41c[_0xdf5cd9(0x191)][_0xdf5cd9(0x279)](_0xdf5cd9(0x194)+_0x5a6071['message']),![];}}function startExitTimer(_0x5ac8bc){const _0xde4b81=a0_0xe721b5;abortExitTimer(_0x5ac8bc),_0x5ac8bc[_0xde4b81(0x19a)]=!![],_0x5ac8bc[_0xde4b81(0x2ef)]=setTimeout(()=>{const _0x121e94=_0xde4b81;_0x5ac8bc[_0x121e94(0x19a)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x5ac8bc[_0xde4b81(0x2be)]=setTimeout(()=>{setPresence(_0x5ac8bc,![]),_0x5ac8bc['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0xee4a94){const _0x2deb2d=a0_0xe721b5;if(_0xee4a94[_0x2deb2d(0x2be)])clearTimeout(_0xee4a94[_0x2deb2d(0x2be)]);if(_0xee4a94[_0x2deb2d(0x2ef)])clearTimeout(_0xee4a94[_0x2deb2d(0x2ef)]);_0xee4a94[_0x2deb2d(0x2be)]=null,_0xee4a94[_0x2deb2d(0x2ef)]=null,_0xee4a94['isGracePeriodActive']=![];}async function setPresence(_0x4b08a0,_0x3db2ca){const _0x328921=a0_0xe721b5;if(_0x4b08a0['isPresent']===_0x3db2ca)return;_0x4b08a0['isPresent']=_0x3db2ca,await _0x4b08a0['setStateAsync'](_0x328921(0x30f),{'val':_0x3db2ca,'ack':!![]});}async function saveFeedback(_0xae5a8c,_0x1fc44f){const _0x70012d=a0_0xe721b5;_0xae5a8c[_0x70012d(0x191)]['info'](_0x70012d(0x1ff)+JSON['stringify'](_0x1fc44f));}async function runBaselineDriftAnalysis(_0x4476a7){const _0x49e18b=a0_0xe721b5;if(!_0x4476a7[_0x49e18b(0x2ca)]||!_0x4476a7['geminiModel'])return;const _0x5da6ba=_0x4476a7[_0x49e18b(0x1db)][_0x49e18b(0x1fd)]||0xe;if(_0x4476a7[_0x49e18b(0x28f)][_0x49e18b(0x2e3)]<_0x5da6ba+(_0x4476a7[_0x49e18b(0x1db)]['minDaysForBaseline']||0x7)){await _0x4476a7['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x3995dc=_0x4476a7['dailyDigests'][_0x49e18b(0x2ea)](-_0x5da6ba),_0x29e85b=_0x4476a7[_0x49e18b(0x28f)][_0x49e18b(0x2ea)](0x0,_0x4476a7[_0x49e18b(0x28f)][_0x49e18b(0x2e3)]-_0x5da6ba),_0x130a2d=_0x49e18b(0x2fc)+JSON[_0x49e18b(0x34a)](_0x29e85b)+_0x49e18b(0x246)+JSON['stringify'](_0x3995dc);try{const _0x2ae295=await _0x4476a7[_0x49e18b(0x1fb)]['generateContent'](_0x130a2d),_0x502724=JSON[_0x49e18b(0x34e)](_0x2ae295[_0x49e18b(0x2c5)][_0x49e18b(0x2d8)]()[_0x49e18b(0x2da)](/```json|```/g,'')['trim']());_0x502724['baselineDrift']&&(await _0x4476a7[_0x49e18b(0x245)](LTM_DP_DRIFT_STATUS,{'val':_0x502724['baselineDrift'],'ack':!![]}),await _0x4476a7[_0x49e18b(0x245)](LTM_DP_DRIFT_DETAILS,{'val':_0x502724[_0x49e18b(0x353)],'ack':!![]}),await _0x4476a7['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x49e18b(0x1c3)](),'ack':!![]}));}catch(_0x470cfb){}}function setupLtmScheduler(_0x1819ea){const _0x450b77=a0_0xe721b5;try{if(_0x1819ea[_0x450b77(0x197)])_0x1819ea[_0x450b77(0x197)][_0x450b77(0x228)]();if(!_0x1819ea[_0x450b77(0x2ca)]){_0x1819ea[_0x450b77(0x245)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x1819ea[_0x450b77(0x197)]=schedule[_0x450b77(0x20f)](LTM_SCHEDULE,()=>createDailyDigest(_0x1819ea));}catch(_0x5deea2){_0x1819ea[_0x450b77(0x191)]['error'](_0x450b77(0x2c7)+_0x5deea2[_0x450b77(0x1a5)]);}}function setupModeResetScheduler(_0x49ad06){const _0x3ec70b=a0_0xe721b5;try{if(_0x49ad06[_0x3ec70b(0x19e)])_0x49ad06['modeResetJob'][_0x3ec70b(0x228)]();_0x49ad06[_0x3ec70b(0x19e)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x1c5c54=_0x3ec70b;await loadSystemMode(_0x49ad06),AUTO_RESET_MODES[_0x1c5c54(0x28e)](_0x49ad06['currentSystemMode'])&&await _0x49ad06['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1c5c54(0x26b)],'ack':![]});});}catch(_0x268d61){_0x49ad06[_0x3ec70b(0x191)]['error'](_0x3ec70b(0x351)+_0x268d61[_0x3ec70b(0x1a5)]);}}function setupDriftAnalysisScheduler(_0x115f3a){const _0x3e7a1a=a0_0xe721b5;try{if(_0x115f3a['driftAnalysisTimer'])clearInterval(_0x115f3a[_0x3e7a1a(0x32e)]);if(!_0x115f3a[_0x3e7a1a(0x2ca)])return;_0x115f3a[_0x3e7a1a(0x32e)]=setInterval(()=>runBaselineDriftAnalysis(_0x115f3a),(_0x115f3a['config'][_0x3e7a1a(0x2ff)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x115f3a),0x1388);}catch(_0x4ff1fe){_0x115f3a[_0x3e7a1a(0x191)][_0x3e7a1a(0x279)](_0x3e7a1a(0x1ec)+_0x4ff1fe[_0x3e7a1a(0x1a5)]);}}function setupBriefingScheduler(_0x22addc){const _0x3cc124=a0_0xe721b5;try{if(_0x22addc['briefingJob'])_0x22addc['briefingJob'][_0x3cc124(0x228)]();if(!_0x22addc[_0x3cc124(0x1db)]['briefingEnabled'])return;const _0x1b52ab=(_0x22addc[_0x3cc124(0x1db)][_0x3cc124(0x28c)]||_0x3cc124(0x256))[_0x3cc124(0x1c8)](':'),_0x497c2d=parseInt(_0x1b52ab[0x0])||0x8,_0x5a130d=parseInt(_0x1b52ab[0x1])||0x0,_0x19019c=_0x5a130d+'\x20'+_0x497c2d+_0x3cc124(0x371);_0x22addc[_0x3cc124(0x191)][_0x3cc124(0x199)](_0x3cc124(0x1ee)+_0x497c2d+':'+(_0x5a130d<0xa?'0'+_0x5a130d:_0x5a130d)),_0x22addc[_0x3cc124(0x255)]=schedule[_0x3cc124(0x20f)](_0x19019c,()=>{sendMorningBriefing(_0x22addc);});}catch(_0x53ce64){_0x22addc[_0x3cc124(0x191)]['error']('Briefing\x20Sched\x20Error:\x20'+_0x53ce64[_0x3cc124(0x1a5)]);}}async function sendNotification(_0x5421d5,_0x4ae56c,_0x10c09a=![],_0x21c2b7=![]){const _0x1f7fbc=a0_0xe721b5;_0x5421d5[_0x1f7fbc(0x191)][_0x1f7fbc(0x199)]((_0x10c09a?_0x1f7fbc(0x25e):'')+'Sending\x20notification:\x20\x22'+_0x4ae56c+'\x22');const _0x1af66d=_0x5421d5['config'];let _0xbd6ae6=0x0;if(_0x1af66d[_0x1f7fbc(0x355)]){let _0x5411ef={};(_0x4ae56c[_0x1f7fbc(0x28e)](_0x1f7fbc(0x25a))||_0x21c2b7)&&(_0x5411ef={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':_0x1f7fbc(0x31d)}],[{'text':_0x1f7fbc(0x2d4),'callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0x5421d5[_0x1f7fbc(0x343)](_0x1af66d[_0x1f7fbc(0x30b)],_0x1f7fbc(0x19b),{'text':_0x4ae56c,'user':_0x1af66d[_0x1f7fbc(0x337)],..._0x5411ef}),_0xbd6ae6++;}if(_0x1af66d['notifyPushoverEnabled']){let _0x44b643={'message':_0x4ae56c,'title':_0x21c2b7?_0x1f7fbc(0x364):_0x1f7fbc(0x269),'priority':_0x21c2b7?0x2:0x1,'device':_0x1af66d['notifyPushoverRecipient']};_0x21c2b7&&(_0x44b643[_0x1f7fbc(0x2dc)]=0x1e,_0x44b643['expire']=0xe10,_0x44b643['sound']=_0x1f7fbc(0x2db)),await _0x5421d5[_0x1f7fbc(0x343)](_0x1af66d[_0x1f7fbc(0x24c)],_0x1f7fbc(0x19b),_0x44b643),_0xbd6ae6++;}return _0x1af66d[_0x1f7fbc(0x283)]&&(await _0x5421d5[_0x1f7fbc(0x343)](_0x1af66d['notifyEmailInstance'],_0x1f7fbc(0x19b),{'text':_0x4ae56c,'to':_0x1af66d[_0x1f7fbc(0x368)]}),_0xbd6ae6++),_0xbd6ae6;}async function setupTelegramListener(_0x25b9b7){const _0x3c3673=a0_0xe721b5,_0x190d2a=_0x25b9b7[_0x3c3673(0x1db)][_0x3c3673(0x30b)];_0x25b9b7['config'][_0x3c3673(0x355)]&&_0x190d2a&&(_0x25b9b7[_0x3c3673(0x191)][_0x3c3673(0x199)](_0x3c3673(0x23d)+_0x190d2a+_0x3c3673(0x2b1)),await _0x25b9b7[_0x3c3673(0x20e)](_0x190d2a+_0x3c3673(0x317)));}async function handleTelegramResponse(_0x780102,_0x34498e){const _0x3a6a31=a0_0xe721b5;let _0xc94a23=_0x34498e;_0x34498e[_0x3a6a31(0x292)]('[')&&(_0xc94a23=_0x34498e[_0x3a6a31(0x325)](_0x34498e[_0x3a6a31(0x274)](']')+0x1));if(_0xc94a23===_0x3a6a31(0x31d))_0x780102[_0x3a6a31(0x191)][_0x3a6a31(0x199)]('âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.'),await _0x780102[_0x3a6a31(0x245)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x780102[_0x3a6a31(0x245)](_0x3a6a31(0x175),{'val':'Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ack':!![]}),_0x780102['lastAlertState']=![],sendNotification(_0x780102,_0x3a6a31(0x24b),![]);else _0xc94a23===_0x3a6a31(0x36a)&&(_0x780102['log'][_0x3a6a31(0x1c1)](_0x3a6a31(0x316)),sendNotification(_0x780102,_0x3a6a31(0x26f),![],!![]));}async function runAutopilot(_0xebb361){const _0x2452b8=a0_0xe721b5,_0x49b323=_0xebb361[_0x2452b8(0x1db)]['inactivityThresholdHours'],_0x21787e=_0xebb361[_0x2452b8(0x28a)]['length']>0x0?_0xebb361[_0x2452b8(0x28a)][0x0]['timestamp']:Date['now'](),_0x48073e=(Date['now']()-_0x21787e)/(0x3e8*0x3c*0x3c);let _0x34096d='';_0xebb361[_0x2452b8(0x1db)][_0x2452b8(0x26c)]&&_0xebb361[_0x2452b8(0x34f)]===SYSTEM_MODES[_0x2452b8(0x26b)]&&_0xebb361[_0x2452b8(0x1f4)]&&(_0x48073e>_0x49b323&&(_0x34096d=_0x2452b8(0x248)+_0x48073e['toFixed'](0x1)+_0x2452b8(0x354))),runGeminiAnalysis(_0xebb361,_0x34096d)[_0x2452b8(0x2a8)](_0x1cc4f6=>_0xebb361[_0x2452b8(0x191)][_0x2452b8(0x279)](_0x1cc4f6));}async function createDailyDigest(_0x446305){const _0x26d0d5=a0_0xe721b5;if(!_0x446305['isProVersion'])return;await _0x446305['setStateAsync'](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()[_0x26d0d5(0x1bc)](),'ack':!![]});if(!_0x446305['geminiModel']||_0x446305[_0x26d0d5(0x268)][_0x26d0d5(0x2e3)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x446305['setStateAsync'](LTM_DP_STATUS,{'val':_0x26d0d5(0x350),'ack':!![]});return;}const _0x41b7e6=JSON[_0x26d0d5(0x34e)](JSON[_0x26d0d5(0x34a)](_0x446305['rawEventLog'])),_0x4cb956=_0x41b7e6[_0x26d0d5(0x2e3)],_0x43f48b='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x26d0d5(0x34a)](_0x41b7e6);try{const _0x447269=await _0x446305[_0x26d0d5(0x1fb)][_0x26d0d5(0x2f6)](_0x43f48b),_0x5d0342=JSON['parse'](_0x447269[_0x26d0d5(0x2c5)][_0x26d0d5(0x2d8)]()[_0x26d0d5(0x2da)](/```json|```/g,'')[_0x26d0d5(0x1e0)]());_0x5d0342[_0x26d0d5(0x1dd)]&&(_0x446305[_0x26d0d5(0x28f)]['push']({'timestamp':new Date()['toISOString'](),'eventCount':_0x4cb956,'summary':_0x5d0342[_0x26d0d5(0x1dd)],'activityLevel':_0x5d0342[_0x26d0d5(0x1be)],'systemMode':_0x446305['currentSystemMode']}),await saveDailyDigests(_0x446305),_0x446305[_0x26d0d5(0x268)]=[],await saveRawEventLog(_0x446305),await _0x446305[_0x26d0d5(0x245)](LTM_DP_STATUS,{'val':'Success:\x20Compressed\x20'+_0x4cb956+'\x20events','ack':!![]}),runPythonHealthCheck(_0x446305));}catch(_0x1dbbd7){await _0x446305['setStateAsync'](LTM_DP_STATUS,{'val':_0x26d0d5(0x309)+_0x1dbbd7['message'],'ack':!![]});}}async function sendMorningBriefing(_0x398526){const _0x3db539=a0_0xe721b5;if(!_0x398526[_0x3db539(0x1fb)])return;_0x398526['log']['info'](_0x3db539(0x327));const _0x43c63c=_0x398526[_0x3db539(0x28f)][_0x3db539(0x2e3)]>0x0?_0x398526[_0x3db539(0x28f)][_0x398526[_0x3db539(0x28f)][_0x3db539(0x2e3)]-0x1]:null,_0x54b4ed=_0x43c63c&&_0x43c63c['health']?_0x43c63c['health']['sleepScore']:_0x3db539(0x2e5),_0x46069c=new Date();_0x46069c[_0x3db539(0x32b)](0x4,0x0,0x0,0x0);const _0x2c1bed=_0x398526[_0x3db539(0x28a)][_0x3db539(0x2bc)](_0x4ae436=>new Date(_0x4ae436['timestamp'])>_0x46069c),_0x48aaea=PERSONA_MAPPING[_0x398526['config'][_0x3db539(0x340)]||_0x3db539(0x27c)],_0x5ecd68=_0x398526[_0x3db539(0x1db)][_0x3db539(0x21f)]||'',_0x333c9b=await getWeatherContext(_0x398526),_0x49d42d=await getCalendarContext(_0x398526),_0x1fa11f=_0x3db539(0x363)+_0x48aaea+_0x3db539(0x34c)+_0x5ecd68+_0x3db539(0x21e)+_0x333c9b+'\x20'+_0x49d42d+_0x3db539(0x2b7)+_0x54b4ed+_0x3db539(0x36b)+JSON['stringify'](_0x2c1bed[_0x3db539(0x2ea)](0x0,0xa))+_0x3db539(0x1ed);try{const _0x7fdab0=await _0x398526[_0x3db539(0x1fb)][_0x3db539(0x2f6)](_0x1fa11f),_0x52d823=_0x3db539(0x336)+_0x7fdab0['response']['text']()[_0x3db539(0x1e0)]();sendNotification(_0x398526,_0x52d823),_0x398526[_0x3db539(0x191)][_0x3db539(0x199)](_0x3db539(0x2a5));}catch(_0x9a5ad7){_0x398526[_0x3db539(0x191)][_0x3db539(0x279)]('Briefing\x20Error:\x20'+_0x9a5ad7[_0x3db539(0x1a5)]);}}async function scanForDevices(_0x749041,_0x549763){const _0x1edd60=a0_0xe721b5;_0x749041[_0x1edd60(0x191)][_0x1edd60(0x199)](_0x1edd60(0x357));const _0x6a1416=[],_0x424784=await _0x749041[_0x1edd60(0x2d9)]('*'),_0x1486af=await _0x749041[_0x1edd60(0x2d9)]('enum.functions.*',_0x1edd60(0x1cb)),_0x427860=await _0x749041[_0x1edd60(0x2d9)]('enum.rooms.*',_0x1edd60(0x1cb)),_0x4204f4={};if(_0x1486af)for(const _0x471033 in _0x1486af){const _0x3eb098=_0x1486af[_0x471033]['common']['members']||[];_0x3eb098[_0x1edd60(0x2f4)](_0x1cd9dd=>{if(!_0x4204f4[_0x1cd9dd])_0x4204f4[_0x1cd9dd]=[];_0x4204f4[_0x1cd9dd]['push'](_0x471033);});}const _0x1ca028={};if(_0x427860)for(const _0x5e6291 in _0x427860){const _0x6119e1=_0x427860[_0x5e6291][_0x1edd60(0x1a7)][_0x1edd60(0x362)]||[],_0x406112=typeof _0x427860[_0x5e6291][_0x1edd60(0x1a7)]['name']===_0x1edd60(0x2a1)?_0x427860[_0x5e6291][_0x1edd60(0x1a7)][_0x1edd60(0x31f)]['de']:_0x427860[_0x5e6291][_0x1edd60(0x1a7)][_0x1edd60(0x31f)];_0x6119e1[_0x1edd60(0x2f4)](_0x349d54=>_0x1ca028[_0x349d54]=_0x406112);}const _0x4c7bda=_0x549763['selectedFunctionIds']||[],_0x6ec6ac=_0x549763[_0x1edd60(0x17d)]!==![],_0x5866e2=_0x549763['doors']!==![],_0x4dbe34=_0x549763['lights']!==![],_0x43321c=_0x549763[_0x1edd60(0x1bf)]===!![],_0x2a09fc=_0x549763[_0x1edd60(0x31e)]===!![];for(const _0x2e50d7 in _0x424784){const _0x1866dc=_0x424784[_0x2e50d7];if(_0x1866dc[_0x1edd60(0x1e4)]!==_0x1edd60(0x1a6)||!_0x1866dc[_0x1edd60(0x1a7)])continue;if(ADAPTER_BLACKLIST[_0x1edd60(0x1f3)](_0x551669=>_0x2e50d7[_0x1edd60(0x292)](_0x551669))&&!_0x2a09fc)continue;const _0x4a569c=(_0x1866dc[_0x1edd60(0x1a7)][_0x1edd60(0x2b0)]||'')['toLowerCase']();let _0x15d62b=(typeof _0x1866dc[_0x1edd60(0x1a7)][_0x1edd60(0x31f)]===_0x1edd60(0x2a1)?_0x1866dc[_0x1edd60(0x1a7)][_0x1edd60(0x31f)]['de']:_0x1866dc[_0x1edd60(0x1a7)][_0x1edd60(0x31f)])||_0x2e50d7;const _0x18e61b=_0x15d62b[_0x1edd60(0x2df)]();let _0x1090f7=![],_0x4aaf3e=![];if(_0x4c7bda[_0x1edd60(0x2e3)]>0x0){const _0x247b2b=_0x4204f4[_0x2e50d7]||[],_0x1fae38=_0x2e50d7[_0x1edd60(0x1c8)]('.')[_0x1edd60(0x2ea)](0x0,-0x1)[_0x1edd60(0x349)]('.'),_0x2077dc=_0x4204f4[_0x1fae38]||[];(_0x247b2b['some'](_0x4586ed=>_0x4c7bda['includes'](_0x4586ed))||_0x2077dc[_0x1edd60(0x1f3)](_0x2b811a=>_0x4c7bda[_0x1edd60(0x28e)](_0x2b811a)))&&(_0x1090f7=!![],_0x4aaf3e=!![]);}if(!_0x1090f7&&!_0x2a09fc){if(HARD_IGNORE_TERMS[_0x1edd60(0x1f3)](_0x11b207=>_0x2e50d7['includes'](_0x11b207)||_0x18e61b[_0x1edd60(0x28e)](_0x11b207[_0x1edd60(0x2df)]())))continue;}if(BAD_NAMES[_0x1edd60(0x1f3)](_0x31fb48=>_0x18e61b===_0x31fb48||_0x18e61b[_0x1edd60(0x21b)]('.'+_0x31fb48))){const _0x42af0d=_0x2e50d7[_0x1edd60(0x1c8)]('.');if(_0x42af0d[_0x1edd60(0x2e3)]>0x2){const _0x324e95=_0x42af0d[_0x1edd60(0x2ea)](0x0,-0x1)[_0x1edd60(0x349)]('.'),_0x330006=_0x424784[_0x324e95];if(_0x330006&&_0x330006[_0x1edd60(0x1a7)]&&_0x330006[_0x1edd60(0x1a7)][_0x1edd60(0x31f)]){const _0x8d635f=typeof _0x330006['common']['name']===_0x1edd60(0x2a1)?_0x330006[_0x1edd60(0x1a7)][_0x1edd60(0x31f)]['de']:_0x330006['common'][_0x1edd60(0x31f)];_0x8d635f&&!_0x15d62b[_0x1edd60(0x28e)](_0x8d635f)&&(_0x15d62b=_0x8d635f+'\x20'+_0x15d62b);}}}let _0x248c7e='';if(_0x6ec6ac&&(_0x4a569c[_0x1edd60(0x28e)](_0x1edd60(0x17d))||_0x4a569c[_0x1edd60(0x28e)]('occupancy')||_0x18e61b[_0x1edd60(0x28e)]('bewegung')||_0x18e61b['includes'](_0x1edd60(0x2c3))))_0x248c7e=_0x1edd60(0x17d);else{if(!_0x248c7e&&_0x5866e2&&(_0x4a569c['includes']('door')||_0x4a569c['includes'](_0x1edd60(0x213))||_0x4a569c[_0x1edd60(0x28e)](_0x1edd60(0x184))||_0x4a569c[_0x1edd60(0x28e)](_0x1edd60(0x211))||_0x4a569c[_0x1edd60(0x28e)](_0x1edd60(0x17a))||_0x18e61b[_0x1edd60(0x28e)](_0x1edd60(0x22d))||_0x18e61b[_0x1edd60(0x28e)](_0x1edd60(0x195))||_0x18e61b[_0x1edd60(0x28e)](_0x1edd60(0x307))))_0x248c7e=_0x1edd60(0x2ec);else{if(!_0x248c7e&&_0x4dbe34&&(_0x4a569c['includes'](_0x1edd60(0x188))||_0x4a569c[_0x1edd60(0x28e)](_0x1edd60(0x334))||_0x4a569c[_0x1edd60(0x28e)](_0x1edd60(0x261))||_0x18e61b[_0x1edd60(0x28e)](_0x1edd60(0x23e))||_0x18e61b[_0x1edd60(0x28e)]('lampe')||_0x18e61b['includes'](_0x1edd60(0x27d)))){if(_0x1866dc[_0x1edd60(0x1a7)]['write']||_0x4a569c[_0x1edd60(0x28e)](_0x1edd60(0x342)))_0x248c7e=_0x1edd60(0x188);}else{if(!_0x248c7e&&_0x43321c&&(_0x4a569c[_0x1edd60(0x28e)](_0x1edd60(0x1bf))||_0x4a569c[_0x1edd60(0x28e)]('humidity')||_0x4a569c[_0x1edd60(0x28e)]('thermostat')||_0x18e61b[_0x1edd60(0x28e)](_0x1edd60(0x1b4))||_0x18e61b[_0x1edd60(0x28e)]('klima')||_0x18e61b[_0x1edd60(0x28e)](_0x1edd60(0x174))))_0x248c7e=_0x1edd60(0x1bf);else{if(!_0x248c7e&&_0x4aaf3e)_0x248c7e=_0x1edd60(0x291);}}}}if(_0x248c7e){let _0x37f0a9=_0x1ca028[_0x2e50d7]||'';if(!_0x37f0a9){let _0x42d3f0=_0x2e50d7;for(let _0x49f22d=0x0;_0x49f22d<0x3;_0x49f22d++){const _0xbc8abe=_0x42d3f0[_0x1edd60(0x242)]('.');if(_0xbc8abe===-0x1)break;_0x42d3f0=_0x42d3f0[_0x1edd60(0x325)](0x0,_0xbc8abe);if(_0x1ca028[_0x42d3f0]){_0x37f0a9=_0x1ca028[_0x42d3f0];break;}}}_0x6a1416[_0x1edd60(0x2a4)]({'id':_0x2e50d7,'name':_0x15d62b,'location':_0x37f0a9,'type':_0x248c7e,'logDuplicates':_0x248c7e===_0x1edd60(0x17d),'isExit':![],'_score':_0x37f0a9?0x50:_0x248c7e===_0x1edd60(0x291)?0x5a:0x28});}}return _0x6a1416[_0x1edd60(0x233)]((_0x44a866,_0x4eb498)=>_0x4eb498['_score']-_0x44a866[_0x1edd60(0x2a0)]),_0x6a1416;}async function executeAutomationAction(_0x536491){const _0xcded2a=a0_0xe721b5;try{const _0x54e778=await _0x536491[_0xcded2a(0x1d6)]('analysis.automation.targetId'),_0x507b8b=await _0x536491[_0xcded2a(0x1d6)](_0xcded2a(0x318));if(_0x54e778&&_0x54e778[_0xcded2a(0x2c6)]&&_0x507b8b){const _0x14eaf7=_0x54e778[_0xcded2a(0x2c6)];let _0x5b77ff=_0x507b8b[_0xcded2a(0x2c6)];try{_0x5b77ff=JSON[_0xcded2a(0x34e)](_0x5b77ff);}catch(_0x9dcf40){}_0x536491['log']['info'](_0xcded2a(0x359)+_0x14eaf7+_0xcded2a(0x1dc)+_0x5b77ff),await _0x536491[_0xcded2a(0x1f5)](_0x14eaf7,_0x5b77ff);}else _0x536491[_0xcded2a(0x191)][_0xcded2a(0x1c1)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x6e84c3){_0x536491['log'][_0xcded2a(0x279)](_0xcded2a(0x28d)+_0x6e84c3[_0xcded2a(0x1a5)]);}}function tryParse(_0x55e3dc){const _0x53367e=a0_0xe721b5;try{return JSON[_0x53367e(0x34e)](_0x55e3dc);}catch(_0x21cb75){return null;}}async function recordSequence(_0x1d64bb,_0x963407){const _0x533b02=a0_0xe721b5,_0x2cb00c=(_0x963407[_0x533b02(0x1e4)]||'')[_0x533b02(0x2df)](),_0x4f5ac6=[_0x533b02(0x17d),'bewegung',_0x533b02(0x2c3),'presence','occupancy',_0x533b02(0x2ec),'tÃ¼r',_0x533b02(0x213),_0x533b02(0x22d),'contact',_0x533b02(0x253),_0x533b02(0x188),_0x533b02(0x23e),_0x533b02(0x334),_0x533b02(0x27d),'dimmer',_0x533b02(0x30c)];if(!_0x4f5ac6[_0x533b02(0x1f3)](_0x67f0bd=>_0x2cb00c[_0x533b02(0x28e)](_0x67f0bd))){_0x1d64bb[_0x533b02(0x191)][_0x533b02(0x2b2)](_0x533b02(0x1e8)+_0x963407['id']+_0x533b02(0x2f3)+_0x963407['type']+_0x533b02(0x185));return;}if(!_0x963407[_0x533b02(0x34d)]){_0x1d64bb[_0x533b02(0x191)][_0x533b02(0x2b2)]('[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20'+_0x963407['id']+_0x533b02(0x1e2)+_0x963407[_0x533b02(0x34d)]+')');return;}_0x1d64bb[_0x533b02(0x191)]['debug'](_0x533b02(0x2cb)+_0x963407['id']+'\x20('+_0x963407['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x1e153d={'loc':_0x963407[_0x533b02(0x2c9)]||_0x533b02(0x341),'id':_0x963407['id'],'ts':Date['now']()};activeSequence[_0x533b02(0x2a4)](_0x1e153d),_0x1d64bb[_0x533b02(0x191)][_0x533b02(0x2b2)](_0x533b02(0x2f7)+_0x1e153d[_0x533b02(0x207)]+_0x533b02(0x2d2)+activeSequence[_0x533b02(0x2e3)]+')'),sequenceTimer=setTimeout(async()=>{const _0xca0793=_0x533b02;activeSequence[_0xca0793(0x2e3)]>0x1?await saveCompletedSequence(_0x1d64bb):(_0x1d64bb[_0xca0793(0x191)][_0xca0793(0x2b2)](_0xca0793(0x224)+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x404790){const _0x48265f=a0_0xe721b5;try{_0x404790[_0x48265f(0x191)][_0x48265f(0x199)](_0x48265f(0x172)+activeSequence[_0x48265f(0x2e3)]+_0x48265f(0x2c2));const _0x1567e8=await _0x404790[_0x48265f(0x1d6)](_0x48265f(0x257));let _0x53c465=[];if(_0x1567e8&&_0x1567e8[_0x48265f(0x2c6)])try{_0x53c465=JSON[_0x48265f(0x34e)](_0x1567e8[_0x48265f(0x2c6)]);}catch(_0x83695c){}const _0x3564e8=activeSequence[0x0]['ts'],_0x4934e9=activeSequence[_0x48265f(0x21c)](_0x141f02=>({'loc':_0x141f02[_0x48265f(0x207)],'t_delta':Math[_0x48265f(0x2af)]((_0x141f02['ts']-_0x3564e8)/0x3e8)})),_0x513d2f={'timestamp':new Date(_0x3564e8)[_0x48265f(0x1ae)](),'steps':_0x4934e9,'duration':Math[_0x48265f(0x2af)]((activeSequence[activeSequence[_0x48265f(0x2e3)]-0x1]['ts']-_0x3564e8)/0x3e8),'daytime':new Date(_0x3564e8)[_0x48265f(0x1fa)]()};_0x53c465[_0x48265f(0x2a4)](_0x513d2f),_0x53c465['length']>MAX_TRAINING_SET_SIZE&&_0x53c465[_0x48265f(0x2aa)](),await _0x404790['setStateAsync'](_0x48265f(0x257),{'val':JSON[_0x48265f(0x34a)](_0x53c465),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x2b3119){_0x404790[_0x48265f(0x191)][_0x48265f(0x279)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x2b3119[_0x48265f(0x1a5)]);}}async function getOutsideTemperatureNumeric(_0x197e84){const _0x22a494=a0_0xe721b5;if(_0x197e84['config'][_0x22a494(0x251)])try{const _0x2cf7b4=await _0x197e84[_0x22a494(0x299)](_0x197e84[_0x22a494(0x1db)][_0x22a494(0x251)]);if(_0x2cf7b4&&_0x2cf7b4[_0x22a494(0x2c6)]!==undefined&&_0x2cf7b4[_0x22a494(0x2c6)]!==null){const _0x3455a6=parseFloat(_0x2cf7b4[_0x22a494(0x2c6)]);if(!isNaN(_0x3455a6))return _0x3455a6;}}catch(_0x585cb5){_0x197e84[_0x22a494(0x191)][_0x22a494(0x1c1)](_0x22a494(0x1a2)+_0x197e84[_0x22a494(0x1db)][_0x22a494(0x251)]+':\x20'+_0x585cb5[_0x22a494(0x1a5)]);}const _0x423955=_0x197e84[_0x22a494(0x1db)][_0x22a494(0x1d5)];if(!_0x197e84['config']['useWeather']||!_0x423955)return null;try{let _0x149d56='';if(_0x423955[_0x22a494(0x28e)](_0x22a494(0x2ce)))_0x149d56=_0x423955+_0x22a494(0x267);else{if(_0x423955[_0x22a494(0x28e)](_0x22a494(0x177)))_0x149d56=_0x423955+_0x22a494(0x27e);else{if(_0x423955[_0x22a494(0x28e)](_0x22a494(0x243)))_0x149d56=_0x423955+'.forecast.current.temperature';else{if(_0x423955[_0x22a494(0x28e)](_0x22a494(0x265)))_0x149d56=_0x423955+_0x22a494(0x1a0);}}}if(_0x149d56){const _0x1cec29=await _0x197e84['getForeignStateAsync'](_0x149d56);if(_0x1cec29&&_0x1cec29[_0x22a494(0x2c6)]!==undefined&&_0x1cec29['val']!==null)return parseFloat(_0x1cec29[_0x22a494(0x2c6)]);}}catch(_0x601385){}return null;}async function recordThermodynamics(_0x5eb8f3,_0x278732,_0x992cd5,_0x1bcb55){const _0x2df7db=a0_0xe721b5,_0x28f95d=await getOutsideTemperatureNumeric(_0x5eb8f3),_0x5516ae=await _0x5eb8f3[_0x2df7db(0x1d6)](_0x2df7db(0x306));let _0x195591=[];if(_0x5516ae&&_0x5516ae[_0x2df7db(0x2c6)])try{_0x195591=JSON[_0x2df7db(0x34e)](_0x5516ae['val']);}catch(_0x2f4128){}_0x195591[_0x2df7db(0x2a4)]({'ts':Date['now'](),'room':_0x1bcb55||_0x2df7db(0x341),'t_in':_0x992cd5,'t_out':_0x28f95d});if(_0x195591['length']>THERMO_LOG_SIZE)_0x195591[_0x2df7db(0x2aa)]();await _0x5eb8f3[_0x2df7db(0x245)](_0x2df7db(0x306),{'val':JSON[_0x2df7db(0x34a)](_0x195591),'ack':!![]});}async function processSensorEvent(_0x50ef01,_0x16d2f9,_0x204eaa,_0x35fbf0){const _0x14aac4=a0_0xe721b5;if(!_0x35fbf0)return;const _0x2a78a7=_0x204eaa[_0x14aac4(0x2c6)],_0x57d9dd=Date[_0x14aac4(0x1c3)]();_0x50ef01[_0x14aac4(0x191)]['debug']('Event\x20received:\x20'+_0x16d2f9+_0x14aac4(0x1dc)+_0x2a78a7);const _0x47e0da=_0x50ef01[_0x14aac4(0x227)][_0x16d2f9];_0x50ef01[_0x14aac4(0x227)][_0x16d2f9]=_0x2a78a7;if(!_0x35fbf0[_0x14aac4(0x1c4)]&&_0x47e0da!=undefined&&_0x47e0da==_0x2a78a7){_0x50ef01['log'][_0x14aac4(0x2b2)](_0x14aac4(0x247)+_0x35fbf0['name']+_0x14aac4(0x25c)+_0x2a78a7+')');return;}_0x50ef01['isProVersion']&&_0x35fbf0[_0x14aac4(0x1e4)]===_0x14aac4(0x1bf)&&recordThermodynamics(_0x50ef01,_0x16d2f9,_0x2a78a7,_0x35fbf0['location']);const _0x5be02f={'timestamp':_0x57d9dd,'id':_0x16d2f9,'name':_0x35fbf0[_0x14aac4(0x31f)],'type':_0x35fbf0['type'],'location':_0x35fbf0['location'],'value':_0x2a78a7};_0x50ef01[_0x14aac4(0x28a)][_0x14aac4(0x252)](_0x5be02f);if(_0x50ef01[_0x14aac4(0x28a)][_0x14aac4(0x2e3)]>HISTORY_MAX_SIZE)_0x50ef01[_0x14aac4(0x28a)]['pop']();await _0x50ef01[_0x14aac4(0x245)]('events.lastEvent',{'val':JSON['stringify'](_0x5be02f),'ack':!![]}),await _0x50ef01[_0x14aac4(0x245)](_0x14aac4(0x2dd),{'val':JSON[_0x14aac4(0x34a)](_0x50ef01['eventHistory']),'ack':!![]});_0x50ef01['isProVersion']&&(_0x50ef01[_0x14aac4(0x268)]['push'](_0x5be02f),await saveRawEventLog(_0x50ef01),recordSequence(_0x50ef01,_0x5be02f));if(_0x35fbf0['isExit']&&_0x2a78a7===!![]){if(_0x50ef01[_0x14aac4(0x1f4)]&&!_0x50ef01[_0x14aac4(0x19a)])_0x50ef01[_0x14aac4(0x191)][_0x14aac4(0x199)](_0x14aac4(0x297)+_0x35fbf0['name']+_0x14aac4(0x314)),startExitTimer(_0x50ef01);else!_0x50ef01[_0x14aac4(0x1f4)]&&(_0x50ef01[_0x14aac4(0x191)]['info'](_0x14aac4(0x1d9)+_0x35fbf0[_0x14aac4(0x31f)]+_0x14aac4(0x30a)),await setPresence(_0x50ef01,!![]));}else _0x35fbf0['type']===_0x14aac4(0x17d)&&_0x2a78a7===!![]&&(_0x50ef01[_0x14aac4(0x2be)]&&(_0x50ef01['log'][_0x14aac4(0x199)](_0x14aac4(0x2c4)),abortExitTimer(_0x50ef01)),!_0x50ef01['isPresent']&&_0x50ef01[_0x14aac4(0x34f)]===SYSTEM_MODES[_0x14aac4(0x26b)]&&await setPresence(_0x50ef01,!![]));}async function runGeminiAnalysis(_0x2d5cc8,_0x59c8ce=''){const _0x222a25=a0_0xe721b5;if(!_0x2d5cc8['geminiModel'])return;if(_0x2d5cc8['eventHistory'][_0x222a25(0x2e3)]===0x0)return;const _0x27aadb=_0x2d5cc8[_0x222a25(0x28a)][_0x222a25(0x2ea)](0x0,0xf),_0x44f78a=await getWeatherContext(_0x2d5cc8),_0x360334=_0x2d5cc8['currentSystemMode'],_0x423231=PERSONA_MAPPING[_0x2d5cc8[_0x222a25(0x1db)]['aiPersona']||'generic'],_0x524c38=_0x2d5cc8[_0x222a25(0x1db)][_0x222a25(0x21f)]||'Keine\x20Details.';let _0x1be679=![];try{const _0x1f9185=await _0x2d5cc8[_0x222a25(0x1d6)](_0x222a25(0x332));if(_0x1f9185&&_0x1f9185[_0x222a25(0x2c6)])_0x1be679=!![];}catch(_0x413efa){}const _0x22038b=_0x222a25(0x2b9)+_0x423231+_0x222a25(0x202)+_0x524c38+_0x222a25(0x277)+_0x360334+_0x222a25(0x346)+_0x44f78a+_0x222a25(0x2a7)+(_0x59c8ce||_0x222a25(0x1e6))+_0x222a25(0x2de)+JSON[_0x222a25(0x34a)](_0x27aadb)+_0x222a25(0x1e5);try{const _0x121062=await _0x2d5cc8['geminiModel'][_0x222a25(0x2f6)](_0x22038b),_0x5b406b=_0x121062[_0x222a25(0x2c5)][_0x222a25(0x2d8)]()[_0x222a25(0x2da)](/```json|```/g,'')[_0x222a25(0x1e0)](),_0x274591=JSON[_0x222a25(0x34e)](_0x5b406b);await _0x2d5cc8[_0x222a25(0x245)](_0x222a25(0x192),{'val':JSON[_0x222a25(0x34a)](_0x274591),'ack':!![]});_0x274591[_0x222a25(0x1dd)]&&await _0x2d5cc8['setStateAsync'](_0x222a25(0x2ee),{'val':_0x274591[_0x222a25(0x1dd)],'ack':!![]});const _0x2b2337={'timestamp':Date[_0x222a25(0x1c3)](),'id':Date[_0x222a25(0x1c3)]()[_0x222a25(0x333)](),'analysis':{'activity':{'summary':_0x274591[_0x222a25(0x1dd)]||_0x222a25(0x32d),'isAlert':_0x274591[_0x222a25(0x2f8)]||![],'alertReason':_0x274591['alertReason']},'comfort':{'automationProposal':_0x274591[_0x222a25(0x27f)]}}};await updateAnalysisHistory(_0x2d5cc8,_0x2b2337);const _0xe78c3=_0x274591[_0x222a25(0x2f8)]||![];_0xe78c3!==_0x2d5cc8['lastAlertState']&&(await _0x2d5cc8[_0x222a25(0x245)](_0x222a25(0x2a3),{'val':_0xe78c3,'ack':!![]}),_0x2d5cc8[_0x222a25(0x31b)]=_0xe78c3,_0xe78c3&&(await _0x2d5cc8[_0x222a25(0x245)]('analysis.alertReason',{'val':_0x274591[_0x222a25(0x294)],'ack':!![]}),sendNotification(_0x2d5cc8,_0x222a25(0x2cd)+_0x274591[_0x222a25(0x294)],![],_0x274591[_0x222a25(0x369)]))),_0x274591[_0x222a25(0x27f)]&&_0x274591[_0x222a25(0x27f)][_0x222a25(0x206)]&&_0x274591[_0x222a25(0x27f)][_0x222a25(0x218)]&&(_0x2d5cc8[_0x222a25(0x191)][_0x222a25(0x199)](_0x222a25(0x2ac)+_0x274591[_0x222a25(0x27f)][_0x222a25(0x250)]),await _0x2d5cc8['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x2d5cc8[_0x222a25(0x245)](_0x222a25(0x204),{'val':_0x274591[_0x222a25(0x27f)]['description'],'ack':!![]}),await _0x2d5cc8[_0x222a25(0x245)]('analysis.automation.targetId',{'val':_0x274591['automationProposal'][_0x222a25(0x218)],'ack':!![]}),await _0x2d5cc8[_0x222a25(0x245)](_0x222a25(0x318),{'val':JSON['stringify'](_0x274591[_0x222a25(0x27f)]['targetValue']),'ack':!![]}),_0x1be679&&(_0x2d5cc8[_0x222a25(0x191)]['info'](_0x222a25(0x1ba)+_0x274591['automationProposal'][_0x222a25(0x218)]+_0x222a25(0x29e)),await executeAutomationAction(_0x2d5cc8)));}catch(_0x4b7cf5){_0x2d5cc8[_0x222a25(0x191)][_0x222a25(0x279)](_0x222a25(0x1f1)+_0x4b7cf5['message']);}}function a0_0x13e4(){const _0x4332be=['boolean','config','\x20=\x20','summary','Details:\x20','@google/generative-ai','trim','presenceDevices','\x20(Value\x20is\x20falsy:\x20','triggerDailyDigest','type','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','Keiner','[LOG]','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','rssi','analysis.automation.targetId','Trend\x20Diagnosis\x20(Python)','Drift\x20Sched\x20Error:\x20','.\x20OUTPUT:\x20Nur\x20Text.','Scheduling\x20Morning\x20Briefing\x20for\x20','Activity\x20Summary','energy','Gemini\x20Analysis\x20Error:\x20','setpoint','some','isPresent','setForeignStateAsync','\x20min).','Last\x20Check','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','LTM.driftAnalysis','getHours','geminiModel','geminiApiKey','ltmStbWindowDays','actual_temperature','Feedback\x20saved:\x20','targetposition','Drift\x20Status','.\x0a\x20\x20\x20\x20KONTEXT:\x20','PARTY','analysis.automation.description','.NextHours.Location_1.Day_1.current.symbol_desc','detected','loc','\x20sensors...',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','getTime','TREND_RESULT','writable','systemUUID','subscribeForeignStatesAsync','scheduleJob','Error\x20in\x20onMessage\x20command\x20','blind','Guardian:\x20Sending\x20','window','\x20Tage)','âœ…\x20PRO\x20ACTIVATED','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','weatherunderground.0','targetId','\x22\x20--break-system-packages','version','endsWith','map','KALENDER\x20ERROR:\x20','.\x20ZUSATZ:\x20','livingContext','status','search','.data.table','minDaysForBaseline','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','getFullYear','off','sensorLastValues','cancel','112KVevnu','native','scriptEnabled','splice','fenster','stdout','7607824nfgbGr','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','channel','getObjectAsync','sort','write','Restlessness\x20Level','number','stderr','Analysiere\x20ausgewogen.','4pJDhys','automation.triggerAction','Adapter','subscribeStates','ðŸ“¡\x20Hooking\x20into\x20','licht','Gemini\x20AI\x20initialized.','analysis.health.restlessness','No\x20module\x20named','lastIndexOf','openweathermap','timestamp','setStateAsync','\x0aSTB:\x20','IGNORING\x20DUPLICATE\x20(Cached):\x20','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','GUEST','1947952LhrSQi','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','notifyPushoverInstance','Automation\x20Proposals','1503906lBlHaN','link_quality','description','outdoorSensorId','unshift','kontakt','.forecast.current.state','briefingJob','08:00','LTM.trainingData.sequences','time','Lernphase\x20(','Alarm','):\x20','\x20(Value:\x20','Fehler:\x20','[TEST]\x20','fill','âŒ\x20FREE\x20MODE','dimmer','apply','config_pending','Last\x20Result','weatherunderground','none','.Current.Temperature','rawEventLog','Cogni-Living','delObjectAsync','NORMAL','inactivityMonitoringEnabled','[PYTHON]\x20','pythonProcess','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','analysis.triggerBriefing','AI\x20Emergency\x20Status','Training\x20Data\x20Sets','analysisTimer','indexOf','KALENDER:\x20','events.lastEvent','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','level','error','main','online','generic','schalter','.NextHours.Location_1.Day_1.current.temp_value','automationProposal','event','System\x20Mode','KALENDER:\x20Keine\x20relevanten\x20Termine','notifyEmailEnabled','uuid','direction','dismissAutomation','lastCheck','analysis.comfortSuggestion','onStateChange','eventHistory','No\x20instance','briefingTime','BUTLER\x20Execution\x20Error:\x20','includes','dailyDigests','20pLfzNH','custom','startsWith','Kein\x20API\x20Key\x20eingegeben.','alertReason','currentposition','useCalendar','Exit\x20Sensor\x20triggered\x20(','city','getForeignStateAsync','unreach','values','payload','brightness','...','PRIORITÃ„T:\x20Gesundheit/AAL.','_score','object','getCalendarNames\x20Error:\x20','analysis.isAlert','push','Morning\x20Briefing\x20sent.','scanDevices','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','catch','LTM.driftAnalysis.baselineDrift','shift','icons-mfd.','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','vacation','LTM.rawEventLog','round','role','\x20for\x20interactive\x20buttons...','debug','unload','Trend\x20Value\x20(%)','lowbat','LTM.triggerDailyDigest','.\x20DATEN:\x20Schlaf\x20','indicator.alarm','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','application/json','Thermodynamic\x20Data\x20Points','filter','Error\x20reading\x20calendar\x20table:\x20','exitTimer','Normal','triggerBriefing','system',').\x20Saving\x20to\x20Training\x20Data.','prÃ¤senz','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','response','val','LTM\x20Sched\x20Error:\x20','valve','location','isProVersion','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','âš ï¸\x20ALARM:\x20','accuweather','javascript.','enum.functions.*','guest','\x20(Length:\x20','analysis.automation.patternDetected','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','devices','Health\x20Notes','latitude','text','getForeignObjectsAsync','replace','siren','retry','events.history','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','toLowerCase','close','longitude','analysis.trigger','length','ltmLtbWindowDays','N/A','Subscribing\x20to\x20','find','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','Deviation','slice','Comfort\x20Suggestion','door','service.py','analysis.activitySummary','exitGraceTimer','python3\x20-m\x20pip\x20install\x20-r\x20\x22','WETTER:\x20Keine\x20Daten\x20gefunden','dependencyInstallInProgress','\x20(Type\x20\x27','forEach','simple-api.','generateContent','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','isAlert','normal','.Summary.Current','system.config','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','child_process','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','ltmDriftCheckIntervalHours','json','VACATION','system.presenceWho','Gast','5404275blqfzm','echarts.','LTM.trainingData.thermodynamics','rollladen','Sleep\x20Score\x20(0-100)','Error:\x20','.\x20Welcome\x20home.','notifyTelegramInstance','lampe','getEnums','LTM.processingStatus','system.isPresent','(((.+)+)+)+$','button','telegram','material.',').\x20Starting\x20Timer.','date','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','.communicate.request','analysis.automation.targetValue','sendTo','Trigger\x20Analysis','lastAlertState','cogni-living','COGNI_CONFIRM_OK','weather','name','inactivityThresholdHours','callback','genAI','systemConfig','getOverviewData','substring','analysis.comfortSummary','Generating\x20Morning\x20Briefing...','useWeather','licenseKey','calendarInstance','setHours','analysisInterval','Keine\x20Analyse.','driftAnalysisTimer','LTM','system.','Party','analysis.automation.autoApply','toString','switch','onMessage','ðŸŒ…\x20Daily\x20Briefing:\x0a','notifyTelegramRecipient','analysis.feedbackHistory','submitFeedback','bind','[LICENSE\x20CHECK]\x20Key\x20present:\x20','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','position','Feedback\x20Log','indicator','aiPersona','Unknown','sensor','sendToAsync','ical.0','8096905CycPsH','.\x0a\x20\x20\x20\x20WETTER:\x20','system.mode','presence','join','stringify','KALENDER:\x20Keine\x20Daten','.\x20KONTEXT:\x20','value','parse','currentSystemMode','Skipped\x20(No\x20AI\x20or\x20Data)','Reset\x20Sched\x20Error:\x20','[PYTHON\x20ERR]\x20','driftDetails','\x20hours.\x20Potential\x20incapacitation.','notifyTelegramEnabled','Wetter:\x20Deaktiviert','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','details','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','getForeignObjectAsync','calendarSelection','Kalender:\x20Deaktiviert','instance','Comfort\x20Summary','ðŸ\x20Guardian\x20Diagnosis\x20(','text.alarm','onReady','members','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','ðŸš¨\x20EMERGENCY','Description','models/gemini-flash-latest','analysis.automation.triggerAction','notifyEmailRecipient','isEmergency','COGNI_REQUEST_CALL','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','onUnload','Aktiv\x20(','isArray','working','reachable','\x20*\x20*\x20*','Invalid\x20JSON\x20from\x20Python:\x20','_calName','scriptProblem','@iobroker/adapter-core','namespace','indicator.alarm.fire','extendObjectAsync','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','LTM.dailyDigests','heizung','analysis.alertReason','Target\x20ID','daswetter','uuid-not-found','daswetter.0','shutter','ðŸ\x20Stopping\x20Python\x20Sidecar...','5641491ndfuVG','motion','Event\x20History','setObjectNotExistsAsync','fault','Deaktiviert\x20(Pro-Feature)','targetValue','string','lock','\x27\x20not\x20in\x20allowed\x20list)','analysis.history_debug_00','analysis.analysisHistory','light','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','info.','LTM.driftAnalysis.lastCheck','getGenerativeModel','Verbindung\x20erfolgreich!\x20Antwort:\x20','setState','Missing\x20data','stateChange','log','analysis.lastResult','value.health','Error\x20checking\x20WiFi:\x20','tÃ¼r','python3','ltmJob','analysisHistory','info','isGracePeriodActive','send','communicate.request','getLtmData','modeResetJob','ready','.forecast.current.temp','history.','Error\x20reading\x20outdoor\x20sensor\x20','testApiKey','node-schedule','message','state','common','Say\x20Hello','maintenance','Logbook','ack','System\x20Status\x20&\x20Control','\x20events)...','toISOString','Restoring\x20sensor\x20cache\x20from\x20history\x20(','accuweather.0','testNotification','admin.','Target\x20Value','temp','Baseline\x20Status','command','Fokus\x20auf\x20Familienroutinen.','0\x204\x20*\x20*\x20*','python_service','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','WETTER\x20ERROR:\x20','toLocaleString','getCalendarNames','activityLevel','temperature','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','warn','PONG','now','logDuplicates','events.history_debug_00','Recorded\x20Motion\x20Sequences','Gemini\x20Init\x20Error:\x20','split','ANALYZE_TREND','simulateButler','enum','system.meta.uuid','15391WMjPNe','PRIORITÃ„T:\x20Sicherheit.','connection','Daily\x20Digests','from','dutycycle','LTM.trainingData','Fokus\x20auf\x20Komfort.','weatherInstance','getStateAsync','analysis.health.sleepScore','\x20presence\x20devices...','Entry\x20detected\x20via\x20'];a0_0x13e4=function(){return _0x4332be;};return a0_0x13e4();}function installPythonDependencies(_0x3e523e){const _0x212d81=a0_0xe721b5;if(_0x3e523e[_0x212d81(0x2f2)])return;_0x3e523e[_0x212d81(0x2f2)]=!![];const _0x379405=path['join'](__dirname,_0x212d81(0x1b9),'requirements.txt');_0x3e523e[_0x212d81(0x191)]['info'](_0x212d81(0x230)+_0x379405+'...'),stopPythonService(_0x3e523e);const _0xe690a8=_0x212d81(0x2f0)+_0x379405+_0x212d81(0x219);exec(_0xe690a8,(_0x22c82f,_0x2645f5,_0x177379)=>{const _0x40ad19=_0x212d81;_0x3e523e[_0x40ad19(0x2f2)]=![],_0x22c82f?(_0x3e523e[_0x40ad19(0x191)][_0x40ad19(0x279)]('âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0xe690a8),_0x3e523e[_0x40ad19(0x191)]['error'](_0x40ad19(0x1de)+(_0x177379||_0x22c82f[_0x40ad19(0x1a5)]))):(_0x3e523e[_0x40ad19(0x191)]['info']('âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...'),startPythonService(_0x3e523e));});}function sendToPython(_0x218cac,_0x2c9a0b,_0x2672d3={}){const _0x5a53e1=a0_0xe721b5;if(!_0x218cac[_0x5a53e1(0x26e)]||!_0x218cac[_0x5a53e1(0x26e)]['stdin'][_0x5a53e1(0x20c)])return;const _0xf60e4d=JSON[_0x5a53e1(0x34a)]({'command':_0x2c9a0b,..._0x2672d3});try{_0x218cac['pythonProcess']['stdin'][_0x5a53e1(0x234)](_0xf60e4d+'\x0a');}catch(_0x5b948f){_0x218cac['log'][_0x5a53e1(0x279)]('Failed\x20to\x20send\x20to\x20Python:\x20'+_0x5b948f[_0x5a53e1(0x1a5)]);}}function runPythonHealthCheck(_0x282f36){const _0xf562bc=a0_0xe721b5;if(!_0x282f36[_0xf562bc(0x28f)]||_0x282f36['dailyDigests'][_0xf562bc(0x2e3)]<0x2){_0x282f36[_0xf562bc(0x191)]['info'](_0xf562bc(0x1f8));return;}const _0x2c47b9=_0x282f36['dailyDigests'][_0xf562bc(0x21c)](_0x27b8f9=>{const _0x4ead18=_0xf562bc,_0x8b2517=(_0x27b8f9['activityLevel']||'')[_0x4ead18(0x2df)]();return ACTIVITY_LEVEL_MAP[_0x8b2517]||0x32;});_0x282f36[_0xf562bc(0x191)][_0xf562bc(0x199)](_0xf562bc(0x212)+_0x2c47b9['length']+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x282f36,_0xf562bc(0x1c9),{'values':_0x2c47b9,'tag':'Activity-Level'});}function handlePythonResult(_0x129d67,_0x1e4e93){const _0x163508=a0_0xe721b5;if(_0x1e4e93[_0x163508(0x1e4)]===_0x163508(0x1c2))_0x129d67[_0x163508(0x191)]['debug'](_0x163508(0x2cc));else{if(_0x1e4e93[_0x163508(0x1e4)]===_0x163508(0x20b)){const {tag:_0xb0857b,diagnosis:_0x172091,change_percent:_0xc7247f}=_0x1e4e93[_0x163508(0x29c)];_0x129d67['log'][_0x163508(0x199)](_0x163508(0x35f)+_0xb0857b+_0x163508(0x25b)+_0x172091+'\x20('+_0xc7247f+'%)'),_0x129d67[_0x163508(0x245)]('analysis.health.trendDiagnosis',{'val':_0x172091,'ack':!![]}),_0x129d67['setStateAsync']('analysis.health.trendValue',{'val':_0xc7247f,'ack':!![]});}}}function startPythonService(_0xbdbd2){const _0xedc3b5=a0_0xe721b5;try{const _0x52395e=path[_0xedc3b5(0x349)](__dirname,'python_service',_0xedc3b5(0x2ed));_0xbdbd2['log'][_0xedc3b5(0x199)](_0xedc3b5(0x216)+_0x52395e),_0xbdbd2[_0xedc3b5(0x26e)]=spawn(_0xedc3b5(0x196),[_0x52395e]),_0xbdbd2[_0xedc3b5(0x26e)][_0xedc3b5(0x22e)]['on']('data',_0x59bbaf=>{const _0x2705d9=_0xedc3b5,_0x451fae=_0x59bbaf['toString']()[_0x2705d9(0x1c8)]('\x0a');_0x451fae[_0x2705d9(0x2f4)](_0x515abc=>{const _0x12ce91=_0x2705d9,_0x1e6ea8=_0x515abc[_0x12ce91(0x1e0)]();if(!_0x1e6ea8)return;if(_0x1e6ea8[_0x12ce91(0x292)](_0x12ce91(0x1e7)))_0xbdbd2[_0x12ce91(0x191)][_0x12ce91(0x2b2)](_0x12ce91(0x26d)+_0x1e6ea8[_0x12ce91(0x325)](0x5)[_0x12ce91(0x1e0)]());else{if(_0x1e6ea8[_0x12ce91(0x292)]('[RESULT]'))try{const _0x270d40=JSON[_0x12ce91(0x34e)](_0x1e6ea8[_0x12ce91(0x325)](0x8)['trim']());handlePythonResult(_0xbdbd2,_0x270d40);}catch(_0x37d6ed){_0xbdbd2[_0x12ce91(0x191)]['warn'](_0x12ce91(0x372)+_0x1e6ea8);}}(_0x1e6ea8[_0x12ce91(0x28e)](_0x12ce91(0x241))||_0x1e6ea8[_0x12ce91(0x28e)]('Bibliotheken\x20nicht\x20gefunden'))&&(_0xbdbd2['log']['warn'](_0x12ce91(0x2fe)),installPythonDependencies(_0xbdbd2));});}),_0xbdbd2[_0xedc3b5(0x26e)][_0xedc3b5(0x237)]['on']('data',_0x27f0ad=>{const _0x1526de=_0xedc3b5,_0x49ab3f=_0x27f0ad[_0x1526de(0x333)]()[_0x1526de(0x1e0)]();_0xbdbd2[_0x1526de(0x191)][_0x1526de(0x279)](_0x1526de(0x352)+_0x49ab3f);}),_0xbdbd2[_0xedc3b5(0x26e)]['on'](_0xedc3b5(0x2e0),_0x48ccb8=>{const _0x25ce56=_0xedc3b5;_0xbdbd2[_0x25ce56(0x191)][_0x25ce56(0x199)]('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x48ccb8),_0xbdbd2[_0x25ce56(0x26e)]=null;}),_0xbdbd2['pythonProcess']['on'](_0xedc3b5(0x279),_0x170225=>{const _0x41d0c7=_0xedc3b5;_0xbdbd2['log'][_0x41d0c7(0x1c1)](_0x41d0c7(0x33c)+_0x170225[_0x41d0c7(0x1a5)]);});}catch(_0x3bce4f){_0xbdbd2[_0xedc3b5(0x191)][_0xedc3b5(0x279)]('Error\x20launching\x20Python\x20service:\x20'+_0x3bce4f[_0xedc3b5(0x1a5)]);}}function stopPythonService(_0x1b088a){const _0x5bbe89=a0_0xe721b5;if(_0x1b088a['pythonProcess']){_0x1b088a[_0x5bbe89(0x191)]['info'](_0x5bbe89(0x17b));try{_0x1b088a['pythonProcess']['kill']();}catch(_0x3bcb0d){_0x1b088a[_0x5bbe89(0x191)]['warn']('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x3bcb0d[_0x5bbe89(0x1a5)]);}_0x1b088a[_0x5bbe89(0x26e)]=null;}}class CogniLiving extends utils[a0_0xe721b5(0x23b)]{constructor(_0x36751b){const _0xf3b10b=a0_0xe721b5;super({..._0x36751b,'name':_0xf3b10b(0x31c)}),this[_0xf3b10b(0x28a)]=[],this[_0xf3b10b(0x198)]=[],this['feedbackHistory']=[],this[_0xf3b10b(0x268)]=[],this[_0xf3b10b(0x28f)]=[],this[_0xf3b10b(0x227)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0xf3b10b(0x1f4)]=!![],this[_0xf3b10b(0x2be)]=null,this[_0xf3b10b(0x2ef)]=null,this[_0xf3b10b(0x19a)]=![],this['genAI']=null,this[_0xf3b10b(0x1fb)]=null,this['currentSystemMode']=SYSTEM_MODES[_0xf3b10b(0x26b)],this[_0xf3b10b(0x2ca)]=![],this[_0xf3b10b(0x31b)]=![],this[_0xf3b10b(0x20d)]='unknown',this[_0xf3b10b(0x273)]=null,this[_0xf3b10b(0x197)]=null,this[_0xf3b10b(0x19e)]=null,this['driftAnalysisTimer']=null,this[_0xf3b10b(0x255)]=null,this[_0xf3b10b(0x26e)]=null,this[_0xf3b10b(0x2f2)]=![],this['on'](_0xf3b10b(0x19f),this[_0xf3b10b(0x361)][_0xf3b10b(0x33a)](this)),this['on'](_0xf3b10b(0x190),this['onStateChange']['bind'](this)),this['on'](_0xf3b10b(0x2b3),this[_0xf3b10b(0x36c)][_0xf3b10b(0x33a)](this)),this['on'](_0xf3b10b(0x1a5),this['onMessage'][_0xf3b10b(0x33a)](this));}async['onReady'](){const _0x51825d=a0_0xe721b5;this[_0x51825d(0x191)][_0x51825d(0x199)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x51825d(0x21a)]+_0x51825d(0x209)),await initZombies(this),this[_0x51825d(0x1db)][_0x51825d(0x329)]=this[_0x51825d(0x1db)]['licenseKey']||'';try{this[_0x51825d(0x2ca)]=await checkLicense(this,this[_0x51825d(0x1db)][_0x51825d(0x329)]);}catch(_0x25a8e3){}this[_0x51825d(0x191)]['info'](_0x51825d(0x33b)+!!this[_0x51825d(0x1db)][_0x51825d(0x329)]+'\x20|\x20Status:\x20'+(this['isProVersion']?_0x51825d(0x215):_0x51825d(0x260)));if(!this[_0x51825d(0x1db)][_0x51825d(0x320)]||this[_0x51825d(0x1db)]['inactivityThresholdHours']<0.1)this[_0x51825d(0x1db)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this['config'][_0x51825d(0x1fc)])try{this[_0x51825d(0x322)]=new GoogleGenerativeAI(this[_0x51825d(0x1db)][_0x51825d(0x1fc)]),this[_0x51825d(0x1fb)]=this[_0x51825d(0x322)][_0x51825d(0x18c)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x51825d(0x2ba)}}),this['log']['info'](_0x51825d(0x23f));}catch(_0x5eb77f){this[_0x51825d(0x191)][_0x51825d(0x279)](_0x51825d(0x1c7)+_0x5eb77f[_0x51825d(0x1a5)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x51825d(0x23c)](_0x51825d(0x2e2)),this[_0x51825d(0x23c)](LTM_DP_TRIGGER_DIGEST),this[_0x51825d(0x23c)](_0x51825d(0x347)),this[_0x51825d(0x23c)](_0x51825d(0x270)),this[_0x51825d(0x23c)](_0x51825d(0x367)),this['subscribeStates'](_0x51825d(0x332)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x51825d(0x273)])clearInterval(this[_0x51825d(0x273)]);const _0x3ec342=this[_0x51825d(0x1db)][_0x51825d(0x32c)]||0xf;_0x3ec342>0x0&&(this[_0x51825d(0x191)][_0x51825d(0x199)]('Starting\x20Autopilot\x20('+_0x3ec342+_0x51825d(0x1f6)),this['analysisTimer']=setInterval(()=>{runAutopilot(this);},_0x3ec342*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x588ead=_0x51825d;this[_0x588ead(0x26e)]&&runPythonHealthCheck(this);},0x1388);}[a0_0xe721b5(0x36c)](_0x2c3baa){const _0x4b0e86=a0_0xe721b5;if(this[_0x4b0e86(0x273)])clearInterval(this[_0x4b0e86(0x273)]);if(this[_0x4b0e86(0x32e)])clearInterval(this[_0x4b0e86(0x32e)]);if(this[_0x4b0e86(0x197)])this[_0x4b0e86(0x197)]['cancel']();if(this['modeResetJob'])this[_0x4b0e86(0x19e)][_0x4b0e86(0x228)]();if(this[_0x4b0e86(0x255)])this['briefingJob']['cancel']();if(this[_0x4b0e86(0x2be)])clearTimeout(this[_0x4b0e86(0x2be)]);if(this[_0x4b0e86(0x2ef)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x2c3baa();}async[a0_0xe721b5(0x289)](_0x570bcd,_0x4c1a3c){const _0x14a40c=a0_0xe721b5;if(!_0x4c1a3c)return;if(_0x570bcd[_0x14a40c(0x28e)](_0x14a40c(0x312))&&_0x570bcd[_0x14a40c(0x21b)](_0x14a40c(0x19c))&&_0x4c1a3c[_0x14a40c(0x2c6)]){await handleTelegramResponse(this,_0x4c1a3c[_0x14a40c(0x2c6)]);return;}if(_0x570bcd===this[_0x14a40c(0x376)]+'.'+SYSTEM_DP_MODE){_0x4c1a3c['val']&&Object[_0x14a40c(0x29b)](SYSTEM_MODES)[_0x14a40c(0x28e)](_0x4c1a3c[_0x14a40c(0x2c6)])&&(this[_0x14a40c(0x34f)]=_0x4c1a3c['val'],_0x4c1a3c[_0x14a40c(0x2c6)]===SYSTEM_MODES[_0x14a40c(0x301)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x4c1a3c[_0x14a40c(0x1ab)])this['setState'](_0x570bcd,{'val':this[_0x14a40c(0x34f)],'ack':!![]});return;}if(!_0x4c1a3c[_0x14a40c(0x1ab)]){_0x570bcd[_0x14a40c(0x28e)](_0x14a40c(0x2e2))&&_0x4c1a3c['val']&&(this[_0x14a40c(0x18e)](_0x570bcd,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x570bcd[_0x14a40c(0x28e)](_0x14a40c(0x1e3))&&_0x4c1a3c['val']){this[_0x14a40c(0x18e)](_0x570bcd,{'val':![],'ack':!![]});if(this[_0x14a40c(0x2ca)])createDailyDigest(this);}_0x570bcd['includes'](_0x14a40c(0x2c0))&&_0x4c1a3c[_0x14a40c(0x2c6)]&&(this[_0x14a40c(0x18e)](_0x570bcd,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x570bcd[_0x14a40c(0x28e)](_0x14a40c(0x23a))&&_0x4c1a3c['val']&&(this['setState'](_0x570bcd,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x14a40c(0x1db)][_0x14a40c(0x1e1)]&&this['config']['presenceDevices'][_0x14a40c(0x28e)](_0x570bcd)){await checkWifiPresence(this);return;}const _0x5b0c5c=(this[_0x14a40c(0x1db)][_0x14a40c(0x2d5)]||[])[_0x14a40c(0x2e7)](_0x23b247=>_0x23b247['id']===_0x570bcd);if(_0x5b0c5c)processSensorEvent(this,_0x570bcd,_0x4c1a3c,_0x5b0c5c);}async[a0_0xe721b5(0x335)](_0x5270c9){const _0x5b2d66=a0_0xe721b5;if(typeof _0x5270c9==='object'&&_0x5270c9[_0x5b2d66(0x1a5)])try{if(_0x5270c9[_0x5b2d66(0x1b6)]===_0x5b2d66(0x1a3)){const _0x548cf7=_0x5270c9[_0x5b2d66(0x1a5)]['apiKey']||this[_0x5b2d66(0x1db)][_0x5b2d66(0x1fc)];if(!_0x548cf7)return this[_0x5b2d66(0x319)](_0x5270c9['from'],_0x5270c9['command'],{'success':![],'message':_0x5b2d66(0x293)},_0x5270c9[_0x5b2d66(0x321)]);try{const _0x4be71f=new GoogleGenerativeAI(_0x548cf7),_0x28f53f=_0x4be71f[_0x5b2d66(0x18c)]({'model':GEMINI_MODEL}),_0x3e4690=await _0x28f53f[_0x5b2d66(0x2f6)](_0x5b2d66(0x1a8)),_0x448249=await _0x3e4690[_0x5b2d66(0x2c5)],_0x2021c8=_0x448249[_0x5b2d66(0x2d8)]();this[_0x5b2d66(0x319)](_0x5270c9[_0x5b2d66(0x1d1)],_0x5270c9[_0x5b2d66(0x1b6)],{'success':!![],'message':_0x5b2d66(0x18d)+_0x2021c8[_0x5b2d66(0x325)](0x0,0x14)+_0x5b2d66(0x29e)},_0x5270c9[_0x5b2d66(0x321)]);}catch(_0x248e27){this['sendTo'](_0x5270c9['from'],_0x5270c9[_0x5b2d66(0x1b6)],{'success':![],'message':_0x5b2d66(0x25d)+_0x248e27[_0x5b2d66(0x1a5)]},_0x5270c9[_0x5b2d66(0x321)]);}}else{if(_0x5270c9[_0x5b2d66(0x1b6)]===_0x5b2d66(0x1b1)){}else{if(_0x5270c9['command']===_0x5b2d66(0x19d)){if(!this[_0x5b2d66(0x2ca)])return this[_0x5b2d66(0x319)](_0x5270c9['from'],_0x5270c9[_0x5b2d66(0x1b6)],{'success':![],'isPro':![]},_0x5270c9['callback']);let _0x26f735={'status':'N/A','details':'','lastCheck':0x0};try{_0x26f735['status']=(await this[_0x5b2d66(0x1d6)](LTM_DP_DRIFT_STATUS))['val'],_0x26f735[_0x5b2d66(0x358)]=(await this[_0x5b2d66(0x1d6)](LTM_DP_DRIFT_DETAILS))[_0x5b2d66(0x2c6)],_0x26f735[_0x5b2d66(0x287)]=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x5b2d66(0x2c6)];}catch(_0x3eb699){}const _0x24f878=this[_0x5b2d66(0x198)]||[];this[_0x5b2d66(0x319)](_0x5270c9['from'],_0x5270c9[_0x5b2d66(0x1b6)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x5b2d66(0x28f)],'driftAnalysis':_0x26f735,'analysisHistory':_0x24f878},_0x5270c9[_0x5b2d66(0x321)]);}else{if(_0x5270c9['command']===_0x5b2d66(0x324)){const _0x1eadfe=this[_0x5b2d66(0x28f)]['length'],_0x57929f=new Date(),_0x59793e=new Date(_0x57929f[_0x5b2d66(0x225)](),_0x57929f['getMonth'](),_0x57929f['getDate']())[_0x5b2d66(0x20a)](),_0x44a765=this[_0x5b2d66(0x268)]['filter'](_0x3eba48=>new Date(_0x3eba48[_0x5b2d66(0x244)])[_0x5b2d66(0x20a)]()>_0x59793e)[_0x5b2d66(0x2e3)],_0x465a23=new Array(0x18)[_0x5b2d66(0x25f)](0x0);this[_0x5b2d66(0x268)]['forEach'](_0x247e69=>{const _0x3c9d8b=_0x5b2d66,_0xcc72c=new Date(_0x247e69[_0x3c9d8b(0x244)]);if(_0xcc72c[_0x3c9d8b(0x20a)]()>_0x59793e)_0x465a23[_0xcc72c[_0x3c9d8b(0x1fa)]()]++;});let _0x56beb4={'status':'N/A'};try{_0x56beb4[_0x5b2d66(0x220)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x5b2d66(0x2c6)];}catch(_0x248cc4){}let _0xc8080d='';try{const _0x5412be=await this[_0x5b2d66(0x1d6)]('system.presenceWho');_0xc8080d=_0x5412be?_0x5412be[_0x5b2d66(0x2c6)]:'';}catch(_0x15fc30){}let _0x2bb357=null;!this[_0x5b2d66(0x1fb)]&&(_0x2bb357=this[_0x5b2d66(0x1db)]['geminiApiKey']?'KI-Modell\x20nicht\x20initialisiert':'Kein\x20API\x20Key!');let _0xd78094={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x35f34c=await this['getStateAsync'](_0x5b2d66(0x2d3)),_0x32ed92=await this[_0x5b2d66(0x1d6)](_0x5b2d66(0x204)),_0x973d1b=await this[_0x5b2d66(0x1d6)](_0x5b2d66(0x1ea)),_0x31fa40=await this[_0x5b2d66(0x1d6)](_0x5b2d66(0x318)),_0x1a3375=await this[_0x5b2d66(0x1d6)](_0x5b2d66(0x332));_0x35f34c&&_0x35f34c[_0x5b2d66(0x2c6)]&&(_0xd78094[_0x5b2d66(0x206)]=!![],_0xd78094[_0x5b2d66(0x250)]=_0x32ed92?_0x32ed92[_0x5b2d66(0x2c6)]:'',_0xd78094[_0x5b2d66(0x218)]=_0x973d1b?_0x973d1b[_0x5b2d66(0x2c6)]:'',_0xd78094[_0x5b2d66(0x182)]=_0x31fa40?_0x31fa40[_0x5b2d66(0x2c6)]:''),_0xd78094['autoApply']=_0x1a3375?!!_0x1a3375[_0x5b2d66(0x2c6)]:![];}catch(_0x3242b0){}this['sendTo'](_0x5270c9[_0x5b2d66(0x1d1)],_0x5270c9[_0x5b2d66(0x1b6)],{'success':!![],'eventHistory':this[_0x5b2d66(0x28a)][_0x5b2d66(0x2ea)](0x0,0xf),'stats':{'digestCount':_0x1eadfe,'eventCountToday':_0x44a765,'hourlyActivity':_0x465a23,'driftStatus':_0x56beb4[_0x5b2d66(0x220)],'isPresent':this[_0x5b2d66(0x1f4)],'presenceWho':_0xc8080d,'minDays':this[_0x5b2d66(0x1db)][_0x5b2d66(0x223)]||0x7,'stbDays':this[_0x5b2d66(0x1db)][_0x5b2d66(0x1fd)]||0xe,'ltbDays':this[_0x5b2d66(0x1db)][_0x5b2d66(0x2e4)]||0x3c,'systemError':_0x2bb357},'automation':_0xd78094},_0x5270c9[_0x5b2d66(0x321)]);}else{if(_0x5270c9['command']===_0x5b2d66(0x30d)){const _0x4ce532=await this[_0x5b2d66(0x2d9)](_0x5b2d66(0x2d0),'enum'),_0x400222=[];if(_0x4ce532)for(const _0x45fd5c in _0x4ce532){const _0x12d0f9=_0x4ce532[_0x45fd5c],_0x10e822=(_0x12d0f9[_0x5b2d66(0x1a7)]&&typeof _0x12d0f9[_0x5b2d66(0x1a7)][_0x5b2d66(0x31f)]==='object'?_0x12d0f9[_0x5b2d66(0x1a7)]['name']['de']:_0x12d0f9['common']['name'])||_0x12d0f9[_0x5b2d66(0x1a7)]['name'];_0x400222['push']({'id':_0x45fd5c,'name':_0x10e822});}this[_0x5b2d66(0x319)](_0x5270c9['from'],_0x5270c9[_0x5b2d66(0x1b6)],{'success':!![],'enums':_0x400222},_0x5270c9[_0x5b2d66(0x321)]);}else{if(_0x5270c9[_0x5b2d66(0x1b6)]===_0x5b2d66(0x2a6))try{const _0x44ba51=await scanForDevices(this,_0x5270c9[_0x5b2d66(0x1a5)]||{});this[_0x5b2d66(0x319)](_0x5270c9['from'],_0x5270c9[_0x5b2d66(0x1b6)],{'success':!![],'devices':_0x44ba51},_0x5270c9['callback']);}catch(_0x2447a4){this['sendTo'](_0x5270c9[_0x5b2d66(0x1d1)],_0x5270c9[_0x5b2d66(0x1b6)],{'success':![],'error':_0x2447a4['message']},_0x5270c9[_0x5b2d66(0x321)]);}else{if(_0x5270c9[_0x5b2d66(0x1b6)]===_0x5b2d66(0x1bd)){const _0x8f3f90=_0x5270c9[_0x5b2d66(0x1a5)][_0x5b2d66(0x35d)];if(!_0x8f3f90)return this[_0x5b2d66(0x319)](_0x5270c9[_0x5b2d66(0x1d1)],_0x5270c9[_0x5b2d66(0x1b6)],{'success':![],'error':_0x5b2d66(0x28b)},_0x5270c9[_0x5b2d66(0x321)]);const _0x497aea=await getCalendarNames(this,_0x8f3f90);this[_0x5b2d66(0x319)](_0x5270c9[_0x5b2d66(0x1d1)],_0x5270c9[_0x5b2d66(0x1b6)],{'success':!![],'names':_0x497aea},_0x5270c9['callback']);}else{if(_0x5270c9[_0x5b2d66(0x1b6)]===_0x5b2d66(0x1ca)){const {targetId:_0x322161,targetValue:_0x10a600}=_0x5270c9[_0x5b2d66(0x1a5)];this[_0x5b2d66(0x191)][_0x5b2d66(0x199)](_0x5b2d66(0x1c0)+_0x322161+_0x5b2d66(0x1dc)+_0x10a600),await this['setStateAsync'](_0x5b2d66(0x2d3),{'val':!![],'ack':!![]}),await this[_0x5b2d66(0x245)]('analysis.automation.description',{'val':_0x5b2d66(0x189)+_0x322161,'ack':!![]}),await this[_0x5b2d66(0x245)](_0x5b2d66(0x1ea),{'val':_0x322161,'ack':!![]}),await this[_0x5b2d66(0x245)](_0x5b2d66(0x318),{'val':_0x10a600,'ack':!![]}),this['sendTo'](_0x5270c9[_0x5b2d66(0x1d1)],_0x5270c9['command'],{'success':!![]},_0x5270c9[_0x5b2d66(0x321)]);}else{if(_0x5270c9[_0x5b2d66(0x1b6)]===_0x5b2d66(0x339)){const {historyId:_0x4665da,rating:_0x15fe2d,comment:_0x235ded,alertReason:_0x2db5ea}=_0x5270c9['message'];_0x4665da&&_0x15fe2d?(await saveFeedback(this,{'timestamp':Date[_0x5b2d66(0x1c3)](),'historyId':_0x4665da,'rating':_0x15fe2d,'comment':_0x235ded,'alertReason':_0x2db5ea}),this[_0x5b2d66(0x319)](_0x5270c9[_0x5b2d66(0x1d1)],_0x5270c9['command'],{'success':!![]},_0x5270c9[_0x5b2d66(0x321)])):this[_0x5b2d66(0x319)](_0x5270c9[_0x5b2d66(0x1d1)],_0x5270c9[_0x5b2d66(0x1b6)],{'success':![],'error':_0x5b2d66(0x18f)},_0x5270c9[_0x5b2d66(0x321)]);}else _0x5270c9[_0x5b2d66(0x1b6)]===_0x5b2d66(0x286)&&(this[_0x5b2d66(0x191)][_0x5b2d66(0x199)]('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x5b2d66(0x2d3),{'val':![],'ack':!![]}),await this[_0x5b2d66(0x245)](_0x5b2d66(0x204),{'val':'','ack':!![]}),this[_0x5b2d66(0x319)](_0x5270c9['from'],_0x5270c9[_0x5b2d66(0x1b6)],{'success':!![]},_0x5270c9[_0x5b2d66(0x321)]));}}}}}}}}}catch(_0x17ac5d){this[_0x5b2d66(0x191)]['error'](_0x5b2d66(0x210)+_0x5270c9[_0x5b2d66(0x1b6)]+':\x20'+_0x17ac5d[_0x5b2d66(0x1a5)]);if(_0x5270c9[_0x5b2d66(0x321)])this[_0x5b2d66(0x319)](_0x5270c9['from'],_0x5270c9[_0x5b2d66(0x1b6)],{'success':![],'error':_0x17ac5d['message']},_0x5270c9[_0x5b2d66(0x321)]);}}}if(require[a0_0xe721b5(0x27a)]!==module)module['exports']=_0x39921f=>new CogniLiving(_0x39921f);else new CogniLiving();