const a0_0x40b09f=a0_0x4168;(function(_0x327ff4,_0x3c3192){const _0x1b2e26=a0_0x4168,_0x29ec3a=_0x327ff4();while(!![]){try{const _0x1922bc=-parseInt(_0x1b2e26(0xf6))/0x1*(-parseInt(_0x1b2e26(0x282))/0x2)+-parseInt(_0x1b2e26(0x79))/0x3+parseInt(_0x1b2e26(0x28e))/0x4*(-parseInt(_0x1b2e26(0x29b))/0x5)+-parseInt(_0x1b2e26(0x245))/0x6*(-parseInt(_0x1b2e26(0x154))/0x7)+-parseInt(_0x1b2e26(0x1d1))/0x8+parseInt(_0x1b2e26(0xfb))/0x9*(parseInt(_0x1b2e26(0x17c))/0xa)+parseInt(_0x1b2e26(0xe6))/0xb;if(_0x1922bc===_0x3c3192)break;else _0x29ec3a['push'](_0x29ec3a['shift']());}catch(_0x1e5226){_0x29ec3a['push'](_0x29ec3a['shift']());}}}(a0_0x2436,0xe7829));const a0_0x24c166=(function(){let _0x5f2048=!![];return function(_0x28ce22,_0x3108fa){const _0x5beae7=_0x5f2048?function(){const _0x348e0b=a0_0x4168;if(_0x3108fa){const _0x47b27d=_0x3108fa[_0x348e0b(0x1a2)](_0x28ce22,arguments);return _0x3108fa=null,_0x47b27d;}}:function(){};return _0x5f2048=![],_0x5beae7;};}()),a0_0xe332b3=a0_0x24c166(this,function(){const _0x39fc29=a0_0x4168;return a0_0xe332b3[_0x39fc29(0x238)]()[_0x39fc29(0x97)](_0x39fc29(0x1e6))['toString']()[_0x39fc29(0x99)](a0_0xe332b3)[_0x39fc29(0x97)](_0x39fc29(0x1e6));});a0_0xe332b3();'use strict';const utils=require(a0_0x40b09f(0x7e)),{GoogleGenerativeAI}=require(a0_0x40b09f(0x1b6)),schedule=require(a0_0x40b09f(0x153)),{spawn,exec}=require('child_process'),path=require(a0_0x40b09f(0x1e1)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x40b09f(0x80),LTM_SCHEDULE=a0_0x40b09f(0xde),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x40b09f(0x234),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x40b09f(0xc4),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x40b09f(0x144),LTM_DP_DRIFT_DETAILS=a0_0x40b09f(0x1ab),LTM_DP_DRIFT_LAST_CHECK=a0_0x40b09f(0xf3),SYSTEM_DP_MODE=a0_0x40b09f(0x165),HARD_IGNORE_TERMS=[a0_0x40b09f(0x7d),a0_0x40b09f(0xdb),'update',a0_0x40b09f(0x111),a0_0x40b09f(0x1d3),a0_0x40b09f(0x13b),a0_0x40b09f(0xa6),'maintenance',a0_0x40b09f(0xd8),a0_0x40b09f(0x149),a0_0x40b09f(0x1d5),a0_0x40b09f(0x12f),a0_0x40b09f(0x27b),'config_pending',a0_0x40b09f(0x1b5),a0_0x40b09f(0x223),a0_0x40b09f(0x1ad),a0_0x40b09f(0x285)],BAD_NAMES=[a0_0x40b09f(0x1f4),a0_0x40b09f(0x180),a0_0x40b09f(0x162),'level',a0_0x40b09f(0x122),a0_0x40b09f(0xbf),'on',a0_0x40b09f(0xd2),a0_0x40b09f(0x123),a0_0x40b09f(0x278),a0_0x40b09f(0xd5),a0_0x40b09f(0x7c),a0_0x40b09f(0xff),a0_0x40b09f(0x2a3),a0_0x40b09f(0x202),a0_0x40b09f(0x9f),a0_0x40b09f(0x18d),a0_0x40b09f(0x82),a0_0x40b09f(0x1f0),'power',a0_0x40b09f(0x276),'setpoint',a0_0x40b09f(0x155),a0_0x40b09f(0x6a),a0_0x40b09f(0x247)],ADAPTER_BLACKLIST=[a0_0x40b09f(0x1d6),a0_0x40b09f(0x132),a0_0x40b09f(0x13a),'vis.','history.',a0_0x40b09f(0x1ac),a0_0x40b09f(0x12e),'flot.',a0_0x40b09f(0x128),a0_0x40b09f(0x232),a0_0x40b09f(0x72)],SYSTEM_MODES={'NORMAL':a0_0x40b09f(0x22d),'VACATION':'vacation','PARTY':a0_0x40b09f(0x297),'GUEST':a0_0x40b09f(0x1b7)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x40b09f(0x17b)],SYSTEM_MODES[a0_0x40b09f(0x1ea)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x40b09f(0x22c),'family':a0_0x40b09f(0x1a4),'single_comfort':a0_0x40b09f(0x168),'security':a0_0x40b09f(0x1df)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x2aa8ca){const _0x32962d=a0_0x40b09f;try{const _0x34dbeb=[_0x32962d(0xd1),_0x32962d(0x1a0)];for(const _0x5e713d of _0x34dbeb){try{const _0x29b0a6=await _0x2aa8ca['getObjectAsync'](_0x5e713d);_0x29b0a6&&await _0x2aa8ca[_0x32962d(0x24d)](_0x5e713d);}catch(_0x2428a9){}}}catch(_0x405146){}}async function initHistory(_0x14bf25){const _0x43d34a=a0_0x40b09f;try{const _0x317837=await _0x14bf25[_0x43d34a(0x295)](_0x43d34a(0x21f));_0x317837&&_0x317837[_0x43d34a(0x193)]&&(_0x14bf25[_0x43d34a(0x263)]=JSON[_0x43d34a(0x199)](_0x317837[_0x43d34a(0x193)]['toString']()));}catch(_0xb8c9f3){_0x14bf25['eventHistory']=[];}try{const _0x361cfb=await _0x14bf25['getStateAsync'](_0x43d34a(0x1d9));if(_0x361cfb&&_0x361cfb[_0x43d34a(0x193)])_0x14bf25[_0x43d34a(0x272)]=JSON[_0x43d34a(0x199)](_0x361cfb['val']['toString']());}catch(_0x37139f){_0x14bf25[_0x43d34a(0x272)]=[];}if(_0x14bf25[_0x43d34a(0x263)]&&_0x14bf25[_0x43d34a(0x263)][_0x43d34a(0x131)]>0x0){_0x14bf25[_0x43d34a(0x159)][_0x43d34a(0x288)](_0x43d34a(0x194)+_0x14bf25[_0x43d34a(0x263)][_0x43d34a(0x131)]+_0x43d34a(0x1c6));for(let _0xa9b4e4=_0x14bf25[_0x43d34a(0x263)][_0x43d34a(0x131)]-0x1;_0xa9b4e4>=0x0;_0xa9b4e4--){const _0x634fba=_0x14bf25[_0x43d34a(0x263)][_0xa9b4e4];_0x634fba&&_0x634fba['id']!==undefined&&_0x634fba[_0x43d34a(0x122)]!==undefined&&(_0x14bf25[_0x43d34a(0x25b)][_0x634fba['id']]=_0x634fba[_0x43d34a(0x122)]);}}}async function initSystemConfig(_0x483135){const _0x1f7a6f=a0_0x40b09f;try{const _0x15eee8=await _0x483135['getForeignObjectAsync'](_0x1f7a6f(0x11b));_0x15eee8&&_0x15eee8[_0x1f7a6f(0xe2)]&&(_0x483135['systemConfig']={'latitude':_0x15eee8[_0x1f7a6f(0xe2)][_0x1f7a6f(0xbe)]||0x0,'longitude':_0x15eee8['common'][_0x1f7a6f(0x1dc)]||0x0,'city':_0x15eee8[_0x1f7a6f(0xe2)][_0x1f7a6f(0xf0)]||''});}catch(_0x19bde8){}}async function checkLicense(_0x49dacf,_0x39d01b){const _0x38500d=a0_0x40b09f;if(!_0x39d01b)return![];_0x49dacf[_0x38500d(0x147)]=await getSystemUUID(_0x49dacf);if(_0x39d01b===_0x38500d(0x170)||_0x39d01b['startsWith']('PRO-'))return!![];return![];}async function getSystemUUID(_0x5ea579){const _0x92a6e3=a0_0x40b09f;try{const _0x4c7022=await _0x5ea579[_0x92a6e3(0xe5)]('system.meta.uuid');if(_0x4c7022&&_0x4c7022[_0x92a6e3(0x28d)]&&_0x4c7022[_0x92a6e3(0x28d)][_0x92a6e3(0x1b9)])return _0x4c7022[_0x92a6e3(0x28d)][_0x92a6e3(0x1b9)];return _0x92a6e3(0xcf);}catch(_0x504ee7){return'uuid-error';}}async function createAllObjects(_0x4aeef8){const _0x26096c=a0_0x40b09f;await checkSystemObjects(_0x4aeef8),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x145),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x1c8),'type':_0x26096c(0x20a),'role':_0x26096c(0x16c),'read':!![],'write':![],'def':''},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync']('events.lastEvent',{'type':'state','common':{'name':_0x26096c(0x20e),'type':_0x26096c(0x20a),'role':_0x26096c(0xb0),'read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x21f),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x1bf),'type':_0x26096c(0x20a),'role':_0x26096c(0xb0),'read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)]('analysis.trigger',{'type':_0x26096c(0x162),'common':{'name':'Trigger\x20Analysis','type':_0x26096c(0x1f8),'role':_0x26096c(0x268),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)]('analysis.triggerBriefing',{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x298),'type':_0x26096c(0x1f8),'role':_0x26096c(0x268),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4aeef8[_0x26096c(0xf1)](_0x26096c(0x29a),{'type':'channel','common':{'name':_0x26096c(0xaf)},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync'](_0x26096c(0xb5),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x2a1),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x279),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x95),'type':_0x26096c(0x20a),'role':_0x26096c(0x16c),'read':!![],'write':![],'def':_0x26096c(0x11f)},'native':{}}),await _0x4aeef8[_0x26096c(0x177)]('analysis.lastResult',{'type':'state','common':{'name':_0x26096c(0xc3),'type':_0x26096c(0x20a),'role':_0x26096c(0xb0),'read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x1cc),{'type':_0x26096c(0x162),'common':{'name':'AI\x20Alert\x20Status','type':_0x26096c(0x1f8),'role':_0x26096c(0x270),'read':!![],'write':![],'def':![]},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync'](_0x26096c(0x14e),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x6b),'type':_0x26096c(0x1f8),'role':_0x26096c(0x179),'read':!![],'write':![],'def':![]},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync'](_0x26096c(0x267),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x291),'type':_0x26096c(0x20a),'role':_0x26096c(0x184),'read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)]('analysis.activitySummary',{'type':'state','common':{'name':'Activity\x20Summary','type':_0x26096c(0x20a),'role':_0x26096c(0x16c),'read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)]('analysis.deviationFromBaseline',{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x1cb),'type':_0x26096c(0x20a),'role':_0x26096c(0x162),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x17d),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x1c1),'type':_0x26096c(0x20a),'role':_0x26096c(0x16c),'read':!![],'write':![]},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync'](_0x26096c(0x15a),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x12b),'type':_0x26096c(0x20a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0xf1)](_0x26096c(0x17a),{'type':'channel','common':{'name':'Automation\x20Proposals'},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x248),{'type':'state','common':{'name':_0x26096c(0x1c5),'type':_0x26096c(0x1f8),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0xda),{'type':'state','common':{'name':'Description','type':_0x26096c(0x20a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync'](_0x26096c(0x286),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x183),'type':_0x26096c(0x20a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0xb2),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x10c),'type':_0x26096c(0x20a),'role':_0x26096c(0x16c),'read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x261),{'type':'state','common':{'name':_0x26096c(0xb7),'type':_0x26096c(0x20a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x242),{'type':'state','common':{'name':_0x26096c(0x92),'type':'boolean','role':_0x26096c(0x123),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)]('analysis.automation.triggerAction',{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x2a2),'type':'boolean','role':_0x26096c(0x268),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x1d9),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x23c),'type':_0x26096c(0x20a),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x240),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x9d),'type':_0x26096c(0x20a),'role':_0x26096c(0xb0),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x4aeef8['extendObjectAsync'](_0x26096c(0xd4),{'type':_0x26096c(0x6f),'common':{'name':_0x26096c(0x17e)},'native':{}}),await _0x4aeef8[_0x26096c(0x177)]('analysis.health.sleepScore',{'type':_0x26096c(0x162),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x26096c(0x20f),'role':_0x26096c(0x1d2),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x4aeef8[_0x26096c(0x177)]('analysis.health.restlessness',{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0x225),'type':'string','role':_0x26096c(0x16c),'read':!![],'write':![],'def':_0x26096c(0xce)},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x10d),{'type':'state','common':{'name':_0x26096c(0x257),'type':_0x26096c(0x20a),'role':_0x26096c(0x16c),'read':!![],'write':![],'def':''},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync'](_0x26096c(0x148),{'type':_0x26096c(0x162),'common':{'name':'Trend\x20Diagnosis\x20(Python)','type':_0x26096c(0x20a),'role':_0x26096c(0x16c),'read':!![],'write':![],'def':_0x26096c(0x2a5)},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync'](_0x26096c(0xa5),{'type':_0x26096c(0x162),'common':{'name':'Trend\x20Value\x20(%)','type':'number','role':'value','read':!![],'write':![],'def':0x0},'native':{}}),await _0x4aeef8[_0x26096c(0xf1)](_0x26096c(0x281),{'type':_0x26096c(0x6f),'common':{'name':_0x26096c(0x230)},'native':{}}),await _0x4aeef8['setObjectNotExistsAsync'](_0x26096c(0x172),{'type':_0x26096c(0x162),'common':{'name':_0x26096c(0xad),'type':_0x26096c(0x20a),'role':'json','read':!![],'write':![],'def':'[]','desc':_0x26096c(0x1e4)},'native':{}}),await _0x4aeef8[_0x26096c(0x177)](_0x26096c(0x299),{'type':'state','common':{'name':_0x26096c(0x9a),'type':_0x26096c(0x20a),'role':_0x26096c(0xb0),'read':!![],'write':![],'def':'[]','desc':_0x26096c(0xa4)},'native':{}}),await checkLtmObjects(_0x4aeef8),await checkLtmDriftObjects(_0x4aeef8);}async function checkSystemObjects(_0x40fb45){const _0xa579f2=a0_0x40b09f;await _0x40fb45['extendObjectAsync'](_0xa579f2(0x27c),{'type':_0xa579f2(0x6f),'common':{'name':_0xa579f2(0x283)},'native':{}}),await _0x40fb45[_0xa579f2(0xf1)](SYSTEM_DP_MODE,{'type':_0xa579f2(0x162),'common':{'name':_0xa579f2(0x205),'type':_0xa579f2(0x20a),'role':_0xa579f2(0x162),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES['NORMAL']]:_0xa579f2(0x178),[SYSTEM_MODES[_0xa579f2(0x13f)]]:_0xa579f2(0x10b),[SYSTEM_MODES[_0xa579f2(0x17b)]]:_0xa579f2(0x210),[SYSTEM_MODES['GUEST']]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x2eaa1d){const _0x1aec78=a0_0x40b09f;await _0x2eaa1d[_0x1aec78(0xf1)](_0x1aec78(0x28f),{'type':_0x1aec78(0x6f),'common':{'name':_0x1aec78(0x28f)},'native':{}}),await _0x2eaa1d[_0x1aec78(0xf1)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x1aec78(0x24b),'type':_0x1aec78(0x20a),'role':_0x1aec78(0xb0),'read':!![],'write':![]},'native':{}}),await _0x2eaa1d[_0x1aec78(0xf1)](LTM_DP_DAILY_DIGESTS,{'type':_0x1aec78(0x162),'common':{'name':'Daily\x20Digests','type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x2eaa1d['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x1aec78(0x162),'common':{'name':_0x1aec78(0xd7),'type':'string','role':_0x1aec78(0x16c),'read':!![],'write':![]},'native':{}}),await _0x2eaa1d[_0x1aec78(0xf1)](LTM_DP_TRIGGER_DIGEST,{'type':_0x1aec78(0x162),'common':{'name':_0x1aec78(0x163),'type':_0x1aec78(0x1f8),'role':_0x1aec78(0x268),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2eaa1d[_0x1aec78(0xf1)](LTM_DP_BASELINE_STATUS,{'type':_0x1aec78(0x162),'common':{'name':_0x1aec78(0x198),'type':_0x1aec78(0x20a),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4e8270){const _0x4525c6=a0_0x40b09f;await _0x4e8270['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x4525c6(0x6f),'common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x4e8270['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x4525c6(0x119),'type':_0x4525c6(0x20a),'role':_0x4525c6(0x162),'read':!![],'write':![],'def':_0x4525c6(0x2a5)},'native':{}}),await _0x4e8270['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x4525c6(0x162),'common':{'name':_0x4525c6(0x220),'type':_0x4525c6(0x20a),'role':_0x4525c6(0x16c),'read':!![],'write':![]},'native':{}}),await _0x4e8270[_0x4525c6(0xf1)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':'Last\x20Check','type':_0x4525c6(0x20f),'role':_0x4525c6(0x7a),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x2dbc6f){const _0x14991f=a0_0x40b09f;try{const _0x21e944=await _0x2dbc6f[_0x14991f(0x295)](SYSTEM_DP_MODE);_0x21e944&&_0x21e944[_0x14991f(0x193)]&&Object['values'](SYSTEM_MODES)['includes'](_0x21e944[_0x14991f(0x193)])?_0x2dbc6f[_0x14991f(0x212)]=_0x21e944[_0x14991f(0x193)]:(_0x2dbc6f[_0x14991f(0x212)]=SYSTEM_MODES[_0x14991f(0x255)],await _0x2dbc6f['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x14991f(0x255)],'ack':!![]}));}catch(_0x507f3e){_0x2dbc6f[_0x14991f(0x212)]=SYSTEM_MODES[_0x14991f(0x255)];}}async function loadRawEventLog(_0x20c34e){const _0x5e0a12=a0_0x40b09f;try{const _0xda6899=await _0x20c34e[_0x5e0a12(0x295)](LTM_DP_RAW_LOG);if(_0xda6899&&_0xda6899['val'])_0x20c34e['rawEventLog']=JSON[_0x5e0a12(0x199)](_0xda6899[_0x5e0a12(0x193)]);}catch(_0x249a09){_0x20c34e['rawEventLog']=[];}}async function saveRawEventLog(_0x5e853e){const _0x417095=a0_0x40b09f;_0x5e853e['rawEventLog'][_0x417095(0x131)]>RAW_LOG_MAX_SIZE&&_0x5e853e[_0x417095(0xa9)][_0x417095(0x13c)](0x0,_0x5e853e[_0x417095(0xa9)][_0x417095(0x131)]-RAW_LOG_MAX_SIZE),await _0x5e853e[_0x417095(0x10a)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x5e853e['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x1c9b7d){const _0x8378fe=a0_0x40b09f;try{const _0x5882ae=await _0x1c9b7d['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x5882ae&&_0x5882ae['val'])_0x1c9b7d[_0x8378fe(0x1f6)]=JSON['parse'](_0x5882ae['val']);}catch(_0x39656d){_0x1c9b7d[_0x8378fe(0x1f6)]=[];}await updateBaselineStatus(_0x1c9b7d);}async function saveDailyDigests(_0x4e8af9,_0x5951b1=!![]){const _0x565a6d=a0_0x40b09f,_0x26fc60=_0x4e8af9[_0x565a6d(0x1b2)][_0x565a6d(0x187)]||0x3c;_0x4e8af9[_0x565a6d(0x1f6)]['length']>_0x26fc60&&_0x4e8af9[_0x565a6d(0x1f6)][_0x565a6d(0x13c)](0x0,_0x4e8af9[_0x565a6d(0x1f6)][_0x565a6d(0x131)]-_0x26fc60);await _0x4e8af9[_0x565a6d(0x10a)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x4e8af9[_0x565a6d(0x1f6)]),'ack':!![]});if(_0x5951b1)await updateBaselineStatus(_0x4e8af9);}async function updateAnalysisHistory(_0x29bded,_0x32e9b1){const _0x52e8df=a0_0x40b09f;_0x29bded[_0x52e8df(0x272)]['unshift'](_0x32e9b1);if(_0x29bded[_0x52e8df(0x272)][_0x52e8df(0x131)]>ANALYSIS_HISTORY_MAX_SIZE)_0x29bded[_0x52e8df(0x272)]['pop']();await _0x29bded['setStateAsync'](_0x52e8df(0x1d9),{'val':JSON[_0x52e8df(0x287)](_0x29bded[_0x52e8df(0x272)]),'ack':!![]});}async function updateBaselineStatus(_0xdbf1e3){const _0xb88e31=a0_0x40b09f;if(!_0xdbf1e3['isProVersion']){await _0xdbf1e3[_0xb88e31(0x10a)](LTM_DP_BASELINE_STATUS,{'val':_0xb88e31(0x18e),'ack':!![]});return;}const _0x112e35=_0xdbf1e3[_0xb88e31(0x1f6)][_0xb88e31(0x131)]>=(_0xdbf1e3[_0xb88e31(0x1b2)][_0xb88e31(0x251)]||0x7)?_0xb88e31(0x71)+_0xdbf1e3[_0xb88e31(0x1f6)][_0xb88e31(0x131)]+_0xb88e31(0x176):_0xb88e31(0x139)+_0xdbf1e3[_0xb88e31(0x1f6)][_0xb88e31(0x131)]+'/'+(_0xdbf1e3['config']['minDaysForBaseline']||0x7)+')';await _0xdbf1e3[_0xb88e31(0x10a)](LTM_DP_BASELINE_STATUS,{'val':_0x112e35,'ack':!![]});}function a0_0x4168(_0x430b40,_0x501251){const _0x2f3a4e=a0_0x2436();return a0_0x4168=function(_0xe332b3,_0x24c166){_0xe332b3=_0xe332b3-0x6a;let _0x24362d=_0x2f3a4e[_0xe332b3];return _0x24362d;},a0_0x4168(_0x430b40,_0x501251);}async function initSensorSubscriptions(_0x408853){const _0x2d4ab5=a0_0x40b09f,_0x5c7915=_0x408853['config'][_0x2d4ab5(0x11d)];if(_0x5c7915&&_0x5c7915['length']>0x0){_0x408853[_0x2d4ab5(0x159)][_0x2d4ab5(0x288)](_0x2d4ab5(0xe0)+_0x5c7915['length']+'\x20sensors...');for(const _0x13c616 of _0x5c7915){if(_0x13c616['id']){await _0x408853[_0x2d4ab5(0x280)](_0x13c616['id']);try{const _0x1dd8a5=await _0x408853[_0x2d4ab5(0x23e)](_0x13c616['id']);if(_0x1dd8a5)_0x408853['sensorLastValues'][_0x13c616['id']]=_0x1dd8a5['val'];}catch(_0x18c5ca){}}}}}async function initPresenceSubscriptions(_0x5e40e2){const _0x2edd14=a0_0x40b09f,_0x52d2f7=_0x5e40e2[_0x2edd14(0x1b2)]['presenceDevices']||[];if(_0x52d2f7[_0x2edd14(0x131)]>0x0){_0x5e40e2[_0x2edd14(0x159)][_0x2edd14(0x288)](_0x2edd14(0xe0)+_0x52d2f7['length']+_0x2edd14(0x15e));for(const _0x6c2353 of _0x52d2f7){await _0x5e40e2[_0x2edd14(0x280)](_0x6c2353);}try{await checkWifiPresence(_0x5e40e2);}catch(_0x474058){}}}async function getWeatherContext(_0x27e9bc){const _0x3bc5e0=a0_0x40b09f;try{if(!_0x27e9bc['config'][_0x3bc5e0(0x19e)])return _0x3bc5e0(0x284);let _0x335e9c='';const _0x4bb9e5=_0x27e9bc[_0x3bc5e0(0x1b2)]['weatherInstance'];if(_0x4bb9e5)try{if(_0x4bb9e5[_0x3bc5e0(0xfc)](_0x3bc5e0(0x2a6))){const _0x289ab6=await _0x27e9bc[_0x3bc5e0(0x23e)](_0x4bb9e5+'.Summary.Current');if(_0x289ab6&&_0x289ab6['val'])_0x335e9c=_0x289ab6[_0x3bc5e0(0x193)];}else{if(_0x4bb9e5[_0x3bc5e0(0xfc)]('daswetter')){const _0x18e013=await _0x27e9bc[_0x3bc5e0(0x23e)](_0x4bb9e5+_0x3bc5e0(0x29e));if(_0x18e013&&_0x18e013['val'])_0x335e9c=_0x18e013[_0x3bc5e0(0x193)];}else{if(_0x4bb9e5[_0x3bc5e0(0xfc)]('openweathermap')){const _0x3d09d4=await _0x27e9bc[_0x3bc5e0(0x23e)](_0x4bb9e5+_0x3bc5e0(0x20d));if(_0x3d09d4&&_0x3d09d4[_0x3bc5e0(0x193)])_0x335e9c=_0x3d09d4['val'];}}}}catch(_0x2bbfed){}if(!_0x335e9c){const _0x1ff903=[_0x3bc5e0(0x192),_0x3bc5e0(0x185),_0x3bc5e0(0x252),_0x3bc5e0(0xf2)];for(const _0x3a5d60 of _0x1ff903){try{const _0x33fa08=await _0x27e9bc['getForeignObjectAsync'](_0x3a5d60);if(_0x33fa08){if(_0x3a5d60['includes'](_0x3bc5e0(0x2a6))){const _0x54094a=await _0x27e9bc[_0x3bc5e0(0x23e)](_0x3a5d60+_0x3bc5e0(0x181));if(_0x54094a&&_0x54094a[_0x3bc5e0(0x193)]){_0x335e9c=_0x54094a[_0x3bc5e0(0x193)];break;}}}}catch(_0x2a17d4){}}}return _0x335e9c?'WETTER:\x20'+_0x335e9c:_0x3bc5e0(0x1fe);}catch(_0x2264a0){return _0x3bc5e0(0x296)+_0x2264a0[_0x3bc5e0(0x265)];}}async function getCalendarContext(_0x4720c4){const _0x1ee534=a0_0x40b09f;try{if(!_0x4720c4[_0x1ee534(0x1b2)][_0x1ee534(0xed)])return _0x1ee534(0x156);let _0xb0d01=_0x4720c4['config'][_0x1ee534(0xcd)]||_0x1ee534(0x1de),_0x4171dd=_0x4720c4[_0x1ee534(0x1b2)]['calendarSelection']||[];if(typeof _0x4171dd===_0x1ee534(0x20a))_0x4171dd=_0x4171dd[_0x1ee534(0x1ae)](',');try{const _0x6ef9e1=await _0x4720c4[_0x1ee534(0x23e)](_0xb0d01+_0x1ee534(0x215));if(_0x6ef9e1&&_0x6ef9e1[_0x1ee534(0x193)]){let _0x48cdc6=tryParse(_0x6ef9e1[_0x1ee534(0x193)]);if(_0x48cdc6&&Array[_0x1ee534(0xb8)](_0x48cdc6)){if(_0x4171dd['length']>0x0)_0x48cdc6=_0x48cdc6[_0x1ee534(0x25e)](_0x2c5ee1=>_0x4171dd[_0x1ee534(0xfc)](_0x2c5ee1[_0x1ee534(0x141)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x48cdc6[_0x1ee534(0x131)]>0x0){const _0x38ccc7=_0x48cdc6[_0x1ee534(0x1a8)](0x0,0x3)[_0x1ee534(0x76)](_0x10b3f1=>{const _0xec710d=_0x1ee534;let _0x172022=_0x10b3f1[_0xec710d(0x7a)];if(_0x10b3f1[_0xec710d(0x1f9)])_0x172022+='\x20'+_0x10b3f1[_0xec710d(0x1f9)];return _0x172022+':\x20'+_0x10b3f1[_0xec710d(0x21a)]+'\x20('+_0x10b3f1[_0xec710d(0x141)]+')';});return _0x1ee534(0x213)+_0x38ccc7[_0x1ee534(0x18c)]('\x20|\x20');}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x486ab7){_0x4720c4[_0x1ee534(0x159)][_0x1ee534(0xe8)](_0x1ee534(0x249)+_0x486ab7['message']);}return _0x1ee534(0x73);}catch(_0x164b0c){return _0x1ee534(0x28c)+_0x164b0c[_0x1ee534(0x265)];}}async function getCalendarNames(_0x5cbf09,_0x5594d9){const _0x453956=a0_0x40b09f;try{const _0x1d0a01=await _0x5cbf09[_0x453956(0x23e)](_0x5594d9+_0x453956(0x215));if(_0x1d0a01&&_0x1d0a01[_0x453956(0x193)]){const _0x1e7737=tryParse(_0x1d0a01[_0x453956(0x193)]);if(_0x1e7737&&Array[_0x453956(0xb8)](_0x1e7737)){const _0x3bfc3a=[...new Set(_0x1e7737[_0x453956(0x76)](_0x52b4db=>_0x52b4db[_0x453956(0x141)])[_0x453956(0x25e)](Boolean))];return _0x3bfc3a[_0x453956(0x1cf)]();}}return[];}catch(_0x3a3d80){return _0x5cbf09[_0x453956(0x159)][_0x453956(0xd8)](_0x453956(0xac)+_0x3a3d80[_0x453956(0x265)]),[];}}async function checkWifiPresence(_0x5a1429){const _0x4e8276=a0_0x40b09f;try{const _0x3365fc=_0x5a1429['config']['presenceDevices']||[];let _0x2b64a7=![];const _0x70bc09=[];for(const _0x499da4 of _0x3365fc){try{const _0x10f21f=await _0x5a1429[_0x4e8276(0x23e)](_0x499da4);if(_0x10f21f&&(_0x10f21f[_0x4e8276(0x193)]===!![]||_0x10f21f['val']===_0x4e8276(0x115)||_0x10f21f[_0x4e8276(0x193)]===0x1)){_0x2b64a7=!![];const _0x3f59f6=await _0x5a1429[_0x4e8276(0xe5)](_0x499da4);let _0x41a104=_0x499da4;_0x3f59f6&&_0x3f59f6['common']&&_0x3f59f6[_0x4e8276(0xe2)][_0x4e8276(0x14c)]&&(_0x41a104=typeof _0x3f59f6[_0x4e8276(0xe2)][_0x4e8276(0x14c)]==='object'?_0x3f59f6[_0x4e8276(0xe2)][_0x4e8276(0x14c)]['de']||_0x3f59f6[_0x4e8276(0xe2)][_0x4e8276(0x14c)]['en']:_0x3f59f6[_0x4e8276(0xe2)][_0x4e8276(0x14c)]),_0x70bc09['push'](_0x41a104);}}catch(_0x37b383){}}return await _0x5a1429[_0x4e8276(0x10a)]('system.presenceWho',{'val':_0x70bc09['join'](',\x20'),'ack':!![]}),_0x2b64a7&&(_0x5a1429[_0x4e8276(0x88)]&&(_0x5a1429[_0x4e8276(0x159)][_0x4e8276(0x288)](_0x4e8276(0xcb)),abortExitTimer(_0x5a1429)),!_0x5a1429[_0x4e8276(0x2a0)]&&_0x5a1429[_0x4e8276(0x212)]===SYSTEM_MODES[_0x4e8276(0x255)]&&await setPresence(_0x5a1429,!![])),_0x2b64a7;}catch(_0x159fd9){return _0x5a1429['log'][_0x4e8276(0xd8)](_0x4e8276(0x1e7)+_0x159fd9[_0x4e8276(0x265)]),![];}}function startExitTimer(_0x6ecda4){const _0x108ef9=a0_0x40b09f;abortExitTimer(_0x6ecda4),_0x6ecda4['isGracePeriodActive']=!![],_0x6ecda4[_0x108ef9(0x1ed)]=setTimeout(()=>{_0x6ecda4['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x6ecda4[_0x108ef9(0x88)]=setTimeout(()=>{setPresence(_0x6ecda4,![]),_0x6ecda4['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x422fe5){const _0x1ffca3=a0_0x40b09f;if(_0x422fe5[_0x1ffca3(0x88)])clearTimeout(_0x422fe5[_0x1ffca3(0x88)]);if(_0x422fe5['exitGraceTimer'])clearTimeout(_0x422fe5[_0x1ffca3(0x1ed)]);_0x422fe5[_0x1ffca3(0x88)]=null,_0x422fe5[_0x1ffca3(0x1ed)]=null,_0x422fe5[_0x1ffca3(0x1fb)]=![];}async function setPresence(_0x382b08,_0x32491c){const _0x3f1746=a0_0x40b09f;if(_0x382b08[_0x3f1746(0x2a0)]===_0x32491c)return;_0x382b08[_0x3f1746(0x2a0)]=_0x32491c,await _0x382b08['setStateAsync']('system.isPresent',{'val':_0x32491c,'ack':!![]});}async function saveFeedback(_0x5e3680,_0x33e41d){const _0x18b6e2=a0_0x40b09f;_0x5e3680[_0x18b6e2(0x159)]['info'](_0x18b6e2(0xc2)+JSON['stringify'](_0x33e41d));}async function runBaselineDriftAnalysis(_0x3ac04e){const _0xde2857=a0_0x40b09f;if(!_0x3ac04e['isProVersion']||!_0x3ac04e[_0xde2857(0x22b)])return;const _0x479081=_0x3ac04e[_0xde2857(0x1b2)][_0xde2857(0x233)]||0xe;if(_0x3ac04e['dailyDigests'][_0xde2857(0x131)]<_0x479081+(_0x3ac04e[_0xde2857(0x1b2)][_0xde2857(0x251)]||0x7)){await _0x3ac04e[_0xde2857(0x10a)](LTM_DP_DRIFT_STATUS,{'val':_0xde2857(0x8f),'ack':!![]});return;}const _0x214981=_0x3ac04e[_0xde2857(0x1f6)][_0xde2857(0x1a8)](-_0x479081),_0x1dbfe2=_0x3ac04e[_0xde2857(0x1f6)][_0xde2857(0x1a8)](0x0,_0x3ac04e['dailyDigests'][_0xde2857(0x131)]-_0x479081),_0x706aa8='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0xde2857(0x287)](_0x1dbfe2)+_0xde2857(0x29c)+JSON[_0xde2857(0x287)](_0x214981);try{const _0x31c422=await _0x3ac04e[_0xde2857(0x22b)]['generateContent'](_0x706aa8),_0x3e8acd=JSON[_0xde2857(0x199)](_0x31c422['response'][_0xde2857(0x16c)]()[_0xde2857(0x229)](/```json|```/g,'')[_0xde2857(0x1c4)]());_0x3e8acd['baselineDrift']&&(await _0x3ac04e[_0xde2857(0x10a)](LTM_DP_DRIFT_STATUS,{'val':_0x3e8acd[_0xde2857(0x13e)],'ack':!![]}),await _0x3ac04e['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x3e8acd[_0xde2857(0x260)],'ack':!![]}),await _0x3ac04e[_0xde2857(0x10a)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0xde2857(0x11c)](),'ack':!![]}));}catch(_0x117862){}}function setupLtmScheduler(_0x38e7c0){const _0x3ac9c2=a0_0x40b09f;try{if(_0x38e7c0[_0x3ac9c2(0x289)])_0x38e7c0['ltmJob'][_0x3ac9c2(0x7f)]();if(!_0x38e7c0[_0x3ac9c2(0x1ff)]){_0x38e7c0['setStateAsync'](LTM_DP_STATUS,{'val':_0x3ac9c2(0x18e),'ack':!![]});return;}_0x38e7c0[_0x3ac9c2(0x289)]=schedule[_0x3ac9c2(0x143)](LTM_SCHEDULE,()=>createDailyDigest(_0x38e7c0));}catch(_0x4eb622){_0x38e7c0['log'][_0x3ac9c2(0xd8)](_0x3ac9c2(0x8e)+_0x4eb622[_0x3ac9c2(0x265)]);}}function setupModeResetScheduler(_0x551b63){const _0xf98f92=a0_0x40b09f;try{if(_0x551b63['modeResetJob'])_0x551b63[_0xf98f92(0x29d)][_0xf98f92(0x7f)]();_0x551b63[_0xf98f92(0x29d)]=schedule[_0xf98f92(0x143)](MODE_RESET_SCHEDULE,async()=>{const _0x8cf874=_0xf98f92;await loadSystemMode(_0x551b63),AUTO_RESET_MODES[_0x8cf874(0xfc)](_0x551b63['currentSystemMode'])&&await _0x551b63[_0x8cf874(0x10a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x8cf874(0x255)],'ack':![]});});}catch(_0x4d1ffe){_0x551b63['log']['error'](_0xf98f92(0x18b)+_0x4d1ffe['message']);}}function setupDriftAnalysisScheduler(_0x39bc75){const _0x2d3f4f=a0_0x40b09f;try{if(_0x39bc75[_0x2d3f4f(0x1e2)])clearInterval(_0x39bc75[_0x2d3f4f(0x1e2)]);if(!_0x39bc75['isProVersion'])return;_0x39bc75['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x39bc75),(_0x39bc75[_0x2d3f4f(0x1b2)][_0x2d3f4f(0x237)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x39bc75),0x1388);}catch(_0x3f3f51){_0x39bc75['log'][_0x2d3f4f(0xd8)](_0x2d3f4f(0x6d)+_0x3f3f51[_0x2d3f4f(0x265)]);}}function setupBriefingScheduler(_0x20db22){const _0x12719d=a0_0x40b09f;try{if(_0x20db22[_0x12719d(0x28a)])_0x20db22['briefingJob'][_0x12719d(0x7f)]();if(!_0x20db22[_0x12719d(0x1b2)]['briefingEnabled'])return;const _0x20a0f6=(_0x20db22[_0x12719d(0x1b2)][_0x12719d(0x24c)]||_0x12719d(0x134))[_0x12719d(0x1ae)](':'),_0x10dba6=parseInt(_0x20a0f6[0x0])||0x8,_0x3e3fa4=parseInt(_0x20a0f6[0x1])||0x0,_0x150cfb=_0x3e3fa4+'\x20'+_0x10dba6+_0x12719d(0x16d);_0x20db22[_0x12719d(0x159)][_0x12719d(0x288)](_0x12719d(0x1ba)+_0x10dba6+':'+(_0x3e3fa4<0xa?'0'+_0x3e3fa4:_0x3e3fa4)),_0x20db22[_0x12719d(0x28a)]=schedule[_0x12719d(0x143)](_0x150cfb,()=>{sendMorningBriefing(_0x20db22);});}catch(_0x11ccf1){_0x20db22['log'][_0x12719d(0xd8)](_0x12719d(0xc9)+_0x11ccf1[_0x12719d(0x265)]);}}async function sendNotification(_0x4a6cf6,_0x298728,_0x3240bb=![],_0x14585b=![]){const _0x4fa911=a0_0x40b09f;_0x4a6cf6[_0x4fa911(0x159)]['info']((_0x3240bb?_0x4fa911(0xdd):'')+_0x4fa911(0x18f)+_0x298728+'\x22');const _0x5362f2=_0x4a6cf6[_0x4fa911(0x1b2)];let _0xea43e1=0x0;if(_0x5362f2['notifyTelegramEnabled']){let _0x564f73={};(_0x298728['includes']('Alarm')||_0x14585b)&&(_0x564f73={'reply_markup':{'inline_keyboard':[[{'text':_0x4fa911(0x8d),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x4fa911(0x226),'callback_data':_0x4fa911(0x241)}]]}}),await _0x4a6cf6[_0x4fa911(0x124)](_0x5362f2['notifyTelegramInstance'],'send',{'text':_0x298728,'user':_0x5362f2[_0x4fa911(0x140)],..._0x564f73}),_0xea43e1++;}if(_0x5362f2[_0x4fa911(0x293)]){let _0x4ece67={'message':_0x298728,'title':_0x14585b?_0x4fa911(0x246):'Cogni-Living','priority':_0x14585b?0x2:0x1,'device':_0x5362f2[_0x4fa911(0x19b)]};_0x14585b&&(_0x4ece67[_0x4fa911(0x275)]=0x1e,_0x4ece67[_0x4fa911(0x1f5)]=0xe10,_0x4ece67['sound']='siren'),await _0x4a6cf6[_0x4fa911(0x124)](_0x5362f2[_0x4fa911(0x164)],_0x4fa911(0x1bd),_0x4ece67),_0xea43e1++;}return _0x5362f2[_0x4fa911(0x253)]&&(await _0x4a6cf6[_0x4fa911(0x124)](_0x5362f2[_0x4fa911(0x243)],_0x4fa911(0x1bd),{'text':_0x298728,'to':_0x5362f2['notifyEmailRecipient']}),_0xea43e1++),_0xea43e1;}async function setupTelegramListener(_0x131025){const _0x2ee103=a0_0x40b09f,_0x58f526=_0x131025[_0x2ee103(0x1b2)][_0x2ee103(0xc0)];_0x131025['config'][_0x2ee103(0x15f)]&&_0x58f526&&(_0x131025[_0x2ee103(0x159)][_0x2ee103(0x288)](_0x2ee103(0x12c)+_0x58f526+_0x2ee103(0x96)),await _0x131025[_0x2ee103(0x280)](_0x58f526+_0x2ee103(0x1eb)));}async function handleTelegramResponse(_0x337b1b,_0x86d379){const _0x4dbd9a=a0_0x40b09f;let _0x2f34ae=_0x86d379;_0x86d379[_0x4dbd9a(0x1a6)]('[')&&(_0x2f34ae=_0x86d379[_0x4dbd9a(0x222)](_0x86d379['indexOf'](']')+0x1));if(_0x2f34ae==='COGNI_CONFIRM_OK')_0x337b1b['log'][_0x4dbd9a(0x288)](_0x4dbd9a(0x8a)),await _0x337b1b[_0x4dbd9a(0x10a)](_0x4dbd9a(0x1cc),{'val':![],'ack':!![]}),await _0x337b1b['setStateAsync'](_0x4dbd9a(0x267),{'val':_0x4dbd9a(0x19f),'ack':!![]}),_0x337b1b[_0x4dbd9a(0x266)]=![],sendNotification(_0x337b1b,_0x4dbd9a(0x91),![]);else _0x2f34ae===_0x4dbd9a(0x241)&&(_0x337b1b['log']['warn'](_0x4dbd9a(0xd0)),sendNotification(_0x337b1b,_0x4dbd9a(0x1b1),![],!![]));}async function runAutopilot(_0xad1c03){const _0x78eadf=a0_0x40b09f,_0x3c0b6b=_0xad1c03[_0x78eadf(0x1b2)]['inactivityThresholdHours'],_0x534fb0=_0xad1c03['eventHistory'][_0x78eadf(0x131)]>0x0?_0xad1c03[_0x78eadf(0x263)][0x0]['timestamp']:Date[_0x78eadf(0x11c)](),_0x3edd09=(Date[_0x78eadf(0x11c)]()-_0x534fb0)/(0x3e8*0x3c*0x3c);let _0x1cf532='';_0xad1c03[_0x78eadf(0x1b2)][_0x78eadf(0x1e8)]&&_0xad1c03[_0x78eadf(0x212)]===SYSTEM_MODES[_0x78eadf(0x255)]&&_0xad1c03[_0x78eadf(0x2a0)]&&(_0x3edd09>_0x3c0b6b&&(_0x1cf532=_0x78eadf(0x196)+_0x3edd09[_0x78eadf(0x114)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0xad1c03,_0x1cf532)[_0x78eadf(0xfa)](_0x43c484=>_0xad1c03[_0x78eadf(0x159)][_0x78eadf(0xd8)](_0x43c484));}async function createDailyDigest(_0x4f4c23){const _0x11f62e=a0_0x40b09f;if(!_0x4f4c23[_0x11f62e(0x1ff)])return;await _0x4f4c23[_0x11f62e(0x10a)](LTM_DP_STATUS,{'val':_0x11f62e(0x216)+new Date()[_0x11f62e(0x20c)](),'ack':!![]});if(!_0x4f4c23['geminiModel']||_0x4f4c23[_0x11f62e(0xa9)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4f4c23[_0x11f62e(0x10a)](LTM_DP_STATUS,{'val':_0x11f62e(0x22a),'ack':!![]});return;}const _0x2dace4=JSON[_0x11f62e(0x199)](JSON['stringify'](_0x4f4c23[_0x11f62e(0xa9)])),_0x17ceb5=_0x2dace4[_0x11f62e(0x131)],_0x5d0e98=_0x11f62e(0xa7)+JSON['stringify'](_0x2dace4);try{const _0x2ab1ab=await _0x4f4c23[_0x11f62e(0x22b)][_0x11f62e(0x23b)](_0x5d0e98),_0x505650=JSON[_0x11f62e(0x199)](_0x2ab1ab['response'][_0x11f62e(0x16c)]()[_0x11f62e(0x229)](/```json|```/g,'')[_0x11f62e(0x1c4)]());_0x505650[_0x11f62e(0x292)]&&(_0x4f4c23['dailyDigests'][_0x11f62e(0x224)]({'timestamp':new Date()[_0x11f62e(0x21c)](),'eventCount':_0x17ceb5,'summary':_0x505650[_0x11f62e(0x292)],'activityLevel':_0x505650[_0x11f62e(0x26c)],'systemMode':_0x4f4c23['currentSystemMode']}),await saveDailyDigests(_0x4f4c23),_0x4f4c23[_0x11f62e(0xa9)]=[],await saveRawEventLog(_0x4f4c23),await _0x4f4c23[_0x11f62e(0x10a)](LTM_DP_STATUS,{'val':_0x11f62e(0x191)+_0x17ceb5+_0x11f62e(0xd9),'ack':!![]}),runPythonHealthCheck(_0x4f4c23));}catch(_0x14e004){await _0x4f4c23['setStateAsync'](LTM_DP_STATUS,{'val':_0x11f62e(0xfd)+_0x14e004[_0x11f62e(0x265)],'ack':!![]});}}async function sendMorningBriefing(_0x41e1d5){const _0x3f20b3=a0_0x40b09f;if(!_0x41e1d5[_0x3f20b3(0x22b)])return;_0x41e1d5['log'][_0x3f20b3(0x288)](_0x3f20b3(0xf4));const _0x32e36b=_0x41e1d5[_0x3f20b3(0x1f6)][_0x3f20b3(0x131)]>0x0?_0x41e1d5[_0x3f20b3(0x1f6)][_0x41e1d5['dailyDigests']['length']-0x1]:null,_0x4d5ce1=_0x32e36b&&_0x32e36b[_0x3f20b3(0x7b)]?_0x32e36b['health'][_0x3f20b3(0xc7)]:'N/A',_0x329380=new Date();_0x329380[_0x3f20b3(0x188)](0x4,0x0,0x0,0x0);const _0x4e1f31=_0x41e1d5[_0x3f20b3(0x263)][_0x3f20b3(0x25e)](_0x20bf5a=>new Date(_0x20bf5a[_0x3f20b3(0xf7)])>_0x329380),_0x1c2bc3=PERSONA_MAPPING[_0x41e1d5[_0x3f20b3(0x1b2)][_0x3f20b3(0x27f)]||_0x3f20b3(0x136)],_0x18db03=_0x41e1d5[_0x3f20b3(0x1b2)][_0x3f20b3(0x1fc)]||'',_0x5c72be=await getWeatherContext(_0x41e1d5),_0x3d9bb5=await getCalendarContext(_0x41e1d5),_0x4e85ad=_0x3f20b3(0xf5)+_0x1c2bc3+_0x3f20b3(0x1f7)+_0x18db03+_0x3f20b3(0x200)+_0x5c72be+'\x20'+_0x3d9bb5+_0x3f20b3(0x110)+_0x4d5ce1+_0x3f20b3(0xec)+JSON[_0x3f20b3(0x287)](_0x4e1f31[_0x3f20b3(0x1a8)](0x0,0xa))+_0x3f20b3(0xf9);try{const _0x363dde=await _0x41e1d5[_0x3f20b3(0x22b)][_0x3f20b3(0x23b)](_0x4e85ad),_0x11130c=_0x3f20b3(0x26e)+_0x363dde[_0x3f20b3(0x211)][_0x3f20b3(0x16c)]()[_0x3f20b3(0x1c4)]();sendNotification(_0x41e1d5,_0x11130c),_0x41e1d5['log'][_0x3f20b3(0x288)]('Morning\x20Briefing\x20sent.');}catch(_0x4cadab){_0x41e1d5[_0x3f20b3(0x159)][_0x3f20b3(0xd8)](_0x3f20b3(0x169)+_0x4cadab[_0x3f20b3(0x265)]);}}async function scanForDevices(_0x2fe547,_0x3658e7){const _0x1b78e1=a0_0x40b09f;_0x2fe547[_0x1b78e1(0x159)][_0x1b78e1(0x288)](_0x1b78e1(0x10e));const _0x39ff7c=[],_0x1007cc=await _0x2fe547[_0x1b78e1(0x9e)]('*'),_0x3f68a4=await _0x2fe547[_0x1b78e1(0x9e)](_0x1b78e1(0x190),_0x1b78e1(0x23a)),_0x11ebbc=await _0x2fe547['getForeignObjectsAsync'](_0x1b78e1(0x290),'enum'),_0xad58cf={};if(_0x3f68a4)for(const _0x4c4e46 in _0x3f68a4){const _0x12c3ee=_0x3f68a4[_0x4c4e46][_0x1b78e1(0xe2)][_0x1b78e1(0x1c9)]||[];_0x12c3ee[_0x1b78e1(0x1d8)](_0x4b79b4=>{const _0xfebcf1=_0x1b78e1;if(!_0xad58cf[_0x4b79b4])_0xad58cf[_0x4b79b4]=[];_0xad58cf[_0x4b79b4][_0xfebcf1(0x224)](_0x4c4e46);});}const _0x150baa={};if(_0x11ebbc)for(const _0x5caa22 in _0x11ebbc){const _0x41ad2e=_0x11ebbc[_0x5caa22][_0x1b78e1(0xe2)]['members']||[],_0x4eab51=typeof _0x11ebbc[_0x5caa22][_0x1b78e1(0xe2)][_0x1b78e1(0x14c)]===_0x1b78e1(0x1ee)?_0x11ebbc[_0x5caa22][_0x1b78e1(0xe2)][_0x1b78e1(0x14c)]['de']:_0x11ebbc[_0x5caa22][_0x1b78e1(0xe2)][_0x1b78e1(0x14c)];_0x41ad2e[_0x1b78e1(0x1d8)](_0x1015c4=>_0x150baa[_0x1015c4]=_0x4eab51);}const _0x10f2c3=_0x3658e7[_0x1b78e1(0x1ca)]||[],_0x20e91b=_0x3658e7['motion']!==![],_0x19dff6=_0x3658e7[_0x1b78e1(0x25d)]!==![],_0x31819c=_0x3658e7[_0x1b78e1(0x259)]!==![],_0x7c9c83=_0x3658e7[_0x1b78e1(0x82)]===!![],_0xba6f71=_0x3658e7[_0x1b78e1(0x1f2)]===!![];for(const _0x28ff75 in _0x1007cc){const _0x1f915=_0x1007cc[_0x28ff75];if(_0x1f915['type']!=='state'||!_0x1f915['common'])continue;if(ADAPTER_BLACKLIST[_0x1b78e1(0x9c)](_0x50080d=>_0x28ff75[_0x1b78e1(0x1a6)](_0x50080d))&&!_0xba6f71)continue;const _0x2982c0=(_0x1f915[_0x1b78e1(0xe2)][_0x1b78e1(0x16a)]||'')[_0x1b78e1(0xb9)]();let _0x3a7c48=(typeof _0x1f915[_0x1b78e1(0xe2)][_0x1b78e1(0x14c)]===_0x1b78e1(0x1ee)?_0x1f915[_0x1b78e1(0xe2)][_0x1b78e1(0x14c)]['de']:_0x1f915[_0x1b78e1(0xe2)][_0x1b78e1(0x14c)])||_0x28ff75;const _0x36727d=_0x3a7c48['toLowerCase']();let _0x2b3491=![],_0x5bfa91=![];if(_0x10f2c3[_0x1b78e1(0x131)]>0x0){const _0x15fcbc=_0xad58cf[_0x28ff75]||[],_0x48ec04=_0x28ff75[_0x1b78e1(0x1ae)]('.')[_0x1b78e1(0x1a8)](0x0,-0x1)['join']('.'),_0x36ed44=_0xad58cf[_0x48ec04]||[];(_0x15fcbc[_0x1b78e1(0x9c)](_0x633831=>_0x10f2c3[_0x1b78e1(0xfc)](_0x633831))||_0x36ed44[_0x1b78e1(0x9c)](_0x46b080=>_0x10f2c3['includes'](_0x46b080)))&&(_0x2b3491=!![],_0x5bfa91=!![]);}if(!_0x2b3491&&!_0xba6f71){if(HARD_IGNORE_TERMS[_0x1b78e1(0x9c)](_0xddf965=>_0x28ff75['includes'](_0xddf965)||_0x36727d[_0x1b78e1(0xfc)](_0xddf965[_0x1b78e1(0xb9)]())))continue;}if(BAD_NAMES[_0x1b78e1(0x9c)](_0x468c0d=>_0x36727d===_0x468c0d||_0x36727d[_0x1b78e1(0x117)]('.'+_0x468c0d))){const _0x1d95b8=_0x28ff75[_0x1b78e1(0x1ae)]('.');if(_0x1d95b8[_0x1b78e1(0x131)]>0x2){const _0x15f13b=_0x1d95b8[_0x1b78e1(0x1a8)](0x0,-0x1)[_0x1b78e1(0x18c)]('.'),_0x548337=_0x1007cc[_0x15f13b];if(_0x548337&&_0x548337[_0x1b78e1(0xe2)]&&_0x548337[_0x1b78e1(0xe2)][_0x1b78e1(0x14c)]){const _0x22feda=typeof _0x548337[_0x1b78e1(0xe2)]['name']===_0x1b78e1(0x1ee)?_0x548337[_0x1b78e1(0xe2)][_0x1b78e1(0x14c)]['de']:_0x548337[_0x1b78e1(0xe2)][_0x1b78e1(0x14c)];_0x22feda&&!_0x3a7c48[_0x1b78e1(0xfc)](_0x22feda)&&(_0x3a7c48=_0x22feda+'\x20'+_0x3a7c48);}}}let _0x2fcc0b='';if(_0x20e91b&&(_0x2982c0[_0x1b78e1(0xfc)](_0x1b78e1(0x202))||_0x2982c0[_0x1b78e1(0xfc)]('occupancy')||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x1bb))||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x158))))_0x2fcc0b='motion';else{if(!_0x2fcc0b&&_0x19dff6&&(_0x2982c0[_0x1b78e1(0xfc)]('door')||_0x2982c0['includes'](_0x1b78e1(0x1ef))||_0x2982c0[_0x1b78e1(0xfc)](_0x1b78e1(0xe3))||_0x2982c0[_0x1b78e1(0xfc)]('blind')||_0x2982c0[_0x1b78e1(0xfc)](_0x1b78e1(0xd5))||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x24f))||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x2a4))||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x1f1))))_0x2fcc0b=_0x1b78e1(0x208);else{if(!_0x2fcc0b&&_0x31819c&&(_0x2982c0[_0x1b78e1(0xfc)](_0x1b78e1(0x160))||_0x2982c0['includes'](_0x1b78e1(0x123))||_0x2982c0[_0x1b78e1(0xfc)](_0x1b78e1(0x81))||_0x36727d[_0x1b78e1(0xfc)]('licht')||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x171))||_0x36727d['includes'](_0x1b78e1(0x1fa)))){if(_0x1f915[_0x1b78e1(0xe2)][_0x1b78e1(0xfe)]||_0x2982c0[_0x1b78e1(0xfc)]('sensor'))_0x2fcc0b='light';}else{if(!_0x2fcc0b&&_0x7c9c83&&(_0x2982c0['includes'](_0x1b78e1(0x82))||_0x2982c0['includes'](_0x1b78e1(0x1f0))||_0x2982c0[_0x1b78e1(0xfc)]('thermostat')||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x146))||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x271))||_0x36727d[_0x1b78e1(0xfc)](_0x1b78e1(0x8b))))_0x2fcc0b=_0x1b78e1(0x82);else{if(!_0x2fcc0b&&_0x5bfa91)_0x2fcc0b=_0x1b78e1(0xa8);}}}}if(_0x2fcc0b){let _0x5a7a3f=_0x150baa[_0x28ff75]||'';if(!_0x5a7a3f){let _0x5b4f36=_0x28ff75;for(let _0x2e89b0=0x0;_0x2e89b0<0x3;_0x2e89b0++){const _0x31e479=_0x5b4f36[_0x1b78e1(0x1d0)]('.');if(_0x31e479===-0x1)break;_0x5b4f36=_0x5b4f36[_0x1b78e1(0x222)](0x0,_0x31e479);if(_0x150baa[_0x5b4f36]){_0x5a7a3f=_0x150baa[_0x5b4f36];break;}}}_0x39ff7c['push']({'id':_0x28ff75,'name':_0x3a7c48,'location':_0x5a7a3f,'type':_0x2fcc0b,'logDuplicates':_0x2fcc0b===_0x1b78e1(0x202),'isExit':![],'_score':_0x5a7a3f?0x50:_0x2fcc0b===_0x1b78e1(0xa8)?0x5a:0x28});}}return _0x39ff7c[_0x1b78e1(0x1cf)]((_0x2b1483,_0x1de501)=>_0x1de501[_0x1b78e1(0x1c7)]-_0x2b1483[_0x1b78e1(0x1c7)]),_0x39ff7c;}async function executeAutomationAction(_0xd217bb){const _0x39ed36=a0_0x40b09f;try{const _0x23dcc4=await _0xd217bb[_0x39ed36(0x295)](_0x39ed36(0xb2)),_0x31fd06=await _0xd217bb[_0x39ed36(0x295)]('analysis.automation.targetValue');if(_0x23dcc4&&_0x23dcc4['val']&&_0x31fd06){const _0x5a4be6=_0x23dcc4[_0x39ed36(0x193)];let _0x27bd1b=_0x31fd06[_0x39ed36(0x193)];try{_0x27bd1b=JSON[_0x39ed36(0x199)](_0x27bd1b);}catch(_0x11c819){}_0xd217bb['log'][_0x39ed36(0x288)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x5a4be6+'\x20=\x20'+_0x27bd1b),await _0xd217bb['setForeignStateAsync'](_0x5a4be6,_0x27bd1b);}else _0xd217bb[_0x39ed36(0x159)][_0x39ed36(0xe8)](_0x39ed36(0xba));}catch(_0xeadf16){_0xd217bb['log'][_0x39ed36(0xd8)](_0x39ed36(0x19a)+_0xeadf16['message']);}}function tryParse(_0x9fa2e){const _0x526788=a0_0x40b09f;try{return JSON[_0x526788(0x199)](_0x9fa2e);}catch(_0x151a7c){return null;}}async function recordSequence(_0xf885fc,_0x3c3373){const _0x5bf308=a0_0x40b09f,_0x2be285=(_0x3c3373['type']||'')[_0x5bf308(0xb9)](),_0x2b403f=[_0x5bf308(0x202),_0x5bf308(0x1bb),_0x5bf308(0x158),_0x5bf308(0x9f),'occupancy','door',_0x5bf308(0x2a4),_0x5bf308(0x1ef),_0x5bf308(0x24f),_0x5bf308(0x1c3),_0x5bf308(0x14a),_0x5bf308(0x160),_0x5bf308(0xbd),_0x5bf308(0x123),_0x5bf308(0x1fa),_0x5bf308(0x81),_0x5bf308(0x171)];if(!_0x2b403f[_0x5bf308(0x9c)](_0x235dd8=>_0x2be285[_0x5bf308(0xfc)](_0x235dd8))){_0xf885fc['log'][_0x5bf308(0x106)](_0x5bf308(0xdc)+_0x3c3373['id']+_0x5bf308(0x197)+_0x3c3373['type']+_0x5bf308(0x29f));return;}if(!_0x3c3373[_0x5bf308(0x122)]){_0xf885fc['log'][_0x5bf308(0x106)](_0x5bf308(0xdc)+_0x3c3373['id']+_0x5bf308(0x126)+_0x3c3373[_0x5bf308(0x122)]+')');return;}_0xf885fc['log']['debug']('[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20'+_0x3c3373['id']+'\x20('+_0x3c3373['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x101486={'loc':_0x3c3373['location']||'Unknown','id':_0x3c3373['id'],'ts':Date[_0x5bf308(0x11c)]()};activeSequence[_0x5bf308(0x224)](_0x101486),_0xf885fc[_0x5bf308(0x159)][_0x5bf308(0x106)](_0x5bf308(0xc6)+_0x101486[_0x5bf308(0x90)]+_0x5bf308(0x116)+activeSequence[_0x5bf308(0x131)]+')'),sequenceTimer=setTimeout(async()=>{const _0x51c5c9=_0x5bf308;activeSequence[_0x51c5c9(0x131)]>0x1?await saveCompletedSequence(_0xf885fc):(_0xf885fc[_0x51c5c9(0x159)][_0x51c5c9(0x106)](_0x51c5c9(0x102)+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x2aa19b){const _0x8d7be8=a0_0x40b09f;try{_0x2aa19b['log']['info'](_0x8d7be8(0x1e3)+activeSequence['length']+_0x8d7be8(0x21d));const _0x3fa1b6=await _0x2aa19b['getStateAsync'](_0x8d7be8(0x172));let _0xc288c9=[];if(_0x3fa1b6&&_0x3fa1b6[_0x8d7be8(0x193)])try{_0xc288c9=JSON[_0x8d7be8(0x199)](_0x3fa1b6['val']);}catch(_0x138636){}const _0x50fbe4=activeSequence[0x0]['ts'],_0x192845=activeSequence['map'](_0x229e97=>({'loc':_0x229e97['loc'],'t_delta':Math['round']((_0x229e97['ts']-_0x50fbe4)/0x3e8)})),_0x5e33ff={'timestamp':new Date(_0x50fbe4)[_0x8d7be8(0x21c)](),'steps':_0x192845,'duration':Math[_0x8d7be8(0x256)]((activeSequence[activeSequence[_0x8d7be8(0x131)]-0x1]['ts']-_0x50fbe4)/0x3e8),'daytime':new Date(_0x50fbe4)[_0x8d7be8(0x21b)]()};_0xc288c9[_0x8d7be8(0x224)](_0x5e33ff),_0xc288c9[_0x8d7be8(0x131)]>MAX_TRAINING_SET_SIZE&&_0xc288c9[_0x8d7be8(0x235)](),await _0x2aa19b['setStateAsync'](_0x8d7be8(0x172),{'val':JSON['stringify'](_0xc288c9),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x3f45bd){_0x2aa19b['log'][_0x8d7be8(0xd8)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x3f45bd[_0x8d7be8(0x265)]);}}async function getOutsideTemperatureNumeric(_0x3c83a6){const _0xd0ff5c=a0_0x40b09f;if(_0x3c83a6[_0xd0ff5c(0x1b2)][_0xd0ff5c(0x1da)])try{const _0x1a9baa=await _0x3c83a6['getForeignStateAsync'](_0x3c83a6[_0xd0ff5c(0x1b2)][_0xd0ff5c(0x1da)]);if(_0x1a9baa&&_0x1a9baa[_0xd0ff5c(0x193)]!==undefined&&_0x1a9baa['val']!==null){const _0x1b3d48=parseFloat(_0x1a9baa['val']);if(!isNaN(_0x1b3d48))return _0x1b3d48;}}catch(_0x25384e){_0x3c83a6[_0xd0ff5c(0x159)][_0xd0ff5c(0xe8)]('Error\x20reading\x20outdoor\x20sensor\x20'+_0x3c83a6[_0xd0ff5c(0x1b2)]['outdoorSensorId']+':\x20'+_0x25384e[_0xd0ff5c(0x265)]);}const _0x115523=_0x3c83a6[_0xd0ff5c(0x1b2)][_0xd0ff5c(0x1a7)];if(!_0x3c83a6['config'][_0xd0ff5c(0x19e)]||!_0x115523)return null;try{let _0x5a5913='';if(_0x115523[_0xd0ff5c(0xfc)](_0xd0ff5c(0x2a6)))_0x5a5913=_0x115523+_0xd0ff5c(0xb1);else{if(_0x115523[_0xd0ff5c(0xfc)]('daswetter'))_0x5a5913=_0x115523+_0xd0ff5c(0x1dd);else{if(_0x115523[_0xd0ff5c(0xfc)](_0xd0ff5c(0x186)))_0x5a5913=_0x115523+'.forecast.current.temperature';else{if(_0x115523[_0xd0ff5c(0xfc)]('weatherunderground'))_0x5a5913=_0x115523+_0xd0ff5c(0xe9);}}}if(_0x5a5913){const _0x203b28=await _0x3c83a6['getForeignStateAsync'](_0x5a5913);if(_0x203b28&&_0x203b28[_0xd0ff5c(0x193)]!==undefined&&_0x203b28['val']!==null)return parseFloat(_0x203b28[_0xd0ff5c(0x193)]);}}catch(_0x3bf469){}return null;}async function recordThermodynamics(_0x176911,_0x3eb599,_0x5b5ebc,_0x3a0397){const _0xd75b3d=a0_0x40b09f,_0x107789=await getOutsideTemperatureNumeric(_0x176911),_0x2f64bc=await _0x176911[_0xd75b3d(0x295)](_0xd75b3d(0x299));let _0x281fab=[];if(_0x2f64bc&&_0x2f64bc['val'])try{_0x281fab=JSON[_0xd75b3d(0x199)](_0x2f64bc[_0xd75b3d(0x193)]);}catch(_0xb7d514){}_0x281fab[_0xd75b3d(0x224)]({'ts':Date['now'](),'room':_0x3a0397||_0xd75b3d(0x137),'t_in':_0x5b5ebc,'t_out':_0x107789});if(_0x281fab[_0xd75b3d(0x131)]>THERMO_LOG_SIZE)_0x281fab[_0xd75b3d(0x235)]();await _0x176911[_0xd75b3d(0x10a)](_0xd75b3d(0x299),{'val':JSON[_0xd75b3d(0x287)](_0x281fab),'ack':!![]});}async function processSensorEvent(_0x38916d,_0x15526c,_0x3863fc,_0x56a3bb){const _0x2ad7ff=a0_0x40b09f;if(!_0x56a3bb)return;const _0x59d7a2=_0x3863fc[_0x2ad7ff(0x193)],_0xb888f3=Date[_0x2ad7ff(0x11c)]();_0x38916d[_0x2ad7ff(0x159)][_0x2ad7ff(0x106)]('Event\x20received:\x20'+_0x15526c+_0x2ad7ff(0x87)+_0x59d7a2);const _0x362e34=_0x38916d[_0x2ad7ff(0x25b)][_0x15526c];_0x38916d['sensorLastValues'][_0x15526c]=_0x59d7a2;if(!_0x56a3bb[_0x2ad7ff(0xea)]&&_0x362e34!=undefined&&_0x362e34==_0x59d7a2){_0x38916d[_0x2ad7ff(0x159)][_0x2ad7ff(0x106)](_0x2ad7ff(0xab)+_0x56a3bb[_0x2ad7ff(0x14c)]+_0x2ad7ff(0x1e9)+_0x59d7a2+')');return;}const _0x1fb3f7=(_0x56a3bb[_0x2ad7ff(0x27e)]||'')['toLowerCase'](),_0x4676a2=_0x1fb3f7[_0x2ad7ff(0xfc)](_0x2ad7ff(0x82))||_0x1fb3f7[_0x2ad7ff(0xfc)](_0x2ad7ff(0x22e))||_0x1fb3f7[_0x2ad7ff(0xfc)](_0x2ad7ff(0x271))||_0x1fb3f7[_0x2ad7ff(0xfc)](_0x2ad7ff(0x8b));_0x38916d['isProVersion']&&_0x4676a2&&recordThermodynamics(_0x38916d,_0x15526c,_0x59d7a2,_0x56a3bb['location']);const _0x246410={'timestamp':_0xb888f3,'id':_0x15526c,'name':_0x56a3bb[_0x2ad7ff(0x14c)],'type':_0x56a3bb['type'],'location':_0x56a3bb[_0x2ad7ff(0x118)],'value':_0x59d7a2};_0x38916d[_0x2ad7ff(0x263)]['unshift'](_0x246410);if(_0x38916d['eventHistory'][_0x2ad7ff(0x131)]>HISTORY_MAX_SIZE)_0x38916d['eventHistory'][_0x2ad7ff(0x219)]();await _0x38916d[_0x2ad7ff(0x10a)](_0x2ad7ff(0xbb),{'val':JSON[_0x2ad7ff(0x287)](_0x246410),'ack':!![]}),await _0x38916d[_0x2ad7ff(0x10a)](_0x2ad7ff(0x21f),{'val':JSON[_0x2ad7ff(0x287)](_0x38916d[_0x2ad7ff(0x263)]),'ack':!![]});_0x38916d['isProVersion']&&(_0x38916d[_0x2ad7ff(0xa9)][_0x2ad7ff(0x224)](_0x246410),await saveRawEventLog(_0x38916d),recordSequence(_0x38916d,_0x246410));if(_0x56a3bb[_0x2ad7ff(0x27d)]&&_0x59d7a2===!![]){if(_0x38916d[_0x2ad7ff(0x2a0)]&&!_0x38916d['isGracePeriodActive'])_0x38916d[_0x2ad7ff(0x159)]['info'](_0x2ad7ff(0x244)+_0x56a3bb['name']+_0x2ad7ff(0x1fd)),startExitTimer(_0x38916d);else!_0x38916d[_0x2ad7ff(0x2a0)]&&(_0x38916d[_0x2ad7ff(0x159)]['info'](_0x2ad7ff(0x28b)+_0x56a3bb[_0x2ad7ff(0x14c)]+_0x2ad7ff(0x14f)),await setPresence(_0x38916d,!![]));}else _0x56a3bb[_0x2ad7ff(0x27e)]===_0x2ad7ff(0x202)&&_0x59d7a2===!![]&&(_0x38916d['exitTimer']&&(_0x38916d['log'][_0x2ad7ff(0x288)](_0x2ad7ff(0xe1)),abortExitTimer(_0x38916d)),!_0x38916d['isPresent']&&_0x38916d[_0x2ad7ff(0x212)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x38916d,!![]));}function a0_0x2436(){const _0x328b8f=['split','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','bind','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','config','Guardian:\x20Sending\x20','Training\x20Error:\x20','dutycycle','@google/generative-ai','guest','detected','uuid','Scheduling\x20Morning\x20Briefing\x20for\x20','bewegung','systemConfig','send','licenseKey','Event\x20History','Gemini\x20Init\x20Error:\x20','Comfort\x20Summary','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','contact','trim','Pattern\x20Detected','\x20events)...','_score','Who\x20is\x20present?','members','selectedFunctionIds','Deviation','analysis.isAlert','apiKey','data','sort','lastIndexOf','3461544mRKWEx','value.health','lowbat','TREND_RESULT','working','system.','version','forEach','analysis.analysisHistory','outdoorSensorId','ML-Libs\x20fehlen','longitude','.NextHours.Location_1.Day_1.current.temp_value','ical.0','PRIORITÃ„T:\x20Sicherheit.','python3\x20-m\x20pip\x20install\x20-r\x20\x22','path','driftAnalysisTimer','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','callback','(((.+)+)+)+$','Error\x20checking\x20WiFi:\x20','inactivityMonitoringEnabled','\x20(Value:\x20','GUEST','.communicate.request','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','exitGraceTimer','object','window','humidity','rollladen','weather','from','targetposition','expire','dailyDigests','.\x20KONTEXT:\x20','boolean','time','schalter','isGracePeriodActive','livingContext',').\x20Starting\x20Timer.','WETTER:\x20Keine\x20Daten\x20gefunden','isProVersion','.\x20ZUSATZ:\x20','application/json','motion','command','Missing\x20data','System\x20Mode','payload','\x22\x20--break-system-packages\x20--user','door','Training\x20only\x20available\x20in\x20Pro\x20Version.','string','getCalendarNames','toLocaleString','.forecast.current.state','Last\x20raw\x20event','number','Party','response','currentSystemMode','KALENDER:\x20','onMessage','.data.table','Started\x20at\x20','geminiApiKey','...','pop','event','getHours','toISOString',').\x20Saving\x20to\x20Training\x20Data.','cogni-living','events.history','Drift\x20Details','No\x20module\x20named\x20pip','substring','firmware','push','Restlessness\x20Level','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','getGenerativeModel','targetId','replace','Skipped\x20(No\x20AI\x20or\x20Data)','geminiModel','PRIORITÃ„T:\x20Gesundheit/AAL.','normal','temperatur','instance','Training\x20Data\x20Sets','close','javascript.','ltmStbWindowDays','LTM.dailyDigests','shift','Anwesend','ltmDriftCheckIntervalHours','toString','stdin','enum','generateContent','Logbook','communicate.request','getForeignStateAsync','ðŸ\x20Guardian\x20Diagnosis\x20(','analysis.feedbackHistory','COGNI_REQUEST_CALL','analysis.automation.autoApply','notifyEmailInstance','Exit\x20Sensor\x20triggered\x20(','2036538hrQnIZ','ðŸš¨\x20EMERGENCY','set_temperature','analysis.automation.patternDetected','Error\x20reading\x20calendar\x20table:\x20','toLocaleTimeString','Raw\x20Log','briefingTime','delObjectAsync','writable','fenster','getDate','minDaysForBaseline','weatherunderground.0','notifyEmailEnabled','targetValue','NORMAL','round','Health\x20Notes','âš ï¸\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...','lights','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','sensorLastValues',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','doors','filter','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','driftDetails','analysis.automation.targetValue','Keine\x20Analyse.','eventHistory','âœ…\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','message','lastAlertState','analysis.alertReason','button','.\x0a\x20\x20\x20\x20ANWESENDE_GERAETE:\x20','No\x20module\x20named','Activity-Level','activityLevel','python_service','ðŸŒ…\x20Daily\x20Briefing:\x0a','service.py','indicator.alarm','klima','analysisHistory','Keine\x20Details.','feedbackHistory','retry','energy','cogni-living\x20adapter\x20starting\x20(v','position','analysis.training.status','Failed\x20to\x20send\x20to\x20Python:\x20','stick_unreach','system','isExit','type','aiPersona','subscribeForeignStatesAsync','LTM.trainingData','858238eyUngC','System\x20Status\x20&\x20Control','Wetter:\x20Deaktiviert','link_quality','analysis.automation.suggestedAction','stringify','info','ltmJob','briefingJob','Entry\x20detected\x20via\x20','KALENDER\x20ERROR:\x20','native','2212RzpYzz','LTM','enum.rooms.*','Alert\x20Reason','summary','notifyPushoverEnabled','sendTo','getStateAsync','WETTER\x20ERROR:\x20','party','Trigger\x20Briefing\x20(Test)','LTM.trainingData.thermodynamics','analysis.training','10420OJDxta','\x0aSTB:\x20','modeResetJob','.NextHours.Location_1.Day_1.current.symbol_desc','\x27\x20not\x20in\x20allowed\x20list)','isPresent','Train\x20Security\x20Model\x20(LSTM)','Trigger\x20Action\x20Now','status','tÃ¼r','N/A','accuweather','actual_temperature','AI\x20Emergency\x20Status','.\x0a\x20\x20\x20\x20ANWESENHEITS_STATUS:\x20','Drift\x20Sched\x20Error:\x20','kill','channel','ðŸ\x20Stopping\x20Python\x20Sidecar...','Aktiv\x20(','simple-api.','KALENDER:\x20Keine\x20Daten','unknown','testApiKey','map','[PYTHON\x20ERR]\x20','inactivityThresholdHours','2467896wULsxC','date','health','blind','scriptProblem','@iobroker/adapter-core','cancel','models/gemini-flash-latest','dimmer','temperature','Fehler:\x20','automationProposal','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','Training\x20started...','\x20=\x20','exitTimer','stderr','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','heizung','Success:\x20','âœ…\x20Alles\x20OK\x20(Reset)]','LTM\x20Sched\x20Error:\x20','N/A\x20(Learning)','loc','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','Auto\x20Apply\x20Rule','analysis.automation.triggerAction','Adapter','Training\x20Status','\x20for\x20interactive\x20buttons...','search','No\x20Data','constructor','Thermodynamic\x20Data\x20Points','Gemini\x20Analysis\x20Error:\x20','some','Feedback\x20Log','getForeignObjectsAsync','presence','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','ABWESEND','Could\x20not\x20kill\x20Python\x20process:\x20','testContext','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','analysis.health.trendValue','connection','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','custom','rawEventLog','values','IGNORING\x20DUPLICATE\x20(Cached):\x20','getCalendarNames\x20Error:\x20','Recorded\x20Motion\x20Sequences','\x20sequences...','AI\x20Training\x20Control','json','.Current.Temperature','analysis.automation.targetId','No\x20instance','âœ…\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20','analysis.training.triggerSecurity','Error\x20in\x20onMessage\x20command\x20','Target\x20Value','isArray','toLowerCase','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','events.lastEvent','description','licht','latitude','brightness','notifyTelegramInstance','Starting\x20Autopilot\x20(','Feedback\x20saved:\x20','Last\x20Result','LTM.baselineStatus','testNotification','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','sleepScore','details','Briefing\x20Sched\x20Error:\x20','setState','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','\x20min).','calendarInstance','none','uuid-not-found','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','analysis.history_debug_00','off','No\x20training\x20sequences\x20found.','analysis.health','shutter','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','Processing\x20Status','error','\x20events','analysis.automation.description','scriptEnabled','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','[TEST]\x20','0\x203\x20*\x20*\x20*','subscribeStates','Subscribing\x20to\x20','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','common','lock','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','getForeignObjectAsync','3344869IUePUv','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','warn','.forecast.current.temp','logDuplicates','Bibliotheken\x20nicht\x20gefunden','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','useCalendar','ack','stdout','city','extendObjectAsync','openweathermap.0','LTM.driftAnalysis.lastCheck','Generating\x20Morning\x20Briefing...','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','1wfrWKB','timestamp','genAI','.\x20OUTPUT:\x20Nur\x20Text.','catch','101664clzfUM','includes','Error:\x20','write','cover','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','presenceDevices','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','unload','.\x0a\x20\x20\x20\x20WETTER:\x20','Kein\x20API\x20Key\x20eingegeben.','debug','[PYTHON]\x20','alertReason','dependencyInstallInProgress','setStateAsync','Urlaub','Target\x20ID','analysis.health.notes','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','telegram','.\x20DATEN:\x20Schlaf\x20','unreach','stateChange','submitFeedback','toFixed','online','\x20(Length:\x20','endsWith','location','Drift\x20Status','Invalid\x20JSON\x20from\x20Python:\x20','system.config','now','devices','onReady','Idle','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','analysisTimer','value','switch','sendToAsync','automation.triggerAction','\x20(Value\x20is\x20falsy:\x20','âš ï¸\x20ALARM:\x20','echarts.','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','Keiner','Comfort\x20Suggestion','ðŸ“¡\x20Hooking\x20into\x20','\x20days\x20of\x20activity\x20data\x20to\x20Python...','icons-mfd.','direction','getOverviewData','length','admin.','getFullYear','08:00','User\x20dismissed\x20automation\x20proposal.','generic','Unknown','Failed:\x20','Lernphase\x20(','info.','rssi','splice','Unbekannt','baselineDrift','VACATION','notifyTelegramRecipient','_calName','getTime','scheduleJob','LTM.driftAnalysis.baselineDrift','system.presenceWho','temp','systemUUID','analysis.health.trendDiagnosis','fault','kontakt','TRAINING_COMPLETE','name','TRAIN_SECURITY','analysis.isEmergency','.\x20Welcome\x20home.','pythonProcess','getLtmData','Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip','node-schedule','28uOeGnu','valve','Kalender:\x20Deaktiviert','onStateChange','prÃ¤senz','log','analysis.comfortSuggestion','Error\x20launching\x20Python\x20service:\x20','getMonth','ANALYZE_TREND','\x20presence\x20devices...','notifyTelegramEnabled','light','dismissAutomation','state','Trigger\x20Digest','notifyPushoverInstance','system.mode','onUnload','lastCheck','Fokus\x20auf\x20Komfort.','Briefing\x20Error:\x20','role','main','text','\x20*\x20*\x20*','analysisInterval','requirements.txt','TEST-PRO-KEY','lampe','LTM.trainingData.sequences','analysis.trigger','Kein\x20API\x20Key!','[LOG]','\x20Tage)','setObjectNotExistsAsync','Normal','indicator.alarm.fire','analysis.automation','PARTY','1120oWjyoO','analysis.comfortSummary','Health\x20&\x20Sleep\x20Analysis','simulateButler','currentposition','.Summary.Current','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','Action','text.alarm','daswetter.0','openweathermap','ltmLtbWindowDays','setHours','âœ…\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','ready','Reset\x20Sched\x20Error:\x20','join','occupancy','Deaktiviert\x20(Pro-Feature)','Sending\x20notification:\x20\x22','enum.functions.*','Success:\x20Compressed\x20','accuweather.0','val','Restoring\x20sensor\x20cache\x20from\x20history\x20(','namespace','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','\x20(Type\x20\x27','Baseline\x20Status','parse','BUTLER\x20Execution\x20Error:\x20','notifyPushoverRecipient','PONG','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','useWeather','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','events.history_debug_00','.\x0a\x20\x20\x20\x20KONTEXT:\x20','apply','autoApply','Fokus\x20auf\x20Familienroutinen.','python3','startsWith','weatherInstance','slice','âŒ\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20','isAlert','LTM.driftAnalysis.driftDetails','material.','reachable'];a0_0x2436=function(){return _0x328b8f;};return a0_0x2436();}async function runGeminiAnalysis(_0x19234f,_0x500bab=''){const _0x2801bf=a0_0x40b09f;if(!_0x19234f[_0x2801bf(0x22b)])return;if(_0x19234f[_0x2801bf(0x263)][_0x2801bf(0x131)]===0x0)return;const _0xf9162a=_0x19234f[_0x2801bf(0x263)][_0x2801bf(0x1a8)](0x0,0xf),_0x530004=await getWeatherContext(_0x19234f),_0x38c185=_0x19234f['currentSystemMode'],_0x15239a=PERSONA_MAPPING[_0x19234f['config'][_0x2801bf(0x27f)]||_0x2801bf(0x136)],_0x3ce73f=_0x19234f[_0x2801bf(0x1b2)][_0x2801bf(0x1fc)]||_0x2801bf(0x273);let _0xab54b2=_0x2801bf(0x13d);try{const _0x244f62=await _0x19234f['getStateAsync'](_0x2801bf(0x145));if(_0x244f62&&_0x244f62['val'])_0xab54b2=_0x244f62[_0x2801bf(0x193)];}catch(_0x4602d2){}let _0x222042=![];try{const _0xd5a7f7=await _0x19234f['getStateAsync'](_0x2801bf(0x242));if(_0xd5a7f7&&_0xd5a7f7['val'])_0x222042=!![];}catch(_0x42f0c3){}const _0x504fb4=_0x2801bf(0x1af)+_0x15239a+_0x2801bf(0x1a1)+_0x3ce73f+_0x2801bf(0x1c2)+_0x38c185+_0x2801bf(0x104)+_0x530004+_0x2801bf(0xe7)+(_0x500bab||_0x2801bf(0x12a))+_0x2801bf(0x6c)+(_0x19234f[_0x2801bf(0x2a0)]?_0x2801bf(0x236):_0x2801bf(0xa1))+_0x2801bf(0x269)+_0xab54b2+_0x2801bf(0xe4)+JSON[_0x2801bf(0x287)](_0xf9162a)+_0x2801bf(0x25f);try{const _0x33a85e=await _0x19234f[_0x2801bf(0x22b)]['generateContent'](_0x504fb4),_0x27ab8d=_0x33a85e[_0x2801bf(0x211)][_0x2801bf(0x16c)]()[_0x2801bf(0x229)](/```json|```/g,'')[_0x2801bf(0x1c4)](),_0x54d48a=JSON[_0x2801bf(0x199)](_0x27ab8d);await _0x19234f[_0x2801bf(0x10a)]('analysis.lastResult',{'val':JSON[_0x2801bf(0x287)](_0x54d48a),'ack':!![]});_0x54d48a[_0x2801bf(0x292)]&&await _0x19234f[_0x2801bf(0x10a)]('analysis.activitySummary',{'val':_0x54d48a[_0x2801bf(0x292)],'ack':!![]});const _0x2507ef={'timestamp':Date['now'](),'id':Date[_0x2801bf(0x11c)]()[_0x2801bf(0x238)](),'analysis':{'activity':{'summary':_0x54d48a[_0x2801bf(0x292)]||_0x2801bf(0x262),'isAlert':_0x54d48a[_0x2801bf(0x1aa)]||![],'alertReason':_0x54d48a[_0x2801bf(0x108)]},'comfort':{'automationProposal':_0x54d48a['automationProposal']}}};await updateAnalysisHistory(_0x19234f,_0x2507ef);const _0x2d7a08=_0x54d48a[_0x2801bf(0x1aa)]||![];_0x2d7a08!==_0x19234f[_0x2801bf(0x266)]&&(await _0x19234f[_0x2801bf(0x10a)](_0x2801bf(0x1cc),{'val':_0x2d7a08,'ack':!![]}),_0x19234f[_0x2801bf(0x266)]=_0x2d7a08,_0x2d7a08&&(await _0x19234f[_0x2801bf(0x10a)](_0x2801bf(0x267),{'val':_0x54d48a[_0x2801bf(0x108)],'ack':!![]}),sendNotification(_0x19234f,_0x2801bf(0x127)+_0x54d48a[_0x2801bf(0x108)],![],_0x54d48a['isEmergency']))),_0x54d48a['automationProposal']&&_0x54d48a[_0x2801bf(0x84)][_0x2801bf(0x1b8)]&&_0x54d48a[_0x2801bf(0x84)][_0x2801bf(0x228)]&&(_0x19234f[_0x2801bf(0x159)][_0x2801bf(0x288)](_0x2801bf(0xa0)+_0x54d48a[_0x2801bf(0x84)]['description']),await _0x19234f['setStateAsync'](_0x2801bf(0x248),{'val':!![],'ack':!![]}),await _0x19234f[_0x2801bf(0x10a)]('analysis.automation.description',{'val':_0x54d48a[_0x2801bf(0x84)]['description'],'ack':!![]}),await _0x19234f['setStateAsync'](_0x2801bf(0xb2),{'val':_0x54d48a['automationProposal'][_0x2801bf(0x228)],'ack':!![]}),await _0x19234f[_0x2801bf(0x10a)]('analysis.automation.targetValue',{'val':JSON[_0x2801bf(0x287)](_0x54d48a[_0x2801bf(0x84)]['targetValue']),'ack':!![]}),_0x222042&&(_0x19234f[_0x2801bf(0x159)][_0x2801bf(0x288)](_0x2801bf(0x85)+_0x54d48a[_0x2801bf(0x84)][_0x2801bf(0x228)]+_0x2801bf(0x218)),await executeAutomationAction(_0x19234f)));}catch(_0x3e997a){_0x19234f[_0x2801bf(0x159)][_0x2801bf(0xd8)](_0x2801bf(0x9b)+_0x3e997a['message']);}}function installPythonDependencies(_0xe0ae12){const _0x4104c3=a0_0x40b09f;if(_0xe0ae12['dependencyInstallInProgress'])return;_0xe0ae12[_0x4104c3(0x109)]=!![];const _0x4b620d=path[_0x4104c3(0x18c)](__dirname,_0x4104c3(0x26d),_0x4104c3(0x16f));_0xe0ae12['log'][_0x4104c3(0x288)](_0x4104c3(0x182)+_0x4b620d+_0x4104c3(0x218)),stopPythonService(_0xe0ae12);const _0x39a7a2=_0x4104c3(0x1e0)+_0x4b620d+'\x22\x20--break-system-packages';exec(_0x39a7a2,(_0x10cdce,_0x3e6038,_0x35629a)=>{const _0x1a88f0=_0x4104c3,_0x40c2cc=_0x35629a&&_0x35629a['includes']('No\x20module\x20named\x20pip')||_0x10cdce&&_0x10cdce['message'][_0x1a88f0(0xfc)](_0x1a88f0(0x221));if(_0x40c2cc){_0xe0ae12[_0x1a88f0(0x159)][_0x1a88f0(0xe8)](_0x1a88f0(0x258)),exec(_0x1a88f0(0x100),(_0xbcd345,_0x4c31ba,_0xa7ccdb)=>{const _0x19540b=_0x1a88f0;_0xbcd345?(_0xe0ae12[_0x19540b(0x159)]['error']('âŒ\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.'),_0xe0ae12[_0x19540b(0x159)][_0x19540b(0xd8)](_0x19540b(0x152)),_0xe0ae12['dependencyInstallInProgress']=![]):(_0xe0ae12[_0x19540b(0x159)][_0x19540b(0x288)](_0x19540b(0x189)),exec('python3\x20-m\x20pip\x20install\x20-r\x20\x22'+_0x4b620d+_0x19540b(0x207),(_0x2fc2ec,_0x37db8f,_0xd5cc46)=>{const _0xa11191=_0x19540b;_0x2fc2ec?_0xe0ae12[_0xa11191(0x159)]['error'](_0xa11191(0x1a9)+_0x2fc2ec['message']):(_0xe0ae12[_0xa11191(0x159)]['info'](_0xa11191(0x264)),startPythonService(_0xe0ae12)),_0xe0ae12['dependencyInstallInProgress']=![];}));});return;}_0xe0ae12['dependencyInstallInProgress']=![],_0x10cdce?(_0xe0ae12['log'][_0x1a88f0(0xd8)]('âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.'),_0xe0ae12[_0x1a88f0(0x159)][_0x1a88f0(0xd8)]('Details:\x20'+(_0x35629a||_0x10cdce[_0x1a88f0(0x265)]))):(_0xe0ae12[_0x1a88f0(0x159)][_0x1a88f0(0x288)](_0x1a88f0(0x1ec)),startPythonService(_0xe0ae12));});}function sendToPython(_0x304be6,_0xffade9,_0x22ff6e={}){const _0x3fe958=a0_0x40b09f;if(!_0x304be6[_0x3fe958(0x150)]||!_0x304be6[_0x3fe958(0x150)][_0x3fe958(0x239)][_0x3fe958(0x24e)])return;const _0xdb56e0=JSON[_0x3fe958(0x287)]({'command':_0xffade9,..._0x22ff6e});try{_0x304be6[_0x3fe958(0x150)][_0x3fe958(0x239)]['write'](_0xdb56e0+'\x0a');}catch(_0x3558ab){_0x304be6[_0x3fe958(0x159)]['error'](_0x3fe958(0x27a)+_0x3558ab[_0x3fe958(0x265)]);}}function runPythonHealthCheck(_0x5c07e0){const _0xa7a2de=a0_0x40b09f;if(!_0x5c07e0[_0xa7a2de(0x1f6)]||_0x5c07e0['dailyDigests'][_0xa7a2de(0x131)]<0x2){_0x5c07e0[_0xa7a2de(0x159)][_0xa7a2de(0x288)]('Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.');return;}const _0x49c7a9=_0x5c07e0[_0xa7a2de(0x1f6)]['map'](_0x2f219a=>{const _0xb298bf=_0xa7a2de,_0x554a96=(_0x2f219a['activityLevel']||'')[_0xb298bf(0xb9)]();return ACTIVITY_LEVEL_MAP[_0x554a96]||0x32;});_0x5c07e0['log']['info'](_0xa7a2de(0x1b3)+_0x49c7a9[_0xa7a2de(0x131)]+_0xa7a2de(0x12d)),sendToPython(_0x5c07e0,_0xa7a2de(0x15d),{'values':_0x49c7a9,'tag':_0xa7a2de(0x26b)});}function handlePythonResult(_0x2094c1,_0x49d12a){const _0x1643bd=a0_0x40b09f;if(_0x49d12a[_0x1643bd(0x27e)]===_0x1643bd(0x19c))_0x2094c1[_0x1643bd(0x159)][_0x1643bd(0x106)]('ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.');else{if(_0x49d12a[_0x1643bd(0x27e)]===_0x1643bd(0x1d4)){const {tag:_0x37e515,diagnosis:_0x159e6a,change_percent:_0x324263}=_0x49d12a[_0x1643bd(0x206)];_0x2094c1[_0x1643bd(0x159)][_0x1643bd(0x288)](_0x1643bd(0x23f)+_0x37e515+'):\x20'+_0x159e6a+'\x20('+_0x324263+'%)'),_0x2094c1[_0x1643bd(0x10a)]('analysis.health.trendDiagnosis',{'val':_0x159e6a,'ack':!![]}),_0x2094c1[_0x1643bd(0x10a)](_0x1643bd(0xa5),{'val':_0x324263,'ack':!![]});}else{if(_0x49d12a[_0x1643bd(0x27e)]===_0x1643bd(0x14b)){const {success:_0x29f1ed,details:_0x58c3a3}=_0x49d12a['payload'];_0x29f1ed?(_0x2094c1['log'][_0x1643bd(0x288)](_0x1643bd(0xb4)+_0x58c3a3),_0x2094c1[_0x1643bd(0x10a)](_0x1643bd(0x279),{'val':_0x1643bd(0x8c)+new Date()[_0x1643bd(0x24a)]()+'\x20('+_0x58c3a3+')','ack':!![]})):(_0x2094c1[_0x1643bd(0x159)][_0x1643bd(0xd8)]('âŒ\x20Training\x20failed:\x20'+(_0x58c3a3||'Unknown\x20error')),_0x2094c1[_0x1643bd(0x10a)](_0x1643bd(0x279),{'val':_0x1643bd(0x138)+_0x58c3a3,'ack':!![]}));}}}}function startPythonService(_0x460dc3){const _0x20caeb=a0_0x40b09f;try{const _0x1ac295=path['join'](__dirname,_0x20caeb(0x26d),_0x20caeb(0x26f));_0x460dc3[_0x20caeb(0x159)]['info'](_0x20caeb(0x25a)+_0x1ac295),_0x460dc3[_0x20caeb(0x150)]=spawn(_0x20caeb(0x1a5),[_0x1ac295]),_0x460dc3[_0x20caeb(0x150)][_0x20caeb(0xef)]['on'](_0x20caeb(0x1ce),_0x1e1b81=>{const _0x14ff74=_0x20caeb,_0x5ebfb5=_0x1e1b81[_0x14ff74(0x238)]()['split']('\x0a');_0x5ebfb5['forEach'](_0x458d75=>{const _0x1cbc49=_0x14ff74,_0x18df8a=_0x458d75[_0x1cbc49(0x1c4)]();if(!_0x18df8a)return;if(_0x18df8a[_0x1cbc49(0x1a6)](_0x1cbc49(0x175)))_0x460dc3[_0x1cbc49(0x159)]['debug'](_0x1cbc49(0x107)+_0x18df8a[_0x1cbc49(0x222)](0x5)[_0x1cbc49(0x1c4)]());else{if(_0x18df8a['startsWith']('[RESULT]'))try{const _0x5a7695=JSON[_0x1cbc49(0x199)](_0x18df8a['substring'](0x8)['trim']());handlePythonResult(_0x460dc3,_0x5a7695);}catch(_0x560719){_0x460dc3['log'][_0x1cbc49(0xe8)](_0x1cbc49(0x11a)+_0x18df8a);}}(_0x18df8a[_0x1cbc49(0xfc)](_0x1cbc49(0x26a))||_0x18df8a[_0x1cbc49(0xfc)](_0x1cbc49(0xeb))||_0x18df8a[_0x1cbc49(0xfc)](_0x1cbc49(0x1db)))&&(_0x460dc3[_0x1cbc49(0x159)][_0x1cbc49(0xe8)](_0x1cbc49(0x129)),installPythonDependencies(_0x460dc3));});}),_0x460dc3[_0x20caeb(0x150)][_0x20caeb(0x89)]['on'](_0x20caeb(0x1ce),_0x121b8f=>{const _0x4972ba=_0x20caeb,_0x2bd9e2=_0x121b8f['toString']()[_0x4972ba(0x1c4)]();_0x460dc3['log'][_0x4972ba(0xd8)](_0x4972ba(0x77)+_0x2bd9e2);}),_0x460dc3[_0x20caeb(0x150)]['on'](_0x20caeb(0x231),_0x33e589=>{const _0x2e57cd=_0x20caeb;_0x460dc3[_0x2e57cd(0x159)]['info'](_0x2e57cd(0x120)+_0x33e589),_0x460dc3[_0x2e57cd(0x150)]=null;}),_0x460dc3[_0x20caeb(0x150)]['on'](_0x20caeb(0xd8),_0x4d4572=>{const _0x1a99a0=_0x20caeb;_0x460dc3['log']['warn'](_0x1a99a0(0x19d)+_0x4d4572[_0x1a99a0(0x265)]);});}catch(_0x2aa776){_0x460dc3[_0x20caeb(0x159)][_0x20caeb(0xd8)](_0x20caeb(0x15b)+_0x2aa776[_0x20caeb(0x265)]);}}function stopPythonService(_0x26b159){const _0xeb3b7a=a0_0x40b09f;if(_0x26b159[_0xeb3b7a(0x150)]){_0x26b159[_0xeb3b7a(0x159)][_0xeb3b7a(0x288)](_0xeb3b7a(0x70));try{_0x26b159[_0xeb3b7a(0x150)][_0xeb3b7a(0x6e)]();}catch(_0x16deab){_0x26b159[_0xeb3b7a(0x159)][_0xeb3b7a(0xe8)](_0xeb3b7a(0xa2)+_0x16deab[_0xeb3b7a(0x265)]);}_0x26b159[_0xeb3b7a(0x150)]=null;}}class CogniLiving extends utils[a0_0x40b09f(0x94)]{constructor(_0x222561){const _0x41edb5=a0_0x40b09f;super({..._0x222561,'name':_0x41edb5(0x21e)}),this[_0x41edb5(0x263)]=[],this['analysisHistory']=[],this[_0x41edb5(0x274)]=[],this['rawEventLog']=[],this[_0x41edb5(0x1f6)]=[],this[_0x41edb5(0x25b)]={},this[_0x41edb5(0x1bc)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x41edb5(0x2a0)]=!![],this[_0x41edb5(0x88)]=null,this[_0x41edb5(0x1ed)]=null,this[_0x41edb5(0x1fb)]=![],this[_0x41edb5(0xf8)]=null,this[_0x41edb5(0x22b)]=null,this[_0x41edb5(0x212)]=SYSTEM_MODES[_0x41edb5(0x255)],this[_0x41edb5(0x1ff)]=![],this[_0x41edb5(0x266)]=![],this[_0x41edb5(0x147)]=_0x41edb5(0x74),this[_0x41edb5(0x121)]=null,this[_0x41edb5(0x289)]=null,this[_0x41edb5(0x29d)]=null,this[_0x41edb5(0x1e2)]=null,this['briefingJob']=null,this[_0x41edb5(0x150)]=null,this[_0x41edb5(0x109)]=![],this['on'](_0x41edb5(0x18a),this[_0x41edb5(0x11e)][_0x41edb5(0x1b0)](this)),this['on'](_0x41edb5(0x112),this[_0x41edb5(0x157)][_0x41edb5(0x1b0)](this)),this['on'](_0x41edb5(0x103),this['onUnload']['bind'](this)),this['on'](_0x41edb5(0x265),this[_0x41edb5(0x214)]['bind'](this));}async['onReady'](){const _0x43b651=a0_0x40b09f;this['log'][_0x43b651(0x288)](_0x43b651(0x277)+this[_0x43b651(0x1d7)]+_0x43b651(0x25c)),await initZombies(this),this[_0x43b651(0x1b2)]['licenseKey']=this[_0x43b651(0x1b2)][_0x43b651(0x1be)]||'';try{this[_0x43b651(0x1ff)]=await checkLicense(this,this[_0x43b651(0x1b2)][_0x43b651(0x1be)]);}catch(_0x4a515e){}if(!this[_0x43b651(0x1b2)][_0x43b651(0x78)]||this[_0x43b651(0x1b2)][_0x43b651(0x78)]<0.1)this['config'][_0x43b651(0x78)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x43b651(0x1b2)][_0x43b651(0x217)])try{this[_0x43b651(0xf8)]=new GoogleGenerativeAI(this[_0x43b651(0x1b2)][_0x43b651(0x217)]),this[_0x43b651(0x22b)]=this[_0x43b651(0xf8)][_0x43b651(0x227)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x43b651(0x201)}}),this[_0x43b651(0x159)][_0x43b651(0x288)]('Gemini\x20AI\x20initialized.');}catch(_0x4cd081){this[_0x43b651(0x159)][_0x43b651(0xd8)](_0x43b651(0x1c0)+_0x4cd081[_0x43b651(0x265)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x43b651(0xdf)](_0x43b651(0x173)),this[_0x43b651(0xdf)](LTM_DP_TRIGGER_DIGEST),this[_0x43b651(0xdf)](_0x43b651(0x165)),this['subscribeStates']('analysis.triggerBriefing'),this[_0x43b651(0xdf)](_0x43b651(0x93)),this[_0x43b651(0xdf)](_0x43b651(0x242)),this['subscribeStates'](_0x43b651(0xb5)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0x43b651(0x121)]);const _0x4ef6e1=this[_0x43b651(0x1b2)][_0x43b651(0x16e)]||0xf;_0x4ef6e1>0x0&&(this[_0x43b651(0x159)][_0x43b651(0x288)](_0x43b651(0xc1)+_0x4ef6e1+_0x43b651(0xcc)),this[_0x43b651(0x121)]=setInterval(()=>{runAutopilot(this);},_0x4ef6e1*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x3220b5=_0x43b651;this[_0x3220b5(0x150)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x40b09f(0x166)](_0x1ac66c){const _0x1533f5=a0_0x40b09f;if(this[_0x1533f5(0x121)])clearInterval(this[_0x1533f5(0x121)]);if(this[_0x1533f5(0x1e2)])clearInterval(this[_0x1533f5(0x1e2)]);if(this[_0x1533f5(0x289)])this[_0x1533f5(0x289)][_0x1533f5(0x7f)]();if(this[_0x1533f5(0x29d)])this['modeResetJob'][_0x1533f5(0x7f)]();if(this[_0x1533f5(0x28a)])this[_0x1533f5(0x28a)][_0x1533f5(0x7f)]();if(this[_0x1533f5(0x88)])clearTimeout(this['exitTimer']);if(this[_0x1533f5(0x1ed)])clearTimeout(this[_0x1533f5(0x1ed)]);stopPythonService(this),_0x1ac66c();}async['onStateChange'](_0x562ecc,_0x59bcdb){const _0x401b14=a0_0x40b09f;if(!_0x59bcdb)return;if(_0x562ecc[_0x401b14(0xfc)](_0x401b14(0x10f))&&_0x562ecc[_0x401b14(0x117)](_0x401b14(0x23d))&&_0x59bcdb[_0x401b14(0x193)]){await handleTelegramResponse(this,_0x59bcdb[_0x401b14(0x193)]);return;}if(_0x562ecc===this[_0x401b14(0x195)]+'.'+SYSTEM_DP_MODE){_0x59bcdb[_0x401b14(0x193)]&&Object[_0x401b14(0xaa)](SYSTEM_MODES)[_0x401b14(0xfc)](_0x59bcdb[_0x401b14(0x193)])&&(this[_0x401b14(0x212)]=_0x59bcdb['val'],_0x59bcdb['val']===SYSTEM_MODES[_0x401b14(0x13f)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x59bcdb['ack'])this[_0x401b14(0xca)](_0x562ecc,{'val':this[_0x401b14(0x212)],'ack':!![]});return;}if(!_0x59bcdb[_0x401b14(0xee)]){_0x562ecc['includes'](_0x401b14(0x173))&&_0x59bcdb[_0x401b14(0x193)]&&(this[_0x401b14(0xca)](_0x562ecc,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x562ecc['includes']('triggerDailyDigest')&&_0x59bcdb[_0x401b14(0x193)]){this['setState'](_0x562ecc,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x562ecc[_0x401b14(0xfc)]('triggerBriefing')&&_0x59bcdb[_0x401b14(0x193)]&&(this[_0x401b14(0xca)](_0x562ecc,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x562ecc[_0x401b14(0xfc)](_0x401b14(0x125))&&_0x59bcdb[_0x401b14(0x193)]&&(this[_0x401b14(0xca)](_0x562ecc,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x562ecc[_0x401b14(0xfc)](_0x401b14(0xb5))&&_0x59bcdb['val']){this['setState'](_0x562ecc,{'val':![],'ack':!![]});if(!this[_0x401b14(0x1ff)]){this[_0x401b14(0x159)][_0x401b14(0xe8)](_0x401b14(0x209));return;}try{const _0x27aec0=await this['getStateAsync'](_0x401b14(0x172));if(_0x27aec0&&_0x27aec0[_0x401b14(0x193)]){const _0x3741af=JSON[_0x401b14(0x199)](_0x27aec0[_0x401b14(0x193)]);this['log']['info']('ðŸ§ \x20Triggering\x20Security\x20Training\x20with\x20'+_0x3741af[_0x401b14(0x131)]+_0x401b14(0xae)),this[_0x401b14(0x10a)](_0x401b14(0x279),{'val':_0x401b14(0x86),'ack':!![]}),sendToPython(this,_0x401b14(0x14d),{'sequences':_0x3741af});}else this['log'][_0x401b14(0xe8)](_0x401b14(0xd3)),this[_0x401b14(0x10a)](_0x401b14(0x279),{'val':_0x401b14(0x98),'ack':!![]});}catch(_0x47dc9a){this[_0x401b14(0x159)][_0x401b14(0xd8)](_0x401b14(0x1b4)+_0x47dc9a['message']);}}return;}if(this[_0x401b14(0x1b2)]['presenceDevices']&&this[_0x401b14(0x1b2)][_0x401b14(0x101)][_0x401b14(0xfc)](_0x562ecc)){await checkWifiPresence(this);return;}const _0x210a39=(this[_0x401b14(0x1b2)][_0x401b14(0x11d)]||[])['find'](_0x1d5d40=>_0x1d5d40['id']===_0x562ecc);if(_0x210a39)processSensorEvent(this,_0x562ecc,_0x59bcdb,_0x210a39);}async[a0_0x40b09f(0x214)](_0x262eb9){const _0xf660f5=a0_0x40b09f;if(typeof _0x262eb9===_0xf660f5(0x1ee)&&_0x262eb9[_0xf660f5(0x265)])try{if(_0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0x75)){const _0x516a65=_0x262eb9[_0xf660f5(0x265)][_0xf660f5(0x1cd)]||this[_0xf660f5(0x1b2)][_0xf660f5(0x217)];if(!_0x516a65)return this[_0xf660f5(0x294)](_0x262eb9['from'],_0x262eb9['command'],{'success':![],'message':_0xf660f5(0x105)},_0x262eb9[_0xf660f5(0x1e5)]);try{const _0x5bff85=new GoogleGenerativeAI(_0x516a65),_0x5879ce=_0x5bff85[_0xf660f5(0x227)]({'model':GEMINI_MODEL}),_0x4239a2=await _0x5879ce['generateContent']('Say\x20Hello'),_0x2962de=await _0x4239a2['response'],_0x453478=_0x2962de['text']();this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9['command'],{'success':!![],'message':'Verbindung\x20erfolgreich!\x20Antwort:\x20'+_0x453478[_0xf660f5(0x222)](0x0,0x14)+_0xf660f5(0x218)},_0x262eb9[_0xf660f5(0x1e5)]);}catch(_0xcdd3b0){this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':![],'message':_0xf660f5(0x83)+_0xcdd3b0[_0xf660f5(0x265)]},_0x262eb9[_0xf660f5(0x1e5)]);}}else{if(_0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0xa3)){const _0x595126=await getWeatherContext(this),_0xd8f409=await getCalendarContext(this);this['sendTo'](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':!![],'weather':_0x595126,'calendar':_0xd8f409},_0x262eb9[_0xf660f5(0x1e5)]);}else{if(_0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0xc5)){}else{if(_0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0x151)){if(!this[_0xf660f5(0x1ff)])return this[_0xf660f5(0x294)](_0x262eb9['from'],_0x262eb9[_0xf660f5(0x203)],{'success':![],'isPro':![]},_0x262eb9[_0xf660f5(0x1e5)]);let _0x19a078={'status':_0xf660f5(0x2a5),'details':'','lastCheck':0x0};try{_0x19a078[_0xf660f5(0x2a3)]=(await this[_0xf660f5(0x295)](LTM_DP_DRIFT_STATUS))['val'],_0x19a078[_0xf660f5(0xc8)]=(await this[_0xf660f5(0x295)](LTM_DP_DRIFT_DETAILS))['val'],_0x19a078[_0xf660f5(0x167)]=(await this[_0xf660f5(0x295)](LTM_DP_DRIFT_LAST_CHECK))[_0xf660f5(0x193)];}catch(_0x48b50f){}const _0x479e18=this[_0xf660f5(0x272)]||[];this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':!![],'isPro':!![],'dailyDigests':this[_0xf660f5(0x1f6)],'driftAnalysis':_0x19a078,'analysisHistory':_0x479e18},_0x262eb9[_0xf660f5(0x1e5)]);}else{if(_0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0x130)){const _0x4c6848=this[_0xf660f5(0x1f6)][_0xf660f5(0x131)],_0x212571=new Date(),_0x141826=new Date(_0x212571[_0xf660f5(0x133)](),_0x212571[_0xf660f5(0x15c)](),_0x212571[_0xf660f5(0x250)]())[_0xf660f5(0x142)](),_0x5c3a8e=this['rawEventLog']['filter'](_0x589780=>new Date(_0x589780['timestamp'])[_0xf660f5(0x142)]()>_0x141826)[_0xf660f5(0x131)],_0x1b7f98=new Array(0x18)['fill'](0x0);this[_0xf660f5(0xa9)][_0xf660f5(0x1d8)](_0x57daf6=>{const _0x2b7e11=_0xf660f5,_0x7b4897=new Date(_0x57daf6['timestamp']);if(_0x7b4897['getTime']()>_0x141826)_0x1b7f98[_0x7b4897[_0x2b7e11(0x21b)]()]++;});let _0x345d57={'status':_0xf660f5(0x2a5)};try{_0x345d57[_0xf660f5(0x2a3)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0xf660f5(0x193)];}catch(_0x1cd560){}let _0x8bf785='';try{const _0x5f370c=await this[_0xf660f5(0x295)](_0xf660f5(0x145));_0x8bf785=_0x5f370c?_0x5f370c[_0xf660f5(0x193)]:'';}catch(_0x251ae3){}let _0x35d81f=null;!this[_0xf660f5(0x22b)]&&(_0x35d81f=this['config']['geminiApiKey']?'KI-Modell\x20nicht\x20initialisiert':_0xf660f5(0x174));let _0x2ae326={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x5b7864=await this[_0xf660f5(0x295)]('analysis.automation.patternDetected'),_0x5e1c21=await this[_0xf660f5(0x295)](_0xf660f5(0xda)),_0xcc5d56=await this[_0xf660f5(0x295)]('analysis.automation.targetId'),_0x1ced10=await this[_0xf660f5(0x295)]('analysis.automation.targetValue'),_0x332659=await this[_0xf660f5(0x295)]('analysis.automation.autoApply');_0x5b7864&&_0x5b7864['val']&&(_0x2ae326[_0xf660f5(0x1b8)]=!![],_0x2ae326[_0xf660f5(0xbc)]=_0x5e1c21?_0x5e1c21['val']:'',_0x2ae326[_0xf660f5(0x228)]=_0xcc5d56?_0xcc5d56[_0xf660f5(0x193)]:'',_0x2ae326[_0xf660f5(0x254)]=_0x1ced10?_0x1ced10[_0xf660f5(0x193)]:''),_0x2ae326[_0xf660f5(0x1a3)]=_0x332659?!!_0x332659[_0xf660f5(0x193)]:![];}catch(_0xe7fd88){}this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':!![],'eventHistory':this[_0xf660f5(0x263)]['slice'](0x0,0xf),'stats':{'digestCount':_0x4c6848,'eventCountToday':_0x5c3a8e,'hourlyActivity':_0x1b7f98,'driftStatus':_0x345d57['status'],'isPresent':this['isPresent'],'presenceWho':_0x8bf785,'minDays':this['config'][_0xf660f5(0x251)]||0x7,'stbDays':this[_0xf660f5(0x1b2)][_0xf660f5(0x233)]||0xe,'ltbDays':this[_0xf660f5(0x1b2)][_0xf660f5(0x187)]||0x3c,'systemError':_0x35d81f},'automation':_0x2ae326},_0x262eb9['callback']);}else{if(_0x262eb9[_0xf660f5(0x203)]==='getEnums'){const _0x662784=await this['getForeignObjectsAsync'](_0xf660f5(0x190),_0xf660f5(0x23a)),_0x2d720b=[];if(_0x662784)for(const _0x1e46c7 in _0x662784){const _0x192250=_0x662784[_0x1e46c7],_0x204b0e=(_0x192250['common']&&typeof _0x192250[_0xf660f5(0xe2)][_0xf660f5(0x14c)]===_0xf660f5(0x1ee)?_0x192250[_0xf660f5(0xe2)][_0xf660f5(0x14c)]['de']:_0x192250[_0xf660f5(0xe2)][_0xf660f5(0x14c)])||_0x192250[_0xf660f5(0xe2)][_0xf660f5(0x14c)];_0x2d720b[_0xf660f5(0x224)]({'id':_0x1e46c7,'name':_0x204b0e});}this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':!![],'enums':_0x2d720b},_0x262eb9[_0xf660f5(0x1e5)]);}else{if(_0x262eb9[_0xf660f5(0x203)]==='scanDevices')try{const _0x3f3b4e=await scanForDevices(this,_0x262eb9['message']||{});this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9['command'],{'success':!![],'devices':_0x3f3b4e},_0x262eb9['callback']);}catch(_0x971b){this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':![],'error':_0x971b[_0xf660f5(0x265)]},_0x262eb9[_0xf660f5(0x1e5)]);}else{if(_0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0x20b)){const _0x1eb964=_0x262eb9[_0xf660f5(0x265)][_0xf660f5(0x22f)];if(!_0x1eb964)return this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':![],'error':_0xf660f5(0xb3)},_0x262eb9['callback']);const _0x343c0d=await getCalendarNames(this,_0x1eb964);this['sendTo'](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':!![],'names':_0x343c0d},_0x262eb9['callback']);}else{if(_0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0x17f)){const {targetId:_0x9a5b5a,targetValue:_0x348ecb}=_0x262eb9[_0xf660f5(0x265)];this[_0xf660f5(0x159)]['info'](_0xf660f5(0xd6)+_0x9a5b5a+'\x20=\x20'+_0x348ecb),await this[_0xf660f5(0x10a)](_0xf660f5(0x248),{'val':!![],'ack':!![]}),await this[_0xf660f5(0x10a)](_0xf660f5(0xda),{'val':'SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20'+_0x9a5b5a,'ack':!![]}),await this[_0xf660f5(0x10a)](_0xf660f5(0xb2),{'val':_0x9a5b5a,'ack':!![]}),await this['setStateAsync'](_0xf660f5(0x261),{'val':_0x348ecb,'ack':!![]}),this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':!![]},_0x262eb9['callback']);}else{if(_0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0x113)){const {historyId:_0x39c703,rating:_0x531bc2,comment:_0x1300c3,alertReason:_0x39def0}=_0x262eb9['message'];_0x39c703&&_0x531bc2?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x39c703,'rating':_0x531bc2,'comment':_0x1300c3,'alertReason':_0x39def0}),this['sendTo'](_0x262eb9['from'],_0x262eb9['command'],{'success':!![]},_0x262eb9[_0xf660f5(0x1e5)])):this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9['command'],{'success':![],'error':_0xf660f5(0x204)},_0x262eb9[_0xf660f5(0x1e5)]);}else _0x262eb9[_0xf660f5(0x203)]===_0xf660f5(0x161)&&(this['log']['info'](_0xf660f5(0x135)),await this[_0xf660f5(0x10a)](_0xf660f5(0x248),{'val':![],'ack':!![]}),await this[_0xf660f5(0x10a)](_0xf660f5(0xda),{'val':'','ack':!![]}),this['sendTo'](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9['command'],{'success':!![]},_0x262eb9['callback']));}}}}}}}}}}catch(_0x120835){this[_0xf660f5(0x159)][_0xf660f5(0xd8)](_0xf660f5(0xb6)+_0x262eb9[_0xf660f5(0x203)]+':\x20'+_0x120835['message']);if(_0x262eb9[_0xf660f5(0x1e5)])this[_0xf660f5(0x294)](_0x262eb9[_0xf660f5(0x1f3)],_0x262eb9[_0xf660f5(0x203)],{'success':![],'error':_0x120835[_0xf660f5(0x265)]},_0x262eb9['callback']);}}}if(require[a0_0x40b09f(0x16b)]!==module)module['exports']=_0x468114=>new CogniLiving(_0x468114);else new CogniLiving();