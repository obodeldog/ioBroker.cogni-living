const a0_0x333397=a0_0x205a;function a0_0x284d(){const _0x1218a0=['getAbsoluteDefaultDataDir','val','üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','18074720WVpjPZ','Adapter','door','üîä\x20Infraschall:\x20','[PythonBridge]\x20Forwarding\x20command:\x20','models/gemini-flash-latest','loadSystemMode','send','party','Gemini\x20Report\x20Night','SET_LEARNING_MODE','updateTopology','Aktiv\x20(','toISOString','LTM.trainingData.sequences','namespace','71541DWcWHU','LTM.baselineStatus','LTM.rawEventLog','runPythonHealthCheck','value','node-schedule','getObjectViewAsync','motion','pythonBridge','generateContent','analysis.health.todayVector','createAllObjects','NORMAL','infrasoundArmingId','genAI','.isOnline','getGenerativeModel','Warm-Up\x20Time','callback','8306412hQpnEs','filter','isSolar','analysisTimer','analyzeWindowOpening\x20error:\x20','subscribeStates','location','error','toLocaleDateString','outdoorSensorId','calendarCheckTimer','scheduleJob','SYSTEM_DP_MODE','de-DE','5wfYmMS','analysis.energy.warmupTimes','\x20sequences','getOverviewData','setPresence','lastTrackerEventTime','geminiApiKey','analysis.health.activityTrend','analysis.automation.description',',\x20Events:\x0a','system.adapter.ical.È¶ô','currentSystemMode','testApiKey','memoryCache','mkdirSync','unshift','now','infrasoundSensorId','utf8','triggerEnergyPrediction','onReady','¬∞C,\x20Au√üen:\x20','Event','updated','saveDailyHistory','state','temperature','Keine\x20Daten','sensorLastValues','./lib/scheduler','analysis.trigger','analysis.health.todayRoomDetails','sendTo','analysis.topology.structure','history','activeModules','forEach','getHistoryData','analysis.activity.roomStats','driftAnalysisTimer','briefingJob','warn','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','scanThermostats','replace','analysis.automation.targetValue','üìù\x20Manual\x20event\x20logged:\x20','analysis.automation.patternDetected','triggerHealth\x20error:\x20','command','TRAIN_HEALTH','klar','onUnload','@iobroker/adapter-core','76731MHswIO','subscribeForeignStatesAsync',':\x20Temp-Differenz\x20','then','.venv','updateLocation','onStateChange','setObjectNotExistsAsync','pressureBuffer','Kein\x20API\x20Key\x20√ºbergeben.','enum.rooms.*','inactivityThresholdHours','generateHealthReport','forecast.current.weather','search','writeFileSync','appendToLog','analysis.health.geminiNight','\x20Tage)','./lib/recorder','Warte\x20auf\x20Analyse...','‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','push','\x20(Bewohner\x20anwesend\x20-\x20normal)','integrateRoomTime','Scan\x20Error:\x20','exports','weatherTempId','abortExitTimer','Room\x20History\x20(24h\x20Buckets)','slice','eventHistory','CALCULATE_HEALTH_TREND','rows','sunny','enum','application/json','Party\x20Mode','substring','join','L√ºften\x20empfohlen','updateHealthVector','.data.table','cancel','Daily\x20Room\x20Details\x20(48x30min)','triggerGaitAnalysis\x20error:\x20','updateTopologyMatrix','.json','setStateAsync','isProVersion','\x20events\x20from\x20today...','text','Sec-Training\x20started...','analysisHistory','calendarName','stopService','startService','./lib/installer','number','./lib/dead_man','common','[Integrator]\x20Error:\x20','existsSync','keys','.uptime','SYSTEM_MODES','executeAutomationAction','scanForDevices','542654FDHqcP','pop','Niemand','weatherunderground.0','Room\x20Dwell\x20Time\x20Stats','dependencyInstallInProgress','üì¶\x20Restored\x20','shift','checkSolarCondition','type','replayTodayEvents','...','date','onMessage','fill','{\x22history\x22:{}}','setState','json','Corrupt','Init...','analyzeWindowOpening','values','1668772YoElJX','runAutopilot','from','path','infrasoundLocked','getForeignStateAsync','system.adapter.ical.','exitTimer','analysis.prediction.trackerConfidence','cleanupGhostInterventions','Invalid\x20matrix\x20data','\x20-\x20','system.presenceWho','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','runGeminiAnalysis','\x20events\x20from\x20standard\x20storage.','59\x2023\x20*\x20*\x20*','round','22RlqCXR','./lib/automation','TRAIN_SECURITY','open','security','isArray','max','Unbekannt','getHours','Gemini\x20Init\x20Error:\x20','üîä\x20Infraschall-Alarm:\x20','592EfsptS','analysis.security.lastScore','string','pythonBridge\x20command\x20failed:\x20','comfort','./lib/ai_agent','getDate','map','constructor','getMinutes','isGracePeriodActive','./lib/topology','exitGraceTimer','events.history','setHours','checkLicense','Gute\x20L√ºftungsm√∂glichkeit!','No\x20data','analysis.training.status','licenseKey','triggerEnergyPrediction\x20Error:\x20','Sonne:\x20','Gemini\x20Report\x20Day','system','analysis.security.learningStatus','\x20>\x20','LTM.dailyDigests','triggerInfrasoundCorrelation','analysis.training.triggerEnergy','Guest\x20Mode','NIGHT','cogni-living\x20adapter\x20starting\x20(v','toLowerCase','stringify','includes','moduleSecurity','testContext','parse','Live\x20Event\x20Pulse','LTM.triggerDailyDigest','rawEventLog','refreshCalendar','infrasoundEnabled','analysis.health.geminiDay','analysis.visualization.pulse','cogni-living','log','sonn','split','min','triggerDailyDigest','message','healthTrendInterval','toLocaleTimeString','triggerBriefing','endsWith','infrasoundThreshold','updateTopologyMatrix\x20failed:\x20','‚Ü∫\x20Replaying\x20','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','find','Unknown','response','bind','processSensorEvent','üíæ\x20Saving\x20Daily\x20History\x20for\x20','sources','Verbindung\x20erfolgreich:\x20','trackerHeartbeat','toString','todayVector','handleInfrasound','modeResetJob','analysis.energy.warmupSources','times','length','getStateAsync','matrix','Current.WeatherText','timestamp','TRAIN_TOPOLOGY','analysis.ventilation.lastWindow','python','readFileSync','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','bootTime','isRelevantActivity','online','accuweather.0','main','roomIntegratorTimer','name','initSystemConfig','getTime','instance','presenceDevices','(((.+)+)+)+$','getEnums','sendNotification','debug','dailyDigests','lastAlertState','moduleHealth','historyJob','analysis.activity.roomHistory','./lib/scanner','config','telegram','apiKey','refreshCalendar\x20failed:\x20','analysis.automation.targetId','sendMorningBriefing','geminiModel','health','analysis.training.triggerHealth','object','checkCalendarTriggers','isPresent','info','startSystem','NextHours.Location_1.Day_1.current.symbol_desc','Say\x20Hello','version','History\x20Save\x20Error:\x20','ack','thermostat','toFixed','scanDevices','üí®\x20L√ºftung\x20in\x20','abs','PREDICT_ENERGY','add','minDaysForBaseline','2805740gXtLPh','initHistory','analysis.energy.warmupTargets','useCalendar','enum.functions.*','ERROR','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','\x20Kalender-Adapter\x20gefunden.','üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20','checkWifiPresence','energy','./lib/setup','¬∞C\x20(Innen:\x20','Daily\x20Activity\x20Vector\x20(48x30min)','‚úÖ\x20History\x20saved:\x20','üï∏Ô∏è\x20Topology\x20Matrix\x20manually\x20updated\x20by\x20user.','analysis.safety.infrasoundAlert','devices',',\x20Temp:\x20','moduleComfort','modules','¬∞C)','presenceCheckTimer'];a0_0x284d=function(){return _0x1218a0;};return a0_0x284d();}(function(_0x22cc06,_0x2f6dcb){const _0x3c12dc=a0_0x205a,_0x16f287=_0x22cc06();while(!![]){try{const _0x2925b1=-parseInt(_0x3c12dc(0x1f8))/0x1+-parseInt(_0x3c12dc(0x220))/0x2*(parseInt(_0x3c12dc(0x1b4))/0x3)+-parseInt(_0x3c12dc(0x133))/0x4+-parseInt(_0x3c12dc(0x17e))/0x5*(-parseInt(_0x3c12dc(0x170))/0x6)+-parseInt(_0x3c12dc(0x20e))/0x7+parseInt(_0x3c12dc(0x22b))/0x8*(-parseInt(_0x3c12dc(0x15d))/0x9)+parseInt(_0x3c12dc(0x14d))/0xa;if(_0x2925b1===_0x2f6dcb)break;else _0x16f287['push'](_0x16f287['shift']());}catch(_0x28cdfc){_0x16f287['push'](_0x16f287['shift']());}}}(a0_0x284d,0xcd088));const a0_0x374b69=(function(){let _0xa83385=!![];return function(_0x4b0611,_0x4cc956){const _0x48f4ba=_0xa83385?function(){if(_0x4cc956){const _0x1a4a4e=_0x4cc956['apply'](_0x4b0611,arguments);return _0x4cc956=null,_0x1a4a4e;}}:function(){};return _0xa83385=![],_0x48f4ba;};}()),a0_0xcf669b=a0_0x374b69(this,function(){const _0x315073=a0_0x205a;return a0_0xcf669b[_0x315073(0x270)]()[_0x315073(0x1c2)](_0x315073(0x28b))['toString']()[_0x315073(0x233)](a0_0xcf669b)[_0x315073(0x1c2)]('(((.+)+)+)+$');});a0_0xcf669b();'use strict';const utils=require(a0_0x333397(0x1b3)),{GoogleGenerativeAI}=require('@google/generative-ai'),path=require(a0_0x333397(0x211)),fs=require('fs'),installer=require(a0_0x333397(0x1ed)),scanner=require(a0_0x333397(0x117)),schedulers=require(a0_0x333397(0x19b)),topology=require(a0_0x333397(0x236)),setup=require(a0_0x333397(0x13e)),recorder=require(a0_0x333397(0x1c7)),pythonBridge=require('./lib/python_bridge'),aiAgent=require(a0_0x333397(0x230)),deadMan=require(a0_0x333397(0x1ef)),automation=require(a0_0x333397(0x221)),GEMINI_MODEL=a0_0x333397(0x152);function a0_0x205a(_0x4d8384,_0x5617c6){const _0x3e29a6=a0_0x284d();return a0_0x205a=function(_0xcf669b,_0x374b69){_0xcf669b=_0xcf669b-0x116;let _0x284d6d=_0x3e29a6[_0xcf669b];return _0x284d6d;},a0_0x205a(_0x4d8384,_0x5617c6);}class CogniLiving extends utils[a0_0x333397(0x14e)]{constructor(_0x226f0f){const _0x527ec6=a0_0x333397;super({..._0x226f0f,'name':_0x527ec6(0x258)}),this[_0x527ec6(0x1d3)]=[],this[_0x527ec6(0x1e9)]=[],this[_0x527ec6(0x253)]=[],this[_0x527ec6(0x28f)]=[],this[_0x527ec6(0x19a)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x527ec6(0x215)]=null,this[_0x527ec6(0x237)]=null,this[_0x527ec6(0x235)]=![],this[_0x527ec6(0x16b)]=null,this[_0x527ec6(0x11e)]=null,this['currentSystemMode']=setup[_0x527ec6(0x1f5)][_0x527ec6(0x169)],this[_0x527ec6(0x1e5)]=![],this[_0x527ec6(0x290)]=![],this[_0x527ec6(0x173)]=null,this['calendarCheckTimer']=null,this[_0x527ec6(0x149)]=null,this['ltmJob']=null,this[_0x527ec6(0x273)]=null,this[_0x527ec6(0x1a5)]=null,this[_0x527ec6(0x1a6)]=null,this[_0x527ec6(0x292)]=null,this[_0x527ec6(0x26f)]=null,this[_0x527ec6(0x25f)]=null,this[_0x527ec6(0x285)]=null,this[_0x527ec6(0x1fd)]=![],this[_0x527ec6(0x183)]=Date['now'](),this['memoryCache']=null,this[_0x527ec6(0x280)]=Date[_0x527ec6(0x18e)](),this[_0x527ec6(0x212)]=![],this[_0x527ec6(0x1bc)]=[],this['activeModules']={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on']('ready',this[_0x527ec6(0x192)][_0x527ec6(0x26a)](this)),this['on']('stateChange',this[_0x527ec6(0x1ba)][_0x527ec6(0x26a)](this)),this['on']('unload',this[_0x527ec6(0x1b2)][_0x527ec6(0x26a)](this)),this['on'](_0x527ec6(0x25e),this[_0x527ec6(0x205)][_0x527ec6(0x26a)](this));}async['onReady'](){const _0x28a100=a0_0x333397;this[_0x28a100(0x259)][_0x28a100(0x124)](_0x28a100(0x24a)+this[_0x28a100(0x128)]+')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)');if(this['config']['moduleHealth']!==undefined)this['activeModules'][_0x28a100(0x11f)]=this[_0x28a100(0x118)][_0x28a100(0x291)];if(this['config'][_0x28a100(0x24e)]!==undefined)this[_0x28a100(0x1a1)]['security']=this[_0x28a100(0x118)][_0x28a100(0x24e)];if(this[_0x28a100(0x118)]['moduleEnergy']!==undefined)this['activeModules'][_0x28a100(0x13d)]=this[_0x28a100(0x118)]['moduleEnergy'];if(this[_0x28a100(0x118)][_0x28a100(0x146)]!==undefined)this[_0x28a100(0x1a1)][_0x28a100(0x22f)]=this[_0x28a100(0x118)][_0x28a100(0x146)];if(this[_0x28a100(0x118)][_0x28a100(0x147)])this['activeModules']={...this[_0x28a100(0x1a1)],...this[_0x28a100(0x118)][_0x28a100(0x147)]};this[_0x28a100(0x125)]();}async[a0_0x333397(0x125)](){const _0x323d73=a0_0x333397;await setup['initZombies'](this);try{this[_0x323d73(0x1e5)]=await setup[_0x323d73(0x23a)](this[_0x323d73(0x118)][_0x323d73(0x23e)]);}catch(_0x382d78){}if(!this[_0x323d73(0x118)][_0x323d73(0x1bf)]||this[_0x323d73(0x118)][_0x323d73(0x1bf)]<0.1)this[_0x323d73(0x118)][_0x323d73(0x1bf)]=0xc;await setup[_0x323d73(0x134)](this),await setup[_0x323d73(0x287)](this),topology[_0x323d73(0x158)](this);try{const _0x345d31=await this['getStateAsync']('analysis.energy.warmupTimes'),_0x125272=await this[_0x323d73(0x277)]('analysis.energy.warmupSources');_0x345d31&&_0x345d31[_0x323d73(0x14b)]&&_0x125272&&_0x125272['val']&&(Date[_0x323d73(0x18e)]()-_0x345d31['ts']<0x4*0xe10*0x3e8&&(this[_0x323d73(0x18b)]={'times':JSON[_0x323d73(0x250)](_0x345d31[_0x323d73(0x14b)]),'sources':JSON[_0x323d73(0x250)](_0x125272[_0x323d73(0x14b)])}));}catch(_0x6fd031){}if(this[_0x323d73(0x118)][_0x323d73(0x184)])try{this[_0x323d73(0x16b)]=new GoogleGenerativeAI(this[_0x323d73(0x118)][_0x323d73(0x184)]),this[_0x323d73(0x11e)]=this['genAI']['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x323d73(0x1d8)}});}catch(_0x32deea){this[_0x323d73(0x259)][_0x323d73(0x177)](_0x323d73(0x229)+_0x32deea['message']);}await setup[_0x323d73(0x168)](this),await this[_0x323d73(0x153)](),schedulers['initSchedules'](this),await this[_0x323d73(0x1bb)](_0x323d73(0x257),{'type':_0x323d73(0x197),'common':{'name':_0x323d73(0x251),'type':'number','role':_0x323d73(0x161),'read':!![],'write':![]},'native':{}}),await this[_0x323d73(0x1bb)]('analysis.activity.roomStats',{'type':_0x323d73(0x197),'common':{'name':_0x323d73(0x1fc),'type':'string','role':_0x323d73(0x209),'read':!![],'write':![],'def':_0x323d73(0x266)},'native':{}}),await this[_0x323d73(0x1bb)](_0x323d73(0x116),{'type':_0x323d73(0x197),'common':{'name':_0x323d73(0x1d1),'type':'string','role':'json','read':!![],'write':![],'def':_0x323d73(0x207)},'native':{}}),await this[_0x323d73(0x1bb)]('analysis.health.geminiNight',{'type':_0x323d73(0x197),'common':{'name':_0x323d73(0x156),'type':_0x323d73(0x22d),'role':_0x323d73(0x1e7),'read':!![],'write':![],'def':_0x323d73(0x1c8)},'native':{}}),await this[_0x323d73(0x1bb)](_0x323d73(0x256),{'type':_0x323d73(0x197),'common':{'name':_0x323d73(0x241),'type':_0x323d73(0x22d),'role':_0x323d73(0x1e7),'read':!![],'write':![],'def':_0x323d73(0x1c8)},'native':{}}),await this[_0x323d73(0x1bb)](_0x323d73(0x167),{'type':'state','common':{'name':_0x323d73(0x140),'type':_0x323d73(0x22d),'role':_0x323d73(0x209),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x323d73(0x19d),{'type':_0x323d73(0x197),'common':{'name':_0x323d73(0x1e0),'type':_0x323d73(0x22d),'role':_0x323d73(0x209),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x323d73(0x185),{'type':_0x323d73(0x197),'common':{'name':'General\x20Activity\x20Trend','type':_0x323d73(0x1ee),'role':_0x323d73(0x161),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x323d73(0x1bb)](_0x323d73(0x17f),{'type':_0x323d73(0x197),'common':{'name':_0x323d73(0x16e),'type':_0x323d73(0x22d),'role':_0x323d73(0x209),'read':!![],'write':![]},'native':{}});try{const _0x3360a9=await this[_0x323d73(0x277)](_0x323d73(0x238));if(_0x3360a9&&_0x3360a9[_0x323d73(0x14b)]){this[_0x323d73(0x1d3)]=JSON['parse'](_0x3360a9[_0x323d73(0x14b)]);if(this[_0x323d73(0x1e5)]){const _0x49ce70=await this[_0x323d73(0x277)]('LTM.rawEventLog');if(_0x49ce70&&_0x49ce70[_0x323d73(0x14b)])this[_0x323d73(0x253)]=JSON[_0x323d73(0x250)](_0x49ce70[_0x323d73(0x14b)]);}this['log'][_0x323d73(0x124)](_0x323d73(0x1fe)+this[_0x323d73(0x1d3)][_0x323d73(0x276)]+_0x323d73(0x21d));}}catch(_0x1b976a){this[_0x323d73(0x1d3)]=[];}try{const _0x4896f6=await this['getStateAsync'](_0x323d73(0x245));if(_0x4896f6&&_0x4896f6[_0x323d73(0x14b)])this[_0x323d73(0x28f)]=JSON[_0x323d73(0x250)](_0x4896f6[_0x323d73(0x14b)]);}catch(_0x1fff03){this[_0x323d73(0x28f)]=[];}const _0xbe0f5b=this[_0x323d73(0x28f)][_0x323d73(0x276)]>=(this['config'][_0x323d73(0x132)]||0x7)?_0x323d73(0x159)+this[_0x323d73(0x28f)][_0x323d73(0x276)]+_0x323d73(0x1c6):'Lernphase\x20('+this[_0x323d73(0x28f)][_0x323d73(0x276)]+'/'+(this[_0x323d73(0x118)][_0x323d73(0x132)]||0x7)+')';await this[_0x323d73(0x1e4)](_0x323d73(0x15e),{'val':_0xbe0f5b,'ack':!![]}),this[_0x323d73(0x175)](_0x323d73(0x19c)),this['subscribeStates'](_0x323d73(0x252)),this[_0x323d73(0x175)](_0x323d73(0x120));this['config'][_0x323d73(0x255)]&&this[_0x323d73(0x118)][_0x323d73(0x18f)]&&this['activeModules'][_0x323d73(0x224)]&&this['subscribeForeignStates'](this['config'][_0x323d73(0x18f)]);const _0x36c3a3=this['config'][_0x323d73(0x144)];if(_0x36c3a3)for(const _0x11ea25 of _0x36c3a3){await this['subscribeForeignStatesAsync'](_0x11ea25['id']);}const _0x181ab9=this[_0x323d73(0x118)][_0x323d73(0x28a)];if(_0x181ab9)for(const _0x88e47c of _0x181ab9){await this[_0x323d73(0x1b5)](_0x88e47c);}const _0x4d591d=require(_0x323d73(0x162));if(this[_0x323d73(0x292)])this['historyJob'][_0x323d73(0x1df)]();this['historyJob']=_0x4d591d[_0x323d73(0x17b)](_0x323d73(0x21e),()=>{const _0x375fa1=_0x323d73;this[_0x375fa1(0x196)]();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this[_0x323d73(0x285)])clearInterval(this['roomIntegratorTimer']);this[_0x323d73(0x1cc)](),this['roomIntegratorTimer']=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this[_0x323d73(0x25f)])clearInterval(this[_0x323d73(0x25f)]);this[_0x323d73(0x25f)]=setInterval(()=>{const _0x385444=_0x323d73;this[_0x385444(0x1e5)]&&this[_0x385444(0x1a1)][_0x385444(0x11f)]&&this[_0x385444(0x160)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x323d73(0x173)])clearInterval(this[_0x323d73(0x173)]);this[_0x323d73(0x1a1)][_0x323d73(0x13d)]&&(this[_0x323d73(0x173)]=setInterval(()=>{const _0x55ad04=_0x323d73;this[_0x55ad04(0x191)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x323d73(0x191)](),0x2710));if(this[_0x323d73(0x17a)])clearInterval(this[_0x323d73(0x17a)]);this[_0x323d73(0x118)][_0x323d73(0x136)]&&this[_0x323d73(0x1a1)][_0x323d73(0x13d)]&&(this[_0x323d73(0x17a)]=setInterval(()=>{automation['checkCalendarTriggers'](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x323d73(0x122)](this),0x3a98));if(this[_0x323d73(0x149)])clearInterval(this['presenceCheckTimer']);this[_0x323d73(0x118)][_0x323d73(0x28a)]&&this[_0x323d73(0x118)][_0x323d73(0x28a)][_0x323d73(0x276)]>0x0&&(this[_0x323d73(0x149)]=setInterval(async()=>{const _0x238b21=_0x323d73;await this[_0x238b21(0x13c)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0x323d73(0x13c)](),0x1388));const _0x2dde88=path['join'](__dirname,_0x323d73(0x1b8),'bin',_0x323d73(0x27d));pythonBridge[_0x323d73(0x1ec)](this,_0x2dde88);}['onUnload'](_0x2955d0){const _0x32594e=a0_0x333397;if(this['historyJob'])this[_0x32594e(0x292)][_0x32594e(0x1df)]();this[_0x32594e(0x196)]()[_0x32594e(0x1b7)](()=>{const _0xb895a=_0x32594e;if(this['analysisTimer'])clearInterval(this[_0xb895a(0x173)]);if(this['calendarCheckTimer'])clearInterval(this['calendarCheckTimer']);if(this['presenceCheckTimer'])clearInterval(this['presenceCheckTimer']);if(this[_0xb895a(0x285)])clearInterval(this[_0xb895a(0x285)]);recorder[_0xb895a(0x1d0)](this),pythonBridge[_0xb895a(0x1eb)](this),_0x2955d0();});}async[a0_0x333397(0x202)](){const _0x30ff1a=a0_0x333397;if(!this['eventHistory']||this[_0x30ff1a(0x1d3)]['length']===0x0){this[_0x30ff1a(0x259)]['warn']('‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.');return;}this[_0x30ff1a(0x259)][_0x30ff1a(0x124)](_0x30ff1a(0x265)+this[_0x30ff1a(0x1d3)][_0x30ff1a(0x276)]+_0x30ff1a(0x1e6));const _0x1c16f7=new Date()[_0x30ff1a(0x239)](0x0,0x0,0x0,0x0),_0x4ad83a=_0x30ff1a(0x116);let _0x39dfb8={'history':{},'date':new Date()[_0x30ff1a(0x178)]()};const _0x25e7b5='analysis.health.todayVector',_0x29d202=_0x30ff1a(0x19d);let _0x389fd4=new Array(0x30)[_0x30ff1a(0x206)](0x0),_0x5dd471=Array[_0x30ff1a(0x210)]({'length':0x30},()=>[]);this[_0x30ff1a(0x1d3)][_0x30ff1a(0x1a2)](_0x4db0c0=>{const _0x50091d=_0x30ff1a;if(_0x4db0c0[_0x50091d(0x27a)]>=_0x1c16f7){if(recorder[_0x50091d(0x281)](_0x4db0c0[_0x50091d(0x201)],_0x4db0c0[_0x50091d(0x161)])){const _0x17da63=new Date(_0x4db0c0[_0x50091d(0x27a)]),_0x983205=_0x17da63[_0x50091d(0x228)]()*0x2+(_0x17da63[_0x50091d(0x234)]()>=0x1e?0x1:0x0);if(_0x983205<0x30){_0x389fd4[_0x983205]++;const _0x559506=_0x4db0c0['location']||_0x4db0c0[_0x50091d(0x286)]||'?';let _0x472aa8=_0x5dd471[_0x983205];!_0x472aa8[_0x50091d(0x24d)](_0x559506)&&_0x472aa8[_0x50091d(0x1ca)](_0x559506);}const _0x2edba0=_0x17da63['getHours']();let _0x5572a8=_0x4db0c0['location']||_0x50091d(0x268);const _0x41574b=(this[_0x50091d(0x118)][_0x50091d(0x144)]||[])[_0x50091d(0x267)](_0x51ab28=>_0x51ab28[_0x50091d(0x176)]===_0x5572a8);if(_0x41574b)_0x5572a8=_0x41574b['location'];if(!_0x39dfb8[_0x50091d(0x1a0)][_0x5572a8])_0x39dfb8[_0x50091d(0x1a0)][_0x5572a8]=new Array(0x18)[_0x50091d(0x206)](0x0);if(_0x39dfb8['history'][_0x5572a8][_0x2edba0]<0x3c)_0x39dfb8[_0x50091d(0x1a0)][_0x5572a8][_0x2edba0]++;}}});const _0x348cc2=await this[_0x30ff1a(0x277)](_0x4ad83a);(!_0x348cc2||!_0x348cc2[_0x30ff1a(0x14b)]||_0x348cc2['val']==='{}'||_0x348cc2[_0x30ff1a(0x14b)][_0x30ff1a(0x24d)]('\x22history\x22:{}'))&&await this[_0x30ff1a(0x1e4)](_0x4ad83a,{'val':JSON[_0x30ff1a(0x24c)](_0x39dfb8),'ack':!![]}),await this['setStateAsync'](_0x25e7b5,{'val':JSON[_0x30ff1a(0x24c)](_0x389fd4),'ack':!![]}),await this[_0x30ff1a(0x1e4)](_0x29d202,{'val':JSON[_0x30ff1a(0x24c)](_0x5dd471),'ack':!![]}),this[_0x30ff1a(0x259)][_0x30ff1a(0x124)](_0x30ff1a(0x21b));}async[a0_0x333397(0x196)](){const _0x2dc1f7=a0_0x333397;if(!this['activeModules'][_0x2dc1f7(0x11f)])return;const _0xe8b7df=new Date()[_0x2dc1f7(0x15a)]()[_0x2dc1f7(0x25b)]('T')[0x0];this[_0x2dc1f7(0x259)][_0x2dc1f7(0x28e)](_0x2dc1f7(0x26c)+_0xe8b7df+_0x2dc1f7(0x203));try{const [_0x1ac165,_0x21f0f1,_0x40307d,_0x3cc9d1,_0x253f71,_0x51f9c8]=await Promise['all']([this[_0x2dc1f7(0x277)](_0x2dc1f7(0x116)),this[_0x2dc1f7(0x277)](_0x2dc1f7(0x1c5)),this[_0x2dc1f7(0x277)]('analysis.health.geminiDay'),this['getStateAsync'](_0x2dc1f7(0x22c)),this[_0x2dc1f7(0x277)](_0x2dc1f7(0x167)),this['getStateAsync'](_0x2dc1f7(0x185))]),_0x4637b8=new Date()[_0x2dc1f7(0x239)](0x0,0x0,0x0,0x0),_0x1ad716=this['eventHistory'][_0x2dc1f7(0x171)](_0x54b9a1=>_0x54b9a1[_0x2dc1f7(0x27a)]>=_0x4637b8&&(_0x54b9a1[_0x2dc1f7(0x286)][_0x2dc1f7(0x24b)]()[_0x2dc1f7(0x24d)]('haust√ºr')||_0x54b9a1[_0x2dc1f7(0x286)][_0x2dc1f7(0x24b)]()[_0x2dc1f7(0x24d)]('terrasse'))&&(_0x54b9a1['value']===!![]||_0x54b9a1[_0x2dc1f7(0x161)]===_0x2dc1f7(0x223)))[_0x2dc1f7(0x276)];let _0x1fe249=0x55;if(_0x51f9c8&&_0x51f9c8[_0x2dc1f7(0x14b)]!==undefined)_0x1fe249=Math[_0x2dc1f7(0x25c)](0x64,Math[_0x2dc1f7(0x226)](0x14,Math[_0x2dc1f7(0x21f)](0x50+Number(_0x51f9c8[_0x2dc1f7(0x14b)])*0x5)));const _0x740797=this[_0x2dc1f7(0x1d3)][_0x2dc1f7(0x171)](_0x497d64=>_0x497d64['timestamp']>=_0x4637b8),_0x1120de={'date':_0xe8b7df,'timestamp':Date[_0x2dc1f7(0x18e)](),'roomHistory':_0x1ac165?.['val']?JSON['parse'](_0x1ac165['val']):{},'geminiNight':_0x21f0f1?.[_0x2dc1f7(0x14b)]||_0x2dc1f7(0x199),'geminiDay':_0x40307d?.[_0x2dc1f7(0x14b)]||_0x2dc1f7(0x199),'anomalyScore':_0x3cc9d1?.['val']||0.1,'todayVector':_0x253f71?.[_0x2dc1f7(0x14b)]?JSON['parse'](_0x253f71[_0x2dc1f7(0x14b)]):new Array(0x30)[_0x2dc1f7(0x206)](0x0),'batteryLevel':_0x1fe249,'freshAirCount':_0x1ad716,'eventHistory':_0x740797},_0x5941d6=utils['getAbsoluteDefaultDataDir'](),_0x3a6234=path[_0x2dc1f7(0x1db)](_0x5941d6,_0x2dc1f7(0x258),_0x2dc1f7(0x1a0));if(!fs[_0x2dc1f7(0x1f2)](_0x3a6234))fs[_0x2dc1f7(0x18c)](_0x3a6234,{'recursive':!![]});const _0x565cb9=path[_0x2dc1f7(0x1db)](_0x3a6234,_0xe8b7df+_0x2dc1f7(0x1e3));fs[_0x2dc1f7(0x1c3)](_0x565cb9,JSON[_0x2dc1f7(0x24c)](_0x1120de)),this[_0x2dc1f7(0x259)][_0x2dc1f7(0x124)](_0x2dc1f7(0x141)+_0x565cb9);}catch(_0x7f32c0){this[_0x2dc1f7(0x259)]['error'](_0x2dc1f7(0x129)+_0x7f32c0[_0x2dc1f7(0x25e)]);}}async['integrateRoomTime'](){const _0x197c32=a0_0x333397;if(!this[_0x197c32(0x123)])return;try{let _0x36df14=null;try{const _0x3b068b=await this[_0x197c32(0x277)]('analysis.prediction.trackerTopRoom'),_0x29162c=await this['getStateAsync'](_0x197c32(0x216));if(_0x3b068b&&_0x3b068b[_0x197c32(0x14b)]&&_0x29162c&&_0x29162c['val']&&_0x29162c[_0x197c32(0x14b)]>0.3){if(_0x3b068b[_0x197c32(0x14b)]!==_0x197c32(0x268)&&_0x3b068b[_0x197c32(0x14b)]!==_0x197c32(0x20b))_0x36df14=_0x3b068b['val'];}}catch(_0x3006e6){}if(!_0x36df14){const _0x448c71=this[_0x197c32(0x118)]['devices']||[];for(const _0x36334c of _0x448c71){if(_0x36334c[_0x197c32(0x201)]===_0x197c32(0x164)&&_0x36334c[_0x197c32(0x176)])try{const _0x486cd2=await this[_0x197c32(0x213)](_0x36334c['id']);if(_0x486cd2&&(_0x486cd2[_0x197c32(0x14b)]===!![]||_0x486cd2[_0x197c32(0x14b)]==='on'||_0x486cd2[_0x197c32(0x14b)]===0x1)){_0x36df14=_0x36334c[_0x197c32(0x176)];break;}}catch(_0x3494c){}}}if(!_0x36df14)return;const _0x2522cc=this[_0x197c32(0x118)]['devices']||[];let _0x12b00b=_0x36df14;const _0x1e5704=_0x2522cc[_0x197c32(0x267)](_0x3d7398=>_0x3d7398[_0x197c32(0x176)]&&_0x3d7398['location'][_0x197c32(0x24b)]()===_0x36df14[_0x197c32(0x24b)]());if(_0x1e5704)_0x12b00b=_0x1e5704['location'];const _0x4656e6=_0x197c32(0x116),_0x9f0cfd=await this[_0x197c32(0x277)](_0x4656e6),_0xbdee47=new Date()[_0x197c32(0x178)]();let _0x3bff00={'history':{},'date':_0xbdee47};if(_0x9f0cfd&&_0x9f0cfd[_0x197c32(0x14b)])try{_0x3bff00=JSON[_0x197c32(0x250)](_0x9f0cfd[_0x197c32(0x14b)]);}catch(_0x2da088){}_0x3bff00[_0x197c32(0x204)]!==_0xbdee47&&(_0x3bff00[_0x197c32(0x1a0)]={},_0x3bff00[_0x197c32(0x204)]=_0xbdee47);if(!_0x3bff00['history'][_0x12b00b])_0x3bff00[_0x197c32(0x1a0)][_0x12b00b]=new Array(0x18)['fill'](0x0);const _0x4f5763=new Date()[_0x197c32(0x228)]();if(_0x3bff00[_0x197c32(0x1a0)][_0x12b00b][_0x4f5763]<0x3c)_0x3bff00[_0x197c32(0x1a0)][_0x12b00b][_0x4f5763]++;await this[_0x197c32(0x1e4)](_0x4656e6,{'val':JSON[_0x197c32(0x24c)](_0x3bff00),'ack':!![]});}catch(_0x161252){this[_0x197c32(0x259)]['warn'](_0x197c32(0x1f1)+_0x161252[_0x197c32(0x25e)]);}}async[a0_0x333397(0x205)](_0x43dfdf){const _0x1642c4=a0_0x333397;if(typeof _0x43dfdf===_0x1642c4(0x121)&&_0x43dfdf[_0x1642c4(0x25e)]){if(_0x43dfdf[_0x1642c4(0x1af)]===_0x1642c4(0x1a3)){const _0x1e6069=_0x43dfdf[_0x1642c4(0x25e)]['date'],_0x1c71a7=utils['getAbsoluteDefaultDataDir'](),_0x1c0b19=path[_0x1642c4(0x1db)](_0x1c71a7,_0x1642c4(0x258),_0x1642c4(0x1a0),_0x1e6069+_0x1642c4(0x1e3));if(fs[_0x1642c4(0x1f2)](_0x1c0b19))try{const _0x506726=JSON[_0x1642c4(0x250)](fs[_0x1642c4(0x27e)](_0x1c0b19,_0x1642c4(0x190)));this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':!![],'data':_0x506726},_0x43dfdf[_0x1642c4(0x16f)]);}catch(_0x2f1280){this['sendTo'](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':![],'error':_0x1642c4(0x20a)},_0x43dfdf[_0x1642c4(0x16f)]);}else this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':![],'error':_0x1642c4(0x23c)},_0x43dfdf[_0x1642c4(0x16f)]);}else{if(_0x43dfdf[_0x1642c4(0x1af)]===_0x1642c4(0x181)){const _0x1378a8=this[_0x1642c4(0x28f)][_0x1642c4(0x276)];let _0x5e0891=new Array(0x30)[_0x1642c4(0x206)](0x0),_0x4b6304=Array[_0x1642c4(0x210)]({'length':0x30},()=>[]);try{const _0x26e025=await this['getStateAsync'](_0x1642c4(0x167));if(_0x26e025&&_0x26e025[_0x1642c4(0x14b)])_0x5e0891=JSON['parse'](_0x26e025[_0x1642c4(0x14b)]);const _0x231739=await this[_0x1642c4(0x277)](_0x1642c4(0x19d));if(_0x231739&&_0x231739[_0x1642c4(0x14b)])_0x4b6304=JSON[_0x1642c4(0x250)](_0x231739[_0x1642c4(0x14b)]);}catch(_0x3af0f8){}let _0x197b86=new Array(0x30)['fill'](0x0);try{const _0x2d27b0=new Date();_0x2d27b0['setDate'](_0x2d27b0[_0x1642c4(0x231)]()-0x1);const _0x59fb8e=_0x2d27b0[_0x1642c4(0x15a)]()[_0x1642c4(0x25b)]('T')[0x0],_0x5f2439=utils[_0x1642c4(0x14a)](),_0x5bb042=path[_0x1642c4(0x1db)](_0x5f2439,'cogni-living',_0x1642c4(0x1a0),_0x59fb8e+_0x1642c4(0x1e3));if(fs[_0x1642c4(0x1f2)](_0x5bb042)){const _0x320975=JSON[_0x1642c4(0x250)](fs[_0x1642c4(0x27e)](_0x5bb042,_0x1642c4(0x190)));if(_0x320975&&_0x320975[_0x1642c4(0x271)])_0x197b86=_0x320975[_0x1642c4(0x271)];}}catch(_0x522cd2){}let _0xb4ff2b={'today':{},'yesterday':{}};try{const _0x2afbeb=await this[_0x1642c4(0x277)](_0x1642c4(0x1a4));if(_0x2afbeb&&_0x2afbeb['val'])_0xb4ff2b=JSON[_0x1642c4(0x250)](_0x2afbeb[_0x1642c4(0x14b)]);}catch(_0xccd04d){}let _0x11873c=null;try{const _0x39cd1f=await this[_0x1642c4(0x277)](_0x1642c4(0x185));if(_0x39cd1f)_0x11873c=_0x39cd1f[_0x1642c4(0x14b)];}catch(_0x343138){}if(_0x11873c===undefined||_0x11873c===null){const _0x63def4=_0x5e0891['reduce']((_0x1a8e77,_0x3499a7)=>_0x1a8e77+_0x3499a7,0x0),_0x4a7a8c=Math[_0x1642c4(0x25c)](0x2,Math['max'](-0x2,(0x64-_0x63def4)/0x32));_0x11873c=_0x4a7a8c;}let _0x47e806=![],_0xaa930='',_0x2db6b1='',_0x256656='';try{const _0x173b2e=await this[_0x1642c4(0x277)](_0x1642c4(0x1ad));if(_0x173b2e&&_0x173b2e[_0x1642c4(0x14b)]){_0x47e806=!![];const _0x331c16=await this['getStateAsync'](_0x1642c4(0x186));_0xaa930=_0x331c16?_0x331c16[_0x1642c4(0x14b)]:'';const _0x3e8d2b=await this['getStateAsync'](_0x1642c4(0x11c));_0x2db6b1=_0x3e8d2b?_0x3e8d2b[_0x1642c4(0x14b)]:'';const _0x1fac87=await this[_0x1642c4(0x277)](_0x1642c4(0x1ab));_0x256656=_0x1fac87?_0x1fac87['val']:'';}}catch(_0x4a925f){}const _0x2695fe=await this['checkSolarCondition'](),_0x425671=(this['config'][_0x1642c4(0x144)]||[])['some'](_0x3427fe=>_0x3427fe[_0x1642c4(0x172)]),_0x569238=_0x2695fe&&_0x425671;let _0x4ab8ae='';try{const _0x340180=await this['getStateAsync']('system.presenceWho');if(_0x340180&&_0x340180['val'])_0x4ab8ae=_0x340180[_0x1642c4(0x14b)];}catch(_0x1db279){}this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':!![],'eventHistory':this[_0x1642c4(0x1d3)][_0x1642c4(0x1d2)](0x0,0x7d0),'stats':{'digestCount':_0x1378a8,'isPresent':this[_0x1642c4(0x123)],'hourlyActivity':_0x5e0891,'hourlyDetails':_0x4b6304,'yesterdayActivity':_0x197b86,'solarActive':_0x569238,'presenceWho':_0x4ab8ae,'roomStats':_0xb4ff2b,'activityTrend':_0x11873c,'modules':this[_0x1642c4(0x1a1)]},'automation':{'detected':_0x47e806,'description':_0xaa930,'targetId':_0x2db6b1,'targetValue':_0x256656}},_0x43dfdf['callback']);}else{if(_0x43dfdf[_0x1642c4(0x1af)]==='checkThermostats')try{const _0x19b7da=await automation[_0x1642c4(0x1a9)](this);this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':!![],'results':_0x19b7da},_0x43dfdf[_0x1642c4(0x16f)]);}catch(_0x592394){this[_0x1642c4(0x19e)](_0x43dfdf['from'],_0x43dfdf[_0x1642c4(0x1af)],{'success':![],'error':_0x592394[_0x1642c4(0x25e)]},_0x43dfdf['callback']);}else{if(_0x43dfdf['command']===_0x1642c4(0x12d))try{const _0x2bc566=await scanner[_0x1642c4(0x1f7)](this,_0x43dfdf['message']||{});this['sendTo'](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':!![],'devices':_0x2bc566},_0x43dfdf[_0x1642c4(0x16f)]);}catch(_0x351413){}else{if(_0x43dfdf[_0x1642c4(0x1af)]===_0x1642c4(0x28c)){const _0x256854=await this['getForeignObjectsAsync'](_0x1642c4(0x137),_0x1642c4(0x1d7)),_0x2a6577=[];if(_0x256854)for(const _0x5f5da8 in _0x256854){let _0x5897cc=_0x256854[_0x5f5da8][_0x1642c4(0x1f0)][_0x1642c4(0x286)];if(_0x5897cc&&typeof _0x5897cc===_0x1642c4(0x121))_0x5897cc=_0x5897cc['de']||_0x5897cc['en']||Object['values'](_0x5897cc)[0x0]||JSON[_0x1642c4(0x24c)](_0x5897cc);_0x2a6577['push']({'id':_0x5f5da8,'name':String(_0x5897cc||_0x5f5da8)});}const _0x11c463=await this['getForeignObjectsAsync'](_0x1642c4(0x1be),_0x1642c4(0x1d7)),_0x470c1b=[];if(_0x11c463)for(const _0x2442f3 in _0x11c463){let _0x3f6fc8=_0x11c463[_0x2442f3][_0x1642c4(0x1f0)][_0x1642c4(0x286)];if(_0x3f6fc8&&typeof _0x3f6fc8==='object')_0x3f6fc8=_0x3f6fc8['de']||_0x3f6fc8['en']||Object['values'](_0x3f6fc8)[0x0]||JSON[_0x1642c4(0x24c)](_0x3f6fc8);_0x470c1b['push'](String(_0x3f6fc8||_0x2442f3['split']('.')[_0x1642c4(0x1f9)]()));}this['sendTo'](_0x43dfdf['from'],_0x43dfdf['command'],{'success':!![],'enums':_0x2a6577,'rooms':_0x470c1b},_0x43dfdf[_0x1642c4(0x16f)]);}else{if(_0x43dfdf[_0x1642c4(0x1af)]==='getCalendarNames')try{const _0x249c0d=await this[_0x1642c4(0x163)](_0x1642c4(0x242),'instance',{'startkey':'system.adapter.ical.','endkey':_0x1642c4(0x188)}),_0x3f837c=new Set();if(_0x249c0d&&_0x249c0d['rows'])for(const _0x4cd055 of _0x249c0d[_0x1642c4(0x1d5)]){const _0x595a23=_0x4cd055['id'][_0x1642c4(0x1aa)]('system.adapter.',''),_0x11420d=await this['getForeignStateAsync'](_0x595a23+_0x1642c4(0x1de));let _0x126f2d=![];if(_0x11420d&&_0x11420d[_0x1642c4(0x14b)]){const _0x32a670=typeof _0x11420d['val']===_0x1642c4(0x22d)?JSON[_0x1642c4(0x250)](_0x11420d[_0x1642c4(0x14b)]):_0x11420d['val'];Array[_0x1642c4(0x225)](_0x32a670)&&_0x32a670['forEach'](_0x3ef344=>{const _0x2f4e0c=_0x1642c4;_0x3ef344[_0x2f4e0c(0x1ea)]&&(_0x3f837c[_0x2f4e0c(0x131)](_0x3ef344[_0x2f4e0c(0x1ea)]),_0x126f2d=!![]);});}!_0x126f2d&&_0x3f837c[_0x1642c4(0x131)](_0x595a23);}const _0x39cb2d=Array[_0x1642c4(0x210)](_0x3f837c);if(_0x39cb2d['length']===0x0)_0x39cb2d[_0x1642c4(0x1ca)]('Standard');this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf['command'],{'success':!![],'names':_0x39cb2d},_0x43dfdf[_0x1642c4(0x16f)]);}catch(_0x20a128){this[_0x1642c4(0x19e)](_0x43dfdf['from'],_0x43dfdf[_0x1642c4(0x1af)],{'success':![],'error':_0x1642c4(0x1cd)+_0x20a128['message']},_0x43dfdf[_0x1642c4(0x16f)]);}else{if(_0x43dfdf[_0x1642c4(0x1af)]===_0x1642c4(0x254))try{await automation['updateSchedulePreview'](this),this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':!![]},_0x43dfdf['callback']);}catch(_0x205db2){this['log'][_0x1642c4(0x1a7)](_0x1642c4(0x11b)+_0x205db2[_0x1642c4(0x25e)]),this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':![],'error':_0x205db2['message']},_0x43dfdf[_0x1642c4(0x16f)]);}else{if(_0x43dfdf['command']===_0x1642c4(0x1e2))try{const _0x128f7f=_0x43dfdf[_0x1642c4(0x25e)][_0x1642c4(0x278)];if(!_0x128f7f||!Array['isArray'](_0x128f7f))throw new Error(_0x1642c4(0x218));const _0x1f16b0=await this[_0x1642c4(0x277)]('analysis.topology.structure');if(_0x1f16b0&&_0x1f16b0[_0x1642c4(0x14b)]){const _0x1c5834=JSON[_0x1642c4(0x250)](_0x1f16b0[_0x1642c4(0x14b)]);_0x1c5834['matrix']=_0x128f7f,_0x1c5834[_0x1642c4(0x195)]=Date['now'](),await this['setStateAsync'](_0x1642c4(0x19f),{'val':JSON[_0x1642c4(0x24c)](_0x1c5834),'ack':!![]}),this[_0x1642c4(0x259)][_0x1642c4(0x28e)](_0x1642c4(0x142)),this['sendTo'](_0x43dfdf['from'],_0x43dfdf[_0x1642c4(0x1af)],{'success':!![]},_0x43dfdf['callback']);}else throw new Error('No\x20topology\x20data\x20found');}catch(_0x4fc1c2){this[_0x1642c4(0x259)][_0x1642c4(0x1a7)](_0x1642c4(0x264)+_0x4fc1c2[_0x1642c4(0x25e)]),this['sendTo'](_0x43dfdf['from'],_0x43dfdf['command'],{'success':![],'error':_0x4fc1c2['message']},_0x43dfdf[_0x1642c4(0x16f)]);}else{if(_0x43dfdf['command']===_0x1642c4(0x165))try{const _0x46f86b=_0x43dfdf[_0x1642c4(0x25e)]['command'],_0x50a080=_0x43dfdf[_0x1642c4(0x25e)];this[_0x1642c4(0x259)]['debug'](_0x1642c4(0x151)+_0x46f86b),pythonBridge[_0x1642c4(0x154)](this,_0x46f86b,_0x50a080,_0x598ceb=>{const _0x5d451f=_0x1642c4;this[_0x5d451f(0x19e)](_0x43dfdf[_0x5d451f(0x210)],_0x43dfdf[_0x5d451f(0x1af)],_0x598ceb,_0x43dfdf[_0x5d451f(0x16f)]);});}catch(_0x18e092){this['log'][_0x1642c4(0x1a7)](_0x1642c4(0x22e)+_0x18e092[_0x1642c4(0x25e)]),this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'type':_0x1642c4(0x138),'payload':_0x18e092[_0x1642c4(0x25e)]},_0x43dfdf['callback']);}else{if(_0x43dfdf[_0x1642c4(0x1af)]===_0x1642c4(0x18a))try{const _0xf989e2=_0x43dfdf[_0x1642c4(0x25e)]?_0x43dfdf[_0x1642c4(0x25e)][_0x1642c4(0x11a)]:'';if(!_0xf989e2)throw new Error(_0x1642c4(0x1bd));const _0x1f5a73=new GoogleGenerativeAI(_0xf989e2),_0x1d17ba=_0x1f5a73[_0x1642c4(0x16d)]({'model':GEMINI_MODEL}),_0x2623d9=await _0x1d17ba[_0x1642c4(0x166)](_0x1642c4(0x127)),_0x37fdbe=await _0x2623d9[_0x1642c4(0x269)],_0x2068d5=_0x37fdbe['text']();this['sendTo'](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':!![],'message':_0x1642c4(0x26e)+_0x2068d5[_0x1642c4(0x1da)](0x0,0x14)+_0x1642c4(0x203)},_0x43dfdf[_0x1642c4(0x16f)]);}catch(_0x530c4c){this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf[_0x1642c4(0x1af)],{'success':![],'message':_0x530c4c['message']},_0x43dfdf[_0x1642c4(0x16f)]);}else{if(_0x43dfdf['command']===_0x1642c4(0x24f))try{const _0x1868db=await this['checkSolarCondition'](),_0x512972=await this['getObjectViewAsync'](_0x1642c4(0x242),_0x1642c4(0x289),{'startkey':_0x1642c4(0x214),'endkey':_0x1642c4(0x188)}),_0x40a7c5=_0x512972&&_0x512972[_0x1642c4(0x1d5)]?_0x512972[_0x1642c4(0x1d5)][_0x1642c4(0x276)]:0x0;this[_0x1642c4(0x19e)](_0x43dfdf[_0x1642c4(0x210)],_0x43dfdf['command'],{'success':!![],'weather':_0x1642c4(0x240)+_0x1868db+_0x1642c4(0x145)+(this[_0x1642c4(0x19a)][this[_0x1642c4(0x118)][_0x1642c4(0x179)]]||'?')+'¬∞C','calendar':_0x40a7c5+_0x1642c4(0x13a)},_0x43dfdf['callback']);}catch(_0x13f63b){this['sendTo'](_0x43dfdf['from'],_0x43dfdf[_0x1642c4(0x1af)],{'success':![]},_0x43dfdf['callback']);}}}}}}}}}}}}}[a0_0x333397(0x160)](){const _0x2e55e8=a0_0x333397;if(!this[_0x2e55e8(0x1a1)][_0x2e55e8(0x11f)])return;this['log']['debug'](_0x2e55e8(0x1a8));try{const _0x2e92cd=this['rawEventLog']||[];pythonBridge[_0x2e55e8(0x154)](this,_0x2e55e8(0x1d4),{'events':_0x2e92cd});}catch(_0xb8ee12){this[_0x2e55e8(0x259)][_0x2e55e8(0x1a7)](_0x2e55e8(0x27f));}}async[a0_0x333397(0x1ba)](_0x4538c0,_0x46e6d2){const _0x24894c=a0_0x333397;if(!_0x46e6d2||this[_0x24894c(0x1fd)])return;if(_0x4538c0[_0x24894c(0x24d)](_0x24894c(0x119))&&_0x4538c0[_0x24894c(0x262)]('communicate.request')&&_0x46e6d2[_0x24894c(0x14b)])return;if(this['config']['infrasoundEnabled']&&_0x4538c0===this['config'][_0x24894c(0x18f)]&&this[_0x24894c(0x1a1)][_0x24894c(0x224)]){this[_0x24894c(0x272)](_0x46e6d2[_0x24894c(0x14b)]);return;}if(_0x46e6d2['ack']&&_0x4538c0[_0x24894c(0x262)]('pulse'))return;if(_0x4538c0===this[_0x24894c(0x15c)]+'.system.mode'){if(_0x46e6d2[_0x24894c(0x14b)]&&Object[_0x24894c(0x20d)](setup[_0x24894c(0x1f5)])['includes'](_0x46e6d2['val'])){this[_0x24894c(0x189)]=_0x46e6d2['val'];if(_0x46e6d2[_0x24894c(0x14b)]===setup['SYSTEM_MODES']['VACATION'])await recorder[_0x24894c(0x182)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x24894c(0x1e5)]){let _0x4e38bf=![],_0x42ba9d=0x0,_0xf7f18f='manual';if(this[_0x24894c(0x189)]===_0x24894c(0x155))_0x4e38bf=!![],_0x42ba9d=0x168,_0xf7f18f=_0x24894c(0x1d9);else this['currentSystemMode']==='guest'&&(_0x4e38bf=!![],_0x42ba9d=0x5a0,_0xf7f18f=_0x24894c(0x248));pythonBridge[_0x24894c(0x154)](this,_0x24894c(0x157),{'active':_0x4e38bf,'duration':_0x42ba9d,'label':_0xf7f18f}),await this[_0x24894c(0x1e4)](_0x24894c(0x243),{'val':JSON[_0x24894c(0x24c)]({'active':_0x4e38bf,'label':_0xf7f18f,'timestamp':Date[_0x24894c(0x18e)]()}),'ack':!![]});}}if(!_0x46e6d2[_0x24894c(0x12a)])this[_0x24894c(0x208)](_0x4538c0,{'val':this[_0x24894c(0x189)],'ack':!![]});return;}if(_0x4538c0[_0x24894c(0x262)]('analysis.energy.warmupSources')&&_0x46e6d2[_0x24894c(0x12a)])this['protectAiMemory'](_0x46e6d2['val']);if(_0x4538c0[_0x24894c(0x262)](_0x24894c(0x17f))&&_0x46e6d2[_0x24894c(0x12a)]&&this['activeModules'][_0x24894c(0x13d)])automation[_0x24894c(0x122)](this);if(!_0x46e6d2[_0x24894c(0x12a)]){if(_0x4538c0[_0x24894c(0x24d)]('analysis.trigger')&&_0x46e6d2['val']){this[_0x24894c(0x208)](_0x4538c0,{'val':![],'ack':!![]}),aiAgent[_0x24894c(0x21c)](this);return;}if(_0x4538c0[_0x24894c(0x24d)](_0x24894c(0x25d))&&_0x46e6d2['val']){this[_0x24894c(0x208)](_0x4538c0,{'val':![],'ack':!![]});if(this[_0x24894c(0x1e5)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x4538c0[_0x24894c(0x24d)](_0x24894c(0x261))&&_0x46e6d2[_0x24894c(0x14b)]){this[_0x24894c(0x208)](_0x4538c0,{'val':![],'ack':!![]}),aiAgent[_0x24894c(0x11d)](this);return;}if(_0x4538c0[_0x24894c(0x24d)]('automation.triggerAction')&&_0x46e6d2[_0x24894c(0x14b)]){this[_0x24894c(0x208)](_0x4538c0,{'val':![],'ack':!![]}),aiAgent[_0x24894c(0x1f6)](this);return;}if(_0x4538c0[_0x24894c(0x24d)]('analysis.training.triggerSecurity')&&_0x46e6d2[_0x24894c(0x14b)]){this[_0x24894c(0x208)](_0x4538c0,{'val':![],'ack':!![]});if(this[_0x24894c(0x1e5)])try{const _0x4a2409=await this[_0x24894c(0x277)](_0x24894c(0x15b));if(_0x4a2409&&_0x4a2409['val']){const _0x5d9be9=JSON['parse'](_0x4a2409[_0x24894c(0x14b)]);this['setStateAsync'](_0x24894c(0x23d),{'val':_0x24894c(0x1e8),'ack':!![]}),pythonBridge[_0x24894c(0x154)](this,_0x24894c(0x222),{'sequences':_0x5d9be9});}}catch(_0x41cd8d){}return;}if(_0x4538c0[_0x24894c(0x24d)](_0x24894c(0x120))&&_0x46e6d2[_0x24894c(0x14b)]){this['setState'](_0x4538c0,{'val':![],'ack':!![]});try{aiAgent[_0x24894c(0x1c0)](this,_0x24894c(0x249)),setTimeout(()=>aiAgent[_0x24894c(0x1c0)](this,'DAY'),0x2ee0);if(this['isProVersion']){this[_0x24894c(0x160)]();const _0x166c69=await this[_0x24894c(0x277)]('LTM.dailyDigests');if(_0x166c69&&_0x166c69[_0x24894c(0x14b)])pythonBridge['send'](this,_0x24894c(0x1b0),{'digests':JSON[_0x24894c(0x250)](_0x166c69[_0x24894c(0x14b)])});}}catch(_0x3687b4){this[_0x24894c(0x259)][_0x24894c(0x1a7)](_0x24894c(0x1ae)+_0x3687b4[_0x24894c(0x25e)]);}return;}if(_0x4538c0[_0x24894c(0x24d)](_0x24894c(0x247))&&_0x46e6d2[_0x24894c(0x14b)]){this[_0x24894c(0x208)](_0x4538c0,{'val':![],'ack':!![]}),await this[_0x24894c(0x191)]();return;}if(_0x4538c0['includes']('analysis.training.triggerComfort')&&_0x46e6d2[_0x24894c(0x14b)]){this[_0x24894c(0x208)](_0x4538c0,{'val':![],'ack':!![]});if(this[_0x24894c(0x1e5)])try{const _0x3f4033=await this[_0x24894c(0x277)](_0x24894c(0x15f));if(_0x3f4033&&_0x3f4033[_0x24894c(0x14b)]){const _0x320f72={};if(this['config']['devices'])this['config'][_0x24894c(0x144)]['forEach'](_0x16a16f=>{const _0x2df89b=_0x24894c;if(_0x16a16f['id']&&_0x16a16f[_0x2df89b(0x201)])_0x320f72[_0x16a16f['id']]=_0x16a16f['type'];});pythonBridge[_0x24894c(0x154)](this,'TRAIN_COMFORT',{'events':JSON[_0x24894c(0x250)](_0x3f4033[_0x24894c(0x14b)]),'deviceMap':_0x320f72});}}catch(_0x4c926d){}return;}if(_0x4538c0['includes']('analysis.training.triggerTopology')&&_0x46e6d2['val']){this['setState'](_0x4538c0,{'val':![],'ack':!![]}),topology[_0x24894c(0x158)](this);if(this[_0x24894c(0x1e5)])try{const _0x50eff3=await this[_0x24894c(0x277)](_0x24894c(0x15b));if(_0x50eff3&&_0x50eff3[_0x24894c(0x14b)])pythonBridge[_0x24894c(0x154)](this,_0x24894c(0x27b),{'sequences':JSON[_0x24894c(0x250)](_0x50eff3[_0x24894c(0x14b)])});}catch(_0x1a47f3){}return;}}const _0x1d93e4=(this[_0x24894c(0x118)]['devices']||[])[_0x24894c(0x267)](_0x4e0f77=>_0x4e0f77['id']===_0x4538c0);if(_0x1d93e4){const _0x1fefc8=await recorder[_0x24894c(0x26b)](this,_0x4538c0,_0x46e6d2,_0x1d93e4);_0x1fefc8&&this['setState'](_0x24894c(0x257),{'val':Date['now'](),'ack':!![]});_0x1fefc8&&_0x1fefc8['type']===_0x24894c(0x164)&&_0x1fefc8[_0x24894c(0x176)]&&this[_0x24894c(0x1e5)]&&deadMan[_0x24894c(0x1b9)](this,_0x1fefc8[_0x24894c(0x176)]);_0x46e6d2[_0x24894c(0x14b)]&&(_0x46e6d2[_0x24894c(0x14b)]===!![]||_0x46e6d2[_0x24894c(0x14b)]===0x1||String(_0x46e6d2[_0x24894c(0x14b)])[_0x24894c(0x24b)]()===_0x24894c(0x223))&&(_0x1d93e4[_0x24894c(0x201)]&&(_0x1d93e4[_0x24894c(0x201)]['includes']('window')||_0x1d93e4[_0x24894c(0x201)]['includes'](_0x24894c(0x14f)))&&this[_0x24894c(0x20c)](_0x1d93e4));if(_0x1d93e4[_0x24894c(0x201)]===_0x24894c(0x198)||_0x1d93e4[_0x24894c(0x201)]===_0x24894c(0x12b)){if(this[_0x24894c(0x1a1)][_0x24894c(0x13d)])automation[_0x24894c(0x217)](this);}}}async['protectAiMemory'](_0x423118){const _0x2c5f42=a0_0x333397;if(!this['memoryCache']||Date['now']()-this[_0x2c5f42(0x280)]>0x493e0)return;try{const _0x3f2b0f=JSON[_0x2c5f42(0x250)](_0x423118),_0x786aa8=this[_0x2c5f42(0x18b)][_0x2c5f42(0x26d)];let _0x143b69=![];for(const _0x23a17a in _0x786aa8){if(_0x786aa8[_0x23a17a][_0x2c5f42(0x24d)]('AI')&&_0x3f2b0f[_0x23a17a]&&!_0x3f2b0f[_0x23a17a][_0x2c5f42(0x24d)]('AI')){_0x143b69=!![];break;}}_0x143b69&&(await this['setStateAsync']('analysis.energy.warmupTimes',{'val':JSON['stringify'](this[_0x2c5f42(0x18b)][_0x2c5f42(0x275)]),'ack':!![]}),await this[_0x2c5f42(0x1e4)](_0x2c5f42(0x274),{'val':JSON['stringify'](this['memoryCache']['sources']),'ack':!![]}));}catch(_0x1d211b){}}async[a0_0x333397(0x153)](){const _0x27457f=a0_0x333397;try{const _0x3853b0=await this[_0x27457f(0x277)](setup[_0x27457f(0x17c)]);if(_0x3853b0&&_0x3853b0['val'])this[_0x27457f(0x189)]=_0x3853b0[_0x27457f(0x14b)];}catch(_0x278806){this[_0x27457f(0x189)]=setup[_0x27457f(0x1f5)][_0x27457f(0x169)];}}async[a0_0x333397(0x13c)](){const _0x58fc46=a0_0x333397,_0x3ff97b=this[_0x58fc46(0x118)][_0x58fc46(0x28a)]||[];if(_0x3ff97b[_0x58fc46(0x276)]===0x0)return![];const _0x2ac429=[],_0x261f8b=Date['now'](),_0x531b95=0x5*0x3c*0x3e8;for(const _0x1209ea of _0x3ff97b){try{let _0x377072=![];try{const _0x4c1319=await this[_0x58fc46(0x213)](_0x1209ea+_0x58fc46(0x16c));if(_0x4c1319&&_0x4c1319[_0x58fc46(0x14b)]===!![])_0x377072=!![];}catch(_0xe107ec){}if(!_0x377072)try{const _0x3b995d=await this[_0x58fc46(0x213)](_0x1209ea+'.last_seen');if(_0x3b995d&&_0x3b995d['ts']){const _0xba6470=_0x261f8b-_0x3b995d['ts'];if(_0xba6470<_0x531b95)_0x377072=!![];}}catch(_0x208a46){}if(!_0x377072)try{const _0x2ce247=await this[_0x58fc46(0x213)](_0x1209ea+_0x58fc46(0x1f4));if(_0x2ce247&&typeof _0x2ce247[_0x58fc46(0x14b)]==='number'&&_0x2ce247[_0x58fc46(0x14b)]>0x0)_0x377072=!![];}catch(_0x3856ec){}if(!_0x377072)try{const _0x29a8fd=await this[_0x58fc46(0x213)](_0x1209ea);if(_0x29a8fd){const _0x26aa06=_0x261f8b-(_0x29a8fd['ts']||0x0);_0x26aa06<_0x531b95&&(_0x29a8fd['val']===!![]||_0x29a8fd[_0x58fc46(0x14b)]===_0x58fc46(0x282)||_0x29a8fd[_0x58fc46(0x14b)]===0x1)&&(_0x377072=!![]);}}catch(_0x60beab){}if(_0x377072){const _0x28bb48=_0x1209ea[_0x58fc46(0x25b)]('.'),_0x16afa2=_0x28bb48[_0x28bb48[_0x58fc46(0x276)]-0x1]||_0x1209ea;_0x2ac429[_0x58fc46(0x1ca)](_0x16afa2);}}catch(_0x5ca61c){this[_0x58fc46(0x259)][_0x58fc46(0x1a7)]('checkWifiPresence:\x20Error\x20checking\x20'+_0x1209ea+':\x20'+_0x5ca61c[_0x58fc46(0x25e)]);}}const _0x418e1e=_0x2ac429[_0x58fc46(0x276)]>0x0?_0x2ac429[_0x58fc46(0x1db)](',\x20'):_0x58fc46(0x1fa);return await this[_0x58fc46(0x1e4)](_0x58fc46(0x21a),{'val':_0x418e1e,'ack':!![]}),_0x2ac429['length']>0x0;}async[a0_0x333397(0x20f)](){const _0x462dae=a0_0x333397;await aiAgent[_0x462dae(0x21c)](this);this[_0x462dae(0x1a1)][_0x462dae(0x11f)]&&(this['updateHealthVector'](),this['triggerGaitAnalysis']());if(this[_0x462dae(0x1a1)]['energy'])this[_0x462dae(0x191)]();}async[a0_0x333397(0x200)](){const _0x3f6d5e=a0_0x333397,_0x4e1fea=[_0x3f6d5e(0x1fb),_0x3f6d5e(0x283),'daswetter.0'],_0x235579=[_0x3f6d5e(0x1c1),_0x3f6d5e(0x279),_0x3f6d5e(0x126)];for(const _0x1259b3 of _0x4e1fea){for(const _0x3c0784 of _0x235579){try{const _0x41d7f4=_0x1259b3+'.'+_0x3c0784,_0x141b8a=await this[_0x3f6d5e(0x213)](_0x41d7f4);if(_0x141b8a&&_0x141b8a[_0x3f6d5e(0x14b)]){const _0x1841f9=String(_0x141b8a[_0x3f6d5e(0x14b)])[_0x3f6d5e(0x24b)]();if(_0x1841f9[_0x3f6d5e(0x24d)](_0x3f6d5e(0x1d6))||_0x1841f9['includes']('heiter')||_0x1841f9[_0x3f6d5e(0x24d)](_0x3f6d5e(0x1b1))||_0x1841f9['includes'](_0x3f6d5e(0x25a))||_0x1841f9['includes']('clear'))return this[_0x3f6d5e(0x259)][_0x3f6d5e(0x28e)](_0x3f6d5e(0x1c9)+_0x41d7f4),!![];}}catch(_0x2c6547){}}}return![];}['triggerGaitAnalysis'](){const _0x1fa8fc=a0_0x333397;if(!this[_0x1fa8fc(0x1e5)])return;try{this[_0x1fa8fc(0x277)]('LTM.trainingData.sequences',(_0x5b325a,_0x17197e)=>{const _0xfd31fa=_0x1fa8fc;if(_0x5b325a||!_0x17197e||!_0x17197e[_0xfd31fa(0x14b)])return;try{const _0x2aa48b=JSON[_0xfd31fa(0x250)](_0x17197e[_0xfd31fa(0x14b)]);if(!_0x2aa48b||_0x2aa48b[_0xfd31fa(0x276)]===0x0)return;pythonBridge['send'](this,'ANALYZE_GAIT',{'sequences':_0x2aa48b}),this[_0xfd31fa(0x259)][_0xfd31fa(0x28e)](_0xfd31fa(0x13b)+_0x2aa48b[_0xfd31fa(0x276)]+_0xfd31fa(0x180));}catch(_0x221923){this[_0xfd31fa(0x259)][_0xfd31fa(0x1a7)]('triggerGaitAnalysis\x20parse\x20error:\x20'+_0x221923[_0xfd31fa(0x25e)]);}});}catch(_0x3a8166){this[_0x1fa8fc(0x259)][_0x1fa8fc(0x1a7)](_0x1fa8fc(0x1e1)+_0x3a8166[_0x1fa8fc(0x25e)]);}}async[a0_0x333397(0x191)](){const _0xa86203=a0_0x333397;if(!this['isProVersion']||!this[_0xa86203(0x1a1)]['energy'])return;try{const _0x5b7017={},_0x1fb4ee={},_0x67cfd5=this[_0xa86203(0x118)][_0xa86203(0x144)]||[];for(const _0x25690f of _0x67cfd5){if((_0x25690f[_0xa86203(0x201)]===_0xa86203(0x198)||_0x25690f[_0xa86203(0x201)]===_0xa86203(0x12b))&&_0x25690f[_0xa86203(0x176)])try{const _0x42d725=await this[_0xa86203(0x213)](_0x25690f['id']);_0x42d725&&typeof _0x42d725['val']==='number'&&(_0x5b7017[_0x25690f[_0xa86203(0x176)]]=_0x42d725[_0xa86203(0x14b)],_0x1fb4ee[_0x25690f[_0xa86203(0x176)]]=_0x25690f[_0xa86203(0x172)]||![]);}catch(_0x2017e2){}}let _0x26ccfd=0xa;if(this['config'][_0xa86203(0x1cf)])try{const _0x337677=await this[_0xa86203(0x213)](this[_0xa86203(0x118)][_0xa86203(0x1cf)]);if(_0x337677&&typeof _0x337677[_0xa86203(0x14b)]===_0xa86203(0x1ee))_0x26ccfd=_0x337677[_0xa86203(0x14b)];}catch(_0x41ba93){}const _0x6dfc66=await this[_0xa86203(0x200)]();let _0x26a85a={};try{const _0x56b4be=await this[_0xa86203(0x277)](_0xa86203(0x135));if(_0x56b4be&&_0x56b4be['val'])_0x26a85a=JSON[_0xa86203(0x250)](_0x56b4be['val']);}catch(_0x129894){}pythonBridge[_0xa86203(0x154)](this,_0xa86203(0x130),{'current_temps':_0x5b7017,'t_out':_0x26ccfd,'is_sunny':_0x6dfc66,'solar_flags':_0x1fb4ee,'warmup_targets':_0x26a85a}),this[_0xa86203(0x259)][_0xa86203(0x124)]('üîÆ\x20Energy\x20Prediction\x20triggered\x20('+Object[_0xa86203(0x1f3)](_0x5b7017)[_0xa86203(0x276)]+'\x20rooms)');}catch(_0x5321b4){this[_0xa86203(0x259)][_0xa86203(0x1a7)](_0xa86203(0x23f)+_0x5321b4[_0xa86203(0x25e)]);}}[a0_0x333397(0x1dd)](){const _0x4b7b14=a0_0x333397;if(!this[_0x4b7b14(0x253)]||this['rawEventLog'][_0x4b7b14(0x276)]===0x0)return;const _0x277ae0=new Array(0x30)[_0x4b7b14(0x206)](0x0),_0x44a44e=Array['from']({'length':0x30},()=>[]),_0x340873=new Date()['setHours'](0x0,0x0,0x0,0x0);this[_0x4b7b14(0x253)]['forEach'](_0x24cfc8=>{const _0x4ee5aa=_0x4b7b14,_0x54e117=new Date(_0x24cfc8[_0x4ee5aa(0x27a)]);if(_0x54e117[_0x4ee5aa(0x288)]()>=_0x340873){const _0x4b7f57=_0x54e117['getHours'](),_0x46c0c0=_0x54e117[_0x4ee5aa(0x234)](),_0x51325f=_0x4b7f57*0x2+Math['floor'](_0x46c0c0/0x1e);_0x51325f>=0x0&&_0x51325f<0x30&&(_0x277ae0[_0x51325f]++,_0x44a44e[_0x51325f][_0x4ee5aa(0x1ca)]({'time':_0x54e117[_0x4ee5aa(0x260)]('de-DE',{'hour':'2-digit','minute':'2-digit'}),'location':_0x24cfc8[_0x4ee5aa(0x176)]||_0x4ee5aa(0x227),'type':_0x24cfc8['type']||_0x4ee5aa(0x194)}));}}),this[_0x4b7b14(0x1e4)](_0x4b7b14(0x167),{'val':JSON[_0x4b7b14(0x24c)](_0x277ae0),'ack':!![]}),this[_0x4b7b14(0x1e4)](_0x4b7b14(0x19d),{'val':JSON[_0x4b7b14(0x24c)](_0x44a44e),'ack':!![]});}async[a0_0x333397(0x272)](_0x16f7bf){const _0x14a744=a0_0x333397;if(!this['config'][_0x14a744(0x255)]||typeof _0x16f7bf!==_0x14a744(0x1ee))return;const _0x40849f=this[_0x14a744(0x118)][_0x14a744(0x263)]||0.04;this[_0x14a744(0x1bc)][_0x14a744(0x1ca)]({'timestamp':Date['now'](),'value':_0x16f7bf}),this[_0x14a744(0x1bc)][_0x14a744(0x276)]>0x64&&this[_0x14a744(0x1bc)][_0x14a744(0x1ff)](),_0x16f7bf>_0x40849f&&!this[_0x14a744(0x212)]&&(this[_0x14a744(0x212)]=!![],this[_0x14a744(0x259)]['warn'](_0x14a744(0x22a)+_0x16f7bf[_0x14a744(0x12c)](0x4)+_0x14a744(0x244)+_0x40849f+'\x20(Threshold)'),await this[_0x14a744(0x246)](_0x16f7bf,'threshold_exceeded'),setTimeout(()=>{const _0x2c7e4e=_0x14a744;this[_0x2c7e4e(0x212)]=![];},0x5*0x3c*0x3e8));}async[a0_0x333397(0x246)](_0x1c23c9,_0x3b9680){const _0x39d479=a0_0x333397;if(!this['isPresent']){const _0x1dc77e=this[_0x39d479(0x1d3)][_0x39d479(0x1d2)](0x0,0xa),_0x5e0c52=_0x1dc77e[_0x39d479(0x232)](_0x55831e=>new Date(_0x55831e[_0x39d479(0x27a)])[_0x39d479(0x260)](_0x39d479(0x17d))+_0x39d479(0x219)+(_0x55831e['location']||_0x39d479(0x268))+':\x20'+_0x55831e[_0x39d479(0x286)])[_0x39d479(0x1db)]('\x0a');this[_0x39d479(0x259)][_0x39d479(0x1a7)](_0x39d479(0x139)+_0x1c23c9[_0x39d479(0x12c)](0x4)+_0x39d479(0x187)+_0x5e0c52);if(this[_0x39d479(0x118)][_0x39d479(0x16a)])try{const _0x25c7ad=await this[_0x39d479(0x213)](this[_0x39d479(0x118)][_0x39d479(0x16a)]);_0x25c7ad&&_0x25c7ad[_0x39d479(0x14b)]===!![]&&(await this['setStateAsync'](_0x39d479(0x143),{'val':JSON[_0x39d479(0x24c)]({'timestamp':Date[_0x39d479(0x18e)](),'pressure':_0x1c23c9[_0x39d479(0x12c)](0x4),'eventType':_0x3b9680,'recentEvents':_0x1dc77e[_0x39d479(0x1d2)](0x0,0x3)}),'ack':!![]}),this[_0x39d479(0x259)]['error'](_0x39d479(0x14c)));}catch(_0x82d6f6){}}else this[_0x39d479(0x259)]['debug'](_0x39d479(0x150)+_0x1c23c9[_0x39d479(0x12c)](0x4)+_0x39d479(0x1cb));}async[a0_0x333397(0x20c)](_0x173a71){const _0x4238d3=a0_0x333397;if(!_0x173a71||!_0x173a71[_0x4238d3(0x176)])return;try{const _0x2d6dd2=(this[_0x4238d3(0x118)][_0x4238d3(0x144)]||[])[_0x4238d3(0x171)](_0x3bc10d=>_0x3bc10d['location']===_0x173a71[_0x4238d3(0x176)]&&(_0x3bc10d[_0x4238d3(0x201)]===_0x4238d3(0x198)||_0x3bc10d[_0x4238d3(0x201)]===_0x4238d3(0x12b)));if(_0x2d6dd2[_0x4238d3(0x276)]===0x0)return;const _0x458f7f=await this['getForeignStateAsync'](_0x2d6dd2[0x0]['id']);if(!_0x458f7f||typeof _0x458f7f[_0x4238d3(0x14b)]!=='number')return;const _0x56f929=_0x458f7f[_0x4238d3(0x14b)];let _0x1da418=null;if(this[_0x4238d3(0x118)][_0x4238d3(0x1cf)]){const _0x2422ca=await this[_0x4238d3(0x213)](this['config'][_0x4238d3(0x1cf)]);_0x2422ca&&typeof _0x2422ca[_0x4238d3(0x14b)]===_0x4238d3(0x1ee)&&(_0x1da418=_0x2422ca['val']);}if(_0x1da418!==null){const _0x151408=Math[_0x4238d3(0x12f)](_0x56f929-_0x1da418);_0x151408>0x3&&(this[_0x4238d3(0x259)][_0x4238d3(0x28e)](_0x4238d3(0x12e)+_0x173a71[_0x4238d3(0x176)]+_0x4238d3(0x1b6)+_0x151408[_0x4238d3(0x12c)](0x1)+_0x4238d3(0x13f)+_0x56f929+_0x4238d3(0x193)+_0x1da418+_0x4238d3(0x148)),await this[_0x4238d3(0x1e4)](_0x4238d3(0x27c),{'val':JSON[_0x4238d3(0x24c)]({'room':_0x173a71[_0x4238d3(0x176)],'timestamp':Date[_0x4238d3(0x18e)](),'tempDiff':_0x151408[_0x4238d3(0x12c)](0x1),'recommendation':_0x151408>0x5?_0x4238d3(0x23b):_0x4238d3(0x1dc)}),'ack':!![]}));}}catch(_0x2b9777){this[_0x4238d3(0x259)][_0x4238d3(0x1a7)](_0x4238d3(0x174)+_0x2b9777[_0x4238d3(0x25e)]);}}async[a0_0x333397(0x1c4)](_0x4e751d){const _0x51b6c4=a0_0x333397;if(!_0x4e751d||typeof _0x4e751d!=='object')return;const _0x57f19a={'timestamp':_0x4e751d[_0x51b6c4(0x27a)]||Date[_0x51b6c4(0x18e)](),'id':_0x4e751d['id']||Date[_0x51b6c4(0x18e)]()['toString'](),'name':_0x4e751d[_0x51b6c4(0x286)]||'Manual\x20Event','type':_0x4e751d['type']||'custom','location':_0x4e751d['location']||_0x51b6c4(0x268),'value':_0x4e751d[_0x51b6c4(0x161)]||null};this[_0x51b6c4(0x1d3)][_0x51b6c4(0x18d)](_0x57f19a);if(this[_0x51b6c4(0x1d3)][_0x51b6c4(0x276)]>0x1388)this[_0x51b6c4(0x1d3)][_0x51b6c4(0x1f9)]();await this[_0x51b6c4(0x1e4)]('events.history',{'val':JSON[_0x51b6c4(0x24c)](this[_0x51b6c4(0x1d3)]),'ack':!![]}),this[_0x51b6c4(0x259)][_0x51b6c4(0x28e)](_0x51b6c4(0x1ac)+_0x57f19a[_0x51b6c4(0x286)]+'\x20('+_0x57f19a[_0x51b6c4(0x176)]+')');}[a0_0x333397(0x28d)](_0x1128c0){}}if(require[a0_0x333397(0x284)]!==module)module[a0_0x333397(0x1ce)]=_0x3029cc=>new CogniLiving(_0x3029cc);else new CogniLiving();