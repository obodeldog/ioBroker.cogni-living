const a0_0x41c580=a0_0x261b;function a0_0x261b(_0x509c60,_0x202d5f){const _0x314314=a0_0x2f91();return a0_0x261b=function(_0xa54b84,_0x23147a){_0xa54b84=_0xa54b84-0xa4;let _0x2f91bc=_0x314314[_0xa54b84];return _0x2f91bc;},a0_0x261b(_0x509c60,_0x202d5f);}(function(_0x94115a,_0x21ddd4){const _0x39b63b=a0_0x261b,_0x369cd2=_0x94115a();while(!![]){try{const _0x239095=-parseInt(_0x39b63b(0x162))/0x1+-parseInt(_0x39b63b(0x171))/0x2+-parseInt(_0x39b63b(0x15d))/0x3+parseInt(_0x39b63b(0x16b))/0x4*(parseInt(_0x39b63b(0xc5))/0x5)+parseInt(_0x39b63b(0x132))/0x6+parseInt(_0x39b63b(0xcc))/0x7*(parseInt(_0x39b63b(0x104))/0x8)+parseInt(_0x39b63b(0x11d))/0x9;if(_0x239095===_0x21ddd4)break;else _0x369cd2['push'](_0x369cd2['shift']());}catch(_0x3a9122){_0x369cd2['push'](_0x369cd2['shift']());}}}(a0_0x2f91,0x6c347));const a0_0x23147a=(function(){let _0x3d8467=!![];return function(_0xbbf8e5,_0x16087f){const _0x2130cb=_0x3d8467?function(){if(_0x16087f){const _0x5c13dd=_0x16087f['apply'](_0xbbf8e5,arguments);return _0x16087f=null,_0x5c13dd;}}:function(){};return _0x3d8467=![],_0x2130cb;};}()),a0_0xa54b84=a0_0x23147a(this,function(){const _0x33f0cd=a0_0x261b;return a0_0xa54b84['toString']()[_0x33f0cd(0x136)](_0x33f0cd(0x119))[_0x33f0cd(0xda)]()[_0x33f0cd(0xd6)](a0_0xa54b84)[_0x33f0cd(0x136)](_0x33f0cd(0x119));});function a0_0x2f91(){const _0x16d569=['modeResetJob','temperature','checkCalendarTriggers','triggerBriefing','triggerEnergyPrediction','setupLtmScheduler','location','getForeignObjectsAsync','analysis.energy.rlPenalties','LTM.dailyDigests','setObjectNotExistsAsync','eventHistory','./lib/installer','map','minutes_safe','party','1418370nzNiaf','getHours','telegram','geminiApiKey','enum','14934dhoGdq','LTM.rawEventLog','getOutsideTemperatureNumeric','ANALYZE_TREND','string','activityLevel','analysis.training.triggerTopology','@iobroker/adapter-core','cogni-living\x20adapter\x20starting\x20(v','15752QXbjCS','values','state','getTime','LTM.trainingData.thermodynamics','Heizung\x20kann\x20','167384TTWiLE','{\x22default\x22:\x2021}','getForeignObjectAsync','notifyTelegramInstance','briefingJob','testApiKey','\x20Tage)','Gemini\x20Init\x20Error:\x20','testNotification','SET_TOPOLOGY','keys','stopService','system.presenceWho','setStateAsync','includes','Instanz\x20nicht\x20gefunden','analysis.training.status','system.mode','log','setHours','length','fill','analysis.automation.triggerAction','TRAIN_HEALTH','Fehler:\x20','Current.WeatherText','updateTopology','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','driftAnalysisTimer','Simulation\x20durch\x20Admin\x20(Test)','automation.triggerAction','models/gemini-flash-latest','sensorLastValues','createAllObjects','subscribeStates','runPythonHealthCheck','WiFi\x20Presence\x20detected.','main','onMessage','createDailyDigest','analysis.automation.targetValue','./lib/automation','onReady','command','./lib/topology','timestamp','push','./lib/setup','send','isPresent','find','setupBriefingScheduler','OPTIMIZE_ENERGY','setPresence','type','info','online','text','enum.functions.*','subscribeForeignStatesAsync','./lib/ai_agent','currentSystemMode','TRAIN_SECURITY','SYSTEM_MODES','triggerGaitAnalysis','Key\x20not\x20found\x20or\x20not\x20provided','rawEventLog','analysis.energy.insulationScore','Kein\x20Kalender-Adapter','Aktiv\x20(','TRAIN_ENERGY','exitTimer','bind','getForeignStateAsync','updateLocation','getCalendarNames','clear','sendTo','abortExitTimer','endsWith','triggerDailyDigest','ðŸŽ“\x20[RL-RESET]\x20Lern-Sperre\x20(Penalty)\x20fÃ¼r\x20\x27','./lib/scheduler','runBaselineDriftAnalysis','licenseKey','weatherunderground.0','35rDIhXX','geminiModel','simulateEnergyMPC','heiter','scanDevices','parse','checkSolarCondition','14ISNnqq','message','response','systemConfig','isProVersion','lastTrackerEventTime','resetRLPenalty','updateTopologyMatrix','error','exports','constructor','LTM.trainingData.sequences','TRACK_EVENT','Party\x20Mode','toString','analysis.automation.targetId','VACATION','analysis.energy.warmupTimes','\x27\x20wurde\x20manuell\x20vom\x20Benutzer\x20gelÃ¶scht.','from','getGenerativeModel','ready','ltmJob','json','analysis.security.learningStatus','startService','analysisInterval','devices','PINN\x20AI\x20Forecast','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','communicate.request','stringify','SET_LEARNING_MODE','analysis.training.triggerComfort','join','config','manual','\x20min\x20ausbleiben.','calendarInstance','NextHours.Location_1.Day_1.current.symbol_desc','add','loadSystemMode','./lib/recorder','Notification\x20Test\x20Failed:\x20','Verbindung\x20erfolgreich!','checkLicense','cleanupGhostInterventions','Verbunden','name','val','NORMAL','getStateAsync','Gemini\x20AI\x20initialized.','dailyDigests','exitGraceTimer','getEnums','1363352tCHDXk','analysis.triggerBriefing','analysis.training.triggerEnergy','isSolar','common','Guest\x20Mode','runAutopilot','instance','analysis.trigger','notifyTelegramEnabled','sendNotification','analysis.automation.autoApply','floor','some','./lib/scanner','dismissAutomation','analysis.automation.description','checkThermostats','sendMorningBriefing','forEach','_calName','(((.+)+)+)+$','Kein\x20Wetter-Adapter','analysis.topology.structure','inactivityThresholdHours','2051496pFRAVF','system.adapter.','setState','callback','presenceDevices','isArray','analysisTimer','Sec-Training\x20started...','Warm-Up\x20Time\x20(Minutes\x20to\x20Target)','isGracePeriodActive','analysis.training.triggerHealth','forecast.current.weather','.system.mode','LTM.baselineStatus','sonn','key','onUnload','Test','ack','runGeminiAnalysis','stateChange','2509650kfgqKg','analysisHistory','pop','Daten\x20nicht\x20verfÃ¼gbar','search','@google/generative-ai','SYSTEM_DP_MODE','checkAndInstall','object','updateHealthVector','dependencyInstallInProgress','now','analysis.automation.patternDetected','initHistory','genAI','thermostat','startSystem','trackerHeartbeat','minDaysForBaseline','sort','accuweather.0','scanThermostats','klar','analysis.training.triggerSecurity','cancel',')\x20-\x20Phase\x20D\x20(Original\x20Sync)','checkWifiPresence'];a0_0x2f91=function(){return _0x16d569;};return a0_0x2f91();}a0_0xa54b84();'use strict';const utils=require(a0_0x41c580(0x169)),{GoogleGenerativeAI}=require(a0_0x41c580(0x137)),installer=require(a0_0x41c580(0x159)),scanner=require(a0_0x41c580(0x112)),schedulers=require(a0_0x41c580(0xc1)),topology=require(a0_0x41c580(0x19d)),setup=require(a0_0x41c580(0x1a0)),recorder=require(a0_0x41c580(0xf6)),pythonBridge=require('./lib/python_bridge'),aiAgent=require(a0_0x41c580(0xab)),deadMan=require('./lib/dead_man'),automation=require(a0_0x41c580(0x19a)),GEMINI_MODEL=a0_0x41c580(0x190),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils['Adapter']{constructor(_0x5f1288){const _0x4c2fbb=a0_0x41c580;super({..._0x5f1288,'name':'cogni-living'}),this[_0x4c2fbb(0x158)]=[],this['analysisHistory']=[],this[_0x4c2fbb(0xb1)]=[],this['dailyDigests']=[],this[_0x4c2fbb(0x191)]={},this[_0x4c2fbb(0xcf)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x4c2fbb(0x1a2)]=!![],this[_0x4c2fbb(0xb6)]=null,this[_0x4c2fbb(0x102)]=null,this[_0x4c2fbb(0x126)]=![],this[_0x4c2fbb(0x140)]=null,this[_0x4c2fbb(0xc6)]=null,this['currentSystemMode']=setup[_0x4c2fbb(0xae)][_0x4c2fbb(0xfe)],this[_0x4c2fbb(0xd0)]=![],this['lastAlertState']=![],this['analysisTimer']=null,this[_0x4c2fbb(0xe2)]=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this[_0x4c2fbb(0x175)]=null,this[_0x4c2fbb(0x13c)]=![],this[_0x4c2fbb(0x143)]=null,this[_0x4c2fbb(0xd1)]=Date['now'](),this['on'](_0x4c2fbb(0xe1),this[_0x4c2fbb(0x19b)]['bind'](this)),this['on'](_0x4c2fbb(0x131),this['onStateChange'][_0x4c2fbb(0xb7)](this)),this['on']('unload',this[_0x4c2fbb(0x12d)]['bind'](this)),this['on']('message',this[_0x4c2fbb(0x197)][_0x4c2fbb(0xb7)](this));}async[a0_0x41c580(0x19b)](){const _0x20da29=a0_0x41c580;this[_0x20da29(0x183)][_0x20da29(0xa6)](_0x20da29(0x16a)+this['version']+_0x20da29(0x14b));if(!installer[_0x20da29(0x139)](this,()=>this[_0x20da29(0x142)]()))return;}async[a0_0x41c580(0x142)](){const _0x43c3a0=a0_0x41c580;await setup['initZombies'](this);try{this[_0x43c3a0(0xd0)]=await setup[_0x43c3a0(0xf9)](this[_0x43c3a0(0xef)][_0x43c3a0(0xc3)]);}catch(_0x4a03bc){}if(!this[_0x43c3a0(0xef)][_0x43c3a0(0x11c)]||this['config'][_0x43c3a0(0x11c)]<0.1)this[_0x43c3a0(0xef)]['inactivityThresholdHours']=0xc;await setup[_0x43c3a0(0x13f)](this),await setup['initSystemConfig'](this);if(this['config']['geminiApiKey'])try{this[_0x43c3a0(0x140)]=new GoogleGenerativeAI(this[_0x43c3a0(0xef)][_0x43c3a0(0x160)]),this[_0x43c3a0(0xc6)]=this[_0x43c3a0(0x140)][_0x43c3a0(0xe0)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x43c3a0(0x183)]['info'](_0x43c3a0(0x100));}catch(_0x23c77f){this[_0x43c3a0(0x183)][_0x43c3a0(0xd4)](_0x43c3a0(0x178)+_0x23c77f['message']);}await setup[_0x43c3a0(0x192)](this),await this[_0x43c3a0(0xf5)](),await this[_0x43c3a0(0x157)]('analysis.energy.pinnForecast',{'type':_0x43c3a0(0x16d),'common':{'name':_0x43c3a0(0xe8),'type':_0x43c3a0(0x166),'role':_0x43c3a0(0xe3),'read':!![],'write':![]},'native':{}}),await this[_0x43c3a0(0x157)]('analysis.energy.ventilationAlerts',{'type':_0x43c3a0(0x16d),'common':{'name':'Active\x20Ventilation\x20Alerts','type':_0x43c3a0(0x166),'role':_0x43c3a0(0xe3),'read':!![],'write':![]},'native':{}}),await this[_0x43c3a0(0x157)](_0x43c3a0(0xdd),{'type':'state','common':{'name':_0x43c3a0(0x125),'type':_0x43c3a0(0x166),'role':_0x43c3a0(0xe3),'read':!![],'write':![]},'native':{}}),await this[_0x43c3a0(0x157)]('analysis.energy.warmupTargets',{'type':_0x43c3a0(0x16d),'common':{'name':'Warm-Up\x20Target\x20Temps\x20(JSON)','type':_0x43c3a0(0x166),'role':'json','read':!![],'write':!![],'def':_0x43c3a0(0x172)},'native':{}}),await this[_0x43c3a0(0x157)](_0x43c3a0(0x155),{'type':'state','common':{'name':'Reinforcement\x20Learning\x20Penalties','type':'string','role':_0x43c3a0(0xe3),'read':!![],'write':![],'def':'{}'},'native':{}});try{const _0x5a042c=await this[_0x43c3a0(0xff)](_0x43c3a0(0x163));if(_0x5a042c&&_0x5a042c[_0x43c3a0(0xfd)])this[_0x43c3a0(0xb1)]=JSON['parse'](_0x5a042c[_0x43c3a0(0xfd)]);}catch(_0x243950){this[_0x43c3a0(0xb1)]=[];}try{const _0x2abacd=await this[_0x43c3a0(0xff)]('LTM.dailyDigests');if(_0x2abacd&&_0x2abacd[_0x43c3a0(0xfd)])this[_0x43c3a0(0x101)]=JSON[_0x43c3a0(0xca)](_0x2abacd[_0x43c3a0(0xfd)]);}catch(_0xcb301b){this['dailyDigests']=[];}const _0x1102b4=this[_0x43c3a0(0x101)][_0x43c3a0(0x185)]>=(this[_0x43c3a0(0xef)]['minDaysForBaseline']||0x7)?_0x43c3a0(0xb4)+this[_0x43c3a0(0x101)][_0x43c3a0(0x185)]+_0x43c3a0(0x177):'Lernphase\x20('+this[_0x43c3a0(0x101)][_0x43c3a0(0x185)]+'/'+(this[_0x43c3a0(0xef)][_0x43c3a0(0x144)]||0x7)+')';await this[_0x43c3a0(0x17e)](_0x43c3a0(0x12a),{'val':_0x1102b4,'ack':!![]}),this[_0x43c3a0(0x193)](_0x43c3a0(0x10c)),this[_0x43c3a0(0x193)]('LTM.triggerDailyDigest'),this[_0x43c3a0(0x193)](_0x43c3a0(0x182)),this[_0x43c3a0(0x193)](_0x43c3a0(0x105)),this['subscribeStates'](_0x43c3a0(0x187)),this['subscribeStates'](_0x43c3a0(0x10f)),this['subscribeStates'](_0x43c3a0(0x149)),this[_0x43c3a0(0x193)](_0x43c3a0(0x127)),this[_0x43c3a0(0x193)](_0x43c3a0(0x106)),this[_0x43c3a0(0x193)]('analysis.training.triggerComfort'),this[_0x43c3a0(0x193)](_0x43c3a0(0x168)),this[_0x43c3a0(0x193)]('analysis.energy.mpcActive');const _0x524482=this[_0x43c3a0(0xef)][_0x43c3a0(0xe7)];if(_0x524482)for(const _0x50c669 of _0x524482){await this[_0x43c3a0(0xaa)](_0x50c669['id']);}const _0x4aac1d=this[_0x43c3a0(0xef)][_0x43c3a0(0x121)];if(_0x4aac1d)for(const _0x409e10 of _0x4aac1d){await this[_0x43c3a0(0xaa)](_0x409e10);}if(this[_0x43c3a0(0xef)][_0x43c3a0(0x10d)]&&this[_0x43c3a0(0xef)][_0x43c3a0(0x174)])await this['subscribeForeignStatesAsync'](this['config'][_0x43c3a0(0x174)]+'.communicate.request');setTimeout(()=>this[_0x43c3a0(0x14c)](),0x1388);if(this['analysisTimer'])clearInterval(this['analysisTimer']);const _0x54cd4c=this[_0x43c3a0(0xef)][_0x43c3a0(0xe6)]||0xf;_0x54cd4c>0x0&&(this['analysisTimer']=setInterval(()=>{const _0x39eaaa=_0x43c3a0;this[_0x39eaaa(0x10a)](),automation[_0x39eaaa(0x14f)](this);},_0x54cd4c*0x3c*0x3e8)),setTimeout(()=>automation[_0x43c3a0(0x14f)](this),0x2710),this[_0x43c3a0(0xef)]['trackerEnabled']!==![]&&(this[_0x43c3a0(0x143)]=setInterval(()=>{const _0x50de49=_0x43c3a0;if(this[_0x50de49(0xd0)]){const _0x1636b5=Date[_0x50de49(0x13d)](),_0x1ea8e9=this[_0x50de49(0xd1)]||_0x1636b5,_0x33b053=(_0x1636b5-_0x1ea8e9)/0x3e8;_0x33b053>0x2&&(this[_0x50de49(0xd1)]=_0x1636b5,pythonBridge[_0x50de49(0x1a1)](this,_0x50de49(0xd8),{'room':null,'dt':_0x33b053}));}},0xbb8)),schedulers[_0x43c3a0(0x152)](this,()=>aiAgent[_0x43c3a0(0x198)](this,pythonBridge)),schedulers['setupModeResetScheduler'](this),schedulers['setupDriftAnalysisScheduler'](this,()=>aiAgent[_0x43c3a0(0xc2)](this)),schedulers[_0x43c3a0(0x1a4)](this,()=>aiAgent[_0x43c3a0(0x116)](this)),pythonBridge[_0x43c3a0(0xe5)](this,installer['PYTHON_EXE']),setTimeout(async()=>{const _0x52c281=_0x43c3a0;await topology[_0x52c281(0x18b)](this);try{const _0x4c79b0=await this[_0x52c281(0xff)]('analysis.topology.structure');if(_0x4c79b0&&_0x4c79b0[_0x52c281(0xfd)])pythonBridge[_0x52c281(0x1a1)](this,_0x52c281(0x17a),JSON[_0x52c281(0xca)](_0x4c79b0[_0x52c281(0xfd)]));}catch(_0x2b2842){}this[_0x52c281(0x194)](),this['triggerGaitAnalysis'](),this[_0x52c281(0x151)](),this[_0x52c281(0x13b)]();},0x1388);}[a0_0x41c580(0x12d)](_0x38797b){const _0x50de0c=a0_0x41c580;if(this[_0x50de0c(0x123)])clearInterval(this[_0x50de0c(0x123)]);if(this[_0x50de0c(0x18d)])clearInterval(this[_0x50de0c(0x18d)]);if(this[_0x50de0c(0x143)])clearInterval(this['trackerHeartbeat']);if(this[_0x50de0c(0xe2)])this[_0x50de0c(0xe2)][_0x50de0c(0x14a)]();if(this[_0x50de0c(0x14d)])this[_0x50de0c(0x14d)]['cancel']();if(this[_0x50de0c(0x175)])this['briefingJob'][_0x50de0c(0x14a)]();recorder[_0x50de0c(0xbd)](this),pythonBridge[_0x50de0c(0x17c)](this),_0x38797b();}async['onStateChange'](_0x90e9ba,_0xa12e40){const _0x12d0a5=a0_0x41c580;if(!_0xa12e40||this[_0x12d0a5(0x13c)])return;if(_0x90e9ba[_0x12d0a5(0x17f)](_0x12d0a5(0x15f))&&_0x90e9ba[_0x12d0a5(0xbe)](_0x12d0a5(0xea))&&_0xa12e40['val'])return;if(_0x90e9ba===this['namespace']+_0x12d0a5(0x129)){if(_0xa12e40[_0x12d0a5(0xfd)]&&Object[_0x12d0a5(0x16c)](setup[_0x12d0a5(0xae)])['includes'](_0xa12e40['val'])){this[_0x12d0a5(0xac)]=_0xa12e40[_0x12d0a5(0xfd)];if(_0xa12e40[_0x12d0a5(0xfd)]===setup[_0x12d0a5(0xae)][_0x12d0a5(0xdc)])await recorder[_0x12d0a5(0xa4)](this,![]);else await recorder[_0x12d0a5(0xa4)](this,!![]);if(this[_0x12d0a5(0xd0)]){let _0x3b559e=![],_0x582e9b=0x0,_0x344c59=_0x12d0a5(0xf0);if(this['currentSystemMode']===_0x12d0a5(0x15c))_0x3b559e=!![],_0x582e9b=0x168,_0x344c59=_0x12d0a5(0xd9);else this[_0x12d0a5(0xac)]==='guest'&&(_0x3b559e=!![],_0x582e9b=0x5a0,_0x344c59=_0x12d0a5(0x109));pythonBridge[_0x12d0a5(0x1a1)](this,_0x12d0a5(0xec),{'active':_0x3b559e,'duration':_0x582e9b,'label':_0x344c59}),await this['setStateAsync'](_0x12d0a5(0xe4),{'val':JSON[_0x12d0a5(0xeb)]({'active':_0x3b559e,'label':_0x344c59,'timestamp':Date[_0x12d0a5(0x13d)]()}),'ack':!![]});}}if(!_0xa12e40['ack'])this['setState'](_0x90e9ba,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0xa12e40[_0x12d0a5(0x12f)]){if(_0x90e9ba[_0x12d0a5(0x17f)]('analysis.trigger')&&_0xa12e40[_0x12d0a5(0xfd)]){this['setState'](_0x90e9ba,{'val':![],'ack':!![]}),aiAgent[_0x12d0a5(0x130)](this);return;}if(_0x90e9ba['includes'](_0x12d0a5(0xbf))&&_0xa12e40[_0x12d0a5(0xfd)]){this['setState'](_0x90e9ba,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x90e9ba[_0x12d0a5(0x17f)](_0x12d0a5(0x150))&&_0xa12e40[_0x12d0a5(0xfd)]){this['setState'](_0x90e9ba,{'val':![],'ack':!![]}),aiAgent[_0x12d0a5(0x116)](this);return;}if(_0x90e9ba[_0x12d0a5(0x17f)](_0x12d0a5(0x18f))&&_0xa12e40[_0x12d0a5(0xfd)]){this[_0x12d0a5(0x11f)](_0x90e9ba,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x90e9ba['includes'](_0x12d0a5(0x149))&&_0xa12e40[_0x12d0a5(0xfd)]){this[_0x12d0a5(0x11f)](_0x90e9ba,{'val':![],'ack':!![]});if(this[_0x12d0a5(0xd0)])try{const _0x2c99a3=await this[_0x12d0a5(0xff)](_0x12d0a5(0xd7));if(_0x2c99a3&&_0x2c99a3[_0x12d0a5(0xfd)]){const _0x1156b1=JSON[_0x12d0a5(0xca)](_0x2c99a3[_0x12d0a5(0xfd)]);this['setStateAsync'](_0x12d0a5(0x181),{'val':_0x12d0a5(0x124),'ack':!![]}),pythonBridge[_0x12d0a5(0x1a1)](this,_0x12d0a5(0xad),{'sequences':_0x1156b1});}}catch(_0x3e5ba0){}return;}if(_0x90e9ba[_0x12d0a5(0x17f)](_0x12d0a5(0x127))&&_0xa12e40[_0x12d0a5(0xfd)]){this[_0x12d0a5(0x11f)](_0x90e9ba,{'val':![],'ack':!![]});if(this[_0x12d0a5(0xd0)])try{const _0x373a8b=await this[_0x12d0a5(0xff)](_0x12d0a5(0x156));if(_0x373a8b&&_0x373a8b['val'])pythonBridge[_0x12d0a5(0x1a1)](this,_0x12d0a5(0x188),{'digests':JSON[_0x12d0a5(0xca)](_0x373a8b[_0x12d0a5(0xfd)])});}catch(_0x1c7370){}return;}if(_0x90e9ba['includes'](_0x12d0a5(0x106))&&_0xa12e40[_0x12d0a5(0xfd)]){this[_0x12d0a5(0x11f)](_0x90e9ba,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x15c4cf=await this[_0x12d0a5(0xff)](_0x12d0a5(0x16f));if(_0x15c4cf&&_0x15c4cf[_0x12d0a5(0xfd)])pythonBridge[_0x12d0a5(0x1a1)](this,_0x12d0a5(0xb5),{'points':JSON[_0x12d0a5(0xca)](_0x15c4cf[_0x12d0a5(0xfd)])});}catch(_0x4d5ea8){}return;}if(_0x90e9ba[_0x12d0a5(0x17f)](_0x12d0a5(0xed))&&_0xa12e40[_0x12d0a5(0xfd)]){this['setState'](_0x90e9ba,{'val':![],'ack':!![]});if(this[_0x12d0a5(0xd0)])try{const _0x78fc08=await this['getStateAsync']('LTM.rawEventLog');if(_0x78fc08&&_0x78fc08[_0x12d0a5(0xfd)])pythonBridge['send'](this,'TRAIN_COMFORT',{'events':JSON[_0x12d0a5(0xca)](_0x78fc08[_0x12d0a5(0xfd)])});}catch(_0x3ebfe7){}return;}if(_0x90e9ba[_0x12d0a5(0x17f)](_0x12d0a5(0x168))&&_0xa12e40[_0x12d0a5(0xfd)]){this[_0x12d0a5(0x11f)](_0x90e9ba,{'val':![],'ack':!![]}),topology[_0x12d0a5(0x18b)](this);return;}}if(this[_0x12d0a5(0xef)][_0x12d0a5(0x121)]&&this[_0x12d0a5(0xef)]['presenceDevices'][_0x12d0a5(0x17f)](_0x90e9ba)){await this[_0x12d0a5(0x14c)]();return;}const _0x574e11=(this['config']['devices']||[])[_0x12d0a5(0x1a3)](_0x1d96c0=>_0x1d96c0['id']===_0x90e9ba);if(_0x574e11){const _0x380730=await recorder['processSensorEvent'](this,_0x90e9ba,_0xa12e40,_0x574e11);_0x380730&&_0x380730['type']==='motion'&&_0x380730[_0x12d0a5(0x153)]&&this[_0x12d0a5(0xd0)]&&deadMan[_0x12d0a5(0xb9)](this,_0x380730[_0x12d0a5(0x153)]),(_0x574e11[_0x12d0a5(0xa5)]===_0x12d0a5(0x14e)||_0x574e11[_0x12d0a5(0xa5)]===_0x12d0a5(0x141))&&automation[_0x12d0a5(0xfa)](this);}}async[a0_0x41c580(0x197)](_0x406667){const _0x551af7=a0_0x41c580;if(typeof _0x406667==='object'&&_0x406667[_0x551af7(0xcd)]){if(_0x406667['command']===_0x551af7(0x115))try{const _0x1150c7=await automation[_0x551af7(0x147)](this);this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667['command'],{'success':!![],'results':_0x1150c7},_0x406667[_0x551af7(0x120)]);}catch(_0x5193e9){this['sendTo'](_0x406667['from'],_0x406667[_0x551af7(0x19c)],{'success':![],'error':_0x5193e9[_0x551af7(0xcd)]},_0x406667[_0x551af7(0x120)]);}else{if(_0x406667[_0x551af7(0x19c)]===_0x551af7(0xc7))try{const {current_temps:_0x19ff17,t_out:_0x39e58a,targets:_0x13122d,t_forecast:_0x4611a9}=_0x406667[_0x551af7(0xcd)],_0x5a2e98=[];let _0x5c69e2={};try{const _0x4bf01d=await this[_0x551af7(0xff)](_0x551af7(0xb2));if(_0x4bf01d&&_0x4bf01d[_0x551af7(0xfd)]){const _0x335cde=JSON[_0x551af7(0xca)](_0x4bf01d[_0x551af7(0xfd)]);_0x5c69e2=_0x335cde['scores']||_0x335cde;}}catch(_0x2c0f00){}const _0x35ac8e=_0x4611a9!==undefined&&_0x4611a9!==null?(_0x39e58a+_0x4611a9)/0x2:_0x39e58a;for(const [_0x13b5d6,_0x41d941]of Object['entries'](_0x19ff17)){const _0x490cc6=_0x13122d[_0x13b5d6]||0x15;if(_0x41d941<=_0x490cc6)continue;let _0x3cd439=_0x5c69e2[_0x13b5d6]||-0.5;if(_0x3cd439>=0x0)_0x3cd439=-0.5;const _0x5315ae=Math['abs'](_0x3cd439),_0x828222=_0x41d941-_0x490cc6;let _0x4c00fb=Math[_0x551af7(0x110)](_0x828222/_0x5315ae*0x3c);const _0x4659d1=_0x41d941-_0x39e58a,_0x250807=_0x41d941-_0x35ac8e;if(_0x250807!==0x0&&_0x4659d1!==0x0){const _0x3f0ba4=_0x4659d1/_0x250807;_0x4c00fb=Math[_0x551af7(0x110)](_0x4c00fb*_0x3f0ba4);}if(_0x4c00fb>0xf){if(_0x4c00fb>0xf0)_0x4c00fb=0xf0;_0x5a2e98[_0x551af7(0x19f)]({'room':_0x13b5d6,'minutes_safe':_0x4c00fb,'target':_0x490cc6,'current':_0x41d941,'savings_msg':_0x551af7(0x170)+_0x4c00fb+_0x551af7(0xf1)});}}_0x5a2e98[_0x551af7(0x145)]((_0x11a067,_0x2ac8ca)=>_0x2ac8ca[_0x551af7(0x15b)]-_0x11a067[_0x551af7(0x15b)]),this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![],'proposals':_0x5a2e98},_0x406667[_0x551af7(0x120)]);}catch(_0x44adc0){this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':![],'error':_0x44adc0['message']},_0x406667[_0x551af7(0x120)]);}else{if(_0x406667[_0x551af7(0x19c)]===_0x551af7(0xd2))try{const _0x27fbd8=_0x406667[_0x551af7(0xcd)][_0x551af7(0x12c)],_0x1bd588='analysis.energy.rlPenalties',_0x1af2a4=await this[_0x551af7(0xff)](_0x1bd588);let _0x63a9fa={};if(_0x1af2a4&&_0x1af2a4['val'])try{_0x63a9fa=JSON['parse'](_0x1af2a4[_0x551af7(0xfd)]);}catch(_0x1bb790){}_0x27fbd8&&_0x63a9fa[_0x27fbd8]?(delete _0x63a9fa[_0x27fbd8],await this['setStateAsync'](_0x1bd588,{'val':JSON[_0x551af7(0xeb)](_0x63a9fa),'ack':!![]}),this[_0x551af7(0x183)][_0x551af7(0xa6)](_0x551af7(0xc0)+_0x27fbd8+_0x551af7(0xde)),this[_0x551af7(0xbc)](_0x406667['from'],_0x406667[_0x551af7(0x19c)],{'success':!![]},_0x406667[_0x551af7(0x120)])):this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':![],'error':_0x551af7(0xb0)},_0x406667['callback']);}catch(_0x2db101){this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':![],'error':_0x2db101[_0x551af7(0xcd)]},_0x406667['callback']);}else{if(_0x406667[_0x551af7(0x19c)]===_0x551af7(0x113))await this[_0x551af7(0x17e)](_0x551af7(0x13e),{'val':![],'ack':!![]}),await this[_0x551af7(0x17e)](_0x551af7(0x114),{'val':'','ack':!![]}),await this[_0x551af7(0x17e)](_0x551af7(0xdb),{'val':'','ack':!![]}),this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667['command'],{'success':!![]},_0x406667[_0x551af7(0x120)]);else{if(_0x406667[_0x551af7(0x19c)]==='simulateButler'){const {targetId:_0x5b07f5,targetValue:_0x2e04c3}=_0x406667['message'];await this[_0x551af7(0x17e)](_0x551af7(0x13e),{'val':!![],'ack':!![]}),await this[_0x551af7(0x17e)]('analysis.automation.description',{'val':_0x551af7(0x18e),'ack':!![]}),await this[_0x551af7(0x17e)](_0x551af7(0xdb),{'val':_0x5b07f5,'ack':!![]}),await this['setStateAsync']('analysis.automation.targetValue',{'val':String(_0x2e04c3),'ack':!![]}),this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![]},_0x406667[_0x551af7(0x120)]);}else{if(_0x406667[_0x551af7(0x19c)]===_0x551af7(0x176))try{const _0x1a7619=_0x406667[_0x551af7(0xcd)]['apiKey'];if(!_0x1a7619)throw new Error('Kein\x20API\x20Key\x20Ã¼bergeben');const _0x2c1c10=new GoogleGenerativeAI(_0x1a7619),_0x38d476=_0x2c1c10['getGenerativeModel']({'model':GEMINI_MODEL}),_0x464878=await _0x38d476['generateContent'](_0x551af7(0x12e)),_0x1a5d9f=await _0x464878[_0x551af7(0xce)];if(_0x1a5d9f[_0x551af7(0xa8)]())this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![],'message':_0x551af7(0xf8)},_0x406667['callback']);else throw new Error('Keine\x20Antwort\x20von\x20Gemini');}catch(_0x510429){this['sendTo'](_0x406667[_0x551af7(0xdf)],_0x406667['command'],{'success':![],'message':_0x510429[_0x551af7(0xcd)]},_0x406667[_0x551af7(0x120)]);}else{if(_0x406667[_0x551af7(0x19c)]===_0x551af7(0xc9))try{const _0x56c267=await scanner['scanForDevices'](this,_0x406667[_0x551af7(0xcd)]||{});this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![],'devices':_0x56c267},_0x406667[_0x551af7(0x120)]);}catch(_0x41ddff){this['sendTo'](_0x406667[_0x551af7(0xdf)],_0x406667['command'],{'success':![],'error':_0x41ddff[_0x551af7(0xcd)]},_0x406667[_0x551af7(0x120)]);}else{if(_0x406667[_0x551af7(0x19c)]===_0x551af7(0xd3))try{const {matrix:_0x7ca1c0}=_0x406667['message'],_0x3a41c9=await this[_0x551af7(0xff)](_0x551af7(0x11b));if(_0x3a41c9&&_0x3a41c9[_0x551af7(0xfd)]){const _0x49dce7=JSON[_0x551af7(0xca)](_0x3a41c9[_0x551af7(0xfd)]);_0x49dce7['matrix']=_0x7ca1c0,_0x49dce7['updated']=Date[_0x551af7(0x13d)](),await this[_0x551af7(0x17e)]('analysis.topology.structure',{'val':JSON[_0x551af7(0xeb)](_0x49dce7),'ack':!![]}),pythonBridge[_0x551af7(0x1a1)](this,_0x551af7(0x17a),_0x49dce7);}this['sendTo'](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![]},_0x406667[_0x551af7(0x120)]);}catch(_0x32f4c5){this[_0x551af7(0x183)][_0x551af7(0xd4)](_0x32f4c5);}else{if(_0x406667[_0x551af7(0x19c)]==='getLtmData')this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![],'dailyDigests':this[_0x551af7(0x101)]||[],'analysisHistory':this[_0x551af7(0x133)]||[]},_0x406667[_0x551af7(0x120)]);else{if(_0x406667[_0x551af7(0x19c)]==='getOverviewData'){const _0x5e5286=this[_0x551af7(0x101)]['length'],_0x44a2ef=new Array(0x18)[_0x551af7(0x186)](0x0),_0x1f36db=new Date()[_0x551af7(0x184)](0x0,0x0,0x0,0x0);this[_0x551af7(0x158)]&&this[_0x551af7(0x158)][_0x551af7(0x117)](_0x5b476d=>{const _0x41112e=_0x551af7;if(_0x5b476d[_0x41112e(0x19e)]>=_0x1f36db){const _0x31d1fb=new Date(_0x5b476d[_0x41112e(0x19e)])[_0x41112e(0x15e)]();if(_0x31d1fb>=0x0&&_0x31d1fb<0x18)_0x44a2ef[_0x31d1fb]++;}});let _0x14fe54=![],_0x5846de='',_0x4143c4='',_0x15c2a1='';try{const _0x2695ce=await this['getStateAsync'](_0x551af7(0x13e));if(_0x2695ce&&_0x2695ce[_0x551af7(0xfd)]){_0x14fe54=!![];const _0x945b5f=await this['getStateAsync'](_0x551af7(0x114));_0x5846de=_0x945b5f?_0x945b5f['val']:'';const _0x4b3846=await this[_0x551af7(0xff)]('analysis.automation.targetId');_0x4143c4=_0x4b3846?_0x4b3846[_0x551af7(0xfd)]:'';const _0x3da62e=await this[_0x551af7(0xff)](_0x551af7(0x199));_0x15c2a1=_0x3da62e?_0x3da62e['val']:'';}}catch(_0xa675e3){}const _0x3bad5c=await this[_0x551af7(0xcb)](),_0x3cc1d1=(this['config']['devices']||[])[_0x551af7(0x111)](_0x5eb7d9=>_0x5eb7d9[_0x551af7(0x107)]),_0x4ed137=_0x3bad5c&&_0x3cc1d1;this[_0x551af7(0xbc)](_0x406667['from'],_0x406667[_0x551af7(0x19c)],{'success':!![],'eventHistory':this[_0x551af7(0x158)]['slice'](0x0,0xf),'stats':{'digestCount':_0x5e5286,'isPresent':this[_0x551af7(0x1a2)],'hourlyActivity':_0x44a2ef,'solarActive':_0x4ed137},'automation':{'detected':_0x14fe54,'description':_0x5846de,'targetId':_0x4143c4,'targetValue':_0x15c2a1}},_0x406667[_0x551af7(0x120)]);}else{if(_0x406667[_0x551af7(0x19c)]===_0x551af7(0x103)){const _0x5162d5=await this[_0x551af7(0x154)](_0x551af7(0xa9),_0x551af7(0x161)),_0x33f949=[];if(_0x5162d5)for(const _0x152ebc in _0x5162d5){const _0x10591f=_0x5162d5[_0x152ebc],_0x5c2c5d=(_0x10591f[_0x551af7(0x108)]&&typeof _0x10591f[_0x551af7(0x108)][_0x551af7(0xfc)]===_0x551af7(0x13a)?_0x10591f['common'][_0x551af7(0xfc)]['de']:_0x10591f[_0x551af7(0x108)][_0x551af7(0xfc)])||_0x10591f[_0x551af7(0x108)]['name'];_0x33f949[_0x551af7(0x19f)]({'id':_0x152ebc,'name':_0x5c2c5d});}const _0x269772=await this[_0x551af7(0x154)]('enum.rooms.*','enum'),_0x38f154=[];if(_0x269772)for(const _0x5caf98 in _0x269772){const _0x55bdf9=_0x269772[_0x5caf98],_0x42c160=(_0x55bdf9[_0x551af7(0x108)]&&typeof _0x55bdf9[_0x551af7(0x108)][_0x551af7(0xfc)]===_0x551af7(0x13a)?_0x55bdf9[_0x551af7(0x108)][_0x551af7(0xfc)]['de']:_0x55bdf9[_0x551af7(0x108)]['name'])||_0x5caf98['split']('.')[_0x551af7(0x134)]();_0x38f154[_0x551af7(0x19f)](_0x42c160);}this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![],'enums':_0x33f949,'rooms':_0x38f154},_0x406667['callback']);}else{if(_0x406667['command']==='testContext')try{let _0x5128f7=_0x551af7(0x11a),_0xcce314=_0x551af7(0xb3);if(this[_0x551af7(0xef)]['useWeather']){const _0x11a2f8=await recorder[_0x551af7(0x164)](this);_0x5128f7=_0x11a2f8!==null?_0x11a2f8+'Â°C':_0x551af7(0x135);}if(this[_0x551af7(0xef)][_0x551af7(0xf2)]){const _0xd1fa0c=await this[_0x551af7(0x173)](_0x551af7(0x11e)+this[_0x551af7(0xef)][_0x551af7(0xf2)]);_0xcce314=_0xd1fa0c?_0x551af7(0xfb):_0x551af7(0x180);}this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![],'weather':_0x5128f7,'calendar':_0xcce314},_0x406667[_0x551af7(0x120)]);}catch(_0x28a182){this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':![],'error':_0x28a182['message']},_0x406667[_0x551af7(0x120)]);}else{if(_0x406667[_0x551af7(0x19c)]===_0x551af7(0xba))try{const _0x2193a6=_0x406667[_0x551af7(0xcd)][_0x551af7(0x10b)],_0x12aa52=await this[_0x551af7(0xb8)](_0x2193a6+'.data.table');let _0x172824=[];if(_0x12aa52&&_0x12aa52[_0x551af7(0xfd)]){const _0x58b3fc=JSON[_0x551af7(0xca)](_0x12aa52['val']),_0x1df704=new Set();Array[_0x551af7(0x122)](_0x58b3fc)&&_0x58b3fc[_0x551af7(0x117)](_0x309466=>{const _0xb9fad0=_0x551af7;if(_0x309466[_0xb9fad0(0x118)])_0x1df704[_0xb9fad0(0xf4)](_0x309466['_calName']);else{if(_0x309466['calendarName'])_0x1df704['add'](_0x309466['calendarName']);}}),_0x172824=Array['from'](_0x1df704)[_0x551af7(0x145)]();}if(_0x172824['length']===0x0)_0x172824=['Standard'];this[_0x551af7(0xbc)](_0x406667['from'],_0x406667[_0x551af7(0x19c)],{'success':!![],'names':_0x172824},_0x406667[_0x551af7(0x120)]);}catch(_0xe83a99){this['sendTo'](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':![],'error':_0xe83a99['message']},_0x406667[_0x551af7(0x120)]);}else{if(_0x406667['command']===_0x551af7(0x179))try{await setup[_0x551af7(0x10e)](this,_0x551af7(0xe9),![],![]),this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':!![],'message':'Gesendet'},_0x406667[_0x551af7(0x120)]);}catch(_0x47925a){this[_0x551af7(0x183)][_0x551af7(0xd4)](_0x551af7(0xf7)+_0x47925a[_0x551af7(0xcd)]),this[_0x551af7(0xbc)](_0x406667[_0x551af7(0xdf)],_0x406667[_0x551af7(0x19c)],{'success':![],'message':_0x551af7(0x189)+_0x47925a[_0x551af7(0xcd)]},_0x406667[_0x551af7(0x120)]);}}}}}}}}}}}}}}}}async['loadSystemMode'](){const _0x4daa4e=a0_0x41c580;try{const _0x1475bc=await this['getStateAsync'](setup[_0x4daa4e(0x138)]);_0x1475bc&&_0x1475bc[_0x4daa4e(0xfd)]&&Object[_0x4daa4e(0x16c)](setup[_0x4daa4e(0xae)])[_0x4daa4e(0x17f)](_0x1475bc[_0x4daa4e(0xfd)])?this[_0x4daa4e(0xac)]=_0x1475bc[_0x4daa4e(0xfd)]:(this['currentSystemMode']=setup[_0x4daa4e(0xae)]['NORMAL'],await this[_0x4daa4e(0x17e)](setup[_0x4daa4e(0x138)],{'val':setup[_0x4daa4e(0xae)]['NORMAL'],'ack':!![]}));}catch(_0x3cc305){this[_0x4daa4e(0xac)]=setup[_0x4daa4e(0xae)][_0x4daa4e(0xfe)];}}async[a0_0x41c580(0x14c)](){const _0x2d1663=a0_0x41c580;try{const _0x461923=this['config'][_0x2d1663(0x121)]||[];let _0x482461=![];const _0x199204=[];for(const _0x577ca5 of _0x461923){try{const _0x2cfb8a=await this[_0x2d1663(0xb8)](_0x577ca5);_0x2cfb8a&&(_0x2cfb8a['val']===!![]||_0x2cfb8a[_0x2d1663(0xfd)]===_0x2d1663(0xa7)||_0x2cfb8a[_0x2d1663(0xfd)]===0x1)&&(_0x482461=!![],_0x199204['push'](_0x577ca5));}catch(_0x2759eb){}}return await this[_0x2d1663(0x17e)](_0x2d1663(0x17d),{'val':_0x199204[_0x2d1663(0xee)](',\x20'),'ack':!![]}),_0x482461&&(this[_0x2d1663(0xb6)]&&(this[_0x2d1663(0x183)][_0x2d1663(0xa6)](_0x2d1663(0x195)),recorder['abortExitTimer'](this)),!this[_0x2d1663(0x1a2)]&&this[_0x2d1663(0xac)]===setup[_0x2d1663(0xae)][_0x2d1663(0xfe)]&&await recorder[_0x2d1663(0xa4)](this,!![])),_0x482461;}catch(_0x3bb58c){return![];}}async[a0_0x41c580(0x10a)](){const _0x4fb9a0=a0_0x41c580;this[_0x4fb9a0(0x183)]['debug'](_0x4fb9a0(0x18c)),await aiAgent[_0x4fb9a0(0x130)](this),this[_0x4fb9a0(0x13b)](),this['triggerGaitAnalysis'](),this[_0x4fb9a0(0x151)]();}async[a0_0x41c580(0xcb)](){const _0x1069d7=a0_0x41c580,_0x171915=[_0x1069d7(0xc4),_0x1069d7(0x146),'daswetter.0'],_0x3cbfb8=[_0x1069d7(0x128),_0x1069d7(0x18a),_0x1069d7(0xf3)];for(const _0x5eee10 of _0x171915){for(const _0x12d345 of _0x3cbfb8){try{const _0x2e33b4=_0x5eee10+'.'+_0x12d345,_0x649fe=await this[_0x1069d7(0xb8)](_0x2e33b4);if(_0x649fe&&_0x649fe[_0x1069d7(0xfd)]){const _0x413a94=String(_0x649fe[_0x1069d7(0xfd)])['toLowerCase']();if(_0x413a94[_0x1069d7(0x17f)](_0x1069d7(0x12b))||_0x413a94[_0x1069d7(0x17f)]('sunny')||_0x413a94['includes'](_0x1069d7(0x148))||_0x413a94[_0x1069d7(0x17f)](_0x1069d7(0xbb))||_0x413a94[_0x1069d7(0x17f)](_0x1069d7(0xc8)))return!![];}}catch(_0x31ca0f){}}}return![];}[a0_0x41c580(0xaf)](){const _0x3b8932=a0_0x41c580;if(!this[_0x3b8932(0xd0)])return;try{this['getState'](_0x3b8932(0xd7),(_0x1f2236,_0x5dfa05)=>{const _0x374307=_0x3b8932;_0x5dfa05&&_0x5dfa05[_0x374307(0xfd)]&&pythonBridge[_0x374307(0x1a1)](this,'ANALYZE_GAIT',{'sequences':JSON['parse'](_0x5dfa05[_0x374307(0xfd)])});});}catch(_0x19ccdc){}}async[a0_0x41c580(0x151)](){const _0x34a27a=a0_0x41c580;if(!this[_0x34a27a(0xd0)])return;try{const _0x46a2df=await recorder[_0x34a27a(0x164)](this);if(_0x46a2df===null)return;const _0xd9c811={},_0xbf05b={},_0x395f96=this['config']['devices']||[];for(const _0x257143 of _0x395f96){if(_0x257143['type']===_0x34a27a(0x14e)&&_0x257143[_0x34a27a(0x153)]){const _0x117271=this[_0x34a27a(0x191)][_0x257143['id']];if(_0x117271!==undefined)_0xd9c811[_0x257143[_0x34a27a(0x153)]]=_0x117271;if(_0x257143[_0x34a27a(0x107)])_0xbf05b[_0x257143['location']]=!![];}}const _0x2748d5=await this[_0x34a27a(0xcb)]();let _0x1b7ba5={};try{const _0x414bc=await this['getStateAsync']('analysis.energy.warmupTargets');if(_0x414bc&&_0x414bc[_0x34a27a(0xfd)])_0x1b7ba5=JSON[_0x34a27a(0xca)](_0x414bc['val']);}catch(_0x1d83c4){}Object[_0x34a27a(0x17b)](_0xd9c811)[_0x34a27a(0x185)]>0x0&&(pythonBridge[_0x34a27a(0x1a1)](this,'PREDICT_ENERGY',{'current_temps':_0xd9c811,'t_out':_0x46a2df,'is_sunny':_0x2748d5,'solar_flags':_0xbf05b,'warmup_targets':_0x1b7ba5}),pythonBridge[_0x34a27a(0x1a1)](this,_0x34a27a(0x1a5),{'current_temps':_0xd9c811,'t_out':_0x46a2df,'targets':{}}));}catch(_0x695e6d){}}['updateHealthVector'](){const _0x4d58b5=a0_0x41c580;if(!this[_0x4d58b5(0xb1)]||this[_0x4d58b5(0xb1)][_0x4d58b5(0x185)]===0x0)return;const _0xf1e6c=new Array(0x60)['fill'](0x0),_0x1201c6=new Date()[_0x4d58b5(0x184)](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x4d58b5(0x117)](_0x259a6b=>{const _0x387c99=_0x4d58b5,_0x494b8c=new Date(_0x259a6b[_0x387c99(0x19e)]);if(_0x494b8c[_0x387c99(0x16e)]()>=_0x1201c6){const _0x140278=_0x494b8c['getHours'](),_0x39bd57=_0x494b8c['getMinutes'](),_0x15afe3=_0x140278*0x4+Math[_0x387c99(0x110)](_0x39bd57/0xf);if(_0x15afe3>=0x0&&_0x15afe3<0x60)_0xf1e6c[_0x15afe3]++;}}),this['setStateAsync']('analysis.health.todayVector',{'val':JSON[_0x4d58b5(0xeb)](_0xf1e6c),'ack':!![]});}[a0_0x41c580(0x194)](){const _0x56794d=a0_0x41c580;if(!this['dailyDigests']||this[_0x56794d(0x101)][_0x56794d(0x185)]<0x2)return;const _0x230a5c=this['dailyDigests'][_0x56794d(0x15a)](_0x5db0a4=>{const _0xf09f57=_0x56794d,_0xd58281=(_0x5db0a4[_0xf09f57(0x167)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0xd58281]||0x32;});pythonBridge[_0x56794d(0x1a1)](this,_0x56794d(0x165),{'values':_0x230a5c,'tag':'Activity-Level'});}}if(require[a0_0x41c580(0x196)]!==module)module[a0_0x41c580(0xd5)]=_0x4ab532=>new CogniLiving(_0x4ab532);else new CogniLiving();