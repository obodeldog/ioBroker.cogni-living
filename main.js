const a0_0x457880=a0_0x2869;function a0_0x2869(_0x8ec8d3,_0x3bea8e){const _0x5ed056=a0_0x42d1();return a0_0x2869=function(_0x10886d,_0x19242b){_0x10886d=_0x10886d-0x192;let _0x42d18d=_0x5ed056[_0x10886d];return _0x42d18d;},a0_0x2869(_0x8ec8d3,_0x3bea8e);}(function(_0x23d836,_0x7c1bc){const _0xf6c111=a0_0x2869,_0x286350=_0x23d836();while(!![]){try{const _0x384b26=parseInt(_0xf6c111(0x19d))/0x1*(-parseInt(_0xf6c111(0x2a8))/0x2)+-parseInt(_0xf6c111(0x334))/0x3*(parseInt(_0xf6c111(0x2ac))/0x4)+-parseInt(_0xf6c111(0x280))/0x5*(-parseInt(_0xf6c111(0x231))/0x6)+parseInt(_0xf6c111(0x207))/0x7*(-parseInt(_0xf6c111(0x21a))/0x8)+parseInt(_0xf6c111(0x277))/0x9+parseInt(_0xf6c111(0x27e))/0xa*(parseInt(_0xf6c111(0x32f))/0xb)+parseInt(_0xf6c111(0x253))/0xc*(parseInt(_0xf6c111(0x276))/0xd);if(_0x384b26===_0x7c1bc)break;else _0x286350['push'](_0x286350['shift']());}catch(_0xd85087){_0x286350['push'](_0x286350['shift']());}}}(a0_0x42d1,0xba40e));const a0_0x19242b=(function(){let _0x49ab91=!![];return function(_0xcaa9fe,_0x24c86d){const _0x398157=_0x49ab91?function(){const _0x1d407d=a0_0x2869;if(_0x24c86d){const _0x3ad25a=_0x24c86d[_0x1d407d(0x30b)](_0xcaa9fe,arguments);return _0x24c86d=null,_0x3ad25a;}}:function(){};return _0x49ab91=![],_0x398157;};}()),a0_0x10886d=a0_0x19242b(this,function(){const _0x9dc908=a0_0x2869;return a0_0x10886d['toString']()[_0x9dc908(0x2f8)]('(((.+)+)+)+$')['toString']()[_0x9dc908(0x1d3)](a0_0x10886d)[_0x9dc908(0x2f8)]('(((.+)+)+)+$');});a0_0x10886d();'use strict';const utils=require(a0_0x457880(0x2fb)),{GoogleGenerativeAI}=require(a0_0x457880(0x336)),schedule=require('node-schedule'),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x457880(0x2a3),LTM_SCHEDULE=a0_0x457880(0x30e),MODE_RESET_SCHEDULE=a0_0x457880(0x2d5),LTM_DP_RAW_LOG=a0_0x457880(0x309),LTM_DP_DAILY_DIGESTS=a0_0x457880(0x25f),LTM_DP_STATUS=a0_0x457880(0x2a0),LTM_DP_TRIGGER_DIGEST=a0_0x457880(0x1a3),LTM_DP_BASELINE_STATUS=a0_0x457880(0x2df),LTM_DP_DRIFT_CHANNEL=a0_0x457880(0x24c),LTM_DP_DRIFT_STATUS=a0_0x457880(0x255),LTM_DP_DRIFT_DETAILS=a0_0x457880(0x2ad),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x457880(0x2cd),SYSTEM_MODES={'NORMAL':a0_0x457880(0x220),'VACATION':a0_0x457880(0x1f6),'PARTY':a0_0x457880(0x234),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x457880(0x1f4)],SYSTEM_MODES[a0_0x457880(0x330)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x457880(0x32b),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','family':a0_0x457880(0x24f),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':a0_0x457880(0x216)};function a0_0x42d1(){const _0x5f0857=['getEnums','setupBriefingScheduler','Bewegung','daswetter.','cogni-living\x20adapter\x20starting\x20(v','includes','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','getForeignObjectsAsync','analysis.health.restlessness','summary','text','LTM.driftAnalysis','splice','weatherunderground.0','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','licht','sensor.motion','schlaf','171912bSLUFp','genAI','LTM.driftAnalysis.baselineDrift','subscribeStates','analysis.history_debug_00','error','isEmergency','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','parse','LTM','Daily\x20Digest\x20Error:\x20','yr.','LTM.dailyDigests','\x0aFEEDBACK:\x0a','getWeatherContext','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20','write','getObjectAsync','Aktiv\x20(','pop','last\x20action','analysis.alertReason','colormode','from','isProVersion','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','checkWifiPresence','WEEK_PROGRAM','manufacturer','events.lastEvent','events.history_debug_00','N/A','sendTo','unshift','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','2522feWsmQ','8644743cyEidW','checkLicense','livingContext','bind','analysis.health.sleepScore','extendObjectAsync','processSensorEvent','10cJHVGV','button','40XQNZGS','state','hue','accuweather.','Last\x20Check','enum','VACATION','ltmStbWindowDays','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','analysis.deviationFromBaseline','Creating\x20Daily\x20Digest\x20from\x20','activity','N/A\x20(Learning)','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','ERROR','toString','üö®üö®\x20NOTFALL','analysis.comfortSuggestion','accuweather','log','automationProposal','Daily\x20Digests','\x20sent','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','logDuplicates','effect','slice','analysisInterval','cogni-living','Temperatur','uuid-error','event','LTM.processingStatus','exitGraceTimer','info','models/gemini-flash-latest','flur','OPERATING_VOLTAGE','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','.Summary.Current','6TdOgct','UNREACH','runBaselineDriftAnalysis','Nein','4ZZAFNk','LTM.driftAnalysis.driftDetails','weatherInstance','process','loadRawEventLog','SECTION','PRO-','json','openweathermap.0','rain','Baseline\x20Status','DUTYCYCLE','.NextHours.Location_1.Day_1.current.symbol_desc','PROCESS','level.dimmer','analysis.triggerBriefing','analysisHistory','link_quality','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','sort','alertReason','driftDetails','sat','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','\x20presence\x20devices...','mode','ON_TIME','briefingJob','find','Rauchmelder','updateAnalysisHistory','startsWith','Subscribing\x20to\x20','system.mode','channel','ltmLtbWindowDays','presenceDevices','location','none','history.','inactivityMonitoringEnabled','0\x204\x20*\x20*\x20*','ack','catch','STICKY_UNREACH','minDaysForBaseline','briefingEnabled','exitTimer','Analysis\x20Error:\x20','switch.light','sensor.door','LTM.baselineStatus','bad','length','config','flot.','wohnungst√ºr','deviationFromBaseline','Missing\x20data','analysis.history_debug_03','type','system.isPresent','WORKING','some','2-digit','value.temperature','.data.table','Gemini\x20Init\x20Error:\x20','runGeminiAnalysis','Processing\x20Status','runAutopilot','aiPersona','.\x20PR√ÑSENZ:\x20','events.history','driftAnalysisTimer','patternDetected','search','stateChange','push','@iobroker/adapter-core','modelid','analysis.isEmergency','saveDailyDigests','analysis.health.notes','replace','Licht','daswetter.0','getSystemUUID','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','number','exports','history','getForeignObjectAsync','LTM.rawEventLog','uuid-not-found','apply','analysis.automation.patternDetected','online','0\x203\x20*\x20*\x20*','\x20*\x20*\x20*','analysis.history_debug_04','events.history_debug_04','native','generateContent','weatherunderground.','details','activityLevel','\x20raw\x20events...','stringify','startExitTimer','onReady','devices','dailyDigests','date','namespace','Fenster/T√ºr','[Test]\x20Notification','version','generic','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','analysis.activitySummary','updateBaselineStatus','Gemini\x20AI\x20initialized.','trim','getForeignStateAsync','map','ERROR_CODE','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','ALARM','smoke','INSTALL_TEST','9060095BrGBvJ','GUEST','sendNotification','common','garten','2931423SaLGae','members','@google/generative-ai','NORMAL','presence','system.meta.uuid','last_seen','setupLtmScheduler','Badezimmer','onStateChange','saveRawEventLog','precip','delObjectAsync','name','‚ö†Ô∏è\x20Alarm','timestamp','system.','message','504874kXnBeQ','wind','health','sendMorningBriefing','loadSystemMode','\x20sensors...','LTM.triggerDailyDigest','unknown','_score','analysis.trigger','setPresence','system.config','üåÖ\x20Daily\x20Briefing:\x0a','Wohnzimmer','setupDriftAnalysisScheduler','testContext','analysisTimer','longitude','getGenerativeModel','values','val','diele','saveFeedback','CONNECTION','latitude','Lernphase\x20(','currentSystemMode','useCalendar','pressure','object','t√ºr','systemConfig','lights','events.history_debug_01','Garten','motion','Analysiere\x20Tag...','temperature','loadHistoryFromState','VIRTUAL_CHANNEL','sensorLastValues','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','events.history_debug_03','onUnload','comfort','abortExitTimer','subscribeForeignStatesAsync','temp','testApiKey','CONFIG_PENDING','No\x20recorded\x20events\x20yet.','ltmDriftCheckIntervalHours','Schlafzimmer','callback','constructor','feedbackHistory','weather','testNotification','triggerDailyDigest','long','openweathermap','cancel','setHours','city','scanForDevices','eingang','application/json','command','lastCheck','status','onMessage','ltmJob','WETTER:\x20Keine\x20Daten\x20(Adapter\x20aktiv,\x20aber\x20kein\x20Wert)','RSSI','analysis.history_debug_01','bewegung','\x22\x20was\x20','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','lastAlertState','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','rawEventLog','toISOString','string','update','setState','now','isPresent','PARTY','createAllObjects','vacation','sleepScore','suggestedAction','scanDevices','scriptProblem','setStateAsync','ical.0','calendarInstance','detectionState','geminiApiKey','battery','apiKey','loadDailyDigests','enum.functions.*','systemUUID','notes','checkLtmObjects','190169QIfKVl','Briefing\x20Error:\x20','Starting\x20Autopilot\x20(','Raw\x20Log','setupModeResetScheduler','Scheduling\x20Morning\x20Briefing\x20for\x20','Schalter/Licht','fenster','analysis.analysisHistory','restlessness','boolean','getCalendarContext','getStateAsync','info.','uuid','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','08:00','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','selectedFunctionIds','392BEDzYx','vis.','split','modeResetJob','analysis.history_debug_02','geminiModel','normal','Daily\x20Digest\x20created\x20successfully.','\x0a\x0aA\x20(STB):\x0a','baselineDrift','icons-mfd.','inactivityThresholdHours','join','WETTER:\x20','toLowerCase','haust√ºr','response','isGracePeriodActive','occupancy','productname','KALENDER:\x20','main','DIRECTION','16818UjdXjd','scheduleJob','analysis.comfortSummary','party','forecast','isArray','description','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','enum.rooms.*','Fehler:\x20','getLtmData','.data.text','eventHistory','fire','value.humidity','Drift\x20Details'];a0_0x42d1=function(){return _0x5f0857;};return a0_0x42d1();}class CogniLiving extends utils['Adapter']{constructor(_0x32bda8){const _0x23b355=a0_0x457880;super({..._0x32bda8,'name':_0x23b355(0x29c)}),this[_0x23b355(0x23d)]=[],this[_0x23b355(0x2bc)]=[],this['feedbackHistory']=[],this[_0x23b355(0x1ed)]=[],this[_0x23b355(0x31c)]=[],this[_0x23b355(0x1c5)]={},this[_0x23b355(0x1bc)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x23b355(0x1f3)]=!![],this[_0x23b355(0x2db)]=null,this[_0x23b355(0x2a1)]=null,this[_0x23b355(0x22b)]=![],this[_0x23b355(0x254)]=null,this[_0x23b355(0x21f)]=null,this['currentSystemMode']=SYSTEM_MODES[_0x23b355(0x337)],this[_0x23b355(0x26b)]=![],this[_0x23b355(0x1eb)]=![],this[_0x23b355(0x204)]=_0x23b355(0x1a4),this[_0x23b355(0x1ad)]=null,this[_0x23b355(0x1e4)]=null,this[_0x23b355(0x21d)]=null,this['driftAnalysisTimer']=null,this[_0x23b355(0x2c7)]=null,this['on']('ready',this[_0x23b355(0x31a)][_0x23b355(0x27a)](this)),this['on'](_0x23b355(0x2f9),this[_0x23b355(0x194)]['bind'](this)),this['on']('unload',this['onUnload']['bind'](this)),this['on'](_0x23b355(0x19c),this[_0x23b355(0x1e3)][_0x23b355(0x27a)](this));}async[a0_0x457880(0x31a)](){const _0x567473=a0_0x457880;this[_0x567473(0x293)][_0x567473(0x2a2)](_0x567473(0x245)+this[_0x567473(0x321)]+')');const _0x55846f=[_0x567473(0x257),_0x567473(0x1e7),_0x567473(0x21e),_0x567473(0x2e7),_0x567473(0x310),_0x567473(0x271),_0x567473(0x1be),'events.history_debug_02',_0x567473(0x1c7),_0x567473(0x311)];for(const _0x2714db of _0x55846f){try{const _0x5d63ae=await this[_0x567473(0x264)](_0x2714db);_0x5d63ae&&await this[_0x567473(0x197)](_0x2714db);}catch(_0x38f585){}}this[_0x567473(0x2e2)]['licenseKey']=this[_0x567473(0x2e2)]['licenseKey']||'',this['isProVersion']=await this[_0x567473(0x278)](this[_0x567473(0x2e2)]['licenseKey']);if(!this[_0x567473(0x2e2)][_0x567473(0x225)]||this[_0x567473(0x2e2)][_0x567473(0x225)]<0.1)this['config'][_0x567473(0x225)]=0xc;await this['loadHistoryFromState']();try{const _0x327d91=await this[_0x567473(0x308)](_0x567473(0x1a8));_0x327d91&&_0x327d91[_0x567473(0x332)]&&(this[_0x567473(0x1bc)]={'latitude':_0x327d91[_0x567473(0x332)][_0x567473(0x1b5)]||0x0,'longitude':_0x327d91[_0x567473(0x332)][_0x567473(0x1ae)]||0x0,'city':_0x327d91[_0x567473(0x332)][_0x567473(0x1dc)]||''});}catch(_0x514642){}if(this[_0x567473(0x2e2)][_0x567473(0x1ff)])try{this[_0x567473(0x254)]=new GoogleGenerativeAI(this[_0x567473(0x2e2)][_0x567473(0x1ff)]),this[_0x567473(0x21f)]=this[_0x567473(0x254)][_0x567473(0x1af)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x567473(0x1df)}}),this[_0x567473(0x293)][_0x567473(0x2a2)](_0x567473(0x326));}catch(_0x491e88){this[_0x567473(0x293)][_0x567473(0x258)](_0x567473(0x2ef)+_0x491e88[_0x567473(0x19c)]);}await this[_0x567473(0x1f5)](),await this[_0x567473(0x1a1)](),await this['loadRawEventLog'](),await this[_0x567473(0x202)](),this[_0x567473(0x256)]('analysis.trigger'),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x567473(0x256)](_0x567473(0x2cd)),this['subscribeStates'](_0x567473(0x2bb));const _0x4cc568=this[_0x567473(0x2e2)][_0x567473(0x31b)];if(_0x4cc568&&_0x4cc568[_0x567473(0x2e1)]>0x0){this[_0x567473(0x293)][_0x567473(0x2a2)]('Subscribing\x20to\x20'+_0x4cc568[_0x567473(0x2e1)]+_0x567473(0x1a2));for(const _0x3f4b05 of _0x4cc568){if(_0x3f4b05['id']){await this[_0x567473(0x1cb)](_0x3f4b05['id']);try{const _0x32f8d1=await this['getForeignStateAsync'](_0x3f4b05['id']);if(_0x32f8d1)this[_0x567473(0x1c5)][_0x3f4b05['id']]=_0x32f8d1[_0x567473(0x1b1)];}catch(_0x54884e){}}}}const _0x2fa647=this[_0x567473(0x2e2)][_0x567473(0x2d0)]||[];if(_0x2fa647['length']>0x0){this[_0x567473(0x293)]['info'](_0x567473(0x2cc)+_0x2fa647[_0x567473(0x2e1)]+_0x567473(0x2c4));for(const _0xb89d97 of _0x2fa647){await this[_0x567473(0x1cb)](_0xb89d97);}await this[_0x567473(0x26d)]();}if(this[_0x567473(0x1ad)])clearInterval(this[_0x567473(0x1ad)]);const _0x8c1e57=this[_0x567473(0x2e2)][_0x567473(0x29b)]||0xf;_0x8c1e57>0x0&&(this[_0x567473(0x293)][_0x567473(0x2a2)](_0x567473(0x209)+_0x8c1e57+'\x20min).\x20Watchdog\x20Limit:\x20'+this[_0x567473(0x2e2)]['inactivityThresholdHours']+'h.'),this[_0x567473(0x1ad)]=setInterval(()=>this[_0x567473(0x2f2)](),_0x8c1e57*0x3c*0x3e8)),this[_0x567473(0x192)](),this[_0x567473(0x20b)](),this[_0x567473(0x1ab)](),this[_0x567473(0x242)]();}async[a0_0x457880(0x1c3)](){const _0x58cc8e=a0_0x457880;try{const _0x850173=await this['getStateAsync'](_0x58cc8e(0x2f5));_0x850173&&_0x850173[_0x58cc8e(0x1b1)]&&(this[_0x58cc8e(0x23d)]=JSON[_0x58cc8e(0x25b)](_0x850173[_0x58cc8e(0x1b1)][_0x58cc8e(0x28f)]()));}catch(_0x3cda02){this[_0x58cc8e(0x23d)]=[];}try{const _0xc7bf9a=await this['getStateAsync']('analysis.analysisHistory');if(_0xc7bf9a&&_0xc7bf9a['val'])this['analysisHistory']=JSON[_0x58cc8e(0x25b)](_0xc7bf9a[_0x58cc8e(0x1b1)][_0x58cc8e(0x28f)]());}catch(_0x24780a){this[_0x58cc8e(0x2bc)]=[];}}async[a0_0x457880(0x2b0)](){const _0x372fa4=a0_0x457880;try{const _0x233d9e=await this[_0x372fa4(0x213)](LTM_DP_RAW_LOG);if(_0x233d9e&&_0x233d9e['val'])this[_0x372fa4(0x1ed)]=JSON[_0x372fa4(0x25b)](_0x233d9e[_0x372fa4(0x1b1)]);}catch(_0x255d4f){this['rawEventLog']=[];}}async[a0_0x457880(0x195)](){const _0x3c050d=a0_0x457880;this[_0x3c050d(0x1ed)][_0x3c050d(0x2e1)]>RAW_LOG_MAX_SIZE&&this['rawEventLog']['splice'](0x0,this['rawEventLog'][_0x3c050d(0x2e1)]-RAW_LOG_MAX_SIZE),await this[_0x3c050d(0x1fb)](LTM_DP_RAW_LOG,{'val':JSON[_0x3c050d(0x318)](this[_0x3c050d(0x1ed)]),'ack':!![]});}async[a0_0x457880(0x202)](){const _0x4d01b1=a0_0x457880;try{const _0x10b6ba=await this[_0x4d01b1(0x213)](LTM_DP_DAILY_DIGESTS);if(_0x10b6ba&&_0x10b6ba['val'])this['dailyDigests']=JSON[_0x4d01b1(0x25b)](_0x10b6ba[_0x4d01b1(0x1b1)]);}catch(_0x4d5b25){this[_0x4d01b1(0x31c)]=[];}await this[_0x4d01b1(0x325)]();}async[a0_0x457880(0x2fe)](_0x4188cc=!![]){const _0x284324=a0_0x457880,_0x1bc7f0=this[_0x284324(0x2e2)][_0x284324(0x2cf)]||0x3c;this[_0x284324(0x31c)][_0x284324(0x2e1)]>_0x1bc7f0&&this[_0x284324(0x31c)][_0x284324(0x24d)](0x0,this[_0x284324(0x31c)][_0x284324(0x2e1)]-_0x1bc7f0);await this[_0x284324(0x1fb)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x284324(0x318)](this[_0x284324(0x31c)]),'ack':!![]});if(_0x4188cc)await this[_0x284324(0x325)]();}async[a0_0x457880(0x325)](){const _0x33464a=a0_0x457880;if(!this['isProVersion']){await this[_0x33464a(0x1fb)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x45674a=this[_0x33464a(0x31c)][_0x33464a(0x2e1)]>=(this['config'][_0x33464a(0x2d9)]||0x7)?_0x33464a(0x265)+this[_0x33464a(0x31c)][_0x33464a(0x2e1)]+'\x20Tage)':_0x33464a(0x1b6)+this[_0x33464a(0x31c)][_0x33464a(0x2e1)]+'/'+(this[_0x33464a(0x2e2)][_0x33464a(0x2d9)]||0x7)+')';await this[_0x33464a(0x1fb)](LTM_DP_BASELINE_STATUS,{'val':_0x45674a,'ack':!![]});}async[a0_0x457880(0x2ca)](_0x505e46){const _0x112b00=a0_0x457880;this[_0x112b00(0x2bc)]['unshift'](_0x505e46);if(this[_0x112b00(0x2bc)]['length']>ANALYSIS_HISTORY_MAX_SIZE)this[_0x112b00(0x2bc)][_0x112b00(0x266)]();await this['setStateAsync'](_0x112b00(0x20f),{'val':JSON['stringify'](this[_0x112b00(0x2bc)]),'ack':!![]});}async['getWeatherContext'](){const _0x42fd26=a0_0x457880;if(!this[_0x42fd26(0x2e2)]['useWeather'])return'';let _0xb835c0='';if(this[_0x42fd26(0x2e2)][_0x42fd26(0x2ae)])try{if(this[_0x42fd26(0x2e2)][_0x42fd26(0x2ae)][_0x42fd26(0x246)](_0x42fd26(0x292))){const _0x4f1bae=await this['getForeignStateAsync'](this[_0x42fd26(0x2e2)]['weatherInstance']+'.Summary.Current');if(_0x4f1bae&&_0x4f1bae['val'])_0xb835c0=_0x4f1bae[_0x42fd26(0x1b1)];}else{if(this[_0x42fd26(0x2e2)][_0x42fd26(0x2ae)][_0x42fd26(0x246)]('daswetter')){const _0x5857ea=await this[_0x42fd26(0x328)](this['config'][_0x42fd26(0x2ae)]+_0x42fd26(0x2b8));if(_0x5857ea&&_0x5857ea[_0x42fd26(0x1b1)])_0xb835c0=_0x5857ea[_0x42fd26(0x1b1)];}else{if(this[_0x42fd26(0x2e2)][_0x42fd26(0x2ae)]['includes'](_0x42fd26(0x1d9))){const _0x58100e=await this[_0x42fd26(0x328)](this[_0x42fd26(0x2e2)][_0x42fd26(0x2ae)]+'.forecast.current.state');if(_0x58100e&&_0x58100e[_0x42fd26(0x1b1)])_0xb835c0=_0x58100e['val'];}}}}catch(_0x1f9a85){}if(!_0xb835c0){const _0x1b2ca3=['accuweather.0',_0x42fd26(0x302),_0x42fd26(0x24e),_0x42fd26(0x2b4)];for(const _0x2dacb1 of _0x1b2ca3){try{const _0x3e2f01=await this['getForeignObjectAsync'](_0x2dacb1);if(_0x3e2f01){if(_0x2dacb1[_0x42fd26(0x246)](_0x42fd26(0x292))){const _0x2a7d93=await this[_0x42fd26(0x328)](_0x2dacb1+_0x42fd26(0x2a7));if(_0x2a7d93){_0xb835c0=_0x2a7d93[_0x42fd26(0x1b1)];break;}}}}catch(_0x514489){}}}return _0xb835c0?_0x42fd26(0x227)+_0xb835c0:_0x42fd26(0x1e5);}async[a0_0x457880(0x212)](){const _0x520997=a0_0x457880;if(!this['config'][_0x520997(0x1b8)])return'';let _0x464ea='',_0x40ff30=this[_0x520997(0x2e2)][_0x520997(0x1fd)]||_0x520997(0x1fc);try{const _0x50f035=await this[_0x520997(0x328)](_0x40ff30+_0x520997(0x23c));if(_0x50f035&&_0x50f035[_0x520997(0x1b1)])_0x464ea=_0x50f035[_0x520997(0x1b1)];else{const _0x2ebc28=await this['getForeignStateAsync'](_0x40ff30+_0x520997(0x2ee));_0x2ebc28&&_0x2ebc28[_0x520997(0x1b1)]&&Array[_0x520997(0x236)](_0x2ebc28['val'])&&_0x2ebc28[_0x520997(0x1b1)]['length']>0x0&&(_0x464ea=_0x2ebc28['val']['slice'](0x0,0x3)['map'](_0x2fb3ce=>_0x2fb3ce[_0x520997(0x31d)]+'\x20'+_0x2fb3ce[_0x520997(0x29f)])[_0x520997(0x226)](',\x20'));}}catch(_0x350f51){}return _0x464ea?_0x520997(0x22e)+_0x464ea:'KALENDER:\x20Keine\x20Termine\x20gefunden';}async[a0_0x457880(0x1dd)](_0x314603={}){const _0x6b8cc3=a0_0x457880;this[_0x6b8cc3(0x293)]['info']('Starting\x20Smart\x20Scan\x20with\x20filters:\x20'+JSON[_0x6b8cc3(0x318)](_0x314603));const _0x7eca90=[],_0xfc1cee=_0x314603['motion']!==![],_0x2ad5bc=_0x314603['doors']!==![],_0x2e58b9=_0x314603[_0x6b8cc3(0x1bd)]!==![],_0x40eb9a=_0x314603[_0x6b8cc3(0x1c2)]===!![],_0x1d4fea=_0x314603['weather']===!![],_0x307b7a=_0x314603[_0x6b8cc3(0x219)]||[],_0x205578=await this['getForeignObjectsAsync'](_0x6b8cc3(0x239),'enum'),_0x3d5db7=await this[_0x6b8cc3(0x248)](_0x6b8cc3(0x203),_0x6b8cc3(0x285)),_0x39ac6a={},_0x210ae9={},_0x40b7ed={},_0x53b9e6=(_0x20f797,_0x22aee5,_0x2239df=![])=>{const _0x285c82=_0x6b8cc3;if(!_0x20f797)return;for(const _0x4ff006 in _0x20f797){const _0x3e0568=_0x20f797[_0x4ff006];if(_0x3e0568&&_0x3e0568[_0x285c82(0x332)]&&_0x3e0568['common']['members']){const _0x47611e=(typeof _0x3e0568['common']['name']==='object'?_0x3e0568[_0x285c82(0x332)][_0x285c82(0x198)]['de']:_0x3e0568[_0x285c82(0x332)]['name'])||_0x3e0568[_0x285c82(0x332)][_0x285c82(0x198)];if(_0x2239df)_0x40b7ed[_0x4ff006]=_0x47611e;for(const _0x17488d of _0x3e0568['common'][_0x285c82(0x335)]){if(_0x2239df){if(!_0x22aee5[_0x17488d])_0x22aee5[_0x17488d]=[];_0x22aee5[_0x17488d][_0x285c82(0x2fa)](_0x4ff006);}else _0x22aee5[_0x17488d]=_0x47611e;}}}};_0x53b9e6(_0x205578,_0x39ac6a),_0x53b9e6(_0x3d5db7,_0x210ae9,!![]);const _0x32afc2=await this[_0x6b8cc3(0x248)]('*',_0x6b8cc3(0x281)),_0x2ae616=[_0x6b8cc3(0x2a9),'LOWBAT',_0x6b8cc3(0x1e6),_0x6b8cc3(0x28e),'FAULT','SABOTAGE',_0x6b8cc3(0x32c),_0x6b8cc3(0x1ce),_0x6b8cc3(0x2b7),_0x6b8cc3(0x2ea),_0x6b8cc3(0x230),_0x6b8cc3(0x2d8),_0x6b8cc3(0x2a5),_0x6b8cc3(0x1c4),_0x6b8cc3(0x32e),'COMBINED_PARAMETER',_0x6b8cc3(0x26e),_0x6b8cc3(0x2c6),_0x6b8cc3(0x2b1),_0x6b8cc3(0x32a),_0x6b8cc3(0x2b9),'AES_KEY',_0x6b8cc3(0x1b4),'reachable',_0x6b8cc3(0x2bd),_0x6b8cc3(0x200),_0x6b8cc3(0x1f0),'firmware',_0x6b8cc3(0x321),'connection','info','signal',_0x6b8cc3(0x33a),_0x6b8cc3(0x267),'archetype','alert',_0x6b8cc3(0x2c5),_0x6b8cc3(0x269),_0x6b8cc3(0x299),'xy','ct',_0x6b8cc3(0x282),_0x6b8cc3(0x2c2),_0x6b8cc3(0x22d),_0x6b8cc3(0x26f),_0x6b8cc3(0x2fc),'uniqueid','command','mac\x20address',_0x6b8cc3(0x237),'capabilities',_0x6b8cc3(0x2af),'scriptEnabled',_0x6b8cc3(0x1fa),'javascript.0.script',_0x6b8cc3(0x1fe),_0x6b8cc3(0x24a),'icon',_0x6b8cc3(0x307),_0x6b8cc3(0x235),_0x6b8cc3(0x2a2),'json'];if(!_0x1d4fea)_0x2ae616[_0x6b8cc3(0x2fa)]('wetter',_0x6b8cc3(0x1d5),_0x6b8cc3(0x19e),_0x6b8cc3(0x1b9),'uv',_0x6b8cc3(0x2b5),_0x6b8cc3(0x196));const _0x36ab8d=[_0x6b8cc3(0x19b),'admin.',_0x6b8cc3(0x214),_0x6b8cc3(0x21b),_0x6b8cc3(0x2d3),'material.',_0x6b8cc3(0x224),_0x6b8cc3(0x2e3)];if(!_0x1d4fea)_0x36ab8d[_0x6b8cc3(0x2fa)](_0x6b8cc3(0x244),_0x6b8cc3(0x314),_0x6b8cc3(0x283),_0x6b8cc3(0x25e),'openweathermap.');const _0x5f07ff=(_0x26e273,_0x93dc77,_0x4ab93e=![])=>{const _0x2405ed=_0x6b8cc3,_0x23bcf4=_0x26e273[_0x2405ed(0x21c)]('.');if(_0x93dc77[_0x26e273])return _0x93dc77[_0x26e273];if(_0x23bcf4[_0x2405ed(0x2e1)]>0x2&&_0x93dc77[_0x23bcf4[_0x2405ed(0x29a)](0x0,-0x1)[_0x2405ed(0x226)]('.')])return _0x93dc77[_0x23bcf4['slice'](0x0,-0x1)['join']('.')];if(_0x23bcf4[_0x2405ed(0x2e1)]>0x3&&_0x93dc77[_0x23bcf4['slice'](0x0,-0x2)[_0x2405ed(0x226)]('.')])return _0x93dc77[_0x23bcf4[_0x2405ed(0x29a)](0x0,-0x2)[_0x2405ed(0x226)]('.')];return _0x4ab93e?[]:null;};for(const _0x5e24b3 in _0x32afc2){const _0x172192=_0x32afc2[_0x5e24b3];if(!_0x172192||!_0x172192[_0x6b8cc3(0x332)])continue;if(_0x36ab8d[_0x6b8cc3(0x2eb)](_0xc6db5b=>_0x5e24b3[_0x6b8cc3(0x2cb)](_0xc6db5b)))continue;const _0x2f3e8f=_0x172192[_0x6b8cc3(0x332)]['role']||'',_0x42aac0=(_0x172192[_0x6b8cc3(0x332)][_0x6b8cc3(0x198)]&&typeof _0x172192[_0x6b8cc3(0x332)]['name']===_0x6b8cc3(0x1ba)?_0x172192[_0x6b8cc3(0x332)][_0x6b8cc3(0x198)]['de']:_0x172192['common']['name'])||'',_0x1caf89=_0x42aac0?_0x42aac0['toLowerCase']():'',_0xd25d2c=_0x5e24b3[_0x6b8cc3(0x228)](),_0x7fae20=_0x5f07ff(_0x5e24b3,_0x39ac6a),_0x3a628e=_0x5f07ff(_0x5e24b3,_0x210ae9,!![]);let _0x31833a=null,_0x5775a9=![];if(_0x3a628e&&_0x3a628e[_0x6b8cc3(0x2e1)]>0x0){const _0x1e7dc4=_0x3a628e[_0x6b8cc3(0x2c8)](_0x69f914=>_0x307b7a[_0x6b8cc3(0x246)](_0x69f914));if(_0x1e7dc4){_0x5775a9=!![];const _0x1f1a9a=_0x40b7ed[_0x1e7dc4];if(_0xd25d2c[_0x6b8cc3(0x246)](_0x6b8cc3(0x338))||_0xd25d2c[_0x6b8cc3(0x246)](_0x6b8cc3(0x1c0)))_0x31833a=_0x6b8cc3(0x243);else{if(_0xd25d2c[_0x6b8cc3(0x246)](_0x6b8cc3(0x32d))||_0xd25d2c['includes'](_0x6b8cc3(0x23e))||_0x1caf89[_0x6b8cc3(0x246)]('rauch'))_0x31833a=_0x6b8cc3(0x2c9);else{if(_0xd25d2c[_0x6b8cc3(0x246)]('state')||_0xd25d2c[_0x6b8cc3(0x246)]('level')||_0xd25d2c['includes']('on'))_0x31833a=_0x6b8cc3(0x20d);else _0x31833a=_0x1f1a9a;}}}}if(!_0x5775a9&&!_0x1d4fea){if(_0x2ae616[_0x6b8cc3(0x2eb)](_0x5320dd=>_0x1caf89['includes'](_0x5320dd)||_0x5e24b3['toUpperCase']()[_0x6b8cc3(0x246)](_0x5320dd)))continue;}if(!_0x31833a&&_0xfc1cee){if(_0x2f3e8f['includes'](_0x6b8cc3(0x251))||_0x2f3e8f['includes'](_0x6b8cc3(0x22c))||_0x1caf89[_0x6b8cc3(0x246)](_0x6b8cc3(0x1e8))||_0x1caf89[_0x6b8cc3(0x246)]('pr√§senz'))_0x31833a=_0x6b8cc3(0x243);}!_0x31833a&&_0x2ad5bc&&((_0xd25d2c[_0x6b8cc3(0x246)]('shutter_contact')||_0x2f3e8f[_0x6b8cc3(0x246)](_0x6b8cc3(0x2de))||_0x2f3e8f[_0x6b8cc3(0x246)]('sensor.window')||(_0x1caf89['includes'](_0x6b8cc3(0x20e))||_0x1caf89[_0x6b8cc3(0x246)](_0x6b8cc3(0x1bb)))&&!_0x1caf89['includes'](_0x6b8cc3(0x1cc))&&!_0x1caf89[_0x6b8cc3(0x246)]('griff')&&(_0x172192[_0x6b8cc3(0x332)][_0x6b8cc3(0x2e8)]===_0x6b8cc3(0x211)||_0x172192[_0x6b8cc3(0x332)][_0x6b8cc3(0x2e8)]==='number'))&&(_0x31833a=_0x6b8cc3(0x31f)));if(!_0x31833a&&_0x2e58b9){if((_0x2f3e8f[_0x6b8cc3(0x246)](_0x6b8cc3(0x2dd))||_0x2f3e8f[_0x6b8cc3(0x246)](_0x6b8cc3(0x2ba))||_0x1caf89['includes'](_0x6b8cc3(0x250))||_0x1caf89[_0x6b8cc3(0x246)]('lampe'))&&_0x172192[_0x6b8cc3(0x332)][_0x6b8cc3(0x263)])_0x31833a=_0x6b8cc3(0x301);}if(!_0x31833a&&_0x40eb9a){if(_0x2f3e8f[_0x6b8cc3(0x246)](_0x6b8cc3(0x2ed))||_0x2f3e8f[_0x6b8cc3(0x246)](_0x6b8cc3(0x23f))||_0x1caf89['includes']('temperatur'))_0x31833a=_0x6b8cc3(0x29d);}if(_0x31833a){let _0x35ca0a=_0x7fae20||'';if(!_0x35ca0a){if(_0x1caf89[_0x6b8cc3(0x246)](_0x6b8cc3(0x2e0)))_0x35ca0a=_0x6b8cc3(0x193);else{if(_0x1caf89['includes']('k√ºche'))_0x35ca0a='K√ºche';else{if(_0x1caf89['includes']('wohn'))_0x35ca0a=_0x6b8cc3(0x1aa);else{if(_0x1caf89[_0x6b8cc3(0x246)](_0x6b8cc3(0x252)))_0x35ca0a=_0x6b8cc3(0x1d1);else{if(_0x1caf89[_0x6b8cc3(0x246)]('flur')||_0x1caf89['includes'](_0x6b8cc3(0x1b2)))_0x35ca0a='Flur';else{if(_0x1caf89[_0x6b8cc3(0x246)](_0x6b8cc3(0x333)))_0x35ca0a=_0x6b8cc3(0x1bf);}}}}}}let _0x738dd7=![];_0x31833a===_0x6b8cc3(0x31f)&&((_0x1caf89[_0x6b8cc3(0x246)](_0x6b8cc3(0x229))||_0x1caf89['includes'](_0x6b8cc3(0x1de))||_0x1caf89[_0x6b8cc3(0x246)](_0x6b8cc3(0x2e4))||_0x35ca0a&&_0x35ca0a[_0x6b8cc3(0x228)]()[_0x6b8cc3(0x246)](_0x6b8cc3(0x2a4))&&_0x1caf89[_0x6b8cc3(0x246)](_0x6b8cc3(0x1bb)))&&(_0x738dd7=!![]));let _0x504732=0x0;if(_0x5775a9)_0x504732+=0x1e;else{if(_0x7fae20)_0x504732+=0x14;else{if(_0x35ca0a)_0x504732+=0xa;}}if(_0x738dd7)_0x504732+=0x5;_0x7eca90[_0x6b8cc3(0x2fa)]({'id':_0x5e24b3,'name':_0x42aac0||_0x5e24b3,'type':_0x31833a,'location':_0x35ca0a,'logDuplicates':_0x31833a==='Bewegung','isExit':_0x738dd7,'_score':_0x504732});}}return _0x7eca90[_0x6b8cc3(0x2bf)]((_0x165e46,_0x4eb03b)=>_0x4eb03b['_score']-_0x165e46[_0x6b8cc3(0x1a5)]),_0x7eca90;}async[a0_0x457880(0x26d)](){const _0xa38226=a0_0x457880,_0x3fce40=this[_0xa38226(0x2e2)][_0xa38226(0x2d0)]||[];let _0x8ebdfe=![];for(const _0x20fd57 of _0x3fce40){try{const _0x366545=await this[_0xa38226(0x328)](_0x20fd57);if(_0x366545&&(_0x366545['val']===!![]||_0x366545[_0xa38226(0x1b1)]===_0xa38226(0x30d)||_0x366545[_0xa38226(0x1b1)]===0x1)){_0x8ebdfe=!![];break;}}catch(_0x10c6e9){}}return _0x8ebdfe&&(this[_0xa38226(0x2db)]&&(this[_0xa38226(0x293)]['info']('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),this[_0xa38226(0x1ca)]()),!this[_0xa38226(0x1f3)]&&this[_0xa38226(0x1b7)]===SYSTEM_MODES['NORMAL']&&this[_0xa38226(0x1a7)](!![])),_0x8ebdfe;}async[a0_0x457880(0x194)](_0x3702cc,_0x4b57d8){const _0xd20b86=a0_0x457880;if(!_0x4b57d8)return;if(_0x3702cc===this[_0xd20b86(0x31e)]+'.'+SYSTEM_DP_MODE){_0x4b57d8[_0xd20b86(0x1b1)]&&Object[_0xd20b86(0x1b0)](SYSTEM_MODES)[_0xd20b86(0x246)](_0x4b57d8[_0xd20b86(0x1b1)])&&(this[_0xd20b86(0x1b7)]=_0x4b57d8[_0xd20b86(0x1b1)],_0x4b57d8['val']===SYSTEM_MODES[_0xd20b86(0x286)]?this[_0xd20b86(0x1a7)](![]):this['setPresence'](!![]));if(!_0x4b57d8[_0xd20b86(0x2d6)])this['setState'](_0x3702cc,{'val':this[_0xd20b86(0x1b7)],'ack':!![]});return;}if(!_0x4b57d8['ack']){_0x3702cc['includes'](_0xd20b86(0x1a6))&&_0x4b57d8[_0xd20b86(0x1b1)]&&(this[_0xd20b86(0x1f1)](_0x3702cc,{'val':![],'ack':!![]}),this['runGeminiAnalysis']());if(_0x3702cc[_0xd20b86(0x246)](_0xd20b86(0x1d7))&&_0x4b57d8[_0xd20b86(0x1b1)]){this['setState'](_0x3702cc,{'val':![],'ack':!![]});if(this[_0xd20b86(0x26b)])this['createDailyDigest']();}_0x3702cc[_0xd20b86(0x246)]('triggerBriefing')&&_0x4b57d8[_0xd20b86(0x1b1)]&&(this[_0xd20b86(0x1f1)](_0x3702cc,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this[_0xd20b86(0x2e2)]['presenceDevices']&&this[_0xd20b86(0x2e2)][_0xd20b86(0x2d0)][_0xd20b86(0x246)](_0x3702cc)){await this[_0xd20b86(0x26d)]();return;}const _0x35d30e=(this[_0xd20b86(0x2e2)][_0xd20b86(0x31b)]||[])[_0xd20b86(0x2c8)](_0x102ee8=>_0x102ee8['id']===_0x3702cc);if(_0x35d30e)this['processSensorEvent'](_0x3702cc,_0x4b57d8,_0x35d30e);}async[a0_0x457880(0x27d)](_0x538d5a,_0x3e8611,_0x256f88){const _0x27c5fe=a0_0x457880;if(!_0x256f88[_0x27c5fe(0x298)]&&this['sensorLastValues'][_0x538d5a]===_0x3e8611[_0x27c5fe(0x1b1)])return;this[_0x27c5fe(0x1c5)][_0x538d5a]=_0x3e8611['val'];if(this[_0x27c5fe(0x22b)])return;const _0x1e2303=await this[_0x27c5fe(0x26d)]();if(_0x1e2303){if(!this['isPresent'])this['setPresence'](!![]);}else{const _0x29148c=_0x256f88['isExit']===!![];_0x29148c?this['startExitTimer']():(this[_0x27c5fe(0x2db)]&&(this['log']['info'](_0x27c5fe(0x2be)),this[_0x27c5fe(0x1ca)]()),!this[_0x27c5fe(0x1f3)]&&this[_0x27c5fe(0x1b7)]===SYSTEM_MODES[_0x27c5fe(0x337)]&&this[_0x27c5fe(0x1a7)](!![]));}const _0x7b1980={'timestamp':_0x3e8611['ts'],'id':_0x538d5a,'name':_0x256f88['name'],'value':_0x3e8611['val'],'location':_0x256f88['location'],'type':_0x256f88[_0x27c5fe(0x2e8)]};this['eventHistory'][_0x27c5fe(0x274)](_0x7b1980);if(this[_0x27c5fe(0x23d)][_0x27c5fe(0x2e1)]>HISTORY_MAX_SIZE)this['eventHistory'][_0x27c5fe(0x266)]();await this[_0x27c5fe(0x1fb)](_0x27c5fe(0x270),{'val':JSON[_0x27c5fe(0x318)](_0x7b1980),'ack':!![]}),await this[_0x27c5fe(0x1fb)]('events.history',{'val':JSON[_0x27c5fe(0x318)](this['eventHistory']),'ack':!![]}),this['rawEventLog']['push']({'timestamp':new Date(_0x3e8611['ts'])[_0x27c5fe(0x1ee)](),'sensorName':_0x256f88['name'],'location':_0x256f88[_0x27c5fe(0x2d1)],'value':_0x3e8611[_0x27c5fe(0x1b1)]}),await this[_0x27c5fe(0x195)]();}[a0_0x457880(0x319)](){const _0x3ab83b=a0_0x457880;this[_0x3ab83b(0x1ca)](),this[_0x3ab83b(0x22b)]=!![],this[_0x3ab83b(0x2a1)]=setTimeout(()=>{this['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x3ab83b(0x2db)]=setTimeout(()=>{const _0x5f071a=_0x3ab83b;this[_0x5f071a(0x1a7)](![]),this[_0x5f071a(0x2db)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x457880(0x1ca)](){const _0x3af609=a0_0x457880;if(this['exitTimer'])clearTimeout(this[_0x3af609(0x2db)]);if(this[_0x3af609(0x2a1)])clearTimeout(this[_0x3af609(0x2a1)]);this[_0x3af609(0x2db)]=null,this[_0x3af609(0x2a1)]=null,this[_0x3af609(0x22b)]=![];}async[a0_0x457880(0x1a7)](_0x531a81){const _0x267996=a0_0x457880;if(this[_0x267996(0x1f3)]===_0x531a81)return;this[_0x267996(0x1f3)]=_0x531a81,await this[_0x267996(0x1fb)](_0x267996(0x2e9),{'val':_0x531a81,'ack':!![]});}[a0_0x457880(0x2f2)](){const _0x4ec1dc=a0_0x457880,_0x2fd19e=this[_0x4ec1dc(0x2e2)][_0x4ec1dc(0x225)],_0x5b4363=this[_0x4ec1dc(0x2e2)][_0x4ec1dc(0x2d4)],_0x355927=this['eventHistory'][_0x4ec1dc(0x2e1)]>0x0?this[_0x4ec1dc(0x23d)][0x0][_0x4ec1dc(0x19a)]:Date['now'](),_0x1df84c=(Date[_0x4ec1dc(0x1f2)]()-_0x355927)/(0x3e8*0x3c*0x3c);let _0x223191='';_0x5b4363&&this[_0x4ec1dc(0x1b7)]===SYSTEM_MODES['NORMAL']&&this['isPresent']&&(_0x1df84c>_0x2fd19e&&(_0x223191=_0x4ec1dc(0x25a)+_0x1df84c['toFixed'](0x1)+_0x4ec1dc(0x275)));if(_0x223191){this[_0x4ec1dc(0x2f0)](_0x223191)[_0x4ec1dc(0x2d7)](_0x88a935=>this[_0x4ec1dc(0x293)][_0x4ec1dc(0x258)](_0x88a935));return;}const _0x120213=Date[_0x4ec1dc(0x1f2)](),_0x20f29a=_0x120213-_0x355927,_0x5d1118=(this[_0x4ec1dc(0x2e2)][_0x4ec1dc(0x29b)]||0xf)*0x3c*0x3e8;this[_0x4ec1dc(0x23d)][_0x4ec1dc(0x2e1)]>0x0&&_0x20f29a<=_0x5d1118?this[_0x4ec1dc(0x2f0)]()[_0x4ec1dc(0x2d7)](_0x176179=>this[_0x4ec1dc(0x293)][_0x4ec1dc(0x258)](_0x176179)):!this[_0x4ec1dc(0x1eb)]&&(this[_0x4ec1dc(0x1f1)]('analysis.isAlert',{'val':![],'ack':!![]}),this[_0x4ec1dc(0x1f1)](_0x4ec1dc(0x2fd),{'val':![],'ack':!![]}));}async[a0_0x457880(0x2f0)](_0x208836=''){const _0x2b0c78=a0_0x457880;if(!this['geminiModel'])return;const _0x5cd26a=this[_0x2b0c78(0x23d)][_0x2b0c78(0x2e1)]>0x0?this['eventHistory']:[{'note':_0x2b0c78(0x1cf)}],_0x1feb8c=PERSONA_MAPPING[this['config'][_0x2b0c78(0x2f3)]||_0x2b0c78(0x322)],_0x5eab61=this[_0x2b0c78(0x2e2)][_0x2b0c78(0x279)]||'',_0x5b60d5=this[_0x2b0c78(0x1b7)],_0x3961d7=await this[_0x2b0c78(0x261)](),_0x4ecc19=await this[_0x2b0c78(0x212)](),_0x299ec1=(_0x3961d7+'\x20'+_0x4ecc19)[_0x2b0c78(0x327)](),_0x4ea583=new Date(),_0x510131=_0x4ea583['toLocaleString']('de-DE',{'weekday':_0x2b0c78(0x1d8),'hour':_0x2b0c78(0x2ec),'minute':'2-digit'}),_0x7c4998=this[_0x2b0c78(0x1bc)];let _0x534020='';if(this[_0x2b0c78(0x1d4)][_0x2b0c78(0x2e1)]>0x0){const _0xd0813b=this[_0x2b0c78(0x1d4)][_0x2b0c78(0x29a)](0x0,0x3)[_0x2b0c78(0x329)](_0x7d79d1=>'User\x20Feedback:\x20Alarm\x20\x22'+_0x7d79d1[_0x2b0c78(0x2c0)]+_0x2b0c78(0x1e9)+_0x7d79d1['rating']+'.')['join']('\x0a');_0x534020=_0x2b0c78(0x260)+_0xd0813b+'\x0a';}const _0x30cf45=_0x208836?'\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a'+_0x208836+_0x2b0c78(0x1ea):'',_0x1abf0c='Baseline:\x20Inactive\x20(Pro\x20Feature).',_0x10b82e=_0x2b0c78(0x304)+_0x510131+'.\x20ORT:\x20'+_0x7c4998[_0x2b0c78(0x1dc)]+_0x2b0c78(0x218)+_0x5b60d5+_0x2b0c78(0x2f4)+(this[_0x2b0c78(0x1f3)]?'Ja':_0x2b0c78(0x2ab))+_0x2b0c78(0x2c3)+_0x5eab61+'.\x20PERSONA:\x20'+_0x1feb8c+_0x2b0c78(0x28d)+_0x299ec1+_0x2b0c78(0x1c6)+_0x1abf0c+'\x20'+_0x534020+'\x20'+_0x30cf45+_0x2b0c78(0x238)+JSON[_0x2b0c78(0x318)](_0x5cd26a)+_0x2b0c78(0x247);try{const _0xf4318c=await this[_0x2b0c78(0x21f)][_0x2b0c78(0x313)](_0x10b82e),_0x3a99fd=_0xf4318c['response']['text']()['replace'](/```json|```/g,'')[_0x2b0c78(0x327)](),_0x4b19e5=JSON['parse'](_0x3a99fd);await this[_0x2b0c78(0x1fb)]('analysis.lastResult',{'val':_0x3a99fd,'ack':!![]}),await this[_0x2b0c78(0x1fb)](_0x2b0c78(0x268),{'val':_0x4b19e5[_0x2b0c78(0x28b)][_0x2b0c78(0x2c0)]||'','ack':!![]}),await this[_0x2b0c78(0x1fb)](_0x2b0c78(0x324),{'val':_0x4b19e5[_0x2b0c78(0x28b)]['summary']||_0x2b0c78(0x272),'ack':!![]}),await this[_0x2b0c78(0x1fb)](_0x2b0c78(0x289),{'val':_0x4b19e5[_0x2b0c78(0x28b)][_0x2b0c78(0x2e5)]||_0x2b0c78(0x272),'ack':!![]});_0x4b19e5['comfort']&&(await this['setStateAsync'](_0x2b0c78(0x233),{'val':_0x4b19e5[_0x2b0c78(0x1c9)][_0x2b0c78(0x24a)]||'','ack':!![]}),await this[_0x2b0c78(0x1fb)](_0x2b0c78(0x291),{'val':_0x4b19e5[_0x2b0c78(0x1c9)]['suggestion']||'','ack':!![]}),_0x4b19e5['comfort'][_0x2b0c78(0x294)]&&(await this[_0x2b0c78(0x1fb)](_0x2b0c78(0x30c),{'val':_0x4b19e5['comfort'][_0x2b0c78(0x294)][_0x2b0c78(0x2f7)]||![],'ack':!![]}),await this[_0x2b0c78(0x1fb)]('analysis.automation.description',{'val':_0x4b19e5[_0x2b0c78(0x1c9)][_0x2b0c78(0x294)][_0x2b0c78(0x237)]||'','ack':!![]}),await this[_0x2b0c78(0x1fb)]('analysis.automation.suggestedAction',{'val':_0x4b19e5[_0x2b0c78(0x1c9)][_0x2b0c78(0x294)][_0x2b0c78(0x1f8)]||'','ack':!![]})));_0x4b19e5[_0x2b0c78(0x19f)]&&(await this[_0x2b0c78(0x1fb)](_0x2b0c78(0x27b),{'val':typeof _0x4b19e5['health'][_0x2b0c78(0x1f7)]==='number'?_0x4b19e5[_0x2b0c78(0x19f)][_0x2b0c78(0x1f7)]:0x0,'ack':!![]}),await this[_0x2b0c78(0x1fb)](_0x2b0c78(0x249),{'val':_0x4b19e5[_0x2b0c78(0x19f)][_0x2b0c78(0x210)]||_0x2b0c78(0x2d2),'ack':!![]}),await this[_0x2b0c78(0x1fb)](_0x2b0c78(0x2ff),{'val':_0x4b19e5['health'][_0x2b0c78(0x205)]||'','ack':!![]}));const _0x28e5db=_0x4b19e5[_0x2b0c78(0x28b)]['isAlert']||![],_0x3bffbf=_0x4b19e5['activity'][_0x2b0c78(0x259)]||![];if(_0x28e5db||_0x3bffbf){await this['setStateAsync']('analysis.isAlert',{'val':!![],'ack':!![]}),await this['setStateAsync']('analysis.isEmergency',{'val':_0x3bffbf,'ack':!![]});if(!this[_0x2b0c78(0x1eb)]||_0x3bffbf){const _0x17b7fc=_0x3bffbf?_0x2b0c78(0x290):_0x2b0c78(0x199);this[_0x2b0c78(0x331)](_0x17b7fc+':\x20'+_0x4b19e5[_0x2b0c78(0x28b)]['alertReason'],![],_0x3bffbf);}}else await this[_0x2b0c78(0x1fb)]('analysis.isAlert',{'val':![],'ack':!![]}),await this['setStateAsync'](_0x2b0c78(0x2fd),{'val':![],'ack':!![]});this[_0x2b0c78(0x1eb)]=_0x28e5db||_0x3bffbf;const _0x551f40={'timestamp':Date[_0x2b0c78(0x1f2)](),'id':Date[_0x2b0c78(0x1f2)]()[_0x2b0c78(0x28f)](),'analysis':_0x4b19e5,'systemMode':_0x5b60d5,'isPro':this['isProVersion']};this[_0x2b0c78(0x2ca)](_0x551f40);}catch(_0x58ce58){this[_0x2b0c78(0x293)][_0x2b0c78(0x258)](_0x2b0c78(0x2dc)+_0x58ce58[_0x2b0c78(0x19c)]);}}async['createDailyDigest'](){const _0x147e24=a0_0x457880;if(!this['geminiModel']||this['rawEventLog'][_0x147e24(0x2e1)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x147e24(0x297),'ack':!![]});return;}this[_0x147e24(0x293)][_0x147e24(0x2a2)](_0x147e24(0x28a)+this['rawEventLog'][_0x147e24(0x2e1)]+_0x147e24(0x317)),await this[_0x147e24(0x1fb)](LTM_DP_STATUS,{'val':_0x147e24(0x1c1),'ack':!![]});const _0x314025=this[_0x147e24(0x1ed)][_0x147e24(0x2e1)]>0x320?this[_0x147e24(0x1ed)]['slice'](this[_0x147e24(0x1ed)][_0x147e24(0x2e1)]-0x320):this[_0x147e24(0x1ed)],_0x3b1773=PERSONA_MAPPING[this[_0x147e24(0x2e2)][_0x147e24(0x2f3)]||_0x147e24(0x322)],_0x5ee25e='ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20'+_0x3b1773+_0x147e24(0x26c)+JSON['stringify'](_0x314025)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}';try{const _0x31c468=await this[_0x147e24(0x21f)][_0x147e24(0x313)](_0x5ee25e),_0x11f0ce=_0x31c468[_0x147e24(0x22a)][_0x147e24(0x24b)]()[_0x147e24(0x300)](/```json|```/g,'')[_0x147e24(0x327)](),_0x36b778=JSON[_0x147e24(0x25b)](_0x11f0ce),_0x34b2d8={'timestamp':new Date()[_0x147e24(0x1ee)](),'eventCount':this['rawEventLog'][_0x147e24(0x2e1)],'summary':_0x36b778[_0x147e24(0x24a)],'activityLevel':_0x36b778[_0x147e24(0x316)],'health':{'sleepScore':_0x36b778['health']?_0x36b778[_0x147e24(0x19f)][_0x147e24(0x1f7)]:0x0,'restlessness':_0x36b778[_0x147e24(0x19f)]?_0x36b778[_0x147e24(0x19f)][_0x147e24(0x210)]:'none'},'systemMode':this[_0x147e24(0x1b7)]};this[_0x147e24(0x31c)][_0x147e24(0x2fa)](_0x34b2d8),await this[_0x147e24(0x2fe)](),this['rawEventLog']=[],await this[_0x147e24(0x195)](),await this[_0x147e24(0x1fb)](LTM_DP_STATUS,{'val':'Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','ack':!![]}),this[_0x147e24(0x293)][_0x147e24(0x2a2)](_0x147e24(0x221));}catch(_0x199bcc){this[_0x147e24(0x293)]['error'](_0x147e24(0x25d)+_0x199bcc[_0x147e24(0x19c)]),await this[_0x147e24(0x1fb)](LTM_DP_STATUS,{'val':_0x147e24(0x23a)+_0x199bcc['message'],'ack':!![]});}}[a0_0x457880(0x242)](){const _0x69d86a=a0_0x457880;if(this[_0x69d86a(0x2c7)])this[_0x69d86a(0x2c7)]['cancel']();if(!this[_0x69d86a(0x2e2)][_0x69d86a(0x2da)])return;const _0x59717d=(this['config']['briefingTime']||_0x69d86a(0x217))['split'](':'),_0x371d08=parseInt(_0x59717d[0x0])||0x8,_0xfa2f05=parseInt(_0x59717d[0x1])||0x0,_0x1fc773=_0xfa2f05+'\x20'+_0x371d08+_0x69d86a(0x30f);this[_0x69d86a(0x293)][_0x69d86a(0x2a2)](_0x69d86a(0x20c)+_0x371d08+':'+(_0xfa2f05<0xa?'0'+_0xfa2f05:_0xfa2f05)),this[_0x69d86a(0x2c7)]=schedule[_0x69d86a(0x232)](_0x1fc773,()=>{const _0x2ba36b=_0x69d86a;this[_0x2ba36b(0x1a0)]();});}async[a0_0x457880(0x1a0)](){const _0x349b60=a0_0x457880;if(!this['geminiModel'])return;this[_0x349b60(0x293)][_0x349b60(0x2a2)]('Generating\x20Morning\x20Briefing...');const _0x51b0cf=this['dailyDigests'][_0x349b60(0x2e1)]>0x0?this['dailyDigests'][this[_0x349b60(0x31c)][_0x349b60(0x2e1)]-0x1]:null,_0x3a6f0c=_0x51b0cf&&_0x51b0cf[_0x349b60(0x19f)]?_0x51b0cf[_0x349b60(0x19f)][_0x349b60(0x1f7)]:_0x349b60(0x272),_0x159147=new Date();_0x159147[_0x349b60(0x1db)](0x4,0x0,0x0,0x0);const _0x2d9d30=this['eventHistory']['filter'](_0x3d5864=>new Date(_0x3d5864[_0x349b60(0x19a)])>_0x159147),_0x4557b5=PERSONA_MAPPING[this[_0x349b60(0x2e2)][_0x349b60(0x2f3)]||'generic'],_0x2893ab=this[_0x349b60(0x2e2)][_0x349b60(0x279)]||'',_0x4b9b95=await this[_0x349b60(0x261)](),_0x19e781=await this[_0x349b60(0x212)](),_0x32b753=_0x349b60(0x2a6)+_0x4557b5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20'+_0x2893ab+_0x349b60(0x288)+_0x4b9b95+'\x20'+_0x19e781+_0x349b60(0x262)+_0x3a6f0c+'/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20'+JSON['stringify'](_0x2d9d30[_0x349b60(0x29a)](0x0,0xa))+_0x349b60(0x1ec);try{const _0x68c9fb=await this[_0x349b60(0x21f)][_0x349b60(0x313)](_0x32b753),_0x4c6313=_0x349b60(0x1a9)+_0x68c9fb['response']['text']()[_0x349b60(0x327)]();this[_0x349b60(0x331)](_0x4c6313),this['log']['info']('Morning\x20Briefing\x20sent.');}catch(_0x389397){this['log'][_0x349b60(0x258)](_0x349b60(0x208)+_0x389397['message']);}}[a0_0x457880(0x20b)](){const _0x517f56=a0_0x457880;if(this[_0x517f56(0x21d)])this['modeResetJob'][_0x517f56(0x1da)]();this['modeResetJob']=schedule[_0x517f56(0x232)](MODE_RESET_SCHEDULE,async()=>{const _0x4c580c=_0x517f56;await this['loadSystemMode'](),AUTO_RESET_MODES[_0x4c580c(0x246)](this['currentSystemMode'])&&await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}['setupDriftAnalysisScheduler'](){const _0x3547cf=a0_0x457880;if(this['driftAnalysisTimer'])clearInterval(this[_0x3547cf(0x2f6)]);if(!this[_0x3547cf(0x26b)])return;this[_0x3547cf(0x2f6)]=setInterval(()=>this[_0x3547cf(0x2aa)](),(this[_0x3547cf(0x2e2)][_0x3547cf(0x1d0)]||0x18)*0x36ee80),setTimeout(()=>this[_0x3547cf(0x2aa)](),0x1388);}async[a0_0x457880(0x206)](){const _0x4f85c5=a0_0x457880;await this['extendObjectAsync'](_0x4f85c5(0x25c),{'type':_0x4f85c5(0x2ce),'common':{'name':'LTM'},'native':{}}),await this[_0x4f85c5(0x27c)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x4f85c5(0x20a),'type':_0x4f85c5(0x1ef),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x4f85c5(0x27c)](LTM_DP_DAILY_DIGESTS,{'type':_0x4f85c5(0x281),'common':{'name':_0x4f85c5(0x295),'type':'string','role':_0x4f85c5(0x2b3),'read':!![],'write':![]},'native':{}}),await this[_0x4f85c5(0x27c)](LTM_DP_STATUS,{'type':_0x4f85c5(0x281),'common':{'name':_0x4f85c5(0x2f1),'type':_0x4f85c5(0x1ef),'role':_0x4f85c5(0x24b),'read':!![],'write':![]},'native':{}}),await this[_0x4f85c5(0x27c)](LTM_DP_TRIGGER_DIGEST,{'type':_0x4f85c5(0x281),'common':{'name':'Trigger\x20Digest','type':_0x4f85c5(0x211),'role':_0x4f85c5(0x27f),'read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x4f85c5(0x281),'common':{'name':_0x4f85c5(0x2b6),'type':_0x4f85c5(0x1ef),'role':'text','read':!![],'write':![]},'native':{}});}async['checkLtmDriftObjects'](){const _0x2b227f=a0_0x457880;await this['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x2b227f(0x2ce),'common':{'name':'Drift\x20Analysis'},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x2b227f(0x281),'common':{'name':'Drift\x20Status','type':'string','role':_0x2b227f(0x281),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this[_0x2b227f(0x27c)](LTM_DP_DRIFT_DETAILS,{'type':_0x2b227f(0x281),'common':{'name':_0x2b227f(0x240),'type':'string','role':_0x2b227f(0x24b),'read':!![],'write':![]},'native':{}}),await this[_0x2b227f(0x27c)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x2b227f(0x281),'common':{'name':_0x2b227f(0x284),'type':_0x2b227f(0x305),'role':'date','read':!![],'write':![]},'native':{}});}async[a0_0x457880(0x2aa)](){const _0x50643b=a0_0x457880;if(!this['isProVersion']||!this[_0x50643b(0x21f)])return;const _0x58b70d=this[_0x50643b(0x2e2)][_0x50643b(0x287)]||0xe;if(this['dailyDigests'][_0x50643b(0x2e1)]<_0x58b70d+(this[_0x50643b(0x2e2)][_0x50643b(0x2d9)]||0x7)){await this[_0x50643b(0x1fb)](LTM_DP_DRIFT_STATUS,{'val':_0x50643b(0x28c),'ack':!![]});return;}const _0x343148=this[_0x50643b(0x31c)][_0x50643b(0x29a)](-_0x58b70d),_0x58da91=this[_0x50643b(0x31c)][_0x50643b(0x29a)](0x0,this[_0x50643b(0x31c)][_0x50643b(0x2e1)]-_0x58b70d),_0x4a7c9f=_0x50643b(0x323)+JSON['stringify'](_0x58da91)+_0x50643b(0x222)+JSON[_0x50643b(0x318)](_0x343148);try{const _0x3e2385=await this[_0x50643b(0x21f)]['generateContent'](_0x4a7c9f),_0x24db42=JSON['parse'](_0x3e2385[_0x50643b(0x22a)]['text']()[_0x50643b(0x300)](/```json|```/g,'')[_0x50643b(0x327)]());_0x24db42['baselineDrift']&&(await this[_0x50643b(0x1fb)](LTM_DP_DRIFT_STATUS,{'val':_0x24db42[_0x50643b(0x223)],'ack':!![]}),await this[_0x50643b(0x1fb)](LTM_DP_DRIFT_DETAILS,{'val':_0x24db42[_0x50643b(0x2c1)],'ack':!![]}),await this[_0x50643b(0x1fb)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x50643b(0x1f2)](),'ack':!![]}));}catch(_0x4c0e0c){}}async[a0_0x457880(0x1a1)](){const _0x4516a9=a0_0x457880;try{const _0x5f9b0a=await this[_0x4516a9(0x213)](SYSTEM_DP_MODE);_0x5f9b0a&&_0x5f9b0a[_0x4516a9(0x1b1)]&&Object[_0x4516a9(0x1b0)](SYSTEM_MODES)['includes'](_0x5f9b0a[_0x4516a9(0x1b1)])?this[_0x4516a9(0x1b7)]=_0x5f9b0a[_0x4516a9(0x1b1)]:(this['currentSystemMode']=SYSTEM_MODES[_0x4516a9(0x337)],await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x4516a9(0x337)],'ack':!![]}));}catch(_0x36b6f5){this[_0x4516a9(0x1b7)]=SYSTEM_MODES[_0x4516a9(0x337)];}}async[a0_0x457880(0x303)](){const _0x9b9613=a0_0x457880;try{const _0x4ded2d=await this[_0x9b9613(0x308)](_0x9b9613(0x339));if(_0x4ded2d&&_0x4ded2d[_0x9b9613(0x312)]&&_0x4ded2d[_0x9b9613(0x312)][_0x9b9613(0x215)])return _0x4ded2d[_0x9b9613(0x312)][_0x9b9613(0x215)];return _0x9b9613(0x30a);}catch(_0x1f66a8){return _0x9b9613(0x29e);}}async[a0_0x457880(0x278)](_0x8b5739){const _0x4328f7=a0_0x457880;if(!_0x8b5739)return![];this['systemUUID']=await this[_0x4328f7(0x303)]();if(_0x8b5739==='TEST-PRO-KEY'||_0x8b5739[_0x4328f7(0x2cb)](_0x4328f7(0x2b2)))return!![];return![];}[a0_0x457880(0x1c8)](_0x107dbc){const _0x149d13=a0_0x457880;if(this[_0x149d13(0x1ad)])clearInterval(this[_0x149d13(0x1ad)]);if(this[_0x149d13(0x2f6)])clearInterval(this[_0x149d13(0x2f6)]);if(this[_0x149d13(0x1e4)])this[_0x149d13(0x1e4)][_0x149d13(0x1da)]();if(this['modeResetJob'])this[_0x149d13(0x21d)][_0x149d13(0x1da)]();if(this[_0x149d13(0x2c7)])this[_0x149d13(0x2c7)]['cancel']();if(this[_0x149d13(0x2db)])clearTimeout(this['exitTimer']);if(this[_0x149d13(0x2a1)])clearTimeout(this[_0x149d13(0x2a1)]);_0x107dbc();}async[a0_0x457880(0x1e3)](_0x295864){const _0x5ed8a7=a0_0x457880;if(typeof _0x295864===_0x5ed8a7(0x1ba)&&_0x295864['message']){if(_0x295864[_0x5ed8a7(0x1e0)]===_0x5ed8a7(0x1cd)){if(!_0x295864[_0x5ed8a7(0x19c)]['apiKey'])return this[_0x5ed8a7(0x273)](_0x295864['from'],_0x295864['command'],{'success':![],'message':'No\x20Key'},_0x295864[_0x5ed8a7(0x1d2)]);try{const _0x1f3b6c=new GoogleGenerativeAI(_0x295864[_0x5ed8a7(0x19c)][_0x5ed8a7(0x201)])['getGenerativeModel']({'model':_0x5ed8a7(0x2a3)});await _0x1f3b6c[_0x5ed8a7(0x313)]('test'),this[_0x5ed8a7(0x273)](_0x295864[_0x5ed8a7(0x26a)],_0x295864[_0x5ed8a7(0x1e0)],{'success':!![],'message':'Success'},_0x295864[_0x5ed8a7(0x1d2)]);}catch(_0x12e9d5){this[_0x5ed8a7(0x273)](_0x295864[_0x5ed8a7(0x26a)],_0x295864[_0x5ed8a7(0x1e0)],{'success':![],'message':_0x12e9d5['message']},_0x295864['callback']);}}else{if(_0x295864[_0x5ed8a7(0x1e0)]===_0x5ed8a7(0x1d6)){const _0x2a40ee=await this[_0x5ed8a7(0x331)](_0x5ed8a7(0x320),!![]);this[_0x5ed8a7(0x273)](_0x295864['from'],_0x295864[_0x5ed8a7(0x1e0)],{'success':_0x2a40ee>0x0,'message':_0x2a40ee+_0x5ed8a7(0x296)},_0x295864['callback']);}else{if(_0x295864[_0x5ed8a7(0x1e0)]===_0x5ed8a7(0x23b)){if(!this[_0x5ed8a7(0x26b)])return this[_0x5ed8a7(0x273)](_0x295864[_0x5ed8a7(0x26a)],_0x295864['command'],{'success':![],'isPro':![]},_0x295864[_0x5ed8a7(0x1d2)]);let _0x55fe81={'status':_0x5ed8a7(0x272),'details':'','lastCheck':0x0};try{_0x55fe81[_0x5ed8a7(0x1e2)]=(await this[_0x5ed8a7(0x213)](LTM_DP_DRIFT_STATUS))['val'],_0x55fe81[_0x5ed8a7(0x315)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))['val'],_0x55fe81[_0x5ed8a7(0x1e1)]=(await this[_0x5ed8a7(0x213)](LTM_DP_DRIFT_LAST_CHECK))[_0x5ed8a7(0x1b1)];}catch(_0x2e63db){}this[_0x5ed8a7(0x273)](_0x295864[_0x5ed8a7(0x26a)],_0x295864['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x55fe81,'analysisHistory':this[_0x5ed8a7(0x2bc)]},_0x295864[_0x5ed8a7(0x1d2)]);}else{if(_0x295864[_0x5ed8a7(0x1e0)]===_0x5ed8a7(0x241)){const _0xacc837=await this[_0x5ed8a7(0x248)]('enum.functions.*',_0x5ed8a7(0x285)),_0x4d59f7=[];if(_0xacc837)for(const _0x6c933b in _0xacc837){const _0x150c48=_0xacc837[_0x6c933b],_0x55befd=(_0x150c48[_0x5ed8a7(0x332)]&&typeof _0x150c48[_0x5ed8a7(0x332)][_0x5ed8a7(0x198)]===_0x5ed8a7(0x1ba)?_0x150c48['common'][_0x5ed8a7(0x198)]['de']:_0x150c48[_0x5ed8a7(0x332)][_0x5ed8a7(0x198)])||_0x150c48['common'][_0x5ed8a7(0x198)];_0x4d59f7[_0x5ed8a7(0x2fa)]({'id':_0x6c933b,'name':_0x55befd});}this['sendTo'](_0x295864[_0x5ed8a7(0x26a)],_0x295864[_0x5ed8a7(0x1e0)],{'success':!![],'enums':_0x4d59f7},_0x295864[_0x5ed8a7(0x1d2)]);}else{if(_0x295864[_0x5ed8a7(0x1e0)]===_0x5ed8a7(0x1f9))try{const _0x1f74dc=await this['scanForDevices'](_0x295864['message']||{});this['sendTo'](_0x295864[_0x5ed8a7(0x26a)],_0x295864[_0x5ed8a7(0x1e0)],{'success':!![],'devices':_0x1f74dc},_0x295864[_0x5ed8a7(0x1d2)]);}catch(_0x25414b){this[_0x5ed8a7(0x273)](_0x295864[_0x5ed8a7(0x26a)],_0x295864[_0x5ed8a7(0x1e0)],{'success':![],'error':_0x25414b[_0x5ed8a7(0x19c)]},_0x295864['callback']);}else{if(_0x295864[_0x5ed8a7(0x1e0)]==='submitFeedback'){const {historyId:_0x3a2423,rating:_0x3f72d3,comment:_0x548e8d,alertReason:_0x3d16c0}=_0x295864[_0x5ed8a7(0x19c)];_0x3a2423&&_0x3f72d3?(await this[_0x5ed8a7(0x1b3)]({'timestamp':Date[_0x5ed8a7(0x1f2)](),'historyId':_0x3a2423,'rating':_0x3f72d3,'comment':_0x548e8d,'alertReason':_0x3d16c0}),this[_0x5ed8a7(0x273)](_0x295864['from'],_0x295864[_0x5ed8a7(0x1e0)],{'success':!![]},_0x295864[_0x5ed8a7(0x1d2)])):this[_0x5ed8a7(0x273)](_0x295864['from'],_0x295864[_0x5ed8a7(0x1e0)],{'success':![],'error':_0x5ed8a7(0x2e6)},_0x295864[_0x5ed8a7(0x1d2)]);}else{if(_0x295864[_0x5ed8a7(0x1e0)]===_0x5ed8a7(0x1ac)){const _0x37656b=await this[_0x5ed8a7(0x261)](),_0x521810=await this[_0x5ed8a7(0x212)]();this[_0x5ed8a7(0x273)](_0x295864[_0x5ed8a7(0x26a)],_0x295864[_0x5ed8a7(0x1e0)],{'success':!![],'weather':_0x37656b,'calendar':_0x521810},_0x295864[_0x5ed8a7(0x1d2)]);}}}}}}}}}}if(require[a0_0x457880(0x22f)]!==module)module[a0_0x457880(0x306)]=_0x1fa2df=>new CogniLiving(_0x1fa2df);else new CogniLiving();