const a0_0x4a785e=a0_0x2587;function a0_0x2587(_0xcfe124,_0x336f60){const _0x473cc1=a0_0x2454();return a0_0x2587=function(_0x1b7555,_0x18a9ee){_0x1b7555=_0x1b7555-0xf4;let _0x2454d5=_0x473cc1[_0x1b7555];return _0x2454d5;},a0_0x2587(_0xcfe124,_0x336f60);}(function(_0x590d34,_0x49c855){const _0x35123d=a0_0x2587,_0x4a0b42=_0x590d34();while(!![]){try{const _0x3618a6=parseInt(_0x35123d(0x10c))/0x1*(parseInt(_0x35123d(0x140))/0x2)+-parseInt(_0x35123d(0x1cf))/0x3*(-parseInt(_0x35123d(0x1b3))/0x4)+parseInt(_0x35123d(0x139))/0x5*(parseInt(_0x35123d(0x133))/0x6)+-parseInt(_0x35123d(0x190))/0x7*(-parseInt(_0x35123d(0x1b8))/0x8)+-parseInt(_0x35123d(0x1ad))/0x9*(-parseInt(_0x35123d(0x119))/0xa)+parseInt(_0x35123d(0x1e9))/0xb+-parseInt(_0x35123d(0x16e))/0xc;if(_0x3618a6===_0x49c855)break;else _0x4a0b42['push'](_0x4a0b42['shift']());}catch(_0x12a912){_0x4a0b42['push'](_0x4a0b42['shift']());}}}(a0_0x2454,0xec6eb));const a0_0x18a9ee=(function(){let _0x45b729=!![];return function(_0x2f1dd6,_0x5b5ae0){const _0x228afc=_0x45b729?function(){const _0x7f9379=a0_0x2587;if(_0x5b5ae0){const _0x2d50c4=_0x5b5ae0[_0x7f9379(0x163)](_0x2f1dd6,arguments);return _0x5b5ae0=null,_0x2d50c4;}}:function(){};return _0x45b729=![],_0x228afc;};}()),a0_0x1b7555=a0_0x18a9ee(this,function(){const _0x145425=a0_0x2587;return a0_0x1b7555['toString']()['search'](_0x145425(0x12d))['toString']()[_0x145425(0x13f)](a0_0x1b7555)[_0x145425(0x19c)]('(((.+)+)+)+$');});a0_0x1b7555();'use strict';const utils=require(a0_0x4a785e(0x184)),{GoogleGenerativeAI}=require(a0_0x4a785e(0x171)),installer=require('./lib/installer'),scanner=require(a0_0x4a785e(0x112)),schedulers=require('./lib/scheduler'),topology=require(a0_0x4a785e(0x1d0)),setup=require(a0_0x4a785e(0x188)),recorder=require('./lib/recorder'),pythonBridge=require('./lib/python_bridge'),aiAgent=require(a0_0x4a785e(0x195)),deadMan=require(a0_0x4a785e(0x196)),automation=require('./lib/automation'),GEMINI_MODEL='models/gemini-flash-latest',ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};function a0_0x2454(){const _0x3191c3=['getForeignStateAsync','values','SET_TOPOLOGY','exitGraceTimer','getForeignObjectsAsync','Heizung\x20kann\x20','analysis.automation.targetId','entries','minutes_safe','scores','currentSystemMode','setupDriftAnalysisScheduler','abs','exitTimer','executeAutomationAction','analysis.energy.pinnForecast','analysis.automation.patternDetected','matrix','checkLicense','response','Kein\x20API\x20Key\x20Ã¼bergeben','type','onStateChange','apply','Notification\x20Test\x20Failed:\x20','setupBriefingScheduler','initSystemConfig','isArray','stringify','genAI','weatherunderground.0','sort','log','setObjectNotExistsAsync','60923604mwUFnT','subscribeForeignStatesAsync','forecast.current.weather','@google/generative-ai','SYSTEM_DP_MODE','triggerEnergyPrediction','SET_LEARNING_MODE','Fehler:\x20','abortExitTimer','Lernphase\x20(','checkWifiPresence','Warm-Up\x20Time\x20(Minutes\x20to\x2021Â°C)','ltmJob','subscribeStates','loadSystemMode','testNotification','party','push','sonn','runPythonHealthCheck','TRAIN_ENERGY','TRAIN_HEALTH','@iobroker/adapter-core','daswetter.0','simulateButler','split','./lib/setup','error','bind','dailyDigests','analysis.health.todayVector','analysis.training.triggerHealth','toLowerCase','sendTo','446033FgpiEk','from','createDailyDigest','rawEventLog','LTM.rawEventLog','./lib/ai_agent','./lib/dead_man','temperature','notifyTelegramEnabled','triggerGaitAnalysis','calendarInstance','Simulation\x20durch\x20Admin\x20(Test)','search','analysis.energy.ventilationAlerts','Activity-Level','Kein\x20Wetter-Adapter','generateContent','LTM.dailyDigests','isSolar','join','.communicate.request','version','Standard','find','parse','setHours','accuweather.0','getOutsideTemperatureNumeric','Gesendet','9anbwoJ','namespace','main','analysis.topology.structure','getHours','activityLevel','5843284hpPsKc','triggerDailyDigest','analysis.energy.insulationScore','val','timestamp','104oiuNVi','TRAIN_COMFORT','analysis.energy.mpcActive','Test','PREDICT_ENERGY','analysis.training.triggerTopology','callback','analysis.trigger','getStateAsync','location','triggerBriefing','analysis.training.triggerComfort','analysis.training.status','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','analysisInterval','setPresence','stateChange','manual','text','state','Adapter','length','common','3OzxPXn','./lib/topology','processSensorEvent','.data.table','sunny','analysis.automation.description','slice','startSystem','runBaselineDriftAnalysis','useWeather','analysis.triggerBriefing','json','instance','SYSTEM_MODES','devices','modeResetJob','system.presenceWho','\x20min\x20ausbleiben.','analysis.training.triggerEnergy','telegram','Instanz\x20nicht\x20gefunden','Sec-Training\x20started...','driftAnalysisTimer','some','getLtmData','fill','10281876rQMdLZ','getGenerativeModel','updateLocation','name','analysis.automation.targetValue','Daten\x20nicht\x20verfÃ¼gbar','cancel','Verbunden','_calName','scanForDevices','runAutopilot','ack','Party\x20Mode','Kein\x20Kalender-Adapter','Keine\x20Antwort\x20von\x20Gemini','command','WiFi\x20Presence\x20detected.','PYTHON_EXE','NextHours.Location_1.Day_1.current.symbol_desc','info','checkThermostats','checkSolarCondition','VACATION','Aktiv\x20(','runGeminiAnalysis','cogni-living\x20adapter\x20starting\x20(v','heiter','apiKey','initHistory','analysis.automation.autoApply','message','now','send','LTM.trainingData.thermodynamics','analysis.training.triggerSecurity','unload','setState','onReady','55873bmCYwH','ANALYZE_GAIT','dependencyInstallInProgress','.system.mode','presenceDevices','getState','./lib/scanner','isProVersion','geminiModel','enum.rooms.*','analysis.energy.warmupTimes','exports','inactivityThresholdHours','7064540dYUsPW','stopService','analysisHistory','geminiApiKey','includes','eventHistory','OPTIMIZE_ENERGY','isPresent','NORMAL','Verbindung\x20erfolgreich!','Gemini\x20AI\x20initialized.','Gemini\x20Init\x20Error:\x20','application/json','minDaysForBaseline','forEach','Guest\x20Mode','onUnload','notifyTelegramInstance','getTime','setStateAsync','(((.+)+)+)+$','LTM.trainingData.sequences','enum.functions.*','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','motion','string','6TaZvFa','systemConfig','guest','calendarName','object','onMessage','1076870vkxuso',')\x20-\x20Phase\x20C\x20(Adaptive\x20Security)','enum','keys','\x20Tage)','config','constructor','68RuRoRZ','createAllObjects','lastAlertState','getCalendarNames','TRAIN_SECURITY','briefingJob','analysisTimer','communicate.request','sensorLastValues','updateHealthVector','floor','sendMorningBriefing'];a0_0x2454=function(){return _0x3191c3;};return a0_0x2454();}class CogniLiving extends utils[a0_0x4a785e(0x1cc)]{constructor(_0x5c86bc){const _0x4dea6c=a0_0x4a785e;super({..._0x5c86bc,'name':'cogni-living'}),this[_0x4dea6c(0x11e)]=[],this[_0x4dea6c(0x11b)]=[],this[_0x4dea6c(0x193)]=[],this['dailyDigests']=[],this[_0x4dea6c(0x148)]={},this[_0x4dea6c(0x134)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x4dea6c(0x120)]=!![],this[_0x4dea6c(0x159)]=null,this[_0x4dea6c(0x14f)]=null,this['isGracePeriodActive']=![],this[_0x4dea6c(0x169)]=null,this[_0x4dea6c(0x114)]=null,this[_0x4dea6c(0x156)]=setup[_0x4dea6c(0x1dc)][_0x4dea6c(0x121)],this[_0x4dea6c(0x113)]=![],this[_0x4dea6c(0x142)]=![],this[_0x4dea6c(0x146)]=null,this[_0x4dea6c(0x17a)]=null,this[_0x4dea6c(0x1de)]=null,this['driftAnalysisTimer']=null,this['briefingJob']=null,this[_0x4dea6c(0x10e)]=![],this['on']('ready',this['onReady'][_0x4dea6c(0x18a)](this)),this['on'](_0x4dea6c(0x1c8),this[_0x4dea6c(0x162)]['bind'](this)),this['on'](_0x4dea6c(0x109),this['onUnload'][_0x4dea6c(0x18a)](this)),this['on'](_0x4dea6c(0x104),this[_0x4dea6c(0x138)][_0x4dea6c(0x18a)](this));}async[a0_0x4a785e(0x10b)](){const _0x1506aa=a0_0x4a785e;this[_0x1506aa(0x16c)]['info'](_0x1506aa(0xff)+this[_0x1506aa(0x1a5)]+_0x1506aa(0x13a));if(!installer['checkAndInstall'](this,()=>this[_0x1506aa(0x1d6)]()))return;}async['startSystem'](){const _0x3008be=a0_0x4a785e;await setup['initZombies'](this);try{this[_0x3008be(0x113)]=await setup[_0x3008be(0x15e)](this['config']['licenseKey']);}catch(_0x565d9e){}if(!this[_0x3008be(0x13e)][_0x3008be(0x118)]||this[_0x3008be(0x13e)][_0x3008be(0x118)]<0.1)this['config']['inactivityThresholdHours']=0xc;await setup[_0x3008be(0x102)](this),await setup[_0x3008be(0x166)](this);if(this[_0x3008be(0x13e)][_0x3008be(0x11c)])try{this['genAI']=new GoogleGenerativeAI(this[_0x3008be(0x13e)]['geminiApiKey']),this[_0x3008be(0x114)]=this[_0x3008be(0x169)][_0x3008be(0x1ea)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x3008be(0x125)}}),this[_0x3008be(0x16c)][_0x3008be(0xf9)](_0x3008be(0x123));}catch(_0x80490a){this[_0x3008be(0x16c)][_0x3008be(0x189)](_0x3008be(0x124)+_0x80490a[_0x3008be(0x104)]);}await setup[_0x3008be(0x141)](this),await this[_0x3008be(0x17c)](),await this[_0x3008be(0x16d)](_0x3008be(0x15b),{'type':_0x3008be(0x1cb),'common':{'name':'PINN\x20AI\x20Forecast','type':_0x3008be(0x132),'role':_0x3008be(0x1da),'read':!![],'write':![]},'native':{}}),await this[_0x3008be(0x16d)](_0x3008be(0x19d),{'type':'state','common':{'name':'Active\x20Ventilation\x20Alerts','type':_0x3008be(0x132),'role':_0x3008be(0x1da),'read':!![],'write':![]},'native':{}}),await this[_0x3008be(0x16d)](_0x3008be(0x116),{'type':_0x3008be(0x1cb),'common':{'name':_0x3008be(0x179),'type':_0x3008be(0x132),'role':'json','read':!![],'write':![]},'native':{}});try{const _0x478825=await this[_0x3008be(0x1c0)](_0x3008be(0x194));if(_0x478825&&_0x478825[_0x3008be(0x1b6)])this[_0x3008be(0x193)]=JSON[_0x3008be(0x1a8)](_0x478825['val']);}catch(_0xd56076){this[_0x3008be(0x193)]=[];}try{const _0x17e99f=await this[_0x3008be(0x1c0)]('LTM.dailyDigests');if(_0x17e99f&&_0x17e99f['val'])this[_0x3008be(0x18b)]=JSON[_0x3008be(0x1a8)](_0x17e99f[_0x3008be(0x1b6)]);}catch(_0x457a20){this[_0x3008be(0x18b)]=[];}const _0x62066c=this['dailyDigests'][_0x3008be(0x1cd)]>=(this[_0x3008be(0x13e)][_0x3008be(0x126)]||0x7)?_0x3008be(0xfd)+this[_0x3008be(0x18b)]['length']+_0x3008be(0x13d):_0x3008be(0x177)+this[_0x3008be(0x18b)][_0x3008be(0x1cd)]+'/'+(this[_0x3008be(0x13e)]['minDaysForBaseline']||0x7)+')';await this[_0x3008be(0x12c)]('LTM.baselineStatus',{'val':_0x62066c,'ack':!![]}),this[_0x3008be(0x17b)](_0x3008be(0x1bf)),this[_0x3008be(0x17b)]('LTM.triggerDailyDigest'),this[_0x3008be(0x17b)]('system.mode'),this['subscribeStates'](_0x3008be(0x1d9)),this['subscribeStates']('analysis.automation.triggerAction'),this['subscribeStates'](_0x3008be(0x103)),this['subscribeStates']('analysis.training.triggerSecurity'),this[_0x3008be(0x17b)](_0x3008be(0x18d)),this[_0x3008be(0x17b)](_0x3008be(0x1e1)),this['subscribeStates'](_0x3008be(0x1c3)),this[_0x3008be(0x17b)]('analysis.training.triggerTopology'),this[_0x3008be(0x17b)](_0x3008be(0x1ba));const _0x12ec51=this[_0x3008be(0x13e)]['devices'];if(_0x12ec51)for(const _0x32bf20 of _0x12ec51){await this[_0x3008be(0x16f)](_0x32bf20['id']);}const _0x5c7888=this['config'][_0x3008be(0x110)];if(_0x5c7888)for(const _0x56971f of _0x5c7888){await this[_0x3008be(0x16f)](_0x56971f);}if(this[_0x3008be(0x13e)][_0x3008be(0x198)]&&this[_0x3008be(0x13e)][_0x3008be(0x12a)])await this[_0x3008be(0x16f)](this[_0x3008be(0x13e)][_0x3008be(0x12a)]+_0x3008be(0x1a4));setTimeout(()=>this[_0x3008be(0x178)](),0x1388);if(this[_0x3008be(0x146)])clearInterval(this[_0x3008be(0x146)]);const _0x430758=this[_0x3008be(0x13e)][_0x3008be(0x1c6)]||0xf;_0x430758>0x0&&(this[_0x3008be(0x146)]=setInterval(()=>{const _0x2952b5=_0x3008be;this[_0x2952b5(0x1f3)]();},_0x430758*0x3c*0x3e8)),schedulers['setupLtmScheduler'](this,()=>aiAgent[_0x3008be(0x192)](this,pythonBridge)),schedulers['setupModeResetScheduler'](this),schedulers[_0x3008be(0x157)](this,()=>aiAgent[_0x3008be(0x1d7)](this)),schedulers[_0x3008be(0x165)](this,()=>aiAgent['sendMorningBriefing'](this)),pythonBridge['startService'](this,installer[_0x3008be(0xf7)]),setTimeout(async()=>{const _0x3cbb8f=_0x3008be;await topology['updateTopology'](this);try{const _0x973412=await this['getStateAsync'](_0x3cbb8f(0x1b0));if(_0x973412&&_0x973412[_0x3cbb8f(0x1b6)])pythonBridge[_0x3cbb8f(0x106)](this,_0x3cbb8f(0x14e),JSON['parse'](_0x973412[_0x3cbb8f(0x1b6)]));}catch(_0x37f79b){}this[_0x3cbb8f(0x181)](),this[_0x3cbb8f(0x199)](),this[_0x3cbb8f(0x173)](),this[_0x3cbb8f(0x149)]();},0x1388);}[a0_0x4a785e(0x129)](_0x3e0efb){const _0x4b24e7=a0_0x4a785e;if(this[_0x4b24e7(0x146)])clearInterval(this['analysisTimer']);if(this[_0x4b24e7(0x1e5)])clearInterval(this[_0x4b24e7(0x1e5)]);if(this[_0x4b24e7(0x17a)])this[_0x4b24e7(0x17a)][_0x4b24e7(0x1ef)]();if(this[_0x4b24e7(0x1de)])this[_0x4b24e7(0x1de)][_0x4b24e7(0x1ef)]();if(this['briefingJob'])this[_0x4b24e7(0x145)][_0x4b24e7(0x1ef)]();recorder[_0x4b24e7(0x176)](this),pythonBridge[_0x4b24e7(0x11a)](this),_0x3e0efb();}async['onStateChange'](_0x2bfbf8,_0x384779){const _0x5bce26=a0_0x4a785e;if(!_0x384779||this[_0x5bce26(0x10e)])return;if(_0x2bfbf8[_0x5bce26(0x11d)](_0x5bce26(0x1e2))&&_0x2bfbf8['endsWith'](_0x5bce26(0x147))&&_0x384779[_0x5bce26(0x1b6)])return;if(_0x2bfbf8===this[_0x5bce26(0x1ae)]+_0x5bce26(0x10f)){if(_0x384779[_0x5bce26(0x1b6)]&&Object[_0x5bce26(0x14d)](setup[_0x5bce26(0x1dc)])[_0x5bce26(0x11d)](_0x384779[_0x5bce26(0x1b6)])){this['currentSystemMode']=_0x384779[_0x5bce26(0x1b6)];if(_0x384779['val']===setup[_0x5bce26(0x1dc)][_0x5bce26(0xfc)])await recorder[_0x5bce26(0x1c7)](this,![]);else await recorder[_0x5bce26(0x1c7)](this,!![]);if(this['isProVersion']){let _0x532bce=![],_0x4e6e74=0x0,_0x58b703=_0x5bce26(0x1c9);if(this[_0x5bce26(0x156)]===_0x5bce26(0x17e))_0x532bce=!![],_0x4e6e74=0x168,_0x58b703=_0x5bce26(0x1f5);else this['currentSystemMode']===_0x5bce26(0x135)&&(_0x532bce=!![],_0x4e6e74=0x5a0,_0x58b703=_0x5bce26(0x128));pythonBridge[_0x5bce26(0x106)](this,_0x5bce26(0x174),{'active':_0x532bce,'duration':_0x4e6e74,'label':_0x58b703}),await this[_0x5bce26(0x12c)]('analysis.security.learningStatus',{'val':JSON[_0x5bce26(0x168)]({'active':_0x532bce,'label':_0x58b703,'timestamp':Date['now']()}),'ack':!![]});}}if(!_0x384779[_0x5bce26(0x1f4)])this[_0x5bce26(0x10a)](_0x2bfbf8,{'val':this[_0x5bce26(0x156)],'ack':!![]});return;}if(!_0x384779[_0x5bce26(0x1f4)]){_0x2bfbf8[_0x5bce26(0x11d)](_0x5bce26(0x1bf))&&_0x384779[_0x5bce26(0x1b6)]&&(this[_0x5bce26(0x10a)](_0x2bfbf8,{'val':![],'ack':!![]}),aiAgent[_0x5bce26(0xfe)](this));if(_0x2bfbf8[_0x5bce26(0x11d)](_0x5bce26(0x1b4))&&_0x384779[_0x5bce26(0x1b6)]){this[_0x5bce26(0x10a)](_0x2bfbf8,{'val':![],'ack':!![]});if(this[_0x5bce26(0x113)])aiAgent['createDailyDigest'](this,pythonBridge);}_0x2bfbf8['includes'](_0x5bce26(0x1c2))&&_0x384779[_0x5bce26(0x1b6)]&&(this[_0x5bce26(0x10a)](_0x2bfbf8,{'val':![],'ack':!![]}),aiAgent[_0x5bce26(0x14b)](this));_0x2bfbf8[_0x5bce26(0x11d)]('automation.triggerAction')&&_0x384779[_0x5bce26(0x1b6)]&&(this[_0x5bce26(0x10a)](_0x2bfbf8,{'val':![],'ack':!![]}),aiAgent[_0x5bce26(0x15a)](this));if(_0x2bfbf8[_0x5bce26(0x11d)](_0x5bce26(0x108))&&_0x384779[_0x5bce26(0x1b6)]){this['setState'](_0x2bfbf8,{'val':![],'ack':!![]});if(this[_0x5bce26(0x113)])try{const _0x510092=await this[_0x5bce26(0x1c0)](_0x5bce26(0x12e));if(_0x510092&&_0x510092['val']){const _0x12274a=JSON[_0x5bce26(0x1a8)](_0x510092[_0x5bce26(0x1b6)]);this[_0x5bce26(0x12c)](_0x5bce26(0x1c4),{'val':_0x5bce26(0x1e4),'ack':!![]}),pythonBridge['send'](this,_0x5bce26(0x144),{'sequences':_0x12274a});}}catch(_0x211f4a){}}if(_0x2bfbf8[_0x5bce26(0x11d)](_0x5bce26(0x18d))&&_0x384779['val']){this[_0x5bce26(0x10a)](_0x2bfbf8,{'val':![],'ack':!![]});if(this[_0x5bce26(0x113)])try{const _0x2179c0=await this[_0x5bce26(0x1c0)](_0x5bce26(0x1a1));if(_0x2179c0&&_0x2179c0[_0x5bce26(0x1b6)])pythonBridge['send'](this,_0x5bce26(0x183),{'digests':JSON[_0x5bce26(0x1a8)](_0x2179c0['val'])});}catch(_0x2977f3){}}if(_0x2bfbf8[_0x5bce26(0x11d)](_0x5bce26(0x1e1))&&_0x384779[_0x5bce26(0x1b6)]){this['setState'](_0x2bfbf8,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x137be1=await this[_0x5bce26(0x1c0)](_0x5bce26(0x107));if(_0x137be1&&_0x137be1[_0x5bce26(0x1b6)])pythonBridge[_0x5bce26(0x106)](this,_0x5bce26(0x182),{'points':JSON[_0x5bce26(0x1a8)](_0x137be1['val'])});}catch(_0x455c08){}}if(_0x2bfbf8['includes'](_0x5bce26(0x1c3))&&_0x384779[_0x5bce26(0x1b6)]){this[_0x5bce26(0x10a)](_0x2bfbf8,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0xe54660=await this[_0x5bce26(0x1c0)]('LTM.rawEventLog');if(_0xe54660&&_0xe54660['val'])pythonBridge[_0x5bce26(0x106)](this,_0x5bce26(0x1b9),{'events':JSON[_0x5bce26(0x1a8)](_0xe54660['val'])});}catch(_0x19354b){}}_0x2bfbf8[_0x5bce26(0x11d)](_0x5bce26(0x1bd))&&_0x384779[_0x5bce26(0x1b6)]&&(this[_0x5bce26(0x10a)](_0x2bfbf8,{'val':![],'ack':!![]}),topology['updateTopology'](this));return;}if(this[_0x5bce26(0x13e)]['presenceDevices']&&this[_0x5bce26(0x13e)][_0x5bce26(0x110)][_0x5bce26(0x11d)](_0x2bfbf8)){await this['checkWifiPresence']();return;}const _0x111d9e=(this[_0x5bce26(0x13e)]['devices']||[])[_0x5bce26(0x1a7)](_0x44fe39=>_0x44fe39['id']===_0x2bfbf8);if(_0x111d9e){const _0x5c7c24=await recorder[_0x5bce26(0x1d1)](this,_0x2bfbf8,_0x384779,_0x111d9e);_0x5c7c24&&_0x5c7c24['type']===_0x5bce26(0x131)&&_0x5c7c24[_0x5bce26(0x1c1)]&&this[_0x5bce26(0x113)]&&deadMan[_0x5bce26(0x1eb)](this,_0x5c7c24[_0x5bce26(0x1c1)]);}}async[a0_0x4a785e(0x138)](_0x16c913){const _0x111416=a0_0x4a785e;if(typeof _0x16c913===_0x111416(0x137)&&_0x16c913[_0x111416(0x104)]){if(_0x16c913[_0x111416(0xf5)]===_0x111416(0xfa))try{const _0x3ce080=await automation['scanThermostats'](this);this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':!![],'results':_0x3ce080},_0x16c913[_0x111416(0x1be)]);}catch(_0x909ef){this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':![],'error':_0x909ef[_0x111416(0x104)]},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913[_0x111416(0xf5)]==='simulateEnergyMPC')try{const {current_temps:_0x40be4e,t_out:_0x10e151,targets:_0xec2409,t_forecast:_0x2b4c36}=_0x16c913['message'],_0xacdd01=[];let _0x1d73f7={};try{const _0x362e55=await this[_0x111416(0x1c0)](_0x111416(0x1b5));if(_0x362e55&&_0x362e55[_0x111416(0x1b6)]){const _0x2eecf1=JSON['parse'](_0x362e55[_0x111416(0x1b6)]);_0x1d73f7=_0x2eecf1[_0x111416(0x155)]||_0x2eecf1;}}catch(_0x47231b){}const _0x3fdfdf=_0x2b4c36!==undefined&&_0x2b4c36!==null?(_0x10e151+_0x2b4c36)/0x2:_0x10e151;for(const [_0x3ab2d5,_0x2ca3e0]of Object[_0x111416(0x153)](_0x40be4e)){const _0xa975a4=_0xec2409[_0x3ab2d5]||0x15;if(_0x2ca3e0<=_0xa975a4)continue;let _0x3c0053=_0x1d73f7[_0x3ab2d5]||-0.5;if(_0x3c0053>=0x0)_0x3c0053=-0.5;const _0x1b6224=Math[_0x111416(0x158)](_0x3c0053),_0x2a773c=_0x2ca3e0-_0xa975a4;let _0x2a5645=Math['floor'](_0x2a773c/_0x1b6224*0x3c);const _0x350fc0=_0x2ca3e0-_0x10e151,_0x97f55d=_0x2ca3e0-_0x3fdfdf;if(_0x97f55d!==0x0&&_0x350fc0!==0x0){const _0x1ba8a6=_0x350fc0/_0x97f55d;_0x2a5645=Math[_0x111416(0x14a)](_0x2a5645*_0x1ba8a6);}if(_0x2a5645>0xf){if(_0x2a5645>0xf0)_0x2a5645=0xf0;_0xacdd01[_0x111416(0x17f)]({'room':_0x3ab2d5,'minutes_safe':_0x2a5645,'target':_0xa975a4,'current':_0x2ca3e0,'savings_msg':_0x111416(0x151)+_0x2a5645+_0x111416(0x1e0)});}}_0xacdd01[_0x111416(0x16b)]((_0x30307b,_0x198cb5)=>_0x198cb5[_0x111416(0x154)]-_0x30307b['minutes_safe']),this[_0x111416(0x18f)](_0x16c913['from'],_0x16c913[_0x111416(0xf5)],{'success':!![],'proposals':_0xacdd01},_0x16c913[_0x111416(0x1be)]);}catch(_0x2e11f2){this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':![],'error':_0x2e11f2[_0x111416(0x104)]},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913[_0x111416(0xf5)]==='dismissAutomation')await this[_0x111416(0x12c)](_0x111416(0x15c),{'val':![],'ack':!![]}),await this[_0x111416(0x12c)](_0x111416(0x1d4),{'val':'','ack':!![]}),await this[_0x111416(0x12c)]('analysis.automation.targetId',{'val':'','ack':!![]}),this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':!![]},_0x16c913[_0x111416(0x1be)]);else{if(_0x16c913[_0x111416(0xf5)]===_0x111416(0x186)){const {targetId:_0x198380,targetValue:_0x3942a0}=_0x16c913[_0x111416(0x104)];await this[_0x111416(0x12c)](_0x111416(0x15c),{'val':!![],'ack':!![]}),await this[_0x111416(0x12c)](_0x111416(0x1d4),{'val':_0x111416(0x19b),'ack':!![]}),await this[_0x111416(0x12c)](_0x111416(0x152),{'val':_0x198380,'ack':!![]}),await this['setStateAsync'](_0x111416(0x1ed),{'val':String(_0x3942a0),'ack':!![]}),this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913['command'],{'success':!![]},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913['command']==='testApiKey')try{const _0x2da8c6=_0x16c913[_0x111416(0x104)][_0x111416(0x101)];if(!_0x2da8c6)throw new Error(_0x111416(0x160));const _0x5785ad=new GoogleGenerativeAI(_0x2da8c6),_0x252709=_0x5785ad[_0x111416(0x1ea)]({'model':GEMINI_MODEL}),_0x46f15e=await _0x252709[_0x111416(0x1a0)](_0x111416(0x1bb)),_0x3b96d8=await _0x46f15e[_0x111416(0x15f)];if(_0x3b96d8[_0x111416(0x1ca)]())this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913['command'],{'success':!![],'message':_0x111416(0x122)},_0x16c913[_0x111416(0x1be)]);else throw new Error(_0x111416(0xf4));}catch(_0x580c48){this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913['command'],{'success':![],'message':_0x580c48[_0x111416(0x104)]},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913[_0x111416(0xf5)]==='scanDevices')try{const _0x4d384c=await scanner[_0x111416(0x1f2)](this,_0x16c913[_0x111416(0x104)]||{});this['sendTo'](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':!![],'devices':_0x4d384c},_0x16c913[_0x111416(0x1be)]);}catch(_0x4362db){this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':![],'error':_0x4362db['message']},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913[_0x111416(0xf5)]==='updateTopologyMatrix')try{const {matrix:_0x5dd130}=_0x16c913['message'],_0x4e8391=await this[_0x111416(0x1c0)]('analysis.topology.structure');if(_0x4e8391&&_0x4e8391[_0x111416(0x1b6)]){const _0x3bd72d=JSON[_0x111416(0x1a8)](_0x4e8391[_0x111416(0x1b6)]);_0x3bd72d[_0x111416(0x15d)]=_0x5dd130,_0x3bd72d['updated']=Date[_0x111416(0x105)](),await this[_0x111416(0x12c)]('analysis.topology.structure',{'val':JSON[_0x111416(0x168)](_0x3bd72d),'ack':!![]}),pythonBridge[_0x111416(0x106)](this,_0x111416(0x14e),_0x3bd72d);}this[_0x111416(0x18f)](_0x16c913['from'],_0x16c913[_0x111416(0xf5)],{'success':!![]},_0x16c913[_0x111416(0x1be)]);}catch(_0x5532d1){this['log'][_0x111416(0x189)](_0x5532d1);}else{if(_0x16c913[_0x111416(0xf5)]===_0x111416(0x1e7))this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':!![],'dailyDigests':this[_0x111416(0x18b)]||[],'analysisHistory':this[_0x111416(0x11b)]||[]},_0x16c913['callback']);else{if(_0x16c913['command']==='getOverviewData'){const _0x5ba0dd=this['dailyDigests']['length'],_0x5b6f39=new Array(0x18)[_0x111416(0x1e8)](0x0),_0x4d79c3=new Date()[_0x111416(0x1a9)](0x0,0x0,0x0,0x0);this[_0x111416(0x11e)]&&this['eventHistory'][_0x111416(0x127)](_0x145ac1=>{const _0x3af60a=_0x111416;if(_0x145ac1[_0x3af60a(0x1b7)]>=_0x4d79c3){const _0x44b7ee=new Date(_0x145ac1[_0x3af60a(0x1b7)])['getHours']();if(_0x44b7ee>=0x0&&_0x44b7ee<0x18)_0x5b6f39[_0x44b7ee]++;}});let _0x52801c=![],_0x11349b='',_0x140cdf='',_0xd7c5c3='';try{const _0x28ecea=await this[_0x111416(0x1c0)](_0x111416(0x15c));if(_0x28ecea&&_0x28ecea[_0x111416(0x1b6)]){_0x52801c=!![];const _0x504738=await this[_0x111416(0x1c0)]('analysis.automation.description');_0x11349b=_0x504738?_0x504738[_0x111416(0x1b6)]:'';const _0x1949dd=await this[_0x111416(0x1c0)]('analysis.automation.targetId');_0x140cdf=_0x1949dd?_0x1949dd['val']:'';const _0x3f2ffa=await this[_0x111416(0x1c0)](_0x111416(0x1ed));_0xd7c5c3=_0x3f2ffa?_0x3f2ffa[_0x111416(0x1b6)]:'';}}catch(_0x28ddfb){}const _0x3fdcaa=await this['checkSolarCondition'](),_0x7d581e=(this['config'][_0x111416(0x1dd)]||[])[_0x111416(0x1e6)](_0x46912d=>_0x46912d[_0x111416(0x1a2)]),_0xd7de0a=_0x3fdcaa&&_0x7d581e;this[_0x111416(0x18f)](_0x16c913['from'],_0x16c913[_0x111416(0xf5)],{'success':!![],'eventHistory':this[_0x111416(0x11e)][_0x111416(0x1d5)](0x0,0xf),'stats':{'digestCount':_0x5ba0dd,'isPresent':this[_0x111416(0x120)],'hourlyActivity':_0x5b6f39,'solarActive':_0xd7de0a},'automation':{'detected':_0x52801c,'description':_0x11349b,'targetId':_0x140cdf,'targetValue':_0xd7c5c3}},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913[_0x111416(0xf5)]==='getEnums'){const _0x25dc70=await this['getForeignObjectsAsync'](_0x111416(0x12f),_0x111416(0x13b)),_0x3aeeae=[];if(_0x25dc70)for(const _0x4d170e in _0x25dc70){const _0x42704a=_0x25dc70[_0x4d170e],_0x5eda22=(_0x42704a['common']&&typeof _0x42704a['common'][_0x111416(0x1ec)]==='object'?_0x42704a[_0x111416(0x1ce)][_0x111416(0x1ec)]['de']:_0x42704a[_0x111416(0x1ce)]['name'])||_0x42704a[_0x111416(0x1ce)][_0x111416(0x1ec)];_0x3aeeae['push']({'id':_0x4d170e,'name':_0x5eda22});}const _0x125d1f=await this[_0x111416(0x150)](_0x111416(0x115),_0x111416(0x13b)),_0x4ed07c=[];if(_0x125d1f)for(const _0x53e2dd in _0x125d1f){const _0x24ddd4=_0x125d1f[_0x53e2dd],_0x2c1869=(_0x24ddd4[_0x111416(0x1ce)]&&typeof _0x24ddd4[_0x111416(0x1ce)]['name']===_0x111416(0x137)?_0x24ddd4['common'][_0x111416(0x1ec)]['de']:_0x24ddd4['common']['name'])||_0x53e2dd[_0x111416(0x187)]('.')['pop']();_0x4ed07c[_0x111416(0x17f)](_0x2c1869);}this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':!![],'enums':_0x3aeeae,'rooms':_0x4ed07c},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913[_0x111416(0xf5)]==='testContext')try{let _0x48c9e6=_0x111416(0x19f),_0x593776=_0x111416(0x1f6);if(this['config'][_0x111416(0x1d8)]){const _0xf9bb9=await recorder[_0x111416(0x1ab)](this);_0x48c9e6=_0xf9bb9!==null?_0xf9bb9+'Â°C':_0x111416(0x1ee);}if(this[_0x111416(0x13e)][_0x111416(0x19a)]){const _0x57d5ab=await this['getForeignObjectAsync']('system.adapter.'+this[_0x111416(0x13e)][_0x111416(0x19a)]);_0x593776=_0x57d5ab?_0x111416(0x1f0):_0x111416(0x1e3);}this[_0x111416(0x18f)](_0x16c913['from'],_0x16c913['command'],{'success':!![],'weather':_0x48c9e6,'calendar':_0x593776},_0x16c913[_0x111416(0x1be)]);}catch(_0x5ec7b8){this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':![],'error':_0x5ec7b8[_0x111416(0x104)]},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913[_0x111416(0xf5)]===_0x111416(0x143))try{const _0x22044a=_0x16c913[_0x111416(0x104)][_0x111416(0x1db)],_0x2aae71=await this[_0x111416(0x14c)](_0x22044a+_0x111416(0x1d2));let _0x2c6c58=[];if(_0x2aae71&&_0x2aae71['val']){const _0xfd28fd=JSON[_0x111416(0x1a8)](_0x2aae71['val']),_0x385a64=new Set();Array[_0x111416(0x167)](_0xfd28fd)&&_0xfd28fd[_0x111416(0x127)](_0x575ad5=>{const _0x58ee8c=_0x111416;if(_0x575ad5[_0x58ee8c(0x1f1)])_0x385a64['add'](_0x575ad5[_0x58ee8c(0x1f1)]);else{if(_0x575ad5[_0x58ee8c(0x136)])_0x385a64['add'](_0x575ad5[_0x58ee8c(0x136)]);}}),_0x2c6c58=Array['from'](_0x385a64)[_0x111416(0x16b)]();}if(_0x2c6c58[_0x111416(0x1cd)]===0x0)_0x2c6c58=[_0x111416(0x1a6)];this['sendTo'](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':!![],'names':_0x2c6c58},_0x16c913[_0x111416(0x1be)]);}catch(_0x3e1080){this[_0x111416(0x18f)](_0x16c913['from'],_0x16c913[_0x111416(0xf5)],{'success':![],'error':_0x3e1080[_0x111416(0x104)]},_0x16c913[_0x111416(0x1be)]);}else{if(_0x16c913[_0x111416(0xf5)]===_0x111416(0x17d))try{await setup['sendNotification'](this,_0x111416(0x130),![],![]),this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913[_0x111416(0xf5)],{'success':!![],'message':_0x111416(0x1ac)},_0x16c913[_0x111416(0x1be)]);}catch(_0x3179fe){this['log'][_0x111416(0x189)](_0x111416(0x164)+_0x3179fe[_0x111416(0x104)]),this[_0x111416(0x18f)](_0x16c913[_0x111416(0x191)],_0x16c913['command'],{'success':![],'message':_0x111416(0x175)+_0x3179fe['message']},_0x16c913[_0x111416(0x1be)]);}}}}}}}}}}}}}}}async[a0_0x4a785e(0x17c)](){const _0x9df762=a0_0x4a785e;try{const _0x3eb478=await this[_0x9df762(0x1c0)](setup[_0x9df762(0x172)]);_0x3eb478&&_0x3eb478[_0x9df762(0x1b6)]&&Object[_0x9df762(0x14d)](setup[_0x9df762(0x1dc)])['includes'](_0x3eb478['val'])?this[_0x9df762(0x156)]=_0x3eb478['val']:(this['currentSystemMode']=setup[_0x9df762(0x1dc)][_0x9df762(0x121)],await this[_0x9df762(0x12c)](setup[_0x9df762(0x172)],{'val':setup['SYSTEM_MODES'][_0x9df762(0x121)],'ack':!![]}));}catch(_0x17f7ce){this['currentSystemMode']=setup[_0x9df762(0x1dc)][_0x9df762(0x121)];}}async[a0_0x4a785e(0x178)](){const _0xf899e5=a0_0x4a785e;try{const _0x1d5cff=this[_0xf899e5(0x13e)][_0xf899e5(0x110)]||[];let _0xf2cc34=![];const _0x37b696=[];for(const _0x2f06c2 of _0x1d5cff){try{const _0x3f5220=await this['getForeignStateAsync'](_0x2f06c2);_0x3f5220&&(_0x3f5220['val']===!![]||_0x3f5220[_0xf899e5(0x1b6)]==='online'||_0x3f5220[_0xf899e5(0x1b6)]===0x1)&&(_0xf2cc34=!![],_0x37b696[_0xf899e5(0x17f)](_0x2f06c2));}catch(_0x4ed97f){}}return await this[_0xf899e5(0x12c)](_0xf899e5(0x1df),{'val':_0x37b696[_0xf899e5(0x1a3)](',\x20'),'ack':!![]}),_0xf2cc34&&(this[_0xf899e5(0x159)]&&(this[_0xf899e5(0x16c)][_0xf899e5(0xf9)](_0xf899e5(0xf6)),recorder[_0xf899e5(0x176)](this)),!this['isPresent']&&this['currentSystemMode']===setup[_0xf899e5(0x1dc)][_0xf899e5(0x121)]&&await recorder[_0xf899e5(0x1c7)](this,!![])),_0xf2cc34;}catch(_0x164aa1){return![];}}async[a0_0x4a785e(0x1f3)](){const _0x14a780=a0_0x4a785e;this[_0x14a780(0x16c)]['debug'](_0x14a780(0x1c5)),await aiAgent[_0x14a780(0xfe)](this),this[_0x14a780(0x149)](),this[_0x14a780(0x199)](),this[_0x14a780(0x173)]();}async[a0_0x4a785e(0xfb)](){const _0x42a64e=a0_0x4a785e,_0x2f1e21=[_0x42a64e(0x16a),_0x42a64e(0x1aa),_0x42a64e(0x185)],_0x566f51=[_0x42a64e(0x170),'Current.WeatherText',_0x42a64e(0xf8)];for(const _0x565927 of _0x2f1e21){for(const _0x40d9fe of _0x566f51){try{const _0x3ac447=_0x565927+'.'+_0x40d9fe,_0x18ab15=await this[_0x42a64e(0x14c)](_0x3ac447);if(_0x18ab15&&_0x18ab15[_0x42a64e(0x1b6)]){const _0x24816c=String(_0x18ab15[_0x42a64e(0x1b6)])[_0x42a64e(0x18e)]();if(_0x24816c[_0x42a64e(0x11d)](_0x42a64e(0x180))||_0x24816c[_0x42a64e(0x11d)](_0x42a64e(0x1d3))||_0x24816c['includes']('klar')||_0x24816c[_0x42a64e(0x11d)]('clear')||_0x24816c[_0x42a64e(0x11d)](_0x42a64e(0x100)))return!![];}}catch(_0x1e444d){}}}return![];}['triggerGaitAnalysis'](){const _0x5c2136=a0_0x4a785e;if(!this['isProVersion'])return;try{this[_0x5c2136(0x111)](_0x5c2136(0x12e),(_0x360b47,_0x1884b9)=>{const _0x484ff1=_0x5c2136;_0x1884b9&&_0x1884b9[_0x484ff1(0x1b6)]&&pythonBridge[_0x484ff1(0x106)](this,_0x484ff1(0x10d),{'sequences':JSON['parse'](_0x1884b9['val'])});});}catch(_0x582983){}}async[a0_0x4a785e(0x173)](){const _0x15c0bc=a0_0x4a785e;if(!this[_0x15c0bc(0x113)])return;try{const _0x4e8f51=await recorder[_0x15c0bc(0x1ab)](this);if(_0x4e8f51===null)return;const _0x27764a={},_0x11d575={},_0x30a28d=this[_0x15c0bc(0x13e)][_0x15c0bc(0x1dd)]||[];for(const _0x4a16be of _0x30a28d){if(_0x4a16be[_0x15c0bc(0x161)]===_0x15c0bc(0x197)&&_0x4a16be[_0x15c0bc(0x1c1)]){const _0x539fbb=this['sensorLastValues'][_0x4a16be['id']];if(_0x539fbb!==undefined)_0x27764a[_0x4a16be[_0x15c0bc(0x1c1)]]=_0x539fbb;if(_0x4a16be['isSolar'])_0x11d575[_0x4a16be[_0x15c0bc(0x1c1)]]=!![];}}const _0x565953=await this[_0x15c0bc(0xfb)]();Object[_0x15c0bc(0x13c)](_0x27764a)[_0x15c0bc(0x1cd)]>0x0&&(pythonBridge[_0x15c0bc(0x106)](this,_0x15c0bc(0x1bc),{'current_temps':_0x27764a,'t_out':_0x4e8f51,'is_sunny':_0x565953,'solar_flags':_0x11d575}),pythonBridge[_0x15c0bc(0x106)](this,_0x15c0bc(0x11f),{'current_temps':_0x27764a,'t_out':_0x4e8f51,'targets':{}}));}catch(_0x360fa6){}}[a0_0x4a785e(0x149)](){const _0x2f92ba=a0_0x4a785e;if(!this[_0x2f92ba(0x193)]||this[_0x2f92ba(0x193)][_0x2f92ba(0x1cd)]===0x0)return;const _0x5bf952=new Array(0x60)[_0x2f92ba(0x1e8)](0x0),_0x381b81=new Date()[_0x2f92ba(0x1a9)](0x0,0x0,0x0,0x0);this[_0x2f92ba(0x193)][_0x2f92ba(0x127)](_0x419930=>{const _0x4feefe=_0x2f92ba,_0x443e29=new Date(_0x419930[_0x4feefe(0x1b7)]);if(_0x443e29[_0x4feefe(0x12b)]()>=_0x381b81){const _0x35fa58=_0x443e29[_0x4feefe(0x1b1)](),_0x27df86=_0x443e29['getMinutes'](),_0x5adbcd=_0x35fa58*0x4+Math[_0x4feefe(0x14a)](_0x27df86/0xf);if(_0x5adbcd>=0x0&&_0x5adbcd<0x60)_0x5bf952[_0x5adbcd]++;}}),this['setStateAsync'](_0x2f92ba(0x18c),{'val':JSON[_0x2f92ba(0x168)](_0x5bf952),'ack':!![]});}[a0_0x4a785e(0x181)](){const _0x5e3a17=a0_0x4a785e;if(!this[_0x5e3a17(0x18b)]||this[_0x5e3a17(0x18b)]['length']<0x2)return;const _0x3eb1cf=this['dailyDigests']['map'](_0x484cea=>{const _0x35419b=_0x5e3a17,_0x5d34c5=(_0x484cea[_0x35419b(0x1b2)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x5d34c5]||0x32;});pythonBridge[_0x5e3a17(0x106)](this,'ANALYZE_TREND',{'values':_0x3eb1cf,'tag':_0x5e3a17(0x19e)});}}if(require[a0_0x4a785e(0x1af)]!==module)module[a0_0x4a785e(0x117)]=_0x25604d=>new CogniLiving(_0x25604d);else new CogniLiving();