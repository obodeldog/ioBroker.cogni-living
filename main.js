const a0_0x58f094=a0_0x17a8;function a0_0x1ecb(){const _0x5dbb57=['window','setDate','party','TRAIN_SECURITY','analysis.automation.targetValue','subscribeForeignStates','39336XNtSFg','triggerDailyDigest','üíæ\x20Saving\x20Daily\x20History\x20for\x20','Adapter','triggerGaitAnalysis','sonn','refreshCalendar','./lib/installer','281100HOyiQX','common','getObjectViewAsync','endsWith','abs','Aktiv\x20(','integrateRoomTime','stateChange','pythonBridge','debug','initSystemConfig','weatherTempId','moduleEnergy','memoryCache','checkSolarCondition','analysisHistory','value','state','instance','reduce','ready','health','node-schedule','.data.table','times','events.history','isPresent','analysis.health.activityTrend','devices','updateHealthVector','Daily\x20Activity\x20Vector\x20(48x30min)','enum.functions.*','infrasoundThreshold','max','setStateAsync','isArray','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','briefingJob','Warm-Up\x20Time','523310oHviqw','[Integrator]\x20Error:\x20','telegram','cancel','137172NfwacF','weatherunderground.0','Sec-Training\x20started...','Unknown','setObjectNotExistsAsync','moduleSecurity','runAutopilot','values','presenceDevices','trackerHeartbeat','SET_LEARNING_MODE','2-digit','dailyDigests','energy','analysis.activity.roomHistory','infrasoundLocked','generateHealthReport','replayTodayEvents','testContext','handleInfrasound','sunny','subscribeStates','exports','system.adapter.ical.È¶ô','clear','find','guest','toISOString','rows','üîä\x20Infraschall:\x20','analysis.energy.warmupTimes','getHours','path','onReady','./lib/ai_agent','startSystem','timestamp','DAY','genAI','geminiApiKey','\x20(Threshold)','analysis.health.geminiNight','startService','cogni-living\x20adapter\x20starting\x20(v','scheduleJob','infrasoundArmingId','now','üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','\x20rooms)','push','711ePzyTw','json','historyJob','\x20Kalender-Adapter\x20gefunden.','val','./lib/recorder','triggerBriefing','TRAIN_COMFORT','unshift','enum','analysis.trigger','filter','scanForDevices','checkThermostats','\x20>\x20','fill','Niemand','üí®\x20L√ºftung\x20in\x20','\x20events\x20from\x20standard\x20storage.','createAllObjects','todayVector','healthTrendInterval','getOverviewData','initHistory','apply','\x20(Bewohner\x20anwesend\x20-\x20normal)','slice','.json','testApiKey','config','warn','L√ºften\x20empfohlen','\x22history\x22:{}','üì¶\x20Restored\x20','toString','...','triggerGaitAnalysis\x20parse\x20error:\x20','python','Say\x20Hello','useCalendar','moduleComfort','string','üîÆ\x20Energy\x20Prediction\x20triggered\x20(','LTM.rawEventLog','thermostat','length','roomIntegratorTimer','constructor','shift',',\x20Temp:\x20','mkdirSync','history','Sonne:\x20','analysisTimer','NORMAL','sensorLastValues','send','models/gemini-flash-latest','substring','@google/generative-ai','analysis.training.triggerSecurity','setState','ANALYZE_GAIT','analyzeWindowOpening','modules','floor','analysis.security.lastScore','activeModules','unload','motion','moduleHealth','replace','pythonBridge\x20command\x20failed:\x20','application/json','./lib/setup','system.adapter.ical.','includes','de-DE','split','security','minDaysForBaseline','analysis.health.todayRoomDetails','map','analysis.health.geminiDay','triggerGaitAnalysis\x20error:\x20','appendToLog','executeAutomationAction','driftAnalysisTimer','toFixed','pop','Kein\x20API\x20Key\x20√ºbergeben.','presenceCheckTimer','pressureBuffer','.system.mode','min','eventHistory','name','analysis.energy.warmupSources','temperature','join','Corrupt','error','date','Lernphase\x20(','currentSystemMode','getTime','\x20-\x20','analysis.training.triggerHealth','scanThermostats','Keine\x20Daten','No\x20data','updateSchedulePreview','setPresence','./lib/dead_man','saveDailyHistory','systemConfig','stopService','from','open','110215Clheml','(((.+)+)+)+$','message','‚úÖ\x20History\x20saved:\x20','stringify','‚Ü∫\x20Replaying\x20','toLocaleTimeString','cogni-living','./lib/scheduler','Daily\x20Room\x20Details\x20(48x30min)','text','./lib/automation','readFileSync','onStateChange','isProVersion','@iobroker/adapter-core','üìù\x20Manual\x20event\x20logged:\x20','system','¬∞C\x20(Innen:\x20','some','type','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','TRAIN_TOPOLOGY','getForeignStateAsync','callback','outdoorSensorId','runPythonHealthCheck','sources','toLowerCase','automation.triggerAction','runGeminiAnalysis','.last_seen','all','LTM.dailyDigests','Current.WeatherText','{\x22history\x22:{}}','getStateAsync','triggerEnergyPrediction','getEnums','SYSTEM_MODES','üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20','.isOnline','¬∞C,\x20Au√üen:\x20','number','analysis.visualization.pulse','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','comfort','ltmJob','command','ERROR','exitGraceTimer','\x20sequences','main','subscribeForeignStatesAsync','protectAiMemory','heiter','forEach','Warte\x20auf\x20Analyse...','analysis.health.todayVector','parse','toLocaleDateString','lastTrackerEventTime','search','analysis.training.triggerComfort','calendarName','add','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','Unbekannt','¬∞C)','General\x20Activity\x20Trend','59\x2023\x20*\x20*\x20*','existsSync','triggerHealth\x20error:\x20','initSchedules','system.adapter.','licenseKey','info','bin','Standard','ack','system.presenceWho','getAbsoluteDefaultDataDir','scanDevices','‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','Room\x20Dwell\x20Time\x20Stats','getMinutes','453848DnyCQZ','.venv','exitTimer','writeFileSync','Guest\x20Mode','manual','initZombies',',\x20Events:\x0a','updateLocation','setHours','[PythonBridge]\x20Forwarding\x20command:\x20','checkWifiPresence','241100iwYZKJ','calendarCheckTimer','Manual\x20Event','infrasoundSensorId','log','rawEventLog','loadSystemMode','14vDsCvE','forecast.current.weather','SYSTEM_DP_MODE','onMessage','sendTo','round','üîä\x20Infraschall-Alarm:\x20','Gemini\x20Init\x20Error:\x20','VACATION','CALCULATE_HEALTH_TREND','generateContent','TRAIN_HEALTH','checkCalendarTriggers','infrasoundEnabled','getForeignObjectsAsync','refreshCalendar\x20failed:\x20','utf8','Room\x20History\x20(24h\x20Buckets)','Event','inactivityThresholdHours','Init...','./lib/python_bridge','then','analysis.ventilation.lastWindow','analysis.prediction.trackerConfidence','analysis.training.status','communicate.request','Live\x20Event\x20Pulse','LTM.trainingData.sequences','object','modeResetJob','location','getGenerativeModel','keys','Gemini\x20Report\x20Night','namespace','analyzeWindowOpening\x20error:\x20','NextHours.Location_1.Day_1.current.symbol_desc','triggerInfrasoundCorrelation','bind'];a0_0x1ecb=function(){return _0x5dbb57;};return a0_0x1ecb();}(function(_0x1c7066,_0x3f9f0a){const _0x467e9f=a0_0x17a8,_0x1daf69=_0x1c7066();while(!![]){try{const _0x1e348d=-parseInt(_0x467e9f(0x2e5))/0x1+-parseInt(_0x467e9f(0x347))/0x2+-parseInt(_0x467e9f(0x211))/0x3+-parseInt(_0x467e9f(0x33b))/0x4+parseInt(_0x467e9f(0x238))/0x5+-parseInt(_0x467e9f(0x23c))/0x6*(-parseInt(_0x467e9f(0x34e))/0x7)+parseInt(_0x467e9f(0x209))/0x8*(parseInt(_0x467e9f(0x26e))/0x9);if(_0x1e348d===_0x3f9f0a)break;else _0x1daf69['push'](_0x1daf69['shift']());}catch(_0x36fd7e){_0x1daf69['push'](_0x1daf69['shift']());}}}(a0_0x1ecb,0x18a26));const a0_0x4c9bf1=(function(){let _0x555e3b=!![];return function(_0x5c6e68,_0x455a9c){const _0x37805e=_0x555e3b?function(){const _0x2d1982=a0_0x17a8;if(_0x455a9c){const _0x251293=_0x455a9c[_0x2d1982(0x286)](_0x5c6e68,arguments);return _0x455a9c=null,_0x251293;}}:function(){};return _0x555e3b=![],_0x37805e;};}()),a0_0x44b841=a0_0x4c9bf1(this,function(){const _0x236bc3=a0_0x17a8;return a0_0x44b841[_0x236bc3(0x290)]()[_0x236bc3(0x323)](_0x236bc3(0x2e6))[_0x236bc3(0x290)]()[_0x236bc3(0x29d)](a0_0x44b841)[_0x236bc3(0x323)](_0x236bc3(0x2e6));});a0_0x44b841();'use strict';const utils=require(a0_0x58f094(0x2f4)),{GoogleGenerativeAI}=require(a0_0x58f094(0x2a9)),path=require(a0_0x58f094(0x25c)),fs=require('fs'),installer=require(a0_0x58f094(0x210)),scanner=require('./lib/scanner'),schedulers=require(a0_0x58f094(0x2ed)),topology=require('./lib/topology'),setup=require(a0_0x58f094(0x2b8)),recorder=require(a0_0x58f094(0x273)),pythonBridge=require(a0_0x58f094(0x1f0)),aiAgent=require(a0_0x58f094(0x25e)),deadMan=require(a0_0x58f094(0x2df)),automation=require(a0_0x58f094(0x2f0)),GEMINI_MODEL=a0_0x58f094(0x2a7);function a0_0x17a8(_0x25f884,_0x2bc84d){const _0x2fe294=a0_0x1ecb();return a0_0x17a8=function(_0x44b841,_0x4c9bf1){_0x44b841=_0x44b841-0x1ec;let _0x1ecb46=_0x2fe294[_0x44b841];return _0x1ecb46;},a0_0x17a8(_0x25f884,_0x2bc84d);}class CogniLiving extends utils[a0_0x58f094(0x20c)]{constructor(_0x1b83aa){const _0x295f95=a0_0x58f094;super({..._0x1b83aa,'name':_0x295f95(0x2ec)}),this[_0x295f95(0x2cd)]=[],this[_0x295f95(0x220)]=[],this[_0x295f95(0x34c)]=[],this[_0x295f95(0x248)]=[],this['sensorLastValues']={},this[_0x295f95(0x2e1)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x295f95(0x22b)]=!![],this[_0x295f95(0x33d)]=null,this[_0x295f95(0x317)]=null,this['isGracePeriodActive']=![],this['genAI']=null,this['geminiModel']=null,this[_0x295f95(0x2d6)]=setup['SYSTEM_MODES']['NORMAL'],this['isProVersion']=![],this['lastAlertState']=![],this[_0x295f95(0x2a3)]=null,this[_0x295f95(0x348)]=null,this[_0x295f95(0x2c9)]=null,this[_0x295f95(0x314)]=null,this[_0x295f95(0x1f9)]=null,this[_0x295f95(0x2c5)]=null,this[_0x295f95(0x236)]=null,this[_0x295f95(0x270)]=null,this[_0x295f95(0x245)]=null,this[_0x295f95(0x283)]=null,this[_0x295f95(0x29c)]=null,this['dependencyInstallInProgress']=![],this[_0x295f95(0x322)]=Date['now'](),this[_0x295f95(0x21e)]=null,this['bootTime']=Date[_0x295f95(0x26a)](),this[_0x295f95(0x24b)]=![],this[_0x295f95(0x2ca)]=[],this[_0x295f95(0x2b1)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x295f95(0x225),this[_0x295f95(0x25d)][_0x295f95(0x202)](this)),this['on'](_0x295f95(0x218),this[_0x295f95(0x2f2)][_0x295f95(0x202)](this)),this['on'](_0x295f95(0x2b2),this['onUnload']['bind'](this)),this['on'](_0x295f95(0x2e7),this[_0x295f95(0x351)][_0x295f95(0x202)](this));}async[a0_0x58f094(0x25d)](){const _0xee8601=a0_0x58f094;this[_0xee8601(0x34b)]['info'](_0xee8601(0x267)+this['version']+')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)');if(this['config'][_0xee8601(0x2b4)]!==undefined)this[_0xee8601(0x2b1)]['health']=this['config'][_0xee8601(0x2b4)];if(this['config'][_0xee8601(0x241)]!==undefined)this[_0xee8601(0x2b1)][_0xee8601(0x2bd)]=this['config'][_0xee8601(0x241)];if(this[_0xee8601(0x28b)][_0xee8601(0x21d)]!==undefined)this[_0xee8601(0x2b1)][_0xee8601(0x249)]=this['config']['moduleEnergy'];if(this[_0xee8601(0x28b)]['moduleComfort']!==undefined)this[_0xee8601(0x2b1)][_0xee8601(0x313)]=this['config'][_0xee8601(0x296)];if(this[_0xee8601(0x28b)][_0xee8601(0x2ae)])this[_0xee8601(0x2b1)]={...this['activeModules'],...this[_0xee8601(0x28b)][_0xee8601(0x2ae)]};this[_0xee8601(0x25f)]();}async[a0_0x58f094(0x25f)](){const _0x3cee67=a0_0x58f094;await setup[_0x3cee67(0x341)](this);try{this[_0x3cee67(0x2f3)]=await setup['checkLicense'](this[_0x3cee67(0x28b)][_0x3cee67(0x330)]);}catch(_0x43ccc3){}if(!this[_0x3cee67(0x28b)][_0x3cee67(0x1ee)]||this[_0x3cee67(0x28b)][_0x3cee67(0x1ee)]<0.1)this['config'][_0x3cee67(0x1ee)]=0xc;await setup[_0x3cee67(0x285)](this),await setup[_0x3cee67(0x21b)](this),topology['updateTopology'](this);try{const _0x1308bc=await this['getStateAsync'](_0x3cee67(0x25a)),_0xd6f337=await this[_0x3cee67(0x309)]('analysis.energy.warmupSources');_0x1308bc&&_0x1308bc[_0x3cee67(0x272)]&&_0xd6f337&&_0xd6f337['val']&&(Date[_0x3cee67(0x26a)]()-_0x1308bc['ts']<0x4*0xe10*0x3e8&&(this[_0x3cee67(0x21e)]={'times':JSON[_0x3cee67(0x320)](_0x1308bc[_0x3cee67(0x272)]),'sources':JSON['parse'](_0xd6f337[_0x3cee67(0x272)])}));}catch(_0xc16147){}if(this[_0x3cee67(0x28b)][_0x3cee67(0x263)])try{this[_0x3cee67(0x262)]=new GoogleGenerativeAI(this[_0x3cee67(0x28b)][_0x3cee67(0x263)]),this['geminiModel']=this[_0x3cee67(0x262)][_0x3cee67(0x1fb)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x3cee67(0x2b7)}});}catch(_0xf210ee){this[_0x3cee67(0x34b)][_0x3cee67(0x2d3)](_0x3cee67(0x355)+_0xf210ee[_0x3cee67(0x2e7)]);}await setup[_0x3cee67(0x281)](this),await this[_0x3cee67(0x34d)](),schedulers[_0x3cee67(0x32e)](this),await this['setObjectNotExistsAsync'](_0x3cee67(0x311),{'type':_0x3cee67(0x222),'common':{'name':_0x3cee67(0x1f6),'type':_0x3cee67(0x310),'role':_0x3cee67(0x221),'read':!![],'write':![]},'native':{}}),await this[_0x3cee67(0x240)]('analysis.activity.roomStats',{'type':_0x3cee67(0x222),'common':{'name':_0x3cee67(0x339),'type':_0x3cee67(0x297),'role':_0x3cee67(0x26f),'read':!![],'write':![],'def':'{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}'},'native':{}}),await this[_0x3cee67(0x240)]('analysis.activity.roomHistory',{'type':_0x3cee67(0x222),'common':{'name':_0x3cee67(0x1ec),'type':_0x3cee67(0x297),'role':_0x3cee67(0x26f),'read':!![],'write':![],'def':_0x3cee67(0x308)},'native':{}}),await this[_0x3cee67(0x240)](_0x3cee67(0x265),{'type':_0x3cee67(0x222),'common':{'name':_0x3cee67(0x1fd),'type':'string','role':_0x3cee67(0x2ef),'read':!![],'write':![],'def':_0x3cee67(0x31e)},'native':{}}),await this[_0x3cee67(0x240)](_0x3cee67(0x2c1),{'type':_0x3cee67(0x222),'common':{'name':'Gemini\x20Report\x20Day','type':'string','role':_0x3cee67(0x2ef),'read':!![],'write':![],'def':_0x3cee67(0x31e)},'native':{}}),await this[_0x3cee67(0x240)](_0x3cee67(0x31f),{'type':_0x3cee67(0x222),'common':{'name':_0x3cee67(0x22f),'type':_0x3cee67(0x297),'role':_0x3cee67(0x26f),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x3cee67(0x240)]('analysis.health.todayRoomDetails',{'type':_0x3cee67(0x222),'common':{'name':_0x3cee67(0x2ee),'type':_0x3cee67(0x297),'role':_0x3cee67(0x26f),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x3cee67(0x240)](_0x3cee67(0x22c),{'type':'state','common':{'name':_0x3cee67(0x32a),'type':_0x3cee67(0x310),'role':_0x3cee67(0x221),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x3cee67(0x240)](_0x3cee67(0x25a),{'type':_0x3cee67(0x222),'common':{'name':_0x3cee67(0x237),'type':_0x3cee67(0x297),'role':_0x3cee67(0x26f),'read':!![],'write':![]},'native':{}});try{const _0x57edcc=await this['getStateAsync']('events.history');if(_0x57edcc&&_0x57edcc[_0x3cee67(0x272)]){this[_0x3cee67(0x2cd)]=JSON[_0x3cee67(0x320)](_0x57edcc['val']);if(this[_0x3cee67(0x2f3)]){const _0x149a87=await this[_0x3cee67(0x309)](_0x3cee67(0x299));if(_0x149a87&&_0x149a87[_0x3cee67(0x272)])this[_0x3cee67(0x34c)]=JSON[_0x3cee67(0x320)](_0x149a87['val']);}this['log'][_0x3cee67(0x331)](_0x3cee67(0x28f)+this[_0x3cee67(0x2cd)][_0x3cee67(0x29b)]+_0x3cee67(0x280));}}catch(_0x4fb6b6){this[_0x3cee67(0x2cd)]=[];}try{const _0x1db7db=await this['getStateAsync'](_0x3cee67(0x306));if(_0x1db7db&&_0x1db7db[_0x3cee67(0x272)])this['dailyDigests']=JSON[_0x3cee67(0x320)](_0x1db7db[_0x3cee67(0x272)]);}catch(_0x2a1f63){this[_0x3cee67(0x248)]=[];}const _0x471184=this[_0x3cee67(0x248)][_0x3cee67(0x29b)]>=(this[_0x3cee67(0x28b)]['minDaysForBaseline']||0x7)?_0x3cee67(0x216)+this[_0x3cee67(0x248)][_0x3cee67(0x29b)]+'\x20Tage)':_0x3cee67(0x2d5)+this['dailyDigests']['length']+'/'+(this[_0x3cee67(0x28b)][_0x3cee67(0x2be)]||0x7)+')';await this[_0x3cee67(0x233)]('LTM.baselineStatus',{'val':_0x471184,'ack':!![]}),this['subscribeStates']('analysis.trigger'),this[_0x3cee67(0x251)]('LTM.triggerDailyDigest'),this[_0x3cee67(0x251)](_0x3cee67(0x2d9));this['config'][_0x3cee67(0x35b)]&&this[_0x3cee67(0x28b)][_0x3cee67(0x34a)]&&this[_0x3cee67(0x2b1)][_0x3cee67(0x2bd)]&&this[_0x3cee67(0x208)](this[_0x3cee67(0x28b)][_0x3cee67(0x34a)]);const _0x1457d7=this[_0x3cee67(0x28b)][_0x3cee67(0x22d)];if(_0x1457d7)for(const _0x190bd4 of _0x1457d7){await this[_0x3cee67(0x31a)](_0x190bd4['id']);}const _0x55f02b=this['config'][_0x3cee67(0x244)];if(_0x55f02b)for(const _0xb2a065 of _0x55f02b){await this[_0x3cee67(0x31a)](_0xb2a065);}const _0x21af62=require(_0x3cee67(0x227));if(this[_0x3cee67(0x270)])this[_0x3cee67(0x270)]['cancel']();this[_0x3cee67(0x270)]=_0x21af62[_0x3cee67(0x268)](_0x3cee67(0x32b),()=>{const _0x5c1d57=_0x3cee67;this[_0x5c1d57(0x2e0)]();}),setTimeout(()=>this[_0x3cee67(0x24d)](),0x1388);if(this[_0x3cee67(0x29c)])clearInterval(this['roomIntegratorTimer']);this[_0x3cee67(0x217)](),this[_0x3cee67(0x29c)]=setInterval(async()=>{const _0x1a8a86=_0x3cee67;await this[_0x1a8a86(0x217)]();},0x3c*0x3e8);if(this['healthTrendInterval'])clearInterval(this['healthTrendInterval']);this[_0x3cee67(0x283)]=setInterval(()=>{const _0x18c483=_0x3cee67;this['isProVersion']&&this[_0x18c483(0x2b1)]['health']&&this[_0x18c483(0x2ff)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x3cee67(0x2a3)])clearInterval(this[_0x3cee67(0x2a3)]);this[_0x3cee67(0x2b1)][_0x3cee67(0x249)]&&(this[_0x3cee67(0x2a3)]=setInterval(()=>{const _0xa28e4a=_0x3cee67;this[_0xa28e4a(0x30a)]();},0xf*0x3c*0x3e8),setTimeout(()=>this['triggerEnergyPrediction'](),0x2710));if(this[_0x3cee67(0x348)])clearInterval(this[_0x3cee67(0x348)]);this[_0x3cee67(0x28b)][_0x3cee67(0x295)]&&this[_0x3cee67(0x2b1)][_0x3cee67(0x249)]&&(this[_0x3cee67(0x348)]=setInterval(()=>{const _0x441f44=_0x3cee67;automation[_0x441f44(0x35a)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x3cee67(0x35a)](this),0x3a98));if(this[_0x3cee67(0x2c9)])clearInterval(this[_0x3cee67(0x2c9)]);this['config']['presenceDevices']&&this['config']['presenceDevices'][_0x3cee67(0x29b)]>0x0&&(this[_0x3cee67(0x2c9)]=setInterval(async()=>{await this['checkWifiPresence']();},0x3c*0x3e8),setTimeout(async()=>await this[_0x3cee67(0x346)](),0x1388));const _0x53dabd=path[_0x3cee67(0x2d1)](__dirname,_0x3cee67(0x33c),_0x3cee67(0x332),_0x3cee67(0x293));pythonBridge[_0x3cee67(0x266)](this,_0x53dabd);}['onUnload'](_0x5a3fa4){const _0x37f4d8=a0_0x58f094;if(this[_0x37f4d8(0x270)])this[_0x37f4d8(0x270)][_0x37f4d8(0x23b)]();this[_0x37f4d8(0x2e0)]()[_0x37f4d8(0x1f1)](()=>{const _0x4d3595=_0x37f4d8;if(this['analysisTimer'])clearInterval(this['analysisTimer']);if(this[_0x4d3595(0x348)])clearInterval(this['calendarCheckTimer']);if(this[_0x4d3595(0x2c9)])clearInterval(this[_0x4d3595(0x2c9)]);if(this[_0x4d3595(0x29c)])clearInterval(this[_0x4d3595(0x29c)]);recorder['abortExitTimer'](this),pythonBridge[_0x4d3595(0x2e2)](this),_0x5a3fa4();});}async[a0_0x58f094(0x24d)](){const _0x3d3541=a0_0x58f094;if(!this[_0x3d3541(0x2cd)]||this[_0x3d3541(0x2cd)][_0x3d3541(0x29b)]===0x0){this[_0x3d3541(0x34b)][_0x3d3541(0x28c)]('‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.');return;}this['log'][_0x3d3541(0x331)](_0x3d3541(0x2ea)+this[_0x3d3541(0x2cd)][_0x3d3541(0x29b)]+'\x20events\x20from\x20today...');const _0x3ecc3a=new Date()['setHours'](0x0,0x0,0x0,0x0),_0x4f6f2e=_0x3d3541(0x24a);let _0x48be92={'history':{},'date':new Date()[_0x3d3541(0x321)]()};const _0x516ee6=_0x3d3541(0x31f),_0x4ac760='analysis.health.todayRoomDetails';let _0x3b0eaf=new Array(0x30)[_0x3d3541(0x27d)](0x0),_0x19f146=Array['from']({'length':0x30},()=>[]);this[_0x3d3541(0x2cd)][_0x3d3541(0x31d)](_0x129301=>{const _0x6860bc=_0x3d3541;if(_0x129301[_0x6860bc(0x260)]>=_0x3ecc3a){if(recorder['isRelevantActivity'](_0x129301['type'],_0x129301['value'])){const _0x15ff94=new Date(_0x129301[_0x6860bc(0x260)]),_0x567b33=_0x15ff94[_0x6860bc(0x25b)]()*0x2+(_0x15ff94['getMinutes']()>=0x1e?0x1:0x0);if(_0x567b33<0x30){_0x3b0eaf[_0x567b33]++;const _0x9f3590=_0x129301['location']||_0x129301['name']||'?';let _0x542171=_0x19f146[_0x567b33];!_0x542171[_0x6860bc(0x2ba)](_0x9f3590)&&_0x542171[_0x6860bc(0x26d)](_0x9f3590);}const _0x5f4d80=_0x15ff94[_0x6860bc(0x25b)]();let _0x363bff=_0x129301['location']||'Unknown';const _0x2e9c73=(this[_0x6860bc(0x28b)][_0x6860bc(0x22d)]||[])['find'](_0x45f95e=>_0x45f95e[_0x6860bc(0x1fa)]===_0x363bff);if(_0x2e9c73)_0x363bff=_0x2e9c73[_0x6860bc(0x1fa)];if(!_0x48be92[_0x6860bc(0x2a1)][_0x363bff])_0x48be92[_0x6860bc(0x2a1)][_0x363bff]=new Array(0x18)['fill'](0x0);if(_0x48be92[_0x6860bc(0x2a1)][_0x363bff][_0x5f4d80]<0x3c)_0x48be92[_0x6860bc(0x2a1)][_0x363bff][_0x5f4d80]++;}}});const _0x132222=await this['getStateAsync'](_0x4f6f2e);(!_0x132222||!_0x132222['val']||_0x132222[_0x3d3541(0x272)]==='{}'||_0x132222['val'][_0x3d3541(0x2ba)](_0x3d3541(0x28e)))&&await this['setStateAsync'](_0x4f6f2e,{'val':JSON[_0x3d3541(0x2e9)](_0x48be92),'ack':!![]}),await this[_0x3d3541(0x233)](_0x516ee6,{'val':JSON[_0x3d3541(0x2e9)](_0x3b0eaf),'ack':!![]}),await this['setStateAsync'](_0x4ac760,{'val':JSON[_0x3d3541(0x2e9)](_0x19f146),'ack':!![]}),this[_0x3d3541(0x34b)][_0x3d3541(0x331)](_0x3d3541(0x312));}async[a0_0x58f094(0x2e0)](){const _0x1c357d=a0_0x58f094;if(!this[_0x1c357d(0x2b1)][_0x1c357d(0x226)])return;const _0x3db07d=new Date()[_0x1c357d(0x257)]()['split']('T')[0x0];this[_0x1c357d(0x34b)][_0x1c357d(0x21a)](_0x1c357d(0x20b)+_0x3db07d+_0x1c357d(0x291));try{const [_0x60430,_0x586938,_0x27681d,_0x7c8ed1,_0x3796b7,_0x207371]=await Promise[_0x1c357d(0x305)]([this[_0x1c357d(0x309)]('analysis.activity.roomHistory'),this[_0x1c357d(0x309)](_0x1c357d(0x265)),this[_0x1c357d(0x309)](_0x1c357d(0x2c1)),this['getStateAsync'](_0x1c357d(0x2b0)),this[_0x1c357d(0x309)](_0x1c357d(0x31f)),this[_0x1c357d(0x309)](_0x1c357d(0x22c))]),_0x56c7d2=this[_0x1c357d(0x2cd)][_0x1c357d(0x279)](_0x3349ba=>_0x3349ba[_0x1c357d(0x260)]>=new Date()[_0x1c357d(0x344)](0x0,0x0,0x0,0x0)&&(_0x3349ba[_0x1c357d(0x2ce)][_0x1c357d(0x301)]()[_0x1c357d(0x2ba)]('haust√ºr')||_0x3349ba[_0x1c357d(0x2ce)]['toLowerCase']()[_0x1c357d(0x2ba)]('terrasse'))&&(_0x3349ba['value']===!![]||_0x3349ba[_0x1c357d(0x221)]===_0x1c357d(0x2e4)))[_0x1c357d(0x29b)];let _0x3f200c=0x55;if(_0x207371&&_0x207371[_0x1c357d(0x272)]!==undefined)_0x3f200c=Math[_0x1c357d(0x2cc)](0x64,Math[_0x1c357d(0x232)](0x14,Math[_0x1c357d(0x353)](0x50+Number(_0x207371[_0x1c357d(0x272)])*0x5)));const _0x5c7fd9={'date':_0x3db07d,'timestamp':Date['now'](),'roomHistory':_0x60430?.[_0x1c357d(0x272)]?JSON['parse'](_0x60430[_0x1c357d(0x272)]):{},'geminiNight':_0x586938?.[_0x1c357d(0x272)]||_0x1c357d(0x2db),'geminiDay':_0x27681d?.[_0x1c357d(0x272)]||'Keine\x20Daten','anomalyScore':_0x7c8ed1?.['val']||0.1,'todayVector':_0x3796b7?.['val']?JSON[_0x1c357d(0x320)](_0x3796b7[_0x1c357d(0x272)]):new Array(0x30)[_0x1c357d(0x27d)](0x0),'batteryLevel':_0x3f200c,'freshAirCount':_0x56c7d2,'eventHistory':this[_0x1c357d(0x2cd)]},_0x2dbac2=utils[_0x1c357d(0x336)](),_0x57fedf=path['join'](_0x2dbac2,_0x1c357d(0x2ec),_0x1c357d(0x2a1));if(!fs[_0x1c357d(0x32c)](_0x57fedf))fs[_0x1c357d(0x2a0)](_0x57fedf,{'recursive':!![]});const _0x538ead=path['join'](_0x57fedf,_0x3db07d+_0x1c357d(0x289));fs[_0x1c357d(0x33e)](_0x538ead,JSON[_0x1c357d(0x2e9)](_0x5c7fd9)),this['log'][_0x1c357d(0x331)](_0x1c357d(0x2e8)+_0x538ead);}catch(_0x3823f5){this['log'][_0x1c357d(0x2d3)]('History\x20Save\x20Error:\x20'+_0x3823f5[_0x1c357d(0x2e7)]);}}async['integrateRoomTime'](){const _0x25483a=a0_0x58f094;if(!this[_0x25483a(0x22b)])return;try{let _0x851bcd=null;try{const _0xbc3fe6=await this['getStateAsync']('analysis.prediction.trackerTopRoom'),_0x2b59c7=await this[_0x25483a(0x309)](_0x25483a(0x1f3));if(_0xbc3fe6&&_0xbc3fe6[_0x25483a(0x272)]&&_0x2b59c7&&_0x2b59c7[_0x25483a(0x272)]&&_0x2b59c7[_0x25483a(0x272)]>0.3){if(_0xbc3fe6[_0x25483a(0x272)]!==_0x25483a(0x23f)&&_0xbc3fe6[_0x25483a(0x272)]!==_0x25483a(0x1ef))_0x851bcd=_0xbc3fe6['val'];}}catch(_0x2b74ef){}if(!_0x851bcd){const _0x30d342=this[_0x25483a(0x28b)][_0x25483a(0x22d)]||[];for(const _0x42f85a of _0x30d342){if(_0x42f85a['type']===_0x25483a(0x2b3)&&_0x42f85a[_0x25483a(0x1fa)])try{const _0x389c6e=await this[_0x25483a(0x2fc)](_0x42f85a['id']);if(_0x389c6e&&(_0x389c6e[_0x25483a(0x272)]===!![]||_0x389c6e[_0x25483a(0x272)]==='on'||_0x389c6e['val']===0x1)){_0x851bcd=_0x42f85a[_0x25483a(0x1fa)];break;}}catch(_0x130480){}}}if(!_0x851bcd)return;const _0x37dadb=this[_0x25483a(0x28b)]['devices']||[];let _0x11327b=_0x851bcd;const _0x45053c=_0x37dadb[_0x25483a(0x255)](_0x3521dc=>_0x3521dc[_0x25483a(0x1fa)]&&_0x3521dc[_0x25483a(0x1fa)][_0x25483a(0x301)]()===_0x851bcd['toLowerCase']());if(_0x45053c)_0x11327b=_0x45053c['location'];const _0x33f95e='analysis.activity.roomHistory',_0x3650fc=await this['getStateAsync'](_0x33f95e),_0x4b23f1=new Date()[_0x25483a(0x321)]();let _0x142c5c={'history':{},'date':_0x4b23f1};if(_0x3650fc&&_0x3650fc['val'])try{_0x142c5c=JSON['parse'](_0x3650fc['val']);}catch(_0x12d9d){}_0x142c5c[_0x25483a(0x2d4)]!==_0x4b23f1&&(_0x142c5c[_0x25483a(0x2a1)]={},_0x142c5c[_0x25483a(0x2d4)]=_0x4b23f1);if(!_0x142c5c[_0x25483a(0x2a1)][_0x11327b])_0x142c5c['history'][_0x11327b]=new Array(0x18)[_0x25483a(0x27d)](0x0);const _0x20c333=new Date()[_0x25483a(0x25b)]();if(_0x142c5c[_0x25483a(0x2a1)][_0x11327b][_0x20c333]<0x3c)_0x142c5c['history'][_0x11327b][_0x20c333]++;await this['setStateAsync'](_0x33f95e,{'val':JSON['stringify'](_0x142c5c),'ack':!![]});}catch(_0x343e70){this['log'][_0x25483a(0x28c)](_0x25483a(0x239)+_0x343e70[_0x25483a(0x2e7)]);}}async[a0_0x58f094(0x351)](_0x26bbb9){const _0x2f166d=a0_0x58f094;if(typeof _0x26bbb9===_0x2f166d(0x1f8)&&_0x26bbb9[_0x2f166d(0x2e7)]){if(_0x26bbb9['command']==='getHistoryData'){const _0x2f565a=_0x26bbb9[_0x2f166d(0x2e7)][_0x2f166d(0x2d4)],_0x149edc=utils['getAbsoluteDefaultDataDir'](),_0xbc9a64=path['join'](_0x149edc,'cogni-living','history',_0x2f565a+'.json');if(fs[_0x2f166d(0x32c)](_0xbc9a64))try{const _0x27ad4c=JSON[_0x2f166d(0x320)](fs['readFileSync'](_0xbc9a64,_0x2f166d(0x35e)));this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'success':!![],'data':_0x27ad4c},_0x26bbb9[_0x2f166d(0x2fd)]);}catch(_0x58fb71){this['sendTo'](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'success':![],'error':_0x2f166d(0x2d2)},_0x26bbb9[_0x2f166d(0x2fd)]);}else this['sendTo'](_0x26bbb9['from'],_0x26bbb9['command'],{'success':![],'error':_0x2f166d(0x2dc)},_0x26bbb9[_0x2f166d(0x2fd)]);}else{if(_0x26bbb9['command']===_0x2f166d(0x284)){const _0x2f19fe=this[_0x2f166d(0x248)]['length'];let _0xc19579=new Array(0x30)[_0x2f166d(0x27d)](0x0),_0x33ef70=Array['from']({'length':0x30},()=>[]);try{const _0xabc6ec=await this['getStateAsync'](_0x2f166d(0x31f));if(_0xabc6ec&&_0xabc6ec[_0x2f166d(0x272)])_0xc19579=JSON[_0x2f166d(0x320)](_0xabc6ec[_0x2f166d(0x272)]);const _0x5c2c7e=await this[_0x2f166d(0x309)](_0x2f166d(0x2bf));if(_0x5c2c7e&&_0x5c2c7e[_0x2f166d(0x272)])_0x33ef70=JSON['parse'](_0x5c2c7e['val']);}catch(_0x471de6){}let _0x3f23a0=new Array(0x30)['fill'](0x0);try{const _0x2ceb9a=new Date();_0x2ceb9a[_0x2f166d(0x204)](_0x2ceb9a['getDate']()-0x1);const _0x411823=_0x2ceb9a['toISOString']()[_0x2f166d(0x2bc)]('T')[0x0],_0x30bb60=utils['getAbsoluteDefaultDataDir'](),_0x39cbf6=path[_0x2f166d(0x2d1)](_0x30bb60,_0x2f166d(0x2ec),_0x2f166d(0x2a1),_0x411823+_0x2f166d(0x289));if(fs['existsSync'](_0x39cbf6)){const _0xd4e3a8=JSON[_0x2f166d(0x320)](fs[_0x2f166d(0x2f1)](_0x39cbf6,'utf8'));if(_0xd4e3a8&&_0xd4e3a8['todayVector'])_0x3f23a0=_0xd4e3a8[_0x2f166d(0x282)];}}catch(_0x6bb482){}let _0x30c3ec={'today':{},'yesterday':{}};try{const _0x17182e=await this[_0x2f166d(0x309)]('analysis.activity.roomStats');if(_0x17182e&&_0x17182e[_0x2f166d(0x272)])_0x30c3ec=JSON['parse'](_0x17182e[_0x2f166d(0x272)]);}catch(_0xbf6cae){}let _0x16f415=null;try{const _0x50b3d1=await this['getStateAsync']('analysis.health.activityTrend');if(_0x50b3d1)_0x16f415=_0x50b3d1[_0x2f166d(0x272)];}catch(_0x3263b8){}if(_0x16f415===undefined||_0x16f415===null){const _0x40d3e0=_0xc19579[_0x2f166d(0x224)]((_0x2ddcc4,_0x433770)=>_0x2ddcc4+_0x433770,0x0),_0x3dfe35=Math['min'](0x2,Math[_0x2f166d(0x232)](-0x2,(0x64-_0x40d3e0)/0x32));_0x16f415=_0x3dfe35;}let _0x2c968e=![],_0x323f87='',_0x4ab20f='',_0x57b1ad='';try{const _0x3a3f8b=await this[_0x2f166d(0x309)]('analysis.automation.patternDetected');if(_0x3a3f8b&&_0x3a3f8b[_0x2f166d(0x272)]){_0x2c968e=!![];const _0x2baa06=await this[_0x2f166d(0x309)]('analysis.automation.description');_0x323f87=_0x2baa06?_0x2baa06['val']:'';const _0x175946=await this[_0x2f166d(0x309)]('analysis.automation.targetId');_0x4ab20f=_0x175946?_0x175946[_0x2f166d(0x272)]:'';const _0x262739=await this[_0x2f166d(0x309)](_0x2f166d(0x207));_0x57b1ad=_0x262739?_0x262739[_0x2f166d(0x272)]:'';}}catch(_0x16d810){}const _0x5499ce=await this[_0x2f166d(0x21f)](),_0x2fe843=(this[_0x2f166d(0x28b)][_0x2f166d(0x22d)]||[])[_0x2f166d(0x2f8)](_0x1faccb=>_0x1faccb['isSolar']),_0x2f17f1=_0x5499ce&&_0x2fe843;let _0x1c79df='';try{const _0x4e7dac=await this[_0x2f166d(0x309)](_0x2f166d(0x335));if(_0x4e7dac&&_0x4e7dac[_0x2f166d(0x272)])_0x1c79df=_0x4e7dac[_0x2f166d(0x272)];}catch(_0xb7ebda){}this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'success':!![],'eventHistory':this['eventHistory'][_0x2f166d(0x288)](0x0,0x7d0),'stats':{'digestCount':_0x2f19fe,'isPresent':this[_0x2f166d(0x22b)],'hourlyActivity':_0xc19579,'hourlyDetails':_0x33ef70,'yesterdayActivity':_0x3f23a0,'solarActive':_0x2f17f1,'presenceWho':_0x1c79df,'roomStats':_0x30c3ec,'activityTrend':_0x16f415,'modules':this[_0x2f166d(0x2b1)]},'automation':{'detected':_0x2c968e,'description':_0x323f87,'targetId':_0x4ab20f,'targetValue':_0x57b1ad}},_0x26bbb9[_0x2f166d(0x2fd)]);}else{if(_0x26bbb9[_0x2f166d(0x315)]===_0x2f166d(0x27b))try{const _0x23c775=await automation[_0x2f166d(0x2da)](this);this[_0x2f166d(0x352)](_0x26bbb9['from'],_0x26bbb9[_0x2f166d(0x315)],{'success':!![],'results':_0x23c775},_0x26bbb9['callback']);}catch(_0x2ed8a1){this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'success':![],'error':_0x2ed8a1[_0x2f166d(0x2e7)]},_0x26bbb9[_0x2f166d(0x2fd)]);}else{if(_0x26bbb9['command']===_0x2f166d(0x337))try{const _0x1d6220=await scanner[_0x2f166d(0x27a)](this,_0x26bbb9[_0x2f166d(0x2e7)]||{});this[_0x2f166d(0x352)](_0x26bbb9['from'],_0x26bbb9[_0x2f166d(0x315)],{'success':!![],'devices':_0x1d6220},_0x26bbb9[_0x2f166d(0x2fd)]);}catch(_0x2212fa){}else{if(_0x26bbb9[_0x2f166d(0x315)]===_0x2f166d(0x30b)){const _0x3d2cad=await this[_0x2f166d(0x35c)](_0x2f166d(0x230),_0x2f166d(0x277)),_0x5e2499=[];if(_0x3d2cad)for(const _0x1eb166 in _0x3d2cad){let _0x28d230=_0x3d2cad[_0x1eb166][_0x2f166d(0x212)][_0x2f166d(0x2ce)];if(_0x28d230&&typeof _0x28d230===_0x2f166d(0x1f8))_0x28d230=_0x28d230['de']||_0x28d230['en']||Object[_0x2f166d(0x243)](_0x28d230)[0x0]||JSON[_0x2f166d(0x2e9)](_0x28d230);_0x5e2499[_0x2f166d(0x26d)]({'id':_0x1eb166,'name':String(_0x28d230||_0x1eb166)});}const _0x486c34=await this[_0x2f166d(0x35c)]('enum.rooms.*',_0x2f166d(0x277)),_0x45a3da=[];if(_0x486c34)for(const _0x50ac89 in _0x486c34){let _0x2b4bea=_0x486c34[_0x50ac89][_0x2f166d(0x212)][_0x2f166d(0x2ce)];if(_0x2b4bea&&typeof _0x2b4bea===_0x2f166d(0x1f8))_0x2b4bea=_0x2b4bea['de']||_0x2b4bea['en']||Object['values'](_0x2b4bea)[0x0]||JSON[_0x2f166d(0x2e9)](_0x2b4bea);_0x45a3da[_0x2f166d(0x26d)](String(_0x2b4bea||_0x50ac89[_0x2f166d(0x2bc)]('.')['pop']()));}this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'success':!![],'enums':_0x5e2499,'rooms':_0x45a3da},_0x26bbb9[_0x2f166d(0x2fd)]);}else{if(_0x26bbb9[_0x2f166d(0x315)]==='getCalendarNames')try{const _0x456010=await this[_0x2f166d(0x213)](_0x2f166d(0x2f6),'instance',{'startkey':_0x2f166d(0x2b9),'endkey':_0x2f166d(0x253)}),_0x1605bf=new Set();if(_0x456010&&_0x456010[_0x2f166d(0x258)])for(const _0x1d0a36 of _0x456010[_0x2f166d(0x258)]){const _0x182fa8=_0x1d0a36['id'][_0x2f166d(0x2b5)](_0x2f166d(0x32f),''),_0x81c1af=await this[_0x2f166d(0x2fc)](_0x182fa8+_0x2f166d(0x228));let _0x33fbff=![];if(_0x81c1af&&_0x81c1af['val']){const _0x4f910b=typeof _0x81c1af[_0x2f166d(0x272)]===_0x2f166d(0x297)?JSON['parse'](_0x81c1af[_0x2f166d(0x272)]):_0x81c1af[_0x2f166d(0x272)];Array[_0x2f166d(0x234)](_0x4f910b)&&_0x4f910b['forEach'](_0x1da84b=>{const _0x2c5bba=_0x2f166d;_0x1da84b[_0x2c5bba(0x325)]&&(_0x1605bf[_0x2c5bba(0x326)](_0x1da84b[_0x2c5bba(0x325)]),_0x33fbff=!![]);});}!_0x33fbff&&_0x1605bf['add'](_0x182fa8);}const _0x4db5e2=Array[_0x2f166d(0x2e3)](_0x1605bf);if(_0x4db5e2[_0x2f166d(0x29b)]===0x0)_0x4db5e2[_0x2f166d(0x26d)](_0x2f166d(0x333));this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'success':!![],'names':_0x4db5e2},_0x26bbb9[_0x2f166d(0x2fd)]);}catch(_0x382027){this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'success':![],'error':'Scan\x20Error:\x20'+_0x382027[_0x2f166d(0x2e7)]},_0x26bbb9[_0x2f166d(0x2fd)]);}else{if(_0x26bbb9['command']===_0x2f166d(0x20f))try{await automation[_0x2f166d(0x2dd)](this),this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'success':!![]},_0x26bbb9[_0x2f166d(0x2fd)]);}catch(_0x4f970a){this[_0x2f166d(0x34b)][_0x2f166d(0x28c)](_0x2f166d(0x35d)+_0x4f970a[_0x2f166d(0x2e7)]),this[_0x2f166d(0x352)](_0x26bbb9['from'],_0x26bbb9[_0x2f166d(0x315)],{'success':![],'error':_0x4f970a[_0x2f166d(0x2e7)]},_0x26bbb9['callback']);}else{if(_0x26bbb9[_0x2f166d(0x315)]===_0x2f166d(0x219))try{const _0x2187e7=_0x26bbb9['message'][_0x2f166d(0x315)],_0x1a6a26=_0x26bbb9[_0x2f166d(0x2e7)];this[_0x2f166d(0x34b)]['debug'](_0x2f166d(0x345)+_0x2187e7),pythonBridge[_0x2f166d(0x2a6)](this,_0x2187e7,_0x1a6a26,_0x38a16e=>{const _0x3c9eb8=_0x2f166d;this[_0x3c9eb8(0x352)](_0x26bbb9[_0x3c9eb8(0x2e3)],_0x26bbb9['command'],_0x38a16e,_0x26bbb9[_0x3c9eb8(0x2fd)]);});}catch(_0x310e69){this[_0x2f166d(0x34b)][_0x2f166d(0x28c)](_0x2f166d(0x2b6)+_0x310e69[_0x2f166d(0x2e7)]),this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9[_0x2f166d(0x315)],{'type':_0x2f166d(0x316),'payload':_0x310e69[_0x2f166d(0x2e7)]},_0x26bbb9[_0x2f166d(0x2fd)]);}else{if(_0x26bbb9[_0x2f166d(0x315)]===_0x2f166d(0x28a))try{const _0x373c80=_0x26bbb9[_0x2f166d(0x2e7)]?_0x26bbb9[_0x2f166d(0x2e7)]['apiKey']:'';if(!_0x373c80)throw new Error(_0x2f166d(0x2c8));const _0x43ef33=new GoogleGenerativeAI(_0x373c80),_0x30a604=_0x43ef33[_0x2f166d(0x1fb)]({'model':GEMINI_MODEL}),_0x4b1300=await _0x30a604[_0x2f166d(0x358)](_0x2f166d(0x294)),_0x9c28bc=await _0x4b1300['response'],_0x5bb1f3=_0x9c28bc['text']();this['sendTo'](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9['command'],{'success':!![],'message':'Verbindung\x20erfolgreich:\x20'+_0x5bb1f3[_0x2f166d(0x2a8)](0x0,0x14)+_0x2f166d(0x291)},_0x26bbb9[_0x2f166d(0x2fd)]);}catch(_0x15793f){this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9['command'],{'success':![],'message':_0x15793f[_0x2f166d(0x2e7)]},_0x26bbb9[_0x2f166d(0x2fd)]);}else{if(_0x26bbb9[_0x2f166d(0x315)]===_0x2f166d(0x24e))try{const _0x669f99=await this[_0x2f166d(0x21f)](),_0x50c7b0=await this[_0x2f166d(0x213)]('system',_0x2f166d(0x223),{'startkey':'system.adapter.ical.','endkey':_0x2f166d(0x253)}),_0x391332=_0x50c7b0&&_0x50c7b0[_0x2f166d(0x258)]?_0x50c7b0[_0x2f166d(0x258)][_0x2f166d(0x29b)]:0x0;this[_0x2f166d(0x352)](_0x26bbb9[_0x2f166d(0x2e3)],_0x26bbb9['command'],{'success':!![],'weather':_0x2f166d(0x2a2)+_0x669f99+_0x2f166d(0x29f)+(this[_0x2f166d(0x2a5)][this[_0x2f166d(0x28b)][_0x2f166d(0x2fe)]]||'?')+'¬∞C','calendar':_0x391332+_0x2f166d(0x271)},_0x26bbb9[_0x2f166d(0x2fd)]);}catch(_0x16301a){this['sendTo'](_0x26bbb9['from'],_0x26bbb9[_0x2f166d(0x315)],{'success':![]},_0x26bbb9[_0x2f166d(0x2fd)]);}}}}}}}}}}}}['runPythonHealthCheck'](){const _0x1890ae=a0_0x58f094;if(!this[_0x1890ae(0x2b1)][_0x1890ae(0x226)])return;this[_0x1890ae(0x34b)][_0x1890ae(0x21a)](_0x1890ae(0x2fa));try{const _0x35ef26=this[_0x1890ae(0x34c)]||[];pythonBridge[_0x1890ae(0x2a6)](this,_0x1890ae(0x357),{'events':_0x35ef26});}catch(_0x21e25d){this[_0x1890ae(0x34b)][_0x1890ae(0x28c)](_0x1890ae(0x235));}}async[a0_0x58f094(0x2f2)](_0x1b11a8,_0x56fe2a){const _0x51e9a4=a0_0x58f094;if(!_0x56fe2a||this['dependencyInstallInProgress'])return;if(_0x1b11a8[_0x51e9a4(0x2ba)](_0x51e9a4(0x23a))&&_0x1b11a8['endsWith'](_0x51e9a4(0x1f5))&&_0x56fe2a[_0x51e9a4(0x272)])return;if(this[_0x51e9a4(0x28b)][_0x51e9a4(0x35b)]&&_0x1b11a8===this['config'][_0x51e9a4(0x34a)]&&this['activeModules'][_0x51e9a4(0x2bd)]){this['handleInfrasound'](_0x56fe2a[_0x51e9a4(0x272)]);return;}if(_0x56fe2a[_0x51e9a4(0x334)]&&_0x1b11a8[_0x51e9a4(0x214)]('pulse'))return;if(_0x1b11a8===this[_0x51e9a4(0x1fe)]+_0x51e9a4(0x2cb)){if(_0x56fe2a[_0x51e9a4(0x272)]&&Object[_0x51e9a4(0x243)](setup[_0x51e9a4(0x30c)])[_0x51e9a4(0x2ba)](_0x56fe2a[_0x51e9a4(0x272)])){this[_0x51e9a4(0x2d6)]=_0x56fe2a['val'];if(_0x56fe2a[_0x51e9a4(0x272)]===setup['SYSTEM_MODES'][_0x51e9a4(0x356)])await recorder[_0x51e9a4(0x2de)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x51e9a4(0x2f3)]){let _0x54f667=![],_0x4628e5=0x0,_0x119b19=_0x51e9a4(0x340);if(this[_0x51e9a4(0x2d6)]===_0x51e9a4(0x205))_0x54f667=!![],_0x4628e5=0x168,_0x119b19='Party\x20Mode';else this[_0x51e9a4(0x2d6)]===_0x51e9a4(0x256)&&(_0x54f667=!![],_0x4628e5=0x5a0,_0x119b19=_0x51e9a4(0x33f));pythonBridge[_0x51e9a4(0x2a6)](this,_0x51e9a4(0x246),{'active':_0x54f667,'duration':_0x4628e5,'label':_0x119b19}),await this[_0x51e9a4(0x233)]('analysis.security.learningStatus',{'val':JSON['stringify']({'active':_0x54f667,'label':_0x119b19,'timestamp':Date[_0x51e9a4(0x26a)]()}),'ack':!![]});}}if(!_0x56fe2a[_0x51e9a4(0x334)])this[_0x51e9a4(0x2ab)](_0x1b11a8,{'val':this[_0x51e9a4(0x2d6)],'ack':!![]});return;}if(_0x1b11a8[_0x51e9a4(0x214)](_0x51e9a4(0x2cf))&&_0x56fe2a[_0x51e9a4(0x334)])this[_0x51e9a4(0x31b)](_0x56fe2a['val']);if(_0x1b11a8[_0x51e9a4(0x214)](_0x51e9a4(0x25a))&&_0x56fe2a[_0x51e9a4(0x334)]&&this[_0x51e9a4(0x2b1)][_0x51e9a4(0x249)])automation[_0x51e9a4(0x35a)](this);if(!_0x56fe2a[_0x51e9a4(0x334)]){if(_0x1b11a8['includes'](_0x51e9a4(0x278))&&_0x56fe2a['val']){this[_0x51e9a4(0x2ab)](_0x1b11a8,{'val':![],'ack':!![]}),aiAgent[_0x51e9a4(0x303)](this);return;}if(_0x1b11a8[_0x51e9a4(0x2ba)](_0x51e9a4(0x20a))&&_0x56fe2a[_0x51e9a4(0x272)]){this[_0x51e9a4(0x2ab)](_0x1b11a8,{'val':![],'ack':!![]});if(this[_0x51e9a4(0x2f3)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x1b11a8[_0x51e9a4(0x2ba)](_0x51e9a4(0x274))&&_0x56fe2a[_0x51e9a4(0x272)]){this[_0x51e9a4(0x2ab)](_0x1b11a8,{'val':![],'ack':!![]}),aiAgent['sendMorningBriefing'](this);return;}if(_0x1b11a8[_0x51e9a4(0x2ba)](_0x51e9a4(0x302))&&_0x56fe2a[_0x51e9a4(0x272)]){this[_0x51e9a4(0x2ab)](_0x1b11a8,{'val':![],'ack':!![]}),aiAgent[_0x51e9a4(0x2c4)](this);return;}if(_0x1b11a8[_0x51e9a4(0x2ba)](_0x51e9a4(0x2aa))&&_0x56fe2a['val']){this[_0x51e9a4(0x2ab)](_0x1b11a8,{'val':![],'ack':!![]});if(this[_0x51e9a4(0x2f3)])try{const _0x12da5f=await this['getStateAsync'](_0x51e9a4(0x1f7));if(_0x12da5f&&_0x12da5f[_0x51e9a4(0x272)]){const _0x5663e6=JSON[_0x51e9a4(0x320)](_0x12da5f['val']);this[_0x51e9a4(0x233)](_0x51e9a4(0x1f4),{'val':_0x51e9a4(0x23e),'ack':!![]}),pythonBridge[_0x51e9a4(0x2a6)](this,_0x51e9a4(0x206),{'sequences':_0x5663e6});}}catch(_0x201f0){}return;}if(_0x1b11a8[_0x51e9a4(0x2ba)](_0x51e9a4(0x2d9))&&_0x56fe2a['val']){this[_0x51e9a4(0x2ab)](_0x1b11a8,{'val':![],'ack':!![]});try{aiAgent[_0x51e9a4(0x24c)](this,'NIGHT'),setTimeout(()=>aiAgent[_0x51e9a4(0x24c)](this,_0x51e9a4(0x261)),0x2ee0);if(this[_0x51e9a4(0x2f3)]){this[_0x51e9a4(0x2ff)]();const _0x41a21c=await this[_0x51e9a4(0x309)]('LTM.dailyDigests');if(_0x41a21c&&_0x41a21c[_0x51e9a4(0x272)])pythonBridge[_0x51e9a4(0x2a6)](this,_0x51e9a4(0x359),{'digests':JSON[_0x51e9a4(0x320)](_0x41a21c['val'])});}}catch(_0x42c858){this[_0x51e9a4(0x34b)][_0x51e9a4(0x28c)](_0x51e9a4(0x32d)+_0x42c858[_0x51e9a4(0x2e7)]);}return;}if(_0x1b11a8[_0x51e9a4(0x2ba)]('analysis.training.triggerEnergy')&&_0x56fe2a[_0x51e9a4(0x272)]){this['setState'](_0x1b11a8,{'val':![],'ack':!![]}),await this[_0x51e9a4(0x30a)]();return;}if(_0x1b11a8[_0x51e9a4(0x2ba)](_0x51e9a4(0x324))&&_0x56fe2a[_0x51e9a4(0x272)]){this['setState'](_0x1b11a8,{'val':![],'ack':!![]});if(this[_0x51e9a4(0x2f3)])try{const _0x32be95=await this[_0x51e9a4(0x309)](_0x51e9a4(0x299));if(_0x32be95&&_0x32be95['val']){const _0x2bc79d={};if(this[_0x51e9a4(0x28b)]['devices'])this[_0x51e9a4(0x28b)][_0x51e9a4(0x22d)][_0x51e9a4(0x31d)](_0x2924c0=>{const _0x14b68d=_0x51e9a4;if(_0x2924c0['id']&&_0x2924c0['type'])_0x2bc79d[_0x2924c0['id']]=_0x2924c0[_0x14b68d(0x2f9)];});pythonBridge[_0x51e9a4(0x2a6)](this,_0x51e9a4(0x275),{'events':JSON[_0x51e9a4(0x320)](_0x32be95[_0x51e9a4(0x272)]),'deviceMap':_0x2bc79d});}}catch(_0x34b78d){}return;}if(_0x1b11a8['includes']('analysis.training.triggerTopology')&&_0x56fe2a[_0x51e9a4(0x272)]){this[_0x51e9a4(0x2ab)](_0x1b11a8,{'val':![],'ack':!![]}),topology['updateTopology'](this);if(this[_0x51e9a4(0x2f3)])try{const _0x1b09b5=await this[_0x51e9a4(0x309)](_0x51e9a4(0x1f7));if(_0x1b09b5&&_0x1b09b5['val'])pythonBridge[_0x51e9a4(0x2a6)](this,_0x51e9a4(0x2fb),{'sequences':JSON['parse'](_0x1b09b5[_0x51e9a4(0x272)])});}catch(_0x2e3de0){}return;}}const _0x5bd53b=(this[_0x51e9a4(0x28b)][_0x51e9a4(0x22d)]||[])[_0x51e9a4(0x255)](_0x563593=>_0x563593['id']===_0x1b11a8);if(_0x5bd53b){const _0x3b1147=await recorder['processSensorEvent'](this,_0x1b11a8,_0x56fe2a,_0x5bd53b);_0x3b1147&&this['setState']('analysis.visualization.pulse',{'val':Date['now'](),'ack':!![]});_0x3b1147&&_0x3b1147[_0x51e9a4(0x2f9)]==='motion'&&_0x3b1147[_0x51e9a4(0x1fa)]&&this['isProVersion']&&deadMan[_0x51e9a4(0x343)](this,_0x3b1147[_0x51e9a4(0x1fa)]);_0x56fe2a['val']&&(_0x56fe2a[_0x51e9a4(0x272)]===!![]||_0x56fe2a[_0x51e9a4(0x272)]===0x1||String(_0x56fe2a[_0x51e9a4(0x272)])[_0x51e9a4(0x301)]()===_0x51e9a4(0x2e4))&&(_0x5bd53b['type']&&(_0x5bd53b[_0x51e9a4(0x2f9)][_0x51e9a4(0x2ba)](_0x51e9a4(0x203))||_0x5bd53b[_0x51e9a4(0x2f9)][_0x51e9a4(0x2ba)]('door'))&&this[_0x51e9a4(0x2ad)](_0x5bd53b));if(_0x5bd53b['type']===_0x51e9a4(0x2d0)||_0x5bd53b['type']===_0x51e9a4(0x29a)){if(this[_0x51e9a4(0x2b1)]['energy'])automation['cleanupGhostInterventions'](this);}}}async['protectAiMemory'](_0x15a624){const _0x48cc4b=a0_0x58f094;if(!this[_0x48cc4b(0x21e)]||Date[_0x48cc4b(0x26a)]()-this['bootTime']>0x493e0)return;try{const _0x340941=JSON[_0x48cc4b(0x320)](_0x15a624),_0x4810e6=this['memoryCache'][_0x48cc4b(0x300)];let _0x55e970=![];for(const _0x5c9a1d in _0x4810e6){if(_0x4810e6[_0x5c9a1d][_0x48cc4b(0x2ba)]('AI')&&_0x340941[_0x5c9a1d]&&!_0x340941[_0x5c9a1d][_0x48cc4b(0x2ba)]('AI')){_0x55e970=!![];break;}}_0x55e970&&(await this['setStateAsync'](_0x48cc4b(0x25a),{'val':JSON['stringify'](this[_0x48cc4b(0x21e)][_0x48cc4b(0x229)]),'ack':!![]}),await this['setStateAsync'](_0x48cc4b(0x2cf),{'val':JSON[_0x48cc4b(0x2e9)](this[_0x48cc4b(0x21e)][_0x48cc4b(0x300)]),'ack':!![]}));}catch(_0xac70f2){}}async[a0_0x58f094(0x34d)](){const _0x442fab=a0_0x58f094;try{const _0x3aa62a=await this[_0x442fab(0x309)](setup[_0x442fab(0x350)]);if(_0x3aa62a&&_0x3aa62a[_0x442fab(0x272)])this[_0x442fab(0x2d6)]=_0x3aa62a[_0x442fab(0x272)];}catch(_0x4664a2){this[_0x442fab(0x2d6)]=setup['SYSTEM_MODES'][_0x442fab(0x2a4)];}}async[a0_0x58f094(0x346)](){const _0x53b5ec=a0_0x58f094,_0x48a11d=this[_0x53b5ec(0x28b)][_0x53b5ec(0x244)]||[];if(_0x48a11d[_0x53b5ec(0x29b)]===0x0)return![];const _0x3ee526=[],_0x169cab=Date['now'](),_0x25ae0c=0x5*0x3c*0x3e8;for(const _0x53391b of _0x48a11d){try{let _0x517f4c=![];try{const _0x1973f4=await this[_0x53b5ec(0x2fc)](_0x53391b+_0x53b5ec(0x30e));if(_0x1973f4&&_0x1973f4[_0x53b5ec(0x272)]===!![])_0x517f4c=!![];}catch(_0x20a280){}if(!_0x517f4c)try{const _0x506ec1=await this[_0x53b5ec(0x2fc)](_0x53391b+_0x53b5ec(0x304));if(_0x506ec1&&_0x506ec1['ts']){const _0x1f6a31=_0x169cab-_0x506ec1['ts'];if(_0x1f6a31<_0x25ae0c)_0x517f4c=!![];}}catch(_0x25faa9){}if(!_0x517f4c)try{const _0x152b7a=await this[_0x53b5ec(0x2fc)](_0x53391b+'.uptime');if(_0x152b7a&&typeof _0x152b7a[_0x53b5ec(0x272)]===_0x53b5ec(0x310)&&_0x152b7a['val']>0x0)_0x517f4c=!![];}catch(_0x5d71c1){}if(!_0x517f4c)try{const _0xb7edf=await this[_0x53b5ec(0x2fc)](_0x53391b);if(_0xb7edf){const _0x4c769e=_0x169cab-(_0xb7edf['ts']||0x0);_0x4c769e<_0x25ae0c&&(_0xb7edf[_0x53b5ec(0x272)]===!![]||_0xb7edf[_0x53b5ec(0x272)]==='online'||_0xb7edf[_0x53b5ec(0x272)]===0x1)&&(_0x517f4c=!![]);}}catch(_0x1bcc0f){}if(_0x517f4c){const _0x4c3e21=_0x53391b[_0x53b5ec(0x2bc)]('.'),_0x1525b6=_0x4c3e21[_0x4c3e21[_0x53b5ec(0x29b)]-0x1]||_0x53391b;_0x3ee526['push'](_0x1525b6);}}catch(_0x2cf68b){this[_0x53b5ec(0x34b)][_0x53b5ec(0x28c)]('checkWifiPresence:\x20Error\x20checking\x20'+_0x53391b+':\x20'+_0x2cf68b['message']);}}const _0x5665ee=_0x3ee526[_0x53b5ec(0x29b)]>0x0?_0x3ee526['join'](',\x20'):_0x53b5ec(0x27e);return await this[_0x53b5ec(0x233)]('system.presenceWho',{'val':_0x5665ee,'ack':!![]}),_0x3ee526[_0x53b5ec(0x29b)]>0x0;}async[a0_0x58f094(0x242)](){const _0x56be37=a0_0x58f094;await aiAgent[_0x56be37(0x303)](this);this[_0x56be37(0x2b1)][_0x56be37(0x226)]&&(this['updateHealthVector'](),this[_0x56be37(0x20d)]());if(this[_0x56be37(0x2b1)][_0x56be37(0x249)])this['triggerEnergyPrediction']();}async[a0_0x58f094(0x21f)](){const _0x19f3be=a0_0x58f094,_0xb119d3=[_0x19f3be(0x23d),'accuweather.0','daswetter.0'],_0x16f312=[_0x19f3be(0x34f),_0x19f3be(0x307),_0x19f3be(0x200)];for(const _0x66c261 of _0xb119d3){for(const _0x31c97a of _0x16f312){try{const _0x22447d=_0x66c261+'.'+_0x31c97a,_0x383378=await this['getForeignStateAsync'](_0x22447d);if(_0x383378&&_0x383378[_0x19f3be(0x272)]){const _0x5859d9=String(_0x383378[_0x19f3be(0x272)])['toLowerCase']();if(_0x5859d9[_0x19f3be(0x2ba)](_0x19f3be(0x250))||_0x5859d9[_0x19f3be(0x2ba)](_0x19f3be(0x31c))||_0x5859d9[_0x19f3be(0x2ba)]('klar')||_0x5859d9[_0x19f3be(0x2ba)](_0x19f3be(0x20e))||_0x5859d9[_0x19f3be(0x2ba)](_0x19f3be(0x254)))return this[_0x19f3be(0x34b)][_0x19f3be(0x21a)](_0x19f3be(0x338)+_0x22447d),!![];}}catch(_0x350b3f){}}}return![];}[a0_0x58f094(0x20d)](){const _0x13fc2d=a0_0x58f094;if(!this[_0x13fc2d(0x2f3)])return;try{this[_0x13fc2d(0x309)]('LTM.trainingData.sequences',(_0x2c42ff,_0x52d919)=>{const _0x3d3f39=_0x13fc2d;if(_0x2c42ff||!_0x52d919||!_0x52d919[_0x3d3f39(0x272)])return;try{const _0x16feda=JSON[_0x3d3f39(0x320)](_0x52d919[_0x3d3f39(0x272)]);if(!_0x16feda||_0x16feda[_0x3d3f39(0x29b)]===0x0)return;pythonBridge[_0x3d3f39(0x2a6)](this,_0x3d3f39(0x2ac),{'sequences':_0x16feda}),this['log']['debug'](_0x3d3f39(0x30d)+_0x16feda[_0x3d3f39(0x29b)]+_0x3d3f39(0x318));}catch(_0x17a3f8){this[_0x3d3f39(0x34b)]['warn'](_0x3d3f39(0x292)+_0x17a3f8[_0x3d3f39(0x2e7)]);}});}catch(_0x53c539){this[_0x13fc2d(0x34b)][_0x13fc2d(0x28c)](_0x13fc2d(0x2c2)+_0x53c539[_0x13fc2d(0x2e7)]);}}async[a0_0x58f094(0x30a)](){const _0x5c3fe7=a0_0x58f094;if(!this[_0x5c3fe7(0x2f3)]||!this[_0x5c3fe7(0x2b1)][_0x5c3fe7(0x249)])return;try{const _0x39dd1b={},_0x505278={},_0x4ab1b9=this[_0x5c3fe7(0x28b)][_0x5c3fe7(0x22d)]||[];for(const _0x31af51 of _0x4ab1b9){if((_0x31af51[_0x5c3fe7(0x2f9)]===_0x5c3fe7(0x2d0)||_0x31af51['type']===_0x5c3fe7(0x29a))&&_0x31af51[_0x5c3fe7(0x1fa)])try{const _0x390ed1=await this[_0x5c3fe7(0x2fc)](_0x31af51['id']);_0x390ed1&&typeof _0x390ed1[_0x5c3fe7(0x272)]===_0x5c3fe7(0x310)&&(_0x39dd1b[_0x31af51[_0x5c3fe7(0x1fa)]]=_0x390ed1[_0x5c3fe7(0x272)],_0x505278[_0x31af51[_0x5c3fe7(0x1fa)]]=_0x31af51['isSolar']||![]);}catch(_0x3d4a3c){}}let _0x5f427e=0xa;if(this[_0x5c3fe7(0x28b)][_0x5c3fe7(0x21c)])try{const _0x20d467=await this[_0x5c3fe7(0x2fc)](this[_0x5c3fe7(0x28b)]['weatherTempId']);if(_0x20d467&&typeof _0x20d467[_0x5c3fe7(0x272)]===_0x5c3fe7(0x310))_0x5f427e=_0x20d467[_0x5c3fe7(0x272)];}catch(_0x53a052){}const _0x4bb75d=await this['checkSolarCondition']();let _0x54dabd={};try{const _0x194d94=await this[_0x5c3fe7(0x309)]('analysis.energy.warmupTargets');if(_0x194d94&&_0x194d94[_0x5c3fe7(0x272)])_0x54dabd=JSON[_0x5c3fe7(0x320)](_0x194d94['val']);}catch(_0x30d866){}pythonBridge[_0x5c3fe7(0x2a6)](this,'PREDICT_ENERGY',{'current_temps':_0x39dd1b,'t_out':_0x5f427e,'is_sunny':_0x4bb75d,'solar_flags':_0x505278,'warmup_targets':_0x54dabd}),this[_0x5c3fe7(0x34b)][_0x5c3fe7(0x331)](_0x5c3fe7(0x298)+Object[_0x5c3fe7(0x1fc)](_0x39dd1b)['length']+_0x5c3fe7(0x26c));}catch(_0x19ad86){this[_0x5c3fe7(0x34b)][_0x5c3fe7(0x28c)]('triggerEnergyPrediction\x20Error:\x20'+_0x19ad86['message']);}}[a0_0x58f094(0x22e)](){const _0x49484a=a0_0x58f094;if(!this['rawEventLog']||this[_0x49484a(0x34c)][_0x49484a(0x29b)]===0x0)return;const _0x4fd358=new Array(0x30)[_0x49484a(0x27d)](0x0),_0x4e23bf=Array[_0x49484a(0x2e3)]({'length':0x30},()=>[]),_0x173287=new Date()[_0x49484a(0x344)](0x0,0x0,0x0,0x0);this[_0x49484a(0x34c)][_0x49484a(0x31d)](_0x32989f=>{const _0x2aa1a0=_0x49484a,_0x2bdf22=new Date(_0x32989f[_0x2aa1a0(0x260)]);if(_0x2bdf22[_0x2aa1a0(0x2d7)]()>=_0x173287){const _0x2f1178=_0x2bdf22['getHours'](),_0x15574f=_0x2bdf22[_0x2aa1a0(0x33a)](),_0x44b3d3=_0x2f1178*0x2+Math[_0x2aa1a0(0x2af)](_0x15574f/0x1e);_0x44b3d3>=0x0&&_0x44b3d3<0x30&&(_0x4fd358[_0x44b3d3]++,_0x4e23bf[_0x44b3d3]['push']({'time':_0x2bdf22['toLocaleTimeString'](_0x2aa1a0(0x2bb),{'hour':_0x2aa1a0(0x247),'minute':_0x2aa1a0(0x247)}),'location':_0x32989f['location']||_0x2aa1a0(0x328),'type':_0x32989f[_0x2aa1a0(0x2f9)]||_0x2aa1a0(0x1ed)}));}}),this['setStateAsync'](_0x49484a(0x31f),{'val':JSON[_0x49484a(0x2e9)](_0x4fd358),'ack':!![]}),this['setStateAsync']('analysis.health.todayRoomDetails',{'val':JSON[_0x49484a(0x2e9)](_0x4e23bf),'ack':!![]});}async[a0_0x58f094(0x24f)](_0x3afe8e){const _0x135aaf=a0_0x58f094;if(!this[_0x135aaf(0x28b)]['infrasoundEnabled']||typeof _0x3afe8e!==_0x135aaf(0x310))return;const _0x5b8fc4=this[_0x135aaf(0x28b)][_0x135aaf(0x231)]||0.04;this[_0x135aaf(0x2ca)]['push']({'timestamp':Date[_0x135aaf(0x26a)](),'value':_0x3afe8e}),this[_0x135aaf(0x2ca)]['length']>0x64&&this[_0x135aaf(0x2ca)][_0x135aaf(0x29e)](),_0x3afe8e>_0x5b8fc4&&!this[_0x135aaf(0x24b)]&&(this[_0x135aaf(0x24b)]=!![],this[_0x135aaf(0x34b)][_0x135aaf(0x28c)](_0x135aaf(0x354)+_0x3afe8e[_0x135aaf(0x2c6)](0x4)+_0x135aaf(0x27c)+_0x5b8fc4+_0x135aaf(0x264)),await this[_0x135aaf(0x201)](_0x3afe8e,'threshold_exceeded'),setTimeout(()=>{this['infrasoundLocked']=![];},0x5*0x3c*0x3e8));}async[a0_0x58f094(0x201)](_0x1e973a,_0x33be5c){const _0x9ebf43=a0_0x58f094;if(!this[_0x9ebf43(0x22b)]){const _0xc857=this[_0x9ebf43(0x2cd)]['slice'](0x0,0xa),_0x29ff86=_0xc857[_0x9ebf43(0x2c0)](_0x3558b3=>new Date(_0x3558b3[_0x9ebf43(0x260)])[_0x9ebf43(0x2eb)](_0x9ebf43(0x2bb))+_0x9ebf43(0x2d8)+(_0x3558b3[_0x9ebf43(0x1fa)]||_0x9ebf43(0x23f))+':\x20'+_0x3558b3[_0x9ebf43(0x2ce)])[_0x9ebf43(0x2d1)]('\x0a');this['log'][_0x9ebf43(0x28c)](_0x9ebf43(0x327)+_0x1e973a[_0x9ebf43(0x2c6)](0x4)+_0x9ebf43(0x342)+_0x29ff86);if(this['config'][_0x9ebf43(0x269)])try{const _0x54a89e=await this[_0x9ebf43(0x2fc)](this['config'][_0x9ebf43(0x269)]);_0x54a89e&&_0x54a89e[_0x9ebf43(0x272)]===!![]&&(await this[_0x9ebf43(0x233)]('analysis.safety.infrasoundAlert',{'val':JSON[_0x9ebf43(0x2e9)]({'timestamp':Date['now'](),'pressure':_0x1e973a['toFixed'](0x4),'eventType':_0x33be5c,'recentEvents':_0xc857[_0x9ebf43(0x288)](0x0,0x3)}),'ack':!![]}),this['log']['error'](_0x9ebf43(0x26b)));}catch(_0x2c037d){}}else this[_0x9ebf43(0x34b)]['debug'](_0x9ebf43(0x259)+_0x1e973a[_0x9ebf43(0x2c6)](0x4)+_0x9ebf43(0x287));}async[a0_0x58f094(0x2ad)](_0x49b396){const _0x2d6dec=a0_0x58f094;if(!_0x49b396||!_0x49b396[_0x2d6dec(0x1fa)])return;try{const _0x435d12=(this['config'][_0x2d6dec(0x22d)]||[])[_0x2d6dec(0x279)](_0xafb80e=>_0xafb80e[_0x2d6dec(0x1fa)]===_0x49b396[_0x2d6dec(0x1fa)]&&(_0xafb80e[_0x2d6dec(0x2f9)]===_0x2d6dec(0x2d0)||_0xafb80e[_0x2d6dec(0x2f9)]==='thermostat'));if(_0x435d12['length']===0x0)return;const _0x3bfd46=await this['getForeignStateAsync'](_0x435d12[0x0]['id']);if(!_0x3bfd46||typeof _0x3bfd46['val']!=='number')return;const _0x45e0b4=_0x3bfd46[_0x2d6dec(0x272)];let _0x252da3=null;if(this[_0x2d6dec(0x28b)]['weatherTempId']){const _0x3e3976=await this[_0x2d6dec(0x2fc)](this[_0x2d6dec(0x28b)][_0x2d6dec(0x21c)]);_0x3e3976&&typeof _0x3e3976[_0x2d6dec(0x272)]===_0x2d6dec(0x310)&&(_0x252da3=_0x3e3976[_0x2d6dec(0x272)]);}if(_0x252da3!==null){const _0x329f9c=Math[_0x2d6dec(0x215)](_0x45e0b4-_0x252da3);_0x329f9c>0x3&&(this[_0x2d6dec(0x34b)]['debug'](_0x2d6dec(0x27f)+_0x49b396['location']+':\x20Temp-Differenz\x20'+_0x329f9c[_0x2d6dec(0x2c6)](0x1)+_0x2d6dec(0x2f7)+_0x45e0b4+_0x2d6dec(0x30f)+_0x252da3+_0x2d6dec(0x329)),await this[_0x2d6dec(0x233)](_0x2d6dec(0x1f2),{'val':JSON[_0x2d6dec(0x2e9)]({'room':_0x49b396[_0x2d6dec(0x1fa)],'timestamp':Date[_0x2d6dec(0x26a)](),'tempDiff':_0x329f9c['toFixed'](0x1),'recommendation':_0x329f9c>0x5?'Gute\x20L√ºftungsm√∂glichkeit!':_0x2d6dec(0x28d)}),'ack':!![]}));}}catch(_0x5284f1){this[_0x2d6dec(0x34b)]['warn'](_0x2d6dec(0x1ff)+_0x5284f1[_0x2d6dec(0x2e7)]);}}async[a0_0x58f094(0x2c3)](_0x6bc812){const _0x4528d8=a0_0x58f094;if(!_0x6bc812||typeof _0x6bc812!==_0x4528d8(0x1f8))return;const _0x462939={'timestamp':_0x6bc812[_0x4528d8(0x260)]||Date[_0x4528d8(0x26a)](),'id':_0x6bc812['id']||Date[_0x4528d8(0x26a)]()[_0x4528d8(0x290)](),'name':_0x6bc812[_0x4528d8(0x2ce)]||_0x4528d8(0x349),'type':_0x6bc812['type']||'custom','location':_0x6bc812['location']||_0x4528d8(0x23f),'value':_0x6bc812[_0x4528d8(0x221)]||null};this[_0x4528d8(0x2cd)][_0x4528d8(0x276)](_0x462939);if(this[_0x4528d8(0x2cd)][_0x4528d8(0x29b)]>0x1388)this[_0x4528d8(0x2cd)][_0x4528d8(0x2c7)]();await this['setStateAsync'](_0x4528d8(0x22a),{'val':JSON[_0x4528d8(0x2e9)](this['eventHistory']),'ack':!![]}),this[_0x4528d8(0x34b)][_0x4528d8(0x21a)](_0x4528d8(0x2f5)+_0x462939['name']+'\x20('+_0x462939['location']+')');}['sendNotification'](_0x2e159e){}}if(require[a0_0x58f094(0x319)]!==module)module[a0_0x58f094(0x252)]=_0x79ee32=>new CogniLiving(_0x79ee32);else new CogniLiving();