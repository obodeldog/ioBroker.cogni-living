const a0_0x1f7418=a0_0x77f8;(function(_0x2228b0,_0x3b1d8d){const _0x10bde4=a0_0x77f8,_0x2b9c1f=_0x2228b0();while(!![]){try{const _0x57c4c7=parseInt(_0x10bde4(0x2e3))/0x1*(-parseInt(_0x10bde4(0x25a))/0x2)+-parseInt(_0x10bde4(0x296))/0x3*(parseInt(_0x10bde4(0x298))/0x4)+-parseInt(_0x10bde4(0x2d6))/0x5*(parseInt(_0x10bde4(0x1cd))/0x6)+-parseInt(_0x10bde4(0x2d9))/0x7*(-parseInt(_0x10bde4(0x236))/0x8)+-parseInt(_0x10bde4(0x1c1))/0x9+-parseInt(_0x10bde4(0x27f))/0xa*(parseInt(_0x10bde4(0x1ae))/0xb)+parseInt(_0x10bde4(0x2dc))/0xc;if(_0x57c4c7===_0x3b1d8d)break;else _0x2b9c1f['push'](_0x2b9c1f['shift']());}catch(_0x38b675){_0x2b9c1f['push'](_0x2b9c1f['shift']());}}}(a0_0x433e,0xab4c5));function a0_0x77f8(_0x2c672f,_0x50f4a7){const _0x6f1a2c=a0_0x433e();return a0_0x77f8=function(_0x4ba325,_0x416e6a){_0x4ba325=_0x4ba325-0x1ad;let _0x433ece=_0x6f1a2c[_0x4ba325];return _0x433ece;},a0_0x77f8(_0x2c672f,_0x50f4a7);}const a0_0x416e6a=(function(){let _0x297c7d=!![];return function(_0x3b7bfc,_0x23aebe){const _0x2ea83a=_0x297c7d?function(){const _0x1e0e5b=a0_0x77f8;if(_0x23aebe){const _0x57550b=_0x23aebe[_0x1e0e5b(0x207)](_0x3b7bfc,arguments);return _0x23aebe=null,_0x57550b;}}:function(){};return _0x297c7d=![],_0x2ea83a;};}()),a0_0x4ba325=a0_0x416e6a(this,function(){const _0x2c3432=a0_0x77f8;return a0_0x4ba325[_0x2c3432(0x259)]()[_0x2c3432(0x267)](_0x2c3432(0x1df))[_0x2c3432(0x259)]()[_0x2c3432(0x27d)](a0_0x4ba325)[_0x2c3432(0x267)](_0x2c3432(0x1df));});a0_0x4ba325();function a0_0x433e(){const _0x4939c0=['analysis.activity.roomStats','saveDailyHistory','includes','apiKey',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','search','send','window','startSystem','haustÃ¼r','config','initZombies','analysis.automation.patternDetected','SET_LEARNING_MODE','string','analysis.prediction.trackerTopRoom','triggerEnergyPrediction','analysis.health.todayVector','value','times','getObjectViewAsync','scanForDevices','genAI','security','some','existsSync','infrasoundEnabled','constructor','cogni-living','10jfOnXn','setObjectNotExistsAsync','initSystemConfig','terrasse','thermostat','communicate.request','createDailyDigest','rows','runGeminiAnalysis','namespace','max','common','subscribeStates','subscribeForeignStates','enum.functions.*','setPresence','checkLicense','modules','date','initHistory','analysis.trigger','system.presenceWho','analysis.health.todayRoomDetails','3lHcFPl','getHistoryData','1001036hDlQlV','geminiApiKey','inactivityThresholdHours','checkCalendarTriggers','âœ…\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','checkThermostats','runPythonHealthCheck','number','analysis.activity.roomHistory','âš \x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','error','stringify','analysis.automation.targetValue','system.adapter.ical.','./lib/topology','analysis.health.activityTrend','exports','isGracePeriodActive','location','system','LTM.trainingData.sequences','analysisTimer','General\x20Activity\x20Trend','systemConfig','driftAnalysisTimer','party','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','replayTodayEvents','scanDevices','Warte\x20auf\x20Analyse...','ðŸ’¾\x20Saving\x20Daily\x20History\x20for\x20','node-schedule','\x20Tage)','healthTrendInterval','system.adapter.ical.é¦™','setStateAsync','Keine\x20Daten','onStateChange','onUnload','Room\x20Dwell\x20Time\x20Stats','CALCULATE_HEALTH_TREND','briefingJob','./lib/scheduler','protectAiMemory','appendToLog','log','updateTopology','bootTime','.system.mode','NORMAL','pulse','energy','.data.table','subscribeForeignStatesAsync','TRAIN_HEALTH','analysis.training.triggerHealth','TRAIN_COMFORT','history','Init...','SYSTEM_MODES','type','LTM.dailyDigests','4045DhGaAJ','activeModules','./lib/installer','56WXIqHI','guest','getAbsoluteDefaultDataDir','26233284QNAJfV','checkWifiPresence','testContext','analysisHistory','.json','triggerBriefing','getOverviewData','44858pwQKYm','sendMorningBriefing','toLowerCase','6929263rJUvQh','integrateRoomTime','object','History\x20Save\x20Error:\x20','analysis.security.lastScore','getMinutes','.venv','processSensorEvent','analysis.energy.warmupSources','./lib/setup','Sec-Training\x20started...','enum','LTM.rawEventLog','fill','ack','Gemini\x20Init\x20Error:\x20','{\x22history\x22:{}}','length','add','82359xpKQKq','memoryCache','version','SYSTEM_DP_MODE','toISOString','python','motion','val','analysis.training.triggerSecurity','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','licenseKey','Live\x20Event\x20Pulse','1662EBkxlD','outdoorSensorId','analysis.health.geminiDay','infrasoundLocked','join','âœ…\x20History\x20saved:\x20','eventHistory','find','abortExitTimer','then','getGenerativeModel','devices','initSchedules','state','path','automation.triggerAction','\x20events\x20from\x20standard\x20storage.','VACATION','(((.+)+)+)+$','moduleEnergy','Room\x20History\x20(24h\x20Buckets)','./lib/ai_agent','minDaysForBaseline','geminiModel','getDate','analyzeWindowOpening','onMessage','Daily\x20Activity\x20Vector\x20(48x30min)','[Integrator]\x20Error:\x20','modeResetJob','response','split','bin','forEach','json','setState','values','replace','endsWith','presenceDevices','getStateAsync','isPresent','ðŸ“¦\x20Restored\x20','moduleComfort','./lib/automation','generateHealthReport','info','parse','checkSolarCondition','instance','setHours','@google/generative-ai','telegram','application/json','moduleSecurity','historyJob','moduleHealth','now','apply','Warm-Up\x20Time','mkdirSync','message','@iobroker/adapter-core','substring','analysis.training.triggerEnergy','isProVersion','warn','Guest\x20Mode','\x20Kalender-Adapter\x20gefunden.','reduce','timestamp','dependencyInstallInProgress','TRAIN_ENERGY','calendarName',',\x20Temp:\x20','filter','manual','trackerHeartbeat','analysis.visualization.pulse','NIGHT','analysis.health.geminiNight','isArray','./lib/scanner','handleInfrasound','dailyDigests','sendNotification','ltmJob','runAutopilot','pop','sources','analysis.prediction.trackerConfidence','testApiKey','all','Adapter','main','isSolar','enum.rooms.*','lastAlertState','./lib/recorder','utf8','push','cleanupGhostInterventions','triggerGaitAnalysis','getForeignStateAsync','toLocaleDateString','570984uOGvQH','getForeignObjectsAsync','callback','infrasoundSensorId','No\x20data','loadSystemMode','rawEventLog','readFileSync','open','updateHealthVector','TRAIN_TOPOLOGY','sensorLastValues','unload','Scan\x20Error:\x20','Kein\x20API\x20Key\x20Ã¼bergeben.','command','min','bind','temperature','triggerInfrasoundCorrelation','analysis.energy.warmupTimes','Unknown','scanThermostats','Gemini\x20Report\x20Day','text','from','59\x2023\x20*\x20*\x20*','debug','...','getHours','name','stopService','sendTo','Aktiv\x20(','cancel','toString','42jovufT','Gemini\x20Report\x20Night','currentSystemMode','lastTrackerEventTime','./lib/dead_man','roomIntegratorTimer','LTM.triggerDailyDigest','health'];a0_0x433e=function(){return _0x4939c0;};return a0_0x433e();}'use strict';const utils=require(a0_0x1f7418(0x20b)),{GoogleGenerativeAI}=require(a0_0x1f7418(0x200)),path=require(a0_0x1f7418(0x1db)),fs=require('fs'),installer=require(a0_0x1f7418(0x2d8)),scanner=require(a0_0x1f7418(0x21f)),schedulers=require(a0_0x1f7418(0x2c2)),topology=require(a0_0x1f7418(0x2a6)),setup=require(a0_0x1f7418(0x1b7)),recorder=require(a0_0x1f7418(0x22f)),pythonBridge=require('./lib/python_bridge'),aiAgent=require(a0_0x1f7418(0x1e2)),deadMan=require(a0_0x1f7418(0x25e)),automation=require(a0_0x1f7418(0x1f9)),GEMINI_MODEL='models/gemini-flash-latest';class CogniLiving extends utils[a0_0x1f7418(0x22a)]{constructor(_0x19a514){const _0x395bed=a0_0x1f7418;super({..._0x19a514,'name':_0x395bed(0x27e)}),this[_0x395bed(0x1d3)]=[],this[_0x395bed(0x2df)]=[],this[_0x395bed(0x23c)]=[],this[_0x395bed(0x221)]=[],this['sensorLastValues']={},this[_0x395bed(0x2af)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x395bed(0x1f6)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x395bed(0x2a9)]=![],this[_0x395bed(0x278)]=null,this[_0x395bed(0x1e4)]=null,this['currentSystemMode']=setup['SYSTEM_MODES'][_0x395bed(0x2c9)],this[_0x395bed(0x20e)]=![],this[_0x395bed(0x22e)]=![],this[_0x395bed(0x2ad)]=null,this[_0x395bed(0x223)]=null,this[_0x395bed(0x1ea)]=null,this[_0x395bed(0x2b0)]=null,this[_0x395bed(0x2c1)]=null,this['historyJob']=null,this[_0x395bed(0x21a)]=null,this['healthTrendInterval']=null,this[_0x395bed(0x25f)]=null,this['dependencyInstallInProgress']=![],this[_0x395bed(0x25d)]=Date[_0x395bed(0x206)](),this[_0x395bed(0x1c2)]=null,this[_0x395bed(0x2c7)]=Date[_0x395bed(0x206)](),this[_0x395bed(0x1d0)]=![],this['pressureBuffer']=[],this[_0x395bed(0x2d7)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on']('ready',this['onReady'][_0x395bed(0x247)](this)),this['on']('stateChange',this[_0x395bed(0x2bd)][_0x395bed(0x247)](this)),this['on'](_0x395bed(0x242),this[_0x395bed(0x2be)][_0x395bed(0x247)](this)),this['on'](_0x395bed(0x20a),this['onMessage'][_0x395bed(0x247)](this));}async['onReady'](){const _0x3f02db=a0_0x1f7418;this[_0x3f02db(0x2c5)][_0x3f02db(0x1fb)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x3f02db(0x1c3)]+_0x3f02db(0x266));if(this[_0x3f02db(0x26c)][_0x3f02db(0x205)]!==undefined)this[_0x3f02db(0x2d7)][_0x3f02db(0x261)]=this[_0x3f02db(0x26c)][_0x3f02db(0x205)];if(this[_0x3f02db(0x26c)][_0x3f02db(0x203)]!==undefined)this[_0x3f02db(0x2d7)][_0x3f02db(0x279)]=this['config'][_0x3f02db(0x203)];if(this['config'][_0x3f02db(0x1e0)]!==undefined)this[_0x3f02db(0x2d7)][_0x3f02db(0x2cb)]=this[_0x3f02db(0x26c)][_0x3f02db(0x1e0)];if(this[_0x3f02db(0x26c)]['moduleComfort']!==undefined)this[_0x3f02db(0x2d7)]['comfort']=this[_0x3f02db(0x26c)][_0x3f02db(0x1f8)];if(this['config'][_0x3f02db(0x290)])this[_0x3f02db(0x2d7)]={...this[_0x3f02db(0x2d7)],...this[_0x3f02db(0x26c)][_0x3f02db(0x290)]};this[_0x3f02db(0x26a)]();}async[a0_0x1f7418(0x26a)](){const _0x5794f9=a0_0x1f7418;await setup[_0x5794f9(0x26d)](this);try{this['isProVersion']=await setup[_0x5794f9(0x28f)](this[_0x5794f9(0x26c)][_0x5794f9(0x1cb)]);}catch(_0x5f35d8){}if(!this[_0x5794f9(0x26c)]['inactivityThresholdHours']||this[_0x5794f9(0x26c)]['inactivityThresholdHours']<0.1)this[_0x5794f9(0x26c)][_0x5794f9(0x29a)]=0xc;await setup[_0x5794f9(0x292)](this),await setup[_0x5794f9(0x281)](this);try{const _0x1ee35d=await this[_0x5794f9(0x1f5)]('analysis.energy.warmupTimes'),_0x2b51df=await this['getStateAsync'](_0x5794f9(0x1b6));_0x1ee35d&&_0x1ee35d[_0x5794f9(0x1c8)]&&_0x2b51df&&_0x2b51df[_0x5794f9(0x1c8)]&&(Date['now']()-_0x1ee35d['ts']<0x4*0xe10*0x3e8&&(this[_0x5794f9(0x1c2)]={'times':JSON[_0x5794f9(0x1fc)](_0x1ee35d['val']),'sources':JSON['parse'](_0x2b51df['val'])}));}catch(_0x11d3ed){}if(this['config'][_0x5794f9(0x299)])try{this['genAI']=new GoogleGenerativeAI(this[_0x5794f9(0x26c)][_0x5794f9(0x299)]),this[_0x5794f9(0x1e4)]=this[_0x5794f9(0x278)][_0x5794f9(0x1d7)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5794f9(0x202)}});}catch(_0x1780ed){this[_0x5794f9(0x2c5)][_0x5794f9(0x2a2)](_0x5794f9(0x1bd)+_0x1780ed[_0x5794f9(0x20a)]);}await setup['createAllObjects'](this),await this[_0x5794f9(0x23b)](),schedulers[_0x5794f9(0x1d9)](this),await this['setObjectNotExistsAsync'](_0x5794f9(0x21b),{'type':_0x5794f9(0x1da),'common':{'name':_0x5794f9(0x1cc),'type':_0x5794f9(0x29f),'role':_0x5794f9(0x274),'read':!![],'write':![]},'native':{}}),await this[_0x5794f9(0x280)](_0x5794f9(0x262),{'type':'state','common':{'name':_0x5794f9(0x2bf),'type':'string','role':_0x5794f9(0x1ef),'read':!![],'write':![],'def':_0x5794f9(0x1ca)},'native':{}}),await this[_0x5794f9(0x280)](_0x5794f9(0x2a0),{'type':_0x5794f9(0x1da),'common':{'name':_0x5794f9(0x1e1),'type':'string','role':_0x5794f9(0x1ef),'read':!![],'write':![],'def':_0x5794f9(0x1be)},'native':{}}),await this[_0x5794f9(0x280)](_0x5794f9(0x21d),{'type':_0x5794f9(0x1da),'common':{'name':_0x5794f9(0x25b),'type':'string','role':'text','read':!![],'write':![],'def':_0x5794f9(0x2b5)},'native':{}}),await this['setObjectNotExistsAsync'](_0x5794f9(0x1cf),{'type':'state','common':{'name':_0x5794f9(0x24d),'type':_0x5794f9(0x270),'role':_0x5794f9(0x24e),'read':!![],'write':![],'def':_0x5794f9(0x2b5)},'native':{}}),await this[_0x5794f9(0x280)](_0x5794f9(0x273),{'type':'state','common':{'name':_0x5794f9(0x1e8),'type':'string','role':_0x5794f9(0x1ef),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x5794f9(0x280)](_0x5794f9(0x295),{'type':_0x5794f9(0x1da),'common':{'name':'Daily\x20Room\x20Details\x20(48x30min)','type':_0x5794f9(0x270),'role':_0x5794f9(0x1ef),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x5794f9(0x280)]('analysis.health.activityTrend',{'type':_0x5794f9(0x1da),'common':{'name':_0x5794f9(0x2ae),'type':_0x5794f9(0x29f),'role':_0x5794f9(0x274),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x5794f9(0x280)](_0x5794f9(0x24a),{'type':'state','common':{'name':_0x5794f9(0x208),'type':_0x5794f9(0x270),'role':'json','read':!![],'write':![]},'native':{}});try{const _0x5a0310=await this[_0x5794f9(0x1f5)]('events.history');if(_0x5a0310&&_0x5a0310[_0x5794f9(0x1c8)]){this['eventHistory']=JSON[_0x5794f9(0x1fc)](_0x5a0310[_0x5794f9(0x1c8)]);if(this[_0x5794f9(0x20e)]){const _0x6045b4=await this[_0x5794f9(0x1f5)](_0x5794f9(0x1ba));if(_0x6045b4&&_0x6045b4[_0x5794f9(0x1c8)])this['rawEventLog']=JSON[_0x5794f9(0x1fc)](_0x6045b4[_0x5794f9(0x1c8)]);}this[_0x5794f9(0x2c5)][_0x5794f9(0x1fb)](_0x5794f9(0x1f7)+this['eventHistory'][_0x5794f9(0x1bf)]+_0x5794f9(0x1dd));}}catch(_0x8c1cbf){this[_0x5794f9(0x1d3)]=[];}try{const _0x4b1a81=await this[_0x5794f9(0x1f5)](_0x5794f9(0x2d5));if(_0x4b1a81&&_0x4b1a81['val'])this['dailyDigests']=JSON['parse'](_0x4b1a81[_0x5794f9(0x1c8)]);}catch(_0x488302){this[_0x5794f9(0x221)]=[];}const _0x5e31a5=this['dailyDigests'][_0x5794f9(0x1bf)]>=(this[_0x5794f9(0x26c)][_0x5794f9(0x1e3)]||0x7)?_0x5794f9(0x257)+this[_0x5794f9(0x221)][_0x5794f9(0x1bf)]+_0x5794f9(0x2b8):'Lernphase\x20('+this['dailyDigests']['length']+'/'+(this[_0x5794f9(0x26c)][_0x5794f9(0x1e3)]||0x7)+')';await this[_0x5794f9(0x2bb)]('LTM.baselineStatus',{'val':_0x5e31a5,'ack':!![]}),this['subscribeStates'](_0x5794f9(0x293)),this[_0x5794f9(0x28b)](_0x5794f9(0x260)),this[_0x5794f9(0x28b)](_0x5794f9(0x2cf));this[_0x5794f9(0x26c)][_0x5794f9(0x27c)]&&this['config'][_0x5794f9(0x239)]&&this[_0x5794f9(0x2d7)][_0x5794f9(0x279)]&&this[_0x5794f9(0x28c)](this[_0x5794f9(0x26c)][_0x5794f9(0x239)]);const _0x520e89=this[_0x5794f9(0x26c)][_0x5794f9(0x1d8)];if(_0x520e89)for(const _0x3626b2 of _0x520e89){await this[_0x5794f9(0x2cd)](_0x3626b2['id']);}const _0x49055f=this['config'][_0x5794f9(0x1f4)];if(_0x49055f)for(const _0x9c11b3 of _0x49055f){await this[_0x5794f9(0x2cd)](_0x9c11b3);}const _0x178598=require(_0x5794f9(0x2b7));if(this[_0x5794f9(0x204)])this[_0x5794f9(0x204)]['cancel']();this[_0x5794f9(0x204)]=_0x178598['scheduleJob'](_0x5794f9(0x250),()=>{this['saveDailyHistory']();}),setTimeout(()=>this[_0x5794f9(0x2b3)](),0x1388);if(this[_0x5794f9(0x25f)])clearInterval(this[_0x5794f9(0x25f)]);this[_0x5794f9(0x1af)](),this[_0x5794f9(0x25f)]=setInterval(async()=>{const _0x2c0aa4=_0x5794f9;await this[_0x2c0aa4(0x1af)]();},0x3c*0x3e8);if(this[_0x5794f9(0x2b9)])clearInterval(this[_0x5794f9(0x2b9)]);this['healthTrendInterval']=setInterval(()=>{const _0x584f2b=_0x5794f9;this['isProVersion']&&this[_0x584f2b(0x2d7)][_0x584f2b(0x261)]&&this[_0x584f2b(0x29e)]();},0x4*0x3c*0x3c*0x3e8);const _0x56689d=path[_0x5794f9(0x1d1)](__dirname,_0x5794f9(0x1b4),_0x5794f9(0x1ed),_0x5794f9(0x1c6));pythonBridge['startService'](this,_0x56689d);}[a0_0x1f7418(0x2be)](_0x4a6c3c){const _0x571b60=a0_0x1f7418;if(this[_0x571b60(0x204)])this[_0x571b60(0x204)][_0x571b60(0x258)]();this[_0x571b60(0x263)]()[_0x571b60(0x1d6)](()=>{const _0x46e558=_0x571b60;if(this[_0x46e558(0x2ad)])clearInterval(this[_0x46e558(0x2ad)]);if(this['roomIntegratorTimer'])clearInterval(this['roomIntegratorTimer']);recorder[_0x46e558(0x1d5)](this),pythonBridge[_0x46e558(0x255)](this),_0x4a6c3c();});}async[a0_0x1f7418(0x2b3)](){const _0x1f87e3=a0_0x1f7418;if(!this[_0x1f87e3(0x1d3)]||this[_0x1f87e3(0x1d3)][_0x1f87e3(0x1bf)]===0x0){this[_0x1f87e3(0x2c5)][_0x1f87e3(0x20f)](_0x1f87e3(0x2a1));return;}this[_0x1f87e3(0x2c5)][_0x1f87e3(0x1fb)]('â†º\x20Replaying\x20'+this['eventHistory'][_0x1f87e3(0x1bf)]+'\x20events\x20from\x20today...');const _0x257c8a=new Date()[_0x1f87e3(0x1ff)](0x0,0x0,0x0,0x0),_0x5e5cca=_0x1f87e3(0x2a0);let _0x5e96e7={'history':{},'date':new Date()[_0x1f87e3(0x235)]()};const _0x268466='analysis.health.todayVector',_0x58504f=_0x1f87e3(0x295);let _0x12f012=new Array(0x30)['fill'](0x0),_0x393de8=Array['from']({'length':0x30},()=>[]);this[_0x1f87e3(0x1d3)]['forEach'](_0xb8726b=>{const _0x168e89=_0x1f87e3;if(_0xb8726b[_0x168e89(0x213)]>=_0x257c8a){if(recorder['isRelevantActivity'](_0xb8726b[_0x168e89(0x2d4)],_0xb8726b[_0x168e89(0x274)])){const _0x650b96=new Date(_0xb8726b['timestamp']),_0x4049f1=_0x650b96['getHours']()*0x2+(_0x650b96[_0x168e89(0x1b3)]()>=0x1e?0x1:0x0);if(_0x4049f1<0x30){_0x12f012[_0x4049f1]++;const _0x3595e4=_0xb8726b['location']||_0xb8726b[_0x168e89(0x254)]||'?';let _0x41b8ba=_0x393de8[_0x4049f1];!_0x41b8ba[_0x168e89(0x264)](_0x3595e4)&&_0x41b8ba[_0x168e89(0x231)](_0x3595e4);}const _0x18aaf2=_0x650b96[_0x168e89(0x253)]();let _0x4c2eca=_0xb8726b[_0x168e89(0x2aa)]||_0x168e89(0x24b);const _0x3956f6=(this['config']['devices']||[])[_0x168e89(0x1d4)](_0x15442f=>_0x15442f['location']===_0x4c2eca);if(_0x3956f6)_0x4c2eca=_0x3956f6[_0x168e89(0x2aa)];if(!_0x5e96e7[_0x168e89(0x2d1)][_0x4c2eca])_0x5e96e7[_0x168e89(0x2d1)][_0x4c2eca]=new Array(0x18)[_0x168e89(0x1bb)](0x0);if(_0x5e96e7[_0x168e89(0x2d1)][_0x4c2eca][_0x18aaf2]<0x3c)_0x5e96e7[_0x168e89(0x2d1)][_0x4c2eca][_0x18aaf2]++;}}});const _0x2a0505=await this[_0x1f87e3(0x1f5)](_0x5e5cca);(!_0x2a0505||!_0x2a0505[_0x1f87e3(0x1c8)]||_0x2a0505[_0x1f87e3(0x1c8)]==='{}'||_0x2a0505[_0x1f87e3(0x1c8)]['includes']('\x22history\x22:{}'))&&await this['setStateAsync'](_0x5e5cca,{'val':JSON[_0x1f87e3(0x2a3)](_0x5e96e7),'ack':!![]}),await this['setStateAsync'](_0x268466,{'val':JSON[_0x1f87e3(0x2a3)](_0x12f012),'ack':!![]}),await this[_0x1f87e3(0x2bb)](_0x58504f,{'val':JSON[_0x1f87e3(0x2a3)](_0x393de8),'ack':!![]}),this[_0x1f87e3(0x2c5)][_0x1f87e3(0x1fb)](_0x1f87e3(0x29c));}async[a0_0x1f7418(0x263)](){const _0x136e1d=a0_0x1f7418;if(!this[_0x136e1d(0x2d7)][_0x136e1d(0x261)])return;const _0x46dcbf=new Date()[_0x136e1d(0x1c5)]()[_0x136e1d(0x1ec)]('T')[0x0];this['log'][_0x136e1d(0x251)](_0x136e1d(0x2b6)+_0x46dcbf+_0x136e1d(0x252));try{const [_0x4417f3,_0xb68166,_0x42921a,_0x374736,_0x15af2b,_0x42465e]=await Promise[_0x136e1d(0x229)]([this[_0x136e1d(0x1f5)](_0x136e1d(0x2a0)),this['getStateAsync'](_0x136e1d(0x21d)),this[_0x136e1d(0x1f5)](_0x136e1d(0x1cf)),this[_0x136e1d(0x1f5)](_0x136e1d(0x1b2)),this['getStateAsync'](_0x136e1d(0x273)),this[_0x136e1d(0x1f5)](_0x136e1d(0x2a7))]),_0x21a97e=this[_0x136e1d(0x1d3)][_0x136e1d(0x218)](_0x30b01d=>_0x30b01d['timestamp']>=new Date()[_0x136e1d(0x1ff)](0x0,0x0,0x0,0x0)&&(_0x30b01d[_0x136e1d(0x254)]['toLowerCase']()[_0x136e1d(0x264)](_0x136e1d(0x26b))||_0x30b01d[_0x136e1d(0x254)][_0x136e1d(0x1ad)]()[_0x136e1d(0x264)](_0x136e1d(0x282)))&&(_0x30b01d[_0x136e1d(0x274)]===!![]||_0x30b01d['value']===_0x136e1d(0x23e)))['length'];let _0x7016c5=0x55;if(_0x42465e&&_0x42465e['val']!==undefined)_0x7016c5=Math['min'](0x64,Math[_0x136e1d(0x289)](0x14,Math['round'](0x50+Number(_0x42465e['val'])*0x5)));const _0x35eecf={'date':_0x46dcbf,'timestamp':Date['now'](),'roomHistory':_0x4417f3?.[_0x136e1d(0x1c8)]?JSON[_0x136e1d(0x1fc)](_0x4417f3['val']):{},'geminiNight':_0xb68166?.[_0x136e1d(0x1c8)]||_0x136e1d(0x2bc),'geminiDay':_0x42921a?.[_0x136e1d(0x1c8)]||'Keine\x20Daten','anomalyScore':_0x374736?.[_0x136e1d(0x1c8)]||0.1,'todayVector':_0x15af2b?.[_0x136e1d(0x1c8)]?JSON[_0x136e1d(0x1fc)](_0x15af2b[_0x136e1d(0x1c8)]):new Array(0x30)['fill'](0x0),'batteryLevel':_0x7016c5,'freshAirCount':_0x21a97e,'eventHistory':this['eventHistory']},_0x4a146f=utils[_0x136e1d(0x2db)](),_0x1e294a=path['join'](_0x4a146f,_0x136e1d(0x27e),'history');if(!fs[_0x136e1d(0x27b)](_0x1e294a))fs[_0x136e1d(0x209)](_0x1e294a,{'recursive':!![]});const _0xb23157=path[_0x136e1d(0x1d1)](_0x1e294a,_0x46dcbf+_0x136e1d(0x2e0));fs['writeFileSync'](_0xb23157,JSON[_0x136e1d(0x2a3)](_0x35eecf)),this[_0x136e1d(0x2c5)]['info'](_0x136e1d(0x1d2)+_0xb23157);}catch(_0x2b786a){this[_0x136e1d(0x2c5)][_0x136e1d(0x2a2)](_0x136e1d(0x1b1)+_0x2b786a[_0x136e1d(0x20a)]);}}async[a0_0x1f7418(0x1af)](){const _0x528634=a0_0x1f7418;if(!this[_0x528634(0x1f6)])return;try{let _0x60ce7c=null;try{const _0x14079c=await this[_0x528634(0x1f5)](_0x528634(0x271)),_0x8d1fa5=await this[_0x528634(0x1f5)](_0x528634(0x227));if(_0x14079c&&_0x14079c[_0x528634(0x1c8)]&&_0x8d1fa5&&_0x8d1fa5['val']&&_0x8d1fa5[_0x528634(0x1c8)]>0.3){if(_0x14079c[_0x528634(0x1c8)]!==_0x528634(0x24b)&&_0x14079c['val']!==_0x528634(0x2d2))_0x60ce7c=_0x14079c[_0x528634(0x1c8)];}}catch(_0x39f912){}if(!_0x60ce7c){const _0xa39f70=this['config'][_0x528634(0x1d8)]||[];for(const _0x27ea9e of _0xa39f70){if(_0x27ea9e[_0x528634(0x2d4)]===_0x528634(0x1c7)&&_0x27ea9e['location'])try{const _0x18c5b5=await this['getForeignStateAsync'](_0x27ea9e['id']);if(_0x18c5b5&&(_0x18c5b5[_0x528634(0x1c8)]===!![]||_0x18c5b5[_0x528634(0x1c8)]==='on'||_0x18c5b5[_0x528634(0x1c8)]===0x1)){_0x60ce7c=_0x27ea9e['location'];break;}}catch(_0x54762d){}}}if(!_0x60ce7c)return;const _0x1bb65c=this[_0x528634(0x26c)]['devices']||[];let _0x3fe8df=_0x60ce7c;const _0x27a724=_0x1bb65c[_0x528634(0x1d4)](_0x256be0=>_0x256be0[_0x528634(0x2aa)]&&_0x256be0['location'][_0x528634(0x1ad)]()===_0x60ce7c['toLowerCase']());if(_0x27a724)_0x3fe8df=_0x27a724[_0x528634(0x2aa)];const _0x4d582='analysis.activity.roomHistory',_0x3e0b72=await this['getStateAsync'](_0x4d582),_0x546548=new Date()['toLocaleDateString']();let _0x13ce3c={'history':{},'date':_0x546548};if(_0x3e0b72&&_0x3e0b72[_0x528634(0x1c8)])try{_0x13ce3c=JSON[_0x528634(0x1fc)](_0x3e0b72[_0x528634(0x1c8)]);}catch(_0x1988a6){}_0x13ce3c[_0x528634(0x291)]!==_0x546548&&(_0x13ce3c[_0x528634(0x2d1)]={},_0x13ce3c[_0x528634(0x291)]=_0x546548);if(!_0x13ce3c['history'][_0x3fe8df])_0x13ce3c[_0x528634(0x2d1)][_0x3fe8df]=new Array(0x18)[_0x528634(0x1bb)](0x0);const _0x5ae45f=new Date()['getHours']();if(_0x13ce3c[_0x528634(0x2d1)][_0x3fe8df][_0x5ae45f]<0x3c)_0x13ce3c[_0x528634(0x2d1)][_0x3fe8df][_0x5ae45f]++;await this[_0x528634(0x2bb)](_0x4d582,{'val':JSON['stringify'](_0x13ce3c),'ack':!![]});}catch(_0x372a28){this[_0x528634(0x2c5)][_0x528634(0x20f)](_0x528634(0x1e9)+_0x372a28[_0x528634(0x20a)]);}}async[a0_0x1f7418(0x1e7)](_0x401be5){const _0x4cea9c=a0_0x1f7418;if(typeof _0x401be5===_0x4cea9c(0x1b0)&&_0x401be5[_0x4cea9c(0x20a)]){if(_0x401be5[_0x4cea9c(0x245)]===_0x4cea9c(0x297)){const _0x23759b=_0x401be5['message'][_0x4cea9c(0x291)],_0x1e27f5=utils[_0x4cea9c(0x2db)](),_0x725961=path[_0x4cea9c(0x1d1)](_0x1e27f5,_0x4cea9c(0x27e),_0x4cea9c(0x2d1),_0x23759b+_0x4cea9c(0x2e0));if(fs['existsSync'](_0x725961))try{const _0x36a469=JSON[_0x4cea9c(0x1fc)](fs['readFileSync'](_0x725961,_0x4cea9c(0x230)));this[_0x4cea9c(0x256)](_0x401be5['from'],_0x401be5[_0x4cea9c(0x245)],{'success':!![],'data':_0x36a469},_0x401be5['callback']);}catch(_0x36b6b6){this['sendTo'](_0x401be5[_0x4cea9c(0x24f)],_0x401be5[_0x4cea9c(0x245)],{'success':![],'error':'Corrupt'},_0x401be5['callback']);}else this[_0x4cea9c(0x256)](_0x401be5[_0x4cea9c(0x24f)],_0x401be5['command'],{'success':![],'error':_0x4cea9c(0x23a)},_0x401be5['callback']);}else{if(_0x401be5[_0x4cea9c(0x245)]===_0x4cea9c(0x2e2)){const _0x5b173d=this[_0x4cea9c(0x221)][_0x4cea9c(0x1bf)];let _0x1a54df=new Array(0x30)[_0x4cea9c(0x1bb)](0x0),_0x1075ba=Array[_0x4cea9c(0x24f)]({'length':0x30},()=>[]);try{const _0x443307=await this[_0x4cea9c(0x1f5)](_0x4cea9c(0x273));if(_0x443307&&_0x443307[_0x4cea9c(0x1c8)])_0x1a54df=JSON[_0x4cea9c(0x1fc)](_0x443307[_0x4cea9c(0x1c8)]);const _0x1e6cd7=await this[_0x4cea9c(0x1f5)](_0x4cea9c(0x295));if(_0x1e6cd7&&_0x1e6cd7['val'])_0x1075ba=JSON['parse'](_0x1e6cd7[_0x4cea9c(0x1c8)]);}catch(_0x154985){}let _0xaafe1=new Array(0x30)[_0x4cea9c(0x1bb)](0x0);try{const _0x7ff0ad=new Date();_0x7ff0ad['setDate'](_0x7ff0ad[_0x4cea9c(0x1e5)]()-0x1);const _0xbfd35b=_0x7ff0ad[_0x4cea9c(0x1c5)]()['split']('T')[0x0],_0x4c324c=utils[_0x4cea9c(0x2db)](),_0x516121=path[_0x4cea9c(0x1d1)](_0x4c324c,'cogni-living',_0x4cea9c(0x2d1),_0xbfd35b+_0x4cea9c(0x2e0));if(fs[_0x4cea9c(0x27b)](_0x516121)){const _0x3bb587=JSON[_0x4cea9c(0x1fc)](fs[_0x4cea9c(0x23d)](_0x516121,'utf8'));if(_0x3bb587&&_0x3bb587['todayVector'])_0xaafe1=_0x3bb587['todayVector'];}}catch(_0x1e63a){}let _0x1c9a60={'today':{},'yesterday':{}};try{const _0x46af0b=await this[_0x4cea9c(0x1f5)](_0x4cea9c(0x262));if(_0x46af0b&&_0x46af0b[_0x4cea9c(0x1c8)])_0x1c9a60=JSON[_0x4cea9c(0x1fc)](_0x46af0b[_0x4cea9c(0x1c8)]);}catch(_0x1fa966){}let _0x3e3b07=null;try{const _0x5af45c=await this[_0x4cea9c(0x1f5)](_0x4cea9c(0x2a7));if(_0x5af45c)_0x3e3b07=_0x5af45c['val'];}catch(_0x32a44f){}if(_0x3e3b07===undefined||_0x3e3b07===null){const _0x58dd67=_0x1a54df[_0x4cea9c(0x212)]((_0x85f131,_0x4d9672)=>_0x85f131+_0x4d9672,0x0),_0x5eefaf=Math[_0x4cea9c(0x246)](0x2,Math[_0x4cea9c(0x289)](-0x2,(0x64-_0x58dd67)/0x32));_0x3e3b07=_0x5eefaf;}let _0x58b005=![],_0x33d313='',_0x3610a1='',_0x400cfa='';try{const _0x49e63b=await this['getStateAsync'](_0x4cea9c(0x26e));if(_0x49e63b&&_0x49e63b['val']){_0x58b005=!![];const _0x4da5ab=await this[_0x4cea9c(0x1f5)]('analysis.automation.description');_0x33d313=_0x4da5ab?_0x4da5ab[_0x4cea9c(0x1c8)]:'';const _0xd202ff=await this['getStateAsync']('analysis.automation.targetId');_0x3610a1=_0xd202ff?_0xd202ff[_0x4cea9c(0x1c8)]:'';const _0xffabc4=await this['getStateAsync'](_0x4cea9c(0x2a4));_0x400cfa=_0xffabc4?_0xffabc4[_0x4cea9c(0x1c8)]:'';}}catch(_0x47c4c3){}const _0x225e7e=await this[_0x4cea9c(0x1fd)](),_0x3f818b=(this['config'][_0x4cea9c(0x1d8)]||[])[_0x4cea9c(0x27a)](_0x16b698=>_0x16b698[_0x4cea9c(0x22c)]),_0x56e003=_0x225e7e&&_0x3f818b;let _0x354ee8='';try{const _0x443235=await this['getStateAsync'](_0x4cea9c(0x294));if(_0x443235&&_0x443235[_0x4cea9c(0x1c8)])_0x354ee8=_0x443235[_0x4cea9c(0x1c8)];}catch(_0x43f061){}this[_0x4cea9c(0x256)](_0x401be5['from'],_0x401be5[_0x4cea9c(0x245)],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0x7d0),'stats':{'digestCount':_0x5b173d,'isPresent':this[_0x4cea9c(0x1f6)],'hourlyActivity':_0x1a54df,'hourlyDetails':_0x1075ba,'yesterdayActivity':_0xaafe1,'solarActive':_0x56e003,'presenceWho':_0x354ee8,'roomStats':_0x1c9a60,'activityTrend':_0x3e3b07,'modules':this[_0x4cea9c(0x2d7)]},'automation':{'detected':_0x58b005,'description':_0x33d313,'targetId':_0x3610a1,'targetValue':_0x400cfa}},_0x401be5[_0x4cea9c(0x238)]);}else{if(_0x401be5[_0x4cea9c(0x245)]===_0x4cea9c(0x29d))try{const _0x42a671=await automation[_0x4cea9c(0x24c)](this);this[_0x4cea9c(0x256)](_0x401be5[_0x4cea9c(0x24f)],_0x401be5[_0x4cea9c(0x245)],{'success':!![],'results':_0x42a671},_0x401be5['callback']);}catch(_0x4153d1){this[_0x4cea9c(0x256)](_0x401be5['from'],_0x401be5[_0x4cea9c(0x245)],{'success':![],'error':_0x4153d1['message']},_0x401be5[_0x4cea9c(0x238)]);}else{if(_0x401be5[_0x4cea9c(0x245)]===_0x4cea9c(0x2b4))try{const _0x24e249=await scanner[_0x4cea9c(0x277)](this,_0x401be5[_0x4cea9c(0x20a)]||{});this['sendTo'](_0x401be5[_0x4cea9c(0x24f)],_0x401be5[_0x4cea9c(0x245)],{'success':!![],'devices':_0x24e249},_0x401be5[_0x4cea9c(0x238)]);}catch(_0x484838){}else{if(_0x401be5[_0x4cea9c(0x245)]==='getEnums'){const _0x278c59=await this['getForeignObjectsAsync'](_0x4cea9c(0x28d),_0x4cea9c(0x1b9)),_0x9a7a7e=[];if(_0x278c59)for(const _0x160ac7 in _0x278c59){let _0x24abf1=_0x278c59[_0x160ac7][_0x4cea9c(0x28a)]['name'];if(_0x24abf1&&typeof _0x24abf1===_0x4cea9c(0x1b0))_0x24abf1=_0x24abf1['de']||_0x24abf1['en']||Object[_0x4cea9c(0x1f1)](_0x24abf1)[0x0]||JSON[_0x4cea9c(0x2a3)](_0x24abf1);_0x9a7a7e[_0x4cea9c(0x231)]({'id':_0x160ac7,'name':String(_0x24abf1||_0x160ac7)});}const _0xd101a7=await this[_0x4cea9c(0x237)](_0x4cea9c(0x22d),_0x4cea9c(0x1b9)),_0x13cd7d=[];if(_0xd101a7)for(const _0x1b6fb4 in _0xd101a7){let _0x53d8c3=_0xd101a7[_0x1b6fb4][_0x4cea9c(0x28a)][_0x4cea9c(0x254)];if(_0x53d8c3&&typeof _0x53d8c3===_0x4cea9c(0x1b0))_0x53d8c3=_0x53d8c3['de']||_0x53d8c3['en']||Object[_0x4cea9c(0x1f1)](_0x53d8c3)[0x0]||JSON[_0x4cea9c(0x2a3)](_0x53d8c3);_0x13cd7d['push'](String(_0x53d8c3||_0x1b6fb4['split']('.')[_0x4cea9c(0x225)]()));}this[_0x4cea9c(0x256)](_0x401be5[_0x4cea9c(0x24f)],_0x401be5[_0x4cea9c(0x245)],{'success':!![],'enums':_0x9a7a7e,'rooms':_0x13cd7d},_0x401be5[_0x4cea9c(0x238)]);}else{if(_0x401be5[_0x4cea9c(0x245)]==='getCalendarNames')try{const _0x24377a=await this['getObjectViewAsync'](_0x4cea9c(0x2ab),_0x4cea9c(0x1fe),{'startkey':_0x4cea9c(0x2a5),'endkey':_0x4cea9c(0x2ba)}),_0x5169ec=new Set();if(_0x24377a&&_0x24377a[_0x4cea9c(0x286)])for(const _0x3ef623 of _0x24377a['rows']){const _0x6754fc=_0x3ef623['id'][_0x4cea9c(0x1f2)]('system.adapter.',''),_0x12db08=await this[_0x4cea9c(0x234)](_0x6754fc+_0x4cea9c(0x2cc));let _0x26ac97=![];if(_0x12db08&&_0x12db08['val']){const _0x281d9f=typeof _0x12db08[_0x4cea9c(0x1c8)]==='string'?JSON[_0x4cea9c(0x1fc)](_0x12db08['val']):_0x12db08['val'];Array[_0x4cea9c(0x21e)](_0x281d9f)&&_0x281d9f['forEach'](_0x3f430c=>{const _0xdc087a=_0x4cea9c;_0x3f430c[_0xdc087a(0x216)]&&(_0x5169ec['add'](_0x3f430c[_0xdc087a(0x216)]),_0x26ac97=!![]);});}!_0x26ac97&&_0x5169ec[_0x4cea9c(0x1c0)](_0x6754fc);}const _0xdc87c4=Array['from'](_0x5169ec);if(_0xdc87c4[_0x4cea9c(0x1bf)]===0x0)_0xdc87c4[_0x4cea9c(0x231)]('Standard');this[_0x4cea9c(0x256)](_0x401be5['from'],_0x401be5[_0x4cea9c(0x245)],{'success':!![],'names':_0xdc87c4},_0x401be5[_0x4cea9c(0x238)]);}catch(_0x324048){this[_0x4cea9c(0x256)](_0x401be5[_0x4cea9c(0x24f)],_0x401be5[_0x4cea9c(0x245)],{'success':![],'error':_0x4cea9c(0x243)+_0x324048[_0x4cea9c(0x20a)]},_0x401be5['callback']);}else{if(_0x401be5[_0x4cea9c(0x245)]===_0x4cea9c(0x228))try{const _0x2e6492=_0x401be5[_0x4cea9c(0x20a)]?_0x401be5['message'][_0x4cea9c(0x265)]:'';if(!_0x2e6492)throw new Error(_0x4cea9c(0x244));const _0x2a91ec=new GoogleGenerativeAI(_0x2e6492),_0x20984e=_0x2a91ec[_0x4cea9c(0x1d7)]({'model':GEMINI_MODEL}),_0x4136c6=await _0x20984e['generateContent']('Say\x20Hello'),_0x1d9488=await _0x4136c6[_0x4cea9c(0x1eb)],_0x17e097=_0x1d9488[_0x4cea9c(0x24e)]();this[_0x4cea9c(0x256)](_0x401be5[_0x4cea9c(0x24f)],_0x401be5[_0x4cea9c(0x245)],{'success':!![],'message':'Verbindung\x20erfolgreich:\x20'+_0x17e097[_0x4cea9c(0x20c)](0x0,0x14)+_0x4cea9c(0x252)},_0x401be5[_0x4cea9c(0x238)]);}catch(_0x249a8e){this[_0x4cea9c(0x256)](_0x401be5[_0x4cea9c(0x24f)],_0x401be5[_0x4cea9c(0x245)],{'success':![],'message':_0x249a8e[_0x4cea9c(0x20a)]},_0x401be5[_0x4cea9c(0x238)]);}else{if(_0x401be5[_0x4cea9c(0x245)]===_0x4cea9c(0x2de))try{const _0x10711d=await this[_0x4cea9c(0x1fd)](),_0x5ec8b3=await this[_0x4cea9c(0x276)](_0x4cea9c(0x2ab),_0x4cea9c(0x1fe),{'startkey':_0x4cea9c(0x2a5),'endkey':'system.adapter.ical.é¦™'}),_0x14f01d=_0x5ec8b3&&_0x5ec8b3[_0x4cea9c(0x286)]?_0x5ec8b3[_0x4cea9c(0x286)][_0x4cea9c(0x1bf)]:0x0;this[_0x4cea9c(0x256)](_0x401be5[_0x4cea9c(0x24f)],_0x401be5[_0x4cea9c(0x245)],{'success':!![],'weather':'Sonne:\x20'+_0x10711d+_0x4cea9c(0x217)+(this[_0x4cea9c(0x241)][this[_0x4cea9c(0x26c)][_0x4cea9c(0x1ce)]]||'?')+'Â°C','calendar':_0x14f01d+_0x4cea9c(0x211)},_0x401be5[_0x4cea9c(0x238)]);}catch(_0x62680b){this[_0x4cea9c(0x256)](_0x401be5['from'],_0x401be5[_0x4cea9c(0x245)],{'success':![]},_0x401be5[_0x4cea9c(0x238)]);}}}}}}}}}}[a0_0x1f7418(0x29e)](){const _0x347b46=a0_0x1f7418;if(!this[_0x347b46(0x2d7)]['health'])return;this[_0x347b46(0x2c5)][_0x347b46(0x251)]('ðŸ\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...');try{const _0x41ac9e=this[_0x347b46(0x23c)]||[];pythonBridge['send'](this,_0x347b46(0x2c0),{'events':_0x41ac9e});}catch(_0x16a0fa){this[_0x347b46(0x2c5)][_0x347b46(0x20f)](_0x347b46(0x2b2));}}async[a0_0x1f7418(0x2bd)](_0x2c5a97,_0x5e3804){const _0x5f23c5=a0_0x1f7418;if(!_0x5e3804||this[_0x5f23c5(0x214)])return;if(_0x2c5a97[_0x5f23c5(0x264)](_0x5f23c5(0x201))&&_0x2c5a97[_0x5f23c5(0x1f3)](_0x5f23c5(0x284))&&_0x5e3804[_0x5f23c5(0x1c8)])return;if(this[_0x5f23c5(0x26c)][_0x5f23c5(0x27c)]&&_0x2c5a97===this[_0x5f23c5(0x26c)][_0x5f23c5(0x239)]&&this['activeModules'][_0x5f23c5(0x279)]){this[_0x5f23c5(0x220)](_0x5e3804[_0x5f23c5(0x1c8)]);return;}if(_0x5e3804[_0x5f23c5(0x1bc)]&&_0x2c5a97[_0x5f23c5(0x1f3)](_0x5f23c5(0x2ca)))return;if(_0x2c5a97===this[_0x5f23c5(0x288)]+_0x5f23c5(0x2c8)){if(_0x5e3804[_0x5f23c5(0x1c8)]&&Object['values'](setup['SYSTEM_MODES'])[_0x5f23c5(0x264)](_0x5e3804[_0x5f23c5(0x1c8)])){this['currentSystemMode']=_0x5e3804[_0x5f23c5(0x1c8)];if(_0x5e3804[_0x5f23c5(0x1c8)]===setup[_0x5f23c5(0x2d3)][_0x5f23c5(0x1de)])await recorder[_0x5f23c5(0x28e)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x5f23c5(0x20e)]){let _0x2dacd3=![],_0x5328e7=0x0,_0xeb693e=_0x5f23c5(0x219);if(this['currentSystemMode']===_0x5f23c5(0x2b1))_0x2dacd3=!![],_0x5328e7=0x168,_0xeb693e='Party\x20Mode';else this[_0x5f23c5(0x25c)]===_0x5f23c5(0x2da)&&(_0x2dacd3=!![],_0x5328e7=0x5a0,_0xeb693e=_0x5f23c5(0x210));pythonBridge['send'](this,_0x5f23c5(0x26f),{'active':_0x2dacd3,'duration':_0x5328e7,'label':_0xeb693e}),await this[_0x5f23c5(0x2bb)]('analysis.security.learningStatus',{'val':JSON[_0x5f23c5(0x2a3)]({'active':_0x2dacd3,'label':_0xeb693e,'timestamp':Date['now']()}),'ack':!![]});}}if(!_0x5e3804['ack'])this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':this[_0x5f23c5(0x25c)],'ack':!![]});return;}if(_0x2c5a97[_0x5f23c5(0x1f3)](_0x5f23c5(0x1b6))&&_0x5e3804[_0x5f23c5(0x1bc)])this['protectAiMemory'](_0x5e3804[_0x5f23c5(0x1c8)]);if(_0x2c5a97[_0x5f23c5(0x1f3)]('analysis.energy.warmupTimes')&&_0x5e3804[_0x5f23c5(0x1bc)]&&this[_0x5f23c5(0x2d7)]['energy'])automation[_0x5f23c5(0x29b)](this);if(!_0x5e3804[_0x5f23c5(0x1bc)]){if(_0x2c5a97['includes']('analysis.trigger')&&_0x5e3804['val']){this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':![],'ack':!![]}),aiAgent[_0x5f23c5(0x287)](this);return;}if(_0x2c5a97['includes']('triggerDailyDigest')&&_0x5e3804[_0x5f23c5(0x1c8)]){this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':![],'ack':!![]});if(this[_0x5f23c5(0x20e)])aiAgent[_0x5f23c5(0x285)](this,pythonBridge);return;}if(_0x2c5a97[_0x5f23c5(0x264)](_0x5f23c5(0x2e1))&&_0x5e3804[_0x5f23c5(0x1c8)]){this['setState'](_0x2c5a97,{'val':![],'ack':!![]}),aiAgent[_0x5f23c5(0x2e4)](this);return;}if(_0x2c5a97[_0x5f23c5(0x264)](_0x5f23c5(0x1dc))&&_0x5e3804[_0x5f23c5(0x1c8)]){this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x2c5a97['includes'](_0x5f23c5(0x1c9))&&_0x5e3804[_0x5f23c5(0x1c8)]){this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':![],'ack':!![]});if(this[_0x5f23c5(0x20e)])try{const _0x39fe66=await this['getStateAsync'](_0x5f23c5(0x2ac));if(_0x39fe66&&_0x39fe66[_0x5f23c5(0x1c8)]){const _0x400fd0=JSON['parse'](_0x39fe66[_0x5f23c5(0x1c8)]);this[_0x5f23c5(0x2bb)]('analysis.training.status',{'val':_0x5f23c5(0x1b8),'ack':!![]}),pythonBridge[_0x5f23c5(0x268)](this,'TRAIN_SECURITY',{'sequences':_0x400fd0});}}catch(_0x1d5099){}return;}if(_0x2c5a97[_0x5f23c5(0x264)](_0x5f23c5(0x2cf))&&_0x5e3804['val']){this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':![],'ack':!![]});if(this[_0x5f23c5(0x20e)])try{this['runPythonHealthCheck']();const _0x1bbc00=await this['getStateAsync']('LTM.dailyDigests');if(_0x1bbc00&&_0x1bbc00['val'])pythonBridge[_0x5f23c5(0x268)](this,_0x5f23c5(0x2ce),{'digests':JSON['parse'](_0x1bbc00[_0x5f23c5(0x1c8)])});aiAgent['generateHealthReport'](this,_0x5f23c5(0x21c)),setTimeout(()=>aiAgent[_0x5f23c5(0x1fa)](this,'DAY'),0x2ee0);}catch(_0x555ad9){}return;}if(_0x2c5a97['includes'](_0x5f23c5(0x20d))&&_0x5e3804[_0x5f23c5(0x1c8)]){this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':![],'ack':!![]});if(this[_0x5f23c5(0x20e)])try{const _0x225771=await this[_0x5f23c5(0x1f5)]('LTM.trainingData.thermodynamics');if(_0x225771&&_0x225771[_0x5f23c5(0x1c8)])pythonBridge[_0x5f23c5(0x268)](this,_0x5f23c5(0x215),{'points':JSON['parse'](_0x225771['val'])});}catch(_0x34dd48){}return;}if(_0x2c5a97[_0x5f23c5(0x264)]('analysis.training.triggerComfort')&&_0x5e3804['val']){this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':![],'ack':!![]});if(this[_0x5f23c5(0x20e)])try{const _0x278eef=await this[_0x5f23c5(0x1f5)](_0x5f23c5(0x1ba));if(_0x278eef&&_0x278eef[_0x5f23c5(0x1c8)]){const _0x233bd5={};if(this[_0x5f23c5(0x26c)]['devices'])this[_0x5f23c5(0x26c)][_0x5f23c5(0x1d8)][_0x5f23c5(0x1ee)](_0x5d6413=>{if(_0x5d6413['id']&&_0x5d6413['type'])_0x233bd5[_0x5d6413['id']]=_0x5d6413['type'];});pythonBridge[_0x5f23c5(0x268)](this,_0x5f23c5(0x2d0),{'events':JSON[_0x5f23c5(0x1fc)](_0x278eef[_0x5f23c5(0x1c8)]),'deviceMap':_0x233bd5});}}catch(_0x547802){}return;}if(_0x2c5a97[_0x5f23c5(0x264)]('analysis.training.triggerTopology')&&_0x5e3804['val']){this[_0x5f23c5(0x1f0)](_0x2c5a97,{'val':![],'ack':!![]}),topology[_0x5f23c5(0x2c6)](this);if(this[_0x5f23c5(0x20e)])try{const _0x3222d4=await this[_0x5f23c5(0x1f5)](_0x5f23c5(0x2ac));if(_0x3222d4&&_0x3222d4['val'])pythonBridge['send'](this,_0x5f23c5(0x240),{'sequences':JSON[_0x5f23c5(0x1fc)](_0x3222d4[_0x5f23c5(0x1c8)])});}catch(_0x34142b){}return;}}const _0x2b0dbc=(this[_0x5f23c5(0x26c)]['devices']||[])[_0x5f23c5(0x1d4)](_0x3f2c19=>_0x3f2c19['id']===_0x2c5a97);if(_0x2b0dbc){const _0x4299fa=await recorder[_0x5f23c5(0x1b5)](this,_0x2c5a97,_0x5e3804,_0x2b0dbc);_0x4299fa&&this[_0x5f23c5(0x1f0)](_0x5f23c5(0x21b),{'val':Date[_0x5f23c5(0x206)](),'ack':!![]});_0x4299fa&&_0x4299fa['type']===_0x5f23c5(0x1c7)&&_0x4299fa[_0x5f23c5(0x2aa)]&&this[_0x5f23c5(0x20e)]&&deadMan['updateLocation'](this,_0x4299fa['location']);_0x5e3804[_0x5f23c5(0x1c8)]&&(_0x5e3804['val']===!![]||_0x5e3804[_0x5f23c5(0x1c8)]===0x1||String(_0x5e3804[_0x5f23c5(0x1c8)])[_0x5f23c5(0x1ad)]()===_0x5f23c5(0x23e))&&(_0x2b0dbc[_0x5f23c5(0x2d4)]&&(_0x2b0dbc['type'][_0x5f23c5(0x264)](_0x5f23c5(0x269))||_0x2b0dbc[_0x5f23c5(0x2d4)][_0x5f23c5(0x264)]('door'))&&this[_0x5f23c5(0x1e6)](_0x2b0dbc));if(_0x2b0dbc['type']===_0x5f23c5(0x248)||_0x2b0dbc[_0x5f23c5(0x2d4)]===_0x5f23c5(0x283)){if(this[_0x5f23c5(0x2d7)][_0x5f23c5(0x2cb)])automation[_0x5f23c5(0x232)](this);}}}async[a0_0x1f7418(0x2c3)](_0x38fd7e){const _0x4b5dce=a0_0x1f7418;if(!this[_0x4b5dce(0x1c2)]||Date['now']()-this[_0x4b5dce(0x2c7)]>0x493e0)return;try{const _0x16dee7=JSON[_0x4b5dce(0x1fc)](_0x38fd7e),_0x59eec3=this[_0x4b5dce(0x1c2)][_0x4b5dce(0x226)];let _0x44e20c=![];for(const _0x9ea082 in _0x59eec3){if(_0x59eec3[_0x9ea082][_0x4b5dce(0x264)]('AI')&&_0x16dee7[_0x9ea082]&&!_0x16dee7[_0x9ea082][_0x4b5dce(0x264)]('AI')){_0x44e20c=!![];break;}}_0x44e20c&&(await this['setStateAsync'](_0x4b5dce(0x24a),{'val':JSON[_0x4b5dce(0x2a3)](this[_0x4b5dce(0x1c2)][_0x4b5dce(0x275)]),'ack':!![]}),await this['setStateAsync']('analysis.energy.warmupSources',{'val':JSON[_0x4b5dce(0x2a3)](this[_0x4b5dce(0x1c2)][_0x4b5dce(0x226)]),'ack':!![]}));}catch(_0x2a7fa2){}}async[a0_0x1f7418(0x23b)](){const _0x2b392f=a0_0x1f7418;try{const _0x13a83a=await this[_0x2b392f(0x1f5)](setup[_0x2b392f(0x1c4)]);if(_0x13a83a&&_0x13a83a[_0x2b392f(0x1c8)])this[_0x2b392f(0x25c)]=_0x13a83a[_0x2b392f(0x1c8)];}catch(_0x5d12a1){this[_0x2b392f(0x25c)]=setup[_0x2b392f(0x2d3)]['NORMAL'];}}async[a0_0x1f7418(0x2dd)](){return![];}async[a0_0x1f7418(0x224)](){const _0x2dd386=a0_0x1f7418;await aiAgent[_0x2dd386(0x287)](this);this[_0x2dd386(0x2d7)][_0x2dd386(0x261)]&&(this[_0x2dd386(0x23f)](),this[_0x2dd386(0x233)]());if(this[_0x2dd386(0x2d7)][_0x2dd386(0x2cb)])this[_0x2dd386(0x272)]();}async[a0_0x1f7418(0x1fd)](){return![];}[a0_0x1f7418(0x233)](){const _0x27ffe7=a0_0x1f7418;if(!this[_0x27ffe7(0x20e)])return;}async[a0_0x1f7418(0x272)](){}[a0_0x1f7418(0x23f)](){}async[a0_0x1f7418(0x220)](_0x31de57){}async[a0_0x1f7418(0x249)](_0xf50e1e,_0x12e6b6){}async[a0_0x1f7418(0x1e6)](_0x27760a){}async[a0_0x1f7418(0x2c4)](_0x1e7ff5){}[a0_0x1f7418(0x222)](_0x363cd0){}}if(require[a0_0x1f7418(0x22b)]!==module)module[a0_0x1f7418(0x2a8)]=_0x51c738=>new CogniLiving(_0x51c738);else new CogniLiving();