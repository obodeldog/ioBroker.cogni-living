const a0_0x5c7278=a0_0x2ebd;function a0_0x208e(){const _0x5bca16=['alertReason','testApiKey','push','WETTER\x20ERROR:\x20','Processing\x20Status','stick_unreach','Event\x20History','toLowerCase','setForeignStateAsync','exports','scheduleJob','valve','slice','Entry\x20detected\x20via\x20','command','analysis.isEmergency','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','isGracePeriodActive','IGNORING\x20DUPLICATE\x20(Cached):\x20','Gemini\x20AI\x20initialized.','javascript.','minDaysForBaseline','livingContext','geminiModel',').\x20Starting\x20Timer.','cancel','endsWith','info','Deviation','cover','Could\x20not\x20kill\x20Python\x20process:\x20','system.isPresent','lowbat','notifyPushoverEnabled','application/json','sound','toISOString','subscribeStates','Scheduling\x20Morning\x20Briefing\x20for\x20','analysis.trigger','accuweather.0','dismissAutomation','0\x203\x20*\x20*\x20*','switch','rollladen','config_pending','autoApply','version','LTM.driftAnalysis.lastCheck','getMonth','.\x0a\x20\x20\x20\x20WETTER:\x20','health','analysis.automation.targetId','humidity','brightness','getForeignObjectsAsync','response','apply','substring','firmware','blind','.data.table','timestamp','rssi','getStateAsync','dutycycle','targetId','object','.\x20Welcome\x20home.','GUEST','feedbackHistory','LTM.rawEventLog','config','callback','accuweather','weatherunderground.0','...','state','licenseKey','Briefing\x20Error:\x20','notifyTelegramInstance','Skipped\x20(No\x20AI\x20or\x20Data)','close','temperature','systemConfig','ltmJob','extendObjectAsync','analysis.alertReason','pop','N/A','152118bvebKa','\x20events)...','Last\x20raw\x20event','native','Error\x20in\x20onMessage\x20command\x20','search','channel','from','Started\x20at\x20','sleepScore','ðŸ“¡\x20Hooking\x20into\x20','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','info.','submitFeedback','briefingTime','lights','forEach','KI-Modell\x20nicht\x20initialisiert','Aktiv\x20(','catch','genAI','ical.0','node-schedule','Comfort\x20Suggestion','prÃ¤senz','cogni-living\x20adapter\x20starting\x20(v','namespace','Raw\x20Log','instance','\x0aSTB:\x20','selectedFunctionIds','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','aiPersona','TEST-PRO-KEY','sensorLastValues','includes','[TEST]\x20','find','Wetter:\x20Deaktiviert','sendTo','json','admin.','No\x20instance','Normal','simple-api.','90HIzXsi','button','getCalendarNames\x20Error:\x20','custom','setStateAsync','events.lastEvent','No\x20module\x20named','debug','Restlessness\x20Level','system.mode','analysis.automation','getForeignObjectAsync','now','testNotification','1339886FvIisa','text','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','bind','Deaktiviert\x20(Pro-Feature)','unreach','Logbook','events.history','isProVersion','thermostat','Who\x20is\x20present?','Error\x20reading\x20calendar\x20table:\x20','Health\x20&\x20Sleep\x20Analysis','unload','filter','.\x20OUTPUT:\x20Nur\x20Text.','VACATION','Sleep\x20Score\x20(0-100)','openweathermap.0','ltmLtbWindowDays','heizung','notifyEmailRecipient','maintenance','getCalendarNames','KALENDER:\x20Keine\x20relevanten\x20Termine','tÃ¼r','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','dependencyInstallInProgress','0\x204\x20*\x20*\x20*','direction','ðŸ\x20Stopping\x20Python\x20Sidecar...','analysis.triggerBriefing','559131Oslnqs','date','briefingJob','notifyPushoverRecipient','bewegung','actual_temperature','@google/generative-ai','sort','boolean','startsWith','onMessage','dailyDigests','klima','@iobroker/adapter-core','LTM\x20Sched\x20Error:\x20','status','detected','uuid-not-found','delObjectAsync','events.history_debug_00','WETTER:\x20','Last\x20Result','analysis.lastResult','AI\x20Emergency\x20Status','PRO-','lampe','log','System\x20Mode','ack','weatherInstance','onReady','Party','schalter','stringify','party','automationProposal','\x22\x20--break-system-packages','stderr','splice','notifyTelegramRecipient','WETTER:\x20Keine\x20Daten\x20gefunden','analysis.automation.targetValue','retry','systemUUID','modeResetJob','pythonProcess','Lernphase\x20(','âœ…\x20Alles\x20OK\x20(Reset)','.NextHours.Location_1.Day_1.current.symbol_desc','enum','sensor','Pattern\x20Detected','targetposition','type','Trigger\x20Analysis','PRIORITÃ„T:\x20Sicherheit.','warn','getHours','ltmStbWindowDays','openweathermap','getLtmData','getEnums','unshift','LTM','Drift\x20Details','\x20for\x20interactive\x20buttons...','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','LTM.driftAnalysis','trim','notifyPushoverInstance','analysis.health.restlessness','system.config','eventHistory','analysis.isAlert','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','isArray','Trigger\x20Briefing\x20(Test)','setpoint','echarts.','val','data','main','\x20=\x20','Keiner','python_service','Details:\x20','analysis.automation.triggerAction','number','Target\x20ID','analysis.comfortSummary','name','Auto\x20Apply\x20Rule','_calName','onStateChange','value.health','geminiApiKey','value','LTM.driftAnalysis.driftDetails','isAlert','analysisTimer','PRIORITÃ„T:\x20Gesundheit/AAL.','Description','city','rawEventLog','exitTimer','isExit','AI\x20Alert\x20Status','normal','analysis.history_debug_00','16SzancA','longitude','sendToAsync','Alarm','message','Error\x20checking\x20WiFi:\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','\x20*\x20*\x20*','fault','KALENDER:\x20','Bibliotheken\x20nicht\x20gefunden','analysis.automation.description','System\x20Status\x20&\x20Control','currentSystemMode','8302HOHwOg','string','ltmDriftCheckIntervalHours','lastAlertState','history.','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','logDuplicates','licht','location','analysis.health','constructor','level','python3','stateChange','energy','onUnload','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','\x20presence\x20devices...','Alert\x20Reason','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','Fokus\x20auf\x20Familienroutinen.','_score','getForeignStateAsync','LTM.dailyDigests','error','enum.rooms.*','283134yFJBfV','window','scanDevices','\x20events','\x20(Value:\x20','toString','door','useCalendar','presenceDevices','5479903RclRSO','calendarSelection','LTM.processingStatus','Morning\x20Briefing\x20sent.','reachable','\x20sensors...','Briefing\x20Sched\x20Error:\x20','driftAnalysisTimer','map','notifyTelegramEnabled','.\x0a\x20\x20\x20\x20KONTEXT:\x20','text.alarm','Action','baselineDrift','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','siren','.\x20DATEN:\x20Schlaf\x20','working','fenster','Drift\x20Status','analysis.analysisHistory','none','isPresent','COGNI_REQUEST_CALL','Baseline\x20Status','setObjectNotExistsAsync','toFixed','Target\x20Value','analysis.automation.patternDetected','occupancy','split','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','ready','light','LTM.baselineStatus','getTime','parse','Gast','analysis.automation.suggestedAction','system.meta.uuid','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','PARTY','analysisInterval','enum.functions.*','path','exitGraceTimer','uuid','description','KALENDER\x20ERROR:\x20','guest','briefingEnabled','752wYsjYn','\x20min).','NORMAL','Gemini\x20Analysis\x20Error:\x20','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','Subscribing\x20to\x20','Error:\x20','some','Missing\x20data','activityLevel','LTM.triggerDailyDigest','useWeather','generateContent','(((.+)+)+)+$','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','system.presenceWho','join','58145ckENSY','Sending\x20notification:\x20\x22','analysis.comfortSuggestion','ðŸš¨\x20EMERGENCY','.\x20KONTEXT:\x20','update','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','setState','Trigger\x20Action\x20Now','shutter','values','indicator.alarm','inactivityThresholdHours','analysisHistory','dimmer','replace','connection','event','motion','common','expire','Starting\x20Autopilot\x20(','Daily\x20Digests','270hMjwKM','toLocaleString','length','simulateButler','time','triggerBriefing','KALENDER:\x20Keine\x20Daten','online','generic','Adapter','analysis.automation.autoApply','Drift\x20Analysis','flot.','COGNI_CONFIRM_OK','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','send','lastIndexOf','Restoring\x20sensor\x20cache\x20from\x20history\x20(','Automation\x20Proposals','Analysiere\x20ausgewogen.','members','Success:\x20Compressed\x20','setHours','uuid-error','getFullYear'];a0_0x208e=function(){return _0x5bca16;};return a0_0x208e();}(function(_0x53fb64,_0x523757){const _0x5ecff6=a0_0x2ebd,_0x4edff8=_0x53fb64();while(!![]){try{const _0x363931=-parseInt(_0x5ecff6(0x1df))/0x1+parseInt(_0x5ecff6(0x12a))/0x2+-parseInt(_0x5ecff6(0x14a))/0x3*(-parseInt(_0x5ecff6(0x1b7))/0x4)+parseInt(_0x5ecff6(0x22c))/0x5*(-parseInt(_0x5ecff6(0x243))/0x6)+-parseInt(_0x5ecff6(0x1c5))/0x7*(-parseInt(_0x5ecff6(0x21b))/0x8)+-parseInt(_0x5ecff6(0xec))/0x9*(-parseInt(_0x5ecff6(0x11c))/0xa)+-parseInt(_0x5ecff6(0x1e8))/0xb;if(_0x363931===_0x523757)break;else _0x4edff8['push'](_0x4edff8['shift']());}catch(_0x9149e3){_0x4edff8['push'](_0x4edff8['shift']());}}}(a0_0x208e,0x5b6a9));const a0_0x2bf61d=(function(){let _0x4f2655=!![];return function(_0x5680b1,_0x371080){const _0x409b00=_0x4f2655?function(){const _0x1e5138=a0_0x2ebd;if(_0x371080){const _0x38c3e1=_0x371080[_0x1e5138(0xcb)](_0x5680b1,arguments);return _0x371080=null,_0x38c3e1;}}:function(){};return _0x4f2655=![],_0x409b00;};}()),a0_0x167c25=a0_0x2bf61d(this,function(){const _0x43663b=a0_0x2ebd;return a0_0x167c25[_0x43663b(0x1e4)]()['search'](_0x43663b(0x228))[_0x43663b(0x1e4)]()[_0x43663b(0x1cf)](a0_0x167c25)[_0x43663b(0xf1)](_0x43663b(0x228));});a0_0x167c25();'use strict';const utils=require(a0_0x5c7278(0x157)),{GoogleGenerativeAI}=require(a0_0x5c7278(0x150)),schedule=require(a0_0x5c7278(0x104)),{spawn,exec}=require('child_process'),path=require(a0_0x5c7278(0x214)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x5c7278(0xbc),MODE_RESET_SCHEDULE=a0_0x5c7278(0x146),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x5c7278(0xd9),LTM_DP_DAILY_DIGESTS=a0_0x5c7278(0x1dc),LTM_DP_STATUS=a0_0x5c7278(0x1ea),LTM_DP_TRIGGER_DIGEST=a0_0x5c7278(0x225),LTM_DP_BASELINE_STATUS=a0_0x5c7278(0x20a),LTM_DP_DRIFT_CHANNEL=a0_0x5c7278(0x18d),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x5c7278(0x1ab),LTM_DP_DRIFT_LAST_CHECK=a0_0x5c7278(0xc2),SYSTEM_DP_MODE=a0_0x5c7278(0x125),HARD_IGNORE_TERMS=['scriptProblem','scriptEnabled',a0_0x5c7278(0x231),a0_0x5c7278(0x12f),a0_0x5c7278(0x27c),a0_0x5c7278(0xd1),a0_0x5c7278(0x23c),a0_0x5c7278(0x140),a0_0x5c7278(0x1dd),a0_0x5c7278(0x1bf),a0_0x5c7278(0x1f9),a0_0x5c7278(0x147),a0_0x5c7278(0x261),a0_0x5c7278(0xbf),a0_0x5c7278(0xd3),a0_0x5c7278(0xcd),a0_0x5c7278(0x1ec),'link_quality'],BAD_NAMES=[a0_0x5c7278(0x17e),'currentposition',a0_0x5c7278(0xdf),a0_0x5c7278(0x1d0),a0_0x5c7278(0x1aa),a0_0x5c7278(0xc8),'on','off',a0_0x5c7278(0xbd),'position',a0_0x5c7278(0x235),a0_0x5c7278(0xce),a0_0x5c7278(0x279),a0_0x5c7278(0x159),a0_0x5c7278(0x23e),'presence',a0_0x5c7278(0x205),a0_0x5c7278(0xe5),a0_0x5c7278(0xc7),'power',a0_0x5c7278(0x1d3),a0_0x5c7278(0x197),a0_0x5c7278(0x267),a0_0x5c7278(0x14f),'set_temperature'],ADAPTER_BLACKLIST=['system.',a0_0x5c7278(0x118),a0_0x5c7278(0xfa),'vis.',a0_0x5c7278(0x1c9),'material.','icons-mfd.',a0_0x5c7278(0x24f),a0_0x5c7278(0x198),a0_0x5c7278(0x270),a0_0x5c7278(0x11b)],SYSTEM_MODES={'NORMAL':a0_0x5c7278(0x1b5),'VACATION':'vacation','PARTY':a0_0x5c7278(0x16c),'GUEST':a0_0x5c7278(0x219)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x5c7278(0x256),'senior_aal':a0_0x5c7278(0x1ae),'family':a0_0x5c7278(0x1d9),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x5c7278(0x181)};async function initZombies(_0x118867){const _0x1a9390=a0_0x5c7278;try{const _0x589591=[_0x1a9390(0x1b6),_0x1a9390(0x15d)];for(const _0x26cf9e of _0x589591){try{const _0x5ef181=await _0x118867['getObjectAsync'](_0x26cf9e);_0x5ef181&&await _0x118867[_0x1a9390(0x15c)](_0x26cf9e);}catch(_0x46a4c7){}}}catch(_0x48c095){}}async function initHistory(_0x1420c3){const _0x33ea5e=a0_0x5c7278;try{const _0x1b469b=await _0x1420c3[_0x33ea5e(0xd2)](_0x33ea5e(0x131));_0x1b469b&&_0x1b469b[_0x33ea5e(0x199)]&&(_0x1420c3['eventHistory']=JSON['parse'](_0x1b469b[_0x33ea5e(0x199)][_0x33ea5e(0x1e4)]()));}catch(_0x1e7f36){_0x1420c3[_0x33ea5e(0x192)]=[];}try{const _0x530acb=await _0x1420c3['getStateAsync'](_0x33ea5e(0x1fc));if(_0x530acb&&_0x530acb[_0x33ea5e(0x199)])_0x1420c3[_0x33ea5e(0x239)]=JSON[_0x33ea5e(0x20c)](_0x530acb[_0x33ea5e(0x199)][_0x33ea5e(0x1e4)]());}catch(_0x5dda49){_0x1420c3['analysisHistory']=[];}if(_0x1420c3[_0x33ea5e(0x192)]&&_0x1420c3['eventHistory'][_0x33ea5e(0x245)]>0x0){_0x1420c3['log'][_0x33ea5e(0x277)](_0x33ea5e(0x254)+_0x1420c3[_0x33ea5e(0x192)]['length']+_0x33ea5e(0xed));for(let _0x510ac1=_0x1420c3['eventHistory'][_0x33ea5e(0x245)]-0x1;_0x510ac1>=0x0;_0x510ac1--){const _0x39b41a=_0x1420c3['eventHistory'][_0x510ac1];_0x39b41a&&_0x39b41a['id']!==undefined&&_0x39b41a[_0x33ea5e(0x1aa)]!==undefined&&(_0x1420c3[_0x33ea5e(0x111)][_0x39b41a['id']]=_0x39b41a['value']);}}}async function initSystemConfig(_0x34c9f2){const _0x119e7a=a0_0x5c7278;try{const _0x2cc2a5=await _0x34c9f2[_0x119e7a(0x127)](_0x119e7a(0x191));_0x2cc2a5&&_0x2cc2a5[_0x119e7a(0x23f)]&&(_0x34c9f2['systemConfig']={'latitude':_0x2cc2a5[_0x119e7a(0x23f)]['latitude']||0x0,'longitude':_0x2cc2a5[_0x119e7a(0x23f)][_0x119e7a(0x1b8)]||0x0,'city':_0x2cc2a5[_0x119e7a(0x23f)][_0x119e7a(0x1b0)]||''});}catch(_0x548330){}}async function checkLicense(_0x3efb69,_0x37ab14){const _0x500f71=a0_0x5c7278;if(!_0x37ab14)return![];_0x3efb69[_0x500f71(0x175)]=await getSystemUUID(_0x3efb69);if(_0x37ab14===_0x500f71(0x110)||_0x37ab14[_0x500f71(0x153)](_0x500f71(0x162)))return!![];return![];}async function getSystemUUID(_0x492267){const _0x18ce1c=a0_0x5c7278;try{const _0x3d2be4=await _0x492267[_0x18ce1c(0x127)](_0x18ce1c(0x20f));if(_0x3d2be4&&_0x3d2be4[_0x18ce1c(0xef)]&&_0x3d2be4[_0x18ce1c(0xef)][_0x18ce1c(0x216)])return _0x3d2be4['native'][_0x18ce1c(0x216)];return _0x18ce1c(0x15b);}catch(_0x266e33){return _0x18ce1c(0x25a);}}async function createAllObjects(_0x3fa59b){const _0x487c67=a0_0x5c7278;await checkSystemObjects(_0x3fa59b),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x22a),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x134),'type':_0x487c67(0x1c6),'role':_0x487c67(0x12b),'read':!![],'write':![],'def':''},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x121),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0xee),'type':_0x487c67(0x1c6),'role':_0x487c67(0x117),'read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)]('events.history',{'type':'state','common':{'name':_0x487c67(0x262),'type':_0x487c67(0x1c6),'role':_0x487c67(0x117),'read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0xb9),{'type':'state','common':{'name':_0x487c67(0x180),'type':_0x487c67(0x152),'role':_0x487c67(0x11d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x149),{'type':'state','common':{'name':_0x487c67(0x196),'type':_0x487c67(0x152),'role':_0x487c67(0x11d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x160),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x15f),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x3fa59b['setObjectNotExistsAsync']('analysis.isAlert',{'type':'state','common':{'name':_0x487c67(0x1b4),'type':_0x487c67(0x152),'role':_0x487c67(0x237),'read':!![],'write':![],'def':![]},'native':{}}),await _0x3fa59b['setObjectNotExistsAsync'](_0x487c67(0x26b),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x161),'type':_0x487c67(0x152),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0xe9),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x1d7),'type':'string','role':_0x487c67(0x1f3),'read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)]('analysis.activitySummary',{'type':_0x487c67(0xdf),'common':{'name':'Activity\x20Summary','type':_0x487c67(0x1c6),'role':_0x487c67(0x12b),'read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)]('analysis.deviationFromBaseline',{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x278),'type':_0x487c67(0x1c6),'role':_0x487c67(0xdf),'read':!![],'write':![],'def':_0x487c67(0xeb)},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x1a3),{'type':_0x487c67(0xdf),'common':{'name':'Comfort\x20Summary','type':_0x487c67(0x1c6),'role':_0x487c67(0x12b),'read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x22e),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x105),'type':_0x487c67(0x1c6),'role':'text','read':!![],'write':![]},'native':{}}),await _0x3fa59b['extendObjectAsync'](_0x487c67(0x126),{'type':'channel','common':{'name':_0x487c67(0x255)},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x204),{'type':'state','common':{'name':_0x487c67(0x17d),'type':_0x487c67(0x152),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x1c2),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x1af),'type':_0x487c67(0x1c6),'role':_0x487c67(0x12b),'read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x20e),{'type':'state','common':{'name':_0x487c67(0x1f4),'type':_0x487c67(0x1c6),'role':'text','read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0xc6),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x1a2),'type':_0x487c67(0x1c6),'role':_0x487c67(0x12b),'read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)]('analysis.automation.targetValue',{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x203),'type':'string','role':_0x487c67(0x12b),'read':!![],'write':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x24d),{'type':'state','common':{'name':_0x487c67(0x1a5),'type':_0x487c67(0x152),'role':_0x487c67(0xbd),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x1a0),{'type':'state','common':{'name':_0x487c67(0x234),'type':'boolean','role':_0x487c67(0x11d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3fa59b[_0x487c67(0x201)](_0x487c67(0x1fc),{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x130),'type':_0x487c67(0x1c6),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x3fa59b['setObjectNotExistsAsync']('analysis.feedbackHistory',{'type':'state','common':{'name':'Feedback\x20Log','type':_0x487c67(0x1c6),'role':_0x487c67(0x117),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x3fa59b['extendObjectAsync'](_0x487c67(0x1ce),{'type':_0x487c67(0xf2),'common':{'name':_0x487c67(0x136)},'native':{}}),await _0x3fa59b['setObjectNotExistsAsync']('analysis.health.sleepScore',{'type':_0x487c67(0xdf),'common':{'name':_0x487c67(0x13b),'type':'number','role':_0x487c67(0x1a8),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x3fa59b['setObjectNotExistsAsync'](_0x487c67(0x190),{'type':'state','common':{'name':_0x487c67(0x124),'type':_0x487c67(0x1c6),'role':'text','read':!![],'write':![],'def':_0x487c67(0x1fd)},'native':{}}),await _0x3fa59b['setObjectNotExistsAsync']('analysis.health.notes',{'type':_0x487c67(0xdf),'common':{'name':'Health\x20Notes','type':'string','role':_0x487c67(0x12b),'read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x3fa59b),await checkLtmDriftObjects(_0x3fa59b);}async function checkSystemObjects(_0x774cee){const _0x208553=a0_0x5c7278;await _0x774cee[_0x208553(0xe8)]('system',{'type':_0x208553(0xf2),'common':{'name':_0x208553(0x1c3)},'native':{}}),await _0x774cee[_0x208553(0xe8)](SYSTEM_DP_MODE,{'type':_0x208553(0xdf),'common':{'name':_0x208553(0x165),'type':_0x208553(0x1c6),'role':_0x208553(0xdf),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x208553(0x21d)]]:_0x208553(0x11a),[SYSTEM_MODES[_0x208553(0x13a)]]:'Urlaub',[SYSTEM_MODES[_0x208553(0x211)]]:_0x208553(0x169),[SYSTEM_MODES[_0x208553(0xd7)]]:_0x208553(0x20d)}},'native':{}});}async function checkLtmObjects(_0x4c26b7){const _0x1ebfb8=a0_0x5c7278;await _0x4c26b7[_0x1ebfb8(0xe8)](_0x1ebfb8(0x189),{'type':_0x1ebfb8(0xf2),'common':{'name':_0x1ebfb8(0x189)},'native':{}}),await _0x4c26b7[_0x1ebfb8(0xe8)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x1ebfb8(0x109),'type':_0x1ebfb8(0x1c6),'role':_0x1ebfb8(0x117),'read':!![],'write':![]},'native':{}}),await _0x4c26b7[_0x1ebfb8(0xe8)](LTM_DP_DAILY_DIGESTS,{'type':_0x1ebfb8(0xdf),'common':{'name':_0x1ebfb8(0x242),'type':_0x1ebfb8(0x1c6),'role':_0x1ebfb8(0x117),'read':!![],'write':![]},'native':{}}),await _0x4c26b7['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x1ebfb8(0xdf),'common':{'name':_0x1ebfb8(0x260),'type':_0x1ebfb8(0x1c6),'role':_0x1ebfb8(0x12b),'read':!![],'write':![]},'native':{}}),await _0x4c26b7[_0x1ebfb8(0xe8)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':'Trigger\x20Digest','type':'boolean','role':_0x1ebfb8(0x11d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4c26b7['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x1ebfb8(0xdf),'common':{'name':_0x1ebfb8(0x200),'type':_0x1ebfb8(0x1c6),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x5c5efb){const _0x1a179f=a0_0x5c7278;await _0x5c5efb[_0x1a179f(0xe8)](LTM_DP_DRIFT_CHANNEL,{'type':_0x1a179f(0xf2),'common':{'name':_0x1a179f(0x24e)},'native':{}}),await _0x5c5efb[_0x1a179f(0xe8)](LTM_DP_DRIFT_STATUS,{'type':_0x1a179f(0xdf),'common':{'name':_0x1a179f(0x1fb),'type':_0x1a179f(0x1c6),'role':_0x1a179f(0xdf),'read':!![],'write':![],'def':_0x1a179f(0xeb)},'native':{}}),await _0x5c5efb[_0x1a179f(0xe8)](LTM_DP_DRIFT_DETAILS,{'type':_0x1a179f(0xdf),'common':{'name':_0x1a179f(0x18a),'type':_0x1a179f(0x1c6),'role':_0x1a179f(0x12b),'read':!![],'write':![]},'native':{}}),await _0x5c5efb[_0x1a179f(0xe8)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x1a179f(0xdf),'common':{'name':'Last\x20Check','type':_0x1a179f(0x1a1),'role':_0x1a179f(0x14b),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x54198f){const _0x256752=a0_0x5c7278;try{const _0x51fd62=await _0x54198f[_0x256752(0xd2)](SYSTEM_DP_MODE);_0x51fd62&&_0x51fd62[_0x256752(0x199)]&&Object[_0x256752(0x236)](SYSTEM_MODES)[_0x256752(0x112)](_0x51fd62[_0x256752(0x199)])?_0x54198f[_0x256752(0x1c4)]=_0x51fd62[_0x256752(0x199)]:(_0x54198f['currentSystemMode']=SYSTEM_MODES[_0x256752(0x21d)],await _0x54198f[_0x256752(0x120)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x256752(0x21d)],'ack':!![]}));}catch(_0x420226){_0x54198f['currentSystemMode']=SYSTEM_MODES[_0x256752(0x21d)];}}async function loadRawEventLog(_0x319ff4){const _0x29dbc6=a0_0x5c7278;try{const _0xb1ec0a=await _0x319ff4[_0x29dbc6(0xd2)](LTM_DP_RAW_LOG);if(_0xb1ec0a&&_0xb1ec0a[_0x29dbc6(0x199)])_0x319ff4['rawEventLog']=JSON[_0x29dbc6(0x20c)](_0xb1ec0a[_0x29dbc6(0x199)]);}catch(_0x217fe7){_0x319ff4[_0x29dbc6(0x1b1)]=[];}}async function saveRawEventLog(_0xe81fe7){const _0xfd0ac5=a0_0x5c7278;_0xe81fe7[_0xfd0ac5(0x1b1)][_0xfd0ac5(0x245)]>RAW_LOG_MAX_SIZE&&_0xe81fe7[_0xfd0ac5(0x1b1)][_0xfd0ac5(0x170)](0x0,_0xe81fe7['rawEventLog'][_0xfd0ac5(0x245)]-RAW_LOG_MAX_SIZE),await _0xe81fe7[_0xfd0ac5(0x120)](LTM_DP_RAW_LOG,{'val':JSON[_0xfd0ac5(0x16b)](_0xe81fe7[_0xfd0ac5(0x1b1)]),'ack':!![]});}function a0_0x2ebd(_0x550bf2,_0x19f6b4){const _0x221a99=a0_0x208e();return a0_0x2ebd=function(_0x167c25,_0x2bf61d){_0x167c25=_0x167c25-0xb3;let _0x208e84=_0x221a99[_0x167c25];return _0x208e84;},a0_0x2ebd(_0x550bf2,_0x19f6b4);}async function loadDailyDigests(_0x2f5a1){const _0x29b662=a0_0x5c7278;try{const _0x4709ce=await _0x2f5a1['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x4709ce&&_0x4709ce[_0x29b662(0x199)])_0x2f5a1[_0x29b662(0x155)]=JSON[_0x29b662(0x20c)](_0x4709ce['val']);}catch(_0x4b6b08){_0x2f5a1['dailyDigests']=[];}await updateBaselineStatus(_0x2f5a1);}async function saveDailyDigests(_0x26a8f2,_0x5c14c3=!![]){const _0xeff3bd=a0_0x5c7278,_0x486725=_0x26a8f2[_0xeff3bd(0xda)][_0xeff3bd(0x13d)]||0x3c;_0x26a8f2[_0xeff3bd(0x155)][_0xeff3bd(0x245)]>_0x486725&&_0x26a8f2[_0xeff3bd(0x155)]['splice'](0x0,_0x26a8f2[_0xeff3bd(0x155)][_0xeff3bd(0x245)]-_0x486725);await _0x26a8f2[_0xeff3bd(0x120)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0xeff3bd(0x16b)](_0x26a8f2[_0xeff3bd(0x155)]),'ack':!![]});if(_0x5c14c3)await updateBaselineStatus(_0x26a8f2);}async function updateAnalysisHistory(_0x4f231f,_0x4ec53a){const _0x280048=a0_0x5c7278;_0x4f231f[_0x280048(0x239)][_0x280048(0x188)](_0x4ec53a);if(_0x4f231f[_0x280048(0x239)][_0x280048(0x245)]>ANALYSIS_HISTORY_MAX_SIZE)_0x4f231f['analysisHistory'][_0x280048(0xea)]();await _0x4f231f['setStateAsync'](_0x280048(0x1fc),{'val':JSON[_0x280048(0x16b)](_0x4f231f['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x44e1){const _0xb31433=a0_0x5c7278;if(!_0x44e1[_0xb31433(0x132)]){await _0x44e1[_0xb31433(0x120)](LTM_DP_BASELINE_STATUS,{'val':_0xb31433(0x12e),'ack':!![]});return;}const _0x31974a=_0x44e1[_0xb31433(0x155)][_0xb31433(0x245)]>=(_0x44e1[_0xb31433(0xda)][_0xb31433(0x271)]||0x7)?_0xb31433(0x100)+_0x44e1[_0xb31433(0x155)][_0xb31433(0x245)]+'\x20Tage)':_0xb31433(0x178)+_0x44e1[_0xb31433(0x155)][_0xb31433(0x245)]+'/'+(_0x44e1[_0xb31433(0xda)]['minDaysForBaseline']||0x7)+')';await _0x44e1[_0xb31433(0x120)](LTM_DP_BASELINE_STATUS,{'val':_0x31974a,'ack':!![]});}async function initSensorSubscriptions(_0x5ca63e){const _0x4b979d=a0_0x5c7278,_0x7419f3=_0x5ca63e[_0x4b979d(0xda)]['devices'];if(_0x7419f3&&_0x7419f3[_0x4b979d(0x245)]>0x0){_0x5ca63e[_0x4b979d(0x164)][_0x4b979d(0x277)](_0x4b979d(0x220)+_0x7419f3[_0x4b979d(0x245)]+_0x4b979d(0x1ed));for(const _0x1b3c3f of _0x7419f3){if(_0x1b3c3f['id']){await _0x5ca63e['subscribeForeignStatesAsync'](_0x1b3c3f['id']);try{const _0x7939a0=await _0x5ca63e[_0x4b979d(0x1db)](_0x1b3c3f['id']);if(_0x7939a0)_0x5ca63e[_0x4b979d(0x111)][_0x1b3c3f['id']]=_0x7939a0[_0x4b979d(0x199)];}catch(_0x59d9a1){}}}}}async function initPresenceSubscriptions(_0x3cee08){const _0x468485=a0_0x5c7278,_0x1c4c4d=_0x3cee08['config'][_0x468485(0x1e7)]||[];if(_0x1c4c4d[_0x468485(0x245)]>0x0){_0x3cee08[_0x468485(0x164)][_0x468485(0x277)](_0x468485(0x220)+_0x1c4c4d[_0x468485(0x245)]+_0x468485(0x1d6));for(const _0x2d5d7a of _0x1c4c4d){await _0x3cee08['subscribeForeignStatesAsync'](_0x2d5d7a);}try{await checkWifiPresence(_0x3cee08);}catch(_0x13c73f){}}}async function getWeatherContext(_0x4ff192){const _0x3b1415=a0_0x5c7278;try{if(!_0x4ff192['config'][_0x3b1415(0x226)])return _0x3b1415(0x115);let _0x2a12e4='';const _0x1817f3=_0x4ff192['config'][_0x3b1415(0x167)];if(_0x1817f3)try{if(_0x1817f3[_0x3b1415(0x112)](_0x3b1415(0xdc))){const _0x4b20f1=await _0x4ff192['getForeignStateAsync'](_0x1817f3+'.Summary.Current');if(_0x4b20f1&&_0x4b20f1[_0x3b1415(0x199)])_0x2a12e4=_0x4b20f1['val'];}else{if(_0x1817f3['includes']('daswetter')){const _0x2f4bcd=await _0x4ff192['getForeignStateAsync'](_0x1817f3+_0x3b1415(0x17a));if(_0x2f4bcd&&_0x2f4bcd['val'])_0x2a12e4=_0x2f4bcd[_0x3b1415(0x199)];}else{if(_0x1817f3[_0x3b1415(0x112)](_0x3b1415(0x185))){const _0x605189=await _0x4ff192[_0x3b1415(0x1db)](_0x1817f3+'.forecast.current.state');if(_0x605189&&_0x605189[_0x3b1415(0x199)])_0x2a12e4=_0x605189['val'];}}}}catch(_0x8dc80c){}if(!_0x2a12e4){const _0x575962=[_0x3b1415(0xba),'daswetter.0',_0x3b1415(0xdd),_0x3b1415(0x13c)];for(const _0x2394db of _0x575962){try{const _0x4f9305=await _0x4ff192[_0x3b1415(0x127)](_0x2394db);if(_0x4f9305){if(_0x2394db[_0x3b1415(0x112)](_0x3b1415(0xdc))){const _0x35b7c7=await _0x4ff192[_0x3b1415(0x1db)](_0x2394db+'.Summary.Current');if(_0x35b7c7&&_0x35b7c7[_0x3b1415(0x199)]){_0x2a12e4=_0x35b7c7[_0x3b1415(0x199)];break;}}}}catch(_0x16df9e){}}}return _0x2a12e4?_0x3b1415(0x15e)+_0x2a12e4:_0x3b1415(0x172);}catch(_0x7e57ba){return _0x3b1415(0x25f)+_0x7e57ba['message'];}}async function getCalendarContext(_0x558f96){const _0x4d9e16=a0_0x5c7278;try{if(!_0x558f96[_0x4d9e16(0xda)][_0x4d9e16(0x1e6)])return'Kalender:\x20Deaktiviert';let _0xc50e6b=_0x558f96[_0x4d9e16(0xda)]['calendarInstance']||_0x4d9e16(0x103),_0x1aa5e3=_0x558f96[_0x4d9e16(0xda)][_0x4d9e16(0x1e9)]||[];if(typeof _0x1aa5e3==='string')_0x1aa5e3=_0x1aa5e3[_0x4d9e16(0x206)](',');try{const _0x1374dd=await _0x558f96['getForeignStateAsync'](_0xc50e6b+_0x4d9e16(0xcf));if(_0x1374dd&&_0x1374dd[_0x4d9e16(0x199)]){let _0x2d649d=tryParse(_0x1374dd[_0x4d9e16(0x199)]);if(_0x2d649d&&Array['isArray'](_0x2d649d)){if(_0x1aa5e3[_0x4d9e16(0x245)]>0x0)_0x2d649d=_0x2d649d[_0x4d9e16(0x138)](_0x3a91aa=>_0x1aa5e3[_0x4d9e16(0x112)](_0x3a91aa[_0x4d9e16(0x1a6)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x2d649d[_0x4d9e16(0x245)]>0x0){const _0x509c4a=_0x2d649d[_0x4d9e16(0x268)](0x0,0x3)[_0x4d9e16(0x1f0)](_0x52a8b6=>{const _0x8f9e69=_0x4d9e16;let _0x2affc1=_0x52a8b6['date'];if(_0x52a8b6[_0x8f9e69(0x247)])_0x2affc1+='\x20'+_0x52a8b6[_0x8f9e69(0x247)];return _0x2affc1+':\x20'+_0x52a8b6[_0x8f9e69(0x23d)]+'\x20('+_0x52a8b6[_0x8f9e69(0x1a6)]+')';});return _0x4d9e16(0x1c0)+_0x509c4a[_0x4d9e16(0x22b)]('\x20|\x20');}else return _0x4d9e16(0x142);}}}catch(_0x5ce322){_0x558f96[_0x4d9e16(0x164)][_0x4d9e16(0x182)](_0x4d9e16(0x135)+_0x5ce322['message']);}return _0x4d9e16(0x249);}catch(_0x522dae){return _0x4d9e16(0x218)+_0x522dae['message'];}}async function getCalendarNames(_0x38e9f5,_0x17961e){const _0x2cce1c=a0_0x5c7278;try{const _0x53a256=await _0x38e9f5['getForeignStateAsync'](_0x17961e+_0x2cce1c(0xcf));if(_0x53a256&&_0x53a256[_0x2cce1c(0x199)]){const _0x206166=tryParse(_0x53a256['val']);if(_0x206166&&Array[_0x2cce1c(0x195)](_0x206166)){const _0x54a040=[...new Set(_0x206166[_0x2cce1c(0x1f0)](_0x202877=>_0x202877[_0x2cce1c(0x1a6)])[_0x2cce1c(0x138)](Boolean))];return _0x54a040[_0x2cce1c(0x151)]();}}return[];}catch(_0x5483bb){return _0x38e9f5[_0x2cce1c(0x164)][_0x2cce1c(0x1dd)](_0x2cce1c(0x11e)+_0x5483bb[_0x2cce1c(0x1bb)]),[];}}async function checkWifiPresence(_0x426b9c){const _0x5dbf67=a0_0x5c7278;try{const _0x48baf4=_0x426b9c[_0x5dbf67(0xda)][_0x5dbf67(0x1e7)]||[];let _0x48af73=![];const _0x22f22a=[];for(const _0x378b24 of _0x48baf4){try{const _0x4cc3c2=await _0x426b9c[_0x5dbf67(0x1db)](_0x378b24);if(_0x4cc3c2&&(_0x4cc3c2[_0x5dbf67(0x199)]===!![]||_0x4cc3c2['val']===_0x5dbf67(0x24a)||_0x4cc3c2[_0x5dbf67(0x199)]===0x1)){_0x48af73=!![];const _0x29e29e=await _0x426b9c[_0x5dbf67(0x127)](_0x378b24);let _0x46c2df=_0x378b24;_0x29e29e&&_0x29e29e[_0x5dbf67(0x23f)]&&_0x29e29e[_0x5dbf67(0x23f)][_0x5dbf67(0x1a4)]&&(_0x46c2df=typeof _0x29e29e[_0x5dbf67(0x23f)]['name']===_0x5dbf67(0xd5)?_0x29e29e['common']['name']['de']||_0x29e29e['common'][_0x5dbf67(0x1a4)]['en']:_0x29e29e[_0x5dbf67(0x23f)][_0x5dbf67(0x1a4)]),_0x22f22a[_0x5dbf67(0x25e)](_0x46c2df);}}catch(_0x5d3463){}}return await _0x426b9c['setStateAsync'](_0x5dbf67(0x22a),{'val':_0x22f22a[_0x5dbf67(0x22b)](',\x20'),'ack':!![]}),_0x48af73&&(_0x426b9c[_0x5dbf67(0x1b2)]&&(_0x426b9c['log'][_0x5dbf67(0x277)](_0x5dbf67(0x1d5)),abortExitTimer(_0x426b9c)),!_0x426b9c[_0x5dbf67(0x1fe)]&&_0x426b9c[_0x5dbf67(0x1c4)]===SYSTEM_MODES[_0x5dbf67(0x21d)]&&await setPresence(_0x426b9c,!![])),_0x48af73;}catch(_0x4d68e9){return _0x426b9c[_0x5dbf67(0x164)][_0x5dbf67(0x1dd)](_0x5dbf67(0x1bc)+_0x4d68e9['message']),![];}}function startExitTimer(_0x4c4261){const _0x777d67=a0_0x5c7278;abortExitTimer(_0x4c4261),_0x4c4261[_0x777d67(0x26d)]=!![],_0x4c4261[_0x777d67(0x215)]=setTimeout(()=>{const _0x480014=_0x777d67;_0x4c4261[_0x480014(0x26d)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4c4261[_0x777d67(0x1b2)]=setTimeout(()=>{const _0x2a4a64=_0x777d67;setPresence(_0x4c4261,![]),_0x4c4261[_0x2a4a64(0x1b2)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x860c4c){const _0x1fd992=a0_0x5c7278;if(_0x860c4c['exitTimer'])clearTimeout(_0x860c4c['exitTimer']);if(_0x860c4c[_0x1fd992(0x215)])clearTimeout(_0x860c4c['exitGraceTimer']);_0x860c4c[_0x1fd992(0x1b2)]=null,_0x860c4c[_0x1fd992(0x215)]=null,_0x860c4c[_0x1fd992(0x26d)]=![];}async function setPresence(_0x4c93ef,_0xc4465f){const _0xd43499=a0_0x5c7278;if(_0x4c93ef['isPresent']===_0xc4465f)return;_0x4c93ef[_0xd43499(0x1fe)]=_0xc4465f,await _0x4c93ef[_0xd43499(0x120)](_0xd43499(0x27b),{'val':_0xc4465f,'ack':!![]});}async function saveFeedback(_0x10ef95,_0x116c77){const _0x4d5e91=a0_0x5c7278;_0x10ef95[_0x4d5e91(0x164)][_0x4d5e91(0x277)]('Feedback\x20saved:\x20'+JSON[_0x4d5e91(0x16b)](_0x116c77));}async function runBaselineDriftAnalysis(_0x4fee42){const _0x247968=a0_0x5c7278;if(!_0x4fee42['isProVersion']||!_0x4fee42[_0x247968(0x273)])return;const _0x262106=_0x4fee42[_0x247968(0xda)]['ltmStbWindowDays']||0xe;if(_0x4fee42['dailyDigests'][_0x247968(0x245)]<_0x262106+(_0x4fee42[_0x247968(0xda)][_0x247968(0x271)]||0x7)){await _0x4fee42[_0x247968(0x120)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x5ed8bb=_0x4fee42[_0x247968(0x155)]['slice'](-_0x262106),_0x29a3b4=_0x4fee42[_0x247968(0x155)][_0x247968(0x268)](0x0,_0x4fee42[_0x247968(0x155)][_0x247968(0x245)]-_0x262106),_0x19567e=_0x247968(0x229)+JSON['stringify'](_0x29a3b4)+_0x247968(0x10b)+JSON['stringify'](_0x5ed8bb);try{const _0x47bb13=await _0x4fee42[_0x247968(0x273)]['generateContent'](_0x19567e),_0x2b01f2=JSON['parse'](_0x47bb13[_0x247968(0xca)]['text']()[_0x247968(0x23b)](/```json|```/g,'')[_0x247968(0x18e)]());_0x2b01f2[_0x247968(0x1f5)]&&(await _0x4fee42[_0x247968(0x120)](LTM_DP_DRIFT_STATUS,{'val':_0x2b01f2[_0x247968(0x1f5)],'ack':!![]}),await _0x4fee42[_0x247968(0x120)](LTM_DP_DRIFT_DETAILS,{'val':_0x2b01f2['driftDetails'],'ack':!![]}),await _0x4fee42[_0x247968(0x120)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x497521){}}function setupLtmScheduler(_0x51292d){const _0x420a7e=a0_0x5c7278;try{if(_0x51292d['ltmJob'])_0x51292d['ltmJob'][_0x420a7e(0x275)]();if(!_0x51292d[_0x420a7e(0x132)]){_0x51292d[_0x420a7e(0x120)](LTM_DP_STATUS,{'val':_0x420a7e(0x12e),'ack':!![]});return;}_0x51292d[_0x420a7e(0xe7)]=schedule[_0x420a7e(0x266)](LTM_SCHEDULE,()=>createDailyDigest(_0x51292d));}catch(_0x5690f0){_0x51292d[_0x420a7e(0x164)][_0x420a7e(0x1dd)](_0x420a7e(0x158)+_0x5690f0[_0x420a7e(0x1bb)]);}}function setupModeResetScheduler(_0x3384c7){const _0x281534=a0_0x5c7278;try{if(_0x3384c7[_0x281534(0x176)])_0x3384c7[_0x281534(0x176)][_0x281534(0x275)]();_0x3384c7[_0x281534(0x176)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x18b4a5=_0x281534;await loadSystemMode(_0x3384c7),AUTO_RESET_MODES[_0x18b4a5(0x112)](_0x3384c7[_0x18b4a5(0x1c4)])&&await _0x3384c7[_0x18b4a5(0x120)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x1e9cb4){_0x3384c7[_0x281534(0x164)][_0x281534(0x1dd)]('Reset\x20Sched\x20Error:\x20'+_0x1e9cb4[_0x281534(0x1bb)]);}}function setupDriftAnalysisScheduler(_0x314b1c){const _0x3107c7=a0_0x5c7278;try{if(_0x314b1c[_0x3107c7(0x1ef)])clearInterval(_0x314b1c[_0x3107c7(0x1ef)]);if(!_0x314b1c[_0x3107c7(0x132)])return;_0x314b1c[_0x3107c7(0x1ef)]=setInterval(()=>runBaselineDriftAnalysis(_0x314b1c),(_0x314b1c['config'][_0x3107c7(0x1c7)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x314b1c),0x1388);}catch(_0x17702f){_0x314b1c[_0x3107c7(0x164)][_0x3107c7(0x1dd)]('Drift\x20Sched\x20Error:\x20'+_0x17702f[_0x3107c7(0x1bb)]);}}function setupBriefingScheduler(_0x411477){const _0x50b77b=a0_0x5c7278;try{if(_0x411477[_0x50b77b(0x14c)])_0x411477[_0x50b77b(0x14c)][_0x50b77b(0x275)]();if(!_0x411477['config'][_0x50b77b(0x21a)])return;const _0x483835=(_0x411477[_0x50b77b(0xda)][_0x50b77b(0xfc)]||'08:00')[_0x50b77b(0x206)](':'),_0x522874=parseInt(_0x483835[0x0])||0x8,_0xdca004=parseInt(_0x483835[0x1])||0x0,_0x2b81a7=_0xdca004+'\x20'+_0x522874+_0x50b77b(0x1be);_0x411477['log'][_0x50b77b(0x277)](_0x50b77b(0xb8)+_0x522874+':'+(_0xdca004<0xa?'0'+_0xdca004:_0xdca004)),_0x411477[_0x50b77b(0x14c)]=schedule[_0x50b77b(0x266)](_0x2b81a7,()=>{sendMorningBriefing(_0x411477);});}catch(_0x59631b){_0x411477['log'][_0x50b77b(0x1dd)](_0x50b77b(0x1ee)+_0x59631b[_0x50b77b(0x1bb)]);}}async function sendNotification(_0x57581,_0x266b22,_0x573770=![],_0x36211b=![]){const _0x261266=a0_0x5c7278;_0x57581[_0x261266(0x164)][_0x261266(0x277)]((_0x573770?_0x261266(0x113):'')+_0x261266(0x22d)+_0x266b22+'\x22');const _0x376cb9=_0x57581['config'];let _0x37b89c=0x0;if(_0x376cb9['notifyTelegramEnabled']){let _0x2fc068={};(_0x266b22[_0x261266(0x112)](_0x261266(0x1ba))||_0x36211b)&&(_0x2fc068={'reply_markup':{'inline_keyboard':[[{'text':_0x261266(0x179),'callback_data':_0x261266(0x250)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0x57581[_0x261266(0x1b9)](_0x376cb9[_0x261266(0xe2)],_0x261266(0x252),{'text':_0x266b22,'user':_0x376cb9[_0x261266(0x171)],..._0x2fc068}),_0x37b89c++;}if(_0x376cb9[_0x261266(0xb3)]){let _0x7be4ca={'message':_0x266b22,'title':_0x36211b?_0x261266(0x22f):'Cogni-Living','priority':_0x36211b?0x2:0x1,'device':_0x376cb9[_0x261266(0x14d)]};_0x36211b&&(_0x7be4ca[_0x261266(0x174)]=0x1e,_0x7be4ca[_0x261266(0x240)]=0xe10,_0x7be4ca[_0x261266(0xb5)]=_0x261266(0x1f7)),await _0x57581[_0x261266(0x1b9)](_0x376cb9[_0x261266(0x18f)],'send',_0x7be4ca),_0x37b89c++;}return _0x376cb9['notifyEmailEnabled']&&(await _0x57581['sendToAsync'](_0x376cb9['notifyEmailInstance'],_0x261266(0x252),{'text':_0x266b22,'to':_0x376cb9[_0x261266(0x13f)]}),_0x37b89c++),_0x37b89c;}async function setupTelegramListener(_0x447a05){const _0x42270b=a0_0x5c7278,_0x1430a4=_0x447a05[_0x42270b(0xda)]['notifyTelegramInstance'];_0x447a05[_0x42270b(0xda)][_0x42270b(0x1f1)]&&_0x1430a4&&(_0x447a05[_0x42270b(0x164)][_0x42270b(0x277)](_0x42270b(0xf6)+_0x1430a4+_0x42270b(0x18b)),await _0x447a05['subscribeForeignStatesAsync'](_0x1430a4+'.communicate.request'));}async function handleTelegramResponse(_0x4af9cc,_0x246e0a){const _0x1127b8=a0_0x5c7278;let _0x588ad8=_0x246e0a;_0x246e0a[_0x1127b8(0x153)]('[')&&(_0x588ad8=_0x246e0a[_0x1127b8(0xcc)](_0x246e0a['indexOf'](']')+0x1));if(_0x588ad8===_0x1127b8(0x250))_0x4af9cc['log'][_0x1127b8(0x277)](_0x1127b8(0x144)),await _0x4af9cc[_0x1127b8(0x120)](_0x1127b8(0x193),{'val':![],'ack':!![]}),await _0x4af9cc[_0x1127b8(0x120)](_0x1127b8(0xe9),{'val':_0x1127b8(0x12c),'ack':!![]}),_0x4af9cc[_0x1127b8(0x1c8)]=![],sendNotification(_0x4af9cc,_0x1127b8(0x1d8),![]);else _0x588ad8===_0x1127b8(0x1ff)&&(_0x4af9cc[_0x1127b8(0x164)][_0x1127b8(0x182)]('ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x4af9cc,_0x1127b8(0x1f6),![],!![]));}async function runAutopilot(_0x4bc6ef){const _0x7d11fa=a0_0x5c7278,_0x478a8e=_0x4bc6ef[_0x7d11fa(0xda)][_0x7d11fa(0x238)],_0x41d639=_0x4bc6ef['eventHistory']['length']>0x0?_0x4bc6ef[_0x7d11fa(0x192)][0x0][_0x7d11fa(0xd0)]:Date[_0x7d11fa(0x128)](),_0x4fc906=(Date['now']()-_0x41d639)/(0x3e8*0x3c*0x3c);let _0x1b5d8a='';_0x4bc6ef[_0x7d11fa(0xda)]['inactivityMonitoringEnabled']&&_0x4bc6ef[_0x7d11fa(0x1c4)]===SYSTEM_MODES[_0x7d11fa(0x21d)]&&_0x4bc6ef[_0x7d11fa(0x1fe)]&&(_0x4fc906>_0x478a8e&&(_0x1b5d8a='HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0x4fc906[_0x7d11fa(0x202)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0x4bc6ef,_0x1b5d8a)[_0x7d11fa(0x101)](_0x3b46d5=>_0x4bc6ef[_0x7d11fa(0x164)]['error'](_0x3b46d5));}async function createDailyDigest(_0x8ea3bd){const _0x5c518f=a0_0x5c7278;if(!_0x8ea3bd['isProVersion'])return;await _0x8ea3bd[_0x5c518f(0x120)](LTM_DP_STATUS,{'val':_0x5c518f(0xf4)+new Date()[_0x5c518f(0x244)](),'ack':!![]});if(!_0x8ea3bd['geminiModel']||_0x8ea3bd['rawEventLog'][_0x5c518f(0x245)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x8ea3bd['setStateAsync'](LTM_DP_STATUS,{'val':_0x5c518f(0xe3),'ack':!![]});return;}const _0x4e1a1f=JSON[_0x5c518f(0x20c)](JSON['stringify'](_0x8ea3bd[_0x5c518f(0x1b1)])),_0x3255d3=_0x4e1a1f[_0x5c518f(0x245)],_0x57166d=_0x5c518f(0x1bd)+JSON[_0x5c518f(0x16b)](_0x4e1a1f);try{const _0xa70573=await _0x8ea3bd[_0x5c518f(0x273)]['generateContent'](_0x57166d),_0x5dfa2d=JSON[_0x5c518f(0x20c)](_0xa70573[_0x5c518f(0xca)][_0x5c518f(0x12b)]()[_0x5c518f(0x23b)](/```json|```/g,'')[_0x5c518f(0x18e)]());_0x5dfa2d['summary']&&(_0x8ea3bd['dailyDigests'][_0x5c518f(0x25e)]({'timestamp':new Date()[_0x5c518f(0xb6)](),'eventCount':_0x3255d3,'summary':_0x5dfa2d['summary'],'activityLevel':_0x5dfa2d[_0x5c518f(0x224)],'systemMode':_0x8ea3bd[_0x5c518f(0x1c4)]}),await saveDailyDigests(_0x8ea3bd),_0x8ea3bd['rawEventLog']=[],await saveRawEventLog(_0x8ea3bd),await _0x8ea3bd[_0x5c518f(0x120)](LTM_DP_STATUS,{'val':_0x5c518f(0x258)+_0x3255d3+_0x5c518f(0x1e2),'ack':!![]}));}catch(_0x368bf6){await _0x8ea3bd[_0x5c518f(0x120)](LTM_DP_STATUS,{'val':_0x5c518f(0x221)+_0x368bf6[_0x5c518f(0x1bb)],'ack':!![]});}}async function sendMorningBriefing(_0x4ab0bb){const _0x371fcb=a0_0x5c7278;if(!_0x4ab0bb['geminiModel'])return;_0x4ab0bb[_0x371fcb(0x164)][_0x371fcb(0x277)]('Generating\x20Morning\x20Briefing...');const _0x533f08=_0x4ab0bb['dailyDigests'][_0x371fcb(0x245)]>0x0?_0x4ab0bb[_0x371fcb(0x155)][_0x4ab0bb['dailyDigests'][_0x371fcb(0x245)]-0x1]:null,_0x3b2589=_0x533f08&&_0x533f08[_0x371fcb(0xc5)]?_0x533f08['health'][_0x371fcb(0xf5)]:_0x371fcb(0xeb),_0x2cb884=new Date();_0x2cb884[_0x371fcb(0x259)](0x4,0x0,0x0,0x0);const _0x8b7ae6=_0x4ab0bb[_0x371fcb(0x192)][_0x371fcb(0x138)](_0x36b341=>new Date(_0x36b341[_0x371fcb(0xd0)])>_0x2cb884),_0x2d800f=PERSONA_MAPPING[_0x4ab0bb[_0x371fcb(0xda)]['aiPersona']||_0x371fcb(0x24b)],_0x2b1279=_0x4ab0bb[_0x371fcb(0xda)]['livingContext']||'',_0x3ce7ba=await getWeatherContext(_0x4ab0bb),_0x275945=await getCalendarContext(_0x4ab0bb),_0x334937=_0x371fcb(0x207)+_0x2d800f+_0x371fcb(0x230)+_0x2b1279+'.\x20ZUSATZ:\x20'+_0x3ce7ba+'\x20'+_0x275945+_0x371fcb(0x1f8)+_0x3b2589+_0x371fcb(0x26c)+JSON[_0x371fcb(0x16b)](_0x8b7ae6[_0x371fcb(0x268)](0x0,0xa))+_0x371fcb(0x139);try{const _0x59941f=await _0x4ab0bb[_0x371fcb(0x273)][_0x371fcb(0x227)](_0x334937),_0x12c21d='ðŸŒ…\x20Daily\x20Briefing:\x0a'+_0x59941f[_0x371fcb(0xca)][_0x371fcb(0x12b)]()[_0x371fcb(0x18e)]();sendNotification(_0x4ab0bb,_0x12c21d),_0x4ab0bb[_0x371fcb(0x164)][_0x371fcb(0x277)](_0x371fcb(0x1eb));}catch(_0x4b3a0c){_0x4ab0bb[_0x371fcb(0x164)][_0x371fcb(0x1dd)](_0x371fcb(0xe1)+_0x4b3a0c[_0x371fcb(0x1bb)]);}}async function scanForDevices(_0x499334,_0x4c2283){const _0x138150=a0_0x5c7278;_0x499334[_0x138150(0x164)][_0x138150(0x277)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x46685b=[],_0x204d11=await _0x499334[_0x138150(0xc9)]('*'),_0x26922e=await _0x499334[_0x138150(0xc9)](_0x138150(0x213),_0x138150(0x17b)),_0x39c19e=await _0x499334[_0x138150(0xc9)](_0x138150(0x1de),_0x138150(0x17b)),_0x6e1d55={};if(_0x26922e)for(const _0x412907 in _0x26922e){const _0x3f0cb8=_0x26922e[_0x412907][_0x138150(0x23f)][_0x138150(0x257)]||[];_0x3f0cb8[_0x138150(0xfe)](_0x30fb3e=>{const _0x44ee6f=_0x138150;if(!_0x6e1d55[_0x30fb3e])_0x6e1d55[_0x30fb3e]=[];_0x6e1d55[_0x30fb3e][_0x44ee6f(0x25e)](_0x412907);});}const _0x165dbe={};if(_0x39c19e)for(const _0x10cccb in _0x39c19e){const _0x74169f=_0x39c19e[_0x10cccb]['common'][_0x138150(0x257)]||[],_0x4f8539=typeof _0x39c19e[_0x10cccb][_0x138150(0x23f)][_0x138150(0x1a4)]===_0x138150(0xd5)?_0x39c19e[_0x10cccb][_0x138150(0x23f)][_0x138150(0x1a4)]['de']:_0x39c19e[_0x10cccb][_0x138150(0x23f)]['name'];_0x74169f[_0x138150(0xfe)](_0x25d770=>_0x165dbe[_0x25d770]=_0x4f8539);}const _0x49f782=_0x4c2283[_0x138150(0x10c)]||[],_0x299844=_0x4c2283[_0x138150(0x23e)]!==![],_0x87ad14=_0x4c2283['doors']!==![],_0x3eee91=_0x4c2283[_0x138150(0xfd)]!==![],_0x55243c=_0x4c2283['temperature']===!![],_0x367a0e=_0x4c2283['weather']===!![];for(const _0x293f0f in _0x204d11){const _0x4cbc29=_0x204d11[_0x293f0f];if(_0x4cbc29[_0x138150(0x17f)]!=='state'||!_0x4cbc29[_0x138150(0x23f)])continue;if(ADAPTER_BLACKLIST[_0x138150(0x222)](_0x405e01=>_0x293f0f[_0x138150(0x153)](_0x405e01))&&!_0x367a0e)continue;const _0x226e28=(_0x4cbc29[_0x138150(0x23f)]['role']||'')[_0x138150(0x263)]();let _0x4466fe=(typeof _0x4cbc29[_0x138150(0x23f)][_0x138150(0x1a4)]==='object'?_0x4cbc29[_0x138150(0x23f)]['name']['de']:_0x4cbc29[_0x138150(0x23f)]['name'])||_0x293f0f;const _0x17049b=_0x4466fe[_0x138150(0x263)]();let _0x502222=![],_0x3a6616=![];if(_0x49f782['length']>0x0){const _0x2ee1ba=_0x6e1d55[_0x293f0f]||[],_0x457427=_0x293f0f['split']('.')[_0x138150(0x268)](0x0,-0x1)['join']('.'),_0x2ca823=_0x6e1d55[_0x457427]||[];(_0x2ee1ba['some'](_0x2f98a9=>_0x49f782[_0x138150(0x112)](_0x2f98a9))||_0x2ca823['some'](_0x5bd84a=>_0x49f782[_0x138150(0x112)](_0x5bd84a)))&&(_0x502222=!![],_0x3a6616=!![]);}if(!_0x502222&&!_0x367a0e){if(HARD_IGNORE_TERMS['some'](_0x50e46f=>_0x293f0f[_0x138150(0x112)](_0x50e46f)||_0x17049b[_0x138150(0x112)](_0x50e46f[_0x138150(0x263)]())))continue;}if(BAD_NAMES[_0x138150(0x222)](_0x21befd=>_0x17049b===_0x21befd||_0x17049b[_0x138150(0x276)]('.'+_0x21befd))){const _0x5ec077=_0x293f0f[_0x138150(0x206)]('.');if(_0x5ec077['length']>0x2){const _0x429fee=_0x5ec077[_0x138150(0x268)](0x0,-0x1)[_0x138150(0x22b)]('.'),_0x131bdf=_0x204d11[_0x429fee];if(_0x131bdf&&_0x131bdf['common']&&_0x131bdf[_0x138150(0x23f)][_0x138150(0x1a4)]){const _0x3c7089=typeof _0x131bdf[_0x138150(0x23f)][_0x138150(0x1a4)]===_0x138150(0xd5)?_0x131bdf[_0x138150(0x23f)]['name']['de']:_0x131bdf[_0x138150(0x23f)][_0x138150(0x1a4)];_0x3c7089&&!_0x4466fe[_0x138150(0x112)](_0x3c7089)&&(_0x4466fe=_0x3c7089+'\x20'+_0x4466fe);}}}let _0x2bf1f8='';if(_0x299844&&(_0x226e28[_0x138150(0x112)](_0x138150(0x23e))||_0x226e28[_0x138150(0x112)](_0x138150(0x205))||_0x17049b[_0x138150(0x112)](_0x138150(0x14e))||_0x17049b['includes'](_0x138150(0x106))))_0x2bf1f8=_0x138150(0x23e);else{if(!_0x2bf1f8&&_0x87ad14&&(_0x226e28[_0x138150(0x112)](_0x138150(0x1e5))||_0x226e28['includes'](_0x138150(0x1e0))||_0x226e28[_0x138150(0x112)]('lock')||_0x226e28['includes'](_0x138150(0xce))||_0x226e28[_0x138150(0x112)](_0x138150(0x235))||_0x17049b['includes'](_0x138150(0x1fa))||_0x17049b[_0x138150(0x112)](_0x138150(0x143))||_0x17049b[_0x138150(0x112)](_0x138150(0xbe))))_0x2bf1f8=_0x138150(0x1e5);else{if(!_0x2bf1f8&&_0x3eee91&&(_0x226e28[_0x138150(0x112)](_0x138150(0x209))||_0x226e28['includes'](_0x138150(0xbd))||_0x226e28[_0x138150(0x112)](_0x138150(0x23a))||_0x17049b[_0x138150(0x112)](_0x138150(0x1cc))||_0x17049b[_0x138150(0x112)](_0x138150(0x163))||_0x17049b[_0x138150(0x112)](_0x138150(0x16a)))){if(_0x4cbc29[_0x138150(0x23f)]['write']||_0x226e28[_0x138150(0x112)](_0x138150(0x17c)))_0x2bf1f8=_0x138150(0x209);}else{if(!_0x2bf1f8&&_0x55243c&&(_0x226e28[_0x138150(0x112)]('temperature')||_0x226e28[_0x138150(0x112)](_0x138150(0xc7))||_0x226e28[_0x138150(0x112)](_0x138150(0x133))||_0x17049b[_0x138150(0x112)]('temp')||_0x17049b[_0x138150(0x112)](_0x138150(0x156))||_0x17049b[_0x138150(0x112)](_0x138150(0x13e))))_0x2bf1f8=_0x138150(0xe5);else{if(!_0x2bf1f8&&_0x3a6616)_0x2bf1f8=_0x138150(0x11f);}}}}if(_0x2bf1f8){let _0xc5ab54=_0x165dbe[_0x293f0f]||'';if(!_0xc5ab54){let _0x2302ca=_0x293f0f;for(let _0x52b8d4=0x0;_0x52b8d4<0x3;_0x52b8d4++){const _0xe4fe3f=_0x2302ca[_0x138150(0x253)]('.');if(_0xe4fe3f===-0x1)break;_0x2302ca=_0x2302ca[_0x138150(0xcc)](0x0,_0xe4fe3f);if(_0x165dbe[_0x2302ca]){_0xc5ab54=_0x165dbe[_0x2302ca];break;}}}_0x46685b[_0x138150(0x25e)]({'id':_0x293f0f,'name':_0x4466fe,'location':_0xc5ab54,'type':_0x2bf1f8,'logDuplicates':_0x2bf1f8===_0x138150(0x23e),'isExit':![],'_score':_0xc5ab54?0x50:_0x2bf1f8==='custom'?0x5a:0x28});}}return _0x46685b[_0x138150(0x151)]((_0x24a8aa,_0x5f221f)=>_0x5f221f[_0x138150(0x1da)]-_0x24a8aa[_0x138150(0x1da)]),_0x46685b;}async function executeAutomationAction(_0x3d9571){const _0x58caa7=a0_0x5c7278;try{const _0x3c049d=await _0x3d9571[_0x58caa7(0xd2)](_0x58caa7(0xc6)),_0x45a280=await _0x3d9571['getStateAsync'](_0x58caa7(0x173));if(_0x3c049d&&_0x3c049d[_0x58caa7(0x199)]&&_0x45a280){const _0x209180=_0x3c049d[_0x58caa7(0x199)];let _0x3cfb10=_0x45a280[_0x58caa7(0x199)];try{_0x3cfb10=JSON[_0x58caa7(0x20c)](_0x3cfb10);}catch(_0x258bed){}_0x3d9571[_0x58caa7(0x164)][_0x58caa7(0x277)](_0x58caa7(0x10d)+_0x209180+_0x58caa7(0x19c)+_0x3cfb10),await _0x3d9571[_0x58caa7(0x264)](_0x209180,_0x3cfb10);}else _0x3d9571['log']['warn'](_0x58caa7(0x251));}catch(_0x316ed2){_0x3d9571[_0x58caa7(0x164)]['error']('BUTLER\x20Execution\x20Error:\x20'+_0x316ed2[_0x58caa7(0x1bb)]);}}function tryParse(_0x2c56ee){const _0xe83314=a0_0x5c7278;try{return JSON[_0xe83314(0x20c)](_0x2c56ee);}catch(_0x26948c){return null;}}async function processSensorEvent(_0x4dabe7,_0x4e0ea0,_0x4430ed,_0x4b1f5b){const _0x4823f5=a0_0x5c7278;if(!_0x4b1f5b)return;const _0x57e607=_0x4430ed[_0x4823f5(0x199)],_0x558712=Date[_0x4823f5(0x128)]();_0x4dabe7[_0x4823f5(0x164)][_0x4823f5(0x123)]('Event\x20received:\x20'+_0x4e0ea0+_0x4823f5(0x19c)+_0x57e607);const _0x3ae777=_0x4dabe7[_0x4823f5(0x111)][_0x4e0ea0];_0x4dabe7[_0x4823f5(0x111)][_0x4e0ea0]=_0x57e607;if(!_0x4b1f5b[_0x4823f5(0x1cb)]&&_0x3ae777!=undefined&&_0x3ae777==_0x57e607){_0x4dabe7[_0x4823f5(0x164)]['debug'](_0x4823f5(0x26e)+_0x4b1f5b['name']+_0x4823f5(0x1e3)+_0x57e607+')');return;}const _0x5b11ce={'timestamp':_0x558712,'id':_0x4e0ea0,'name':_0x4b1f5b['name'],'type':_0x4b1f5b[_0x4823f5(0x17f)],'location':_0x4b1f5b[_0x4823f5(0x1cd)],'value':_0x57e607};_0x4dabe7[_0x4823f5(0x192)]['unshift'](_0x5b11ce);if(_0x4dabe7[_0x4823f5(0x192)][_0x4823f5(0x245)]>HISTORY_MAX_SIZE)_0x4dabe7['eventHistory']['pop']();await _0x4dabe7[_0x4823f5(0x120)](_0x4823f5(0x121),{'val':JSON[_0x4823f5(0x16b)](_0x5b11ce),'ack':!![]}),await _0x4dabe7['setStateAsync']('events.history',{'val':JSON[_0x4823f5(0x16b)](_0x4dabe7['eventHistory']),'ack':!![]});_0x4dabe7[_0x4823f5(0x132)]&&(_0x4dabe7[_0x4823f5(0x1b1)][_0x4823f5(0x25e)](_0x5b11ce),await saveRawEventLog(_0x4dabe7));if(_0x4b1f5b[_0x4823f5(0x1b3)]&&_0x57e607===!![]){if(_0x4dabe7[_0x4823f5(0x1fe)]&&!_0x4dabe7[_0x4823f5(0x26d)])_0x4dabe7[_0x4823f5(0x164)][_0x4823f5(0x277)]('Exit\x20Sensor\x20triggered\x20('+_0x4b1f5b['name']+_0x4823f5(0x274)),startExitTimer(_0x4dabe7);else!_0x4dabe7[_0x4823f5(0x1fe)]&&(_0x4dabe7[_0x4823f5(0x164)][_0x4823f5(0x277)](_0x4823f5(0x269)+_0x4b1f5b[_0x4823f5(0x1a4)]+_0x4823f5(0xd6)),await setPresence(_0x4dabe7,!![]));}else _0x4b1f5b[_0x4823f5(0x17f)]===_0x4823f5(0x23e)&&_0x57e607===!![]&&(_0x4dabe7[_0x4823f5(0x1b2)]&&(_0x4dabe7[_0x4823f5(0x164)]['info'](_0x4823f5(0x21f)),abortExitTimer(_0x4dabe7)),!_0x4dabe7['isPresent']&&_0x4dabe7['currentSystemMode']===SYSTEM_MODES[_0x4823f5(0x21d)]&&await setPresence(_0x4dabe7,!![]));}async function runGeminiAnalysis(_0x5b902f,_0x214d84=''){const _0x266184=a0_0x5c7278;if(!_0x5b902f[_0x266184(0x273)])return;if(_0x5b902f[_0x266184(0x192)][_0x266184(0x245)]===0x0)return;const _0x4aa9f2=_0x5b902f[_0x266184(0x192)][_0x266184(0x268)](0x0,0xf),_0x4860b1=await getWeatherContext(_0x5b902f),_0x3acfb0=_0x5b902f[_0x266184(0x1c4)],_0x4f5680=PERSONA_MAPPING[_0x5b902f[_0x266184(0xda)][_0x266184(0x10f)]||_0x266184(0x24b)],_0x310d9c=_0x5b902f[_0x266184(0xda)][_0x266184(0x272)]||'Keine\x20Details.';let _0x499538=![];try{const _0x22cbbf=await _0x5b902f[_0x266184(0xd2)]('analysis.automation.autoApply');if(_0x22cbbf&&_0x22cbbf[_0x266184(0x199)])_0x499538=!![];}catch(_0x43d9df){}const _0x4ca325=_0x266184(0xf7)+_0x4f5680+_0x266184(0x1f2)+_0x310d9c+_0x266184(0x210)+_0x3acfb0+_0x266184(0xc4)+_0x4860b1+'.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20'+(_0x214d84||_0x266184(0x19d))+_0x266184(0xf8)+JSON[_0x266184(0x16b)](_0x4aa9f2)+_0x266184(0x1ca);try{const _0x1f5b35=await _0x5b902f[_0x266184(0x273)]['generateContent'](_0x4ca325),_0x1f23b0=_0x1f5b35[_0x266184(0xca)]['text']()[_0x266184(0x23b)](/```json|```/g,'')[_0x266184(0x18e)](),_0x2a6d02=JSON[_0x266184(0x20c)](_0x1f23b0);await _0x5b902f[_0x266184(0x120)](_0x266184(0x160),{'val':JSON[_0x266184(0x16b)](_0x2a6d02),'ack':!![]});const _0x155045=_0x2a6d02[_0x266184(0x1ac)]||![];_0x155045!==_0x5b902f[_0x266184(0x1c8)]&&(await _0x5b902f[_0x266184(0x120)](_0x266184(0x193),{'val':_0x155045,'ack':!![]}),_0x5b902f['lastAlertState']=_0x155045,_0x155045&&(await _0x5b902f[_0x266184(0x120)](_0x266184(0xe9),{'val':_0x2a6d02[_0x266184(0x25c)],'ack':!![]}),sendNotification(_0x5b902f,'âš ï¸\x20ALARM:\x20'+_0x2a6d02[_0x266184(0x25c)],![],_0x2a6d02['isEmergency']))),_0x2a6d02[_0x266184(0x16d)]&&_0x2a6d02[_0x266184(0x16d)][_0x266184(0x15a)]&&_0x2a6d02[_0x266184(0x16d)][_0x266184(0xd4)]&&(_0x5b902f[_0x266184(0x164)][_0x266184(0x277)]('ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20'+_0x2a6d02['automationProposal'][_0x266184(0x217)]),await _0x5b902f[_0x266184(0x120)](_0x266184(0x204),{'val':!![],'ack':!![]}),await _0x5b902f[_0x266184(0x120)](_0x266184(0x1c2),{'val':_0x2a6d02[_0x266184(0x16d)][_0x266184(0x217)],'ack':!![]}),await _0x5b902f[_0x266184(0x120)]('analysis.automation.targetId',{'val':_0x2a6d02[_0x266184(0x16d)][_0x266184(0xd4)],'ack':!![]}),await _0x5b902f[_0x266184(0x120)]('analysis.automation.targetValue',{'val':JSON[_0x266184(0x16b)](_0x2a6d02[_0x266184(0x16d)]['targetValue']),'ack':!![]}),_0x499538&&(_0x5b902f[_0x266184(0x164)][_0x266184(0x277)]('ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20'+_0x2a6d02[_0x266184(0x16d)]['targetId']+'...'),await executeAutomationAction(_0x5b902f)));}catch(_0xa73108){_0x5b902f['log'][_0x266184(0x1dd)](_0x266184(0x21e)+_0xa73108[_0x266184(0x1bb)]);}}function installPythonDependencies(_0x45633f){const _0x2ef53c=a0_0x5c7278;if(_0x45633f[_0x2ef53c(0x145)])return;_0x45633f['dependencyInstallInProgress']=!![];const _0x50839c=path[_0x2ef53c(0x22b)](__dirname,_0x2ef53c(0x19e),'requirements.txt');_0x45633f[_0x2ef53c(0x164)]['info'](_0x2ef53c(0x18c)+_0x50839c+_0x2ef53c(0xde)),stopPythonService(_0x45633f);const _0x5a4a3e='python3\x20-m\x20pip\x20install\x20-r\x20\x22'+_0x50839c+_0x2ef53c(0x16e);exec(_0x5a4a3e,(_0x434bb6,_0x1b8f50,_0x5f2401)=>{const _0x738bf4=_0x2ef53c;_0x45633f[_0x738bf4(0x145)]=![],_0x434bb6?(_0x45633f['log'][_0x738bf4(0x1dd)]('âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x5a4a3e),_0x45633f[_0x738bf4(0x164)]['error'](_0x738bf4(0x19f)+(_0x5f2401||_0x434bb6['message']))):(_0x45633f[_0x738bf4(0x164)][_0x738bf4(0x277)]('âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...'),startPythonService(_0x45633f));});}function startPythonService(_0x318d92){const _0x563617=a0_0x5c7278;try{const _0x3539e7=path[_0x563617(0x22b)](__dirname,'python_service','service.py');_0x318d92['log'][_0x563617(0x277)]('ðŸ\x20Starting\x20Python\x20Sidecar:\x20'+_0x3539e7),_0x318d92['pythonProcess']=spawn(_0x563617(0x1d1),[_0x3539e7]),_0x318d92[_0x563617(0x177)]['stdout']['on'](_0x563617(0x19a),_0x12a163=>{const _0x13a056=_0x563617,_0x264c1d=_0x12a163['toString']()[_0x13a056(0x18e)]();_0x318d92[_0x13a056(0x164)]['debug']('[PYTHON]\x20'+_0x264c1d),(_0x264c1d[_0x13a056(0x112)](_0x13a056(0x122))||_0x264c1d[_0x13a056(0x112)](_0x13a056(0x1c1)))&&(_0x318d92['log'][_0x13a056(0x182)]('âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...'),installPythonDependencies(_0x318d92));}),_0x318d92[_0x563617(0x177)][_0x563617(0x16f)]['on'](_0x563617(0x19a),_0x35283c=>{const _0x2058de=_0x563617,_0x24a3ab=_0x35283c[_0x2058de(0x1e4)]()['trim']();_0x318d92[_0x2058de(0x164)][_0x2058de(0x1dd)]('[PYTHON\x20ERR]\x20'+_0x24a3ab);}),_0x318d92[_0x563617(0x177)]['on'](_0x563617(0xe4),_0x168977=>{const _0x586c11=_0x563617;_0x318d92[_0x586c11(0x164)][_0x586c11(0x277)](_0x586c11(0x194)+_0x168977),_0x318d92[_0x586c11(0x177)]=null;}),_0x318d92[_0x563617(0x177)]['on'](_0x563617(0x1dd),_0x47e084=>{const _0x9c743d=_0x563617;_0x318d92[_0x9c743d(0x164)][_0x9c743d(0x182)](_0x9c743d(0x232)+_0x47e084[_0x9c743d(0x1bb)]);});}catch(_0x335234){_0x318d92[_0x563617(0x164)]['error']('Error\x20launching\x20Python\x20service:\x20'+_0x335234[_0x563617(0x1bb)]);}}function stopPythonService(_0x2feb78){const _0x51b782=a0_0x5c7278;if(_0x2feb78[_0x51b782(0x177)]){_0x2feb78[_0x51b782(0x164)][_0x51b782(0x277)](_0x51b782(0x148));try{_0x2feb78[_0x51b782(0x177)]['kill']();}catch(_0x1597f4){_0x2feb78['log']['warn'](_0x51b782(0x27a)+_0x1597f4[_0x51b782(0x1bb)]);}_0x2feb78[_0x51b782(0x177)]=null;}}class CogniLiving extends utils[a0_0x5c7278(0x24c)]{constructor(_0x3965db){const _0x342000=a0_0x5c7278;super({..._0x3965db,'name':'cogni-living'}),this[_0x342000(0x192)]=[],this[_0x342000(0x239)]=[],this[_0x342000(0xd8)]=[],this[_0x342000(0x1b1)]=[],this[_0x342000(0x155)]=[],this['sensorLastValues']={},this[_0x342000(0xe6)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x342000(0x1fe)]=!![],this[_0x342000(0x1b2)]=null,this[_0x342000(0x215)]=null,this[_0x342000(0x26d)]=![],this['genAI']=null,this[_0x342000(0x273)]=null,this[_0x342000(0x1c4)]=SYSTEM_MODES[_0x342000(0x21d)],this[_0x342000(0x132)]=![],this[_0x342000(0x1c8)]=![],this['systemUUID']='unknown',this[_0x342000(0x1ad)]=null,this['ltmJob']=null,this[_0x342000(0x176)]=null,this[_0x342000(0x1ef)]=null,this[_0x342000(0x14c)]=null,this[_0x342000(0x177)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x342000(0x208),this[_0x342000(0x168)][_0x342000(0x12d)](this)),this['on'](_0x342000(0x1d2),this[_0x342000(0x1a7)][_0x342000(0x12d)](this)),this['on'](_0x342000(0x137),this['onUnload'][_0x342000(0x12d)](this)),this['on'](_0x342000(0x1bb),this[_0x342000(0x154)][_0x342000(0x12d)](this));}async[a0_0x5c7278(0x168)](){const _0x5c9c10=a0_0x5c7278;this[_0x5c9c10(0x164)][_0x5c9c10(0x277)](_0x5c9c10(0x107)+this[_0x5c9c10(0xc1)]+_0x5c9c10(0xf9)),await initZombies(this),this[_0x5c9c10(0xda)][_0x5c9c10(0xe0)]=this['config'][_0x5c9c10(0xe0)]||'';try{this[_0x5c9c10(0x132)]=await checkLicense(this,this[_0x5c9c10(0xda)]['licenseKey']);}catch(_0x3dae60){}if(!this[_0x5c9c10(0xda)][_0x5c9c10(0x238)]||this[_0x5c9c10(0xda)]['inactivityThresholdHours']<0.1)this[_0x5c9c10(0xda)][_0x5c9c10(0x238)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x5c9c10(0xda)]['geminiApiKey'])try{this[_0x5c9c10(0x102)]=new GoogleGenerativeAI(this[_0x5c9c10(0xda)]['geminiApiKey']),this[_0x5c9c10(0x273)]=this[_0x5c9c10(0x102)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5c9c10(0xb4)}}),this[_0x5c9c10(0x164)]['info'](_0x5c9c10(0x26f));}catch(_0x51c77b){this[_0x5c9c10(0x164)][_0x5c9c10(0x1dd)]('Gemini\x20Init\x20Error:\x20'+_0x51c77b[_0x5c9c10(0x1bb)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x5c9c10(0xb7)](_0x5c9c10(0xb9)),this[_0x5c9c10(0xb7)](LTM_DP_TRIGGER_DIGEST),this[_0x5c9c10(0xb7)](_0x5c9c10(0x125)),this[_0x5c9c10(0xb7)](_0x5c9c10(0x149)),this[_0x5c9c10(0xb7)](_0x5c9c10(0x1a0)),this['subscribeStates']('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x5c9c10(0x1ad)])clearInterval(this[_0x5c9c10(0x1ad)]);const _0x1aca2f=this['config'][_0x5c9c10(0x212)]||0xf;_0x1aca2f>0x0&&(this[_0x5c9c10(0x164)][_0x5c9c10(0x277)](_0x5c9c10(0x241)+_0x1aca2f+_0x5c9c10(0x21c)),this[_0x5c9c10(0x1ad)]=setInterval(()=>{runAutopilot(this);},_0x1aca2f*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this);}[a0_0x5c7278(0x1d4)](_0x382975){const _0x31452f=a0_0x5c7278;if(this[_0x31452f(0x1ad)])clearInterval(this[_0x31452f(0x1ad)]);if(this[_0x31452f(0x1ef)])clearInterval(this['driftAnalysisTimer']);if(this['ltmJob'])this[_0x31452f(0xe7)][_0x31452f(0x275)]();if(this[_0x31452f(0x176)])this['modeResetJob'][_0x31452f(0x275)]();if(this[_0x31452f(0x14c)])this[_0x31452f(0x14c)][_0x31452f(0x275)]();if(this[_0x31452f(0x1b2)])clearTimeout(this['exitTimer']);if(this[_0x31452f(0x215)])clearTimeout(this[_0x31452f(0x215)]);stopPythonService(this),_0x382975();}async[a0_0x5c7278(0x1a7)](_0xdf7a3a,_0x2f0407){const _0x31b9e8=a0_0x5c7278;if(!_0x2f0407)return;if(_0xdf7a3a[_0x31b9e8(0x112)]('telegram')&&_0xdf7a3a[_0x31b9e8(0x276)]('communicate.request')&&_0x2f0407[_0x31b9e8(0x199)]){await handleTelegramResponse(this,_0x2f0407[_0x31b9e8(0x199)]);return;}if(_0xdf7a3a===this[_0x31b9e8(0x108)]+'.'+SYSTEM_DP_MODE){_0x2f0407[_0x31b9e8(0x199)]&&Object['values'](SYSTEM_MODES)['includes'](_0x2f0407[_0x31b9e8(0x199)])&&(this['currentSystemMode']=_0x2f0407[_0x31b9e8(0x199)],_0x2f0407[_0x31b9e8(0x199)]===SYSTEM_MODES[_0x31b9e8(0x13a)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x2f0407[_0x31b9e8(0x166)])this['setState'](_0xdf7a3a,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x2f0407[_0x31b9e8(0x166)]){_0xdf7a3a['includes'](_0x31b9e8(0xb9))&&_0x2f0407[_0x31b9e8(0x199)]&&(this[_0x31b9e8(0x233)](_0xdf7a3a,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0xdf7a3a['includes']('triggerDailyDigest')&&_0x2f0407['val']){this[_0x31b9e8(0x233)](_0xdf7a3a,{'val':![],'ack':!![]});if(this[_0x31b9e8(0x132)])createDailyDigest(this);}_0xdf7a3a[_0x31b9e8(0x112)](_0x31b9e8(0x248))&&_0x2f0407[_0x31b9e8(0x199)]&&(this[_0x31b9e8(0x233)](_0xdf7a3a,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0xdf7a3a[_0x31b9e8(0x112)]('automation.triggerAction')&&_0x2f0407[_0x31b9e8(0x199)]&&(this[_0x31b9e8(0x233)](_0xdf7a3a,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x31b9e8(0xda)][_0x31b9e8(0x1e7)]&&this[_0x31b9e8(0xda)][_0x31b9e8(0x1e7)][_0x31b9e8(0x112)](_0xdf7a3a)){await checkWifiPresence(this);return;}const _0x5c296f=(this[_0x31b9e8(0xda)]['devices']||[])[_0x31b9e8(0x114)](_0x342a5c=>_0x342a5c['id']===_0xdf7a3a);if(_0x5c296f)processSensorEvent(this,_0xdf7a3a,_0x2f0407,_0x5c296f);}async[a0_0x5c7278(0x154)](_0xa3c514){const _0x742670=a0_0x5c7278;if(typeof _0xa3c514==='object'&&_0xa3c514[_0x742670(0x1bb)])try{if(_0xa3c514['command']===_0x742670(0x25d)){}else{if(_0xa3c514[_0x742670(0x26a)]===_0x742670(0x129)){}else{if(_0xa3c514[_0x742670(0x26a)]===_0x742670(0x186)){if(!this[_0x742670(0x132)])return this[_0x742670(0x116)](_0xa3c514[_0x742670(0xf3)],_0xa3c514[_0x742670(0x26a)],{'success':![],'isPro':![]},_0xa3c514[_0x742670(0xdb)]);let _0x307d8e={'status':'N/A','details':'','lastCheck':0x0};try{_0x307d8e[_0x742670(0x159)]=(await this[_0x742670(0xd2)](LTM_DP_DRIFT_STATUS))[_0x742670(0x199)],_0x307d8e['details']=(await this[_0x742670(0xd2)](LTM_DP_DRIFT_DETAILS))['val'],_0x307d8e['lastCheck']=(await this[_0x742670(0xd2)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x5039de){}const _0x52e654=this[_0x742670(0x239)]||[];this['sendTo'](_0xa3c514[_0x742670(0xf3)],_0xa3c514['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x307d8e,'analysisHistory':_0x52e654},_0xa3c514[_0x742670(0xdb)]);}else{if(_0xa3c514[_0x742670(0x26a)]==='getOverviewData'){const _0x4c4c86=this[_0x742670(0x155)]['length'],_0x383fd3=new Date(),_0xf6a989=new Date(_0x383fd3[_0x742670(0x25b)](),_0x383fd3[_0x742670(0xc3)](),_0x383fd3['getDate']())[_0x742670(0x20b)](),_0x609d83=this['rawEventLog'][_0x742670(0x138)](_0x28f2e2=>new Date(_0x28f2e2['timestamp'])[_0x742670(0x20b)]()>_0xf6a989)[_0x742670(0x245)],_0x518448=new Array(0x18)['fill'](0x0);this['rawEventLog']['forEach'](_0x3c9d27=>{const _0x36a187=_0x742670,_0x10623a=new Date(_0x3c9d27[_0x36a187(0xd0)]);if(_0x10623a[_0x36a187(0x20b)]()>_0xf6a989)_0x518448[_0x10623a[_0x36a187(0x183)]()]++;});let _0xba4463={'status':_0x742670(0xeb)};try{_0xba4463['status']=(await this[_0x742670(0xd2)](LTM_DP_DRIFT_STATUS))[_0x742670(0x199)];}catch(_0x517250){}let _0x27edc5='';try{const _0x428181=await this[_0x742670(0xd2)](_0x742670(0x22a));_0x27edc5=_0x428181?_0x428181[_0x742670(0x199)]:'';}catch(_0x40c423){}let _0x5cd05f=null;!this[_0x742670(0x273)]&&(_0x5cd05f=this['config'][_0x742670(0x1a9)]?_0x742670(0xff):'Kein\x20API\x20Key!');let _0x51665b={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x5d24cd=await this[_0x742670(0xd2)]('analysis.automation.patternDetected'),_0x5a983b=await this[_0x742670(0xd2)]('analysis.automation.description'),_0x14c789=await this[_0x742670(0xd2)](_0x742670(0xc6)),_0x3653c4=await this['getStateAsync'](_0x742670(0x173)),_0x2d881c=await this['getStateAsync']('analysis.automation.autoApply');_0x5d24cd&&_0x5d24cd[_0x742670(0x199)]&&(_0x51665b[_0x742670(0x15a)]=!![],_0x51665b['description']=_0x5a983b?_0x5a983b['val']:'',_0x51665b[_0x742670(0xd4)]=_0x14c789?_0x14c789[_0x742670(0x199)]:'',_0x51665b['targetValue']=_0x3653c4?_0x3653c4['val']:''),_0x51665b[_0x742670(0xc0)]=_0x2d881c?!!_0x2d881c[_0x742670(0x199)]:![];}catch(_0x3aa38d){}this['sendTo'](_0xa3c514[_0x742670(0xf3)],_0xa3c514[_0x742670(0x26a)],{'success':!![],'eventHistory':this[_0x742670(0x192)][_0x742670(0x268)](0x0,0xf),'stats':{'digestCount':_0x4c4c86,'eventCountToday':_0x609d83,'hourlyActivity':_0x518448,'driftStatus':_0xba4463[_0x742670(0x159)],'isPresent':this[_0x742670(0x1fe)],'presenceWho':_0x27edc5,'minDays':this[_0x742670(0xda)][_0x742670(0x271)]||0x7,'stbDays':this[_0x742670(0xda)][_0x742670(0x184)]||0xe,'ltbDays':this['config'][_0x742670(0x13d)]||0x3c,'systemError':_0x5cd05f},'automation':_0x51665b},_0xa3c514['callback']);}else{if(_0xa3c514[_0x742670(0x26a)]===_0x742670(0x187)){const _0x105635=await this[_0x742670(0xc9)](_0x742670(0x213),_0x742670(0x17b)),_0x3f7e77=[];if(_0x105635)for(const _0x164b48 in _0x105635){const _0x1482d3=_0x105635[_0x164b48],_0x5b2434=(_0x1482d3[_0x742670(0x23f)]&&typeof _0x1482d3[_0x742670(0x23f)][_0x742670(0x1a4)]==='object'?_0x1482d3['common'][_0x742670(0x1a4)]['de']:_0x1482d3[_0x742670(0x23f)]['name'])||_0x1482d3['common']['name'];_0x3f7e77[_0x742670(0x25e)]({'id':_0x164b48,'name':_0x5b2434});}this[_0x742670(0x116)](_0xa3c514[_0x742670(0xf3)],_0xa3c514[_0x742670(0x26a)],{'success':!![],'enums':_0x3f7e77},_0xa3c514[_0x742670(0xdb)]);}else{if(_0xa3c514[_0x742670(0x26a)]===_0x742670(0x1e1))try{const _0x1c52ee=await scanForDevices(this,_0xa3c514[_0x742670(0x1bb)]||{});this['sendTo'](_0xa3c514[_0x742670(0xf3)],_0xa3c514[_0x742670(0x26a)],{'success':!![],'devices':_0x1c52ee},_0xa3c514[_0x742670(0xdb)]);}catch(_0x59b7b8){this[_0x742670(0x116)](_0xa3c514[_0x742670(0xf3)],_0xa3c514[_0x742670(0x26a)],{'success':![],'error':_0x59b7b8[_0x742670(0x1bb)]},_0xa3c514['callback']);}else{if(_0xa3c514['command']===_0x742670(0x141)){const _0x171f49=_0xa3c514[_0x742670(0x1bb)][_0x742670(0x10a)];if(!_0x171f49)return this[_0x742670(0x116)](_0xa3c514[_0x742670(0xf3)],_0xa3c514[_0x742670(0x26a)],{'success':![],'error':_0x742670(0x119)},_0xa3c514['callback']);const _0x54dadd=await getCalendarNames(this,_0x171f49);this[_0x742670(0x116)](_0xa3c514[_0x742670(0xf3)],_0xa3c514['command'],{'success':!![],'names':_0x54dadd},_0xa3c514[_0x742670(0xdb)]);}else{if(_0xa3c514['command']===_0x742670(0x246)){const {targetId:_0x46943a,targetValue:_0x4f5678}=_0xa3c514[_0x742670(0x1bb)];this['log'][_0x742670(0x277)](_0x742670(0x10e)+_0x46943a+'\x20=\x20'+_0x4f5678),await this['setStateAsync'](_0x742670(0x204),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x742670(0x1c2),{'val':'SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20'+_0x46943a,'ack':!![]}),await this[_0x742670(0x120)]('analysis.automation.targetId',{'val':_0x46943a,'ack':!![]}),await this[_0x742670(0x120)]('analysis.automation.targetValue',{'val':_0x4f5678,'ack':!![]}),this[_0x742670(0x116)](_0xa3c514[_0x742670(0xf3)],_0xa3c514['command'],{'success':!![]},_0xa3c514[_0x742670(0xdb)]);}else{if(_0xa3c514[_0x742670(0x26a)]===_0x742670(0xfb)){const {historyId:_0x398c23,rating:_0x2d4b6d,comment:_0x290ebe,alertReason:_0x4f2d7c}=_0xa3c514[_0x742670(0x1bb)];_0x398c23&&_0x2d4b6d?(await saveFeedback(this,{'timestamp':Date[_0x742670(0x128)](),'historyId':_0x398c23,'rating':_0x2d4b6d,'comment':_0x290ebe,'alertReason':_0x4f2d7c}),this[_0x742670(0x116)](_0xa3c514['from'],_0xa3c514[_0x742670(0x26a)],{'success':!![]},_0xa3c514[_0x742670(0xdb)])):this[_0x742670(0x116)](_0xa3c514[_0x742670(0xf3)],_0xa3c514['command'],{'success':![],'error':_0x742670(0x223)},_0xa3c514['callback']);}else _0xa3c514[_0x742670(0x26a)]===_0x742670(0xbb)&&(this['log'][_0x742670(0x277)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x742670(0x120)](_0x742670(0x204),{'val':![],'ack':!![]}),await this[_0x742670(0x120)](_0x742670(0x1c2),{'val':'','ack':!![]}),this['sendTo'](_0xa3c514[_0x742670(0xf3)],_0xa3c514['command'],{'success':!![]},_0xa3c514[_0x742670(0xdb)]));}}}}}}}}}catch(_0x24ef4b){this[_0x742670(0x164)][_0x742670(0x1dd)](_0x742670(0xf0)+_0xa3c514[_0x742670(0x26a)]+':\x20'+_0x24ef4b[_0x742670(0x1bb)]);if(_0xa3c514['callback'])this[_0x742670(0x116)](_0xa3c514[_0x742670(0xf3)],_0xa3c514[_0x742670(0x26a)],{'success':![],'error':_0x24ef4b[_0x742670(0x1bb)]},_0xa3c514[_0x742670(0xdb)]);}}}if(require[a0_0x5c7278(0x19b)]!==module)module[a0_0x5c7278(0x265)]=_0x1398b0=>new CogniLiving(_0x1398b0);else new CogniLiving();