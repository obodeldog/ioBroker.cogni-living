function a0_0xe9c4(_0x155df3,_0x14396f){const _0x4b9ed4=a0_0x2a11();return a0_0xe9c4=function(_0x242906,_0x5acc4a){_0x242906=_0x242906-0x163;let _0x2a1162=_0x4b9ed4[_0x242906];return _0x2a1162;},a0_0xe9c4(_0x155df3,_0x14396f);}const a0_0x47b847=a0_0xe9c4;(function(_0x45fee4,_0x72e7ec){const _0x216143=a0_0xe9c4,_0x52b5aa=_0x45fee4();while(!![]){try{const _0x43ae75=-parseInt(_0x216143(0x32e))/0x1+-parseInt(_0x216143(0x2ce))/0x2+parseInt(_0x216143(0x2d8))/0x3*(parseInt(_0x216143(0x20c))/0x4)+-parseInt(_0x216143(0x29d))/0x5*(parseInt(_0x216143(0x2e9))/0x6)+-parseInt(_0x216143(0x173))/0x7*(parseInt(_0x216143(0x383))/0x8)+parseInt(_0x216143(0x217))/0x9+parseInt(_0x216143(0x17a))/0xa*(parseInt(_0x216143(0x223))/0xb);if(_0x43ae75===_0x72e7ec)break;else _0x52b5aa['push'](_0x52b5aa['shift']());}catch(_0x189b9b){_0x52b5aa['push'](_0x52b5aa['shift']());}}}(a0_0x2a11,0x77f02));const a0_0x5acc4a=(function(){let _0x57b572=!![];return function(_0x22ad0a,_0x29baf1){const _0x1946a9=_0x57b572?function(){if(_0x29baf1){const _0x183252=_0x29baf1['apply'](_0x22ad0a,arguments);return _0x29baf1=null,_0x183252;}}:function(){};return _0x57b572=![],_0x1946a9;};}()),a0_0x242906=a0_0x5acc4a(this,function(){const _0x167202=a0_0xe9c4;return a0_0x242906[_0x167202(0x246)]()[_0x167202(0x355)](_0x167202(0x263))[_0x167202(0x246)]()[_0x167202(0x2ca)](a0_0x242906)[_0x167202(0x355)](_0x167202(0x263));});a0_0x242906();'use strict';const utils=require(a0_0x47b847(0x314)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x47b847(0x2c9)),path=require(a0_0x47b847(0x1a9)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x47b847(0x312),LTM_SCHEDULE=a0_0x47b847(0x1a3),MODE_RESET_SCHEDULE=a0_0x47b847(0x2db),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x47b847(0x389),LTM_DP_STATUS=a0_0x47b847(0x37f),LTM_DP_TRIGGER_DIGEST=a0_0x47b847(0x21c),LTM_DP_BASELINE_STATUS=a0_0x47b847(0x251),LTM_DP_DRIFT_CHANNEL=a0_0x47b847(0x29b),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x47b847(0x282),HARD_IGNORE_TERMS=[a0_0x47b847(0x299),a0_0x47b847(0x2fa),a0_0x47b847(0x21e),a0_0x47b847(0x243),a0_0x47b847(0x1c1),a0_0x47b847(0x305),'connection',a0_0x47b847(0x2dd),a0_0x47b847(0x2ef),a0_0x47b847(0x2ee),'working',a0_0x47b847(0x2be),a0_0x47b847(0x170),'config_pending',a0_0x47b847(0x32f),a0_0x47b847(0x274),'reachable',a0_0x47b847(0x36d)],BAD_NAMES=['targetposition','currentposition',a0_0x47b847(0x230),a0_0x47b847(0x192),a0_0x47b847(0x31c),a0_0x47b847(0x2ad),'on',a0_0x47b847(0x35e),a0_0x47b847(0x211),a0_0x47b847(0x30d),a0_0x47b847(0x384),a0_0x47b847(0x232),a0_0x47b847(0x344),a0_0x47b847(0x30c),a0_0x47b847(0x1af),a0_0x47b847(0x386),a0_0x47b847(0x348),a0_0x47b847(0x23f),a0_0x47b847(0x29c),a0_0x47b847(0x22d),a0_0x47b847(0x29e),a0_0x47b847(0x35c),a0_0x47b847(0x2cd),a0_0x47b847(0x25c),'set_temperature'],ADAPTER_BLACKLIST=['system.',a0_0x47b847(0x257),a0_0x47b847(0x186),a0_0x47b847(0x1f4),a0_0x47b847(0x174),'material.',a0_0x47b847(0x175),'flot.','echarts.','javascript.','simple-api.'],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x47b847(0x393),'PARTY':'party','GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x47b847(0x220)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x47b847(0x380),'senior_aal':a0_0x47b847(0x1d9),'family':a0_0x47b847(0x23d),'single_comfort':a0_0x47b847(0x1e8),'security':a0_0x47b847(0x297)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x50c6ae){const _0x14d3b1=a0_0x47b847;try{const _0x15b79e=['analysis.history_debug_00',_0x14d3b1(0x2d6)];for(const _0x3fc46f of _0x15b79e){try{const _0x6539a4=await _0x50c6ae['getObjectAsync'](_0x3fc46f);_0x6539a4&&await _0x50c6ae[_0x14d3b1(0x283)](_0x3fc46f);}catch(_0x388f3a){}}}catch(_0x3a4977){}}async function initHistory(_0xaca8f3){const _0x3ea057=a0_0x47b847;try{const _0x2784fd=await _0xaca8f3[_0x3ea057(0x368)](_0x3ea057(0x28d));_0x2784fd&&_0x2784fd[_0x3ea057(0x35d)]&&(_0xaca8f3[_0x3ea057(0x382)]=JSON[_0x3ea057(0x365)](_0x2784fd[_0x3ea057(0x35d)]['toString']()));}catch(_0x5d7854){_0xaca8f3[_0x3ea057(0x382)]=[];}try{const _0x19d0c0=await _0xaca8f3[_0x3ea057(0x368)]('analysis.analysisHistory');if(_0x19d0c0&&_0x19d0c0[_0x3ea057(0x35d)])_0xaca8f3[_0x3ea057(0x207)]=JSON[_0x3ea057(0x365)](_0x19d0c0['val'][_0x3ea057(0x246)]());}catch(_0x12b412){_0xaca8f3[_0x3ea057(0x207)]=[];}if(_0xaca8f3[_0x3ea057(0x382)]&&_0xaca8f3[_0x3ea057(0x382)]['length']>0x0){_0xaca8f3[_0x3ea057(0x342)][_0x3ea057(0x1b9)]('Restoring\x20sensor\x20cache\x20from\x20history\x20('+_0xaca8f3['eventHistory'][_0x3ea057(0x2da)]+_0x3ea057(0x341));for(let _0x9d616f=_0xaca8f3[_0x3ea057(0x382)]['length']-0x1;_0x9d616f>=0x0;_0x9d616f--){const _0x441368=_0xaca8f3[_0x3ea057(0x382)][_0x9d616f];_0x441368&&_0x441368['id']!==undefined&&_0x441368['value']!==undefined&&(_0xaca8f3[_0x3ea057(0x21f)][_0x441368['id']]=_0x441368[_0x3ea057(0x31c)]);}}}async function initSystemConfig(_0x3cebee){const _0x37515a=a0_0x47b847;try{const _0x4f6e82=await _0x3cebee['getForeignObjectAsync'](_0x37515a(0x21b));_0x4f6e82&&_0x4f6e82[_0x37515a(0x325)]&&(_0x3cebee[_0x37515a(0x343)]={'latitude':_0x4f6e82[_0x37515a(0x325)][_0x37515a(0x24e)]||0x0,'longitude':_0x4f6e82[_0x37515a(0x325)][_0x37515a(0x1e5)]||0x0,'city':_0x4f6e82[_0x37515a(0x325)][_0x37515a(0x300)]||''});}catch(_0x2fe4fc){}}async function checkLicense(_0x221ca7,_0x516dfd){const _0x587ed7=a0_0x47b847;if(!_0x516dfd)return![];_0x221ca7[_0x587ed7(0x23c)]=await getSystemUUID(_0x221ca7);if(_0x516dfd===_0x587ed7(0x188)||_0x516dfd[_0x587ed7(0x391)](_0x587ed7(0x20a)))return!![];return![];}async function getSystemUUID(_0x228a2e){const _0x45b2ef=a0_0x47b847;try{const _0x282584=await _0x228a2e[_0x45b2ef(0x256)](_0x45b2ef(0x196));if(_0x282584&&_0x282584[_0x45b2ef(0x31b)]&&_0x282584[_0x45b2ef(0x31b)][_0x45b2ef(0x1d7)])return _0x282584['native'][_0x45b2ef(0x1d7)];return _0x45b2ef(0x34a);}catch(_0x248411){return _0x45b2ef(0x353);}}async function createAllObjects(_0x11f622){const _0x5066ea=a0_0x47b847;await checkSystemObjects(_0x11f622),await _0x11f622['setObjectNotExistsAsync']('system.presenceWho',{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x1a4),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![],'def':''},'native':{}}),await _0x11f622['setObjectNotExistsAsync'](_0x5066ea(0x187),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x1d3),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x1d4),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x28d),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x267),'type':'string','role':_0x5066ea(0x1d4),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x27b),{'type':'state','common':{'name':'Trigger\x20Analysis','type':_0x5066ea(0x227),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)]('analysis.triggerBriefing',{'type':_0x5066ea(0x230),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x5066ea(0x227),'role':_0x5066ea(0x258),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x11f622[_0x5066ea(0x302)](_0x5066ea(0x2cc),{'type':_0x5066ea(0x17c),'common':{'name':_0x5066ea(0x2ff)},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x2bf),{'type':'state','common':{'name':_0x5066ea(0x18f),'type':_0x5066ea(0x227),'role':_0x5066ea(0x258),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x2b6),{'type':'state','common':{'name':_0x5066ea(0x31d),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![],'def':_0x5066ea(0x298)},'native':{}}),await _0x11f622[_0x5066ea(0x302)](_0x5066ea(0x32d),{'type':_0x5066ea(0x17c),'common':{'name':_0x5066ea(0x2f2)},'native':{}}),await _0x11f622[_0x5066ea(0x244)]('analysis.security.lastScore',{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x16b),'type':'number','role':_0x5066ea(0x31c),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x381),{'type':_0x5066ea(0x230),'common':{'name':'Last\x20Check\x20Time','type':'string','role':'date','read':!![],'write':![],'def':''},'native':{}}),await _0x11f622[_0x5066ea(0x244)]('analysis.lastResult',{'type':'state','common':{'name':_0x5066ea(0x29a),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x1d4),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)]('analysis.isAlert',{'type':'state','common':{'name':_0x5066ea(0x37d),'type':'boolean','role':_0x5066ea(0x206),'read':!![],'write':![],'def':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x1f2),{'type':'state','common':{'name':'AI\x20Emergency\x20Status','type':_0x5066ea(0x227),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x1d1),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x2c1),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x395),'read':!![],'write':![]},'native':{}}),await _0x11f622['setObjectNotExistsAsync'](_0x5066ea(0x22c),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x2d1),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x2c0),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x214),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x230),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x38d),{'type':'state','common':{'name':_0x5066ea(0x30b),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x216),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x290),'type':_0x5066ea(0x32a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x11f622['extendObjectAsync']('analysis.automation',{'type':_0x5066ea(0x17c),'common':{'name':_0x5066ea(0x1b2)},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x34f),{'type':'state','common':{'name':_0x5066ea(0x396),'type':_0x5066ea(0x227),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x11f622['setObjectNotExistsAsync'](_0x5066ea(0x31a),{'type':'state','common':{'name':_0x5066ea(0x1ce),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x1fa),{'type':_0x5066ea(0x230),'common':{'name':'Action','type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x29f),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x339),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x34b),{'type':_0x5066ea(0x230),'common':{'name':'Target\x20Value','type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x2eb),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x2d9),'type':'boolean','role':_0x5066ea(0x211),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x345),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x2e4),'type':_0x5066ea(0x227),'role':_0x5066ea(0x258),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x229),{'type':'state','common':{'name':'Logbook','type':_0x5066ea(0x32a),'role':_0x5066ea(0x1d4),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x11f622[_0x5066ea(0x244)]('analysis.feedbackHistory',{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x1a6),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x1d4),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x11f622[_0x5066ea(0x302)]('analysis.health',{'type':_0x5066ea(0x17c),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x22f),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x304),'type':'number','role':_0x5066ea(0x169),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x2cf),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x337),'type':_0x5066ea(0x32a),'role':'text','read':!![],'write':![],'def':_0x5066ea(0x34d)},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x30f),{'type':'state','common':{'name':_0x5066ea(0x1ba),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x22a),'read':!![],'write':![],'def':''},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x22e),{'type':'state','common':{'name':'Trend\x20Diagnosis\x20(Python)','type':_0x5066ea(0x32a),'role':'text','read':!![],'write':![],'def':_0x5066ea(0x399)},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x1ea),{'type':_0x5066ea(0x230),'common':{'name':'Trend\x20Value\x20(%)','type':'number','role':'value','read':!![],'write':![],'def':0x0},'native':{}}),await _0x11f622['extendObjectAsync'](_0x5066ea(0x2e3),{'type':'channel','common':{'name':_0x5066ea(0x32b)},'native':{}}),await _0x11f622[_0x5066ea(0x244)]('LTM.trainingData.sequences',{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x329),'type':_0x5066ea(0x32a),'role':_0x5066ea(0x1d4),'read':!![],'write':![],'def':'[]','desc':_0x5066ea(0x2bb)},'native':{}}),await _0x11f622[_0x5066ea(0x244)](_0x5066ea(0x364),{'type':_0x5066ea(0x230),'common':{'name':_0x5066ea(0x22b),'type':'string','role':'json','read':!![],'write':![],'def':'[]','desc':_0x5066ea(0x19a)},'native':{}}),await checkLtmObjects(_0x11f622),await checkLtmDriftObjects(_0x11f622);}async function checkSystemObjects(_0x7917f9){const _0xfa5000=a0_0x47b847;await _0x7917f9['extendObjectAsync'](_0xfa5000(0x255),{'type':'channel','common':{'name':_0xfa5000(0x167)},'native':{}}),await _0x7917f9[_0xfa5000(0x302)](SYSTEM_DP_MODE,{'type':_0xfa5000(0x230),'common':{'name':_0xfa5000(0x1c9),'type':_0xfa5000(0x32a),'role':_0xfa5000(0x230),'read':!![],'write':!![],'def':SYSTEM_MODES[_0xfa5000(0x1f6)],'states':{[SYSTEM_MODES[_0xfa5000(0x1f6)]]:'Normal',[SYSTEM_MODES['VACATION']]:_0xfa5000(0x23e),[SYSTEM_MODES[_0xfa5000(0x220)]]:_0xfa5000(0x1e1),[SYSTEM_MODES[_0xfa5000(0x276)]]:_0xfa5000(0x310)}},'native':{}});}async function checkLtmObjects(_0x45efaa){const _0x436dbc=a0_0x47b847;await _0x45efaa[_0x436dbc(0x302)](_0x436dbc(0x2c5),{'type':_0x436dbc(0x17c),'common':{'name':'LTM'},'native':{}}),await _0x45efaa['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x436dbc(0x1da),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x45efaa[_0x436dbc(0x302)](LTM_DP_DAILY_DIGESTS,{'type':_0x436dbc(0x230),'common':{'name':_0x436dbc(0x357),'type':_0x436dbc(0x32a),'role':'json','read':!![],'write':![]},'native':{}}),await _0x45efaa[_0x436dbc(0x302)](LTM_DP_STATUS,{'type':_0x436dbc(0x230),'common':{'name':_0x436dbc(0x2c4),'type':'string','role':_0x436dbc(0x22a),'read':!![],'write':![]},'native':{}}),await _0x45efaa[_0x436dbc(0x302)](LTM_DP_TRIGGER_DIGEST,{'type':_0x436dbc(0x230),'common':{'name':'Trigger\x20Digest','type':_0x436dbc(0x227),'role':_0x436dbc(0x258),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x45efaa['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x436dbc(0x230),'common':{'name':'Baseline\x20Status','type':_0x436dbc(0x32a),'role':_0x436dbc(0x22a),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4f32c2){const _0x240a76=a0_0x47b847;await _0x4f32c2[_0x240a76(0x302)](LTM_DP_DRIFT_CHANNEL,{'type':_0x240a76(0x17c),'common':{'name':_0x240a76(0x316)},'native':{}}),await _0x4f32c2['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x240a76(0x230),'common':{'name':_0x240a76(0x1ed),'type':'string','role':_0x240a76(0x230),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x4f32c2['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x240a76(0x230),'common':{'name':'Drift\x20Details','type':_0x240a76(0x32a),'role':_0x240a76(0x22a),'read':!![],'write':![]},'native':{}}),await _0x4f32c2[_0x240a76(0x302)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x240a76(0x230),'common':{'name':_0x240a76(0x24a),'type':_0x240a76(0x19c),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x4efa05){const _0x3deabd=a0_0x47b847;try{const _0x4ce252=await _0x4efa05[_0x3deabd(0x368)](SYSTEM_DP_MODE);_0x4ce252&&_0x4ce252[_0x3deabd(0x35d)]&&Object['values'](SYSTEM_MODES)[_0x3deabd(0x2a4)](_0x4ce252[_0x3deabd(0x35d)])?_0x4efa05[_0x3deabd(0x168)]=_0x4ce252[_0x3deabd(0x35d)]:(_0x4efa05[_0x3deabd(0x168)]=SYSTEM_MODES[_0x3deabd(0x1f6)],await _0x4efa05[_0x3deabd(0x1bb)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3deabd(0x1f6)],'ack':!![]}));}catch(_0x4c7b0a){_0x4efa05[_0x3deabd(0x168)]=SYSTEM_MODES[_0x3deabd(0x1f6)];}}async function loadRawEventLog(_0x394129){const _0x3491a4=a0_0x47b847;try{const _0x2521f6=await _0x394129[_0x3491a4(0x368)](LTM_DP_RAW_LOG);if(_0x2521f6&&_0x2521f6[_0x3491a4(0x35d)])_0x394129[_0x3491a4(0x1b6)]=JSON[_0x3491a4(0x365)](_0x2521f6[_0x3491a4(0x35d)]);}catch(_0x41ac13){_0x394129[_0x3491a4(0x1b6)]=[];}}async function saveRawEventLog(_0x9a0f18){const _0x5ef224=a0_0x47b847;_0x9a0f18[_0x5ef224(0x1b6)][_0x5ef224(0x2da)]>RAW_LOG_MAX_SIZE&&_0x9a0f18['rawEventLog']['splice'](0x0,_0x9a0f18[_0x5ef224(0x1b6)]['length']-RAW_LOG_MAX_SIZE),await _0x9a0f18['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x5ef224(0x17e)](_0x9a0f18[_0x5ef224(0x1b6)]),'ack':!![]});}async function loadDailyDigests(_0x1f89a3){const _0x3a5dcc=a0_0x47b847;try{const _0x409658=await _0x1f89a3[_0x3a5dcc(0x368)](LTM_DP_DAILY_DIGESTS);if(_0x409658&&_0x409658[_0x3a5dcc(0x35d)])_0x1f89a3[_0x3a5dcc(0x2b5)]=JSON[_0x3a5dcc(0x365)](_0x409658['val']);}catch(_0x3a6208){_0x1f89a3[_0x3a5dcc(0x2b5)]=[];}await updateBaselineStatus(_0x1f89a3);}async function saveDailyDigests(_0x29cceb,_0x37018d=!![]){const _0x2a99d0=a0_0x47b847,_0x39cef4=_0x29cceb[_0x2a99d0(0x278)][_0x2a99d0(0x375)]||0x3c;_0x29cceb[_0x2a99d0(0x2b5)][_0x2a99d0(0x2da)]>_0x39cef4&&_0x29cceb[_0x2a99d0(0x2b5)]['splice'](0x0,_0x29cceb[_0x2a99d0(0x2b5)][_0x2a99d0(0x2da)]-_0x39cef4);await _0x29cceb['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2a99d0(0x17e)](_0x29cceb[_0x2a99d0(0x2b5)]),'ack':!![]});if(_0x37018d)await updateBaselineStatus(_0x29cceb);}async function updateAnalysisHistory(_0x4513a7,_0x424456){const _0x8c1158=a0_0x47b847;_0x4513a7[_0x8c1158(0x207)][_0x8c1158(0x275)](_0x424456);if(_0x4513a7[_0x8c1158(0x207)][_0x8c1158(0x2da)]>ANALYSIS_HISTORY_MAX_SIZE)_0x4513a7[_0x8c1158(0x207)]['pop']();await _0x4513a7[_0x8c1158(0x1bb)](_0x8c1158(0x229),{'val':JSON[_0x8c1158(0x17e)](_0x4513a7[_0x8c1158(0x207)]),'ack':!![]});}async function updateBaselineStatus(_0x43b7c6){const _0x30fd9f=a0_0x47b847;if(!_0x43b7c6[_0x30fd9f(0x2ac)]){await _0x43b7c6['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x30fd9f(0x2b1),'ack':!![]});return;}const _0x17bdb8=_0x43b7c6[_0x30fd9f(0x2b5)][_0x30fd9f(0x2da)]>=(_0x43b7c6[_0x30fd9f(0x278)][_0x30fd9f(0x271)]||0x7)?_0x30fd9f(0x2f4)+_0x43b7c6[_0x30fd9f(0x2b5)][_0x30fd9f(0x2da)]+'\x20Tage)':'Lernphase\x20('+_0x43b7c6[_0x30fd9f(0x2b5)][_0x30fd9f(0x2da)]+'/'+(_0x43b7c6[_0x30fd9f(0x278)]['minDaysForBaseline']||0x7)+')';await _0x43b7c6[_0x30fd9f(0x1bb)](LTM_DP_BASELINE_STATUS,{'val':_0x17bdb8,'ack':!![]});}async function initSensorSubscriptions(_0x35b0eb){const _0x2db733=a0_0x47b847,_0x12610f=_0x35b0eb[_0x2db733(0x278)][_0x2db733(0x277)];if(_0x12610f&&_0x12610f[_0x2db733(0x2da)]>0x0){_0x35b0eb[_0x2db733(0x342)][_0x2db733(0x1b9)]('Subscribing\x20to\x20'+_0x12610f[_0x2db733(0x2da)]+_0x2db733(0x165));for(const _0x3ef477 of _0x12610f){if(_0x3ef477['id']){await _0x35b0eb[_0x2db733(0x221)](_0x3ef477['id']);try{const _0xa82e68=await _0x35b0eb[_0x2db733(0x2f5)](_0x3ef477['id']);if(_0xa82e68)_0x35b0eb[_0x2db733(0x21f)][_0x3ef477['id']]=_0xa82e68[_0x2db733(0x35d)];}catch(_0x375a0b){}}}}}async function initPresenceSubscriptions(_0x4c0971){const _0x3bbd8a=a0_0x47b847,_0x44e47e=_0x4c0971[_0x3bbd8a(0x278)][_0x3bbd8a(0x359)]||[];if(_0x44e47e['length']>0x0){_0x4c0971[_0x3bbd8a(0x342)][_0x3bbd8a(0x1b9)]('Subscribing\x20to\x20'+_0x44e47e['length']+_0x3bbd8a(0x1c7));for(const _0x1f0220 of _0x44e47e){await _0x4c0971['subscribeForeignStatesAsync'](_0x1f0220);}try{await checkWifiPresence(_0x4c0971);}catch(_0x2867e3){}}}async function getWeatherContext(_0x23aa92){const _0x249252=a0_0x47b847;try{if(!_0x23aa92[_0x249252(0x278)]['useWeather'])return _0x249252(0x286);let _0x40460f='';const _0x86f9a1=_0x23aa92[_0x249252(0x278)][_0x249252(0x1e0)];if(_0x86f9a1)try{if(_0x86f9a1[_0x249252(0x2a4)]('accuweather')){const _0x5229c6=await _0x23aa92['getForeignStateAsync'](_0x86f9a1+_0x249252(0x372));if(_0x5229c6&&_0x5229c6[_0x249252(0x35d)])_0x40460f=_0x5229c6['val'];}else{if(_0x86f9a1[_0x249252(0x2a4)](_0x249252(0x1ad))){const _0x3ce2b2=await _0x23aa92[_0x249252(0x2f5)](_0x86f9a1+_0x249252(0x37a));if(_0x3ce2b2&&_0x3ce2b2[_0x249252(0x35d)])_0x40460f=_0x3ce2b2[_0x249252(0x35d)];}else{if(_0x86f9a1[_0x249252(0x2a4)](_0x249252(0x2c2))){const _0x71ca8a=await _0x23aa92[_0x249252(0x2f5)](_0x86f9a1+_0x249252(0x1b4));if(_0x71ca8a&&_0x71ca8a[_0x249252(0x35d)])_0x40460f=_0x71ca8a[_0x249252(0x35d)];}}}}catch(_0x53d7c5){}if(!_0x40460f){const _0xefc097=[_0x249252(0x225),_0x249252(0x163),_0x249252(0x1cc),_0x249252(0x358)];for(const _0x5e19b0 of _0xefc097){try{const _0x13e430=await _0x23aa92['getForeignObjectAsync'](_0x5e19b0);if(_0x13e430){if(_0x5e19b0['includes']('accuweather')){const _0x430693=await _0x23aa92['getForeignStateAsync'](_0x5e19b0+_0x249252(0x372));if(_0x430693&&_0x430693[_0x249252(0x35d)]){_0x40460f=_0x430693[_0x249252(0x35d)];break;}}}}catch(_0x1981ba){}}}return _0x40460f?_0x249252(0x2de)+_0x40460f:_0x249252(0x2b4);}catch(_0x5300d7){return'WETTER\x20ERROR:\x20'+_0x5300d7['message'];}}async function getCalendarContext(_0x543e1b){const _0xfe0b22=a0_0x47b847;try{if(!_0x543e1b[_0xfe0b22(0x278)]['useCalendar'])return'Kalender:\x20Deaktiviert';let _0xbd346d=_0x543e1b['config'][_0xfe0b22(0x321)]||'ical.0',_0x1ae391=_0x543e1b[_0xfe0b22(0x278)][_0xfe0b22(0x233)]||[];if(typeof _0x1ae391===_0xfe0b22(0x32a))_0x1ae391=_0x1ae391[_0xfe0b22(0x332)](',');try{const _0x2a24d1=await _0x543e1b['getForeignStateAsync'](_0xbd346d+_0xfe0b22(0x1ab));if(_0x2a24d1&&_0x2a24d1[_0xfe0b22(0x35d)]){let _0x357f5e=tryParse(_0x2a24d1[_0xfe0b22(0x35d)]);if(_0x357f5e&&Array[_0xfe0b22(0x17f)](_0x357f5e)){if(_0x1ae391[_0xfe0b22(0x2da)]>0x0)_0x357f5e=_0x357f5e[_0xfe0b22(0x38c)](_0x14eee1=>_0x1ae391[_0xfe0b22(0x2a4)](_0x14eee1['_calName']||''));else return _0xfe0b22(0x241);if(_0x357f5e[_0xfe0b22(0x2da)]>0x0){const _0x249814=_0x357f5e[_0xfe0b22(0x1a1)](0x0,0x3)[_0xfe0b22(0x2e1)](_0x442efe=>{const _0x22b5ce=_0xfe0b22;let _0x59e208=_0x442efe['date'];if(_0x442efe[_0x22b5ce(0x2a3)])_0x59e208+='\x20'+_0x442efe['time'];return _0x59e208+':\x20'+_0x442efe[_0x22b5ce(0x323)]+'\x20('+_0x442efe['_calName']+')';});return _0xfe0b22(0x36b)+_0x249814[_0xfe0b22(0x2cb)]('\x20|\x20');}else return _0xfe0b22(0x1e9);}}}catch(_0x1914ff){_0x543e1b[_0xfe0b22(0x342)][_0xfe0b22(0x35a)](_0xfe0b22(0x1e6)+_0x1914ff[_0xfe0b22(0x1b8)]);}return _0xfe0b22(0x268);}catch(_0x2cb87f){return _0xfe0b22(0x1fd)+_0x2cb87f[_0xfe0b22(0x1b8)];}}async function getCalendarNames(_0x11e5c3,_0x3aeab5){const _0x337b52=a0_0x47b847;try{const _0x53fd04=await _0x11e5c3['getForeignStateAsync'](_0x3aeab5+_0x337b52(0x1ab));if(_0x53fd04&&_0x53fd04[_0x337b52(0x35d)]){const _0x9f8658=tryParse(_0x53fd04[_0x337b52(0x35d)]);if(_0x9f8658&&Array[_0x337b52(0x17f)](_0x9f8658)){const _0x105792=[...new Set(_0x9f8658[_0x337b52(0x2e1)](_0x445401=>_0x445401[_0x337b52(0x33d)])[_0x337b52(0x38c)](Boolean))];return _0x105792[_0x337b52(0x38a)]();}}return[];}catch(_0x5ddeb1){return _0x11e5c3[_0x337b52(0x342)][_0x337b52(0x2ef)](_0x337b52(0x369)+_0x5ddeb1[_0x337b52(0x1b8)]),[];}}async function checkWifiPresence(_0x2c2870){const _0x23b3fc=a0_0x47b847;try{const _0xeeffe0=_0x2c2870['config'][_0x23b3fc(0x359)]||[];let _0x3f8c93=![];const _0x134a64=[];for(const _0x5e8582 of _0xeeffe0){try{const _0x27b7e1=await _0x2c2870[_0x23b3fc(0x2f5)](_0x5e8582);if(_0x27b7e1&&(_0x27b7e1[_0x23b3fc(0x35d)]===!![]||_0x27b7e1[_0x23b3fc(0x35d)]==='online'||_0x27b7e1[_0x23b3fc(0x35d)]===0x1)){_0x3f8c93=!![];const _0x2646f4=await _0x2c2870[_0x23b3fc(0x256)](_0x5e8582);let _0x5402e3=_0x5e8582;_0x2646f4&&_0x2646f4[_0x23b3fc(0x325)]&&_0x2646f4[_0x23b3fc(0x325)][_0x23b3fc(0x324)]&&(_0x5402e3=typeof _0x2646f4[_0x23b3fc(0x325)][_0x23b3fc(0x324)]===_0x23b3fc(0x262)?_0x2646f4[_0x23b3fc(0x325)]['name']['de']||_0x2646f4[_0x23b3fc(0x325)][_0x23b3fc(0x324)]['en']:_0x2646f4[_0x23b3fc(0x325)][_0x23b3fc(0x324)]),_0x134a64[_0x23b3fc(0x2f7)](_0x5402e3);}}catch(_0x28764b){}}return await _0x2c2870[_0x23b3fc(0x1bb)](_0x23b3fc(0x293),{'val':_0x134a64[_0x23b3fc(0x2cb)](',\x20'),'ack':!![]}),_0x3f8c93&&(_0x2c2870['exitTimer']&&(_0x2c2870[_0x23b3fc(0x342)][_0x23b3fc(0x1b9)](_0x23b3fc(0x253)),abortExitTimer(_0x2c2870)),!_0x2c2870[_0x23b3fc(0x26f)]&&_0x2c2870[_0x23b3fc(0x168)]===SYSTEM_MODES[_0x23b3fc(0x1f6)]&&await setPresence(_0x2c2870,!![])),_0x3f8c93;}catch(_0x321b5c){return _0x2c2870[_0x23b3fc(0x342)][_0x23b3fc(0x2ef)](_0x23b3fc(0x25a)+_0x321b5c[_0x23b3fc(0x1b8)]),![];}}function startExitTimer(_0x1a6c2b){const _0x515fc4=a0_0x47b847;abortExitTimer(_0x1a6c2b),_0x1a6c2b['isGracePeriodActive']=!![],_0x1a6c2b[_0x515fc4(0x16d)]=setTimeout(()=>{const _0x1f64cb=_0x515fc4;_0x1a6c2b[_0x1f64cb(0x1f0)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x1a6c2b[_0x515fc4(0x1be)]=setTimeout(()=>{const _0x36aecf=_0x515fc4;setPresence(_0x1a6c2b,![]),_0x1a6c2b[_0x36aecf(0x1be)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x33d280){const _0x5f01a4=a0_0x47b847;if(_0x33d280[_0x5f01a4(0x1be)])clearTimeout(_0x33d280[_0x5f01a4(0x1be)]);if(_0x33d280[_0x5f01a4(0x16d)])clearTimeout(_0x33d280[_0x5f01a4(0x16d)]);_0x33d280[_0x5f01a4(0x1be)]=null,_0x33d280[_0x5f01a4(0x16d)]=null,_0x33d280['isGracePeriodActive']=![];}async function setPresence(_0x52e03f,_0x5c23d7){const _0x30b99f=a0_0x47b847;if(_0x52e03f[_0x30b99f(0x26f)]===_0x5c23d7)return;_0x52e03f[_0x30b99f(0x26f)]=_0x5c23d7,await _0x52e03f[_0x30b99f(0x1bb)](_0x30b99f(0x363),{'val':_0x5c23d7,'ack':!![]});}async function saveFeedback(_0x54e129,_0x3bf267){const _0x6ea8c9=a0_0x47b847;_0x54e129[_0x6ea8c9(0x342)][_0x6ea8c9(0x1b9)](_0x6ea8c9(0x25d)+JSON[_0x6ea8c9(0x17e)](_0x3bf267));}function a0_0x2a11(){const _0x2221db=['Drift\x20Status','.\x20OUTPUT:\x20Nur\x20Text.','service.py','isGracePeriodActive','Drift\x20Sched\x20Error:\x20','analysis.isEmergency','round','vis.','sleepScore','NORMAL','Error\x20reading\x20outdoor\x20sensor\x20','isExit','livingContext','analysis.automation.suggestedAction','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','licenseKey','KALENDER\x20ERROR:\x20','LTM.trainingData.sequences','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','dismissAutomation','bind','light','Fehler:\x20','window','toLowerCase','indicator.alarm','analysisHistory','toISOString','generateContent','PRO-','setForeignStateAsync','1080hENwxi','testNotification','‚úÖ\x20Alles\x20OK\x20(Reset)]','python_service','COGNI_REQUEST_CALL','switch','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','üìû\x20R√ºckruf\x20anfordern','Deviation','‚úÖ\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20','analysis.comfortSuggestion','693774dBQyrY','lights','trim','cogni-living\x20adapter\x20starting\x20(v','system.config','LTM.triggerDailyDigest',').\x20Saving\x20to\x20Training\x20Data.','update','sensorLastValues','PARTY','subscribeForeignStatesAsync','inactivityThresholdHours','209iixHwZ','\x20(Length:\x20','accuweather.0','Keine\x20Details.','boolean','No\x20training\x20sequences\x20found.','analysis.analysisHistory','text','Thermodynamic\x20Data\x20Points','analysis.activitySummary','power','analysis.health.trendDiagnosis','analysis.health.sleepScore','state','.NextHours.Location_1.Day_1.current.temp_value','blind','calendarSelection','temp','.\x20ZUSATZ:\x20','Exit\x20Sensor\x20triggered\x20(','driftDetails','Generating\x20Morning\x20Briefing...','rollladen','catch','setHours','systemUUID','Fokus\x20auf\x20Familienroutinen.','Urlaub','temperature','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','unreach','setObjectNotExistsAsync','t√ºr','toString','response','getLtmData','find','Last\x20Check','Training\x20started...','analysis.isAlert','briefingJob','latitude','selectedFunctionIds','PONG','LTM.baselineStatus','activityLevel','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','details','system','getForeignObjectAsync','admin.','button','\x22\x20--break-system-packages\x20--user','Error\x20checking\x20WiFi:\x20','Unknown\x20error','actual_temperature','Feedback\x20saved:\x20','triggerDailyDigest','Bibliotheken\x20nicht\x20gefunden','\x22\x20--break-system-packages','getMonth','object','(((.+)+)+)+$','pr√§senz','expire','[TEST]\x20','Event\x20History','KALENDER:\x20Keine\x20Daten','getDate','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','No\x20instance','...','unknown','onReady','isPresent','genAI','minDaysForBaseline','No\x20module\x20named\x20pip','targetValue','firmware','unshift','GUEST','devices','config','substring','ANALYZE_SEQUENCE','analysis.trigger','temperatur','logDuplicates','thermostat','\x20events','data','üåÖ\x20Daily\x20Briefing:\x0a','system.mode','delObjectAsync','.\x0a\x20\x20\x20\x20WETTER:\x20','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','Wetter:\x20Deaktiviert','health','custom','Anwesend','outdoorSensorId','[RESULT]','TRAIN_SECURITY','events.history','replace','from','Comfort\x20Suggestion','version','onMessage','system.presenceWho','.forecast.current.temperature','onUnload','enum.rooms.*','PRIORIT√ÑT:\x20Sicherheit.','Idle','scriptProblem','Last\x20Result','LTM.driftAnalysis','humidity','30WTDNtc','energy','analysis.automation.targetId','‚ùå\x20Training\x20failed:\x20','Success:\x20','\x20(Value:\x20','time','includes','unload','send','inactivityMonitoringEnabled','kill','isEmergency','instance','notifyTelegramInstance','isProVersion','brightness','COGNI_CONFIRM_OK','telegram','getGenerativeModel','Deaktiviert\x20(Pro-Feature)','baselineDrift','close','WETTER:\x20Keine\x20Daten\x20gefunden','dailyDigests','analysis.training.status','sendTo','‚ö†Ô∏è\x20ALARM:\x20','Started\x20at\x20','getFullYear','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','namespace','.forecast.current.temp','direction','analysis.training.triggerSecurity','analysis.deviationFromBaseline','Alert\x20Reason','openweathermap','pop','Processing\x20Status','LTM','‚ùå\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20','üß™\x20Simulating\x20Butler\x20Proposal:\x20','payload','child_process','constructor','join','analysis.training','valve','428828RGhNOV','analysis.health.restlessness','command','Activity\x20Summary','generic','heizung','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','[LOG]','events.history_debug_00','08:00','189vgmdBm','Auto\x20Apply\x20Rule','length','0\x204\x20*\x20*\x20*','toLocaleTimeString','maintenance','WETTER:\x20','geminiApiKey','ANALYZE_TREND','map','Unbekannt','LTM.trainingData','Trigger\x20Action\x20Now','Verbindung\x20erfolgreich!\x20Antwort:\x20','Could\x20not\x20kill\x20Python\x20process:\x20','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','[PYTHON]\x20','653946vQwsSc','python3\x20-m\x20pip\x20install\x20-r\x20\x22','analysis.automation.autoApply','Keiner','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','fault','error','Alarm','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','Live\x20Security\x20Monitor','forEach','Aktiv\x20(','getForeignStateAsync','\x20*\x20*\x20*','push','fill','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','scriptEnabled','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','getHours','‚ùå\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.','alertReason','AI\x20Training\x20Control','city','enum.functions.*','extendObjectAsync','dependencyInstallInProgress','Sleep\x20Score\x20(0-100)','rssi','analysis.triggerBriefing','‚úÖ\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','toFixed','members','Error\x20launching\x20Python\x20service:\x20','Comfort\x20Summary','status','position','type','analysis.health.notes','Gast','autoApply','models/gemini-flash-latest','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','@iobroker/adapter-core','scheduleJob','Drift\x20Analysis','stdin','notifyPushoverRecipient','driftAnalysisTimer','analysis.automation.description','native','value','Training\x20Status','modeResetJob','summary','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','calendarInstance','automationProposal','event','name','common','setState','lampe','üêç\x20Guardian\x20Diagnosis\x20(','Recorded\x20Motion\x20Sequences','string','Training\x20Data\x20Sets','timestamp','analysis.security','841500tHoMpL','dutycycle','shift','onStateChange','split','scanDevices','sendToAsync','analysisTimer','‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.','Restlessness\x20Level','accuweather','Target\x20ID','Keine\x20Analyse.','‚úÖ\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','values','_calName','BUTLER\x20Execution\x20Error:\x20','VACATION','Say\x20Hello','\x20events)...','log','systemConfig','cover','analysis.automation.triggerAction','\x20days\x20of\x20activity\x20data\x20to\x20Python...','feedbackHistory','occupancy','aiPersona','uuid-not-found','analysis.automation.targetValue','N/A\x20(Learning)','none','write','analysis.automation.patternDetected','notifyTelegramRecipient','loc','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','uuid-error','callback','search','üö®\x20EMERGENCY','Daily\x20Digests','openweathermap.0','presenceDevices','warn','Morning\x20Briefing\x20sent.','setpoint','val','off','Vom\x20Benutzer\x20best√§tigt\x20(OK).','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','Skipped\x20(No\x20AI\x20or\x20Data)','getEnums','system.isPresent','LTM.trainingData.thermodynamics','parse','\x27\x20not\x20in\x20allowed\x20list)','indexOf','getStateAsync','getCalendarNames\x20Error:\x20','üêç\x20Starting\x20Python\x20Sidecar:\x20','KALENDER:\x20','stderr','link_quality',').\x20Starting\x20Timer.','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','geminiModel','.Summary.Current','retry','üß†\x20Triggering\x20Security\x20Training\x20with\x20','ltmLtbWindowDays','\x20=\x20','notifyTelegramEnabled','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','üõ°Ô∏è\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','.NextHours.Location_1.Day_1.current.symbol_desc','Kein\x20API\x20Key!','getTime','AI\x20Alert\x20Status','ltmStbWindowDays','LTM.processingStatus','Analysiere\x20ausgewogen.','analysis.security.lastCheck','eventHistory','1256tlyvbQ','shutter','ltmDriftCheckIntervalHours','presence','Success:\x20Compressed\x20','.\x20Welcome\x20home.','LTM.dailyDigests','sort','siren','filter','analysis.comfortSummary','toLocaleString','Ungew√∂hnliches\x20Bewegungsmuster\x20erkannt!\x20(Score:\x20','lastAlertState','startsWith','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','vacation','getOverviewData','text.alarm','Pattern\x20Detected','now','ltmJob','N/A','daswetter.0','Error\x20in\x20onMessage\x20command\x20','\x20sensors...',')\x20->\x20','System\x20Status\x20&\x20Control','currentSystemMode','value.health','notifyPushoverInstance','Last\x20Anomaly\x20Score','üêç\x20Stopping\x20Python\x20Sidecar...','exitGraceTimer','lastCheck','cancel','stick_unreach','useWeather','LTM\x20Sched\x20Error:\x20','35609znIjJg','history.','icons-mfd.','\x20(Threshold:\x20','lastIndexOf','ack','isAlert','1529310sVCGjh','fenster','channel','stateChange','stringify','isArray','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','analysis.security.lastScore','‚ö†Ô∏è\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','klima','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','info.','events.lastEvent','TEST-PRO-KEY','bewegung','Briefing\x20Error:\x20','.communicate.request','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','analysisInterval','Adapter','Train\x20Security\x20Model\x20(LSTM)','writable','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','level','lock','.\x20DATEN:\x20Schlaf\x20','location','system.meta.uuid','ABWESEND','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','licht','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','Error:\x20','number','triggerBriefing','subscribeStates','Training\x20only\x20available\x20in\x20Pro\x20Version.','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','slice','SECURITY_RESULT','0\x203\x20*\x20*\x20*','Who\x20is\x20present?','\x20for\x20interactive\x20buttons...','Feedback\x20Log','enum','notifyEmailInstance','path','door','.data.table','cogni-living','daswetter','Invalid\x20JSON\x20from\x20Python:\x20','motion','apiKey','requirements.txt','Automation\x20Proposals','some','.forecast.current.state','\x0aSTB:\x20','rawEventLog','sensor','message','info','Health\x20Notes','setStateAsync','debug','\x20min).','exitTimer','Unknown','[RECORDER]\x20Error\x20saving\x20sequence:\x20','lowbat','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','getForeignObjectsAsync','pythonProcess','KI-Modell\x20nicht\x20initialisiert','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','\x20presence\x20devices...','_score','System\x20Mode','detected','dimmer','weatherunderground.0','\x20sequences...','Description','endsWith','description','analysis.alertReason','):\x20','Last\x20raw\x20event','json','[PYTHON\x20ERR]\x20','analysis.lastResult','uuid','getCalendarNames','PRIORIT√ÑT:\x20Gesundheit/AAL.','Raw\x20Log','Failed:\x20','targetId','No\x20module\x20named','\x20(Type\x20\x27','application/json','weatherInstance','Party','testApiKey','notifyEmailEnabled','briefingEnabled','longitude','Error\x20reading\x20calendar\x20table:\x20','Gemini\x20Init\x20Error:\x20','Fokus\x20auf\x20Komfort.','KALENDER:\x20Keine\x20relevanten\x20Termine','analysis.health.trendValue','ANOMALY','simulateButler'];a0_0x2a11=function(){return _0x2221db;};return a0_0x2a11();}async function runBaselineDriftAnalysis(_0x118cae){const _0x329d91=a0_0x47b847;if(!_0x118cae[_0x329d91(0x2ac)]||!_0x118cae[_0x329d91(0x371)])return;const _0x190901=_0x118cae[_0x329d91(0x278)]['ltmStbWindowDays']||0xe;if(_0x118cae['dailyDigests'][_0x329d91(0x2da)]<_0x190901+(_0x118cae[_0x329d91(0x278)][_0x329d91(0x271)]||0x7)){await _0x118cae[_0x329d91(0x1bb)](LTM_DP_DRIFT_STATUS,{'val':_0x329d91(0x34c),'ack':!![]});return;}const _0x3bd715=_0x118cae[_0x329d91(0x2b5)][_0x329d91(0x1a1)](-_0x190901),_0x2e2966=_0x118cae['dailyDigests'][_0x329d91(0x1a1)](0x0,_0x118cae['dailyDigests'][_0x329d91(0x2da)]-_0x190901),_0x18b77a=_0x329d91(0x352)+JSON['stringify'](_0x2e2966)+_0x329d91(0x1b5)+JSON[_0x329d91(0x17e)](_0x3bd715);try{const _0x59a91e=await _0x118cae[_0x329d91(0x371)][_0x329d91(0x209)](_0x18b77a),_0x188c6b=JSON[_0x329d91(0x365)](_0x59a91e['response']['text']()[_0x329d91(0x28e)](/```json|```/g,'')['trim']());_0x188c6b[_0x329d91(0x2b2)]&&(await _0x118cae['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x188c6b[_0x329d91(0x2b2)],'ack':!![]}),await _0x118cae[_0x329d91(0x1bb)](LTM_DP_DRIFT_DETAILS,{'val':_0x188c6b[_0x329d91(0x237)],'ack':!![]}),await _0x118cae[_0x329d91(0x1bb)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x430178){}}function setupLtmScheduler(_0x4772b0){const _0x13b3c1=a0_0x47b847;try{if(_0x4772b0[_0x13b3c1(0x398)])_0x4772b0[_0x13b3c1(0x398)][_0x13b3c1(0x16f)]();if(!_0x4772b0['isProVersion']){_0x4772b0[_0x13b3c1(0x1bb)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x4772b0[_0x13b3c1(0x398)]=schedule[_0x13b3c1(0x315)](LTM_SCHEDULE,()=>createDailyDigest(_0x4772b0));}catch(_0x522a9e){_0x4772b0['log'][_0x13b3c1(0x2ef)](_0x13b3c1(0x172)+_0x522a9e['message']);}}function setupModeResetScheduler(_0x342280){const _0x26a9bd=a0_0x47b847;try{if(_0x342280['modeResetJob'])_0x342280[_0x26a9bd(0x31e)][_0x26a9bd(0x16f)]();_0x342280[_0x26a9bd(0x31e)]=schedule[_0x26a9bd(0x315)](MODE_RESET_SCHEDULE,async()=>{const _0xb7d129=_0x26a9bd;await loadSystemMode(_0x342280),AUTO_RESET_MODES[_0xb7d129(0x2a4)](_0x342280[_0xb7d129(0x168)])&&await _0x342280[_0xb7d129(0x1bb)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0xb7d129(0x1f6)],'ack':![]});});}catch(_0x3c3bfa){_0x342280[_0x26a9bd(0x342)][_0x26a9bd(0x2ef)]('Reset\x20Sched\x20Error:\x20'+_0x3c3bfa['message']);}}function setupDriftAnalysisScheduler(_0x2f32a0){const _0x5d0b0a=a0_0x47b847;try{if(_0x2f32a0[_0x5d0b0a(0x319)])clearInterval(_0x2f32a0[_0x5d0b0a(0x319)]);if(!_0x2f32a0[_0x5d0b0a(0x2ac)])return;_0x2f32a0[_0x5d0b0a(0x319)]=setInterval(()=>runBaselineDriftAnalysis(_0x2f32a0),(_0x2f32a0[_0x5d0b0a(0x278)][_0x5d0b0a(0x385)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x2f32a0),0x1388);}catch(_0x2979f0){_0x2f32a0['log']['error'](_0x5d0b0a(0x1f1)+_0x2979f0['message']);}}function setupBriefingScheduler(_0x1c25a9){const _0x4a8fe2=a0_0x47b847;try{if(_0x1c25a9[_0x4a8fe2(0x24d)])_0x1c25a9[_0x4a8fe2(0x24d)][_0x4a8fe2(0x16f)]();if(!_0x1c25a9[_0x4a8fe2(0x278)][_0x4a8fe2(0x1e4)])return;const _0x2e5657=(_0x1c25a9[_0x4a8fe2(0x278)]['briefingTime']||_0x4a8fe2(0x2d7))['split'](':'),_0x138f06=parseInt(_0x2e5657[0x0])||0x8,_0x38f270=parseInt(_0x2e5657[0x1])||0x0,_0x3c8419=_0x38f270+'\x20'+_0x138f06+_0x4a8fe2(0x2f6);_0x1c25a9['log'][_0x4a8fe2(0x1b9)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x138f06+':'+(_0x38f270<0xa?'0'+_0x38f270:_0x38f270)),_0x1c25a9[_0x4a8fe2(0x24d)]=schedule[_0x4a8fe2(0x315)](_0x3c8419,()=>{sendMorningBriefing(_0x1c25a9);});}catch(_0x5ba113){_0x1c25a9[_0x4a8fe2(0x342)][_0x4a8fe2(0x2ef)]('Briefing\x20Sched\x20Error:\x20'+_0x5ba113[_0x4a8fe2(0x1b8)]);}}async function sendNotification(_0x44ef09,_0x13b970,_0x1dca36=![],_0x2141b4=![]){const _0x19db75=a0_0x47b847;_0x44ef09[_0x19db75(0x342)][_0x19db75(0x1b9)]((_0x1dca36?_0x19db75(0x266):'')+'Sending\x20notification:\x20\x22'+_0x13b970+'\x22');const _0x55da43=_0x44ef09[_0x19db75(0x278)];let _0x5603b9=0x0;if(_0x55da43[_0x19db75(0x377)]){let _0x27c284={};(_0x13b970[_0x19db75(0x2a4)](_0x19db75(0x2f0))||_0x2141b4)&&(_0x27c284={'reply_markup':{'inline_keyboard':[[{'text':_0x19db75(0x20e),'callback_data':_0x19db75(0x2ae)}],[{'text':_0x19db75(0x213),'callback_data':_0x19db75(0x210)}]]}}),await _0x44ef09[_0x19db75(0x334)](_0x55da43['notifyTelegramInstance'],'send',{'text':_0x13b970,'user':_0x55da43[_0x19db75(0x350)],..._0x27c284}),_0x5603b9++;}if(_0x55da43['notifyPushoverEnabled']){let _0x2bf0f2={'message':_0x13b970,'title':_0x2141b4?_0x19db75(0x356):'Cogni-Living','priority':_0x2141b4?0x2:0x1,'device':_0x55da43[_0x19db75(0x318)]};_0x2141b4&&(_0x2bf0f2[_0x19db75(0x373)]=0x1e,_0x2bf0f2[_0x19db75(0x265)]=0xe10,_0x2bf0f2['sound']=_0x19db75(0x38b)),await _0x44ef09[_0x19db75(0x334)](_0x55da43[_0x19db75(0x16a)],_0x19db75(0x2a6),_0x2bf0f2),_0x5603b9++;}return _0x55da43[_0x19db75(0x1e3)]&&(await _0x44ef09[_0x19db75(0x334)](_0x55da43[_0x19db75(0x1a8)],_0x19db75(0x2a6),{'text':_0x13b970,'to':_0x55da43['notifyEmailRecipient']}),_0x5603b9++),_0x5603b9;}async function setupTelegramListener(_0x5a8beb){const _0x78e0d3=a0_0x47b847,_0x11401c=_0x5a8beb['config'][_0x78e0d3(0x2ab)];_0x5a8beb[_0x78e0d3(0x278)]['notifyTelegramEnabled']&&_0x11401c&&(_0x5a8beb['log'][_0x78e0d3(0x1b9)]('üì°\x20Hooking\x20into\x20'+_0x11401c+_0x78e0d3(0x1a5)),await _0x5a8beb[_0x78e0d3(0x221)](_0x11401c+_0x78e0d3(0x18b)));}async function handleTelegramResponse(_0x4f185e,_0x10955c){const _0x5a7b3c=a0_0x47b847;let _0x5afc36=_0x10955c;_0x10955c[_0x5a7b3c(0x391)]('[')&&(_0x5afc36=_0x10955c['substring'](_0x10955c[_0x5a7b3c(0x367)](']')+0x1));if(_0x5afc36===_0x5a7b3c(0x2ae))_0x4f185e[_0x5a7b3c(0x342)]['info'](_0x5a7b3c(0x183)),await _0x4f185e[_0x5a7b3c(0x1bb)](_0x5a7b3c(0x24c),{'val':![],'ack':!![]}),await _0x4f185e[_0x5a7b3c(0x1bb)]('analysis.alertReason',{'val':_0x5a7b3c(0x35f),'ack':!![]}),_0x4f185e['lastAlertState']=![],sendNotification(_0x4f185e,'‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x5afc36===_0x5a7b3c(0x210)&&(_0x4f185e[_0x5a7b3c(0x342)][_0x5a7b3c(0x35a)](_0x5a7b3c(0x1c2)),sendNotification(_0x4f185e,_0x5a7b3c(0x1ff),![],!![]));}async function runAutopilot(_0x459c4f){const _0x1c5af8=a0_0x47b847,_0x5ba2e5=_0x459c4f[_0x1c5af8(0x278)][_0x1c5af8(0x222)],_0xc2125a=_0x459c4f[_0x1c5af8(0x382)]['length']>0x0?_0x459c4f['eventHistory'][0x0]['timestamp']:Date[_0x1c5af8(0x397)](),_0x3216be=(Date['now']()-_0xc2125a)/(0x3e8*0x3c*0x3c);let _0x1a2681='';_0x459c4f[_0x1c5af8(0x278)][_0x1c5af8(0x2a7)]&&_0x459c4f['currentSystemMode']===SYSTEM_MODES['NORMAL']&&_0x459c4f[_0x1c5af8(0x26f)]&&(_0x3216be>_0x5ba2e5&&(_0x1a2681='HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0x3216be[_0x1c5af8(0x308)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0x459c4f,_0x1a2681)[_0x1c5af8(0x23a)](_0x5ba87e=>_0x459c4f[_0x1c5af8(0x342)][_0x1c5af8(0x2ef)](_0x5ba87e));}async function createDailyDigest(_0x1f1918){const _0x212437=a0_0x47b847;if(!_0x1f1918[_0x212437(0x2ac)])return;await _0x1f1918[_0x212437(0x1bb)](LTM_DP_STATUS,{'val':_0x212437(0x2b9)+new Date()[_0x212437(0x38e)](),'ack':!![]});if(!_0x1f1918['geminiModel']||_0x1f1918['rawEventLog'][_0x212437(0x2da)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1f1918[_0x212437(0x1bb)](LTM_DP_STATUS,{'val':_0x212437(0x361),'ack':!![]});return;}const _0x5cad02=JSON[_0x212437(0x365)](JSON['stringify'](_0x1f1918[_0x212437(0x1b6)])),_0x17b000=_0x5cad02[_0x212437(0x2da)],_0x2cd78f='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON['stringify'](_0x5cad02);try{const _0x10c113=await _0x1f1918['geminiModel']['generateContent'](_0x2cd78f),_0xa5d926=JSON['parse'](_0x10c113[_0x212437(0x247)][_0x212437(0x22a)]()[_0x212437(0x28e)](/```json|```/g,'')[_0x212437(0x219)]());_0xa5d926[_0x212437(0x31f)]&&(_0x1f1918[_0x212437(0x2b5)][_0x212437(0x2f7)]({'timestamp':new Date()[_0x212437(0x208)](),'eventCount':_0x17b000,'summary':_0xa5d926[_0x212437(0x31f)],'activityLevel':_0xa5d926[_0x212437(0x252)],'systemMode':_0x1f1918['currentSystemMode']}),await saveDailyDigests(_0x1f1918),_0x1f1918[_0x212437(0x1b6)]=[],await saveRawEventLog(_0x1f1918),await _0x1f1918[_0x212437(0x1bb)](LTM_DP_STATUS,{'val':_0x212437(0x387)+_0x17b000+_0x212437(0x27f),'ack':!![]}),runPythonHealthCheck(_0x1f1918));}catch(_0x383caf){await _0x1f1918[_0x212437(0x1bb)](LTM_DP_STATUS,{'val':_0x212437(0x19b)+_0x383caf[_0x212437(0x1b8)],'ack':!![]});}}async function sendMorningBriefing(_0x17a5dc){const _0x6e4fad=a0_0x47b847;if(!_0x17a5dc['geminiModel'])return;_0x17a5dc['log']['info'](_0x6e4fad(0x238));const _0x189a1d=_0x17a5dc[_0x6e4fad(0x2b5)][_0x6e4fad(0x2da)]>0x0?_0x17a5dc[_0x6e4fad(0x2b5)][_0x17a5dc[_0x6e4fad(0x2b5)][_0x6e4fad(0x2da)]-0x1]:null,_0x4b5853=_0x189a1d&&_0x189a1d['health']?_0x189a1d[_0x6e4fad(0x287)][_0x6e4fad(0x1f5)]:_0x6e4fad(0x399),_0x196cb1=new Date();_0x196cb1[_0x6e4fad(0x23b)](0x4,0x0,0x0,0x0);const _0x3c6427=_0x17a5dc[_0x6e4fad(0x382)]['filter'](_0x1ffb64=>new Date(_0x1ffb64[_0x6e4fad(0x32c)])>_0x196cb1),_0x2d06cd=PERSONA_MAPPING[_0x17a5dc[_0x6e4fad(0x278)]['aiPersona']||_0x6e4fad(0x2d2)],_0x13da18=_0x17a5dc[_0x6e4fad(0x278)][_0x6e4fad(0x1f9)]||'',_0x27a55d=await getWeatherContext(_0x17a5dc),_0x36f592=await getCalendarContext(_0x17a5dc),_0x150cd4=_0x6e4fad(0x2f1)+_0x2d06cd+'.\x20KONTEXT:\x20'+_0x13da18+_0x6e4fad(0x235)+_0x27a55d+'\x20'+_0x36f592+_0x6e4fad(0x194)+_0x4b5853+_0x6e4fad(0x313)+JSON[_0x6e4fad(0x17e)](_0x3c6427[_0x6e4fad(0x1a1)](0x0,0xa))+_0x6e4fad(0x1ee);try{const _0x3de6b2=await _0x17a5dc[_0x6e4fad(0x371)]['generateContent'](_0x150cd4),_0x499b2e=_0x6e4fad(0x281)+_0x3de6b2[_0x6e4fad(0x247)][_0x6e4fad(0x22a)]()[_0x6e4fad(0x219)]();sendNotification(_0x17a5dc,_0x499b2e),_0x17a5dc[_0x6e4fad(0x342)][_0x6e4fad(0x1b9)](_0x6e4fad(0x35b));}catch(_0x281f43){_0x17a5dc[_0x6e4fad(0x342)]['error'](_0x6e4fad(0x18a)+_0x281f43[_0x6e4fad(0x1b8)]);}}async function scanForDevices(_0x86ec1b,_0x6addb1){const _0x5c8921=a0_0x47b847;_0x86ec1b['log']['info']('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x48cd4e=[],_0x1cca1b=await _0x86ec1b['getForeignObjectsAsync']('*'),_0x4e1079=await _0x86ec1b['getForeignObjectsAsync'](_0x5c8921(0x301),_0x5c8921(0x1a7)),_0x27aaea=await _0x86ec1b[_0x5c8921(0x1c3)](_0x5c8921(0x296),_0x5c8921(0x1a7)),_0x146975={};if(_0x4e1079)for(const _0x378a42 in _0x4e1079){const _0x175aef=_0x4e1079[_0x378a42][_0x5c8921(0x325)]['members']||[];_0x175aef[_0x5c8921(0x2f3)](_0x31a0b1=>{const _0x5a8321=_0x5c8921;if(!_0x146975[_0x31a0b1])_0x146975[_0x31a0b1]=[];_0x146975[_0x31a0b1][_0x5a8321(0x2f7)](_0x378a42);});}const _0x18532e={};if(_0x27aaea)for(const _0x372441 in _0x27aaea){const _0x1b1fb6=_0x27aaea[_0x372441][_0x5c8921(0x325)][_0x5c8921(0x309)]||[],_0x18d908=typeof _0x27aaea[_0x372441]['common'][_0x5c8921(0x324)]===_0x5c8921(0x262)?_0x27aaea[_0x372441][_0x5c8921(0x325)][_0x5c8921(0x324)]['de']:_0x27aaea[_0x372441][_0x5c8921(0x325)][_0x5c8921(0x324)];_0x1b1fb6[_0x5c8921(0x2f3)](_0x525b16=>_0x18532e[_0x525b16]=_0x18d908);}const _0x141635=_0x6addb1[_0x5c8921(0x24f)]||[],_0x15f4b8=_0x6addb1['motion']!==![],_0x557329=_0x6addb1['doors']!==![],_0x5c5a92=_0x6addb1[_0x5c8921(0x218)]!==![],_0x2d4df9=_0x6addb1[_0x5c8921(0x23f)]===!![],_0x1c7f6f=_0x6addb1['weather']===!![];for(const _0x4be5c2 in _0x1cca1b){const _0x50d80a=_0x1cca1b[_0x4be5c2];if(_0x50d80a[_0x5c8921(0x30e)]!==_0x5c8921(0x230)||!_0x50d80a[_0x5c8921(0x325)])continue;if(ADAPTER_BLACKLIST[_0x5c8921(0x1b3)](_0x1990cb=>_0x4be5c2[_0x5c8921(0x391)](_0x1990cb))&&!_0x1c7f6f)continue;const _0x4a93d2=(_0x50d80a[_0x5c8921(0x325)]['role']||'')[_0x5c8921(0x205)]();let _0x178b23=(typeof _0x50d80a['common'][_0x5c8921(0x324)]===_0x5c8921(0x262)?_0x50d80a[_0x5c8921(0x325)][_0x5c8921(0x324)]['de']:_0x50d80a['common'][_0x5c8921(0x324)])||_0x4be5c2;const _0x1ca1b7=_0x178b23[_0x5c8921(0x205)]();let _0x1206ed=![],_0x358d42=![];if(_0x141635['length']>0x0){const _0x316daf=_0x146975[_0x4be5c2]||[],_0x863221=_0x4be5c2[_0x5c8921(0x332)]('.')[_0x5c8921(0x1a1)](0x0,-0x1)[_0x5c8921(0x2cb)]('.'),_0x2e85ec=_0x146975[_0x863221]||[];(_0x316daf[_0x5c8921(0x1b3)](_0x3307eb=>_0x141635[_0x5c8921(0x2a4)](_0x3307eb))||_0x2e85ec[_0x5c8921(0x1b3)](_0x5e3534=>_0x141635['includes'](_0x5e3534)))&&(_0x1206ed=!![],_0x358d42=!![]);}if(!_0x1206ed&&!_0x1c7f6f){if(HARD_IGNORE_TERMS[_0x5c8921(0x1b3)](_0x325085=>_0x4be5c2[_0x5c8921(0x2a4)](_0x325085)||_0x1ca1b7[_0x5c8921(0x2a4)](_0x325085['toLowerCase']())))continue;}if(BAD_NAMES[_0x5c8921(0x1b3)](_0x20f5b5=>_0x1ca1b7===_0x20f5b5||_0x1ca1b7[_0x5c8921(0x1cf)]('.'+_0x20f5b5))){const _0x1ea90e=_0x4be5c2[_0x5c8921(0x332)]('.');if(_0x1ea90e[_0x5c8921(0x2da)]>0x2){const _0x5cc0aa=_0x1ea90e[_0x5c8921(0x1a1)](0x0,-0x1)['join']('.'),_0x1e1203=_0x1cca1b[_0x5cc0aa];if(_0x1e1203&&_0x1e1203[_0x5c8921(0x325)]&&_0x1e1203[_0x5c8921(0x325)]['name']){const _0x4c3d8e=typeof _0x1e1203['common']['name']===_0x5c8921(0x262)?_0x1e1203[_0x5c8921(0x325)][_0x5c8921(0x324)]['de']:_0x1e1203['common'][_0x5c8921(0x324)];_0x4c3d8e&&!_0x178b23[_0x5c8921(0x2a4)](_0x4c3d8e)&&(_0x178b23=_0x4c3d8e+'\x20'+_0x178b23);}}}let _0x296657='';if(_0x15f4b8&&(_0x4a93d2[_0x5c8921(0x2a4)]('motion')||_0x4a93d2[_0x5c8921(0x2a4)](_0x5c8921(0x348))||_0x1ca1b7[_0x5c8921(0x2a4)](_0x5c8921(0x189))||_0x1ca1b7[_0x5c8921(0x2a4)](_0x5c8921(0x264))))_0x296657=_0x5c8921(0x1af);else{if(!_0x296657&&_0x557329&&(_0x4a93d2[_0x5c8921(0x2a4)]('door')||_0x4a93d2['includes'](_0x5c8921(0x204))||_0x4a93d2[_0x5c8921(0x2a4)](_0x5c8921(0x193))||_0x4a93d2[_0x5c8921(0x2a4)](_0x5c8921(0x232))||_0x4a93d2[_0x5c8921(0x2a4)](_0x5c8921(0x384))||_0x1ca1b7[_0x5c8921(0x2a4)]('fenster')||_0x1ca1b7[_0x5c8921(0x2a4)](_0x5c8921(0x245))||_0x1ca1b7[_0x5c8921(0x2a4)](_0x5c8921(0x239))))_0x296657=_0x5c8921(0x1aa);else{if(!_0x296657&&_0x5c5a92&&(_0x4a93d2[_0x5c8921(0x2a4)]('light')||_0x4a93d2[_0x5c8921(0x2a4)](_0x5c8921(0x211))||_0x4a93d2[_0x5c8921(0x2a4)](_0x5c8921(0x1cb))||_0x1ca1b7[_0x5c8921(0x2a4)](_0x5c8921(0x199))||_0x1ca1b7[_0x5c8921(0x2a4)]('lampe')||_0x1ca1b7[_0x5c8921(0x2a4)]('schalter'))){if(_0x50d80a[_0x5c8921(0x325)][_0x5c8921(0x34e)]||_0x4a93d2['includes'](_0x5c8921(0x1b7)))_0x296657=_0x5c8921(0x202);}else{if(!_0x296657&&_0x2d4df9&&(_0x4a93d2[_0x5c8921(0x2a4)]('temperature')||_0x4a93d2['includes'](_0x5c8921(0x29c))||_0x4a93d2[_0x5c8921(0x2a4)](_0x5c8921(0x27e))||_0x1ca1b7['includes'](_0x5c8921(0x234))||_0x1ca1b7[_0x5c8921(0x2a4)](_0x5c8921(0x184))||_0x1ca1b7[_0x5c8921(0x2a4)](_0x5c8921(0x2d3))))_0x296657=_0x5c8921(0x23f);else{if(!_0x296657&&_0x358d42)_0x296657=_0x5c8921(0x288);}}}}if(_0x296657){let _0x50aee1=_0x18532e[_0x4be5c2]||'';if(!_0x50aee1){let _0xfd641d=_0x4be5c2;for(let _0xa9d59d=0x0;_0xa9d59d<0x3;_0xa9d59d++){const _0x120528=_0xfd641d[_0x5c8921(0x177)]('.');if(_0x120528===-0x1)break;_0xfd641d=_0xfd641d[_0x5c8921(0x279)](0x0,_0x120528);if(_0x18532e[_0xfd641d]){_0x50aee1=_0x18532e[_0xfd641d];break;}}}_0x48cd4e[_0x5c8921(0x2f7)]({'id':_0x4be5c2,'name':_0x178b23,'location':_0x50aee1,'type':_0x296657,'logDuplicates':_0x296657===_0x5c8921(0x1af),'isExit':![],'_score':_0x50aee1?0x50:_0x296657==='custom'?0x5a:0x28});}}return _0x48cd4e['sort']((_0x1efb72,_0x303f73)=>_0x303f73[_0x5c8921(0x1c8)]-_0x1efb72[_0x5c8921(0x1c8)]),_0x48cd4e;}async function executeAutomationAction(_0x3bd953){const _0x3cd1e9=a0_0x47b847;try{const _0x198126=await _0x3bd953[_0x3cd1e9(0x368)](_0x3cd1e9(0x29f)),_0x2a37cf=await _0x3bd953['getStateAsync'](_0x3cd1e9(0x34b));if(_0x198126&&_0x198126['val']&&_0x2a37cf){const _0x54d4b7=_0x198126[_0x3cd1e9(0x35d)];let _0x40fe35=_0x2a37cf[_0x3cd1e9(0x35d)];try{_0x40fe35=JSON[_0x3cd1e9(0x365)](_0x40fe35);}catch(_0x483cdf){}_0x3bd953['log'][_0x3cd1e9(0x1b9)]('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x54d4b7+_0x3cd1e9(0x376)+_0x40fe35),await _0x3bd953[_0x3cd1e9(0x20b)](_0x54d4b7,_0x40fe35);}else _0x3bd953['log'][_0x3cd1e9(0x35a)](_0x3cd1e9(0x2fb));}catch(_0x7b827){_0x3bd953['log'][_0x3cd1e9(0x2ef)](_0x3cd1e9(0x33e)+_0x7b827['message']);}}function tryParse(_0x414d0a){const _0x2d9e91=a0_0x47b847;try{return JSON[_0x2d9e91(0x365)](_0x414d0a);}catch(_0x396758){return null;}}async function recordSequence(_0x111556,_0x52772c){const _0x3e8da6=a0_0x47b847,_0x46f73f=(_0x52772c[_0x3e8da6(0x30e)]||'')['toLowerCase'](),_0x4d5dc5=[_0x3e8da6(0x1af),_0x3e8da6(0x189),_0x3e8da6(0x264),_0x3e8da6(0x386),'occupancy',_0x3e8da6(0x1aa),_0x3e8da6(0x245),'window',_0x3e8da6(0x17b),'contact','kontakt',_0x3e8da6(0x202),_0x3e8da6(0x199),'switch','schalter',_0x3e8da6(0x1cb),_0x3e8da6(0x327)];if(!_0x4d5dc5[_0x3e8da6(0x1b3)](_0xf3c806=>_0x46f73f[_0x3e8da6(0x2a4)](_0xf3c806))){_0x111556['log'][_0x3e8da6(0x1bc)](_0x3e8da6(0x392)+_0x52772c['id']+_0x3e8da6(0x1de)+_0x52772c['type']+_0x3e8da6(0x366));return;}if(!_0x52772c[_0x3e8da6(0x31c)]){_0x111556['log'][_0x3e8da6(0x1bc)]('[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20'+_0x52772c['id']+'\x20(Value\x20is\x20falsy:\x20'+_0x52772c[_0x3e8da6(0x31c)]+')');return;}_0x111556[_0x3e8da6(0x342)]['debug'](_0x3e8da6(0x1a0)+_0x52772c['id']+'\x20('+_0x52772c[_0x3e8da6(0x195)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x54c395={'loc':_0x52772c[_0x3e8da6(0x195)]||'Unknown','id':_0x52772c['id'],'ts':Date[_0x3e8da6(0x397)]()};activeSequence[_0x3e8da6(0x2f7)](_0x54c395),_0x111556['log'][_0x3e8da6(0x1bc)](_0x3e8da6(0x212)+_0x54c395[_0x3e8da6(0x351)]+_0x3e8da6(0x224)+activeSequence[_0x3e8da6(0x2da)]+')'),sequenceTimer=setTimeout(async()=>{const _0x29df9d=_0x3e8da6;activeSequence['length']>0x1?await saveCompletedSequence(_0x111556):(_0x111556[_0x29df9d(0x342)][_0x29df9d(0x1bc)](_0x29df9d(0x2d4)+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x3cef74){const _0x3f1105=a0_0x47b847;try{_0x3cef74[_0x3f1105(0x342)][_0x3f1105(0x1b9)](_0x3f1105(0x360)+activeSequence[_0x3f1105(0x2da)]+_0x3f1105(0x21d));const _0x508826=await _0x3cef74[_0x3f1105(0x368)](_0x3f1105(0x1fe));let _0x48a16a=[];if(_0x508826&&_0x508826[_0x3f1105(0x35d)])try{_0x48a16a=JSON[_0x3f1105(0x365)](_0x508826[_0x3f1105(0x35d)]);}catch(_0x5d2a2d){}const _0x1ea3f6=activeSequence[0x0]['ts'],_0x8d026d=activeSequence[_0x3f1105(0x2e1)](_0x28e63b=>({'loc':_0x28e63b[_0x3f1105(0x351)],'t_delta':Math[_0x3f1105(0x1f3)]((_0x28e63b['ts']-_0x1ea3f6)/0x3e8)})),_0x558cb5={'timestamp':new Date(_0x1ea3f6)['toISOString'](),'steps':_0x8d026d,'duration':Math[_0x3f1105(0x1f3)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x1ea3f6)/0x3e8),'daytime':new Date(_0x1ea3f6)['getHours']()};_0x48a16a[_0x3f1105(0x2f7)](_0x558cb5),_0x48a16a[_0x3f1105(0x2da)]>MAX_TRAINING_SET_SIZE&&_0x48a16a[_0x3f1105(0x330)](),await _0x3cef74[_0x3f1105(0x1bb)](_0x3f1105(0x1fe),{'val':JSON[_0x3f1105(0x17e)](_0x48a16a),'ack':!![]}),runSecurityCheck(_0x3cef74,_0x558cb5),activeSequence=[],sequenceTimer=null;}catch(_0x271fe7){_0x3cef74[_0x3f1105(0x342)][_0x3f1105(0x2ef)](_0x3f1105(0x1c0)+_0x271fe7['message']);}}function runSecurityCheck(_0x558183,_0x5675a7){const _0x5f3da5=a0_0x47b847;if(!_0x558183[_0x5f3da5(0x2ac)])return;_0x558183[_0x5f3da5(0x342)][_0x5f3da5(0x1bc)](_0x5f3da5(0x379)),sendToPython(_0x558183,_0x5f3da5(0x27a),{'sequence':_0x5675a7});}async function getOutsideTemperatureNumeric(_0x4c00a0){const _0x2e4424=a0_0x47b847;if(_0x4c00a0[_0x2e4424(0x278)]['outdoorSensorId'])try{const _0x4f4f87=await _0x4c00a0['getForeignStateAsync'](_0x4c00a0[_0x2e4424(0x278)][_0x2e4424(0x28a)]);if(_0x4f4f87&&_0x4f4f87[_0x2e4424(0x35d)]!==undefined&&_0x4f4f87[_0x2e4424(0x35d)]!==null){const _0x2a8fb4=parseFloat(_0x4f4f87[_0x2e4424(0x35d)]);if(!isNaN(_0x2a8fb4))return _0x2a8fb4;}}catch(_0x2fab90){_0x4c00a0[_0x2e4424(0x342)][_0x2e4424(0x35a)](_0x2e4424(0x1f7)+_0x4c00a0[_0x2e4424(0x278)][_0x2e4424(0x28a)]+':\x20'+_0x2fab90[_0x2e4424(0x1b8)]);}const _0x5b4416=_0x4c00a0[_0x2e4424(0x278)][_0x2e4424(0x1e0)];if(!_0x4c00a0[_0x2e4424(0x278)][_0x2e4424(0x171)]||!_0x5b4416)return null;try{let _0x2ee76b='';if(_0x5b4416[_0x2e4424(0x2a4)](_0x2e4424(0x338)))_0x2ee76b=_0x5b4416+'.Current.Temperature';else{if(_0x5b4416[_0x2e4424(0x2a4)](_0x2e4424(0x1ad)))_0x2ee76b=_0x5b4416+_0x2e4424(0x231);else{if(_0x5b4416[_0x2e4424(0x2a4)](_0x2e4424(0x2c2)))_0x2ee76b=_0x5b4416+_0x2e4424(0x294);else{if(_0x5b4416[_0x2e4424(0x2a4)]('weatherunderground'))_0x2ee76b=_0x5b4416+_0x2e4424(0x2bd);}}}if(_0x2ee76b){const _0x59c94c=await _0x4c00a0[_0x2e4424(0x2f5)](_0x2ee76b);if(_0x59c94c&&_0x59c94c['val']!==undefined&&_0x59c94c['val']!==null)return parseFloat(_0x59c94c['val']);}}catch(_0xe57713){}return null;}async function recordThermodynamics(_0xe86c4b,_0x48c738,_0x170988,_0x227776){const _0x7204e=a0_0x47b847,_0x54a76c=await getOutsideTemperatureNumeric(_0xe86c4b),_0x49f6dd=await _0xe86c4b['getStateAsync'](_0x7204e(0x364));let _0xb003e1=[];if(_0x49f6dd&&_0x49f6dd[_0x7204e(0x35d)])try{_0xb003e1=JSON[_0x7204e(0x365)](_0x49f6dd[_0x7204e(0x35d)]);}catch(_0x354857){}_0xb003e1[_0x7204e(0x2f7)]({'ts':Date['now'](),'room':_0x227776||_0x7204e(0x1bf),'t_in':_0x170988,'t_out':_0x54a76c});if(_0xb003e1['length']>THERMO_LOG_SIZE)_0xb003e1[_0x7204e(0x330)]();await _0xe86c4b[_0x7204e(0x1bb)]('LTM.trainingData.thermodynamics',{'val':JSON[_0x7204e(0x17e)](_0xb003e1),'ack':!![]});}async function processSensorEvent(_0x48e60e,_0x3d89ec,_0x22847b,_0x2be40d){const _0x530384=a0_0x47b847;if(!_0x2be40d)return;const _0x5a3e02=_0x22847b[_0x530384(0x35d)],_0x517ec4=Date[_0x530384(0x397)]();_0x48e60e['log']['debug']('Event\x20received:\x20'+_0x3d89ec+_0x530384(0x376)+_0x5a3e02);const _0x545cc5=_0x48e60e['sensorLastValues'][_0x3d89ec];_0x48e60e[_0x530384(0x21f)][_0x3d89ec]=_0x5a3e02;if(!_0x2be40d[_0x530384(0x27d)]&&_0x545cc5!=undefined&&_0x545cc5==_0x5a3e02){_0x48e60e[_0x530384(0x342)][_0x530384(0x1bc)]('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x2be40d['name']+_0x530384(0x2a2)+_0x5a3e02+')');return;}const _0x5af64e=(_0x2be40d['type']||'')[_0x530384(0x205)](),_0x26977a=_0x5af64e[_0x530384(0x2a4)]('temperature')||_0x5af64e[_0x530384(0x2a4)](_0x530384(0x27c))||_0x5af64e[_0x530384(0x2a4)](_0x530384(0x184))||_0x5af64e[_0x530384(0x2a4)](_0x530384(0x2d3));_0x48e60e[_0x530384(0x2ac)]&&_0x26977a&&recordThermodynamics(_0x48e60e,_0x3d89ec,_0x5a3e02,_0x2be40d[_0x530384(0x195)]);const _0xa4c72d={'timestamp':_0x517ec4,'id':_0x3d89ec,'name':_0x2be40d[_0x530384(0x324)],'type':_0x2be40d[_0x530384(0x30e)],'location':_0x2be40d[_0x530384(0x195)],'value':_0x5a3e02};_0x48e60e[_0x530384(0x382)][_0x530384(0x275)](_0xa4c72d);if(_0x48e60e['eventHistory'][_0x530384(0x2da)]>HISTORY_MAX_SIZE)_0x48e60e[_0x530384(0x382)][_0x530384(0x2c3)]();await _0x48e60e[_0x530384(0x1bb)]('events.lastEvent',{'val':JSON[_0x530384(0x17e)](_0xa4c72d),'ack':!![]}),await _0x48e60e[_0x530384(0x1bb)](_0x530384(0x28d),{'val':JSON[_0x530384(0x17e)](_0x48e60e[_0x530384(0x382)]),'ack':!![]});_0x48e60e['isProVersion']&&(_0x48e60e[_0x530384(0x1b6)][_0x530384(0x2f7)](_0xa4c72d),await saveRawEventLog(_0x48e60e),recordSequence(_0x48e60e,_0xa4c72d));if(_0x2be40d[_0x530384(0x1f8)]&&_0x5a3e02===!![]){if(_0x48e60e['isPresent']&&!_0x48e60e[_0x530384(0x1f0)])_0x48e60e[_0x530384(0x342)][_0x530384(0x1b9)](_0x530384(0x236)+_0x2be40d[_0x530384(0x324)]+_0x530384(0x36e)),startExitTimer(_0x48e60e);else!_0x48e60e[_0x530384(0x26f)]&&(_0x48e60e['log'][_0x530384(0x1b9)]('Entry\x20detected\x20via\x20'+_0x2be40d[_0x530384(0x324)]+_0x530384(0x388)),await setPresence(_0x48e60e,!![]));}else _0x2be40d[_0x530384(0x30e)]==='motion'&&_0x5a3e02===!![]&&(_0x48e60e[_0x530384(0x1be)]&&(_0x48e60e['log'][_0x530384(0x1b9)](_0x530384(0x26a)),abortExitTimer(_0x48e60e)),!_0x48e60e[_0x530384(0x26f)]&&_0x48e60e[_0x530384(0x168)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x48e60e,!![]));}async function runGeminiAnalysis(_0x45d346,_0x3a94de=''){const _0x454798=a0_0x47b847;if(!_0x45d346[_0x454798(0x371)])return;if(_0x45d346[_0x454798(0x382)]['length']===0x0)return;const _0x16526c=_0x45d346[_0x454798(0x382)][_0x454798(0x1a1)](0x0,0xf),_0x28bc09=await getWeatherContext(_0x45d346),_0x2638b3=_0x45d346[_0x454798(0x168)],_0x4fcf1a=PERSONA_MAPPING[_0x45d346['config'][_0x454798(0x349)]||_0x454798(0x2d2)],_0x4ebc7d=_0x45d346['config'][_0x454798(0x1f9)]||_0x454798(0x226);let _0x2c1925=_0x454798(0x2e2);try{const _0x41ea07=await _0x45d346[_0x454798(0x368)](_0x454798(0x293));if(_0x41ea07&&_0x41ea07['val'])_0x2c1925=_0x41ea07[_0x454798(0x35d)];}catch(_0x32eb9b){}let _0x14bf0f=![];try{const _0x48b2f7=await _0x45d346[_0x454798(0x368)](_0x454798(0x2eb));if(_0x48b2f7&&_0x48b2f7['val'])_0x14bf0f=!![];}catch(_0x19e771){}const _0x254e89=_0x454798(0x285)+_0x4fcf1a+'.\x0a\x20\x20\x20\x20KONTEXT:\x20'+_0x4ebc7d+_0x454798(0x370)+_0x2638b3+_0x454798(0x284)+_0x28bc09+_0x454798(0x180)+(_0x3a94de||_0x454798(0x2ec))+'.\x0a\x20\x20\x20\x20ANWESENHEITS_STATUS:\x20'+(_0x45d346[_0x454798(0x26f)]?_0x454798(0x289):_0x454798(0x197))+'.\x0a\x20\x20\x20\x20ANWESENDE_GERAETE:\x20'+_0x2c1925+_0x454798(0x320)+JSON[_0x454798(0x17e)](_0x16526c)+_0x454798(0x1fb);try{const _0x258573=await _0x45d346[_0x454798(0x371)][_0x454798(0x209)](_0x254e89),_0x470a5c=_0x258573[_0x454798(0x247)][_0x454798(0x22a)]()[_0x454798(0x28e)](/```json|```/g,'')[_0x454798(0x219)](),_0x2f74b4=JSON[_0x454798(0x365)](_0x470a5c);await _0x45d346[_0x454798(0x1bb)](_0x454798(0x1d6),{'val':JSON['stringify'](_0x2f74b4),'ack':!![]});_0x2f74b4[_0x454798(0x31f)]&&await _0x45d346[_0x454798(0x1bb)]('analysis.activitySummary',{'val':_0x2f74b4[_0x454798(0x31f)],'ack':!![]});const _0x6c9a5d={'timestamp':Date[_0x454798(0x397)](),'id':Date[_0x454798(0x397)]()[_0x454798(0x246)](),'analysis':{'activity':{'summary':_0x2f74b4[_0x454798(0x31f)]||_0x454798(0x33a),'isAlert':_0x2f74b4[_0x454798(0x179)]||![],'alertReason':_0x2f74b4['alertReason']},'comfort':{'automationProposal':_0x2f74b4[_0x454798(0x322)]}}};await updateAnalysisHistory(_0x45d346,_0x6c9a5d);const _0x147843=_0x2f74b4[_0x454798(0x179)]||![];_0x147843!==_0x45d346[_0x454798(0x390)]&&(await _0x45d346['setStateAsync'](_0x454798(0x24c),{'val':_0x147843,'ack':!![]}),_0x45d346[_0x454798(0x390)]=_0x147843,_0x147843&&(await _0x45d346['setStateAsync']('analysis.alertReason',{'val':_0x2f74b4[_0x454798(0x2fe)],'ack':!![]}),sendNotification(_0x45d346,_0x454798(0x2b8)+_0x2f74b4['alertReason'],![],_0x2f74b4[_0x454798(0x2a9)]))),_0x2f74b4[_0x454798(0x322)]&&_0x2f74b4[_0x454798(0x322)][_0x454798(0x1ca)]&&_0x2f74b4[_0x454798(0x322)][_0x454798(0x1dc)]&&(_0x45d346[_0x454798(0x342)][_0x454798(0x1b9)](_0x454798(0x191)+_0x2f74b4[_0x454798(0x322)][_0x454798(0x1d0)]),await _0x45d346[_0x454798(0x1bb)](_0x454798(0x34f),{'val':!![],'ack':!![]}),await _0x45d346[_0x454798(0x1bb)](_0x454798(0x31a),{'val':_0x2f74b4[_0x454798(0x322)][_0x454798(0x1d0)],'ack':!![]}),await _0x45d346[_0x454798(0x1bb)](_0x454798(0x29f),{'val':_0x2f74b4[_0x454798(0x322)]['targetId'],'ack':!![]}),await _0x45d346['setStateAsync'](_0x454798(0x34b),{'val':JSON[_0x454798(0x17e)](_0x2f74b4[_0x454798(0x322)]['targetValue']),'ack':!![]}),_0x14bf0f&&(_0x45d346[_0x454798(0x342)][_0x454798(0x1b9)](_0x454798(0x185)+_0x2f74b4[_0x454798(0x322)][_0x454798(0x1dc)]+_0x454798(0x26c)),await executeAutomationAction(_0x45d346)));}catch(_0x52b7d9){_0x45d346[_0x454798(0x342)][_0x454798(0x2ef)]('Gemini\x20Analysis\x20Error:\x20'+_0x52b7d9[_0x454798(0x1b8)]);}}function installPythonDependencies(_0xad566b){const _0xa91884=a0_0x47b847;if(_0xad566b['dependencyInstallInProgress'])return;_0xad566b[_0xa91884(0x303)]=!![];const _0x12ae8b=path[_0xa91884(0x2cb)](__dirname,'python_service',_0xa91884(0x1b1));_0xad566b[_0xa91884(0x342)][_0xa91884(0x1b9)](_0xa91884(0x2f9)+_0x12ae8b+_0xa91884(0x26c)),stopPythonService(_0xad566b);const _0x840476=_0xa91884(0x2ea)+_0x12ae8b+_0xa91884(0x260);exec(_0x840476,(_0x3cc51e,_0x53169b,_0x3bd4bc)=>{const _0x50b33d=_0xa91884,_0x2ebfc1=_0x3bd4bc&&_0x3bd4bc['includes'](_0x50b33d(0x272))||_0x3cc51e&&_0x3cc51e[_0x50b33d(0x1b8)][_0x50b33d(0x2a4)]('No\x20module\x20named\x20pip');if(_0x2ebfc1){_0xad566b[_0x50b33d(0x342)]['warn'](_0x50b33d(0x182)),exec(_0x50b33d(0x36f),(_0x3825bc,_0x78e502,_0x4d3721)=>{const _0x35ab6d=_0x50b33d;_0x3825bc?(_0xad566b[_0x35ab6d(0x342)]['error'](_0x35ab6d(0x2fd)),_0xad566b[_0x35ab6d(0x342)][_0x35ab6d(0x2ef)]('Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip'),_0xad566b['dependencyInstallInProgress']=![]):(_0xad566b[_0x35ab6d(0x342)]['info'](_0x35ab6d(0x33b)),exec(_0x35ab6d(0x2ea)+_0x12ae8b+_0x35ab6d(0x259),(_0x2d3b56,_0x1ca3b7,_0x539c10)=>{const _0x49678b=_0x35ab6d;_0x2d3b56?_0xad566b[_0x49678b(0x342)][_0x49678b(0x2ef)](_0x49678b(0x2c6)+_0x2d3b56[_0x49678b(0x1b8)]):(_0xad566b[_0x49678b(0x342)][_0x49678b(0x1b9)](_0x49678b(0x307)),startPythonService(_0xad566b)),_0xad566b['dependencyInstallInProgress']=![];}));});return;}_0xad566b[_0x50b33d(0x303)]=![],_0x3cc51e?(_0xad566b[_0x50b33d(0x342)][_0x50b33d(0x2ef)](_0x50b33d(0x336)),_0xad566b[_0x50b33d(0x342)][_0x50b33d(0x2ef)]('Details:\x20'+(_0x3bd4bc||_0x3cc51e[_0x50b33d(0x1b8)]))):(_0xad566b['log'][_0x50b33d(0x1b9)](_0x50b33d(0x378)),startPythonService(_0xad566b));});}function sendToPython(_0x5837d6,_0x179960,_0x5d02c2={}){const _0x466128=a0_0x47b847;if(!_0x5837d6[_0x466128(0x1c4)]||!_0x5837d6['pythonProcess']['stdin'][_0x466128(0x190)])return;const _0x2f1399=JSON[_0x466128(0x17e)]({'command':_0x179960,..._0x5d02c2});try{_0x5837d6[_0x466128(0x1c4)][_0x466128(0x317)][_0x466128(0x34e)](_0x2f1399+'\x0a');}catch(_0x3779e9){_0x5837d6['log']['error']('Failed\x20to\x20send\x20to\x20Python:\x20'+_0x3779e9[_0x466128(0x1b8)]);}}function runPythonHealthCheck(_0x1a989f){const _0x57cb79=a0_0x47b847;if(!_0x1a989f[_0x57cb79(0x2b5)]||_0x1a989f[_0x57cb79(0x2b5)][_0x57cb79(0x2da)]<0x2){_0x1a989f[_0x57cb79(0x342)][_0x57cb79(0x1b9)](_0x57cb79(0x18c));return;}const _0x4126e0=_0x1a989f[_0x57cb79(0x2b5)][_0x57cb79(0x2e1)](_0xff53d4=>{const _0xe68ae1=_0x57cb79,_0x26b6f7=(_0xff53d4[_0xe68ae1(0x252)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x26b6f7]||0x32;});_0x1a989f['log'][_0x57cb79(0x1b9)]('Guardian:\x20Sending\x20'+_0x4126e0[_0x57cb79(0x2da)]+_0x57cb79(0x346)),sendToPython(_0x1a989f,_0x57cb79(0x2e0),{'values':_0x4126e0,'tag':'Activity-Level'});}function handlePythonResult(_0x1667c8,_0x3e6958){const _0x4d8ada=a0_0x47b847;if(_0x3e6958['type']===_0x4d8ada(0x250))_0x1667c8[_0x4d8ada(0x342)][_0x4d8ada(0x1bc)]('üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.');else{if(_0x3e6958['type']==='TREND_RESULT'){const {tag:_0x5f0bfb,diagnosis:_0x3f7143,change_percent:_0x22820b}=_0x3e6958[_0x4d8ada(0x2c8)];_0x1667c8[_0x4d8ada(0x342)][_0x4d8ada(0x1b9)](_0x4d8ada(0x328)+_0x5f0bfb+_0x4d8ada(0x1d2)+_0x3f7143+'\x20('+_0x22820b+'%)'),_0x1667c8[_0x4d8ada(0x1bb)](_0x4d8ada(0x22e),{'val':_0x3f7143,'ack':!![]}),_0x1667c8[_0x4d8ada(0x1bb)](_0x4d8ada(0x1ea),{'val':_0x22820b,'ack':!![]});}else{if(_0x3e6958[_0x4d8ada(0x30e)]==='TRAINING_COMPLETE'){const {success:_0x2dd0e5,details:_0x58d329}=_0x3e6958[_0x4d8ada(0x2c8)];_0x2dd0e5?(_0x1667c8['log'][_0x4d8ada(0x1b9)](_0x4d8ada(0x215)+_0x58d329),_0x1667c8['setStateAsync'](_0x4d8ada(0x2b6),{'val':_0x4d8ada(0x2a1)+new Date()[_0x4d8ada(0x2dc)]()+'\x20('+_0x58d329+')','ack':!![]})):(_0x1667c8[_0x4d8ada(0x342)][_0x4d8ada(0x2ef)](_0x4d8ada(0x2a0)+(_0x58d329||_0x4d8ada(0x25b))),_0x1667c8[_0x4d8ada(0x1bb)](_0x4d8ada(0x2b6),{'val':_0x4d8ada(0x1db)+_0x58d329,'ack':!![]}));}else{if(_0x3e6958['type']===_0x4d8ada(0x1a2)){const {anomaly_score:_0x12dc97,is_anomaly:_0x2f2dee,threshold:_0x580600}=_0x3e6958[_0x4d8ada(0x2c8)];_0x1667c8[_0x4d8ada(0x342)][_0x4d8ada(0x1b9)](_0x4d8ada(0x198)+_0x12dc97[_0x4d8ada(0x308)](0x5)+_0x4d8ada(0x176)+_0x580600+_0x4d8ada(0x166)+(_0x2f2dee?_0x4d8ada(0x1eb):'OK')),_0x1667c8[_0x4d8ada(0x1bb)](_0x4d8ada(0x181),{'val':_0x12dc97,'ack':!![]}),_0x1667c8[_0x4d8ada(0x1bb)](_0x4d8ada(0x381),{'val':new Date()[_0x4d8ada(0x208)](),'ack':!![]});if(_0x2f2dee){const _0x49874b=_0x4d8ada(0x38f)+_0x12dc97[_0x4d8ada(0x308)](0x4)+')';_0x1667c8['setStateAsync'](_0x4d8ada(0x24c),{'val':!![],'ack':!![]}),_0x1667c8[_0x4d8ada(0x1bb)](_0x4d8ada(0x1d1),{'val':_0x49874b,'ack':!![]}),sendNotification(_0x1667c8,_0x4d8ada(0x240)+_0x49874b,![],!![]);}}}}}}function startPythonService(_0x1c6120){const _0x4c2105=a0_0x47b847;try{const _0x996122=path[_0x4c2105(0x2cb)](__dirname,_0x4c2105(0x20f),_0x4c2105(0x1ef));_0x1c6120[_0x4c2105(0x342)][_0x4c2105(0x1b9)](_0x4c2105(0x36a)+_0x996122),_0x1c6120[_0x4c2105(0x1c4)]=spawn('python3',[_0x996122]),_0x1c6120['pythonProcess']['stdout']['on'](_0x4c2105(0x280),_0x89b2f=>{const _0x5d11f8=_0x4c2105,_0x4c0656=_0x89b2f[_0x5d11f8(0x246)]()[_0x5d11f8(0x332)]('\x0a');_0x4c0656[_0x5d11f8(0x2f3)](_0x4e86e7=>{const _0x570824=_0x5d11f8,_0x50b3e4=_0x4e86e7[_0x570824(0x219)]();if(!_0x50b3e4)return;if(_0x50b3e4[_0x570824(0x391)](_0x570824(0x2d5)))_0x1c6120[_0x570824(0x342)][_0x570824(0x1bc)](_0x570824(0x2e8)+_0x50b3e4[_0x570824(0x279)](0x5)[_0x570824(0x219)]());else{if(_0x50b3e4[_0x570824(0x391)](_0x570824(0x28b)))try{const _0x1376bd=JSON[_0x570824(0x365)](_0x50b3e4[_0x570824(0x279)](0x8)[_0x570824(0x219)]());handlePythonResult(_0x1c6120,_0x1376bd);}catch(_0xcbcb91){_0x1c6120[_0x570824(0x342)][_0x570824(0x35a)](_0x570824(0x1ae)+_0x50b3e4);}}(_0x50b3e4[_0x570824(0x2a4)](_0x570824(0x1dd))||_0x50b3e4[_0x570824(0x2a4)](_0x570824(0x25f))||_0x50b3e4['includes']('ML-Libs\x20fehlen'))&&(_0x1c6120['log'][_0x570824(0x35a)](_0x570824(0x2ed)),installPythonDependencies(_0x1c6120));});}),_0x1c6120[_0x4c2105(0x1c4)][_0x4c2105(0x36c)]['on']('data',_0x558a82=>{const _0x247cfc=_0x4c2105,_0x2d7b95=_0x558a82[_0x247cfc(0x246)]()['trim']();_0x1c6120['log'][_0x247cfc(0x2ef)](_0x247cfc(0x1d5)+_0x2d7b95);}),_0x1c6120[_0x4c2105(0x1c4)]['on'](_0x4c2105(0x2b3),_0x1318b1=>{const _0x5103d0=_0x4c2105;_0x1c6120[_0x5103d0(0x342)][_0x5103d0(0x1b9)](_0x5103d0(0x2e7)+_0x1318b1),_0x1c6120[_0x5103d0(0x1c4)]=null;}),_0x1c6120[_0x4c2105(0x1c4)]['on'](_0x4c2105(0x2ef),_0x46703f=>{const _0x219e66=_0x4c2105;_0x1c6120[_0x219e66(0x342)]['warn']('[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20'+_0x46703f['message']);});}catch(_0x4d9602){_0x1c6120[_0x4c2105(0x342)][_0x4c2105(0x2ef)](_0x4c2105(0x30a)+_0x4d9602[_0x4c2105(0x1b8)]);}}function stopPythonService(_0x1963cf){const _0x3f1bd0=a0_0x47b847;if(_0x1963cf[_0x3f1bd0(0x1c4)]){_0x1963cf[_0x3f1bd0(0x342)][_0x3f1bd0(0x1b9)](_0x3f1bd0(0x16c));try{_0x1963cf[_0x3f1bd0(0x1c4)][_0x3f1bd0(0x2a8)]();}catch(_0x15c80f){_0x1963cf[_0x3f1bd0(0x342)]['warn'](_0x3f1bd0(0x2e6)+_0x15c80f[_0x3f1bd0(0x1b8)]);}_0x1963cf[_0x3f1bd0(0x1c4)]=null;}}class CogniLiving extends utils[a0_0x47b847(0x18e)]{constructor(_0x324530){const _0x597fbb=a0_0x47b847;super({..._0x324530,'name':_0x597fbb(0x1ac)}),this[_0x597fbb(0x382)]=[],this['analysisHistory']=[],this[_0x597fbb(0x347)]=[],this['rawEventLog']=[],this[_0x597fbb(0x2b5)]=[],this[_0x597fbb(0x21f)]={},this[_0x597fbb(0x343)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x597fbb(0x26f)]=!![],this[_0x597fbb(0x1be)]=null,this[_0x597fbb(0x16d)]=null,this[_0x597fbb(0x1f0)]=![],this[_0x597fbb(0x270)]=null,this[_0x597fbb(0x371)]=null,this[_0x597fbb(0x168)]=SYSTEM_MODES['NORMAL'],this['isProVersion']=![],this[_0x597fbb(0x390)]=![],this[_0x597fbb(0x23c)]=_0x597fbb(0x26d),this[_0x597fbb(0x335)]=null,this[_0x597fbb(0x398)]=null,this[_0x597fbb(0x31e)]=null,this[_0x597fbb(0x319)]=null,this['briefingJob']=null,this[_0x597fbb(0x1c4)]=null,this[_0x597fbb(0x303)]=![],this['on']('ready',this[_0x597fbb(0x26e)][_0x597fbb(0x201)](this)),this['on'](_0x597fbb(0x17d),this[_0x597fbb(0x331)]['bind'](this)),this['on'](_0x597fbb(0x2a5),this[_0x597fbb(0x295)][_0x597fbb(0x201)](this)),this['on'](_0x597fbb(0x1b8),this[_0x597fbb(0x292)][_0x597fbb(0x201)](this));}async['onReady'](){const _0x2c0e40=a0_0x47b847;this[_0x2c0e40(0x342)][_0x2c0e40(0x1b9)](_0x2c0e40(0x21a)+this[_0x2c0e40(0x291)]+_0x2c0e40(0x242)),await initZombies(this),this[_0x2c0e40(0x278)]['licenseKey']=this[_0x2c0e40(0x278)][_0x2c0e40(0x1fc)]||'';try{this[_0x2c0e40(0x2ac)]=await checkLicense(this,this[_0x2c0e40(0x278)]['licenseKey']);}catch(_0x31bee0){}if(!this[_0x2c0e40(0x278)][_0x2c0e40(0x222)]||this[_0x2c0e40(0x278)][_0x2c0e40(0x222)]<0.1)this[_0x2c0e40(0x278)][_0x2c0e40(0x222)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x2c0e40(0x278)][_0x2c0e40(0x2df)])try{this['genAI']=new GoogleGenerativeAI(this[_0x2c0e40(0x278)][_0x2c0e40(0x2df)]),this['geminiModel']=this['genAI'][_0x2c0e40(0x2b0)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2c0e40(0x1df)}}),this[_0x2c0e40(0x342)]['info']('Gemini\x20AI\x20initialized.');}catch(_0x3d7dd2){this[_0x2c0e40(0x342)][_0x2c0e40(0x2ef)](_0x2c0e40(0x1e7)+_0x3d7dd2[_0x2c0e40(0x1b8)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates'](_0x2c0e40(0x27b)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x2c0e40(0x19e)](_0x2c0e40(0x282)),this[_0x2c0e40(0x19e)](_0x2c0e40(0x306)),this[_0x2c0e40(0x19e)](_0x2c0e40(0x345)),this[_0x2c0e40(0x19e)](_0x2c0e40(0x2eb)),this[_0x2c0e40(0x19e)](_0x2c0e40(0x2bf)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x2c0e40(0x335)])clearInterval(this[_0x2c0e40(0x335)]);const _0x2dde0e=this[_0x2c0e40(0x278)][_0x2c0e40(0x18d)]||0xf;_0x2dde0e>0x0&&(this[_0x2c0e40(0x342)][_0x2c0e40(0x1b9)]('Starting\x20Autopilot\x20('+_0x2dde0e+_0x2c0e40(0x1bd)),this[_0x2c0e40(0x335)]=setInterval(()=>{runAutopilot(this);},_0x2dde0e*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x255c22=_0x2c0e40;this[_0x255c22(0x1c4)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x47b847(0x295)](_0x475f13){const _0x41f410=a0_0x47b847;if(this[_0x41f410(0x335)])clearInterval(this['analysisTimer']);if(this[_0x41f410(0x319)])clearInterval(this[_0x41f410(0x319)]);if(this[_0x41f410(0x398)])this[_0x41f410(0x398)][_0x41f410(0x16f)]();if(this[_0x41f410(0x31e)])this[_0x41f410(0x31e)][_0x41f410(0x16f)]();if(this['briefingJob'])this[_0x41f410(0x24d)][_0x41f410(0x16f)]();if(this[_0x41f410(0x1be)])clearTimeout(this[_0x41f410(0x1be)]);if(this[_0x41f410(0x16d)])clearTimeout(this[_0x41f410(0x16d)]);stopPythonService(this),_0x475f13();}async[a0_0x47b847(0x331)](_0xbba377,_0x570a7f){const _0xb34989=a0_0x47b847;if(!_0x570a7f)return;if(_0xbba377[_0xb34989(0x2a4)](_0xb34989(0x2af))&&_0xbba377[_0xb34989(0x1cf)]('communicate.request')&&_0x570a7f[_0xb34989(0x35d)]){await handleTelegramResponse(this,_0x570a7f['val']);return;}if(_0xbba377===this[_0xb34989(0x2bc)]+'.'+SYSTEM_DP_MODE){_0x570a7f[_0xb34989(0x35d)]&&Object[_0xb34989(0x33c)](SYSTEM_MODES)[_0xb34989(0x2a4)](_0x570a7f[_0xb34989(0x35d)])&&(this[_0xb34989(0x168)]=_0x570a7f[_0xb34989(0x35d)],_0x570a7f[_0xb34989(0x35d)]===SYSTEM_MODES[_0xb34989(0x33f)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x570a7f[_0xb34989(0x178)])this[_0xb34989(0x326)](_0xbba377,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x570a7f[_0xb34989(0x178)]){_0xbba377[_0xb34989(0x2a4)](_0xb34989(0x27b))&&_0x570a7f[_0xb34989(0x35d)]&&(this[_0xb34989(0x326)](_0xbba377,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0xbba377[_0xb34989(0x2a4)](_0xb34989(0x25e))&&_0x570a7f['val']){this[_0xb34989(0x326)](_0xbba377,{'val':![],'ack':!![]});if(this[_0xb34989(0x2ac)])createDailyDigest(this);}_0xbba377[_0xb34989(0x2a4)](_0xb34989(0x19d))&&_0x570a7f['val']&&(this[_0xb34989(0x326)](_0xbba377,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0xbba377['includes']('automation.triggerAction')&&_0x570a7f[_0xb34989(0x35d)]&&(this[_0xb34989(0x326)](_0xbba377,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0xbba377[_0xb34989(0x2a4)]('analysis.training.triggerSecurity')&&_0x570a7f[_0xb34989(0x35d)]){this[_0xb34989(0x326)](_0xbba377,{'val':![],'ack':!![]});if(!this[_0xb34989(0x2ac)]){this[_0xb34989(0x342)]['warn'](_0xb34989(0x19f));return;}try{const _0x4e001d=await this['getStateAsync'](_0xb34989(0x1fe));if(_0x4e001d&&_0x4e001d[_0xb34989(0x35d)]){const _0x3cd3ac=JSON[_0xb34989(0x365)](_0x4e001d[_0xb34989(0x35d)]);this[_0xb34989(0x342)]['info'](_0xb34989(0x374)+_0x3cd3ac[_0xb34989(0x2da)]+_0xb34989(0x1cd)),this[_0xb34989(0x1bb)](_0xb34989(0x2b6),{'val':_0xb34989(0x24b),'ack':!![]}),sendToPython(this,_0xb34989(0x28c),{'sequences':_0x3cd3ac});}else this['log']['warn'](_0xb34989(0x228)),this[_0xb34989(0x1bb)](_0xb34989(0x2b6),{'val':'No\x20Data','ack':!![]});}catch(_0x1863ee){this['log'][_0xb34989(0x2ef)]('Training\x20Error:\x20'+_0x1863ee[_0xb34989(0x1b8)]);}}return;}if(this['config'][_0xb34989(0x359)]&&this[_0xb34989(0x278)]['presenceDevices'][_0xb34989(0x2a4)](_0xbba377)){await checkWifiPresence(this);return;}const _0x17e290=(this['config'][_0xb34989(0x277)]||[])[_0xb34989(0x249)](_0xe9b6a4=>_0xe9b6a4['id']===_0xbba377);if(_0x17e290)processSensorEvent(this,_0xbba377,_0x570a7f,_0x17e290);}async[a0_0x47b847(0x292)](_0x5b6311){const _0x5b6c4d=a0_0x47b847;if(typeof _0x5b6311===_0x5b6c4d(0x262)&&_0x5b6311[_0x5b6c4d(0x1b8)])try{if(_0x5b6311[_0x5b6c4d(0x2d0)]===_0x5b6c4d(0x1e2)){const _0x4202af=_0x5b6311[_0x5b6c4d(0x1b8)][_0x5b6c4d(0x1b0)]||this[_0x5b6c4d(0x278)]['geminiApiKey'];if(!_0x4202af)return this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':![],'message':'Kein\x20API\x20Key\x20eingegeben.'},_0x5b6311[_0x5b6c4d(0x354)]);try{const _0x415c5e=new GoogleGenerativeAI(_0x4202af),_0x55b2ee=_0x415c5e[_0x5b6c4d(0x2b0)]({'model':GEMINI_MODEL}),_0x598020=await _0x55b2ee[_0x5b6c4d(0x209)](_0x5b6c4d(0x340)),_0x130023=await _0x598020[_0x5b6c4d(0x247)],_0x36ac36=_0x130023['text']();this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311['command'],{'success':!![],'message':_0x5b6c4d(0x2e5)+_0x36ac36['substring'](0x0,0x14)+'...'},_0x5b6311[_0x5b6c4d(0x354)]);}catch(_0x3f357f){this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':![],'message':_0x5b6c4d(0x203)+_0x3f357f['message']},_0x5b6311[_0x5b6c4d(0x354)]);}}else{if(_0x5b6311['command']==='testContext'){const _0x26581b=await getWeatherContext(this),_0xa8ba42=await getCalendarContext(this);this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':!![],'weather':_0x26581b,'calendar':_0xa8ba42},_0x5b6311[_0x5b6c4d(0x354)]);}else{if(_0x5b6311['command']===_0x5b6c4d(0x20d)){}else{if(_0x5b6311[_0x5b6c4d(0x2d0)]===_0x5b6c4d(0x248)){if(!this[_0x5b6c4d(0x2ac)])return this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311['command'],{'success':![],'isPro':![]},_0x5b6311[_0x5b6c4d(0x354)]);let _0x3071c6={'status':'N/A','details':'','lastCheck':0x0};try{_0x3071c6[_0x5b6c4d(0x30c)]=(await this[_0x5b6c4d(0x368)](LTM_DP_DRIFT_STATUS))[_0x5b6c4d(0x35d)],_0x3071c6[_0x5b6c4d(0x254)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x5b6c4d(0x35d)],_0x3071c6[_0x5b6c4d(0x16e)]=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x5b6c4d(0x35d)];}catch(_0x33005f){}const _0x40be62=this[_0x5b6c4d(0x207)]||[];this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x5b6c4d(0x2b5)],'driftAnalysis':_0x3071c6,'analysisHistory':_0x40be62},_0x5b6311[_0x5b6c4d(0x354)]);}else{if(_0x5b6311['command']===_0x5b6c4d(0x394)){const _0x1b2f28=this[_0x5b6c4d(0x2b5)]['length'],_0x245194=new Date(),_0x438eca=new Date(_0x245194[_0x5b6c4d(0x2ba)](),_0x245194[_0x5b6c4d(0x261)](),_0x245194[_0x5b6c4d(0x269)]())[_0x5b6c4d(0x37c)](),_0x40ffd4=this['rawEventLog'][_0x5b6c4d(0x38c)](_0x224e73=>new Date(_0x224e73[_0x5b6c4d(0x32c)])[_0x5b6c4d(0x37c)]()>_0x438eca)[_0x5b6c4d(0x2da)],_0x626465=new Array(0x18)[_0x5b6c4d(0x2f8)](0x0);this[_0x5b6c4d(0x1b6)][_0x5b6c4d(0x2f3)](_0x5d9616=>{const _0x8d1679=_0x5b6c4d,_0x15aa11=new Date(_0x5d9616['timestamp']);if(_0x15aa11[_0x8d1679(0x37c)]()>_0x438eca)_0x626465[_0x15aa11[_0x8d1679(0x2fc)]()]++;});let _0x1f3a1b={'status':_0x5b6c4d(0x399)};try{_0x1f3a1b['status']=(await this[_0x5b6c4d(0x368)](LTM_DP_DRIFT_STATUS))[_0x5b6c4d(0x35d)];}catch(_0x1c74a3){}let _0x3edd05='';try{const _0x5c02fb=await this[_0x5b6c4d(0x368)]('system.presenceWho');_0x3edd05=_0x5c02fb?_0x5c02fb['val']:'';}catch(_0x710b5f){}let _0x43ad98=null;!this[_0x5b6c4d(0x371)]&&(_0x43ad98=this[_0x5b6c4d(0x278)][_0x5b6c4d(0x2df)]?_0x5b6c4d(0x1c5):_0x5b6c4d(0x37b));let _0x135211={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x56e5ce=await this[_0x5b6c4d(0x368)](_0x5b6c4d(0x34f)),_0x502513=await this[_0x5b6c4d(0x368)](_0x5b6c4d(0x31a)),_0x2e6ade=await this[_0x5b6c4d(0x368)](_0x5b6c4d(0x29f)),_0x3089df=await this[_0x5b6c4d(0x368)]('analysis.automation.targetValue'),_0xea2dd3=await this[_0x5b6c4d(0x368)](_0x5b6c4d(0x2eb));_0x56e5ce&&_0x56e5ce[_0x5b6c4d(0x35d)]&&(_0x135211['detected']=!![],_0x135211[_0x5b6c4d(0x1d0)]=_0x502513?_0x502513[_0x5b6c4d(0x35d)]:'',_0x135211[_0x5b6c4d(0x1dc)]=_0x2e6ade?_0x2e6ade[_0x5b6c4d(0x35d)]:'',_0x135211[_0x5b6c4d(0x273)]=_0x3089df?_0x3089df[_0x5b6c4d(0x35d)]:''),_0x135211[_0x5b6c4d(0x311)]=_0xea2dd3?!!_0xea2dd3[_0x5b6c4d(0x35d)]:![];}catch(_0x5c2a0f){}this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':!![],'eventHistory':this[_0x5b6c4d(0x382)]['slice'](0x0,0xf),'stats':{'digestCount':_0x1b2f28,'eventCountToday':_0x40ffd4,'hourlyActivity':_0x626465,'driftStatus':_0x1f3a1b['status'],'isPresent':this[_0x5b6c4d(0x26f)],'presenceWho':_0x3edd05,'minDays':this[_0x5b6c4d(0x278)][_0x5b6c4d(0x271)]||0x7,'stbDays':this['config'][_0x5b6c4d(0x37e)]||0xe,'ltbDays':this['config'][_0x5b6c4d(0x375)]||0x3c,'systemError':_0x43ad98},'automation':_0x135211},_0x5b6311[_0x5b6c4d(0x354)]);}else{if(_0x5b6311[_0x5b6c4d(0x2d0)]===_0x5b6c4d(0x362)){const _0x3b3814=await this[_0x5b6c4d(0x1c3)](_0x5b6c4d(0x301),'enum'),_0x2600be=[];if(_0x3b3814)for(const _0x9b1814 in _0x3b3814){const _0x4d2ebb=_0x3b3814[_0x9b1814],_0x544964=(_0x4d2ebb['common']&&typeof _0x4d2ebb[_0x5b6c4d(0x325)][_0x5b6c4d(0x324)]===_0x5b6c4d(0x262)?_0x4d2ebb['common'][_0x5b6c4d(0x324)]['de']:_0x4d2ebb[_0x5b6c4d(0x325)][_0x5b6c4d(0x324)])||_0x4d2ebb['common'][_0x5b6c4d(0x324)];_0x2600be[_0x5b6c4d(0x2f7)]({'id':_0x9b1814,'name':_0x544964});}this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311['command'],{'success':!![],'enums':_0x2600be},_0x5b6311[_0x5b6c4d(0x354)]);}else{if(_0x5b6311[_0x5b6c4d(0x2d0)]===_0x5b6c4d(0x333))try{const _0x43bc8e=await scanForDevices(this,_0x5b6311[_0x5b6c4d(0x1b8)]||{});this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311['command'],{'success':!![],'devices':_0x43bc8e},_0x5b6311[_0x5b6c4d(0x354)]);}catch(_0x58ed74){this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':![],'error':_0x58ed74[_0x5b6c4d(0x1b8)]},_0x5b6311[_0x5b6c4d(0x354)]);}else{if(_0x5b6311[_0x5b6c4d(0x2d0)]===_0x5b6c4d(0x1d8)){const _0x5ddd69=_0x5b6311[_0x5b6c4d(0x1b8)][_0x5b6c4d(0x2aa)];if(!_0x5ddd69)return this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':![],'error':_0x5b6c4d(0x26b)},_0x5b6311[_0x5b6c4d(0x354)]);const _0x5c9b1c=await getCalendarNames(this,_0x5ddd69);this['sendTo'](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':!![],'names':_0x5c9b1c},_0x5b6311[_0x5b6c4d(0x354)]);}else{if(_0x5b6311['command']===_0x5b6c4d(0x1ec)){const {targetId:_0x276008,targetValue:_0x48e8d1}=_0x5b6311['message'];this[_0x5b6c4d(0x342)][_0x5b6c4d(0x1b9)](_0x5b6c4d(0x2c7)+_0x276008+'\x20=\x20'+_0x48e8d1),await this[_0x5b6c4d(0x1bb)](_0x5b6c4d(0x34f),{'val':!![],'ack':!![]}),await this['setStateAsync']('analysis.automation.description',{'val':_0x5b6c4d(0x1c6)+_0x276008,'ack':!![]}),await this[_0x5b6c4d(0x1bb)](_0x5b6c4d(0x29f),{'val':_0x276008,'ack':!![]}),await this['setStateAsync'](_0x5b6c4d(0x34b),{'val':_0x48e8d1,'ack':!![]}),this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':!![]},_0x5b6311[_0x5b6c4d(0x354)]);}else{if(_0x5b6311[_0x5b6c4d(0x2d0)]==='submitFeedback'){const {historyId:_0x44ec9f,rating:_0x1f5536,comment:_0x4fe5f5,alertReason:_0x31bcb7}=_0x5b6311[_0x5b6c4d(0x1b8)];_0x44ec9f&&_0x1f5536?(await saveFeedback(this,{'timestamp':Date[_0x5b6c4d(0x397)](),'historyId':_0x44ec9f,'rating':_0x1f5536,'comment':_0x4fe5f5,'alertReason':_0x31bcb7}),this[_0x5b6c4d(0x2b7)](_0x5b6311['from'],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':!![]},_0x5b6311[_0x5b6c4d(0x354)])):this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':![],'error':'Missing\x20data'},_0x5b6311[_0x5b6c4d(0x354)]);}else _0x5b6311[_0x5b6c4d(0x2d0)]===_0x5b6c4d(0x200)&&(this[_0x5b6c4d(0x342)][_0x5b6c4d(0x1b9)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x5b6c4d(0x1bb)](_0x5b6c4d(0x34f),{'val':![],'ack':!![]}),await this[_0x5b6c4d(0x1bb)](_0x5b6c4d(0x31a),{'val':'','ack':!![]}),this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':!![]},_0x5b6311[_0x5b6c4d(0x354)]));}}}}}}}}}}catch(_0x118aae){this[_0x5b6c4d(0x342)][_0x5b6c4d(0x2ef)](_0x5b6c4d(0x164)+_0x5b6311[_0x5b6c4d(0x2d0)]+':\x20'+_0x118aae[_0x5b6c4d(0x1b8)]);if(_0x5b6311[_0x5b6c4d(0x354)])this[_0x5b6c4d(0x2b7)](_0x5b6311[_0x5b6c4d(0x28f)],_0x5b6311[_0x5b6c4d(0x2d0)],{'success':![],'error':_0x118aae[_0x5b6c4d(0x1b8)]},_0x5b6311[_0x5b6c4d(0x354)]);}}}if(require['main']!==module)module['exports']=_0x47e42e=>new CogniLiving(_0x47e42e);else new CogniLiving();