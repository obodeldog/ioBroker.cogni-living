function a0_0xeb92(_0xd681d3,_0x527ece){const _0x59e6b1=a0_0x1bcb();return a0_0xeb92=function(_0x5811ee,_0x527faa){_0x5811ee=_0x5811ee-0x100;let _0x1bcbe2=_0x59e6b1[_0x5811ee];return _0x1bcbe2;},a0_0xeb92(_0xd681d3,_0x527ece);}const a0_0x2fe12b=a0_0xeb92;(function(_0x4e2372,_0xab07af){const _0x4761c8=a0_0xeb92,_0x508a9=_0x4e2372();while(!![]){try{const _0x35ae77=-parseInt(_0x4761c8(0x11f))/0x1+parseInt(_0x4761c8(0x249))/0x2*(parseInt(_0x4761c8(0x248))/0x3)+parseInt(_0x4761c8(0x112))/0x4+-parseInt(_0x4761c8(0x160))/0x5+parseInt(_0x4761c8(0x241))/0x6*(-parseInt(_0x4761c8(0x18d))/0x7)+-parseInt(_0x4761c8(0x1a4))/0x8+parseInt(_0x4761c8(0x162))/0x9*(parseInt(_0x4761c8(0x1b7))/0xa);if(_0x35ae77===_0xab07af)break;else _0x508a9['push'](_0x508a9['shift']());}catch(_0x5be13d){_0x508a9['push'](_0x508a9['shift']());}}}(a0_0x1bcb,0x2a78c));const a0_0x527faa=(function(){let _0x101ba1=!![];return function(_0xcb36eb,_0x5ec846){const _0x3af2e1=_0x101ba1?function(){if(_0x5ec846){const _0xeb8a4=_0x5ec846['apply'](_0xcb36eb,arguments);return _0x5ec846=null,_0xeb8a4;}}:function(){};return _0x101ba1=![],_0x3af2e1;};}()),a0_0x5811ee=a0_0x527faa(this,function(){const _0x140063=a0_0xeb92;return a0_0x5811ee[_0x140063(0x229)]()[_0x140063(0x14a)](_0x140063(0x120))['toString']()[_0x140063(0x1a2)](a0_0x5811ee)[_0x140063(0x14a)]('(((.+)+)+)+$');});function a0_0x1bcb(){const _0x3c06f0=['analysisTimer','Nuukanni\x20Security','cancel','setPresence','_calName','triggerGaitAnalysis','analysisHistory','analysis.energy.ventilationAlerts','ALARM','setupModeResetScheduler','setState','\x27\x20wurde\x20manuell\x20vom\x20Benutzer\x20gelÃ¶scht.','SET_LEARNING_MODE','WiFi\x20Presence\x20detected.','slice','response','notifyTelegramInstance','analysis.automation.autoApply','Activity-Level','TRAIN_ENERGY','getGenerativeModel','dailyDigests','initZombies','./lib/setup','system.presenceWho','scanForDevices','{\x22default\x22:\x2021}','TRAIN_SECURITY','@iobroker/adapter-core','pop','search','infrasoundArmingId','common','sendMorningBriefing','infrasoundEnabled','[Forensics]\x20Infrasound\x20Event\x20correlated:\x20','[Infrasound]\x20Subscribing\x20to\x20external\x20sensor:\x20','analysis.energy.pinnForecast','sensorLastValues','sendNotification','[Forensics]\x20Save\x20failed:\x20','includes','getLtmData','calendarName','checkWifiPresence','join','timestamp','forecast.current.weather','klar','inactivityThresholdHours','Fenster\x20geÃ¶ffnet:\x20','calendarInstance','4470hAINKv','push','279LsaoFA','./lib/automation','Gemini\x20Init\x20Error:\x20','analysis.health.gaitSensors','isPresent','minDaysForBaseline','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','isSolar','analysis.trigger','getEnums','onUnload','checkLicense','CALIB','bootTime','callback','checkSolarCondition','getForeignObjectsAsync','genAI','analysis.energy.rlPenalties','updateLocation','matrix','sort','analysis.training.triggerHealth','SYSTEM_DP_MODE','manual','notifyTelegramEnabled','Keine\x20Antwort\x20von\x20Gemini','instance','devices','getState','ðŸŽ“\x20[RL-RESET]\x20Lern-Sperre\x20(Penalty)\x20fÃ¼r\x20\x27','toFixed','getStateAsync','onReady','abs','ANOMALY\x20(Real\x20Threat?)','Key\x20not\x20found\x20or\x20not\x20provided','getOverviewData','filter','heiter','guest','Kein\x20Kalender-Adapter','door','403676vggspH','[Infrasound]\x20ðŸŸ¡\x20Debug-Mode:\x20Alarm\x20detected\x20but\x20suppressed\x20because\x20presence=true.','entries','analysis.topology.structure','\x20min\x20ausbleiben.','enum','protectAiMemory','ðŸ§ \x20Memory:\x20Cache\x20hydrated\x20with\x20','monitorEnforcements','updateTopologyMatrix','checkCalendarTriggers','stateChange','notifyPushoverEnabled','error','./lib/python_bridge','log','analysis.automation.description','notifyPushoverInstance','briefingJob','analysis.health.activityTrend','trackerHeartbeat','constructor','getCalendarNames','1950176lxwzSS','refreshCalendar','eventHistory','type','./lib/dead_man','licenseKey','lastAlertState','initHistory','Graph-Brain\x20Train\x20Error:\x20','some',')\x20-\x20Phase\x20D\x20(Comfort\x20Refinement)','MATCH\x20(False\x20Positive)','memoryCache','Sensors\x20used\x20for\x20Gait\x20Analysis','currentSystemMode','getForeignObjectAsync','analysis.energy.mpcActive','dependencyInstallInProgress','VACATION','126870OvqLhO','from','\x20opened.\x20Peak\x20Pressure:\x20','âš ï¸\x20Graph-Brain:\x20No\x20training\x20sequences\x20found\x20in\x20LTM.','analysis.automation.targetId','setStateAsync','Verbindung\x20erfolgreich!','processSensorEvent','getHours','toLowerCase','Test','activityLevel','analysis.health.gaitDebug','.system.mode','simulateButler','Gemini\x20AI\x20initialized.','.data.table','\x20hPa\x20(Limit:\x20','TRAIN_TOPOLOGY','analysis.automation.targetValue','analysis.automation.patternDetected','ErklÃ¤rt\x20durch:\x20','\x20Tage)','getOutsideTemperatureNumeric','startService','pressureBuffer','number','Guest\x20Mode','getMinutes','analysis.energy.insulationScore','handleInfrasound','triggerInfrasoundCorrelation','./lib/recorder','Comfort\x20Train\x20Error:\x20','ðŸ§ \x20Memory\x20Protection:\x20Restoring\x20persisted\x20AI-Calculations\x20(preventing\x20\x27Cold\x20Start\x27\x20amnesia).','state','window','unload','startSystem','OPTIMIZE_ENERGY','setupLtmScheduler','General\x20Activity\x20Trend\x20(%)','onStateChange','\x20rooms\x20(preventing\x20Cold\x20Start\x20Amnesia).','magnet','analysis.training.triggerComfort','NextHours.Location_1.Day_1.current.symbol_desc','lastTrackerEventTime','communicate.request','rawEventLog','analysis.security.infrasoundLog','\x20devices.','infrasoundSensorId','triggerBriefing','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','testApiKey','scanThermostats','analysis.security.learningStatus','Memory\x20Hydration\x20Failed:\x20','SYSTEM_MODES','values','now','\x20hPa.\x20Einbruch\x20wahrscheinlich.','daswetter.0','value','runPythonHealthCheck','find','infrasoundThreshold','text','presenceDevices','\x20hPa\x20(Threshold:\x20','appendToLog','models/gemini-flash-latest','ðŸ§ \x20Graph-Brain:\x20Training\x20Behaviour\x20Matrix\x20based\x20on\x20','TRAIN_HEALTH','analysis.energy.warmupTargets','analysis.automation.triggerAction','Warm-Up\x20Time\x20(Minutes\x20to\x20Target)','bind','reed','TRACK_EVENT','apiKey','telegram','endsWith','Daten\x20nicht\x20verfÃ¼gbar','temperature','driftAnalysisTimer','useWeather','parse','automation.triggerAction','analysis.energy.warmupSources','sources','keys','healthTrendInterval','map','ðŸ¤–\x20Butler\x20Training\x20started.\x20Injecting\x20knowledge\x20about\x20','unshift','send','infrasoundLocked','version','Warm-Up\x20Target\x20Temps\x20(JSON)','analysis.training.status','updateHealthVector','subscribeForeignStates','json','TRAIN_COMFORT','add','loadSystemMode','warn','floor','geminiModel','Reinforcement\x20Learning\x20Penalties','Instanz\x20nicht\x20gefunden','open','toString','forEach','analysis.training.triggerEnergy','LTM.baselineStatus','NORMAL','LTM.trainingData.sequences','stopService','message','command','Gesendet','./lib/scheduler','updateSchedulePreview','ltmJob','minutes_safe','Verbunden','getForeignStateAsync','setupBriefingScheduler','debug','analysis.energy.activeEnforcements','cleanupGhostInterventions','accuweather.0','LTM.rawEventLog','LTM.triggerDailyDigest','exitTimer','12MNcwJV','sendTo','Party\x20Mode','analyzeWindowOpening','systemConfig','length','analysis.energy.warmupTimes','9wDzRTu','57338rIAnnQ','config','subscribeStates','thermostat','.communicate.request','location','isGracePeriodActive','abortExitTimer','ðŸš¨\x20DRUCKWELLEN-ALARM!\x20StÃ¤rke:\x20','scanDevices','object','triggerEnergyPrediction','role','Sec-Training\x20started...','fill','split','Lernphase\x20(','times','updateTopology','enum.rooms.*','analysis.health.todayVector','PYTHON_EXE','setObjectNotExistsAsync','PINN\x20AI\x20Forecast','trackerEnabled','Adapter','string','createDailyDigest','motion','system.adapter.','enum.functions.*','geminiApiKey','createAllObjects','isProVersion','595760zPMEyE','analysisInterval','security.alarm_triggered','Active\x20Ventilation\x20Alerts','modeResetJob','initSystemConfig','isArray','Heizung\x20kann\x20','name','Current.WeatherText','onMessage','Could\x20not\x20read\x20daily\x20vector:\x20','ack','94278imUaXD','(((.+)+)+)+$','subscribeForeignStatesAsync','weatherunderground.0','online','runGeminiAnalysis','analysis.triggerBriefing','Keine\x20Sensor-AktivitÃ¤t','val','info','stringify','party','dismissAutomation'];a0_0x1bcb=function(){return _0x3c06f0;};return a0_0x1bcb();}a0_0x5811ee();'use strict';const utils=require(a0_0x2fe12b(0x148)),{GoogleGenerativeAI}=require('@google/generative-ai'),installer=require('./lib/installer'),scanner=require('./lib/scanner'),schedulers=require(a0_0x2fe12b(0x233)),topology=require('./lib/topology'),setup=require(a0_0x2fe12b(0x143)),recorder=require(a0_0x2fe12b(0x1d7)),pythonBridge=require(a0_0x2fe12b(0x19b)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x2fe12b(0x1a8)),automation=require(a0_0x2fe12b(0x163)),GEMINI_MODEL=a0_0x2fe12b(0x1ff),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils[a0_0x2fe12b(0x109)]{constructor(_0x3684f5){const _0x146a5c=a0_0x2fe12b;super({..._0x3684f5,'name':'cogni-living'}),this[_0x146a5c(0x1a6)]=[],this[_0x146a5c(0x132)]=[],this[_0x146a5c(0x1e8)]=[],this[_0x146a5c(0x141)]=[],this[_0x146a5c(0x152)]={},this[_0x146a5c(0x245)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x146a5c(0x166)]=!![],this[_0x146a5c(0x240)]=null,this['exitGraceTimer']=null,this[_0x146a5c(0x24f)]=![],this['genAI']=null,this[_0x146a5c(0x225)]=null,this[_0x146a5c(0x1b2)]=setup[_0x146a5c(0x1f2)][_0x146a5c(0x22d)],this[_0x146a5c(0x111)]=![],this[_0x146a5c(0x1aa)]=![],this[_0x146a5c(0x12c)]=null,this['ltmJob']=null,this[_0x146a5c(0x116)]=null,this['driftAnalysisTimer']=null,this['briefingJob']=null,this[_0x146a5c(0x1a1)]=null,this[_0x146a5c(0x214)]=null,this[_0x146a5c(0x1b5)]=![],this[_0x146a5c(0x1e6)]=Date[_0x146a5c(0x1f4)](),this[_0x146a5c(0x1b0)]=null,this[_0x146a5c(0x16f)]=Date[_0x146a5c(0x1f4)](),this['infrasoundLocked']=![],this[_0x146a5c(0x1d0)]=[],this['on']('ready',this['onReady']['bind'](this)),this['on'](_0x146a5c(0x198),this[_0x146a5c(0x1e1)]['bind'](this)),this['on'](_0x146a5c(0x1dc),this[_0x146a5c(0x16c)][_0x146a5c(0x205)](this)),this['on'](_0x146a5c(0x230),this[_0x146a5c(0x11c)][_0x146a5c(0x205)](this));}async[a0_0x2fe12b(0x183)](){const _0x16eb40=a0_0x2fe12b;this['log'][_0x16eb40(0x128)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x16eb40(0x21a)]+_0x16eb40(0x1ae));if(!installer['checkAndInstall'](this,()=>this[_0x16eb40(0x1dd)]()))return;}async['startSystem'](){const _0x147566=a0_0x2fe12b;await setup[_0x147566(0x142)](this);try{this[_0x147566(0x111)]=await setup[_0x147566(0x16d)](this[_0x147566(0x24a)][_0x147566(0x1a9)]);}catch(_0x2534e9){}if(!this[_0x147566(0x24a)][_0x147566(0x15d)]||this['config'][_0x147566(0x15d)]<0.1)this[_0x147566(0x24a)][_0x147566(0x15d)]=0xc;await setup[_0x147566(0x1ab)](this),await setup[_0x147566(0x117)](this);try{const _0x309790=await this['getStateAsync'](_0x147566(0x247)),_0x51158b=await this[_0x147566(0x182)](_0x147566(0x211));_0x309790&&_0x309790[_0x147566(0x127)]&&_0x51158b&&_0x51158b[_0x147566(0x127)]&&(Date[_0x147566(0x1f4)]()-_0x309790['ts']<0x4*0xe10*0x3e8&&(this[_0x147566(0x1b0)]={'times':JSON[_0x147566(0x20f)](_0x309790[_0x147566(0x127)]),'sources':JSON[_0x147566(0x20f)](_0x51158b[_0x147566(0x127)])},this[_0x147566(0x19c)]['info'](_0x147566(0x194)+Object[_0x147566(0x213)](this[_0x147566(0x1b0)][_0x147566(0x101)])[_0x147566(0x246)]+_0x147566(0x1e2))));}catch(_0x4605c5){this[_0x147566(0x19c)][_0x147566(0x223)](_0x147566(0x1f1)+_0x4605c5['message']);}if(this[_0x147566(0x24a)][_0x147566(0x10f)])try{this['genAI']=new GoogleGenerativeAI(this['config'][_0x147566(0x10f)]),this[_0x147566(0x225)]=this[_0x147566(0x173)][_0x147566(0x140)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x147566(0x19c)]['info'](_0x147566(0x1c6));}catch(_0x2b8652){this[_0x147566(0x19c)]['error'](_0x147566(0x164)+_0x2b8652[_0x147566(0x230)]);}await setup[_0x147566(0x110)](this),await this['loadSystemMode'](),await this[_0x147566(0x106)](_0x147566(0x151),{'type':_0x147566(0x1da),'common':{'name':_0x147566(0x107),'type':_0x147566(0x10a),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x147566(0x106)](_0x147566(0x133),{'type':_0x147566(0x1da),'common':{'name':_0x147566(0x115),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x147566(0x247),{'type':_0x147566(0x1da),'common':{'name':_0x147566(0x204),'type':_0x147566(0x10a),'role':_0x147566(0x21f),'read':!![],'write':![]},'native':{}}),await this[_0x147566(0x106)]('analysis.energy.warmupTargets',{'type':_0x147566(0x1da),'common':{'name':_0x147566(0x21b),'type':'string','role':_0x147566(0x21f),'read':!![],'write':!![],'def':_0x147566(0x146)},'native':{}}),await this['setObjectNotExistsAsync'](_0x147566(0x174),{'type':'state','common':{'name':_0x147566(0x226),'type':_0x147566(0x10a),'role':_0x147566(0x21f),'read':!![],'write':![],'def':'{}'},'native':{}}),await this[_0x147566(0x106)](_0x147566(0x1a0),{'type':_0x147566(0x1da),'common':{'name':_0x147566(0x1e0),'type':'number','role':_0x147566(0x1f7),'unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x147566(0x165),{'type':_0x147566(0x1da),'common':{'name':_0x147566(0x1b1),'type':'string','role':_0x147566(0x1fb),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x147566(0x23b),{'type':'state','common':{'name':'Active\x20Calendar\x20Enforcements\x20(Locks)','type':'string','role':_0x147566(0x21f),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x147566(0x1e9),{'type':'state','common':{'name':'Forensic\x20Infrasound\x20Log','type':_0x147566(0x10a),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x147566(0x106)](_0x147566(0x1c3),{'type':_0x147566(0x1da),'common':{'name':'Gait\x20Speed\x20Calculation\x20Proof','type':_0x147566(0x10a),'role':_0x147566(0x1fb),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x147566(0x104),{'type':_0x147566(0x1da),'common':{'name':'Daily\x20Activity\x20Vector\x20(24h)','type':_0x147566(0x10a),'role':_0x147566(0x21f),'read':!![],'write':![],'def':'[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]'},'native':{}});try{const _0x5bae57=await this[_0x147566(0x182)](_0x147566(0x23e));if(_0x5bae57&&_0x5bae57['val'])this[_0x147566(0x1e8)]=JSON[_0x147566(0x20f)](_0x5bae57[_0x147566(0x127)]);}catch(_0x488a7a){this[_0x147566(0x1e8)]=[];}try{const _0x1ef664=await this[_0x147566(0x182)]('LTM.dailyDigests');if(_0x1ef664&&_0x1ef664['val'])this[_0x147566(0x141)]=JSON[_0x147566(0x20f)](_0x1ef664['val']);}catch(_0x389762){this[_0x147566(0x141)]=[];}const _0x2e5cde=this['dailyDigests'][_0x147566(0x246)]>=(this[_0x147566(0x24a)][_0x147566(0x167)]||0x7)?'Aktiv\x20('+this[_0x147566(0x141)][_0x147566(0x246)]+_0x147566(0x1cd):_0x147566(0x100)+this['dailyDigests']['length']+'/'+(this[_0x147566(0x24a)]['minDaysForBaseline']||0x7)+')';await this[_0x147566(0x1bc)](_0x147566(0x22c),{'val':_0x2e5cde,'ack':!![]}),this[_0x147566(0x24b)](_0x147566(0x16a)),this['subscribeStates'](_0x147566(0x23f)),this[_0x147566(0x24b)]('system.mode'),this[_0x147566(0x24b)](_0x147566(0x125)),this[_0x147566(0x24b)](_0x147566(0x203)),this[_0x147566(0x24b)](_0x147566(0x13d)),this['subscribeStates']('analysis.training.triggerSecurity'),this['subscribeStates'](_0x147566(0x178)),this[_0x147566(0x24b)](_0x147566(0x22b)),this[_0x147566(0x24b)](_0x147566(0x1e4)),this[_0x147566(0x24b)]('analysis.training.triggerTopology'),this['subscribeStates'](_0x147566(0x1b4)),this[_0x147566(0x24b)](_0x147566(0x211));this[_0x147566(0x24a)][_0x147566(0x14e)]&&this[_0x147566(0x24a)][_0x147566(0x1eb)]&&(this[_0x147566(0x19c)]['info'](_0x147566(0x150)+this['config'][_0x147566(0x1eb)]),this[_0x147566(0x21e)](this['config']['infrasoundSensorId']));const _0x3d90e3=this[_0x147566(0x24a)]['devices'];if(_0x3d90e3)for(const _0x3449ac of _0x3d90e3){await this[_0x147566(0x121)](_0x3449ac['id']);}const _0x2f0e10=this[_0x147566(0x24a)][_0x147566(0x1fc)];if(_0x2f0e10)for(const _0x2a5a34 of _0x2f0e10){await this[_0x147566(0x121)](_0x2a5a34);}if(this[_0x147566(0x24a)][_0x147566(0x17b)]&&this[_0x147566(0x24a)][_0x147566(0x13c)])await this[_0x147566(0x121)](this[_0x147566(0x24a)]['notifyTelegramInstance']+_0x147566(0x24d));setTimeout(()=>this[_0x147566(0x158)](),0x1388);if(this[_0x147566(0x12c)])clearInterval(this[_0x147566(0x12c)]);const _0x47e60f=this[_0x147566(0x24a)][_0x147566(0x113)]||0xf;_0x47e60f>0x0&&(this[_0x147566(0x12c)]=setInterval(()=>{const _0x1691b7=_0x147566;this['runAutopilot'](),automation['checkCalendarTriggers'](this),automation[_0x1691b7(0x195)](this);},_0x47e60f*0x3c*0x3e8));setTimeout(()=>{const _0x5ff7b=_0x147566;automation[_0x5ff7b(0x197)](this),automation['monitorEnforcements'](this);},0x2710);this['config'][_0x147566(0x108)]!==![]&&(this[_0x147566(0x1a1)]=setInterval(()=>{const _0x166b5d=_0x147566;if(this[_0x166b5d(0x111)]){const _0xfefcc2=Date[_0x166b5d(0x1f4)](),_0x4df809=this[_0x166b5d(0x1e6)]||_0xfefcc2,_0x1404bb=(_0xfefcc2-_0x4df809)/0x3e8;_0x1404bb>0x2&&(this[_0x166b5d(0x1e6)]=_0xfefcc2,pythonBridge[_0x166b5d(0x218)](this,_0x166b5d(0x207),{'room':null,'dt':_0x1404bb}));}},0xbb8));if(this[_0x147566(0x214)])clearInterval(this[_0x147566(0x214)]);this['healthTrendInterval']=setInterval(()=>{const _0x5bce58=_0x147566;this[_0x5bce58(0x111)]&&(this['log']['info']('â¤ï¸\x20Auto-Heartbeat:\x20Aktualisiere\x20Gesundheits-Trends...'),this['runPythonHealthCheck']());},0x4*0x3c*0x3c*0x3e8),schedulers[_0x147566(0x1df)](this,()=>aiAgent[_0x147566(0x10b)](this,pythonBridge)),schedulers[_0x147566(0x135)](this),schedulers['setupDriftAnalysisScheduler'](this,()=>aiAgent['runBaselineDriftAnalysis'](this)),schedulers[_0x147566(0x239)](this,()=>aiAgent[_0x147566(0x14d)](this)),pythonBridge[_0x147566(0x1cf)](this,installer[_0x147566(0x105)]),setTimeout(async()=>{const _0xcadb07=_0x147566;await topology[_0xcadb07(0x102)](this);try{const _0x36fce6=await this[_0xcadb07(0x182)](_0xcadb07(0x190));if(_0x36fce6&&_0x36fce6['val'])pythonBridge['send'](this,'SET_TOPOLOGY',JSON[_0xcadb07(0x20f)](_0x36fce6[_0xcadb07(0x127)]));}catch(_0x51c2f9){}this[_0xcadb07(0x1f8)](),this[_0xcadb07(0x131)](),this[_0xcadb07(0x254)](),this[_0xcadb07(0x21d)]();},0x1388);}[a0_0x2fe12b(0x16c)](_0x35a248){const _0x15f088=a0_0x2fe12b;if(this[_0x15f088(0x12c)])clearInterval(this[_0x15f088(0x12c)]);if(this[_0x15f088(0x20d)])clearInterval(this['driftAnalysisTimer']);if(this[_0x15f088(0x1a1)])clearInterval(this[_0x15f088(0x1a1)]);if(this[_0x15f088(0x214)])clearInterval(this[_0x15f088(0x214)]);if(this[_0x15f088(0x235)])this['ltmJob'][_0x15f088(0x12e)]();if(this['modeResetJob'])this[_0x15f088(0x116)][_0x15f088(0x12e)]();if(this[_0x15f088(0x19f)])this[_0x15f088(0x19f)][_0x15f088(0x12e)]();recorder[_0x15f088(0x250)](this),pythonBridge[_0x15f088(0x22f)](this),_0x35a248();}async['onStateChange'](_0x2eeeec,_0x3e60ac){const _0x177645=a0_0x2fe12b;if(!_0x3e60ac||this[_0x177645(0x1b5)])return;if(_0x2eeeec[_0x177645(0x155)](_0x177645(0x209))&&_0x2eeeec['endsWith'](_0x177645(0x1e7))&&_0x3e60ac[_0x177645(0x127)])return;if(this[_0x177645(0x24a)][_0x177645(0x14e)]&&_0x2eeeec===this[_0x177645(0x24a)][_0x177645(0x1eb)]){this[_0x177645(0x1d5)](_0x3e60ac[_0x177645(0x127)]);return;}if(_0x2eeeec===this['namespace']+_0x177645(0x1c4)){if(_0x3e60ac[_0x177645(0x127)]&&Object[_0x177645(0x1f3)](setup['SYSTEM_MODES'])[_0x177645(0x155)](_0x3e60ac[_0x177645(0x127)])){this[_0x177645(0x1b2)]=_0x3e60ac[_0x177645(0x127)];if(_0x3e60ac[_0x177645(0x127)]===setup[_0x177645(0x1f2)][_0x177645(0x1b6)])await recorder[_0x177645(0x12f)](this,![]);else await recorder[_0x177645(0x12f)](this,!![]);if(this['isProVersion']){let _0x207b64=![],_0x20b212=0x0,_0x51a4e0=_0x177645(0x17a);if(this[_0x177645(0x1b2)]===_0x177645(0x12a))_0x207b64=!![],_0x20b212=0x168,_0x51a4e0=_0x177645(0x243);else this['currentSystemMode']===_0x177645(0x18a)&&(_0x207b64=!![],_0x20b212=0x5a0,_0x51a4e0=_0x177645(0x1d2));pythonBridge[_0x177645(0x218)](this,_0x177645(0x138),{'active':_0x207b64,'duration':_0x20b212,'label':_0x51a4e0}),await this[_0x177645(0x1bc)](_0x177645(0x1f0),{'val':JSON[_0x177645(0x129)]({'active':_0x207b64,'label':_0x51a4e0,'timestamp':Date[_0x177645(0x1f4)]()}),'ack':!![]});}}if(!_0x3e60ac[_0x177645(0x11e)])this[_0x177645(0x136)](_0x2eeeec,{'val':this['currentSystemMode'],'ack':!![]});return;}_0x2eeeec[_0x177645(0x20a)]('analysis.energy.warmupSources')&&_0x3e60ac[_0x177645(0x11e)]&&this['protectAiMemory'](_0x3e60ac[_0x177645(0x127)]);if(!_0x3e60ac['ack']){if(_0x2eeeec[_0x177645(0x155)](_0x177645(0x16a))&&_0x3e60ac[_0x177645(0x127)]){this['setState'](_0x2eeeec,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this);return;}if(_0x2eeeec['includes']('triggerDailyDigest')&&_0x3e60ac[_0x177645(0x127)]){this['setState'](_0x2eeeec,{'val':![],'ack':!![]});if(this[_0x177645(0x111)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x2eeeec['includes'](_0x177645(0x1ec))&&_0x3e60ac[_0x177645(0x127)]){this[_0x177645(0x136)](_0x2eeeec,{'val':![],'ack':!![]}),aiAgent[_0x177645(0x14d)](this);return;}if(_0x2eeeec[_0x177645(0x155)](_0x177645(0x210))&&_0x3e60ac[_0x177645(0x127)]){this['setState'](_0x2eeeec,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x2eeeec[_0x177645(0x155)]('analysis.training.triggerSecurity')&&_0x3e60ac['val']){this[_0x177645(0x136)](_0x2eeeec,{'val':![],'ack':!![]});if(this[_0x177645(0x111)])try{const _0x3ecece=await this[_0x177645(0x182)](_0x177645(0x22e));if(_0x3ecece&&_0x3ecece[_0x177645(0x127)]){const _0x10801b=JSON[_0x177645(0x20f)](_0x3ecece[_0x177645(0x127)]);this[_0x177645(0x1bc)](_0x177645(0x21c),{'val':_0x177645(0x256),'ack':!![]}),pythonBridge['send'](this,_0x177645(0x147),{'sequences':_0x10801b});}}catch(_0x380b14){}return;}if(_0x2eeeec[_0x177645(0x155)](_0x177645(0x178))&&_0x3e60ac[_0x177645(0x127)]){this[_0x177645(0x136)](_0x2eeeec,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x3c719c=await this[_0x177645(0x182)]('LTM.dailyDigests');if(_0x3c719c&&_0x3c719c['val'])pythonBridge[_0x177645(0x218)](this,_0x177645(0x201),{'digests':JSON[_0x177645(0x20f)](_0x3c719c[_0x177645(0x127)])});}catch(_0x18e84c){}return;}if(_0x2eeeec[_0x177645(0x155)](_0x177645(0x22b))&&_0x3e60ac[_0x177645(0x127)]){this[_0x177645(0x136)](_0x2eeeec,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x44970f=await this['getStateAsync']('LTM.trainingData.thermodynamics');if(_0x44970f&&_0x44970f['val'])pythonBridge[_0x177645(0x218)](this,_0x177645(0x13f),{'points':JSON[_0x177645(0x20f)](_0x44970f[_0x177645(0x127)])});}catch(_0x5a76e1){}return;}if(_0x2eeeec[_0x177645(0x155)]('analysis.training.triggerComfort')&&_0x3e60ac['val']){this[_0x177645(0x136)](_0x2eeeec,{'val':![],'ack':!![]});if(this[_0x177645(0x111)])try{const _0x23f1a1=await this[_0x177645(0x182)](_0x177645(0x23e));if(_0x23f1a1&&_0x23f1a1[_0x177645(0x127)]){const _0x55d0f6={};this[_0x177645(0x24a)][_0x177645(0x17e)]&&Array[_0x177645(0x118)](this[_0x177645(0x24a)]['devices'])&&this[_0x177645(0x24a)][_0x177645(0x17e)][_0x177645(0x22a)](_0x83186c=>{const _0x554a38=_0x177645;if(_0x83186c['id']&&_0x83186c[_0x554a38(0x1a7)])_0x55d0f6[_0x83186c['id']]=_0x83186c[_0x554a38(0x1a7)];}),this['log'][_0x177645(0x128)](_0x177645(0x216)+Object['keys'](_0x55d0f6)['length']+_0x177645(0x1ea)),pythonBridge[_0x177645(0x218)](this,_0x177645(0x220),{'events':JSON[_0x177645(0x20f)](_0x23f1a1[_0x177645(0x127)]),'deviceMap':_0x55d0f6});}}catch(_0x3a8872){this[_0x177645(0x19c)][_0x177645(0x19a)](_0x177645(0x1d8)+_0x3a8872[_0x177645(0x230)]);}return;}if(_0x2eeeec[_0x177645(0x155)]('analysis.training.triggerTopology')&&_0x3e60ac['val']){this[_0x177645(0x136)](_0x2eeeec,{'val':![],'ack':!![]}),topology[_0x177645(0x102)](this);if(this[_0x177645(0x111)])try{const _0x5ef7e4=await this[_0x177645(0x182)](_0x177645(0x22e));if(_0x5ef7e4&&_0x5ef7e4[_0x177645(0x127)]){const _0x5d193b=JSON['parse'](_0x5ef7e4['val']);this[_0x177645(0x19c)]['info'](_0x177645(0x200)+_0x5d193b['length']+'\x20sequences...'),pythonBridge[_0x177645(0x218)](this,_0x177645(0x1c9),{'sequences':_0x5d193b});}else this[_0x177645(0x19c)][_0x177645(0x223)](_0x177645(0x1ba));}catch(_0x2e5209){this[_0x177645(0x19c)][_0x177645(0x19a)](_0x177645(0x1ac)+_0x2e5209[_0x177645(0x230)]);}return;}}if(this[_0x177645(0x24a)][_0x177645(0x1fc)]&&this[_0x177645(0x24a)]['presenceDevices'][_0x177645(0x155)](_0x2eeeec)){await this[_0x177645(0x158)]();return;}const _0x1ffcad=(this[_0x177645(0x24a)][_0x177645(0x17e)]||[])[_0x177645(0x1f9)](_0x24eb6a=>_0x24eb6a['id']===_0x2eeeec);if(_0x1ffcad){const _0x125234=await recorder[_0x177645(0x1be)](this,_0x2eeeec,_0x3e60ac,_0x1ffcad);_0x125234&&_0x125234[_0x177645(0x1a7)]===_0x177645(0x10c)&&_0x125234['location']&&this[_0x177645(0x111)]&&deadMan[_0x177645(0x175)](this,_0x125234[_0x177645(0x24e)]),_0x3e60ac[_0x177645(0x127)]&&(_0x3e60ac[_0x177645(0x127)]===!![]||_0x3e60ac[_0x177645(0x127)]===0x1||String(_0x3e60ac[_0x177645(0x127)])[_0x177645(0x1c0)]()===_0x177645(0x228))&&(_0x1ffcad[_0x177645(0x1a7)]&&(_0x1ffcad[_0x177645(0x1a7)][_0x177645(0x155)](_0x177645(0x1db))||_0x1ffcad[_0x177645(0x1a7)][_0x177645(0x155)](_0x177645(0x18c))||_0x1ffcad[_0x177645(0x1a7)][_0x177645(0x155)](_0x177645(0x1e3)))&&this[_0x177645(0x244)](_0x1ffcad)),(_0x1ffcad[_0x177645(0x1a7)]===_0x177645(0x20c)||_0x1ffcad['type']===_0x177645(0x24c))&&automation[_0x177645(0x23c)](this);}}async[a0_0x2fe12b(0x193)](_0x4b13b4){const _0x396fe3=a0_0x2fe12b;if(!this['memoryCache']||Date[_0x396fe3(0x1f4)]()-this[_0x396fe3(0x16f)]>0x493e0)return;if(!this['memoryCache'][_0x396fe3(0x212)]||!this[_0x396fe3(0x1b0)][_0x396fe3(0x101)])return;try{const _0x352573=JSON[_0x396fe3(0x20f)](_0x4b13b4),_0x9eb8ec=this['memoryCache']['sources'];let _0x44bc90=![];for(const _0x3765c1 in _0x9eb8ec){if(_0x9eb8ec[_0x3765c1][_0x396fe3(0x155)]('AI')&&_0x352573[_0x3765c1]&&!_0x352573[_0x3765c1][_0x396fe3(0x155)]('AI')){_0x44bc90=!![];break;}}_0x44bc90&&(this['log'][_0x396fe3(0x128)](_0x396fe3(0x1d9)),await this[_0x396fe3(0x1bc)]('analysis.energy.warmupTimes',{'val':JSON['stringify'](this[_0x396fe3(0x1b0)][_0x396fe3(0x101)]),'ack':!![]}),await this[_0x396fe3(0x1bc)](_0x396fe3(0x211),{'val':JSON[_0x396fe3(0x129)](this['memoryCache'][_0x396fe3(0x212)]),'ack':!![]}));}catch(_0x6bd90d){}}async['onMessage'](_0x447b10){const _0x5c7afc=a0_0x2fe12b;if(typeof _0x447b10==='object'&&_0x447b10[_0x5c7afc(0x230)]){if(_0x447b10[_0x5c7afc(0x231)]==='checkThermostats')try{const _0x48c4a0=await automation[_0x5c7afc(0x1ef)](this);this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10['command'],{'success':!![],'results':_0x48c4a0},_0x447b10['callback']);}catch(_0x486da5){this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':![],'error':_0x486da5[_0x5c7afc(0x230)]},_0x447b10['callback']);}else{if(_0x447b10[_0x5c7afc(0x231)]==='simulateEnergyMPC')try{const {current_temps:_0x21f93c,t_out:_0x1b6368,targets:_0x2eeeb2,t_forecast:_0x4fc137}=_0x447b10[_0x5c7afc(0x230)],_0xc01e85=[];let _0x243cd2={};try{const _0x57e01d=await this[_0x5c7afc(0x182)](_0x5c7afc(0x1d4));if(_0x57e01d&&_0x57e01d['val']){const _0x454676=JSON['parse'](_0x57e01d[_0x5c7afc(0x127)]);_0x243cd2=_0x454676['scores']||_0x454676;}}catch(_0x491857){}const _0x30ca26=_0x4fc137!==undefined&&_0x4fc137!==null?(_0x1b6368+_0x4fc137)/0x2:_0x1b6368;for(const [_0x51ad40,_0x488328]of Object[_0x5c7afc(0x18f)](_0x21f93c)){const _0x346e6b=_0x2eeeb2[_0x51ad40]||0x15;if(_0x488328<=_0x346e6b)continue;let _0xb3842a=_0x243cd2[_0x51ad40]||-0.5;if(_0xb3842a>=0x0)_0xb3842a=-0.5;const _0x49a2e6=Math[_0x5c7afc(0x184)](_0xb3842a),_0x3686cb=_0x488328-_0x346e6b;let _0x28ce93=Math[_0x5c7afc(0x224)](_0x3686cb/_0x49a2e6*0x3c);const _0x106653=_0x488328-_0x1b6368,_0x4ce279=_0x488328-_0x30ca26;if(_0x4ce279!==0x0&&_0x106653!==0x0){const _0x21dd57=_0x106653/_0x4ce279;_0x28ce93=Math[_0x5c7afc(0x224)](_0x28ce93*_0x21dd57);}if(_0x28ce93>0xf){if(_0x28ce93>0xf0)_0x28ce93=0xf0;_0xc01e85['push']({'room':_0x51ad40,'minutes_safe':_0x28ce93,'target':_0x346e6b,'current':_0x488328,'savings_msg':_0x5c7afc(0x119)+_0x28ce93+_0x5c7afc(0x191)});}}_0xc01e85[_0x5c7afc(0x177)]((_0xc13f4a,_0x4c6a3c)=>_0x4c6a3c[_0x5c7afc(0x236)]-_0xc13f4a[_0x5c7afc(0x236)]),this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![],'proposals':_0xc01e85},_0x447b10[_0x5c7afc(0x170)]);}catch(_0x1c8d7e){this['sendTo'](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':![],'error':_0x1c8d7e['message']},_0x447b10[_0x5c7afc(0x170)]);}else{if(_0x447b10[_0x5c7afc(0x231)]===_0x5c7afc(0x1a5))try{await automation[_0x5c7afc(0x234)](this),this['sendTo'](_0x447b10['from'],_0x447b10['command'],{'success':!![]},_0x447b10[_0x5c7afc(0x170)]);}catch(_0x1a3081){this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':![],'error':_0x1a3081[_0x5c7afc(0x230)]},_0x447b10[_0x5c7afc(0x170)]);}else{if(_0x447b10[_0x5c7afc(0x231)]==='resetRLPenalty')try{const _0x4a6bc4=_0x447b10[_0x5c7afc(0x230)]['key'],_0x47c684=_0x5c7afc(0x174),_0x54975f=await this[_0x5c7afc(0x182)](_0x47c684);let _0x1568c8={};if(_0x54975f&&_0x54975f['val'])try{_0x1568c8=JSON[_0x5c7afc(0x20f)](_0x54975f['val']);}catch(_0x54be1d){}_0x4a6bc4&&_0x1568c8[_0x4a6bc4]?(delete _0x1568c8[_0x4a6bc4],await this[_0x5c7afc(0x1bc)](_0x47c684,{'val':JSON[_0x5c7afc(0x129)](_0x1568c8),'ack':!![]}),this[_0x5c7afc(0x19c)]['info'](_0x5c7afc(0x180)+_0x4a6bc4+_0x5c7afc(0x137)),this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![]},_0x447b10[_0x5c7afc(0x170)])):this[_0x5c7afc(0x242)](_0x447b10['from'],_0x447b10[_0x5c7afc(0x231)],{'success':![],'error':_0x5c7afc(0x186)},_0x447b10['callback']);}catch(_0x2977f2){this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10['command'],{'success':![],'error':_0x2977f2[_0x5c7afc(0x230)]},_0x447b10[_0x5c7afc(0x170)]);}else{if(_0x447b10[_0x5c7afc(0x231)]===_0x5c7afc(0x12b))await this[_0x5c7afc(0x1bc)](_0x5c7afc(0x1cb),{'val':![],'ack':!![]}),await this[_0x5c7afc(0x1bc)](_0x5c7afc(0x19d),{'val':'','ack':!![]}),await this[_0x5c7afc(0x1bc)](_0x5c7afc(0x1bb),{'val':'','ack':!![]}),this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![]},_0x447b10[_0x5c7afc(0x170)]);else{if(_0x447b10[_0x5c7afc(0x231)]===_0x5c7afc(0x1c5)){const {targetId:_0x50c14b,targetValue:_0x24596a}=_0x447b10['message'];await this[_0x5c7afc(0x1bc)](_0x5c7afc(0x1cb),{'val':!![],'ack':!![]}),await this[_0x5c7afc(0x1bc)](_0x5c7afc(0x19d),{'val':'Simulation\x20durch\x20Admin\x20(Test)','ack':!![]}),await this['setStateAsync'](_0x5c7afc(0x1bb),{'val':_0x50c14b,'ack':!![]}),await this['setStateAsync']('analysis.automation.targetValue',{'val':String(_0x24596a),'ack':!![]}),this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![]},_0x447b10[_0x5c7afc(0x170)]);}else{if(_0x447b10[_0x5c7afc(0x231)]===_0x5c7afc(0x1ee))try{const _0x1b6097=_0x447b10[_0x5c7afc(0x230)][_0x5c7afc(0x208)];if(!_0x1b6097)throw new Error('Kein\x20API\x20Key\x20Ã¼bergeben');const _0x194f65=new GoogleGenerativeAI(_0x1b6097),_0x59fd66=_0x194f65[_0x5c7afc(0x140)]({'model':GEMINI_MODEL}),_0x42663f=await _0x59fd66['generateContent'](_0x5c7afc(0x1c1)),_0x383917=await _0x42663f[_0x5c7afc(0x13b)];if(_0x383917['text']())this['sendTo'](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![],'message':_0x5c7afc(0x1bd)},_0x447b10[_0x5c7afc(0x170)]);else throw new Error(_0x5c7afc(0x17c));}catch(_0x3c5b74){this[_0x5c7afc(0x242)](_0x447b10['from'],_0x447b10[_0x5c7afc(0x231)],{'success':![],'message':_0x3c5b74['message']},_0x447b10['callback']);}else{if(_0x447b10[_0x5c7afc(0x231)]===_0x5c7afc(0x252))try{const _0x22be63=await scanner[_0x5c7afc(0x145)](this,_0x447b10[_0x5c7afc(0x230)]||{});this['sendTo'](_0x447b10['from'],_0x447b10['command'],{'success':!![],'devices':_0x22be63},_0x447b10[_0x5c7afc(0x170)]);}catch(_0x4933fd){this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':![],'error':_0x4933fd['message']},_0x447b10[_0x5c7afc(0x170)]);}else{if(_0x447b10[_0x5c7afc(0x231)]===_0x5c7afc(0x196))try{const {matrix:_0x5c19d0}=_0x447b10[_0x5c7afc(0x230)],_0x391dbb=await this[_0x5c7afc(0x182)](_0x5c7afc(0x190));if(_0x391dbb&&_0x391dbb[_0x5c7afc(0x127)]){const _0xf49c99=JSON[_0x5c7afc(0x20f)](_0x391dbb[_0x5c7afc(0x127)]);_0xf49c99[_0x5c7afc(0x176)]=_0x5c19d0,_0xf49c99['updated']=Date['now'](),await this[_0x5c7afc(0x1bc)](_0x5c7afc(0x190),{'val':JSON[_0x5c7afc(0x129)](_0xf49c99),'ack':!![]}),pythonBridge['send'](this,'SET_TOPOLOGY',_0xf49c99);}this['sendTo'](_0x447b10['from'],_0x447b10[_0x5c7afc(0x231)],{'success':!![]},_0x447b10['callback']);}catch(_0x491fd7){this[_0x5c7afc(0x19c)][_0x5c7afc(0x19a)](_0x491fd7);}else{if(_0x447b10['command']===_0x5c7afc(0x156))this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![],'dailyDigests':this[_0x5c7afc(0x141)]||[],'analysisHistory':this[_0x5c7afc(0x132)]||[]},_0x447b10['callback']);else{if(_0x447b10[_0x5c7afc(0x231)]===_0x5c7afc(0x187)){const _0xe7edb2=this[_0x5c7afc(0x141)][_0x5c7afc(0x246)];let _0x310f41=new Array(0x18)[_0x5c7afc(0x257)](0x0);try{const _0x5e0642=await this['getStateAsync'](_0x5c7afc(0x104));if(_0x5e0642&&_0x5e0642[_0x5c7afc(0x127)])_0x310f41=JSON[_0x5c7afc(0x20f)](_0x5e0642[_0x5c7afc(0x127)]);else{const _0x4e6903=new Date()['setHours'](0x0,0x0,0x0,0x0);this[_0x5c7afc(0x1a6)]&&this['eventHistory'][_0x5c7afc(0x22a)](_0xd07a5b=>{const _0x209d37=_0x5c7afc;if(_0xd07a5b[_0x209d37(0x15a)]>=_0x4e6903){const _0x393efe=new Date(_0xd07a5b[_0x209d37(0x15a)])[_0x209d37(0x1bf)]();if(_0x393efe>=0x0&&_0x393efe<0x18)_0x310f41[_0x393efe]++;}});}}catch(_0x5588a2){this['log'][_0x5c7afc(0x223)](_0x5c7afc(0x11d)+_0x5588a2[_0x5c7afc(0x230)]);}let _0x2d78fc=![],_0x26d7b2='',_0x4c6061='',_0x3ca2ec='';try{const _0x4e500b=await this[_0x5c7afc(0x182)](_0x5c7afc(0x1cb));if(_0x4e500b&&_0x4e500b[_0x5c7afc(0x127)]){_0x2d78fc=!![];const _0x46d28e=await this[_0x5c7afc(0x182)]('analysis.automation.description');_0x26d7b2=_0x46d28e?_0x46d28e[_0x5c7afc(0x127)]:'';const _0x31fdaa=await this[_0x5c7afc(0x182)](_0x5c7afc(0x1bb));_0x4c6061=_0x31fdaa?_0x31fdaa[_0x5c7afc(0x127)]:'';const _0x2172ae=await this[_0x5c7afc(0x182)](_0x5c7afc(0x1ca));_0x3ca2ec=_0x2172ae?_0x2172ae[_0x5c7afc(0x127)]:'';}}catch(_0x112c36){}const _0x3125fe=await this[_0x5c7afc(0x171)](),_0x10f8c7=(this['config'][_0x5c7afc(0x17e)]||[])[_0x5c7afc(0x1ad)](_0xa1dd55=>_0xa1dd55[_0x5c7afc(0x169)]),_0x5d2bcc=_0x3125fe&&_0x10f8c7;let _0x4978e8='';try{const _0x2565e4=await this['getStateAsync']('system.presenceWho');if(_0x2565e4&&_0x2565e4[_0x5c7afc(0x127)])_0x4978e8=_0x2565e4[_0x5c7afc(0x127)];}catch(_0x123846){}this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![],'eventHistory':this[_0x5c7afc(0x1a6)][_0x5c7afc(0x13a)](0x0,0x64),'stats':{'digestCount':_0xe7edb2,'isPresent':this[_0x5c7afc(0x166)],'hourlyActivity':_0x310f41,'solarActive':_0x5d2bcc,'presenceWho':_0x4978e8},'automation':{'detected':_0x2d78fc,'description':_0x26d7b2,'targetId':_0x4c6061,'targetValue':_0x3ca2ec}},_0x447b10[_0x5c7afc(0x170)]);}else{if(_0x447b10['command']===_0x5c7afc(0x16b)){const _0x37f961=await this[_0x5c7afc(0x172)](_0x5c7afc(0x10e),_0x5c7afc(0x192)),_0x55a51f=[];if(_0x37f961)for(const _0x117321 in _0x37f961){const _0x1d791e=_0x37f961[_0x117321],_0x5261e6=(_0x1d791e[_0x5c7afc(0x14c)]&&typeof _0x1d791e[_0x5c7afc(0x14c)][_0x5c7afc(0x11a)]===_0x5c7afc(0x253)?_0x1d791e[_0x5c7afc(0x14c)][_0x5c7afc(0x11a)]['de']:_0x1d791e['common'][_0x5c7afc(0x11a)])||_0x1d791e['common']['name'];_0x55a51f['push']({'id':_0x117321,'name':_0x5261e6});}const _0xc1b6d1=await this[_0x5c7afc(0x172)](_0x5c7afc(0x103),_0x5c7afc(0x192)),_0x22f413=[];if(_0xc1b6d1)for(const _0x4bb131 in _0xc1b6d1){const _0x5fd59a=_0xc1b6d1[_0x4bb131],_0x2457be=(_0x5fd59a[_0x5c7afc(0x14c)]&&typeof _0x5fd59a[_0x5c7afc(0x14c)][_0x5c7afc(0x11a)]===_0x5c7afc(0x253)?_0x5fd59a['common'][_0x5c7afc(0x11a)]['de']:_0x5fd59a[_0x5c7afc(0x14c)][_0x5c7afc(0x11a)])||_0x4bb131[_0x5c7afc(0x258)]('.')[_0x5c7afc(0x149)]();_0x22f413[_0x5c7afc(0x161)](_0x2457be);}this['sendTo'](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![],'enums':_0x55a51f,'rooms':_0x22f413},_0x447b10[_0x5c7afc(0x170)]);}else{if(_0x447b10[_0x5c7afc(0x231)]==='testContext')try{let _0x4d292a='Kein\x20Wetter-Adapter',_0xcb3b8a=_0x5c7afc(0x18b);if(this[_0x5c7afc(0x24a)][_0x5c7afc(0x20e)]){const _0x30246f=await recorder[_0x5c7afc(0x1ce)](this);_0x4d292a=_0x30246f!==null?_0x30246f+'Â°C':_0x5c7afc(0x20b);}if(this[_0x5c7afc(0x24a)][_0x5c7afc(0x15f)]){const _0x3971a8=await this[_0x5c7afc(0x1b3)](_0x5c7afc(0x10d)+this[_0x5c7afc(0x24a)][_0x5c7afc(0x15f)]);_0xcb3b8a=_0x3971a8?_0x5c7afc(0x237):_0x5c7afc(0x227);}this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![],'weather':_0x4d292a,'calendar':_0xcb3b8a},_0x447b10['callback']);}catch(_0x2b4bb1){this[_0x5c7afc(0x242)](_0x447b10['from'],_0x447b10[_0x5c7afc(0x231)],{'success':![],'error':_0x2b4bb1[_0x5c7afc(0x230)]},_0x447b10[_0x5c7afc(0x170)]);}else{if(_0x447b10[_0x5c7afc(0x231)]===_0x5c7afc(0x1a3))try{const _0x524635=_0x447b10[_0x5c7afc(0x230)][_0x5c7afc(0x17d)],_0x1e9164=await this[_0x5c7afc(0x238)](_0x524635+_0x5c7afc(0x1c7));let _0x594b10=[];if(_0x1e9164&&_0x1e9164['val']){const _0x1120cc=JSON[_0x5c7afc(0x20f)](_0x1e9164[_0x5c7afc(0x127)]),_0x5b566f=new Set();Array[_0x5c7afc(0x118)](_0x1120cc)&&_0x1120cc[_0x5c7afc(0x22a)](_0x2e8550=>{const _0x1cb086=_0x5c7afc;if(_0x2e8550[_0x1cb086(0x130)])_0x5b566f[_0x1cb086(0x221)](_0x2e8550[_0x1cb086(0x130)]);else{if(_0x2e8550[_0x1cb086(0x157)])_0x5b566f['add'](_0x2e8550[_0x1cb086(0x157)]);}}),_0x594b10=Array[_0x5c7afc(0x1b8)](_0x5b566f)[_0x5c7afc(0x177)]();}if(_0x594b10[_0x5c7afc(0x246)]===0x0)_0x594b10=['Standard'];this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![],'names':_0x594b10},_0x447b10['callback']);}catch(_0x32c059){this['sendTo'](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10['command'],{'success':![],'error':_0x32c059[_0x5c7afc(0x230)]},_0x447b10['callback']);}else{if(_0x447b10[_0x5c7afc(0x231)]==='testNotification')try{await setup[_0x5c7afc(0x153)](this,_0x5c7afc(0x1ed),![],![]),this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10[_0x5c7afc(0x231)],{'success':!![],'message':_0x5c7afc(0x232)},_0x447b10['callback']);}catch(_0x2ac350){this['log'][_0x5c7afc(0x19a)]('Notification\x20Test\x20Failed:\x20'+_0x2ac350[_0x5c7afc(0x230)]),this[_0x5c7afc(0x242)](_0x447b10[_0x5c7afc(0x1b8)],_0x447b10['command'],{'success':![],'message':'Fehler:\x20'+_0x2ac350['message']},_0x447b10[_0x5c7afc(0x170)]);}}}}}}}}}}}}}}}}}async[a0_0x2fe12b(0x222)](){const _0x4735d3=a0_0x2fe12b;try{const _0x1e1b5d=await this[_0x4735d3(0x182)](setup[_0x4735d3(0x179)]);_0x1e1b5d&&_0x1e1b5d[_0x4735d3(0x127)]&&Object[_0x4735d3(0x1f3)](setup[_0x4735d3(0x1f2)])[_0x4735d3(0x155)](_0x1e1b5d['val'])?this[_0x4735d3(0x1b2)]=_0x1e1b5d[_0x4735d3(0x127)]:(this[_0x4735d3(0x1b2)]=setup[_0x4735d3(0x1f2)][_0x4735d3(0x22d)],await this[_0x4735d3(0x1bc)](setup['SYSTEM_DP_MODE'],{'val':setup[_0x4735d3(0x1f2)]['NORMAL'],'ack':!![]}));}catch(_0x43e95e){this[_0x4735d3(0x1b2)]=setup['SYSTEM_MODES'][_0x4735d3(0x22d)];}}async[a0_0x2fe12b(0x158)](){const _0x341b6a=a0_0x2fe12b;try{const _0x2c6e63=this[_0x341b6a(0x24a)]['presenceDevices']||[];let _0x2a4840=![];const _0x2fca5b=[];for(const _0x544b37 of _0x2c6e63){try{const _0x2cb951=await this[_0x341b6a(0x238)](_0x544b37);_0x2cb951&&(_0x2cb951[_0x341b6a(0x127)]===!![]||_0x2cb951[_0x341b6a(0x127)]===_0x341b6a(0x123)||_0x2cb951[_0x341b6a(0x127)]===0x1)&&(_0x2a4840=!![],_0x2fca5b[_0x341b6a(0x161)](_0x544b37));}catch(_0xf85808){}}return await this[_0x341b6a(0x1bc)](_0x341b6a(0x144),{'val':_0x2fca5b[_0x341b6a(0x159)](',\x20'),'ack':!![]}),_0x2a4840&&(this['exitTimer']&&(this[_0x341b6a(0x19c)][_0x341b6a(0x128)](_0x341b6a(0x139)),recorder['abortExitTimer'](this)),!this[_0x341b6a(0x166)]&&this[_0x341b6a(0x1b2)]===setup['SYSTEM_MODES'][_0x341b6a(0x22d)]&&await recorder[_0x341b6a(0x12f)](this,!![])),_0x2a4840;}catch(_0x3a871e){return![];}}async['runAutopilot'](){const _0x554dc8=a0_0x2fe12b;this[_0x554dc8(0x19c)][_0x554dc8(0x23a)](_0x554dc8(0x168)),await aiAgent[_0x554dc8(0x124)](this),this['updateHealthVector'](),this['triggerGaitAnalysis'](),this[_0x554dc8(0x254)]();}async[a0_0x2fe12b(0x171)](){const _0x51ad5f=a0_0x2fe12b,_0x12d1f4=[_0x51ad5f(0x122),_0x51ad5f(0x23d),_0x51ad5f(0x1f6)],_0x5d653d=[_0x51ad5f(0x15b),_0x51ad5f(0x11b),_0x51ad5f(0x1e5)];for(const _0x254705 of _0x12d1f4){for(const _0x540e54 of _0x5d653d){try{const _0x2c0586=_0x254705+'.'+_0x540e54,_0x266e3c=await this[_0x51ad5f(0x238)](_0x2c0586);if(_0x266e3c&&_0x266e3c[_0x51ad5f(0x127)]){const _0x4626f2=String(_0x266e3c['val'])[_0x51ad5f(0x1c0)]();if(_0x4626f2[_0x51ad5f(0x155)]('sonn')||_0x4626f2['includes']('sunny')||_0x4626f2[_0x51ad5f(0x155)](_0x51ad5f(0x15c))||_0x4626f2[_0x51ad5f(0x155)]('clear')||_0x4626f2[_0x51ad5f(0x155)](_0x51ad5f(0x189)))return!![];}}catch(_0x431939){}}}return![];}[a0_0x2fe12b(0x131)](){const _0x1f2ac9=a0_0x2fe12b;if(!this[_0x1f2ac9(0x111)])return;try{this[_0x1f2ac9(0x17f)](_0x1f2ac9(0x22e),(_0x528b8f,_0x437b2c)=>{const _0x33e276=_0x1f2ac9;_0x437b2c&&_0x437b2c[_0x33e276(0x127)]&&pythonBridge[_0x33e276(0x218)](this,'ANALYZE_GAIT',{'sequences':JSON[_0x33e276(0x20f)](_0x437b2c['val'])});});}catch(_0x391652){}}async[a0_0x2fe12b(0x254)](){const _0x382dbe=a0_0x2fe12b;if(!this[_0x382dbe(0x111)])return;try{const _0x48ad38=await recorder[_0x382dbe(0x1ce)](this);if(_0x48ad38===null)return;const _0x293196={},_0x4a45d7={},_0x1cc8cb=this['config'][_0x382dbe(0x17e)]||[];for(const _0x9fe3e of _0x1cc8cb){if(_0x9fe3e[_0x382dbe(0x1a7)]===_0x382dbe(0x20c)&&_0x9fe3e['location']){const _0x36dca3=this[_0x382dbe(0x152)][_0x9fe3e['id']];if(_0x36dca3!==undefined)_0x293196[_0x9fe3e['location']]=_0x36dca3;if(_0x9fe3e['isSolar'])_0x4a45d7[_0x9fe3e[_0x382dbe(0x24e)]]=!![];}}const _0x23f80d=await this[_0x382dbe(0x171)]();let _0x335d52={};try{const _0x473f53=await this[_0x382dbe(0x182)](_0x382dbe(0x202));if(_0x473f53&&_0x473f53[_0x382dbe(0x127)])_0x335d52=JSON[_0x382dbe(0x20f)](_0x473f53['val']);}catch(_0x4bf64b){}Object[_0x382dbe(0x213)](_0x293196)[_0x382dbe(0x246)]>0x0&&(pythonBridge['send'](this,'PREDICT_ENERGY',{'current_temps':_0x293196,'t_out':_0x48ad38,'is_sunny':_0x23f80d,'solar_flags':_0x4a45d7,'warmup_targets':_0x335d52}),pythonBridge[_0x382dbe(0x218)](this,_0x382dbe(0x1de),{'current_temps':_0x293196,'t_out':_0x48ad38,'targets':{}}));}catch(_0x4134b4){}}['updateHealthVector'](){const _0x56a09f=a0_0x2fe12b;if(!this[_0x56a09f(0x1e8)]||this[_0x56a09f(0x1e8)][_0x56a09f(0x246)]===0x0)return;const _0x330524=new Array(0x60)[_0x56a09f(0x257)](0x0),_0xc371c8=new Date()['setHours'](0x0,0x0,0x0,0x0);this[_0x56a09f(0x1e8)][_0x56a09f(0x22a)](_0x30f52a=>{const _0x955ba3=_0x56a09f,_0x54dd7f=new Date(_0x30f52a[_0x955ba3(0x15a)]);if(_0x54dd7f['getTime']()>=_0xc371c8){const _0x357d7f=_0x54dd7f[_0x955ba3(0x1bf)](),_0x36ebc0=_0x54dd7f[_0x955ba3(0x1d3)](),_0x58baf1=_0x357d7f*0x4+Math['floor'](_0x36ebc0/0xf);if(_0x58baf1>=0x0&&_0x58baf1<0x60)_0x330524[_0x58baf1]++;}});}['runPythonHealthCheck'](){const _0x44f0b6=a0_0x2fe12b;if(!this[_0x44f0b6(0x141)]||this[_0x44f0b6(0x141)]['length']<0x2)return;const _0x3be642=this[_0x44f0b6(0x141)][_0x44f0b6(0x215)](_0x1b9467=>{const _0x44c43a=_0x44f0b6,_0x2b4af5=(_0x1b9467[_0x44c43a(0x1c2)]||'')[_0x44c43a(0x1c0)]();return ACTIVITY_LEVEL_MAP[_0x2b4af5]||0x32;});pythonBridge[_0x44f0b6(0x218)](this,'ANALYZE_TREND',{'values':_0x3be642,'tag':_0x44f0b6(0x13e)});}async['handleInfrasound'](_0x1cbe67){const _0x169248=a0_0x2fe12b;if(_0x1cbe67==null||typeof _0x1cbe67!==_0x169248(0x1d1))return;const _0x1f26da=Date[_0x169248(0x1f4)]();this[_0x169248(0x1d0)][_0x169248(0x161)]({'ts':_0x1f26da,'val':_0x1cbe67}),this[_0x169248(0x1d0)]=this['pressureBuffer'][_0x169248(0x188)](_0x1ba8c2=>_0x1f26da-_0x1ba8c2['ts']<0x1388);if(this['infrasoundLocked'])return;if(this['config'][_0x169248(0x14b)]){const _0x288cb9=await this[_0x169248(0x238)](this[_0x169248(0x24a)]['infrasoundArmingId']);if(_0x288cb9&&!_0x288cb9['val'])return;}const _0xb2151f=this[_0x169248(0x24a)][_0x169248(0x1fa)]||0.04;if(Math['abs'](_0x1cbe67)>=_0xb2151f){this[_0x169248(0x19c)][_0x169248(0x223)]('[Infrasound]\x20ðŸš¨\x20ALARM\x20TRIGGERED!\x20Pressure\x20Wave:\x20'+_0x1cbe67+_0x169248(0x1c8)+_0xb2151f+')'),await this[_0x169248(0x1bc)](_0x169248(0x114),{'val':!![],'ack':!![]});const _0x104b45=this['isPresent'];_0x104b45?(this[_0x169248(0x19c)]['info'](_0x169248(0x18e)),this[_0x169248(0x1d6)](_0x1cbe67,'INTERNAL')):(this[_0x169248(0x1d6)](_0x1cbe67,_0x169248(0x134)),this[_0x169248(0x153)](_0x169248(0x251)+_0x1cbe67+_0x169248(0x1f5))),this[_0x169248(0x219)]=!![],setTimeout(()=>{const _0x4f434c=_0x169248;this[_0x4f434c(0x219)]=![];},0x2710);}}async['triggerInfrasoundCorrelation'](_0x28cf3e,_0x3a96cb=a0_0x2fe12b(0x134)){const _0x149977=a0_0x2fe12b,_0x35638e=Date[_0x149977(0x1f4)](),_0x4efd6d=this['config']['devices']||[];setTimeout(async()=>{const _0x2d343f=_0x149977;let _0x3b89d8=null,_0x4b3135=_0x2d343f(0x126);const _0x155caa=_0x4efd6d[_0x2d343f(0x188)](_0x565de8=>_0x565de8[_0x2d343f(0x1a7)]&&(_0x565de8[_0x2d343f(0x1a7)][_0x2d343f(0x155)](_0x2d343f(0x1db))||_0x565de8[_0x2d343f(0x1a7)][_0x2d343f(0x155)]('door')||_0x565de8[_0x2d343f(0x1a7)][_0x2d343f(0x155)](_0x2d343f(0x1e3))||_0x565de8[_0x2d343f(0x1a7)][_0x2d343f(0x155)](_0x2d343f(0x206)))||_0x565de8[_0x2d343f(0x255)]&&(_0x565de8['role'][_0x2d343f(0x155)]('sensor.window')||_0x565de8[_0x2d343f(0x255)][_0x2d343f(0x155)]('sensor.door')));for(const _0x441f8e of _0x155caa){try{const _0x597d8b=await this[_0x2d343f(0x238)](_0x441f8e['id']);if(_0x597d8b){if(_0x597d8b['ts']>=_0x35638e-0x7d0){_0x3b89d8=_0x441f8e['name']||_0x441f8e['id'],_0x4b3135=_0x2d343f(0x1cc)+_0x3b89d8;break;}}}catch(_0x8a8cd2){}}const _0xe3450e={'timestamp':_0x35638e,'pressure':_0x28cf3e,'isMatch':!!_0x3b89d8,'explanation':_0x4b3135,'type':_0x3a96cb};await this[_0x2d343f(0x1fe)](_0xe3450e),this['log']['info'](_0x2d343f(0x14f)+(!!_0x3b89d8?_0x2d343f(0x1af):_0x2d343f(0x185)));},0x1388);}async['analyzeWindowOpening'](_0x12c4ef){const _0x2f55ba=a0_0x2fe12b,_0x2300a1=Date[_0x2f55ba(0x1f4)](),_0xd80aaf=_0x12c4ef[_0x2f55ba(0x11a)]||_0x12c4ef['id'][_0x2f55ba(0x258)]('.')[_0x2f55ba(0x149)]();let _0x22c63a=0x0;setTimeout(async()=>{const _0x3185b9=_0x2f55ba;this[_0x3185b9(0x1d0)][_0x3185b9(0x22a)](_0x205d22=>{const _0x1cac3e=_0x3185b9;_0x205d22['ts']>=_0x2300a1-0xfa0&&_0x205d22['ts']<=_0x2300a1+0x3e8&&(Math[_0x1cac3e(0x184)](_0x205d22[_0x1cac3e(0x127)])>Math[_0x1cac3e(0x184)](_0x22c63a)&&(_0x22c63a=_0x205d22['val']));});const _0x27c332=this[_0x3185b9(0x24a)]['infrasoundThreshold']||0.04,_0x2ea6da=Math[_0x3185b9(0x184)](_0x22c63a)>=_0x27c332,_0x3f4239={'timestamp':_0x2300a1,'pressure':_0x22c63a,'isMatch':_0x2ea6da,'explanation':_0x3185b9(0x15e)+_0xd80aaf,'type':_0x3185b9(0x16e)};await this['appendToLog'](_0x3f4239),this[_0x3185b9(0x19c)]['debug']('[Calibration]\x20Window\x20'+_0xd80aaf+_0x3185b9(0x1b9)+_0x22c63a[_0x3185b9(0x181)](0x4)+_0x3185b9(0x1fd)+_0x27c332+')');},0x1f4);}async[a0_0x2fe12b(0x1fe)](_0x3de9bd){const _0x364620=a0_0x2fe12b;try{const _0x283eca=await this[_0x364620(0x182)](_0x364620(0x1e9));let _0x2eff1a=[];if(_0x283eca&&_0x283eca[_0x364620(0x127)])_0x2eff1a=JSON[_0x364620(0x20f)](_0x283eca['val']);_0x2eff1a[_0x364620(0x217)](_0x3de9bd);if(_0x2eff1a[_0x364620(0x246)]>0x14)_0x2eff1a=_0x2eff1a['slice'](0x0,0x14);await this[_0x364620(0x1bc)](_0x364620(0x1e9),{'val':JSON[_0x364620(0x129)](_0x2eff1a),'ack':!![]});}catch(_0x3c25f){this['log'][_0x364620(0x19a)](_0x364620(0x154)+_0x3c25f['message']);}}[a0_0x2fe12b(0x153)](_0x214334){const _0x302a09=a0_0x2fe12b;this[_0x302a09(0x24a)][_0x302a09(0x199)]&&this[_0x302a09(0x24a)][_0x302a09(0x19e)]&&this[_0x302a09(0x242)](this[_0x302a09(0x24a)][_0x302a09(0x19e)],'send',{'message':_0x214334,'title':_0x302a09(0x12d),'priority':0x1}),this[_0x302a09(0x24a)][_0x302a09(0x17b)]&&this[_0x302a09(0x24a)][_0x302a09(0x13c)]&&this[_0x302a09(0x242)](this[_0x302a09(0x24a)][_0x302a09(0x13c)],_0x302a09(0x218),{'text':_0x214334});}}if(require['main']!==module)module['exports']=_0x4d5a4c=>new CogniLiving(_0x4d5a4c);else new CogniLiving();