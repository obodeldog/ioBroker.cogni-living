const a0_0xe4fe75=a0_0xcfbd;(function(_0x52fb36,_0x2cfd5b){const _0x2b52f2=a0_0xcfbd,_0xb96586=_0x52fb36();while(!![]){try{const _0x5a867e=-parseInt(_0x2b52f2(0x1be))/0x1+parseInt(_0x2b52f2(0x1e5))/0x2*(-parseInt(_0x2b52f2(0x1e6))/0x3)+parseInt(_0x2b52f2(0x19b))/0x4*(-parseInt(_0x2b52f2(0x1cd))/0x5)+parseInt(_0x2b52f2(0x16f))/0x6*(parseInt(_0x2b52f2(0x201))/0x7)+-parseInt(_0x2b52f2(0x1b4))/0x8+-parseInt(_0x2b52f2(0x189))/0x9+parseInt(_0x2b52f2(0x1d2))/0xa;if(_0x5a867e===_0x2cfd5b)break;else _0xb96586['push'](_0xb96586['shift']());}catch(_0x3e78c1){_0xb96586['push'](_0xb96586['shift']());}}}(a0_0x1d1e,0xc04d0));const a0_0x315158=(function(){let _0x2fcccf=!![];return function(_0x41c46e,_0x34e0ca){const _0x3ac079=_0x2fcccf?function(){const _0x7693d1=a0_0xcfbd;if(_0x34e0ca){const _0x4aa992=_0x34e0ca[_0x7693d1(0x195)](_0x41c46e,arguments);return _0x34e0ca=null,_0x4aa992;}}:function(){};return _0x2fcccf=![],_0x3ac079;};}()),a0_0x549dd0=a0_0x315158(this,function(){const _0x3b0f91=a0_0xcfbd;return a0_0x549dd0[_0x3b0f91(0x1e3)]()[_0x3b0f91(0x224)](_0x3b0f91(0x1f3))['toString']()[_0x3b0f91(0x1c6)](a0_0x549dd0)['search'](_0x3b0f91(0x1f3));});function a0_0xcfbd(_0x38f81f,_0x35aa45){const _0x1967c2=a0_0x1d1e();return a0_0xcfbd=function(_0x549dd0,_0x315158){_0x549dd0=_0x549dd0-0x168;let _0x1d1eb4=_0x1967c2[_0x549dd0];return _0x1d1eb4;},a0_0xcfbd(_0x38f81f,_0x35aa45);}function a0_0x1d1e(){const _0x2aa5aa=['ANALYZE_GAIT','runGeminiAnalysis','ready','version','stateChange','5RjnPIz','getTime','LTM.trainingData.thermodynamics','inactivityThresholdHours','now','56085120AGtzUQ','fill','sendMorningBriefing','initSystemConfig','Verbindung\x20erfolgreich!','analysis.topology.structure','getEnums','exitTimer','analysis.training.triggerSecurity','notifyTelegramEnabled','parse','enum','Verbunden','common','subscribeStates','unload','map','toString','PREDICT_ENERGY','2218gqATlq','2400uZZvCt','keys','isPresent','setPresence','checkWifiPresence','Daten\x20nicht\x20verfÃ¼gbar','analysis.health.todayVector','values','.system.mode','analysis.triggerBriefing','cancel','isProVersion','matrix','(((.+)+)+)+$','_calName','analysis.training.triggerEnergy','sensorLastValues','TRAIN_COMFORT','stringify','updateLocation','triggerDailyDigest','LTM.dailyDigests','communicate.request','.communicate.request','updated','abortExitTimer','presenceDevices','14biUwVy','send','runAutopilot','motion','ack','activityLevel','updateHealthVector','triggerGaitAnalysis','getCalendarNames','getStateAsync','TRAIN_ENERGY','notifyTelegramInstance','getOverviewData','automation.triggerAction','getOutsideTemperatureNumeric','analysis.training.status','sendTo','lastAlertState','sort','Aktiv\x20(','testContext','cogni-living','checkLicense','createDailyDigest','timestamp','analysis.training.triggerComfort','SYSTEM_MODES','startSystem','Adapter','includes','TRAIN_SECURITY','TRAIN_HEALTH','analysis.automation.triggerAction','LTM.triggerDailyDigest','ANALYZE_TREND','search','telegram','executeAutomationAction','Test','runPythonHealthCheck','analysis.training.triggerTopology','forEach','onReady','SYSTEM_DP_MODE','command','./lib/dead_man','getGenerativeModel','scanDevices','updateTopology','Lernphase\x20(','getHours','analysisTimer','text','enum.rooms.*',')\x20-\x20Phase\x20C\x20(Hardened)','name','bind','calendarName','message','./lib/installer','analysisInterval','analysis.trigger','generateContent','error','object','briefingJob','isArray','Gemini\x20AI\x20initialized.','4057584eflcIc','application/json','push','from','Instanz\x20nicht\x20gefunden','Kein\x20API\x20Key\x20Ã¼bergeben','geminiApiKey','SET_TOPOLOGY','val','eventHistory','stopService','join','./lib/recorder','getForeignObjectsAsync','LTM.baselineStatus','getForeignStateAsync','main','currentSystemMode','temperature','setState','subscribeForeignStatesAsync','genAI','updateTopologyMatrix','initZombies','system.mode','toLowerCase','12009060GskLAy','PYTHON_EXE','dailyDigests','modeResetJob','initHistory','analysis.automation.autoApply','exports','devices','sendNotification','weatherInstance','onUnload','LTM.trainingData.sequences','apply','pop','find','processSensorEvent','testApiKey','ltmJob','6238492iScaHj','loadSystemMode','triggerEnergyPrediction','log','split','checkAndInstall','apiKey','startService','LTM.rawEventLog','setupLtmScheduler','Keine\x20Antwort\x20von\x20Gemini','./lib/python_bridge','config','\x20Tage)','isGracePeriodActive','./lib/scanner','minDaysForBaseline','instance','setHours','driftAnalysisTimer','floor','namespace','NORMAL','callback','setupModeResetScheduler','11053424ghLjfY','analysisHistory','enum.functions.*','endsWith','dependencyInstallInProgress','Gemini\x20Init\x20Error:\x20','length','geminiModel','location','Fehler:\x20','1010535WaIYPw','info','type','onMessage','calendarInstance','rawEventLog','models/gemini-flash-latest','setStateAsync','constructor','onStateChange'];a0_0x1d1e=function(){return _0x2aa5aa;};return a0_0x1d1e();}a0_0x549dd0();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),installer=require(a0_0xe4fe75(0x23c)),scanner=require(a0_0xe4fe75(0x1aa)),schedulers=require('./lib/scheduler'),topology=require('./lib/topology'),setup=require('./lib/setup'),recorder=require(a0_0xe4fe75(0x17b)),pythonBridge=require(a0_0xe4fe75(0x1a6)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0xe4fe75(0x22e)),GEMINI_MODEL=a0_0xe4fe75(0x1c4),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils[a0_0xe4fe75(0x21d)]{constructor(_0x370a71){const _0x27cfcb=a0_0xe4fe75;super({..._0x370a71,'name':_0x27cfcb(0x216)}),this[_0x27cfcb(0x178)]=[],this[_0x27cfcb(0x1b5)]=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x27cfcb(0x1f6)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x27cfcb(0x1e8)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x27cfcb(0x1a9)]=![],this[_0x27cfcb(0x184)]=null,this[_0x27cfcb(0x1bb)]=null,this[_0x27cfcb(0x180)]=setup[_0x27cfcb(0x21b)][_0x27cfcb(0x1b1)],this['isProVersion']=![],this[_0x27cfcb(0x212)]=![],this['analysisTimer']=null,this[_0x27cfcb(0x19a)]=null,this[_0x27cfcb(0x18c)]=null,this[_0x27cfcb(0x1ae)]=null,this[_0x27cfcb(0x16c)]=null,this[_0x27cfcb(0x1b8)]=![],this['on'](_0x27cfcb(0x1ca),this['onReady'][_0x27cfcb(0x239)](this)),this['on'](_0x27cfcb(0x1cc),this[_0x27cfcb(0x1c7)]['bind'](this)),this['on'](_0x27cfcb(0x1e1),this[_0x27cfcb(0x193)]['bind'](this)),this['on'](_0x27cfcb(0x23b),this[_0x27cfcb(0x1c1)][_0x27cfcb(0x239)](this));}async[a0_0xe4fe75(0x22b)](){const _0x5cbb59=a0_0xe4fe75;this['log'][_0x5cbb59(0x1bf)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x5cbb59(0x1cb)]+_0x5cbb59(0x237));if(!installer[_0x5cbb59(0x1a0)](this,()=>this['startSystem']()))return;}async[a0_0xe4fe75(0x21c)](){const _0x5d7bee=a0_0xe4fe75;await setup[_0x5d7bee(0x186)](this);try{this[_0x5d7bee(0x1f1)]=await setup[_0x5d7bee(0x217)](this['config']['licenseKey']);}catch(_0x11eba3){}if(!this['config'][_0x5d7bee(0x1d0)]||this[_0x5d7bee(0x1a7)]['inactivityThresholdHours']<0.1)this[_0x5d7bee(0x1a7)][_0x5d7bee(0x1d0)]=0xc;await setup[_0x5d7bee(0x18d)](this),await setup[_0x5d7bee(0x1d5)](this);if(this[_0x5d7bee(0x1a7)][_0x5d7bee(0x175)])try{this[_0x5d7bee(0x184)]=new GoogleGenerativeAI(this[_0x5d7bee(0x1a7)][_0x5d7bee(0x175)]),this[_0x5d7bee(0x1bb)]=this[_0x5d7bee(0x184)][_0x5d7bee(0x22f)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5d7bee(0x170)}}),this[_0x5d7bee(0x19e)][_0x5d7bee(0x1bf)](_0x5d7bee(0x16e));}catch(_0x5766e8){this['log'][_0x5d7bee(0x16a)](_0x5d7bee(0x1b9)+_0x5766e8[_0x5d7bee(0x23b)]);}await setup['createAllObjects'](this),await this[_0x5d7bee(0x19c)]();try{const _0x4d585f=await this[_0x5d7bee(0x20a)]('LTM.rawEventLog');if(_0x4d585f&&_0x4d585f[_0x5d7bee(0x177)])this[_0x5d7bee(0x1c3)]=JSON[_0x5d7bee(0x1dc)](_0x4d585f[_0x5d7bee(0x177)]);}catch(_0x7f5ea2){this[_0x5d7bee(0x1c3)]=[];}try{const _0x1053ad=await this[_0x5d7bee(0x20a)](_0x5d7bee(0x1fb));if(_0x1053ad&&_0x1053ad[_0x5d7bee(0x177)])this[_0x5d7bee(0x18b)]=JSON[_0x5d7bee(0x1dc)](_0x1053ad['val']);}catch(_0x58e490){this[_0x5d7bee(0x18b)]=[];}const _0x12aab5=this['dailyDigests'][_0x5d7bee(0x1ba)]>=(this[_0x5d7bee(0x1a7)][_0x5d7bee(0x1ab)]||0x7)?_0x5d7bee(0x214)+this[_0x5d7bee(0x18b)][_0x5d7bee(0x1ba)]+_0x5d7bee(0x1a8):_0x5d7bee(0x232)+this[_0x5d7bee(0x18b)]['length']+'/'+(this[_0x5d7bee(0x1a7)]['minDaysForBaseline']||0x7)+')';await this[_0x5d7bee(0x1c5)](_0x5d7bee(0x17d),{'val':_0x12aab5,'ack':!![]}),this[_0x5d7bee(0x1e0)](_0x5d7bee(0x168)),this['subscribeStates'](_0x5d7bee(0x222)),this[_0x5d7bee(0x1e0)](_0x5d7bee(0x187)),this[_0x5d7bee(0x1e0)](_0x5d7bee(0x1ef)),this['subscribeStates'](_0x5d7bee(0x221)),this[_0x5d7bee(0x1e0)](_0x5d7bee(0x18e)),this['subscribeStates'](_0x5d7bee(0x1da)),this[_0x5d7bee(0x1e0)]('analysis.training.triggerHealth'),this[_0x5d7bee(0x1e0)](_0x5d7bee(0x1f5)),this[_0x5d7bee(0x1e0)](_0x5d7bee(0x21a)),this[_0x5d7bee(0x1e0)](_0x5d7bee(0x229));const _0x1049e9=this[_0x5d7bee(0x1a7)][_0x5d7bee(0x190)];if(_0x1049e9)for(const _0x27ad12 of _0x1049e9){await this[_0x5d7bee(0x183)](_0x27ad12['id']);}const _0x5f00c1=this[_0x5d7bee(0x1a7)][_0x5d7bee(0x200)];if(_0x5f00c1)for(const _0x19ec78 of _0x5f00c1){await this[_0x5d7bee(0x183)](_0x19ec78);}if(this[_0x5d7bee(0x1a7)][_0x5d7bee(0x1db)]&&this['config'][_0x5d7bee(0x20c)])await this[_0x5d7bee(0x183)](this[_0x5d7bee(0x1a7)]['notifyTelegramInstance']+_0x5d7bee(0x1fd));setTimeout(()=>this['checkWifiPresence'](),0x1388);if(this[_0x5d7bee(0x234)])clearInterval(this[_0x5d7bee(0x234)]);const _0xb1b9c9=this[_0x5d7bee(0x1a7)][_0x5d7bee(0x23d)]||0xf;_0xb1b9c9>0x0&&(this[_0x5d7bee(0x234)]=setInterval(()=>{const _0x20d1b7=_0x5d7bee;this[_0x20d1b7(0x203)]();},_0xb1b9c9*0x3c*0x3e8)),schedulers[_0x5d7bee(0x1a4)](this,()=>aiAgent[_0x5d7bee(0x218)](this,pythonBridge)),schedulers[_0x5d7bee(0x1b3)](this),schedulers['setupDriftAnalysisScheduler'](this,()=>aiAgent['runBaselineDriftAnalysis'](this)),schedulers['setupBriefingScheduler'](this,()=>aiAgent['sendMorningBriefing'](this)),pythonBridge[_0x5d7bee(0x1a2)](this,installer[_0x5d7bee(0x18a)]),setTimeout(async()=>{const _0x1b01db=_0x5d7bee;await topology[_0x1b01db(0x231)](this);try{const _0x31998e=await this['getStateAsync'](_0x1b01db(0x1d7));if(_0x31998e&&_0x31998e[_0x1b01db(0x177)])pythonBridge[_0x1b01db(0x202)](this,_0x1b01db(0x176),JSON[_0x1b01db(0x1dc)](_0x31998e[_0x1b01db(0x177)]));}catch(_0x58a2f9){}this['runPythonHealthCheck'](),this[_0x1b01db(0x208)](),this[_0x1b01db(0x19d)](),this[_0x1b01db(0x207)]();},0x1388);}['onUnload'](_0x540a35){const _0x4ad076=a0_0xe4fe75;if(this[_0x4ad076(0x234)])clearInterval(this[_0x4ad076(0x234)]);if(this[_0x4ad076(0x1ae)])clearInterval(this[_0x4ad076(0x1ae)]);if(this[_0x4ad076(0x19a)])this[_0x4ad076(0x19a)][_0x4ad076(0x1f0)]();if(this[_0x4ad076(0x18c)])this[_0x4ad076(0x18c)][_0x4ad076(0x1f0)]();if(this[_0x4ad076(0x16c)])this['briefingJob'][_0x4ad076(0x1f0)]();recorder[_0x4ad076(0x1ff)](this),pythonBridge[_0x4ad076(0x179)](this),_0x540a35();}async[a0_0xe4fe75(0x1c7)](_0x17da55,_0x3bf180){const _0x5a4438=a0_0xe4fe75;if(!_0x3bf180||this[_0x5a4438(0x1b8)])return;if(_0x17da55[_0x5a4438(0x21e)](_0x5a4438(0x225))&&_0x17da55[_0x5a4438(0x1b7)](_0x5a4438(0x1fc))&&_0x3bf180[_0x5a4438(0x177)])return;if(_0x17da55===this[_0x5a4438(0x1b0)]+_0x5a4438(0x1ee)){if(_0x3bf180[_0x5a4438(0x177)]&&Object[_0x5a4438(0x1ed)](setup[_0x5a4438(0x21b)])['includes'](_0x3bf180[_0x5a4438(0x177)])){this[_0x5a4438(0x180)]=_0x3bf180[_0x5a4438(0x177)];if(_0x3bf180[_0x5a4438(0x177)]===setup[_0x5a4438(0x21b)]['VACATION'])await recorder[_0x5a4438(0x1e9)](this,![]);else await recorder[_0x5a4438(0x1e9)](this,!![]);}if(!_0x3bf180[_0x5a4438(0x205)])this[_0x5a4438(0x182)](_0x17da55,{'val':this[_0x5a4438(0x180)],'ack':!![]});return;}if(!_0x3bf180[_0x5a4438(0x205)]){_0x17da55[_0x5a4438(0x21e)](_0x5a4438(0x168))&&_0x3bf180[_0x5a4438(0x177)]&&(this['setState'](_0x17da55,{'val':![],'ack':!![]}),aiAgent[_0x5a4438(0x1c9)](this));if(_0x17da55[_0x5a4438(0x21e)](_0x5a4438(0x1fa))&&_0x3bf180['val']){this['setState'](_0x17da55,{'val':![],'ack':!![]});if(this[_0x5a4438(0x1f1)])aiAgent[_0x5a4438(0x218)](this,pythonBridge);}_0x17da55['includes']('triggerBriefing')&&_0x3bf180[_0x5a4438(0x177)]&&(this[_0x5a4438(0x182)](_0x17da55,{'val':![],'ack':!![]}),aiAgent[_0x5a4438(0x1d4)](this));_0x17da55['includes'](_0x5a4438(0x20e))&&_0x3bf180['val']&&(this[_0x5a4438(0x182)](_0x17da55,{'val':![],'ack':!![]}),aiAgent[_0x5a4438(0x226)](this));if(_0x17da55[_0x5a4438(0x21e)](_0x5a4438(0x1da))&&_0x3bf180[_0x5a4438(0x177)]){this['setState'](_0x17da55,{'val':![],'ack':!![]});if(this[_0x5a4438(0x1f1)])try{const _0x524a32=await this['getStateAsync'](_0x5a4438(0x194));if(_0x524a32&&_0x524a32['val']){const _0x3f7c91=JSON[_0x5a4438(0x1dc)](_0x524a32[_0x5a4438(0x177)]);this[_0x5a4438(0x1c5)](_0x5a4438(0x210),{'val':'Sec-Training\x20started...','ack':!![]}),pythonBridge['send'](this,_0x5a4438(0x21f),{'sequences':_0x3f7c91});}}catch(_0x2c9b9a){}}if(_0x17da55[_0x5a4438(0x21e)]('analysis.training.triggerHealth')&&_0x3bf180['val']){this[_0x5a4438(0x182)](_0x17da55,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x331075=await this[_0x5a4438(0x20a)]('LTM.dailyDigests');if(_0x331075&&_0x331075[_0x5a4438(0x177)])pythonBridge[_0x5a4438(0x202)](this,_0x5a4438(0x220),{'digests':JSON[_0x5a4438(0x1dc)](_0x331075[_0x5a4438(0x177)])});}catch(_0x3733e7){}}if(_0x17da55[_0x5a4438(0x21e)]('analysis.training.triggerEnergy')&&_0x3bf180[_0x5a4438(0x177)]){this[_0x5a4438(0x182)](_0x17da55,{'val':![],'ack':!![]});if(this[_0x5a4438(0x1f1)])try{const _0x4afa21=await this[_0x5a4438(0x20a)](_0x5a4438(0x1cf));if(_0x4afa21&&_0x4afa21[_0x5a4438(0x177)])pythonBridge[_0x5a4438(0x202)](this,_0x5a4438(0x20b),{'points':JSON[_0x5a4438(0x1dc)](_0x4afa21['val'])});}catch(_0x550748){}}if(_0x17da55['includes'](_0x5a4438(0x21a))&&_0x3bf180[_0x5a4438(0x177)]){this['setState'](_0x17da55,{'val':![],'ack':!![]});if(this[_0x5a4438(0x1f1)])try{const _0x13c4f2=await this['getStateAsync'](_0x5a4438(0x1a3));if(_0x13c4f2&&_0x13c4f2[_0x5a4438(0x177)])pythonBridge[_0x5a4438(0x202)](this,_0x5a4438(0x1f7),{'events':JSON[_0x5a4438(0x1dc)](_0x13c4f2['val'])});}catch(_0x159151){}}_0x17da55['includes'](_0x5a4438(0x229))&&_0x3bf180[_0x5a4438(0x177)]&&(this[_0x5a4438(0x182)](_0x17da55,{'val':![],'ack':!![]}),topology['updateTopology'](this));return;}if(this[_0x5a4438(0x1a7)][_0x5a4438(0x200)]&&this[_0x5a4438(0x1a7)]['presenceDevices'][_0x5a4438(0x21e)](_0x17da55)){await this['checkWifiPresence']();return;}const _0x4a01bc=(this[_0x5a4438(0x1a7)][_0x5a4438(0x190)]||[])[_0x5a4438(0x197)](_0x411646=>_0x411646['id']===_0x17da55);if(_0x4a01bc){const _0x151da8=await recorder[_0x5a4438(0x198)](this,_0x17da55,_0x3bf180,_0x4a01bc);_0x151da8&&_0x151da8[_0x5a4438(0x1c0)]===_0x5a4438(0x204)&&_0x151da8[_0x5a4438(0x1bc)]&&this[_0x5a4438(0x1f1)]&&deadMan[_0x5a4438(0x1f9)](this,_0x151da8[_0x5a4438(0x1bc)]);}}async[a0_0xe4fe75(0x1c1)](_0xc5b113){const _0x2cbcf8=a0_0xe4fe75;if(typeof _0xc5b113==='object'&&_0xc5b113[_0x2cbcf8(0x23b)]){if(_0xc5b113[_0x2cbcf8(0x22d)]===_0x2cbcf8(0x199))try{const _0x167ba4=_0xc5b113[_0x2cbcf8(0x23b)][_0x2cbcf8(0x1a1)];if(!_0x167ba4)throw new Error(_0x2cbcf8(0x174));const _0xf1e213=new GoogleGenerativeAI(_0x167ba4),_0x366478=_0xf1e213['getGenerativeModel']({'model':GEMINI_MODEL}),_0x337cb5=await _0x366478[_0x2cbcf8(0x169)](_0x2cbcf8(0x227)),_0xf102ad=await _0x337cb5['response'];if(_0xf102ad[_0x2cbcf8(0x235)]())this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113['command'],{'success':!![],'message':_0x2cbcf8(0x1d6)},_0xc5b113[_0x2cbcf8(0x1b2)]);else throw new Error(_0x2cbcf8(0x1a5));}catch(_0x4153af){this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113['command'],{'success':![],'message':_0x4153af['message']},_0xc5b113[_0x2cbcf8(0x1b2)]);}else{if(_0xc5b113[_0x2cbcf8(0x22d)]===_0x2cbcf8(0x230))try{const _0xaac297=await scanner['scanForDevices'](this,_0xc5b113[_0x2cbcf8(0x23b)]||{});this['sendTo'](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':!![],'devices':_0xaac297},_0xc5b113['callback']);}catch(_0x24c464){this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':![],'error':_0x24c464['message']},_0xc5b113['callback']);}else{if(_0xc5b113[_0x2cbcf8(0x22d)]===_0x2cbcf8(0x185))try{const {matrix:_0x1c281d}=_0xc5b113[_0x2cbcf8(0x23b)],_0x3f3035=await this['getStateAsync'](_0x2cbcf8(0x1d7));if(_0x3f3035&&_0x3f3035[_0x2cbcf8(0x177)]){const _0x55b866=JSON[_0x2cbcf8(0x1dc)](_0x3f3035['val']);_0x55b866[_0x2cbcf8(0x1f2)]=_0x1c281d,_0x55b866[_0x2cbcf8(0x1fe)]=Date[_0x2cbcf8(0x1d1)](),await this['setStateAsync'](_0x2cbcf8(0x1d7),{'val':JSON[_0x2cbcf8(0x1f8)](_0x55b866),'ack':!![]}),pythonBridge[_0x2cbcf8(0x202)](this,'SET_TOPOLOGY',_0x55b866);}this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113['command'],{'success':!![]},_0xc5b113[_0x2cbcf8(0x1b2)]);}catch(_0x1031ac){this[_0x2cbcf8(0x19e)][_0x2cbcf8(0x16a)](_0x1031ac);}else{if(_0xc5b113['command']==='getLtmData')this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':!![],'dailyDigests':this['dailyDigests']||[],'analysisHistory':this[_0x2cbcf8(0x1b5)]||[]},_0xc5b113[_0x2cbcf8(0x1b2)]);else{if(_0xc5b113[_0x2cbcf8(0x22d)]===_0x2cbcf8(0x20d)){const _0x4479f1=this['dailyDigests']['length'],_0x1cb7be=new Array(0x18)[_0x2cbcf8(0x1d3)](0x0),_0x4b35e0=new Date()[_0x2cbcf8(0x1ad)](0x0,0x0,0x0,0x0);this[_0x2cbcf8(0x178)]&&this['eventHistory'][_0x2cbcf8(0x22a)](_0x511a57=>{const _0x2e35de=_0x2cbcf8;if(_0x511a57[_0x2e35de(0x219)]>=_0x4b35e0){const _0x2475c6=new Date(_0x511a57[_0x2e35de(0x219)])[_0x2e35de(0x233)]();if(_0x2475c6>=0x0&&_0x2475c6<0x18)_0x1cb7be[_0x2475c6]++;}}),this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':!![],'eventHistory':this[_0x2cbcf8(0x178)]['slice'](0x0,0xf),'stats':{'digestCount':_0x4479f1,'isPresent':this[_0x2cbcf8(0x1e8)],'hourlyActivity':_0x1cb7be},'automation':{'detected':![]}},_0xc5b113['callback']);}else{if(_0xc5b113[_0x2cbcf8(0x22d)]===_0x2cbcf8(0x1d8)){const _0x251c6e=await this[_0x2cbcf8(0x17c)](_0x2cbcf8(0x1b6),_0x2cbcf8(0x1dd)),_0x2ec0ac=[];if(_0x251c6e)for(const _0x5887a4 in _0x251c6e){const _0x19cf29=_0x251c6e[_0x5887a4],_0x5b3389=(_0x19cf29[_0x2cbcf8(0x1df)]&&typeof _0x19cf29[_0x2cbcf8(0x1df)][_0x2cbcf8(0x238)]===_0x2cbcf8(0x16b)?_0x19cf29[_0x2cbcf8(0x1df)][_0x2cbcf8(0x238)]['de']:_0x19cf29[_0x2cbcf8(0x1df)][_0x2cbcf8(0x238)])||_0x19cf29[_0x2cbcf8(0x1df)][_0x2cbcf8(0x238)];_0x2ec0ac[_0x2cbcf8(0x171)]({'id':_0x5887a4,'name':_0x5b3389});}const _0xf20ee4=await this[_0x2cbcf8(0x17c)](_0x2cbcf8(0x236),_0x2cbcf8(0x1dd)),_0x4bc260=[];if(_0xf20ee4)for(const _0x84ecaa in _0xf20ee4){const _0x36a66f=_0xf20ee4[_0x84ecaa],_0x40bffe=(_0x36a66f['common']&&typeof _0x36a66f[_0x2cbcf8(0x1df)][_0x2cbcf8(0x238)]===_0x2cbcf8(0x16b)?_0x36a66f[_0x2cbcf8(0x1df)][_0x2cbcf8(0x238)]['de']:_0x36a66f[_0x2cbcf8(0x1df)][_0x2cbcf8(0x238)])||_0x84ecaa[_0x2cbcf8(0x19f)]('.')[_0x2cbcf8(0x196)]();_0x4bc260['push'](_0x40bffe);}this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':!![],'enums':_0x2ec0ac,'rooms':_0x4bc260},_0xc5b113[_0x2cbcf8(0x1b2)]);}else{if(_0xc5b113['command']===_0x2cbcf8(0x215))try{let _0x3d32d2='Kein\x20Wetter-Adapter',_0x2bfe0d='Kein\x20Kalender-Adapter';if(this['config'][_0x2cbcf8(0x192)]){const _0x198ed0=await recorder[_0x2cbcf8(0x20f)](this);_0x3d32d2=_0x198ed0!==null?_0x198ed0+'Â°C':_0x2cbcf8(0x1eb);}if(this[_0x2cbcf8(0x1a7)][_0x2cbcf8(0x1c2)]){const _0x687173=await this['getForeignObjectAsync']('system.adapter.'+this[_0x2cbcf8(0x1a7)][_0x2cbcf8(0x1c2)]);_0x2bfe0d=_0x687173?_0x2cbcf8(0x1de):_0x2cbcf8(0x173);}this['sendTo'](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113['command'],{'success':!![],'weather':_0x3d32d2,'calendar':_0x2bfe0d},_0xc5b113[_0x2cbcf8(0x1b2)]);}catch(_0x4fbb89){this[_0x2cbcf8(0x211)](_0xc5b113['from'],_0xc5b113[_0x2cbcf8(0x22d)],{'success':![],'error':_0x4fbb89['message']},_0xc5b113[_0x2cbcf8(0x1b2)]);}else{if(_0xc5b113['command']===_0x2cbcf8(0x209))try{const _0x5908e6=_0xc5b113[_0x2cbcf8(0x23b)][_0x2cbcf8(0x1ac)],_0x3d333e=await this[_0x2cbcf8(0x17e)](_0x5908e6+'.data.table');let _0x201818=[];if(_0x3d333e&&_0x3d333e[_0x2cbcf8(0x177)]){const _0x5768ad=JSON['parse'](_0x3d333e['val']),_0x109a2c=new Set();Array[_0x2cbcf8(0x16d)](_0x5768ad)&&_0x5768ad['forEach'](_0x47ddaa=>{const _0x3c8389=_0x2cbcf8;if(_0x47ddaa[_0x3c8389(0x1f4)])_0x109a2c['add'](_0x47ddaa['_calName']);else{if(_0x47ddaa['calendarName'])_0x109a2c['add'](_0x47ddaa[_0x3c8389(0x23a)]);}}),_0x201818=Array[_0x2cbcf8(0x172)](_0x109a2c)[_0x2cbcf8(0x213)]();}if(_0x201818[_0x2cbcf8(0x1ba)]===0x0)_0x201818=['Standard'];this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':!![],'names':_0x201818},_0xc5b113[_0x2cbcf8(0x1b2)]);}catch(_0x23c201){this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':![],'error':_0x23c201[_0x2cbcf8(0x23b)]},_0xc5b113[_0x2cbcf8(0x1b2)]);}else{if(_0xc5b113[_0x2cbcf8(0x22d)]==='testNotification')try{await setup[_0x2cbcf8(0x191)](this,'ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.',![],![]),this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':!![],'message':'Gesendet'},_0xc5b113[_0x2cbcf8(0x1b2)]);}catch(_0x1ccca7){this[_0x2cbcf8(0x19e)][_0x2cbcf8(0x16a)]('Notification\x20Test\x20Failed:\x20'+_0x1ccca7[_0x2cbcf8(0x23b)]),this[_0x2cbcf8(0x211)](_0xc5b113[_0x2cbcf8(0x172)],_0xc5b113[_0x2cbcf8(0x22d)],{'success':![],'message':_0x2cbcf8(0x1bd)+_0x1ccca7[_0x2cbcf8(0x23b)]},_0xc5b113[_0x2cbcf8(0x1b2)]);}}}}}}}}}}}async[a0_0xe4fe75(0x19c)](){const _0x53b26f=a0_0xe4fe75;try{const _0x2b3fd9=await this[_0x53b26f(0x20a)](setup[_0x53b26f(0x22c)]);_0x2b3fd9&&_0x2b3fd9['val']&&Object['values'](setup[_0x53b26f(0x21b)])[_0x53b26f(0x21e)](_0x2b3fd9['val'])?this['currentSystemMode']=_0x2b3fd9[_0x53b26f(0x177)]:(this[_0x53b26f(0x180)]=setup[_0x53b26f(0x21b)][_0x53b26f(0x1b1)],await this[_0x53b26f(0x1c5)](setup[_0x53b26f(0x22c)],{'val':setup[_0x53b26f(0x21b)][_0x53b26f(0x1b1)],'ack':!![]}));}catch(_0x5146be){this[_0x53b26f(0x180)]=setup['SYSTEM_MODES'][_0x53b26f(0x1b1)];}}async[a0_0xe4fe75(0x1ea)](){const _0x636ba7=a0_0xe4fe75;try{const _0x45a52e=this[_0x636ba7(0x1a7)][_0x636ba7(0x200)]||[];let _0x43ab20=![];const _0x46e346=[];for(const _0x32d60c of _0x45a52e){try{const _0x63a26f=await this[_0x636ba7(0x17e)](_0x32d60c);_0x63a26f&&(_0x63a26f['val']===!![]||_0x63a26f[_0x636ba7(0x177)]==='online'||_0x63a26f[_0x636ba7(0x177)]===0x1)&&(_0x43ab20=!![],_0x46e346[_0x636ba7(0x171)](_0x32d60c));}catch(_0x31cd3d){}}return await this[_0x636ba7(0x1c5)]('system.presenceWho',{'val':_0x46e346[_0x636ba7(0x17a)](',\x20'),'ack':!![]}),_0x43ab20&&(this[_0x636ba7(0x1d9)]&&(this[_0x636ba7(0x19e)]['info']('WiFi\x20Presence\x20detected.'),recorder[_0x636ba7(0x1ff)](this)),!this['isPresent']&&this['currentSystemMode']===setup[_0x636ba7(0x21b)]['NORMAL']&&await recorder['setPresence'](this,!![])),_0x43ab20;}catch(_0xd0d1f5){return![];}}async[a0_0xe4fe75(0x203)](){const _0x486550=a0_0xe4fe75;this['log']['debug']('ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...'),await aiAgent[_0x486550(0x1c9)](this),this[_0x486550(0x207)](),this[_0x486550(0x208)](),this[_0x486550(0x19d)]();}[a0_0xe4fe75(0x208)](){const _0x32cddd=a0_0xe4fe75;if(!this[_0x32cddd(0x1f1)])return;try{this['getState'](_0x32cddd(0x194),(_0x100631,_0x1fc30e)=>{const _0x23ec7a=_0x32cddd;_0x1fc30e&&_0x1fc30e[_0x23ec7a(0x177)]&&pythonBridge[_0x23ec7a(0x202)](this,_0x23ec7a(0x1c8),{'sequences':JSON[_0x23ec7a(0x1dc)](_0x1fc30e[_0x23ec7a(0x177)])});});}catch(_0x20a774){}}async[a0_0xe4fe75(0x19d)](){const _0x1e6fbf=a0_0xe4fe75;if(!this[_0x1e6fbf(0x1f1)])return;try{const _0x2c40e7=await recorder[_0x1e6fbf(0x20f)](this);if(_0x2c40e7===null)return;const _0x40e9f6={},_0x534991=this['config'][_0x1e6fbf(0x190)]||[];for(const _0x536f02 of _0x534991){if(_0x536f02[_0x1e6fbf(0x1c0)]===_0x1e6fbf(0x181)&&_0x536f02[_0x1e6fbf(0x1bc)]){const _0xec5a83=this[_0x1e6fbf(0x1f6)][_0x536f02['id']];if(_0xec5a83!==undefined)_0x40e9f6[_0x536f02[_0x1e6fbf(0x1bc)]]=_0xec5a83;}}Object[_0x1e6fbf(0x1e7)](_0x40e9f6)[_0x1e6fbf(0x1ba)]>0x0&&pythonBridge[_0x1e6fbf(0x202)](this,_0x1e6fbf(0x1e4),{'current_temps':_0x40e9f6,'t_out':_0x2c40e7});}catch(_0x27cf8e){}}[a0_0xe4fe75(0x207)](){const _0x3af128=a0_0xe4fe75;if(!this[_0x3af128(0x1c3)]||this[_0x3af128(0x1c3)][_0x3af128(0x1ba)]===0x0)return;const _0x1d987b=new Array(0x60)['fill'](0x0),_0x38d5c1=new Date()[_0x3af128(0x1ad)](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x3af128(0x22a)](_0x16f7e8=>{const _0x5f8e6c=_0x3af128,_0x4de8f9=new Date(_0x16f7e8[_0x5f8e6c(0x219)]);if(_0x4de8f9[_0x5f8e6c(0x1ce)]()>=_0x38d5c1){const _0x3e65df=_0x4de8f9[_0x5f8e6c(0x233)](),_0x46cf12=_0x4de8f9['getMinutes'](),_0x4b2e11=_0x3e65df*0x4+Math[_0x5f8e6c(0x1af)](_0x46cf12/0xf);if(_0x4b2e11>=0x0&&_0x4b2e11<0x60)_0x1d987b[_0x4b2e11]++;}}),this['setStateAsync'](_0x3af128(0x1ec),{'val':JSON['stringify'](_0x1d987b),'ack':!![]});}[a0_0xe4fe75(0x228)](){const _0x2ffc30=a0_0xe4fe75;if(!this[_0x2ffc30(0x18b)]||this[_0x2ffc30(0x18b)]['length']<0x2)return;const _0x6310a9=this[_0x2ffc30(0x18b)][_0x2ffc30(0x1e2)](_0x585017=>{const _0x557810=_0x2ffc30,_0x3a131d=(_0x585017[_0x557810(0x206)]||'')[_0x557810(0x188)]();return ACTIVITY_LEVEL_MAP[_0x3a131d]||0x32;});pythonBridge[_0x2ffc30(0x202)](this,_0x2ffc30(0x223),{'values':_0x6310a9,'tag':'Activity-Level'});}}if(require[a0_0xe4fe75(0x17f)]!==module)module[a0_0xe4fe75(0x18f)]=_0x2465ff=>new CogniLiving(_0x2465ff);else new CogniLiving();