const a0_0x40ebb5=a0_0xfdca;(function(_0x26e7ca,_0xb64e52){const _0x4049fc=a0_0xfdca,_0x421ac0=_0x26e7ca();while(!![]){try{const _0x381a64=-parseInt(_0x4049fc(0x241))/0x1*(-parseInt(_0x4049fc(0x1af))/0x2)+-parseInt(_0x4049fc(0x19a))/0x3+parseInt(_0x4049fc(0x227))/0x4+-parseInt(_0x4049fc(0x1b1))/0x5+-parseInt(_0x4049fc(0x21f))/0x6*(parseInt(_0x4049fc(0x114))/0x7)+parseInt(_0x4049fc(0x20b))/0x8+-parseInt(_0x4049fc(0x137))/0x9*(-parseInt(_0x4049fc(0x14b))/0xa);if(_0x381a64===_0xb64e52)break;else _0x421ac0['push'](_0x421ac0['shift']());}catch(_0x298717){_0x421ac0['push'](_0x421ac0['shift']());}}}(a0_0x4d82,0x80592));const a0_0x3a3b70=(function(){let _0x30f25b=!![];return function(_0x1c1832,_0x3a5769){const _0xd41b94=_0x30f25b?function(){const _0x1e792e=a0_0xfdca;if(_0x3a5769){const _0xe8f28b=_0x3a5769[_0x1e792e(0x27e)](_0x1c1832,arguments);return _0x3a5769=null,_0xe8f28b;}}:function(){};return _0x30f25b=![],_0xd41b94;};}()),a0_0x163dae=a0_0x3a3b70(this,function(){const _0x4feeb4=a0_0xfdca;return a0_0x163dae['toString']()['search']('(((.+)+)+)+$')['toString']()[_0x4feeb4(0x200)](a0_0x163dae)['search']('(((.+)+)+)+$');});a0_0x163dae();'use strict';const utils=require(a0_0x40ebb5(0x10f)),{GoogleGenerativeAI}=require(a0_0x40ebb5(0x17d)),schedule=require(a0_0x40ebb5(0x24f)),{spawn,exec}=require('child_process'),path=require(a0_0x40ebb5(0x13c)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x40ebb5(0x23d),LTM_SCHEDULE=a0_0x40ebb5(0x1ae),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x40ebb5(0x2e1),LTM_DP_DAILY_DIGESTS=a0_0x40ebb5(0x125),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x40ebb5(0x193),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x40ebb5(0x19b),LTM_DP_DRIFT_STATUS=a0_0x40ebb5(0x140),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x40ebb5(0x18d),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x40ebb5(0x110),a0_0x40ebb5(0x18f),a0_0x40ebb5(0x2b8),a0_0x40ebb5(0x104),'lowbat',a0_0x40ebb5(0xf7),a0_0x40ebb5(0x2d1),a0_0x40ebb5(0x1f7),a0_0x40ebb5(0x11e),a0_0x40ebb5(0x11b),a0_0x40ebb5(0x21b),a0_0x40ebb5(0x2d3),'stick_unreach','config_pending',a0_0x40ebb5(0x24b),a0_0x40ebb5(0x259),a0_0x40ebb5(0x26e),'link_quality'],BAD_NAMES=[a0_0x40ebb5(0x1d0),a0_0x40ebb5(0x208),'state',a0_0x40ebb5(0x276),a0_0x40ebb5(0x195),a0_0x40ebb5(0x22f),'on',a0_0x40ebb5(0x22e),a0_0x40ebb5(0x1d1),a0_0x40ebb5(0x27d),'shutter',a0_0x40ebb5(0x1a0),'cover',a0_0x40ebb5(0x20e),'motion',a0_0x40ebb5(0x184),'occupancy',a0_0x40ebb5(0x1c0),a0_0x40ebb5(0x25d),a0_0x40ebb5(0x142),a0_0x40ebb5(0x1ce),a0_0x40ebb5(0x285),a0_0x40ebb5(0x2b4),a0_0x40ebb5(0x108),'set_temperature'],ADAPTER_BLACKLIST=['system.','admin.',a0_0x40ebb5(0x1fa),a0_0x40ebb5(0x234),'history.',a0_0x40ebb5(0x29c),a0_0x40ebb5(0x12b),a0_0x40ebb5(0x270),a0_0x40ebb5(0x23f),a0_0x40ebb5(0x15f),a0_0x40ebb5(0x220)],SYSTEM_MODES={'NORMAL':a0_0x40ebb5(0x169),'VACATION':a0_0x40ebb5(0x222),'PARTY':a0_0x40ebb5(0x243),'GUEST':a0_0x40ebb5(0x291)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x40ebb5(0x29a)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x40ebb5(0x147),'senior_aal':a0_0x40ebb5(0x1e5),'family':a0_0x40ebb5(0x218),'single_comfort':a0_0x40ebb5(0x298),'security':a0_0x40ebb5(0x11f)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x297cc9){const _0x5a6e1c=a0_0x40ebb5;try{const _0x42047a=[_0x5a6e1c(0x279),_0x5a6e1c(0x255)];for(const _0x22f1d6 of _0x42047a){try{const _0x5dec5d=await _0x297cc9[_0x5a6e1c(0x12d)](_0x22f1d6);_0x5dec5d&&await _0x297cc9['delObjectAsync'](_0x22f1d6);}catch(_0x529c4a){}}}catch(_0x4b3267){}}async function initHistory(_0xbc3e46){const _0x40f6e0=a0_0x40ebb5;try{const _0x5241d2=await _0xbc3e46[_0x40f6e0(0x1cb)]('events.history');_0x5241d2&&_0x5241d2[_0x40f6e0(0x2e5)]&&(_0xbc3e46[_0x40f6e0(0x155)]=JSON[_0x40f6e0(0x153)](_0x5241d2['val'][_0x40f6e0(0x28e)]()));}catch(_0x17150d){_0xbc3e46[_0x40f6e0(0x155)]=[];}try{const _0x219edf=await _0xbc3e46[_0x40f6e0(0x1cb)](_0x40f6e0(0x1a8));if(_0x219edf&&_0x219edf[_0x40f6e0(0x2e5)])_0xbc3e46[_0x40f6e0(0x273)]=JSON['parse'](_0x219edf[_0x40f6e0(0x2e5)][_0x40f6e0(0x28e)]());}catch(_0x3fee07){_0xbc3e46[_0x40f6e0(0x273)]=[];}if(_0xbc3e46[_0x40f6e0(0x155)]&&_0xbc3e46[_0x40f6e0(0x155)][_0x40f6e0(0x299)]>0x0){_0xbc3e46[_0x40f6e0(0x2c9)]['info'](_0x40f6e0(0x246)+_0xbc3e46[_0x40f6e0(0x155)][_0x40f6e0(0x299)]+_0x40f6e0(0x240));for(let _0x53c9f9=_0xbc3e46['eventHistory'][_0x40f6e0(0x299)]-0x1;_0x53c9f9>=0x0;_0x53c9f9--){const _0x214413=_0xbc3e46[_0x40f6e0(0x155)][_0x53c9f9];_0x214413&&_0x214413['id']!==undefined&&_0x214413[_0x40f6e0(0x195)]!==undefined&&(_0xbc3e46['sensorLastValues'][_0x214413['id']]=_0x214413[_0x40f6e0(0x195)]);}}}async function initSystemConfig(_0x23fa54){const _0x5ef7ed=a0_0x40ebb5;try{const _0x29aaa2=await _0x23fa54['getForeignObjectAsync'](_0x5ef7ed(0x1a6));_0x29aaa2&&_0x29aaa2[_0x5ef7ed(0x24e)]&&(_0x23fa54[_0x5ef7ed(0x165)]={'latitude':_0x29aaa2[_0x5ef7ed(0x24e)]['latitude']||0x0,'longitude':_0x29aaa2['common'][_0x5ef7ed(0x1f2)]||0x0,'city':_0x29aaa2['common'][_0x5ef7ed(0x296)]||''});}catch(_0x37984c){}}async function checkLicense(_0x5c595a,_0x3a2426){const _0x2b6d92=a0_0x40ebb5;if(!_0x3a2426)return![];_0x5c595a[_0x2b6d92(0x2a5)]=await getSystemUUID(_0x5c595a);if(_0x3a2426===_0x2b6d92(0x134)||_0x3a2426[_0x2b6d92(0x1bd)](_0x2b6d92(0x161)))return!![];return![];}async function getSystemUUID(_0x171ce){const _0x2b370b=a0_0x40ebb5;try{const _0x38cc80=await _0x171ce[_0x2b370b(0x2cc)](_0x2b370b(0xf9));if(_0x38cc80&&_0x38cc80[_0x2b370b(0x1f8)]&&_0x38cc80[_0x2b370b(0x1f8)]['uuid'])return _0x38cc80['native'][_0x2b370b(0x1ab)];return _0x2b370b(0x133);}catch(_0x54ef2c){return'uuid-error';}}async function createAllObjects(_0x1b2fc0){const _0x4de9be=a0_0x40ebb5;await checkSystemObjects(_0x1b2fc0),await _0x1b2fc0['setObjectNotExistsAsync']('system.presenceWho',{'type':'state','common':{'name':_0x4de9be(0x2a9),'type':'string','role':_0x4de9be(0x2fa),'read':!![],'write':![],'def':''},'native':{}}),await _0x1b2fc0['setObjectNotExistsAsync'](_0x4de9be(0x19e),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x24c),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x141),'read':!![],'write':![]},'native':{}}),await _0x1b2fc0['setObjectNotExistsAsync']('events.history',{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x23b),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x141),'read':!![],'write':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x229),{'type':'state','common':{'name':_0x4de9be(0x1b9),'type':_0x4de9be(0x283),'role':_0x4de9be(0x138),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x2be),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0xfb),'type':_0x4de9be(0x283),'role':_0x4de9be(0x138),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x267),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x10c),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x141),'read':!![],'write':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)]('analysis.isAlert',{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x235),'type':_0x4de9be(0x283),'role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x1dd),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x103),'type':_0x4de9be(0x283),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)]('analysis.alertReason',{'type':'state','common':{'name':'Alert\x20Reason','type':'string','role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x1b2fc0['setObjectNotExistsAsync'](_0x4de9be(0x15d),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x202),'type':_0x4de9be(0x1b3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x27f),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x2b1),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x2bc),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x2e4),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x2c0),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x2fa),'read':!![],'write':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x1b5),{'type':'state','common':{'name':'Comfort\x20Suggestion','type':_0x4de9be(0x1b3),'role':_0x4de9be(0x2fa),'read':!![],'write':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x185)](_0x4de9be(0x130),{'type':_0x4de9be(0x127),'common':{'name':'Automation\x20Proposals'},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x10a),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x18e),'type':_0x4de9be(0x283),'role':_0x4de9be(0x2ba),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)]('analysis.automation.description',{'type':'state','common':{'name':_0x4de9be(0x225),'type':'string','role':_0x4de9be(0x2fa),'read':!![],'write':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x1cf),{'type':'state','common':{'name':_0x4de9be(0x1ba),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x2fa),'read':!![],'write':![]},'native':{}}),await _0x1b2fc0['setObjectNotExistsAsync'](_0x4de9be(0x21c),{'type':_0x4de9be(0x2bc),'common':{'name':'Target\x20ID','type':_0x4de9be(0x1b3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)]('analysis.automation.targetValue',{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x2f9),'type':_0x4de9be(0x1b3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1b2fc0['setObjectNotExistsAsync'](_0x4de9be(0x1aa),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x284),'type':_0x4de9be(0x283),'role':_0x4de9be(0x1d1),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x2c8),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x129),'type':'boolean','role':_0x4de9be(0x138),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x1a8),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x100),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x141),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0xfe),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x26c),'type':'string','role':_0x4de9be(0x141),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1b2fc0[_0x4de9be(0x185)](_0x4de9be(0x249),{'type':_0x4de9be(0x127),'common':{'name':_0x4de9be(0x149)},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x135),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x166),'type':_0x4de9be(0x25a),'role':_0x4de9be(0x2f8),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x158),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x17b),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x2fa),'read':!![],'write':![],'def':_0x4de9be(0x27b)},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x1c8),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x25e),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x2fa),'read':!![],'write':![],'def':''},'native':{}}),await _0x1b2fc0['setObjectNotExistsAsync']('analysis.health.trendDiagnosis',{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x1d6),'type':'string','role':_0x4de9be(0x2fa),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x1e3),{'type':_0x4de9be(0x2bc),'common':{'name':'Trend\x20Value\x20(%)','type':_0x4de9be(0x25a),'role':_0x4de9be(0x195),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x1b2fc0[_0x4de9be(0x185)](_0x4de9be(0x230),{'type':'channel','common':{'name':_0x4de9be(0x160)},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x231),{'type':'state','common':{'name':_0x4de9be(0x2cf),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x141),'read':!![],'write':![],'def':'[]','desc':_0x4de9be(0x22c)},'native':{}}),await _0x1b2fc0[_0x4de9be(0x244)](_0x4de9be(0x1f1),{'type':_0x4de9be(0x2bc),'common':{'name':_0x4de9be(0x2e9),'type':_0x4de9be(0x1b3),'role':_0x4de9be(0x141),'read':!![],'write':![],'def':'[]','desc':_0x4de9be(0x16c)},'native':{}}),await checkLtmObjects(_0x1b2fc0),await checkLtmDriftObjects(_0x1b2fc0);}async function checkSystemObjects(_0x539119){const _0x50c28e=a0_0x40ebb5;await _0x539119[_0x50c28e(0x185)](_0x50c28e(0x2d8),{'type':_0x50c28e(0x127),'common':{'name':_0x50c28e(0x266)},'native':{}}),await _0x539119[_0x50c28e(0x185)](SYSTEM_DP_MODE,{'type':_0x50c28e(0x2bc),'common':{'name':_0x50c28e(0x2a4),'type':'string','role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x50c28e(0x1e8)],'states':{[SYSTEM_MODES[_0x50c28e(0x1e8)]]:'Normal',[SYSTEM_MODES[_0x50c28e(0x20c)]]:_0x50c28e(0x17c),[SYSTEM_MODES[_0x50c28e(0x29a)]]:_0x50c28e(0x1b7),[SYSTEM_MODES['GUEST']]:_0x50c28e(0x1e6)}},'native':{}});}async function checkLtmObjects(_0x586ab1){const _0x5b801f=a0_0x40ebb5;await _0x586ab1[_0x5b801f(0x185)](_0x5b801f(0x10e),{'type':'channel','common':{'name':_0x5b801f(0x10e)},'native':{}}),await _0x586ab1[_0x5b801f(0x185)](LTM_DP_RAW_LOG,{'type':_0x5b801f(0x2bc),'common':{'name':_0x5b801f(0x2dc),'type':_0x5b801f(0x1b3),'role':_0x5b801f(0x141),'read':!![],'write':![]},'native':{}}),await _0x586ab1[_0x5b801f(0x185)](LTM_DP_DAILY_DIGESTS,{'type':_0x5b801f(0x2bc),'common':{'name':_0x5b801f(0x2e7),'type':_0x5b801f(0x1b3),'role':_0x5b801f(0x141),'read':!![],'write':![]},'native':{}}),await _0x586ab1['extendObjectAsync'](LTM_DP_STATUS,{'type':_0x5b801f(0x2bc),'common':{'name':_0x5b801f(0x2d0),'type':_0x5b801f(0x1b3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x586ab1[_0x5b801f(0x185)](LTM_DP_TRIGGER_DIGEST,{'type':_0x5b801f(0x2bc),'common':{'name':'Trigger\x20Digest','type':'boolean','role':_0x5b801f(0x138),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x586ab1[_0x5b801f(0x185)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':_0x5b801f(0x2d9),'type':'string','role':_0x5b801f(0x2fa),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x1dcabc){const _0x29e93e=a0_0x40ebb5;await _0x1dcabc[_0x29e93e(0x185)](LTM_DP_DRIFT_CHANNEL,{'type':_0x29e93e(0x127),'common':{'name':_0x29e93e(0x263)},'native':{}}),await _0x1dcabc['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x29e93e(0x2bc),'common':{'name':_0x29e93e(0x183),'type':_0x29e93e(0x1b3),'role':_0x29e93e(0x2bc),'read':!![],'write':![],'def':_0x29e93e(0x131)},'native':{}}),await _0x1dcabc[_0x29e93e(0x185)](LTM_DP_DRIFT_DETAILS,{'type':_0x29e93e(0x2bc),'common':{'name':'Drift\x20Details','type':_0x29e93e(0x1b3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1dcabc['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x29e93e(0x2bc),'common':{'name':_0x29e93e(0x27c),'type':_0x29e93e(0x25a),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x241315){const _0x24cefd=a0_0x40ebb5;try{const _0x507e08=await _0x241315[_0x24cefd(0x1cb)](SYSTEM_DP_MODE);_0x507e08&&_0x507e08['val']&&Object[_0x24cefd(0x28a)](SYSTEM_MODES)[_0x24cefd(0x182)](_0x507e08[_0x24cefd(0x2e5)])?_0x241315[_0x24cefd(0x2b7)]=_0x507e08[_0x24cefd(0x2e5)]:(_0x241315[_0x24cefd(0x2b7)]=SYSTEM_MODES['NORMAL'],await _0x241315[_0x24cefd(0x2b0)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x24cefd(0x1e8)],'ack':!![]}));}catch(_0x11d328){_0x241315[_0x24cefd(0x2b7)]=SYSTEM_MODES[_0x24cefd(0x1e8)];}}async function loadRawEventLog(_0x2e12c9){const _0x264ac8=a0_0x40ebb5;try{const _0x485111=await _0x2e12c9[_0x264ac8(0x1cb)](LTM_DP_RAW_LOG);if(_0x485111&&_0x485111['val'])_0x2e12c9[_0x264ac8(0x12c)]=JSON['parse'](_0x485111[_0x264ac8(0x2e5)]);}catch(_0x38725b){_0x2e12c9[_0x264ac8(0x12c)]=[];}}async function saveRawEventLog(_0x5aba68){const _0x176129=a0_0x40ebb5;_0x5aba68[_0x176129(0x12c)][_0x176129(0x299)]>RAW_LOG_MAX_SIZE&&_0x5aba68[_0x176129(0x12c)]['splice'](0x0,_0x5aba68['rawEventLog'][_0x176129(0x299)]-RAW_LOG_MAX_SIZE),await _0x5aba68[_0x176129(0x2b0)](LTM_DP_RAW_LOG,{'val':JSON[_0x176129(0x286)](_0x5aba68[_0x176129(0x12c)]),'ack':!![]});}function a0_0xfdca(_0x407353,_0x569a0f){const _0x10822e=a0_0x4d82();return a0_0xfdca=function(_0x163dae,_0x3a3b70){_0x163dae=_0x163dae-0xf6;let _0x4d827c=_0x10822e[_0x163dae];return _0x4d827c;},a0_0xfdca(_0x407353,_0x569a0f);}async function loadDailyDigests(_0x42d50f){const _0x4aca30=a0_0x40ebb5;try{const _0x40516c=await _0x42d50f[_0x4aca30(0x1cb)](LTM_DP_DAILY_DIGESTS);if(_0x40516c&&_0x40516c[_0x4aca30(0x2e5)])_0x42d50f['dailyDigests']=JSON['parse'](_0x40516c[_0x4aca30(0x2e5)]);}catch(_0x49e7e7){_0x42d50f['dailyDigests']=[];}await updateBaselineStatus(_0x42d50f);}async function saveDailyDigests(_0x41f8cd,_0x2bb851=!![]){const _0x1750e1=a0_0x40ebb5,_0x2ec5dc=_0x41f8cd[_0x1750e1(0x1cd)]['ltmLtbWindowDays']||0x3c;_0x41f8cd[_0x1750e1(0x1db)][_0x1750e1(0x299)]>_0x2ec5dc&&_0x41f8cd[_0x1750e1(0x1db)][_0x1750e1(0x194)](0x0,_0x41f8cd[_0x1750e1(0x1db)][_0x1750e1(0x299)]-_0x2ec5dc);await _0x41f8cd[_0x1750e1(0x2b0)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1750e1(0x286)](_0x41f8cd[_0x1750e1(0x1db)]),'ack':!![]});if(_0x2bb851)await updateBaselineStatus(_0x41f8cd);}function a0_0x4d82(){const _0xb2ec5a=['analysis.automation.description','javascript.','Training\x20Data\x20Sets','PRO-','map','.\x20KONTEXT:\x20','sleepScore','systemConfig','Sleep\x20Score\x20(0-100)','trim','light','normal','KALENDER\x20ERROR:\x20','Missing\x20data','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','calendarSelection','subscribeForeignStatesAsync',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','âœ…\x20Alles\x20OK\x20(Reset)','unshift','KALENDER:\x20Keine\x20Daten','isArray','unload','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','daswetter.0','Error\x20in\x20onMessage\x20command\x20','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','Wetter:\x20Deaktiviert','devices','Restlessness\x20Level','Urlaub','@google/generative-ai','payload','ical.0','python3','briefingEnabled','includes','Drift\x20Status','presence','extendObjectAsync','stdout','find','driftDetails','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','âŒ\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.','submitFeedback','onReady','LTM.driftAnalysis.lastCheck','Pattern\x20Detected','scriptEnabled','dismissAutomation','...','lights','LTM.triggerDailyDigest','splice','value','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','getForeignStateAsync','genAI','sensorLastValues','2432118RHZYfB','LTM.driftAnalysis','Gemini\x20Init\x20Error:\x20','Kalender:\x20Deaktiviert','events.lastEvent','telegram','blind','push','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','analysis.alertReason','[RECORDER]\x20Error\x20saving\x20sequence:\x20','generic','system.config','retry','analysis.analysisHistory','window','analysis.automation.autoApply','uuid','getGenerativeModel','_calName','0\x203\x20*\x20*\x20*','10zYeikB','âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.','4013715EFYyUa','inactivityThresholdHours','string','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','analysis.comfortSuggestion','exports','Party','enum.functions.*','Trigger\x20Analysis','Action','Morning\x20Briefing\x20sent.','substring','startsWith','siren','python3\x20-m\x20pip\x20install\x20-r\x20\x22','temperature','feedbackHistory','ðŸ\x20Stopping\x20Python\x20Sidecar...','shift','namespace','event','dependencyInstallInProgress','Guardian:\x20Sending\x20','analysis.health.notes','\x20presence\x20devices...','driftAnalysisTimer','getStateAsync','lastIndexOf','config','energy','analysis.automation.suggestedAction','targetposition','switch','WETTER\x20ERROR:\x20','briefingTime','notifyTelegramEnabled','âœ…\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','Trend\x20Diagnosis\x20(Python)','scheduleJob','\x22\x20--break-system-packages','message','unknown','dailyDigests','Error\x20reading\x20calendar\x20table:\x20','analysis.isEmergency','toLowerCase','subscribeStates','fill','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','\x20(Value\x20is\x20falsy:\x20','analysis.health.trendValue','KI-Modell\x20nicht\x20initialisiert','PRIORITÃ„T:\x20Gesundheit/AAL.','Gast','ANALYZE_TREND','NORMAL','baselineDrift','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','Kein\x20API\x20Key!','geminiModel','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','setForeignStateAsync','fenster','setHours','LTM.trainingData.thermodynamics','longitude','\x20*\x20*\x20*','shutter','getCalendarNames\x20Error:\x20','Sending\x20notification:\x20\x22','maintenance','native','tÃ¼r','info.','toLocaleString','generateContent','useWeather','stderr','communicate.request','constructor','geminiApiKey','Activity\x20Summary','getFullYear','Generating\x20Morning\x20Briefing...','accuweather','version','heizung','currentposition','.Summary.Current','requirements.txt','4045888WqgENS','VACATION','kontakt','status','weatherInstance','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','[LOG]','system.presenceWho','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','Lernphase\x20(','[TEST]\x20','setState','\x20days\x20of\x20activity\x20data\x20to\x20Python...','Fokus\x20auf\x20Familienroutinen.','response','Gemini\x20AI\x20initialized.','working','analysis.automation.targetId','selectedFunctionIds','\x20|\x20','318XxQowd','simple-api.','notifyPushoverInstance','vacation','members','from','Description','COGNI_CONFIRM_OK','2758296IuXFNb','Error\x20reading\x20outdoor\x20sensor\x20','analysis.trigger','bewegung','weather','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','role','off','brightness','LTM.trainingData','LTM.trainingData.sequences','thermostat','No\x20instance','vis.','AI\x20Alert\x20Status','ready','isPresent','Error\x20checking\x20WiFi:\x20','dimmer','catch','Event\x20History','online','models/gemini-flash-latest','.communicate.request','echarts.','\x20events)...','49223kOjTyP','notifyPushoverEnabled','party','setObjectNotExistsAsync','temp','Restoring\x20sensor\x20cache\x20from\x20history\x20(','Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip','door','analysis.health','.NextHours.Location_1.Day_1.current.temp_value','dutycycle','Last\x20raw\x20event','split','common','node-schedule','isGracePeriodActive','summary','.forecast.current.temp','COGNI_REQUEST_CALL','forEach','events.history_debug_00','\x27\x20not\x20in\x20allowed\x20list)','\x20=\x20','LTM\x20Sched\x20Error:\x20','firmware','number','\x20hours.\x20Potential\x20incapacitation.','custom','humidity','Health\x20Notes','apiKey','debug','TREND_RESULT','onUnload','Drift\x20Analysis','health','analysis.health.trendDiagnosis','System\x20Status\x20&\x20Control','analysis.lastResult','enum','warn','ack','motion','Feedback\x20Log','\x20for\x20interactive\x20buttons...','reachable','write','flot.','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','stdin','analysisHistory','pop','.data.table','level','Subscribing\x20to\x20','briefingJob','analysis.history_debug_00','livingContext','none','Last\x20Check','position','apply','analysis.deviationFromBaseline','08:00','type','ltmStbWindowDays','boolean','Auto\x20Apply\x20Rule','setpoint','stringify','Success:\x20Compressed\x20','round','Reset\x20Sched\x20Error:\x20','values','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','Failed\x20to\x20send\x20to\x20Python:\x20','getLtmData','toString','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','getEnums','guest','autoApply','Bibliotheken\x20nicht\x20gefunden','info','join','city','Unknown','Fokus\x20auf\x20Komfort.','length','PARTY','getTime','material.','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','ML-Libs\x20fehlen','.\x20ZUSATZ:\x20','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','doors','useCalendar','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','System\x20Mode','systemUUID','timestamp','ltmLtbWindowDays','indexOf','Who\x20is\x20present?','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','notifyPushoverRecipient','sort','weatherunderground','location','Briefing\x20Error:\x20','setStateAsync','Deviation','ðŸ“¡\x20Hooking\x20into\x20','lastCheck','valve','\x20min).','service.py','currentSystemMode','update','Activity-Level','indicator','command','state','analysis.isAlert','analysis.triggerBriefing','daswetter','Comfort\x20Summary','modeResetJob','details','sendToAsync','stateChange','licenseKey','object','.\x20OUTPUT:\x20Nur\x20Text.','analysis.automation.triggerAction','log','_score','outdoorSensorId','getForeignObjectAsync','Alarm','testNotification','Recorded\x20Motion\x20Sequences','Processing\x20Status','connection','some','direction','python_service','âœ…\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','prÃ¤senz','loc','system','Baseline\x20Status','[PYTHON]\x20','replace','Raw\x20Log','automation.triggerAction','triggerBriefing','inactivityMonitoringEnabled','Scheduling\x20Morning\x20Briefing\x20for\x20','LTM.rawEventLog','presenceDevices','exitGraceTimer','analysis.comfortSummary','val','ltmJob','Daily\x20Digests','onMessage','Thermodynamic\x20Data\x20Points','targetValue','lampe','No\x20module\x20named\x20pip','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','slice','analysis.automation.targetValue','minDaysForBaseline','activityLevel','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','data','ðŸŒ…\x20Daily\x20Briefing:\x0a','main','âš ï¸\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...','\x20(Type\x20\x27','value.health','Target\x20Value','text','getMonth','rssi','analysisInterval','system.meta.uuid','isProVersion','Trigger\x20Briefing\x20(Test)','toFixed','N/A\x20(Learning)','analysis.feedbackHistory','Adapter','Logbook','Details:\x20','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','AI\x20Emergency\x20Status','unreach','cancel','calendarInstance','accuweather.0','actual_temperature','User\x20dismissed\x20automation\x20proposal.','analysis.automation.patternDetected','KALENDER:\x20Keine\x20relevanten\x20Termine','Last\x20Result','notifyEmailEnabled','LTM','@iobroker/adapter-core','scriptProblem','analysisTimer','contact','instance','12964Kpqhjj','send','getCalendarNames','Feedback\x20saved:\x20','kill','notifyEmailRecipient','sendTo','fault','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','callback','error','PRIORITÃ„T:\x20Sicherheit.','rollladen','now','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','openweathermap','sensor','LTM.dailyDigests','Started\x20at\x20','channel','cogni-living\x20adapter\x20starting\x20(v','Trigger\x20Action\x20Now','onStateChange','icons-mfd.','rawEventLog','getObjectAsync','writable','lastAlertState','analysis.automation','N/A','openweathermap.0','uuid-not-found','TEST-PRO-KEY','analysis.health.sleepScore','name','1193841CKSkhj','button','simulateButler','ðŸš¨\x20EMERGENCY','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','path','toISOString','.forecast.current.state','bind','LTM.driftAnalysis.baselineDrift','json','power','pythonProcess','schalter','getDate','Cogni-Living','Analysiere\x20ausgewogen.','time','Health\x20&\x20Sleep\x20Analysis','Drift\x20Sched\x20Error:\x20','60BFHzXi','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','filter','Aktiv\x20(','exitTimer','getForeignObjectsAsync','notifyTelegramInstance','occupancy','parse','system.isPresent','eventHistory','.\x20DATEN:\x20Schlaf\x20','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','analysis.health.restlessness','endsWith','notifyTelegramRecipient','.forecast.current.temperature','lock','analysis.activitySummary'];a0_0x4d82=function(){return _0xb2ec5a;};return a0_0x4d82();}async function updateAnalysisHistory(_0x480a6f,_0x1f19ec){const _0xe9eb0=a0_0x40ebb5;_0x480a6f[_0xe9eb0(0x273)][_0xe9eb0(0x171)](_0x1f19ec);if(_0x480a6f['analysisHistory'][_0xe9eb0(0x299)]>ANALYSIS_HISTORY_MAX_SIZE)_0x480a6f[_0xe9eb0(0x273)][_0xe9eb0(0x274)]();await _0x480a6f[_0xe9eb0(0x2b0)](_0xe9eb0(0x1a8),{'val':JSON[_0xe9eb0(0x286)](_0x480a6f[_0xe9eb0(0x273)]),'ack':!![]});}async function updateBaselineStatus(_0x3866d0){const _0x4c611e=a0_0x40ebb5;if(!_0x3866d0['isProVersion']){await _0x3866d0[_0x4c611e(0x2b0)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x4811e7=_0x3866d0[_0x4c611e(0x1db)][_0x4c611e(0x299)]>=(_0x3866d0[_0x4c611e(0x1cd)]['minDaysForBaseline']||0x7)?_0x4c611e(0x14e)+_0x3866d0[_0x4c611e(0x1db)][_0x4c611e(0x299)]+'\x20Tage)':_0x4c611e(0x214)+_0x3866d0[_0x4c611e(0x1db)]['length']+'/'+(_0x3866d0[_0x4c611e(0x1cd)][_0x4c611e(0x2f0)]||0x7)+')';await _0x3866d0[_0x4c611e(0x2b0)](LTM_DP_BASELINE_STATUS,{'val':_0x4811e7,'ack':!![]});}async function initSensorSubscriptions(_0x47cdf3){const _0x54027f=a0_0x40ebb5,_0x4a1255=_0x47cdf3['config'][_0x54027f(0x17a)];if(_0x4a1255&&_0x4a1255[_0x54027f(0x299)]>0x0){_0x47cdf3[_0x54027f(0x2c9)]['info'](_0x54027f(0x277)+_0x4a1255[_0x54027f(0x299)]+'\x20sensors...');for(const _0x3375c4 of _0x4a1255){if(_0x3375c4['id']){await _0x47cdf3[_0x54027f(0x16e)](_0x3375c4['id']);try{const _0x494416=await _0x47cdf3[_0x54027f(0x197)](_0x3375c4['id']);if(_0x494416)_0x47cdf3[_0x54027f(0x199)][_0x3375c4['id']]=_0x494416[_0x54027f(0x2e5)];}catch(_0x38ff72){}}}}}async function initPresenceSubscriptions(_0x542352){const _0x21c13e=a0_0x40ebb5,_0x4541f5=_0x542352[_0x21c13e(0x1cd)][_0x21c13e(0x2e2)]||[];if(_0x4541f5['length']>0x0){_0x542352[_0x21c13e(0x2c9)][_0x21c13e(0x294)](_0x21c13e(0x277)+_0x4541f5[_0x21c13e(0x299)]+_0x21c13e(0x1c9));for(const _0x587b9e of _0x4541f5){await _0x542352[_0x21c13e(0x16e)](_0x587b9e);}try{await checkWifiPresence(_0x542352);}catch(_0x136699){}}}async function getWeatherContext(_0x136750){const _0x42582e=a0_0x40ebb5;try{if(!_0x136750['config'][_0x42582e(0x1fd)])return _0x42582e(0x179);let _0x4b5671='';const _0x1d4849=_0x136750[_0x42582e(0x1cd)][_0x42582e(0x20f)];if(_0x1d4849)try{if(_0x1d4849[_0x42582e(0x182)](_0x42582e(0x205))){const _0x29da02=await _0x136750[_0x42582e(0x197)](_0x1d4849+_0x42582e(0x209));if(_0x29da02&&_0x29da02[_0x42582e(0x2e5)])_0x4b5671=_0x29da02[_0x42582e(0x2e5)];}else{if(_0x1d4849['includes'](_0x42582e(0x2bf))){const _0x4e6659=await _0x136750[_0x42582e(0x197)](_0x1d4849+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0x4e6659&&_0x4e6659[_0x42582e(0x2e5)])_0x4b5671=_0x4e6659[_0x42582e(0x2e5)];}else{if(_0x1d4849['includes']('openweathermap')){const _0x2c532b=await _0x136750[_0x42582e(0x197)](_0x1d4849+_0x42582e(0x13e));if(_0x2c532b&&_0x2c532b[_0x42582e(0x2e5)])_0x4b5671=_0x2c532b[_0x42582e(0x2e5)];}}}}catch(_0x109a26){}if(!_0x4b5671){const _0x13efdf=[_0x42582e(0x107),_0x42582e(0x176),'weatherunderground.0',_0x42582e(0x132)];for(const _0x4ef5ad of _0x13efdf){try{const _0x1cfb58=await _0x136750[_0x42582e(0x2cc)](_0x4ef5ad);if(_0x1cfb58){if(_0x4ef5ad[_0x42582e(0x182)]('accuweather')){const _0x6a252e=await _0x136750[_0x42582e(0x197)](_0x4ef5ad+_0x42582e(0x209));if(_0x6a252e&&_0x6a252e[_0x42582e(0x2e5)]){_0x4b5671=_0x6a252e[_0x42582e(0x2e5)];break;}}}}catch(_0x5a8855){}}}return _0x4b5671?'WETTER:\x20'+_0x4b5671:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x206c16){return _0x42582e(0x1d2)+_0x206c16[_0x42582e(0x1d9)];}}async function getCalendarContext(_0x4d3de6){const _0x539c89=a0_0x40ebb5;try{if(!_0x4d3de6['config'][_0x539c89(0x2a2)])return _0x539c89(0x19d);let _0x53c89c=_0x4d3de6[_0x539c89(0x1cd)][_0x539c89(0x106)]||_0x539c89(0x17f),_0x54e89d=_0x4d3de6['config'][_0x539c89(0x16d)]||[];if(typeof _0x54e89d==='string')_0x54e89d=_0x54e89d[_0x539c89(0x24d)](',');try{const _0x12b4dc=await _0x4d3de6[_0x539c89(0x197)](_0x53c89c+'.data.table');if(_0x12b4dc&&_0x12b4dc['val']){let _0x55ef23=tryParse(_0x12b4dc[_0x539c89(0x2e5)]);if(_0x55ef23&&Array[_0x539c89(0x173)](_0x55ef23)){if(_0x54e89d[_0x539c89(0x299)]>0x0)_0x55ef23=_0x55ef23[_0x539c89(0x14d)](_0x563f03=>_0x54e89d['includes'](_0x563f03['_calName']||''));else return _0x539c89(0x29d);if(_0x55ef23[_0x539c89(0x299)]>0x0){const _0x3cf8dc=_0x55ef23[_0x539c89(0x2ee)](0x0,0x3)[_0x539c89(0x162)](_0x47ca5e=>{const _0x2fd3f4=_0x539c89;let _0x563020=_0x47ca5e['date'];if(_0x47ca5e['time'])_0x563020+='\x20'+_0x47ca5e[_0x2fd3f4(0x148)];return _0x563020+':\x20'+_0x47ca5e[_0x2fd3f4(0x1c5)]+'\x20('+_0x47ca5e[_0x2fd3f4(0x1ad)]+')';});return'KALENDER:\x20'+_0x3cf8dc[_0x539c89(0x295)](_0x539c89(0x21e));}else return _0x539c89(0x10b);}}}catch(_0x365db4){_0x4d3de6[_0x539c89(0x2c9)][_0x539c89(0x269)](_0x539c89(0x1dc)+_0x365db4[_0x539c89(0x1d9)]);}return _0x539c89(0x172);}catch(_0x282f31){return _0x539c89(0x16a)+_0x282f31['message'];}}async function getCalendarNames(_0x453a4b,_0x54e172){const _0x20285b=a0_0x40ebb5;try{const _0x1eac60=await _0x453a4b['getForeignStateAsync'](_0x54e172+_0x20285b(0x275));if(_0x1eac60&&_0x1eac60['val']){const _0x32af0a=tryParse(_0x1eac60[_0x20285b(0x2e5)]);if(_0x32af0a&&Array['isArray'](_0x32af0a)){const _0x52869b=[...new Set(_0x32af0a[_0x20285b(0x162)](_0x53739a=>_0x53739a['_calName'])[_0x20285b(0x14d)](Boolean))];return _0x52869b[_0x20285b(0x2ac)]();}}return[];}catch(_0x41f514){return _0x453a4b[_0x20285b(0x2c9)][_0x20285b(0x11e)](_0x20285b(0x1f5)+_0x41f514[_0x20285b(0x1d9)]),[];}}async function checkWifiPresence(_0x19b4cd){const _0x32b277=a0_0x40ebb5;try{const _0x590127=_0x19b4cd[_0x32b277(0x1cd)][_0x32b277(0x2e2)]||[];let _0x1a8559=![];const _0x599aa9=[];for(const _0x51d141 of _0x590127){try{const _0x18afe5=await _0x19b4cd[_0x32b277(0x197)](_0x51d141);if(_0x18afe5&&(_0x18afe5[_0x32b277(0x2e5)]===!![]||_0x18afe5['val']===_0x32b277(0x23c)||_0x18afe5[_0x32b277(0x2e5)]===0x1)){_0x1a8559=!![];const _0x2ad17d=await _0x19b4cd[_0x32b277(0x2cc)](_0x51d141);let _0x3573e1=_0x51d141;_0x2ad17d&&_0x2ad17d[_0x32b277(0x24e)]&&_0x2ad17d[_0x32b277(0x24e)][_0x32b277(0x136)]&&(_0x3573e1=typeof _0x2ad17d[_0x32b277(0x24e)][_0x32b277(0x136)]===_0x32b277(0x2c6)?_0x2ad17d['common'][_0x32b277(0x136)]['de']||_0x2ad17d[_0x32b277(0x24e)][_0x32b277(0x136)]['en']:_0x2ad17d[_0x32b277(0x24e)][_0x32b277(0x136)]),_0x599aa9[_0x32b277(0x1a1)](_0x3573e1);}}catch(_0x55a43d){}}return await _0x19b4cd[_0x32b277(0x2b0)](_0x32b277(0x212),{'val':_0x599aa9['join'](',\x20'),'ack':!![]}),_0x1a8559&&(_0x19b4cd['exitTimer']&&(_0x19b4cd[_0x32b277(0x2c9)][_0x32b277(0x294)](_0x32b277(0x196)),abortExitTimer(_0x19b4cd)),!_0x19b4cd[_0x32b277(0x237)]&&_0x19b4cd[_0x32b277(0x2b7)]===SYSTEM_MODES[_0x32b277(0x1e8)]&&await setPresence(_0x19b4cd,!![])),_0x1a8559;}catch(_0x58f602){return _0x19b4cd[_0x32b277(0x2c9)][_0x32b277(0x11e)](_0x32b277(0x238)+_0x58f602['message']),![];}}function startExitTimer(_0x2e2728){const _0xccd1e1=a0_0x40ebb5;abortExitTimer(_0x2e2728),_0x2e2728['isGracePeriodActive']=!![],_0x2e2728['exitGraceTimer']=setTimeout(()=>{const _0x39613b=a0_0xfdca;_0x2e2728[_0x39613b(0x250)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x2e2728[_0xccd1e1(0x14f)]=setTimeout(()=>{setPresence(_0x2e2728,![]),_0x2e2728['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x5aeff3){const _0xb7e2e9=a0_0x40ebb5;if(_0x5aeff3[_0xb7e2e9(0x14f)])clearTimeout(_0x5aeff3[_0xb7e2e9(0x14f)]);if(_0x5aeff3[_0xb7e2e9(0x2e3)])clearTimeout(_0x5aeff3['exitGraceTimer']);_0x5aeff3[_0xb7e2e9(0x14f)]=null,_0x5aeff3['exitGraceTimer']=null,_0x5aeff3[_0xb7e2e9(0x250)]=![];}async function setPresence(_0x11ae2c,_0x3b8a3d){const _0x4c7257=a0_0x40ebb5;if(_0x11ae2c[_0x4c7257(0x237)]===_0x3b8a3d)return;_0x11ae2c[_0x4c7257(0x237)]=_0x3b8a3d,await _0x11ae2c[_0x4c7257(0x2b0)](_0x4c7257(0x154),{'val':_0x3b8a3d,'ack':!![]});}async function saveFeedback(_0x47eea6,_0x38931c){const _0x19458c=a0_0x40ebb5;_0x47eea6['log']['info'](_0x19458c(0x117)+JSON[_0x19458c(0x286)](_0x38931c));}async function runBaselineDriftAnalysis(_0x33487e){const _0x3cfb33=a0_0x40ebb5;if(!_0x33487e[_0x3cfb33(0xfa)]||!_0x33487e[_0x3cfb33(0x1ec)])return;const _0x48e8a0=_0x33487e['config'][_0x3cfb33(0x282)]||0xe;if(_0x33487e[_0x3cfb33(0x1db)][_0x3cfb33(0x299)]<_0x48e8a0+(_0x33487e['config'][_0x3cfb33(0x2f0)]||0x7)){await _0x33487e['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x3cfb33(0xfd),'ack':!![]});return;}const _0x4195b7=_0x33487e[_0x3cfb33(0x1db)][_0x3cfb33(0x2ee)](-_0x48e8a0),_0x41b137=_0x33487e[_0x3cfb33(0x1db)][_0x3cfb33(0x2ee)](0x0,_0x33487e[_0x3cfb33(0x1db)]['length']-_0x48e8a0),_0x45daca=_0x3cfb33(0x2a0)+JSON['stringify'](_0x41b137)+'\x0aSTB:\x20'+JSON[_0x3cfb33(0x286)](_0x4195b7);try{const _0x4130d2=await _0x33487e[_0x3cfb33(0x1ec)]['generateContent'](_0x45daca),_0x34fcfb=JSON['parse'](_0x4130d2['response'][_0x3cfb33(0x2fa)]()['replace'](/```json|```/g,'')[_0x3cfb33(0x167)]());_0x34fcfb[_0x3cfb33(0x1e9)]&&(await _0x33487e['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x34fcfb[_0x3cfb33(0x1e9)],'ack':!![]}),await _0x33487e[_0x3cfb33(0x2b0)](LTM_DP_DRIFT_DETAILS,{'val':_0x34fcfb[_0x3cfb33(0x188)],'ack':!![]}),await _0x33487e[_0x3cfb33(0x2b0)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x1688c8){}}function setupLtmScheduler(_0x33768f){const _0x2cd60b=a0_0x40ebb5;try{if(_0x33768f[_0x2cd60b(0x2e6)])_0x33768f[_0x2cd60b(0x2e6)]['cancel']();if(!_0x33768f[_0x2cd60b(0xfa)]){_0x33768f[_0x2cd60b(0x2b0)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x33768f[_0x2cd60b(0x2e6)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x33768f));}catch(_0x400b81){_0x33768f[_0x2cd60b(0x2c9)]['error'](_0x2cd60b(0x258)+_0x400b81['message']);}}function setupModeResetScheduler(_0xe65056){const _0x496880=a0_0x40ebb5;try{if(_0xe65056[_0x496880(0x2c1)])_0xe65056[_0x496880(0x2c1)][_0x496880(0x105)]();_0xe65056[_0x496880(0x2c1)]=schedule[_0x496880(0x1d7)](MODE_RESET_SCHEDULE,async()=>{const _0x35ca90=_0x496880;await loadSystemMode(_0xe65056),AUTO_RESET_MODES['includes'](_0xe65056[_0x35ca90(0x2b7)])&&await _0xe65056[_0x35ca90(0x2b0)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x35ca90(0x1e8)],'ack':![]});});}catch(_0x87d1a4){_0xe65056[_0x496880(0x2c9)][_0x496880(0x11e)](_0x496880(0x289)+_0x87d1a4[_0x496880(0x1d9)]);}}function setupDriftAnalysisScheduler(_0x3409ee){const _0x1049e0=a0_0x40ebb5;try{if(_0x3409ee[_0x1049e0(0x1ca)])clearInterval(_0x3409ee[_0x1049e0(0x1ca)]);if(!_0x3409ee[_0x1049e0(0xfa)])return;_0x3409ee[_0x1049e0(0x1ca)]=setInterval(()=>runBaselineDriftAnalysis(_0x3409ee),(_0x3409ee['config']['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3409ee),0x1388);}catch(_0x55b847){_0x3409ee[_0x1049e0(0x2c9)]['error'](_0x1049e0(0x14a)+_0x55b847['message']);}}function setupBriefingScheduler(_0x24c38e){const _0x26f0c0=a0_0x40ebb5;try{if(_0x24c38e[_0x26f0c0(0x278)])_0x24c38e[_0x26f0c0(0x278)][_0x26f0c0(0x105)]();if(!_0x24c38e['config'][_0x26f0c0(0x181)])return;const _0x327779=(_0x24c38e[_0x26f0c0(0x1cd)][_0x26f0c0(0x1d3)]||_0x26f0c0(0x280))[_0x26f0c0(0x24d)](':'),_0x27a535=parseInt(_0x327779[0x0])||0x8,_0x35aef8=parseInt(_0x327779[0x1])||0x0,_0x18ae49=_0x35aef8+'\x20'+_0x27a535+_0x26f0c0(0x1f3);_0x24c38e['log']['info'](_0x26f0c0(0x2e0)+_0x27a535+':'+(_0x35aef8<0xa?'0'+_0x35aef8:_0x35aef8)),_0x24c38e[_0x26f0c0(0x278)]=schedule['scheduleJob'](_0x18ae49,()=>{sendMorningBriefing(_0x24c38e);});}catch(_0x1a2627){_0x24c38e['log'][_0x26f0c0(0x11e)]('Briefing\x20Sched\x20Error:\x20'+_0x1a2627[_0x26f0c0(0x1d9)]);}}async function sendNotification(_0x2d6323,_0x1ed4ba,_0x500956=![],_0x2acdfb=![]){const _0x301292=a0_0x40ebb5;_0x2d6323[_0x301292(0x2c9)][_0x301292(0x294)]((_0x500956?_0x301292(0x215):'')+_0x301292(0x1f6)+_0x1ed4ba+'\x22');const _0x468d9d=_0x2d6323[_0x301292(0x1cd)];let _0x956e63=0x0;if(_0x468d9d[_0x301292(0x1d4)]){let _0x4b7cf5={};(_0x1ed4ba['includes'](_0x301292(0x2cd))||_0x2acdfb)&&(_0x4b7cf5={'reply_markup':{'inline_keyboard':[[{'text':_0x301292(0x170),'callback_data':_0x301292(0x226)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x301292(0x253)}]]}}),await _0x2d6323[_0x301292(0x2c3)](_0x468d9d[_0x301292(0x151)],_0x301292(0x115),{'text':_0x1ed4ba,'user':_0x468d9d[_0x301292(0x15a)],..._0x4b7cf5}),_0x956e63++;}if(_0x468d9d[_0x301292(0x242)]){let _0x3195f9={'message':_0x1ed4ba,'title':_0x2acdfb?_0x301292(0x13a):_0x301292(0x146),'priority':_0x2acdfb?0x2:0x1,'device':_0x468d9d[_0x301292(0x2ab)]};_0x2acdfb&&(_0x3195f9[_0x301292(0x1a7)]=0x1e,_0x3195f9['expire']=0xe10,_0x3195f9['sound']=_0x301292(0x1be)),await _0x2d6323[_0x301292(0x2c3)](_0x468d9d[_0x301292(0x221)],_0x301292(0x115),_0x3195f9),_0x956e63++;}return _0x468d9d[_0x301292(0x10d)]&&(await _0x2d6323[_0x301292(0x2c3)](_0x468d9d['notifyEmailInstance'],'send',{'text':_0x1ed4ba,'to':_0x468d9d[_0x301292(0x119)]}),_0x956e63++),_0x956e63;}async function setupTelegramListener(_0x204315){const _0x554019=a0_0x40ebb5,_0x14f6d7=_0x204315[_0x554019(0x1cd)][_0x554019(0x151)];_0x204315['config'][_0x554019(0x1d4)]&&_0x14f6d7&&(_0x204315[_0x554019(0x2c9)][_0x554019(0x294)](_0x554019(0x2b2)+_0x14f6d7+_0x554019(0x26d)),await _0x204315['subscribeForeignStatesAsync'](_0x14f6d7+_0x554019(0x23e)));}async function handleTelegramResponse(_0x2b9e05,_0x25c1e6){const _0x3525b5=a0_0x40ebb5;let _0x3c0fa1=_0x25c1e6;_0x25c1e6[_0x3525b5(0x1bd)]('[')&&(_0x3c0fa1=_0x25c1e6[_0x3525b5(0x1bc)](_0x25c1e6[_0x3525b5(0x2a8)](']')+0x1));if(_0x3c0fa1===_0x3525b5(0x226))_0x2b9e05[_0x3525b5(0x2c9)][_0x3525b5(0x294)](_0x3525b5(0x1a2)),await _0x2b9e05['setStateAsync'](_0x3525b5(0x2bd),{'val':![],'ack':!![]}),await _0x2b9e05['setStateAsync'](_0x3525b5(0x1a3),{'val':_0x3525b5(0x122),'ack':!![]}),_0x2b9e05[_0x3525b5(0x12f)]=![],sendNotification(_0x2b9e05,'âœ…\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x3c0fa1===_0x3525b5(0x253)&&(_0x2b9e05[_0x3525b5(0x2c9)][_0x3525b5(0x269)](_0x3525b5(0x28f)),sendNotification(_0x2b9e05,_0x3525b5(0x11c),![],!![]));}async function runAutopilot(_0x332d49){const _0x165b07=a0_0x40ebb5,_0x24178b=_0x332d49[_0x165b07(0x1cd)][_0x165b07(0x1b2)],_0x351f7b=_0x332d49[_0x165b07(0x155)][_0x165b07(0x299)]>0x0?_0x332d49[_0x165b07(0x155)][0x0][_0x165b07(0x2a6)]:Date[_0x165b07(0x121)](),_0x454a6f=(Date[_0x165b07(0x121)]()-_0x351f7b)/(0x3e8*0x3c*0x3c);let _0x4c3ed0='';_0x332d49[_0x165b07(0x1cd)][_0x165b07(0x2df)]&&_0x332d49[_0x165b07(0x2b7)]===SYSTEM_MODES[_0x165b07(0x1e8)]&&_0x332d49['isPresent']&&(_0x454a6f>_0x24178b&&(_0x4c3ed0=_0x165b07(0x1ed)+_0x454a6f[_0x165b07(0xfc)](0x1)+_0x165b07(0x25b))),runGeminiAnalysis(_0x332d49,_0x4c3ed0)[_0x165b07(0x23a)](_0x4c81cc=>_0x332d49[_0x165b07(0x2c9)]['error'](_0x4c81cc));}async function createDailyDigest(_0x5ec1cc){const _0x3af990=a0_0x40ebb5;if(!_0x5ec1cc[_0x3af990(0xfa)])return;await _0x5ec1cc[_0x3af990(0x2b0)](LTM_DP_STATUS,{'val':_0x3af990(0x126)+new Date()[_0x3af990(0x1fb)](),'ack':!![]});if(!_0x5ec1cc[_0x3af990(0x1ec)]||_0x5ec1cc[_0x3af990(0x12c)][_0x3af990(0x299)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x5ec1cc[_0x3af990(0x2b0)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x199e41=JSON[_0x3af990(0x153)](JSON[_0x3af990(0x286)](_0x5ec1cc['rawEventLog'])),_0x2c409d=_0x199e41[_0x3af990(0x299)],_0x147c0a=_0x3af990(0x175)+JSON[_0x3af990(0x286)](_0x199e41);try{const _0x4cf53a=await _0x5ec1cc['geminiModel'][_0x3af990(0x1fc)](_0x147c0a),_0x1c50fc=JSON[_0x3af990(0x153)](_0x4cf53a[_0x3af990(0x219)]['text']()[_0x3af990(0x2db)](/```json|```/g,'')['trim']());_0x1c50fc[_0x3af990(0x251)]&&(_0x5ec1cc[_0x3af990(0x1db)][_0x3af990(0x1a1)]({'timestamp':new Date()[_0x3af990(0x13d)](),'eventCount':_0x2c409d,'summary':_0x1c50fc[_0x3af990(0x251)],'activityLevel':_0x1c50fc[_0x3af990(0x2f1)],'systemMode':_0x5ec1cc[_0x3af990(0x2b7)]}),await saveDailyDigests(_0x5ec1cc),_0x5ec1cc['rawEventLog']=[],await saveRawEventLog(_0x5ec1cc),await _0x5ec1cc[_0x3af990(0x2b0)](LTM_DP_STATUS,{'val':_0x3af990(0x287)+_0x2c409d+'\x20events','ack':!![]}),runPythonHealthCheck(_0x5ec1cc));}catch(_0x59821c){await _0x5ec1cc[_0x3af990(0x2b0)](LTM_DP_STATUS,{'val':'Error:\x20'+_0x59821c[_0x3af990(0x1d9)],'ack':!![]});}}async function sendMorningBriefing(_0x26d634){const _0x3a716a=a0_0x40ebb5;if(!_0x26d634[_0x3a716a(0x1ec)])return;_0x26d634[_0x3a716a(0x2c9)]['info'](_0x3a716a(0x204));const _0x31cfc9=_0x26d634[_0x3a716a(0x1db)][_0x3a716a(0x299)]>0x0?_0x26d634['dailyDigests'][_0x26d634[_0x3a716a(0x1db)]['length']-0x1]:null,_0x4451c8=_0x31cfc9&&_0x31cfc9[_0x3a716a(0x264)]?_0x31cfc9[_0x3a716a(0x264)][_0x3a716a(0x164)]:_0x3a716a(0x131),_0x7ff40c=new Date();_0x7ff40c[_0x3a716a(0x1f0)](0x4,0x0,0x0,0x0);const _0x1c1f04=_0x26d634['eventHistory'][_0x3a716a(0x14d)](_0x40791e=>new Date(_0x40791e[_0x3a716a(0x2a6)])>_0x7ff40c),_0x32de93=PERSONA_MAPPING[_0x26d634[_0x3a716a(0x1cd)]['aiPersona']||_0x3a716a(0x1a5)],_0x4be001=_0x26d634[_0x3a716a(0x1cd)][_0x3a716a(0x27a)]||'',_0x37f90c=await getWeatherContext(_0x26d634),_0x4fe8f0=await getCalendarContext(_0x26d634),_0x4e0453=_0x3a716a(0x14c)+_0x32de93+_0x3a716a(0x163)+_0x4be001+_0x3a716a(0x29f)+_0x37f90c+'\x20'+_0x4fe8f0+_0x3a716a(0x156)+_0x4451c8+_0x3a716a(0x102)+JSON[_0x3a716a(0x286)](_0x1c1f04['slice'](0x0,0xa))+_0x3a716a(0x2c7);try{const _0x5cc519=await _0x26d634[_0x3a716a(0x1ec)][_0x3a716a(0x1fc)](_0x4e0453),_0x243a98=_0x3a716a(0x2f4)+_0x5cc519[_0x3a716a(0x219)][_0x3a716a(0x2fa)]()[_0x3a716a(0x167)]();sendNotification(_0x26d634,_0x243a98),_0x26d634[_0x3a716a(0x2c9)][_0x3a716a(0x294)](_0x3a716a(0x1bb));}catch(_0x1d08a7){_0x26d634[_0x3a716a(0x2c9)][_0x3a716a(0x11e)](_0x3a716a(0x2af)+_0x1d08a7[_0x3a716a(0x1d9)]);}}async function scanForDevices(_0x586f0f,_0x533635){const _0x2795b2=a0_0x40ebb5;_0x586f0f['log'][_0x2795b2(0x294)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x39a54d=[],_0x379e14=await _0x586f0f[_0x2795b2(0x150)]('*'),_0x510dd5=await _0x586f0f[_0x2795b2(0x150)](_0x2795b2(0x1b8),_0x2795b2(0x268)),_0x5c53c=await _0x586f0f[_0x2795b2(0x150)]('enum.rooms.*',_0x2795b2(0x268)),_0x10bd64={};if(_0x510dd5)for(const _0x18d102 in _0x510dd5){const _0xba108e=_0x510dd5[_0x18d102][_0x2795b2(0x24e)][_0x2795b2(0x223)]||[];_0xba108e['forEach'](_0x31a5c1=>{if(!_0x10bd64[_0x31a5c1])_0x10bd64[_0x31a5c1]=[];_0x10bd64[_0x31a5c1]['push'](_0x18d102);});}const _0x4ac06f={};if(_0x5c53c)for(const _0x132997 in _0x5c53c){const _0x2a2b47=_0x5c53c[_0x132997]['common'][_0x2795b2(0x223)]||[],_0x20986b=typeof _0x5c53c[_0x132997]['common'][_0x2795b2(0x136)]===_0x2795b2(0x2c6)?_0x5c53c[_0x132997]['common'][_0x2795b2(0x136)]['de']:_0x5c53c[_0x132997]['common'][_0x2795b2(0x136)];_0x2a2b47['forEach'](_0x2b4bce=>_0x4ac06f[_0x2b4bce]=_0x20986b);}const _0xf8d526=_0x533635[_0x2795b2(0x21d)]||[],_0x1e1858=_0x533635[_0x2795b2(0x26b)]!==![],_0x2cab64=_0x533635[_0x2795b2(0x2a1)]!==![],_0x51ad4c=_0x533635[_0x2795b2(0x192)]!==![],_0x1a4389=_0x533635['temperature']===!![],_0x4f8840=_0x533635[_0x2795b2(0x22b)]===!![];for(const _0x3b9a23 in _0x379e14){const _0x59ab33=_0x379e14[_0x3b9a23];if(_0x59ab33[_0x2795b2(0x281)]!==_0x2795b2(0x2bc)||!_0x59ab33[_0x2795b2(0x24e)])continue;if(ADAPTER_BLACKLIST[_0x2795b2(0x2d2)](_0xac87a7=>_0x3b9a23[_0x2795b2(0x1bd)](_0xac87a7))&&!_0x4f8840)continue;const _0x3b9add=(_0x59ab33[_0x2795b2(0x24e)][_0x2795b2(0x22d)]||'')[_0x2795b2(0x1de)]();let _0x38c6c1=(typeof _0x59ab33[_0x2795b2(0x24e)]['name']==='object'?_0x59ab33[_0x2795b2(0x24e)][_0x2795b2(0x136)]['de']:_0x59ab33[_0x2795b2(0x24e)]['name'])||_0x3b9a23;const _0x37f7b5=_0x38c6c1[_0x2795b2(0x1de)]();let _0x3e1a91=![],_0x552e26=![];if(_0xf8d526[_0x2795b2(0x299)]>0x0){const _0x1a7359=_0x10bd64[_0x3b9a23]||[],_0x515231=_0x3b9a23[_0x2795b2(0x24d)]('.')[_0x2795b2(0x2ee)](0x0,-0x1)[_0x2795b2(0x295)]('.'),_0x5aff69=_0x10bd64[_0x515231]||[];(_0x1a7359[_0x2795b2(0x2d2)](_0x3d66d1=>_0xf8d526[_0x2795b2(0x182)](_0x3d66d1))||_0x5aff69[_0x2795b2(0x2d2)](_0x1187ca=>_0xf8d526[_0x2795b2(0x182)](_0x1187ca)))&&(_0x3e1a91=!![],_0x552e26=!![]);}if(!_0x3e1a91&&!_0x4f8840){if(HARD_IGNORE_TERMS[_0x2795b2(0x2d2)](_0x145a76=>_0x3b9a23[_0x2795b2(0x182)](_0x145a76)||_0x37f7b5[_0x2795b2(0x182)](_0x145a76[_0x2795b2(0x1de)]())))continue;}if(BAD_NAMES['some'](_0x1f4c66=>_0x37f7b5===_0x1f4c66||_0x37f7b5['endsWith']('.'+_0x1f4c66))){const _0x35a286=_0x3b9a23['split']('.');if(_0x35a286['length']>0x2){const _0x4ee774=_0x35a286[_0x2795b2(0x2ee)](0x0,-0x1)[_0x2795b2(0x295)]('.'),_0x3c3cd9=_0x379e14[_0x4ee774];if(_0x3c3cd9&&_0x3c3cd9[_0x2795b2(0x24e)]&&_0x3c3cd9[_0x2795b2(0x24e)]['name']){const _0x1b27c1=typeof _0x3c3cd9[_0x2795b2(0x24e)]['name']==='object'?_0x3c3cd9[_0x2795b2(0x24e)][_0x2795b2(0x136)]['de']:_0x3c3cd9[_0x2795b2(0x24e)][_0x2795b2(0x136)];_0x1b27c1&&!_0x38c6c1[_0x2795b2(0x182)](_0x1b27c1)&&(_0x38c6c1=_0x1b27c1+'\x20'+_0x38c6c1);}}}let _0x4f1ee1='';if(_0x1e1858&&(_0x3b9add[_0x2795b2(0x182)](_0x2795b2(0x26b))||_0x3b9add[_0x2795b2(0x182)](_0x2795b2(0x152))||_0x37f7b5[_0x2795b2(0x182)](_0x2795b2(0x22a))||_0x37f7b5[_0x2795b2(0x182)](_0x2795b2(0x2d6))))_0x4f1ee1=_0x2795b2(0x26b);else{if(!_0x4f1ee1&&_0x2cab64&&(_0x3b9add[_0x2795b2(0x182)](_0x2795b2(0x248))||_0x3b9add[_0x2795b2(0x182)](_0x2795b2(0x1a9))||_0x3b9add[_0x2795b2(0x182)](_0x2795b2(0x15c))||_0x3b9add[_0x2795b2(0x182)]('blind')||_0x3b9add[_0x2795b2(0x182)](_0x2795b2(0x1f4))||_0x37f7b5[_0x2795b2(0x182)](_0x2795b2(0x1ef))||_0x37f7b5[_0x2795b2(0x182)](_0x2795b2(0x1f9))||_0x37f7b5[_0x2795b2(0x182)](_0x2795b2(0x120))))_0x4f1ee1=_0x2795b2(0x248);else{if(!_0x4f1ee1&&_0x51ad4c&&(_0x3b9add[_0x2795b2(0x182)]('light')||_0x3b9add['includes'](_0x2795b2(0x1d1))||_0x3b9add[_0x2795b2(0x182)]('dimmer')||_0x37f7b5[_0x2795b2(0x182)]('licht')||_0x37f7b5[_0x2795b2(0x182)](_0x2795b2(0x2eb))||_0x37f7b5[_0x2795b2(0x182)](_0x2795b2(0x144)))){if(_0x59ab33['common'][_0x2795b2(0x26f)]||_0x3b9add[_0x2795b2(0x182)](_0x2795b2(0x124)))_0x4f1ee1=_0x2795b2(0x168);}else{if(!_0x4f1ee1&&_0x1a4389&&(_0x3b9add[_0x2795b2(0x182)]('temperature')||_0x3b9add['includes'](_0x2795b2(0x25d))||_0x3b9add[_0x2795b2(0x182)](_0x2795b2(0x232))||_0x37f7b5['includes'](_0x2795b2(0x245))||_0x37f7b5[_0x2795b2(0x182)]('klima')||_0x37f7b5[_0x2795b2(0x182)](_0x2795b2(0x207))))_0x4f1ee1=_0x2795b2(0x1c0);else{if(!_0x4f1ee1&&_0x552e26)_0x4f1ee1=_0x2795b2(0x25c);}}}}if(_0x4f1ee1){let _0x53ddd1=_0x4ac06f[_0x3b9a23]||'';if(!_0x53ddd1){let _0x51138b=_0x3b9a23;for(let _0x1e2be0=0x0;_0x1e2be0<0x3;_0x1e2be0++){const _0x366ddd=_0x51138b[_0x2795b2(0x1cc)]('.');if(_0x366ddd===-0x1)break;_0x51138b=_0x51138b[_0x2795b2(0x1bc)](0x0,_0x366ddd);if(_0x4ac06f[_0x51138b]){_0x53ddd1=_0x4ac06f[_0x51138b];break;}}}_0x39a54d[_0x2795b2(0x1a1)]({'id':_0x3b9a23,'name':_0x38c6c1,'location':_0x53ddd1,'type':_0x4f1ee1,'logDuplicates':_0x4f1ee1==='motion','isExit':![],'_score':_0x53ddd1?0x50:_0x4f1ee1===_0x2795b2(0x25c)?0x5a:0x28});}}return _0x39a54d['sort']((_0x38a815,_0x4755d6)=>_0x4755d6[_0x2795b2(0x2ca)]-_0x38a815[_0x2795b2(0x2ca)]),_0x39a54d;}async function executeAutomationAction(_0xfc4151){const _0xd4416a=a0_0x40ebb5;try{const _0x237a2d=await _0xfc4151[_0xd4416a(0x1cb)](_0xd4416a(0x21c)),_0x36d81b=await _0xfc4151[_0xd4416a(0x1cb)](_0xd4416a(0x2ef));if(_0x237a2d&&_0x237a2d['val']&&_0x36d81b){const _0x56f3a3=_0x237a2d[_0xd4416a(0x2e5)];let _0x282a16=_0x36d81b[_0xd4416a(0x2e5)];try{_0x282a16=JSON[_0xd4416a(0x153)](_0x282a16);}catch(_0x3c7ec1){}_0xfc4151['log'][_0xd4416a(0x294)](_0xd4416a(0x2ed)+_0x56f3a3+'\x20=\x20'+_0x282a16),await _0xfc4151[_0xd4416a(0x1ee)](_0x56f3a3,_0x282a16);}else _0xfc4151[_0xd4416a(0x2c9)][_0xd4416a(0x269)](_0xd4416a(0x1b4));}catch(_0x5420cd){_0xfc4151[_0xd4416a(0x2c9)][_0xd4416a(0x11e)]('BUTLER\x20Execution\x20Error:\x20'+_0x5420cd[_0xd4416a(0x1d9)]);}}function tryParse(_0xcdbfd2){try{return JSON['parse'](_0xcdbfd2);}catch(_0x128ba7){return null;}}async function recordSequence(_0x2e82f8,_0x176ef7){const _0x445f7c=a0_0x40ebb5,_0x287e31=(_0x176ef7[_0x445f7c(0x281)]||'')[_0x445f7c(0x1de)](),_0x1baf7b=['motion',_0x445f7c(0x22a),'prÃ¤senz','presence',_0x445f7c(0x152),_0x445f7c(0x248),_0x445f7c(0x1f9),_0x445f7c(0x1a9),_0x445f7c(0x1ef),_0x445f7c(0x112),_0x445f7c(0x20d),_0x445f7c(0x168),'licht',_0x445f7c(0x1d1),_0x445f7c(0x144),_0x445f7c(0x239),_0x445f7c(0x2eb)];if(!_0x1baf7b['some'](_0x25de71=>_0x287e31['includes'](_0x25de71))){_0x2e82f8[_0x445f7c(0x2c9)][_0x445f7c(0x260)](_0x445f7c(0x13b)+_0x176ef7['id']+_0x445f7c(0x2f7)+_0x176ef7[_0x445f7c(0x281)]+_0x445f7c(0x256));return;}if(!_0x176ef7[_0x445f7c(0x195)]){_0x2e82f8[_0x445f7c(0x2c9)]['debug']('[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20'+_0x176ef7['id']+_0x445f7c(0x1e2)+_0x176ef7[_0x445f7c(0x195)]+')');return;}_0x2e82f8[_0x445f7c(0x2c9)][_0x445f7c(0x260)](_0x445f7c(0x189)+_0x176ef7['id']+'\x20('+_0x176ef7[_0x445f7c(0x2ae)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x4a607c={'loc':_0x176ef7['location']||_0x445f7c(0x297),'id':_0x176ef7['id'],'ts':Date[_0x445f7c(0x121)]()};activeSequence[_0x445f7c(0x1a1)](_0x4a607c),_0x2e82f8[_0x445f7c(0x2c9)][_0x445f7c(0x260)](_0x445f7c(0x271)+_0x4a607c['loc']+'\x20(Length:\x20'+activeSequence[_0x445f7c(0x299)]+')'),sequenceTimer=setTimeout(async()=>{const _0x5a281b=_0x445f7c;activeSequence[_0x5a281b(0x299)]>0x1?await saveCompletedSequence(_0x2e82f8):(_0x2e82f8['log'][_0x5a281b(0x260)](_0x5a281b(0x1ea)+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0xb0d8eb){const _0x2687b2=a0_0x40ebb5;try{_0xb0d8eb[_0x2687b2(0x2c9)][_0x2687b2(0x294)](_0x2687b2(0x1e1)+activeSequence[_0x2687b2(0x299)]+').\x20Saving\x20to\x20Training\x20Data.');const _0xa463cf=await _0xb0d8eb[_0x2687b2(0x1cb)](_0x2687b2(0x231));let _0x294f62=[];if(_0xa463cf&&_0xa463cf['val'])try{_0x294f62=JSON[_0x2687b2(0x153)](_0xa463cf['val']);}catch(_0x2e1f9f){}const _0x3dac77=activeSequence[0x0]['ts'],_0x4eb0d2=activeSequence[_0x2687b2(0x162)](_0x2dfe07=>({'loc':_0x2dfe07[_0x2687b2(0x2d7)],'t_delta':Math[_0x2687b2(0x288)]((_0x2dfe07['ts']-_0x3dac77)/0x3e8)})),_0x7ae2e9={'timestamp':new Date(_0x3dac77)['toISOString'](),'steps':_0x4eb0d2,'duration':Math['round']((activeSequence[activeSequence['length']-0x1]['ts']-_0x3dac77)/0x3e8),'daytime':new Date(_0x3dac77)['getHours']()};_0x294f62[_0x2687b2(0x1a1)](_0x7ae2e9),_0x294f62[_0x2687b2(0x299)]>MAX_TRAINING_SET_SIZE&&_0x294f62[_0x2687b2(0x1c3)](),await _0xb0d8eb['setStateAsync'](_0x2687b2(0x231),{'val':JSON[_0x2687b2(0x286)](_0x294f62),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x5eb0b0){_0xb0d8eb[_0x2687b2(0x2c9)][_0x2687b2(0x11e)](_0x2687b2(0x1a4)+_0x5eb0b0[_0x2687b2(0x1d9)]);}}async function getOutsideTemperatureNumeric(_0x278f3e){const _0xcba796=a0_0x40ebb5;if(_0x278f3e[_0xcba796(0x1cd)][_0xcba796(0x2cb)])try{const _0x1c12f0=await _0x278f3e[_0xcba796(0x197)](_0x278f3e[_0xcba796(0x1cd)]['outdoorSensorId']);if(_0x1c12f0&&_0x1c12f0[_0xcba796(0x2e5)]!==undefined&&_0x1c12f0[_0xcba796(0x2e5)]!==null){const _0x161324=parseFloat(_0x1c12f0[_0xcba796(0x2e5)]);if(!isNaN(_0x161324))return _0x161324;}}catch(_0x2e25be){_0x278f3e[_0xcba796(0x2c9)][_0xcba796(0x269)](_0xcba796(0x228)+_0x278f3e[_0xcba796(0x1cd)][_0xcba796(0x2cb)]+':\x20'+_0x2e25be[_0xcba796(0x1d9)]);}const _0x131ca5=_0x278f3e['config'][_0xcba796(0x20f)];if(!_0x278f3e[_0xcba796(0x1cd)]['useWeather']||!_0x131ca5)return null;try{let _0xe92041='';if(_0x131ca5['includes'](_0xcba796(0x205)))_0xe92041=_0x131ca5+'.Current.Temperature';else{if(_0x131ca5[_0xcba796(0x182)](_0xcba796(0x2bf)))_0xe92041=_0x131ca5+_0xcba796(0x24a);else{if(_0x131ca5[_0xcba796(0x182)](_0xcba796(0x123)))_0xe92041=_0x131ca5+_0xcba796(0x15b);else{if(_0x131ca5[_0xcba796(0x182)](_0xcba796(0x2ad)))_0xe92041=_0x131ca5+_0xcba796(0x252);}}}if(_0xe92041){const _0x43b8c3=await _0x278f3e[_0xcba796(0x197)](_0xe92041);if(_0x43b8c3&&_0x43b8c3[_0xcba796(0x2e5)]!==undefined&&_0x43b8c3['val']!==null)return parseFloat(_0x43b8c3[_0xcba796(0x2e5)]);}}catch(_0x4e03a7){}return null;}async function recordThermodynamics(_0x2a72ea,_0x113592,_0xd149aa,_0x3e1fea){const _0x1ac40d=a0_0x40ebb5,_0x74dba8=await getOutsideTemperatureNumeric(_0x2a72ea),_0x7a36ff=await _0x2a72ea[_0x1ac40d(0x1cb)]('LTM.trainingData.thermodynamics');let _0x19e929=[];if(_0x7a36ff&&_0x7a36ff[_0x1ac40d(0x2e5)])try{_0x19e929=JSON[_0x1ac40d(0x153)](_0x7a36ff[_0x1ac40d(0x2e5)]);}catch(_0x2c8528){}_0x19e929[_0x1ac40d(0x1a1)]({'ts':Date[_0x1ac40d(0x121)](),'room':_0x3e1fea||_0x1ac40d(0x297),'t_in':_0xd149aa,'t_out':_0x74dba8});if(_0x19e929[_0x1ac40d(0x299)]>THERMO_LOG_SIZE)_0x19e929[_0x1ac40d(0x1c3)]();await _0x2a72ea[_0x1ac40d(0x2b0)](_0x1ac40d(0x1f1),{'val':JSON[_0x1ac40d(0x286)](_0x19e929),'ack':!![]});}function installPythonDependencies(_0x42cf5c){const _0x1db63f=a0_0x40ebb5;if(_0x42cf5c[_0x1db63f(0x1c6)])return;_0x42cf5c[_0x1db63f(0x1c6)]=!![];const _0x44c836=path['join'](__dirname,_0x1db63f(0x2d4),_0x1db63f(0x20a));_0x42cf5c[_0x1db63f(0x2c9)][_0x1db63f(0x294)](_0x1db63f(0x28b)+_0x44c836+_0x1db63f(0x191)),stopPythonService(_0x42cf5c);const _0x589067=_0x1db63f(0x1bf)+_0x44c836+_0x1db63f(0x1d8);exec(_0x589067,(_0x3f66fa,_0x4acbac,_0x45e53f)=>{const _0x23f297=_0x1db63f,_0x535d3a=_0x45e53f&&_0x45e53f['includes']('No\x20module\x20named\x20pip')||_0x3f66fa&&_0x3f66fa['message'][_0x23f297(0x182)](_0x23f297(0x2ec));if(_0x535d3a){_0x42cf5c[_0x23f297(0x2c9)][_0x23f297(0x269)](_0x23f297(0x2f6)),exec(_0x23f297(0x178),(_0x522547,_0x209af2,_0x35c628)=>{const _0x2b310a=_0x23f297;_0x522547?(_0x42cf5c[_0x2b310a(0x2c9)][_0x2b310a(0x11e)](_0x2b310a(0x18a)),_0x42cf5c[_0x2b310a(0x2c9)]['error'](_0x2b310a(0x247)),_0x42cf5c[_0x2b310a(0x1c6)]=![]):(_0x42cf5c['log'][_0x2b310a(0x294)](_0x2b310a(0x2d5)),exec('python3\x20-m\x20pip\x20install\x20-r\x20\x22'+_0x44c836+'\x22\x20--break-system-packages\x20--user',(_0x18489e,_0x4547b9,_0x48ab0a)=>{const _0x569202=_0x2b310a;_0x18489e?_0x42cf5c[_0x569202(0x2c9)]['error']('âŒ\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20'+_0x18489e['message']):(_0x42cf5c['log'][_0x569202(0x294)](_0x569202(0x1d5)),startPythonService(_0x42cf5c)),_0x42cf5c[_0x569202(0x1c6)]=![];}));});return;}_0x42cf5c[_0x23f297(0x1c6)]=![],_0x3f66fa?(_0x42cf5c[_0x23f297(0x2c9)]['error'](_0x23f297(0x1b0)),_0x42cf5c['log'][_0x23f297(0x11e)](_0x23f297(0x101)+(_0x45e53f||_0x3f66fa[_0x23f297(0x1d9)]))):(_0x42cf5c[_0x23f297(0x2c9)][_0x23f297(0x294)](_0x23f297(0x2f2)),startPythonService(_0x42cf5c));});}function sendToPython(_0x296cb5,_0x19e464,_0x2928ae={}){const _0x2c104f=a0_0x40ebb5;if(!_0x296cb5[_0x2c104f(0x143)]||!_0x296cb5[_0x2c104f(0x143)][_0x2c104f(0x272)][_0x2c104f(0x12e)])return;const _0x39434d=JSON[_0x2c104f(0x286)]({'command':_0x19e464,..._0x2928ae});try{_0x296cb5[_0x2c104f(0x143)][_0x2c104f(0x272)][_0x2c104f(0x26f)](_0x39434d+'\x0a');}catch(_0x578757){_0x296cb5[_0x2c104f(0x2c9)][_0x2c104f(0x11e)](_0x2c104f(0x28c)+_0x578757[_0x2c104f(0x1d9)]);}}function runPythonHealthCheck(_0x3b089e){const _0x9dae26=a0_0x40ebb5;if(!_0x3b089e[_0x9dae26(0x1db)]||_0x3b089e[_0x9dae26(0x1db)][_0x9dae26(0x299)]<0x2){_0x3b089e['log'][_0x9dae26(0x294)]('Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.');return;}const _0x2b395e=_0x3b089e[_0x9dae26(0x1db)]['map'](_0x1cdbc5=>{const _0x220fbf=_0x9dae26,_0x2f00e4=(_0x1cdbc5[_0x220fbf(0x2f1)]||'')[_0x220fbf(0x1de)]();return ACTIVITY_LEVEL_MAP[_0x2f00e4]||0x32;});_0x3b089e['log'][_0x9dae26(0x294)](_0x9dae26(0x1c7)+_0x2b395e['length']+_0x9dae26(0x217)),sendToPython(_0x3b089e,_0x9dae26(0x1e7),{'values':_0x2b395e,'tag':_0x9dae26(0x2b9)});}function handlePythonResult(_0x5ccce7,_0x58f24d){const _0x2f0388=a0_0x40ebb5;if(_0x58f24d[_0x2f0388(0x281)]==='PONG')_0x5ccce7[_0x2f0388(0x2c9)]['debug']('ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.');else{if(_0x58f24d['type']===_0x2f0388(0x261)){const {tag:_0x4772bd,diagnosis:_0xd41387,change_percent:_0x2285ce}=_0x58f24d[_0x2f0388(0x17e)];_0x5ccce7['log'][_0x2f0388(0x294)]('ðŸ\x20Guardian\x20Diagnosis\x20('+_0x4772bd+'):\x20'+_0xd41387+'\x20('+_0x2285ce+'%)'),_0x5ccce7[_0x2f0388(0x2b0)](_0x2f0388(0x265),{'val':_0xd41387,'ack':!![]}),_0x5ccce7['setStateAsync']('analysis.health.trendValue',{'val':_0x2285ce,'ack':!![]});}}}function startPythonService(_0x20374c){const _0x5de104=a0_0x40ebb5;try{const _0x545b27=path[_0x5de104(0x295)](__dirname,_0x5de104(0x2d4),_0x5de104(0x2b6));_0x20374c[_0x5de104(0x2c9)][_0x5de104(0x294)](_0x5de104(0x157)+_0x545b27),_0x20374c[_0x5de104(0x143)]=spawn(_0x5de104(0x180),[_0x545b27]),_0x20374c[_0x5de104(0x143)][_0x5de104(0x186)]['on'](_0x5de104(0x2f3),_0x5bed9c=>{const _0x498cf2=_0x5de104,_0x21e4b9=_0x5bed9c[_0x498cf2(0x28e)]()[_0x498cf2(0x24d)]('\x0a');_0x21e4b9[_0x498cf2(0x254)](_0x56aca2=>{const _0xdae43b=_0x498cf2,_0x2c93e1=_0x56aca2['trim']();if(!_0x2c93e1)return;if(_0x2c93e1[_0xdae43b(0x1bd)](_0xdae43b(0x211)))_0x20374c[_0xdae43b(0x2c9)][_0xdae43b(0x260)](_0xdae43b(0x2da)+_0x2c93e1[_0xdae43b(0x1bc)](0x5)[_0xdae43b(0x167)]());else{if(_0x2c93e1[_0xdae43b(0x1bd)]('[RESULT]'))try{const _0x18d5f8=JSON['parse'](_0x2c93e1['substring'](0x8)['trim']());handlePythonResult(_0x20374c,_0x18d5f8);}catch(_0x408a4e){_0x20374c['log'][_0xdae43b(0x269)]('Invalid\x20JSON\x20from\x20Python:\x20'+_0x2c93e1);}}(_0x2c93e1['includes']('No\x20module\x20named')||_0x2c93e1[_0xdae43b(0x182)](_0xdae43b(0x293))||_0x2c93e1['includes'](_0xdae43b(0x29e)))&&(_0x20374c[_0xdae43b(0x2c9)][_0xdae43b(0x269)](_0xdae43b(0x213)),installPythonDependencies(_0x20374c));});}),_0x20374c[_0x5de104(0x143)][_0x5de104(0x1fe)]['on'](_0x5de104(0x2f3),_0x689a52=>{const _0x5a2eac=_0x5de104,_0x19b84e=_0x689a52[_0x5a2eac(0x28e)]()['trim']();_0x20374c[_0x5a2eac(0x2c9)][_0x5a2eac(0x11e)]('[PYTHON\x20ERR]\x20'+_0x19b84e);}),_0x20374c[_0x5de104(0x143)]['on']('close',_0x5a6df3=>{const _0x2f93cd=_0x5de104;_0x20374c[_0x2f93cd(0x2c9)]['info'](_0x2f93cd(0x210)+_0x5a6df3),_0x20374c[_0x2f93cd(0x143)]=null;}),_0x20374c[_0x5de104(0x143)]['on'](_0x5de104(0x11e),_0x179879=>{const _0x35f06d=_0x5de104;_0x20374c[_0x35f06d(0x2c9)]['warn'](_0x35f06d(0x2a3)+_0x179879[_0x35f06d(0x1d9)]);});}catch(_0x1619fa){_0x20374c[_0x5de104(0x2c9)][_0x5de104(0x11e)]('Error\x20launching\x20Python\x20service:\x20'+_0x1619fa[_0x5de104(0x1d9)]);}}function stopPythonService(_0x184078){const _0x5e6c88=a0_0x40ebb5;if(_0x184078[_0x5e6c88(0x143)]){_0x184078[_0x5e6c88(0x2c9)]['info'](_0x5e6c88(0x1c2));try{_0x184078[_0x5e6c88(0x143)][_0x5e6c88(0x118)]();}catch(_0x203616){_0x184078['log'][_0x5e6c88(0x269)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x203616[_0x5e6c88(0x1d9)]);}_0x184078[_0x5e6c88(0x143)]=null;}}class CogniLiving extends utils[a0_0x40ebb5(0xff)]{constructor(_0x2a5333){const _0x139a3d=a0_0x40ebb5;super({..._0x2a5333,'name':'cogni-living'}),this['eventHistory']=[],this[_0x139a3d(0x273)]=[],this[_0x139a3d(0x1c1)]=[],this[_0x139a3d(0x12c)]=[],this[_0x139a3d(0x1db)]=[],this[_0x139a3d(0x199)]={},this[_0x139a3d(0x165)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x139a3d(0x237)]=!![],this[_0x139a3d(0x14f)]=null,this[_0x139a3d(0x2e3)]=null,this[_0x139a3d(0x250)]=![],this[_0x139a3d(0x198)]=null,this['geminiModel']=null,this[_0x139a3d(0x2b7)]=SYSTEM_MODES['NORMAL'],this['isProVersion']=![],this[_0x139a3d(0x12f)]=![],this[_0x139a3d(0x2a5)]=_0x139a3d(0x1da),this[_0x139a3d(0x111)]=null,this[_0x139a3d(0x2e6)]=null,this[_0x139a3d(0x2c1)]=null,this['driftAnalysisTimer']=null,this[_0x139a3d(0x278)]=null,this['pythonProcess']=null,this[_0x139a3d(0x1c6)]=![],this['on'](_0x139a3d(0x236),this[_0x139a3d(0x18c)][_0x139a3d(0x13f)](this)),this['on'](_0x139a3d(0x2c4),this[_0x139a3d(0x12a)]['bind'](this)),this['on'](_0x139a3d(0x174),this['onUnload'][_0x139a3d(0x13f)](this)),this['on'](_0x139a3d(0x1d9),this[_0x139a3d(0x2e8)][_0x139a3d(0x13f)](this));}async[a0_0x40ebb5(0x18c)](){const _0x368e2e=a0_0x40ebb5;this[_0x368e2e(0x2c9)][_0x368e2e(0x294)](_0x368e2e(0x128)+this[_0x368e2e(0x206)]+_0x368e2e(0x16f)),await initZombies(this),this[_0x368e2e(0x1cd)][_0x368e2e(0x2c5)]=this[_0x368e2e(0x1cd)]['licenseKey']||'';try{this['isProVersion']=await checkLicense(this,this[_0x368e2e(0x1cd)][_0x368e2e(0x2c5)]);}catch(_0x2ed19d){}if(!this['config'][_0x368e2e(0x1b2)]||this[_0x368e2e(0x1cd)][_0x368e2e(0x1b2)]<0.1)this[_0x368e2e(0x1cd)][_0x368e2e(0x1b2)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x368e2e(0x1cd)]['geminiApiKey'])try{this[_0x368e2e(0x198)]=new GoogleGenerativeAI(this['config'][_0x368e2e(0x201)]),this[_0x368e2e(0x1ec)]=this['genAI'][_0x368e2e(0x1ac)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x368e2e(0x2c9)]['info'](_0x368e2e(0x21a));}catch(_0x38cceb){this[_0x368e2e(0x2c9)][_0x368e2e(0x11e)](_0x368e2e(0x19c)+_0x38cceb['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x368e2e(0x1df)]('analysis.trigger'),this[_0x368e2e(0x1df)](LTM_DP_TRIGGER_DIGEST),this[_0x368e2e(0x1df)]('system.mode'),this[_0x368e2e(0x1df)]('analysis.triggerBriefing'),this[_0x368e2e(0x1df)](_0x368e2e(0x2c8)),this[_0x368e2e(0x1df)]('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x368e2e(0x111)])clearInterval(this[_0x368e2e(0x111)]);const _0xf2524d=this['config'][_0x368e2e(0xf8)]||0xf;_0xf2524d>0x0&&(this[_0x368e2e(0x2c9)][_0x368e2e(0x294)]('Starting\x20Autopilot\x20('+_0xf2524d+_0x368e2e(0x2b5)),this[_0x368e2e(0x111)]=setInterval(()=>{runAutopilot(this);},_0xf2524d*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{this['pythonProcess']&&runPythonHealthCheck(this);},0x1388);}[a0_0x40ebb5(0x262)](_0xfe299d){const _0x50e05d=a0_0x40ebb5;if(this['analysisTimer'])clearInterval(this[_0x50e05d(0x111)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x50e05d(0x1ca)]);if(this[_0x50e05d(0x2e6)])this['ltmJob'][_0x50e05d(0x105)]();if(this[_0x50e05d(0x2c1)])this[_0x50e05d(0x2c1)][_0x50e05d(0x105)]();if(this[_0x50e05d(0x278)])this[_0x50e05d(0x278)]['cancel']();if(this[_0x50e05d(0x14f)])clearTimeout(this['exitTimer']);if(this[_0x50e05d(0x2e3)])clearTimeout(this[_0x50e05d(0x2e3)]);stopPythonService(this),_0xfe299d();}async[a0_0x40ebb5(0x12a)](_0x266950,_0x57bfb1){const _0x1a71a7=a0_0x40ebb5;if(!_0x57bfb1)return;if(_0x266950[_0x1a71a7(0x182)](_0x1a71a7(0x19f))&&_0x266950[_0x1a71a7(0x159)](_0x1a71a7(0x1ff))&&_0x57bfb1[_0x1a71a7(0x2e5)]){await handleTelegramResponse(this,_0x57bfb1[_0x1a71a7(0x2e5)]);return;}if(_0x266950===this[_0x1a71a7(0x1c4)]+'.'+SYSTEM_DP_MODE){_0x57bfb1[_0x1a71a7(0x2e5)]&&Object[_0x1a71a7(0x28a)](SYSTEM_MODES)[_0x1a71a7(0x182)](_0x57bfb1[_0x1a71a7(0x2e5)])&&(this[_0x1a71a7(0x2b7)]=_0x57bfb1[_0x1a71a7(0x2e5)],_0x57bfb1['val']===SYSTEM_MODES[_0x1a71a7(0x20c)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x57bfb1[_0x1a71a7(0x26a)])this['setState'](_0x266950,{'val':this[_0x1a71a7(0x2b7)],'ack':!![]});return;}if(!_0x57bfb1[_0x1a71a7(0x26a)]){_0x266950[_0x1a71a7(0x182)](_0x1a71a7(0x229))&&_0x57bfb1[_0x1a71a7(0x2e5)]&&(this['setState'](_0x266950,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x266950['includes']('triggerDailyDigest')&&_0x57bfb1[_0x1a71a7(0x2e5)]){this['setState'](_0x266950,{'val':![],'ack':!![]});if(this[_0x1a71a7(0xfa)])createDailyDigest(this);}_0x266950[_0x1a71a7(0x182)](_0x1a71a7(0x2de))&&_0x57bfb1[_0x1a71a7(0x2e5)]&&(this[_0x1a71a7(0x216)](_0x266950,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x266950[_0x1a71a7(0x182)](_0x1a71a7(0x2dd))&&_0x57bfb1['val']&&(this[_0x1a71a7(0x216)](_0x266950,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this['config'][_0x1a71a7(0x2e2)]&&this[_0x1a71a7(0x1cd)][_0x1a71a7(0x2e2)][_0x1a71a7(0x182)](_0x266950)){await checkWifiPresence(this);return;}const _0x3022e7=(this[_0x1a71a7(0x1cd)][_0x1a71a7(0x17a)]||[])[_0x1a71a7(0x187)](_0x54cdbf=>_0x54cdbf['id']===_0x266950);if(_0x3022e7)processSensorEvent(this,_0x266950,_0x57bfb1,_0x3022e7);}async[a0_0x40ebb5(0x2e8)](_0xa79d51){const _0x4ea5a3=a0_0x40ebb5;if(typeof _0xa79d51==='object'&&_0xa79d51[_0x4ea5a3(0x1d9)])try{if(_0xa79d51['command']==='testApiKey'){const _0x15391b=_0xa79d51[_0x4ea5a3(0x1d9)][_0x4ea5a3(0x25f)]||this[_0x4ea5a3(0x1cd)]['geminiApiKey'];if(!_0x15391b)return this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':![],'message':'Kein\x20API\x20Key\x20eingegeben.'},_0xa79d51['callback']);try{const _0x345f6f=new GoogleGenerativeAI(_0x15391b),_0x18d528=_0x345f6f[_0x4ea5a3(0x1ac)]({'model':GEMINI_MODEL}),_0x4ff7be=await _0x18d528[_0x4ea5a3(0x1fc)]('Say\x20Hello'),_0x2b7d10=await _0x4ff7be[_0x4ea5a3(0x219)],_0x10908a=_0x2b7d10['text']();this['sendTo'](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51['command'],{'success':!![],'message':'Verbindung\x20erfolgreich!\x20Antwort:\x20'+_0x10908a['substring'](0x0,0x14)+_0x4ea5a3(0x191)},_0xa79d51[_0x4ea5a3(0x11d)]);}catch(_0x249032){this[_0x4ea5a3(0x11a)](_0xa79d51['from'],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':![],'message':'Fehler:\x20'+_0x249032['message']},_0xa79d51[_0x4ea5a3(0x11d)]);}}else{if(_0xa79d51['command']==='testContext'){const _0x3bb6c9=await getWeatherContext(this),_0x40b798=await getCalendarContext(this);this['sendTo'](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':!![],'weather':_0x3bb6c9,'calendar':_0x40b798},_0xa79d51['callback']);}else{if(_0xa79d51[_0x4ea5a3(0x2bb)]===_0x4ea5a3(0x2ce)){}else{if(_0xa79d51[_0x4ea5a3(0x2bb)]===_0x4ea5a3(0x28d)){if(!this['isProVersion'])return this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':![],'isPro':![]},_0xa79d51[_0x4ea5a3(0x11d)]);let _0x3b94a3={'status':'N/A','details':'','lastCheck':0x0};try{_0x3b94a3[_0x4ea5a3(0x20e)]=(await this[_0x4ea5a3(0x1cb)](LTM_DP_DRIFT_STATUS))['val'],_0x3b94a3[_0x4ea5a3(0x2c2)]=(await this[_0x4ea5a3(0x1cb)](LTM_DP_DRIFT_DETAILS))[_0x4ea5a3(0x2e5)],_0x3b94a3[_0x4ea5a3(0x2b3)]=(await this[_0x4ea5a3(0x1cb)](LTM_DP_DRIFT_LAST_CHECK))[_0x4ea5a3(0x2e5)];}catch(_0x492951){}const _0x5b97bd=this[_0x4ea5a3(0x273)]||[];this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x4ea5a3(0x1db)],'driftAnalysis':_0x3b94a3,'analysisHistory':_0x5b97bd},_0xa79d51[_0x4ea5a3(0x11d)]);}else{if(_0xa79d51[_0x4ea5a3(0x2bb)]==='getOverviewData'){const _0x5361b5=this[_0x4ea5a3(0x1db)][_0x4ea5a3(0x299)],_0x279ddd=new Date(),_0x423c45=new Date(_0x279ddd[_0x4ea5a3(0x203)](),_0x279ddd[_0x4ea5a3(0xf6)](),_0x279ddd[_0x4ea5a3(0x145)]())[_0x4ea5a3(0x29b)](),_0x2805e7=this[_0x4ea5a3(0x12c)][_0x4ea5a3(0x14d)](_0x468400=>new Date(_0x468400[_0x4ea5a3(0x2a6)])['getTime']()>_0x423c45)[_0x4ea5a3(0x299)],_0x43a634=new Array(0x18)[_0x4ea5a3(0x1e0)](0x0);this[_0x4ea5a3(0x12c)][_0x4ea5a3(0x254)](_0x2025de=>{const _0x35a5c0=_0x4ea5a3,_0x3f662f=new Date(_0x2025de[_0x35a5c0(0x2a6)]);if(_0x3f662f['getTime']()>_0x423c45)_0x43a634[_0x3f662f['getHours']()]++;});let _0x409a6b={'status':_0x4ea5a3(0x131)};try{_0x409a6b['status']=(await this[_0x4ea5a3(0x1cb)](LTM_DP_DRIFT_STATUS))[_0x4ea5a3(0x2e5)];}catch(_0x4e49f1){}let _0x55b4ff='';try{const _0x2471da=await this['getStateAsync']('system.presenceWho');_0x55b4ff=_0x2471da?_0x2471da[_0x4ea5a3(0x2e5)]:'';}catch(_0x1bc47b){}let _0x20538f=null;!this['geminiModel']&&(_0x20538f=this['config'][_0x4ea5a3(0x201)]?_0x4ea5a3(0x1e4):_0x4ea5a3(0x1eb));let _0x5e8643={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x21ba7b=await this[_0x4ea5a3(0x1cb)](_0x4ea5a3(0x10a)),_0x151f8e=await this[_0x4ea5a3(0x1cb)](_0x4ea5a3(0x15e)),_0x112c1d=await this[_0x4ea5a3(0x1cb)](_0x4ea5a3(0x21c)),_0x57d6ee=await this[_0x4ea5a3(0x1cb)](_0x4ea5a3(0x2ef)),_0x7b93ec=await this[_0x4ea5a3(0x1cb)]('analysis.automation.autoApply');_0x21ba7b&&_0x21ba7b[_0x4ea5a3(0x2e5)]&&(_0x5e8643['detected']=!![],_0x5e8643['description']=_0x151f8e?_0x151f8e[_0x4ea5a3(0x2e5)]:'',_0x5e8643['targetId']=_0x112c1d?_0x112c1d[_0x4ea5a3(0x2e5)]:'',_0x5e8643[_0x4ea5a3(0x2ea)]=_0x57d6ee?_0x57d6ee['val']:''),_0x5e8643[_0x4ea5a3(0x292)]=_0x7b93ec?!!_0x7b93ec[_0x4ea5a3(0x2e5)]:![];}catch(_0x36f3b3){}this['sendTo'](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51['command'],{'success':!![],'eventHistory':this[_0x4ea5a3(0x155)][_0x4ea5a3(0x2ee)](0x0,0xf),'stats':{'digestCount':_0x5361b5,'eventCountToday':_0x2805e7,'hourlyActivity':_0x43a634,'driftStatus':_0x409a6b['status'],'isPresent':this['isPresent'],'presenceWho':_0x55b4ff,'minDays':this[_0x4ea5a3(0x1cd)]['minDaysForBaseline']||0x7,'stbDays':this[_0x4ea5a3(0x1cd)][_0x4ea5a3(0x282)]||0xe,'ltbDays':this[_0x4ea5a3(0x1cd)][_0x4ea5a3(0x2a7)]||0x3c,'systemError':_0x20538f},'automation':_0x5e8643},_0xa79d51[_0x4ea5a3(0x11d)]);}else{if(_0xa79d51['command']===_0x4ea5a3(0x290)){const _0x104341=await this[_0x4ea5a3(0x150)](_0x4ea5a3(0x1b8),_0x4ea5a3(0x268)),_0x3b65c0=[];if(_0x104341)for(const _0x163bed in _0x104341){const _0x17845b=_0x104341[_0x163bed],_0x4e298c=(_0x17845b[_0x4ea5a3(0x24e)]&&typeof _0x17845b[_0x4ea5a3(0x24e)][_0x4ea5a3(0x136)]===_0x4ea5a3(0x2c6)?_0x17845b[_0x4ea5a3(0x24e)]['name']['de']:_0x17845b[_0x4ea5a3(0x24e)][_0x4ea5a3(0x136)])||_0x17845b[_0x4ea5a3(0x24e)][_0x4ea5a3(0x136)];_0x3b65c0[_0x4ea5a3(0x1a1)]({'id':_0x163bed,'name':_0x4e298c});}this[_0x4ea5a3(0x11a)](_0xa79d51['from'],_0xa79d51['command'],{'success':!![],'enums':_0x3b65c0},_0xa79d51[_0x4ea5a3(0x11d)]);}else{if(_0xa79d51[_0x4ea5a3(0x2bb)]==='scanDevices')try{const _0x143811=await scanForDevices(this,_0xa79d51[_0x4ea5a3(0x1d9)]||{});this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':!![],'devices':_0x143811},_0xa79d51['callback']);}catch(_0x550b53){this['sendTo'](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':![],'error':_0x550b53[_0x4ea5a3(0x1d9)]},_0xa79d51[_0x4ea5a3(0x11d)]);}else{if(_0xa79d51[_0x4ea5a3(0x2bb)]===_0x4ea5a3(0x116)){const _0x13866d=_0xa79d51['message'][_0x4ea5a3(0x113)];if(!_0x13866d)return this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':![],'error':_0x4ea5a3(0x233)},_0xa79d51[_0x4ea5a3(0x11d)]);const _0x55439a=await getCalendarNames(this,_0x13866d);this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':!![],'names':_0x55439a},_0xa79d51[_0x4ea5a3(0x11d)]);}else{if(_0xa79d51[_0x4ea5a3(0x2bb)]===_0x4ea5a3(0x139)){const {targetId:_0x5008d4,targetValue:_0x27ac5f}=_0xa79d51[_0x4ea5a3(0x1d9)];this[_0x4ea5a3(0x2c9)][_0x4ea5a3(0x294)]('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0x5008d4+_0x4ea5a3(0x257)+_0x27ac5f),await this[_0x4ea5a3(0x2b0)](_0x4ea5a3(0x10a),{'val':!![],'ack':!![]}),await this[_0x4ea5a3(0x2b0)]('analysis.automation.description',{'val':_0x4ea5a3(0x2aa)+_0x5008d4,'ack':!![]}),await this[_0x4ea5a3(0x2b0)](_0x4ea5a3(0x21c),{'val':_0x5008d4,'ack':!![]}),await this['setStateAsync'](_0x4ea5a3(0x2ef),{'val':_0x27ac5f,'ack':!![]}),this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51['command'],{'success':!![]},_0xa79d51['callback']);}else{if(_0xa79d51[_0x4ea5a3(0x2bb)]===_0x4ea5a3(0x18b)){const {historyId:_0x49502d,rating:_0x508a79,comment:_0x282820,alertReason:_0x34cdbc}=_0xa79d51[_0x4ea5a3(0x1d9)];_0x49502d&&_0x508a79?(await saveFeedback(this,{'timestamp':Date[_0x4ea5a3(0x121)](),'historyId':_0x49502d,'rating':_0x508a79,'comment':_0x282820,'alertReason':_0x34cdbc}),this['sendTo'](_0xa79d51['from'],_0xa79d51['command'],{'success':!![]},_0xa79d51['callback'])):this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':![],'error':_0x4ea5a3(0x16b)},_0xa79d51[_0x4ea5a3(0x11d)]);}else _0xa79d51[_0x4ea5a3(0x2bb)]===_0x4ea5a3(0x190)&&(this[_0x4ea5a3(0x2c9)][_0x4ea5a3(0x294)](_0x4ea5a3(0x109)),await this[_0x4ea5a3(0x2b0)](_0x4ea5a3(0x10a),{'val':![],'ack':!![]}),await this[_0x4ea5a3(0x2b0)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':!![]},_0xa79d51[_0x4ea5a3(0x11d)]));}}}}}}}}}}catch(_0x3a1c5e){this['log'][_0x4ea5a3(0x11e)](_0x4ea5a3(0x177)+_0xa79d51[_0x4ea5a3(0x2bb)]+':\x20'+_0x3a1c5e[_0x4ea5a3(0x1d9)]);if(_0xa79d51[_0x4ea5a3(0x11d)])this[_0x4ea5a3(0x11a)](_0xa79d51[_0x4ea5a3(0x224)],_0xa79d51[_0x4ea5a3(0x2bb)],{'success':![],'error':_0x3a1c5e['message']},_0xa79d51[_0x4ea5a3(0x11d)]);}}}if(require[a0_0x40ebb5(0x2f5)]!==module)module[a0_0x40ebb5(0x1b6)]=_0x303e32=>new CogniLiving(_0x303e32);else new CogniLiving();