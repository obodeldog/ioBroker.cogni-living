const a0_0x14a61c=a0_0x3022;(function(_0x3cecfc,_0x325774){const _0x7928d3=a0_0x3022,_0x382f7d=_0x3cecfc();while(!![]){try{const _0x12be32=-parseInt(_0x7928d3(0x159))/0x1+-parseInt(_0x7928d3(0x14e))/0x2*(-parseInt(_0x7928d3(0x250))/0x3)+parseInt(_0x7928d3(0x233))/0x4*(-parseInt(_0x7928d3(0xf8))/0x5)+-parseInt(_0x7928d3(0x215))/0x6+-parseInt(_0x7928d3(0x252))/0x7*(-parseInt(_0x7928d3(0x259))/0x8)+parseInt(_0x7928d3(0x213))/0x9*(parseInt(_0x7928d3(0x10d))/0xa)+-parseInt(_0x7928d3(0x125))/0xb*(-parseInt(_0x7928d3(0x14d))/0xc);if(_0x12be32===_0x325774)break;else _0x382f7d['push'](_0x382f7d['shift']());}catch(_0x2dbf34){_0x382f7d['push'](_0x382f7d['shift']());}}}(a0_0xfb48,0x7edfa));const a0_0x4cc3f1=(function(){let _0x41e213=!![];return function(_0x4dd1ae,_0xf00046){const _0x50bee2=_0x41e213?function(){const _0x2c0879=a0_0x3022;if(_0xf00046){const _0x4d1b30=_0xf00046[_0x2c0879(0x133)](_0x4dd1ae,arguments);return _0xf00046=null,_0x4d1b30;}}:function(){};return _0x41e213=![],_0x50bee2;};}()),a0_0x314743=a0_0x4cc3f1(this,function(){const _0x3a9dac=a0_0x3022;return a0_0x314743[_0x3a9dac(0x1c0)]()[_0x3a9dac(0x137)](_0x3a9dac(0x228))[_0x3a9dac(0x1c0)]()[_0x3a9dac(0xf3)](a0_0x314743)['search'](_0x3a9dac(0x228));});function a0_0x3022(_0x2e6136,_0x800f9b){const _0x30c39a=a0_0xfb48();return a0_0x3022=function(_0x314743,_0x4cc3f1){_0x314743=_0x314743-0xec;let _0xfb484e=_0x30c39a[_0x314743];return _0xfb484e;},a0_0x3022(_0x2e6136,_0x800f9b);}a0_0x314743();function a0_0xfb48(){const _0x26a5b7=['Guest\x20Mode','./lib/ai_agent','NORMAL','[Integrator]\x20Error:\x20','analysis.topology.structure','Daily\x20Room\x20Details\x20(48x30min)','checkWifiPresence:\x20Error\x20checking\x20','all','2654391YKMZvu','text','203fXiWEb','infrasoundLocked','isPresent','currentSystemMode','system.presenceWho','devices','analysis.ventilation.lastWindow','176096bLUyDC','analysisTimer','open','pop','filter','system.adapter.ical.','add','name','constructor','log','presenceDevices','LTM.dailyDigests','Lernphase\x20(','665QlsBFJ','health','readFileSync','bind','sensorLastValues','val','history','handleInfrasound','callback','Keine\x20Daten','.json','historyJob','getOverviewData','minDaysForBaseline','weatherTempId','analysis.health.todayVector','Live\x20Event\x20Pulse','ack','floor','instance','analysis.health.gaitSpeed','10isJRxR','analysis.energy.warmupSources','roomIntegratorTimer','length','apiKey','moduleHealth','now','sunny','energy','.uptime','PREDICT_ENERGY','sendMorningBriefing','error','values','./lib/dead_man','application/json','calendarCheckTimer','node-schedule','common','path','TRAIN_TOPOLOGY','analysis.automation.targetValue','moduleEnergy','getStateAsync','1319989ZZbzYd','checkCalendarTriggers','temperature','ERROR','round','updateLocation','analysis.security.lastScore','appendToLog','Aktiv\x20(','pulse','telegram','system.adapter.','updated','analysis.trigger','apply','abortExitTimer','pressureBuffer','location','search','getForeignObjectsAsync','subscribeStates','online','warn','triggerEnergyPrediction\x20Error:\x20','toLocaleTimeString','testContext','triggerGaitAnalysis','licenseKey','debug','toLocaleDateString','analysis.activity.roomStats','generateHealthReport','setObjectNotExistsAsync','Scan\x20Error:\x20','geminiModel','updateTopologyMatrix','saveDailyHistory','lastTrackerEventTime','\x20events\x20from\x20today...','abs','48FXOPzz','2cbfVoZ','{\x22history\x22:{}}','Room\x20Dwell\x20Time\x20Stats','namespace','cleanupGhostInterventions','¬∞C\x20(Innen:\x20','No\x20data','dependencyInstallInProgress','triggerHealth\x20error:\x20','response','üîä\x20Infraschall:\x20','133959BibmdH','No\x20topology\x20data\x20found','python','analysis.automation.patternDetected','system.adapter.ical.È¶ô','analysis.activity.roomHistory','json','üìù\x20Manual\x20event\x20logged:\x20','toLowerCase','üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','writeFileSync','analyzeWindowOpening\x20error:\x20','enum.functions.*','.venv','scanDevices','ANALYZE_GAIT','dailyDigests','healthTrendInterval','pythonBridge\x20command\x20failed:\x20','checkWifiPresence','shift','Init...','some','custom','analysis.prediction.trackerTopRoom','Kein\x20API\x20Key\x20√ºbergeben.','useCalendar','Verbindung\x20erfolgreich:\x20','config','modules','state','exports','setHours','toFixed','infrasoundEnabled','substring','scanThermostats','sendNotification','Unbekannt','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','manual','infrasoundArmingId','bootTime','forEach','analysis.training.status','de-DE','Gemini\x20Report\x20Night','analysis.safety.infrasoundAlert','Unknown','calendarName','infrasoundSensorId','triggerGaitAnalysis\x20parse\x20error:\x20','getHours','onUnload','message','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','VACATION','comfort','TRAIN_HEALTH','.isOnline','onMessage','LTM.baselineStatus','setStateAsync','setPresence','daswetter.0','loadSystemMode','rows','isRelevantActivity','moduleSecurity','mkdirSync','[PythonBridge]\x20Forwarding\x20command:\x20','startService','analysis.health.geminiDay','getEnums','analysis.visualization.pulse','push','door','initHistory','\x20Tage)','@google/generative-ai','string','value','.system.mode','enum.rooms.*','keys','fill','systemConfig','heiter','DAY','parse','‚úÖ\x20History\x20saved:\x20','startSystem','getCalendarNames','system','Warte\x20auf\x20Analyse...','send','security','getDate','analyzeWindowOpening','timestamp','inactivityThresholdHours','./lib/scheduler','toString','refreshCalendar','isArray','üï∏Ô∏è\x20Topology\x20Matrix\x20manually\x20updated\x20by\x20user.','Niemand','memoryCache','createAllObjects','find','integrateRoomTime','outdoorSensorId','analysis.energy.warmupTargets','isProVersion','triggerBriefing','...','initZombies','type','\x20(Threshold)','refreshCalendar\x20failed:\x20','info','existsSync','stringify','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','pythonBridge','L√ºften\x20empfohlen','Gemini\x20Report\x20Day','LTM.rawEventLog','\x20Kalender-Adapter\x20gefunden.','@iobroker/adapter-core','slice','executeAutomationAction','sendTo','moduleComfort','stateChange','History\x20Save\x20Error:\x20','eventHistory','NextHours.Location_1.Day_1.current.symbol_desc','object','onStateChange','includes','2-digit','exitTimer','klar','¬∞C,\x20Au√üen:\x20','subscribeForeignStates','NIGHT','sources','./lib/setup','analysis.security.learningStatus','cogni-living','Gemini\x20Init\x20Error:\x20','models/gemini-flash-latest','geminiApiKey','join','Daily\x20Activity\x20Vector\x20(48x30min)','analysis.automation.description','analysis.training.triggerEnergy','Manual\x20Event','LTM.trainingData.sequences','genAI','ready','analysis.training.triggerComfort','communicate.request','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','Adapter','lastAlertState','./lib/python_bridge','infrasoundThreshold','Invalid\x20matrix\x20data','59\x2023\x20*\x20*\x20*','runPythonHealthCheck','analysis.health.todayRoomDetails','rawEventLog','checkThermostats','\x20sequences','TRAIN_COMFORT','analysis.training.triggerHealth','toISOString','triggerEnergyPrediction','split','min','window','setState','cogni-living\x20adapter\x20starting\x20(v','126603hlGYqi','LTM.triggerDailyDigest','4031052YSsOXW','Warm-Up\x20Time','\x20>\x20','todayVector','endsWith','motion','SYSTEM_MODES','number','updateHealthVector','./lib/automation','onReady','triggerGaitAnalysis\x20error:\x20','analysis.energy.warmupTimes','presenceCheckTimer','./lib/recorder',':\x20Temp-Differenz\x20','./lib/scanner','analysis.health.activityTrend','terrasse','(((.+)+)+)+$','haust√ºr','checkLicense','max','unshift','getAbsoluteDefaultDataDir','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','replayTodayEvents','ltmJob','protectAiMemory','getMinutes','20804TUPhwN','events.history','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','reduce','subscribeForeignStatesAsync','getHistoryData','date','getGenerativeModel','checkSolarCondition','enum','getForeignStateAsync','cancel','analysis.prediction.trackerConfidence','TRAIN_SECURITY','updateTopology','from','initSystemConfig','updateSchedulePreview','command','analysisHistory','activeModules'];a0_0xfb48=function(){return _0x26a5b7;};return a0_0xfb48();}'use strict';const utils=require(a0_0x14a61c(0x1db)),{GoogleGenerativeAI}=require(a0_0x14a61c(0x1a9)),path=require(a0_0x14a61c(0x120)),fs=require('fs'),installer=require('./lib/installer'),scanner=require(a0_0x14a61c(0x225)),schedulers=require(a0_0x14a61c(0x1bf)),topology=require('./lib/topology'),setup=require(a0_0x14a61c(0x1ee)),recorder=require(a0_0x14a61c(0x223)),pythonBridge=require(a0_0x14a61c(0x201)),aiAgent=require(a0_0x14a61c(0x249)),deadMan=require(a0_0x14a61c(0x11b)),automation=require(a0_0x14a61c(0x21e)),GEMINI_MODEL=a0_0x14a61c(0x1f2);class CogniLiving extends utils[a0_0x14a61c(0x1ff)]{constructor(_0x5ee571){const _0x1a3dff=a0_0x14a61c;super({..._0x5ee571,'name':'cogni-living'}),this[_0x1a3dff(0x1e2)]=[],this[_0x1a3dff(0x246)]=[],this['rawEventLog']=[],this[_0x1a3dff(0x16a)]=[],this[_0x1a3dff(0xfc)]={},this[_0x1a3dff(0x1b0)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x1a3dff(0x1e8)]=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this[_0x1a3dff(0x1fa)]=null,this[_0x1a3dff(0x147)]=null,this[_0x1a3dff(0x255)]=setup[_0x1a3dff(0x21b)][_0x1a3dff(0x24a)],this[_0x1a3dff(0x1cb)]=![],this[_0x1a3dff(0x200)]=![],this[_0x1a3dff(0xec)]=null,this[_0x1a3dff(0x11d)]=null,this[_0x1a3dff(0x222)]=null,this[_0x1a3dff(0x230)]=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this['briefingJob']=null,this[_0x1a3dff(0x103)]=null,this['trackerHeartbeat']=null,this[_0x1a3dff(0x16b)]=null,this['roomIntegratorTimer']=null,this[_0x1a3dff(0x155)]=![],this[_0x1a3dff(0x14a)]=Date[_0x1a3dff(0x113)](),this[_0x1a3dff(0x1c5)]=null,this[_0x1a3dff(0x184)]=Date[_0x1a3dff(0x113)](),this['infrasoundLocked']=![],this['pressureBuffer']=[],this['activeModules']={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x1a3dff(0x1fb),this[_0x1a3dff(0x21f)][_0x1a3dff(0xfb)](this)),this['on'](_0x1a3dff(0x1e0),this[_0x1a3dff(0x1e5)][_0x1a3dff(0xfb)](this)),this['on']('unload',this[_0x1a3dff(0x18f)][_0x1a3dff(0xfb)](this)),this['on'](_0x1a3dff(0x190),this['onMessage'][_0x1a3dff(0xfb)](this));}async[a0_0x14a61c(0x21f)](){const _0x4b5d33=a0_0x14a61c;this[_0x4b5d33(0xf4)]['info'](_0x4b5d33(0x212)+this['version']+_0x4b5d33(0x163));if(this[_0x4b5d33(0x176)][_0x4b5d33(0x112)]!==undefined)this[_0x4b5d33(0x247)][_0x4b5d33(0xf9)]=this['config']['moduleHealth'];if(this[_0x4b5d33(0x176)][_0x4b5d33(0x19e)]!==undefined)this[_0x4b5d33(0x247)][_0x4b5d33(0x1ba)]=this[_0x4b5d33(0x176)]['moduleSecurity'];if(this['config'][_0x4b5d33(0x123)]!==undefined)this[_0x4b5d33(0x247)]['energy']=this[_0x4b5d33(0x176)][_0x4b5d33(0x123)];if(this[_0x4b5d33(0x176)][_0x4b5d33(0x1df)]!==undefined)this[_0x4b5d33(0x247)][_0x4b5d33(0x193)]=this[_0x4b5d33(0x176)][_0x4b5d33(0x1df)];if(this[_0x4b5d33(0x176)][_0x4b5d33(0x177)])this['activeModules']={...this[_0x4b5d33(0x247)],...this[_0x4b5d33(0x176)][_0x4b5d33(0x177)]};this[_0x4b5d33(0x1b5)]();}async[a0_0x14a61c(0x1b5)](){const _0x224846=a0_0x14a61c;await setup[_0x224846(0x1ce)](this);try{this[_0x224846(0x1cb)]=await setup[_0x224846(0x22a)](this['config'][_0x224846(0x140)]);}catch(_0x368dbd){}if(!this['config']['inactivityThresholdHours']||this[_0x224846(0x176)][_0x224846(0x1be)]<0.1)this[_0x224846(0x176)][_0x224846(0x1be)]=0xc;await setup[_0x224846(0x1a7)](this),await setup[_0x224846(0x243)](this),topology['updateTopology'](this);try{const _0x205ffc=await this[_0x224846(0x124)](_0x224846(0x221)),_0x36b3e2=await this[_0x224846(0x124)](_0x224846(0x10e));_0x205ffc&&_0x205ffc[_0x224846(0xfd)]&&_0x36b3e2&&_0x36b3e2[_0x224846(0xfd)]&&(Date[_0x224846(0x113)]()-_0x205ffc['ts']<0x4*0xe10*0x3e8&&(this[_0x224846(0x1c5)]={'times':JSON[_0x224846(0x1b3)](_0x205ffc[_0x224846(0xfd)]),'sources':JSON[_0x224846(0x1b3)](_0x36b3e2['val'])}));}catch(_0x23ce39){}if(this[_0x224846(0x176)][_0x224846(0x1f3)])try{this[_0x224846(0x1fa)]=new GoogleGenerativeAI(this[_0x224846(0x176)][_0x224846(0x1f3)]),this[_0x224846(0x147)]=this[_0x224846(0x1fa)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x224846(0x11c)}});}catch(_0x4e3cc3){this[_0x224846(0xf4)][_0x224846(0x119)](_0x224846(0x1f1)+_0x4e3cc3[_0x224846(0x190)]);}await setup[_0x224846(0x1c6)](this),await this[_0x224846(0x19b)](),schedulers['initSchedules'](this),await this[_0x224846(0x145)](_0x224846(0x1a4),{'type':_0x224846(0x178),'common':{'name':_0x224846(0x108),'type':_0x224846(0x21c),'role':'value','read':!![],'write':![]},'native':{}}),await this[_0x224846(0x145)](_0x224846(0x143),{'type':_0x224846(0x178),'common':{'name':_0x224846(0x150),'type':'string','role':'json','read':!![],'write':![],'def':_0x224846(0x235)},'native':{}}),await this['setObjectNotExistsAsync'](_0x224846(0x15e),{'type':'state','common':{'name':'Room\x20History\x20(24h\x20Buckets)','type':_0x224846(0x1aa),'role':_0x224846(0x15f),'read':!![],'write':![],'def':_0x224846(0x14f)},'native':{}}),await this['setObjectNotExistsAsync']('analysis.health.geminiNight',{'type':_0x224846(0x178),'common':{'name':_0x224846(0x188),'type':_0x224846(0x1aa),'role':_0x224846(0x251),'read':!![],'write':![],'def':_0x224846(0x1b8)},'native':{}}),await this[_0x224846(0x145)](_0x224846(0x1a2),{'type':_0x224846(0x178),'common':{'name':_0x224846(0x1d8),'type':_0x224846(0x1aa),'role':_0x224846(0x251),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this['setObjectNotExistsAsync'](_0x224846(0x107),{'type':_0x224846(0x178),'common':{'name':_0x224846(0x1f5),'type':_0x224846(0x1aa),'role':_0x224846(0x15f),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x224846(0x145)](_0x224846(0x206),{'type':'state','common':{'name':_0x224846(0x24d),'type':_0x224846(0x1aa),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x224846(0x145)](_0x224846(0x226),{'type':_0x224846(0x178),'common':{'name':'General\x20Activity\x20Trend','type':_0x224846(0x21c),'role':_0x224846(0x1ab),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x224846(0x145)](_0x224846(0x221),{'type':_0x224846(0x178),'common':{'name':_0x224846(0x216),'type':_0x224846(0x1aa),'role':_0x224846(0x15f),'read':!![],'write':![]},'native':{}});try{const _0x11daf7=await this['getStateAsync'](_0x224846(0x234));if(_0x11daf7&&_0x11daf7[_0x224846(0xfd)]){this[_0x224846(0x1e2)]=JSON[_0x224846(0x1b3)](_0x11daf7[_0x224846(0xfd)]);if(this['isProVersion']){const _0x5c2550=await this[_0x224846(0x124)](_0x224846(0x1d9));if(_0x5c2550&&_0x5c2550['val'])this['rawEventLog']=JSON[_0x224846(0x1b3)](_0x5c2550[_0x224846(0xfd)]);}this[_0x224846(0xf4)]['info']('üì¶\x20Restored\x20'+this[_0x224846(0x1e2)][_0x224846(0x110)]+'\x20events\x20from\x20standard\x20storage.');}}catch(_0x47ac3b){this[_0x224846(0x1e2)]=[];}try{const _0x1a4223=await this['getStateAsync']('LTM.dailyDigests');if(_0x1a4223&&_0x1a4223['val'])this['dailyDigests']=JSON[_0x224846(0x1b3)](_0x1a4223[_0x224846(0xfd)]);}catch(_0x5a0d3c){this[_0x224846(0x16a)]=[];}const _0x14616d=this['dailyDigests']['length']>=(this[_0x224846(0x176)][_0x224846(0x105)]||0x7)?_0x224846(0x12d)+this[_0x224846(0x16a)][_0x224846(0x110)]+_0x224846(0x1a8):_0x224846(0xf7)+this[_0x224846(0x16a)][_0x224846(0x110)]+'/'+(this['config'][_0x224846(0x105)]||0x7)+')';await this[_0x224846(0x198)](_0x224846(0x197),{'val':_0x14616d,'ack':!![]}),this['subscribeStates'](_0x224846(0x132)),this[_0x224846(0x139)](_0x224846(0x214)),this['subscribeStates'](_0x224846(0x20b));this[_0x224846(0x176)]['infrasoundEnabled']&&this[_0x224846(0x176)][_0x224846(0x18c)]&&this[_0x224846(0x247)]['security']&&this[_0x224846(0x1eb)](this['config'][_0x224846(0x18c)]);const _0x446e28=this['config']['devices'];if(_0x446e28)for(const _0x161189 of _0x446e28){await this[_0x224846(0x237)](_0x161189['id']);}const _0x580142=this[_0x224846(0x176)][_0x224846(0xf5)];if(_0x580142)for(const _0x3c8338 of _0x580142){await this['subscribeForeignStatesAsync'](_0x3c8338);}const _0x26032b=require(_0x224846(0x11e));if(this[_0x224846(0x103)])this['historyJob']['cancel']();this[_0x224846(0x103)]=_0x26032b['scheduleJob'](_0x224846(0x204),()=>{const _0x122aad=_0x224846;this[_0x122aad(0x149)]();}),setTimeout(()=>this[_0x224846(0x22f)](),0x1388);if(this[_0x224846(0x10f)])clearInterval(this[_0x224846(0x10f)]);this[_0x224846(0x1c8)](),this[_0x224846(0x10f)]=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this['healthTrendInterval'])clearInterval(this[_0x224846(0x16b)]);this[_0x224846(0x16b)]=setInterval(()=>{const _0x1a9326=_0x224846;this[_0x1a9326(0x1cb)]&&this[_0x1a9326(0x247)][_0x1a9326(0xf9)]&&this[_0x1a9326(0x205)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x224846(0xec)])clearInterval(this[_0x224846(0xec)]);this[_0x224846(0x247)]['energy']&&(this['analysisTimer']=setInterval(()=>{this['triggerEnergyPrediction']();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x224846(0x20d)](),0x2710));if(this[_0x224846(0x11d)])clearInterval(this[_0x224846(0x11d)]);this[_0x224846(0x176)][_0x224846(0x174)]&&this[_0x224846(0x247)][_0x224846(0x115)]&&(this['calendarCheckTimer']=setInterval(()=>{const _0x2b4802=_0x224846;automation[_0x2b4802(0x126)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x224846(0x126)](this),0x3a98));if(this[_0x224846(0x222)])clearInterval(this[_0x224846(0x222)]);this[_0x224846(0x176)][_0x224846(0xf5)]&&this[_0x224846(0x176)][_0x224846(0xf5)][_0x224846(0x110)]>0x0&&(this[_0x224846(0x222)]=setInterval(async()=>{const _0x57d8ab=_0x224846;await this[_0x57d8ab(0x16d)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0x224846(0x16d)](),0x1388));const _0x2bbfb0=path['join'](__dirname,_0x224846(0x167),'bin',_0x224846(0x15b));pythonBridge[_0x224846(0x1a1)](this,_0x2bbfb0);}[a0_0x14a61c(0x18f)](_0x23f555){const _0x2b9a70=a0_0x14a61c;if(this[_0x2b9a70(0x103)])this['historyJob'][_0x2b9a70(0x23e)]();this[_0x2b9a70(0x149)]()['then'](()=>{const _0x400ab9=_0x2b9a70;if(this[_0x400ab9(0xec)])clearInterval(this[_0x400ab9(0xec)]);if(this[_0x400ab9(0x11d)])clearInterval(this['calendarCheckTimer']);if(this[_0x400ab9(0x222)])clearInterval(this[_0x400ab9(0x222)]);if(this[_0x400ab9(0x10f)])clearInterval(this[_0x400ab9(0x10f)]);recorder[_0x400ab9(0x134)](this),pythonBridge['stopService'](this),_0x23f555();});}async[a0_0x14a61c(0x22f)](){const _0x279dbd=a0_0x14a61c;if(!this[_0x279dbd(0x1e2)]||this[_0x279dbd(0x1e2)]['length']===0x0){this['log']['warn'](_0x279dbd(0x191));return;}this[_0x279dbd(0xf4)][_0x279dbd(0x1d2)]('‚Ü∫\x20Replaying\x20'+this['eventHistory']['length']+_0x279dbd(0x14b));const _0x543074=new Date()[_0x279dbd(0x17a)](0x0,0x0,0x0,0x0),_0x344205='analysis.activity.roomHistory';let _0x1bb67b={'history':{},'date':new Date()[_0x279dbd(0x142)]()};const _0x1a67db='analysis.health.todayVector',_0x9c6243=_0x279dbd(0x206);let _0x12344a=new Array(0x30)['fill'](0x0),_0x3c6f85=Array[_0x279dbd(0x242)]({'length':0x30},()=>[]);this[_0x279dbd(0x1e2)][_0x279dbd(0x185)](_0x43227b=>{const _0x5f564d=_0x279dbd;if(_0x43227b[_0x5f564d(0x1bd)]>=_0x543074){if(recorder[_0x5f564d(0x19d)](_0x43227b[_0x5f564d(0x1cf)],_0x43227b[_0x5f564d(0x1ab)])){const _0x4fc33e=new Date(_0x43227b[_0x5f564d(0x1bd)]),_0x249523=_0x4fc33e[_0x5f564d(0x18e)]()*0x2+(_0x4fc33e['getMinutes']()>=0x1e?0x1:0x0);if(_0x249523<0x30){_0x12344a[_0x249523]++;const _0x5d7ce9=_0x43227b[_0x5f564d(0x136)]||_0x43227b[_0x5f564d(0xf2)]||'?';let _0x4cac7b=_0x3c6f85[_0x249523];!_0x4cac7b[_0x5f564d(0x1e6)](_0x5d7ce9)&&_0x4cac7b[_0x5f564d(0x1a5)](_0x5d7ce9);}const _0x2c8bc3=_0x4fc33e[_0x5f564d(0x18e)]();let _0x271542=_0x43227b['location']||_0x5f564d(0x18a);const _0x4b6c2e=(this[_0x5f564d(0x176)]['devices']||[])[_0x5f564d(0x1c7)](_0x47034a=>_0x47034a['location']===_0x271542);if(_0x4b6c2e)_0x271542=_0x4b6c2e['location'];if(!_0x1bb67b['history'][_0x271542])_0x1bb67b['history'][_0x271542]=new Array(0x18)[_0x5f564d(0x1af)](0x0);if(_0x1bb67b[_0x5f564d(0xfe)][_0x271542][_0x2c8bc3]<0x3c)_0x1bb67b[_0x5f564d(0xfe)][_0x271542][_0x2c8bc3]++;}}});const _0x1a07ae=await this['getStateAsync'](_0x344205);(!_0x1a07ae||!_0x1a07ae[_0x279dbd(0xfd)]||_0x1a07ae[_0x279dbd(0xfd)]==='{}'||_0x1a07ae['val'][_0x279dbd(0x1e6)]('\x22history\x22:{}'))&&await this[_0x279dbd(0x198)](_0x344205,{'val':JSON[_0x279dbd(0x1d4)](_0x1bb67b),'ack':!![]}),await this[_0x279dbd(0x198)](_0x1a67db,{'val':JSON[_0x279dbd(0x1d4)](_0x12344a),'ack':!![]}),await this['setStateAsync'](_0x9c6243,{'val':JSON[_0x279dbd(0x1d4)](_0x3c6f85),'ack':!![]}),this[_0x279dbd(0xf4)]['info'](_0x279dbd(0x1d5));}async['saveDailyHistory'](){const _0xd82f96=a0_0x14a61c;if(!this[_0xd82f96(0x247)][_0xd82f96(0xf9)])return;const _0x437566=new Date()[_0xd82f96(0x20c)]()[_0xd82f96(0x20e)]('T')[0x0];this[_0xd82f96(0xf4)][_0xd82f96(0x141)]('üíæ\x20Saving\x20Daily\x20History\x20for\x20'+_0x437566+_0xd82f96(0x1cd));try{const [_0x4d5649,_0x595b88,_0xfe99d6,_0x3bd9b2,_0x59ff73,_0x5b9f5a,_0x38bfae]=await Promise[_0xd82f96(0x24f)]([this[_0xd82f96(0x124)](_0xd82f96(0x15e)),this[_0xd82f96(0x124)]('analysis.health.geminiNight'),this[_0xd82f96(0x124)](_0xd82f96(0x1a2)),this['getStateAsync'](_0xd82f96(0x12b)),this['getStateAsync'](_0xd82f96(0x107)),this['getStateAsync'](_0xd82f96(0x226)),this[_0xd82f96(0x124)](_0xd82f96(0x10c))]),_0x135de4=new Date()[_0xd82f96(0x17a)](0x0,0x0,0x0,0x0),_0x65e1f4=this[_0xd82f96(0x1e2)][_0xd82f96(0xef)](_0x387853=>_0x387853[_0xd82f96(0x1bd)]>=_0x135de4&&(_0x387853[_0xd82f96(0xf2)]['toLowerCase']()['includes'](_0xd82f96(0x229))||_0x387853[_0xd82f96(0xf2)][_0xd82f96(0x161)]()['includes'](_0xd82f96(0x227)))&&(_0x387853[_0xd82f96(0x1ab)]===!![]||_0x387853[_0xd82f96(0x1ab)]===_0xd82f96(0xed)))['length'];let _0x4fe247=0x55;if(_0x5b9f5a&&_0x5b9f5a['val']!==undefined)_0x4fe247=Math[_0xd82f96(0x20f)](0x64,Math['max'](0x14,Math[_0xd82f96(0x129)](0x50+Number(_0x5b9f5a[_0xd82f96(0xfd)])*0x5)));const _0xda1c67=this[_0xd82f96(0x1e2)][_0xd82f96(0xef)](_0x25b733=>_0x25b733[_0xd82f96(0x1bd)]>=_0x135de4),_0x549cad={'date':_0x437566,'timestamp':Date[_0xd82f96(0x113)](),'roomHistory':_0x4d5649?.[_0xd82f96(0xfd)]?JSON[_0xd82f96(0x1b3)](_0x4d5649[_0xd82f96(0xfd)]):{},'geminiNight':_0x595b88?.[_0xd82f96(0xfd)]||_0xd82f96(0x101),'geminiDay':_0xfe99d6?.[_0xd82f96(0xfd)]||_0xd82f96(0x101),'anomalyScore':_0x3bd9b2?.[_0xd82f96(0xfd)]||0.1,'todayVector':_0x59ff73?.[_0xd82f96(0xfd)]?JSON[_0xd82f96(0x1b3)](_0x59ff73[_0xd82f96(0xfd)]):new Array(0x30)[_0xd82f96(0x1af)](0x0),'batteryLevel':_0x4fe247,'freshAirCount':_0x65e1f4,'gaitSpeed':_0x38bfae?.['val']!==undefined&&_0x38bfae?.['val']!==null?Number(_0x38bfae['val']):null,'eventHistory':_0xda1c67},_0x48d8dd=utils[_0xd82f96(0x22d)](),_0x5ed904=path[_0xd82f96(0x1f4)](_0x48d8dd,'cogni-living',_0xd82f96(0xfe));if(!fs['existsSync'](_0x5ed904))fs[_0xd82f96(0x19f)](_0x5ed904,{'recursive':!![]});const _0x2c9cb7=path[_0xd82f96(0x1f4)](_0x5ed904,_0x437566+'.json');fs[_0xd82f96(0x164)](_0x2c9cb7,JSON[_0xd82f96(0x1d4)](_0x549cad)),this[_0xd82f96(0xf4)][_0xd82f96(0x1d2)](_0xd82f96(0x1b4)+_0x2c9cb7);}catch(_0x5ef9ec){this[_0xd82f96(0xf4)][_0xd82f96(0x119)](_0xd82f96(0x1e1)+_0x5ef9ec[_0xd82f96(0x190)]);}}async[a0_0x14a61c(0x1c8)](){const _0x316dd3=a0_0x14a61c;if(!this[_0x316dd3(0x254)])return;try{let _0xd07259=null;try{const _0x19bd93=await this[_0x316dd3(0x124)](_0x316dd3(0x172)),_0x52c3fb=await this['getStateAsync'](_0x316dd3(0x23f));if(_0x19bd93&&_0x19bd93[_0x316dd3(0xfd)]&&_0x52c3fb&&_0x52c3fb[_0x316dd3(0xfd)]&&_0x52c3fb[_0x316dd3(0xfd)]>0.3){if(_0x19bd93[_0x316dd3(0xfd)]!==_0x316dd3(0x18a)&&_0x19bd93['val']!==_0x316dd3(0x16f))_0xd07259=_0x19bd93[_0x316dd3(0xfd)];}}catch(_0x2065a7){}if(!_0xd07259){const _0x4bdace=this['config'][_0x316dd3(0x257)]||[];for(const _0x8c6031 of _0x4bdace){if(_0x8c6031[_0x316dd3(0x1cf)]===_0x316dd3(0x21a)&&_0x8c6031['location'])try{const _0x4eeb34=await this[_0x316dd3(0x23d)](_0x8c6031['id']);if(_0x4eeb34&&(_0x4eeb34[_0x316dd3(0xfd)]===!![]||_0x4eeb34[_0x316dd3(0xfd)]==='on'||_0x4eeb34[_0x316dd3(0xfd)]===0x1)){_0xd07259=_0x8c6031[_0x316dd3(0x136)];break;}}catch(_0xd48b65){}}}if(!_0xd07259)return;const _0x34984c=this[_0x316dd3(0x176)][_0x316dd3(0x257)]||[];let _0x5bbd0b=_0xd07259;const _0xdc5f1c=_0x34984c[_0x316dd3(0x1c7)](_0x2d735c=>_0x2d735c[_0x316dd3(0x136)]&&_0x2d735c['location']['toLowerCase']()===_0xd07259[_0x316dd3(0x161)]());if(_0xdc5f1c)_0x5bbd0b=_0xdc5f1c[_0x316dd3(0x136)];const _0x17eba9=_0x316dd3(0x15e),_0xab5573=await this[_0x316dd3(0x124)](_0x17eba9),_0x111a8d=new Date()[_0x316dd3(0x142)]();let _0x62d232={'history':{},'date':_0x111a8d};if(_0xab5573&&_0xab5573[_0x316dd3(0xfd)])try{_0x62d232=JSON[_0x316dd3(0x1b3)](_0xab5573[_0x316dd3(0xfd)]);}catch(_0x202e5f){}_0x62d232[_0x316dd3(0x239)]!==_0x111a8d&&(_0x62d232[_0x316dd3(0xfe)]={},_0x62d232[_0x316dd3(0x239)]=_0x111a8d);if(!_0x62d232[_0x316dd3(0xfe)][_0x5bbd0b])_0x62d232[_0x316dd3(0xfe)][_0x5bbd0b]=new Array(0x18)[_0x316dd3(0x1af)](0x0);const _0x1e56c5=new Date()[_0x316dd3(0x18e)]();if(_0x62d232[_0x316dd3(0xfe)][_0x5bbd0b][_0x1e56c5]<0x3c)_0x62d232['history'][_0x5bbd0b][_0x1e56c5]++;await this[_0x316dd3(0x198)](_0x17eba9,{'val':JSON['stringify'](_0x62d232),'ack':!![]});}catch(_0x344ae4){this[_0x316dd3(0xf4)][_0x316dd3(0x13b)](_0x316dd3(0x24b)+_0x344ae4[_0x316dd3(0x190)]);}}async[a0_0x14a61c(0x196)](_0x14f1d4){const _0x16173f=a0_0x14a61c;if(typeof _0x14f1d4===_0x16173f(0x1e4)&&_0x14f1d4[_0x16173f(0x190)]){if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x238)){const _0x5c2acf=_0x14f1d4[_0x16173f(0x190)][_0x16173f(0x239)],_0x366974=utils[_0x16173f(0x22d)](),_0x3d6dd0=path['join'](_0x366974,_0x16173f(0x1f0),_0x16173f(0xfe),_0x5c2acf+'.json');if(fs[_0x16173f(0x1d3)](_0x3d6dd0))try{const _0x1d6388=JSON[_0x16173f(0x1b3)](fs['readFileSync'](_0x3d6dd0,'utf8'));this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4['command'],{'success':!![],'data':_0x1d6388},_0x14f1d4[_0x16173f(0x100)]);}catch(_0x34c975){this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4['command'],{'success':![],'error':'Corrupt'},_0x14f1d4[_0x16173f(0x100)]);}else this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':![],'error':_0x16173f(0x154)},_0x14f1d4['callback']);}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x104)){const _0x209676=this[_0x16173f(0x16a)][_0x16173f(0x110)];let _0x5021d3=new Array(0x30)[_0x16173f(0x1af)](0x0),_0x1f0520=Array[_0x16173f(0x242)]({'length':0x30},()=>[]);try{const _0x1bb5da=await this['getStateAsync'](_0x16173f(0x107));if(_0x1bb5da&&_0x1bb5da[_0x16173f(0xfd)])_0x5021d3=JSON[_0x16173f(0x1b3)](_0x1bb5da['val']);const _0x54120f=await this[_0x16173f(0x124)](_0x16173f(0x206));if(_0x54120f&&_0x54120f['val'])_0x1f0520=JSON[_0x16173f(0x1b3)](_0x54120f['val']);}catch(_0x45b35a){}let _0x16a67d=new Array(0x30)[_0x16173f(0x1af)](0x0);try{const _0x5eee90=new Date();_0x5eee90['setDate'](_0x5eee90[_0x16173f(0x1bb)]()-0x1);const _0x6a3fc7=_0x5eee90[_0x16173f(0x20c)]()[_0x16173f(0x20e)]('T')[0x0],_0x1b738a=utils[_0x16173f(0x22d)](),_0x23296d=path['join'](_0x1b738a,_0x16173f(0x1f0),_0x16173f(0xfe),_0x6a3fc7+_0x16173f(0x102));if(fs[_0x16173f(0x1d3)](_0x23296d)){const _0x4d1983=JSON[_0x16173f(0x1b3)](fs[_0x16173f(0xfa)](_0x23296d,'utf8'));if(_0x4d1983&&_0x4d1983['todayVector'])_0x16a67d=_0x4d1983[_0x16173f(0x218)];}}catch(_0x36ebe8){}let _0x2fe391={'today':{},'yesterday':{}};try{const _0x1bb82a=await this[_0x16173f(0x124)](_0x16173f(0x143));if(_0x1bb82a&&_0x1bb82a[_0x16173f(0xfd)])_0x2fe391=JSON['parse'](_0x1bb82a[_0x16173f(0xfd)]);}catch(_0x2f49c2){}let _0xeb58b6=null;try{const _0x14aa97=await this['getStateAsync'](_0x16173f(0x226));if(_0x14aa97)_0xeb58b6=_0x14aa97[_0x16173f(0xfd)];}catch(_0x38d7fa){}if(_0xeb58b6===undefined||_0xeb58b6===null){const _0x32db50=_0x5021d3[_0x16173f(0x236)]((_0x31b31a,_0x2b4c10)=>_0x31b31a+_0x2b4c10,0x0),_0x47e256=Math[_0x16173f(0x20f)](0x2,Math[_0x16173f(0x22b)](-0x2,(0x64-_0x32db50)/0x32));_0xeb58b6=_0x47e256;}let _0x243001=![],_0x5d3570='',_0x43ac19='',_0x15f925='';try{const _0x49fe8d=await this['getStateAsync'](_0x16173f(0x15c));if(_0x49fe8d&&_0x49fe8d[_0x16173f(0xfd)]){_0x243001=!![];const _0x31b32b=await this[_0x16173f(0x124)](_0x16173f(0x1f6));_0x5d3570=_0x31b32b?_0x31b32b[_0x16173f(0xfd)]:'';const _0x49cc3a=await this[_0x16173f(0x124)]('analysis.automation.targetId');_0x43ac19=_0x49cc3a?_0x49cc3a[_0x16173f(0xfd)]:'';const _0x45bdb1=await this[_0x16173f(0x124)](_0x16173f(0x122));_0x15f925=_0x45bdb1?_0x45bdb1[_0x16173f(0xfd)]:'';}}catch(_0x46fea9){}const _0x49d802=await this['checkSolarCondition'](),_0x29f541=(this['config'][_0x16173f(0x257)]||[])[_0x16173f(0x170)](_0x57a24e=>_0x57a24e['isSolar']),_0x3250f5=_0x49d802&&_0x29f541;let _0x4d68c8='';try{const _0x2ea6ea=await this['getStateAsync'](_0x16173f(0x256));if(_0x2ea6ea&&_0x2ea6ea[_0x16173f(0xfd)])_0x4d68c8=_0x2ea6ea[_0x16173f(0xfd)];}catch(_0x5630cb){}this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':!![],'eventHistory':this[_0x16173f(0x1e2)][_0x16173f(0x1dc)](0x0,0x7d0),'stats':{'digestCount':_0x209676,'isPresent':this['isPresent'],'hourlyActivity':_0x5021d3,'hourlyDetails':_0x1f0520,'yesterdayActivity':_0x16a67d,'solarActive':_0x3250f5,'presenceWho':_0x4d68c8,'roomStats':_0x2fe391,'activityTrend':_0xeb58b6,'modules':this[_0x16173f(0x247)]},'automation':{'detected':_0x243001,'description':_0x5d3570,'targetId':_0x43ac19,'targetValue':_0x15f925}},_0x14f1d4['callback']);}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x208))try{const _0x1ffd14=await automation[_0x16173f(0x17e)](this);this['sendTo'](_0x14f1d4['from'],_0x14f1d4[_0x16173f(0x245)],{'success':!![],'results':_0x1ffd14},_0x14f1d4[_0x16173f(0x100)]);}catch(_0x4fc321){this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':![],'error':_0x4fc321['message']},_0x14f1d4[_0x16173f(0x100)]);}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x168))try{const _0x1e8f76=await scanner['scanForDevices'](this,_0x14f1d4[_0x16173f(0x190)]||{});this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':!![],'devices':_0x1e8f76},_0x14f1d4['callback']);}catch(_0x1cb778){}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x1a3)){const _0x13ca95=await this[_0x16173f(0x138)](_0x16173f(0x166),_0x16173f(0x23c)),_0xddc67=[];if(_0x13ca95)for(const _0x224a4f in _0x13ca95){let _0x40d8ca=_0x13ca95[_0x224a4f][_0x16173f(0x11f)][_0x16173f(0xf2)];if(_0x40d8ca&&typeof _0x40d8ca===_0x16173f(0x1e4))_0x40d8ca=_0x40d8ca['de']||_0x40d8ca['en']||Object[_0x16173f(0x11a)](_0x40d8ca)[0x0]||JSON[_0x16173f(0x1d4)](_0x40d8ca);_0xddc67[_0x16173f(0x1a5)]({'id':_0x224a4f,'name':String(_0x40d8ca||_0x224a4f)});}const _0x51576f=await this[_0x16173f(0x138)](_0x16173f(0x1ad),'enum'),_0x26b9e7=[];if(_0x51576f)for(const _0x1edd40 in _0x51576f){let _0x409d93=_0x51576f[_0x1edd40][_0x16173f(0x11f)][_0x16173f(0xf2)];if(_0x409d93&&typeof _0x409d93==='object')_0x409d93=_0x409d93['de']||_0x409d93['en']||Object['values'](_0x409d93)[0x0]||JSON[_0x16173f(0x1d4)](_0x409d93);_0x26b9e7['push'](String(_0x409d93||_0x1edd40[_0x16173f(0x20e)]('.')[_0x16173f(0xee)]()));}this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':!![],'enums':_0xddc67,'rooms':_0x26b9e7},_0x14f1d4[_0x16173f(0x100)]);}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x1b6))try{const _0x261205=await this['getObjectViewAsync'](_0x16173f(0x1b7),_0x16173f(0x10b),{'startkey':_0x16173f(0xf0),'endkey':_0x16173f(0x15d)}),_0x423ea0=new Set();if(_0x261205&&_0x261205[_0x16173f(0x19c)])for(const _0x5bc057 of _0x261205[_0x16173f(0x19c)]){const _0x254ac9=_0x5bc057['id']['replace'](_0x16173f(0x130),''),_0x4150fa=await this[_0x16173f(0x23d)](_0x254ac9+'.data.table');let _0x419aa7=![];if(_0x4150fa&&_0x4150fa[_0x16173f(0xfd)]){const _0x104674=typeof _0x4150fa[_0x16173f(0xfd)]===_0x16173f(0x1aa)?JSON[_0x16173f(0x1b3)](_0x4150fa[_0x16173f(0xfd)]):_0x4150fa[_0x16173f(0xfd)];Array['isArray'](_0x104674)&&_0x104674[_0x16173f(0x185)](_0x511318=>{const _0x23973f=_0x16173f;_0x511318[_0x23973f(0x18b)]&&(_0x423ea0[_0x23973f(0xf1)](_0x511318[_0x23973f(0x18b)]),_0x419aa7=!![]);});}!_0x419aa7&&_0x423ea0['add'](_0x254ac9);}const _0x143b3a=Array[_0x16173f(0x242)](_0x423ea0);if(_0x143b3a['length']===0x0)_0x143b3a['push']('Standard');this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':!![],'names':_0x143b3a},_0x14f1d4[_0x16173f(0x100)]);}catch(_0x1c42b4){this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4['command'],{'success':![],'error':_0x16173f(0x146)+_0x1c42b4[_0x16173f(0x190)]},_0x14f1d4['callback']);}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x1c1))try{await automation[_0x16173f(0x244)](this),this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':!![]},_0x14f1d4[_0x16173f(0x100)]);}catch(_0x59185b){this[_0x16173f(0xf4)][_0x16173f(0x13b)](_0x16173f(0x1d1)+_0x59185b['message']),this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4['command'],{'success':![],'error':_0x59185b[_0x16173f(0x190)]},_0x14f1d4[_0x16173f(0x100)]);}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x148))try{const _0x28c1ed=_0x14f1d4[_0x16173f(0x190)]['matrix'];if(!_0x28c1ed||!Array[_0x16173f(0x1c2)](_0x28c1ed))throw new Error(_0x16173f(0x203));const _0xb4e6ab=await this[_0x16173f(0x124)](_0x16173f(0x24c));if(_0xb4e6ab&&_0xb4e6ab[_0x16173f(0xfd)]){const _0x2b2562=JSON[_0x16173f(0x1b3)](_0xb4e6ab['val']);_0x2b2562['matrix']=_0x28c1ed,_0x2b2562[_0x16173f(0x131)]=Date[_0x16173f(0x113)](),await this[_0x16173f(0x198)](_0x16173f(0x24c),{'val':JSON[_0x16173f(0x1d4)](_0x2b2562),'ack':!![]}),this[_0x16173f(0xf4)][_0x16173f(0x141)](_0x16173f(0x1c3)),this[_0x16173f(0x1de)](_0x14f1d4['from'],_0x14f1d4[_0x16173f(0x245)],{'success':!![]},_0x14f1d4['callback']);}else throw new Error(_0x16173f(0x15a));}catch(_0x3ab1a8){this['log'][_0x16173f(0x13b)]('updateTopologyMatrix\x20failed:\x20'+_0x3ab1a8[_0x16173f(0x190)]),this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':![],'error':_0x3ab1a8['message']},_0x14f1d4[_0x16173f(0x100)]);}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x1d6))try{const _0x2b7fe6=_0x14f1d4[_0x16173f(0x190)][_0x16173f(0x245)],_0x2f1d32=_0x14f1d4[_0x16173f(0x190)];this['log']['debug'](_0x16173f(0x1a0)+_0x2b7fe6),pythonBridge[_0x16173f(0x1b9)](this,_0x2b7fe6,_0x2f1d32,_0x4b0e01=>{const _0x3a998d=_0x16173f;this[_0x3a998d(0x1de)](_0x14f1d4['from'],_0x14f1d4[_0x3a998d(0x245)],_0x4b0e01,_0x14f1d4[_0x3a998d(0x100)]);});}catch(_0x229448){this[_0x16173f(0xf4)][_0x16173f(0x13b)](_0x16173f(0x16c)+_0x229448[_0x16173f(0x190)]),this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'type':_0x16173f(0x128),'payload':_0x229448[_0x16173f(0x190)]},_0x14f1d4['callback']);}else{if(_0x14f1d4['command']==='testApiKey')try{const _0x1fcf7c=_0x14f1d4['message']?_0x14f1d4[_0x16173f(0x190)][_0x16173f(0x111)]:'';if(!_0x1fcf7c)throw new Error(_0x16173f(0x173));const _0x25e8ef=new GoogleGenerativeAI(_0x1fcf7c),_0x2ba0e1=_0x25e8ef[_0x16173f(0x23a)]({'model':GEMINI_MODEL}),_0x3f1940=await _0x2ba0e1['generateContent']('Say\x20Hello'),_0x3d2281=await _0x3f1940[_0x16173f(0x157)],_0x354158=_0x3d2281[_0x16173f(0x251)]();this[_0x16173f(0x1de)](_0x14f1d4['from'],_0x14f1d4[_0x16173f(0x245)],{'success':!![],'message':_0x16173f(0x175)+_0x354158[_0x16173f(0x17d)](0x0,0x14)+_0x16173f(0x1cd)},_0x14f1d4[_0x16173f(0x100)]);}catch(_0x563a9b){this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4['command'],{'success':![],'message':_0x563a9b[_0x16173f(0x190)]},_0x14f1d4[_0x16173f(0x100)]);}else{if(_0x14f1d4[_0x16173f(0x245)]===_0x16173f(0x13e))try{const _0x588bae=await this[_0x16173f(0x23b)](),_0x34f8e9=await this['getObjectViewAsync']('system',_0x16173f(0x10b),{'startkey':'system.adapter.ical.','endkey':_0x16173f(0x15d)}),_0x5b358d=_0x34f8e9&&_0x34f8e9['rows']?_0x34f8e9['rows'][_0x16173f(0x110)]:0x0;this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4['command'],{'success':!![],'weather':'Sonne:\x20'+_0x588bae+',\x20Temp:\x20'+(this[_0x16173f(0xfc)][this[_0x16173f(0x176)][_0x16173f(0x1c9)]]||'?')+'¬∞C','calendar':_0x5b358d+_0x16173f(0x1da)},_0x14f1d4[_0x16173f(0x100)]);}catch(_0x5613b6){this[_0x16173f(0x1de)](_0x14f1d4[_0x16173f(0x242)],_0x14f1d4[_0x16173f(0x245)],{'success':![]},_0x14f1d4['callback']);}}}}}}}}}}}}}[a0_0x14a61c(0x205)](){const _0x382bb8=a0_0x14a61c;if(!this[_0x382bb8(0x247)][_0x382bb8(0xf9)])return;this['log'][_0x382bb8(0x141)](_0x382bb8(0x22e));try{const _0x2c85c9=this[_0x382bb8(0x207)]||[];pythonBridge[_0x382bb8(0x1b9)](this,'CALCULATE_HEALTH_TREND',{'events':_0x2c85c9});}catch(_0x2e2cc9){this[_0x382bb8(0xf4)][_0x382bb8(0x13b)](_0x382bb8(0x181));}}async[a0_0x14a61c(0x1e5)](_0x17c865,_0x2be137){const _0x1aaaaa=a0_0x14a61c;if(!_0x2be137||this[_0x1aaaaa(0x155)])return;if(_0x17c865[_0x1aaaaa(0x1e6)](_0x1aaaaa(0x12f))&&_0x17c865[_0x1aaaaa(0x219)](_0x1aaaaa(0x1fd))&&_0x2be137[_0x1aaaaa(0xfd)])return;if(this[_0x1aaaaa(0x176)][_0x1aaaaa(0x17c)]&&_0x17c865===this[_0x1aaaaa(0x176)][_0x1aaaaa(0x18c)]&&this[_0x1aaaaa(0x247)][_0x1aaaaa(0x1ba)]){this[_0x1aaaaa(0xff)](_0x2be137[_0x1aaaaa(0xfd)]);return;}if(_0x2be137[_0x1aaaaa(0x109)]&&_0x17c865[_0x1aaaaa(0x219)](_0x1aaaaa(0x12e)))return;if(_0x17c865===this[_0x1aaaaa(0x151)]+_0x1aaaaa(0x1ac)){if(_0x2be137[_0x1aaaaa(0xfd)]&&Object[_0x1aaaaa(0x11a)](setup['SYSTEM_MODES'])[_0x1aaaaa(0x1e6)](_0x2be137[_0x1aaaaa(0xfd)])){this[_0x1aaaaa(0x255)]=_0x2be137['val'];if(_0x2be137[_0x1aaaaa(0xfd)]===setup[_0x1aaaaa(0x21b)][_0x1aaaaa(0x192)])await recorder[_0x1aaaaa(0x199)](this,![]);else await recorder['setPresence'](this,!![]);if(this['isProVersion']){let _0x5e0ef0=![],_0x6d304d=0x0,_0xd5586f=_0x1aaaaa(0x182);if(this[_0x1aaaaa(0x255)]==='party')_0x5e0ef0=!![],_0x6d304d=0x168,_0xd5586f='Party\x20Mode';else this[_0x1aaaaa(0x255)]==='guest'&&(_0x5e0ef0=!![],_0x6d304d=0x5a0,_0xd5586f=_0x1aaaaa(0x248));pythonBridge['send'](this,'SET_LEARNING_MODE',{'active':_0x5e0ef0,'duration':_0x6d304d,'label':_0xd5586f}),await this[_0x1aaaaa(0x198)](_0x1aaaaa(0x1ef),{'val':JSON[_0x1aaaaa(0x1d4)]({'active':_0x5e0ef0,'label':_0xd5586f,'timestamp':Date['now']()}),'ack':!![]});}}if(!_0x2be137[_0x1aaaaa(0x109)])this[_0x1aaaaa(0x211)](_0x17c865,{'val':this['currentSystemMode'],'ack':!![]});return;}if(_0x17c865[_0x1aaaaa(0x219)](_0x1aaaaa(0x10e))&&_0x2be137[_0x1aaaaa(0x109)])this[_0x1aaaaa(0x231)](_0x2be137[_0x1aaaaa(0xfd)]);if(_0x17c865[_0x1aaaaa(0x219)](_0x1aaaaa(0x221))&&_0x2be137['ack']&&this[_0x1aaaaa(0x247)][_0x1aaaaa(0x115)])automation[_0x1aaaaa(0x126)](this);if(!_0x2be137['ack']){if(_0x17c865['includes'](_0x1aaaaa(0x132))&&_0x2be137[_0x1aaaaa(0xfd)]){this[_0x1aaaaa(0x211)](_0x17c865,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this);return;}if(_0x17c865['includes']('triggerDailyDigest')&&_0x2be137[_0x1aaaaa(0xfd)]){this[_0x1aaaaa(0x211)](_0x17c865,{'val':![],'ack':!![]});if(this[_0x1aaaaa(0x1cb)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x17c865[_0x1aaaaa(0x1e6)](_0x1aaaaa(0x1cc))&&_0x2be137[_0x1aaaaa(0xfd)]){this['setState'](_0x17c865,{'val':![],'ack':!![]}),aiAgent[_0x1aaaaa(0x118)](this);return;}if(_0x17c865[_0x1aaaaa(0x1e6)]('automation.triggerAction')&&_0x2be137[_0x1aaaaa(0xfd)]){this[_0x1aaaaa(0x211)](_0x17c865,{'val':![],'ack':!![]}),aiAgent[_0x1aaaaa(0x1dd)](this);return;}if(_0x17c865['includes']('analysis.training.triggerSecurity')&&_0x2be137['val']){this[_0x1aaaaa(0x211)](_0x17c865,{'val':![],'ack':!![]});if(this[_0x1aaaaa(0x1cb)])try{const _0x4842a1=await this[_0x1aaaaa(0x124)](_0x1aaaaa(0x1f9));if(_0x4842a1&&_0x4842a1[_0x1aaaaa(0xfd)]){const _0x2565b5=JSON['parse'](_0x4842a1[_0x1aaaaa(0xfd)]);this[_0x1aaaaa(0x198)](_0x1aaaaa(0x186),{'val':'Sec-Training\x20started...','ack':!![]}),pythonBridge[_0x1aaaaa(0x1b9)](this,_0x1aaaaa(0x240),{'sequences':_0x2565b5});}}catch(_0x1a008f){}return;}if(_0x17c865[_0x1aaaaa(0x1e6)](_0x1aaaaa(0x20b))&&_0x2be137[_0x1aaaaa(0xfd)]){this[_0x1aaaaa(0x211)](_0x17c865,{'val':![],'ack':!![]});try{aiAgent[_0x1aaaaa(0x144)](this,_0x1aaaaa(0x1ec)),setTimeout(()=>aiAgent[_0x1aaaaa(0x144)](this,_0x1aaaaa(0x1b2)),0x2ee0);if(this[_0x1aaaaa(0x1cb)]){this[_0x1aaaaa(0x205)]();const _0x5cace0=await this[_0x1aaaaa(0x124)](_0x1aaaaa(0xf6));if(_0x5cace0&&_0x5cace0['val'])pythonBridge[_0x1aaaaa(0x1b9)](this,_0x1aaaaa(0x194),{'digests':JSON[_0x1aaaaa(0x1b3)](_0x5cace0[_0x1aaaaa(0xfd)])});}}catch(_0xbe3231){this[_0x1aaaaa(0xf4)]['warn'](_0x1aaaaa(0x156)+_0xbe3231[_0x1aaaaa(0x190)]);}return;}if(_0x17c865[_0x1aaaaa(0x1e6)](_0x1aaaaa(0x1f7))&&_0x2be137[_0x1aaaaa(0xfd)]){this[_0x1aaaaa(0x211)](_0x17c865,{'val':![],'ack':!![]}),await this[_0x1aaaaa(0x20d)]();return;}if(_0x17c865[_0x1aaaaa(0x1e6)](_0x1aaaaa(0x1fc))&&_0x2be137[_0x1aaaaa(0xfd)]){this['setState'](_0x17c865,{'val':![],'ack':!![]});if(this[_0x1aaaaa(0x1cb)])try{const _0x49f231=await this[_0x1aaaaa(0x124)]('LTM.rawEventLog');if(_0x49f231&&_0x49f231[_0x1aaaaa(0xfd)]){const _0x122c56={};if(this['config'][_0x1aaaaa(0x257)])this[_0x1aaaaa(0x176)]['devices'][_0x1aaaaa(0x185)](_0x326861=>{const _0x4af300=_0x1aaaaa;if(_0x326861['id']&&_0x326861[_0x4af300(0x1cf)])_0x122c56[_0x326861['id']]=_0x326861[_0x4af300(0x1cf)];});pythonBridge[_0x1aaaaa(0x1b9)](this,_0x1aaaaa(0x20a),{'events':JSON[_0x1aaaaa(0x1b3)](_0x49f231['val']),'deviceMap':_0x122c56});}}catch(_0x1b69dc){}return;}if(_0x17c865[_0x1aaaaa(0x1e6)]('analysis.training.triggerTopology')&&_0x2be137[_0x1aaaaa(0xfd)]){this[_0x1aaaaa(0x211)](_0x17c865,{'val':![],'ack':!![]}),topology[_0x1aaaaa(0x241)](this);if(this[_0x1aaaaa(0x1cb)])try{const _0x1ca89d=await this[_0x1aaaaa(0x124)](_0x1aaaaa(0x1f9));if(_0x1ca89d&&_0x1ca89d[_0x1aaaaa(0xfd)])pythonBridge['send'](this,_0x1aaaaa(0x121),{'sequences':JSON['parse'](_0x1ca89d[_0x1aaaaa(0xfd)])});}catch(_0x1eb6a6){}return;}}const _0x331ba0=(this[_0x1aaaaa(0x176)][_0x1aaaaa(0x257)]||[])[_0x1aaaaa(0x1c7)](_0x5470aa=>_0x5470aa['id']===_0x17c865);if(_0x331ba0){const _0x52bf64=await recorder['processSensorEvent'](this,_0x17c865,_0x2be137,_0x331ba0);_0x52bf64&&this['setState'](_0x1aaaaa(0x1a4),{'val':Date[_0x1aaaaa(0x113)](),'ack':!![]});_0x52bf64&&_0x52bf64['type']==='motion'&&_0x52bf64[_0x1aaaaa(0x136)]&&this[_0x1aaaaa(0x1cb)]&&deadMan[_0x1aaaaa(0x12a)](this,_0x52bf64['location']);_0x2be137[_0x1aaaaa(0xfd)]&&(_0x2be137[_0x1aaaaa(0xfd)]===!![]||_0x2be137[_0x1aaaaa(0xfd)]===0x1||String(_0x2be137[_0x1aaaaa(0xfd)])['toLowerCase']()===_0x1aaaaa(0xed))&&(_0x331ba0[_0x1aaaaa(0x1cf)]&&(_0x331ba0[_0x1aaaaa(0x1cf)][_0x1aaaaa(0x1e6)](_0x1aaaaa(0x210))||_0x331ba0[_0x1aaaaa(0x1cf)]['includes'](_0x1aaaaa(0x1a6)))&&this[_0x1aaaaa(0x1bc)](_0x331ba0));if(_0x331ba0[_0x1aaaaa(0x1cf)]===_0x1aaaaa(0x127)||_0x331ba0[_0x1aaaaa(0x1cf)]==='thermostat'){if(this[_0x1aaaaa(0x247)]['energy'])automation[_0x1aaaaa(0x152)](this);}}}async[a0_0x14a61c(0x231)](_0xa71e18){const _0x230a6c=a0_0x14a61c;if(!this[_0x230a6c(0x1c5)]||Date['now']()-this[_0x230a6c(0x184)]>0x493e0)return;try{const _0x3fb224=JSON[_0x230a6c(0x1b3)](_0xa71e18),_0x3393f3=this[_0x230a6c(0x1c5)][_0x230a6c(0x1ed)];let _0x5a46a1=![];for(const _0x137335 in _0x3393f3){if(_0x3393f3[_0x137335][_0x230a6c(0x1e6)]('AI')&&_0x3fb224[_0x137335]&&!_0x3fb224[_0x137335]['includes']('AI')){_0x5a46a1=!![];break;}}_0x5a46a1&&(await this['setStateAsync']('analysis.energy.warmupTimes',{'val':JSON[_0x230a6c(0x1d4)](this[_0x230a6c(0x1c5)]['times']),'ack':!![]}),await this[_0x230a6c(0x198)](_0x230a6c(0x10e),{'val':JSON['stringify'](this[_0x230a6c(0x1c5)][_0x230a6c(0x1ed)]),'ack':!![]}));}catch(_0x3981ed){}}async[a0_0x14a61c(0x19b)](){const _0x2f9294=a0_0x14a61c;try{const _0x126000=await this[_0x2f9294(0x124)](setup['SYSTEM_DP_MODE']);if(_0x126000&&_0x126000[_0x2f9294(0xfd)])this['currentSystemMode']=_0x126000[_0x2f9294(0xfd)];}catch(_0x263b8c){this['currentSystemMode']=setup[_0x2f9294(0x21b)][_0x2f9294(0x24a)];}}async[a0_0x14a61c(0x16d)](){const _0x38287f=a0_0x14a61c,_0x35536f=this[_0x38287f(0x176)]['presenceDevices']||[];if(_0x35536f['length']===0x0)return![];const _0x7dc709=[],_0x45bb3e=Date[_0x38287f(0x113)](),_0x56ce0f=0x5*0x3c*0x3e8;for(const _0x283f76 of _0x35536f){try{let _0x24343a=![];try{const _0x5b9101=await this[_0x38287f(0x23d)](_0x283f76+_0x38287f(0x195));if(_0x5b9101&&_0x5b9101[_0x38287f(0xfd)]===!![])_0x24343a=!![];}catch(_0x46c058){}if(!_0x24343a)try{const _0x218ca9=await this['getForeignStateAsync'](_0x283f76+'.last_seen');if(_0x218ca9&&_0x218ca9['ts']){const _0x1c7198=_0x45bb3e-_0x218ca9['ts'];if(_0x1c7198<_0x56ce0f)_0x24343a=!![];}}catch(_0x48f8a4){}if(!_0x24343a)try{const _0x55b814=await this[_0x38287f(0x23d)](_0x283f76+_0x38287f(0x116));if(_0x55b814&&typeof _0x55b814['val']===_0x38287f(0x21c)&&_0x55b814[_0x38287f(0xfd)]>0x0)_0x24343a=!![];}catch(_0x2fc87b){}if(!_0x24343a)try{const _0x317d1c=await this[_0x38287f(0x23d)](_0x283f76);if(_0x317d1c){const _0x5a65cd=_0x45bb3e-(_0x317d1c['ts']||0x0);_0x5a65cd<_0x56ce0f&&(_0x317d1c[_0x38287f(0xfd)]===!![]||_0x317d1c['val']===_0x38287f(0x13a)||_0x317d1c[_0x38287f(0xfd)]===0x1)&&(_0x24343a=!![]);}}catch(_0x47ac52){}if(_0x24343a){const _0xda4027=_0x283f76[_0x38287f(0x20e)]('.'),_0x4779c2=_0xda4027[_0xda4027[_0x38287f(0x110)]-0x1]||_0x283f76;_0x7dc709[_0x38287f(0x1a5)](_0x4779c2);}}catch(_0x5429b4){this[_0x38287f(0xf4)][_0x38287f(0x13b)](_0x38287f(0x24e)+_0x283f76+':\x20'+_0x5429b4[_0x38287f(0x190)]);}}const _0x344adc=_0x7dc709[_0x38287f(0x110)]>0x0?_0x7dc709[_0x38287f(0x1f4)](',\x20'):_0x38287f(0x1c4);return await this[_0x38287f(0x198)](_0x38287f(0x256),{'val':_0x344adc,'ack':!![]}),_0x7dc709[_0x38287f(0x110)]>0x0;}async['runAutopilot'](){const _0x58eb46=a0_0x14a61c;await aiAgent['runGeminiAnalysis'](this);this['activeModules']['health']&&(this[_0x58eb46(0x21d)](),this[_0x58eb46(0x13f)]());if(this[_0x58eb46(0x247)][_0x58eb46(0x115)])this['triggerEnergyPrediction']();}async[a0_0x14a61c(0x23b)](){const _0x29b5c1=a0_0x14a61c,_0x44e28c=['weatherunderground.0','accuweather.0',_0x29b5c1(0x19a)],_0x95a755=['forecast.current.weather','Current.WeatherText',_0x29b5c1(0x1e3)];for(const _0x2a9fcd of _0x44e28c){for(const _0x559b65 of _0x95a755){try{const _0x44e675=_0x2a9fcd+'.'+_0x559b65,_0x46af69=await this[_0x29b5c1(0x23d)](_0x44e675);if(_0x46af69&&_0x46af69[_0x29b5c1(0xfd)]){const _0x99b4b2=String(_0x46af69[_0x29b5c1(0xfd)])[_0x29b5c1(0x161)]();if(_0x99b4b2[_0x29b5c1(0x1e6)](_0x29b5c1(0x114))||_0x99b4b2['includes'](_0x29b5c1(0x1b1))||_0x99b4b2[_0x29b5c1(0x1e6)](_0x29b5c1(0x1e9))||_0x99b4b2[_0x29b5c1(0x1e6)]('sonn')||_0x99b4b2[_0x29b5c1(0x1e6)]('clear'))return this['log'][_0x29b5c1(0x141)]('‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20'+_0x44e675),!![];}}catch(_0x3b4775){}}}return![];}[a0_0x14a61c(0x13f)](){const _0x23e02c=a0_0x14a61c;if(!this[_0x23e02c(0x1cb)])return;try{this[_0x23e02c(0x124)](_0x23e02c(0x1f9),(_0x3e71c3,_0x55f5e0)=>{const _0x3a35ca=_0x23e02c;if(_0x3e71c3||!_0x55f5e0||!_0x55f5e0[_0x3a35ca(0xfd)])return;try{const _0x4726d9=JSON[_0x3a35ca(0x1b3)](_0x55f5e0[_0x3a35ca(0xfd)]);if(!_0x4726d9||_0x4726d9['length']===0x0)return;pythonBridge['send'](this,_0x3a35ca(0x169),{'sequences':_0x4726d9}),this[_0x3a35ca(0xf4)][_0x3a35ca(0x141)](_0x3a35ca(0x162)+_0x4726d9[_0x3a35ca(0x110)]+_0x3a35ca(0x209));}catch(_0x315f13){this['log']['warn'](_0x3a35ca(0x18d)+_0x315f13[_0x3a35ca(0x190)]);}});}catch(_0x7597f){this['log'][_0x23e02c(0x13b)](_0x23e02c(0x220)+_0x7597f[_0x23e02c(0x190)]);}}async[a0_0x14a61c(0x20d)](){const _0x101cdc=a0_0x14a61c;if(!this[_0x101cdc(0x1cb)]||!this[_0x101cdc(0x247)][_0x101cdc(0x115)])return;try{const _0x21d6cc={},_0x2e7d79={},_0x246e82=this['config'][_0x101cdc(0x257)]||[];for(const _0x5172c5 of _0x246e82){if((_0x5172c5['type']===_0x101cdc(0x127)||_0x5172c5[_0x101cdc(0x1cf)]==='thermostat')&&_0x5172c5[_0x101cdc(0x136)])try{const _0x72ab3d=await this[_0x101cdc(0x23d)](_0x5172c5['id']);_0x72ab3d&&typeof _0x72ab3d[_0x101cdc(0xfd)]===_0x101cdc(0x21c)&&(_0x21d6cc[_0x5172c5[_0x101cdc(0x136)]]=_0x72ab3d[_0x101cdc(0xfd)],_0x2e7d79[_0x5172c5[_0x101cdc(0x136)]]=_0x5172c5['isSolar']||![]);}catch(_0x165f2f){}}let _0xceaadd=0xa;if(this[_0x101cdc(0x176)][_0x101cdc(0x106)])try{const _0x2d4615=await this[_0x101cdc(0x23d)](this[_0x101cdc(0x176)][_0x101cdc(0x106)]);if(_0x2d4615&&typeof _0x2d4615[_0x101cdc(0xfd)]===_0x101cdc(0x21c))_0xceaadd=_0x2d4615[_0x101cdc(0xfd)];}catch(_0x3e349f){}const _0x98fc68=await this[_0x101cdc(0x23b)]();let _0x47721c={};try{const _0x2667d8=await this['getStateAsync'](_0x101cdc(0x1ca));if(_0x2667d8&&_0x2667d8[_0x101cdc(0xfd)])_0x47721c=JSON[_0x101cdc(0x1b3)](_0x2667d8[_0x101cdc(0xfd)]);}catch(_0x3f92d7){}pythonBridge[_0x101cdc(0x1b9)](this,_0x101cdc(0x117),{'current_temps':_0x21d6cc,'t_out':_0xceaadd,'is_sunny':_0x98fc68,'solar_flags':_0x2e7d79,'warmup_targets':_0x47721c}),this[_0x101cdc(0xf4)]['info']('üîÆ\x20Energy\x20Prediction\x20triggered\x20('+Object[_0x101cdc(0x1ae)](_0x21d6cc)[_0x101cdc(0x110)]+'\x20rooms)');}catch(_0x8420fd){this[_0x101cdc(0xf4)][_0x101cdc(0x13b)](_0x101cdc(0x13c)+_0x8420fd[_0x101cdc(0x190)]);}}[a0_0x14a61c(0x21d)](){const _0x5cc53f=a0_0x14a61c;if(!this[_0x5cc53f(0x207)]||this[_0x5cc53f(0x207)]['length']===0x0)return;const _0x139a22=new Array(0x30)[_0x5cc53f(0x1af)](0x0),_0x156890=Array[_0x5cc53f(0x242)]({'length':0x30},()=>[]),_0x11dc20=new Date()[_0x5cc53f(0x17a)](0x0,0x0,0x0,0x0);this[_0x5cc53f(0x207)]['forEach'](_0x7ea645=>{const _0x51b767=_0x5cc53f,_0xe4f97=new Date(_0x7ea645[_0x51b767(0x1bd)]);if(_0xe4f97['getTime']()>=_0x11dc20){const _0x39205b=_0xe4f97[_0x51b767(0x18e)](),_0x330e4d=_0xe4f97[_0x51b767(0x232)](),_0x8eb13=_0x39205b*0x2+Math[_0x51b767(0x10a)](_0x330e4d/0x1e);_0x8eb13>=0x0&&_0x8eb13<0x30&&(_0x139a22[_0x8eb13]++,_0x156890[_0x8eb13]['push']({'time':_0xe4f97[_0x51b767(0x13d)]('de-DE',{'hour':_0x51b767(0x1e7),'minute':_0x51b767(0x1e7)}),'location':_0x7ea645[_0x51b767(0x136)]||_0x51b767(0x180),'type':_0x7ea645[_0x51b767(0x1cf)]||'Event'}));}}),this[_0x5cc53f(0x198)](_0x5cc53f(0x107),{'val':JSON['stringify'](_0x139a22),'ack':!![]}),this[_0x5cc53f(0x198)](_0x5cc53f(0x206),{'val':JSON['stringify'](_0x156890),'ack':!![]});}async[a0_0x14a61c(0xff)](_0x3da126){const _0x2b16ef=a0_0x14a61c;if(!this[_0x2b16ef(0x176)]['infrasoundEnabled']||typeof _0x3da126!=='number')return;const _0x58071=this[_0x2b16ef(0x176)][_0x2b16ef(0x202)]||0.04;this[_0x2b16ef(0x135)][_0x2b16ef(0x1a5)]({'timestamp':Date['now'](),'value':_0x3da126}),this[_0x2b16ef(0x135)][_0x2b16ef(0x110)]>0x64&&this['pressureBuffer'][_0x2b16ef(0x16e)](),_0x3da126>_0x58071&&!this[_0x2b16ef(0x253)]&&(this[_0x2b16ef(0x253)]=!![],this['log'][_0x2b16ef(0x13b)]('üîä\x20Infraschall-Alarm:\x20'+_0x3da126[_0x2b16ef(0x17b)](0x4)+_0x2b16ef(0x217)+_0x58071+_0x2b16ef(0x1d0)),await this['triggerInfrasoundCorrelation'](_0x3da126,'threshold_exceeded'),setTimeout(()=>{const _0x46a87c=_0x2b16ef;this[_0x46a87c(0x253)]=![];},0x5*0x3c*0x3e8));}async['triggerInfrasoundCorrelation'](_0x592baf,_0x317f0c){const _0x369a4c=a0_0x14a61c;if(!this[_0x369a4c(0x254)]){const _0x149ceb=this[_0x369a4c(0x1e2)][_0x369a4c(0x1dc)](0x0,0xa),_0x1702b8=_0x149ceb['map'](_0x58ea1e=>new Date(_0x58ea1e[_0x369a4c(0x1bd)])[_0x369a4c(0x13d)](_0x369a4c(0x187))+'\x20-\x20'+(_0x58ea1e[_0x369a4c(0x136)]||'Unknown')+':\x20'+_0x58ea1e['name'])['join']('\x0a');this[_0x369a4c(0xf4)][_0x369a4c(0x13b)](_0x369a4c(0x1fe)+_0x592baf[_0x369a4c(0x17b)](0x4)+',\x20Events:\x0a'+_0x1702b8);if(this['config'][_0x369a4c(0x183)])try{const _0x5c7b73=await this[_0x369a4c(0x23d)](this[_0x369a4c(0x176)][_0x369a4c(0x183)]);_0x5c7b73&&_0x5c7b73[_0x369a4c(0xfd)]===!![]&&(await this['setStateAsync'](_0x369a4c(0x189),{'val':JSON[_0x369a4c(0x1d4)]({'timestamp':Date[_0x369a4c(0x113)](),'pressure':_0x592baf[_0x369a4c(0x17b)](0x4),'eventType':_0x317f0c,'recentEvents':_0x149ceb[_0x369a4c(0x1dc)](0x0,0x3)}),'ack':!![]}),this['log']['error']('üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!'));}catch(_0x3d1cc8){}}else this[_0x369a4c(0xf4)][_0x369a4c(0x141)](_0x369a4c(0x158)+_0x592baf[_0x369a4c(0x17b)](0x4)+'\x20(Bewohner\x20anwesend\x20-\x20normal)');}async[a0_0x14a61c(0x1bc)](_0x59f4fa){const _0x470248=a0_0x14a61c;if(!_0x59f4fa||!_0x59f4fa[_0x470248(0x136)])return;try{const _0x342be0=(this['config'][_0x470248(0x257)]||[])[_0x470248(0xef)](_0x216c14=>_0x216c14[_0x470248(0x136)]===_0x59f4fa['location']&&(_0x216c14['type']===_0x470248(0x127)||_0x216c14[_0x470248(0x1cf)]==='thermostat'));if(_0x342be0['length']===0x0)return;const _0xc32022=await this[_0x470248(0x23d)](_0x342be0[0x0]['id']);if(!_0xc32022||typeof _0xc32022[_0x470248(0xfd)]!==_0x470248(0x21c))return;const _0x48a9b2=_0xc32022['val'];let _0x3dad5c=null;if(this[_0x470248(0x176)][_0x470248(0x106)]){const _0x861542=await this['getForeignStateAsync'](this[_0x470248(0x176)]['weatherTempId']);_0x861542&&typeof _0x861542[_0x470248(0xfd)]===_0x470248(0x21c)&&(_0x3dad5c=_0x861542[_0x470248(0xfd)]);}if(_0x3dad5c!==null){const _0x2edd34=Math[_0x470248(0x14c)](_0x48a9b2-_0x3dad5c);_0x2edd34>0x3&&(this[_0x470248(0xf4)]['debug']('üí®\x20L√ºftung\x20in\x20'+_0x59f4fa[_0x470248(0x136)]+_0x470248(0x224)+_0x2edd34[_0x470248(0x17b)](0x1)+_0x470248(0x153)+_0x48a9b2+_0x470248(0x1ea)+_0x3dad5c+'¬∞C)'),await this[_0x470248(0x198)](_0x470248(0x258),{'val':JSON[_0x470248(0x1d4)]({'room':_0x59f4fa[_0x470248(0x136)],'timestamp':Date['now'](),'tempDiff':_0x2edd34[_0x470248(0x17b)](0x1),'recommendation':_0x2edd34>0x5?'Gute\x20L√ºftungsm√∂glichkeit!':_0x470248(0x1d7)}),'ack':!![]}));}}catch(_0x13ee31){this[_0x470248(0xf4)][_0x470248(0x13b)](_0x470248(0x165)+_0x13ee31[_0x470248(0x190)]);}}async[a0_0x14a61c(0x12c)](_0x1b6bf7){const _0x4c9e67=a0_0x14a61c;if(!_0x1b6bf7||typeof _0x1b6bf7!==_0x4c9e67(0x1e4))return;const _0x492441={'timestamp':_0x1b6bf7[_0x4c9e67(0x1bd)]||Date['now'](),'id':_0x1b6bf7['id']||Date[_0x4c9e67(0x113)]()[_0x4c9e67(0x1c0)](),'name':_0x1b6bf7['name']||_0x4c9e67(0x1f8),'type':_0x1b6bf7[_0x4c9e67(0x1cf)]||_0x4c9e67(0x171),'location':_0x1b6bf7[_0x4c9e67(0x136)]||_0x4c9e67(0x18a),'value':_0x1b6bf7[_0x4c9e67(0x1ab)]||null};this[_0x4c9e67(0x1e2)][_0x4c9e67(0x22c)](_0x492441);if(this[_0x4c9e67(0x1e2)][_0x4c9e67(0x110)]>0x1388)this['eventHistory']['pop']();await this[_0x4c9e67(0x198)](_0x4c9e67(0x234),{'val':JSON[_0x4c9e67(0x1d4)](this['eventHistory']),'ack':!![]}),this[_0x4c9e67(0xf4)]['debug'](_0x4c9e67(0x160)+_0x492441[_0x4c9e67(0xf2)]+'\x20('+_0x492441[_0x4c9e67(0x136)]+')');}[a0_0x14a61c(0x17f)](_0x263e11){}}if(require['main']!==module)module[a0_0x14a61c(0x179)]=_0x6a611b=>new CogniLiving(_0x6a611b);else new CogniLiving();