const a0_0x4e7d26=a0_0x348b;(function(_0x4547d3,_0x175ca6){const _0xce67df=a0_0x348b,_0x176878=_0x4547d3();while(!![]){try{const _0x1ce97c=parseInt(_0xce67df(0x1c0))/0x1*(-parseInt(_0xce67df(0x1de))/0x2)+-parseInt(_0xce67df(0x197))/0x3+-parseInt(_0xce67df(0x141))/0x4+-parseInt(_0xce67df(0x1e6))/0x5*(parseInt(_0xce67df(0x18b))/0x6)+-parseInt(_0xce67df(0x26d))/0x7*(parseInt(_0xce67df(0x1cf))/0x8)+-parseInt(_0xce67df(0x24f))/0x9*(-parseInt(_0xce67df(0x1f3))/0xa)+parseInt(_0xce67df(0x18f))/0xb;if(_0x1ce97c===_0x175ca6)break;else _0x176878['push'](_0x176878['shift']());}catch(_0x1af5cc){_0x176878['push'](_0x176878['shift']());}}}(a0_0x51d7,0x1cb7f));function a0_0x348b(_0x22d03b,_0x110f0a){const _0x3f0f62=a0_0x51d7();return a0_0x348b=function(_0x1fb0cc,_0x10fe8c){_0x1fb0cc=_0x1fb0cc-0xf0;let _0x51d78d=_0x3f0f62[_0x1fb0cc];return _0x51d78d;},a0_0x348b(_0x22d03b,_0x110f0a);}const a0_0x10fe8c=(function(){let _0x164cd6=!![];return function(_0x42856b,_0x4296f3){const _0x42b95f=_0x164cd6?function(){if(_0x4296f3){const _0x3e7807=_0x4296f3['apply'](_0x42856b,arguments);return _0x4296f3=null,_0x3e7807;}}:function(){};return _0x164cd6=![],_0x42b95f;};}()),a0_0x1fb0cc=a0_0x10fe8c(this,function(){const _0x197ab7=a0_0x348b;return a0_0x1fb0cc[_0x197ab7(0x1a4)]()[_0x197ab7(0x1c1)]('(((.+)+)+)+$')[_0x197ab7(0x1a4)]()['constructor'](a0_0x1fb0cc)[_0x197ab7(0x1c1)](_0x197ab7(0x1c2));});a0_0x1fb0cc();'use strict';const utils=require(a0_0x4e7d26(0x258)),{GoogleGenerativeAI}=require(a0_0x4e7d26(0x235)),schedule=require(a0_0x4e7d26(0x214)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x4e7d26(0x25e),LTM_SCHEDULE=a0_0x4e7d26(0x1b4),MODE_RESET_SCHEDULE=a0_0x4e7d26(0x22a),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x4e7d26(0x23b),LTM_DP_DAILY_DIGESTS=a0_0x4e7d26(0x19a),LTM_DP_STATUS=a0_0x4e7d26(0x26b),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x4e7d26(0x107),LTM_DP_DRIFT_CHANNEL=a0_0x4e7d26(0xf3),LTM_DP_DRIFT_STATUS=a0_0x4e7d26(0x17e),LTM_DP_DRIFT_DETAILS=a0_0x4e7d26(0x268),LTM_DP_DRIFT_LAST_CHECK=a0_0x4e7d26(0x106),SYSTEM_DP_MODE=a0_0x4e7d26(0x13c),HARD_IGNORE_TERMS=['scriptProblem',a0_0x4e7d26(0x22f),a0_0x4e7d26(0xf1),a0_0x4e7d26(0x10f),a0_0x4e7d26(0x111),a0_0x4e7d26(0x18a),a0_0x4e7d26(0x15c),'maintenance',a0_0x4e7d26(0x1ba),'fault',a0_0x4e7d26(0x1bd),a0_0x4e7d26(0x12e),a0_0x4e7d26(0x187),a0_0x4e7d26(0x1a2),a0_0x4e7d26(0x15e),'firmware',a0_0x4e7d26(0x122),a0_0x4e7d26(0x108)],BAD_NAMES=[a0_0x4e7d26(0x1ea),a0_0x4e7d26(0x275),a0_0x4e7d26(0x116),'level',a0_0x4e7d26(0x138),a0_0x4e7d26(0x21d),'on',a0_0x4e7d26(0x209),a0_0x4e7d26(0x154),a0_0x4e7d26(0x26c),a0_0x4e7d26(0x14e),a0_0x4e7d26(0x19c),a0_0x4e7d26(0x1e7),'status',a0_0x4e7d26(0x178),a0_0x4e7d26(0x1f8),a0_0x4e7d26(0x139),a0_0x4e7d26(0x27a),'humidity','power',a0_0x4e7d26(0x182),a0_0x4e7d26(0x23e),a0_0x4e7d26(0x225),a0_0x4e7d26(0x172),a0_0x4e7d26(0x1d1)],ADAPTER_BLACKLIST=['system.',a0_0x4e7d26(0x1a8),a0_0x4e7d26(0x10c),a0_0x4e7d26(0x240),a0_0x4e7d26(0x22c),a0_0x4e7d26(0x109),'icons-mfd.',a0_0x4e7d26(0x1bf),a0_0x4e7d26(0x1d0),a0_0x4e7d26(0xf9),a0_0x4e7d26(0x202)],SYSTEM_MODES={'NORMAL':a0_0x4e7d26(0x161),'VACATION':a0_0x4e7d26(0x183),'PARTY':'party','GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x4e7d26(0x17c)],SYSTEM_MODES[a0_0x4e7d26(0x1e0)]],PERSONA_MAPPING={'generic':a0_0x4e7d26(0x14c),'senior_aal':a0_0x4e7d26(0x130),'family':a0_0x4e7d26(0x1f4),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':a0_0x4e7d26(0x1d5)};async function initZombies(_0x34e68e){const _0x39dfc5=a0_0x4e7d26;try{const _0x522dbc=['analysis.history_debug_00','events.history_debug_00'];for(const _0x41f20a of _0x522dbc){try{const _0x5818ac=await _0x34e68e[_0x39dfc5(0x112)](_0x41f20a);_0x5818ac&&await _0x34e68e[_0x39dfc5(0x1b6)](_0x41f20a);}catch(_0x539aa6){}}}catch(_0xc5fda4){}}async function initHistory(_0x5ec0d8){const _0x93804e=a0_0x4e7d26;try{const _0x179675=await _0x5ec0d8['getStateAsync'](_0x93804e(0x165));_0x179675&&_0x179675[_0x93804e(0x1fc)]&&(_0x5ec0d8[_0x93804e(0x17b)]=JSON['parse'](_0x179675[_0x93804e(0x1fc)][_0x93804e(0x1a4)]()));}catch(_0x3b39f2){_0x5ec0d8['eventHistory']=[];}try{const _0x5ddf6a=await _0x5ec0d8[_0x93804e(0x1df)]('analysis.analysisHistory');if(_0x5ddf6a&&_0x5ddf6a[_0x93804e(0x1fc)])_0x5ec0d8[_0x93804e(0x1f7)]=JSON['parse'](_0x5ddf6a['val'][_0x93804e(0x1a4)]());}catch(_0x2146c9){_0x5ec0d8[_0x93804e(0x1f7)]=[];}}async function initSystemConfig(_0x485f56){const _0x5295c4=a0_0x4e7d26;try{const _0x90b80d=await _0x485f56[_0x5295c4(0x246)](_0x5295c4(0x1fd));_0x90b80d&&_0x90b80d[_0x5295c4(0x173)]&&(_0x485f56['systemConfig']={'latitude':_0x90b80d['common'][_0x5295c4(0x1b7)]||0x0,'longitude':_0x90b80d[_0x5295c4(0x173)][_0x5295c4(0x114)]||0x0,'city':_0x90b80d[_0x5295c4(0x173)]['city']||''});}catch(_0x11b37f){}}async function checkLicense(_0x471232,_0x288bf8){const _0x2009df=a0_0x4e7d26;if(!_0x288bf8)return![];_0x471232[_0x2009df(0x101)]=await getSystemUUID(_0x471232);if(_0x288bf8===_0x2009df(0x1ae)||_0x288bf8[_0x2009df(0x134)](_0x2009df(0x184)))return!![];return![];}async function getSystemUUID(_0x407f71){const _0x4d1907=a0_0x4e7d26;try{const _0x443044=await _0x407f71[_0x4d1907(0x246)]('system.meta.uuid');if(_0x443044&&_0x443044[_0x4d1907(0x257)]&&_0x443044[_0x4d1907(0x257)][_0x4d1907(0x1c4)])return _0x443044['native'][_0x4d1907(0x1c4)];return'uuid-not-found';}catch(_0x4d706c){return _0x4d1907(0x239);}}async function createAllObjects(_0x1f4317){const _0x26cd83=a0_0x4e7d26;await checkSystemObjects(_0x1f4317),await _0x1f4317['setObjectNotExistsAsync']('system.presenceWho',{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x1bb),'type':_0x26cd83(0x262),'role':_0x26cd83(0x113),'read':!![],'write':![],'def':''},'native':{}}),await _0x1f4317['setObjectNotExistsAsync'](_0x26cd83(0x145),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x260),'type':'string','role':_0x26cd83(0x127),'read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x165),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x1d2),'type':_0x26cd83(0x262),'role':'json','read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)]('analysis.trigger',{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x13a),'type':_0x26cd83(0x144),'role':_0x26cd83(0x179),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x234),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x148),'type':_0x26cd83(0x144),'role':_0x26cd83(0x179),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x272),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x249),'type':_0x26cd83(0x262),'role':_0x26cd83(0x127),'read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)]('analysis.isAlert',{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x1b5),'type':_0x26cd83(0x144),'role':_0x26cd83(0x150),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x21c),{'type':'state','common':{'name':_0x26cd83(0x25d),'type':'boolean','role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x1e9),{'type':'state','common':{'name':'Alert\x20Reason','type':_0x26cd83(0x262),'role':_0x26cd83(0x20c),'read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x203),{'type':_0x26cd83(0x116),'common':{'name':'Activity\x20Summary','type':_0x26cd83(0x262),'role':_0x26cd83(0x113),'read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x273),{'type':'state','common':{'name':_0x26cd83(0x255),'type':_0x26cd83(0x262),'role':'state','read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x1c7),{'type':'state','common':{'name':_0x26cd83(0x205),'type':_0x26cd83(0x262),'role':_0x26cd83(0x113),'read':!![],'write':![]},'native':{}}),await _0x1f4317['setObjectNotExistsAsync'](_0x26cd83(0x1c8),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x103),'type':_0x26cd83(0x262),'role':_0x26cd83(0x113),'read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x1b3)](_0x26cd83(0x19f),{'type':_0x26cd83(0x11f),'common':{'name':'Automation\x20Proposals'},'native':{}}),await _0x1f4317['setObjectNotExistsAsync'](_0x26cd83(0x226),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x152),'type':_0x26cd83(0x144),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)]('analysis.automation.description',{'type':'state','common':{'name':_0x26cd83(0x11e),'type':_0x26cd83(0x262),'role':_0x26cd83(0x113),'read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x1b1),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x164),'type':'string','role':_0x26cd83(0x113),'read':!![],'write':![]},'native':{}}),await _0x1f4317['setObjectNotExistsAsync'](_0x26cd83(0x142),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x12c),'type':_0x26cd83(0x262),'role':_0x26cd83(0x113),'read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x14a),{'type':'state','common':{'name':_0x26cd83(0x1d7),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x160),{'type':_0x26cd83(0x116),'common':{'name':_0x26cd83(0x181),'type':_0x26cd83(0x144),'role':_0x26cd83(0x154),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)]('analysis.automation.triggerAction',{'type':'state','common':{'name':'Trigger\x20Action\x20Now','type':_0x26cd83(0x144),'role':_0x26cd83(0x179),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0xf4),{'type':_0x26cd83(0x116),'common':{'name':'Logbook','type':_0x26cd83(0x262),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1f4317['setObjectNotExistsAsync'](_0x26cd83(0x1dd),{'type':'state','common':{'name':'Feedback\x20Log','type':'string','role':_0x26cd83(0x127),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1f4317['extendObjectAsync'](_0x26cd83(0x1d6),{'type':_0x26cd83(0x11f),'common':{'name':_0x26cd83(0x220)},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x238),{'type':_0x26cd83(0x116),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x26cd83(0x1d9),'role':_0x26cd83(0x1cc),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x1f4317[_0x26cd83(0x221)](_0x26cd83(0x245),{'type':'state','common':{'name':_0x26cd83(0x1bc),'type':_0x26cd83(0x262),'role':_0x26cd83(0x113),'read':!![],'write':![],'def':_0x26cd83(0x17d)},'native':{}}),await _0x1f4317['setObjectNotExistsAsync'](_0x26cd83(0x20f),{'type':_0x26cd83(0x116),'common':{'name':'Health\x20Notes','type':'string','role':_0x26cd83(0x113),'read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x1f4317),await checkLtmDriftObjects(_0x1f4317);}async function checkSystemObjects(_0x3c6480){const _0x2abfd5=a0_0x4e7d26;await _0x3c6480[_0x2abfd5(0x1b3)](_0x2abfd5(0x129),{'type':_0x2abfd5(0x11f),'common':{'name':_0x2abfd5(0xfc)},'native':{}}),await _0x3c6480['extendObjectAsync'](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x2abfd5(0x222),'type':'string','role':_0x2abfd5(0x116),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x2abfd5(0x1fe)]]:_0x2abfd5(0x266),[SYSTEM_MODES['VACATION']]:_0x2abfd5(0x24e),[SYSTEM_MODES[_0x2abfd5(0x17c)]]:_0x2abfd5(0x279),[SYSTEM_MODES['GUEST']]:_0x2abfd5(0x1af)}},'native':{}});}async function checkLtmObjects(_0x30bdf2){const _0x53f646=a0_0x4e7d26;await _0x30bdf2['extendObjectAsync'](_0x53f646(0x254),{'type':_0x53f646(0x11f),'common':{'name':_0x53f646(0x254)},'native':{}}),await _0x30bdf2['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x53f646(0x116),'common':{'name':_0x53f646(0x1a7),'type':'string','role':_0x53f646(0x127),'read':!![],'write':![]},'native':{}}),await _0x30bdf2[_0x53f646(0x1b3)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x53f646(0x136),'type':_0x53f646(0x262),'role':_0x53f646(0x127),'read':!![],'write':![]},'native':{}}),await _0x30bdf2[_0x53f646(0x1b3)](LTM_DP_STATUS,{'type':_0x53f646(0x116),'common':{'name':_0x53f646(0x18e),'type':_0x53f646(0x262),'role':'text','read':!![],'write':![]},'native':{}}),await _0x30bdf2[_0x53f646(0x1b3)](LTM_DP_TRIGGER_DIGEST,{'type':_0x53f646(0x116),'common':{'name':_0x53f646(0x1ff),'type':_0x53f646(0x144),'role':_0x53f646(0x179),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x30bdf2[_0x53f646(0x1b3)](LTM_DP_BASELINE_STATUS,{'type':_0x53f646(0x116),'common':{'name':_0x53f646(0x176),'type':_0x53f646(0x262),'role':_0x53f646(0x113),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4aba35){const _0x355db7=a0_0x4e7d26;await _0x4aba35[_0x355db7(0x1b3)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x4aba35[_0x355db7(0x1b3)](LTM_DP_DRIFT_STATUS,{'type':_0x355db7(0x116),'common':{'name':_0x355db7(0x155),'type':_0x355db7(0x262),'role':_0x355db7(0x116),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x4aba35['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x355db7(0x116),'common':{'name':'Drift\x20Details','type':_0x355db7(0x262),'role':_0x355db7(0x113),'read':!![],'write':![]},'native':{}}),await _0x4aba35['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x355db7(0x116),'common':{'name':'Last\x20Check','type':_0x355db7(0x1d9),'role':_0x355db7(0x126),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0xbb1bbc){const _0x2de222=a0_0x4e7d26;try{const _0x2b62da=await _0xbb1bbc[_0x2de222(0x1df)](SYSTEM_DP_MODE);_0x2b62da&&_0x2b62da[_0x2de222(0x1fc)]&&Object[_0x2de222(0x22b)](SYSTEM_MODES)['includes'](_0x2b62da[_0x2de222(0x1fc)])?_0xbb1bbc['currentSystemMode']=_0x2b62da[_0x2de222(0x1fc)]:(_0xbb1bbc[_0x2de222(0x24b)]=SYSTEM_MODES[_0x2de222(0x1fe)],await _0xbb1bbc[_0x2de222(0x166)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x4ab994){_0xbb1bbc[_0x2de222(0x24b)]=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x54a05d){const _0x2cec89=a0_0x4e7d26;try{const _0x2fa64c=await _0x54a05d[_0x2cec89(0x1df)](LTM_DP_RAW_LOG);if(_0x2fa64c&&_0x2fa64c[_0x2cec89(0x1fc)])_0x54a05d[_0x2cec89(0x124)]=JSON['parse'](_0x2fa64c[_0x2cec89(0x1fc)]);}catch(_0x2557ea){_0x54a05d[_0x2cec89(0x124)]=[];}}async function saveRawEventLog(_0x537c88){const _0x1e1044=a0_0x4e7d26;_0x537c88[_0x1e1044(0x124)]['length']>RAW_LOG_MAX_SIZE&&_0x537c88[_0x1e1044(0x124)][_0x1e1044(0xfa)](0x0,_0x537c88[_0x1e1044(0x124)]['length']-RAW_LOG_MAX_SIZE),await _0x537c88[_0x1e1044(0x166)](LTM_DP_RAW_LOG,{'val':JSON[_0x1e1044(0x1aa)](_0x537c88[_0x1e1044(0x124)]),'ack':!![]});}async function loadDailyDigests(_0x3909d2){const _0x1ddd03=a0_0x4e7d26;try{const _0x1cc973=await _0x3909d2[_0x1ddd03(0x1df)](LTM_DP_DAILY_DIGESTS);if(_0x1cc973&&_0x1cc973['val'])_0x3909d2[_0x1ddd03(0x215)]=JSON[_0x1ddd03(0x21a)](_0x1cc973['val']);}catch(_0x3150ae){_0x3909d2[_0x1ddd03(0x215)]=[];}await updateBaselineStatus(_0x3909d2);}async function saveDailyDigests(_0x425d9c,_0x3cd85f=!![]){const _0xbda8f9=a0_0x4e7d26,_0x2470ca=_0x425d9c['config'][_0xbda8f9(0x19b)]||0x3c;_0x425d9c['dailyDigests'][_0xbda8f9(0x14b)]>_0x2470ca&&_0x425d9c[_0xbda8f9(0x215)][_0xbda8f9(0xfa)](0x0,_0x425d9c[_0xbda8f9(0x215)]['length']-_0x2470ca);await _0x425d9c['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0xbda8f9(0x1aa)](_0x425d9c[_0xbda8f9(0x215)]),'ack':!![]});if(_0x3cd85f)await updateBaselineStatus(_0x425d9c);}async function updateAnalysisHistory(_0x11ccda,_0x3b3728){const _0x546eaa=a0_0x4e7d26;_0x11ccda['analysisHistory'][_0x546eaa(0xf5)](_0x3b3728);if(_0x11ccda[_0x546eaa(0x1f7)][_0x546eaa(0x14b)]>ANALYSIS_HISTORY_MAX_SIZE)_0x11ccda[_0x546eaa(0x1f7)][_0x546eaa(0x1eb)]();await _0x11ccda[_0x546eaa(0x166)]('analysis.analysisHistory',{'val':JSON[_0x546eaa(0x1aa)](_0x11ccda[_0x546eaa(0x1f7)]),'ack':!![]});}async function updateBaselineStatus(_0x1fb96b){const _0xa1f218=a0_0x4e7d26;if(!_0x1fb96b[_0xa1f218(0x1a5)]){await _0x1fb96b['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x3c6dcc=_0x1fb96b[_0xa1f218(0x215)][_0xa1f218(0x14b)]>=(_0x1fb96b[_0xa1f218(0x168)]['minDaysForBaseline']||0x7)?_0xa1f218(0x186)+_0x1fb96b[_0xa1f218(0x215)][_0xa1f218(0x14b)]+'\x20Tage)':'Lernphase\x20('+_0x1fb96b['dailyDigests']['length']+'/'+(_0x1fb96b[_0xa1f218(0x168)][_0xa1f218(0x12a)]||0x7)+')';await _0x1fb96b[_0xa1f218(0x166)](LTM_DP_BASELINE_STATUS,{'val':_0x3c6dcc,'ack':!![]});}async function initSensorSubscriptions(_0x23615f){const _0x4f0ff0=a0_0x4e7d26,_0x512247=_0x23615f[_0x4f0ff0(0x168)][_0x4f0ff0(0x19e)];if(_0x512247&&_0x512247[_0x4f0ff0(0x14b)]>0x0){_0x23615f[_0x4f0ff0(0x16a)][_0x4f0ff0(0x1cb)](_0x4f0ff0(0x16b)+_0x512247[_0x4f0ff0(0x14b)]+_0x4f0ff0(0x1d4));for(const _0xc76091 of _0x512247){if(_0xc76091['id']){await _0x23615f['subscribeForeignStatesAsync'](_0xc76091['id']);try{const _0x3d77a1=await _0x23615f['getForeignStateAsync'](_0xc76091['id']);if(_0x3d77a1)_0x23615f['sensorLastValues'][_0xc76091['id']]=_0x3d77a1[_0x4f0ff0(0x1fc)];}catch(_0xcafbb8){}}}}}async function initPresenceSubscriptions(_0x2073b9){const _0x37eccb=a0_0x4e7d26,_0x161e29=_0x2073b9[_0x37eccb(0x168)][_0x37eccb(0x16c)]||[];if(_0x161e29[_0x37eccb(0x14b)]>0x0){_0x2073b9['log'][_0x37eccb(0x1cb)](_0x37eccb(0x16b)+_0x161e29[_0x37eccb(0x14b)]+'\x20presence\x20devices...');for(const _0x331eed of _0x161e29){await _0x2073b9[_0x37eccb(0x253)](_0x331eed);}try{await checkWifiPresence(_0x2073b9);}catch(_0x544674){}}}async function getWeatherContext(_0x5be9b0){const _0x234a63=a0_0x4e7d26;try{if(!_0x5be9b0[_0x234a63(0x168)]['useWeather'])return _0x234a63(0x15b);let _0x64889a='';const _0x5c4960=_0x5be9b0[_0x234a63(0x168)][_0x234a63(0x250)];if(_0x5c4960)try{if(_0x5c4960[_0x234a63(0x191)](_0x234a63(0x1ed))){const _0x45d1bf=await _0x5be9b0[_0x234a63(0x256)](_0x5c4960+_0x234a63(0xfe));if(_0x45d1bf&&_0x45d1bf[_0x234a63(0x1fc)])_0x64889a=_0x45d1bf[_0x234a63(0x1fc)];}else{if(_0x5c4960[_0x234a63(0x191)]('daswetter')){const _0xdece79=await _0x5be9b0['getForeignStateAsync'](_0x5c4960+_0x234a63(0x1c9));if(_0xdece79&&_0xdece79[_0x234a63(0x1fc)])_0x64889a=_0xdece79[_0x234a63(0x1fc)];}else{if(_0x5c4960[_0x234a63(0x191)]('openweathermap')){const _0x460b17=await _0x5be9b0[_0x234a63(0x256)](_0x5c4960+_0x234a63(0x1ab));if(_0x460b17&&_0x460b17['val'])_0x64889a=_0x460b17[_0x234a63(0x1fc)];}}}}catch(_0x5544b2){}if(!_0x64889a){const _0x65120a=[_0x234a63(0x1e4),'daswetter.0',_0x234a63(0x18c),_0x234a63(0x185)];for(const _0x54c325 of _0x65120a){try{const _0x1142e5=await _0x5be9b0[_0x234a63(0x246)](_0x54c325);if(_0x1142e5){if(_0x54c325[_0x234a63(0x191)](_0x234a63(0x1ed))){const _0x10f3b4=await _0x5be9b0[_0x234a63(0x256)](_0x54c325+_0x234a63(0xfe));if(_0x10f3b4&&_0x10f3b4['val']){_0x64889a=_0x10f3b4[_0x234a63(0x1fc)];break;}}}}catch(_0x31c1d0){}}}return _0x64889a?_0x234a63(0x117)+_0x64889a:_0x234a63(0x14d);}catch(_0x3adfe6){return _0x234a63(0x14f)+_0x3adfe6[_0x234a63(0x278)];}}async function getCalendarContext(_0x2ae745){const _0xd451e0=a0_0x4e7d26;try{if(!_0x2ae745['config'][_0xd451e0(0x1f1)])return _0xd451e0(0x137);let _0x2902f0=_0x2ae745[_0xd451e0(0x168)][_0xd451e0(0x169)]||_0xd451e0(0x21b),_0x23c7d1=_0x2ae745[_0xd451e0(0x168)]['calendarSelection']||[];if(typeof _0x23c7d1===_0xd451e0(0x262))_0x23c7d1=_0x23c7d1[_0xd451e0(0x248)](',');try{const _0x28c0da=await _0x2ae745['getForeignStateAsync'](_0x2902f0+'.data.table');if(_0x28c0da&&_0x28c0da[_0xd451e0(0x1fc)]){let _0x1f57cb=tryParse(_0x28c0da['val']);if(_0x1f57cb&&Array[_0xd451e0(0x1a0)](_0x1f57cb)){if(_0x23c7d1[_0xd451e0(0x14b)]>0x0)_0x1f57cb=_0x1f57cb[_0xd451e0(0x125)](_0x2f1cc0=>_0x23c7d1[_0xd451e0(0x191)](_0x2f1cc0[_0xd451e0(0x104)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x1f57cb[_0xd451e0(0x14b)]>0x0){const _0x67b1df=_0x1f57cb[_0xd451e0(0x11c)](0x0,0x3)[_0xd451e0(0x1ec)](_0x230c5d=>{const _0x33b4f4=_0xd451e0;let _0x365761=_0x230c5d['date'];if(_0x230c5d[_0x33b4f4(0x1c3)])_0x365761+='\x20'+_0x230c5d[_0x33b4f4(0x1c3)];return _0x365761+':\x20'+_0x230c5d[_0x33b4f4(0x171)]+'\x20('+_0x230c5d['_calName']+')';});return _0xd451e0(0x271)+_0x67b1df[_0xd451e0(0x170)](_0xd451e0(0x1f9));}else return _0xd451e0(0x131);}}}catch(_0x4646d1){_0x2ae745[_0xd451e0(0x16a)][_0xd451e0(0x1e1)](_0xd451e0(0x196)+_0x4646d1[_0xd451e0(0x278)]);}return _0xd451e0(0x167);}catch(_0x240060){return'KALENDER\x20ERROR:\x20'+_0x240060[_0xd451e0(0x278)];}}async function getCalendarNames(_0xc27260,_0x1741d7){const _0x1e8f22=a0_0x4e7d26;try{const _0x5054da=await _0xc27260[_0x1e8f22(0x256)](_0x1741d7+_0x1e8f22(0x251));if(_0x5054da&&_0x5054da[_0x1e8f22(0x1fc)]){const _0x52824e=tryParse(_0x5054da['val']);if(_0x52824e&&Array[_0x1e8f22(0x1a0)](_0x52824e)){const _0x45e68f=[...new Set(_0x52824e[_0x1e8f22(0x1ec)](_0x208e9f=>_0x208e9f[_0x1e8f22(0x104)])['filter'](Boolean))];return _0x45e68f['sort']();}}return[];}catch(_0x2e69fd){return _0xc27260['log'][_0x1e8f22(0x1ba)](_0x1e8f22(0x177)+_0x2e69fd[_0x1e8f22(0x278)]),[];}}async function checkWifiPresence(_0x4e3bea){const _0x680e5b=a0_0x4e7d26;try{const _0x158bd9=_0x4e3bea[_0x680e5b(0x168)][_0x680e5b(0x16c)]||[];let _0x3478ea=![];const _0x4fd927=[];for(const _0xe7aac7 of _0x158bd9){try{const _0x3b74c5=await _0x4e3bea[_0x680e5b(0x256)](_0xe7aac7);if(_0x3b74c5&&(_0x3b74c5[_0x680e5b(0x1fc)]===!![]||_0x3b74c5[_0x680e5b(0x1fc)]===_0x680e5b(0x216)||_0x3b74c5[_0x680e5b(0x1fc)]===0x1)){_0x3478ea=!![];const _0x427b33=await _0x4e3bea['getForeignObjectAsync'](_0xe7aac7);let _0x22b8fa=_0xe7aac7;_0x427b33&&_0x427b33[_0x680e5b(0x173)]&&_0x427b33['common'][_0x680e5b(0x25f)]&&(_0x22b8fa=typeof _0x427b33[_0x680e5b(0x173)][_0x680e5b(0x25f)]===_0x680e5b(0x12d)?_0x427b33[_0x680e5b(0x173)][_0x680e5b(0x25f)]['de']||_0x427b33[_0x680e5b(0x173)][_0x680e5b(0x25f)]['en']:_0x427b33[_0x680e5b(0x173)][_0x680e5b(0x25f)]),_0x4fd927[_0x680e5b(0x204)](_0x22b8fa);}}catch(_0x23fc5d){}}return await _0x4e3bea[_0x680e5b(0x166)]('system.presenceWho',{'val':_0x4fd927[_0x680e5b(0x170)](',\x20'),'ack':!![]}),_0x3478ea&&(_0x4e3bea[_0x680e5b(0x13b)]&&(_0x4e3bea['log'][_0x680e5b(0x1cb)](_0x680e5b(0x24d)),abortExitTimer(_0x4e3bea)),!_0x4e3bea[_0x680e5b(0x210)]&&_0x4e3bea['currentSystemMode']===SYSTEM_MODES[_0x680e5b(0x1fe)]&&await setPresence(_0x4e3bea,!![])),_0x3478ea;}catch(_0x2d563f){return _0x4e3bea['log'][_0x680e5b(0x1ba)](_0x680e5b(0x156)+_0x2d563f[_0x680e5b(0x278)]),![];}}function startExitTimer(_0xeccc4){const _0x1a33b5=a0_0x4e7d26;abortExitTimer(_0xeccc4),_0xeccc4[_0x1a33b5(0x15a)]=!![],_0xeccc4[_0x1a33b5(0x163)]=setTimeout(()=>{const _0x6d4896=_0x1a33b5;_0xeccc4[_0x6d4896(0x15a)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0xeccc4[_0x1a33b5(0x13b)]=setTimeout(()=>{const _0x2973dc=_0x1a33b5;setPresence(_0xeccc4,![]),_0xeccc4[_0x2973dc(0x13b)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x27677e){const _0x51c496=a0_0x4e7d26;if(_0x27677e[_0x51c496(0x13b)])clearTimeout(_0x27677e[_0x51c496(0x13b)]);if(_0x27677e[_0x51c496(0x163)])clearTimeout(_0x27677e['exitGraceTimer']);_0x27677e[_0x51c496(0x13b)]=null,_0x27677e['exitGraceTimer']=null,_0x27677e[_0x51c496(0x15a)]=![];}async function setPresence(_0x2bc1bd,_0x1ae49c){const _0x5c9c00=a0_0x4e7d26;if(_0x2bc1bd[_0x5c9c00(0x210)]===_0x1ae49c)return;_0x2bc1bd[_0x5c9c00(0x210)]=_0x1ae49c,await _0x2bc1bd[_0x5c9c00(0x166)](_0x5c9c00(0x1e8),{'val':_0x1ae49c,'ack':!![]});}async function saveFeedback(_0x330ace,_0x2ab59f){const _0x189c4b=a0_0x4e7d26;_0x330ace[_0x189c4b(0x16a)]['info']('Feedback\x20saved:\x20'+JSON['stringify'](_0x2ab59f));}async function runBaselineDriftAnalysis(_0x3053ac){const _0x36b8e1=a0_0x4e7d26;if(!_0x3053ac[_0x36b8e1(0x1a5)]||!_0x3053ac['geminiModel'])return;const _0x10a0fd=_0x3053ac[_0x36b8e1(0x168)][_0x36b8e1(0x11a)]||0xe;if(_0x3053ac[_0x36b8e1(0x215)][_0x36b8e1(0x14b)]<_0x10a0fd+(_0x3053ac[_0x36b8e1(0x168)][_0x36b8e1(0x12a)]||0x7)){await _0x3053ac['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x1324f2=_0x3053ac['dailyDigests'][_0x36b8e1(0x11c)](-_0x10a0fd),_0x3a4a77=_0x3053ac['dailyDigests'][_0x36b8e1(0x11c)](0x0,_0x3053ac['dailyDigests']['length']-_0x10a0fd),_0x134927=_0x36b8e1(0xf7)+JSON[_0x36b8e1(0x1aa)](_0x3a4a77)+_0x36b8e1(0x228)+JSON[_0x36b8e1(0x1aa)](_0x1324f2);try{const _0xd0d606=await _0x3053ac[_0x36b8e1(0x252)][_0x36b8e1(0x192)](_0x134927),_0x20b9b3=JSON['parse'](_0xd0d606[_0x36b8e1(0x17f)][_0x36b8e1(0x113)]()['replace'](/```json|```/g,'')['trim']());_0x20b9b3[_0x36b8e1(0x1d8)]&&(await _0x3053ac[_0x36b8e1(0x166)](LTM_DP_DRIFT_STATUS,{'val':_0x20b9b3['baselineDrift'],'ack':!![]}),await _0x3053ac[_0x36b8e1(0x166)](LTM_DP_DRIFT_DETAILS,{'val':_0x20b9b3['driftDetails'],'ack':!![]}),await _0x3053ac[_0x36b8e1(0x166)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x36b8e1(0x25c)](),'ack':!![]}));}catch(_0x444fac){}}function setupLtmScheduler(_0x433b17){const _0x1e6f9e=a0_0x4e7d26;try{if(_0x433b17[_0x1e6f9e(0x102)])_0x433b17[_0x1e6f9e(0x102)][_0x1e6f9e(0x1c5)]();if(!_0x433b17['isProVersion']){_0x433b17[_0x1e6f9e(0x166)](LTM_DP_STATUS,{'val':_0x1e6f9e(0x16f),'ack':!![]});return;}_0x433b17[_0x1e6f9e(0x102)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x433b17));}catch(_0xf614db){_0x433b17['log'][_0x1e6f9e(0x1ba)](_0x1e6f9e(0xff)+_0xf614db[_0x1e6f9e(0x278)]);}}function setupModeResetScheduler(_0x5d9932){const _0x18bdeb=a0_0x4e7d26;try{if(_0x5d9932['modeResetJob'])_0x5d9932[_0x18bdeb(0x242)][_0x18bdeb(0x1c5)]();_0x5d9932[_0x18bdeb(0x242)]=schedule[_0x18bdeb(0x162)](MODE_RESET_SCHEDULE,async()=>{const _0x14f378=_0x18bdeb;await loadSystemMode(_0x5d9932),AUTO_RESET_MODES[_0x14f378(0x191)](_0x5d9932[_0x14f378(0x24b)])&&await _0x5d9932['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x14f378(0x1fe)],'ack':![]});});}catch(_0x40dc2c){_0x5d9932[_0x18bdeb(0x16a)][_0x18bdeb(0x1ba)](_0x18bdeb(0x19d)+_0x40dc2c['message']);}}function setupDriftAnalysisScheduler(_0x5809db){const _0x546599=a0_0x4e7d26;try{if(_0x5809db['driftAnalysisTimer'])clearInterval(_0x5809db[_0x546599(0x23c)]);if(!_0x5809db[_0x546599(0x1a5)])return;_0x5809db[_0x546599(0x23c)]=setInterval(()=>runBaselineDriftAnalysis(_0x5809db),(_0x5809db[_0x546599(0x168)][_0x546599(0x180)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x5809db),0x1388);}catch(_0x52981d){_0x5809db[_0x546599(0x16a)][_0x546599(0x1ba)](_0x546599(0x276)+_0x52981d[_0x546599(0x278)]);}}function setupBriefingScheduler(_0xb86d35){const _0x497645=a0_0x4e7d26;try{if(_0xb86d35[_0x497645(0x229)])_0xb86d35[_0x497645(0x229)][_0x497645(0x1c5)]();if(!_0xb86d35[_0x497645(0x168)][_0x497645(0x1da)])return;const _0x1bd8dd=(_0xb86d35[_0x497645(0x168)][_0x497645(0x244)]||_0x497645(0x231))[_0x497645(0x248)](':'),_0x1c7a61=parseInt(_0x1bd8dd[0x0])||0x8,_0x53004e=parseInt(_0x1bd8dd[0x1])||0x0,_0x5d6d85=_0x53004e+'\x20'+_0x1c7a61+_0x497645(0x13f);_0xb86d35[_0x497645(0x16a)]['info'](_0x497645(0x1b2)+_0x1c7a61+':'+(_0x53004e<0xa?'0'+_0x53004e:_0x53004e)),_0xb86d35[_0x497645(0x229)]=schedule['scheduleJob'](_0x5d6d85,()=>{sendMorningBriefing(_0xb86d35);});}catch(_0x1a1aef){_0xb86d35[_0x497645(0x16a)]['error'](_0x497645(0x1f2)+_0x1a1aef[_0x497645(0x278)]);}}async function sendNotification(_0xc5563a,_0x23e3d2,_0x4a2ec9=![],_0x14725e=![]){const _0x2bb4b4=a0_0x4e7d26;_0xc5563a[_0x2bb4b4(0x16a)][_0x2bb4b4(0x1cb)]((_0x4a2ec9?'[TEST]\x20':'')+_0x2bb4b4(0x157)+_0x23e3d2+'\x22');const _0x56c616=_0xc5563a[_0x2bb4b4(0x168)];let _0x333850=0x0;if(_0x56c616[_0x2bb4b4(0x1b9)]){let _0x4e12db={};(_0x23e3d2[_0x2bb4b4(0x191)](_0x2bb4b4(0x241))||_0x14725e)&&(_0x4e12db={'reply_markup':{'inline_keyboard':[[{'text':_0x2bb4b4(0x110),'callback_data':_0x2bb4b4(0x153)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x2bb4b4(0x1dc)}]]}}),await _0xc5563a[_0x2bb4b4(0x16e)](_0x56c616[_0x2bb4b4(0x264)],_0x2bb4b4(0x212),{'text':_0x23e3d2,'user':_0x56c616[_0x2bb4b4(0x1d3)],..._0x4e12db}),_0x333850++;}if(_0x56c616[_0x2bb4b4(0x1a3)]){let _0x3e5d57={'message':_0x23e3d2,'title':_0x14725e?_0x2bb4b4(0x218):'Cogni-Living','priority':_0x14725e?0x2:0x1,'device':_0x56c616[_0x2bb4b4(0x21e)]};_0x14725e&&(_0x3e5d57[_0x2bb4b4(0xf8)]=0x1e,_0x3e5d57['expire']=0xe10,_0x3e5d57[_0x2bb4b4(0x207)]=_0x2bb4b4(0x265)),await _0xc5563a['sendToAsync'](_0x56c616[_0x2bb4b4(0x128)],_0x2bb4b4(0x212),_0x3e5d57),_0x333850++;}return _0x56c616['notifyEmailEnabled']&&(await _0xc5563a[_0x2bb4b4(0x16e)](_0x56c616['notifyEmailInstance'],_0x2bb4b4(0x212),{'text':_0x23e3d2,'to':_0x56c616['notifyEmailRecipient']}),_0x333850++),_0x333850;}async function setupTelegramListener(_0x536528){const _0x302eec=a0_0x4e7d26,_0x42ae6a=_0x536528[_0x302eec(0x168)]['notifyTelegramInstance'];_0x536528['config'][_0x302eec(0x1b9)]&&_0x42ae6a&&(_0x536528['log'][_0x302eec(0x1cb)](_0x302eec(0x194)+_0x42ae6a+_0x302eec(0x12f)),await _0x536528[_0x302eec(0x253)](_0x42ae6a+_0x302eec(0x121)));}function a0_0x51d7(){const _0x3c898a=['ltmLtbWindowDays','blind','Reset\x20Sched\x20Error:\x20','devices','analysis.automation','isArray','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20AKTUELLE\x20ZEIT:\x20','config_pending','notifyPushoverEnabled','toString','isProVersion','custom','Raw\x20Log','admin.','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','stringify','.forecast.current.state','Error:\x20','fenster','TEST-PRO-KEY','Gast','AUTOMATION\x20RULES\x20(THE\x20BUTLER):\x20-\x20Only\x20propose\x20automation\x20if\x20you\x20see\x20a\x20STABLE,\x20REPETITIVE\x20pattern.\x20-\x20IGNORE\x20one-time\x20events.\x20-\x20\x22targetId\x22\x20MUST\x20be\x20a\x20valid\x20sensor\x20ID.','analysis.automation.suggestedAction','Scheduling\x20Morning\x20Briefing\x20for\x20','extendObjectAsync','0\x203\x20*\x20*\x20*','AI\x20Alert\x20Status','delObjectAsync','latitude','Nein','notifyTelegramEnabled','error','Who\x20is\x20present?','Restlessness\x20Level','working','ðŸ¤–\x20AUTO-APPLY:\x20Executing\x20','flot.','100545HLVSah','search','(((.+)+)+)+$','time','uuid','cancel','sleepScore','analysis.comfortSummary','analysis.comfortSuggestion','.NextHours.Location_1.Day_1.current.symbol_desc','.\x20DATEN:\x20Schlaf\x20','info','value.health','members','livingContext','8752eZPwoS','echarts.','set_temperature','Event\x20History','notifyTelegramRecipient','\x20sensors...','PRIORITÃ„T:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungewÃ¶hnliche\x20Anwesenheit.','analysis.health','Target\x20Value','baselineDrift','number','briefingEnabled','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','COGNI_REQUEST_CALL','analysis.feedbackHistory','2hLqniB','getStateAsync','GUEST','warn','.\x20OUTPUT:\x20Nur\x20Text.','toLowerCase','accuweather.0','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','85280pRDXRw','cover','system.isPresent','analysis.alertReason','targetposition','pop','map','accuweather','dimmer','Phase\x202:\x20ACUTE\x20MONITORING.\x20STB\x20(Last\x2014d):\x20','inactivityMonitoringEnabled','useCalendar','Briefing\x20Sched\x20Error:\x20','1747030Whcdnr','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','BUTLER\x20Execution\x20Error:\x20','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','analysisHistory','presence','\x20|\x20','indexOf','getForeignObjectsAsync','val','system.config','NORMAL','Trigger\x20Digest','Skipped\x20(No\x20AI\x20or\x20Data)','lastAlertState','simple-api.','analysis.activitySummary','push','Comfort\x20Summary','isEmergency','sound','sensor','off','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','catch','text.alarm','rollladen','enum.functions.*','analysis.health.notes','isPresent','type','send','.\x20PERSONA:\x20','node-schedule','dailyDigests','online','enum.rooms.*','ðŸš¨\x20EMERGENCY','doors','parse','ical.0','analysis.isEmergency','brightness','notifyPushoverRecipient','summary','Health\x20&\x20Sleep\x20Analysis','setObjectNotExistsAsync','System\x20Mode','role','replace','valve','analysis.automation.patternDetected','setForeignStateAsync','\x0aSTB:\x20','briefingJob','0\x204\x20*\x20*\x20*','values','history.','location','some','scriptEnabled','Analysis\x20Error:\x20','08:00','lampe','temp','analysis.triggerBriefing','@google/generative-ai','Morning\x20Briefing\x20sent.','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','analysis.health.sleepScore','uuid-error','toLocaleString','LTM.rawEventLog','driftAnalysisTimer','door','setpoint','exports','vis.','Alarm','modeResetJob','prÃ¤senz','briefingTime','analysis.health.restlessness','getForeignObjectAsync','heizung','split','Last\x20Result','klima','currentSystemMode','bewegung','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','Urlaub','9pIbHbY','weatherInstance','.data.table','geminiModel','subscribeForeignStatesAsync','LTM','Deviation','getForeignStateAsync','native','@iobroker/adapter-core','endsWith','.\x20MODUS:\x20','isAlert','now','AI\x20Emergency\x20Status','models/gemini-flash-latest','name','Last\x20raw\x20event','activity','string','weather','notifyTelegramInstance','siren','Normal','thermostat','LTM.driftAnalysis.driftDetails','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','\x20events','LTM.processingStatus','position','21crLWMn','analysis.isAlert','main','Success:\x20Compressed\x20','KALENDER:\x20','analysis.lastResult','analysis.deviationFromBaseline','.\x20KONTEXT:\x20','currentposition','Drift\x20Sched\x20Error:\x20','window','message','Party','temperature','sensorLastValues','update','Briefing\x20Error:\x20','LTM.driftAnalysis','analysis.analysisHistory','unshift','health','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','retry','javascript.','splice','targetId','System\x20Status\x20&\x20Control','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','.Summary.Current','LTM\x20Sched\x20Error:\x20','logDuplicates','systemUUID','ltmJob','Comfort\x20Suggestion','_calName','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','LTM.driftAnalysis.lastCheck','LTM.baselineStatus','link_quality','material.','\x20=\x20','light','info.','\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22execution\x22:\x20{\x20\x22targetId\x22:\x20\x22string|null\x22,\x20\x22targetValue\x22:\x20\x22boolean|number|null\x22\x20}\x20}\x20},\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22string\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20}','trim','unreach','âœ…\x20Alles\x20OK\x20(Reset)','lowbat','getObjectAsync','text','longitude','\x20Phase\x203:\x20DRIFT\x20ACTIVE.','state','WETTER:\x20','execution','Triggered\x20analysis\x20but\x20Gemini\x20AI\x20is\x20not\x20initialized!\x20Check\x20API\x20Key.','ltmStbWindowDays','alertReason','slice','timestamp','Description','channel','lights','.communicate.request','reachable','selectedFunctionIds','rawEventLog','filter','date','json','notifyPushoverInstance','system','minDaysForBaseline','enum','Target\x20ID','object','direction','\x20for\x20interactive\x20buttons...','PRIORITÃ„T:\x20Gesundheit\x20und\x20Sicherheit\x20fÃ¼r\x20Senioren\x20(AAL).\x20Erkenne\x20InaktivitÃ¤t,\x20potenzielle\x20StÃ¼rze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20nÃ¤chtliche\x20Unruhe.','KALENDER:\x20Keine\x20relevanten\x20Termine','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','setHours','startsWith','Phase\x201:\x20Learning\x20(No\x20Baseline).\x20Rely\x20on\x20common\x20sense.','Daily\x20Digests','Kalender:\x20Deaktiviert','value','occupancy','Trigger\x20Analysis','exitTimer','system.mode','.\x20ZUSATZ:\x20','tÃ¼r','\x20*\x20*\x20*','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','472516iACdPd','analysis.automation.targetId','schalter','boolean','events.lastEvent','inactivityThresholdHours',')\x20verdÃ¤chtig\x20still?\x202.\x20Akut\x20(vs.\x20STB):\x20Weicht\x20das\x20heutige\x20Verhalten\x20stark\x20von\x20den\x20letzten\x2014\x20Tagen\x20ab?\x20Ignoriere\x20Fehlalarme\x20durch\x20Kontext:\x20','Trigger\x20Briefing\x20(Test)','aiPersona','analysis.automation.targetValue','length','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','WETTER:\x20Keine\x20Daten\x20gefunden','shutter','WETTER\x20ERROR:\x20','indicator.alarm','comfort','Pattern\x20Detected','COGNI_CONFIRM_OK','switch','Drift\x20Status','Error\x20checking\x20WiFi:\x20','Sending\x20notification:\x20\x22','CRITICAL\x20SAFETY\x20CHECK:\x201.\x20Sofort/Ad-Hoc:\x20Ist\x20es\x20jetzt\x20(','toFixed','isGracePeriodActive','Wetter:\x20Deaktiviert','connection','forEach','dutycycle','2-digit','analysis.automation.autoApply','normal','scheduleJob','exitGraceTimer','Action','events.history','setStateAsync','KALENDER:\x20Keine\x20Daten','config','calendarInstance','log','Subscribing\x20to\x20','presenceDevices','targetValue','sendToAsync','Deaktiviert\x20(Pro-Feature)','join','event','actual_temperature','common','automationProposal','ðŸš¨ðŸš¨\x20NOTFALL','Baseline\x20Status','getCalendarNames\x20Error:\x20','motion','button','toISOString','eventHistory','PARTY','none','LTM.driftAnalysis.baselineDrift','response','ltmDriftCheckIntervalHours','Auto\x20Apply\x20Rule','energy','vacation','PRO-','openweathermap.0','Aktiv\x20(','stick_unreach','âš ï¸\x20Alarm','generic','rssi','24JCUfTT','weatherunderground.0','N/A','Processing\x20Status','3295204CbNHmO','_score','includes','generateContent','analysis.automation.description','ðŸ“¡\x20Hooking\x20into\x20','de-DE','Error\x20reading\x20calendar\x20table:\x20','199368QhSSys','substring','No\x20recorded\x20events\x20yet.','LTM.dailyDigests'];a0_0x51d7=function(){return _0x3c898a;};return a0_0x51d7();}async function handleTelegramResponse(_0x5c2a0b,_0x481f17){const _0x4afd4c=a0_0x4e7d26;let _0x1f8300=_0x481f17;_0x481f17[_0x4afd4c(0x134)]('[')&&(_0x1f8300=_0x481f17[_0x4afd4c(0x198)](_0x481f17[_0x4afd4c(0x1fa)](']')+0x1));if(_0x1f8300==='COGNI_CONFIRM_OK')_0x5c2a0b[_0x4afd4c(0x16a)][_0x4afd4c(0x1cb)](_0x4afd4c(0x20a)),await _0x5c2a0b[_0x4afd4c(0x166)](_0x4afd4c(0x26e),{'val':![],'ack':!![]}),await _0x5c2a0b[_0x4afd4c(0x166)](_0x4afd4c(0x1e9),{'val':_0x4afd4c(0x140),'ack':!![]}),_0x5c2a0b[_0x4afd4c(0x201)]=![],sendNotification(_0x5c2a0b,_0x4afd4c(0x132),![]);else _0x1f8300===_0x4afd4c(0x1dc)&&(_0x5c2a0b['log'][_0x4afd4c(0x1e1)](_0x4afd4c(0x1db)),sendNotification(_0x5c2a0b,_0x4afd4c(0x1a9),![],!![]));}async function processSensorEvent(_0x17dda1,_0x839938,_0x144dfa,_0x4fffcc){const _0x4a24b0=a0_0x4e7d26;if(!_0x4fffcc[_0x4a24b0(0x100)]&&_0x17dda1[_0x4a24b0(0xf0)][_0x839938]===_0x144dfa[_0x4a24b0(0x1fc)])return;_0x17dda1[_0x4a24b0(0xf0)][_0x839938]=_0x144dfa[_0x4a24b0(0x1fc)];if(_0x17dda1['isGracePeriodActive'])return;const _0x3228ef=await checkWifiPresence(_0x17dda1);if(_0x3228ef){if(!_0x17dda1['isPresent'])await setPresence(_0x17dda1,!![]);}else{const _0x5eed90=_0x4fffcc['isExit']===!![];if(_0x5eed90)startExitTimer(_0x17dda1);else{if(_0x17dda1[_0x4a24b0(0x13b)])abortExitTimer(_0x17dda1);if(!_0x17dda1[_0x4a24b0(0x210)]&&_0x17dda1['currentSystemMode']===SYSTEM_MODES[_0x4a24b0(0x1fe)])await setPresence(_0x17dda1,!![]);}}const _0x84fd06={'timestamp':_0x144dfa['ts'],'id':_0x839938,'name':_0x4fffcc[_0x4a24b0(0x25f)],'value':_0x144dfa['val'],'location':_0x4fffcc[_0x4a24b0(0x22d)],'type':_0x4fffcc['type']};_0x17dda1['eventHistory'][_0x4a24b0(0xf5)](_0x84fd06);if(_0x17dda1[_0x4a24b0(0x17b)]['length']>HISTORY_MAX_SIZE)_0x17dda1[_0x4a24b0(0x17b)][_0x4a24b0(0x1eb)]();await _0x17dda1['setStateAsync'](_0x4a24b0(0x145),{'val':JSON['stringify'](_0x84fd06),'ack':!![]}),await _0x17dda1[_0x4a24b0(0x166)](_0x4a24b0(0x165),{'val':JSON[_0x4a24b0(0x1aa)](_0x17dda1[_0x4a24b0(0x17b)]),'ack':!![]}),_0x17dda1[_0x4a24b0(0x124)][_0x4a24b0(0x204)]({'timestamp':new Date(_0x144dfa['ts'])[_0x4a24b0(0x17a)](),'sensorName':_0x4fffcc[_0x4a24b0(0x25f)],'location':_0x4fffcc[_0x4a24b0(0x22d)],'value':_0x144dfa['val']}),await saveRawEventLog(_0x17dda1);}async function runGeminiAnalysis(_0xbf8b9a,_0x4a5444=''){const _0x2b8fe1=a0_0x4e7d26;if(!_0xbf8b9a[_0x2b8fe1(0x252)]){_0xbf8b9a[_0x2b8fe1(0x16a)]['warn'](_0x2b8fe1(0x119));return;}const _0x2bcfe3=_0xbf8b9a[_0x2b8fe1(0x17b)]['length']>0x0?_0xbf8b9a[_0x2b8fe1(0x17b)]:[{'note':_0x2b8fe1(0x199)}],_0xb4b34d=PERSONA_MAPPING[_0xbf8b9a['config'][_0x2b8fe1(0x149)]||_0x2b8fe1(0x189)],_0x5b8b0d=_0xbf8b9a[_0x2b8fe1(0x168)][_0x2b8fe1(0x1ce)]||'',_0x5895dd=_0xbf8b9a[_0x2b8fe1(0x24b)],_0x459934=await getWeatherContext(_0xbf8b9a),_0x5ab204=await getCalendarContext(_0xbf8b9a),_0x1a7630=(_0x459934+'\x20'+_0x5ab204)[_0x2b8fe1(0x10e)](),_0x56a134=new Date(),_0x5ef5cf=_0x56a134[_0x2b8fe1(0x23a)](_0x2b8fe1(0x195),{'weekday':'long','hour':_0x2b8fe1(0x15f),'minute':'2-digit'});let _0x374fa7=_0x2b8fe1(0x135);const _0x123c6b=_0xbf8b9a[_0x2b8fe1(0x215)][_0x2b8fe1(0x14b)];if(_0xbf8b9a['isProVersion']&&_0x123c6b>=(_0xbf8b9a[_0x2b8fe1(0x168)]['minDaysForBaseline']||0x7)){const _0x44b61f=_0xbf8b9a[_0x2b8fe1(0x215)][_0x2b8fe1(0x11c)](-(_0xbf8b9a[_0x2b8fe1(0x168)][_0x2b8fe1(0x11a)]||0xe));_0x374fa7=_0x2b8fe1(0x1ef)+JSON[_0x2b8fe1(0x1aa)](_0x44b61f)+'.';if(_0x123c6b>=0x1e)_0x374fa7+=_0x2b8fe1(0x115);}const _0x207bb7=_0x2b8fe1(0x158)+_0x5ef5cf+_0x2b8fe1(0x147)+_0x1a7630,_0x5d79f2=_0x2b8fe1(0x1b0),_0x5ae6c1=_0x2b8fe1(0x1a1)+_0x5ef5cf+_0x2b8fe1(0x25a)+_0x5895dd+'.\x20PRÃ„SENZ:\x20'+(_0xbf8b9a[_0x2b8fe1(0x210)]?'Ja':_0x2b8fe1(0x1b8))+_0x2b8fe1(0x274)+_0x5b8b0d+_0x2b8fe1(0x213)+_0xb4b34d+'.\x20'+_0x374fa7+'\x20'+(_0x4a5444?_0x4a5444:'')+'\x20'+_0x207bb7+'\x20'+_0x5d79f2+'\x20EVENTS:\x20'+JSON[_0x2b8fe1(0x1aa)](_0x2bcfe3)+_0x2b8fe1(0x10d);try{const _0x42f859=await _0xbf8b9a['geminiModel'][_0x2b8fe1(0x192)](_0x5ae6c1),_0x35bbff=_0x42f859[_0x2b8fe1(0x17f)][_0x2b8fe1(0x113)]()[_0x2b8fe1(0x224)](/```json|```/g,'')[_0x2b8fe1(0x10e)](),_0x2bdcba=JSON[_0x2b8fe1(0x21a)](_0x35bbff);await _0xbf8b9a['setStateAsync'](_0x2b8fe1(0x272),{'val':_0x35bbff,'ack':!![]}),await _0xbf8b9a[_0x2b8fe1(0x166)](_0x2b8fe1(0x1e9),{'val':_0x2bdcba['activity'][_0x2b8fe1(0x11b)]||'','ack':!![]}),await _0xbf8b9a[_0x2b8fe1(0x166)](_0x2b8fe1(0x203),{'val':_0x2bdcba['activity'][_0x2b8fe1(0x21f)]||_0x2b8fe1(0x18d),'ack':!![]});const _0x51ef91=_0x2bdcba[_0x2b8fe1(0x151)]?.[_0x2b8fe1(0x174)];if(_0xbf8b9a[_0x2b8fe1(0x1a5)]&&_0x51ef91){const _0x28b1eb=_0x51ef91['patternDetected']||![];await _0xbf8b9a[_0x2b8fe1(0x166)]('analysis.automation.patternDetected',{'val':_0x28b1eb,'ack':!![]}),await _0xbf8b9a[_0x2b8fe1(0x166)](_0x2b8fe1(0x193),{'val':_0x28b1eb?_0x51ef91['description']:'Keine\x20neuen\x20Automatisierungs-Muster\x20erkannt.','ack':!![]});if(_0x28b1eb&&_0x51ef91[_0x2b8fe1(0x118)]&&_0x51ef91[_0x2b8fe1(0x118)]['targetId']){await _0xbf8b9a['setStateAsync'](_0x2b8fe1(0x142),{'val':_0x51ef91[_0x2b8fe1(0x118)][_0x2b8fe1(0xfb)],'ack':!![]}),await _0xbf8b9a[_0x2b8fe1(0x166)](_0x2b8fe1(0x14a),{'val':JSON[_0x2b8fe1(0x1aa)](_0x51ef91[_0x2b8fe1(0x118)][_0x2b8fe1(0x16d)]),'ack':!![]});const _0x38ace9=await _0xbf8b9a['getStateAsync']('analysis.automation.autoApply');_0x38ace9&&_0x38ace9[_0x2b8fe1(0x1fc)]&&(_0xbf8b9a[_0x2b8fe1(0x16a)][_0x2b8fe1(0x1cb)](_0x2b8fe1(0x1be)+_0x51ef91['execution']['targetId']+'\x20=\x20'+_0x51ef91[_0x2b8fe1(0x118)][_0x2b8fe1(0x16d)]),executeAutomationAction(_0xbf8b9a));}else await _0xbf8b9a['setStateAsync']('analysis.automation.targetId',{'val':'','ack':!![]}),await _0xbf8b9a[_0x2b8fe1(0x166)]('analysis.automation.targetValue',{'val':'','ack':!![]});}if(_0x2bdcba[_0x2b8fe1(0x261)][_0x2b8fe1(0x25b)]||_0x2bdcba[_0x2b8fe1(0x261)][_0x2b8fe1(0x206)]){await _0xbf8b9a['setStateAsync'](_0x2b8fe1(0x26e),{'val':!![],'ack':!![]});if(!_0xbf8b9a['lastAlertState']||_0x2bdcba['activity'][_0x2b8fe1(0x206)]){const _0x3eb85d=_0x2bdcba['activity'][_0x2b8fe1(0x206)]?_0x2b8fe1(0x175):_0x2b8fe1(0x188);sendNotification(_0xbf8b9a,_0x3eb85d+':\x20'+_0x2bdcba['activity'][_0x2b8fe1(0x11b)],![],_0x2bdcba[_0x2b8fe1(0x261)][_0x2b8fe1(0x206)]);}}else await _0xbf8b9a[_0x2b8fe1(0x166)](_0x2b8fe1(0x26e),{'val':![],'ack':!![]});_0xbf8b9a['lastAlertState']=_0x2bdcba['activity'][_0x2b8fe1(0x25b)]||_0x2bdcba[_0x2b8fe1(0x261)][_0x2b8fe1(0x206)],updateAnalysisHistory(_0xbf8b9a,{'timestamp':Date[_0x2b8fe1(0x25c)](),'id':Date[_0x2b8fe1(0x25c)]()[_0x2b8fe1(0x1a4)](),'analysis':_0x2bdcba,'systemMode':_0x5895dd,'isPro':_0xbf8b9a[_0x2b8fe1(0x1a5)]});}catch(_0x52bf8b){_0xbf8b9a['log'][_0x2b8fe1(0x1ba)](_0x2b8fe1(0x230)+_0x52bf8b[_0x2b8fe1(0x278)]);}}async function executeAutomationAction(_0xbd547e){const _0x58b0e3=a0_0x4e7d26;try{const _0x197624=await _0xbd547e[_0x58b0e3(0x1df)](_0x58b0e3(0x142)),_0x21ce99=await _0xbd547e[_0x58b0e3(0x1df)](_0x58b0e3(0x14a));if(_0x197624&&_0x197624[_0x58b0e3(0x1fc)]&&_0x21ce99){const _0x167def=_0x197624[_0x58b0e3(0x1fc)];let _0x376cc9=_0x21ce99[_0x58b0e3(0x1fc)];try{_0x376cc9=JSON[_0x58b0e3(0x21a)](_0x376cc9);}catch(_0x3a4691){}_0xbd547e['log'][_0x58b0e3(0x1cb)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x167def+_0x58b0e3(0x10a)+_0x376cc9),await _0xbd547e[_0x58b0e3(0x227)](_0x167def,_0x376cc9);}else _0xbd547e['log']['warn'](_0x58b0e3(0x1f6));}catch(_0x41560f){_0xbd547e[_0x58b0e3(0x16a)][_0x58b0e3(0x1ba)](_0x58b0e3(0x1f5)+_0x41560f['message']);}}async function runAutopilot(_0x2e155a){const _0x53d3dc=a0_0x4e7d26,_0x7b733c=_0x2e155a[_0x53d3dc(0x168)][_0x53d3dc(0x146)],_0xd19ad9=_0x2e155a['eventHistory'][_0x53d3dc(0x14b)]>0x0?_0x2e155a[_0x53d3dc(0x17b)][0x0][_0x53d3dc(0x11d)]:Date[_0x53d3dc(0x25c)](),_0x45d6d2=(Date[_0x53d3dc(0x25c)]()-_0xd19ad9)/(0x3e8*0x3c*0x3c);let _0x2e5878='';_0x2e155a['config'][_0x53d3dc(0x1f0)]&&_0x2e155a[_0x53d3dc(0x24b)]===SYSTEM_MODES[_0x53d3dc(0x1fe)]&&_0x2e155a['isPresent']&&(_0x45d6d2>_0x7b733c&&(_0x2e5878=_0x53d3dc(0x105)+_0x45d6d2[_0x53d3dc(0x159)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0x2e155a,_0x2e5878)[_0x53d3dc(0x20b)](_0x312567=>_0x2e155a[_0x53d3dc(0x16a)]['error'](_0x312567));}async function createDailyDigest(_0x586ced){const _0x53ab3b=a0_0x4e7d26;if(!_0x586ced[_0x53ab3b(0x1a5)])return;await _0x586ced[_0x53ab3b(0x166)](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()[_0x53ab3b(0x23a)](),'ack':!![]});if(!_0x586ced[_0x53ab3b(0x252)]||_0x586ced[_0x53ab3b(0x124)][_0x53ab3b(0x14b)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x586ced[_0x53ab3b(0x166)](LTM_DP_STATUS,{'val':_0x53ab3b(0x200),'ack':!![]});return;}const _0x1d6958=JSON[_0x53ab3b(0x21a)](JSON[_0x53ab3b(0x1aa)](_0x586ced[_0x53ab3b(0x124)])),_0x2d0fbb=_0x1d6958[_0x53ab3b(0x14b)],_0xd8939=_0x53ab3b(0x237)+JSON[_0x53ab3b(0x1aa)](_0x1d6958);try{const _0x392e74=await _0x586ced[_0x53ab3b(0x252)]['generateContent'](_0xd8939),_0x27aa30=JSON[_0x53ab3b(0x21a)](_0x392e74['response']['text']()['replace'](/```json|```/g,'')[_0x53ab3b(0x10e)]());_0x27aa30['summary']&&(_0x586ced['dailyDigests'][_0x53ab3b(0x204)]({'timestamp':new Date()['toISOString'](),'eventCount':_0x2d0fbb,'summary':_0x27aa30[_0x53ab3b(0x21f)],'activityLevel':_0x27aa30['activityLevel'],'systemMode':_0x586ced[_0x53ab3b(0x24b)]}),await saveDailyDigests(_0x586ced),_0x586ced[_0x53ab3b(0x124)]=[],await saveRawEventLog(_0x586ced),await _0x586ced[_0x53ab3b(0x166)](LTM_DP_STATUS,{'val':_0x53ab3b(0x270)+_0x2d0fbb+_0x53ab3b(0x26a),'ack':!![]}));}catch(_0x58bfd0){await _0x586ced[_0x53ab3b(0x166)](LTM_DP_STATUS,{'val':_0x53ab3b(0x1ac)+_0x58bfd0['message'],'ack':!![]});}}async function sendMorningBriefing(_0xcfa146){const _0xd4ca77=a0_0x4e7d26;if(!_0xcfa146[_0xd4ca77(0x252)])return;_0xcfa146['log'][_0xd4ca77(0x1cb)]('Generating\x20Morning\x20Briefing...');const _0x53495e=_0xcfa146[_0xd4ca77(0x215)][_0xd4ca77(0x14b)]>0x0?_0xcfa146[_0xd4ca77(0x215)][_0xcfa146[_0xd4ca77(0x215)]['length']-0x1]:null,_0x2bacdc=_0x53495e&&_0x53495e[_0xd4ca77(0xf6)]?_0x53495e[_0xd4ca77(0xf6)][_0xd4ca77(0x1c6)]:_0xd4ca77(0x18d),_0x1e41e0=new Date();_0x1e41e0[_0xd4ca77(0x133)](0x4,0x0,0x0,0x0);const _0x3c0e46=_0xcfa146[_0xd4ca77(0x17b)][_0xd4ca77(0x125)](_0x3fa4e7=>new Date(_0x3fa4e7[_0xd4ca77(0x11d)])>_0x1e41e0),_0x17e4dd=PERSONA_MAPPING[_0xcfa146[_0xd4ca77(0x168)][_0xd4ca77(0x149)]||_0xd4ca77(0x189)],_0xc6f89e=_0xcfa146[_0xd4ca77(0x168)][_0xd4ca77(0x1ce)]||'',_0x3e1df4=await getWeatherContext(_0xcfa146),_0x28a583=await getCalendarContext(_0xcfa146),_0x53b792=_0xd4ca77(0x1e5)+_0x17e4dd+_0xd4ca77(0x274)+_0xc6f89e+_0xd4ca77(0x13d)+_0x3e1df4+'\x20'+_0x28a583+_0xd4ca77(0x1ca)+_0x2bacdc+_0xd4ca77(0xfd)+JSON[_0xd4ca77(0x1aa)](_0x3c0e46[_0xd4ca77(0x11c)](0x0,0xa))+_0xd4ca77(0x1e2);try{const _0xb0fdfc=await _0xcfa146[_0xd4ca77(0x252)][_0xd4ca77(0x192)](_0x53b792),_0x50accc='ðŸŒ…\x20Daily\x20Briefing:\x0a'+_0xb0fdfc[_0xd4ca77(0x17f)]['text']()['trim']();sendNotification(_0xcfa146,_0x50accc),_0xcfa146[_0xd4ca77(0x16a)][_0xd4ca77(0x1cb)](_0xd4ca77(0x236));}catch(_0x4e2d94){_0xcfa146[_0xd4ca77(0x16a)][_0xd4ca77(0x1ba)](_0xd4ca77(0xf2)+_0x4e2d94['message']);}}async function scanForDevices(_0x419048,_0x283c80){const _0x3c7ec8=a0_0x4e7d26;_0x419048['log'][_0x3c7ec8(0x1cb)](_0x3c7ec8(0x269));const _0x4e0785=[],_0x5a42e9=await _0x419048[_0x3c7ec8(0x1fb)]('*'),_0x31dbf3=await _0x419048['getForeignObjectsAsync'](_0x3c7ec8(0x20e),_0x3c7ec8(0x12b)),_0x1ef5bf=await _0x419048[_0x3c7ec8(0x1fb)](_0x3c7ec8(0x217),_0x3c7ec8(0x12b)),_0xebb5fd={};if(_0x31dbf3)for(const _0x1b7c51 in _0x31dbf3){const _0x3d1c21=_0x31dbf3[_0x1b7c51]['common'][_0x3c7ec8(0x1cd)]||[];_0x3d1c21[_0x3c7ec8(0x15d)](_0xe262a1=>{const _0x24235e=_0x3c7ec8;if(!_0xebb5fd[_0xe262a1])_0xebb5fd[_0xe262a1]=[];_0xebb5fd[_0xe262a1][_0x24235e(0x204)](_0x1b7c51);});}const _0x3a487a={};if(_0x1ef5bf)for(const _0x4ba047 in _0x1ef5bf){const _0x1b0342=_0x1ef5bf[_0x4ba047][_0x3c7ec8(0x173)][_0x3c7ec8(0x1cd)]||[],_0x54ed6e=typeof _0x1ef5bf[_0x4ba047][_0x3c7ec8(0x173)]['name']==='object'?_0x1ef5bf[_0x4ba047]['common'][_0x3c7ec8(0x25f)]['de']:_0x1ef5bf[_0x4ba047]['common'][_0x3c7ec8(0x25f)];_0x1b0342['forEach'](_0x1bfd01=>_0x3a487a[_0x1bfd01]=_0x54ed6e);}const _0x2bbf21=_0x283c80[_0x3c7ec8(0x123)]||[],_0x26b061=_0x283c80[_0x3c7ec8(0x178)]!==![],_0x7daff6=_0x283c80[_0x3c7ec8(0x219)]!==![],_0x302e34=_0x283c80[_0x3c7ec8(0x120)]!==![],_0x195331=_0x283c80[_0x3c7ec8(0x27a)]===!![],_0x3de10e=_0x283c80[_0x3c7ec8(0x263)]===!![];for(const _0x17054f in _0x5a42e9){const _0x2b96a2=_0x5a42e9[_0x17054f];if(_0x2b96a2[_0x3c7ec8(0x211)]!==_0x3c7ec8(0x116)||!_0x2b96a2[_0x3c7ec8(0x173)])continue;if(ADAPTER_BLACKLIST[_0x3c7ec8(0x22e)](_0x192ab4=>_0x17054f['startsWith'](_0x192ab4))&&!_0x3de10e)continue;const _0x2381a2=(_0x2b96a2[_0x3c7ec8(0x173)][_0x3c7ec8(0x223)]||'')[_0x3c7ec8(0x1e3)]();let _0x313a36=(typeof _0x2b96a2['common'][_0x3c7ec8(0x25f)]===_0x3c7ec8(0x12d)?_0x2b96a2[_0x3c7ec8(0x173)][_0x3c7ec8(0x25f)]['de']:_0x2b96a2[_0x3c7ec8(0x173)]['name'])||_0x17054f;const _0x39a731=_0x313a36[_0x3c7ec8(0x1e3)]();let _0x46d5e6=![],_0x4a689f=![];if(_0x2bbf21['length']>0x0){const _0x37f6e8=_0xebb5fd[_0x17054f]||[],_0x759bb1=_0x17054f['split']('.')[_0x3c7ec8(0x11c)](0x0,-0x1)['join']('.'),_0x26d879=_0xebb5fd[_0x759bb1]||[];(_0x37f6e8['some'](_0x5f53c1=>_0x2bbf21['includes'](_0x5f53c1))||_0x26d879[_0x3c7ec8(0x22e)](_0x1326de=>_0x2bbf21[_0x3c7ec8(0x191)](_0x1326de)))&&(_0x46d5e6=!![],_0x4a689f=!![]);}if(!_0x46d5e6&&!_0x3de10e){if(HARD_IGNORE_TERMS[_0x3c7ec8(0x22e)](_0x2a7f7c=>_0x17054f[_0x3c7ec8(0x191)](_0x2a7f7c)||_0x39a731[_0x3c7ec8(0x191)](_0x2a7f7c[_0x3c7ec8(0x1e3)]())))continue;}if(BAD_NAMES[_0x3c7ec8(0x22e)](_0x5c05ed=>_0x39a731===_0x5c05ed||_0x39a731[_0x3c7ec8(0x259)]('.'+_0x5c05ed))){const _0x5c1bde=_0x17054f[_0x3c7ec8(0x248)]('.');if(_0x5c1bde[_0x3c7ec8(0x14b)]>0x2){const _0x190312=_0x5c1bde[_0x3c7ec8(0x11c)](0x0,-0x1)['join']('.'),_0x1ffb8e=_0x5a42e9[_0x190312];if(_0x1ffb8e&&_0x1ffb8e[_0x3c7ec8(0x173)]&&_0x1ffb8e[_0x3c7ec8(0x173)][_0x3c7ec8(0x25f)]){const _0x1ee594=typeof _0x1ffb8e['common'][_0x3c7ec8(0x25f)]===_0x3c7ec8(0x12d)?_0x1ffb8e[_0x3c7ec8(0x173)][_0x3c7ec8(0x25f)]['de']:_0x1ffb8e[_0x3c7ec8(0x173)][_0x3c7ec8(0x25f)];_0x1ee594&&!_0x313a36[_0x3c7ec8(0x191)](_0x1ee594)&&(_0x313a36=_0x1ee594+'\x20'+_0x313a36);}}}let _0x4d0cf2='';if(_0x26b061&&(_0x2381a2[_0x3c7ec8(0x191)](_0x3c7ec8(0x178))||_0x2381a2['includes'](_0x3c7ec8(0x139))||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x24c))||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x243))))_0x4d0cf2='motion';else{if(!_0x4d0cf2&&_0x7daff6&&(_0x2381a2['includes'](_0x3c7ec8(0x23d))||_0x2381a2[_0x3c7ec8(0x191)](_0x3c7ec8(0x277))||_0x2381a2[_0x3c7ec8(0x191)]('lock')||_0x2381a2['includes'](_0x3c7ec8(0x19c))||_0x2381a2[_0x3c7ec8(0x191)](_0x3c7ec8(0x14e))||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x1ad))||_0x39a731['includes'](_0x3c7ec8(0x13e))||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x20d))))_0x4d0cf2=_0x3c7ec8(0x23d);else{if(!_0x4d0cf2&&_0x302e34&&(_0x2381a2[_0x3c7ec8(0x191)](_0x3c7ec8(0x10b))||_0x2381a2[_0x3c7ec8(0x191)](_0x3c7ec8(0x154))||_0x2381a2[_0x3c7ec8(0x191)](_0x3c7ec8(0x1ee))||_0x39a731[_0x3c7ec8(0x191)]('licht')||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x232))||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x143)))){if(_0x2b96a2[_0x3c7ec8(0x173)]['write']||_0x2381a2[_0x3c7ec8(0x191)](_0x3c7ec8(0x208)))_0x4d0cf2=_0x3c7ec8(0x10b);}else{if(!_0x4d0cf2&&_0x195331&&(_0x2381a2['includes'](_0x3c7ec8(0x27a))||_0x2381a2['includes']('humidity')||_0x2381a2[_0x3c7ec8(0x191)](_0x3c7ec8(0x267))||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x233))||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x24a))||_0x39a731[_0x3c7ec8(0x191)](_0x3c7ec8(0x247))))_0x4d0cf2=_0x3c7ec8(0x27a);else{if(!_0x4d0cf2&&_0x4a689f)_0x4d0cf2=_0x3c7ec8(0x1a6);}}}}if(_0x4d0cf2){let _0x1c9b44=_0x3a487a[_0x17054f]||'';if(!_0x1c9b44){let _0x445333=_0x17054f;for(let _0xa3e2e2=0x0;_0xa3e2e2<0x3;_0xa3e2e2++){const _0x34de5a=_0x445333['lastIndexOf']('.');if(_0x34de5a===-0x1)break;_0x445333=_0x445333[_0x3c7ec8(0x198)](0x0,_0x34de5a);if(_0x3a487a[_0x445333]){_0x1c9b44=_0x3a487a[_0x445333];break;}}}_0x4e0785[_0x3c7ec8(0x204)]({'id':_0x17054f,'name':_0x313a36,'location':_0x1c9b44,'type':_0x4d0cf2,'logDuplicates':_0x4d0cf2==='motion','isExit':![],'_score':_0x1c9b44?0x50:_0x4d0cf2===_0x3c7ec8(0x1a6)?0x5a:0x28});}}return _0x4e0785['sort']((_0xf9bf5,_0xb88990)=>_0xb88990['_score']-_0xf9bf5[_0x3c7ec8(0x190)]),_0x4e0785;}if(require[a0_0x4e7d26(0x26f)]!==module)module[a0_0x4e7d26(0x23f)]=_0x4ee744=>new CogniLiving(_0x4ee744);else new CogniLiving();