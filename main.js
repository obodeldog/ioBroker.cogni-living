const a0_0x4abb78=a0_0xbf3a;function a0_0xbf3a(_0x1bc325,_0x102675){const _0x449977=a0_0x59a9();return a0_0xbf3a=function(_0x393e29,_0x2967d7){_0x393e29=_0x393e29-0xd2;let _0x59a96e=_0x449977[_0x393e29];return _0x59a96e;},a0_0xbf3a(_0x1bc325,_0x102675);}(function(_0x2d80f6,_0x11acd0){const _0x1bffe6=a0_0xbf3a,_0x16379b=_0x2d80f6();while(!![]){try{const _0x4fbf5=-parseInt(_0x1bffe6(0x238))/0x1+parseInt(_0x1bffe6(0xf2))/0x2+-parseInt(_0x1bffe6(0xda))/0x3*(-parseInt(_0x1bffe6(0x194))/0x4)+-parseInt(_0x1bffe6(0x192))/0x5+-parseInt(_0x1bffe6(0xf5))/0x6*(-parseInt(_0x1bffe6(0x239))/0x7)+parseInt(_0x1bffe6(0x23b))/0x8*(-parseInt(_0x1bffe6(0x1b8))/0x9)+parseInt(_0x1bffe6(0xfe))/0xa*(parseInt(_0x1bffe6(0x117))/0xb);if(_0x4fbf5===_0x11acd0)break;else _0x16379b['push'](_0x16379b['shift']());}catch(_0x41ef8f){_0x16379b['push'](_0x16379b['shift']());}}}(a0_0x59a9,0xdefe3));const a0_0x2967d7=(function(){let _0x395ec0=!![];return function(_0x1d81ec,_0x134468){const _0x4fce5d=_0x395ec0?function(){if(_0x134468){const _0x59ded=_0x134468['apply'](_0x1d81ec,arguments);return _0x134468=null,_0x59ded;}}:function(){};return _0x395ec0=![],_0x4fce5d;};}()),a0_0x393e29=a0_0x2967d7(this,function(){const _0x15a342=a0_0xbf3a;return a0_0x393e29[_0x15a342(0x21d)]()['search'](_0x15a342(0x1e1))['toString']()[_0x15a342(0x202)](a0_0x393e29)[_0x15a342(0x188)](_0x15a342(0x1e1));});a0_0x393e29();function a0_0x59a9(){const _0x5959da=['Unbekannt','temperature','TRAIN_TOPOLOGY','triggerEnergyPrediction',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','round','Verbindung\x20erfolgreich:\x20','onUnload','LTM.dailyDigests','getAbsoluteDefaultDataDir','isSolar','\x22history\x22:{}','constructor','analysis.security.learningStatus','shift','âš \x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','json','stopService','isPresent','Aktiv\x20(','daswetter.0','sendTo','now','cogni-living\x20adapter\x20starting\x20(v','analysis.training.triggerComfort','...','ðŸ•¸ï¸\x20Topology\x20Matrix\x20manually\x20updated\x20by\x20user.','.uptime','analysis.health.geminiDay','triggerInfrasoundCorrelation','LTM.baselineStatus','./lib/scanner','refreshCalendar\x20failed:\x20','config','ðŸ“\x20Manual\x20event\x20logged:\x20','abs','timestamp','forecast.current.weather','checkLicense','toString','value','No\x20topology\x20data\x20found','forEach','isProVersion','roomIntegratorTimer','thermostat','getForeignStateAsync','threshold_exceeded','calendarCheckTimer','@google/generative-ai','onReady','Gute\x20LÃ¼ftungsmÃ¶glichkeit!','NORMAL','testApiKey','cogni-living','moduleHealth','sensorLastValues','date','\x20-\x20','analysis.automation.targetId','sources','toFixed','keys','trackerHeartbeat','Niemand','saveDailyHistory','613287BwYLWP','737408TSNSNs','find','2997768REagtb','bootTime','lastTrackerEventTime','send','startSystem','systemConfig','getOverviewData','utf8','subscribeForeignStatesAsync','infrasoundArmingId','minDaysForBaseline','Corrupt','TRAIN_HEALTH','apiKey','handleInfrasound','node-schedule','unshift','analysis.health.activityTrend','isRelevantActivity','enum','setHours','\x20events\x20from\x20standard\x20storage.','3599031IAWHmt','ðŸ\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','activeModules','\x20>\x20','scanDevices','Event','stringify','callback','LTM.triggerDailyDigest','values','getForeignObjectsAsync','analysis.trigger','stateChange','updateSchedulePreview','outdoorSensorId','times','error','updateTopology','protectAiMemory','inactivityThresholdHours','moduleComfort','replayTodayEvents','max','todayVector','113698IzrFvZ','open','analysis.training.triggerHealth','30YOrapb','enum.rooms.*','infrasoundSensorId','online','scheduleJob','lastAlertState','split','number','getHours','675630bwGBYa','calendarName','isArray','Â°C\x20(Innen:\x20','Kein\x20API\x20Key\x20Ã¼bergeben.','system.presenceWho','min','setPresence','object','weatherTempId','pressureBuffer','system','./lib/recorder','infrasoundLocked','analysis.visualization.pulse','analysis.health.todayVector','val','SYSTEM_MODES','text','analysis.ventilation.lastWindow','join','name','./lib/installer','security','Scan\x20Error:\x20','187hOZytp','energy','TRAIN_SECURITY','weatherunderground.0','.last_seen','sendMorningBriefing','sonn','window','communicate.request','automation.triggerAction','./lib/setup','comfort','getStateAsync','bind','âœ…\x20History\x20saved:\x20','matrix','guest','rows','Daily\x20Activity\x20Vector\x20(48x30min)','state','presenceCheckTimer','Lernphase\x20(','No\x20data','ERROR','pop','cleanupGhostInterventions','.json','59\x2023\x20*\x20*\x20*','[PythonBridge]\x20Forwarding\x20command:\x20','Current.WeatherText','setStateAsync','log','message','response','updateTopologyMatrix\x20failed:\x20','Room\x20Dwell\x20Time\x20Stats','setObjectNotExistsAsync','string','substring','@iobroker/adapter-core','analysis.training.triggerSecurity','Party\x20Mode','onStateChange','getDate','cancel','custom','clear','startService','some','sunny','\x20Tage)','testContext','analysis.activity.roomHistory','runPythonHealthCheck','endsWith','pythonBridge','type','\x20(Threshold)','historyJob','enum.functions.*','PREDICT_ENERGY','analysis.energy.warmupSources','getMinutes','updateTopologyMatrix','triggerEnergyPrediction\x20Error:\x20','analysis.health.geminiNight','LÃ¼ften\x20empfohlen','.isOnline','initZombies','Keine\x20Daten','de-DE','checkSolarCondition','readFileSync','bin','location','analyzeWindowOpening','currentSystemMode','analysisTimer','telegram','getTime','Say\x20Hello','then','ack','analysis.health.todayRoomDetails','info','events.history','geminiModel','loadSystemMode','manual','system.adapter.ical.','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','geminiApiKey','presenceDevices','.venv','briefingJob','triggerGaitAnalysis','createAllObjects','ðŸš¶\x20Gait\x20Analysis\x20triggered\x20with\x20','TRAIN_COMFORT','analysis.training.triggerTopology','Adapter','ltmJob','fill','main','exitTimer','2-digit','Â°C)','runGeminiAnalysis','setDate','General\x20Activity\x20Trend','./lib/python_bridge','analysis.training.status','toISOString','search','models/gemini-flash-latest','\x20events\x20from\x20today...','Live\x20Event\x20Pulse','system.adapter.','checkWifiPresence','driftAnalysisTimer','toLowerCase','History\x20Save\x20Error:\x20','generateHealthReport','1404940ptlRZw','integrateRoomTime','4nFwYuK','system.adapter.ical.é¦™','rawEventLog','Manual\x20Event','Init...','motion','initSchedules','length','abortExitTimer','subscribeStates','NextHours.Location_1.Day_1.current.symbol_desc','Unknown','analysis.topology.structure','existsSync','infrasoundThreshold','moduleEnergy','slice','updateHealthVector','analysis.training.triggerEnergy','analysisHistory','Guest\x20Mode','triggerBriefing','analysis.energy.warmupTimes',',\x20Temp:\x20','haustÃ¼r','exitGraceTimer','appendToLog','getObjectViewAsync','refreshCalendar','analysis.prediction.trackerTopRoom','ðŸ’¾\x20Saving\x20Daily\x20History\x20for\x20','command','{\x22history\x22:{}}','âœ…\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','memoryCache','klar','27kFPrkK','party','terrasse','triggerDailyDigest','devices','toLocaleTimeString','add','instance','unload','[Integrator]\x20Error:\x20','initSystemConfig','VACATION','setState','dailyDigests','getEnums','useCalendar','sendNotification','parse','application/json','warn','analysis.security.lastScore','genAI','./lib/dead_man','analysis.energy.warmupTargets','moduleSecurity','map','Warte\x20auf\x20Analyse...','ðŸ”Š\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','getGenerativeModel','filter','onMessage','infrasoundEnabled','includes','ðŸ”®\x20Energy\x20Prediction\x20triggered\x20(','Gemini\x20Init\x20Error:\x20','checkCalendarTriggers','dependencyInstallInProgress','from','CALCULATE_HEALTH_TREND','all','push','(((.+)+)+)+$','analysis.safety.infrasoundAlert','analysis.prediction.trackerConfidence','analysis.activity.roomStats','toLocaleDateString','history','ðŸ’¨\x20LÃ¼ftung\x20in\x20','ðŸ“¦\x20Restored\x20','getHistoryData','scanForDevices','debug','health','scanThermostats','updateLocation','LTM.trainingData.sequences','eventHistory','version','ready','writeFileSync','healthTrendInterval','getCalendarNames'];a0_0x59a9=function(){return _0x5959da;};return a0_0x59a9();}'use strict';const utils=require(a0_0x4abb78(0x13e)),{GoogleGenerativeAI}=require(a0_0x4abb78(0x227)),path=require('path'),fs=require('fs'),installer=require(a0_0x4abb78(0x114)),scanner=require(a0_0x4abb78(0x215)),schedulers=require('./lib/scheduler'),topology=require('./lib/topology'),setup=require(a0_0x4abb78(0x121)),recorder=require(a0_0x4abb78(0x10a)),pythonBridge=require(a0_0x4abb78(0x185)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x4abb78(0x1ce)),automation=require('./lib/automation'),GEMINI_MODEL=a0_0x4abb78(0x189);class CogniLiving extends utils[a0_0x4abb78(0x17b)]{constructor(_0x4ac747){const _0x269ae6=a0_0x4abb78;super({..._0x4ac747,'name':_0x269ae6(0x22c)}),this[_0x269ae6(0x1f0)]=[],this[_0x269ae6(0x1a7)]=[],this[_0x269ae6(0x196)]=[],this[_0x269ae6(0x1c5)]=[],this[_0x269ae6(0x22e)]={},this[_0x269ae6(0x240)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x269ae6(0x208)]=!![],this[_0x269ae6(0x17f)]=null,this[_0x269ae6(0x1ad)]=null,this['isGracePeriodActive']=![],this[_0x269ae6(0x1cd)]=null,this['geminiModel']=null,this['currentSystemMode']=setup[_0x269ae6(0x10f)]['NORMAL'],this[_0x269ae6(0x221)]=![],this[_0x269ae6(0xfa)]=![],this['analysisTimer']=null,this[_0x269ae6(0x226)]=null,this[_0x269ae6(0x12b)]=null,this[_0x269ae6(0x17c)]=null,this['modeResetJob']=null,this[_0x269ae6(0x18e)]=null,this[_0x269ae6(0x175)]=null,this['historyJob']=null,this[_0x269ae6(0x235)]=null,this[_0x269ae6(0x1f4)]=null,this[_0x269ae6(0x222)]=null,this[_0x269ae6(0x1dc)]=![],this[_0x269ae6(0x23d)]=Date[_0x269ae6(0x20c)](),this[_0x269ae6(0x1b6)]=null,this[_0x269ae6(0x23c)]=Date[_0x269ae6(0x20c)](),this[_0x269ae6(0x10b)]=![],this[_0x269ae6(0x108)]=[],this[_0x269ae6(0xdc)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x269ae6(0x1f2),this[_0x269ae6(0x228)]['bind'](this)),this['on'](_0x269ae6(0xe6),this[_0x269ae6(0x141)][_0x269ae6(0x124)](this)),this['on'](_0x269ae6(0x1c0),this[_0x269ae6(0x1fd)][_0x269ae6(0x124)](this)),this['on'](_0x269ae6(0x137),this[_0x269ae6(0x1d6)][_0x269ae6(0x124)](this));}async[a0_0x4abb78(0x228)](){const _0x2c220f=a0_0x4abb78;this[_0x2c220f(0x136)]['info'](_0x2c220f(0x20d)+this[_0x2c220f(0x1f1)]+_0x2c220f(0x1fa));if(this[_0x2c220f(0x217)][_0x2c220f(0x22d)]!==undefined)this['activeModules'][_0x2c220f(0x1ec)]=this[_0x2c220f(0x217)]['moduleHealth'];if(this[_0x2c220f(0x217)][_0x2c220f(0x1d0)]!==undefined)this[_0x2c220f(0xdc)][_0x2c220f(0x115)]=this[_0x2c220f(0x217)][_0x2c220f(0x1d0)];if(this['config'][_0x2c220f(0x1a3)]!==undefined)this[_0x2c220f(0xdc)][_0x2c220f(0x118)]=this['config'][_0x2c220f(0x1a3)];if(this[_0x2c220f(0x217)][_0x2c220f(0xee)]!==undefined)this[_0x2c220f(0xdc)][_0x2c220f(0x122)]=this['config']['moduleComfort'];if(this[_0x2c220f(0x217)]['modules'])this[_0x2c220f(0xdc)]={...this[_0x2c220f(0xdc)],...this['config']['modules']};this[_0x2c220f(0x23f)]();}async['startSystem'](){const _0x51974e=a0_0x4abb78;await setup[_0x51974e(0x15b)](this);try{this[_0x51974e(0x221)]=await setup[_0x51974e(0x21c)](this[_0x51974e(0x217)]['licenseKey']);}catch(_0x305b0b){}if(!this[_0x51974e(0x217)][_0x51974e(0xed)]||this['config'][_0x51974e(0xed)]<0.1)this[_0x51974e(0x217)][_0x51974e(0xed)]=0xc;await setup['initHistory'](this),await setup[_0x51974e(0x1c2)](this),topology[_0x51974e(0xeb)](this);try{const _0x1b07a7=await this[_0x51974e(0x123)](_0x51974e(0x1aa)),_0x31fd27=await this[_0x51974e(0x123)](_0x51974e(0x154));_0x1b07a7&&_0x1b07a7[_0x51974e(0x10e)]&&_0x31fd27&&_0x31fd27[_0x51974e(0x10e)]&&(Date[_0x51974e(0x20c)]()-_0x1b07a7['ts']<0x4*0xe10*0x3e8&&(this[_0x51974e(0x1b6)]={'times':JSON['parse'](_0x1b07a7[_0x51974e(0x10e)]),'sources':JSON[_0x51974e(0x1c9)](_0x31fd27[_0x51974e(0x10e)])}));}catch(_0x24589f){}if(this[_0x51974e(0x217)][_0x51974e(0x172)])try{this[_0x51974e(0x1cd)]=new GoogleGenerativeAI(this['config'][_0x51974e(0x172)]),this[_0x51974e(0x16d)]=this[_0x51974e(0x1cd)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x51974e(0x1ca)}});}catch(_0x394a0e){this[_0x51974e(0x136)]['error'](_0x51974e(0x1da)+_0x394a0e['message']);}await setup[_0x51974e(0x177)](this),await this['loadSystemMode'](),schedulers[_0x51974e(0x19a)](this),await this[_0x51974e(0x13b)](_0x51974e(0x10c),{'type':_0x51974e(0x12a),'common':{'name':_0x51974e(0x18b),'type':_0x51974e(0xfc),'role':'value','read':!![],'write':![]},'native':{}}),await this[_0x51974e(0x13b)](_0x51974e(0x1e4),{'type':_0x51974e(0x12a),'common':{'name':_0x51974e(0x13a),'type':_0x51974e(0x13c),'role':_0x51974e(0x206),'read':!![],'write':![],'def':_0x51974e(0x171)},'native':{}}),await this[_0x51974e(0x13b)]('analysis.activity.roomHistory',{'type':_0x51974e(0x12a),'common':{'name':'Room\x20History\x20(24h\x20Buckets)','type':_0x51974e(0x13c),'role':_0x51974e(0x206),'read':!![],'write':![],'def':_0x51974e(0x1b4)},'native':{}}),await this[_0x51974e(0x13b)](_0x51974e(0x158),{'type':_0x51974e(0x12a),'common':{'name':'Gemini\x20Report\x20Night','type':_0x51974e(0x13c),'role':_0x51974e(0x110),'read':!![],'write':![],'def':_0x51974e(0x1d2)},'native':{}}),await this['setObjectNotExistsAsync'](_0x51974e(0x212),{'type':_0x51974e(0x12a),'common':{'name':'Gemini\x20Report\x20Day','type':'string','role':'text','read':!![],'write':![],'def':_0x51974e(0x1d2)},'native':{}}),await this[_0x51974e(0x13b)](_0x51974e(0x10d),{'type':_0x51974e(0x12a),'common':{'name':_0x51974e(0x129),'type':_0x51974e(0x13c),'role':_0x51974e(0x206),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x51974e(0x13b)](_0x51974e(0x16a),{'type':'state','common':{'name':'Daily\x20Room\x20Details\x20(48x30min)','type':_0x51974e(0x13c),'role':_0x51974e(0x206),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x51974e(0xd5),{'type':_0x51974e(0x12a),'common':{'name':_0x51974e(0x184),'type':_0x51974e(0xfc),'role':'value','unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x51974e(0x1aa),{'type':_0x51974e(0x12a),'common':{'name':'Warm-Up\x20Time','type':'string','role':_0x51974e(0x206),'read':!![],'write':![]},'native':{}});try{const _0x4abada=await this[_0x51974e(0x123)]('events.history');if(_0x4abada&&_0x4abada[_0x51974e(0x10e)]){this['eventHistory']=JSON[_0x51974e(0x1c9)](_0x4abada['val']);if(this[_0x51974e(0x221)]){const _0x4b7d7c=await this[_0x51974e(0x123)]('LTM.rawEventLog');if(_0x4b7d7c&&_0x4b7d7c['val'])this[_0x51974e(0x196)]=JSON['parse'](_0x4b7d7c[_0x51974e(0x10e)]);}this[_0x51974e(0x136)][_0x51974e(0x16b)](_0x51974e(0x1e8)+this[_0x51974e(0x1f0)][_0x51974e(0x19b)]+_0x51974e(0xd9));}}catch(_0x4aa737){this[_0x51974e(0x1f0)]=[];}try{const _0xf0a88=await this[_0x51974e(0x123)](_0x51974e(0x1fe));if(_0xf0a88&&_0xf0a88[_0x51974e(0x10e)])this[_0x51974e(0x1c5)]=JSON[_0x51974e(0x1c9)](_0xf0a88[_0x51974e(0x10e)]);}catch(_0x326ddc){this['dailyDigests']=[];}const _0x1ba95e=this[_0x51974e(0x1c5)][_0x51974e(0x19b)]>=(this['config'][_0x51974e(0x245)]||0x7)?_0x51974e(0x209)+this[_0x51974e(0x1c5)][_0x51974e(0x19b)]+_0x51974e(0x149):_0x51974e(0x12c)+this['dailyDigests'][_0x51974e(0x19b)]+'/'+(this[_0x51974e(0x217)]['minDaysForBaseline']||0x7)+')';await this['setStateAsync'](_0x51974e(0x214),{'val':_0x1ba95e,'ack':!![]}),this[_0x51974e(0x19d)](_0x51974e(0xe5)),this['subscribeStates'](_0x51974e(0xe2)),this['subscribeStates']('analysis.training.triggerHealth');this['config'][_0x51974e(0x1d7)]&&this[_0x51974e(0x217)][_0x51974e(0xf7)]&&this[_0x51974e(0xdc)]['security']&&this['subscribeForeignStates'](this[_0x51974e(0x217)][_0x51974e(0xf7)]);const _0x5da53f=this[_0x51974e(0x217)][_0x51974e(0x1bc)];if(_0x5da53f)for(const _0x222750 of _0x5da53f){await this[_0x51974e(0x243)](_0x222750['id']);}const _0x133a26=this[_0x51974e(0x217)]['presenceDevices'];if(_0x133a26)for(const _0xa11188 of _0x133a26){await this['subscribeForeignStatesAsync'](_0xa11188);}const _0x108870=require(_0x51974e(0xd3));if(this[_0x51974e(0x151)])this[_0x51974e(0x151)]['cancel']();this['historyJob']=_0x108870[_0x51974e(0xf9)](_0x51974e(0x132),()=>{const _0x1da394=_0x51974e;this[_0x1da394(0x237)]();}),setTimeout(()=>this[_0x51974e(0xef)](),0x1388);if(this['roomIntegratorTimer'])clearInterval(this[_0x51974e(0x222)]);this['integrateRoomTime'](),this[_0x51974e(0x222)]=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this['healthTrendInterval'])clearInterval(this[_0x51974e(0x1f4)]);this[_0x51974e(0x1f4)]=setInterval(()=>{const _0x145ed2=_0x51974e;this[_0x145ed2(0x221)]&&this[_0x145ed2(0xdc)][_0x145ed2(0x1ec)]&&this[_0x145ed2(0x14c)]();},0x4*0x3c*0x3c*0x3e8);if(this['analysisTimer'])clearInterval(this[_0x51974e(0x164)]);this[_0x51974e(0xdc)][_0x51974e(0x118)]&&(this[_0x51974e(0x164)]=setInterval(()=>{this['triggerEnergyPrediction']();},0xf*0x3c*0x3e8),setTimeout(()=>this['triggerEnergyPrediction'](),0x2710));if(this[_0x51974e(0x226)])clearInterval(this[_0x51974e(0x226)]);this['config'][_0x51974e(0x1c7)]&&this[_0x51974e(0xdc)][_0x51974e(0x118)]&&(this[_0x51974e(0x226)]=setInterval(()=>{const _0x45f700=_0x51974e;automation[_0x45f700(0x1db)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x51974e(0x1db)](this),0x3a98));if(this[_0x51974e(0x12b)])clearInterval(this['presenceCheckTimer']);this['config']['presenceDevices']&&this[_0x51974e(0x217)]['presenceDevices']['length']>0x0&&(this[_0x51974e(0x12b)]=setInterval(async()=>{const _0x2fd7f3=_0x51974e;await this[_0x2fd7f3(0x18d)]();},0x3c*0x3e8),setTimeout(async()=>await this['checkWifiPresence'](),0x1388));const _0x487f49=path[_0x51974e(0x112)](__dirname,_0x51974e(0x174),_0x51974e(0x160),'python');pythonBridge[_0x51974e(0x146)](this,_0x487f49);}[a0_0x4abb78(0x1fd)](_0x481450){const _0x68d439=a0_0x4abb78;if(this[_0x68d439(0x151)])this[_0x68d439(0x151)][_0x68d439(0x143)]();this[_0x68d439(0x237)]()[_0x68d439(0x168)](()=>{const _0x471ee5=_0x68d439;if(this[_0x471ee5(0x164)])clearInterval(this['analysisTimer']);if(this[_0x471ee5(0x226)])clearInterval(this[_0x471ee5(0x226)]);if(this[_0x471ee5(0x12b)])clearInterval(this[_0x471ee5(0x12b)]);if(this['roomIntegratorTimer'])clearInterval(this[_0x471ee5(0x222)]);recorder[_0x471ee5(0x19c)](this),pythonBridge[_0x471ee5(0x207)](this),_0x481450();});}async[a0_0x4abb78(0xef)](){const _0x4f599e=a0_0x4abb78;if(!this[_0x4f599e(0x1f0)]||this[_0x4f599e(0x1f0)][_0x4f599e(0x19b)]===0x0){this[_0x4f599e(0x136)][_0x4f599e(0x1cb)](_0x4f599e(0x205));return;}this['log'][_0x4f599e(0x16b)]('â†º\x20Replaying\x20'+this[_0x4f599e(0x1f0)]['length']+_0x4f599e(0x18a));const _0x3b7ffe=new Date()['setHours'](0x0,0x0,0x0,0x0),_0xdf4670=_0x4f599e(0x14b);let _0x1fdde9={'history':{},'date':new Date()[_0x4f599e(0x1e5)]()};const _0x3df219=_0x4f599e(0x10d),_0x11bddc='analysis.health.todayRoomDetails';let _0x490118=new Array(0x30)['fill'](0x0),_0x4bd29e=Array['from']({'length':0x30},()=>[]);this[_0x4f599e(0x1f0)]['forEach'](_0x2c6e88=>{const _0x134277=_0x4f599e;if(_0x2c6e88[_0x134277(0x21a)]>=_0x3b7ffe){if(recorder[_0x134277(0xd6)](_0x2c6e88[_0x134277(0x14f)],_0x2c6e88[_0x134277(0x21e)])){const _0xf99164=new Date(_0x2c6e88[_0x134277(0x21a)]),_0x1e812d=_0xf99164['getHours']()*0x2+(_0xf99164['getMinutes']()>=0x1e?0x1:0x0);if(_0x1e812d<0x30){_0x490118[_0x1e812d]++;const _0x2baf26=_0x2c6e88[_0x134277(0x161)]||_0x2c6e88[_0x134277(0x113)]||'?';let _0x47b484=_0x4bd29e[_0x1e812d];!_0x47b484[_0x134277(0x1d8)](_0x2baf26)&&_0x47b484[_0x134277(0x1e0)](_0x2baf26);}const _0xa306a3=_0xf99164[_0x134277(0xfd)]();let _0x6883cc=_0x2c6e88[_0x134277(0x161)]||_0x134277(0x19f);const _0x16bcf3=(this[_0x134277(0x217)][_0x134277(0x1bc)]||[])['find'](_0x507209=>_0x507209[_0x134277(0x161)]===_0x6883cc);if(_0x16bcf3)_0x6883cc=_0x16bcf3[_0x134277(0x161)];if(!_0x1fdde9[_0x134277(0x1e6)][_0x6883cc])_0x1fdde9[_0x134277(0x1e6)][_0x6883cc]=new Array(0x18)['fill'](0x0);if(_0x1fdde9[_0x134277(0x1e6)][_0x6883cc][_0xa306a3]<0x3c)_0x1fdde9['history'][_0x6883cc][_0xa306a3]++;}}});const _0x26996e=await this[_0x4f599e(0x123)](_0xdf4670);(!_0x26996e||!_0x26996e[_0x4f599e(0x10e)]||_0x26996e[_0x4f599e(0x10e)]==='{}'||_0x26996e[_0x4f599e(0x10e)][_0x4f599e(0x1d8)](_0x4f599e(0x201)))&&await this[_0x4f599e(0x135)](_0xdf4670,{'val':JSON[_0x4f599e(0xe0)](_0x1fdde9),'ack':!![]}),await this['setStateAsync'](_0x3df219,{'val':JSON[_0x4f599e(0xe0)](_0x490118),'ack':!![]}),await this[_0x4f599e(0x135)](_0x11bddc,{'val':JSON['stringify'](_0x4bd29e),'ack':!![]}),this[_0x4f599e(0x136)][_0x4f599e(0x16b)](_0x4f599e(0x1b5));}async[a0_0x4abb78(0x237)](){const _0x55929c=a0_0x4abb78;if(!this['activeModules']['health'])return;const _0x5092c6=new Date()['toISOString']()[_0x55929c(0xfb)]('T')[0x0];this['log'][_0x55929c(0x1eb)](_0x55929c(0x1b2)+_0x5092c6+'...');try{const [_0x446ae1,_0x55b2fa,_0x279572,_0x4dc464,_0x1f271e,_0x9d86b7]=await Promise[_0x55929c(0x1df)]([this[_0x55929c(0x123)](_0x55929c(0x14b)),this['getStateAsync'](_0x55929c(0x158)),this[_0x55929c(0x123)](_0x55929c(0x212)),this['getStateAsync'](_0x55929c(0x1cc)),this[_0x55929c(0x123)](_0x55929c(0x10d)),this[_0x55929c(0x123)]('analysis.health.activityTrend')]),_0x5d39b3=this[_0x55929c(0x1f0)][_0x55929c(0x1d5)](_0x58c834=>_0x58c834[_0x55929c(0x21a)]>=new Date()[_0x55929c(0xd8)](0x0,0x0,0x0,0x0)&&(_0x58c834['name']['toLowerCase']()['includes'](_0x55929c(0x1ac))||_0x58c834[_0x55929c(0x113)][_0x55929c(0x18f)]()[_0x55929c(0x1d8)](_0x55929c(0x1ba)))&&(_0x58c834[_0x55929c(0x21e)]===!![]||_0x58c834[_0x55929c(0x21e)]===_0x55929c(0xf3)))['length'];let _0x1e4dbe=0x55;if(_0x9d86b7&&_0x9d86b7[_0x55929c(0x10e)]!==undefined)_0x1e4dbe=Math[_0x55929c(0x104)](0x64,Math[_0x55929c(0xf0)](0x14,Math[_0x55929c(0x1fb)](0x50+Number(_0x9d86b7['val'])*0x5)));const _0x410974={'date':_0x5092c6,'timestamp':Date[_0x55929c(0x20c)](),'roomHistory':_0x446ae1?.[_0x55929c(0x10e)]?JSON[_0x55929c(0x1c9)](_0x446ae1['val']):{},'geminiNight':_0x55b2fa?.[_0x55929c(0x10e)]||_0x55929c(0x15c),'geminiDay':_0x279572?.['val']||_0x55929c(0x15c),'anomalyScore':_0x4dc464?.[_0x55929c(0x10e)]||0.1,'todayVector':_0x1f271e?.['val']?JSON[_0x55929c(0x1c9)](_0x1f271e[_0x55929c(0x10e)]):new Array(0x30)[_0x55929c(0x17d)](0x0),'batteryLevel':_0x1e4dbe,'freshAirCount':_0x5d39b3,'eventHistory':this[_0x55929c(0x1f0)]},_0xd57a07=utils[_0x55929c(0x1ff)](),_0x244ecd=path[_0x55929c(0x112)](_0xd57a07,_0x55929c(0x22c),_0x55929c(0x1e6));if(!fs[_0x55929c(0x1a1)](_0x244ecd))fs['mkdirSync'](_0x244ecd,{'recursive':!![]});const _0x31a522=path[_0x55929c(0x112)](_0x244ecd,_0x5092c6+_0x55929c(0x131));fs[_0x55929c(0x1f3)](_0x31a522,JSON[_0x55929c(0xe0)](_0x410974)),this[_0x55929c(0x136)][_0x55929c(0x16b)](_0x55929c(0x125)+_0x31a522);}catch(_0x4cbc29){this[_0x55929c(0x136)][_0x55929c(0xea)](_0x55929c(0x190)+_0x4cbc29[_0x55929c(0x137)]);}}async[a0_0x4abb78(0x193)](){const _0x2a2a0d=a0_0x4abb78;if(!this['isPresent'])return;try{let _0x21d50d=null;try{const _0x2733f9=await this['getStateAsync'](_0x2a2a0d(0x1b1)),_0x311550=await this['getStateAsync'](_0x2a2a0d(0x1e3));if(_0x2733f9&&_0x2733f9[_0x2a2a0d(0x10e)]&&_0x311550&&_0x311550[_0x2a2a0d(0x10e)]&&_0x311550['val']>0.3){if(_0x2733f9['val']!==_0x2a2a0d(0x19f)&&_0x2733f9[_0x2a2a0d(0x10e)]!==_0x2a2a0d(0x198))_0x21d50d=_0x2733f9[_0x2a2a0d(0x10e)];}}catch(_0x5defa2){}if(!_0x21d50d){const _0x5de1ca=this['config'][_0x2a2a0d(0x1bc)]||[];for(const _0x6d753d of _0x5de1ca){if(_0x6d753d[_0x2a2a0d(0x14f)]===_0x2a2a0d(0x199)&&_0x6d753d['location'])try{const _0x4d8a58=await this[_0x2a2a0d(0x224)](_0x6d753d['id']);if(_0x4d8a58&&(_0x4d8a58[_0x2a2a0d(0x10e)]===!![]||_0x4d8a58[_0x2a2a0d(0x10e)]==='on'||_0x4d8a58[_0x2a2a0d(0x10e)]===0x1)){_0x21d50d=_0x6d753d[_0x2a2a0d(0x161)];break;}}catch(_0x2a24c6){}}}if(!_0x21d50d)return;const _0x44f5dc=this[_0x2a2a0d(0x217)][_0x2a2a0d(0x1bc)]||[];let _0x1086b1=_0x21d50d;const _0x33f1e6=_0x44f5dc['find'](_0x28d1fe=>_0x28d1fe['location']&&_0x28d1fe[_0x2a2a0d(0x161)]['toLowerCase']()===_0x21d50d[_0x2a2a0d(0x18f)]());if(_0x33f1e6)_0x1086b1=_0x33f1e6['location'];const _0x1c19d4='analysis.activity.roomHistory',_0x567d5e=await this['getStateAsync'](_0x1c19d4),_0x492ebf=new Date()[_0x2a2a0d(0x1e5)]();let _0x3e7f2e={'history':{},'date':_0x492ebf};if(_0x567d5e&&_0x567d5e['val'])try{_0x3e7f2e=JSON[_0x2a2a0d(0x1c9)](_0x567d5e[_0x2a2a0d(0x10e)]);}catch(_0x356845){}_0x3e7f2e[_0x2a2a0d(0x22f)]!==_0x492ebf&&(_0x3e7f2e[_0x2a2a0d(0x1e6)]={},_0x3e7f2e[_0x2a2a0d(0x22f)]=_0x492ebf);if(!_0x3e7f2e['history'][_0x1086b1])_0x3e7f2e['history'][_0x1086b1]=new Array(0x18)['fill'](0x0);const _0x20b984=new Date()['getHours']();if(_0x3e7f2e[_0x2a2a0d(0x1e6)][_0x1086b1][_0x20b984]<0x3c)_0x3e7f2e[_0x2a2a0d(0x1e6)][_0x1086b1][_0x20b984]++;await this[_0x2a2a0d(0x135)](_0x1c19d4,{'val':JSON[_0x2a2a0d(0xe0)](_0x3e7f2e),'ack':!![]});}catch(_0x2d0bac){this[_0x2a2a0d(0x136)][_0x2a2a0d(0x1cb)](_0x2a2a0d(0x1c1)+_0x2d0bac[_0x2a2a0d(0x137)]);}}async['onMessage'](_0x37d585){const _0xf84705=a0_0x4abb78;if(typeof _0x37d585===_0xf84705(0x106)&&_0x37d585[_0xf84705(0x137)]){if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0x1e9)){const _0x29aa55=_0x37d585[_0xf84705(0x137)][_0xf84705(0x22f)],_0x3c419f=utils['getAbsoluteDefaultDataDir'](),_0x36f1a6=path[_0xf84705(0x112)](_0x3c419f,_0xf84705(0x22c),_0xf84705(0x1e6),_0x29aa55+'.json');if(fs[_0xf84705(0x1a1)](_0x36f1a6))try{const _0x2affa2=JSON[_0xf84705(0x1c9)](fs[_0xf84705(0x15f)](_0x36f1a6,'utf8'));this['sendTo'](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![],'data':_0x2affa2},_0x37d585[_0xf84705(0xe1)]);}catch(_0x56c933){this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585['command'],{'success':![],'error':_0xf84705(0x246)},_0x37d585['callback']);}else this[_0xf84705(0x20b)](_0x37d585['from'],_0x37d585['command'],{'success':![],'error':_0xf84705(0x12d)},_0x37d585[_0xf84705(0xe1)]);}else{if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0x241)){const _0x3afd60=this[_0xf84705(0x1c5)][_0xf84705(0x19b)];let _0x553036=new Array(0x30)[_0xf84705(0x17d)](0x0),_0x27e4f6=Array[_0xf84705(0x1dd)]({'length':0x30},()=>[]);try{const _0x1f0ac4=await this[_0xf84705(0x123)](_0xf84705(0x10d));if(_0x1f0ac4&&_0x1f0ac4[_0xf84705(0x10e)])_0x553036=JSON['parse'](_0x1f0ac4['val']);const _0x41b95b=await this[_0xf84705(0x123)]('analysis.health.todayRoomDetails');if(_0x41b95b&&_0x41b95b[_0xf84705(0x10e)])_0x27e4f6=JSON['parse'](_0x41b95b[_0xf84705(0x10e)]);}catch(_0x611ecc){}let _0x21b251=new Array(0x30)['fill'](0x0);try{const _0x52ff1f=new Date();_0x52ff1f[_0xf84705(0x183)](_0x52ff1f[_0xf84705(0x142)]()-0x1);const _0x57af6b=_0x52ff1f[_0xf84705(0x187)]()['split']('T')[0x0],_0x109eb8=utils[_0xf84705(0x1ff)](),_0x245437=path[_0xf84705(0x112)](_0x109eb8,_0xf84705(0x22c),_0xf84705(0x1e6),_0x57af6b+_0xf84705(0x131));if(fs['existsSync'](_0x245437)){const _0x558aae=JSON[_0xf84705(0x1c9)](fs[_0xf84705(0x15f)](_0x245437,_0xf84705(0x242)));if(_0x558aae&&_0x558aae['todayVector'])_0x21b251=_0x558aae[_0xf84705(0xf1)];}}catch(_0x1311d9){}let _0x3ac409={'today':{},'yesterday':{}};try{const _0x14a927=await this[_0xf84705(0x123)]('analysis.activity.roomStats');if(_0x14a927&&_0x14a927[_0xf84705(0x10e)])_0x3ac409=JSON[_0xf84705(0x1c9)](_0x14a927['val']);}catch(_0xe111b3){}let _0x1b49ee=null;try{const _0x476bb0=await this[_0xf84705(0x123)](_0xf84705(0xd5));if(_0x476bb0)_0x1b49ee=_0x476bb0[_0xf84705(0x10e)];}catch(_0x22299d){}if(_0x1b49ee===undefined||_0x1b49ee===null){const _0x1b3d6e=_0x553036['reduce']((_0x22b285,_0x1cf082)=>_0x22b285+_0x1cf082,0x0),_0x526b08=Math['min'](0x2,Math[_0xf84705(0xf0)](-0x2,(0x64-_0x1b3d6e)/0x32));_0x1b49ee=_0x526b08;}let _0x1bf337=![],_0x46c4cd='',_0x772fc='',_0x374a02='';try{const _0x31cf5b=await this['getStateAsync']('analysis.automation.patternDetected');if(_0x31cf5b&&_0x31cf5b[_0xf84705(0x10e)]){_0x1bf337=!![];const _0x5d1c8f=await this[_0xf84705(0x123)]('analysis.automation.description');_0x46c4cd=_0x5d1c8f?_0x5d1c8f['val']:'';const _0x15f737=await this['getStateAsync'](_0xf84705(0x231));_0x772fc=_0x15f737?_0x15f737['val']:'';const _0x205491=await this[_0xf84705(0x123)]('analysis.automation.targetValue');_0x374a02=_0x205491?_0x205491[_0xf84705(0x10e)]:'';}}catch(_0x4846a5){}const _0x3efeb5=await this[_0xf84705(0x15e)](),_0x2244d9=(this['config'][_0xf84705(0x1bc)]||[])[_0xf84705(0x147)](_0x5e9fe3=>_0x5e9fe3['isSolar']),_0x54aee8=_0x3efeb5&&_0x2244d9;let _0x45ddf0='';try{const _0x27ca25=await this[_0xf84705(0x123)](_0xf84705(0x103));if(_0x27ca25&&_0x27ca25[_0xf84705(0x10e)])_0x45ddf0=_0x27ca25[_0xf84705(0x10e)];}catch(_0x3dcf8a){}this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![],'eventHistory':this[_0xf84705(0x1f0)]['slice'](0x0,0x7d0),'stats':{'digestCount':_0x3afd60,'isPresent':this['isPresent'],'hourlyActivity':_0x553036,'hourlyDetails':_0x27e4f6,'yesterdayActivity':_0x21b251,'solarActive':_0x54aee8,'presenceWho':_0x45ddf0,'roomStats':_0x3ac409,'activityTrend':_0x1b49ee,'modules':this['activeModules']},'automation':{'detected':_0x1bf337,'description':_0x46c4cd,'targetId':_0x772fc,'targetValue':_0x374a02}},_0x37d585[_0xf84705(0xe1)]);}else{if(_0x37d585[_0xf84705(0x1b3)]==='checkThermostats')try{const _0x40fb6d=await automation[_0xf84705(0x1ed)](this);this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![],'results':_0x40fb6d},_0x37d585[_0xf84705(0xe1)]);}catch(_0x2401c1){this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585['command'],{'success':![],'error':_0x2401c1['message']},_0x37d585[_0xf84705(0xe1)]);}else{if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0xde))try{const _0x3079d2=await scanner[_0xf84705(0x1ea)](this,_0x37d585[_0xf84705(0x137)]||{});this['sendTo'](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![],'devices':_0x3079d2},_0x37d585[_0xf84705(0xe1)]);}catch(_0x22e2ad){}else{if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0x1c6)){const _0x540113=await this[_0xf84705(0xe4)](_0xf84705(0x152),'enum'),_0x282b26=[];if(_0x540113)for(const _0x5eddf6 in _0x540113){let _0x5efcee=_0x540113[_0x5eddf6]['common'][_0xf84705(0x113)];if(_0x5efcee&&typeof _0x5efcee===_0xf84705(0x106))_0x5efcee=_0x5efcee['de']||_0x5efcee['en']||Object['values'](_0x5efcee)[0x0]||JSON['stringify'](_0x5efcee);_0x282b26['push']({'id':_0x5eddf6,'name':String(_0x5efcee||_0x5eddf6)});}const _0x26bdf2=await this[_0xf84705(0xe4)](_0xf84705(0xf6),_0xf84705(0xd7)),_0x5da109=[];if(_0x26bdf2)for(const _0x1b0417 in _0x26bdf2){let _0x306970=_0x26bdf2[_0x1b0417]['common']['name'];if(_0x306970&&typeof _0x306970===_0xf84705(0x106))_0x306970=_0x306970['de']||_0x306970['en']||Object[_0xf84705(0xe3)](_0x306970)[0x0]||JSON[_0xf84705(0xe0)](_0x306970);_0x5da109['push'](String(_0x306970||_0x1b0417[_0xf84705(0xfb)]('.')[_0xf84705(0x12f)]()));}this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![],'enums':_0x282b26,'rooms':_0x5da109},_0x37d585[_0xf84705(0xe1)]);}else{if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0x1f5))try{const _0x3d932b=await this[_0xf84705(0x1af)](_0xf84705(0x109),_0xf84705(0x1bf),{'startkey':_0xf84705(0x170),'endkey':_0xf84705(0x195)}),_0x3e3e96=new Set();if(_0x3d932b&&_0x3d932b[_0xf84705(0x128)])for(const _0x508276 of _0x3d932b[_0xf84705(0x128)]){const _0x271656=_0x508276['id']['replace'](_0xf84705(0x18c),''),_0x1ed60f=await this[_0xf84705(0x224)](_0x271656+'.data.table');let _0x17e637=![];if(_0x1ed60f&&_0x1ed60f[_0xf84705(0x10e)]){const _0x565383=typeof _0x1ed60f[_0xf84705(0x10e)]===_0xf84705(0x13c)?JSON[_0xf84705(0x1c9)](_0x1ed60f[_0xf84705(0x10e)]):_0x1ed60f['val'];Array[_0xf84705(0x100)](_0x565383)&&_0x565383[_0xf84705(0x220)](_0x5cae26=>{const _0x2daa0f=_0xf84705;_0x5cae26[_0x2daa0f(0xff)]&&(_0x3e3e96[_0x2daa0f(0x1be)](_0x5cae26['calendarName']),_0x17e637=!![]);});}!_0x17e637&&_0x3e3e96[_0xf84705(0x1be)](_0x271656);}const _0x3cd3e5=Array['from'](_0x3e3e96);if(_0x3cd3e5[_0xf84705(0x19b)]===0x0)_0x3cd3e5[_0xf84705(0x1e0)]('Standard');this[_0xf84705(0x20b)](_0x37d585['from'],_0x37d585['command'],{'success':!![],'names':_0x3cd3e5},_0x37d585[_0xf84705(0xe1)]);}catch(_0x46fcf4){this['sendTo'](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':![],'error':_0xf84705(0x116)+_0x46fcf4[_0xf84705(0x137)]},_0x37d585[_0xf84705(0xe1)]);}else{if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0x1b0))try{await automation[_0xf84705(0xe7)](this),this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![]},_0x37d585[_0xf84705(0xe1)]);}catch(_0x25aa50){this[_0xf84705(0x136)][_0xf84705(0x1cb)](_0xf84705(0x216)+_0x25aa50['message']),this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':![],'error':_0x25aa50[_0xf84705(0x137)]},_0x37d585[_0xf84705(0xe1)]);}else{if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0x156))try{const _0x5ee2a7=_0x37d585[_0xf84705(0x137)][_0xf84705(0x126)];if(!_0x5ee2a7||!Array[_0xf84705(0x100)](_0x5ee2a7))throw new Error('Invalid\x20matrix\x20data');const _0x30d3b6=await this[_0xf84705(0x123)]('analysis.topology.structure');if(_0x30d3b6&&_0x30d3b6[_0xf84705(0x10e)]){const _0x2ad6dd=JSON['parse'](_0x30d3b6[_0xf84705(0x10e)]);_0x2ad6dd['matrix']=_0x5ee2a7,_0x2ad6dd['updated']=Date[_0xf84705(0x20c)](),await this[_0xf84705(0x135)](_0xf84705(0x1a0),{'val':JSON['stringify'](_0x2ad6dd),'ack':!![]}),this['log'][_0xf84705(0x1eb)](_0xf84705(0x210)),this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![]},_0x37d585[_0xf84705(0xe1)]);}else throw new Error(_0xf84705(0x21f));}catch(_0x19ebd7){this[_0xf84705(0x136)][_0xf84705(0x1cb)](_0xf84705(0x139)+_0x19ebd7['message']),this[_0xf84705(0x20b)](_0x37d585['from'],_0x37d585[_0xf84705(0x1b3)],{'success':![],'error':_0x19ebd7[_0xf84705(0x137)]},_0x37d585[_0xf84705(0xe1)]);}else{if(_0x37d585['command']===_0xf84705(0x14e))try{const _0x322aa0=_0x37d585[_0xf84705(0x137)]['command'],_0x30a063=_0x37d585['message'];this[_0xf84705(0x136)][_0xf84705(0x1eb)](_0xf84705(0x133)+_0x322aa0),pythonBridge[_0xf84705(0x23e)](this,_0x322aa0,_0x30a063,_0x5cf597=>{const _0x4a5fbb=_0xf84705;this[_0x4a5fbb(0x20b)](_0x37d585[_0x4a5fbb(0x1dd)],_0x37d585[_0x4a5fbb(0x1b3)],_0x5cf597,_0x37d585[_0x4a5fbb(0xe1)]);});}catch(_0x2caf7a){this[_0xf84705(0x136)][_0xf84705(0x1cb)]('pythonBridge\x20command\x20failed:\x20'+_0x2caf7a[_0xf84705(0x137)]),this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'type':_0xf84705(0x12e),'payload':_0x2caf7a[_0xf84705(0x137)]},_0x37d585['callback']);}else{if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0x22b))try{const _0x5e5ef3=_0x37d585[_0xf84705(0x137)]?_0x37d585['message'][_0xf84705(0x248)]:'';if(!_0x5e5ef3)throw new Error(_0xf84705(0x102));const _0x3e43bf=new GoogleGenerativeAI(_0x5e5ef3),_0x3f22c5=_0x3e43bf[_0xf84705(0x1d4)]({'model':GEMINI_MODEL}),_0x1e36aa=await _0x3f22c5['generateContent'](_0xf84705(0x167)),_0x81ca15=await _0x1e36aa[_0xf84705(0x138)],_0xa92a58=_0x81ca15['text']();this['sendTo'](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![],'message':_0xf84705(0x1fc)+_0xa92a58[_0xf84705(0x13d)](0x0,0x14)+_0xf84705(0x20f)},_0x37d585[_0xf84705(0xe1)]);}catch(_0x32e0fe){this[_0xf84705(0x20b)](_0x37d585[_0xf84705(0x1dd)],_0x37d585['command'],{'success':![],'message':_0x32e0fe[_0xf84705(0x137)]},_0x37d585['callback']);}else{if(_0x37d585[_0xf84705(0x1b3)]===_0xf84705(0x14a))try{const _0x5463f2=await this[_0xf84705(0x15e)](),_0x1ed685=await this[_0xf84705(0x1af)](_0xf84705(0x109),_0xf84705(0x1bf),{'startkey':_0xf84705(0x170),'endkey':_0xf84705(0x195)}),_0x334527=_0x1ed685&&_0x1ed685[_0xf84705(0x128)]?_0x1ed685['rows'][_0xf84705(0x19b)]:0x0;this['sendTo'](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':!![],'weather':'Sonne:\x20'+_0x5463f2+_0xf84705(0x1ab)+(this[_0xf84705(0x22e)][this[_0xf84705(0x217)][_0xf84705(0xe8)]]||'?')+'Â°C','calendar':_0x334527+'\x20Kalender-Adapter\x20gefunden.'},_0x37d585[_0xf84705(0xe1)]);}catch(_0x12059f){this['sendTo'](_0x37d585[_0xf84705(0x1dd)],_0x37d585[_0xf84705(0x1b3)],{'success':![]},_0x37d585[_0xf84705(0xe1)]);}}}}}}}}}}}}}[a0_0x4abb78(0x14c)](){const _0x3c4ec9=a0_0x4abb78;if(!this[_0x3c4ec9(0xdc)][_0x3c4ec9(0x1ec)])return;this['log'][_0x3c4ec9(0x1eb)](_0x3c4ec9(0xdb));try{const _0x542b54=this[_0x3c4ec9(0x196)]||[];pythonBridge['send'](this,_0x3c4ec9(0x1de),{'events':_0x542b54});}catch(_0x34bdac){this[_0x3c4ec9(0x136)][_0x3c4ec9(0x1cb)]('Failed\x20to\x20trigger\x20Python\x20Health\x20Check');}}async['onStateChange'](_0x55d98b,_0x2d917e){const _0x594690=a0_0x4abb78;if(!_0x2d917e||this[_0x594690(0x1dc)])return;if(_0x55d98b['includes'](_0x594690(0x165))&&_0x55d98b['endsWith'](_0x594690(0x11f))&&_0x2d917e[_0x594690(0x10e)])return;if(this[_0x594690(0x217)][_0x594690(0x1d7)]&&_0x55d98b===this[_0x594690(0x217)][_0x594690(0xf7)]&&this['activeModules'][_0x594690(0x115)]){this[_0x594690(0xd2)](_0x2d917e[_0x594690(0x10e)]);return;}if(_0x2d917e[_0x594690(0x169)]&&_0x55d98b['endsWith']('pulse'))return;if(_0x55d98b===this['namespace']+'.system.mode'){if(_0x2d917e[_0x594690(0x10e)]&&Object[_0x594690(0xe3)](setup[_0x594690(0x10f)])['includes'](_0x2d917e[_0x594690(0x10e)])){this['currentSystemMode']=_0x2d917e['val'];if(_0x2d917e['val']===setup[_0x594690(0x10f)][_0x594690(0x1c3)])await recorder[_0x594690(0x105)](this,![]);else await recorder[_0x594690(0x105)](this,!![]);if(this[_0x594690(0x221)]){let _0x585adb=![],_0x49eeac=0x0,_0x43d1e3=_0x594690(0x16f);if(this[_0x594690(0x163)]===_0x594690(0x1b9))_0x585adb=!![],_0x49eeac=0x168,_0x43d1e3=_0x594690(0x140);else this[_0x594690(0x163)]===_0x594690(0x127)&&(_0x585adb=!![],_0x49eeac=0x5a0,_0x43d1e3=_0x594690(0x1a8));pythonBridge[_0x594690(0x23e)](this,'SET_LEARNING_MODE',{'active':_0x585adb,'duration':_0x49eeac,'label':_0x43d1e3}),await this['setStateAsync'](_0x594690(0x203),{'val':JSON[_0x594690(0xe0)]({'active':_0x585adb,'label':_0x43d1e3,'timestamp':Date['now']()}),'ack':!![]});}}if(!_0x2d917e[_0x594690(0x169)])this[_0x594690(0x1c4)](_0x55d98b,{'val':this[_0x594690(0x163)],'ack':!![]});return;}if(_0x55d98b[_0x594690(0x14d)](_0x594690(0x154))&&_0x2d917e['ack'])this[_0x594690(0xec)](_0x2d917e[_0x594690(0x10e)]);if(_0x55d98b[_0x594690(0x14d)](_0x594690(0x1aa))&&_0x2d917e['ack']&&this[_0x594690(0xdc)][_0x594690(0x118)])automation[_0x594690(0x1db)](this);if(!_0x2d917e[_0x594690(0x169)]){if(_0x55d98b[_0x594690(0x1d8)](_0x594690(0xe5))&&_0x2d917e[_0x594690(0x10e)]){this[_0x594690(0x1c4)](_0x55d98b,{'val':![],'ack':!![]}),aiAgent[_0x594690(0x182)](this);return;}if(_0x55d98b[_0x594690(0x1d8)](_0x594690(0x1bb))&&_0x2d917e[_0x594690(0x10e)]){this[_0x594690(0x1c4)](_0x55d98b,{'val':![],'ack':!![]});if(this[_0x594690(0x221)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x55d98b[_0x594690(0x1d8)](_0x594690(0x1a9))&&_0x2d917e['val']){this[_0x594690(0x1c4)](_0x55d98b,{'val':![],'ack':!![]}),aiAgent[_0x594690(0x11c)](this);return;}if(_0x55d98b[_0x594690(0x1d8)](_0x594690(0x120))&&_0x2d917e[_0x594690(0x10e)]){this['setState'](_0x55d98b,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x55d98b[_0x594690(0x1d8)](_0x594690(0x13f))&&_0x2d917e[_0x594690(0x10e)]){this[_0x594690(0x1c4)](_0x55d98b,{'val':![],'ack':!![]});if(this[_0x594690(0x221)])try{const _0x438dc0=await this[_0x594690(0x123)](_0x594690(0x1ef));if(_0x438dc0&&_0x438dc0[_0x594690(0x10e)]){const _0x3a7c04=JSON[_0x594690(0x1c9)](_0x438dc0[_0x594690(0x10e)]);this[_0x594690(0x135)](_0x594690(0x186),{'val':'Sec-Training\x20started...','ack':!![]}),pythonBridge[_0x594690(0x23e)](this,_0x594690(0x119),{'sequences':_0x3a7c04});}}catch(_0x19edcd){}return;}if(_0x55d98b[_0x594690(0x1d8)](_0x594690(0xf4))&&_0x2d917e[_0x594690(0x10e)]){this['setState'](_0x55d98b,{'val':![],'ack':!![]});try{aiAgent[_0x594690(0x191)](this,'NIGHT'),setTimeout(()=>aiAgent[_0x594690(0x191)](this,'DAY'),0x2ee0);if(this[_0x594690(0x221)]){this[_0x594690(0x14c)]();const _0x5b7526=await this[_0x594690(0x123)](_0x594690(0x1fe));if(_0x5b7526&&_0x5b7526[_0x594690(0x10e)])pythonBridge['send'](this,_0x594690(0x247),{'digests':JSON[_0x594690(0x1c9)](_0x5b7526['val'])});}}catch(_0x4320c4){this[_0x594690(0x136)][_0x594690(0x1cb)]('triggerHealth\x20error:\x20'+_0x4320c4['message']);}return;}if(_0x55d98b['includes'](_0x594690(0x1a6))&&_0x2d917e[_0x594690(0x10e)]){this['setState'](_0x55d98b,{'val':![],'ack':!![]}),await this[_0x594690(0x1f9)]();return;}if(_0x55d98b[_0x594690(0x1d8)](_0x594690(0x20e))&&_0x2d917e[_0x594690(0x10e)]){this['setState'](_0x55d98b,{'val':![],'ack':!![]});if(this[_0x594690(0x221)])try{const _0x56a723=await this['getStateAsync']('LTM.rawEventLog');if(_0x56a723&&_0x56a723[_0x594690(0x10e)]){const _0x95eebb={};if(this[_0x594690(0x217)][_0x594690(0x1bc)])this[_0x594690(0x217)][_0x594690(0x1bc)][_0x594690(0x220)](_0x36cf5b=>{const _0x3ece5f=_0x594690;if(_0x36cf5b['id']&&_0x36cf5b[_0x3ece5f(0x14f)])_0x95eebb[_0x36cf5b['id']]=_0x36cf5b[_0x3ece5f(0x14f)];});pythonBridge[_0x594690(0x23e)](this,_0x594690(0x179),{'events':JSON[_0x594690(0x1c9)](_0x56a723['val']),'deviceMap':_0x95eebb});}}catch(_0x53218a){}return;}if(_0x55d98b['includes'](_0x594690(0x17a))&&_0x2d917e[_0x594690(0x10e)]){this['setState'](_0x55d98b,{'val':![],'ack':!![]}),topology[_0x594690(0xeb)](this);if(this[_0x594690(0x221)])try{const _0x353ac4=await this[_0x594690(0x123)](_0x594690(0x1ef));if(_0x353ac4&&_0x353ac4[_0x594690(0x10e)])pythonBridge[_0x594690(0x23e)](this,_0x594690(0x1f8),{'sequences':JSON['parse'](_0x353ac4['val'])});}catch(_0x33c20b){}return;}}const _0x5774f3=(this[_0x594690(0x217)][_0x594690(0x1bc)]||[])[_0x594690(0x23a)](_0x556ca9=>_0x556ca9['id']===_0x55d98b);if(_0x5774f3){const _0x4e954a=await recorder['processSensorEvent'](this,_0x55d98b,_0x2d917e,_0x5774f3);_0x4e954a&&this[_0x594690(0x1c4)](_0x594690(0x10c),{'val':Date[_0x594690(0x20c)](),'ack':!![]});_0x4e954a&&_0x4e954a[_0x594690(0x14f)]===_0x594690(0x199)&&_0x4e954a[_0x594690(0x161)]&&this[_0x594690(0x221)]&&deadMan[_0x594690(0x1ee)](this,_0x4e954a[_0x594690(0x161)]);_0x2d917e[_0x594690(0x10e)]&&(_0x2d917e[_0x594690(0x10e)]===!![]||_0x2d917e[_0x594690(0x10e)]===0x1||String(_0x2d917e[_0x594690(0x10e)])[_0x594690(0x18f)]()===_0x594690(0xf3))&&(_0x5774f3[_0x594690(0x14f)]&&(_0x5774f3[_0x594690(0x14f)][_0x594690(0x1d8)](_0x594690(0x11e))||_0x5774f3[_0x594690(0x14f)][_0x594690(0x1d8)]('door'))&&this[_0x594690(0x162)](_0x5774f3));if(_0x5774f3[_0x594690(0x14f)]===_0x594690(0x1f7)||_0x5774f3[_0x594690(0x14f)]===_0x594690(0x223)){if(this[_0x594690(0xdc)][_0x594690(0x118)])automation[_0x594690(0x130)](this);}}}async[a0_0x4abb78(0xec)](_0x3d39a7){const _0x399485=a0_0x4abb78;if(!this[_0x399485(0x1b6)]||Date['now']()-this['bootTime']>0x493e0)return;try{const _0x3ec62b=JSON[_0x399485(0x1c9)](_0x3d39a7),_0x56c76a=this['memoryCache'][_0x399485(0x232)];let _0x491096=![];for(const _0x346705 in _0x56c76a){if(_0x56c76a[_0x346705][_0x399485(0x1d8)]('AI')&&_0x3ec62b[_0x346705]&&!_0x3ec62b[_0x346705][_0x399485(0x1d8)]('AI')){_0x491096=!![];break;}}_0x491096&&(await this['setStateAsync'](_0x399485(0x1aa),{'val':JSON[_0x399485(0xe0)](this['memoryCache'][_0x399485(0xe9)]),'ack':!![]}),await this[_0x399485(0x135)](_0x399485(0x154),{'val':JSON[_0x399485(0xe0)](this['memoryCache'][_0x399485(0x232)]),'ack':!![]}));}catch(_0x4153c3){}}async[a0_0x4abb78(0x16e)](){const _0x18681a=a0_0x4abb78;try{const _0xfb7c4=await this[_0x18681a(0x123)](setup['SYSTEM_DP_MODE']);if(_0xfb7c4&&_0xfb7c4['val'])this[_0x18681a(0x163)]=_0xfb7c4[_0x18681a(0x10e)];}catch(_0x2a8b00){this[_0x18681a(0x163)]=setup[_0x18681a(0x10f)][_0x18681a(0x22a)];}}async[a0_0x4abb78(0x18d)](){const _0x26ff60=a0_0x4abb78,_0x389b59=this[_0x26ff60(0x217)][_0x26ff60(0x173)]||[];if(_0x389b59['length']===0x0)return![];const _0x225010=[],_0x6956c=Date[_0x26ff60(0x20c)](),_0x2e97ac=0x5*0x3c*0x3e8;for(const _0xe80fed of _0x389b59){try{let _0x41a215=![];try{const _0x71da64=await this[_0x26ff60(0x224)](_0xe80fed+_0x26ff60(0x15a));if(_0x71da64&&_0x71da64['val']===!![])_0x41a215=!![];}catch(_0x5b373a){}if(!_0x41a215)try{const _0x212664=await this['getForeignStateAsync'](_0xe80fed+_0x26ff60(0x11b));if(_0x212664&&_0x212664['ts']){const _0x4c5594=_0x6956c-_0x212664['ts'];if(_0x4c5594<_0x2e97ac)_0x41a215=!![];}}catch(_0x2dbb69){}if(!_0x41a215)try{const _0x2a5dd7=await this[_0x26ff60(0x224)](_0xe80fed+_0x26ff60(0x211));if(_0x2a5dd7&&typeof _0x2a5dd7[_0x26ff60(0x10e)]==='number'&&_0x2a5dd7[_0x26ff60(0x10e)]>0x0)_0x41a215=!![];}catch(_0x28cf5a){}if(!_0x41a215)try{const _0x5cac9e=await this['getForeignStateAsync'](_0xe80fed);if(_0x5cac9e){const _0x4e4a6e=_0x6956c-(_0x5cac9e['ts']||0x0);_0x4e4a6e<_0x2e97ac&&(_0x5cac9e['val']===!![]||_0x5cac9e[_0x26ff60(0x10e)]===_0x26ff60(0xf8)||_0x5cac9e['val']===0x1)&&(_0x41a215=!![]);}}catch(_0x11fce3){}if(_0x41a215){const _0x525385=_0xe80fed[_0x26ff60(0xfb)]('.'),_0xef4af9=_0x525385[_0x525385[_0x26ff60(0x19b)]-0x1]||_0xe80fed;_0x225010['push'](_0xef4af9);}}catch(_0x52ec4f){this[_0x26ff60(0x136)][_0x26ff60(0x1cb)]('checkWifiPresence:\x20Error\x20checking\x20'+_0xe80fed+':\x20'+_0x52ec4f[_0x26ff60(0x137)]);}}const _0xceabf9=_0x225010[_0x26ff60(0x19b)]>0x0?_0x225010[_0x26ff60(0x112)](',\x20'):_0x26ff60(0x236);return await this['setStateAsync'](_0x26ff60(0x103),{'val':_0xceabf9,'ack':!![]}),_0x225010['length']>0x0;}async['runAutopilot'](){const _0x46ee8c=a0_0x4abb78;await aiAgent[_0x46ee8c(0x182)](this);this['activeModules'][_0x46ee8c(0x1ec)]&&(this[_0x46ee8c(0x1a5)](),this[_0x46ee8c(0x176)]());if(this['activeModules']['energy'])this[_0x46ee8c(0x1f9)]();}async[a0_0x4abb78(0x15e)](){const _0x50c728=a0_0x4abb78,_0x2c6326=[_0x50c728(0x11a),'accuweather.0',_0x50c728(0x20a)],_0x3a717c=[_0x50c728(0x21b),_0x50c728(0x134),_0x50c728(0x19e)];for(const _0x5d2b0c of _0x2c6326){for(const _0x3dc9be of _0x3a717c){try{const _0x50f722=_0x5d2b0c+'.'+_0x3dc9be,_0x2adbdd=await this['getForeignStateAsync'](_0x50f722);if(_0x2adbdd&&_0x2adbdd[_0x50c728(0x10e)]){const _0x513377=String(_0x2adbdd[_0x50c728(0x10e)])[_0x50c728(0x18f)]();if(_0x513377['includes'](_0x50c728(0x148))||_0x513377[_0x50c728(0x1d8)]('heiter')||_0x513377[_0x50c728(0x1d8)](_0x50c728(0x1b7))||_0x513377[_0x50c728(0x1d8)](_0x50c728(0x11d))||_0x513377['includes'](_0x50c728(0x145)))return this[_0x50c728(0x136)][_0x50c728(0x1eb)]('â˜€ï¸\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20'+_0x50f722),!![];}}catch(_0x27dc4c){}}}return![];}[a0_0x4abb78(0x176)](){const _0x53af73=a0_0x4abb78;if(!this[_0x53af73(0x221)])return;try{this[_0x53af73(0x123)]('LTM.trainingData.sequences',(_0x1dc527,_0x51b9f6)=>{const _0x22904d=_0x53af73;if(_0x1dc527||!_0x51b9f6||!_0x51b9f6[_0x22904d(0x10e)])return;try{const _0x4be075=JSON[_0x22904d(0x1c9)](_0x51b9f6[_0x22904d(0x10e)]);if(!_0x4be075||_0x4be075['length']===0x0)return;pythonBridge[_0x22904d(0x23e)](this,'ANALYZE_GAIT',{'sequences':_0x4be075}),this[_0x22904d(0x136)][_0x22904d(0x1eb)](_0x22904d(0x178)+_0x4be075[_0x22904d(0x19b)]+'\x20sequences');}catch(_0x2b6a3b){this['log'][_0x22904d(0x1cb)]('triggerGaitAnalysis\x20parse\x20error:\x20'+_0x2b6a3b['message']);}});}catch(_0x334422){this[_0x53af73(0x136)][_0x53af73(0x1cb)]('triggerGaitAnalysis\x20error:\x20'+_0x334422['message']);}}async[a0_0x4abb78(0x1f9)](){const _0x5c9013=a0_0x4abb78;if(!this[_0x5c9013(0x221)]||!this[_0x5c9013(0xdc)][_0x5c9013(0x118)])return;try{const _0x117a45={},_0xfd7a0={},_0x13047a=this['config']['devices']||[];for(const _0x1522d7 of _0x13047a){if((_0x1522d7[_0x5c9013(0x14f)]==='temperature'||_0x1522d7[_0x5c9013(0x14f)]===_0x5c9013(0x223))&&_0x1522d7['location'])try{const _0x4baaca=await this[_0x5c9013(0x224)](_0x1522d7['id']);_0x4baaca&&typeof _0x4baaca[_0x5c9013(0x10e)]===_0x5c9013(0xfc)&&(_0x117a45[_0x1522d7[_0x5c9013(0x161)]]=_0x4baaca[_0x5c9013(0x10e)],_0xfd7a0[_0x1522d7[_0x5c9013(0x161)]]=_0x1522d7[_0x5c9013(0x200)]||![]);}catch(_0x54b157){}}let _0x23345a=0xa;if(this[_0x5c9013(0x217)]['weatherTempId'])try{const _0x539e81=await this[_0x5c9013(0x224)](this[_0x5c9013(0x217)][_0x5c9013(0x107)]);if(_0x539e81&&typeof _0x539e81[_0x5c9013(0x10e)]==='number')_0x23345a=_0x539e81['val'];}catch(_0x475444){}const _0x16867e=await this[_0x5c9013(0x15e)]();let _0x4637df={};try{const _0x483581=await this[_0x5c9013(0x123)](_0x5c9013(0x1cf));if(_0x483581&&_0x483581[_0x5c9013(0x10e)])_0x4637df=JSON[_0x5c9013(0x1c9)](_0x483581[_0x5c9013(0x10e)]);}catch(_0x1ec792){}pythonBridge[_0x5c9013(0x23e)](this,_0x5c9013(0x153),{'current_temps':_0x117a45,'t_out':_0x23345a,'is_sunny':_0x16867e,'solar_flags':_0xfd7a0,'warmup_targets':_0x4637df}),this[_0x5c9013(0x136)]['info'](_0x5c9013(0x1d9)+Object[_0x5c9013(0x234)](_0x117a45)[_0x5c9013(0x19b)]+'\x20rooms)');}catch(_0x1081eb){this[_0x5c9013(0x136)][_0x5c9013(0x1cb)](_0x5c9013(0x157)+_0x1081eb[_0x5c9013(0x137)]);}}['updateHealthVector'](){const _0x1430c4=a0_0x4abb78;if(!this[_0x1430c4(0x196)]||this[_0x1430c4(0x196)][_0x1430c4(0x19b)]===0x0)return;const _0x488850=new Array(0x30)[_0x1430c4(0x17d)](0x0),_0x58e8e2=Array[_0x1430c4(0x1dd)]({'length':0x30},()=>[]),_0xd0b8db=new Date()[_0x1430c4(0xd8)](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x1430c4(0x220)](_0x3bfc1a=>{const _0x12cf07=_0x1430c4,_0xec93ef=new Date(_0x3bfc1a[_0x12cf07(0x21a)]);if(_0xec93ef[_0x12cf07(0x166)]()>=_0xd0b8db){const _0x584ee7=_0xec93ef[_0x12cf07(0xfd)](),_0x1960a0=_0xec93ef[_0x12cf07(0x155)](),_0x315042=_0x584ee7*0x2+Math['floor'](_0x1960a0/0x1e);_0x315042>=0x0&&_0x315042<0x30&&(_0x488850[_0x315042]++,_0x58e8e2[_0x315042]['push']({'time':_0xec93ef[_0x12cf07(0x1bd)](_0x12cf07(0x15d),{'hour':'2-digit','minute':_0x12cf07(0x180)}),'location':_0x3bfc1a[_0x12cf07(0x161)]||_0x12cf07(0x1f6),'type':_0x3bfc1a['type']||_0x12cf07(0xdf)}));}}),this['setStateAsync'](_0x1430c4(0x10d),{'val':JSON['stringify'](_0x488850),'ack':!![]}),this[_0x1430c4(0x135)]('analysis.health.todayRoomDetails',{'val':JSON[_0x1430c4(0xe0)](_0x58e8e2),'ack':!![]});}async[a0_0x4abb78(0xd2)](_0xce1fa0){const _0x278c5b=a0_0x4abb78;if(!this[_0x278c5b(0x217)][_0x278c5b(0x1d7)]||typeof _0xce1fa0!=='number')return;const _0x4f90b9=this[_0x278c5b(0x217)][_0x278c5b(0x1a2)]||0.04;this[_0x278c5b(0x108)]['push']({'timestamp':Date[_0x278c5b(0x20c)](),'value':_0xce1fa0}),this[_0x278c5b(0x108)][_0x278c5b(0x19b)]>0x64&&this['pressureBuffer'][_0x278c5b(0x204)](),_0xce1fa0>_0x4f90b9&&!this[_0x278c5b(0x10b)]&&(this[_0x278c5b(0x10b)]=!![],this[_0x278c5b(0x136)][_0x278c5b(0x1cb)]('ðŸ”Š\x20Infraschall-Alarm:\x20'+_0xce1fa0[_0x278c5b(0x233)](0x4)+_0x278c5b(0xdd)+_0x4f90b9+_0x278c5b(0x150)),await this[_0x278c5b(0x213)](_0xce1fa0,_0x278c5b(0x225)),setTimeout(()=>{const _0x3c808c=_0x278c5b;this[_0x3c808c(0x10b)]=![];},0x5*0x3c*0x3e8));}async[a0_0x4abb78(0x213)](_0x2b7ba4,_0x2ddfaa){const _0x1e174a=a0_0x4abb78;if(!this[_0x1e174a(0x208)]){const _0xe00049=this['eventHistory'][_0x1e174a(0x1a4)](0x0,0xa),_0x10701f=_0xe00049[_0x1e174a(0x1d1)](_0x4e3ae3=>new Date(_0x4e3ae3[_0x1e174a(0x21a)])['toLocaleTimeString'](_0x1e174a(0x15d))+_0x1e174a(0x230)+(_0x4e3ae3['location']||_0x1e174a(0x19f))+':\x20'+_0x4e3ae3['name'])[_0x1e174a(0x112)]('\x0a');this[_0x1e174a(0x136)][_0x1e174a(0x1cb)](_0x1e174a(0x1d3)+_0x2b7ba4[_0x1e174a(0x233)](0x4)+',\x20Events:\x0a'+_0x10701f);if(this[_0x1e174a(0x217)]['infrasoundArmingId'])try{const _0x5835fb=await this['getForeignStateAsync'](this[_0x1e174a(0x217)][_0x1e174a(0x244)]);_0x5835fb&&_0x5835fb['val']===!![]&&(await this[_0x1e174a(0x135)](_0x1e174a(0x1e2),{'val':JSON[_0x1e174a(0xe0)]({'timestamp':Date[_0x1e174a(0x20c)](),'pressure':_0x2b7ba4[_0x1e174a(0x233)](0x4),'eventType':_0x2ddfaa,'recentEvents':_0xe00049[_0x1e174a(0x1a4)](0x0,0x3)}),'ack':!![]}),this[_0x1e174a(0x136)][_0x1e174a(0xea)]('ðŸš¨\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!'));}catch(_0x5da6ab){}}else this[_0x1e174a(0x136)]['debug']('ðŸ”Š\x20Infraschall:\x20'+_0x2b7ba4['toFixed'](0x4)+'\x20(Bewohner\x20anwesend\x20-\x20normal)');}async[a0_0x4abb78(0x162)](_0x54b216){const _0x48dd26=a0_0x4abb78;if(!_0x54b216||!_0x54b216['location'])return;try{const _0x5a3d86=(this[_0x48dd26(0x217)][_0x48dd26(0x1bc)]||[])[_0x48dd26(0x1d5)](_0x3f00df=>_0x3f00df[_0x48dd26(0x161)]===_0x54b216[_0x48dd26(0x161)]&&(_0x3f00df[_0x48dd26(0x14f)]===_0x48dd26(0x1f7)||_0x3f00df[_0x48dd26(0x14f)]===_0x48dd26(0x223)));if(_0x5a3d86[_0x48dd26(0x19b)]===0x0)return;const _0x2deb5d=await this[_0x48dd26(0x224)](_0x5a3d86[0x0]['id']);if(!_0x2deb5d||typeof _0x2deb5d[_0x48dd26(0x10e)]!==_0x48dd26(0xfc))return;const _0x5801e1=_0x2deb5d[_0x48dd26(0x10e)];let _0x336000=null;if(this[_0x48dd26(0x217)][_0x48dd26(0x107)]){const _0x57fca3=await this['getForeignStateAsync'](this[_0x48dd26(0x217)]['weatherTempId']);_0x57fca3&&typeof _0x57fca3[_0x48dd26(0x10e)]===_0x48dd26(0xfc)&&(_0x336000=_0x57fca3[_0x48dd26(0x10e)]);}if(_0x336000!==null){const _0x229f0d=Math[_0x48dd26(0x219)](_0x5801e1-_0x336000);_0x229f0d>0x3&&(this[_0x48dd26(0x136)][_0x48dd26(0x1eb)](_0x48dd26(0x1e7)+_0x54b216[_0x48dd26(0x161)]+':\x20Temp-Differenz\x20'+_0x229f0d['toFixed'](0x1)+_0x48dd26(0x101)+_0x5801e1+'Â°C,\x20AuÃŸen:\x20'+_0x336000+_0x48dd26(0x181)),await this[_0x48dd26(0x135)](_0x48dd26(0x111),{'val':JSON['stringify']({'room':_0x54b216[_0x48dd26(0x161)],'timestamp':Date[_0x48dd26(0x20c)](),'tempDiff':_0x229f0d[_0x48dd26(0x233)](0x1),'recommendation':_0x229f0d>0x5?_0x48dd26(0x229):_0x48dd26(0x159)}),'ack':!![]}));}}catch(_0x56bc0e){this[_0x48dd26(0x136)][_0x48dd26(0x1cb)]('analyzeWindowOpening\x20error:\x20'+_0x56bc0e[_0x48dd26(0x137)]);}}async[a0_0x4abb78(0x1ae)](_0x4defcb){const _0x48fda0=a0_0x4abb78;if(!_0x4defcb||typeof _0x4defcb!=='object')return;const _0x3fb257={'timestamp':_0x4defcb[_0x48fda0(0x21a)]||Date[_0x48fda0(0x20c)](),'id':_0x4defcb['id']||Date[_0x48fda0(0x20c)]()['toString'](),'name':_0x4defcb['name']||_0x48fda0(0x197),'type':_0x4defcb['type']||_0x48fda0(0x144),'location':_0x4defcb['location']||_0x48fda0(0x19f),'value':_0x4defcb[_0x48fda0(0x21e)]||null};this[_0x48fda0(0x1f0)][_0x48fda0(0xd4)](_0x3fb257);if(this[_0x48fda0(0x1f0)]['length']>0x1388)this[_0x48fda0(0x1f0)][_0x48fda0(0x12f)]();await this[_0x48fda0(0x135)](_0x48fda0(0x16c),{'val':JSON[_0x48fda0(0xe0)](this['eventHistory']),'ack':!![]}),this[_0x48fda0(0x136)]['debug'](_0x48fda0(0x218)+_0x3fb257[_0x48fda0(0x113)]+'\x20('+_0x3fb257[_0x48fda0(0x161)]+')');}[a0_0x4abb78(0x1c8)](_0x4bff0c){}}if(require[a0_0x4abb78(0x17e)]!==module)module['exports']=_0x8c73b=>new CogniLiving(_0x8c73b);else new CogniLiving();