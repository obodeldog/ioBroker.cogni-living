const a0_0x47451e=a0_0x2486;(function(_0x5cad31,_0x3913e7){const _0x19795b=a0_0x2486,_0x6104b4=_0x5cad31();while(!![]){try{const _0xcb2a5e=-parseInt(_0x19795b(0xbf))/0x1+parseInt(_0x19795b(0x74))/0x2+parseInt(_0x19795b(0xc7))/0x3*(-parseInt(_0x19795b(0xd7))/0x4)+-parseInt(_0x19795b(0x130))/0x5*(parseInt(_0x19795b(0x98))/0x6)+-parseInt(_0x19795b(0xfc))/0x7+-parseInt(_0x19795b(0x1c0))/0x8*(parseInt(_0x19795b(0x205))/0x9)+parseInt(_0x19795b(0x107))/0xa*(parseInt(_0x19795b(0x1ba))/0xb);if(_0xcb2a5e===_0x3913e7)break;else _0x6104b4['push'](_0x6104b4['shift']());}catch(_0x2f0592){_0x6104b4['push'](_0x6104b4['shift']());}}}(a0_0x2fcf,0x63c07));const a0_0x3b9ddb=(function(){let _0x376f2b=!![];return function(_0xe359e9,_0x2348a6){const _0x1ee05d=_0x376f2b?function(){const _0xa27300=a0_0x2486;if(_0x2348a6){const _0x141aea=_0x2348a6[_0xa27300(0x1e7)](_0xe359e9,arguments);return _0x2348a6=null,_0x141aea;}}:function(){};return _0x376f2b=![],_0x1ee05d;};}()),a0_0x5d35a5=a0_0x3b9ddb(this,function(){const _0x427a06=a0_0x2486;return a0_0x5d35a5[_0x427a06(0x134)]()[_0x427a06(0x150)](_0x427a06(0x151))[_0x427a06(0x134)]()[_0x427a06(0x19a)](a0_0x5d35a5)[_0x427a06(0x150)](_0x427a06(0x151));});a0_0x5d35a5();'use strict';function a0_0x2486(_0x30182e,_0x4b964a){const _0x23b874=a0_0x2fcf();return a0_0x2486=function(_0x5d35a5,_0x3b9ddb){_0x5d35a5=_0x5d35a5-0x6c;let _0x2fcf50=_0x23b874[_0x5d35a5];return _0x2fcf50;},a0_0x2486(_0x30182e,_0x4b964a);}const utils=require(a0_0x47451e(0x97)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x47451e(0xe7)),{spawn,exec}=require('child_process'),path=require(a0_0x47451e(0x1b4)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x47451e(0x198),LTM_SCHEDULE=a0_0x47451e(0x110),MODE_RESET_SCHEDULE=a0_0x47451e(0x16f),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x47451e(0x6c),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x47451e(0x16b),LTM_DP_DRIFT_CHANNEL=a0_0x47451e(0x160),LTM_DP_DRIFT_STATUS=a0_0x47451e(0x1c6),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x47451e(0x89),SYSTEM_DP_MODE=a0_0x47451e(0x147),SYSTEM_MODES={'NORMAL':a0_0x47451e(0x1d1),'VACATION':a0_0x47451e(0xf1),'PARTY':'party','GUEST':a0_0x47451e(0x1af)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x47451e(0x175)]],PERSONA_MAPPING={'generic':a0_0x47451e(0x117),'senior_aal':a0_0x47451e(0x1a7),'family':a0_0x47451e(0xdd),'single_comfort':a0_0x47451e(0xca),'security':a0_0x47451e(0x185)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process['platform']==='win32',PERSISTENT_DIR=path[a0_0x47451e(0x14e)](__dirname,a0_0x47451e(0x18e)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path[a0_0x47451e(0x14e)](VENV_PATH,a0_0x47451e(0x1a4),a0_0x47451e(0x7f)):path[a0_0x47451e(0x14e)](VENV_PATH,a0_0x47451e(0x13e),a0_0x47451e(0x7c)),PIP_EXE=IS_WIN?path['join'](VENV_PATH,'Scripts',a0_0x47451e(0x194)):path[a0_0x47451e(0x14e)](VENV_PATH,'bin','pip');let activeSequence=[],sequenceTimer=null;async function startSystem(_0x4138e8){const _0x158cb4=a0_0x47451e;_0x4138e8['log'][_0x158cb4(0xf7)]('ðŸš€\x20Starting\x20System\x20Logic...'),await initZombies(_0x4138e8);try{_0x4138e8[_0x158cb4(0x1fe)]=await checkLicense(_0x4138e8[_0x158cb4(0x1d7)][_0x158cb4(0xac)]);}catch(_0x4a46d6){}if(!_0x4138e8['config']['inactivityThresholdHours']||_0x4138e8[_0x158cb4(0x1d7)]['inactivityThresholdHours']<0.1)_0x4138e8[_0x158cb4(0x1d7)]['inactivityThresholdHours']=0xc;await initHistory(_0x4138e8),await initSystemConfig(_0x4138e8);if(_0x4138e8['config']['geminiApiKey'])try{_0x4138e8[_0x158cb4(0x95)]=new GoogleGenerativeAI(_0x4138e8['config'][_0x158cb4(0x1a0)]),_0x4138e8[_0x158cb4(0xe8)]=_0x4138e8[_0x158cb4(0x95)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),_0x4138e8[_0x158cb4(0xf9)][_0x158cb4(0xf7)](_0x158cb4(0xc2));}catch(_0x6a9f7d){_0x4138e8[_0x158cb4(0xf9)]['error'](_0x158cb4(0x1ee)+_0x6a9f7d[_0x158cb4(0xf8)]);}await createAllObjects(_0x4138e8),await loadSystemMode(_0x4138e8),await loadRawEventLog(_0x4138e8),await loadDailyDigests(_0x4138e8),_0x4138e8['subscribeStates'](_0x158cb4(0x182)),_0x4138e8[_0x158cb4(0x137)](LTM_DP_TRIGGER_DIGEST),_0x4138e8[_0x158cb4(0x137)](_0x158cb4(0x147)),_0x4138e8['subscribeStates'](_0x158cb4(0x1f7)),_0x4138e8['subscribeStates'](_0x158cb4(0xe4)),_0x4138e8[_0x158cb4(0x137)](_0x158cb4(0x94)),_0x4138e8['subscribeStates'](_0x158cb4(0x188)),_0x4138e8[_0x158cb4(0x137)](_0x158cb4(0xc1)),_0x4138e8[_0x158cb4(0x137)](_0x158cb4(0x79)),await initSensorSubscriptions(_0x4138e8),await initPresenceSubscriptions(_0x4138e8),await setupTelegramListener(_0x4138e8),setTimeout(()=>checkWifiPresence(_0x4138e8),0x1388);if(_0x4138e8['analysisTimer'])clearInterval(_0x4138e8[_0x158cb4(0xa6)]);const _0x18655a=_0x4138e8[_0x158cb4(0x1d7)][_0x158cb4(0x1c2)]||0xf;_0x18655a>0x0&&(_0x4138e8['analysisTimer']=setInterval(()=>{runAutopilot(_0x4138e8);},_0x18655a*0x3c*0x3e8)),setupLtmScheduler(_0x4138e8),setupModeResetScheduler(_0x4138e8),setupDriftAnalysisScheduler(_0x4138e8),setupBriefingScheduler(_0x4138e8),startPythonService(_0x4138e8),setTimeout(()=>{const _0x3dd80d=_0x158cb4;if(_0x4138e8[_0x3dd80d(0x14a)])runPythonHealthCheck(_0x4138e8);},0x1388);}function a0_0x2fcf(){const _0x1c90f3=['eventHistory','âœ…\x20INSTALL\x20SUCCESS.','243ZZnKko','Activity-Level','Reset\x20Sched\x20Error:\x20','Fokus\x20auf\x20Komfort.','activityLevel','modeResetJob','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','System','notifyPushoverInstance','ltmStbWindowDays','analysis.health.trendValue','Kein\x20API\x20Key.','change_percent','subscribeForeignStatesAsync','Trigger\x20Briefing','ðŸ\x20Python\x20Pong','13564itBvTe','indicator.alarm','\x20->\x20','success','payload','NORMAL','Fokus\x20auf\x20Familienroutinen.','notifyPushoverEnabled','Trigger\x20Analysis','generic','Kalender\x20deaktiviert.','analysis.energy.heatingScore','Trigger\x20Action','analysis.automation.triggerAction','HEALTH_RESULT','presenceDevices','node-schedule','geminiModel','dimmer','Trend\x20Value','ltmLtbWindowDays','Target\x20Value','ðŸ”\x20Scanning\x20for\x20devices...','âš ï¸\x20ALARM:\x20','analysis.security.lastScore','longitude','vacation','endsWith','indexOf','triggerDailyDigest','getStateAsync','[RESULT]','info','message','log','Unknown','command','1831662bYmFLv','motion','stdin','analysis.security.lastCheck','dismissAutomation','Anomaly\x20Score','summary','Heating\x20Score','onStateChange','generateContent','AI\x20Training','7099570dPMfmb','alertReason','type','map','Target\x20ID','notifyTelegramEnabled','COGNI_REQUEST_CALL','filter','doors','0\x203\x20*\x20*\x20*','analysis.automation.targetValue','details','.forecast.current.temp','occupancy','send','currentSystemMode','Analysiere\x20ausgewogen.','ðŸš¨\x20EMERGENCY','system.isPresent','Lernphase\x20(','callback','splice','Train\x20Security','weatherInstance','analysis.energy','âŒ\x20INSTALL\x20FAILED:\x20','communicate.request','find','text.alarm','Aktiv\x20(','Health\x20Analysis','switch','Trend','HEALTH_TRAIN_RESULT','setObjectNotExistsAsync','dailyDigests','onMessage','analysis.health','analysis.health.isAnomaly','SECURITY_RESULT','events.history_debug_00','260zEGuyk','BUTLER\x20Execution\x20Error:\x20','COGNI_CONFIRM_OK','\x20=\x20','toString','licht','Missing\x20data','subscribeStates','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','getTime','stdout','analysisHistory','setStateAsync','temperatur','bin','Event\x20History','onReady','ANALYZE_SEQUENCE','getMonth','exitGraceTimer','WiFi\x20Presence\x20detected.','role','trim','system.mode','slice','Energy\x20Intelligence','pythonProcess','delObjectAsync','Description','name','join','toLowerCase','search','(((.+)+)+)+$','VACATION','Error\x20launching\x20Python:\x20','window','Gemini\x20Error:\x20','.\x20WETTER:\x20','analysis.isAlert','heating','channel','shift','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Anomaly\x20Detected','scheduleJob','data','length','LTM.driftAnalysis','analysis.health.trendDiagnosis','logDuplicates','indicator','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','exitTimer','rating','number','Sec-Training\x20started...','briefingEnabled','city','LTM.baselineStatus','PONG','Keine\x20Termine.','.NextHours.Location_1.Day_1.current.temp_value','0\x204\x20*\x20*\x20*','analysis.automation.patternDetected','notifyTelegramRecipient','debug','tÃ¼r','briefingJob','GUEST','\x20Tage)','getObjectAsync','N/A\x20(Learning)','ltmDriftCheckIntervalHours','scanDevices','pop','now','driftDetails','openweathermap','âœ…\x20HEALTH\x20TRAINED.','.\x20KONTEXT:\x20','siren','analysis.trigger','some','systemConfig','PRIORITÃ„T:\x20Sicherheit.','.communicate.request','useWeather','analysis.training.triggerSecurity','Failed:\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','system','isGracePeriodActive','analysis.activitySummary','.venv','.\x20EVENTS:\x20','rmSync','reason','.Current.Temperature','lampe','pip.exe','boolean','sendTo','insulation','models/gemini-flash-latest','exports','constructor','lights','diagnosis','Briefing\x20Sched\x20Error:\x20','val','substring','geminiApiKey','targetId','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','isPresent','Scripts','isAlert','analysis.analysisHistory','PRIORITÃ„T:\x20Gesundheit/AAL.','getForeignStateAsync','TRAIN_SECURITY','ack','Last\x20Check','door','sendToAsync','system.config','guest','triggerBriefing','prÃ¤senz','object','notifyEmailInstance','path','ðŸ§ \x20Triggering\x20Security\x20Training...','\x0aSTB:\x20','cancel','devices','analysis.automation.targetId','22IFUYmG','location','Â°C,\x20','driftAnalysisTimer','string','instance','1233528fKHVrM','python_service','analysisInterval','testApiKey','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','\x20*\x20*\x20*','LTM.driftAnalysis.baselineDrift','testContext','Restoring\x20sensor\x20cache...','status','events.history','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','Alert\x20Status','onUnload','outdoorSensorId','âš ï¸\x20SECURITY\x20ALARM:\x20','normal','from','light','fenster','baselineDrift','replace','config','Auto\x20Apply','Raw\x20Log','is_anomaly','analysis.training','stringify','LTM.trainingData.thermodynamics','warn','Digest','.Current.WeatherText','writable','âš ï¸\x20Python\x20VENV\x20missing.\x20Installing\x20locally...','split','isExit','automationProposal','analysis.automation.description','apply','includes','toISOString','daswetter','system.presenceWho','Err:\x20','startsWith','Gemini\x20Init\x20Error:\x20','button','analysis.energy.insulationScore','\x0aGrund:\x20','ðŸ“\x20Feedback\x20received:\x20','System\x20Mode','analysis.health.lastCheck','service.py','Alert\x20Reason','analysis.triggerBriefing','write','Sequences','âŒ\x20VENV\x20FAILED:\x20','ready','forEach','setState','isProVersion','common','toLocaleTimeString','bewegung','systemUUID','Training\x20Status','getForeignObjectAsync','9wQQWZa','events.lastEvent','simulateButler','N/A','description','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','Train\x20Energy','LTM.rawEventLog','enum','getDate','minDaysForBaseline','OK:\x20','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','Who\x20is\x20present?','[RECORDER]\x20Error:\x20','1560438RgyjTk','notifyPushoverRecipient','notifyEmailEnabled','getForeignObjectsAsync','error','analysis.training.triggerEnergy','kill','ltmJob','python','getLtmData','useCalendar','python.exe','No\x20instance','main','analysis.security.currentThreshold','.\x20EMERGENCY:\x20','.\x20SYSTEM_MODE:\x20','Kein\x20API\x20Key!','Last\x20raw\x20event','detected','livingContext','LTM.driftAnalysis.lastCheck','Success','threshold','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','push','value','Success:\x20','bind','unshift','.forecast.current.temperature','Security\x20Monitor','analysis.automation.autoApply','genAI','existsSync','@iobroker/adapter-core','38814BiNsit','sound','python3\x20-m\x20venv\x20\x22','getHours','Skipped\x20(No\x20AI\x20or\x20Data)','json','ANALYZE_HEALTH','Thermodynamics','TREND_RESULT','briefingTime','Started...','unknown','.\x20ANWESEND:\x20','lastAlertState','analysisTimer','parse','analysis.history_debug_00','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','toFixed','ANOMALY','licenseKey','User\x20dismissed\x20automation\x20proposal.','online','sensorLastValues','contact','Cogni-Living','temperature','timestamp','analysis.alertReason','response','targetValue','klima','dependencyInstallInProgress','state','analysis.training.status','extendObjectAsync','getEnums','rawEventLog','round','764634nmfGiC','LTM.trainingData.sequences','analysis.training.triggerHealth','Gemini\x20AI\x20initialized.','date','text'];a0_0x2fcf=function(){return _0x1c90f3;};return a0_0x2fcf();}async function runAutopilot(_0x276cb9){const _0x2265dc=a0_0x47451e;_0x276cb9[_0x2265dc(0xf9)]['debug'](_0x2265dc(0x1cc)),await runGeminiAnalysis(_0x276cb9);}async function scanForDevices(_0x4e28b9,_0x1826f1){const _0x33b99b=a0_0x47451e;_0x4e28b9[_0x33b99b(0xf9)][_0x33b99b(0xf7)](_0x33b99b(0xed));const _0x206f4f=[],_0x1d16b4=await _0x4e28b9[_0x33b99b(0x77)]('*');for(const _0x31fb22 in _0x1d16b4){const _0x268ec5=_0x1d16b4[_0x31fb22];if(_0x268ec5&&_0x268ec5['common']&&_0x268ec5[_0x33b99b(0x109)]===_0x33b99b(0xb9)){const _0x3a5e16=(_0x268ec5[_0x33b99b(0x1ff)]['name']&&typeof _0x268ec5['common']['name']==='object'?_0x268ec5[_0x33b99b(0x1ff)][_0x33b99b(0x14d)]['de']:_0x268ec5[_0x33b99b(0x1ff)][_0x33b99b(0x14d)])||'',_0xc07850=_0x268ec5[_0x33b99b(0x1ff)][_0x33b99b(0x145)]||'';let _0x465581=null;if(_0x1826f1[_0x33b99b(0xfd)]&&(_0xc07850['includes'](_0x33b99b(0xfd))||_0x3a5e16['toLowerCase']()[_0x33b99b(0x1e8)](_0x33b99b(0x201))))_0x465581=_0x33b99b(0xfd);else{if(_0x1826f1[_0x33b99b(0x10f)]&&(_0xc07850[_0x33b99b(0x1e8)](_0x33b99b(0x1ac))||_0xc07850['includes'](_0x33b99b(0x154))||_0x3a5e16[_0x33b99b(0x14f)]()['includes'](_0x33b99b(0x173))||_0x3a5e16[_0x33b99b(0x14f)]()['includes'](_0x33b99b(0x1d4))))_0x465581='door';else{if(_0x1826f1[_0x33b99b(0x19b)]&&(_0xc07850[_0x33b99b(0x1e8)](_0x33b99b(0x1d3))||_0xc07850[_0x33b99b(0x1e8)]('switch')||_0x3a5e16[_0x33b99b(0x14f)]()[_0x33b99b(0x1e8)](_0x33b99b(0x135))))_0x465581=_0x33b99b(0x1d3);else{if(_0x1826f1[_0x33b99b(0xb2)]&&(_0xc07850['includes']('temperature')||_0x3a5e16[_0x33b99b(0x14f)]()[_0x33b99b(0x1e8)]('temperatur')))_0x465581='temperature';}}}if(_0x465581){let _0x3bd498='';const _0x125f60=_0x31fb22[_0x33b99b(0x1e3)]('.');if(_0x125f60[_0x33b99b(0x15f)]>0x2)_0x3bd498=_0x125f60[0x2];_0x206f4f[_0x33b99b(0x8d)]({'id':_0x31fb22,'name':_0x3a5e16||_0x31fb22,'type':_0x465581,'location':_0x3bd498,'_score':0x32});}}}return _0x206f4f;}async function getWeatherContext(_0x2a28a7){const _0x21f515=a0_0x47451e;if(!_0x2a28a7[_0x21f515(0x1d7)]['useWeather']||!_0x2a28a7[_0x21f515(0x1d7)][_0x21f515(0x11e)])return'Wetterdaten\x20deaktiviert.';try{const _0x1184c1=_0x2a28a7[_0x21f515(0x1d7)]['weatherInstance'];let _0x3719a4=await _0x2a28a7['getForeignStateAsync'](_0x1184c1+_0x21f515(0x192));if(!_0x3719a4)_0x3719a4=await _0x2a28a7[_0x21f515(0x1a8)](_0x1184c1+_0x21f515(0x92));let _0x48b426=await _0x2a28a7[_0x21f515(0x1a8)](_0x1184c1+_0x21f515(0x1e0));if(!_0x48b426)_0x48b426=await _0x2a28a7[_0x21f515(0x1a8)](_0x1184c1+'.forecast.current.state');if(_0x3719a4&&_0x48b426)return _0x3719a4['val']+_0x21f515(0x1bc)+_0x48b426[_0x21f515(0x19e)];}catch(_0xd94ac3){}return'Keine\x20Wetterdaten\x20verfÃ¼gbar.';}async function getCalendarContext(_0x4c4665){const _0x48cf41=a0_0x47451e;if(!_0x4c4665[_0x48cf41(0x1d7)][_0x48cf41(0x7e)]||!_0x4c4665[_0x48cf41(0x1d7)]['calendarInstance'])return _0x48cf41(0xe1);return _0x48cf41(0x16d);}async function getCalendarNames(_0x4c27e3,_0x356e56){return[];}async function saveFeedback(_0x47605d,_0x5b6d6c){const _0x1869ca=a0_0x47451e;_0x47605d['log'][_0x1869ca(0xf7)](_0x1869ca(0x1f2)+_0x5b6d6c[_0x1869ca(0x166)]);}async function sendMorningBriefing(_0x42c765){const _0xf6f263=a0_0x47451e;if(!_0x42c765['geminiModel'])return;try{const _0x2fbe2e=_0xf6f263(0x20a),_0x17cae4=await _0x42c765[_0xf6f263(0xe8)]['generateContent'](_0x2fbe2e),_0xfaa90f=_0x17cae4[_0xf6f263(0xb5)][_0xf6f263(0xc4)]();sendNotification(_0x42c765,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0xfaa90f);}catch(_0x38a90c){_0x42c765[_0xf6f263(0xf9)][_0xf6f263(0x78)]('Briefing\x20Error:\x20'+_0x38a90c[_0xf6f263(0xf8)]);}}function checkAndInstall(_0x1ec63b){const _0x266bbc=a0_0x47451e;if(!fs[_0x266bbc(0x96)](VENV_PATH)||!fs[_0x266bbc(0x96)](PIP_EXE))return _0x1ec63b[_0x266bbc(0xf9)][_0x266bbc(0x1de)](_0x266bbc(0x1e2)),installPythonDependencies(_0x1ec63b),![];return!![];}function installPythonDependencies(_0x36e389){const _0x2cdaaf=a0_0x47451e;if(_0x36e389[_0x2cdaaf(0xb8)])return;_0x36e389[_0x2cdaaf(0xb8)]=!![];const _0x2039b8=path[_0x2cdaaf(0x14e)](__dirname,'python_service','requirements.txt');stopPythonService(_0x36e389);if(fs['existsSync'](VENV_PATH))try{fs[_0x2cdaaf(0x190)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x20c7c4){}exec(_0x2cdaaf(0x9a)+VENV_PATH+'\x22',_0xe76103=>{const _0x26b706=_0x2cdaaf;if(_0xe76103){_0x36e389[_0x26b706(0xf9)]['error'](_0x26b706(0x1fa)+_0xe76103[_0x26b706(0xf8)]),_0x36e389[_0x26b706(0xb8)]=![];return;}installRequirementsInVenv(_0x36e389,_0x2039b8);});}function installRequirementsInVenv(_0x463304,_0x1d9923){const _0x4ee12f=a0_0x47451e;_0x463304[_0x4ee12f(0xf9)]['info']('Installing\x20pip\x20packages...');const _0x18ea7f='\x22'+PIP_EXE+'\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22'+_0x1d9923+'\x22';exec(_0x18ea7f,{'timeout':0x124f80},(_0x3188b8,_0x9e1951,_0x273bc6)=>{const _0x3df361=_0x4ee12f;_0x463304[_0x3df361(0xb8)]=![],_0x3188b8?_0x463304['log'][_0x3df361(0x78)](_0x3df361(0x120)+(_0x273bc6||_0x3188b8[_0x3df361(0xf8)])):(_0x463304[_0x3df361(0xf9)]['info'](_0x3df361(0xc6)),startSystem(_0x463304));});}async function initZombies(_0x935121){const _0x1e1ba1=a0_0x47451e;try{const _0x3a9218=[_0x1e1ba1(0xa8),_0x1e1ba1(0x12f)];for(const _0xadde76 of _0x3a9218){try{const _0x57edb0=await _0x935121[_0x1e1ba1(0x177)](_0xadde76);if(_0x57edb0)await _0x935121[_0x1e1ba1(0x14b)](_0xadde76);}catch(_0x22838){}}}catch(_0x554576){}}async function checkLicense(_0x219866){return!![];}async function initHistory(_0x32fb55){const _0x5582aa=a0_0x47451e;try{const _0x271da8=await _0x32fb55['getStateAsync'](_0x5582aa(0x1ca));_0x271da8&&_0x271da8[_0x5582aa(0x19e)]&&(_0x32fb55[_0x5582aa(0xc5)]=JSON[_0x5582aa(0xa7)](_0x271da8['val'][_0x5582aa(0x134)]()));}catch(_0xba4c82){_0x32fb55[_0x5582aa(0xc5)]=[];}try{const _0xdc9e24=await _0x32fb55[_0x5582aa(0xf5)](_0x5582aa(0x1a6));if(_0xdc9e24&&_0xdc9e24['val'])_0x32fb55[_0x5582aa(0x13b)]=JSON[_0x5582aa(0xa7)](_0xdc9e24['val']['toString']());}catch(_0x3cc773){_0x32fb55[_0x5582aa(0x13b)]=[];}if(_0x32fb55['eventHistory']&&_0x32fb55[_0x5582aa(0xc5)][_0x5582aa(0x15f)]>0x0){_0x32fb55[_0x5582aa(0xf9)][_0x5582aa(0xf7)](_0x5582aa(0x1c8));for(let _0x4aa6f1=_0x32fb55[_0x5582aa(0xc5)]['length']-0x1;_0x4aa6f1>=0x0;_0x4aa6f1--){const _0x5c2789=_0x32fb55[_0x5582aa(0xc5)][_0x4aa6f1];if(_0x5c2789&&_0x5c2789['id']!==undefined&&_0x5c2789[_0x5582aa(0x8e)]!==undefined)_0x32fb55[_0x5582aa(0xaf)][_0x5c2789['id']]=_0x5c2789[_0x5582aa(0x8e)];}}}async function initSystemConfig(_0x4a787a){const _0x18fc50=a0_0x47451e;try{const _0x406cdf=await _0x4a787a[_0x18fc50(0x204)](_0x18fc50(0x1ae));if(_0x406cdf&&_0x406cdf[_0x18fc50(0x1ff)])_0x4a787a[_0x18fc50(0x184)]={'latitude':_0x406cdf[_0x18fc50(0x1ff)]['latitude']||0x0,'longitude':_0x406cdf[_0x18fc50(0x1ff)][_0x18fc50(0xf0)]||0x0,'city':_0x406cdf['common'][_0x18fc50(0x16a)]||''};}catch(_0x353b16){}}async function createAllObjects(_0x4f4896){const _0x5deab5=a0_0x47451e;await _0x4f4896[_0x5deab5(0xbb)](_0x5deab5(0x18b),{'type':_0x5deab5(0x159),'common':{'name':_0x5deab5(0xce)},'native':{}}),await _0x4f4896[_0x5deab5(0xbb)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x5deab5(0x1f3),'type':_0x5deab5(0x1be),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x5deab5(0xdc)]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)]('system.presenceWho',{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x72),'type':_0x5deab5(0x1be),'role':_0x5deab5(0xc4),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)]('events.lastEvent',{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x86),'type':_0x5deab5(0x1be),'role':_0x5deab5(0x9d),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)]('events.history',{'type':'state','common':{'name':_0x5deab5(0x13f),'type':_0x5deab5(0x1be),'role':_0x5deab5(0x9d),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0xbb)](_0x5deab5(0x1db),{'type':_0x5deab5(0x159),'common':{'name':_0x5deab5(0x106)},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0x188),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x11d),'type':_0x5deab5(0x195),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x4f4896['setObjectNotExistsAsync'](_0x5deab5(0xc1),{'type':_0x5deab5(0xb9),'common':{'name':'Train\x20Health','type':_0x5deab5(0x195),'role':_0x5deab5(0x1ef),'read':!![],'write':!![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0x79),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x20b),'type':_0x5deab5(0x195),'role':_0x5deab5(0x1ef),'read':!![],'write':!![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0xba),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x203),'type':_0x5deab5(0x1be),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0xbb)]('analysis.security',{'type':'channel','common':{'name':_0x5deab5(0x93)},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0xef),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x101),'type':'number','role':_0x5deab5(0x8e),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)]('analysis.security.currentThreshold',{'type':'state','common':{'name':'Current\x20Threshold','type':_0x5deab5(0x167),'role':_0x5deab5(0x8e),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x4f4896['setObjectNotExistsAsync'](_0x5deab5(0xff),{'type':'state','common':{'name':'Last\x20Check','type':'string','role':_0x5deab5(0xc3),'read':!![],'write':![]},'native':{}}),await _0x4f4896['extendObjectAsync'](_0x5deab5(0x12c),{'type':'channel','common':{'name':_0x5deab5(0x125)},'native':{}}),await _0x4f4896['setObjectNotExistsAsync'](_0x5deab5(0x1f4),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x1ab),'type':_0x5deab5(0x1be),'role':_0x5deab5(0xc3),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0x12d),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x15c),'type':'boolean','role':_0x5deab5(0x163),'read':!![],'write':![]},'native':{}}),await _0x4f4896['setObjectNotExistsAsync'](_0x5deab5(0x161),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x127),'type':_0x5deab5(0x1be),'role':_0x5deab5(0xc4),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0xd1),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0xea),'type':_0x5deab5(0x167),'role':_0x5deab5(0x8e),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0xbb)](_0x5deab5(0x11f),{'type':_0x5deab5(0x159),'common':{'name':_0x5deab5(0x149)},'native':{}}),await _0x4f4896['setObjectNotExistsAsync'](_0x5deab5(0x1f0),{'type':_0x5deab5(0xb9),'common':{'name':'Insulation\x20Score','type':_0x5deab5(0x1be),'role':_0x5deab5(0xc4),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0xe2),{'type':'state','common':{'name':_0x5deab5(0x103),'type':_0x5deab5(0x1be),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0xbb)]('LTM',{'type':_0x5deab5(0x159),'common':{'name':'LTM'},'native':{}}),await _0x4f4896[_0x5deab5(0xbb)](LTM_DP_RAW_LOG,{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x1d9),'type':_0x5deab5(0x1be),'role':_0x5deab5(0x9d),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0xbb)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':'Daily\x20Digests','type':_0x5deab5(0x1be),'role':_0x5deab5(0x9d),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0xc0),{'type':'state','common':{'name':_0x5deab5(0x1f9),'type':_0x5deab5(0x1be),'role':_0x5deab5(0x9d),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)]('LTM.trainingData.thermodynamics',{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x9f),'type':_0x5deab5(0x1be),'role':_0x5deab5(0x9d),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0x182),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0xdf),'type':_0x5deab5(0x195),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x4f4896['setObjectNotExistsAsync']('analysis.triggerBriefing',{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0xd5),'type':_0x5deab5(0x195),'role':_0x5deab5(0x1ef),'read':!![],'write':!![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0x157),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x1cd),'type':_0x5deab5(0x195),'role':_0x5deab5(0xd8),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0xb4),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x1f6),'type':_0x5deab5(0x1be),'role':_0x5deab5(0x123),'read':!![],'write':![]},'native':{}}),await _0x4f4896['setObjectNotExistsAsync'](_0x5deab5(0x18d),{'type':_0x5deab5(0xb9),'common':{'name':'Activity\x20Summary','type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)]('analysis.automation.patternDetected',{'type':_0x5deab5(0xb9),'common':{'name':'Pattern\x20Detected','type':_0x5deab5(0x195),'role':_0x5deab5(0x163),'read':!![],'write':![]},'native':{}}),await _0x4f4896['setObjectNotExistsAsync'](_0x5deab5(0x1e6),{'type':'state','common':{'name':_0x5deab5(0x14c),'type':_0x5deab5(0x1be),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0x1b9),{'type':'state','common':{'name':_0x5deab5(0x10b),'type':_0x5deab5(0x1be),'role':_0x5deab5(0xc4),'read':!![],'write':![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0x111),{'type':'state','common':{'name':_0x5deab5(0xec),'type':'string','role':_0x5deab5(0xc4),'read':!![],'write':![]},'native':{}}),await _0x4f4896['setObjectNotExistsAsync'](_0x5deab5(0x94),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0x1d8),'type':_0x5deab5(0x195),'role':_0x5deab5(0x126),'read':!![],'write':!![]},'native':{}}),await _0x4f4896[_0x5deab5(0x129)](_0x5deab5(0xe4),{'type':_0x5deab5(0xb9),'common':{'name':_0x5deab5(0xe3),'type':'boolean','role':_0x5deab5(0x1ef),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0xe0612f){const _0x440392=a0_0x47451e;try{const _0x5b39a3=await _0xe0612f[_0x440392(0xf5)](SYSTEM_DP_MODE);_0x5b39a3&&_0x5b39a3[_0x440392(0x19e)]&&Object['values'](SYSTEM_MODES)[_0x440392(0x1e8)](_0x5b39a3[_0x440392(0x19e)])?_0xe0612f[_0x440392(0x116)]=_0x5b39a3[_0x440392(0x19e)]:(_0xe0612f[_0x440392(0x116)]=SYSTEM_MODES['NORMAL'],await _0xe0612f[_0x440392(0x13c)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x440392(0xdc)],'ack':!![]}));}catch(_0x3c2e0d){_0xe0612f[_0x440392(0x116)]=SYSTEM_MODES[_0x440392(0xdc)];}}async function loadRawEventLog(_0x4a9b1b){const _0x1fb6a2=a0_0x47451e;try{const _0x301032=await _0x4a9b1b['getStateAsync'](LTM_DP_RAW_LOG);if(_0x301032&&_0x301032[_0x1fb6a2(0x19e)])_0x4a9b1b[_0x1fb6a2(0xbd)]=JSON[_0x1fb6a2(0xa7)](_0x301032[_0x1fb6a2(0x19e)]);}catch(_0x5c54bb){_0x4a9b1b['rawEventLog']=[];}}async function saveRawEventLog(_0x1f56b8){const _0x111f31=a0_0x47451e;if(_0x1f56b8[_0x111f31(0xbd)][_0x111f31(0x15f)]>RAW_LOG_MAX_SIZE)_0x1f56b8[_0x111f31(0xbd)][_0x111f31(0x11c)](0x0,_0x1f56b8['rawEventLog'][_0x111f31(0x15f)]-RAW_LOG_MAX_SIZE);await _0x1f56b8[_0x111f31(0x13c)](LTM_DP_RAW_LOG,{'val':JSON[_0x111f31(0x1dc)](_0x1f56b8[_0x111f31(0xbd)]),'ack':!![]});}async function loadDailyDigests(_0x15ae36){const _0x4ba6f2=a0_0x47451e;try{const _0x2ad989=await _0x15ae36['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x2ad989&&_0x2ad989['val'])_0x15ae36[_0x4ba6f2(0x12a)]=JSON[_0x4ba6f2(0xa7)](_0x2ad989[_0x4ba6f2(0x19e)]);}catch(_0x21cc4a){_0x15ae36[_0x4ba6f2(0x12a)]=[];}await updateBaselineStatus(_0x15ae36);}async function saveDailyDigests(_0x3dcc8,_0x7d6d83=!![]){const _0x477e6b=a0_0x47451e,_0x3abe29=_0x3dcc8['config'][_0x477e6b(0xeb)]||0x3c;_0x3dcc8[_0x477e6b(0x12a)][_0x477e6b(0x15f)]>_0x3abe29&&_0x3dcc8['dailyDigests'][_0x477e6b(0x11c)](0x0,_0x3dcc8[_0x477e6b(0x12a)]['length']-_0x3abe29);await _0x3dcc8[_0x477e6b(0x13c)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x477e6b(0x1dc)](_0x3dcc8[_0x477e6b(0x12a)]),'ack':!![]});if(_0x7d6d83)await updateBaselineStatus(_0x3dcc8);}async function updateAnalysisHistory(_0x419da5,_0x36da0e){const _0x127026=a0_0x47451e;_0x419da5['analysisHistory'][_0x127026(0x91)](_0x36da0e);if(_0x419da5[_0x127026(0x13b)][_0x127026(0x15f)]>HISTORY_MAX_SIZE)_0x419da5[_0x127026(0x13b)][_0x127026(0x17b)]();await _0x419da5[_0x127026(0x13c)](_0x127026(0x1a6),{'val':JSON[_0x127026(0x1dc)](_0x419da5[_0x127026(0x13b)]),'ack':!![]});}async function updateBaselineStatus(_0xa132a5){const _0x462ad1=a0_0x47451e;if(!_0xa132a5[_0x462ad1(0x1fe)]){await _0xa132a5['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x1681dd=_0xa132a5[_0x462ad1(0x12a)]['length']>=(_0xa132a5['config'][_0x462ad1(0x6f)]||0x7)?_0x462ad1(0x124)+_0xa132a5[_0x462ad1(0x12a)][_0x462ad1(0x15f)]+_0x462ad1(0x176):_0x462ad1(0x11a)+_0xa132a5[_0x462ad1(0x12a)][_0x462ad1(0x15f)]+'/'+(_0xa132a5['config']['minDaysForBaseline']||0x7)+')';await _0xa132a5['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x1681dd,'ack':!![]});}async function initSensorSubscriptions(_0x41a3a8){const _0x3cd16b=a0_0x47451e,_0x4f782=_0x41a3a8[_0x3cd16b(0x1d7)][_0x3cd16b(0x1b8)];if(_0x4f782)for(const _0x29883e of _0x4f782){await _0x41a3a8[_0x3cd16b(0xd4)](_0x29883e['id']);}}async function initPresenceSubscriptions(_0x2ba08f){const _0x2e056d=a0_0x47451e,_0x573e20=_0x2ba08f['config'][_0x2e056d(0xe6)];if(_0x573e20)for(const _0x148655 of _0x573e20){await _0x2ba08f[_0x2e056d(0xd4)](_0x148655);}}async function setupTelegramListener(_0x16afaa){const _0xa65ecb=a0_0x47451e,_0x12b4d3=_0x16afaa[_0xa65ecb(0x1d7)]['notifyTelegramInstance'];if(_0x16afaa[_0xa65ecb(0x1d7)][_0xa65ecb(0x10c)]&&_0x12b4d3)await _0x16afaa[_0xa65ecb(0xd4)](_0x12b4d3+_0xa65ecb(0x186));}async function checkWifiPresence(_0x4cac3d){const _0x4bb7f1=a0_0x47451e;try{const _0x412b8c=_0x4cac3d[_0x4bb7f1(0x1d7)]['presenceDevices']||[];let _0x38f028=![];const _0x5ba7cd=[];for(const _0x2e3185 of _0x412b8c){try{const _0x4f05f3=await _0x4cac3d['getForeignStateAsync'](_0x2e3185);_0x4f05f3&&(_0x4f05f3['val']===!![]||_0x4f05f3[_0x4bb7f1(0x19e)]===_0x4bb7f1(0xae)||_0x4f05f3[_0x4bb7f1(0x19e)]===0x1)&&(_0x38f028=!![],_0x5ba7cd['push'](_0x2e3185));}catch(_0x2d45e0){}}return await _0x4cac3d[_0x4bb7f1(0x13c)]('system.presenceWho',{'val':_0x5ba7cd[_0x4bb7f1(0x14e)](',\x20'),'ack':!![]}),_0x38f028&&(_0x4cac3d[_0x4bb7f1(0x165)]&&(_0x4cac3d[_0x4bb7f1(0xf9)][_0x4bb7f1(0xf7)](_0x4bb7f1(0x144)),abortExitTimer(_0x4cac3d)),!_0x4cac3d['isPresent']&&_0x4cac3d[_0x4bb7f1(0x116)]===SYSTEM_MODES[_0x4bb7f1(0xdc)]&&await setPresence(_0x4cac3d,!![])),_0x38f028;}catch(_0x92cc01){return![];}}function startExitTimer(_0x8a0ff1){const _0x454d6b=a0_0x47451e;abortExitTimer(_0x8a0ff1),_0x8a0ff1['isGracePeriodActive']=!![],_0x8a0ff1[_0x454d6b(0x143)]=setTimeout(()=>{_0x8a0ff1['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x8a0ff1[_0x454d6b(0x165)]=setTimeout(()=>{const _0x4eb453=_0x454d6b;setPresence(_0x8a0ff1,![]),_0x8a0ff1[_0x4eb453(0x165)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x447551){const _0x12e0f4=a0_0x47451e;if(_0x447551[_0x12e0f4(0x165)])clearTimeout(_0x447551[_0x12e0f4(0x165)]);if(_0x447551[_0x12e0f4(0x143)])clearTimeout(_0x447551[_0x12e0f4(0x143)]);_0x447551[_0x12e0f4(0x165)]=null,_0x447551[_0x12e0f4(0x143)]=null,_0x447551[_0x12e0f4(0x18c)]=![];}async function setPresence(_0x55c191,_0x10b5de){const _0x41318f=a0_0x47451e;if(_0x55c191[_0x41318f(0x1a3)]===_0x10b5de)return;_0x55c191[_0x41318f(0x1a3)]=_0x10b5de,await _0x55c191[_0x41318f(0x13c)](_0x41318f(0x119),{'val':_0x10b5de,'ack':!![]});}async function executeAutomationAction(_0x543205){const _0x334511=a0_0x47451e;try{const _0xa5a24c=await _0x543205[_0x334511(0xf5)]('analysis.automation.targetId'),_0x585f31=await _0x543205[_0x334511(0xf5)](_0x334511(0x111));if(_0xa5a24c&&_0xa5a24c[_0x334511(0x19e)]&&_0x585f31){const _0x5aea01=_0xa5a24c[_0x334511(0x19e)];let _0x314c18=_0x585f31[_0x334511(0x19e)];try{_0x314c18=JSON[_0x334511(0xa7)](_0x314c18);}catch(_0x1037d8){}_0x543205[_0x334511(0xf9)][_0x334511(0xf7)](_0x334511(0x71)+_0x5aea01+_0x334511(0x133)+_0x314c18),await _0x543205['setForeignStateAsync'](_0x5aea01,_0x314c18);}else _0x543205[_0x334511(0xf9)][_0x334511(0x1de)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x36e403){_0x543205[_0x334511(0xf9)]['error'](_0x334511(0x131)+_0x36e403[_0x334511(0xf8)]);}}async function processSensorEvent(_0x42554e,_0x11a2f0,_0x3361cc,_0x33ddcb){const _0x2b015c=a0_0x47451e;if(!_0x33ddcb)return;const _0x41850a=_0x3361cc['val'],_0x346418=Date[_0x2b015c(0x17c)](),_0x2e9a8d=_0x42554e[_0x2b015c(0xaf)][_0x11a2f0];_0x42554e[_0x2b015c(0xaf)][_0x11a2f0]=_0x41850a;if(!_0x33ddcb[_0x2b015c(0x162)]&&_0x2e9a8d!=undefined&&_0x2e9a8d==_0x41850a)return;const _0x1b7a1b=(_0x33ddcb[_0x2b015c(0x109)]||'')[_0x2b015c(0x14f)](),_0x22ec84=_0x1b7a1b[_0x2b015c(0x1e8)](_0x2b015c(0xb2))||_0x1b7a1b['includes'](_0x2b015c(0x13d))||_0x1b7a1b[_0x2b015c(0x1e8)](_0x2b015c(0xb7))||_0x1b7a1b[_0x2b015c(0x1e8)]('heizung');_0x42554e[_0x2b015c(0x1fe)]&&_0x22ec84&&recordThermodynamics(_0x42554e,_0x11a2f0,_0x41850a,_0x33ddcb['location']);const _0x389dac={'timestamp':_0x346418,'id':_0x11a2f0,'name':_0x33ddcb['name'],'type':_0x33ddcb[_0x2b015c(0x109)],'location':_0x33ddcb['location'],'value':_0x41850a};_0x42554e[_0x2b015c(0xc5)][_0x2b015c(0x91)](_0x389dac);if(_0x42554e[_0x2b015c(0xc5)][_0x2b015c(0x15f)]>HISTORY_MAX_SIZE)_0x42554e[_0x2b015c(0xc5)][_0x2b015c(0x17b)]();await _0x42554e[_0x2b015c(0x13c)](_0x2b015c(0x206),{'val':JSON[_0x2b015c(0x1dc)](_0x389dac),'ack':!![]}),await _0x42554e[_0x2b015c(0x13c)](_0x2b015c(0x1ca),{'val':JSON[_0x2b015c(0x1dc)](_0x42554e['eventHistory']),'ack':!![]});_0x42554e[_0x2b015c(0x1fe)]&&(_0x42554e[_0x2b015c(0xbd)][_0x2b015c(0x8d)](_0x389dac),await saveRawEventLog(_0x42554e),recordSequence(_0x42554e,_0x389dac));if(_0x33ddcb[_0x2b015c(0x1e4)]&&_0x41850a===!![]){if(_0x42554e[_0x2b015c(0x1a3)]&&!_0x42554e[_0x2b015c(0x18c)])startExitTimer(_0x42554e);else{if(!_0x42554e[_0x2b015c(0x1a3)])setPresence(_0x42554e,!![]);}}else{if(_0x33ddcb[_0x2b015c(0x109)]===_0x2b015c(0xfd)&&_0x41850a===!![]){if(_0x42554e['exitTimer'])abortExitTimer(_0x42554e);if(!_0x42554e['isPresent']&&_0x42554e['currentSystemMode']===SYSTEM_MODES['NORMAL'])setPresence(_0x42554e,!![]);}}}async function recordThermodynamics(_0x425329,_0x42e5de,_0x4271dd,_0x48a69a){const _0x3d14f9=a0_0x47451e,_0xc70d8=await getOutsideTemperatureNumeric(_0x425329),_0x2223ea=await _0x425329[_0x3d14f9(0xf5)](_0x3d14f9(0x1dd));let _0x483541=[];if(_0x2223ea&&_0x2223ea[_0x3d14f9(0x19e)])try{_0x483541=JSON[_0x3d14f9(0xa7)](_0x2223ea[_0x3d14f9(0x19e)]);}catch(_0x4772d6){}_0x483541['push']({'ts':Date['now'](),'room':_0x48a69a||_0x3d14f9(0xfa),'t_in':_0x4271dd,'t_out':_0xc70d8});if(_0x483541['length']>THERMO_LOG_SIZE)_0x483541[_0x3d14f9(0x15a)]();await _0x425329[_0x3d14f9(0x13c)](_0x3d14f9(0x1dd),{'val':JSON[_0x3d14f9(0x1dc)](_0x483541),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x3a03f0){const _0x2aafaa=a0_0x47451e;if(_0x3a03f0[_0x2aafaa(0x1d7)][_0x2aafaa(0x1cf)])try{const _0x462261=await _0x3a03f0['getForeignStateAsync'](_0x3a03f0[_0x2aafaa(0x1d7)]['outdoorSensorId']);if(_0x462261&&_0x462261[_0x2aafaa(0x19e)]!==undefined&&_0x462261[_0x2aafaa(0x19e)]!==null)return parseFloat(_0x462261['val']);}catch(_0x3cc422){}const _0x16c278=_0x3a03f0['config']['weatherInstance'];if(!_0x3a03f0['config'][_0x2aafaa(0x187)]||!_0x16c278)return null;try{let _0x3b4641='';if(_0x16c278[_0x2aafaa(0x1e8)]('accuweather'))_0x3b4641=_0x16c278+_0x2aafaa(0x192);else{if(_0x16c278[_0x2aafaa(0x1e8)](_0x2aafaa(0x1ea)))_0x3b4641=_0x16c278+_0x2aafaa(0x16e);else{if(_0x16c278[_0x2aafaa(0x1e8)](_0x2aafaa(0x17e)))_0x3b4641=_0x16c278+_0x2aafaa(0x92);else{if(_0x16c278['includes']('weatherunderground'))_0x3b4641=_0x16c278+_0x2aafaa(0x113);}}}if(_0x3b4641){const _0x5dca20=await _0x3a03f0[_0x2aafaa(0x1a8)](_0x3b4641);if(_0x5dca20&&_0x5dca20[_0x2aafaa(0x19e)]!==undefined&&_0x5dca20[_0x2aafaa(0x19e)]!==null)return parseFloat(_0x5dca20[_0x2aafaa(0x19e)]);}}catch(_0x144883){}return null;}async function recordSequence(_0x30c4b3,_0x133948){const _0x33e285=a0_0x47451e,_0x20069d=(_0x133948[_0x33e285(0x109)]||'')[_0x33e285(0x14f)](),_0x472f06=[_0x33e285(0xfd),_0x33e285(0x201),_0x33e285(0x1b1),'presence',_0x33e285(0x114),_0x33e285(0x1ac),'tÃ¼r',_0x33e285(0x154),'fenster',_0x33e285(0xb0),'kontakt','light',_0x33e285(0x135),_0x33e285(0x126),'schalter',_0x33e285(0xe9),_0x33e285(0x193)];if(!_0x472f06[_0x33e285(0x183)](_0x2e1834=>_0x20069d['includes'](_0x2e1834)))return;if(!_0x133948['value'])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x133948[_0x33e285(0x1bb)]||_0x33e285(0xfa),'id':_0x133948['id'],'ts':Date['now']()}),sequenceTimer=setTimeout(async()=>{const _0x23aee6=_0x33e285;if(activeSequence[_0x23aee6(0x15f)]>0x1)await saveCompletedSequence(_0x30c4b3);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x3e7837){const _0x46038a=a0_0x47451e;try{const _0x2ec9b6=await _0x3e7837[_0x46038a(0xf5)](_0x46038a(0xc0));let _0x2c5d6b=[];if(_0x2ec9b6&&_0x2ec9b6[_0x46038a(0x19e)])try{_0x2c5d6b=JSON['parse'](_0x2ec9b6[_0x46038a(0x19e)]);}catch(_0x2e0fb5){}const _0x2fa319=activeSequence[0x0]['ts'],_0x37351f=activeSequence[_0x46038a(0x10a)](_0x3a9e85=>({'loc':_0x3a9e85['loc'],'t_delta':Math[_0x46038a(0xbe)]((_0x3a9e85['ts']-_0x2fa319)/0x3e8)})),_0x4415ff={'timestamp':new Date(_0x2fa319)[_0x46038a(0x1e9)](),'steps':_0x37351f,'duration':Math[_0x46038a(0xbe)]((activeSequence[activeSequence[_0x46038a(0x15f)]-0x1]['ts']-_0x2fa319)/0x3e8),'daytime':new Date(_0x2fa319)[_0x46038a(0x9b)]()};_0x2c5d6b['push'](_0x4415ff);if(_0x2c5d6b[_0x46038a(0x15f)]>MAX_TRAINING_SET_SIZE)_0x2c5d6b[_0x46038a(0x15a)]();await _0x3e7837[_0x46038a(0x13c)](_0x46038a(0xc0),{'val':JSON[_0x46038a(0x1dc)](_0x2c5d6b),'ack':!![]}),runSecurityCheck(_0x3e7837,_0x4415ff);}catch(_0x97c279){_0x3e7837['log'][_0x46038a(0x78)](_0x46038a(0x73)+_0x97c279['message']);}}function runSecurityCheck(_0x3c6937,_0xd0cc7f){const _0x4196fa=a0_0x47451e;if(!_0x3c6937[_0x4196fa(0x1fe)])return;sendToPython(_0x3c6937,_0x4196fa(0x141),{'sequence':_0xd0cc7f});}function sendToPython(_0x1d9d5c,_0x36b9f5,_0x446a32={}){const _0x5afca7=a0_0x47451e;if(!_0x1d9d5c[_0x5afca7(0x14a)]||!_0x1d9d5c[_0x5afca7(0x14a)][_0x5afca7(0xfe)][_0x5afca7(0x1e1)])return;const _0x238e94=JSON[_0x5afca7(0x1dc)]({'command':_0x36b9f5,..._0x446a32});try{_0x1d9d5c[_0x5afca7(0x14a)][_0x5afca7(0xfe)][_0x5afca7(0x1f8)](_0x238e94+'\x0a');}catch(_0x399fec){}}function startPythonService(_0x1f77ff){const _0x2854e8=a0_0x47451e;let _0x2c61ba='python3';if(fs['existsSync'](PYTHON_EXE))_0x2c61ba=PYTHON_EXE;try{const _0xe9140c=path[_0x2854e8(0x14e)](__dirname,_0x2854e8(0x1c1),_0x2854e8(0x1f5));_0x1f77ff[_0x2854e8(0x14a)]=spawn(_0x2c61ba,[_0xe9140c]),_0x1f77ff[_0x2854e8(0x14a)][_0x2854e8(0x13a)]['on'](_0x2854e8(0x15e),_0x16bd2f=>{const _0x5bcbfa=_0x2854e8,_0x1d8246=_0x16bd2f[_0x5bcbfa(0x134)]()['split']('\x0a');_0x1d8246[_0x5bcbfa(0x1fc)](_0x2f342d=>{const _0x138e70=_0x5bcbfa,_0x24cb26=_0x2f342d[_0x138e70(0x146)]();if(!_0x24cb26)return;if(_0x24cb26[_0x138e70(0x1ed)]('[LOG]'))_0x1f77ff['log'][_0x138e70(0x172)]('[PYTHON]\x20'+_0x24cb26[_0x138e70(0x19f)](0x5)['trim']());else{if(_0x24cb26[_0x138e70(0x1ed)](_0x138e70(0xf6)))try{const _0xf7eb54=JSON[_0x138e70(0xa7)](_0x24cb26[_0x138e70(0x19f)](0x8)[_0x138e70(0x146)]());handlePythonResult(_0x1f77ff,_0xf7eb54);}catch(_0x5d71fe){}}});}),_0x1f77ff[_0x2854e8(0x14a)]['on']('close',_0x47c301=>{const _0x5b381a=_0x2854e8;_0x1f77ff[_0x5b381a(0x14a)]=null;});}catch(_0x3d60fb){_0x1f77ff['log'][_0x2854e8(0x78)](_0x2854e8(0x153)+_0x3d60fb['message']);}}function stopPythonService(_0x42b72a){const _0x4dd4e3=a0_0x47451e;if(_0x42b72a[_0x4dd4e3(0x14a)]){try{_0x42b72a['pythonProcess'][_0x4dd4e3(0x7a)]();}catch(_0x55dc9f){}_0x42b72a[_0x4dd4e3(0x14a)]=null;}}function handlePythonResult(_0x46b522,_0x5352a4){const _0x1fc26a=a0_0x47451e;if(_0x5352a4['type']===_0x1fc26a(0x16c))_0x46b522[_0x1fc26a(0xf9)]['debug'](_0x1fc26a(0xd6));else{if(_0x5352a4[_0x1fc26a(0x109)]===_0x1fc26a(0x12e)){const {anomaly_score:_0x5a9e30,is_anomaly:_0x54b977,threshold:_0x4df564,explanation:_0xef9e2c}=_0x5352a4[_0x1fc26a(0xdb)];_0x46b522['log'][_0x1fc26a(0xf7)](_0x1fc26a(0x8c)+_0x5a9e30[_0x1fc26a(0xaa)](0x5)+_0x1fc26a(0xd9)+(_0x54b977?_0x1fc26a(0xab):'OK')),_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0xef),{'val':_0x5a9e30,'ack':!![]}),_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0xff),{'val':new Date()[_0x1fc26a(0x1e9)](),'ack':!![]});if(_0x4df564)_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0x82),{'val':_0x4df564,'ack':!![]});if(_0x54b977){let _0x78ee7e=_0x1fc26a(0xa9)+_0x5a9e30['toFixed'](0x4)+')';if(_0xef9e2c&&_0xef9e2c!=='Unknown')_0x78ee7e+=_0x1fc26a(0x1f1)+_0xef9e2c;_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0x157),{'val':!![],'ack':!![]}),_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0xb4),{'val':_0x78ee7e,'ack':!![]}),sendNotification(_0x46b522,_0x1fc26a(0x1d0)+_0x78ee7e,![],!![]);}}else{if(_0x5352a4['type']==='TRAINING_COMPLETE'){const _0x3188ee=_0x5352a4['payload'][_0x1fc26a(0x112)]||'',_0x47792b=_0x5352a4['payload'][_0x1fc26a(0x8b)],_0x345dcd=_0x5352a4[_0x1fc26a(0xdb)]['success']?_0x1fc26a(0x8f)+new Date()[_0x1fc26a(0x200)]()+'\x20('+_0x3188ee+')':_0x1fc26a(0x189)+_0x5352a4[_0x1fc26a(0xdb)][_0x1fc26a(0x191)];_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0xba),{'val':_0x345dcd,'ack':!![]});if(_0x5352a4[_0x1fc26a(0xdb)][_0x1fc26a(0xda)]&&_0x47792b)_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0x82),{'val':_0x47792b,'ack':!![]});}else{if(_0x5352a4[_0x1fc26a(0x109)]==='ENERGY_TRAIN_RESULT'){if(_0x5352a4['payload']['success'])try{const _0x2aa0f3=JSON['parse'](_0x5352a4[_0x1fc26a(0xdb)][_0x1fc26a(0x112)]);if(_0x2aa0f3['insulation'])_0x46b522[_0x1fc26a(0x13c)]('analysis.energy.insulationScore',{'val':JSON[_0x1fc26a(0x1dc)](_0x2aa0f3[_0x1fc26a(0x197)]),'ack':!![]});if(_0x2aa0f3[_0x1fc26a(0x158)])_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0xe2),{'val':JSON['stringify'](_0x2aa0f3[_0x1fc26a(0x158)]),'ack':!![]});}catch(_0x405c55){}}else{if(_0x5352a4[_0x1fc26a(0x109)]===_0x1fc26a(0x128)){if(_0x5352a4[_0x1fc26a(0xdb)]['success'])_0x46b522['log'][_0x1fc26a(0xf7)](_0x1fc26a(0x17f));}else{if(_0x5352a4[_0x1fc26a(0x109)]===_0x1fc26a(0xe5))_0x46b522[_0x1fc26a(0x13c)]('analysis.health.lastCheck',{'val':new Date()[_0x1fc26a(0x1e9)](),'ack':!![]}),_0x46b522['setStateAsync'](_0x1fc26a(0x12d),{'val':_0x5352a4[_0x1fc26a(0xdb)][_0x1fc26a(0x1da)],'ack':!![]});else _0x5352a4[_0x1fc26a(0x109)]===_0x1fc26a(0xa0)&&(_0x46b522[_0x1fc26a(0x13c)](_0x1fc26a(0x161),{'val':_0x5352a4[_0x1fc26a(0xdb)][_0x1fc26a(0x19c)],'ack':!![]}),_0x46b522['setStateAsync'](_0x1fc26a(0xd1),{'val':_0x5352a4[_0x1fc26a(0xdb)][_0x1fc26a(0xd3)],'ack':!![]}));}}}}}}function runPythonHealthCheck(_0x5c7f24){const _0x1a39d5=a0_0x47451e;if(!_0x5c7f24[_0x1a39d5(0x12a)]||_0x5c7f24[_0x1a39d5(0x12a)][_0x1a39d5(0x15f)]<0x2)return;const _0x5779ea=_0x5c7f24[_0x1a39d5(0x12a)][_0x1a39d5(0x10a)](_0x14a39a=>{const _0x202618=_0x1a39d5,_0x5da6c9=(_0x14a39a[_0x202618(0xcb)]||'')[_0x202618(0x14f)]();return ACTIVITY_LEVEL_MAP[_0x5da6c9]||0x32;});sendToPython(_0x5c7f24,'ANALYZE_TREND',{'values':_0x5779ea,'tag':_0x1a39d5(0xc8)});}async function handleTelegramResponse(_0x22907d,_0x57b40b){const _0x38a5fe=a0_0x47451e;let _0x4b7bdf=_0x57b40b;_0x57b40b['startsWith']('[')&&(_0x4b7bdf=_0x57b40b[_0x38a5fe(0x19f)](_0x57b40b[_0x38a5fe(0xf3)](']')+0x1));if(_0x4b7bdf===_0x38a5fe(0x132))await _0x22907d[_0x38a5fe(0x13c)](_0x38a5fe(0x157),{'val':![],'ack':!![]}),await _0x22907d[_0x38a5fe(0x13c)](_0x38a5fe(0xb4),{'val':_0x38a5fe(0x1cb),'ack':!![]}),_0x22907d[_0x38a5fe(0xa5)]=![],sendNotification(_0x22907d,_0x38a5fe(0x1c4),![]);else _0x4b7bdf==='COGNI_REQUEST_CALL'&&sendNotification(_0x22907d,_0x38a5fe(0x138),![],!![]);}async function sendNotification(_0x3f1fbb,_0xd6a8a1,_0x261476=![],_0x13a47c=![]){const _0x59281e=a0_0x47451e,_0x5c8d20=_0x3f1fbb['config'];if(_0x5c8d20[_0x59281e(0x10c)]){let _0x5aa02b={};(_0xd6a8a1[_0x59281e(0x1e8)]('Alarm')||_0x13a47c)&&(_0x5aa02b={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':_0x59281e(0x132)}],[{'text':_0x59281e(0x164),'callback_data':_0x59281e(0x10d)}]]}}),await _0x3f1fbb[_0x59281e(0x1ad)](_0x5c8d20['notifyTelegramInstance'],'send',{'text':_0xd6a8a1,'user':_0x5c8d20[_0x59281e(0x171)],..._0x5aa02b});}if(_0x5c8d20[_0x59281e(0xde)]){let _0x5194ac={'message':_0xd6a8a1,'title':_0x13a47c?_0x59281e(0x118):_0x59281e(0xb1),'priority':_0x13a47c?0x2:0x1,'device':_0x5c8d20[_0x59281e(0x75)]};_0x13a47c&&(_0x5194ac['retry']=0x1e,_0x5194ac['expire']=0xe10,_0x5194ac[_0x59281e(0x99)]=_0x59281e(0x181)),await _0x3f1fbb[_0x59281e(0x1ad)](_0x5c8d20[_0x59281e(0xcf)],'send',_0x5194ac);}_0x5c8d20[_0x59281e(0x76)]&&await _0x3f1fbb[_0x59281e(0x1ad)](_0x5c8d20[_0x59281e(0x1b3)],_0x59281e(0x115),{'text':_0xd6a8a1,'to':_0x5c8d20['notifyEmailRecipient']});}async function runGeminiAnalysis(_0x532f94,_0x1de55c=''){const _0x3d8b62=a0_0x47451e;if(!_0x532f94['geminiModel'])return;if(_0x532f94['eventHistory'][_0x3d8b62(0x15f)]===0x0)return;const _0xa3779a=_0x532f94[_0x3d8b62(0xc5)][_0x3d8b62(0x148)](0x0,0xf),_0xeb85a2=await getWeatherContext(_0x532f94),_0x4e25d6=_0x532f94[_0x3d8b62(0x116)],_0x36461c=PERSONA_MAPPING[_0x532f94[_0x3d8b62(0x1d7)]['aiPersona']||_0x3d8b62(0xe0)],_0x24ddc7=_0x532f94['config'][_0x3d8b62(0x88)]||'Keine\x20Details.';let _0x2f250e='Unbekannt';try{const _0x247cc8=await _0x532f94[_0x3d8b62(0xf5)](_0x3d8b62(0x1eb));if(_0x247cc8&&_0x247cc8[_0x3d8b62(0x19e)])_0x2f250e=_0x247cc8[_0x3d8b62(0x19e)];}catch(_0x1c4959){}let _0x2cc5d9=![];try{const _0x38a2eb=await _0x532f94['getStateAsync'](_0x3d8b62(0x94));if(_0x38a2eb&&_0x38a2eb[_0x3d8b62(0x19e)])_0x2cc5d9=!![];}catch(_0x419bb7){}const _0x421669='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x36461c+_0x3d8b62(0x180)+_0x24ddc7+_0x3d8b62(0x84)+_0x4e25d6+_0x3d8b62(0x156)+_0xeb85a2+_0x3d8b62(0xa4)+_0x2f250e+_0x3d8b62(0x18f)+JSON[_0x3d8b62(0x1dc)](_0xa3779a)+_0x3d8b62(0x83)+_0x1de55c+_0x3d8b62(0x1a2);try{const _0x2658fd=await _0x532f94[_0x3d8b62(0xe8)][_0x3d8b62(0x105)](_0x421669),_0xefc77=JSON['parse'](_0x2658fd['response'][_0x3d8b62(0xc4)]()[_0x3d8b62(0x1d6)](/```json|```/g,'')[_0x3d8b62(0x146)]());await _0x532f94['setStateAsync']('analysis.lastResult',{'val':JSON[_0x3d8b62(0x1dc)](_0xefc77),'ack':!![]});if(_0xefc77[_0x3d8b62(0x102)])await _0x532f94[_0x3d8b62(0x13c)](_0x3d8b62(0x18d),{'val':_0xefc77[_0x3d8b62(0x102)],'ack':!![]});const _0x50f2d9={'timestamp':Date[_0x3d8b62(0x17c)](),'id':Date['now']()[_0x3d8b62(0x134)](),'analysis':{'activity':{'summary':_0xefc77[_0x3d8b62(0x102)],'isAlert':_0xefc77[_0x3d8b62(0x1a5)],'alertReason':_0xefc77[_0x3d8b62(0x108)]},'comfort':{'automationProposal':_0xefc77['automationProposal']}}};await updateAnalysisHistory(_0x532f94,_0x50f2d9);const _0xdd1b9b=_0xefc77[_0x3d8b62(0x1a5)]||![];_0xdd1b9b!==_0x532f94[_0x3d8b62(0xa5)]&&(await _0x532f94['setStateAsync'](_0x3d8b62(0x157),{'val':_0xdd1b9b,'ack':!![]}),_0x532f94[_0x3d8b62(0xa5)]=_0xdd1b9b,_0xdd1b9b&&(await _0x532f94[_0x3d8b62(0x13c)](_0x3d8b62(0xb4),{'val':_0xefc77['alertReason'],'ack':!![]}),sendNotification(_0x532f94,_0x3d8b62(0xee)+_0xefc77[_0x3d8b62(0x108)],![],_0xefc77['isEmergency'])));if(_0xefc77[_0x3d8b62(0x1e5)]&&_0xefc77[_0x3d8b62(0x1e5)][_0x3d8b62(0x87)]){await _0x532f94[_0x3d8b62(0x13c)](_0x3d8b62(0x170),{'val':!![],'ack':!![]}),await _0x532f94[_0x3d8b62(0x13c)](_0x3d8b62(0x1e6),{'val':_0xefc77[_0x3d8b62(0x1e5)][_0x3d8b62(0x209)],'ack':!![]}),await _0x532f94[_0x3d8b62(0x13c)](_0x3d8b62(0x1b9),{'val':_0xefc77['automationProposal'][_0x3d8b62(0x1a1)],'ack':!![]}),await _0x532f94[_0x3d8b62(0x13c)](_0x3d8b62(0x111),{'val':JSON[_0x3d8b62(0x1dc)](_0xefc77[_0x3d8b62(0x1e5)][_0x3d8b62(0xb6)]),'ack':!![]});if(_0x2cc5d9)executeAutomationAction(_0x532f94);}}catch(_0x16960e){_0x532f94[_0x3d8b62(0xf9)]['error'](_0x3d8b62(0x155)+_0x16960e[_0x3d8b62(0xf8)]);}}async function createDailyDigest(_0x226967){const _0x377951=a0_0x47451e;if(!_0x226967['isProVersion'])return;await _0x226967['setStateAsync'](LTM_DP_STATUS,{'val':_0x377951(0xa2),'ack':!![]});if(!_0x226967[_0x377951(0xe8)]||_0x226967[_0x377951(0xbd)][_0x377951(0x15f)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x226967[_0x377951(0x13c)](LTM_DP_STATUS,{'val':_0x377951(0x9c),'ack':!![]});return;}const _0x43d3b3=JSON[_0x377951(0xa7)](JSON['stringify'](_0x226967['rawEventLog'])),_0x3e6109=_0x43d3b3[_0x377951(0x15f)],_0x39afcd=_0x377951(0x18a)+JSON[_0x377951(0x1dc)](_0x43d3b3);try{const _0x123e78=await _0x226967[_0x377951(0xe8)]['generateContent'](_0x39afcd),_0x5d9e43=JSON[_0x377951(0xa7)](_0x123e78[_0x377951(0xb5)][_0x377951(0xc4)]()['replace'](/```json|```/g,'')[_0x377951(0x146)]()),_0x2b15ab={'timestamp':new Date()['toISOString'](),'eventCount':_0x3e6109,'summary':_0x5d9e43[_0x377951(0x102)]||_0x377951(0x1df),'activityLevel':_0x5d9e43[_0x377951(0xcb)]||_0x377951(0x1d1),'systemMode':_0x226967[_0x377951(0x116)]};_0x226967[_0x377951(0x12a)][_0x377951(0x8d)](_0x2b15ab),await saveDailyDigests(_0x226967),_0x226967['rawEventLog']=[],await saveRawEventLog(_0x226967),await _0x226967['setStateAsync'](LTM_DP_STATUS,{'val':_0x377951(0x8a),'ack':!![]});if(_0x226967[_0x377951(0x1fe)])sendToPython(_0x226967,_0x377951(0x9e),{'digest':_0x2b15ab});}catch(_0x5b0703){_0x226967['log'][_0x377951(0x78)](_0x5b0703['message']);}}function setupLtmScheduler(_0x53f275){const _0x14b68a=a0_0x47451e;try{if(_0x53f275[_0x14b68a(0x7b)])_0x53f275['ltmJob'][_0x14b68a(0x1b7)]();if(!_0x53f275[_0x14b68a(0x1fe)])return;_0x53f275[_0x14b68a(0x7b)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x53f275));}catch(_0x33f0c9){_0x53f275[_0x14b68a(0xf9)][_0x14b68a(0x78)]('LTM\x20Sched\x20Error:\x20'+_0x33f0c9['message']);}}function setupModeResetScheduler(_0x433474){const _0x5cab95=a0_0x47451e;try{if(_0x433474[_0x5cab95(0xcc)])_0x433474[_0x5cab95(0xcc)][_0x5cab95(0x1b7)]();_0x433474[_0x5cab95(0xcc)]=schedule[_0x5cab95(0x15d)](MODE_RESET_SCHEDULE,async()=>{const _0x16af1=_0x5cab95;await loadSystemMode(_0x433474),AUTO_RESET_MODES[_0x16af1(0x1e8)](_0x433474[_0x16af1(0x116)])&&await _0x433474['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x16af1(0xdc)],'ack':![]});});}catch(_0x416cde){_0x433474[_0x5cab95(0xf9)][_0x5cab95(0x78)](_0x5cab95(0xc9)+_0x416cde[_0x5cab95(0xf8)]);}}function setupDriftAnalysisScheduler(_0x3bd789){const _0x35bc63=a0_0x47451e;try{if(_0x3bd789[_0x35bc63(0x1bd)])clearInterval(_0x3bd789[_0x35bc63(0x1bd)]);if(!_0x3bd789[_0x35bc63(0x1fe)])return;_0x3bd789[_0x35bc63(0x1bd)]=setInterval(()=>runBaselineDriftAnalysis(_0x3bd789),(_0x3bd789[_0x35bc63(0x1d7)][_0x35bc63(0x179)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3bd789),0x1388);}catch(_0x335ab1){_0x3bd789[_0x35bc63(0xf9)][_0x35bc63(0x78)]('Drift\x20Sched\x20Error:\x20'+_0x335ab1[_0x35bc63(0xf8)]);}}function setupBriefingScheduler(_0x313246){const _0x1270e8=a0_0x47451e;try{if(_0x313246[_0x1270e8(0x174)])_0x313246['briefingJob']['cancel']();if(!_0x313246[_0x1270e8(0x1d7)][_0x1270e8(0x169)])return;const _0x5e76d4=(_0x313246[_0x1270e8(0x1d7)][_0x1270e8(0xa1)]||'08:00')[_0x1270e8(0x1e3)](':'),_0x20dd80=parseInt(_0x5e76d4[0x0])||0x8,_0x5b0316=parseInt(_0x5e76d4[0x1])||0x0,_0x559578=_0x5b0316+'\x20'+_0x20dd80+_0x1270e8(0x1c5);_0x313246['briefingJob']=schedule['scheduleJob'](_0x559578,()=>{sendMorningBriefing(_0x313246);});}catch(_0x35c418){_0x313246[_0x1270e8(0xf9)][_0x1270e8(0x78)](_0x1270e8(0x19d)+_0x35c418[_0x1270e8(0xf8)]);}}async function runBaselineDriftAnalysis(_0x34f144){const _0x4ce347=a0_0x47451e;if(!_0x34f144[_0x4ce347(0x1fe)]||!_0x34f144['geminiModel'])return;const _0x2ad9ce=_0x34f144[_0x4ce347(0x1d7)][_0x4ce347(0xd0)]||0xe;if(_0x34f144[_0x4ce347(0x12a)][_0x4ce347(0x15f)]<_0x2ad9ce+0x7){await _0x34f144[_0x4ce347(0x13c)](LTM_DP_DRIFT_STATUS,{'val':_0x4ce347(0x178),'ack':!![]});return;}const _0x4a4538=_0x34f144[_0x4ce347(0x12a)][_0x4ce347(0x148)](-_0x2ad9ce),_0x204f6d=_0x34f144[_0x4ce347(0x12a)][_0x4ce347(0x148)](0x0,_0x34f144[_0x4ce347(0x12a)]['length']-_0x2ad9ce),_0x34afbb=_0x4ce347(0x15b)+JSON[_0x4ce347(0x1dc)](_0x204f6d)+_0x4ce347(0x1b6)+JSON[_0x4ce347(0x1dc)](_0x4a4538);try{const _0x2a6416=await _0x34f144[_0x4ce347(0xe8)]['generateContent'](_0x34afbb),_0x5d1151=JSON[_0x4ce347(0xa7)](_0x2a6416['response'][_0x4ce347(0xc4)]()[_0x4ce347(0x1d6)](/```json|```/g,'')[_0x4ce347(0x146)]());_0x5d1151['baselineDrift']&&(await _0x34f144['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x5d1151[_0x4ce347(0x1d5)],'ack':!![]}),await _0x34f144[_0x4ce347(0x13c)](LTM_DP_DRIFT_DETAILS,{'val':_0x5d1151[_0x4ce347(0x17d)],'ack':!![]}),await _0x34f144[_0x4ce347(0x13c)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4ce347(0x17c)](),'ack':!![]}));}catch(_0x5ac1af){}}class CogniLiving extends utils['Adapter']{constructor(_0x1e8a13){const _0x42eb42=a0_0x47451e;super({..._0x1e8a13,'name':'cogni-living'}),this['eventHistory']=[],this['analysisHistory']=[],this[_0x42eb42(0xbd)]=[],this[_0x42eb42(0x12a)]=[],this[_0x42eb42(0xaf)]={},this[_0x42eb42(0x184)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x42eb42(0x1a3)]=!![],this[_0x42eb42(0x165)]=null,this[_0x42eb42(0x143)]=null,this[_0x42eb42(0x18c)]=![],this[_0x42eb42(0x95)]=null,this[_0x42eb42(0xe8)]=null,this[_0x42eb42(0x116)]=SYSTEM_MODES[_0x42eb42(0xdc)],this[_0x42eb42(0x1fe)]=![],this['lastAlertState']=![],this[_0x42eb42(0x202)]=_0x42eb42(0xa3),this[_0x42eb42(0xa6)]=null,this[_0x42eb42(0x7b)]=null,this['modeResetJob']=null,this[_0x42eb42(0x1bd)]=null,this[_0x42eb42(0x174)]=null,this[_0x42eb42(0x14a)]=null,this[_0x42eb42(0xb8)]=![],this['on'](_0x42eb42(0x1fb),this[_0x42eb42(0x140)][_0x42eb42(0x90)](this)),this['on']('stateChange',this[_0x42eb42(0x104)][_0x42eb42(0x90)](this)),this['on']('unload',this['onUnload'][_0x42eb42(0x90)](this)),this['on'](_0x42eb42(0xf8),this[_0x42eb42(0x12b)][_0x42eb42(0x90)](this));}async['onReady'](){const _0x32cdb8=a0_0x47451e;this[_0x32cdb8(0xf9)]['info']('cogni-living\x20adapter\x20starting\x20(v'+this['version']+')\x20-\x20SAFE\x20BOOT');if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x47451e(0x1ce)](_0x574d76){const _0xcbac2a=a0_0x47451e;if(this[_0xcbac2a(0xa6)])clearInterval(this['analysisTimer']);if(this[_0xcbac2a(0x1bd)])clearInterval(this[_0xcbac2a(0x1bd)]);if(this['ltmJob'])this[_0xcbac2a(0x7b)][_0xcbac2a(0x1b7)]();if(this[_0xcbac2a(0xcc)])this['modeResetJob'][_0xcbac2a(0x1b7)]();if(this['briefingJob'])this[_0xcbac2a(0x174)][_0xcbac2a(0x1b7)]();if(this[_0xcbac2a(0x165)])clearTimeout(this['exitTimer']);if(this[_0xcbac2a(0x143)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x574d76();}async[a0_0x47451e(0x104)](_0x112775,_0x59b4f3){const _0x262aad=a0_0x47451e;if(!_0x59b4f3||this[_0x262aad(0xb8)])return;if(_0x112775['includes']('telegram')&&_0x112775[_0x262aad(0xf2)](_0x262aad(0x121))&&_0x59b4f3[_0x262aad(0x19e)]){await handleTelegramResponse(this,_0x59b4f3[_0x262aad(0x19e)]);return;}if(_0x112775===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0x59b4f3[_0x262aad(0x19e)]&&Object['values'](SYSTEM_MODES)[_0x262aad(0x1e8)](_0x59b4f3['val'])){this[_0x262aad(0x116)]=_0x59b4f3[_0x262aad(0x19e)];if(_0x59b4f3['val']===SYSTEM_MODES[_0x262aad(0x152)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x59b4f3[_0x262aad(0x1aa)])this['setState'](_0x112775,{'val':this[_0x262aad(0x116)],'ack':!![]});return;}if(!_0x59b4f3[_0x262aad(0x1aa)]){_0x112775[_0x262aad(0x1e8)](_0x262aad(0x182))&&_0x59b4f3[_0x262aad(0x19e)]&&(this[_0x262aad(0x1fd)](_0x112775,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x112775[_0x262aad(0x1e8)](_0x262aad(0xf4))&&_0x59b4f3[_0x262aad(0x19e)]){this[_0x262aad(0x1fd)](_0x112775,{'val':![],'ack':!![]});if(this[_0x262aad(0x1fe)])createDailyDigest(this);}_0x112775['includes'](_0x262aad(0x1b0))&&_0x59b4f3[_0x262aad(0x19e)]&&(this[_0x262aad(0x1fd)](_0x112775,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x112775[_0x262aad(0x1e8)]('automation.triggerAction')&&_0x59b4f3[_0x262aad(0x19e)]&&(this[_0x262aad(0x1fd)](_0x112775,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x112775[_0x262aad(0x1e8)](_0x262aad(0x188))&&_0x59b4f3['val']){this[_0x262aad(0x1fd)](_0x112775,{'val':![],'ack':!![]});if(this[_0x262aad(0x1fe)])try{const _0xd213a5=await this['getStateAsync'](_0x262aad(0xc0));if(_0xd213a5&&_0xd213a5[_0x262aad(0x19e)]){const _0x30aa66=JSON[_0x262aad(0xa7)](_0xd213a5[_0x262aad(0x19e)]);this['log'][_0x262aad(0xf7)](_0x262aad(0x1b5)),this[_0x262aad(0x13c)]('analysis.training.status',{'val':_0x262aad(0x168),'ack':!![]}),sendToPython(this,_0x262aad(0x1a9),{'sequences':_0x30aa66});}}catch(_0x47f626){this['log'][_0x262aad(0x78)]('Training\x20Error:\x20'+_0x47f626['message']);}}if(_0x112775[_0x262aad(0x1e8)](_0x262aad(0xc1))&&_0x59b4f3[_0x262aad(0x19e)]){this[_0x262aad(0x1fd)](_0x112775,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x31bda5=await this[_0x262aad(0xf5)](LTM_DP_DAILY_DIGESTS);if(_0x31bda5&&_0x31bda5['val'])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0x262aad(0xa7)](_0x31bda5[_0x262aad(0x19e)])});}catch(_0x16552b){}}if(_0x112775[_0x262aad(0x1e8)](_0x262aad(0x79))&&_0x59b4f3['val']){this[_0x262aad(0x1fd)](_0x112775,{'val':![],'ack':!![]});if(this[_0x262aad(0x1fe)])try{const _0x3a5bdf=await this[_0x262aad(0xf5)]('LTM.trainingData.thermodynamics');if(_0x3a5bdf&&_0x3a5bdf[_0x262aad(0x19e)])sendToPython(this,'TRAIN_ENERGY',{'points':JSON[_0x262aad(0xa7)](_0x3a5bdf[_0x262aad(0x19e)])});}catch(_0x24d4af){}}return;}if(this[_0x262aad(0x1d7)][_0x262aad(0xe6)]&&this['config'][_0x262aad(0xe6)][_0x262aad(0x1e8)](_0x112775)){await checkWifiPresence(this);return;}const _0xa6b5d1=(this[_0x262aad(0x1d7)][_0x262aad(0x1b8)]||[])[_0x262aad(0x122)](_0x581ce1=>_0x581ce1['id']===_0x112775);if(_0xa6b5d1)processSensorEvent(this,_0x112775,_0x59b4f3,_0xa6b5d1);}async[a0_0x47451e(0x12b)](_0x43113b){const _0x1e6805=a0_0x47451e;if(typeof _0x43113b===_0x1e6805(0x1b2)&&_0x43113b[_0x1e6805(0xf8)]){if(_0x43113b[_0x1e6805(0xfb)]===_0x1e6805(0x1c3)){const _0x1829bd=_0x43113b[_0x1e6805(0xf8)]['apiKey']||this[_0x1e6805(0x1d7)][_0x1e6805(0x1a0)];if(!_0x1829bd)return this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b[_0x1e6805(0xfb)],{'success':![],'message':_0x1e6805(0xd2)},_0x43113b['callback']);try{const _0x17efac=new GoogleGenerativeAI(_0x1829bd),_0x85fb3c=_0x17efac['getGenerativeModel']({'model':GEMINI_MODEL}),_0x216d1e=await _0x85fb3c['generateContent']('Hi');this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b['command'],{'success':!![],'message':_0x1e6805(0x70)+_0x216d1e[_0x1e6805(0xb5)][_0x1e6805(0xc4)]()},_0x43113b[_0x1e6805(0x11b)]);}catch(_0x9c12c7){this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b[_0x1e6805(0xfb)],{'success':![],'message':_0x1e6805(0x1ec)+_0x9c12c7[_0x1e6805(0xf8)]},_0x43113b[_0x1e6805(0x11b)]);}}else{if(_0x43113b[_0x1e6805(0xfb)]===_0x1e6805(0x1c7)){const _0x4797df=await getWeatherContext(this),_0x5a588a=await getCalendarContext(this);this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b[_0x1e6805(0xfb)],{'success':!![],'weather':_0x4797df,'calendar':_0x5a588a},_0x43113b[_0x1e6805(0x11b)]);}else{if(_0x43113b[_0x1e6805(0xfb)]===_0x1e6805(0x7d)){if(!this[_0x1e6805(0x1fe)])return this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b[_0x1e6805(0xfb)],{'success':![],'isPro':![]},_0x43113b[_0x1e6805(0x11b)]);let _0x39bf13={'status':_0x1e6805(0x208)};try{const _0x559c13=await this[_0x1e6805(0xf5)](LTM_DP_DRIFT_STATUS);_0x39bf13['status']=_0x559c13?_0x559c13['val']:_0x1e6805(0x208);}catch(_0x22d21c){}this[_0x1e6805(0x196)](_0x43113b['from'],_0x43113b['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x1e6805(0x12a)],'driftAnalysis':_0x39bf13,'analysisHistory':this[_0x1e6805(0x13b)]},_0x43113b['callback']);}else{if(_0x43113b[_0x1e6805(0xfb)]==='getOverviewData'){const _0x5a2f68=this['dailyDigests']['length'],_0x4d1b9a=new Date(),_0x2a4f64=new Date(_0x4d1b9a['getFullYear'](),_0x4d1b9a[_0x1e6805(0x142)](),_0x4d1b9a[_0x1e6805(0x6e)]())['getTime'](),_0x3d4c7c=this[_0x1e6805(0xbd)][_0x1e6805(0x10e)](_0x2a2b25=>new Date(_0x2a2b25[_0x1e6805(0xb3)])[_0x1e6805(0x139)]()>_0x2a4f64)['length'],_0x4f4627=new Array(0x18)['fill'](0x0);this[_0x1e6805(0xbd)][_0x1e6805(0x1fc)](_0x317b19=>{const _0x56e62b=_0x1e6805,_0x1c5880=new Date(_0x317b19[_0x56e62b(0xb3)]);if(_0x1c5880['getTime']()>_0x2a4f64)_0x4f4627[_0x1c5880[_0x56e62b(0x9b)]()]++;});let _0x183f74={'status':_0x1e6805(0x208)};try{const _0xabff19=await this[_0x1e6805(0xf5)](LTM_DP_DRIFT_STATUS);_0x183f74[_0x1e6805(0x1c9)]=_0xabff19?_0xabff19[_0x1e6805(0x19e)]:_0x1e6805(0x208);}catch(_0x43177f){}let _0x1191ea='';try{const _0x209da8=await this['getStateAsync'](_0x1e6805(0x1eb));_0x1191ea=_0x209da8?_0x209da8[_0x1e6805(0x19e)]:'';}catch(_0x5e9dd0){}let _0x57553c=null;!this[_0x1e6805(0xe8)]&&(_0x57553c=this['config']['geminiApiKey']?'KI-Modell\x20nicht\x20initialisiert':_0x1e6805(0x85));let _0x15a797={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x4d8ba2=await this[_0x1e6805(0xf5)](_0x1e6805(0x170));if(_0x4d8ba2&&_0x4d8ba2[_0x1e6805(0x19e)]){_0x15a797[_0x1e6805(0x87)]=!![];const _0x15a66f=await this[_0x1e6805(0xf5)]('analysis.automation.description');_0x15a797[_0x1e6805(0x209)]=_0x15a66f?_0x15a66f[_0x1e6805(0x19e)]:'';const _0x5196fb=await this[_0x1e6805(0xf5)](_0x1e6805(0x1b9));_0x15a797['targetId']=_0x5196fb?_0x5196fb[_0x1e6805(0x19e)]:'';const _0x34d7c8=await this[_0x1e6805(0xf5)](_0x1e6805(0x111));_0x15a797['targetValue']=_0x34d7c8?_0x34d7c8[_0x1e6805(0x19e)]:'';}const _0x48a8ef=await this['getStateAsync'](_0x1e6805(0x94));_0x15a797['autoApply']=_0x48a8ef?!!_0x48a8ef[_0x1e6805(0x19e)]:![];}catch(_0x345393){}this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b[_0x1e6805(0xfb)],{'success':!![],'eventHistory':this['eventHistory'][_0x1e6805(0x148)](0x0,0xf),'stats':{'digestCount':_0x5a2f68,'eventCountToday':_0x3d4c7c,'hourlyActivity':_0x4f4627,'driftStatus':_0x183f74[_0x1e6805(0x1c9)],'isPresent':this[_0x1e6805(0x1a3)],'presenceWho':_0x1191ea,'minDays':this['config'][_0x1e6805(0x6f)]||0x7,'stbDays':this[_0x1e6805(0x1d7)][_0x1e6805(0xd0)]||0xe,'ltbDays':this[_0x1e6805(0x1d7)][_0x1e6805(0xeb)]||0x3c,'systemError':_0x57553c},'automation':_0x15a797},_0x43113b[_0x1e6805(0x11b)]);}else{if(_0x43113b[_0x1e6805(0xfb)]===_0x1e6805(0x17a))try{const _0x45b28b=await scanForDevices(this,_0x43113b[_0x1e6805(0xf8)]||{});this[_0x1e6805(0x196)](_0x43113b['from'],_0x43113b[_0x1e6805(0xfb)],{'success':!![],'devices':_0x45b28b},_0x43113b[_0x1e6805(0x11b)]);}catch(_0x55e591){this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b[_0x1e6805(0xfb)],{'success':![],'error':_0x55e591[_0x1e6805(0xf8)]},_0x43113b[_0x1e6805(0x11b)]);}else{if(_0x43113b[_0x1e6805(0xfb)]===_0x1e6805(0xbc)){const _0x7c0f4b=await this['getForeignObjectsAsync']('enum.functions.*',_0x1e6805(0x6d)),_0x2d7405=[];if(_0x7c0f4b)for(const _0xeb7fd8 in _0x7c0f4b){const _0x2a2322=_0x7c0f4b[_0xeb7fd8],_0x16b58d=(_0x2a2322[_0x1e6805(0x1ff)]&&typeof _0x2a2322['common'][_0x1e6805(0x14d)]==='object'?_0x2a2322[_0x1e6805(0x1ff)][_0x1e6805(0x14d)]['de']:_0x2a2322[_0x1e6805(0x1ff)][_0x1e6805(0x14d)])||_0x2a2322['common'][_0x1e6805(0x14d)];_0x2d7405[_0x1e6805(0x8d)]({'id':_0xeb7fd8,'name':_0x16b58d});}this[_0x1e6805(0x196)](_0x43113b['from'],_0x43113b[_0x1e6805(0xfb)],{'success':!![],'enums':_0x2d7405},_0x43113b[_0x1e6805(0x11b)]);}else{if(_0x43113b[_0x1e6805(0xfb)]==='getCalendarNames'){const _0x22c27a=_0x43113b[_0x1e6805(0xf8)][_0x1e6805(0x1bf)];if(!_0x22c27a)return this[_0x1e6805(0x196)](_0x43113b['from'],_0x43113b[_0x1e6805(0xfb)],{'success':![],'error':_0x1e6805(0x80)},_0x43113b['callback']);const _0x55776a=await getCalendarNames(this,_0x22c27a);this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b['command'],{'success':!![],'names':_0x55776a},_0x43113b[_0x1e6805(0x11b)]);}else{if(_0x43113b[_0x1e6805(0xfb)]===_0x1e6805(0x207)){const {targetId:_0x41f13c,targetValue:_0x3d75dc}=_0x43113b[_0x1e6805(0xf8)];this[_0x1e6805(0xf9)][_0x1e6805(0xf7)](_0x1e6805(0xcd)+_0x41f13c+_0x1e6805(0x133)+_0x3d75dc),await this[_0x1e6805(0x13c)](_0x1e6805(0x170),{'val':!![],'ack':!![]}),await this[_0x1e6805(0x13c)](_0x1e6805(0x1e6),{'val':'SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20'+_0x41f13c,'ack':!![]}),await this[_0x1e6805(0x13c)]('analysis.automation.targetId',{'val':_0x41f13c,'ack':!![]}),await this['setStateAsync'](_0x1e6805(0x111),{'val':_0x3d75dc,'ack':!![]}),this[_0x1e6805(0x196)](_0x43113b['from'],_0x43113b[_0x1e6805(0xfb)],{'success':!![]},_0x43113b[_0x1e6805(0x11b)]);}else{if(_0x43113b[_0x1e6805(0xfb)]==='submitFeedback'){const {historyId:_0x486997,rating:_0x1c32d0,comment:_0x5a940f,alertReason:_0x4dff01}=_0x43113b[_0x1e6805(0xf8)];_0x486997&&_0x1c32d0?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x486997,'rating':_0x1c32d0,'comment':_0x5a940f,'alertReason':_0x4dff01}),this[_0x1e6805(0x196)](_0x43113b['from'],_0x43113b['command'],{'success':!![]},_0x43113b[_0x1e6805(0x11b)])):this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b[_0x1e6805(0xfb)],{'success':![],'error':_0x1e6805(0x136)},_0x43113b[_0x1e6805(0x11b)]);}else _0x43113b['command']===_0x1e6805(0x100)&&(this[_0x1e6805(0xf9)]['info'](_0x1e6805(0xad)),await this[_0x1e6805(0x13c)](_0x1e6805(0x170),{'val':![],'ack':!![]}),await this[_0x1e6805(0x13c)](_0x1e6805(0x1e6),{'val':'','ack':!![]}),this[_0x1e6805(0x196)](_0x43113b[_0x1e6805(0x1d2)],_0x43113b[_0x1e6805(0xfb)],{'success':!![]},_0x43113b['callback']));}}}}}}}}}}}if(require[a0_0x47451e(0x81)]!==module)module[a0_0x47451e(0x199)]=_0x556513=>new CogniLiving(_0x556513);else new CogniLiving();