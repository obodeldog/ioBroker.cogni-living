const a0_0x20a8f3=a0_0xd2cd;(function(_0x250266,_0x13c96c){const _0x6e9d7f=a0_0xd2cd,_0x4c99d0=_0x250266();while(!![]){try{const _0x2bc5ea=-parseInt(_0x6e9d7f(0x29d))/0x1*(-parseInt(_0x6e9d7f(0x2d2))/0x2)+-parseInt(_0x6e9d7f(0x290))/0x3*(parseInt(_0x6e9d7f(0x2ce))/0x4)+parseInt(_0x6e9d7f(0x291))/0x5+-parseInt(_0x6e9d7f(0x29a))/0x6+parseInt(_0x6e9d7f(0x309))/0x7*(-parseInt(_0x6e9d7f(0x24c))/0x8)+parseInt(_0x6e9d7f(0x261))/0x9+parseInt(_0x6e9d7f(0x2e2))/0xa;if(_0x2bc5ea===_0x13c96c)break;else _0x4c99d0['push'](_0x4c99d0['shift']());}catch(_0x5acc01){_0x4c99d0['push'](_0x4c99d0['shift']());}}}(a0_0x3c47,0xdd9d2));function a0_0x3c47(){const _0x11a822=['handleTelegramResponse','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','driftAnalysisTimer','Kalender:\x20Deaktiviert','checkLicense','LTM.driftAnalysis.driftDetails','dutycycle','Gemini\x20AI\x20initialized.','notifyEmailEnabled','analysis.triggerBriefing','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','\x20sensors...','daswetter','toString','values','0\x204\x20*\x20*\x20*','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','apply','exitGraceTimer','\x20presence\x20devices...','onMessage','ltmDriftCheckIntervalHours','extendObjectAsync','system.isPresent','split','status','VACATION','stick_unreach','info.','minDaysForBaseline','Scheduling\x20Morning\x20Briefing\x20for\x20','isGracePeriodActive','N/A','log','\x0aSTB:\x20','warn','icons-mfd.','3784470lNYrUV','2737140UzDufb','ltmLtbWindowDays','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','WETTER\x20ERROR:\x20','sendTo','Drift\x20Sched\x20Error:\x20','switch','Kein\x20API\x20Key\x20konfiguriert!','longitude','2685378kKUJJa','setState','sound','53683FLFuNH','Gemini\x20Init\x20Error:\x20','Wetter:\x20Deaktiviert','splice','Error\x20checking\x20WiFi:\x20','runGeminiAnalysis','analysisTimer',')\x20verdÃ¤chtig\x20still?\x20Erwartest\x20du\x20basierend\x20auf\x20der\x20Tageszeit\x20AktivitÃ¤t\x20(z.B.\x20Morgens\x20Aufstehen)?\x20Wenn\x20ja\x20->\x20ALARM.\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20Akut\x20(vs.\x20STB):\x20Weicht\x20das\x20heutige\x20Verhalten\x20stark\x20von\x20den\x20letzten\x2014\x20Tagen\x20ab?\x20(z.B.\x205x\x20Toilette\x20statt\x203x).\x20Wenn\x20ja\x20->\x20WARNUNG.\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20Schleichend\x20(Drift):\x20(Nur\x20relevant\x20wenn\x20Phase\x203\x20aktiv)\x20Gibt\x20es\x20einen\x20langsamen\x20Trend\x20ins\x20Negative?\x0a\x20\x20\x20\x20\x20\x20\x20\x20Ignoriere\x20Fehlalarme\x20durch\x20Kontext:\x20','PRIORITÃ„T:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungewÃ¶hnliche\x20Anwesenheit.','Feedback\x20saved:\x20','briefingEnabled','isProVersion','toLocaleString','find','off','config_pending','message','Deaktiviert\x20(Pro-Feature)','maintenance','shutter','timestamp','config','native','checkWifiPresence','bind','\x0a\x20\x20\x20\x20\x20\x20\x20\x20CRITICAL\x20SAFETY\x20CHECK:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20Sofort/Ad-Hoc:\x20Ist\x20es\x20jetzt\x20(','filter','initHistory','ready','getSystemUUID','currentposition','accuweather.0','system','connection','val','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','object','callback','info','retry','analysis.activitySummary','eventHistory','setStateAsync','rssi','search','loadRawEventLog','processSensorEvent','stringify','parse','4AQqzAc','currentSystemMode','common','useCalendar','56WPJNXD','system.','LTM.dailyDigests','system.mode','unload','expire','LTM.driftAnalysis.lastCheck','uuid-not-found','.NextHours.Location_1.Day_1.current.symbol_desc','triggerBriefing','Pro\x20Feature','material.','unknown','working','type','startsWith','12213450fEPsUW','scanForDevices','sendMorningBriefing','sendToAsync','vis.','vacation','getWeatherContext','System\x20Status\x20&\x20Control','Briefing\x20Sched\x20Error:\x20','daswetter.0','notifyTelegramRecipient','setpoint','.Summary.Current','runBaselineDriftAnalysis','Cogni-Living','endsWith','firmware','scheduleJob','licenseKey','normal','getCalendarNames','LTM.processingStatus','javascript.','analysis.automation.description','.\x20PRÃ„SENZ:\x20','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','setupModeResetScheduler','checkLtmObjects','.\x20MODUS:\x20','KALENDER:\x20','runAutopilot','generic','\x20for\x20interactive\x20buttons...','createAllObjects','events.lastEvent','loadDailyDigests','abortExitTimer','calendarInstance','saveRawEventLog','368263TwohiU','NORMAL','setupLtmScheduler','lastAlertState','analysisInterval','.forecast.current.state','exitTimer','Normal','setupBriefingScheduler','trim','location','toISOString','Aktiv\x20(','@iobroker/adapter-core','LTM','lowbat','saveFeedback','version','cogni-living','sendNotification','initZombies','onReady','notifyTelegramInstance','getForeignObjectAsync','baselineDrift','push','âœ…\x20Alles\x20OK\x20(Reset)','node-schedule','direction','response','notifyPushoverEnabled','Reset\x20Sched\x20Error:\x20','Analysis\x20Error:\x20','updateBaselineStatus','openweathermap','onUnload','KALENDER:\x20Keine\x20Daten','toFixed',')\x20-\x20PHASE\x202b:\x20INTERACTIVE','presence','LTM.driftAnalysis.baselineDrift','number','ical.0','LTM.baselineStatus','\x20Tage)','uuid','exports','Gast','analysis.lastResult','systemUUID','send','getForeignStateAsync','analysis.analysisHistory','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','scriptEnabled','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','getOverviewData','startExitTimer','notifyPushoverInstance','testNotification','PARTY','length','text','triggerDailyDigest','event','includes','[Test]\x20Interaktiver\x20Alarm','button','ðŸš¨ðŸš¨\x20NOTFALL','N/A\x20(Learning)','state','generateContent','ltmJob','.\x20PERSONA:\x20','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','communicate.request','(((.+)+)+)+$','loadSystemMode','name','map','json','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20}','createDailyDigest','humidity','analysis.isAlert','error','LTM.rawEventLog','initSystemConfig','getStateAsync','logDuplicates','brightness','analysisHistory','2-digit','automationProposal','getGenerativeModel','KALENDER:\x20Keine\x20relevanten\x20Termine','namespace','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','genAI','from','activity','notifyTelegramEnabled','tryParse','set_temperature','join','subscribeForeignStatesAsync','weatherunderground.0','briefingJob','de-DE','analysis.trigger','command','system.meta.uuid','boolean','[TEST]\x20','Triggered\x20analysis\x20but\x20Gemini\x20AI\x20is\x20not\x20initialized!\x20Check\x20API\x20Key.','isEmergency','replace','history.','patternDetected','catch','\x20|\x20','time','setHours','online','analysis.alertReason','siren','summary','long','PRO-','getEnums','@google/generative-ai','getCalendarContext','driftDetails','LTM\x20Sched\x20Error:\x20','admin.','telegram','dailyDigests','guest','inactivityMonitoringEnabled','events.history','cover','setPresence','08:00','weatherInstance','rawEventLog','isExit','Alarm','sensorLastValues','GUEST','ltmStbWindowDays','calendarSelection','onStateChange','Subscribing\x20to\x20','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','isArray','Raw\x20Log','\x20Phase\x203:\x20DRIFT\x20ACTIVE.\x20Compare\x20recent\x20events\x20against\x20long-term\x20patterns.','valve','_calName','notifyEmailInstance','unreach','initSensorSubscriptions','constructor','slice','blind','No\x20recorded\x20events\x20yet.','Starting\x20Autopilot\x20(','inactivityThresholdHours','saveDailyDigests','cancel','briefingTime','setupTelegramListener','systemConfig','date','PRIORITÃ„T:\x20Gesundheit\x20und\x20Sicherheit\x20fÃ¼r\x20Senioren\x20(AAL).\x20Erkenne\x20InaktivitÃ¤t,\x20potenzielle\x20StÃ¼rze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20nÃ¤chtliche\x20Unruhe.','ack','\x20hours.\x20Potential\x20incapacitation.','Trigger\x20Digest','KALENDER\x20ERROR:\x20','subscribeStates','openweathermap.0','updateAnalysisHistory','channel','latitude','position','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','248OxNHxs','isAlert','targetposition','.data.table','string','indexOf','Party','geminiApiKey','pop','Lernphase\x20(','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','now','isPresent','modeResetJob','setupDriftAnalysisScheduler','Baseline\x20Status','alertReason','simple-api.','reachable','party','COGNI_REQUEST_CALL','8781885wtWEHT','Adapter','Phase\x201:\x20Learning\x20(No\x20Baseline).\x20Rely\x20on\x20common\x20sense.','geminiModel','presenceDevices','ðŸ“¡\x20Hooking\x20into\x20','checkSystemObjects','description','WETTER:\x20Keine\x20Daten\x20gefunden'];a0_0x3c47=function(){return _0x11a822;};return a0_0x3c47();}const a0_0x1de1f1=(function(){let _0x70fffa=!![];return function(_0x5819e7,_0x53923b){const _0x5da616=_0x70fffa?function(){const _0x46dafd=a0_0xd2cd;if(_0x53923b){const _0x32cdc5=_0x53923b[_0x46dafd(0x27c)](_0x5819e7,arguments);return _0x53923b=null,_0x32cdc5;}}:function(){};return _0x70fffa=![],_0x5da616;};}()),a0_0x338ffc=a0_0x1de1f1(this,function(){const _0x256755=a0_0xd2cd;return a0_0x338ffc[_0x256755(0x277)]()['search'](_0x256755(0x1dd))[_0x256755(0x277)]()[_0x256755(0x234)](a0_0x338ffc)[_0x256755(0x2c9)](_0x256755(0x1dd));});a0_0x338ffc();'use strict';const utils=require(a0_0x20a8f3(0x316)),{GoogleGenerativeAI}=require(a0_0x20a8f3(0x213)),schedule=require(a0_0x20a8f3(0x1ac)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x20a8f3(0x279),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x20a8f3(0x1e7),LTM_DP_DAILY_DIGESTS=a0_0x20a8f3(0x2d4),LTM_DP_STATUS=a0_0x20a8f3(0x2f7),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x20a8f3(0x1bc),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x20a8f3(0x1b9),LTM_DP_DRIFT_DETAILS=a0_0x20a8f3(0x26f),LTM_DP_DRIFT_LAST_CHECK=a0_0x20a8f3(0x2d8),SYSTEM_DP_MODE=a0_0x20a8f3(0x2d5),HARD_IGNORE_TERMS=['scriptProblem',a0_0x20a8f3(0x1c7),'update',a0_0x20a8f3(0x232),a0_0x20a8f3(0x318),a0_0x20a8f3(0x2c8),a0_0x20a8f3(0x2be),a0_0x20a8f3(0x2af),a0_0x20a8f3(0x1e6),'fault',a0_0x20a8f3(0x2df),a0_0x20a8f3(0x1ad),a0_0x20a8f3(0x286),a0_0x20a8f3(0x2ac),a0_0x20a8f3(0x270),a0_0x20a8f3(0x2f2),a0_0x20a8f3(0x25e),'link_quality'],GENERIC_NAMES=[a0_0x20a8f3(0x24e),a0_0x20a8f3(0x2bb),a0_0x20a8f3(0x1d7),'level','value',a0_0x20a8f3(0x1eb),'on',a0_0x20a8f3(0x2ab),a0_0x20a8f3(0x297),a0_0x20a8f3(0x24a),a0_0x20a8f3(0x2b0),a0_0x20a8f3(0x236),a0_0x20a8f3(0x21d),a0_0x20a8f3(0x284),'motion',a0_0x20a8f3(0x1b8),'occupancy','temperature',a0_0x20a8f3(0x1e4),'power','energy',a0_0x20a8f3(0x2ed),a0_0x20a8f3(0x22f),'actual_temperature',a0_0x20a8f3(0x1f8)],ADAPTER_BLACKLIST=[a0_0x20a8f3(0x2d3),a0_0x20a8f3(0x217),a0_0x20a8f3(0x287),a0_0x20a8f3(0x2e6),a0_0x20a8f3(0x206),a0_0x20a8f3(0x2dd),a0_0x20a8f3(0x28f),'flot.','echarts.',a0_0x20a8f3(0x2f8),a0_0x20a8f3(0x25d)],SYSTEM_MODES={'NORMAL':a0_0x20a8f3(0x2f5),'VACATION':a0_0x20a8f3(0x2e7),'PARTY':a0_0x20a8f3(0x25f),'GUEST':a0_0x20a8f3(0x21a)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x20a8f3(0x225)]],PERSONA_MAPPING={'generic':a0_0x20a8f3(0x22b),'senior_aal':a0_0x20a8f3(0x240),'family':a0_0x20a8f3(0x2c0),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':a0_0x20a8f3(0x2a5)};class CogniLiving extends utils[a0_0x20a8f3(0x262)]{constructor(_0x306add){const _0x4cd0b9=a0_0x20a8f3;super({..._0x306add,'name':_0x4cd0b9(0x31b)}),this[_0x4cd0b9(0x2c6)]=[],this[_0x4cd0b9(0x1ec)]=[],this['feedbackHistory']=[],this[_0x4cd0b9(0x221)]=[],this[_0x4cd0b9(0x219)]=[],this[_0x4cd0b9(0x224)]={},this[_0x4cd0b9(0x23e)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x4cd0b9(0x30f)]=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this[_0x4cd0b9(0x1f3)]=null,this[_0x4cd0b9(0x264)]=null,this[_0x4cd0b9(0x2cf)]=SYSTEM_MODES[_0x4cd0b9(0x30a)],this['isProVersion']=![],this[_0x4cd0b9(0x30c)]=![],this[_0x4cd0b9(0x1c2)]=_0x4cd0b9(0x2de),this[_0x4cd0b9(0x2a3)]=null,this[_0x4cd0b9(0x1d9)]=null,this['modeResetJob']=null,this[_0x4cd0b9(0x26c)]=null,this[_0x4cd0b9(0x1fc)]=null,this['on'](_0x4cd0b9(0x2b9),this[_0x4cd0b9(0x31e)][_0x4cd0b9(0x2b5)](this)),this['on']('stateChange',this[_0x4cd0b9(0x228)][_0x4cd0b9(0x2b5)](this)),this['on'](_0x4cd0b9(0x2d6),this[_0x4cd0b9(0x1b4)]['bind'](this)),this['on']('message',this[_0x4cd0b9(0x27f)]['bind'](this));}async[a0_0x20a8f3(0x31e)](){const _0x3dfcdd=a0_0x20a8f3;this[_0x3dfcdd(0x28c)]['info']('cogni-living\x20adapter\x20starting\x20(v'+this[_0x3dfcdd(0x31a)]+_0x3dfcdd(0x1b7)),await this[_0x3dfcdd(0x31d)](),this['config'][_0x3dfcdd(0x2f4)]=this[_0x3dfcdd(0x2b2)][_0x3dfcdd(0x2f4)]||'';try{this[_0x3dfcdd(0x2a8)]=await this[_0x3dfcdd(0x26e)](this[_0x3dfcdd(0x2b2)]['licenseKey']);}catch(_0x4f7591){}if(!this[_0x3dfcdd(0x2b2)][_0x3dfcdd(0x239)]||this[_0x3dfcdd(0x2b2)][_0x3dfcdd(0x239)]<0.1)this['config'][_0x3dfcdd(0x239)]=0xc;await this[_0x3dfcdd(0x2b8)](),await this[_0x3dfcdd(0x1e8)]();if(this[_0x3dfcdd(0x2b2)][_0x3dfcdd(0x253)])try{this[_0x3dfcdd(0x1f3)]=new GoogleGenerativeAI(this[_0x3dfcdd(0x2b2)][_0x3dfcdd(0x253)]),this[_0x3dfcdd(0x264)]=this['genAI'][_0x3dfcdd(0x1ef)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x3dfcdd(0x28c)][_0x3dfcdd(0x2c3)](_0x3dfcdd(0x271));}catch(_0x5f2db5){this[_0x3dfcdd(0x28c)]['error'](_0x3dfcdd(0x29e)+_0x5f2db5[_0x3dfcdd(0x2ad)]);}await this[_0x3dfcdd(0x303)](),await this['loadSystemMode'](),await this['loadRawEventLog'](),await this[_0x3dfcdd(0x305)](),this['subscribeStates'](_0x3dfcdd(0x1fe)),this[_0x3dfcdd(0x245)](LTM_DP_TRIGGER_DIGEST),this[_0x3dfcdd(0x245)](_0x3dfcdd(0x2d5)),this[_0x3dfcdd(0x245)](_0x3dfcdd(0x273)),this[_0x3dfcdd(0x245)](_0x3dfcdd(0x1e5)),await this[_0x3dfcdd(0x233)](),await this['initPresenceSubscriptions'](),await this[_0x3dfcdd(0x23d)]();if(this[_0x3dfcdd(0x2a3)])clearInterval(this['analysisTimer']);const _0x1eb073=this['config'][_0x3dfcdd(0x30d)]||0xf;_0x1eb073>0x0&&(this[_0x3dfcdd(0x28c)][_0x3dfcdd(0x2c3)](_0x3dfcdd(0x238)+_0x1eb073+'\x20min).'),this[_0x3dfcdd(0x2a3)]=setInterval(()=>{const _0x4338ee=_0x3dfcdd;this[_0x4338ee(0x300)]();},_0x1eb073*0x3c*0x3e8)),this[_0x3dfcdd(0x30b)](),this[_0x3dfcdd(0x2fc)](),this[_0x3dfcdd(0x25a)](),this['setupBriefingScheduler']();}[a0_0x20a8f3(0x1b4)](_0x13a2e0){const _0x1c6214=a0_0x20a8f3;if(this[_0x1c6214(0x2a3)])clearInterval(this[_0x1c6214(0x2a3)]);if(this[_0x1c6214(0x26c)])clearInterval(this[_0x1c6214(0x26c)]);if(this[_0x1c6214(0x1d9)])this[_0x1c6214(0x1d9)][_0x1c6214(0x23b)]();if(this[_0x1c6214(0x259)])this[_0x1c6214(0x259)][_0x1c6214(0x23b)]();if(this[_0x1c6214(0x1fc)])this[_0x1c6214(0x1fc)][_0x1c6214(0x23b)]();if(this['exitTimer'])clearTimeout(this[_0x1c6214(0x30f)]);if(this[_0x1c6214(0x27d)])clearTimeout(this[_0x1c6214(0x27d)]);_0x13a2e0();}async[a0_0x20a8f3(0x228)](_0x18e6e5,_0x49dee4){const _0x207632=a0_0x20a8f3;if(!_0x49dee4)return;if(_0x18e6e5[_0x207632(0x1d2)](_0x207632(0x218))&&_0x18e6e5[_0x207632(0x2f1)](_0x207632(0x1dc))&&_0x49dee4[_0x207632(0x2bf)]){await this[_0x207632(0x26a)](_0x49dee4['val']);return;}if(_0x18e6e5===this[_0x207632(0x1f1)]+'.'+SYSTEM_DP_MODE){_0x49dee4[_0x207632(0x2bf)]&&Object[_0x207632(0x278)](SYSTEM_MODES)['includes'](_0x49dee4[_0x207632(0x2bf)])&&(this[_0x207632(0x2cf)]=_0x49dee4['val'],_0x49dee4[_0x207632(0x2bf)]===SYSTEM_MODES['VACATION']?await this[_0x207632(0x21e)](![]):await this[_0x207632(0x21e)](!![]));if(!_0x49dee4[_0x207632(0x241)])this['setState'](_0x18e6e5,{'val':this[_0x207632(0x2cf)],'ack':!![]});return;}if(!_0x49dee4['ack']){_0x18e6e5[_0x207632(0x1d2)](_0x207632(0x1fe))&&_0x49dee4['val']&&(this['setState'](_0x18e6e5,{'val':![],'ack':!![]}),this[_0x207632(0x2a2)]());if(_0x18e6e5['includes'](_0x207632(0x1d0))&&_0x49dee4[_0x207632(0x2bf)]){this[_0x207632(0x29b)](_0x18e6e5,{'val':![],'ack':!![]});if(this['isProVersion'])this[_0x207632(0x1e3)]();}_0x18e6e5['includes'](_0x207632(0x2db))&&_0x49dee4[_0x207632(0x2bf)]&&(this['setState'](_0x18e6e5,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this[_0x207632(0x2b2)][_0x207632(0x265)]&&this['config'][_0x207632(0x265)][_0x207632(0x1d2)](_0x18e6e5)){await this[_0x207632(0x2b4)]();return;}const _0x44ad61=(this[_0x207632(0x2b2)]['devices']||[])[_0x207632(0x2aa)](_0x319c2c=>_0x319c2c['id']===_0x18e6e5);if(_0x44ad61)this[_0x207632(0x2cb)](_0x18e6e5,_0x49dee4,_0x44ad61);}async[a0_0x20a8f3(0x23d)](){const _0x352d16=a0_0x20a8f3,_0x57a3e6=this[_0x352d16(0x2b2)][_0x352d16(0x1a7)];this[_0x352d16(0x2b2)][_0x352d16(0x1f6)]&&_0x57a3e6&&(this[_0x352d16(0x28c)]['info'](_0x352d16(0x266)+_0x57a3e6+_0x352d16(0x302)),await this[_0x352d16(0x1fa)](_0x57a3e6+'.communicate.request'));}async[a0_0x20a8f3(0x26a)](_0x374c01){const _0x53fa80=a0_0x20a8f3;let _0x1dad70=_0x374c01;_0x374c01[_0x53fa80(0x2e1)]('[')&&(_0x1dad70=_0x374c01['substring'](_0x374c01[_0x53fa80(0x251)](']')+0x1));if(_0x1dad70==='COGNI_CONFIRM_OK')this[_0x53fa80(0x28c)]['info'](_0x53fa80(0x293)),await this[_0x53fa80(0x2c7)](_0x53fa80(0x1e5),{'val':![],'ack':!![]}),await this[_0x53fa80(0x2c7)](_0x53fa80(0x20d),{'val':_0x53fa80(0x1c6),'ack':!![]}),this[_0x53fa80(0x30c)]=![],this[_0x53fa80(0x31c)](_0x53fa80(0x27b),![]);else _0x1dad70===_0x53fa80(0x260)&&(this['log']['warn'](_0x53fa80(0x256)),this[_0x53fa80(0x31c)]('ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]));}async['onMessage'](_0x1915ee){const _0x3a6962=a0_0x20a8f3;if(typeof _0x1915ee===_0x3a6962(0x2c1)&&_0x1915ee[_0x3a6962(0x2ad)])try{if(_0x1915ee[_0x3a6962(0x1ff)]==='testApiKey'){}else{if(_0x1915ee[_0x3a6962(0x1ff)]===_0x3a6962(0x1cc)){const _0x1f6952=await this[_0x3a6962(0x31c)](_0x3a6962(0x1d3),!![],!![]);this['sendTo'](_0x1915ee[_0x3a6962(0x1f4)],_0x1915ee[_0x3a6962(0x1ff)],{'success':_0x1f6952>0x0,'message':_0x1f6952+'\x20sent'},_0x1915ee[_0x3a6962(0x2c2)]);}else{if(_0x1915ee[_0x3a6962(0x1ff)]==='getLtmData'){if(!this[_0x3a6962(0x2a8)])return this[_0x3a6962(0x295)](_0x1915ee[_0x3a6962(0x1f4)],_0x1915ee['command'],{'success':![],'isPro':![]},_0x1915ee[_0x3a6962(0x2c2)]);let _0x2824a5={'status':_0x3a6962(0x28b),'details':'','lastCheck':0x0};try{_0x2824a5[_0x3a6962(0x284)]=(await this[_0x3a6962(0x1e9)](LTM_DP_DRIFT_STATUS))[_0x3a6962(0x2bf)],_0x2824a5['details']=(await this[_0x3a6962(0x1e9)](LTM_DP_DRIFT_DETAILS))[_0x3a6962(0x2bf)],_0x2824a5['lastCheck']=(await this[_0x3a6962(0x1e9)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x17f70b){}const _0x57d410=this[_0x3a6962(0x1ec)]||[];this['sendTo'](_0x1915ee['from'],_0x1915ee[_0x3a6962(0x1ff)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x3a6962(0x219)],'driftAnalysis':_0x2824a5,'analysisHistory':_0x57d410},_0x1915ee['callback']);}else{if(_0x1915ee['command']===_0x3a6962(0x1c9)){const _0x4dc4d7=this[_0x3a6962(0x219)][_0x3a6962(0x1ce)],_0x114e1e=this[_0x3a6962(0x2c6)][_0x3a6962(0x2b7)](_0x3e6bb5=>_0x3e6bb5[_0x3a6962(0x2b1)]>new Date()[_0x3a6962(0x20b)](0x0,0x0,0x0,0x0))[_0x3a6962(0x1ce)];let _0x20c6d2={'status':_0x3a6962(0x28b)};try{_0x20c6d2[_0x3a6962(0x284)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x4e366b){}let _0x3de8ed=null;!this[_0x3a6962(0x264)]&&(_0x3de8ed=this[_0x3a6962(0x2b2)]['geminiApiKey']?'KI-Modell\x20nicht\x20initialisiert\x20(Neustart\x20erforderlich?)':_0x3a6962(0x298));let _0x4f7bf9={'detected':![],'description':''};try{const _0x43ce6b=await this[_0x3a6962(0x1e9)]('analysis.automation.patternDetected'),_0x2368f3=await this[_0x3a6962(0x1e9)](_0x3a6962(0x2f9));_0x43ce6b&&_0x43ce6b[_0x3a6962(0x2bf)]&&(_0x4f7bf9['detected']=!![],_0x4f7bf9[_0x3a6962(0x268)]=_0x2368f3?_0x2368f3['val']:'');}catch(_0x4370c2){}this[_0x3a6962(0x295)](_0x1915ee['from'],_0x1915ee[_0x3a6962(0x1ff)],{'success':!![],'eventHistory':this[_0x3a6962(0x2c6)]['slice'](0x0,0xf),'stats':{'digestCount':_0x4dc4d7,'eventCountToday':_0x114e1e,'driftStatus':_0x20c6d2[_0x3a6962(0x284)],'isPresent':this[_0x3a6962(0x258)],'minDays':this[_0x3a6962(0x2b2)]['minDaysForBaseline']||0x7,'stbDays':this[_0x3a6962(0x2b2)][_0x3a6962(0x226)]||0xe,'ltbDays':this[_0x3a6962(0x2b2)][_0x3a6962(0x292)]||0x3c,'systemError':_0x3de8ed},'automation':_0x4f7bf9},_0x1915ee[_0x3a6962(0x2c2)]);}else{if(_0x1915ee[_0x3a6962(0x1ff)]===_0x3a6962(0x212)){}else{if(_0x1915ee[_0x3a6962(0x1ff)]==='scanDevices')try{const _0x488b82=await this['scanForDevices'](_0x1915ee[_0x3a6962(0x2ad)]||{});this[_0x3a6962(0x295)](_0x1915ee[_0x3a6962(0x1f4)],_0x1915ee[_0x3a6962(0x1ff)],{'success':!![],'devices':_0x488b82},_0x1915ee[_0x3a6962(0x2c2)]);}catch(_0xab51c8){this[_0x3a6962(0x295)](_0x1915ee[_0x3a6962(0x1f4)],_0x1915ee[_0x3a6962(0x1ff)],{'success':![],'error':_0xab51c8[_0x3a6962(0x2ad)]},_0x1915ee['callback']);}}}}}}}catch(_0x7c94bc){}}async[a0_0x20a8f3(0x2cb)](_0x449a3c,_0x45f10a,_0x204f85){const _0x574812=a0_0x20a8f3;if(!_0x204f85[_0x574812(0x1ea)]&&this[_0x574812(0x224)][_0x449a3c]===_0x45f10a[_0x574812(0x2bf)])return;this[_0x574812(0x224)][_0x449a3c]=_0x45f10a[_0x574812(0x2bf)];if(this[_0x574812(0x28a)])return;const _0x2f2e7b=await this[_0x574812(0x2b4)]();if(_0x2f2e7b){if(!this[_0x574812(0x258)])await this['setPresence'](!![]);}else{const _0x1618c0=_0x204f85[_0x574812(0x222)]===!![];if(_0x1618c0)this[_0x574812(0x1ca)]();else{if(this[_0x574812(0x30f)])this[_0x574812(0x306)]();if(!this[_0x574812(0x258)]&&this[_0x574812(0x2cf)]===SYSTEM_MODES[_0x574812(0x30a)])await this[_0x574812(0x21e)](!![]);}}const _0x6b9d80={'timestamp':_0x45f10a['ts'],'id':_0x449a3c,'name':_0x204f85['name'],'value':_0x45f10a[_0x574812(0x2bf)],'location':_0x204f85[_0x574812(0x313)],'type':_0x204f85[_0x574812(0x2e0)]};this['eventHistory']['unshift'](_0x6b9d80);if(this[_0x574812(0x2c6)][_0x574812(0x1ce)]>HISTORY_MAX_SIZE)this['eventHistory'][_0x574812(0x254)]();await this[_0x574812(0x2c7)](_0x574812(0x304),{'val':JSON[_0x574812(0x2cc)](_0x6b9d80),'ack':!![]}),await this[_0x574812(0x2c7)](_0x574812(0x21c),{'val':JSON[_0x574812(0x2cc)](this[_0x574812(0x2c6)]),'ack':!![]}),this[_0x574812(0x221)][_0x574812(0x1aa)]({'timestamp':new Date(_0x45f10a['ts'])[_0x574812(0x314)](),'sensorName':_0x204f85[_0x574812(0x1df)],'location':_0x204f85[_0x574812(0x313)],'value':_0x45f10a['val']}),await this[_0x574812(0x308)]();}async['runGeminiAnalysis'](_0x5f0326=''){const _0x2a6b07=a0_0x20a8f3;if(!this[_0x2a6b07(0x264)]){this[_0x2a6b07(0x28c)]['warn'](_0x2a6b07(0x203));return;}const _0x64c2af=this[_0x2a6b07(0x2c6)][_0x2a6b07(0x1ce)]>0x0?this[_0x2a6b07(0x2c6)]:[{'note':_0x2a6b07(0x237)}],_0x5c8f6e=PERSONA_MAPPING[this['config']['aiPersona']||_0x2a6b07(0x301)],_0x19b051=this[_0x2a6b07(0x2b2)]['livingContext']||'',_0x4f2e2f=this[_0x2a6b07(0x2cf)],_0x5839ce=await this[_0x2a6b07(0x2e8)](),_0x43ece9=await this['getCalendarContext'](),_0x2b77e5=(_0x5839ce+'\x20'+_0x43ece9)[_0x2a6b07(0x312)](),_0x3e406c=new Date(),_0x4f7473=_0x3e406c[_0x2a6b07(0x2a9)](_0x2a6b07(0x1fd),{'weekday':_0x2a6b07(0x210),'hour':_0x2a6b07(0x1ed),'minute':_0x2a6b07(0x1ed)});let _0x2c55dc=_0x2a6b07(0x263);const _0x3dc6d7=this[_0x2a6b07(0x219)][_0x2a6b07(0x1ce)];if(this[_0x2a6b07(0x2a8)]&&_0x3dc6d7>=(this[_0x2a6b07(0x2b2)][_0x2a6b07(0x288)]||0x7)){const _0xad3560=this[_0x2a6b07(0x219)]['slice'](-(this[_0x2a6b07(0x2b2)][_0x2a6b07(0x226)]||0xe));_0x2c55dc='Phase\x202:\x20ACUTE\x20MONITORING.\x20STB\x20(Last\x2014d):\x20'+JSON[_0x2a6b07(0x2cc)](_0xad3560)+'.';if(_0x3dc6d7>=0x1e)_0x2c55dc+=_0x2a6b07(0x22e);}const _0x255fa1=_0x2a6b07(0x2b6)+_0x4f7473+_0x2a6b07(0x2a4)+_0x2b77e5+_0x2a6b07(0x24b),_0x23d93b=_0x2a6b07(0x1f2)+_0x4f7473+_0x2a6b07(0x2fe)+_0x4f2e2f+_0x2a6b07(0x2fa)+(this['isPresent']?'Ja':'Nein')+_0x2a6b07(0x274)+_0x19b051+_0x2a6b07(0x1da)+_0x5c8f6e+_0x2a6b07(0x27a)+_0x2c55dc+'\x20'+(_0x5f0326?_0x5f0326:'')+_0x2a6b07(0x24b)+_0x255fa1+_0x2a6b07(0x26b)+JSON[_0x2a6b07(0x2cc)](_0x64c2af)+_0x2a6b07(0x1e2);try{const _0x218822=await this['geminiModel'][_0x2a6b07(0x1d8)](_0x23d93b),_0x4873d2=_0x218822['response'][_0x2a6b07(0x1cf)]()[_0x2a6b07(0x205)](/```json|```/g,'')['trim'](),_0x4b542b=JSON[_0x2a6b07(0x2cd)](_0x4873d2);await this[_0x2a6b07(0x2c7)](_0x2a6b07(0x1c1),{'val':_0x4873d2,'ack':!![]}),await this[_0x2a6b07(0x2c7)](_0x2a6b07(0x20d),{'val':_0x4b542b['activity']['alertReason']||'','ack':!![]}),await this[_0x2a6b07(0x2c7)](_0x2a6b07(0x2c5),{'val':_0x4b542b[_0x2a6b07(0x1f5)][_0x2a6b07(0x20f)]||_0x2a6b07(0x28b),'ack':!![]});const _0x2a940f=_0x4b542b['comfort'][_0x2a6b07(0x1ee)],_0x4a985e=this[_0x2a6b07(0x2a8)]?_0x2a940f[_0x2a6b07(0x207)]:![];await this['setStateAsync']('analysis.automation.patternDetected',{'val':_0x4a985e,'ack':!![]});let _0x332264=_0x2a6b07(0x2dc);if(this[_0x2a6b07(0x2a8)])_0x332264=_0x4a985e?_0x2a940f[_0x2a6b07(0x268)]:'Keine\x20neuen\x20Automatisierungs-Muster\x20erkannt.';await this[_0x2a6b07(0x2c7)](_0x2a6b07(0x2f9),{'val':_0x332264,'ack':!![]});if(_0x4b542b[_0x2a6b07(0x1f5)][_0x2a6b07(0x24d)]||_0x4b542b[_0x2a6b07(0x1f5)]['isEmergency']){await this[_0x2a6b07(0x2c7)](_0x2a6b07(0x1e5),{'val':!![],'ack':!![]});if(!this[_0x2a6b07(0x30c)]||_0x4b542b[_0x2a6b07(0x1f5)][_0x2a6b07(0x204)]){const _0x226dd5=_0x4b542b['activity'][_0x2a6b07(0x204)]?_0x2a6b07(0x1d5):'âš ï¸\x20Alarm';this[_0x2a6b07(0x31c)](_0x226dd5+':\x20'+_0x4b542b[_0x2a6b07(0x1f5)][_0x2a6b07(0x25c)],![],_0x4b542b[_0x2a6b07(0x1f5)][_0x2a6b07(0x204)]);}}else await this[_0x2a6b07(0x2c7)](_0x2a6b07(0x1e5),{'val':![],'ack':!![]});this['lastAlertState']=_0x4b542b[_0x2a6b07(0x1f5)]['isAlert']||_0x4b542b[_0x2a6b07(0x1f5)][_0x2a6b07(0x204)];const _0x23b461={'timestamp':Date[_0x2a6b07(0x257)](),'id':Date[_0x2a6b07(0x257)]()[_0x2a6b07(0x277)](),'analysis':_0x4b542b,'systemMode':_0x4f2e2f,'isPro':this[_0x2a6b07(0x2a8)]};this[_0x2a6b07(0x247)](_0x23b461);}catch(_0x3b0386){this[_0x2a6b07(0x28c)][_0x2a6b07(0x1e6)](_0x2a6b07(0x1b1)+_0x3b0386[_0x2a6b07(0x2ad)]);}}async[a0_0x20a8f3(0x300)](){const _0x152b50=a0_0x20a8f3,_0x52a200=this['config'][_0x152b50(0x239)],_0x15efc5=this['eventHistory'][_0x152b50(0x1ce)]>0x0?this['eventHistory'][0x0]['timestamp']:Date[_0x152b50(0x257)](),_0x457aa2=(Date['now']()-_0x15efc5)/(0x3e8*0x3c*0x3c);let _0x179d39='';this['config'][_0x152b50(0x21b)]&&this[_0x152b50(0x2cf)]===SYSTEM_MODES[_0x152b50(0x30a)]&&this['isPresent']&&(_0x457aa2>_0x52a200&&(_0x179d39=_0x152b50(0x2fb)+_0x457aa2[_0x152b50(0x1b6)](0x1)+_0x152b50(0x242))),this['runGeminiAnalysis'](_0x179d39)[_0x152b50(0x208)](_0x33c941=>this['log'][_0x152b50(0x1e6)](_0x33c941));}async[a0_0x20a8f3(0x1e3)](){}async[a0_0x20a8f3(0x2e4)](){}async[a0_0x20a8f3(0x2e3)](_0x69db5d){return[];}[a0_0x20a8f3(0x1f7)](_0x438b47){const _0x34f349=a0_0x20a8f3;if(typeof _0x438b47===_0x34f349(0x2c1))return _0x438b47;try{return JSON['parse'](_0x438b47);}catch(_0x372ba9){return null;}}async[a0_0x20a8f3(0x31d)](){}async['initHistory'](){const _0x41a786=a0_0x20a8f3;try{const _0x100e07=await this[_0x41a786(0x1e9)](_0x41a786(0x21c));_0x100e07&&_0x100e07[_0x41a786(0x2bf)]&&(this[_0x41a786(0x2c6)]=JSON[_0x41a786(0x2cd)](_0x100e07[_0x41a786(0x2bf)][_0x41a786(0x277)]()));}catch(_0x4e5ec){this[_0x41a786(0x2c6)]=[];}try{const _0x7cf151=await this[_0x41a786(0x1e9)](_0x41a786(0x1c5));if(_0x7cf151&&_0x7cf151[_0x41a786(0x2bf)])this['analysisHistory']=JSON[_0x41a786(0x2cd)](_0x7cf151[_0x41a786(0x2bf)][_0x41a786(0x277)]());}catch(_0x176670){this[_0x41a786(0x1ec)]=[];}}async['initSystemConfig'](){const _0x2f8990=a0_0x20a8f3;try{const _0x169582=await this[_0x2f8990(0x1a8)]('system.config');_0x169582&&_0x169582[_0x2f8990(0x2d0)]&&(this[_0x2f8990(0x23e)]={'latitude':_0x169582['common'][_0x2f8990(0x249)]||0x0,'longitude':_0x169582['common'][_0x2f8990(0x299)]||0x0,'city':_0x169582[_0x2f8990(0x2d0)]['city']||''});}catch(_0x520e1c){}}async['checkLicense'](_0x309f03){const _0x1d5904=a0_0x20a8f3;if(!_0x309f03)return![];this[_0x1d5904(0x1c2)]=await this['getSystemUUID']();if(_0x309f03==='TEST-PRO-KEY'||_0x309f03[_0x1d5904(0x2e1)](_0x1d5904(0x211)))return!![];return![];}async[a0_0x20a8f3(0x2ba)](){const _0x4a4eb4=a0_0x20a8f3;try{const _0x4fe98a=await this['getForeignObjectAsync'](_0x4a4eb4(0x200));if(_0x4fe98a&&_0x4fe98a['native']&&_0x4fe98a['native'][_0x4a4eb4(0x1be)])return _0x4fe98a[_0x4a4eb4(0x2b3)]['uuid'];return _0x4a4eb4(0x2d9);}catch(_0x1a622c){return'uuid-error';}}async[a0_0x20a8f3(0x303)](){}async[a0_0x20a8f3(0x267)](){const _0x30e406=a0_0x20a8f3;await this[_0x30e406(0x281)](_0x30e406(0x2bd),{'type':'channel','common':{'name':_0x30e406(0x2e9)},'native':{}}),await this[_0x30e406(0x281)](SYSTEM_DP_MODE,{'type':_0x30e406(0x1d7),'common':{'name':'System\x20Mode','type':'string','role':_0x30e406(0x1d7),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x30e406(0x30a)],'states':{[SYSTEM_MODES[_0x30e406(0x30a)]]:_0x30e406(0x310),[SYSTEM_MODES[_0x30e406(0x285)]]:'Urlaub',[SYSTEM_MODES[_0x30e406(0x1cd)]]:_0x30e406(0x252),[SYSTEM_MODES[_0x30e406(0x225)]]:_0x30e406(0x1c0)}},'native':{}});}async[a0_0x20a8f3(0x2fd)](){const _0x53160e=a0_0x20a8f3;await this[_0x53160e(0x281)](_0x53160e(0x317),{'type':_0x53160e(0x248),'common':{'name':_0x53160e(0x317)},'native':{}}),await this[_0x53160e(0x281)](LTM_DP_RAW_LOG,{'type':_0x53160e(0x1d7),'common':{'name':_0x53160e(0x22d),'type':_0x53160e(0x250),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x53160e(0x281)](LTM_DP_DAILY_DIGESTS,{'type':_0x53160e(0x1d7),'common':{'name':'Daily\x20Digests','type':_0x53160e(0x250),'role':_0x53160e(0x1e1),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_STATUS,{'type':'state','common':{'name':'Processing\x20Status','type':_0x53160e(0x250),'role':_0x53160e(0x1cf),'read':!![],'write':![]},'native':{}}),await this[_0x53160e(0x281)](LTM_DP_TRIGGER_DIGEST,{'type':_0x53160e(0x1d7),'common':{'name':_0x53160e(0x243),'type':_0x53160e(0x201),'role':_0x53160e(0x1d4),'read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x53160e(0x1d7),'common':{'name':_0x53160e(0x25b),'type':_0x53160e(0x250),'role':_0x53160e(0x1cf),'read':!![],'write':![]},'native':{}});}async['checkLtmDriftObjects'](){const _0x5be37d=a0_0x20a8f3;await this[_0x5be37d(0x281)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':'Drift\x20Analysis'},'native':{}}),await this[_0x5be37d(0x281)](LTM_DP_DRIFT_STATUS,{'type':_0x5be37d(0x1d7),'common':{'name':'Drift\x20Status','type':_0x5be37d(0x250),'role':_0x5be37d(0x1d7),'read':!![],'write':![],'def':_0x5be37d(0x28b)},'native':{}}),await this[_0x5be37d(0x281)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':_0x5be37d(0x250),'role':_0x5be37d(0x1cf),'read':!![],'write':![]},'native':{}}),await this[_0x5be37d(0x281)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x5be37d(0x1d7),'common':{'name':'Last\x20Check','type':_0x5be37d(0x1ba),'role':_0x5be37d(0x23f),'read':!![],'write':![]},'native':{}});}async[a0_0x20a8f3(0x1de)](){const _0x3e46fc=a0_0x20a8f3;try{const _0x30ef30=await this[_0x3e46fc(0x1e9)](SYSTEM_DP_MODE);_0x30ef30&&_0x30ef30['val']&&Object[_0x3e46fc(0x278)](SYSTEM_MODES)[_0x3e46fc(0x1d2)](_0x30ef30[_0x3e46fc(0x2bf)])?this['currentSystemMode']=_0x30ef30['val']:(this['currentSystemMode']=SYSTEM_MODES[_0x3e46fc(0x30a)],await this[_0x3e46fc(0x2c7)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3e46fc(0x30a)],'ack':!![]}));}catch(_0x1be6ac){this[_0x3e46fc(0x2cf)]=SYSTEM_MODES['NORMAL'];}}async[a0_0x20a8f3(0x2ca)](){const _0x5000d8=a0_0x20a8f3;try{const _0x29b197=await this[_0x5000d8(0x1e9)](LTM_DP_RAW_LOG);if(_0x29b197&&_0x29b197[_0x5000d8(0x2bf)])this['rawEventLog']=JSON[_0x5000d8(0x2cd)](_0x29b197[_0x5000d8(0x2bf)]);}catch(_0x40c37d){this[_0x5000d8(0x221)]=[];}}async[a0_0x20a8f3(0x308)](){const _0x2979f0=a0_0x20a8f3;this[_0x2979f0(0x221)][_0x2979f0(0x1ce)]>RAW_LOG_MAX_SIZE&&this['rawEventLog'][_0x2979f0(0x2a0)](0x0,this[_0x2979f0(0x221)][_0x2979f0(0x1ce)]-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x2979f0(0x2cc)](this[_0x2979f0(0x221)]),'ack':!![]});}async['loadDailyDigests'](){const _0x2247f8=a0_0x20a8f3;try{const _0x33131c=await this[_0x2247f8(0x1e9)](LTM_DP_DAILY_DIGESTS);if(_0x33131c&&_0x33131c[_0x2247f8(0x2bf)])this['dailyDigests']=JSON[_0x2247f8(0x2cd)](_0x33131c['val']);}catch(_0x59725e){this['dailyDigests']=[];}await this[_0x2247f8(0x1b2)]();}async[a0_0x20a8f3(0x23a)](_0x394a95=!![]){const _0x479bce=a0_0x20a8f3,_0x585941=this[_0x479bce(0x2b2)][_0x479bce(0x292)]||0x3c;this[_0x479bce(0x219)][_0x479bce(0x1ce)]>_0x585941&&this[_0x479bce(0x219)][_0x479bce(0x2a0)](0x0,this['dailyDigests'][_0x479bce(0x1ce)]-_0x585941);await this[_0x479bce(0x2c7)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x479bce(0x2cc)](this[_0x479bce(0x219)]),'ack':!![]});if(_0x394a95)await this[_0x479bce(0x1b2)]();}async[a0_0x20a8f3(0x247)](_0x1e1e57){const _0x232231=a0_0x20a8f3;this[_0x232231(0x1ec)]['unshift'](_0x1e1e57);if(this[_0x232231(0x1ec)][_0x232231(0x1ce)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x232231(0x1ec)][_0x232231(0x254)]();await this['setStateAsync'](_0x232231(0x1c5),{'val':JSON['stringify'](this[_0x232231(0x1ec)]),'ack':!![]});}async[a0_0x20a8f3(0x1b2)](){const _0xf1b7df=a0_0x20a8f3;if(!this[_0xf1b7df(0x2a8)]){await this[_0xf1b7df(0x2c7)](LTM_DP_BASELINE_STATUS,{'val':_0xf1b7df(0x2ae),'ack':!![]});return;}const _0x2a5a6f=this[_0xf1b7df(0x219)][_0xf1b7df(0x1ce)]>=(this[_0xf1b7df(0x2b2)][_0xf1b7df(0x288)]||0x7)?_0xf1b7df(0x315)+this[_0xf1b7df(0x219)]['length']+_0xf1b7df(0x1bd):_0xf1b7df(0x255)+this[_0xf1b7df(0x219)][_0xf1b7df(0x1ce)]+'/'+(this[_0xf1b7df(0x2b2)][_0xf1b7df(0x288)]||0x7)+')';await this[_0xf1b7df(0x2c7)](LTM_DP_BASELINE_STATUS,{'val':_0x2a5a6f,'ack':!![]});}async[a0_0x20a8f3(0x233)](){const _0x439133=a0_0x20a8f3,_0x1b5df1=this[_0x439133(0x2b2)]['devices'];if(_0x1b5df1&&_0x1b5df1[_0x439133(0x1ce)]>0x0){this[_0x439133(0x28c)][_0x439133(0x2c3)](_0x439133(0x229)+_0x1b5df1[_0x439133(0x1ce)]+_0x439133(0x275));for(const _0x53c64b of _0x1b5df1){if(_0x53c64b['id']){await this['subscribeForeignStatesAsync'](_0x53c64b['id']);try{const _0x53c2d6=await this[_0x439133(0x1c4)](_0x53c64b['id']);if(_0x53c2d6)this[_0x439133(0x224)][_0x53c64b['id']]=_0x53c2d6[_0x439133(0x2bf)];}catch(_0x2e8beb){}}}}}async['initPresenceSubscriptions'](){const _0x389110=a0_0x20a8f3,_0x91c9dd=this[_0x389110(0x2b2)][_0x389110(0x265)]||[];if(_0x91c9dd[_0x389110(0x1ce)]>0x0){this[_0x389110(0x28c)][_0x389110(0x2c3)]('Subscribing\x20to\x20'+_0x91c9dd[_0x389110(0x1ce)]+_0x389110(0x27e));for(const _0x14ee2c of _0x91c9dd){await this[_0x389110(0x1fa)](_0x14ee2c);}try{await this[_0x389110(0x2b4)]();}catch(_0x58c870){}}}async[a0_0x20a8f3(0x2e8)](){const _0x5d9b23=a0_0x20a8f3;try{if(!this[_0x5d9b23(0x2b2)]['useWeather'])return _0x5d9b23(0x29f);let _0x7966a6='';const _0x5223a8=this[_0x5d9b23(0x2b2)][_0x5d9b23(0x220)];if(_0x5223a8)try{if(_0x5223a8[_0x5d9b23(0x1d2)]('accuweather')){const _0x951d5e=await this[_0x5d9b23(0x1c4)](_0x5223a8+'.Summary.Current');if(_0x951d5e&&_0x951d5e[_0x5d9b23(0x2bf)])_0x7966a6=_0x951d5e['val'];}else{if(_0x5223a8['includes'](_0x5d9b23(0x276))){const _0x3df5ee=await this['getForeignStateAsync'](_0x5223a8+_0x5d9b23(0x2da));if(_0x3df5ee&&_0x3df5ee[_0x5d9b23(0x2bf)])_0x7966a6=_0x3df5ee['val'];}else{if(_0x5223a8['includes'](_0x5d9b23(0x1b3))){const _0x276a6a=await this['getForeignStateAsync'](_0x5223a8+_0x5d9b23(0x30e));if(_0x276a6a&&_0x276a6a['val'])_0x7966a6=_0x276a6a[_0x5d9b23(0x2bf)];}}}}catch(_0xe2fae1){}if(!_0x7966a6){const _0x494b63=[_0x5d9b23(0x2bc),_0x5d9b23(0x2eb),_0x5d9b23(0x1fb),_0x5d9b23(0x246)];for(const _0x323967 of _0x494b63){try{const _0x9df0e4=await this[_0x5d9b23(0x1a8)](_0x323967);if(_0x9df0e4){if(_0x323967[_0x5d9b23(0x1d2)]('accuweather')){const _0x1dbea0=await this[_0x5d9b23(0x1c4)](_0x323967+_0x5d9b23(0x2ee));if(_0x1dbea0&&_0x1dbea0[_0x5d9b23(0x2bf)]){_0x7966a6=_0x1dbea0['val'];break;}}}}catch(_0x3c2248){}}}return _0x7966a6?'WETTER:\x20'+_0x7966a6:_0x5d9b23(0x269);}catch(_0xce389c){return _0x5d9b23(0x294)+_0xce389c[_0x5d9b23(0x2ad)];}}async[a0_0x20a8f3(0x214)](){const _0x544214=a0_0x20a8f3;try{if(!this[_0x544214(0x2b2)][_0x544214(0x2d1)])return _0x544214(0x26d);let _0x15a827=this[_0x544214(0x2b2)][_0x544214(0x307)]||_0x544214(0x1bb),_0x5ec4fd=this[_0x544214(0x2b2)][_0x544214(0x227)]||[];if(typeof _0x5ec4fd===_0x544214(0x250))_0x5ec4fd=_0x5ec4fd[_0x544214(0x283)](',');try{const _0x21dad7=await this[_0x544214(0x1c4)](_0x15a827+_0x544214(0x24f));if(_0x21dad7&&_0x21dad7['val']){let _0x4616a0=this[_0x544214(0x1f7)](_0x21dad7[_0x544214(0x2bf)]);if(_0x4616a0&&Array[_0x544214(0x22c)](_0x4616a0)){if(_0x5ec4fd[_0x544214(0x1ce)]>0x0)_0x4616a0=_0x4616a0[_0x544214(0x2b7)](_0x1d0738=>_0x5ec4fd[_0x544214(0x1d2)](_0x1d0738[_0x544214(0x230)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x4616a0[_0x544214(0x1ce)]>0x0){const _0x2fd6ac=_0x4616a0[_0x544214(0x235)](0x0,0x3)[_0x544214(0x1e0)](_0x265223=>{const _0x2e6cf1=_0x544214;let _0x28b36b=_0x265223[_0x2e6cf1(0x23f)];if(_0x265223[_0x2e6cf1(0x20a)])_0x28b36b+='\x20'+_0x265223['time'];return _0x28b36b+':\x20'+_0x265223[_0x2e6cf1(0x1d1)]+'\x20('+_0x265223[_0x2e6cf1(0x230)]+')';});return _0x544214(0x2ff)+_0x2fd6ac[_0x544214(0x1f9)](_0x544214(0x209));}else return _0x544214(0x1f0);}}}catch(_0x2f76df){this[_0x544214(0x28c)][_0x544214(0x28e)]('Error\x20reading\x20calendar\x20table:\x20'+_0x2f76df[_0x544214(0x2ad)]);}return _0x544214(0x1b5);}catch(_0x47072c){return _0x544214(0x244)+_0x47072c[_0x544214(0x2ad)];}}async[a0_0x20a8f3(0x2f6)](_0x39bfd5){const _0x41db20=a0_0x20a8f3;try{const _0x27fbd4=await this[_0x41db20(0x1c4)](_0x39bfd5+_0x41db20(0x24f));if(_0x27fbd4&&_0x27fbd4[_0x41db20(0x2bf)]){const _0x3ec7ae=this['tryParse'](_0x27fbd4['val']);if(_0x3ec7ae&&Array[_0x41db20(0x22c)](_0x3ec7ae)){const _0x4f4648=[...new Set(_0x3ec7ae[_0x41db20(0x1e0)](_0x5a19de=>_0x5a19de['_calName'])['filter'](Boolean))];return _0x4f4648['sort']();}}return[];}catch(_0x5c93ea){return this[_0x41db20(0x28c)][_0x41db20(0x1e6)]('getCalendarNames\x20Error:\x20'+_0x5c93ea[_0x41db20(0x2ad)]),[];}}async[a0_0x20a8f3(0x2b4)](){const _0x53d8d3=a0_0x20a8f3;try{const _0x37b34e=this[_0x53d8d3(0x2b2)][_0x53d8d3(0x265)]||[];let _0x4a3414=![];for(const _0x58ac6c of _0x37b34e){try{const _0x5bd47c=await this[_0x53d8d3(0x1c4)](_0x58ac6c);if(_0x5bd47c&&(_0x5bd47c['val']===!![]||_0x5bd47c[_0x53d8d3(0x2bf)]===_0x53d8d3(0x20c)||_0x5bd47c[_0x53d8d3(0x2bf)]===0x1)){_0x4a3414=!![];break;}}catch(_0x40ddf6){}}return _0x4a3414&&(this[_0x53d8d3(0x30f)]&&(this['log'][_0x53d8d3(0x2c3)](_0x53d8d3(0x1c8)),this['abortExitTimer']()),!this[_0x53d8d3(0x258)]&&this[_0x53d8d3(0x2cf)]===SYSTEM_MODES[_0x53d8d3(0x30a)]&&await this[_0x53d8d3(0x21e)](!![])),_0x4a3414;}catch(_0x3eaf02){return this[_0x53d8d3(0x28c)][_0x53d8d3(0x1e6)](_0x53d8d3(0x2a1)+_0x3eaf02[_0x53d8d3(0x2ad)]),![];}}['startExitTimer'](){const _0x518c71=a0_0x20a8f3;this[_0x518c71(0x306)](),this[_0x518c71(0x28a)]=!![],this[_0x518c71(0x27d)]=setTimeout(()=>{const _0x4e9e3d=_0x518c71;this[_0x4e9e3d(0x28a)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this['exitTimer']=setTimeout(()=>{const _0x335f7a=_0x518c71;this[_0x335f7a(0x21e)](![]),this[_0x335f7a(0x30f)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x20a8f3(0x306)](){const _0x33796a=a0_0x20a8f3;if(this[_0x33796a(0x30f)])clearTimeout(this[_0x33796a(0x30f)]);if(this[_0x33796a(0x27d)])clearTimeout(this['exitGraceTimer']);this['exitTimer']=null,this[_0x33796a(0x27d)]=null,this['isGracePeriodActive']=![];}async[a0_0x20a8f3(0x21e)](_0x369021){const _0x36d78d=a0_0x20a8f3;if(this[_0x36d78d(0x258)]===_0x369021)return;this[_0x36d78d(0x258)]=_0x369021,await this['setStateAsync'](_0x36d78d(0x282),{'val':_0x369021,'ack':!![]});}async[a0_0x20a8f3(0x319)](_0x2fdb84){const _0xfe51ec=a0_0x20a8f3;this[_0xfe51ec(0x28c)][_0xfe51ec(0x2c3)](_0xfe51ec(0x2a6)+JSON[_0xfe51ec(0x2cc)](_0x2fdb84));}async[a0_0x20a8f3(0x2ef)](){const _0x51a2a2=a0_0x20a8f3;if(!this['isProVersion']||!this['geminiModel'])return;const _0x30f29c=this[_0x51a2a2(0x2b2)]['ltmStbWindowDays']||0xe;if(this[_0x51a2a2(0x219)][_0x51a2a2(0x1ce)]<_0x30f29c+(this[_0x51a2a2(0x2b2)]['minDaysForBaseline']||0x7)){await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x51a2a2(0x1d6),'ack':!![]});return;}const _0x271f07=this[_0x51a2a2(0x219)][_0x51a2a2(0x235)](-_0x30f29c),_0x2747bf=this[_0x51a2a2(0x219)][_0x51a2a2(0x235)](0x0,this[_0x51a2a2(0x219)][_0x51a2a2(0x1ce)]-_0x30f29c),_0x550206=_0x51a2a2(0x1db)+JSON[_0x51a2a2(0x2cc)](_0x2747bf)+_0x51a2a2(0x28d)+JSON['stringify'](_0x271f07);try{const _0x39d100=await this[_0x51a2a2(0x264)]['generateContent'](_0x550206),_0x2d01f4=JSON[_0x51a2a2(0x2cd)](_0x39d100[_0x51a2a2(0x1ae)][_0x51a2a2(0x1cf)]()[_0x51a2a2(0x205)](/```json|```/g,'')[_0x51a2a2(0x312)]());_0x2d01f4[_0x51a2a2(0x1a9)]&&(await this[_0x51a2a2(0x2c7)](LTM_DP_DRIFT_STATUS,{'val':_0x2d01f4['baselineDrift'],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x2d01f4[_0x51a2a2(0x215)],'ack':!![]}),await this[_0x51a2a2(0x2c7)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x29f643){}}[a0_0x20a8f3(0x30b)](){const _0x478ecf=a0_0x20a8f3;try{if(this[_0x478ecf(0x1d9)])this[_0x478ecf(0x1d9)][_0x478ecf(0x23b)]();if(!this[_0x478ecf(0x2a8)]){this[_0x478ecf(0x2c7)](LTM_DP_STATUS,{'val':_0x478ecf(0x2ae),'ack':!![]});return;}this[_0x478ecf(0x1d9)]=schedule[_0x478ecf(0x2f3)](LTM_SCHEDULE,()=>this[_0x478ecf(0x1e3)]());}catch(_0x51a838){this[_0x478ecf(0x28c)][_0x478ecf(0x1e6)](_0x478ecf(0x216)+_0x51a838[_0x478ecf(0x2ad)]);}}['setupModeResetScheduler'](){const _0x2acbde=a0_0x20a8f3;try{if(this[_0x2acbde(0x259)])this[_0x2acbde(0x259)][_0x2acbde(0x23b)]();this[_0x2acbde(0x259)]=schedule[_0x2acbde(0x2f3)](MODE_RESET_SCHEDULE,async()=>{const _0x3aa497=_0x2acbde;await this[_0x3aa497(0x1de)](),AUTO_RESET_MODES[_0x3aa497(0x1d2)](this[_0x3aa497(0x2cf)])&&await this[_0x3aa497(0x2c7)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x4bc930){this['log']['error'](_0x2acbde(0x1b0)+_0x4bc930[_0x2acbde(0x2ad)]);}}[a0_0x20a8f3(0x25a)](){const _0x15087c=a0_0x20a8f3;try{if(this[_0x15087c(0x26c)])clearInterval(this[_0x15087c(0x26c)]);if(!this[_0x15087c(0x2a8)])return;this['driftAnalysisTimer']=setInterval(()=>this[_0x15087c(0x2ef)](),(this[_0x15087c(0x2b2)][_0x15087c(0x280)]||0x18)*0x36ee80),setTimeout(()=>this[_0x15087c(0x2ef)](),0x1388);}catch(_0x473309){this[_0x15087c(0x28c)]['error'](_0x15087c(0x296)+_0x473309['message']);}}[a0_0x20a8f3(0x311)](){const _0x40bbc=a0_0x20a8f3;try{if(this['briefingJob'])this['briefingJob'][_0x40bbc(0x23b)]();if(!this[_0x40bbc(0x2b2)][_0x40bbc(0x2a7)])return;const _0x21c470=(this[_0x40bbc(0x2b2)][_0x40bbc(0x23c)]||_0x40bbc(0x21f))['split'](':'),_0x3f6297=parseInt(_0x21c470[0x0])||0x8,_0x5d3285=parseInt(_0x21c470[0x1])||0x0,_0x2ec5ab=_0x5d3285+'\x20'+_0x3f6297+'\x20*\x20*\x20*';this['log'][_0x40bbc(0x2c3)](_0x40bbc(0x289)+_0x3f6297+':'+(_0x5d3285<0xa?'0'+_0x5d3285:_0x5d3285)),this[_0x40bbc(0x1fc)]=schedule[_0x40bbc(0x2f3)](_0x2ec5ab,()=>{this['sendMorningBriefing']();});}catch(_0x165246){this['log'][_0x40bbc(0x1e6)](_0x40bbc(0x2ea)+_0x165246[_0x40bbc(0x2ad)]);}}async[a0_0x20a8f3(0x31c)](_0x5b0216,_0x5b937d=![],_0x46514f=![]){const _0x63d1a5=a0_0x20a8f3;this[_0x63d1a5(0x28c)][_0x63d1a5(0x2c3)]((_0x5b937d?_0x63d1a5(0x202):'')+'Sending\x20notification:\x20\x22'+_0x5b0216+'\x22');const _0x2a9cb0=this[_0x63d1a5(0x2b2)];let _0x42b1d5=0x0;if(_0x2a9cb0[_0x63d1a5(0x1f6)]&&_0x2a9cb0[_0x63d1a5(0x1a7)]){let _0x4019b5={};(_0x5b0216[_0x63d1a5(0x1d2)](_0x63d1a5(0x223))||_0x46514f)&&(_0x4019b5={'reply_markup':{'inline_keyboard':[[{'text':_0x63d1a5(0x1ab),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x63d1a5(0x22a),'callback_data':_0x63d1a5(0x260)}]]}}),await this[_0x63d1a5(0x2e5)](_0x2a9cb0[_0x63d1a5(0x1a7)],_0x63d1a5(0x1c3),{'text':_0x5b0216,'user':_0x2a9cb0[_0x63d1a5(0x2ec)],..._0x4019b5}),_0x42b1d5++;}if(_0x2a9cb0[_0x63d1a5(0x1af)]&&_0x2a9cb0['notifyPushoverInstance']){let _0x2b81ec={'message':_0x5b0216,'title':_0x46514f?'ðŸš¨\x20EMERGENCY':_0x63d1a5(0x2f0),'priority':_0x46514f?0x2:0x1,'device':_0x2a9cb0['notifyPushoverRecipient']};_0x46514f&&(_0x2b81ec[_0x63d1a5(0x2c4)]=0x1e,_0x2b81ec[_0x63d1a5(0x2d7)]=0xe10,_0x2b81ec[_0x63d1a5(0x29c)]=_0x63d1a5(0x20e)),await this[_0x63d1a5(0x2e5)](_0x2a9cb0[_0x63d1a5(0x1cb)],_0x63d1a5(0x1c3),_0x2b81ec),_0x42b1d5++;}return _0x2a9cb0[_0x63d1a5(0x272)]&&_0x2a9cb0[_0x63d1a5(0x231)]&&(await this[_0x63d1a5(0x2e5)](_0x2a9cb0[_0x63d1a5(0x231)],'send',{'text':_0x5b0216,'to':_0x2a9cb0['notifyEmailRecipient']}),_0x42b1d5++),_0x42b1d5;}}function a0_0xd2cd(_0x1c3a02,_0x5b6df5){const _0x2ac5d2=a0_0x3c47();return a0_0xd2cd=function(_0x338ffc,_0x1de1f1){_0x338ffc=_0x338ffc-0x1a7;let _0x3c47c3=_0x2ac5d2[_0x338ffc];return _0x3c47c3;},a0_0xd2cd(_0x1c3a02,_0x5b6df5);}if(require['main']!==module)module[a0_0x20a8f3(0x1bf)]=_0x433f62=>new CogniLiving(_0x433f62);else new CogniLiving();