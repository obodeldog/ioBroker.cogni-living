const a0_0x32d222=a0_0x264d;(function(_0x2afefd,_0x3eb1f6){const _0x3f5e4a=a0_0x264d,_0x2d820c=_0x2afefd();while(!![]){try{const _0x399d2b=parseInt(_0x3f5e4a(0x222))/0x1*(parseInt(_0x3f5e4a(0x22b))/0x2)+-parseInt(_0x3f5e4a(0x2dd))/0x3+parseInt(_0x3f5e4a(0x242))/0x4+-parseInt(_0x3f5e4a(0x2ae))/0x5+-parseInt(_0x3f5e4a(0x279))/0x6+-parseInt(_0x3f5e4a(0x2cf))/0x7*(-parseInt(_0x3f5e4a(0x35d))/0x8)+-parseInt(_0x3f5e4a(0x2c6))/0x9*(parseInt(_0x3f5e4a(0x202))/0xa);if(_0x399d2b===_0x3eb1f6)break;else _0x2d820c['push'](_0x2d820c['shift']());}catch(_0x148ab2){_0x2d820c['push'](_0x2d820c['shift']());}}}(a0_0x437c,0x3a383));const a0_0x4201aa=(function(){let _0x1d5840=!![];return function(_0xd75a4f,_0x5da63f){const _0x2ec0ac=_0x1d5840?function(){const _0x1dedfc=a0_0x264d;if(_0x5da63f){const _0xa475f6=_0x5da63f[_0x1dedfc(0x2f0)](_0xd75a4f,arguments);return _0x5da63f=null,_0xa475f6;}}:function(){};return _0x1d5840=![],_0x2ec0ac;};}()),a0_0x1965f5=a0_0x4201aa(this,function(){const _0x260f1b=a0_0x264d;return a0_0x1965f5[_0x260f1b(0x2fb)]()[_0x260f1b(0x30e)](_0x260f1b(0x28d))[_0x260f1b(0x2fb)]()[_0x260f1b(0x3a0)](a0_0x1965f5)['search']('(((.+)+)+)+$');});function a0_0x437c(){const _0x2fafb7=['ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','ENERGY_TRAIN_RESULT','extendObjectAsync','communicate.request','rmSync','KI-Modell\x20nicht\x20initialisiert','connection','livingContext','cover','Pattern\x20Detected','1389035sqOrUw','daswetter','@iobroker/adapter-core','LTM.trainingData.thermodynamics','filter','icons-mfd.','stderr','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','log','ðŸŒ…\x20Daily\x20Briefing:\x0a','ANALYZE_TREND','uuid','/100.\x20OUTPUT:\x20Text.','cpu_feature_guard','No\x20instance','push','analysis.trigger','useWeather','bewegung','Trend\x20Value','\x20=\x20','blind','setObjectNotExistsAsync','info','891oxqnJm','analysis.automation.targetValue','NORMAL','enum.functions.*','scheduleJob','analysis.triggerBriefing','LTM.driftAnalysis.baselineDrift','âš ï¸\x20ALARM:\x20','exitGraceTimer','3032603MrvkBj','setpoint','door','online','dismissAutomation','inactivityMonitoringEnabled','BUTLER\x20Execution\x20Error:\x20','.forecast.current.temperature','User\x20dismissed\x20automation\x20proposal.','Train\x20Health','analysis.training.triggerSecurity','telegram','setStateAsync','events.history','1277055bfEbao','onStateChange','python3\x20-m\x20venv\x20\x22','Aktiv\x20(','Last\x20raw\x20event','Anomaly\x20Detected','working','location','âš ï¸\x20VENV\x20missing.\x20Attempting\x20install...','normal','toLocaleTimeString','targetValue','testApiKey','driftDetails','notifyTelegramInstance','ðŸ\x20Python\x20Pong','Started...','latitude','âœ…\x20Alles\x20OK\x20(Reset)]','apply','Feedback:\x20','getMonth','ltmDriftCheckIntervalHours','isAlert','shutter','reachable','substring','existsSync','onReady','python_service','toString','fenster','analysis.health','automationProposal','geminiApiKey','writable','getOverviewData','N/A\x20(Learning)','data','analysis.health.isAnomaly','GUEST','submitFeedback','minDaysForBaseline','json','generateContent','Sequences','.Current.Temperature','ANOMALY','Kein\x20API\x20Key.','search','trim','analysis.energy.insulationScore','indicator','node-schedule','type','getForeignObjectAsync','LTM','\x20->\x20','includes','unload','accuweather','KALENDER:\x20','occupancy','common','application/json','ltmJob','endsWith','button','response','some','TREND_RESULT','scriptProblem','COGNI_REQUEST_CALL','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','No\x20module\x20named','namespace','Anomaly\x20Score','System','replace','description','lampe','WiFi\x20Presence\x20detected.','energy','Alert\x20Status','analysis.isAlert','join','subscribeForeignStatesAsync','requirements.txt','Success:\x20','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','analysis.automation.patternDetected','Health\x20Analysis','set_temperature','sendToAsync','N/A','0\x204\x20*\x20*\x20*','exitTimer','text.alarm','onMessage','unknown','Trigger\x20Analysis','send','notifyTelegramEnabled','LTM.baselineStatus','COGNI_CONFIRM_OK','kontakt','object','getEnums','write','Bibliotheken\x20nicht\x20gefunden','firmware','weatherunderground','val','Gemini\x20Init\x20Error:\x20','analysis.health.lastCheck','analysis.activitySummary','toLowerCase','geminiModel','isGracePeriodActive','Success','Sec-Training\x20started...','cancel','system.config','round','Insulation\x20Score','ðŸ› ï¸\x20MAINTENANCE\x20MODE:\x20Installing\x20Python\x20dependencies.\x20Do\x20not\x20restart!','prÃ¤senz','link_quality','8QYixEz','position','LTM.dailyDigests','sleepScore','analysis.automation.description','ical.0','string','Target\x20Value','LTM.processingStatus','LTM\x20Sched\x20Error:\x20','events.history_debug_00','isExit','analysis.health.trendDiagnosis','dependencyInstallInProgress','isPresent','close','brightness','licenseKey','notifyEmailEnabled','Invalid\x20JSON:\x20','testContext','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','forEach','summary','analysis.automation.autoApply','switch','warn','Target\x20ID','analysis.automation.triggerAction','platform','event','LTM.driftAnalysis.driftDetails','analysis.security.lastScore','party','08:00','eventHistory','sendTo','direction','message','presence','date','triggerBriefing','[PYTHON\x20ERR]\x20','system.mode','systemConfig','sensorLastValues','outdoorSensorId','aiPersona','âœ…\x20INFRASTRUCTURE\x20READY.\x20Starting\x20Service...','number','Fokus\x20auf\x20Familienroutinen.','config','startsWith','modeResetJob','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','targetId','activityLevel','Training\x20Error:\x20','instance','detected','HEALTH_RESULT','.\x20ANWESEND:\x20','_calName','maintenance','.\x20DATEN:\x20Schlaf\x20','briefingEnabled','scanDevices','constructor','Kalender:\x20Deaktiviert','python.exe','weatherInstance','splice','Daily\x20Digests','Train\x20Security','update','simple-api.','Restoring\x20sensor\x20cache\x20from\x20history\x20(','ltmStbWindowDays','alertReason','models/gemini-flash-latest','notifyPushoverInstance','AI\x20Training','Thermodynamics','shift','generic','indexOf','PARTY','Missing\x20data','Err:\x20','rssi','openweathermap','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','onUnload','analysis.security.lastCheck','analysis.security','Keine\x20Termine','LTM.trainingData.sequences','sound','getTime','.data.table','ðŸ\x20Guardian\x20Diagnosis:\x20','@google/generative-ai','history.',')\x20-\x20STRICT\x20ORDER\x20FIX','boolean','stringify','âŒ\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv','ðŸ\x20Using\x20VENV\x20Python:\x20','briefingJob','Kein\x20API\x20Key!','âš ï¸\x20SECURITY\x20ALARM:\x20','Trend','Analysiere\x20ausgewogen.','setState','getCalendarNames','0\x203\x20*\x20*\x20*','VACATION','subscribeStates','getGenerativeModel','\x20*\x20*\x20*','toFixed','4610zDHJLx','getDate','Skipped\x20(No\x20AI\x20or\x20Data)','.\x20WETTER:\x20','from','tÃ¼r','status','PONG','win32','pip.exe','pythonProcess','cogni-living','debug','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','ANALYZE_SEQUENCE','analysis.analysisHistory','Gemini\x20AI\x20initialized.','expire','Auto\x20Apply','temperature','getHours','analysis.energy','currentSystemMode','Fokus\x20auf\x20Komfort.','analysisTimer','kill','baselineDrift','value','temperatur','.\x20EVENTS:\x20','system.isPresent','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','226gfPmcP','.\x20EMERGENCY:\x20','slice','LTM.rawEventLog','length','Cogni-Living','name','unshift','bind','2216CjNLCL','Briefing\x20Sched\x20Error:\x20','info.','Trigger\x20Briefing','window','values','OK:\x20','.venv','indicator.alarm','[LOG]','LTM.driftAnalysis.lastCheck','notifyPushoverRecipient','Activity\x20Summary','devices','heating','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','analysisInterval','payload','channel','analysis.training.status','\x20events)...','now','path','1238860MGXrRW','analysis.alertReason','.communicate.request','contact','Activity-Level','Train\x20Energy','Scripts','inactivityThresholdHours','bin','enum','command','dailyDigests','fill','licht','analysis.automation.targetId','apiKey','find','insulation','âš ï¸\x20Python\x20missing\x20libs.\x20Auto-Install\x20triggered.','state','automation.triggerAction','ðŸ§ \x20Triggering\x20Security\x20Training...','Lernphase\x20(','python','presenceDevices','light','siren','âš ï¸\x20Broken\x20venv\x20detected.\x20Repairing...','map','lastAlertState','ðŸ\x20Stopping\x20Python...','SECURITY_RESULT','admin.','triggerDailyDigest','.NextHours.Location_1.Day_1.current.temp_value','.\x20KONTEXT:\x20','genAI','system','pop','delObjectAsync','callback','TRAIN_SECURITY','Alert\x20Reason','driftAnalysisTimer','ltmLtbWindowDays','motion','health','analysis.history_debug_00','notifyTelegramRecipient','TRAIN_ENERGY','Heating\x20Score','analysis.training.triggerHealth','Event\x20History','javascript.','ROLLE:\x20Assistent.\x20AUFGABE:\x20Schreibe\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','34524eQRLTA','HARD\x20WATCHDOG:\x20No\x20activity\x20for\x20','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','error','logDuplicates','.\x20SYSTEM_MODE:\x20','rawEventLog','PRIORITÃ„T:\x20Gesundheit/AAL.','Security\x20Monitor','text','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','Alarm','getStateAsync','actual_temperature','timestamp','getForeignStateAsync','parse','main','events.lastEvent','systemUUID','(((.+)+)+)+$','isProVersion','system.presenceWho','âœ…\x20HEALTH\x20TRAINED:\x20','\x22\x20install\x20-r\x20\x22','ðŸš¨\x20EMERGENCY','config_pending','targetposition','LTM.triggerDailyDigest','split','longitude','analysis.energy.heatingScore','getFullYear','analysisHistory','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','toISOString','notifyEmailRecipient','useCalendar','notifyEmailInstance','echarts.','ack','currentposition','power'];a0_0x437c=function(){return _0x2fafb7;};return a0_0x437c();}a0_0x1965f5();'use strict';const utils=require(a0_0x32d222(0x2b0)),{GoogleGenerativeAI}=require(a0_0x32d222(0x1ee)),schedule=require(a0_0x32d222(0x312)),{spawn,exec}=require('child_process'),path=require(a0_0x32d222(0x241)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x32d222(0x1d8),LTM_SCHEDULE=a0_0x32d222(0x1fc),MODE_RESET_SCHEDULE=a0_0x32d222(0x33c),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x32d222(0x225),LTM_DP_DAILY_DIGESTS=a0_0x32d222(0x35f),LTM_DP_STATUS=a0_0x32d222(0x365),LTM_DP_TRIGGER_DIGEST=a0_0x32d222(0x295),LTM_DP_BASELINE_STATUS=a0_0x32d222(0x344),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x32d222(0x2cc),LTM_DP_DRIFT_DETAILS=a0_0x32d222(0x37c),LTM_DP_DRIFT_LAST_CHECK=a0_0x32d222(0x235),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x32d222(0x2e6),'VACATION':'vacation','PARTY':a0_0x32d222(0x37e),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x32d222(0x1df)],SYSTEM_MODES[a0_0x32d222(0x305)]],PERSONA_MAPPING={'generic':a0_0x32d222(0x1f9),'senior_aal':a0_0x32d222(0x280),'family':a0_0x32d222(0x38f),'single_comfort':a0_0x32d222(0x219),'security':'PRIORITÃ„T:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},HARD_IGNORE_TERMS=[a0_0x32d222(0x324),'scriptEnabled',a0_0x32d222(0x1d3),'unreach','lowbat',a0_0x32d222(0x1e2),a0_0x32d222(0x2aa),a0_0x32d222(0x39c),a0_0x32d222(0x27c),'fault',a0_0x32d222(0x2e3),a0_0x32d222(0x382),'stick_unreach',a0_0x32d222(0x293),'dutycycle',a0_0x32d222(0x34b),a0_0x32d222(0x2f6),a0_0x32d222(0x35c)],BAD_NAMES=[a0_0x32d222(0x294),a0_0x32d222(0x2a2),'state','level',a0_0x32d222(0x21d),a0_0x32d222(0x36d),'on','off','switch',a0_0x32d222(0x35e),a0_0x32d222(0x2f5),a0_0x32d222(0x2c3),a0_0x32d222(0x2ac),a0_0x32d222(0x208),a0_0x32d222(0x26f),a0_0x32d222(0x384),a0_0x32d222(0x31b),'temperature','humidity',a0_0x32d222(0x2a3),a0_0x32d222(0x32f),a0_0x32d222(0x2d0),'valve',a0_0x32d222(0x286),a0_0x32d222(0x339)],ADAPTER_BLACKLIST=['system.',a0_0x32d222(0x262),a0_0x32d222(0x22d),'vis.',a0_0x32d222(0x1ef),'material.',a0_0x32d222(0x2b3),'flot.',a0_0x32d222(0x2a0),a0_0x32d222(0x277),a0_0x32d222(0x1d4)],IS_WIN=process[a0_0x32d222(0x37a)]===a0_0x32d222(0x20a),VENV_PATH=path[a0_0x32d222(0x332)](__dirname,a0_0x32d222(0x232)),PYTHON_EXE=IS_WIN?path[a0_0x32d222(0x332)](VENV_PATH,a0_0x32d222(0x248),a0_0x32d222(0x3a2)):path[a0_0x32d222(0x332)](VENV_PATH,a0_0x32d222(0x24a),a0_0x32d222(0x259)),PIP_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x32d222(0x248),a0_0x32d222(0x20b)):path[a0_0x32d222(0x332)](VENV_PATH,a0_0x32d222(0x24a),'pip');let activeSequence=[],sequenceTimer=null;async function initZombies(_0x523a4c){const _0x92ff9d=a0_0x32d222;try{const _0x14b54d=[_0x92ff9d(0x271),_0x92ff9d(0x367)];for(const _0x19bf4b of _0x14b54d){try{const _0x26fdfb=await _0x523a4c['getObjectAsync'](_0x19bf4b);if(_0x26fdfb)await _0x523a4c[_0x92ff9d(0x269)](_0x19bf4b);}catch(_0x23df6f){}}}catch(_0x17abb4){}}async function initHistory(_0x1ce5b6){const _0x19e6a3=a0_0x32d222;try{const _0x2a7679=await _0x1ce5b6[_0x19e6a3(0x285)](_0x19e6a3(0x2dc));_0x2a7679&&_0x2a7679[_0x19e6a3(0x34d)]&&(_0x1ce5b6['eventHistory']=JSON[_0x19e6a3(0x289)](_0x2a7679[_0x19e6a3(0x34d)][_0x19e6a3(0x2fb)]()));}catch(_0x5a089a){_0x1ce5b6[_0x19e6a3(0x380)]=[];}try{const _0x3b1dd8=await _0x1ce5b6[_0x19e6a3(0x285)]('analysis.analysisHistory');if(_0x3b1dd8&&_0x3b1dd8[_0x19e6a3(0x34d)])_0x1ce5b6['analysisHistory']=JSON['parse'](_0x3b1dd8[_0x19e6a3(0x34d)]['toString']());}catch(_0x297a4){_0x1ce5b6['analysisHistory']=[];}if(_0x1ce5b6['eventHistory']&&_0x1ce5b6[_0x19e6a3(0x380)][_0x19e6a3(0x226)]>0x0){_0x1ce5b6[_0x19e6a3(0x2b6)][_0x19e6a3(0x2c5)](_0x19e6a3(0x1d5)+_0x1ce5b6['eventHistory'][_0x19e6a3(0x226)]+_0x19e6a3(0x23f));for(let _0x390006=_0x1ce5b6[_0x19e6a3(0x380)][_0x19e6a3(0x226)]-0x1;_0x390006>=0x0;_0x390006--){const _0x35ede0=_0x1ce5b6[_0x19e6a3(0x380)][_0x390006];if(_0x35ede0&&_0x35ede0['id']!==undefined&&_0x35ede0[_0x19e6a3(0x21d)]!==undefined)_0x1ce5b6[_0x19e6a3(0x38a)][_0x35ede0['id']]=_0x35ede0[_0x19e6a3(0x21d)];}}}async function initSystemConfig(_0x9bc57e){const _0x9f304b=a0_0x32d222;try{const _0x43bed8=await _0x9bc57e[_0x9f304b(0x314)](_0x9f304b(0x357));if(_0x43bed8&&_0x43bed8[_0x9f304b(0x31c)])_0x9bc57e[_0x9f304b(0x389)]={'latitude':_0x43bed8[_0x9f304b(0x31c)][_0x9f304b(0x2ee)]||0x0,'longitude':_0x43bed8[_0x9f304b(0x31c)][_0x9f304b(0x297)]||0x0,'city':_0x43bed8[_0x9f304b(0x31c)]['city']||''};}catch(_0x2ed2ae){}}async function checkLicense(_0x12d2a2,_0x4f4749){return!![];}async function getSystemUUID(_0xe38872){const _0x1b501a=a0_0x32d222;return _0x1b501a(0x2b9);}async function loadRawEventLog(_0x5441f){const _0x296bbc=a0_0x32d222;try{const _0x1c222f=await _0x5441f[_0x296bbc(0x285)](LTM_DP_RAW_LOG);if(_0x1c222f&&_0x1c222f[_0x296bbc(0x34d)])_0x5441f[_0x296bbc(0x27f)]=JSON[_0x296bbc(0x289)](_0x1c222f['val']);}catch(_0x5e93fd){_0x5441f[_0x296bbc(0x27f)]=[];}}async function saveRawEventLog(_0x333056){const _0x1e143d=a0_0x32d222;if(_0x333056['rawEventLog'][_0x1e143d(0x226)]>RAW_LOG_MAX_SIZE)_0x333056[_0x1e143d(0x27f)]['splice'](0x0,_0x333056[_0x1e143d(0x27f)][_0x1e143d(0x226)]-RAW_LOG_MAX_SIZE);await _0x333056[_0x1e143d(0x2db)](LTM_DP_RAW_LOG,{'val':JSON[_0x1e143d(0x1f2)](_0x333056[_0x1e143d(0x27f)]),'ack':!![]});}async function loadDailyDigests(_0x1e90e0){const _0x2dfb71=a0_0x32d222;try{const _0x408968=await _0x1e90e0[_0x2dfb71(0x285)](LTM_DP_DAILY_DIGESTS);if(_0x408968&&_0x408968[_0x2dfb71(0x34d)])_0x1e90e0[_0x2dfb71(0x24d)]=JSON['parse'](_0x408968[_0x2dfb71(0x34d)]);}catch(_0x39779c){_0x1e90e0[_0x2dfb71(0x24d)]=[];}await updateBaselineStatus(_0x1e90e0);}async function saveDailyDigests(_0x315c88,_0x5510f3=!![]){const _0x10e286=a0_0x32d222,_0x16eef2=_0x315c88[_0x10e286(0x390)][_0x10e286(0x26e)]||0x3c;_0x315c88[_0x10e286(0x24d)][_0x10e286(0x226)]>_0x16eef2&&_0x315c88[_0x10e286(0x24d)][_0x10e286(0x3a4)](0x0,_0x315c88[_0x10e286(0x24d)][_0x10e286(0x226)]-_0x16eef2);await _0x315c88[_0x10e286(0x2db)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x315c88[_0x10e286(0x24d)]),'ack':!![]});if(_0x5510f3)await updateBaselineStatus(_0x315c88);}async function updateAnalysisHistory(_0x481362,_0x48d0b9){const _0x5b14c6=a0_0x32d222;_0x481362[_0x5b14c6(0x29a)][_0x5b14c6(0x229)](_0x48d0b9);if(_0x481362[_0x5b14c6(0x29a)]['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x481362[_0x5b14c6(0x29a)][_0x5b14c6(0x268)]();await _0x481362[_0x5b14c6(0x2db)](_0x5b14c6(0x211),{'val':JSON[_0x5b14c6(0x1f2)](_0x481362[_0x5b14c6(0x29a)]),'ack':!![]});}async function updateBaselineStatus(_0x4f1362){const _0x937200=a0_0x32d222;if(!_0x4f1362[_0x937200(0x28e)]){await _0x4f1362[_0x937200(0x2db)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x41011e=_0x4f1362[_0x937200(0x24d)][_0x937200(0x226)]>=(_0x4f1362[_0x937200(0x390)][_0x937200(0x307)]||0x7)?_0x937200(0x2e0)+_0x4f1362[_0x937200(0x24d)][_0x937200(0x226)]+'\x20Tage)':_0x937200(0x258)+_0x4f1362[_0x937200(0x24d)]['length']+'/'+(_0x4f1362[_0x937200(0x390)][_0x937200(0x307)]||0x7)+')';await _0x4f1362[_0x937200(0x2db)](LTM_DP_BASELINE_STATUS,{'val':_0x41011e,'ack':!![]});}async function loadSystemMode(_0x47042e){const _0x211f50=a0_0x32d222;try{const _0x591fe4=await _0x47042e['getStateAsync'](SYSTEM_DP_MODE);_0x591fe4&&_0x591fe4[_0x211f50(0x34d)]&&Object[_0x211f50(0x230)](SYSTEM_MODES)['includes'](_0x591fe4[_0x211f50(0x34d)])?_0x47042e['currentSystemMode']=_0x591fe4['val']:(_0x47042e[_0x211f50(0x218)]=SYSTEM_MODES[_0x211f50(0x2c8)],await _0x47042e[_0x211f50(0x2db)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x211f50(0x2c8)],'ack':!![]}));}catch(_0x503758){_0x47042e[_0x211f50(0x218)]=SYSTEM_MODES['NORMAL'];}}async function createAllObjects(_0xca2082){const _0x25d5af=a0_0x32d222;await _0xca2082[_0x25d5af(0x2a6)](_0x25d5af(0x267),{'type':_0x25d5af(0x23d),'common':{'name':_0x25d5af(0x32a)},'native':{}}),await _0xca2082[_0x25d5af(0x2a6)](SYSTEM_DP_MODE,{'type':_0x25d5af(0x255),'common':{'name':'System\x20Mode','type':_0x25d5af(0x363),'role':_0x25d5af(0x255),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x25d5af(0x2c8)]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x28f),{'type':_0x25d5af(0x255),'common':{'name':'Who\x20is\x20present?','type':_0x25d5af(0x363),'role':_0x25d5af(0x282),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x28b),{'type':'state','common':{'name':_0x25d5af(0x2e1),'type':'string','role':_0x25d5af(0x308),'read':!![],'write':![]},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x2dc),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x276),'type':_0x25d5af(0x363),'role':'json','read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2a6)]('analysis.training',{'type':_0x25d5af(0x23d),'common':{'name':_0x25d5af(0x1da)},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x2d9),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x1d2),'type':'boolean','role':'button','read':!![],'write':!![]},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x275),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x2d8),'type':'boolean','role':_0x25d5af(0x320),'read':!![],'write':!![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)]('analysis.training.triggerEnergy',{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x247),'type':_0x25d5af(0x1f1),'role':_0x25d5af(0x320),'read':!![],'write':!![]},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x23e),{'type':_0x25d5af(0x255),'common':{'name':'Training\x20Status','type':_0x25d5af(0x363),'role':'text','read':!![],'write':![]},'native':{}}),await _0xca2082['extendObjectAsync'](_0x25d5af(0x1e7),{'type':_0x25d5af(0x23d),'common':{'name':_0x25d5af(0x281)},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x37d),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x329),'type':_0x25d5af(0x38e),'role':'value','read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x1e6),{'type':_0x25d5af(0x255),'common':{'name':'Last\x20Check','type':_0x25d5af(0x363),'role':'date','read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2a6)](_0x25d5af(0x2fd),{'type':'channel','common':{'name':_0x25d5af(0x338)},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x34f),{'type':_0x25d5af(0x255),'common':{'name':'Last\x20Check','type':'string','role':_0x25d5af(0x385),'read':!![],'write':![]},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x304),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x2e2),'type':'boolean','role':_0x25d5af(0x311),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x369),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x1f8),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)]('analysis.health.trendValue',{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x2c1),'type':'number','role':'value','read':!![],'write':![]},'native':{}}),await _0xca2082['extendObjectAsync'](_0x25d5af(0x217),{'type':_0x25d5af(0x23d),'common':{'name':'Energy\x20Intelligence'},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x310),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x359),'type':_0x25d5af(0x363),'role':'text','read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x298),{'type':'state','common':{'name':_0x25d5af(0x274),'type':_0x25d5af(0x363),'role':_0x25d5af(0x282),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2a6)](_0x25d5af(0x315),{'type':_0x25d5af(0x23d),'common':{'name':_0x25d5af(0x315)},'native':{}}),await _0xca2082['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x25d5af(0x255),'common':{'name':'Raw\x20Log','type':'string','role':_0x25d5af(0x308),'read':!![],'write':![]},'native':{}}),await _0xca2082['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x25d5af(0x1d1),'type':_0x25d5af(0x363),'role':_0x25d5af(0x308),'read':!![],'write':![]},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x1e9),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x30a),'type':'string','role':_0x25d5af(0x308),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x2b1),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x1db),'type':_0x25d5af(0x363),'role':_0x25d5af(0x308),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x2be),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x341),'type':'boolean','role':_0x25d5af(0x320),'read':!![],'write':!![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x2cb),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x22e),'type':_0x25d5af(0x1f1),'role':_0x25d5af(0x320),'read':!![],'write':!![]},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x331),{'type':'state','common':{'name':_0x25d5af(0x330),'type':'boolean','role':_0x25d5af(0x233),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x243),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x26c),'type':'string','role':_0x25d5af(0x33e),'read':!![],'write':![]},'native':{}}),await _0xca2082['setObjectNotExistsAsync'](_0x25d5af(0x350),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x237),'type':_0x25d5af(0x363),'role':_0x25d5af(0x282),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x337),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x2ad),'type':'boolean','role':_0x25d5af(0x311),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x361),{'type':'state','common':{'name':'Description','type':_0x25d5af(0x363),'role':_0x25d5af(0x282),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x250),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x378),'type':_0x25d5af(0x363),'role':_0x25d5af(0x282),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x2c7),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x364),'type':'string','role':_0x25d5af(0x282),'read':!![],'write':![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x375),{'type':_0x25d5af(0x255),'common':{'name':_0x25d5af(0x214),'type':'boolean','role':_0x25d5af(0x376),'read':!![],'write':!![]},'native':{}}),await _0xca2082[_0x25d5af(0x2c4)](_0x25d5af(0x379),{'type':_0x25d5af(0x255),'common':{'name':'Trigger\x20Action','type':'boolean','role':'button','read':!![],'write':!![]},'native':{}});}async function recordThermodynamics(_0x2c62ec,_0x14a9b1,_0x2a5bb6,_0x1d726e){const _0x28cd8d=a0_0x32d222,_0x2b4cb3=await getOutsideTemperatureNumeric(_0x2c62ec),_0x52e8bd=await _0x2c62ec[_0x28cd8d(0x285)](_0x28cd8d(0x2b1));let _0x3fdc98=[];if(_0x52e8bd&&_0x52e8bd[_0x28cd8d(0x34d)])try{_0x3fdc98=JSON['parse'](_0x52e8bd[_0x28cd8d(0x34d)]);}catch(_0x3d8236){}_0x3fdc98['push']({'ts':Date[_0x28cd8d(0x240)](),'room':_0x1d726e||'Unknown','t_in':_0x2a5bb6,'t_out':_0x2b4cb3});if(_0x3fdc98['length']>THERMO_LOG_SIZE)_0x3fdc98[_0x28cd8d(0x1dc)]();await _0x2c62ec[_0x28cd8d(0x2db)]('LTM.trainingData.thermodynamics',{'val':JSON[_0x28cd8d(0x1f2)](_0x3fdc98),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x543a1e){const _0x3cefdd=a0_0x32d222;if(_0x543a1e['config'][_0x3cefdd(0x38b)])try{const _0x57bee9=await _0x543a1e[_0x3cefdd(0x288)](_0x543a1e['config'][_0x3cefdd(0x38b)]);if(_0x57bee9&&_0x57bee9[_0x3cefdd(0x34d)]!==undefined&&_0x57bee9[_0x3cefdd(0x34d)]!==null)return parseFloat(_0x57bee9['val']);}catch(_0x15cf69){}const _0x8d3ae9=_0x543a1e[_0x3cefdd(0x390)][_0x3cefdd(0x3a3)];if(!_0x543a1e['config'][_0x3cefdd(0x2bf)]||!_0x8d3ae9)return null;try{let _0x4714e8='';if(_0x8d3ae9[_0x3cefdd(0x317)](_0x3cefdd(0x319)))_0x4714e8=_0x8d3ae9+_0x3cefdd(0x30b);else{if(_0x8d3ae9[_0x3cefdd(0x317)](_0x3cefdd(0x2af)))_0x4714e8=_0x8d3ae9+_0x3cefdd(0x264);else{if(_0x8d3ae9[_0x3cefdd(0x317)](_0x3cefdd(0x1e3)))_0x4714e8=_0x8d3ae9+_0x3cefdd(0x2d6);else{if(_0x8d3ae9[_0x3cefdd(0x317)](_0x3cefdd(0x34c)))_0x4714e8=_0x8d3ae9+'.forecast.current.temp';}}}if(_0x4714e8){const _0xf06171=await _0x543a1e[_0x3cefdd(0x288)](_0x4714e8);if(_0xf06171&&_0xf06171[_0x3cefdd(0x34d)]!==undefined&&_0xf06171['val']!==null)return parseFloat(_0xf06171[_0x3cefdd(0x34d)]);}}catch(_0x4df41c){}return null;}async function recordSequence(_0x58b4eb,_0x1eda9f){const _0x1a553e=a0_0x32d222,_0x2d5b07=(_0x1eda9f[_0x1a553e(0x313)]||'')[_0x1a553e(0x351)](),_0x37bef5=[_0x1a553e(0x26f),_0x1a553e(0x2c0),_0x1a553e(0x35b),_0x1a553e(0x384),_0x1a553e(0x31b),_0x1a553e(0x2d1),_0x1a553e(0x207),_0x1a553e(0x22f),_0x1a553e(0x2fc),_0x1a553e(0x245),_0x1a553e(0x346),_0x1a553e(0x25b),_0x1a553e(0x24f),_0x1a553e(0x376),'schalter','dimmer',_0x1a553e(0x32d)];if(!_0x37bef5[_0x1a553e(0x322)](_0x40f25e=>_0x2d5b07['includes'](_0x40f25e)))return;if(!_0x1eda9f[_0x1a553e(0x21d)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x1a553e(0x2bd)]({'loc':_0x1eda9f[_0x1a553e(0x2e4)]||'Unknown','id':_0x1eda9f['id'],'ts':Date['now']()}),_0x58b4eb[_0x1a553e(0x2b6)][_0x1a553e(0x20e)](_0x1a553e(0x1e4)+_0x1eda9f[_0x1a553e(0x2e4)]+'\x20(Length:\x20'+activeSequence[_0x1a553e(0x226)]+')'),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x58b4eb);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x28cfce){const _0x43f23c=a0_0x32d222;try{const _0x38befb=await _0x28cfce[_0x43f23c(0x285)](_0x43f23c(0x1e9));let _0x3a9d4f=[];if(_0x38befb&&_0x38befb[_0x43f23c(0x34d)])try{_0x3a9d4f=JSON['parse'](_0x38befb[_0x43f23c(0x34d)]);}catch(_0x74474a){}const _0x3849de=activeSequence[0x0]['ts'],_0x8e8c1b=activeSequence['map'](_0x4206eb=>({'loc':_0x4206eb['loc'],'t_delta':Math[_0x43f23c(0x358)]((_0x4206eb['ts']-_0x3849de)/0x3e8)})),_0xf3b2e1={'timestamp':new Date(_0x3849de)[_0x43f23c(0x29c)](),'steps':_0x8e8c1b,'duration':Math[_0x43f23c(0x358)]((activeSequence[activeSequence[_0x43f23c(0x226)]-0x1]['ts']-_0x3849de)/0x3e8),'daytime':new Date(_0x3849de)[_0x43f23c(0x216)]()};_0x3a9d4f[_0x43f23c(0x2bd)](_0xf3b2e1);if(_0x3a9d4f['length']>MAX_TRAINING_SET_SIZE)_0x3a9d4f[_0x43f23c(0x1dc)]();await _0x28cfce[_0x43f23c(0x2db)](_0x43f23c(0x1e9),{'val':JSON[_0x43f23c(0x1f2)](_0x3a9d4f),'ack':!![]}),runSecurityCheck(_0x28cfce,_0xf3b2e1);}catch(_0x2f50f8){_0x28cfce[_0x43f23c(0x2b6)][_0x43f23c(0x27c)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x2f50f8[_0x43f23c(0x383)]);}}function runSecurityCheck(_0x45c8b5,_0x56b005){const _0x1ea583=a0_0x32d222;if(!_0x45c8b5[_0x1ea583(0x28e)])return;_0x45c8b5[_0x1ea583(0x2b6)][_0x1ea583(0x20e)]('ðŸ›¡ï¸\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...'),sendToPython(_0x45c8b5,_0x1ea583(0x210),{'sequence':_0x56b005});}async function processSensorEvent(_0x33cf95,_0x146ddc,_0x12871a,_0x3a513a){const _0x314dc0=a0_0x32d222;if(!_0x3a513a)return;const _0x14c004=_0x12871a[_0x314dc0(0x34d)],_0x58bc05=Date[_0x314dc0(0x240)](),_0x108cc0=_0x33cf95['sensorLastValues'][_0x146ddc];_0x33cf95['sensorLastValues'][_0x146ddc]=_0x14c004;if(!_0x3a513a[_0x314dc0(0x27d)]&&_0x108cc0!=undefined&&_0x108cc0==_0x14c004)return;const _0x44a554=(_0x3a513a[_0x314dc0(0x313)]||'')[_0x314dc0(0x351)](),_0x565327=_0x44a554[_0x314dc0(0x317)](_0x314dc0(0x215))||_0x44a554[_0x314dc0(0x317)](_0x314dc0(0x21e))||_0x44a554['includes']('klima')||_0x44a554[_0x314dc0(0x317)]('heizung');_0x33cf95[_0x314dc0(0x28e)]&&_0x565327&&recordThermodynamics(_0x33cf95,_0x146ddc,_0x14c004,_0x3a513a[_0x314dc0(0x2e4)]);const _0x2122e5={'timestamp':_0x58bc05,'id':_0x146ddc,'name':_0x3a513a[_0x314dc0(0x228)],'type':_0x3a513a['type'],'location':_0x3a513a[_0x314dc0(0x2e4)],'value':_0x14c004};_0x33cf95[_0x314dc0(0x380)]['unshift'](_0x2122e5);if(_0x33cf95[_0x314dc0(0x380)][_0x314dc0(0x226)]>HISTORY_MAX_SIZE)_0x33cf95[_0x314dc0(0x380)][_0x314dc0(0x268)]();await _0x33cf95['setStateAsync'](_0x314dc0(0x28b),{'val':JSON[_0x314dc0(0x1f2)](_0x2122e5),'ack':!![]}),await _0x33cf95[_0x314dc0(0x2db)](_0x314dc0(0x2dc),{'val':JSON['stringify'](_0x33cf95[_0x314dc0(0x380)]),'ack':!![]});_0x33cf95['isProVersion']&&(_0x33cf95[_0x314dc0(0x27f)][_0x314dc0(0x2bd)](_0x2122e5),await saveRawEventLog(_0x33cf95),recordSequence(_0x33cf95,_0x2122e5));if(_0x3a513a[_0x314dc0(0x368)]&&_0x14c004===!![]){if(_0x33cf95[_0x314dc0(0x36b)]&&!_0x33cf95[_0x314dc0(0x353)])startExitTimer(_0x33cf95);else{if(!_0x33cf95[_0x314dc0(0x36b)])setPresence(_0x33cf95,!![]);}}else{if(_0x3a513a[_0x314dc0(0x313)]===_0x314dc0(0x26f)&&_0x14c004===!![]){if(_0x33cf95[_0x314dc0(0x33d)])abortExitTimer(_0x33cf95);if(!_0x33cf95[_0x314dc0(0x36b)]&&_0x33cf95[_0x314dc0(0x218)]===SYSTEM_MODES[_0x314dc0(0x2c8)])setPresence(_0x33cf95,!![]);}}}function installPythonDependencies(_0x304872){const _0x28414b=a0_0x32d222;if(_0x304872[_0x28414b(0x36a)])return;_0x304872[_0x28414b(0x36a)]=!![];const _0x59db91=path[_0x28414b(0x332)](__dirname,_0x28414b(0x2fa),_0x28414b(0x334));_0x304872[_0x28414b(0x2b6)][_0x28414b(0x2c5)](_0x28414b(0x35a)),stopPythonService(_0x304872);if(fs[_0x28414b(0x2f8)](VENV_PATH)){if(!fs['existsSync'](PIP_EXE)){_0x304872[_0x28414b(0x2b6)][_0x28414b(0x377)](_0x28414b(0x25d));try{fs[_0x28414b(0x2a8)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x11ca78){}}}!fs[_0x28414b(0x2f8)](VENV_PATH)?exec(_0x28414b(0x2df)+VENV_PATH+'\x22',_0x2757ab=>{const _0x5efa9e=_0x28414b;if(_0x2757ab){_0x304872[_0x5efa9e(0x2b6)]['error'](_0x5efa9e(0x1f3)),_0x304872[_0x5efa9e(0x36a)]=![];return;}installRequirementsInVenv(_0x304872,_0x59db91);}):installRequirementsInVenv(_0x304872,_0x59db91);}function installRequirementsInVenv(_0x2986f3,_0x24bb86){const _0x6820eb=a0_0x32d222;_0x2986f3[_0x6820eb(0x2b6)][_0x6820eb(0x2c5)]('Installing\x20dependencies\x20into\x20venv...');const _0x82653='\x22'+PIP_EXE+_0x6820eb(0x291)+_0x24bb86+'\x22';exec(_0x82653,{'timeout':0x124f80,'maxBuffer':0x400*0x400*0x32},_0x481883=>{const _0x4d5edd=_0x6820eb;_0x2986f3['dependencyInstallInProgress']=![],_0x481883?_0x2986f3[_0x4d5edd(0x2b6)][_0x4d5edd(0x27c)]('âŒ\x20PIP\x20INSTALL\x20FAILED:\x20'+_0x481883[_0x4d5edd(0x383)]):(_0x2986f3[_0x4d5edd(0x2b6)]['info'](_0x4d5edd(0x38d)),startPythonService(_0x2986f3));});}function startPythonService(_0x5266bd){const _0x56e302=a0_0x32d222;if(_0x5266bd[_0x56e302(0x36a)])return;let _0x4b9a0a='python3';if(fs[_0x56e302(0x2f8)](PYTHON_EXE))_0x5266bd[_0x56e302(0x2b6)]['info'](_0x56e302(0x1f4)+PYTHON_EXE),_0x4b9a0a=PYTHON_EXE;else{_0x5266bd[_0x56e302(0x2b6)][_0x56e302(0x377)](_0x56e302(0x2e5)),installPythonDependencies(_0x5266bd);return;}try{const _0x4d4d61=path[_0x56e302(0x332)](__dirname,_0x56e302(0x2fa),'service.py');_0x5266bd[_0x56e302(0x20c)]=spawn(_0x4b9a0a,[_0x4d4d61]),_0x5266bd[_0x56e302(0x20c)]['stdout']['on'](_0x56e302(0x303),_0x1c6e50=>{const _0x1b2df9=_0x56e302,_0x3e9989=_0x1c6e50[_0x1b2df9(0x2fb)]()[_0x1b2df9(0x296)]('\x0a');_0x3e9989[_0x1b2df9(0x373)](_0x2c643a=>{const _0x10b06c=_0x1b2df9,_0x51a929=_0x2c643a['trim']();if(!_0x51a929)return;if(_0x51a929[_0x10b06c(0x391)](_0x10b06c(0x234)))_0x5266bd[_0x10b06c(0x2b6)][_0x10b06c(0x20e)]('[PYTHON]\x20'+_0x51a929[_0x10b06c(0x2f7)](0x5)[_0x10b06c(0x30f)]());else{if(_0x51a929['startsWith']('[RESULT]'))try{const _0x3195bf=JSON[_0x10b06c(0x289)](_0x51a929[_0x10b06c(0x2f7)](0x8)[_0x10b06c(0x30f)]());handlePythonResult(_0x5266bd,_0x3195bf);}catch(_0xc9891){_0x5266bd[_0x10b06c(0x2b6)]['warn'](_0x10b06c(0x370)+_0x51a929);}}(_0x51a929[_0x10b06c(0x317)](_0x10b06c(0x327))||_0x51a929[_0x10b06c(0x317)](_0x10b06c(0x34a)))&&(_0x5266bd[_0x10b06c(0x2b6)][_0x10b06c(0x377)](_0x10b06c(0x254)),installPythonDependencies(_0x5266bd));});}),_0x5266bd['pythonProcess'][_0x56e302(0x2b4)]['on'](_0x56e302(0x303),_0x35956c=>{const _0x36a156=_0x56e302,_0x296f34=_0x35956c[_0x36a156(0x2fb)]()[_0x36a156(0x30f)]();if(!_0x296f34['includes'](_0x36a156(0x2bb)))_0x5266bd[_0x36a156(0x2b6)][_0x36a156(0x27c)](_0x36a156(0x387)+_0x296f34);}),_0x5266bd['pythonProcess']['on'](_0x56e302(0x36c),_0x4abfe2=>{const _0xc0530f=_0x56e302;_0x5266bd['log']['info']('[PYTHON]\x20Exited\x20code\x20'+_0x4abfe2),_0x5266bd[_0xc0530f(0x20c)]=null;});}catch(_0x10ce28){_0x5266bd[_0x56e302(0x2b6)]['error']('Error\x20launching\x20Python:\x20'+_0x10ce28[_0x56e302(0x383)]);}}function stopPythonService(_0x5e1e64){const _0x2769e1=a0_0x32d222;if(_0x5e1e64[_0x2769e1(0x20c)]){_0x5e1e64['log']['info'](_0x2769e1(0x260));try{_0x5e1e64[_0x2769e1(0x20c)][_0x2769e1(0x21b)]();}catch(_0x58e5bc){}_0x5e1e64[_0x2769e1(0x20c)]=null;}}function handlePythonResult(_0x3cb413,_0x156a75){const _0x57f74b=a0_0x32d222;if(_0x156a75[_0x57f74b(0x313)]===_0x57f74b(0x209))_0x3cb413[_0x57f74b(0x2b6)][_0x57f74b(0x20e)](_0x57f74b(0x2ec));else{if(_0x156a75['type']===_0x57f74b(0x261)){const {anomaly_score:_0x5e9354,is_anomaly:_0x595412,threshold:_0x1a7ec7}=_0x156a75['payload'];_0x3cb413[_0x57f74b(0x2b6)][_0x57f74b(0x2c5)](_0x57f74b(0x23a)+_0x5e9354['toFixed'](0x5)+_0x57f74b(0x316)+(_0x595412?_0x57f74b(0x30c):'OK')),_0x3cb413['setStateAsync'](_0x57f74b(0x37d),{'val':_0x5e9354,'ack':!![]}),_0x3cb413['setStateAsync'](_0x57f74b(0x1e6),{'val':new Date()[_0x57f74b(0x29c)](),'ack':!![]});if(_0x595412){const _0x1c81c7=_0x57f74b(0x283)+_0x5e9354[_0x57f74b(0x201)](0x4)+')';_0x3cb413[_0x57f74b(0x2db)](_0x57f74b(0x331),{'val':!![],'ack':!![]}),_0x3cb413[_0x57f74b(0x2db)](_0x57f74b(0x243),{'val':_0x1c81c7,'ack':!![]}),sendNotification(_0x3cb413,_0x57f74b(0x1f7)+_0x1c81c7,![],!![]);}}else{if(_0x156a75[_0x57f74b(0x313)]==='TRAINING_COMPLETE'){const {success:_0x56e025,details:_0x63d98b}=_0x156a75[_0x57f74b(0x23c)];_0x3cb413[_0x57f74b(0x2db)](_0x57f74b(0x23e),{'val':_0x56e025?_0x57f74b(0x335)+new Date()[_0x57f74b(0x2e7)]()+'\x20('+_0x63d98b+')':'Failed:\x20'+_0x63d98b,'ack':!![]});}else{if(_0x156a75['type']===_0x57f74b(0x2a5)){const {success:_0x1b0bde,details:_0x3fe2c1}=_0x156a75[_0x57f74b(0x23c)];if(_0x1b0bde)try{const _0x4f9360=JSON[_0x57f74b(0x289)](_0x3fe2c1);if(_0x4f9360[_0x57f74b(0x253)])_0x3cb413[_0x57f74b(0x2db)](_0x57f74b(0x310),{'val':JSON[_0x57f74b(0x1f2)](_0x4f9360['insulation']),'ack':!![]});if(_0x4f9360['heating'])_0x3cb413[_0x57f74b(0x2db)](_0x57f74b(0x298),{'val':JSON[_0x57f74b(0x1f2)](_0x4f9360[_0x57f74b(0x239)]),'ack':!![]});}catch(_0x1cdb39){}}else{if(_0x156a75[_0x57f74b(0x313)]==='HEALTH_TRAIN_RESULT'){const {success:_0x404a14,details:_0x557860}=_0x156a75[_0x57f74b(0x23c)];if(_0x404a14)_0x3cb413['log']['info'](_0x57f74b(0x290)+_0x557860);}else{if(_0x156a75[_0x57f74b(0x313)]===_0x57f74b(0x399)){const {is_anomaly:_0x18268f,details:_0x3310f8}=_0x156a75[_0x57f74b(0x23c)];_0x3cb413[_0x57f74b(0x2db)](_0x57f74b(0x34f),{'val':new Date()[_0x57f74b(0x29c)](),'ack':!![]}),_0x3cb413[_0x57f74b(0x2db)](_0x57f74b(0x304),{'val':_0x18268f,'ack':!![]});}else{if(_0x156a75[_0x57f74b(0x313)]===_0x57f74b(0x323)){const {diagnosis:_0x310399,change_percent:_0x107dad}=_0x156a75['payload'];_0x3cb413[_0x57f74b(0x2b6)][_0x57f74b(0x2c5)](_0x57f74b(0x1ed)+_0x310399+'\x20('+_0x107dad+'%)'),_0x3cb413['setStateAsync']('analysis.health.trendDiagnosis',{'val':_0x310399,'ack':!![]}),_0x3cb413[_0x57f74b(0x2db)]('analysis.health.trendValue',{'val':_0x107dad,'ack':!![]});}}}}}}}}function sendToPython(_0x52f106,_0x242d3e,_0x274997={}){const _0x1ef8b5=a0_0x32d222;if(!_0x52f106['pythonProcess']||!_0x52f106['pythonProcess']['stdin'][_0x1ef8b5(0x300)])return;const _0x4aca88=JSON['stringify']({'command':_0x242d3e,..._0x274997});try{_0x52f106[_0x1ef8b5(0x20c)]['stdin'][_0x1ef8b5(0x349)](_0x4aca88+'\x0a');}catch(_0x3c317d){}}function setupLtmScheduler(_0x56eee1){const _0x47f714=a0_0x32d222;try{if(_0x56eee1[_0x47f714(0x31e)])_0x56eee1[_0x47f714(0x31e)][_0x47f714(0x356)]();if(!_0x56eee1['isProVersion'])return;_0x56eee1[_0x47f714(0x31e)]=schedule[_0x47f714(0x2ca)](LTM_SCHEDULE,()=>createDailyDigest(_0x56eee1));}catch(_0x1fb18b){_0x56eee1[_0x47f714(0x2b6)][_0x47f714(0x27c)](_0x47f714(0x366)+_0x1fb18b['message']);}}function setupModeResetScheduler(_0x8337b7){const _0xffbd04=a0_0x32d222;try{if(_0x8337b7['modeResetJob'])_0x8337b7[_0xffbd04(0x392)][_0xffbd04(0x356)]();_0x8337b7[_0xffbd04(0x392)]=schedule[_0xffbd04(0x2ca)](MODE_RESET_SCHEDULE,async()=>{const _0x5eb6ed=_0xffbd04;await loadSystemMode(_0x8337b7),AUTO_RESET_MODES[_0x5eb6ed(0x317)](_0x8337b7['currentSystemMode'])&&await _0x8337b7[_0x5eb6ed(0x2db)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x5eb6ed(0x2c8)],'ack':![]});});}catch(_0x1ff00b){_0x8337b7['log'][_0xffbd04(0x27c)]('Reset\x20Sched\x20Error:\x20'+_0x1ff00b[_0xffbd04(0x383)]);}}function setupDriftAnalysisScheduler(_0x41d090){const _0x563f99=a0_0x32d222;try{if(_0x41d090['driftAnalysisTimer'])clearInterval(_0x41d090['driftAnalysisTimer']);if(!_0x41d090[_0x563f99(0x28e)])return;_0x41d090['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x41d090),(_0x41d090[_0x563f99(0x390)][_0x563f99(0x2f3)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x41d090),0x1388);}catch(_0x4b66a7){_0x41d090[_0x563f99(0x2b6)][_0x563f99(0x27c)]('Drift\x20Sched\x20Error:\x20'+_0x4b66a7[_0x563f99(0x383)]);}}function setupBriefingScheduler(_0x1d3103){const _0x246bea=a0_0x32d222;try{if(_0x1d3103[_0x246bea(0x1f5)])_0x1d3103['briefingJob'][_0x246bea(0x356)]();if(!_0x1d3103[_0x246bea(0x390)][_0x246bea(0x39e)])return;const _0xf5178c=(_0x1d3103[_0x246bea(0x390)]['briefingTime']||_0x246bea(0x37f))[_0x246bea(0x296)](':'),_0x293ba9=parseInt(_0xf5178c[0x0])||0x8,_0x35e761=parseInt(_0xf5178c[0x1])||0x0,_0x5cb4c9=_0x35e761+'\x20'+_0x293ba9+_0x246bea(0x200);_0x1d3103[_0x246bea(0x1f5)]=schedule['scheduleJob'](_0x5cb4c9,()=>{sendMorningBriefing(_0x1d3103);});}catch(_0x2428e8){_0x1d3103['log'][_0x246bea(0x27c)](_0x246bea(0x22c)+_0x2428e8['message']);}}async function runGeminiAnalysis(_0x578f7c,_0xa63d56=''){const _0x2ee837=a0_0x32d222;if(!_0x578f7c['geminiModel'])return;if(_0x578f7c[_0x2ee837(0x380)]['length']===0x0)return;const _0x3ed4c8=_0x578f7c['eventHistory']['slice'](0x0,0xf),_0x830fd0=await getWeatherContext(_0x578f7c),_0x59e471=_0x578f7c[_0x2ee837(0x218)],_0x339e9c=PERSONA_MAPPING[_0x578f7c[_0x2ee837(0x390)][_0x2ee837(0x38c)]||_0x2ee837(0x1dd)],_0x420588=_0x578f7c[_0x2ee837(0x390)][_0x2ee837(0x2ab)]||'Keine\x20Details.';let _0x501b03='Unbekannt';try{const _0x2af884=await _0x578f7c[_0x2ee837(0x285)]('system.presenceWho');if(_0x2af884&&_0x2af884[_0x2ee837(0x34d)])_0x501b03=_0x2af884[_0x2ee837(0x34d)];}catch(_0x1a3c26){}let _0x5efa79=![];try{const _0x21b176=await _0x578f7c['getStateAsync'](_0x2ee837(0x375));if(_0x21b176&&_0x21b176[_0x2ee837(0x34d)])_0x5efa79=!![];}catch(_0x53b228){}const _0x1dca44=_0x2ee837(0x326)+_0x339e9c+_0x2ee837(0x265)+_0x420588+_0x2ee837(0x27e)+_0x59e471+_0x2ee837(0x205)+_0x830fd0+_0x2ee837(0x39a)+_0x501b03+_0x2ee837(0x21f)+JSON[_0x2ee837(0x1f2)](_0x3ed4c8)+_0x2ee837(0x223)+_0xa63d56+_0x2ee837(0x20f);try{const _0x51897e=await _0x578f7c[_0x2ee837(0x352)][_0x2ee837(0x309)](_0x1dca44),_0x39b118=_0x51897e[_0x2ee837(0x321)][_0x2ee837(0x282)]()['replace'](/```json|```/g,'')['trim'](),_0x27ae12=JSON[_0x2ee837(0x289)](_0x39b118);await _0x578f7c[_0x2ee837(0x2db)]('analysis.lastResult',{'val':JSON[_0x2ee837(0x1f2)](_0x27ae12),'ack':!![]});if(_0x27ae12[_0x2ee837(0x374)])await _0x578f7c['setStateAsync'](_0x2ee837(0x350),{'val':_0x27ae12[_0x2ee837(0x374)],'ack':!![]});const _0x59940e={'timestamp':Date[_0x2ee837(0x240)](),'id':Date[_0x2ee837(0x240)]()[_0x2ee837(0x2fb)](),'analysis':{'activity':{'summary':_0x27ae12[_0x2ee837(0x374)],'isAlert':_0x27ae12[_0x2ee837(0x2f4)],'alertReason':_0x27ae12['alertReason']},'comfort':{'automationProposal':_0x27ae12[_0x2ee837(0x2fe)]}}};await updateAnalysisHistory(_0x578f7c,_0x59940e);const _0x477e30=_0x27ae12['isAlert']||![];_0x477e30!==_0x578f7c[_0x2ee837(0x25f)]&&(await _0x578f7c[_0x2ee837(0x2db)](_0x2ee837(0x331),{'val':_0x477e30,'ack':!![]}),_0x578f7c[_0x2ee837(0x25f)]=_0x477e30,_0x477e30&&(await _0x578f7c['setStateAsync'](_0x2ee837(0x243),{'val':_0x27ae12[_0x2ee837(0x1d7)],'ack':!![]}),sendNotification(_0x578f7c,_0x2ee837(0x2cd)+_0x27ae12[_0x2ee837(0x1d7)],![],_0x27ae12['isEmergency'])));if(_0x27ae12[_0x2ee837(0x2fe)]&&_0x27ae12[_0x2ee837(0x2fe)]['detected']){await _0x578f7c[_0x2ee837(0x2db)](_0x2ee837(0x337),{'val':!![],'ack':!![]}),await _0x578f7c[_0x2ee837(0x2db)](_0x2ee837(0x361),{'val':_0x27ae12[_0x2ee837(0x2fe)][_0x2ee837(0x32c)],'ack':!![]}),await _0x578f7c[_0x2ee837(0x2db)](_0x2ee837(0x250),{'val':_0x27ae12[_0x2ee837(0x2fe)][_0x2ee837(0x394)],'ack':!![]}),await _0x578f7c[_0x2ee837(0x2db)]('analysis.automation.targetValue',{'val':JSON[_0x2ee837(0x1f2)](_0x27ae12[_0x2ee837(0x2fe)][_0x2ee837(0x2e8)]),'ack':!![]});if(_0x5efa79)executeAutomationAction(_0x578f7c);}}catch(_0x510ea1){_0x578f7c[_0x2ee837(0x2b6)][_0x2ee837(0x27c)]('Gemini\x20Error:\x20'+_0x510ea1[_0x2ee837(0x383)]);}}async function createDailyDigest(_0xf965be){const _0x4cce4c=a0_0x32d222;if(!_0xf965be[_0x4cce4c(0x28e)])return;await _0xf965be[_0x4cce4c(0x2db)](LTM_DP_STATUS,{'val':_0x4cce4c(0x2ed),'ack':!![]});if(!_0xf965be[_0x4cce4c(0x352)]||_0xf965be[_0x4cce4c(0x27f)][_0x4cce4c(0x226)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0xf965be[_0x4cce4c(0x2db)](LTM_DP_STATUS,{'val':_0x4cce4c(0x204),'ack':!![]});return;}const _0x2371de=JSON[_0x4cce4c(0x289)](JSON[_0x4cce4c(0x1f2)](_0xf965be[_0x4cce4c(0x27f)])),_0x53e94a=_0x2371de[_0x4cce4c(0x226)],_0x82e0fe=_0x4cce4c(0x2b5)+JSON[_0x4cce4c(0x1f2)](_0x2371de);try{const _0x4637c5=await _0xf965be['geminiModel']['generateContent'](_0x82e0fe),_0x489ffe=JSON[_0x4cce4c(0x289)](_0x4637c5['response']['text']()['replace'](/```json|```/g,'')[_0x4cce4c(0x30f)]()),_0x170dfa={'timestamp':new Date()['toISOString'](),'eventCount':_0x53e94a,'summary':_0x489ffe['summary']||'Digest','activityLevel':_0x489ffe[_0x4cce4c(0x395)]||'normal','systemMode':_0xf965be['currentSystemMode']};_0xf965be['dailyDigests']['push'](_0x170dfa),await saveDailyDigests(_0xf965be),_0xf965be[_0x4cce4c(0x27f)]=[],await saveRawEventLog(_0xf965be),await _0xf965be[_0x4cce4c(0x2db)](LTM_DP_STATUS,{'val':_0x4cce4c(0x354),'ack':!![]});if(_0xf965be[_0x4cce4c(0x28e)])sendToPython(_0xf965be,'ANALYZE_HEALTH',{'digest':_0x170dfa});}catch(_0x3f4589){_0xf965be[_0x4cce4c(0x2b6)]['error'](_0x3f4589[_0x4cce4c(0x383)]);}}async function runBaselineDriftAnalysis(_0x475855){const _0x2ecb82=a0_0x32d222;if(!_0x475855[_0x2ecb82(0x28e)]||!_0x475855[_0x2ecb82(0x352)])return;const _0x3d10ec=_0x475855['config'][_0x2ecb82(0x1d6)]||0xe;if(_0x475855[_0x2ecb82(0x24d)][_0x2ecb82(0x226)]<_0x3d10ec+0x7){await _0x475855[_0x2ecb82(0x2db)](LTM_DP_DRIFT_STATUS,{'val':_0x2ecb82(0x302),'ack':!![]});return;}const _0x53a36f=_0x475855[_0x2ecb82(0x24d)][_0x2ecb82(0x224)](-_0x3d10ec),_0x4e38a4=_0x475855[_0x2ecb82(0x24d)][_0x2ecb82(0x224)](0x0,_0x475855['dailyDigests'][_0x2ecb82(0x226)]-_0x3d10ec),_0x1e7d9a=_0x2ecb82(0x393)+JSON[_0x2ecb82(0x1f2)](_0x4e38a4)+'\x0aSTB:\x20'+JSON[_0x2ecb82(0x1f2)](_0x53a36f);try{const _0x1fe1e3=await _0x475855[_0x2ecb82(0x352)][_0x2ecb82(0x309)](_0x1e7d9a),_0x58cc06=JSON[_0x2ecb82(0x289)](_0x1fe1e3[_0x2ecb82(0x321)]['text']()[_0x2ecb82(0x32b)](/```json|```/g,'')[_0x2ecb82(0x30f)]());_0x58cc06['baselineDrift']&&(await _0x475855[_0x2ecb82(0x2db)](LTM_DP_DRIFT_STATUS,{'val':_0x58cc06[_0x2ecb82(0x21c)],'ack':!![]}),await _0x475855[_0x2ecb82(0x2db)](LTM_DP_DRIFT_DETAILS,{'val':_0x58cc06[_0x2ecb82(0x2ea)],'ack':!![]}),await _0x475855[_0x2ecb82(0x2db)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x2ecb82(0x240)](),'ack':!![]}));}catch(_0xc1abd4){}}async function sendMorningBriefing(_0x11b690){const _0x15bedd=a0_0x32d222;if(!_0x11b690[_0x15bedd(0x352)])return;_0x11b690[_0x15bedd(0x2b6)][_0x15bedd(0x2c5)]('Generating\x20Morning\x20Briefing...');const _0x2e6293=_0x11b690['dailyDigests'][_0x15bedd(0x226)]>0x0?_0x11b690[_0x15bedd(0x24d)][_0x11b690['dailyDigests'][_0x15bedd(0x226)]-0x1]:null,_0x1f8bd5=_0x2e6293&&_0x2e6293['health']?_0x2e6293[_0x15bedd(0x270)][_0x15bedd(0x360)]:_0x15bedd(0x33b),_0x1a3085=new Date();_0x1a3085['setHours'](0x4,0x0,0x0,0x0);const _0x320048=_0x11b690[_0x15bedd(0x380)][_0x15bedd(0x2b2)](_0x293e13=>new Date(_0x293e13['timestamp'])>_0x1a3085),_0xbb1be8=PERSONA_MAPPING[_0x11b690[_0x15bedd(0x390)][_0x15bedd(0x38c)]||_0x15bedd(0x1dd)],_0x2b9ca2=_0x11b690[_0x15bedd(0x390)][_0x15bedd(0x2ab)]||'',_0x57fe7f=await getWeatherContext(_0x11b690),_0x327eff=await getCalendarContext(_0x11b690),_0x49f76d=_0x15bedd(0x278)+_0xbb1be8+_0x15bedd(0x265)+_0x2b9ca2+'.\x20ZUSATZ:\x20'+_0x57fe7f+'\x20'+_0x327eff+_0x15bedd(0x39d)+_0x1f8bd5+_0x15bedd(0x2ba);try{const _0x49f13e=await _0x11b690[_0x15bedd(0x352)][_0x15bedd(0x309)](_0x49f76d),_0x23f1ac=_0x15bedd(0x2b7)+_0x49f13e[_0x15bedd(0x321)][_0x15bedd(0x282)]()[_0x15bedd(0x30f)]();sendNotification(_0x11b690,_0x23f1ac);}catch(_0x35ae52){_0x11b690['log'][_0x15bedd(0x27c)]('Briefing\x20Error:\x20'+_0x35ae52[_0x15bedd(0x383)]);}}function a0_0x264d(_0x251208,_0x1aedb7){const _0x4685f3=a0_0x437c();return a0_0x264d=function(_0x1965f5,_0x4201aa){_0x1965f5=_0x1965f5-0x1d1;let _0x437c17=_0x4685f3[_0x1965f5];return _0x437c17;},a0_0x264d(_0x251208,_0x1aedb7);}async function getCalendarNames(_0x1ff08d,_0x5e175e){const _0x582e83=a0_0x32d222;try{const _0x22998c=await _0x1ff08d[_0x582e83(0x288)](_0x5e175e+_0x582e83(0x1ec));if(_0x22998c&&_0x22998c[_0x582e83(0x34d)]){const _0x10c8f4=JSON[_0x582e83(0x289)](_0x22998c[_0x582e83(0x34d)]);if(Array['isArray'](_0x10c8f4))return[...new Set(_0x10c8f4[_0x582e83(0x25e)](_0x28423b=>_0x28423b[_0x582e83(0x39b)])['filter'](Boolean))]['sort']();}}catch(_0x1447eb){}return[];}async function getCalendarContext(_0x53a253){const _0x36490c=a0_0x32d222;if(!_0x53a253[_0x36490c(0x390)][_0x36490c(0x29e)])return _0x36490c(0x3a1);const _0xdb600=_0x53a253[_0x36490c(0x390)]['calendarInstance']||_0x36490c(0x362);try{const _0x249cdb=await _0x53a253['getForeignStateAsync'](_0xdb600+'.data.table');if(_0x249cdb&&_0x249cdb[_0x36490c(0x34d)]){let _0x2838f8=JSON[_0x36490c(0x289)](_0x249cdb['val']);if(Array['isArray'](_0x2838f8)){if(_0x2838f8[_0x36490c(0x226)]>0x0)return _0x36490c(0x31a)+_0x2838f8[_0x36490c(0x224)](0x0,0x3)[_0x36490c(0x25e)](_0xede4a3=>_0xede4a3[_0x36490c(0x37b)])[_0x36490c(0x332)](',\x20');}}}catch(_0x50e0ec){}return _0x36490c(0x1e8);}async function saveFeedback(_0x5ca340,_0x379d55){const _0x25bd92=a0_0x32d222;_0x5ca340[_0x25bd92(0x2b6)][_0x25bd92(0x2c5)](_0x25bd92(0x2f1)+JSON[_0x25bd92(0x1f2)](_0x379d55));}async function initSensorSubscriptions(_0x11fb1e){const _0x17c8cb=a0_0x32d222,_0x58a0e8=_0x11fb1e[_0x17c8cb(0x390)][_0x17c8cb(0x238)];if(_0x58a0e8)for(const _0x4511d8 of _0x58a0e8){await _0x11fb1e[_0x17c8cb(0x333)](_0x4511d8['id']);}}async function initPresenceSubscriptions(_0x2ad938){const _0x127c6e=a0_0x32d222,_0x2b5411=_0x2ad938[_0x127c6e(0x390)]['presenceDevices'];if(_0x2b5411)for(const _0x466255 of _0x2b5411){await _0x2ad938['subscribeForeignStatesAsync'](_0x466255);}}async function setupTelegramListener(_0x5eefd7){const _0x2d6f8c=a0_0x32d222,_0x27785a=_0x5eefd7[_0x2d6f8c(0x390)][_0x2d6f8c(0x2eb)];if(_0x5eefd7[_0x2d6f8c(0x390)]['notifyTelegramEnabled']&&_0x27785a)await _0x5eefd7[_0x2d6f8c(0x333)](_0x27785a+_0x2d6f8c(0x244));}async function checkWifiPresence(_0x454729){const _0x292564=a0_0x32d222;try{const _0x4eff2f=_0x454729[_0x292564(0x390)][_0x292564(0x25a)]||[];let _0x24a863=![];const _0x20affb=[];for(const _0x5c3536 of _0x4eff2f){try{const _0x17c6fd=await _0x454729[_0x292564(0x288)](_0x5c3536);_0x17c6fd&&(_0x17c6fd[_0x292564(0x34d)]===!![]||_0x17c6fd[_0x292564(0x34d)]===_0x292564(0x2d2)||_0x17c6fd['val']===0x1)&&(_0x24a863=!![],_0x20affb[_0x292564(0x2bd)](_0x5c3536));}catch(_0x5854c4){}}return await _0x454729[_0x292564(0x2db)]('system.presenceWho',{'val':_0x20affb[_0x292564(0x332)](',\x20'),'ack':!![]}),_0x24a863&&(_0x454729[_0x292564(0x33d)]&&(_0x454729[_0x292564(0x2b6)][_0x292564(0x2c5)](_0x292564(0x32e)),abortExitTimer(_0x454729)),!_0x454729['isPresent']&&_0x454729[_0x292564(0x218)]===SYSTEM_MODES[_0x292564(0x2c8)]&&await setPresence(_0x454729,!![])),_0x24a863;}catch(_0x3fff36){return![];}}function startExitTimer(_0x3cff8d){const _0x4e546f=a0_0x32d222;abortExitTimer(_0x3cff8d),_0x3cff8d[_0x4e546f(0x353)]=!![],_0x3cff8d[_0x4e546f(0x2ce)]=setTimeout(()=>{const _0x1cd719=_0x4e546f;_0x3cff8d[_0x1cd719(0x353)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x3cff8d['exitTimer']=setTimeout(()=>{setPresence(_0x3cff8d,![]),_0x3cff8d['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x1e202b){const _0x2545e4=a0_0x32d222;if(_0x1e202b[_0x2545e4(0x33d)])clearTimeout(_0x1e202b['exitTimer']);if(_0x1e202b['exitGraceTimer'])clearTimeout(_0x1e202b['exitGraceTimer']);_0x1e202b[_0x2545e4(0x33d)]=null,_0x1e202b[_0x2545e4(0x2ce)]=null,_0x1e202b[_0x2545e4(0x353)]=![];}async function setPresence(_0x5d44d8,_0x3c6904){const _0x217e92=a0_0x32d222;if(_0x5d44d8[_0x217e92(0x36b)]===_0x3c6904)return;_0x5d44d8[_0x217e92(0x36b)]=_0x3c6904,await _0x5d44d8[_0x217e92(0x2db)](_0x217e92(0x220),{'val':_0x3c6904,'ack':!![]});}async function executeAutomationAction(_0x4df50b){const _0x5b409e=a0_0x32d222;try{const _0x32e810=await _0x4df50b[_0x5b409e(0x285)](_0x5b409e(0x250)),_0x4ac98b=await _0x4df50b[_0x5b409e(0x285)](_0x5b409e(0x2c7));if(_0x32e810&&_0x32e810[_0x5b409e(0x34d)]&&_0x4ac98b){const _0x501cc3=_0x32e810[_0x5b409e(0x34d)];let _0x36e12b=_0x4ac98b[_0x5b409e(0x34d)];try{_0x36e12b=JSON['parse'](_0x36e12b);}catch(_0x1c5c61){}_0x4df50b['log'][_0x5b409e(0x2c5)](_0x5b409e(0x2a4)+_0x501cc3+_0x5b409e(0x2c2)+_0x36e12b),await _0x4df50b['setForeignStateAsync'](_0x501cc3,_0x36e12b);}else _0x4df50b[_0x5b409e(0x2b6)][_0x5b409e(0x377)](_0x5b409e(0x372));}catch(_0x426148){_0x4df50b[_0x5b409e(0x2b6)]['error'](_0x5b409e(0x2d5)+_0x426148[_0x5b409e(0x383)]);}}async function handleTelegramResponse(_0x3c59a4,_0x2e899c){const _0x3e553d=a0_0x32d222;let _0x5f4097=_0x2e899c;_0x2e899c[_0x3e553d(0x391)]('[')&&(_0x5f4097=_0x2e899c[_0x3e553d(0x2f7)](_0x2e899c[_0x3e553d(0x1de)](']')+0x1));if(_0x5f4097===_0x3e553d(0x345))await _0x3c59a4[_0x3e553d(0x2db)](_0x3e553d(0x331),{'val':![],'ack':!![]}),await _0x3c59a4['setStateAsync'](_0x3e553d(0x243),{'val':_0x3e553d(0x221),'ack':!![]}),_0x3c59a4[_0x3e553d(0x25f)]=![],sendNotification(_0x3c59a4,_0x3e553d(0x336),![]);else _0x5f4097===_0x3e553d(0x325)&&sendNotification(_0x3c59a4,_0x3e553d(0x29b),![],!![]);}async function sendNotification(_0x6f12e1,_0x2320ec,_0x3aa124=![],_0x8b4c25=![]){const _0x330bd2=a0_0x32d222,_0x4c2375=_0x6f12e1['config'];if(_0x4c2375[_0x330bd2(0x343)]){let _0x2517c1={};(_0x2320ec[_0x330bd2(0x317)](_0x330bd2(0x284))||_0x8b4c25)&&(_0x2517c1={'reply_markup':{'inline_keyboard':[[{'text':_0x330bd2(0x2ef),'callback_data':_0x330bd2(0x345)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x330bd2(0x325)}]]}}),await _0x6f12e1[_0x330bd2(0x33a)](_0x4c2375['notifyTelegramInstance'],'send',{'text':_0x2320ec,'user':_0x4c2375[_0x330bd2(0x272)],..._0x2517c1});}if(_0x4c2375['notifyPushoverEnabled']){let _0x17087b={'message':_0x2320ec,'title':_0x8b4c25?_0x330bd2(0x292):_0x330bd2(0x227),'priority':_0x8b4c25?0x2:0x1,'device':_0x4c2375[_0x330bd2(0x236)]};_0x8b4c25&&(_0x17087b['retry']=0x1e,_0x17087b[_0x330bd2(0x213)]=0xe10,_0x17087b[_0x330bd2(0x1ea)]=_0x330bd2(0x25c)),await _0x6f12e1['sendToAsync'](_0x4c2375[_0x330bd2(0x1d9)],_0x330bd2(0x342),_0x17087b);}_0x4c2375[_0x330bd2(0x36f)]&&await _0x6f12e1['sendToAsync'](_0x4c2375[_0x330bd2(0x29f)],_0x330bd2(0x342),{'text':_0x2320ec,'to':_0x4c2375[_0x330bd2(0x29d)]});}async function runAutopilot(_0x3dc21a){const _0xaa4455=a0_0x32d222,_0x140548=_0x3dc21a['config'][_0xaa4455(0x249)],_0x5056e6=_0x3dc21a[_0xaa4455(0x380)]['length']>0x0?_0x3dc21a[_0xaa4455(0x380)][0x0][_0xaa4455(0x287)]:Date[_0xaa4455(0x240)](),_0x21ad1b=(Date[_0xaa4455(0x240)]()-_0x5056e6)/(0x3e8*0x3c*0x3c);let _0x2812a8='';_0x3dc21a[_0xaa4455(0x390)][_0xaa4455(0x2d4)]&&_0x3dc21a[_0xaa4455(0x218)]===SYSTEM_MODES[_0xaa4455(0x2c8)]&&_0x3dc21a['isPresent']&&(_0x21ad1b>_0x140548&&(_0x2812a8=_0xaa4455(0x27a)+_0x21ad1b[_0xaa4455(0x201)](0x1)+'h.')),runGeminiAnalysis(_0x3dc21a,_0x2812a8);}async function runPythonHealthCheck(_0x4d25dd){const _0x20c7b9=a0_0x32d222;if(!_0x4d25dd[_0x20c7b9(0x24d)]||_0x4d25dd[_0x20c7b9(0x24d)][_0x20c7b9(0x226)]<0x2)return;const _0x62036b=_0x4d25dd[_0x20c7b9(0x24d)]['map'](_0x40a4d6=>{const _0x5ce2a7=_0x20c7b9,_0x2d78a3=(_0x40a4d6[_0x5ce2a7(0x395)]||'')[_0x5ce2a7(0x351)]();return ACTIVITY_LEVEL_MAP[_0x2d78a3]||0x32;});sendToPython(_0x4d25dd,_0x20c7b9(0x2b8),{'values':_0x62036b,'tag':_0x20c7b9(0x246)});}class CogniLiving extends utils['Adapter']{constructor(_0x265887){const _0x447339=a0_0x32d222;super({..._0x265887,'name':_0x447339(0x20d)}),this[_0x447339(0x380)]=[],this[_0x447339(0x29a)]=[],this[_0x447339(0x27f)]=[],this['dailyDigests']=[],this[_0x447339(0x38a)]={},this[_0x447339(0x389)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x447339(0x36b)]=!![],this['exitTimer']=null,this[_0x447339(0x2ce)]=null,this[_0x447339(0x353)]=![],this[_0x447339(0x266)]=null,this[_0x447339(0x352)]=null,this[_0x447339(0x218)]=SYSTEM_MODES['NORMAL'],this[_0x447339(0x28e)]=![],this[_0x447339(0x25f)]=![],this[_0x447339(0x28c)]=_0x447339(0x340),this[_0x447339(0x21a)]=null,this[_0x447339(0x31e)]=null,this[_0x447339(0x392)]=null,this[_0x447339(0x26d)]=null,this[_0x447339(0x1f5)]=null,this[_0x447339(0x20c)]=null,this[_0x447339(0x36a)]=![],this['on']('ready',this[_0x447339(0x2f9)]['bind'](this)),this['on']('stateChange',this[_0x447339(0x2de)][_0x447339(0x22a)](this)),this['on'](_0x447339(0x318),this[_0x447339(0x1e5)]['bind'](this)),this['on'](_0x447339(0x383),this['onMessage'][_0x447339(0x22a)](this));}async['onReady'](){const _0xae07be=a0_0x32d222;this[_0xae07be(0x2b6)][_0xae07be(0x2c5)]('cogni-living\x20adapter\x20starting\x20(v'+this['version']+_0xae07be(0x1f0)),await initZombies(this);try{this[_0xae07be(0x28e)]=await checkLicense(this,this[_0xae07be(0x390)][_0xae07be(0x36e)]);}catch(_0x3bb2fe){}if(!this[_0xae07be(0x390)]['inactivityThresholdHours']||this[_0xae07be(0x390)][_0xae07be(0x249)]<0.1)this['config'][_0xae07be(0x249)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0xae07be(0x390)][_0xae07be(0x2ff)])try{this[_0xae07be(0x266)]=new GoogleGenerativeAI(this[_0xae07be(0x390)]['geminiApiKey']),this['geminiModel']=this[_0xae07be(0x266)][_0xae07be(0x1ff)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xae07be(0x31d)}}),this[_0xae07be(0x2b6)][_0xae07be(0x2c5)](_0xae07be(0x212));}catch(_0x9ce985){this[_0xae07be(0x2b6)]['error'](_0xae07be(0x34e)+_0x9ce985['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0xae07be(0x1fe)](_0xae07be(0x2be)),this[_0xae07be(0x1fe)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0xae07be(0x388)),this['subscribeStates'](_0xae07be(0x2cb)),this[_0xae07be(0x1fe)]('analysis.automation.triggerAction'),this[_0xae07be(0x1fe)](_0xae07be(0x375)),this[_0xae07be(0x1fe)]('analysis.training.triggerSecurity'),this[_0xae07be(0x1fe)](_0xae07be(0x275)),this[_0xae07be(0x1fe)]('analysis.training.triggerEnergy'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0xae07be(0x21a)])clearInterval(this[_0xae07be(0x21a)]);const _0x4c3077=this['config'][_0xae07be(0x23b)]||0xf;_0x4c3077>0x0&&(this[_0xae07be(0x21a)]=setInterval(()=>{runAutopilot(this);},_0x4c3077*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{if(this['pythonProcess'])runPythonHealthCheck(this);},0x1388);}[a0_0x32d222(0x1e5)](_0x4a26e6){const _0x4088bc=a0_0x32d222;if(this[_0x4088bc(0x21a)])clearInterval(this[_0x4088bc(0x21a)]);if(this[_0x4088bc(0x26d)])clearInterval(this[_0x4088bc(0x26d)]);if(this['ltmJob'])this[_0x4088bc(0x31e)][_0x4088bc(0x356)]();if(this[_0x4088bc(0x392)])this[_0x4088bc(0x392)]['cancel']();if(this[_0x4088bc(0x1f5)])this[_0x4088bc(0x1f5)][_0x4088bc(0x356)]();if(this[_0x4088bc(0x33d)])clearTimeout(this[_0x4088bc(0x33d)]);if(this['exitGraceTimer'])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x4a26e6();}async[a0_0x32d222(0x2de)](_0x357194,_0x568b7f){const _0xd1ed6a=a0_0x32d222;if(!_0x568b7f||this['dependencyInstallInProgress'])return;if(_0x357194[_0xd1ed6a(0x317)](_0xd1ed6a(0x2da))&&_0x357194[_0xd1ed6a(0x31f)](_0xd1ed6a(0x2a7))&&_0x568b7f[_0xd1ed6a(0x34d)]){await handleTelegramResponse(this,_0x568b7f[_0xd1ed6a(0x34d)]);return;}if(_0x357194===this[_0xd1ed6a(0x328)]+'.'+SYSTEM_DP_MODE){if(_0x568b7f[_0xd1ed6a(0x34d)]&&Object['values'](SYSTEM_MODES)[_0xd1ed6a(0x317)](_0x568b7f[_0xd1ed6a(0x34d)])){this['currentSystemMode']=_0x568b7f['val'];if(_0x568b7f[_0xd1ed6a(0x34d)]===SYSTEM_MODES[_0xd1ed6a(0x1fd)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x568b7f['ack'])this[_0xd1ed6a(0x1fa)](_0x357194,{'val':this[_0xd1ed6a(0x218)],'ack':!![]});return;}if(!_0x568b7f[_0xd1ed6a(0x2a1)]){_0x357194[_0xd1ed6a(0x317)](_0xd1ed6a(0x2be))&&_0x568b7f['val']&&(this[_0xd1ed6a(0x1fa)](_0x357194,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x357194[_0xd1ed6a(0x317)](_0xd1ed6a(0x263))&&_0x568b7f['val']){this['setState'](_0x357194,{'val':![],'ack':!![]});if(this[_0xd1ed6a(0x28e)])createDailyDigest(this);}_0x357194[_0xd1ed6a(0x317)](_0xd1ed6a(0x386))&&_0x568b7f[_0xd1ed6a(0x34d)]&&(this[_0xd1ed6a(0x1fa)](_0x357194,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x357194[_0xd1ed6a(0x317)](_0xd1ed6a(0x256))&&_0x568b7f[_0xd1ed6a(0x34d)]&&(this['setState'](_0x357194,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x357194[_0xd1ed6a(0x317)]('analysis.training.triggerSecurity')&&_0x568b7f[_0xd1ed6a(0x34d)]){this[_0xd1ed6a(0x1fa)](_0x357194,{'val':![],'ack':!![]});if(this[_0xd1ed6a(0x28e)])try{const _0x53f079=await this[_0xd1ed6a(0x285)]('LTM.trainingData.sequences');if(_0x53f079&&_0x53f079[_0xd1ed6a(0x34d)]){const _0x32c6a5=JSON[_0xd1ed6a(0x289)](_0x53f079[_0xd1ed6a(0x34d)]);this[_0xd1ed6a(0x2b6)][_0xd1ed6a(0x2c5)](_0xd1ed6a(0x257)),this[_0xd1ed6a(0x2db)]('analysis.training.status',{'val':_0xd1ed6a(0x355),'ack':!![]}),sendToPython(this,_0xd1ed6a(0x26b),{'sequences':_0x32c6a5});}}catch(_0x18ce26){this[_0xd1ed6a(0x2b6)][_0xd1ed6a(0x27c)](_0xd1ed6a(0x396)+_0x18ce26[_0xd1ed6a(0x383)]);}}if(_0x357194['includes'](_0xd1ed6a(0x275))&&_0x568b7f[_0xd1ed6a(0x34d)]){this[_0xd1ed6a(0x1fa)](_0x357194,{'val':![],'ack':!![]});if(this[_0xd1ed6a(0x28e)])try{const _0x12dddb=await this[_0xd1ed6a(0x285)](LTM_DP_DAILY_DIGESTS);if(_0x12dddb&&_0x12dddb['val'])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0xd1ed6a(0x289)](_0x12dddb[_0xd1ed6a(0x34d)])});}catch(_0x34d72d){}}if(_0x357194[_0xd1ed6a(0x317)]('analysis.training.triggerEnergy')&&_0x568b7f[_0xd1ed6a(0x34d)]){this[_0xd1ed6a(0x1fa)](_0x357194,{'val':![],'ack':!![]});if(this[_0xd1ed6a(0x28e)])try{const _0x46dd25=await this['getStateAsync'](_0xd1ed6a(0x2b1));if(_0x46dd25&&_0x46dd25[_0xd1ed6a(0x34d)])sendToPython(this,_0xd1ed6a(0x273),{'points':JSON['parse'](_0x46dd25[_0xd1ed6a(0x34d)])});}catch(_0x3ab9b1){}}return;}if(this[_0xd1ed6a(0x390)][_0xd1ed6a(0x25a)]&&this['config'][_0xd1ed6a(0x25a)][_0xd1ed6a(0x317)](_0x357194)){await checkWifiPresence(this);return;}const _0x1a0cb7=(this[_0xd1ed6a(0x390)][_0xd1ed6a(0x238)]||[])[_0xd1ed6a(0x252)](_0x22c665=>_0x22c665['id']===_0x357194);if(_0x1a0cb7)processSensorEvent(this,_0x357194,_0x568b7f,_0x1a0cb7);}async[a0_0x32d222(0x33f)](_0x1bb6b4){const _0x3c0515=a0_0x32d222;if(typeof _0x1bb6b4===_0x3c0515(0x347)&&_0x1bb6b4[_0x3c0515(0x383)]){if(_0x1bb6b4[_0x3c0515(0x24c)]===_0x3c0515(0x2e9)){const _0x37e77d=_0x1bb6b4[_0x3c0515(0x383)][_0x3c0515(0x251)]||this[_0x3c0515(0x390)][_0x3c0515(0x2ff)];if(!_0x37e77d)return this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4['command'],{'success':![],'message':_0x3c0515(0x30d)},_0x1bb6b4[_0x3c0515(0x26a)]);try{const _0x1ee1b2=new GoogleGenerativeAI(_0x37e77d),_0x4e0b00=_0x1ee1b2[_0x3c0515(0x1ff)]({'model':GEMINI_MODEL}),_0x9fab77=await _0x4e0b00[_0x3c0515(0x309)]('Hi');this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4[_0x3c0515(0x24c)],{'success':!![],'message':_0x3c0515(0x231)+_0x9fab77['response'][_0x3c0515(0x282)]()},_0x1bb6b4[_0x3c0515(0x26a)]);}catch(_0x299dbf){this['sendTo'](_0x1bb6b4['from'],_0x1bb6b4[_0x3c0515(0x24c)],{'success':![],'message':_0x3c0515(0x1e1)+_0x299dbf[_0x3c0515(0x383)]},_0x1bb6b4[_0x3c0515(0x26a)]);}}else{if(_0x1bb6b4['command']===_0x3c0515(0x371)){const _0x39046e=await getWeatherContext(this),_0x497e89=await getCalendarContext(this);this['sendTo'](_0x1bb6b4['from'],_0x1bb6b4['command'],{'success':!![],'weather':_0x39046e,'calendar':_0x497e89},_0x1bb6b4['callback']);}else{if(_0x1bb6b4[_0x3c0515(0x24c)]==='getLtmData'){if(!this[_0x3c0515(0x28e)])return this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4['command'],{'success':![],'isPro':![]},_0x1bb6b4['callback']);let _0x4e5e63={'status':_0x3c0515(0x33b)};try{const _0x32a55b=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x4e5e63[_0x3c0515(0x208)]=_0x32a55b?_0x32a55b['val']:'N/A';}catch(_0x16f7c2){}this['sendTo'](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4[_0x3c0515(0x24c)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x3c0515(0x24d)],'driftAnalysis':_0x4e5e63,'analysisHistory':this[_0x3c0515(0x29a)]},_0x1bb6b4[_0x3c0515(0x26a)]);}else{if(_0x1bb6b4[_0x3c0515(0x24c)]===_0x3c0515(0x301)){const _0x224ea9=this[_0x3c0515(0x24d)][_0x3c0515(0x226)],_0xcc05b8=new Date(),_0x1290cf=new Date(_0xcc05b8[_0x3c0515(0x299)](),_0xcc05b8[_0x3c0515(0x2f2)](),_0xcc05b8[_0x3c0515(0x203)]())[_0x3c0515(0x1eb)](),_0xfdcccf=this[_0x3c0515(0x27f)][_0x3c0515(0x2b2)](_0x271cb6=>new Date(_0x271cb6['timestamp'])[_0x3c0515(0x1eb)]()>_0x1290cf)['length'],_0x2381d3=new Array(0x18)[_0x3c0515(0x24e)](0x0);this[_0x3c0515(0x27f)][_0x3c0515(0x373)](_0x2c1809=>{const _0x5a3997=_0x3c0515,_0x44da22=new Date(_0x2c1809[_0x5a3997(0x287)]);if(_0x44da22[_0x5a3997(0x1eb)]()>_0x1290cf)_0x2381d3[_0x44da22['getHours']()]++;});let _0x3358db={'status':'N/A'};try{const _0x14391c=await this[_0x3c0515(0x285)](LTM_DP_DRIFT_STATUS);_0x3358db[_0x3c0515(0x208)]=_0x14391c?_0x14391c[_0x3c0515(0x34d)]:_0x3c0515(0x33b);}catch(_0x2e5978){}let _0x359f40='';try{const _0x42e33f=await this[_0x3c0515(0x285)](_0x3c0515(0x28f));_0x359f40=_0x42e33f?_0x42e33f[_0x3c0515(0x34d)]:'';}catch(_0xfcdbb8){}let _0x221cd4=null;!this[_0x3c0515(0x352)]&&(_0x221cd4=this['config']['geminiApiKey']?_0x3c0515(0x2a9):_0x3c0515(0x1f6));let _0x3549f8={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x5299ca=await this[_0x3c0515(0x285)](_0x3c0515(0x337));if(_0x5299ca&&_0x5299ca[_0x3c0515(0x34d)]){_0x3549f8[_0x3c0515(0x398)]=!![];const _0x1726f=await this[_0x3c0515(0x285)](_0x3c0515(0x361));_0x3549f8[_0x3c0515(0x32c)]=_0x1726f?_0x1726f[_0x3c0515(0x34d)]:'';const _0xb35283=await this[_0x3c0515(0x285)](_0x3c0515(0x250));_0x3549f8['targetId']=_0xb35283?_0xb35283['val']:'';const _0x289517=await this[_0x3c0515(0x285)](_0x3c0515(0x2c7));_0x3549f8[_0x3c0515(0x2e8)]=_0x289517?_0x289517['val']:'';}const _0x1d52f5=await this[_0x3c0515(0x285)](_0x3c0515(0x375));_0x3549f8['autoApply']=_0x1d52f5?!!_0x1d52f5[_0x3c0515(0x34d)]:![];}catch(_0x4b67f2){}this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4[_0x3c0515(0x24c)],{'success':!![],'eventHistory':this[_0x3c0515(0x380)][_0x3c0515(0x224)](0x0,0xf),'stats':{'digestCount':_0x224ea9,'eventCountToday':_0xfdcccf,'hourlyActivity':_0x2381d3,'driftStatus':_0x3358db[_0x3c0515(0x208)],'isPresent':this[_0x3c0515(0x36b)],'presenceWho':_0x359f40,'minDays':this[_0x3c0515(0x390)]['minDaysForBaseline']||0x7,'stbDays':this[_0x3c0515(0x390)][_0x3c0515(0x1d6)]||0xe,'ltbDays':this[_0x3c0515(0x390)][_0x3c0515(0x26e)]||0x3c,'systemError':_0x221cd4},'automation':_0x3549f8},_0x1bb6b4[_0x3c0515(0x26a)]);}else{if(_0x1bb6b4[_0x3c0515(0x24c)]===_0x3c0515(0x39f))try{const _0x5d2bd7=await scanForDevices(this,_0x1bb6b4[_0x3c0515(0x383)]||{});this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4[_0x3c0515(0x24c)],{'success':!![],'devices':_0x5d2bd7},_0x1bb6b4[_0x3c0515(0x26a)]);}catch(_0xc648ac){this['sendTo'](_0x1bb6b4['from'],_0x1bb6b4[_0x3c0515(0x24c)],{'success':![],'error':_0xc648ac[_0x3c0515(0x383)]},_0x1bb6b4[_0x3c0515(0x26a)]);}else{if(_0x1bb6b4[_0x3c0515(0x24c)]===_0x3c0515(0x348)){const _0x3d5f48=await this['getForeignObjectsAsync'](_0x3c0515(0x2c9),_0x3c0515(0x24b)),_0xdc9bee=[];if(_0x3d5f48)for(const _0x548577 in _0x3d5f48){const _0x4af3db=_0x3d5f48[_0x548577],_0x34ab0a=(_0x4af3db['common']&&typeof _0x4af3db[_0x3c0515(0x31c)][_0x3c0515(0x228)]===_0x3c0515(0x347)?_0x4af3db[_0x3c0515(0x31c)][_0x3c0515(0x228)]['de']:_0x4af3db[_0x3c0515(0x31c)][_0x3c0515(0x228)])||_0x4af3db['common'][_0x3c0515(0x228)];_0xdc9bee['push']({'id':_0x548577,'name':_0x34ab0a});}this['sendTo'](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4[_0x3c0515(0x24c)],{'success':!![],'enums':_0xdc9bee},_0x1bb6b4[_0x3c0515(0x26a)]);}else{if(_0x1bb6b4['command']===_0x3c0515(0x1fb)){const _0x34f3e6=_0x1bb6b4[_0x3c0515(0x383)][_0x3c0515(0x397)];if(!_0x34f3e6)return this[_0x3c0515(0x381)](_0x1bb6b4['from'],_0x1bb6b4[_0x3c0515(0x24c)],{'success':![],'error':_0x3c0515(0x2bc)},_0x1bb6b4[_0x3c0515(0x26a)]);const _0x5aea5d=await getCalendarNames(this,_0x34f3e6);this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4[_0x3c0515(0x24c)],{'success':!![],'names':_0x5aea5d},_0x1bb6b4[_0x3c0515(0x26a)]);}else{if(_0x1bb6b4[_0x3c0515(0x24c)]==='simulateButler'){const {targetId:_0x170cd3,targetValue:_0x5e0d37}=_0x1bb6b4[_0x3c0515(0x383)];this[_0x3c0515(0x2b6)][_0x3c0515(0x2c5)]('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0x170cd3+_0x3c0515(0x2c2)+_0x5e0d37),await this[_0x3c0515(0x2db)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x3c0515(0x2db)](_0x3c0515(0x361),{'val':_0x3c0515(0x27b)+_0x170cd3,'ack':!![]}),await this['setStateAsync']('analysis.automation.targetId',{'val':_0x170cd3,'ack':!![]}),await this['setStateAsync']('analysis.automation.targetValue',{'val':_0x5e0d37,'ack':!![]}),this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4['command'],{'success':!![]},_0x1bb6b4[_0x3c0515(0x26a)]);}else{if(_0x1bb6b4[_0x3c0515(0x24c)]===_0x3c0515(0x306)){const {historyId:_0x56881,rating:_0x3030df,comment:_0x5a5a26,alertReason:_0x54a41c}=_0x1bb6b4['message'];_0x56881&&_0x3030df?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x56881,'rating':_0x3030df,'comment':_0x5a5a26,'alertReason':_0x54a41c}),this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4[_0x3c0515(0x24c)],{'success':!![]},_0x1bb6b4['callback'])):this[_0x3c0515(0x381)](_0x1bb6b4['from'],_0x1bb6b4['command'],{'success':![],'error':_0x3c0515(0x1e0)},_0x1bb6b4[_0x3c0515(0x26a)]);}else _0x1bb6b4['command']===_0x3c0515(0x2d3)&&(this[_0x3c0515(0x2b6)][_0x3c0515(0x2c5)](_0x3c0515(0x2d7)),await this[_0x3c0515(0x2db)](_0x3c0515(0x337),{'val':![],'ack':!![]}),await this[_0x3c0515(0x2db)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x3c0515(0x381)](_0x1bb6b4[_0x3c0515(0x206)],_0x1bb6b4[_0x3c0515(0x24c)],{'success':!![]},_0x1bb6b4[_0x3c0515(0x26a)]));}}}}}}}}}}}if(require[a0_0x32d222(0x28a)]!==module)module['exports']=_0x961528=>new CogniLiving(_0x961528);else new CogniLiving();