const a0_0x4fc07f=a0_0x511f;(function(_0xba14a8,_0x58891f){const _0x4783ce=a0_0x511f,_0x1dce8c=_0xba14a8();while(!![]){try{const _0x1056a8=-parseInt(_0x4783ce(0x339))/0x1*(-parseInt(_0x4783ce(0x369))/0x2)+parseInt(_0x4783ce(0x30a))/0x3*(-parseInt(_0x4783ce(0x2cd))/0x4)+parseInt(_0x4783ce(0x311))/0x5+-parseInt(_0x4783ce(0x1ae))/0x6*(-parseInt(_0x4783ce(0x242))/0x7)+-parseInt(_0x4783ce(0x2a1))/0x8+parseInt(_0x4783ce(0x2ae))/0x9*(parseInt(_0x4783ce(0x1da))/0xa)+-parseInt(_0x4783ce(0x1d9))/0xb;if(_0x1056a8===_0x58891f)break;else _0x1dce8c['push'](_0x1dce8c['shift']());}catch(_0x165bc0){_0x1dce8c['push'](_0x1dce8c['shift']());}}}(a0_0x2624,0x8ea94));const a0_0x5cdeda=(function(){let _0x11a4ef=!![];return function(_0x24effe,_0x563eda){const _0x53f8e4=_0x11a4ef?function(){if(_0x563eda){const _0x930999=_0x563eda['apply'](_0x24effe,arguments);return _0x563eda=null,_0x930999;}}:function(){};return _0x11a4ef=![],_0x53f8e4;};}()),a0_0x5d1a1f=a0_0x5cdeda(this,function(){const _0x81a329=a0_0x511f;return a0_0x5d1a1f[_0x81a329(0x35f)]()[_0x81a329(0x359)](_0x81a329(0x341))[_0x81a329(0x35f)]()[_0x81a329(0x20b)](a0_0x5d1a1f)[_0x81a329(0x359)](_0x81a329(0x341));});a0_0x5d1a1f();'use strict';function a0_0x2624(){const _0xc80d7a=['automation.triggerAction','notifyEmailRecipient','role','Error:\x20','brightness','longitude','.NextHours.Location_1.Day_1.current.symbol_desc','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','_calName','getCalendarNames','values','inactivityThresholdHours','LTM.triggerDailyDigest','GUEST','Description','enum','Briefing\x20Error:\x20','isAlert','LTM.rawEventLog','.data.table','.\x20OUTPUT:\x20Nur\x20Text.','currentSystemMode','Urlaub','âš ï¸\x20ALARM:\x20','Skipped\x20(No\x20AI\x20or\x20Data)','Kalender:\x20Deaktiviert','connection','reachable','7tqGVXG','sendToAsync','Comfort\x20Summary','notifyTelegramInstance','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','communicate.request','prÃ¤senz','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','tÃ¼r','Gemini\x20Analysis\x20Error:\x20','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','indicator.alarm','thermostat','sendTo','bind','length','analysis.feedbackHistory','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','startsWith','scriptProblem','rawEventLog','details','push','json','getTime','endsWith','fill','pop','system','channel','uuid-error','analysis.alertReason','unknown','TEST-PRO-KEY','currentposition','automationProposal','Deaktiviert\x20(Pro-Feature)','button','guest','child_process','\x20=\x20','instance','activityLevel','blind','licenseKey','custom','update','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','info.','time','level','switch','working','submitFeedback','response','energy','rssi','Action','analysis.automation','Started\x20at\x20','setHours','Reset\x20Sched\x20Error:\x20','exports','value','Success:\x20Compressed\x20','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','lampe','NORMAL','toLocaleString','maintenance','firmware','analysis.isAlert','\x20*\x20*\x20*','Alarm','dutycycle','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','normal','text.alarm','system.config','Processing\x20Status','Alert\x20Reason','\x20(Value:\x20','onMessage','ðŸŒ…\x20Daily\x20Briefing:\x0a','isArray','Raw\x20Log','analysis.automation.targetId','common','analysis.automation.description','bewegung','Drift\x20Status','error','namespace','parse','ðŸš¨\x20EMERGENCY','1777952IxAKjU','genAI','toFixed','triggerBriefing','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','briefingTime','accuweather.0','analysis.health.notes','LTM.driftAnalysis.baselineDrift','sound','getObjectAsync','System\x20Mode','trim','1120464vzKjhj','from','ltmStbWindowDays','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','javascript.','Generating\x20Morning\x20Briefing...','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','lights','Baseline\x20Status','config_pending','timestamp','analysis.triggerBriefing','events.history_debug_00','LTM.driftAnalysis','sensorLastValues','notifyEmailEnabled','WETTER:\x20Keine\x20Daten\x20gefunden','08:00','fenster','summary','ðŸ\x20Stopping\x20Python\x20Sidecar...','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','analysis.deviationFromBaseline','triggerDailyDigest','some','analysis.automation.autoApply','analysis.history_debug_00','date','find','eventHistory','send','24436TjJmtm','version','systemConfig','simulateButler','shutter','motion','temp','direction','\x20min).','weatherunderground.0','alertReason','write','isProVersion','isEmergency','callback','number','Target\x20ID','party','health','extendObjectAsync','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','ltmJob','weather','KALENDER:\x20','Sending\x20notification:\x20\x22','analysis.comfortSummary','stdout','ltmLtbWindowDays','getDate','isPresent','getForeignStateAsync','targetId','system.presenceWho','exitGraceTimer','history.','.Summary.Current','simple-api.','map','name','analysis.health','setState','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','valve','analysis.isEmergency','No\x20instance','\x22\x20--break-system-packages','.\x20KONTEXT:\x20','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','LTM.driftAnalysis.lastCheck','modeResetJob','toLowerCase','description','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','User\x20dismissed\x20automation\x20proposal.','IGNORING\x20DUPLICATE:\x20','Error\x20reading\x20calendar\x20table:\x20','Restlessness\x20Level','\x20for\x20interactive\x20buttons...','Last\x20Check','baselineDrift','Feedback\x20saved:\x20','573yzaPJM','VACATION','getForeignObjectsAsync','System\x20Status\x20&\x20Control','string','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','dimmer','1363735jDUiVP','system.isPresent','rollladen','Event\x20History','service.py','message','fault','generateContent','KALENDER:\x20Keine\x20relevanten\x20Termine','Fokus\x20auf\x20Familienroutinen.','0\x204\x20*\x20*\x20*','boolean','command','stateChange','includes','Comfort\x20Suggestion','systemUUID','Trigger\x20Digest','...','onStateChange','material.','devices','useCalendar','scanDevices','config','Trigger\x20Analysis','position','setpoint','native','lastCheck','cancel','data','humidity','KALENDER\x20ERROR:\x20','stick_unreach','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','getLtmData','feedbackHistory','0\x203\x20*\x20*\x20*','Automation\x20Proposals','637YVSrqj','Event\x20received:\x20','notifyTelegramEnabled','PRIORITÃ„T:\x20Gesundheit/AAL.','system.meta.uuid','object','Details:\x20','Normal','(((.+)+)+)+$','Gast','analysis.trigger','door','N/A','scheduleJob','analysisHistory','split','flot.','\x20events','aiPersona','dailyDigests','analysis.automation.triggerAction','.\x0a\x20\x20\x20\x20WETTER:\x20','getMonth','events.lastEvent','Adapter','log','useWeather','substring','application/json','AI\x20Alert\x20Status','indicator.alarm.fire','occupancy','search','splice','Trigger\x20Briefing\x20(Test)','analysis.automation.targetValue','targetValue','daswetter.0','toString','forEach','testApiKey','_score','power','weatherInstance','AI\x20Emergency\x20Status','getEnums','presence','getForeignObjectAsync','2526bgaIkH','@iobroker/adapter-core','subscribeForeignStatesAsync','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','python_service','Keiner','indicator','text','N/A\x20(Learning)','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','Subscribing\x20to\x20','ack','Scheduling\x20Morning\x20Briefing\x20for\x20','geminiModel','enum.rooms.*','admin.','Daily\x20Digests','analysis.health.restlessness','analysisInterval','livingContext','PARTY','selectedFunctionIds','isGracePeriodActive','4770582rljwMK','âœ…\x20Alles\x20OK\x20(Reset)','ðŸ“¡\x20Hooking\x20into\x20','type','Keine\x20Details.','analysis.automation.patternDetected','.forecast.current.state','driftAnalysisTimer','.\x20DATEN:\x20Schlaf\x20','Last\x20Result','Starting\x20Autopilot\x20(','kill','LTM','analysisTimer','Who\x20is\x20present?','Health\x20Notes','Deviation','status','LTM.processingStatus','klima','analysis.analysisHistory','Cogni-Living','LTM.driftAnalysis.driftDetails','accuweather','getFullYear','setStateAsync','actual_temperature','location','notifyPushoverRecipient','join','lastAlertState','licht','Feedback\x20Log','info','exitTimer','.communicate.request','siren','getHours','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','No\x20module\x20named','enum.functions.*','analysis.automation.suggestedAction','258148QGtmFE','10Pcgjoi','pythonProcess','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','setForeignStateAsync','val','briefingJob','stringify','replace','vacation','setObjectNotExistsAsync','none','warn','Health\x20&\x20Sleep\x20Analysis','node-schedule','Kein\x20API\x20Key!','isExit','COGNI_CONFIRM_OK','temperature','onUnload','dependencyInstallInProgress','off','Analysiere\x20ausgewogen.','sleepScore','presenceDevices','online','members','getGenerativeModel','WETTER\x20ERROR:\x20','autoApply','targetposition','Wetter:\x20Deaktiviert','python3\x20-m\x20pip\x20install\x20-r\x20\x22','events.history','[PYTHON]\x20','COGNI_REQUEST_CALL','KALENDER:\x20Keine\x20Daten','light','debug','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','unshift','filter','.\x20Welcome\x20home.','getStateAsync','Trigger\x20Action\x20Now','set_temperature','indexOf','PRO-','geminiApiKey','city','constructor','now','doors','logDuplicates','Auto\x20Apply\x20Rule','LTM\x20Sched\x20Error:\x20','detected','Briefing\x20Sched\x20Error:\x20','generic','minDaysForBaseline','lowbat','Drift\x20Details','dismissAutomation','onReady','unload','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','icons-mfd.','Activity\x20Summary','link_quality','state','cogni-living\x20adapter\x20starting\x20(v','subscribeStates','PRIORITÃ„T:\x20Sicherheit.','LTM.dailyDigests','getCalendarNames\x20Error:\x20','slice','uuid'];a0_0x2624=function(){return _0xc80d7a;};return a0_0x2624();}const utils=require(a0_0x4fc07f(0x36a)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x4fc07f(0x1e7)),{spawn,exec}=require(a0_0x4fc07f(0x269)),path=require('path'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x4fc07f(0x337),MODE_RESET_SCHEDULE=a0_0x4fc07f(0x31b),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x4fc07f(0x238),LTM_DP_DAILY_DIGESTS=a0_0x4fc07f(0x222),LTM_DP_STATUS=a0_0x4fc07f(0x1c0),LTM_DP_TRIGGER_DIGEST=a0_0x4fc07f(0x232),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x4fc07f(0x2bb),LTM_DP_DRIFT_STATUS=a0_0x4fc07f(0x2a9),LTM_DP_DRIFT_DETAILS=a0_0x4fc07f(0x1c4),LTM_DP_DRIFT_LAST_CHECK=a0_0x4fc07f(0x2fd),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x4fc07f(0x255),'scriptEnabled',a0_0x4fc07f(0x270),'unreach',a0_0x4fc07f(0x215),a0_0x4fc07f(0x27a),a0_0x4fc07f(0x240),a0_0x4fc07f(0x287),a0_0x4fc07f(0x29d),a0_0x4fc07f(0x317),a0_0x4fc07f(0x276),a0_0x4fc07f(0x2d4),a0_0x4fc07f(0x333),a0_0x4fc07f(0x2b7),a0_0x4fc07f(0x28c),a0_0x4fc07f(0x288),a0_0x4fc07f(0x241),a0_0x4fc07f(0x21d)],BAD_NAMES=[a0_0x4fc07f(0x1f7),a0_0x4fc07f(0x264),a0_0x4fc07f(0x21e),a0_0x4fc07f(0x274),a0_0x4fc07f(0x281),a0_0x4fc07f(0x22a),'on',a0_0x4fc07f(0x1ee),a0_0x4fc07f(0x275),a0_0x4fc07f(0x32b),a0_0x4fc07f(0x2d1),a0_0x4fc07f(0x26d),'cover',a0_0x4fc07f(0x1bf),a0_0x4fc07f(0x2d2),a0_0x4fc07f(0x367),a0_0x4fc07f(0x358),a0_0x4fc07f(0x1eb),a0_0x4fc07f(0x331),a0_0x4fc07f(0x363),a0_0x4fc07f(0x279),a0_0x4fc07f(0x32c),a0_0x4fc07f(0x2f7),a0_0x4fc07f(0x1c8),a0_0x4fc07f(0x206)],ADAPTER_BLACKLIST=['system.',a0_0x4fc07f(0x1a6),a0_0x4fc07f(0x272),'vis.',a0_0x4fc07f(0x2ef),a0_0x4fc07f(0x325),a0_0x4fc07f(0x21b),a0_0x4fc07f(0x349),'echarts.',a0_0x4fc07f(0x2b2),a0_0x4fc07f(0x2f1)],SYSTEM_MODES={'NORMAL':a0_0x4fc07f(0x28e),'VACATION':a0_0x4fc07f(0x1e2),'PARTY':a0_0x4fc07f(0x2de),'GUEST':a0_0x4fc07f(0x268)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x4fc07f(0x1ab)],SYSTEM_MODES[a0_0x4fc07f(0x233)]],PERSONA_MAPPING={'generic':a0_0x4fc07f(0x1ef),'senior_aal':a0_0x4fc07f(0x33c),'family':a0_0x4fc07f(0x31a),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x4fc07f(0x221)};async function initZombies(_0xd075b){const _0x1a7090=a0_0x4fc07f;try{const _0x28cd5d=[_0x1a7090(0x2c8),_0x1a7090(0x2ba)];for(const _0x2d38db of _0x28cd5d){try{const _0x323f8f=await _0xd075b[_0x1a7090(0x2ab)](_0x2d38db);_0x323f8f&&await _0xd075b['delObjectAsync'](_0x2d38db);}catch(_0x25d8df){}}}catch(_0x1541c7){}}function a0_0x511f(_0x35d038,_0x32a769){const _0x56bdcd=a0_0x2624();return a0_0x511f=function(_0x5d1a1f,_0x5cdeda){_0x5d1a1f=_0x5d1a1f-0x1a0;let _0x262451=_0x56bdcd[_0x5d1a1f];return _0x262451;},a0_0x511f(_0x35d038,_0x32a769);}async function initHistory(_0x376516){const _0x48fbe5=a0_0x4fc07f;try{const _0x3f71ee=await _0x376516[_0x48fbe5(0x204)](_0x48fbe5(0x1fa));_0x3f71ee&&_0x3f71ee['val']&&(_0x376516[_0x48fbe5(0x2cb)]=JSON[_0x48fbe5(0x29f)](_0x3f71ee[_0x48fbe5(0x1de)][_0x48fbe5(0x35f)]()));}catch(_0x286616){_0x376516[_0x48fbe5(0x2cb)]=[];}try{const _0x5ae6e2=await _0x376516[_0x48fbe5(0x204)]('analysis.analysisHistory');if(_0x5ae6e2&&_0x5ae6e2[_0x48fbe5(0x1de)])_0x376516[_0x48fbe5(0x347)]=JSON['parse'](_0x5ae6e2[_0x48fbe5(0x1de)][_0x48fbe5(0x35f)]());}catch(_0x264fa4){_0x376516['analysisHistory']=[];}}async function initSystemConfig(_0x59b20a){const _0x1e10fd=a0_0x4fc07f;try{const _0x4b5a02=await _0x59b20a['getForeignObjectAsync'](_0x1e10fd(0x290));_0x4b5a02&&_0x4b5a02[_0x1e10fd(0x299)]&&(_0x59b20a[_0x1e10fd(0x2cf)]={'latitude':_0x4b5a02[_0x1e10fd(0x299)]['latitude']||0x0,'longitude':_0x4b5a02[_0x1e10fd(0x299)][_0x1e10fd(0x22b)]||0x0,'city':_0x4b5a02[_0x1e10fd(0x299)][_0x1e10fd(0x20a)]||''});}catch(_0x416fa7){}}async function checkLicense(_0x38f639,_0x1a8bf7){const _0x5becf2=a0_0x4fc07f;if(!_0x1a8bf7)return![];_0x38f639[_0x5becf2(0x321)]=await getSystemUUID(_0x38f639);if(_0x1a8bf7===_0x5becf2(0x263)||_0x1a8bf7['startsWith'](_0x5becf2(0x208)))return!![];return![];}async function getSystemUUID(_0x464fa6){const _0x73189e=a0_0x4fc07f;try{const _0x5e48f8=await _0x464fa6[_0x73189e(0x368)](_0x73189e(0x33d));if(_0x5e48f8&&_0x5e48f8[_0x73189e(0x32d)]&&_0x5e48f8[_0x73189e(0x32d)][_0x73189e(0x225)])return _0x5e48f8['native'][_0x73189e(0x225)];return'uuid-not-found';}catch(_0x26806a){return _0x73189e(0x260);}}async function createAllObjects(_0x3e8ff4){const _0x4acce5=a0_0x4fc07f;await checkSystemObjects(_0x3e8ff4),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x2ed),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x1bc),'type':_0x4acce5(0x30e),'role':'text','read':!![],'write':![],'def':''},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x350),{'type':_0x4acce5(0x21e),'common':{'name':'Last\x20raw\x20event','type':'string','role':_0x4acce5(0x259),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)]('events.history',{'type':'state','common':{'name':_0x4acce5(0x314),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x343),{'type':'state','common':{'name':_0x4acce5(0x32a),'type':_0x4acce5(0x31c),'role':_0x4acce5(0x267),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x2b9),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x35b),'type':_0x4acce5(0x31c),'role':_0x4acce5(0x267),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)]('analysis.lastResult',{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x1b7),'type':_0x4acce5(0x30e),'role':'json','read':!![],'write':![]},'native':{}}),await _0x3e8ff4['setObjectNotExistsAsync'](_0x4acce5(0x289),{'type':'state','common':{'name':_0x4acce5(0x356),'type':_0x4acce5(0x31c),'role':_0x4acce5(0x24d),'read':!![],'write':![],'def':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x2f8),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x365),'type':_0x4acce5(0x31c),'role':_0x4acce5(0x357),'read':!![],'write':![],'def':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x261),{'type':'state','common':{'name':_0x4acce5(0x292),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x28f),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)]('analysis.activitySummary',{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x21c),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x370),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4['setObjectNotExistsAsync'](_0x4acce5(0x2c4),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x1be),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x21e),'read':!![],'write':![],'def':_0x4acce5(0x345)},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x2e6),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x244),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x370),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)]('analysis.comfortSuggestion',{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x320),'type':'string','role':_0x4acce5(0x370),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x2e0)](_0x4acce5(0x27c),{'type':_0x4acce5(0x25f),'common':{'name':_0x4acce5(0x338)},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x1b3),{'type':_0x4acce5(0x21e),'common':{'name':'Pattern\x20Detected','type':_0x4acce5(0x31c),'role':_0x4acce5(0x36f),'read':!![],'write':![],'def':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x29a),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x234),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x370),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4['setObjectNotExistsAsync'](_0x4acce5(0x1d8),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x27b),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x370),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x298),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x2dd),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x370),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x35c),{'type':_0x4acce5(0x21e),'common':{'name':'Target\x20Value','type':_0x4acce5(0x30e),'role':_0x4acce5(0x370),'read':!![],'write':![]},'native':{}}),await _0x3e8ff4['setObjectNotExistsAsync']('analysis.automation.autoApply',{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x20f),'type':'boolean','role':'switch','read':!![],'write':!![],'def':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x34d),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x205),'type':'boolean','role':_0x4acce5(0x267),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)]('analysis.analysisHistory',{'type':_0x4acce5(0x21e),'common':{'name':'Logbook','type':'string','role':_0x4acce5(0x259),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x252),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x1ce),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x259),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x3e8ff4[_0x4acce5(0x2e0)](_0x4acce5(0x2f4),{'type':_0x4acce5(0x25f),'common':{'name':_0x4acce5(0x1e6)},'native':{}}),await _0x3e8ff4['setObjectNotExistsAsync']('analysis.health.sleepScore',{'type':_0x4acce5(0x21e),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x4acce5(0x2dc),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x1a8),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x305),'type':'string','role':_0x4acce5(0x370),'read':!![],'write':![],'def':_0x4acce5(0x1e4)},'native':{}}),await _0x3e8ff4[_0x4acce5(0x1e3)](_0x4acce5(0x2a8),{'type':_0x4acce5(0x21e),'common':{'name':_0x4acce5(0x1bd),'type':_0x4acce5(0x30e),'role':_0x4acce5(0x370),'read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x3e8ff4),await checkLtmDriftObjects(_0x3e8ff4);}async function checkSystemObjects(_0x431043){const _0x1762d3=a0_0x4fc07f;await _0x431043[_0x1762d3(0x2e0)](_0x1762d3(0x25e),{'type':'channel','common':{'name':_0x1762d3(0x30d)},'native':{}}),await _0x431043[_0x1762d3(0x2e0)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x1762d3(0x2ac),'type':'string','role':_0x1762d3(0x21e),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x1762d3(0x285)],'states':{[SYSTEM_MODES[_0x1762d3(0x285)]]:_0x1762d3(0x340),[SYSTEM_MODES[_0x1762d3(0x30b)]]:_0x1762d3(0x23c),[SYSTEM_MODES[_0x1762d3(0x1ab)]]:'Party',[SYSTEM_MODES[_0x1762d3(0x233)]]:_0x1762d3(0x342)}},'native':{}});}async function checkLtmObjects(_0x123817){const _0x4773b4=a0_0x4fc07f;await _0x123817['extendObjectAsync'](_0x4773b4(0x1ba),{'type':_0x4773b4(0x25f),'common':{'name':_0x4773b4(0x1ba)},'native':{}}),await _0x123817[_0x4773b4(0x2e0)](LTM_DP_RAW_LOG,{'type':_0x4773b4(0x21e),'common':{'name':_0x4773b4(0x297),'type':_0x4773b4(0x30e),'role':_0x4773b4(0x259),'read':!![],'write':![]},'native':{}}),await _0x123817[_0x4773b4(0x2e0)](LTM_DP_DAILY_DIGESTS,{'type':_0x4773b4(0x21e),'common':{'name':_0x4773b4(0x1a7),'type':'string','role':_0x4773b4(0x259),'read':!![],'write':![]},'native':{}}),await _0x123817[_0x4773b4(0x2e0)](LTM_DP_STATUS,{'type':'state','common':{'name':_0x4773b4(0x291),'type':_0x4773b4(0x30e),'role':_0x4773b4(0x370),'read':!![],'write':![]},'native':{}}),await _0x123817[_0x4773b4(0x2e0)](LTM_DP_TRIGGER_DIGEST,{'type':_0x4773b4(0x21e),'common':{'name':_0x4773b4(0x322),'type':_0x4773b4(0x31c),'role':_0x4773b4(0x267),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x123817[_0x4773b4(0x2e0)](LTM_DP_BASELINE_STATUS,{'type':_0x4773b4(0x21e),'common':{'name':_0x4773b4(0x2b6),'type':_0x4773b4(0x30e),'role':_0x4773b4(0x370),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x564d60){const _0xcf668=a0_0x4fc07f;await _0x564d60['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0xcf668(0x25f),'common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x564d60[_0xcf668(0x2e0)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0xcf668(0x29c),'type':'string','role':_0xcf668(0x21e),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x564d60['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0xcf668(0x216),'type':_0xcf668(0x30e),'role':_0xcf668(0x370),'read':!![],'write':![]},'native':{}}),await _0x564d60[_0xcf668(0x2e0)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0xcf668(0x21e),'common':{'name':_0xcf668(0x307),'type':_0xcf668(0x2dc),'role':_0xcf668(0x2c9),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x131eec){const _0x36a66f=a0_0x4fc07f;try{const _0x15b7fb=await _0x131eec[_0x36a66f(0x204)](SYSTEM_DP_MODE);_0x15b7fb&&_0x15b7fb['val']&&Object['values'](SYSTEM_MODES)['includes'](_0x15b7fb[_0x36a66f(0x1de)])?_0x131eec[_0x36a66f(0x23b)]=_0x15b7fb[_0x36a66f(0x1de)]:(_0x131eec[_0x36a66f(0x23b)]=SYSTEM_MODES[_0x36a66f(0x285)],await _0x131eec[_0x36a66f(0x1c7)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x36a66f(0x285)],'ack':!![]}));}catch(_0x3b48b0){_0x131eec['currentSystemMode']=SYSTEM_MODES[_0x36a66f(0x285)];}}async function loadRawEventLog(_0x5afea0){const _0x31cb15=a0_0x4fc07f;try{const _0x5724e0=await _0x5afea0[_0x31cb15(0x204)](LTM_DP_RAW_LOG);if(_0x5724e0&&_0x5724e0[_0x31cb15(0x1de)])_0x5afea0['rawEventLog']=JSON['parse'](_0x5724e0[_0x31cb15(0x1de)]);}catch(_0x5a83e5){_0x5afea0[_0x31cb15(0x256)]=[];}}async function saveRawEventLog(_0x30f1ac){const _0x553614=a0_0x4fc07f;_0x30f1ac[_0x553614(0x256)][_0x553614(0x251)]>RAW_LOG_MAX_SIZE&&_0x30f1ac[_0x553614(0x256)][_0x553614(0x35a)](0x0,_0x30f1ac[_0x553614(0x256)][_0x553614(0x251)]-RAW_LOG_MAX_SIZE),await _0x30f1ac[_0x553614(0x1c7)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x30f1ac['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x4c1a2d){const _0x1d33a4=a0_0x4fc07f;try{const _0x4050b3=await _0x4c1a2d['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x4050b3&&_0x4050b3[_0x1d33a4(0x1de)])_0x4c1a2d['dailyDigests']=JSON[_0x1d33a4(0x29f)](_0x4050b3[_0x1d33a4(0x1de)]);}catch(_0x13e1aa){_0x4c1a2d[_0x1d33a4(0x34c)]=[];}await updateBaselineStatus(_0x4c1a2d);}async function saveDailyDigests(_0x47cf53,_0x5e64cc=!![]){const _0x43011c=a0_0x4fc07f,_0x2e8e59=_0x47cf53['config'][_0x43011c(0x2e8)]||0x3c;_0x47cf53[_0x43011c(0x34c)][_0x43011c(0x251)]>_0x2e8e59&&_0x47cf53[_0x43011c(0x34c)][_0x43011c(0x35a)](0x0,_0x47cf53[_0x43011c(0x34c)][_0x43011c(0x251)]-_0x2e8e59);await _0x47cf53[_0x43011c(0x1c7)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x43011c(0x1e0)](_0x47cf53[_0x43011c(0x34c)]),'ack':!![]});if(_0x5e64cc)await updateBaselineStatus(_0x47cf53);}async function updateAnalysisHistory(_0x18bfc8,_0x4708fe){const _0x117254=a0_0x4fc07f;_0x18bfc8[_0x117254(0x347)][_0x117254(0x201)](_0x4708fe);if(_0x18bfc8[_0x117254(0x347)]['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x18bfc8[_0x117254(0x347)][_0x117254(0x25d)]();await _0x18bfc8[_0x117254(0x1c7)](_0x117254(0x1c2),{'val':JSON['stringify'](_0x18bfc8[_0x117254(0x347)]),'ack':!![]});}async function updateBaselineStatus(_0x56fd49){const _0xe6be1a=a0_0x4fc07f;if(!_0x56fd49[_0xe6be1a(0x2d9)]){await _0x56fd49[_0xe6be1a(0x1c7)](LTM_DP_BASELINE_STATUS,{'val':_0xe6be1a(0x266),'ack':!![]});return;}const _0x47e415=_0x56fd49[_0xe6be1a(0x34c)][_0xe6be1a(0x251)]>=(_0x56fd49[_0xe6be1a(0x329)][_0xe6be1a(0x214)]||0x7)?'Aktiv\x20('+_0x56fd49[_0xe6be1a(0x34c)]['length']+'\x20Tage)':'Lernphase\x20('+_0x56fd49[_0xe6be1a(0x34c)][_0xe6be1a(0x251)]+'/'+(_0x56fd49[_0xe6be1a(0x329)][_0xe6be1a(0x214)]||0x7)+')';await _0x56fd49[_0xe6be1a(0x1c7)](LTM_DP_BASELINE_STATUS,{'val':_0x47e415,'ack':!![]});}async function initSensorSubscriptions(_0x137fac){const _0x42d5f6=a0_0x4fc07f,_0x1d1e33=_0x137fac[_0x42d5f6(0x329)][_0x42d5f6(0x326)];if(_0x1d1e33&&_0x1d1e33[_0x42d5f6(0x251)]>0x0){_0x137fac[_0x42d5f6(0x352)][_0x42d5f6(0x1cf)](_0x42d5f6(0x1a1)+_0x1d1e33[_0x42d5f6(0x251)]+'\x20sensors...');for(const _0x2a4be5 of _0x1d1e33){if(_0x2a4be5['id']){await _0x137fac[_0x42d5f6(0x36b)](_0x2a4be5['id']);try{const _0x2ea2e7=await _0x137fac[_0x42d5f6(0x2eb)](_0x2a4be5['id']);if(_0x2ea2e7)_0x137fac[_0x42d5f6(0x2bc)][_0x2a4be5['id']]=_0x2ea2e7[_0x42d5f6(0x1de)];}catch(_0x4a5a3f){}}}}}async function initPresenceSubscriptions(_0x59a6e9){const _0x21b582=a0_0x4fc07f,_0x5bc9a5=_0x59a6e9[_0x21b582(0x329)][_0x21b582(0x1f1)]||[];if(_0x5bc9a5[_0x21b582(0x251)]>0x0){_0x59a6e9[_0x21b582(0x352)][_0x21b582(0x1cf)](_0x21b582(0x1a1)+_0x5bc9a5[_0x21b582(0x251)]+'\x20presence\x20devices...');for(const _0x10014b of _0x5bc9a5){await _0x59a6e9['subscribeForeignStatesAsync'](_0x10014b);}try{await checkWifiPresence(_0x59a6e9);}catch(_0x320412){}}}async function getWeatherContext(_0x494340){const _0x593585=a0_0x4fc07f;try{if(!_0x494340[_0x593585(0x329)][_0x593585(0x353)])return _0x593585(0x1f8);let _0x36c859='';const _0x533a6d=_0x494340['config'][_0x593585(0x364)];if(_0x533a6d)try{if(_0x533a6d[_0x593585(0x31f)](_0x593585(0x1c5))){const _0x42b267=await _0x494340[_0x593585(0x2eb)](_0x533a6d+_0x593585(0x2f0));if(_0x42b267&&_0x42b267['val'])_0x36c859=_0x42b267[_0x593585(0x1de)];}else{if(_0x533a6d[_0x593585(0x31f)]('daswetter')){const _0x44c9f1=await _0x494340[_0x593585(0x2eb)](_0x533a6d+_0x593585(0x22c));if(_0x44c9f1&&_0x44c9f1['val'])_0x36c859=_0x44c9f1[_0x593585(0x1de)];}else{if(_0x533a6d[_0x593585(0x31f)]('openweathermap')){const _0x571fea=await _0x494340[_0x593585(0x2eb)](_0x533a6d+_0x593585(0x1b4));if(_0x571fea&&_0x571fea[_0x593585(0x1de)])_0x36c859=_0x571fea[_0x593585(0x1de)];}}}}catch(_0x3dbf86){}if(!_0x36c859){const _0x2b39f4=[_0x593585(0x2a7),_0x593585(0x35e),_0x593585(0x2d6),'openweathermap.0'];for(const _0x255794 of _0x2b39f4){try{const _0x2436cb=await _0x494340[_0x593585(0x368)](_0x255794);if(_0x2436cb){if(_0x255794['includes'](_0x593585(0x1c5))){const _0xa28a9c=await _0x494340['getForeignStateAsync'](_0x255794+_0x593585(0x2f0));if(_0xa28a9c&&_0xa28a9c[_0x593585(0x1de)]){_0x36c859=_0xa28a9c[_0x593585(0x1de)];break;}}}}catch(_0x438353){}}}return _0x36c859?'WETTER:\x20'+_0x36c859:_0x593585(0x2be);}catch(_0x41c956){return _0x593585(0x1f5)+_0x41c956['message'];}}async function getCalendarContext(_0x43a4be){const _0x2701ce=a0_0x4fc07f;try{if(!_0x43a4be[_0x2701ce(0x329)][_0x2701ce(0x327)])return _0x2701ce(0x23f);let _0xefc78d=_0x43a4be[_0x2701ce(0x329)]['calendarInstance']||'ical.0',_0x11f3e7=_0x43a4be[_0x2701ce(0x329)]['calendarSelection']||[];if(typeof _0x11f3e7===_0x2701ce(0x30e))_0x11f3e7=_0x11f3e7[_0x2701ce(0x348)](',');try{const _0x2e13e1=await _0x43a4be[_0x2701ce(0x2eb)](_0xefc78d+_0x2701ce(0x239));if(_0x2e13e1&&_0x2e13e1[_0x2701ce(0x1de)]){let _0x382cc4=tryParse(_0x2e13e1[_0x2701ce(0x1de)]);if(_0x382cc4&&Array[_0x2701ce(0x296)](_0x382cc4)){if(_0x11f3e7['length']>0x0)_0x382cc4=_0x382cc4['filter'](_0x1d00cf=>_0x11f3e7['includes'](_0x1d00cf[_0x2701ce(0x22e)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x382cc4['length']>0x0){const _0x3274c6=_0x382cc4[_0x2701ce(0x224)](0x0,0x3)[_0x2701ce(0x2f2)](_0x4f3fea=>{const _0x3787c1=_0x2701ce;let _0x5389a1=_0x4f3fea[_0x3787c1(0x2c9)];if(_0x4f3fea[_0x3787c1(0x273)])_0x5389a1+='\x20'+_0x4f3fea[_0x3787c1(0x273)];return _0x5389a1+':\x20'+_0x4f3fea['event']+'\x20('+_0x4f3fea[_0x3787c1(0x22e)]+')';});return _0x2701ce(0x2e4)+_0x3274c6['join']('\x20|\x20');}else return _0x2701ce(0x319);}}}catch(_0xd9f40b){_0x43a4be[_0x2701ce(0x352)][_0x2701ce(0x1e5)](_0x2701ce(0x304)+_0xd9f40b['message']);}return _0x2701ce(0x1fd);}catch(_0x1184b3){return _0x2701ce(0x332)+_0x1184b3[_0x2701ce(0x316)];}}async function getCalendarNames(_0xc740cc,_0x3805db){const _0x191b54=a0_0x4fc07f;try{const _0x4fcd14=await _0xc740cc['getForeignStateAsync'](_0x3805db+_0x191b54(0x239));if(_0x4fcd14&&_0x4fcd14[_0x191b54(0x1de)]){const _0x321663=tryParse(_0x4fcd14['val']);if(_0x321663&&Array[_0x191b54(0x296)](_0x321663)){const _0x440e70=[...new Set(_0x321663[_0x191b54(0x2f2)](_0x313a2c=>_0x313a2c[_0x191b54(0x22e)])[_0x191b54(0x202)](Boolean))];return _0x440e70['sort']();}}return[];}catch(_0x1615a4){return _0xc740cc[_0x191b54(0x352)][_0x191b54(0x29d)](_0x191b54(0x223)+_0x1615a4[_0x191b54(0x316)]),[];}}async function checkWifiPresence(_0x3a39c7){const _0x3f05d9=a0_0x4fc07f;try{const _0x297618=_0x3a39c7[_0x3f05d9(0x329)][_0x3f05d9(0x1f1)]||[];let _0x3f4956=![];const _0x554c61=[];for(const _0x48199c of _0x297618){try{const _0x2c0e86=await _0x3a39c7[_0x3f05d9(0x2eb)](_0x48199c);if(_0x2c0e86&&(_0x2c0e86['val']===!![]||_0x2c0e86[_0x3f05d9(0x1de)]===_0x3f05d9(0x1f2)||_0x2c0e86['val']===0x1)){_0x3f4956=!![];const _0x36277a=await _0x3a39c7['getForeignObjectAsync'](_0x48199c);let _0x282aab=_0x48199c;_0x36277a&&_0x36277a['common']&&_0x36277a['common'][_0x3f05d9(0x2f3)]&&(_0x282aab=typeof _0x36277a[_0x3f05d9(0x299)][_0x3f05d9(0x2f3)]===_0x3f05d9(0x33e)?_0x36277a[_0x3f05d9(0x299)]['name']['de']||_0x36277a[_0x3f05d9(0x299)][_0x3f05d9(0x2f3)]['en']:_0x36277a[_0x3f05d9(0x299)]['name']),_0x554c61[_0x3f05d9(0x258)](_0x282aab);}}catch(_0xd17f40){}}return await _0x3a39c7['setStateAsync'](_0x3f05d9(0x2ed),{'val':_0x554c61['join'](',\x20'),'ack':!![]}),_0x3f4956&&(_0x3a39c7[_0x3f05d9(0x1d0)]&&(_0x3a39c7['log'][_0x3f05d9(0x1cf)]('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),abortExitTimer(_0x3a39c7)),!_0x3a39c7[_0x3f05d9(0x2ea)]&&_0x3a39c7['currentSystemMode']===SYSTEM_MODES[_0x3f05d9(0x285)]&&await setPresence(_0x3a39c7,!![])),_0x3f4956;}catch(_0xdab334){return _0x3a39c7['log'][_0x3f05d9(0x29d)]('Error\x20checking\x20WiFi:\x20'+_0xdab334[_0x3f05d9(0x316)]),![];}}function startExitTimer(_0x20934d){const _0x4ed64c=a0_0x4fc07f;abortExitTimer(_0x20934d),_0x20934d[_0x4ed64c(0x1ad)]=!![],_0x20934d['exitGraceTimer']=setTimeout(()=>{const _0x3d4d84=_0x4ed64c;_0x20934d[_0x3d4d84(0x1ad)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x20934d['exitTimer']=setTimeout(()=>{const _0x29ccf8=_0x4ed64c;setPresence(_0x20934d,![]),_0x20934d[_0x29ccf8(0x1d0)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x1007e3){const _0x12929d=a0_0x4fc07f;if(_0x1007e3[_0x12929d(0x1d0)])clearTimeout(_0x1007e3['exitTimer']);if(_0x1007e3['exitGraceTimer'])clearTimeout(_0x1007e3['exitGraceTimer']);_0x1007e3[_0x12929d(0x1d0)]=null,_0x1007e3[_0x12929d(0x2ee)]=null,_0x1007e3[_0x12929d(0x1ad)]=![];}async function setPresence(_0x45fc17,_0x559946){const _0x3954d7=a0_0x4fc07f;if(_0x45fc17[_0x3954d7(0x2ea)]===_0x559946)return;_0x45fc17[_0x3954d7(0x2ea)]=_0x559946,await _0x45fc17[_0x3954d7(0x1c7)](_0x3954d7(0x312),{'val':_0x559946,'ack':!![]});}async function saveFeedback(_0x5cd496,_0xf90b85){const _0x21aee3=a0_0x4fc07f;_0x5cd496['log']['info'](_0x21aee3(0x309)+JSON[_0x21aee3(0x1e0)](_0xf90b85));}async function runBaselineDriftAnalysis(_0x337c64){const _0x5235c2=a0_0x4fc07f;if(!_0x337c64[_0x5235c2(0x2d9)]||!_0x337c64[_0x5235c2(0x1a4)])return;const _0x321c97=_0x337c64[_0x5235c2(0x329)][_0x5235c2(0x2b0)]||0xe;if(_0x337c64[_0x5235c2(0x34c)]['length']<_0x321c97+(_0x337c64[_0x5235c2(0x329)][_0x5235c2(0x214)]||0x7)){await _0x337c64[_0x5235c2(0x1c7)](LTM_DP_DRIFT_STATUS,{'val':_0x5235c2(0x371),'ack':!![]});return;}const _0x493868=_0x337c64[_0x5235c2(0x34c)]['slice'](-_0x321c97),_0x11df3d=_0x337c64[_0x5235c2(0x34c)]['slice'](0x0,_0x337c64[_0x5235c2(0x34c)]['length']-_0x321c97),_0x580fdf=_0x5235c2(0x2a5)+JSON[_0x5235c2(0x1e0)](_0x11df3d)+'\x0aSTB:\x20'+JSON['stringify'](_0x493868);try{const _0x5b1a9f=await _0x337c64[_0x5235c2(0x1a4)][_0x5235c2(0x318)](_0x580fdf),_0x30e403=JSON[_0x5235c2(0x29f)](_0x5b1a9f[_0x5235c2(0x278)][_0x5235c2(0x370)]()['replace'](/```json|```/g,'')['trim']());_0x30e403[_0x5235c2(0x308)]&&(await _0x337c64[_0x5235c2(0x1c7)](LTM_DP_DRIFT_STATUS,{'val':_0x30e403[_0x5235c2(0x308)],'ack':!![]}),await _0x337c64[_0x5235c2(0x1c7)](LTM_DP_DRIFT_DETAILS,{'val':_0x30e403['driftDetails'],'ack':!![]}),await _0x337c64[_0x5235c2(0x1c7)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x5235c2(0x20c)](),'ack':!![]}));}catch(_0x2b3052){}}function setupLtmScheduler(_0x3bd0fc){const _0x156a01=a0_0x4fc07f;try{if(_0x3bd0fc[_0x156a01(0x2e2)])_0x3bd0fc['ltmJob'][_0x156a01(0x32f)]();if(!_0x3bd0fc[_0x156a01(0x2d9)]){_0x3bd0fc[_0x156a01(0x1c7)](LTM_DP_STATUS,{'val':_0x156a01(0x266),'ack':!![]});return;}_0x3bd0fc[_0x156a01(0x2e2)]=schedule[_0x156a01(0x346)](LTM_SCHEDULE,()=>createDailyDigest(_0x3bd0fc));}catch(_0x591681){_0x3bd0fc['log'][_0x156a01(0x29d)](_0x156a01(0x210)+_0x591681[_0x156a01(0x316)]);}}function setupModeResetScheduler(_0x46d14b){const _0x2f5236=a0_0x4fc07f;try{if(_0x46d14b[_0x2f5236(0x2fe)])_0x46d14b[_0x2f5236(0x2fe)][_0x2f5236(0x32f)]();_0x46d14b[_0x2f5236(0x2fe)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x53eb6a=_0x2f5236;await loadSystemMode(_0x46d14b),AUTO_RESET_MODES[_0x53eb6a(0x31f)](_0x46d14b['currentSystemMode'])&&await _0x46d14b[_0x53eb6a(0x1c7)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x53eb6a(0x285)],'ack':![]});});}catch(_0x8deb65){_0x46d14b[_0x2f5236(0x352)]['error'](_0x2f5236(0x27f)+_0x8deb65['message']);}}function setupDriftAnalysisScheduler(_0xf5367f){const _0x40b0ab=a0_0x4fc07f;try{if(_0xf5367f[_0x40b0ab(0x1b5)])clearInterval(_0xf5367f[_0x40b0ab(0x1b5)]);if(!_0xf5367f[_0x40b0ab(0x2d9)])return;_0xf5367f[_0x40b0ab(0x1b5)]=setInterval(()=>runBaselineDriftAnalysis(_0xf5367f),(_0xf5367f[_0x40b0ab(0x329)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0xf5367f),0x1388);}catch(_0x47bac4){_0xf5367f[_0x40b0ab(0x352)][_0x40b0ab(0x29d)]('Drift\x20Sched\x20Error:\x20'+_0x47bac4[_0x40b0ab(0x316)]);}}function setupBriefingScheduler(_0x2214a7){const _0x5525e5=a0_0x4fc07f;try{if(_0x2214a7['briefingJob'])_0x2214a7[_0x5525e5(0x1df)][_0x5525e5(0x32f)]();if(!_0x2214a7[_0x5525e5(0x329)]['briefingEnabled'])return;const _0x41fec0=(_0x2214a7[_0x5525e5(0x329)][_0x5525e5(0x2a6)]||_0x5525e5(0x2bf))[_0x5525e5(0x348)](':'),_0x49b5a2=parseInt(_0x41fec0[0x0])||0x8,_0x445e94=parseInt(_0x41fec0[0x1])||0x0,_0x489163=_0x445e94+'\x20'+_0x49b5a2+_0x5525e5(0x28a);_0x2214a7[_0x5525e5(0x352)][_0x5525e5(0x1cf)](_0x5525e5(0x1a3)+_0x49b5a2+':'+(_0x445e94<0xa?'0'+_0x445e94:_0x445e94)),_0x2214a7[_0x5525e5(0x1df)]=schedule[_0x5525e5(0x346)](_0x489163,()=>{sendMorningBriefing(_0x2214a7);});}catch(_0x2e785b){_0x2214a7[_0x5525e5(0x352)][_0x5525e5(0x29d)](_0x5525e5(0x212)+_0x2e785b[_0x5525e5(0x316)]);}}async function sendNotification(_0x2971d0,_0x360404,_0x538d3a=![],_0x2bfeed=![]){const _0x4a2b4d=a0_0x4fc07f;_0x2971d0[_0x4a2b4d(0x352)]['info']((_0x538d3a?'[TEST]\x20':'')+_0x4a2b4d(0x2e5)+_0x360404+'\x22');const _0x364a5f=_0x2971d0[_0x4a2b4d(0x329)];let _0x351983=0x0;if(_0x364a5f[_0x4a2b4d(0x33b)]){let _0x4a8c2e={};(_0x360404[_0x4a2b4d(0x31f)](_0x4a2b4d(0x28b))||_0x2bfeed)&&(_0x4a8c2e={'reply_markup':{'inline_keyboard':[[{'text':_0x4a2b4d(0x1af),'callback_data':_0x4a2b4d(0x1ea)}],[{'text':_0x4a2b4d(0x2fc),'callback_data':_0x4a2b4d(0x1fc)}]]}}),await _0x2971d0[_0x4a2b4d(0x243)](_0x364a5f[_0x4a2b4d(0x245)],_0x4a2b4d(0x2cc),{'text':_0x360404,'user':_0x364a5f['notifyTelegramRecipient'],..._0x4a8c2e}),_0x351983++;}if(_0x364a5f['notifyPushoverEnabled']){let _0x4b5189={'message':_0x360404,'title':_0x2bfeed?_0x4a2b4d(0x2a0):_0x4a2b4d(0x1c3),'priority':_0x2bfeed?0x2:0x1,'device':_0x364a5f[_0x4a2b4d(0x1ca)]};_0x2bfeed&&(_0x4b5189['retry']=0x1e,_0x4b5189['expire']=0xe10,_0x4b5189[_0x4a2b4d(0x2aa)]=_0x4a2b4d(0x1d2)),await _0x2971d0[_0x4a2b4d(0x243)](_0x364a5f['notifyPushoverInstance'],_0x4a2b4d(0x2cc),_0x4b5189),_0x351983++;}return _0x364a5f[_0x4a2b4d(0x2bd)]&&(await _0x2971d0['sendToAsync'](_0x364a5f['notifyEmailInstance'],'send',{'text':_0x360404,'to':_0x364a5f[_0x4a2b4d(0x227)]}),_0x351983++),_0x351983;}async function setupTelegramListener(_0x36a0ad){const _0x1aa903=a0_0x4fc07f,_0x1de4b2=_0x36a0ad['config']['notifyTelegramInstance'];_0x36a0ad[_0x1aa903(0x329)][_0x1aa903(0x33b)]&&_0x1de4b2&&(_0x36a0ad[_0x1aa903(0x352)]['info'](_0x1aa903(0x1b0)+_0x1de4b2+_0x1aa903(0x306)),await _0x36a0ad[_0x1aa903(0x36b)](_0x1de4b2+_0x1aa903(0x1d1)));}async function handleTelegramResponse(_0x1b45fd,_0x2f3a67){const _0x31cf99=a0_0x4fc07f;let _0x78e9bd=_0x2f3a67;_0x2f3a67[_0x31cf99(0x254)]('[')&&(_0x78e9bd=_0x2f3a67[_0x31cf99(0x354)](_0x2f3a67[_0x31cf99(0x207)](']')+0x1));if(_0x78e9bd===_0x31cf99(0x1ea))_0x1b45fd[_0x31cf99(0x352)][_0x31cf99(0x1cf)](_0x31cf99(0x246)),await _0x1b45fd[_0x31cf99(0x1c7)](_0x31cf99(0x289),{'val':![],'ack':!![]}),await _0x1b45fd['setStateAsync'](_0x31cf99(0x261),{'val':_0x31cf99(0x22d),'ack':!![]}),_0x1b45fd[_0x31cf99(0x1cc)]=![],sendNotification(_0x1b45fd,_0x31cf99(0x2e1),![]);else _0x78e9bd===_0x31cf99(0x1fc)&&(_0x1b45fd['log'][_0x31cf99(0x1e5)](_0x31cf99(0x253)),sendNotification(_0x1b45fd,'ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]));}async function runAutopilot(_0xcbad32){const _0x4d62c3=a0_0x4fc07f,_0x2ba915=_0xcbad32[_0x4d62c3(0x329)][_0x4d62c3(0x231)],_0x3e2bea=_0xcbad32[_0x4d62c3(0x2cb)][_0x4d62c3(0x251)]>0x0?_0xcbad32[_0x4d62c3(0x2cb)][0x0][_0x4d62c3(0x2b8)]:Date[_0x4d62c3(0x20c)](),_0x241d0c=(Date[_0x4d62c3(0x20c)]()-_0x3e2bea)/(0x3e8*0x3c*0x3c);let _0x169349='';_0xcbad32[_0x4d62c3(0x329)]['inactivityMonitoringEnabled']&&_0xcbad32[_0x4d62c3(0x23b)]===SYSTEM_MODES[_0x4d62c3(0x285)]&&_0xcbad32[_0x4d62c3(0x2ea)]&&(_0x241d0c>_0x2ba915&&(_0x169349=_0x4d62c3(0x24c)+_0x241d0c[_0x4d62c3(0x2a3)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0xcbad32,_0x169349)['catch'](_0x440404=>_0xcbad32[_0x4d62c3(0x352)][_0x4d62c3(0x29d)](_0x440404));}async function createDailyDigest(_0x21a032){const _0x49e8d=a0_0x4fc07f;if(!_0x21a032[_0x49e8d(0x2d9)])return;await _0x21a032[_0x49e8d(0x1c7)](LTM_DP_STATUS,{'val':_0x49e8d(0x27d)+new Date()[_0x49e8d(0x286)](),'ack':!![]});if(!_0x21a032[_0x49e8d(0x1a4)]||_0x21a032[_0x49e8d(0x256)][_0x49e8d(0x251)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x21a032[_0x49e8d(0x1c7)](LTM_DP_STATUS,{'val':_0x49e8d(0x23e),'ack':!![]});return;}const _0x1ad3c4=JSON[_0x49e8d(0x29f)](JSON[_0x49e8d(0x1e0)](_0x21a032[_0x49e8d(0x256)])),_0x3600d5=_0x1ad3c4[_0x49e8d(0x251)],_0x5bd7a8=_0x49e8d(0x28d)+JSON[_0x49e8d(0x1e0)](_0x1ad3c4);try{const _0x11c45a=await _0x21a032[_0x49e8d(0x1a4)][_0x49e8d(0x318)](_0x5bd7a8),_0x308f4d=JSON[_0x49e8d(0x29f)](_0x11c45a[_0x49e8d(0x278)]['text']()[_0x49e8d(0x1e1)](/```json|```/g,'')[_0x49e8d(0x2ad)]());_0x308f4d[_0x49e8d(0x2c1)]&&(_0x21a032[_0x49e8d(0x34c)]['push']({'timestamp':new Date()['toISOString'](),'eventCount':_0x3600d5,'summary':_0x308f4d[_0x49e8d(0x2c1)],'activityLevel':_0x308f4d[_0x49e8d(0x26c)],'systemMode':_0x21a032['currentSystemMode']}),await saveDailyDigests(_0x21a032),_0x21a032['rawEventLog']=[],await saveRawEventLog(_0x21a032),await _0x21a032[_0x49e8d(0x1c7)](LTM_DP_STATUS,{'val':_0x49e8d(0x282)+_0x3600d5+_0x49e8d(0x34a),'ack':!![]}));}catch(_0x555645){await _0x21a032[_0x49e8d(0x1c7)](LTM_DP_STATUS,{'val':_0x49e8d(0x229)+_0x555645[_0x49e8d(0x316)],'ack':!![]});}}async function sendMorningBriefing(_0x3d53b7){const _0x19b867=a0_0x4fc07f;if(!_0x3d53b7['geminiModel'])return;_0x3d53b7[_0x19b867(0x352)][_0x19b867(0x1cf)](_0x19b867(0x2b3));const _0x4027ab=_0x3d53b7['dailyDigests']['length']>0x0?_0x3d53b7[_0x19b867(0x34c)][_0x3d53b7[_0x19b867(0x34c)][_0x19b867(0x251)]-0x1]:null,_0x498fcf=_0x4027ab&&_0x4027ab[_0x19b867(0x2df)]?_0x4027ab[_0x19b867(0x2df)][_0x19b867(0x1f0)]:_0x19b867(0x345),_0x45c922=new Date();_0x45c922[_0x19b867(0x27e)](0x4,0x0,0x0,0x0);const _0x3cb169=_0x3d53b7['eventHistory'][_0x19b867(0x202)](_0x4a4ffb=>new Date(_0x4a4ffb[_0x19b867(0x2b8)])>_0x45c922),_0x44c2e1=PERSONA_MAPPING[_0x3d53b7['config'][_0x19b867(0x34b)]||_0x19b867(0x213)],_0x2cd5ef=_0x3d53b7['config'][_0x19b867(0x1aa)]||'',_0x35923c=await getWeatherContext(_0x3d53b7),_0x28d1a5=await getCalendarContext(_0x3d53b7),_0x314d02=_0x19b867(0x1d4)+_0x44c2e1+_0x19b867(0x2fb)+_0x2cd5ef+'.\x20ZUSATZ:\x20'+_0x35923c+'\x20'+_0x28d1a5+_0x19b867(0x1b6)+_0x498fcf+_0x19b867(0x2b1)+JSON[_0x19b867(0x1e0)](_0x3cb169[_0x19b867(0x224)](0x0,0xa))+_0x19b867(0x23a);try{const _0x28cb5e=await _0x3d53b7[_0x19b867(0x1a4)][_0x19b867(0x318)](_0x314d02),_0x2b90ee=_0x19b867(0x295)+_0x28cb5e[_0x19b867(0x278)][_0x19b867(0x370)]()['trim']();sendNotification(_0x3d53b7,_0x2b90ee),_0x3d53b7[_0x19b867(0x352)][_0x19b867(0x1cf)]('Morning\x20Briefing\x20sent.');}catch(_0x1c5d06){_0x3d53b7[_0x19b867(0x352)][_0x19b867(0x29d)](_0x19b867(0x236)+_0x1c5d06[_0x19b867(0x316)]);}}async function scanForDevices(_0x5afabb,_0x543da1){const _0x3d970f=a0_0x4fc07f;_0x5afabb[_0x3d970f(0x352)][_0x3d970f(0x1cf)](_0x3d970f(0x200));const _0x26f90e=[],_0x35583c=await _0x5afabb[_0x3d970f(0x30c)]('*'),_0x5b33cc=await _0x5afabb[_0x3d970f(0x30c)](_0x3d970f(0x1d7),'enum'),_0x318fbb=await _0x5afabb[_0x3d970f(0x30c)](_0x3d970f(0x1a5),_0x3d970f(0x235)),_0x5c274e={};if(_0x5b33cc)for(const _0x46d8c5 in _0x5b33cc){const _0x498985=_0x5b33cc[_0x46d8c5][_0x3d970f(0x299)]['members']||[];_0x498985[_0x3d970f(0x360)](_0x223c0c=>{const _0x4293b4=_0x3d970f;if(!_0x5c274e[_0x223c0c])_0x5c274e[_0x223c0c]=[];_0x5c274e[_0x223c0c][_0x4293b4(0x258)](_0x46d8c5);});}const _0x25256c={};if(_0x318fbb)for(const _0x27b09f in _0x318fbb){const _0x56a523=_0x318fbb[_0x27b09f][_0x3d970f(0x299)][_0x3d970f(0x1f3)]||[],_0x315304=typeof _0x318fbb[_0x27b09f][_0x3d970f(0x299)][_0x3d970f(0x2f3)]===_0x3d970f(0x33e)?_0x318fbb[_0x27b09f][_0x3d970f(0x299)]['name']['de']:_0x318fbb[_0x27b09f][_0x3d970f(0x299)][_0x3d970f(0x2f3)];_0x56a523[_0x3d970f(0x360)](_0x51f16c=>_0x25256c[_0x51f16c]=_0x315304);}const _0x17e4f0=_0x543da1[_0x3d970f(0x1ac)]||[],_0x10a17c=_0x543da1[_0x3d970f(0x2d2)]!==![],_0x4d93ca=_0x543da1[_0x3d970f(0x20d)]!==![],_0x23ba9e=_0x543da1[_0x3d970f(0x2b5)]!==![],_0x1e8557=_0x543da1['temperature']===!![],_0x32bb1a=_0x543da1[_0x3d970f(0x2e3)]===!![];for(const _0x3c886a in _0x35583c){const _0x448494=_0x35583c[_0x3c886a];if(_0x448494['type']!==_0x3d970f(0x21e)||!_0x448494[_0x3d970f(0x299)])continue;if(ADAPTER_BLACKLIST[_0x3d970f(0x2c6)](_0xb73cdf=>_0x3c886a[_0x3d970f(0x254)](_0xb73cdf))&&!_0x32bb1a)continue;const _0x32339f=(_0x448494[_0x3d970f(0x299)][_0x3d970f(0x228)]||'')[_0x3d970f(0x2ff)]();let _0x3322d8=(typeof _0x448494[_0x3d970f(0x299)][_0x3d970f(0x2f3)]===_0x3d970f(0x33e)?_0x448494[_0x3d970f(0x299)][_0x3d970f(0x2f3)]['de']:_0x448494[_0x3d970f(0x299)][_0x3d970f(0x2f3)])||_0x3c886a;const _0x1f6478=_0x3322d8[_0x3d970f(0x2ff)]();let _0x3ddc3e=![],_0x24c215=![];if(_0x17e4f0[_0x3d970f(0x251)]>0x0){const _0x2e20a7=_0x5c274e[_0x3c886a]||[],_0xb0c9e7=_0x3c886a['split']('.')[_0x3d970f(0x224)](0x0,-0x1)[_0x3d970f(0x1cb)]('.'),_0x3d4744=_0x5c274e[_0xb0c9e7]||[];(_0x2e20a7[_0x3d970f(0x2c6)](_0x5c50af=>_0x17e4f0['includes'](_0x5c50af))||_0x3d4744[_0x3d970f(0x2c6)](_0x569469=>_0x17e4f0['includes'](_0x569469)))&&(_0x3ddc3e=!![],_0x24c215=!![]);}if(!_0x3ddc3e&&!_0x32bb1a){if(HARD_IGNORE_TERMS['some'](_0x5bd237=>_0x3c886a['includes'](_0x5bd237)||_0x1f6478['includes'](_0x5bd237[_0x3d970f(0x2ff)]())))continue;}if(BAD_NAMES[_0x3d970f(0x2c6)](_0xd8c35a=>_0x1f6478===_0xd8c35a||_0x1f6478[_0x3d970f(0x25b)]('.'+_0xd8c35a))){const _0x5df77c=_0x3c886a[_0x3d970f(0x348)]('.');if(_0x5df77c['length']>0x2){const _0x26ce90=_0x5df77c['slice'](0x0,-0x1)[_0x3d970f(0x1cb)]('.'),_0x4414b8=_0x35583c[_0x26ce90];if(_0x4414b8&&_0x4414b8['common']&&_0x4414b8[_0x3d970f(0x299)][_0x3d970f(0x2f3)]){const _0xca2ea2=typeof _0x4414b8[_0x3d970f(0x299)][_0x3d970f(0x2f3)]===_0x3d970f(0x33e)?_0x4414b8[_0x3d970f(0x299)]['name']['de']:_0x4414b8[_0x3d970f(0x299)]['name'];_0xca2ea2&&!_0x3322d8[_0x3d970f(0x31f)](_0xca2ea2)&&(_0x3322d8=_0xca2ea2+'\x20'+_0x3322d8);}}}let _0x5a8c24='';if(_0x10a17c&&(_0x32339f[_0x3d970f(0x31f)]('motion')||_0x32339f[_0x3d970f(0x31f)](_0x3d970f(0x358))||_0x1f6478[_0x3d970f(0x31f)](_0x3d970f(0x29b))||_0x1f6478['includes'](_0x3d970f(0x248))))_0x5a8c24=_0x3d970f(0x2d2);else{if(!_0x5a8c24&&_0x4d93ca&&(_0x32339f[_0x3d970f(0x31f)](_0x3d970f(0x344))||_0x32339f['includes']('window')||_0x32339f[_0x3d970f(0x31f)]('lock')||_0x32339f[_0x3d970f(0x31f)](_0x3d970f(0x26d))||_0x32339f[_0x3d970f(0x31f)](_0x3d970f(0x2d1))||_0x1f6478[_0x3d970f(0x31f)](_0x3d970f(0x2c0))||_0x1f6478[_0x3d970f(0x31f)](_0x3d970f(0x24a))||_0x1f6478[_0x3d970f(0x31f)](_0x3d970f(0x313))))_0x5a8c24=_0x3d970f(0x344);else{if(!_0x5a8c24&&_0x23ba9e&&(_0x32339f[_0x3d970f(0x31f)]('light')||_0x32339f[_0x3d970f(0x31f)](_0x3d970f(0x275))||_0x32339f[_0x3d970f(0x31f)](_0x3d970f(0x310))||_0x1f6478['includes'](_0x3d970f(0x1cd))||_0x1f6478[_0x3d970f(0x31f)](_0x3d970f(0x284))||_0x1f6478[_0x3d970f(0x31f)]('schalter'))){if(_0x448494[_0x3d970f(0x299)][_0x3d970f(0x2d8)]||_0x32339f[_0x3d970f(0x31f)]('sensor'))_0x5a8c24=_0x3d970f(0x1fe);}else{if(!_0x5a8c24&&_0x1e8557&&(_0x32339f[_0x3d970f(0x31f)]('temperature')||_0x32339f[_0x3d970f(0x31f)](_0x3d970f(0x331))||_0x32339f[_0x3d970f(0x31f)](_0x3d970f(0x24e))||_0x1f6478[_0x3d970f(0x31f)](_0x3d970f(0x2d3))||_0x1f6478['includes'](_0x3d970f(0x1c1))||_0x1f6478[_0x3d970f(0x31f)]('heizung')))_0x5a8c24=_0x3d970f(0x1eb);else{if(!_0x5a8c24&&_0x24c215)_0x5a8c24=_0x3d970f(0x26f);}}}}if(_0x5a8c24){let _0x2744e8=_0x25256c[_0x3c886a]||'';if(!_0x2744e8){let _0x3221b7=_0x3c886a;for(let _0x3afbb3=0x0;_0x3afbb3<0x3;_0x3afbb3++){const _0x424dee=_0x3221b7['lastIndexOf']('.');if(_0x424dee===-0x1)break;_0x3221b7=_0x3221b7[_0x3d970f(0x354)](0x0,_0x424dee);if(_0x25256c[_0x3221b7]){_0x2744e8=_0x25256c[_0x3221b7];break;}}}_0x26f90e['push']({'id':_0x3c886a,'name':_0x3322d8,'location':_0x2744e8,'type':_0x5a8c24,'logDuplicates':_0x5a8c24==='motion','isExit':![],'_score':_0x2744e8?0x50:_0x5a8c24===_0x3d970f(0x26f)?0x5a:0x28});}}return _0x26f90e['sort']((_0x56f0e5,_0x130449)=>_0x130449['_score']-_0x56f0e5[_0x3d970f(0x362)]),_0x26f90e;}async function executeAutomationAction(_0x89c6a9){const _0x5e4f30=a0_0x4fc07f;try{const _0x115ec3=await _0x89c6a9[_0x5e4f30(0x204)](_0x5e4f30(0x298)),_0x2abb7f=await _0x89c6a9[_0x5e4f30(0x204)](_0x5e4f30(0x35c));if(_0x115ec3&&_0x115ec3[_0x5e4f30(0x1de)]&&_0x2abb7f){const _0x2de894=_0x115ec3[_0x5e4f30(0x1de)];let _0x3ce124=_0x2abb7f[_0x5e4f30(0x1de)];try{_0x3ce124=JSON[_0x5e4f30(0x29f)](_0x3ce124);}catch(_0x3606b7){}_0x89c6a9[_0x5e4f30(0x352)][_0x5e4f30(0x1cf)](_0x5e4f30(0x21a)+_0x2de894+_0x5e4f30(0x26a)+_0x3ce124),await _0x89c6a9[_0x5e4f30(0x1dd)](_0x2de894,_0x3ce124);}else _0x89c6a9[_0x5e4f30(0x352)][_0x5e4f30(0x1e5)](_0x5e4f30(0x283));}catch(_0x3f9e36){_0x89c6a9[_0x5e4f30(0x352)]['error']('BUTLER\x20Execution\x20Error:\x20'+_0x3f9e36[_0x5e4f30(0x316)]);}}function tryParse(_0x3c0733){const _0x4ae07a=a0_0x4fc07f;try{return JSON[_0x4ae07a(0x29f)](_0x3c0733);}catch(_0xdc302d){return null;}}async function processSensorEvent(_0x1675cf,_0x101803,_0xe1b4ae,_0x5790d5){const _0x48b40f=a0_0x4fc07f;if(!_0x5790d5)return;const _0x1955fc=_0xe1b4ae[_0x48b40f(0x1de)],_0x5a375f=Date[_0x48b40f(0x20c)]();_0x1675cf[_0x48b40f(0x352)][_0x48b40f(0x1ff)](_0x48b40f(0x33a)+_0x101803+'\x20=\x20'+_0x1955fc),_0x1675cf['sensorLastValues'][_0x101803]=_0x1955fc;if(!_0x5790d5[_0x48b40f(0x20e)]&&_0x1675cf[_0x48b40f(0x2cb)]&&_0x1675cf[_0x48b40f(0x2cb)]['length']>0x0){const _0x1cbf41=_0x1675cf[_0x48b40f(0x2cb)][0x0];if(_0x1cbf41['id']===_0x101803&&_0x1cbf41['value']==_0x1955fc){_0x1675cf[_0x48b40f(0x352)]['debug'](_0x48b40f(0x303)+_0x5790d5['name']+_0x48b40f(0x293)+_0x1955fc+')');return;}}const _0x1fa841={'timestamp':_0x5a375f,'id':_0x101803,'name':_0x5790d5[_0x48b40f(0x2f3)],'type':_0x5790d5[_0x48b40f(0x1b1)],'location':_0x5790d5[_0x48b40f(0x1c9)],'value':_0x1955fc};_0x1675cf[_0x48b40f(0x2cb)][_0x48b40f(0x201)](_0x1fa841);if(_0x1675cf[_0x48b40f(0x2cb)][_0x48b40f(0x251)]>HISTORY_MAX_SIZE)_0x1675cf[_0x48b40f(0x2cb)][_0x48b40f(0x25d)]();await _0x1675cf[_0x48b40f(0x1c7)](_0x48b40f(0x350),{'val':JSON['stringify'](_0x1fa841),'ack':!![]}),await _0x1675cf['setStateAsync'](_0x48b40f(0x1fa),{'val':JSON['stringify'](_0x1675cf[_0x48b40f(0x2cb)]),'ack':!![]});_0x1675cf[_0x48b40f(0x2d9)]&&(_0x1675cf[_0x48b40f(0x256)][_0x48b40f(0x258)](_0x1fa841),await saveRawEventLog(_0x1675cf));if(_0x5790d5[_0x48b40f(0x1e9)]&&_0x1955fc===!![]){if(_0x1675cf[_0x48b40f(0x2ea)]&&!_0x1675cf[_0x48b40f(0x1ad)])_0x1675cf['log'][_0x48b40f(0x1cf)]('Exit\x20Sensor\x20triggered\x20('+_0x5790d5[_0x48b40f(0x2f3)]+').\x20Starting\x20Timer.'),startExitTimer(_0x1675cf);else!_0x1675cf['isPresent']&&(_0x1675cf['log'][_0x48b40f(0x1cf)]('Entry\x20detected\x20via\x20'+_0x5790d5[_0x48b40f(0x2f3)]+_0x48b40f(0x203)),await setPresence(_0x1675cf,!![]));}else _0x5790d5[_0x48b40f(0x1b1)]==='motion'&&_0x1955fc===!![]&&(_0x1675cf[_0x48b40f(0x1d0)]&&(_0x1675cf[_0x48b40f(0x352)][_0x48b40f(0x1cf)](_0x48b40f(0x2c3)),abortExitTimer(_0x1675cf)),!_0x1675cf[_0x48b40f(0x2ea)]&&_0x1675cf[_0x48b40f(0x23b)]===SYSTEM_MODES[_0x48b40f(0x285)]&&await setPresence(_0x1675cf,!![]));}async function runGeminiAnalysis(_0x130127,_0x39b920=''){const _0x353dd4=a0_0x4fc07f;if(!_0x130127[_0x353dd4(0x1a4)])return;if(_0x130127['eventHistory'][_0x353dd4(0x251)]===0x0)return;const _0x214413=_0x130127[_0x353dd4(0x2cb)]['slice'](0x0,0xf),_0x272ce8=await getWeatherContext(_0x130127),_0x2d9050=_0x130127[_0x353dd4(0x23b)],_0x297bb3=PERSONA_MAPPING[_0x130127[_0x353dd4(0x329)][_0x353dd4(0x34b)]||_0x353dd4(0x213)],_0x29faca=_0x130127[_0x353dd4(0x329)]['livingContext']||_0x353dd4(0x1b2);let _0x181882=![];try{const _0x4c9d=await _0x130127[_0x353dd4(0x204)](_0x353dd4(0x2c7));if(_0x4c9d&&_0x4c9d['val'])_0x181882=!![];}catch(_0x337333){}const _0x120a5b=_0x353dd4(0x2f6)+_0x297bb3+'.\x0a\x20\x20\x20\x20KONTEXT:\x20'+_0x29faca+_0x353dd4(0x301)+_0x2d9050+_0x353dd4(0x34e)+_0x272ce8+'.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20'+(_0x39b920||_0x353dd4(0x36e))+_0x353dd4(0x271)+JSON[_0x353dd4(0x1e0)](_0x214413)+_0x353dd4(0x1dc);try{const _0x4c4470=await _0x130127[_0x353dd4(0x1a4)][_0x353dd4(0x318)](_0x120a5b),_0x3bf79d=_0x4c4470[_0x353dd4(0x278)]['text']()[_0x353dd4(0x1e1)](/```json|```/g,'')[_0x353dd4(0x2ad)](),_0x5875a4=JSON[_0x353dd4(0x29f)](_0x3bf79d);await _0x130127[_0x353dd4(0x1c7)]('analysis.lastResult',{'val':JSON[_0x353dd4(0x1e0)](_0x5875a4),'ack':!![]});const _0x210710=_0x5875a4[_0x353dd4(0x237)]||![];_0x210710!==_0x130127[_0x353dd4(0x1cc)]&&(await _0x130127['setStateAsync'](_0x353dd4(0x289),{'val':_0x210710,'ack':!![]}),_0x130127[_0x353dd4(0x1cc)]=_0x210710,_0x210710&&(await _0x130127[_0x353dd4(0x1c7)](_0x353dd4(0x261),{'val':_0x5875a4[_0x353dd4(0x2d7)],'ack':!![]}),sendNotification(_0x130127,_0x353dd4(0x23d)+_0x5875a4[_0x353dd4(0x2d7)],![],_0x5875a4[_0x353dd4(0x2da)]))),_0x5875a4[_0x353dd4(0x265)]&&_0x5875a4['automationProposal'][_0x353dd4(0x211)]&&_0x5875a4[_0x353dd4(0x265)][_0x353dd4(0x2ec)]&&(_0x130127['log'][_0x353dd4(0x1cf)](_0x353dd4(0x36c)+_0x5875a4[_0x353dd4(0x265)][_0x353dd4(0x300)]),await _0x130127[_0x353dd4(0x1c7)](_0x353dd4(0x1b3),{'val':!![],'ack':!![]}),await _0x130127[_0x353dd4(0x1c7)](_0x353dd4(0x29a),{'val':_0x5875a4['automationProposal']['description'],'ack':!![]}),await _0x130127[_0x353dd4(0x1c7)](_0x353dd4(0x298),{'val':_0x5875a4['automationProposal'][_0x353dd4(0x2ec)],'ack':!![]}),await _0x130127[_0x353dd4(0x1c7)](_0x353dd4(0x35c),{'val':JSON['stringify'](_0x5875a4['automationProposal']['targetValue']),'ack':!![]}),_0x181882&&(_0x130127[_0x353dd4(0x352)][_0x353dd4(0x1cf)](_0x353dd4(0x1d5)+_0x5875a4['automationProposal']['targetId']+_0x353dd4(0x323)),await executeAutomationAction(_0x130127)));}catch(_0x1335d4){_0x130127[_0x353dd4(0x352)][_0x353dd4(0x29d)](_0x353dd4(0x24b)+_0x1335d4['message']);}}function installPythonDependencies(_0x3e569b){const _0x3cafb3=a0_0x4fc07f;if(_0x3e569b[_0x3cafb3(0x1ed)])return;_0x3e569b['dependencyInstallInProgress']=!![];const _0x595c1a=path[_0x3cafb3(0x1cb)](__dirname,_0x3cafb3(0x36d),'requirements.txt');_0x3e569b[_0x3cafb3(0x352)][_0x3cafb3(0x1cf)](_0x3cafb3(0x334)+_0x595c1a+_0x3cafb3(0x323)),stopPythonService(_0x3e569b);const _0x59a8de=_0x3cafb3(0x1f9)+_0x595c1a+_0x3cafb3(0x2fa);exec(_0x59a8de,(_0x2b7efd,_0x45b136,_0x3e2d36)=>{const _0x1f1ec7=_0x3cafb3;_0x3e569b[_0x1f1ec7(0x1ed)]=![],_0x2b7efd?(_0x3e569b['log'][_0x1f1ec7(0x29d)]('âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x59a8de),_0x3e569b[_0x1f1ec7(0x352)][_0x1f1ec7(0x29d)](_0x1f1ec7(0x33f)+(_0x3e2d36||_0x2b7efd[_0x1f1ec7(0x316)]))):(_0x3e569b[_0x1f1ec7(0x352)][_0x1f1ec7(0x1cf)](_0x1f1ec7(0x30f)),startPythonService(_0x3e569b));});}function startPythonService(_0x487412){const _0x25c791=a0_0x4fc07f;try{const _0x149053=path[_0x25c791(0x1cb)](__dirname,_0x25c791(0x36d),_0x25c791(0x315));_0x487412[_0x25c791(0x352)][_0x25c791(0x1cf)](_0x25c791(0x2b4)+_0x149053),_0x487412[_0x25c791(0x1db)]=spawn('python3',[_0x149053]),_0x487412[_0x25c791(0x1db)][_0x25c791(0x2e7)]['on'](_0x25c791(0x330),_0x198bef=>{const _0x33be39=_0x25c791,_0x5d05a9=_0x198bef['toString']()[_0x33be39(0x2ad)]();_0x487412['log'][_0x33be39(0x1ff)](_0x33be39(0x1fb)+_0x5d05a9),(_0x5d05a9[_0x33be39(0x31f)](_0x33be39(0x1d6))||_0x5d05a9[_0x33be39(0x31f)]('Bibliotheken\x20nicht\x20gefunden'))&&(_0x487412[_0x33be39(0x352)][_0x33be39(0x1e5)](_0x33be39(0x249)),installPythonDependencies(_0x487412));}),_0x487412[_0x25c791(0x1db)]['stderr']['on'](_0x25c791(0x330),_0x26d68=>{const _0x4f0254=_0x25c791,_0x128805=_0x26d68[_0x4f0254(0x35f)]()['trim']();_0x487412['log'][_0x4f0254(0x29d)]('[PYTHON\x20ERR]\x20'+_0x128805);}),_0x487412[_0x25c791(0x1db)]['on']('close',_0x4495eb=>{const _0x22d637=_0x25c791;_0x487412['log'][_0x22d637(0x1cf)]('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x4495eb),_0x487412[_0x22d637(0x1db)]=null;}),_0x487412[_0x25c791(0x1db)]['on'](_0x25c791(0x29d),_0x7e4e3c=>{const _0x74d2a5=_0x25c791;_0x487412[_0x74d2a5(0x352)][_0x74d2a5(0x1e5)](_0x74d2a5(0x1a0)+_0x7e4e3c['message']);});}catch(_0x3cc816){_0x487412[_0x25c791(0x352)][_0x25c791(0x29d)]('Error\x20launching\x20Python\x20service:\x20'+_0x3cc816[_0x25c791(0x316)]);}}function stopPythonService(_0x34b71a){const _0x457ac6=a0_0x4fc07f;if(_0x34b71a['pythonProcess']){_0x34b71a[_0x457ac6(0x352)]['info'](_0x457ac6(0x2c2));try{_0x34b71a[_0x457ac6(0x1db)][_0x457ac6(0x1b9)]();}catch(_0x52e53e){_0x34b71a[_0x457ac6(0x352)][_0x457ac6(0x1e5)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x52e53e[_0x457ac6(0x316)]);}_0x34b71a[_0x457ac6(0x1db)]=null;}}class CogniLiving extends utils[a0_0x4fc07f(0x351)]{constructor(_0x176bcf){const _0x5c39b2=a0_0x4fc07f;super({..._0x176bcf,'name':'cogni-living'}),this['eventHistory']=[],this[_0x5c39b2(0x347)]=[],this[_0x5c39b2(0x336)]=[],this[_0x5c39b2(0x256)]=[],this[_0x5c39b2(0x34c)]=[],this[_0x5c39b2(0x2bc)]={},this[_0x5c39b2(0x2cf)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x5c39b2(0x2ea)]=!![],this[_0x5c39b2(0x1d0)]=null,this[_0x5c39b2(0x2ee)]=null,this[_0x5c39b2(0x1ad)]=![],this[_0x5c39b2(0x2a2)]=null,this[_0x5c39b2(0x1a4)]=null,this['currentSystemMode']=SYSTEM_MODES['NORMAL'],this[_0x5c39b2(0x2d9)]=![],this['lastAlertState']=![],this[_0x5c39b2(0x321)]=_0x5c39b2(0x262),this[_0x5c39b2(0x1bb)]=null,this[_0x5c39b2(0x2e2)]=null,this[_0x5c39b2(0x2fe)]=null,this[_0x5c39b2(0x1b5)]=null,this['briefingJob']=null,this[_0x5c39b2(0x1db)]=null,this[_0x5c39b2(0x1ed)]=![],this['on']('ready',this[_0x5c39b2(0x218)][_0x5c39b2(0x250)](this)),this['on'](_0x5c39b2(0x31e),this[_0x5c39b2(0x324)][_0x5c39b2(0x250)](this)),this['on'](_0x5c39b2(0x219),this[_0x5c39b2(0x1ec)][_0x5c39b2(0x250)](this)),this['on'](_0x5c39b2(0x316),this[_0x5c39b2(0x294)]['bind'](this));}async[a0_0x4fc07f(0x218)](){const _0xd1787d=a0_0x4fc07f;this['log']['info'](_0xd1787d(0x21f)+this[_0xd1787d(0x2ce)]+')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE'),await initZombies(this),this[_0xd1787d(0x329)][_0xd1787d(0x26e)]=this[_0xd1787d(0x329)][_0xd1787d(0x26e)]||'';try{this[_0xd1787d(0x2d9)]=await checkLicense(this,this[_0xd1787d(0x329)][_0xd1787d(0x26e)]);}catch(_0x2d6107){}if(!this[_0xd1787d(0x329)][_0xd1787d(0x231)]||this['config'][_0xd1787d(0x231)]<0.1)this['config']['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0xd1787d(0x329)][_0xd1787d(0x209)])try{this[_0xd1787d(0x2a2)]=new GoogleGenerativeAI(this[_0xd1787d(0x329)][_0xd1787d(0x209)]),this[_0xd1787d(0x1a4)]=this[_0xd1787d(0x2a2)][_0xd1787d(0x1f4)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xd1787d(0x355)}}),this[_0xd1787d(0x352)][_0xd1787d(0x1cf)]('Gemini\x20AI\x20initialized.');}catch(_0x1a6fa6){this[_0xd1787d(0x352)]['error']('Gemini\x20Init\x20Error:\x20'+_0x1a6fa6[_0xd1787d(0x316)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0xd1787d(0x220)]('analysis.trigger'),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0xd1787d(0x220)]('system.mode'),this[_0xd1787d(0x220)](_0xd1787d(0x2b9)),this['subscribeStates'](_0xd1787d(0x34d)),this['subscribeStates']('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0xd1787d(0x1bb)])clearInterval(this[_0xd1787d(0x1bb)]);const _0xad434d=this[_0xd1787d(0x329)][_0xd1787d(0x1a9)]||0xf;_0xad434d>0x0&&(this[_0xd1787d(0x352)]['info'](_0xd1787d(0x1b8)+_0xad434d+_0xd1787d(0x2d5)),this[_0xd1787d(0x1bb)]=setInterval(()=>{runAutopilot(this);},_0xad434d*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this);}[a0_0x4fc07f(0x1ec)](_0xee4f83){const _0x15d917=a0_0x4fc07f;if(this[_0x15d917(0x1bb)])clearInterval(this['analysisTimer']);if(this[_0x15d917(0x1b5)])clearInterval(this[_0x15d917(0x1b5)]);if(this[_0x15d917(0x2e2)])this[_0x15d917(0x2e2)][_0x15d917(0x32f)]();if(this[_0x15d917(0x2fe)])this[_0x15d917(0x2fe)][_0x15d917(0x32f)]();if(this[_0x15d917(0x1df)])this[_0x15d917(0x1df)][_0x15d917(0x32f)]();if(this[_0x15d917(0x1d0)])clearTimeout(this[_0x15d917(0x1d0)]);if(this[_0x15d917(0x2ee)])clearTimeout(this[_0x15d917(0x2ee)]);stopPythonService(this),_0xee4f83();}async['onStateChange'](_0x1f1eba,_0x82c592){const _0x12af79=a0_0x4fc07f;if(!_0x82c592)return;if(_0x1f1eba[_0x12af79(0x31f)]('telegram')&&_0x1f1eba[_0x12af79(0x25b)](_0x12af79(0x247))&&_0x82c592['val']){await handleTelegramResponse(this,_0x82c592[_0x12af79(0x1de)]);return;}if(_0x1f1eba===this[_0x12af79(0x29e)]+'.'+SYSTEM_DP_MODE){_0x82c592[_0x12af79(0x1de)]&&Object[_0x12af79(0x230)](SYSTEM_MODES)[_0x12af79(0x31f)](_0x82c592['val'])&&(this[_0x12af79(0x23b)]=_0x82c592[_0x12af79(0x1de)],_0x82c592[_0x12af79(0x1de)]===SYSTEM_MODES[_0x12af79(0x30b)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x82c592[_0x12af79(0x1a2)])this['setState'](_0x1f1eba,{'val':this[_0x12af79(0x23b)],'ack':!![]});return;}if(!_0x82c592['ack']){_0x1f1eba[_0x12af79(0x31f)](_0x12af79(0x343))&&_0x82c592[_0x12af79(0x1de)]&&(this[_0x12af79(0x2f5)](_0x1f1eba,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x1f1eba[_0x12af79(0x31f)](_0x12af79(0x2c5))&&_0x82c592['val']){this[_0x12af79(0x2f5)](_0x1f1eba,{'val':![],'ack':!![]});if(this[_0x12af79(0x2d9)])createDailyDigest(this);}_0x1f1eba[_0x12af79(0x31f)](_0x12af79(0x2a4))&&_0x82c592[_0x12af79(0x1de)]&&(this['setState'](_0x1f1eba,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x1f1eba[_0x12af79(0x31f)](_0x12af79(0x226))&&_0x82c592['val']&&(this[_0x12af79(0x2f5)](_0x1f1eba,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x12af79(0x329)][_0x12af79(0x1f1)]&&this[_0x12af79(0x329)][_0x12af79(0x1f1)][_0x12af79(0x31f)](_0x1f1eba)){await checkWifiPresence(this);return;}const _0x397145=(this[_0x12af79(0x329)][_0x12af79(0x326)]||[])[_0x12af79(0x2ca)](_0x1fd2c3=>_0x1fd2c3['id']===_0x1f1eba);if(_0x397145)processSensorEvent(this,_0x1f1eba,_0x82c592,_0x397145);}async['onMessage'](_0x5d2a8a){const _0xc45a68=a0_0x4fc07f;if(typeof _0x5d2a8a===_0xc45a68(0x33e)&&_0x5d2a8a['message'])try{if(_0x5d2a8a[_0xc45a68(0x31d)]===_0xc45a68(0x361)){}else{if(_0x5d2a8a[_0xc45a68(0x31d)]==='testNotification'){}else{if(_0x5d2a8a[_0xc45a68(0x31d)]===_0xc45a68(0x335)){if(!this[_0xc45a68(0x2d9)])return this[_0xc45a68(0x24f)](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':![],'isPro':![]},_0x5d2a8a['callback']);let _0x39b107={'status':_0xc45a68(0x345),'details':'','lastCheck':0x0};try{_0x39b107[_0xc45a68(0x1bf)]=(await this[_0xc45a68(0x204)](LTM_DP_DRIFT_STATUS))[_0xc45a68(0x1de)],_0x39b107[_0xc45a68(0x257)]=(await this[_0xc45a68(0x204)](LTM_DP_DRIFT_DETAILS))[_0xc45a68(0x1de)],_0x39b107[_0xc45a68(0x32e)]=(await this[_0xc45a68(0x204)](LTM_DP_DRIFT_LAST_CHECK))[_0xc45a68(0x1de)];}catch(_0x248647){}const _0x538c18=this['analysisHistory']||[];this[_0xc45a68(0x24f)](_0x5d2a8a['from'],_0x5d2a8a[_0xc45a68(0x31d)],{'success':!![],'isPro':!![],'dailyDigests':this[_0xc45a68(0x34c)],'driftAnalysis':_0x39b107,'analysisHistory':_0x538c18},_0x5d2a8a[_0xc45a68(0x2db)]);}else{if(_0x5d2a8a[_0xc45a68(0x31d)]==='getOverviewData'){const _0x1fbb51=this[_0xc45a68(0x34c)][_0xc45a68(0x251)],_0x4861d9=new Date(),_0x992ac7=new Date(_0x4861d9[_0xc45a68(0x1c6)](),_0x4861d9[_0xc45a68(0x34f)](),_0x4861d9[_0xc45a68(0x2e9)]())[_0xc45a68(0x25a)](),_0x378656=this[_0xc45a68(0x256)][_0xc45a68(0x202)](_0x5c766f=>new Date(_0x5c766f['timestamp'])[_0xc45a68(0x25a)]()>_0x992ac7)['length'],_0x557b63=new Array(0x18)[_0xc45a68(0x25c)](0x0);this[_0xc45a68(0x256)][_0xc45a68(0x360)](_0x449499=>{const _0x48f5f9=_0xc45a68,_0x45c065=new Date(_0x449499[_0x48f5f9(0x2b8)]);if(_0x45c065[_0x48f5f9(0x25a)]()>_0x992ac7)_0x557b63[_0x45c065[_0x48f5f9(0x1d3)]()]++;});let _0x292110={'status':_0xc45a68(0x345)};try{_0x292110[_0xc45a68(0x1bf)]=(await this[_0xc45a68(0x204)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x4d70ac){}let _0x5ea028='';try{const _0x4eb616=await this[_0xc45a68(0x204)](_0xc45a68(0x2ed));_0x5ea028=_0x4eb616?_0x4eb616[_0xc45a68(0x1de)]:'';}catch(_0x3c8768){}let _0x56037d=null;!this[_0xc45a68(0x1a4)]&&(_0x56037d=this[_0xc45a68(0x329)][_0xc45a68(0x209)]?'KI-Modell\x20nicht\x20initialisiert':_0xc45a68(0x1e8));let _0x45f6cb={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x51b1c3=await this[_0xc45a68(0x204)]('analysis.automation.patternDetected'),_0x3929e1=await this[_0xc45a68(0x204)](_0xc45a68(0x29a)),_0xb7e1f7=await this[_0xc45a68(0x204)](_0xc45a68(0x298)),_0x50d158=await this['getStateAsync'](_0xc45a68(0x35c)),_0x2f9a1f=await this[_0xc45a68(0x204)]('analysis.automation.autoApply');_0x51b1c3&&_0x51b1c3[_0xc45a68(0x1de)]&&(_0x45f6cb[_0xc45a68(0x211)]=!![],_0x45f6cb[_0xc45a68(0x300)]=_0x3929e1?_0x3929e1[_0xc45a68(0x1de)]:'',_0x45f6cb[_0xc45a68(0x2ec)]=_0xb7e1f7?_0xb7e1f7['val']:'',_0x45f6cb[_0xc45a68(0x35d)]=_0x50d158?_0x50d158[_0xc45a68(0x1de)]:''),_0x45f6cb[_0xc45a68(0x1f6)]=_0x2f9a1f?!!_0x2f9a1f[_0xc45a68(0x1de)]:![];}catch(_0x534669){}this[_0xc45a68(0x24f)](_0x5d2a8a['from'],_0x5d2a8a['command'],{'success':!![],'eventHistory':this['eventHistory'][_0xc45a68(0x224)](0x0,0xf),'stats':{'digestCount':_0x1fbb51,'eventCountToday':_0x378656,'hourlyActivity':_0x557b63,'driftStatus':_0x292110[_0xc45a68(0x1bf)],'isPresent':this['isPresent'],'presenceWho':_0x5ea028,'minDays':this[_0xc45a68(0x329)][_0xc45a68(0x214)]||0x7,'stbDays':this[_0xc45a68(0x329)][_0xc45a68(0x2b0)]||0xe,'ltbDays':this[_0xc45a68(0x329)][_0xc45a68(0x2e8)]||0x3c,'systemError':_0x56037d},'automation':_0x45f6cb},_0x5d2a8a['callback']);}else{if(_0x5d2a8a[_0xc45a68(0x31d)]===_0xc45a68(0x366)){const _0x5ddbc9=await this[_0xc45a68(0x30c)](_0xc45a68(0x1d7),'enum'),_0x21c634=[];if(_0x5ddbc9)for(const _0x4d4dfa in _0x5ddbc9){const _0x5605d6=_0x5ddbc9[_0x4d4dfa],_0x25a092=(_0x5605d6[_0xc45a68(0x299)]&&typeof _0x5605d6[_0xc45a68(0x299)]['name']===_0xc45a68(0x33e)?_0x5605d6[_0xc45a68(0x299)][_0xc45a68(0x2f3)]['de']:_0x5605d6['common'][_0xc45a68(0x2f3)])||_0x5605d6[_0xc45a68(0x299)][_0xc45a68(0x2f3)];_0x21c634[_0xc45a68(0x258)]({'id':_0x4d4dfa,'name':_0x25a092});}this[_0xc45a68(0x24f)](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':!![],'enums':_0x21c634},_0x5d2a8a[_0xc45a68(0x2db)]);}else{if(_0x5d2a8a[_0xc45a68(0x31d)]===_0xc45a68(0x328))try{const _0x6d0722=await scanForDevices(this,_0x5d2a8a['message']||{});this[_0xc45a68(0x24f)](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':!![],'devices':_0x6d0722},_0x5d2a8a[_0xc45a68(0x2db)]);}catch(_0x858878){this[_0xc45a68(0x24f)](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a['command'],{'success':![],'error':_0x858878[_0xc45a68(0x316)]},_0x5d2a8a[_0xc45a68(0x2db)]);}else{if(_0x5d2a8a[_0xc45a68(0x31d)]===_0xc45a68(0x22f)){const _0x25e9a8=_0x5d2a8a[_0xc45a68(0x316)][_0xc45a68(0x26b)];if(!_0x25e9a8)return this['sendTo'](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':![],'error':_0xc45a68(0x2f9)},_0x5d2a8a[_0xc45a68(0x2db)]);const _0x9f680d=await getCalendarNames(this,_0x25e9a8);this[_0xc45a68(0x24f)](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':!![],'names':_0x9f680d},_0x5d2a8a[_0xc45a68(0x2db)]);}else{if(_0x5d2a8a['command']===_0xc45a68(0x2d0)){const {targetId:_0xb5335,targetValue:_0x31068a}=_0x5d2a8a['message'];this[_0xc45a68(0x352)][_0xc45a68(0x1cf)]('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0xb5335+_0xc45a68(0x26a)+_0x31068a),await this[_0xc45a68(0x1c7)](_0xc45a68(0x1b3),{'val':!![],'ack':!![]}),await this[_0xc45a68(0x1c7)]('analysis.automation.description',{'val':'SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20'+_0xb5335,'ack':!![]}),await this[_0xc45a68(0x1c7)](_0xc45a68(0x298),{'val':_0xb5335,'ack':!![]}),await this[_0xc45a68(0x1c7)](_0xc45a68(0x35c),{'val':_0x31068a,'ack':!![]}),this[_0xc45a68(0x24f)](_0x5d2a8a['from'],_0x5d2a8a['command'],{'success':!![]},_0x5d2a8a[_0xc45a68(0x2db)]);}else{if(_0x5d2a8a[_0xc45a68(0x31d)]===_0xc45a68(0x277)){const {historyId:_0x14d889,rating:_0x4edd5d,comment:_0x37412e,alertReason:_0x198a61}=_0x5d2a8a[_0xc45a68(0x316)];_0x14d889&&_0x4edd5d?(await saveFeedback(this,{'timestamp':Date[_0xc45a68(0x20c)](),'historyId':_0x14d889,'rating':_0x4edd5d,'comment':_0x37412e,'alertReason':_0x198a61}),this['sendTo'](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':!![]},_0x5d2a8a[_0xc45a68(0x2db)])):this[_0xc45a68(0x24f)](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':![],'error':'Missing\x20data'},_0x5d2a8a[_0xc45a68(0x2db)]);}else _0x5d2a8a[_0xc45a68(0x31d)]===_0xc45a68(0x217)&&(this['log'][_0xc45a68(0x1cf)](_0xc45a68(0x302)),await this['setStateAsync'](_0xc45a68(0x1b3),{'val':![],'ack':!![]}),await this[_0xc45a68(0x1c7)](_0xc45a68(0x29a),{'val':'','ack':!![]}),this[_0xc45a68(0x24f)](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':!![]},_0x5d2a8a[_0xc45a68(0x2db)]));}}}}}}}}}catch(_0x30cce2){this[_0xc45a68(0x352)][_0xc45a68(0x29d)]('Error\x20in\x20onMessage\x20command\x20'+_0x5d2a8a[_0xc45a68(0x31d)]+':\x20'+_0x30cce2[_0xc45a68(0x316)]);if(_0x5d2a8a[_0xc45a68(0x2db)])this[_0xc45a68(0x24f)](_0x5d2a8a[_0xc45a68(0x2af)],_0x5d2a8a[_0xc45a68(0x31d)],{'success':![],'error':_0x30cce2[_0xc45a68(0x316)]},_0x5d2a8a[_0xc45a68(0x2db)]);}}}if(require['main']!==module)module[a0_0x4fc07f(0x280)]=_0x3ac1a1=>new CogniLiving(_0x3ac1a1);else new CogniLiving();