const a0_0x5ce4da=a0_0x1632;(function(_0x3f354d,_0x25bd53){const _0x5e0182=a0_0x1632,_0x3a3659=_0x3f354d();while(!![]){try{const _0x273caf=parseInt(_0x5e0182(0x158))/0x1*(parseInt(_0x5e0182(0x27a))/0x2)+-parseInt(_0x5e0182(0xe6))/0x3*(-parseInt(_0x5e0182(0x1e1))/0x4)+parseInt(_0x5e0182(0xfa))/0x5+-parseInt(_0x5e0182(0x21e))/0x6+-parseInt(_0x5e0182(0xd3))/0x7+-parseInt(_0x5e0182(0xdc))/0x8*(-parseInt(_0x5e0182(0x10d))/0x9)+parseInt(_0x5e0182(0x29a))/0xa*(-parseInt(_0x5e0182(0xd4))/0xb);if(_0x273caf===_0x25bd53)break;else _0x3a3659['push'](_0x3a3659['shift']());}catch(_0x255777){_0x3a3659['push'](_0x3a3659['shift']());}}}(a0_0x48dc,0x704e8));const a0_0x37164c=(function(){let _0x498617=!![];return function(_0x29bbbd,_0x2001d0){const _0x4ef7e9=_0x498617?function(){const _0x5279b1=a0_0x1632;if(_0x2001d0){const _0x32687b=_0x2001d0[_0x5279b1(0x14f)](_0x29bbbd,arguments);return _0x2001d0=null,_0x32687b;}}:function(){};return _0x498617=![],_0x4ef7e9;};}()),a0_0x268c95=a0_0x37164c(this,function(){const _0x48b651=a0_0x1632;return a0_0x268c95[_0x48b651(0xb4)]()[_0x48b651(0x1e2)](_0x48b651(0x1fc))[_0x48b651(0xb4)]()['constructor'](a0_0x268c95)[_0x48b651(0x1e2)](_0x48b651(0x1fc));});a0_0x268c95();'use strict';const utils=require(a0_0x5ce4da(0x1fb)),{GoogleGenerativeAI}=require(a0_0x5ce4da(0x174)),schedule=require(a0_0x5ce4da(0x10e)),{spawn,exec}=require('child_process'),path=require(a0_0x5ce4da(0x18b)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x5ce4da(0x12a),LTM_SCHEDULE=a0_0x5ce4da(0x291),MODE_RESET_SCHEDULE=a0_0x5ce4da(0x189),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x5ce4da(0x1b9),LTM_DP_DAILY_DIGESTS=a0_0x5ce4da(0x206),LTM_DP_STATUS=a0_0x5ce4da(0x1eb),LTM_DP_TRIGGER_DIGEST=a0_0x5ce4da(0x11b),LTM_DP_BASELINE_STATUS=a0_0x5ce4da(0x13f),LTM_DP_DRIFT_CHANNEL=a0_0x5ce4da(0xe0),LTM_DP_DRIFT_STATUS=a0_0x5ce4da(0x240),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x5ce4da(0x2aa),SYSTEM_DP_MODE=a0_0x5ce4da(0x1a1),HARD_IGNORE_TERMS=[a0_0x5ce4da(0x16c),a0_0x5ce4da(0x2a8),a0_0x5ce4da(0x16f),a0_0x5ce4da(0x145),'lowbat',a0_0x5ce4da(0x23a),a0_0x5ce4da(0x1d1),a0_0x5ce4da(0x25c),a0_0x5ce4da(0xc1),'fault',a0_0x5ce4da(0x1d6),a0_0x5ce4da(0x22e),a0_0x5ce4da(0x2b6),a0_0x5ce4da(0x13c),a0_0x5ce4da(0x105),'firmware',a0_0x5ce4da(0x292),a0_0x5ce4da(0x1c9)],BAD_NAMES=['targetposition',a0_0x5ce4da(0x298),a0_0x5ce4da(0xb7),a0_0x5ce4da(0x29d),a0_0x5ce4da(0x2b8),a0_0x5ce4da(0x208),'on',a0_0x5ce4da(0x12e),a0_0x5ce4da(0x261),'position',a0_0x5ce4da(0x119),a0_0x5ce4da(0x11c),a0_0x5ce4da(0x235),a0_0x5ce4da(0x1c3),'motion',a0_0x5ce4da(0x179),a0_0x5ce4da(0x24f),a0_0x5ce4da(0x23e),a0_0x5ce4da(0x241),a0_0x5ce4da(0x201),a0_0x5ce4da(0x2a7),a0_0x5ce4da(0x1cd),a0_0x5ce4da(0x2c1),'actual_temperature',a0_0x5ce4da(0x260)],ADAPTER_BLACKLIST=['system.',a0_0x5ce4da(0x21f),a0_0x5ce4da(0x13b),a0_0x5ce4da(0x195),a0_0x5ce4da(0x18f),a0_0x5ce4da(0x253),a0_0x5ce4da(0x14b),a0_0x5ce4da(0x1e4),a0_0x5ce4da(0x135),a0_0x5ce4da(0x279),a0_0x5ce4da(0x2a2)],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x5ce4da(0xfd),'PARTY':a0_0x5ce4da(0x222),'GUEST':a0_0x5ce4da(0x256)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x5ce4da(0x100)],SYSTEM_MODES[a0_0x5ce4da(0xe2)]],PERSONA_MAPPING={'generic':a0_0x5ce4da(0x14a),'senior_aal':a0_0x5ce4da(0x196),'family':a0_0x5ce4da(0xfb),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x5ce4da(0xb1)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x594e2b){const _0x179f95=a0_0x5ce4da;try{const _0x4f7bf1=[_0x179f95(0x121),_0x179f95(0x139)];for(const _0x4c821d of _0x4f7bf1){try{const _0x3d995b=await _0x594e2b[_0x179f95(0x1f0)](_0x4c821d);_0x3d995b&&await _0x594e2b['delObjectAsync'](_0x4c821d);}catch(_0x17c8f0){}}}catch(_0x3024d4){}}async function initHistory(_0x33058a){const _0x53b4ff=a0_0x5ce4da;try{const _0x170a24=await _0x33058a[_0x53b4ff(0x1b0)]('events.history');_0x170a24&&_0x170a24['val']&&(_0x33058a['eventHistory']=JSON[_0x53b4ff(0x113)](_0x170a24[_0x53b4ff(0x2bf)][_0x53b4ff(0xb4)]()));}catch(_0x32664b){_0x33058a[_0x53b4ff(0x19b)]=[];}try{const _0x265432=await _0x33058a[_0x53b4ff(0x1b0)](_0x53b4ff(0x229));if(_0x265432&&_0x265432[_0x53b4ff(0x2bf)])_0x33058a[_0x53b4ff(0x108)]=JSON[_0x53b4ff(0x113)](_0x265432[_0x53b4ff(0x2bf)][_0x53b4ff(0xb4)]());}catch(_0x17041a){_0x33058a[_0x53b4ff(0x108)]=[];}if(_0x33058a['eventHistory']&&_0x33058a[_0x53b4ff(0x19b)][_0x53b4ff(0x153)]>0x0){_0x33058a[_0x53b4ff(0xe1)]['info'](_0x53b4ff(0x25e)+_0x33058a[_0x53b4ff(0x19b)][_0x53b4ff(0x153)]+_0x53b4ff(0x148));for(let _0x2ab486=_0x33058a[_0x53b4ff(0x19b)][_0x53b4ff(0x153)]-0x1;_0x2ab486>=0x0;_0x2ab486--){const _0x4010ee=_0x33058a['eventHistory'][_0x2ab486];_0x4010ee&&_0x4010ee['id']!==undefined&&_0x4010ee[_0x53b4ff(0x2b8)]!==undefined&&(_0x33058a[_0x53b4ff(0x149)][_0x4010ee['id']]=_0x4010ee['value']);}}}function a0_0x48dc(){const _0x59d125=['string','Failed\x20to\x20send\x20to\x20Python:\x20','rssi','\x20(Value:\x20','Alert\x20Reason','analysis.automation.triggerAction','temperature','analysis.automation.autoApply','LTM.driftAnalysis.baselineDrift','humidity',').\x20Starting\x20Timer.','\x20events','isEmergency','cancel','Health\x20&\x20Sleep\x20Analysis','cogni-living','analysis.health.notes','useCalendar','lastAlertState','generateContent','Keiner','driftAnalysisTimer','Keine\x20Details.','occupancy','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','Kein\x20API\x20Key\x20eingegeben.','callback','material.','PONG','COGNI_CONFIRM_OK','guest','channel','filter','forEach','Briefing\x20Error:\x20','analysis.health.restlessness','maintenance','setHours','Restoring\x20sensor\x20cache\x20from\x20history\x20(','system.isPresent','set_temperature','switch','dailyDigests','main','genAI','setObjectNotExistsAsync','summary','getOverviewData','values','Gemini\x20Analysis\x20Error:\x20','notifyEmailEnabled','setState','stateChange','KALENDER:\x20','getMonth','Activity-Level','Adapter','LTM.trainingData','includes','rawEventLog','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','Success:\x20Compressed\x20','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','IGNORING\x20DUPLICATE\x20(Cached):\x20','\x20(Value\x20is\x20falsy:\x20','javascript.','5458USvVGJ','tÃ¼r','Unknown','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','kontakt','weatherunderground','BUTLER\x20Execution\x20Error:\x20','modeResetJob','notifyPushoverEnabled','isAlert','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','ðŸŒ…\x20Daily\x20Briefing:\x0a','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','Details:\x20','PRO-','kill','onReady','Scheduling\x20Morning\x20Briefing\x20for\x20','Auto\x20Apply\x20Rule','.\x0a\x20\x20\x20\x20KONTEXT:\x20','weatherunderground.0','\x20(Type\x20\x27','_calName','0\x203\x20*\x20*\x20*','reachable','trim','details','briefingJob','analysisTimer','):\x20','currentposition','NORMAL','118790yAMFom','timestamp','boolean','level','door','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','Logbook','prÃ¤senz','simple-api.','getGenerativeModel','Thermodynamic\x20Data\x20Points','uuid','analysis.health','energy','scriptEnabled','Guardian:\x20Sending\x20','LTM.driftAnalysis.lastCheck','toLocaleString','Event\x20History','location','weather','licht','Feedback\x20saved:\x20','Party','python_service','LTM\x20Sched\x20Error:\x20','inactivityThresholdHours','native','stick_unreach','\x20(Length:\x20','value','namespace','selectedFunctionIds','getForeignStateAsync','analysis.trigger','VACATION','.Current.Temperature','val','write','valve','ANALYZE_TREND','Comfort\x20Suggestion','feedbackHistory','PRIORITÃ„T:\x20Sicherheit.','systemConfig','isPresent','toString','common','events.history','state','Training\x20Data\x20Sets','\x20Tage)','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','Starting\x20Autopilot\x20(','enum.functions.*','slice','split','analysisInterval','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','error','AI\x20Alert\x20Status','payload','analysis.alertReason','System\x20Status\x20&\x20Control','config','N/A\x20(Learning)','getHours','briefingEnabled','Who\x20is\x20present?','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','debug','heizung','\x0aSTB:\x20','LTM','Aktiv\x20(','licenseKey','light','5878474mXVGgg','363aokqvw','unload','geminiApiKey','\x20for\x20interactive\x20buttons...','requirements.txt','Kalender:\x20Deaktiviert','Comfort\x20Summary','getDate','8CwCSYG','exitGraceTimer','from','Feedback\x20Log','LTM.driftAnalysis','log','GUEST','instance','some','now','5169OqQUhq','Recorded\x20Motion\x20Sequences','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','No\x20instance','events.lastEvent','Drift\x20Status','shift','Kein\x20API\x20Key!','data','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','Generating\x20Morning\x20Briefing...','Sending\x20notification:\x20\x22','notifyTelegramRecipient','stderr','ltmStbWindowDays','bewegung','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','ready','livingContext','setStateAsync','3971725xojEoc','Fokus\x20auf\x20Familienroutinen.','[PYTHON]\x20','vacation','Target\x20Value','COGNI_REQUEST_CALL','PARTY','message','stdout','testNotification','version','dutycycle','Could\x20not\x20kill\x20Python\x20process:\x20','cogni-living\x20adapter\x20starting\x20(v','analysisHistory','Invalid\x20JSON\x20from\x20Python:\x20','ical.0','exitTimer','push','2828439YbYsCD','node-schedule','\x20|\x20','pop','automation.triggerAction','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','parse','[LICENSE\x20CHECK]\x20Key\x20present:\x20','service.py','.forecast.current.temperature','Raw\x20Log','name','shutter','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','LTM.triggerDailyDigest','blind','Say\x20Hello','rollladen','join','.NextHours.Location_1.Day_1.current.temp_value','analysis.history_debug_00','âš ï¸\x20ALARM:\x20','online','analysis.automation.targetId','analysis.health.trendValue','getForeignObjectsAsync','Error\x20launching\x20Python\x20service:\x20','currentSystemMode','targetValue','models/gemini-flash-latest','simulateButler','text','analysis.activitySummary','off','sort','notifyTelegramInstance','onStateChange','isExit','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','Activity\x20Summary','echarts.','Trigger\x20Digest','Pattern\x20Detected','unshift','events.history_debug_00','Missing\x20data','info.','config_pending','Automation\x20Proposals','sleepScore','LTM.baselineStatus','writable','lights','logDuplicates','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','\x20hours.\x20Potential\x20incapacitation.','unreach','submitFeedback','targetId','\x20events)...','sensorLastValues','Analysiere\x20ausgewogen.','icons-mfd.','notifyTelegramEnabled','.\x20ZUSATZ:\x20','KALENDER\x20ERROR:\x20','apply','sendTo','substring','sensor','length','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','Alarm','automationProposal','ðŸ\x20Guardian\x20Diagnosis\x20(','331XUJmdx','date','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','KI-Modell\x20nicht\x20initialisiert','KALENDER:\x20Keine\x20relevanten\x20Termine','members','schalter','[PYTHON\x20ERR]\x20','ltmDriftCheckIntervalHours','info','Trigger\x20Analysis','daswetter','notifyPushoverRecipient','isArray','Deviation','notifyEmailRecipient','subscribeStates','Description','\x20presence\x20devices...','\x20sensors...','scriptProblem','klima','system.presenceWho','update','[RECORDER]\x20Error\x20saving\x20sequence:\x20','Drift\x20Details','replace','Lernphase\x20(','@google/generative-ai','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','\x20min).','bind','Briefing\x20Sched\x20Error:\x20','presence','splice','indicator','analysis.health.trendDiagnosis','\x27\x20not\x20in\x20allowed\x20list)','Trigger\x20Action\x20Now','minDaysForBaseline','Target\x20ID','thermostat','system.config','enum','indexOf','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','N/A','fill','[LOG]','0\x204\x20*\x20*\x20*','onMessage','path','application/json','exports','city','history.','Error\x20reading\x20outdoor\x20sensor\x20','Error:\x20','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Error\x20in\x20onMessage\x20command\x20','pythonProcess','vis.','PRIORITÃ„T:\x20Gesundheit/AAL.','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','âœ…\x20PRO\x20ACTIVATED','Entry\x20detected\x20via\x20','stringify','eventHistory','...','.\x20OUTPUT:\x20Nur\x20Text.','Trend\x20Value\x20(%)','json','communicate.request','system.mode','Gemini\x20AI\x20initialized.','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','.\x20Welcome\x20home.','LTM.trainingData.sequences','notifyEmailInstance','Gast','siren','scheduleJob','Error\x20checking\x20WiFi:\x20','.Summary.Current','doors','ack','analysis.automation.patternDetected','alertReason','getStateAsync','getTime','Started\x20at\x20','analysis.comfortSuggestion','custom','onUnload','baselineDrift','User\x20dismissed\x20automation\x20proposal.','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','LTM.rawEventLog','type','catch','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','Processing\x20Status','python3','indicator.alarm.fire','Fehler:\x20','lastCheck','WETTER:\x20','status','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','sendToAsync','startsWith','toISOString','toFixed','link_quality','button','\x20*\x20*\x20*','toLowerCase','setpoint','analysis.isEmergency','geminiModel','find','connection','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','latitude','Trigger\x20Briefing\x20(Test)','setForeignStateAsync','working','WETTER:\x20Keine\x20Daten\x20gefunden','getForeignObjectAsync','description','Daily\x20Digests','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','Event\x20received:\x20','triggerBriefing','getCalendarNames\x20Error:\x20','lampe','response','1348oDVfvb','search','Drift\x20Sched\x20Error:\x20','flot.','isGracePeriodActive','aiPersona','notifyPushoverInstance','TEST-PRO-KEY','\x20days\x20of\x20activity\x20data\x20to\x20Python...','outdoorSensorId','LTM.processingStatus','\x22\x20--break-system-packages','time','detected','Last\x20Check','getObjectAsync','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','.data.table','weatherInstance','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','extendObjectAsync','presenceDevices','window','Verbindung\x20erfolgreich!\x20Antwort:\x20','analysis.automation.description','object','@iobroker/adapter-core','(((.+)+)+)+$','Deaktiviert\x20(Pro-Feature)','systemUUID','Exit\x20Sensor\x20triggered\x20(','enum.rooms.*','power','round','ðŸš¨\x20EMERGENCY','scanDevices','Health\x20Notes','LTM.dailyDigests','.communicate.request','brightness','ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','Action','System\x20Mode','isProVersion','getCalendarNames','TREND_RESULT','number','sound','dependencyInstallInProgress','map','ltmJob','Trend\x20Diagnosis\x20(Python)','No\x20module\x20named','warn','\x20=\x20','analysis.isAlert','autoApply','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','WETTER\x20ERROR:\x20','LTM.trainingData.thermodynamics','devices','5404614swAXrR','admin.','stdin','command','party','subscribeForeignStatesAsync','.\x0a\x20\x20\x20\x20WETTER:\x20','system.meta.uuid','generic','Bibliotheken\x20nicht\x20gefunden','analysis.automation.targetValue','analysis.analysisHistory','send','triggerDailyDigest','getLtmData','contact','direction','python3\x20-m\x20pip\x20install\x20-r\x20\x22','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','useWeather','motion','fenster','cover','KALENDER:\x20Keine\x20Daten','âŒ\x20FREE\x20MODE'];a0_0x48dc=function(){return _0x59d125;};return a0_0x48dc();}async function initSystemConfig(_0x776ff0){const _0x56d76a=a0_0x5ce4da;try{const _0x10ce4d=await _0x776ff0['getForeignObjectAsync'](_0x56d76a(0x182));_0x10ce4d&&_0x10ce4d[_0x56d76a(0xb5)]&&(_0x776ff0[_0x56d76a(0xb2)]={'latitude':_0x10ce4d[_0x56d76a(0xb5)][_0x56d76a(0x1d3)]||0x0,'longitude':_0x10ce4d[_0x56d76a(0xb5)]['longitude']||0x0,'city':_0x10ce4d[_0x56d76a(0xb5)][_0x56d76a(0x18e)]||''});}catch(_0x9df96f){}}async function checkLicense(_0x41fd50,_0x2d759c){const _0x23790d=a0_0x5ce4da;if(!_0x2d759c)return![];_0x41fd50[_0x23790d(0x1fe)]=await getSystemUUID(_0x41fd50);if(_0x2d759c===_0x23790d(0x1e8)||_0x2d759c[_0x23790d(0x1c6)](_0x23790d(0x288)))return!![];return![];}async function getSystemUUID(_0x4f5352){const _0x4d4ff2=a0_0x5ce4da;try{const _0xee7a1=await _0x4f5352['getForeignObjectAsync'](_0x4d4ff2(0x225));if(_0xee7a1&&_0xee7a1[_0x4d4ff2(0x2b5)]&&_0xee7a1[_0x4d4ff2(0x2b5)][_0x4d4ff2(0x2a5)])return _0xee7a1[_0x4d4ff2(0x2b5)][_0x4d4ff2(0x2a5)];return'uuid-not-found';}catch(_0x2326e6){return'uuid-error';}}async function createAllObjects(_0x4f0377){const _0x32f84b=a0_0x5ce4da;await checkSystemObjects(_0x4f0377),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x16e),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0xca),'type':_0x32f84b(0x238),'role':_0x32f84b(0x12c),'read':!![],'write':![],'def':''},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0xea),{'type':_0x32f84b(0xb7),'common':{'name':'Last\x20raw\x20event','type':_0x32f84b(0x238),'role':_0x32f84b(0x19f),'read':!![],'write':![]},'native':{}}),await _0x4f0377['setObjectNotExistsAsync']('events.history',{'type':'state','common':{'name':_0x32f84b(0x2ac),'type':_0x32f84b(0x238),'role':_0x32f84b(0x19f),'read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x2bc),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x162),'type':'boolean','role':_0x32f84b(0x1ca),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)]('analysis.triggerBriefing',{'type':'state','common':{'name':_0x32f84b(0x1d4),'type':_0x32f84b(0x29c),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)]('analysis.lastResult',{'type':_0x32f84b(0xb7),'common':{'name':'Last\x20Result','type':_0x32f84b(0x238),'role':'json','read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x218),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0xc2),'type':'boolean','role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x1ce),{'type':_0x32f84b(0xb7),'common':{'name':'AI\x20Emergency\x20Status','type':'boolean','role':_0x32f84b(0x1bf),'read':!![],'write':![],'def':![]},'native':{}}),await _0x4f0377['setObjectNotExistsAsync'](_0x32f84b(0xc4),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x23c),'type':_0x32f84b(0x238),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x12d),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x134),'type':_0x32f84b(0x238),'role':_0x32f84b(0x12c),'read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)]('analysis.deviationFromBaseline',{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x166),'type':_0x32f84b(0x238),'role':_0x32f84b(0xb7),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x4f0377[_0x32f84b(0x265)]('analysis.comfortSummary',{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0xda),'type':'string','role':_0x32f84b(0x12c),'read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x1b3),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x2c3),'type':_0x32f84b(0x238),'role':_0x32f84b(0x12c),'read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x1f5)]('analysis.automation',{'type':_0x32f84b(0x257),'common':{'name':_0x32f84b(0x13d)},'native':{}}),await _0x4f0377['setObjectNotExistsAsync'](_0x32f84b(0x1ae),{'type':'state','common':{'name':_0x32f84b(0x137),'type':_0x32f84b(0x29c),'role':_0x32f84b(0x17b),'read':!![],'write':![],'def':![]},'native':{}}),await _0x4f0377['setObjectNotExistsAsync'](_0x32f84b(0x1f9),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x169),'type':'string','role':_0x32f84b(0x12c),'read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)]('analysis.automation.suggestedAction',{'type':'state','common':{'name':_0x32f84b(0x20a),'type':'string','role':_0x32f84b(0x12c),'read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x124),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x180),'type':_0x32f84b(0x238),'role':_0x32f84b(0x12c),'read':!![],'write':![]},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x228),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0xfe),'type':'string','role':_0x32f84b(0x12c),'read':!![],'write':![]},'native':{}}),await _0x4f0377['setObjectNotExistsAsync']('analysis.automation.autoApply',{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x28c),'type':_0x32f84b(0x29c),'role':_0x32f84b(0x261),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4f0377['setObjectNotExistsAsync'](_0x32f84b(0x23d),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x17e),'type':_0x32f84b(0x29c),'role':_0x32f84b(0x1ca),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x4f0377['setObjectNotExistsAsync'](_0x32f84b(0x229),{'type':'state','common':{'name':_0x32f84b(0x2a0),'type':_0x32f84b(0x238),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x4f0377[_0x32f84b(0x265)]('analysis.feedbackHistory',{'type':'state','common':{'name':_0x32f84b(0xdf),'type':_0x32f84b(0x238),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x4f0377[_0x32f84b(0x1f5)](_0x32f84b(0x2a6),{'type':_0x32f84b(0x257),'common':{'name':_0x32f84b(0x246)},'native':{}}),await _0x4f0377[_0x32f84b(0x265)]('analysis.health.sleepScore',{'type':_0x32f84b(0xb7),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x32f84b(0x20f),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x25b),{'type':_0x32f84b(0xb7),'common':{'name':'Restlessness\x20Level','type':_0x32f84b(0x238),'role':'text','read':!![],'write':![],'def':'none'},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x248),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x205),'type':'string','role':'text','read':!![],'write':![],'def':''},'native':{}}),await _0x4f0377['setObjectNotExistsAsync'](_0x32f84b(0x17c),{'type':'state','common':{'name':_0x32f84b(0x214),'type':_0x32f84b(0x238),'role':_0x32f84b(0x12c),'read':!![],'write':![],'def':_0x32f84b(0x186)},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x125),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x19e),'type':_0x32f84b(0x20f),'role':_0x32f84b(0x2b8),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x4f0377[_0x32f84b(0x1f5)](_0x32f84b(0x271),{'type':_0x32f84b(0x257),'common':{'name':_0x32f84b(0xb8)},'native':{}}),await _0x4f0377[_0x32f84b(0x265)]('LTM.trainingData.sequences',{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0xe7),'type':_0x32f84b(0x238),'role':'json','read':!![],'write':![],'def':'[]','desc':_0x32f84b(0x175)},'native':{}}),await _0x4f0377[_0x32f84b(0x265)](_0x32f84b(0x21c),{'type':_0x32f84b(0xb7),'common':{'name':_0x32f84b(0x2a4),'type':_0x32f84b(0x238),'role':_0x32f84b(0x19f),'read':!![],'write':![],'def':'[]','desc':'Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time'},'native':{}}),await checkLtmObjects(_0x4f0377),await checkLtmDriftObjects(_0x4f0377);}async function checkSystemObjects(_0x29e01e){const _0x2aec6b=a0_0x5ce4da;await _0x29e01e[_0x2aec6b(0x1f5)]('system',{'type':_0x2aec6b(0x257),'common':{'name':_0x2aec6b(0xc5)},'native':{}}),await _0x29e01e['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x2aec6b(0xb7),'common':{'name':_0x2aec6b(0x20b),'type':_0x2aec6b(0x238),'role':_0x2aec6b(0xb7),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x2aec6b(0x299)],'states':{[SYSTEM_MODES['NORMAL']]:'Normal',[SYSTEM_MODES[_0x2aec6b(0x2bd)]]:'Urlaub',[SYSTEM_MODES[_0x2aec6b(0x100)]]:_0x2aec6b(0x2b1),[SYSTEM_MODES[_0x2aec6b(0xe2)]]:_0x2aec6b(0x1a7)}},'native':{}});}async function checkLtmObjects(_0x37cb7a){const _0x54e973=a0_0x5ce4da;await _0x37cb7a[_0x54e973(0x1f5)](_0x54e973(0xcf),{'type':'channel','common':{'name':_0x54e973(0xcf)},'native':{}}),await _0x37cb7a[_0x54e973(0x1f5)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x54e973(0x117),'type':_0x54e973(0x238),'role':_0x54e973(0x19f),'read':!![],'write':![]},'native':{}}),await _0x37cb7a[_0x54e973(0x1f5)](LTM_DP_DAILY_DIGESTS,{'type':_0x54e973(0xb7),'common':{'name':_0x54e973(0x1da),'type':_0x54e973(0x238),'role':'json','read':!![],'write':![]},'native':{}}),await _0x37cb7a[_0x54e973(0x1f5)](LTM_DP_STATUS,{'type':_0x54e973(0xb7),'common':{'name':_0x54e973(0x1bd),'type':_0x54e973(0x238),'role':'text','read':!![],'write':![]},'native':{}}),await _0x37cb7a['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x54e973(0xb7),'common':{'name':_0x54e973(0x136),'type':_0x54e973(0x29c),'role':_0x54e973(0x1ca),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x37cb7a[_0x54e973(0x1f5)](LTM_DP_BASELINE_STATUS,{'type':_0x54e973(0xb7),'common':{'name':'Baseline\x20Status','type':'string','role':_0x54e973(0x12c),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x5e5c19){const _0x1c2954=a0_0x5ce4da;await _0x5e5c19[_0x1c2954(0x1f5)](LTM_DP_DRIFT_CHANNEL,{'type':_0x1c2954(0x257),'common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x5e5c19[_0x1c2954(0x1f5)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x1c2954(0xeb),'type':'string','role':'state','read':!![],'write':![],'def':_0x1c2954(0x186)},'native':{}}),await _0x5e5c19[_0x1c2954(0x1f5)](LTM_DP_DRIFT_DETAILS,{'type':_0x1c2954(0xb7),'common':{'name':_0x1c2954(0x171),'type':_0x1c2954(0x238),'role':'text','read':!![],'write':![]},'native':{}}),await _0x5e5c19['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x1c2954(0xb7),'common':{'name':_0x1c2954(0x1ef),'type':_0x1c2954(0x20f),'role':_0x1c2954(0x159),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x28b8bc){const _0x3eca84=a0_0x5ce4da;try{const _0x3b5852=await _0x28b8bc['getStateAsync'](SYSTEM_DP_MODE);_0x3b5852&&_0x3b5852[_0x3eca84(0x2bf)]&&Object[_0x3eca84(0x268)](SYSTEM_MODES)[_0x3eca84(0x272)](_0x3b5852['val'])?_0x28b8bc[_0x3eca84(0x128)]=_0x3b5852[_0x3eca84(0x2bf)]:(_0x28b8bc[_0x3eca84(0x128)]=SYSTEM_MODES[_0x3eca84(0x299)],await _0x28b8bc[_0x3eca84(0xf9)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3eca84(0x299)],'ack':!![]}));}catch(_0x45520b){_0x28b8bc[_0x3eca84(0x128)]=SYSTEM_MODES[_0x3eca84(0x299)];}}async function loadRawEventLog(_0x103534){const _0x425541=a0_0x5ce4da;try{const _0x4c1a69=await _0x103534['getStateAsync'](LTM_DP_RAW_LOG);if(_0x4c1a69&&_0x4c1a69['val'])_0x103534[_0x425541(0x273)]=JSON[_0x425541(0x113)](_0x4c1a69['val']);}catch(_0x37c6d1){_0x103534[_0x425541(0x273)]=[];}}async function saveRawEventLog(_0x54b5a8){const _0x3149d5=a0_0x5ce4da;_0x54b5a8['rawEventLog'][_0x3149d5(0x153)]>RAW_LOG_MAX_SIZE&&_0x54b5a8[_0x3149d5(0x273)]['splice'](0x0,_0x54b5a8['rawEventLog'][_0x3149d5(0x153)]-RAW_LOG_MAX_SIZE),await _0x54b5a8[_0x3149d5(0xf9)](LTM_DP_RAW_LOG,{'val':JSON[_0x3149d5(0x19a)](_0x54b5a8['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x5c4542){const _0x114885=a0_0x5ce4da;try{const _0x37513d=await _0x5c4542['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x37513d&&_0x37513d['val'])_0x5c4542[_0x114885(0x262)]=JSON[_0x114885(0x113)](_0x37513d['val']);}catch(_0x5ea3bd){_0x5c4542['dailyDigests']=[];}await updateBaselineStatus(_0x5c4542);}async function saveDailyDigests(_0x1b8b1a,_0x150e7a=!![]){const _0x3ddc62=a0_0x5ce4da,_0xfd064e=_0x1b8b1a[_0x3ddc62(0xc6)]['ltmLtbWindowDays']||0x3c;_0x1b8b1a[_0x3ddc62(0x262)][_0x3ddc62(0x153)]>_0xfd064e&&_0x1b8b1a[_0x3ddc62(0x262)][_0x3ddc62(0x17a)](0x0,_0x1b8b1a['dailyDigests']['length']-_0xfd064e);await _0x1b8b1a[_0x3ddc62(0xf9)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x3ddc62(0x19a)](_0x1b8b1a[_0x3ddc62(0x262)]),'ack':!![]});if(_0x150e7a)await updateBaselineStatus(_0x1b8b1a);}function a0_0x1632(_0x1364e0,_0x3b9103){const _0x11feeb=a0_0x48dc();return a0_0x1632=function(_0x268c95,_0x37164c){_0x268c95=_0x268c95-0xb1;let _0x48dc93=_0x11feeb[_0x268c95];return _0x48dc93;},a0_0x1632(_0x1364e0,_0x3b9103);}async function updateAnalysisHistory(_0x27c446,_0x29372f){const _0x45ee84=a0_0x5ce4da;_0x27c446[_0x45ee84(0x108)]['unshift'](_0x29372f);if(_0x27c446[_0x45ee84(0x108)][_0x45ee84(0x153)]>ANALYSIS_HISTORY_MAX_SIZE)_0x27c446[_0x45ee84(0x108)][_0x45ee84(0x110)]();await _0x27c446[_0x45ee84(0xf9)](_0x45ee84(0x229),{'val':JSON[_0x45ee84(0x19a)](_0x27c446[_0x45ee84(0x108)]),'ack':!![]});}async function updateBaselineStatus(_0x2f4314){const _0x170cce=a0_0x5ce4da;if(!_0x2f4314['isProVersion']){await _0x2f4314[_0x170cce(0xf9)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0xb2c465=_0x2f4314[_0x170cce(0x262)][_0x170cce(0x153)]>=(_0x2f4314[_0x170cce(0xc6)]['minDaysForBaseline']||0x7)?_0x170cce(0xd0)+_0x2f4314[_0x170cce(0x262)][_0x170cce(0x153)]+_0x170cce(0xb9):_0x170cce(0x173)+_0x2f4314['dailyDigests'][_0x170cce(0x153)]+'/'+(_0x2f4314[_0x170cce(0xc6)]['minDaysForBaseline']||0x7)+')';await _0x2f4314['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0xb2c465,'ack':!![]});}async function initSensorSubscriptions(_0x2d40ae){const _0x294a9f=a0_0x5ce4da,_0x4d4358=_0x2d40ae['config'][_0x294a9f(0x21d)];if(_0x4d4358&&_0x4d4358[_0x294a9f(0x153)]>0x0){_0x2d40ae[_0x294a9f(0xe1)][_0x294a9f(0x161)]('Subscribing\x20to\x20'+_0x4d4358[_0x294a9f(0x153)]+_0x294a9f(0x16b));for(const _0x113ef4 of _0x4d4358){if(_0x113ef4['id']){await _0x2d40ae[_0x294a9f(0x223)](_0x113ef4['id']);try{const _0x20373e=await _0x2d40ae[_0x294a9f(0x2bb)](_0x113ef4['id']);if(_0x20373e)_0x2d40ae['sensorLastValues'][_0x113ef4['id']]=_0x20373e[_0x294a9f(0x2bf)];}catch(_0x62213){}}}}}async function initPresenceSubscriptions(_0x13741d){const _0xf58be6=a0_0x5ce4da,_0x82bdc5=_0x13741d[_0xf58be6(0xc6)][_0xf58be6(0x1f6)]||[];if(_0x82bdc5[_0xf58be6(0x153)]>0x0){_0x13741d[_0xf58be6(0xe1)][_0xf58be6(0x161)]('Subscribing\x20to\x20'+_0x82bdc5['length']+_0xf58be6(0x16a));for(const _0x75f931 of _0x82bdc5){await _0x13741d[_0xf58be6(0x223)](_0x75f931);}try{await checkWifiPresence(_0x13741d);}catch(_0x204dd7){}}}async function getWeatherContext(_0x1ee6a6){const _0x552bf0=a0_0x5ce4da;try{if(!_0x1ee6a6[_0x552bf0(0xc6)][_0x552bf0(0x232)])return'Wetter:\x20Deaktiviert';let _0x13c506='';const _0x510f5b=_0x1ee6a6[_0x552bf0(0xc6)][_0x552bf0(0x1f3)];if(_0x510f5b)try{if(_0x510f5b[_0x552bf0(0x272)]('accuweather')){const _0x26963c=await _0x1ee6a6[_0x552bf0(0x2bb)](_0x510f5b+'.Summary.Current');if(_0x26963c&&_0x26963c[_0x552bf0(0x2bf)])_0x13c506=_0x26963c['val'];}else{if(_0x510f5b[_0x552bf0(0x272)]('daswetter')){const _0x1e148d=await _0x1ee6a6[_0x552bf0(0x2bb)](_0x510f5b+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0x1e148d&&_0x1e148d['val'])_0x13c506=_0x1e148d['val'];}else{if(_0x510f5b['includes']('openweathermap')){const _0x10f042=await _0x1ee6a6['getForeignStateAsync'](_0x510f5b+'.forecast.current.state');if(_0x10f042&&_0x10f042[_0x552bf0(0x2bf)])_0x13c506=_0x10f042[_0x552bf0(0x2bf)];}}}}catch(_0x2c76a0){}if(!_0x13c506){const _0x35a82d=['accuweather.0','daswetter.0',_0x552bf0(0x28e),'openweathermap.0'];for(const _0x4932fb of _0x35a82d){try{const _0x34f3e8=await _0x1ee6a6[_0x552bf0(0x1d8)](_0x4932fb);if(_0x34f3e8){if(_0x4932fb[_0x552bf0(0x272)]('accuweather')){const _0x5ec2e0=await _0x1ee6a6[_0x552bf0(0x2bb)](_0x4932fb+_0x552bf0(0x1ab));if(_0x5ec2e0&&_0x5ec2e0[_0x552bf0(0x2bf)]){_0x13c506=_0x5ec2e0[_0x552bf0(0x2bf)];break;}}}}catch(_0x2b6d94){}}}return _0x13c506?_0x552bf0(0x1c2)+_0x13c506:_0x552bf0(0x1d7);}catch(_0x5f3bc9){return _0x552bf0(0x21b)+_0x5f3bc9[_0x552bf0(0x101)];}}async function getCalendarContext(_0x1b4a58){const _0xc85a32=a0_0x5ce4da;try{if(!_0x1b4a58[_0xc85a32(0xc6)][_0xc85a32(0x249)])return _0xc85a32(0xd9);let _0x24f44f=_0x1b4a58[_0xc85a32(0xc6)]['calendarInstance']||_0xc85a32(0x10a),_0xfa9dde=_0x1b4a58[_0xc85a32(0xc6)]['calendarSelection']||[];if(typeof _0xfa9dde===_0xc85a32(0x238))_0xfa9dde=_0xfa9dde[_0xc85a32(0xbe)](',');try{const _0x86099a=await _0x1b4a58['getForeignStateAsync'](_0x24f44f+_0xc85a32(0x1f2));if(_0x86099a&&_0x86099a[_0xc85a32(0x2bf)]){let _0x3abaf9=tryParse(_0x86099a['val']);if(_0x3abaf9&&Array['isArray'](_0x3abaf9)){if(_0xfa9dde[_0xc85a32(0x153)]>0x0)_0x3abaf9=_0x3abaf9[_0xc85a32(0x258)](_0x46476a=>_0xfa9dde[_0xc85a32(0x272)](_0x46476a['_calName']||''));else return _0xc85a32(0x1bc);if(_0x3abaf9[_0xc85a32(0x153)]>0x0){const _0x46e56b=_0x3abaf9[_0xc85a32(0xbd)](0x0,0x3)[_0xc85a32(0x212)](_0x180a21=>{const _0x3f1318=_0xc85a32;let _0x509523=_0x180a21[_0x3f1318(0x159)];if(_0x180a21[_0x3f1318(0x1ed)])_0x509523+='\x20'+_0x180a21[_0x3f1318(0x1ed)];return _0x509523+':\x20'+_0x180a21['event']+'\x20('+_0x180a21[_0x3f1318(0x290)]+')';});return _0xc85a32(0x26d)+_0x46e56b[_0xc85a32(0x11f)](_0xc85a32(0x10f));}else return _0xc85a32(0x15c);}}}catch(_0x3a892c){_0x1b4a58[_0xc85a32(0xe1)][_0xc85a32(0x216)]('Error\x20reading\x20calendar\x20table:\x20'+_0x3a892c['message']);}return _0xc85a32(0x236);}catch(_0x1e1dec){return _0xc85a32(0x14e)+_0x1e1dec[_0xc85a32(0x101)];}}async function getCalendarNames(_0x5a6998,_0x57d1b8){const _0x325ede=a0_0x5ce4da;try{const _0x27c223=await _0x5a6998[_0x325ede(0x2bb)](_0x57d1b8+_0x325ede(0x1f2));if(_0x27c223&&_0x27c223[_0x325ede(0x2bf)]){const _0x2fed0d=tryParse(_0x27c223[_0x325ede(0x2bf)]);if(_0x2fed0d&&Array[_0x325ede(0x165)](_0x2fed0d)){const _0x20915c=[...new Set(_0x2fed0d[_0x325ede(0x212)](_0x10a7ee=>_0x10a7ee[_0x325ede(0x290)])[_0x325ede(0x258)](Boolean))];return _0x20915c['sort']();}}return[];}catch(_0x4d1eb1){return _0x5a6998[_0x325ede(0xe1)][_0x325ede(0xc1)](_0x325ede(0x1de)+_0x4d1eb1[_0x325ede(0x101)]),[];}}async function checkWifiPresence(_0x3b601e){const _0x5395bc=a0_0x5ce4da;try{const _0x116e80=_0x3b601e['config'][_0x5395bc(0x1f6)]||[];let _0x454564=![];const _0x5634ab=[];for(const _0x2f594f of _0x116e80){try{const _0x42eada=await _0x3b601e[_0x5395bc(0x2bb)](_0x2f594f);if(_0x42eada&&(_0x42eada[_0x5395bc(0x2bf)]===!![]||_0x42eada[_0x5395bc(0x2bf)]===_0x5395bc(0x123)||_0x42eada[_0x5395bc(0x2bf)]===0x1)){_0x454564=!![];const _0x3e1cc2=await _0x3b601e['getForeignObjectAsync'](_0x2f594f);let _0x318a9a=_0x2f594f;_0x3e1cc2&&_0x3e1cc2[_0x5395bc(0xb5)]&&_0x3e1cc2[_0x5395bc(0xb5)][_0x5395bc(0x118)]&&(_0x318a9a=typeof _0x3e1cc2[_0x5395bc(0xb5)][_0x5395bc(0x118)]===_0x5395bc(0x1fa)?_0x3e1cc2[_0x5395bc(0xb5)]['name']['de']||_0x3e1cc2[_0x5395bc(0xb5)][_0x5395bc(0x118)]['en']:_0x3e1cc2['common']['name']),_0x5634ab[_0x5395bc(0x10c)](_0x318a9a);}}catch(_0x4a6b27){}}return await _0x3b601e[_0x5395bc(0xf9)](_0x5395bc(0x16e),{'val':_0x5634ab[_0x5395bc(0x11f)](',\x20'),'ack':!![]}),_0x454564&&(_0x3b601e['exitTimer']&&(_0x3b601e[_0x5395bc(0xe1)][_0x5395bc(0x161)](_0x5395bc(0x286)),abortExitTimer(_0x3b601e)),!_0x3b601e[_0x5395bc(0xb3)]&&_0x3b601e['currentSystemMode']===SYSTEM_MODES[_0x5395bc(0x299)]&&await setPresence(_0x3b601e,!![])),_0x454564;}catch(_0x2fcac0){return _0x3b601e[_0x5395bc(0xe1)][_0x5395bc(0xc1)](_0x5395bc(0x1aa)+_0x2fcac0[_0x5395bc(0x101)]),![];}}function startExitTimer(_0xbf0467){const _0x2a07d1=a0_0x5ce4da;abortExitTimer(_0xbf0467),_0xbf0467[_0x2a07d1(0x1e5)]=!![],_0xbf0467[_0x2a07d1(0xdd)]=setTimeout(()=>{const _0xf50b6b=_0x2a07d1;_0xbf0467[_0xf50b6b(0x1e5)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0xbf0467[_0x2a07d1(0x10b)]=setTimeout(()=>{setPresence(_0xbf0467,![]),_0xbf0467['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x3ff0ce){const _0x24bb6a=a0_0x5ce4da;if(_0x3ff0ce['exitTimer'])clearTimeout(_0x3ff0ce['exitTimer']);if(_0x3ff0ce[_0x24bb6a(0xdd)])clearTimeout(_0x3ff0ce[_0x24bb6a(0xdd)]);_0x3ff0ce[_0x24bb6a(0x10b)]=null,_0x3ff0ce[_0x24bb6a(0xdd)]=null,_0x3ff0ce['isGracePeriodActive']=![];}async function setPresence(_0x39ca55,_0x4f715a){const _0x1e4c0f=a0_0x5ce4da;if(_0x39ca55[_0x1e4c0f(0xb3)]===_0x4f715a)return;_0x39ca55[_0x1e4c0f(0xb3)]=_0x4f715a,await _0x39ca55[_0x1e4c0f(0xf9)](_0x1e4c0f(0x25f),{'val':_0x4f715a,'ack':!![]});}async function saveFeedback(_0x2dc8bd,_0x169f29){const _0x34d0a1=a0_0x5ce4da;_0x2dc8bd[_0x34d0a1(0xe1)][_0x34d0a1(0x161)](_0x34d0a1(0x2b0)+JSON[_0x34d0a1(0x19a)](_0x169f29));}async function runBaselineDriftAnalysis(_0x5e9cd2){const _0x4aedf4=a0_0x5ce4da;if(!_0x5e9cd2['isProVersion']||!_0x5e9cd2[_0x4aedf4(0x1cf)])return;const _0x56e619=_0x5e9cd2[_0x4aedf4(0xc6)]['ltmStbWindowDays']||0xe;if(_0x5e9cd2[_0x4aedf4(0x262)][_0x4aedf4(0x153)]<_0x56e619+(_0x5e9cd2[_0x4aedf4(0xc6)][_0x4aedf4(0x17f)]||0x7)){await _0x5e9cd2[_0x4aedf4(0xf9)](LTM_DP_DRIFT_STATUS,{'val':_0x4aedf4(0xc7),'ack':!![]});return;}const _0x5acf0e=_0x5e9cd2[_0x4aedf4(0x262)]['slice'](-_0x56e619),_0x1f72e8=_0x5e9cd2[_0x4aedf4(0x262)]['slice'](0x0,_0x5e9cd2['dailyDigests']['length']-_0x56e619),_0x157972=_0x4aedf4(0x1a3)+JSON['stringify'](_0x1f72e8)+_0x4aedf4(0xce)+JSON[_0x4aedf4(0x19a)](_0x5acf0e);try{const _0x2e2215=await _0x5e9cd2[_0x4aedf4(0x1cf)]['generateContent'](_0x157972),_0x4f7271=JSON[_0x4aedf4(0x113)](_0x2e2215[_0x4aedf4(0x1e0)][_0x4aedf4(0x12c)]()[_0x4aedf4(0x172)](/```json|```/g,'')[_0x4aedf4(0x293)]());_0x4f7271[_0x4aedf4(0x1b6)]&&(await _0x5e9cd2[_0x4aedf4(0xf9)](LTM_DP_DRIFT_STATUS,{'val':_0x4f7271[_0x4aedf4(0x1b6)],'ack':!![]}),await _0x5e9cd2[_0x4aedf4(0xf9)](LTM_DP_DRIFT_DETAILS,{'val':_0x4f7271['driftDetails'],'ack':!![]}),await _0x5e9cd2['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4aedf4(0xe5)](),'ack':!![]}));}catch(_0x571208){}}function setupLtmScheduler(_0x5ee887){const _0x402ca8=a0_0x5ce4da;try{if(_0x5ee887[_0x402ca8(0x213)])_0x5ee887[_0x402ca8(0x213)][_0x402ca8(0x245)]();if(!_0x5ee887[_0x402ca8(0x20c)]){_0x5ee887[_0x402ca8(0xf9)](LTM_DP_STATUS,{'val':_0x402ca8(0x1fd),'ack':!![]});return;}_0x5ee887[_0x402ca8(0x213)]=schedule[_0x402ca8(0x1a9)](LTM_SCHEDULE,()=>createDailyDigest(_0x5ee887));}catch(_0xf424c6){_0x5ee887[_0x402ca8(0xe1)][_0x402ca8(0xc1)](_0x402ca8(0x2b3)+_0xf424c6[_0x402ca8(0x101)]);}}function setupModeResetScheduler(_0x4227aa){const _0x131b98=a0_0x5ce4da;try{if(_0x4227aa[_0x131b98(0x281)])_0x4227aa[_0x131b98(0x281)][_0x131b98(0x245)]();_0x4227aa[_0x131b98(0x281)]=schedule[_0x131b98(0x1a9)](MODE_RESET_SCHEDULE,async()=>{const _0x33d81d=_0x131b98;await loadSystemMode(_0x4227aa),AUTO_RESET_MODES[_0x33d81d(0x272)](_0x4227aa[_0x33d81d(0x128)])&&await _0x4227aa[_0x33d81d(0xf9)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x33d81d(0x299)],'ack':![]});});}catch(_0x2d60a7){_0x4227aa['log']['error']('Reset\x20Sched\x20Error:\x20'+_0x2d60a7[_0x131b98(0x101)]);}}function setupDriftAnalysisScheduler(_0x25bbc5){const _0x1ff54d=a0_0x5ce4da;try{if(_0x25bbc5[_0x1ff54d(0x24d)])clearInterval(_0x25bbc5['driftAnalysisTimer']);if(!_0x25bbc5[_0x1ff54d(0x20c)])return;_0x25bbc5[_0x1ff54d(0x24d)]=setInterval(()=>runBaselineDriftAnalysis(_0x25bbc5),(_0x25bbc5[_0x1ff54d(0xc6)][_0x1ff54d(0x160)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x25bbc5),0x1388);}catch(_0x507f78){_0x25bbc5[_0x1ff54d(0xe1)][_0x1ff54d(0xc1)](_0x1ff54d(0x1e3)+_0x507f78[_0x1ff54d(0x101)]);}}function setupBriefingScheduler(_0x16997c){const _0x9fc66d=a0_0x5ce4da;try{if(_0x16997c[_0x9fc66d(0x295)])_0x16997c[_0x9fc66d(0x295)][_0x9fc66d(0x245)]();if(!_0x16997c[_0x9fc66d(0xc6)][_0x9fc66d(0xc9)])return;const _0x72cede=(_0x16997c['config']['briefingTime']||'08:00')[_0x9fc66d(0xbe)](':'),_0x4cd04e=parseInt(_0x72cede[0x0])||0x8,_0x39de08=parseInt(_0x72cede[0x1])||0x0,_0x127a97=_0x39de08+'\x20'+_0x4cd04e+_0x9fc66d(0x1cb);_0x16997c[_0x9fc66d(0xe1)]['info'](_0x9fc66d(0x28b)+_0x4cd04e+':'+(_0x39de08<0xa?'0'+_0x39de08:_0x39de08)),_0x16997c[_0x9fc66d(0x295)]=schedule[_0x9fc66d(0x1a9)](_0x127a97,()=>{sendMorningBriefing(_0x16997c);});}catch(_0x3fc775){_0x16997c[_0x9fc66d(0xe1)][_0x9fc66d(0xc1)](_0x9fc66d(0x178)+_0x3fc775[_0x9fc66d(0x101)]);}}async function sendNotification(_0xf2746,_0x4ba41c,_0x5a0092=![],_0x545852=![]){const _0x38c178=a0_0x5ce4da;_0xf2746[_0x38c178(0xe1)]['info']((_0x5a0092?'[TEST]\x20':'')+_0x38c178(0xf1)+_0x4ba41c+'\x22');const _0x3090b4=_0xf2746[_0x38c178(0xc6)];let _0x29231d=0x0;if(_0x3090b4['notifyTelegramEnabled']){let _0x13a614={};(_0x4ba41c[_0x38c178(0x272)](_0x38c178(0x155))||_0x545852)&&(_0x13a614={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':_0x38c178(0x255)}],[{'text':_0x38c178(0x276),'callback_data':_0x38c178(0xff)}]]}}),await _0xf2746[_0x38c178(0x1c5)](_0x3090b4[_0x38c178(0x130)],_0x38c178(0x22a),{'text':_0x4ba41c,'user':_0x3090b4[_0x38c178(0xf2)],..._0x13a614}),_0x29231d++;}if(_0x3090b4[_0x38c178(0x282)]){let _0xfe1cc3={'message':_0x4ba41c,'title':_0x545852?_0x38c178(0x203):'Cogni-Living','priority':_0x545852?0x2:0x1,'device':_0x3090b4[_0x38c178(0x164)]};_0x545852&&(_0xfe1cc3['retry']=0x1e,_0xfe1cc3['expire']=0xe10,_0xfe1cc3[_0x38c178(0x210)]=_0x38c178(0x1a8)),await _0xf2746[_0x38c178(0x1c5)](_0x3090b4[_0x38c178(0x1e7)],_0x38c178(0x22a),_0xfe1cc3),_0x29231d++;}return _0x3090b4[_0x38c178(0x26a)]&&(await _0xf2746[_0x38c178(0x1c5)](_0x3090b4[_0x38c178(0x1a6)],_0x38c178(0x22a),{'text':_0x4ba41c,'to':_0x3090b4[_0x38c178(0x167)]}),_0x29231d++),_0x29231d;}async function setupTelegramListener(_0x397219){const _0x3d87a2=a0_0x5ce4da,_0x1aa84e=_0x397219[_0x3d87a2(0xc6)]['notifyTelegramInstance'];_0x397219['config'][_0x3d87a2(0x14c)]&&_0x1aa84e&&(_0x397219[_0x3d87a2(0xe1)]['info']('ðŸ“¡\x20Hooking\x20into\x20'+_0x1aa84e+_0x3d87a2(0xd7)),await _0x397219[_0x3d87a2(0x223)](_0x1aa84e+_0x3d87a2(0x207)));}async function handleTelegramResponse(_0x2a8eb2,_0x554652){const _0x3125ca=a0_0x5ce4da;let _0x3daba7=_0x554652;_0x554652[_0x3125ca(0x1c6)]('[')&&(_0x3daba7=_0x554652[_0x3125ca(0x151)](_0x554652[_0x3125ca(0x184)](']')+0x1));if(_0x3daba7===_0x3125ca(0x255))_0x2a8eb2[_0x3125ca(0xe1)][_0x3125ca(0x161)](_0x3125ca(0xf6)),await _0x2a8eb2[_0x3125ca(0xf9)](_0x3125ca(0x218),{'val':![],'ack':!![]}),await _0x2a8eb2[_0x3125ca(0xf9)](_0x3125ca(0xc4),{'val':_0x3125ca(0x1b8),'ack':!![]}),_0x2a8eb2[_0x3125ca(0x24a)]=![],sendNotification(_0x2a8eb2,_0x3125ca(0xc0),![]);else _0x3daba7===_0x3125ca(0xff)&&(_0x2a8eb2['log'][_0x3125ca(0x216)](_0x3125ca(0x230)),sendNotification(_0x2a8eb2,_0x3125ca(0x274),![],!![]));}async function runAutopilot(_0x18a89f){const _0x2289d7=a0_0x5ce4da,_0x25d515=_0x18a89f['config'][_0x2289d7(0x2b4)],_0xea3dbc=_0x18a89f[_0x2289d7(0x19b)][_0x2289d7(0x153)]>0x0?_0x18a89f[_0x2289d7(0x19b)][0x0][_0x2289d7(0x29b)]:Date[_0x2289d7(0xe5)](),_0x3cdc1e=(Date[_0x2289d7(0xe5)]()-_0xea3dbc)/(0x3e8*0x3c*0x3c);let _0x3e1e21='';_0x18a89f[_0x2289d7(0xc6)]['inactivityMonitoringEnabled']&&_0x18a89f[_0x2289d7(0x128)]===SYSTEM_MODES[_0x2289d7(0x299)]&&_0x18a89f['isPresent']&&(_0x3cdc1e>_0x25d515&&(_0x3e1e21=_0x2289d7(0xe8)+_0x3cdc1e[_0x2289d7(0x1c8)](0x1)+_0x2289d7(0x144))),runGeminiAnalysis(_0x18a89f,_0x3e1e21)[_0x2289d7(0x1bb)](_0x35e58a=>_0x18a89f[_0x2289d7(0xe1)][_0x2289d7(0xc1)](_0x35e58a));}async function createDailyDigest(_0x20da54){const _0x147e5a=a0_0x5ce4da;if(!_0x20da54['isProVersion'])return;await _0x20da54[_0x147e5a(0xf9)](LTM_DP_STATUS,{'val':_0x147e5a(0x1b2)+new Date()[_0x147e5a(0x2ab)](),'ack':!![]});if(!_0x20da54[_0x147e5a(0x1cf)]||_0x20da54['rawEventLog'][_0x147e5a(0x153)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x20da54[_0x147e5a(0xf9)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x3e7a9c=JSON[_0x147e5a(0x113)](JSON[_0x147e5a(0x19a)](_0x20da54[_0x147e5a(0x273)])),_0x374b5d=_0x3e7a9c[_0x147e5a(0x153)],_0x14b9ec='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x147e5a(0x19a)](_0x3e7a9c);try{const _0xda8833=await _0x20da54[_0x147e5a(0x1cf)][_0x147e5a(0x24b)](_0x14b9ec),_0x242139=JSON[_0x147e5a(0x113)](_0xda8833['response'][_0x147e5a(0x12c)]()[_0x147e5a(0x172)](/```json|```/g,'')['trim']());_0x242139[_0x147e5a(0x266)]&&(_0x20da54[_0x147e5a(0x262)]['push']({'timestamp':new Date()[_0x147e5a(0x1c7)](),'eventCount':_0x374b5d,'summary':_0x242139[_0x147e5a(0x266)],'activityLevel':_0x242139['activityLevel'],'systemMode':_0x20da54[_0x147e5a(0x128)]}),await saveDailyDigests(_0x20da54),_0x20da54[_0x147e5a(0x273)]=[],await saveRawEventLog(_0x20da54),await _0x20da54[_0x147e5a(0xf9)](LTM_DP_STATUS,{'val':_0x147e5a(0x275)+_0x374b5d+_0x147e5a(0x243),'ack':!![]}),runPythonHealthCheck(_0x20da54));}catch(_0x31338a){await _0x20da54['setStateAsync'](LTM_DP_STATUS,{'val':_0x147e5a(0x191)+_0x31338a[_0x147e5a(0x101)],'ack':!![]});}}async function sendMorningBriefing(_0x5b1ddd){const _0x3ed917=a0_0x5ce4da;if(!_0x5b1ddd[_0x3ed917(0x1cf)])return;_0x5b1ddd[_0x3ed917(0xe1)][_0x3ed917(0x161)](_0x3ed917(0xf0));const _0x19f7c5=_0x5b1ddd['dailyDigests'][_0x3ed917(0x153)]>0x0?_0x5b1ddd['dailyDigests'][_0x5b1ddd[_0x3ed917(0x262)]['length']-0x1]:null,_0x4accd6=_0x19f7c5&&_0x19f7c5['health']?_0x19f7c5['health'][_0x3ed917(0x13e)]:_0x3ed917(0x186),_0xabaeb4=new Date();_0xabaeb4[_0x3ed917(0x25d)](0x4,0x0,0x0,0x0);const _0x1573f3=_0x5b1ddd[_0x3ed917(0x19b)][_0x3ed917(0x258)](_0x2ad4d8=>new Date(_0x2ad4d8[_0x3ed917(0x29b)])>_0xabaeb4),_0x510778=PERSONA_MAPPING[_0x5b1ddd[_0x3ed917(0xc6)][_0x3ed917(0x1e6)]||_0x3ed917(0x226)],_0x481abf=_0x5b1ddd[_0x3ed917(0xc6)][_0x3ed917(0xf8)]||'',_0x213b7c=await getWeatherContext(_0x5b1ddd),_0x339315=await getCalendarContext(_0x5b1ddd),_0x1b1560=_0x3ed917(0x154)+_0x510778+'.\x20KONTEXT:\x20'+_0x481abf+_0x3ed917(0x14d)+_0x213b7c+'\x20'+_0x339315+'.\x20DATEN:\x20Schlaf\x20'+_0x4accd6+_0x3ed917(0xba)+JSON[_0x3ed917(0x19a)](_0x1573f3[_0x3ed917(0xbd)](0x0,0xa))+_0x3ed917(0x19d);try{const _0x44987f=await _0x5b1ddd[_0x3ed917(0x1cf)][_0x3ed917(0x24b)](_0x1b1560),_0x427d07=_0x3ed917(0x285)+_0x44987f[_0x3ed917(0x1e0)]['text']()[_0x3ed917(0x293)]();sendNotification(_0x5b1ddd,_0x427d07),_0x5b1ddd[_0x3ed917(0xe1)][_0x3ed917(0x161)]('Morning\x20Briefing\x20sent.');}catch(_0x5792b5){_0x5b1ddd[_0x3ed917(0xe1)][_0x3ed917(0xc1)](_0x3ed917(0x25a)+_0x5792b5[_0x3ed917(0x101)]);}}async function scanForDevices(_0x6b9f46,_0x296b73){const _0x3e2279=a0_0x5ce4da;_0x6b9f46[_0x3e2279(0xe1)][_0x3e2279(0x161)](_0x3e2279(0x11a));const _0x215301=[],_0x31d702=await _0x6b9f46[_0x3e2279(0x126)]('*'),_0x2db166=await _0x6b9f46['getForeignObjectsAsync'](_0x3e2279(0xbc),_0x3e2279(0x183)),_0x35fcee=await _0x6b9f46['getForeignObjectsAsync'](_0x3e2279(0x200),_0x3e2279(0x183)),_0x2bd3f7={};if(_0x2db166)for(const _0x44ba84 in _0x2db166){const _0x4c1ad3=_0x2db166[_0x44ba84]['common'][_0x3e2279(0x15d)]||[];_0x4c1ad3[_0x3e2279(0x259)](_0x41d65f=>{const _0xd61f65=_0x3e2279;if(!_0x2bd3f7[_0x41d65f])_0x2bd3f7[_0x41d65f]=[];_0x2bd3f7[_0x41d65f][_0xd61f65(0x10c)](_0x44ba84);});}const _0x2a2ab5={};if(_0x35fcee)for(const _0x2ffc4a in _0x35fcee){const _0x2d1978=_0x35fcee[_0x2ffc4a][_0x3e2279(0xb5)][_0x3e2279(0x15d)]||[],_0x3cbe6e=typeof _0x35fcee[_0x2ffc4a][_0x3e2279(0xb5)][_0x3e2279(0x118)]==='object'?_0x35fcee[_0x2ffc4a][_0x3e2279(0xb5)][_0x3e2279(0x118)]['de']:_0x35fcee[_0x2ffc4a][_0x3e2279(0xb5)][_0x3e2279(0x118)];_0x2d1978[_0x3e2279(0x259)](_0x2bf3ca=>_0x2a2ab5[_0x2bf3ca]=_0x3cbe6e);}const _0x4253c0=_0x296b73[_0x3e2279(0x2ba)]||[],_0x48b279=_0x296b73[_0x3e2279(0x233)]!==![],_0x47754e=_0x296b73[_0x3e2279(0x1ac)]!==![],_0x4f2d5b=_0x296b73[_0x3e2279(0x141)]!==![],_0x365654=_0x296b73[_0x3e2279(0x23e)]===!![],_0x47e9a3=_0x296b73[_0x3e2279(0x2ae)]===!![];for(const _0x2a7927 in _0x31d702){const _0x400b90=_0x31d702[_0x2a7927];if(_0x400b90[_0x3e2279(0x1ba)]!==_0x3e2279(0xb7)||!_0x400b90['common'])continue;if(ADAPTER_BLACKLIST[_0x3e2279(0xe4)](_0x288c41=>_0x2a7927[_0x3e2279(0x1c6)](_0x288c41))&&!_0x47e9a3)continue;const _0x1b572f=(_0x400b90['common']['role']||'')[_0x3e2279(0x1cc)]();let _0x278e6b=(typeof _0x400b90[_0x3e2279(0xb5)][_0x3e2279(0x118)]===_0x3e2279(0x1fa)?_0x400b90[_0x3e2279(0xb5)][_0x3e2279(0x118)]['de']:_0x400b90[_0x3e2279(0xb5)][_0x3e2279(0x118)])||_0x2a7927;const _0x130948=_0x278e6b['toLowerCase']();let _0x3cb0f7=![],_0x100803=![];if(_0x4253c0[_0x3e2279(0x153)]>0x0){const _0x3a5eb7=_0x2bd3f7[_0x2a7927]||[],_0x56691f=_0x2a7927[_0x3e2279(0xbe)]('.')[_0x3e2279(0xbd)](0x0,-0x1)['join']('.'),_0x4f1791=_0x2bd3f7[_0x56691f]||[];(_0x3a5eb7[_0x3e2279(0xe4)](_0x1f64e2=>_0x4253c0['includes'](_0x1f64e2))||_0x4f1791[_0x3e2279(0xe4)](_0x4fe10a=>_0x4253c0[_0x3e2279(0x272)](_0x4fe10a)))&&(_0x3cb0f7=!![],_0x100803=!![]);}if(!_0x3cb0f7&&!_0x47e9a3){if(HARD_IGNORE_TERMS['some'](_0x473360=>_0x2a7927[_0x3e2279(0x272)](_0x473360)||_0x130948[_0x3e2279(0x272)](_0x473360['toLowerCase']())))continue;}if(BAD_NAMES[_0x3e2279(0xe4)](_0x50fe53=>_0x130948===_0x50fe53||_0x130948['endsWith']('.'+_0x50fe53))){const _0x3df449=_0x2a7927['split']('.');if(_0x3df449[_0x3e2279(0x153)]>0x2){const _0xbba2f1=_0x3df449[_0x3e2279(0xbd)](0x0,-0x1)[_0x3e2279(0x11f)]('.'),_0x2f9cf1=_0x31d702[_0xbba2f1];if(_0x2f9cf1&&_0x2f9cf1[_0x3e2279(0xb5)]&&_0x2f9cf1[_0x3e2279(0xb5)][_0x3e2279(0x118)]){const _0x4a328f=typeof _0x2f9cf1[_0x3e2279(0xb5)][_0x3e2279(0x118)]===_0x3e2279(0x1fa)?_0x2f9cf1[_0x3e2279(0xb5)]['name']['de']:_0x2f9cf1[_0x3e2279(0xb5)]['name'];_0x4a328f&&!_0x278e6b[_0x3e2279(0x272)](_0x4a328f)&&(_0x278e6b=_0x4a328f+'\x20'+_0x278e6b);}}}let _0x1914bc='';if(_0x48b279&&(_0x1b572f[_0x3e2279(0x272)]('motion')||_0x1b572f['includes']('occupancy')||_0x130948['includes'](_0x3e2279(0xf5))||_0x130948[_0x3e2279(0x272)](_0x3e2279(0x2a1))))_0x1914bc=_0x3e2279(0x233);else{if(!_0x1914bc&&_0x47754e&&(_0x1b572f[_0x3e2279(0x272)]('door')||_0x1b572f['includes']('window')||_0x1b572f['includes']('lock')||_0x1b572f[_0x3e2279(0x272)]('blind')||_0x1b572f[_0x3e2279(0x272)]('shutter')||_0x130948[_0x3e2279(0x272)](_0x3e2279(0x234))||_0x130948[_0x3e2279(0x272)](_0x3e2279(0x27b))||_0x130948[_0x3e2279(0x272)](_0x3e2279(0x11e))))_0x1914bc=_0x3e2279(0x29e);else{if(!_0x1914bc&&_0x4f2d5b&&(_0x1b572f[_0x3e2279(0x272)](_0x3e2279(0xd2))||_0x1b572f[_0x3e2279(0x272)]('switch')||_0x1b572f['includes']('dimmer')||_0x130948[_0x3e2279(0x272)]('licht')||_0x130948[_0x3e2279(0x272)]('lampe')||_0x130948[_0x3e2279(0x272)](_0x3e2279(0x15e)))){if(_0x400b90[_0x3e2279(0xb5)][_0x3e2279(0x2c0)]||_0x1b572f[_0x3e2279(0x272)](_0x3e2279(0x152)))_0x1914bc=_0x3e2279(0xd2);}else{if(!_0x1914bc&&_0x365654&&(_0x1b572f[_0x3e2279(0x272)](_0x3e2279(0x23e))||_0x1b572f[_0x3e2279(0x272)](_0x3e2279(0x241))||_0x1b572f[_0x3e2279(0x272)](_0x3e2279(0x181))||_0x130948[_0x3e2279(0x272)]('temp')||_0x130948['includes'](_0x3e2279(0x16d))||_0x130948[_0x3e2279(0x272)](_0x3e2279(0xcd))))_0x1914bc=_0x3e2279(0x23e);else{if(!_0x1914bc&&_0x100803)_0x1914bc='custom';}}}}if(_0x1914bc){let _0x160e28=_0x2a2ab5[_0x2a7927]||'';if(!_0x160e28){let _0x3cf06e=_0x2a7927;for(let _0x344fee=0x0;_0x344fee<0x3;_0x344fee++){const _0x871d11=_0x3cf06e['lastIndexOf']('.');if(_0x871d11===-0x1)break;_0x3cf06e=_0x3cf06e[_0x3e2279(0x151)](0x0,_0x871d11);if(_0x2a2ab5[_0x3cf06e]){_0x160e28=_0x2a2ab5[_0x3cf06e];break;}}}_0x215301['push']({'id':_0x2a7927,'name':_0x278e6b,'location':_0x160e28,'type':_0x1914bc,'logDuplicates':_0x1914bc===_0x3e2279(0x233),'isExit':![],'_score':_0x160e28?0x50:_0x1914bc===_0x3e2279(0x1b4)?0x5a:0x28});}}return _0x215301[_0x3e2279(0x12f)]((_0x244261,_0x1b61ee)=>_0x1b61ee['_score']-_0x244261['_score']),_0x215301;}async function executeAutomationAction(_0x3b88be){const _0x5d0d74=a0_0x5ce4da;try{const _0x204b76=await _0x3b88be[_0x5d0d74(0x1b0)](_0x5d0d74(0x124)),_0x1c35cd=await _0x3b88be[_0x5d0d74(0x1b0)]('analysis.automation.targetValue');if(_0x204b76&&_0x204b76[_0x5d0d74(0x2bf)]&&_0x1c35cd){const _0x2dbf6d=_0x204b76[_0x5d0d74(0x2bf)];let _0x40340a=_0x1c35cd[_0x5d0d74(0x2bf)];try{_0x40340a=JSON[_0x5d0d74(0x113)](_0x40340a);}catch(_0x13bbd3){}_0x3b88be[_0x5d0d74(0xe1)]['info'](_0x5d0d74(0x197)+_0x2dbf6d+'\x20=\x20'+_0x40340a),await _0x3b88be[_0x5d0d74(0x1d5)](_0x2dbf6d,_0x40340a);}else _0x3b88be[_0x5d0d74(0xe1)][_0x5d0d74(0x216)](_0x5d0d74(0x192));}catch(_0x45030e){_0x3b88be['log'][_0x5d0d74(0xc1)](_0x5d0d74(0x280)+_0x45030e[_0x5d0d74(0x101)]);}}function tryParse(_0x103161){const _0x161ae8=a0_0x5ce4da;try{return JSON[_0x161ae8(0x113)](_0x103161);}catch(_0x1de465){return null;}}async function recordSequence(_0x3e11c4,_0x23236b){const _0x1ce19c=a0_0x5ce4da,_0x1ecac2=(_0x23236b['type']||'')[_0x1ce19c(0x1cc)](),_0x46acd3=['motion','bewegung',_0x1ce19c(0x2a1),'presence',_0x1ce19c(0x24f),_0x1ce19c(0x29e),_0x1ce19c(0x27b),_0x1ce19c(0x1f7),_0x1ce19c(0x234),_0x1ce19c(0x22d),_0x1ce19c(0x27e),_0x1ce19c(0xd2),_0x1ce19c(0x2af),_0x1ce19c(0x261),_0x1ce19c(0x15e),'dimmer',_0x1ce19c(0x1df)];if(!_0x46acd3[_0x1ce19c(0xe4)](_0x2d761b=>_0x1ecac2['includes'](_0x2d761b))){_0x3e11c4[_0x1ce19c(0xe1)][_0x1ce19c(0xcc)](_0x1ce19c(0x29f)+_0x23236b['id']+_0x1ce19c(0x28f)+_0x23236b[_0x1ce19c(0x1ba)]+_0x1ce19c(0x17d));return;}if(!_0x23236b[_0x1ce19c(0x2b8)]){_0x3e11c4['log'][_0x1ce19c(0xcc)](_0x1ce19c(0x29f)+_0x23236b['id']+_0x1ce19c(0x278)+_0x23236b['value']+')');return;}_0x3e11c4['log'][_0x1ce19c(0xcc)](_0x1ce19c(0x1db)+_0x23236b['id']+'\x20('+_0x23236b['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x390c47={'loc':_0x23236b[_0x1ce19c(0x2ad)]||_0x1ce19c(0x27c),'id':_0x23236b['id'],'ts':Date[_0x1ce19c(0xe5)]()};activeSequence['push'](_0x390c47),_0x3e11c4['log'][_0x1ce19c(0xcc)](_0x1ce19c(0x185)+_0x390c47['loc']+_0x1ce19c(0x2b7)+activeSequence['length']+')'),sequenceTimer=setTimeout(async()=>{const _0x2296db=_0x1ce19c;activeSequence[_0x2296db(0x153)]>0x1?await saveCompletedSequence(_0x3e11c4):(_0x3e11c4[_0x2296db(0xe1)][_0x2296db(0xcc)](_0x2296db(0x143)+activeSequence[_0x2296db(0x153)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x367633){const _0x484aab=a0_0x5ce4da;try{_0x367633[_0x484aab(0xe1)][_0x484aab(0x161)](_0x484aab(0xcb)+activeSequence[_0x484aab(0x153)]+').\x20Saving\x20to\x20Training\x20Data.');const _0x26efe7=await _0x367633[_0x484aab(0x1b0)]('LTM.trainingData.sequences');let _0x457034=[];if(_0x26efe7&&_0x26efe7['val'])try{_0x457034=JSON[_0x484aab(0x113)](_0x26efe7['val']);}catch(_0x47d69c){}const _0x433b8d=activeSequence[0x0]['ts'],_0x1825ea=activeSequence['map'](_0x451c41=>({'loc':_0x451c41['loc'],'t_delta':Math[_0x484aab(0x202)]((_0x451c41['ts']-_0x433b8d)/0x3e8)})),_0x45181d={'timestamp':new Date(_0x433b8d)[_0x484aab(0x1c7)](),'steps':_0x1825ea,'duration':Math[_0x484aab(0x202)]((activeSequence[activeSequence[_0x484aab(0x153)]-0x1]['ts']-_0x433b8d)/0x3e8),'daytime':new Date(_0x433b8d)[_0x484aab(0xc8)]()};_0x457034[_0x484aab(0x10c)](_0x45181d),_0x457034['length']>MAX_TRAINING_SET_SIZE&&_0x457034[_0x484aab(0xec)](),await _0x367633[_0x484aab(0xf9)](_0x484aab(0x1a5),{'val':JSON[_0x484aab(0x19a)](_0x457034),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x1e1201){_0x367633[_0x484aab(0xe1)][_0x484aab(0xc1)](_0x484aab(0x170)+_0x1e1201[_0x484aab(0x101)]);}}async function getOutsideTemperatureNumeric(_0x29ba8e){const _0x3018b2=a0_0x5ce4da;if(_0x29ba8e[_0x3018b2(0xc6)][_0x3018b2(0x1ea)])try{const _0x1d5de7=await _0x29ba8e[_0x3018b2(0x2bb)](_0x29ba8e[_0x3018b2(0xc6)][_0x3018b2(0x1ea)]);if(_0x1d5de7&&_0x1d5de7['val']!==undefined&&_0x1d5de7['val']!==null){const _0x3e8294=parseFloat(_0x1d5de7[_0x3018b2(0x2bf)]);if(!isNaN(_0x3e8294))return _0x3e8294;}}catch(_0x5bed80){_0x29ba8e[_0x3018b2(0xe1)][_0x3018b2(0x216)](_0x3018b2(0x190)+_0x29ba8e[_0x3018b2(0xc6)][_0x3018b2(0x1ea)]+':\x20'+_0x5bed80[_0x3018b2(0x101)]);}const _0x1c7786=_0x29ba8e[_0x3018b2(0xc6)][_0x3018b2(0x1f3)];if(!_0x29ba8e[_0x3018b2(0xc6)][_0x3018b2(0x232)]||!_0x1c7786)return null;try{let _0x595ede='';if(_0x1c7786[_0x3018b2(0x272)]('accuweather'))_0x595ede=_0x1c7786+_0x3018b2(0x2be);else{if(_0x1c7786[_0x3018b2(0x272)](_0x3018b2(0x163)))_0x595ede=_0x1c7786+_0x3018b2(0x120);else{if(_0x1c7786['includes']('openweathermap'))_0x595ede=_0x1c7786+_0x3018b2(0x116);else{if(_0x1c7786[_0x3018b2(0x272)](_0x3018b2(0x27f)))_0x595ede=_0x1c7786+'.forecast.current.temp';}}}if(_0x595ede){const _0x443486=await _0x29ba8e['getForeignStateAsync'](_0x595ede);if(_0x443486&&_0x443486[_0x3018b2(0x2bf)]!==undefined&&_0x443486[_0x3018b2(0x2bf)]!==null)return parseFloat(_0x443486[_0x3018b2(0x2bf)]);}}catch(_0x110aa1){}return null;}async function recordThermodynamics(_0x394f2,_0x1e5991,_0x116cf4,_0x409560){const _0x431f75=a0_0x5ce4da,_0x4dad3a=await getOutsideTemperatureNumeric(_0x394f2),_0x62f68=await _0x394f2[_0x431f75(0x1b0)](_0x431f75(0x21c));let _0x20d325=[];if(_0x62f68&&_0x62f68[_0x431f75(0x2bf)])try{_0x20d325=JSON['parse'](_0x62f68['val']);}catch(_0x33398c){}_0x20d325[_0x431f75(0x10c)]({'ts':Date[_0x431f75(0xe5)](),'room':_0x409560||_0x431f75(0x27c),'t_in':_0x116cf4,'t_out':_0x4dad3a});if(_0x20d325[_0x431f75(0x153)]>THERMO_LOG_SIZE)_0x20d325['shift']();await _0x394f2[_0x431f75(0xf9)]('LTM.trainingData.thermodynamics',{'val':JSON['stringify'](_0x20d325),'ack':!![]});}async function processSensorEvent(_0x5e3f06,_0x3a1187,_0x265473,_0x249290){const _0x56af7d=a0_0x5ce4da;if(!_0x249290)return;const _0x47fc7e=_0x265473['val'],_0x264097=Date[_0x56af7d(0xe5)]();_0x5e3f06[_0x56af7d(0xe1)][_0x56af7d(0xcc)](_0x56af7d(0x1dc)+_0x3a1187+'\x20=\x20'+_0x47fc7e);const _0x2d0034=_0x5e3f06[_0x56af7d(0x149)][_0x3a1187];_0x5e3f06['sensorLastValues'][_0x3a1187]=_0x47fc7e;if(!_0x249290[_0x56af7d(0x142)]&&_0x2d0034!=undefined&&_0x2d0034==_0x47fc7e){_0x5e3f06[_0x56af7d(0xe1)][_0x56af7d(0xcc)](_0x56af7d(0x277)+_0x249290[_0x56af7d(0x118)]+_0x56af7d(0x23b)+_0x47fc7e+')');return;}_0x5e3f06[_0x56af7d(0x20c)]&&_0x249290['type']===_0x56af7d(0x23e)&&recordThermodynamics(_0x5e3f06,_0x3a1187,_0x47fc7e,_0x249290['location']);const _0x5cd12a={'timestamp':_0x264097,'id':_0x3a1187,'name':_0x249290[_0x56af7d(0x118)],'type':_0x249290[_0x56af7d(0x1ba)],'location':_0x249290[_0x56af7d(0x2ad)],'value':_0x47fc7e};_0x5e3f06[_0x56af7d(0x19b)][_0x56af7d(0x138)](_0x5cd12a);if(_0x5e3f06[_0x56af7d(0x19b)]['length']>HISTORY_MAX_SIZE)_0x5e3f06['eventHistory'][_0x56af7d(0x110)]();await _0x5e3f06['setStateAsync']('events.lastEvent',{'val':JSON[_0x56af7d(0x19a)](_0x5cd12a),'ack':!![]}),await _0x5e3f06['setStateAsync'](_0x56af7d(0xb6),{'val':JSON[_0x56af7d(0x19a)](_0x5e3f06['eventHistory']),'ack':!![]});_0x5e3f06[_0x56af7d(0x20c)]&&(_0x5e3f06[_0x56af7d(0x273)][_0x56af7d(0x10c)](_0x5cd12a),await saveRawEventLog(_0x5e3f06),recordSequence(_0x5e3f06,_0x5cd12a));if(_0x249290[_0x56af7d(0x132)]&&_0x47fc7e===!![]){if(_0x5e3f06[_0x56af7d(0xb3)]&&!_0x5e3f06[_0x56af7d(0x1e5)])_0x5e3f06[_0x56af7d(0xe1)][_0x56af7d(0x161)](_0x56af7d(0x1ff)+_0x249290[_0x56af7d(0x118)]+_0x56af7d(0x242)),startExitTimer(_0x5e3f06);else!_0x5e3f06[_0x56af7d(0xb3)]&&(_0x5e3f06[_0x56af7d(0xe1)]['info'](_0x56af7d(0x199)+_0x249290[_0x56af7d(0x118)]+_0x56af7d(0x1a4)),await setPresence(_0x5e3f06,!![]));}else _0x249290[_0x56af7d(0x1ba)]==='motion'&&_0x47fc7e===!![]&&(_0x5e3f06[_0x56af7d(0x10b)]&&(_0x5e3f06[_0x56af7d(0xe1)][_0x56af7d(0x161)](_0x56af7d(0x133)),abortExitTimer(_0x5e3f06)),!_0x5e3f06[_0x56af7d(0xb3)]&&_0x5e3f06['currentSystemMode']===SYSTEM_MODES[_0x56af7d(0x299)]&&await setPresence(_0x5e3f06,!![]));}async function runGeminiAnalysis(_0x3532d2,_0x22dd59=''){const _0x2ca2e8=a0_0x5ce4da;if(!_0x3532d2[_0x2ca2e8(0x1cf)])return;if(_0x3532d2[_0x2ca2e8(0x19b)]['length']===0x0)return;const _0x1cf3aa=_0x3532d2[_0x2ca2e8(0x19b)][_0x2ca2e8(0xbd)](0x0,0xf),_0x4b5e80=await getWeatherContext(_0x3532d2),_0x48d14d=_0x3532d2['currentSystemMode'],_0x1277fb=PERSONA_MAPPING[_0x3532d2[_0x2ca2e8(0xc6)][_0x2ca2e8(0x1e6)]||'generic'],_0x29b358=_0x3532d2[_0x2ca2e8(0xc6)]['livingContext']||_0x2ca2e8(0x24e);let _0x1744c1=![];try{const _0x3a1b38=await _0x3532d2['getStateAsync'](_0x2ca2e8(0x23f));if(_0x3a1b38&&_0x3a1b38[_0x2ca2e8(0x2bf)])_0x1744c1=!![];}catch(_0x21ac6b){}const _0x319176='\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20'+_0x1277fb+_0x2ca2e8(0x28d)+_0x29b358+_0x2ca2e8(0x15a)+_0x48d14d+_0x2ca2e8(0x224)+_0x4b5e80+_0x2ca2e8(0x21a)+(_0x22dd59||_0x2ca2e8(0x24c))+_0x2ca2e8(0x1f1)+JSON[_0x2ca2e8(0x19a)](_0x1cf3aa)+_0x2ca2e8(0xef);try{const _0x364f6b=await _0x3532d2[_0x2ca2e8(0x1cf)][_0x2ca2e8(0x24b)](_0x319176),_0x5413c7=_0x364f6b[_0x2ca2e8(0x1e0)]['text']()[_0x2ca2e8(0x172)](/```json|```/g,'')[_0x2ca2e8(0x293)](),_0x5ec383=JSON[_0x2ca2e8(0x113)](_0x5413c7);await _0x3532d2['setStateAsync']('analysis.lastResult',{'val':JSON['stringify'](_0x5ec383),'ack':!![]});_0x5ec383[_0x2ca2e8(0x266)]&&await _0x3532d2[_0x2ca2e8(0xf9)]('analysis.activitySummary',{'val':_0x5ec383[_0x2ca2e8(0x266)],'ack':!![]});const _0x274f16={'timestamp':Date[_0x2ca2e8(0xe5)](),'id':Date['now']()[_0x2ca2e8(0xb4)](),'analysis':{'activity':{'summary':_0x5ec383[_0x2ca2e8(0x266)]||'Keine\x20Analyse.','isAlert':_0x5ec383[_0x2ca2e8(0x283)]||![],'alertReason':_0x5ec383[_0x2ca2e8(0x1af)]},'comfort':{'automationProposal':_0x5ec383[_0x2ca2e8(0x156)]}}};await updateAnalysisHistory(_0x3532d2,_0x274f16);const _0x17af54=_0x5ec383[_0x2ca2e8(0x283)]||![];_0x17af54!==_0x3532d2[_0x2ca2e8(0x24a)]&&(await _0x3532d2[_0x2ca2e8(0xf9)](_0x2ca2e8(0x218),{'val':_0x17af54,'ack':!![]}),_0x3532d2[_0x2ca2e8(0x24a)]=_0x17af54,_0x17af54&&(await _0x3532d2[_0x2ca2e8(0xf9)](_0x2ca2e8(0xc4),{'val':_0x5ec383[_0x2ca2e8(0x1af)],'ack':!![]}),sendNotification(_0x3532d2,_0x2ca2e8(0x122)+_0x5ec383[_0x2ca2e8(0x1af)],![],_0x5ec383[_0x2ca2e8(0x244)]))),_0x5ec383[_0x2ca2e8(0x156)]&&_0x5ec383[_0x2ca2e8(0x156)]['detected']&&_0x5ec383[_0x2ca2e8(0x156)][_0x2ca2e8(0x147)]&&(_0x3532d2[_0x2ca2e8(0xe1)][_0x2ca2e8(0x161)](_0x2ca2e8(0x250)+_0x5ec383[_0x2ca2e8(0x156)][_0x2ca2e8(0x1d9)]),await _0x3532d2[_0x2ca2e8(0xf9)](_0x2ca2e8(0x1ae),{'val':!![],'ack':!![]}),await _0x3532d2['setStateAsync'](_0x2ca2e8(0x1f9),{'val':_0x5ec383[_0x2ca2e8(0x156)][_0x2ca2e8(0x1d9)],'ack':!![]}),await _0x3532d2[_0x2ca2e8(0xf9)](_0x2ca2e8(0x124),{'val':_0x5ec383['automationProposal'][_0x2ca2e8(0x147)],'ack':!![]}),await _0x3532d2[_0x2ca2e8(0xf9)](_0x2ca2e8(0x228),{'val':JSON[_0x2ca2e8(0x19a)](_0x5ec383[_0x2ca2e8(0x156)][_0x2ca2e8(0x129)]),'ack':!![]}),_0x1744c1&&(_0x3532d2[_0x2ca2e8(0xe1)][_0x2ca2e8(0x161)]('ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20'+_0x5ec383[_0x2ca2e8(0x156)][_0x2ca2e8(0x147)]+_0x2ca2e8(0x19c)),await executeAutomationAction(_0x3532d2)));}catch(_0x1d688a){_0x3532d2[_0x2ca2e8(0xe1)][_0x2ca2e8(0xc1)](_0x2ca2e8(0x269)+_0x1d688a[_0x2ca2e8(0x101)]);}}function installPythonDependencies(_0x3a559d){const _0x28ca0c=a0_0x5ce4da;if(_0x3a559d['dependencyInstallInProgress'])return;_0x3a559d[_0x28ca0c(0x211)]=!![];const _0x2e15e6=path['join'](__dirname,'python_service',_0x28ca0c(0xd8));_0x3a559d[_0x28ca0c(0xe1)][_0x28ca0c(0x161)]('ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20'+_0x2e15e6+_0x28ca0c(0x19c)),stopPythonService(_0x3a559d);const _0x4c41ac=_0x28ca0c(0x22f)+_0x2e15e6+_0x28ca0c(0x1ec);exec(_0x4c41ac,(_0x10684f,_0x2c17b5,_0x2129ff)=>{const _0x298eb4=_0x28ca0c;_0x3a559d[_0x298eb4(0x211)]=![],_0x10684f?(_0x3a559d[_0x298eb4(0xe1)][_0x298eb4(0xc1)]('âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x4c41ac),_0x3a559d['log'][_0x298eb4(0xc1)](_0x298eb4(0x287)+(_0x2129ff||_0x10684f[_0x298eb4(0x101)]))):(_0x3a559d[_0x298eb4(0xe1)][_0x298eb4(0x161)]('âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...'),startPythonService(_0x3a559d));});}function sendToPython(_0x27ab50,_0x506c03,_0x4c296e={}){const _0x3b6742=a0_0x5ce4da;if(!_0x27ab50['pythonProcess']||!_0x27ab50['pythonProcess'][_0x3b6742(0x220)][_0x3b6742(0x140)])return;const _0x1b7c41=JSON['stringify']({'command':_0x506c03,..._0x4c296e});try{_0x27ab50[_0x3b6742(0x194)]['stdin'][_0x3b6742(0x2c0)](_0x1b7c41+'\x0a');}catch(_0x2914a5){_0x27ab50[_0x3b6742(0xe1)][_0x3b6742(0xc1)](_0x3b6742(0x239)+_0x2914a5['message']);}}function runPythonHealthCheck(_0x3d5563){const _0x22f165=a0_0x5ce4da;if(!_0x3d5563['dailyDigests']||_0x3d5563['dailyDigests'][_0x22f165(0x153)]<0x2){_0x3d5563[_0x22f165(0xe1)][_0x22f165(0x161)](_0x22f165(0x231));return;}const _0xb40751=_0x3d5563[_0x22f165(0x262)]['map'](_0xc6b6a0=>{const _0x356750=_0x22f165,_0x3e706b=(_0xc6b6a0['activityLevel']||'')[_0x356750(0x1cc)]();return ACTIVITY_LEVEL_MAP[_0x3e706b]||0x32;});_0x3d5563[_0x22f165(0xe1)][_0x22f165(0x161)](_0x22f165(0x2a9)+_0xb40751[_0x22f165(0x153)]+_0x22f165(0x1e9)),sendToPython(_0x3d5563,_0x22f165(0x2c2),{'values':_0xb40751,'tag':_0x22f165(0x26f)});}function handlePythonResult(_0x30101a,_0x113ff3){const _0x2f5287=a0_0x5ce4da;if(_0x113ff3[_0x2f5287(0x1ba)]===_0x2f5287(0x254))_0x30101a[_0x2f5287(0xe1)][_0x2f5287(0xcc)](_0x2f5287(0x209));else{if(_0x113ff3[_0x2f5287(0x1ba)]===_0x2f5287(0x20e)){const {tag:_0x3ad2a1,diagnosis:_0x3b3c7f,change_percent:_0x4b09de}=_0x113ff3[_0x2f5287(0xc3)];_0x30101a[_0x2f5287(0xe1)][_0x2f5287(0x161)](_0x2f5287(0x157)+_0x3ad2a1+_0x2f5287(0x297)+_0x3b3c7f+'\x20('+_0x4b09de+'%)'),_0x30101a[_0x2f5287(0xf9)]('analysis.health.trendDiagnosis',{'val':_0x3b3c7f,'ack':!![]}),_0x30101a[_0x2f5287(0xf9)](_0x2f5287(0x125),{'val':_0x4b09de,'ack':!![]});}}}function startPythonService(_0x4d4437){const _0x3a4e6d=a0_0x5ce4da;try{const _0x14283a=path[_0x3a4e6d(0x11f)](__dirname,_0x3a4e6d(0x2b2),_0x3a4e6d(0x115));_0x4d4437[_0x3a4e6d(0xe1)][_0x3a4e6d(0x161)](_0x3a4e6d(0x112)+_0x14283a),_0x4d4437[_0x3a4e6d(0x194)]=spawn(_0x3a4e6d(0x1be),[_0x14283a]),_0x4d4437[_0x3a4e6d(0x194)][_0x3a4e6d(0x102)]['on'](_0x3a4e6d(0xee),_0xbddf45=>{const _0x4fa1cb=_0x3a4e6d,_0x2491c0=_0xbddf45[_0x4fa1cb(0xb4)]()['split']('\x0a');_0x2491c0[_0x4fa1cb(0x259)](_0x3fbdd8=>{const _0x969a2e=_0x4fa1cb,_0x170877=_0x3fbdd8[_0x969a2e(0x293)]();if(!_0x170877)return;if(_0x170877[_0x969a2e(0x1c6)](_0x969a2e(0x188)))_0x4d4437[_0x969a2e(0xe1)][_0x969a2e(0xcc)](_0x969a2e(0xfc)+_0x170877[_0x969a2e(0x151)](0x5)[_0x969a2e(0x293)]());else{if(_0x170877[_0x969a2e(0x1c6)]('[RESULT]'))try{const _0x1cbea4=JSON['parse'](_0x170877[_0x969a2e(0x151)](0x8)[_0x969a2e(0x293)]());handlePythonResult(_0x4d4437,_0x1cbea4);}catch(_0x4f49a8){_0x4d4437[_0x969a2e(0xe1)]['warn'](_0x969a2e(0x109)+_0x170877);}}(_0x170877['includes'](_0x969a2e(0x215))||_0x170877['includes'](_0x969a2e(0x227)))&&(_0x4d4437[_0x969a2e(0xe1)]['warn'](_0x969a2e(0x1f4)),installPythonDependencies(_0x4d4437));});}),_0x4d4437[_0x3a4e6d(0x194)][_0x3a4e6d(0xf3)]['on'](_0x3a4e6d(0xee),_0x52e620=>{const _0x3eba2d=_0x3a4e6d,_0x253307=_0x52e620[_0x3eba2d(0xb4)]()['trim']();_0x4d4437[_0x3eba2d(0xe1)][_0x3eba2d(0xc1)](_0x3eba2d(0x15f)+_0x253307);}),_0x4d4437[_0x3a4e6d(0x194)]['on']('close',_0x5f72a2=>{const _0x494a58=_0x3a4e6d;_0x4d4437[_0x494a58(0xe1)][_0x494a58(0x161)](_0x494a58(0x284)+_0x5f72a2),_0x4d4437[_0x494a58(0x194)]=null;}),_0x4d4437['pythonProcess']['on']('error',_0x44b849=>{const _0x3b1f14=_0x3a4e6d;_0x4d4437['log'][_0x3b1f14(0x216)](_0x3b1f14(0x27d)+_0x44b849[_0x3b1f14(0x101)]);});}catch(_0x1869cb){_0x4d4437[_0x3a4e6d(0xe1)][_0x3a4e6d(0xc1)](_0x3a4e6d(0x127)+_0x1869cb[_0x3a4e6d(0x101)]);}}function stopPythonService(_0xb7ce88){const _0x5d6955=a0_0x5ce4da;if(_0xb7ce88[_0x5d6955(0x194)]){_0xb7ce88[_0x5d6955(0xe1)][_0x5d6955(0x161)]('ðŸ\x20Stopping\x20Python\x20Sidecar...');try{_0xb7ce88[_0x5d6955(0x194)][_0x5d6955(0x289)]();}catch(_0x44af3b){_0xb7ce88[_0x5d6955(0xe1)][_0x5d6955(0x216)](_0x5d6955(0x106)+_0x44af3b[_0x5d6955(0x101)]);}_0xb7ce88[_0x5d6955(0x194)]=null;}}class CogniLiving extends utils[a0_0x5ce4da(0x270)]{constructor(_0x34f703){const _0x341706=a0_0x5ce4da;super({..._0x34f703,'name':_0x341706(0x247)}),this[_0x341706(0x19b)]=[],this[_0x341706(0x108)]=[],this[_0x341706(0x2c4)]=[],this[_0x341706(0x273)]=[],this[_0x341706(0x262)]=[],this[_0x341706(0x149)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x341706(0xb3)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this[_0x341706(0x264)]=null,this[_0x341706(0x1cf)]=null,this[_0x341706(0x128)]=SYSTEM_MODES['NORMAL'],this[_0x341706(0x20c)]=![],this[_0x341706(0x24a)]=![],this[_0x341706(0x1fe)]='unknown',this['analysisTimer']=null,this[_0x341706(0x213)]=null,this[_0x341706(0x281)]=null,this[_0x341706(0x24d)]=null,this[_0x341706(0x295)]=null,this['pythonProcess']=null,this[_0x341706(0x211)]=![],this['on'](_0x341706(0xf7),this[_0x341706(0x28a)][_0x341706(0x177)](this)),this['on'](_0x341706(0x26c),this[_0x341706(0x131)][_0x341706(0x177)](this)),this['on'](_0x341706(0xd5),this[_0x341706(0x1b5)][_0x341706(0x177)](this)),this['on'](_0x341706(0x101),this[_0x341706(0x18a)][_0x341706(0x177)](this));}async[a0_0x5ce4da(0x28a)](){const _0xfc4eec=a0_0x5ce4da;this[_0xfc4eec(0xe1)]['info'](_0xfc4eec(0x107)+this[_0xfc4eec(0x104)]+')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE'),await initZombies(this),this[_0xfc4eec(0xc6)][_0xfc4eec(0xd1)]=this[_0xfc4eec(0xc6)][_0xfc4eec(0xd1)]||'';try{this[_0xfc4eec(0x20c)]=await checkLicense(this,this['config']['licenseKey']);}catch(_0x39e93d){}this['log']['info'](_0xfc4eec(0x114)+!!this[_0xfc4eec(0xc6)][_0xfc4eec(0xd1)]+'\x20|\x20Status:\x20'+(this[_0xfc4eec(0x20c)]?_0xfc4eec(0x198):_0xfc4eec(0x237)));if(!this[_0xfc4eec(0xc6)][_0xfc4eec(0x2b4)]||this[_0xfc4eec(0xc6)][_0xfc4eec(0x2b4)]<0.1)this[_0xfc4eec(0xc6)][_0xfc4eec(0x2b4)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config'][_0xfc4eec(0xd6)])try{this[_0xfc4eec(0x264)]=new GoogleGenerativeAI(this['config']['geminiApiKey']),this['geminiModel']=this[_0xfc4eec(0x264)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xfc4eec(0x18c)}}),this[_0xfc4eec(0xe1)][_0xfc4eec(0x161)](_0xfc4eec(0x1a2));}catch(_0xc75ee3){this[_0xfc4eec(0xe1)][_0xfc4eec(0xc1)]('Gemini\x20Init\x20Error:\x20'+_0xc75ee3['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0xfc4eec(0x168)](_0xfc4eec(0x2bc)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0xfc4eec(0x1a1)),this[_0xfc4eec(0x168)]('analysis.triggerBriefing'),this[_0xfc4eec(0x168)](_0xfc4eec(0x23d)),this[_0xfc4eec(0x168)](_0xfc4eec(0x23f)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0xfc4eec(0x296)])clearInterval(this[_0xfc4eec(0x296)]);const _0x20287c=this['config'][_0xfc4eec(0xbf)]||0xf;_0x20287c>0x0&&(this['log'][_0xfc4eec(0x161)](_0xfc4eec(0xbb)+_0x20287c+_0xfc4eec(0x176)),this[_0xfc4eec(0x296)]=setInterval(()=>{runAutopilot(this);},_0x20287c*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x11918b=_0xfc4eec;this[_0x11918b(0x194)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x5ce4da(0x1b5)](_0x271345){const _0x3f1d81=a0_0x5ce4da;if(this[_0x3f1d81(0x296)])clearInterval(this['analysisTimer']);if(this['driftAnalysisTimer'])clearInterval(this['driftAnalysisTimer']);if(this['ltmJob'])this[_0x3f1d81(0x213)][_0x3f1d81(0x245)]();if(this[_0x3f1d81(0x281)])this[_0x3f1d81(0x281)][_0x3f1d81(0x245)]();if(this[_0x3f1d81(0x295)])this[_0x3f1d81(0x295)][_0x3f1d81(0x245)]();if(this['exitTimer'])clearTimeout(this['exitTimer']);if(this[_0x3f1d81(0xdd)])clearTimeout(this[_0x3f1d81(0xdd)]);stopPythonService(this),_0x271345();}async['onStateChange'](_0x1415c7,_0x1138bc){const _0x95a1c7=a0_0x5ce4da;if(!_0x1138bc)return;if(_0x1415c7[_0x95a1c7(0x272)]('telegram')&&_0x1415c7['endsWith'](_0x95a1c7(0x1a0))&&_0x1138bc[_0x95a1c7(0x2bf)]){await handleTelegramResponse(this,_0x1138bc['val']);return;}if(_0x1415c7===this[_0x95a1c7(0x2b9)]+'.'+SYSTEM_DP_MODE){_0x1138bc[_0x95a1c7(0x2bf)]&&Object['values'](SYSTEM_MODES)[_0x95a1c7(0x272)](_0x1138bc[_0x95a1c7(0x2bf)])&&(this['currentSystemMode']=_0x1138bc[_0x95a1c7(0x2bf)],_0x1138bc[_0x95a1c7(0x2bf)]===SYSTEM_MODES[_0x95a1c7(0x2bd)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x1138bc[_0x95a1c7(0x1ad)])this[_0x95a1c7(0x26b)](_0x1415c7,{'val':this[_0x95a1c7(0x128)],'ack':!![]});return;}if(!_0x1138bc[_0x95a1c7(0x1ad)]){_0x1415c7['includes'](_0x95a1c7(0x2bc))&&_0x1138bc[_0x95a1c7(0x2bf)]&&(this[_0x95a1c7(0x26b)](_0x1415c7,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x1415c7['includes'](_0x95a1c7(0x22b))&&_0x1138bc[_0x95a1c7(0x2bf)]){this[_0x95a1c7(0x26b)](_0x1415c7,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x1415c7[_0x95a1c7(0x272)](_0x95a1c7(0x1dd))&&_0x1138bc['val']&&(this[_0x95a1c7(0x26b)](_0x1415c7,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x1415c7[_0x95a1c7(0x272)](_0x95a1c7(0x111))&&_0x1138bc['val']&&(this[_0x95a1c7(0x26b)](_0x1415c7,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x95a1c7(0xc6)][_0x95a1c7(0x1f6)]&&this[_0x95a1c7(0xc6)]['presenceDevices'][_0x95a1c7(0x272)](_0x1415c7)){await checkWifiPresence(this);return;}const _0x2be120=(this['config'][_0x95a1c7(0x21d)]||[])[_0x95a1c7(0x1d0)](_0x4d3bc8=>_0x4d3bc8['id']===_0x1415c7);if(_0x2be120)processSensorEvent(this,_0x1415c7,_0x1138bc,_0x2be120);}async[a0_0x5ce4da(0x18a)](_0x421e5f){const _0x18db41=a0_0x5ce4da;if(typeof _0x421e5f===_0x18db41(0x1fa)&&_0x421e5f[_0x18db41(0x101)])try{if(_0x421e5f[_0x18db41(0x221)]==='testApiKey'){const _0x2106e1=_0x421e5f[_0x18db41(0x101)]['apiKey']||this[_0x18db41(0xc6)][_0x18db41(0xd6)];if(!_0x2106e1)return this['sendTo'](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':![],'message':_0x18db41(0x251)},_0x421e5f[_0x18db41(0x252)]);try{const _0x3e012a=new GoogleGenerativeAI(_0x2106e1),_0x35143e=_0x3e012a[_0x18db41(0x2a3)]({'model':GEMINI_MODEL}),_0xf28771=await _0x35143e[_0x18db41(0x24b)](_0x18db41(0x11d)),_0x570af3=await _0xf28771[_0x18db41(0x1e0)],_0x37d669=_0x570af3['text']();this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f['command'],{'success':!![],'message':_0x18db41(0x1f8)+_0x37d669[_0x18db41(0x151)](0x0,0x14)+_0x18db41(0x19c)},_0x421e5f[_0x18db41(0x252)]);}catch(_0x41d75b){this['sendTo'](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':![],'message':_0x18db41(0x1c0)+_0x41d75b[_0x18db41(0x101)]},_0x421e5f[_0x18db41(0x252)]);}}else{if(_0x421e5f[_0x18db41(0x221)]===_0x18db41(0x103)){}else{if(_0x421e5f[_0x18db41(0x221)]===_0x18db41(0x22c)){if(!this[_0x18db41(0x20c)])return this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':![],'isPro':![]},_0x421e5f[_0x18db41(0x252)]);let _0x46c468={'status':_0x18db41(0x186),'details':'','lastCheck':0x0};try{_0x46c468[_0x18db41(0x1c3)]=(await this[_0x18db41(0x1b0)](LTM_DP_DRIFT_STATUS))[_0x18db41(0x2bf)],_0x46c468[_0x18db41(0x294)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x18db41(0x2bf)],_0x46c468[_0x18db41(0x1c1)]=(await this[_0x18db41(0x1b0)](LTM_DP_DRIFT_LAST_CHECK))[_0x18db41(0x2bf)];}catch(_0x65e294){}const _0x57e944=this[_0x18db41(0x108)]||[];this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x18db41(0x262)],'driftAnalysis':_0x46c468,'analysisHistory':_0x57e944},_0x421e5f['callback']);}else{if(_0x421e5f[_0x18db41(0x221)]===_0x18db41(0x267)){const _0x9350a4=this[_0x18db41(0x262)][_0x18db41(0x153)],_0x48d27c=new Date(),_0x2c2c57=new Date(_0x48d27c['getFullYear'](),_0x48d27c[_0x18db41(0x26e)](),_0x48d27c[_0x18db41(0xdb)]())[_0x18db41(0x1b1)](),_0x50d2fc=this[_0x18db41(0x273)]['filter'](_0x147606=>new Date(_0x147606[_0x18db41(0x29b)])[_0x18db41(0x1b1)]()>_0x2c2c57)['length'],_0x5ded98=new Array(0x18)[_0x18db41(0x187)](0x0);this[_0x18db41(0x273)][_0x18db41(0x259)](_0x4d8057=>{const _0x5c48be=_0x18db41,_0x56490e=new Date(_0x4d8057['timestamp']);if(_0x56490e[_0x5c48be(0x1b1)]()>_0x2c2c57)_0x5ded98[_0x56490e['getHours']()]++;});let _0x3c8695={'status':'N/A'};try{_0x3c8695[_0x18db41(0x1c3)]=(await this[_0x18db41(0x1b0)](LTM_DP_DRIFT_STATUS))[_0x18db41(0x2bf)];}catch(_0x99b352){}let _0x1bd897='';try{const _0x382f30=await this['getStateAsync'](_0x18db41(0x16e));_0x1bd897=_0x382f30?_0x382f30[_0x18db41(0x2bf)]:'';}catch(_0x4a295b){}let _0xd5adbb=null;!this[_0x18db41(0x1cf)]&&(_0xd5adbb=this[_0x18db41(0xc6)][_0x18db41(0xd6)]?_0x18db41(0x15b):_0x18db41(0xed));let _0x1e37e8={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x3abd6a=await this['getStateAsync'](_0x18db41(0x1ae)),_0x50d52f=await this[_0x18db41(0x1b0)](_0x18db41(0x1f9)),_0x4d40d5=await this[_0x18db41(0x1b0)](_0x18db41(0x124)),_0x2a22d0=await this[_0x18db41(0x1b0)](_0x18db41(0x228)),_0x2050e8=await this[_0x18db41(0x1b0)](_0x18db41(0x23f));_0x3abd6a&&_0x3abd6a['val']&&(_0x1e37e8[_0x18db41(0x1ee)]=!![],_0x1e37e8[_0x18db41(0x1d9)]=_0x50d52f?_0x50d52f[_0x18db41(0x2bf)]:'',_0x1e37e8[_0x18db41(0x147)]=_0x4d40d5?_0x4d40d5[_0x18db41(0x2bf)]:'',_0x1e37e8[_0x18db41(0x129)]=_0x2a22d0?_0x2a22d0[_0x18db41(0x2bf)]:''),_0x1e37e8[_0x18db41(0x219)]=_0x2050e8?!!_0x2050e8['val']:![];}catch(_0x4349e1){}this['sendTo'](_0x421e5f[_0x18db41(0xde)],_0x421e5f['command'],{'success':!![],'eventHistory':this[_0x18db41(0x19b)][_0x18db41(0xbd)](0x0,0xf),'stats':{'digestCount':_0x9350a4,'eventCountToday':_0x50d2fc,'hourlyActivity':_0x5ded98,'driftStatus':_0x3c8695[_0x18db41(0x1c3)],'isPresent':this[_0x18db41(0xb3)],'presenceWho':_0x1bd897,'minDays':this[_0x18db41(0xc6)][_0x18db41(0x17f)]||0x7,'stbDays':this[_0x18db41(0xc6)][_0x18db41(0xf4)]||0xe,'ltbDays':this['config']['ltmLtbWindowDays']||0x3c,'systemError':_0xd5adbb},'automation':_0x1e37e8},_0x421e5f[_0x18db41(0x252)]);}else{if(_0x421e5f[_0x18db41(0x221)]==='getEnums'){const _0x134b09=await this[_0x18db41(0x126)]('enum.functions.*',_0x18db41(0x183)),_0x4a240f=[];if(_0x134b09)for(const _0x3c055f in _0x134b09){const _0x34b851=_0x134b09[_0x3c055f],_0x3b1165=(_0x34b851[_0x18db41(0xb5)]&&typeof _0x34b851['common']['name']===_0x18db41(0x1fa)?_0x34b851[_0x18db41(0xb5)]['name']['de']:_0x34b851[_0x18db41(0xb5)][_0x18db41(0x118)])||_0x34b851[_0x18db41(0xb5)]['name'];_0x4a240f['push']({'id':_0x3c055f,'name':_0x3b1165});}this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':!![],'enums':_0x4a240f},_0x421e5f[_0x18db41(0x252)]);}else{if(_0x421e5f[_0x18db41(0x221)]===_0x18db41(0x204))try{const _0x36c4bd=await scanForDevices(this,_0x421e5f['message']||{});this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':!![],'devices':_0x36c4bd},_0x421e5f[_0x18db41(0x252)]);}catch(_0x4ab5f5){this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':![],'error':_0x4ab5f5[_0x18db41(0x101)]},_0x421e5f['callback']);}else{if(_0x421e5f[_0x18db41(0x221)]===_0x18db41(0x20d)){const _0x23de6f=_0x421e5f[_0x18db41(0x101)][_0x18db41(0xe3)];if(!_0x23de6f)return this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':![],'error':_0x18db41(0xe9)},_0x421e5f['callback']);const _0x1bd78e=await getCalendarNames(this,_0x23de6f);this['sendTo'](_0x421e5f['from'],_0x421e5f[_0x18db41(0x221)],{'success':!![],'names':_0x1bd78e},_0x421e5f['callback']);}else{if(_0x421e5f[_0x18db41(0x221)]===_0x18db41(0x12b)){const {targetId:_0x37c77e,targetValue:_0x2f1f13}=_0x421e5f['message'];this['log'][_0x18db41(0x161)](_0x18db41(0x1c4)+_0x37c77e+_0x18db41(0x217)+_0x2f1f13),await this['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x18db41(0xf9)]('analysis.automation.description',{'val':_0x18db41(0x1d2)+_0x37c77e,'ack':!![]}),await this[_0x18db41(0xf9)](_0x18db41(0x124),{'val':_0x37c77e,'ack':!![]}),await this['setStateAsync'](_0x18db41(0x228),{'val':_0x2f1f13,'ack':!![]}),this[_0x18db41(0x150)](_0x421e5f['from'],_0x421e5f['command'],{'success':!![]},_0x421e5f[_0x18db41(0x252)]);}else{if(_0x421e5f['command']===_0x18db41(0x146)){const {historyId:_0x118235,rating:_0x1f9011,comment:_0x5829d9,alertReason:_0x3ea250}=_0x421e5f['message'];_0x118235&&_0x1f9011?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x118235,'rating':_0x1f9011,'comment':_0x5829d9,'alertReason':_0x3ea250}),this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f['command'],{'success':!![]},_0x421e5f[_0x18db41(0x252)])):this['sendTo'](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':![],'error':_0x18db41(0x13a)},_0x421e5f['callback']);}else _0x421e5f[_0x18db41(0x221)]==='dismissAutomation'&&(this[_0x18db41(0xe1)][_0x18db41(0x161)](_0x18db41(0x1b7)),await this[_0x18db41(0xf9)](_0x18db41(0x1ae),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x18db41(0x1f9),{'val':'','ack':!![]}),this[_0x18db41(0x150)](_0x421e5f[_0x18db41(0xde)],_0x421e5f['command'],{'success':!![]},_0x421e5f['callback']));}}}}}}}}}catch(_0x343a35){this['log']['error'](_0x18db41(0x193)+_0x421e5f[_0x18db41(0x221)]+':\x20'+_0x343a35['message']);if(_0x421e5f[_0x18db41(0x252)])this['sendTo'](_0x421e5f[_0x18db41(0xde)],_0x421e5f[_0x18db41(0x221)],{'success':![],'error':_0x343a35[_0x18db41(0x101)]},_0x421e5f['callback']);}}}if(require[a0_0x5ce4da(0x263)]!==module)module[a0_0x5ce4da(0x18d)]=_0xe4e5ac=>new CogniLiving(_0xe4e5ac);else new CogniLiving();