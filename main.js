const a0_0x53276c=a0_0x2ac9;(function(_0x546891,_0x4668ea){const _0x1db858=a0_0x2ac9,_0x258a95=_0x546891();while(!![]){try{const _0x1b9bed=parseInt(_0x1db858(0x340))/0x1+-parseInt(_0x1db858(0x2c3))/0x2*(parseInt(_0x1db858(0x210))/0x3)+parseInt(_0x1db858(0x19d))/0x4*(-parseInt(_0x1db858(0x34c))/0x5)+-parseInt(_0x1db858(0x365))/0x6+parseInt(_0x1db858(0x37a))/0x7*(-parseInt(_0x1db858(0x239))/0x8)+-parseInt(_0x1db858(0x183))/0x9*(-parseInt(_0x1db858(0x2ff))/0xa)+parseInt(_0x1db858(0x335))/0xb;if(_0x1b9bed===_0x4668ea)break;else _0x258a95['push'](_0x258a95['shift']());}catch(_0x73d3e2){_0x258a95['push'](_0x258a95['shift']());}}}(a0_0x5953,0x8b84c));const a0_0x420b12=(function(){let _0x34aa3c=!![];return function(_0x30d1a6,_0x1259a1){const _0xbb9fa4=_0x34aa3c?function(){const _0x16692a=a0_0x2ac9;if(_0x1259a1){const _0x23c8e3=_0x1259a1[_0x16692a(0x18a)](_0x30d1a6,arguments);return _0x1259a1=null,_0x23c8e3;}}:function(){};return _0x34aa3c=![],_0xbb9fa4;};}()),a0_0x22f068=a0_0x420b12(this,function(){const _0x2f46fe=a0_0x2ac9;return a0_0x22f068[_0x2f46fe(0x2c2)]()[_0x2f46fe(0x1f4)](_0x2f46fe(0x297))[_0x2f46fe(0x2c2)]()[_0x2f46fe(0x222)](a0_0x22f068)[_0x2f46fe(0x1f4)](_0x2f46fe(0x297));});a0_0x22f068();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x53276c(0x34d)),schedule=require(a0_0x53276c(0x19c)),{spawn,exec}=require(a0_0x53276c(0x27e)),path=require(a0_0x53276c(0x2dd)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x53276c(0x369),LTM_SCHEDULE=a0_0x53276c(0x248),MODE_RESET_SCHEDULE=a0_0x53276c(0x265),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x53276c(0x1eb),LTM_DP_DAILY_DIGESTS=a0_0x53276c(0x191),LTM_DP_STATUS=a0_0x53276c(0x1d1),LTM_DP_TRIGGER_DIGEST=a0_0x53276c(0x26b),LTM_DP_BASELINE_STATUS=a0_0x53276c(0x195),LTM_DP_DRIFT_CHANNEL=a0_0x53276c(0x326),LTM_DP_DRIFT_STATUS=a0_0x53276c(0x35b),LTM_DP_DRIFT_DETAILS=a0_0x53276c(0x358),LTM_DP_DRIFT_LAST_CHECK=a0_0x53276c(0x273),SYSTEM_DP_MODE=a0_0x53276c(0x371),HARD_IGNORE_TERMS=[a0_0x53276c(0x374),a0_0x53276c(0x1e2),a0_0x53276c(0x25e),a0_0x53276c(0x2d0),a0_0x53276c(0x304),'rssi',a0_0x53276c(0x256),a0_0x53276c(0x1e7),'error',a0_0x53276c(0x271),'working',a0_0x53276c(0x343),a0_0x53276c(0x263),a0_0x53276c(0x29d),'dutycycle',a0_0x53276c(0x272),a0_0x53276c(0x308),a0_0x53276c(0x2ae)],BAD_NAMES=[a0_0x53276c(0x225),a0_0x53276c(0x30d),a0_0x53276c(0x2ad),a0_0x53276c(0x18d),a0_0x53276c(0x2b1),a0_0x53276c(0x1c6),'on',a0_0x53276c(0x207),a0_0x53276c(0x376),a0_0x53276c(0x36e),a0_0x53276c(0x241),a0_0x53276c(0x24e),'cover',a0_0x53276c(0x25b),'motion',a0_0x53276c(0x234),a0_0x53276c(0x288),a0_0x53276c(0x32d),a0_0x53276c(0x32c),a0_0x53276c(0x1fc),a0_0x53276c(0x1f2),a0_0x53276c(0x218),'valve',a0_0x53276c(0x2c8),a0_0x53276c(0x23b)],ADAPTER_BLACKLIST=['system.',a0_0x53276c(0x1f1),a0_0x53276c(0x2a1),a0_0x53276c(0x2d2),a0_0x53276c(0x1ac),a0_0x53276c(0x1db),'icons-mfd.',a0_0x53276c(0x1ae),'echarts.',a0_0x53276c(0x236),a0_0x53276c(0x36b)],SYSTEM_MODES={'NORMAL':a0_0x53276c(0x281),'VACATION':a0_0x53276c(0x295),'PARTY':a0_0x53276c(0x28b),'GUEST':a0_0x53276c(0x38b)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x53276c(0x33a)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x53276c(0x2f2),'senior_aal':a0_0x53276c(0x2ba),'family':a0_0x53276c(0x31f),'single_comfort':a0_0x53276c(0x2ef),'security':a0_0x53276c(0x23c)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x44be58){const _0x37c621=a0_0x53276c;try{const _0x20eaa5=[_0x37c621(0x2d7),'events.history_debug_00'];for(const _0x222fea of _0x20eaa5){try{const _0xa9e08a=await _0x44be58[_0x37c621(0x1e1)](_0x222fea);_0xa9e08a&&await _0x44be58['delObjectAsync'](_0x222fea);}catch(_0x1629e2){}}}catch(_0x23f2f7){}}async function initHistory(_0x1ff148){const _0x44ccb6=a0_0x53276c;try{const _0x40440f=await _0x1ff148[_0x44ccb6(0x2fe)]('events.history');_0x40440f&&_0x40440f[_0x44ccb6(0x32f)]&&(_0x1ff148['eventHistory']=JSON[_0x44ccb6(0x372)](_0x40440f[_0x44ccb6(0x32f)][_0x44ccb6(0x2c2)]()));}catch(_0x416815){_0x1ff148[_0x44ccb6(0x22e)]=[];}try{const _0x2cb7f8=await _0x1ff148[_0x44ccb6(0x2fe)]('analysis.analysisHistory');if(_0x2cb7f8&&_0x2cb7f8[_0x44ccb6(0x32f)])_0x1ff148[_0x44ccb6(0x319)]=JSON['parse'](_0x2cb7f8[_0x44ccb6(0x32f)][_0x44ccb6(0x2c2)]());}catch(_0xd7c259){_0x1ff148[_0x44ccb6(0x319)]=[];}if(_0x1ff148[_0x44ccb6(0x22e)]&&_0x1ff148[_0x44ccb6(0x22e)][_0x44ccb6(0x1e0)]>0x0){_0x1ff148[_0x44ccb6(0x36f)]['info'](_0x44ccb6(0x2e1)+_0x1ff148['eventHistory'][_0x44ccb6(0x1e0)]+_0x44ccb6(0x221));for(let _0xdb4c3f=_0x1ff148['eventHistory'][_0x44ccb6(0x1e0)]-0x1;_0xdb4c3f>=0x0;_0xdb4c3f--){const _0x5653c5=_0x1ff148[_0x44ccb6(0x22e)][_0xdb4c3f];_0x5653c5&&_0x5653c5['id']!==undefined&&_0x5653c5['value']!==undefined&&(_0x1ff148['sensorLastValues'][_0x5653c5['id']]=_0x5653c5[_0x44ccb6(0x2b1)]);}}}async function initSystemConfig(_0x43dcfe){const _0x267f80=a0_0x53276c;try{const _0x18839e=await _0x43dcfe[_0x267f80(0x228)](_0x267f80(0x286));_0x18839e&&_0x18839e[_0x267f80(0x2e8)]&&(_0x43dcfe[_0x267f80(0x1a6)]={'latitude':_0x18839e[_0x267f80(0x2e8)]['latitude']||0x0,'longitude':_0x18839e[_0x267f80(0x2e8)][_0x267f80(0x29f)]||0x0,'city':_0x18839e['common']['city']||''});}catch(_0x41d95a){}}async function checkLicense(_0x415030,_0xa1fd04){const _0x31abbc=a0_0x53276c;if(!_0xa1fd04)return![];_0x415030[_0x31abbc(0x313)]=await getSystemUUID(_0x415030);if(_0xa1fd04===_0x31abbc(0x314)||_0xa1fd04[_0x31abbc(0x274)](_0x31abbc(0x1b4)))return!![];return![];}async function getSystemUUID(_0x1ed30b){const _0xb15da3=a0_0x53276c;try{const _0x493b24=await _0x1ed30b[_0xb15da3(0x228)](_0xb15da3(0x2a8));if(_0x493b24&&_0x493b24[_0xb15da3(0x1b8)]&&_0x493b24['native'][_0xb15da3(0x303)])return _0x493b24[_0xb15da3(0x1b8)]['uuid'];return _0xb15da3(0x1d4);}catch(_0x2f96fb){return _0xb15da3(0x280);}}async function createAllObjects(_0x5d3f19){const _0x4e50f0=a0_0x53276c;await checkSystemObjects(_0x5d3f19),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x388),{'type':'state','common':{'name':_0x4e50f0(0x1e4),'type':'string','role':_0x4e50f0(0x19b),'read':!![],'write':![],'def':''},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x2b7),{'type':'state','common':{'name':_0x4e50f0(0x19a),'type':_0x4e50f0(0x229),'role':'json','read':!![],'write':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x180),{'type':_0x4e50f0(0x2ad),'common':{'name':'Event\x20History','type':_0x4e50f0(0x229),'role':_0x4e50f0(0x1ee),'read':!![],'write':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)]('analysis.trigger',{'type':_0x4e50f0(0x2ad),'common':{'name':'Trigger\x20Analysis','type':_0x4e50f0(0x37b),'role':_0x4e50f0(0x2bc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x27a),{'type':_0x4e50f0(0x2ad),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':'boolean','role':_0x4e50f0(0x2bc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5d3f19['setObjectNotExistsAsync']('analysis.lastResult',{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x1de),'type':_0x4e50f0(0x229),'role':_0x4e50f0(0x1ee),'read':!![],'write':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)]('analysis.isAlert',{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x32a),'type':_0x4e50f0(0x37b),'role':_0x4e50f0(0x1ed),'read':!![],'write':![],'def':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x252),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x28f),'type':'boolean','role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x5d3f19['setObjectNotExistsAsync'](_0x4e50f0(0x383),{'type':'state','common':{'name':_0x4e50f0(0x33f),'type':_0x4e50f0(0x229),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x5d3f19['setObjectNotExistsAsync'](_0x4e50f0(0x329),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x26c),'type':'string','role':_0x4e50f0(0x19b),'read':!![],'write':![]},'native':{}}),await _0x5d3f19['setObjectNotExistsAsync']('analysis.deviationFromBaseline',{'type':'state','common':{'name':_0x4e50f0(0x35f),'type':_0x4e50f0(0x229),'role':'state','read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)]('analysis.comfortSummary',{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x378),'type':_0x4e50f0(0x229),'role':'text','read':!![],'write':![]},'native':{}}),await _0x5d3f19['setObjectNotExistsAsync'](_0x4e50f0(0x21d),{'type':_0x4e50f0(0x2ad),'common':{'name':'Comfort\x20Suggestion','type':'string','role':_0x4e50f0(0x19b),'read':!![],'write':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x1c4)](_0x4e50f0(0x379),{'type':_0x4e50f0(0x339),'common':{'name':_0x4e50f0(0x2b5)},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x34b),{'type':'state','common':{'name':_0x4e50f0(0x35a),'type':'boolean','role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x1ea),{'type':_0x4e50f0(0x2ad),'common':{'name':'Description','type':_0x4e50f0(0x229),'role':_0x4e50f0(0x19b),'read':!![],'write':![]},'native':{}}),await _0x5d3f19['setObjectNotExistsAsync'](_0x4e50f0(0x188),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x1e6),'type':_0x4e50f0(0x229),'role':_0x4e50f0(0x19b),'read':!![],'write':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x24d),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x1d5),'type':_0x4e50f0(0x229),'role':_0x4e50f0(0x19b),'read':!![],'write':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x37c),{'type':'state','common':{'name':_0x4e50f0(0x23e),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)]('analysis.automation.autoApply',{'type':_0x4e50f0(0x2ad),'common':{'name':'Auto\x20Apply\x20Rule','type':'boolean','role':_0x4e50f0(0x376),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x38a),{'type':_0x4e50f0(0x2ad),'common':{'name':'Trigger\x20Action\x20Now','type':_0x4e50f0(0x37b),'role':_0x4e50f0(0x2bc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5d3f19['setObjectNotExistsAsync']('analysis.analysisHistory',{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x337),'type':'string','role':_0x4e50f0(0x1ee),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x1c9),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x2e6),'type':_0x4e50f0(0x229),'role':_0x4e50f0(0x1ee),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x5d3f19[_0x4e50f0(0x1c4)](_0x4e50f0(0x31b),{'type':_0x4e50f0(0x339),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)]('analysis.health.sleepScore',{'type':_0x4e50f0(0x2ad),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x4e50f0(0x247),'role':_0x4e50f0(0x28e),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x5d3f19['setObjectNotExistsAsync'](_0x4e50f0(0x2ed),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x344),'type':'string','role':'text','read':!![],'write':![],'def':_0x4e50f0(0x23d)},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x2e3),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x1ef),'type':_0x4e50f0(0x229),'role':_0x4e50f0(0x19b),'read':!![],'write':![],'def':''},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)]('analysis.health.trendDiagnosis',{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x2db),'type':'string','role':_0x4e50f0(0x19b),'read':!![],'write':![],'def':_0x4e50f0(0x1be)},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x2bd),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x310),'type':'number','role':_0x4e50f0(0x2b1),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x5d3f19[_0x4e50f0(0x1c4)]('LTM.trainingData',{'type':_0x4e50f0(0x339),'common':{'name':_0x4e50f0(0x22a)},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x1cf),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x2be),'type':'string','role':_0x4e50f0(0x1ee),'read':!![],'write':![],'def':'[]','desc':'Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training'},'native':{}}),await _0x5d3f19[_0x4e50f0(0x336)](_0x4e50f0(0x269),{'type':_0x4e50f0(0x2ad),'common':{'name':_0x4e50f0(0x37d),'type':_0x4e50f0(0x229),'role':_0x4e50f0(0x1ee),'read':!![],'write':![],'def':'[]','desc':_0x4e50f0(0x293)},'native':{}}),await checkLtmObjects(_0x5d3f19),await checkLtmDriftObjects(_0x5d3f19);}async function checkSystemObjects(_0x2a6c83){const _0x55a020=a0_0x53276c;await _0x2a6c83[_0x55a020(0x1c4)](_0x55a020(0x305),{'type':_0x55a020(0x339),'common':{'name':_0x55a020(0x368)},'native':{}}),await _0x2a6c83[_0x55a020(0x1c4)](SYSTEM_DP_MODE,{'type':_0x55a020(0x2ad),'common':{'name':'System\x20Mode','type':_0x55a020(0x229),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x55a020(0x26e)],'states':{[SYSTEM_MODES['NORMAL']]:_0x55a020(0x1fa),[SYSTEM_MODES[_0x55a020(0x216)]]:_0x55a020(0x2ca),[SYSTEM_MODES[_0x55a020(0x33a)]]:_0x55a020(0x324),[SYSTEM_MODES['GUEST']]:_0x55a020(0x34e)}},'native':{}});}async function checkLtmObjects(_0x55ac6a){const _0x4c79d9=a0_0x53276c;await _0x55ac6a['extendObjectAsync'](_0x4c79d9(0x201),{'type':_0x4c79d9(0x339),'common':{'name':_0x4c79d9(0x201)},'native':{}}),await _0x55ac6a[_0x4c79d9(0x1c4)](LTM_DP_RAW_LOG,{'type':_0x4c79d9(0x2ad),'common':{'name':'Raw\x20Log','type':'string','role':_0x4c79d9(0x1ee),'read':!![],'write':![]},'native':{}}),await _0x55ac6a['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x4c79d9(0x2ad),'common':{'name':_0x4c79d9(0x2d6),'type':_0x4c79d9(0x229),'role':_0x4c79d9(0x1ee),'read':!![],'write':![]},'native':{}}),await _0x55ac6a[_0x4c79d9(0x1c4)](LTM_DP_STATUS,{'type':'state','common':{'name':_0x4c79d9(0x227),'type':'string','role':_0x4c79d9(0x19b),'read':!![],'write':![]},'native':{}}),await _0x55ac6a[_0x4c79d9(0x1c4)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':'Trigger\x20Digest','type':_0x4c79d9(0x37b),'role':_0x4c79d9(0x2bc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x55ac6a[_0x4c79d9(0x1c4)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':_0x4c79d9(0x290),'type':_0x4c79d9(0x229),'role':_0x4c79d9(0x19b),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0xf15ae0){const _0x5e7915=a0_0x53276c;await _0xf15ae0[_0x5e7915(0x1c4)](LTM_DP_DRIFT_CHANNEL,{'type':_0x5e7915(0x339),'common':{'name':'Drift\x20Analysis'},'native':{}}),await _0xf15ae0[_0x5e7915(0x1c4)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':'Drift\x20Status','type':_0x5e7915(0x229),'role':_0x5e7915(0x2ad),'read':!![],'write':![],'def':_0x5e7915(0x1be)},'native':{}}),await _0xf15ae0['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x5e7915(0x2ad),'common':{'name':_0x5e7915(0x258),'type':_0x5e7915(0x229),'role':_0x5e7915(0x19b),'read':!![],'write':![]},'native':{}}),await _0xf15ae0[_0x5e7915(0x1c4)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x5e7915(0x2ad),'common':{'name':_0x5e7915(0x21a),'type':_0x5e7915(0x247),'role':_0x5e7915(0x2e4),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x10e452){const _0x4c8f16=a0_0x53276c;try{const _0x3e014d=await _0x10e452[_0x4c8f16(0x2fe)](SYSTEM_DP_MODE);_0x3e014d&&_0x3e014d[_0x4c8f16(0x32f)]&&Object[_0x4c8f16(0x1a5)](SYSTEM_MODES)[_0x4c8f16(0x330)](_0x3e014d[_0x4c8f16(0x32f)])?_0x10e452[_0x4c8f16(0x386)]=_0x3e014d[_0x4c8f16(0x32f)]:(_0x10e452[_0x4c8f16(0x386)]=SYSTEM_MODES[_0x4c8f16(0x26e)],await _0x10e452['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x4bca3d){_0x10e452[_0x4c8f16(0x386)]=SYSTEM_MODES[_0x4c8f16(0x26e)];}}async function loadRawEventLog(_0x534f3c){const _0x571a4b=a0_0x53276c;try{const _0x40e159=await _0x534f3c['getStateAsync'](LTM_DP_RAW_LOG);if(_0x40e159&&_0x40e159[_0x571a4b(0x32f)])_0x534f3c[_0x571a4b(0x25c)]=JSON[_0x571a4b(0x372)](_0x40e159[_0x571a4b(0x32f)]);}catch(_0x260694){_0x534f3c[_0x571a4b(0x25c)]=[];}}async function saveRawEventLog(_0x161e32){const _0x5bb70e=a0_0x53276c;_0x161e32[_0x5bb70e(0x25c)][_0x5bb70e(0x1e0)]>RAW_LOG_MAX_SIZE&&_0x161e32[_0x5bb70e(0x25c)][_0x5bb70e(0x242)](0x0,_0x161e32['rawEventLog']['length']-RAW_LOG_MAX_SIZE),await _0x161e32[_0x5bb70e(0x2f4)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x161e32['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x2e7655){const _0x316988=a0_0x53276c;try{const _0x3940d6=await _0x2e7655[_0x316988(0x2fe)](LTM_DP_DAILY_DIGESTS);if(_0x3940d6&&_0x3940d6['val'])_0x2e7655['dailyDigests']=JSON[_0x316988(0x372)](_0x3940d6[_0x316988(0x32f)]);}catch(_0x5427a3){_0x2e7655[_0x316988(0x205)]=[];}await updateBaselineStatus(_0x2e7655);}async function saveDailyDigests(_0x2fe6d3,_0x5b2dc1=!![]){const _0x5c0436=a0_0x53276c,_0x98beb=_0x2fe6d3[_0x5c0436(0x382)][_0x5c0436(0x21c)]||0x3c;_0x2fe6d3[_0x5c0436(0x205)][_0x5c0436(0x1e0)]>_0x98beb&&_0x2fe6d3[_0x5c0436(0x205)][_0x5c0436(0x242)](0x0,_0x2fe6d3[_0x5c0436(0x205)]['length']-_0x98beb);await _0x2fe6d3['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5c0436(0x347)](_0x2fe6d3[_0x5c0436(0x205)]),'ack':!![]});if(_0x5b2dc1)await updateBaselineStatus(_0x2fe6d3);}async function updateAnalysisHistory(_0x57f60d,_0x4452ae){const _0x2924f1=a0_0x53276c;_0x57f60d['analysisHistory']['unshift'](_0x4452ae);if(_0x57f60d['analysisHistory']['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x57f60d[_0x2924f1(0x319)][_0x2924f1(0x1df)]();await _0x57f60d[_0x2924f1(0x2f4)](_0x2924f1(0x301),{'val':JSON[_0x2924f1(0x347)](_0x57f60d[_0x2924f1(0x319)]),'ack':!![]});}async function updateBaselineStatus(_0x2e19fd){const _0x3295d8=a0_0x53276c;if(!_0x2e19fd[_0x3295d8(0x24a)]){await _0x2e19fd[_0x3295d8(0x2f4)](LTM_DP_BASELINE_STATUS,{'val':_0x3295d8(0x187),'ack':!![]});return;}const _0x284ac2=_0x2e19fd[_0x3295d8(0x205)][_0x3295d8(0x1e0)]>=(_0x2e19fd[_0x3295d8(0x382)][_0x3295d8(0x2aa)]||0x7)?_0x3295d8(0x246)+_0x2e19fd[_0x3295d8(0x205)][_0x3295d8(0x1e0)]+'\x20Tage)':_0x3295d8(0x1d6)+_0x2e19fd[_0x3295d8(0x205)]['length']+'/'+(_0x2e19fd['config']['minDaysForBaseline']||0x7)+')';await _0x2e19fd[_0x3295d8(0x2f4)](LTM_DP_BASELINE_STATUS,{'val':_0x284ac2,'ack':!![]});}async function initSensorSubscriptions(_0x472ca4){const _0x2a620e=a0_0x53276c,_0x3449ad=_0x472ca4['config'][_0x2a620e(0x2f1)];if(_0x3449ad&&_0x3449ad[_0x2a620e(0x1e0)]>0x0){_0x472ca4['log'][_0x2a620e(0x341)](_0x2a620e(0x1d0)+_0x3449ad['length']+_0x2a620e(0x34a));for(const _0xba963d of _0x3449ad){if(_0xba963d['id']){await _0x472ca4[_0x2a620e(0x18e)](_0xba963d['id']);try{const _0x3ef723=await _0x472ca4['getForeignStateAsync'](_0xba963d['id']);if(_0x3ef723)_0x472ca4['sensorLastValues'][_0xba963d['id']]=_0x3ef723[_0x2a620e(0x32f)];}catch(_0x20d575){}}}}}async function initPresenceSubscriptions(_0x3eec5e){const _0x3b7d6b=a0_0x53276c,_0x52e2d2=_0x3eec5e[_0x3b7d6b(0x382)]['presenceDevices']||[];if(_0x52e2d2[_0x3b7d6b(0x1e0)]>0x0){_0x3eec5e['log'][_0x3b7d6b(0x341)]('Subscribing\x20to\x20'+_0x52e2d2['length']+'\x20presence\x20devices...');for(const _0x75fdb9 of _0x52e2d2){await _0x3eec5e['subscribeForeignStatesAsync'](_0x75fdb9);}try{await checkWifiPresence(_0x3eec5e);}catch(_0x5487d4){}}}async function getWeatherContext(_0x381b97){const _0x1b9df7=a0_0x53276c;try{if(!_0x381b97[_0x1b9df7(0x382)][_0x1b9df7(0x2ee)])return _0x1b9df7(0x22f);let _0xb872f9='';const _0x1a85e4=_0x381b97[_0x1b9df7(0x382)]['weatherInstance'];if(_0x1a85e4)try{if(_0x1a85e4[_0x1b9df7(0x330)](_0x1b9df7(0x22d))){const _0xd03ec=await _0x381b97[_0x1b9df7(0x1d3)](_0x1a85e4+_0x1b9df7(0x1e5));if(_0xd03ec&&_0xd03ec[_0x1b9df7(0x32f)])_0xb872f9=_0xd03ec[_0x1b9df7(0x32f)];}else{if(_0x1a85e4[_0x1b9df7(0x330)](_0x1b9df7(0x20f))){const _0x4c7f43=await _0x381b97[_0x1b9df7(0x1d3)](_0x1a85e4+_0x1b9df7(0x285));if(_0x4c7f43&&_0x4c7f43[_0x1b9df7(0x32f)])_0xb872f9=_0x4c7f43[_0x1b9df7(0x32f)];}else{if(_0x1a85e4['includes'](_0x1b9df7(0x306))){const _0x2a929a=await _0x381b97['getForeignStateAsync'](_0x1a85e4+_0x1b9df7(0x355));if(_0x2a929a&&_0x2a929a[_0x1b9df7(0x32f)])_0xb872f9=_0x2a929a[_0x1b9df7(0x32f)];}}}}catch(_0x2e4352){}if(!_0xb872f9){const _0x3500fb=[_0x1b9df7(0x2a7),_0x1b9df7(0x2e0),_0x1b9df7(0x1bd),_0x1b9df7(0x20e)];for(const _0x4313fb of _0x3500fb){try{const _0x10b426=await _0x381b97[_0x1b9df7(0x228)](_0x4313fb);if(_0x10b426){if(_0x4313fb[_0x1b9df7(0x330)](_0x1b9df7(0x22d))){const _0x3fa30f=await _0x381b97[_0x1b9df7(0x1d3)](_0x4313fb+_0x1b9df7(0x1e5));if(_0x3fa30f&&_0x3fa30f[_0x1b9df7(0x32f)]){_0xb872f9=_0x3fa30f[_0x1b9df7(0x32f)];break;}}}}catch(_0x584c1e){}}}return _0xb872f9?_0x1b9df7(0x238)+_0xb872f9:_0x1b9df7(0x1b6);}catch(_0x429d3f){return'WETTER\x20ERROR:\x20'+_0x429d3f[_0x1b9df7(0x33d)];}}async function getCalendarContext(_0x4d68de){const _0x16f6c0=a0_0x53276c;try{if(!_0x4d68de['config'][_0x16f6c0(0x1ce)])return _0x16f6c0(0x2f5);let _0x3f90a8=_0x4d68de['config']['calendarInstance']||'ical.0',_0x7472f9=_0x4d68de[_0x16f6c0(0x382)]['calendarSelection']||[];if(typeof _0x7472f9==='string')_0x7472f9=_0x7472f9[_0x16f6c0(0x1b1)](',');try{const _0x5e7a13=await _0x4d68de[_0x16f6c0(0x1d3)](_0x3f90a8+_0x16f6c0(0x19f));if(_0x5e7a13&&_0x5e7a13[_0x16f6c0(0x32f)]){let _0x58ba1b=tryParse(_0x5e7a13['val']);if(_0x58ba1b&&Array['isArray'](_0x58ba1b)){if(_0x7472f9['length']>0x0)_0x58ba1b=_0x58ba1b[_0x16f6c0(0x31a)](_0x26b7fa=>_0x7472f9[_0x16f6c0(0x330)](_0x26b7fa[_0x16f6c0(0x302)]||''));else return _0x16f6c0(0x1cd);if(_0x58ba1b['length']>0x0){const _0x49a131=_0x58ba1b[_0x16f6c0(0x24f)](0x0,0x3)['map'](_0x3aa7fa=>{const _0x270934=_0x16f6c0;let _0x51d296=_0x3aa7fa[_0x270934(0x2e4)];if(_0x3aa7fa['time'])_0x51d296+='\x20'+_0x3aa7fa['time'];return _0x51d296+':\x20'+_0x3aa7fa[_0x270934(0x2a0)]+'\x20('+_0x3aa7fa[_0x270934(0x302)]+')';});return'KALENDER:\x20'+_0x49a131[_0x16f6c0(0x367)](_0x16f6c0(0x208));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x2e7cd8){_0x4d68de[_0x16f6c0(0x36f)][_0x16f6c0(0x2b2)](_0x16f6c0(0x211)+_0x2e7cd8[_0x16f6c0(0x33d)]);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x55db48){return _0x16f6c0(0x1f8)+_0x55db48[_0x16f6c0(0x33d)];}}async function getCalendarNames(_0x2baf56,_0x4fd1f6){const _0x41af5d=a0_0x53276c;try{const _0x2bab94=await _0x2baf56[_0x41af5d(0x1d3)](_0x4fd1f6+_0x41af5d(0x19f));if(_0x2bab94&&_0x2bab94[_0x41af5d(0x32f)]){const _0x21feb0=tryParse(_0x2bab94[_0x41af5d(0x32f)]);if(_0x21feb0&&Array[_0x41af5d(0x2d8)](_0x21feb0)){const _0x1d925d=[...new Set(_0x21feb0[_0x41af5d(0x226)](_0x20d516=>_0x20d516[_0x41af5d(0x302)])[_0x41af5d(0x31a)](Boolean))];return _0x1d925d[_0x41af5d(0x250)]();}}return[];}catch(_0x36ff94){return _0x2baf56['log'][_0x41af5d(0x20b)]('getCalendarNames\x20Error:\x20'+_0x36ff94[_0x41af5d(0x33d)]),[];}}async function checkWifiPresence(_0x10a2f5){const _0x26647e=a0_0x53276c;try{const _0x58fd25=_0x10a2f5[_0x26647e(0x382)][_0x26647e(0x377)]||[];let _0x211985=![];const _0x2a0e4f=[];for(const _0x77c498 of _0x58fd25){try{const _0x4b7c6a=await _0x10a2f5[_0x26647e(0x1d3)](_0x77c498);if(_0x4b7c6a&&(_0x4b7c6a['val']===!![]||_0x4b7c6a[_0x26647e(0x32f)]===_0x26647e(0x22b)||_0x4b7c6a[_0x26647e(0x32f)]===0x1)){_0x211985=!![];const _0x3db185=await _0x10a2f5['getForeignObjectAsync'](_0x77c498);let _0x450aeb=_0x77c498;_0x3db185&&_0x3db185['common']&&_0x3db185[_0x26647e(0x2e8)]['name']&&(_0x450aeb=typeof _0x3db185[_0x26647e(0x2e8)]['name']===_0x26647e(0x35c)?_0x3db185['common']['name']['de']||_0x3db185[_0x26647e(0x2e8)][_0x26647e(0x331)]['en']:_0x3db185[_0x26647e(0x2e8)]['name']),_0x2a0e4f['push'](_0x450aeb);}}catch(_0x21515b){}}return await _0x10a2f5['setStateAsync'](_0x26647e(0x388),{'val':_0x2a0e4f['join'](',\x20'),'ack':!![]}),_0x211985&&(_0x10a2f5[_0x26647e(0x243)]&&(_0x10a2f5[_0x26647e(0x36f)][_0x26647e(0x341)](_0x26647e(0x37e)),abortExitTimer(_0x10a2f5)),!_0x10a2f5['isPresent']&&_0x10a2f5[_0x26647e(0x386)]===SYSTEM_MODES[_0x26647e(0x26e)]&&await setPresence(_0x10a2f5,!![])),_0x211985;}catch(_0x57ef3f){return _0x10a2f5['log'][_0x26647e(0x20b)](_0x26647e(0x311)+_0x57ef3f[_0x26647e(0x33d)]),![];}}function a0_0x2ac9(_0x34aa08,_0x6ef6d2){const _0x2b0dc5=a0_0x5953();return a0_0x2ac9=function(_0x22f068,_0x420b12){_0x22f068=_0x22f068-0x180;let _0x59536c=_0x2b0dc5[_0x22f068];return _0x59536c;},a0_0x2ac9(_0x34aa08,_0x6ef6d2);}function startExitTimer(_0x4547c2){const _0x1b8e8b=a0_0x53276c;abortExitTimer(_0x4547c2),_0x4547c2[_0x1b8e8b(0x292)]=!![],_0x4547c2[_0x1b8e8b(0x1dc)]=setTimeout(()=>{const _0x2f7f4c=_0x1b8e8b;_0x4547c2[_0x2f7f4c(0x292)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4547c2[_0x1b8e8b(0x243)]=setTimeout(()=>{const _0x1316fe=_0x1b8e8b;setPresence(_0x4547c2,![]),_0x4547c2[_0x1316fe(0x243)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x4911f4){const _0x8e0a55=a0_0x53276c;if(_0x4911f4[_0x8e0a55(0x243)])clearTimeout(_0x4911f4[_0x8e0a55(0x243)]);if(_0x4911f4[_0x8e0a55(0x1dc)])clearTimeout(_0x4911f4[_0x8e0a55(0x1dc)]);_0x4911f4[_0x8e0a55(0x243)]=null,_0x4911f4[_0x8e0a55(0x1dc)]=null,_0x4911f4['isGracePeriodActive']=![];}async function setPresence(_0x57822b,_0x797568){const _0x4d3bf9=a0_0x53276c;if(_0x57822b[_0x4d3bf9(0x291)]===_0x797568)return;_0x57822b[_0x4d3bf9(0x291)]=_0x797568,await _0x57822b[_0x4d3bf9(0x2f4)](_0x4d3bf9(0x36c),{'val':_0x797568,'ack':!![]});}async function saveFeedback(_0x5cad6b,_0x2a96bc){const _0x4c5d67=a0_0x53276c;_0x5cad6b['log'][_0x4c5d67(0x341)](_0x4c5d67(0x2b6)+JSON['stringify'](_0x2a96bc));}async function runBaselineDriftAnalysis(_0x5088dd){const _0x1879de=a0_0x53276c;if(!_0x5088dd[_0x1879de(0x24a)]||!_0x5088dd[_0x1879de(0x385)])return;const _0xaf4bc0=_0x5088dd[_0x1879de(0x382)][_0x1879de(0x1ba)]||0xe;if(_0x5088dd[_0x1879de(0x205)][_0x1879de(0x1e0)]<_0xaf4bc0+(_0x5088dd['config'][_0x1879de(0x2aa)]||0x7)){await _0x5088dd[_0x1879de(0x2f4)](LTM_DP_DRIFT_STATUS,{'val':_0x1879de(0x2eb),'ack':!![]});return;}const _0x5ce6d7=_0x5088dd['dailyDigests'][_0x1879de(0x24f)](-_0xaf4bc0),_0x56d97c=_0x5088dd[_0x1879de(0x205)][_0x1879de(0x24f)](0x0,_0x5088dd[_0x1879de(0x205)][_0x1879de(0x1e0)]-_0xaf4bc0),_0x43ddae='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON['stringify'](_0x56d97c)+_0x1879de(0x1fe)+JSON[_0x1879de(0x347)](_0x5ce6d7);try{const _0x185b08=await _0x5088dd[_0x1879de(0x385)][_0x1879de(0x209)](_0x43ddae),_0x16e82f=JSON[_0x1879de(0x372)](_0x185b08['response'][_0x1879de(0x19b)]()[_0x1879de(0x2d4)](/```json|```/g,'')['trim']());_0x16e82f['baselineDrift']&&(await _0x5088dd['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x16e82f[_0x1879de(0x199)],'ack':!![]}),await _0x5088dd[_0x1879de(0x2f4)](LTM_DP_DRIFT_DETAILS,{'val':_0x16e82f[_0x1879de(0x1ff)],'ack':!![]}),await _0x5088dd['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x1879de(0x245)](),'ack':!![]}));}catch(_0xaa57fc){}}function setupLtmScheduler(_0x1c5cc7){const _0x332e0b=a0_0x53276c;try{if(_0x1c5cc7[_0x332e0b(0x1e8)])_0x1c5cc7[_0x332e0b(0x1e8)]['cancel']();if(!_0x1c5cc7[_0x332e0b(0x24a)]){_0x1c5cc7[_0x332e0b(0x2f4)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x1c5cc7[_0x332e0b(0x1e8)]=schedule[_0x332e0b(0x312)](LTM_SCHEDULE,()=>createDailyDigest(_0x1c5cc7));}catch(_0xd22741){_0x1c5cc7[_0x332e0b(0x36f)][_0x332e0b(0x20b)]('LTM\x20Sched\x20Error:\x20'+_0xd22741[_0x332e0b(0x33d)]);}}function setupModeResetScheduler(_0x484075){const _0x6c756b=a0_0x53276c;try{if(_0x484075[_0x6c756b(0x2d1)])_0x484075[_0x6c756b(0x2d1)][_0x6c756b(0x352)]();_0x484075['modeResetJob']=schedule[_0x6c756b(0x312)](MODE_RESET_SCHEDULE,async()=>{const _0x4150be=_0x6c756b;await loadSystemMode(_0x484075),AUTO_RESET_MODES[_0x4150be(0x330)](_0x484075[_0x4150be(0x386)])&&await _0x484075[_0x4150be(0x2f4)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x4150be(0x26e)],'ack':![]});});}catch(_0x5955c9){_0x484075[_0x6c756b(0x36f)][_0x6c756b(0x20b)]('Reset\x20Sched\x20Error:\x20'+_0x5955c9[_0x6c756b(0x33d)]);}}function setupDriftAnalysisScheduler(_0x1edb33){const _0x56f53d=a0_0x53276c;try{if(_0x1edb33[_0x56f53d(0x346)])clearInterval(_0x1edb33[_0x56f53d(0x346)]);if(!_0x1edb33[_0x56f53d(0x24a)])return;_0x1edb33[_0x56f53d(0x346)]=setInterval(()=>runBaselineDriftAnalysis(_0x1edb33),(_0x1edb33['config'][_0x56f53d(0x333)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x1edb33),0x1388);}catch(_0x3e8543){_0x1edb33[_0x56f53d(0x36f)][_0x56f53d(0x20b)]('Drift\x20Sched\x20Error:\x20'+_0x3e8543[_0x56f53d(0x33d)]);}}function setupBriefingScheduler(_0x493a1d){const _0x598d73=a0_0x53276c;try{if(_0x493a1d['briefingJob'])_0x493a1d[_0x598d73(0x342)][_0x598d73(0x352)]();if(!_0x493a1d[_0x598d73(0x382)][_0x598d73(0x186)])return;const _0x2a6cb7=(_0x493a1d[_0x598d73(0x382)][_0x598d73(0x318)]||_0x598d73(0x1ca))[_0x598d73(0x1b1)](':'),_0x29983b=parseInt(_0x2a6cb7[0x0])||0x8,_0x378886=parseInt(_0x2a6cb7[0x1])||0x0,_0x74b93d=_0x378886+'\x20'+_0x29983b+_0x598d73(0x25f);_0x493a1d[_0x598d73(0x36f)][_0x598d73(0x341)](_0x598d73(0x279)+_0x29983b+':'+(_0x378886<0xa?'0'+_0x378886:_0x378886)),_0x493a1d[_0x598d73(0x342)]=schedule[_0x598d73(0x312)](_0x74b93d,()=>{sendMorningBriefing(_0x493a1d);});}catch(_0x3180ac){_0x493a1d['log'][_0x598d73(0x20b)](_0x598d73(0x268)+_0x3180ac[_0x598d73(0x33d)]);}}async function sendNotification(_0x570d0d,_0x2e4d02,_0x51fdf8=![],_0x2c4842=![]){const _0x7d572a=a0_0x53276c;_0x570d0d['log'][_0x7d572a(0x341)]((_0x51fdf8?_0x7d572a(0x2cb):'')+'Sending\x20notification:\x20\x22'+_0x2e4d02+'\x22');const _0x541ce3=_0x570d0d['config'];let _0x3e00ac=0x0;if(_0x541ce3['notifyTelegramEnabled']){let _0x315353={};(_0x2e4d02[_0x7d572a(0x330)]('Alarm')||_0x2c4842)&&(_0x315353={'reply_markup':{'inline_keyboard':[[{'text':_0x7d572a(0x1e3),'callback_data':_0x7d572a(0x309)}],[{'text':_0x7d572a(0x1a7),'callback_data':_0x7d572a(0x197)}]]}}),await _0x570d0d[_0x7d572a(0x276)](_0x541ce3[_0x7d572a(0x2a6)],_0x7d572a(0x182),{'text':_0x2e4d02,'user':_0x541ce3[_0x7d572a(0x1f3)],..._0x315353}),_0x3e00ac++;}if(_0x541ce3[_0x7d572a(0x237)]){let _0x3e6141={'message':_0x2e4d02,'title':_0x2c4842?_0x7d572a(0x19e):_0x7d572a(0x294),'priority':_0x2c4842?0x2:0x1,'device':_0x541ce3[_0x7d572a(0x2b3)]};_0x2c4842&&(_0x3e6141[_0x7d572a(0x381)]=0x1e,_0x3e6141[_0x7d572a(0x36d)]=0xe10,_0x3e6141[_0x7d572a(0x2b9)]='siren'),await _0x570d0d[_0x7d572a(0x276)](_0x541ce3['notifyPushoverInstance'],_0x7d572a(0x182),_0x3e6141),_0x3e00ac++;}return _0x541ce3[_0x7d572a(0x253)]&&(await _0x570d0d[_0x7d572a(0x276)](_0x541ce3['notifyEmailInstance'],_0x7d572a(0x182),{'text':_0x2e4d02,'to':_0x541ce3[_0x7d572a(0x2c1)]}),_0x3e00ac++),_0x3e00ac;}async function setupTelegramListener(_0x36f2f8){const _0x1580af=a0_0x53276c,_0x5de41d=_0x36f2f8[_0x1580af(0x382)][_0x1580af(0x2a6)];_0x36f2f8[_0x1580af(0x382)][_0x1580af(0x2a2)]&&_0x5de41d&&(_0x36f2f8[_0x1580af(0x36f)][_0x1580af(0x341)]('üì°\x20Hooking\x20into\x20'+_0x5de41d+_0x1580af(0x264)),await _0x36f2f8[_0x1580af(0x18e)](_0x5de41d+_0x1580af(0x22c)));}async function handleTelegramResponse(_0x20d95a,_0x5a6b9a){const _0x459a87=a0_0x53276c;let _0x343e6b=_0x5a6b9a;_0x5a6b9a[_0x459a87(0x274)]('[')&&(_0x343e6b=_0x5a6b9a[_0x459a87(0x1b2)](_0x5a6b9a[_0x459a87(0x2c9)](']')+0x1));if(_0x343e6b==='COGNI_CONFIRM_OK')_0x20d95a[_0x459a87(0x36f)][_0x459a87(0x341)](_0x459a87(0x30b)),await _0x20d95a[_0x459a87(0x2f4)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x20d95a['setStateAsync'](_0x459a87(0x383),{'val':_0x459a87(0x1f0),'ack':!![]}),_0x20d95a[_0x459a87(0x1ab)]=![],sendNotification(_0x20d95a,_0x459a87(0x2c6),![]);else _0x343e6b==='COGNI_REQUEST_CALL'&&(_0x20d95a[_0x459a87(0x36f)][_0x459a87(0x2b2)](_0x459a87(0x2e7)),sendNotification(_0x20d95a,_0x459a87(0x190),![],!![]));}async function runAutopilot(_0xbe8297){const _0x1b5f83=a0_0x53276c,_0x3c003c=_0xbe8297['config'][_0x1b5f83(0x2ec)],_0x3a7d8c=_0xbe8297['eventHistory'][_0x1b5f83(0x1e0)]>0x0?_0xbe8297[_0x1b5f83(0x22e)][0x0][_0x1b5f83(0x26a)]:Date[_0x1b5f83(0x245)](),_0x1a53b6=(Date[_0x1b5f83(0x245)]()-_0x3a7d8c)/(0x3e8*0x3c*0x3c);let _0x34e536='';_0xbe8297['config']['inactivityMonitoringEnabled']&&_0xbe8297[_0x1b5f83(0x386)]===SYSTEM_MODES[_0x1b5f83(0x26e)]&&_0xbe8297[_0x1b5f83(0x291)]&&(_0x1a53b6>_0x3c003c&&(_0x34e536=_0x1b5f83(0x1ad)+_0x1a53b6[_0x1b5f83(0x214)](0x1)+_0x1b5f83(0x1a1))),runGeminiAnalysis(_0xbe8297,_0x34e536)[_0x1b5f83(0x2f3)](_0x75e6dd=>_0xbe8297['log'][_0x1b5f83(0x20b)](_0x75e6dd));}async function createDailyDigest(_0x3036fb){const _0x3c4a19=a0_0x53276c;if(!_0x3036fb[_0x3c4a19(0x24a)])return;await _0x3036fb[_0x3c4a19(0x2f4)](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()[_0x3c4a19(0x2a3)](),'ack':!![]});if(!_0x3036fb['geminiModel']||_0x3036fb[_0x3c4a19(0x25c)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3036fb[_0x3c4a19(0x2f4)](LTM_DP_STATUS,{'val':_0x3c4a19(0x26d),'ack':!![]});return;}const _0x109cc5=JSON[_0x3c4a19(0x372)](JSON[_0x3c4a19(0x347)](_0x3036fb[_0x3c4a19(0x25c)])),_0x22942f=_0x109cc5[_0x3c4a19(0x1e0)],_0x5cfa94=_0x3c4a19(0x23f)+JSON[_0x3c4a19(0x347)](_0x109cc5);try{const _0x2a6f02=await _0x3036fb[_0x3c4a19(0x385)]['generateContent'](_0x5cfa94),_0x13af19=JSON[_0x3c4a19(0x372)](_0x2a6f02[_0x3c4a19(0x2a9)][_0x3c4a19(0x19b)]()[_0x3c4a19(0x2d4)](/```json|```/g,'')[_0x3c4a19(0x1b5)]());_0x13af19[_0x3c4a19(0x255)]&&(_0x3036fb['dailyDigests'][_0x3c4a19(0x363)]({'timestamp':new Date()[_0x3c4a19(0x27c)](),'eventCount':_0x22942f,'summary':_0x13af19[_0x3c4a19(0x255)],'activityLevel':_0x13af19['activityLevel'],'systemMode':_0x3036fb[_0x3c4a19(0x386)]}),await saveDailyDigests(_0x3036fb),_0x3036fb[_0x3c4a19(0x25c)]=[],await saveRawEventLog(_0x3036fb),await _0x3036fb[_0x3c4a19(0x2f4)](LTM_DP_STATUS,{'val':'Success:\x20Compressed\x20'+_0x22942f+_0x3c4a19(0x270),'ack':!![]}),runPythonHealthCheck(_0x3036fb));}catch(_0x1034fa){await _0x3036fb[_0x3c4a19(0x2f4)](LTM_DP_STATUS,{'val':'Error:\x20'+_0x1034fa[_0x3c4a19(0x33d)],'ack':!![]});}}async function sendMorningBriefing(_0x1d17f9){const _0x3715cf=a0_0x53276c;if(!_0x1d17f9[_0x3715cf(0x385)])return;_0x1d17f9[_0x3715cf(0x36f)][_0x3715cf(0x341)](_0x3715cf(0x213));const _0x4780c3=_0x1d17f9[_0x3715cf(0x205)]['length']>0x0?_0x1d17f9[_0x3715cf(0x205)][_0x1d17f9[_0x3715cf(0x205)][_0x3715cf(0x1e0)]-0x1]:null,_0xb5357f=_0x4780c3&&_0x4780c3[_0x3715cf(0x2c0)]?_0x4780c3[_0x3715cf(0x2c0)][_0x3715cf(0x373)]:_0x3715cf(0x1be),_0x1da713=new Date();_0x1da713[_0x3715cf(0x1a3)](0x4,0x0,0x0,0x0);const _0x4196f2=_0x1d17f9[_0x3715cf(0x22e)]['filter'](_0xc4c418=>new Date(_0xc4c418[_0x3715cf(0x26a)])>_0x1da713),_0x5b1772=PERSONA_MAPPING[_0x1d17f9[_0x3715cf(0x382)][_0x3715cf(0x325)]||_0x3715cf(0x387)],_0x5183c4=_0x1d17f9[_0x3715cf(0x382)][_0x3715cf(0x380)]||'',_0x5362f5=await getWeatherContext(_0x1d17f9),_0x33c739=await getCalendarContext(_0x1d17f9),_0x19f9e8=_0x3715cf(0x2e5)+_0x5b1772+_0x3715cf(0x2d3)+_0x5183c4+_0x3715cf(0x21e)+_0x5362f5+'\x20'+_0x33c739+_0x3715cf(0x244)+_0xb5357f+_0x3715cf(0x282)+JSON[_0x3715cf(0x347)](_0x4196f2['slice'](0x0,0xa))+'.\x20OUTPUT:\x20Nur\x20Text.';try{const _0x33ad69=await _0x1d17f9['geminiModel'][_0x3715cf(0x209)](_0x19f9e8),_0x1d6f9a=_0x3715cf(0x181)+_0x33ad69['response'][_0x3715cf(0x19b)]()[_0x3715cf(0x1b5)]();sendNotification(_0x1d17f9,_0x1d6f9a),_0x1d17f9['log'][_0x3715cf(0x341)](_0x3715cf(0x27b));}catch(_0x93adb2){_0x1d17f9[_0x3715cf(0x36f)][_0x3715cf(0x20b)](_0x3715cf(0x2cd)+_0x93adb2['message']);}}async function scanForDevices(_0x43aef7,_0x4b9812){const _0x15b3d2=a0_0x53276c;_0x43aef7[_0x15b3d2(0x36f)][_0x15b3d2(0x341)](_0x15b3d2(0x259));const _0xa58780=[],_0x3b7448=await _0x43aef7['getForeignObjectsAsync']('*'),_0x21b4de=await _0x43aef7[_0x15b3d2(0x1aa)](_0x15b3d2(0x33e),_0x15b3d2(0x2fa)),_0x422d59=await _0x43aef7[_0x15b3d2(0x1aa)](_0x15b3d2(0x307),_0x15b3d2(0x2fa)),_0x37f099={};if(_0x21b4de)for(const _0x291c2e in _0x21b4de){const _0x2408eb=_0x21b4de[_0x291c2e]['common'][_0x15b3d2(0x36a)]||[];_0x2408eb['forEach'](_0x162d9f=>{if(!_0x37f099[_0x162d9f])_0x37f099[_0x162d9f]=[];_0x37f099[_0x162d9f]['push'](_0x291c2e);});}const _0x4f1c88={};if(_0x422d59)for(const _0x19c21c in _0x422d59){const _0x5cba9e=_0x422d59[_0x19c21c][_0x15b3d2(0x2e8)]['members']||[],_0x4901a2=typeof _0x422d59[_0x19c21c][_0x15b3d2(0x2e8)]['name']==='object'?_0x422d59[_0x19c21c][_0x15b3d2(0x2e8)][_0x15b3d2(0x331)]['de']:_0x422d59[_0x19c21c][_0x15b3d2(0x2e8)][_0x15b3d2(0x331)];_0x5cba9e[_0x15b3d2(0x235)](_0x149f57=>_0x4f1c88[_0x149f57]=_0x4901a2);}const _0x426d35=_0x4b9812['selectedFunctionIds']||[],_0xa7e7b9=_0x4b9812[_0x15b3d2(0x349)]!==![],_0x51dbb1=_0x4b9812[_0x15b3d2(0x31e)]!==![],_0x8e26ba=_0x4b9812[_0x15b3d2(0x317)]!==![],_0x549aa0=_0x4b9812[_0x15b3d2(0x32d)]===!![],_0xbbf603=_0x4b9812['weather']===!![];for(const _0x278ac2 in _0x3b7448){const _0x54f8f2=_0x3b7448[_0x278ac2];if(_0x54f8f2[_0x15b3d2(0x193)]!==_0x15b3d2(0x2ad)||!_0x54f8f2[_0x15b3d2(0x2e8)])continue;if(ADAPTER_BLACKLIST['some'](_0x187d1f=>_0x278ac2[_0x15b3d2(0x274)](_0x187d1f))&&!_0xbbf603)continue;const _0x896ad1=(_0x54f8f2[_0x15b3d2(0x2e8)][_0x15b3d2(0x1fb)]||'')[_0x15b3d2(0x261)]();let _0x376e20=(typeof _0x54f8f2[_0x15b3d2(0x2e8)][_0x15b3d2(0x331)]===_0x15b3d2(0x35c)?_0x54f8f2[_0x15b3d2(0x2e8)][_0x15b3d2(0x331)]['de']:_0x54f8f2[_0x15b3d2(0x2e8)][_0x15b3d2(0x331)])||_0x278ac2;const _0x5e29e3=_0x376e20[_0x15b3d2(0x261)]();let _0xf66e60=![],_0x4d2f6b=![];if(_0x426d35[_0x15b3d2(0x1e0)]>0x0){const _0x594c36=_0x37f099[_0x278ac2]||[],_0x34fed5=_0x278ac2['split']('.')[_0x15b3d2(0x24f)](0x0,-0x1)[_0x15b3d2(0x367)]('.'),_0x495c6d=_0x37f099[_0x34fed5]||[];(_0x594c36[_0x15b3d2(0x2bb)](_0x13001a=>_0x426d35[_0x15b3d2(0x330)](_0x13001a))||_0x495c6d[_0x15b3d2(0x2bb)](_0x346ceb=>_0x426d35[_0x15b3d2(0x330)](_0x346ceb)))&&(_0xf66e60=!![],_0x4d2f6b=!![]);}if(!_0xf66e60&&!_0xbbf603){if(HARD_IGNORE_TERMS[_0x15b3d2(0x2bb)](_0x149b78=>_0x278ac2['includes'](_0x149b78)||_0x5e29e3[_0x15b3d2(0x330)](_0x149b78[_0x15b3d2(0x261)]())))continue;}if(BAD_NAMES[_0x15b3d2(0x2bb)](_0x246e54=>_0x5e29e3===_0x246e54||_0x5e29e3[_0x15b3d2(0x1a2)]('.'+_0x246e54))){const _0x587e02=_0x278ac2[_0x15b3d2(0x1b1)]('.');if(_0x587e02[_0x15b3d2(0x1e0)]>0x2){const _0x47ffba=_0x587e02[_0x15b3d2(0x24f)](0x0,-0x1)['join']('.'),_0x2c0421=_0x3b7448[_0x47ffba];if(_0x2c0421&&_0x2c0421['common']&&_0x2c0421[_0x15b3d2(0x2e8)][_0x15b3d2(0x331)]){const _0x5da67b=typeof _0x2c0421[_0x15b3d2(0x2e8)][_0x15b3d2(0x331)]==='object'?_0x2c0421['common']['name']['de']:_0x2c0421[_0x15b3d2(0x2e8)][_0x15b3d2(0x331)];_0x5da67b&&!_0x376e20[_0x15b3d2(0x330)](_0x5da67b)&&(_0x376e20=_0x5da67b+'\x20'+_0x376e20);}}}let _0x1161c4='';if(_0xa7e7b9&&(_0x896ad1[_0x15b3d2(0x330)](_0x15b3d2(0x349))||_0x896ad1[_0x15b3d2(0x330)](_0x15b3d2(0x288))||_0x5e29e3[_0x15b3d2(0x330)](_0x15b3d2(0x30c))||_0x5e29e3[_0x15b3d2(0x330)]('pr√§senz')))_0x1161c4=_0x15b3d2(0x349);else{if(!_0x1161c4&&_0x51dbb1&&(_0x896ad1['includes']('door')||_0x896ad1[_0x15b3d2(0x330)](_0x15b3d2(0x1bb))||_0x896ad1[_0x15b3d2(0x330)](_0x15b3d2(0x29a))||_0x896ad1[_0x15b3d2(0x330)](_0x15b3d2(0x24e))||_0x896ad1[_0x15b3d2(0x330)]('shutter')||_0x5e29e3['includes'](_0x15b3d2(0x1c7))||_0x5e29e3['includes'](_0x15b3d2(0x284))||_0x5e29e3[_0x15b3d2(0x330)](_0x15b3d2(0x254))))_0x1161c4=_0x15b3d2(0x1a9);else{if(!_0x1161c4&&_0x8e26ba&&(_0x896ad1[_0x15b3d2(0x330)](_0x15b3d2(0x29b))||_0x896ad1['includes']('switch')||_0x896ad1['includes'](_0x15b3d2(0x1b9))||_0x5e29e3[_0x15b3d2(0x330)](_0x15b3d2(0x2df))||_0x5e29e3[_0x15b3d2(0x330)]('lampe')||_0x5e29e3[_0x15b3d2(0x330)](_0x15b3d2(0x2f6)))){if(_0x54f8f2[_0x15b3d2(0x2e8)][_0x15b3d2(0x28d)]||_0x896ad1[_0x15b3d2(0x330)](_0x15b3d2(0x299)))_0x1161c4=_0x15b3d2(0x29b);}else{if(!_0x1161c4&&_0x549aa0&&(_0x896ad1[_0x15b3d2(0x330)]('temperature')||_0x896ad1[_0x15b3d2(0x330)]('humidity')||_0x896ad1[_0x15b3d2(0x330)](_0x15b3d2(0x321))||_0x5e29e3[_0x15b3d2(0x330)](_0x15b3d2(0x354))||_0x5e29e3[_0x15b3d2(0x330)](_0x15b3d2(0x389))||_0x5e29e3[_0x15b3d2(0x330)]('heizung')))_0x1161c4=_0x15b3d2(0x32d);else{if(!_0x1161c4&&_0x4d2f6b)_0x1161c4=_0x15b3d2(0x220);}}}}if(_0x1161c4){let _0x430bba=_0x4f1c88[_0x278ac2]||'';if(!_0x430bba){let _0x22c058=_0x278ac2;for(let _0xb157c8=0x0;_0xb157c8<0x3;_0xb157c8++){const _0x4f3e5c=_0x22c058[_0x15b3d2(0x328)]('.');if(_0x4f3e5c===-0x1)break;_0x22c058=_0x22c058[_0x15b3d2(0x1b2)](0x0,_0x4f3e5c);if(_0x4f1c88[_0x22c058]){_0x430bba=_0x4f1c88[_0x22c058];break;}}}_0xa58780[_0x15b3d2(0x363)]({'id':_0x278ac2,'name':_0x376e20,'location':_0x430bba,'type':_0x1161c4,'logDuplicates':_0x1161c4===_0x15b3d2(0x349),'isExit':![],'_score':_0x430bba?0x50:_0x1161c4===_0x15b3d2(0x220)?0x5a:0x28});}}return _0xa58780['sort']((_0x2eabbe,_0x24b5fd)=>_0x24b5fd[_0x15b3d2(0x1da)]-_0x2eabbe[_0x15b3d2(0x1da)]),_0xa58780;}async function executeAutomationAction(_0x32517b){const _0x5b8290=a0_0x53276c;try{const _0x40efca=await _0x32517b['getStateAsync'](_0x5b8290(0x24d)),_0x3c8b36=await _0x32517b['getStateAsync'](_0x5b8290(0x37c));if(_0x40efca&&_0x40efca[_0x5b8290(0x32f)]&&_0x3c8b36){const _0xa8b486=_0x40efca[_0x5b8290(0x32f)];let _0x17b70c=_0x3c8b36[_0x5b8290(0x32f)];try{_0x17b70c=JSON[_0x5b8290(0x372)](_0x17b70c);}catch(_0x1e9d40){}_0x32517b[_0x5b8290(0x36f)][_0x5b8290(0x341)](_0x5b8290(0x2bf)+_0xa8b486+_0x5b8290(0x232)+_0x17b70c),await _0x32517b['setForeignStateAsync'](_0xa8b486,_0x17b70c);}else _0x32517b[_0x5b8290(0x36f)][_0x5b8290(0x2b2)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x4a0953){_0x32517b[_0x5b8290(0x36f)][_0x5b8290(0x20b)](_0x5b8290(0x233)+_0x4a0953[_0x5b8290(0x33d)]);}}function tryParse(_0x24318c){const _0x308b1b=a0_0x53276c;try{return JSON[_0x308b1b(0x372)](_0x24318c);}catch(_0x3971ea){return null;}}async function recordSequence(_0x9c5ece,_0xd17034){const _0x580e37=a0_0x53276c,_0x3629ac=(_0xd17034[_0x580e37(0x193)]||'')[_0x580e37(0x261)](),_0x58ebdf=[_0x580e37(0x349),'bewegung',_0x580e37(0x1c0),_0x580e37(0x234),'occupancy',_0x580e37(0x1a9),_0x580e37(0x284),_0x580e37(0x1bb),'fenster','contact',_0x580e37(0x287),_0x580e37(0x29b),_0x580e37(0x2df),_0x580e37(0x376),'schalter',_0x580e37(0x1b9),_0x580e37(0x1d7)];if(!_0x58ebdf[_0x580e37(0x2bb)](_0x32ae56=>_0x3629ac['includes'](_0x32ae56))){_0x9c5ece[_0x580e37(0x36f)][_0x580e37(0x322)](_0x580e37(0x1c3)+_0xd17034['id']+_0x580e37(0x2a4)+_0xd17034[_0x580e37(0x193)]+_0x580e37(0x338));return;}if(!_0xd17034['value']){_0x9c5ece['log'][_0x580e37(0x322)](_0x580e37(0x1c3)+_0xd17034['id']+_0x580e37(0x217)+_0xd17034['value']+')');return;}_0x9c5ece[_0x580e37(0x36f)]['debug']('[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20'+_0xd17034['id']+'\x20('+_0xd17034['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x564cd8={'loc':_0xd17034[_0x580e37(0x2ab)]||_0x580e37(0x34f),'id':_0xd17034['id'],'ts':Date['now']()};activeSequence[_0x580e37(0x363)](_0x564cd8),_0x9c5ece['log'][_0x580e37(0x322)](_0x580e37(0x2c4)+_0x564cd8[_0x580e37(0x20d)]+_0x580e37(0x266)+activeSequence[_0x580e37(0x1e0)]+')'),sequenceTimer=setTimeout(async()=>{const _0x126eca=_0x580e37;activeSequence['length']>0x1?await saveCompletedSequence(_0x9c5ece):(_0x9c5ece[_0x126eca(0x36f)][_0x126eca(0x322)](_0x126eca(0x2dc)+activeSequence[_0x126eca(0x1e0)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x41a560){const _0x40eba5=a0_0x53276c;try{_0x41a560[_0x40eba5(0x36f)][_0x40eba5(0x341)](_0x40eba5(0x1f5)+activeSequence[_0x40eba5(0x1e0)]+_0x40eba5(0x366));const _0x52b28c=await _0x41a560[_0x40eba5(0x2fe)](_0x40eba5(0x1cf));let _0x10d7a1=[];if(_0x52b28c&&_0x52b28c[_0x40eba5(0x32f)])try{_0x10d7a1=JSON[_0x40eba5(0x372)](_0x52b28c[_0x40eba5(0x32f)]);}catch(_0xe520d8){}const _0x322567=activeSequence[0x0]['ts'],_0x44fd44=activeSequence[_0x40eba5(0x226)](_0xcd919b=>({'loc':_0xcd919b['loc'],'t_delta':Math[_0x40eba5(0x189)]((_0xcd919b['ts']-_0x322567)/0x3e8)})),_0x4a16ff={'timestamp':new Date(_0x322567)[_0x40eba5(0x27c)](),'steps':_0x44fd44,'duration':Math[_0x40eba5(0x189)]((activeSequence[activeSequence[_0x40eba5(0x1e0)]-0x1]['ts']-_0x322567)/0x3e8),'daytime':new Date(_0x322567)[_0x40eba5(0x267)]()};_0x10d7a1[_0x40eba5(0x363)](_0x4a16ff),_0x10d7a1[_0x40eba5(0x1e0)]>MAX_TRAINING_SET_SIZE&&_0x10d7a1[_0x40eba5(0x1a8)](),await _0x41a560[_0x40eba5(0x2f4)](_0x40eba5(0x1cf),{'val':JSON[_0x40eba5(0x347)](_0x10d7a1),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x4812c8){_0x41a560[_0x40eba5(0x36f)][_0x40eba5(0x20b)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x4812c8[_0x40eba5(0x33d)]);}}async function getOutsideTemperatureNumeric(_0x1bb112){const _0x29c7e0=a0_0x53276c;if(_0x1bb112['config']['outdoorSensorId'])try{const _0x4517ea=await _0x1bb112[_0x29c7e0(0x1d3)](_0x1bb112['config'][_0x29c7e0(0x37f)]);if(_0x4517ea&&_0x4517ea['val']!==undefined&&_0x4517ea[_0x29c7e0(0x32f)]!==null){const _0x290298=parseFloat(_0x4517ea[_0x29c7e0(0x32f)]);if(!isNaN(_0x290298))return _0x290298;}}catch(_0x15e795){_0x1bb112[_0x29c7e0(0x36f)][_0x29c7e0(0x2b2)]('Error\x20reading\x20outdoor\x20sensor\x20'+_0x1bb112[_0x29c7e0(0x382)]['outdoorSensorId']+':\x20'+_0x15e795[_0x29c7e0(0x33d)]);}const _0x502ec7=_0x1bb112['config'][_0x29c7e0(0x289)];if(!_0x1bb112['config'][_0x29c7e0(0x2ee)]||!_0x502ec7)return null;try{let _0x20240b='';if(_0x502ec7[_0x29c7e0(0x330)](_0x29c7e0(0x22d)))_0x20240b=_0x502ec7+'.Current.Temperature';else{if(_0x502ec7[_0x29c7e0(0x330)](_0x29c7e0(0x20f)))_0x20240b=_0x502ec7+_0x29c7e0(0x249);else{if(_0x502ec7[_0x29c7e0(0x330)](_0x29c7e0(0x306)))_0x20240b=_0x502ec7+'.forecast.current.temperature';else{if(_0x502ec7[_0x29c7e0(0x330)]('weatherunderground'))_0x20240b=_0x502ec7+_0x29c7e0(0x192);}}}if(_0x20240b){const _0x2c90cb=await _0x1bb112[_0x29c7e0(0x1d3)](_0x20240b);if(_0x2c90cb&&_0x2c90cb[_0x29c7e0(0x32f)]!==undefined&&_0x2c90cb[_0x29c7e0(0x32f)]!==null)return parseFloat(_0x2c90cb[_0x29c7e0(0x32f)]);}}catch(_0x17b16a){}return null;}async function recordThermodynamics(_0x1f83dd,_0x10aad8,_0x478747,_0x49398b){const _0x158d0d=a0_0x53276c,_0x278a6e=await getOutsideTemperatureNumeric(_0x1f83dd),_0x3b91d8=await _0x1f83dd['getStateAsync'](_0x158d0d(0x269));let _0x16afa5=[];if(_0x3b91d8&&_0x3b91d8['val'])try{_0x16afa5=JSON['parse'](_0x3b91d8[_0x158d0d(0x32f)]);}catch(_0x4c518f){}_0x16afa5['push']({'ts':Date[_0x158d0d(0x245)](),'room':_0x49398b||_0x158d0d(0x34f),'t_in':_0x478747,'t_out':_0x278a6e});if(_0x16afa5[_0x158d0d(0x1e0)]>THERMO_LOG_SIZE)_0x16afa5[_0x158d0d(0x1a8)]();await _0x1f83dd['setStateAsync'](_0x158d0d(0x269),{'val':JSON[_0x158d0d(0x347)](_0x16afa5),'ack':!![]});}async function processSensorEvent(_0x2f80b4,_0xfa5bb6,_0xac8e33,_0x27c6b9){const _0x4b156d=a0_0x53276c;if(!_0x27c6b9)return;const _0x543edd=_0xac8e33[_0x4b156d(0x32f)],_0x4f68f3=Date[_0x4b156d(0x245)]();_0x2f80b4[_0x4b156d(0x36f)]['debug']('Event\x20received:\x20'+_0xfa5bb6+_0x4b156d(0x232)+_0x543edd);const _0x56026a=_0x2f80b4['sensorLastValues'][_0xfa5bb6];_0x2f80b4[_0x4b156d(0x323)][_0xfa5bb6]=_0x543edd;if(!_0x27c6b9[_0x4b156d(0x2b0)]&&_0x56026a!=undefined&&_0x56026a==_0x543edd){_0x2f80b4[_0x4b156d(0x36f)][_0x4b156d(0x322)]('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x27c6b9['name']+_0x4b156d(0x2da)+_0x543edd+')');return;}_0x2f80b4[_0x4b156d(0x24a)]&&_0x27c6b9[_0x4b156d(0x193)]==='temperature'&&recordThermodynamics(_0x2f80b4,_0xfa5bb6,_0x543edd,_0x27c6b9[_0x4b156d(0x2ab)]);const _0x247354={'timestamp':_0x4f68f3,'id':_0xfa5bb6,'name':_0x27c6b9['name'],'type':_0x27c6b9[_0x4b156d(0x193)],'location':_0x27c6b9[_0x4b156d(0x2ab)],'value':_0x543edd};_0x2f80b4[_0x4b156d(0x22e)][_0x4b156d(0x1bc)](_0x247354);if(_0x2f80b4[_0x4b156d(0x22e)][_0x4b156d(0x1e0)]>HISTORY_MAX_SIZE)_0x2f80b4[_0x4b156d(0x22e)][_0x4b156d(0x1df)]();await _0x2f80b4[_0x4b156d(0x2f4)](_0x4b156d(0x2b7),{'val':JSON[_0x4b156d(0x347)](_0x247354),'ack':!![]}),await _0x2f80b4[_0x4b156d(0x2f4)]('events.history',{'val':JSON[_0x4b156d(0x347)](_0x2f80b4[_0x4b156d(0x22e)]),'ack':!![]});_0x2f80b4[_0x4b156d(0x24a)]&&(_0x2f80b4[_0x4b156d(0x25c)][_0x4b156d(0x363)](_0x247354),await saveRawEventLog(_0x2f80b4),recordSequence(_0x2f80b4,_0x247354));if(_0x27c6b9[_0x4b156d(0x230)]&&_0x543edd===!![]){if(_0x2f80b4['isPresent']&&!_0x2f80b4[_0x4b156d(0x292)])_0x2f80b4[_0x4b156d(0x36f)][_0x4b156d(0x341)](_0x4b156d(0x260)+_0x27c6b9[_0x4b156d(0x331)]+').\x20Starting\x20Timer.'),startExitTimer(_0x2f80b4);else!_0x2f80b4[_0x4b156d(0x291)]&&(_0x2f80b4[_0x4b156d(0x36f)][_0x4b156d(0x341)](_0x4b156d(0x1bf)+_0x27c6b9['name']+'.\x20Welcome\x20home.'),await setPresence(_0x2f80b4,!![]));}else _0x27c6b9[_0x4b156d(0x193)]===_0x4b156d(0x349)&&_0x543edd===!![]&&(_0x2f80b4[_0x4b156d(0x243)]&&(_0x2f80b4[_0x4b156d(0x36f)][_0x4b156d(0x341)](_0x4b156d(0x2d5)),abortExitTimer(_0x2f80b4)),!_0x2f80b4[_0x4b156d(0x291)]&&_0x2f80b4[_0x4b156d(0x386)]===SYSTEM_MODES[_0x4b156d(0x26e)]&&await setPresence(_0x2f80b4,!![]));}async function runGeminiAnalysis(_0x2676e8,_0x5de32f=''){const _0x5d698c=a0_0x53276c;if(!_0x2676e8[_0x5d698c(0x385)])return;if(_0x2676e8[_0x5d698c(0x22e)]['length']===0x0)return;const _0x5cc11c=_0x2676e8[_0x5d698c(0x22e)][_0x5d698c(0x24f)](0x0,0xf),_0x1d8d4f=await getWeatherContext(_0x2676e8),_0x4656ae=_0x2676e8[_0x5d698c(0x386)],_0x2f7180=PERSONA_MAPPING[_0x2676e8[_0x5d698c(0x382)]['aiPersona']||_0x5d698c(0x387)],_0x2be306=_0x2676e8['config'][_0x5d698c(0x380)]||'Keine\x20Details.';let _0x1a9abc=![];try{const _0x966e79=await _0x2676e8[_0x5d698c(0x2fe)]('analysis.automation.autoApply');if(_0x966e79&&_0x966e79[_0x5d698c(0x32f)])_0x1a9abc=!![];}catch(_0x3be65e){}const _0x38afda=_0x5d698c(0x1f9)+_0x2f7180+_0x5d698c(0x251)+_0x2be306+_0x5d698c(0x2de)+_0x4656ae+_0x5d698c(0x353)+_0x1d8d4f+_0x5d698c(0x361)+(_0x5de32f||_0x5d698c(0x300))+_0x5d698c(0x356)+JSON[_0x5d698c(0x347)](_0x5cc11c)+_0x5d698c(0x27f);try{const _0x183627=await _0x2676e8['geminiModel'][_0x5d698c(0x209)](_0x38afda),_0xbe6878=_0x183627[_0x5d698c(0x2a9)][_0x5d698c(0x19b)]()[_0x5d698c(0x2d4)](/```json|```/g,'')['trim'](),_0x597319=JSON['parse'](_0xbe6878);await _0x2676e8['setStateAsync'](_0x5d698c(0x2fd),{'val':JSON[_0x5d698c(0x347)](_0x597319),'ack':!![]});_0x597319[_0x5d698c(0x255)]&&await _0x2676e8[_0x5d698c(0x2f4)]('analysis.activitySummary',{'val':_0x597319['summary'],'ack':!![]});const _0x51955c={'timestamp':Date[_0x5d698c(0x245)](),'id':Date[_0x5d698c(0x245)]()[_0x5d698c(0x2c2)](),'analysis':{'activity':{'summary':_0x597319[_0x5d698c(0x255)]||'Keine\x20Analyse.','isAlert':_0x597319[_0x5d698c(0x296)]||![],'alertReason':_0x597319['alertReason']},'comfort':{'automationProposal':_0x597319[_0x5d698c(0x278)]}}};await updateAnalysisHistory(_0x2676e8,_0x51955c);const _0x34de0f=_0x597319['isAlert']||![];_0x34de0f!==_0x2676e8[_0x5d698c(0x1ab)]&&(await _0x2676e8[_0x5d698c(0x2f4)](_0x5d698c(0x223),{'val':_0x34de0f,'ack':!![]}),_0x2676e8[_0x5d698c(0x1ab)]=_0x34de0f,_0x34de0f&&(await _0x2676e8['setStateAsync'](_0x5d698c(0x383),{'val':_0x597319[_0x5d698c(0x1dd)],'ack':!![]}),sendNotification(_0x2676e8,'‚ö†Ô∏è\x20ALARM:\x20'+_0x597319[_0x5d698c(0x1dd)],![],_0x597319[_0x5d698c(0x2fc)]))),_0x597319['automationProposal']&&_0x597319['automationProposal']['detected']&&_0x597319[_0x5d698c(0x278)][_0x5d698c(0x298)]&&(_0x2676e8[_0x5d698c(0x36f)][_0x5d698c(0x341)](_0x5d698c(0x29c)+_0x597319['automationProposal']['description']),await _0x2676e8[_0x5d698c(0x2f4)](_0x5d698c(0x34b),{'val':!![],'ack':!![]}),await _0x2676e8[_0x5d698c(0x2f4)]('analysis.automation.description',{'val':_0x597319[_0x5d698c(0x278)][_0x5d698c(0x357)],'ack':!![]}),await _0x2676e8[_0x5d698c(0x2f4)](_0x5d698c(0x24d),{'val':_0x597319[_0x5d698c(0x278)][_0x5d698c(0x298)],'ack':!![]}),await _0x2676e8[_0x5d698c(0x2f4)](_0x5d698c(0x37c),{'val':JSON[_0x5d698c(0x347)](_0x597319[_0x5d698c(0x278)][_0x5d698c(0x32b)]),'ack':!![]}),_0x1a9abc&&(_0x2676e8['log'][_0x5d698c(0x341)](_0x5d698c(0x1cc)+_0x597319[_0x5d698c(0x278)][_0x5d698c(0x298)]+_0x5d698c(0x345)),await executeAutomationAction(_0x2676e8)));}catch(_0x40ed1a){_0x2676e8['log'][_0x5d698c(0x20b)](_0x5d698c(0x212)+_0x40ed1a['message']);}}function installPythonDependencies(_0x31ccae){const _0x3bec19=a0_0x53276c;if(_0x31ccae[_0x3bec19(0x1b3)])return;_0x31ccae[_0x3bec19(0x1b3)]=!![];const _0x2c9727=path[_0x3bec19(0x367)](__dirname,_0x3bec19(0x332),_0x3bec19(0x1d9));_0x31ccae[_0x3bec19(0x36f)][_0x3bec19(0x341)](_0x3bec19(0x1d2)+_0x2c9727+'...'),stopPythonService(_0x31ccae);const _0x422324=_0x3bec19(0x2b4)+_0x2c9727+'\x22\x20--break-system-packages';exec(_0x422324,(_0x16be81,_0x51762c,_0x3e7b34)=>{const _0x1d964d=_0x3bec19;_0x31ccae[_0x1d964d(0x1b3)]=![],_0x16be81?(_0x31ccae[_0x1d964d(0x36f)][_0x1d964d(0x20b)]('‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x422324),_0x31ccae[_0x1d964d(0x36f)][_0x1d964d(0x20b)](_0x1d964d(0x316)+(_0x3e7b34||_0x16be81[_0x1d964d(0x33d)]))):(_0x31ccae[_0x1d964d(0x36f)][_0x1d964d(0x341)](_0x1d964d(0x2f7)),startPythonService(_0x31ccae));});}function sendToPython(_0x33917a,_0x5230f3,_0xc8b645={}){const _0x5cbe27=a0_0x53276c;if(!_0x33917a[_0x5cbe27(0x29e)]||!_0x33917a[_0x5cbe27(0x29e)][_0x5cbe27(0x370)][_0x5cbe27(0x206)])return;const _0x55ddfc=JSON['stringify']({'command':_0x5230f3,..._0xc8b645});try{_0x33917a[_0x5cbe27(0x29e)][_0x5cbe27(0x370)]['write'](_0x55ddfc+'\x0a');}catch(_0xf1940e){_0x33917a[_0x5cbe27(0x36f)][_0x5cbe27(0x20b)](_0x5cbe27(0x38c)+_0xf1940e[_0x5cbe27(0x33d)]);}}function runPythonHealthCheck(_0x2cf4ee){const _0x3fefa4=a0_0x53276c;if(!_0x2cf4ee[_0x3fefa4(0x205)]||_0x2cf4ee[_0x3fefa4(0x205)][_0x3fefa4(0x1e0)]<0x2){_0x2cf4ee['log'][_0x3fefa4(0x341)]('Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.');return;}const _0x2545bb=_0x2cf4ee[_0x3fefa4(0x205)][_0x3fefa4(0x226)](_0x5ae516=>{const _0x57bd38=_0x3fefa4,_0x163573=(_0x5ae516[_0x57bd38(0x2e9)]||'')[_0x57bd38(0x261)]();return ACTIVITY_LEVEL_MAP[_0x163573]||0x32;});_0x2cf4ee[_0x3fefa4(0x36f)][_0x3fefa4(0x341)]('Guardian:\x20Sending\x20'+_0x2545bb[_0x3fefa4(0x1e0)]+_0x3fefa4(0x1c5)),sendToPython(_0x2cf4ee,_0x3fefa4(0x375),{'values':_0x2545bb,'tag':_0x3fefa4(0x327)});}function handlePythonResult(_0x11cac6,_0xd314d7){const _0x2d363d=a0_0x53276c;if(_0xd314d7[_0x2d363d(0x193)]==='PONG')_0x11cac6[_0x2d363d(0x36f)][_0x2d363d(0x322)](_0x2d363d(0x384));else{if(_0xd314d7['type']===_0x2d363d(0x240)){const {tag:_0x233693,diagnosis:_0x2e18c8,change_percent:_0x5f135e}=_0xd314d7[_0x2d363d(0x20a)];_0x11cac6[_0x2d363d(0x36f)][_0x2d363d(0x341)](_0x2d363d(0x1b7)+_0x233693+_0x2d363d(0x31c)+_0x2e18c8+'\x20('+_0x5f135e+'%)'),_0x11cac6[_0x2d363d(0x2f4)](_0x2d363d(0x2cc),{'val':_0x2e18c8,'ack':!![]}),_0x11cac6['setStateAsync'](_0x2d363d(0x2bd),{'val':_0x5f135e,'ack':!![]});}}}function startPythonService(_0x2af860){const _0x2b8b31=a0_0x53276c;try{const _0x76ac33=path[_0x2b8b31(0x367)](__dirname,_0x2b8b31(0x332),_0x2b8b31(0x196));_0x2af860[_0x2b8b31(0x36f)][_0x2b8b31(0x341)](_0x2b8b31(0x18c)+_0x76ac33),_0x2af860['pythonProcess']=spawn(_0x2b8b31(0x184),[_0x76ac33]),_0x2af860['pythonProcess']['stdout']['on'](_0x2b8b31(0x1f6),_0x4429a3=>{const _0x355afd=_0x2b8b31,_0x1a7d92=_0x4429a3[_0x355afd(0x2c2)]()[_0x355afd(0x1b1)]('\x0a');_0x1a7d92[_0x355afd(0x235)](_0x32073e=>{const _0x2b9536=_0x355afd,_0x5dd40c=_0x32073e[_0x2b9536(0x1b5)]();if(!_0x5dd40c)return;if(_0x5dd40c[_0x2b9536(0x274)](_0x2b9536(0x2e2)))_0x2af860[_0x2b9536(0x36f)][_0x2b9536(0x322)]('[PYTHON]\x20'+_0x5dd40c[_0x2b9536(0x1b2)](0x5)[_0x2b9536(0x1b5)]());else{if(_0x5dd40c[_0x2b9536(0x274)](_0x2b9536(0x283)))try{const _0x57b7dd=JSON[_0x2b9536(0x372)](_0x5dd40c[_0x2b9536(0x1b2)](0x8)['trim']());handlePythonResult(_0x2af860,_0x57b7dd);}catch(_0x104b62){_0x2af860['log'][_0x2b9536(0x2b2)](_0x2b9536(0x1c1)+_0x5dd40c);}}(_0x5dd40c['includes'](_0x2b9536(0x1fd))||_0x5dd40c[_0x2b9536(0x330)](_0x2b9536(0x27d)))&&(_0x2af860['log']['warn']('‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...'),installPythonDependencies(_0x2af860));});}),_0x2af860['pythonProcess'][_0x2b8b31(0x185)]['on'](_0x2b8b31(0x1f6),_0x1fbeb6=>{const _0xd3f984=_0x2b8b31,_0x56d810=_0x1fbeb6[_0xd3f984(0x2c2)]()['trim']();_0x2af860[_0xd3f984(0x36f)][_0xd3f984(0x20b)](_0xd3f984(0x2f9)+_0x56d810);}),_0x2af860['pythonProcess']['on'](_0x2b8b31(0x32e),_0x5cd873=>{const _0x89ed30=_0x2b8b31;_0x2af860[_0x89ed30(0x36f)]['info']('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x5cd873),_0x2af860[_0x89ed30(0x29e)]=null;}),_0x2af860[_0x2b8b31(0x29e)]['on'](_0x2b8b31(0x20b),_0x53779c=>{const _0x46c3b2=_0x2b8b31;_0x2af860['log'][_0x46c3b2(0x2b2)](_0x46c3b2(0x257)+_0x53779c[_0x46c3b2(0x33d)]);});}catch(_0x589d71){_0x2af860[_0x2b8b31(0x36f)][_0x2b8b31(0x20b)](_0x2b8b31(0x1d8)+_0x589d71[_0x2b8b31(0x33d)]);}}function stopPythonService(_0x1ec38d){const _0x2b7ada=a0_0x53276c;if(_0x1ec38d[_0x2b7ada(0x29e)]){_0x1ec38d[_0x2b7ada(0x36f)][_0x2b7ada(0x341)](_0x2b7ada(0x25a));try{_0x1ec38d[_0x2b7ada(0x29e)][_0x2b7ada(0x350)]();}catch(_0x32042b){_0x1ec38d[_0x2b7ada(0x36f)][_0x2b7ada(0x2b2)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x32042b['message']);}_0x1ec38d[_0x2b7ada(0x29e)]=null;}}function a0_0x5953(){const _0x27518b=['getHours','Briefing\x20Sched\x20Error:\x20','LTM.trainingData.thermodynamics','timestamp','LTM.triggerDailyDigest','Activity\x20Summary','Skipped\x20(No\x20AI\x20or\x20Data)','NORMAL','telegram','\x20events','fault','firmware','LTM.driftAnalysis.lastCheck','startsWith','command','sendToAsync','onMessage','automationProposal','Scheduling\x20Morning\x20Briefing\x20for\x20','analysis.triggerBriefing','Morning\x20Briefing\x20sent.','toISOString','Bibliotheken\x20nicht\x20gefunden','child_process','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','uuid-error','normal','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','[RESULT]','t√ºr','.NextHours.Location_1.Day_1.current.symbol_desc','system.config','kontakt','occupancy','weatherInstance','simulateButler','party','exports','write','value.health','AI\x20Emergency\x20Status','Baseline\x20Status','isPresent','isGracePeriodActive','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','Cogni-Living','vacation','isAlert','(((.+)+)+)+$','targetId','sensor','lock','light','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','config_pending','pythonProcess','longitude','event','info.','notifyTelegramEnabled','toLocaleString','\x20(Type\x20\x27','autoApply','notifyTelegramInstance','accuweather.0','system.meta.uuid','response','minDaysForBaseline','location','getTime','state','link_quality','Kein\x20API\x20Key!','logDuplicates','value','warn','notifyPushoverRecipient','python3\x20-m\x20pip\x20install\x20-r\x20\x22','Automation\x20Proposals','Feedback\x20saved:\x20','events.lastEvent','dismissAutomation','sound','PRIORIT√ÑT:\x20Gesundheit/AAL.','some','button','analysis.health.trendValue','Recorded\x20Motion\x20Sequences','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','health','notifyEmailRecipient','toString','140642vdOTws','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','onReady','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','onUnload','actual_temperature','indexOf','Urlaub','[TEST]\x20','analysis.health.trendDiagnosis','Briefing\x20Error:\x20','analysis.trigger','callback','unreach','modeResetJob','vis.','.\x20KONTEXT:\x20','replace','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','Daily\x20Digests','analysis.history_debug_00','isArray','submitFeedback','\x20(Value:\x20','Trend\x20Diagnosis\x20(Python)','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','path','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','licht','daswetter.0','Restoring\x20sensor\x20cache\x20from\x20history\x20(','[LOG]','analysis.health.notes','date','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','Feedback\x20Log','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','common','activityLevel',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','N/A\x20(Learning)','inactivityThresholdHours','analysis.health.restlessness','useWeather','Fokus\x20auf\x20Komfort.','Fehler:\x20','devices','Analysiere\x20ausgewogen.','catch','setStateAsync','Kalender:\x20Deaktiviert','schalter','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','Adapter','[PYTHON\x20ERR]\x20','enum','Starting\x20Autopilot\x20(','isEmergency','analysis.lastResult','getStateAsync','477890CLzNPS','Keiner','analysis.analysisHistory','_calName','uuid','lowbat','system','openweathermap','enum.rooms.*','reachable','COGNI_CONFIRM_OK','‚úÖ\x20PRO\x20ACTIVATED','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','bewegung','currentposition','subscribeStates','analysis.automation.autoApply','Trend\x20Value\x20(%)','Error\x20checking\x20WiFi:\x20','scheduleJob','systemUUID','TEST-PRO-KEY','geminiApiKey','Details:\x20','lights','briefingTime','analysisHistory','filter','analysis.health','):\x20','Gemini\x20Init\x20Error:\x20','doors','Fokus\x20auf\x20Familienroutinen.','No\x20instance','thermostat','debug','sensorLastValues','Party','aiPersona','LTM.driftAnalysis','Activity-Level','lastIndexOf','analysis.activitySummary','AI\x20Alert\x20Status','targetValue','humidity','temperature','close','val','includes','name','python_service','ltmDriftCheckIntervalHours','getMonth','28572203KmHPbU','setObjectNotExistsAsync','Logbook','\x27\x20not\x20in\x20allowed\x20list)','channel','PARTY','main','find','message','enum.functions.*','Alert\x20Reason','590939UbLjKf','info','briefingJob','direction','Restlessness\x20Level','...','driftAnalysisTimer','stringify','fill','motion','\x20sensors...','analysis.automation.patternDetected','9935joUNFC','@google/generative-ai','Gast','Unknown','kill','apiKey','cancel','.\x0a\x20\x20\x20\x20WETTER:\x20','temp','.forecast.current.state','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','description','LTM.driftAnalysis.driftDetails','‚ùå\x20FREE\x20MODE','Pattern\x20Detected','LTM.driftAnalysis.baselineDrift','object','Verbindung\x20erfolgreich!\x20Antwort:\x20','KI-Modell\x20nicht\x20initialisiert','Deviation','instance','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','detected','push','application/json','5739744xiZvPU',').\x20Saving\x20to\x20Training\x20Data.','join','System\x20Status\x20&\x20Control','models/gemini-flash-latest','members','simple-api.','system.isPresent','expire','position','log','stdin','system.mode','parse','sleepScore','scriptProblem','ANALYZE_TREND','switch','presenceDevices','Comfort\x20Summary','analysis.automation','4781LbOnZP','boolean','analysis.automation.targetValue','Thermodynamic\x20Data\x20Points','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','outdoorSensorId','livingContext','retry','config','analysis.alertReason','üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','geminiModel','currentSystemMode','generic','system.presenceWho','klima','analysis.automation.triggerAction','guest','Failed\x20to\x20send\x20to\x20Python:\x20','triggerDailyDigest','events.history','üåÖ\x20Daily\x20Briefing:\x0a','send','99jtjLQZ','python3','stderr','briefingEnabled','Deaktiviert\x20(Pro-Feature)','analysis.automation.suggestedAction','round','apply','getLtmData','üêç\x20Starting\x20Python\x20Sidecar:\x20','level','subscribeForeignStatesAsync','lastCheck','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','LTM.dailyDigests','.forecast.current.temp','type','communicate.request','LTM.baselineStatus','service.py','COGNI_REQUEST_CALL','details','baselineDrift','Last\x20raw\x20event','text','node-schedule','1324yQvJyU','üö®\x20EMERGENCY','.data.table','getDate','\x20hours.\x20Potential\x20incapacitation.','endsWith','setHours','cogni-living','values','systemConfig','üìû\x20R√ºckruf\x20anfordern','shift','door','getForeignObjectsAsync','lastAlertState','history.','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','flot.','from','genAI','split','substring','dependencyInstallInProgress','PRO-','trim','WETTER:\x20Keine\x20Daten\x20gefunden','üêç\x20Guardian\x20Diagnosis\x20(','native','dimmer','ltmStbWindowDays','window','unshift','weatherunderground.0','N/A','Entry\x20detected\x20via\x20','pr√§senz','Invalid\x20JSON\x20from\x20Python:\x20','cogni-living\x20adapter\x20starting\x20(v','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','extendObjectAsync','\x20days\x20of\x20activity\x20data\x20to\x20Python...','brightness','fenster','feedbackHistory','analysis.feedbackHistory','08:00','automation.triggerAction','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','useCalendar','LTM.trainingData.sequences','Subscribing\x20to\x20','LTM.processingStatus','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','getForeignStateAsync','uuid-not-found','Target\x20ID','Lernphase\x20(','lampe','Error\x20launching\x20Python\x20service:\x20','requirements.txt','_score','material.','exitGraceTimer','alertReason','Last\x20Result','pop','length','getObjectAsync','scriptEnabled','‚úÖ\x20Alles\x20OK\x20(Reset)','Who\x20is\x20present?','.Summary.Current','Action','maintenance','ltmJob','testApiKey','analysis.automation.description','LTM.rawEventLog','stateChange','indicator.alarm','json','Health\x20Notes','Vom\x20Benutzer\x20best√§tigt\x20(OK).','admin.','energy','notifyTelegramRecipient','search','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','data','onStateChange','KALENDER\x20ERROR:\x20','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','Normal','role','power','No\x20module\x20named','\x0aSTB:\x20','driftDetails','bind','LTM','analysisTimer','Kein\x20API\x20Key\x20eingegeben.','getFullYear','dailyDigests','writable','off','\x20|\x20','generateContent','payload','error','unknown','loc','openweathermap.0','daswetter','27KcNmUF','Error\x20reading\x20calendar\x20table:\x20','Gemini\x20Analysis\x20Error:\x20','Generating\x20Morning\x20Briefing...','toFixed','licenseKey','VACATION','\x20(Value\x20is\x20falsy:\x20','setpoint','getCalendarNames','Last\x20Check','namespace','ltmLtbWindowDays','analysis.comfortSuggestion','.\x20ZUSATZ:\x20','triggerBriefing','custom','\x20events)...','constructor','analysis.isAlert','ack','targetposition','map','Processing\x20Status','getForeignObjectAsync','string','Training\x20Data\x20Sets','online','.communicate.request','accuweather','eventHistory','Wetter:\x20Deaktiviert','isExit','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','\x20=\x20','BUTLER\x20Execution\x20Error:\x20','presence','forEach','javascript.','notifyPushoverEnabled','WETTER:\x20','10488rHgfIb','User\x20dismissed\x20automation\x20proposal.','set_temperature','PRIORIT√ÑT:\x20Sicherheit.','none','Target\x20Value','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','TREND_RESULT','shutter','splice','exitTimer','.\x20DATEN:\x20Schlaf\x20','now','Aktiv\x20(','number','0\x203\x20*\x20*\x20*','.NextHours.Location_1.Day_1.current.temp_value','isProVersion','getGenerativeModel','üß™\x20Simulating\x20Butler\x20Proposal:\x20','analysis.automation.targetId','blind','slice','sort','.\x0a\x20\x20\x20\x20KONTEXT:\x20','analysis.isEmergency','notifyEmailEnabled','rollladen','summary','connection','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','Drift\x20Details','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','üêç\x20Stopping\x20Python\x20Sidecar...','status','rawEventLog','setState','update','\x20*\x20*\x20*','Exit\x20Sensor\x20triggered\x20(','toLowerCase','sendTo','stick_unreach','\x20for\x20interactive\x20buttons...','0\x204\x20*\x20*\x20*','\x20(Length:\x20'];a0_0x5953=function(){return _0x27518b;};return a0_0x5953();}class CogniLiving extends utils[a0_0x53276c(0x2f8)]{constructor(_0x428a82){const _0xc15407=a0_0x53276c;super({..._0x428a82,'name':_0xc15407(0x1a4)}),this['eventHistory']=[],this[_0xc15407(0x319)]=[],this[_0xc15407(0x1c8)]=[],this[_0xc15407(0x25c)]=[],this[_0xc15407(0x205)]=[],this['sensorLastValues']={},this[_0xc15407(0x1a6)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0xc15407(0x291)]=!![],this[_0xc15407(0x243)]=null,this[_0xc15407(0x1dc)]=null,this[_0xc15407(0x292)]=![],this[_0xc15407(0x1b0)]=null,this[_0xc15407(0x385)]=null,this['currentSystemMode']=SYSTEM_MODES[_0xc15407(0x26e)],this[_0xc15407(0x24a)]=![],this[_0xc15407(0x1ab)]=![],this[_0xc15407(0x313)]=_0xc15407(0x20c),this[_0xc15407(0x202)]=null,this['ltmJob']=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this[_0xc15407(0x342)]=null,this[_0xc15407(0x29e)]=null,this['dependencyInstallInProgress']=![],this['on']('ready',this[_0xc15407(0x2c5)][_0xc15407(0x200)](this)),this['on'](_0xc15407(0x1ec),this['onStateChange'][_0xc15407(0x200)](this)),this['on']('unload',this['onUnload'][_0xc15407(0x200)](this)),this['on'](_0xc15407(0x33d),this['onMessage'][_0xc15407(0x200)](this));}async[a0_0x53276c(0x2c5)](){const _0x40fb7f=a0_0x53276c;this['log']['info'](_0x40fb7f(0x1c2)+this['version']+_0x40fb7f(0x2ea)),await initZombies(this),this[_0x40fb7f(0x382)][_0x40fb7f(0x215)]=this[_0x40fb7f(0x382)][_0x40fb7f(0x215)]||'';try{this[_0x40fb7f(0x24a)]=await checkLicense(this,this[_0x40fb7f(0x382)][_0x40fb7f(0x215)]);}catch(_0x4a2931){}this[_0x40fb7f(0x36f)][_0x40fb7f(0x341)]('[LICENSE\x20CHECK]\x20Key\x20present:\x20'+!!this[_0x40fb7f(0x382)][_0x40fb7f(0x215)]+'\x20|\x20Status:\x20'+(this[_0x40fb7f(0x24a)]?_0x40fb7f(0x30a):_0x40fb7f(0x359)));if(!this['config'][_0x40fb7f(0x2ec)]||this[_0x40fb7f(0x382)]['inactivityThresholdHours']<0.1)this[_0x40fb7f(0x382)][_0x40fb7f(0x2ec)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x40fb7f(0x382)][_0x40fb7f(0x315)])try{this[_0x40fb7f(0x1b0)]=new GoogleGenerativeAI(this[_0x40fb7f(0x382)][_0x40fb7f(0x315)]),this[_0x40fb7f(0x385)]=this[_0x40fb7f(0x1b0)][_0x40fb7f(0x24b)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x40fb7f(0x364)}}),this['log'][_0x40fb7f(0x341)]('Gemini\x20AI\x20initialized.');}catch(_0x18092b){this[_0x40fb7f(0x36f)][_0x40fb7f(0x20b)](_0x40fb7f(0x31d)+_0x18092b['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x40fb7f(0x30e)](_0x40fb7f(0x2ce)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x40fb7f(0x30e)]('system.mode'),this[_0x40fb7f(0x30e)]('analysis.triggerBriefing'),this['subscribeStates'](_0x40fb7f(0x38a)),this['subscribeStates'](_0x40fb7f(0x30f)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x40fb7f(0x202)])clearInterval(this[_0x40fb7f(0x202)]);const _0x4bb065=this['config']['analysisInterval']||0xf;_0x4bb065>0x0&&(this['log']['info'](_0x40fb7f(0x2fb)+_0x4bb065+'\x20min).'),this[_0x40fb7f(0x202)]=setInterval(()=>{runAutopilot(this);},_0x4bb065*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{this['pythonProcess']&&runPythonHealthCheck(this);},0x1388);}[a0_0x53276c(0x2c7)](_0x59751d){const _0x133b05=a0_0x53276c;if(this['analysisTimer'])clearInterval(this[_0x133b05(0x202)]);if(this[_0x133b05(0x346)])clearInterval(this[_0x133b05(0x346)]);if(this[_0x133b05(0x1e8)])this[_0x133b05(0x1e8)][_0x133b05(0x352)]();if(this['modeResetJob'])this[_0x133b05(0x2d1)][_0x133b05(0x352)]();if(this[_0x133b05(0x342)])this[_0x133b05(0x342)][_0x133b05(0x352)]();if(this[_0x133b05(0x243)])clearTimeout(this[_0x133b05(0x243)]);if(this['exitGraceTimer'])clearTimeout(this[_0x133b05(0x1dc)]);stopPythonService(this),_0x59751d();}async[a0_0x53276c(0x1f7)](_0x4c0e19,_0x4e6393){const _0x54f41f=a0_0x53276c;if(!_0x4e6393)return;if(_0x4c0e19[_0x54f41f(0x330)](_0x54f41f(0x26f))&&_0x4c0e19['endsWith'](_0x54f41f(0x194))&&_0x4e6393[_0x54f41f(0x32f)]){await handleTelegramResponse(this,_0x4e6393[_0x54f41f(0x32f)]);return;}if(_0x4c0e19===this[_0x54f41f(0x21b)]+'.'+SYSTEM_DP_MODE){_0x4e6393['val']&&Object['values'](SYSTEM_MODES)['includes'](_0x4e6393['val'])&&(this[_0x54f41f(0x386)]=_0x4e6393[_0x54f41f(0x32f)],_0x4e6393['val']===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x4e6393[_0x54f41f(0x224)])this[_0x54f41f(0x25d)](_0x4c0e19,{'val':this[_0x54f41f(0x386)],'ack':!![]});return;}if(!_0x4e6393[_0x54f41f(0x224)]){_0x4c0e19[_0x54f41f(0x330)](_0x54f41f(0x2ce))&&_0x4e6393[_0x54f41f(0x32f)]&&(this[_0x54f41f(0x25d)](_0x4c0e19,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x4c0e19[_0x54f41f(0x330)](_0x54f41f(0x38d))&&_0x4e6393[_0x54f41f(0x32f)]){this[_0x54f41f(0x25d)](_0x4c0e19,{'val':![],'ack':!![]});if(this[_0x54f41f(0x24a)])createDailyDigest(this);}_0x4c0e19[_0x54f41f(0x330)](_0x54f41f(0x21f))&&_0x4e6393[_0x54f41f(0x32f)]&&(this['setState'](_0x4c0e19,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x4c0e19[_0x54f41f(0x330)](_0x54f41f(0x1cb))&&_0x4e6393[_0x54f41f(0x32f)]&&(this[_0x54f41f(0x25d)](_0x4c0e19,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x54f41f(0x382)][_0x54f41f(0x377)]&&this[_0x54f41f(0x382)][_0x54f41f(0x377)][_0x54f41f(0x330)](_0x4c0e19)){await checkWifiPresence(this);return;}const _0x2033c2=(this[_0x54f41f(0x382)]['devices']||[])[_0x54f41f(0x33c)](_0xddca87=>_0xddca87['id']===_0x4c0e19);if(_0x2033c2)processSensorEvent(this,_0x4c0e19,_0x4e6393,_0x2033c2);}async[a0_0x53276c(0x277)](_0x10730b){const _0x1a33a8=a0_0x53276c;if(typeof _0x10730b===_0x1a33a8(0x35c)&&_0x10730b[_0x1a33a8(0x33d)])try{if(_0x10730b['command']===_0x1a33a8(0x1e9)){const _0x2be359=_0x10730b[_0x1a33a8(0x33d)][_0x1a33a8(0x351)]||this[_0x1a33a8(0x382)][_0x1a33a8(0x315)];if(!_0x2be359)return this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b[_0x1a33a8(0x275)],{'success':![],'message':_0x1a33a8(0x203)},_0x10730b[_0x1a33a8(0x2cf)]);try{const _0x5150a0=new GoogleGenerativeAI(_0x2be359),_0x308eef=_0x5150a0['getGenerativeModel']({'model':GEMINI_MODEL}),_0x11cd34=await _0x308eef[_0x1a33a8(0x209)]('Say\x20Hello'),_0x5efcdc=await _0x11cd34[_0x1a33a8(0x2a9)],_0x5ad7b2=_0x5efcdc[_0x1a33a8(0x19b)]();this['sendTo'](_0x10730b['from'],_0x10730b[_0x1a33a8(0x275)],{'success':!![],'message':_0x1a33a8(0x35d)+_0x5ad7b2[_0x1a33a8(0x1b2)](0x0,0x14)+_0x1a33a8(0x345)},_0x10730b[_0x1a33a8(0x2cf)]);}catch(_0x4ec6e2){this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b['command'],{'success':![],'message':_0x1a33a8(0x2f0)+_0x4ec6e2[_0x1a33a8(0x33d)]},_0x10730b['callback']);}}else{if(_0x10730b[_0x1a33a8(0x275)]==='testNotification'){}else{if(_0x10730b[_0x1a33a8(0x275)]===_0x1a33a8(0x18b)){if(!this[_0x1a33a8(0x24a)])return this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b['command'],{'success':![],'isPro':![]},_0x10730b[_0x1a33a8(0x2cf)]);let _0x1a7f9a={'status':_0x1a33a8(0x1be),'details':'','lastCheck':0x0};try{_0x1a7f9a[_0x1a33a8(0x25b)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x1a33a8(0x32f)],_0x1a7f9a[_0x1a33a8(0x198)]=(await this[_0x1a33a8(0x2fe)](LTM_DP_DRIFT_DETAILS))[_0x1a33a8(0x32f)],_0x1a7f9a[_0x1a33a8(0x18f)]=(await this[_0x1a33a8(0x2fe)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x1a3e35){}const _0x372629=this[_0x1a33a8(0x319)]||[];this[_0x1a33a8(0x262)](_0x10730b['from'],_0x10730b[_0x1a33a8(0x275)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x1a33a8(0x205)],'driftAnalysis':_0x1a7f9a,'analysisHistory':_0x372629},_0x10730b[_0x1a33a8(0x2cf)]);}else{if(_0x10730b[_0x1a33a8(0x275)]==='getOverviewData'){const _0x366e34=this[_0x1a33a8(0x205)][_0x1a33a8(0x1e0)],_0x3b7cf0=new Date(),_0x22113a=new Date(_0x3b7cf0[_0x1a33a8(0x204)](),_0x3b7cf0[_0x1a33a8(0x334)](),_0x3b7cf0[_0x1a33a8(0x1a0)]())[_0x1a33a8(0x2ac)](),_0x4b4d21=this['rawEventLog'][_0x1a33a8(0x31a)](_0x167f99=>new Date(_0x167f99[_0x1a33a8(0x26a)])[_0x1a33a8(0x2ac)]()>_0x22113a)[_0x1a33a8(0x1e0)],_0x5acae9=new Array(0x18)[_0x1a33a8(0x348)](0x0);this[_0x1a33a8(0x25c)]['forEach'](_0x461732=>{const _0x5cfa3c=_0x1a33a8,_0x2003d3=new Date(_0x461732[_0x5cfa3c(0x26a)]);if(_0x2003d3[_0x5cfa3c(0x2ac)]()>_0x22113a)_0x5acae9[_0x2003d3[_0x5cfa3c(0x267)]()]++;});let _0xd23a95={'status':_0x1a33a8(0x1be)};try{_0xd23a95[_0x1a33a8(0x25b)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x1a33a8(0x32f)];}catch(_0x2576bc){}let _0x171bef='';try{const _0x5bc6d2=await this[_0x1a33a8(0x2fe)]('system.presenceWho');_0x171bef=_0x5bc6d2?_0x5bc6d2['val']:'';}catch(_0x18b884){}let _0x26f3bd=null;!this[_0x1a33a8(0x385)]&&(_0x26f3bd=this[_0x1a33a8(0x382)]['geminiApiKey']?_0x1a33a8(0x35e):_0x1a33a8(0x2af));let _0x4fed52={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x270ea8=await this[_0x1a33a8(0x2fe)](_0x1a33a8(0x34b)),_0x86c0b5=await this['getStateAsync']('analysis.automation.description'),_0x43cd4e=await this[_0x1a33a8(0x2fe)]('analysis.automation.targetId'),_0x42831e=await this[_0x1a33a8(0x2fe)]('analysis.automation.targetValue'),_0x4d6a69=await this[_0x1a33a8(0x2fe)](_0x1a33a8(0x30f));_0x270ea8&&_0x270ea8[_0x1a33a8(0x32f)]&&(_0x4fed52[_0x1a33a8(0x362)]=!![],_0x4fed52['description']=_0x86c0b5?_0x86c0b5[_0x1a33a8(0x32f)]:'',_0x4fed52[_0x1a33a8(0x298)]=_0x43cd4e?_0x43cd4e[_0x1a33a8(0x32f)]:'',_0x4fed52[_0x1a33a8(0x32b)]=_0x42831e?_0x42831e['val']:''),_0x4fed52[_0x1a33a8(0x2a5)]=_0x4d6a69?!!_0x4d6a69['val']:![];}catch(_0x31adac){}this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b[_0x1a33a8(0x275)],{'success':!![],'eventHistory':this[_0x1a33a8(0x22e)][_0x1a33a8(0x24f)](0x0,0xf),'stats':{'digestCount':_0x366e34,'eventCountToday':_0x4b4d21,'hourlyActivity':_0x5acae9,'driftStatus':_0xd23a95['status'],'isPresent':this[_0x1a33a8(0x291)],'presenceWho':_0x171bef,'minDays':this[_0x1a33a8(0x382)][_0x1a33a8(0x2aa)]||0x7,'stbDays':this[_0x1a33a8(0x382)][_0x1a33a8(0x1ba)]||0xe,'ltbDays':this[_0x1a33a8(0x382)][_0x1a33a8(0x21c)]||0x3c,'systemError':_0x26f3bd},'automation':_0x4fed52},_0x10730b[_0x1a33a8(0x2cf)]);}else{if(_0x10730b['command']==='getEnums'){const _0x328011=await this[_0x1a33a8(0x1aa)](_0x1a33a8(0x33e),_0x1a33a8(0x2fa)),_0x40b02b=[];if(_0x328011)for(const _0x514dde in _0x328011){const _0x4a2ad1=_0x328011[_0x514dde],_0x57febe=(_0x4a2ad1[_0x1a33a8(0x2e8)]&&typeof _0x4a2ad1['common']['name']===_0x1a33a8(0x35c)?_0x4a2ad1[_0x1a33a8(0x2e8)][_0x1a33a8(0x331)]['de']:_0x4a2ad1[_0x1a33a8(0x2e8)]['name'])||_0x4a2ad1[_0x1a33a8(0x2e8)][_0x1a33a8(0x331)];_0x40b02b[_0x1a33a8(0x363)]({'id':_0x514dde,'name':_0x57febe});}this[_0x1a33a8(0x262)](_0x10730b['from'],_0x10730b[_0x1a33a8(0x275)],{'success':!![],'enums':_0x40b02b},_0x10730b[_0x1a33a8(0x2cf)]);}else{if(_0x10730b['command']==='scanDevices')try{const _0x485e41=await scanForDevices(this,_0x10730b[_0x1a33a8(0x33d)]||{});this[_0x1a33a8(0x262)](_0x10730b['from'],_0x10730b['command'],{'success':!![],'devices':_0x485e41},_0x10730b['callback']);}catch(_0x798a2){this['sendTo'](_0x10730b[_0x1a33a8(0x1af)],_0x10730b[_0x1a33a8(0x275)],{'success':![],'error':_0x798a2[_0x1a33a8(0x33d)]},_0x10730b[_0x1a33a8(0x2cf)]);}else{if(_0x10730b[_0x1a33a8(0x275)]===_0x1a33a8(0x219)){const _0x150366=_0x10730b[_0x1a33a8(0x33d)][_0x1a33a8(0x360)];if(!_0x150366)return this['sendTo'](_0x10730b[_0x1a33a8(0x1af)],_0x10730b[_0x1a33a8(0x275)],{'success':![],'error':_0x1a33a8(0x320)},_0x10730b[_0x1a33a8(0x2cf)]);const _0x4b2095=await getCalendarNames(this,_0x150366);this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b['command'],{'success':!![],'names':_0x4b2095},_0x10730b[_0x1a33a8(0x2cf)]);}else{if(_0x10730b[_0x1a33a8(0x275)]===_0x1a33a8(0x28a)){const {targetId:_0x3d3b07,targetValue:_0x5670d0}=_0x10730b[_0x1a33a8(0x33d)];this['log'][_0x1a33a8(0x341)](_0x1a33a8(0x24c)+_0x3d3b07+_0x1a33a8(0x232)+_0x5670d0),await this['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x1a33a8(0x2f4)](_0x1a33a8(0x1ea),{'val':_0x1a33a8(0x231)+_0x3d3b07,'ack':!![]}),await this[_0x1a33a8(0x2f4)](_0x1a33a8(0x24d),{'val':_0x3d3b07,'ack':!![]}),await this[_0x1a33a8(0x2f4)](_0x1a33a8(0x37c),{'val':_0x5670d0,'ack':!![]}),this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b[_0x1a33a8(0x275)],{'success':!![]},_0x10730b['callback']);}else{if(_0x10730b[_0x1a33a8(0x275)]===_0x1a33a8(0x2d9)){const {historyId:_0x26df26,rating:_0x58e97d,comment:_0x7daafe,alertReason:_0xf41821}=_0x10730b[_0x1a33a8(0x33d)];_0x26df26&&_0x58e97d?(await saveFeedback(this,{'timestamp':Date[_0x1a33a8(0x245)](),'historyId':_0x26df26,'rating':_0x58e97d,'comment':_0x7daafe,'alertReason':_0xf41821}),this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b[_0x1a33a8(0x275)],{'success':!![]},_0x10730b[_0x1a33a8(0x2cf)])):this['sendTo'](_0x10730b[_0x1a33a8(0x1af)],_0x10730b[_0x1a33a8(0x275)],{'success':![],'error':'Missing\x20data'},_0x10730b[_0x1a33a8(0x2cf)]);}else _0x10730b[_0x1a33a8(0x275)]===_0x1a33a8(0x2b8)&&(this[_0x1a33a8(0x36f)][_0x1a33a8(0x341)](_0x1a33a8(0x23a)),await this[_0x1a33a8(0x2f4)](_0x1a33a8(0x34b),{'val':![],'ack':!![]}),await this[_0x1a33a8(0x2f4)](_0x1a33a8(0x1ea),{'val':'','ack':!![]}),this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b['command'],{'success':!![]},_0x10730b[_0x1a33a8(0x2cf)]));}}}}}}}}}catch(_0x17d05c){this[_0x1a33a8(0x36f)][_0x1a33a8(0x20b)]('Error\x20in\x20onMessage\x20command\x20'+_0x10730b[_0x1a33a8(0x275)]+':\x20'+_0x17d05c[_0x1a33a8(0x33d)]);if(_0x10730b[_0x1a33a8(0x2cf)])this[_0x1a33a8(0x262)](_0x10730b[_0x1a33a8(0x1af)],_0x10730b['command'],{'success':![],'error':_0x17d05c[_0x1a33a8(0x33d)]},_0x10730b[_0x1a33a8(0x2cf)]);}}}if(require[a0_0x53276c(0x33b)]!==module)module[a0_0x53276c(0x28c)]=_0x2fa133=>new CogniLiving(_0x2fa133);else new CogniLiving();