const a0_0x38161e=a0_0x5ac5;function a0_0x57d6(){const _0x17af0b=['Gemini\x20Init\x20Error:\x20','summary','_calName','generic','.\x20EMERGENCY:\x20','analysis.security','python3\x20-m\x20venv\x20\x22','type','notifyPushoverRecipient','apply','write','config','notifyPushoverEnabled','state','toFixed','Gemini\x20AI\x20initialized.','analysis.training.triggerHealth','âŒ\x20VENV\x20FAILED.\x20Check:\x20sudo\x20apt\x20install\x20python3-venv','main','.\x20DATEN:\x20Schlaf\x20','rawEventLog','city','analysis.automation.description','date','No\x20module\x20named','latitude','2088225CCbanA','AI\x20Training','info','accuweather','simulateButler','calendarInstance','Unbekannt','Heating\x20Score','slice','VACATION','exitTimer','briefingJob','analysis.lastResult','(((.+)+)+)+$','splice','guest','getFullYear','244333nTdOHf','cancel','data','LTM.driftAnalysis.baselineDrift','.NextHours.Location_1.Day_1.current.symbol_desc','notifyEmailEnabled','geminiApiKey','Success:\x20','systemUUID','notifyTelegramEnabled','system.presenceWho','sendTo','Insulation\x20Score','writable','cogni-living\x20adapter\x20starting\x20(v','ðŸŒ…\x20Daily\x20Briefing:\x0a','Keine\x20Details.','âœ…\x20Alles\x20OK\x20(Reset)','LTM.triggerDailyDigest','insulation','ENERGY_TRAIN_RESULT','analysis.automation.targetValue','close','Alarm','push','onStateChange','System','TRAINING_COMPLETE','analysis.training.triggerSecurity','getHours','Training\x20Error:\x20','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','Daily\x20Digests','pip.exe','analysis.alertReason','getDate','cpu_feature_guard','ðŸš¨\x20EMERGENCY','analysisInterval','Activity\x20Summary','expire','analysis.security.lastCheck','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','analysis.automation.triggerAction','values','status','LTM.dailyDigests','licenseKey','KI-Modell\x20nicht\x20initialisiert','presenceDevices','LTM.trainingData.thermodynamics','Generating\x20Morning\x20Briefing...','version','analysis.health.trendDiagnosis','command','analysisTimer','Anomaly\x20Detected','pop','debug','KALENDER:\x20','indexOf','Alert\x20Status','ltmLtbWindowDays','isPresent','livingContext','service.py','Failed:\x20','sendToAsync','join','node-schedule','dailyDigests','onUnload','toISOString','analysis.training.triggerEnergy','PARTY','constructor','text.alarm','\x20=\x20','eventHistory','Aktiv\x20(','144QxRPmk','analysis.energy.heatingScore','scanDevices','66786RxmKBa','Scripts','analysis.activitySummary','python_service','analysis.isAlert','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','LTM.trainingData.sequences','endsWith','siren','Sec-Training\x20started...','map','testApiKey','systemConfig','subscribeStates','ANALYZE_TREND','getForeignObjectsAsync','LTM.driftAnalysis.lastCheck','notifyEmailInstance','WiFi\x20Presence\x20detected.','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','Gemini\x20Error:\x20','timestamp','isAlert','val','[PYTHON]\x20','startsWith','ðŸ§ \x20Triggering\x20Security\x20Training...','briefingTime','includes','getGenerativeModel','ðŸ\x20Stopping\x20Python...','setState','5356890jFxPmq','BUTLER\x20Execution\x20Error:\x20','unknown','sound','TRAIN_HEALTH','stringify','HEALTH_TRAIN_RESULT','system','child_process','Missing\x20data','.\x20SYSTEM_MODE:\x20','forEach','genAI','getStateAsync',').\x20Panic\x20Mode.','dependencyInstallInProgress','ANALYZE_HEALTH','weatherInstance','259CXAZfD','\x20events)...','[LOG]','ltmDriftCheckIntervalHours','ROLLE:\x20Assistent.\x20AUFGABE:\x20Schreibe\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','Alert\x20Reason','parse','driftDetails','getLtmData','subscribeForeignStatesAsync','models/gemini-flash-latest','setForeignStateAsync','inactivityThresholdHours','vacation','uuid','unload','analysis.triggerBriefing','Skipped\x20(No\x20AI\x20or\x20Data)','text','button','driftAnalysisTimer','Description','Adapter','detected','GUEST','\x20->\x20','events.history_debug_00','trim','analysis.automation.targetId','Trigger\x20Briefing','replace','\x20*\x20*\x20*','.Summary.Current','name','Trend\x20Value','namespace','pythonProcess','onReady','0\x204\x20*\x20*\x20*','âœ…\x20INSTALL\x20SUCCESS.\x20Verifying...','ltmStbWindowDays','analysis.energy.insulationScore','channel','ack','Last\x20Check','split','TRAIN_ENERGY','N/A\x20(Learning)','delObjectAsync','unshift','NORMAL','isArray','onMessage','analysis.health.lastCheck','send','âœ…\x20HEALTH\x20TRAINED:\x20','.\x20EVENTS:\x20','error','ðŸ\x20Using\x20VENV:\x20','exitGraceTimer','Digest','Briefing\x20Error:\x20','string','from','callback','âš ï¸\x20Missing\x20Libs\x20(','longitude','N/A','ready','search','Trigger\x20Analysis','system.isPresent','setHours','events.history','rmSync','.data.table','analysis.analysisHistory','stdin','substring','LTM','targetValue','existsSync','requirements.txt','.\x20ANWESEND:\x20','bin','apiKey','PRIORITÃ„T:\x20Sicherheit.','getTime','Briefing\x20Sched\x20Error:\x20','log','number','daswetter','analysis.automation.autoApply','Trend','common','triggerDailyDigest','sort','Train\x20Security','analysis.training.status','pip','generateContent','Thermodynamics','Err:\x20','2208rEZmoQ','useCalendar','getForeignObjectAsync',')\x20-\x20STRICT\x20ORDER\x20OK','filter','indicator','system.mode','ANOMALY','value','aiPersona','message','User\x20dismissed\x20automation\x20proposal.','briefingEnabled','Installing\x20packages\x20(Force\x20Reinstall)...','Keine\x20Termine','0\x203\x20*\x20*\x20*','currentSystemMode','Health\x20Analysis','payload','âš ï¸\x20ALARM:\x20','extendObjectAsync','.venv','analysis.energy','âš ï¸\x20VENV\x20missing.\x20Reinstalling...','getCalendarNames','notifyTelegramInstance','analysis.health','âš ï¸\x20SECURITY\x20ALARM:\x20','Wetter:\x20Deaktiviert','COGNI_CONFIRM_OK','HEALTH_RESULT','submitFeedback','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','analysis.training','lastAlertState','isGracePeriodActive','LTM.driftAnalysis.driftDetails','response','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','2ilDEDj','.forecast.current.state','analysis.health.isAnomaly','notifyPushoverInstance','Energy\x20Intelligence','analysis.history_debug_00','Train\x20Energy','system.config','length','sensorLastValues','platform','object','@google/generative-ai','stateChange','dismissAutomation','Kalender:\x20Deaktiviert','switch','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','cogni-living','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','stdout','No\x20instance','LTM.rawEventLog','normal','\x22\x20-c\x20\x22import\x20tensorflow;\x20print(\x27OK\x27)\x22','devices','geminiModel','setStateAsync','modeResetJob','TREND_RESULT','getOverviewData','bind','setObjectNotExistsAsync','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','scheduleJob','Target\x20ID','@iobroker/adapter-core','alertReason','ðŸ\x20Guardian\x20Diagnosis:\x20','Raw\x20Log','ical.0','Success','party','toString','\x20Tage)','retry','ðŸ\x20Python\x20Pong','stderr','.\x20WETTER:\x20','minDaysForBaseline','PRIORITÃ„T:\x20Gesundheit/AAL.','âŒ\x20VERIFICATION\x20FAILED.\x20Tensorflow\x20missing.\x20Panic\x20Mode.','Drift\x20Sched\x20Error:\x20','automationProposal','now','ltmJob','application/json','triggerBriefing','1265624TtEUND','Auto\x20Apply','analysis.security.lastScore','1999195dQQLSy','Restoring\x20sensor\x20cache\x20from\x20history\x20(','indicator.alarm','Kein\x20API\x20Key.','analysis.automation.patternDetected','getEnums','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','Cogni-Living','targetId','exports','Deaktiviert\x20(Pro-Feature)','communicate.request','analysisHistory','analysis.trigger','heating','boolean','.\x20KONTEXT:\x20','automation.triggerAction','Error\x20launching\x20Python:\x20','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','Training\x20Status','json','isProVersion','Trigger\x20Action','getForeignStateAsync','description'];a0_0x57d6=function(){return _0x17af0b;};return a0_0x57d6();}(function(_0x55bf25,_0x5d86f5){const _0x1c3ffe=a0_0x5ac5,_0x336ace=_0x55bf25();while(!![]){try{const _0x587948=-parseInt(_0x1c3ffe(0x16d))/0x1*(parseInt(_0x1c3ffe(0x280))/0x2)+-parseInt(_0x1c3ffe(0x259))/0x3*(-parseInt(_0x1c3ffe(0x1bd))/0x4)+parseInt(_0x1c3ffe(0x128))/0x5+-parseInt(_0x1c3ffe(0x1c0))/0x6*(parseInt(_0x1c3ffe(0x1f2))/0x7)+parseInt(_0x1c3ffe(0x125))/0x8+-parseInt(_0x1c3ffe(0x15c))/0x9+parseInt(_0x1c3ffe(0x1e0))/0xa;if(_0x587948===_0x5d86f5)break;else _0x336ace['push'](_0x336ace['shift']());}catch(_0x1f7702){_0x336ace['push'](_0x336ace['shift']());}}}(a0_0x57d6,0x38a56));const a0_0x5a0d17=(function(){let _0x39db56=!![];return function(_0x38467b,_0x34fa77){const _0x6d4218=_0x39db56?function(){const _0x28adbd=a0_0x5ac5;if(_0x34fa77){const _0x63edc7=_0x34fa77[_0x28adbd(0x14b)](_0x38467b,arguments);return _0x34fa77=null,_0x63edc7;}}:function(){};return _0x39db56=![],_0x6d4218;};}()),a0_0x1da0d5=a0_0x5a0d17(this,function(){const _0x3c5c72=a0_0x5ac5;return a0_0x1da0d5['toString']()[_0x3c5c72(0x237)](_0x3c5c72(0x169))[_0x3c5c72(0x116)]()[_0x3c5c72(0x1b8)](a0_0x1da0d5)[_0x3c5c72(0x237)](_0x3c5c72(0x169));});a0_0x1da0d5();'use strict';const utils=require(a0_0x38161e(0x10f)),{GoogleGenerativeAI}=require(a0_0x38161e(0xf6)),schedule=require(a0_0x38161e(0x1b2)),{spawn,exec}=require(a0_0x38161e(0x1e8)),path=require('path'),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x38161e(0x1fc),LTM_SCHEDULE=a0_0x38161e(0x268),MODE_RESET_SCHEDULE=a0_0x38161e(0x218),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x38161e(0x101),LTM_DP_DAILY_DIGESTS=a0_0x38161e(0x19b),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x38161e(0x17f),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x38161e(0x170),LTM_DP_DRIFT_DETAILS=a0_0x38161e(0x27d),LTM_DP_DRIFT_LAST_CHECK=a0_0x38161e(0x1d0),SYSTEM_DP_MODE=a0_0x38161e(0x25f),SYSTEM_MODES={'NORMAL':a0_0x38161e(0x102),'VACATION':a0_0x38161e(0x1ff),'PARTY':a0_0x38161e(0x115),'GUEST':a0_0x38161e(0x16b)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x38161e(0x1b7)],SYSTEM_MODES[a0_0x38161e(0x20a)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x38161e(0x11d),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x38161e(0x248)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x38161e(0xf4)]==='win32',VENV_PATH=path['join'](__dirname,a0_0x38161e(0x26e)),PYTHON_EXE=IS_WIN?path[a0_0x38161e(0x1b1)](VENV_PATH,a0_0x38161e(0x1c1),'python.exe'):path[a0_0x38161e(0x1b1)](VENV_PATH,'bin','python'),PIP_EXE=IS_WIN?path[a0_0x38161e(0x1b1)](VENV_PATH,a0_0x38161e(0x1c1),a0_0x38161e(0x18e)):path[a0_0x38161e(0x1b1)](VENV_PATH,a0_0x38161e(0x246),a0_0x38161e(0x255));let activeSequence=[],sequenceTimer=null,panicMode=![];async function initZombies(_0x5d7f8a){const _0xe8d6a7=a0_0x38161e;try{const _0xef7234=[_0xe8d6a7(0x285),_0xe8d6a7(0x20c)];for(const _0x5702c1 of _0xef7234){try{const _0x62236a=await _0x5d7f8a['getObjectAsync'](_0x5702c1);if(_0x62236a)await _0x5d7f8a[_0xe8d6a7(0x222)](_0x5702c1);}catch(_0x1831c3){}}}catch(_0x293001){}}async function initHistory(_0x435cea){const _0x478b77=a0_0x38161e;try{const _0x9e1d07=await _0x435cea[_0x478b77(0x1ed)]('events.history');_0x9e1d07&&_0x9e1d07[_0x478b77(0x1d7)]&&(_0x435cea[_0x478b77(0x1bb)]=JSON['parse'](_0x9e1d07[_0x478b77(0x1d7)][_0x478b77(0x116)]()));}catch(_0x47bafa){_0x435cea[_0x478b77(0x1bb)]=[];}try{const _0x129f5a=await _0x435cea[_0x478b77(0x1ed)](_0x478b77(0x23e));if(_0x129f5a&&_0x129f5a[_0x478b77(0x1d7)])_0x435cea[_0x478b77(0x134)]=JSON['parse'](_0x129f5a[_0x478b77(0x1d7)][_0x478b77(0x116)]());}catch(_0x5b0717){_0x435cea['analysisHistory']=[];}if(_0x435cea[_0x478b77(0x1bb)]&&_0x435cea[_0x478b77(0x1bb)][_0x478b77(0x288)]>0x0){_0x435cea['log']['info'](_0x478b77(0x129)+_0x435cea[_0x478b77(0x1bb)][_0x478b77(0x288)]+_0x478b77(0x1f3));for(let _0x335c14=_0x435cea[_0x478b77(0x1bb)]['length']-0x1;_0x335c14>=0x0;_0x335c14--){const _0x3b4cc7=_0x435cea[_0x478b77(0x1bb)][_0x335c14];if(_0x3b4cc7&&_0x3b4cc7['id']!==undefined&&_0x3b4cc7[_0x478b77(0x261)]!==undefined)_0x435cea[_0x478b77(0xf3)][_0x3b4cc7['id']]=_0x3b4cc7['value'];}}}async function initSystemConfig(_0x5afc60){const _0x12b59c=a0_0x38161e;try{const _0xf131d9=await _0x5afc60[_0x12b59c(0x25b)](_0x12b59c(0x287));if(_0xf131d9&&_0xf131d9[_0x12b59c(0x250)])_0x5afc60[_0x12b59c(0x1cc)]={'latitude':_0xf131d9[_0x12b59c(0x250)][_0x12b59c(0x15b)]||0x0,'longitude':_0xf131d9['common'][_0x12b59c(0x234)]||0x0,'city':_0xf131d9[_0x12b59c(0x250)][_0x12b59c(0x157)]||''};}catch(_0x2b6229){}}async function checkLicense(_0x5c58da,_0x2173e1){return!![];}async function getSystemUUID(_0x1f7ae6){const _0x5458ae=a0_0x38161e;return _0x5458ae(0x200);}async function loadRawEventLog(_0x56fb5f){const _0xc1b97a=a0_0x38161e;try{const _0x2f4e46=await _0x56fb5f[_0xc1b97a(0x1ed)](LTM_DP_RAW_LOG);if(_0x2f4e46&&_0x2f4e46[_0xc1b97a(0x1d7)])_0x56fb5f['rawEventLog']=JSON[_0xc1b97a(0x1f8)](_0x2f4e46['val']);}catch(_0x2d13e1){_0x56fb5f[_0xc1b97a(0x156)]=[];}}async function saveRawEventLog(_0x3ac802){const _0x3fb3cf=a0_0x38161e;if(_0x3ac802[_0x3fb3cf(0x156)][_0x3fb3cf(0x288)]>RAW_LOG_MAX_SIZE)_0x3ac802[_0x3fb3cf(0x156)][_0x3fb3cf(0x16a)](0x0,_0x3ac802[_0x3fb3cf(0x156)][_0x3fb3cf(0x288)]-RAW_LOG_MAX_SIZE);await _0x3ac802[_0x3fb3cf(0x106)](LTM_DP_RAW_LOG,{'val':JSON[_0x3fb3cf(0x1e5)](_0x3ac802['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0xbc14ba){const _0x539649=a0_0x38161e;try{const _0x466e00=await _0xbc14ba[_0x539649(0x1ed)](LTM_DP_DAILY_DIGESTS);if(_0x466e00&&_0x466e00[_0x539649(0x1d7)])_0xbc14ba['dailyDigests']=JSON['parse'](_0x466e00['val']);}catch(_0x57636c){_0xbc14ba[_0x539649(0x1b3)]=[];}await updateBaselineStatus(_0xbc14ba);}async function saveDailyDigests(_0x369d0c,_0x240bbe=!![]){const _0x4a8c95=a0_0x38161e,_0x2e066a=_0x369d0c[_0x4a8c95(0x14d)][_0x4a8c95(0x1ab)]||0x3c;_0x369d0c[_0x4a8c95(0x1b3)][_0x4a8c95(0x288)]>_0x2e066a&&_0x369d0c[_0x4a8c95(0x1b3)][_0x4a8c95(0x16a)](0x0,_0x369d0c[_0x4a8c95(0x1b3)][_0x4a8c95(0x288)]-_0x2e066a);await _0x369d0c[_0x4a8c95(0x106)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x4a8c95(0x1e5)](_0x369d0c['dailyDigests']),'ack':!![]});if(_0x240bbe)await updateBaselineStatus(_0x369d0c);}async function updateAnalysisHistory(_0x1e0ba9,_0x32ccc6){const _0x264d06=a0_0x38161e;_0x1e0ba9['analysisHistory'][_0x264d06(0x223)](_0x32ccc6);if(_0x1e0ba9[_0x264d06(0x134)]['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x1e0ba9['analysisHistory'][_0x264d06(0x1a6)]();await _0x1e0ba9[_0x264d06(0x106)](_0x264d06(0x23e),{'val':JSON[_0x264d06(0x1e5)](_0x1e0ba9[_0x264d06(0x134)]),'ack':!![]});}async function updateBaselineStatus(_0x3d2068){const _0x308b99=a0_0x38161e;if(!_0x3d2068['isProVersion']){await _0x3d2068[_0x308b99(0x106)](LTM_DP_BASELINE_STATUS,{'val':_0x308b99(0x132),'ack':!![]});return;}const _0x5dd156=_0x3d2068[_0x308b99(0x1b3)][_0x308b99(0x288)]>=(_0x3d2068[_0x308b99(0x14d)][_0x308b99(0x11c)]||0x7)?_0x308b99(0x1bc)+_0x3d2068[_0x308b99(0x1b3)][_0x308b99(0x288)]+_0x308b99(0x117):'Lernphase\x20('+_0x3d2068[_0x308b99(0x1b3)][_0x308b99(0x288)]+'/'+(_0x3d2068[_0x308b99(0x14d)][_0x308b99(0x11c)]||0x7)+')';await _0x3d2068[_0x308b99(0x106)](LTM_DP_BASELINE_STATUS,{'val':_0x5dd156,'ack':!![]});}async function loadSystemMode(_0x22c3b2){const _0x2f13d8=a0_0x38161e;try{const _0x5aecaa=await _0x22c3b2['getStateAsync'](SYSTEM_DP_MODE);_0x5aecaa&&_0x5aecaa[_0x2f13d8(0x1d7)]&&Object['values'](SYSTEM_MODES)[_0x2f13d8(0x1dc)](_0x5aecaa[_0x2f13d8(0x1d7)])?_0x22c3b2[_0x2f13d8(0x269)]=_0x5aecaa[_0x2f13d8(0x1d7)]:(_0x22c3b2[_0x2f13d8(0x269)]=SYSTEM_MODES[_0x2f13d8(0x224)],await _0x22c3b2[_0x2f13d8(0x106)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x2f13d8(0x224)],'ack':!![]}));}catch(_0x369408){_0x22c3b2[_0x2f13d8(0x269)]=SYSTEM_MODES[_0x2f13d8(0x224)];}}async function createAllObjects(_0x141211){const _0x592b4d=a0_0x38161e;await _0x141211[_0x592b4d(0x26d)](_0x592b4d(0x1e7),{'type':_0x592b4d(0x21c),'common':{'name':_0x592b4d(0x187)},'native':{}}),await _0x141211[_0x592b4d(0x26d)](SYSTEM_DP_MODE,{'type':_0x592b4d(0x14f),'common':{'name':'System\x20Mode','type':_0x592b4d(0x230),'role':_0x592b4d(0x14f),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL']},'native':{}}),await _0x141211[_0x592b4d(0x10b)]('system.presenceWho',{'type':'state','common':{'name':'Who\x20is\x20present?','type':_0x592b4d(0x230),'role':_0x592b4d(0x204),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)]('events.lastEvent',{'type':'state','common':{'name':'Last\x20raw\x20event','type':'string','role':_0x592b4d(0x13d),'read':!![],'write':![]},'native':{}}),await _0x141211['setObjectNotExistsAsync'](_0x592b4d(0x23b),{'type':'state','common':{'name':'Event\x20History','type':_0x592b4d(0x230),'role':_0x592b4d(0x13d),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x26d)](_0x592b4d(0x27a),{'type':_0x592b4d(0x21c),'common':{'name':_0x592b4d(0x15d)},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x189),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x253),'type':_0x592b4d(0x137),'role':_0x592b4d(0x205),'read':!![],'write':!![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x152),{'type':_0x592b4d(0x14f),'common':{'name':'Train\x20Health','type':'boolean','role':_0x592b4d(0x205),'read':!![],'write':!![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)]('analysis.training.triggerEnergy',{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x286),'type':_0x592b4d(0x137),'role':_0x592b4d(0x205),'read':!![],'write':!![]},'native':{}}),await _0x141211['setObjectNotExistsAsync']('analysis.training.status',{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x13c),'type':_0x592b4d(0x230),'role':_0x592b4d(0x204),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x26d)](_0x592b4d(0x147),{'type':'channel','common':{'name':'Security\x20Monitor'},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x127),{'type':'state','common':{'name':'Anomaly\x20Score','type':_0x592b4d(0x24c),'role':_0x592b4d(0x261),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)]('analysis.security.lastCheck',{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x21e),'type':'string','role':_0x592b4d(0x159),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x26d)](_0x592b4d(0x273),{'type':'channel','common':{'name':_0x592b4d(0x26a)},'native':{}}),await _0x141211['setObjectNotExistsAsync'](_0x592b4d(0x227),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x21e),'type':'string','role':'date','read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x282),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x1a5),'type':'boolean','role':_0x592b4d(0x25e),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x1a2),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x24f),'type':_0x592b4d(0x230),'role':_0x592b4d(0x204),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)]('analysis.health.trendValue',{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x214),'type':'number','role':'value','read':!![],'write':![]},'native':{}}),await _0x141211['extendObjectAsync'](_0x592b4d(0x26f),{'type':_0x592b4d(0x21c),'common':{'name':_0x592b4d(0x284)},'native':{}}),await _0x141211[_0x592b4d(0x10b)]('analysis.energy.insulationScore',{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x179),'type':_0x592b4d(0x230),'role':_0x592b4d(0x204),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)]('analysis.energy.heatingScore',{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x163),'type':_0x592b4d(0x230),'role':_0x592b4d(0x204),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x26d)](_0x592b4d(0x241),{'type':'channel','common':{'name':_0x592b4d(0x241)},'native':{}}),await _0x141211[_0x592b4d(0x26d)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x592b4d(0x112),'type':_0x592b4d(0x230),'role':_0x592b4d(0x13d),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x26d)](LTM_DP_DAILY_DIGESTS,{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x18d),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x1c6),{'type':_0x592b4d(0x14f),'common':{'name':'Sequences','type':_0x592b4d(0x230),'role':_0x592b4d(0x13d),'read':!![],'write':![]},'native':{}}),await _0x141211['setObjectNotExistsAsync'](_0x592b4d(0x19f),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x257),'type':_0x592b4d(0x230),'role':'json','read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x135),{'type':'state','common':{'name':_0x592b4d(0x238),'type':_0x592b4d(0x137),'role':_0x592b4d(0x205),'read':!![],'write':!![]},'native':{}}),await _0x141211['setObjectNotExistsAsync'](_0x592b4d(0x202),{'type':'state','common':{'name':_0x592b4d(0x20f),'type':'boolean','role':_0x592b4d(0x205),'read':!![],'write':!![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x1c4),{'type':'state','common':{'name':_0x592b4d(0x1aa),'type':'boolean','role':_0x592b4d(0x12a),'read':!![],'write':![]},'native':{}}),await _0x141211['setObjectNotExistsAsync'](_0x592b4d(0x18f),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x1f7),'type':_0x592b4d(0x230),'role':_0x592b4d(0x1b9),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x1c2),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x194),'type':_0x592b4d(0x230),'role':_0x592b4d(0x204),'read':!![],'write':![]},'native':{}}),await _0x141211['setObjectNotExistsAsync'](_0x592b4d(0x12c),{'type':'state','common':{'name':'Pattern\x20Detected','type':'boolean','role':_0x592b4d(0x25e),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x158),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x207),'type':_0x592b4d(0x230),'role':_0x592b4d(0x204),'read':!![],'write':![]},'native':{}}),await _0x141211['setObjectNotExistsAsync']('analysis.automation.targetId',{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x10e),'type':_0x592b4d(0x230),'role':_0x592b4d(0x204),'read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x182),{'type':_0x592b4d(0x14f),'common':{'name':'Target\x20Value','type':_0x592b4d(0x230),'role':'text','read':!![],'write':![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)]('analysis.automation.autoApply',{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x126),'type':_0x592b4d(0x137),'role':_0x592b4d(0xfa),'read':!![],'write':!![]},'native':{}}),await _0x141211[_0x592b4d(0x10b)](_0x592b4d(0x198),{'type':_0x592b4d(0x14f),'common':{'name':_0x592b4d(0x13f),'type':_0x592b4d(0x137),'role':_0x592b4d(0x205),'read':!![],'write':!![]},'native':{}});}async function getWeatherContext(_0x3bc107){const _0x2daff2=a0_0x38161e;try{if(!_0x3bc107[_0x2daff2(0x14d)]['useWeather'])return _0x2daff2(0x275);let _0x323f3b='';const _0x350c93=_0x3bc107[_0x2daff2(0x14d)][_0x2daff2(0x1f1)];if(_0x350c93)try{if(_0x350c93[_0x2daff2(0x1dc)](_0x2daff2(0x15f))){const _0x268363=await _0x3bc107[_0x2daff2(0x140)](_0x350c93+_0x2daff2(0x212));if(_0x268363&&_0x268363[_0x2daff2(0x1d7)])_0x323f3b=_0x268363[_0x2daff2(0x1d7)];}else{if(_0x350c93[_0x2daff2(0x1dc)](_0x2daff2(0x24d))){const _0x32e67c=await _0x3bc107[_0x2daff2(0x140)](_0x350c93+_0x2daff2(0x171));if(_0x32e67c&&_0x32e67c[_0x2daff2(0x1d7)])_0x323f3b=_0x32e67c[_0x2daff2(0x1d7)];}else{if(_0x350c93[_0x2daff2(0x1dc)]('openweathermap')){const _0x2278cd=await _0x3bc107[_0x2daff2(0x140)](_0x350c93+_0x2daff2(0x281));if(_0x2278cd&&_0x2278cd[_0x2daff2(0x1d7)])_0x323f3b=_0x2278cd[_0x2daff2(0x1d7)];}}}}catch(_0x2c051a){}return _0x323f3b?'WETTER:\x20'+_0x323f3b:'WETTER:\x20Keine\x20Daten';}catch(_0x53dc74){return'WETTER\x20ERROR:\x20'+_0x53dc74['message'];}}async function getCalendarContext(_0x4745b7){const _0x1d775c=a0_0x38161e;try{if(!_0x4745b7[_0x1d775c(0x14d)][_0x1d775c(0x25a)])return _0x1d775c(0xf9);const _0x318052=_0x4745b7[_0x1d775c(0x14d)]['calendarInstance']||'ical.0',_0x1bac5a=await _0x4745b7[_0x1d775c(0x140)](_0x318052+_0x1d775c(0x23d));if(_0x1bac5a&&_0x1bac5a['val']){let _0xa244b5=JSON[_0x1d775c(0x1f8)](_0x1bac5a[_0x1d775c(0x1d7)]);if(Array['isArray'](_0xa244b5)&&_0xa244b5[_0x1d775c(0x288)]>0x0)return'KALENDER:\x20'+_0xa244b5['slice'](0x0,0x3)[_0x1d775c(0x1ca)](_0x525dac=>_0x525dac['event'])[_0x1d775c(0x1b1)](',\x20');}}catch(_0x2534ee){}return _0x1d775c(0x267);}async function sendNotification(_0xe839d3,_0x59b52a,_0x3060c8=![],_0x429e38=![]){const _0xbced6f=a0_0x38161e,_0x3bba30=_0xe839d3[_0xbced6f(0x14d)];if(_0x3bba30[_0xbced6f(0x176)]){let _0xc85aac={};(_0x59b52a[_0xbced6f(0x1dc)](_0xbced6f(0x184))||_0x429e38)&&(_0xc85aac={'reply_markup':{'inline_keyboard':[[{'text':_0xbced6f(0x17e),'callback_data':_0xbced6f(0x276)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0xe839d3['sendToAsync'](_0x3bba30[_0xbced6f(0x272)],_0xbced6f(0x228),{'text':_0x59b52a,'user':_0x3bba30['notifyTelegramRecipient'],..._0xc85aac});}if(_0x3bba30[_0xbced6f(0x14e)]){let _0x588708={'message':_0x59b52a,'title':_0x429e38?_0xbced6f(0x192):_0xbced6f(0x12f),'priority':_0x429e38?0x2:0x1,'device':_0x3bba30[_0xbced6f(0x14a)]};_0x429e38&&(_0x588708[_0xbced6f(0x118)]=0x1e,_0x588708[_0xbced6f(0x195)]=0xe10,_0x588708[_0xbced6f(0x1e3)]=_0xbced6f(0x1c8)),await _0xe839d3[_0xbced6f(0x1b0)](_0x3bba30[_0xbced6f(0x283)],_0xbced6f(0x228),_0x588708);}_0x3bba30[_0xbced6f(0x172)]&&await _0xe839d3[_0xbced6f(0x1b0)](_0x3bba30[_0xbced6f(0x1d1)],'send',{'text':_0x59b52a,'to':_0x3bba30['notifyEmailRecipient']});}function a0_0x5ac5(_0x480d91,_0x271fbc){const _0x529fed=a0_0x57d6();return a0_0x5ac5=function(_0x1da0d5,_0x5a0d17){_0x1da0d5=_0x1da0d5-0xf3;let _0x57d6d7=_0x529fed[_0x1da0d5];return _0x57d6d7;},a0_0x5ac5(_0x480d91,_0x271fbc);}async function runGeminiAnalysis(_0x5424dc,_0x56d6fe=''){const _0x2875d9=a0_0x38161e;if(!_0x5424dc[_0x2875d9(0x105)])return;if(_0x5424dc[_0x2875d9(0x1bb)][_0x2875d9(0x288)]===0x0)return;const _0x2a4a7c=_0x5424dc[_0x2875d9(0x1bb)][_0x2875d9(0x164)](0x0,0xf),_0x3b0244=await getWeatherContext(_0x5424dc),_0x4da928=_0x5424dc['currentSystemMode'],_0x2579b2=PERSONA_MAPPING[_0x5424dc[_0x2875d9(0x14d)]['aiPersona']||_0x2875d9(0x145)],_0x2c1b9d=_0x5424dc[_0x2875d9(0x14d)][_0x2875d9(0x1ad)]||_0x2875d9(0x17d);let _0x55db69=_0x2875d9(0x162);try{const _0x2a3e5e=await _0x5424dc[_0x2875d9(0x1ed)]('system.presenceWho');if(_0x2a3e5e&&_0x2a3e5e[_0x2875d9(0x1d7)])_0x55db69=_0x2a3e5e[_0x2875d9(0x1d7)];}catch(_0x31607f){}let _0x36bd68=![];try{const _0x2b4879=await _0x5424dc[_0x2875d9(0x1ed)](_0x2875d9(0x24e));if(_0x2b4879&&_0x2b4879[_0x2875d9(0x1d7)])_0x36bd68=!![];}catch(_0xa9c7d1){}const _0x3d92f0='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x2579b2+_0x2875d9(0x138)+_0x2c1b9d+_0x2875d9(0x1ea)+_0x4da928+_0x2875d9(0x11b)+_0x3b0244+_0x2875d9(0x245)+_0x55db69+_0x2875d9(0x22a)+JSON['stringify'](_0x2a4a7c)+_0x2875d9(0x146)+_0x56d6fe+_0x2875d9(0xfb);try{const _0x4b90f9=await _0x5424dc[_0x2875d9(0x105)][_0x2875d9(0x256)](_0x3d92f0),_0x31ba34=_0x4b90f9[_0x2875d9(0x27e)][_0x2875d9(0x204)]()[_0x2875d9(0x210)](/```json|```/g,'')[_0x2875d9(0x20d)](),_0x87906=JSON['parse'](_0x31ba34);await _0x5424dc[_0x2875d9(0x106)](_0x2875d9(0x168),{'val':JSON[_0x2875d9(0x1e5)](_0x87906),'ack':!![]});if(_0x87906[_0x2875d9(0x143)])await _0x5424dc[_0x2875d9(0x106)]('analysis.activitySummary',{'val':_0x87906[_0x2875d9(0x143)],'ack':!![]});const _0x114584={'timestamp':Date[_0x2875d9(0x121)](),'id':Date['now']()[_0x2875d9(0x116)](),'analysis':{'activity':{'summary':_0x87906[_0x2875d9(0x143)],'isAlert':_0x87906[_0x2875d9(0x1d6)],'alertReason':_0x87906[_0x2875d9(0x110)]},'comfort':{'automationProposal':_0x87906[_0x2875d9(0x120)]}}};await updateAnalysisHistory(_0x5424dc,_0x114584);const _0x47f15f=_0x87906[_0x2875d9(0x1d6)]||![];_0x47f15f!==_0x5424dc[_0x2875d9(0x27b)]&&(await _0x5424dc[_0x2875d9(0x106)](_0x2875d9(0x1c4),{'val':_0x47f15f,'ack':!![]}),_0x5424dc[_0x2875d9(0x27b)]=_0x47f15f,_0x47f15f&&(await _0x5424dc[_0x2875d9(0x106)](_0x2875d9(0x18f),{'val':_0x87906[_0x2875d9(0x110)],'ack':!![]}),sendNotification(_0x5424dc,_0x2875d9(0x26c)+_0x87906[_0x2875d9(0x110)],![],_0x87906['isEmergency'])));if(_0x87906[_0x2875d9(0x120)]&&_0x87906[_0x2875d9(0x120)][_0x2875d9(0x209)]){await _0x5424dc['setStateAsync'](_0x2875d9(0x12c),{'val':!![],'ack':!![]}),await _0x5424dc[_0x2875d9(0x106)](_0x2875d9(0x158),{'val':_0x87906[_0x2875d9(0x120)][_0x2875d9(0x141)],'ack':!![]}),await _0x5424dc[_0x2875d9(0x106)]('analysis.automation.targetId',{'val':_0x87906[_0x2875d9(0x120)][_0x2875d9(0x130)],'ack':!![]}),await _0x5424dc[_0x2875d9(0x106)](_0x2875d9(0x182),{'val':JSON['stringify'](_0x87906[_0x2875d9(0x120)][_0x2875d9(0x242)]),'ack':!![]});if(_0x36bd68)executeAutomationAction(_0x5424dc);}}catch(_0x56335e){_0x5424dc[_0x2875d9(0x24b)][_0x2875d9(0x22b)](_0x2875d9(0x1d4)+_0x56335e[_0x2875d9(0x263)]);}}async function createDailyDigest(_0x4e5867){const _0x1b19a1=a0_0x38161e;if(!_0x4e5867[_0x1b19a1(0x13e)])return;await _0x4e5867[_0x1b19a1(0x106)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0x4e5867[_0x1b19a1(0x105)]||_0x4e5867['rawEventLog'][_0x1b19a1(0x288)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4e5867['setStateAsync'](LTM_DP_STATUS,{'val':_0x1b19a1(0x203),'ack':!![]});return;}const _0xc77ca4=JSON[_0x1b19a1(0x1f8)](JSON[_0x1b19a1(0x1e5)](_0x4e5867['rawEventLog'])),_0x3d32c9=_0xc77ca4[_0x1b19a1(0x288)],_0x5dd16e=_0x1b19a1(0x279)+JSON[_0x1b19a1(0x1e5)](_0xc77ca4);try{const _0x9b8d40=await _0x4e5867[_0x1b19a1(0x105)]['generateContent'](_0x5dd16e),_0xaf9b96=JSON[_0x1b19a1(0x1f8)](_0x9b8d40['response'][_0x1b19a1(0x204)]()[_0x1b19a1(0x210)](/```json|```/g,'')[_0x1b19a1(0x20d)]()),_0x3c6925={'timestamp':new Date()[_0x1b19a1(0x1b5)](),'eventCount':_0x3d32c9,'summary':_0xaf9b96['summary']||_0x1b19a1(0x22e),'activityLevel':_0xaf9b96['activityLevel']||_0x1b19a1(0x102),'systemMode':_0x4e5867['currentSystemMode']};_0x4e5867['dailyDigests'][_0x1b19a1(0x185)](_0x3c6925),await saveDailyDigests(_0x4e5867),_0x4e5867[_0x1b19a1(0x156)]=[],await saveRawEventLog(_0x4e5867),await _0x4e5867[_0x1b19a1(0x106)](LTM_DP_STATUS,{'val':_0x1b19a1(0x114),'ack':!![]});if(_0x4e5867[_0x1b19a1(0x13e)])sendToPython(_0x4e5867,_0x1b19a1(0x1f0),{'digest':_0x3c6925});}catch(_0x4b7823){_0x4e5867[_0x1b19a1(0x24b)][_0x1b19a1(0x22b)](_0x4b7823['message']);}}async function runBaselineDriftAnalysis(_0x4c0529){const _0x471a89=a0_0x38161e;if(!_0x4c0529[_0x471a89(0x13e)]||!_0x4c0529[_0x471a89(0x105)])return;const _0x18ff9a=_0x4c0529[_0x471a89(0x14d)][_0x471a89(0x21a)]||0xe;if(_0x4c0529['dailyDigests']['length']<_0x18ff9a+0x7){await _0x4c0529[_0x471a89(0x106)](LTM_DP_DRIFT_STATUS,{'val':_0x471a89(0x221),'ack':!![]});return;}const _0x5aaee8=_0x4c0529[_0x471a89(0x1b3)][_0x471a89(0x164)](-_0x18ff9a),_0x5974d8=_0x4c0529[_0x471a89(0x1b3)]['slice'](0x0,_0x4c0529[_0x471a89(0x1b3)][_0x471a89(0x288)]-_0x18ff9a),_0x57a907=_0x471a89(0x27f)+JSON[_0x471a89(0x1e5)](_0x5974d8)+'\x0aSTB:\x20'+JSON['stringify'](_0x5aaee8);try{const _0x299dec=await _0x4c0529['geminiModel'][_0x471a89(0x256)](_0x57a907),_0xdbe4ee=JSON[_0x471a89(0x1f8)](_0x299dec['response']['text']()[_0x471a89(0x210)](/```json|```/g,'')[_0x471a89(0x20d)]());_0xdbe4ee['baselineDrift']&&(await _0x4c0529[_0x471a89(0x106)](LTM_DP_DRIFT_STATUS,{'val':_0xdbe4ee['baselineDrift'],'ack':!![]}),await _0x4c0529[_0x471a89(0x106)](LTM_DP_DRIFT_DETAILS,{'val':_0xdbe4ee[_0x471a89(0x1f9)],'ack':!![]}),await _0x4c0529[_0x471a89(0x106)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x553878){}}async function sendMorningBriefing(_0x4da67d){const _0x4344fb=a0_0x38161e;if(!_0x4da67d['geminiModel'])return;_0x4da67d['log'][_0x4344fb(0x15e)](_0x4344fb(0x1a0));const _0x3e2e69=_0x4da67d[_0x4344fb(0x1b3)][_0x4344fb(0x288)]>0x0?_0x4da67d[_0x4344fb(0x1b3)][_0x4da67d[_0x4344fb(0x1b3)][_0x4344fb(0x288)]-0x1]:null,_0x324d1b=_0x3e2e69&&_0x3e2e69['health']?_0x3e2e69['health']['sleepScore']:_0x4344fb(0x235),_0x779325=new Date();_0x779325[_0x4344fb(0x23a)](0x4,0x0,0x0,0x0);const _0x8cc0ff=_0x4da67d[_0x4344fb(0x1bb)][_0x4344fb(0x25d)](_0x5d32e8=>new Date(_0x5d32e8['timestamp'])>_0x779325),_0x5dd070=PERSONA_MAPPING[_0x4da67d['config'][_0x4344fb(0x262)]||_0x4344fb(0x145)],_0xfe02b6=_0x4da67d['config'][_0x4344fb(0x1ad)]||'',_0x235750=await getWeatherContext(_0x4da67d),_0x2211c4=await getCalendarContext(_0x4da67d),_0x4cd63a=_0x4344fb(0x1f6)+_0x5dd070+_0x4344fb(0x138)+_0xfe02b6+'.\x20ZUSATZ:\x20'+_0x235750+'\x20'+_0x2211c4+_0x4344fb(0x155)+_0x324d1b+'/100.\x20OUTPUT:\x20Text.';try{const _0xd5fb1b=await _0x4da67d['geminiModel']['generateContent'](_0x4cd63a),_0x4a74fd=_0x4344fb(0x17c)+_0xd5fb1b[_0x4344fb(0x27e)][_0x4344fb(0x204)]()[_0x4344fb(0x20d)]();sendNotification(_0x4da67d,_0x4a74fd);}catch(_0x162ff6){_0x4da67d[_0x4344fb(0x24b)]['error'](_0x4344fb(0x22f)+_0x162ff6[_0x4344fb(0x263)]);}}function setupLtmScheduler(_0x3ee85a){const _0x1d6e88=a0_0x38161e;try{if(_0x3ee85a[_0x1d6e88(0x122)])_0x3ee85a[_0x1d6e88(0x122)][_0x1d6e88(0x16e)]();if(!_0x3ee85a[_0x1d6e88(0x13e)])return;_0x3ee85a['ltmJob']=schedule[_0x1d6e88(0x10d)](LTM_SCHEDULE,()=>createDailyDigest(_0x3ee85a));}catch(_0x1c340a){_0x3ee85a[_0x1d6e88(0x24b)][_0x1d6e88(0x22b)]('LTM\x20Sched\x20Error:\x20'+_0x1c340a['message']);}}function setupModeResetScheduler(_0x4832d9){const _0x635e3e=a0_0x38161e;try{if(_0x4832d9[_0x635e3e(0x107)])_0x4832d9[_0x635e3e(0x107)]['cancel']();_0x4832d9[_0x635e3e(0x107)]=schedule[_0x635e3e(0x10d)](MODE_RESET_SCHEDULE,async()=>{const _0x5d8abf=_0x635e3e;await loadSystemMode(_0x4832d9),AUTO_RESET_MODES[_0x5d8abf(0x1dc)](_0x4832d9['currentSystemMode'])&&await _0x4832d9[_0x5d8abf(0x106)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x3769d6){_0x4832d9['log']['error']('Reset\x20Sched\x20Error:\x20'+_0x3769d6[_0x635e3e(0x263)]);}}function setupDriftAnalysisScheduler(_0x257775){const _0x438759=a0_0x38161e;try{if(_0x257775[_0x438759(0x206)])clearInterval(_0x257775[_0x438759(0x206)]);if(!_0x257775['isProVersion'])return;_0x257775[_0x438759(0x206)]=setInterval(()=>runBaselineDriftAnalysis(_0x257775),(_0x257775[_0x438759(0x14d)][_0x438759(0x1f5)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x257775),0x1388);}catch(_0x141cb0){_0x257775[_0x438759(0x24b)][_0x438759(0x22b)](_0x438759(0x11f)+_0x141cb0[_0x438759(0x263)]);}}function setupBriefingScheduler(_0xdd3e14){const _0x1c1213=a0_0x38161e;try{if(_0xdd3e14['briefingJob'])_0xdd3e14[_0x1c1213(0x167)][_0x1c1213(0x16e)]();if(!_0xdd3e14[_0x1c1213(0x14d)][_0x1c1213(0x265)])return;const _0x321185=(_0xdd3e14['config'][_0x1c1213(0x1db)]||'08:00')[_0x1c1213(0x21f)](':'),_0x11500c=parseInt(_0x321185[0x0])||0x8,_0x3d59fa=parseInt(_0x321185[0x1])||0x0,_0x566dea=_0x3d59fa+'\x20'+_0x11500c+_0x1c1213(0x211);_0xdd3e14[_0x1c1213(0x167)]=schedule[_0x1c1213(0x10d)](_0x566dea,()=>{sendMorningBriefing(_0xdd3e14);});}catch(_0x3cc88b){_0xdd3e14[_0x1c1213(0x24b)]['error'](_0x1c1213(0x24a)+_0x3cc88b[_0x1c1213(0x263)]);}}function sendToPython(_0x10726c,_0x2ec40e,_0x170a3c={}){const _0x44f5b7=a0_0x38161e;if(!_0x10726c[_0x44f5b7(0x216)]||!_0x10726c[_0x44f5b7(0x216)][_0x44f5b7(0x23f)][_0x44f5b7(0x17a)])return;const _0x5e4355=JSON['stringify']({'command':_0x2ec40e,..._0x170a3c});try{_0x10726c[_0x44f5b7(0x216)]['stdin'][_0x44f5b7(0x14c)](_0x5e4355+'\x0a');}catch(_0x210faf){}}async function runPythonHealthCheck(_0x1f2068){const _0x1235bc=a0_0x38161e;if(!_0x1f2068[_0x1235bc(0x1b3)]||_0x1f2068[_0x1235bc(0x1b3)][_0x1235bc(0x288)]<0x2)return;const _0x484e92=_0x1f2068[_0x1235bc(0x1b3)][_0x1235bc(0x1ca)](_0x25c8ec=>{const _0x24704a=(_0x25c8ec['activityLevel']||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x24704a]||0x32;});sendToPython(_0x1f2068,_0x1235bc(0x1ce),{'values':_0x484e92,'tag':'Activity-Level'});}function handlePythonResult(_0x19fc4b,_0x1957b4){const _0x143fc8=a0_0x38161e;if(_0x1957b4[_0x143fc8(0x149)]==='PONG')_0x19fc4b[_0x143fc8(0x24b)]['debug'](_0x143fc8(0x119));else{if(_0x1957b4[_0x143fc8(0x149)]==='SECURITY_RESULT'){const {anomaly_score:_0x2e475b,is_anomaly:_0x2ca3b8,threshold:_0x5cd531}=_0x1957b4['payload'];_0x19fc4b[_0x143fc8(0x24b)]['info'](_0x143fc8(0xfe)+_0x2e475b[_0x143fc8(0x150)](0x5)+_0x143fc8(0x20b)+(_0x2ca3b8?_0x143fc8(0x260):'OK')),_0x19fc4b[_0x143fc8(0x106)]('analysis.security.lastScore',{'val':_0x2e475b,'ack':!![]}),_0x19fc4b['setStateAsync'](_0x143fc8(0x196),{'val':new Date()[_0x143fc8(0x1b5)](),'ack':!![]});if(_0x2ca3b8){const _0x444cd5=_0x143fc8(0x197)+_0x2e475b['toFixed'](0x4)+')';_0x19fc4b['setStateAsync'](_0x143fc8(0x1c4),{'val':!![],'ack':!![]}),_0x19fc4b[_0x143fc8(0x106)]('analysis.alertReason',{'val':_0x444cd5,'ack':!![]}),sendNotification(_0x19fc4b,_0x143fc8(0x274)+_0x444cd5,![],!![]);}}else{if(_0x1957b4[_0x143fc8(0x149)]===_0x143fc8(0x188)){const {success:_0x2dd2fc,details:_0x586a9a}=_0x1957b4[_0x143fc8(0x26b)];_0x19fc4b['setStateAsync'](_0x143fc8(0x254),{'val':_0x2dd2fc?_0x143fc8(0x174)+new Date()['toLocaleTimeString']()+'\x20('+_0x586a9a+')':_0x143fc8(0x1af)+_0x586a9a,'ack':!![]});}else{if(_0x1957b4[_0x143fc8(0x149)]===_0x143fc8(0x181)){const {success:_0x2bae80,details:_0x1b80f6}=_0x1957b4[_0x143fc8(0x26b)];if(_0x2bae80)try{const _0x528399=JSON[_0x143fc8(0x1f8)](_0x1b80f6);if(_0x528399[_0x143fc8(0x180)])_0x19fc4b['setStateAsync'](_0x143fc8(0x21b),{'val':JSON[_0x143fc8(0x1e5)](_0x528399['insulation']),'ack':!![]});if(_0x528399[_0x143fc8(0x136)])_0x19fc4b[_0x143fc8(0x106)](_0x143fc8(0x1be),{'val':JSON[_0x143fc8(0x1e5)](_0x528399[_0x143fc8(0x136)]),'ack':!![]});}catch(_0x12c893){}}else{if(_0x1957b4[_0x143fc8(0x149)]===_0x143fc8(0x1e6)){const {success:_0x586aad,details:_0x56d833}=_0x1957b4[_0x143fc8(0x26b)];if(_0x586aad)_0x19fc4b['log'][_0x143fc8(0x15e)](_0x143fc8(0x229)+_0x56d833);}else{if(_0x1957b4['type']===_0x143fc8(0x277)){const {is_anomaly:_0x3c40f5,details:_0x37be1b}=_0x1957b4['payload'];_0x19fc4b[_0x143fc8(0x106)]('analysis.health.lastCheck',{'val':new Date()[_0x143fc8(0x1b5)](),'ack':!![]}),_0x19fc4b['setStateAsync'](_0x143fc8(0x282),{'val':_0x3c40f5,'ack':!![]});}else{if(_0x1957b4[_0x143fc8(0x149)]===_0x143fc8(0x108)){const {diagnosis:_0x4461f5,change_percent:_0x5241f0}=_0x1957b4[_0x143fc8(0x26b)];_0x19fc4b['log'][_0x143fc8(0x15e)](_0x143fc8(0x111)+_0x4461f5+'\x20('+_0x5241f0+'%)'),_0x19fc4b['setStateAsync'](_0x143fc8(0x1a2),{'val':_0x4461f5,'ack':!![]}),_0x19fc4b[_0x143fc8(0x106)]('analysis.health.trendValue',{'val':_0x5241f0,'ack':!![]});}}}}}}}}function installPythonDependencies(_0x6ec17e){const _0x217ae6=a0_0x38161e;if(_0x6ec17e[_0x217ae6(0x1ef)]||panicMode)return;_0x6ec17e[_0x217ae6(0x1ef)]=!![];const _0x4c70f0=path[_0x217ae6(0x1b1)](__dirname,_0x217ae6(0x1c3),_0x217ae6(0x244));_0x6ec17e[_0x217ae6(0x24b)][_0x217ae6(0x15e)]('ðŸ› ï¸\x20MAINTENANCE\x20MODE:\x20Hard\x20Reset\x20of\x20Python\x20environment.\x20Deleting\x20'+VENV_PATH+'...'),stopPythonService(_0x6ec17e);if(fs['existsSync'](VENV_PATH))try{fs[_0x217ae6(0x23c)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x2df007){}exec(_0x217ae6(0x148)+VENV_PATH+'\x22',_0x1aec74=>{const _0x523711=_0x217ae6;if(_0x1aec74){_0x6ec17e[_0x523711(0x24b)]['error'](_0x523711(0x153)),_0x6ec17e[_0x523711(0x1ef)]=![],panicMode=!![];return;}installRequirementsInVenv(_0x6ec17e,_0x4c70f0);});}function installRequirementsInVenv(_0x3bc408,_0x559b76){const _0xf4d972=a0_0x38161e;_0x3bc408[_0xf4d972(0x24b)]['info'](_0xf4d972(0x266));const _0x1a8232='\x22'+PIP_EXE+_0xf4d972(0xfc)+_0x559b76+'\x22';exec(_0x1a8232,{'timeout':0x124f80},(_0x53d951,_0x104c9c,_0x290b7a)=>{const _0x4fdcb4=_0xf4d972;_0x3bc408[_0x4fdcb4(0x1ef)]=![],_0x53d951?(_0x3bc408[_0x4fdcb4(0x24b)][_0x4fdcb4(0x22b)]('âŒ\x20INSTALL\x20FAILED:\x20'+(_0x290b7a||_0x53d951[_0x4fdcb4(0x263)])),panicMode=!![]):(_0x3bc408[_0x4fdcb4(0x24b)][_0x4fdcb4(0x15e)](_0x4fdcb4(0x219)),exec('\x22'+PYTHON_EXE+_0x4fdcb4(0x103),(_0x38abe8,_0x76db04)=>{const _0x5b4f2f=_0x4fdcb4;_0x76db04&&_0x76db04[_0x5b4f2f(0x1dc)]('OK')?(_0x3bc408[_0x5b4f2f(0x24b)][_0x5b4f2f(0x15e)]('âœ…\x20VERIFICATION\x20PASSED.\x20Starting\x20Service.'),startPythonService(_0x3bc408)):(_0x3bc408['log']['error'](_0x5b4f2f(0x11e)),panicMode=!![]);}));});}function startPythonService(_0x3a8537){const _0x447704=a0_0x38161e;if(_0x3a8537[_0x447704(0x1ef)]||panicMode)return;let _0x295632='python3';if(fs[_0x447704(0x243)](PYTHON_EXE))_0x3a8537[_0x447704(0x24b)]['info'](_0x447704(0x22c)+PYTHON_EXE),_0x295632=PYTHON_EXE;else{_0x3a8537['log']['warn'](_0x447704(0x270)),installPythonDependencies(_0x3a8537);return;}try{const _0xa451a4=path['join'](__dirname,_0x447704(0x1c3),_0x447704(0x1ae));_0x3a8537['pythonProcess']=spawn(_0x295632,[_0xa451a4]),_0x3a8537['pythonProcess'][_0x447704(0xff)]['on']('data',_0xe13877=>{const _0x126dbf=_0x447704,_0x110e17=_0xe13877[_0x126dbf(0x116)]()['split']('\x0a');_0x110e17[_0x126dbf(0x1eb)](_0x29d983=>{const _0x71768=_0x126dbf,_0x4341c1=_0x29d983[_0x71768(0x20d)]();if(!_0x4341c1)return;if(_0x4341c1[_0x71768(0x1d9)](_0x71768(0x1f4)))_0x3a8537[_0x71768(0x24b)][_0x71768(0x1a7)](_0x71768(0x1d8)+_0x4341c1[_0x71768(0x240)](0x5)[_0x71768(0x20d)]());else{if(_0x4341c1['startsWith']('[RESULT]'))try{const _0x4f59a7=JSON['parse'](_0x4341c1[_0x71768(0x240)](0x8)[_0x71768(0x20d)]());handlePythonResult(_0x3a8537,_0x4f59a7);}catch(_0x132e18){_0x3a8537[_0x71768(0x24b)]['warn']('Invalid\x20JSON:\x20'+_0x4341c1);}}_0x4341c1[_0x71768(0x1dc)](_0x71768(0x15a))&&(_0x3a8537[_0x71768(0x24b)][_0x71768(0x22b)](_0x71768(0x233)+_0x4341c1+_0x71768(0x1ee)),panicMode=!![],stopPythonService(_0x3a8537));});}),_0x3a8537[_0x447704(0x216)][_0x447704(0x11a)]['on'](_0x447704(0x16f),_0x56c549=>{const _0x2dd4fb=_0x447704,_0x3ba7c6=_0x56c549['toString']()['trim']();if(!_0x3ba7c6['includes'](_0x2dd4fb(0x191)))_0x3a8537[_0x2dd4fb(0x24b)][_0x2dd4fb(0x22b)]('[PYTHON\x20ERR]\x20'+_0x3ba7c6);}),_0x3a8537[_0x447704(0x216)]['on'](_0x447704(0x183),_0xedd43=>{const _0x4df482=_0x447704;_0x3a8537[_0x4df482(0x24b)]['info']('[PYTHON]\x20Exited\x20'+_0xedd43),_0x3a8537['pythonProcess']=null,_0xedd43!==0x0&&!panicMode&&setTimeout(()=>startPythonService(_0x3a8537),0x7530);});}catch(_0x18ff68){_0x3a8537[_0x447704(0x24b)][_0x447704(0x22b)](_0x447704(0x13a)+_0x18ff68[_0x447704(0x263)]);}}function stopPythonService(_0x115e8b){const _0x47ceec=a0_0x38161e;if(_0x115e8b[_0x47ceec(0x216)]){_0x115e8b['log']['info'](_0x47ceec(0x1de));try{_0x115e8b[_0x47ceec(0x216)]['kill']();}catch(_0x5c9527){}_0x115e8b[_0x47ceec(0x216)]=null;}}async function getCalendarNames(_0x580865,_0x59bd31){const _0x3410ab=a0_0x38161e;try{const _0x5d86d0=await _0x580865[_0x3410ab(0x140)](_0x59bd31+_0x3410ab(0x23d));if(_0x5d86d0&&_0x5d86d0[_0x3410ab(0x1d7)]){const _0x489e6d=JSON[_0x3410ab(0x1f8)](_0x5d86d0[_0x3410ab(0x1d7)]);if(Array[_0x3410ab(0x225)](_0x489e6d))return[...new Set(_0x489e6d[_0x3410ab(0x1ca)](_0x2c3866=>_0x2c3866[_0x3410ab(0x144)])[_0x3410ab(0x25d)](Boolean))][_0x3410ab(0x252)]();}}catch(_0x2d26c4){}return[];}async function getCalendarContext(_0x2c383e){const _0x10a72e=a0_0x38161e;if(!_0x2c383e[_0x10a72e(0x14d)][_0x10a72e(0x25a)])return _0x10a72e(0xf9);const _0x4712b7=_0x2c383e[_0x10a72e(0x14d)][_0x10a72e(0x161)]||_0x10a72e(0x113);try{const _0x10f615=await _0x2c383e[_0x10a72e(0x140)](_0x4712b7+_0x10a72e(0x23d));if(_0x10f615&&_0x10f615[_0x10a72e(0x1d7)]){let _0x4670f9=JSON['parse'](_0x10f615[_0x10a72e(0x1d7)]);if(Array['isArray'](_0x4670f9)){if(_0x4670f9[_0x10a72e(0x288)]>0x0)return _0x10a72e(0x1a8)+_0x4670f9[_0x10a72e(0x164)](0x0,0x3)['map'](_0x200625=>_0x200625['event'])[_0x10a72e(0x1b1)](',\x20');}}}catch(_0x80f05e){}return _0x10a72e(0x267);}async function saveFeedback(_0x395ce5,_0x388dab){const _0x3207eb=a0_0x38161e;_0x395ce5[_0x3207eb(0x24b)][_0x3207eb(0x15e)]('Feedback:\x20'+JSON[_0x3207eb(0x1e5)](_0x388dab));}async function initSensorSubscriptions(_0x5685a3){const _0x53524d=a0_0x38161e,_0x567ddf=_0x5685a3[_0x53524d(0x14d)]['devices'];if(_0x567ddf)for(const _0x5329c2 of _0x567ddf){await _0x5685a3[_0x53524d(0x1fb)](_0x5329c2['id']);}}async function initPresenceSubscriptions(_0x11d1a4){const _0x32e406=a0_0x38161e,_0x4de5d2=_0x11d1a4[_0x32e406(0x14d)]['presenceDevices'];if(_0x4de5d2)for(const _0x1ace65 of _0x4de5d2){await _0x11d1a4['subscribeForeignStatesAsync'](_0x1ace65);}}async function setupTelegramListener(_0x324e24){const _0x265df3=a0_0x38161e,_0x10ee63=_0x324e24['config'][_0x265df3(0x272)];if(_0x324e24[_0x265df3(0x14d)][_0x265df3(0x176)]&&_0x10ee63)await _0x324e24[_0x265df3(0x1fb)](_0x10ee63+'.communicate.request');}async function checkWifiPresence(_0x14fa58){const _0x45ca3a=a0_0x38161e;try{const _0x406be7=_0x14fa58[_0x45ca3a(0x14d)][_0x45ca3a(0x19e)]||[];let _0x349420=![];const _0x490317=[];for(const _0x2c10ed of _0x406be7){try{const _0x238a6d=await _0x14fa58[_0x45ca3a(0x140)](_0x2c10ed);_0x238a6d&&(_0x238a6d[_0x45ca3a(0x1d7)]===!![]||_0x238a6d[_0x45ca3a(0x1d7)]==='online'||_0x238a6d[_0x45ca3a(0x1d7)]===0x1)&&(_0x349420=!![],_0x490317['push'](_0x2c10ed));}catch(_0x5e730d){}}return await _0x14fa58[_0x45ca3a(0x106)]('system.presenceWho',{'val':_0x490317[_0x45ca3a(0x1b1)](',\x20'),'ack':!![]}),_0x349420&&(_0x14fa58[_0x45ca3a(0x166)]&&(_0x14fa58[_0x45ca3a(0x24b)][_0x45ca3a(0x15e)](_0x45ca3a(0x1d2)),abortExitTimer(_0x14fa58)),!_0x14fa58['isPresent']&&_0x14fa58[_0x45ca3a(0x269)]===SYSTEM_MODES[_0x45ca3a(0x224)]&&await setPresence(_0x14fa58,!![])),_0x349420;}catch(_0x263aa3){return![];}}function startExitTimer(_0x42e54e){const _0x27c53f=a0_0x38161e;abortExitTimer(_0x42e54e),_0x42e54e[_0x27c53f(0x27c)]=!![],_0x42e54e[_0x27c53f(0x22d)]=setTimeout(()=>{const _0x3ca406=_0x27c53f;_0x42e54e[_0x3ca406(0x27c)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x42e54e['exitTimer']=setTimeout(()=>{const _0x58df47=_0x27c53f;setPresence(_0x42e54e,![]),_0x42e54e[_0x58df47(0x166)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0xa370ec){const _0x209eb9=a0_0x38161e;if(_0xa370ec[_0x209eb9(0x166)])clearTimeout(_0xa370ec[_0x209eb9(0x166)]);if(_0xa370ec[_0x209eb9(0x22d)])clearTimeout(_0xa370ec[_0x209eb9(0x22d)]);_0xa370ec[_0x209eb9(0x166)]=null,_0xa370ec[_0x209eb9(0x22d)]=null,_0xa370ec[_0x209eb9(0x27c)]=![];}async function setPresence(_0x4fa140,_0x45548d){const _0xfc5a2d=a0_0x38161e;if(_0x4fa140[_0xfc5a2d(0x1ac)]===_0x45548d)return;_0x4fa140['isPresent']=_0x45548d,await _0x4fa140[_0xfc5a2d(0x106)](_0xfc5a2d(0x239),{'val':_0x45548d,'ack':!![]});}async function executeAutomationAction(_0x17261b){const _0x36368b=a0_0x38161e;try{const _0x22bdbf=await _0x17261b[_0x36368b(0x1ed)](_0x36368b(0x20e)),_0x208ddf=await _0x17261b[_0x36368b(0x1ed)](_0x36368b(0x182));if(_0x22bdbf&&_0x22bdbf[_0x36368b(0x1d7)]&&_0x208ddf){const _0x3831d6=_0x22bdbf[_0x36368b(0x1d7)];let _0x314c64=_0x208ddf[_0x36368b(0x1d7)];try{_0x314c64=JSON[_0x36368b(0x1f8)](_0x314c64);}catch(_0x31a4ea){}_0x17261b[_0x36368b(0x24b)][_0x36368b(0x15e)](_0x36368b(0x10c)+_0x3831d6+_0x36368b(0x1ba)+_0x314c64),await _0x17261b[_0x36368b(0x1fd)](_0x3831d6,_0x314c64);}else _0x17261b[_0x36368b(0x24b)]['warn']('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x40747a){_0x17261b[_0x36368b(0x24b)][_0x36368b(0x22b)](_0x36368b(0x1e1)+_0x40747a[_0x36368b(0x263)]);}}async function handleTelegramResponse(_0x15afc2,_0x4454b8){const _0x2b778b=a0_0x38161e;let _0x2679c3=_0x4454b8;_0x4454b8[_0x2b778b(0x1d9)]('[')&&(_0x2679c3=_0x4454b8['substring'](_0x4454b8[_0x2b778b(0x1a9)](']')+0x1));if(_0x2679c3===_0x2b778b(0x276))await _0x15afc2[_0x2b778b(0x106)](_0x2b778b(0x1c4),{'val':![],'ack':!![]}),await _0x15afc2['setStateAsync']('analysis.alertReason',{'val':_0x2b778b(0x1d3),'ack':!![]}),_0x15afc2[_0x2b778b(0x27b)]=![],sendNotification(_0x15afc2,_0x2b778b(0x12e),![]);else _0x2679c3==='COGNI_REQUEST_CALL'&&sendNotification(_0x15afc2,_0x2b778b(0x13b),![],!![]);}class CogniLiving extends utils[a0_0x38161e(0x208)]{constructor(_0x586032){const _0x31e6e2=a0_0x38161e;super({..._0x586032,'name':_0x31e6e2(0xfd)}),this[_0x31e6e2(0x1bb)]=[],this[_0x31e6e2(0x134)]=[],this[_0x31e6e2(0x156)]=[],this[_0x31e6e2(0x1b3)]=[],this[_0x31e6e2(0xf3)]={},this[_0x31e6e2(0x1cc)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x31e6e2(0x1ac)]=!![],this[_0x31e6e2(0x166)]=null,this[_0x31e6e2(0x22d)]=null,this[_0x31e6e2(0x27c)]=![],this[_0x31e6e2(0x1ec)]=null,this[_0x31e6e2(0x105)]=null,this[_0x31e6e2(0x269)]=SYSTEM_MODES['NORMAL'],this['isProVersion']=![],this[_0x31e6e2(0x27b)]=![],this[_0x31e6e2(0x175)]=_0x31e6e2(0x1e2),this[_0x31e6e2(0x1a4)]=null,this[_0x31e6e2(0x122)]=null,this[_0x31e6e2(0x107)]=null,this['driftAnalysisTimer']=null,this[_0x31e6e2(0x167)]=null,this[_0x31e6e2(0x216)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x31e6e2(0x236),this[_0x31e6e2(0x217)][_0x31e6e2(0x10a)](this)),this['on'](_0x31e6e2(0xf7),this[_0x31e6e2(0x186)]['bind'](this)),this['on'](_0x31e6e2(0x201),this[_0x31e6e2(0x1b4)][_0x31e6e2(0x10a)](this)),this['on'](_0x31e6e2(0x263),this[_0x31e6e2(0x226)][_0x31e6e2(0x10a)](this));}async['onReady'](){const _0x573989=a0_0x38161e;this[_0x573989(0x24b)][_0x573989(0x15e)](_0x573989(0x17b)+this[_0x573989(0x1a1)]+_0x573989(0x25c)),await initZombies(this);try{this[_0x573989(0x13e)]=await checkLicense(this,this['config'][_0x573989(0x19c)]);}catch(_0x42e968){}if(!this['config'][_0x573989(0x1fe)]||this[_0x573989(0x14d)]['inactivityThresholdHours']<0.1)this[_0x573989(0x14d)][_0x573989(0x1fe)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x573989(0x14d)][_0x573989(0x173)])try{this['genAI']=new GoogleGenerativeAI(this[_0x573989(0x14d)][_0x573989(0x173)]),this[_0x573989(0x105)]=this[_0x573989(0x1ec)][_0x573989(0x1dd)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x573989(0x123)}}),this['log'][_0x573989(0x15e)](_0x573989(0x151));}catch(_0x1d538c){this['log']['error'](_0x573989(0x142)+_0x1d538c[_0x573989(0x263)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x573989(0x1cd)](_0x573989(0x135)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x573989(0x1cd)](_0x573989(0x25f)),this['subscribeStates']('analysis.triggerBriefing'),this[_0x573989(0x1cd)](_0x573989(0x198)),this[_0x573989(0x1cd)]('analysis.automation.autoApply'),this['subscribeStates'](_0x573989(0x189)),this['subscribeStates'](_0x573989(0x152)),this[_0x573989(0x1cd)](_0x573989(0x1b6)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x573989(0x1a4)])clearInterval(this[_0x573989(0x1a4)]);const _0x3aec78=this[_0x573989(0x14d)][_0x573989(0x193)]||0xf;_0x3aec78>0x0&&(this[_0x573989(0x1a4)]=setInterval(()=>{runAutopilot(this);},_0x3aec78*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x171cef=_0x573989;if(this[_0x171cef(0x216)])runPythonHealthCheck(this);},0x1388);}[a0_0x38161e(0x1b4)](_0x5b695c){const _0x20180e=a0_0x38161e;if(this[_0x20180e(0x1a4)])clearInterval(this[_0x20180e(0x1a4)]);if(this[_0x20180e(0x206)])clearInterval(this[_0x20180e(0x206)]);if(this[_0x20180e(0x122)])this[_0x20180e(0x122)][_0x20180e(0x16e)]();if(this[_0x20180e(0x107)])this['modeResetJob'][_0x20180e(0x16e)]();if(this[_0x20180e(0x167)])this['briefingJob'][_0x20180e(0x16e)]();if(this[_0x20180e(0x166)])clearTimeout(this[_0x20180e(0x166)]);if(this['exitGraceTimer'])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x5b695c();}async[a0_0x38161e(0x186)](_0x5d880,_0x3d4098){const _0x4c5749=a0_0x38161e;if(!_0x3d4098||this[_0x4c5749(0x1ef)])return;if(_0x5d880[_0x4c5749(0x1dc)]('telegram')&&_0x5d880[_0x4c5749(0x1c7)](_0x4c5749(0x133))&&_0x3d4098[_0x4c5749(0x1d7)]){await handleTelegramResponse(this,_0x3d4098[_0x4c5749(0x1d7)]);return;}if(_0x5d880===this[_0x4c5749(0x215)]+'.'+SYSTEM_DP_MODE){if(_0x3d4098['val']&&Object[_0x4c5749(0x199)](SYSTEM_MODES)[_0x4c5749(0x1dc)](_0x3d4098['val'])){this[_0x4c5749(0x269)]=_0x3d4098[_0x4c5749(0x1d7)];if(_0x3d4098[_0x4c5749(0x1d7)]===SYSTEM_MODES[_0x4c5749(0x165)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x3d4098[_0x4c5749(0x21d)])this[_0x4c5749(0x1df)](_0x5d880,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x3d4098[_0x4c5749(0x21d)]){_0x5d880[_0x4c5749(0x1dc)](_0x4c5749(0x135))&&_0x3d4098['val']&&(this[_0x4c5749(0x1df)](_0x5d880,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x5d880[_0x4c5749(0x1dc)](_0x4c5749(0x251))&&_0x3d4098[_0x4c5749(0x1d7)]){this['setState'](_0x5d880,{'val':![],'ack':!![]});if(this[_0x4c5749(0x13e)])createDailyDigest(this);}_0x5d880[_0x4c5749(0x1dc)](_0x4c5749(0x124))&&_0x3d4098['val']&&(this[_0x4c5749(0x1df)](_0x5d880,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x5d880['includes'](_0x4c5749(0x139))&&_0x3d4098[_0x4c5749(0x1d7)]&&(this['setState'](_0x5d880,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x5d880[_0x4c5749(0x1dc)]('analysis.training.triggerSecurity')&&_0x3d4098['val']){this['setState'](_0x5d880,{'val':![],'ack':!![]});if(this[_0x4c5749(0x13e)])try{const _0x60cd8d=await this[_0x4c5749(0x1ed)](_0x4c5749(0x1c6));if(_0x60cd8d&&_0x60cd8d[_0x4c5749(0x1d7)]){const _0xd9c0b6=JSON[_0x4c5749(0x1f8)](_0x60cd8d[_0x4c5749(0x1d7)]);this['log'][_0x4c5749(0x15e)](_0x4c5749(0x1da)),this['setStateAsync'](_0x4c5749(0x254),{'val':_0x4c5749(0x1c9),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0xd9c0b6});}}catch(_0x49c4b4){this[_0x4c5749(0x24b)]['error'](_0x4c5749(0x18b)+_0x49c4b4[_0x4c5749(0x263)]);}}if(_0x5d880[_0x4c5749(0x1dc)](_0x4c5749(0x152))&&_0x3d4098[_0x4c5749(0x1d7)]){this['setState'](_0x5d880,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x15ced0=await this[_0x4c5749(0x1ed)](LTM_DP_DAILY_DIGESTS);if(_0x15ced0&&_0x15ced0[_0x4c5749(0x1d7)])sendToPython(this,_0x4c5749(0x1e4),{'digests':JSON[_0x4c5749(0x1f8)](_0x15ced0[_0x4c5749(0x1d7)])});}catch(_0x2aa591){}}if(_0x5d880[_0x4c5749(0x1dc)](_0x4c5749(0x1b6))&&_0x3d4098[_0x4c5749(0x1d7)]){this[_0x4c5749(0x1df)](_0x5d880,{'val':![],'ack':!![]});if(this[_0x4c5749(0x13e)])try{const _0x7e470f=await this['getStateAsync']('LTM.trainingData.thermodynamics');if(_0x7e470f&&_0x7e470f[_0x4c5749(0x1d7)])sendToPython(this,_0x4c5749(0x220),{'points':JSON[_0x4c5749(0x1f8)](_0x7e470f[_0x4c5749(0x1d7)])});}catch(_0x3075ae){}}return;}if(this[_0x4c5749(0x14d)][_0x4c5749(0x19e)]&&this['config'][_0x4c5749(0x19e)][_0x4c5749(0x1dc)](_0x5d880)){await checkWifiPresence(this);return;}const _0x5b8dbb=(this[_0x4c5749(0x14d)][_0x4c5749(0x104)]||[])['find'](_0x12d447=>_0x12d447['id']===_0x5d880);if(_0x5b8dbb)processSensorEvent(this,_0x5d880,_0x3d4098,_0x5b8dbb);}async[a0_0x38161e(0x226)](_0x1912dc){const _0x4a8739=a0_0x38161e;if(typeof _0x1912dc===_0x4a8739(0xf5)&&_0x1912dc[_0x4a8739(0x263)]){if(_0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0x1cb)){const _0x5a5e1b=_0x1912dc['message'][_0x4a8739(0x247)]||this[_0x4a8739(0x14d)][_0x4a8739(0x173)];if(!_0x5a5e1b)return this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':![],'message':_0x4a8739(0x12b)},_0x1912dc[_0x4a8739(0x232)]);try{const _0x29125b=new GoogleGenerativeAI(_0x5a5e1b),_0x4ef870=_0x29125b[_0x4a8739(0x1dd)]({'model':GEMINI_MODEL}),_0x3a8133=await _0x4ef870['generateContent']('Hi');this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':!![],'message':'OK:\x20'+_0x3a8133[_0x4a8739(0x27e)][_0x4a8739(0x204)]()},_0x1912dc[_0x4a8739(0x232)]);}catch(_0x64383a){this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':![],'message':_0x4a8739(0x258)+_0x64383a[_0x4a8739(0x263)]},_0x1912dc[_0x4a8739(0x232)]);}}else{if(_0x1912dc[_0x4a8739(0x1a3)]==='testContext'){const _0x5621b7=await getWeatherContext(this),_0xecc94a=await getCalendarContext(this);this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':!![],'weather':_0x5621b7,'calendar':_0xecc94a},_0x1912dc[_0x4a8739(0x232)]);}else{if(_0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0x1fa)){if(!this[_0x4a8739(0x13e)])return this[_0x4a8739(0x178)](_0x1912dc['from'],_0x1912dc[_0x4a8739(0x1a3)],{'success':![],'isPro':![]},_0x1912dc[_0x4a8739(0x232)]);let _0x546337={'status':_0x4a8739(0x235)};try{const _0x395765=await this[_0x4a8739(0x1ed)](LTM_DP_DRIFT_STATUS);_0x546337[_0x4a8739(0x19a)]=_0x395765?_0x395765[_0x4a8739(0x1d7)]:'N/A';}catch(_0x4af03e){}this['sendTo'](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x4a8739(0x1b3)],'driftAnalysis':_0x546337,'analysisHistory':this['analysisHistory']},_0x1912dc['callback']);}else{if(_0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0x109)){const _0x47604d=this['dailyDigests'][_0x4a8739(0x288)],_0x4ea0cb=new Date(),_0xe0cb8b=new Date(_0x4ea0cb[_0x4a8739(0x16c)](),_0x4ea0cb['getMonth'](),_0x4ea0cb[_0x4a8739(0x190)]())[_0x4a8739(0x249)](),_0xcdb892=this[_0x4a8739(0x156)]['filter'](_0x101e6f=>new Date(_0x101e6f[_0x4a8739(0x1d5)])[_0x4a8739(0x249)]()>_0xe0cb8b)[_0x4a8739(0x288)],_0x388b9c=new Array(0x18)['fill'](0x0);this[_0x4a8739(0x156)][_0x4a8739(0x1eb)](_0x52a536=>{const _0x66f12a=_0x4a8739,_0x146b99=new Date(_0x52a536[_0x66f12a(0x1d5)]);if(_0x146b99[_0x66f12a(0x249)]()>_0xe0cb8b)_0x388b9c[_0x146b99[_0x66f12a(0x18a)]()]++;});let _0x218749={'status':'N/A'};try{const _0x590c68=await this[_0x4a8739(0x1ed)](LTM_DP_DRIFT_STATUS);_0x218749[_0x4a8739(0x19a)]=_0x590c68?_0x590c68[_0x4a8739(0x1d7)]:'N/A';}catch(_0x5764eb){}let _0x30887c='';try{const _0x31d82f=await this['getStateAsync'](_0x4a8739(0x177));_0x30887c=_0x31d82f?_0x31d82f[_0x4a8739(0x1d7)]:'';}catch(_0x3b214e){}let _0x31d10c=null;!this[_0x4a8739(0x105)]&&(_0x31d10c=this['config'][_0x4a8739(0x173)]?_0x4a8739(0x19d):'Kein\x20API\x20Key!');let _0x441bc8={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x3a50e8=await this[_0x4a8739(0x1ed)](_0x4a8739(0x12c));if(_0x3a50e8&&_0x3a50e8[_0x4a8739(0x1d7)]){_0x441bc8['detected']=!![];const _0x20ba7=await this['getStateAsync'](_0x4a8739(0x158));_0x441bc8['description']=_0x20ba7?_0x20ba7[_0x4a8739(0x1d7)]:'';const _0x38a4a4=await this[_0x4a8739(0x1ed)]('analysis.automation.targetId');_0x441bc8[_0x4a8739(0x130)]=_0x38a4a4?_0x38a4a4['val']:'';const _0x492a42=await this[_0x4a8739(0x1ed)](_0x4a8739(0x182));_0x441bc8[_0x4a8739(0x242)]=_0x492a42?_0x492a42['val']:'';}const _0x1d6987=await this[_0x4a8739(0x1ed)](_0x4a8739(0x24e));_0x441bc8['autoApply']=_0x1d6987?!!_0x1d6987['val']:![];}catch(_0x212c4b){}this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc['command'],{'success':!![],'eventHistory':this[_0x4a8739(0x1bb)]['slice'](0x0,0xf),'stats':{'digestCount':_0x47604d,'eventCountToday':_0xcdb892,'hourlyActivity':_0x388b9c,'driftStatus':_0x218749[_0x4a8739(0x19a)],'isPresent':this[_0x4a8739(0x1ac)],'presenceWho':_0x30887c,'minDays':this[_0x4a8739(0x14d)][_0x4a8739(0x11c)]||0x7,'stbDays':this[_0x4a8739(0x14d)][_0x4a8739(0x21a)]||0xe,'ltbDays':this[_0x4a8739(0x14d)][_0x4a8739(0x1ab)]||0x3c,'systemError':_0x31d10c},'automation':_0x441bc8},_0x1912dc[_0x4a8739(0x232)]);}else{if(_0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0x1bf))try{const _0x4dbafe=await scanForDevices(this,_0x1912dc[_0x4a8739(0x263)]||{});this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':!![],'devices':_0x4dbafe},_0x1912dc[_0x4a8739(0x232)]);}catch(_0x45aa11){this['sendTo'](_0x1912dc[_0x4a8739(0x231)],_0x1912dc['command'],{'success':![],'error':_0x45aa11[_0x4a8739(0x263)]},_0x1912dc['callback']);}else{if(_0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0x12d)){const _0x181369=await this[_0x4a8739(0x1cf)]('enum.functions.*','enum'),_0xe07297=[];if(_0x181369)for(const _0x476e28 in _0x181369){const _0x4cd4ac=_0x181369[_0x476e28],_0x56edef=(_0x4cd4ac[_0x4a8739(0x250)]&&typeof _0x4cd4ac[_0x4a8739(0x250)][_0x4a8739(0x213)]===_0x4a8739(0xf5)?_0x4cd4ac[_0x4a8739(0x250)][_0x4a8739(0x213)]['de']:_0x4cd4ac[_0x4a8739(0x250)][_0x4a8739(0x213)])||_0x4cd4ac['common'][_0x4a8739(0x213)];_0xe07297['push']({'id':_0x476e28,'name':_0x56edef});}this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':!![],'enums':_0xe07297},_0x1912dc[_0x4a8739(0x232)]);}else{if(_0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0x271)){const _0x34d6ee=_0x1912dc[_0x4a8739(0x263)]['instance'];if(!_0x34d6ee)return this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':![],'error':_0x4a8739(0x100)},_0x1912dc['callback']);const _0x42b0c6=await getCalendarNames(this,_0x34d6ee);this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc['command'],{'success':!![],'names':_0x42b0c6},_0x1912dc['callback']);}else{if(_0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0x160)){const {targetId:_0x54136e,targetValue:_0x1532dd}=_0x1912dc[_0x4a8739(0x263)];this[_0x4a8739(0x24b)][_0x4a8739(0x15e)](_0x4a8739(0x1c5)+_0x54136e+_0x4a8739(0x1ba)+_0x1532dd),await this[_0x4a8739(0x106)](_0x4a8739(0x12c),{'val':!![],'ack':!![]}),await this[_0x4a8739(0x106)](_0x4a8739(0x158),{'val':_0x4a8739(0x18c)+_0x54136e,'ack':!![]}),await this[_0x4a8739(0x106)](_0x4a8739(0x20e),{'val':_0x54136e,'ack':!![]}),await this[_0x4a8739(0x106)]('analysis.automation.targetValue',{'val':_0x1532dd,'ack':!![]}),this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc['command'],{'success':!![]},_0x1912dc[_0x4a8739(0x232)]);}else{if(_0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0x278)){const {historyId:_0x1c6c42,rating:_0x5c0b11,comment:_0x3bc481,alertReason:_0x3a75dc}=_0x1912dc[_0x4a8739(0x263)];_0x1c6c42&&_0x5c0b11?(await saveFeedback(this,{'timestamp':Date[_0x4a8739(0x121)](),'historyId':_0x1c6c42,'rating':_0x5c0b11,'comment':_0x3bc481,'alertReason':_0x3a75dc}),this['sendTo'](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':!![]},_0x1912dc[_0x4a8739(0x232)])):this['sendTo'](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':![],'error':_0x4a8739(0x1e9)},_0x1912dc['callback']);}else _0x1912dc[_0x4a8739(0x1a3)]===_0x4a8739(0xf8)&&(this['log'][_0x4a8739(0x15e)](_0x4a8739(0x264)),await this[_0x4a8739(0x106)](_0x4a8739(0x12c),{'val':![],'ack':!![]}),await this[_0x4a8739(0x106)](_0x4a8739(0x158),{'val':'','ack':!![]}),this[_0x4a8739(0x178)](_0x1912dc[_0x4a8739(0x231)],_0x1912dc[_0x4a8739(0x1a3)],{'success':!![]},_0x1912dc['callback']));}}}}}}}}}}}if(require[a0_0x38161e(0x154)]!==module)module[a0_0x38161e(0x131)]=_0x6c13eb=>new CogniLiving(_0x6c13eb);else new CogniLiving();