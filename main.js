function a0_0x78fb(_0x137253,_0x416c29){const _0xb10c89=a0_0x3eaa();return a0_0x78fb=function(_0x504bb5,_0x438e31){_0x504bb5=_0x504bb5-0x15b;let _0x3eaa17=_0xb10c89[_0x504bb5];return _0x3eaa17;},a0_0x78fb(_0x137253,_0x416c29);}const a0_0x66eca8=a0_0x78fb;(function(_0x317e2f,_0x4e8ca3){const _0x5df2a8=a0_0x78fb,_0x5e20b9=_0x317e2f();while(!![]){try{const _0x1c84fd=-parseInt(_0x5df2a8(0x1a0))/0x1+-parseInt(_0x5df2a8(0x284))/0x2*(parseInt(_0x5df2a8(0x210))/0x3)+parseInt(_0x5df2a8(0x228))/0x4+parseInt(_0x5df2a8(0x218))/0x5+parseInt(_0x5df2a8(0x19b))/0x6*(-parseInt(_0x5df2a8(0x2bf))/0x7)+parseInt(_0x5df2a8(0x185))/0x8+parseInt(_0x5df2a8(0x1a2))/0x9;if(_0x1c84fd===_0x4e8ca3)break;else _0x5e20b9['push'](_0x5e20b9['shift']());}catch(_0x12f47e){_0x5e20b9['push'](_0x5e20b9['shift']());}}}(a0_0x3eaa,0x28d5f));const a0_0x438e31=(function(){let _0x4542c6=!![];return function(_0x2158ba,_0x57e87d){const _0x50ceeb=_0x4542c6?function(){const _0x50d2ad=a0_0x78fb;if(_0x57e87d){const _0xe6af43=_0x57e87d[_0x50d2ad(0x295)](_0x2158ba,arguments);return _0x57e87d=null,_0xe6af43;}}:function(){};return _0x4542c6=![],_0x50ceeb;};}()),a0_0x504bb5=a0_0x438e31(this,function(){const _0x260ebf=a0_0x78fb;return a0_0x504bb5['toString']()[_0x260ebf(0x233)](_0x260ebf(0x1f7))[_0x260ebf(0x200)]()[_0x260ebf(0x15b)](a0_0x504bb5)['search'](_0x260ebf(0x1f7));});a0_0x504bb5();'use strict';function a0_0x3eaa(){const _0x34316e=['lastAlertState','systemConfig','SYSTEM_MODES','setStateAsync','updateHealthVector','VACATION',',\x20Events:\x0a','updateSchedulePreview','isProVersion','No\x20data','trackerHeartbeat','12174XWnWGC','modules','getTime','common','üìù\x20Manual\x20event\x20logged:\x20','15063aiUhgp','setHours','997830CqnsBt','log','endsWith','./lib/dead_man','toLocaleDateString','checkWifiPresence','modeResetJob','analysis.energy.warmupTargets','existsSync','isRelevantActivity','health','¬∞C\x20(Innen:\x20','includes','analysis.safety.infrasoundAlert','security','analysisTimer','presenceCheckTimer','exitGraceTimer','pop','LTM.trainingData.sequences','startSystem','currentSystemMode','parse','val','Unbekannt','checkLicense','ack','historyJob','.data.table','infrasoundEnabled','üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20','bootTime','triggerGaitAnalysis\x20error:\x20','find','üîä\x20Infraschall-Alarm:\x20','History\x20Save\x20Error:\x20','.json','getOverviewData','Sec-Training\x20started...','instance','value','push','./lib/setup','max','triggerGaitAnalysis\x20parse\x20error:\x20','appendToLog','analysis.training.triggerSecurity','./lib/scanner','analysis.security.learningStatus','window','moduleHealth','Unknown','triggerGaitAnalysis','thermostat','saveDailyHistory','.system.mode','setObjectNotExistsAsync','LTM.rawEventLog','moduleEnergy','triggerInfrasoundCorrelation','Init...','some','send','bind','checkWifiPresence:\x20Error\x20checking\x20','@google/generative-ai','./lib/topology','getHours','moduleSecurity','heiter','healthTrendInterval','analysis.health.activityTrend','¬∞C,\x20Au√üen:\x20','then','python','abortExitTimer','klar','unshift','pulse','LTM.dailyDigests','filter','de-DE','protectAiMemory','forEach','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','(((.+)+)+)+$','toFixed','isArray','inactivityThresholdHours','getForeignStateAsync','getHistoryData','onMessage','driftAnalysisTimer','forecast.current.weather','toString','location','cancel','onReady','custom','@iobroker/adapter-core','events.history','üíæ\x20Saving\x20Daily\x20History\x20for\x20','üí®\x20L√ºftung\x20in\x20','calendarCheckTimer','system.presenceWho','analysis.visualization.pulse','analysis.automation.patternDetected','callback','presenceDevices','analyzeWindowOpening\x20error:\x20','120726lsqAEq','namespace','loadSystemMode','analysis.prediction.trackerConfidence','getGenerativeModel','all','scanDevices','sendNotification','1664280rTxKbo','memoryCache','party','date','bin','startService','./lib/ai_agent','cogni-living\x20adapter\x20starting\x20(v','\x20events\x20from\x20standard\x20storage.','2-digit','minDaysForBaseline','\x20>\x20','sensorLastValues','toLowerCase','geminiApiKey','analyzeWindowOpening','71660bcFZss','generateContent','ANALYZE_GAIT','manual','devices','infrasoundLocked','triggerEnergyPrediction','exports','analysis.prediction.trackerTopRoom','runPythonHealthCheck','rows','search','handleInfrasound','comfort','analysis.health.geminiNight','text','cogni-living','generateHealthReport','temperature','object','guest','dailyDigests','analysis.energy.warmupTimes','length','replayTodayEvents','testApiKey','pressureBuffer','setPresence','analysis.activity.roomStats','analysis.automation.description','analysis.health.todayVector','main','getAbsoluteDefaultDataDir','processSensorEvent','sonn','subscribeForeignStatesAsync','system','integrateRoomTime','Warte\x20auf\x20Analyse...','analysis.automation.targetId','replace','outdoorSensorId','toLocaleTimeString','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','\x20-\x20','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','scanThermostats','ltmJob','runAutopilot','reduce','floor','DAY','./lib/python_bridge','subscribeStates','analysis.ventilation.lastWindow','checkSolarCondition','enum.functions.*','analysis.activity.roomHistory','system.adapter.ical.È¶ô','online','analysis.health.todayRoomDetails','open','calendarName','readFileSync','door','analysis.training.triggerEnergy','L√ºften\x20empfohlen','scanForDevices','timestamp','sendTo','Sonne:\x20','getForeignObjectsAsync','onUnload','history','createDailyDigest','message','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','updateLocation','Daily\x20Activity\x20Vector\x20(48x30min)','./lib/automation',',\x20Temp:\x20','energy','Keine\x20Daten','name','Guest\x20Mode','analysis.security.lastScore','\x20(Bewohner\x20anwesend\x20-\x20normal)','{\x22history\x22:{}}','üîÆ\x20Energy\x20Prediction\x20triggered\x20(','LTM.triggerDailyDigest','abs','stringify','2aPxnBA','setDate','NIGHT','command','analysis.training.status','eventHistory','isPresent','getCalendarNames','writeFileSync','infrasoundArmingId','keys','accuweather.0','Niemand','isSolar','LTM.baselineStatus','mkdirSync','number','apply','rawEventLog','slice','getObjectViewAsync','type','Adapter','initSystemConfig','üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','Gemini\x20Report\x20Day','.isOnline','now','join','system.adapter.ical.','TRAIN_TOPOLOGY','config','Kein\x20API\x20Key\x20√ºbergeben.','error','enum','./lib/recorder','infrasoundSensorId','warn',':\x20Temp-Differenz\x20','split','analysis.training.triggerTopology','SYSTEM_DP_MODE','automation.triggerAction','triggerHealth\x20error:\x20','TRAIN_HEALTH','dependencyInstallInProgress','values','getStateAsync','info','.venv','NORMAL','isGracePeriodActive','shift','initHistory','add','updateTopology','Aktiv\x20(','weatherTempId','map','1008QSIwql','motion','\x20events\x20from\x20today...','[Integrator]\x20Error:\x20','‚Ü∫\x20Replaying\x20','utf8','analysis.trigger','lastTrackerEventTime','exitTimer','apiKey','geminiModel','constructor','stateChange','Gemini\x20Init\x20Error:\x20','Warm-Up\x20Time','‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','infrasoundThreshold','SET_LEARNING_MODE','Lernphase\x20(','enum.rooms.*','json','sources','getMinutes','checkCalendarTriggers','\x20sequences','application/json','üì¶\x20Restored\x20','licenseKey','string','roomIntegratorTimer','getDate','terrasse','threshold_exceeded','./lib/installer','min','state','Corrupt','triggerDailyDigest','initZombies','.uptime','path','genAI','Event','setState','Verbindung\x20erfolgreich:\x20','fill','‚úÖ\x20History\x20saved:\x20','analysisHistory','response','triggerBriefing','scheduleJob','Gute\x20L√ºftungsm√∂glichkeit!','debug','424824dBUbaT','todayVector','from','useCalendar','analysis.training.triggerHealth','moduleComfort','activeModules','sendMorningBriefing','analysis.training.triggerComfort','Gemini\x20Report\x20Night','CALCULATE_HEALTH_TREND'];a0_0x3eaa=function(){return _0x34316e;};return a0_0x3eaa();}const utils=require(a0_0x66eca8(0x205)),{GoogleGenerativeAI}=require(a0_0x66eca8(0x1e3)),path=require(a0_0x66eca8(0x178)),fs=require('fs'),installer=require(a0_0x66eca8(0x171)),scanner=require(a0_0x66eca8(0x1d1)),schedulers=require('./lib/scheduler'),topology=require(a0_0x66eca8(0x1e4)),setup=require(a0_0x66eca8(0x1cc)),recorder=require(a0_0x66eca8(0x2a7)),pythonBridge=require(a0_0x66eca8(0x25c)),aiAgent=require(a0_0x66eca8(0x21e)),deadMan=require(a0_0x66eca8(0x1a5)),automation=require(a0_0x66eca8(0x277)),GEMINI_MODEL='models/gemini-flash-latest';class CogniLiving extends utils[a0_0x66eca8(0x29a)]{constructor(_0x124e1a){const _0x1974f2=a0_0x66eca8;super({..._0x124e1a,'name':'cogni-living'}),this[_0x1974f2(0x289)]=[],this[_0x1974f2(0x17f)]=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x1974f2(0x224)]={},this[_0x1974f2(0x191)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x1974f2(0x28a)]=!![],this[_0x1974f2(0x2c7)]=null,this[_0x1974f2(0x1b3)]=null,this[_0x1974f2(0x2b7)]=![],this[_0x1974f2(0x179)]=null,this[_0x1974f2(0x2c9)]=null,this[_0x1974f2(0x1b7)]=setup[_0x1974f2(0x192)][_0x1974f2(0x2b6)],this[_0x1974f2(0x198)]=![],this[_0x1974f2(0x190)]=![],this[_0x1974f2(0x1b1)]=null,this[_0x1974f2(0x209)]=null,this[_0x1974f2(0x1b2)]=null,this[_0x1974f2(0x257)]=null,this[_0x1974f2(0x1a8)]=null,this[_0x1974f2(0x1fe)]=null,this['briefingJob']=null,this[_0x1974f2(0x1bd)]=null,this[_0x1974f2(0x19a)]=null,this[_0x1974f2(0x1e8)]=null,this[_0x1974f2(0x16d)]=null,this[_0x1974f2(0x2b1)]=![],this[_0x1974f2(0x2c6)]=Date[_0x1974f2(0x29f)](),this[_0x1974f2(0x219)]=null,this[_0x1974f2(0x1c1)]=Date[_0x1974f2(0x29f)](),this[_0x1974f2(0x22d)]=![],this['pressureBuffer']=[],this['activeModules']={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on']('ready',this[_0x1974f2(0x203)][_0x1974f2(0x1e1)](this)),this['on'](_0x1974f2(0x15c),this['onStateChange'][_0x1974f2(0x1e1)](this)),this['on']('unload',this[_0x1974f2(0x270)]['bind'](this)),this['on'](_0x1974f2(0x273),this[_0x1974f2(0x1fd)][_0x1974f2(0x1e1)](this));}async[a0_0x66eca8(0x203)](){const _0xb3a75c=a0_0x66eca8;this['log']['info'](_0xb3a75c(0x21f)+this['version']+')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)');if(this['config']['moduleHealth']!==undefined)this['activeModules'][_0xb3a75c(0x1ac)]=this[_0xb3a75c(0x2a3)][_0xb3a75c(0x1d4)];if(this['config'][_0xb3a75c(0x1e6)]!==undefined)this[_0xb3a75c(0x18b)][_0xb3a75c(0x1b0)]=this[_0xb3a75c(0x2a3)][_0xb3a75c(0x1e6)];if(this[_0xb3a75c(0x2a3)][_0xb3a75c(0x1dc)]!==undefined)this[_0xb3a75c(0x18b)][_0xb3a75c(0x279)]=this[_0xb3a75c(0x2a3)][_0xb3a75c(0x1dc)];if(this[_0xb3a75c(0x2a3)][_0xb3a75c(0x18a)]!==undefined)this[_0xb3a75c(0x18b)][_0xb3a75c(0x235)]=this[_0xb3a75c(0x2a3)][_0xb3a75c(0x18a)];if(this[_0xb3a75c(0x2a3)][_0xb3a75c(0x19c)])this[_0xb3a75c(0x18b)]={...this[_0xb3a75c(0x18b)],...this[_0xb3a75c(0x2a3)][_0xb3a75c(0x19c)]};this['startSystem']();}async[a0_0x66eca8(0x1b6)](){const _0xe88d2f=a0_0x66eca8;await setup[_0xe88d2f(0x176)](this);try{this['isProVersion']=await setup[_0xe88d2f(0x1bb)](this[_0xe88d2f(0x2a3)][_0xe88d2f(0x16b)]);}catch(_0x5827a2){}if(!this[_0xe88d2f(0x2a3)][_0xe88d2f(0x1fa)]||this['config'][_0xe88d2f(0x1fa)]<0.1)this[_0xe88d2f(0x2a3)][_0xe88d2f(0x1fa)]=0xc;await setup[_0xe88d2f(0x2b9)](this),await setup[_0xe88d2f(0x29b)](this);try{const _0x19154a=await this['getStateAsync'](_0xe88d2f(0x23e)),_0x211ac5=await this['getStateAsync']('analysis.energy.warmupSources');_0x19154a&&_0x19154a[_0xe88d2f(0x1b9)]&&_0x211ac5&&_0x211ac5['val']&&(Date[_0xe88d2f(0x29f)]()-_0x19154a['ts']<0x4*0xe10*0x3e8&&(this[_0xe88d2f(0x219)]={'times':JSON[_0xe88d2f(0x1b8)](_0x19154a[_0xe88d2f(0x1b9)]),'sources':JSON[_0xe88d2f(0x1b8)](_0x211ac5[_0xe88d2f(0x1b9)])}));}catch(_0x2e7b01){}if(this[_0xe88d2f(0x2a3)][_0xe88d2f(0x226)])try{this['genAI']=new GoogleGenerativeAI(this['config'][_0xe88d2f(0x226)]),this[_0xe88d2f(0x2c9)]=this['genAI'][_0xe88d2f(0x214)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xe88d2f(0x169)}});}catch(_0x5c72cb){this[_0xe88d2f(0x1a3)][_0xe88d2f(0x2a5)](_0xe88d2f(0x15d)+_0x5c72cb[_0xe88d2f(0x273)]);}await setup['createAllObjects'](this),await this[_0xe88d2f(0x212)](),schedulers['initSchedules'](this),await this[_0xe88d2f(0x1da)](_0xe88d2f(0x20b),{'type':_0xe88d2f(0x173),'common':{'name':'Live\x20Event\x20Pulse','type':_0xe88d2f(0x294),'role':'value','read':!![],'write':![]},'native':{}}),await this[_0xe88d2f(0x1da)](_0xe88d2f(0x244),{'type':_0xe88d2f(0x173),'common':{'name':'Room\x20Dwell\x20Time\x20Stats','type':'string','role':_0xe88d2f(0x164),'read':!![],'write':![],'def':_0xe88d2f(0x253)},'native':{}}),await this[_0xe88d2f(0x1da)](_0xe88d2f(0x261),{'type':_0xe88d2f(0x173),'common':{'name':'Room\x20History\x20(24h\x20Buckets)','type':'string','role':_0xe88d2f(0x164),'read':!![],'write':![],'def':_0xe88d2f(0x27f)},'native':{}}),await this[_0xe88d2f(0x1da)](_0xe88d2f(0x236),{'type':_0xe88d2f(0x173),'common':{'name':_0xe88d2f(0x18e),'type':_0xe88d2f(0x16c),'role':_0xe88d2f(0x237),'read':!![],'write':![],'def':_0xe88d2f(0x24e)},'native':{}}),await this['setObjectNotExistsAsync']('analysis.health.geminiDay',{'type':'state','common':{'name':_0xe88d2f(0x29d),'type':'string','role':_0xe88d2f(0x237),'read':!![],'write':![],'def':_0xe88d2f(0x24e)},'native':{}}),await this[_0xe88d2f(0x1da)](_0xe88d2f(0x246),{'type':_0xe88d2f(0x173),'common':{'name':_0xe88d2f(0x276),'type':_0xe88d2f(0x16c),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0xe88d2f(0x1da)](_0xe88d2f(0x264),{'type':_0xe88d2f(0x173),'common':{'name':'Daily\x20Room\x20Details\x20(48x30min)','type':_0xe88d2f(0x16c),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0xe88d2f(0x1da)]('analysis.health.activityTrend',{'type':_0xe88d2f(0x173),'common':{'name':'General\x20Activity\x20Trend','type':'number','role':_0xe88d2f(0x1ca),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0xe88d2f(0x1da)](_0xe88d2f(0x23e),{'type':'state','common':{'name':_0xe88d2f(0x15e),'type':'string','role':'json','read':!![],'write':![]},'native':{}});try{const _0x4063bc=await this[_0xe88d2f(0x2b3)]('events.history');if(_0x4063bc&&_0x4063bc[_0xe88d2f(0x1b9)]){this[_0xe88d2f(0x289)]=JSON[_0xe88d2f(0x1b8)](_0x4063bc[_0xe88d2f(0x1b9)]);if(this['isProVersion']){const _0x22a90e=await this[_0xe88d2f(0x2b3)]('LTM.rawEventLog');if(_0x22a90e&&_0x22a90e[_0xe88d2f(0x1b9)])this[_0xe88d2f(0x296)]=JSON[_0xe88d2f(0x1b8)](_0x22a90e[_0xe88d2f(0x1b9)]);}this[_0xe88d2f(0x1a3)][_0xe88d2f(0x2b4)](_0xe88d2f(0x16a)+this[_0xe88d2f(0x289)]['length']+_0xe88d2f(0x220));}}catch(_0x5eddea){this['eventHistory']=[];}try{const _0x2a022e=await this[_0xe88d2f(0x2b3)](_0xe88d2f(0x1f1));if(_0x2a022e&&_0x2a022e[_0xe88d2f(0x1b9)])this['dailyDigests']=JSON[_0xe88d2f(0x1b8)](_0x2a022e[_0xe88d2f(0x1b9)]);}catch(_0x307e36){this[_0xe88d2f(0x23d)]=[];}const _0x43f36b=this['dailyDigests'][_0xe88d2f(0x23f)]>=(this[_0xe88d2f(0x2a3)][_0xe88d2f(0x222)]||0x7)?_0xe88d2f(0x2bc)+this[_0xe88d2f(0x23d)][_0xe88d2f(0x23f)]+'\x20Tage)':_0xe88d2f(0x162)+this['dailyDigests'][_0xe88d2f(0x23f)]+'/'+(this[_0xe88d2f(0x2a3)][_0xe88d2f(0x222)]||0x7)+')';await this[_0xe88d2f(0x193)](_0xe88d2f(0x292),{'val':_0x43f36b,'ack':!![]}),this['subscribeStates'](_0xe88d2f(0x2c5)),this[_0xe88d2f(0x25d)](_0xe88d2f(0x281)),this['subscribeStates'](_0xe88d2f(0x189));this[_0xe88d2f(0x2a3)][_0xe88d2f(0x1bf)]&&this['config']['infrasoundSensorId']&&this['activeModules'][_0xe88d2f(0x1b0)]&&this['subscribeForeignStates'](this[_0xe88d2f(0x2a3)][_0xe88d2f(0x2a8)]);const _0x17f252=this[_0xe88d2f(0x2a3)][_0xe88d2f(0x22c)];if(_0x17f252)for(const _0xb8347a of _0x17f252){await this['subscribeForeignStatesAsync'](_0xb8347a['id']);}const _0x16489c=this[_0xe88d2f(0x2a3)][_0xe88d2f(0x20e)];if(_0x16489c)for(const _0x5719d2 of _0x16489c){await this[_0xe88d2f(0x24b)](_0x5719d2);}const _0x71354e=require('node-schedule');if(this[_0xe88d2f(0x1bd)])this[_0xe88d2f(0x1bd)][_0xe88d2f(0x202)]();this[_0xe88d2f(0x1bd)]=_0x71354e[_0xe88d2f(0x182)]('59\x2023\x20*\x20*\x20*',()=>{const _0x31d8e9=_0xe88d2f;this[_0x31d8e9(0x1d8)]();}),setTimeout(()=>this[_0xe88d2f(0x240)](),0x1388);if(this['roomIntegratorTimer'])clearInterval(this[_0xe88d2f(0x16d)]);this[_0xe88d2f(0x24d)](),this[_0xe88d2f(0x16d)]=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this[_0xe88d2f(0x1e8)])clearInterval(this[_0xe88d2f(0x1e8)]);this[_0xe88d2f(0x1e8)]=setInterval(()=>{const _0x4d7a60=_0xe88d2f;this['isProVersion']&&this[_0x4d7a60(0x18b)][_0x4d7a60(0x1ac)]&&this[_0x4d7a60(0x231)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0xe88d2f(0x1b1)])clearInterval(this[_0xe88d2f(0x1b1)]);this['activeModules'][_0xe88d2f(0x279)]&&(this[_0xe88d2f(0x1b1)]=setInterval(()=>{const _0x9722fa=_0xe88d2f;this[_0x9722fa(0x22e)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0xe88d2f(0x22e)](),0x2710));if(this[_0xe88d2f(0x209)])clearInterval(this['calendarCheckTimer']);this[_0xe88d2f(0x2a3)][_0xe88d2f(0x188)]&&this['activeModules']['energy']&&(this[_0xe88d2f(0x209)]=setInterval(()=>{const _0x169bb6=_0xe88d2f;automation[_0x169bb6(0x167)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0xe88d2f(0x167)](this),0x3a98));if(this[_0xe88d2f(0x1b2)])clearInterval(this[_0xe88d2f(0x1b2)]);this[_0xe88d2f(0x2a3)][_0xe88d2f(0x20e)]&&this[_0xe88d2f(0x2a3)][_0xe88d2f(0x20e)][_0xe88d2f(0x23f)]>0x0&&(this[_0xe88d2f(0x1b2)]=setInterval(async()=>{const _0x452931=_0xe88d2f;await this[_0x452931(0x1a7)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0xe88d2f(0x1a7)](),0x1388));const _0x135526=path[_0xe88d2f(0x2a0)](__dirname,_0xe88d2f(0x2b5),_0xe88d2f(0x21c),_0xe88d2f(0x1ec));pythonBridge[_0xe88d2f(0x21d)](this,_0x135526);}['onUnload'](_0x2e3e95){const _0x58d687=a0_0x66eca8;if(this['historyJob'])this[_0x58d687(0x1bd)][_0x58d687(0x202)]();this[_0x58d687(0x1d8)]()[_0x58d687(0x1eb)](()=>{const _0x618c79=_0x58d687;if(this[_0x618c79(0x1b1)])clearInterval(this[_0x618c79(0x1b1)]);if(this[_0x618c79(0x209)])clearInterval(this[_0x618c79(0x209)]);if(this[_0x618c79(0x1b2)])clearInterval(this[_0x618c79(0x1b2)]);if(this[_0x618c79(0x16d)])clearInterval(this[_0x618c79(0x16d)]);recorder[_0x618c79(0x1ed)](this),pythonBridge['stopService'](this),_0x2e3e95();});}async[a0_0x66eca8(0x240)](){const _0x4825bb=a0_0x66eca8;if(!this[_0x4825bb(0x289)]||this['eventHistory'][_0x4825bb(0x23f)]===0x0){this[_0x4825bb(0x1a3)]['warn']('‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.');return;}this[_0x4825bb(0x1a3)][_0x4825bb(0x2b4)](_0x4825bb(0x2c3)+this['eventHistory']['length']+_0x4825bb(0x2c1));const _0x1467ee=new Date()['setHours'](0x0,0x0,0x0,0x0),_0x28d20e='analysis.activity.roomHistory';let _0x552347={'history':{},'date':new Date()[_0x4825bb(0x1a6)]()};const _0x5b1285=_0x4825bb(0x246),_0x3d3175=_0x4825bb(0x264);let _0x122a76=new Array(0x30)['fill'](0x0),_0x2b17c3=Array[_0x4825bb(0x187)]({'length':0x30},()=>[]);this[_0x4825bb(0x289)]['forEach'](_0xa9b30e=>{const _0x3550e9=_0x4825bb;if(_0xa9b30e[_0x3550e9(0x26c)]>=_0x1467ee){if(recorder[_0x3550e9(0x1ab)](_0xa9b30e['type'],_0xa9b30e['value'])){const _0x36e95f=new Date(_0xa9b30e[_0x3550e9(0x26c)]),_0x16b08a=_0x36e95f[_0x3550e9(0x1e5)]()*0x2+(_0x36e95f['getMinutes']()>=0x1e?0x1:0x0);if(_0x16b08a<0x30){_0x122a76[_0x16b08a]++;const _0x5a0f51=_0xa9b30e[_0x3550e9(0x201)]||_0xa9b30e['name']||'?';let _0x1709c3=_0x2b17c3[_0x16b08a];!_0x1709c3[_0x3550e9(0x1ae)](_0x5a0f51)&&_0x1709c3[_0x3550e9(0x1cb)](_0x5a0f51);}const _0x13a35d=_0x36e95f[_0x3550e9(0x1e5)]();let _0x8e0611=_0xa9b30e[_0x3550e9(0x201)]||_0x3550e9(0x1d5);const _0x18f627=(this[_0x3550e9(0x2a3)][_0x3550e9(0x22c)]||[])[_0x3550e9(0x1c3)](_0xefa665=>_0xefa665[_0x3550e9(0x201)]===_0x8e0611);if(_0x18f627)_0x8e0611=_0x18f627[_0x3550e9(0x201)];if(!_0x552347[_0x3550e9(0x271)][_0x8e0611])_0x552347[_0x3550e9(0x271)][_0x8e0611]=new Array(0x18)[_0x3550e9(0x17d)](0x0);if(_0x552347[_0x3550e9(0x271)][_0x8e0611][_0x13a35d]<0x3c)_0x552347['history'][_0x8e0611][_0x13a35d]++;}}});const _0xe9ee1e=await this[_0x4825bb(0x2b3)](_0x28d20e);(!_0xe9ee1e||!_0xe9ee1e[_0x4825bb(0x1b9)]||_0xe9ee1e[_0x4825bb(0x1b9)]==='{}'||_0xe9ee1e[_0x4825bb(0x1b9)][_0x4825bb(0x1ae)]('\x22history\x22:{}'))&&await this[_0x4825bb(0x193)](_0x28d20e,{'val':JSON['stringify'](_0x552347),'ack':!![]}),await this[_0x4825bb(0x193)](_0x5b1285,{'val':JSON[_0x4825bb(0x283)](_0x122a76),'ack':!![]}),await this[_0x4825bb(0x193)](_0x3d3175,{'val':JSON['stringify'](_0x2b17c3),'ack':!![]}),this[_0x4825bb(0x1a3)][_0x4825bb(0x2b4)]('‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.');}async['saveDailyHistory'](){const _0x24e2ad=a0_0x66eca8;if(!this[_0x24e2ad(0x18b)][_0x24e2ad(0x1ac)])return;const _0x1838ab=new Date()['toISOString']()['split']('T')[0x0];this[_0x24e2ad(0x1a3)][_0x24e2ad(0x184)](_0x24e2ad(0x207)+_0x1838ab+'...');try{const [_0x3c03fd,_0x1cf2b8,_0x4cb9f2,_0x4792b8,_0x2d141d,_0x390eff]=await Promise[_0x24e2ad(0x215)]([this[_0x24e2ad(0x2b3)](_0x24e2ad(0x261)),this[_0x24e2ad(0x2b3)]('analysis.health.geminiNight'),this['getStateAsync']('analysis.health.geminiDay'),this[_0x24e2ad(0x2b3)](_0x24e2ad(0x27d)),this[_0x24e2ad(0x2b3)]('analysis.health.todayVector'),this['getStateAsync'](_0x24e2ad(0x1e9))]),_0x5e8514=this['eventHistory'][_0x24e2ad(0x1f2)](_0x437d85=>_0x437d85['timestamp']>=new Date()[_0x24e2ad(0x1a1)](0x0,0x0,0x0,0x0)&&(_0x437d85[_0x24e2ad(0x27b)][_0x24e2ad(0x225)]()[_0x24e2ad(0x1ae)]('haust√ºr')||_0x437d85[_0x24e2ad(0x27b)]['toLowerCase']()[_0x24e2ad(0x1ae)](_0x24e2ad(0x16f)))&&(_0x437d85[_0x24e2ad(0x1ca)]===!![]||_0x437d85[_0x24e2ad(0x1ca)]===_0x24e2ad(0x265)))[_0x24e2ad(0x23f)];let _0x37a4a4=0x55;if(_0x390eff&&_0x390eff['val']!==undefined)_0x37a4a4=Math[_0x24e2ad(0x172)](0x64,Math[_0x24e2ad(0x1cd)](0x14,Math['round'](0x50+Number(_0x390eff[_0x24e2ad(0x1b9)])*0x5)));const _0x1e489e={'date':_0x1838ab,'timestamp':Date[_0x24e2ad(0x29f)](),'roomHistory':_0x3c03fd?.[_0x24e2ad(0x1b9)]?JSON[_0x24e2ad(0x1b8)](_0x3c03fd[_0x24e2ad(0x1b9)]):{},'geminiNight':_0x1cf2b8?.[_0x24e2ad(0x1b9)]||_0x24e2ad(0x27a),'geminiDay':_0x4cb9f2?.['val']||_0x24e2ad(0x27a),'anomalyScore':_0x4792b8?.['val']||0.1,'todayVector':_0x2d141d?.[_0x24e2ad(0x1b9)]?JSON[_0x24e2ad(0x1b8)](_0x2d141d[_0x24e2ad(0x1b9)]):new Array(0x30)[_0x24e2ad(0x17d)](0x0),'batteryLevel':_0x37a4a4,'freshAirCount':_0x5e8514,'eventHistory':this[_0x24e2ad(0x289)]},_0xc6a654=utils[_0x24e2ad(0x248)](),_0x4e9d3b=path[_0x24e2ad(0x2a0)](_0xc6a654,_0x24e2ad(0x238),_0x24e2ad(0x271));if(!fs[_0x24e2ad(0x1aa)](_0x4e9d3b))fs[_0x24e2ad(0x293)](_0x4e9d3b,{'recursive':!![]});const _0x517b18=path[_0x24e2ad(0x2a0)](_0x4e9d3b,_0x1838ab+_0x24e2ad(0x1c6));fs[_0x24e2ad(0x28c)](_0x517b18,JSON['stringify'](_0x1e489e)),this['log']['info'](_0x24e2ad(0x17e)+_0x517b18);}catch(_0x30195c){this[_0x24e2ad(0x1a3)][_0x24e2ad(0x2a5)](_0x24e2ad(0x1c5)+_0x30195c[_0x24e2ad(0x273)]);}}async[a0_0x66eca8(0x24d)](){const _0x107ec0=a0_0x66eca8;if(!this[_0x107ec0(0x28a)])return;try{let _0x325b8c=null;try{const _0x207dd7=await this['getStateAsync'](_0x107ec0(0x230)),_0x1dccd6=await this[_0x107ec0(0x2b3)](_0x107ec0(0x213));if(_0x207dd7&&_0x207dd7[_0x107ec0(0x1b9)]&&_0x1dccd6&&_0x1dccd6[_0x107ec0(0x1b9)]&&_0x1dccd6[_0x107ec0(0x1b9)]>0.3){if(_0x207dd7['val']!==_0x107ec0(0x1d5)&&_0x207dd7[_0x107ec0(0x1b9)]!==_0x107ec0(0x1de))_0x325b8c=_0x207dd7[_0x107ec0(0x1b9)];}}catch(_0x37b08b){}if(!_0x325b8c){const _0x2f0115=this['config'][_0x107ec0(0x22c)]||[];for(const _0x278497 of _0x2f0115){if(_0x278497[_0x107ec0(0x299)]===_0x107ec0(0x2c0)&&_0x278497[_0x107ec0(0x201)])try{const _0x27b090=await this[_0x107ec0(0x1fb)](_0x278497['id']);if(_0x27b090&&(_0x27b090[_0x107ec0(0x1b9)]===!![]||_0x27b090['val']==='on'||_0x27b090[_0x107ec0(0x1b9)]===0x1)){_0x325b8c=_0x278497[_0x107ec0(0x201)];break;}}catch(_0x296bfb){}}}if(!_0x325b8c)return;const _0x2b5da3=this[_0x107ec0(0x2a3)]['devices']||[];let _0x188684=_0x325b8c;const _0x2bdf40=_0x2b5da3[_0x107ec0(0x1c3)](_0x1bc122=>_0x1bc122['location']&&_0x1bc122[_0x107ec0(0x201)][_0x107ec0(0x225)]()===_0x325b8c[_0x107ec0(0x225)]());if(_0x2bdf40)_0x188684=_0x2bdf40['location'];const _0x4019f5='analysis.activity.roomHistory',_0x5283a1=await this[_0x107ec0(0x2b3)](_0x4019f5),_0xf41f18=new Date()[_0x107ec0(0x1a6)]();let _0x3183bc={'history':{},'date':_0xf41f18};if(_0x5283a1&&_0x5283a1[_0x107ec0(0x1b9)])try{_0x3183bc=JSON[_0x107ec0(0x1b8)](_0x5283a1['val']);}catch(_0x32e105){}_0x3183bc[_0x107ec0(0x21b)]!==_0xf41f18&&(_0x3183bc[_0x107ec0(0x271)]={},_0x3183bc[_0x107ec0(0x21b)]=_0xf41f18);if(!_0x3183bc[_0x107ec0(0x271)][_0x188684])_0x3183bc[_0x107ec0(0x271)][_0x188684]=new Array(0x18)[_0x107ec0(0x17d)](0x0);const _0x40be78=new Date()[_0x107ec0(0x1e5)]();if(_0x3183bc[_0x107ec0(0x271)][_0x188684][_0x40be78]<0x3c)_0x3183bc[_0x107ec0(0x271)][_0x188684][_0x40be78]++;await this[_0x107ec0(0x193)](_0x4019f5,{'val':JSON[_0x107ec0(0x283)](_0x3183bc),'ack':!![]});}catch(_0x541dda){this[_0x107ec0(0x1a3)][_0x107ec0(0x2a9)](_0x107ec0(0x2c2)+_0x541dda[_0x107ec0(0x273)]);}}async[a0_0x66eca8(0x1fd)](_0x57df8d){const _0x53b35e=a0_0x66eca8;if(typeof _0x57df8d===_0x53b35e(0x23b)&&_0x57df8d[_0x53b35e(0x273)]){if(_0x57df8d[_0x53b35e(0x287)]===_0x53b35e(0x1fc)){const _0x1e3c25=_0x57df8d[_0x53b35e(0x273)][_0x53b35e(0x21b)],_0x122371=utils['getAbsoluteDefaultDataDir'](),_0x2d4319=path[_0x53b35e(0x2a0)](_0x122371,_0x53b35e(0x238),_0x53b35e(0x271),_0x1e3c25+_0x53b35e(0x1c6));if(fs['existsSync'](_0x2d4319))try{const _0x21cbca=JSON[_0x53b35e(0x1b8)](fs[_0x53b35e(0x267)](_0x2d4319,'utf8'));this['sendTo'](_0x57df8d['from'],_0x57df8d[_0x53b35e(0x287)],{'success':!![],'data':_0x21cbca},_0x57df8d[_0x53b35e(0x20d)]);}catch(_0x4541b9){this[_0x53b35e(0x26d)](_0x57df8d['from'],_0x57df8d[_0x53b35e(0x287)],{'success':![],'error':_0x53b35e(0x174)},_0x57df8d[_0x53b35e(0x20d)]);}else this[_0x53b35e(0x26d)](_0x57df8d[_0x53b35e(0x187)],_0x57df8d['command'],{'success':![],'error':_0x53b35e(0x199)},_0x57df8d[_0x53b35e(0x20d)]);}else{if(_0x57df8d[_0x53b35e(0x287)]===_0x53b35e(0x1c7)){const _0x74e143=this['dailyDigests']['length'];let _0xd6ce4e=new Array(0x30)['fill'](0x0),_0x3bd5fd=Array[_0x53b35e(0x187)]({'length':0x30},()=>[]);try{const _0x37c973=await this[_0x53b35e(0x2b3)]('analysis.health.todayVector');if(_0x37c973&&_0x37c973[_0x53b35e(0x1b9)])_0xd6ce4e=JSON[_0x53b35e(0x1b8)](_0x37c973[_0x53b35e(0x1b9)]);const _0xd3eb86=await this[_0x53b35e(0x2b3)](_0x53b35e(0x264));if(_0xd3eb86&&_0xd3eb86['val'])_0x3bd5fd=JSON[_0x53b35e(0x1b8)](_0xd3eb86[_0x53b35e(0x1b9)]);}catch(_0x5d3e8c){}let _0x55af24=new Array(0x30)[_0x53b35e(0x17d)](0x0);try{const _0x54a96e=new Date();_0x54a96e[_0x53b35e(0x285)](_0x54a96e[_0x53b35e(0x16e)]()-0x1);const _0x3d772a=_0x54a96e['toISOString']()['split']('T')[0x0],_0x523b0d=utils[_0x53b35e(0x248)](),_0x6c4569=path[_0x53b35e(0x2a0)](_0x523b0d,_0x53b35e(0x238),_0x53b35e(0x271),_0x3d772a+_0x53b35e(0x1c6));if(fs['existsSync'](_0x6c4569)){const _0x50bdb6=JSON[_0x53b35e(0x1b8)](fs[_0x53b35e(0x267)](_0x6c4569,_0x53b35e(0x2c4)));if(_0x50bdb6&&_0x50bdb6[_0x53b35e(0x186)])_0x55af24=_0x50bdb6['todayVector'];}}catch(_0x43c69f){}let _0x5dbf08={'today':{},'yesterday':{}};try{const _0x3e7b9a=await this[_0x53b35e(0x2b3)](_0x53b35e(0x244));if(_0x3e7b9a&&_0x3e7b9a['val'])_0x5dbf08=JSON[_0x53b35e(0x1b8)](_0x3e7b9a[_0x53b35e(0x1b9)]);}catch(_0x1d5b05){}let _0x29a51a=null;try{const _0x4b76fe=await this[_0x53b35e(0x2b3)](_0x53b35e(0x1e9));if(_0x4b76fe)_0x29a51a=_0x4b76fe[_0x53b35e(0x1b9)];}catch(_0xabada8){}if(_0x29a51a===undefined||_0x29a51a===null){const _0x2935eb=_0xd6ce4e[_0x53b35e(0x259)]((_0x13fe80,_0x422a4e)=>_0x13fe80+_0x422a4e,0x0),_0x1fc121=Math[_0x53b35e(0x172)](0x2,Math['max'](-0x2,(0x64-_0x2935eb)/0x32));_0x29a51a=_0x1fc121;}let _0x41a695=![],_0x16c58c='',_0x5d335c='',_0x5a1307='';try{const _0x249023=await this[_0x53b35e(0x2b3)](_0x53b35e(0x20c));if(_0x249023&&_0x249023[_0x53b35e(0x1b9)]){_0x41a695=!![];const _0x5b1d78=await this[_0x53b35e(0x2b3)](_0x53b35e(0x245));_0x16c58c=_0x5b1d78?_0x5b1d78[_0x53b35e(0x1b9)]:'';const _0x27cd95=await this['getStateAsync'](_0x53b35e(0x24f));_0x5d335c=_0x27cd95?_0x27cd95['val']:'';const _0x2f7ab5=await this[_0x53b35e(0x2b3)]('analysis.automation.targetValue');_0x5a1307=_0x2f7ab5?_0x2f7ab5[_0x53b35e(0x1b9)]:'';}}catch(_0x568373){}const _0x507b4c=await this[_0x53b35e(0x25f)](),_0x45e987=(this[_0x53b35e(0x2a3)][_0x53b35e(0x22c)]||[])[_0x53b35e(0x1df)](_0x1fb0f8=>_0x1fb0f8[_0x53b35e(0x291)]),_0x2f4bd3=_0x507b4c&&_0x45e987;let _0x50b05f='';try{const _0x44496e=await this[_0x53b35e(0x2b3)](_0x53b35e(0x20a));if(_0x44496e&&_0x44496e[_0x53b35e(0x1b9)])_0x50b05f=_0x44496e[_0x53b35e(0x1b9)];}catch(_0x4b61d3){}this['sendTo'](_0x57df8d[_0x53b35e(0x187)],_0x57df8d['command'],{'success':!![],'eventHistory':this['eventHistory'][_0x53b35e(0x297)](0x0,0x7d0),'stats':{'digestCount':_0x74e143,'isPresent':this[_0x53b35e(0x28a)],'hourlyActivity':_0xd6ce4e,'hourlyDetails':_0x3bd5fd,'yesterdayActivity':_0x55af24,'solarActive':_0x2f4bd3,'presenceWho':_0x50b05f,'roomStats':_0x5dbf08,'activityTrend':_0x29a51a,'modules':this[_0x53b35e(0x18b)]},'automation':{'detected':_0x41a695,'description':_0x16c58c,'targetId':_0x5d335c,'targetValue':_0x5a1307}},_0x57df8d['callback']);}else{if(_0x57df8d[_0x53b35e(0x287)]==='checkThermostats')try{const _0x3721a2=await automation[_0x53b35e(0x256)](this);this[_0x53b35e(0x26d)](_0x57df8d['from'],_0x57df8d['command'],{'success':!![],'results':_0x3721a2},_0x57df8d[_0x53b35e(0x20d)]);}catch(_0x2a495a){this[_0x53b35e(0x26d)](_0x57df8d['from'],_0x57df8d[_0x53b35e(0x287)],{'success':![],'error':_0x2a495a[_0x53b35e(0x273)]},_0x57df8d[_0x53b35e(0x20d)]);}else{if(_0x57df8d[_0x53b35e(0x287)]===_0x53b35e(0x216))try{const _0x4f15c9=await scanner[_0x53b35e(0x26b)](this,_0x57df8d['message']||{});this[_0x53b35e(0x26d)](_0x57df8d['from'],_0x57df8d[_0x53b35e(0x287)],{'success':!![],'devices':_0x4f15c9},_0x57df8d[_0x53b35e(0x20d)]);}catch(_0xf6a571){}else{if(_0x57df8d['command']==='getEnums'){const _0x367374=await this[_0x53b35e(0x26f)](_0x53b35e(0x260),_0x53b35e(0x2a6)),_0x59a5e0=[];if(_0x367374)for(const _0x25339c in _0x367374){let _0x354668=_0x367374[_0x25339c][_0x53b35e(0x19e)][_0x53b35e(0x27b)];if(_0x354668&&typeof _0x354668===_0x53b35e(0x23b))_0x354668=_0x354668['de']||_0x354668['en']||Object[_0x53b35e(0x2b2)](_0x354668)[0x0]||JSON[_0x53b35e(0x283)](_0x354668);_0x59a5e0['push']({'id':_0x25339c,'name':String(_0x354668||_0x25339c)});}const _0x4c5ea9=await this[_0x53b35e(0x26f)](_0x53b35e(0x163),'enum'),_0x1f468e=[];if(_0x4c5ea9)for(const _0x1fa704 in _0x4c5ea9){let _0x9eaffc=_0x4c5ea9[_0x1fa704][_0x53b35e(0x19e)][_0x53b35e(0x27b)];if(_0x9eaffc&&typeof _0x9eaffc===_0x53b35e(0x23b))_0x9eaffc=_0x9eaffc['de']||_0x9eaffc['en']||Object[_0x53b35e(0x2b2)](_0x9eaffc)[0x0]||JSON[_0x53b35e(0x283)](_0x9eaffc);_0x1f468e[_0x53b35e(0x1cb)](String(_0x9eaffc||_0x1fa704[_0x53b35e(0x2ab)]('.')[_0x53b35e(0x1b4)]()));}this[_0x53b35e(0x26d)](_0x57df8d[_0x53b35e(0x187)],_0x57df8d[_0x53b35e(0x287)],{'success':!![],'enums':_0x59a5e0,'rooms':_0x1f468e},_0x57df8d[_0x53b35e(0x20d)]);}else{if(_0x57df8d['command']===_0x53b35e(0x28b))try{const _0x3f51cf=await this[_0x53b35e(0x298)](_0x53b35e(0x24c),_0x53b35e(0x1c9),{'startkey':'system.adapter.ical.','endkey':_0x53b35e(0x262)}),_0x2e2366=new Set();if(_0x3f51cf&&_0x3f51cf[_0x53b35e(0x232)])for(const _0x26efe1 of _0x3f51cf[_0x53b35e(0x232)]){const _0x2c75b0=_0x26efe1['id'][_0x53b35e(0x250)]('system.adapter.',''),_0x123a17=await this[_0x53b35e(0x1fb)](_0x2c75b0+_0x53b35e(0x1be));let _0x4af608=![];if(_0x123a17&&_0x123a17[_0x53b35e(0x1b9)]){const _0x4db1d7=typeof _0x123a17[_0x53b35e(0x1b9)]===_0x53b35e(0x16c)?JSON[_0x53b35e(0x1b8)](_0x123a17['val']):_0x123a17[_0x53b35e(0x1b9)];Array[_0x53b35e(0x1f9)](_0x4db1d7)&&_0x4db1d7['forEach'](_0x168df3=>{const _0x2f09f1=_0x53b35e;_0x168df3[_0x2f09f1(0x266)]&&(_0x2e2366[_0x2f09f1(0x2ba)](_0x168df3[_0x2f09f1(0x266)]),_0x4af608=!![]);});}!_0x4af608&&_0x2e2366[_0x53b35e(0x2ba)](_0x2c75b0);}const _0x52c271=Array['from'](_0x2e2366);if(_0x52c271[_0x53b35e(0x23f)]===0x0)_0x52c271[_0x53b35e(0x1cb)]('Standard');this[_0x53b35e(0x26d)](_0x57df8d['from'],_0x57df8d[_0x53b35e(0x287)],{'success':!![],'names':_0x52c271},_0x57df8d[_0x53b35e(0x20d)]);}catch(_0x3a2557){this[_0x53b35e(0x26d)](_0x57df8d[_0x53b35e(0x187)],_0x57df8d['command'],{'success':![],'error':'Scan\x20Error:\x20'+_0x3a2557[_0x53b35e(0x273)]},_0x57df8d[_0x53b35e(0x20d)]);}else{if(_0x57df8d[_0x53b35e(0x287)]==='refreshCalendar')try{await automation[_0x53b35e(0x197)](this),this[_0x53b35e(0x26d)](_0x57df8d[_0x53b35e(0x187)],_0x57df8d[_0x53b35e(0x287)],{'success':!![]},_0x57df8d[_0x53b35e(0x20d)]);}catch(_0x508d57){this['log']['warn']('refreshCalendar\x20failed:\x20'+_0x508d57[_0x53b35e(0x273)]),this[_0x53b35e(0x26d)](_0x57df8d[_0x53b35e(0x187)],_0x57df8d[_0x53b35e(0x287)],{'success':![],'error':_0x508d57[_0x53b35e(0x273)]},_0x57df8d[_0x53b35e(0x20d)]);}else{if(_0x57df8d[_0x53b35e(0x287)]===_0x53b35e(0x241))try{const _0x2d6b87=_0x57df8d['message']?_0x57df8d[_0x53b35e(0x273)][_0x53b35e(0x2c8)]:'';if(!_0x2d6b87)throw new Error(_0x53b35e(0x2a4));const _0x11ea8d=new GoogleGenerativeAI(_0x2d6b87),_0x30a8ba=_0x11ea8d['getGenerativeModel']({'model':GEMINI_MODEL}),_0x49be9b=await _0x30a8ba[_0x53b35e(0x229)]('Say\x20Hello'),_0x240d89=await _0x49be9b[_0x53b35e(0x180)],_0xbced04=_0x240d89[_0x53b35e(0x237)]();this[_0x53b35e(0x26d)](_0x57df8d['from'],_0x57df8d[_0x53b35e(0x287)],{'success':!![],'message':_0x53b35e(0x17c)+_0xbced04['substring'](0x0,0x14)+'...'},_0x57df8d[_0x53b35e(0x20d)]);}catch(_0xbb82e1){this['sendTo'](_0x57df8d[_0x53b35e(0x187)],_0x57df8d[_0x53b35e(0x287)],{'success':![],'message':_0xbb82e1[_0x53b35e(0x273)]},_0x57df8d['callback']);}else{if(_0x57df8d[_0x53b35e(0x287)]==='testContext')try{const _0x5609bc=await this['checkSolarCondition'](),_0x40f584=await this['getObjectViewAsync'](_0x53b35e(0x24c),_0x53b35e(0x1c9),{'startkey':_0x53b35e(0x2a1),'endkey':'system.adapter.ical.È¶ô'}),_0x17b0fe=_0x40f584&&_0x40f584[_0x53b35e(0x232)]?_0x40f584[_0x53b35e(0x232)][_0x53b35e(0x23f)]:0x0;this['sendTo'](_0x57df8d[_0x53b35e(0x187)],_0x57df8d[_0x53b35e(0x287)],{'success':!![],'weather':_0x53b35e(0x26e)+_0x5609bc+_0x53b35e(0x278)+(this[_0x53b35e(0x224)][this[_0x53b35e(0x2a3)][_0x53b35e(0x251)]]||'?')+'¬∞C','calendar':_0x17b0fe+'\x20Kalender-Adapter\x20gefunden.'},_0x57df8d[_0x53b35e(0x20d)]);}catch(_0x2f493a){this[_0x53b35e(0x26d)](_0x57df8d['from'],_0x57df8d['command'],{'success':![]},_0x57df8d[_0x53b35e(0x20d)]);}}}}}}}}}}}[a0_0x66eca8(0x231)](){const _0x4a3331=a0_0x66eca8;if(!this['activeModules']['health'])return;this[_0x4a3331(0x1a3)][_0x4a3331(0x184)](_0x4a3331(0x274));try{const _0x56eed6=this['rawEventLog']||[];pythonBridge['send'](this,_0x4a3331(0x18f),{'events':_0x56eed6});}catch(_0x3e1c2d){this['log'][_0x4a3331(0x2a9)](_0x4a3331(0x255));}}async['onStateChange'](_0x4fea09,_0x7d38f6){const _0x402372=a0_0x66eca8;if(!_0x7d38f6||this['dependencyInstallInProgress'])return;if(_0x4fea09['includes']('telegram')&&_0x4fea09[_0x402372(0x1a4)]('communicate.request')&&_0x7d38f6['val'])return;if(this['config'][_0x402372(0x1bf)]&&_0x4fea09===this[_0x402372(0x2a3)][_0x402372(0x2a8)]&&this[_0x402372(0x18b)]['security']){this[_0x402372(0x234)](_0x7d38f6[_0x402372(0x1b9)]);return;}if(_0x7d38f6[_0x402372(0x1bc)]&&_0x4fea09[_0x402372(0x1a4)](_0x402372(0x1f0)))return;if(_0x4fea09===this[_0x402372(0x211)]+_0x402372(0x1d9)){if(_0x7d38f6[_0x402372(0x1b9)]&&Object[_0x402372(0x2b2)](setup[_0x402372(0x192)])['includes'](_0x7d38f6['val'])){this[_0x402372(0x1b7)]=_0x7d38f6[_0x402372(0x1b9)];if(_0x7d38f6[_0x402372(0x1b9)]===setup['SYSTEM_MODES'][_0x402372(0x195)])await recorder['setPresence'](this,![]);else await recorder[_0x402372(0x243)](this,!![]);if(this[_0x402372(0x198)]){let _0x2f13fd=![],_0x10b43e=0x0,_0x171229=_0x402372(0x22b);if(this[_0x402372(0x1b7)]===_0x402372(0x21a))_0x2f13fd=!![],_0x10b43e=0x168,_0x171229='Party\x20Mode';else this[_0x402372(0x1b7)]===_0x402372(0x23c)&&(_0x2f13fd=!![],_0x10b43e=0x5a0,_0x171229=_0x402372(0x27c));pythonBridge[_0x402372(0x1e0)](this,_0x402372(0x161),{'active':_0x2f13fd,'duration':_0x10b43e,'label':_0x171229}),await this[_0x402372(0x193)](_0x402372(0x1d2),{'val':JSON[_0x402372(0x283)]({'active':_0x2f13fd,'label':_0x171229,'timestamp':Date[_0x402372(0x29f)]()}),'ack':!![]});}}if(!_0x7d38f6[_0x402372(0x1bc)])this[_0x402372(0x17b)](_0x4fea09,{'val':this[_0x402372(0x1b7)],'ack':!![]});return;}if(_0x4fea09['endsWith']('analysis.energy.warmupSources')&&_0x7d38f6[_0x402372(0x1bc)])this['protectAiMemory'](_0x7d38f6[_0x402372(0x1b9)]);if(_0x4fea09[_0x402372(0x1a4)]('analysis.energy.warmupTimes')&&_0x7d38f6[_0x402372(0x1bc)]&&this[_0x402372(0x18b)]['energy'])automation[_0x402372(0x167)](this);if(!_0x7d38f6[_0x402372(0x1bc)]){if(_0x4fea09[_0x402372(0x1ae)](_0x402372(0x2c5))&&_0x7d38f6[_0x402372(0x1b9)]){this[_0x402372(0x17b)](_0x4fea09,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this);return;}if(_0x4fea09[_0x402372(0x1ae)](_0x402372(0x175))&&_0x7d38f6[_0x402372(0x1b9)]){this['setState'](_0x4fea09,{'val':![],'ack':!![]});if(this[_0x402372(0x198)])aiAgent[_0x402372(0x272)](this,pythonBridge);return;}if(_0x4fea09['includes'](_0x402372(0x181))&&_0x7d38f6['val']){this[_0x402372(0x17b)](_0x4fea09,{'val':![],'ack':!![]}),aiAgent[_0x402372(0x18c)](this);return;}if(_0x4fea09['includes'](_0x402372(0x2ae))&&_0x7d38f6[_0x402372(0x1b9)]){this[_0x402372(0x17b)](_0x4fea09,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x4fea09[_0x402372(0x1ae)](_0x402372(0x1d0))&&_0x7d38f6[_0x402372(0x1b9)]){this[_0x402372(0x17b)](_0x4fea09,{'val':![],'ack':!![]});if(this[_0x402372(0x198)])try{const _0x5ce92e=await this[_0x402372(0x2b3)]('LTM.trainingData.sequences');if(_0x5ce92e&&_0x5ce92e[_0x402372(0x1b9)]){const _0x963c0=JSON[_0x402372(0x1b8)](_0x5ce92e['val']);this[_0x402372(0x193)](_0x402372(0x288),{'val':_0x402372(0x1c8),'ack':!![]}),pythonBridge[_0x402372(0x1e0)](this,'TRAIN_SECURITY',{'sequences':_0x963c0});}}catch(_0x515674){}return;}if(_0x4fea09['includes']('analysis.training.triggerHealth')&&_0x7d38f6['val']){this['setState'](_0x4fea09,{'val':![],'ack':!![]});try{aiAgent[_0x402372(0x239)](this,_0x402372(0x286)),setTimeout(()=>aiAgent['generateHealthReport'](this,_0x402372(0x25b)),0x2ee0);if(this[_0x402372(0x198)]){this['runPythonHealthCheck']();const _0x16a777=await this[_0x402372(0x2b3)](_0x402372(0x1f1));if(_0x16a777&&_0x16a777['val'])pythonBridge['send'](this,_0x402372(0x2b0),{'digests':JSON['parse'](_0x16a777[_0x402372(0x1b9)])});}}catch(_0x1d868c){this['log'][_0x402372(0x2a9)](_0x402372(0x2af)+_0x1d868c[_0x402372(0x273)]);}return;}if(_0x4fea09[_0x402372(0x1ae)](_0x402372(0x269))&&_0x7d38f6['val']){this[_0x402372(0x17b)](_0x4fea09,{'val':![],'ack':!![]}),await this[_0x402372(0x22e)]();return;}if(_0x4fea09[_0x402372(0x1ae)](_0x402372(0x18d))&&_0x7d38f6[_0x402372(0x1b9)]){this['setState'](_0x4fea09,{'val':![],'ack':!![]});if(this[_0x402372(0x198)])try{const _0x8c1a32=await this[_0x402372(0x2b3)](_0x402372(0x1db));if(_0x8c1a32&&_0x8c1a32[_0x402372(0x1b9)]){const _0x158263={};if(this['config']['devices'])this[_0x402372(0x2a3)]['devices'][_0x402372(0x1f5)](_0x646d9d=>{const _0x4fa0ce=_0x402372;if(_0x646d9d['id']&&_0x646d9d[_0x4fa0ce(0x299)])_0x158263[_0x646d9d['id']]=_0x646d9d[_0x4fa0ce(0x299)];});pythonBridge[_0x402372(0x1e0)](this,'TRAIN_COMFORT',{'events':JSON[_0x402372(0x1b8)](_0x8c1a32[_0x402372(0x1b9)]),'deviceMap':_0x158263});}}catch(_0x4b3322){}return;}if(_0x4fea09['includes'](_0x402372(0x2ac))&&_0x7d38f6[_0x402372(0x1b9)]){this[_0x402372(0x17b)](_0x4fea09,{'val':![],'ack':!![]}),topology[_0x402372(0x2bb)](this);if(this[_0x402372(0x198)])try{const _0x1e3b33=await this['getStateAsync'](_0x402372(0x1b5));if(_0x1e3b33&&_0x1e3b33[_0x402372(0x1b9)])pythonBridge['send'](this,_0x402372(0x2a2),{'sequences':JSON[_0x402372(0x1b8)](_0x1e3b33[_0x402372(0x1b9)])});}catch(_0x1c7059){}return;}}const _0x2df54c=(this[_0x402372(0x2a3)][_0x402372(0x22c)]||[])['find'](_0x2ddfa7=>_0x2ddfa7['id']===_0x4fea09);if(_0x2df54c){const _0x368b17=await recorder[_0x402372(0x249)](this,_0x4fea09,_0x7d38f6,_0x2df54c);_0x368b17&&this[_0x402372(0x17b)](_0x402372(0x20b),{'val':Date[_0x402372(0x29f)](),'ack':!![]});_0x368b17&&_0x368b17['type']==='motion'&&_0x368b17[_0x402372(0x201)]&&this['isProVersion']&&deadMan[_0x402372(0x275)](this,_0x368b17['location']);_0x7d38f6[_0x402372(0x1b9)]&&(_0x7d38f6[_0x402372(0x1b9)]===!![]||_0x7d38f6['val']===0x1||String(_0x7d38f6[_0x402372(0x1b9)])[_0x402372(0x225)]()===_0x402372(0x265))&&(_0x2df54c[_0x402372(0x299)]&&(_0x2df54c[_0x402372(0x299)][_0x402372(0x1ae)](_0x402372(0x1d3))||_0x2df54c['type'][_0x402372(0x1ae)](_0x402372(0x268)))&&this[_0x402372(0x227)](_0x2df54c));if(_0x2df54c['type']===_0x402372(0x23a)||_0x2df54c[_0x402372(0x299)]==='thermostat'){if(this['activeModules'][_0x402372(0x279)])automation['cleanupGhostInterventions'](this);}}}async[a0_0x66eca8(0x1f4)](_0x3e0bff){const _0x4af238=a0_0x66eca8;if(!this[_0x4af238(0x219)]||Date[_0x4af238(0x29f)]()-this[_0x4af238(0x1c1)]>0x493e0)return;try{const _0x190cdb=JSON['parse'](_0x3e0bff),_0x562a3e=this[_0x4af238(0x219)][_0x4af238(0x165)];let _0x3dd291=![];for(const _0x542ab3 in _0x562a3e){if(_0x562a3e[_0x542ab3]['includes']('AI')&&_0x190cdb[_0x542ab3]&&!_0x190cdb[_0x542ab3][_0x4af238(0x1ae)]('AI')){_0x3dd291=!![];break;}}_0x3dd291&&(await this[_0x4af238(0x193)](_0x4af238(0x23e),{'val':JSON[_0x4af238(0x283)](this['memoryCache']['times']),'ack':!![]}),await this[_0x4af238(0x193)]('analysis.energy.warmupSources',{'val':JSON[_0x4af238(0x283)](this['memoryCache']['sources']),'ack':!![]}));}catch(_0x2cd720){}}async[a0_0x66eca8(0x212)](){const _0xd71daf=a0_0x66eca8;try{const _0x3d990a=await this['getStateAsync'](setup[_0xd71daf(0x2ad)]);if(_0x3d990a&&_0x3d990a['val'])this[_0xd71daf(0x1b7)]=_0x3d990a[_0xd71daf(0x1b9)];}catch(_0x108489){this[_0xd71daf(0x1b7)]=setup[_0xd71daf(0x192)][_0xd71daf(0x2b6)];}}async[a0_0x66eca8(0x1a7)](){const _0x1e6519=a0_0x66eca8,_0x513523=this[_0x1e6519(0x2a3)][_0x1e6519(0x20e)]||[];if(_0x513523['length']===0x0)return![];const _0x1a11fc=[],_0x532b39=Date['now'](),_0x1dc22a=0x5*0x3c*0x3e8;for(const _0x1f09f7 of _0x513523){try{let _0x180086=![];try{const _0x2c7d3a=await this[_0x1e6519(0x1fb)](_0x1f09f7+_0x1e6519(0x29e));if(_0x2c7d3a&&_0x2c7d3a['val']===!![])_0x180086=!![];}catch(_0x154558){}if(!_0x180086)try{const _0x551e44=await this[_0x1e6519(0x1fb)](_0x1f09f7+'.last_seen');if(_0x551e44&&_0x551e44['ts']){const _0x5801c8=_0x532b39-_0x551e44['ts'];if(_0x5801c8<_0x1dc22a)_0x180086=!![];}}catch(_0x391d44){}if(!_0x180086)try{const _0x64abc4=await this['getForeignStateAsync'](_0x1f09f7+_0x1e6519(0x177));if(_0x64abc4&&typeof _0x64abc4[_0x1e6519(0x1b9)]==='number'&&_0x64abc4[_0x1e6519(0x1b9)]>0x0)_0x180086=!![];}catch(_0x1fba15){}if(!_0x180086)try{const _0x23fb3e=await this[_0x1e6519(0x1fb)](_0x1f09f7);if(_0x23fb3e){const _0x1c7aa7=_0x532b39-(_0x23fb3e['ts']||0x0);_0x1c7aa7<_0x1dc22a&&(_0x23fb3e[_0x1e6519(0x1b9)]===!![]||_0x23fb3e['val']===_0x1e6519(0x263)||_0x23fb3e[_0x1e6519(0x1b9)]===0x1)&&(_0x180086=!![]);}}catch(_0x307947){}if(_0x180086){const _0x2815a1=_0x1f09f7[_0x1e6519(0x2ab)]('.'),_0x59f671=_0x2815a1[_0x2815a1[_0x1e6519(0x23f)]-0x1]||_0x1f09f7;_0x1a11fc[_0x1e6519(0x1cb)](_0x59f671);}}catch(_0x189955){this[_0x1e6519(0x1a3)][_0x1e6519(0x2a9)](_0x1e6519(0x1e2)+_0x1f09f7+':\x20'+_0x189955[_0x1e6519(0x273)]);}}const _0x227801=_0x1a11fc[_0x1e6519(0x23f)]>0x0?_0x1a11fc[_0x1e6519(0x2a0)](',\x20'):_0x1e6519(0x290);return await this[_0x1e6519(0x193)]('system.presenceWho',{'val':_0x227801,'ack':!![]}),_0x1a11fc[_0x1e6519(0x23f)]>0x0;}async[a0_0x66eca8(0x258)](){const _0x4abf15=a0_0x66eca8;await aiAgent['runGeminiAnalysis'](this);this[_0x4abf15(0x18b)][_0x4abf15(0x1ac)]&&(this[_0x4abf15(0x194)](),this[_0x4abf15(0x1d6)]());if(this[_0x4abf15(0x18b)][_0x4abf15(0x279)])this[_0x4abf15(0x22e)]();}async[a0_0x66eca8(0x25f)](){const _0x3bf3b8=a0_0x66eca8,_0x1b34ef=['weatherunderground.0',_0x3bf3b8(0x28f),'daswetter.0'],_0x1033a1=[_0x3bf3b8(0x1ff),'Current.WeatherText','NextHours.Location_1.Day_1.current.symbol_desc'];for(const _0x312e9b of _0x1b34ef){for(const _0x4af446 of _0x1033a1){try{const _0xf93561=_0x312e9b+'.'+_0x4af446,_0x5458f3=await this['getForeignStateAsync'](_0xf93561);if(_0x5458f3&&_0x5458f3['val']){const _0x1263f8=String(_0x5458f3[_0x3bf3b8(0x1b9)])[_0x3bf3b8(0x225)]();if(_0x1263f8[_0x3bf3b8(0x1ae)]('sunny')||_0x1263f8[_0x3bf3b8(0x1ae)](_0x3bf3b8(0x1e7))||_0x1263f8['includes'](_0x3bf3b8(0x1ee))||_0x1263f8[_0x3bf3b8(0x1ae)](_0x3bf3b8(0x24a))||_0x1263f8[_0x3bf3b8(0x1ae)]('clear'))return this[_0x3bf3b8(0x1a3)][_0x3bf3b8(0x184)](_0x3bf3b8(0x15f)+_0xf93561),!![];}}catch(_0x6e96ae){}}}return![];}['triggerGaitAnalysis'](){const _0x3af543=a0_0x66eca8;if(!this['isProVersion'])return;try{this[_0x3af543(0x2b3)](_0x3af543(0x1b5),(_0x4372ac,_0x4589d7)=>{const _0x370e3d=_0x3af543;if(_0x4372ac||!_0x4589d7||!_0x4589d7[_0x370e3d(0x1b9)])return;try{const _0x30b16f=JSON[_0x370e3d(0x1b8)](_0x4589d7[_0x370e3d(0x1b9)]);if(!_0x30b16f||_0x30b16f[_0x370e3d(0x23f)]===0x0)return;pythonBridge[_0x370e3d(0x1e0)](this,_0x370e3d(0x22a),{'sequences':_0x30b16f}),this['log'][_0x370e3d(0x184)](_0x370e3d(0x1c0)+_0x30b16f[_0x370e3d(0x23f)]+_0x370e3d(0x168));}catch(_0x3fd940){this[_0x370e3d(0x1a3)][_0x370e3d(0x2a9)](_0x370e3d(0x1ce)+_0x3fd940[_0x370e3d(0x273)]);}});}catch(_0x55766f){this['log']['warn'](_0x3af543(0x1c2)+_0x55766f[_0x3af543(0x273)]);}}async[a0_0x66eca8(0x22e)](){const _0x2fd7c5=a0_0x66eca8;if(!this[_0x2fd7c5(0x198)]||!this[_0x2fd7c5(0x18b)][_0x2fd7c5(0x279)])return;try{const _0x5ca4f4={},_0x33c2a1={},_0x8e20=this[_0x2fd7c5(0x2a3)]['devices']||[];for(const _0x22100a of _0x8e20){if((_0x22100a['type']==='temperature'||_0x22100a[_0x2fd7c5(0x299)]===_0x2fd7c5(0x1d7))&&_0x22100a[_0x2fd7c5(0x201)])try{const _0x39e28c=await this[_0x2fd7c5(0x1fb)](_0x22100a['id']);_0x39e28c&&typeof _0x39e28c[_0x2fd7c5(0x1b9)]===_0x2fd7c5(0x294)&&(_0x5ca4f4[_0x22100a[_0x2fd7c5(0x201)]]=_0x39e28c['val'],_0x33c2a1[_0x22100a[_0x2fd7c5(0x201)]]=_0x22100a['isSolar']||![]);}catch(_0x4c7d7a){}}let _0x59bacc=0xa;if(this[_0x2fd7c5(0x2a3)][_0x2fd7c5(0x2bd)])try{const _0x57af87=await this[_0x2fd7c5(0x1fb)](this['config'][_0x2fd7c5(0x2bd)]);if(_0x57af87&&typeof _0x57af87[_0x2fd7c5(0x1b9)]===_0x2fd7c5(0x294))_0x59bacc=_0x57af87[_0x2fd7c5(0x1b9)];}catch(_0x215b1c){}const _0x638ef3=await this[_0x2fd7c5(0x25f)]();let _0x5c51bf={};try{const _0x3fd0a2=await this[_0x2fd7c5(0x2b3)](_0x2fd7c5(0x1a9));if(_0x3fd0a2&&_0x3fd0a2[_0x2fd7c5(0x1b9)])_0x5c51bf=JSON['parse'](_0x3fd0a2['val']);}catch(_0xcf4018){}pythonBridge[_0x2fd7c5(0x1e0)](this,'PREDICT_ENERGY',{'current_temps':_0x5ca4f4,'t_out':_0x59bacc,'is_sunny':_0x638ef3,'solar_flags':_0x33c2a1,'warmup_targets':_0x5c51bf}),this[_0x2fd7c5(0x1a3)][_0x2fd7c5(0x2b4)](_0x2fd7c5(0x280)+Object[_0x2fd7c5(0x28e)](_0x5ca4f4)['length']+'\x20rooms)');}catch(_0x58c4ae){this[_0x2fd7c5(0x1a3)][_0x2fd7c5(0x2a9)]('triggerEnergyPrediction\x20Error:\x20'+_0x58c4ae[_0x2fd7c5(0x273)]);}}[a0_0x66eca8(0x194)](){const _0x3d0888=a0_0x66eca8;if(!this[_0x3d0888(0x296)]||this[_0x3d0888(0x296)][_0x3d0888(0x23f)]===0x0)return;const _0x3a1cd2=new Array(0x30)[_0x3d0888(0x17d)](0x0),_0x37c442=Array[_0x3d0888(0x187)]({'length':0x30},()=>[]),_0x4152f0=new Date()['setHours'](0x0,0x0,0x0,0x0);this[_0x3d0888(0x296)][_0x3d0888(0x1f5)](_0x125a63=>{const _0x2c41df=_0x3d0888,_0x2bc494=new Date(_0x125a63['timestamp']);if(_0x2bc494[_0x2c41df(0x19d)]()>=_0x4152f0){const _0x17c0e6=_0x2bc494['getHours'](),_0x4914ae=_0x2bc494[_0x2c41df(0x166)](),_0x1b3085=_0x17c0e6*0x2+Math[_0x2c41df(0x25a)](_0x4914ae/0x1e);_0x1b3085>=0x0&&_0x1b3085<0x30&&(_0x3a1cd2[_0x1b3085]++,_0x37c442[_0x1b3085][_0x2c41df(0x1cb)]({'time':_0x2bc494[_0x2c41df(0x252)](_0x2c41df(0x1f3),{'hour':_0x2c41df(0x221),'minute':_0x2c41df(0x221)}),'location':_0x125a63['location']||_0x2c41df(0x1ba),'type':_0x125a63[_0x2c41df(0x299)]||_0x2c41df(0x17a)}));}}),this[_0x3d0888(0x193)](_0x3d0888(0x246),{'val':JSON['stringify'](_0x3a1cd2),'ack':!![]}),this[_0x3d0888(0x193)](_0x3d0888(0x264),{'val':JSON[_0x3d0888(0x283)](_0x37c442),'ack':!![]});}async['handleInfrasound'](_0x4c3dc8){const _0x427b95=a0_0x66eca8;if(!this[_0x427b95(0x2a3)]['infrasoundEnabled']||typeof _0x4c3dc8!==_0x427b95(0x294))return;const _0x37d4b6=this[_0x427b95(0x2a3)][_0x427b95(0x160)]||0.04;this[_0x427b95(0x242)]['push']({'timestamp':Date[_0x427b95(0x29f)](),'value':_0x4c3dc8}),this[_0x427b95(0x242)][_0x427b95(0x23f)]>0x64&&this[_0x427b95(0x242)][_0x427b95(0x2b8)](),_0x4c3dc8>_0x37d4b6&&!this[_0x427b95(0x22d)]&&(this[_0x427b95(0x22d)]=!![],this[_0x427b95(0x1a3)]['warn'](_0x427b95(0x1c4)+_0x4c3dc8[_0x427b95(0x1f8)](0x4)+_0x427b95(0x223)+_0x37d4b6+'\x20(Threshold)'),await this[_0x427b95(0x1dd)](_0x4c3dc8,_0x427b95(0x170)),setTimeout(()=>{const _0x4970a0=_0x427b95;this[_0x4970a0(0x22d)]=![];},0x5*0x3c*0x3e8));}async[a0_0x66eca8(0x1dd)](_0x5a8e62,_0x2e418f){const _0xa0ac2f=a0_0x66eca8;if(!this[_0xa0ac2f(0x28a)]){const _0x22adb4=this['eventHistory'][_0xa0ac2f(0x297)](0x0,0xa),_0x183779=_0x22adb4[_0xa0ac2f(0x2be)](_0x28fefa=>new Date(_0x28fefa[_0xa0ac2f(0x26c)])[_0xa0ac2f(0x252)]('de-DE')+_0xa0ac2f(0x254)+(_0x28fefa[_0xa0ac2f(0x201)]||_0xa0ac2f(0x1d5))+':\x20'+_0x28fefa[_0xa0ac2f(0x27b)])[_0xa0ac2f(0x2a0)]('\x0a');this[_0xa0ac2f(0x1a3)][_0xa0ac2f(0x2a9)](_0xa0ac2f(0x1f6)+_0x5a8e62[_0xa0ac2f(0x1f8)](0x4)+_0xa0ac2f(0x196)+_0x183779);if(this[_0xa0ac2f(0x2a3)]['infrasoundArmingId'])try{const _0x2e6667=await this[_0xa0ac2f(0x1fb)](this[_0xa0ac2f(0x2a3)][_0xa0ac2f(0x28d)]);_0x2e6667&&_0x2e6667[_0xa0ac2f(0x1b9)]===!![]&&(await this['setStateAsync'](_0xa0ac2f(0x1af),{'val':JSON[_0xa0ac2f(0x283)]({'timestamp':Date[_0xa0ac2f(0x29f)](),'pressure':_0x5a8e62[_0xa0ac2f(0x1f8)](0x4),'eventType':_0x2e418f,'recentEvents':_0x22adb4['slice'](0x0,0x3)}),'ack':!![]}),this['log'][_0xa0ac2f(0x2a5)](_0xa0ac2f(0x29c)));}catch(_0x5ae603){}}else this[_0xa0ac2f(0x1a3)][_0xa0ac2f(0x184)]('üîä\x20Infraschall:\x20'+_0x5a8e62[_0xa0ac2f(0x1f8)](0x4)+_0xa0ac2f(0x27e));}async[a0_0x66eca8(0x227)](_0x1d7e05){const _0x61f3ab=a0_0x66eca8;if(!_0x1d7e05||!_0x1d7e05['location'])return;try{const _0x3ab856=(this[_0x61f3ab(0x2a3)][_0x61f3ab(0x22c)]||[])['filter'](_0x3ee367=>_0x3ee367['location']===_0x1d7e05[_0x61f3ab(0x201)]&&(_0x3ee367[_0x61f3ab(0x299)]===_0x61f3ab(0x23a)||_0x3ee367[_0x61f3ab(0x299)]===_0x61f3ab(0x1d7)));if(_0x3ab856[_0x61f3ab(0x23f)]===0x0)return;const _0xabc624=await this['getForeignStateAsync'](_0x3ab856[0x0]['id']);if(!_0xabc624||typeof _0xabc624[_0x61f3ab(0x1b9)]!==_0x61f3ab(0x294))return;const _0x1fdd86=_0xabc624[_0x61f3ab(0x1b9)];let _0x173467=null;if(this[_0x61f3ab(0x2a3)]['weatherTempId']){const _0x2f9b68=await this[_0x61f3ab(0x1fb)](this[_0x61f3ab(0x2a3)][_0x61f3ab(0x2bd)]);_0x2f9b68&&typeof _0x2f9b68[_0x61f3ab(0x1b9)]===_0x61f3ab(0x294)&&(_0x173467=_0x2f9b68[_0x61f3ab(0x1b9)]);}if(_0x173467!==null){const _0x129dd4=Math[_0x61f3ab(0x282)](_0x1fdd86-_0x173467);_0x129dd4>0x3&&(this[_0x61f3ab(0x1a3)][_0x61f3ab(0x184)](_0x61f3ab(0x208)+_0x1d7e05[_0x61f3ab(0x201)]+_0x61f3ab(0x2aa)+_0x129dd4[_0x61f3ab(0x1f8)](0x1)+_0x61f3ab(0x1ad)+_0x1fdd86+_0x61f3ab(0x1ea)+_0x173467+'¬∞C)'),await this['setStateAsync'](_0x61f3ab(0x25e),{'val':JSON[_0x61f3ab(0x283)]({'room':_0x1d7e05[_0x61f3ab(0x201)],'timestamp':Date[_0x61f3ab(0x29f)](),'tempDiff':_0x129dd4['toFixed'](0x1),'recommendation':_0x129dd4>0x5?_0x61f3ab(0x183):_0x61f3ab(0x26a)}),'ack':!![]}));}}catch(_0x233b4c){this[_0x61f3ab(0x1a3)]['warn'](_0x61f3ab(0x20f)+_0x233b4c['message']);}}async[a0_0x66eca8(0x1cf)](_0x14370d){const _0x40796e=a0_0x66eca8;if(!_0x14370d||typeof _0x14370d!=='object')return;const _0x2b0b94={'timestamp':_0x14370d['timestamp']||Date[_0x40796e(0x29f)](),'id':_0x14370d['id']||Date['now']()[_0x40796e(0x200)](),'name':_0x14370d['name']||'Manual\x20Event','type':_0x14370d[_0x40796e(0x299)]||_0x40796e(0x204),'location':_0x14370d[_0x40796e(0x201)]||'Unknown','value':_0x14370d[_0x40796e(0x1ca)]||null};this[_0x40796e(0x289)][_0x40796e(0x1ef)](_0x2b0b94);if(this['eventHistory'][_0x40796e(0x23f)]>0x1388)this[_0x40796e(0x289)][_0x40796e(0x1b4)]();await this[_0x40796e(0x193)](_0x40796e(0x206),{'val':JSON[_0x40796e(0x283)](this['eventHistory']),'ack':!![]}),this[_0x40796e(0x1a3)][_0x40796e(0x184)](_0x40796e(0x19f)+_0x2b0b94[_0x40796e(0x27b)]+'\x20('+_0x2b0b94['location']+')');}[a0_0x66eca8(0x217)](_0x1803a6){}}if(require[a0_0x66eca8(0x247)]!==module)module[a0_0x66eca8(0x22f)]=_0x55e778=>new CogniLiving(_0x55e778);else new CogniLiving();