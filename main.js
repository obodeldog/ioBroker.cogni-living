const a0_0x522117=a0_0x1f21;(function(_0x4c6321,_0x355fd4){const _0x59a17c=a0_0x1f21,_0x13ba1a=_0x4c6321();while(!![]){try{const _0x22e0f1=-parseInt(_0x59a17c(0x232))/0x1*(-parseInt(_0x59a17c(0x19f))/0x2)+-parseInt(_0x59a17c(0x26e))/0x3+-parseInt(_0x59a17c(0x19e))/0x4*(parseInt(_0x59a17c(0x11f))/0x5)+-parseInt(_0x59a17c(0x14d))/0x6*(parseInt(_0x59a17c(0xfe))/0x7)+parseInt(_0x59a17c(0x18d))/0x8+parseInt(_0x59a17c(0x114))/0x9+parseInt(_0x59a17c(0x12b))/0xa;if(_0x22e0f1===_0x355fd4)break;else _0x13ba1a['push'](_0x13ba1a['shift']());}catch(_0x251cba){_0x13ba1a['push'](_0x13ba1a['shift']());}}}(a0_0x384e,0x83f96));const a0_0x4947e5=(function(){let _0x5c4055=!![];return function(_0x3c2017,_0x58d3b6){const _0x2e6321=_0x5c4055?function(){const _0x474adf=a0_0x1f21;if(_0x58d3b6){const _0x37e2c1=_0x58d3b6[_0x474adf(0x1cb)](_0x3c2017,arguments);return _0x58d3b6=null,_0x37e2c1;}}:function(){};return _0x5c4055=![],_0x2e6321;};}()),a0_0x98b764=a0_0x4947e5(this,function(){const _0x554673=a0_0x1f21;return a0_0x98b764[_0x554673(0x250)]()[_0x554673(0x110)](_0x554673(0x196))[_0x554673(0x250)]()[_0x554673(0x258)](a0_0x98b764)[_0x554673(0x110)]('(((.+)+)+)+$');});a0_0x98b764();'use strict';const utils=require(a0_0x522117(0x25b)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x522117(0x160)),{spawn,exec}=require(a0_0x522117(0x10f)),path=require(a0_0x522117(0x120)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x522117(0x11e),LTM_SCHEDULE=a0_0x522117(0x260),MODE_RESET_SCHEDULE=a0_0x522117(0x26c),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x522117(0x158),LTM_DP_DAILY_DIGESTS=a0_0x522117(0x237),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x522117(0x159),LTM_DP_BASELINE_STATUS=a0_0x522117(0x1a0),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x522117(0x256),LTM_DP_DRIFT_DETAILS=a0_0x522117(0x171),LTM_DP_DRIFT_LAST_CHECK=a0_0x522117(0x1fb),SYSTEM_DP_MODE=a0_0x522117(0x270),SYSTEM_MODES={'NORMAL':a0_0x522117(0x1ab),'VACATION':a0_0x522117(0x1ae),'PARTY':a0_0x522117(0x1e4),'GUEST':a0_0x522117(0x245)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x522117(0x290)],SYSTEM_MODES[a0_0x522117(0x243)]],PERSONA_MAPPING={'generic':a0_0x522117(0x14b),'senior_aal':a0_0x522117(0x26a),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x522117(0x29c),'security':a0_0x522117(0x137)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x522117(0x1b5)]===a0_0x522117(0x2a2),PERSISTENT_DIR=path[a0_0x522117(0x1eb)](__dirname,'.venv'),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x522117(0x154),'python.exe'):path[a0_0x522117(0x1eb)](VENV_PATH,a0_0x522117(0x285),a0_0x522117(0x214)),PIP_EXE=IS_WIN?path[a0_0x522117(0x1eb)](VENV_PATH,a0_0x522117(0x154),a0_0x522117(0x184)):path[a0_0x522117(0x1eb)](VENV_PATH,a0_0x522117(0x285),a0_0x522117(0x161));let activeSequence=[],sequenceTimer=null;function a0_0x384e(){const _0x535526=['PONG','User\x20dismissed\x20automation\x20proposal.','TOPOLOGY_RESULT','Cogni-Living','COGNI_REQUEST_CALL','scheduleJob','targetId','isExit','üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','PREDICT_ENERGY','ack','presenceDevices','triggerBriefing','indicator','alertReason','.\x20SYSTEM_MODE:\x20','Installing\x20pip\x20packages...\x20(Timeout:\x2030min)','value','pip.exe','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','is_anomaly','currentSystemMode','autoApply','licenseKey','stdin','role','contact','7472320UjHsZd','isAlert','Insulation\x20Score','values','Wetterdaten\x20deaktiviert.','aiPersona','lastAlertState','lights','\x20=\x20','(((.+)+)+)+$','Skipped\x20(No\x20AI\x20or\x20Data)','apiKey','bind','.forecast.current.state','Health\x20Analysis','system','boolean','25356JlAukh','26NyHmwH','LTM.baselineStatus','ANALYZE_TREND','calendarInstance','number','Digest','enum.functions.*','\x20new\x20patterns.','VACATION','targetValue','logDuplicates','heating','normal','[RESULT]','.forecast.current.temp','vacation','analysis.automation.detectedPatterns','temperature','window','door','pr√§senz','fenster','platform','config','activityLevel','exports','communicate.request','cogni-living','analysis.training.triggerComfort','KI-Modell\x20nicht\x20initialisiert','Last\x20Check','debug','analysis.history_debug_00','‚ùå\x20VENV\x20FAILED:\x20','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Keine\x20Wetterdaten\x20verf√ºgbar.','Gemini\x20Init\x20Error:\x20','Raw\x20Log','notifyPushoverInstance','dimmer','.\x20ANWESEND:\x20','forEach','getEnums','isPresent','apply','ltmLtbWindowDays','Train\x20Security','Train\x20Energy','detected','testContext','channel','retry','analysis.health.gaitSpeed','Train\x20Comfort','geminiApiKey','cogni-living\x20adapter\x20starting\x20(v','getMinutes','analysis.trigger','analysisInterval','name','instance','licht','analysis.automation.patternDetected','parse','Current\x20Threshold','Success','getGenerativeModel','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','Who\x20is\x20present?','party','isProVersion','Trigger\x20Action','Trend','genAI','Keine\x20Details.','system.config','join','indexOf','unload','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','unknown','motion','[LOG]','python_service','stateChange','analysis.lastResult','analysisHistory','Auto\x20Apply','toLowerCase','Regel\x20erkannt:\x20','button','Activity\x20Summary','LTM.driftAnalysis.lastCheck','details','text','Unknown','analysis.automation.autoApply','analysis.security','Description','subscribeForeignStatesAsync','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','Target\x20ID','08:00','.\x20EMERGENCY:\x20','sendTo','analysis.energy.forecast','dailyDigests','.Current.WeatherText','BUTLER\x20Execution\x20Error:\x20','cancel','events.history','minDaysForBaseline','ANALYZE_SEQUENCE','\x0aSTB:\x20','analysis.training.triggerHealth','[RECORDER]\x20Error:\x20','system.presenceWho','python','confidence','Daily\x20Digests','slice','driftAnalysisTimer','notifyPushoverRecipient','map','ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...','events.lastEvent','getForeignObjectsAsync','success','main','getMonth','üìù\x20Feedback\x20received:\x20','existsSync','TRAIN_ENERGY','Trigger\x20Analysis','Detected\x20Patterns','response','TREND_RESULT','namespace','analysis.health.lastCheck','briefingTime','Deaktiviert\x20(Pro-Feature)','onUnload','temperatur','notifyTelegramRecipient','substring','isEmergency','sound','48007Wrvczt','light','üï∏Ô∏è\x20Building\x20Topology\x20Matrix...','getFullYear','delObjectAsync','LTM.dailyDigests','Temperature\x20Forecast','analysis.energy.heatingScore','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','sensorLastValues','subscribeStates','payload','¬∞C,\x20','N/A','ready','üõãÔ∏è\x20BUTLER:\x20Found\x20','analysis.health.trendValue','GUEST','TRAIN_COMFORT','guest','splice','Reset\x20Sched\x20Error:\x20','scanDevices','indicator.alarm','analysis.training.triggerEnergy','rawEventLog','LTM','Briefing\x20Error:\x20','setObjectNotExistsAsync','System\x20Mode','toString','type','Topology\x20Matrix','application/json','location','Training\x20Status','LTM.driftAnalysis.baselineDrift','Drift\x20Sched\x20Error:\x20','constructor','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','notifyTelegramInstance','@iobroker/adapter-core','GAIT_RESULT','Event\x20History','useCalendar','systemConfig','0\x203\x20*\x20*\x20*','analysis.automation.description','notifyEmailRecipient','floor','pop','Success:\x20','analysis.activitySummary','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','ltmJob','.Current.Temperature','PRIORIT√ÑT:\x20Gesundheit/AAL.','getStateAsync','0\x204\x20*\x20*\x20*','üîç\x20Scanning\x20for\x20devices...','3093336ExnzPd','command','system.mode','timestamp','doors','.\x20KONTEXT:\x20','json','eventHistory','ENERGY_TRAIN_RESULT','dismissAutomation','analysis.training.triggerSecurity','val','loc','push','LTM.trainingData.sequences','analysis.security.lastScore','Target\x20Value','fill','includes','.forecast.current.temperature','‚ùå\x20INSTALL\x20FAILED:\x20','diagnosis','exitTimer','bin','Heating\x20Score','driftDetails','Kalender\x20deaktiviert.','Today\x20Vector\x20(15m)','automation.triggerAction','outdoorSensorId','text.alarm','TRAIN_HEALTH','python3','analysis.training','PARTY','testApiKey','Sec-Training\x20started...','triggerDailyDigest','analysis.automation.triggerAction','Build\x20Topology','briefingEnabled','find','dependencyInstallInProgress','simulateButler','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','toISOString','Fokus\x20auf\x20Komfort.','events.history_debug_00','onStateChange','notifyEmailInstance','analysis.isAlert','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','win32','üï∏Ô∏è\x20Topology\x20Map\x20updated.','analysis.triggerBriefing','common','Aktiv\x20(','error','t√ºr','analysis.analysisHistory','systemUUID','Gemini\x20AI\x20initialized.','WiFi\x20Presence\x20detected.','NORMAL','stdout','üåÖ\x20Morning\x20Briefing:\x0a','onMessage','state','notifyPushoverEnabled','Alert\x20Status','longitude','Gemini\x20Error:\x20','exitGraceTimer','object','Anomaly\x20Detected','startsWith','Started...','generateContent','analysis.health.trendDiagnosis','weatherInstance','pythonProcess','\x20->\x20','bewegung','string','analysis.health','extendObjectAsync','Alarm',')\x20-\x20SAFE\x20BOOT','2695kQzDtA','setState','stringify','analysis.alertReason','ANALYZE_HEALTH','summary','getForeignObjectAsync','insulation','now','length','AI\x20Training','reason','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','openweathermap','analysis.training.triggerTopology','Alert\x20Reason','üß™\x20Simulating\x20Butler\x20Proposal:\x20','child_process','search','data','analysis.security.lastCheck','python3\x20-m\x20venv\x20\x22','6592401kDLTcB','from','üêç\x20Python\x20Pong','unshift','info','analysis.energy.insulationScore','change_percent','send','lampe','BUILD_TOPOLOGY','models/gemini-flash-latest','370rYkTEL','path','Anomaly\x20Score','livingContext','status','analysis.automation.targetId','setStateAsync','devices','geminiModel','weatherunderground','write','isGracePeriodActive','7076390RJDMbs','No\x20instance','split','city','.NextHours.Location_1.Day_1.current.temp_value','close','analysisTimer','Error\x20launching\x20Python:\x20','schalter','replace','online','LTM\x20Sched\x20Error:\x20','PRIORIT√ÑT:\x20Sicherheit.','LTM.trainingData.thermodynamics','trim','getHours','switch','analysis.health.todayVector','.\x20WETTER:\x20','‚úÖ\x20HEALTH\x20TRAINED.','Activity-Level','shift','enum.rooms.*','analysis.security.currentThreshold','log','COMFORT_RESULT','Vom\x20Benutzer\x20best√§tigt\x20(OK).','analysis.automation.targetValue','system.isPresent','inactivityThresholdHours','‚úÖ\x20Alles\x20OK\x20(Reset)','TRAIN_SECURITY','Analysiere\x20ausgewogen.','ltmStbWindowDays','14922KMbCme','toFixed','writable','automationProposal','Sequences','.\x20EVENTS:\x20','threshold','Scripts','notifyTelegramEnabled','getForeignStateAsync','baselineDrift','LTM.rawEventLog','LTM.triggerDailyDigest','modeResetJob','ANALYZE_GAIT','latitude','getTime','Lernphase\x20(','rmSync','node-schedule','pip','analysis.energy','setForeignStateAsync','message','sendToAsync','rule','round','Err:\x20','briefingJob','Adapter','Keine\x20Termine.','callback','N/A\x20(Learning)','getObjectAsync','analysis.security.topologyMatrix','‚ö†Ô∏è\x20ALARM:\x20','LTM.driftAnalysis.driftDetails'];a0_0x384e=function(){return _0x535526;};return a0_0x384e();}async function startSystem(_0x4a383f){const _0x127ff6=a0_0x522117;_0x4a383f['log'][_0x127ff6(0x118)]('üöÄ\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.0)...'),await initZombies(_0x4a383f);try{_0x4a383f[_0x127ff6(0x1e5)]=await checkLicense(_0x4a383f[_0x127ff6(0x1b6)][_0x127ff6(0x189)]);}catch(_0x375f78){}if(!_0x4a383f[_0x127ff6(0x1b6)]['inactivityThresholdHours']||_0x4a383f[_0x127ff6(0x1b6)][_0x127ff6(0x148)]<0.1)_0x4a383f[_0x127ff6(0x1b6)]['inactivityThresholdHours']=0xc;await initHistory(_0x4a383f),await initSystemConfig(_0x4a383f);if(_0x4a383f[_0x127ff6(0x1b6)]['geminiApiKey'])try{_0x4a383f[_0x127ff6(0x1e8)]=new GoogleGenerativeAI(_0x4a383f[_0x127ff6(0x1b6)][_0x127ff6(0x1d5)]),_0x4a383f[_0x127ff6(0x127)]=_0x4a383f['genAI'][_0x127ff6(0x1e1)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x127ff6(0x253)}}),_0x4a383f['log'][_0x127ff6(0x118)](_0x127ff6(0x2ab));}catch(_0xac0676){_0x4a383f[_0x127ff6(0x143)]['error'](_0x127ff6(0x1c3)+_0xac0676['message']);}await createAllObjects(_0x4a383f),await loadSystemMode(_0x4a383f),await loadRawEventLog(_0x4a383f),await loadDailyDigests(_0x4a383f),_0x4a383f['subscribeStates'](_0x127ff6(0x1d8)),_0x4a383f[_0x127ff6(0x23c)](LTM_DP_TRIGGER_DIGEST),_0x4a383f[_0x127ff6(0x23c)](_0x127ff6(0x270)),_0x4a383f[_0x127ff6(0x23c)](_0x127ff6(0x2a4)),_0x4a383f[_0x127ff6(0x23c)]('analysis.automation.triggerAction'),_0x4a383f[_0x127ff6(0x23c)](_0x127ff6(0x1ff)),_0x4a383f[_0x127ff6(0x23c)]('analysis.training.triggerSecurity'),_0x4a383f[_0x127ff6(0x23c)](_0x127ff6(0x211)),_0x4a383f[_0x127ff6(0x23c)]('analysis.training.triggerEnergy'),_0x4a383f[_0x127ff6(0x23c)](_0x127ff6(0x1bb)),_0x4a383f[_0x127ff6(0x23c)](_0x127ff6(0x10c)),await initSensorSubscriptions(_0x4a383f),await initPresenceSubscriptions(_0x4a383f),await setupTelegramListener(_0x4a383f),setTimeout(()=>checkWifiPresence(_0x4a383f),0x1388);if(_0x4a383f['analysisTimer'])clearInterval(_0x4a383f[_0x127ff6(0x131)]);const _0x29a020=_0x4a383f[_0x127ff6(0x1b6)][_0x127ff6(0x1d9)]||0xf;_0x29a020>0x0&&(_0x4a383f[_0x127ff6(0x131)]=setInterval(()=>{runAutopilot(_0x4a383f);},_0x29a020*0x3c*0x3e8)),setupLtmScheduler(_0x4a383f),setupModeResetScheduler(_0x4a383f),setupDriftAnalysisScheduler(_0x4a383f),setupBriefingScheduler(_0x4a383f),startPythonService(_0x4a383f),setTimeout(()=>{const _0x4b1e44=_0x127ff6;_0x4a383f[_0x4b1e44(0x2be)]&&(runPythonHealthCheck(_0x4a383f),triggerGaitAnalysis(_0x4a383f),triggerEnergyPrediction(_0x4a383f)),updateHealthVector(_0x4a383f);},0x1388);}async function runAutopilot(_0x222878){const _0x2e22bc=a0_0x522117;_0x222878[_0x2e22bc(0x143)][_0x2e22bc(0x1be)](_0x2e22bc(0x21b)),await runGeminiAnalysis(_0x222878),updateHealthVector(_0x222878),triggerGaitAnalysis(_0x222878),triggerEnergyPrediction(_0x222878);}async function triggerGaitAnalysis(_0x1671af){const _0xa47586=a0_0x522117;if(!_0x1671af[_0xa47586(0x1e5)])return;try{const _0x163921=await _0x1671af[_0xa47586(0x26b)](_0xa47586(0x27c));_0x163921&&_0x163921[_0xa47586(0x279)]&&sendToPython(_0x1671af,_0xa47586(0x15b),{'sequences':JSON[_0xa47586(0x1de)](_0x163921[_0xa47586(0x279)])});}catch(_0x5c6f0c){}}async function triggerEnergyPrediction(_0x297ad4){const _0x200e9=a0_0x522117;if(!_0x297ad4[_0x200e9(0x1e5)])return;try{const _0x26b93c=await getOutsideTemperatureNumeric(_0x297ad4);if(_0x26b93c===null)return;const _0x12cb01={},_0x2bb296=_0x297ad4[_0x200e9(0x1b6)]['devices']||[];for(const _0x249cd8 of _0x2bb296){if(_0x249cd8[_0x200e9(0x251)]===_0x200e9(0x1b0)&&_0x249cd8[_0x200e9(0x254)]){const _0x23b467=_0x297ad4[_0x200e9(0x23b)][_0x249cd8['id']];if(_0x23b467!==undefined)_0x12cb01[_0x249cd8['location']]=_0x23b467;}}Object['keys'](_0x12cb01)[_0x200e9(0x107)]>0x0&&sendToPython(_0x297ad4,_0x200e9(0x17b),{'current_temps':_0x12cb01,'t_out':_0x26b93c});}catch(_0x46ac66){}}function updateHealthVector(_0x1d12cd){const _0x34219f=a0_0x522117;if(!_0x1d12cd[_0x34219f(0x24b)]||_0x1d12cd[_0x34219f(0x24b)]['length']===0x0)return;const _0x37a5ca=new Array(0x60)[_0x34219f(0x27f)](0x0),_0x519ab0=new Date()['setHours'](0x0,0x0,0x0,0x0);_0x1d12cd['rawEventLog'][_0x34219f(0x1c8)](_0x15304a=>{const _0x450230=_0x34219f,_0x3eb810=new Date(_0x15304a[_0x450230(0x271)]);if(_0x3eb810[_0x450230(0x15d)]()>=_0x519ab0){const _0x496f72=_0x3eb810[_0x450230(0x13a)](),_0xd5aa1d=_0x3eb810[_0x450230(0x1d7)](),_0x32bf5d=_0x496f72*0x4+Math[_0x450230(0x263)](_0xd5aa1d/0xf);if(_0x32bf5d>=0x0&&_0x32bf5d<0x60)_0x37a5ca[_0x32bf5d]++;}}),_0x1d12cd['setStateAsync'](_0x34219f(0x13c),{'val':JSON[_0x34219f(0x100)](_0x37a5ca),'ack':!![]});}async function scanForDevices(_0x53bc4b,_0x207433){const _0x49e89e=a0_0x522117;_0x53bc4b[_0x49e89e(0x143)]['info'](_0x49e89e(0x26d));const _0x5001b2=[],_0x2e14c2=await _0x53bc4b[_0x49e89e(0x21d)]('*');for(const _0x5eafa4 in _0x2e14c2){const _0x2aeeba=_0x2e14c2[_0x5eafa4];if(_0x2aeeba&&_0x2aeeba['common']&&_0x2aeeba[_0x49e89e(0x251)]===_0x49e89e(0x2b1)){const _0x49d703=(_0x2aeeba[_0x49e89e(0x2a5)][_0x49e89e(0x1da)]&&typeof _0x2aeeba['common'][_0x49e89e(0x1da)]===_0x49e89e(0x2b7)?_0x2aeeba['common']['name']['de']:_0x2aeeba[_0x49e89e(0x2a5)][_0x49e89e(0x1da)])||'',_0x20282c=_0x2aeeba[_0x49e89e(0x2a5)][_0x49e89e(0x18b)]||'';let _0x19d85b=null;if(_0x207433[_0x49e89e(0x1f0)]&&(_0x20282c[_0x49e89e(0x280)](_0x49e89e(0x1f0))||_0x49d703[_0x49e89e(0x1f7)]()[_0x49e89e(0x280)]('bewegung')))_0x19d85b=_0x49e89e(0x1f0);else{if(_0x207433[_0x49e89e(0x272)]&&(_0x20282c[_0x49e89e(0x280)](_0x49e89e(0x1b2))||_0x20282c[_0x49e89e(0x280)]('window')||_0x49d703[_0x49e89e(0x1f7)]()['includes'](_0x49e89e(0x2a8))||_0x49d703[_0x49e89e(0x1f7)]()['includes'](_0x49e89e(0x1b4))))_0x19d85b=_0x49e89e(0x1b2);else{if(_0x207433[_0x49e89e(0x194)]&&(_0x20282c[_0x49e89e(0x280)](_0x49e89e(0x233))||_0x20282c['includes']('switch')||_0x49d703[_0x49e89e(0x1f7)]()['includes'](_0x49e89e(0x1dc))))_0x19d85b=_0x49e89e(0x233);else{if(_0x207433[_0x49e89e(0x1b0)]&&(_0x20282c[_0x49e89e(0x280)](_0x49e89e(0x1b0))||_0x49d703[_0x49e89e(0x1f7)]()[_0x49e89e(0x280)](_0x49e89e(0x22d))))_0x19d85b=_0x49e89e(0x1b0);}}}if(_0x19d85b){let _0x2fb0a5='';const _0x1e4171=_0x5eafa4[_0x49e89e(0x12d)]('.');if(_0x1e4171[_0x49e89e(0x107)]>0x2)_0x2fb0a5=_0x1e4171[0x2];_0x5001b2[_0x49e89e(0x27b)]({'id':_0x5eafa4,'name':_0x49d703||_0x5eafa4,'type':_0x19d85b,'location':_0x2fb0a5,'_score':0x32});}}}return _0x5001b2;}async function getWeatherContext(_0x31a4b1){const _0x4ad154=a0_0x522117;if(!_0x31a4b1[_0x4ad154(0x1b6)]['useWeather']||!_0x31a4b1[_0x4ad154(0x1b6)][_0x4ad154(0x2bd)])return _0x4ad154(0x191);try{const _0x6334cd=_0x31a4b1[_0x4ad154(0x1b6)]['weatherInstance'];let _0x5cd96e=await _0x31a4b1['getForeignStateAsync'](_0x6334cd+_0x4ad154(0x269));if(!_0x5cd96e)_0x5cd96e=await _0x31a4b1[_0x4ad154(0x156)](_0x6334cd+_0x4ad154(0x281));let _0x4a9b7f=await _0x31a4b1['getForeignStateAsync'](_0x6334cd+_0x4ad154(0x20a));if(!_0x4a9b7f)_0x4a9b7f=await _0x31a4b1[_0x4ad154(0x156)](_0x6334cd+_0x4ad154(0x19a));if(_0x5cd96e&&_0x4a9b7f)return _0x5cd96e[_0x4ad154(0x279)]+_0x4ad154(0x23e)+_0x4a9b7f[_0x4ad154(0x279)];}catch(_0x17ed91){}return _0x4ad154(0x1c2);}async function getCalendarContext(_0x5a527c){const _0xdb0c71=a0_0x522117;if(!_0x5a527c[_0xdb0c71(0x1b6)][_0xdb0c71(0x25e)]||!_0x5a527c[_0xdb0c71(0x1b6)][_0xdb0c71(0x1a2)])return _0xdb0c71(0x288);return _0xdb0c71(0x16b);}async function getCalendarNames(_0x3dca32,_0x4e0677){return[];}async function saveFeedback(_0x1625ee,_0x109de0){const _0x3e02fe=a0_0x522117;_0x1625ee[_0x3e02fe(0x143)][_0x3e02fe(0x118)](_0x3e02fe(0x221)+_0x109de0['rating']);}async function sendMorningBriefing(_0xc11a1b){const _0x37a940=a0_0x522117;if(!_0xc11a1b[_0x37a940(0x127)])return;try{const _0x412e06=_0x37a940(0x267),_0x44f612=await _0xc11a1b[_0x37a940(0x127)][_0x37a940(0x2bb)](_0x412e06),_0x4884a4=_0x44f612[_0x37a940(0x226)][_0x37a940(0x1fd)]();sendNotification(_0xc11a1b,_0x37a940(0x2af)+_0x4884a4);}catch(_0x7b2782){_0xc11a1b[_0x37a940(0x143)][_0x37a940(0x2a7)](_0x37a940(0x24d)+_0x7b2782['message']);}}function checkAndInstall(_0x117740){if(!fs['existsSync'](VENV_PATH)||!fs['existsSync'](PIP_EXE))return _0x117740['log']['warn']('‚ö†Ô∏è\x20Python\x20VENV\x20missing.\x20Installing\x20locally...'),installPythonDependencies(_0x117740),![];return!![];}function a0_0x1f21(_0x43abcc,_0x59e406){const _0x193357=a0_0x384e();return a0_0x1f21=function(_0x98b764,_0x4947e5){_0x98b764=_0x98b764-0xfd;let _0x384e4c=_0x193357[_0x98b764];return _0x384e4c;},a0_0x1f21(_0x43abcc,_0x59e406);}function installPythonDependencies(_0x48d5fe){const _0x7f11cc=a0_0x522117;if(_0x48d5fe['dependencyInstallInProgress'])return;_0x48d5fe[_0x7f11cc(0x298)]=!![];const _0xa2d3fd=path[_0x7f11cc(0x1eb)](__dirname,'python_service','requirements.txt');stopPythonService(_0x48d5fe);if(fs[_0x7f11cc(0x222)](VENV_PATH))try{fs[_0x7f11cc(0x15f)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x5da643){}exec(_0x7f11cc(0x113)+VENV_PATH+'\x22',_0x4067ec=>{const _0x37a2e1=_0x7f11cc;if(_0x4067ec){_0x48d5fe[_0x37a2e1(0x143)][_0x37a2e1(0x2a7)](_0x37a2e1(0x1c0)+_0x4067ec['message']),_0x48d5fe[_0x37a2e1(0x298)]=![];return;}installRequirementsInVenv(_0x48d5fe,_0xa2d3fd);});}function installRequirementsInVenv(_0x33516e,_0x51fdc8){const _0x2f419=a0_0x522117;_0x33516e[_0x2f419(0x143)]['info'](_0x2f419(0x182));const _0x4b8059='\x22'+PIP_EXE+_0x2f419(0x2a1)+_0x51fdc8+'\x22';exec(_0x4b8059,{'timeout':0x1b7740},(_0xa82d84,_0x11a122,_0x307060)=>{const _0x413d78=_0x2f419;_0x33516e[_0x413d78(0x298)]=![],_0xa82d84?_0x33516e[_0x413d78(0x143)][_0x413d78(0x2a7)](_0x413d78(0x282)+(_0x307060||_0xa82d84[_0x413d78(0x164)])):(_0x33516e[_0x413d78(0x143)][_0x413d78(0x118)]('‚úÖ\x20INSTALL\x20SUCCESS.'),startSystem(_0x33516e));});}async function initZombies(_0x2b9b54){const _0x5691b3=a0_0x522117;try{const _0x56b0dd=[_0x5691b3(0x1bf),_0x5691b3(0x29d)];for(const _0x41ab54 of _0x56b0dd){try{const _0x52aca6=await _0x2b9b54[_0x5691b3(0x16e)](_0x41ab54);if(_0x52aca6)await _0x2b9b54[_0x5691b3(0x236)](_0x41ab54);}catch(_0x57692f){}}}catch(_0x2d2704){}}async function checkLicense(_0x3b4647){return!![];}async function initHistory(_0x173210){const _0x31d408=a0_0x522117;try{const _0x5516d3=await _0x173210[_0x31d408(0x26b)](_0x31d408(0x20d));_0x5516d3&&_0x5516d3[_0x31d408(0x279)]&&(_0x173210[_0x31d408(0x275)]=JSON['parse'](_0x5516d3[_0x31d408(0x279)][_0x31d408(0x250)]()));}catch(_0x36bb0c){_0x173210[_0x31d408(0x275)]=[];}try{const _0x392e03=await _0x173210['getStateAsync'](_0x31d408(0x2a9));if(_0x392e03&&_0x392e03[_0x31d408(0x279)])_0x173210[_0x31d408(0x1f5)]=JSON['parse'](_0x392e03[_0x31d408(0x279)][_0x31d408(0x250)]());}catch(_0x5b821a){_0x173210[_0x31d408(0x1f5)]=[];}if(_0x173210['eventHistory']&&_0x173210[_0x31d408(0x275)]['length']>0x0){_0x173210[_0x31d408(0x143)]['info']('Restoring\x20sensor\x20cache...');for(let _0x7b2006=_0x173210[_0x31d408(0x275)][_0x31d408(0x107)]-0x1;_0x7b2006>=0x0;_0x7b2006--){const _0x101384=_0x173210[_0x31d408(0x275)][_0x7b2006];if(_0x101384&&_0x101384['id']!==undefined&&_0x101384['value']!==undefined)_0x173210[_0x31d408(0x23b)][_0x101384['id']]=_0x101384['value'];}}}async function initSystemConfig(_0x491f61){const _0x2cc07c=a0_0x522117;try{const _0xa38859=await _0x491f61[_0x2cc07c(0x104)](_0x2cc07c(0x1ea));if(_0xa38859&&_0xa38859[_0x2cc07c(0x2a5)])_0x491f61[_0x2cc07c(0x25f)]={'latitude':_0xa38859[_0x2cc07c(0x2a5)][_0x2cc07c(0x15c)]||0x0,'longitude':_0xa38859[_0x2cc07c(0x2a5)][_0x2cc07c(0x2b4)]||0x0,'city':_0xa38859[_0x2cc07c(0x2a5)][_0x2cc07c(0x12e)]||''};}catch(_0x5c625c){}}async function createAllObjects(_0xc9aa9b){const _0xcfbfe0=a0_0x522117;await _0xc9aa9b[_0xcfbfe0(0x2c3)](_0xcfbfe0(0x19c),{'type':_0xcfbfe0(0x1d1),'common':{'name':'System'},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x2c3)](SYSTEM_DP_MODE,{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x24f),'type':'string','role':_0xcfbfe0(0x2b1),'read':!![],'write':!![],'def':SYSTEM_MODES[_0xcfbfe0(0x2ad)]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x213),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1e3),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x1fd),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x21c),{'type':'state','common':{'name':'Last\x20raw\x20event','type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x274),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('events.history',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x25d),'type':_0xcfbfe0(0x2c1),'role':'json','read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x2c3)](_0xcfbfe0(0x28f),{'type':_0xcfbfe0(0x1d1),'common':{'name':_0xcfbfe0(0x108)},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('analysis.training.triggerSecurity',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1cd),'type':_0xcfbfe0(0x19d),'role':'button','read':!![],'write':!![]},'native':{}}),await _0xc9aa9b['setObjectNotExistsAsync'](_0xcfbfe0(0x211),{'type':_0xcfbfe0(0x2b1),'common':{'name':'Train\x20Health','type':_0xcfbfe0(0x19d),'role':_0xcfbfe0(0x1f9),'read':!![],'write':!![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x24a),{'type':'state','common':{'name':_0xcfbfe0(0x1ce),'type':'boolean','role':_0xcfbfe0(0x1f9),'read':!![],'write':!![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x1bb),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1d4),'type':_0xcfbfe0(0x19d),'role':'button','read':!![],'write':!![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('analysis.training.triggerTopology',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x295),'type':'boolean','role':_0xcfbfe0(0x1f9),'read':!![],'write':!![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('analysis.training.status',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x255),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x2c3)](_0xcfbfe0(0x200),{'type':_0xcfbfe0(0x1d1),'common':{'name':'Security\x20Monitor'},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x27d),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x121),'type':_0xcfbfe0(0x1a3),'role':'value','read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('analysis.security.currentThreshold',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1df),'type':'number','role':_0xcfbfe0(0x183),'read':!![],'write':![],'def':0.05},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x112),{'type':'state','common':{'name':'Last\x20Check','type':'string','role':'date','read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x16f),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x252),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x274),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x2c3)](_0xcfbfe0(0x2c2),{'type':'channel','common':{'name':_0xcfbfe0(0x19b)},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('analysis.health.lastCheck',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1bd),'type':'string','role':'date','read':!![],'write':![]},'native':{}}),await _0xc9aa9b['setObjectNotExistsAsync']('analysis.health.isAnomaly',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x2b8),'type':_0xcfbfe0(0x19d),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0xc9aa9b['setObjectNotExistsAsync']('analysis.health.trendDiagnosis',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1e7),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x1fd),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x242),{'type':_0xcfbfe0(0x2b1),'common':{'name':'Trend\x20Value','type':_0xcfbfe0(0x1a3),'role':_0xcfbfe0(0x183),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b['setObjectNotExistsAsync'](_0xcfbfe0(0x13c),{'type':'state','common':{'name':_0xcfbfe0(0x289),'type':_0xcfbfe0(0x2c1),'role':'json','read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x1d3),{'type':_0xcfbfe0(0x2b1),'common':{'name':'Gait\x20Speed\x20Trend','type':_0xcfbfe0(0x1a3),'role':_0xcfbfe0(0x183),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x2c3)](_0xcfbfe0(0x162),{'type':_0xcfbfe0(0x1d1),'common':{'name':'Energy\x20Intelligence'},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x119),{'type':'state','common':{'name':_0xcfbfe0(0x18f),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x1fd),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('analysis.energy.heatingScore',{'type':'state','common':{'name':_0xcfbfe0(0x286),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0xc9aa9b['setObjectNotExistsAsync'](_0xcfbfe0(0x208),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x238),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x274),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x2c3)](_0xcfbfe0(0x24c),{'type':_0xcfbfe0(0x1d1),'common':{'name':_0xcfbfe0(0x24c)},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x2c3)](LTM_DP_RAW_LOG,{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1c4),'type':'string','role':_0xcfbfe0(0x274),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x2c3)](LTM_DP_DAILY_DIGESTS,{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x216),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x27c),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x151),'type':'string','role':_0xcfbfe0(0x274),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x138),{'type':'state','common':{'name':'Thermodynamics','type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0xc9aa9b['setObjectNotExistsAsync']('analysis.trigger',{'type':'state','common':{'name':_0xcfbfe0(0x224),'type':'boolean','role':_0xcfbfe0(0x1f9),'read':!![],'write':!![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x2a4),{'type':_0xcfbfe0(0x2b1),'common':{'name':'Trigger\x20Briefing','type':_0xcfbfe0(0x19d),'role':_0xcfbfe0(0x1f9),'read':!![],'write':!![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x2a0),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x2b3),'type':'boolean','role':_0xcfbfe0(0x249),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x101),{'type':'state','common':{'name':_0xcfbfe0(0x10d),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x28c),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x266),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1fa),'type':'string','role':_0xcfbfe0(0x1fd),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x1dd),{'type':_0xcfbfe0(0x2b1),'common':{'name':'Pattern\x20Detected','type':_0xcfbfe0(0x19d),'role':_0xcfbfe0(0x17f),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x261),{'type':'state','common':{'name':_0xcfbfe0(0x201),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x1fd),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('analysis.automation.detectedPatterns',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x225),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x274),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)]('analysis.automation.targetId',{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x204),'type':_0xcfbfe0(0x2c1),'role':_0xcfbfe0(0x1fd),'read':!![],'write':![]},'native':{}}),await _0xc9aa9b['setObjectNotExistsAsync'](_0xcfbfe0(0x146),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x27e),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0xc9aa9b['setObjectNotExistsAsync'](_0xcfbfe0(0x1ff),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1f6),'type':'boolean','role':_0xcfbfe0(0x13b),'read':!![],'write':!![]},'native':{}}),await _0xc9aa9b[_0xcfbfe0(0x24e)](_0xcfbfe0(0x294),{'type':_0xcfbfe0(0x2b1),'common':{'name':_0xcfbfe0(0x1e6),'type':'boolean','role':_0xcfbfe0(0x1f9),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x5bd238){const _0x1dfad0=a0_0x522117;try{const _0x2a6295=await _0x5bd238[_0x1dfad0(0x26b)](SYSTEM_DP_MODE);_0x2a6295&&_0x2a6295[_0x1dfad0(0x279)]&&Object[_0x1dfad0(0x190)](SYSTEM_MODES)[_0x1dfad0(0x280)](_0x2a6295['val'])?_0x5bd238[_0x1dfad0(0x187)]=_0x2a6295[_0x1dfad0(0x279)]:(_0x5bd238[_0x1dfad0(0x187)]=SYSTEM_MODES[_0x1dfad0(0x2ad)],await _0x5bd238[_0x1dfad0(0x125)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1dfad0(0x2ad)],'ack':!![]}));}catch(_0x156c85){_0x5bd238[_0x1dfad0(0x187)]=SYSTEM_MODES[_0x1dfad0(0x2ad)];}}async function loadRawEventLog(_0x43d1f2){const _0x29c55f=a0_0x522117;try{const _0x505542=await _0x43d1f2[_0x29c55f(0x26b)](LTM_DP_RAW_LOG);if(_0x505542&&_0x505542['val'])_0x43d1f2[_0x29c55f(0x24b)]=JSON[_0x29c55f(0x1de)](_0x505542[_0x29c55f(0x279)]);}catch(_0x234ec5){_0x43d1f2['rawEventLog']=[];}}async function saveRawEventLog(_0xa93f5e){const _0x1e7822=a0_0x522117;if(_0xa93f5e[_0x1e7822(0x24b)][_0x1e7822(0x107)]>RAW_LOG_MAX_SIZE)_0xa93f5e[_0x1e7822(0x24b)][_0x1e7822(0x246)](0x0,_0xa93f5e[_0x1e7822(0x24b)][_0x1e7822(0x107)]-RAW_LOG_MAX_SIZE);await _0xa93f5e['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x1e7822(0x100)](_0xa93f5e['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x5ef5b2){const _0x489f3c=a0_0x522117;try{const _0x223bcf=await _0x5ef5b2['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x223bcf&&_0x223bcf['val'])_0x5ef5b2[_0x489f3c(0x209)]=JSON[_0x489f3c(0x1de)](_0x223bcf[_0x489f3c(0x279)]);}catch(_0x2e1cc3){_0x5ef5b2[_0x489f3c(0x209)]=[];}await updateBaselineStatus(_0x5ef5b2);}async function saveDailyDigests(_0x48547a,_0x1ae1fa=!![]){const _0x5e9a90=a0_0x522117,_0x21bb35=_0x48547a[_0x5e9a90(0x1b6)][_0x5e9a90(0x1cc)]||0x3c;_0x48547a['dailyDigests'][_0x5e9a90(0x107)]>_0x21bb35&&_0x48547a[_0x5e9a90(0x209)]['splice'](0x0,_0x48547a[_0x5e9a90(0x209)][_0x5e9a90(0x107)]-_0x21bb35);await _0x48547a['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5e9a90(0x100)](_0x48547a[_0x5e9a90(0x209)]),'ack':!![]});if(_0x1ae1fa)await updateBaselineStatus(_0x48547a);}async function updateAnalysisHistory(_0x3911f9,_0x24350f){const _0x5e3151=a0_0x522117;_0x3911f9[_0x5e3151(0x1f5)][_0x5e3151(0x117)](_0x24350f);if(_0x3911f9[_0x5e3151(0x1f5)][_0x5e3151(0x107)]>HISTORY_MAX_SIZE)_0x3911f9[_0x5e3151(0x1f5)][_0x5e3151(0x264)]();await _0x3911f9['setStateAsync'](_0x5e3151(0x2a9),{'val':JSON[_0x5e3151(0x100)](_0x3911f9[_0x5e3151(0x1f5)]),'ack':!![]});}async function updateBaselineStatus(_0x1439a0){const _0x4e7e6f=a0_0x522117;if(!_0x1439a0[_0x4e7e6f(0x1e5)]){await _0x1439a0[_0x4e7e6f(0x125)](LTM_DP_BASELINE_STATUS,{'val':_0x4e7e6f(0x22b),'ack':!![]});return;}const _0x4a49c8=_0x1439a0[_0x4e7e6f(0x209)][_0x4e7e6f(0x107)]>=(_0x1439a0[_0x4e7e6f(0x1b6)][_0x4e7e6f(0x20e)]||0x7)?_0x4e7e6f(0x2a6)+_0x1439a0[_0x4e7e6f(0x209)][_0x4e7e6f(0x107)]+'\x20Tage)':_0x4e7e6f(0x15e)+_0x1439a0['dailyDigests'][_0x4e7e6f(0x107)]+'/'+(_0x1439a0[_0x4e7e6f(0x1b6)]['minDaysForBaseline']||0x7)+')';await _0x1439a0[_0x4e7e6f(0x125)](LTM_DP_BASELINE_STATUS,{'val':_0x4a49c8,'ack':!![]});}async function initSensorSubscriptions(_0x4adcd4){const _0x59086d=a0_0x522117,_0x514f99=_0x4adcd4[_0x59086d(0x1b6)]['devices'];if(_0x514f99)for(const _0xb4a7ed of _0x514f99){await _0x4adcd4[_0x59086d(0x202)](_0xb4a7ed['id']);}}async function initPresenceSubscriptions(_0x5dceca){const _0x3bcb32=a0_0x522117,_0x584c91=_0x5dceca[_0x3bcb32(0x1b6)][_0x3bcb32(0x17d)];if(_0x584c91)for(const _0x21a91b of _0x584c91){await _0x5dceca[_0x3bcb32(0x202)](_0x21a91b);}}async function setupTelegramListener(_0x3f9a58){const _0x5b7fd6=a0_0x522117,_0xd5235a=_0x3f9a58[_0x5b7fd6(0x1b6)][_0x5b7fd6(0x25a)];if(_0x3f9a58['config']['notifyTelegramEnabled']&&_0xd5235a)await _0x3f9a58[_0x5b7fd6(0x202)](_0xd5235a+'.communicate.request');}async function checkWifiPresence(_0x5e4aac){const _0x55b954=a0_0x522117;try{const _0x280602=_0x5e4aac[_0x55b954(0x1b6)][_0x55b954(0x17d)]||[];let _0x1b889c=![];const _0x377991=[];for(const _0xfa0da of _0x280602){try{const _0x452f8d=await _0x5e4aac[_0x55b954(0x156)](_0xfa0da);_0x452f8d&&(_0x452f8d[_0x55b954(0x279)]===!![]||_0x452f8d[_0x55b954(0x279)]===_0x55b954(0x135)||_0x452f8d[_0x55b954(0x279)]===0x1)&&(_0x1b889c=!![],_0x377991['push'](_0xfa0da));}catch(_0x53fc42){}}return await _0x5e4aac[_0x55b954(0x125)]('system.presenceWho',{'val':_0x377991[_0x55b954(0x1eb)](',\x20'),'ack':!![]}),_0x1b889c&&(_0x5e4aac[_0x55b954(0x284)]&&(_0x5e4aac[_0x55b954(0x143)][_0x55b954(0x118)](_0x55b954(0x2ac)),abortExitTimer(_0x5e4aac)),!_0x5e4aac[_0x55b954(0x1ca)]&&_0x5e4aac['currentSystemMode']===SYSTEM_MODES['NORMAL']&&await setPresence(_0x5e4aac,!![])),_0x1b889c;}catch(_0x419242){return![];}}function startExitTimer(_0x4fa756){const _0x54a775=a0_0x522117;abortExitTimer(_0x4fa756),_0x4fa756[_0x54a775(0x12a)]=!![],_0x4fa756['exitGraceTimer']=setTimeout(()=>{_0x4fa756['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4fa756[_0x54a775(0x284)]=setTimeout(()=>{const _0x2d377d=_0x54a775;setPresence(_0x4fa756,![]),_0x4fa756[_0x2d377d(0x284)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x35f5d8){const _0x5d924d=a0_0x522117;if(_0x35f5d8[_0x5d924d(0x284)])clearTimeout(_0x35f5d8[_0x5d924d(0x284)]);if(_0x35f5d8[_0x5d924d(0x2b6)])clearTimeout(_0x35f5d8[_0x5d924d(0x2b6)]);_0x35f5d8[_0x5d924d(0x284)]=null,_0x35f5d8['exitGraceTimer']=null,_0x35f5d8['isGracePeriodActive']=![];}async function setPresence(_0x4fa435,_0x1c4dfd){const _0x2d23bd=a0_0x522117;if(_0x4fa435[_0x2d23bd(0x1ca)]===_0x1c4dfd)return;_0x4fa435[_0x2d23bd(0x1ca)]=_0x1c4dfd,await _0x4fa435[_0x2d23bd(0x125)](_0x2d23bd(0x147),{'val':_0x1c4dfd,'ack':!![]});}async function executeAutomationAction(_0x3724f6){const _0x4b54f6=a0_0x522117;try{const _0xe9fcd5=await _0x3724f6[_0x4b54f6(0x26b)](_0x4b54f6(0x124)),_0x203158=await _0x3724f6[_0x4b54f6(0x26b)](_0x4b54f6(0x146));if(_0xe9fcd5&&_0xe9fcd5[_0x4b54f6(0x279)]&&_0x203158){const _0x5a505b=_0xe9fcd5[_0x4b54f6(0x279)];let _0x5a587c=_0x203158['val'];try{_0x5a587c=JSON[_0x4b54f6(0x1de)](_0x5a587c);}catch(_0x546374){}_0x3724f6['log'][_0x4b54f6(0x118)](_0x4b54f6(0x23a)+_0x5a505b+_0x4b54f6(0x195)+_0x5a587c),await _0x3724f6[_0x4b54f6(0x163)](_0x5a505b,_0x5a587c);}else _0x3724f6['log']['warn'](_0x4b54f6(0x29a));}catch(_0x1cfd1d){_0x3724f6[_0x4b54f6(0x143)][_0x4b54f6(0x2a7)](_0x4b54f6(0x20b)+_0x1cfd1d[_0x4b54f6(0x164)]);}}async function processSensorEvent(_0x542455,_0x28a5ee,_0x391ebd,_0x5bd5af){const _0xb546f=a0_0x522117;if(!_0x5bd5af)return;const _0x244de=_0x391ebd[_0xb546f(0x279)],_0x1f9882=Date[_0xb546f(0x106)](),_0x373e87=_0x542455[_0xb546f(0x23b)][_0x28a5ee];_0x542455[_0xb546f(0x23b)][_0x28a5ee]=_0x244de;if(!_0x5bd5af[_0xb546f(0x1a9)]&&_0x373e87!=undefined&&_0x373e87==_0x244de)return;const _0x40d8d9=(_0x5bd5af[_0xb546f(0x251)]||'')['toLowerCase'](),_0x1af5ea=_0x40d8d9[_0xb546f(0x280)](_0xb546f(0x1b0))||_0x40d8d9['includes'](_0xb546f(0x22d))||_0x40d8d9[_0xb546f(0x280)]('klima')||_0x40d8d9[_0xb546f(0x280)]('heizung');_0x542455[_0xb546f(0x1e5)]&&_0x1af5ea&&recordThermodynamics(_0x542455,_0x28a5ee,_0x244de,_0x5bd5af[_0xb546f(0x254)]);const _0x239c4d={'timestamp':_0x1f9882,'id':_0x28a5ee,'name':_0x5bd5af['name'],'type':_0x5bd5af[_0xb546f(0x251)],'location':_0x5bd5af[_0xb546f(0x254)],'value':_0x244de};_0x542455[_0xb546f(0x275)][_0xb546f(0x117)](_0x239c4d);if(_0x542455['eventHistory']['length']>HISTORY_MAX_SIZE)_0x542455[_0xb546f(0x275)][_0xb546f(0x264)]();await _0x542455[_0xb546f(0x125)](_0xb546f(0x21c),{'val':JSON[_0xb546f(0x100)](_0x239c4d),'ack':!![]}),await _0x542455[_0xb546f(0x125)]('events.history',{'val':JSON[_0xb546f(0x100)](_0x542455['eventHistory']),'ack':!![]});_0x542455[_0xb546f(0x1e5)]&&(_0x542455[_0xb546f(0x24b)][_0xb546f(0x27b)](_0x239c4d),await saveRawEventLog(_0x542455),recordSequence(_0x542455,_0x239c4d));if(_0x5bd5af[_0xb546f(0x179)]&&_0x244de===!![]){if(_0x542455['isPresent']&&!_0x542455[_0xb546f(0x12a)])startExitTimer(_0x542455);else{if(!_0x542455[_0xb546f(0x1ca)])setPresence(_0x542455,!![]);}}else{if(_0x5bd5af[_0xb546f(0x251)]===_0xb546f(0x1f0)&&_0x244de===!![]){if(_0x542455['exitTimer'])abortExitTimer(_0x542455);if(!_0x542455[_0xb546f(0x1ca)]&&_0x542455['currentSystemMode']===SYSTEM_MODES[_0xb546f(0x2ad)])setPresence(_0x542455,!![]);}}}async function recordThermodynamics(_0x22f307,_0x259215,_0x4d2b90,_0x3a0cd9){const _0x264ffc=a0_0x522117,_0x1e5480=await getOutsideTemperatureNumeric(_0x22f307),_0x5a7c5e=await _0x22f307['getStateAsync'](_0x264ffc(0x138));let _0x2098e5=[];if(_0x5a7c5e&&_0x5a7c5e['val'])try{_0x2098e5=JSON[_0x264ffc(0x1de)](_0x5a7c5e[_0x264ffc(0x279)]);}catch(_0x2c729d){}_0x2098e5[_0x264ffc(0x27b)]({'ts':Date[_0x264ffc(0x106)](),'room':_0x3a0cd9||_0x264ffc(0x1fe),'t_in':_0x4d2b90,'t_out':_0x1e5480});if(_0x2098e5[_0x264ffc(0x107)]>THERMO_LOG_SIZE)_0x2098e5[_0x264ffc(0x140)]();await _0x22f307[_0x264ffc(0x125)]('LTM.trainingData.thermodynamics',{'val':JSON[_0x264ffc(0x100)](_0x2098e5),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x4cc698){const _0x413072=a0_0x522117;if(_0x4cc698[_0x413072(0x1b6)][_0x413072(0x28b)])try{const _0x4caccc=await _0x4cc698[_0x413072(0x156)](_0x4cc698['config'][_0x413072(0x28b)]);if(_0x4caccc&&_0x4caccc[_0x413072(0x279)]!==undefined&&_0x4caccc[_0x413072(0x279)]!==null)return parseFloat(_0x4caccc[_0x413072(0x279)]);}catch(_0x261eff){}const _0x2a9787=_0x4cc698[_0x413072(0x1b6)][_0x413072(0x2bd)];if(!_0x4cc698[_0x413072(0x1b6)]['useWeather']||!_0x2a9787)return null;try{let _0x2676c3='';if(_0x2a9787[_0x413072(0x280)]('accuweather'))_0x2676c3=_0x2a9787+_0x413072(0x269);else{if(_0x2a9787['includes']('daswetter'))_0x2676c3=_0x2a9787+_0x413072(0x12f);else{if(_0x2a9787['includes'](_0x413072(0x10b)))_0x2676c3=_0x2a9787+'.forecast.current.temperature';else{if(_0x2a9787[_0x413072(0x280)](_0x413072(0x128)))_0x2676c3=_0x2a9787+_0x413072(0x1ad);}}}if(_0x2676c3){const _0x413971=await _0x4cc698['getForeignStateAsync'](_0x2676c3);if(_0x413971&&_0x413971[_0x413072(0x279)]!==undefined&&_0x413971[_0x413072(0x279)]!==null)return parseFloat(_0x413971[_0x413072(0x279)]);}}catch(_0x1f1791){}return null;}async function recordSequence(_0x5d3d9f,_0x1390d7){const _0x350b68=a0_0x522117,_0x16884d=(_0x1390d7[_0x350b68(0x251)]||'')[_0x350b68(0x1f7)](),_0x50e445=['motion',_0x350b68(0x2c0),_0x350b68(0x1b3),'presence','occupancy',_0x350b68(0x1b2),_0x350b68(0x2a8),_0x350b68(0x1b1),'fenster',_0x350b68(0x18c),'kontakt','light',_0x350b68(0x1dc),_0x350b68(0x13b),_0x350b68(0x133),_0x350b68(0x1c6),_0x350b68(0x11c)];if(!_0x50e445['some'](_0x5c3482=>_0x16884d[_0x350b68(0x280)](_0x5c3482)))return;if(!_0x1390d7[_0x350b68(0x183)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x350b68(0x27b)]({'loc':_0x1390d7[_0x350b68(0x254)]||'Unknown','id':_0x1390d7['id'],'ts':Date[_0x350b68(0x106)]()}),sequenceTimer=setTimeout(async()=>{const _0x127a6c=_0x350b68;if(activeSequence[_0x127a6c(0x107)]>0x1)await saveCompletedSequence(_0x5d3d9f);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x1b3c93){const _0x5b7b8d=a0_0x522117;try{const _0x4c204f=await _0x1b3c93[_0x5b7b8d(0x26b)](_0x5b7b8d(0x27c));let _0x52e0d3=[];if(_0x4c204f&&_0x4c204f[_0x5b7b8d(0x279)])try{_0x52e0d3=JSON[_0x5b7b8d(0x1de)](_0x4c204f[_0x5b7b8d(0x279)]);}catch(_0x1dd378){}const _0x17a152=activeSequence[0x0]['ts'],_0x593fed=activeSequence['map'](_0x2f7f89=>({'loc':_0x2f7f89[_0x5b7b8d(0x27a)],'t_delta':Math[_0x5b7b8d(0x167)]((_0x2f7f89['ts']-_0x17a152)/0x3e8)})),_0x2171f7={'timestamp':new Date(_0x17a152)['toISOString'](),'steps':_0x593fed,'duration':Math[_0x5b7b8d(0x167)]((activeSequence[activeSequence[_0x5b7b8d(0x107)]-0x1]['ts']-_0x17a152)/0x3e8),'daytime':new Date(_0x17a152)['getHours']()};_0x52e0d3[_0x5b7b8d(0x27b)](_0x2171f7);if(_0x52e0d3[_0x5b7b8d(0x107)]>MAX_TRAINING_SET_SIZE)_0x52e0d3[_0x5b7b8d(0x140)]();await _0x1b3c93['setStateAsync'](_0x5b7b8d(0x27c),{'val':JSON[_0x5b7b8d(0x100)](_0x52e0d3),'ack':!![]}),runSecurityCheck(_0x1b3c93,_0x2171f7);}catch(_0x55ffe7){_0x1b3c93[_0x5b7b8d(0x143)][_0x5b7b8d(0x2a7)](_0x5b7b8d(0x212)+_0x55ffe7[_0x5b7b8d(0x164)]);}}function runSecurityCheck(_0x20b73c,_0x323164){const _0x4a9133=a0_0x522117;if(!_0x20b73c[_0x4a9133(0x1e5)])return;sendToPython(_0x20b73c,_0x4a9133(0x20f),{'sequence':_0x323164});}function sendToPython(_0x2e9af4,_0x340f09,_0x204274={}){const _0x4a3d74=a0_0x522117;if(!_0x2e9af4[_0x4a3d74(0x2be)]||!_0x2e9af4[_0x4a3d74(0x2be)][_0x4a3d74(0x18a)][_0x4a3d74(0x14f)])return;const _0x3d49c8=JSON['stringify']({'command':_0x340f09,..._0x204274});try{_0x2e9af4[_0x4a3d74(0x2be)][_0x4a3d74(0x18a)][_0x4a3d74(0x129)](_0x3d49c8+'\x0a');}catch(_0x381e48){}}function startPythonService(_0x2d8e57){const _0x124e04=a0_0x522117;let _0x17bf93=_0x124e04(0x28e);if(fs[_0x124e04(0x222)](PYTHON_EXE))_0x17bf93=PYTHON_EXE;try{const _0x5d617a=path[_0x124e04(0x1eb)](__dirname,_0x124e04(0x1f2),'service.py');_0x2d8e57[_0x124e04(0x2be)]=spawn(_0x17bf93,[_0x5d617a]),_0x2d8e57[_0x124e04(0x2be)][_0x124e04(0x2ae)]['on'](_0x124e04(0x111),_0x55cb18=>{const _0x154597=_0x124e04,_0x4e551d=_0x55cb18[_0x154597(0x250)]()[_0x154597(0x12d)]('\x0a');_0x4e551d[_0x154597(0x1c8)](_0x234480=>{const _0x4ed227=_0x154597,_0x13409d=_0x234480['trim']();if(!_0x13409d)return;if(_0x13409d[_0x4ed227(0x2b9)](_0x4ed227(0x1f1)))_0x2d8e57[_0x4ed227(0x143)][_0x4ed227(0x1be)]('[PYTHON]\x20'+_0x13409d[_0x4ed227(0x22f)](0x5)['trim']());else{if(_0x13409d[_0x4ed227(0x2b9)](_0x4ed227(0x1ac)))try{const _0x113238=JSON[_0x4ed227(0x1de)](_0x13409d[_0x4ed227(0x22f)](0x8)[_0x4ed227(0x139)]());handlePythonResult(_0x2d8e57,_0x113238);}catch(_0x17dcae){}}});}),_0x2d8e57[_0x124e04(0x2be)]['on'](_0x124e04(0x130),_0x3b055a=>{const _0x5e0668=_0x124e04;_0x2d8e57[_0x5e0668(0x2be)]=null;});}catch(_0x3c6718){_0x2d8e57[_0x124e04(0x143)][_0x124e04(0x2a7)](_0x124e04(0x132)+_0x3c6718[_0x124e04(0x164)]);}}function stopPythonService(_0x17d295){const _0x406bc6=a0_0x522117;if(_0x17d295[_0x406bc6(0x2be)]){try{_0x17d295[_0x406bc6(0x2be)]['kill']();}catch(_0x3f3926){}_0x17d295['pythonProcess']=null;}}function handlePythonResult(_0x1653ad,_0x44b19a){const _0x59d574=a0_0x522117;if(_0x44b19a[_0x59d574(0x251)]===_0x59d574(0x172))_0x1653ad[_0x59d574(0x143)][_0x59d574(0x1be)](_0x59d574(0x116));else{if(_0x44b19a[_0x59d574(0x251)]==='SECURITY_RESULT'){const {anomaly_score:_0xdb1d80,is_anomaly:_0x51085c,threshold:_0x4a7dd5,explanation:_0x4e07c5}=_0x44b19a[_0x59d574(0x23d)];_0x1653ad[_0x59d574(0x143)]['info']('üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20'+_0xdb1d80[_0x59d574(0x14e)](0x5)+_0x59d574(0x2bf)+(_0x51085c?'ANOMALY':'OK')),_0x1653ad['setStateAsync'](_0x59d574(0x27d),{'val':_0xdb1d80,'ack':!![]}),_0x1653ad[_0x59d574(0x125)](_0x59d574(0x112),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x4a7dd5)_0x1653ad['setStateAsync']('analysis.security.currentThreshold',{'val':_0x4a7dd5,'ack':!![]});if(_0x51085c){let _0x431a30=_0x59d574(0x259)+_0xdb1d80[_0x59d574(0x14e)](0x4)+')';if(_0x4e07c5&&_0x4e07c5!==_0x59d574(0x1fe))_0x431a30+='\x0aGrund:\x20'+_0x4e07c5;_0x1653ad[_0x59d574(0x125)](_0x59d574(0x2a0),{'val':!![],'ack':!![]}),_0x1653ad[_0x59d574(0x125)]('analysis.alertReason',{'val':_0x431a30,'ack':!![]}),sendNotification(_0x1653ad,'‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20'+_0x431a30,![],!![]);}}else{if(_0x44b19a['type']==='TRAINING_COMPLETE'){const _0xeda335=_0x44b19a[_0x59d574(0x23d)]['details']||'',_0x20e7bd=_0x44b19a[_0x59d574(0x23d)][_0x59d574(0x153)],_0x97f739=_0x44b19a[_0x59d574(0x23d)][_0x59d574(0x21e)]?_0x59d574(0x265)+new Date()['toLocaleTimeString']()+'\x20('+_0xeda335+')':'Failed:\x20'+_0x44b19a[_0x59d574(0x23d)][_0x59d574(0x109)];_0x1653ad[_0x59d574(0x125)]('analysis.training.status',{'val':_0x97f739,'ack':!![]});if(_0x44b19a[_0x59d574(0x23d)][_0x59d574(0x21e)]&&_0x20e7bd)_0x1653ad[_0x59d574(0x125)](_0x59d574(0x142),{'val':_0x20e7bd,'ack':!![]});}else{if(_0x44b19a['type']===_0x59d574(0x144)){const {patterns:_0x4ca853}=_0x44b19a[_0x59d574(0x23d)];if(_0x4ca853&&_0x4ca853[_0x59d574(0x107)]>0x0){_0x1653ad[_0x59d574(0x143)][_0x59d574(0x118)](_0x59d574(0x241)+_0x4ca853[_0x59d574(0x107)]+_0x59d574(0x1a6)),_0x1653ad['setStateAsync'](_0x59d574(0x1af),{'val':JSON[_0x59d574(0x100)](_0x4ca853),'ack':!![]});const _0x153c49=_0x4ca853[0x0],_0x10878c=_0x59d574(0x1f8)+_0x153c49[_0x59d574(0x166)]+'\x20('+(_0x153c49[_0x59d574(0x215)]*0x64)[_0x59d574(0x14e)](0x0)+'%)';_0x1653ad['setStateAsync'](_0x59d574(0x1dd),{'val':!![],'ack':!![]}),_0x1653ad['setStateAsync'](_0x59d574(0x261),{'val':_0x10878c,'ack':!![]});}else _0x1653ad[_0x59d574(0x143)][_0x59d574(0x118)](_0x59d574(0x17a)),_0x1653ad[_0x59d574(0x125)](_0x59d574(0x1dd),{'val':![],'ack':!![]}),_0x1653ad['setStateAsync']('analysis.automation.detectedPatterns',{'val':'[]','ack':!![]});}else{if(_0x44b19a['type']===_0x59d574(0x276)){if(_0x44b19a['payload'][_0x59d574(0x21e)])try{const _0x41a11d=JSON['parse'](_0x44b19a[_0x59d574(0x23d)][_0x59d574(0x1fc)]);if(_0x41a11d[_0x59d574(0x105)])_0x1653ad[_0x59d574(0x125)](_0x59d574(0x119),{'val':JSON[_0x59d574(0x100)](_0x41a11d['insulation']),'ack':!![]});if(_0x41a11d[_0x59d574(0x1aa)])_0x1653ad[_0x59d574(0x125)](_0x59d574(0x239),{'val':JSON[_0x59d574(0x100)](_0x41a11d[_0x59d574(0x1aa)]),'ack':!![]});}catch(_0x53e03e){}}else{if(_0x44b19a[_0x59d574(0x251)]==='HEALTH_TRAIN_RESULT'){if(_0x44b19a[_0x59d574(0x23d)][_0x59d574(0x21e)])_0x1653ad[_0x59d574(0x143)][_0x59d574(0x118)](_0x59d574(0x13e));}else{if(_0x44b19a['type']==='HEALTH_RESULT')_0x1653ad[_0x59d574(0x125)](_0x59d574(0x229),{'val':new Date()['toISOString'](),'ack':!![]}),_0x1653ad['setStateAsync']('analysis.health.isAnomaly',{'val':_0x44b19a['payload'][_0x59d574(0x186)],'ack':!![]});else{if(_0x44b19a[_0x59d574(0x251)]===_0x59d574(0x227))_0x1653ad[_0x59d574(0x125)](_0x59d574(0x2bc),{'val':_0x44b19a[_0x59d574(0x23d)][_0x59d574(0x283)],'ack':!![]}),_0x1653ad[_0x59d574(0x125)](_0x59d574(0x242),{'val':_0x44b19a[_0x59d574(0x23d)][_0x59d574(0x11a)],'ack':!![]});else{if(_0x44b19a[_0x59d574(0x251)]===_0x59d574(0x25c)){const {speed_trend:_0x5822a7}=_0x44b19a[_0x59d574(0x23d)];_0x5822a7!==undefined&&_0x1653ad[_0x59d574(0x125)](_0x59d574(0x1d3),{'val':_0x5822a7,'ack':!![]});}else{if(_0x44b19a[_0x59d574(0x251)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x3f0c22}=_0x44b19a[_0x59d574(0x23d)];_0x3f0c22&&_0x1653ad['setStateAsync'](_0x59d574(0x208),{'val':JSON[_0x59d574(0x100)](_0x3f0c22),'ack':!![]});}else{if(_0x44b19a['type']===_0x59d574(0x174)){const {data:_0x1520b1}=_0x44b19a[_0x59d574(0x23d)];_0x1520b1&&(_0x1653ad[_0x59d574(0x143)][_0x59d574(0x118)](_0x59d574(0x2a3)),_0x1653ad['setStateAsync']('analysis.security.topologyMatrix',{'val':JSON[_0x59d574(0x100)](_0x1520b1),'ack':!![]}));}}}}}}}}}}}}function runPythonHealthCheck(_0x2d1c23){const _0x350e20=a0_0x522117;if(!_0x2d1c23[_0x350e20(0x209)]||_0x2d1c23[_0x350e20(0x209)][_0x350e20(0x107)]<0x2)return;const _0x5601b4=_0x2d1c23[_0x350e20(0x209)][_0x350e20(0x21a)](_0x249a7d=>{const _0xf8bbb5=_0x350e20,_0x5422c4=(_0x249a7d[_0xf8bbb5(0x1b7)]||'')[_0xf8bbb5(0x1f7)]();return ACTIVITY_LEVEL_MAP[_0x5422c4]||0x32;});sendToPython(_0x2d1c23,_0x350e20(0x1a1),{'values':_0x5601b4,'tag':_0x350e20(0x13f)});}async function handleTelegramResponse(_0x2de51a,_0xaf7da7){const _0x19eb39=a0_0x522117;let _0x24d1f3=_0xaf7da7;_0xaf7da7[_0x19eb39(0x2b9)]('[')&&(_0x24d1f3=_0xaf7da7[_0x19eb39(0x22f)](_0xaf7da7[_0x19eb39(0x1ec)](']')+0x1));if(_0x24d1f3==='COGNI_CONFIRM_OK')await _0x2de51a[_0x19eb39(0x125)](_0x19eb39(0x2a0),{'val':![],'ack':!![]}),await _0x2de51a[_0x19eb39(0x125)](_0x19eb39(0x101),{'val':_0x19eb39(0x145),'ack':!![]}),_0x2de51a[_0x19eb39(0x193)]=![],sendNotification(_0x2de51a,_0x19eb39(0x1ee),![]);else _0x24d1f3==='COGNI_REQUEST_CALL'&&sendNotification(_0x2de51a,_0x19eb39(0x203),![],!![]);}async function sendNotification(_0x12965f,_0x111416,_0x6eb1bb=![],_0x11c863=![]){const _0x5a47ef=a0_0x522117,_0x30cd48=_0x12965f['config'];if(_0x30cd48[_0x5a47ef(0x155)]){let _0x877283={};(_0x111416[_0x5a47ef(0x280)](_0x5a47ef(0x2c4))||_0x11c863)&&(_0x877283={'reply_markup':{'inline_keyboard':[[{'text':_0x5a47ef(0x149),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':'üìû\x20R√ºckruf\x20anfordern','callback_data':_0x5a47ef(0x176)}]]}}),await _0x12965f['sendToAsync'](_0x30cd48['notifyTelegramInstance'],_0x5a47ef(0x11b),{'text':_0x111416,'user':_0x30cd48[_0x5a47ef(0x22e)],..._0x877283});}if(_0x30cd48[_0x5a47ef(0x2b2)]){let _0x904ee2={'message':_0x111416,'title':_0x11c863?'üö®\x20EMERGENCY':_0x5a47ef(0x175),'priority':_0x11c863?0x2:0x1,'device':_0x30cd48[_0x5a47ef(0x219)]};_0x11c863&&(_0x904ee2[_0x5a47ef(0x1d2)]=0x1e,_0x904ee2['expire']=0xe10,_0x904ee2[_0x5a47ef(0x231)]='siren'),await _0x12965f[_0x5a47ef(0x165)](_0x30cd48[_0x5a47ef(0x1c5)],_0x5a47ef(0x11b),_0x904ee2);}_0x30cd48['notifyEmailEnabled']&&await _0x12965f['sendToAsync'](_0x30cd48[_0x5a47ef(0x29f)],_0x5a47ef(0x11b),{'text':_0x111416,'to':_0x30cd48[_0x5a47ef(0x262)]});}async function runGeminiAnalysis(_0x348cef,_0x25d90c=''){const _0x3028bc=a0_0x522117;if(!_0x348cef[_0x3028bc(0x127)])return;if(_0x348cef[_0x3028bc(0x275)]['length']===0x0)return;const _0x315f11=_0x348cef[_0x3028bc(0x275)][_0x3028bc(0x217)](0x0,0xf),_0x456071=await getWeatherContext(_0x348cef),_0x158cdb=_0x348cef[_0x3028bc(0x187)],_0x38b47a=PERSONA_MAPPING[_0x348cef[_0x3028bc(0x1b6)][_0x3028bc(0x192)]||'generic'],_0x33f242=_0x348cef[_0x3028bc(0x1b6)][_0x3028bc(0x122)]||_0x3028bc(0x1e9);let _0x18afca='Unbekannt';try{const _0x3cc4a5=await _0x348cef[_0x3028bc(0x26b)](_0x3028bc(0x213));if(_0x3cc4a5&&_0x3cc4a5[_0x3028bc(0x279)])_0x18afca=_0x3cc4a5[_0x3028bc(0x279)];}catch(_0x51aefa){}let _0x1bc8aa=![];try{const _0x47f724=await _0x348cef[_0x3028bc(0x26b)]('analysis.automation.autoApply');if(_0x47f724&&_0x47f724[_0x3028bc(0x279)])_0x1bc8aa=!![];}catch(_0x23f5d1){}const _0x3e69cb=_0x3028bc(0x10a)+_0x38b47a+_0x3028bc(0x273)+_0x33f242+_0x3028bc(0x181)+_0x158cdb+_0x3028bc(0x13d)+_0x456071+_0x3028bc(0x1c7)+_0x18afca+_0x3028bc(0x152)+JSON[_0x3028bc(0x100)](_0x315f11)+_0x3028bc(0x206)+_0x25d90c+_0x3028bc(0x1e2);try{const _0x432c36=await _0x348cef[_0x3028bc(0x127)][_0x3028bc(0x2bb)](_0x3e69cb),_0x2651d2=JSON[_0x3028bc(0x1de)](_0x432c36[_0x3028bc(0x226)][_0x3028bc(0x1fd)]()[_0x3028bc(0x134)](/```json|```/g,'')['trim']());await _0x348cef['setStateAsync'](_0x3028bc(0x1f4),{'val':JSON[_0x3028bc(0x100)](_0x2651d2),'ack':!![]});if(_0x2651d2['summary'])await _0x348cef[_0x3028bc(0x125)](_0x3028bc(0x266),{'val':_0x2651d2[_0x3028bc(0x103)],'ack':!![]});const _0x2ad69e={'timestamp':Date['now'](),'id':Date['now']()[_0x3028bc(0x250)](),'analysis':{'activity':{'summary':_0x2651d2['summary'],'isAlert':_0x2651d2[_0x3028bc(0x18e)],'alertReason':_0x2651d2[_0x3028bc(0x180)]},'comfort':{'automationProposal':_0x2651d2['automationProposal']}}};await updateAnalysisHistory(_0x348cef,_0x2ad69e);const _0x3094a4=_0x2651d2['isAlert']||![];_0x3094a4!==_0x348cef[_0x3028bc(0x193)]&&(await _0x348cef[_0x3028bc(0x125)](_0x3028bc(0x2a0),{'val':_0x3094a4,'ack':!![]}),_0x348cef[_0x3028bc(0x193)]=_0x3094a4,_0x3094a4&&(await _0x348cef[_0x3028bc(0x125)]('analysis.alertReason',{'val':_0x2651d2[_0x3028bc(0x180)],'ack':!![]}),sendNotification(_0x348cef,_0x3028bc(0x170)+_0x2651d2['alertReason'],![],_0x2651d2[_0x3028bc(0x230)])));if(_0x2651d2[_0x3028bc(0x150)]&&_0x2651d2['automationProposal'][_0x3028bc(0x1cf)]){await _0x348cef['setStateAsync'](_0x3028bc(0x1dd),{'val':!![],'ack':!![]}),await _0x348cef[_0x3028bc(0x125)](_0x3028bc(0x261),{'val':_0x2651d2['automationProposal']['description'],'ack':!![]}),await _0x348cef[_0x3028bc(0x125)](_0x3028bc(0x124),{'val':_0x2651d2[_0x3028bc(0x150)]['targetId'],'ack':!![]}),await _0x348cef[_0x3028bc(0x125)]('analysis.automation.targetValue',{'val':JSON['stringify'](_0x2651d2[_0x3028bc(0x150)][_0x3028bc(0x1a8)]),'ack':!![]});if(_0x1bc8aa)executeAutomationAction(_0x348cef);}}catch(_0x441a91){_0x348cef['log'][_0x3028bc(0x2a7)](_0x3028bc(0x2b5)+_0x441a91[_0x3028bc(0x164)]);}}async function createDailyDigest(_0x3dcf30){const _0x1e2fb5=a0_0x522117;if(!_0x3dcf30[_0x1e2fb5(0x1e5)])return;await _0x3dcf30[_0x1e2fb5(0x125)](LTM_DP_STATUS,{'val':_0x1e2fb5(0x2ba),'ack':!![]});if(!_0x3dcf30['geminiModel']||_0x3dcf30[_0x1e2fb5(0x24b)][_0x1e2fb5(0x107)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3dcf30[_0x1e2fb5(0x125)](LTM_DP_STATUS,{'val':_0x1e2fb5(0x197),'ack':!![]});return;}const _0x399c23=JSON[_0x1e2fb5(0x1de)](JSON['stringify'](_0x3dcf30['rawEventLog'])),_0x5cc4c5=_0x399c23[_0x1e2fb5(0x107)],_0x5a6903='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x1e2fb5(0x100)](_0x399c23);try{const _0x453c70=await _0x3dcf30[_0x1e2fb5(0x127)][_0x1e2fb5(0x2bb)](_0x5a6903),_0x51794e=JSON['parse'](_0x453c70[_0x1e2fb5(0x226)]['text']()[_0x1e2fb5(0x134)](/```json|```/g,'')[_0x1e2fb5(0x139)]()),_0x152789={'timestamp':new Date()[_0x1e2fb5(0x29b)](),'eventCount':_0x5cc4c5,'summary':_0x51794e[_0x1e2fb5(0x103)]||_0x1e2fb5(0x1a4),'activityLevel':_0x51794e[_0x1e2fb5(0x1b7)]||_0x1e2fb5(0x1ab),'systemMode':_0x3dcf30[_0x1e2fb5(0x187)]};_0x3dcf30[_0x1e2fb5(0x209)][_0x1e2fb5(0x27b)](_0x152789),await saveDailyDigests(_0x3dcf30),_0x3dcf30['rawEventLog']=[],await saveRawEventLog(_0x3dcf30),await _0x3dcf30[_0x1e2fb5(0x125)](LTM_DP_STATUS,{'val':_0x1e2fb5(0x1e0),'ack':!![]});if(_0x3dcf30[_0x1e2fb5(0x1e5)])sendToPython(_0x3dcf30,_0x1e2fb5(0x102),{'digest':_0x152789});}catch(_0x521a9b){_0x3dcf30['log'][_0x1e2fb5(0x2a7)](_0x521a9b[_0x1e2fb5(0x164)]);}}function setupLtmScheduler(_0x33f4f5){const _0x4ca7c2=a0_0x522117;try{if(_0x33f4f5[_0x4ca7c2(0x268)])_0x33f4f5[_0x4ca7c2(0x268)][_0x4ca7c2(0x20c)]();if(!_0x33f4f5[_0x4ca7c2(0x1e5)])return;_0x33f4f5[_0x4ca7c2(0x268)]=schedule[_0x4ca7c2(0x177)](LTM_SCHEDULE,()=>createDailyDigest(_0x33f4f5));}catch(_0x49eb93){_0x33f4f5['log'][_0x4ca7c2(0x2a7)](_0x4ca7c2(0x136)+_0x49eb93['message']);}}function setupModeResetScheduler(_0x3800ce){const _0x155bdb=a0_0x522117;try{if(_0x3800ce['modeResetJob'])_0x3800ce['modeResetJob'][_0x155bdb(0x20c)]();_0x3800ce[_0x155bdb(0x15a)]=schedule[_0x155bdb(0x177)](MODE_RESET_SCHEDULE,async()=>{const _0xb1dd51=_0x155bdb;await loadSystemMode(_0x3800ce),AUTO_RESET_MODES[_0xb1dd51(0x280)](_0x3800ce[_0xb1dd51(0x187)])&&await _0x3800ce[_0xb1dd51(0x125)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0xb1dd51(0x2ad)],'ack':![]});});}catch(_0x134196){_0x3800ce[_0x155bdb(0x143)][_0x155bdb(0x2a7)](_0x155bdb(0x247)+_0x134196['message']);}}function setupDriftAnalysisScheduler(_0x3d7fc0){const _0x9eb928=a0_0x522117;try{if(_0x3d7fc0[_0x9eb928(0x218)])clearInterval(_0x3d7fc0[_0x9eb928(0x218)]);if(!_0x3d7fc0['isProVersion'])return;_0x3d7fc0['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x3d7fc0),(_0x3d7fc0[_0x9eb928(0x1b6)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3d7fc0),0x1388);}catch(_0x349e7a){_0x3d7fc0['log'][_0x9eb928(0x2a7)](_0x9eb928(0x257)+_0x349e7a['message']);}}function setupBriefingScheduler(_0x5e5c99){const _0x29be42=a0_0x522117;try{if(_0x5e5c99[_0x29be42(0x169)])_0x5e5c99['briefingJob'][_0x29be42(0x20c)]();if(!_0x5e5c99[_0x29be42(0x1b6)][_0x29be42(0x296)])return;const _0x47791d=(_0x5e5c99[_0x29be42(0x1b6)][_0x29be42(0x22a)]||_0x29be42(0x205))[_0x29be42(0x12d)](':'),_0x33f0d2=parseInt(_0x47791d[0x0])||0x8,_0x738874=parseInt(_0x47791d[0x1])||0x0,_0x38fdc5=_0x738874+'\x20'+_0x33f0d2+'\x20*\x20*\x20*';_0x5e5c99[_0x29be42(0x169)]=schedule[_0x29be42(0x177)](_0x38fdc5,()=>{sendMorningBriefing(_0x5e5c99);});}catch(_0x3283bf){_0x5e5c99[_0x29be42(0x143)][_0x29be42(0x2a7)]('Briefing\x20Sched\x20Error:\x20'+_0x3283bf['message']);}}async function runBaselineDriftAnalysis(_0x41ffcc){const _0x2cc690=a0_0x522117;if(!_0x41ffcc[_0x2cc690(0x1e5)]||!_0x41ffcc[_0x2cc690(0x127)])return;const _0x5f1aeb=_0x41ffcc[_0x2cc690(0x1b6)][_0x2cc690(0x14c)]||0xe;if(_0x41ffcc[_0x2cc690(0x209)][_0x2cc690(0x107)]<_0x5f1aeb+0x7){await _0x41ffcc[_0x2cc690(0x125)](LTM_DP_DRIFT_STATUS,{'val':_0x2cc690(0x16d),'ack':!![]});return;}const _0x250857=_0x41ffcc[_0x2cc690(0x209)][_0x2cc690(0x217)](-_0x5f1aeb),_0x3e54af=_0x41ffcc['dailyDigests'][_0x2cc690(0x217)](0x0,_0x41ffcc[_0x2cc690(0x209)][_0x2cc690(0x107)]-_0x5f1aeb),_0x5619d8=_0x2cc690(0x1c1)+JSON[_0x2cc690(0x100)](_0x3e54af)+_0x2cc690(0x210)+JSON['stringify'](_0x250857);try{const _0x1ccfc3=await _0x41ffcc[_0x2cc690(0x127)][_0x2cc690(0x2bb)](_0x5619d8),_0x4f7401=JSON[_0x2cc690(0x1de)](_0x1ccfc3['response']['text']()[_0x2cc690(0x134)](/```json|```/g,'')[_0x2cc690(0x139)]());_0x4f7401[_0x2cc690(0x157)]&&(await _0x41ffcc[_0x2cc690(0x125)](LTM_DP_DRIFT_STATUS,{'val':_0x4f7401['baselineDrift'],'ack':!![]}),await _0x41ffcc['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x4f7401[_0x2cc690(0x287)],'ack':!![]}),await _0x41ffcc['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x2cc690(0x106)](),'ack':!![]}));}catch(_0x4b074e){}}class CogniLiving extends utils[a0_0x522117(0x16a)]{constructor(_0x12f30d){const _0xbd59cd=a0_0x522117;super({..._0x12f30d,'name':_0xbd59cd(0x1ba)}),this[_0xbd59cd(0x275)]=[],this[_0xbd59cd(0x1f5)]=[],this[_0xbd59cd(0x24b)]=[],this[_0xbd59cd(0x209)]=[],this[_0xbd59cd(0x23b)]={},this[_0xbd59cd(0x25f)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0xbd59cd(0x1ca)]=!![],this[_0xbd59cd(0x284)]=null,this['exitGraceTimer']=null,this[_0xbd59cd(0x12a)]=![],this[_0xbd59cd(0x1e8)]=null,this[_0xbd59cd(0x127)]=null,this[_0xbd59cd(0x187)]=SYSTEM_MODES[_0xbd59cd(0x2ad)],this[_0xbd59cd(0x1e5)]=![],this[_0xbd59cd(0x193)]=![],this[_0xbd59cd(0x2aa)]=_0xbd59cd(0x1ef),this[_0xbd59cd(0x131)]=null,this[_0xbd59cd(0x268)]=null,this[_0xbd59cd(0x15a)]=null,this['driftAnalysisTimer']=null,this['briefingJob']=null,this[_0xbd59cd(0x2be)]=null,this[_0xbd59cd(0x298)]=![],this['on'](_0xbd59cd(0x240),this['onReady'][_0xbd59cd(0x199)](this)),this['on'](_0xbd59cd(0x1f3),this[_0xbd59cd(0x29e)]['bind'](this)),this['on'](_0xbd59cd(0x1ed),this[_0xbd59cd(0x22c)][_0xbd59cd(0x199)](this)),this['on'](_0xbd59cd(0x164),this[_0xbd59cd(0x2b0)]['bind'](this));}async['onReady'](){const _0x158bbd=a0_0x522117;this['log'][_0x158bbd(0x118)](_0x158bbd(0x1d6)+this['version']+_0x158bbd(0xfd));if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x522117(0x22c)](_0xa6190e){const _0x2743ee=a0_0x522117;if(this[_0x2743ee(0x131)])clearInterval(this[_0x2743ee(0x131)]);if(this[_0x2743ee(0x218)])clearInterval(this['driftAnalysisTimer']);if(this[_0x2743ee(0x268)])this[_0x2743ee(0x268)][_0x2743ee(0x20c)]();if(this[_0x2743ee(0x15a)])this['modeResetJob'][_0x2743ee(0x20c)]();if(this[_0x2743ee(0x169)])this[_0x2743ee(0x169)]['cancel']();if(this[_0x2743ee(0x284)])clearTimeout(this[_0x2743ee(0x284)]);if(this[_0x2743ee(0x2b6)])clearTimeout(this[_0x2743ee(0x2b6)]);stopPythonService(this),_0xa6190e();}async[a0_0x522117(0x29e)](_0x5b12cd,_0x57e3d4){const _0xb6647a=a0_0x522117;if(!_0x57e3d4||this['dependencyInstallInProgress'])return;if(_0x5b12cd['includes']('telegram')&&_0x5b12cd['endsWith'](_0xb6647a(0x1b9))&&_0x57e3d4[_0xb6647a(0x279)]){await handleTelegramResponse(this,_0x57e3d4[_0xb6647a(0x279)]);return;}if(_0x5b12cd===this[_0xb6647a(0x228)]+'.'+SYSTEM_DP_MODE){if(_0x57e3d4[_0xb6647a(0x279)]&&Object[_0xb6647a(0x190)](SYSTEM_MODES)[_0xb6647a(0x280)](_0x57e3d4[_0xb6647a(0x279)])){this[_0xb6647a(0x187)]=_0x57e3d4[_0xb6647a(0x279)];if(_0x57e3d4[_0xb6647a(0x279)]===SYSTEM_MODES[_0xb6647a(0x1a7)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x57e3d4[_0xb6647a(0x17c)])this[_0xb6647a(0xff)](_0x5b12cd,{'val':this[_0xb6647a(0x187)],'ack':!![]});return;}if(!_0x57e3d4['ack']){_0x5b12cd[_0xb6647a(0x280)](_0xb6647a(0x1d8))&&_0x57e3d4['val']&&(this['setState'](_0x5b12cd,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x5b12cd[_0xb6647a(0x280)](_0xb6647a(0x293))&&_0x57e3d4[_0xb6647a(0x279)]){this[_0xb6647a(0xff)](_0x5b12cd,{'val':![],'ack':!![]});if(this[_0xb6647a(0x1e5)])createDailyDigest(this);}_0x5b12cd['includes'](_0xb6647a(0x17e))&&_0x57e3d4[_0xb6647a(0x279)]&&(this[_0xb6647a(0xff)](_0x5b12cd,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x5b12cd[_0xb6647a(0x280)](_0xb6647a(0x28a))&&_0x57e3d4['val']&&(this['setState'](_0x5b12cd,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x5b12cd['includes'](_0xb6647a(0x278))&&_0x57e3d4[_0xb6647a(0x279)]){this[_0xb6647a(0xff)](_0x5b12cd,{'val':![],'ack':!![]});if(this[_0xb6647a(0x1e5)])try{const _0x13924e=await this[_0xb6647a(0x26b)](_0xb6647a(0x27c));if(_0x13924e&&_0x13924e[_0xb6647a(0x279)]){const _0x38a646=JSON[_0xb6647a(0x1de)](_0x13924e['val']);this[_0xb6647a(0x143)]['info']('üß†\x20Triggering\x20Security\x20Training...'),this[_0xb6647a(0x125)]('analysis.training.status',{'val':_0xb6647a(0x292),'ack':!![]}),sendToPython(this,_0xb6647a(0x14a),{'sequences':_0x38a646});}}catch(_0x9671d2){this[_0xb6647a(0x143)][_0xb6647a(0x2a7)]('Training\x20Error:\x20'+_0x9671d2['message']);}}if(_0x5b12cd[_0xb6647a(0x280)](_0xb6647a(0x211))&&_0x57e3d4[_0xb6647a(0x279)]){this[_0xb6647a(0xff)](_0x5b12cd,{'val':![],'ack':!![]});if(this[_0xb6647a(0x1e5)])try{const _0x4647c0=await this[_0xb6647a(0x26b)](LTM_DP_DAILY_DIGESTS);if(_0x4647c0&&_0x4647c0[_0xb6647a(0x279)])sendToPython(this,_0xb6647a(0x28d),{'digests':JSON[_0xb6647a(0x1de)](_0x4647c0[_0xb6647a(0x279)])});}catch(_0xe05b6a){}}if(_0x5b12cd[_0xb6647a(0x280)]('analysis.training.triggerEnergy')&&_0x57e3d4[_0xb6647a(0x279)]){this[_0xb6647a(0xff)](_0x5b12cd,{'val':![],'ack':!![]});if(this[_0xb6647a(0x1e5)])try{const _0x1db3cf=await this['getStateAsync'](_0xb6647a(0x138));if(_0x1db3cf&&_0x1db3cf[_0xb6647a(0x279)])sendToPython(this,_0xb6647a(0x223),{'points':JSON[_0xb6647a(0x1de)](_0x1db3cf[_0xb6647a(0x279)])});}catch(_0x51dd0e){}}if(_0x5b12cd[_0xb6647a(0x280)](_0xb6647a(0x1bb))&&_0x57e3d4[_0xb6647a(0x279)]){this[_0xb6647a(0xff)](_0x5b12cd,{'val':![],'ack':!![]});if(this[_0xb6647a(0x1e5)])try{const _0x1a88d2=await this[_0xb6647a(0x26b)](LTM_DP_RAW_LOG);_0x1a88d2&&_0x1a88d2[_0xb6647a(0x279)]&&(this['log'][_0xb6647a(0x118)]('üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...'),sendToPython(this,_0xb6647a(0x244),{'events':JSON[_0xb6647a(0x1de)](_0x1a88d2[_0xb6647a(0x279)])}));}catch(_0x3c1242){}}if(_0x5b12cd[_0xb6647a(0x280)]('analysis.training.triggerTopology')&&_0x57e3d4[_0xb6647a(0x279)]){this['setState'](_0x5b12cd,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x39fb2c=await this[_0xb6647a(0x26b)](_0xb6647a(0x27c));if(_0x39fb2c&&_0x39fb2c[_0xb6647a(0x279)]){const _0x2295f6=JSON[_0xb6647a(0x1de)](_0x39fb2c[_0xb6647a(0x279)]);this[_0xb6647a(0x143)][_0xb6647a(0x118)](_0xb6647a(0x234)),sendToPython(this,_0xb6647a(0x11d),{'sequences':_0x2295f6});}}catch(_0x274efd){this['log'][_0xb6647a(0x2a7)]('Topology\x20Error:\x20'+_0x274efd['message']);}}return;}if(this[_0xb6647a(0x1b6)][_0xb6647a(0x17d)]&&this[_0xb6647a(0x1b6)][_0xb6647a(0x17d)][_0xb6647a(0x280)](_0x5b12cd)){await checkWifiPresence(this);return;}const _0x210b34=(this['config'][_0xb6647a(0x126)]||[])[_0xb6647a(0x297)](_0x4b8d67=>_0x4b8d67['id']===_0x5b12cd);if(_0x210b34)processSensorEvent(this,_0x5b12cd,_0x57e3d4,_0x210b34);}async[a0_0x522117(0x2b0)](_0x48cdf9){const _0x4354d0=a0_0x522117;if(typeof _0x48cdf9===_0x4354d0(0x2b7)&&_0x48cdf9[_0x4354d0(0x164)]){if(_0x48cdf9[_0x4354d0(0x26f)]===_0x4354d0(0x291)){const _0x50dc23=_0x48cdf9[_0x4354d0(0x164)][_0x4354d0(0x198)]||this[_0x4354d0(0x1b6)][_0x4354d0(0x1d5)];if(!_0x50dc23)return this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':![],'message':'Kein\x20API\x20Key.'},_0x48cdf9['callback']);try{const _0x1224bf=new GoogleGenerativeAI(_0x50dc23),_0x5ded1a=_0x1224bf['getGenerativeModel']({'model':GEMINI_MODEL}),_0x132ae8=await _0x5ded1a[_0x4354d0(0x2bb)]('Hi');this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':!![],'message':'OK:\x20'+_0x132ae8[_0x4354d0(0x226)][_0x4354d0(0x1fd)]()},_0x48cdf9['callback']);}catch(_0x2aad81){this[_0x4354d0(0x207)](_0x48cdf9['from'],_0x48cdf9[_0x4354d0(0x26f)],{'success':![],'message':_0x4354d0(0x168)+_0x2aad81[_0x4354d0(0x164)]},_0x48cdf9['callback']);}}else{if(_0x48cdf9[_0x4354d0(0x26f)]===_0x4354d0(0x1d0)){const _0x56f4b5=await getWeatherContext(this),_0x4e17ad=await getCalendarContext(this);this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':!![],'weather':_0x56f4b5,'calendar':_0x4e17ad},_0x48cdf9[_0x4354d0(0x16c)]);}else{if(_0x48cdf9[_0x4354d0(0x26f)]==='getLtmData'){if(!this[_0x4354d0(0x1e5)])return this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9['command'],{'success':![],'isPro':![]},_0x48cdf9[_0x4354d0(0x16c)]);let _0x1ab081={'status':_0x4354d0(0x23f)};try{const _0x395597=await this[_0x4354d0(0x26b)](LTM_DP_DRIFT_STATUS);_0x1ab081['status']=_0x395597?_0x395597[_0x4354d0(0x279)]:'N/A';}catch(_0x31dc80){}this[_0x4354d0(0x207)](_0x48cdf9['from'],_0x48cdf9[_0x4354d0(0x26f)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x4354d0(0x209)],'driftAnalysis':_0x1ab081,'analysisHistory':this['analysisHistory']},_0x48cdf9[_0x4354d0(0x16c)]);}else{if(_0x48cdf9[_0x4354d0(0x26f)]==='getOverviewData'){const _0x2199d5=this[_0x4354d0(0x209)]['length'],_0x3cac1c=new Date(),_0x559cd5=new Date(_0x3cac1c[_0x4354d0(0x235)](),_0x3cac1c[_0x4354d0(0x220)](),_0x3cac1c['getDate']())[_0x4354d0(0x15d)](),_0x2f9265=this[_0x4354d0(0x24b)]['filter'](_0x3e6aa1=>new Date(_0x3e6aa1['timestamp'])[_0x4354d0(0x15d)]()>_0x559cd5)[_0x4354d0(0x107)],_0x101a45=new Array(0x18)[_0x4354d0(0x27f)](0x0);this['rawEventLog']['forEach'](_0xcace69=>{const _0x13ebb3=_0x4354d0,_0x431ed7=new Date(_0xcace69[_0x13ebb3(0x271)]);if(_0x431ed7['getTime']()>_0x559cd5)_0x101a45[_0x431ed7['getHours']()]++;});let _0x29c1e7={'status':'N/A'};try{const _0x375ba2=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x29c1e7[_0x4354d0(0x123)]=_0x375ba2?_0x375ba2[_0x4354d0(0x279)]:'N/A';}catch(_0x38acb2){}let _0x47d0f1='';try{const _0x5cafac=await this[_0x4354d0(0x26b)](_0x4354d0(0x213));_0x47d0f1=_0x5cafac?_0x5cafac['val']:'';}catch(_0xf50bde){}let _0x17e2cc=null;!this[_0x4354d0(0x127)]&&(_0x17e2cc=this[_0x4354d0(0x1b6)][_0x4354d0(0x1d5)]?_0x4354d0(0x1bc):'Kein\x20API\x20Key!');let _0x42d940={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x30658a=await this[_0x4354d0(0x26b)](_0x4354d0(0x1dd));if(_0x30658a&&_0x30658a[_0x4354d0(0x279)]){_0x42d940['detected']=!![];const _0xf4f7d7=await this[_0x4354d0(0x26b)](_0x4354d0(0x261));_0x42d940['description']=_0xf4f7d7?_0xf4f7d7[_0x4354d0(0x279)]:'';const _0x4c0e14=await this['getStateAsync'](_0x4354d0(0x124));_0x42d940[_0x4354d0(0x178)]=_0x4c0e14?_0x4c0e14[_0x4354d0(0x279)]:'';const _0x379abc=await this[_0x4354d0(0x26b)]('analysis.automation.targetValue');_0x42d940[_0x4354d0(0x1a8)]=_0x379abc?_0x379abc[_0x4354d0(0x279)]:'';}const _0x1c3dfa=await this[_0x4354d0(0x26b)](_0x4354d0(0x1ff));_0x42d940[_0x4354d0(0x188)]=_0x1c3dfa?!!_0x1c3dfa[_0x4354d0(0x279)]:![];}catch(_0x2d1d79){}this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':!![],'eventHistory':this[_0x4354d0(0x275)][_0x4354d0(0x217)](0x0,0xf),'stats':{'digestCount':_0x2199d5,'eventCountToday':_0x2f9265,'hourlyActivity':_0x101a45,'driftStatus':_0x29c1e7['status'],'isPresent':this[_0x4354d0(0x1ca)],'presenceWho':_0x47d0f1,'minDays':this[_0x4354d0(0x1b6)][_0x4354d0(0x20e)]||0x7,'stbDays':this['config']['ltmStbWindowDays']||0xe,'ltbDays':this[_0x4354d0(0x1b6)][_0x4354d0(0x1cc)]||0x3c,'systemError':_0x17e2cc},'automation':_0x42d940},_0x48cdf9[_0x4354d0(0x16c)]);}else{if(_0x48cdf9['command']===_0x4354d0(0x248))try{const _0x5caeca=await scanForDevices(this,_0x48cdf9[_0x4354d0(0x164)]||{});this['sendTo'](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9['command'],{'success':!![],'devices':_0x5caeca},_0x48cdf9[_0x4354d0(0x16c)]);}catch(_0x4ca3f1){this['sendTo'](_0x48cdf9['from'],_0x48cdf9[_0x4354d0(0x26f)],{'success':![],'error':_0x4ca3f1[_0x4354d0(0x164)]},_0x48cdf9['callback']);}else{if(_0x48cdf9[_0x4354d0(0x26f)]===_0x4354d0(0x1c9)){const _0x56d7fa=await this[_0x4354d0(0x21d)](_0x4354d0(0x1a5),'enum'),_0x305987=[];if(_0x56d7fa)for(const _0x15dab7 in _0x56d7fa){const _0x44e65c=_0x56d7fa[_0x15dab7],_0x2a63cf=(_0x44e65c[_0x4354d0(0x2a5)]&&typeof _0x44e65c[_0x4354d0(0x2a5)]['name']===_0x4354d0(0x2b7)?_0x44e65c['common'][_0x4354d0(0x1da)]['de']:_0x44e65c[_0x4354d0(0x2a5)][_0x4354d0(0x1da)])||_0x44e65c[_0x4354d0(0x2a5)][_0x4354d0(0x1da)];_0x305987['push']({'id':_0x15dab7,'name':_0x2a63cf});}const _0x4465d9=await this[_0x4354d0(0x21d)](_0x4354d0(0x141),'enum'),_0x50be60=[];if(_0x4465d9)for(const _0x4880fc in _0x4465d9){const _0x8a40bc=_0x4465d9[_0x4880fc],_0x8aa213=(_0x8a40bc['common']&&typeof _0x8a40bc[_0x4354d0(0x2a5)]['name']===_0x4354d0(0x2b7)?_0x8a40bc[_0x4354d0(0x2a5)][_0x4354d0(0x1da)]['de']:_0x8a40bc[_0x4354d0(0x2a5)][_0x4354d0(0x1da)])||_0x4880fc['split']('.')[_0x4354d0(0x264)]();_0x50be60[_0x4354d0(0x27b)](_0x8aa213);}this['sendTo'](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':!![],'enums':_0x305987,'rooms':_0x50be60},_0x48cdf9[_0x4354d0(0x16c)]);}else{if(_0x48cdf9['command']==='getCalendarNames'){const _0x373b9e=_0x48cdf9[_0x4354d0(0x164)][_0x4354d0(0x1db)];if(!_0x373b9e)return this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':![],'error':_0x4354d0(0x12c)},_0x48cdf9[_0x4354d0(0x16c)]);const _0x3e6548=await getCalendarNames(this,_0x373b9e);this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9['command'],{'success':!![],'names':_0x3e6548},_0x48cdf9[_0x4354d0(0x16c)]);}else{if(_0x48cdf9[_0x4354d0(0x26f)]===_0x4354d0(0x299)){const {targetId:_0x4871f8,targetValue:_0x3c5e84}=_0x48cdf9['message'];this[_0x4354d0(0x143)][_0x4354d0(0x118)](_0x4354d0(0x10e)+_0x4871f8+_0x4354d0(0x195)+_0x3c5e84),await this[_0x4354d0(0x125)](_0x4354d0(0x1dd),{'val':!![],'ack':!![]}),await this[_0x4354d0(0x125)](_0x4354d0(0x261),{'val':_0x4354d0(0x185)+_0x4871f8,'ack':!![]}),await this[_0x4354d0(0x125)](_0x4354d0(0x124),{'val':_0x4871f8,'ack':!![]}),await this[_0x4354d0(0x125)](_0x4354d0(0x146),{'val':_0x3c5e84,'ack':!![]}),this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':!![]},_0x48cdf9['callback']);}else{if(_0x48cdf9['command']==='submitFeedback'){const {historyId:_0x21bf1f,rating:_0x430f1a,comment:_0x3bb858,alertReason:_0x105582}=_0x48cdf9[_0x4354d0(0x164)];_0x21bf1f&&_0x430f1a?(await saveFeedback(this,{'timestamp':Date[_0x4354d0(0x106)](),'historyId':_0x21bf1f,'rating':_0x430f1a,'comment':_0x3bb858,'alertReason':_0x105582}),this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':!![]},_0x48cdf9[_0x4354d0(0x16c)])):this[_0x4354d0(0x207)](_0x48cdf9[_0x4354d0(0x115)],_0x48cdf9[_0x4354d0(0x26f)],{'success':![],'error':'Missing\x20data'},_0x48cdf9['callback']);}else _0x48cdf9[_0x4354d0(0x26f)]===_0x4354d0(0x277)&&(this[_0x4354d0(0x143)][_0x4354d0(0x118)](_0x4354d0(0x173)),await this['setStateAsync'](_0x4354d0(0x1dd),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x4354d0(0x261),{'val':'','ack':!![]}),this[_0x4354d0(0x207)](_0x48cdf9['from'],_0x48cdf9['command'],{'success':!![]},_0x48cdf9[_0x4354d0(0x16c)]));}}}}}}}}}}}if(require[a0_0x522117(0x21f)]!==module)module[a0_0x522117(0x1b8)]=_0x533f8e=>new CogniLiving(_0x533f8e);else new CogniLiving();