const a0_0x5d0ecf=a0_0x432d;(function(_0x3962fa,_0xfbcb97){const _0x1ac59e=a0_0x432d,_0x2ed5cb=_0x3962fa();while(!![]){try{const _0x9ed7aa=parseInt(_0x1ac59e(0xff))/0x1*(-parseInt(_0x1ac59e(0x1ef))/0x2)+-parseInt(_0x1ac59e(0xfd))/0x3+-parseInt(_0x1ac59e(0xe7))/0x4+parseInt(_0x1ac59e(0x163))/0x5+-parseInt(_0x1ac59e(0x1c5))/0x6*(parseInt(_0x1ac59e(0x181))/0x7)+-parseInt(_0x1ac59e(0x1c2))/0x8*(parseInt(_0x1ac59e(0x187))/0x9)+parseInt(_0x1ac59e(0x122))/0xa;if(_0x9ed7aa===_0xfbcb97)break;else _0x2ed5cb['push'](_0x2ed5cb['shift']());}catch(_0x36dd4f){_0x2ed5cb['push'](_0x2ed5cb['shift']());}}}(a0_0x4684,0xcff2b));const a0_0x50a033=(function(){let _0x2e3d10=!![];return function(_0x441a96,_0x201fc0){const _0x353ac4=_0x2e3d10?function(){const _0x2853e1=a0_0x432d;if(_0x201fc0){const _0x2b9638=_0x201fc0[_0x2853e1(0xe6)](_0x441a96,arguments);return _0x201fc0=null,_0x2b9638;}}:function(){};return _0x2e3d10=![],_0x353ac4;};}()),a0_0x3b7dda=a0_0x50a033(this,function(){const _0x2b0d57=a0_0x432d;return a0_0x3b7dda[_0x2b0d57(0x1b0)]()[_0x2b0d57(0xe0)](_0x2b0d57(0x15e))[_0x2b0d57(0x1b0)]()[_0x2b0d57(0x100)](a0_0x3b7dda)[_0x2b0d57(0xe0)](_0x2b0d57(0x15e));});a0_0x3b7dda();'use strict';const utils=require(a0_0x5d0ecf(0x179)),{GoogleGenerativeAI}=require(a0_0x5d0ecf(0x161)),{spawn}=require(a0_0x5d0ecf(0x216)),path=require('path'),fs=require('fs'),installer=require(a0_0x5d0ecf(0x10b)),scanner=require(a0_0x5d0ecf(0xee)),schedulers=require(a0_0x5d0ecf(0x1ce)),topology=require(a0_0x5d0ecf(0x206)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x5d0ecf(0xde),LTM_DP_DAILY_DIGESTS=a0_0x5d0ecf(0xf4),LTM_DP_STATUS=a0_0x5d0ecf(0x1fd),LTM_DP_TRIGGER_DIGEST=a0_0x5d0ecf(0x1a2),LTM_DP_BASELINE_STATUS=a0_0x5d0ecf(0x124),LTM_DP_DRIFT_CHANNEL=a0_0x5d0ecf(0x226),LTM_DP_DRIFT_STATUS=a0_0x5d0ecf(0x221),LTM_DP_DRIFT_DETAILS=a0_0x5d0ecf(0x13b),LTM_DP_DRIFT_LAST_CHECK=a0_0x5d0ecf(0x253),SYSTEM_DP_MODE=a0_0x5d0ecf(0x12b),SYSTEM_MODES={'NORMAL':a0_0x5d0ecf(0x147),'VACATION':a0_0x5d0ecf(0x1c8),'PARTY':a0_0x5d0ecf(0x194),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x5d0ecf(0x20b)],SYSTEM_MODES[a0_0x5d0ecf(0x14f)]],PERSONA_MAPPING={'generic':a0_0x5d0ecf(0x191),'senior_aal':'PRIORITÃ„T:\x20Gesundheit/AAL.','family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x5d0ecf(0x11b)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x431463){const _0x21ee23=a0_0x5d0ecf;try{const _0x4a74ff=[_0x21ee23(0x10f),_0x21ee23(0xcd)];for(const _0x54cd5c of _0x4a74ff){try{const _0x13944b=await _0x431463[_0x21ee23(0x120)](_0x54cd5c);if(_0x13944b)await _0x431463[_0x21ee23(0x154)](_0x54cd5c);}catch(_0x1218f8){}}}catch(_0x1daf04){}}async function checkLicense(_0x2ede9d){return!![];}function a0_0x432d(_0x4c42c2,_0x55a8e4){const _0x52d4ff=a0_0x4684();return a0_0x432d=function(_0x3b7dda,_0x50a033){_0x3b7dda=_0x3b7dda-0xb2;let _0x468442=_0x52d4ff[_0x3b7dda];return _0x468442;},a0_0x432d(_0x4c42c2,_0x55a8e4);}async function initHistory(_0x445316){const _0x530e79=a0_0x5d0ecf;try{const _0xeab5e4=await _0x445316['getStateAsync'](_0x530e79(0x170));_0xeab5e4&&_0xeab5e4[_0x530e79(0x232)]&&(_0x445316[_0x530e79(0x245)]=JSON[_0x530e79(0xb2)](_0xeab5e4['val'][_0x530e79(0x1b0)]()));}catch(_0x42fc99){_0x445316[_0x530e79(0x245)]=[];}try{const _0x405e32=await _0x445316[_0x530e79(0x251)](_0x530e79(0x109));if(_0x405e32&&_0x405e32[_0x530e79(0x232)])_0x445316['analysisHistory']=JSON['parse'](_0x405e32[_0x530e79(0x232)]['toString']());}catch(_0x275727){_0x445316[_0x530e79(0x150)]=[];}if(_0x445316[_0x530e79(0x245)]&&_0x445316['eventHistory'][_0x530e79(0x1a0)]>0x0){_0x445316['log'][_0x530e79(0x243)]('Restoring\x20sensor\x20cache...');for(let _0x1bac7c=_0x445316['eventHistory']['length']-0x1;_0x1bac7c>=0x0;_0x1bac7c--){const _0x37adb8=_0x445316[_0x530e79(0x245)][_0x1bac7c];if(_0x37adb8&&_0x37adb8['id']!==undefined&&_0x37adb8[_0x530e79(0xd6)]!==undefined)_0x445316['sensorLastValues'][_0x37adb8['id']]=_0x37adb8[_0x530e79(0xd6)];}}}async function initSystemConfig(_0x218112){const _0xfe41a5=a0_0x5d0ecf;try{const _0x2ca6d9=await _0x218112[_0xfe41a5(0xbd)](_0xfe41a5(0x183));if(_0x2ca6d9&&_0x2ca6d9['common'])_0x218112['systemConfig']={'latitude':_0x2ca6d9[_0xfe41a5(0x10c)][_0xfe41a5(0x256)]||0x0,'longitude':_0x2ca6d9[_0xfe41a5(0x10c)][_0xfe41a5(0xc6)]||0x0,'city':_0x2ca6d9[_0xfe41a5(0x10c)][_0xfe41a5(0x137)]||''};}catch(_0x4f95d6){}}async function createAllObjects(_0x32eeb8){const _0x1e2d58=a0_0x5d0ecf;await _0x32eeb8[_0x1e2d58(0xc1)](_0x1e2d58(0x126),{'type':_0x1e2d58(0x200),'common':{'name':_0x1e2d58(0xf3)},'native':{}}),await _0x32eeb8[_0x1e2d58(0xc1)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x1e2d58(0x102),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x145),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x1e2d58(0x1fc)]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync']('system.presenceWho',{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x246),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x125),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x224),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0xce),'type':'string','role':_0x1e2d58(0x16a),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x170),{'type':'state','common':{'name':_0x1e2d58(0x21f),'type':_0x1e2d58(0x192),'role':'json','read':!![],'write':![]},'native':{}}),await _0x32eeb8['extendObjectAsync']('analysis.training',{'type':_0x1e2d58(0x200),'common':{'name':_0x1e2d58(0x204)},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync'](_0x1e2d58(0x14b),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x21e),'type':_0x1e2d58(0x236),'role':_0x1e2d58(0x1e8),'read':!![],'write':!![]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync'](_0x1e2d58(0xf0),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x14e),'type':_0x1e2d58(0x236),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.training.triggerEnergy',{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x229),'type':_0x1e2d58(0x236),'role':_0x1e2d58(0x1e8),'read':!![],'write':!![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x108),{'type':'state','common':{'name':'Train\x20Comfort','type':'boolean','role':_0x1e2d58(0x1e8),'read':!![],'write':!![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.training.triggerTopology',{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x188),'type':_0x1e2d58(0x236),'role':_0x1e2d58(0x1e8),'read':!![],'write':!![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x244),{'type':'state','common':{'name':_0x1e2d58(0x258),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x125),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0xc1)](_0x1e2d58(0x211),{'type':_0x1e2d58(0x200),'common':{'name':_0x1e2d58(0x238)},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x189),{'type':'state','common':{'name':'Anomaly\x20Score','type':'number','role':_0x1e2d58(0xd6),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x227),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x1c9),'type':'number','role':'value','read':!![],'write':![],'def':0.05},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.security.lastCheck',{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x12a),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x1f2),'read':!![],'write':![]},'native':{}}),await _0x32eeb8['extendObjectAsync']('analysis.topology',{'type':_0x1e2d58(0x200),'common':{'name':_0x1e2d58(0xeb)},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0xf5),{'type':_0x1e2d58(0x145),'common':{'name':'Graph\x20Structure\x20(Adjacency\x20Matrix)','type':_0x1e2d58(0x192),'role':_0x1e2d58(0x16a),'read':!![],'write':![],'def':_0x1e2d58(0x22a)},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.security.topologyMatrix',{'type':'state','common':{'name':'Topology\x20Matrix\x20(Legacy)','type':_0x1e2d58(0x192),'role':_0x1e2d58(0x16a),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0xc1)]('analysis.health',{'type':_0x1e2d58(0x200),'common':{'name':_0x1e2d58(0x12e)},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.health.lastCheck',{'type':_0x1e2d58(0x145),'common':{'name':'Last\x20Check','type':'string','role':'date','read':!![],'write':![]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync'](_0x1e2d58(0x157),{'type':_0x1e2d58(0x145),'common':{'name':'Anomaly\x20Detected','type':_0x1e2d58(0x236),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x116),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x1aa),'type':_0x1e2d58(0x192),'role':'text','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0xf6),{'type':_0x1e2d58(0x145),'common':{'name':'Trend\x20Value','type':_0x1e2d58(0x21c),'role':_0x1e2d58(0xd6),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x166),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0xe5),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x16a),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.health.gaitSpeed',{'type':'state','common':{'name':_0x1e2d58(0x21b),'type':_0x1e2d58(0x21c),'role':_0x1e2d58(0xd6),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0xc1)](_0x1e2d58(0xfe),{'type':_0x1e2d58(0x200),'common':{'name':_0x1e2d58(0x241)},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x228),{'type':_0x1e2d58(0x145),'common':{'name':'Insulation\x20Score','type':_0x1e2d58(0x192),'role':_0x1e2d58(0x125),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0xb9),{'type':_0x1e2d58(0x145),'common':{'name':'Heating\x20Score','type':_0x1e2d58(0x192),'role':'text','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x168),{'type':_0x1e2d58(0x145),'common':{'name':'Temperature\x20Forecast','type':'string','role':_0x1e2d58(0x16a),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0xc1)](_0x1e2d58(0x175),{'type':_0x1e2d58(0x200),'common':{'name':_0x1e2d58(0x175)},'native':{}}),await _0x32eeb8[_0x1e2d58(0xc1)](LTM_DP_RAW_LOG,{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x162),'type':_0x1e2d58(0x192),'role':'json','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0xc1)](LTM_DP_DAILY_DIGESTS,{'type':_0x1e2d58(0x145),'common':{'name':'Daily\x20Digests','type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x11f),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x1da),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x16a),'read':!![],'write':![]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync'](_0x1e2d58(0x193),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x14d),'type':'string','role':_0x1e2d58(0x16a),'read':!![],'write':![]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync'](_0x1e2d58(0x190),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x1fa),'type':_0x1e2d58(0x236),'role':_0x1e2d58(0x1e8),'read':!![],'write':!![]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync']('analysis.triggerBriefing',{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x153),'type':_0x1e2d58(0x236),'role':_0x1e2d58(0x1e8),'read':!![],'write':!![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x14a),{'type':'state','common':{'name':'Alert\x20Status','type':_0x1e2d58(0x236),'role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x178),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0xe3),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x20e),'read':!![],'write':![]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync']('analysis.activitySummary',{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x1a4),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x125),'read':!![],'write':![]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync'](_0x1e2d58(0xda),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x10d),'type':'boolean','role':'indicator','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.automation.description',{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x249),'type':_0x1e2d58(0x192),'role':'text','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.automation.detectedPatterns',{'type':'state','common':{'name':_0x1e2d58(0x132),'type':_0x1e2d58(0x192),'role':_0x1e2d58(0x16a),'read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x138),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x1f3),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x32eeb8['setObjectNotExistsAsync'](_0x1e2d58(0x230),{'type':'state','common':{'name':'Target\x20Value','type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)]('analysis.automation.autoApply',{'type':_0x1e2d58(0x145),'common':{'name':'Auto\x20Apply','type':_0x1e2d58(0x236),'role':_0x1e2d58(0x213),'read':!![],'write':!![]},'native':{}}),await _0x32eeb8[_0x1e2d58(0x1d5)](_0x1e2d58(0x22b),{'type':_0x1e2d58(0x145),'common':{'name':_0x1e2d58(0x19e),'type':_0x1e2d58(0x236),'role':'button','read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x1ae331){const _0x58235b=a0_0x5d0ecf;try{const _0x3d7866=await _0x1ae331['getStateAsync'](SYSTEM_DP_MODE);_0x3d7866&&_0x3d7866[_0x58235b(0x232)]&&Object[_0x58235b(0x1b1)](SYSTEM_MODES)[_0x58235b(0x111)](_0x3d7866[_0x58235b(0x232)])?_0x1ae331[_0x58235b(0x1e1)]=_0x3d7866['val']:(_0x1ae331[_0x58235b(0x1e1)]=SYSTEM_MODES[_0x58235b(0x1fc)],await _0x1ae331[_0x58235b(0x24c)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x41f895){_0x1ae331[_0x58235b(0x1e1)]=SYSTEM_MODES[_0x58235b(0x1fc)];}}async function loadRawEventLog(_0x3b5492){const _0x43e8fe=a0_0x5d0ecf;try{const _0xd94494=await _0x3b5492[_0x43e8fe(0x251)](LTM_DP_RAW_LOG);if(_0xd94494&&_0xd94494[_0x43e8fe(0x232)])_0x3b5492[_0x43e8fe(0x121)]=JSON[_0x43e8fe(0xb2)](_0xd94494[_0x43e8fe(0x232)]);}catch(_0x4eff06){_0x3b5492['rawEventLog']=[];}}async function saveRawEventLog(_0x3822a6){const _0x4aa3cc=a0_0x5d0ecf;if(_0x3822a6[_0x4aa3cc(0x121)][_0x4aa3cc(0x1a0)]>RAW_LOG_MAX_SIZE)_0x3822a6['rawEventLog'][_0x4aa3cc(0x1eb)](0x0,_0x3822a6['rawEventLog']['length']-RAW_LOG_MAX_SIZE);await _0x3822a6['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x3822a6[_0x4aa3cc(0x121)]),'ack':!![]});}async function loadDailyDigests(_0x22118c){const _0x58474d=a0_0x5d0ecf;try{const _0x3adf16=await _0x22118c[_0x58474d(0x251)](LTM_DP_DAILY_DIGESTS);if(_0x3adf16&&_0x3adf16['val'])_0x22118c[_0x58474d(0x134)]=JSON[_0x58474d(0xb2)](_0x3adf16[_0x58474d(0x232)]);}catch(_0x42abb1){_0x22118c[_0x58474d(0x134)]=[];}await updateBaselineStatus(_0x22118c);}async function saveDailyDigests(_0x5c6702,_0x3b23d0=!![]){const _0x387efb=a0_0x5d0ecf,_0x2a6d9e=_0x5c6702['config'][_0x387efb(0x160)]||0x3c;_0x5c6702['dailyDigests'][_0x387efb(0x1a0)]>_0x2a6d9e&&_0x5c6702[_0x387efb(0x134)][_0x387efb(0x1eb)](0x0,_0x5c6702[_0x387efb(0x134)]['length']-_0x2a6d9e);await _0x5c6702[_0x387efb(0x24c)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x387efb(0x1ac)](_0x5c6702[_0x387efb(0x134)]),'ack':!![]});if(_0x3b23d0)await updateBaselineStatus(_0x5c6702);}async function updateAnalysisHistory(_0x359d08,_0x3c8e34){const _0x232362=a0_0x5d0ecf;_0x359d08[_0x232362(0x150)][_0x232362(0x1d6)](_0x3c8e34);if(_0x359d08[_0x232362(0x150)][_0x232362(0x1a0)]>HISTORY_MAX_SIZE)_0x359d08[_0x232362(0x150)][_0x232362(0x19d)]();await _0x359d08[_0x232362(0x24c)](_0x232362(0x109),{'val':JSON[_0x232362(0x1ac)](_0x359d08[_0x232362(0x150)]),'ack':!![]});}async function updateBaselineStatus(_0x1511d7){const _0x3fb6b6=a0_0x5d0ecf;if(!_0x1511d7['isProVersion']){await _0x1511d7[_0x3fb6b6(0x24c)](LTM_DP_BASELINE_STATUS,{'val':_0x3fb6b6(0x13c),'ack':!![]});return;}const _0x2ea8e0=_0x1511d7[_0x3fb6b6(0x134)]['length']>=(_0x1511d7[_0x3fb6b6(0x1a7)]['minDaysForBaseline']||0x7)?_0x3fb6b6(0x239)+_0x1511d7[_0x3fb6b6(0x134)][_0x3fb6b6(0x1a0)]+'\x20Tage)':_0x3fb6b6(0x247)+_0x1511d7[_0x3fb6b6(0x134)]['length']+'/'+(_0x1511d7[_0x3fb6b6(0x1a7)][_0x3fb6b6(0x1ae)]||0x7)+')';await _0x1511d7['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x2ea8e0,'ack':!![]});}async function initSensorSubscriptions(_0x30a300){const _0x565dab=a0_0x5d0ecf,_0x4c5fd6=_0x30a300[_0x565dab(0x1a7)][_0x565dab(0x1e4)];if(_0x4c5fd6)for(const _0x1c66c6 of _0x4c5fd6){await _0x30a300[_0x565dab(0x1b3)](_0x1c66c6['id']);}}async function initPresenceSubscriptions(_0x3f4c4e){const _0x2eadb5=a0_0x5d0ecf,_0x466c38=_0x3f4c4e[_0x2eadb5(0x1a7)]['presenceDevices'];if(_0x466c38)for(const _0x14b26c of _0x466c38){await _0x3f4c4e[_0x2eadb5(0x1b3)](_0x14b26c);}}async function setupTelegramListener(_0x40a986){const _0x281dd3=a0_0x5d0ecf,_0x34befb=_0x40a986[_0x281dd3(0x1a7)][_0x281dd3(0x19b)];if(_0x40a986['config'][_0x281dd3(0x23b)]&&_0x34befb)await _0x40a986[_0x281dd3(0x1b3)](_0x34befb+_0x281dd3(0x210));}function a0_0x4684(){const _0x4f7fd8=['eventHistory','Who\x20is\x20present?','Lernphase\x20(','onReady','Description','payload','Gemini\x20AI\x20initialized.','setStateAsync','kontakt','checkAndInstall','Â°C,\x20','Regel\x20erkannt:\x20','getStateAsync','exitGraceTimer','LTM.driftAnalysis.lastCheck','loc','Started...','latitude','description','Training\x20Status','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','online','Err:\x20','setupLtmScheduler','\x0aSTB:\x20','Adapter','.\x20SYSTEM_MODE:\x20','debug','parse','.\x20EVENTS:\x20','threshold','ENERGY_TRAIN_RESULT','daswetter','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','scanForDevices','analysis.energy.heatingScore','getEnums','ðŸ•¸ï¸\x20Topology\x20Graph\x20manually\x20updated\x20by\x20user.','name','getForeignObjectAsync','ðŸ§ \x20Triggering\x20Security\x20Training...','onUnload','push','extendObjectAsync','ANALYZE_GAIT','.forecast.current.temp','bewegung','getFullYear','longitude','schalter','timestamp','analysis.security.topologyMatrix','analysis.automation.autoApply','updateTopologyMatrix','writable','events.history_debug_00','Last\x20raw\x20event','systemUUID','openweathermap','callback','PYTHON_EXE','automationProposal','application/json','TRAIN_SECURITY','value','âœ…\x20HEALTH\x20TRAINED.','ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','detected','analysis.automation.patternDetected','Success:\x20','ðŸš€\x20Starting\x20NUUKANNI\x20Logic\x20(v0.14.2)...','briefingJob','LTM.rawEventLog','analysis.triggerBriefing','search','toISOString','find','Alert\x20Reason','.Current.Temperature','Today\x20Vector\x20(15m)','apply','676896zcbAJx','isEmergency','setupModeResetScheduler','Success','Graph\x20Topology','GAIT_RESULT','data','./lib/scanner','driftDetails','analysis.training.triggerHealth','[RESULT]','setForeignStateAsync','System','LTM.dailyDigests','analysis.topology.structure','analysis.health.trendValue','accuweather','some','ltmJob','[PYTHON]\x20','from','exitTimer','1845174ElNTPW','analysis.energy','1021fXCsky','constructor','PREDICT_ENERGY','System\x20Mode','prÃ¤senz','write','telegram','endsWith','trim','analysis.training.triggerComfort','analysis.analysisHistory','diagnosis','./lib/installer','common','Pattern\x20Detected','success','analysis.history_debug_00','is_anomaly','includes','logDuplicates','Wetterdaten\x20deaktiviert.','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','Skipped\x20(No\x20AI\x20or\x20Data)','analysis.health.trendDiagnosis','testApiKey','sensorLastValues','confidence','forEach','PRIORITÃ„T:\x20Sicherheit.','ðŸ•¸ï¸\x20Manually\x20triggering\x20Topology\x20Update...','isProVersion','warn','LTM.trainingData.sequences','getObjectAsync','rawEventLog','25282160NLdAUp','PONG','LTM.baselineStatus','text','system','WiFi\x20Presence\x20detected.','temperatur','now','Last\x20Check','system.mode','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','.Current.WeatherText','Health\x20Analysis','motion','getForeignObjectsAsync','error','Detected\x20Patterns','subscribeStates','dailyDigests','unload','useCalendar','city','analysis.automation.targetId','shift','contact','LTM.driftAnalysis.driftDetails','Deaktiviert\x20(Pro-Feature)','useWeather','inactivityThresholdHours','Gemini\x20Init\x20Error:\x20','[RECORDER]\x20Error:\x20','getHours','isPresent','getCalendarNames','fill','state','analysis.lastResult','normal','setHours','driftAnalysisTimer','analysis.isAlert','analysis.training.triggerSecurity','Gemini\x20Error:\x20','Thermodynamics','Train\x20Health','GUEST','analysisHistory','\x20=\x20','baselineDrift','Trigger\x20Briefing','delObjectAsync','stateChange','generateContent','analysis.health.isAnomaly','SIGNAL_RESULT','Keine\x20Wetterdaten\x20verfÃ¼gbar.','namespace','Kein\x20API\x20Key!','apiKey','licenseKey','(((.+)+)+)+$','HEALTH_RESULT','ltmLtbWindowDays','@google/generative-ai','Raw\x20Log','5252505izunCc','geminiModel','presenceDevices','analysis.health.todayVector','log','analysis.energy.forecast','systemConfig','json','HEALTH_TRAIN_RESULT','TRAINING_COMPLETE','No\x20instance','Sec-Training\x20started...','isExit','events.history','generic','Kalender\x20deaktiviert.','startsWith','\x20->\x20','LTM','enum','autoApply','analysis.alertReason','@iobroker/adapter-core','.forecast.current.temperature','communicate.request','heating','substring','Keine\x20Details.','getDate','Topology\x20Update\x20Error:\x20','9153305aRayZW','setState','system.config','sendTo','summary','occupancy','9sVtdNN','Build\x20Topology','analysis.security.lastScore','isGracePeriodActive','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','SECURITY_RESULT','getGenerativeModel','.\x20WETTER:\x20','object','analysis.trigger','Analysiere\x20ausgewogen.','string','LTM.trainingData.thermodynamics','party','Digest','updateTopology','getForeignStateAsync','location','onMessage','setupBriefingScheduler','notifyTelegramInstance','map','pop','Trigger\x20Action','exports','length','COMFORT_RESULT','LTM.triggerDailyDigest','ANOMALY','Activity\x20Summary','\x20new\x20patterns.','N/A','config','Briefing\x20Error:\x20','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','Trend','details','stringify','message','minDaysForBaseline','python3','toString','values','ready','subscribeForeignStatesAsync','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','analysis.health.lastCheck','response','ANALYZE_SEQUENCE','Activity-Level','command','analysis.security.lastCheck','alertReason','isAlert','.\x20KONTEXT:\x20','python_service','ANALYZE_TREND','stdout','change_percent','4966168jkJMvQ','genAI','[LOG]','6DZpmzW','existsSync','cogni-living\x20adapter\x20starting\x20(v','vacation','Current\x20Threshold','submitFeedback','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...',')\x20-\x20SAFE\x20BOOT','ack','./lib/scheduler','analysis.automation.detectedPatterns','toLowerCase','type','fenster','getLtmData','analysis.automation.description','setObjectNotExistsAsync','unshift','slice','matrix','setupDriftAnalysisScheduler','Sequences','testContext','main','ðŸ\x20Python\x20confirmed\x20new\x20topology.','simulateButler','\x0aGrund:\x20','outdoorSensorId','currentSystemMode','automation.triggerAction','onStateChange','devices','floor','temperature','activityLevel','button','Unknown','replace','splice','analysisInterval','scanDevices','targetId','28jHFtLT','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','join','date','Target\x20ID','Error\x20launching\x20Python:\x20','âš ï¸\x20ALARM:\x20','licht','ðŸ“\x20Feedback\x20received:\x20','reason','analysis.training.triggerEnergy','Trigger\x20Analysis','pythonProcess','NORMAL','LTM.processingStatus','presence','TREND_RESULT','channel','bind','kill','dependencyInstallInProgress','AI\x20Training','targetValue','./lib/topology','split','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','system.isPresent','weatherInstance','PARTY','modeResetJob','ANALYZE_HEALTH','text.alarm','analysis.training.triggerTopology','.communicate.request','analysis.security','KI-Modell\x20nicht\x20initialisiert','switch','geminiApiKey','TOPOLOGY_ACK','child_process','status','lastAlertState','triggerDailyDigest','Keine\x20Termine.','Gait\x20Speed\x20Trend','number','cancel','Train\x20Security','Event\x20History','unknown','LTM.driftAnalysis.baselineDrift','toFixed','stdin','events.lastEvent','ðŸŒ…\x20Morning\x20Briefing:\x0a','LTM.driftAnalysis','analysis.security.currentThreshold','analysis.energy.insulationScore','Train\x20Energy','{\x22rooms\x22:[],\x20\x22matrix\x22:[]}','analysis.automation.triggerAction','livingContext','.forecast.current.state','light','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','analysis.automation.targetValue','.\x20ANWESEND:\x20','val','tÃ¼r','getMinutes','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','boolean','âš ï¸\x20SECURITY\x20ALARM:\x20','Security\x20Monitor','Aktiv\x20(','round','notifyTelegramEnabled','system.presenceWho','version','instance','getTime','SET_TOPOLOGY','Energy\x20Intelligence','analysisTimer','info','analysis.training.status'];a0_0x4684=function(){return _0x4f7fd8;};return a0_0x4684();}async function checkWifiPresence(_0x47d1b8){const _0x103ed6=a0_0x5d0ecf;try{const _0x51ff19=_0x47d1b8[_0x103ed6(0x1a7)][_0x103ed6(0x165)]||[];let _0x5c3ebd=![];const _0x57dc79=[];for(const _0x26926b of _0x51ff19){try{const _0x114088=await _0x47d1b8[_0x103ed6(0x197)](_0x26926b);_0x114088&&(_0x114088[_0x103ed6(0x232)]===!![]||_0x114088[_0x103ed6(0x232)]===_0x103ed6(0x25a)||_0x114088[_0x103ed6(0x232)]===0x1)&&(_0x5c3ebd=!![],_0x57dc79[_0x103ed6(0xc0)](_0x26926b));}catch(_0x3e46e6){}}return await _0x47d1b8[_0x103ed6(0x24c)](_0x103ed6(0x23c),{'val':_0x57dc79[_0x103ed6(0x1f1)](',\x20'),'ack':!![]}),_0x5c3ebd&&(_0x47d1b8[_0x103ed6(0xfc)]&&(_0x47d1b8[_0x103ed6(0x167)][_0x103ed6(0x243)](_0x103ed6(0x127)),abortExitTimer(_0x47d1b8)),!_0x47d1b8[_0x103ed6(0x142)]&&_0x47d1b8[_0x103ed6(0x1e1)]===SYSTEM_MODES[_0x103ed6(0x1fc)]&&await setPresence(_0x47d1b8,!![])),_0x5c3ebd;}catch(_0xe1740e){return![];}}function startExitTimer(_0x4d491b){const _0x416157=a0_0x5d0ecf;abortExitTimer(_0x4d491b),_0x4d491b['isGracePeriodActive']=!![],_0x4d491b[_0x416157(0x252)]=setTimeout(()=>{const _0x3c7d4f=_0x416157;_0x4d491b[_0x3c7d4f(0x18a)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4d491b[_0x416157(0xfc)]=setTimeout(()=>{const _0xe88ec6=_0x416157;setPresence(_0x4d491b,![]),_0x4d491b[_0xe88ec6(0xfc)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x2ab6b2){const _0x354875=a0_0x5d0ecf;if(_0x2ab6b2[_0x354875(0xfc)])clearTimeout(_0x2ab6b2[_0x354875(0xfc)]);if(_0x2ab6b2[_0x354875(0x252)])clearTimeout(_0x2ab6b2[_0x354875(0x252)]);_0x2ab6b2[_0x354875(0xfc)]=null,_0x2ab6b2[_0x354875(0x252)]=null,_0x2ab6b2[_0x354875(0x18a)]=![];}async function setPresence(_0x189118,_0x120640){const _0x14694f=a0_0x5d0ecf;if(_0x189118[_0x14694f(0x142)]===_0x120640)return;_0x189118[_0x14694f(0x142)]=_0x120640,await _0x189118['setStateAsync'](_0x14694f(0x209),{'val':_0x120640,'ack':!![]});}async function executeAutomationAction(_0x87794c){const _0x6328fd=a0_0x5d0ecf;try{const _0x22ba9e=await _0x87794c[_0x6328fd(0x251)](_0x6328fd(0x138)),_0x421aa2=await _0x87794c[_0x6328fd(0x251)](_0x6328fd(0x230));if(_0x22ba9e&&_0x22ba9e['val']&&_0x421aa2){const _0x2c8f1b=_0x22ba9e[_0x6328fd(0x232)];let _0x539b34=_0x421aa2['val'];try{_0x539b34=JSON[_0x6328fd(0xb2)](_0x539b34);}catch(_0x3cf788){}_0x87794c[_0x6328fd(0x167)][_0x6328fd(0x243)](_0x6328fd(0x259)+_0x2c8f1b+_0x6328fd(0x151)+_0x539b34),await _0x87794c[_0x6328fd(0xf2)](_0x2c8f1b,_0x539b34);}else _0x87794c[_0x6328fd(0x167)][_0x6328fd(0x11e)](_0x6328fd(0x12c));}catch(_0xd79ea4){_0x87794c['log']['error']('BUTLER\x20Execution\x20Error:\x20'+_0xd79ea4[_0x6328fd(0x1ad)]);}}async function processSensorEvent(_0x3c5fc7,_0x3b3c42,_0x2a0a97,_0x46da33){const _0x6d5e42=a0_0x5d0ecf;if(!_0x46da33)return;const _0x59ff7d=_0x2a0a97[_0x6d5e42(0x232)],_0x2b50b9=Date[_0x6d5e42(0x129)](),_0x21b98b=_0x3c5fc7[_0x6d5e42(0x118)][_0x3b3c42];_0x3c5fc7['sensorLastValues'][_0x3b3c42]=_0x59ff7d;if(!_0x46da33[_0x6d5e42(0x112)]&&_0x21b98b!=undefined&&_0x21b98b==_0x59ff7d)return;const _0x508630=(_0x46da33['type']||'')['toLowerCase'](),_0x3173cc=_0x508630['includes'](_0x6d5e42(0x1e6))||_0x508630['includes'](_0x6d5e42(0x128))||_0x508630[_0x6d5e42(0x111)]('klima')||_0x508630[_0x6d5e42(0x111)]('heizung');_0x3c5fc7[_0x6d5e42(0x11d)]&&_0x3173cc&&recordThermodynamics(_0x3c5fc7,_0x3b3c42,_0x59ff7d,_0x46da33['location']);const _0x4bff01={'timestamp':_0x2b50b9,'id':_0x3b3c42,'name':_0x46da33['name'],'type':_0x46da33[_0x6d5e42(0x1d1)],'location':_0x46da33[_0x6d5e42(0x198)],'value':_0x59ff7d};_0x3c5fc7[_0x6d5e42(0x245)][_0x6d5e42(0x1d6)](_0x4bff01);if(_0x3c5fc7[_0x6d5e42(0x245)][_0x6d5e42(0x1a0)]>HISTORY_MAX_SIZE)_0x3c5fc7[_0x6d5e42(0x245)][_0x6d5e42(0x19d)]();await _0x3c5fc7[_0x6d5e42(0x24c)]('events.lastEvent',{'val':JSON[_0x6d5e42(0x1ac)](_0x4bff01),'ack':!![]}),await _0x3c5fc7[_0x6d5e42(0x24c)](_0x6d5e42(0x170),{'val':JSON[_0x6d5e42(0x1ac)](_0x3c5fc7[_0x6d5e42(0x245)]),'ack':!![]});_0x3c5fc7['isProVersion']&&(_0x3c5fc7[_0x6d5e42(0x121)][_0x6d5e42(0xc0)](_0x4bff01),await saveRawEventLog(_0x3c5fc7),recordSequence(_0x3c5fc7,_0x4bff01));if(_0x46da33[_0x6d5e42(0x16f)]&&_0x59ff7d===!![]){if(_0x3c5fc7['isPresent']&&!_0x3c5fc7[_0x6d5e42(0x18a)])startExitTimer(_0x3c5fc7);else{if(!_0x3c5fc7[_0x6d5e42(0x142)])setPresence(_0x3c5fc7,!![]);}}else{if(_0x46da33[_0x6d5e42(0x1d1)]===_0x6d5e42(0x12f)&&_0x59ff7d===!![]){if(_0x3c5fc7[_0x6d5e42(0xfc)])abortExitTimer(_0x3c5fc7);if(!_0x3c5fc7[_0x6d5e42(0x142)]&&_0x3c5fc7[_0x6d5e42(0x1e1)]===SYSTEM_MODES[_0x6d5e42(0x1fc)])setPresence(_0x3c5fc7,!![]);}}}async function recordThermodynamics(_0x40ab5f,_0x383c72,_0x730f58,_0x1cc9d3){const _0x4ab44e=a0_0x5d0ecf,_0x2dd9b2=await getOutsideTemperatureNumeric(_0x40ab5f),_0x5de851=await _0x40ab5f[_0x4ab44e(0x251)]('LTM.trainingData.thermodynamics');let _0x1dc356=[];if(_0x5de851&&_0x5de851[_0x4ab44e(0x232)])try{_0x1dc356=JSON[_0x4ab44e(0xb2)](_0x5de851[_0x4ab44e(0x232)]);}catch(_0xf83429){}_0x1dc356[_0x4ab44e(0xc0)]({'ts':Date['now'](),'room':_0x1cc9d3||_0x4ab44e(0x1e9),'t_in':_0x730f58,'t_out':_0x2dd9b2});if(_0x1dc356[_0x4ab44e(0x1a0)]>THERMO_LOG_SIZE)_0x1dc356['shift']();await _0x40ab5f[_0x4ab44e(0x24c)](_0x4ab44e(0x193),{'val':JSON[_0x4ab44e(0x1ac)](_0x1dc356),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x2c6107){const _0x1bd7b3=a0_0x5d0ecf;if(_0x2c6107['config'][_0x1bd7b3(0x1e0)])try{const _0x3dba59=await _0x2c6107[_0x1bd7b3(0x197)](_0x2c6107['config']['outdoorSensorId']);if(_0x3dba59&&_0x3dba59[_0x1bd7b3(0x232)]!==undefined&&_0x3dba59[_0x1bd7b3(0x232)]!==null)return parseFloat(_0x3dba59[_0x1bd7b3(0x232)]);}catch(_0x231303){}const _0x50d09f=_0x2c6107['config'][_0x1bd7b3(0x20a)];if(!_0x2c6107[_0x1bd7b3(0x1a7)][_0x1bd7b3(0x13d)]||!_0x50d09f)return null;try{let _0x1e9696='';if(_0x50d09f[_0x1bd7b3(0x111)](_0x1bd7b3(0xf7)))_0x1e9696=_0x50d09f+'.Current.Temperature';else{if(_0x50d09f[_0x1bd7b3(0x111)](_0x1bd7b3(0xb6)))_0x1e9696=_0x50d09f+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x50d09f['includes'](_0x1bd7b3(0xd0)))_0x1e9696=_0x50d09f+'.forecast.current.temperature';else{if(_0x50d09f[_0x1bd7b3(0x111)]('weatherunderground'))_0x1e9696=_0x50d09f+_0x1bd7b3(0xc3);}}}if(_0x1e9696){const _0x43ef9d=await _0x2c6107[_0x1bd7b3(0x197)](_0x1e9696);if(_0x43ef9d&&_0x43ef9d[_0x1bd7b3(0x232)]!==undefined&&_0x43ef9d[_0x1bd7b3(0x232)]!==null)return parseFloat(_0x43ef9d['val']);}}catch(_0x30a585){}return null;}async function recordSequence(_0x1b280b,_0x53f2a3){const _0x45336d=a0_0x5d0ecf,_0x514c35=(_0x53f2a3[_0x45336d(0x1d1)]||'')[_0x45336d(0x1d0)](),_0x455d1e=[_0x45336d(0x12f),_0x45336d(0xc4),_0x45336d(0x103),_0x45336d(0x1fe),_0x45336d(0x186),'door',_0x45336d(0x233),'window',_0x45336d(0x1d2),_0x45336d(0x13a),_0x45336d(0x24d),_0x45336d(0x22e),_0x45336d(0x1f6),_0x45336d(0x213),_0x45336d(0xc7),'dimmer','lampe'];if(!_0x455d1e[_0x45336d(0xf8)](_0x26885e=>_0x514c35[_0x45336d(0x111)](_0x26885e)))return;if(!_0x53f2a3['value'])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x45336d(0xc0)]({'loc':_0x53f2a3[_0x45336d(0x198)]||'Unknown','id':_0x53f2a3['id'],'ts':Date[_0x45336d(0x129)]()}),sequenceTimer=setTimeout(async()=>{const _0x97754c=_0x45336d;if(activeSequence[_0x97754c(0x1a0)]>0x1)await saveCompletedSequence(_0x1b280b);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x4e1d6a){const _0x47c6b2=a0_0x5d0ecf;try{const _0x2e301b=await _0x4e1d6a[_0x47c6b2(0x251)]('LTM.trainingData.sequences');let _0x2987a0=[];if(_0x2e301b&&_0x2e301b[_0x47c6b2(0x232)])try{_0x2987a0=JSON['parse'](_0x2e301b[_0x47c6b2(0x232)]);}catch(_0x1a8c2e){}const _0x50fc9a=activeSequence[0x0]['ts'],_0x11ee7f=activeSequence[_0x47c6b2(0x19c)](_0xe29b56=>({'loc':_0xe29b56[_0x47c6b2(0x254)],'t_delta':Math[_0x47c6b2(0x23a)]((_0xe29b56['ts']-_0x50fc9a)/0x3e8)})),_0x21c4a6={'timestamp':new Date(_0x50fc9a)[_0x47c6b2(0xe1)](),'steps':_0x11ee7f,'duration':Math[_0x47c6b2(0x23a)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x50fc9a)/0x3e8),'daytime':new Date(_0x50fc9a)[_0x47c6b2(0x141)]()};_0x2987a0[_0x47c6b2(0xc0)](_0x21c4a6);if(_0x2987a0['length']>MAX_TRAINING_SET_SIZE)_0x2987a0[_0x47c6b2(0x139)]();await _0x4e1d6a['setStateAsync'](_0x47c6b2(0x11f),{'val':JSON['stringify'](_0x2987a0),'ack':!![]}),runSecurityCheck(_0x4e1d6a,_0x21c4a6);}catch(_0x5b1046){_0x4e1d6a[_0x47c6b2(0x167)][_0x47c6b2(0x131)](_0x47c6b2(0x140)+_0x5b1046['message']);}}function runSecurityCheck(_0x112083,_0x3af23e){const _0x1c0b01=a0_0x5d0ecf;if(!_0x112083['isProVersion'])return;sendToPython(_0x112083,_0x1c0b01(0x1b7),{'sequence':_0x3af23e});}async function createDailyDigest(_0x4f5db4){const _0x3be541=a0_0x5d0ecf;if(!_0x4f5db4[_0x3be541(0x11d)])return;await _0x4f5db4[_0x3be541(0x24c)](LTM_DP_STATUS,{'val':_0x3be541(0x255),'ack':!![]});if(!_0x4f5db4[_0x3be541(0x164)]||_0x4f5db4['rawEventLog'][_0x3be541(0x1a0)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4f5db4[_0x3be541(0x24c)](LTM_DP_STATUS,{'val':_0x3be541(0x115),'ack':!![]});return;}const _0x3eaea6=JSON['parse'](JSON['stringify'](_0x4f5db4[_0x3be541(0x121)])),_0x828c09=_0x3eaea6['length'],_0x59173d=_0x3be541(0x1f0)+JSON[_0x3be541(0x1ac)](_0x3eaea6);try{const _0x2e2463=await _0x4f5db4[_0x3be541(0x164)][_0x3be541(0x156)](_0x59173d),_0xaddbda=JSON[_0x3be541(0xb2)](_0x2e2463[_0x3be541(0x1b6)][_0x3be541(0x125)]()[_0x3be541(0x1ea)](/```json|```/g,'')[_0x3be541(0x107)]()),_0x2f2079={'timestamp':new Date()[_0x3be541(0xe1)](),'eventCount':_0x828c09,'summary':_0xaddbda[_0x3be541(0x185)]||_0x3be541(0x195),'activityLevel':_0xaddbda['activityLevel']||_0x3be541(0x147),'systemMode':_0x4f5db4[_0x3be541(0x1e1)]};_0x4f5db4[_0x3be541(0x134)][_0x3be541(0xc0)](_0x2f2079),await saveDailyDigests(_0x4f5db4),_0x4f5db4[_0x3be541(0x121)]=[],await saveRawEventLog(_0x4f5db4),await _0x4f5db4[_0x3be541(0x24c)](LTM_DP_STATUS,{'val':_0x3be541(0xea),'ack':!![]});if(_0x4f5db4[_0x3be541(0x11d)])sendToPython(_0x4f5db4,_0x3be541(0x20d),{'digest':_0x2f2079});}catch(_0x516de7){_0x4f5db4[_0x3be541(0x167)][_0x3be541(0x131)](_0x516de7[_0x3be541(0x1ad)]);}}async function runBaselineDriftAnalysis(_0x5eafe0){const _0x7ecd28=a0_0x5d0ecf;if(!_0x5eafe0['isProVersion']||!_0x5eafe0[_0x7ecd28(0x164)])return;const _0x535cdd=_0x5eafe0[_0x7ecd28(0x1a7)]['ltmStbWindowDays']||0xe;if(_0x5eafe0['dailyDigests'][_0x7ecd28(0x1a0)]<_0x535cdd+0x7){await _0x5eafe0['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x3ba274=_0x5eafe0['dailyDigests']['slice'](-_0x535cdd),_0x517966=_0x5eafe0['dailyDigests'][_0x7ecd28(0x1d7)](0x0,_0x5eafe0[_0x7ecd28(0x134)][_0x7ecd28(0x1a0)]-_0x535cdd),_0x81571d=_0x7ecd28(0x22f)+JSON['stringify'](_0x517966)+_0x7ecd28(0x25d)+JSON['stringify'](_0x3ba274);try{const _0x3232f2=await _0x5eafe0['geminiModel'][_0x7ecd28(0x156)](_0x81571d),_0x37cc83=JSON['parse'](_0x3232f2[_0x7ecd28(0x1b6)][_0x7ecd28(0x125)]()[_0x7ecd28(0x1ea)](/```json|```/g,'')['trim']());_0x37cc83[_0x7ecd28(0x152)]&&(await _0x5eafe0[_0x7ecd28(0x24c)](LTM_DP_DRIFT_STATUS,{'val':_0x37cc83[_0x7ecd28(0x152)],'ack':!![]}),await _0x5eafe0[_0x7ecd28(0x24c)](LTM_DP_DRIFT_DETAILS,{'val':_0x37cc83[_0x7ecd28(0xef)],'ack':!![]}),await _0x5eafe0[_0x7ecd28(0x24c)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x7ecd28(0x129)](),'ack':!![]}));}catch(_0x41b961){}}async function sendMorningBriefing(_0x3f0cca){const _0x2441d3=a0_0x5d0ecf;if(!_0x3f0cca[_0x2441d3(0x164)])return;try{const _0x391b64='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x56bc5c=await _0x3f0cca[_0x2441d3(0x164)]['generateContent'](_0x391b64),_0x19baa4=_0x56bc5c[_0x2441d3(0x1b6)][_0x2441d3(0x125)]();sendNotification(_0x3f0cca,_0x2441d3(0x225)+_0x19baa4);}catch(_0x159ef2){_0x3f0cca['log']['error'](_0x2441d3(0x1a8)+_0x159ef2['message']);}}function stopPythonService(_0x15ed37){const _0x5098f3=a0_0x5d0ecf;if(_0x15ed37[_0x5098f3(0x1fb)]){try{_0x15ed37['pythonProcess'][_0x5098f3(0x202)]();}catch(_0xed3c3){}_0x15ed37['pythonProcess']=null;}}function sendToPython(_0x375cbf,_0x330bcb,_0x42bb76={}){const _0x26d5a9=a0_0x5d0ecf;if(!_0x375cbf[_0x26d5a9(0x1fb)]||!_0x375cbf[_0x26d5a9(0x1fb)][_0x26d5a9(0x223)][_0x26d5a9(0xcc)])return;const _0x5c4b73=JSON[_0x26d5a9(0x1ac)]({'command':_0x330bcb,..._0x42bb76});try{_0x375cbf[_0x26d5a9(0x1fb)][_0x26d5a9(0x223)][_0x26d5a9(0x104)](_0x5c4b73+'\x0a');}catch(_0x25107f){}}function runPythonHealthCheck(_0x4a0ffe){const _0xda038a=a0_0x5d0ecf;if(!_0x4a0ffe[_0xda038a(0x134)]||_0x4a0ffe[_0xda038a(0x134)]['length']<0x2)return;const _0x3788cd=_0x4a0ffe['dailyDigests'][_0xda038a(0x19c)](_0x9718d3=>{const _0x1d6500=_0xda038a,_0x2ea623=(_0x9718d3[_0x1d6500(0x1e7)]||'')[_0x1d6500(0x1d0)]();return ACTIVITY_LEVEL_MAP[_0x2ea623]||0x32;});sendToPython(_0x4a0ffe,_0xda038a(0x1bf),{'values':_0x3788cd,'tag':_0xda038a(0x1b8)});}function handlePythonResult(_0x713b5,_0x3ad2a1){const _0x1bd59f=a0_0x5d0ecf;if(_0x3ad2a1[_0x1bd59f(0x1d1)]===_0x1bd59f(0x123))_0x713b5['log'][_0x1bd59f(0x260)]('ðŸ\x20Python\x20Pong');else{if(_0x3ad2a1['type']===_0x1bd59f(0x18c)){const {anomaly_score:_0x338cd5,is_anomaly:_0xf6050e,threshold:_0x578db6,explanation:_0x4c90d2}=_0x3ad2a1[_0x1bd59f(0x24a)];_0x713b5['log']['info'](_0x1bd59f(0x1a9)+_0x338cd5[_0x1bd59f(0x222)](0x5)+_0x1bd59f(0x174)+(_0xf6050e?_0x1bd59f(0x1a3):'OK')),_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x189),{'val':_0x338cd5,'ack':!![]}),_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x1ba),{'val':new Date()[_0x1bd59f(0xe1)](),'ack':!![]});if(_0x578db6)_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x227),{'val':_0x578db6,'ack':!![]});if(_0xf6050e){let _0x304d27=_0x1bd59f(0xb7)+_0x338cd5['toFixed'](0x4)+')';if(_0x4c90d2&&_0x4c90d2!==_0x1bd59f(0x1e9))_0x304d27+=_0x1bd59f(0x1df)+_0x4c90d2;_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x14a),{'val':!![],'ack':!![]}),_0x713b5['setStateAsync'](_0x1bd59f(0x178),{'val':_0x304d27,'ack':!![]}),sendNotification(_0x713b5,_0x1bd59f(0x237)+_0x304d27,![],!![]);}}else{if(_0x3ad2a1['type']===_0x1bd59f(0x16c)){const _0x237c92=_0x3ad2a1[_0x1bd59f(0x24a)]['details']||'',_0x1f0cb4=_0x3ad2a1[_0x1bd59f(0x24a)][_0x1bd59f(0xb4)],_0x2bdcbe=_0x3ad2a1[_0x1bd59f(0x24a)][_0x1bd59f(0x10e)]?_0x1bd59f(0xdb)+new Date()['toLocaleTimeString']()+'\x20('+_0x237c92+')':'Failed:\x20'+_0x3ad2a1['payload'][_0x1bd59f(0x1f8)];_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x244),{'val':_0x2bdcbe,'ack':!![]});if(_0x3ad2a1[_0x1bd59f(0x24a)][_0x1bd59f(0x10e)]&&_0x1f0cb4)_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x227),{'val':_0x1f0cb4,'ack':!![]});}else{if(_0x3ad2a1['type']===_0x1bd59f(0x1a1)){const {patterns:_0x545bde}=_0x3ad2a1[_0x1bd59f(0x24a)];if(_0x545bde&&_0x545bde[_0x1bd59f(0x1a0)]>0x0){_0x713b5['log']['info']('ðŸ›‹ï¸\x20BUTLER:\x20Found\x20'+_0x545bde[_0x1bd59f(0x1a0)]+_0x1bd59f(0x1a5)),_0x713b5['setStateAsync'](_0x1bd59f(0x1cf),{'val':JSON[_0x1bd59f(0x1ac)](_0x545bde),'ack':!![]});const _0x2a5bb3=_0x545bde[0x0],_0xc9adf0=_0x1bd59f(0x250)+_0x2a5bb3['rule']+'\x20('+(_0x2a5bb3[_0x1bd59f(0x119)]*0x64)[_0x1bd59f(0x222)](0x0)+'%)';_0x713b5[_0x1bd59f(0x24c)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x1d4),{'val':_0xc9adf0,'ack':!![]});}else _0x713b5[_0x1bd59f(0x167)][_0x1bd59f(0x243)](_0x1bd59f(0x1b4)),_0x713b5['setStateAsync'](_0x1bd59f(0xda),{'val':![],'ack':!![]}),_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x1cf),{'val':'[]','ack':!![]});}else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]===_0x1bd59f(0xb5)){if(_0x3ad2a1[_0x1bd59f(0x24a)]['success'])try{const _0x4f0bda=JSON['parse'](_0x3ad2a1['payload'][_0x1bd59f(0x1ab)]);if(_0x4f0bda['insulation'])_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0x228),{'val':JSON['stringify'](_0x4f0bda['insulation']),'ack':!![]});if(_0x4f0bda[_0x1bd59f(0x17c)])_0x713b5['setStateAsync']('analysis.energy.heatingScore',{'val':JSON[_0x1bd59f(0x1ac)](_0x4f0bda[_0x1bd59f(0x17c)]),'ack':!![]});}catch(_0x935baa){}}else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]===_0x1bd59f(0x16b)){if(_0x3ad2a1['payload'][_0x1bd59f(0x10e)])_0x713b5['log'][_0x1bd59f(0x243)](_0x1bd59f(0xd7));}else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]===_0x1bd59f(0x15f))_0x713b5['setStateAsync'](_0x1bd59f(0x1b5),{'val':new Date()['toISOString'](),'ack':!![]}),_0x713b5['setStateAsync'](_0x1bd59f(0x157),{'val':_0x3ad2a1[_0x1bd59f(0x24a)][_0x1bd59f(0x110)],'ack':!![]});else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]===_0x1bd59f(0x1ff))_0x713b5['setStateAsync'](_0x1bd59f(0x116),{'val':_0x3ad2a1[_0x1bd59f(0x24a)][_0x1bd59f(0x10a)],'ack':!![]}),_0x713b5['setStateAsync']('analysis.health.trendValue',{'val':_0x3ad2a1[_0x1bd59f(0x24a)][_0x1bd59f(0x1c1)],'ack':!![]});else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]===_0x1bd59f(0xec)){const {speed_trend:_0xf2adb2}=_0x3ad2a1[_0x1bd59f(0x24a)];if(_0xf2adb2!==undefined)_0x713b5['setStateAsync']('analysis.health.gaitSpeed',{'val':_0xf2adb2,'ack':!![]});}else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x516f26}=_0x3ad2a1[_0x1bd59f(0x24a)];if(_0x516f26)_0x713b5[_0x1bd59f(0x24c)]('analysis.energy.forecast',{'val':JSON[_0x1bd59f(0x1ac)](_0x516f26),'ack':!![]});}else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]==='TOPOLOGY_RESULT'){const {data:_0x427fcf}=_0x3ad2a1[_0x1bd59f(0x24a)];_0x427fcf&&(_0x713b5['log'][_0x1bd59f(0x243)]('ðŸ•¸ï¸\x20Topology\x20Map\x20updated\x20by\x20Python.'),_0x713b5[_0x1bd59f(0x24c)](_0x1bd59f(0xc9),{'val':JSON[_0x1bd59f(0x1ac)](_0x427fcf),'ack':!![]}));}else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]===_0x1bd59f(0x215))_0x713b5[_0x1bd59f(0x167)][_0x1bd59f(0x260)](_0x1bd59f(0x1dd));else{if(_0x3ad2a1[_0x1bd59f(0x1d1)]===_0x1bd59f(0x158)){}}}}}}}}}}}}}}function startPythonService(_0x1bad28){const _0x93bb52=a0_0x5d0ecf;let _0x475595=_0x93bb52(0x1af);if(fs[_0x93bb52(0x1c6)](installer[_0x93bb52(0xd2)]))_0x475595=installer['PYTHON_EXE'];try{const _0x50f1cc=path[_0x93bb52(0x1f1)](__dirname,_0x93bb52(0x1be),'service.py');_0x1bad28[_0x93bb52(0x1fb)]=spawn(_0x475595,[_0x50f1cc]),_0x1bad28[_0x93bb52(0x1fb)][_0x93bb52(0x1c0)]['on'](_0x93bb52(0xed),_0x45c056=>{const _0xddf42d=_0x93bb52,_0x22b56a=_0x45c056[_0xddf42d(0x1b0)]()[_0xddf42d(0x207)]('\x0a');_0x22b56a[_0xddf42d(0x11a)](_0x21aa5f=>{const _0x4c1329=_0xddf42d,_0x1e60d7=_0x21aa5f[_0x4c1329(0x107)]();if(!_0x1e60d7)return;if(_0x1e60d7['startsWith'](_0x4c1329(0x1c4)))_0x1bad28[_0x4c1329(0x167)][_0x4c1329(0x260)](_0x4c1329(0xfa)+_0x1e60d7[_0x4c1329(0x17d)](0x5)['trim']());else{if(_0x1e60d7[_0x4c1329(0x173)](_0x4c1329(0xf1)))try{const _0x3621f2=JSON[_0x4c1329(0xb2)](_0x1e60d7['substring'](0x8)[_0x4c1329(0x107)]());handlePythonResult(_0x1bad28,_0x3621f2);}catch(_0xffdeb3){}}});}),_0x1bad28[_0x93bb52(0x1fb)]['on']('close',_0x3e5c81=>{const _0x37ca12=_0x93bb52;_0x1bad28[_0x37ca12(0x1fb)]=null;});}catch(_0x25c07a){_0x1bad28[_0x93bb52(0x167)][_0x93bb52(0x131)](_0x93bb52(0x1f4)+_0x25c07a[_0x93bb52(0x1ad)]);}}async function runAutopilot(_0xd7566d){const _0x41d8eb=a0_0x5d0ecf;_0xd7566d[_0x41d8eb(0x167)]['debug'](_0x41d8eb(0x1cb)),await runGeminiAnalysis(_0xd7566d),updateHealthVector(_0xd7566d),triggerGaitAnalysis(_0xd7566d),triggerEnergyPrediction(_0xd7566d);}async function triggerGaitAnalysis(_0x3ef348){const _0x4ea34b=a0_0x5d0ecf;if(!_0x3ef348[_0x4ea34b(0x11d)])return;try{const _0x1109c8=await _0x3ef348['getStateAsync']('LTM.trainingData.sequences');_0x1109c8&&_0x1109c8[_0x4ea34b(0x232)]&&sendToPython(_0x3ef348,_0x4ea34b(0xc2),{'sequences':JSON['parse'](_0x1109c8[_0x4ea34b(0x232)])});}catch(_0x3b78c0){}}async function triggerEnergyPrediction(_0x5983ce){const _0xc7aeed=a0_0x5d0ecf;if(!_0x5983ce[_0xc7aeed(0x11d)])return;try{const _0x5ac35f=await getOutsideTemperatureNumeric(_0x5983ce);if(_0x5ac35f===null)return;const _0x2e6be={},_0x265792=_0x5983ce[_0xc7aeed(0x1a7)][_0xc7aeed(0x1e4)]||[];for(const _0xc605d4 of _0x265792){if(_0xc605d4[_0xc7aeed(0x1d1)]===_0xc7aeed(0x1e6)&&_0xc605d4[_0xc7aeed(0x198)]){const _0x4afee9=_0x5983ce[_0xc7aeed(0x118)][_0xc605d4['id']];if(_0x4afee9!==undefined)_0x2e6be[_0xc605d4[_0xc7aeed(0x198)]]=_0x4afee9;}}Object['keys'](_0x2e6be)[_0xc7aeed(0x1a0)]>0x0&&sendToPython(_0x5983ce,_0xc7aeed(0x101),{'current_temps':_0x2e6be,'t_out':_0x5ac35f});}catch(_0x2e9150){}}function updateHealthVector(_0x255dd2){const _0x38a332=a0_0x5d0ecf;if(!_0x255dd2[_0x38a332(0x121)]||_0x255dd2[_0x38a332(0x121)][_0x38a332(0x1a0)]===0x0)return;const _0x25e7d3=new Array(0x60)[_0x38a332(0x144)](0x0),_0x2d1a97=new Date()[_0x38a332(0x148)](0x0,0x0,0x0,0x0);_0x255dd2[_0x38a332(0x121)][_0x38a332(0x11a)](_0xc04ffc=>{const _0x4981c0=_0x38a332,_0x3e8353=new Date(_0xc04ffc[_0x4981c0(0xc8)]);if(_0x3e8353[_0x4981c0(0x23f)]()>=_0x2d1a97){const _0x141db2=_0x3e8353[_0x4981c0(0x141)](),_0x42cd5f=_0x3e8353[_0x4981c0(0x234)](),_0x23916e=_0x141db2*0x4+Math[_0x4981c0(0x1e5)](_0x42cd5f/0xf);if(_0x23916e>=0x0&&_0x23916e<0x60)_0x25e7d3[_0x23916e]++;}}),_0x255dd2[_0x38a332(0x24c)](_0x38a332(0x166),{'val':JSON[_0x38a332(0x1ac)](_0x25e7d3),'ack':!![]});}async function getWeatherContext(_0xb5e94){const _0x4a95cc=a0_0x5d0ecf;if(!_0xb5e94[_0x4a95cc(0x1a7)][_0x4a95cc(0x13d)]||!_0xb5e94[_0x4a95cc(0x1a7)][_0x4a95cc(0x20a)])return _0x4a95cc(0x113);try{const _0x4c477d=_0xb5e94[_0x4a95cc(0x1a7)]['weatherInstance'];let _0x3431e7=await _0xb5e94[_0x4a95cc(0x197)](_0x4c477d+_0x4a95cc(0xe4));if(!_0x3431e7)_0x3431e7=await _0xb5e94[_0x4a95cc(0x197)](_0x4c477d+_0x4a95cc(0x17a));let _0x26b50a=await _0xb5e94[_0x4a95cc(0x197)](_0x4c477d+_0x4a95cc(0x12d));if(!_0x26b50a)_0x26b50a=await _0xb5e94['getForeignStateAsync'](_0x4c477d+_0x4a95cc(0x22d));if(_0x3431e7&&_0x26b50a)return _0x3431e7[_0x4a95cc(0x232)]+_0x4a95cc(0x24f)+_0x26b50a['val'];}catch(_0x17c5e6){}return _0x4a95cc(0x159);}async function getCalendarContext(_0x5445f8){const _0x38f2c1=a0_0x5d0ecf;if(!_0x5445f8['config'][_0x38f2c1(0x136)]||!_0x5445f8[_0x38f2c1(0x1a7)]['calendarInstance'])return _0x38f2c1(0x172);return _0x38f2c1(0x21a);}async function getCalendarNames(_0x39ebf5,_0x4aa493){return[];}async function saveFeedback(_0x28c438,_0x3e6b3a){const _0x54d612=a0_0x5d0ecf;_0x28c438[_0x54d612(0x167)][_0x54d612(0x243)](_0x54d612(0x1f7)+_0x3e6b3a['rating']);}async function runGeminiAnalysis(_0x3e5748,_0x21258a=''){const _0x48ef8e=a0_0x5d0ecf;if(!_0x3e5748[_0x48ef8e(0x164)])return;if(_0x3e5748[_0x48ef8e(0x245)]['length']===0x0)return;const _0x38d41f=_0x3e5748['eventHistory'][_0x48ef8e(0x1d7)](0x0,0xf),_0x3b4cde=await getWeatherContext(_0x3e5748),_0x98d080=_0x3e5748['currentSystemMode'],_0x1e284b=PERSONA_MAPPING[_0x3e5748[_0x48ef8e(0x1a7)]['aiPersona']||_0x48ef8e(0x171)],_0x1897c7=_0x3e5748['config'][_0x48ef8e(0x22c)]||_0x48ef8e(0x17e);let _0x437fc6='Unbekannt';try{const _0x9477fb=await _0x3e5748[_0x48ef8e(0x251)](_0x48ef8e(0x23c));if(_0x9477fb&&_0x9477fb[_0x48ef8e(0x232)])_0x437fc6=_0x9477fb['val'];}catch(_0x42a448){}let _0x588eb3=![];try{const _0x479521=await _0x3e5748['getStateAsync'](_0x48ef8e(0xca));if(_0x479521&&_0x479521['val'])_0x588eb3=!![];}catch(_0x202b3c){}const _0x44b832=_0x48ef8e(0x18b)+_0x1e284b+_0x48ef8e(0x1bd)+_0x1897c7+_0x48ef8e(0x25f)+_0x98d080+_0x48ef8e(0x18e)+_0x3b4cde+_0x48ef8e(0x231)+_0x437fc6+_0x48ef8e(0xb3)+JSON[_0x48ef8e(0x1ac)](_0x38d41f)+'.\x20EMERGENCY:\x20'+_0x21258a+_0x48ef8e(0x114);try{const _0x57e75e=await _0x3e5748['geminiModel'][_0x48ef8e(0x156)](_0x44b832),_0x38325e=JSON[_0x48ef8e(0xb2)](_0x57e75e[_0x48ef8e(0x1b6)][_0x48ef8e(0x125)]()[_0x48ef8e(0x1ea)](/```json|```/g,'')['trim']());await _0x3e5748['setStateAsync'](_0x48ef8e(0x146),{'val':JSON[_0x48ef8e(0x1ac)](_0x38325e),'ack':!![]});if(_0x38325e[_0x48ef8e(0x185)])await _0x3e5748[_0x48ef8e(0x24c)]('analysis.activitySummary',{'val':_0x38325e[_0x48ef8e(0x185)],'ack':!![]});const _0x262c7a={'timestamp':Date[_0x48ef8e(0x129)](),'id':Date['now']()[_0x48ef8e(0x1b0)](),'analysis':{'activity':{'summary':_0x38325e['summary'],'isAlert':_0x38325e[_0x48ef8e(0x1bc)],'alertReason':_0x38325e[_0x48ef8e(0x1bb)]},'comfort':{'automationProposal':_0x38325e['automationProposal']}}};await updateAnalysisHistory(_0x3e5748,_0x262c7a);const _0xc85317=_0x38325e[_0x48ef8e(0x1bc)]||![];_0xc85317!==_0x3e5748[_0x48ef8e(0x218)]&&(await _0x3e5748[_0x48ef8e(0x24c)]('analysis.isAlert',{'val':_0xc85317,'ack':!![]}),_0x3e5748[_0x48ef8e(0x218)]=_0xc85317,_0xc85317&&(await _0x3e5748[_0x48ef8e(0x24c)]('analysis.alertReason',{'val':_0x38325e[_0x48ef8e(0x1bb)],'ack':!![]}),sendNotification(_0x3e5748,_0x48ef8e(0x1f5)+_0x38325e[_0x48ef8e(0x1bb)],![],_0x38325e[_0x48ef8e(0xe8)])));if(_0x38325e[_0x48ef8e(0xd3)]&&_0x38325e[_0x48ef8e(0xd3)][_0x48ef8e(0xd9)]){await _0x3e5748[_0x48ef8e(0x24c)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x3e5748['setStateAsync']('analysis.automation.description',{'val':_0x38325e[_0x48ef8e(0xd3)][_0x48ef8e(0x257)],'ack':!![]}),await _0x3e5748[_0x48ef8e(0x24c)]('analysis.automation.targetId',{'val':_0x38325e[_0x48ef8e(0xd3)][_0x48ef8e(0x1ee)],'ack':!![]}),await _0x3e5748[_0x48ef8e(0x24c)](_0x48ef8e(0x230),{'val':JSON[_0x48ef8e(0x1ac)](_0x38325e['automationProposal']['targetValue']),'ack':!![]});if(_0x588eb3)executeAutomationAction(_0x3e5748);}}catch(_0x5dd8c0){_0x3e5748['log'][_0x48ef8e(0x131)](_0x48ef8e(0x14c)+_0x5dd8c0[_0x48ef8e(0x1ad)]);}}async function startSystem(_0x34f72f){const _0x50e9a0=a0_0x5d0ecf;_0x34f72f[_0x50e9a0(0x167)]['info'](_0x50e9a0(0xdc)),await initZombies(_0x34f72f);try{_0x34f72f[_0x50e9a0(0x11d)]=await checkLicense(_0x34f72f[_0x50e9a0(0x1a7)][_0x50e9a0(0x15d)]);}catch(_0x3edef8){}if(!_0x34f72f[_0x50e9a0(0x1a7)]['inactivityThresholdHours']||_0x34f72f[_0x50e9a0(0x1a7)][_0x50e9a0(0x13e)]<0.1)_0x34f72f['config'][_0x50e9a0(0x13e)]=0xc;await initHistory(_0x34f72f),await initSystemConfig(_0x34f72f);if(_0x34f72f[_0x50e9a0(0x1a7)][_0x50e9a0(0x214)])try{_0x34f72f[_0x50e9a0(0x1c3)]=new GoogleGenerativeAI(_0x34f72f[_0x50e9a0(0x1a7)][_0x50e9a0(0x214)]),_0x34f72f['geminiModel']=_0x34f72f[_0x50e9a0(0x1c3)][_0x50e9a0(0x18d)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x50e9a0(0xd4)}}),_0x34f72f[_0x50e9a0(0x167)][_0x50e9a0(0x243)](_0x50e9a0(0x24b));}catch(_0x5d54d0){_0x34f72f['log'][_0x50e9a0(0x131)](_0x50e9a0(0x13f)+_0x5d54d0[_0x50e9a0(0x1ad)]);}await createAllObjects(_0x34f72f),await loadSystemMode(_0x34f72f),await loadRawEventLog(_0x34f72f),await loadDailyDigests(_0x34f72f),_0x34f72f[_0x50e9a0(0x133)](_0x50e9a0(0x190)),_0x34f72f[_0x50e9a0(0x133)](LTM_DP_TRIGGER_DIGEST),_0x34f72f[_0x50e9a0(0x133)]('system.mode'),_0x34f72f['subscribeStates'](_0x50e9a0(0xdf)),_0x34f72f['subscribeStates']('analysis.automation.triggerAction'),_0x34f72f[_0x50e9a0(0x133)](_0x50e9a0(0xca)),_0x34f72f[_0x50e9a0(0x133)](_0x50e9a0(0x14b)),_0x34f72f[_0x50e9a0(0x133)](_0x50e9a0(0xf0)),_0x34f72f[_0x50e9a0(0x133)](_0x50e9a0(0x1f9)),_0x34f72f[_0x50e9a0(0x133)]('analysis.training.triggerComfort'),_0x34f72f[_0x50e9a0(0x133)](_0x50e9a0(0x20f)),await initSensorSubscriptions(_0x34f72f),await initPresenceSubscriptions(_0x34f72f),await setupTelegramListener(_0x34f72f),setTimeout(()=>checkWifiPresence(_0x34f72f),0x1388);if(_0x34f72f[_0x50e9a0(0x242)])clearInterval(_0x34f72f['analysisTimer']);const _0x1d25d8=_0x34f72f[_0x50e9a0(0x1a7)][_0x50e9a0(0x1ec)]||0xf;_0x1d25d8>0x0&&(_0x34f72f[_0x50e9a0(0x242)]=setInterval(()=>{runAutopilot(_0x34f72f);},_0x1d25d8*0x3c*0x3e8)),schedulers[_0x50e9a0(0x25c)](_0x34f72f,()=>createDailyDigest(_0x34f72f)),schedulers[_0x50e9a0(0xe9)](_0x34f72f),schedulers[_0x50e9a0(0x1d9)](_0x34f72f,()=>runBaselineDriftAnalysis(_0x34f72f)),schedulers[_0x50e9a0(0x19a)](_0x34f72f,()=>sendMorningBriefing(_0x34f72f)),startPythonService(_0x34f72f),setTimeout(async()=>{const _0x2c6b04=_0x50e9a0;await topology[_0x2c6b04(0x196)](_0x34f72f);try{const _0x3a8b26=await _0x34f72f[_0x2c6b04(0x251)](_0x2c6b04(0xf5));if(_0x3a8b26&&_0x3a8b26['val'])sendToPython(_0x34f72f,_0x2c6b04(0x240),JSON[_0x2c6b04(0xb2)](_0x3a8b26[_0x2c6b04(0x232)]));}catch(_0x2f09f8){}_0x34f72f[_0x2c6b04(0x1fb)]&&(runPythonHealthCheck(_0x34f72f),triggerGaitAnalysis(_0x34f72f),triggerEnergyPrediction(_0x34f72f)),updateHealthVector(_0x34f72f);},0x1388);}class CogniLiving extends utils[a0_0x5d0ecf(0x25e)]{constructor(_0x5e8cca){const _0x3a6dfe=a0_0x5d0ecf;super({..._0x5e8cca,'name':'cogni-living'}),this[_0x3a6dfe(0x245)]=[],this[_0x3a6dfe(0x150)]=[],this[_0x3a6dfe(0x121)]=[],this[_0x3a6dfe(0x134)]=[],this[_0x3a6dfe(0x118)]={},this[_0x3a6dfe(0x169)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x3a6dfe(0xfc)]=null,this[_0x3a6dfe(0x252)]=null,this['isGracePeriodActive']=![],this['genAI']=null,this[_0x3a6dfe(0x164)]=null,this[_0x3a6dfe(0x1e1)]=SYSTEM_MODES['NORMAL'],this[_0x3a6dfe(0x11d)]=![],this['lastAlertState']=![],this[_0x3a6dfe(0xcf)]=_0x3a6dfe(0x220),this[_0x3a6dfe(0x242)]=null,this[_0x3a6dfe(0xf9)]=null,this[_0x3a6dfe(0x20c)]=null,this[_0x3a6dfe(0x149)]=null,this[_0x3a6dfe(0xdd)]=null,this[_0x3a6dfe(0x1fb)]=null,this[_0x3a6dfe(0x203)]=![],this['on'](_0x3a6dfe(0x1b2),this[_0x3a6dfe(0x248)]['bind'](this)),this['on'](_0x3a6dfe(0x155),this[_0x3a6dfe(0x1e3)][_0x3a6dfe(0x201)](this)),this['on'](_0x3a6dfe(0x135),this[_0x3a6dfe(0xbf)]['bind'](this)),this['on']('message',this[_0x3a6dfe(0x199)][_0x3a6dfe(0x201)](this));}async[a0_0x5d0ecf(0x248)](){const _0x4e6863=a0_0x5d0ecf;this['log'][_0x4e6863(0x243)](_0x4e6863(0x1c7)+this[_0x4e6863(0x23d)]+_0x4e6863(0x1cc));if(!installer[_0x4e6863(0x24e)](this,()=>startSystem(this)))return;}[a0_0x5d0ecf(0xbf)](_0x55e858){const _0x2563fc=a0_0x5d0ecf;if(this[_0x2563fc(0x242)])clearInterval(this[_0x2563fc(0x242)]);if(this[_0x2563fc(0x149)])clearInterval(this['driftAnalysisTimer']);if(this['ltmJob'])this['ltmJob'][_0x2563fc(0x21d)]();if(this[_0x2563fc(0x20c)])this[_0x2563fc(0x20c)]['cancel']();if(this['briefingJob'])this['briefingJob'][_0x2563fc(0x21d)]();if(this['exitTimer'])clearTimeout(this[_0x2563fc(0xfc)]);if(this[_0x2563fc(0x252)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x55e858();}async['onStateChange'](_0x22d38f,_0x3b0024){const _0xc30de2=a0_0x5d0ecf;if(!_0x3b0024||this[_0xc30de2(0x203)])return;if(_0x22d38f['includes'](_0xc30de2(0x105))&&_0x22d38f[_0xc30de2(0x106)](_0xc30de2(0x17b))&&_0x3b0024['val']){await handleTelegramResponse(this,_0x3b0024['val']);return;}if(_0x22d38f===this[_0xc30de2(0x15a)]+'.'+SYSTEM_DP_MODE){if(_0x3b0024['val']&&Object[_0xc30de2(0x1b1)](SYSTEM_MODES)[_0xc30de2(0x111)](_0x3b0024['val'])){this['currentSystemMode']=_0x3b0024['val'];if(_0x3b0024[_0xc30de2(0x232)]===SYSTEM_MODES['VACATION'])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x3b0024[_0xc30de2(0x1cd)])this[_0xc30de2(0x182)](_0x22d38f,{'val':this[_0xc30de2(0x1e1)],'ack':!![]});return;}if(!_0x3b0024[_0xc30de2(0x1cd)]){_0x22d38f['includes'](_0xc30de2(0x190))&&_0x3b0024[_0xc30de2(0x232)]&&(this['setState'](_0x22d38f,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x22d38f[_0xc30de2(0x111)](_0xc30de2(0x219))&&_0x3b0024[_0xc30de2(0x232)]){this[_0xc30de2(0x182)](_0x22d38f,{'val':![],'ack':!![]});if(this[_0xc30de2(0x11d)])createDailyDigest(this);}_0x22d38f['includes']('triggerBriefing')&&_0x3b0024[_0xc30de2(0x232)]&&(this['setState'](_0x22d38f,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x22d38f[_0xc30de2(0x111)](_0xc30de2(0x1e2))&&_0x3b0024[_0xc30de2(0x232)]&&(this['setState'](_0x22d38f,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x22d38f['includes'](_0xc30de2(0x14b))&&_0x3b0024['val']){this[_0xc30de2(0x182)](_0x22d38f,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x40e853=await this[_0xc30de2(0x251)](_0xc30de2(0x11f));if(_0x40e853&&_0x40e853[_0xc30de2(0x232)]){const _0x15ea51=JSON[_0xc30de2(0xb2)](_0x40e853[_0xc30de2(0x232)]);this[_0xc30de2(0x167)][_0xc30de2(0x243)](_0xc30de2(0xbe)),this[_0xc30de2(0x24c)](_0xc30de2(0x244),{'val':_0xc30de2(0x16e),'ack':!![]}),sendToPython(this,_0xc30de2(0xd5),{'sequences':_0x15ea51});}}catch(_0x2c0361){this[_0xc30de2(0x167)][_0xc30de2(0x131)]('Training\x20Error:\x20'+_0x2c0361['message']);}}if(_0x22d38f[_0xc30de2(0x111)](_0xc30de2(0xf0))&&_0x3b0024[_0xc30de2(0x232)]){this[_0xc30de2(0x182)](_0x22d38f,{'val':![],'ack':!![]});if(this[_0xc30de2(0x11d)])try{const _0x468013=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x468013&&_0x468013[_0xc30de2(0x232)])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON['parse'](_0x468013['val'])});}catch(_0x13428e){}}if(_0x22d38f[_0xc30de2(0x111)]('analysis.training.triggerEnergy')&&_0x3b0024['val']){this[_0xc30de2(0x182)](_0x22d38f,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x92dd25=await this[_0xc30de2(0x251)]('LTM.trainingData.thermodynamics');if(_0x92dd25&&_0x92dd25[_0xc30de2(0x232)])sendToPython(this,'TRAIN_ENERGY',{'points':JSON['parse'](_0x92dd25[_0xc30de2(0x232)])});}catch(_0x1ddf83){}}if(_0x22d38f[_0xc30de2(0x111)](_0xc30de2(0x108))&&_0x3b0024['val']){this[_0xc30de2(0x182)](_0x22d38f,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x2b9a02=await this[_0xc30de2(0x251)](LTM_DP_RAW_LOG);_0x2b9a02&&_0x2b9a02['val']&&(this[_0xc30de2(0x167)][_0xc30de2(0x243)](_0xc30de2(0xd8)),sendToPython(this,'TRAIN_COMFORT',{'events':JSON['parse'](_0x2b9a02[_0xc30de2(0x232)])}));}catch(_0x3b0e28){}}_0x22d38f[_0xc30de2(0x111)](_0xc30de2(0x20f))&&_0x3b0024[_0xc30de2(0x232)]&&(this['setState'](_0x22d38f,{'val':![],'ack':!![]}),this[_0xc30de2(0x167)][_0xc30de2(0x243)](_0xc30de2(0x11c)),topology['updateTopology'](this));return;}if(this[_0xc30de2(0x1a7)][_0xc30de2(0x165)]&&this[_0xc30de2(0x1a7)][_0xc30de2(0x165)]['includes'](_0x22d38f)){await checkWifiPresence(this);return;}const _0x2ce302=(this['config'][_0xc30de2(0x1e4)]||[])[_0xc30de2(0xe2)](_0x33e718=>_0x33e718['id']===_0x22d38f);if(_0x2ce302)processSensorEvent(this,_0x22d38f,_0x3b0024,_0x2ce302);}async['onMessage'](_0x4d9374){const _0x574478=a0_0x5d0ecf;if(typeof _0x4d9374===_0x574478(0x18f)&&_0x4d9374[_0x574478(0x1ad)]){if(_0x4d9374[_0x574478(0x1b9)]===_0x574478(0x117)){const _0x3f155a=_0x4d9374[_0x574478(0x1ad)][_0x574478(0x15c)]||this[_0x574478(0x1a7)][_0x574478(0x214)];if(!_0x3f155a)return this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':![],'message':'Kein\x20API\x20Key.'},_0x4d9374['callback']);try{const _0x4fddce=new GoogleGenerativeAI(_0x3f155a),_0x5b4c58=_0x4fddce['getGenerativeModel']({'model':GEMINI_MODEL}),_0x5f3a03=await _0x5b4c58[_0x574478(0x156)]('Hi');this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':!![],'message':'OK:\x20'+_0x5f3a03[_0x574478(0x1b6)]['text']()},_0x4d9374[_0x574478(0xd1)]);}catch(_0xa21491){this['sendTo'](_0x4d9374['from'],_0x4d9374[_0x574478(0x1b9)],{'success':![],'message':_0x574478(0x25b)+_0xa21491[_0x574478(0x1ad)]},_0x4d9374[_0x574478(0xd1)]);}}else{if(_0x4d9374[_0x574478(0x1b9)]===_0x574478(0x1db)){const _0x52808f=await getWeatherContext(this),_0x2b2a5d=await getCalendarContext(this);this[_0x574478(0x184)](_0x4d9374['from'],_0x4d9374[_0x574478(0x1b9)],{'success':!![],'weather':_0x52808f,'calendar':_0x2b2a5d},_0x4d9374[_0x574478(0xd1)]);}else{if(_0x4d9374[_0x574478(0x1b9)]===_0x574478(0x1d3)){if(!this['isProVersion'])return this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':![],'isPro':![]},_0x4d9374['callback']);let _0x589a38={'status':_0x574478(0x1a6)};try{const _0x5430cd=await this[_0x574478(0x251)](LTM_DP_DRIFT_STATUS);_0x589a38[_0x574478(0x217)]=_0x5430cd?_0x5430cd[_0x574478(0x232)]:_0x574478(0x1a6);}catch(_0xaf533f){}this['sendTo'](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x574478(0x134)],'driftAnalysis':_0x589a38,'analysisHistory':this[_0x574478(0x150)]},_0x4d9374[_0x574478(0xd1)]);}else{if(_0x4d9374[_0x574478(0x1b9)]==='getOverviewData'){const _0xcc5fb2=this[_0x574478(0x134)][_0x574478(0x1a0)],_0x5b7726=new Date(),_0x2087c5=new Date(_0x5b7726[_0x574478(0xc5)](),_0x5b7726['getMonth'](),_0x5b7726[_0x574478(0x17f)]())['getTime'](),_0x1da5d4=this['rawEventLog']['filter'](_0x638355=>new Date(_0x638355[_0x574478(0xc8)])[_0x574478(0x23f)]()>_0x2087c5)[_0x574478(0x1a0)],_0x30abbc=new Array(0x18)[_0x574478(0x144)](0x0);this['rawEventLog'][_0x574478(0x11a)](_0x66e24c=>{const _0x4106b8=_0x574478,_0x2062ac=new Date(_0x66e24c[_0x4106b8(0xc8)]);if(_0x2062ac['getTime']()>_0x2087c5)_0x30abbc[_0x2062ac[_0x4106b8(0x141)]()]++;});let _0x45e7e7={'status':_0x574478(0x1a6)};try{const _0x5c974a=await this[_0x574478(0x251)](LTM_DP_DRIFT_STATUS);_0x45e7e7['status']=_0x5c974a?_0x5c974a[_0x574478(0x232)]:_0x574478(0x1a6);}catch(_0x232f58){}let _0x5e89f7='';try{const _0x373aa4=await this[_0x574478(0x251)](_0x574478(0x23c));_0x5e89f7=_0x373aa4?_0x373aa4[_0x574478(0x232)]:'';}catch(_0x1d96ba){}let _0x37ba82=null;!this['geminiModel']&&(_0x37ba82=this[_0x574478(0x1a7)]['geminiApiKey']?_0x574478(0x212):_0x574478(0x15b));let _0x415abf={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x30ea8d=await this[_0x574478(0x251)](_0x574478(0xda));if(_0x30ea8d&&_0x30ea8d['val']){_0x415abf[_0x574478(0xd9)]=!![];const _0x581169=await this[_0x574478(0x251)]('analysis.automation.description');_0x415abf[_0x574478(0x257)]=_0x581169?_0x581169[_0x574478(0x232)]:'';const _0x1fc2ff=await this[_0x574478(0x251)]('analysis.automation.targetId');_0x415abf[_0x574478(0x1ee)]=_0x1fc2ff?_0x1fc2ff['val']:'';const _0x3cbecf=await this[_0x574478(0x251)](_0x574478(0x230));_0x415abf[_0x574478(0x205)]=_0x3cbecf?_0x3cbecf['val']:'';}const _0x2df7d3=await this['getStateAsync'](_0x574478(0xca));_0x415abf[_0x574478(0x177)]=_0x2df7d3?!!_0x2df7d3['val']:![];}catch(_0x3975fd){}this['sendTo'](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0xf),'stats':{'digestCount':_0xcc5fb2,'eventCountToday':_0x1da5d4,'hourlyActivity':_0x30abbc,'driftStatus':_0x45e7e7[_0x574478(0x217)],'isPresent':this[_0x574478(0x142)],'presenceWho':_0x5e89f7,'minDays':this[_0x574478(0x1a7)][_0x574478(0x1ae)]||0x7,'stbDays':this[_0x574478(0x1a7)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x574478(0x1a7)][_0x574478(0x160)]||0x3c,'systemError':_0x37ba82},'automation':_0x415abf},_0x4d9374[_0x574478(0xd1)]);}else{if(_0x4d9374['command']===_0x574478(0x1ed))try{const _0x5c50a9=await scanner[_0x574478(0xb8)](this,_0x4d9374[_0x574478(0x1ad)]||{});this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374['command'],{'success':!![],'devices':_0x5c50a9},_0x4d9374[_0x574478(0xd1)]);}catch(_0x8f4293){this['sendTo'](_0x4d9374[_0x574478(0xfb)],_0x4d9374['command'],{'success':![],'error':_0x8f4293[_0x574478(0x1ad)]},_0x4d9374[_0x574478(0xd1)]);}else{if(_0x4d9374[_0x574478(0x1b9)]===_0x574478(0xba)){const _0x2ae87a=await this['getForeignObjectsAsync']('enum.functions.*','enum'),_0x574e4a=[];if(_0x2ae87a)for(const _0x18f2f2 in _0x2ae87a){const _0x5c0379=_0x2ae87a[_0x18f2f2],_0x7e817f=(_0x5c0379['common']&&typeof _0x5c0379[_0x574478(0x10c)]['name']===_0x574478(0x18f)?_0x5c0379[_0x574478(0x10c)][_0x574478(0xbc)]['de']:_0x5c0379['common']['name'])||_0x5c0379['common'][_0x574478(0xbc)];_0x574e4a[_0x574478(0xc0)]({'id':_0x18f2f2,'name':_0x7e817f});}const _0x23315a=await this[_0x574478(0x130)]('enum.rooms.*',_0x574478(0x176)),_0x59ba05=[];if(_0x23315a)for(const _0x131f53 in _0x23315a){const _0xc38efe=_0x23315a[_0x131f53],_0x226608=(_0xc38efe[_0x574478(0x10c)]&&typeof _0xc38efe[_0x574478(0x10c)][_0x574478(0xbc)]===_0x574478(0x18f)?_0xc38efe[_0x574478(0x10c)][_0x574478(0xbc)]['de']:_0xc38efe[_0x574478(0x10c)][_0x574478(0xbc)])||_0x131f53[_0x574478(0x207)]('.')[_0x574478(0x19d)]();_0x59ba05[_0x574478(0xc0)](_0x226608);}this['sendTo'](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':!![],'enums':_0x574e4a,'rooms':_0x59ba05},_0x4d9374['callback']);}else{if(_0x4d9374[_0x574478(0x1b9)]===_0x574478(0x143)){const _0x149730=_0x4d9374[_0x574478(0x1ad)][_0x574478(0x23e)];if(!_0x149730)return this['sendTo'](_0x4d9374['from'],_0x4d9374[_0x574478(0x1b9)],{'success':![],'error':_0x574478(0x16d)},_0x4d9374[_0x574478(0xd1)]);const _0x276d05=await getCalendarNames(this,_0x149730);this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':!![],'names':_0x276d05},_0x4d9374[_0x574478(0xd1)]);}else{if(_0x4d9374[_0x574478(0x1b9)]===_0x574478(0x1de)){const {targetId:_0x5cb82c,targetValue:_0x464551}=_0x4d9374[_0x574478(0x1ad)];this['log']['info'](_0x574478(0x208)+_0x5cb82c+_0x574478(0x151)+_0x464551),await this[_0x574478(0x24c)](_0x574478(0xda),{'val':!![],'ack':!![]}),await this['setStateAsync']('analysis.automation.description',{'val':_0x574478(0x235)+_0x5cb82c,'ack':!![]}),await this['setStateAsync']('analysis.automation.targetId',{'val':_0x5cb82c,'ack':!![]}),await this[_0x574478(0x24c)](_0x574478(0x230),{'val':_0x464551,'ack':!![]}),this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374['command'],{'success':!![]},_0x4d9374[_0x574478(0xd1)]);}else{if(_0x4d9374[_0x574478(0x1b9)]===_0x574478(0x1ca)){const {historyId:_0x135cbe,rating:_0x4a7d98,comment:_0x4336f2,alertReason:_0x2f610b}=_0x4d9374['message'];_0x135cbe&&_0x4a7d98?(await saveFeedback(this,{'timestamp':Date[_0x574478(0x129)](),'historyId':_0x135cbe,'rating':_0x4a7d98,'comment':_0x4336f2,'alertReason':_0x2f610b}),this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':!![]},_0x4d9374['callback'])):this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':![],'error':'Missing\x20data'},_0x4d9374[_0x574478(0xd1)]);}else{if(_0x4d9374[_0x574478(0x1b9)]==='dismissAutomation')this[_0x574478(0x167)][_0x574478(0x243)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x574478(0x24c)](_0x574478(0xda),{'val':![],'ack':!![]}),await this[_0x574478(0x24c)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x574478(0x184)](_0x4d9374['from'],_0x4d9374['command'],{'success':!![]},_0x4d9374[_0x574478(0xd1)]);else{if(_0x4d9374[_0x574478(0x1b9)]===_0x574478(0xcb)){const {matrix:_0x32076c}=_0x4d9374['message'];try{const _0x1a4c69=await this[_0x574478(0x251)]('analysis.topology.structure');if(_0x1a4c69&&_0x1a4c69[_0x574478(0x232)]){const _0x1e6a32=JSON['parse'](_0x1a4c69[_0x574478(0x232)]);_0x1e6a32[_0x574478(0x1d8)]=_0x32076c,_0x1e6a32['updated']=Date[_0x574478(0x129)](),await this[_0x574478(0x24c)](_0x574478(0xf5),{'val':JSON[_0x574478(0x1ac)](_0x1e6a32),'ack':!![]}),this['log'][_0x574478(0x243)](_0x574478(0xbb)),sendToPython(this,_0x574478(0x240),_0x1e6a32);}this[_0x574478(0x184)](_0x4d9374[_0x574478(0xfb)],_0x4d9374[_0x574478(0x1b9)],{'success':!![]},_0x4d9374[_0x574478(0xd1)]);}catch(_0x4a0f27){this[_0x574478(0x167)][_0x574478(0x131)](_0x574478(0x180)+_0x4a0f27[_0x574478(0x1ad)]);}}}}}}}}}}}}}}}if(require[a0_0x5d0ecf(0x1dc)]!==module)module[a0_0x5d0ecf(0x19f)]=_0xba5e02=>new CogniLiving(_0xba5e02);else new CogniLiving();