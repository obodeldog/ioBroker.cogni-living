const a0_0x572d97=a0_0x6611;(function(_0x4bfbce,_0xaf87fc){const _0x59e9e0=a0_0x6611,_0x2fdf90=_0x4bfbce();while(!![]){try{const _0x4c17b8=-parseInt(_0x59e9e0(0x14f))/0x1+parseInt(_0x59e9e0(0x1d1))/0x2+-parseInt(_0x59e9e0(0x291))/0x3+parseInt(_0x59e9e0(0x243))/0x4+parseInt(_0x59e9e0(0x279))/0x5+parseInt(_0x59e9e0(0x2a2))/0x6+-parseInt(_0x59e9e0(0x1ab))/0x7;if(_0x4c17b8===_0xaf87fc)break;else _0x2fdf90['push'](_0x2fdf90['shift']());}catch(_0x38aeb3){_0x2fdf90['push'](_0x2fdf90['shift']());}}}(a0_0x3011,0x7b811));const a0_0x94086d=(function(){let _0x103ff3=!![];return function(_0x3159d7,_0x243100){const _0x4ffc58=_0x103ff3?function(){const _0x4bd26e=a0_0x6611;if(_0x243100){const _0x48665b=_0x243100[_0x4bd26e(0x2d2)](_0x3159d7,arguments);return _0x243100=null,_0x48665b;}}:function(){};return _0x103ff3=![],_0x4ffc58;};}()),a0_0x16a955=a0_0x94086d(this,function(){const _0x29695b=a0_0x6611;return a0_0x16a955['toString']()[_0x29695b(0x1dd)](_0x29695b(0x2dc))[_0x29695b(0x173)]()['constructor'](a0_0x16a955)[_0x29695b(0x1dd)](_0x29695b(0x2dc));});a0_0x16a955();'use strict';const utils=require(a0_0x572d97(0x2ae)),{GoogleGenerativeAI}=require(a0_0x572d97(0x1aa)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x572d97(0x13f)),path=require(a0_0x572d97(0x241)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x572d97(0x1fc),MODE_RESET_SCHEDULE=a0_0x572d97(0x232),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x572d97(0x145),LTM_DP_DAILY_DIGESTS=a0_0x572d97(0x2ab),LTM_DP_STATUS=a0_0x572d97(0x2c3),LTM_DP_TRIGGER_DIGEST=a0_0x572d97(0x148),LTM_DP_BASELINE_STATUS=a0_0x572d97(0x2c5),LTM_DP_DRIFT_CHANNEL=a0_0x572d97(0x25e),LTM_DP_DRIFT_STATUS=a0_0x572d97(0x191),LTM_DP_DRIFT_DETAILS=a0_0x572d97(0x27a),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x572d97(0x210),'VACATION':a0_0x572d97(0x139),'PARTY':a0_0x572d97(0x1ea),'GUEST':a0_0x572d97(0x225)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x572d97(0x2b6)],SYSTEM_MODES[a0_0x572d97(0x234)]],PERSONA_MAPPING={'generic':a0_0x572d97(0x152),'senior_aal':'PRIORITÃ„T:\x20Gesundheit/AAL.','family':a0_0x572d97(0x286),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x572d97(0x159)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process['platform']===a0_0x572d97(0x2ac),PERSISTENT_DIR=path[a0_0x572d97(0x254)](__dirname,a0_0x572d97(0x146)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path[a0_0x572d97(0x254)](VENV_PATH,a0_0x572d97(0x18f),a0_0x572d97(0x193)):path[a0_0x572d97(0x254)](VENV_PATH,a0_0x572d97(0x13d),a0_0x572d97(0x19e)),PIP_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x572d97(0x18f),'pip.exe'):path[a0_0x572d97(0x254)](VENV_PATH,a0_0x572d97(0x13d),a0_0x572d97(0x28d));let activeSequence=[],sequenceTimer=null;async function startSystem(_0x2f264f){const _0x2193b0=a0_0x572d97;_0x2f264f[_0x2193b0(0x2bc)][_0x2193b0(0x177)](_0x2193b0(0x1e9)),await initZombies(_0x2f264f);try{_0x2f264f['isProVersion']=await checkLicense(_0x2f264f['config'][_0x2193b0(0x1d9)]);}catch(_0x48b375){}if(!_0x2f264f[_0x2193b0(0x285)][_0x2193b0(0x13e)]||_0x2f264f[_0x2193b0(0x285)][_0x2193b0(0x13e)]<0.1)_0x2f264f[_0x2193b0(0x285)]['inactivityThresholdHours']=0xc;await initHistory(_0x2f264f),await initSystemConfig(_0x2f264f);if(_0x2f264f[_0x2193b0(0x285)][_0x2193b0(0x1f2)])try{_0x2f264f[_0x2193b0(0x25b)]=new GoogleGenerativeAI(_0x2f264f[_0x2193b0(0x285)]['geminiApiKey']),_0x2f264f[_0x2193b0(0x1c1)]=_0x2f264f[_0x2193b0(0x25b)][_0x2193b0(0x195)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2193b0(0x1ec)}}),_0x2f264f[_0x2193b0(0x2bc)][_0x2193b0(0x177)](_0x2193b0(0x229));}catch(_0x280a29){_0x2f264f[_0x2193b0(0x2bc)][_0x2193b0(0x1d3)]('Gemini\x20Init\x20Error:\x20'+_0x280a29[_0x2193b0(0x276)]);}await createAllObjects(_0x2f264f),await loadSystemMode(_0x2f264f),await loadRawEventLog(_0x2f264f),await loadDailyDigests(_0x2f264f),_0x2f264f[_0x2193b0(0x20a)](_0x2193b0(0x1f7)),_0x2f264f['subscribeStates'](LTM_DP_TRIGGER_DIGEST),_0x2f264f['subscribeStates'](_0x2193b0(0x250)),_0x2f264f[_0x2193b0(0x20a)](_0x2193b0(0x157)),_0x2f264f[_0x2193b0(0x20a)](_0x2193b0(0x1c0)),_0x2f264f[_0x2193b0(0x20a)](_0x2193b0(0x20c)),_0x2f264f[_0x2193b0(0x20a)](_0x2193b0(0x1ee)),_0x2f264f[_0x2193b0(0x20a)]('analysis.training.triggerHealth'),_0x2f264f['subscribeStates'](_0x2193b0(0x27f)),_0x2f264f['subscribeStates'](_0x2193b0(0x26b)),await initSensorSubscriptions(_0x2f264f),await initPresenceSubscriptions(_0x2f264f),await setupTelegramListener(_0x2f264f),setTimeout(()=>checkWifiPresence(_0x2f264f),0x1388);if(_0x2f264f[_0x2193b0(0x15b)])clearInterval(_0x2f264f[_0x2193b0(0x15b)]);const _0x1cc34d=_0x2f264f[_0x2193b0(0x285)][_0x2193b0(0x141)]||0xf;_0x1cc34d>0x0&&(_0x2f264f[_0x2193b0(0x15b)]=setInterval(()=>{runAutopilot(_0x2f264f);},_0x1cc34d*0x3c*0x3e8)),setupLtmScheduler(_0x2f264f),setupModeResetScheduler(_0x2f264f),setupDriftAnalysisScheduler(_0x2f264f),setupBriefingScheduler(_0x2f264f),startPythonService(_0x2f264f),setTimeout(()=>{const _0x377b38=_0x2193b0;_0x2f264f[_0x377b38(0x144)]&&(runPythonHealthCheck(_0x2f264f),triggerGaitAnalysis(_0x2f264f),triggerEnergyPrediction(_0x2f264f)),updateHealthVector(_0x2f264f);},0x1388);}async function runAutopilot(_0x39af19){const _0x5273bb=a0_0x572d97;_0x39af19['log'][_0x5273bb(0x194)](_0x5273bb(0x283)),await runGeminiAnalysis(_0x39af19),updateHealthVector(_0x39af19),triggerGaitAnalysis(_0x39af19),triggerEnergyPrediction(_0x39af19);}async function triggerGaitAnalysis(_0x6bee8){const _0x19d374=a0_0x572d97;if(!_0x6bee8[_0x19d374(0x246)])return;try{const _0x303455=await _0x6bee8[_0x19d374(0x2cf)]('LTM.trainingData.sequences');_0x303455&&_0x303455[_0x19d374(0x25d)]&&sendToPython(_0x6bee8,'ANALYZE_GAIT',{'sequences':JSON[_0x19d374(0x2a6)](_0x303455[_0x19d374(0x25d)])});}catch(_0x712606){}}async function triggerEnergyPrediction(_0x217e84){const _0x4f6e0f=a0_0x572d97;if(!_0x217e84['isProVersion'])return;try{const _0x49ef17=await getOutsideTemperatureNumeric(_0x217e84);if(_0x49ef17===null)return;const _0x444e34={},_0x577882=_0x217e84[_0x4f6e0f(0x285)][_0x4f6e0f(0x2bf)]||[];for(const _0x247fb9 of _0x577882){if(_0x247fb9[_0x4f6e0f(0x256)]==='temperature'&&_0x247fb9['location']){const _0x4159eb=_0x217e84[_0x4f6e0f(0x17d)][_0x247fb9['id']];if(_0x4159eb!==undefined)_0x444e34[_0x247fb9[_0x4f6e0f(0x179)]]=_0x4159eb;}}Object['keys'](_0x444e34)[_0x4f6e0f(0x260)]>0x0&&sendToPython(_0x217e84,_0x4f6e0f(0x2b1),{'current_temps':_0x444e34,'t_out':_0x49ef17});}catch(_0xb5f2e6){}}function updateHealthVector(_0x35a12c){const _0x5567cd=a0_0x572d97;if(!_0x35a12c['rawEventLog']||_0x35a12c[_0x5567cd(0x15a)]['length']===0x0)return;const _0x37a236=new Array(0x60)[_0x5567cd(0x2a7)](0x0),_0x59300b=new Date()[_0x5567cd(0x274)](0x0,0x0,0x0,0x0);_0x35a12c[_0x5567cd(0x15a)][_0x5567cd(0x1e7)](_0x4f3c5a=>{const _0x4b450d=_0x5567cd,_0x5ee370=new Date(_0x4f3c5a['timestamp']);if(_0x5ee370[_0x4b450d(0x1a2)]()>=_0x59300b){const _0xb60c73=_0x5ee370['getHours'](),_0xa85cb5=_0x5ee370[_0x4b450d(0x299)](),_0x5bfea0=_0xb60c73*0x4+Math[_0x4b450d(0x2cd)](_0xa85cb5/0xf);if(_0x5bfea0>=0x0&&_0x5bfea0<0x60)_0x37a236[_0x5bfea0]++;}}),_0x35a12c[_0x5567cd(0x2db)]('analysis.health.todayVector',{'val':JSON[_0x5567cd(0x2d8)](_0x37a236),'ack':!![]});}async function scanForDevices(_0x31d99f,_0x4a763f){const _0x24d3c6=a0_0x572d97;_0x31d99f['log'][_0x24d3c6(0x177)](_0x24d3c6(0x273));const _0x54fb07=[],_0x494f9f=await _0x31d99f['getForeignObjectsAsync']('*');for(const _0x3f5e45 in _0x494f9f){const _0x4c331a=_0x494f9f[_0x3f5e45];if(_0x4c331a&&_0x4c331a[_0x24d3c6(0x21a)]&&_0x4c331a[_0x24d3c6(0x256)]===_0x24d3c6(0x1ba)){const _0x541566=(_0x4c331a['common']['name']&&typeof _0x4c331a[_0x24d3c6(0x21a)]['name']===_0x24d3c6(0x1fd)?_0x4c331a[_0x24d3c6(0x21a)][_0x24d3c6(0x2b0)]['de']:_0x4c331a[_0x24d3c6(0x21a)]['name'])||'',_0x2292b9=_0x4c331a['common']['role']||'';let _0x5bf1eb=null;if(_0x4a763f[_0x24d3c6(0x171)]&&(_0x2292b9[_0x24d3c6(0x1fb)]('motion')||_0x541566[_0x24d3c6(0x1b2)]()[_0x24d3c6(0x1fb)](_0x24d3c6(0x204))))_0x5bf1eb=_0x24d3c6(0x171);else{if(_0x4a763f[_0x24d3c6(0x16e)]&&(_0x2292b9[_0x24d3c6(0x1fb)](_0x24d3c6(0x29b))||_0x2292b9[_0x24d3c6(0x1fb)]('window')||_0x541566[_0x24d3c6(0x1b2)]()[_0x24d3c6(0x1fb)](_0x24d3c6(0x297))||_0x541566[_0x24d3c6(0x1b2)]()[_0x24d3c6(0x1fb)](_0x24d3c6(0x1a4))))_0x5bf1eb=_0x24d3c6(0x29b);else{if(_0x4a763f[_0x24d3c6(0x28b)]&&(_0x2292b9[_0x24d3c6(0x1fb)](_0x24d3c6(0x25f))||_0x2292b9[_0x24d3c6(0x1fb)]('switch')||_0x541566[_0x24d3c6(0x1b2)]()[_0x24d3c6(0x1fb)](_0x24d3c6(0x21c))))_0x5bf1eb='light';else{if(_0x4a763f['temperature']&&(_0x2292b9['includes'](_0x24d3c6(0x186))||_0x541566[_0x24d3c6(0x1b2)]()[_0x24d3c6(0x1fb)](_0x24d3c6(0x1e6))))_0x5bf1eb=_0x24d3c6(0x186);}}}if(_0x5bf1eb){let _0x90d1b3='';const _0x187aa0=_0x3f5e45['split']('.');if(_0x187aa0['length']>0x2)_0x90d1b3=_0x187aa0[0x2];_0x54fb07[_0x24d3c6(0x223)]({'id':_0x3f5e45,'name':_0x541566||_0x3f5e45,'type':_0x5bf1eb,'location':_0x90d1b3,'_score':0x32});}}}return _0x54fb07;}async function getWeatherContext(_0x38bf2e){const _0x457fff=a0_0x572d97;if(!_0x38bf2e[_0x457fff(0x285)][_0x457fff(0x278)]||!_0x38bf2e[_0x457fff(0x285)][_0x457fff(0x2d7)])return _0x457fff(0x1f3);try{const _0x1fc978=_0x38bf2e[_0x457fff(0x285)][_0x457fff(0x2d7)];let _0xdf5e0e=await _0x38bf2e[_0x457fff(0x263)](_0x1fc978+_0x457fff(0x1a0));if(!_0xdf5e0e)_0xdf5e0e=await _0x38bf2e[_0x457fff(0x263)](_0x1fc978+_0x457fff(0x166));let _0x4bd488=await _0x38bf2e[_0x457fff(0x263)](_0x1fc978+_0x457fff(0x183));if(!_0x4bd488)_0x4bd488=await _0x38bf2e[_0x457fff(0x263)](_0x1fc978+_0x457fff(0x1bd));if(_0xdf5e0e&&_0x4bd488)return _0xdf5e0e[_0x457fff(0x25d)]+_0x457fff(0x2a1)+_0x4bd488[_0x457fff(0x25d)];}catch(_0x4cd534){}return _0x457fff(0x249);}async function getCalendarContext(_0x12091b){const _0x20c850=a0_0x572d97;if(!_0x12091b[_0x20c850(0x285)]['useCalendar']||!_0x12091b[_0x20c850(0x285)][_0x20c850(0x1e3)])return _0x20c850(0x190);return'Keine\x20Termine.';}async function getCalendarNames(_0x58b1e5,_0x2b47eb){return[];}async function saveFeedback(_0x2e431f,_0x15db9c){const _0x454564=a0_0x572d97;_0x2e431f['log'][_0x454564(0x177)]('ðŸ“\x20Feedback\x20received:\x20'+_0x15db9c[_0x454564(0x19c)]);}async function sendMorningBriefing(_0x3b2d93){const _0x9a23dd=a0_0x572d97;if(!_0x3b2d93['geminiModel'])return;try{const _0x1bd2d6='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x34c2b4=await _0x3b2d93[_0x9a23dd(0x1c1)]['generateContent'](_0x1bd2d6),_0x572986=_0x34c2b4[_0x9a23dd(0x1f8)]['text']();sendNotification(_0x3b2d93,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0x572986);}catch(_0x5ad86f){_0x3b2d93['log'][_0x9a23dd(0x1d3)](_0x9a23dd(0x2b5)+_0x5ad86f[_0x9a23dd(0x276)]);}}function checkAndInstall(_0xf864ea){const _0x277878=a0_0x572d97;if(!fs[_0x277878(0x27e)](VENV_PATH)||!fs['existsSync'](PIP_EXE))return _0xf864ea[_0x277878(0x2bc)][_0x277878(0x1c7)](_0x277878(0x189)),installPythonDependencies(_0xf864ea),![];return!![];}function installPythonDependencies(_0x1c506d){const _0x5aa5fe=a0_0x572d97;if(_0x1c506d['dependencyInstallInProgress'])return;_0x1c506d[_0x5aa5fe(0x19a)]=!![];const _0x4f8737=path[_0x5aa5fe(0x254)](__dirname,_0x5aa5fe(0x1f9),_0x5aa5fe(0x1ae));stopPythonService(_0x1c506d);if(fs['existsSync'](VENV_PATH))try{fs[_0x5aa5fe(0x1b7)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x3a9d33){}exec('python3\x20-m\x20venv\x20\x22'+VENV_PATH+'\x22',_0x4f474f=>{const _0x48c0ab=_0x5aa5fe;if(_0x4f474f){_0x1c506d[_0x48c0ab(0x2bc)]['error'](_0x48c0ab(0x29c)+_0x4f474f[_0x48c0ab(0x276)]),_0x1c506d['dependencyInstallInProgress']=![];return;}installRequirementsInVenv(_0x1c506d,_0x4f8737);});}function installRequirementsInVenv(_0x4d08b0,_0x1fe283){const _0x23e07f=a0_0x572d97;_0x4d08b0[_0x23e07f(0x2bc)][_0x23e07f(0x177)](_0x23e07f(0x219));const _0x3d819b='\x22'+PIP_EXE+'\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22'+_0x1fe283+'\x22';exec(_0x3d819b,{'timeout':0x124f80},(_0x3e32e6,_0x30ffef,_0x4edb39)=>{const _0x47d077=_0x23e07f;_0x4d08b0[_0x47d077(0x19a)]=![],_0x3e32e6?_0x4d08b0['log'][_0x47d077(0x1d3)]('âŒ\x20INSTALL\x20FAILED:\x20'+(_0x4edb39||_0x3e32e6['message'])):(_0x4d08b0['log'][_0x47d077(0x177)](_0x47d077(0x22e)),startSystem(_0x4d08b0));});}async function initZombies(_0x42dc7c){const _0xda792d=a0_0x572d97;try{const _0x22ee98=[_0xda792d(0x26f),'events.history_debug_00'];for(const _0xf1f25b of _0x22ee98){try{const _0x5b75c7=await _0x42dc7c[_0xda792d(0x2a8)](_0xf1f25b);if(_0x5b75c7)await _0x42dc7c[_0xda792d(0x1eb)](_0xf1f25b);}catch(_0x4a6457){}}}catch(_0x5822b8){}}async function checkLicense(_0x4fe6e9){return!![];}async function initHistory(_0x159852){const _0x15b054=a0_0x572d97;try{const _0x284eff=await _0x159852[_0x15b054(0x2cf)](_0x15b054(0x1da));_0x284eff&&_0x284eff[_0x15b054(0x25d)]&&(_0x159852[_0x15b054(0x17a)]=JSON[_0x15b054(0x2a6)](_0x284eff[_0x15b054(0x25d)][_0x15b054(0x173)]()));}catch(_0x57ce27){_0x159852['eventHistory']=[];}try{const _0x5c19f0=await _0x159852['getStateAsync'](_0x15b054(0x23a));if(_0x5c19f0&&_0x5c19f0[_0x15b054(0x25d)])_0x159852['analysisHistory']=JSON[_0x15b054(0x2a6)](_0x5c19f0[_0x15b054(0x25d)][_0x15b054(0x173)]());}catch(_0x27f7e4){_0x159852[_0x15b054(0x1b3)]=[];}if(_0x159852[_0x15b054(0x17a)]&&_0x159852['eventHistory'][_0x15b054(0x260)]>0x0){_0x159852[_0x15b054(0x2bc)][_0x15b054(0x177)](_0x15b054(0x2be));for(let _0x2aa21b=_0x159852['eventHistory']['length']-0x1;_0x2aa21b>=0x0;_0x2aa21b--){const _0x28a7de=_0x159852[_0x15b054(0x17a)][_0x2aa21b];if(_0x28a7de&&_0x28a7de['id']!==undefined&&_0x28a7de[_0x15b054(0x2e0)]!==undefined)_0x159852['sensorLastValues'][_0x28a7de['id']]=_0x28a7de[_0x15b054(0x2e0)];}}}async function initSystemConfig(_0x56b41c){const _0x54d388=a0_0x572d97;try{const _0x87f922=await _0x56b41c[_0x54d388(0x143)](_0x54d388(0x264));if(_0x87f922&&_0x87f922[_0x54d388(0x21a)])_0x56b41c[_0x54d388(0x2d3)]={'latitude':_0x87f922[_0x54d388(0x21a)]['latitude']||0x0,'longitude':_0x87f922[_0x54d388(0x21a)][_0x54d388(0x267)]||0x0,'city':_0x87f922[_0x54d388(0x21a)][_0x54d388(0x255)]||''};}catch(_0x29d73a){}}async function createAllObjects(_0x47cce7){const _0x2c08db=a0_0x572d97;await _0x47cce7[_0x2c08db(0x28f)]('system',{'type':_0x2c08db(0x1ce),'common':{'name':_0x2c08db(0x15c)},'native':{}}),await _0x47cce7[_0x2c08db(0x28f)](SYSTEM_DP_MODE,{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x1c5),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x1ba),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL']},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x14e),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x26e),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x16b),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x17b),{'type':_0x2c08db(0x1ba),'common':{'name':'Last\x20raw\x20event','type':_0x2c08db(0x1e8),'role':_0x2c08db(0x282),'read':!![],'write':![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x1da),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x2a3),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x282),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x28f)](_0x2c08db(0x23f),{'type':_0x2c08db(0x1ce),'common':{'name':_0x2c08db(0x1ff)},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x1ee),{'type':'state','common':{'name':'Train\x20Security','type':_0x2c08db(0x1b9),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x218),{'type':'state','common':{'name':_0x2c08db(0x1c2),'type':_0x2c08db(0x1b9),'role':_0x2c08db(0x202),'read':!![],'write':!![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x27f),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x287),'type':_0x2c08db(0x1b9),'role':_0x2c08db(0x202),'read':!![],'write':!![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x26b),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x262),'type':_0x2c08db(0x1b9),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x2c0),{'type':'state','common':{'name':_0x2c08db(0x252),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x16b),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x28f)](_0x2c08db(0x2c2),{'type':_0x2c08db(0x1ce),'common':{'name':_0x2c08db(0x269)},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.security.lastScore',{'type':'state','common':{'name':_0x2c08db(0x1f4),'type':_0x2c08db(0x151),'role':_0x2c08db(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x1f6),{'type':'state','common':{'name':_0x2c08db(0x153),'type':_0x2c08db(0x151),'role':_0x2c08db(0x2e0),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.security.lastCheck',{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x1cf),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x216),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x28f)](_0x2c08db(0x2d6),{'type':_0x2c08db(0x1ce),'common':{'name':_0x2c08db(0x2b4)},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x237),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x1cf),'type':_0x2c08db(0x1e8),'role':'date','read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.health.isAnomaly',{'type':_0x2c08db(0x1ba),'common':{'name':'Anomaly\x20Detected','type':_0x2c08db(0x1b9),'role':_0x2c08db(0x29f),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x1d0),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x1b4),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x16b),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.health.trendValue',{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x1a1),'type':_0x2c08db(0x151),'role':_0x2c08db(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.health.todayVector',{'type':'state','common':{'name':_0x2c08db(0x293),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x282),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x184),{'type':'state','common':{'name':_0x2c08db(0x296),'type':'number','role':_0x2c08db(0x2e0),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x28f)](_0x2c08db(0x230),{'type':'channel','common':{'name':_0x2c08db(0x2c8)},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x244),{'type':'state','common':{'name':_0x2c08db(0x248),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x156),{'type':'state','common':{'name':_0x2c08db(0x2c6),'type':'string','role':_0x2c08db(0x16b),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.energy.forecast',{'type':_0x2c08db(0x1ba),'common':{'name':'Temperature\x20Forecast','type':_0x2c08db(0x1e8),'role':_0x2c08db(0x282),'read':!![],'write':![]},'native':{}}),await _0x47cce7['extendObjectAsync'](_0x2c08db(0x284),{'type':_0x2c08db(0x1ce),'common':{'name':_0x2c08db(0x284)},'native':{}}),await _0x47cce7['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x2c08db(0x271),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x282),'read':!![],'write':![]},'native':{}}),await _0x47cce7['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x2c08db(0x268),'type':_0x2c08db(0x1e8),'role':'json','read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x172),{'type':'state','common':{'name':_0x2c08db(0x23c),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x282),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x1ca),{'type':'state','common':{'name':_0x2c08db(0x14d),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x282),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x1f7),{'type':_0x2c08db(0x1ba),'common':{'name':'Trigger\x20Analysis','type':_0x2c08db(0x1b9),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x157),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x1d2),'type':_0x2c08db(0x1b9),'role':_0x2c08db(0x202),'read':!![],'write':!![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x277),{'type':'state','common':{'name':_0x2c08db(0x1cd),'type':'boolean','role':_0x2c08db(0x1ed),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.alertReason',{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x224),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x242),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.activitySummary',{'type':_0x2c08db(0x1ba),'common':{'name':'Activity\x20Summary','type':_0x2c08db(0x1e8),'role':_0x2c08db(0x16b),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.automation.patternDetected',{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x1d4),'type':_0x2c08db(0x1b9),'role':_0x2c08db(0x29f),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)]('analysis.automation.description',{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x2b8),'type':_0x2c08db(0x1e8),'role':'text','read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x1ac),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x2b3),'type':_0x2c08db(0x1e8),'role':_0x2c08db(0x282),'read':!![],'write':![]},'native':{}}),await _0x47cce7['setObjectNotExistsAsync'](_0x2c08db(0x25a),{'type':'state','common':{'name':'Target\x20ID','type':_0x2c08db(0x1e8),'role':_0x2c08db(0x16b),'read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x214),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x24f),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x20c),{'type':_0x2c08db(0x1ba),'common':{'name':'Auto\x20Apply','type':_0x2c08db(0x1b9),'role':_0x2c08db(0x2e2),'read':!![],'write':!![]},'native':{}}),await _0x47cce7[_0x2c08db(0x235)](_0x2c08db(0x1c0),{'type':_0x2c08db(0x1ba),'common':{'name':_0x2c08db(0x182),'type':_0x2c08db(0x1b9),'role':_0x2c08db(0x202),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x1ebe4f){const _0x1a1261=a0_0x572d97;try{const _0x48b7a4=await _0x1ebe4f['getStateAsync'](SYSTEM_DP_MODE);_0x48b7a4&&_0x48b7a4[_0x1a1261(0x25d)]&&Object['values'](SYSTEM_MODES)[_0x1a1261(0x1fb)](_0x48b7a4[_0x1a1261(0x25d)])?_0x1ebe4f['currentSystemMode']=_0x48b7a4['val']:(_0x1ebe4f[_0x1a1261(0x208)]=SYSTEM_MODES[_0x1a1261(0x27c)],await _0x1ebe4f[_0x1a1261(0x2db)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x580295){_0x1ebe4f[_0x1a1261(0x208)]=SYSTEM_MODES[_0x1a1261(0x27c)];}}async function loadRawEventLog(_0x3f01c9){const _0x8dabc4=a0_0x572d97;try{const _0x4cf33c=await _0x3f01c9[_0x8dabc4(0x2cf)](LTM_DP_RAW_LOG);if(_0x4cf33c&&_0x4cf33c[_0x8dabc4(0x25d)])_0x3f01c9[_0x8dabc4(0x15a)]=JSON[_0x8dabc4(0x2a6)](_0x4cf33c[_0x8dabc4(0x25d)]);}catch(_0x16c521){_0x3f01c9[_0x8dabc4(0x15a)]=[];}}async function saveRawEventLog(_0x42e62d){const _0x4fd3a0=a0_0x572d97;if(_0x42e62d['rawEventLog']['length']>RAW_LOG_MAX_SIZE)_0x42e62d['rawEventLog'][_0x4fd3a0(0x23d)](0x0,_0x42e62d[_0x4fd3a0(0x15a)][_0x4fd3a0(0x260)]-RAW_LOG_MAX_SIZE);await _0x42e62d['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x4fd3a0(0x2d8)](_0x42e62d[_0x4fd3a0(0x15a)]),'ack':!![]});}async function loadDailyDigests(_0xcbebf1){const _0x527818=a0_0x572d97;try{const _0x56b002=await _0xcbebf1[_0x527818(0x2cf)](LTM_DP_DAILY_DIGESTS);if(_0x56b002&&_0x56b002[_0x527818(0x25d)])_0xcbebf1[_0x527818(0x2e3)]=JSON[_0x527818(0x2a6)](_0x56b002[_0x527818(0x25d)]);}catch(_0x3c33b5){_0xcbebf1['dailyDigests']=[];}await updateBaselineStatus(_0xcbebf1);}async function saveDailyDigests(_0x1be82b,_0x1607cf=!![]){const _0x39de32=a0_0x572d97,_0x403dc3=_0x1be82b['config'][_0x39de32(0x142)]||0x3c;_0x1be82b['dailyDigests'][_0x39de32(0x260)]>_0x403dc3&&_0x1be82b[_0x39de32(0x2e3)][_0x39de32(0x23d)](0x0,_0x1be82b[_0x39de32(0x2e3)]['length']-_0x403dc3);await _0x1be82b['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x39de32(0x2d8)](_0x1be82b[_0x39de32(0x2e3)]),'ack':!![]});if(_0x1607cf)await updateBaselineStatus(_0x1be82b);}async function updateAnalysisHistory(_0x5c0226,_0x155a90){const _0x4ee81a=a0_0x572d97;_0x5c0226[_0x4ee81a(0x1b3)][_0x4ee81a(0x2ca)](_0x155a90);if(_0x5c0226[_0x4ee81a(0x1b3)]['length']>HISTORY_MAX_SIZE)_0x5c0226[_0x4ee81a(0x1b3)][_0x4ee81a(0x247)]();await _0x5c0226[_0x4ee81a(0x2db)](_0x4ee81a(0x23a),{'val':JSON[_0x4ee81a(0x2d8)](_0x5c0226[_0x4ee81a(0x1b3)]),'ack':!![]});}async function updateBaselineStatus(_0x3be431){const _0x4fe8f6=a0_0x572d97;if(!_0x3be431['isProVersion']){await _0x3be431[_0x4fe8f6(0x2db)](LTM_DP_BASELINE_STATUS,{'val':_0x4fe8f6(0x21f),'ack':!![]});return;}const _0x5eac08=_0x3be431[_0x4fe8f6(0x2e3)][_0x4fe8f6(0x260)]>=(_0x3be431[_0x4fe8f6(0x285)][_0x4fe8f6(0x169)]||0x7)?'Aktiv\x20('+_0x3be431[_0x4fe8f6(0x2e3)]['length']+_0x4fe8f6(0x1d6):'Lernphase\x20('+_0x3be431[_0x4fe8f6(0x2e3)][_0x4fe8f6(0x260)]+'/'+(_0x3be431[_0x4fe8f6(0x285)][_0x4fe8f6(0x169)]||0x7)+')';await _0x3be431[_0x4fe8f6(0x2db)](LTM_DP_BASELINE_STATUS,{'val':_0x5eac08,'ack':!![]});}async function initSensorSubscriptions(_0x25fc2b){const _0x5d4ffe=a0_0x572d97,_0x4270fd=_0x25fc2b['config'][_0x5d4ffe(0x2bf)];if(_0x4270fd)for(const _0x29217f of _0x4270fd){await _0x25fc2b[_0x5d4ffe(0x16f)](_0x29217f['id']);}}async function initPresenceSubscriptions(_0x2f23b1){const _0x46bf70=a0_0x572d97,_0x4122b7=_0x2f23b1[_0x46bf70(0x285)][_0x46bf70(0x22b)];if(_0x4122b7)for(const _0xb94b0 of _0x4122b7){await _0x2f23b1['subscribeForeignStatesAsync'](_0xb94b0);}}async function setupTelegramListener(_0x3a8e5c){const _0x2cb826=a0_0x572d97,_0x3e7f94=_0x3a8e5c[_0x2cb826(0x285)][_0x2cb826(0x160)];if(_0x3a8e5c[_0x2cb826(0x285)][_0x2cb826(0x1e2)]&&_0x3e7f94)await _0x3a8e5c[_0x2cb826(0x16f)](_0x3e7f94+_0x2cb826(0x188));}async function checkWifiPresence(_0x5c80cf){const _0x12caf4=a0_0x572d97;try{const _0x19f3ec=_0x5c80cf['config'][_0x12caf4(0x22b)]||[];let _0x4ce3ff=![];const _0x4633f2=[];for(const _0x400976 of _0x19f3ec){try{const _0x3e4484=await _0x5c80cf['getForeignStateAsync'](_0x400976);_0x3e4484&&(_0x3e4484[_0x12caf4(0x25d)]===!![]||_0x3e4484[_0x12caf4(0x25d)]===_0x12caf4(0x29a)||_0x3e4484[_0x12caf4(0x25d)]===0x1)&&(_0x4ce3ff=!![],_0x4633f2['push'](_0x400976));}catch(_0x557900){}}return await _0x5c80cf[_0x12caf4(0x2db)](_0x12caf4(0x14e),{'val':_0x4633f2['join'](',\x20'),'ack':!![]}),_0x4ce3ff&&(_0x5c80cf[_0x12caf4(0x280)]&&(_0x5c80cf[_0x12caf4(0x2bc)][_0x12caf4(0x177)](_0x12caf4(0x2e9)),abortExitTimer(_0x5c80cf)),!_0x5c80cf[_0x12caf4(0x203)]&&_0x5c80cf[_0x12caf4(0x208)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x5c80cf,!![])),_0x4ce3ff;}catch(_0x549aa0){return![];}}function startExitTimer(_0x4296be){const _0x137d3c=a0_0x572d97;abortExitTimer(_0x4296be),_0x4296be[_0x137d3c(0x222)]=!![],_0x4296be[_0x137d3c(0x21d)]=setTimeout(()=>{const _0x593894=_0x137d3c;_0x4296be[_0x593894(0x222)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4296be[_0x137d3c(0x280)]=setTimeout(()=>{const _0x27e994=_0x137d3c;setPresence(_0x4296be,![]),_0x4296be[_0x27e994(0x280)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0xc72254){const _0x112dce=a0_0x572d97;if(_0xc72254[_0x112dce(0x280)])clearTimeout(_0xc72254[_0x112dce(0x280)]);if(_0xc72254['exitGraceTimer'])clearTimeout(_0xc72254[_0x112dce(0x21d)]);_0xc72254[_0x112dce(0x280)]=null,_0xc72254[_0x112dce(0x21d)]=null,_0xc72254['isGracePeriodActive']=![];}async function setPresence(_0x4ac38b,_0x484784){const _0x442ffd=a0_0x572d97;if(_0x4ac38b[_0x442ffd(0x203)]===_0x484784)return;_0x4ac38b[_0x442ffd(0x203)]=_0x484784,await _0x4ac38b[_0x442ffd(0x2db)](_0x442ffd(0x181),{'val':_0x484784,'ack':!![]});}async function executeAutomationAction(_0x4e2b50){const _0x305818=a0_0x572d97;try{const _0x67a1a9=await _0x4e2b50['getStateAsync']('analysis.automation.targetId'),_0x2680b5=await _0x4e2b50[_0x305818(0x2cf)]('analysis.automation.targetValue');if(_0x67a1a9&&_0x67a1a9['val']&&_0x2680b5){const _0x4cf465=_0x67a1a9['val'];let _0x4fe5e5=_0x2680b5[_0x305818(0x25d)];try{_0x4fe5e5=JSON[_0x305818(0x2a6)](_0x4fe5e5);}catch(_0x4f1fe8){}_0x4e2b50[_0x305818(0x2bc)][_0x305818(0x177)](_0x305818(0x18b)+_0x4cf465+_0x305818(0x1b0)+_0x4fe5e5),await _0x4e2b50[_0x305818(0x253)](_0x4cf465,_0x4fe5e5);}else _0x4e2b50['log'][_0x305818(0x1c7)](_0x305818(0x22c));}catch(_0x20770d){_0x4e2b50['log'][_0x305818(0x1d3)](_0x305818(0x13a)+_0x20770d[_0x305818(0x276)]);}}async function processSensorEvent(_0x39625c,_0x40bd4b,_0x5c4864,_0xfeaa96){const _0x5914a4=a0_0x572d97;if(!_0xfeaa96)return;const _0x282b90=_0x5c4864[_0x5914a4(0x25d)],_0x2762e4=Date[_0x5914a4(0x233)](),_0x36ad7b=_0x39625c[_0x5914a4(0x17d)][_0x40bd4b];_0x39625c[_0x5914a4(0x17d)][_0x40bd4b]=_0x282b90;if(!_0xfeaa96[_0x5914a4(0x13c)]&&_0x36ad7b!=undefined&&_0x36ad7b==_0x282b90)return;const _0xee2895=(_0xfeaa96['type']||'')['toLowerCase'](),_0x59d502=_0xee2895['includes'](_0x5914a4(0x186))||_0xee2895[_0x5914a4(0x1fb)](_0x5914a4(0x1e6))||_0xee2895[_0x5914a4(0x1fb)]('klima')||_0xee2895[_0x5914a4(0x1fb)](_0x5914a4(0x227));_0x39625c[_0x5914a4(0x246)]&&_0x59d502&&recordThermodynamics(_0x39625c,_0x40bd4b,_0x282b90,_0xfeaa96['location']);const _0x3862b0={'timestamp':_0x2762e4,'id':_0x40bd4b,'name':_0xfeaa96[_0x5914a4(0x2b0)],'type':_0xfeaa96['type'],'location':_0xfeaa96[_0x5914a4(0x179)],'value':_0x282b90};_0x39625c['eventHistory'][_0x5914a4(0x2ca)](_0x3862b0);if(_0x39625c[_0x5914a4(0x17a)]['length']>HISTORY_MAX_SIZE)_0x39625c['eventHistory'][_0x5914a4(0x247)]();await _0x39625c[_0x5914a4(0x2db)](_0x5914a4(0x17b),{'val':JSON[_0x5914a4(0x2d8)](_0x3862b0),'ack':!![]}),await _0x39625c['setStateAsync'](_0x5914a4(0x1da),{'val':JSON[_0x5914a4(0x2d8)](_0x39625c[_0x5914a4(0x17a)]),'ack':!![]});_0x39625c[_0x5914a4(0x246)]&&(_0x39625c[_0x5914a4(0x15a)][_0x5914a4(0x223)](_0x3862b0),await saveRawEventLog(_0x39625c),recordSequence(_0x39625c,_0x3862b0));if(_0xfeaa96[_0x5914a4(0x275)]&&_0x282b90===!![]){if(_0x39625c['isPresent']&&!_0x39625c[_0x5914a4(0x222)])startExitTimer(_0x39625c);else{if(!_0x39625c[_0x5914a4(0x203)])setPresence(_0x39625c,!![]);}}else{if(_0xfeaa96[_0x5914a4(0x256)]===_0x5914a4(0x171)&&_0x282b90===!![]){if(_0x39625c[_0x5914a4(0x280)])abortExitTimer(_0x39625c);if(!_0x39625c[_0x5914a4(0x203)]&&_0x39625c['currentSystemMode']===SYSTEM_MODES['NORMAL'])setPresence(_0x39625c,!![]);}}}async function recordThermodynamics(_0x12c55a,_0xa41da8,_0x2704ae,_0x515d97){const _0x4d8bdd=a0_0x572d97,_0x2fa36c=await getOutsideTemperatureNumeric(_0x12c55a),_0x224f14=await _0x12c55a[_0x4d8bdd(0x2cf)](_0x4d8bdd(0x1ca));let _0x1bbf8c=[];if(_0x224f14&&_0x224f14[_0x4d8bdd(0x25d)])try{_0x1bbf8c=JSON[_0x4d8bdd(0x2a6)](_0x224f14[_0x4d8bdd(0x25d)]);}catch(_0x159bc6){}_0x1bbf8c['push']({'ts':Date['now'](),'room':_0x515d97||'Unknown','t_in':_0x2704ae,'t_out':_0x2fa36c});if(_0x1bbf8c[_0x4d8bdd(0x260)]>THERMO_LOG_SIZE)_0x1bbf8c[_0x4d8bdd(0x1d8)]();await _0x12c55a[_0x4d8bdd(0x2db)](_0x4d8bdd(0x1ca),{'val':JSON[_0x4d8bdd(0x2d8)](_0x1bbf8c),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x1c2024){const _0x5a44b6=a0_0x572d97;if(_0x1c2024['config'][_0x5a44b6(0x2ce)])try{const _0x894f3f=await _0x1c2024[_0x5a44b6(0x263)](_0x1c2024[_0x5a44b6(0x285)][_0x5a44b6(0x2ce)]);if(_0x894f3f&&_0x894f3f[_0x5a44b6(0x25d)]!==undefined&&_0x894f3f[_0x5a44b6(0x25d)]!==null)return parseFloat(_0x894f3f[_0x5a44b6(0x25d)]);}catch(_0x2f0af6){}const _0x23505e=_0x1c2024['config'][_0x5a44b6(0x2d7)];if(!_0x1c2024[_0x5a44b6(0x285)][_0x5a44b6(0x278)]||!_0x23505e)return null;try{let _0x409216='';if(_0x23505e[_0x5a44b6(0x1fb)](_0x5a44b6(0x2c4)))_0x409216=_0x23505e+_0x5a44b6(0x1a0);else{if(_0x23505e[_0x5a44b6(0x1fb)](_0x5a44b6(0x2df)))_0x409216=_0x23505e+_0x5a44b6(0x28e);else{if(_0x23505e['includes']('openweathermap'))_0x409216=_0x23505e+'.forecast.current.temperature';else{if(_0x23505e[_0x5a44b6(0x1fb)]('weatherunderground'))_0x409216=_0x23505e+_0x5a44b6(0x2b2);}}}if(_0x409216){const _0x35df1f=await _0x1c2024[_0x5a44b6(0x263)](_0x409216);if(_0x35df1f&&_0x35df1f[_0x5a44b6(0x25d)]!==undefined&&_0x35df1f[_0x5a44b6(0x25d)]!==null)return parseFloat(_0x35df1f[_0x5a44b6(0x25d)]);}}catch(_0x29b7d8){}return null;}async function recordSequence(_0x2aff79,_0x45baae){const _0x50b3af=a0_0x572d97,_0x464bfe=(_0x45baae[_0x50b3af(0x256)]||'')[_0x50b3af(0x1b2)](),_0x13f1cb=[_0x50b3af(0x171),_0x50b3af(0x204),_0x50b3af(0x1df),_0x50b3af(0x292),_0x50b3af(0x281),_0x50b3af(0x29b),_0x50b3af(0x297),'window',_0x50b3af(0x1a4),_0x50b3af(0x164),_0x50b3af(0x167),_0x50b3af(0x25f),_0x50b3af(0x21c),_0x50b3af(0x2e2),_0x50b3af(0x20b),_0x50b3af(0x2d0),_0x50b3af(0x18c)];if(!_0x13f1cb['some'](_0x456515=>_0x464bfe[_0x50b3af(0x1fb)](_0x456515)))return;if(!_0x45baae[_0x50b3af(0x2e0)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x50b3af(0x223)]({'loc':_0x45baae[_0x50b3af(0x179)]||_0x50b3af(0x23b),'id':_0x45baae['id'],'ts':Date[_0x50b3af(0x233)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x2aff79);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x3a8209){const _0x30ddc9=a0_0x572d97;try{const _0x1429d3=await _0x3a8209['getStateAsync'](_0x30ddc9(0x172));let _0xa61ce9=[];if(_0x1429d3&&_0x1429d3[_0x30ddc9(0x25d)])try{_0xa61ce9=JSON['parse'](_0x1429d3[_0x30ddc9(0x25d)]);}catch(_0x56f617){}const _0x157432=activeSequence[0x0]['ts'],_0x580229=activeSequence['map'](_0x5f0a93=>({'loc':_0x5f0a93[_0x30ddc9(0x298)],'t_delta':Math['round']((_0x5f0a93['ts']-_0x157432)/0x3e8)})),_0x3a0d13={'timestamp':new Date(_0x157432)[_0x30ddc9(0x2ea)](),'steps':_0x580229,'duration':Math['round']((activeSequence[activeSequence[_0x30ddc9(0x260)]-0x1]['ts']-_0x157432)/0x3e8),'daytime':new Date(_0x157432)[_0x30ddc9(0x1db)]()};_0xa61ce9['push'](_0x3a0d13);if(_0xa61ce9[_0x30ddc9(0x260)]>MAX_TRAINING_SET_SIZE)_0xa61ce9[_0x30ddc9(0x1d8)]();await _0x3a8209[_0x30ddc9(0x2db)](_0x30ddc9(0x172),{'val':JSON[_0x30ddc9(0x2d8)](_0xa61ce9),'ack':!![]}),runSecurityCheck(_0x3a8209,_0x3a0d13);}catch(_0x137186){_0x3a8209[_0x30ddc9(0x2bc)][_0x30ddc9(0x1d3)](_0x30ddc9(0x245)+_0x137186['message']);}}function runSecurityCheck(_0x50e14a,_0xf15765){const _0x2a151d=a0_0x572d97;if(!_0x50e14a[_0x2a151d(0x246)])return;sendToPython(_0x50e14a,'ANALYZE_SEQUENCE',{'sequence':_0xf15765});}function sendToPython(_0x238cb5,_0x5645cb,_0x5a0cae={}){const _0x570963=a0_0x572d97;if(!_0x238cb5['pythonProcess']||!_0x238cb5[_0x570963(0x144)]['stdin'][_0x570963(0x176)])return;const _0x1abe2c=JSON[_0x570963(0x2d8)]({'command':_0x5645cb,..._0x5a0cae});try{_0x238cb5[_0x570963(0x144)][_0x570963(0x236)][_0x570963(0x2a4)](_0x1abe2c+'\x0a');}catch(_0x51d1b4){}}function startPythonService(_0xe78df6){const _0x23ee40=a0_0x572d97;let _0x4c898a=_0x23ee40(0x209);if(fs[_0x23ee40(0x27e)](PYTHON_EXE))_0x4c898a=PYTHON_EXE;try{const _0x2df57a=path[_0x23ee40(0x254)](__dirname,_0x23ee40(0x1f9),_0x23ee40(0x288));_0xe78df6[_0x23ee40(0x144)]=spawn(_0x4c898a,[_0x2df57a]),_0xe78df6[_0x23ee40(0x144)][_0x23ee40(0x24b)]['on'](_0x23ee40(0x2e4),_0x26262c=>{const _0x245d74=_0x23ee40,_0x29d23d=_0x26262c[_0x245d74(0x173)]()[_0x245d74(0x29e)]('\x0a');_0x29d23d[_0x245d74(0x1e7)](_0x57a849=>{const _0x5c5b4c=_0x245d74,_0x363725=_0x57a849[_0x5c5b4c(0x2cc)]();if(!_0x363725)return;if(_0x363725[_0x5c5b4c(0x290)](_0x5c5b4c(0x199)))_0xe78df6[_0x5c5b4c(0x2bc)][_0x5c5b4c(0x194)]('[PYTHON]\x20'+_0x363725[_0x5c5b4c(0x200)](0x5)[_0x5c5b4c(0x2cc)]());else{if(_0x363725[_0x5c5b4c(0x290)](_0x5c5b4c(0x2b7)))try{const _0x27b3f9=JSON[_0x5c5b4c(0x2a6)](_0x363725['substring'](0x8)[_0x5c5b4c(0x2cc)]());handlePythonResult(_0xe78df6,_0x27b3f9);}catch(_0x11cc5d){}}});}),_0xe78df6[_0x23ee40(0x144)]['on'](_0x23ee40(0x180),_0x451ace=>{_0xe78df6['pythonProcess']=null;});}catch(_0x48a2e4){_0xe78df6['log'][_0x23ee40(0x1d3)](_0x23ee40(0x1f1)+_0x48a2e4[_0x23ee40(0x276)]);}}function stopPythonService(_0x26920e){const _0x2bdc66=a0_0x572d97;if(_0x26920e[_0x2bdc66(0x144)]){try{_0x26920e[_0x2bdc66(0x144)][_0x2bdc66(0x2e7)]();}catch(_0x4c3116){}_0x26920e[_0x2bdc66(0x144)]=null;}}function handlePythonResult(_0x5e79db,_0x25ac4e){const _0x56b882=a0_0x572d97;if(_0x25ac4e['type']===_0x56b882(0x1a7))_0x5e79db[_0x56b882(0x2bc)][_0x56b882(0x194)](_0x56b882(0x18d));else{if(_0x25ac4e[_0x56b882(0x256)]==='SECURITY_RESULT'){const {anomaly_score:_0x2e3430,is_anomaly:_0x29efa2,threshold:_0x5d2f01,explanation:_0x118cff}=_0x25ac4e[_0x56b882(0x20e)];_0x5e79db['log'][_0x56b882(0x177)]('ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20'+_0x2e3430['toFixed'](0x5)+_0x56b882(0x1a9)+(_0x29efa2?_0x56b882(0x29d):'OK')),_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x22a),{'val':_0x2e3430,'ack':!![]}),_0x5e79db['setStateAsync'](_0x56b882(0x1b6),{'val':new Date()[_0x56b882(0x2ea)](),'ack':!![]});if(_0x5d2f01)_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x1f6),{'val':_0x5d2f01,'ack':!![]});if(_0x29efa2){let _0x2db41f='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x2e3430[_0x56b882(0x205)](0x4)+')';if(_0x118cff&&_0x118cff!==_0x56b882(0x23b))_0x2db41f+=_0x56b882(0x211)+_0x118cff;_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x277),{'val':!![],'ack':!![]}),_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x14a),{'val':_0x2db41f,'ack':!![]}),sendNotification(_0x5e79db,_0x56b882(0x1bf)+_0x2db41f,![],!![]);}}else{if(_0x25ac4e[_0x56b882(0x256)]===_0x56b882(0x1f0)){const _0x29add8=_0x25ac4e[_0x56b882(0x20e)][_0x56b882(0x19f)]||'',_0x53cd42=_0x25ac4e[_0x56b882(0x20e)][_0x56b882(0x19d)],_0x238815=_0x25ac4e[_0x56b882(0x20e)]['success']?_0x56b882(0x272)+new Date()[_0x56b882(0x1c8)]()+'\x20('+_0x29add8+')':_0x56b882(0x1be)+_0x25ac4e[_0x56b882(0x20e)]['reason'];_0x5e79db['setStateAsync'](_0x56b882(0x2c0),{'val':_0x238815,'ack':!![]});if(_0x25ac4e[_0x56b882(0x20e)][_0x56b882(0x2d4)]&&_0x53cd42)_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x1f6),{'val':_0x53cd42,'ack':!![]});}else{if(_0x25ac4e[_0x56b882(0x256)]===_0x56b882(0x17c)){const {patterns:_0xcddf85}=_0x25ac4e[_0x56b882(0x20e)];if(_0xcddf85&&_0xcddf85['length']>0x0){_0x5e79db[_0x56b882(0x2bc)][_0x56b882(0x177)](_0x56b882(0x2d5)+_0xcddf85['length']+_0x56b882(0x1bc)),_0x5e79db['setStateAsync'](_0x56b882(0x1ac),{'val':JSON[_0x56b882(0x2d8)](_0xcddf85),'ack':!![]});const _0x50d584=_0xcddf85[0x0],_0x2b55a8=_0x56b882(0x165)+_0x50d584[_0x56b882(0x22d)]+'\x20('+(_0x50d584[_0x56b882(0x289)]*0x64)[_0x56b882(0x205)](0x0)+'%)';_0x5e79db['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x257),{'val':_0x2b55a8,'ack':!![]});}else _0x5e79db[_0x56b882(0x2bc)][_0x56b882(0x177)](_0x56b882(0x215)),_0x5e79db['setStateAsync']('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x5e79db[_0x56b882(0x2db)]('analysis.automation.detectedPatterns',{'val':'[]','ack':!![]});}else{if(_0x25ac4e['type']===_0x56b882(0x178)){if(_0x25ac4e['payload'][_0x56b882(0x2d4)])try{const _0x462fe8=JSON[_0x56b882(0x2a6)](_0x25ac4e[_0x56b882(0x20e)][_0x56b882(0x19f)]);if(_0x462fe8[_0x56b882(0x2de)])_0x5e79db['setStateAsync'](_0x56b882(0x244),{'val':JSON[_0x56b882(0x2d8)](_0x462fe8[_0x56b882(0x2de)]),'ack':!![]});if(_0x462fe8[_0x56b882(0x1af)])_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x156),{'val':JSON['stringify'](_0x462fe8[_0x56b882(0x1af)]),'ack':!![]});}catch(_0x9727a0){}}else{if(_0x25ac4e['type']==='HEALTH_TRAIN_RESULT'){if(_0x25ac4e['payload'][_0x56b882(0x2d4)])_0x5e79db[_0x56b882(0x2bc)]['info'](_0x56b882(0x23e));}else{if(_0x25ac4e[_0x56b882(0x256)]===_0x56b882(0x17e))_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x237),{'val':new Date()[_0x56b882(0x2ea)](),'ack':!![]}),_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x16a),{'val':_0x25ac4e[_0x56b882(0x20e)][_0x56b882(0x147)],'ack':!![]});else{if(_0x25ac4e[_0x56b882(0x256)]===_0x56b882(0x1ad))_0x5e79db['setStateAsync']('analysis.health.trendDiagnosis',{'val':_0x25ac4e[_0x56b882(0x20e)][_0x56b882(0x212)],'ack':!![]}),_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x238),{'val':_0x25ac4e[_0x56b882(0x20e)][_0x56b882(0x217)],'ack':!![]});else{if(_0x25ac4e[_0x56b882(0x256)]===_0x56b882(0x2e6)){const {speed_trend:_0x265b5a}=_0x25ac4e['payload'];_0x265b5a!==undefined&&_0x5e79db[_0x56b882(0x2db)](_0x56b882(0x184),{'val':_0x265b5a,'ack':!![]});}else{if(_0x25ac4e[_0x56b882(0x256)]===_0x56b882(0x21b)){const {forecast:_0x781ec5}=_0x25ac4e[_0x56b882(0x20e)];_0x781ec5&&_0x5e79db['setStateAsync'](_0x56b882(0x270),{'val':JSON['stringify'](_0x781ec5),'ack':!![]});}}}}}}}}}}}function runPythonHealthCheck(_0x2ecdf2){const _0x447d8c=a0_0x572d97;if(!_0x2ecdf2[_0x447d8c(0x2e3)]||_0x2ecdf2[_0x447d8c(0x2e3)][_0x447d8c(0x260)]<0x2)return;const _0xcecbf2=_0x2ecdf2[_0x447d8c(0x2e3)][_0x447d8c(0x1e0)](_0x1a5d25=>{const _0x2e4a02=_0x447d8c,_0x3d5ad1=(_0x1a5d25[_0x2e4a02(0x2a0)]||'')[_0x2e4a02(0x1b2)]();return ACTIVITY_LEVEL_MAP[_0x3d5ad1]||0x32;});sendToPython(_0x2ecdf2,_0x447d8c(0x161),{'values':_0xcecbf2,'tag':_0x447d8c(0x26d)});}async function handleTelegramResponse(_0x32ea34,_0x17387e){const _0x52d89c=a0_0x572d97;let _0x1aea8c=_0x17387e;_0x17387e[_0x52d89c(0x290)]('[')&&(_0x1aea8c=_0x17387e['substring'](_0x17387e['indexOf'](']')+0x1));if(_0x1aea8c===_0x52d89c(0x2dd))await _0x32ea34['setStateAsync'](_0x52d89c(0x277),{'val':![],'ack':!![]}),await _0x32ea34[_0x52d89c(0x2db)]('analysis.alertReason',{'val':_0x52d89c(0x2e5),'ack':!![]}),_0x32ea34[_0x52d89c(0x17f)]=![],sendNotification(_0x32ea34,_0x52d89c(0x155),![]);else _0x1aea8c===_0x52d89c(0x1a6)&&sendNotification(_0x32ea34,_0x52d89c(0x1a8),![],!![]);}async function sendNotification(_0x142cc8,_0x4862f3,_0x589ab2=![],_0x2d9f34=![]){const _0x56cdf0=a0_0x572d97,_0x45738b=_0x142cc8[_0x56cdf0(0x285)];if(_0x45738b[_0x56cdf0(0x1e2)]){let _0x57236d={};(_0x4862f3[_0x56cdf0(0x1fb)](_0x56cdf0(0x197))||_0x2d9f34)&&(_0x57236d={'reply_markup':{'inline_keyboard':[[{'text':_0x56cdf0(0x27d),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x56cdf0(0x1a6)}]]}}),await _0x142cc8[_0x56cdf0(0x187)](_0x45738b['notifyTelegramInstance'],'send',{'text':_0x4862f3,'user':_0x45738b['notifyTelegramRecipient'],..._0x57236d});}if(_0x45738b[_0x56cdf0(0x20d)]){let _0x339016={'message':_0x4862f3,'title':_0x2d9f34?'ðŸš¨\x20EMERGENCY':_0x56cdf0(0x1fa),'priority':_0x2d9f34?0x2:0x1,'device':_0x45738b[_0x56cdf0(0x1ef)]};_0x2d9f34&&(_0x339016[_0x56cdf0(0x24a)]=0x1e,_0x339016['expire']=0xe10,_0x339016[_0x56cdf0(0x15d)]='siren'),await _0x142cc8[_0x56cdf0(0x187)](_0x45738b[_0x56cdf0(0x1f5)],_0x56cdf0(0x231),_0x339016);}_0x45738b[_0x56cdf0(0x1d5)]&&await _0x142cc8[_0x56cdf0(0x187)](_0x45738b[_0x56cdf0(0x22f)],_0x56cdf0(0x231),{'text':_0x4862f3,'to':_0x45738b[_0x56cdf0(0x140)]});}async function runGeminiAnalysis(_0x5e99dd,_0x5f1782=''){const _0x4d4f06=a0_0x572d97;if(!_0x5e99dd['geminiModel'])return;if(_0x5e99dd[_0x4d4f06(0x17a)][_0x4d4f06(0x260)]===0x0)return;const _0x4b454e=_0x5e99dd[_0x4d4f06(0x17a)][_0x4d4f06(0x174)](0x0,0xf),_0x33469a=await getWeatherContext(_0x5e99dd),_0x2c7584=_0x5e99dd[_0x4d4f06(0x208)],_0x1263da=PERSONA_MAPPING[_0x5e99dd[_0x4d4f06(0x285)][_0x4d4f06(0x1a3)]||_0x4d4f06(0x2c7)],_0x395889=_0x5e99dd[_0x4d4f06(0x285)][_0x4d4f06(0x1c9)]||'Keine\x20Details.';let _0x165c3d='Unbekannt';try{const _0x4f9341=await _0x5e99dd[_0x4d4f06(0x2cf)](_0x4d4f06(0x14e));if(_0x4f9341&&_0x4f9341[_0x4d4f06(0x25d)])_0x165c3d=_0x4f9341[_0x4d4f06(0x25d)];}catch(_0x2ee686){}let _0x1fd2f2=![];try{const _0x4ce59e=await _0x5e99dd[_0x4d4f06(0x2cf)](_0x4d4f06(0x20c));if(_0x4ce59e&&_0x4ce59e[_0x4d4f06(0x25d)])_0x1fd2f2=!![];}catch(_0x598e23){}const _0x19feb8='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x1263da+_0x4d4f06(0x26c)+_0x395889+_0x4d4f06(0x1dc)+_0x2c7584+'.\x20WETTER:\x20'+_0x33469a+_0x4d4f06(0x1bb)+_0x165c3d+'.\x20EVENTS:\x20'+JSON[_0x4d4f06(0x2d8)](_0x4b454e)+_0x4d4f06(0x14c)+_0x5f1782+_0x4d4f06(0x2c9);try{const _0xad57a9=await _0x5e99dd[_0x4d4f06(0x1c1)][_0x4d4f06(0x1fe)](_0x19feb8),_0x21d15a=JSON[_0x4d4f06(0x2a6)](_0xad57a9['response'][_0x4d4f06(0x16b)]()[_0x4d4f06(0x19b)](/```json|```/g,'')[_0x4d4f06(0x2cc)]());await _0x5e99dd[_0x4d4f06(0x2db)](_0x4d4f06(0x266),{'val':JSON[_0x4d4f06(0x2d8)](_0x21d15a),'ack':!![]});if(_0x21d15a[_0x4d4f06(0x1e5)])await _0x5e99dd[_0x4d4f06(0x2db)](_0x4d4f06(0x24d),{'val':_0x21d15a['summary'],'ack':!![]});const _0x39c734={'timestamp':Date[_0x4d4f06(0x233)](),'id':Date[_0x4d4f06(0x233)]()[_0x4d4f06(0x173)](),'analysis':{'activity':{'summary':_0x21d15a[_0x4d4f06(0x1e5)],'isAlert':_0x21d15a['isAlert'],'alertReason':_0x21d15a[_0x4d4f06(0x2bd)]},'comfort':{'automationProposal':_0x21d15a[_0x4d4f06(0x27b)]}}};await updateAnalysisHistory(_0x5e99dd,_0x39c734);const _0x12e6dd=_0x21d15a['isAlert']||![];_0x12e6dd!==_0x5e99dd[_0x4d4f06(0x17f)]&&(await _0x5e99dd[_0x4d4f06(0x2db)](_0x4d4f06(0x277),{'val':_0x12e6dd,'ack':!![]}),_0x5e99dd['lastAlertState']=_0x12e6dd,_0x12e6dd&&(await _0x5e99dd['setStateAsync'](_0x4d4f06(0x14a),{'val':_0x21d15a[_0x4d4f06(0x2bd)],'ack':!![]}),sendNotification(_0x5e99dd,_0x4d4f06(0x2ad)+_0x21d15a['alertReason'],![],_0x21d15a[_0x4d4f06(0x1de)])));if(_0x21d15a[_0x4d4f06(0x27b)]&&_0x21d15a[_0x4d4f06(0x27b)][_0x4d4f06(0x1c4)]){await _0x5e99dd['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x5e99dd['setStateAsync'](_0x4d4f06(0x257),{'val':_0x21d15a['automationProposal'][_0x4d4f06(0x185)],'ack':!![]}),await _0x5e99dd['setStateAsync'](_0x4d4f06(0x25a),{'val':_0x21d15a['automationProposal']['targetId'],'ack':!![]}),await _0x5e99dd[_0x4d4f06(0x2db)]('analysis.automation.targetValue',{'val':JSON['stringify'](_0x21d15a[_0x4d4f06(0x27b)][_0x4d4f06(0x259)]),'ack':!![]});if(_0x1fd2f2)executeAutomationAction(_0x5e99dd);}}catch(_0x413b4b){_0x5e99dd[_0x4d4f06(0x2bc)][_0x4d4f06(0x1d3)](_0x4d4f06(0x24e)+_0x413b4b[_0x4d4f06(0x276)]);}}async function createDailyDigest(_0x15c6cb){const _0x5518d5=a0_0x572d97;if(!_0x15c6cb['isProVersion'])return;await _0x15c6cb[_0x5518d5(0x2db)](LTM_DP_STATUS,{'val':_0x5518d5(0x1cb),'ack':!![]});if(!_0x15c6cb['geminiModel']||_0x15c6cb[_0x5518d5(0x15a)][_0x5518d5(0x260)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x15c6cb[_0x5518d5(0x2db)](LTM_DP_STATUS,{'val':_0x5518d5(0x28c),'ack':!![]});return;}const _0x5d8e9c=JSON[_0x5518d5(0x2a6)](JSON[_0x5518d5(0x2d8)](_0x15c6cb[_0x5518d5(0x15a)])),_0x76aa10=_0x5d8e9c[_0x5518d5(0x260)],_0x52271d=_0x5518d5(0x198)+JSON['stringify'](_0x5d8e9c);try{const _0x59f07a=await _0x15c6cb[_0x5518d5(0x1c1)][_0x5518d5(0x1fe)](_0x52271d),_0x3a69e6=JSON[_0x5518d5(0x2a6)](_0x59f07a[_0x5518d5(0x1f8)][_0x5518d5(0x16b)]()[_0x5518d5(0x19b)](/```json|```/g,'')[_0x5518d5(0x2cc)]()),_0x23069f={'timestamp':new Date()[_0x5518d5(0x2ea)](),'eventCount':_0x76aa10,'summary':_0x3a69e6['summary']||'Digest','activityLevel':_0x3a69e6[_0x5518d5(0x2a0)]||_0x5518d5(0x210),'systemMode':_0x15c6cb['currentSystemMode']};_0x15c6cb[_0x5518d5(0x2e3)][_0x5518d5(0x223)](_0x23069f),await saveDailyDigests(_0x15c6cb),_0x15c6cb[_0x5518d5(0x15a)]=[],await saveRawEventLog(_0x15c6cb),await _0x15c6cb['setStateAsync'](LTM_DP_STATUS,{'val':'Success','ack':!![]});if(_0x15c6cb[_0x5518d5(0x246)])sendToPython(_0x15c6cb,_0x5518d5(0x295),{'digest':_0x23069f});}catch(_0x1532ea){_0x15c6cb['log'][_0x5518d5(0x1d3)](_0x1532ea['message']);}}function a0_0x6611(_0x559db6,_0x5cb3e7){const _0x342ae2=a0_0x3011();return a0_0x6611=function(_0x16a955,_0x94086d){_0x16a955=_0x16a955-0x139;let _0x301126=_0x342ae2[_0x16a955];return _0x301126;},a0_0x6611(_0x559db6,_0x5cb3e7);}function setupLtmScheduler(_0x4fefea){const _0x8cae8=a0_0x572d97;try{if(_0x4fefea[_0x8cae8(0x206)])_0x4fefea[_0x8cae8(0x206)][_0x8cae8(0x13b)]();if(!_0x4fefea[_0x8cae8(0x246)])return;_0x4fefea[_0x8cae8(0x206)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x4fefea));}catch(_0x31220d){_0x4fefea[_0x8cae8(0x2bc)][_0x8cae8(0x1d3)]('LTM\x20Sched\x20Error:\x20'+_0x31220d[_0x8cae8(0x276)]);}}function setupModeResetScheduler(_0x2e07de){const _0x5449d5=a0_0x572d97;try{if(_0x2e07de['modeResetJob'])_0x2e07de['modeResetJob'][_0x5449d5(0x13b)]();_0x2e07de[_0x5449d5(0x1e1)]=schedule[_0x5449d5(0x1b8)](MODE_RESET_SCHEDULE,async()=>{const _0x4e9cc3=_0x5449d5;await loadSystemMode(_0x2e07de),AUTO_RESET_MODES[_0x4e9cc3(0x1fb)](_0x2e07de[_0x4e9cc3(0x208)])&&await _0x2e07de[_0x4e9cc3(0x2db)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x3b54ea){_0x2e07de['log'][_0x5449d5(0x1d3)](_0x5449d5(0x15e)+_0x3b54ea[_0x5449d5(0x276)]);}}function setupDriftAnalysisScheduler(_0x5636ae){const _0x494063=a0_0x572d97;try{if(_0x5636ae[_0x494063(0x294)])clearInterval(_0x5636ae['driftAnalysisTimer']);if(!_0x5636ae['isProVersion'])return;_0x5636ae[_0x494063(0x294)]=setInterval(()=>runBaselineDriftAnalysis(_0x5636ae),(_0x5636ae[_0x494063(0x285)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x5636ae),0x1388);}catch(_0x1590f9){_0x5636ae[_0x494063(0x2bc)][_0x494063(0x1d3)](_0x494063(0x192)+_0x1590f9[_0x494063(0x276)]);}}function setupBriefingScheduler(_0x1e7395){const _0x193850=a0_0x572d97;try{if(_0x1e7395[_0x193850(0x2bb)])_0x1e7395['briefingJob'][_0x193850(0x13b)]();if(!_0x1e7395[_0x193850(0x285)]['briefingEnabled'])return;const _0x17428e=(_0x1e7395['config'][_0x193850(0x258)]||_0x193850(0x1cc))[_0x193850(0x29e)](':'),_0x4aabba=parseInt(_0x17428e[0x0])||0x8,_0x2fcc78=parseInt(_0x17428e[0x1])||0x0,_0x3bd212=_0x2fcc78+'\x20'+_0x4aabba+_0x193850(0x261);_0x1e7395[_0x193850(0x2bb)]=schedule[_0x193850(0x1b8)](_0x3bd212,()=>{sendMorningBriefing(_0x1e7395);});}catch(_0x1abb5d){_0x1e7395[_0x193850(0x2bc)][_0x193850(0x1d3)](_0x193850(0x2e8)+_0x1abb5d[_0x193850(0x276)]);}}async function runBaselineDriftAnalysis(_0x28ce7f){const _0x27d8bb=a0_0x572d97;if(!_0x28ce7f[_0x27d8bb(0x246)]||!_0x28ce7f['geminiModel'])return;const _0x4ee0f0=_0x28ce7f[_0x27d8bb(0x285)]['ltmStbWindowDays']||0xe;if(_0x28ce7f[_0x27d8bb(0x2e3)][_0x27d8bb(0x260)]<_0x4ee0f0+0x7){await _0x28ce7f['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x27d8bb(0x149),'ack':!![]});return;}const _0x927e46=_0x28ce7f['dailyDigests'][_0x27d8bb(0x174)](-_0x4ee0f0),_0xf62843=_0x28ce7f[_0x27d8bb(0x2e3)][_0x27d8bb(0x174)](0x0,_0x28ce7f[_0x27d8bb(0x2e3)][_0x27d8bb(0x260)]-_0x4ee0f0),_0x4de662=_0x27d8bb(0x226)+JSON[_0x27d8bb(0x2d8)](_0xf62843)+_0x27d8bb(0x1d7)+JSON[_0x27d8bb(0x2d8)](_0x927e46);try{const _0x518a7c=await _0x28ce7f[_0x27d8bb(0x1c1)][_0x27d8bb(0x1fe)](_0x4de662),_0x361b7d=JSON[_0x27d8bb(0x2a6)](_0x518a7c[_0x27d8bb(0x1f8)][_0x27d8bb(0x16b)]()[_0x27d8bb(0x19b)](/```json|```/g,'')['trim']());_0x361b7d[_0x27d8bb(0x207)]&&(await _0x28ce7f[_0x27d8bb(0x2db)](LTM_DP_DRIFT_STATUS,{'val':_0x361b7d[_0x27d8bb(0x207)],'ack':!![]}),await _0x28ce7f['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x361b7d[_0x27d8bb(0x175)],'ack':!![]}),await _0x28ce7f['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x33abb4){}}class CogniLiving extends utils['Adapter']{constructor(_0x1baff0){const _0x23382f=a0_0x572d97;super({..._0x1baff0,'name':_0x23382f(0x251)}),this[_0x23382f(0x17a)]=[],this[_0x23382f(0x1b3)]=[],this['rawEventLog']=[],this[_0x23382f(0x2e3)]=[],this[_0x23382f(0x17d)]={},this[_0x23382f(0x2d3)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x23382f(0x203)]=!![],this[_0x23382f(0x280)]=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this['genAI']=null,this[_0x23382f(0x1c1)]=null,this['currentSystemMode']=SYSTEM_MODES[_0x23382f(0x27c)],this['isProVersion']=![],this[_0x23382f(0x17f)]=![],this[_0x23382f(0x221)]=_0x23382f(0x26a),this['analysisTimer']=null,this[_0x23382f(0x206)]=null,this[_0x23382f(0x1e1)]=null,this[_0x23382f(0x294)]=null,this[_0x23382f(0x2bb)]=null,this['pythonProcess']=null,this['dependencyInstallInProgress']=![],this['on']('ready',this[_0x23382f(0x2ba)][_0x23382f(0x154)](this)),this['on'](_0x23382f(0x201),this[_0x23382f(0x220)][_0x23382f(0x154)](this)),this['on']('unload',this[_0x23382f(0x18e)][_0x23382f(0x154)](this)),this['on'](_0x23382f(0x276),this[_0x23382f(0x2e1)][_0x23382f(0x154)](this));}async[a0_0x572d97(0x2ba)](){const _0x35dbfb=a0_0x572d97;this[_0x35dbfb(0x2bc)][_0x35dbfb(0x177)]('cogni-living\x20adapter\x20starting\x20(v'+this['version']+_0x35dbfb(0x2af));if(!checkAndInstall(this))return;await startSystem(this);}['onUnload'](_0x2dd5ee){const _0x1a89ce=a0_0x572d97;if(this['analysisTimer'])clearInterval(this[_0x1a89ce(0x15b)]);if(this[_0x1a89ce(0x294)])clearInterval(this[_0x1a89ce(0x294)]);if(this[_0x1a89ce(0x206)])this[_0x1a89ce(0x206)][_0x1a89ce(0x13b)]();if(this[_0x1a89ce(0x1e1)])this[_0x1a89ce(0x1e1)][_0x1a89ce(0x13b)]();if(this[_0x1a89ce(0x2bb)])this['briefingJob'][_0x1a89ce(0x13b)]();if(this[_0x1a89ce(0x280)])clearTimeout(this['exitTimer']);if(this[_0x1a89ce(0x21d)])clearTimeout(this[_0x1a89ce(0x21d)]);stopPythonService(this),_0x2dd5ee();}async[a0_0x572d97(0x220)](_0x3f6be1,_0x2bedd1){const _0x45ea21=a0_0x572d97;if(!_0x2bedd1||this[_0x45ea21(0x19a)])return;if(_0x3f6be1[_0x45ea21(0x1fb)](_0x45ea21(0x1c6))&&_0x3f6be1['endsWith'](_0x45ea21(0x170))&&_0x2bedd1[_0x45ea21(0x25d)]){await handleTelegramResponse(this,_0x2bedd1['val']);return;}if(_0x3f6be1===this[_0x45ea21(0x240)]+'.'+SYSTEM_DP_MODE){if(_0x2bedd1[_0x45ea21(0x25d)]&&Object[_0x45ea21(0x1e4)](SYSTEM_MODES)[_0x45ea21(0x1fb)](_0x2bedd1['val'])){this[_0x45ea21(0x208)]=_0x2bedd1[_0x45ea21(0x25d)];if(_0x2bedd1[_0x45ea21(0x25d)]===SYSTEM_MODES['VACATION'])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x2bedd1[_0x45ea21(0x2cb)])this['setState'](_0x3f6be1,{'val':this[_0x45ea21(0x208)],'ack':!![]});return;}if(!_0x2bedd1[_0x45ea21(0x2cb)]){_0x3f6be1[_0x45ea21(0x1fb)](_0x45ea21(0x1f7))&&_0x2bedd1[_0x45ea21(0x25d)]&&(this['setState'](_0x3f6be1,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x3f6be1[_0x45ea21(0x1fb)](_0x45ea21(0x239))&&_0x2bedd1[_0x45ea21(0x25d)]){this['setState'](_0x3f6be1,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x3f6be1[_0x45ea21(0x1fb)]('triggerBriefing')&&_0x2bedd1['val']&&(this[_0x45ea21(0x1b5)](_0x3f6be1,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x3f6be1['includes']('automation.triggerAction')&&_0x2bedd1[_0x45ea21(0x25d)]&&(this[_0x45ea21(0x1b5)](_0x3f6be1,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x3f6be1['includes']('analysis.training.triggerSecurity')&&_0x2bedd1[_0x45ea21(0x25d)]){this[_0x45ea21(0x1b5)](_0x3f6be1,{'val':![],'ack':!![]});if(this[_0x45ea21(0x246)])try{const _0x47e2e0=await this[_0x45ea21(0x2cf)]('LTM.trainingData.sequences');if(_0x47e2e0&&_0x47e2e0[_0x45ea21(0x25d)]){const _0x21b021=JSON['parse'](_0x47e2e0[_0x45ea21(0x25d)]);this[_0x45ea21(0x2bc)]['info']('ðŸ§ \x20Triggering\x20Security\x20Training...'),this[_0x45ea21(0x2db)]('analysis.training.status',{'val':_0x45ea21(0x1c3),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x21b021});}}catch(_0x33073a){this[_0x45ea21(0x2bc)]['error']('Training\x20Error:\x20'+_0x33073a[_0x45ea21(0x276)]);}}if(_0x3f6be1[_0x45ea21(0x1fb)]('analysis.training.triggerHealth')&&_0x2bedd1[_0x45ea21(0x25d)]){this[_0x45ea21(0x1b5)](_0x3f6be1,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x426db4=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x426db4&&_0x426db4['val'])sendToPython(this,_0x45ea21(0x15f),{'digests':JSON[_0x45ea21(0x2a6)](_0x426db4[_0x45ea21(0x25d)])});}catch(_0x4ce118){}}if(_0x3f6be1[_0x45ea21(0x1fb)](_0x45ea21(0x27f))&&_0x2bedd1[_0x45ea21(0x25d)]){this[_0x45ea21(0x1b5)](_0x3f6be1,{'val':![],'ack':!![]});if(this[_0x45ea21(0x246)])try{const _0x3a6044=await this[_0x45ea21(0x2cf)](_0x45ea21(0x1ca));if(_0x3a6044&&_0x3a6044[_0x45ea21(0x25d)])sendToPython(this,_0x45ea21(0x2b9),{'points':JSON[_0x45ea21(0x2a6)](_0x3a6044[_0x45ea21(0x25d)])});}catch(_0x429737){}}if(_0x3f6be1[_0x45ea21(0x1fb)](_0x45ea21(0x26b))&&_0x2bedd1[_0x45ea21(0x25d)]){this[_0x45ea21(0x1b5)](_0x3f6be1,{'val':![],'ack':!![]});if(this[_0x45ea21(0x246)])try{const _0x1160ad=await this['getStateAsync'](LTM_DP_RAW_LOG);_0x1160ad&&_0x1160ad[_0x45ea21(0x25d)]&&(this[_0x45ea21(0x2bc)]['info'](_0x45ea21(0x2aa)),sendToPython(this,_0x45ea21(0x265),{'events':JSON['parse'](_0x1160ad[_0x45ea21(0x25d)])}));}catch(_0x29796f){}}return;}if(this['config'][_0x45ea21(0x22b)]&&this['config']['presenceDevices']['includes'](_0x3f6be1)){await checkWifiPresence(this);return;}const _0xe4afca=(this['config'][_0x45ea21(0x2bf)]||[])['find'](_0x789379=>_0x789379['id']===_0x3f6be1);if(_0xe4afca)processSensorEvent(this,_0x3f6be1,_0x2bedd1,_0xe4afca);}async[a0_0x572d97(0x2e1)](_0x209765){const _0x55c061=a0_0x572d97;if(typeof _0x209765===_0x55c061(0x1fd)&&_0x209765[_0x55c061(0x276)]){if(_0x209765[_0x55c061(0x213)]===_0x55c061(0x2d9)){const _0x4ce258=_0x209765['message'][_0x55c061(0x2a5)]||this['config']['geminiApiKey'];if(!_0x4ce258)return this['sendTo'](_0x209765[_0x55c061(0x168)],_0x209765[_0x55c061(0x213)],{'success':![],'message':'Kein\x20API\x20Key.'},_0x209765[_0x55c061(0x16d)]);try{const _0x20b25d=new GoogleGenerativeAI(_0x4ce258),_0x8f5816=_0x20b25d[_0x55c061(0x195)]({'model':GEMINI_MODEL}),_0x35e50a=await _0x8f5816[_0x55c061(0x1fe)]('Hi');this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765[_0x55c061(0x213)],{'success':!![],'message':_0x55c061(0x1b1)+_0x35e50a['response'][_0x55c061(0x16b)]()},_0x209765[_0x55c061(0x16d)]);}catch(_0x396339){this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765[_0x55c061(0x213)],{'success':![],'message':'Err:\x20'+_0x396339[_0x55c061(0x276)]},_0x209765[_0x55c061(0x16d)]);}}else{if(_0x209765[_0x55c061(0x213)]===_0x55c061(0x1a5)){const _0x518215=await getWeatherContext(this),_0x51f757=await getCalendarContext(this);this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765[_0x55c061(0x213)],{'success':!![],'weather':_0x518215,'calendar':_0x51f757},_0x209765['callback']);}else{if(_0x209765['command']==='getLtmData'){if(!this[_0x55c061(0x246)])return this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765[_0x55c061(0x213)],{'success':![],'isPro':![]},_0x209765[_0x55c061(0x16d)]);let _0x516ae8={'status':'N/A'};try{const _0x2f224b=await this[_0x55c061(0x2cf)](LTM_DP_DRIFT_STATUS);_0x516ae8['status']=_0x2f224b?_0x2f224b[_0x55c061(0x25d)]:_0x55c061(0x14b);}catch(_0x2561e7){}this[_0x55c061(0x163)](_0x209765['from'],_0x209765['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x55c061(0x2e3)],'driftAnalysis':_0x516ae8,'analysisHistory':this[_0x55c061(0x1b3)]},_0x209765[_0x55c061(0x16d)]);}else{if(_0x209765[_0x55c061(0x213)]===_0x55c061(0x16c)){const _0x74cd7d=this[_0x55c061(0x2e3)][_0x55c061(0x260)],_0x14c22e=new Date(),_0x11406c=new Date(_0x14c22e['getFullYear'](),_0x14c22e[_0x55c061(0x228)](),_0x14c22e[_0x55c061(0x158)]())['getTime'](),_0x2fa184=this[_0x55c061(0x15a)]['filter'](_0x23c265=>new Date(_0x23c265[_0x55c061(0x2da)])[_0x55c061(0x1a2)]()>_0x11406c)[_0x55c061(0x260)],_0x427787=new Array(0x18)[_0x55c061(0x2a7)](0x0);this[_0x55c061(0x15a)][_0x55c061(0x1e7)](_0x41f89e=>{const _0x2ce68c=_0x55c061,_0xa7f195=new Date(_0x41f89e[_0x2ce68c(0x2da)]);if(_0xa7f195['getTime']()>_0x11406c)_0x427787[_0xa7f195[_0x2ce68c(0x1db)]()]++;});let _0x160648={'status':_0x55c061(0x14b)};try{const _0x1ed643=await this[_0x55c061(0x2cf)](LTM_DP_DRIFT_STATUS);_0x160648[_0x55c061(0x21e)]=_0x1ed643?_0x1ed643[_0x55c061(0x25d)]:_0x55c061(0x14b);}catch(_0x36dc44){}let _0x5e6884='';try{const _0x1b5af4=await this[_0x55c061(0x2cf)](_0x55c061(0x14e));_0x5e6884=_0x1b5af4?_0x1b5af4[_0x55c061(0x25d)]:'';}catch(_0x232b90){}let _0xcadc12=null;!this[_0x55c061(0x1c1)]&&(_0xcadc12=this['config'][_0x55c061(0x1f2)]?_0x55c061(0x196):'Kein\x20API\x20Key!');let _0x389874={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x2764d7=await this[_0x55c061(0x2cf)](_0x55c061(0x162));if(_0x2764d7&&_0x2764d7[_0x55c061(0x25d)]){_0x389874[_0x55c061(0x1c4)]=!![];const _0x24846d=await this[_0x55c061(0x2cf)](_0x55c061(0x257));_0x389874[_0x55c061(0x185)]=_0x24846d?_0x24846d[_0x55c061(0x25d)]:'';const _0x16bce5=await this[_0x55c061(0x2cf)](_0x55c061(0x25a));_0x389874[_0x55c061(0x2d1)]=_0x16bce5?_0x16bce5[_0x55c061(0x25d)]:'';const _0x4eb83e=await this[_0x55c061(0x2cf)](_0x55c061(0x214));_0x389874[_0x55c061(0x259)]=_0x4eb83e?_0x4eb83e[_0x55c061(0x25d)]:'';}const _0x284b0a=await this[_0x55c061(0x2cf)](_0x55c061(0x20c));_0x389874[_0x55c061(0x25c)]=_0x284b0a?!!_0x284b0a[_0x55c061(0x25d)]:![];}catch(_0x557600){}this[_0x55c061(0x163)](_0x209765['from'],_0x209765[_0x55c061(0x213)],{'success':!![],'eventHistory':this[_0x55c061(0x17a)]['slice'](0x0,0xf),'stats':{'digestCount':_0x74cd7d,'eventCountToday':_0x2fa184,'hourlyActivity':_0x427787,'driftStatus':_0x160648[_0x55c061(0x21e)],'isPresent':this[_0x55c061(0x203)],'presenceWho':_0x5e6884,'minDays':this[_0x55c061(0x285)][_0x55c061(0x169)]||0x7,'stbDays':this[_0x55c061(0x285)][_0x55c061(0x28a)]||0xe,'ltbDays':this[_0x55c061(0x285)][_0x55c061(0x142)]||0x3c,'systemError':_0xcadc12},'automation':_0x389874},_0x209765[_0x55c061(0x16d)]);}else{if(_0x209765['command']==='scanDevices')try{const _0x1e47a2=await scanForDevices(this,_0x209765[_0x55c061(0x276)]||{});this[_0x55c061(0x163)](_0x209765['from'],_0x209765[_0x55c061(0x213)],{'success':!![],'devices':_0x1e47a2},_0x209765[_0x55c061(0x16d)]);}catch(_0x4d946d){this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765['command'],{'success':![],'error':_0x4d946d['message']},_0x209765[_0x55c061(0x16d)]);}else{if(_0x209765[_0x55c061(0x213)]==='getEnums'){const _0x1d6846=await this[_0x55c061(0x18a)]('enum.functions.*','enum'),_0x549cfc=[];if(_0x1d6846)for(const _0x28e5af in _0x1d6846){const _0xf4da90=_0x1d6846[_0x28e5af],_0x3b6736=(_0xf4da90[_0x55c061(0x21a)]&&typeof _0xf4da90[_0x55c061(0x21a)]['name']===_0x55c061(0x1fd)?_0xf4da90[_0x55c061(0x21a)]['name']['de']:_0xf4da90['common'][_0x55c061(0x2b0)])||_0xf4da90[_0x55c061(0x21a)]['name'];_0x549cfc[_0x55c061(0x223)]({'id':_0x28e5af,'name':_0x3b6736});}this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765['command'],{'success':!![],'enums':_0x549cfc},_0x209765[_0x55c061(0x16d)]);}else{if(_0x209765['command']==='getCalendarNames'){const _0xcddffd=_0x209765[_0x55c061(0x276)]['instance'];if(!_0xcddffd)return this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765[_0x55c061(0x213)],{'success':![],'error':'No\x20instance'},_0x209765[_0x55c061(0x16d)]);const _0x1e5a96=await getCalendarNames(this,_0xcddffd);this[_0x55c061(0x163)](_0x209765['from'],_0x209765[_0x55c061(0x213)],{'success':!![],'names':_0x1e5a96},_0x209765[_0x55c061(0x16d)]);}else{if(_0x209765['command']==='simulateButler'){const {targetId:_0x2301ff,targetValue:_0x4455f7}=_0x209765[_0x55c061(0x276)];this['log']['info']('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0x2301ff+_0x55c061(0x1b0)+_0x4455f7),await this['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x55c061(0x2db)](_0x55c061(0x257),{'val':_0x55c061(0x150)+_0x2301ff,'ack':!![]}),await this[_0x55c061(0x2db)]('analysis.automation.targetId',{'val':_0x2301ff,'ack':!![]}),await this[_0x55c061(0x2db)](_0x55c061(0x214),{'val':_0x4455f7,'ack':!![]}),this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765[_0x55c061(0x213)],{'success':!![]},_0x209765[_0x55c061(0x16d)]);}else{if(_0x209765[_0x55c061(0x213)]===_0x55c061(0x2c1)){const {historyId:_0x24d83c,rating:_0x2ecb7d,comment:_0x212040,alertReason:_0x37e578}=_0x209765[_0x55c061(0x276)];_0x24d83c&&_0x2ecb7d?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x24d83c,'rating':_0x2ecb7d,'comment':_0x212040,'alertReason':_0x37e578}),this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765['command'],{'success':!![]},_0x209765[_0x55c061(0x16d)])):this[_0x55c061(0x163)](_0x209765['from'],_0x209765['command'],{'success':![],'error':'Missing\x20data'},_0x209765[_0x55c061(0x16d)]);}else _0x209765[_0x55c061(0x213)]===_0x55c061(0x24c)&&(this[_0x55c061(0x2bc)][_0x55c061(0x177)](_0x55c061(0x20f)),await this[_0x55c061(0x2db)](_0x55c061(0x162),{'val':![],'ack':!![]}),await this[_0x55c061(0x2db)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x55c061(0x163)](_0x209765[_0x55c061(0x168)],_0x209765['command'],{'success':!![]},_0x209765[_0x55c061(0x16d)]));}}}}}}}}}}}if(require[a0_0x572d97(0x2a9)]!==module)module['exports']=_0x1594ca=>new CogniLiving(_0x1594ca);else new CogniLiving();function a0_0x3011(){const _0x39f85d=['python3','subscribeStates','schalter','analysis.automation.autoApply','notifyPushoverEnabled','payload','User\x20dismissed\x20automation\x20proposal.','normal','\x0aGrund:\x20','diagnosis','command','analysis.automation.targetValue','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','date','change_percent','analysis.training.triggerHealth','Installing\x20pip\x20packages...','common','ENERGY_PREDICT_RESULT','licht','exitGraceTimer','status','Deaktiviert\x20(Pro-Feature)','onStateChange','systemUUID','isGracePeriodActive','push','Alert\x20Reason','guest','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','heizung','getMonth','Gemini\x20AI\x20initialized.','analysis.security.lastScore','presenceDevices','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','rule','âœ…\x20INSTALL\x20SUCCESS.','notifyEmailInstance','analysis.energy','send','0\x204\x20*\x20*\x20*','now','GUEST','setObjectNotExistsAsync','stdin','analysis.health.lastCheck','analysis.health.trendValue','triggerDailyDigest','analysis.analysisHistory','Unknown','Sequences','splice','âœ…\x20HEALTH\x20TRAINED.','analysis.training','namespace','path','text.alarm','2821276gASASp','analysis.energy.insulationScore','[RECORDER]\x20Error:\x20','isProVersion','pop','Insulation\x20Score','Keine\x20Wetterdaten\x20verfÃ¼gbar.','retry','stdout','dismissAutomation','analysis.activitySummary','Gemini\x20Error:\x20','Target\x20Value','system.mode','cogni-living','Training\x20Status','setForeignStateAsync','join','city','type','analysis.automation.description','briefingTime','targetValue','analysis.automation.targetId','genAI','autoApply','val','LTM.driftAnalysis','light','length','\x20*\x20*\x20*','Train\x20Comfort','getForeignStateAsync','system.config','TRAIN_COMFORT','analysis.lastResult','longitude','Daily\x20Digests','Security\x20Monitor','unknown','analysis.training.triggerComfort','.\x20KONTEXT:\x20','Activity-Level','Who\x20is\x20present?','analysis.history_debug_00','analysis.energy.forecast','Raw\x20Log','Success:\x20','ðŸ”\x20Scanning\x20for\x20devices...','setHours','isExit','message','analysis.isAlert','useWeather','868440SntpJm','LTM.driftAnalysis.driftDetails','automationProposal','NORMAL','âœ…\x20Alles\x20OK\x20(Reset)','existsSync','analysis.training.triggerEnergy','exitTimer','occupancy','json','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','LTM','config','Fokus\x20auf\x20Familienroutinen.','Train\x20Energy','service.py','confidence','ltmStbWindowDays','lights','Skipped\x20(No\x20AI\x20or\x20Data)','pip','.NextHours.Location_1.Day_1.current.temp_value','extendObjectAsync','startsWith','778491EswDNm','presence','Today\x20Vector\x20(15m)','driftAnalysisTimer','ANALYZE_HEALTH','Gait\x20Speed\x20Trend','tÃ¼r','loc','getMinutes','online','door','âŒ\x20VENV\x20FAILED:\x20','ANOMALY','split','indicator','activityLevel','Â°C,\x20','3434754rwQefe','Event\x20History','write','apiKey','parse','fill','getObjectAsync','main','ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','LTM.dailyDigests','win32','âš ï¸\x20ALARM:\x20','@iobroker/adapter-core',')\x20-\x20SAFE\x20BOOT','name','PREDICT_ENERGY','.forecast.current.temp','Detected\x20Patterns','Health\x20Analysis','Briefing\x20Error:\x20','PARTY','[RESULT]','Description','TRAIN_ENERGY','onReady','briefingJob','log','alertReason','Restoring\x20sensor\x20cache...','devices','analysis.training.status','submitFeedback','analysis.security','LTM.processingStatus','accuweather','LTM.baselineStatus','Heating\x20Score','generic','Energy\x20Intelligence','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','unshift','ack','trim','floor','outdoorSensorId','getStateAsync','dimmer','targetId','apply','systemConfig','success','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','analysis.health','weatherInstance','stringify','testApiKey','timestamp','setStateAsync','(((.+)+)+)+$','COGNI_CONFIRM_OK','insulation','daswetter','value','onMessage','switch','dailyDigests','data','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','GAIT_RESULT','kill','Briefing\x20Sched\x20Error:\x20','WiFi\x20Presence\x20detected.','toISOString','vacation','BUTLER\x20Execution\x20Error:\x20','cancel','logDuplicates','bin','inactivityThresholdHours','child_process','notifyEmailRecipient','analysisInterval','ltmLtbWindowDays','getForeignObjectAsync','pythonProcess','LTM.rawEventLog','.venv','is_anomaly','LTM.triggerDailyDigest','N/A\x20(Learning)','analysis.alertReason','N/A','.\x20EMERGENCY:\x20','Thermodynamics','system.presenceWho','736367uKtTIm','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','number','Analysiere\x20ausgewogen.','Current\x20Threshold','bind','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','analysis.energy.heatingScore','analysis.triggerBriefing','getDate','PRIORITÃ„T:\x20Sicherheit.','rawEventLog','analysisTimer','System','sound','Reset\x20Sched\x20Error:\x20','TRAIN_HEALTH','notifyTelegramInstance','ANALYZE_TREND','analysis.automation.patternDetected','sendTo','contact','Regel\x20erkannt:\x20','.forecast.current.temperature','kontakt','from','minDaysForBaseline','analysis.health.isAnomaly','text','getOverviewData','callback','doors','subscribeForeignStatesAsync','communicate.request','motion','LTM.trainingData.sequences','toString','slice','driftDetails','writable','info','ENERGY_TRAIN_RESULT','location','eventHistory','events.lastEvent','COMFORT_RESULT','sensorLastValues','HEALTH_RESULT','lastAlertState','close','system.isPresent','Trigger\x20Action','.Current.WeatherText','analysis.health.gaitSpeed','description','temperature','sendToAsync','.communicate.request','âš ï¸\x20Python\x20VENV\x20missing.\x20Installing\x20locally...','getForeignObjectsAsync','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','lampe','ðŸ\x20Python\x20Pong','onUnload','Scripts','Kalender\x20deaktiviert.','LTM.driftAnalysis.baselineDrift','Drift\x20Sched\x20Error:\x20','python.exe','debug','getGenerativeModel','KI-Modell\x20nicht\x20initialisiert','Alarm','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','[LOG]','dependencyInstallInProgress','replace','rating','threshold','python','details','.Current.Temperature','Trend\x20Value','getTime','aiPersona','fenster','testContext','COGNI_REQUEST_CALL','PONG','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','\x20->\x20','@google/generative-ai','3420060SpnyrX','analysis.automation.detectedPatterns','TREND_RESULT','requirements.txt','heating','\x20=\x20','OK:\x20','toLowerCase','analysisHistory','Trend','setState','analysis.security.lastCheck','rmSync','scheduleJob','boolean','state','.\x20ANWESEND:\x20','\x20new\x20patterns.','.forecast.current.state','Failed:\x20','âš ï¸\x20SECURITY\x20ALARM:\x20','analysis.automation.triggerAction','geminiModel','Train\x20Health','Sec-Training\x20started...','detected','System\x20Mode','telegram','warn','toLocaleTimeString','livingContext','LTM.trainingData.thermodynamics','Started...','08:00','Alert\x20Status','channel','Last\x20Check','analysis.health.trendDiagnosis','1077702NqwWpE','Trigger\x20Briefing','error','Pattern\x20Detected','notifyEmailEnabled','\x20Tage)','\x0aSTB:\x20','shift','licenseKey','events.history','getHours','.\x20SYSTEM_MODE:\x20','search','isEmergency','prÃ¤senz','map','modeResetJob','notifyTelegramEnabled','calendarInstance','values','summary','temperatur','forEach','string','ðŸš€\x20Starting\x20NUUKANNI\x20Logic\x20(v0.11.0)...','party','delObjectAsync','application/json','indicator.alarm','analysis.training.triggerSecurity','notifyPushoverRecipient','TRAINING_COMPLETE','Error\x20launching\x20Python:\x20','geminiApiKey','Wetterdaten\x20deaktiviert.','Anomaly\x20Score','notifyPushoverInstance','analysis.security.currentThreshold','analysis.trigger','response','python_service','Cogni-Living','includes','0\x203\x20*\x20*\x20*','object','generateContent','AI\x20Training','substring','stateChange','button','isPresent','bewegung','toFixed','ltmJob','baselineDrift','currentSystemMode'];a0_0x3011=function(){return _0x39f85d;};return a0_0x3011();}