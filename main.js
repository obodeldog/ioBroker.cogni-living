function a0_0x57e3(){const _0x4022e6=['integrateRoomTime','setState','saveDailyHistory','refreshCalendar','rawEventLog','motion','dailyDigests','refreshCalendar\x20failed:\x20','scanDevices','isPresent','getObjectViewAsync','analysis.topology.structure','endsWith','todayVector','system','round','./lib/recorder','calendarName','11187dHYnmJ','getDate','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','analysis.training.triggerEnergy','historyJob','analysis.visualization.pulse','setObjectNotExistsAsync','Guest\x20Mode','warn','./lib/scanner','NORMAL','NIGHT','subscribeForeignStatesAsync','getGenerativeModel','cogni-living','writeFileSync','subscribeStates','sendNotification','30588VfyBwF','lastAlertState','text','Keine\x20Daten','analysis.automation.description','utf8','getEnums','3590DZRYfM','manual','Manual\x20Event','log','instance','useCalendar','replayTodayEvents','checkWifiPresence','state','toString','¬∞C\x20(Innen:\x20','node-schedule','enum.rooms.*','analysis.energy.warmupTimes','No\x20topology\x20data\x20found','shift','\x20(Threshold)','4SlAeuq','inactivityThresholdHours','custom','message','Warte\x20auf\x20Analyse...','split','infrasoundLocked','TRAIN_TOPOLOGY','info','presenceCheckTimer','History\x20Save\x20Error:\x20','debug','val','replace','type','runGeminiAnalysis','klar','push','includes','exitTimer','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','analysisHistory','isGracePeriodActive','callback','exports','existsSync','loadSystemMode','ltmJob','moduleSecurity','readFileSync','open','calendarCheckTimer','infrasoundSensorId','daswetter.0','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','runPythonHealthCheck','666664ZtcqvK','getTime','response','\x20Kalender-Adapter\x20gefunden.','bind','error','.venv','isArray','cancel','triggerEnergyPrediction','processSensorEvent','setHours','analysis.health.geminiDay','activeModules','triggerGaitAnalysis','10774450RQCuhG','exitGraceTimer','search','11646JvpYkI','setDate','then','triggerDailyDigest','timestamp','online','temperature','‚Ü∫\x20Replaying\x20','energy','L√ºften\x20empfohlen','unload','version','infrasoundThreshold','isRelevantActivity','slice','automation.triggerAction','triggerGaitAnalysis\x20error:\x20','Standard','Gemini\x20Report\x20Day','SET_LEARNING_MODE','isProVersion','\x22history\x22:{}','keys','Sec-Training\x20started...','briefingJob','getForeignStateAsync','analysis.health.activityTrend','analysis.training.triggerComfort','enum','createAllObjects','\x20(Bewohner\x20anwesend\x20-\x20normal)','dependencyInstallInProgress','stopService','generateHealthReport','Gemini\x20Init\x20Error:\x20','Unbekannt','./lib/topology','üîÆ\x20Energy\x20Prediction\x20triggered\x20(','27834NZUmij','analysis.energy.warmupTargets','analysis.activity.roomStats','genAI','getAbsoluteDefaultDataDir','SYSTEM_MODES','pressureBuffer','initZombies','systemConfig','updateLocation','system.adapter.','common','lastTrackerEventTime','updateHealthVector','isSolar','find','ERROR','forEach','scanThermostats','startService','floor','protectAiMemory','Niemand','object','ack','PREDICT_ENERGY','üìù\x20Manual\x20event\x20logged:\x20','currentSystemMode','initSystemConfig','setStateAsync','TRAIN_COMFORT',',\x20Events:\x0a','thermostat','triggerHealth\x20error:\x20','now','üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20','üíæ\x20Saving\x20Daily\x20History\x20for\x20','communicate.request','presenceDevices','getCalendarNames','triggerGaitAnalysis\x20parse\x20error:\x20',',\x20Temp:\x20','analysis.training.triggerHealth','triggerBriefing','sendMorningBriefing','Party\x20Mode','system.adapter.ical.','\x20events\x20from\x20today...','bin','length','handleInfrasound','send','Init...','moduleEnergy','[Integrator]\x20Error:\x20','analysis.health.geminiNight','getForeignObjectsAsync','system.adapter.ical.È¶ô','moduleHealth','date','outdoorSensorId','de-DE','LTM.dailyDigests','weatherunderground.0','Say\x20Hello','8HvSUXr','enum.functions.*','add','getHours','party','üï∏Ô∏è\x20Topology\x20Matrix\x20manually\x20updated\x20by\x20user.','location','analysis.training.triggerSecurity','getOverviewData','analysis.health.todayVector','VACATION','analysis.training.status','Room\x20History\x20(24h\x20Buckets)','checkSolarCondition','string','name','analysis.security.lastScore','abortExitTimer','.data.table','.last_seen','eventHistory','main','analysis.automation.targetId','checkCalendarTriggers','./lib/automation','driftAnalysisTimer','49WBLAOd','¬∞C)','üîä\x20Infraschall-Alarm:\x20','sendTo','healthTrendInterval','generateContent','getMinutes','analysis.energy.warmupSources','Adapter','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','Scan\x20Error:\x20','ANALYZE_GAIT','stringify','ready','unshift','haust√ºr','minDaysForBaseline','stateChange','parse','./lib/setup','analysis.activity.roomHistory','updateTopologyMatrix\x20failed:\x20','security','comfort','sensorLastValues','initSchedules','Live\x20Event\x20Pulse','initHistory','events.history','filter','getHistoryData','min','startSystem','¬∞C,\x20Au√üen:\x20','matrix','checkThermostats','\x20sequences','toISOString','python','fill','...','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','history','window','guest','config','checkLicense','DAY','json','testContext','system.presenceWho','Unknown','sources','General\x20Activity\x20Trend','abs','pythonBridge','{\x22history\x22:{}}','LTM.triggerDailyDigest','LTM.rawEventLog','values','apiKey','analysis.prediction.trackerConfidence','infrasoundEnabled','onReady','rows','telegram','.uptime','Daily\x20Activity\x20Vector\x20(48x30min)','@iobroker/adapter-core','health','‚úÖ\x20History\x20saved:\x20','Invalid\x20matrix\x20data','.json','10548585wqbiKW','analysisTimer','TRAIN_SECURITY','infrasoundArmingId','apply','memoryCache','constructor','SYSTEM_DP_MODE','analyzeWindowOpening','toLowerCase','devices','CALCULATE_HEALTH_TREND','geminiModel','some','max','heiter','LTM.trainingData.sequences','1612911SZPzrq','executeAutomationAction','./lib/python_bridge','roomIntegratorTimer','command','Gemini\x20Report\x20Night','number','pop','updated','analysis.health.todayRoomDetails','getStateAsync','setPresence','./lib/dead_man','./lib/installer','join','LTM.baselineStatus','onMessage','[PythonBridge]\x20Forwarding\x20command:\x20','üîä\x20Infraschall:\x20','reduce','\x20rooms)','trackerHeartbeat','toFixed','weatherTempId','sunny','value','geminiApiKey','üí®\x20L√ºftung\x20in\x20','TRAIN_HEALTH','substring','from'];a0_0x57e3=function(){return _0x4022e6;};return a0_0x57e3();}const a0_0x9b14de=a0_0x3f19;(function(_0x5511c0,_0x48a2e0){const _0xfb9462=a0_0x3f19,_0x27e2fe=_0x5511c0();while(!![]){try{const _0x25bb2c=-parseInt(_0xfb9462(0x1c0))/0x1*(-parseInt(_0xfb9462(0xb0))/0x2)+-parseInt(_0xfb9462(0x165))/0x3*(parseInt(_0xfb9462(0xf1))/0x4)+parseInt(_0xfb9462(0x1af))/0x5*(-parseInt(_0xfb9462(0x8a))/0x6)+-parseInt(_0xfb9462(0x10b))/0x7*(-parseInt(_0xfb9462(0x1e4))/0x8)+parseInt(_0xfb9462(0x154))/0x9+-parseInt(_0xfb9462(0x1f3))/0xa+parseInt(_0xfb9462(0x196))/0xb*(parseInt(_0xfb9462(0x1a8))/0xc);if(_0x25bb2c===_0x48a2e0)break;else _0x27e2fe['push'](_0x27e2fe['shift']());}catch(_0x12098b){_0x27e2fe['push'](_0x27e2fe['shift']());}}}(a0_0x57e3,0xd13d0));const a0_0x205b71=(function(){let _0x5a3569=!![];return function(_0x4ac2a2,_0x239e74){const _0x76cc1b=_0x5a3569?function(){const _0x73472d=a0_0x3f19;if(_0x239e74){const _0x28e680=_0x239e74[_0x73472d(0x158)](_0x4ac2a2,arguments);return _0x239e74=null,_0x28e680;}}:function(){};return _0x5a3569=![],_0x76cc1b;};}()),a0_0x3def1d=a0_0x205b71(this,function(){const _0x1ce821=a0_0x3f19;return a0_0x3def1d[_0x1ce821(0x1b8)]()[_0x1ce821(0x89)]('(((.+)+)+)+$')[_0x1ce821(0x1b8)]()[_0x1ce821(0x15a)](a0_0x3def1d)['search']('(((.+)+)+)+$');});function a0_0x3f19(_0x1964ec,_0x43cf9a){const _0x1b3a45=a0_0x57e3();return a0_0x3f19=function(_0x3def1d,_0x205b71){_0x3def1d=_0x3def1d-0x88;let _0x57e30b=_0x1b3a45[_0x3def1d];return _0x57e30b;},a0_0x3f19(_0x1964ec,_0x43cf9a);}a0_0x3def1d();'use strict';const utils=require(a0_0x9b14de(0x14f)),{GoogleGenerativeAI}=require('@google/generative-ai'),path=require('path'),fs=require('fs'),installer=require(a0_0x9b14de(0x172)),scanner=require(a0_0x9b14de(0x19f)),schedulers=require('./lib/scheduler'),topology=require(a0_0x9b14de(0xae)),setup=require(a0_0x9b14de(0x11e)),recorder=require(a0_0x9b14de(0x194)),pythonBridge=require(a0_0x9b14de(0x167)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x9b14de(0x171)),automation=require(a0_0x9b14de(0x109)),GEMINI_MODEL='models/gemini-flash-latest';class CogniLiving extends utils[a0_0x9b14de(0x113)]{constructor(_0x5596b5){const _0x58b992=a0_0x9b14de;super({..._0x5596b5,'name':_0x58b992(0x1a4)}),this['eventHistory']=[],this[_0x58b992(0x1d5)]=[],this[_0x58b992(0x188)]=[],this[_0x58b992(0x18a)]=[],this[_0x58b992(0x123)]={},this[_0x58b992(0xb8)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x58b992(0x18d)]=!![],this[_0x58b992(0x1d3)]=null,this[_0x58b992(0x88)]=null,this[_0x58b992(0x1d6)]=![],this[_0x58b992(0xb3)]=null,this['geminiModel']=null,this[_0x58b992(0xcb)]=setup[_0x58b992(0xb5)][_0x58b992(0x1a0)],this[_0x58b992(0x9e)]=![],this[_0x58b992(0x1a9)]=![],this[_0x58b992(0x155)]=null,this[_0x58b992(0x1df)]=null,this[_0x58b992(0x1c9)]=null,this[_0x58b992(0x1db)]=null,this['modeResetJob']=null,this[_0x58b992(0x10a)]=null,this[_0x58b992(0xa2)]=null,this[_0x58b992(0x19a)]=null,this[_0x58b992(0x17a)]=null,this[_0x58b992(0x10f)]=null,this[_0x58b992(0x168)]=null,this['dependencyInstallInProgress']=![],this[_0x58b992(0xbc)]=Date[_0x58b992(0xd2)](),this[_0x58b992(0x159)]=null,this['bootTime']=Date['now'](),this[_0x58b992(0x1c6)]=![],this[_0x58b992(0xb6)]=[],this[_0x58b992(0x1f1)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x58b992(0x118),this[_0x58b992(0x14a)][_0x58b992(0x1e8)](this)),this['on'](_0x58b992(0x11c),this['onStateChange'][_0x58b992(0x1e8)](this)),this['on'](_0x58b992(0x94),this['onUnload']['bind'](this)),this['on']('message',this['onMessage'][_0x58b992(0x1e8)](this));}async[a0_0x9b14de(0x14a)](){const _0x991fd1=a0_0x9b14de;this[_0x991fd1(0x1b2)][_0x991fd1(0x1c8)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x991fd1(0x95)]+')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)');if(this[_0x991fd1(0x138)][_0x991fd1(0xea)]!==undefined)this[_0x991fd1(0x1f1)][_0x991fd1(0x150)]=this[_0x991fd1(0x138)][_0x991fd1(0xea)];if(this['config'][_0x991fd1(0x1dc)]!==undefined)this[_0x991fd1(0x1f1)]['security']=this['config'][_0x991fd1(0x1dc)];if(this[_0x991fd1(0x138)]['moduleEnergy']!==undefined)this['activeModules'][_0x991fd1(0x92)]=this[_0x991fd1(0x138)][_0x991fd1(0xe5)];if(this[_0x991fd1(0x138)]['moduleComfort']!==undefined)this[_0x991fd1(0x1f1)][_0x991fd1(0x122)]=this[_0x991fd1(0x138)]['moduleComfort'];if(this['config']['modules'])this['activeModules']={...this[_0x991fd1(0x1f1)],...this[_0x991fd1(0x138)]['modules']};this[_0x991fd1(0x12b)]();}async[a0_0x9b14de(0x12b)](){const _0x345d49=a0_0x9b14de;await setup[_0x345d49(0xb7)](this);try{this['isProVersion']=await setup[_0x345d49(0x139)](this[_0x345d49(0x138)]['licenseKey']);}catch(_0xa22d92){}if(!this['config'][_0x345d49(0x1c1)]||this[_0x345d49(0x138)][_0x345d49(0x1c1)]<0.1)this['config'][_0x345d49(0x1c1)]=0xc;await setup[_0x345d49(0x126)](this),await setup[_0x345d49(0xcc)](this),topology['updateTopology'](this);try{const _0x50f8d4=await this[_0x345d49(0x16f)](_0x345d49(0x1bc)),_0x316a29=await this[_0x345d49(0x16f)](_0x345d49(0x112));_0x50f8d4&&_0x50f8d4[_0x345d49(0x1cc)]&&_0x316a29&&_0x316a29[_0x345d49(0x1cc)]&&(Date[_0x345d49(0xd2)]()-_0x50f8d4['ts']<0x4*0xe10*0x3e8&&(this[_0x345d49(0x159)]={'times':JSON[_0x345d49(0x11d)](_0x50f8d4['val']),'sources':JSON['parse'](_0x316a29[_0x345d49(0x1cc)])}));}catch(_0x5975d8){}if(this[_0x345d49(0x138)][_0x345d49(0x17f)])try{this[_0x345d49(0xb3)]=new GoogleGenerativeAI(this['config'][_0x345d49(0x17f)]),this[_0x345d49(0x160)]=this[_0x345d49(0xb3)][_0x345d49(0x1a3)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}});}catch(_0x416806){this['log'][_0x345d49(0x1e9)](_0x345d49(0xac)+_0x416806[_0x345d49(0x1c3)]);}await setup[_0x345d49(0xa7)](this),await this[_0x345d49(0x1da)](),schedulers[_0x345d49(0x124)](this),await this['setObjectNotExistsAsync'](_0x345d49(0x19b),{'type':_0x345d49(0x1b7),'common':{'name':_0x345d49(0x125),'type':_0x345d49(0x16b),'role':'value','read':!![],'write':![]},'native':{}}),await this[_0x345d49(0x19c)](_0x345d49(0xb2),{'type':_0x345d49(0x1b7),'common':{'name':'Room\x20Dwell\x20Time\x20Stats','type':'string','role':'json','read':!![],'write':![],'def':'{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}'},'native':{}}),await this[_0x345d49(0x19c)](_0x345d49(0x11f),{'type':_0x345d49(0x1b7),'common':{'name':_0x345d49(0xfd),'type':_0x345d49(0xff),'role':_0x345d49(0x13b),'read':!![],'write':![],'def':_0x345d49(0x143)},'native':{}}),await this[_0x345d49(0x19c)]('analysis.health.geminiNight',{'type':_0x345d49(0x1b7),'common':{'name':_0x345d49(0x16a),'type':_0x345d49(0xff),'role':'text','read':!![],'write':![],'def':_0x345d49(0x1c4)},'native':{}}),await this['setObjectNotExistsAsync'](_0x345d49(0x1f0),{'type':_0x345d49(0x1b7),'common':{'name':_0x345d49(0x9c),'type':_0x345d49(0xff),'role':'text','read':!![],'write':![],'def':_0x345d49(0x1c4)},'native':{}}),await this[_0x345d49(0x19c)](_0x345d49(0xfa),{'type':_0x345d49(0x1b7),'common':{'name':_0x345d49(0x14e),'type':'string','role':_0x345d49(0x13b),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x345d49(0x19c)](_0x345d49(0x16e),{'type':_0x345d49(0x1b7),'common':{'name':'Daily\x20Room\x20Details\x20(48x30min)','type':_0x345d49(0xff),'role':_0x345d49(0x13b),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x345d49(0x19c)](_0x345d49(0xa4),{'type':_0x345d49(0x1b7),'common':{'name':_0x345d49(0x140),'type':'number','role':'value','unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x345d49(0x19c)](_0x345d49(0x1bc),{'type':'state','common':{'name':'Warm-Up\x20Time','type':_0x345d49(0xff),'role':_0x345d49(0x13b),'read':!![],'write':![]},'native':{}});try{const _0x314ba2=await this[_0x345d49(0x16f)]('events.history');if(_0x314ba2&&_0x314ba2[_0x345d49(0x1cc)]){this['eventHistory']=JSON[_0x345d49(0x11d)](_0x314ba2['val']);if(this[_0x345d49(0x9e)]){const _0x34bf7e=await this['getStateAsync']('LTM.rawEventLog');if(_0x34bf7e&&_0x34bf7e['val'])this[_0x345d49(0x188)]=JSON[_0x345d49(0x11d)](_0x34bf7e[_0x345d49(0x1cc)]);}this[_0x345d49(0x1b2)]['info']('üì¶\x20Restored\x20'+this['eventHistory']['length']+'\x20events\x20from\x20standard\x20storage.');}}catch(_0x3cc9f5){this[_0x345d49(0x105)]=[];}try{const _0x3d52c5=await this[_0x345d49(0x16f)](_0x345d49(0xee));if(_0x3d52c5&&_0x3d52c5[_0x345d49(0x1cc)])this[_0x345d49(0x18a)]=JSON[_0x345d49(0x11d)](_0x3d52c5[_0x345d49(0x1cc)]);}catch(_0x56c885){this[_0x345d49(0x18a)]=[];}const _0x395899=this[_0x345d49(0x18a)][_0x345d49(0xe1)]>=(this[_0x345d49(0x138)][_0x345d49(0x11b)]||0x7)?'Aktiv\x20('+this['dailyDigests']['length']+'\x20Tage)':'Lernphase\x20('+this['dailyDigests']['length']+'/'+(this['config'][_0x345d49(0x11b)]||0x7)+')';await this[_0x345d49(0xcd)](_0x345d49(0x174),{'val':_0x395899,'ack':!![]}),this[_0x345d49(0x1a6)]('analysis.trigger'),this[_0x345d49(0x1a6)](_0x345d49(0x144)),this[_0x345d49(0x1a6)](_0x345d49(0xda));this[_0x345d49(0x138)][_0x345d49(0x149)]&&this[_0x345d49(0x138)][_0x345d49(0x1e0)]&&this['activeModules'][_0x345d49(0x121)]&&this['subscribeForeignStates'](this[_0x345d49(0x138)][_0x345d49(0x1e0)]);const _0x2177f0=this[_0x345d49(0x138)][_0x345d49(0x15e)];if(_0x2177f0)for(const _0x4d7e33 of _0x2177f0){await this[_0x345d49(0x1a2)](_0x4d7e33['id']);}const _0xbeaa73=this['config'][_0x345d49(0xd6)];if(_0xbeaa73)for(const _0x17d943 of _0xbeaa73){await this[_0x345d49(0x1a2)](_0x17d943);}const _0x2cb2c2=require(_0x345d49(0x1ba));if(this[_0x345d49(0x19a)])this[_0x345d49(0x19a)][_0x345d49(0x1ec)]();this[_0x345d49(0x19a)]=_0x2cb2c2['scheduleJob']('59\x2023\x20*\x20*\x20*',()=>{this['saveDailyHistory']();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this['roomIntegratorTimer'])clearInterval(this[_0x345d49(0x168)]);this[_0x345d49(0x184)](),this['roomIntegratorTimer']=setInterval(async()=>{const _0x4e4071=_0x345d49;await this[_0x4e4071(0x184)]();},0x3c*0x3e8);if(this[_0x345d49(0x10f)])clearInterval(this[_0x345d49(0x10f)]);this[_0x345d49(0x10f)]=setInterval(()=>{const _0x3753e2=_0x345d49;this[_0x3753e2(0x9e)]&&this[_0x3753e2(0x1f1)]['health']&&this[_0x3753e2(0x1e3)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x345d49(0x155)])clearInterval(this[_0x345d49(0x155)]);this['activeModules']['energy']&&(this[_0x345d49(0x155)]=setInterval(()=>{const _0x2dcc85=_0x345d49;this[_0x2dcc85(0x1ed)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x345d49(0x1ed)](),0x2710));if(this['calendarCheckTimer'])clearInterval(this[_0x345d49(0x1df)]);this[_0x345d49(0x138)][_0x345d49(0x1b4)]&&this[_0x345d49(0x1f1)]['energy']&&(this[_0x345d49(0x1df)]=setInterval(()=>{const _0x581aea=_0x345d49;automation[_0x581aea(0x108)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x345d49(0x108)](this),0x3a98));if(this[_0x345d49(0x1c9)])clearInterval(this[_0x345d49(0x1c9)]);this[_0x345d49(0x138)][_0x345d49(0xd6)]&&this['config'][_0x345d49(0xd6)][_0x345d49(0xe1)]>0x0&&(this[_0x345d49(0x1c9)]=setInterval(async()=>{const _0x307d83=_0x345d49;await this[_0x307d83(0x1b6)]();},0x3c*0x3e8),setTimeout(async()=>await this['checkWifiPresence'](),0x1388));const _0x33870f=path[_0x345d49(0x173)](__dirname,_0x345d49(0x1ea),_0x345d49(0xe0),_0x345d49(0x131));pythonBridge[_0x345d49(0xc3)](this,_0x33870f);}['onUnload'](_0x2d7fe5){const _0xd856e3=a0_0x9b14de;if(this[_0xd856e3(0x19a)])this[_0xd856e3(0x19a)][_0xd856e3(0x1ec)]();this['saveDailyHistory']()[_0xd856e3(0x8c)](()=>{const _0x51a083=_0xd856e3;if(this[_0x51a083(0x155)])clearInterval(this[_0x51a083(0x155)]);if(this[_0x51a083(0x1df)])clearInterval(this[_0x51a083(0x1df)]);if(this[_0x51a083(0x1c9)])clearInterval(this[_0x51a083(0x1c9)]);if(this[_0x51a083(0x168)])clearInterval(this[_0x51a083(0x168)]);recorder[_0x51a083(0x102)](this),pythonBridge[_0x51a083(0xaa)](this),_0x2d7fe5();});}async[a0_0x9b14de(0x1b5)](){const _0x1964ee=a0_0x9b14de;if(!this[_0x1964ee(0x105)]||this['eventHistory'][_0x1964ee(0xe1)]===0x0){this['log']['warn'](_0x1964ee(0x134));return;}this['log'][_0x1964ee(0x1c8)](_0x1964ee(0x91)+this[_0x1964ee(0x105)]['length']+_0x1964ee(0xdf));const _0x16caed=new Date()[_0x1964ee(0x1ef)](0x0,0x0,0x0,0x0),_0x5691e6='analysis.activity.roomHistory';let _0x4ac2e3={'history':{},'date':new Date()['toLocaleDateString']()};const _0x3d42c6='analysis.health.todayVector',_0xa51f38=_0x1964ee(0x16e);let _0x4e90ca=new Array(0x30)[_0x1964ee(0x132)](0x0),_0x54b3ab=Array[_0x1964ee(0x183)]({'length':0x30},()=>[]);this[_0x1964ee(0x105)]['forEach'](_0x587e73=>{const _0x50b8f9=_0x1964ee;if(_0x587e73[_0x50b8f9(0x8e)]>=_0x16caed){if(recorder[_0x50b8f9(0x97)](_0x587e73[_0x50b8f9(0x1ce)],_0x587e73[_0x50b8f9(0x17e)])){const _0x355615=new Date(_0x587e73['timestamp']),_0x5b56f9=_0x355615[_0x50b8f9(0xf4)]()*0x2+(_0x355615[_0x50b8f9(0x111)]()>=0x1e?0x1:0x0);if(_0x5b56f9<0x30){_0x4e90ca[_0x5b56f9]++;const _0x4dd48c=_0x587e73['location']||_0x587e73[_0x50b8f9(0x100)]||'?';let _0x4c4e5d=_0x54b3ab[_0x5b56f9];!_0x4c4e5d[_0x50b8f9(0x1d2)](_0x4dd48c)&&_0x4c4e5d[_0x50b8f9(0x1d1)](_0x4dd48c);}const _0x295b2d=_0x355615[_0x50b8f9(0xf4)]();let _0x2f69fc=_0x587e73[_0x50b8f9(0xf7)]||_0x50b8f9(0x13e);const _0x5cbadb=(this[_0x50b8f9(0x138)][_0x50b8f9(0x15e)]||[])[_0x50b8f9(0xbf)](_0x13d92d=>_0x13d92d['location']===_0x2f69fc);if(_0x5cbadb)_0x2f69fc=_0x5cbadb[_0x50b8f9(0xf7)];if(!_0x4ac2e3[_0x50b8f9(0x135)][_0x2f69fc])_0x4ac2e3[_0x50b8f9(0x135)][_0x2f69fc]=new Array(0x18)[_0x50b8f9(0x132)](0x0);if(_0x4ac2e3[_0x50b8f9(0x135)][_0x2f69fc][_0x295b2d]<0x3c)_0x4ac2e3['history'][_0x2f69fc][_0x295b2d]++;}}});const _0x8c135=await this[_0x1964ee(0x16f)](_0x5691e6);(!_0x8c135||!_0x8c135[_0x1964ee(0x1cc)]||_0x8c135[_0x1964ee(0x1cc)]==='{}'||_0x8c135[_0x1964ee(0x1cc)]['includes'](_0x1964ee(0x9f)))&&await this['setStateAsync'](_0x5691e6,{'val':JSON[_0x1964ee(0x117)](_0x4ac2e3),'ack':!![]}),await this[_0x1964ee(0xcd)](_0x3d42c6,{'val':JSON['stringify'](_0x4e90ca),'ack':!![]}),await this[_0x1964ee(0xcd)](_0xa51f38,{'val':JSON['stringify'](_0x54b3ab),'ack':!![]}),this[_0x1964ee(0x1b2)][_0x1964ee(0x1c8)](_0x1964ee(0x114));}async[a0_0x9b14de(0x186)](){const _0x472bae=a0_0x9b14de;if(!this[_0x472bae(0x1f1)][_0x472bae(0x150)])return;const _0x413e4b=new Date()['toISOString']()['split']('T')[0x0];this[_0x472bae(0x1b2)]['debug'](_0x472bae(0xd4)+_0x413e4b+_0x472bae(0x133));try{const [_0x265cad,_0x49c480,_0x4308f5,_0x2ee987,_0x3800f0,_0x47c3cd]=await Promise['all']([this['getStateAsync'](_0x472bae(0x11f)),this[_0x472bae(0x16f)](_0x472bae(0xe7)),this['getStateAsync']('analysis.health.geminiDay'),this[_0x472bae(0x16f)](_0x472bae(0x101)),this[_0x472bae(0x16f)]('analysis.health.todayVector'),this['getStateAsync'](_0x472bae(0xa4))]),_0x5bb59d=this['eventHistory'][_0x472bae(0x128)](_0x284018=>_0x284018['timestamp']>=new Date()[_0x472bae(0x1ef)](0x0,0x0,0x0,0x0)&&(_0x284018[_0x472bae(0x100)][_0x472bae(0x15d)]()[_0x472bae(0x1d2)](_0x472bae(0x11a))||_0x284018[_0x472bae(0x100)][_0x472bae(0x15d)]()[_0x472bae(0x1d2)]('terrasse'))&&(_0x284018[_0x472bae(0x17e)]===!![]||_0x284018[_0x472bae(0x17e)]===_0x472bae(0x1de)))[_0x472bae(0xe1)];let _0x595a59=0x55;if(_0x47c3cd&&_0x47c3cd[_0x472bae(0x1cc)]!==undefined)_0x595a59=Math[_0x472bae(0x12a)](0x64,Math['max'](0x14,Math[_0x472bae(0x193)](0x50+Number(_0x47c3cd[_0x472bae(0x1cc)])*0x5)));const _0x1cd749={'date':_0x413e4b,'timestamp':Date[_0x472bae(0xd2)](),'roomHistory':_0x265cad?.['val']?JSON[_0x472bae(0x11d)](_0x265cad[_0x472bae(0x1cc)]):{},'geminiNight':_0x49c480?.['val']||_0x472bae(0x1ab),'geminiDay':_0x4308f5?.[_0x472bae(0x1cc)]||_0x472bae(0x1ab),'anomalyScore':_0x2ee987?.[_0x472bae(0x1cc)]||0.1,'todayVector':_0x3800f0?.[_0x472bae(0x1cc)]?JSON[_0x472bae(0x11d)](_0x3800f0[_0x472bae(0x1cc)]):new Array(0x30)[_0x472bae(0x132)](0x0),'batteryLevel':_0x595a59,'freshAirCount':_0x5bb59d,'eventHistory':this[_0x472bae(0x105)]},_0x5a6e4d=utils[_0x472bae(0xb4)](),_0x424274=path[_0x472bae(0x173)](_0x5a6e4d,_0x472bae(0x1a4),_0x472bae(0x135));if(!fs[_0x472bae(0x1d9)](_0x424274))fs['mkdirSync'](_0x424274,{'recursive':!![]});const _0x412255=path['join'](_0x424274,_0x413e4b+_0x472bae(0x153));fs[_0x472bae(0x1a5)](_0x412255,JSON[_0x472bae(0x117)](_0x1cd749)),this[_0x472bae(0x1b2)]['info'](_0x472bae(0x151)+_0x412255);}catch(_0x28f77d){this[_0x472bae(0x1b2)][_0x472bae(0x1e9)](_0x472bae(0x1ca)+_0x28f77d['message']);}}async[a0_0x9b14de(0x184)](){const _0x3777a1=a0_0x9b14de;if(!this['isPresent'])return;try{let _0x115c81=null;try{const _0x3992c7=await this['getStateAsync']('analysis.prediction.trackerTopRoom'),_0x2e0846=await this[_0x3777a1(0x16f)](_0x3777a1(0x148));if(_0x3992c7&&_0x3992c7['val']&&_0x2e0846&&_0x2e0846['val']&&_0x2e0846[_0x3777a1(0x1cc)]>0.3){if(_0x3992c7['val']!=='Unknown'&&_0x3992c7[_0x3777a1(0x1cc)]!==_0x3777a1(0xe4))_0x115c81=_0x3992c7[_0x3777a1(0x1cc)];}}catch(_0x1c936c){}if(!_0x115c81){const _0x2dd369=this[_0x3777a1(0x138)][_0x3777a1(0x15e)]||[];for(const _0x411f5e of _0x2dd369){if(_0x411f5e[_0x3777a1(0x1ce)]===_0x3777a1(0x189)&&_0x411f5e['location'])try{const _0x64759e=await this[_0x3777a1(0xa3)](_0x411f5e['id']);if(_0x64759e&&(_0x64759e[_0x3777a1(0x1cc)]===!![]||_0x64759e['val']==='on'||_0x64759e[_0x3777a1(0x1cc)]===0x1)){_0x115c81=_0x411f5e[_0x3777a1(0xf7)];break;}}catch(_0x1d0340){}}}if(!_0x115c81)return;const _0x5295bc=this['config'][_0x3777a1(0x15e)]||[];let _0x47acf3=_0x115c81;const _0x306542=_0x5295bc['find'](_0x46c178=>_0x46c178['location']&&_0x46c178[_0x3777a1(0xf7)][_0x3777a1(0x15d)]()===_0x115c81[_0x3777a1(0x15d)]());if(_0x306542)_0x47acf3=_0x306542[_0x3777a1(0xf7)];const _0x43e499=_0x3777a1(0x11f),_0x566f3c=await this[_0x3777a1(0x16f)](_0x43e499),_0x22cee4=new Date()['toLocaleDateString']();let _0x3a9758={'history':{},'date':_0x22cee4};if(_0x566f3c&&_0x566f3c['val'])try{_0x3a9758=JSON[_0x3777a1(0x11d)](_0x566f3c[_0x3777a1(0x1cc)]);}catch(_0x1a0f3e){}_0x3a9758['date']!==_0x22cee4&&(_0x3a9758[_0x3777a1(0x135)]={},_0x3a9758['date']=_0x22cee4);if(!_0x3a9758[_0x3777a1(0x135)][_0x47acf3])_0x3a9758[_0x3777a1(0x135)][_0x47acf3]=new Array(0x18)[_0x3777a1(0x132)](0x0);const _0x4b5523=new Date()[_0x3777a1(0xf4)]();if(_0x3a9758['history'][_0x47acf3][_0x4b5523]<0x3c)_0x3a9758['history'][_0x47acf3][_0x4b5523]++;await this[_0x3777a1(0xcd)](_0x43e499,{'val':JSON['stringify'](_0x3a9758),'ack':!![]});}catch(_0x2f535a){this[_0x3777a1(0x1b2)][_0x3777a1(0x19e)](_0x3777a1(0xe6)+_0x2f535a[_0x3777a1(0x1c3)]);}}async[a0_0x9b14de(0x175)](_0xa6290b){const _0x329523=a0_0x9b14de;if(typeof _0xa6290b===_0x329523(0xc7)&&_0xa6290b['message']){if(_0xa6290b[_0x329523(0x169)]===_0x329523(0x129)){const _0x343f05=_0xa6290b['message'][_0x329523(0xeb)],_0x47a6bb=utils[_0x329523(0xb4)](),_0x525726=path[_0x329523(0x173)](_0x47a6bb,'cogni-living',_0x329523(0x135),_0x343f05+_0x329523(0x153));if(fs[_0x329523(0x1d9)](_0x525726))try{const _0x217849=JSON[_0x329523(0x11d)](fs[_0x329523(0x1dd)](_0x525726,_0x329523(0x1ad)));this['sendTo'](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':!![],'data':_0x217849},_0xa6290b[_0x329523(0x1d7)]);}catch(_0x38b5d3){this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b['command'],{'success':![],'error':'Corrupt'},_0xa6290b[_0x329523(0x1d7)]);}else this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':![],'error':'No\x20data'},_0xa6290b[_0x329523(0x1d7)]);}else{if(_0xa6290b['command']===_0x329523(0xf9)){const _0x127bd3=this['dailyDigests'][_0x329523(0xe1)];let _0x1ea3f0=new Array(0x30)[_0x329523(0x132)](0x0),_0x482dbd=Array[_0x329523(0x183)]({'length':0x30},()=>[]);try{const _0x653b0b=await this['getStateAsync']('analysis.health.todayVector');if(_0x653b0b&&_0x653b0b[_0x329523(0x1cc)])_0x1ea3f0=JSON[_0x329523(0x11d)](_0x653b0b[_0x329523(0x1cc)]);const _0x4cfbe3=await this[_0x329523(0x16f)](_0x329523(0x16e));if(_0x4cfbe3&&_0x4cfbe3[_0x329523(0x1cc)])_0x482dbd=JSON[_0x329523(0x11d)](_0x4cfbe3['val']);}catch(_0xe29115){}let _0x557df5=new Array(0x30)[_0x329523(0x132)](0x0);try{const _0x37953b=new Date();_0x37953b[_0x329523(0x8b)](_0x37953b[_0x329523(0x197)]()-0x1);const _0x3b8331=_0x37953b[_0x329523(0x130)]()[_0x329523(0x1c5)]('T')[0x0],_0x40ddcf=utils['getAbsoluteDefaultDataDir'](),_0x4a39b2=path[_0x329523(0x173)](_0x40ddcf,_0x329523(0x1a4),'history',_0x3b8331+_0x329523(0x153));if(fs['existsSync'](_0x4a39b2)){const _0x5a42f7=JSON['parse'](fs[_0x329523(0x1dd)](_0x4a39b2,'utf8'));if(_0x5a42f7&&_0x5a42f7[_0x329523(0x191)])_0x557df5=_0x5a42f7[_0x329523(0x191)];}}catch(_0x322c9b){}let _0x49395b={'today':{},'yesterday':{}};try{const _0x376231=await this['getStateAsync'](_0x329523(0xb2));if(_0x376231&&_0x376231[_0x329523(0x1cc)])_0x49395b=JSON[_0x329523(0x11d)](_0x376231[_0x329523(0x1cc)]);}catch(_0x56d6e5){}let _0x30362d=null;try{const _0x1cb7e8=await this[_0x329523(0x16f)](_0x329523(0xa4));if(_0x1cb7e8)_0x30362d=_0x1cb7e8[_0x329523(0x1cc)];}catch(_0x40ce26){}if(_0x30362d===undefined||_0x30362d===null){const _0x1e32d6=_0x1ea3f0[_0x329523(0x178)]((_0x35d22f,_0x3f6c22)=>_0x35d22f+_0x3f6c22,0x0),_0x23ece0=Math[_0x329523(0x12a)](0x2,Math[_0x329523(0x162)](-0x2,(0x64-_0x1e32d6)/0x32));_0x30362d=_0x23ece0;}let _0x3a6a14=![],_0x14a70e='',_0xb5c473='',_0xef8007='';try{const _0x5960ab=await this[_0x329523(0x16f)]('analysis.automation.patternDetected');if(_0x5960ab&&_0x5960ab[_0x329523(0x1cc)]){_0x3a6a14=!![];const _0xd14c4f=await this[_0x329523(0x16f)](_0x329523(0x1ac));_0x14a70e=_0xd14c4f?_0xd14c4f[_0x329523(0x1cc)]:'';const _0x16099b=await this[_0x329523(0x16f)](_0x329523(0x107));_0xb5c473=_0x16099b?_0x16099b[_0x329523(0x1cc)]:'';const _0x1c7d40=await this[_0x329523(0x16f)]('analysis.automation.targetValue');_0xef8007=_0x1c7d40?_0x1c7d40[_0x329523(0x1cc)]:'';}}catch(_0x17e982){}const _0x396ce5=await this[_0x329523(0xfe)](),_0x52a3c6=(this[_0x329523(0x138)][_0x329523(0x15e)]||[])[_0x329523(0x161)](_0x121145=>_0x121145[_0x329523(0xbe)]),_0x38e37d=_0x396ce5&&_0x52a3c6;let _0x3fe670='';try{const _0x3f9fbb=await this[_0x329523(0x16f)](_0x329523(0x13d));if(_0x3f9fbb&&_0x3f9fbb['val'])_0x3fe670=_0x3f9fbb[_0x329523(0x1cc)];}catch(_0xc23165){}this['sendTo'](_0xa6290b['from'],_0xa6290b['command'],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0x7d0),'stats':{'digestCount':_0x127bd3,'isPresent':this[_0x329523(0x18d)],'hourlyActivity':_0x1ea3f0,'hourlyDetails':_0x482dbd,'yesterdayActivity':_0x557df5,'solarActive':_0x38e37d,'presenceWho':_0x3fe670,'roomStats':_0x49395b,'activityTrend':_0x30362d,'modules':this[_0x329523(0x1f1)]},'automation':{'detected':_0x3a6a14,'description':_0x14a70e,'targetId':_0xb5c473,'targetValue':_0xef8007}},_0xa6290b[_0x329523(0x1d7)]);}else{if(_0xa6290b[_0x329523(0x169)]===_0x329523(0x12e))try{const _0x5bbffb=await automation[_0x329523(0xc2)](this);this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':!![],'results':_0x5bbffb},_0xa6290b[_0x329523(0x1d7)]);}catch(_0x28449b){this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b['command'],{'success':![],'error':_0x28449b['message']},_0xa6290b[_0x329523(0x1d7)]);}else{if(_0xa6290b['command']===_0x329523(0x18c))try{const _0x3cbb97=await scanner['scanForDevices'](this,_0xa6290b[_0x329523(0x1c3)]||{});this['sendTo'](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':!![],'devices':_0x3cbb97},_0xa6290b[_0x329523(0x1d7)]);}catch(_0x351af0){}else{if(_0xa6290b['command']===_0x329523(0x1ae)){const _0x136864=await this[_0x329523(0xe8)](_0x329523(0xf2),_0x329523(0xa6)),_0x35cc1f=[];if(_0x136864)for(const _0x1e7f8c in _0x136864){let _0xd2e9f6=_0x136864[_0x1e7f8c][_0x329523(0xbb)][_0x329523(0x100)];if(_0xd2e9f6&&typeof _0xd2e9f6===_0x329523(0xc7))_0xd2e9f6=_0xd2e9f6['de']||_0xd2e9f6['en']||Object['values'](_0xd2e9f6)[0x0]||JSON[_0x329523(0x117)](_0xd2e9f6);_0x35cc1f[_0x329523(0x1d1)]({'id':_0x1e7f8c,'name':String(_0xd2e9f6||_0x1e7f8c)});}const _0x331a64=await this[_0x329523(0xe8)](_0x329523(0x1bb),_0x329523(0xa6)),_0x1decad=[];if(_0x331a64)for(const _0x3d8a7d in _0x331a64){let _0x51f9f0=_0x331a64[_0x3d8a7d][_0x329523(0xbb)]['name'];if(_0x51f9f0&&typeof _0x51f9f0===_0x329523(0xc7))_0x51f9f0=_0x51f9f0['de']||_0x51f9f0['en']||Object['values'](_0x51f9f0)[0x0]||JSON[_0x329523(0x117)](_0x51f9f0);_0x1decad[_0x329523(0x1d1)](String(_0x51f9f0||_0x3d8a7d['split']('.')[_0x329523(0x16c)]()));}this['sendTo'](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':!![],'enums':_0x35cc1f,'rooms':_0x1decad},_0xa6290b[_0x329523(0x1d7)]);}else{if(_0xa6290b[_0x329523(0x169)]===_0x329523(0xd7))try{const _0x1df7e7=await this[_0x329523(0x18e)]('system',_0x329523(0x1b3),{'startkey':_0x329523(0xde),'endkey':_0x329523(0xe9)}),_0x5211b3=new Set();if(_0x1df7e7&&_0x1df7e7[_0x329523(0x14b)])for(const _0x1d02d2 of _0x1df7e7[_0x329523(0x14b)]){const _0x37fb03=_0x1d02d2['id'][_0x329523(0x1cd)](_0x329523(0xba),''),_0x360d13=await this[_0x329523(0xa3)](_0x37fb03+_0x329523(0x103));let _0x1bab1b=![];if(_0x360d13&&_0x360d13[_0x329523(0x1cc)]){const _0x441c36=typeof _0x360d13['val']===_0x329523(0xff)?JSON[_0x329523(0x11d)](_0x360d13[_0x329523(0x1cc)]):_0x360d13['val'];Array[_0x329523(0x1eb)](_0x441c36)&&_0x441c36[_0x329523(0xc1)](_0x354ee2=>{const _0x431ecc=_0x329523;_0x354ee2[_0x431ecc(0x195)]&&(_0x5211b3['add'](_0x354ee2[_0x431ecc(0x195)]),_0x1bab1b=!![]);});}!_0x1bab1b&&_0x5211b3[_0x329523(0xf3)](_0x37fb03);}const _0x5d5f2a=Array[_0x329523(0x183)](_0x5211b3);if(_0x5d5f2a['length']===0x0)_0x5d5f2a['push'](_0x329523(0x9b));this['sendTo'](_0xa6290b['from'],_0xa6290b[_0x329523(0x169)],{'success':!![],'names':_0x5d5f2a},_0xa6290b[_0x329523(0x1d7)]);}catch(_0x8cac0f){this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':![],'error':_0x329523(0x115)+_0x8cac0f['message']},_0xa6290b['callback']);}else{if(_0xa6290b[_0x329523(0x169)]===_0x329523(0x187))try{await automation['updateSchedulePreview'](this),this[_0x329523(0x10e)](_0xa6290b['from'],_0xa6290b[_0x329523(0x169)],{'success':!![]},_0xa6290b[_0x329523(0x1d7)]);}catch(_0x137b48){this[_0x329523(0x1b2)]['warn'](_0x329523(0x18b)+_0x137b48[_0x329523(0x1c3)]),this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b['command'],{'success':![],'error':_0x137b48[_0x329523(0x1c3)]},_0xa6290b[_0x329523(0x1d7)]);}else{if(_0xa6290b[_0x329523(0x169)]==='updateTopologyMatrix')try{const _0x45b40a=_0xa6290b[_0x329523(0x1c3)][_0x329523(0x12d)];if(!_0x45b40a||!Array[_0x329523(0x1eb)](_0x45b40a))throw new Error(_0x329523(0x152));const _0x205940=await this['getStateAsync'](_0x329523(0x18f));if(_0x205940&&_0x205940[_0x329523(0x1cc)]){const _0x5cf154=JSON[_0x329523(0x11d)](_0x205940[_0x329523(0x1cc)]);_0x5cf154['matrix']=_0x45b40a,_0x5cf154[_0x329523(0x16d)]=Date['now'](),await this[_0x329523(0xcd)](_0x329523(0x18f),{'val':JSON['stringify'](_0x5cf154),'ack':!![]}),this[_0x329523(0x1b2)][_0x329523(0x1cb)](_0x329523(0xf6)),this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b['command'],{'success':!![]},_0xa6290b[_0x329523(0x1d7)]);}else throw new Error(_0x329523(0x1bd));}catch(_0x5116e8){this[_0x329523(0x1b2)][_0x329523(0x19e)](_0x329523(0x120)+_0x5116e8[_0x329523(0x1c3)]),this[_0x329523(0x10e)](_0xa6290b['from'],_0xa6290b[_0x329523(0x169)],{'success':![],'error':_0x5116e8[_0x329523(0x1c3)]},_0xa6290b['callback']);}else{if(_0xa6290b['command']===_0x329523(0x142))try{const _0x6e6d2e=_0xa6290b[_0x329523(0x1c3)]['command'],_0x4fd434=_0xa6290b[_0x329523(0x1c3)];this['log'][_0x329523(0x1cb)](_0x329523(0x176)+_0x6e6d2e),pythonBridge[_0x329523(0xe3)](this,_0x6e6d2e,_0x4fd434,_0x5d3b0c=>{const _0x2ecad7=_0x329523;this['sendTo'](_0xa6290b[_0x2ecad7(0x183)],_0xa6290b[_0x2ecad7(0x169)],_0x5d3b0c,_0xa6290b[_0x2ecad7(0x1d7)]);});}catch(_0x179875){this[_0x329523(0x1b2)][_0x329523(0x19e)]('pythonBridge\x20command\x20failed:\x20'+_0x179875[_0x329523(0x1c3)]),this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b['command'],{'type':_0x329523(0xc0),'payload':_0x179875['message']},_0xa6290b[_0x329523(0x1d7)]);}else{if(_0xa6290b[_0x329523(0x169)]==='testApiKey')try{const _0x321454=_0xa6290b[_0x329523(0x1c3)]?_0xa6290b[_0x329523(0x1c3)][_0x329523(0x147)]:'';if(!_0x321454)throw new Error('Kein\x20API\x20Key\x20√ºbergeben.');const _0x5539cf=new GoogleGenerativeAI(_0x321454),_0x339962=_0x5539cf[_0x329523(0x1a3)]({'model':GEMINI_MODEL}),_0x51fdc2=await _0x339962[_0x329523(0x110)](_0x329523(0xf0)),_0x5ee419=await _0x51fdc2[_0x329523(0x1e6)],_0x3c4014=_0x5ee419[_0x329523(0x1aa)]();this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b['command'],{'success':!![],'message':'Verbindung\x20erfolgreich:\x20'+_0x3c4014[_0x329523(0x182)](0x0,0x14)+_0x329523(0x133)},_0xa6290b[_0x329523(0x1d7)]);}catch(_0x538ba9){this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':![],'message':_0x538ba9[_0x329523(0x1c3)]},_0xa6290b[_0x329523(0x1d7)]);}else{if(_0xa6290b[_0x329523(0x169)]===_0x329523(0x13c))try{const _0x161cab=await this[_0x329523(0xfe)](),_0xc0d753=await this[_0x329523(0x18e)](_0x329523(0x192),'instance',{'startkey':_0x329523(0xde),'endkey':_0x329523(0xe9)}),_0x2c9914=_0xc0d753&&_0xc0d753[_0x329523(0x14b)]?_0xc0d753[_0x329523(0x14b)][_0x329523(0xe1)]:0x0;this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':!![],'weather':'Sonne:\x20'+_0x161cab+_0x329523(0xd9)+(this[_0x329523(0x123)][this[_0x329523(0x138)][_0x329523(0xec)]]||'?')+'¬∞C','calendar':_0x2c9914+_0x329523(0x1e7)},_0xa6290b['callback']);}catch(_0x4e997f){this[_0x329523(0x10e)](_0xa6290b[_0x329523(0x183)],_0xa6290b[_0x329523(0x169)],{'success':![]},_0xa6290b[_0x329523(0x1d7)]);}}}}}}}}}}}}}[a0_0x9b14de(0x1e3)](){const _0x3ebefb=a0_0x9b14de;if(!this['activeModules'][_0x3ebefb(0x150)])return;this['log'][_0x3ebefb(0x1cb)](_0x3ebefb(0x1e2));try{const _0x46aef5=this[_0x3ebefb(0x188)]||[];pythonBridge[_0x3ebefb(0xe3)](this,_0x3ebefb(0x15f),{'events':_0x46aef5});}catch(_0x42f0d0){this[_0x3ebefb(0x1b2)]['warn'](_0x3ebefb(0x198));}}async['onStateChange'](_0x4a955c,_0x695860){const _0x8c6b40=a0_0x9b14de;if(!_0x695860||this[_0x8c6b40(0xa9)])return;if(_0x4a955c[_0x8c6b40(0x1d2)](_0x8c6b40(0x14c))&&_0x4a955c[_0x8c6b40(0x190)](_0x8c6b40(0xd5))&&_0x695860['val'])return;if(this[_0x8c6b40(0x138)]['infrasoundEnabled']&&_0x4a955c===this[_0x8c6b40(0x138)][_0x8c6b40(0x1e0)]&&this[_0x8c6b40(0x1f1)][_0x8c6b40(0x121)]){this['handleInfrasound'](_0x695860[_0x8c6b40(0x1cc)]);return;}if(_0x695860[_0x8c6b40(0xc8)]&&_0x4a955c[_0x8c6b40(0x190)]('pulse'))return;if(_0x4a955c===this['namespace']+'.system.mode'){if(_0x695860[_0x8c6b40(0x1cc)]&&Object[_0x8c6b40(0x146)](setup[_0x8c6b40(0xb5)])['includes'](_0x695860['val'])){this[_0x8c6b40(0xcb)]=_0x695860[_0x8c6b40(0x1cc)];if(_0x695860[_0x8c6b40(0x1cc)]===setup[_0x8c6b40(0xb5)][_0x8c6b40(0xfb)])await recorder[_0x8c6b40(0x170)](this,![]);else await recorder['setPresence'](this,!![]);if(this['isProVersion']){let _0x29f40f=![],_0x48c199=0x0,_0x4e8b64=_0x8c6b40(0x1b0);if(this['currentSystemMode']===_0x8c6b40(0xf5))_0x29f40f=!![],_0x48c199=0x168,_0x4e8b64=_0x8c6b40(0xdd);else this[_0x8c6b40(0xcb)]===_0x8c6b40(0x137)&&(_0x29f40f=!![],_0x48c199=0x5a0,_0x4e8b64=_0x8c6b40(0x19d));pythonBridge[_0x8c6b40(0xe3)](this,_0x8c6b40(0x9d),{'active':_0x29f40f,'duration':_0x48c199,'label':_0x4e8b64}),await this[_0x8c6b40(0xcd)]('analysis.security.learningStatus',{'val':JSON[_0x8c6b40(0x117)]({'active':_0x29f40f,'label':_0x4e8b64,'timestamp':Date[_0x8c6b40(0xd2)]()}),'ack':!![]});}}if(!_0x695860['ack'])this[_0x8c6b40(0x185)](_0x4a955c,{'val':this[_0x8c6b40(0xcb)],'ack':!![]});return;}if(_0x4a955c[_0x8c6b40(0x190)](_0x8c6b40(0x112))&&_0x695860[_0x8c6b40(0xc8)])this[_0x8c6b40(0xc5)](_0x695860[_0x8c6b40(0x1cc)]);if(_0x4a955c['endsWith'](_0x8c6b40(0x1bc))&&_0x695860[_0x8c6b40(0xc8)]&&this[_0x8c6b40(0x1f1)][_0x8c6b40(0x92)])automation['checkCalendarTriggers'](this);if(!_0x695860['ack']){if(_0x4a955c['includes']('analysis.trigger')&&_0x695860[_0x8c6b40(0x1cc)]){this[_0x8c6b40(0x185)](_0x4a955c,{'val':![],'ack':!![]}),aiAgent[_0x8c6b40(0x1cf)](this);return;}if(_0x4a955c[_0x8c6b40(0x1d2)](_0x8c6b40(0x8d))&&_0x695860[_0x8c6b40(0x1cc)]){this['setState'](_0x4a955c,{'val':![],'ack':!![]});if(this[_0x8c6b40(0x9e)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x4a955c[_0x8c6b40(0x1d2)](_0x8c6b40(0xdb))&&_0x695860[_0x8c6b40(0x1cc)]){this[_0x8c6b40(0x185)](_0x4a955c,{'val':![],'ack':!![]}),aiAgent[_0x8c6b40(0xdc)](this);return;}if(_0x4a955c['includes'](_0x8c6b40(0x99))&&_0x695860[_0x8c6b40(0x1cc)]){this[_0x8c6b40(0x185)](_0x4a955c,{'val':![],'ack':!![]}),aiAgent[_0x8c6b40(0x166)](this);return;}if(_0x4a955c[_0x8c6b40(0x1d2)](_0x8c6b40(0xf8))&&_0x695860[_0x8c6b40(0x1cc)]){this[_0x8c6b40(0x185)](_0x4a955c,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x120289=await this[_0x8c6b40(0x16f)](_0x8c6b40(0x164));if(_0x120289&&_0x120289['val']){const _0x2bfe60=JSON[_0x8c6b40(0x11d)](_0x120289['val']);this['setStateAsync'](_0x8c6b40(0xfc),{'val':_0x8c6b40(0xa1),'ack':!![]}),pythonBridge[_0x8c6b40(0xe3)](this,_0x8c6b40(0x156),{'sequences':_0x2bfe60});}}catch(_0x11e39a){}return;}if(_0x4a955c[_0x8c6b40(0x1d2)](_0x8c6b40(0xda))&&_0x695860[_0x8c6b40(0x1cc)]){this[_0x8c6b40(0x185)](_0x4a955c,{'val':![],'ack':!![]});try{aiAgent[_0x8c6b40(0xab)](this,_0x8c6b40(0x1a1)),setTimeout(()=>aiAgent[_0x8c6b40(0xab)](this,_0x8c6b40(0x13a)),0x2ee0);if(this[_0x8c6b40(0x9e)]){this['runPythonHealthCheck']();const _0x57e3d4=await this['getStateAsync'](_0x8c6b40(0xee));if(_0x57e3d4&&_0x57e3d4[_0x8c6b40(0x1cc)])pythonBridge[_0x8c6b40(0xe3)](this,_0x8c6b40(0x181),{'digests':JSON[_0x8c6b40(0x11d)](_0x57e3d4[_0x8c6b40(0x1cc)])});}}catch(_0x25fcab){this[_0x8c6b40(0x1b2)][_0x8c6b40(0x19e)](_0x8c6b40(0xd1)+_0x25fcab[_0x8c6b40(0x1c3)]);}return;}if(_0x4a955c['includes'](_0x8c6b40(0x199))&&_0x695860['val']){this[_0x8c6b40(0x185)](_0x4a955c,{'val':![],'ack':!![]}),await this['triggerEnergyPrediction']();return;}if(_0x4a955c['includes'](_0x8c6b40(0xa5))&&_0x695860[_0x8c6b40(0x1cc)]){this[_0x8c6b40(0x185)](_0x4a955c,{'val':![],'ack':!![]});if(this[_0x8c6b40(0x9e)])try{const _0x51a738=await this[_0x8c6b40(0x16f)](_0x8c6b40(0x145));if(_0x51a738&&_0x51a738[_0x8c6b40(0x1cc)]){const _0x2d4156={};if(this[_0x8c6b40(0x138)][_0x8c6b40(0x15e)])this[_0x8c6b40(0x138)][_0x8c6b40(0x15e)][_0x8c6b40(0xc1)](_0x22d093=>{const _0x544891=_0x8c6b40;if(_0x22d093['id']&&_0x22d093['type'])_0x2d4156[_0x22d093['id']]=_0x22d093[_0x544891(0x1ce)];});pythonBridge[_0x8c6b40(0xe3)](this,_0x8c6b40(0xce),{'events':JSON['parse'](_0x51a738[_0x8c6b40(0x1cc)]),'deviceMap':_0x2d4156});}}catch(_0x5141a9){}return;}if(_0x4a955c[_0x8c6b40(0x1d2)]('analysis.training.triggerTopology')&&_0x695860['val']){this[_0x8c6b40(0x185)](_0x4a955c,{'val':![],'ack':!![]}),topology['updateTopology'](this);if(this[_0x8c6b40(0x9e)])try{const _0x4da048=await this[_0x8c6b40(0x16f)](_0x8c6b40(0x164));if(_0x4da048&&_0x4da048[_0x8c6b40(0x1cc)])pythonBridge[_0x8c6b40(0xe3)](this,_0x8c6b40(0x1c7),{'sequences':JSON[_0x8c6b40(0x11d)](_0x4da048[_0x8c6b40(0x1cc)])});}catch(_0x4721f6){}return;}}const _0x250ad6=(this[_0x8c6b40(0x138)]['devices']||[])[_0x8c6b40(0xbf)](_0x1ce768=>_0x1ce768['id']===_0x4a955c);if(_0x250ad6){const _0x2ad629=await recorder[_0x8c6b40(0x1ee)](this,_0x4a955c,_0x695860,_0x250ad6);_0x2ad629&&this['setState'](_0x8c6b40(0x19b),{'val':Date[_0x8c6b40(0xd2)](),'ack':!![]});_0x2ad629&&_0x2ad629[_0x8c6b40(0x1ce)]===_0x8c6b40(0x189)&&_0x2ad629[_0x8c6b40(0xf7)]&&this[_0x8c6b40(0x9e)]&&deadMan[_0x8c6b40(0xb9)](this,_0x2ad629[_0x8c6b40(0xf7)]);_0x695860[_0x8c6b40(0x1cc)]&&(_0x695860[_0x8c6b40(0x1cc)]===!![]||_0x695860[_0x8c6b40(0x1cc)]===0x1||String(_0x695860[_0x8c6b40(0x1cc)])[_0x8c6b40(0x15d)]()===_0x8c6b40(0x1de))&&(_0x250ad6[_0x8c6b40(0x1ce)]&&(_0x250ad6[_0x8c6b40(0x1ce)]['includes'](_0x8c6b40(0x136))||_0x250ad6[_0x8c6b40(0x1ce)]['includes']('door'))&&this[_0x8c6b40(0x15c)](_0x250ad6));if(_0x250ad6['type']==='temperature'||_0x250ad6[_0x8c6b40(0x1ce)]===_0x8c6b40(0xd0)){if(this[_0x8c6b40(0x1f1)]['energy'])automation['cleanupGhostInterventions'](this);}}}async[a0_0x9b14de(0xc5)](_0x243fac){const _0x1d0e43=a0_0x9b14de;if(!this[_0x1d0e43(0x159)]||Date[_0x1d0e43(0xd2)]()-this['bootTime']>0x493e0)return;try{const _0x4c5c56=JSON[_0x1d0e43(0x11d)](_0x243fac),_0x53ef45=this['memoryCache'][_0x1d0e43(0x13f)];let _0x558856=![];for(const _0x787d71 in _0x53ef45){if(_0x53ef45[_0x787d71][_0x1d0e43(0x1d2)]('AI')&&_0x4c5c56[_0x787d71]&&!_0x4c5c56[_0x787d71][_0x1d0e43(0x1d2)]('AI')){_0x558856=!![];break;}}_0x558856&&(await this[_0x1d0e43(0xcd)](_0x1d0e43(0x1bc),{'val':JSON[_0x1d0e43(0x117)](this[_0x1d0e43(0x159)]['times']),'ack':!![]}),await this[_0x1d0e43(0xcd)](_0x1d0e43(0x112),{'val':JSON[_0x1d0e43(0x117)](this[_0x1d0e43(0x159)]['sources']),'ack':!![]}));}catch(_0x47513d){}}async[a0_0x9b14de(0x1da)](){const _0x408f91=a0_0x9b14de;try{const _0x2802ea=await this[_0x408f91(0x16f)](setup[_0x408f91(0x15b)]);if(_0x2802ea&&_0x2802ea[_0x408f91(0x1cc)])this[_0x408f91(0xcb)]=_0x2802ea[_0x408f91(0x1cc)];}catch(_0x44a7f2){this[_0x408f91(0xcb)]=setup['SYSTEM_MODES'][_0x408f91(0x1a0)];}}async['checkWifiPresence'](){const _0x33b6b3=a0_0x9b14de,_0x4df4e9=this[_0x33b6b3(0x138)][_0x33b6b3(0xd6)]||[];if(_0x4df4e9['length']===0x0)return![];const _0x41cc4d=[],_0x82b7bc=Date['now'](),_0x2026de=0x5*0x3c*0x3e8;for(const _0x23dccf of _0x4df4e9){try{let _0x6e7bc8=![];try{const _0x464b84=await this[_0x33b6b3(0xa3)](_0x23dccf+'.isOnline');if(_0x464b84&&_0x464b84[_0x33b6b3(0x1cc)]===!![])_0x6e7bc8=!![];}catch(_0x480b17){}if(!_0x6e7bc8)try{const _0x525ea3=await this[_0x33b6b3(0xa3)](_0x23dccf+_0x33b6b3(0x104));if(_0x525ea3&&_0x525ea3['ts']){const _0x1c36a5=_0x82b7bc-_0x525ea3['ts'];if(_0x1c36a5<_0x2026de)_0x6e7bc8=!![];}}catch(_0x143d32){}if(!_0x6e7bc8)try{const _0xb01f05=await this[_0x33b6b3(0xa3)](_0x23dccf+_0x33b6b3(0x14d));if(_0xb01f05&&typeof _0xb01f05[_0x33b6b3(0x1cc)]===_0x33b6b3(0x16b)&&_0xb01f05[_0x33b6b3(0x1cc)]>0x0)_0x6e7bc8=!![];}catch(_0x49f6c2){}if(!_0x6e7bc8)try{const _0x11f4b7=await this['getForeignStateAsync'](_0x23dccf);if(_0x11f4b7){const _0x55ebd0=_0x82b7bc-(_0x11f4b7['ts']||0x0);_0x55ebd0<_0x2026de&&(_0x11f4b7[_0x33b6b3(0x1cc)]===!![]||_0x11f4b7['val']===_0x33b6b3(0x8f)||_0x11f4b7[_0x33b6b3(0x1cc)]===0x1)&&(_0x6e7bc8=!![]);}}catch(_0x17ff7e){}if(_0x6e7bc8){const _0x439ede=_0x23dccf[_0x33b6b3(0x1c5)]('.'),_0x105742=_0x439ede[_0x439ede['length']-0x1]||_0x23dccf;_0x41cc4d[_0x33b6b3(0x1d1)](_0x105742);}}catch(_0x1772a0){this['log'][_0x33b6b3(0x19e)]('checkWifiPresence:\x20Error\x20checking\x20'+_0x23dccf+':\x20'+_0x1772a0[_0x33b6b3(0x1c3)]);}}const _0x24b3fa=_0x41cc4d['length']>0x0?_0x41cc4d[_0x33b6b3(0x173)](',\x20'):_0x33b6b3(0xc6);return await this[_0x33b6b3(0xcd)](_0x33b6b3(0x13d),{'val':_0x24b3fa,'ack':!![]}),_0x41cc4d[_0x33b6b3(0xe1)]>0x0;}async['runAutopilot'](){const _0x1fe79a=a0_0x9b14de;await aiAgent[_0x1fe79a(0x1cf)](this);this[_0x1fe79a(0x1f1)]['health']&&(this[_0x1fe79a(0xbd)](),this[_0x1fe79a(0x1f2)]());if(this[_0x1fe79a(0x1f1)]['energy'])this[_0x1fe79a(0x1ed)]();}async['checkSolarCondition'](){const _0xf0424e=a0_0x9b14de,_0x5df356=[_0xf0424e(0xef),'accuweather.0',_0xf0424e(0x1e1)],_0x2e7ba4=['forecast.current.weather','Current.WeatherText','NextHours.Location_1.Day_1.current.symbol_desc'];for(const _0x3fd7fa of _0x5df356){for(const _0x4cf0ce of _0x2e7ba4){try{const _0x30dd52=_0x3fd7fa+'.'+_0x4cf0ce,_0x37045e=await this[_0xf0424e(0xa3)](_0x30dd52);if(_0x37045e&&_0x37045e[_0xf0424e(0x1cc)]){const _0x40a7b2=String(_0x37045e[_0xf0424e(0x1cc)])[_0xf0424e(0x15d)]();if(_0x40a7b2[_0xf0424e(0x1d2)](_0xf0424e(0x17d))||_0x40a7b2[_0xf0424e(0x1d2)](_0xf0424e(0x163))||_0x40a7b2['includes'](_0xf0424e(0x1d0))||_0x40a7b2[_0xf0424e(0x1d2)]('sonn')||_0x40a7b2[_0xf0424e(0x1d2)]('clear'))return this[_0xf0424e(0x1b2)][_0xf0424e(0x1cb)]('‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20'+_0x30dd52),!![];}}catch(_0x11a0d9){}}}return![];}[a0_0x9b14de(0x1f2)](){const _0x49f336=a0_0x9b14de;if(!this[_0x49f336(0x9e)])return;try{this[_0x49f336(0x16f)](_0x49f336(0x164),(_0x2c5ed4,_0x46c309)=>{const _0x209dbc=_0x49f336;if(_0x2c5ed4||!_0x46c309||!_0x46c309[_0x209dbc(0x1cc)])return;try{const _0x26b25d=JSON['parse'](_0x46c309[_0x209dbc(0x1cc)]);if(!_0x26b25d||_0x26b25d[_0x209dbc(0xe1)]===0x0)return;pythonBridge[_0x209dbc(0xe3)](this,_0x209dbc(0x116),{'sequences':_0x26b25d}),this[_0x209dbc(0x1b2)]['debug'](_0x209dbc(0xd3)+_0x26b25d[_0x209dbc(0xe1)]+_0x209dbc(0x12f));}catch(_0xf7f6fa){this[_0x209dbc(0x1b2)][_0x209dbc(0x19e)](_0x209dbc(0xd8)+_0xf7f6fa[_0x209dbc(0x1c3)]);}});}catch(_0x106a3b){this[_0x49f336(0x1b2)]['warn'](_0x49f336(0x9a)+_0x106a3b[_0x49f336(0x1c3)]);}}async[a0_0x9b14de(0x1ed)](){const _0x276b7b=a0_0x9b14de;if(!this['isProVersion']||!this[_0x276b7b(0x1f1)]['energy'])return;try{const _0x5f50c3={},_0x2497ff={},_0x2bee87=this[_0x276b7b(0x138)]['devices']||[];for(const _0xbe5f73 of _0x2bee87){if((_0xbe5f73[_0x276b7b(0x1ce)]===_0x276b7b(0x90)||_0xbe5f73[_0x276b7b(0x1ce)]===_0x276b7b(0xd0))&&_0xbe5f73[_0x276b7b(0xf7)])try{const _0x2a3753=await this[_0x276b7b(0xa3)](_0xbe5f73['id']);_0x2a3753&&typeof _0x2a3753[_0x276b7b(0x1cc)]===_0x276b7b(0x16b)&&(_0x5f50c3[_0xbe5f73[_0x276b7b(0xf7)]]=_0x2a3753[_0x276b7b(0x1cc)],_0x2497ff[_0xbe5f73[_0x276b7b(0xf7)]]=_0xbe5f73[_0x276b7b(0xbe)]||![]);}catch(_0x5b113e){}}let _0x260a26=0xa;if(this[_0x276b7b(0x138)]['weatherTempId'])try{const _0x304e18=await this[_0x276b7b(0xa3)](this['config'][_0x276b7b(0x17c)]);if(_0x304e18&&typeof _0x304e18[_0x276b7b(0x1cc)]===_0x276b7b(0x16b))_0x260a26=_0x304e18['val'];}catch(_0x5a4e51){}const _0x12dee3=await this[_0x276b7b(0xfe)]();let _0x1bfa51={};try{const _0x4e4b18=await this[_0x276b7b(0x16f)](_0x276b7b(0xb1));if(_0x4e4b18&&_0x4e4b18[_0x276b7b(0x1cc)])_0x1bfa51=JSON[_0x276b7b(0x11d)](_0x4e4b18['val']);}catch(_0x434632){}pythonBridge[_0x276b7b(0xe3)](this,_0x276b7b(0xc9),{'current_temps':_0x5f50c3,'t_out':_0x260a26,'is_sunny':_0x12dee3,'solar_flags':_0x2497ff,'warmup_targets':_0x1bfa51}),this[_0x276b7b(0x1b2)][_0x276b7b(0x1c8)](_0x276b7b(0xaf)+Object[_0x276b7b(0xa0)](_0x5f50c3)[_0x276b7b(0xe1)]+_0x276b7b(0x179));}catch(_0x1da707){this[_0x276b7b(0x1b2)][_0x276b7b(0x19e)]('triggerEnergyPrediction\x20Error:\x20'+_0x1da707['message']);}}[a0_0x9b14de(0xbd)](){const _0x1d7029=a0_0x9b14de;if(!this[_0x1d7029(0x188)]||this['rawEventLog'][_0x1d7029(0xe1)]===0x0)return;const _0x2465f6=new Array(0x30)[_0x1d7029(0x132)](0x0),_0x40bed5=Array[_0x1d7029(0x183)]({'length':0x30},()=>[]),_0x3e081f=new Date()[_0x1d7029(0x1ef)](0x0,0x0,0x0,0x0);this[_0x1d7029(0x188)][_0x1d7029(0xc1)](_0x42b9d9=>{const _0x1fad12=_0x1d7029,_0x2b504d=new Date(_0x42b9d9[_0x1fad12(0x8e)]);if(_0x2b504d[_0x1fad12(0x1e5)]()>=_0x3e081f){const _0x1ecc92=_0x2b504d[_0x1fad12(0xf4)](),_0x10ef4f=_0x2b504d[_0x1fad12(0x111)](),_0x18eb66=_0x1ecc92*0x2+Math[_0x1fad12(0xc4)](_0x10ef4f/0x1e);_0x18eb66>=0x0&&_0x18eb66<0x30&&(_0x2465f6[_0x18eb66]++,_0x40bed5[_0x18eb66]['push']({'time':_0x2b504d['toLocaleTimeString'](_0x1fad12(0xed),{'hour':'2-digit','minute':'2-digit'}),'location':_0x42b9d9[_0x1fad12(0xf7)]||_0x1fad12(0xad),'type':_0x42b9d9[_0x1fad12(0x1ce)]||'Event'}));}}),this['setStateAsync'](_0x1d7029(0xfa),{'val':JSON['stringify'](_0x2465f6),'ack':!![]}),this[_0x1d7029(0xcd)](_0x1d7029(0x16e),{'val':JSON[_0x1d7029(0x117)](_0x40bed5),'ack':!![]});}async[a0_0x9b14de(0xe2)](_0x1bfafa){const _0xb3d07a=a0_0x9b14de;if(!this[_0xb3d07a(0x138)][_0xb3d07a(0x149)]||typeof _0x1bfafa!==_0xb3d07a(0x16b))return;const _0x5aaad8=this[_0xb3d07a(0x138)][_0xb3d07a(0x96)]||0.04;this['pressureBuffer'][_0xb3d07a(0x1d1)]({'timestamp':Date[_0xb3d07a(0xd2)](),'value':_0x1bfafa}),this[_0xb3d07a(0xb6)]['length']>0x64&&this[_0xb3d07a(0xb6)][_0xb3d07a(0x1be)](),_0x1bfafa>_0x5aaad8&&!this[_0xb3d07a(0x1c6)]&&(this[_0xb3d07a(0x1c6)]=!![],this[_0xb3d07a(0x1b2)][_0xb3d07a(0x19e)](_0xb3d07a(0x10d)+_0x1bfafa[_0xb3d07a(0x17b)](0x4)+'\x20>\x20'+_0x5aaad8+_0xb3d07a(0x1bf)),await this['triggerInfrasoundCorrelation'](_0x1bfafa,'threshold_exceeded'),setTimeout(()=>{const _0x164474=_0xb3d07a;this[_0x164474(0x1c6)]=![];},0x5*0x3c*0x3e8));}async['triggerInfrasoundCorrelation'](_0x23c291,_0xfd1bd2){const _0x12df94=a0_0x9b14de;if(!this[_0x12df94(0x18d)]){const _0x373320=this[_0x12df94(0x105)][_0x12df94(0x98)](0x0,0xa),_0x2ef87a=_0x373320['map'](_0x4d2c2a=>new Date(_0x4d2c2a['timestamp'])['toLocaleTimeString'](_0x12df94(0xed))+'\x20-\x20'+(_0x4d2c2a[_0x12df94(0xf7)]||_0x12df94(0x13e))+':\x20'+_0x4d2c2a[_0x12df94(0x100)])['join']('\x0a');this[_0x12df94(0x1b2)][_0x12df94(0x19e)](_0x12df94(0x1d4)+_0x23c291[_0x12df94(0x17b)](0x4)+_0x12df94(0xcf)+_0x2ef87a);if(this[_0x12df94(0x138)][_0x12df94(0x157)])try{const _0x1f03e8=await this[_0x12df94(0xa3)](this['config'][_0x12df94(0x157)]);_0x1f03e8&&_0x1f03e8['val']===!![]&&(await this[_0x12df94(0xcd)]('analysis.safety.infrasoundAlert',{'val':JSON['stringify']({'timestamp':Date['now'](),'pressure':_0x23c291[_0x12df94(0x17b)](0x4),'eventType':_0xfd1bd2,'recentEvents':_0x373320[_0x12df94(0x98)](0x0,0x3)}),'ack':!![]}),this[_0x12df94(0x1b2)]['error']('üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!'));}catch(_0x111bbb){}}else this[_0x12df94(0x1b2)][_0x12df94(0x1cb)](_0x12df94(0x177)+_0x23c291[_0x12df94(0x17b)](0x4)+_0x12df94(0xa8));}async[a0_0x9b14de(0x15c)](_0x3ce33b){const _0x459d19=a0_0x9b14de;if(!_0x3ce33b||!_0x3ce33b['location'])return;try{const _0x471f22=(this[_0x459d19(0x138)]['devices']||[])[_0x459d19(0x128)](_0x35006b=>_0x35006b[_0x459d19(0xf7)]===_0x3ce33b[_0x459d19(0xf7)]&&(_0x35006b[_0x459d19(0x1ce)]===_0x459d19(0x90)||_0x35006b['type']===_0x459d19(0xd0)));if(_0x471f22['length']===0x0)return;const _0x58e68d=await this[_0x459d19(0xa3)](_0x471f22[0x0]['id']);if(!_0x58e68d||typeof _0x58e68d[_0x459d19(0x1cc)]!==_0x459d19(0x16b))return;const _0x506d3c=_0x58e68d[_0x459d19(0x1cc)];let _0x5c3680=null;if(this[_0x459d19(0x138)]['weatherTempId']){const _0x14ccc8=await this[_0x459d19(0xa3)](this['config']['weatherTempId']);_0x14ccc8&&typeof _0x14ccc8[_0x459d19(0x1cc)]===_0x459d19(0x16b)&&(_0x5c3680=_0x14ccc8[_0x459d19(0x1cc)]);}if(_0x5c3680!==null){const _0x5d6b3d=Math[_0x459d19(0x141)](_0x506d3c-_0x5c3680);_0x5d6b3d>0x3&&(this['log'][_0x459d19(0x1cb)](_0x459d19(0x180)+_0x3ce33b[_0x459d19(0xf7)]+':\x20Temp-Differenz\x20'+_0x5d6b3d[_0x459d19(0x17b)](0x1)+_0x459d19(0x1b9)+_0x506d3c+_0x459d19(0x12c)+_0x5c3680+_0x459d19(0x10c)),await this[_0x459d19(0xcd)]('analysis.ventilation.lastWindow',{'val':JSON['stringify']({'room':_0x3ce33b[_0x459d19(0xf7)],'timestamp':Date[_0x459d19(0xd2)](),'tempDiff':_0x5d6b3d[_0x459d19(0x17b)](0x1),'recommendation':_0x5d6b3d>0x5?'Gute\x20L√ºftungsm√∂glichkeit!':_0x459d19(0x93)}),'ack':!![]}));}}catch(_0x5272b1){this[_0x459d19(0x1b2)]['warn']('analyzeWindowOpening\x20error:\x20'+_0x5272b1['message']);}}async['appendToLog'](_0x414d73){const _0x5d4327=a0_0x9b14de;if(!_0x414d73||typeof _0x414d73!=='object')return;const _0x148051={'timestamp':_0x414d73[_0x5d4327(0x8e)]||Date[_0x5d4327(0xd2)](),'id':_0x414d73['id']||Date[_0x5d4327(0xd2)]()[_0x5d4327(0x1b8)](),'name':_0x414d73[_0x5d4327(0x100)]||_0x5d4327(0x1b1),'type':_0x414d73[_0x5d4327(0x1ce)]||_0x5d4327(0x1c2),'location':_0x414d73[_0x5d4327(0xf7)]||_0x5d4327(0x13e),'value':_0x414d73['value']||null};this['eventHistory'][_0x5d4327(0x119)](_0x148051);if(this['eventHistory'][_0x5d4327(0xe1)]>0x1388)this[_0x5d4327(0x105)][_0x5d4327(0x16c)]();await this['setStateAsync'](_0x5d4327(0x127),{'val':JSON[_0x5d4327(0x117)](this[_0x5d4327(0x105)]),'ack':!![]}),this[_0x5d4327(0x1b2)]['debug'](_0x5d4327(0xca)+_0x148051[_0x5d4327(0x100)]+'\x20('+_0x148051[_0x5d4327(0xf7)]+')');}[a0_0x9b14de(0x1a7)](_0x5e86e9){}}if(require[a0_0x9b14de(0x106)]!==module)module[a0_0x9b14de(0x1d8)]=_0x33601b=>new CogniLiving(_0x33601b);else new CogniLiving();