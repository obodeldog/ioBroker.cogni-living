const a0_0x560c35=a0_0x2ef2;function a0_0x2ef2(_0x1a401c,_0x3ed58d){const _0x48f243=a0_0x45c0();return a0_0x2ef2=function(_0xc724f7,_0x2a3d74){_0xc724f7=_0xc724f7-0xfb;let _0x45c0a7=_0x48f243[_0xc724f7];return _0x45c0a7;},a0_0x2ef2(_0x1a401c,_0x3ed58d);}(function(_0x50dee,_0x25610d){const _0x199c6e=a0_0x2ef2,_0x9c29=_0x50dee();while(!![]){try{const _0x2d81e5=-parseInt(_0x199c6e(0x24c))/0x1+-parseInt(_0x199c6e(0x1a3))/0x2*(-parseInt(_0x199c6e(0x203))/0x3)+parseInt(_0x199c6e(0x251))/0x4*(-parseInt(_0x199c6e(0x129))/0x5)+parseInt(_0x199c6e(0x10b))/0x6+-parseInt(_0x199c6e(0x297))/0x7*(parseInt(_0x199c6e(0x177))/0x8)+parseInt(_0x199c6e(0x215))/0x9*(-parseInt(_0x199c6e(0x1aa))/0xa)+parseInt(_0x199c6e(0x140))/0xb;if(_0x2d81e5===_0x25610d)break;else _0x9c29['push'](_0x9c29['shift']());}catch(_0x52e014){_0x9c29['push'](_0x9c29['shift']());}}}(a0_0x45c0,0xb767e));function a0_0x45c0(){const _0x165d94=['detected','setState','577535unuJEJ','Deaktiviert\x20(Pro-Feature)','unshift','search','ack','3880ZWfIhZ','modeResetJob','Unknown','startsWith','python.exe','Digest','updateBaselineStatus','LTM.rawEventLog','KALENDER:\x20','energy','error','trim','eventHistory','/100.\x20OUTPUT:\x20Text.','dailyDigests','stdout','sendToPython','üß™\x20Simulating\x20Butler\x20Proposal:\x20','message','Generating\x20Morning\x20Briefing...','setStateAsync','unknown','toLocaleTimeString','analysis.training.status','notifyEmailInstance','activityLevel','split','getHours','pip.exe','feedbackHistory','rawEventLog','outdoorSensorId','LTM.trainingData.thermodynamics','unload','.venv','setupDriftAnalysisScheduler','getOutsideTemperatureNumeric','write','stateChange','length','driftAnalysisTimer','livingContext','sleepScore','Success','saveRawEventLog','notifyEmailEnabled','üõ†Ô∏è\x20MAINTENANCE\x20MODE:\x20Installing\x20Python\x20dependencies.\x20Do\x20not\x20restart!','system.mode','weather','enum','isPresent','analysis.training.triggerSecurity','splice','‚úÖ\x20HEALTH\x20TRAINED:\x20','value','admin.','\x20=\x20','heating','presenceDevices','config','exitTimer','switch','saveCompletedSequence','onUnload','now','aiPersona','command','testApiKey','recordSequence','contact','29372FmsneW','schalter','isGracePeriodActive','pythonProcess','[LOG]','getForeignObjectAsync','runAutopilot','shutter','LTM.dailyDigests','loadDailyDigests','getSystemUUID','getWeatherContext','stderr','analysis.energy.heatingScore','analysis.trigger','analysis.automation.autoApply','getGenerativeModel','‚ö†Ô∏è\x20Python\x20missing\x20libs.\x20Auto-Install\x20triggered.','targetValue','includes','onReady','.Current.Temperature','expire','version','health','COGNI_REQUEST_CALL','temperatur','service.py','send','summary','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','apiKey','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','runSecurityCheck','system.config','win32','initZombies','stopPythonService','üö®\x20EMERGENCY','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','setHours','licenseKey','window','callback','info','[RECORDER]\x20Error\x20saving\x20sequence:\x20','Keine\x20Details.','toISOString','Fokus\x20auf\x20Komfort.','KI-Modell\x20nicht\x20initialisiert','geminiModel','status','sendToAsync','TRAIN_SECURITY','getOverviewData','‚ùå\x20PIP\x20INSTALL\x20FAILED:\x20','bin','runGeminiAnalysis','loadSystemMode','reachable','Subscribing\x20to\x20','weatherunderground','debug','payload','subscribeForeignStatesAsync','processSensorEvent','ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x20PERSONA:\x20','child_process','[PYTHON]\x20Exited\x20code\x20','7580670HvEBZT','setupModeResetScheduler','useWeather','\x20->\x20','system.presenceWho','briefingJob','[PYTHON\x20ERR]\x20','.data.table','Scanning\x20for\x20devices...','connection','ANALYZE_SEQUENCE','forEach','LTM.driftAnalysis.driftDetails','.\x20WETTER:\x20','LTM.driftAnalysis.lastCheck','timestamp','scanDevices','üêç\x20Python\x20Pong','getForeignStateAsync','alertReason','ANALYZE_HEALTH','üêç\x20Using\x20VENV\x20Python:\x20','[RESULT]','rssi','models/gemini-flash-latest','currentSystemMode','door','cpu_feature_guard','type','recordThermodynamics','2525lDzhNG','analysis.training.triggerHealth','position','path','sensorLastValues','getObjectAsync','analysis.automation.targetValue','sound','analysis.automation.description','handleTelegramResponse','map','selectedFunctionIds','doors','@iobroker/adapter-core','initSensorSubscriptions','createDailyDigest','Scripts','push','dutycycle','setupLtmScheduler','lastAlertState','Kein\x20API\x20Key\x20eingegeben.','replace','10876074XXNmdp','abortExitTimer','User\x20dismissed\x20automation\x20proposal.','pr√§senz','ROLLE:\x20Assistent.\x20AUFGABE:\x20Schreibe\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','startPythonService','isExit','analysis.activitySummary','.forecast.current.temp','heizung','enum.rooms.*','python3\x20-m\x20venv\x20\x22','Vom\x20Benutzer\x20best√§tigt\x20(OK).','installPythonDependencies','members','0\x203\x20*\x20*\x20*','calendarInstance','javascript.','motion','[PYTHON]\x20','\x22\x20install\x20-r\x20\x22','analysis.alertReason','analysis.training.triggerEnergy','setupTelegramListener','No\x20module\x20named','exports','geminiApiKey','Gemini\x20AI\x20initialized.','submitFeedback','Gemini\x20Init\x20Error:\x20','BUTLER\x20Execution\x20Error:\x20','latitude','analysisTimer','\x20sequences...','\x20(Length:\x20','common','accuweather','analysis.security.lastCheck','info.','brightness','Missing\x20data','normal','warn','existsSync','power','.\x20EVENTS:\x20','executeAutomationAction','cogni-living','Fokus\x20auf\x20Familienroutinen.','openweathermap','initHistory','daswetter','getEnums','N/A\x20(Learning)','getMonth','2088WJNgdD','notifyTelegramEnabled','COGNI_CONFIRM_OK','scriptProblem','Started...','Kalender:\x20Deaktiviert','Aktiv\x20(','NORMAL','namespace','üêç\x20Stopping\x20Python...','enum.functions.*','toLowerCase','subscribeStates','scriptEnabled','stdin','apply','generateContent','presence','vacation','testContext','‚ö†Ô∏è\x20ALARM:\x20','event','sendTo','Bibliotheken\x20nicht\x20gefunden','slice',')\x20-\x20FULL\x20CLASS\x20MODE','stick_unreach','getCalendarNames','cogni-living\x20adapter\x20starting\x20(v','runPythonHealthCheck','response','analysis.automation.patternDetected','dependencyInstallInProgress','system.isPresent','TRAIN_ENERGY','licht','occupancy','onStateChange','getLtmData','\x20presence\x20devices...','triggerBriefing','isArray','analysis.automation.targetId','light','674NfUANd','analysis.automation.triggerAction','initPresenceSubscriptions','.communicate.request','getForeignObjectsAsync','shift','from','690YoNoeL','üåÖ\x20Daily\x20Briefing:\x0a','LTM.trainingData.sequences','ical.0','automation.triggerAction','role','instance','startExitTimer','analysis.history_debug_00','events.lastEvent','‚úÖ\x20INSTALLATION\x20COMPLETE.\x20Starting\x20Service...','.\x20DATEN:\x20Schlaf\x20','targetId','ltmJob','set_temperature','ltmStbWindowDays','analysis.health.isAnomaly','PRIORIT√ÑT:\x20Gesundheit/AAL.','onMessage','data','N/A','Error\x20launching\x20Python:\x20','city','handlePythonResult','Analysiere\x20ausgewogen.','notifyEmailRecipient','logDuplicates','getCalendarContext','@google/generative-ai','notifyTelegramInstance','val','notifyPushoverInstance','sendMorningBriefing','.\x20SYSTEM_MODE:\x20','indexOf','Verbindung\x20erfolgreich!\x20Antwort:\x20','analysis.energy.insulationScore','inactivityThresholdHours','cancel','HEALTH_TRAIN_RESULT','name','getDate','link_quality','weatherInstance','No\x20instance','lights','SECURITY_RESULT','humidity','sequenceTimer','analysis.lastResult','.\x20ZUSATZ:\x20','off','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','Invalid\x20JSON:\x20','sendNotification','setpoint','Kein\x20API\x20Key!','LTM.processingStatus','kill','toFixed','\x0aSTB:\x20','analysis.isAlert','getTime','parse','Briefing\x20Error:\x20','minDaysForBaseline','‚úÖ\x20Alles\x20OK\x20(Reset)]','‚ö†Ô∏è\x20Broken\x20venv\x20detected.\x20Repairing...','saveFeedback','close','dismissAutomation','generic','config_pending','some','createAllObjects','vis.','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','setForeignStateAsync','temperature','TRAINING_COMPLETE','substring','toString','updateAnalysisHistory','communicate.request','object','Alarm','analysis.security.lastScore','checkWifiPresence','ready','9618gefrNi','lampe','automationProposal','ANOMALY','bewegung','scanForDevices','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','\x20sensors...','Failed:\x20','getStateAsync','isProVersion','‚ö†Ô∏è\x20VENV\x20missing.\x20Attempting\x20install...','pop','constructor','icons-mfd.','Success:\x20','filter','node-schedule','54630BQwOwC','genAI','bind','direction','activeSequence','join','fenster','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','log','üß†\x20Triggering\x20Security\x20Training\x20with\x20','PARTY','notifyPushoverRecipient','isEmergency','sort','exitGraceTimer','Fehler:\x20','flot.','stringify','.\x20ANWESEND:\x20','main','runBaselineDriftAnalysis','pip','Error\x20checking\x20WiFi:\x20','location','initSystemConfig','setPresence','application/json','analysisInterval','Adapter','üìû\x20R√ºckruf\x20anfordern','text','python_service','ltmLtbWindowDays','Training\x20Error:\x20','round','devices','online','setupBriefingScheduler','‚ùå\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv','HEALTH_RESULT','Keine\x20Termine','actual_temperature','uuid','description','installRequirementsInVenv','systemConfig','checkLicense','values','klima','analysisHistory','LTM.driftAnalysis.baselineDrift','cover','system.'];a0_0x45c0=function(){return _0x165d94;};return a0_0x45c0();}const a0_0x2a3d74=(function(){let _0x5080a7=!![];return function(_0x39998a,_0x240f9a){const _0x462644=_0x5080a7?function(){const _0x3eec53=a0_0x2ef2;if(_0x240f9a){const _0x5db796=_0x240f9a[_0x3eec53(0x186)](_0x39998a,arguments);return _0x240f9a=null,_0x5db796;}}:function(){};return _0x5080a7=![],_0x462644;};}()),a0_0xc724f7=a0_0x2a3d74(this,function(){const _0x3796a5=a0_0x2ef2;return a0_0xc724f7[_0x3796a5(0x1fb)]()[_0x3796a5(0x24f)]('(((.+)+)+)+$')[_0x3796a5(0x1fb)]()[_0x3796a5(0x210)](a0_0xc724f7)['search']('(((.+)+)+)+$');});a0_0xc724f7();'use strict';const utils=require(a0_0x560c35(0x136)),{GoogleGenerativeAI}=require(a0_0x560c35(0x1c6)),schedule=require(a0_0x560c35(0x214)),{spawn,exec}=require(a0_0x560c35(0x109)),path=require(a0_0x560c35(0x12c)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x560c35(0x123),LTM_SCHEDULE=a0_0x560c35(0x14f),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x560c35(0x258),LTM_DP_DAILY_DIGESTS=a0_0x560c35(0x29f),LTM_DP_STATUS=a0_0x560c35(0x1e3),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x560c35(0x247),LTM_DP_DRIFT_DETAILS=a0_0x560c35(0x117),LTM_DP_DRIFT_LAST_CHECK=a0_0x560c35(0x119),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x560c35(0x169),'VACATION':a0_0x560c35(0x189),'PARTY':'party','GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x560c35(0x21f)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x560c35(0x1c2),'senior_aal':a0_0x560c35(0x1bb),'family':a0_0x560c35(0x170),'single_comfort':a0_0x560c35(0x2c7),'security':'PRIORIT√ÑT:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},HARD_IGNORE_TERMS=[a0_0x560c35(0x17a),a0_0x560c35(0x184),'update','unreach','lowbat',a0_0x560c35(0x122),a0_0x560c35(0x114),'maintenance','error','fault','working',a0_0x560c35(0x218),a0_0x560c35(0x191),a0_0x560c35(0x1f2),a0_0x560c35(0x13b),'firmware',a0_0x560c35(0x101),a0_0x560c35(0x1d4)],BAD_NAMES=['targetposition','currentposition','state','level','value',a0_0x560c35(0x167),'on',a0_0x560c35(0x1dd),a0_0x560c35(0x28e),a0_0x560c35(0x12b),a0_0x560c35(0x29e),'blind',a0_0x560c35(0x248),a0_0x560c35(0x2ca),'motion',a0_0x560c35(0x188),a0_0x560c35(0x19b),a0_0x560c35(0x1f8),a0_0x560c35(0x1d9),a0_0x560c35(0x16c),a0_0x560c35(0x25a),a0_0x560c35(0x1e1),'valve',a0_0x560c35(0x23e),a0_0x560c35(0x1b8)],ADAPTER_BLACKLIST=[a0_0x560c35(0x249),a0_0x560c35(0x288),a0_0x560c35(0x166),a0_0x560c35(0x1f5),'history.','material.',a0_0x560c35(0x211),a0_0x560c35(0x225),'echarts.',a0_0x560c35(0x151),'simple-api.'],IS_WIN=process['platform']===a0_0x560c35(0x2ba),VENV_PATH=path[a0_0x560c35(0x21a)](__dirname,a0_0x560c35(0x273)),PYTHON_EXE=IS_WIN?path[a0_0x560c35(0x21a)](VENV_PATH,a0_0x560c35(0x139),a0_0x560c35(0x255)):path[a0_0x560c35(0x21a)](VENV_PATH,'bin','python'),PIP_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x560c35(0x139),a0_0x560c35(0x26d)):path[a0_0x560c35(0x21a)](VENV_PATH,a0_0x560c35(0xfe),a0_0x560c35(0x22a));class CogniLiving extends utils[a0_0x560c35(0x231)]{constructor(_0xbc5516){const _0x5c4bdc=a0_0x560c35;super({..._0xbc5516,'name':_0x5c4bdc(0x16f)}),this[_0x5c4bdc(0x25d)]=[],this[_0x5c4bdc(0x246)]=[],this[_0x5c4bdc(0x26e)]=[],this[_0x5c4bdc(0x26f)]=[],this[_0x5c4bdc(0x25f)]=[],this[_0x5c4bdc(0x12d)]={},this[_0x5c4bdc(0x242)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x5c4bdc(0x299)]=![],this[_0x5c4bdc(0x216)]=null,this[_0x5c4bdc(0x2c9)]=null,this[_0x5c4bdc(0x124)]=SYSTEM_MODES[_0x5c4bdc(0x17e)],this['isProVersion']=![],this[_0x5c4bdc(0x13d)]=![],this['systemUUID']=_0x5c4bdc(0x266),this['analysisTimer']=null,this[_0x5c4bdc(0x1b7)]=null,this['modeResetJob']=null,this[_0x5c4bdc(0x279)]=null,this[_0x5c4bdc(0x110)]=null,this[_0x5c4bdc(0x29a)]=null,this[_0x5c4bdc(0x197)]=![],this['activeSequence']=[],this['sequenceTimer']=null,this['on'](_0x5c4bdc(0x202),this[_0x5c4bdc(0x2ab)][_0x5c4bdc(0x217)](this)),this['on'](_0x5c4bdc(0x277),this[_0x5c4bdc(0x19c)][_0x5c4bdc(0x217)](this)),this['on'](_0x5c4bdc(0x272),this[_0x5c4bdc(0x290)][_0x5c4bdc(0x217)](this)),this['on'](_0x5c4bdc(0x263),this[_0x5c4bdc(0x1bc)][_0x5c4bdc(0x217)](this));}async[a0_0x560c35(0x2ab)](){const _0x1b509f=a0_0x560c35;this[_0x1b509f(0x21d)][_0x1b509f(0x2c3)](_0x1b509f(0x193)+this[_0x1b509f(0x2ae)]+_0x1b509f(0x190)),await this['initZombies'](),this[_0x1b509f(0x28c)][_0x1b509f(0x2c0)]=this['config'][_0x1b509f(0x2c0)]||'';try{this[_0x1b509f(0x20d)]=await this[_0x1b509f(0x243)](this[_0x1b509f(0x28c)]['licenseKey']);}catch(_0x58f7e8){}if(!this[_0x1b509f(0x28c)]['inactivityThresholdHours']||this[_0x1b509f(0x28c)][_0x1b509f(0x1cf)]<0.1)this[_0x1b509f(0x28c)][_0x1b509f(0x1cf)]=0xc;await this[_0x1b509f(0x172)](),await this[_0x1b509f(0x22d)]();if(this[_0x1b509f(0x28c)][_0x1b509f(0x15a)])try{this[_0x1b509f(0x216)]=new GoogleGenerativeAI(this[_0x1b509f(0x28c)][_0x1b509f(0x15a)]),this[_0x1b509f(0x2c9)]=this['genAI'][_0x1b509f(0x2a7)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x1b509f(0x22f)}}),this['log']['info'](_0x1b509f(0x15b));}catch(_0x19dea9){this[_0x1b509f(0x21d)][_0x1b509f(0x25b)](_0x1b509f(0x15d)+_0x19dea9[_0x1b509f(0x263)]);}await this[_0x1b509f(0x1f4)](),await this[_0x1b509f(0x100)](),await this['loadRawEventLog'](),await this['loadDailyDigests'](),this['subscribeStates'](_0x1b509f(0x2a5)),this[_0x1b509f(0x183)](LTM_DP_TRIGGER_DIGEST),this[_0x1b509f(0x183)](_0x1b509f(0x280)),this[_0x1b509f(0x183)]('analysis.triggerBriefing'),this[_0x1b509f(0x183)](_0x1b509f(0x1a4)),this[_0x1b509f(0x183)](_0x1b509f(0x2a6)),this[_0x1b509f(0x183)](_0x1b509f(0x284)),this['subscribeStates'](_0x1b509f(0x12a)),this['subscribeStates'](_0x1b509f(0x156)),await this[_0x1b509f(0x137)](),await this[_0x1b509f(0x1a5)](),await this[_0x1b509f(0x157)](),setTimeout(()=>this[_0x1b509f(0x201)](),0x1388);if(this[_0x1b509f(0x160)])clearInterval(this[_0x1b509f(0x160)]);const _0x5a74e0=this[_0x1b509f(0x28c)][_0x1b509f(0x230)]||0xf;_0x5a74e0>0x0&&(this['analysisTimer']=setInterval(()=>{const _0x4f2c9f=_0x1b509f;this[_0x4f2c9f(0x29d)]();},_0x5a74e0*0x3c*0x3e8)),this[_0x1b509f(0x13c)](),this[_0x1b509f(0x10c)](),this[_0x1b509f(0x274)](),this[_0x1b509f(0x23a)](),this[_0x1b509f(0x145)](),setTimeout(()=>{const _0x2e0eaa=_0x1b509f;if(this[_0x2e0eaa(0x29a)])this[_0x2e0eaa(0x194)]();},0x1388);}[a0_0x560c35(0x290)](_0x34d762){const _0x793b4e=a0_0x560c35;if(this['analysisTimer'])clearInterval(this[_0x793b4e(0x160)]);if(this[_0x793b4e(0x279)])clearInterval(this['driftAnalysisTimer']);if(this[_0x793b4e(0x1b7)])this['ltmJob'][_0x793b4e(0x1d0)]();if(this[_0x793b4e(0x252)])this[_0x793b4e(0x252)][_0x793b4e(0x1d0)]();if(this[_0x793b4e(0x110)])this['briefingJob']['cancel']();if(this['exitTimer'])clearTimeout(this['exitTimer']);if(this['exitGraceTimer'])clearTimeout(this['exitGraceTimer']);this[_0x793b4e(0x2bc)](),_0x34d762();}async[a0_0x560c35(0x19c)](_0x333758,_0x311d88){const _0x1bcfab=a0_0x560c35;if(!_0x311d88)return;if(this[_0x1bcfab(0x197)])return;if(_0x333758[_0x1bcfab(0x2aa)]('telegram')&&_0x333758['endsWith'](_0x1bcfab(0x1fd))&&_0x311d88[_0x1bcfab(0x1c8)]){await this['handleTelegramResponse'](_0x311d88[_0x1bcfab(0x1c8)]);return;}if(_0x333758===this[_0x1bcfab(0x17f)]+'.'+SYSTEM_DP_MODE){_0x311d88[_0x1bcfab(0x1c8)]&&Object[_0x1bcfab(0x244)](SYSTEM_MODES)[_0x1bcfab(0x2aa)](_0x311d88[_0x1bcfab(0x1c8)])&&(this[_0x1bcfab(0x124)]=_0x311d88[_0x1bcfab(0x1c8)],_0x311d88[_0x1bcfab(0x1c8)]===SYSTEM_MODES['VACATION']?await this[_0x1bcfab(0x22e)](![]):await this[_0x1bcfab(0x22e)](!![]));if(!_0x311d88['ack'])this['setState'](_0x333758,{'val':this[_0x1bcfab(0x124)],'ack':!![]});return;}if(!_0x311d88[_0x1bcfab(0x250)]){_0x333758['includes'](_0x1bcfab(0x2a5))&&_0x311d88[_0x1bcfab(0x1c8)]&&(this[_0x1bcfab(0x24b)](_0x333758,{'val':![],'ack':!![]}),this[_0x1bcfab(0xff)]());if(_0x333758[_0x1bcfab(0x2aa)]('triggerDailyDigest')&&_0x311d88[_0x1bcfab(0x1c8)]){this[_0x1bcfab(0x24b)](_0x333758,{'val':![],'ack':!![]});if(this['isProVersion'])this[_0x1bcfab(0x138)]();}_0x333758[_0x1bcfab(0x2aa)](_0x1bcfab(0x19f))&&_0x311d88[_0x1bcfab(0x1c8)]&&(this['setState'](_0x333758,{'val':![],'ack':!![]}),this['sendMorningBriefing']());_0x333758[_0x1bcfab(0x2aa)](_0x1bcfab(0x1ae))&&_0x311d88[_0x1bcfab(0x1c8)]&&(this['setState'](_0x333758,{'val':![],'ack':!![]}),this[_0x1bcfab(0x16e)]());if(_0x333758[_0x1bcfab(0x2aa)](_0x1bcfab(0x284))&&_0x311d88[_0x1bcfab(0x1c8)]){this['setState'](_0x333758,{'val':![],'ack':!![]});if(!this[_0x1bcfab(0x20d)])return;try{const _0xef851e=await this[_0x1bcfab(0x20c)](_0x1bcfab(0x1ac));if(_0xef851e&&_0xef851e[_0x1bcfab(0x1c8)]){const _0x516970=JSON[_0x1bcfab(0x1e9)](_0xef851e[_0x1bcfab(0x1c8)]);this[_0x1bcfab(0x21d)][_0x1bcfab(0x2c3)](_0x1bcfab(0x21e)+_0x516970[_0x1bcfab(0x278)]+_0x1bcfab(0x161)),this['setStateAsync'](_0x1bcfab(0x268),{'val':'Sec-Training\x20started...','ack':!![]}),this[_0x1bcfab(0x261)](_0x1bcfab(0xfb),{'sequences':_0x516970});}}catch(_0x3f0c6f){this[_0x1bcfab(0x21d)][_0x1bcfab(0x25b)](_0x1bcfab(0x236)+_0x3f0c6f[_0x1bcfab(0x263)]);}}if(_0x333758['includes'](_0x1bcfab(0x12a))&&_0x311d88['val']){this[_0x1bcfab(0x24b)](_0x333758,{'val':![],'ack':!![]});if(!this['isProVersion'])return;try{const _0x5b847e=await this[_0x1bcfab(0x20c)](LTM_DP_DAILY_DIGESTS);_0x5b847e&&_0x5b847e[_0x1bcfab(0x1c8)]&&this[_0x1bcfab(0x261)]('TRAIN_HEALTH',{'digests':JSON[_0x1bcfab(0x1e9)](_0x5b847e['val'])});}catch(_0x59341c){}}if(_0x333758['includes'](_0x1bcfab(0x156))&&_0x311d88['val']){this[_0x1bcfab(0x24b)](_0x333758,{'val':![],'ack':!![]});if(!this[_0x1bcfab(0x20d)])return;try{const _0x18af23=await this[_0x1bcfab(0x20c)]('LTM.trainingData.thermodynamics');_0x18af23&&_0x18af23[_0x1bcfab(0x1c8)]&&this[_0x1bcfab(0x261)](_0x1bcfab(0x199),{'points':JSON[_0x1bcfab(0x1e9)](_0x18af23['val'])});}catch(_0x15199d){}}return;}if(this[_0x1bcfab(0x28c)][_0x1bcfab(0x28b)]&&this['config'][_0x1bcfab(0x28b)][_0x1bcfab(0x2aa)](_0x333758)){await this[_0x1bcfab(0x201)]();return;}const _0x21b061=(this[_0x1bcfab(0x28c)][_0x1bcfab(0x238)]||[])['find'](_0x119ec3=>_0x119ec3['id']===_0x333758);if(_0x21b061)this[_0x1bcfab(0x107)](_0x333758,_0x311d88,_0x21b061);}async[a0_0x560c35(0x1bc)](_0x1ce5d6){const _0x3b40f5=a0_0x560c35;if(typeof _0x1ce5d6===_0x3b40f5(0x1fe)&&_0x1ce5d6[_0x3b40f5(0x263)]){if(_0x1ce5d6[_0x3b40f5(0x293)]===_0x3b40f5(0x294)){const _0x56bcad=_0x1ce5d6[_0x3b40f5(0x263)][_0x3b40f5(0x2b6)]||this['config']['geminiApiKey'];if(!_0x56bcad)return this['sendTo'](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6['command'],{'success':![],'message':_0x3b40f5(0x13e)},_0x1ce5d6[_0x3b40f5(0x2c2)]);try{const _0x5dc538=new GoogleGenerativeAI(_0x56bcad),_0x213a6a=_0x5dc538['getGenerativeModel']({'model':GEMINI_MODEL}),_0x289923=await _0x213a6a[_0x3b40f5(0x187)]('Say\x20Hello'),_0x44ada8=await _0x289923[_0x3b40f5(0x195)],_0x58472d=_0x44ada8[_0x3b40f5(0x233)]();this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6[_0x3b40f5(0x293)],{'success':!![],'message':_0x3b40f5(0x1cd)+_0x58472d[_0x3b40f5(0x1fa)](0x0,0x14)+'...'},_0x1ce5d6[_0x3b40f5(0x2c2)]);}catch(_0x573673){this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6[_0x3b40f5(0x293)],{'success':![],'message':_0x3b40f5(0x224)+_0x573673[_0x3b40f5(0x263)]},_0x1ce5d6[_0x3b40f5(0x2c2)]);}}else{if(_0x1ce5d6[_0x3b40f5(0x293)]===_0x3b40f5(0x18a)){const _0x57760b=await this[_0x3b40f5(0x2a2)](),_0x47b3ed=await this['getCalendarContext']();this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6[_0x3b40f5(0x293)],{'success':!![],'weather':_0x57760b,'calendar':_0x47b3ed},_0x1ce5d6['callback']);}else{if(_0x1ce5d6[_0x3b40f5(0x293)]===_0x3b40f5(0x19d)){if(!this[_0x3b40f5(0x20d)])return this['sendTo'](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6['command'],{'success':![],'isPro':![]},_0x1ce5d6['callback']);let _0x289941={'status':_0x3b40f5(0x1be),'details':''};try{const _0x497d19=await this[_0x3b40f5(0x20c)](LTM_DP_DRIFT_STATUS),_0x49134e=await this[_0x3b40f5(0x20c)](LTM_DP_DRIFT_DETAILS);_0x289941[_0x3b40f5(0x2ca)]=_0x497d19?_0x497d19['val']:'N/A',_0x289941['details']=_0x49134e?_0x49134e[_0x3b40f5(0x1c8)]:'';}catch(_0x3d6a2b){}this['sendTo'](_0x1ce5d6['from'],_0x1ce5d6[_0x3b40f5(0x293)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x3b40f5(0x25f)],'driftAnalysis':_0x289941,'analysisHistory':this['analysisHistory']},_0x1ce5d6[_0x3b40f5(0x2c2)]);}else{if(_0x1ce5d6[_0x3b40f5(0x293)]===_0x3b40f5(0xfc)){const _0x3f601b=this['dailyDigests'][_0x3b40f5(0x278)],_0x4a379b=new Date(),_0x5d81dc=new Date(_0x4a379b['getFullYear'](),_0x4a379b[_0x3b40f5(0x176)](),_0x4a379b[_0x3b40f5(0x1d3)]())['getTime'](),_0x5af29d=this[_0x3b40f5(0x26f)][_0x3b40f5(0x213)](_0x4c6faf=>new Date(_0x4c6faf[_0x3b40f5(0x11a)])[_0x3b40f5(0x1e8)]()>_0x5d81dc)['length'],_0x355d39=new Array(0x18)['fill'](0x0);this[_0x3b40f5(0x26f)][_0x3b40f5(0x116)](_0x306a5f=>{const _0x27f617=_0x3b40f5,_0x20f009=new Date(_0x306a5f[_0x27f617(0x11a)]);if(_0x20f009[_0x27f617(0x1e8)]()>_0x5d81dc)_0x355d39[_0x20f009[_0x27f617(0x26c)]()]++;});let _0x1c038f={'status':_0x3b40f5(0x1be)};try{const _0x28c673=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x1c038f[_0x3b40f5(0x2ca)]=_0x28c673?_0x28c673[_0x3b40f5(0x1c8)]:_0x3b40f5(0x1be);}catch(_0x5b9426){}let _0x2f0080='';try{const _0x5a7dd0=await this['getStateAsync'](_0x3b40f5(0x10f));_0x2f0080=_0x5a7dd0?_0x5a7dd0[_0x3b40f5(0x1c8)]:'';}catch(_0x16594f){}let _0xdefb8f=null;!this[_0x3b40f5(0x2c9)]&&(_0xdefb8f=this[_0x3b40f5(0x28c)][_0x3b40f5(0x15a)]?_0x3b40f5(0x2c8):_0x3b40f5(0x1e2));let _0x25e704={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x40acae=await this[_0x3b40f5(0x20c)](_0x3b40f5(0x196)),_0x16826b=await this[_0x3b40f5(0x20c)]('analysis.automation.description'),_0x1f56b0=await this[_0x3b40f5(0x20c)](_0x3b40f5(0x1a1)),_0x57ab4c=await this[_0x3b40f5(0x20c)]('analysis.automation.targetValue'),_0x4d54f3=await this[_0x3b40f5(0x20c)](_0x3b40f5(0x2a6));_0x40acae&&_0x40acae[_0x3b40f5(0x1c8)]&&(_0x25e704[_0x3b40f5(0x24a)]=!![],_0x25e704[_0x3b40f5(0x240)]=_0x16826b?_0x16826b[_0x3b40f5(0x1c8)]:'',_0x25e704['targetId']=_0x1f56b0?_0x1f56b0[_0x3b40f5(0x1c8)]:'',_0x25e704[_0x3b40f5(0x2a9)]=_0x57ab4c?_0x57ab4c[_0x3b40f5(0x1c8)]:''),_0x25e704['autoApply']=_0x4d54f3?!!_0x4d54f3[_0x3b40f5(0x1c8)]:![];}catch(_0xd00714){}this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6[_0x3b40f5(0x293)],{'success':!![],'eventHistory':this['eventHistory'][_0x3b40f5(0x18f)](0x0,0xf),'stats':{'digestCount':_0x3f601b,'eventCountToday':_0x5af29d,'hourlyActivity':_0x355d39,'driftStatus':_0x1c038f['status'],'isPresent':this[_0x3b40f5(0x283)],'presenceWho':_0x2f0080,'minDays':this[_0x3b40f5(0x28c)]['minDaysForBaseline']||0x7,'stbDays':this['config']['ltmStbWindowDays']||0xe,'ltbDays':this[_0x3b40f5(0x28c)][_0x3b40f5(0x235)]||0x3c,'systemError':_0xdefb8f},'automation':_0x25e704},_0x1ce5d6[_0x3b40f5(0x2c2)]);}else{if(_0x1ce5d6['command']===_0x3b40f5(0x11b))try{const _0x2b8ca0=await this[_0x3b40f5(0x208)](_0x1ce5d6['message']||{});this['sendTo'](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6[_0x3b40f5(0x293)],{'success':!![],'devices':_0x2b8ca0},_0x1ce5d6[_0x3b40f5(0x2c2)]);}catch(_0x41ab20){this['sendTo'](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6['command'],{'success':![],'error':_0x41ab20[_0x3b40f5(0x263)]},_0x1ce5d6[_0x3b40f5(0x2c2)]);}else{if(_0x1ce5d6[_0x3b40f5(0x293)]===_0x3b40f5(0x174)){const _0x1e7b00=await this[_0x3b40f5(0x1a7)](_0x3b40f5(0x181),_0x3b40f5(0x282)),_0x77f820=[];if(_0x1e7b00)for(const _0x4e15ca in _0x1e7b00){const _0x13c190=_0x1e7b00[_0x4e15ca],_0x472290=(_0x13c190[_0x3b40f5(0x163)]&&typeof _0x13c190['common'][_0x3b40f5(0x1d2)]===_0x3b40f5(0x1fe)?_0x13c190[_0x3b40f5(0x163)][_0x3b40f5(0x1d2)]['de']:_0x13c190[_0x3b40f5(0x163)][_0x3b40f5(0x1d2)])||_0x13c190['common'][_0x3b40f5(0x1d2)];_0x77f820[_0x3b40f5(0x13a)]({'id':_0x4e15ca,'name':_0x472290});}this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6['command'],{'success':!![],'enums':_0x77f820},_0x1ce5d6['callback']);}else{if(_0x1ce5d6[_0x3b40f5(0x293)]===_0x3b40f5(0x192)){const _0xbb5873=_0x1ce5d6['message'][_0x3b40f5(0x1b0)];if(!_0xbb5873)return this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6[_0x3b40f5(0x293)],{'success':![],'error':_0x3b40f5(0x1d6)},_0x1ce5d6[_0x3b40f5(0x2c2)]);const _0x20cf71=await this[_0x3b40f5(0x192)](_0xbb5873);this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6['command'],{'success':!![],'names':_0x20cf71},_0x1ce5d6[_0x3b40f5(0x2c2)]);}else{if(_0x1ce5d6[_0x3b40f5(0x293)]==='simulateButler'){const {targetId:_0x34ecd5,targetValue:_0x233331}=_0x1ce5d6[_0x3b40f5(0x263)];this['log'][_0x3b40f5(0x2c3)](_0x3b40f5(0x262)+_0x34ecd5+'\x20=\x20'+_0x233331),await this[_0x3b40f5(0x265)](_0x3b40f5(0x196),{'val':!![],'ack':!![]}),await this[_0x3b40f5(0x265)](_0x3b40f5(0x131),{'val':'SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20'+_0x34ecd5,'ack':!![]}),await this[_0x3b40f5(0x265)](_0x3b40f5(0x1a1),{'val':_0x34ecd5,'ack':!![]}),await this[_0x3b40f5(0x265)](_0x3b40f5(0x12f),{'val':_0x233331,'ack':!![]}),this[_0x3b40f5(0x18d)](_0x1ce5d6['from'],_0x1ce5d6[_0x3b40f5(0x293)],{'success':!![]},_0x1ce5d6[_0x3b40f5(0x2c2)]);}else{if(_0x1ce5d6[_0x3b40f5(0x293)]===_0x3b40f5(0x15c)){const {historyId:_0x2be5ae,rating:_0x468a25,comment:_0x230309,alertReason:_0x1c72d2}=_0x1ce5d6['message'];_0x2be5ae&&_0x468a25?(await this['saveFeedback']({'timestamp':Date[_0x3b40f5(0x291)](),'historyId':_0x2be5ae,'rating':_0x468a25,'comment':_0x230309,'alertReason':_0x1c72d2}),this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6[_0x3b40f5(0x293)],{'success':!![]},_0x1ce5d6['callback'])):this[_0x3b40f5(0x18d)](_0x1ce5d6['from'],_0x1ce5d6[_0x3b40f5(0x293)],{'success':![],'error':_0x3b40f5(0x168)},_0x1ce5d6[_0x3b40f5(0x2c2)]);}else _0x1ce5d6[_0x3b40f5(0x293)]===_0x3b40f5(0x1f0)&&(this[_0x3b40f5(0x21d)][_0x3b40f5(0x2c3)](_0x3b40f5(0x142)),await this[_0x3b40f5(0x265)](_0x3b40f5(0x196),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x3b40f5(0x131),{'val':'','ack':!![]}),this[_0x3b40f5(0x18d)](_0x1ce5d6[_0x3b40f5(0x1a9)],_0x1ce5d6[_0x3b40f5(0x293)],{'success':!![]},_0x1ce5d6[_0x3b40f5(0x2c2)]));}}}}}}}}}}async[a0_0x560c35(0x107)](_0x2922b2,_0x532e13,_0x409c3c){const _0x394ad4=a0_0x560c35;if(!_0x409c3c)return;const _0x11ecd3=_0x532e13[_0x394ad4(0x1c8)],_0x4cfcc1=Date[_0x394ad4(0x291)](),_0x25545f=this[_0x394ad4(0x12d)][_0x2922b2];this[_0x394ad4(0x12d)][_0x2922b2]=_0x11ecd3;if(!_0x409c3c[_0x394ad4(0x1c4)]&&_0x25545f!=undefined&&_0x25545f==_0x11ecd3)return;const _0x46c1b2=(_0x409c3c[_0x394ad4(0x127)]||'')[_0x394ad4(0x182)](),_0x17c724=_0x46c1b2[_0x394ad4(0x2aa)](_0x394ad4(0x1f8))||_0x46c1b2[_0x394ad4(0x2aa)](_0x394ad4(0x2b1))||_0x46c1b2['includes'](_0x394ad4(0x245))||_0x46c1b2[_0x394ad4(0x2aa)](_0x394ad4(0x149));this[_0x394ad4(0x20d)]&&_0x17c724&&this[_0x394ad4(0x128)](_0x2922b2,_0x11ecd3,_0x409c3c[_0x394ad4(0x22c)]);const _0x227598={'timestamp':_0x4cfcc1,'id':_0x2922b2,'name':_0x409c3c['name'],'type':_0x409c3c[_0x394ad4(0x127)],'location':_0x409c3c[_0x394ad4(0x22c)],'value':_0x11ecd3};this[_0x394ad4(0x25d)][_0x394ad4(0x24e)](_0x227598);if(this[_0x394ad4(0x25d)][_0x394ad4(0x278)]>HISTORY_MAX_SIZE)this[_0x394ad4(0x25d)][_0x394ad4(0x20f)]();await this['setStateAsync'](_0x394ad4(0x1b3),{'val':JSON[_0x394ad4(0x226)](_0x227598),'ack':!![]}),await this['setStateAsync']('events.history',{'val':JSON[_0x394ad4(0x226)](this[_0x394ad4(0x25d)]),'ack':!![]});this['isProVersion']&&(this[_0x394ad4(0x26f)][_0x394ad4(0x13a)](_0x227598),await this[_0x394ad4(0x27d)](),this[_0x394ad4(0x295)](_0x227598));if(_0x409c3c[_0x394ad4(0x146)]&&_0x11ecd3===!![]){if(this[_0x394ad4(0x283)]&&!this[_0x394ad4(0x299)])this['startExitTimer']();else{if(!this[_0x394ad4(0x283)])this['setPresence'](!![]);}}else{if(_0x409c3c[_0x394ad4(0x127)]===_0x394ad4(0x152)&&_0x11ecd3===!![]){if(this[_0x394ad4(0x28d)])this[_0x394ad4(0x141)]();if(!this[_0x394ad4(0x283)]&&this[_0x394ad4(0x124)]===SYSTEM_MODES[_0x394ad4(0x17e)])this['setPresence'](!![]);}}}async[a0_0x560c35(0x295)](_0x56ad80){const _0x57cbf1=a0_0x560c35,_0x5c91bb=(_0x56ad80['type']||'')[_0x57cbf1(0x182)](),_0x25308e=[_0x57cbf1(0x152),_0x57cbf1(0x207),_0x57cbf1(0x143),_0x57cbf1(0x188),_0x57cbf1(0x19b),_0x57cbf1(0x125),'t√ºr',_0x57cbf1(0x2c1),_0x57cbf1(0x21b),_0x57cbf1(0x296),'kontakt',_0x57cbf1(0x1a2),_0x57cbf1(0x19a),'switch',_0x57cbf1(0x298),'dimmer',_0x57cbf1(0x204)];if(!_0x25308e['some'](_0x2a28cf=>_0x5c91bb['includes'](_0x2a28cf)))return;if(!_0x56ad80[_0x57cbf1(0x287)])return;if(this[_0x57cbf1(0x1da)])clearTimeout(this[_0x57cbf1(0x1da)]);this[_0x57cbf1(0x219)][_0x57cbf1(0x13a)]({'loc':_0x56ad80[_0x57cbf1(0x22c)]||'Unknown','id':_0x56ad80['id'],'ts':Date[_0x57cbf1(0x291)]()}),this[_0x57cbf1(0x21d)]['debug'](_0x57cbf1(0x2b7)+_0x56ad80['location']+_0x57cbf1(0x162)+this[_0x57cbf1(0x219)][_0x57cbf1(0x278)]+')'),this[_0x57cbf1(0x1da)]=setTimeout(async()=>{const _0xe45893=_0x57cbf1;if(this[_0xe45893(0x219)][_0xe45893(0x278)]>0x1)await this['saveCompletedSequence']();this[_0xe45893(0x219)]=[];},SEQUENCE_TIMEOUT_MS);}async[a0_0x560c35(0x28f)](){const _0x371f10=a0_0x560c35;try{const _0x1c1535=await this[_0x371f10(0x20c)](_0x371f10(0x1ac));let _0x33be38=[];if(_0x1c1535&&_0x1c1535[_0x371f10(0x1c8)])try{_0x33be38=JSON['parse'](_0x1c1535['val']);}catch(_0x293da7){}const _0x1f51d1=this[_0x371f10(0x219)][0x0]['ts'],_0x19666a=this[_0x371f10(0x219)][_0x371f10(0x133)](_0x32bd51=>({'loc':_0x32bd51['loc'],'t_delta':Math[_0x371f10(0x237)]((_0x32bd51['ts']-_0x1f51d1)/0x3e8)})),_0x2e9b21={'timestamp':new Date(_0x1f51d1)['toISOString'](),'steps':_0x19666a,'duration':Math[_0x371f10(0x237)]((this['activeSequence'][this['activeSequence'][_0x371f10(0x278)]-0x1]['ts']-_0x1f51d1)/0x3e8),'daytime':new Date(_0x1f51d1)[_0x371f10(0x26c)]()};_0x33be38['push'](_0x2e9b21);if(_0x33be38[_0x371f10(0x278)]>MAX_TRAINING_SET_SIZE)_0x33be38[_0x371f10(0x1a8)]();await this[_0x371f10(0x265)](_0x371f10(0x1ac),{'val':JSON['stringify'](_0x33be38),'ack':!![]}),this[_0x371f10(0x2b8)](_0x2e9b21);}catch(_0x4479f4){this[_0x371f10(0x21d)]['error'](_0x371f10(0x2c4)+_0x4479f4['message']);}}['runSecurityCheck'](_0x96778b){const _0x5cfb5f=a0_0x560c35;if(!this['isProVersion'])return;this[_0x5cfb5f(0x21d)]['debug']('üõ°Ô∏è\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...'),this[_0x5cfb5f(0x261)](_0x5cfb5f(0x115),{'sequence':_0x96778b});}[a0_0x560c35(0x14d)](){const _0x2b2739=a0_0x560c35;if(this[_0x2b2739(0x197)])return;this[_0x2b2739(0x197)]=!![];const _0x31fa93=path[_0x2b2739(0x21a)](__dirname,_0x2b2739(0x234),'requirements.txt');this[_0x2b2739(0x21d)][_0x2b2739(0x2c3)](_0x2b2739(0x27f)),this[_0x2b2739(0x2bc)]();if(fs[_0x2b2739(0x16b)](VENV_PATH)){if(!fs['existsSync'](PIP_EXE)){this['log'][_0x2b2739(0x16a)](_0x2b2739(0x1ed));try{fs['rmSync'](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x51b61b){}}}!fs['existsSync'](VENV_PATH)?exec(_0x2b2739(0x14b)+VENV_PATH+'\x22',_0x43a5ba=>{const _0x961890=_0x2b2739;if(_0x43a5ba){this[_0x961890(0x21d)]['error'](_0x961890(0x23b)),this[_0x961890(0x197)]=![];return;}this['installRequirementsInVenv'](_0x31fa93);}):this[_0x2b2739(0x241)](_0x31fa93);}[a0_0x560c35(0x241)](_0x2fe871){const _0x3f4893=a0_0x560c35;this[_0x3f4893(0x21d)][_0x3f4893(0x2c3)]('Installing\x20dependencies\x20into\x20venv...');const _0x6c5f98='\x22'+PIP_EXE+_0x3f4893(0x154)+_0x2fe871+'\x22';exec(_0x6c5f98,{'timeout':0x124f80,'maxBuffer':0x400*0x400*0x32},_0x3cbeaa=>{const _0x421a54=_0x3f4893;this[_0x421a54(0x197)]=![],_0x3cbeaa?this[_0x421a54(0x21d)]['error'](_0x421a54(0xfd)+_0x3cbeaa[_0x421a54(0x263)]):(this[_0x421a54(0x21d)][_0x421a54(0x2c3)](_0x421a54(0x1b4)),this[_0x421a54(0x145)]());});}[a0_0x560c35(0x145)](){const _0x5092cc=a0_0x560c35;if(this[_0x5092cc(0x197)])return;let _0xb934a3='python3';if(fs['existsSync'](PYTHON_EXE))this['log'][_0x5092cc(0x2c3)](_0x5092cc(0x120)+PYTHON_EXE),_0xb934a3=PYTHON_EXE;else{this[_0x5092cc(0x21d)][_0x5092cc(0x16a)](_0x5092cc(0x20e)),this['installPythonDependencies']();return;}try{const _0x228996=path['join'](__dirname,_0x5092cc(0x234),_0x5092cc(0x2b2));this[_0x5092cc(0x29a)]=spawn(_0xb934a3,[_0x228996]),this[_0x5092cc(0x29a)][_0x5092cc(0x260)]['on'](_0x5092cc(0x1bd),_0x45892b=>{const _0x4629e4=_0x5092cc,_0x2d51a7=_0x45892b[_0x4629e4(0x1fb)]()['split']('\x0a');_0x2d51a7[_0x4629e4(0x116)](_0x5546c0=>{const _0x1900a4=_0x4629e4,_0x5322d3=_0x5546c0[_0x1900a4(0x25c)]();if(!_0x5322d3)return;if(_0x5322d3['startsWith'](_0x1900a4(0x29b)))this[_0x1900a4(0x21d)]['debug'](_0x1900a4(0x153)+_0x5322d3[_0x1900a4(0x1fa)](0x5)[_0x1900a4(0x25c)]());else{if(_0x5322d3['startsWith'](_0x1900a4(0x121)))try{const _0x5b79bd=JSON[_0x1900a4(0x1e9)](_0x5322d3['substring'](0x8)[_0x1900a4(0x25c)]());this['handlePythonResult'](_0x5b79bd);}catch(_0x3b1287){this['log'][_0x1900a4(0x16a)](_0x1900a4(0x1df)+_0x5322d3);}}(_0x5322d3[_0x1900a4(0x2aa)](_0x1900a4(0x158))||_0x5322d3['includes'](_0x1900a4(0x18e)))&&(this[_0x1900a4(0x21d)]['warn'](_0x1900a4(0x2a8)),this[_0x1900a4(0x14d)]());});}),this['pythonProcess'][_0x5092cc(0x2a3)]['on']('data',_0x1248f8=>{const _0x2cb4b8=_0x5092cc,_0x3a180d=_0x1248f8[_0x2cb4b8(0x1fb)]()['trim']();if(!_0x3a180d['includes'](_0x2cb4b8(0x126)))this[_0x2cb4b8(0x21d)][_0x2cb4b8(0x25b)](_0x2cb4b8(0x111)+_0x3a180d);}),this[_0x5092cc(0x29a)]['on'](_0x5092cc(0x1ef),_0xf2e4a6=>{const _0x189db3=_0x5092cc;this[_0x189db3(0x21d)][_0x189db3(0x2c3)](_0x189db3(0x10a)+_0xf2e4a6),this[_0x189db3(0x29a)]=null;});}catch(_0x1897f2){this[_0x5092cc(0x21d)][_0x5092cc(0x25b)](_0x5092cc(0x1bf)+_0x1897f2[_0x5092cc(0x263)]);}}[a0_0x560c35(0x2bc)](){const _0x302012=a0_0x560c35;if(this[_0x302012(0x29a)]){this[_0x302012(0x21d)]['info'](_0x302012(0x180));try{this['pythonProcess'][_0x302012(0x1e4)]();}catch(_0x175b10){}this[_0x302012(0x29a)]=null;}}[a0_0x560c35(0x1c1)](_0x23f3ed){const _0x2c11f7=a0_0x560c35;if(_0x23f3ed['type']==='PONG')this['log'][_0x2c11f7(0x104)](_0x2c11f7(0x11c));else{if(_0x23f3ed['type']===_0x2c11f7(0x1d8)){const {anomaly_score:_0x1aa77e,is_anomaly:_0x3cb8a9,threshold:_0x39a358}=_0x23f3ed[_0x2c11f7(0x105)];this[_0x2c11f7(0x21d)]['info']('üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20'+_0x1aa77e[_0x2c11f7(0x1e5)](0x5)+_0x2c11f7(0x10e)+(_0x3cb8a9?_0x2c11f7(0x206):'OK')),this['setStateAsync'](_0x2c11f7(0x200),{'val':_0x1aa77e,'ack':!![]}),this[_0x2c11f7(0x265)](_0x2c11f7(0x165),{'val':new Date()[_0x2c11f7(0x2c6)](),'ack':!![]});if(_0x3cb8a9){const _0x43ca1c=_0x2c11f7(0x2b5)+_0x1aa77e['toFixed'](0x4)+')';this[_0x2c11f7(0x265)](_0x2c11f7(0x1e7),{'val':!![],'ack':!![]}),this[_0x2c11f7(0x265)](_0x2c11f7(0x155),{'val':_0x43ca1c,'ack':!![]}),this[_0x2c11f7(0x1e0)](_0x2c11f7(0x2be)+_0x43ca1c,![],!![]);}}else{if(_0x23f3ed[_0x2c11f7(0x127)]===_0x2c11f7(0x1f9)){const {success:_0x375327,details:_0x35732c}=_0x23f3ed[_0x2c11f7(0x105)];this[_0x2c11f7(0x265)](_0x2c11f7(0x268),{'val':_0x375327?_0x2c11f7(0x212)+new Date()[_0x2c11f7(0x267)]()+'\x20('+_0x35732c+')':_0x2c11f7(0x20b)+_0x35732c,'ack':!![]});}else{if(_0x23f3ed[_0x2c11f7(0x127)]==='ENERGY_TRAIN_RESULT'){const {success:_0x371179,details:_0x334bd1}=_0x23f3ed[_0x2c11f7(0x105)];if(_0x371179)try{const _0x1f7113=JSON[_0x2c11f7(0x1e9)](_0x334bd1);if(_0x1f7113['insulation'])this[_0x2c11f7(0x265)](_0x2c11f7(0x1ce),{'val':JSON[_0x2c11f7(0x226)](_0x1f7113['insulation']),'ack':!![]});if(_0x1f7113['heating'])this[_0x2c11f7(0x265)](_0x2c11f7(0x2a4),{'val':JSON['stringify'](_0x1f7113[_0x2c11f7(0x28a)]),'ack':!![]});}catch(_0xf0a2ba){}}else{if(_0x23f3ed[_0x2c11f7(0x127)]===_0x2c11f7(0x1d1)){const {success:_0x188830,details:_0x1c9330}=_0x23f3ed[_0x2c11f7(0x105)];if(_0x188830)this[_0x2c11f7(0x21d)][_0x2c11f7(0x2c3)](_0x2c11f7(0x286)+_0x1c9330);}else{if(_0x23f3ed[_0x2c11f7(0x127)]===_0x2c11f7(0x23c)){const {is_anomaly:_0x248dea,details:_0x2fa642}=_0x23f3ed[_0x2c11f7(0x105)];this[_0x2c11f7(0x265)]('analysis.health.lastCheck',{'val':new Date()[_0x2c11f7(0x2c6)](),'ack':!![]}),this[_0x2c11f7(0x265)](_0x2c11f7(0x1ba),{'val':_0x248dea,'ack':!![]});}}}}}}}[a0_0x560c35(0x261)](_0xc03287,_0x1573f4={}){const _0x24784e=a0_0x560c35;if(!this['pythonProcess']||!this[_0x24784e(0x29a)][_0x24784e(0x185)]['writable'])return;const _0x1394b8=JSON[_0x24784e(0x226)]({'command':_0xc03287,..._0x1573f4});try{this[_0x24784e(0x29a)][_0x24784e(0x185)][_0x24784e(0x276)](_0x1394b8+'\x0a');}catch(_0x4d6171){}}async['recordThermodynamics'](_0x365a90,_0x5e3bc1,_0xb39d67){const _0xdb85ae=a0_0x560c35,_0xd7a765=await this[_0xdb85ae(0x275)](),_0x1a6f59=await this[_0xdb85ae(0x20c)](_0xdb85ae(0x271));let _0x41c2d1=[];if(_0x1a6f59&&_0x1a6f59[_0xdb85ae(0x1c8)])try{_0x41c2d1=JSON[_0xdb85ae(0x1e9)](_0x1a6f59[_0xdb85ae(0x1c8)]);}catch(_0x4d0cfd){}_0x41c2d1['push']({'ts':Date[_0xdb85ae(0x291)](),'room':_0xb39d67||_0xdb85ae(0x253),'t_in':_0x5e3bc1,'t_out':_0xd7a765});if(_0x41c2d1[_0xdb85ae(0x278)]>THERMO_LOG_SIZE)_0x41c2d1[_0xdb85ae(0x1a8)]();await this['setStateAsync'](_0xdb85ae(0x271),{'val':JSON[_0xdb85ae(0x226)](_0x41c2d1),'ack':!![]});}async[a0_0x560c35(0x275)](){const _0x28584a=a0_0x560c35;if(this['config'][_0x28584a(0x270)])try{const _0x24d775=await this[_0x28584a(0x11d)](this['config'][_0x28584a(0x270)]);if(_0x24d775&&_0x24d775[_0x28584a(0x1c8)]!==undefined&&_0x24d775[_0x28584a(0x1c8)]!==null){const _0x4ad9f8=parseFloat(_0x24d775['val']);if(!isNaN(_0x4ad9f8))return _0x4ad9f8;}}catch(_0x20b25b){}const _0x5259d6=this[_0x28584a(0x28c)][_0x28584a(0x1d5)];if(!this[_0x28584a(0x28c)][_0x28584a(0x10d)]||!_0x5259d6)return null;try{let _0x18704c='';if(_0x5259d6[_0x28584a(0x2aa)](_0x28584a(0x164)))_0x18704c=_0x5259d6+_0x28584a(0x2ac);else{if(_0x5259d6['includes'](_0x28584a(0x173)))_0x18704c=_0x5259d6+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x5259d6[_0x28584a(0x2aa)](_0x28584a(0x171)))_0x18704c=_0x5259d6+'.forecast.current.temperature';else{if(_0x5259d6[_0x28584a(0x2aa)](_0x28584a(0x103)))_0x18704c=_0x5259d6+_0x28584a(0x148);}}}if(_0x18704c){const _0xe2678=await this[_0x28584a(0x11d)](_0x18704c);if(_0xe2678&&_0xe2678[_0x28584a(0x1c8)]!==undefined&&_0xe2678[_0x28584a(0x1c8)]!==null)return parseFloat(_0xe2678[_0x28584a(0x1c8)]);}}catch(_0x41b07c){}return null;}async[a0_0x560c35(0x208)](_0x34d81f){const _0x19bddb=a0_0x560c35;this[_0x19bddb(0x21d)][_0x19bddb(0x2c3)](_0x19bddb(0x113));const _0x51bd78=[],_0x28a9f6=await this['getForeignObjectsAsync']('*'),_0x1b5d15=await this[_0x19bddb(0x1a7)](_0x19bddb(0x181),_0x19bddb(0x282)),_0x15bc4d=await this[_0x19bddb(0x1a7)](_0x19bddb(0x14a),_0x19bddb(0x282)),_0x46e279={};if(_0x1b5d15)for(const _0x45fc6f in _0x1b5d15){const _0x5ac497=_0x1b5d15[_0x45fc6f]['common'][_0x19bddb(0x14e)]||[];_0x5ac497['forEach'](_0x267bf4=>{if(!_0x46e279[_0x267bf4])_0x46e279[_0x267bf4]=[];_0x46e279[_0x267bf4]['push'](_0x45fc6f);});}const _0x2cad69={};if(_0x15bc4d)for(const _0xd98b49 in _0x15bc4d){const _0x1de183=_0x15bc4d[_0xd98b49][_0x19bddb(0x163)][_0x19bddb(0x14e)]||[],_0x3a4f23=typeof _0x15bc4d[_0xd98b49][_0x19bddb(0x163)][_0x19bddb(0x1d2)]===_0x19bddb(0x1fe)?_0x15bc4d[_0xd98b49][_0x19bddb(0x163)][_0x19bddb(0x1d2)]['de']:_0x15bc4d[_0xd98b49][_0x19bddb(0x163)]['name'];_0x1de183[_0x19bddb(0x116)](_0x520fca=>_0x2cad69[_0x520fca]=_0x3a4f23);}const _0x687f0=_0x34d81f['motion']!==![],_0x141db2=_0x34d81f[_0x19bddb(0x135)]!==![],_0x20ab76=_0x34d81f[_0x19bddb(0x1d7)]!==![],_0x4afb36=_0x34d81f['temperature']===!![],_0x1c4d0a=_0x34d81f[_0x19bddb(0x281)]===!![];for(const _0x4632b2 in _0x28a9f6){const _0x4bb109=_0x28a9f6[_0x4632b2];if(_0x4bb109['type']!=='state'||!_0x4bb109[_0x19bddb(0x163)])continue;if(ADAPTER_BLACKLIST['some'](_0x4cd990=>_0x4632b2[_0x19bddb(0x254)](_0x4cd990))&&!_0x1c4d0a)continue;const _0x189822=(_0x4bb109[_0x19bddb(0x163)][_0x19bddb(0x1af)]||'')[_0x19bddb(0x182)]();let _0x561251=(typeof _0x4bb109[_0x19bddb(0x163)][_0x19bddb(0x1d2)]===_0x19bddb(0x1fe)?_0x4bb109[_0x19bddb(0x163)][_0x19bddb(0x1d2)]['de']:_0x4bb109[_0x19bddb(0x163)][_0x19bddb(0x1d2)])||_0x4632b2;const _0x169f84=_0x561251['toLowerCase']();let _0x1bf4d6=![];if(_0x34d81f[_0x19bddb(0x134)]&&_0x34d81f['selectedFunctionIds'][_0x19bddb(0x278)]>0x0){const _0x24ff77=_0x46e279[_0x4632b2]||[],_0xc6c120=_0x4632b2[_0x19bddb(0x26b)]('.')['slice'](0x0,-0x1)[_0x19bddb(0x21a)]('.'),_0x1eff00=_0x46e279[_0xc6c120]||[];(_0x24ff77[_0x19bddb(0x1f3)](_0x452820=>_0x34d81f[_0x19bddb(0x134)][_0x19bddb(0x2aa)](_0x452820))||_0x1eff00[_0x19bddb(0x1f3)](_0x361c68=>_0x34d81f[_0x19bddb(0x134)][_0x19bddb(0x2aa)](_0x361c68)))&&(_0x1bf4d6=!![]);}if(_0x1c4d0a&&_0x4632b2[_0x19bddb(0x2aa)](_0x19bddb(0x1f8)))_0x1bf4d6=!![];if(!_0x1bf4d6&&!_0x1c4d0a){if(HARD_IGNORE_TERMS[_0x19bddb(0x1f3)](_0x19b00c=>_0x4632b2[_0x19bddb(0x2aa)](_0x19b00c)||_0x169f84['includes'](_0x19b00c[_0x19bddb(0x182)]())))continue;}let _0x50eab9='';if(_0x687f0&&(_0x189822[_0x19bddb(0x2aa)](_0x19bddb(0x152))||_0x189822[_0x19bddb(0x2aa)](_0x19bddb(0x19b))))_0x50eab9=_0x19bddb(0x152);else{if(_0x141db2&&(_0x189822['includes'](_0x19bddb(0x125))||_0x189822[_0x19bddb(0x2aa)](_0x19bddb(0x2c1))))_0x50eab9=_0x19bddb(0x125);else{if(_0x20ab76&&(_0x189822[_0x19bddb(0x2aa)](_0x19bddb(0x1a2))||_0x189822['includes'](_0x19bddb(0x28e))))_0x50eab9=_0x19bddb(0x1a2);else{if(_0x4afb36&&(_0x189822[_0x19bddb(0x2aa)](_0x19bddb(0x1f8))||_0x189822['includes'](_0x19bddb(0x1d9))))_0x50eab9='temperature';}}}if(_0x50eab9){let _0x2d455f=_0x2cad69[_0x4632b2]||'';if(!_0x2d455f){let _0x25da7f=_0x4632b2;for(let _0x49e35=0x0;_0x49e35<0x3;_0x49e35++){const _0x1e1cd6=_0x25da7f['lastIndexOf']('.');if(_0x1e1cd6===-0x1)break;_0x25da7f=_0x25da7f[_0x19bddb(0x1fa)](0x0,_0x1e1cd6);if(_0x2cad69[_0x25da7f]){_0x2d455f=_0x2cad69[_0x25da7f];break;}}}_0x51bd78['push']({'id':_0x4632b2,'name':_0x561251,'location':_0x2d455f,'type':_0x50eab9,'logDuplicates':_0x50eab9===_0x19bddb(0x152),'isExit':![],'_score':_0x2d455f?0x50:0x28});}}return _0x51bd78;}async[a0_0x560c35(0xff)](){const _0x473650=a0_0x560c35;if(!this[_0x473650(0x2c9)])return;if(this[_0x473650(0x25d)][_0x473650(0x278)]===0x0)return;const _0x2cfe90=this['eventHistory'][_0x473650(0x18f)](0x0,0xf),_0xa88eb9=await this['getWeatherContext'](),_0x1cf16f=this[_0x473650(0x124)],_0x5cd245=PERSONA_MAPPING[this[_0x473650(0x28c)][_0x473650(0x292)]||_0x473650(0x1f1)],_0x2aabfa=this[_0x473650(0x28c)][_0x473650(0x27a)]||_0x473650(0x2c5);let _0x3e92c7='Unbekannt';try{const _0x39f725=await this['getStateAsync'](_0x473650(0x10f));if(_0x39f725&&_0x39f725[_0x473650(0x1c8)])_0x3e92c7=_0x39f725[_0x473650(0x1c8)];}catch(_0x27a7db){}let _0x3dce48=![];try{const _0x469289=await this[_0x473650(0x20c)]('analysis.automation.autoApply');if(_0x469289&&_0x469289[_0x473650(0x1c8)])_0x3dce48=!![];}catch(_0x2d8dea){}const _0x50d898=_0x473650(0x108)+_0x5cd245+'.\x20KONTEXT:\x20'+_0x2aabfa+_0x473650(0x1cb)+_0x1cf16f+_0x473650(0x118)+_0xa88eb9+_0x473650(0x227)+_0x3e92c7+_0x473650(0x16d)+JSON[_0x473650(0x226)](_0x2cfe90)+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{const _0x2ddeb6=await this['geminiModel']['generateContent'](_0x50d898),_0x5540ce=_0x2ddeb6[_0x473650(0x195)]['text']()[_0x473650(0x13f)](/```json|```/g,'')[_0x473650(0x25c)](),_0x1d43f7=JSON[_0x473650(0x1e9)](_0x5540ce);await this[_0x473650(0x265)](_0x473650(0x1db),{'val':JSON[_0x473650(0x226)](_0x1d43f7),'ack':!![]});if(_0x1d43f7[_0x473650(0x2b4)])await this[_0x473650(0x265)](_0x473650(0x147),{'val':_0x1d43f7['summary'],'ack':!![]});const _0x426bef={'timestamp':Date[_0x473650(0x291)](),'id':Date[_0x473650(0x291)]()[_0x473650(0x1fb)](),'analysis':{'activity':{'summary':_0x1d43f7[_0x473650(0x2b4)],'isAlert':_0x1d43f7['isAlert'],'alertReason':_0x1d43f7[_0x473650(0x11e)]},'comfort':{'automationProposal':_0x1d43f7[_0x473650(0x205)]}}};await this[_0x473650(0x1fc)](_0x426bef);const _0x25fa2e=_0x1d43f7['isAlert']||![];_0x25fa2e!==this[_0x473650(0x13d)]&&(await this[_0x473650(0x265)](_0x473650(0x1e7),{'val':_0x25fa2e,'ack':!![]}),this[_0x473650(0x13d)]=_0x25fa2e,_0x25fa2e&&(await this[_0x473650(0x265)](_0x473650(0x155),{'val':_0x1d43f7[_0x473650(0x11e)],'ack':!![]}),this[_0x473650(0x1e0)](_0x473650(0x18b)+_0x1d43f7[_0x473650(0x11e)],![],_0x1d43f7[_0x473650(0x221)])));if(_0x1d43f7['automationProposal']&&_0x1d43f7[_0x473650(0x205)][_0x473650(0x24a)]){await this['setStateAsync'](_0x473650(0x196),{'val':!![],'ack':!![]}),await this[_0x473650(0x265)]('analysis.automation.description',{'val':_0x1d43f7[_0x473650(0x205)][_0x473650(0x240)],'ack':!![]}),await this[_0x473650(0x265)](_0x473650(0x1a1),{'val':_0x1d43f7[_0x473650(0x205)][_0x473650(0x1b6)],'ack':!![]}),await this['setStateAsync']('analysis.automation.targetValue',{'val':JSON[_0x473650(0x226)](_0x1d43f7[_0x473650(0x205)][_0x473650(0x2a9)]),'ack':!![]});if(_0x3dce48)this[_0x473650(0x16e)]();}}catch(_0x480453){this[_0x473650(0x21d)][_0x473650(0x25b)]('Gemini\x20Error:\x20'+_0x480453[_0x473650(0x263)]);}}async[a0_0x560c35(0x138)](){const _0x122d14=a0_0x560c35;if(!this['isProVersion'])return;await this[_0x122d14(0x265)](LTM_DP_STATUS,{'val':_0x122d14(0x17b),'ack':!![]});if(!this[_0x122d14(0x2c9)]||this['rawEventLog'][_0x122d14(0x278)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this['setStateAsync'](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x2b24fd=JSON[_0x122d14(0x1e9)](JSON[_0x122d14(0x226)](this[_0x122d14(0x26f)])),_0x365743=_0x2b24fd[_0x122d14(0x278)],_0x4da988=_0x122d14(0x21c)+JSON[_0x122d14(0x226)](_0x2b24fd);try{const _0x3277cf=await this['geminiModel'][_0x122d14(0x187)](_0x4da988),_0x21090d=JSON[_0x122d14(0x1e9)](_0x3277cf[_0x122d14(0x195)][_0x122d14(0x233)]()[_0x122d14(0x13f)](/```json|```/g,'')[_0x122d14(0x25c)]()),_0x4d8cd4={'timestamp':new Date()['toISOString'](),'eventCount':_0x365743,'summary':_0x21090d[_0x122d14(0x2b4)]||_0x122d14(0x256),'activityLevel':_0x21090d[_0x122d14(0x26a)]||_0x122d14(0x169),'systemMode':this[_0x122d14(0x124)]};this[_0x122d14(0x25f)][_0x122d14(0x13a)](_0x4d8cd4),await this['saveDailyDigests'](),this[_0x122d14(0x26f)]=[],await this['saveRawEventLog'](),await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x122d14(0x27c),'ack':!![]});if(this[_0x122d14(0x20d)])this['sendToPython'](_0x122d14(0x11f),{'digest':_0x4d8cd4});}catch(_0x8fd9fb){this['log'][_0x122d14(0x25b)](_0x8fd9fb[_0x122d14(0x263)]);}}async[a0_0x560c35(0x229)](){const _0x1e5fd0=a0_0x560c35;if(!this[_0x1e5fd0(0x20d)]||!this[_0x1e5fd0(0x2c9)])return;const _0x28af04=this[_0x1e5fd0(0x28c)][_0x1e5fd0(0x1b9)]||0xe;if(this[_0x1e5fd0(0x25f)][_0x1e5fd0(0x278)]<_0x28af04+0x7){await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x1e5fd0(0x175),'ack':!![]});return;}const _0x1820f5=this[_0x1e5fd0(0x25f)][_0x1e5fd0(0x18f)](-_0x28af04),_0x2b166e=this[_0x1e5fd0(0x25f)][_0x1e5fd0(0x18f)](0x0,this[_0x1e5fd0(0x25f)][_0x1e5fd0(0x278)]-_0x28af04),_0x186ee4='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON['stringify'](_0x2b166e)+_0x1e5fd0(0x1e6)+JSON[_0x1e5fd0(0x226)](_0x1820f5);try{const _0x548440=await this[_0x1e5fd0(0x2c9)][_0x1e5fd0(0x187)](_0x186ee4),_0x2f7892=JSON['parse'](_0x548440[_0x1e5fd0(0x195)]['text']()[_0x1e5fd0(0x13f)](/```json|```/g,'')[_0x1e5fd0(0x25c)]());_0x2f7892['baselineDrift']&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x2f7892['baselineDrift'],'ack':!![]}),await this[_0x1e5fd0(0x265)](LTM_DP_DRIFT_DETAILS,{'val':_0x2f7892['driftDetails'],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x1e5fd0(0x291)](),'ack':!![]}));}catch(_0x1bb330){}}async[a0_0x560c35(0x1ca)](){const _0xa63d4c=a0_0x560c35;if(!this[_0xa63d4c(0x2c9)])return;this[_0xa63d4c(0x21d)]['info'](_0xa63d4c(0x264));const _0x559a15=this[_0xa63d4c(0x25f)]['length']>0x0?this[_0xa63d4c(0x25f)][this[_0xa63d4c(0x25f)][_0xa63d4c(0x278)]-0x1]:null,_0x3633ad=_0x559a15&&_0x559a15[_0xa63d4c(0x2af)]?_0x559a15[_0xa63d4c(0x2af)][_0xa63d4c(0x27b)]:'N/A',_0xfe19ce=new Date();_0xfe19ce[_0xa63d4c(0x2bf)](0x4,0x0,0x0,0x0);const _0x5d6376=this[_0xa63d4c(0x25d)][_0xa63d4c(0x213)](_0x58bab6=>new Date(_0x58bab6[_0xa63d4c(0x11a)])>_0xfe19ce),_0x576e54=PERSONA_MAPPING[this[_0xa63d4c(0x28c)][_0xa63d4c(0x292)]||_0xa63d4c(0x1f1)],_0x53c0b3=this['config']['livingContext']||'',_0x24b4d8=await this[_0xa63d4c(0x2a2)](),_0x15a3d4=await this['getCalendarContext'](),_0x383883=_0xa63d4c(0x144)+_0x576e54+'.\x20KONTEXT:\x20'+_0x53c0b3+_0xa63d4c(0x1dc)+_0x24b4d8+'\x20'+_0x15a3d4+_0xa63d4c(0x1b5)+_0x3633ad+_0xa63d4c(0x25e);try{const _0x5f3290=await this['geminiModel'][_0xa63d4c(0x187)](_0x383883),_0x4b28c7=_0xa63d4c(0x1ab)+_0x5f3290[_0xa63d4c(0x195)][_0xa63d4c(0x233)]()[_0xa63d4c(0x25c)]();this[_0xa63d4c(0x1e0)](_0x4b28c7);}catch(_0x1a1d13){this[_0xa63d4c(0x21d)]['error'](_0xa63d4c(0x1ea)+_0x1a1d13[_0xa63d4c(0x263)]);}}async['runAutopilot'](){const _0x3d7b39=a0_0x560c35,_0x31233e=this[_0x3d7b39(0x28c)][_0x3d7b39(0x1cf)],_0xf4bed3=this[_0x3d7b39(0x25d)][_0x3d7b39(0x278)]>0x0?this[_0x3d7b39(0x25d)][0x0][_0x3d7b39(0x11a)]:Date[_0x3d7b39(0x291)](),_0x1ad269=(Date[_0x3d7b39(0x291)]()-_0xf4bed3)/(0x3e8*0x3c*0x3c);let _0x117b45='';this[_0x3d7b39(0x28c)]['inactivityMonitoringEnabled']&&this[_0x3d7b39(0x124)]===SYSTEM_MODES[_0x3d7b39(0x17e)]&&this['isPresent']&&(_0x1ad269>_0x31233e&&(_0x117b45='HARD\x20WATCHDOG:\x20No\x20activity\x20for\x20'+_0x1ad269[_0x3d7b39(0x1e5)](0x1)+'h.')),this['runGeminiAnalysis'](_0x117b45);}async[a0_0x560c35(0x192)](_0x408dd3){const _0xf6eea1=a0_0x560c35;try{const _0x2cbe2c=await this['getForeignStateAsync'](_0x408dd3+_0xf6eea1(0x112));if(_0x2cbe2c&&_0x2cbe2c[_0xf6eea1(0x1c8)]){const _0x1f2788=JSON[_0xf6eea1(0x1e9)](_0x2cbe2c[_0xf6eea1(0x1c8)]);if(Array[_0xf6eea1(0x1a0)](_0x1f2788))return[...new Set(_0x1f2788['map'](_0x28803c=>_0x28803c['_calName'])[_0xf6eea1(0x213)](Boolean))][_0xf6eea1(0x222)]();}}catch(_0xe152bc){}return[];}async[a0_0x560c35(0x1c5)](){const _0x2fe881=a0_0x560c35;if(!this['config']['useCalendar'])return _0x2fe881(0x17c);const _0x452d04=this[_0x2fe881(0x28c)][_0x2fe881(0x150)]||_0x2fe881(0x1ad);try{const _0x6b0e83=await this[_0x2fe881(0x11d)](_0x452d04+_0x2fe881(0x112));if(_0x6b0e83&&_0x6b0e83[_0x2fe881(0x1c8)]){let _0x53b2a2=JSON[_0x2fe881(0x1e9)](_0x6b0e83[_0x2fe881(0x1c8)]);if(Array['isArray'](_0x53b2a2)){if(_0x53b2a2[_0x2fe881(0x278)]>0x0)return _0x2fe881(0x259)+_0x53b2a2[_0x2fe881(0x18f)](0x0,0x3)['map'](_0x250adf=>_0x250adf[_0x2fe881(0x18c)])[_0x2fe881(0x21a)](',\x20');}}}catch(_0x4767ba){}return _0x2fe881(0x23d);}async[a0_0x560c35(0x1ee)](_0x29ca60){const _0x3ef468=a0_0x560c35;this['log'][_0x3ef468(0x2c3)]('Feedback:\x20'+JSON[_0x3ef468(0x226)](_0x29ca60));}async[a0_0x560c35(0x2bb)](){const _0x58c7c9=a0_0x560c35;try{const _0xe1d6f3=[_0x58c7c9(0x1b2),'events.history_debug_00'];for(const _0x2c2ed9 of _0xe1d6f3){try{const _0x214187=await this[_0x58c7c9(0x12e)](_0x2c2ed9);if(_0x214187)await this['delObjectAsync'](_0x2c2ed9);}catch(_0x8a1a2){}}}catch(_0x43dc3d){}}async[a0_0x560c35(0x243)](_0xbd376d){return!![];}async[a0_0x560c35(0x2a1)](){const _0x1a6c8f=a0_0x560c35;return _0x1a6c8f(0x23f);}async['initSystemConfig'](){const _0x75457b=a0_0x560c35;try{const _0x237493=await this[_0x75457b(0x29c)](_0x75457b(0x2b9));if(_0x237493&&_0x237493[_0x75457b(0x163)])this['systemConfig']={'latitude':_0x237493['common'][_0x75457b(0x15f)]||0x0,'longitude':_0x237493[_0x75457b(0x163)]['longitude']||0x0,'city':_0x237493[_0x75457b(0x163)][_0x75457b(0x1c0)]||''};}catch(_0x2a46d5){}}async['loadRawEventLog'](){const _0x1a10b5=a0_0x560c35;try{const _0x4be000=await this['getStateAsync'](LTM_DP_RAW_LOG);if(_0x4be000&&_0x4be000[_0x1a10b5(0x1c8)])this[_0x1a10b5(0x26f)]=JSON[_0x1a10b5(0x1e9)](_0x4be000[_0x1a10b5(0x1c8)]);}catch(_0x16bf6d){this[_0x1a10b5(0x26f)]=[];}}async[a0_0x560c35(0x27d)](){const _0x110a31=a0_0x560c35;if(this['rawEventLog'][_0x110a31(0x278)]>RAW_LOG_MAX_SIZE)this[_0x110a31(0x26f)][_0x110a31(0x285)](0x0,this[_0x110a31(0x26f)][_0x110a31(0x278)]-RAW_LOG_MAX_SIZE);await this[_0x110a31(0x265)](LTM_DP_RAW_LOG,{'val':JSON[_0x110a31(0x226)](this[_0x110a31(0x26f)]),'ack':!![]});}async[a0_0x560c35(0x2a0)](){const _0x1a6401=a0_0x560c35;try{const _0x364798=await this[_0x1a6401(0x20c)](LTM_DP_DAILY_DIGESTS);if(_0x364798&&_0x364798['val'])this[_0x1a6401(0x25f)]=JSON[_0x1a6401(0x1e9)](_0x364798[_0x1a6401(0x1c8)]);}catch(_0x591b6f){this[_0x1a6401(0x25f)]=[];}await this[_0x1a6401(0x257)]();}async['saveDailyDigests'](_0x2b94a0=!![]){const _0x56500b=a0_0x560c35,_0x72ebc5=this['config'][_0x56500b(0x235)]||0x3c;this[_0x56500b(0x25f)][_0x56500b(0x278)]>_0x72ebc5&&this[_0x56500b(0x25f)][_0x56500b(0x285)](0x0,this[_0x56500b(0x25f)][_0x56500b(0x278)]-_0x72ebc5);await this[_0x56500b(0x265)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x56500b(0x226)](this['dailyDigests']),'ack':!![]});if(_0x2b94a0)await this[_0x56500b(0x257)]();}async[a0_0x560c35(0x1fc)](_0x17b46d){const _0x4bb368=a0_0x560c35;this[_0x4bb368(0x246)]['unshift'](_0x17b46d);if(this[_0x4bb368(0x246)][_0x4bb368(0x278)]>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0x4bb368(0x20f)]();await this['setStateAsync']('analysis.analysisHistory',{'val':JSON[_0x4bb368(0x226)](this['analysisHistory']),'ack':!![]});}async['updateBaselineStatus'](){const _0x1476c8=a0_0x560c35;if(!this[_0x1476c8(0x20d)]){await this[_0x1476c8(0x265)](LTM_DP_BASELINE_STATUS,{'val':_0x1476c8(0x24d),'ack':!![]});return;}const _0x2f9fc0=this['dailyDigests']['length']>=(this['config']['minDaysForBaseline']||0x7)?_0x1476c8(0x17d)+this[_0x1476c8(0x25f)]['length']+'\x20Tage)':'Lernphase\x20('+this['dailyDigests'][_0x1476c8(0x278)]+'/'+(this[_0x1476c8(0x28c)][_0x1476c8(0x1eb)]||0x7)+')';await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x2f9fc0,'ack':!![]});}async[a0_0x560c35(0x137)](){const _0x56e612=a0_0x560c35,_0x399d02=this['config']['devices'];if(_0x399d02&&_0x399d02[_0x56e612(0x278)]>0x0){this[_0x56e612(0x21d)][_0x56e612(0x2c3)](_0x56e612(0x102)+_0x399d02[_0x56e612(0x278)]+_0x56e612(0x20a));for(const _0x1d6610 of _0x399d02){if(_0x1d6610['id']){await this['subscribeForeignStatesAsync'](_0x1d6610['id']);try{const _0x3e83b2=await this['getForeignStateAsync'](_0x1d6610['id']);if(_0x3e83b2)this[_0x56e612(0x12d)][_0x1d6610['id']]=_0x3e83b2[_0x56e612(0x1c8)];}catch(_0x4ce61f){}}}}}async[a0_0x560c35(0x1a5)](){const _0x1c9c32=a0_0x560c35,_0xcafed9=this[_0x1c9c32(0x28c)][_0x1c9c32(0x28b)]||[];if(_0xcafed9[_0x1c9c32(0x278)]>0x0){this[_0x1c9c32(0x21d)][_0x1c9c32(0x2c3)](_0x1c9c32(0x102)+_0xcafed9[_0x1c9c32(0x278)]+_0x1c9c32(0x19e));for(const _0x2c9741 of _0xcafed9){await this[_0x1c9c32(0x106)](_0x2c9741);}try{await this[_0x1c9c32(0x201)]();}catch(_0x3daa70){}}}async[a0_0x560c35(0x157)](){const _0x3d2194=a0_0x560c35,_0x3b0a30=this['config'][_0x3d2194(0x1c7)];this[_0x3d2194(0x28c)][_0x3d2194(0x178)]&&_0x3b0a30&&await this[_0x3d2194(0x106)](_0x3b0a30+_0x3d2194(0x1a6));}async[a0_0x560c35(0x132)](_0x5c726b){const _0x43d3ec=a0_0x560c35;let _0x46188f=_0x5c726b;_0x5c726b[_0x43d3ec(0x254)]('[')&&(_0x46188f=_0x5c726b['substring'](_0x5c726b[_0x43d3ec(0x1cc)](']')+0x1));if(_0x46188f===_0x43d3ec(0x179))await this['setStateAsync'](_0x43d3ec(0x1e7),{'val':![],'ack':!![]}),await this[_0x43d3ec(0x265)](_0x43d3ec(0x155),{'val':_0x43d3ec(0x14c),'ack':!![]}),this[_0x43d3ec(0x13d)]=![],this[_0x43d3ec(0x1e0)](_0x43d3ec(0x1f6),![]);else _0x46188f===_0x43d3ec(0x2b0)&&this[_0x43d3ec(0x1e0)](_0x43d3ec(0x1de),![],!![]);}async[a0_0x560c35(0x1e0)](_0x321555,_0x1b1519=![],_0x3225ef=![]){const _0x3a0d97=a0_0x560c35,_0x5997a5=this[_0x3a0d97(0x28c)];if(_0x5997a5[_0x3a0d97(0x178)]){let _0x23dc6e={};(_0x321555[_0x3a0d97(0x2aa)](_0x3a0d97(0x1ff))||_0x3225ef)&&(_0x23dc6e={'reply_markup':{'inline_keyboard':[[{'text':_0x3a0d97(0x1ec),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x3a0d97(0x232),'callback_data':_0x3a0d97(0x2b0)}]]}}),await this['sendToAsync'](_0x5997a5['notifyTelegramInstance'],_0x3a0d97(0x2b3),{'text':_0x321555,'user':_0x5997a5['notifyTelegramRecipient'],..._0x23dc6e});}if(_0x5997a5['notifyPushoverEnabled']){let _0x32aa58={'message':_0x321555,'title':_0x3225ef?_0x3a0d97(0x2bd):'Cogni-Living','priority':_0x3225ef?0x2:0x1,'device':_0x5997a5[_0x3a0d97(0x220)]};_0x3225ef&&(_0x32aa58['retry']=0x1e,_0x32aa58[_0x3a0d97(0x2ad)]=0xe10,_0x32aa58[_0x3a0d97(0x130)]='siren'),await this[_0x3a0d97(0x2cb)](_0x5997a5[_0x3a0d97(0x1c9)],'send',_0x32aa58);}_0x5997a5[_0x3a0d97(0x27e)]&&await this[_0x3a0d97(0x2cb)](_0x5997a5[_0x3a0d97(0x269)],'send',{'text':_0x321555,'to':_0x5997a5[_0x3a0d97(0x1c3)]});}async[a0_0x560c35(0x201)](){const _0x132174=a0_0x560c35;try{const _0x135953=this[_0x132174(0x28c)][_0x132174(0x28b)]||[];let _0x1ed92d=![];const _0xf2d739=[];for(const _0x196afe of _0x135953){try{const _0x1fd9d1=await this[_0x132174(0x11d)](_0x196afe);if(_0x1fd9d1&&(_0x1fd9d1['val']===!![]||_0x1fd9d1[_0x132174(0x1c8)]===_0x132174(0x239)||_0x1fd9d1[_0x132174(0x1c8)]===0x1)){_0x1ed92d=!![];const _0x48c1e8=await this[_0x132174(0x29c)](_0x196afe);let _0x5807cf=_0x196afe;_0x48c1e8&&_0x48c1e8[_0x132174(0x163)]&&_0x48c1e8[_0x132174(0x163)][_0x132174(0x1d2)]&&(_0x5807cf=typeof _0x48c1e8[_0x132174(0x163)][_0x132174(0x1d2)]===_0x132174(0x1fe)?_0x48c1e8[_0x132174(0x163)][_0x132174(0x1d2)]['de']||_0x48c1e8[_0x132174(0x163)][_0x132174(0x1d2)]['en']:_0x48c1e8[_0x132174(0x163)]['name']),_0xf2d739[_0x132174(0x13a)](_0x5807cf);}}catch(_0x5c6587){}}return await this[_0x132174(0x265)]('system.presenceWho',{'val':_0xf2d739['join'](',\x20'),'ack':!![]}),_0x1ed92d&&(this['exitTimer']&&(this[_0x132174(0x21d)][_0x132174(0x2c3)]('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),this[_0x132174(0x141)]()),!this['isPresent']&&this[_0x132174(0x124)]===SYSTEM_MODES[_0x132174(0x17e)]&&await this['setPresence'](!![])),_0x1ed92d;}catch(_0x3c08bc){return this['log']['error'](_0x132174(0x22b)+_0x3c08bc['message']),![];}}[a0_0x560c35(0x1b1)](){const _0x1f08e3=a0_0x560c35;this[_0x1f08e3(0x141)](),this[_0x1f08e3(0x299)]=!![],this['exitGraceTimer']=setTimeout(()=>{const _0x1c6425=_0x1f08e3;this[_0x1c6425(0x299)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x1f08e3(0x28d)]=setTimeout(()=>{const _0x5edfac=_0x1f08e3;this[_0x5edfac(0x22e)](![]),this[_0x5edfac(0x28d)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x560c35(0x141)](){const _0x5ce431=a0_0x560c35;if(this[_0x5ce431(0x28d)])clearTimeout(this[_0x5ce431(0x28d)]);if(this['exitGraceTimer'])clearTimeout(this[_0x5ce431(0x223)]);this[_0x5ce431(0x28d)]=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![];}async['setPresence'](_0x24f3ef){const _0x3419ee=a0_0x560c35;if(this[_0x3419ee(0x283)]===_0x24f3ef)return;this[_0x3419ee(0x283)]=_0x24f3ef,await this[_0x3419ee(0x265)](_0x3419ee(0x198),{'val':_0x24f3ef,'ack':!![]});}async['executeAutomationAction'](){const _0x3c2d37=a0_0x560c35;try{const _0x3e9cb3=await this[_0x3c2d37(0x20c)]('analysis.automation.targetId'),_0x2d00f5=await this['getStateAsync'](_0x3c2d37(0x12f));if(_0x3e9cb3&&_0x3e9cb3[_0x3c2d37(0x1c8)]&&_0x2d00f5){const _0x2d7777=_0x3e9cb3[_0x3c2d37(0x1c8)];let _0x1e6248=_0x2d00f5[_0x3c2d37(0x1c8)];try{_0x1e6248=JSON['parse'](_0x1e6248);}catch(_0x380d0e){}this[_0x3c2d37(0x21d)][_0x3c2d37(0x2c3)](_0x3c2d37(0x209)+_0x2d7777+_0x3c2d37(0x289)+_0x1e6248),await this[_0x3c2d37(0x1f7)](_0x2d7777,_0x1e6248);}else this['log'][_0x3c2d37(0x16a)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x59b7c9){this[_0x3c2d37(0x21d)]['error'](_0x3c2d37(0x15e)+_0x59b7c9[_0x3c2d37(0x263)]);}}}if(require[a0_0x560c35(0x228)]!==module)module[a0_0x560c35(0x159)]=_0x49b367=>new CogniLiving(_0x49b367);else new CogniLiving();