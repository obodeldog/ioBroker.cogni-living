const a0_0x297bed=a0_0x13f4;function a0_0x491b(){const _0x2072f0=['subscribeStates','modeResetJob','N/A','Sending\x20notification:\x20\x22','message','simple-api.','calendarSelection','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','\x20Phase\x203:\x20DRIFT\x20ACTIVE.','setupModeResetScheduler','analysis.alertReason','values','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','online','Drift\x20Sched\x20Error:\x20','analysis.health.notes','actual_temperature','analysis.automation.description','unreach','direction','Health\x20&\x20Sleep\x20Analysis','LTM.baselineStatus','toString','native','sort','isPresent','sound','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','NORMAL','ltmLtbWindowDays','devices','boolean','runAutopilot','Cogni-Living','Comfort\x20Summary','switch','filter','targetId','LTM.driftAnalysis.driftDetails','substring','details','bind','12PmDPZp','ack','cover','object','uuid','text','TEST-PRO-KEY','briefingJob','Kein\x20API\x20Key\x20konfiguriert!','runGeminiAnalysis','setupLtmScheduler','notifyTelegramEnabled','triggerDailyDigest','initSystemConfig','analysis.automation.targetValue','_calName','analysis.automation.patternDetected','\x20for\x20interactive\x20buttons...','name','analysisHistory','baselineDrift','getForeignStateAsync','4663498jGDCzl','cogni-living','find','testNotification','echarts.','LTM.driftAnalysis.lastCheck','getWeatherContext','Party','\x20=\x20','exitGraceTimer','lastAlertState','system.isPresent','alertReason','Action','main','button','COGNI_CONFIRM_OK','fault','parse','startsWith','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','motion','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','getSystemUUID','from','\x20min).','sendNotification','analysis.automation.targetId','checkSystemObjects','AI\x20Emergency\x20Status','accuweather.0','setForeignStateAsync','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','System\x20Mode','licenseKey','PARTY','getLtmData','(((.+)+)+)+$','version','notifyTelegramInstance','daswetter','config_pending','exports','common','loadDailyDigests','Error\x20reading\x20calendar\x20table:\x20','event','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','openweathermap.0','System\x20Status\x20&\x20Control','Wetter:\x20Deaktiviert','ready','setupDriftAnalysisScheduler','analysis.feedbackHistory','Keine\x20neuen\x20Automatisierungs-Muster\x20erkannt.','isGracePeriodActive','type','KALENDER:\x20','none','GUEST','history.','Comfort\x20Suggestion',')\x20verdÃ¤chtig\x20still?\x20Fehlt\x20eine\x20Routine?\x20Wenn\x20ja\x20->\x20ALARM.\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20Akut\x20(vs.\x20STB):\x20Weicht\x20das\x20heutige\x20Verhalten\x20stark\x20von\x20den\x20letzten\x2014\x20Tagen\x20ab?\x20Wenn\x20ja\x20->\x20WARNUNG.\x0a\x20\x20\x20\x20\x20\x20\x20\x20Ignoriere\x20Fehlalarme\x20durch\x20Kontext:\x20','notifyEmailInstance','analysis.health.sleepScore','analysis.health','trim','presence','description','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','isArray','callback','WETTER:\x20Keine\x20Daten\x20gefunden','Last\x20raw\x20event','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','indicator.alarm','connection','dailyDigests','isExit','abortExitTimer','endsWith','.forecast.current.state','length','Raw\x20Log','createAllObjects','Target\x20Value','\x20Tage)','ltmDriftCheckIntervalHours','0\x203\x20*\x20*\x20*','WETTER\x20ERROR:\x20','sendToAsync','analysis.automation','6886128YXYKtd','config','checkWifiPresence','accuweather','onStateChange','checkLtmDriftObjects','ltmJob','Starting\x20Autopilot\x20(','runBaselineDriftAnalysis','activity','No\x20recorded\x20events\x20yet.','json','lastCheck','logDuplicates','weatherunderground.0','\x20*\x20*\x20*','Adapter','blind','search','detected','checkLicense','scanForDevices','analysis.automation.triggerAction','Feedback\x20saved:\x20','calendarInstance','events.history','javascript.','system.meta.uuid','off','aiPersona','checkLtmObjects','generateContent','value','âš ï¸\x20Alarm','setStateAsync','loadRawEventLog','getCalendarContext','patternDetected','sensorLastValues','indexOf','system.','working','exitTimer','unknown','createDailyDigest','notifyTelegramRecipient','Subscribing\x20to\x20','extendObjectAsync','useCalendar','lowbat','.\x20PRÃ„SENZ:\x20','scriptEnabled','handleTelegramResponse','loadSystemMode','analysis.automation.autoApply','string','.Summary.Current','KALENDER\x20ERROR:\x20','Drift\x20Details','analysis.lastResult','Restlessness\x20Level','subscribeForeignStatesAsync','COGNI_REQUEST_CALL','guest','.communicate.request','149590vRMvcM','getForeignObjectAsync','cogni-living\x20adapter\x20starting\x20(v','flot.','tryParse','Processing\x20Status','siren','eventHistory','inactivityThresholdHours','events.lastEvent','info','isEmergency','Activity\x20Summary','KALENDER:\x20Keine\x20Daten','Deviation','presenceDevices','valve','startExitTimer','2985834ujHzjS','saveRawEventLog','replace','send','setupTelegramListener','BUTLER\x20Execution\x20Error:\x20','getEnums','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','minDaysForBaseline','node-schedule','feedbackHistory','onUnload','isAlert','ðŸš¨\x20EMERGENCY','Logbook','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22patternDetected\x22:\x20bool,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x22,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22execution\x22:\x20{\x20\x22targetId\x22:\x20\x22string|null\x22,\x20\x22targetValue\x22:\x20\x22boolean|number|null\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22string\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','icons-mfd.','de-DE','Scheduling\x20Morning\x20Briefing\x20for\x20','split','stringify','system.mode','Analysis\x20Error:\x20','Trigger\x20Digest','.\x20PERSONA:\x20','map','briefingEnabled','apply','rawEventLog','analysis.isEmergency','PRO-','Daily\x20Digests','Nein','initPresenceSubscriptions','now','namespace','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','warn','VACATION','geminiApiKey','Last\x20Check','openweathermap','slice','Pattern\x20Detected','location','Phase\x202:\x20ACUTE\x20MONITORING.\x20STB\x20(Last\x2014d):\x20','initSensorSubscriptions','sendTo','uuid-not-found','channel','\x20sensors...','set_temperature','state','party','normal','Gemini\x20Init\x20Error:\x20','scanDevices','city','Lernphase\x20(','genAI','automationProposal','onReady','processSensorEvent','error','scheduleJob','geminiModel','notifyPushoverRecipient','admin.','analysis.automation.suggestedAction','number','cancel','log','Health\x20Notes','temperature','Normal','LTM.processingStatus','ltmStbWindowDays','power','4yjNWqC','execution','stick_unreach','currentposition','08:00','maintenance','driftAnalysisTimer','getStateAsync','782271byzFtf','summary','systemConfig','sendMorningBriefing','updateBaselineStatus','N/A\x20(Learning)','longitude','autoApply','ðŸ“¡\x20Hooking\x20into\x20','Deaktiviert\x20(Pro-Feature)','Error\x20checking\x20WiFi:\x20','includes','AI\x20Alert\x20Status','text.alarm','\x20presence\x20devices...','notifyEmailRecipient','humidity','analysis.comfortSuggestion','15980553tWMcLw','vacation','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','unshift','val','onMessage','analysis.activitySummary','time','Trigger\x20Analysis','indicator','updateAnalysisHistory','getCalendarNames\x20Error:\x20','setState','\x0a\x20\x20\x20\x20\x20\x20\x20\x20CRITICAL\x20SAFETY\x20CHECK:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20Sofort/Ad-Hoc:\x20Ist\x20es\x20jetzt\x20(','setupBriefingScheduler','1038045mzVgeT','status','shutter','scriptProblem','.data.table','toISOString','timestamp','analysis.triggerBriefing','analysis.health.restlessness','info.','level','command','occupancy','setHours','Triggered\x20analysis\x20but\x20Gemini\x20AI\x20is\x20not\x20initialized!\x20Check\x20API\x20Key.','getGenerativeModel','date','analysis.analysisHistory','Target\x20ID','currentSystemMode','isProVersion','reachable','PRIORITÃ„T:\x20Gesundheit\x20und\x20Sicherheit\x20fÃ¼r\x20Senioren\x20(AAL).\x20Erkenne\x20InaktivitÃ¤t,\x20potenzielle\x20StÃ¼rze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20nÃ¤chtliche\x20Unruhe.','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','getOverviewData','notifyPushoverInstance',')\x20-\x20OBFUSCATION\x20SAFE\x20MODE','systemUUID','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','update','initHistory','Phase\x201:\x20Learning\x20(No\x20Baseline).\x20Rely\x20on\x20common\x20sense.','join','Feedback\x20Log','LTM.driftAnalysis.baselineDrift','analysis.trigger','Briefing\x20Sched\x20Error:\x20','uuid-error','firmware','analysisTimer','Drift\x20Analysis','Aktiv\x20(','setObjectNotExistsAsync','Sleep\x20Score\x20(0-100)','splice','comfort','dutycycle','useWeather','long','application/json','brightness','Auto\x20Apply\x20Rule','vis.','KALENDER:\x20Keine\x20relevanten\x20Termine','targetValue','analysis.isAlert','LTM','LTM.driftAnalysis','setPresence'];a0_0x491b=function(){return _0x2072f0;};return a0_0x491b();}(function(_0x4f63dd,_0x5542db){const _0x23d488=a0_0x13f4,_0x541381=_0x4f63dd();while(!![]){try{const _0x3e4bc0=-parseInt(_0x23d488(0x213))/0x1+parseInt(_0x23d488(0x1aa))/0x2+-parseInt(_0x23d488(0x1bc))/0x3*(-parseInt(_0x23d488(0x20b))/0x4)+parseInt(_0x23d488(0x234))/0x5*(parseInt(_0x23d488(0x299))/0x6)+-parseInt(_0x23d488(0x2af))/0x7+-parseInt(_0x23d488(0x169))/0x8+parseInt(_0x23d488(0x225))/0x9;if(_0x3e4bc0===_0x5542db)break;else _0x541381['push'](_0x541381['shift']());}catch(_0x36a363){_0x541381['push'](_0x541381['shift']());}}}(a0_0x491b,0xe8569));const a0_0x9bff72=(function(){let _0x2f56b3=!![];return function(_0x5d2b23,_0x2452d7){const _0x18e722=_0x2f56b3?function(){const _0x35dce1=a0_0x13f4;if(_0x2452d7){const _0x9e0236=_0x2452d7[_0x35dce1(0x1d7)](_0x5d2b23,arguments);return _0x2452d7=null,_0x9e0236;}}:function(){};return _0x2f56b3=![],_0x18e722;};}()),a0_0x5981d3=a0_0x9bff72(this,function(){const _0x4bf54e=a0_0x13f4;return a0_0x5981d3[_0x4bf54e(0x285)]()['search'](_0x4bf54e(0x132))['toString']()['constructor'](a0_0x5981d3)[_0x4bf54e(0x17b)](_0x4bf54e(0x132));});a0_0x5981d3();'use strict';function a0_0x13f4(_0x19c9b7,_0x1d6233){const _0x30bb70=a0_0x491b();return a0_0x13f4=function(_0x5981d3,_0x9bff72){_0x5981d3=_0x5981d3-0x11f;let _0x491b7e=_0x30bb70[_0x5981d3];return _0x491b7e;},a0_0x13f4(_0x19c9b7,_0x1d6233);}const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x297bed(0x1c5)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x297bed(0x165),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x297bed(0x208),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x297bed(0x284),LTM_DP_DRIFT_CHANNEL=a0_0x297bed(0x26d),LTM_DP_DRIFT_STATUS=a0_0x297bed(0x256),LTM_DP_DRIFT_DETAILS=a0_0x297bed(0x295),LTM_DP_DRIFT_LAST_CHECK=a0_0x297bed(0x2b4),SYSTEM_DP_MODE=a0_0x297bed(0x1d1),HARD_IGNORE_TERMS=[a0_0x297bed(0x237),a0_0x297bed(0x19c),a0_0x297bed(0x251),a0_0x297bed(0x281),a0_0x297bed(0x19a),'rssi',a0_0x297bed(0x159),a0_0x297bed(0x210),a0_0x297bed(0x1fc),a0_0x297bed(0x2c0),a0_0x297bed(0x192),a0_0x297bed(0x282),a0_0x297bed(0x20d),a0_0x297bed(0x136),a0_0x297bed(0x262),a0_0x297bed(0x25a),a0_0x297bed(0x249),'link_quality'],GENERIC_NAMES=['targetposition',a0_0x297bed(0x20e),a0_0x297bed(0x1f1),a0_0x297bed(0x23e),a0_0x297bed(0x189),a0_0x297bed(0x266),'on',a0_0x297bed(0x185),a0_0x297bed(0x292),'position',a0_0x297bed(0x236),a0_0x297bed(0x17a),a0_0x297bed(0x29b),a0_0x297bed(0x235),a0_0x297bed(0x122),a0_0x297bed(0x150),a0_0x297bed(0x240),a0_0x297bed(0x206),a0_0x297bed(0x223),a0_0x297bed(0x20a),'energy','setpoint',a0_0x297bed(0x1ba),a0_0x297bed(0x27f),a0_0x297bed(0x1f0)],ADAPTER_BLACKLIST=[a0_0x297bed(0x191),a0_0x297bed(0x200),a0_0x297bed(0x23d),a0_0x297bed(0x268),a0_0x297bed(0x149),'material.',a0_0x297bed(0x1cc),a0_0x297bed(0x1ad),a0_0x297bed(0x2b3),a0_0x297bed(0x183),a0_0x297bed(0x274)],SYSTEM_MODES={'NORMAL':a0_0x297bed(0x1f3),'VACATION':a0_0x297bed(0x226),'PARTY':a0_0x297bed(0x1f2),'GUEST':a0_0x297bed(0x1a8)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x297bed(0x130)],SYSTEM_MODES[a0_0x297bed(0x148)]],PERSONA_MAPPING={'generic':a0_0x297bed(0x227),'senior_aal':a0_0x297bed(0x24a),'family':a0_0x297bed(0x152),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':'PRIORITÃ„T:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungewÃ¶hnliche\x20Anwesenheit.'};class CogniLiving extends utils[a0_0x297bed(0x179)]{constructor(_0x506a3c){const _0x45f079=a0_0x297bed;super({..._0x506a3c,'name':_0x45f079(0x2b0)}),this[_0x45f079(0x1b1)]=[],this[_0x45f079(0x2ac)]=[],this[_0x45f079(0x1c6)]=[],this[_0x45f079(0x1d8)]=[],this[_0x45f079(0x15a)]=[],this[_0x45f079(0x18f)]={},this[_0x45f079(0x215)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x45f079(0x288)]=!![],this[_0x45f079(0x193)]=null,this[_0x45f079(0x2b8)]=null,this['isGracePeriodActive']=![],this[_0x45f079(0x1f8)]=null,this['geminiModel']=null,this[_0x45f079(0x247)]=SYSTEM_MODES[_0x45f079(0x28b)],this['isProVersion']=![],this[_0x45f079(0x2b9)]=![],this[_0x45f079(0x24f)]=_0x45f079(0x194),this['analysisTimer']=null,this[_0x45f079(0x16f)]=null,this[_0x45f079(0x270)]=null,this[_0x45f079(0x211)]=null,this[_0x45f079(0x2a0)]=null,this['on'](_0x45f079(0x140),this[_0x45f079(0x1fa)]['bind'](this)),this['on']('stateChange',this[_0x45f079(0x16d)][_0x45f079(0x298)](this)),this['on']('unload',this['onUnload'][_0x45f079(0x298)](this)),this['on'](_0x45f079(0x273),this[_0x45f079(0x22a)]['bind'](this));}async['onReady'](){const _0x45921b=a0_0x297bed;this[_0x45921b(0x204)][_0x45921b(0x1b4)](_0x45921b(0x1ac)+this[_0x45921b(0x133)]+_0x45921b(0x24e)),await this['initZombies'](),this[_0x45921b(0x16a)]['licenseKey']=this[_0x45921b(0x16a)][_0x45921b(0x12f)]||'';try{this[_0x45921b(0x248)]=await this['checkLicense'](this[_0x45921b(0x16a)][_0x45921b(0x12f)]);}catch(_0x4c2060){}if(!this[_0x45921b(0x16a)]['inactivityThresholdHours']||this[_0x45921b(0x16a)]['inactivityThresholdHours']<0.1)this[_0x45921b(0x16a)][_0x45921b(0x1b2)]=0xc;await this[_0x45921b(0x252)](),await this[_0x45921b(0x2a6)]();if(this[_0x45921b(0x16a)][_0x45921b(0x1e4)])try{this[_0x45921b(0x1f8)]=new GoogleGenerativeAI(this[_0x45921b(0x16a)][_0x45921b(0x1e4)]),this['geminiModel']=this[_0x45921b(0x1f8)][_0x45921b(0x243)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x45921b(0x265)}}),this[_0x45921b(0x204)][_0x45921b(0x1b4)]('Gemini\x20AI\x20initialized.');}catch(_0x33c56c){this['log'][_0x45921b(0x1fc)](_0x45921b(0x1f4)+_0x33c56c[_0x45921b(0x273)]);}await this['createAllObjects'](),await this[_0x45921b(0x19e)](),await this[_0x45921b(0x18c)](),await this[_0x45921b(0x139)](),this[_0x45921b(0x26f)](_0x45921b(0x257)),this[_0x45921b(0x26f)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x45921b(0x1d1)),this[_0x45921b(0x26f)](_0x45921b(0x23b)),this[_0x45921b(0x26f)](_0x45921b(0x17f)),this[_0x45921b(0x26f)](_0x45921b(0x19f)),await this['initSensorSubscriptions'](),await this[_0x45921b(0x1dd)](),await this[_0x45921b(0x1c0)]();if(this[_0x45921b(0x25b)])clearInterval(this[_0x45921b(0x25b)]);const _0x32b346=this[_0x45921b(0x16a)]['analysisInterval']||0xf;_0x32b346>0x0&&(this['log']['info'](_0x45921b(0x170)+_0x32b346+_0x45921b(0x126)),this[_0x45921b(0x25b)]=setInterval(()=>{const _0xb125b0=_0x45921b;this[_0xb125b0(0x28f)]();},_0x32b346*0x3c*0x3e8)),this[_0x45921b(0x2a3)](),this[_0x45921b(0x278)](),this[_0x45921b(0x141)](),this['setupBriefingScheduler']();}[a0_0x297bed(0x1c7)](_0x3f9d75){const _0x2ec35e=a0_0x297bed;if(this[_0x2ec35e(0x25b)])clearInterval(this[_0x2ec35e(0x25b)]);if(this[_0x2ec35e(0x211)])clearInterval(this['driftAnalysisTimer']);if(this[_0x2ec35e(0x16f)])this[_0x2ec35e(0x16f)][_0x2ec35e(0x203)]();if(this['modeResetJob'])this[_0x2ec35e(0x270)][_0x2ec35e(0x203)]();if(this[_0x2ec35e(0x2a0)])this['briefingJob'][_0x2ec35e(0x203)]();if(this[_0x2ec35e(0x193)])clearTimeout(this['exitTimer']);if(this[_0x2ec35e(0x2b8)])clearTimeout(this[_0x2ec35e(0x2b8)]);_0x3f9d75();}async[a0_0x297bed(0x16d)](_0x20948f,_0x19ab54){const _0x25170f=a0_0x297bed;if(!_0x19ab54)return;if(_0x20948f['includes']('telegram')&&_0x20948f[_0x25170f(0x15d)]('communicate.request')&&_0x19ab54[_0x25170f(0x229)]){await this[_0x25170f(0x19d)](_0x19ab54[_0x25170f(0x229)]);return;}if(_0x20948f===this[_0x25170f(0x1df)]+'.'+SYSTEM_DP_MODE){_0x19ab54[_0x25170f(0x229)]&&Object['values'](SYSTEM_MODES)[_0x25170f(0x21e)](_0x19ab54[_0x25170f(0x229)])&&(this['currentSystemMode']=_0x19ab54[_0x25170f(0x229)],_0x19ab54[_0x25170f(0x229)]===SYSTEM_MODES[_0x25170f(0x1e3)]?await this[_0x25170f(0x26e)](![]):await this['setPresence'](!![]));if(!_0x19ab54[_0x25170f(0x29a)])this['setState'](_0x20948f,{'val':this[_0x25170f(0x247)],'ack':!![]});return;}if(!_0x19ab54[_0x25170f(0x29a)]){_0x20948f['includes'](_0x25170f(0x257))&&_0x19ab54[_0x25170f(0x229)]&&(this['setState'](_0x20948f,{'val':![],'ack':!![]}),this[_0x25170f(0x2a2)]());if(_0x20948f[_0x25170f(0x21e)](_0x25170f(0x2a5))&&_0x19ab54[_0x25170f(0x229)]){this['setState'](_0x20948f,{'val':![],'ack':!![]});if(this[_0x25170f(0x248)])this[_0x25170f(0x195)]();}_0x20948f['includes']('triggerBriefing')&&_0x19ab54['val']&&(this[_0x25170f(0x231)](_0x20948f,{'val':![],'ack':!![]}),this['sendMorningBriefing']());_0x20948f[_0x25170f(0x21e)]('automation.triggerAction')&&_0x19ab54[_0x25170f(0x229)]&&(this[_0x25170f(0x231)](_0x20948f,{'val':![],'ack':!![]}),this['executeAutomationAction']());return;}if(this[_0x25170f(0x16a)][_0x25170f(0x1b9)]&&this[_0x25170f(0x16a)][_0x25170f(0x1b9)][_0x25170f(0x21e)](_0x20948f)){await this['checkWifiPresence']();return;}const _0x1c3256=(this['config'][_0x25170f(0x28d)]||[])[_0x25170f(0x2b1)](_0x234896=>_0x234896['id']===_0x20948f);if(_0x1c3256)this[_0x25170f(0x1fb)](_0x20948f,_0x19ab54,_0x1c3256);}async[a0_0x297bed(0x1c0)](){const _0x57c5be=a0_0x297bed,_0x5964e9=this[_0x57c5be(0x16a)][_0x57c5be(0x134)];this['config']['notifyTelegramEnabled']&&_0x5964e9&&(this[_0x57c5be(0x204)][_0x57c5be(0x1b4)](_0x57c5be(0x21b)+_0x5964e9+_0x57c5be(0x2aa)),await this['subscribeForeignStatesAsync'](_0x5964e9+_0x57c5be(0x1a9)));}async[a0_0x297bed(0x19d)](_0x1df920){const _0x174cce=a0_0x297bed;let _0x54046f=_0x1df920;_0x1df920['startsWith']('[')&&(_0x54046f=_0x1df920[_0x174cce(0x296)](_0x1df920[_0x174cce(0x190)](']')+0x1));if(_0x54046f===_0x174cce(0x2bf))this['log']['info'](_0x174cce(0x250)),await this[_0x174cce(0x18b)](_0x174cce(0x26b),{'val':![],'ack':!![]}),await this[_0x174cce(0x18b)](_0x174cce(0x279),{'val':_0x174cce(0x121),'ack':!![]}),this['lastAlertState']=![],this[_0x174cce(0x127)](_0x174cce(0x13c),![]);else _0x54046f===_0x174cce(0x1a7)&&(this[_0x174cce(0x204)]['warn'](_0x174cce(0x276)),this['sendNotification'](_0x174cce(0x1e1),![],!![]));}async[a0_0x297bed(0x22a)](_0x55bf42){const _0x274fcb=a0_0x297bed;if(typeof _0x55bf42===_0x274fcb(0x29c)&&_0x55bf42[_0x274fcb(0x273)])try{if(_0x55bf42['command']==='testApiKey'){}else{if(_0x55bf42[_0x274fcb(0x23f)]===_0x274fcb(0x2b2)){}else{if(_0x55bf42[_0x274fcb(0x23f)]===_0x274fcb(0x131)){if(!this[_0x274fcb(0x248)])return this['sendTo'](_0x55bf42[_0x274fcb(0x125)],_0x55bf42[_0x274fcb(0x23f)],{'success':![],'isPro':![]},_0x55bf42[_0x274fcb(0x154)]);let _0x2e6011={'status':_0x274fcb(0x271),'details':'','lastCheck':0x0};try{_0x2e6011['status']=(await this[_0x274fcb(0x212)](LTM_DP_DRIFT_STATUS))[_0x274fcb(0x229)],_0x2e6011[_0x274fcb(0x297)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x274fcb(0x229)],_0x2e6011[_0x274fcb(0x175)]=(await this[_0x274fcb(0x212)](LTM_DP_DRIFT_LAST_CHECK))[_0x274fcb(0x229)];}catch(_0x421303){}const _0x140aa9=this['analysisHistory']||[];this[_0x274fcb(0x1ec)](_0x55bf42[_0x274fcb(0x125)],_0x55bf42[_0x274fcb(0x23f)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x274fcb(0x15a)],'driftAnalysis':_0x2e6011,'analysisHistory':_0x140aa9},_0x55bf42[_0x274fcb(0x154)]);}else{if(_0x55bf42[_0x274fcb(0x23f)]===_0x274fcb(0x24c)){const _0x1e1860=this['dailyDigests'][_0x274fcb(0x15f)],_0x4bfa5f=this[_0x274fcb(0x1b1)][_0x274fcb(0x293)](_0x4ce6d8=>_0x4ce6d8[_0x274fcb(0x23a)]>new Date()[_0x274fcb(0x241)](0x0,0x0,0x0,0x0))[_0x274fcb(0x15f)];let _0x1951a1={'status':_0x274fcb(0x271)};try{_0x1951a1[_0x274fcb(0x235)]=(await this[_0x274fcb(0x212)](LTM_DP_DRIFT_STATUS))[_0x274fcb(0x229)];}catch(_0x521883){}let _0x1904af=null;!this[_0x274fcb(0x1fe)]&&(_0x1904af=this[_0x274fcb(0x16a)][_0x274fcb(0x1e4)]?'KI-Modell\x20nicht\x20initialisiert\x20(Neustart\x20erforderlich?)':_0x274fcb(0x2a1));let _0x50b0a9={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x5e75b1=await this[_0x274fcb(0x212)](_0x274fcb(0x2a9)),_0xb153d5=await this[_0x274fcb(0x212)](_0x274fcb(0x280)),_0x5b230d=await this[_0x274fcb(0x212)](_0x274fcb(0x128)),_0x329215=await this[_0x274fcb(0x212)](_0x274fcb(0x2a7)),_0x5ee43e=await this[_0x274fcb(0x212)](_0x274fcb(0x19f));_0x5e75b1&&_0x5e75b1['val']&&(_0x50b0a9[_0x274fcb(0x17c)]=!![],_0x50b0a9[_0x274fcb(0x151)]=_0xb153d5?_0xb153d5['val']:'',_0x50b0a9[_0x274fcb(0x294)]=_0x5b230d?_0x5b230d['val']:'',_0x50b0a9[_0x274fcb(0x26a)]=_0x329215?_0x329215[_0x274fcb(0x229)]:''),_0x50b0a9[_0x274fcb(0x21a)]=_0x5ee43e?!!_0x5ee43e['val']:![];}catch(_0x3d3da8){}this['sendTo'](_0x55bf42[_0x274fcb(0x125)],_0x55bf42[_0x274fcb(0x23f)],{'success':!![],'eventHistory':this[_0x274fcb(0x1b1)][_0x274fcb(0x1e7)](0x0,0xf),'stats':{'digestCount':_0x1e1860,'eventCountToday':_0x4bfa5f,'driftStatus':_0x1951a1[_0x274fcb(0x235)],'isPresent':this[_0x274fcb(0x288)],'minDays':this[_0x274fcb(0x16a)][_0x274fcb(0x1c4)]||0x7,'stbDays':this[_0x274fcb(0x16a)][_0x274fcb(0x209)]||0xe,'ltbDays':this[_0x274fcb(0x16a)][_0x274fcb(0x28c)]||0x3c,'systemError':_0x1904af},'automation':_0x50b0a9},_0x55bf42[_0x274fcb(0x154)]);}else{if(_0x55bf42[_0x274fcb(0x23f)]===_0x274fcb(0x1c2)){}else{if(_0x55bf42[_0x274fcb(0x23f)]===_0x274fcb(0x1f5)){}else{if(_0x55bf42['command']==='getCalendarNames'){}}}}}}}}catch(_0x365571){}}async[a0_0x297bed(0x1fb)](_0x57d68d,_0x3cc1c8,_0x4e22ed){const _0x1adcc6=a0_0x297bed;if(!_0x4e22ed[_0x1adcc6(0x176)]&&this[_0x1adcc6(0x18f)][_0x57d68d]===_0x3cc1c8[_0x1adcc6(0x229)])return;this[_0x1adcc6(0x18f)][_0x57d68d]=_0x3cc1c8[_0x1adcc6(0x229)];if(this[_0x1adcc6(0x144)])return;const _0x3a491c=await this[_0x1adcc6(0x16b)]();if(_0x3a491c){if(!this[_0x1adcc6(0x288)])await this[_0x1adcc6(0x26e)](!![]);}else{const _0x2a9ff1=_0x4e22ed[_0x1adcc6(0x15b)]===!![];if(_0x2a9ff1)this[_0x1adcc6(0x1bb)]();else{if(this[_0x1adcc6(0x193)])this[_0x1adcc6(0x15c)]();if(!this[_0x1adcc6(0x288)]&&this[_0x1adcc6(0x247)]===SYSTEM_MODES[_0x1adcc6(0x28b)])await this['setPresence'](!![]);}}const _0x4cf818={'timestamp':_0x3cc1c8['ts'],'id':_0x57d68d,'name':_0x4e22ed[_0x1adcc6(0x2ab)],'value':_0x3cc1c8['val'],'location':_0x4e22ed[_0x1adcc6(0x1e9)],'type':_0x4e22ed[_0x1adcc6(0x145)]};this[_0x1adcc6(0x1b1)][_0x1adcc6(0x228)](_0x4cf818);if(this[_0x1adcc6(0x1b1)][_0x1adcc6(0x15f)]>HISTORY_MAX_SIZE)this[_0x1adcc6(0x1b1)]['pop']();await this['setStateAsync']('events.lastEvent',{'val':JSON[_0x1adcc6(0x1d0)](_0x4cf818),'ack':!![]}),await this[_0x1adcc6(0x18b)](_0x1adcc6(0x182),{'val':JSON['stringify'](this[_0x1adcc6(0x1b1)]),'ack':!![]}),this[_0x1adcc6(0x1d8)]['push']({'timestamp':new Date(_0x3cc1c8['ts'])[_0x1adcc6(0x239)](),'sensorName':_0x4e22ed[_0x1adcc6(0x2ab)],'location':_0x4e22ed[_0x1adcc6(0x1e9)],'value':_0x3cc1c8['val']}),await this['saveRawEventLog']();}async['runGeminiAnalysis'](_0x53067a=''){const _0x2306bd=a0_0x297bed;if(!this[_0x2306bd(0x1fe)]){this['log'][_0x2306bd(0x1e2)](_0x2306bd(0x242));return;}const _0x439275=this['eventHistory'][_0x2306bd(0x15f)]>0x0?this[_0x2306bd(0x1b1)]:[{'note':_0x2306bd(0x173)}],_0x3b1d04=PERSONA_MAPPING[this[_0x2306bd(0x16a)][_0x2306bd(0x186)]||'generic'],_0x1a3c95=this['config']['livingContext']||'',_0x1afff2=this['currentSystemMode'],_0x38b6dd=await this[_0x2306bd(0x2b5)](),_0x110d7d=await this['getCalendarContext'](),_0x2b4e1a=(_0x38b6dd+'\x20'+_0x110d7d)[_0x2306bd(0x14f)](),_0x17da66=new Date(),_0x4cc742=_0x17da66['toLocaleString'](_0x2306bd(0x1cd),{'weekday':_0x2306bd(0x264),'hour':'2-digit','minute':'2-digit'});let _0x34af13=_0x2306bd(0x253);const _0x469130=this[_0x2306bd(0x15a)][_0x2306bd(0x15f)];if(this[_0x2306bd(0x248)]&&_0x469130>=(this[_0x2306bd(0x16a)][_0x2306bd(0x1c4)]||0x7)){const _0x142419=this['dailyDigests']['slice'](-(this[_0x2306bd(0x16a)][_0x2306bd(0x209)]||0xe));_0x34af13=_0x2306bd(0x1ea)+JSON[_0x2306bd(0x1d0)](_0x142419)+'.';if(_0x469130>=0x1e)_0x34af13+=_0x2306bd(0x277);}const _0x2d5646=_0x2306bd(0x232)+_0x4cc742+_0x2306bd(0x14b)+_0x2b4e1a+_0x2306bd(0x28a),_0x1ca5a3='\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUTOMATION\x20RULES\x20(THE\x20BUTLER):\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Only\x20propose\x20automation\x20if\x20you\x20see\x20a\x20STABLE,\x20REPETITIVE\x20pattern\x20(e.g.\x20happens\x20every\x20day).\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20IGNORE\x20one-time\x20events.\x20Do\x20NOT\x20trigger\x20on\x20first\x20occurrence.\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20If\x20you\x20are\x20unsure,\x20set\x20\x22patternDetected\x22:\x20false.\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x22targetId\x22\x20MUSS\x20eine\x20ID\x20aus\x20der\x20Event-Liste\x20sein.\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1e0f92=_0x2306bd(0x157)+_0x4cc742+'.\x20MODUS:\x20'+_0x1afff2+_0x2306bd(0x19b)+(this[_0x2306bd(0x288)]?'Ja':_0x2306bd(0x1dc))+'.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20'+_0x1a3c95+_0x2306bd(0x1d4)+_0x3b1d04+'.\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x34af13+'\x20'+(_0x53067a?_0x53067a:'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2d5646+_0x2306bd(0x28a)+_0x1ca5a3+_0x2306bd(0x27b)+JSON[_0x2306bd(0x1d0)](_0x439275)+_0x2306bd(0x1cb);try{const _0x57da47=await this['geminiModel'][_0x2306bd(0x188)](_0x1e0f92),_0x21900c=_0x57da47['response']['text']()[_0x2306bd(0x1be)](/```json|```/g,'')[_0x2306bd(0x14f)](),_0x4cc45d=JSON[_0x2306bd(0x11f)](_0x21900c);await this[_0x2306bd(0x18b)](_0x2306bd(0x1a4),{'val':_0x21900c,'ack':!![]}),await this[_0x2306bd(0x18b)](_0x2306bd(0x279),{'val':_0x4cc45d['activity'][_0x2306bd(0x2bb)]||'','ack':!![]}),await this[_0x2306bd(0x18b)](_0x2306bd(0x22b),{'val':_0x4cc45d['activity'][_0x2306bd(0x214)]||_0x2306bd(0x271),'ack':!![]});const _0x4280f6=_0x4cc45d[_0x2306bd(0x261)]?.[_0x2306bd(0x1f9)];if(this['isProVersion']&&_0x4280f6){const _0x5b216f=_0x4280f6[_0x2306bd(0x18e)]||![];await this[_0x2306bd(0x18b)](_0x2306bd(0x2a9),{'val':_0x5b216f,'ack':!![]}),await this['setStateAsync']('analysis.automation.description',{'val':_0x5b216f?_0x4280f6[_0x2306bd(0x151)]:_0x2306bd(0x143),'ack':!![]});if(_0x5b216f&&_0x4280f6[_0x2306bd(0x20c)]&&_0x4280f6['execution']['targetId']){await this[_0x2306bd(0x18b)](_0x2306bd(0x128),{'val':_0x4280f6[_0x2306bd(0x20c)][_0x2306bd(0x294)],'ack':!![]}),await this['setStateAsync'](_0x2306bd(0x2a7),{'val':JSON[_0x2306bd(0x1d0)](_0x4280f6[_0x2306bd(0x20c)][_0x2306bd(0x26a)]),'ack':!![]});const _0x3565fb=await this[_0x2306bd(0x212)](_0x2306bd(0x19f));_0x3565fb&&_0x3565fb[_0x2306bd(0x229)]&&(this[_0x2306bd(0x204)][_0x2306bd(0x1b4)]('ðŸ¤–\x20AUTO-APPLY:\x20Executing\x20'+_0x4280f6['execution'][_0x2306bd(0x294)]+'\x20=\x20'+_0x4280f6[_0x2306bd(0x20c)][_0x2306bd(0x26a)]),this['executeAutomationAction']());}else await this[_0x2306bd(0x18b)](_0x2306bd(0x128),{'val':'','ack':!![]}),await this[_0x2306bd(0x18b)](_0x2306bd(0x2a7),{'val':'','ack':!![]});}if(_0x4cc45d[_0x2306bd(0x172)][_0x2306bd(0x1c8)]||_0x4cc45d[_0x2306bd(0x172)][_0x2306bd(0x1b5)]){await this[_0x2306bd(0x18b)](_0x2306bd(0x26b),{'val':!![],'ack':!![]});if(!this[_0x2306bd(0x2b9)]||_0x4cc45d[_0x2306bd(0x172)][_0x2306bd(0x1b5)]){const _0x4ccbf3=_0x4cc45d['activity']['isEmergency']?'ðŸš¨ðŸš¨\x20NOTFALL':_0x2306bd(0x18a);this[_0x2306bd(0x127)](_0x4ccbf3+':\x20'+_0x4cc45d[_0x2306bd(0x172)][_0x2306bd(0x2bb)],![],_0x4cc45d[_0x2306bd(0x172)][_0x2306bd(0x1b5)]);}}else await this[_0x2306bd(0x18b)](_0x2306bd(0x26b),{'val':![],'ack':!![]});this['lastAlertState']=_0x4cc45d[_0x2306bd(0x172)][_0x2306bd(0x1c8)]||_0x4cc45d[_0x2306bd(0x172)][_0x2306bd(0x1b5)];const _0x5d96cb={'timestamp':Date[_0x2306bd(0x1de)](),'id':Date[_0x2306bd(0x1de)]()[_0x2306bd(0x285)](),'analysis':_0x4cc45d,'systemMode':_0x1afff2,'isPro':this[_0x2306bd(0x248)]};this[_0x2306bd(0x22f)](_0x5d96cb);}catch(_0x2c11ba){this[_0x2306bd(0x204)][_0x2306bd(0x1fc)](_0x2306bd(0x1d2)+_0x2c11ba['message']);}}async['executeAutomationAction'](){const _0x2370b9=a0_0x297bed;try{const _0x42813e=await this[_0x2370b9(0x212)](_0x2370b9(0x128)),_0x3f6b3a=await this[_0x2370b9(0x212)]('analysis.automation.targetValue');if(_0x42813e&&_0x42813e[_0x2370b9(0x229)]&&_0x3f6b3a){const _0x250035=_0x42813e[_0x2370b9(0x229)];let _0x1e6380=_0x3f6b3a[_0x2370b9(0x229)];try{_0x1e6380=JSON['parse'](_0x1e6380);}catch(_0x430353){}this[_0x2370b9(0x204)]['info'](_0x2370b9(0x1e0)+_0x250035+_0x2370b9(0x2b7)+_0x1e6380),await this[_0x2370b9(0x12c)](_0x250035,_0x1e6380);}else this[_0x2370b9(0x204)][_0x2370b9(0x1e2)](_0x2370b9(0x24b));}catch(_0x41cd47){this[_0x2370b9(0x204)][_0x2370b9(0x1fc)](_0x2370b9(0x1c1)+_0x41cd47['message']);}}async[a0_0x297bed(0x28f)](){}async['createDailyDigest'](){}async[a0_0x297bed(0x216)](){}async[a0_0x297bed(0x17e)](_0x261aaf){return[];}[a0_0x297bed(0x1ae)](_0x5b88ff){const _0x47ef49=a0_0x297bed;if(typeof _0x5b88ff===_0x47ef49(0x29c))return _0x5b88ff;try{return JSON[_0x47ef49(0x11f)](_0x5b88ff);}catch(_0x3687a7){return null;}}async['initZombies'](){}async[a0_0x297bed(0x252)](){const _0x3f0d15=a0_0x297bed;try{const _0x46ba94=await this[_0x3f0d15(0x212)]('events.history');_0x46ba94&&_0x46ba94[_0x3f0d15(0x229)]&&(this['eventHistory']=JSON[_0x3f0d15(0x11f)](_0x46ba94[_0x3f0d15(0x229)][_0x3f0d15(0x285)]()));}catch(_0x538477){this[_0x3f0d15(0x1b1)]=[];}try{const _0x523a80=await this[_0x3f0d15(0x212)]('analysis.analysisHistory');if(_0x523a80&&_0x523a80[_0x3f0d15(0x229)])this['analysisHistory']=JSON[_0x3f0d15(0x11f)](_0x523a80[_0x3f0d15(0x229)]['toString']());}catch(_0x4be5d4){this[_0x3f0d15(0x2ac)]=[];}}async[a0_0x297bed(0x2a6)](){const _0x56fa51=a0_0x297bed;try{const _0x2bd41d=await this['getForeignObjectAsync']('system.config');_0x2bd41d&&_0x2bd41d[_0x56fa51(0x138)]&&(this[_0x56fa51(0x215)]={'latitude':_0x2bd41d['common']['latitude']||0x0,'longitude':_0x2bd41d[_0x56fa51(0x138)][_0x56fa51(0x219)]||0x0,'city':_0x2bd41d['common'][_0x56fa51(0x1f6)]||''});}catch(_0x2876d9){}}async[a0_0x297bed(0x17d)](_0x2ff80e){const _0x100c96=a0_0x297bed;if(!_0x2ff80e)return![];this[_0x100c96(0x24f)]=await this[_0x100c96(0x124)]();if(_0x2ff80e===_0x100c96(0x29f)||_0x2ff80e[_0x100c96(0x120)](_0x100c96(0x1da)))return!![];return![];}async['getSystemUUID'](){const _0x198649=a0_0x297bed;try{const _0x14d1b7=await this[_0x198649(0x1ab)](_0x198649(0x184));if(_0x14d1b7&&_0x14d1b7[_0x198649(0x286)]&&_0x14d1b7[_0x198649(0x286)][_0x198649(0x29d)])return _0x14d1b7[_0x198649(0x286)][_0x198649(0x29d)];return _0x198649(0x1ed);}catch(_0x4baa6b){return _0x198649(0x259);}}async[a0_0x297bed(0x161)](){const _0x2cf09e=a0_0x297bed;await this[_0x2cf09e(0x129)](),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x1b3),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x156),'type':_0x2cf09e(0x1a0),'role':'json','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2cf09e(0x182),{'type':_0x2cf09e(0x1f1),'common':{'name':'Event\x20History','type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x174),'read':!![],'write':![]},'native':{}}),await this[_0x2cf09e(0x25e)]('analysis.trigger',{'type':'state','common':{'name':_0x2cf09e(0x22d),'type':_0x2cf09e(0x28e),'role':_0x2cf09e(0x2be),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x2cf09e(0x25e)]('analysis.triggerBriefing',{'type':'state','common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x2cf09e(0x28e),'role':_0x2cf09e(0x2be),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2cf09e(0x1a4),{'type':'state','common':{'name':'Last\x20Result','type':_0x2cf09e(0x1a0),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x2cf09e(0x25e)]('analysis.isAlert',{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x21f),'type':_0x2cf09e(0x28e),'role':_0x2cf09e(0x158),'read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2cf09e(0x1d9),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x12a),'type':'boolean','role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x2cf09e(0x25e)]('analysis.alertReason',{'type':_0x2cf09e(0x1f1),'common':{'name':'Alert\x20Reason','type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x220),'read':!![],'write':![]},'native':{}}),await this[_0x2cf09e(0x25e)]('analysis.activitySummary',{'type':'state','common':{'name':_0x2cf09e(0x1b6),'type':_0x2cf09e(0x1a0),'role':'text','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.deviationFromBaseline',{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x1b8),'type':'string','role':'state','read':!![],'write':![],'def':_0x2cf09e(0x271)},'native':{}}),await this[_0x2cf09e(0x25e)]('analysis.comfortSummary',{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x291),'type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x29e),'read':!![],'write':![]},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x224),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x14a),'type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x29e),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](_0x2cf09e(0x168),{'type':_0x2cf09e(0x1ee),'common':{'name':'Automation\x20Proposals'},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x2a9),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x1e8),'type':_0x2cf09e(0x28e),'role':_0x2cf09e(0x22e),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x280),{'type':'state','common':{'name':'Description','type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x29e),'read':!![],'write':![]},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x201),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x2bc),'type':_0x2cf09e(0x1a0),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x128),{'type':'state','common':{'name':_0x2cf09e(0x246),'type':_0x2cf09e(0x1a0),'role':'text','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.automation.targetValue',{'type':'state','common':{'name':_0x2cf09e(0x162),'type':_0x2cf09e(0x1a0),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x19f),{'type':'state','common':{'name':_0x2cf09e(0x267),'type':'boolean','role':_0x2cf09e(0x292),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x17f),{'type':_0x2cf09e(0x1f1),'common':{'name':'Trigger\x20Action\x20Now','type':_0x2cf09e(0x28e),'role':_0x2cf09e(0x2be),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.analysisHistory',{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x1ca),'type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x174),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x142),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x255),'type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x174),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['extendObjectAsync'](_0x2cf09e(0x14e),{'type':_0x2cf09e(0x1ee),'common':{'name':_0x2cf09e(0x283)},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x14d),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x25f),'type':'number','role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await this[_0x2cf09e(0x25e)](_0x2cf09e(0x23c),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x1a5),'type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x29e),'read':!![],'write':![],'def':_0x2cf09e(0x147)},'native':{}}),await this['setObjectNotExistsAsync'](_0x2cf09e(0x27e),{'type':_0x2cf09e(0x1f1),'common':{'name':_0x2cf09e(0x205),'type':_0x2cf09e(0x1a0),'role':_0x2cf09e(0x29e),'read':!![],'write':![],'def':''},'native':{}}),await this[_0x2cf09e(0x187)](),await this['checkLtmDriftObjects']();}async[a0_0x297bed(0x129)](){const _0x4c857c=a0_0x297bed;await this[_0x4c857c(0x198)]('system',{'type':'channel','common':{'name':_0x4c857c(0x13e)},'native':{}}),await this[_0x4c857c(0x198)](SYSTEM_DP_MODE,{'type':_0x4c857c(0x1f1),'common':{'name':_0x4c857c(0x12e),'type':_0x4c857c(0x1a0),'role':_0x4c857c(0x1f1),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x4c857c(0x28b)],'states':{[SYSTEM_MODES[_0x4c857c(0x28b)]]:_0x4c857c(0x207),[SYSTEM_MODES[_0x4c857c(0x1e3)]]:'Urlaub',[SYSTEM_MODES[_0x4c857c(0x130)]]:_0x4c857c(0x2b6),[SYSTEM_MODES[_0x4c857c(0x148)]]:'Gast'}},'native':{}});}async['checkLtmObjects'](){const _0x5d0a1e=a0_0x297bed;await this['extendObjectAsync'](_0x5d0a1e(0x26c),{'type':_0x5d0a1e(0x1ee),'common':{'name':'LTM'},'native':{}}),await this[_0x5d0a1e(0x198)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x5d0a1e(0x160),'type':_0x5d0a1e(0x1a0),'role':_0x5d0a1e(0x174),'read':!![],'write':![]},'native':{}}),await this[_0x5d0a1e(0x198)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x5d0a1e(0x1db),'type':_0x5d0a1e(0x1a0),'role':_0x5d0a1e(0x174),'read':!![],'write':![]},'native':{}}),await this[_0x5d0a1e(0x198)](LTM_DP_STATUS,{'type':_0x5d0a1e(0x1f1),'common':{'name':_0x5d0a1e(0x1af),'type':'string','role':_0x5d0a1e(0x29e),'read':!![],'write':![]},'native':{}}),await this[_0x5d0a1e(0x198)](LTM_DP_TRIGGER_DIGEST,{'type':_0x5d0a1e(0x1f1),'common':{'name':_0x5d0a1e(0x1d3),'type':_0x5d0a1e(0x28e),'role':_0x5d0a1e(0x2be),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x5d0a1e(0x198)](LTM_DP_BASELINE_STATUS,{'type':_0x5d0a1e(0x1f1),'common':{'name':'Baseline\x20Status','type':_0x5d0a1e(0x1a0),'role':_0x5d0a1e(0x29e),'read':!![],'write':![]},'native':{}});}async[a0_0x297bed(0x16e)](){const _0x3dbb59=a0_0x297bed;await this[_0x3dbb59(0x198)](LTM_DP_DRIFT_CHANNEL,{'type':_0x3dbb59(0x1ee),'common':{'name':_0x3dbb59(0x25c)},'native':{}}),await this[_0x3dbb59(0x198)](LTM_DP_DRIFT_STATUS,{'type':_0x3dbb59(0x1f1),'common':{'name':'Drift\x20Status','type':_0x3dbb59(0x1a0),'role':_0x3dbb59(0x1f1),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x3dbb59(0x1f1),'common':{'name':_0x3dbb59(0x1a3),'type':_0x3dbb59(0x1a0),'role':_0x3dbb59(0x29e),'read':!![],'write':![]},'native':{}}),await this[_0x3dbb59(0x198)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x3dbb59(0x1f1),'common':{'name':_0x3dbb59(0x1e5),'type':_0x3dbb59(0x202),'role':_0x3dbb59(0x244),'read':!![],'write':![]},'native':{}});}async[a0_0x297bed(0x19e)](){const _0x3cde2b=a0_0x297bed;try{const _0x2d0e78=await this[_0x3cde2b(0x212)](SYSTEM_DP_MODE);_0x2d0e78&&_0x2d0e78[_0x3cde2b(0x229)]&&Object[_0x3cde2b(0x27a)](SYSTEM_MODES)[_0x3cde2b(0x21e)](_0x2d0e78[_0x3cde2b(0x229)])?this['currentSystemMode']=_0x2d0e78[_0x3cde2b(0x229)]:(this['currentSystemMode']=SYSTEM_MODES['NORMAL'],await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x245651){this[_0x3cde2b(0x247)]=SYSTEM_MODES[_0x3cde2b(0x28b)];}}async['loadRawEventLog'](){const _0x1ad998=a0_0x297bed;try{const _0x316c66=await this[_0x1ad998(0x212)](LTM_DP_RAW_LOG);if(_0x316c66&&_0x316c66[_0x1ad998(0x229)])this[_0x1ad998(0x1d8)]=JSON['parse'](_0x316c66[_0x1ad998(0x229)]);}catch(_0x5e6787){this['rawEventLog']=[];}}async[a0_0x297bed(0x1bd)](){const _0x4ca004=a0_0x297bed;this[_0x4ca004(0x1d8)][_0x4ca004(0x15f)]>RAW_LOG_MAX_SIZE&&this[_0x4ca004(0x1d8)][_0x4ca004(0x260)](0x0,this[_0x4ca004(0x1d8)][_0x4ca004(0x15f)]-RAW_LOG_MAX_SIZE),await this[_0x4ca004(0x18b)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](this[_0x4ca004(0x1d8)]),'ack':!![]});}async['saveDailyDigests'](_0x4221bc=!![]){const _0x2742ff=a0_0x297bed,_0x2fa711=this[_0x2742ff(0x16a)]['ltmLtbWindowDays']||0x3c;this[_0x2742ff(0x15a)][_0x2742ff(0x15f)]>_0x2fa711&&this['dailyDigests'][_0x2742ff(0x260)](0x0,this[_0x2742ff(0x15a)][_0x2742ff(0x15f)]-_0x2fa711);await this['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2742ff(0x1d0)](this[_0x2742ff(0x15a)]),'ack':!![]});if(_0x4221bc)await this['updateBaselineStatus']();}async['updateAnalysisHistory'](_0xbff16e){const _0x1f71fa=a0_0x297bed;this[_0x1f71fa(0x2ac)][_0x1f71fa(0x228)](_0xbff16e);if(this[_0x1f71fa(0x2ac)][_0x1f71fa(0x15f)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x1f71fa(0x2ac)]['pop']();await this['setStateAsync'](_0x1f71fa(0x245),{'val':JSON[_0x1f71fa(0x1d0)](this[_0x1f71fa(0x2ac)]),'ack':!![]});}async[a0_0x297bed(0x217)](){const _0x3b3e6e=a0_0x297bed;if(!this[_0x3b3e6e(0x248)]){await this[_0x3b3e6e(0x18b)](LTM_DP_BASELINE_STATUS,{'val':_0x3b3e6e(0x21c),'ack':!![]});return;}const _0x30ae61=this['dailyDigests'][_0x3b3e6e(0x15f)]>=(this[_0x3b3e6e(0x16a)]['minDaysForBaseline']||0x7)?_0x3b3e6e(0x25d)+this['dailyDigests']['length']+_0x3b3e6e(0x163):_0x3b3e6e(0x1f7)+this[_0x3b3e6e(0x15a)][_0x3b3e6e(0x15f)]+'/'+(this[_0x3b3e6e(0x16a)][_0x3b3e6e(0x1c4)]||0x7)+')';await this[_0x3b3e6e(0x18b)](LTM_DP_BASELINE_STATUS,{'val':_0x30ae61,'ack':!![]});}async[a0_0x297bed(0x1eb)](){const _0xb5baab=a0_0x297bed,_0x33e775=this[_0xb5baab(0x16a)]['devices'];if(_0x33e775&&_0x33e775[_0xb5baab(0x15f)]>0x0){this[_0xb5baab(0x204)]['info'](_0xb5baab(0x197)+_0x33e775[_0xb5baab(0x15f)]+_0xb5baab(0x1ef));for(const _0x2f4ccc of _0x33e775){if(_0x2f4ccc['id']){await this[_0xb5baab(0x1a6)](_0x2f4ccc['id']);try{const _0x1c5855=await this[_0xb5baab(0x2ae)](_0x2f4ccc['id']);if(_0x1c5855)this['sensorLastValues'][_0x2f4ccc['id']]=_0x1c5855[_0xb5baab(0x229)];}catch(_0x48627b){}}}}}async[a0_0x297bed(0x1dd)](){const _0x106fc9=a0_0x297bed,_0x3a47ab=this['config'][_0x106fc9(0x1b9)]||[];if(_0x3a47ab[_0x106fc9(0x15f)]>0x0){this[_0x106fc9(0x204)][_0x106fc9(0x1b4)]('Subscribing\x20to\x20'+_0x3a47ab['length']+_0x106fc9(0x221));for(const _0x583ee8 of _0x3a47ab){await this[_0x106fc9(0x1a6)](_0x583ee8);}try{await this[_0x106fc9(0x16b)]();}catch(_0xfb2648){}}}async[a0_0x297bed(0x2b5)](){const _0x11215b=a0_0x297bed;try{if(!this[_0x11215b(0x16a)][_0x11215b(0x263)])return _0x11215b(0x13f);let _0x37c0a4='';const _0x480a83=this['config']['weatherInstance'];if(_0x480a83)try{if(_0x480a83['includes'](_0x11215b(0x16c))){const _0x408653=await this[_0x11215b(0x2ae)](_0x480a83+_0x11215b(0x1a1));if(_0x408653&&_0x408653[_0x11215b(0x229)])_0x37c0a4=_0x408653[_0x11215b(0x229)];}else{if(_0x480a83[_0x11215b(0x21e)](_0x11215b(0x135))){const _0x3ca399=await this[_0x11215b(0x2ae)](_0x480a83+'.NextHours.Location_1.Day_1.current.symbol_desc');if(_0x3ca399&&_0x3ca399[_0x11215b(0x229)])_0x37c0a4=_0x3ca399[_0x11215b(0x229)];}else{if(_0x480a83[_0x11215b(0x21e)](_0x11215b(0x1e6))){const _0x5668f8=await this['getForeignStateAsync'](_0x480a83+_0x11215b(0x15e));if(_0x5668f8&&_0x5668f8[_0x11215b(0x229)])_0x37c0a4=_0x5668f8[_0x11215b(0x229)];}}}}catch(_0x3dc5f9){}if(!_0x37c0a4){const _0x108599=[_0x11215b(0x12b),'daswetter.0',_0x11215b(0x177),_0x11215b(0x13d)];for(const _0x5e6d0f of _0x108599){try{const _0x14e7b6=await this[_0x11215b(0x1ab)](_0x5e6d0f);if(_0x14e7b6){if(_0x5e6d0f[_0x11215b(0x21e)]('accuweather')){const _0x466cb3=await this[_0x11215b(0x2ae)](_0x5e6d0f+_0x11215b(0x1a1));if(_0x466cb3&&_0x466cb3[_0x11215b(0x229)]){_0x37c0a4=_0x466cb3[_0x11215b(0x229)];break;}}}}catch(_0x22e44f){}}}return _0x37c0a4?'WETTER:\x20'+_0x37c0a4:_0x11215b(0x155);}catch(_0x334126){return _0x11215b(0x166)+_0x334126[_0x11215b(0x273)];}}async[a0_0x297bed(0x18d)](){const _0x2c4fc2=a0_0x297bed;try{if(!this[_0x2c4fc2(0x16a)][_0x2c4fc2(0x199)])return'Kalender:\x20Deaktiviert';let _0x5085eb=this[_0x2c4fc2(0x16a)][_0x2c4fc2(0x181)]||'ical.0',_0x22f73e=this[_0x2c4fc2(0x16a)][_0x2c4fc2(0x275)]||[];if(typeof _0x22f73e===_0x2c4fc2(0x1a0))_0x22f73e=_0x22f73e['split'](',');try{const _0x152f3e=await this[_0x2c4fc2(0x2ae)](_0x5085eb+_0x2c4fc2(0x238));if(_0x152f3e&&_0x152f3e[_0x2c4fc2(0x229)]){let _0x41f00a=this[_0x2c4fc2(0x1ae)](_0x152f3e[_0x2c4fc2(0x229)]);if(_0x41f00a&&Array[_0x2c4fc2(0x153)](_0x41f00a)){if(_0x22f73e[_0x2c4fc2(0x15f)]>0x0)_0x41f00a=_0x41f00a[_0x2c4fc2(0x293)](_0x417b96=>_0x22f73e['includes'](_0x417b96['_calName']||''));else return _0x2c4fc2(0x12d);if(_0x41f00a[_0x2c4fc2(0x15f)]>0x0){const _0x1cb391=_0x41f00a[_0x2c4fc2(0x1e7)](0x0,0x3)[_0x2c4fc2(0x1d5)](_0x56db23=>{const _0x3b7fbf=_0x2c4fc2;let _0x3426bf=_0x56db23[_0x3b7fbf(0x244)];if(_0x56db23['time'])_0x3426bf+='\x20'+_0x56db23[_0x3b7fbf(0x22c)];return _0x3426bf+':\x20'+_0x56db23[_0x3b7fbf(0x13b)]+'\x20('+_0x56db23[_0x3b7fbf(0x2a8)]+')';});return _0x2c4fc2(0x146)+_0x1cb391[_0x2c4fc2(0x254)]('\x20|\x20');}else return _0x2c4fc2(0x269);}}}catch(_0x3ed73b){this['log']['warn'](_0x2c4fc2(0x13a)+_0x3ed73b[_0x2c4fc2(0x273)]);}return _0x2c4fc2(0x1b7);}catch(_0x3d1226){return _0x2c4fc2(0x1a2)+_0x3d1226[_0x2c4fc2(0x273)];}}async['getCalendarNames'](_0x56db19){const _0x4b0000=a0_0x297bed;try{const _0xc3fb42=await this[_0x4b0000(0x2ae)](_0x56db19+_0x4b0000(0x238));if(_0xc3fb42&&_0xc3fb42[_0x4b0000(0x229)]){const _0x2ba4b7=this[_0x4b0000(0x1ae)](_0xc3fb42[_0x4b0000(0x229)]);if(_0x2ba4b7&&Array[_0x4b0000(0x153)](_0x2ba4b7)){const _0x355b56=[...new Set(_0x2ba4b7['map'](_0x1e027c=>_0x1e027c[_0x4b0000(0x2a8)])[_0x4b0000(0x293)](Boolean))];return _0x355b56[_0x4b0000(0x287)]();}}return[];}catch(_0x3c9ba0){return this[_0x4b0000(0x204)][_0x4b0000(0x1fc)](_0x4b0000(0x230)+_0x3c9ba0[_0x4b0000(0x273)]),[];}}async[a0_0x297bed(0x16b)](){const _0x3ab3a7=a0_0x297bed;try{const _0x5b8367=this[_0x3ab3a7(0x16a)][_0x3ab3a7(0x1b9)]||[];let _0x3d4d1a=![];for(const _0x45ae31 of _0x5b8367){try{const _0x511b1c=await this[_0x3ab3a7(0x2ae)](_0x45ae31);if(_0x511b1c&&(_0x511b1c[_0x3ab3a7(0x229)]===!![]||_0x511b1c[_0x3ab3a7(0x229)]===_0x3ab3a7(0x27c)||_0x511b1c[_0x3ab3a7(0x229)]===0x1)){_0x3d4d1a=!![];break;}}catch(_0x1b8e8c){}}return _0x3d4d1a&&(this[_0x3ab3a7(0x193)]&&(this[_0x3ab3a7(0x204)][_0x3ab3a7(0x1b4)](_0x3ab3a7(0x123)),this[_0x3ab3a7(0x15c)]()),!this[_0x3ab3a7(0x288)]&&this[_0x3ab3a7(0x247)]===SYSTEM_MODES[_0x3ab3a7(0x28b)]&&await this[_0x3ab3a7(0x26e)](!![])),_0x3d4d1a;}catch(_0x364ba){return this[_0x3ab3a7(0x204)][_0x3ab3a7(0x1fc)](_0x3ab3a7(0x21d)+_0x364ba[_0x3ab3a7(0x273)]),![];}}[a0_0x297bed(0x1bb)](){const _0x41bf63=a0_0x297bed;this['abortExitTimer'](),this[_0x41bf63(0x144)]=!![],this[_0x41bf63(0x2b8)]=setTimeout(()=>{this['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x41bf63(0x193)]=setTimeout(()=>{const _0x587f2e=_0x41bf63;this[_0x587f2e(0x26e)](![]),this['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x297bed(0x15c)](){const _0x1a600a=a0_0x297bed;if(this['exitTimer'])clearTimeout(this[_0x1a600a(0x193)]);if(this[_0x1a600a(0x2b8)])clearTimeout(this['exitGraceTimer']);this[_0x1a600a(0x193)]=null,this[_0x1a600a(0x2b8)]=null,this[_0x1a600a(0x144)]=![];}async[a0_0x297bed(0x26e)](_0x176c48){const _0x3f93d2=a0_0x297bed;if(this[_0x3f93d2(0x288)]===_0x176c48)return;this[_0x3f93d2(0x288)]=_0x176c48,await this[_0x3f93d2(0x18b)](_0x3f93d2(0x2ba),{'val':_0x176c48,'ack':!![]});}async['saveFeedback'](_0x2db7c0){const _0x22ece5=a0_0x297bed;this[_0x22ece5(0x204)]['info'](_0x22ece5(0x180)+JSON[_0x22ece5(0x1d0)](_0x2db7c0));}async[a0_0x297bed(0x171)](){const _0x26bca0=a0_0x297bed;if(!this[_0x26bca0(0x248)]||!this[_0x26bca0(0x1fe)])return;const _0x4964be=this[_0x26bca0(0x16a)][_0x26bca0(0x209)]||0xe;if(this[_0x26bca0(0x15a)][_0x26bca0(0x15f)]<_0x4964be+(this['config'][_0x26bca0(0x1c4)]||0x7)){await this[_0x26bca0(0x18b)](LTM_DP_DRIFT_STATUS,{'val':_0x26bca0(0x218),'ack':!![]});return;}const _0xf4a82f=this[_0x26bca0(0x15a)][_0x26bca0(0x1e7)](-_0x4964be),_0x570e0a=this[_0x26bca0(0x15a)][_0x26bca0(0x1e7)](0x0,this[_0x26bca0(0x15a)][_0x26bca0(0x15f)]-_0x4964be),_0x2dc483=_0x26bca0(0x1c3)+JSON[_0x26bca0(0x1d0)](_0x570e0a)+'\x0aSTB:\x20'+JSON[_0x26bca0(0x1d0)](_0xf4a82f);try{const _0x3af1dc=await this['geminiModel']['generateContent'](_0x2dc483),_0x1308d9=JSON[_0x26bca0(0x11f)](_0x3af1dc['response'][_0x26bca0(0x29e)]()[_0x26bca0(0x1be)](/```json|```/g,'')[_0x26bca0(0x14f)]());_0x1308d9[_0x26bca0(0x2ad)]&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x1308d9[_0x26bca0(0x2ad)],'ack':!![]}),await this[_0x26bca0(0x18b)](LTM_DP_DRIFT_DETAILS,{'val':_0x1308d9['driftDetails'],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x7632cb){}}[a0_0x297bed(0x2a3)](){const _0x290996=a0_0x297bed;try{if(this[_0x290996(0x16f)])this['ltmJob'][_0x290996(0x203)]();if(!this[_0x290996(0x248)]){this[_0x290996(0x18b)](LTM_DP_STATUS,{'val':_0x290996(0x21c),'ack':!![]});return;}this['ltmJob']=schedule[_0x290996(0x1fd)](LTM_SCHEDULE,()=>this[_0x290996(0x195)]());}catch(_0x575fe9){this[_0x290996(0x204)][_0x290996(0x1fc)]('LTM\x20Sched\x20Error:\x20'+_0x575fe9[_0x290996(0x273)]);}}[a0_0x297bed(0x278)](){const _0x37ab7f=a0_0x297bed;try{if(this[_0x37ab7f(0x270)])this[_0x37ab7f(0x270)][_0x37ab7f(0x203)]();this[_0x37ab7f(0x270)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x2ed1c0=_0x37ab7f;await this[_0x2ed1c0(0x19e)](),AUTO_RESET_MODES[_0x2ed1c0(0x21e)](this[_0x2ed1c0(0x247)])&&await this[_0x2ed1c0(0x18b)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x31e178){this[_0x37ab7f(0x204)][_0x37ab7f(0x1fc)]('Reset\x20Sched\x20Error:\x20'+_0x31e178[_0x37ab7f(0x273)]);}}['setupDriftAnalysisScheduler'](){const _0x278739=a0_0x297bed;try{if(this[_0x278739(0x211)])clearInterval(this['driftAnalysisTimer']);if(!this['isProVersion'])return;this['driftAnalysisTimer']=setInterval(()=>this[_0x278739(0x171)](),(this[_0x278739(0x16a)][_0x278739(0x164)]||0x18)*0x36ee80),setTimeout(()=>this[_0x278739(0x171)](),0x1388);}catch(_0x943b82){this['log'][_0x278739(0x1fc)](_0x278739(0x27d)+_0x943b82[_0x278739(0x273)]);}}[a0_0x297bed(0x233)](){const _0x600e96=a0_0x297bed;try{if(this[_0x600e96(0x2a0)])this[_0x600e96(0x2a0)][_0x600e96(0x203)]();if(!this[_0x600e96(0x16a)][_0x600e96(0x1d6)])return;const _0x252784=(this['config']['briefingTime']||_0x600e96(0x20f))[_0x600e96(0x1cf)](':'),_0x36d094=parseInt(_0x252784[0x0])||0x8,_0x3c9e4b=parseInt(_0x252784[0x1])||0x0,_0x289551=_0x3c9e4b+'\x20'+_0x36d094+_0x600e96(0x178);this['log'][_0x600e96(0x1b4)](_0x600e96(0x1ce)+_0x36d094+':'+(_0x3c9e4b<0xa?'0'+_0x3c9e4b:_0x3c9e4b)),this[_0x600e96(0x2a0)]=schedule['scheduleJob'](_0x289551,()=>{this['sendMorningBriefing']();});}catch(_0x25500c){this[_0x600e96(0x204)]['error'](_0x600e96(0x258)+_0x25500c[_0x600e96(0x273)]);}}async[a0_0x297bed(0x127)](_0xcee334,_0x2a0ca4=![],_0x179a47=![]){const _0x1755b9=a0_0x297bed;this['log'][_0x1755b9(0x1b4)]((_0x2a0ca4?'[TEST]\x20':'')+_0x1755b9(0x272)+_0xcee334+'\x22');const _0x47bf11=this['config'];let _0x163039=0x0;_0x47bf11[_0x1755b9(0x2a4)]&&(await this[_0x1755b9(0x167)](_0x47bf11['notifyTelegramInstance'],_0x1755b9(0x1bf),{'text':_0xcee334,'user':_0x47bf11[_0x1755b9(0x196)]}),_0x163039++);if(_0x47bf11['notifyPushoverEnabled']){let _0x19bea1={'message':_0xcee334,'title':_0x179a47?_0x1755b9(0x1c9):_0x1755b9(0x290),'priority':_0x179a47?0x2:0x1,'device':_0x47bf11[_0x1755b9(0x1ff)]};_0x179a47&&(_0x19bea1['retry']=0x1e,_0x19bea1['expire']=0xe10,_0x19bea1[_0x1755b9(0x289)]=_0x1755b9(0x1b0)),await this[_0x1755b9(0x167)](_0x47bf11[_0x1755b9(0x24d)],_0x1755b9(0x1bf),_0x19bea1),_0x163039++;}return _0x47bf11['notifyEmailEnabled']&&(await this[_0x1755b9(0x167)](_0x47bf11[_0x1755b9(0x14c)],_0x1755b9(0x1bf),{'text':_0xcee334,'to':_0x47bf11[_0x1755b9(0x222)]}),_0x163039++),_0x163039;}}if(require[a0_0x297bed(0x2bd)]!==module)module[a0_0x297bed(0x137)]=_0x48f522=>new CogniLiving(_0x48f522);else new CogniLiving();