function a0_0x4aa5(_0x359189,_0x51b87a){const _0x28e6bb=a0_0x57a0();return a0_0x4aa5=function(_0x3976f7,_0x218d92){_0x3976f7=_0x3976f7-0x8e;let _0x57a004=_0x28e6bb[_0x3976f7];return _0x57a004;},a0_0x4aa5(_0x359189,_0x51b87a);}const a0_0x461d2f=a0_0x4aa5;(function(_0x11f16f,_0x56cca3){const _0x203613=a0_0x4aa5,_0x544ece=_0x11f16f();while(!![]){try{const _0x203fa4=-parseInt(_0x203613(0x1a8))/0x1+parseInt(_0x203613(0xd9))/0x2*(parseInt(_0x203613(0xbf))/0x3)+parseInt(_0x203613(0x141))/0x4+-parseInt(_0x203613(0x1a7))/0x5*(parseInt(_0x203613(0x14f))/0x6)+parseInt(_0x203613(0x249))/0x7+parseInt(_0x203613(0x21b))/0x8+-parseInt(_0x203613(0x193))/0x9*(parseInt(_0x203613(0x1ce))/0xa);if(_0x203fa4===_0x56cca3)break;else _0x544ece['push'](_0x544ece['shift']());}catch(_0x25615d){_0x544ece['push'](_0x544ece['shift']());}}}(a0_0x57a0,0xda24a));const a0_0x218d92=(function(){let _0x3e58ee=!![];return function(_0x4fa99c,_0x3a48fc){const _0x3def43=_0x3e58ee?function(){const _0x478928=a0_0x4aa5;if(_0x3a48fc){const _0x482c2e=_0x3a48fc[_0x478928(0x190)](_0x4fa99c,arguments);return _0x3a48fc=null,_0x482c2e;}}:function(){};return _0x3e58ee=![],_0x3def43;};}()),a0_0x3976f7=a0_0x218d92(this,function(){const _0x15b157=a0_0x4aa5;return a0_0x3976f7[_0x15b157(0x1f3)]()['search'](_0x15b157(0x1ac))[_0x15b157(0x1f3)]()['constructor'](a0_0x3976f7)['search']('(((.+)+)+)+$');});a0_0x3976f7();function a0_0x57a0(){const _0x7b7c03=['inactivityThresholdHours','toUpperCase','loadSystemMode','scriptEnabled','analysisTimer','DIRECTION','Fehler:\x20','longitude','some','capabilities','accuweather','processSensorEvent','notifySignalRecipient','GUEST','none','bewegung','testApiKey','events.history_debug_01','SECTION','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','ERROR_CODE','tryParse','material.','presence','rain','Daily\x20Digests','setState','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','Starting\x20Autopilot\x20(','313386eMXIqf','No\x20Key','ready','string','useWeather','checkWifiPresence','k√ºche','system.config','analysis.comfortSuggestion','.Summary.Current','mac\x20address','analysis.history_debug_02','scanForDevices','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','timestamp','loadRawEventLog\x20failed:\x20','licht','LOWBAT','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','logDuplicates','common','main','events.lastEvent','sendTo','activity','analysis.triggerBriefing','26kvEbtc','analysis.automation.patternDetected','archetype','generateContent','/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20','getCalendarContext','ltmJob','systemConfig','motion','temp','\x20sensors...','toISOString','scriptProblem','PRO-','colormode','find','dailyDigests','Processing\x20Status','analysis.trigger','rawEventLog','subscribeStates','time','object','AES_KEY','effect','alertReason','isArray','analysis.isAlert','Temperatur','eingang','calendarInstance','sat','link_quality','loadDailyDigests','getForeignStateAsync','cancel','Briefing\x20Error:\x20','testContext','geminiModel','eventHistory','loadSystemMode\x20failed:\x20','date','getCalendarNames\x20Error:\x20','Trigger\x20Digest','events.history_debug_03','map','expire','Baseline:\x20Inactive\x20(Pro\x20Feature).','griff','aiPersona','ON_TIME','calendarSelection','LTM','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20','onStateChange','accuweather.0','geminiApiKey','includes','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','Fenster/T√ºr','siren','Garten','createAllObjects','description','mode','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','.NextHours.Location_1.Day_1.current.symbol_desc','updateAnalysisHistory','startExitTimer','WORKING','INSTALL_TEST','2-digit','Gemini\x20Init\x20Error:\x20','native','User\x20Feedback:\x20Alarm\x20\x22','garten','modeResetJob','systemUUID','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','value.humidity','bind','precip','forecast','WETTER:\x20Keine\x20Daten','analysis.deviationFromBaseline','restlessness','System\x20Status\x20&\x20Control','json','STICKY_UNREACH','onReady','summary','createDailyDigest','loadDailyDigests\x20failed:\x20','detectionState','event','toLowerCase','level','switch.light','Kalender:\x20Deaktiviert','long','Adapter','WETTER:\x20','.\x20PR√ÑSENZ:\x20','199924dFaMoy','Drift\x20Analysis','automationProposal','info','submitFeedback','reachable','CONFIG_PENDING','stringify','last\x20action','NORMAL','models/gemini-flash-latest','isProVersion','test','enum.functions.*','132RXVnyl','channel','flot.','sendMorningBriefing','yr.','Subscribing\x20to\x20','VIRTUAL_CHANNEL','flur','weatherunderground.','openweathermap.','ALARM','namespace','analysis.lastResult','filter','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','\x0aFEEDBACK:\x0a','warn','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','location','health','[Test]\x20Notification','lights','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','parse','send','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','ERROR','generic','LTM.driftAnalysis.driftDetails','analysis.history_debug_04','from','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','getStateAsync','guest','testNotification','WETTER\x20ERROR:\x20','isPresent','rauch','checkLicense','OPERATING_VOLTAGE','type','analysis.history_debug_00','createAllObjects\x20failed:\x20','admin.','Missing\x20data','Daily\x20Digest\x20Error:\x20','shutter_contact','stateChange','briefingJob','LTM.driftAnalysis.lastCheck','setStateAsync','Gast','config','Starting\x20Smart\x20Scan\x20with\x20filters:\x20','Generating\x20Morning\x20Briefing...','de-DE','isExit','system','process','weatherunderground.0','sleepScore','write','length','Success','analysisHistory','apply','unknown','saveFeedback','8847gCGFgq','number','LTM.driftAnalysis','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','weatherInstance','notifyWhatsappRecipient','system.','exitGraceTimer','isGracePeriodActive','ack','Gemini\x20AI\x20initialized.','getObjectAsync','events.history_debug_00','üåÖ\x20Daily\x20Briefing:\x0a','Last\x20Check','name','runAutopilot','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','triggerDailyDigest','wetter','15175RcaqAG','781312GxIzyi','state','modelid','notifyPushoverRecipient','(((.+)+)+)+$','connection','apiKey','Badezimmer','party','getForeignObjectsAsync','split','rating','licenseKey','Cogni-Living\x20Alert','retry','manufacturer','uuid','comfort','uniqueid','Urlaub','\x22\x20was\x20','onUnload','response','val','Error\x20in\x20onMessage\x20command\x20','notifyPushoverEnabled','Wohnzimmer','node-schedule','.\x20ORT:\x20','TEST-PRO-KEY','events.history_debug_02','Flur','getCalendarNames','feedbackHistory','trim','KALENDER:\x20Keine\x20relevanten\x20Termine','License\x20Check\x20failed:\x20','Drift\x20Details','8940YOcXfa','üö®üö®\x20NOTFALL','Baseline\x20Status','analysis.activitySummary','abortExitTimer','VACATION','temperature','value.temperature','sensor.motion','openweathermap.0','t√ºr','\x20|\x20','analysis.automation.description','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','setHours','LTM.processingStatus','KALENDER:\x20Keine\x20Daten','enum.rooms.*','icons-mfd.','0\x203\x20*\x20*\x20*','system.mode','weather','livingContext','notifySignalEnabled','doors','getGenerativeModel','_score','notifyWhatsappInstance','cogni-living','sort','onMessage','unshift','N/A','Party','driftAnalysisTimer','startsWith','city','toString','runGeminiAnalysis','Error\x20initHistory:\x20','normal','isAlert','analysis.health.notes','replace','events.history','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','sendNotification','\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}','analysis.analysisHistory','getWeatherContext','No\x20instance','loadRawEventLog','SABOTAGE','‚ö†Ô∏è\x20Alarm','analysis.health.sleepScore','analysis.isEmergency','Drift\x20Status','Schalter/Licht','.data.table','Bewegung','KALENDER\x20ERROR:\x20','inactivityMonitoringEnabled','\x20raw\x20events...','events.history_debug_04','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','\x20min).\x20Watchdog\x20Limit:\x20','details','presenceDevices','isEmergency','Analysiere\x20Tag...','notifyWhatsappEnabled','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','callback','now','notifyPushoverInstance','PARTY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','675240nrGIAd','button','join','Autopilot\x20error:\x20','wohn','notifyTelegramInstance','javascript.0.script','command','FAULT','sensorLastValues','last_seen','wohnungst√ºr','message','system.meta.uuid','toLocaleString','saveRawEventLog','Analysis\x20Error:\x20','productname','Raw\x20Log','.\x20PERSONA:\x20','push','analysis.history_debug_01','bad','checkLtmObjects','slice','analysisInterval','lampe','text','initHistory','accuweather.','LTM.rawEventLog','members','sound','Daily\x20Digest\x20created\x20successfully.','catch','RSSI','currentSystemMode','exitTimer','exports','CONNECTION','Licht','delObjectAsync','lastCheck','info.','firmware','WEEK_PROGRAM','7896042BkDOTw','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','\x20sent','enum','values','@iobroker/adapter-core','System\x20Mode','toFixed','subscribeForeignStatesAsync','triggerBriefing','smoke','analysis.alertReason','notifyTelegramRecipient','lastAlertState','setupBriefingScheduler','getForeignObjectAsync','activityLevel','_calName','getSystemUUID','error','setPresence','getLtmData','latitude','sendToAsync','Morning\x20Briefing\x20sent.','genAI','log','notifyEmailRecipient','extendObjectAsync','notifySignalInstance','icon'];a0_0x57a0=function(){return _0x7b7c03;};return a0_0x57a0();}'use strict';const utils=require(a0_0x461d2f(0x24e)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x461d2f(0x1c3)),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x461d2f(0x14b),LTM_SCHEDULE=a0_0x461d2f(0x1e1),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',LTM_DP_RAW_LOG=a0_0x461d2f(0x239),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x461d2f(0x1dd),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x461d2f(0x195),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x461d2f(0x16b),LTM_DP_DRIFT_LAST_CHECK=a0_0x461d2f(0x180),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x461d2f(0x1f6),'VACATION':'vacation','PARTY':a0_0x461d2f(0x1b0),'GUEST':a0_0x461d2f(0x170)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x461d2f(0x219)],SYSTEM_MODES['GUEST']],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':'PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','family':a0_0x461d2f(0x215),'single_comfort':a0_0x461d2f(0x165),'security':a0_0x461d2f(0x1db)};class CogniLiving extends utils[a0_0x461d2f(0x13e)]{constructor(_0x5a398e){const _0x53778a=a0_0x461d2f;super({..._0x5a398e,'name':_0x53778a(0x1ea)}),this[_0x53778a(0x100)]=[],this['analysisHistory']=[],this[_0x53778a(0x1c9)]=[],this[_0x53778a(0xec)]=[],this[_0x53778a(0xe9)]=[],this[_0x53778a(0x224)]={},this[_0x53778a(0xe0)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x53778a(0x240)]=null,this[_0x53778a(0x19a)]=null,this[_0x53778a(0x19b)]=![],this[_0x53778a(0x9c)]=null,this[_0x53778a(0xff)]=null,this[_0x53778a(0x23f)]=SYSTEM_MODES['NORMAL'],this[_0x53778a(0x14c)]=![],this[_0x53778a(0x90)]=![],this[_0x53778a(0x126)]=_0x53778a(0x191),this['analysisTimer']=null,this[_0x53778a(0xdf)]=null,this['modeResetJob']=null,this[_0x53778a(0x1f0)]=null,this['briefingJob']=null,this['on'](_0x53778a(0xc1),this['onReady']['bind'](this)),this['on'](_0x53778a(0x17e),this[_0x53778a(0x10f)][_0x53778a(0x12a)](this)),this['on']('unload',this[_0x53778a(0x1bd)][_0x53778a(0x12a)](this)),this['on'](_0x53778a(0x227),this[_0x53778a(0x1ec)]['bind'](this));}async[a0_0x461d2f(0x133)](){const _0x44d7ae=a0_0x461d2f;this[_0x44d7ae(0x9d)]['info']('cogni-living\x20adapter\x20starting\x20(v'+this['version']+')');try{const _0x33d192=[_0x44d7ae(0x178),_0x44d7ae(0x230),_0x44d7ae(0xca),'analysis.history_debug_03',_0x44d7ae(0x16c),_0x44d7ae(0x19f),_0x44d7ae(0xb3),_0x44d7ae(0x1c6),_0x44d7ae(0x105),_0x44d7ae(0x20d)];for(const _0x247bd2 of _0x33d192){try{const _0x46f185=await this[_0x44d7ae(0x19e)](_0x247bd2);_0x46f185&&await this[_0x44d7ae(0x244)](_0x247bd2);}catch(_0x360919){}}}catch(_0x15ea71){}this['config'][_0x44d7ae(0x1b4)]=this[_0x44d7ae(0x183)][_0x44d7ae(0x1b4)]||'';try{this[_0x44d7ae(0x14c)]=await this[_0x44d7ae(0x175)](this[_0x44d7ae(0x183)][_0x44d7ae(0x1b4)]);}catch(_0x58c966){this[_0x44d7ae(0x9d)][_0x44d7ae(0x96)](_0x44d7ae(0x1cc)+_0x58c966[_0x44d7ae(0x227)]);}if(!this[_0x44d7ae(0x183)][_0x44d7ae(0xa2)]||this[_0x44d7ae(0x183)]['inactivityThresholdHours']<0.1)this[_0x44d7ae(0x183)]['inactivityThresholdHours']=0xc;try{await this[_0x44d7ae(0x237)]();}catch(_0x40deee){this[_0x44d7ae(0x9d)][_0x44d7ae(0x96)](_0x44d7ae(0x1f5)+_0x40deee[_0x44d7ae(0x227)]);}try{const _0x13d1e5=await this[_0x44d7ae(0x92)](_0x44d7ae(0xc6));_0x13d1e5&&_0x13d1e5[_0x44d7ae(0xd3)]&&(this[_0x44d7ae(0xe0)]={'latitude':_0x13d1e5[_0x44d7ae(0xd3)][_0x44d7ae(0x99)]||0x0,'longitude':_0x13d1e5['common'][_0x44d7ae(0xa9)]||0x0,'city':_0x13d1e5[_0x44d7ae(0xd3)][_0x44d7ae(0x1f2)]||''});}catch(_0x394f69){}if(this[_0x44d7ae(0x183)][_0x44d7ae(0x111)])try{this[_0x44d7ae(0x9c)]=new GoogleGenerativeAI(this[_0x44d7ae(0x183)][_0x44d7ae(0x111)]),this[_0x44d7ae(0xff)]=this['genAI'][_0x44d7ae(0x1e7)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x44d7ae(0x9d)][_0x44d7ae(0x144)](_0x44d7ae(0x19d));}catch(_0xb6677){this['log'][_0x44d7ae(0x96)](_0x44d7ae(0x121)+_0xb6677['message']);}try{await this[_0x44d7ae(0x117)]();}catch(_0x531cf0){this[_0x44d7ae(0x9d)][_0x44d7ae(0x96)](_0x44d7ae(0x179)+_0x531cf0['message']);}try{await this[_0x44d7ae(0xa4)]();}catch(_0x1ffa3d){this[_0x44d7ae(0x9d)][_0x44d7ae(0x96)](_0x44d7ae(0x101)+_0x1ffa3d[_0x44d7ae(0x227)]);}try{await this[_0x44d7ae(0x201)]();}catch(_0x4b227c){this['log'][_0x44d7ae(0x96)](_0x44d7ae(0xce)+_0x4b227c[_0x44d7ae(0x227)]);}try{await this[_0x44d7ae(0xfa)]();}catch(_0x241c2b){this['log']['error'](_0x44d7ae(0x136)+_0x241c2b[_0x44d7ae(0x227)]);}this[_0x44d7ae(0xed)](_0x44d7ae(0xeb)),this[_0x44d7ae(0xed)](LTM_DP_TRIGGER_DIGEST),this[_0x44d7ae(0xed)](_0x44d7ae(0x1e2)),this[_0x44d7ae(0xed)](_0x44d7ae(0xd8));const _0x197cb0=this[_0x44d7ae(0x183)]['devices'];if(_0x197cb0&&_0x197cb0[_0x44d7ae(0x18d)]>0x0){this[_0x44d7ae(0x9d)][_0x44d7ae(0x144)](_0x44d7ae(0x154)+_0x197cb0[_0x44d7ae(0x18d)]+_0x44d7ae(0xe3));for(const _0x5058c6 of _0x197cb0){if(_0x5058c6['id']){await this['subscribeForeignStatesAsync'](_0x5058c6['id']);try{const _0x5af3c0=await this[_0x44d7ae(0xfb)](_0x5058c6['id']);if(_0x5af3c0)this[_0x44d7ae(0x224)][_0x5058c6['id']]=_0x5af3c0[_0x44d7ae(0x1bf)];}catch(_0x14345f){}}}}const _0x32fc33=this[_0x44d7ae(0x183)][_0x44d7ae(0x211)]||[];if(_0x32fc33[_0x44d7ae(0x18d)]>0x0){this[_0x44d7ae(0x9d)][_0x44d7ae(0x144)](_0x44d7ae(0x154)+_0x32fc33['length']+'\x20presence\x20devices...');for(const _0x5ce9ea of _0x32fc33){await this[_0x44d7ae(0x251)](_0x5ce9ea);}try{await this['checkWifiPresence']();}catch(_0x1f70c2){}}if(this[_0x44d7ae(0xa6)])clearInterval(this['analysisTimer']);const _0x21efa2=this[_0x44d7ae(0x183)][_0x44d7ae(0x234)]||0xf;_0x21efa2>0x0&&(this['log'][_0x44d7ae(0x144)](_0x44d7ae(0xbe)+_0x21efa2+_0x44d7ae(0x20f)+this[_0x44d7ae(0x183)][_0x44d7ae(0xa2)]+'h.'),this[_0x44d7ae(0xa6)]=setInterval(()=>{const _0x4a76fc=_0x44d7ae;try{this['runAutopilot']();}catch(_0x2feb6f){this[_0x4a76fc(0x9d)][_0x4a76fc(0x96)](_0x4a76fc(0x21e)+_0x2feb6f[_0x4a76fc(0x227)]);}},_0x21efa2*0x3c*0x3e8)),this['setupLtmScheduler'](),this['setupModeResetScheduler'](),this['setupDriftAnalysisScheduler'](),this[_0x44d7ae(0x91)]();}[a0_0x461d2f(0x1bd)](_0xe2022c){const _0x21517f=a0_0x461d2f;if(this[_0x21517f(0xa6)])clearInterval(this[_0x21517f(0xa6)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x21517f(0x1f0)]);if(this[_0x21517f(0xdf)])this[_0x21517f(0xdf)][_0x21517f(0xfc)]();if(this[_0x21517f(0x125)])this[_0x21517f(0x125)][_0x21517f(0xfc)]();if(this[_0x21517f(0x17f)])this[_0x21517f(0x17f)][_0x21517f(0xfc)]();if(this[_0x21517f(0x240)])clearTimeout(this[_0x21517f(0x240)]);if(this['exitGraceTimer'])clearTimeout(this['exitGraceTimer']);_0xe2022c();}async[a0_0x461d2f(0x10f)](_0x5a5e12,_0xfd6f5c){const _0x559a5e=a0_0x461d2f;if(!_0xfd6f5c)return;if(_0x5a5e12===this[_0x559a5e(0x15a)]+'.'+SYSTEM_DP_MODE){_0xfd6f5c['val']&&Object[_0x559a5e(0x24d)](SYSTEM_MODES)['includes'](_0xfd6f5c[_0x559a5e(0x1bf)])&&(this['currentSystemMode']=_0xfd6f5c['val'],_0xfd6f5c[_0x559a5e(0x1bf)]===SYSTEM_MODES[_0x559a5e(0x1d3)]?this[_0x559a5e(0x97)](![]):this['setPresence'](!![]));if(!_0xfd6f5c[_0x559a5e(0x19c)])this['setState'](_0x5a5e12,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0xfd6f5c[_0x559a5e(0x19c)]){_0x5a5e12[_0x559a5e(0x112)]('analysis.trigger')&&_0xfd6f5c[_0x559a5e(0x1bf)]&&(this[_0x559a5e(0xbc)](_0x5a5e12,{'val':![],'ack':!![]}),this[_0x559a5e(0x1f4)]());if(_0x5a5e12[_0x559a5e(0x112)](_0x559a5e(0x1a5))&&_0xfd6f5c[_0x559a5e(0x1bf)]){this['setState'](_0x5a5e12,{'val':![],'ack':!![]});if(this[_0x559a5e(0x14c)])this[_0x559a5e(0x135)]();}_0x5a5e12[_0x559a5e(0x112)](_0x559a5e(0x252))&&_0xfd6f5c[_0x559a5e(0x1bf)]&&(this[_0x559a5e(0xbc)](_0x5a5e12,{'val':![],'ack':!![]}),this[_0x559a5e(0x152)]());return;}if(this[_0x559a5e(0x183)][_0x559a5e(0x211)]&&this['config'][_0x559a5e(0x211)][_0x559a5e(0x112)](_0x5a5e12)){await this[_0x559a5e(0xc4)]();return;}const _0x2fdee5=(this[_0x559a5e(0x183)]['devices']||[])['find'](_0x8e1569=>_0x8e1569['id']===_0x5a5e12);if(_0x2fdee5)this[_0x559a5e(0xad)](_0x5a5e12,_0xfd6f5c,_0x2fdee5);}async['onMessage'](_0x232a6a){const _0x2a1ff0=a0_0x461d2f;if(typeof _0x232a6a==='object'&&_0x232a6a[_0x2a1ff0(0x227)])try{if(_0x232a6a[_0x2a1ff0(0x222)]===_0x2a1ff0(0xb2)){if(!_0x232a6a['message'][_0x2a1ff0(0x1ae)])return this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':![],'message':_0x2a1ff0(0xc0)},_0x232a6a['callback']);try{const _0xe3d1be=new GoogleGenerativeAI(_0x232a6a['message'][_0x2a1ff0(0x1ae)])[_0x2a1ff0(0x1e7)]({'model':'models/gemini-flash-latest'});await _0xe3d1be[_0x2a1ff0(0xdc)](_0x2a1ff0(0x14d)),this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a['command'],{'success':!![],'message':_0x2a1ff0(0x18e)},_0x232a6a['callback']);}catch(_0x2eafc4){this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':![],'message':_0x2eafc4['message']},_0x232a6a[_0x2a1ff0(0x216)]);}}else{if(_0x232a6a[_0x2a1ff0(0x222)]===_0x2a1ff0(0x171)){const _0x306620=await this[_0x2a1ff0(0x1fc)](_0x2a1ff0(0x163),!![]);this['sendTo'](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a['command'],{'success':_0x306620>0x0,'message':_0x306620+_0x2a1ff0(0x24b)},_0x232a6a[_0x2a1ff0(0x216)]);}else{if(_0x232a6a[_0x2a1ff0(0x222)]===_0x2a1ff0(0x98)){if(!this[_0x2a1ff0(0x14c)])return this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':![],'isPro':![]},_0x232a6a[_0x2a1ff0(0x216)]);let _0xbaf5e6={'status':_0x2a1ff0(0x1ee),'details':'','lastCheck':0x0};try{_0xbaf5e6['status']=(await this[_0x2a1ff0(0x16f)](LTM_DP_DRIFT_STATUS))[_0x2a1ff0(0x1bf)],_0xbaf5e6[_0x2a1ff0(0x210)]=(await this[_0x2a1ff0(0x16f)](LTM_DP_DRIFT_DETAILS))[_0x2a1ff0(0x1bf)],_0xbaf5e6[_0x2a1ff0(0x245)]=(await this[_0x2a1ff0(0x16f)](LTM_DP_DRIFT_LAST_CHECK))[_0x2a1ff0(0x1bf)];}catch(_0x552ad5){}this['sendTo'](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x2a1ff0(0xe9)],'driftAnalysis':_0xbaf5e6,'analysisHistory':this['analysisHistory']},_0x232a6a[_0x2a1ff0(0x216)]);}else{if(_0x232a6a[_0x2a1ff0(0x222)]==='getEnums'){const _0xf628a3=await this['getForeignObjectsAsync'](_0x2a1ff0(0x14e),_0x2a1ff0(0x24c)),_0x58c9a8=[];if(_0xf628a3)for(const _0xed7043 in _0xf628a3){const _0x190312=_0xf628a3[_0xed7043],_0x303bc6=(_0x190312[_0x2a1ff0(0xd3)]&&typeof _0x190312[_0x2a1ff0(0xd3)][_0x2a1ff0(0x1a2)]===_0x2a1ff0(0xef)?_0x190312[_0x2a1ff0(0xd3)]['name']['de']:_0x190312[_0x2a1ff0(0xd3)][_0x2a1ff0(0x1a2)])||_0x190312[_0x2a1ff0(0xd3)][_0x2a1ff0(0x1a2)];_0x58c9a8[_0x2a1ff0(0x22f)]({'id':_0xed7043,'name':_0x303bc6});}this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':!![],'enums':_0x58c9a8},_0x232a6a['callback']);}else{if(_0x232a6a['command']==='scanDevices')try{const _0x30bbd2=await this['scanForDevices'](_0x232a6a[_0x2a1ff0(0x227)]||{});this[_0x2a1ff0(0xd6)](_0x232a6a['from'],_0x232a6a[_0x2a1ff0(0x222)],{'success':!![],'devices':_0x30bbd2},_0x232a6a[_0x2a1ff0(0x216)]);}catch(_0x52bb3e){this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':![],'error':_0x52bb3e[_0x2a1ff0(0x227)]},_0x232a6a[_0x2a1ff0(0x216)]);}else{if(_0x232a6a[_0x2a1ff0(0x222)]===_0x2a1ff0(0x145)){const {historyId:_0x47ef5,rating:_0x2282bd,comment:_0x32c380,alertReason:_0x2812ca}=_0x232a6a[_0x2a1ff0(0x227)];_0x47ef5&&_0x2282bd?(await this[_0x2a1ff0(0x192)]({'timestamp':Date[_0x2a1ff0(0x217)](),'historyId':_0x47ef5,'rating':_0x2282bd,'comment':_0x32c380,'alertReason':_0x2812ca}),this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':!![]},_0x232a6a[_0x2a1ff0(0x216)])):this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':![],'error':_0x2a1ff0(0x17b)},_0x232a6a[_0x2a1ff0(0x216)]);}else{if(_0x232a6a[_0x2a1ff0(0x222)]===_0x2a1ff0(0xfe)){const _0x3a940f=await this['getWeatherContext'](),_0xa04081=await this[_0x2a1ff0(0xde)]();this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a['command'],{'success':!![],'weather':_0x3a940f,'calendar':_0xa04081},_0x232a6a['callback']);}else{if(_0x232a6a['command']===_0x2a1ff0(0x1c8)){const _0x58e0ef=_0x232a6a[_0x2a1ff0(0x227)]['instance'];if(!_0x58e0ef)return this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':![],'error':_0x2a1ff0(0x200)},_0x232a6a[_0x2a1ff0(0x216)]);const _0x44a410=await this[_0x2a1ff0(0x1c8)](_0x58e0ef);this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a['command'],{'success':!![],'names':_0x44a410},_0x232a6a[_0x2a1ff0(0x216)]);}}}}}}}}}catch(_0x4f93d){this['log'][_0x2a1ff0(0x96)](_0x2a1ff0(0x1c0)+_0x232a6a[_0x2a1ff0(0x222)]+':\x20'+_0x4f93d[_0x2a1ff0(0x227)]);if(_0x232a6a[_0x2a1ff0(0x216)])this[_0x2a1ff0(0xd6)](_0x232a6a[_0x2a1ff0(0x16d)],_0x232a6a[_0x2a1ff0(0x222)],{'success':![],'error':_0x4f93d[_0x2a1ff0(0x227)]},_0x232a6a['callback']);}}async['processSensorEvent'](_0x16e638,_0xcc7c93,_0x933758){const _0x18168d=a0_0x461d2f;if(!_0x933758[_0x18168d(0xd2)]&&this['sensorLastValues'][_0x16e638]===_0xcc7c93[_0x18168d(0x1bf)])return;this[_0x18168d(0x224)][_0x16e638]=_0xcc7c93['val'];if(this[_0x18168d(0x19b)])return;const _0x421f00=await this[_0x18168d(0xc4)]();if(_0x421f00){if(!this[_0x18168d(0x173)])this[_0x18168d(0x97)](!![]);}else{const _0x4404f8=_0x933758[_0x18168d(0x187)]===!![];_0x4404f8?this[_0x18168d(0x11d)]():(this[_0x18168d(0x240)]&&(this[_0x18168d(0x9d)][_0x18168d(0x144)](_0x18168d(0xd1)),this[_0x18168d(0x1d2)]()),!this[_0x18168d(0x173)]&&this[_0x18168d(0x23f)]===SYSTEM_MODES[_0x18168d(0x14a)]&&this['setPresence'](!![]));}const _0x521b66={'timestamp':_0xcc7c93['ts'],'id':_0x16e638,'name':_0x933758[_0x18168d(0x1a2)],'value':_0xcc7c93[_0x18168d(0x1bf)],'location':_0x933758[_0x18168d(0x161)],'type':_0x933758[_0x18168d(0x177)]};this[_0x18168d(0x100)][_0x18168d(0x1ed)](_0x521b66);if(this[_0x18168d(0x100)][_0x18168d(0x18d)]>HISTORY_MAX_SIZE)this[_0x18168d(0x100)]['pop']();await this[_0x18168d(0x181)](_0x18168d(0xd5),{'val':JSON[_0x18168d(0x148)](_0x521b66),'ack':!![]}),await this[_0x18168d(0x181)](_0x18168d(0x1fa),{'val':JSON[_0x18168d(0x148)](this['eventHistory']),'ack':!![]}),this['rawEventLog'][_0x18168d(0x22f)]({'timestamp':new Date(_0xcc7c93['ts'])[_0x18168d(0xe4)](),'sensorName':_0x933758[_0x18168d(0x1a2)],'location':_0x933758[_0x18168d(0x161)],'value':_0xcc7c93['val']}),await this[_0x18168d(0x22a)]();}async[a0_0x461d2f(0x1a3)](){const _0x21559d=a0_0x461d2f,_0x361f68=this[_0x21559d(0x183)][_0x21559d(0xa2)],_0x1733b3=this[_0x21559d(0x183)][_0x21559d(0x20b)],_0x20dc2b=this[_0x21559d(0x100)]['length']>0x0?this[_0x21559d(0x100)][0x0][_0x21559d(0xcd)]:Date[_0x21559d(0x217)](),_0x4e68ea=(Date[_0x21559d(0x217)]()-_0x20dc2b)/(0x3e8*0x3c*0x3c);let _0x204a96='';_0x1733b3&&this[_0x21559d(0x23f)]===SYSTEM_MODES[_0x21559d(0x14a)]&&this[_0x21559d(0x173)]&&(_0x4e68ea>_0x361f68&&(_0x204a96=_0x21559d(0x168)+_0x4e68ea[_0x21559d(0x250)](0x1)+_0x21559d(0x20e)));if(_0x204a96){this[_0x21559d(0x1f4)](_0x204a96)[_0x21559d(0x23d)](_0x3c31a3=>this['log']['error'](_0x3c31a3));return;}const _0xfca3c2=Date[_0x21559d(0x217)](),_0x30e1d5=_0xfca3c2-_0x20dc2b,_0x55e677=(this['config']['analysisInterval']||0xf)*0x3c*0x3e8;this['eventHistory'][_0x21559d(0x18d)]>0x0&&_0x30e1d5<=_0x55e677?this[_0x21559d(0x1f4)]()[_0x21559d(0x23d)](_0x51f6b9=>this['log'][_0x21559d(0x96)](_0x51f6b9)):!this[_0x21559d(0x90)]&&(this[_0x21559d(0xbc)](_0x21559d(0xf4),{'val':![],'ack':!![]}),this['setState'](_0x21559d(0x205),{'val':![],'ack':!![]}));}async[a0_0x461d2f(0x1f4)](_0x1add51=''){const _0x232fcd=a0_0x461d2f;if(!this[_0x232fcd(0xff)])return;const _0x6b9f41=this['eventHistory'][_0x232fcd(0x18d)]>0x0?this[_0x232fcd(0x100)]:[{'note':'No\x20recorded\x20events\x20yet.'}],_0x3be530=PERSONA_MAPPING[this[_0x232fcd(0x183)]['aiPersona']||_0x232fcd(0x16a)],_0x57932e=this[_0x232fcd(0x183)][_0x232fcd(0x1e4)]||'',_0x309684=this[_0x232fcd(0x23f)],_0x519151=await this[_0x232fcd(0x1ff)](),_0x43b84c=await this[_0x232fcd(0xde)](),_0x3d2507=(_0x519151+'\x20'+_0x43b84c)[_0x232fcd(0x1ca)](),_0x5423f6=new Date(),_0x350cb6=_0x5423f6[_0x232fcd(0x229)](_0x232fcd(0x186),{'weekday':_0x232fcd(0x13d),'hour':_0x232fcd(0x120),'minute':_0x232fcd(0x120)}),_0x1a1616=this[_0x232fcd(0xe0)];let _0x3e1945='';if(this[_0x232fcd(0x1c9)][_0x232fcd(0x18d)]>0x0){const _0x43c1db=this[_0x232fcd(0x1c9)][_0x232fcd(0x233)](0x0,0x3)[_0x232fcd(0x106)](_0x33587b=>_0x232fcd(0x123)+_0x33587b['alertReason']+_0x232fcd(0x1bc)+_0x33587b[_0x232fcd(0x1b3)]+'.')[_0x232fcd(0x21d)]('\x0a');_0x3e1945=_0x232fcd(0x15e)+_0x43c1db+'\x0a';}const _0xaee581=_0x1add51?'\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a'+_0x1add51+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x431b1a=_0x232fcd(0x108),_0x186663=_0x232fcd(0x127)+_0x350cb6+_0x232fcd(0x1c4)+_0x1a1616[_0x232fcd(0x1f2)]+_0x232fcd(0x15d)+_0x309684+_0x232fcd(0x140)+(this[_0x232fcd(0x173)]?'Ja':'Nein')+_0x232fcd(0xbd)+_0x57932e+_0x232fcd(0x22e)+_0x3be530+_0x232fcd(0x113)+_0x3d2507+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x431b1a+'\x20'+_0x3e1945+'\x20'+_0xaee581+_0x232fcd(0xcc)+JSON['stringify'](_0x6b9f41)+_0x232fcd(0xb5);try{const _0x169f77=await this[_0x232fcd(0xff)][_0x232fcd(0xdc)](_0x186663),_0x194cb8=_0x169f77[_0x232fcd(0x1be)][_0x232fcd(0x236)]()[_0x232fcd(0x1f9)](/```json|```/g,'')[_0x232fcd(0x1ca)](),_0x2b16a9=JSON[_0x232fcd(0x166)](_0x194cb8);await this[_0x232fcd(0x181)](_0x232fcd(0x15b),{'val':_0x194cb8,'ack':!![]}),await this[_0x232fcd(0x181)](_0x232fcd(0x8e),{'val':_0x2b16a9[_0x232fcd(0xd7)][_0x232fcd(0xf2)]||'','ack':!![]}),await this['setStateAsync'](_0x232fcd(0x1d1),{'val':_0x2b16a9['activity'][_0x232fcd(0x134)]||_0x232fcd(0x1ee),'ack':!![]}),await this[_0x232fcd(0x181)](_0x232fcd(0x12e),{'val':_0x2b16a9[_0x232fcd(0xd7)]['deviationFromBaseline']||_0x232fcd(0x1ee),'ack':!![]});_0x2b16a9['comfort']&&(await this[_0x232fcd(0x181)]('analysis.comfortSummary',{'val':_0x2b16a9['comfort'][_0x232fcd(0x134)]||'','ack':!![]}),await this[_0x232fcd(0x181)](_0x232fcd(0xc7),{'val':_0x2b16a9[_0x232fcd(0x1b9)]['suggestion']||'','ack':!![]}),_0x2b16a9['comfort'][_0x232fcd(0x143)]&&(await this[_0x232fcd(0x181)](_0x232fcd(0xda),{'val':_0x2b16a9[_0x232fcd(0x1b9)][_0x232fcd(0x143)]['patternDetected']||![],'ack':!![]}),await this['setStateAsync'](_0x232fcd(0x1da),{'val':_0x2b16a9[_0x232fcd(0x1b9)]['automationProposal'][_0x232fcd(0x118)]||'','ack':!![]}),await this[_0x232fcd(0x181)]('analysis.automation.suggestedAction',{'val':_0x2b16a9['comfort']['automationProposal']['suggestedAction']||'','ack':!![]})));_0x2b16a9[_0x232fcd(0x162)]&&(await this[_0x232fcd(0x181)](_0x232fcd(0x204),{'val':typeof _0x2b16a9[_0x232fcd(0x162)][_0x232fcd(0x18b)]==='number'?_0x2b16a9[_0x232fcd(0x162)][_0x232fcd(0x18b)]:0x0,'ack':!![]}),await this['setStateAsync']('analysis.health.restlessness',{'val':_0x2b16a9[_0x232fcd(0x162)][_0x232fcd(0x12f)]||_0x232fcd(0xb0),'ack':!![]}),await this[_0x232fcd(0x181)](_0x232fcd(0x1f8),{'val':_0x2b16a9['health']['notes']||'','ack':!![]}));const _0x3b3ae1=_0x2b16a9['activity'][_0x232fcd(0x1f7)]||![],_0x384636=_0x2b16a9[_0x232fcd(0xd7)][_0x232fcd(0x212)]||![];if(_0x3b3ae1||_0x384636){await this[_0x232fcd(0x181)](_0x232fcd(0xf4),{'val':!![],'ack':!![]}),await this[_0x232fcd(0x181)](_0x232fcd(0x205),{'val':_0x384636,'ack':!![]});if(!this[_0x232fcd(0x90)]||_0x384636){const _0x5605e3=_0x384636?_0x232fcd(0x1cf):_0x232fcd(0x203);this[_0x232fcd(0x1fc)](_0x5605e3+':\x20'+_0x2b16a9['activity']['alertReason'],![],_0x384636);}}else await this[_0x232fcd(0x181)](_0x232fcd(0xf4),{'val':![],'ack':!![]}),await this[_0x232fcd(0x181)](_0x232fcd(0x205),{'val':![],'ack':!![]});this[_0x232fcd(0x90)]=_0x3b3ae1||_0x384636;const _0x4c7387={'timestamp':Date['now'](),'id':Date[_0x232fcd(0x217)]()[_0x232fcd(0x1f3)](),'analysis':_0x2b16a9,'systemMode':_0x309684,'isPro':this[_0x232fcd(0x14c)]};this[_0x232fcd(0x11c)](_0x4c7387);}catch(_0x561559){this[_0x232fcd(0x9d)][_0x232fcd(0x96)](_0x232fcd(0x22b)+_0x561559[_0x232fcd(0x227)]);}}async[a0_0x461d2f(0x135)](){const _0x5595fd=a0_0x461d2f;if(!this[_0x5595fd(0xff)]||this[_0x5595fd(0xec)][_0x5595fd(0x18d)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x5595fd(0x181)](LTM_DP_STATUS,{'val':_0x5595fd(0x160),'ack':!![]});return;}this['log']['info']('Creating\x20Daily\x20Digest\x20from\x20'+this[_0x5595fd(0xec)]['length']+_0x5595fd(0x20c)),await this[_0x5595fd(0x181)](LTM_DP_STATUS,{'val':_0x5595fd(0x213),'ack':!![]});const _0x40124a=this[_0x5595fd(0xec)][_0x5595fd(0x18d)]>0x320?this['rawEventLog'][_0x5595fd(0x233)](this[_0x5595fd(0xec)][_0x5595fd(0x18d)]-0x320):this[_0x5595fd(0xec)],_0x1ba1f8=PERSONA_MAPPING[this['config'][_0x5595fd(0x10a)]||'generic'],_0x10a753=_0x5595fd(0x16e)+_0x1ba1f8+_0x5595fd(0x1a4)+JSON['stringify'](_0x40124a)+_0x5595fd(0x1fd);try{const _0x1053d8=await this[_0x5595fd(0xff)]['generateContent'](_0x10a753),_0x436df9=_0x1053d8[_0x5595fd(0x1be)]['text']()[_0x5595fd(0x1f9)](/```json|```/g,'')[_0x5595fd(0x1ca)](),_0x16231f=JSON[_0x5595fd(0x166)](_0x436df9),_0xa0baf={'timestamp':new Date()[_0x5595fd(0xe4)](),'eventCount':this[_0x5595fd(0xec)][_0x5595fd(0x18d)],'summary':_0x16231f[_0x5595fd(0x134)],'activityLevel':_0x16231f[_0x5595fd(0x93)],'health':{'sleepScore':_0x16231f[_0x5595fd(0x162)]?_0x16231f[_0x5595fd(0x162)]['sleepScore']:0x0,'restlessness':_0x16231f[_0x5595fd(0x162)]?_0x16231f['health'][_0x5595fd(0x12f)]:'none'},'systemMode':this[_0x5595fd(0x23f)]};this[_0x5595fd(0xe9)][_0x5595fd(0x22f)](_0xa0baf),await this['saveDailyDigests'](),this['rawEventLog']=[],await this['saveRawEventLog'](),await this[_0x5595fd(0x181)](LTM_DP_STATUS,{'val':_0x5595fd(0x128),'ack':!![]}),this[_0x5595fd(0x9d)][_0x5595fd(0x144)](_0x5595fd(0x23c));}catch(_0x24713a){this[_0x5595fd(0x9d)]['error'](_0x5595fd(0x17c)+_0x24713a[_0x5595fd(0x227)]),await this[_0x5595fd(0x181)](LTM_DP_STATUS,{'val':_0x5595fd(0xa8)+_0x24713a[_0x5595fd(0x227)],'ack':!![]});}}async[a0_0x461d2f(0x152)](){const _0x2dafce=a0_0x461d2f;if(!this['geminiModel'])return;this[_0x2dafce(0x9d)][_0x2dafce(0x144)](_0x2dafce(0x185));const _0x19ab20=this[_0x2dafce(0xe9)][_0x2dafce(0x18d)]>0x0?this['dailyDigests'][this[_0x2dafce(0xe9)][_0x2dafce(0x18d)]-0x1]:null,_0x12c895=_0x19ab20&&_0x19ab20[_0x2dafce(0x162)]?_0x19ab20[_0x2dafce(0x162)]['sleepScore']:_0x2dafce(0x1ee),_0x1b1b8b=new Date();_0x1b1b8b[_0x2dafce(0x1dc)](0x4,0x0,0x0,0x0);const _0xebaa12=this[_0x2dafce(0x100)][_0x2dafce(0x15c)](_0x436f9d=>new Date(_0x436f9d['timestamp'])>_0x1b1b8b),_0x31e2fe=PERSONA_MAPPING[this[_0x2dafce(0x183)]['aiPersona']||'generic'],_0x4d4b56=this[_0x2dafce(0x183)]['livingContext']||'',_0x3bf650=await this[_0x2dafce(0x1ff)](),_0x2cba5d=await this[_0x2dafce(0xde)](),_0x5f3010=_0x2dafce(0x196)+_0x31e2fe+_0x2dafce(0x1fb)+_0x4d4b56+_0x2dafce(0x24a)+_0x3bf650+'\x20'+_0x2cba5d+_0x2dafce(0x10e)+_0x12c895+_0x2dafce(0xdd)+JSON[_0x2dafce(0x148)](_0xebaa12[_0x2dafce(0x233)](0x0,0xa))+_0x2dafce(0x21a);try{const _0x54d0f5=await this[_0x2dafce(0xff)][_0x2dafce(0xdc)](_0x5f3010),_0x2dd12c=_0x2dafce(0x1a0)+_0x54d0f5['response'][_0x2dafce(0x236)]()[_0x2dafce(0x1ca)]();this[_0x2dafce(0x1fc)](_0x2dd12c),this['log'][_0x2dafce(0x144)](_0x2dafce(0x9b));}catch(_0x50d517){this[_0x2dafce(0x9d)][_0x2dafce(0x96)](_0x2dafce(0xfd)+_0x50d517[_0x2dafce(0x227)]);}}[a0_0x461d2f(0xb7)](_0x511461){const _0x5d264f=a0_0x461d2f;if(typeof _0x511461===_0x5d264f(0xef))return _0x511461;try{return JSON['parse'](_0x511461);}catch(_0x27d59c){return null;}}async[a0_0x461d2f(0x1ff)](){const _0xef596c=a0_0x461d2f;try{if(!this[_0xef596c(0x183)][_0xef596c(0xc3)])return'Wetter:\x20Deaktiviert';let _0x59c82d='';const _0x3276b6=this[_0xef596c(0x183)][_0xef596c(0x197)];if(_0x3276b6)try{if(_0x3276b6['includes'](_0xef596c(0xac))){const _0x4e52c9=await this[_0xef596c(0xfb)](_0x3276b6+_0xef596c(0xc8));if(_0x4e52c9&&_0x4e52c9[_0xef596c(0x1bf)])_0x59c82d=_0x4e52c9[_0xef596c(0x1bf)];}else{if(_0x3276b6[_0xef596c(0x112)]('daswetter')){const _0x4564cc=await this[_0xef596c(0xfb)](_0x3276b6+_0xef596c(0x11b));if(_0x4564cc&&_0x4564cc[_0xef596c(0x1bf)])_0x59c82d=_0x4564cc['val'];}else{if(_0x3276b6['includes']('openweathermap')){const _0x34ecdc=await this['getForeignStateAsync'](_0x3276b6+'.forecast.current.state');if(_0x34ecdc&&_0x34ecdc[_0xef596c(0x1bf)])_0x59c82d=_0x34ecdc['val'];}}}}catch(_0x4ff7aa){}if(!_0x59c82d){const _0x1ff738=[_0xef596c(0x110),'daswetter.0',_0xef596c(0x18a),_0xef596c(0x1d7)];for(const _0x5e0c97 of _0x1ff738){try{const _0x28077b=await this[_0xef596c(0x92)](_0x5e0c97);if(_0x28077b){if(_0x5e0c97[_0xef596c(0x112)](_0xef596c(0xac))){const _0x50f87d=await this[_0xef596c(0xfb)](_0x5e0c97+_0xef596c(0xc8));if(_0x50f87d&&_0x50f87d['val']){_0x59c82d=_0x50f87d[_0xef596c(0x1bf)];break;}}}}catch(_0x2778a3){}}}return _0x59c82d?_0xef596c(0x13f)+_0x59c82d:_0xef596c(0x12d);}catch(_0xe7c0ca){return _0xef596c(0x172)+_0xe7c0ca[_0xef596c(0x227)];}}async[a0_0x461d2f(0xde)](){const _0x3f432c=a0_0x461d2f;try{if(!this[_0x3f432c(0x183)]['useCalendar'])return _0x3f432c(0x13c);let _0x59c8c8=this[_0x3f432c(0x183)][_0x3f432c(0xf7)]||'ical.0',_0x16d94c=this[_0x3f432c(0x183)][_0x3f432c(0x10c)]||[];if(typeof _0x16d94c==='string')_0x16d94c=_0x16d94c['split'](',');try{const _0x48e7bf=await this[_0x3f432c(0xfb)](_0x59c8c8+_0x3f432c(0x208));if(_0x48e7bf&&_0x48e7bf['val']){let _0x27424e=this[_0x3f432c(0xb7)](_0x48e7bf[_0x3f432c(0x1bf)]);if(_0x27424e&&Array[_0x3f432c(0xf3)](_0x27424e)){if(_0x16d94c['length']>0x0)_0x27424e=_0x27424e['filter'](_0x24581c=>_0x16d94c[_0x3f432c(0x112)](_0x24581c[_0x3f432c(0x94)]||''));else return _0x3f432c(0x11a);if(_0x27424e['length']>0x0){const _0x3481ec=_0x27424e[_0x3f432c(0x233)](0x0,0x3)['map'](_0x432e38=>{const _0x36936b=_0x3f432c;let _0x42a557=_0x432e38[_0x36936b(0x102)];if(_0x432e38[_0x36936b(0xee)])_0x42a557+='\x20'+_0x432e38[_0x36936b(0xee)];return _0x42a557+':\x20'+_0x432e38[_0x36936b(0x138)]+'\x20('+_0x432e38[_0x36936b(0x94)]+')';});return'KALENDER:\x20'+_0x3481ec['join'](_0x3f432c(0x1d9));}else return _0x3f432c(0x1cb);}}}catch(_0x4e3432){this[_0x3f432c(0x9d)][_0x3f432c(0x15f)]('Error\x20reading\x20calendar\x20table:\x20'+_0x4e3432['message']);}return _0x3f432c(0x1de);}catch(_0x2bbc30){return _0x3f432c(0x20a)+_0x2bbc30[_0x3f432c(0x227)];}}async['getCalendarNames'](_0x5cf288){const _0x468e56=a0_0x461d2f;try{const _0xee1898=await this[_0x468e56(0xfb)](_0x5cf288+_0x468e56(0x208));if(_0xee1898&&_0xee1898[_0x468e56(0x1bf)]){const _0x558a8b=this[_0x468e56(0xb7)](_0xee1898[_0x468e56(0x1bf)]);if(_0x558a8b&&Array[_0x468e56(0xf3)](_0x558a8b)){const _0x389b34=[...new Set(_0x558a8b[_0x468e56(0x106)](_0x4f0203=>_0x4f0203['_calName'])[_0x468e56(0x15c)](Boolean))];return _0x389b34[_0x468e56(0x1eb)]();}}return[];}catch(_0x1565a2){return this[_0x468e56(0x9d)][_0x468e56(0x96)](_0x468e56(0x103)+_0x1565a2['message']),[];}}async[a0_0x461d2f(0x237)](){const _0x2be565=a0_0x461d2f;try{const _0x4bc957=await this['getStateAsync']('events.history');_0x4bc957&&_0x4bc957[_0x2be565(0x1bf)]&&(this[_0x2be565(0x100)]=JSON['parse'](_0x4bc957[_0x2be565(0x1bf)][_0x2be565(0x1f3)]()));}catch(_0x343b85){this[_0x2be565(0x100)]=[];}try{const _0x49b16c=await this[_0x2be565(0x16f)](_0x2be565(0x1fe));if(_0x49b16c&&_0x49b16c[_0x2be565(0x1bf)])this[_0x2be565(0x18f)]=JSON[_0x2be565(0x166)](_0x49b16c[_0x2be565(0x1bf)][_0x2be565(0x1f3)]());}catch(_0x1c313e){this[_0x2be565(0x18f)]=[];}}async['getSystemUUID'](){const _0x3a6b88=a0_0x461d2f;try{const _0x1b8451=await this[_0x3a6b88(0x92)](_0x3a6b88(0x228));if(_0x1b8451&&_0x1b8451['native']&&_0x1b8451[_0x3a6b88(0x122)][_0x3a6b88(0x1b8)])return _0x1b8451[_0x3a6b88(0x122)][_0x3a6b88(0x1b8)];return'uuid-not-found';}catch(_0x21ad8c){return'uuid-error';}}async['checkLicense'](_0x149cd4){const _0x193959=a0_0x461d2f;if(!_0x149cd4)return![];this['systemUUID']=await this[_0x193959(0x95)]();if(_0x149cd4===_0x193959(0x1c5)||_0x149cd4[_0x193959(0x1f1)](_0x193959(0xe6)))return!![];return![];}async[a0_0x461d2f(0x232)](){const _0x33d879=a0_0x461d2f;await this['extendObjectAsync'](_0x33d879(0x10d),{'type':_0x33d879(0x150),'common':{'name':_0x33d879(0x10d)},'native':{}}),await this[_0x33d879(0x9f)](LTM_DP_RAW_LOG,{'type':_0x33d879(0x1a9),'common':{'name':_0x33d879(0x22d),'type':_0x33d879(0xc2),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x33d879(0x9f)](LTM_DP_DAILY_DIGESTS,{'type':_0x33d879(0x1a9),'common':{'name':_0x33d879(0xbb),'type':_0x33d879(0xc2),'role':_0x33d879(0x131),'read':!![],'write':![]},'native':{}}),await this[_0x33d879(0x9f)](LTM_DP_STATUS,{'type':'state','common':{'name':_0x33d879(0xea),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x33d879(0x1a9),'common':{'name':_0x33d879(0x104),'type':'boolean','role':_0x33d879(0x21c),'read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':_0x33d879(0x1d0),'type':_0x33d879(0xc2),'role':_0x33d879(0x236),'read':!![],'write':![]},'native':{}});}async['checkLtmDriftObjects'](){const _0x1d3e24=a0_0x461d2f;await this[_0x1d3e24(0x9f)](LTM_DP_DRIFT_CHANNEL,{'type':_0x1d3e24(0x150),'common':{'name':_0x1d3e24(0x142)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x1d3e24(0x206),'type':'string','role':_0x1d3e24(0x1a9),'read':!![],'write':![],'def':_0x1d3e24(0x1ee)},'native':{}}),await this[_0x1d3e24(0x9f)](LTM_DP_DRIFT_DETAILS,{'type':_0x1d3e24(0x1a9),'common':{'name':_0x1d3e24(0x1cd),'type':_0x1d3e24(0xc2),'role':'text','read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x1d3e24(0x1a9),'common':{'name':_0x1d3e24(0x1a1),'type':_0x1d3e24(0x194),'role':_0x1d3e24(0x102),'read':!![],'write':![]},'native':{}});}async['checkSystemObjects'](){const _0x253c1a=a0_0x461d2f;await this['extendObjectAsync'](_0x253c1a(0x188),{'type':'channel','common':{'name':_0x253c1a(0x130)},'native':{}}),await this[_0x253c1a(0x9f)](SYSTEM_DP_MODE,{'type':_0x253c1a(0x1a9),'common':{'name':_0x253c1a(0x24f),'type':_0x253c1a(0xc2),'role':_0x253c1a(0x1a9),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x253c1a(0x14a)],'states':{[SYSTEM_MODES[_0x253c1a(0x14a)]]:'Normal',[SYSTEM_MODES[_0x253c1a(0x1d3)]]:_0x253c1a(0x1bb),[SYSTEM_MODES[_0x253c1a(0x219)]]:_0x253c1a(0x1ef),[SYSTEM_MODES[_0x253c1a(0xaf)]]:_0x253c1a(0x182)}},'native':{}});}async[a0_0x461d2f(0x1fc)](_0x50bab7,_0x592631=![],_0x260b1b=![]){const _0x4d1fec=a0_0x461d2f;this['log']['info']((_0x592631?'[TEST]\x20':'')+'Sending\x20notification:\x20\x22'+_0x50bab7+'\x22'+(_0x260b1b?'\x20(EMERGENCY)':''));const _0x217c0a=this[_0x4d1fec(0x183)];let _0x2fd8b7=0x0;_0x217c0a['notifyTelegramEnabled']&&_0x217c0a[_0x4d1fec(0x220)]&&(await this['sendToAsync'](_0x217c0a[_0x4d1fec(0x220)],'send',{'text':_0x50bab7,'user':_0x217c0a[_0x4d1fec(0x8f)]}),_0x2fd8b7++);if(_0x217c0a[_0x4d1fec(0x1c1)]&&_0x217c0a[_0x4d1fec(0x218)]){let _0x15b5b6={'message':_0x50bab7,'title':_0x260b1b?'üö®\x20EMERGENCY':_0x4d1fec(0x1b5),'priority':_0x260b1b?0x2:0x1,'device':_0x217c0a[_0x4d1fec(0x1ab)]};_0x260b1b&&(_0x15b5b6[_0x4d1fec(0x1b6)]=0x1e,_0x15b5b6[_0x4d1fec(0x107)]=0xe10,_0x15b5b6[_0x4d1fec(0x23b)]=_0x4d1fec(0x115)),await this['sendToAsync'](_0x217c0a[_0x4d1fec(0x218)],'send',_0x15b5b6),_0x2fd8b7++;}return _0x217c0a['notifyEmailEnabled']&&_0x217c0a['notifyEmailInstance']&&(await this[_0x4d1fec(0x9a)](_0x217c0a['notifyEmailInstance'],_0x4d1fec(0x167),{'text':_0x50bab7,'to':_0x217c0a[_0x4d1fec(0x9e)]}),_0x2fd8b7++),_0x217c0a[_0x4d1fec(0x214)]&&_0x217c0a['notifyWhatsappInstance']&&(await this[_0x4d1fec(0x9a)](_0x217c0a[_0x4d1fec(0x1e9)],_0x4d1fec(0x167),{'text':_0x50bab7,'phone':_0x217c0a[_0x4d1fec(0x198)]}),_0x2fd8b7++),_0x217c0a[_0x4d1fec(0x1e5)]&&_0x217c0a[_0x4d1fec(0xa0)]&&(await this[_0x4d1fec(0x9a)](_0x217c0a[_0x4d1fec(0xa0)],'send',{'text':_0x50bab7,'phone':_0x217c0a[_0x4d1fec(0xae)]}),_0x2fd8b7++),_0x2fd8b7;}async[a0_0x461d2f(0xcb)](_0x458453={}){const _0x3630f0=a0_0x461d2f;this['log'][_0x3630f0(0x144)](_0x3630f0(0x184)+JSON['stringify'](_0x458453));const _0x279b55=[],_0xab2534=_0x458453['motion']!==![],_0x1df927=_0x458453[_0x3630f0(0x1e6)]!==![],_0xdbfb9e=_0x458453[_0x3630f0(0x164)]!==![],_0x364de6=_0x458453[_0x3630f0(0x1d4)]===!![],_0x5efba8=_0x458453[_0x3630f0(0x1e3)]===!![],_0x3f7c62=_0x458453['selectedFunctionIds']||[],_0xa7be86=await this[_0x3630f0(0x1b1)](_0x3630f0(0x1df),'enum'),_0x16246d=await this['getForeignObjectsAsync'](_0x3630f0(0x14e),_0x3630f0(0x24c)),_0x1c60d6={},_0x2def0d={},_0x271620={},_0x50ac5b=(_0xef97ea,_0x26a405,_0x4e5979=![])=>{const _0x5b8c03=_0x3630f0;if(!_0xef97ea)return;for(const _0x5b4056 in _0xef97ea){const _0x2870f8=_0xef97ea[_0x5b4056];if(_0x2870f8&&_0x2870f8[_0x5b8c03(0xd3)]&&_0x2870f8[_0x5b8c03(0xd3)]['members']){const _0x5a024b=(typeof _0x2870f8[_0x5b8c03(0xd3)][_0x5b8c03(0x1a2)]===_0x5b8c03(0xef)?_0x2870f8['common'][_0x5b8c03(0x1a2)]['de']:_0x2870f8[_0x5b8c03(0xd3)]['name'])||_0x2870f8['common'][_0x5b8c03(0x1a2)];if(_0x4e5979)_0x271620[_0x5b4056]=_0x5a024b;for(const _0x3466b7 of _0x2870f8['common'][_0x5b8c03(0x23a)]){if(_0x4e5979){if(!_0x26a405[_0x3466b7])_0x26a405[_0x3466b7]=[];_0x26a405[_0x3466b7]['push'](_0x5b4056);}else _0x26a405[_0x3466b7]=_0x5a024b;}}}};_0x50ac5b(_0xa7be86,_0x1c60d6),_0x50ac5b(_0x16246d,_0x2def0d,!![]);const _0x27b128=await this[_0x3630f0(0x1b1)]('*',_0x3630f0(0x1a9)),_0x1e15dc=['UNREACH',_0x3630f0(0xd0),_0x3630f0(0x23e),_0x3630f0(0x169),_0x3630f0(0x223),_0x3630f0(0x202),_0x3630f0(0x159),_0x3630f0(0x147),'DUTYCYCLE',_0x3630f0(0x11e),_0x3630f0(0xa7),_0x3630f0(0x132),_0x3630f0(0x176),_0x3630f0(0x155),_0x3630f0(0x11f),'COMBINED_PARAMETER',_0x3630f0(0x248),_0x3630f0(0x10b),_0x3630f0(0xb4),_0x3630f0(0xb6),'PROCESS',_0x3630f0(0xf0),_0x3630f0(0x242),_0x3630f0(0x146),_0x3630f0(0xf9),'battery','update',_0x3630f0(0x247),'version',_0x3630f0(0x1ad),'info','signal',_0x3630f0(0x225),_0x3630f0(0x149),_0x3630f0(0xdb),'alert',_0x3630f0(0x119),_0x3630f0(0xe7),_0x3630f0(0xf1),'xy','ct','hue',_0x3630f0(0xf8),_0x3630f0(0x22c),_0x3630f0(0x1b7),_0x3630f0(0x1aa),_0x3630f0(0x1ba),_0x3630f0(0x222),_0x3630f0(0xc9),_0x3630f0(0x118),_0x3630f0(0xab),_0x3630f0(0x189),_0x3630f0(0xa5),_0x3630f0(0xe5),_0x3630f0(0x221),_0x3630f0(0x137),'summary',_0x3630f0(0xa1),'history',_0x3630f0(0x12c),_0x3630f0(0x144),'json'];if(!_0x5efba8)_0x1e15dc[_0x3630f0(0x22f)](_0x3630f0(0x1a6),_0x3630f0(0x1e3),'wind','pressure','uv',_0x3630f0(0xba),_0x3630f0(0x12b));const _0x4ba6d9=[_0x3630f0(0x199),_0x3630f0(0x17a),_0x3630f0(0x246),'vis.','history.',_0x3630f0(0xb8),_0x3630f0(0x1e0),_0x3630f0(0x151)];if(!_0x5efba8)_0x4ba6d9[_0x3630f0(0x22f)]('daswetter.',_0x3630f0(0x157),_0x3630f0(0x238),_0x3630f0(0x153),_0x3630f0(0x158));const _0x245f38=(_0x37a7ce,_0x380f09,_0x4a0228=![])=>{const _0x34a600=_0x3630f0,_0x2e3932=_0x37a7ce[_0x34a600(0x1b2)]('.');if(_0x380f09[_0x37a7ce])return _0x380f09[_0x37a7ce];if(_0x2e3932['length']>0x2&&_0x380f09[_0x2e3932[_0x34a600(0x233)](0x0,-0x1)[_0x34a600(0x21d)]('.')])return _0x380f09[_0x2e3932[_0x34a600(0x233)](0x0,-0x1)[_0x34a600(0x21d)]('.')];if(_0x2e3932[_0x34a600(0x18d)]>0x3&&_0x380f09[_0x2e3932[_0x34a600(0x233)](0x0,-0x2)[_0x34a600(0x21d)]('.')])return _0x380f09[_0x2e3932[_0x34a600(0x233)](0x0,-0x2)[_0x34a600(0x21d)]('.')];return _0x4a0228?[]:null;};for(const _0x2064f9 in _0x27b128){const _0x16913a=_0x27b128[_0x2064f9];if(!_0x16913a||!_0x16913a[_0x3630f0(0xd3)])continue;if(_0x4ba6d9[_0x3630f0(0xaa)](_0x2ac6ee=>_0x2064f9[_0x3630f0(0x1f1)](_0x2ac6ee)))continue;const _0x5d9127=_0x16913a[_0x3630f0(0xd3)]['role']||'',_0x3ca48c=(_0x16913a[_0x3630f0(0xd3)][_0x3630f0(0x1a2)]&&typeof _0x16913a[_0x3630f0(0xd3)][_0x3630f0(0x1a2)]===_0x3630f0(0xef)?_0x16913a[_0x3630f0(0xd3)]['name']['de']:_0x16913a[_0x3630f0(0xd3)][_0x3630f0(0x1a2)])||'',_0x55d65d=_0x3ca48c?_0x3ca48c[_0x3630f0(0x139)]():'',_0x599034=_0x2064f9[_0x3630f0(0x139)](),_0x353f3c=_0x245f38(_0x2064f9,_0x1c60d6),_0x439608=_0x245f38(_0x2064f9,_0x2def0d,!![]);let _0x3cc926=null,_0x40ca60=![];if(_0x439608&&_0x439608[_0x3630f0(0x18d)]>0x0){const _0x1e2cd4=_0x439608[_0x3630f0(0xe8)](_0x553e8f=>_0x3f7c62[_0x3630f0(0x112)](_0x553e8f));if(_0x1e2cd4){_0x40ca60=!![];const _0x151499=_0x271620[_0x1e2cd4];if(_0x599034['includes'](_0x3630f0(0xb9))||_0x599034[_0x3630f0(0x112)](_0x3630f0(0xe1)))_0x3cc926='Bewegung';else{if(_0x599034[_0x3630f0(0x112)](_0x3630f0(0x253))||_0x599034[_0x3630f0(0x112)]('fire')||_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0x174)))_0x3cc926='Rauchmelder';else{if(_0x599034[_0x3630f0(0x112)](_0x3630f0(0x1a9))||_0x599034['includes'](_0x3630f0(0x13a))||_0x599034[_0x3630f0(0x112)]('on'))_0x3cc926=_0x3630f0(0x207);else _0x3cc926=_0x151499;}}}}if(!_0x40ca60&&!_0x5efba8){if(_0x1e15dc[_0x3630f0(0xaa)](_0x2c02c0=>_0x55d65d['includes'](_0x2c02c0)||_0x2064f9[_0x3630f0(0xa3)]()['includes'](_0x2c02c0)))continue;}if(!_0x3cc926&&_0xab2534){if(_0x5d9127[_0x3630f0(0x112)](_0x3630f0(0x1d6))||_0x5d9127[_0x3630f0(0x112)]('occupancy')||_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0xb1))||_0x55d65d[_0x3630f0(0x112)]('pr√§senz'))_0x3cc926=_0x3630f0(0x209);}!_0x3cc926&&_0x1df927&&((_0x599034[_0x3630f0(0x112)](_0x3630f0(0x17d))||_0x5d9127[_0x3630f0(0x112)]('sensor.door')||_0x5d9127[_0x3630f0(0x112)]('sensor.window')||(_0x55d65d[_0x3630f0(0x112)]('fenster')||_0x55d65d[_0x3630f0(0x112)]('t√ºr'))&&!_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0xe2))&&!_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0x109))&&(_0x16913a[_0x3630f0(0xd3)][_0x3630f0(0x177)]==='boolean'||_0x16913a[_0x3630f0(0xd3)][_0x3630f0(0x177)]===_0x3630f0(0x194)))&&(_0x3cc926=_0x3630f0(0x114)));if(!_0x3cc926&&_0xdbfb9e){if((_0x5d9127[_0x3630f0(0x112)](_0x3630f0(0x13b))||_0x5d9127[_0x3630f0(0x112)]('level.dimmer')||_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0xcf))||_0x55d65d['includes'](_0x3630f0(0x235)))&&_0x16913a[_0x3630f0(0xd3)][_0x3630f0(0x18c)])_0x3cc926=_0x3630f0(0x243);}if(!_0x3cc926&&_0x364de6){if(_0x5d9127[_0x3630f0(0x112)](_0x3630f0(0x1d5))||_0x5d9127[_0x3630f0(0x112)](_0x3630f0(0x129))||_0x55d65d[_0x3630f0(0x112)]('temperatur'))_0x3cc926=_0x3630f0(0xf5);}if(_0x3cc926){let _0x2cee58=_0x353f3c||'';if(!_0x2cee58){if(_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0x231)))_0x2cee58=_0x3630f0(0x1af);else{if(_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0xc5)))_0x2cee58='K√ºche';else{if(_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0x21f)))_0x2cee58=_0x3630f0(0x1c2);else{if(_0x55d65d[_0x3630f0(0x112)]('schlaf'))_0x2cee58='Schlafzimmer';else{if(_0x55d65d['includes'](_0x3630f0(0x156))||_0x55d65d['includes']('diele'))_0x2cee58=_0x3630f0(0x1c7);else{if(_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0x124)))_0x2cee58=_0x3630f0(0x116);}}}}}}let _0xf9668b=![];_0x3cc926===_0x3630f0(0x114)&&((_0x55d65d['includes']('haust√ºr')||_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0xf6))||_0x55d65d[_0x3630f0(0x112)](_0x3630f0(0x226))||_0x2cee58&&_0x2cee58[_0x3630f0(0x139)]()[_0x3630f0(0x112)](_0x3630f0(0x156))&&_0x55d65d['includes'](_0x3630f0(0x1d8)))&&(_0xf9668b=!![]));let _0x149510=0x0;if(_0x40ca60)_0x149510+=0x1e;else{if(_0x353f3c)_0x149510+=0x14;else{if(_0x2cee58)_0x149510+=0xa;}}if(_0xf9668b)_0x149510+=0x5;_0x279b55[_0x3630f0(0x22f)]({'id':_0x2064f9,'name':_0x3ca48c||_0x2064f9,'type':_0x3cc926,'location':_0x2cee58,'logDuplicates':_0x3cc926===_0x3630f0(0x209),'isExit':_0xf9668b,'_score':_0x149510});}}return _0x279b55[_0x3630f0(0x1eb)]((_0x30be81,_0x485616)=>_0x485616[_0x3630f0(0x1e8)]-_0x30be81['_score']),_0x279b55;}async[a0_0x461d2f(0x11d)](){const _0x93dcea=a0_0x461d2f;this[_0x93dcea(0x1d2)](),this[_0x93dcea(0x19b)]=!![],this[_0x93dcea(0x19a)]=setTimeout(()=>{const _0x2fdb77=_0x93dcea;this[_0x2fdb77(0x19b)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x93dcea(0x240)]=setTimeout(()=>{const _0x339cad=_0x93dcea;this[_0x339cad(0x97)](![]),this[_0x339cad(0x240)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}async[a0_0x461d2f(0x1d2)](){const _0x12b4bc=a0_0x461d2f;if(this[_0x12b4bc(0x240)])clearTimeout(this[_0x12b4bc(0x240)]);if(this[_0x12b4bc(0x19a)])clearTimeout(this['exitGraceTimer']);this['exitTimer']=null,this[_0x12b4bc(0x19a)]=null,this['isGracePeriodActive']=![];}async[a0_0x461d2f(0x97)](_0x3fc6c9){const _0xc86399=a0_0x461d2f;if(this[_0xc86399(0x173)]===_0x3fc6c9)return;this[_0xc86399(0x173)]=_0x3fc6c9,await this[_0xc86399(0x181)]('system.isPresent',{'val':_0x3fc6c9,'ack':!![]});}}if(require[a0_0x461d2f(0xd4)]!==module)module[a0_0x461d2f(0x241)]=_0x476895=>new CogniLiving(_0x476895);else new CogniLiving();