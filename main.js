const a0_0x5f2b3f=a0_0x2869;(function(_0x48846d,_0x285aa9){const _0x32c1b1=a0_0x2869,_0x520d2a=_0x48846d();while(!![]){try{const _0x2d0697=-parseInt(_0x32c1b1(0x2b9))/0x1+-parseInt(_0x32c1b1(0x198))/0x2+parseInt(_0x32c1b1(0x1d0))/0x3+-parseInt(_0x32c1b1(0x24c))/0x4+parseInt(_0x32c1b1(0x1b2))/0x5+-parseInt(_0x32c1b1(0x1af))/0x6*(-parseInt(_0x32c1b1(0x286))/0x7)+parseInt(_0x32c1b1(0x20d))/0x8*(-parseInt(_0x32c1b1(0x2fa))/0x9);if(_0x2d0697===_0x285aa9)break;else _0x520d2a['push'](_0x520d2a['shift']());}catch(_0x20ff48){_0x520d2a['push'](_0x520d2a['shift']());}}}(a0_0x44d2,0x86658));const a0_0x13a496=(function(){let _0x2d0192=!![];return function(_0x2915ae,_0x350a24){const _0x3a9390=_0x2d0192?function(){const _0x3072d3=a0_0x2869;if(_0x350a24){const _0x18aad3=_0x350a24[_0x3072d3(0x2d1)](_0x2915ae,arguments);return _0x350a24=null,_0x18aad3;}}:function(){};return _0x2d0192=![],_0x3a9390;};}()),a0_0x3d2d9c=a0_0x13a496(this,function(){const _0x486e1c=a0_0x2869;return a0_0x3d2d9c[_0x486e1c(0x19e)]()[_0x486e1c(0x1e8)](_0x486e1c(0x29d))[_0x486e1c(0x19e)]()[_0x486e1c(0x1e6)](a0_0x3d2d9c)[_0x486e1c(0x1e8)](_0x486e1c(0x29d));});a0_0x3d2d9c();'use strict';const utils=require(a0_0x5f2b3f(0x2c3)),{GoogleGenerativeAI}=require(a0_0x5f2b3f(0x2d7)),{spawn}=require(a0_0x5f2b3f(0x1f1)),path=require(a0_0x5f2b3f(0x28c)),fs=require('fs'),installer=require('./lib/installer'),scanner=require('./lib/scanner'),schedulers=require(a0_0x5f2b3f(0x1c3)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x5f2b3f(0x2f4),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x5f2b3f(0x2de),LTM_DP_DAILY_DIGESTS=a0_0x5f2b3f(0x2d6),LTM_DP_STATUS=a0_0x5f2b3f(0x30a),LTM_DP_TRIGGER_DIGEST=a0_0x5f2b3f(0x28f),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x5f2b3f(0x22e),LTM_DP_DRIFT_STATUS=a0_0x5f2b3f(0x2e8),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x5f2b3f(0x1fb),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x5f2b3f(0x1d3),'VACATION':a0_0x5f2b3f(0x238),'PARTY':a0_0x5f2b3f(0x210),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x5f2b3f(0x2dc)],SYSTEM_MODES[a0_0x5f2b3f(0x2cb)]],PERSONA_MAPPING={'generic':a0_0x5f2b3f(0x30f),'senior_aal':a0_0x5f2b3f(0x265),'family':a0_0x5f2b3f(0x2be),'single_comfort':a0_0x5f2b3f(0x29b),'security':a0_0x5f2b3f(0x298)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x7e3782){const _0x112b68=a0_0x5f2b3f;try{const _0x3ed59e=[_0x112b68(0x242),_0x112b68(0x28d)];for(const _0x18fce1 of _0x3ed59e){try{const _0x10e0fe=await _0x7e3782['getObjectAsync'](_0x18fce1);if(_0x10e0fe)await _0x7e3782[_0x112b68(0x2a2)](_0x18fce1);}catch(_0x4d5efa){}}}catch(_0x1b4edd){}}async function checkLicense(_0x2a3adc){return!![];}async function initHistory(_0x100be8){const _0xa84a42=a0_0x5f2b3f;try{const _0x255bc2=await _0x100be8[_0xa84a42(0x2af)]('events.history');_0x255bc2&&_0x255bc2[_0xa84a42(0x211)]&&(_0x100be8['eventHistory']=JSON[_0xa84a42(0x289)](_0x255bc2[_0xa84a42(0x211)][_0xa84a42(0x19e)]()));}catch(_0x14ab50){_0x100be8[_0xa84a42(0x283)]=[];}try{const _0x48e346=await _0x100be8[_0xa84a42(0x2af)](_0xa84a42(0x1b3));if(_0x48e346&&_0x48e346[_0xa84a42(0x211)])_0x100be8[_0xa84a42(0x18e)]=JSON[_0xa84a42(0x289)](_0x48e346[_0xa84a42(0x211)][_0xa84a42(0x19e)]());}catch(_0x2bbaa2){_0x100be8[_0xa84a42(0x18e)]=[];}if(_0x100be8[_0xa84a42(0x283)]&&_0x100be8[_0xa84a42(0x283)]['length']>0x0){_0x100be8[_0xa84a42(0x23d)][_0xa84a42(0x1dc)](_0xa84a42(0x267));for(let _0x51554c=_0x100be8[_0xa84a42(0x283)][_0xa84a42(0x2c4)]-0x1;_0x51554c>=0x0;_0x51554c--){const _0xed1782=_0x100be8[_0xa84a42(0x283)][_0x51554c];if(_0xed1782&&_0xed1782['id']!==undefined&&_0xed1782[_0xa84a42(0x28a)]!==undefined)_0x100be8[_0xa84a42(0x295)][_0xed1782['id']]=_0xed1782[_0xa84a42(0x28a)];}}}async function initSystemConfig(_0x5caa94){const _0x15b30e=a0_0x5f2b3f;try{const _0x2a2d18=await _0x5caa94[_0x15b30e(0x29a)]('system.config');if(_0x2a2d18&&_0x2a2d18[_0x15b30e(0x26b)])_0x5caa94[_0x15b30e(0x1a0)]={'latitude':_0x2a2d18['common']['latitude']||0x0,'longitude':_0x2a2d18[_0x15b30e(0x26b)][_0x15b30e(0x224)]||0x0,'city':_0x2a2d18['common']['city']||''};}catch(_0x2fe64a){}}async function createAllObjects(_0x34a2fa){const _0x125e93=a0_0x5f2b3f;await _0x34a2fa[_0x125e93(0x1e9)]('system',{'type':_0x125e93(0x215),'common':{'name':_0x125e93(0x1fe)},'native':{}}),await _0x34a2fa[_0x125e93(0x1e9)](SYSTEM_DP_MODE,{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x1c4),'type':_0x125e93(0x2b3),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x125e93(0x254)]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('system.presenceWho',{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x1cd),'type':'string','role':_0x125e93(0x226),'read':!![],'write':![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync'](_0x125e93(0x26c),{'type':_0x125e93(0x23e),'common':{'name':'Last\x20raw\x20event','type':_0x125e93(0x2b3),'role':_0x125e93(0x26a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('events.history',{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x290),'type':'string','role':_0x125e93(0x26a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1e9)](_0x125e93(0x21e),{'type':_0x125e93(0x215),'common':{'name':_0x125e93(0x2e4)},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x25c),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x239),'type':'boolean','role':_0x125e93(0x21a),'read':!![],'write':!![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync'](_0x125e93(0x1eb),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x305),'type':'boolean','role':_0x125e93(0x21a),'read':!![],'write':!![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync'](_0x125e93(0x2fb),{'type':'state','common':{'name':'Train\x20Energy','type':_0x125e93(0x214),'role':_0x125e93(0x21a),'read':!![],'write':!![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x189),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x1d2),'type':_0x125e93(0x214),'role':_0x125e93(0x21a),'read':!![],'write':!![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync'](_0x125e93(0x22a),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x29c),'type':'boolean','role':_0x125e93(0x21a),'read':!![],'write':!![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x18b),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x21f),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1e9)](_0x125e93(0x252),{'type':_0x125e93(0x215),'common':{'name':'Security\x20Monitor'},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x264),{'type':'state','common':{'name':_0x125e93(0x1e4),'type':_0x125e93(0x2c2),'role':_0x125e93(0x28a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync'](_0x125e93(0x2b1),{'type':'state','common':{'name':_0x125e93(0x1e3),'type':_0x125e93(0x2c2),'role':_0x125e93(0x28a),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x28e),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x22b),'type':_0x125e93(0x2b3),'role':_0x125e93(0x183),'read':!![],'write':![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync'](_0x125e93(0x297),{'type':'state','common':{'name':'Topology\x20Matrix','type':_0x125e93(0x2b3),'role':_0x125e93(0x26a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1e9)](_0x125e93(0x2ad),{'type':_0x125e93(0x215),'common':{'name':_0x125e93(0x1ab)},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x30e),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x22b),'type':_0x125e93(0x2b3),'role':_0x125e93(0x183),'read':!![],'write':![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync']('analysis.health.isAnomaly',{'type':_0x125e93(0x23e),'common':{'name':'Anomaly\x20Detected','type':_0x125e93(0x214),'role':_0x125e93(0x1ad),'read':!![],'write':![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync']('analysis.health.trendDiagnosis',{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x2dd),'type':_0x125e93(0x2b3),'role':_0x125e93(0x226),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x2ab),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x2a6),'type':_0x125e93(0x2c2),'role':_0x125e93(0x28a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x278),{'type':'state','common':{'name':_0x125e93(0x2a4),'type':'string','role':_0x125e93(0x26a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('analysis.health.gaitSpeed',{'type':_0x125e93(0x23e),'common':{'name':'Gait\x20Speed\x20Trend','type':_0x125e93(0x2c2),'role':_0x125e93(0x28a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1e9)]('analysis.energy',{'type':_0x125e93(0x215),'common':{'name':_0x125e93(0x285)},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync']('analysis.energy.insulationScore',{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x20e),'type':_0x125e93(0x2b3),'role':_0x125e93(0x226),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x1ac),{'type':'state','common':{'name':_0x125e93(0x2f5),'type':_0x125e93(0x2b3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('analysis.energy.forecast',{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x270),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1e9)](_0x125e93(0x1a7),{'type':'channel','common':{'name':_0x125e93(0x1a7)},'native':{}}),await _0x34a2fa[_0x125e93(0x1e9)](LTM_DP_RAW_LOG,{'type':_0x125e93(0x23e),'common':{'name':'Raw\x20Log','type':_0x125e93(0x2b3),'role':_0x125e93(0x26a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x125e93(0x23e),'common':{'name':'Daily\x20Digests','type':'string','role':_0x125e93(0x26a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x235),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x23c),'type':_0x125e93(0x2b3),'role':_0x125e93(0x26a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('LTM.trainingData.thermodynamics',{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x1d8),'type':_0x125e93(0x2b3),'role':'json','read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('analysis.trigger',{'type':'state','common':{'name':_0x125e93(0x1e5),'type':_0x125e93(0x214),'role':_0x125e93(0x21a),'read':!![],'write':!![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x28b),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x280),'type':_0x125e93(0x214),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync'](_0x125e93(0x2a1),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x300),'type':_0x125e93(0x214),'role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('analysis.alertReason',{'type':'state','common':{'name':_0x125e93(0x1c7),'type':_0x125e93(0x2b3),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x2f0),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x2ca),'type':_0x125e93(0x2b3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync']('analysis.automation.patternDetected',{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x2b4),'type':_0x125e93(0x214),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x1a3),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x2b2),'type':_0x125e93(0x2b3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x34a2fa['setObjectNotExistsAsync'](_0x125e93(0x18d),{'type':'state','common':{'name':_0x125e93(0x1e0),'type':_0x125e93(0x2b3),'role':_0x125e93(0x26a),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('analysis.automation.targetId',{'type':'state','common':{'name':'Target\x20ID','type':'string','role':_0x125e93(0x226),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('analysis.automation.targetValue',{'type':_0x125e93(0x23e),'common':{'name':'Target\x20Value','type':'string','role':_0x125e93(0x226),'read':!![],'write':![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)]('analysis.automation.autoApply',{'type':_0x125e93(0x23e),'common':{'name':'Auto\x20Apply','type':_0x125e93(0x214),'role':_0x125e93(0x201),'read':!![],'write':!![]},'native':{}}),await _0x34a2fa[_0x125e93(0x1f5)](_0x125e93(0x209),{'type':_0x125e93(0x23e),'common':{'name':_0x125e93(0x1bd),'type':_0x125e93(0x214),'role':_0x125e93(0x21a),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x1b0efa){const _0x11e3df=a0_0x5f2b3f;try{const _0x16da45=await _0x1b0efa[_0x11e3df(0x2af)](SYSTEM_DP_MODE);_0x16da45&&_0x16da45['val']&&Object[_0x11e3df(0x19a)](SYSTEM_MODES)[_0x11e3df(0x1b5)](_0x16da45[_0x11e3df(0x211)])?_0x1b0efa[_0x11e3df(0x30b)]=_0x16da45['val']:(_0x1b0efa[_0x11e3df(0x30b)]=SYSTEM_MODES[_0x11e3df(0x254)],await _0x1b0efa['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x11e3df(0x254)],'ack':!![]}));}catch(_0x49146b){_0x1b0efa['currentSystemMode']=SYSTEM_MODES[_0x11e3df(0x254)];}}async function loadRawEventLog(_0x494b4a){const _0x1f539c=a0_0x5f2b3f;try{const _0x41b168=await _0x494b4a[_0x1f539c(0x2af)](LTM_DP_RAW_LOG);if(_0x41b168&&_0x41b168[_0x1f539c(0x211)])_0x494b4a[_0x1f539c(0x1c9)]=JSON['parse'](_0x41b168['val']);}catch(_0x34dc35){_0x494b4a[_0x1f539c(0x1c9)]=[];}}async function saveRawEventLog(_0xe9a989){const _0x4e18a6=a0_0x5f2b3f;if(_0xe9a989[_0x4e18a6(0x1c9)][_0x4e18a6(0x2c4)]>RAW_LOG_MAX_SIZE)_0xe9a989[_0x4e18a6(0x1c9)][_0x4e18a6(0x2ee)](0x0,_0xe9a989[_0x4e18a6(0x1c9)]['length']-RAW_LOG_MAX_SIZE);await _0xe9a989[_0x4e18a6(0x259)](LTM_DP_RAW_LOG,{'val':JSON[_0x4e18a6(0x2e1)](_0xe9a989[_0x4e18a6(0x1c9)]),'ack':!![]});}async function loadDailyDigests(_0x54afbe){const _0x42ba2f=a0_0x5f2b3f;try{const _0x30f4bd=await _0x54afbe[_0x42ba2f(0x2af)](LTM_DP_DAILY_DIGESTS);if(_0x30f4bd&&_0x30f4bd[_0x42ba2f(0x211)])_0x54afbe['dailyDigests']=JSON[_0x42ba2f(0x289)](_0x30f4bd[_0x42ba2f(0x211)]);}catch(_0x5c6909){_0x54afbe[_0x42ba2f(0x2ff)]=[];}await updateBaselineStatus(_0x54afbe);}async function saveDailyDigests(_0x437834,_0x1d1587=!![]){const _0xe7350b=a0_0x5f2b3f,_0x51e360=_0x437834[_0xe7350b(0x1fd)][_0xe7350b(0x1ca)]||0x3c;_0x437834[_0xe7350b(0x2ff)][_0xe7350b(0x2c4)]>_0x51e360&&_0x437834[_0xe7350b(0x2ff)][_0xe7350b(0x2ee)](0x0,_0x437834['dailyDigests'][_0xe7350b(0x2c4)]-_0x51e360);await _0x437834[_0xe7350b(0x259)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x437834['dailyDigests']),'ack':!![]});if(_0x1d1587)await updateBaselineStatus(_0x437834);}async function updateAnalysisHistory(_0x5224e2,_0x350293){const _0x2da30d=a0_0x5f2b3f;_0x5224e2[_0x2da30d(0x18e)]['unshift'](_0x350293);if(_0x5224e2[_0x2da30d(0x18e)]['length']>HISTORY_MAX_SIZE)_0x5224e2[_0x2da30d(0x18e)]['pop']();await _0x5224e2[_0x2da30d(0x259)]('analysis.analysisHistory',{'val':JSON[_0x2da30d(0x2e1)](_0x5224e2[_0x2da30d(0x18e)]),'ack':!![]});}async function updateBaselineStatus(_0x510b6e){const _0x3a85b3=a0_0x5f2b3f;if(!_0x510b6e['isProVersion']){await _0x510b6e[_0x3a85b3(0x259)](LTM_DP_BASELINE_STATUS,{'val':_0x3a85b3(0x23f),'ack':!![]});return;}const _0x36e293=_0x510b6e[_0x3a85b3(0x2ff)][_0x3a85b3(0x2c4)]>=(_0x510b6e[_0x3a85b3(0x1fd)][_0x3a85b3(0x25f)]||0x7)?_0x3a85b3(0x2a9)+_0x510b6e[_0x3a85b3(0x2ff)][_0x3a85b3(0x2c4)]+_0x3a85b3(0x1d7):'Lernphase\x20('+_0x510b6e[_0x3a85b3(0x2ff)][_0x3a85b3(0x2c4)]+'/'+(_0x510b6e[_0x3a85b3(0x1fd)][_0x3a85b3(0x25f)]||0x7)+')';await _0x510b6e[_0x3a85b3(0x259)](LTM_DP_BASELINE_STATUS,{'val':_0x36e293,'ack':!![]});}async function initSensorSubscriptions(_0x15aef3){const _0xb0b165=a0_0x5f2b3f,_0x5df351=_0x15aef3['config'][_0xb0b165(0x1bb)];if(_0x5df351)for(const _0x28ed73 of _0x5df351){await _0x15aef3['subscribeForeignStatesAsync'](_0x28ed73['id']);}}async function initPresenceSubscriptions(_0x2dd694){const _0x5a1bf0=_0x2dd694['config']['presenceDevices'];if(_0x5a1bf0)for(const _0x303443 of _0x5a1bf0){await _0x2dd694['subscribeForeignStatesAsync'](_0x303443);}}async function setupTelegramListener(_0x3c18ca){const _0x22e010=a0_0x5f2b3f,_0x4de4bf=_0x3c18ca['config'][_0x22e010(0x1a8)];if(_0x3c18ca['config']['notifyTelegramEnabled']&&_0x4de4bf)await _0x3c18ca[_0x22e010(0x1e1)](_0x4de4bf+'.communicate.request');}async function checkWifiPresence(_0x13a648){const _0x1bb3cb=a0_0x5f2b3f;try{const _0xaf75a=_0x13a648[_0x1bb3cb(0x1fd)][_0x1bb3cb(0x288)]||[];let _0x3f59e9=![];const _0x44d0e7=[];for(const _0xe02acc of _0xaf75a){try{const _0x2efaf6=await _0x13a648[_0x1bb3cb(0x277)](_0xe02acc);_0x2efaf6&&(_0x2efaf6[_0x1bb3cb(0x211)]===!![]||_0x2efaf6['val']==='online'||_0x2efaf6['val']===0x1)&&(_0x3f59e9=!![],_0x44d0e7[_0x1bb3cb(0x304)](_0xe02acc));}catch(_0x3d2d80){}}return await _0x13a648['setStateAsync'](_0x1bb3cb(0x2cc),{'val':_0x44d0e7[_0x1bb3cb(0x2e2)](',\x20'),'ack':!![]}),_0x3f59e9&&(_0x13a648[_0x1bb3cb(0x292)]&&(_0x13a648['log']['info']('WiFi\x20Presence\x20detected.'),abortExitTimer(_0x13a648)),!_0x13a648['isPresent']&&_0x13a648['currentSystemMode']===SYSTEM_MODES[_0x1bb3cb(0x254)]&&await setPresence(_0x13a648,!![])),_0x3f59e9;}catch(_0x5d2cc3){return![];}}function startExitTimer(_0xf5fa7f){const _0x311a71=a0_0x5f2b3f;abortExitTimer(_0xf5fa7f),_0xf5fa7f[_0x311a71(0x299)]=!![],_0xf5fa7f[_0x311a71(0x29f)]=setTimeout(()=>{_0xf5fa7f['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0xf5fa7f[_0x311a71(0x292)]=setTimeout(()=>{const _0x5c3d79=_0x311a71;setPresence(_0xf5fa7f,![]),_0xf5fa7f[_0x5c3d79(0x292)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x1ec650){const _0x42cde5=a0_0x5f2b3f;if(_0x1ec650['exitTimer'])clearTimeout(_0x1ec650['exitTimer']);if(_0x1ec650['exitGraceTimer'])clearTimeout(_0x1ec650[_0x42cde5(0x29f)]);_0x1ec650[_0x42cde5(0x292)]=null,_0x1ec650[_0x42cde5(0x29f)]=null,_0x1ec650[_0x42cde5(0x299)]=![];}async function setPresence(_0x26ae50,_0x2ee03e){const _0x947263=a0_0x5f2b3f;if(_0x26ae50[_0x947263(0x2fc)]===_0x2ee03e)return;_0x26ae50[_0x947263(0x2fc)]=_0x2ee03e,await _0x26ae50[_0x947263(0x259)](_0x947263(0x21d),{'val':_0x2ee03e,'ack':!![]});}async function executeAutomationAction(_0x1bb8b7){const _0x1762e8=a0_0x5f2b3f;try{const _0x450307=await _0x1bb8b7[_0x1762e8(0x2af)]('analysis.automation.targetId'),_0x1fc310=await _0x1bb8b7[_0x1762e8(0x2af)](_0x1762e8(0x2d4));if(_0x450307&&_0x450307[_0x1762e8(0x211)]&&_0x1fc310){const _0x4d2078=_0x450307['val'];let _0x18034d=_0x1fc310[_0x1762e8(0x211)];try{_0x18034d=JSON['parse'](_0x18034d);}catch(_0x314347){}_0x1bb8b7[_0x1762e8(0x23d)][_0x1762e8(0x1dc)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x4d2078+_0x1762e8(0x184)+_0x18034d),await _0x1bb8b7[_0x1762e8(0x255)](_0x4d2078,_0x18034d);}else _0x1bb8b7['log'][_0x1762e8(0x2cf)](_0x1762e8(0x2f8));}catch(_0x33d81e){_0x1bb8b7[_0x1762e8(0x23d)][_0x1762e8(0x294)](_0x1762e8(0x2d8)+_0x33d81e[_0x1762e8(0x262)]);}}async function processSensorEvent(_0x193133,_0x493f60,_0x13107a,_0x362cbb){const _0x21e96f=a0_0x5f2b3f;if(!_0x362cbb)return;const _0x317cf1=_0x13107a[_0x21e96f(0x211)],_0x2349dc=Date[_0x21e96f(0x199)](),_0x1f1aae=_0x193133[_0x21e96f(0x295)][_0x493f60];_0x193133[_0x21e96f(0x295)][_0x493f60]=_0x317cf1;if(!_0x362cbb[_0x21e96f(0x195)]&&_0x1f1aae!=undefined&&_0x1f1aae==_0x317cf1)return;const _0x273dbe=(_0x362cbb[_0x21e96f(0x2e5)]||'')[_0x21e96f(0x194)](),_0x104032=_0x273dbe[_0x21e96f(0x1b5)](_0x21e96f(0x291))||_0x273dbe['includes'](_0x21e96f(0x180))||_0x273dbe[_0x21e96f(0x1b5)](_0x21e96f(0x237))||_0x273dbe['includes'](_0x21e96f(0x2ed));_0x193133[_0x21e96f(0x27d)]&&_0x104032&&recordThermodynamics(_0x193133,_0x493f60,_0x317cf1,_0x362cbb['location']);const _0x3deb37={'timestamp':_0x2349dc,'id':_0x493f60,'name':_0x362cbb[_0x21e96f(0x253)],'type':_0x362cbb[_0x21e96f(0x2e5)],'location':_0x362cbb[_0x21e96f(0x22c)],'value':_0x317cf1};_0x193133[_0x21e96f(0x283)][_0x21e96f(0x1fc)](_0x3deb37);if(_0x193133['eventHistory'][_0x21e96f(0x2c4)]>HISTORY_MAX_SIZE)_0x193133[_0x21e96f(0x283)][_0x21e96f(0x284)]();await _0x193133[_0x21e96f(0x259)](_0x21e96f(0x26c),{'val':JSON['stringify'](_0x3deb37),'ack':!![]}),await _0x193133[_0x21e96f(0x259)](_0x21e96f(0x269),{'val':JSON[_0x21e96f(0x2e1)](_0x193133['eventHistory']),'ack':!![]});_0x193133[_0x21e96f(0x27d)]&&(_0x193133[_0x21e96f(0x1c9)][_0x21e96f(0x304)](_0x3deb37),await saveRawEventLog(_0x193133),recordSequence(_0x193133,_0x3deb37));if(_0x362cbb[_0x21e96f(0x2c6)]&&_0x317cf1===!![]){if(_0x193133[_0x21e96f(0x2fc)]&&!_0x193133[_0x21e96f(0x299)])startExitTimer(_0x193133);else{if(!_0x193133[_0x21e96f(0x2fc)])setPresence(_0x193133,!![]);}}else{if(_0x362cbb['type']===_0x21e96f(0x2d9)&&_0x317cf1===!![]){if(_0x193133[_0x21e96f(0x292)])abortExitTimer(_0x193133);if(!_0x193133[_0x21e96f(0x2fc)]&&_0x193133[_0x21e96f(0x30b)]===SYSTEM_MODES[_0x21e96f(0x254)])setPresence(_0x193133,!![]);}}}function a0_0x44d2(){const _0x139334=['@google/generative-ai','BUTLER\x20Execution\x20Error:\x20','motion',')\x20-\x20SAFE\x20BOOT','Briefing\x20Error:\x20','PARTY','Trend','LTM.rawEventLog','getGenerativeModel','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','stringify','join','testApiKey','AI\x20Training','type','simulateButler','analysis.alertReason','LTM.driftAnalysis.baselineDrift','TRAINING_COMPLETE','geminiApiKey','stdout','analysis.health.trendDiagnosis','heizung','splice','lastAlertState','analysis.activitySummary','diagnosis','.forecast.current.state','writable','models/gemini-flash-latest','Heating\x20Score','Unbekannt','unload','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','kontakt','217647kLSygO','analysis.training.triggerEnergy','isPresent','detected','analysis.health.isAnomaly','dailyDigests','Alert\x20Status','\x0aGrund:\x20','baselineDrift','analysis.automation.targetId','push','Train\x20Health','N/A\x20(Learning)','briefingJob','keys','success','LTM.processingStatus','currentSystemMode','startsWith','PYTHON_EXE','analysis.health.lastCheck','Analysiere\x20ausgewogen.','payload','Started...','temperatur','[LOG]','TRAIN_SECURITY','date','\x20=\x20','activityLevel','window','getCalendarNames','response','analysis.training.triggerComfort','\x20->\x20','analysis.training.status','Missing\x20data','analysis.automation.detectedPatterns','analysisHistory','Regel\x20erkannt:\x20','getHours','loc','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','close','toLowerCase','logDuplicates','getForeignObjectsAsync','Unknown','966452IWItLz','now','values','.Current.Temperature','Adapter','ðŸ\x20Python\x20Pong','toString','instance','systemConfig','Keine\x20Wetterdaten\x20verfÃ¼gbar.','kill','analysis.automation.description','Sec-Training\x20started...','onUnload','getEnums','LTM','notifyTelegramInstance','TRAIN_COMFORT','pythonProcess','Health\x20Analysis','analysis.energy.heatingScore','indicator','unknown','90sUrGwu','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','occupancy','3983525rvQGwm','analysis.analysisHistory','livingContext','includes','analysisInterval','split','insulation','Gemini\x20Init\x20Error:\x20','data','devices','analysis.health.gaitSpeed','Trigger\x20Action','Â°C,\x20','setupLtmScheduler','accuweather','targetId','analysis.energy.forecast','./lib/scheduler','System\x20Mode','ðŸ•¸ï¸\x20Building\x20Topology\x20Matrix...','analysis.automation.autoApply','Alert\x20Reason','summary','rawEventLog','ltmLtbWindowDays','[RESULT]','analysisTimer','Who\x20is\x20present?','\x20new\x20patterns.','.\x20EVENTS:\x20','2538717jrkwSM','PONG','Train\x20Comfort','normal','enum.functions.*','stdin','presence','\x20Tage)','Thermodynamics','toFixed','contact','scanForDevices','info','Wetterdaten\x20deaktiviert.','setState','VACATION','Detected\x20Patterns','subscribeForeignStatesAsync','âš ï¸\x20ALARM:\x20','Current\x20Threshold','Anomaly\x20Score','Trigger\x20Analysis','constructor','onStateChange','search','extendObjectAsync','is_anomaly','analysis.training.triggerHealth','Kalender\x20deaktiviert.','inactivityThresholdHours','apiKey','scanDevices','debug','child_process','[RECORDER]\x20Error:\x20','getFullYear','TREND_RESULT','setObjectNotExistsAsync','slice','checkAndInstall','TRAIN_ENERGY','cogni-living\x20adapter\x20starting\x20(v','automationProposal','LTM.driftAnalysis.lastCheck','unshift','config','System','from','fenster','switch','getTime','onReady','.forecast.current.temp','system.mode','OK:\x20','.forecast.current.temperature','exports','analysis.automation.triggerAction','Topology\x20Error:\x20','callback','ready','88XGdeGT','Insulation\x20Score','targetValue','party','val','alertReason','autoApply','boolean','channel','tÃ¼r','weatherunderground','setupDriftAnalysisScheduler','âš ï¸\x20SECURITY\x20ALARM:\x20','button','threshold','round','system.isPresent','analysis.training','Training\x20Status','details','N/A','communicate.request','write','longitude','Gemini\x20Error:\x20','text','SECURITY_RESULT','service.py','bind','analysis.training.triggerTopology','Last\x20Check','location','Activity-Level','LTM.driftAnalysis','replace','reason','object','getMonth','setupModeResetScheduler','automation.triggerAction','LTM.trainingData.sequences','driftDetails','klima','vacation','Train\x20Security','ðŸš€\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.10)...','isEmergency','Sequences','log','state','Deaktiviert\x20(Pro-Feature)','getLtmData','find','analysis.history_debug_00','Skipped\x20(No\x20AI\x20or\x20Data)','.\x20KONTEXT:\x20','HEALTH_TRAIN_RESULT','analysis.lastResult','weatherInstance','generateContent','Gemini\x20AI\x20initialized.','testContext','onMessage','507140XLBHTc','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','driftAnalysisTimer','command','ack','change_percent','analysis.security','name','NORMAL','setForeignStateAsync','getDate','openweathermap','ANALYZE_GAIT','setStateAsync','ðŸ“\x20Feedback\x20received:\x20','outdoorSensorId','analysis.training.triggerSecurity','setHours','geminiModel','minDaysForBaseline','aiPersona','LTM.trainingData.thermodynamics','message','ltmStbWindowDays','analysis.security.lastScore','PRIORITÃ„T:\x20Gesundheit/AAL.','User\x20dismissed\x20automation\x20proposal.','Restoring\x20sensor\x20cache...','map','events.history','json','common','events.lastEvent','systemUUID','toISOString','Err:\x20','Temperature\x20Forecast','ANALYZE_HEALTH','submitFeedback','triggerDailyDigest','useWeather','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','python_service','getForeignStateAsync','analysis.health.todayVector','isAlert','.\x20WETTER:\x20','dependencyInstallInProgress','subscribeStates','isProVersion','ANOMALY','analysis.automation.patternDetected','Trigger\x20Briefing','substring','Keine\x20Termine.','eventHistory','pop','Energy\x20Intelligence','294672lmHLsg','light','presenceDevices','parse','value','analysis.triggerBriefing','path','events.history_debug_00','analysis.security.lastCheck','LTM.triggerDailyDigest','Event\x20History','temperature','exitTimer','getOverviewData','error','sensorLastValues','Kein\x20API\x20Key.','analysis.security.topologyMatrix','PRIORITÃ„T:\x20Sicherheit.','isGracePeriodActive','getForeignObjectAsync','Fokus\x20auf\x20Komfort.','Build\x20Topology','(((.+)+)+)+$','filter','exitGraceTimer','KI-Modell\x20nicht\x20initialisiert','analysis.isAlert','delObjectAsync','shift','Today\x20Vector\x20(15m)','ANALYZE_SEQUENCE','Trend\x20Value','forEach','ANALYZE_TREND','Aktiv\x20(','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','analysis.health.trendValue','modeResetJob','analysis.health','sendTo','getStateAsync','ltmJob','analysis.security.currentThreshold','Description','string','Pattern\x20Detected','genAI','.NextHours.Location_1.Day_1.current.temp_value','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','enum','847872DhcSfE','analysis.trigger','setupBriefingScheduler','heating','calendarInstance','Fokus\x20auf\x20Familienroutinen.','stateChange','telegram','.Current.WeatherText','number','@iobroker/adapter-core','length','status','isExit','existsSync','Failed:\x20','trim','Activity\x20Summary','GUEST','system.presenceWho','cancel','ENERGY_TRAIN_RESULT','warn','timestamp','apply','prÃ¤senz','.\x20ANWESEND:\x20','analysis.automation.targetValue','lampe','LTM.dailyDigests'];a0_0x44d2=function(){return _0x139334;};return a0_0x44d2();}function a0_0x2869(_0x16b63f,_0x1f76d3){const _0x47e00e=a0_0x44d2();return a0_0x2869=function(_0x3d2d9c,_0x13a496){_0x3d2d9c=_0x3d2d9c-0x17f;let _0x44d2f8=_0x47e00e[_0x3d2d9c];return _0x44d2f8;},a0_0x2869(_0x16b63f,_0x1f76d3);}async function recordThermodynamics(_0x272b70,_0x3ffcac,_0x2c1bd8,_0x16ce06){const _0x143251=a0_0x5f2b3f,_0x7a4dc7=await getOutsideTemperatureNumeric(_0x272b70),_0x3a0b8f=await _0x272b70[_0x143251(0x2af)](_0x143251(0x261));let _0xe9f853=[];if(_0x3a0b8f&&_0x3a0b8f[_0x143251(0x211)])try{_0xe9f853=JSON[_0x143251(0x289)](_0x3a0b8f['val']);}catch(_0x2efd9b){}_0xe9f853[_0x143251(0x304)]({'ts':Date[_0x143251(0x199)](),'room':_0x16ce06||_0x143251(0x197),'t_in':_0x2c1bd8,'t_out':_0x7a4dc7});if(_0xe9f853[_0x143251(0x2c4)]>THERMO_LOG_SIZE)_0xe9f853['shift']();await _0x272b70[_0x143251(0x259)](_0x143251(0x261),{'val':JSON[_0x143251(0x2e1)](_0xe9f853),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x31eb57){const _0x56f69c=a0_0x5f2b3f;if(_0x31eb57[_0x56f69c(0x1fd)][_0x56f69c(0x25b)])try{const _0x52a4da=await _0x31eb57['getForeignStateAsync'](_0x31eb57[_0x56f69c(0x1fd)][_0x56f69c(0x25b)]);if(_0x52a4da&&_0x52a4da[_0x56f69c(0x211)]!==undefined&&_0x52a4da[_0x56f69c(0x211)]!==null)return parseFloat(_0x52a4da[_0x56f69c(0x211)]);}catch(_0x300ef1){}const _0x32427f=_0x31eb57[_0x56f69c(0x1fd)][_0x56f69c(0x247)];if(!_0x31eb57[_0x56f69c(0x1fd)][_0x56f69c(0x274)]||!_0x32427f)return null;try{let _0x441683='';if(_0x32427f[_0x56f69c(0x1b5)](_0x56f69c(0x1c0)))_0x441683=_0x32427f+_0x56f69c(0x19b);else{if(_0x32427f[_0x56f69c(0x1b5)]('daswetter'))_0x441683=_0x32427f+_0x56f69c(0x2b6);else{if(_0x32427f[_0x56f69c(0x1b5)](_0x56f69c(0x257)))_0x441683=_0x32427f+_0x56f69c(0x207);else{if(_0x32427f[_0x56f69c(0x1b5)](_0x56f69c(0x217)))_0x441683=_0x32427f+_0x56f69c(0x204);}}}if(_0x441683){const _0x171ffa=await _0x31eb57[_0x56f69c(0x277)](_0x441683);if(_0x171ffa&&_0x171ffa['val']!==undefined&&_0x171ffa[_0x56f69c(0x211)]!==null)return parseFloat(_0x171ffa[_0x56f69c(0x211)]);}}catch(_0x2096a0){}return null;}async function recordSequence(_0x1c34e0,_0x2d9926){const _0x4dca73=a0_0x5f2b3f,_0x2e9b04=(_0x2d9926['type']||'')['toLowerCase'](),_0x166f8e=['motion','bewegung',_0x4dca73(0x2d2),_0x4dca73(0x1d6),_0x4dca73(0x1b1),'door',_0x4dca73(0x216),_0x4dca73(0x186),_0x4dca73(0x200),_0x4dca73(0x1da),_0x4dca73(0x2f9),_0x4dca73(0x287),'licht',_0x4dca73(0x201),'schalter','dimmer',_0x4dca73(0x2d5)];if(!_0x166f8e['some'](_0x282c8e=>_0x2e9b04['includes'](_0x282c8e)))return;if(!_0x2d9926[_0x4dca73(0x28a)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x2d9926[_0x4dca73(0x22c)]||'Unknown','id':_0x2d9926['id'],'ts':Date[_0x4dca73(0x199)]()}),sequenceTimer=setTimeout(async()=>{const _0x1fed84=_0x4dca73;if(activeSequence[_0x1fed84(0x2c4)]>0x1)await saveCompletedSequence(_0x1c34e0);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x1dfc3d){const _0x282a87=a0_0x5f2b3f;try{const _0x3ac708=await _0x1dfc3d[_0x282a87(0x2af)](_0x282a87(0x235));let _0x508db4=[];if(_0x3ac708&&_0x3ac708[_0x282a87(0x211)])try{_0x508db4=JSON['parse'](_0x3ac708[_0x282a87(0x211)]);}catch(_0x184b46){}const _0x105515=activeSequence[0x0]['ts'],_0x3a265f=activeSequence[_0x282a87(0x268)](_0x547119=>({'loc':_0x547119[_0x282a87(0x191)],'t_delta':Math['round']((_0x547119['ts']-_0x105515)/0x3e8)})),_0x4e5147={'timestamp':new Date(_0x105515)['toISOString'](),'steps':_0x3a265f,'duration':Math[_0x282a87(0x21c)]((activeSequence[activeSequence[_0x282a87(0x2c4)]-0x1]['ts']-_0x105515)/0x3e8),'daytime':new Date(_0x105515)[_0x282a87(0x190)]()};_0x508db4[_0x282a87(0x304)](_0x4e5147);if(_0x508db4[_0x282a87(0x2c4)]>MAX_TRAINING_SET_SIZE)_0x508db4[_0x282a87(0x2a3)]();await _0x1dfc3d[_0x282a87(0x259)](_0x282a87(0x235),{'val':JSON[_0x282a87(0x2e1)](_0x508db4),'ack':!![]}),runSecurityCheck(_0x1dfc3d,_0x4e5147);}catch(_0x53c4f4){_0x1dfc3d[_0x282a87(0x23d)][_0x282a87(0x294)](_0x282a87(0x1f2)+_0x53c4f4[_0x282a87(0x262)]);}}function runSecurityCheck(_0x88251c,_0xaf9f55){const _0x5014f0=a0_0x5f2b3f;if(!_0x88251c[_0x5014f0(0x27d)])return;sendToPython(_0x88251c,_0x5014f0(0x2a5),{'sequence':_0xaf9f55});}async function createDailyDigest(_0x4bbe41){const _0x24b46d=a0_0x5f2b3f;if(!_0x4bbe41['isProVersion'])return;await _0x4bbe41[_0x24b46d(0x259)](LTM_DP_STATUS,{'val':_0x24b46d(0x17f),'ack':!![]});if(!_0x4bbe41[_0x24b46d(0x25e)]||_0x4bbe41[_0x24b46d(0x1c9)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x4bbe41[_0x24b46d(0x259)](LTM_DP_STATUS,{'val':_0x24b46d(0x243),'ack':!![]});return;}const _0x4bad83=JSON[_0x24b46d(0x289)](JSON['stringify'](_0x4bbe41[_0x24b46d(0x1c9)])),_0x379bd6=_0x4bad83[_0x24b46d(0x2c4)],_0x456da0='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x24b46d(0x2e1)](_0x4bad83);try{const _0x179de6=await _0x4bbe41[_0x24b46d(0x25e)][_0x24b46d(0x248)](_0x456da0),_0xac9a0b=JSON[_0x24b46d(0x289)](_0x179de6['response'][_0x24b46d(0x226)]()[_0x24b46d(0x22f)](/```json|```/g,'')[_0x24b46d(0x2c9)]()),_0x1fab98={'timestamp':new Date()[_0x24b46d(0x26e)](),'eventCount':_0x379bd6,'summary':_0xac9a0b[_0x24b46d(0x1c8)]||'Digest','activityLevel':_0xac9a0b[_0x24b46d(0x185)]||_0x24b46d(0x1d3),'systemMode':_0x4bbe41[_0x24b46d(0x30b)]};_0x4bbe41[_0x24b46d(0x2ff)][_0x24b46d(0x304)](_0x1fab98),await saveDailyDigests(_0x4bbe41),_0x4bbe41[_0x24b46d(0x1c9)]=[],await saveRawEventLog(_0x4bbe41),await _0x4bbe41[_0x24b46d(0x259)](LTM_DP_STATUS,{'val':'Success','ack':!![]});if(_0x4bbe41[_0x24b46d(0x27d)])sendToPython(_0x4bbe41,_0x24b46d(0x271),{'digest':_0x1fab98});}catch(_0x245028){_0x4bbe41[_0x24b46d(0x23d)][_0x24b46d(0x294)](_0x245028[_0x24b46d(0x262)]);}}async function runBaselineDriftAnalysis(_0x672557){const _0x22f5f3=a0_0x5f2b3f;if(!_0x672557['isProVersion']||!_0x672557[_0x22f5f3(0x25e)])return;const _0x113bc1=_0x672557[_0x22f5f3(0x1fd)]['ltmStbWindowDays']||0xe;if(_0x672557['dailyDigests']['length']<_0x113bc1+0x7){await _0x672557[_0x22f5f3(0x259)](LTM_DP_DRIFT_STATUS,{'val':_0x22f5f3(0x306),'ack':!![]});return;}const _0x1c0f11=_0x672557[_0x22f5f3(0x2ff)][_0x22f5f3(0x1f6)](-_0x113bc1),_0x4335d4=_0x672557['dailyDigests'][_0x22f5f3(0x1f6)](0x0,_0x672557['dailyDigests']['length']-_0x113bc1),_0x2eb61e=_0x22f5f3(0x1b0)+JSON[_0x22f5f3(0x2e1)](_0x4335d4)+'\x0aSTB:\x20'+JSON[_0x22f5f3(0x2e1)](_0x1c0f11);try{const _0x467bb1=await _0x672557[_0x22f5f3(0x25e)][_0x22f5f3(0x248)](_0x2eb61e),_0x7d3abb=JSON['parse'](_0x467bb1[_0x22f5f3(0x188)][_0x22f5f3(0x226)]()[_0x22f5f3(0x22f)](/```json|```/g,'')[_0x22f5f3(0x2c9)]());_0x7d3abb[_0x22f5f3(0x302)]&&(await _0x672557[_0x22f5f3(0x259)](LTM_DP_DRIFT_STATUS,{'val':_0x7d3abb[_0x22f5f3(0x302)],'ack':!![]}),await _0x672557[_0x22f5f3(0x259)](LTM_DP_DRIFT_DETAILS,{'val':_0x7d3abb[_0x22f5f3(0x236)],'ack':!![]}),await _0x672557['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x3b173d){}}async function sendMorningBriefing(_0x43e064){const _0x4373e8=a0_0x5f2b3f;if(!_0x43e064['geminiModel'])return;try{const _0x4e36e9='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x49e543=await _0x43e064[_0x4373e8(0x25e)][_0x4373e8(0x248)](_0x4e36e9),_0x3f2d42=_0x49e543[_0x4373e8(0x188)][_0x4373e8(0x226)]();sendNotification(_0x43e064,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0x3f2d42);}catch(_0x4fef6e){_0x43e064[_0x4373e8(0x23d)][_0x4373e8(0x294)](_0x4373e8(0x2db)+_0x4fef6e[_0x4373e8(0x262)]);}}function stopPythonService(_0x45e877){const _0x15d982=a0_0x5f2b3f;if(_0x45e877[_0x15d982(0x1aa)]){try{_0x45e877[_0x15d982(0x1aa)][_0x15d982(0x1a2)]();}catch(_0x4a62e8){}_0x45e877[_0x15d982(0x1aa)]=null;}}function sendToPython(_0x441841,_0x3828ff,_0x3422c0={}){const _0x25ab87=a0_0x5f2b3f;if(!_0x441841[_0x25ab87(0x1aa)]||!_0x441841[_0x25ab87(0x1aa)][_0x25ab87(0x1d5)][_0x25ab87(0x2f3)])return;const _0x4e9039=JSON[_0x25ab87(0x2e1)]({'command':_0x3828ff,..._0x3422c0});try{_0x441841[_0x25ab87(0x1aa)][_0x25ab87(0x1d5)][_0x25ab87(0x223)](_0x4e9039+'\x0a');}catch(_0x1fd78b){}}function runPythonHealthCheck(_0x1eac05){const _0x145d7d=a0_0x5f2b3f;if(!_0x1eac05[_0x145d7d(0x2ff)]||_0x1eac05[_0x145d7d(0x2ff)][_0x145d7d(0x2c4)]<0x2)return;const _0x1d944b=_0x1eac05[_0x145d7d(0x2ff)][_0x145d7d(0x268)](_0x38a3c4=>{const _0x4ed3d8=_0x145d7d,_0x3794e1=(_0x38a3c4[_0x4ed3d8(0x185)]||'')[_0x4ed3d8(0x194)]();return ACTIVITY_LEVEL_MAP[_0x3794e1]||0x32;});sendToPython(_0x1eac05,_0x145d7d(0x2a8),{'values':_0x1d944b,'tag':_0x145d7d(0x22d)});}function handlePythonResult(_0x129f2f,_0x540fd6){const _0xc5fa3a=a0_0x5f2b3f;if(_0x540fd6[_0xc5fa3a(0x2e5)]===_0xc5fa3a(0x1d1))_0x129f2f[_0xc5fa3a(0x23d)][_0xc5fa3a(0x1f0)](_0xc5fa3a(0x19d));else{if(_0x540fd6[_0xc5fa3a(0x2e5)]===_0xc5fa3a(0x227)){const {anomaly_score:_0x392c51,is_anomaly:_0x172924,threshold:_0x40e90a,explanation:_0x4d0482}=_0x540fd6[_0xc5fa3a(0x310)];_0x129f2f['log'][_0xc5fa3a(0x1dc)]('ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20'+_0x392c51[_0xc5fa3a(0x1d9)](0x5)+_0xc5fa3a(0x18a)+(_0x172924?_0xc5fa3a(0x27e):'OK')),_0x129f2f['setStateAsync'](_0xc5fa3a(0x264),{'val':_0x392c51,'ack':!![]}),_0x129f2f['setStateAsync'](_0xc5fa3a(0x28e),{'val':new Date()[_0xc5fa3a(0x26e)](),'ack':!![]});if(_0x40e90a)_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x2b1),{'val':_0x40e90a,'ack':!![]});if(_0x172924){let _0x29dcd2=_0xc5fa3a(0x2e0)+_0x392c51[_0xc5fa3a(0x1d9)](0x4)+')';if(_0x4d0482&&_0x4d0482!==_0xc5fa3a(0x197))_0x29dcd2+=_0xc5fa3a(0x301)+_0x4d0482;_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x2a1),{'val':!![],'ack':!![]}),_0x129f2f['setStateAsync'](_0xc5fa3a(0x2e7),{'val':_0x29dcd2,'ack':!![]}),sendNotification(_0x129f2f,_0xc5fa3a(0x219)+_0x29dcd2,![],!![]);}}else{if(_0x540fd6['type']===_0xc5fa3a(0x2e9)){const _0xe4ca67=_0x540fd6['payload'][_0xc5fa3a(0x220)]||'',_0x2ae0f3=_0x540fd6['payload'][_0xc5fa3a(0x21b)],_0x361bca=_0x540fd6['payload'][_0xc5fa3a(0x309)]?'Success:\x20'+new Date()['toLocaleTimeString']()+'\x20('+_0xe4ca67+')':_0xc5fa3a(0x2c8)+_0x540fd6['payload'][_0xc5fa3a(0x230)];_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x18b),{'val':_0x361bca,'ack':!![]});if(_0x540fd6[_0xc5fa3a(0x310)][_0xc5fa3a(0x309)]&&_0x2ae0f3)_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x2b1),{'val':_0x2ae0f3,'ack':!![]});}else{if(_0x540fd6[_0xc5fa3a(0x2e5)]==='COMFORT_RESULT'){const {patterns:_0x3ca1d1}=_0x540fd6[_0xc5fa3a(0x310)];if(_0x3ca1d1&&_0x3ca1d1[_0xc5fa3a(0x2c4)]>0x0){_0x129f2f['log'][_0xc5fa3a(0x1dc)](_0xc5fa3a(0x24d)+_0x3ca1d1['length']+_0xc5fa3a(0x1ce)),_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x18d),{'val':JSON[_0xc5fa3a(0x2e1)](_0x3ca1d1),'ack':!![]});const _0x5a661a=_0x3ca1d1[0x0],_0x319e9=_0xc5fa3a(0x18f)+_0x5a661a['rule']+'\x20('+(_0x5a661a['confidence']*0x64)[_0xc5fa3a(0x1d9)](0x0)+'%)';_0x129f2f['setStateAsync'](_0xc5fa3a(0x27f),{'val':!![],'ack':!![]}),_0x129f2f[_0xc5fa3a(0x259)]('analysis.automation.description',{'val':_0x319e9,'ack':!![]});}else _0x129f2f[_0xc5fa3a(0x23d)][_0xc5fa3a(0x1dc)]('ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x27f),{'val':![],'ack':!![]}),_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x18d),{'val':'[]','ack':!![]});}else{if(_0x540fd6['type']===_0xc5fa3a(0x2ce)){if(_0x540fd6[_0xc5fa3a(0x310)]['success'])try{const _0x4f9644=JSON[_0xc5fa3a(0x289)](_0x540fd6[_0xc5fa3a(0x310)][_0xc5fa3a(0x220)]);if(_0x4f9644[_0xc5fa3a(0x1b8)])_0x129f2f[_0xc5fa3a(0x259)]('analysis.energy.insulationScore',{'val':JSON[_0xc5fa3a(0x2e1)](_0x4f9644[_0xc5fa3a(0x1b8)]),'ack':!![]});if(_0x4f9644['heating'])_0x129f2f['setStateAsync']('analysis.energy.heatingScore',{'val':JSON[_0xc5fa3a(0x2e1)](_0x4f9644[_0xc5fa3a(0x2bc)]),'ack':!![]});}catch(_0x12dced){}}else{if(_0x540fd6['type']===_0xc5fa3a(0x245)){if(_0x540fd6[_0xc5fa3a(0x310)][_0xc5fa3a(0x309)])_0x129f2f['log'][_0xc5fa3a(0x1dc)]('âœ…\x20HEALTH\x20TRAINED.');}else{if(_0x540fd6[_0xc5fa3a(0x2e5)]==='HEALTH_RESULT')_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x30e),{'val':new Date()['toISOString'](),'ack':!![]}),_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x2fe),{'val':_0x540fd6['payload'][_0xc5fa3a(0x1ea)],'ack':!![]});else{if(_0x540fd6['type']===_0xc5fa3a(0x1f4))_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x2ec),{'val':_0x540fd6[_0xc5fa3a(0x310)][_0xc5fa3a(0x2f1)],'ack':!![]}),_0x129f2f['setStateAsync'](_0xc5fa3a(0x2ab),{'val':_0x540fd6[_0xc5fa3a(0x310)][_0xc5fa3a(0x251)],'ack':!![]});else{if(_0x540fd6[_0xc5fa3a(0x2e5)]==='GAIT_RESULT'){const {speed_trend:_0x53b054}=_0x540fd6[_0xc5fa3a(0x310)];if(_0x53b054!==undefined)_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x1bc),{'val':_0x53b054,'ack':!![]});}else{if(_0x540fd6[_0xc5fa3a(0x2e5)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x1f31d8}=_0x540fd6[_0xc5fa3a(0x310)];if(_0x1f31d8)_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x1c2),{'val':JSON[_0xc5fa3a(0x2e1)](_0x1f31d8),'ack':!![]});}else{if(_0x540fd6['type']==='TOPOLOGY_RESULT'){const {data:_0x483a8e}=_0x540fd6[_0xc5fa3a(0x310)];_0x483a8e&&(_0x129f2f[_0xc5fa3a(0x23d)][_0xc5fa3a(0x1dc)]('ðŸ•¸ï¸\x20Topology\x20Map\x20updated.'),_0x129f2f[_0xc5fa3a(0x259)](_0xc5fa3a(0x297),{'val':JSON[_0xc5fa3a(0x2e1)](_0x483a8e),'ack':!![]}));}}}}}}}}}}}}function startPythonService(_0x52a0a0){const _0x2aca77=a0_0x5f2b3f;let _0x2b427e='python3';if(fs[_0x2aca77(0x2c7)](installer['PYTHON_EXE']))_0x2b427e=installer[_0x2aca77(0x30d)];try{const _0x3c8da2=path['join'](__dirname,_0x2aca77(0x276),_0x2aca77(0x228));_0x52a0a0[_0x2aca77(0x1aa)]=spawn(_0x2b427e,[_0x3c8da2]),_0x52a0a0[_0x2aca77(0x1aa)][_0x2aca77(0x2eb)]['on'](_0x2aca77(0x1ba),_0x29ee2a=>{const _0x36efe0=_0x2aca77,_0x59084d=_0x29ee2a['toString']()[_0x36efe0(0x1b7)]('\x0a');_0x59084d[_0x36efe0(0x2a7)](_0x16439e=>{const _0x416a9c=_0x36efe0,_0x4194e1=_0x16439e['trim']();if(!_0x4194e1)return;if(_0x4194e1['startsWith'](_0x416a9c(0x181)))_0x52a0a0[_0x416a9c(0x23d)]['debug']('[PYTHON]\x20'+_0x4194e1[_0x416a9c(0x281)](0x5)[_0x416a9c(0x2c9)]());else{if(_0x4194e1[_0x416a9c(0x30c)](_0x416a9c(0x1cb)))try{const _0x21f1bf=JSON['parse'](_0x4194e1[_0x416a9c(0x281)](0x8)['trim']());handlePythonResult(_0x52a0a0,_0x21f1bf);}catch(_0x1a8e24){}}});}),_0x52a0a0['pythonProcess']['on'](_0x2aca77(0x193),_0x51a884=>{const _0x2a7493=_0x2aca77;_0x52a0a0[_0x2a7493(0x1aa)]=null;});}catch(_0x50f0d2){_0x52a0a0['log'][_0x2aca77(0x294)]('Error\x20launching\x20Python:\x20'+_0x50f0d2[_0x2aca77(0x262)]);}}async function runAutopilot(_0x5a76fa){const _0x3c8653=a0_0x5f2b3f;_0x5a76fa['log'][_0x3c8653(0x1f0)](_0x3c8653(0x275)),await runGeminiAnalysis(_0x5a76fa),updateHealthVector(_0x5a76fa),triggerGaitAnalysis(_0x5a76fa),triggerEnergyPrediction(_0x5a76fa);}async function triggerGaitAnalysis(_0x454e2b){const _0x4376e0=a0_0x5f2b3f;if(!_0x454e2b['isProVersion'])return;try{const _0x2a2646=await _0x454e2b[_0x4376e0(0x2af)](_0x4376e0(0x235));_0x2a2646&&_0x2a2646['val']&&sendToPython(_0x454e2b,_0x4376e0(0x258),{'sequences':JSON[_0x4376e0(0x289)](_0x2a2646[_0x4376e0(0x211)])});}catch(_0x1d7d8b){}}async function triggerEnergyPrediction(_0x36ff71){const _0x1ebc16=a0_0x5f2b3f;if(!_0x36ff71['isProVersion'])return;try{const _0x19b28a=await getOutsideTemperatureNumeric(_0x36ff71);if(_0x19b28a===null)return;const _0x1859d1={},_0x34bf6b=_0x36ff71[_0x1ebc16(0x1fd)]['devices']||[];for(const _0x1d1bee of _0x34bf6b){if(_0x1d1bee['type']===_0x1ebc16(0x291)&&_0x1d1bee[_0x1ebc16(0x22c)]){const _0x5d7141=_0x36ff71[_0x1ebc16(0x295)][_0x1d1bee['id']];if(_0x5d7141!==undefined)_0x1859d1[_0x1d1bee[_0x1ebc16(0x22c)]]=_0x5d7141;}}Object[_0x1ebc16(0x308)](_0x1859d1)[_0x1ebc16(0x2c4)]>0x0&&sendToPython(_0x36ff71,'PREDICT_ENERGY',{'current_temps':_0x1859d1,'t_out':_0x19b28a});}catch(_0x3033b2){}}function updateHealthVector(_0x3c24c5){const _0x1dbc7d=a0_0x5f2b3f;if(!_0x3c24c5[_0x1dbc7d(0x1c9)]||_0x3c24c5[_0x1dbc7d(0x1c9)]['length']===0x0)return;const _0x13ca71=new Array(0x60)['fill'](0x0),_0x428673=new Date()[_0x1dbc7d(0x25d)](0x0,0x0,0x0,0x0);_0x3c24c5[_0x1dbc7d(0x1c9)][_0x1dbc7d(0x2a7)](_0x42b663=>{const _0x3132bf=_0x1dbc7d,_0x64e2bc=new Date(_0x42b663[_0x3132bf(0x2d0)]);if(_0x64e2bc[_0x3132bf(0x202)]()>=_0x428673){const _0x136aed=_0x64e2bc['getHours'](),_0x113b59=_0x64e2bc['getMinutes'](),_0x4423ab=_0x136aed*0x4+Math['floor'](_0x113b59/0xf);if(_0x4423ab>=0x0&&_0x4423ab<0x60)_0x13ca71[_0x4423ab]++;}}),_0x3c24c5[_0x1dbc7d(0x259)]('analysis.health.todayVector',{'val':JSON[_0x1dbc7d(0x2e1)](_0x13ca71),'ack':!![]});}async function getWeatherContext(_0x58a7a0){const _0x47bf2f=a0_0x5f2b3f;if(!_0x58a7a0[_0x47bf2f(0x1fd)][_0x47bf2f(0x274)]||!_0x58a7a0['config'][_0x47bf2f(0x247)])return _0x47bf2f(0x1dd);try{const _0x43b299=_0x58a7a0[_0x47bf2f(0x1fd)][_0x47bf2f(0x247)];let _0x5dc8b9=await _0x58a7a0[_0x47bf2f(0x277)](_0x43b299+'.Current.Temperature');if(!_0x5dc8b9)_0x5dc8b9=await _0x58a7a0[_0x47bf2f(0x277)](_0x43b299+'.forecast.current.temperature');let _0x19577a=await _0x58a7a0[_0x47bf2f(0x277)](_0x43b299+_0x47bf2f(0x2c1));if(!_0x19577a)_0x19577a=await _0x58a7a0[_0x47bf2f(0x277)](_0x43b299+_0x47bf2f(0x2f2));if(_0x5dc8b9&&_0x19577a)return _0x5dc8b9[_0x47bf2f(0x211)]+_0x47bf2f(0x1be)+_0x19577a[_0x47bf2f(0x211)];}catch(_0x8b3cc0){}return _0x47bf2f(0x1a1);}async function getCalendarContext(_0x31d7b3){const _0x4f249f=a0_0x5f2b3f;if(!_0x31d7b3['config']['useCalendar']||!_0x31d7b3[_0x4f249f(0x1fd)][_0x4f249f(0x2bd)])return _0x4f249f(0x1ec);return _0x4f249f(0x282);}async function getCalendarNames(_0x542bfb,_0x27f11c){return[];}async function saveFeedback(_0x3fd7ab,_0x2d4fa4){const _0x330df4=a0_0x5f2b3f;_0x3fd7ab[_0x330df4(0x23d)][_0x330df4(0x1dc)](_0x330df4(0x25a)+_0x2d4fa4['rating']);}async function runGeminiAnalysis(_0x5808d4,_0x417fdd=''){const _0x5f0d3f=a0_0x5f2b3f;if(!_0x5808d4[_0x5f0d3f(0x25e)])return;if(_0x5808d4[_0x5f0d3f(0x283)][_0x5f0d3f(0x2c4)]===0x0)return;const _0x17a249=_0x5808d4['eventHistory']['slice'](0x0,0xf),_0x48f97d=await getWeatherContext(_0x5808d4),_0x51272e=_0x5808d4[_0x5f0d3f(0x30b)],_0x2c2ef6=PERSONA_MAPPING[_0x5808d4[_0x5f0d3f(0x1fd)][_0x5f0d3f(0x260)]||'generic'],_0x188e01=_0x5808d4[_0x5f0d3f(0x1fd)][_0x5f0d3f(0x1b4)]||'Keine\x20Details.';let _0x4a5102=_0x5f0d3f(0x2f6);try{const _0x5a4cc9=await _0x5808d4[_0x5f0d3f(0x2af)](_0x5f0d3f(0x2cc));if(_0x5a4cc9&&_0x5a4cc9[_0x5f0d3f(0x211)])_0x4a5102=_0x5a4cc9['val'];}catch(_0x135d9f){}let _0x40045c=![];try{const _0xdbdc1a=await _0x5808d4[_0x5f0d3f(0x2af)](_0x5f0d3f(0x1c6));if(_0xdbdc1a&&_0xdbdc1a[_0x5f0d3f(0x211)])_0x40045c=!![];}catch(_0x1a8f25){}const _0x5463da=_0x5f0d3f(0x192)+_0x2c2ef6+_0x5f0d3f(0x244)+_0x188e01+'.\x20SYSTEM_MODE:\x20'+_0x51272e+_0x5f0d3f(0x27a)+_0x48f97d+_0x5f0d3f(0x2d3)+_0x4a5102+_0x5f0d3f(0x1cf)+JSON[_0x5f0d3f(0x2e1)](_0x17a249)+'.\x20EMERGENCY:\x20'+_0x417fdd+_0x5f0d3f(0x2b7);try{const _0x2f9001=await _0x5808d4['geminiModel']['generateContent'](_0x5463da),_0x25db91=JSON[_0x5f0d3f(0x289)](_0x2f9001['response']['text']()[_0x5f0d3f(0x22f)](/```json|```/g,'')[_0x5f0d3f(0x2c9)]());await _0x5808d4['setStateAsync'](_0x5f0d3f(0x246),{'val':JSON[_0x5f0d3f(0x2e1)](_0x25db91),'ack':!![]});if(_0x25db91[_0x5f0d3f(0x1c8)])await _0x5808d4[_0x5f0d3f(0x259)](_0x5f0d3f(0x2f0),{'val':_0x25db91[_0x5f0d3f(0x1c8)],'ack':!![]});const _0x421aee={'timestamp':Date[_0x5f0d3f(0x199)](),'id':Date['now']()[_0x5f0d3f(0x19e)](),'analysis':{'activity':{'summary':_0x25db91['summary'],'isAlert':_0x25db91['isAlert'],'alertReason':_0x25db91[_0x5f0d3f(0x212)]},'comfort':{'automationProposal':_0x25db91[_0x5f0d3f(0x1fa)]}}};await updateAnalysisHistory(_0x5808d4,_0x421aee);const _0x31de44=_0x25db91[_0x5f0d3f(0x279)]||![];_0x31de44!==_0x5808d4[_0x5f0d3f(0x2ef)]&&(await _0x5808d4['setStateAsync'](_0x5f0d3f(0x2a1),{'val':_0x31de44,'ack':!![]}),_0x5808d4[_0x5f0d3f(0x2ef)]=_0x31de44,_0x31de44&&(await _0x5808d4[_0x5f0d3f(0x259)](_0x5f0d3f(0x2e7),{'val':_0x25db91[_0x5f0d3f(0x212)],'ack':!![]}),sendNotification(_0x5808d4,_0x5f0d3f(0x1e2)+_0x25db91['alertReason'],![],_0x25db91[_0x5f0d3f(0x23b)])));if(_0x25db91[_0x5f0d3f(0x1fa)]&&_0x25db91[_0x5f0d3f(0x1fa)][_0x5f0d3f(0x2fd)]){await _0x5808d4['setStateAsync'](_0x5f0d3f(0x27f),{'val':!![],'ack':!![]}),await _0x5808d4['setStateAsync'](_0x5f0d3f(0x1a3),{'val':_0x25db91[_0x5f0d3f(0x1fa)]['description'],'ack':!![]}),await _0x5808d4[_0x5f0d3f(0x259)](_0x5f0d3f(0x303),{'val':_0x25db91['automationProposal'][_0x5f0d3f(0x1c1)],'ack':!![]}),await _0x5808d4[_0x5f0d3f(0x259)]('analysis.automation.targetValue',{'val':JSON[_0x5f0d3f(0x2e1)](_0x25db91[_0x5f0d3f(0x1fa)][_0x5f0d3f(0x20f)]),'ack':!![]});if(_0x40045c)executeAutomationAction(_0x5808d4);}}catch(_0x8495){_0x5808d4['log']['error'](_0x5f0d3f(0x225)+_0x8495[_0x5f0d3f(0x262)]);}}async function startSystem(_0x58328f){const _0x4a143b=a0_0x5f2b3f;_0x58328f[_0x4a143b(0x23d)]['info'](_0x4a143b(0x23a)),await initZombies(_0x58328f);try{_0x58328f[_0x4a143b(0x27d)]=await checkLicense(_0x58328f['config']['licenseKey']);}catch(_0x5d5b2f){}if(!_0x58328f[_0x4a143b(0x1fd)][_0x4a143b(0x1ed)]||_0x58328f[_0x4a143b(0x1fd)][_0x4a143b(0x1ed)]<0.1)_0x58328f[_0x4a143b(0x1fd)][_0x4a143b(0x1ed)]=0xc;await initHistory(_0x58328f),await initSystemConfig(_0x58328f);if(_0x58328f[_0x4a143b(0x1fd)][_0x4a143b(0x2ea)])try{_0x58328f['genAI']=new GoogleGenerativeAI(_0x58328f[_0x4a143b(0x1fd)][_0x4a143b(0x2ea)]),_0x58328f[_0x4a143b(0x25e)]=_0x58328f[_0x4a143b(0x2b5)][_0x4a143b(0x2df)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),_0x58328f[_0x4a143b(0x23d)][_0x4a143b(0x1dc)](_0x4a143b(0x249));}catch(_0x21f8a6){_0x58328f[_0x4a143b(0x23d)][_0x4a143b(0x294)](_0x4a143b(0x1b9)+_0x21f8a6[_0x4a143b(0x262)]);}await createAllObjects(_0x58328f),await loadSystemMode(_0x58328f),await loadRawEventLog(_0x58328f),await loadDailyDigests(_0x58328f),_0x58328f[_0x4a143b(0x27c)](_0x4a143b(0x2ba)),_0x58328f[_0x4a143b(0x27c)](LTM_DP_TRIGGER_DIGEST),_0x58328f['subscribeStates'](_0x4a143b(0x205)),_0x58328f['subscribeStates'](_0x4a143b(0x28b)),_0x58328f[_0x4a143b(0x27c)]('analysis.automation.triggerAction'),_0x58328f[_0x4a143b(0x27c)](_0x4a143b(0x1c6)),_0x58328f[_0x4a143b(0x27c)](_0x4a143b(0x25c)),_0x58328f['subscribeStates']('analysis.training.triggerHealth'),_0x58328f[_0x4a143b(0x27c)](_0x4a143b(0x2fb)),_0x58328f[_0x4a143b(0x27c)]('analysis.training.triggerComfort'),_0x58328f[_0x4a143b(0x27c)](_0x4a143b(0x22a)),await initSensorSubscriptions(_0x58328f),await initPresenceSubscriptions(_0x58328f),await setupTelegramListener(_0x58328f),setTimeout(()=>checkWifiPresence(_0x58328f),0x1388);if(_0x58328f[_0x4a143b(0x1cc)])clearInterval(_0x58328f[_0x4a143b(0x1cc)]);const _0x1fc0b4=_0x58328f[_0x4a143b(0x1fd)][_0x4a143b(0x1b6)]||0xf;_0x1fc0b4>0x0&&(_0x58328f[_0x4a143b(0x1cc)]=setInterval(()=>{runAutopilot(_0x58328f);},_0x1fc0b4*0x3c*0x3e8)),schedulers[_0x4a143b(0x1bf)](_0x58328f,()=>createDailyDigest(_0x58328f)),schedulers[_0x4a143b(0x233)](_0x58328f),schedulers[_0x4a143b(0x218)](_0x58328f,()=>runBaselineDriftAnalysis(_0x58328f)),schedulers[_0x4a143b(0x2bb)](_0x58328f,()=>sendMorningBriefing(_0x58328f)),startPythonService(_0x58328f),setTimeout(()=>{const _0x24e1fe=_0x4a143b;_0x58328f[_0x24e1fe(0x1aa)]&&(runPythonHealthCheck(_0x58328f),triggerGaitAnalysis(_0x58328f),triggerEnergyPrediction(_0x58328f)),updateHealthVector(_0x58328f);},0x1388);}class CogniLiving extends utils[a0_0x5f2b3f(0x19c)]{constructor(_0x3eee9b){const _0x26d140=a0_0x5f2b3f;super({..._0x3eee9b,'name':'cogni-living'}),this[_0x26d140(0x283)]=[],this[_0x26d140(0x18e)]=[],this['rawEventLog']=[],this[_0x26d140(0x2ff)]=[],this[_0x26d140(0x295)]={},this[_0x26d140(0x1a0)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x26d140(0x2fc)]=!![],this['exitTimer']=null,this[_0x26d140(0x29f)]=null,this[_0x26d140(0x299)]=![],this[_0x26d140(0x2b5)]=null,this[_0x26d140(0x25e)]=null,this['currentSystemMode']=SYSTEM_MODES['NORMAL'],this[_0x26d140(0x27d)]=![],this['lastAlertState']=![],this[_0x26d140(0x26d)]=_0x26d140(0x1ae),this[_0x26d140(0x1cc)]=null,this[_0x26d140(0x2b0)]=null,this[_0x26d140(0x2ac)]=null,this[_0x26d140(0x24e)]=null,this['briefingJob']=null,this[_0x26d140(0x1aa)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x26d140(0x20c),this[_0x26d140(0x203)][_0x26d140(0x229)](this)),this['on'](_0x26d140(0x2bf),this[_0x26d140(0x1e7)][_0x26d140(0x229)](this)),this['on'](_0x26d140(0x2f7),this[_0x26d140(0x1a5)]['bind'](this)),this['on'](_0x26d140(0x262),this[_0x26d140(0x24b)][_0x26d140(0x229)](this));}async[a0_0x5f2b3f(0x203)](){const _0x32bd22=a0_0x5f2b3f;this[_0x32bd22(0x23d)][_0x32bd22(0x1dc)](_0x32bd22(0x1f9)+this['version']+_0x32bd22(0x2da));if(!installer[_0x32bd22(0x1f7)](this,()=>startSystem(this)))return;}['onUnload'](_0x433501){const _0x4529f0=a0_0x5f2b3f;if(this[_0x4529f0(0x1cc)])clearInterval(this[_0x4529f0(0x1cc)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x4529f0(0x24e)]);if(this[_0x4529f0(0x2b0)])this[_0x4529f0(0x2b0)][_0x4529f0(0x2cd)]();if(this[_0x4529f0(0x2ac)])this[_0x4529f0(0x2ac)][_0x4529f0(0x2cd)]();if(this[_0x4529f0(0x307)])this[_0x4529f0(0x307)][_0x4529f0(0x2cd)]();if(this[_0x4529f0(0x292)])clearTimeout(this[_0x4529f0(0x292)]);if(this['exitGraceTimer'])clearTimeout(this[_0x4529f0(0x29f)]);stopPythonService(this),_0x433501();}async['onStateChange'](_0x9b8c68,_0x2bfeaa){const _0x4d8ac2=a0_0x5f2b3f;if(!_0x2bfeaa||this[_0x4d8ac2(0x27b)])return;if(_0x9b8c68[_0x4d8ac2(0x1b5)](_0x4d8ac2(0x2c0))&&_0x9b8c68['endsWith'](_0x4d8ac2(0x222))&&_0x2bfeaa[_0x4d8ac2(0x211)]){await handleTelegramResponse(this,_0x2bfeaa[_0x4d8ac2(0x211)]);return;}if(_0x9b8c68===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0x2bfeaa[_0x4d8ac2(0x211)]&&Object[_0x4d8ac2(0x19a)](SYSTEM_MODES)[_0x4d8ac2(0x1b5)](_0x2bfeaa['val'])){this[_0x4d8ac2(0x30b)]=_0x2bfeaa[_0x4d8ac2(0x211)];if(_0x2bfeaa['val']===SYSTEM_MODES[_0x4d8ac2(0x1df)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x2bfeaa[_0x4d8ac2(0x250)])this['setState'](_0x9b8c68,{'val':this[_0x4d8ac2(0x30b)],'ack':!![]});return;}if(!_0x2bfeaa['ack']){_0x9b8c68[_0x4d8ac2(0x1b5)](_0x4d8ac2(0x2ba))&&_0x2bfeaa['val']&&(this[_0x4d8ac2(0x1de)](_0x9b8c68,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x9b8c68[_0x4d8ac2(0x1b5)](_0x4d8ac2(0x273))&&_0x2bfeaa[_0x4d8ac2(0x211)]){this[_0x4d8ac2(0x1de)](_0x9b8c68,{'val':![],'ack':!![]});if(this[_0x4d8ac2(0x27d)])createDailyDigest(this);}_0x9b8c68[_0x4d8ac2(0x1b5)]('triggerBriefing')&&_0x2bfeaa[_0x4d8ac2(0x211)]&&(this[_0x4d8ac2(0x1de)](_0x9b8c68,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x9b8c68[_0x4d8ac2(0x1b5)](_0x4d8ac2(0x234))&&_0x2bfeaa['val']&&(this['setState'](_0x9b8c68,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x9b8c68[_0x4d8ac2(0x1b5)](_0x4d8ac2(0x25c))&&_0x2bfeaa[_0x4d8ac2(0x211)]){this[_0x4d8ac2(0x1de)](_0x9b8c68,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0xb9abce=await this['getStateAsync'](_0x4d8ac2(0x235));if(_0xb9abce&&_0xb9abce['val']){const _0x133ded=JSON[_0x4d8ac2(0x289)](_0xb9abce[_0x4d8ac2(0x211)]);this['log'][_0x4d8ac2(0x1dc)]('ðŸ§ \x20Triggering\x20Security\x20Training...'),this['setStateAsync']('analysis.training.status',{'val':_0x4d8ac2(0x1a4),'ack':!![]}),sendToPython(this,_0x4d8ac2(0x182),{'sequences':_0x133ded});}}catch(_0x31190b){this[_0x4d8ac2(0x23d)][_0x4d8ac2(0x294)]('Training\x20Error:\x20'+_0x31190b['message']);}}if(_0x9b8c68[_0x4d8ac2(0x1b5)](_0x4d8ac2(0x1eb))&&_0x2bfeaa[_0x4d8ac2(0x211)]){this[_0x4d8ac2(0x1de)](_0x9b8c68,{'val':![],'ack':!![]});if(this[_0x4d8ac2(0x27d)])try{const _0x3fee16=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x3fee16&&_0x3fee16[_0x4d8ac2(0x211)])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0x4d8ac2(0x289)](_0x3fee16[_0x4d8ac2(0x211)])});}catch(_0x4316af){}}if(_0x9b8c68[_0x4d8ac2(0x1b5)]('analysis.training.triggerEnergy')&&_0x2bfeaa[_0x4d8ac2(0x211)]){this['setState'](_0x9b8c68,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x28c220=await this[_0x4d8ac2(0x2af)]('LTM.trainingData.thermodynamics');if(_0x28c220&&_0x28c220[_0x4d8ac2(0x211)])sendToPython(this,_0x4d8ac2(0x1f8),{'points':JSON[_0x4d8ac2(0x289)](_0x28c220['val'])});}catch(_0x4830ff){}}if(_0x9b8c68[_0x4d8ac2(0x1b5)](_0x4d8ac2(0x189))&&_0x2bfeaa[_0x4d8ac2(0x211)]){this['setState'](_0x9b8c68,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x89dc41=await this[_0x4d8ac2(0x2af)](LTM_DP_RAW_LOG);_0x89dc41&&_0x89dc41[_0x4d8ac2(0x211)]&&(this[_0x4d8ac2(0x23d)]['info']('ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...'),sendToPython(this,_0x4d8ac2(0x1a9),{'events':JSON['parse'](_0x89dc41[_0x4d8ac2(0x211)])}));}catch(_0x4611ab){}}if(_0x9b8c68[_0x4d8ac2(0x1b5)](_0x4d8ac2(0x22a))&&_0x2bfeaa[_0x4d8ac2(0x211)]){this[_0x4d8ac2(0x1de)](_0x9b8c68,{'val':![],'ack':!![]});if(this[_0x4d8ac2(0x27d)])try{const _0x505549=await this[_0x4d8ac2(0x2af)](_0x4d8ac2(0x235));if(_0x505549&&_0x505549[_0x4d8ac2(0x211)]){const _0x53f595=JSON[_0x4d8ac2(0x289)](_0x505549[_0x4d8ac2(0x211)]);this[_0x4d8ac2(0x23d)][_0x4d8ac2(0x1dc)](_0x4d8ac2(0x1c5)),sendToPython(this,'BUILD_TOPOLOGY',{'sequences':_0x53f595});}}catch(_0x542c45){this[_0x4d8ac2(0x23d)][_0x4d8ac2(0x294)](_0x4d8ac2(0x20a)+_0x542c45[_0x4d8ac2(0x262)]);}}return;}if(this['config'][_0x4d8ac2(0x288)]&&this[_0x4d8ac2(0x1fd)][_0x4d8ac2(0x288)][_0x4d8ac2(0x1b5)](_0x9b8c68)){await checkWifiPresence(this);return;}const _0x565c2d=(this[_0x4d8ac2(0x1fd)][_0x4d8ac2(0x1bb)]||[])[_0x4d8ac2(0x241)](_0x229937=>_0x229937['id']===_0x9b8c68);if(_0x565c2d)processSensorEvent(this,_0x9b8c68,_0x2bfeaa,_0x565c2d);}async[a0_0x5f2b3f(0x24b)](_0x13cd92){const _0x5c4e94=a0_0x5f2b3f;if(typeof _0x13cd92==='object'&&_0x13cd92['message']){if(_0x13cd92[_0x5c4e94(0x24f)]===_0x5c4e94(0x2e3)){const _0x3a182c=_0x13cd92[_0x5c4e94(0x262)][_0x5c4e94(0x1ee)]||this[_0x5c4e94(0x1fd)]['geminiApiKey'];if(!_0x3a182c)return this[_0x5c4e94(0x2ae)](_0x13cd92['from'],_0x13cd92[_0x5c4e94(0x24f)],{'success':![],'message':_0x5c4e94(0x296)},_0x13cd92[_0x5c4e94(0x20b)]);try{const _0x32cf0d=new GoogleGenerativeAI(_0x3a182c),_0x2e467a=_0x32cf0d[_0x5c4e94(0x2df)]({'model':GEMINI_MODEL}),_0x5ae156=await _0x2e467a[_0x5c4e94(0x248)]('Hi');this[_0x5c4e94(0x2ae)](_0x13cd92['from'],_0x13cd92[_0x5c4e94(0x24f)],{'success':!![],'message':_0x5c4e94(0x206)+_0x5ae156['response'][_0x5c4e94(0x226)]()},_0x13cd92['callback']);}catch(_0x292cc9){this[_0x5c4e94(0x2ae)](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92[_0x5c4e94(0x24f)],{'success':![],'message':_0x5c4e94(0x26f)+_0x292cc9[_0x5c4e94(0x262)]},_0x13cd92[_0x5c4e94(0x20b)]);}}else{if(_0x13cd92[_0x5c4e94(0x24f)]===_0x5c4e94(0x24a)){const _0x4c6f65=await getWeatherContext(this),_0x4ff3c4=await getCalendarContext(this);this[_0x5c4e94(0x2ae)](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92['command'],{'success':!![],'weather':_0x4c6f65,'calendar':_0x4ff3c4},_0x13cd92[_0x5c4e94(0x20b)]);}else{if(_0x13cd92[_0x5c4e94(0x24f)]===_0x5c4e94(0x240)){if(!this[_0x5c4e94(0x27d)])return this[_0x5c4e94(0x2ae)](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92[_0x5c4e94(0x24f)],{'success':![],'isPro':![]},_0x13cd92[_0x5c4e94(0x20b)]);let _0x3ef490={'status':'N/A'};try{const _0x3064e0=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x3ef490['status']=_0x3064e0?_0x3064e0[_0x5c4e94(0x211)]:_0x5c4e94(0x221);}catch(_0x4632ab){}this['sendTo'](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92[_0x5c4e94(0x24f)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x5c4e94(0x2ff)],'driftAnalysis':_0x3ef490,'analysisHistory':this[_0x5c4e94(0x18e)]},_0x13cd92['callback']);}else{if(_0x13cd92['command']===_0x5c4e94(0x293)){const _0x53174a=this[_0x5c4e94(0x2ff)]['length'],_0x50adad=new Date(),_0x49e4aa=new Date(_0x50adad[_0x5c4e94(0x1f3)](),_0x50adad[_0x5c4e94(0x232)](),_0x50adad[_0x5c4e94(0x256)]())[_0x5c4e94(0x202)](),_0x54649a=this[_0x5c4e94(0x1c9)][_0x5c4e94(0x29e)](_0x418d89=>new Date(_0x418d89[_0x5c4e94(0x2d0)])[_0x5c4e94(0x202)]()>_0x49e4aa)[_0x5c4e94(0x2c4)],_0x25e1f3=new Array(0x18)['fill'](0x0);this[_0x5c4e94(0x1c9)][_0x5c4e94(0x2a7)](_0x28efd7=>{const _0x52db00=_0x5c4e94,_0x415bbd=new Date(_0x28efd7[_0x52db00(0x2d0)]);if(_0x415bbd[_0x52db00(0x202)]()>_0x49e4aa)_0x25e1f3[_0x415bbd[_0x52db00(0x190)]()]++;});let _0x183928={'status':_0x5c4e94(0x221)};try{const _0x275f96=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x183928[_0x5c4e94(0x2c5)]=_0x275f96?_0x275f96['val']:_0x5c4e94(0x221);}catch(_0x1121fe){}let _0x5901b8='';try{const _0x104287=await this[_0x5c4e94(0x2af)](_0x5c4e94(0x2cc));_0x5901b8=_0x104287?_0x104287[_0x5c4e94(0x211)]:'';}catch(_0x2fc37d){}let _0x21420e=null;!this[_0x5c4e94(0x25e)]&&(_0x21420e=this['config'][_0x5c4e94(0x2ea)]?_0x5c4e94(0x2a0):'Kein\x20API\x20Key!');let _0x5e4a07={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x4d34f1=await this['getStateAsync'](_0x5c4e94(0x27f));if(_0x4d34f1&&_0x4d34f1[_0x5c4e94(0x211)]){_0x5e4a07[_0x5c4e94(0x2fd)]=!![];const _0x101a5b=await this[_0x5c4e94(0x2af)]('analysis.automation.description');_0x5e4a07['description']=_0x101a5b?_0x101a5b['val']:'';const _0x37aa8a=await this[_0x5c4e94(0x2af)]('analysis.automation.targetId');_0x5e4a07[_0x5c4e94(0x1c1)]=_0x37aa8a?_0x37aa8a[_0x5c4e94(0x211)]:'';const _0x2cd5ec=await this[_0x5c4e94(0x2af)](_0x5c4e94(0x2d4));_0x5e4a07[_0x5c4e94(0x20f)]=_0x2cd5ec?_0x2cd5ec[_0x5c4e94(0x211)]:'';}const _0x3edd8f=await this['getStateAsync'](_0x5c4e94(0x1c6));_0x5e4a07[_0x5c4e94(0x213)]=_0x3edd8f?!!_0x3edd8f[_0x5c4e94(0x211)]:![];}catch(_0x3bfa77){}this[_0x5c4e94(0x2ae)](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92[_0x5c4e94(0x24f)],{'success':!![],'eventHistory':this[_0x5c4e94(0x283)][_0x5c4e94(0x1f6)](0x0,0xf),'stats':{'digestCount':_0x53174a,'eventCountToday':_0x54649a,'hourlyActivity':_0x25e1f3,'driftStatus':_0x183928[_0x5c4e94(0x2c5)],'isPresent':this[_0x5c4e94(0x2fc)],'presenceWho':_0x5901b8,'minDays':this['config'][_0x5c4e94(0x25f)]||0x7,'stbDays':this['config'][_0x5c4e94(0x263)]||0xe,'ltbDays':this['config'][_0x5c4e94(0x1ca)]||0x3c,'systemError':_0x21420e},'automation':_0x5e4a07},_0x13cd92[_0x5c4e94(0x20b)]);}else{if(_0x13cd92['command']===_0x5c4e94(0x1ef))try{const _0x359ef8=await scanner[_0x5c4e94(0x1db)](this,_0x13cd92[_0x5c4e94(0x262)]||{});this[_0x5c4e94(0x2ae)](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92[_0x5c4e94(0x24f)],{'success':!![],'devices':_0x359ef8},_0x13cd92[_0x5c4e94(0x20b)]);}catch(_0xb1e393){this['sendTo'](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92[_0x5c4e94(0x24f)],{'success':![],'error':_0xb1e393[_0x5c4e94(0x262)]},_0x13cd92[_0x5c4e94(0x20b)]);}else{if(_0x13cd92['command']===_0x5c4e94(0x1a6)){const _0x28bee8=await this[_0x5c4e94(0x196)](_0x5c4e94(0x1d4),_0x5c4e94(0x2b8)),_0x180065=[];if(_0x28bee8)for(const _0x3797b4 in _0x28bee8){const _0x2d386e=_0x28bee8[_0x3797b4],_0x55c19f=(_0x2d386e['common']&&typeof _0x2d386e[_0x5c4e94(0x26b)][_0x5c4e94(0x253)]===_0x5c4e94(0x231)?_0x2d386e['common'][_0x5c4e94(0x253)]['de']:_0x2d386e[_0x5c4e94(0x26b)][_0x5c4e94(0x253)])||_0x2d386e[_0x5c4e94(0x26b)][_0x5c4e94(0x253)];_0x180065['push']({'id':_0x3797b4,'name':_0x55c19f});}const _0x467715=await this[_0x5c4e94(0x196)]('enum.rooms.*',_0x5c4e94(0x2b8)),_0x458a9d=[];if(_0x467715)for(const _0x5cf954 in _0x467715){const _0x1de6c6=_0x467715[_0x5cf954],_0x1aa37e=(_0x1de6c6[_0x5c4e94(0x26b)]&&typeof _0x1de6c6[_0x5c4e94(0x26b)]['name']===_0x5c4e94(0x231)?_0x1de6c6[_0x5c4e94(0x26b)]['name']['de']:_0x1de6c6['common']['name'])||_0x5cf954[_0x5c4e94(0x1b7)]('.')['pop']();_0x458a9d['push'](_0x1aa37e);}this['sendTo'](_0x13cd92['from'],_0x13cd92[_0x5c4e94(0x24f)],{'success':!![],'enums':_0x180065,'rooms':_0x458a9d},_0x13cd92[_0x5c4e94(0x20b)]);}else{if(_0x13cd92[_0x5c4e94(0x24f)]===_0x5c4e94(0x187)){const _0xcb5529=_0x13cd92['message'][_0x5c4e94(0x19f)];if(!_0xcb5529)return this[_0x5c4e94(0x2ae)](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92[_0x5c4e94(0x24f)],{'success':![],'error':'No\x20instance'},_0x13cd92[_0x5c4e94(0x20b)]);const _0x3b7ebb=await getCalendarNames(this,_0xcb5529);this[_0x5c4e94(0x2ae)](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92[_0x5c4e94(0x24f)],{'success':!![],'names':_0x3b7ebb},_0x13cd92[_0x5c4e94(0x20b)]);}else{if(_0x13cd92['command']===_0x5c4e94(0x2e6)){const {targetId:_0x1ab087,targetValue:_0x2080a8}=_0x13cd92['message'];this[_0x5c4e94(0x23d)][_0x5c4e94(0x1dc)]('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0x1ab087+_0x5c4e94(0x184)+_0x2080a8),await this[_0x5c4e94(0x259)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x5c4e94(0x259)](_0x5c4e94(0x1a3),{'val':_0x5c4e94(0x2aa)+_0x1ab087,'ack':!![]}),await this[_0x5c4e94(0x259)]('analysis.automation.targetId',{'val':_0x1ab087,'ack':!![]}),await this['setStateAsync'](_0x5c4e94(0x2d4),{'val':_0x2080a8,'ack':!![]}),this[_0x5c4e94(0x2ae)](_0x13cd92['from'],_0x13cd92[_0x5c4e94(0x24f)],{'success':!![]},_0x13cd92[_0x5c4e94(0x20b)]);}else{if(_0x13cd92[_0x5c4e94(0x24f)]===_0x5c4e94(0x272)){const {historyId:_0x1d675e,rating:_0x215b03,comment:_0x3e0c43,alertReason:_0x4aafe1}=_0x13cd92[_0x5c4e94(0x262)];_0x1d675e&&_0x215b03?(await saveFeedback(this,{'timestamp':Date[_0x5c4e94(0x199)](),'historyId':_0x1d675e,'rating':_0x215b03,'comment':_0x3e0c43,'alertReason':_0x4aafe1}),this[_0x5c4e94(0x2ae)](_0x13cd92[_0x5c4e94(0x1ff)],_0x13cd92['command'],{'success':!![]},_0x13cd92['callback'])):this[_0x5c4e94(0x2ae)](_0x13cd92['from'],_0x13cd92[_0x5c4e94(0x24f)],{'success':![],'error':_0x5c4e94(0x18c)},_0x13cd92[_0x5c4e94(0x20b)]);}else _0x13cd92[_0x5c4e94(0x24f)]==='dismissAutomation'&&(this[_0x5c4e94(0x23d)][_0x5c4e94(0x1dc)](_0x5c4e94(0x266)),await this[_0x5c4e94(0x259)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x5c4e94(0x259)](_0x5c4e94(0x1a3),{'val':'','ack':!![]}),this['sendTo'](_0x13cd92['from'],_0x13cd92['command'],{'success':!![]},_0x13cd92[_0x5c4e94(0x20b)]));}}}}}}}}}}}if(require['main']!==module)module[a0_0x5f2b3f(0x208)]=_0x5c3baa=>new CogniLiving(_0x5c3baa);else new CogniLiving();