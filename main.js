const a0_0x2688fa=a0_0x497e;(function(_0x12f2a9,_0x595813){const _0x1db157=a0_0x497e,_0x300de8=_0x12f2a9();while(!![]){try{const _0x16bf61=-parseInt(_0x1db157(0x287))/0x1*(parseInt(_0x1db157(0x27e))/0x2)+-parseInt(_0x1db157(0x175))/0x3*(-parseInt(_0x1db157(0x140))/0x4)+parseInt(_0x1db157(0x1f3))/0x5+-parseInt(_0x1db157(0x193))/0x6+parseInt(_0x1db157(0x1d8))/0x7*(parseInt(_0x1db157(0x295))/0x8)+-parseInt(_0x1db157(0x227))/0x9+-parseInt(_0x1db157(0x256))/0xa*(-parseInt(_0x1db157(0x291))/0xb);if(_0x16bf61===_0x595813)break;else _0x300de8['push'](_0x300de8['shift']());}catch(_0x2deb47){_0x300de8['push'](_0x300de8['shift']());}}}(a0_0x3d7a,0x6c10b));const a0_0x5d221c=(function(){let _0x29c34a=!![];return function(_0x14a84e,_0x14f02b){const _0x19ae00=_0x29c34a?function(){const _0x89592c=a0_0x497e;if(_0x14f02b){const _0x2f6ea3=_0x14f02b[_0x89592c(0x298)](_0x14a84e,arguments);return _0x14f02b=null,_0x2f6ea3;}}:function(){};return _0x29c34a=![],_0x19ae00;};}()),a0_0x1fa229=a0_0x5d221c(this,function(){const _0x3c70ba=a0_0x497e;return a0_0x1fa229[_0x3c70ba(0x1bd)]()['search'](_0x3c70ba(0x138))[_0x3c70ba(0x1bd)]()[_0x3c70ba(0x1ab)](a0_0x1fa229)[_0x3c70ba(0x18b)](_0x3c70ba(0x138));});a0_0x1fa229();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x2688fa(0x180)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x2688fa(0x1c5),MODE_RESET_SCHEDULE=a0_0x2688fa(0x1ee),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x2688fa(0x13e),LTM_DP_DAILY_DIGESTS=a0_0x2688fa(0x242),LTM_DP_STATUS=a0_0x2688fa(0x288),LTM_DP_TRIGGER_DIGEST=a0_0x2688fa(0x1f0),LTM_DP_BASELINE_STATUS=a0_0x2688fa(0x18d),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x2688fa(0x131),LTM_DP_DRIFT_DETAILS=a0_0x2688fa(0x12e),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x2688fa(0x1bf),HARD_IGNORE_TERMS=[a0_0x2688fa(0x240),a0_0x2688fa(0x15b),'update','unreach',a0_0x2688fa(0x1c2),a0_0x2688fa(0x168),a0_0x2688fa(0x1a2),a0_0x2688fa(0x22a),a0_0x2688fa(0x1e6),a0_0x2688fa(0x1e8),a0_0x2688fa(0x1d6),a0_0x2688fa(0x285),'stick_unreach',a0_0x2688fa(0x190),a0_0x2688fa(0x224),a0_0x2688fa(0x266),'reachable',a0_0x2688fa(0x166)],BAD_NAMES=[a0_0x2688fa(0x2a8),a0_0x2688fa(0x169),a0_0x2688fa(0x25d),a0_0x2688fa(0x2ab),a0_0x2688fa(0x247),a0_0x2688fa(0x29b),'on',a0_0x2688fa(0x137),a0_0x2688fa(0x22e),a0_0x2688fa(0x2ad),a0_0x2688fa(0x1fd),a0_0x2688fa(0x294),'cover',a0_0x2688fa(0x274),a0_0x2688fa(0x139),a0_0x2688fa(0x19d),a0_0x2688fa(0x23d),a0_0x2688fa(0x125),a0_0x2688fa(0x196),a0_0x2688fa(0x18f),a0_0x2688fa(0x1df),a0_0x2688fa(0x25c),a0_0x2688fa(0x170),a0_0x2688fa(0x1ac),a0_0x2688fa(0x1fe)],ADAPTER_BLACKLIST=[a0_0x2688fa(0x182),a0_0x2688fa(0x246),a0_0x2688fa(0x230),a0_0x2688fa(0x128),a0_0x2688fa(0x18c),a0_0x2688fa(0x250),'icons-mfd.',a0_0x2688fa(0x1ea),a0_0x2688fa(0x273),a0_0x2688fa(0x28f),a0_0x2688fa(0x27b)],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x2688fa(0x236),'PARTY':a0_0x2688fa(0x216),'GUEST':a0_0x2688fa(0x23e)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x2688fa(0x16e)]],PERSONA_MAPPING={'generic':a0_0x2688fa(0x2b6),'senior_aal':a0_0x2688fa(0x1e5),'family':a0_0x2688fa(0x123),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x2688fa(0x1f4)};class CogniLiving extends utils[a0_0x2688fa(0x1c1)]{constructor(_0x3d2d8f){const _0x99242c=a0_0x2688fa;super({..._0x3d2d8f,'name':_0x99242c(0x297)}),this[_0x99242c(0x28b)]=[],this[_0x99242c(0x14c)]=[],this[_0x99242c(0x24d)]=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x99242c(0x21e)]={},this[_0x99242c(0x177)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x99242c(0x12d)]=!![],this['exitTimer']=null,this[_0x99242c(0x1e4)]=null,this[_0x99242c(0x277)]=![],this[_0x99242c(0x130)]=null,this[_0x99242c(0x155)]=null,this[_0x99242c(0x16f)]=SYSTEM_MODES[_0x99242c(0x179)],this[_0x99242c(0x265)]=![],this[_0x99242c(0x142)]=![],this[_0x99242c(0x1f1)]='unknown',this[_0x99242c(0x221)]=null,this[_0x99242c(0x1b5)]=null,this[_0x99242c(0x29a)]=null,this[_0x99242c(0x214)]=null,this[_0x99242c(0x22d)]=null,this['on'](_0x99242c(0x2a3),this[_0x99242c(0x12b)][_0x99242c(0x28d)](this)),this['on'](_0x99242c(0x213),this['onStateChange'][_0x99242c(0x28d)](this)),this['on']('unload',this[_0x99242c(0x19f)][_0x99242c(0x28d)](this)),this['on']('message',this[_0x99242c(0x1cd)][_0x99242c(0x28d)](this));}async[a0_0x2688fa(0x12b)](){const _0x42a03e=a0_0x2688fa;this[_0x42a03e(0x15e)][_0x42a03e(0x1eb)](_0x42a03e(0x21c)+this[_0x42a03e(0x29d)]+')'),await initZombies(this),this['config'][_0x42a03e(0x226)]=this[_0x42a03e(0x20a)][_0x42a03e(0x226)]||'';try{this[_0x42a03e(0x265)]=await checkLicense(this,this[_0x42a03e(0x20a)][_0x42a03e(0x226)]);}catch(_0x43b5aa){}if(!this[_0x42a03e(0x20a)][_0x42a03e(0x173)]||this['config'][_0x42a03e(0x173)]<0.1)this[_0x42a03e(0x20a)][_0x42a03e(0x173)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config'][_0x42a03e(0x1d9)])try{this['genAI']=new GoogleGenerativeAI(this[_0x42a03e(0x20a)][_0x42a03e(0x1d9)]),this[_0x42a03e(0x155)]=this['genAI'][_0x42a03e(0x1b2)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x42a03e(0x1cb)}}),this[_0x42a03e(0x15e)]['info']('Gemini\x20AI\x20initialized.');}catch(_0x50cf58){this['log']['error']('Gemini\x20Init\x20Error:\x20'+_0x50cf58[_0x42a03e(0x26b)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x42a03e(0x217)]('analysis.trigger'),this[_0x42a03e(0x217)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x42a03e(0x1bf)),this[_0x42a03e(0x217)]('analysis.triggerBriefing'),this[_0x42a03e(0x217)](_0x42a03e(0x207)),this['subscribeStates']('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x42a03e(0x221)])clearInterval(this[_0x42a03e(0x221)]);const _0x354919=this[_0x42a03e(0x20a)]['analysisInterval']||0xf;_0x354919>0x0&&(this[_0x42a03e(0x15e)][_0x42a03e(0x1eb)](_0x42a03e(0x154)+_0x354919+_0x42a03e(0x1c6)),this[_0x42a03e(0x221)]=setInterval(()=>{runAutopilot(this);},_0x354919*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this);}['onUnload'](_0x622cae){const _0x2f08a3=a0_0x2688fa;if(this['analysisTimer'])clearInterval(this[_0x2f08a3(0x221)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x2f08a3(0x214)]);if(this[_0x2f08a3(0x1b5)])this[_0x2f08a3(0x1b5)][_0x2f08a3(0x15a)]();if(this['modeResetJob'])this[_0x2f08a3(0x29a)][_0x2f08a3(0x15a)]();if(this[_0x2f08a3(0x22d)])this['briefingJob'][_0x2f08a3(0x15a)]();if(this[_0x2f08a3(0x23a)])clearTimeout(this['exitTimer']);if(this[_0x2f08a3(0x1e4)])clearTimeout(this[_0x2f08a3(0x1e4)]);_0x622cae();}async['onStateChange'](_0x54a550,_0x2ef672){const _0x2e6844=a0_0x2688fa;if(!_0x2ef672)return;if(_0x54a550[_0x2e6844(0x225)](_0x2e6844(0x18e))&&_0x54a550[_0x2e6844(0x172)](_0x2e6844(0x2b0))&&_0x2ef672[_0x2e6844(0x235)]){await handleTelegramResponse(this,_0x2ef672[_0x2e6844(0x235)]);return;}if(_0x54a550===this['namespace']+'.'+SYSTEM_DP_MODE){_0x2ef672[_0x2e6844(0x235)]&&Object[_0x2e6844(0x232)](SYSTEM_MODES)[_0x2e6844(0x225)](_0x2ef672[_0x2e6844(0x235)])&&(this[_0x2e6844(0x16f)]=_0x2ef672[_0x2e6844(0x235)],_0x2ef672[_0x2e6844(0x235)]===SYSTEM_MODES[_0x2e6844(0x192)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x2ef672['ack'])this[_0x2e6844(0x27f)](_0x54a550,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x2ef672[_0x2e6844(0x150)]){_0x54a550[_0x2e6844(0x225)](_0x2e6844(0x198))&&_0x2ef672[_0x2e6844(0x235)]&&(this[_0x2e6844(0x27f)](_0x54a550,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x54a550[_0x2e6844(0x225)](_0x2e6844(0x157))&&_0x2ef672['val']){this[_0x2e6844(0x27f)](_0x54a550,{'val':![],'ack':!![]});if(this[_0x2e6844(0x265)])createDailyDigest(this);}_0x54a550[_0x2e6844(0x225)]('triggerBriefing')&&_0x2ef672[_0x2e6844(0x235)]&&(this[_0x2e6844(0x27f)](_0x54a550,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x54a550['includes'](_0x2e6844(0x1a7))&&_0x2ef672[_0x2e6844(0x235)]&&(this['setState'](_0x54a550,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x2e6844(0x20a)][_0x2e6844(0x1bc)]&&this[_0x2e6844(0x20a)]['presenceDevices'][_0x2e6844(0x225)](_0x54a550)){await checkWifiPresence(this);return;}const _0x177494=(this[_0x2e6844(0x20a)][_0x2e6844(0x272)]||[])[_0x2e6844(0x199)](_0x5f47b3=>_0x5f47b3['id']===_0x54a550);if(_0x177494)processSensorEvent(this,_0x54a550,_0x2ef672,_0x177494);}async[a0_0x2688fa(0x1cd)](_0x457954){const _0x3f5057=a0_0x2688fa;if(typeof _0x457954==='object'&&_0x457954[_0x3f5057(0x26b)])try{if(_0x457954[_0x3f5057(0x1e2)]==='testApiKey'){}else{if(_0x457954['command']==='testNotification'){}else{if(_0x457954[_0x3f5057(0x1e2)]===_0x3f5057(0x215)){if(!this[_0x3f5057(0x265)])return this['sendTo'](_0x457954[_0x3f5057(0x1dd)],_0x457954[_0x3f5057(0x1e2)],{'success':![],'isPro':![]},_0x457954['callback']);let _0x2e3a94={'status':_0x3f5057(0x296),'details':'','lastCheck':0x0};try{_0x2e3a94[_0x3f5057(0x274)]=(await this[_0x3f5057(0x1fb)](LTM_DP_DRIFT_STATUS))[_0x3f5057(0x235)],_0x2e3a94['details']=(await this[_0x3f5057(0x1fb)](LTM_DP_DRIFT_DETAILS))[_0x3f5057(0x235)],_0x2e3a94['lastCheck']=(await this[_0x3f5057(0x1fb)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x48ed78){}const _0x5aad71=this[_0x3f5057(0x14c)]||[];this[_0x3f5057(0x13b)](_0x457954[_0x3f5057(0x1dd)],_0x457954[_0x3f5057(0x1e2)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x3f5057(0x269)],'driftAnalysis':_0x2e3a94,'analysisHistory':_0x5aad71},_0x457954[_0x3f5057(0x24c)]);}else{if(_0x457954[_0x3f5057(0x1e2)]===_0x3f5057(0x1ec)){const _0x3793c7=this[_0x3f5057(0x269)]['length'],_0x3a0209=new Date(),_0x469014=new Date(_0x3a0209[_0x3f5057(0x1a5)](),_0x3a0209[_0x3f5057(0x1c9)](),_0x3a0209['getDate']())['getTime'](),_0x574687=this['rawEventLog']['filter'](_0x3882cf=>new Date(_0x3882cf['timestamp'])[_0x3f5057(0x219)]()>_0x469014)[_0x3f5057(0x1f5)],_0x433f77=new Array(0x18)[_0x3f5057(0x23b)](0x0);this[_0x3f5057(0x12c)]['forEach'](_0x2777f5=>{const _0x458b1a=_0x3f5057,_0x5d7c18=new Date(_0x2777f5[_0x458b1a(0x15c)]);_0x5d7c18[_0x458b1a(0x219)]()>_0x469014&&_0x433f77[_0x5d7c18[_0x458b1a(0x29f)]()]++;});let _0x5824db={'status':'N/A'};try{_0x5824db[_0x3f5057(0x274)]=(await this[_0x3f5057(0x1fb)](LTM_DP_DRIFT_STATUS))[_0x3f5057(0x235)];}catch(_0x55fb0e){}let _0x5e4bb8='';try{const _0x365596=await this[_0x3f5057(0x1fb)](_0x3f5057(0x299));_0x5e4bb8=_0x365596?_0x365596[_0x3f5057(0x235)]:'';}catch(_0x34d886){}let _0x14b31c=null;!this[_0x3f5057(0x155)]&&(_0x14b31c=this[_0x3f5057(0x20a)]['geminiApiKey']?_0x3f5057(0x1b0):_0x3f5057(0x286));let _0x4abb65={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x424dce=await this['getStateAsync'](_0x3f5057(0x1b6)),_0x539a6e=await this['getStateAsync'](_0x3f5057(0x1e0)),_0x10934b=await this[_0x3f5057(0x1fb)](_0x3f5057(0x1a1)),_0x1ac25a=await this[_0x3f5057(0x1fb)]('analysis.automation.targetValue'),_0x20c5b0=await this[_0x3f5057(0x1fb)]('analysis.automation.autoApply');_0x424dce&&_0x424dce[_0x3f5057(0x235)]&&(_0x4abb65[_0x3f5057(0x1f2)]=!![],_0x4abb65[_0x3f5057(0x1a0)]=_0x539a6e?_0x539a6e[_0x3f5057(0x235)]:'',_0x4abb65[_0x3f5057(0x194)]=_0x10934b?_0x10934b[_0x3f5057(0x235)]:'',_0x4abb65['targetValue']=_0x1ac25a?_0x1ac25a[_0x3f5057(0x235)]:''),_0x4abb65[_0x3f5057(0x159)]=_0x20c5b0?!!_0x20c5b0[_0x3f5057(0x235)]:![];}catch(_0x197b7c){}this[_0x3f5057(0x13b)](_0x457954[_0x3f5057(0x1dd)],_0x457954[_0x3f5057(0x1e2)],{'success':!![],'eventHistory':this[_0x3f5057(0x28b)][_0x3f5057(0x1fa)](0x0,0xf),'stats':{'digestCount':_0x3793c7,'eventCountToday':_0x574687,'hourlyActivity':_0x433f77,'driftStatus':_0x5824db[_0x3f5057(0x274)],'isPresent':this[_0x3f5057(0x12d)],'presenceWho':_0x5e4bb8,'minDays':this[_0x3f5057(0x20a)][_0x3f5057(0x20e)]||0x7,'stbDays':this[_0x3f5057(0x20a)][_0x3f5057(0x26f)]||0xe,'ltbDays':this[_0x3f5057(0x20a)]['ltmLtbWindowDays']||0x3c,'systemError':_0x14b31c},'automation':_0x4abb65},_0x457954[_0x3f5057(0x24c)]);}else{if(_0x457954[_0x3f5057(0x1e2)]===_0x3f5057(0x17a)){const _0x52f932=await this['getForeignObjectsAsync'](_0x3f5057(0x1e3),'enum'),_0x3ba142=[];if(_0x52f932)for(const _0x174a25 in _0x52f932){const _0x5b8389=_0x52f932[_0x174a25],_0x4aec69=(_0x5b8389[_0x3f5057(0x21a)]&&typeof _0x5b8389[_0x3f5057(0x21a)][_0x3f5057(0x27d)]==='object'?_0x5b8389[_0x3f5057(0x21a)]['name']['de']:_0x5b8389['common'][_0x3f5057(0x27d)])||_0x5b8389[_0x3f5057(0x21a)][_0x3f5057(0x27d)];_0x3ba142[_0x3f5057(0x161)]({'id':_0x174a25,'name':_0x4aec69});}this[_0x3f5057(0x13b)](_0x457954[_0x3f5057(0x1dd)],_0x457954[_0x3f5057(0x1e2)],{'success':!![],'enums':_0x3ba142},_0x457954[_0x3f5057(0x24c)]);}else{if(_0x457954[_0x3f5057(0x1e2)]===_0x3f5057(0x220))try{const _0x21379d=await scanForDevices(this,_0x457954[_0x3f5057(0x26b)]||{});this['sendTo'](_0x457954[_0x3f5057(0x1dd)],_0x457954[_0x3f5057(0x1e2)],{'success':!![],'devices':_0x21379d},_0x457954[_0x3f5057(0x24c)]);}catch(_0x1746d6){this[_0x3f5057(0x13b)](_0x457954[_0x3f5057(0x1dd)],_0x457954[_0x3f5057(0x1e2)],{'success':![],'error':_0x1746d6[_0x3f5057(0x26b)]},_0x457954[_0x3f5057(0x24c)]);}else{if(_0x457954[_0x3f5057(0x1e2)]==='getCalendarNames'){}else{if(_0x457954[_0x3f5057(0x1e2)]===_0x3f5057(0x255)){}else{if(_0x457954[_0x3f5057(0x1e2)]===_0x3f5057(0x2b2)){}else _0x457954[_0x3f5057(0x1e2)]===_0x3f5057(0x259)&&(this[_0x3f5057(0x15e)]['info'](_0x3f5057(0x29e)),await this[_0x3f5057(0x1b1)](_0x3f5057(0x1b6),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x3f5057(0x1e0),{'val':'','ack':!![]}),this[_0x3f5057(0x13b)](_0x457954['from'],_0x457954[_0x3f5057(0x1e2)],{'success':!![]},_0x457954[_0x3f5057(0x24c)]));}}}}}}}}}catch(_0x5e663b){}}}async function initZombies(_0x17b0bd){}async function initHistory(_0x57fce4){const _0x342b4f=a0_0x2688fa;try{const _0x179ad3=await _0x57fce4[_0x342b4f(0x1fb)](_0x342b4f(0x2a0));_0x179ad3&&_0x179ad3[_0x342b4f(0x235)]&&(_0x57fce4[_0x342b4f(0x28b)]=JSON[_0x342b4f(0x20d)](_0x179ad3['val'][_0x342b4f(0x1bd)]()));}catch(_0x5b23d5){_0x57fce4[_0x342b4f(0x28b)]=[];}try{const _0x81b28e=await _0x57fce4[_0x342b4f(0x1fb)]('analysis.analysisHistory');if(_0x81b28e&&_0x81b28e[_0x342b4f(0x235)])_0x57fce4[_0x342b4f(0x14c)]=JSON['parse'](_0x81b28e[_0x342b4f(0x235)][_0x342b4f(0x1bd)]());}catch(_0x1bd2fe){_0x57fce4[_0x342b4f(0x14c)]=[];}}async function initSystemConfig(_0x104819){const _0x4f3a72=a0_0x2688fa;try{const _0x3fd1c5=await _0x104819[_0x4f3a72(0x171)](_0x4f3a72(0x1b7));_0x3fd1c5&&_0x3fd1c5[_0x4f3a72(0x21a)]&&(_0x104819['systemConfig']={'latitude':_0x3fd1c5['common']['latitude']||0x0,'longitude':_0x3fd1c5['common'][_0x4f3a72(0x25e)]||0x0,'city':_0x3fd1c5[_0x4f3a72(0x21a)]['city']||''});}catch(_0x5633be){}}async function checkLicense(_0x2f8a6d,_0x33e9cf){const _0x551d01=a0_0x2688fa;if(!_0x33e9cf)return![];_0x2f8a6d[_0x551d01(0x1f1)]=await getSystemUUID(_0x2f8a6d);if(_0x33e9cf===_0x551d01(0x268)||_0x33e9cf['startsWith'](_0x551d01(0x176)))return!![];return![];}async function getSystemUUID(_0x125903){const _0x1123ff=a0_0x2688fa;try{const _0x45fcbf=await _0x125903[_0x1123ff(0x171)]('system.meta.uuid');if(_0x45fcbf&&_0x45fcbf[_0x1123ff(0x212)]&&_0x45fcbf['native'][_0x1123ff(0x279)])return _0x45fcbf['native'][_0x1123ff(0x279)];return _0x1123ff(0x257);}catch(_0x37bae7){return _0x1123ff(0x14b);}}async function createAllObjects(_0x578472){const _0x110bd4=a0_0x2688fa;await checkSystemObjects(_0x578472),await _0x578472[_0x110bd4(0x284)]('system.presenceWho',{'type':_0x110bd4(0x25d),'common':{'name':'Who\x20is\x20present?','type':'string','role':_0x110bd4(0x28a),'read':!![],'write':![],'def':''},'native':{}}),await _0x578472['setObjectNotExistsAsync'](_0x110bd4(0x26c),{'type':'state','common':{'name':'Last\x20raw\x20event','type':_0x110bd4(0x2a6),'role':_0x110bd4(0x1ff),'read':!![],'write':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x2a0),{'type':'state','common':{'name':_0x110bd4(0x2a2),'type':_0x110bd4(0x2a6),'role':_0x110bd4(0x1ff),'read':!![],'write':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x198),{'type':'state','common':{'name':_0x110bd4(0x24b),'type':_0x110bd4(0x27a),'role':_0x110bd4(0x17d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x1e7),{'type':'state','common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x110bd4(0x27a),'role':_0x110bd4(0x17d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x208),{'type':_0x110bd4(0x25d),'common':{'name':'Last\x20Result','type':_0x110bd4(0x2a6),'role':'json','read':!![],'write':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x189),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x202),'type':_0x110bd4(0x27a),'role':_0x110bd4(0x233),'read':!![],'write':![],'def':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x1c7),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x239),'type':_0x110bd4(0x27a),'role':_0x110bd4(0x1b3),'read':!![],'write':![],'def':![]},'native':{}}),await _0x578472['setObjectNotExistsAsync'](_0x110bd4(0x19c),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x1d7),'type':_0x110bd4(0x2a6),'role':_0x110bd4(0x187),'read':!![],'write':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x260),{'type':_0x110bd4(0x25d),'common':{'name':'Activity\x20Summary','type':_0x110bd4(0x2a6),'role':_0x110bd4(0x28a),'read':!![],'write':![]},'native':{}}),await _0x578472['setObjectNotExistsAsync'](_0x110bd4(0x2b3),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x2b1),'type':_0x110bd4(0x2a6),'role':_0x110bd4(0x25d),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x578472['setObjectNotExistsAsync']('analysis.comfortSummary',{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x160),'type':_0x110bd4(0x2a6),'role':_0x110bd4(0x28a),'read':!![],'write':![]},'native':{}}),await _0x578472['setObjectNotExistsAsync'](_0x110bd4(0x1cf),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x151),'type':_0x110bd4(0x2a6),'role':_0x110bd4(0x28a),'read':!![],'write':![]},'native':{}}),await _0x578472[_0x110bd4(0x237)](_0x110bd4(0x1ae),{'type':_0x110bd4(0x2b5),'common':{'name':_0x110bd4(0x254)},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x1b6),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x127),'type':_0x110bd4(0x27a),'role':_0x110bd4(0x167),'read':!![],'write':![],'def':![]},'native':{}}),await _0x578472['setObjectNotExistsAsync'](_0x110bd4(0x1e0),{'type':'state','common':{'name':_0x110bd4(0x231),'type':_0x110bd4(0x2a6),'role':_0x110bd4(0x28a),'read':!![],'write':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x13c),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x22f),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x578472['setObjectNotExistsAsync'](_0x110bd4(0x1a1),{'type':'state','common':{'name':_0x110bd4(0x16b),'type':_0x110bd4(0x2a6),'role':'text','read':!![],'write':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x188),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x20c),'type':_0x110bd4(0x2a6),'role':_0x110bd4(0x28a),'read':!![],'write':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)]('analysis.automation.autoApply',{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x1c4),'type':_0x110bd4(0x27a),'role':_0x110bd4(0x22e),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x578472[_0x110bd4(0x284)]('analysis.automation.triggerAction',{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x263),'type':_0x110bd4(0x27a),'role':_0x110bd4(0x17d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x578472['setObjectNotExistsAsync'](_0x110bd4(0x23f),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x147),'type':'string','role':_0x110bd4(0x1ff),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x578472[_0x110bd4(0x284)]('analysis.feedbackHistory',{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x1b4),'type':_0x110bd4(0x2a6),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x578472['extendObjectAsync']('analysis.health',{'type':_0x110bd4(0x2b5),'common':{'name':_0x110bd4(0x244)},'native':{}}),await _0x578472['setObjectNotExistsAsync'](_0x110bd4(0x28e),{'type':_0x110bd4(0x25d),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x110bd4(0x14d),'role':_0x110bd4(0x174),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x578472[_0x110bd4(0x284)](_0x110bd4(0x164),{'type':_0x110bd4(0x25d),'common':{'name':_0x110bd4(0x1f7),'type':_0x110bd4(0x2a6),'role':_0x110bd4(0x28a),'read':!![],'write':![],'def':_0x110bd4(0x1d4)},'native':{}}),await _0x578472['setObjectNotExistsAsync']('analysis.health.notes',{'type':_0x110bd4(0x25d),'common':{'name':'Health\x20Notes','type':_0x110bd4(0x2a6),'role':_0x110bd4(0x28a),'read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x578472),await checkLtmDriftObjects(_0x578472);}async function checkSystemObjects(_0x2a3383){const _0x5025c3=a0_0x2688fa;await _0x2a3383[_0x5025c3(0x237)]('system',{'type':_0x5025c3(0x2b5),'common':{'name':_0x5025c3(0x1e9)},'native':{}}),await _0x2a3383['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x5025c3(0x25d),'common':{'name':_0x5025c3(0x28c),'type':_0x5025c3(0x2a6),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x5025c3(0x179)],'states':{[SYSTEM_MODES[_0x5025c3(0x179)]]:'Normal',[SYSTEM_MODES[_0x5025c3(0x192)]]:_0x5025c3(0x165),[SYSTEM_MODES['PARTY']]:_0x5025c3(0x13f),[SYSTEM_MODES[_0x5025c3(0x16e)]]:_0x5025c3(0x280)}},'native':{}});}async function checkLtmObjects(_0x485bc6){const _0xeac90d=a0_0x2688fa;await _0x485bc6[_0xeac90d(0x237)](_0xeac90d(0x20b),{'type':'channel','common':{'name':_0xeac90d(0x20b)},'native':{}}),await _0x485bc6[_0xeac90d(0x237)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0xeac90d(0x24f),'type':_0xeac90d(0x2a6),'role':_0xeac90d(0x1ff),'read':!![],'write':![]},'native':{}}),await _0x485bc6['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0xeac90d(0x25d),'common':{'name':_0xeac90d(0x24a),'type':'string','role':_0xeac90d(0x1ff),'read':!![],'write':![]},'native':{}}),await _0x485bc6[_0xeac90d(0x237)](LTM_DP_STATUS,{'type':'state','common':{'name':_0xeac90d(0x1ba),'type':'string','role':_0xeac90d(0x28a),'read':!![],'write':![]},'native':{}}),await _0x485bc6['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':'Trigger\x20Digest','type':_0xeac90d(0x27a),'role':_0xeac90d(0x17d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x485bc6[_0xeac90d(0x237)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':'Baseline\x20Status','type':_0xeac90d(0x2a6),'role':_0xeac90d(0x28a),'read':!![],'write':![]},'native':{}});}function a0_0x497e(_0x2e4252,_0x40eecd){const _0x2ddef3=a0_0x3d7a();return a0_0x497e=function(_0x1fa229,_0x5d221c){_0x1fa229=_0x1fa229-0x122;let _0x3d7ad5=_0x2ddef3[_0x1fa229];return _0x3d7ad5;},a0_0x497e(_0x2e4252,_0x40eecd);}async function checkLtmDriftObjects(_0x3792f2){const _0x1d5f6f=a0_0x2688fa;await _0x3792f2[_0x1d5f6f(0x237)](LTM_DP_DRIFT_CHANNEL,{'type':_0x1d5f6f(0x2b5),'common':{'name':_0x1d5f6f(0x129)},'native':{}}),await _0x3792f2[_0x1d5f6f(0x237)](LTM_DP_DRIFT_STATUS,{'type':_0x1d5f6f(0x25d),'common':{'name':'Drift\x20Status','type':'string','role':_0x1d5f6f(0x25d),'read':!![],'write':![],'def':_0x1d5f6f(0x296)},'native':{}}),await _0x3792f2[_0x1d5f6f(0x237)](LTM_DP_DRIFT_DETAILS,{'type':_0x1d5f6f(0x25d),'common':{'name':_0x1d5f6f(0x1d3),'type':'string','role':_0x1d5f6f(0x28a),'read':!![],'write':![]},'native':{}}),await _0x3792f2['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x1d5f6f(0x25d),'common':{'name':_0x1d5f6f(0x22b),'type':_0x1d5f6f(0x14d),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x3851c8){const _0x34e5d6=a0_0x2688fa;try{const _0x3f3a36=await _0x3851c8[_0x34e5d6(0x1fb)](SYSTEM_DP_MODE);_0x3f3a36&&_0x3f3a36[_0x34e5d6(0x235)]&&Object[_0x34e5d6(0x232)](SYSTEM_MODES)[_0x34e5d6(0x225)](_0x3f3a36['val'])?_0x3851c8['currentSystemMode']=_0x3f3a36[_0x34e5d6(0x235)]:(_0x3851c8[_0x34e5d6(0x16f)]=SYSTEM_MODES['NORMAL'],await _0x3851c8['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x5e9f79){_0x3851c8[_0x34e5d6(0x16f)]=SYSTEM_MODES[_0x34e5d6(0x179)];}}async function loadRawEventLog(_0x42d3f3){const _0x4a9922=a0_0x2688fa;try{const _0x109f22=await _0x42d3f3[_0x4a9922(0x1fb)](LTM_DP_RAW_LOG);if(_0x109f22&&_0x109f22[_0x4a9922(0x235)])_0x42d3f3[_0x4a9922(0x12c)]=JSON[_0x4a9922(0x20d)](_0x109f22[_0x4a9922(0x235)]);}catch(_0x1c6e06){_0x42d3f3[_0x4a9922(0x12c)]=[];}}async function saveRawEventLog(_0xcc2a50){const _0x26476c=a0_0x2688fa;_0xcc2a50['rawEventLog'][_0x26476c(0x1f5)]>RAW_LOG_MAX_SIZE&&_0xcc2a50['rawEventLog']['splice'](0x0,_0xcc2a50[_0x26476c(0x12c)][_0x26476c(0x1f5)]-RAW_LOG_MAX_SIZE),await _0xcc2a50['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x26476c(0x15d)](_0xcc2a50[_0x26476c(0x12c)]),'ack':!![]});}async function saveDailyDigests(_0x303094,_0x362072=!![]){const _0x117bb8=a0_0x2688fa,_0x1355f8=_0x303094['config'][_0x117bb8(0x1db)]||0x3c;_0x303094[_0x117bb8(0x269)][_0x117bb8(0x1f5)]>_0x1355f8&&_0x303094[_0x117bb8(0x269)][_0x117bb8(0x281)](0x0,_0x303094[_0x117bb8(0x269)][_0x117bb8(0x1f5)]-_0x1355f8);await _0x303094[_0x117bb8(0x1b1)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x117bb8(0x15d)](_0x303094['dailyDigests']),'ack':!![]});if(_0x362072)await updateBaselineStatus(_0x303094);}async function updateAnalysisHistory(_0x55c104,_0x29b0fe){const _0x3cb2ca=a0_0x2688fa;_0x55c104[_0x3cb2ca(0x14c)][_0x3cb2ca(0x1fc)](_0x29b0fe);if(_0x55c104[_0x3cb2ca(0x14c)][_0x3cb2ca(0x1f5)]>ANALYSIS_HISTORY_MAX_SIZE)_0x55c104[_0x3cb2ca(0x14c)][_0x3cb2ca(0x12f)]();await _0x55c104[_0x3cb2ca(0x1b1)](_0x3cb2ca(0x23f),{'val':JSON[_0x3cb2ca(0x15d)](_0x55c104['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x11e5ca){const _0x31b8e2=a0_0x2688fa;if(!_0x11e5ca[_0x31b8e2(0x265)]){await _0x11e5ca[_0x31b8e2(0x1b1)](LTM_DP_BASELINE_STATUS,{'val':_0x31b8e2(0x19b),'ack':!![]});return;}const _0x683543=_0x11e5ca[_0x31b8e2(0x269)][_0x31b8e2(0x1f5)]>=(_0x11e5ca[_0x31b8e2(0x20a)][_0x31b8e2(0x20e)]||0x7)?'Aktiv\x20('+_0x11e5ca[_0x31b8e2(0x269)][_0x31b8e2(0x1f5)]+_0x31b8e2(0x1cc):_0x31b8e2(0x1d1)+_0x11e5ca[_0x31b8e2(0x269)][_0x31b8e2(0x1f5)]+'/'+(_0x11e5ca[_0x31b8e2(0x20a)][_0x31b8e2(0x20e)]||0x7)+')';await _0x11e5ca[_0x31b8e2(0x1b1)](LTM_DP_BASELINE_STATUS,{'val':_0x683543,'ack':!![]});}async function initSensorSubscriptions(_0x518e88){const _0x287c2c=a0_0x2688fa,_0xecbbea=_0x518e88[_0x287c2c(0x20a)][_0x287c2c(0x272)];if(_0xecbbea&&_0xecbbea[_0x287c2c(0x1f5)]>0x0){_0x518e88['log']['info']('Subscribing\x20to\x20'+_0xecbbea[_0x287c2c(0x1f5)]+_0x287c2c(0x252));for(const _0x32c958 of _0xecbbea){if(_0x32c958['id']){await _0x518e88[_0x287c2c(0x12a)](_0x32c958['id']);try{const _0x365eb0=await _0x518e88['getForeignStateAsync'](_0x32c958['id']);if(_0x365eb0)_0x518e88[_0x287c2c(0x21e)][_0x32c958['id']]=_0x365eb0[_0x287c2c(0x235)];}catch(_0x2a6589){}}}}}async function initPresenceSubscriptions(_0x5507e2){const _0x2100e0=a0_0x2688fa,_0x291414=_0x5507e2[_0x2100e0(0x20a)][_0x2100e0(0x1bc)]||[];if(_0x291414['length']>0x0){_0x5507e2[_0x2100e0(0x15e)][_0x2100e0(0x1eb)]('Subscribing\x20to\x20'+_0x291414[_0x2100e0(0x1f5)]+'\x20presence\x20devices...');for(const _0x369537 of _0x291414){await _0x5507e2[_0x2100e0(0x12a)](_0x369537);}try{await checkWifiPresence(_0x5507e2);}catch(_0x17951a){}}}async function getWeatherContext(_0x4b0266){const _0x34ba18=a0_0x2688fa;try{if(!_0x4b0266[_0x34ba18(0x20a)]['useWeather'])return _0x34ba18(0x146);let _0xc4a1a7='';const _0x3075b1=_0x4b0266[_0x34ba18(0x20a)][_0x34ba18(0x1a9)];if(_0x3075b1)try{if(_0x3075b1[_0x34ba18(0x225)](_0x34ba18(0x264))){const _0xf42f01=await _0x4b0266['getForeignStateAsync'](_0x3075b1+_0x34ba18(0x24e));if(_0xf42f01&&_0xf42f01[_0x34ba18(0x235)])_0xc4a1a7=_0xf42f01[_0x34ba18(0x235)];}else{if(_0x3075b1[_0x34ba18(0x225)](_0x34ba18(0x2a9))){const _0x18d736=await _0x4b0266[_0x34ba18(0x135)](_0x3075b1+_0x34ba18(0x181));if(_0x18d736&&_0x18d736[_0x34ba18(0x235)])_0xc4a1a7=_0x18d736['val'];}else{if(_0x3075b1['includes'](_0x34ba18(0x178))){const _0x1c85e1=await _0x4b0266[_0x34ba18(0x135)](_0x3075b1+_0x34ba18(0x124));if(_0x1c85e1&&_0x1c85e1[_0x34ba18(0x235)])_0xc4a1a7=_0x1c85e1[_0x34ba18(0x235)];}}}}catch(_0x3903bc){}if(!_0xc4a1a7){const _0x281e1b=[_0x34ba18(0x185),'daswetter.0',_0x34ba18(0x2a7),'openweathermap.0'];for(const _0x2a0553 of _0x281e1b){try{const _0x46cd46=await _0x4b0266[_0x34ba18(0x171)](_0x2a0553);if(_0x46cd46){if(_0x2a0553[_0x34ba18(0x225)](_0x34ba18(0x264))){const _0x3c87e4=await _0x4b0266['getForeignStateAsync'](_0x2a0553+_0x34ba18(0x24e));if(_0x3c87e4&&_0x3c87e4[_0x34ba18(0x235)]){_0xc4a1a7=_0x3c87e4[_0x34ba18(0x235)];break;}}}}catch(_0x2b19c2){}}}return _0xc4a1a7?'WETTER:\x20'+_0xc4a1a7:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x5d650f){return _0x34ba18(0x156)+_0x5d650f[_0x34ba18(0x26b)];}}async function getCalendarContext(_0x3d3bd0){const _0x3f0632=a0_0x2688fa;try{if(!_0x3d3bd0['config']['useCalendar'])return _0x3f0632(0x14a);let _0x25212c=_0x3d3bd0['config'][_0x3f0632(0x222)]||_0x3f0632(0x183),_0x3bec0e=_0x3d3bd0[_0x3f0632(0x20a)][_0x3f0632(0x1a8)]||[];if(typeof _0x3bec0e===_0x3f0632(0x2a6))_0x3bec0e=_0x3bec0e[_0x3f0632(0x2a5)](',');try{const _0x27f9ef=await _0x3d3bd0['getForeignStateAsync'](_0x25212c+'.data.table');if(_0x27f9ef&&_0x27f9ef[_0x3f0632(0x235)]){let _0x69c7a2=tryParse(_0x27f9ef['val']);if(_0x69c7a2&&Array['isArray'](_0x69c7a2)){if(_0x3bec0e[_0x3f0632(0x1f5)]>0x0)_0x69c7a2=_0x69c7a2[_0x3f0632(0x1f9)](_0x4ee4d4=>_0x3bec0e[_0x3f0632(0x225)](_0x4ee4d4[_0x3f0632(0x1bb)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x69c7a2[_0x3f0632(0x1f5)]>0x0){const _0x368a10=_0x69c7a2[_0x3f0632(0x1fa)](0x0,0x3)[_0x3f0632(0x209)](_0x542b66=>{const _0x2405f9=_0x3f0632;let _0x56ef33=_0x542b66[_0x2405f9(0x2aa)];if(_0x542b66[_0x2405f9(0x270)])_0x56ef33+='\x20'+_0x542b66[_0x2405f9(0x270)];return _0x56ef33+':\x20'+_0x542b66[_0x2405f9(0x200)]+'\x20('+_0x542b66[_0x2405f9(0x1bb)]+')';});return _0x3f0632(0x201)+_0x368a10[_0x3f0632(0x145)](_0x3f0632(0x21f));}else return _0x3f0632(0x21d);}}}catch(_0x2f2d33){_0x3d3bd0[_0x3f0632(0x15e)][_0x3f0632(0x19a)](_0x3f0632(0x1de)+_0x2f2d33['message']);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x1eecc7){return _0x3f0632(0x211)+_0x1eecc7[_0x3f0632(0x26b)];}}async function getCalendarNames(_0x276f0f,_0x3e33a7){const _0x275e69=a0_0x2688fa;try{const _0x2e4329=await _0x276f0f[_0x275e69(0x135)](_0x3e33a7+_0x275e69(0x1b9));if(_0x2e4329&&_0x2e4329[_0x275e69(0x235)]){const _0x3d7a5d=tryParse(_0x2e4329[_0x275e69(0x235)]);if(_0x3d7a5d&&Array[_0x275e69(0x13a)](_0x3d7a5d)){const _0x2138c3=[...new Set(_0x3d7a5d[_0x275e69(0x209)](_0x36770c=>_0x36770c[_0x275e69(0x1bb)])[_0x275e69(0x1f9)](Boolean))];return _0x2138c3[_0x275e69(0x19e)]();}}return[];}catch(_0x4d35bc){return _0x276f0f[_0x275e69(0x15e)][_0x275e69(0x1e6)](_0x275e69(0x229)+_0x4d35bc[_0x275e69(0x26b)]),[];}}async function checkWifiPresence(_0x519752){const _0x530540=a0_0x2688fa;try{const _0x40f06e=_0x519752[_0x530540(0x20a)][_0x530540(0x1bc)]||[];let _0x2fb2a0=![];const _0x1d2922=[];for(const _0x186766 of _0x40f06e){try{const _0x56ba2a=await _0x519752['getForeignStateAsync'](_0x186766);if(_0x56ba2a&&(_0x56ba2a['val']===!![]||_0x56ba2a['val']===_0x530540(0x14f)||_0x56ba2a[_0x530540(0x235)]===0x1)){_0x2fb2a0=!![];const _0x2308e1=await _0x519752['getForeignObjectAsync'](_0x186766);let _0x110281=_0x186766;_0x2308e1&&_0x2308e1['common']&&_0x2308e1[_0x530540(0x21a)][_0x530540(0x27d)]&&(_0x110281=typeof _0x2308e1[_0x530540(0x21a)]['name']===_0x530540(0x275)?_0x2308e1['common']['name']['de']||_0x2308e1[_0x530540(0x21a)][_0x530540(0x27d)]['en']:_0x2308e1[_0x530540(0x21a)][_0x530540(0x27d)]),_0x1d2922[_0x530540(0x161)](_0x110281);}}catch(_0x573259){}}return await _0x519752[_0x530540(0x1b1)](_0x530540(0x299),{'val':_0x1d2922[_0x530540(0x145)](',\x20'),'ack':!![]}),_0x2fb2a0&&(_0x519752[_0x530540(0x23a)]&&(_0x519752[_0x530540(0x15e)]['info'](_0x530540(0x144)),abortExitTimer(_0x519752)),!_0x519752[_0x530540(0x12d)]&&_0x519752[_0x530540(0x16f)]===SYSTEM_MODES[_0x530540(0x179)]&&await setPresence(_0x519752,!![])),_0x2fb2a0;}catch(_0x4ccc34){return _0x519752['log'][_0x530540(0x1e6)](_0x530540(0x1d0)+_0x4ccc34['message']),![];}}function startExitTimer(_0x130fb5){const _0x446612=a0_0x2688fa;abortExitTimer(_0x130fb5),_0x130fb5[_0x446612(0x277)]=!![],_0x130fb5[_0x446612(0x1e4)]=setTimeout(()=>{const _0x4ad995=_0x446612;_0x130fb5[_0x4ad995(0x277)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x130fb5[_0x446612(0x23a)]=setTimeout(()=>{const _0x1737c5=_0x446612;setPresence(_0x130fb5,![]),_0x130fb5[_0x1737c5(0x23a)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x5b9a2a){const _0x150174=a0_0x2688fa;if(_0x5b9a2a[_0x150174(0x23a)])clearTimeout(_0x5b9a2a['exitTimer']);if(_0x5b9a2a[_0x150174(0x1e4)])clearTimeout(_0x5b9a2a['exitGraceTimer']);_0x5b9a2a['exitTimer']=null,_0x5b9a2a[_0x150174(0x1e4)]=null,_0x5b9a2a['isGracePeriodActive']=![];}async function setPresence(_0x263734,_0x1453f7){const _0x31502f=a0_0x2688fa;if(_0x263734['isPresent']===_0x1453f7)return;_0x263734[_0x31502f(0x12d)]=_0x1453f7,await _0x263734[_0x31502f(0x1b1)](_0x31502f(0x132),{'val':_0x1453f7,'ack':!![]});}function a0_0x3d7a(){const _0x18ea5a=['application/json','\x20Tage)','onMessage','.communicate.request','analysis.comfortSuggestion','Error\x20checking\x20WiFi:\x20','Lernphase\x20(','ltmDriftCheckIntervalHours','Drift\x20Details','none','selectedFunctionIds','working','Alert\x20Reason','41573tsiBPA','geminiApiKey','toLocaleString','ltmLtbWindowDays','notifyPushoverInstance','from','Error\x20reading\x20calendar\x20table:\x20','energy','analysis.automation.description','response','command','enum.functions.*','exitGraceTimer','PRIORITÃ„T:\x20Gesundheit/AAL.','error','analysis.triggerBriefing','fault','System\x20Status\x20&\x20Control','flot.','info','getOverviewData','lampe','0\x204\x20*\x20*\x20*','notifyEmailRecipient','LTM.triggerDailyDigest','systemUUID','detected','1711845OwfBVK','PRIORITÃ„T:\x20Sicherheit.','length','toISOString','Restlessness\x20Level','heizung','filter','slice','getStateAsync','unshift','shutter','set_temperature','json','event','KALENDER:\x20','AI\x20Alert\x20Status','toFixed','inactivityMonitoringEnabled','indexOf','notifyEmailEnabled','analysis.automation.triggerAction','analysis.lastResult','map','config','LTM','Target\x20Value','parse','minDaysForBaseline','Cogni-Living','window','KALENDER\x20ERROR:\x20','native','stateChange','driftAnalysisTimer','getLtmData','party','subscribeStates','[TEST]\x20','getTime','common','generateContent','cogni-living\x20adapter\x20starting\x20(v','KALENDER:\x20Keine\x20relevanten\x20Termine','sensorLastValues','\x20|\x20','scanDevices','analysisTimer','calendarInstance','send','dutycycle','includes','licenseKey','4565853zfaOaE','write','getCalendarNames\x20Error:\x20','maintenance','Last\x20Check','temp','briefingJob','switch','Action','info.','Description','values','indicator.alarm','members','val','vacation','extendObjectAsync','sound','AI\x20Emergency\x20Status','exitTimer','fill','Success:\x20Compressed\x20','occupancy','guest','analysis.analysisHistory','scriptProblem','notifyPushoverRecipient','LTM.dailyDigests','light','Health\x20&\x20Sleep\x20Analysis','bewegung','admin.','value','Drift\x20Sched\x20Error:\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','Daily\x20Digests','Trigger\x20Analysis','callback','feedbackHistory','.Summary.Current','Raw\x20Log','material.','replace','\x20sensors...','now','Automation\x20Proposals','simulateButler','100BhWugF','uuid-not-found','toLowerCase','dismissAutomation','Error:\x20','sleepScore','setpoint','state','longitude','notifyPushoverEnabled','analysis.activitySummary','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','ðŸŒ…\x20Daily\x20Briefing:\x0a','Trigger\x20Action\x20Now','accuweather','isProVersion','firmware','\x20hours.\x20Potential\x20incapacitation.','TEST-PRO-KEY','dailyDigests','scheduleJob','message','events.lastEvent','expire','.\x20DATEN:\x20Schlaf\x20','ltmStbWindowDays','time','Briefing\x20Sched\x20Error:\x20','devices','echarts.','status','object','\x0aSTB:\x20','isGracePeriodActive','trim','uuid','boolean','simple-api.','\x20events','name','8966peggfl','setState','Gast','splice','doors','generic','setObjectNotExistsAsync','direction','Kein\x20API\x20Key!','167GbMXdX','LTM.processingStatus','catch','text','eventHistory','System\x20Mode','bind','analysis.health.sleepScore','javascript.','activityLevel','1597453qfEmjM','weather','Feedback\x20saved:\x20','blind','496QfGQam','N/A','cogni-living','apply','system.presenceWho','modeResetJob','brightness','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','version','User\x20dismissed\x20automation\x20proposal.','getHours','events.history','prÃ¤senz','Event\x20History','ready','dimmer','split','string','weatherunderground.0','targetposition','daswetter','date','level','Briefing\x20Error:\x20','position','Morning\x20Briefing\x20sent.','COGNI_REQUEST_CALL','communicate.request','Deviation','submitFeedback','analysis.deviationFromBaseline','08:00','channel','Analysiere\x20ausgewogen.','forEach','briefingTime','Fokus\x20auf\x20Familienroutinen.','.forecast.current.state','temperature','substring','Pattern\x20Detected','vis.','Drift\x20Analysis','subscribeForeignStatesAsync','onReady','rawEventLog','isPresent','LTM.driftAnalysis.driftDetails','pop','genAI','LTM.driftAnalysis.baselineDrift','system.isPresent','main','Skipped\x20(No\x20AI\x20or\x20Data)','getForeignStateAsync','sensor','off','(((.+)+)+)+$','motion','isArray','sendTo','analysis.automation.suggestedAction','getForeignObjectsAsync','LTM.rawEventLog','Party','16KiEQBv','\x20*\x20*\x20*','lastAlertState','health','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','join','Wetter:\x20Deaktiviert','Logbook','baselineDrift','.\x20KONTEXT:\x20','Kalender:\x20Deaktiviert','uuid-error','analysisHistory','number','Reset\x20Sched\x20Error:\x20','online','ack','Comfort\x20Suggestion','licht','briefingEnabled','Starting\x20Autopilot\x20(','geminiModel','WETTER\x20ERROR:\x20','triggerDailyDigest','\x20for\x20interactive\x20buttons...','autoApply','cancel','scriptEnabled','timestamp','stringify','log','fenster','Comfort\x20Summary','push','some','.\x20OUTPUT:\x20Nur\x20Text.','analysis.health.restlessness','Urlaub','link_quality','indicator','rssi','currentposition','lastIndexOf','Target\x20ID','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','sendToAsync','GUEST','currentSystemMode','valve','getForeignObjectAsync','endsWith','inactivityThresholdHours','value.health','144321vrVwqa','PRO-','systemConfig','openweathermap','NORMAL','getEnums','lights','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','button','lock','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','node-schedule','.NextHours.Location_1.Day_1.current.symbol_desc','system.','ical.0','aiPersona','accuweather.0','exports','text.alarm','analysis.automation.targetValue','analysis.isAlert','ðŸ“¡\x20Hooking\x20into\x20','search','history.','LTM.baselineStatus','telegram','power','config_pending','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','VACATION','3939792vvFceh','targetId','notifyTelegramInstance','humidity','custom','analysis.trigger','find','warn','Deaktiviert\x20(Pro-Feature)','analysis.alertReason','presence','sort','onUnload','description','analysis.automation.targetId','connection','notifyEmailInstance','summary','getFullYear','notifyTelegramEnabled','automation.triggerAction','calendarSelection','weatherInstance','LTM\x20Sched\x20Error:\x20','constructor','actual_temperature','_score','analysis.automation','door','KI-Modell\x20nicht\x20initialisiert','setStateAsync','getGenerativeModel','indicator.alarm.fire','Feedback\x20Log','ltmJob','analysis.automation.patternDetected','system.config','N/A\x20(Learning)','.data.table','Processing\x20Status','_calName','presenceDevices','toString','thermostat','system.mode','type','Adapter','lowbat','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Auto\x20Apply\x20Rule','0\x203\x20*\x20*\x20*','\x20min).','analysis.isEmergency','enum','getMonth','Sending\x20notification:\x20\x22'];a0_0x3d7a=function(){return _0x18ea5a;};return a0_0x3d7a();}async function saveFeedback(_0x1d8422,_0x1c7be1){const _0x10af5c=a0_0x2688fa;_0x1d8422[_0x10af5c(0x15e)][_0x10af5c(0x1eb)](_0x10af5c(0x293)+JSON[_0x10af5c(0x15d)](_0x1c7be1));}async function runBaselineDriftAnalysis(_0x206582){const _0x2bbb02=a0_0x2688fa;if(!_0x206582[_0x2bbb02(0x265)]||!_0x206582['geminiModel'])return;const _0x18edd9=_0x206582[_0x2bbb02(0x20a)][_0x2bbb02(0x26f)]||0xe;if(_0x206582[_0x2bbb02(0x269)][_0x2bbb02(0x1f5)]<_0x18edd9+(_0x206582['config'][_0x2bbb02(0x20e)]||0x7)){await _0x206582[_0x2bbb02(0x1b1)](LTM_DP_DRIFT_STATUS,{'val':_0x2bbb02(0x1b8),'ack':!![]});return;}const _0x5ae427=_0x206582['dailyDigests'][_0x2bbb02(0x1fa)](-_0x18edd9),_0x52080c=_0x206582['dailyDigests']['slice'](0x0,_0x206582['dailyDigests']['length']-_0x18edd9),_0x4e7f39=_0x2bbb02(0x1c3)+JSON['stringify'](_0x52080c)+_0x2bbb02(0x276)+JSON['stringify'](_0x5ae427);try{const _0xcfca0f=await _0x206582[_0x2bbb02(0x155)][_0x2bbb02(0x21b)](_0x4e7f39),_0x25d3a6=JSON[_0x2bbb02(0x20d)](_0xcfca0f[_0x2bbb02(0x1e1)][_0x2bbb02(0x28a)]()[_0x2bbb02(0x251)](/```json|```/g,'')[_0x2bbb02(0x278)]());_0x25d3a6[_0x2bbb02(0x148)]&&(await _0x206582[_0x2bbb02(0x1b1)](LTM_DP_DRIFT_STATUS,{'val':_0x25d3a6[_0x2bbb02(0x148)],'ack':!![]}),await _0x206582[_0x2bbb02(0x1b1)](LTM_DP_DRIFT_DETAILS,{'val':_0x25d3a6['driftDetails'],'ack':!![]}),await _0x206582[_0x2bbb02(0x1b1)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x2bbb02(0x253)](),'ack':!![]}));}catch(_0xded3ad){}}function setupLtmScheduler(_0x16ca2a){const _0x3cd2d4=a0_0x2688fa;try{if(_0x16ca2a[_0x3cd2d4(0x1b5)])_0x16ca2a[_0x3cd2d4(0x1b5)][_0x3cd2d4(0x15a)]();if(!_0x16ca2a['isProVersion']){_0x16ca2a[_0x3cd2d4(0x1b1)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x16ca2a['ltmJob']=schedule[_0x3cd2d4(0x26a)](LTM_SCHEDULE,()=>createDailyDigest(_0x16ca2a));}catch(_0x51d962){_0x16ca2a['log'][_0x3cd2d4(0x1e6)](_0x3cd2d4(0x1aa)+_0x51d962[_0x3cd2d4(0x26b)]);}}function setupModeResetScheduler(_0x490c9b){const _0x2afa8a=a0_0x2688fa;try{if(_0x490c9b[_0x2afa8a(0x29a)])_0x490c9b['modeResetJob'][_0x2afa8a(0x15a)]();_0x490c9b[_0x2afa8a(0x29a)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x51b728=_0x2afa8a;await loadSystemMode(_0x490c9b),AUTO_RESET_MODES[_0x51b728(0x225)](_0x490c9b[_0x51b728(0x16f)])&&await _0x490c9b[_0x51b728(0x1b1)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x4db521){_0x490c9b['log']['error'](_0x2afa8a(0x14e)+_0x4db521[_0x2afa8a(0x26b)]);}}function setupDriftAnalysisScheduler(_0x30365f){const _0x536aa2=a0_0x2688fa;try{if(_0x30365f[_0x536aa2(0x214)])clearInterval(_0x30365f[_0x536aa2(0x214)]);if(!_0x30365f['isProVersion'])return;_0x30365f['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x30365f),(_0x30365f[_0x536aa2(0x20a)][_0x536aa2(0x1d2)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x30365f),0x1388);}catch(_0x225c2b){_0x30365f['log']['error'](_0x536aa2(0x248)+_0x225c2b[_0x536aa2(0x26b)]);}}function setupBriefingScheduler(_0x379dcc){const _0xb8944c=a0_0x2688fa;try{if(_0x379dcc[_0xb8944c(0x22d)])_0x379dcc[_0xb8944c(0x22d)][_0xb8944c(0x15a)]();if(!_0x379dcc[_0xb8944c(0x20a)][_0xb8944c(0x153)])return;const _0xe1bfe6=(_0x379dcc[_0xb8944c(0x20a)][_0xb8944c(0x122)]||_0xb8944c(0x2b4))[_0xb8944c(0x2a5)](':'),_0x35277e=parseInt(_0xe1bfe6[0x0])||0x8,_0x2cfaa6=parseInt(_0xe1bfe6[0x1])||0x0,_0x4e0399=_0x2cfaa6+'\x20'+_0x35277e+_0xb8944c(0x141);_0x379dcc[_0xb8944c(0x15e)][_0xb8944c(0x1eb)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x35277e+':'+(_0x2cfaa6<0xa?'0'+_0x2cfaa6:_0x2cfaa6)),_0x379dcc['briefingJob']=schedule['scheduleJob'](_0x4e0399,()=>{sendMorningBriefing(_0x379dcc);});}catch(_0x5e203e){_0x379dcc[_0xb8944c(0x15e)][_0xb8944c(0x1e6)](_0xb8944c(0x271)+_0x5e203e[_0xb8944c(0x26b)]);}}async function sendNotification(_0x517676,_0x5aefbf,_0x1b0d40=![],_0x512d8c=![]){const _0xd4f5dc=a0_0x2688fa;_0x517676[_0xd4f5dc(0x15e)][_0xd4f5dc(0x1eb)]((_0x1b0d40?_0xd4f5dc(0x218):'')+_0xd4f5dc(0x1ca)+_0x5aefbf+'\x22');const _0x23f7b5=_0x517676['config'];let _0x57721f=0x0;_0x23f7b5[_0xd4f5dc(0x1a6)]&&(await _0x517676[_0xd4f5dc(0x16d)](_0x23f7b5[_0xd4f5dc(0x195)],_0xd4f5dc(0x223),{'text':_0x5aefbf,'user':_0x23f7b5['notifyTelegramRecipient']}),_0x57721f++);if(_0x23f7b5[_0xd4f5dc(0x25f)]){let _0x57fe02={'message':_0x5aefbf,'title':_0x512d8c?'ðŸš¨\x20EMERGENCY':_0xd4f5dc(0x20f),'priority':_0x512d8c?0x2:0x1,'device':_0x23f7b5[_0xd4f5dc(0x241)]};_0x512d8c&&(_0x57fe02['retry']=0x1e,_0x57fe02[_0xd4f5dc(0x26d)]=0xe10,_0x57fe02[_0xd4f5dc(0x238)]='siren'),await this[_0xd4f5dc(0x16d)](_0x23f7b5[_0xd4f5dc(0x1dc)],_0xd4f5dc(0x223),_0x57fe02),_0x57721f++;}return _0x23f7b5[_0xd4f5dc(0x206)]&&(await this[_0xd4f5dc(0x16d)](_0x23f7b5[_0xd4f5dc(0x1a3)],'send',{'text':_0x5aefbf,'to':_0x23f7b5[_0xd4f5dc(0x1ef)]}),_0x57721f++),_0x57721f;}async function setupTelegramListener(_0xe0919b){const _0x3beeef=a0_0x2688fa,_0xd024c0=_0xe0919b[_0x3beeef(0x20a)]['notifyTelegramInstance'];_0xe0919b['config'][_0x3beeef(0x1a6)]&&_0xd024c0&&(_0xe0919b['log']['info'](_0x3beeef(0x18a)+_0xd024c0+_0x3beeef(0x158)),await _0xe0919b[_0x3beeef(0x12a)](_0xd024c0+_0x3beeef(0x1ce)));}async function handleTelegramResponse(_0x3cabae,_0x15ac8e){const _0x24f37e=a0_0x2688fa;let _0x58262e=_0x15ac8e;_0x15ac8e['startsWith']('[')&&(_0x58262e=_0x15ac8e[_0x24f37e(0x126)](_0x15ac8e[_0x24f37e(0x205)](']')+0x1));if(_0x58262e==='COGNI_CONFIRM_OK')_0x3cabae['log'][_0x24f37e(0x1eb)](_0x24f37e(0x16c)),await _0x3cabae[_0x24f37e(0x1b1)](_0x24f37e(0x189),{'val':![],'ack':!![]}),await _0x3cabae[_0x24f37e(0x1b1)](_0x24f37e(0x19c),{'val':_0x24f37e(0x191),'ack':!![]}),_0x3cabae[_0x24f37e(0x142)]=![],sendNotification(_0x3cabae,'âœ…\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x58262e===_0x24f37e(0x2af)&&(_0x3cabae[_0x24f37e(0x15e)][_0x24f37e(0x19a)](_0x24f37e(0x261)),sendNotification(_0x3cabae,_0x24f37e(0x29c),![],!![]));}async function runAutopilot(_0x1d1193){const _0x1fb60c=a0_0x2688fa,_0x2ae90f=_0x1d1193[_0x1fb60c(0x20a)]['inactivityThresholdHours'],_0x174156=_0x1d1193[_0x1fb60c(0x28b)][_0x1fb60c(0x1f5)]>0x0?_0x1d1193['eventHistory'][0x0][_0x1fb60c(0x15c)]:Date[_0x1fb60c(0x253)](),_0x156aa4=(Date['now']()-_0x174156)/(0x3e8*0x3c*0x3c);let _0x1c2947='';_0x1d1193[_0x1fb60c(0x20a)][_0x1fb60c(0x204)]&&_0x1d1193[_0x1fb60c(0x16f)]===SYSTEM_MODES[_0x1fb60c(0x179)]&&_0x1d1193['isPresent']&&(_0x156aa4>_0x2ae90f&&(_0x1c2947=_0x1fb60c(0x17c)+_0x156aa4[_0x1fb60c(0x203)](0x1)+_0x1fb60c(0x267))),runGeminiAnalysis(_0x1d1193,_0x1c2947)[_0x1fb60c(0x289)](_0x5c4f8c=>_0x1d1193[_0x1fb60c(0x15e)][_0x1fb60c(0x1e6)](_0x5c4f8c));}async function createDailyDigest(_0x44e021){const _0x3f0056=a0_0x2688fa;if(!_0x44e021[_0x3f0056(0x265)])return;await _0x44e021[_0x3f0056(0x1b1)](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()[_0x3f0056(0x1da)](),'ack':!![]});if(!_0x44e021['geminiModel']||_0x44e021[_0x3f0056(0x12c)][_0x3f0056(0x1f5)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x44e021['setStateAsync'](LTM_DP_STATUS,{'val':_0x3f0056(0x134),'ack':!![]});return;}const _0x2091a6=JSON[_0x3f0056(0x20d)](JSON['stringify'](_0x44e021[_0x3f0056(0x12c)])),_0x380f8c=_0x2091a6[_0x3f0056(0x1f5)],_0x26bcc4=_0x3f0056(0x249)+JSON[_0x3f0056(0x15d)](_0x2091a6);try{const _0x3226a7=await _0x44e021['geminiModel']['generateContent'](_0x26bcc4),_0x5e587e=JSON['parse'](_0x3226a7[_0x3f0056(0x1e1)][_0x3f0056(0x28a)]()['replace'](/```json|```/g,'')[_0x3f0056(0x278)]());_0x5e587e['summary']&&(_0x44e021[_0x3f0056(0x269)][_0x3f0056(0x161)]({'timestamp':new Date()[_0x3f0056(0x1f6)](),'eventCount':_0x380f8c,'summary':_0x5e587e[_0x3f0056(0x1a4)],'activityLevel':_0x5e587e[_0x3f0056(0x290)],'systemMode':_0x44e021[_0x3f0056(0x16f)]}),await saveDailyDigests(_0x44e021),_0x44e021['rawEventLog']=[],await saveRawEventLog(_0x44e021),await _0x44e021['setStateAsync'](LTM_DP_STATUS,{'val':_0x3f0056(0x23c)+_0x380f8c+_0x3f0056(0x27c),'ack':!![]}));}catch(_0x53222d){await _0x44e021['setStateAsync'](LTM_DP_STATUS,{'val':_0x3f0056(0x25a)+_0x53222d[_0x3f0056(0x26b)],'ack':!![]});}}async function sendMorningBriefing(_0x585d78){const _0x5142aa=a0_0x2688fa;if(!_0x585d78[_0x5142aa(0x155)])return;_0x585d78['log'][_0x5142aa(0x1eb)]('Generating\x20Morning\x20Briefing...');const _0x252331=_0x585d78['dailyDigests'][_0x5142aa(0x1f5)]>0x0?_0x585d78[_0x5142aa(0x269)][_0x585d78['dailyDigests']['length']-0x1]:null,_0x2da953=_0x252331&&_0x252331[_0x5142aa(0x143)]?_0x252331[_0x5142aa(0x143)][_0x5142aa(0x25b)]:_0x5142aa(0x296),_0x1670e9=new Date();_0x1670e9['setHours'](0x4,0x0,0x0,0x0);const _0x930ef1=_0x585d78[_0x5142aa(0x28b)][_0x5142aa(0x1f9)](_0x170b22=>new Date(_0x170b22['timestamp'])>_0x1670e9),_0x4eb515=PERSONA_MAPPING[_0x585d78[_0x5142aa(0x20a)][_0x5142aa(0x184)]||_0x5142aa(0x283)],_0x3d8bc6=_0x585d78[_0x5142aa(0x20a)]['livingContext']||'',_0x494645=await getWeatherContext(_0x585d78),_0x266ac3=await getCalendarContext(_0x585d78),_0x36e887=_0x5142aa(0x17f)+_0x4eb515+_0x5142aa(0x149)+_0x3d8bc6+'.\x20ZUSATZ:\x20'+_0x494645+'\x20'+_0x266ac3+_0x5142aa(0x26e)+_0x2da953+'/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20'+JSON[_0x5142aa(0x15d)](_0x930ef1[_0x5142aa(0x1fa)](0x0,0xa))+_0x5142aa(0x163);try{const _0x302ad5=await _0x585d78[_0x5142aa(0x155)][_0x5142aa(0x21b)](_0x36e887),_0x1493e1=_0x5142aa(0x262)+_0x302ad5['response']['text']()['trim']();sendNotification(_0x585d78,_0x1493e1),_0x585d78[_0x5142aa(0x15e)][_0x5142aa(0x1eb)](_0x5142aa(0x2ae));}catch(_0x3a73b4){_0x585d78[_0x5142aa(0x15e)]['error'](_0x5142aa(0x2ac)+_0x3a73b4[_0x5142aa(0x26b)]);}}async function scanForDevices(_0x4dfe26,_0x2ebbdc){const _0x51bce4=a0_0x2688fa;_0x4dfe26[_0x51bce4(0x15e)][_0x51bce4(0x1eb)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x594266=[],_0x2c7497=await _0x4dfe26[_0x51bce4(0x13d)]('*'),_0x17d1f9=await _0x4dfe26['getForeignObjectsAsync']('enum.functions.*',_0x51bce4(0x1c8)),_0x107c56=await _0x4dfe26[_0x51bce4(0x13d)]('enum.rooms.*',_0x51bce4(0x1c8)),_0x46978d={};if(_0x17d1f9)for(const _0x248d6b in _0x17d1f9){const _0x2f29d1=_0x17d1f9[_0x248d6b][_0x51bce4(0x21a)]['members']||[];_0x2f29d1[_0x51bce4(0x2b7)](_0x5a9510=>{if(!_0x46978d[_0x5a9510])_0x46978d[_0x5a9510]=[];_0x46978d[_0x5a9510]['push'](_0x248d6b);});}const _0x1b0660={};if(_0x107c56)for(const _0x27b874 in _0x107c56){const _0x254bdd=_0x107c56[_0x27b874][_0x51bce4(0x21a)][_0x51bce4(0x234)]||[],_0x367653=typeof _0x107c56[_0x27b874][_0x51bce4(0x21a)][_0x51bce4(0x27d)]===_0x51bce4(0x275)?_0x107c56[_0x27b874][_0x51bce4(0x21a)]['name']['de']:_0x107c56[_0x27b874]['common']['name'];_0x254bdd[_0x51bce4(0x2b7)](_0x19fc56=>_0x1b0660[_0x19fc56]=_0x367653);}const _0x5b60e5=_0x2ebbdc[_0x51bce4(0x1d5)]||[],_0x1a1b7f=_0x2ebbdc[_0x51bce4(0x139)]!==![],_0x49bbfd=_0x2ebbdc[_0x51bce4(0x282)]!==![],_0x3b7e60=_0x2ebbdc[_0x51bce4(0x17b)]!==![],_0x17e0b1=_0x2ebbdc[_0x51bce4(0x125)]===!![],_0x25f2c0=_0x2ebbdc[_0x51bce4(0x292)]===!![];for(const _0x3dc77a in _0x2c7497){const _0x456af0=_0x2c7497[_0x3dc77a];if(_0x456af0[_0x51bce4(0x1c0)]!==_0x51bce4(0x25d)||!_0x456af0[_0x51bce4(0x21a)])continue;if(ADAPTER_BLACKLIST[_0x51bce4(0x162)](_0x5d6b8f=>_0x3dc77a['startsWith'](_0x5d6b8f))&&!_0x25f2c0)continue;const _0x41e137=(_0x456af0['common']['role']||'')['toLowerCase']();let _0x2bab56=(typeof _0x456af0[_0x51bce4(0x21a)][_0x51bce4(0x27d)]===_0x51bce4(0x275)?_0x456af0[_0x51bce4(0x21a)]['name']['de']:_0x456af0['common']['name'])||_0x3dc77a;const _0x5eed33=_0x2bab56[_0x51bce4(0x258)]();let _0x5cee34=![],_0x29dd92=![];if(_0x5b60e5[_0x51bce4(0x1f5)]>0x0){const _0x156059=_0x46978d[_0x3dc77a]||[],_0x2c379a=_0x3dc77a[_0x51bce4(0x2a5)]('.')['slice'](0x0,-0x1)[_0x51bce4(0x145)]('.'),_0x2c701b=_0x46978d[_0x2c379a]||[];(_0x156059[_0x51bce4(0x162)](_0x21308d=>_0x5b60e5['includes'](_0x21308d))||_0x2c701b['some'](_0xcd79c8=>_0x5b60e5[_0x51bce4(0x225)](_0xcd79c8)))&&(_0x5cee34=!![],_0x29dd92=!![]);}if(!_0x5cee34&&!_0x25f2c0){if(HARD_IGNORE_TERMS[_0x51bce4(0x162)](_0x2afab5=>_0x3dc77a[_0x51bce4(0x225)](_0x2afab5)||_0x5eed33[_0x51bce4(0x225)](_0x2afab5[_0x51bce4(0x258)]())))continue;}if(BAD_NAMES[_0x51bce4(0x162)](_0x11e299=>_0x5eed33===_0x11e299||_0x5eed33[_0x51bce4(0x172)]('.'+_0x11e299))){const _0x18473f=_0x3dc77a['split']('.');if(_0x18473f['length']>0x2){const _0x125fc2=_0x18473f[_0x51bce4(0x1fa)](0x0,-0x1)['join']('.'),_0x25919d=_0x2c7497[_0x125fc2];if(_0x25919d&&_0x25919d[_0x51bce4(0x21a)]&&_0x25919d[_0x51bce4(0x21a)][_0x51bce4(0x27d)]){const _0x328ed3=typeof _0x25919d[_0x51bce4(0x21a)][_0x51bce4(0x27d)]===_0x51bce4(0x275)?_0x25919d[_0x51bce4(0x21a)]['name']['de']:_0x25919d[_0x51bce4(0x21a)][_0x51bce4(0x27d)];_0x328ed3&&!_0x2bab56[_0x51bce4(0x225)](_0x328ed3)&&(_0x2bab56=_0x328ed3+'\x20'+_0x2bab56);}}}let _0x5a4c18='';if(_0x1a1b7f&&(_0x41e137['includes'](_0x51bce4(0x139))||_0x41e137[_0x51bce4(0x225)]('occupancy')||_0x5eed33[_0x51bce4(0x225)](_0x51bce4(0x245))||_0x5eed33['includes'](_0x51bce4(0x2a1))))_0x5a4c18=_0x51bce4(0x139);else{if(!_0x5a4c18&&_0x49bbfd&&(_0x41e137[_0x51bce4(0x225)](_0x51bce4(0x1af))||_0x41e137['includes'](_0x51bce4(0x210))||_0x41e137[_0x51bce4(0x225)](_0x51bce4(0x17e))||_0x41e137[_0x51bce4(0x225)](_0x51bce4(0x294))||_0x41e137[_0x51bce4(0x225)](_0x51bce4(0x1fd))||_0x5eed33['includes'](_0x51bce4(0x15f))||_0x5eed33[_0x51bce4(0x225)]('tÃ¼r')||_0x5eed33[_0x51bce4(0x225)]('rollladen')))_0x5a4c18=_0x51bce4(0x1af);else{if(!_0x5a4c18&&_0x3b7e60&&(_0x41e137[_0x51bce4(0x225)](_0x51bce4(0x243))||_0x41e137[_0x51bce4(0x225)]('switch')||_0x41e137[_0x51bce4(0x225)](_0x51bce4(0x2a4))||_0x5eed33[_0x51bce4(0x225)](_0x51bce4(0x152))||_0x5eed33[_0x51bce4(0x225)](_0x51bce4(0x1ed))||_0x5eed33[_0x51bce4(0x225)]('schalter'))){if(_0x456af0[_0x51bce4(0x21a)][_0x51bce4(0x228)]||_0x41e137[_0x51bce4(0x225)](_0x51bce4(0x136)))_0x5a4c18='light';}else{if(!_0x5a4c18&&_0x17e0b1&&(_0x41e137[_0x51bce4(0x225)](_0x51bce4(0x125))||_0x41e137[_0x51bce4(0x225)]('humidity')||_0x41e137['includes'](_0x51bce4(0x1be))||_0x5eed33['includes'](_0x51bce4(0x22c))||_0x5eed33[_0x51bce4(0x225)]('klima')||_0x5eed33[_0x51bce4(0x225)](_0x51bce4(0x1f8))))_0x5a4c18='temperature';else{if(!_0x5a4c18&&_0x29dd92)_0x5a4c18=_0x51bce4(0x197);}}}}if(_0x5a4c18){let _0x394235=_0x1b0660[_0x3dc77a]||'';if(!_0x394235){let _0x28a6b6=_0x3dc77a;for(let _0x39d291=0x0;_0x39d291<0x3;_0x39d291++){const _0x582356=_0x28a6b6[_0x51bce4(0x16a)]('.');if(_0x582356===-0x1)break;_0x28a6b6=_0x28a6b6[_0x51bce4(0x126)](0x0,_0x582356);if(_0x1b0660[_0x28a6b6]){_0x394235=_0x1b0660[_0x28a6b6];break;}}}_0x594266['push']({'id':_0x3dc77a,'name':_0x2bab56,'location':_0x394235,'type':_0x5a4c18,'logDuplicates':_0x5a4c18===_0x51bce4(0x139),'isExit':![],'_score':_0x394235?0x50:_0x5a4c18===_0x51bce4(0x197)?0x5a:0x28});}}return _0x594266['sort']((_0x172349,_0x2baadf)=>_0x2baadf['_score']-_0x172349[_0x51bce4(0x1ad)]),_0x594266;}if(require[a0_0x2688fa(0x133)]!==module)module[a0_0x2688fa(0x186)]=_0x5c4268=>new CogniLiving(_0x5c4268);else new CogniLiving();