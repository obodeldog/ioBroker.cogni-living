const a0_0x573f5f=a0_0x36f4;function a0_0x127d(){const _0x74c985=['submitFeedback','toLowerCase','values','analysis.alertReason','temperatur','TRAIN_ENERGY','AI\x20Training','analysis.history_debug_00','110QWUxwN','startsWith','üß†\x20Triggering\x20Security\x20Training...','dismissAutomation','pythonProcess','notifyPushoverRecipient','KI-Modell\x20nicht\x20initialisiert','version','path','Health\x20Analysis','round','vacation','text.alarm','Vom\x20Benutzer\x20best√§tigt\x20(OK).','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','getMonth','Last\x20Check','sendTo','endsWith','generateContent','fill','onStateChange','PRIORIT√ÑT:\x20Sicherheit.','NORMAL','klima','Missing\x20data','minDaysForBaseline','system.isPresent','testContext','driftAnalysisTimer','ANALYZE_HEALTH','.Current.Temperature','Train\x20Energy','setState',')\x20-\x20SAFE\x20BOOT','analysis.security.lastCheck','Unknown','systemUUID','summary','notifyTelegramEnabled','WiFi\x20Presence\x20detected.','Gemini\x20AI\x20initialized.','getGenerativeModel','status','üìû\x20R√ºckruf\x20anfordern','openweathermap','filter','Anomaly\x20Score','name','inactivityThresholdHours','Sequences','forEach','.\x20KONTEXT:\x20','constructor','ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...','PARTY','pip.exe','TRAIN_SECURITY','automation.triggerAction','kontakt','log','apply','‚úÖ\x20INSTALL\x20SUCCESS.','indexOf','.forecast.current.temp','Briefing\x20Sched\x20Error:\x20','Anomaly\x20Detected','getForeignStateAsync','Regel\x20erkannt:\x20','System\x20Mode','Kein\x20API\x20Key.','Detected\x20Patterns','analysisHistory','.\x20ANWESEND:\x20','system.mode','cogni-living\x20adapter\x20starting\x20(v','events.history','(((.+)+)+)+$','motion','Gemini\x20Init\x20Error:\x20','geminiModel','TRAIN_COMFORT','licenseKey','send','TRAINING_COMPLETE','.Current.WeatherText','isGracePeriodActive','getTime','notifyEmailEnabled','analysis.automation.autoApply','systemConfig','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','LTM\x20Sched\x20Error:\x20','ltmDriftCheckIntervalHours','Daily\x20Digests','LTM','System','outdoorSensorId','.\x20EVENTS:\x20','info','t√ºr','Pattern\x20Detected','analysis.lastResult','Aktiv\x20(','\x20=\x20','Train\x20Security','driftDetails','python.exe','substring','lampe','slice','success','eventHistory','targetId','Sec-Training\x20started...','autoApply','[RESULT]','text','error','11693912RMRyQE','namespace','Trend\x20Value','2361034LRULEU','Drift\x20Sched\x20Error:\x20','notifyTelegramInstance','requirements.txt','analysis.trigger','[RECORDER]\x20Error:\x20','Training\x20Error:\x20','.\x20EMERGENCY:\x20','targetValue','service.py','analysis.energy','ready','timestamp','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','Lernphase\x20(','0\x203\x20*\x20*\x20*','sensorLastValues','HEALTH_RESULT','analysis.health','notifyEmailRecipient','close','unload','enum','1fepFQG','expire','python3\x20-m\x20venv\x20\x22','LTM.trainingData.sequences','insulation','getForeignObjectsAsync','trim','getDate','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','geminiApiKey','map','setStateAsync','toLocaleTimeString','guest','9193158JJDSUf','Energy\x20Intelligence','analysis.training.triggerEnergy','getLtmData','toISOString','onReady','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','system.config','analysis.energy.insulationScore','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','light','1474150QWNuNy','isEmergency','\x0aGrund:\x20','analysisTimer','Security\x20Monitor','telegram','notifyTelegramRecipient','Unbekannt','platform','temperature','analysis.analysisHistory','licht','bind','‚ö†Ô∏è\x20Python\x20VENV\x20missing.\x20Installing\x20locally...','Keine\x20Wetterdaten\x20verf√ºgbar.','longitude','lastAlertState','‚ùå\x20VENV\x20FAILED:\x20','heizung','LTM.processingStatus','Started...','rawEventLog','channel','devices','livingContext','08:00','Train\x20Health','unknown','2190ePVPFd','some','Kein\x20API\x20Key!','role','length','¬∞C,\x20','details','analysis.training.triggerSecurity','application/json','python','retry','bin','‚ùå\x20INSTALL\x20FAILED:\x20','GUEST','‚ö†Ô∏è\x20ALARM:\x20','Keine\x20Details.','‚úÖ\x20HEALTH\x20TRAINED.','scheduleJob','enum.functions.*','existsSync','.communicate.request','heating','latitude','currentSystemMode','logDuplicates','Success:\x20','analysis.automation.patternDetected','number','analysis.energy.heatingScore','Restoring\x20sensor\x20cache...','getMinutes','presenceDevices','getEnums','Raw\x20Log','getOverviewData','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','[PYTHON]\x20','search','BUTLER\x20Execution\x20Error:\x20','Keine\x20Termine.','config','toString','analysis.automation.triggerAction','ltmStbWindowDays','getCalendarNames','child_process','Trigger\x20Briefing','diagnosis','alertReason','parse','dependencyInstallInProgress','analysis.automation.description','description','Reset\x20Sched\x20Error:\x20','useCalendar','analysis.security.currentThreshold','setForeignStateAsync','Auto\x20Apply','common','toFixed','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','rule','type','json','command','User\x20dismissed\x20automation\x20proposal.','kill','city','response','subscribeForeignStatesAsync','door','python_service','system','subscribeStates','analysis.automation.targetValue','fenster','weatherInstance','4422105ockvxh','threshold','weatherunderground','sendToAsync','party','Cogni-Living','LTM.baselineStatus','date','onMessage','shift','boolean','Training\x20Status','getObjectAsync','events.lastEvent','‚úÖ\x20Alles\x20OK\x20(Reset)','extendObjectAsync','üõãÔ∏è\x20BUTLER:\x20Found\x20','analysis.training','SECURITY_RESULT','analysis.training.triggerHealth','.forecast.current.state','writable','lights','analysis.activitySummary','split','isPresent','1946WJQxbx','üåÖ\x20Morning\x20Briefing:\x0a','Fokus\x20auf\x20Familienroutinen.','analysis.security','exitGraceTimer','object','briefingTime','notifyPushoverEnabled','analysis.automation.detectedPatterns','online','Insulation\x20Score','detected','string','Err:\x20','Activity\x20Summary','button','presence','unshift','analysis.health.trendValue','Scripts','VACATION','Thermodynamics','debug','\x20*\x20*\x20*','value','Trend','Analysiere\x20ausgewogen.','analysis.security.lastScore','Trigger\x20Action','simulateButler','main','.\x20SYSTEM_MODE:\x20','briefingJob','getHours','analysis.training.status','@google/generative-ai','splice','indicator','exitTimer','LTM.driftAnalysis.lastCheck','normal','pr√§senz','win32','delObjectAsync','state','Deaktiviert\x20(Pro-Feature)','0\x204\x20*\x20*\x20*','analysis.health.lastCheck','triggerBriefing','events.history_debug_00','stateChange','ltmLtbWindowDays','Target\x20ID','useWeather','location','is_anomaly','contact','analysis.isAlert','üìù\x20Feedback\x20received:\x20','exports','212292glhsMT','stringify','dailyDigests','modeResetJob','triggerDailyDigest','stdin','.forecast.current.temperature','üîç\x20Scanning\x20for\x20devices...','analysis.training.triggerComfort','getStateAsync','COGNI_CONFIRM_OK','isAlert','now','from','LTM.triggerDailyDigest','sound','genAI','LTM.trainingData.thermodynamics','PRIORIT√ÑT:\x20Gesundheit/AAL.','Kalender\x20deaktiviert.','.\x20WETTER:\x20','COGNI_REQUEST_CALL','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','N/A\x20(Learning)','scanDevices','LTM.driftAnalysis','replace','cancel','isExit','automationProposal','Digest','analysis.health.isAnomaly','Trigger\x20Analysis','setObjectNotExistsAsync','üö®\x20EMERGENCY','notifyPushoverInstance','indicator.alarm','baselineDrift','switch','Target\x20Value','includes','rating','window','analysis.triggerBriefing','callback','LTM.driftAnalysis.baselineDrift','system.presenceWho','bewegung','Alarm','loc','join','Who\x20is\x20present?','analysis.automation.targetId','HEALTH_TRAIN_RESULT','accuweather','ltmJob','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','.NextHours.Location_1.Day_1.current.temp_value','pop','rmSync','instance','Alert\x20Reason','üöÄ\x20Starting\x20NUUKANNI\x20Logic\x20(v0.10.0)...','N/A','payload','isProVersion','message','python3','getForeignObjectAsync','apiKey','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','val','doors','Last\x20raw\x20event','Heating\x20Score','push','Error\x20launching\x20Python:\x20'];a0_0x127d=function(){return _0x74c985;};return a0_0x127d();}function a0_0x36f4(_0x271d61,_0x440758){const _0x3bb212=a0_0x127d();return a0_0x36f4=function(_0x337602,_0x392975){_0x337602=_0x337602-0x12f;let _0x127d26=_0x3bb212[_0x337602];return _0x127d26;},a0_0x36f4(_0x271d61,_0x440758);}(function(_0x350699,_0x3bc957){const _0x451552=a0_0x36f4,_0x1d8b24=_0x350699();while(!![]){try{const _0x533d45=-parseInt(_0x451552(0x2d6))/0x1*(parseInt(_0x451552(0x2bf))/0x2)+parseInt(_0x451552(0x19a))/0x3+parseInt(_0x451552(0x1f0))/0x4*(parseInt(_0x451552(0x245))/0x5)+parseInt(_0x451552(0x14d))/0x6*(-parseInt(_0x451552(0x1b4))/0x7)+-parseInt(_0x451552(0x2bc))/0x8+parseInt(_0x451552(0x2e4))/0x9+-parseInt(_0x451552(0x131))/0xa;if(_0x533d45===_0x3bc957)break;else _0x1d8b24['push'](_0x1d8b24['shift']());}catch(_0x5f1b8b){_0x1d8b24['push'](_0x1d8b24['shift']());}}}(a0_0x127d,0xbc77a));const a0_0x392975=(function(){let _0x3204d0=!![];return function(_0x5f6d33,_0x4c0ed6){const _0x59ac88=_0x3204d0?function(){const _0x1de274=a0_0x36f4;if(_0x4c0ed6){const _0x15f983=_0x4c0ed6[_0x1de274(0x282)](_0x5f6d33,arguments);return _0x4c0ed6=null,_0x15f983;}}:function(){};return _0x3204d0=![],_0x59ac88;};}()),a0_0x337602=a0_0x392975(this,function(){const _0x37a056=a0_0x36f4;return a0_0x337602[_0x37a056(0x176)]()[_0x37a056(0x172)](_0x37a056(0x292))['toString']()[_0x37a056(0x27a)](a0_0x337602)[_0x37a056(0x172)](_0x37a056(0x292));});a0_0x337602();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x573f5f(0x1d7)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x573f5f(0x17a)),path=require(a0_0x573f5f(0x24d)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x573f5f(0x2ce),MODE_RESET_SCHEDULE=a0_0x573f5f(0x1e2),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x573f5f(0x144),LTM_DP_TRIGGER_DIGEST=a0_0x573f5f(0x1fe),LTM_DP_BASELINE_STATUS=a0_0x573f5f(0x1a0),LTM_DP_DRIFT_CHANNEL=a0_0x573f5f(0x209),LTM_DP_DRIFT_STATUS=a0_0x573f5f(0x21d),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x573f5f(0x1db),SYSTEM_DP_MODE=a0_0x573f5f(0x28f),SYSTEM_MODES={'NORMAL':a0_0x573f5f(0x1dc),'VACATION':a0_0x573f5f(0x250),'PARTY':a0_0x573f5f(0x19e),'GUEST':a0_0x573f5f(0x2e3)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x573f5f(0x27c)],SYSTEM_MODES[a0_0x573f5f(0x15a)]],PERSONA_MAPPING={'generic':a0_0x573f5f(0x1ce),'senior_aal':a0_0x573f5f(0x202),'family':a0_0x573f5f(0x1b6),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x573f5f(0x25b)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x573f5f(0x139)]===a0_0x573f5f(0x1de),PERSISTENT_DIR=path[a0_0x573f5f(0x222)](__dirname,'.venv'),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x573f5f(0x1c7),a0_0x573f5f(0x2b0)):path[a0_0x573f5f(0x222)](VENV_PATH,a0_0x573f5f(0x158),a0_0x573f5f(0x156)),PIP_EXE=IS_WIN?path[a0_0x573f5f(0x222)](VENV_PATH,a0_0x573f5f(0x1c7),a0_0x573f5f(0x27d)):path[a0_0x573f5f(0x222)](VENV_PATH,a0_0x573f5f(0x158),'pip');let activeSequence=[],sequenceTimer=null;async function startSystem(_0x245e63){const _0x5241df=a0_0x573f5f;_0x245e63[_0x5241df(0x281)][_0x5241df(0x2a8)](_0x5241df(0x22e)),await initZombies(_0x245e63);try{_0x245e63[_0x5241df(0x231)]=await checkLicense(_0x245e63[_0x5241df(0x175)][_0x5241df(0x297)]);}catch(_0x4cd951){}if(!_0x245e63[_0x5241df(0x175)][_0x5241df(0x276)]||_0x245e63[_0x5241df(0x175)]['inactivityThresholdHours']<0.1)_0x245e63[_0x5241df(0x175)][_0x5241df(0x276)]=0xc;await initHistory(_0x245e63),await initSystemConfig(_0x245e63);if(_0x245e63[_0x5241df(0x175)][_0x5241df(0x2df)])try{_0x245e63[_0x5241df(0x200)]=new GoogleGenerativeAI(_0x245e63[_0x5241df(0x175)][_0x5241df(0x2df)]),_0x245e63['geminiModel']=_0x245e63[_0x5241df(0x200)][_0x5241df(0x26f)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5241df(0x155)}}),_0x245e63[_0x5241df(0x281)][_0x5241df(0x2a8)](_0x5241df(0x26e));}catch(_0x2f65d2){_0x245e63[_0x5241df(0x281)]['error'](_0x5241df(0x294)+_0x2f65d2[_0x5241df(0x232)]);}await createAllObjects(_0x245e63),await loadSystemMode(_0x245e63),await loadRawEventLog(_0x245e63),await loadDailyDigests(_0x245e63),_0x245e63[_0x5241df(0x196)](_0x5241df(0x2c3)),_0x245e63[_0x5241df(0x196)](LTM_DP_TRIGGER_DIGEST),_0x245e63[_0x5241df(0x196)](_0x5241df(0x28f)),_0x245e63[_0x5241df(0x196)](_0x5241df(0x21b)),_0x245e63[_0x5241df(0x196)](_0x5241df(0x177)),_0x245e63[_0x5241df(0x196)](_0x5241df(0x29e)),_0x245e63[_0x5241df(0x196)]('analysis.training.triggerSecurity'),_0x245e63['subscribeStates'](_0x5241df(0x1ad)),_0x245e63['subscribeStates'](_0x5241df(0x2e6)),_0x245e63[_0x5241df(0x196)](_0x5241df(0x1f8)),await initSensorSubscriptions(_0x245e63),await initPresenceSubscriptions(_0x245e63),await setupTelegramListener(_0x245e63),setTimeout(()=>checkWifiPresence(_0x245e63),0x1388);if(_0x245e63[_0x5241df(0x134)])clearInterval(_0x245e63['analysisTimer']);const _0x2def28=_0x245e63[_0x5241df(0x175)]['analysisInterval']||0xf;_0x2def28>0x0&&(_0x245e63['analysisTimer']=setInterval(()=>{runAutopilot(_0x245e63);},_0x2def28*0x3c*0x3e8)),setupLtmScheduler(_0x245e63),setupModeResetScheduler(_0x245e63),setupDriftAnalysisScheduler(_0x245e63),setupBriefingScheduler(_0x245e63),startPythonService(_0x245e63),setTimeout(()=>{const _0x57f91f=_0x5241df;if(_0x245e63[_0x57f91f(0x249)])runPythonHealthCheck(_0x245e63);},0x1388);}async function runAutopilot(_0x238081){const _0x2eda32=a0_0x573f5f;_0x238081[_0x2eda32(0x281)][_0x2eda32(0x1ca)](_0x2eda32(0x27b)),await runGeminiAnalysis(_0x238081);}async function scanForDevices(_0x9ff85c,_0x19e834){const _0x5b4ce2=a0_0x573f5f;_0x9ff85c[_0x5b4ce2(0x281)][_0x5b4ce2(0x2a8)](_0x5b4ce2(0x1f7));const _0x19d21b=[],_0x4926d7=await _0x9ff85c[_0x5b4ce2(0x2db)]('*');for(const _0x3ebbbd in _0x4926d7){const _0x2b2d09=_0x4926d7[_0x3ebbbd];if(_0x2b2d09&&_0x2b2d09[_0x5b4ce2(0x187)]&&_0x2b2d09['type']===_0x5b4ce2(0x1e0)){const _0x460fcb=(_0x2b2d09[_0x5b4ce2(0x187)][_0x5b4ce2(0x275)]&&typeof _0x2b2d09[_0x5b4ce2(0x187)][_0x5b4ce2(0x275)]==='object'?_0x2b2d09[_0x5b4ce2(0x187)][_0x5b4ce2(0x275)]['de']:_0x2b2d09[_0x5b4ce2(0x187)]['name'])||'',_0x430288=_0x2b2d09['common'][_0x5b4ce2(0x150)]||'';let _0x5f2c80=null;if(_0x19e834[_0x5b4ce2(0x293)]&&(_0x430288['includes'](_0x5b4ce2(0x293))||_0x460fcb[_0x5b4ce2(0x23e)]()[_0x5b4ce2(0x218)](_0x5b4ce2(0x21f))))_0x5f2c80=_0x5b4ce2(0x293);else{if(_0x19e834[_0x5b4ce2(0x238)]&&(_0x430288[_0x5b4ce2(0x218)](_0x5b4ce2(0x193))||_0x430288[_0x5b4ce2(0x218)](_0x5b4ce2(0x21a))||_0x460fcb[_0x5b4ce2(0x23e)]()[_0x5b4ce2(0x218)]('t√ºr')||_0x460fcb['toLowerCase']()[_0x5b4ce2(0x218)](_0x5b4ce2(0x198))))_0x5f2c80=_0x5b4ce2(0x193);else{if(_0x19e834[_0x5b4ce2(0x1b0)]&&(_0x430288[_0x5b4ce2(0x218)](_0x5b4ce2(0x130))||_0x430288[_0x5b4ce2(0x218)]('switch')||_0x460fcb['toLowerCase']()[_0x5b4ce2(0x218)](_0x5b4ce2(0x13c))))_0x5f2c80=_0x5b4ce2(0x130);else{if(_0x19e834[_0x5b4ce2(0x13a)]&&(_0x430288['includes'](_0x5b4ce2(0x13a))||_0x460fcb[_0x5b4ce2(0x23e)]()['includes'](_0x5b4ce2(0x241))))_0x5f2c80=_0x5b4ce2(0x13a);}}}if(_0x5f2c80){let _0x3cacb5='';const _0xec9b8e=_0x3ebbbd[_0x5b4ce2(0x1b2)]('.');if(_0xec9b8e[_0x5b4ce2(0x151)]>0x2)_0x3cacb5=_0xec9b8e[0x2];_0x19d21b['push']({'id':_0x3ebbbd,'name':_0x460fcb||_0x3ebbbd,'type':_0x5f2c80,'location':_0x3cacb5,'_score':0x32});}}}return _0x19d21b;}async function getWeatherContext(_0x18594e){const _0x4210ff=a0_0x573f5f;if(!_0x18594e[_0x4210ff(0x175)][_0x4210ff(0x1e9)]||!_0x18594e[_0x4210ff(0x175)][_0x4210ff(0x199)])return'Wetterdaten\x20deaktiviert.';try{const _0xfaefbc=_0x18594e['config']['weatherInstance'];let _0x3e1cea=await _0x18594e[_0x4210ff(0x288)](_0xfaefbc+'.Current.Temperature');if(!_0x3e1cea)_0x3e1cea=await _0x18594e['getForeignStateAsync'](_0xfaefbc+'.forecast.current.temperature');let _0x1daffe=await _0x18594e[_0x4210ff(0x288)](_0xfaefbc+_0x4210ff(0x29a));if(!_0x1daffe)_0x1daffe=await _0x18594e[_0x4210ff(0x288)](_0xfaefbc+_0x4210ff(0x1ae));if(_0x3e1cea&&_0x1daffe)return _0x3e1cea[_0x4210ff(0x237)]+_0x4210ff(0x152)+_0x1daffe['val'];}catch(_0x578b74){}return _0x4210ff(0x13f);}async function getCalendarContext(_0x32acb9){const _0x463491=a0_0x573f5f;if(!_0x32acb9[_0x463491(0x175)][_0x463491(0x183)]||!_0x32acb9[_0x463491(0x175)]['calendarInstance'])return _0x463491(0x203);return _0x463491(0x174);}async function getCalendarNames(_0x3e4174,_0x5c74d7){return[];}async function saveFeedback(_0x43aee1,_0x573958){const _0x171536=a0_0x573f5f;_0x43aee1[_0x171536(0x281)][_0x171536(0x2a8)](_0x171536(0x1ee)+_0x573958[_0x171536(0x219)]);}async function sendMorningBriefing(_0x7ea4ec){const _0x23c26c=a0_0x573f5f;if(!_0x7ea4ec[_0x23c26c(0x295)])return;try{const _0x28d60a=_0x23c26c(0x236),_0x5e0486=await _0x7ea4ec[_0x23c26c(0x295)][_0x23c26c(0x258)](_0x28d60a),_0x33d375=_0x5e0486['response'][_0x23c26c(0x2ba)]();sendNotification(_0x7ea4ec,_0x23c26c(0x1b5)+_0x33d375);}catch(_0x1869f4){_0x7ea4ec[_0x23c26c(0x281)][_0x23c26c(0x2bb)]('Briefing\x20Error:\x20'+_0x1869f4[_0x23c26c(0x232)]);}}function checkAndInstall(_0x4a256f){const _0x5ef726=a0_0x573f5f;if(!fs[_0x5ef726(0x160)](VENV_PATH)||!fs[_0x5ef726(0x160)](PIP_EXE))return _0x4a256f[_0x5ef726(0x281)]['warn'](_0x5ef726(0x13e)),installPythonDependencies(_0x4a256f),![];return!![];}function installPythonDependencies(_0xe0c3a5){const _0x45e429=a0_0x573f5f;if(_0xe0c3a5[_0x45e429(0x17f)])return;_0xe0c3a5[_0x45e429(0x17f)]=!![];const _0x18fa12=path[_0x45e429(0x222)](__dirname,_0x45e429(0x194),_0x45e429(0x2c2));stopPythonService(_0xe0c3a5);if(fs[_0x45e429(0x160)](VENV_PATH))try{fs[_0x45e429(0x22b)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x119c0a){}exec(_0x45e429(0x2d8)+VENV_PATH+'\x22',_0x38b256=>{const _0x4795f0=_0x45e429;if(_0x38b256){_0xe0c3a5[_0x4795f0(0x281)][_0x4795f0(0x2bb)](_0x4795f0(0x142)+_0x38b256[_0x4795f0(0x232)]),_0xe0c3a5[_0x4795f0(0x17f)]=![];return;}installRequirementsInVenv(_0xe0c3a5,_0x18fa12);});}function installRequirementsInVenv(_0x38cdb2,_0x569dd3){const _0x58b0c8=a0_0x573f5f;_0x38cdb2[_0x58b0c8(0x281)][_0x58b0c8(0x2a8)]('Installing\x20pip\x20packages...');const _0x3f3416='\x22'+PIP_EXE+_0x58b0c8(0x2de)+_0x569dd3+'\x22';exec(_0x3f3416,{'timeout':0x124f80},(_0x1f47d6,_0x438727,_0x11d711)=>{const _0x3a79b5=_0x58b0c8;_0x38cdb2['dependencyInstallInProgress']=![],_0x1f47d6?_0x38cdb2[_0x3a79b5(0x281)][_0x3a79b5(0x2bb)](_0x3a79b5(0x159)+(_0x11d711||_0x1f47d6[_0x3a79b5(0x232)])):(_0x38cdb2[_0x3a79b5(0x281)][_0x3a79b5(0x2a8)](_0x3a79b5(0x283)),startSystem(_0x38cdb2));});}async function initZombies(_0x2a905f){const _0x2a4357=a0_0x573f5f;try{const _0x1fbade=[_0x2a4357(0x244),_0x2a4357(0x1e5)];for(const _0x404a7a of _0x1fbade){try{const _0x4339b7=await _0x2a905f[_0x2a4357(0x1a6)](_0x404a7a);if(_0x4339b7)await _0x2a905f[_0x2a4357(0x1df)](_0x404a7a);}catch(_0x1daa38){}}}catch(_0x1f85de){}}async function checkLicense(_0x5adb63){return!![];}async function initHistory(_0x1b1f0b){const _0x3a8a2d=a0_0x573f5f;try{const _0x32eb30=await _0x1b1f0b['getStateAsync']('events.history');_0x32eb30&&_0x32eb30[_0x3a8a2d(0x237)]&&(_0x1b1f0b[_0x3a8a2d(0x2b5)]=JSON[_0x3a8a2d(0x17e)](_0x32eb30[_0x3a8a2d(0x237)][_0x3a8a2d(0x176)]()));}catch(_0x56bb50){_0x1b1f0b[_0x3a8a2d(0x2b5)]=[];}try{const _0x861e09=await _0x1b1f0b[_0x3a8a2d(0x1f9)](_0x3a8a2d(0x13b));if(_0x861e09&&_0x861e09[_0x3a8a2d(0x237)])_0x1b1f0b[_0x3a8a2d(0x28d)]=JSON['parse'](_0x861e09[_0x3a8a2d(0x237)][_0x3a8a2d(0x176)]());}catch(_0x4b6d5d){_0x1b1f0b[_0x3a8a2d(0x28d)]=[];}if(_0x1b1f0b['eventHistory']&&_0x1b1f0b[_0x3a8a2d(0x2b5)][_0x3a8a2d(0x151)]>0x0){_0x1b1f0b[_0x3a8a2d(0x281)]['info'](_0x3a8a2d(0x16a));for(let _0x251d09=_0x1b1f0b['eventHistory'][_0x3a8a2d(0x151)]-0x1;_0x251d09>=0x0;_0x251d09--){const _0x5b39a0=_0x1b1f0b[_0x3a8a2d(0x2b5)][_0x251d09];if(_0x5b39a0&&_0x5b39a0['id']!==undefined&&_0x5b39a0[_0x3a8a2d(0x1cc)]!==undefined)_0x1b1f0b['sensorLastValues'][_0x5b39a0['id']]=_0x5b39a0[_0x3a8a2d(0x1cc)];}}}async function initSystemConfig(_0xe46ebe){const _0xab5636=a0_0x573f5f;try{const _0x3df090=await _0xe46ebe[_0xab5636(0x234)](_0xab5636(0x2eb));if(_0x3df090&&_0x3df090[_0xab5636(0x187)])_0xe46ebe['systemConfig']={'latitude':_0x3df090['common'][_0xab5636(0x163)]||0x0,'longitude':_0x3df090[_0xab5636(0x187)][_0xab5636(0x140)]||0x0,'city':_0x3df090[_0xab5636(0x187)][_0xab5636(0x190)]||''};}catch(_0x2a2831){}}async function createAllObjects(_0x3c518e){const _0x500b67=a0_0x573f5f;await _0x3c518e[_0x500b67(0x1a9)](_0x500b67(0x195),{'type':'channel','common':{'name':_0x500b67(0x2a5)},'native':{}}),await _0x3c518e[_0x500b67(0x1a9)](SYSTEM_DP_MODE,{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x28a),'type':_0x500b67(0x1c0),'role':_0x500b67(0x1e0),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL']},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x21e),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x223),'type':'string','role':_0x500b67(0x2ba),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)]('events.lastEvent',{'type':'state','common':{'name':_0x500b67(0x239),'type':_0x500b67(0x1c0),'role':_0x500b67(0x18c),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)]('events.history',{'type':_0x500b67(0x1e0),'common':{'name':'Event\x20History','type':_0x500b67(0x1c0),'role':'json','read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x1a9)](_0x500b67(0x1ab),{'type':_0x500b67(0x147),'common':{'name':_0x500b67(0x243)},'native':{}}),await _0x3c518e['setObjectNotExistsAsync'](_0x500b67(0x154),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x2ae),'type':_0x500b67(0x1a4),'role':_0x500b67(0x1c3),'read':!![],'write':!![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)]('analysis.training.triggerHealth',{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x14b),'type':_0x500b67(0x1a4),'role':_0x500b67(0x1c3),'read':!![],'write':!![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x2e6),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x265),'type':'boolean','role':'button','read':!![],'write':!![]},'native':{}}),await _0x3c518e['setObjectNotExistsAsync']('analysis.training.triggerComfort',{'type':_0x500b67(0x1e0),'common':{'name':'Train\x20Comfort','type':_0x500b67(0x1a4),'role':_0x500b67(0x1c3),'read':!![],'write':!![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x1d6),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x1a5),'type':_0x500b67(0x1c0),'role':_0x500b67(0x2ba),'read':!![],'write':![]},'native':{}}),await _0x3c518e['extendObjectAsync'](_0x500b67(0x1b7),{'type':_0x500b67(0x147),'common':{'name':_0x500b67(0x135)},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x1cf),{'type':'state','common':{'name':_0x500b67(0x274),'type':_0x500b67(0x168),'role':_0x500b67(0x1cc),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)]('analysis.security.currentThreshold',{'type':_0x500b67(0x1e0),'common':{'name':'Current\x20Threshold','type':_0x500b67(0x168),'role':_0x500b67(0x1cc),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x268),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x255),'type':_0x500b67(0x1c0),'role':_0x500b67(0x1a1),'read':!![],'write':![]},'native':{}}),await _0x3c518e['extendObjectAsync'](_0x500b67(0x2d1),{'type':'channel','common':{'name':_0x500b67(0x24e)},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x1e3),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x255),'type':_0x500b67(0x1c0),'role':_0x500b67(0x1a1),'read':!![],'write':![]},'native':{}}),await _0x3c518e['setObjectNotExistsAsync'](_0x500b67(0x20f),{'type':'state','common':{'name':_0x500b67(0x287),'type':_0x500b67(0x1a4),'role':_0x500b67(0x1d9),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)]('analysis.health.trendDiagnosis',{'type':'state','common':{'name':_0x500b67(0x1cd),'type':_0x500b67(0x1c0),'role':_0x500b67(0x2ba),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x1c6),{'type':'state','common':{'name':_0x500b67(0x2be),'type':_0x500b67(0x168),'role':'value','read':!![],'write':![]},'native':{}}),await _0x3c518e['extendObjectAsync'](_0x500b67(0x2c9),{'type':_0x500b67(0x147),'common':{'name':_0x500b67(0x2e5)},'native':{}}),await _0x3c518e['setObjectNotExistsAsync'](_0x500b67(0x2ec),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x1be),'type':'string','role':_0x500b67(0x2ba),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x169),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x23a),'type':_0x500b67(0x1c0),'role':_0x500b67(0x2ba),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x1a9)]('LTM',{'type':'channel','common':{'name':_0x500b67(0x2a4)},'native':{}}),await _0x3c518e[_0x500b67(0x1a9)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x500b67(0x16e),'type':_0x500b67(0x1c0),'role':_0x500b67(0x18c),'read':!![],'write':![]},'native':{}}),await _0x3c518e['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x2a3),'type':_0x500b67(0x1c0),'role':_0x500b67(0x18c),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)]('LTM.trainingData.sequences',{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x277),'type':'string','role':_0x500b67(0x18c),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x201),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x1c9),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x3c518e['setObjectNotExistsAsync']('analysis.trigger',{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x210),'type':_0x500b67(0x1a4),'role':_0x500b67(0x1c3),'read':!![],'write':!![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x21b),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x17b),'type':_0x500b67(0x1a4),'role':_0x500b67(0x1c3),'read':!![],'write':!![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x1ed),{'type':_0x500b67(0x1e0),'common':{'name':'Alert\x20Status','type':_0x500b67(0x1a4),'role':_0x500b67(0x214),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x240),{'type':'state','common':{'name':_0x500b67(0x22d),'type':_0x500b67(0x1c0),'role':_0x500b67(0x251),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x1b1),{'type':'state','common':{'name':_0x500b67(0x1c2),'type':_0x500b67(0x1c0),'role':_0x500b67(0x2ba),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x167),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x2aa),'type':_0x500b67(0x1a4),'role':_0x500b67(0x1d9),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x180),{'type':'state','common':{'name':'Description','type':_0x500b67(0x1c0),'role':_0x500b67(0x2ba),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)]('analysis.automation.detectedPatterns',{'type':'state','common':{'name':_0x500b67(0x28c),'type':'string','role':_0x500b67(0x18c),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)]('analysis.automation.targetId',{'type':'state','common':{'name':_0x500b67(0x1e8),'type':_0x500b67(0x1c0),'role':_0x500b67(0x2ba),'read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x197),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x217),'type':_0x500b67(0x1c0),'role':'text','read':!![],'write':![]},'native':{}}),await _0x3c518e[_0x500b67(0x211)](_0x500b67(0x29e),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x186),'type':_0x500b67(0x1a4),'role':_0x500b67(0x216),'read':!![],'write':!![]},'native':{}}),await _0x3c518e['setObjectNotExistsAsync'](_0x500b67(0x177),{'type':_0x500b67(0x1e0),'common':{'name':_0x500b67(0x1d0),'type':_0x500b67(0x1a4),'role':'button','read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x20e29d){const _0x3c2c05=a0_0x573f5f;try{const _0xc5d91b=await _0x20e29d[_0x3c2c05(0x1f9)](SYSTEM_DP_MODE);_0xc5d91b&&_0xc5d91b[_0x3c2c05(0x237)]&&Object[_0x3c2c05(0x23f)](SYSTEM_MODES)['includes'](_0xc5d91b[_0x3c2c05(0x237)])?_0x20e29d[_0x3c2c05(0x164)]=_0xc5d91b[_0x3c2c05(0x237)]:(_0x20e29d[_0x3c2c05(0x164)]=SYSTEM_MODES[_0x3c2c05(0x25c)],await _0x20e29d[_0x3c2c05(0x2e1)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3c2c05(0x25c)],'ack':!![]}));}catch(_0x42ca71){_0x20e29d['currentSystemMode']=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x466379){const _0x148037=a0_0x573f5f;try{const _0x2672f9=await _0x466379['getStateAsync'](LTM_DP_RAW_LOG);if(_0x2672f9&&_0x2672f9[_0x148037(0x237)])_0x466379[_0x148037(0x146)]=JSON[_0x148037(0x17e)](_0x2672f9['val']);}catch(_0x33b7da){_0x466379[_0x148037(0x146)]=[];}}async function saveRawEventLog(_0x4c1fbc){const _0x400546=a0_0x573f5f;if(_0x4c1fbc[_0x400546(0x146)][_0x400546(0x151)]>RAW_LOG_MAX_SIZE)_0x4c1fbc['rawEventLog']['splice'](0x0,_0x4c1fbc[_0x400546(0x146)][_0x400546(0x151)]-RAW_LOG_MAX_SIZE);await _0x4c1fbc[_0x400546(0x2e1)](LTM_DP_RAW_LOG,{'val':JSON[_0x400546(0x1f1)](_0x4c1fbc[_0x400546(0x146)]),'ack':!![]});}async function loadDailyDigests(_0x538ac1){const _0x5922c1=a0_0x573f5f;try{const _0x4e5840=await _0x538ac1[_0x5922c1(0x1f9)](LTM_DP_DAILY_DIGESTS);if(_0x4e5840&&_0x4e5840[_0x5922c1(0x237)])_0x538ac1[_0x5922c1(0x1f2)]=JSON[_0x5922c1(0x17e)](_0x4e5840[_0x5922c1(0x237)]);}catch(_0x4efa34){_0x538ac1[_0x5922c1(0x1f2)]=[];}await updateBaselineStatus(_0x538ac1);}async function saveDailyDigests(_0x2c4f34,_0x11e7ba=!![]){const _0x344a3a=a0_0x573f5f,_0x306415=_0x2c4f34[_0x344a3a(0x175)]['ltmLtbWindowDays']||0x3c;_0x2c4f34[_0x344a3a(0x1f2)][_0x344a3a(0x151)]>_0x306415&&_0x2c4f34[_0x344a3a(0x1f2)][_0x344a3a(0x1d8)](0x0,_0x2c4f34[_0x344a3a(0x1f2)][_0x344a3a(0x151)]-_0x306415);await _0x2c4f34['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x344a3a(0x1f1)](_0x2c4f34[_0x344a3a(0x1f2)]),'ack':!![]});if(_0x11e7ba)await updateBaselineStatus(_0x2c4f34);}async function updateAnalysisHistory(_0x2368b8,_0x7a1445){const _0x430aef=a0_0x573f5f;_0x2368b8[_0x430aef(0x28d)][_0x430aef(0x1c5)](_0x7a1445);if(_0x2368b8['analysisHistory'][_0x430aef(0x151)]>HISTORY_MAX_SIZE)_0x2368b8[_0x430aef(0x28d)]['pop']();await _0x2368b8[_0x430aef(0x2e1)](_0x430aef(0x13b),{'val':JSON[_0x430aef(0x1f1)](_0x2368b8[_0x430aef(0x28d)]),'ack':!![]});}async function updateBaselineStatus(_0x584b07){const _0x4ae110=a0_0x573f5f;if(!_0x584b07['isProVersion']){await _0x584b07[_0x4ae110(0x2e1)](LTM_DP_BASELINE_STATUS,{'val':_0x4ae110(0x1e1),'ack':!![]});return;}const _0x1457e0=_0x584b07[_0x4ae110(0x1f2)][_0x4ae110(0x151)]>=(_0x584b07[_0x4ae110(0x175)]['minDaysForBaseline']||0x7)?_0x4ae110(0x2ac)+_0x584b07[_0x4ae110(0x1f2)][_0x4ae110(0x151)]+'\x20Tage)':_0x4ae110(0x2cd)+_0x584b07[_0x4ae110(0x1f2)][_0x4ae110(0x151)]+'/'+(_0x584b07[_0x4ae110(0x175)][_0x4ae110(0x25f)]||0x7)+')';await _0x584b07[_0x4ae110(0x2e1)](LTM_DP_BASELINE_STATUS,{'val':_0x1457e0,'ack':!![]});}async function initSensorSubscriptions(_0x1d8680){const _0x208649=a0_0x573f5f,_0x28042a=_0x1d8680[_0x208649(0x175)][_0x208649(0x148)];if(_0x28042a)for(const _0x5c5dfc of _0x28042a){await _0x1d8680[_0x208649(0x192)](_0x5c5dfc['id']);}}async function initPresenceSubscriptions(_0x2d64a4){const _0x8c8e37=a0_0x573f5f,_0x113ce5=_0x2d64a4[_0x8c8e37(0x175)][_0x8c8e37(0x16c)];if(_0x113ce5)for(const _0x331995 of _0x113ce5){await _0x2d64a4[_0x8c8e37(0x192)](_0x331995);}}async function setupTelegramListener(_0x52bb45){const _0x3be30a=a0_0x573f5f,_0x57e565=_0x52bb45[_0x3be30a(0x175)][_0x3be30a(0x2c1)];if(_0x52bb45[_0x3be30a(0x175)][_0x3be30a(0x26c)]&&_0x57e565)await _0x52bb45[_0x3be30a(0x192)](_0x57e565+_0x3be30a(0x161));}async function checkWifiPresence(_0x436882){const _0x4bf78a=a0_0x573f5f;try{const _0x2c0728=_0x436882[_0x4bf78a(0x175)]['presenceDevices']||[];let _0x3b2d11=![];const _0x500ff7=[];for(const _0x5e75fb of _0x2c0728){try{const _0x1fd351=await _0x436882[_0x4bf78a(0x288)](_0x5e75fb);_0x1fd351&&(_0x1fd351['val']===!![]||_0x1fd351[_0x4bf78a(0x237)]===_0x4bf78a(0x1bd)||_0x1fd351[_0x4bf78a(0x237)]===0x1)&&(_0x3b2d11=!![],_0x500ff7['push'](_0x5e75fb));}catch(_0xc092af){}}return await _0x436882['setStateAsync'](_0x4bf78a(0x21e),{'val':_0x500ff7['join'](',\x20'),'ack':!![]}),_0x3b2d11&&(_0x436882[_0x4bf78a(0x1da)]&&(_0x436882[_0x4bf78a(0x281)][_0x4bf78a(0x2a8)](_0x4bf78a(0x26d)),abortExitTimer(_0x436882)),!_0x436882[_0x4bf78a(0x1b3)]&&_0x436882[_0x4bf78a(0x164)]===SYSTEM_MODES[_0x4bf78a(0x25c)]&&await setPresence(_0x436882,!![])),_0x3b2d11;}catch(_0x3b0747){return![];}}function startExitTimer(_0x2e0c67){const _0x39a790=a0_0x573f5f;abortExitTimer(_0x2e0c67),_0x2e0c67[_0x39a790(0x29b)]=!![],_0x2e0c67[_0x39a790(0x1b8)]=setTimeout(()=>{_0x2e0c67['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x2e0c67['exitTimer']=setTimeout(()=>{const _0x240703=_0x39a790;setPresence(_0x2e0c67,![]),_0x2e0c67[_0x240703(0x1da)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x4c4a14){const _0x5ac7a1=a0_0x573f5f;if(_0x4c4a14['exitTimer'])clearTimeout(_0x4c4a14[_0x5ac7a1(0x1da)]);if(_0x4c4a14['exitGraceTimer'])clearTimeout(_0x4c4a14[_0x5ac7a1(0x1b8)]);_0x4c4a14['exitTimer']=null,_0x4c4a14[_0x5ac7a1(0x1b8)]=null,_0x4c4a14[_0x5ac7a1(0x29b)]=![];}async function setPresence(_0x3cdd43,_0x3ad34d){const _0x93543d=a0_0x573f5f;if(_0x3cdd43['isPresent']===_0x3ad34d)return;_0x3cdd43[_0x93543d(0x1b3)]=_0x3ad34d,await _0x3cdd43[_0x93543d(0x2e1)](_0x93543d(0x260),{'val':_0x3ad34d,'ack':!![]});}async function executeAutomationAction(_0x15c504){const _0x3cf76f=a0_0x573f5f;try{const _0x3c070d=await _0x15c504[_0x3cf76f(0x1f9)](_0x3cf76f(0x224)),_0x406b08=await _0x15c504['getStateAsync'](_0x3cf76f(0x197));if(_0x3c070d&&_0x3c070d[_0x3cf76f(0x237)]&&_0x406b08){const _0x215041=_0x3c070d['val'];let _0x300362=_0x406b08[_0x3cf76f(0x237)];try{_0x300362=JSON[_0x3cf76f(0x17e)](_0x300362);}catch(_0x26b239){}_0x15c504['log'][_0x3cf76f(0x2a8)](_0x3cf76f(0x228)+_0x215041+_0x3cf76f(0x2ad)+_0x300362),await _0x15c504[_0x3cf76f(0x185)](_0x215041,_0x300362);}else _0x15c504[_0x3cf76f(0x281)]['warn'](_0x3cf76f(0x12f));}catch(_0x10b94c){_0x15c504[_0x3cf76f(0x281)][_0x3cf76f(0x2bb)](_0x3cf76f(0x173)+_0x10b94c[_0x3cf76f(0x232)]);}}async function processSensorEvent(_0x104f97,_0x56cc72,_0x4e1af8,_0x489712){const _0x1bda9c=a0_0x573f5f;if(!_0x489712)return;const _0x6aea6b=_0x4e1af8['val'],_0x61fcbf=Date['now'](),_0x7c0db=_0x104f97['sensorLastValues'][_0x56cc72];_0x104f97[_0x1bda9c(0x2cf)][_0x56cc72]=_0x6aea6b;if(!_0x489712[_0x1bda9c(0x165)]&&_0x7c0db!=undefined&&_0x7c0db==_0x6aea6b)return;const _0x4beac2=(_0x489712[_0x1bda9c(0x18b)]||'')[_0x1bda9c(0x23e)](),_0x42901a=_0x4beac2[_0x1bda9c(0x218)](_0x1bda9c(0x13a))||_0x4beac2[_0x1bda9c(0x218)](_0x1bda9c(0x241))||_0x4beac2[_0x1bda9c(0x218)](_0x1bda9c(0x25d))||_0x4beac2[_0x1bda9c(0x218)](_0x1bda9c(0x143));_0x104f97['isProVersion']&&_0x42901a&&recordThermodynamics(_0x104f97,_0x56cc72,_0x6aea6b,_0x489712[_0x1bda9c(0x1ea)]);const _0x523c1b={'timestamp':_0x61fcbf,'id':_0x56cc72,'name':_0x489712['name'],'type':_0x489712[_0x1bda9c(0x18b)],'location':_0x489712[_0x1bda9c(0x1ea)],'value':_0x6aea6b};_0x104f97['eventHistory']['unshift'](_0x523c1b);if(_0x104f97[_0x1bda9c(0x2b5)][_0x1bda9c(0x151)]>HISTORY_MAX_SIZE)_0x104f97['eventHistory'][_0x1bda9c(0x22a)]();await _0x104f97[_0x1bda9c(0x2e1)](_0x1bda9c(0x1a7),{'val':JSON[_0x1bda9c(0x1f1)](_0x523c1b),'ack':!![]}),await _0x104f97['setStateAsync'](_0x1bda9c(0x291),{'val':JSON['stringify'](_0x104f97[_0x1bda9c(0x2b5)]),'ack':!![]});_0x104f97[_0x1bda9c(0x231)]&&(_0x104f97[_0x1bda9c(0x146)][_0x1bda9c(0x23b)](_0x523c1b),await saveRawEventLog(_0x104f97),recordSequence(_0x104f97,_0x523c1b));if(_0x489712[_0x1bda9c(0x20c)]&&_0x6aea6b===!![]){if(_0x104f97[_0x1bda9c(0x1b3)]&&!_0x104f97[_0x1bda9c(0x29b)])startExitTimer(_0x104f97);else{if(!_0x104f97[_0x1bda9c(0x1b3)])setPresence(_0x104f97,!![]);}}else{if(_0x489712['type']===_0x1bda9c(0x293)&&_0x6aea6b===!![]){if(_0x104f97[_0x1bda9c(0x1da)])abortExitTimer(_0x104f97);if(!_0x104f97['isPresent']&&_0x104f97[_0x1bda9c(0x164)]===SYSTEM_MODES[_0x1bda9c(0x25c)])setPresence(_0x104f97,!![]);}}}async function recordThermodynamics(_0x54e66,_0x349001,_0x2ff76a,_0x242a9c){const _0x429d69=a0_0x573f5f,_0x16cb8a=await getOutsideTemperatureNumeric(_0x54e66),_0x38c68f=await _0x54e66[_0x429d69(0x1f9)](_0x429d69(0x201));let _0x59b8c0=[];if(_0x38c68f&&_0x38c68f[_0x429d69(0x237)])try{_0x59b8c0=JSON['parse'](_0x38c68f[_0x429d69(0x237)]);}catch(_0x2d059a){}_0x59b8c0[_0x429d69(0x23b)]({'ts':Date[_0x429d69(0x1fc)](),'room':_0x242a9c||_0x429d69(0x269),'t_in':_0x2ff76a,'t_out':_0x16cb8a});if(_0x59b8c0[_0x429d69(0x151)]>THERMO_LOG_SIZE)_0x59b8c0[_0x429d69(0x1a3)]();await _0x54e66[_0x429d69(0x2e1)](_0x429d69(0x201),{'val':JSON[_0x429d69(0x1f1)](_0x59b8c0),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x4e0f44){const _0x4018b9=a0_0x573f5f;if(_0x4e0f44[_0x4018b9(0x175)][_0x4018b9(0x2a6)])try{const _0xb3b97d=await _0x4e0f44[_0x4018b9(0x288)](_0x4e0f44['config'][_0x4018b9(0x2a6)]);if(_0xb3b97d&&_0xb3b97d[_0x4018b9(0x237)]!==undefined&&_0xb3b97d[_0x4018b9(0x237)]!==null)return parseFloat(_0xb3b97d[_0x4018b9(0x237)]);}catch(_0xd9a4b1){}const _0x508a9a=_0x4e0f44[_0x4018b9(0x175)]['weatherInstance'];if(!_0x4e0f44['config'][_0x4018b9(0x1e9)]||!_0x508a9a)return null;try{let _0x4e191d='';if(_0x508a9a[_0x4018b9(0x218)](_0x4018b9(0x226)))_0x4e191d=_0x508a9a+_0x4018b9(0x264);else{if(_0x508a9a[_0x4018b9(0x218)]('daswetter'))_0x4e191d=_0x508a9a+_0x4018b9(0x229);else{if(_0x508a9a[_0x4018b9(0x218)](_0x4018b9(0x272)))_0x4e191d=_0x508a9a+_0x4018b9(0x1f6);else{if(_0x508a9a[_0x4018b9(0x218)](_0x4018b9(0x19c)))_0x4e191d=_0x508a9a+_0x4018b9(0x285);}}}if(_0x4e191d){const _0x3138bf=await _0x4e0f44['getForeignStateAsync'](_0x4e191d);if(_0x3138bf&&_0x3138bf['val']!==undefined&&_0x3138bf['val']!==null)return parseFloat(_0x3138bf[_0x4018b9(0x237)]);}}catch(_0x36d40e){}return null;}async function recordSequence(_0x4f2dcd,_0x4ba1f9){const _0x285aed=a0_0x573f5f,_0x58735e=(_0x4ba1f9[_0x285aed(0x18b)]||'')[_0x285aed(0x23e)](),_0x885336=['motion',_0x285aed(0x21f),_0x285aed(0x1dd),_0x285aed(0x1c4),'occupancy',_0x285aed(0x193),_0x285aed(0x2a9),_0x285aed(0x21a),_0x285aed(0x198),_0x285aed(0x1ec),_0x285aed(0x280),_0x285aed(0x130),_0x285aed(0x13c),_0x285aed(0x216),'schalter','dimmer',_0x285aed(0x2b2)];if(!_0x885336[_0x285aed(0x14e)](_0x1228ab=>_0x58735e[_0x285aed(0x218)](_0x1228ab)))return;if(!_0x4ba1f9[_0x285aed(0x1cc)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x285aed(0x23b)]({'loc':_0x4ba1f9['location']||'Unknown','id':_0x4ba1f9['id'],'ts':Date[_0x285aed(0x1fc)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x4f2dcd);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x15c0d1){const _0x3599b3=a0_0x573f5f;try{const _0x3391dc=await _0x15c0d1['getStateAsync']('LTM.trainingData.sequences');let _0x29330e=[];if(_0x3391dc&&_0x3391dc[_0x3599b3(0x237)])try{_0x29330e=JSON['parse'](_0x3391dc[_0x3599b3(0x237)]);}catch(_0x3c5aa5){}const _0x149c3b=activeSequence[0x0]['ts'],_0x1b4498=activeSequence['map'](_0xba874b=>({'loc':_0xba874b[_0x3599b3(0x221)],'t_delta':Math[_0x3599b3(0x24f)]((_0xba874b['ts']-_0x149c3b)/0x3e8)})),_0x57e572={'timestamp':new Date(_0x149c3b)[_0x3599b3(0x2e8)](),'steps':_0x1b4498,'duration':Math[_0x3599b3(0x24f)]((activeSequence[activeSequence[_0x3599b3(0x151)]-0x1]['ts']-_0x149c3b)/0x3e8),'daytime':new Date(_0x149c3b)[_0x3599b3(0x1d5)]()};_0x29330e['push'](_0x57e572);if(_0x29330e[_0x3599b3(0x151)]>MAX_TRAINING_SET_SIZE)_0x29330e[_0x3599b3(0x1a3)]();await _0x15c0d1[_0x3599b3(0x2e1)](_0x3599b3(0x2d9),{'val':JSON[_0x3599b3(0x1f1)](_0x29330e),'ack':!![]}),runSecurityCheck(_0x15c0d1,_0x57e572);}catch(_0x26710e){_0x15c0d1[_0x3599b3(0x281)][_0x3599b3(0x2bb)](_0x3599b3(0x2c4)+_0x26710e[_0x3599b3(0x232)]);}}function runSecurityCheck(_0x10a563,_0x1070c0){const _0x59c460=a0_0x573f5f;if(!_0x10a563[_0x59c460(0x231)])return;sendToPython(_0x10a563,'ANALYZE_SEQUENCE',{'sequence':_0x1070c0});}function sendToPython(_0x1b7fd3,_0x3e0cdf,_0x168876={}){const _0x598b5c=a0_0x573f5f;if(!_0x1b7fd3[_0x598b5c(0x249)]||!_0x1b7fd3['pythonProcess'][_0x598b5c(0x1f5)][_0x598b5c(0x1af)])return;const _0x1a2486=JSON[_0x598b5c(0x1f1)]({'command':_0x3e0cdf,..._0x168876});try{_0x1b7fd3[_0x598b5c(0x249)][_0x598b5c(0x1f5)]['write'](_0x1a2486+'\x0a');}catch(_0x2a661a){}}function startPythonService(_0x31ca52){const _0x20eebe=a0_0x573f5f;let _0x12853c=_0x20eebe(0x233);if(fs[_0x20eebe(0x160)](PYTHON_EXE))_0x12853c=PYTHON_EXE;try{const _0x58add3=path[_0x20eebe(0x222)](__dirname,_0x20eebe(0x194),_0x20eebe(0x2c8));_0x31ca52[_0x20eebe(0x249)]=spawn(_0x12853c,[_0x58add3]),_0x31ca52[_0x20eebe(0x249)]['stdout']['on']('data',_0x44c7b8=>{const _0x512744=_0x20eebe,_0x4866ce=_0x44c7b8[_0x512744(0x176)]()['split']('\x0a');_0x4866ce['forEach'](_0x2fe125=>{const _0x163669=_0x512744,_0x5e48f6=_0x2fe125[_0x163669(0x2dc)]();if(!_0x5e48f6)return;if(_0x5e48f6[_0x163669(0x246)]('[LOG]'))_0x31ca52[_0x163669(0x281)][_0x163669(0x1ca)](_0x163669(0x171)+_0x5e48f6['substring'](0x5)[_0x163669(0x2dc)]());else{if(_0x5e48f6[_0x163669(0x246)](_0x163669(0x2b9)))try{const _0x340315=JSON[_0x163669(0x17e)](_0x5e48f6['substring'](0x8)[_0x163669(0x2dc)]());handlePythonResult(_0x31ca52,_0x340315);}catch(_0x1990e6){}}});}),_0x31ca52['pythonProcess']['on'](_0x20eebe(0x2d3),_0x38bc57=>{const _0x5ec910=_0x20eebe;_0x31ca52[_0x5ec910(0x249)]=null;});}catch(_0x323513){_0x31ca52[_0x20eebe(0x281)]['error'](_0x20eebe(0x23c)+_0x323513[_0x20eebe(0x232)]);}}function stopPythonService(_0x5b33d1){const _0x4a300d=a0_0x573f5f;if(_0x5b33d1[_0x4a300d(0x249)]){try{_0x5b33d1[_0x4a300d(0x249)][_0x4a300d(0x18f)]();}catch(_0x8fcc40){}_0x5b33d1[_0x4a300d(0x249)]=null;}}function handlePythonResult(_0x31f8dc,_0x314491){const _0x282512=a0_0x573f5f;if(_0x314491['type']==='PONG')_0x31f8dc['log'][_0x282512(0x1ca)]('üêç\x20Python\x20Pong');else{if(_0x314491[_0x282512(0x18b)]===_0x282512(0x1ac)){const {anomaly_score:_0x14cfc9,is_anomaly:_0x293493,threshold:_0x473d11,explanation:_0x511602}=_0x314491['payload'];_0x31f8dc[_0x282512(0x281)]['info'](_0x282512(0x2a0)+_0x14cfc9[_0x282512(0x188)](0x5)+'\x20->\x20'+(_0x293493?'ANOMALY':'OK')),_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x1cf),{'val':_0x14cfc9,'ack':!![]}),_0x31f8dc['setStateAsync']('analysis.security.lastCheck',{'val':new Date()['toISOString'](),'ack':!![]});if(_0x473d11)_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x184),{'val':_0x473d11,'ack':!![]});if(_0x293493){let _0x18d64a=_0x282512(0x206)+_0x14cfc9[_0x282512(0x188)](0x4)+')';if(_0x511602&&_0x511602!==_0x282512(0x269))_0x18d64a+=_0x282512(0x133)+_0x511602;_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x1ed),{'val':!![],'ack':!![]}),_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x240),{'val':_0x18d64a,'ack':!![]}),sendNotification(_0x31f8dc,_0x282512(0x253)+_0x18d64a,![],!![]);}}else{if(_0x314491[_0x282512(0x18b)]===_0x282512(0x299)){const _0x447d63=_0x314491[_0x282512(0x230)][_0x282512(0x153)]||'',_0x220c48=_0x314491[_0x282512(0x230)][_0x282512(0x19b)],_0x3009ae=_0x314491[_0x282512(0x230)][_0x282512(0x2b4)]?_0x282512(0x166)+new Date()[_0x282512(0x2e2)]()+'\x20('+_0x447d63+')':'Failed:\x20'+_0x314491[_0x282512(0x230)]['reason'];_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x1d6),{'val':_0x3009ae,'ack':!![]});if(_0x314491[_0x282512(0x230)]['success']&&_0x220c48)_0x31f8dc['setStateAsync'](_0x282512(0x184),{'val':_0x220c48,'ack':!![]});}else{if(_0x314491[_0x282512(0x18b)]==='COMFORT_RESULT'){const {patterns:_0x3fc34a}=_0x314491[_0x282512(0x230)];if(_0x3fc34a&&_0x3fc34a['length']>0x0){_0x31f8dc[_0x282512(0x281)][_0x282512(0x2a8)](_0x282512(0x1aa)+_0x3fc34a[_0x282512(0x151)]+'\x20new\x20patterns.'),_0x31f8dc[_0x282512(0x2e1)]('analysis.automation.detectedPatterns',{'val':JSON[_0x282512(0x1f1)](_0x3fc34a),'ack':!![]});const _0x10bc94=_0x3fc34a[0x0],_0x518b2c=_0x282512(0x289)+_0x10bc94[_0x282512(0x18a)]+'\x20('+(_0x10bc94['confidence']*0x64)['toFixed'](0x0)+'%)';_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x167),{'val':!![],'ack':!![]}),_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x180),{'val':_0x518b2c,'ack':!![]});}else _0x31f8dc[_0x282512(0x281)]['info']('üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x31f8dc['setStateAsync']('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x1bc),{'val':'[]','ack':!![]});}else{if(_0x314491[_0x282512(0x18b)]==='ENERGY_TRAIN_RESULT'){if(_0x314491[_0x282512(0x230)]['success'])try{const _0xd1813e=JSON[_0x282512(0x17e)](_0x314491[_0x282512(0x230)][_0x282512(0x153)]);if(_0xd1813e[_0x282512(0x2da)])_0x31f8dc['setStateAsync']('analysis.energy.insulationScore',{'val':JSON[_0x282512(0x1f1)](_0xd1813e[_0x282512(0x2da)]),'ack':!![]});if(_0xd1813e[_0x282512(0x162)])_0x31f8dc[_0x282512(0x2e1)](_0x282512(0x169),{'val':JSON[_0x282512(0x1f1)](_0xd1813e['heating']),'ack':!![]});}catch(_0x2caec0){}}else{if(_0x314491[_0x282512(0x18b)]===_0x282512(0x225)){if(_0x314491[_0x282512(0x230)]['success'])_0x31f8dc['log']['info'](_0x282512(0x15d));}else{if(_0x314491[_0x282512(0x18b)]===_0x282512(0x2d0))_0x31f8dc['setStateAsync'](_0x282512(0x1e3),{'val':new Date()[_0x282512(0x2e8)](),'ack':!![]}),_0x31f8dc['setStateAsync'](_0x282512(0x20f),{'val':_0x314491[_0x282512(0x230)][_0x282512(0x1eb)],'ack':!![]});else _0x314491['type']==='TREND_RESULT'&&(_0x31f8dc[_0x282512(0x2e1)]('analysis.health.trendDiagnosis',{'val':_0x314491[_0x282512(0x230)][_0x282512(0x17c)],'ack':!![]}),_0x31f8dc['setStateAsync'](_0x282512(0x1c6),{'val':_0x314491[_0x282512(0x230)]['change_percent'],'ack':!![]}));}}}}}}}function runPythonHealthCheck(_0x5620e3){const _0x3ac3f3=a0_0x573f5f;if(!_0x5620e3[_0x3ac3f3(0x1f2)]||_0x5620e3[_0x3ac3f3(0x1f2)][_0x3ac3f3(0x151)]<0x2)return;const _0x15c401=_0x5620e3[_0x3ac3f3(0x1f2)][_0x3ac3f3(0x2e0)](_0x476db7=>{const _0x3f0d4d=_0x3ac3f3,_0x982caa=(_0x476db7['activityLevel']||'')[_0x3f0d4d(0x23e)]();return ACTIVITY_LEVEL_MAP[_0x982caa]||0x32;});sendToPython(_0x5620e3,'ANALYZE_TREND',{'values':_0x15c401,'tag':'Activity-Level'});}async function handleTelegramResponse(_0x15b029,_0x83b7a2){const _0x98b057=a0_0x573f5f;let _0x23308e=_0x83b7a2;_0x83b7a2[_0x98b057(0x246)]('[')&&(_0x23308e=_0x83b7a2[_0x98b057(0x2b1)](_0x83b7a2[_0x98b057(0x284)](']')+0x1));if(_0x23308e===_0x98b057(0x1fa))await _0x15b029['setStateAsync'](_0x98b057(0x1ed),{'val':![],'ack':!![]}),await _0x15b029[_0x98b057(0x2e1)](_0x98b057(0x240),{'val':_0x98b057(0x252),'ack':!![]}),_0x15b029[_0x98b057(0x141)]=![],sendNotification(_0x15b029,_0x98b057(0x189),![]);else _0x23308e===_0x98b057(0x205)&&sendNotification(_0x15b029,'üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.',![],!![]);}async function sendNotification(_0x2737f3,_0x1eea6d,_0x116e20=![],_0x581d4c=![]){const _0x3ea2de=a0_0x573f5f,_0x112dd9=_0x2737f3[_0x3ea2de(0x175)];if(_0x112dd9[_0x3ea2de(0x26c)]){let _0x391ea3={};(_0x1eea6d[_0x3ea2de(0x218)](_0x3ea2de(0x220))||_0x581d4c)&&(_0x391ea3={'reply_markup':{'inline_keyboard':[[{'text':_0x3ea2de(0x1a8),'callback_data':_0x3ea2de(0x1fa)}],[{'text':_0x3ea2de(0x271),'callback_data':_0x3ea2de(0x205)}]]}}),await _0x2737f3[_0x3ea2de(0x19d)](_0x112dd9[_0x3ea2de(0x2c1)],'send',{'text':_0x1eea6d,'user':_0x112dd9[_0x3ea2de(0x137)],..._0x391ea3});}if(_0x112dd9[_0x3ea2de(0x1bb)]){let _0x7f5728={'message':_0x1eea6d,'title':_0x581d4c?_0x3ea2de(0x212):_0x3ea2de(0x19f),'priority':_0x581d4c?0x2:0x1,'device':_0x112dd9[_0x3ea2de(0x24a)]};_0x581d4c&&(_0x7f5728[_0x3ea2de(0x157)]=0x1e,_0x7f5728[_0x3ea2de(0x2d7)]=0xe10,_0x7f5728[_0x3ea2de(0x1ff)]='siren'),await _0x2737f3['sendToAsync'](_0x112dd9[_0x3ea2de(0x213)],_0x3ea2de(0x298),_0x7f5728);}_0x112dd9[_0x3ea2de(0x29d)]&&await _0x2737f3[_0x3ea2de(0x19d)](_0x112dd9['notifyEmailInstance'],_0x3ea2de(0x298),{'text':_0x1eea6d,'to':_0x112dd9[_0x3ea2de(0x2d2)]});}async function runGeminiAnalysis(_0x153dea,_0x4a7efb=''){const _0x2764af=a0_0x573f5f;if(!_0x153dea['geminiModel'])return;if(_0x153dea[_0x2764af(0x2b5)]['length']===0x0)return;const _0x6531dd=_0x153dea[_0x2764af(0x2b5)][_0x2764af(0x2b3)](0x0,0xf),_0x41adc2=await getWeatherContext(_0x153dea),_0x219c70=_0x153dea[_0x2764af(0x164)],_0x1115fc=PERSONA_MAPPING[_0x153dea[_0x2764af(0x175)]['aiPersona']||'generic'],_0x1a380f=_0x153dea[_0x2764af(0x175)][_0x2764af(0x149)]||_0x2764af(0x15c);let _0x4df4d9=_0x2764af(0x138);try{const _0x4bdd5d=await _0x153dea[_0x2764af(0x1f9)](_0x2764af(0x21e));if(_0x4bdd5d&&_0x4bdd5d[_0x2764af(0x237)])_0x4df4d9=_0x4bdd5d[_0x2764af(0x237)];}catch(_0xc504b7){}let _0x523e06=![];try{const _0x2dca23=await _0x153dea[_0x2764af(0x1f9)](_0x2764af(0x29e));if(_0x2dca23&&_0x2dca23[_0x2764af(0x237)])_0x523e06=!![];}catch(_0x191261){}const _0x8b3364=_0x2764af(0x170)+_0x1115fc+_0x2764af(0x279)+_0x1a380f+_0x2764af(0x1d3)+_0x219c70+_0x2764af(0x204)+_0x41adc2+_0x2764af(0x28e)+_0x4df4d9+_0x2764af(0x2a7)+JSON['stringify'](_0x6531dd)+_0x2764af(0x2c6)+_0x4a7efb+_0x2764af(0x2cc);try{const _0x30f70c=await _0x153dea[_0x2764af(0x295)][_0x2764af(0x258)](_0x8b3364),_0x1b281e=JSON[_0x2764af(0x17e)](_0x30f70c[_0x2764af(0x191)][_0x2764af(0x2ba)]()[_0x2764af(0x20a)](/```json|```/g,'')[_0x2764af(0x2dc)]());await _0x153dea['setStateAsync'](_0x2764af(0x2ab),{'val':JSON[_0x2764af(0x1f1)](_0x1b281e),'ack':!![]});if(_0x1b281e[_0x2764af(0x26b)])await _0x153dea[_0x2764af(0x2e1)](_0x2764af(0x1b1),{'val':_0x1b281e[_0x2764af(0x26b)],'ack':!![]});const _0x27cd11={'timestamp':Date[_0x2764af(0x1fc)](),'id':Date[_0x2764af(0x1fc)]()[_0x2764af(0x176)](),'analysis':{'activity':{'summary':_0x1b281e['summary'],'isAlert':_0x1b281e[_0x2764af(0x1fb)],'alertReason':_0x1b281e[_0x2764af(0x17d)]},'comfort':{'automationProposal':_0x1b281e['automationProposal']}}};await updateAnalysisHistory(_0x153dea,_0x27cd11);const _0x17dc89=_0x1b281e[_0x2764af(0x1fb)]||![];_0x17dc89!==_0x153dea[_0x2764af(0x141)]&&(await _0x153dea[_0x2764af(0x2e1)]('analysis.isAlert',{'val':_0x17dc89,'ack':!![]}),_0x153dea[_0x2764af(0x141)]=_0x17dc89,_0x17dc89&&(await _0x153dea[_0x2764af(0x2e1)](_0x2764af(0x240),{'val':_0x1b281e[_0x2764af(0x17d)],'ack':!![]}),sendNotification(_0x153dea,_0x2764af(0x15b)+_0x1b281e['alertReason'],![],_0x1b281e[_0x2764af(0x132)])));if(_0x1b281e[_0x2764af(0x20d)]&&_0x1b281e[_0x2764af(0x20d)][_0x2764af(0x1bf)]){await _0x153dea[_0x2764af(0x2e1)](_0x2764af(0x167),{'val':!![],'ack':!![]}),await _0x153dea[_0x2764af(0x2e1)](_0x2764af(0x180),{'val':_0x1b281e[_0x2764af(0x20d)][_0x2764af(0x181)],'ack':!![]}),await _0x153dea['setStateAsync'](_0x2764af(0x224),{'val':_0x1b281e[_0x2764af(0x20d)][_0x2764af(0x2b6)],'ack':!![]}),await _0x153dea[_0x2764af(0x2e1)]('analysis.automation.targetValue',{'val':JSON[_0x2764af(0x1f1)](_0x1b281e['automationProposal'][_0x2764af(0x2c7)]),'ack':!![]});if(_0x523e06)executeAutomationAction(_0x153dea);}}catch(_0x15f0ce){_0x153dea[_0x2764af(0x281)][_0x2764af(0x2bb)]('Gemini\x20Error:\x20'+_0x15f0ce[_0x2764af(0x232)]);}}async function createDailyDigest(_0x2a7bd5){const _0x3a7542=a0_0x573f5f;if(!_0x2a7bd5[_0x3a7542(0x231)])return;await _0x2a7bd5['setStateAsync'](LTM_DP_STATUS,{'val':_0x3a7542(0x145),'ack':!![]});if(!_0x2a7bd5['geminiModel']||_0x2a7bd5[_0x3a7542(0x146)][_0x3a7542(0x151)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2a7bd5['setStateAsync'](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0xc5bb81=JSON[_0x3a7542(0x17e)](JSON[_0x3a7542(0x1f1)](_0x2a7bd5['rawEventLog'])),_0x110a54=_0xc5bb81[_0x3a7542(0x151)],_0x557953=new Array(0x60)[_0x3a7542(0x259)](0x0),_0x5ae059=new Date()['setHours'](0x0,0x0,0x0,0x0);_0xc5bb81[_0x3a7542(0x278)](_0x5721ce=>{const _0x265203=_0x3a7542,_0x53101b=new Date(_0x5721ce[_0x265203(0x2cb)]),_0x4ebad8=_0x53101b[_0x265203(0x1d5)](),_0x5123bc=_0x53101b[_0x265203(0x16b)](),_0x4c1a78=_0x4ebad8*0x4+Math['floor'](_0x5123bc/0xf);if(_0x4c1a78>=0x0&&_0x4c1a78<0x60)_0x557953[_0x4c1a78]++;});const _0x3df1d3='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x3a7542(0x1f1)](_0xc5bb81[_0x3a7542(0x2b3)](0x0,0x32));try{const _0x34beba=await _0x2a7bd5[_0x3a7542(0x295)][_0x3a7542(0x258)](_0x3df1d3),_0x28d5ba=JSON[_0x3a7542(0x17e)](_0x34beba['response']['text']()[_0x3a7542(0x20a)](/```json|```/g,'')[_0x3a7542(0x2dc)]()),_0xcfe5ef={'timestamp':new Date()[_0x3a7542(0x2e8)](),'eventCount':_0x110a54,'summary':_0x28d5ba[_0x3a7542(0x26b)]||_0x3a7542(0x20e),'activityLevel':_0x28d5ba['activityLevel']||_0x3a7542(0x1dc),'systemMode':_0x2a7bd5[_0x3a7542(0x164)],'activityVector':_0x557953};_0x2a7bd5[_0x3a7542(0x1f2)][_0x3a7542(0x23b)](_0xcfe5ef),await saveDailyDigests(_0x2a7bd5),_0x2a7bd5['rawEventLog']=[],await saveRawEventLog(_0x2a7bd5),await _0x2a7bd5['setStateAsync'](LTM_DP_STATUS,{'val':'Success','ack':!![]});if(_0x2a7bd5['isProVersion'])sendToPython(_0x2a7bd5,_0x3a7542(0x263),{'digest':_0xcfe5ef});}catch(_0x5db04e){_0x2a7bd5['log']['error'](_0x5db04e[_0x3a7542(0x232)]);}}function setupLtmScheduler(_0x1a07a0){const _0x164d99=a0_0x573f5f;try{if(_0x1a07a0[_0x164d99(0x227)])_0x1a07a0[_0x164d99(0x227)][_0x164d99(0x20b)]();if(!_0x1a07a0[_0x164d99(0x231)])return;_0x1a07a0[_0x164d99(0x227)]=schedule[_0x164d99(0x15e)](LTM_SCHEDULE,()=>createDailyDigest(_0x1a07a0));}catch(_0x3db1fe){_0x1a07a0[_0x164d99(0x281)][_0x164d99(0x2bb)](_0x164d99(0x2a1)+_0x3db1fe[_0x164d99(0x232)]);}}function setupModeResetScheduler(_0x3b56cc){const _0x558489=a0_0x573f5f;try{if(_0x3b56cc[_0x558489(0x1f3)])_0x3b56cc[_0x558489(0x1f3)][_0x558489(0x20b)]();_0x3b56cc[_0x558489(0x1f3)]=schedule[_0x558489(0x15e)](MODE_RESET_SCHEDULE,async()=>{const _0x50cad9=_0x558489;await loadSystemMode(_0x3b56cc),AUTO_RESET_MODES[_0x50cad9(0x218)](_0x3b56cc[_0x50cad9(0x164)])&&await _0x3b56cc[_0x50cad9(0x2e1)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x50cad9(0x25c)],'ack':![]});});}catch(_0x59a39e){_0x3b56cc[_0x558489(0x281)][_0x558489(0x2bb)](_0x558489(0x182)+_0x59a39e['message']);}}function setupDriftAnalysisScheduler(_0x5dd21a){const _0x384c08=a0_0x573f5f;try{if(_0x5dd21a[_0x384c08(0x262)])clearInterval(_0x5dd21a[_0x384c08(0x262)]);if(!_0x5dd21a[_0x384c08(0x231)])return;_0x5dd21a[_0x384c08(0x262)]=setInterval(()=>runBaselineDriftAnalysis(_0x5dd21a),(_0x5dd21a[_0x384c08(0x175)][_0x384c08(0x2a2)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x5dd21a),0x1388);}catch(_0x1ac05a){_0x5dd21a[_0x384c08(0x281)][_0x384c08(0x2bb)](_0x384c08(0x2c0)+_0x1ac05a[_0x384c08(0x232)]);}}function setupBriefingScheduler(_0x43cdbd){const _0x3fe505=a0_0x573f5f;try{if(_0x43cdbd[_0x3fe505(0x1d4)])_0x43cdbd['briefingJob'][_0x3fe505(0x20b)]();if(!_0x43cdbd[_0x3fe505(0x175)]['briefingEnabled'])return;const _0x2e656e=(_0x43cdbd[_0x3fe505(0x175)][_0x3fe505(0x1ba)]||_0x3fe505(0x14a))[_0x3fe505(0x1b2)](':'),_0x465a6a=parseInt(_0x2e656e[0x0])||0x8,_0x1690fe=parseInt(_0x2e656e[0x1])||0x0,_0x1925c1=_0x1690fe+'\x20'+_0x465a6a+_0x3fe505(0x1cb);_0x43cdbd[_0x3fe505(0x1d4)]=schedule['scheduleJob'](_0x1925c1,()=>{sendMorningBriefing(_0x43cdbd);});}catch(_0x366169){_0x43cdbd[_0x3fe505(0x281)]['error'](_0x3fe505(0x286)+_0x366169['message']);}}async function runBaselineDriftAnalysis(_0x532d13){const _0x5cbdb9=a0_0x573f5f;if(!_0x532d13['isProVersion']||!_0x532d13[_0x5cbdb9(0x295)])return;const _0x33da22=_0x532d13[_0x5cbdb9(0x175)][_0x5cbdb9(0x178)]||0xe;if(_0x532d13['dailyDigests']['length']<_0x33da22+0x7){await _0x532d13[_0x5cbdb9(0x2e1)](LTM_DP_DRIFT_STATUS,{'val':_0x5cbdb9(0x207),'ack':!![]});return;}const _0x396b36=_0x532d13[_0x5cbdb9(0x1f2)]['slice'](-_0x33da22),_0x5c6df0=_0x532d13[_0x5cbdb9(0x1f2)]['slice'](0x0,_0x532d13[_0x5cbdb9(0x1f2)]['length']-_0x33da22),_0x43fc35='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x5cbdb9(0x1f1)](_0x5c6df0)+'\x0aSTB:\x20'+JSON[_0x5cbdb9(0x1f1)](_0x396b36);try{const _0x298856=await _0x532d13['geminiModel']['generateContent'](_0x43fc35),_0x5a8b6b=JSON[_0x5cbdb9(0x17e)](_0x298856[_0x5cbdb9(0x191)]['text']()[_0x5cbdb9(0x20a)](/```json|```/g,'')[_0x5cbdb9(0x2dc)]());_0x5a8b6b['baselineDrift']&&(await _0x532d13[_0x5cbdb9(0x2e1)](LTM_DP_DRIFT_STATUS,{'val':_0x5a8b6b[_0x5cbdb9(0x215)],'ack':!![]}),await _0x532d13[_0x5cbdb9(0x2e1)](LTM_DP_DRIFT_DETAILS,{'val':_0x5a8b6b[_0x5cbdb9(0x2af)],'ack':!![]}),await _0x532d13[_0x5cbdb9(0x2e1)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x5cbdb9(0x1fc)](),'ack':!![]}));}catch(_0x5b98f3){}}class CogniLiving extends utils['Adapter']{constructor(_0xdbc927){const _0x3148e1=a0_0x573f5f;super({..._0xdbc927,'name':'cogni-living'}),this[_0x3148e1(0x2b5)]=[],this[_0x3148e1(0x28d)]=[],this[_0x3148e1(0x146)]=[],this[_0x3148e1(0x1f2)]=[],this['sensorLastValues']={},this[_0x3148e1(0x29f)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x3148e1(0x1b3)]=!![],this['exitTimer']=null,this[_0x3148e1(0x1b8)]=null,this['isGracePeriodActive']=![],this[_0x3148e1(0x200)]=null,this['geminiModel']=null,this[_0x3148e1(0x164)]=SYSTEM_MODES[_0x3148e1(0x25c)],this[_0x3148e1(0x231)]=![],this['lastAlertState']=![],this[_0x3148e1(0x26a)]=_0x3148e1(0x14c),this[_0x3148e1(0x134)]=null,this[_0x3148e1(0x227)]=null,this[_0x3148e1(0x1f3)]=null,this[_0x3148e1(0x262)]=null,this[_0x3148e1(0x1d4)]=null,this['pythonProcess']=null,this[_0x3148e1(0x17f)]=![],this['on'](_0x3148e1(0x2ca),this[_0x3148e1(0x2e9)]['bind'](this)),this['on'](_0x3148e1(0x1e6),this[_0x3148e1(0x25a)]['bind'](this)),this['on'](_0x3148e1(0x2d4),this['onUnload'][_0x3148e1(0x13d)](this)),this['on']('message',this[_0x3148e1(0x1a2)][_0x3148e1(0x13d)](this));}async[a0_0x573f5f(0x2e9)](){const _0x417805=a0_0x573f5f;this[_0x417805(0x281)][_0x417805(0x2a8)](_0x417805(0x290)+this[_0x417805(0x24c)]+_0x417805(0x267));if(!checkAndInstall(this))return;await startSystem(this);}['onUnload'](_0xaf752d){const _0x232859=a0_0x573f5f;if(this[_0x232859(0x134)])clearInterval(this[_0x232859(0x134)]);if(this[_0x232859(0x262)])clearInterval(this[_0x232859(0x262)]);if(this[_0x232859(0x227)])this[_0x232859(0x227)]['cancel']();if(this['modeResetJob'])this[_0x232859(0x1f3)][_0x232859(0x20b)]();if(this[_0x232859(0x1d4)])this[_0x232859(0x1d4)][_0x232859(0x20b)]();if(this[_0x232859(0x1da)])clearTimeout(this[_0x232859(0x1da)]);if(this[_0x232859(0x1b8)])clearTimeout(this[_0x232859(0x1b8)]);stopPythonService(this),_0xaf752d();}async[a0_0x573f5f(0x25a)](_0x471bca,_0x151e7c){const _0x12e9b7=a0_0x573f5f;if(!_0x151e7c||this['dependencyInstallInProgress'])return;if(_0x471bca['includes'](_0x12e9b7(0x136))&&_0x471bca[_0x12e9b7(0x257)]('communicate.request')&&_0x151e7c[_0x12e9b7(0x237)]){await handleTelegramResponse(this,_0x151e7c[_0x12e9b7(0x237)]);return;}if(_0x471bca===this[_0x12e9b7(0x2bd)]+'.'+SYSTEM_DP_MODE){if(_0x151e7c[_0x12e9b7(0x237)]&&Object[_0x12e9b7(0x23f)](SYSTEM_MODES)['includes'](_0x151e7c[_0x12e9b7(0x237)])){this[_0x12e9b7(0x164)]=_0x151e7c[_0x12e9b7(0x237)];if(_0x151e7c[_0x12e9b7(0x237)]===SYSTEM_MODES[_0x12e9b7(0x1c8)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x151e7c['ack'])this[_0x12e9b7(0x266)](_0x471bca,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x151e7c['ack']){_0x471bca['includes']('analysis.trigger')&&_0x151e7c[_0x12e9b7(0x237)]&&(this[_0x12e9b7(0x266)](_0x471bca,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x471bca[_0x12e9b7(0x218)](_0x12e9b7(0x1f4))&&_0x151e7c[_0x12e9b7(0x237)]){this['setState'](_0x471bca,{'val':![],'ack':!![]});if(this[_0x12e9b7(0x231)])createDailyDigest(this);}_0x471bca[_0x12e9b7(0x218)](_0x12e9b7(0x1e4))&&_0x151e7c['val']&&(this[_0x12e9b7(0x266)](_0x471bca,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x471bca[_0x12e9b7(0x218)](_0x12e9b7(0x27f))&&_0x151e7c[_0x12e9b7(0x237)]&&(this[_0x12e9b7(0x266)](_0x471bca,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x471bca[_0x12e9b7(0x218)](_0x12e9b7(0x154))&&_0x151e7c[_0x12e9b7(0x237)]){this[_0x12e9b7(0x266)](_0x471bca,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x154a69=await this[_0x12e9b7(0x1f9)](_0x12e9b7(0x2d9));if(_0x154a69&&_0x154a69[_0x12e9b7(0x237)]){const _0x28c7ab=JSON[_0x12e9b7(0x17e)](_0x154a69[_0x12e9b7(0x237)]);this[_0x12e9b7(0x281)]['info'](_0x12e9b7(0x247)),this[_0x12e9b7(0x2e1)]('analysis.training.status',{'val':_0x12e9b7(0x2b7),'ack':!![]}),sendToPython(this,_0x12e9b7(0x27e),{'sequences':_0x28c7ab});}}catch(_0x4f6959){this[_0x12e9b7(0x281)][_0x12e9b7(0x2bb)](_0x12e9b7(0x2c5)+_0x4f6959['message']);}}if(_0x471bca[_0x12e9b7(0x218)]('analysis.training.triggerHealth')&&_0x151e7c[_0x12e9b7(0x237)]){this[_0x12e9b7(0x266)](_0x471bca,{'val':![],'ack':!![]});if(this[_0x12e9b7(0x231)])try{const _0x2442bf=await this[_0x12e9b7(0x1f9)](LTM_DP_DAILY_DIGESTS);if(_0x2442bf&&_0x2442bf[_0x12e9b7(0x237)])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0x12e9b7(0x17e)](_0x2442bf[_0x12e9b7(0x237)])});}catch(_0x43cde2){}}if(_0x471bca[_0x12e9b7(0x218)](_0x12e9b7(0x2e6))&&_0x151e7c['val']){this['setState'](_0x471bca,{'val':![],'ack':!![]});if(this[_0x12e9b7(0x231)])try{const _0x52becb=await this[_0x12e9b7(0x1f9)](_0x12e9b7(0x201));if(_0x52becb&&_0x52becb[_0x12e9b7(0x237)])sendToPython(this,_0x12e9b7(0x242),{'points':JSON[_0x12e9b7(0x17e)](_0x52becb[_0x12e9b7(0x237)])});}catch(_0x2500d5){}}if(_0x471bca[_0x12e9b7(0x218)]('analysis.training.triggerComfort')&&_0x151e7c[_0x12e9b7(0x237)]){this['setState'](_0x471bca,{'val':![],'ack':!![]});if(this[_0x12e9b7(0x231)])try{const _0x54530c=await this[_0x12e9b7(0x1f9)](LTM_DP_RAW_LOG);_0x54530c&&_0x54530c[_0x12e9b7(0x237)]&&(this[_0x12e9b7(0x281)][_0x12e9b7(0x2a8)]('üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...'),sendToPython(this,_0x12e9b7(0x296),{'events':JSON['parse'](_0x54530c['val'])}));}catch(_0x1ffbe1){}}return;}if(this['config'][_0x12e9b7(0x16c)]&&this[_0x12e9b7(0x175)][_0x12e9b7(0x16c)]['includes'](_0x471bca)){await checkWifiPresence(this);return;}const _0x2abd21=(this['config'][_0x12e9b7(0x148)]||[])['find'](_0x154a0b=>_0x154a0b['id']===_0x471bca);if(_0x2abd21)processSensorEvent(this,_0x471bca,_0x151e7c,_0x2abd21);}async[a0_0x573f5f(0x1a2)](_0x950684){const _0x2f56f9=a0_0x573f5f;if(typeof _0x950684==='object'&&_0x950684['message']){if(_0x950684[_0x2f56f9(0x18d)]==='testApiKey'){const _0x598542=_0x950684[_0x2f56f9(0x232)][_0x2f56f9(0x235)]||this[_0x2f56f9(0x175)][_0x2f56f9(0x2df)];if(!_0x598542)return this['sendTo'](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':![],'message':_0x2f56f9(0x28b)},_0x950684[_0x2f56f9(0x21c)]);try{const _0x1a390c=new GoogleGenerativeAI(_0x598542),_0x177cc7=_0x1a390c[_0x2f56f9(0x26f)]({'model':GEMINI_MODEL}),_0x5e1ab9=await _0x177cc7[_0x2f56f9(0x258)]('Hi');this[_0x2f56f9(0x256)](_0x950684['from'],_0x950684[_0x2f56f9(0x18d)],{'success':!![],'message':'OK:\x20'+_0x5e1ab9[_0x2f56f9(0x191)]['text']()},_0x950684['callback']);}catch(_0x58a476){this[_0x2f56f9(0x256)](_0x950684['from'],_0x950684[_0x2f56f9(0x18d)],{'success':![],'message':_0x2f56f9(0x1c1)+_0x58a476[_0x2f56f9(0x232)]},_0x950684[_0x2f56f9(0x21c)]);}}else{if(_0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x261)){const _0x20c653=await getWeatherContext(this),_0x886b6c=await getCalendarContext(this);this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':!![],'weather':_0x20c653,'calendar':_0x886b6c},_0x950684[_0x2f56f9(0x21c)]);}else{if(_0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x2e7)){if(!this[_0x2f56f9(0x231)])return this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':![],'isPro':![]},_0x950684[_0x2f56f9(0x21c)]);let _0x3ef73e={'status':_0x2f56f9(0x22f)};try{const _0x13d089=await this[_0x2f56f9(0x1f9)](LTM_DP_DRIFT_STATUS);_0x3ef73e['status']=_0x13d089?_0x13d089['val']:_0x2f56f9(0x22f);}catch(_0x1c3e86){}this[_0x2f56f9(0x256)](_0x950684['from'],_0x950684['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x2f56f9(0x1f2)],'driftAnalysis':_0x3ef73e,'analysisHistory':this[_0x2f56f9(0x28d)]},_0x950684[_0x2f56f9(0x21c)]);}else{if(_0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x16f)){const _0x40466e=this[_0x2f56f9(0x1f2)][_0x2f56f9(0x151)],_0x234319=new Date(),_0x1d2490=new Date(_0x234319['getFullYear'](),_0x234319[_0x2f56f9(0x254)](),_0x234319[_0x2f56f9(0x2dd)]())[_0x2f56f9(0x29c)](),_0x34a8af=this[_0x2f56f9(0x146)][_0x2f56f9(0x273)](_0x9a9604=>new Date(_0x9a9604['timestamp'])[_0x2f56f9(0x29c)]()>_0x1d2490)[_0x2f56f9(0x151)],_0x5e3a51=new Array(0x18)[_0x2f56f9(0x259)](0x0);this[_0x2f56f9(0x146)][_0x2f56f9(0x278)](_0xf35565=>{const _0x4ab331=_0x2f56f9,_0x47e590=new Date(_0xf35565[_0x4ab331(0x2cb)]);if(_0x47e590['getTime']()>_0x1d2490)_0x5e3a51[_0x47e590[_0x4ab331(0x1d5)]()]++;});let _0x50bc9c={'status':_0x2f56f9(0x22f)};try{const _0x51751a=await this[_0x2f56f9(0x1f9)](LTM_DP_DRIFT_STATUS);_0x50bc9c[_0x2f56f9(0x270)]=_0x51751a?_0x51751a[_0x2f56f9(0x237)]:'N/A';}catch(_0xe9aa7c){}let _0x312ddd='';try{const _0xc0c6d3=await this['getStateAsync'](_0x2f56f9(0x21e));_0x312ddd=_0xc0c6d3?_0xc0c6d3[_0x2f56f9(0x237)]:'';}catch(_0x120bb9){}let _0x1973b4=null;!this['geminiModel']&&(_0x1973b4=this[_0x2f56f9(0x175)][_0x2f56f9(0x2df)]?_0x2f56f9(0x24b):_0x2f56f9(0x14f));let _0x59418b={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x352d9b=await this[_0x2f56f9(0x1f9)](_0x2f56f9(0x167));if(_0x352d9b&&_0x352d9b['val']){_0x59418b['detected']=!![];const _0xc7cf56=await this[_0x2f56f9(0x1f9)](_0x2f56f9(0x180));_0x59418b[_0x2f56f9(0x181)]=_0xc7cf56?_0xc7cf56[_0x2f56f9(0x237)]:'';const _0x365a2e=await this['getStateAsync'](_0x2f56f9(0x224));_0x59418b['targetId']=_0x365a2e?_0x365a2e[_0x2f56f9(0x237)]:'';const _0x1f22ca=await this[_0x2f56f9(0x1f9)]('analysis.automation.targetValue');_0x59418b[_0x2f56f9(0x2c7)]=_0x1f22ca?_0x1f22ca[_0x2f56f9(0x237)]:'';}const _0x3dbfce=await this['getStateAsync'](_0x2f56f9(0x29e));_0x59418b[_0x2f56f9(0x2b8)]=_0x3dbfce?!!_0x3dbfce[_0x2f56f9(0x237)]:![];}catch(_0x384f3a){}this['sendTo'](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':!![],'eventHistory':this['eventHistory'][_0x2f56f9(0x2b3)](0x0,0xf),'stats':{'digestCount':_0x40466e,'eventCountToday':_0x34a8af,'hourlyActivity':_0x5e3a51,'driftStatus':_0x50bc9c[_0x2f56f9(0x270)],'isPresent':this[_0x2f56f9(0x1b3)],'presenceWho':_0x312ddd,'minDays':this['config'][_0x2f56f9(0x25f)]||0x7,'stbDays':this[_0x2f56f9(0x175)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x2f56f9(0x175)][_0x2f56f9(0x1e7)]||0x3c,'systemError':_0x1973b4},'automation':_0x59418b},_0x950684[_0x2f56f9(0x21c)]);}else{if(_0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x208))try{const _0x2eda0d=await scanForDevices(this,_0x950684[_0x2f56f9(0x232)]||{});this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':!![],'devices':_0x2eda0d},_0x950684['callback']);}catch(_0x2eed21){this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':![],'error':_0x2eed21['message']},_0x950684[_0x2f56f9(0x21c)]);}else{if(_0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x16d)){const _0x407bdc=await this[_0x2f56f9(0x2db)](_0x2f56f9(0x15f),_0x2f56f9(0x2d5)),_0x3db3a7=[];if(_0x407bdc)for(const _0xcd95c5 in _0x407bdc){const _0x1c3ff0=_0x407bdc[_0xcd95c5],_0x410b15=(_0x1c3ff0[_0x2f56f9(0x187)]&&typeof _0x1c3ff0[_0x2f56f9(0x187)][_0x2f56f9(0x275)]===_0x2f56f9(0x1b9)?_0x1c3ff0['common'][_0x2f56f9(0x275)]['de']:_0x1c3ff0['common'][_0x2f56f9(0x275)])||_0x1c3ff0[_0x2f56f9(0x187)][_0x2f56f9(0x275)];_0x3db3a7[_0x2f56f9(0x23b)]({'id':_0xcd95c5,'name':_0x410b15});}this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684['command'],{'success':!![],'enums':_0x3db3a7},_0x950684[_0x2f56f9(0x21c)]);}else{if(_0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x179)){const _0x4d011d=_0x950684['message'][_0x2f56f9(0x22c)];if(!_0x4d011d)return this['sendTo'](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':![],'error':'No\x20instance'},_0x950684[_0x2f56f9(0x21c)]);const _0x417171=await getCalendarNames(this,_0x4d011d);this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':!![],'names':_0x417171},_0x950684[_0x2f56f9(0x21c)]);}else{if(_0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x1d1)){const {targetId:_0x23f4dc,targetValue:_0xce743d}=_0x950684['message'];this[_0x2f56f9(0x281)][_0x2f56f9(0x2a8)]('üß™\x20Simulating\x20Butler\x20Proposal:\x20'+_0x23f4dc+'\x20=\x20'+_0xce743d),await this[_0x2f56f9(0x2e1)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x2f56f9(0x180),{'val':_0x2f56f9(0x2ea)+_0x23f4dc,'ack':!![]}),await this['setStateAsync']('analysis.automation.targetId',{'val':_0x23f4dc,'ack':!![]}),await this[_0x2f56f9(0x2e1)](_0x2f56f9(0x197),{'val':_0xce743d,'ack':!![]}),this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':!![]},_0x950684['callback']);}else{if(_0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x23d)){const {historyId:_0x906d07,rating:_0x4353de,comment:_0x2acf34,alertReason:_0x315d0b}=_0x950684[_0x2f56f9(0x232)];_0x906d07&&_0x4353de?(await saveFeedback(this,{'timestamp':Date[_0x2f56f9(0x1fc)](),'historyId':_0x906d07,'rating':_0x4353de,'comment':_0x2acf34,'alertReason':_0x315d0b}),this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':!![]},_0x950684[_0x2f56f9(0x21c)])):this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':![],'error':_0x2f56f9(0x25e)},_0x950684[_0x2f56f9(0x21c)]);}else _0x950684[_0x2f56f9(0x18d)]===_0x2f56f9(0x248)&&(this[_0x2f56f9(0x281)]['info'](_0x2f56f9(0x18e)),await this[_0x2f56f9(0x2e1)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x2f56f9(0x2e1)](_0x2f56f9(0x180),{'val':'','ack':!![]}),this[_0x2f56f9(0x256)](_0x950684[_0x2f56f9(0x1fd)],_0x950684[_0x2f56f9(0x18d)],{'success':!![]},_0x950684[_0x2f56f9(0x21c)]));}}}}}}}}}}}if(require[a0_0x573f5f(0x1d2)]!==module)module[a0_0x573f5f(0x1ef)]=_0x38a904=>new CogniLiving(_0x38a904);else new CogniLiving();