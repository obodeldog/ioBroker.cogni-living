const a0_0x481010=a0_0x3a74;(function(_0x34a830,_0x217406){const _0x43343e=a0_0x3a74,_0x40bbdb=_0x34a830();while(!![]){try{const _0x1576d4=parseInt(_0x43343e(0x278))/0x1+parseInt(_0x43343e(0x20d))/0x2+parseInt(_0x43343e(0x266))/0x3*(-parseInt(_0x43343e(0x16e))/0x4)+-parseInt(_0x43343e(0x192))/0x5+parseInt(_0x43343e(0x281))/0x6+parseInt(_0x43343e(0x85))/0x7+parseInt(_0x43343e(0x272))/0x8*(-parseInt(_0x43343e(0xab))/0x9);if(_0x1576d4===_0x217406)break;else _0x40bbdb['push'](_0x40bbdb['shift']());}catch(_0x426835){_0x40bbdb['push'](_0x40bbdb['shift']());}}}(a0_0x4e98,0x7a1ad));const a0_0x25ef60=(function(){let _0x40fa20=!![];return function(_0x55831b,_0xb6a64b){const _0x2db288=_0x40fa20?function(){if(_0xb6a64b){const _0x28316d=_0xb6a64b['apply'](_0x55831b,arguments);return _0xb6a64b=null,_0x28316d;}}:function(){};return _0x40fa20=![],_0x2db288;};}()),a0_0x3a081a=a0_0x25ef60(this,function(){const _0x54ca66=a0_0x3a74;return a0_0x3a081a[_0x54ca66(0x1dd)]()['search']('(((.+)+)+)+$')['toString']()['constructor'](a0_0x3a081a)[_0x54ca66(0x295)](_0x54ca66(0x237));});a0_0x3a081a();'use strict';const utils=require(a0_0x481010(0x17f)),{GoogleGenerativeAI}=require(a0_0x481010(0x1fb)),schedule=require(a0_0x481010(0x1d3)),{spawn,exec}=require(a0_0x481010(0x204)),path=require('path'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x481010(0x7a),LTM_SCHEDULE=a0_0x481010(0x1f4),MODE_RESET_SCHEDULE=a0_0x481010(0x1d2),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x481010(0x246),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x481010(0x161),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x481010(0x213),LTM_DP_DRIFT_STATUS=a0_0x481010(0x18b),LTM_DP_DRIFT_DETAILS=a0_0x481010(0x96),LTM_DP_DRIFT_LAST_CHECK=a0_0x481010(0x11a),SYSTEM_DP_MODE=a0_0x481010(0x9d),HARD_IGNORE_TERMS=[a0_0x481010(0x72),'scriptEnabled',a0_0x481010(0x257),a0_0x481010(0xeb),a0_0x481010(0xa4),'rssi','connection',a0_0x481010(0x189),a0_0x481010(0x191),a0_0x481010(0x26c),a0_0x481010(0x27d),a0_0x481010(0x8b),a0_0x481010(0xb7),a0_0x481010(0x1b3),a0_0x481010(0x2a2),a0_0x481010(0xb0),a0_0x481010(0x27c),a0_0x481010(0xd9)],BAD_NAMES=['targetposition','currentposition',a0_0x481010(0x98),a0_0x481010(0x17e),a0_0x481010(0x7b),'brightness','on',a0_0x481010(0x176),a0_0x481010(0x1ce),a0_0x481010(0xc1),a0_0x481010(0x267),a0_0x481010(0x248),a0_0x481010(0x1e4),a0_0x481010(0x1a2),'motion',a0_0x481010(0x2a3),'occupancy',a0_0x481010(0x18a),a0_0x481010(0x1af),a0_0x481010(0x188),a0_0x481010(0x287),'setpoint',a0_0x481010(0xe6),a0_0x481010(0x240),a0_0x481010(0xd1)],ADAPTER_BLACKLIST=[a0_0x481010(0x73),'admin.','info.','vis.',a0_0x481010(0x24b),a0_0x481010(0x212),a0_0x481010(0xa2),'flot.','echarts.','javascript.','simple-api.'],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x481010(0x130),'PARTY':'party','GUEST':a0_0x481010(0x76)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x481010(0x16f)],SYSTEM_MODES[a0_0x481010(0x200)]],PERSONA_MAPPING={'generic':a0_0x481010(0x8a),'senior_aal':a0_0x481010(0x165),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x481010(0x1a9),'security':'PRIORIT√ÑT:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x120fb7){const _0xa715c1=a0_0x481010;try{const _0x2d02d6=['analysis.history_debug_00',_0xa715c1(0xcf)];for(const _0x58f708 of _0x2d02d6){try{const _0x3e210a=await _0x120fb7['getObjectAsync'](_0x58f708);_0x3e210a&&await _0x120fb7[_0xa715c1(0x19b)](_0x58f708);}catch(_0x28fc34){}}}catch(_0x17cf10){}}async function initHistory(_0x1be10b){const _0x37eb58=a0_0x481010;try{const _0x3e284c=await _0x1be10b[_0x37eb58(0x1c3)](_0x37eb58(0xe7));_0x3e284c&&_0x3e284c[_0x37eb58(0x1e6)]&&(_0x1be10b[_0x37eb58(0xa0)]=JSON[_0x37eb58(0x25e)](_0x3e284c['val'][_0x37eb58(0x1dd)]()));}catch(_0x155854){_0x1be10b[_0x37eb58(0xa0)]=[];}try{const _0x42c1e9=await _0x1be10b[_0x37eb58(0x1c3)]('analysis.analysisHistory');if(_0x42c1e9&&_0x42c1e9['val'])_0x1be10b['analysisHistory']=JSON[_0x37eb58(0x25e)](_0x42c1e9['val'][_0x37eb58(0x1dd)]());}catch(_0x41581c){_0x1be10b['analysisHistory']=[];}if(_0x1be10b[_0x37eb58(0xa0)]&&_0x1be10b['eventHistory'][_0x37eb58(0x207)]>0x0){_0x1be10b['log']['info'](_0x37eb58(0x26b)+_0x1be10b[_0x37eb58(0xa0)][_0x37eb58(0x207)]+_0x37eb58(0xd5));for(let _0x142b71=_0x1be10b[_0x37eb58(0xa0)]['length']-0x1;_0x142b71>=0x0;_0x142b71--){const _0x4afa10=_0x1be10b[_0x37eb58(0xa0)][_0x142b71];_0x4afa10&&_0x4afa10['id']!==undefined&&_0x4afa10[_0x37eb58(0x7b)]!==undefined&&(_0x1be10b['sensorLastValues'][_0x4afa10['id']]=_0x4afa10['value']);}}}async function initSystemConfig(_0x51eef1){const _0x4021ba=a0_0x481010;try{const _0x5c1038=await _0x51eef1[_0x4021ba(0x11d)](_0x4021ba(0x182));_0x5c1038&&_0x5c1038[_0x4021ba(0x108)]&&(_0x51eef1[_0x4021ba(0x1d1)]={'latitude':_0x5c1038[_0x4021ba(0x108)][_0x4021ba(0x219)]||0x0,'longitude':_0x5c1038[_0x4021ba(0x108)][_0x4021ba(0x232)]||0x0,'city':_0x5c1038['common'][_0x4021ba(0x1eb)]||''});}catch(_0x4cde39){}}async function checkLicense(_0x4211d2,_0x781978){const _0x231d95=a0_0x481010;if(!_0x781978)return![];_0x4211d2[_0x231d95(0x242)]=await getSystemUUID(_0x4211d2);if(_0x781978===_0x231d95(0x9e)||_0x781978[_0x231d95(0x230)](_0x231d95(0xa3)))return!![];return![];}async function getSystemUUID(_0x559db3){const _0x2789fb=a0_0x481010;try{const _0x5b1ca6=await _0x559db3[_0x2789fb(0x11d)](_0x2789fb(0x141));if(_0x5b1ca6&&_0x5b1ca6[_0x2789fb(0x149)]&&_0x5b1ca6['native'][_0x2789fb(0x244)])return _0x5b1ca6[_0x2789fb(0x149)]['uuid'];return _0x2789fb(0x29c);}catch(_0x503956){return _0x2789fb(0xbc);}}async function createAllObjects(_0x2e4e80){const _0x51c9f7=a0_0x481010;await checkSystemObjects(_0x2e4e80),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x1d8),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0xcd),'type':'string','role':'text','read':!![],'write':![],'def':''},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('events.lastEvent',{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x97),'type':_0x51c9f7(0x27a),'role':'json','read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0xe7),{'type':_0x51c9f7(0x98),'common':{'name':'Event\x20History','type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x116),'read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x1d0),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x112),'type':_0x51c9f7(0x10f),'role':_0x51c9f7(0xf9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x290),{'type':_0x51c9f7(0x98),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x51c9f7(0x10f),'role':_0x51c9f7(0xf9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2e4e80['extendObjectAsync'](_0x51c9f7(0x274),{'type':_0x51c9f7(0x1b1),'common':{'name':'AI\x20Training\x20Control'},'native':{}}),await _0x2e4e80['setObjectNotExistsAsync']('analysis.training.triggerSecurity',{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x1c1),'type':_0x51c9f7(0x10f),'role':_0x51c9f7(0xf9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x270),{'type':'state','common':{'name':_0x51c9f7(0x15a),'type':'boolean','role':_0x51c9f7(0xf9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x93),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x196),'type':_0x51c9f7(0x10f),'role':_0x51c9f7(0xf9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2e4e80['setObjectNotExistsAsync'](_0x51c9f7(0x170),{'type':_0x51c9f7(0x98),'common':{'name':'Training\x20Status','type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![],'def':_0x51c9f7(0x175)},'native':{}}),await _0x2e4e80['extendObjectAsync']('analysis.security',{'type':_0x51c9f7(0x1b1),'common':{'name':_0x51c9f7(0x197)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x226),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x208),'type':_0x51c9f7(0x288),'role':'value','read':!![],'write':![],'def':0x0},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x1ef),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x27f),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x92),'read':!![],'write':![],'def':''},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0xc6),{'type':'state','common':{'name':'Health\x20Last\x20Check','type':_0x51c9f7(0x27a),'role':'date','read':!![],'write':![],'def':''},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x264),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x168),'type':_0x51c9f7(0x10f),'role':_0x51c9f7(0x124),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2e4e80['extendObjectAsync']('analysis.energy',{'type':_0x51c9f7(0x1b1),'common':{'name':_0x51c9f7(0x17c)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x9f),{'type':'state','common':{'name':'Building\x20Insulation\x20Score','type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('analysis.energy.heatingScore',{'type':'state','common':{'name':'Heating\x20Rate\x20Score','type':'string','role':_0x51c9f7(0x11e),'read':!![],'write':![],'def':_0x51c9f7(0x1d4)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x22d),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x1e9),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x116),'read':!![],'write':![]},'native':{}}),await _0x2e4e80['setObjectNotExistsAsync'](_0x51c9f7(0x1c8),{'type':'state','common':{'name':_0x51c9f7(0x142),'type':_0x51c9f7(0x10f),'role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0xa5),{'type':'state','common':{'name':_0x51c9f7(0x184),'type':_0x51c9f7(0x10f),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('analysis.alertReason',{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0xa9),'type':_0x51c9f7(0x27a),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x1f5),{'type':_0x51c9f7(0x98),'common':{'name':'Activity\x20Summary','type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x140),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x1dc),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x98),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x10e),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x25f),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x275),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x9b),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![]},'native':{}}),await _0x2e4e80['extendObjectAsync']('analysis.automation',{'type':_0x51c9f7(0x1b1),'common':{'name':_0x51c9f7(0x100)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x1bc),{'type':'state','common':{'name':_0x51c9f7(0x1ac),'type':_0x51c9f7(0x10f),'role':_0x51c9f7(0x1fe),'read':!![],'write':![],'def':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x163),{'type':'state','common':{'name':_0x51c9f7(0x22f),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('analysis.automation.suggestedAction',{'type':'state','common':{'name':_0x51c9f7(0x282),'type':'string','role':_0x51c9f7(0x11e),'read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('analysis.automation.targetId',{'type':_0x51c9f7(0x98),'common':{'name':'Target\x20ID','type':'string','role':_0x51c9f7(0x11e),'read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('analysis.automation.targetValue',{'type':'state','common':{'name':'Target\x20Value','type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x17a),{'type':_0x51c9f7(0x98),'common':{'name':'Auto\x20Apply\x20Rule','type':_0x51c9f7(0x10f),'role':'switch','read':!![],'write':!![],'def':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('analysis.automation.triggerAction',{'type':_0x51c9f7(0x98),'common':{'name':'Trigger\x20Action\x20Now','type':_0x51c9f7(0x10f),'role':_0x51c9f7(0xf9),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x21c),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x89),'type':'string','role':_0x51c9f7(0x116),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0xd0),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x245),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x116),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21a)]('analysis.health',{'type':_0x51c9f7(0x1b1),'common':{'name':_0x51c9f7(0xd8)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x137),{'type':_0x51c9f7(0x98),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x51c9f7(0x288),'role':_0x51c9f7(0xaf),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x126),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x1e1),'type':_0x51c9f7(0x27a),'role':'text','read':!![],'write':![],'def':_0x51c9f7(0x1fa)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0xff),{'type':_0x51c9f7(0x98),'common':{'name':'Health\x20Notes','type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![],'def':''},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('analysis.health.trendDiagnosis',{'type':'state','common':{'name':_0x51c9f7(0x222),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x11e),'read':!![],'write':![],'def':_0x51c9f7(0x1d4)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)](_0x51c9f7(0x271),{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x107),'type':'number','role':_0x51c9f7(0x7b),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x2e4e80['extendObjectAsync']('LTM.trainingData',{'type':'channel','common':{'name':_0x51c9f7(0x148)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('LTM.trainingData.sequences',{'type':_0x51c9f7(0x98),'common':{'name':'Recorded\x20Motion\x20Sequences','type':'string','role':_0x51c9f7(0x116),'read':!![],'write':![],'def':'[]','desc':_0x51c9f7(0x90)},'native':{}}),await _0x2e4e80[_0x51c9f7(0x21b)]('LTM.trainingData.thermodynamics',{'type':_0x51c9f7(0x98),'common':{'name':_0x51c9f7(0x28e),'type':_0x51c9f7(0x27a),'role':_0x51c9f7(0x116),'read':!![],'write':![],'def':'[]','desc':_0x51c9f7(0x292)},'native':{}}),await checkLtmObjects(_0x2e4e80),await checkLtmDriftObjects(_0x2e4e80);}async function checkSystemObjects(_0x5b2883){const _0x3b6baf=a0_0x481010;await _0x5b2883[_0x3b6baf(0x21a)]('system',{'type':_0x3b6baf(0x1b1),'common':{'name':_0x3b6baf(0x252)},'native':{}}),await _0x5b2883[_0x3b6baf(0x21a)](SYSTEM_DP_MODE,{'type':_0x3b6baf(0x98),'common':{'name':_0x3b6baf(0x152),'type':_0x3b6baf(0x27a),'role':_0x3b6baf(0x98),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x3b6baf(0x19f)],'states':{[SYSTEM_MODES[_0x3b6baf(0x19f)]]:_0x3b6baf(0x29e),[SYSTEM_MODES[_0x3b6baf(0x144)]]:_0x3b6baf(0x14a),[SYSTEM_MODES[_0x3b6baf(0x16f)]]:'Party',[SYSTEM_MODES[_0x3b6baf(0x200)]]:_0x3b6baf(0xfe)}},'native':{}});}async function checkLtmObjects(_0x826f61){const _0x28e6e3=a0_0x481010;await _0x826f61[_0x28e6e3(0x21a)](_0x28e6e3(0xce),{'type':_0x28e6e3(0x1b1),'common':{'name':_0x28e6e3(0xce)},'native':{}}),await _0x826f61[_0x28e6e3(0x21a)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x28e6e3(0x29a),'type':_0x28e6e3(0x27a),'role':_0x28e6e3(0x116),'read':!![],'write':![]},'native':{}}),await _0x826f61[_0x28e6e3(0x21a)](LTM_DP_DAILY_DIGESTS,{'type':_0x28e6e3(0x98),'common':{'name':_0x28e6e3(0x2a5),'type':_0x28e6e3(0x27a),'role':_0x28e6e3(0x116),'read':!![],'write':![]},'native':{}}),await _0x826f61[_0x28e6e3(0x21a)](LTM_DP_STATUS,{'type':_0x28e6e3(0x98),'common':{'name':_0x28e6e3(0xdb),'type':_0x28e6e3(0x27a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x826f61[_0x28e6e3(0x21a)](LTM_DP_TRIGGER_DIGEST,{'type':_0x28e6e3(0x98),'common':{'name':_0x28e6e3(0xac),'type':_0x28e6e3(0x10f),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x826f61['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x28e6e3(0x98),'common':{'name':_0x28e6e3(0x1cd),'type':_0x28e6e3(0x27a),'role':_0x28e6e3(0x11e),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x56607c){const _0x4fecff=a0_0x481010;await _0x56607c[_0x4fecff(0x21a)](LTM_DP_DRIFT_CHANNEL,{'type':_0x4fecff(0x1b1),'common':{'name':_0x4fecff(0x185)},'native':{}}),await _0x56607c[_0x4fecff(0x21a)](LTM_DP_DRIFT_STATUS,{'type':_0x4fecff(0x98),'common':{'name':_0x4fecff(0x229),'type':_0x4fecff(0x27a),'role':'state','read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x56607c['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x4fecff(0x98),'common':{'name':_0x4fecff(0x28c),'type':_0x4fecff(0x27a),'role':_0x4fecff(0x11e),'read':!![],'write':![]},'native':{}}),await _0x56607c[_0x4fecff(0x21a)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x4fecff(0x98),'common':{'name':_0x4fecff(0x19e),'type':'number','role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x115db6){const _0x24cfff=a0_0x481010;try{const _0x32d938=await _0x115db6['getStateAsync'](SYSTEM_DP_MODE);_0x32d938&&_0x32d938[_0x24cfff(0x1e6)]&&Object[_0x24cfff(0xf3)](SYSTEM_MODES)[_0x24cfff(0x1c5)](_0x32d938[_0x24cfff(0x1e6)])?_0x115db6['currentSystemMode']=_0x32d938[_0x24cfff(0x1e6)]:(_0x115db6[_0x24cfff(0x283)]=SYSTEM_MODES[_0x24cfff(0x19f)],await _0x115db6[_0x24cfff(0x77)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x24cfff(0x19f)],'ack':!![]}));}catch(_0x28c202){_0x115db6[_0x24cfff(0x283)]=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x3a5085){const _0x59e81b=a0_0x481010;try{const _0x4216c4=await _0x3a5085[_0x59e81b(0x1c3)](LTM_DP_RAW_LOG);if(_0x4216c4&&_0x4216c4[_0x59e81b(0x1e6)])_0x3a5085[_0x59e81b(0x27e)]=JSON['parse'](_0x4216c4[_0x59e81b(0x1e6)]);}catch(_0x503f46){_0x3a5085[_0x59e81b(0x27e)]=[];}}async function saveRawEventLog(_0x2c0f8d){const _0x28af91=a0_0x481010;_0x2c0f8d['rawEventLog'][_0x28af91(0x207)]>RAW_LOG_MAX_SIZE&&_0x2c0f8d['rawEventLog'][_0x28af91(0x138)](0x0,_0x2c0f8d[_0x28af91(0x27e)][_0x28af91(0x207)]-RAW_LOG_MAX_SIZE),await _0x2c0f8d[_0x28af91(0x77)](LTM_DP_RAW_LOG,{'val':JSON[_0x28af91(0x132)](_0x2c0f8d[_0x28af91(0x27e)]),'ack':!![]});}async function loadDailyDigests(_0x1dde55){const _0x100cdf=a0_0x481010;try{const _0x14c890=await _0x1dde55[_0x100cdf(0x1c3)](LTM_DP_DAILY_DIGESTS);if(_0x14c890&&_0x14c890['val'])_0x1dde55[_0x100cdf(0x109)]=JSON[_0x100cdf(0x25e)](_0x14c890[_0x100cdf(0x1e6)]);}catch(_0x4e48fa){_0x1dde55[_0x100cdf(0x109)]=[];}await updateBaselineStatus(_0x1dde55);}async function saveDailyDigests(_0x847f54,_0x547ef0=!![]){const _0x11cffe=a0_0x481010,_0x3325ac=_0x847f54[_0x11cffe(0x256)]['ltmLtbWindowDays']||0x3c;_0x847f54[_0x11cffe(0x109)]['length']>_0x3325ac&&_0x847f54[_0x11cffe(0x109)][_0x11cffe(0x138)](0x0,_0x847f54[_0x11cffe(0x109)][_0x11cffe(0x207)]-_0x3325ac);await _0x847f54[_0x11cffe(0x77)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x847f54[_0x11cffe(0x109)]),'ack':!![]});if(_0x547ef0)await updateBaselineStatus(_0x847f54);}async function updateAnalysisHistory(_0x3f2851,_0x3c3f71){const _0x5820dc=a0_0x481010;_0x3f2851[_0x5820dc(0x1e3)]['unshift'](_0x3c3f71);if(_0x3f2851['analysisHistory'][_0x5820dc(0x207)]>ANALYSIS_HISTORY_MAX_SIZE)_0x3f2851[_0x5820dc(0x1e3)][_0x5820dc(0x122)]();await _0x3f2851[_0x5820dc(0x77)](_0x5820dc(0x21c),{'val':JSON[_0x5820dc(0x132)](_0x3f2851['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x2ce290){const _0x99a3d5=a0_0x481010;if(!_0x2ce290[_0x99a3d5(0x211)]){await _0x2ce290['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x99a3d5(0x215),'ack':!![]});return;}const _0x1c11c2=_0x2ce290[_0x99a3d5(0x109)][_0x99a3d5(0x207)]>=(_0x2ce290[_0x99a3d5(0x256)][_0x99a3d5(0xf1)]||0x7)?_0x99a3d5(0x19d)+_0x2ce290[_0x99a3d5(0x109)]['length']+_0x99a3d5(0x14f):_0x99a3d5(0x18f)+_0x2ce290[_0x99a3d5(0x109)]['length']+'/'+(_0x2ce290['config']['minDaysForBaseline']||0x7)+')';await _0x2ce290['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x1c11c2,'ack':!![]});}async function initSensorSubscriptions(_0x48ebd0){const _0x457ea2=a0_0x481010,_0x5706f9=_0x48ebd0[_0x457ea2(0x256)][_0x457ea2(0x195)];if(_0x5706f9&&_0x5706f9[_0x457ea2(0x207)]>0x0){_0x48ebd0[_0x457ea2(0x162)]['info']('Subscribing\x20to\x20'+_0x5706f9[_0x457ea2(0x207)]+_0x457ea2(0x74));for(const _0x4767b7 of _0x5706f9){if(_0x4767b7['id']){await _0x48ebd0[_0x457ea2(0xfa)](_0x4767b7['id']);try{const _0x3165c1=await _0x48ebd0['getForeignStateAsync'](_0x4767b7['id']);if(_0x3165c1)_0x48ebd0[_0x457ea2(0x15d)][_0x4767b7['id']]=_0x3165c1[_0x457ea2(0x1e6)];}catch(_0x36d168){}}}}}async function initPresenceSubscriptions(_0x262223){const _0x2c6eb4=a0_0x481010,_0x2e4d6a=_0x262223[_0x2c6eb4(0x256)]['presenceDevices']||[];if(_0x2e4d6a[_0x2c6eb4(0x207)]>0x0){_0x262223[_0x2c6eb4(0x162)][_0x2c6eb4(0x221)](_0x2c6eb4(0x228)+_0x2e4d6a[_0x2c6eb4(0x207)]+_0x2c6eb4(0x7d));for(const _0x11dd6d of _0x2e4d6a){await _0x262223['subscribeForeignStatesAsync'](_0x11dd6d);}try{await checkWifiPresence(_0x262223);}catch(_0x320702){}}}async function getWeatherContext(_0x35c1eb){const _0x240806=a0_0x481010;try{if(!_0x35c1eb[_0x240806(0x256)]['useWeather'])return'Wetter:\x20Deaktiviert';let _0x131710='';const _0x283175=_0x35c1eb['config'][_0x240806(0x16a)];if(_0x283175)try{if(_0x283175[_0x240806(0x1c5)](_0x240806(0x15f))){const _0x42489d=await _0x35c1eb[_0x240806(0x104)](_0x283175+'.Summary.Current');if(_0x42489d&&_0x42489d[_0x240806(0x1e6)])_0x131710=_0x42489d[_0x240806(0x1e6)];}else{if(_0x283175['includes'](_0x240806(0x238))){const _0x10a1fb=await _0x35c1eb['getForeignStateAsync'](_0x283175+_0x240806(0x253));if(_0x10a1fb&&_0x10a1fb['val'])_0x131710=_0x10a1fb['val'];}else{if(_0x283175[_0x240806(0x1c5)](_0x240806(0x24e))){const _0x1f84f9=await _0x35c1eb[_0x240806(0x104)](_0x283175+_0x240806(0x131));if(_0x1f84f9&&_0x1f84f9['val'])_0x131710=_0x1f84f9[_0x240806(0x1e6)];}}}}catch(_0x39dd34){}if(!_0x131710){const _0x4045af=[_0x240806(0x23b),_0x240806(0x269),'weatherunderground.0',_0x240806(0x7f)];for(const _0x1840ae of _0x4045af){try{const _0x3f0d3b=await _0x35c1eb[_0x240806(0x11d)](_0x1840ae);if(_0x3f0d3b){if(_0x1840ae['includes'](_0x240806(0x15f))){const _0x4d2806=await _0x35c1eb[_0x240806(0x104)](_0x1840ae+_0x240806(0x28f));if(_0x4d2806&&_0x4d2806[_0x240806(0x1e6)]){_0x131710=_0x4d2806['val'];break;}}}}catch(_0x4b2c0e){}}}return _0x131710?_0x240806(0x1df)+_0x131710:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x2de80d){return _0x240806(0x118)+_0x2de80d['message'];}}async function getCalendarContext(_0x3511eb){const _0x353de7=a0_0x481010;try{if(!_0x3511eb[_0x353de7(0x256)][_0x353de7(0x217)])return _0x353de7(0x17b);let _0x1f5b96=_0x3511eb['config']['calendarInstance']||_0x353de7(0x1b0),_0xf1483b=_0x3511eb[_0x353de7(0x256)][_0x353de7(0xfd)]||[];if(typeof _0xf1483b===_0x353de7(0x27a))_0xf1483b=_0xf1483b[_0x353de7(0x284)](',');try{const _0x476f39=await _0x3511eb['getForeignStateAsync'](_0x1f5b96+'.data.table');if(_0x476f39&&_0x476f39[_0x353de7(0x1e6)]){let _0x2019e5=tryParse(_0x476f39['val']);if(_0x2019e5&&Array['isArray'](_0x2019e5)){if(_0xf1483b['length']>0x0)_0x2019e5=_0x2019e5['filter'](_0xfce93d=>_0xf1483b['includes'](_0xfce93d[_0x353de7(0x12b)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x2019e5['length']>0x0){const _0x202d17=_0x2019e5[_0x353de7(0x79)](0x0,0x3)[_0x353de7(0x206)](_0x5ebe7d=>{const _0x28ac60=_0x353de7;let _0x1f0edc=_0x5ebe7d[_0x28ac60(0x92)];if(_0x5ebe7d[_0x28ac60(0x95)])_0x1f0edc+='\x20'+_0x5ebe7d[_0x28ac60(0x95)];return _0x1f0edc+':\x20'+_0x5ebe7d[_0x28ac60(0x166)]+'\x20('+_0x5ebe7d[_0x28ac60(0x12b)]+')';});return'KALENDER:\x20'+_0x202d17[_0x353de7(0x160)](_0x353de7(0x83));}else return _0x353de7(0x236);}}}catch(_0x87c0dd){_0x3511eb[_0x353de7(0x162)][_0x353de7(0x12a)](_0x353de7(0x243)+_0x87c0dd[_0x353de7(0x13e)]);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x479f26){return _0x353de7(0x258)+_0x479f26[_0x353de7(0x13e)];}}async function getCalendarNames(_0x4c4af8,_0x5057d8){const _0x32ead9=a0_0x481010;try{const _0x211563=await _0x4c4af8[_0x32ead9(0x104)](_0x5057d8+_0x32ead9(0x23e));if(_0x211563&&_0x211563[_0x32ead9(0x1e6)]){const _0x44a333=tryParse(_0x211563[_0x32ead9(0x1e6)]);if(_0x44a333&&Array[_0x32ead9(0x75)](_0x44a333)){const _0x5bfbcb=[...new Set(_0x44a333['map'](_0x47eed0=>_0x47eed0[_0x32ead9(0x12b)])[_0x32ead9(0x1d9)](Boolean))];return _0x5bfbcb[_0x32ead9(0x26e)]();}}return[];}catch(_0x5a6066){return _0x4c4af8[_0x32ead9(0x162)][_0x32ead9(0x191)]('getCalendarNames\x20Error:\x20'+_0x5a6066[_0x32ead9(0x13e)]),[];}}async function checkWifiPresence(_0x1ca491){const _0x4ad2e4=a0_0x481010;try{const _0x1d17e3=_0x1ca491[_0x4ad2e4(0x256)][_0x4ad2e4(0x250)]||[];let _0x41fac8=![];const _0x24ebf4=[];for(const _0x2adf7d of _0x1d17e3){try{const _0x58bb10=await _0x1ca491['getForeignStateAsync'](_0x2adf7d);if(_0x58bb10&&(_0x58bb10[_0x4ad2e4(0x1e6)]===!![]||_0x58bb10[_0x4ad2e4(0x1e6)]===_0x4ad2e4(0x1aa)||_0x58bb10[_0x4ad2e4(0x1e6)]===0x1)){_0x41fac8=!![];const _0x2afb40=await _0x1ca491['getForeignObjectAsync'](_0x2adf7d);let _0xc9c232=_0x2adf7d;_0x2afb40&&_0x2afb40[_0x4ad2e4(0x108)]&&_0x2afb40['common'][_0x4ad2e4(0x2a0)]&&(_0xc9c232=typeof _0x2afb40[_0x4ad2e4(0x108)][_0x4ad2e4(0x2a0)]===_0x4ad2e4(0x265)?_0x2afb40['common']['name']['de']||_0x2afb40[_0x4ad2e4(0x108)][_0x4ad2e4(0x2a0)]['en']:_0x2afb40['common'][_0x4ad2e4(0x2a0)]),_0x24ebf4[_0x4ad2e4(0xf4)](_0xc9c232);}}catch(_0x333d21){}}return await _0x1ca491[_0x4ad2e4(0x77)](_0x4ad2e4(0x1d8),{'val':_0x24ebf4['join'](',\x20'),'ack':!![]}),_0x41fac8&&(_0x1ca491[_0x4ad2e4(0x1da)]&&(_0x1ca491['log'][_0x4ad2e4(0x221)](_0x4ad2e4(0x259)),abortExitTimer(_0x1ca491)),!_0x1ca491['isPresent']&&_0x1ca491[_0x4ad2e4(0x283)]===SYSTEM_MODES[_0x4ad2e4(0x19f)]&&await setPresence(_0x1ca491,!![])),_0x41fac8;}catch(_0x5e2472){return _0x1ca491[_0x4ad2e4(0x162)][_0x4ad2e4(0x191)](_0x4ad2e4(0x12c)+_0x5e2472[_0x4ad2e4(0x13e)]),![];}}function startExitTimer(_0x2024d4){const _0xd9ce61=a0_0x481010;abortExitTimer(_0x2024d4),_0x2024d4[_0xd9ce61(0x11c)]=!![],_0x2024d4[_0xd9ce61(0x1b6)]=setTimeout(()=>{const _0x4a5b4d=_0xd9ce61;_0x2024d4[_0x4a5b4d(0x11c)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x2024d4['exitTimer']=setTimeout(()=>{const _0x18e801=_0xd9ce61;setPresence(_0x2024d4,![]),_0x2024d4[_0x18e801(0x1da)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x498b4e){const _0x18f8eb=a0_0x481010;if(_0x498b4e[_0x18f8eb(0x1da)])clearTimeout(_0x498b4e[_0x18f8eb(0x1da)]);if(_0x498b4e[_0x18f8eb(0x1b6)])clearTimeout(_0x498b4e['exitGraceTimer']);_0x498b4e['exitTimer']=null,_0x498b4e['exitGraceTimer']=null,_0x498b4e['isGracePeriodActive']=![];}async function setPresence(_0x1ec10b,_0x10da12){const _0x31b201=a0_0x481010;if(_0x1ec10b[_0x31b201(0x114)]===_0x10da12)return;_0x1ec10b['isPresent']=_0x10da12,await _0x1ec10b['setStateAsync']('system.isPresent',{'val':_0x10da12,'ack':!![]});}async function saveFeedback(_0x5252a1,_0x33a049){const _0x539fb7=a0_0x481010;_0x5252a1['log'][_0x539fb7(0x221)]('Feedback\x20saved:\x20'+JSON[_0x539fb7(0x132)](_0x33a049));}async function runBaselineDriftAnalysis(_0x3b4b13){const _0x1a0191=a0_0x481010;if(!_0x3b4b13[_0x1a0191(0x211)]||!_0x3b4b13[_0x1a0191(0x1a1)])return;const _0x1da6cb=_0x3b4b13[_0x1a0191(0x256)][_0x1a0191(0x28d)]||0xe;if(_0x3b4b13[_0x1a0191(0x109)][_0x1a0191(0x207)]<_0x1da6cb+(_0x3b4b13['config']['minDaysForBaseline']||0x7)){await _0x3b4b13['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x1a0191(0x71),'ack':!![]});return;}const _0x37a983=_0x3b4b13[_0x1a0191(0x109)][_0x1a0191(0x79)](-_0x1da6cb),_0x24948e=_0x3b4b13['dailyDigests'][_0x1a0191(0x79)](0x0,_0x3b4b13['dailyDigests']['length']-_0x1da6cb),_0x4686de='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x1a0191(0x132)](_0x24948e)+'\x0aSTB:\x20'+JSON['stringify'](_0x37a983);try{const _0x2c0506=await _0x3b4b13[_0x1a0191(0x1a1)][_0x1a0191(0x1db)](_0x4686de),_0x4d0deb=JSON['parse'](_0x2c0506[_0x1a0191(0x227)][_0x1a0191(0x11e)]()[_0x1a0191(0x21d)](/```json|```/g,'')[_0x1a0191(0xb9)]());_0x4d0deb[_0x1a0191(0x26a)]&&(await _0x3b4b13['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x4d0deb[_0x1a0191(0x26a)],'ack':!![]}),await _0x3b4b13[_0x1a0191(0x77)](LTM_DP_DRIFT_DETAILS,{'val':_0x4d0deb['driftDetails'],'ack':!![]}),await _0x3b4b13[_0x1a0191(0x77)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x527b30){}}function setupLtmScheduler(_0x2281bf){const _0xf3cfac=a0_0x481010;try{if(_0x2281bf[_0xf3cfac(0xc0)])_0x2281bf[_0xf3cfac(0xc0)][_0xf3cfac(0x15e)]();if(!_0x2281bf[_0xf3cfac(0x211)]){_0x2281bf['setStateAsync'](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x2281bf[_0xf3cfac(0xc0)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x2281bf));}catch(_0x101e43){_0x2281bf[_0xf3cfac(0x162)][_0xf3cfac(0x191)](_0xf3cfac(0x103)+_0x101e43[_0xf3cfac(0x13e)]);}}function setupModeResetScheduler(_0x9e820c){const _0x3e0346=a0_0x481010;try{if(_0x9e820c[_0x3e0346(0x13d)])_0x9e820c[_0x3e0346(0x13d)]['cancel']();_0x9e820c[_0x3e0346(0x13d)]=schedule[_0x3e0346(0x10a)](MODE_RESET_SCHEDULE,async()=>{const _0x5ddedf=_0x3e0346;await loadSystemMode(_0x9e820c),AUTO_RESET_MODES['includes'](_0x9e820c[_0x5ddedf(0x283)])&&await _0x9e820c['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x5ddedf(0x19f)],'ack':![]});});}catch(_0x29bcaa){_0x9e820c[_0x3e0346(0x162)][_0x3e0346(0x191)](_0x3e0346(0x21e)+_0x29bcaa[_0x3e0346(0x13e)]);}}function a0_0x3a74(_0x16d071,_0x35bdc9){const _0x174097=a0_0x4e98();return a0_0x3a74=function(_0x3a081a,_0x25ef60){_0x3a081a=_0x3a081a-0x71;let _0x4e98a1=_0x174097[_0x3a081a];return _0x4e98a1;},a0_0x3a74(_0x16d071,_0x35bdc9);}function setupDriftAnalysisScheduler(_0x13a407){const _0x565254=a0_0x481010;try{if(_0x13a407[_0x565254(0x29b)])clearInterval(_0x13a407[_0x565254(0x29b)]);if(!_0x13a407['isProVersion'])return;_0x13a407['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x13a407),(_0x13a407[_0x565254(0x256)][_0x565254(0xe9)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x13a407),0x1388);}catch(_0x239db1){_0x13a407['log'][_0x565254(0x191)]('Drift\x20Sched\x20Error:\x20'+_0x239db1[_0x565254(0x13e)]);}}function setupBriefingScheduler(_0x90204){const _0x15e67b=a0_0x481010;try{if(_0x90204[_0x15e67b(0x1fc)])_0x90204[_0x15e67b(0x1fc)][_0x15e67b(0x15e)]();if(!_0x90204[_0x15e67b(0x256)][_0x15e67b(0xd4)])return;const _0x5a4330=(_0x90204[_0x15e67b(0x256)]['briefingTime']||_0x15e67b(0x22a))[_0x15e67b(0x284)](':'),_0x3b06d6=parseInt(_0x5a4330[0x0])||0x8,_0x4bab3b=parseInt(_0x5a4330[0x1])||0x0,_0x1020c4=_0x4bab3b+'\x20'+_0x3b06d6+_0x15e67b(0xea);_0x90204['log']['info'](_0x15e67b(0x21f)+_0x3b06d6+':'+(_0x4bab3b<0xa?'0'+_0x4bab3b:_0x4bab3b)),_0x90204[_0x15e67b(0x1fc)]=schedule[_0x15e67b(0x10a)](_0x1020c4,()=>{sendMorningBriefing(_0x90204);});}catch(_0x1fbd79){_0x90204['log'][_0x15e67b(0x191)](_0x15e67b(0x14c)+_0x1fbd79[_0x15e67b(0x13e)]);}}async function sendNotification(_0x1b43a4,_0x37e9ae,_0x2dacaa=![],_0x1d3159=![]){const _0x34623f=a0_0x481010;_0x1b43a4[_0x34623f(0x162)][_0x34623f(0x221)]((_0x2dacaa?_0x34623f(0x194):'')+_0x34623f(0x158)+_0x37e9ae+'\x22');const _0x13f4f1=_0x1b43a4[_0x34623f(0x256)];let _0x17198d=0x0;if(_0x13f4f1[_0x34623f(0xf2)]){let _0x396baf={};(_0x37e9ae[_0x34623f(0x1c5)]('Alarm')||_0x1d3159)&&(_0x396baf={'reply_markup':{'inline_keyboard':[[{'text':'‚úÖ\x20Alles\x20OK\x20(Reset)]','callback_data':_0x34623f(0x1c9)}],[{'text':_0x34623f(0x153),'callback_data':_0x34623f(0x255)}]]}}),await _0x1b43a4[_0x34623f(0x202)](_0x13f4f1[_0x34623f(0x26f)],_0x34623f(0x203),{'text':_0x37e9ae,'user':_0x13f4f1[_0x34623f(0xc4)],..._0x396baf}),_0x17198d++;}if(_0x13f4f1[_0x34623f(0xbf)]){let _0x105ccb={'message':_0x37e9ae,'title':_0x1d3159?_0x34623f(0x291):_0x34623f(0xa6),'priority':_0x1d3159?0x2:0x1,'device':_0x13f4f1[_0x34623f(0x28b)]};_0x1d3159&&(_0x105ccb[_0x34623f(0xd2)]=0x1e,_0x105ccb['expire']=0xe10,_0x105ccb[_0x34623f(0xc5)]='siren'),await _0x1b43a4[_0x34623f(0x202)](_0x13f4f1[_0x34623f(0xe8)],_0x34623f(0x203),_0x105ccb),_0x17198d++;}return _0x13f4f1[_0x34623f(0x1ca)]&&(await _0x1b43a4[_0x34623f(0x202)](_0x13f4f1[_0x34623f(0x251)],'send',{'text':_0x37e9ae,'to':_0x13f4f1['notifyEmailRecipient']}),_0x17198d++),_0x17198d;}async function setupTelegramListener(_0x179b98){const _0x9cbf62=a0_0x481010,_0x5bcca4=_0x179b98[_0x9cbf62(0x256)][_0x9cbf62(0x26f)];_0x179b98['config'][_0x9cbf62(0xf2)]&&_0x5bcca4&&(_0x179b98[_0x9cbf62(0x162)][_0x9cbf62(0x221)]('üì°\x20Hooking\x20into\x20'+_0x5bcca4+_0x9cbf62(0x1cb)),await _0x179b98[_0x9cbf62(0xfa)](_0x5bcca4+_0x9cbf62(0x220)));}async function handleTelegramResponse(_0x59625f,_0x9280e0){const _0x3d0c4f=a0_0x481010;let _0x1fcb1d=_0x9280e0;_0x9280e0[_0x3d0c4f(0x230)]('[')&&(_0x1fcb1d=_0x9280e0[_0x3d0c4f(0x88)](_0x9280e0['indexOf'](']')+0x1));if(_0x1fcb1d===_0x3d0c4f(0x1c9))_0x59625f[_0x3d0c4f(0x162)][_0x3d0c4f(0x221)](_0x3d0c4f(0x247)),await _0x59625f['setStateAsync'](_0x3d0c4f(0x1c8),{'val':![],'ack':!![]}),await _0x59625f[_0x3d0c4f(0x77)](_0x3d0c4f(0x84),{'val':_0x3d0c4f(0x8d),'ack':!![]}),_0x59625f['lastAlertState']=![],sendNotification(_0x59625f,_0x3d0c4f(0x18e),![]);else _0x1fcb1d===_0x3d0c4f(0x255)&&(_0x59625f[_0x3d0c4f(0x162)][_0x3d0c4f(0x12a)](_0x3d0c4f(0x294)),sendNotification(_0x59625f,'üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.',![],!![]));}async function runAutopilot(_0x324fed){const _0x1dbfd1=a0_0x481010,_0x1ee55f=_0x324fed[_0x1dbfd1(0x256)][_0x1dbfd1(0x199)],_0x327066=_0x324fed[_0x1dbfd1(0xa0)][_0x1dbfd1(0x207)]>0x0?_0x324fed[_0x1dbfd1(0xa0)][0x0][_0x1dbfd1(0x276)]:Date['now'](),_0x20c389=(Date[_0x1dbfd1(0x129)]()-_0x327066)/(0x3e8*0x3c*0x3c);let _0x14a22c='';_0x324fed[_0x1dbfd1(0x256)]['inactivityMonitoringEnabled']&&_0x324fed[_0x1dbfd1(0x283)]===SYSTEM_MODES['NORMAL']&&_0x324fed[_0x1dbfd1(0x114)]&&(_0x20c389>_0x1ee55f&&(_0x14a22c=_0x1dbfd1(0xf0)+_0x20c389['toFixed'](0x1)+_0x1dbfd1(0x117))),runGeminiAnalysis(_0x324fed,_0x14a22c)['catch'](_0x5ae18a=>_0x324fed[_0x1dbfd1(0x162)]['error'](_0x5ae18a));}async function createDailyDigest(_0x426b7f){const _0xb928b5=a0_0x481010;if(!_0x426b7f['isProVersion'])return;await _0x426b7f[_0xb928b5(0x77)](LTM_DP_STATUS,{'val':_0xb928b5(0xd3)+new Date()[_0xb928b5(0xda)](),'ack':!![]});if(!_0x426b7f[_0xb928b5(0x1a1)]||_0x426b7f[_0xb928b5(0x27e)][_0xb928b5(0x207)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x426b7f[_0xb928b5(0x77)](LTM_DP_STATUS,{'val':_0xb928b5(0x86),'ack':!![]});return;}const _0x4f609b=JSON[_0xb928b5(0x25e)](JSON[_0xb928b5(0x132)](_0x426b7f[_0xb928b5(0x27e)])),_0xd8c8eb=_0x4f609b[_0xb928b5(0x207)],_0x2f4ad7=_0xb928b5(0x1bb)+JSON['stringify'](_0x4f609b);try{const _0x13e3b9=await _0x426b7f[_0xb928b5(0x1a1)]['generateContent'](_0x2f4ad7),_0x2d85b7=JSON[_0xb928b5(0x25e)](_0x13e3b9[_0xb928b5(0x227)][_0xb928b5(0x11e)]()[_0xb928b5(0x21d)](/```json|```/g,'')['trim']());if(_0x2d85b7['summary']){const _0xadd800={'timestamp':new Date()[_0xb928b5(0xaa)](),'eventCount':_0xd8c8eb,'summary':_0x2d85b7[_0xb928b5(0x241)],'activityLevel':_0x2d85b7[_0xb928b5(0x123)],'systemMode':_0x426b7f[_0xb928b5(0x283)]};_0x426b7f[_0xb928b5(0x109)][_0xb928b5(0xf4)](_0xadd800),await saveDailyDigests(_0x426b7f),_0x426b7f[_0xb928b5(0x27e)]=[],await saveRawEventLog(_0x426b7f),await _0x426b7f[_0xb928b5(0x77)](LTM_DP_STATUS,{'val':_0xb928b5(0x1ae)+_0xd8c8eb+_0xb928b5(0xad),'ack':!![]}),_0x426b7f[_0xb928b5(0x211)]&&(_0x426b7f[_0xb928b5(0x162)][_0xb928b5(0x221)](_0xb928b5(0xdc)),sendToPython(_0x426b7f,_0xb928b5(0x1f7),{'digest':_0xadd800}));}}catch(_0x3c15d4){await _0x426b7f['setStateAsync'](LTM_DP_STATUS,{'val':_0xb928b5(0xa8)+_0x3c15d4[_0xb928b5(0x13e)],'ack':!![]});}}async function sendMorningBriefing(_0x2f67df){const _0x1d7e46=a0_0x481010;if(!_0x2f67df[_0x1d7e46(0x1a1)])return;_0x2f67df[_0x1d7e46(0x162)][_0x1d7e46(0x221)](_0x1d7e46(0x223));const _0x5a0cd6=_0x2f67df[_0x1d7e46(0x109)][_0x1d7e46(0x207)]>0x0?_0x2f67df[_0x1d7e46(0x109)][_0x2f67df['dailyDigests'][_0x1d7e46(0x207)]-0x1]:null,_0x25c517=_0x5a0cd6&&_0x5a0cd6[_0x1d7e46(0x10b)]?_0x5a0cd6[_0x1d7e46(0x10b)][_0x1d7e46(0x280)]:_0x1d7e46(0x1d4),_0x3b1668=new Date();_0x3b1668[_0x1d7e46(0x29f)](0x4,0x0,0x0,0x0);const _0x1135dc=_0x2f67df['eventHistory']['filter'](_0x1a1cea=>new Date(_0x1a1cea['timestamp'])>_0x3b1668),_0x3a17a6=PERSONA_MAPPING[_0x2f67df[_0x1d7e46(0x256)][_0x1d7e46(0xc7)]||_0x1d7e46(0xf6)],_0x15c53f=_0x2f67df['config'][_0x1d7e46(0x25b)]||'',_0x503f39=await getWeatherContext(_0x2f67df),_0x2dec70=await getCalendarContext(_0x2f67df),_0x1047bc=_0x1d7e46(0x254)+_0x3a17a6+_0x1d7e46(0x1ed)+_0x15c53f+_0x1d7e46(0x121)+_0x503f39+'\x20'+_0x2dec70+_0x1d7e46(0x171)+_0x25c517+_0x1d7e46(0xef)+JSON[_0x1d7e46(0x132)](_0x1135dc[_0x1d7e46(0x79)](0x0,0xa))+_0x1d7e46(0x261);try{const _0x1e8c96=await _0x2f67df['geminiModel'][_0x1d7e46(0x1db)](_0x1047bc),_0xf8fe7=_0x1d7e46(0x1ab)+_0x1e8c96[_0x1d7e46(0x227)][_0x1d7e46(0x11e)]()[_0x1d7e46(0xb9)]();sendNotification(_0x2f67df,_0xf8fe7),_0x2f67df[_0x1d7e46(0x162)][_0x1d7e46(0x221)](_0x1d7e46(0x1a3));}catch(_0x1fa8eb){_0x2f67df[_0x1d7e46(0x162)][_0x1d7e46(0x191)]('Briefing\x20Error:\x20'+_0x1fa8eb['message']);}}async function scanForDevices(_0x2343f0,_0xde8c00){const _0x5b624e=a0_0x481010;_0x2343f0['log'][_0x5b624e(0x221)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x2368b7=[],_0x4d2588=await _0x2343f0[_0x5b624e(0x179)]('*'),_0x345075=await _0x2343f0[_0x5b624e(0x179)](_0x5b624e(0x10c),_0x5b624e(0x1be)),_0x437fd4=await _0x2343f0[_0x5b624e(0x179)](_0x5b624e(0xc9),_0x5b624e(0x1be)),_0x4fb082={};if(_0x345075)for(const _0x1857ee in _0x345075){const _0xa3cb30=_0x345075[_0x1857ee][_0x5b624e(0x108)][_0x5b624e(0xa7)]||[];_0xa3cb30['forEach'](_0x11ce14=>{if(!_0x4fb082[_0x11ce14])_0x4fb082[_0x11ce14]=[];_0x4fb082[_0x11ce14]['push'](_0x1857ee);});}const _0x21defc={};if(_0x437fd4)for(const _0x1fa5bc in _0x437fd4){const _0x29f273=_0x437fd4[_0x1fa5bc][_0x5b624e(0x108)][_0x5b624e(0xa7)]||[],_0x2c2772=typeof _0x437fd4[_0x1fa5bc][_0x5b624e(0x108)][_0x5b624e(0x2a0)]==='object'?_0x437fd4[_0x1fa5bc][_0x5b624e(0x108)]['name']['de']:_0x437fd4[_0x1fa5bc]['common'][_0x5b624e(0x2a0)];_0x29f273['forEach'](_0x39f217=>_0x21defc[_0x39f217]=_0x2c2772);}const _0x3221ae=_0xde8c00['selectedFunctionIds']||[],_0x2b6a07=_0xde8c00[_0x5b624e(0x15c)]!==![],_0x2a07a7=_0xde8c00[_0x5b624e(0x218)]!==![],_0x70c7ca=_0xde8c00['lights']!==![],_0x3639db=_0xde8c00[_0x5b624e(0x18a)]===!![],_0x38dc0e=_0xde8c00[_0x5b624e(0x16b)]===!![];for(const _0x5ae35d in _0x4d2588){const _0x28819d=_0x4d2588[_0x5ae35d];if(_0x28819d[_0x5b624e(0x102)]!=='state'||!_0x28819d['common'])continue;if(ADAPTER_BLACKLIST[_0x5b624e(0xbe)](_0x5ea515=>_0x5ae35d[_0x5b624e(0x230)](_0x5ea515))&&!_0x38dc0e)continue;const _0x25052a=(_0x28819d[_0x5b624e(0x108)][_0x5b624e(0x23c)]||'')[_0x5b624e(0x299)]();let _0xe73067=(typeof _0x28819d['common'][_0x5b624e(0x2a0)]===_0x5b624e(0x265)?_0x28819d[_0x5b624e(0x108)]['name']['de']:_0x28819d['common'][_0x5b624e(0x2a0)])||_0x5ae35d;const _0x55b284=_0xe73067['toLowerCase']();let _0x51e026=![],_0x595a64=![];if(_0x3221ae[_0x5b624e(0x207)]>0x0){const _0x146889=_0x4fb082[_0x5ae35d]||[],_0x3608a3=_0x5ae35d[_0x5b624e(0x284)]('.')[_0x5b624e(0x79)](0x0,-0x1)[_0x5b624e(0x160)]('.'),_0x312891=_0x4fb082[_0x3608a3]||[];(_0x146889[_0x5b624e(0xbe)](_0x17dd1b=>_0x3221ae[_0x5b624e(0x1c5)](_0x17dd1b))||_0x312891[_0x5b624e(0xbe)](_0x450e0d=>_0x3221ae['includes'](_0x450e0d)))&&(_0x51e026=!![],_0x595a64=!![]);}if(!_0x51e026&&!_0x38dc0e){if(HARD_IGNORE_TERMS['some'](_0x12f4d2=>_0x5ae35d[_0x5b624e(0x1c5)](_0x12f4d2)||_0x55b284[_0x5b624e(0x1c5)](_0x12f4d2[_0x5b624e(0x299)]())))continue;}if(BAD_NAMES['some'](_0x468fd6=>_0x55b284===_0x468fd6||_0x55b284[_0x5b624e(0xbd)]('.'+_0x468fd6))){const _0x98952b=_0x5ae35d[_0x5b624e(0x284)]('.');if(_0x98952b['length']>0x2){const _0x2b1459=_0x98952b[_0x5b624e(0x79)](0x0,-0x1)['join']('.'),_0x23b102=_0x4d2588[_0x2b1459];if(_0x23b102&&_0x23b102['common']&&_0x23b102[_0x5b624e(0x108)][_0x5b624e(0x2a0)]){const _0x228067=typeof _0x23b102[_0x5b624e(0x108)][_0x5b624e(0x2a0)]===_0x5b624e(0x265)?_0x23b102[_0x5b624e(0x108)][_0x5b624e(0x2a0)]['de']:_0x23b102['common'][_0x5b624e(0x2a0)];_0x228067&&!_0xe73067[_0x5b624e(0x1c5)](_0x228067)&&(_0xe73067=_0x228067+'\x20'+_0xe73067);}}}let _0x3ee815='';if(_0x2b6a07&&(_0x25052a['includes']('motion')||_0x25052a['includes']('occupancy')||_0x55b284[_0x5b624e(0x1c5)](_0x5b624e(0x14e))||_0x55b284[_0x5b624e(0x1c5)](_0x5b624e(0x125))))_0x3ee815=_0x5b624e(0x15c);else{if(!_0x3ee815&&_0x2a07a7&&(_0x25052a[_0x5b624e(0x1c5)](_0x5b624e(0x231))||_0x25052a[_0x5b624e(0x1c5)]('window')||_0x25052a['includes'](_0x5b624e(0x78))||_0x25052a['includes'](_0x5b624e(0x248))||_0x25052a[_0x5b624e(0x1c5)](_0x5b624e(0x267))||_0x55b284[_0x5b624e(0x1c5)](_0x5b624e(0x23f))||_0x55b284[_0x5b624e(0x1c5)]('t√ºr')||_0x55b284[_0x5b624e(0x1c5)](_0x5b624e(0x87))))_0x3ee815='door';else{if(!_0x3ee815&&_0x70c7ca&&(_0x25052a[_0x5b624e(0x1c5)](_0x5b624e(0x1ea))||_0x25052a[_0x5b624e(0x1c5)]('switch')||_0x25052a[_0x5b624e(0x1c5)](_0x5b624e(0x173))||_0x55b284[_0x5b624e(0x1c5)](_0x5b624e(0x135))||_0x55b284[_0x5b624e(0x1c5)]('lampe')||_0x55b284[_0x5b624e(0x1c5)](_0x5b624e(0x1f8)))){if(_0x28819d[_0x5b624e(0x108)]['write']||_0x25052a['includes'](_0x5b624e(0x279)))_0x3ee815='light';}else{if(!_0x3ee815&&_0x3639db&&(_0x25052a[_0x5b624e(0x1c5)](_0x5b624e(0x18a))||_0x25052a['includes']('humidity')||_0x25052a[_0x5b624e(0x1c5)]('thermostat')||_0x55b284[_0x5b624e(0x1c5)](_0x5b624e(0x1ee))||_0x55b284[_0x5b624e(0x1c5)](_0x5b624e(0x8c))||_0x55b284[_0x5b624e(0x1c5)]('heizung')))_0x3ee815=_0x5b624e(0x18a);else{if(!_0x3ee815&&_0x595a64)_0x3ee815=_0x5b624e(0x105);}}}}if(_0x3ee815){let _0x46706d=_0x21defc[_0x5ae35d]||'';if(!_0x46706d){let _0xb72bee=_0x5ae35d;for(let _0xbdea9=0x0;_0xbdea9<0x3;_0xbdea9++){const _0x2ee9ff=_0xb72bee[_0x5b624e(0x24a)]('.');if(_0x2ee9ff===-0x1)break;_0xb72bee=_0xb72bee[_0x5b624e(0x88)](0x0,_0x2ee9ff);if(_0x21defc[_0xb72bee]){_0x46706d=_0x21defc[_0xb72bee];break;}}}_0x2368b7[_0x5b624e(0xf4)]({'id':_0x5ae35d,'name':_0xe73067,'location':_0x46706d,'type':_0x3ee815,'logDuplicates':_0x3ee815===_0x5b624e(0x15c),'isExit':![],'_score':_0x46706d?0x50:_0x3ee815===_0x5b624e(0x105)?0x5a:0x28});}}return _0x2368b7['sort']((_0x45cfc9,_0x514c9d)=>_0x514c9d[_0x5b624e(0xcb)]-_0x45cfc9[_0x5b624e(0xcb)]),_0x2368b7;}async function executeAutomationAction(_0x631ea2){const _0x3314d9=a0_0x481010;try{const _0x3d9c35=await _0x631ea2['getStateAsync'](_0x3314d9(0xb6)),_0x401e52=await _0x631ea2[_0x3314d9(0x1c3)](_0x3314d9(0xcc));if(_0x3d9c35&&_0x3d9c35[_0x3314d9(0x1e6)]&&_0x401e52){const _0x37d8d8=_0x3d9c35[_0x3314d9(0x1e6)];let _0xcf1d6c=_0x401e52['val'];try{_0xcf1d6c=JSON[_0x3314d9(0x25e)](_0xcf1d6c);}catch(_0x1fc50a){}_0x631ea2['log'][_0x3314d9(0x221)](_0x3314d9(0x28a)+_0x37d8d8+_0x3314d9(0x29d)+_0xcf1d6c),await _0x631ea2[_0x3314d9(0x1bd)](_0x37d8d8,_0xcf1d6c);}else _0x631ea2[_0x3314d9(0x162)]['warn'](_0x3314d9(0x156));}catch(_0x362272){_0x631ea2[_0x3314d9(0x162)][_0x3314d9(0x191)](_0x3314d9(0x233)+_0x362272[_0x3314d9(0x13e)]);}}function tryParse(_0x5bfd6f){const _0x30e6b3=a0_0x481010;try{return JSON[_0x30e6b3(0x25e)](_0x5bfd6f);}catch(_0x53d054){return null;}}async function recordSequence(_0xa45aa4,_0xf698bf){const _0x5ca5af=a0_0x481010,_0x5f52ee=(_0xf698bf[_0x5ca5af(0x102)]||'')[_0x5ca5af(0x299)](),_0x29bff3=['motion',_0x5ca5af(0x14e),_0x5ca5af(0x125),_0x5ca5af(0x2a3),_0x5ca5af(0xf7),_0x5ca5af(0x231),_0x5ca5af(0x145),'window','fenster',_0x5ca5af(0x14d),_0x5ca5af(0x277),_0x5ca5af(0x1ea),_0x5ca5af(0x135),_0x5ca5af(0x1ce),'schalter',_0x5ca5af(0x173),_0x5ca5af(0xfb)];if(!_0x29bff3[_0x5ca5af(0xbe)](_0x4df0e6=>_0x5f52ee[_0x5ca5af(0x1c5)](_0x4df0e6))){_0xa45aa4[_0x5ca5af(0x162)][_0x5ca5af(0xc3)](_0x5ca5af(0x1a6)+_0xf698bf['id']+_0x5ca5af(0x128)+_0xf698bf['type']+_0x5ca5af(0x16c));return;}if(!_0xf698bf['value']){_0xa45aa4[_0x5ca5af(0x162)]['debug'](_0x5ca5af(0x1a6)+_0xf698bf['id']+_0x5ca5af(0x1a4)+_0xf698bf[_0x5ca5af(0x7b)]+')');return;}_0xa45aa4[_0x5ca5af(0x162)][_0x5ca5af(0xc3)](_0x5ca5af(0x1c4)+_0xf698bf['id']+'\x20('+_0xf698bf[_0x5ca5af(0x101)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x364acf={'loc':_0xf698bf['location']||_0x5ca5af(0x1f3),'id':_0xf698bf['id'],'ts':Date['now']()};activeSequence['push'](_0x364acf),_0xa45aa4[_0x5ca5af(0x162)][_0x5ca5af(0xc3)](_0x5ca5af(0x180)+_0x364acf[_0x5ca5af(0x20a)]+_0x5ca5af(0x13f)+activeSequence[_0x5ca5af(0x207)]+')'),sequenceTimer=setTimeout(async()=>{const _0x23d2e9=_0x5ca5af;activeSequence[_0x23d2e9(0x207)]>0x1?await saveCompletedSequence(_0xa45aa4):(_0xa45aa4[_0x23d2e9(0x162)][_0x23d2e9(0xc3)](_0x23d2e9(0x1ad)+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x21e241){const _0x1d3174=a0_0x481010;try{_0x21e241[_0x1d3174(0x162)]['info'](_0x1d3174(0x111)+activeSequence['length']+').\x20Saving\x20to\x20Training\x20Data.');const _0x18be3f=await _0x21e241['getStateAsync']('LTM.trainingData.sequences');let _0x5aa6ed=[];if(_0x18be3f&&_0x18be3f[_0x1d3174(0x1e6)])try{_0x5aa6ed=JSON['parse'](_0x18be3f[_0x1d3174(0x1e6)]);}catch(_0x118299){}const _0x13b139=activeSequence[0x0]['ts'],_0x553069=activeSequence[_0x1d3174(0x206)](_0x11a335=>({'loc':_0x11a335['loc'],'t_delta':Math['round']((_0x11a335['ts']-_0x13b139)/0x3e8)})),_0x42bf6e={'timestamp':new Date(_0x13b139)['toISOString'](),'steps':_0x553069,'duration':Math['round']((activeSequence[activeSequence[_0x1d3174(0x207)]-0x1]['ts']-_0x13b139)/0x3e8),'daytime':new Date(_0x13b139)[_0x1d3174(0x1b4)]()};_0x5aa6ed[_0x1d3174(0xf4)](_0x42bf6e),_0x5aa6ed[_0x1d3174(0x207)]>MAX_TRAINING_SET_SIZE&&_0x5aa6ed[_0x1d3174(0xb2)](),await _0x21e241[_0x1d3174(0x77)](_0x1d3174(0x25c),{'val':JSON[_0x1d3174(0x132)](_0x5aa6ed),'ack':!![]}),runSecurityCheck(_0x21e241,_0x42bf6e),activeSequence=[],sequenceTimer=null;}catch(_0x187ec8){_0x21e241[_0x1d3174(0x162)][_0x1d3174(0x191)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x187ec8[_0x1d3174(0x13e)]);}}function a0_0x4e98(){const _0x6d3270=['toLocaleString','Processing\x20Status','ü©∫\x20Triggering\x20Health\x20Analysis\x20on\x20new\x20Digest...','isAlert','Energy\x20Train\x20Error:\x20','[RESULT]','‚úÖ\x20ENERGY\x20MODEL\x20TRAINED!','[LOG]','onUnload','‚úÖ\x20SUCCESS.\x20Dependencies\x20installed.','unknown','automationProposal','valve','events.history','notifyPushoverInstance','ltmDriftCheckIntervalHours','\x20*\x20*\x20*','unreach','Gemini\x20AI\x20initialized.','[PYTHON]\x20','getMonth','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','minDaysForBaseline','notifyTelegramEnabled','values','push','TRAIN_HEALTH','generic','occupancy','[PYTHON]\x20Failed\x20to\x20start:\x20','button','subscribeForeignStatesAsync','lampe','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','calendarSelection','Gast','analysis.health.notes','Automation\x20Proposals','location','type','LTM\x20Sched\x20Error:\x20','getForeignStateAsync','custom','stdin','Trend\x20Value\x20(%)','common','dailyDigests','scheduleJob','health','enum.functions.*','getCalendarNames','analysis.comfortSummary','boolean','Bibliotheken\x20nicht\x20gefunden','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','Trigger\x20Analysis','Failed:\x20','isPresent','weatherunderground','json','\x20hours.\x20Potential\x20incapacitation.','WETTER\x20ERROR:\x20','.\x20SYSTEM_MODE:\x20','LTM.driftAnalysis.lastCheck','\x22\x20--break-system-packages\x20--user','isGracePeriodActive','getForeignObjectAsync','text','logDuplicates','testContext','.\x20ZUSATZ:\x20','pop','activityLevel','indicator.health','pr√§senz','analysis.health.restlessness','dismissAutomation','\x20(Type\x20\x27','now','warn','_calName','Error\x20checking\x20WiFi:\x20','TRAINING_COMPLETE','stateChange','toFixed','vacation','.forecast.current.state','stringify','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','\x22\x20--break-system-packages','licht','payload','analysis.health.sleepScore','splice','.\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x20','‚ö†Ô∏è\x20ALARM:\x20','useWeather','ü©∫\x20Triggering\x20Health\x20Training...','modeResetJob','message','\x20(Length:\x20','analysis.deviationFromBaseline','system.meta.uuid','AI\x20Alert\x20Status','write','VACATION','t√ºr','ltmLtbWindowDays','Training\x20Error:\x20','Training\x20Data\x20Sets','native','Urlaub','temperatur','Briefing\x20Sched\x20Error:\x20','contact','bewegung','\x20Tage)','.\x20ANWESENDE_GERAETE:\x20','ready','System\x20Mode','üìû\x20R√ºckruf\x20anfordern','getEnums','LTM.trainingData.thermodynamics','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','licenseKey','Sending\x20notification:\x20\x22','.\x20ANWESENHEITS_STATUS:\x20','Train\x20Health\x20Model\x20(IsoForest)','scanDevices','motion','sensorLastValues','cancel','accuweather','join','LTM.triggerDailyDigest','log','analysis.automation.description','‚ùå\x20CRITICAL:\x20Self-healing\x20failed.','PRIORIT√ÑT:\x20Gesundheit/AAL.','event','Sec-Training\x20started...','Health\x20Anomaly\x20Detected','HEALTH_RESULT','weatherInstance','weather','\x27\x20not\x20in\x20allowed\x20list)','‚úÖ\x20AUTO-FIX\x20SUCCESS.','12pojaLh','PARTY','analysis.training.status','.\x20DATEN:\x20Schlaf\x20','SECURITY_RESULT','dimmer','writable','Idle','off','stdout','‚ùå\x20Training\x20failed:\x20','getForeignObjectsAsync','analysis.automation.autoApply','Kalender:\x20Deaktiviert','Energy\x20Intelligence','testNotification','level','@iobroker/adapter-core','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','‚ùå\x20AUTO-FIX\x20FAILED:\x20','system.config','ack','AI\x20Emergency\x20Status','Drift\x20Analysis','unshift','data','power','maintenance','temperature','LTM.driftAnalysis.baselineDrift','simulateButler','stderr','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','Lernphase\x20(','üçÉ\x20Triggering\x20Energy\x20Training...','error','975710GCOPNX','Verbindung\x20erfolgreich!\x20Antwort:\x20','[TEST]\x20','devices','Train\x20Energy\x20Model\x20(Regression)','Live\x20Security\x20Monitor','from','inactivityThresholdHours','requirements.txt','delObjectAsync','telegram','Aktiv\x20(','Last\x20Check','NORMAL','.\x20WETTER:\x20','geminiModel','status','Morning\x20Briefing\x20sent.','\x20(Value\x20is\x20falsy:\x20','Guardian:\x20Sending\x20','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','Keiner','Keine\x20Details.','Fokus\x20auf\x20Komfort.','online','üåÖ\x20Daily\x20Briefing:\x0a','Pattern\x20Detected','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','Success:\x20Compressed\x20','humidity','ical.0','channel','subscribeStates','config_pending','getHours','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','exitGraceTimer','Invalid\x20JSON\x20from\x20Python:\x20','Say\x20Hello','Success:\x20','lastAlertState','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','analysis.automation.patternDetected','setForeignStateAsync','enum','autoApply','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','Train\x20Security\x20Model\x20(LSTM)','cogni-living\x20adapter\x20starting\x20(v','getStateAsync','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','includes','Ungew√∂hnliches\x20Bewegungsmuster\x20erkannt!\x20(Score:\x20','genAI','analysis.isAlert','COGNI_CONFIRM_OK','notifyEmailEnabled','\x20for\x20interactive\x20buttons...','ANALYZE_SEQUENCE','Baseline\x20Status','switch','version','analysis.trigger','systemConfig','0\x204\x20*\x20*\x20*','node-schedule','N/A','pythonProcess','‚úÖ\x20PIP\x20bootstrapped.\x20Retrying\x20installation...','alertReason','system.presenceWho','filter','exitTimer','generateContent','Deviation','toString','triggerBriefing','WETTER:\x20','heating','Restlessness\x20Level','‚úÖ\x20HEALTH\x20MODEL\x20TRAINED!\x20','analysisHistory','cover','analysis.training.triggerSecurity','val','Health\x20Train\x20Error:\x20','cogni-living','Last\x20Result','light','city','bind','.\x20KONTEXT:\x20','temp','analysis.security.lastCheck','üêç\x20Stopping\x20Python\x20Sidecar...','isExit','callback','Unknown','0\x203\x20*\x20*\x20*','analysis.activitySummary','description','ANALYZE_HEALTH','schalter','TREND_RESULT','none','@google/generative-ai','briefingJob','close','indicator','Error\x20in\x20onMessage\x20command\x20','GUEST','triggerDailyDigest','sendToAsync','send','child_process','detected','map','length','Last\x20Anomaly\x20Score','Activity-Level','loc','getFullYear','sendTo','560862RHgSQv','Kein\x20API\x20Key\x20eingegeben.','üêç\x20Python\x20Pong\x20received!','automation.triggerAction','isProVersion','material.','LTM.driftAnalysis','üêç\x20Starting\x20Python\x20Sidecar:\x20','Deaktiviert\x20(Pro-Feature)','TRAIN_ENERGY','useCalendar','doors','latitude','extendObjectAsync','setObjectNotExistsAsync','analysis.analysisHistory','replace','Reset\x20Sched\x20Error:\x20','Scheduling\x20Morning\x20Briefing\x20for\x20','.communicate.request','info','Trend\x20Diagnosis\x20(Python)','Generating\x20Morning\x20Briefing...','No\x20module\x20named\x20pip',')\x20->\x20','analysis.security.lastScore','response','Subscribing\x20to\x20','Drift\x20Status','08:00','getGenerativeModel','getTime','analysis.lastResult','getOverviewData','Description','startsWith','door','longitude','BUTLER\x20Execution\x20Error:\x20','lastCheck','onReady','KALENDER:\x20Keine\x20relevanten\x20Termine','(((.+)+)+)+$','daswetter','Failed\x20to\x20send\x20to\x20Python:\x20','analysisTimer','accuweather.0','role','toLocaleTimeString','.data.table','fenster','actual_temperature','summary','systemUUID','Error\x20reading\x20calendar\x20table:\x20','uuid','Feedback\x20Log','LTM.dailyDigests','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','blind','‚ùå\x20Energy\x20Training\x20Failed:\x20','lastIndexOf','history.','.Current.Temperature','ABWESEND','openweathermap','python3\x20-m\x20pip\x20install\x20-r\x20\x22','presenceDevices','notifyEmailInstance','System\x20Status\x20&\x20Control','.NextHours.Location_1.Day_1.current.symbol_desc','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','COGNI_REQUEST_CALL','config','update','KALENDER\x20ERROR:\x20','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','üß†\x20Triggering\x20Security\x20Training...','livingContext','LTM.trainingData.sequences','.NextHours.Location_1.Day_1.current.temp_value','parse','Comfort\x20Summary','instance','.\x20OUTPUT:\x20Nur\x20Text.','üõ°Ô∏è\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','feedbackHistory','analysis.health.isAnomaly','object','486123gUhhLe','shutter','.\x20NOTFALL-KONTEXT:\x20','daswetter.0','baselineDrift','Restoring\x20sensor\x20cache\x20from\x20history\x20(','fault','python3','sort','notifyTelegramInstance','analysis.training.triggerHealth','analysis.health.trendValue','8SnVdmQ','analysis.energy.heatingScore','analysis.training','analysis.comfortSuggestion','timestamp','kontakt','130478StQOfv','sensor','string','Unbekannt','reachable','working','rawEventLog','Last\x20Check\x20Time','sleepScore','5296164XXdwvH','Action','currentSystemMode','split','python_service','command','energy','number','Gemini\x20Analysis\x20Error:\x20','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','notifyPushoverRecipient','Drift\x20Details','ltmStbWindowDays','Thermodynamic\x20Data\x20Points','.Summary.Current','analysis.triggerBriefing','üö®\x20EMERGENCY','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x20PERSONA:\x20','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','search','Fehler:\x20','exports','geminiApiKey','toLowerCase','Raw\x20Log','driftAnalysisTimer','uuid-not-found','\x20=\x20','Normal','setHours','name','insulation','dutycycle','presence','Kein\x20API\x20Key!','Daily\x20Digests','N/A\x20(Learning)','scriptProblem','system.','\x20sensors...','isArray','guest','setStateAsync','lock','slice','models/gemini-flash-latest','value','‚ùå\x20Installation\x20failed:\x20','\x20presence\x20devices...','service.py','openweathermap.0','KI-Modell\x20nicht\x20initialisiert','dependencyInstallInProgress','No\x20module\x20named','\x20|\x20','analysis.alertReason','4077780fHlWFA','Skipped\x20(No\x20AI\x20or\x20Data)','rollladen','substring','Logbook','Analysiere\x20ausgewogen.','direction','klima','Vom\x20Benutzer\x20best√§tigt\x20(OK).','Unknown\x20error','Error\x20launching\x20Python\x20service:\x20','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','targetId','date','analysis.training.triggerEnergy','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','time','LTM.driftAnalysis.driftDetails','Last\x20raw\x20event','state','analysisInterval','setState','Comfort\x20Suggestion','‚úÖ\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20','system.mode','TEST-PRO-KEY','analysis.energy.insulationScore','eventHistory','.forecast.current.temperature','icons-mfd.','PRO-','lowbat','analysis.isEmergency','Cogni-Living','members','Error:\x20','Alert\x20Reason','toISOString','6252633jpGyPL','Trigger\x20Digest','\x20events','ENERGY_TRAIN_RESULT','value.health','firmware','isEmergency','shift','onMessage','application/json','heizung','analysis.automation.targetId','stick_unreach','User\x20dismissed\x20automation\x20proposal.','trim','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','Gemini\x20Init\x20Error:\x20','uuid-error','endsWith','some','notifyPushoverEnabled','ltmJob','position','analysis.health.trendDiagnosis','debug','notifyTelegramRecipient','sound','analysis.health.lastCheck','aiPersona','[PYTHON\x20ERR]\x20','enum.rooms.*','ANALYZE_TREND','_score','analysis.automation.targetValue','Who\x20is\x20present?','LTM','events.history_debug_00','analysis.feedbackHistory','set_temperature','retry','Started\x20at\x20','briefingEnabled','\x20events)...','Missing\x20data','HEALTH_TRAIN_RESULT','Health\x20&\x20Sleep\x20Analysis','link_quality'];a0_0x4e98=function(){return _0x6d3270;};return a0_0x4e98();}function runSecurityCheck(_0x25133c,_0x5f4920){const _0x422efc=a0_0x481010;if(!_0x25133c[_0x422efc(0x211)])return;_0x25133c['log']['debug'](_0x422efc(0x262)),sendToPython(_0x25133c,_0x422efc(0x1cc),{'sequence':_0x5f4920});}async function getOutsideTemperatureNumeric(_0x2ae213){const _0x3fc4de=a0_0x481010;if(_0x2ae213[_0x3fc4de(0x256)]['outdoorSensorId'])try{const _0x45ea23=await _0x2ae213[_0x3fc4de(0x104)](_0x2ae213['config']['outdoorSensorId']);if(_0x45ea23&&_0x45ea23[_0x3fc4de(0x1e6)]!==undefined&&_0x45ea23[_0x3fc4de(0x1e6)]!==null){const _0x13ade2=parseFloat(_0x45ea23['val']);if(!isNaN(_0x13ade2))return _0x13ade2;}}catch(_0x270ab1){}const _0x4ebf5b=_0x2ae213[_0x3fc4de(0x256)]['weatherInstance'];if(!_0x2ae213[_0x3fc4de(0x256)][_0x3fc4de(0x13b)]||!_0x4ebf5b)return null;try{let _0x3c19fc='';if(_0x4ebf5b['includes'](_0x3fc4de(0x15f)))_0x3c19fc=_0x4ebf5b+_0x3fc4de(0x24c);else{if(_0x4ebf5b['includes'](_0x3fc4de(0x238)))_0x3c19fc=_0x4ebf5b+_0x3fc4de(0x25d);else{if(_0x4ebf5b[_0x3fc4de(0x1c5)](_0x3fc4de(0x24e)))_0x3c19fc=_0x4ebf5b+_0x3fc4de(0xa1);else{if(_0x4ebf5b[_0x3fc4de(0x1c5)](_0x3fc4de(0x115)))_0x3c19fc=_0x4ebf5b+'.forecast.current.temp';}}}if(_0x3c19fc){const _0x15b7cd=await _0x2ae213[_0x3fc4de(0x104)](_0x3c19fc);if(_0x15b7cd&&_0x15b7cd[_0x3fc4de(0x1e6)]!==undefined&&_0x15b7cd[_0x3fc4de(0x1e6)]!==null)return parseFloat(_0x15b7cd[_0x3fc4de(0x1e6)]);}}catch(_0x56cd49){}return null;}async function recordThermodynamics(_0x3d41e1,_0x8a827c,_0x4f50b7,_0x38cec1){const _0x15bc12=a0_0x481010,_0x39c32d=await getOutsideTemperatureNumeric(_0x3d41e1),_0x3837c4=await _0x3d41e1['getStateAsync'](_0x15bc12(0x155));let _0x32eaac=[];if(_0x3837c4&&_0x3837c4[_0x15bc12(0x1e6)])try{_0x32eaac=JSON[_0x15bc12(0x25e)](_0x3837c4[_0x15bc12(0x1e6)]);}catch(_0x18ad19){}_0x32eaac[_0x15bc12(0xf4)]({'ts':Date[_0x15bc12(0x129)](),'room':_0x38cec1||_0x15bc12(0x1f3),'t_in':_0x4f50b7,'t_out':_0x39c32d});if(_0x32eaac['length']>THERMO_LOG_SIZE)_0x32eaac[_0x15bc12(0xb2)]();await _0x3d41e1[_0x15bc12(0x77)](_0x15bc12(0x155),{'val':JSON['stringify'](_0x32eaac),'ack':!![]});}async function processSensorEvent(_0x5a3fb9,_0x2b9a61,_0x17e241,_0x409bb4){const _0x32fe61=a0_0x481010;if(!_0x409bb4)return;const _0x27a267=_0x17e241['val'],_0x37aa01=Date[_0x32fe61(0x129)](),_0x45f221=_0x5a3fb9[_0x32fe61(0x15d)][_0x2b9a61];_0x5a3fb9[_0x32fe61(0x15d)][_0x2b9a61]=_0x27a267;if(!_0x409bb4[_0x32fe61(0x11f)]&&_0x45f221!=undefined&&_0x45f221==_0x27a267)return;const _0xc5f348=(_0x409bb4[_0x32fe61(0x102)]||'')[_0x32fe61(0x299)](),_0x81fb8d=_0xc5f348[_0x32fe61(0x1c5)](_0x32fe61(0x18a))||_0xc5f348[_0x32fe61(0x1c5)](_0x32fe61(0x14b))||_0xc5f348['includes'](_0x32fe61(0x8c))||_0xc5f348[_0x32fe61(0x1c5)](_0x32fe61(0xb5));_0x5a3fb9[_0x32fe61(0x211)]&&_0x81fb8d&&recordThermodynamics(_0x5a3fb9,_0x2b9a61,_0x27a267,_0x409bb4['location']);const _0x84e0e9={'timestamp':_0x37aa01,'id':_0x2b9a61,'name':_0x409bb4['name'],'type':_0x409bb4['type'],'location':_0x409bb4[_0x32fe61(0x101)],'value':_0x27a267};_0x5a3fb9[_0x32fe61(0xa0)][_0x32fe61(0x186)](_0x84e0e9);if(_0x5a3fb9[_0x32fe61(0xa0)][_0x32fe61(0x207)]>HISTORY_MAX_SIZE)_0x5a3fb9[_0x32fe61(0xa0)][_0x32fe61(0x122)]();await _0x5a3fb9[_0x32fe61(0x77)]('events.lastEvent',{'val':JSON['stringify'](_0x84e0e9),'ack':!![]}),await _0x5a3fb9[_0x32fe61(0x77)](_0x32fe61(0xe7),{'val':JSON[_0x32fe61(0x132)](_0x5a3fb9[_0x32fe61(0xa0)]),'ack':!![]});_0x5a3fb9[_0x32fe61(0x211)]&&(_0x5a3fb9[_0x32fe61(0x27e)][_0x32fe61(0xf4)](_0x84e0e9),await saveRawEventLog(_0x5a3fb9),recordSequence(_0x5a3fb9,_0x84e0e9));if(_0x409bb4[_0x32fe61(0x1f1)]&&_0x27a267===!![]){if(_0x5a3fb9[_0x32fe61(0x114)]&&!_0x5a3fb9[_0x32fe61(0x11c)])startExitTimer(_0x5a3fb9);else{if(!_0x5a3fb9['isPresent'])setPresence(_0x5a3fb9,!![]);}}else{if(_0x409bb4[_0x32fe61(0x102)]===_0x32fe61(0x15c)&&_0x27a267===!![]){if(_0x5a3fb9[_0x32fe61(0x1da)])abortExitTimer(_0x5a3fb9);if(!_0x5a3fb9['isPresent']&&_0x5a3fb9[_0x32fe61(0x283)]===SYSTEM_MODES[_0x32fe61(0x19f)])setPresence(_0x5a3fb9,!![]);}}}async function runGeminiAnalysis(_0x11ac20,_0x2eb5e0=''){const _0x20dfa3=a0_0x481010;if(!_0x11ac20[_0x20dfa3(0x1a1)])return;if(_0x11ac20['eventHistory'][_0x20dfa3(0x207)]===0x0)return;const _0x20a6a2=_0x11ac20[_0x20dfa3(0xa0)][_0x20dfa3(0x79)](0x0,0xf),_0x588ae1=await getWeatherContext(_0x11ac20),_0x180708=_0x11ac20[_0x20dfa3(0x283)],_0x23f2eb=PERSONA_MAPPING[_0x11ac20[_0x20dfa3(0x256)][_0x20dfa3(0xc7)]||_0x20dfa3(0xf6)],_0x23f7a5=_0x11ac20[_0x20dfa3(0x256)][_0x20dfa3(0x25b)]||_0x20dfa3(0x1a8);let _0x290f97=_0x20dfa3(0x27b);try{const _0x186b72=await _0x11ac20[_0x20dfa3(0x1c3)](_0x20dfa3(0x1d8));if(_0x186b72&&_0x186b72[_0x20dfa3(0x1e6)])_0x290f97=_0x186b72[_0x20dfa3(0x1e6)];}catch(_0x21ec42){}let _0x41d546=![];try{const _0xfd8b62=await _0x11ac20[_0x20dfa3(0x1c3)](_0x20dfa3(0x17a));if(_0xfd8b62&&_0xfd8b62[_0x20dfa3(0x1e6)])_0x41d546=!![];}catch(_0x9d2968){}const _0x3f5365=_0x20dfa3(0x293)+_0x23f2eb+_0x20dfa3(0x1ed)+_0x23f7a5+_0x20dfa3(0x119)+_0x180708+_0x20dfa3(0x1a0)+_0x588ae1+_0x20dfa3(0x268)+(_0x2eb5e0||_0x20dfa3(0x1a7))+_0x20dfa3(0x159)+(_0x11ac20[_0x20dfa3(0x114)]?'Anwesend':_0x20dfa3(0x24d))+_0x20dfa3(0x150)+_0x290f97+_0x20dfa3(0x139)+JSON[_0x20dfa3(0x132)](_0x20a6a2)+'\x20AUFGABE:\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken.\x202.\x20Analysiere\x20auf\x20Komfort.\x20FORMAT\x20(JSON\x20Only):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{const _0x47c11d=await _0x11ac20[_0x20dfa3(0x1a1)][_0x20dfa3(0x1db)](_0x3f5365),_0x347cf2=_0x47c11d[_0x20dfa3(0x227)][_0x20dfa3(0x11e)]()['replace'](/```json|```/g,'')[_0x20dfa3(0xb9)](),_0x419ac0=JSON[_0x20dfa3(0x25e)](_0x347cf2);await _0x11ac20['setStateAsync'](_0x20dfa3(0x22d),{'val':JSON[_0x20dfa3(0x132)](_0x419ac0),'ack':!![]});if(_0x419ac0['summary'])await _0x11ac20['setStateAsync']('analysis.activitySummary',{'val':_0x419ac0[_0x20dfa3(0x241)],'ack':!![]});const _0x4e6ba1={'timestamp':Date[_0x20dfa3(0x129)](),'id':Date[_0x20dfa3(0x129)]()[_0x20dfa3(0x1dd)](),'analysis':{'activity':{'summary':_0x419ac0[_0x20dfa3(0x241)]||'Keine\x20Analyse.','isAlert':_0x419ac0[_0x20dfa3(0xdd)]||![],'alertReason':_0x419ac0[_0x20dfa3(0x1d7)]},'comfort':{'automationProposal':_0x419ac0[_0x20dfa3(0xe5)]}}};await updateAnalysisHistory(_0x11ac20,_0x4e6ba1);const _0x5be4a5=_0x419ac0[_0x20dfa3(0xdd)]||![];_0x5be4a5!==_0x11ac20[_0x20dfa3(0x1ba)]&&(await _0x11ac20[_0x20dfa3(0x77)]('analysis.isAlert',{'val':_0x5be4a5,'ack':!![]}),_0x11ac20[_0x20dfa3(0x1ba)]=_0x5be4a5,_0x5be4a5&&(await _0x11ac20[_0x20dfa3(0x77)]('analysis.alertReason',{'val':_0x419ac0[_0x20dfa3(0x1d7)],'ack':!![]}),sendNotification(_0x11ac20,_0x20dfa3(0x13a)+_0x419ac0[_0x20dfa3(0x1d7)],![],_0x419ac0[_0x20dfa3(0xb1)]))),_0x419ac0['automationProposal']&&_0x419ac0[_0x20dfa3(0xe5)][_0x20dfa3(0x205)]&&_0x419ac0[_0x20dfa3(0xe5)][_0x20dfa3(0x91)]&&(await _0x11ac20[_0x20dfa3(0x77)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x11ac20['setStateAsync'](_0x20dfa3(0x163),{'val':_0x419ac0[_0x20dfa3(0xe5)][_0x20dfa3(0x1f6)],'ack':!![]}),await _0x11ac20['setStateAsync'](_0x20dfa3(0xb6),{'val':_0x419ac0[_0x20dfa3(0xe5)][_0x20dfa3(0x91)],'ack':!![]}),await _0x11ac20[_0x20dfa3(0x77)](_0x20dfa3(0xcc),{'val':JSON['stringify'](_0x419ac0[_0x20dfa3(0xe5)]['targetValue']),'ack':!![]}),_0x41d546&&await executeAutomationAction(_0x11ac20));}catch(_0x3530cb){_0x11ac20[_0x20dfa3(0x162)][_0x20dfa3(0x191)](_0x20dfa3(0x289)+_0x3530cb[_0x20dfa3(0x13e)]);}}function installPythonDependencies(_0x1c4013){const _0x408db=a0_0x481010;if(_0x1c4013[_0x408db(0x81)])return;_0x1c4013[_0x408db(0x81)]=!![];const _0x24f59e=path[_0x408db(0x160)](__dirname,_0x408db(0x285),_0x408db(0x19a));_0x1c4013[_0x408db(0x162)]['info']('üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20'+_0x24f59e+'...'),stopPythonService(_0x1c4013);const _0x4172fc=_0x408db(0x24f)+_0x24f59e+_0x408db(0x134);exec(_0x4172fc,(_0x320e80,_0x289d15,_0x3379dc)=>{const _0x3f691a=_0x408db,_0x200bec=_0x3379dc&&_0x3379dc[_0x3f691a(0x1c5)](_0x3f691a(0x224))||_0x320e80&&_0x320e80[_0x3f691a(0x13e)][_0x3f691a(0x1c5)](_0x3f691a(0x224));if(_0x200bec){_0x1c4013[_0x3f691a(0x162)][_0x3f691a(0x12a)]('‚ö†Ô∏è\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing...'),exec(_0x3f691a(0xfc),(_0x816657,_0x3d1506,_0x1593c6)=>{const _0x3acef8=_0x3f691a;_0x816657?(_0x1c4013['log'][_0x3acef8(0x191)](_0x3acef8(0x164)),_0x1c4013['dependencyInstallInProgress']=![]):(_0x1c4013[_0x3acef8(0x162)][_0x3acef8(0x221)](_0x3acef8(0x1d6)),exec(_0x3acef8(0x24f)+_0x24f59e+_0x3acef8(0x11b),(_0x5a0836,_0x19e420,_0x1b3e55)=>{const _0x12d020=_0x3acef8;_0x5a0836?_0x1c4013[_0x12d020(0x162)][_0x12d020(0x191)](_0x12d020(0x7c)+_0x5a0836['message']):(_0x1c4013['log'][_0x12d020(0x221)](_0x12d020(0xe3)),startPythonService(_0x1c4013)),_0x1c4013['dependencyInstallInProgress']=![];}));});return;}_0x1c4013[_0x3f691a(0x81)]=![],_0x320e80?_0x1c4013[_0x3f691a(0x162)]['error'](_0x3f691a(0x181)+(_0x3379dc||_0x320e80[_0x3f691a(0x13e)])):(_0x1c4013['log'][_0x3f691a(0x221)](_0x3f691a(0x16d)),startPythonService(_0x1c4013));});}function sendToPython(_0x39f266,_0x2fd0cc,_0x1d3693={}){const _0x5bd582=a0_0x481010;if(!_0x39f266[_0x5bd582(0x1d5)]||!_0x39f266[_0x5bd582(0x1d5)]['stdin'][_0x5bd582(0x174)])return;const _0x58962e=JSON[_0x5bd582(0x132)]({'command':_0x2fd0cc,..._0x1d3693});try{_0x39f266[_0x5bd582(0x1d5)][_0x5bd582(0x106)][_0x5bd582(0x143)](_0x58962e+'\x0a');}catch(_0x256c7e){_0x39f266['log'][_0x5bd582(0x191)](_0x5bd582(0x239)+_0x256c7e['message']);}}function runPythonHealthCheck(_0x8fd94){const _0x50ddff=a0_0x481010;if(!_0x8fd94[_0x50ddff(0x109)]||_0x8fd94['dailyDigests'][_0x50ddff(0x207)]<0x2)return;const _0x44bdec=_0x8fd94[_0x50ddff(0x109)][_0x50ddff(0x206)](_0x1a9c08=>{const _0x419b64=_0x50ddff,_0x27433a=(_0x1a9c08[_0x419b64(0x123)]||'')[_0x419b64(0x299)]();return ACTIVITY_LEVEL_MAP[_0x27433a]||0x32;});_0x8fd94[_0x50ddff(0x162)][_0x50ddff(0x221)](_0x50ddff(0x1a5)+_0x44bdec['length']+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x8fd94,_0x50ddff(0xca),{'values':_0x44bdec,'tag':_0x50ddff(0x209)});}function handlePythonResult(_0x1d5b7d,_0x285cd1){const _0x37fc18=a0_0x481010;if(_0x285cd1[_0x37fc18(0x102)]==='PONG')_0x1d5b7d[_0x37fc18(0x162)][_0x37fc18(0xc3)](_0x37fc18(0x20f));else{if(_0x285cd1[_0x37fc18(0x102)]===_0x37fc18(0x1f9)){const {tag:_0x7b553c,diagnosis:_0x9cbe50,change_percent:_0x23a225}=_0x285cd1[_0x37fc18(0x136)];_0x1d5b7d[_0x37fc18(0x162)][_0x37fc18(0x221)]('üêç\x20Guardian\x20Diagnosis\x20('+_0x7b553c+'):\x20'+_0x9cbe50+'\x20('+_0x23a225+'%)'),_0x1d5b7d['setStateAsync'](_0x37fc18(0xc2),{'val':_0x9cbe50,'ack':!![]}),_0x1d5b7d['setStateAsync']('analysis.health.trendValue',{'val':_0x23a225,'ack':!![]});}else{if(_0x285cd1[_0x37fc18(0x102)]===_0x37fc18(0x12d)){const {success:_0x633b2b,details:_0x291d25}=_0x285cd1[_0x37fc18(0x136)];_0x633b2b?(_0x1d5b7d[_0x37fc18(0x162)][_0x37fc18(0x221)](_0x37fc18(0x9c)+_0x291d25),_0x1d5b7d[_0x37fc18(0x77)]('analysis.training.status',{'val':_0x37fc18(0x1b9)+new Date()[_0x37fc18(0x23d)]()+'\x20('+_0x291d25+')','ack':!![]})):(_0x1d5b7d[_0x37fc18(0x162)][_0x37fc18(0x191)](_0x37fc18(0x178)+(_0x291d25||_0x37fc18(0x8e))),_0x1d5b7d['setStateAsync'](_0x37fc18(0x170),{'val':_0x37fc18(0x113)+_0x291d25,'ack':!![]}));}else{if(_0x285cd1[_0x37fc18(0x102)]===_0x37fc18(0xd7)){const {success:_0xc07756,details:_0x41faf7}=_0x285cd1[_0x37fc18(0x136)];if(_0xc07756)_0x1d5b7d[_0x37fc18(0x162)]['info'](_0x37fc18(0x1e2)+_0x41faf7);else _0x1d5b7d['log'][_0x37fc18(0x191)]('‚ùå\x20Health\x20Training\x20Failed:\x20'+_0x41faf7);}else{if(_0x285cd1[_0x37fc18(0x102)]===_0x37fc18(0x169)){const {is_anomaly:_0x8e8d50,details:_0xf43be5}=_0x285cd1['payload'];_0x1d5b7d[_0x37fc18(0x77)](_0x37fc18(0xc6),{'val':new Date()['toISOString'](),'ack':!![]}),_0x1d5b7d['setStateAsync'](_0x37fc18(0x264),{'val':_0x8e8d50,'ack':!![]});if(_0x8e8d50)_0x1d5b7d[_0x37fc18(0x162)][_0x37fc18(0x12a)]('ü©∫\x20HEALTH\x20WARNING:\x20'+_0xf43be5);}else{if(_0x285cd1['type']===_0x37fc18(0xae)){const {success:_0x56baa4,details:_0x498fc6}=_0x285cd1[_0x37fc18(0x136)];if(_0x56baa4){_0x1d5b7d[_0x37fc18(0x162)][_0x37fc18(0x221)](_0x37fc18(0xe0));try{const _0x59fd2e=JSON[_0x37fc18(0x25e)](_0x498fc6);_0x59fd2e[_0x37fc18(0x2a1)]&&_0x1d5b7d[_0x37fc18(0x77)](_0x37fc18(0x9f),{'val':JSON[_0x37fc18(0x132)](_0x59fd2e[_0x37fc18(0x2a1)]),'ack':!![]}),_0x59fd2e['heating']&&_0x1d5b7d['setStateAsync'](_0x37fc18(0x273),{'val':JSON[_0x37fc18(0x132)](_0x59fd2e[_0x37fc18(0x1e0)]),'ack':!![]});}catch(_0x3cc437){_0x1d5b7d[_0x37fc18(0x162)]['error']('Failed\x20to\x20parse\x20energy\x20training\x20result:\x20'+_0x3cc437[_0x37fc18(0x13e)]);}}else _0x1d5b7d[_0x37fc18(0x162)][_0x37fc18(0x191)](_0x37fc18(0x249)+_0x498fc6);}else{if(_0x285cd1[_0x37fc18(0x102)]===_0x37fc18(0x172)){const {anomaly_score:_0x2ac802,is_anomaly:_0x1096d7,threshold:_0x232d6a}=_0x285cd1['payload'];_0x1d5b7d['log'][_0x37fc18(0x221)](_0x37fc18(0x1c0)+_0x2ac802[_0x37fc18(0x12f)](0x5)+'\x20(Threshold:\x20'+_0x232d6a+_0x37fc18(0x225)+(_0x1096d7?'ANOMALY':'OK')),_0x1d5b7d[_0x37fc18(0x77)]('analysis.security.lastScore',{'val':_0x2ac802,'ack':!![]}),_0x1d5b7d[_0x37fc18(0x77)](_0x37fc18(0x1ef),{'val':new Date()[_0x37fc18(0xaa)](),'ack':!![]});if(_0x1096d7){const _0x570b04=_0x37fc18(0x1c6)+_0x2ac802[_0x37fc18(0x12f)](0x4)+')';_0x1d5b7d['setStateAsync'](_0x37fc18(0x1c8),{'val':!![],'ack':!![]}),_0x1d5b7d[_0x37fc18(0x77)](_0x37fc18(0x84),{'val':_0x570b04,'ack':!![]}),sendNotification(_0x1d5b7d,_0x37fc18(0xba)+_0x570b04,![],!![]);}}}}}}}}}function startPythonService(_0x358a24){const _0x4696a4=a0_0x481010;try{const _0x15d775=path[_0x4696a4(0x160)](__dirname,_0x4696a4(0x285),_0x4696a4(0x7e));_0x358a24['log'][_0x4696a4(0x221)](_0x4696a4(0x214)+_0x15d775),_0x358a24['pythonProcess']=spawn(_0x4696a4(0x26d),[_0x15d775]),_0x358a24[_0x4696a4(0x1d5)][_0x4696a4(0x177)]['on'](_0x4696a4(0x187),_0x473896=>{const _0x40dc89=_0x4696a4,_0x1756ad=_0x473896['toString']()[_0x40dc89(0x284)]('\x0a');_0x1756ad['forEach'](_0x35d9cb=>{const _0x57e782=_0x40dc89,_0x447a32=_0x35d9cb[_0x57e782(0xb9)]();if(!_0x447a32)return;if(_0x447a32['startsWith'](_0x57e782(0xe1)))_0x358a24[_0x57e782(0x162)]['debug'](_0x57e782(0xed)+_0x447a32[_0x57e782(0x88)](0x5)['trim']());else{if(_0x447a32[_0x57e782(0x230)](_0x57e782(0xdf)))try{const _0x40703b=JSON[_0x57e782(0x25e)](_0x447a32[_0x57e782(0x88)](0x8)[_0x57e782(0xb9)]());handlePythonResult(_0x358a24,_0x40703b);}catch(_0x193f57){_0x358a24[_0x57e782(0x162)][_0x57e782(0x12a)](_0x57e782(0x1b7)+_0x447a32);}}(_0x447a32[_0x57e782(0x1c5)](_0x57e782(0x82))||_0x447a32['includes'](_0x57e782(0x110)))&&(_0x358a24[_0x57e782(0x162)]['warn'](_0x57e782(0x1b5)),installPythonDependencies(_0x358a24));});}),_0x358a24[_0x4696a4(0x1d5)][_0x4696a4(0x18d)]['on'](_0x4696a4(0x187),_0x5e2788=>{const _0x4d036b=_0x4696a4,_0x5307e4=_0x5e2788[_0x4d036b(0x1dd)]()[_0x4d036b(0xb9)]();_0x358a24[_0x4d036b(0x162)][_0x4d036b(0x191)](_0x4d036b(0xc8)+_0x5307e4);}),_0x358a24[_0x4696a4(0x1d5)]['on'](_0x4696a4(0x1fd),_0x73984f=>{const _0x85d7e9=_0x4696a4;_0x358a24[_0x85d7e9(0x162)][_0x85d7e9(0x221)](_0x85d7e9(0x133)+_0x73984f),_0x358a24[_0x85d7e9(0x1d5)]=null;}),_0x358a24['pythonProcess']['on'](_0x4696a4(0x191),_0x7c7c9a=>{const _0x1984de=_0x4696a4;_0x358a24[_0x1984de(0x162)][_0x1984de(0x12a)](_0x1984de(0xf8)+_0x7c7c9a[_0x1984de(0x13e)]);});}catch(_0x12aba8){_0x358a24[_0x4696a4(0x162)][_0x4696a4(0x191)](_0x4696a4(0x8f)+_0x12aba8[_0x4696a4(0x13e)]);}}function stopPythonService(_0x30e34c){const _0x173fa1=a0_0x481010;if(_0x30e34c[_0x173fa1(0x1d5)]){_0x30e34c[_0x173fa1(0x162)][_0x173fa1(0x221)](_0x173fa1(0x1f0));try{_0x30e34c[_0x173fa1(0x1d5)]['kill']();}catch(_0x154d70){_0x30e34c['log'][_0x173fa1(0x12a)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x154d70['message']);}_0x30e34c[_0x173fa1(0x1d5)]=null;}}class CogniLiving extends utils['Adapter']{constructor(_0x5463fb){const _0x1421d4=a0_0x481010;super({..._0x5463fb,'name':_0x1421d4(0x1e8)}),this[_0x1421d4(0xa0)]=[],this[_0x1421d4(0x1e3)]=[],this[_0x1421d4(0x263)]=[],this['rawEventLog']=[],this[_0x1421d4(0x109)]=[],this[_0x1421d4(0x15d)]={},this[_0x1421d4(0x1d1)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x1421d4(0x114)]=!![],this[_0x1421d4(0x1da)]=null,this[_0x1421d4(0x1b6)]=null,this[_0x1421d4(0x11c)]=![],this[_0x1421d4(0x1c7)]=null,this[_0x1421d4(0x1a1)]=null,this[_0x1421d4(0x283)]=SYSTEM_MODES[_0x1421d4(0x19f)],this[_0x1421d4(0x211)]=![],this['lastAlertState']=![],this[_0x1421d4(0x242)]=_0x1421d4(0xe4),this[_0x1421d4(0x23a)]=null,this[_0x1421d4(0xc0)]=null,this['modeResetJob']=null,this[_0x1421d4(0x29b)]=null,this[_0x1421d4(0x1fc)]=null,this['pythonProcess']=null,this['dependencyInstallInProgress']=![],this['on'](_0x1421d4(0x151),this[_0x1421d4(0x235)]['bind'](this)),this['on'](_0x1421d4(0x12e),this['onStateChange'][_0x1421d4(0x1ec)](this)),this['on']('unload',this[_0x1421d4(0xe2)][_0x1421d4(0x1ec)](this)),this['on'](_0x1421d4(0x13e),this[_0x1421d4(0xb3)]['bind'](this));}async['onReady'](){const _0x1dc59d=a0_0x481010;this[_0x1dc59d(0x162)][_0x1dc59d(0x221)](_0x1dc59d(0x1c2)+this[_0x1dc59d(0x1cf)]+')'),await initZombies(this),this[_0x1dc59d(0x256)]['licenseKey']=this[_0x1dc59d(0x256)][_0x1dc59d(0x157)]||'';try{this[_0x1dc59d(0x211)]=await checkLicense(this,this[_0x1dc59d(0x256)]['licenseKey']);}catch(_0x767583){}if(!this[_0x1dc59d(0x256)][_0x1dc59d(0x199)]||this[_0x1dc59d(0x256)][_0x1dc59d(0x199)]<0.1)this[_0x1dc59d(0x256)][_0x1dc59d(0x199)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config'][_0x1dc59d(0x298)])try{this[_0x1dc59d(0x1c7)]=new GoogleGenerativeAI(this['config'][_0x1dc59d(0x298)]),this[_0x1dc59d(0x1a1)]=this[_0x1dc59d(0x1c7)][_0x1dc59d(0x22b)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x1dc59d(0xb4)}}),this['log'][_0x1dc59d(0x221)](_0x1dc59d(0xec));}catch(_0x59cf85){this['log'][_0x1dc59d(0x191)](_0x1dc59d(0xbb)+_0x59cf85[_0x1dc59d(0x13e)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x1dc59d(0x1b2)](_0x1dc59d(0x1d0)),this[_0x1dc59d(0x1b2)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x1dc59d(0x9d)),this[_0x1dc59d(0x1b2)](_0x1dc59d(0x290)),this[_0x1dc59d(0x1b2)]('analysis.automation.triggerAction'),this['subscribeStates'](_0x1dc59d(0x17a)),this['subscribeStates'](_0x1dc59d(0x1e5)),this[_0x1dc59d(0x1b2)](_0x1dc59d(0x270)),this[_0x1dc59d(0x1b2)](_0x1dc59d(0x93)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x1dc59d(0x23a)])clearInterval(this['analysisTimer']);const _0x10fbe5=this[_0x1dc59d(0x256)][_0x1dc59d(0x99)]||0xf;_0x10fbe5>0x0&&(this[_0x1dc59d(0x23a)]=setInterval(()=>{runAutopilot(this);},_0x10fbe5*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0xadee2b=_0x1dc59d;if(this[_0xadee2b(0x1d5)])runPythonHealthCheck(this);},0x1388);}[a0_0x481010(0xe2)](_0x53609f){const _0x519da2=a0_0x481010;if(this[_0x519da2(0x23a)])clearInterval(this[_0x519da2(0x23a)]);if(this[_0x519da2(0x29b)])clearInterval(this[_0x519da2(0x29b)]);if(this[_0x519da2(0xc0)])this['ltmJob'][_0x519da2(0x15e)]();if(this[_0x519da2(0x13d)])this['modeResetJob'][_0x519da2(0x15e)]();if(this[_0x519da2(0x1fc)])this['briefingJob'][_0x519da2(0x15e)]();if(this[_0x519da2(0x1da)])clearTimeout(this[_0x519da2(0x1da)]);if(this[_0x519da2(0x1b6)])clearTimeout(this[_0x519da2(0x1b6)]);stopPythonService(this),_0x53609f();}async['onStateChange'](_0x455cbe,_0xc6bee4){const _0x1837f8=a0_0x481010;if(!_0xc6bee4)return;if(_0x455cbe[_0x1837f8(0x1c5)](_0x1837f8(0x19c))&&_0x455cbe[_0x1837f8(0xbd)]('communicate.request')&&_0xc6bee4[_0x1837f8(0x1e6)]){await handleTelegramResponse(this,_0xc6bee4[_0x1837f8(0x1e6)]);return;}if(_0x455cbe===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0xc6bee4[_0x1837f8(0x1e6)]&&Object[_0x1837f8(0xf3)](SYSTEM_MODES)[_0x1837f8(0x1c5)](_0xc6bee4[_0x1837f8(0x1e6)])){this[_0x1837f8(0x283)]=_0xc6bee4[_0x1837f8(0x1e6)];if(_0xc6bee4[_0x1837f8(0x1e6)]===SYSTEM_MODES[_0x1837f8(0x144)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0xc6bee4['ack'])this[_0x1837f8(0x9a)](_0x455cbe,{'val':this[_0x1837f8(0x283)],'ack':!![]});return;}if(!_0xc6bee4[_0x1837f8(0x183)]){_0x455cbe[_0x1837f8(0x1c5)](_0x1837f8(0x1d0))&&_0xc6bee4[_0x1837f8(0x1e6)]&&(this[_0x1837f8(0x9a)](_0x455cbe,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x455cbe[_0x1837f8(0x1c5)](_0x1837f8(0x201))&&_0xc6bee4[_0x1837f8(0x1e6)]){this[_0x1837f8(0x9a)](_0x455cbe,{'val':![],'ack':!![]});if(this[_0x1837f8(0x211)])createDailyDigest(this);}_0x455cbe[_0x1837f8(0x1c5)](_0x1837f8(0x1de))&&_0xc6bee4[_0x1837f8(0x1e6)]&&(this[_0x1837f8(0x9a)](_0x455cbe,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x455cbe['includes'](_0x1837f8(0x210))&&_0xc6bee4['val']&&(this[_0x1837f8(0x9a)](_0x455cbe,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x455cbe[_0x1837f8(0x1c5)](_0x1837f8(0x1e5))&&_0xc6bee4[_0x1837f8(0x1e6)]){this[_0x1837f8(0x9a)](_0x455cbe,{'val':![],'ack':!![]});if(!this[_0x1837f8(0x211)])return;try{const _0x48bad2=await this[_0x1837f8(0x1c3)](_0x1837f8(0x25c));if(_0x48bad2&&_0x48bad2[_0x1837f8(0x1e6)]){const _0x214034=JSON[_0x1837f8(0x25e)](_0x48bad2[_0x1837f8(0x1e6)]);this['log'][_0x1837f8(0x221)](_0x1837f8(0x25a)),this[_0x1837f8(0x77)](_0x1837f8(0x170),{'val':_0x1837f8(0x167),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x214034});}}catch(_0x51cf0d){this[_0x1837f8(0x162)][_0x1837f8(0x191)](_0x1837f8(0x147)+_0x51cf0d[_0x1837f8(0x13e)]);}}if(_0x455cbe[_0x1837f8(0x1c5)](_0x1837f8(0x270))&&_0xc6bee4['val']){this['setState'](_0x455cbe,{'val':![],'ack':!![]});if(!this[_0x1837f8(0x211)])return;try{const _0x168a3c=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x168a3c&&_0x168a3c[_0x1837f8(0x1e6)]){const _0x4dd62e=JSON[_0x1837f8(0x25e)](_0x168a3c[_0x1837f8(0x1e6)]);this[_0x1837f8(0x162)][_0x1837f8(0x221)](_0x1837f8(0x13c)),sendToPython(this,_0x1837f8(0xf5),{'digests':_0x4dd62e});}}catch(_0x23a881){this['log']['error'](_0x1837f8(0x1e7)+_0x23a881[_0x1837f8(0x13e)]);}}if(_0x455cbe[_0x1837f8(0x1c5)]('analysis.training.triggerEnergy')&&_0xc6bee4[_0x1837f8(0x1e6)]){this[_0x1837f8(0x9a)](_0x455cbe,{'val':![],'ack':!![]});if(!this[_0x1837f8(0x211)])return;try{const _0x23b758=await this[_0x1837f8(0x1c3)](_0x1837f8(0x155));if(_0x23b758&&_0x23b758['val']){const _0x138155=JSON[_0x1837f8(0x25e)](_0x23b758[_0x1837f8(0x1e6)]);this[_0x1837f8(0x162)][_0x1837f8(0x221)](_0x1837f8(0x190)),sendToPython(this,_0x1837f8(0x216),{'points':_0x138155});}}catch(_0x68b1ac){this[_0x1837f8(0x162)][_0x1837f8(0x191)](_0x1837f8(0xde)+_0x68b1ac[_0x1837f8(0x13e)]);}}return;}if(this[_0x1837f8(0x256)][_0x1837f8(0x250)]&&this[_0x1837f8(0x256)][_0x1837f8(0x250)][_0x1837f8(0x1c5)](_0x455cbe)){await checkWifiPresence(this);return;}const _0x1f7657=(this[_0x1837f8(0x256)][_0x1837f8(0x195)]||[])['find'](_0x3cd85f=>_0x3cd85f['id']===_0x455cbe);if(_0x1f7657)processSensorEvent(this,_0x455cbe,_0xc6bee4,_0x1f7657);}async['onMessage'](_0x1f3819){const _0x1ae892=a0_0x481010;if(typeof _0x1f3819===_0x1ae892(0x265)&&_0x1f3819[_0x1ae892(0x13e)])try{if(_0x1f3819[_0x1ae892(0x286)]==='testApiKey'){const _0x480232=_0x1f3819[_0x1ae892(0x13e)]['apiKey']||this['config'][_0x1ae892(0x298)];if(!_0x480232)return this[_0x1ae892(0x20c)](_0x1f3819['from'],_0x1f3819[_0x1ae892(0x286)],{'success':![],'message':_0x1ae892(0x20e)},_0x1f3819[_0x1ae892(0x1f2)]);try{const _0x33a279=new GoogleGenerativeAI(_0x480232),_0x2ec900=_0x33a279[_0x1ae892(0x22b)]({'model':GEMINI_MODEL}),_0x230e2e=await _0x2ec900[_0x1ae892(0x1db)](_0x1ae892(0x1b8)),_0x99facd=await _0x230e2e[_0x1ae892(0x227)],_0x363071=_0x99facd[_0x1ae892(0x11e)]();this[_0x1ae892(0x20c)](_0x1f3819['from'],_0x1f3819[_0x1ae892(0x286)],{'success':!![],'message':_0x1ae892(0x193)+_0x363071[_0x1ae892(0x88)](0x0,0x14)+'...'},_0x1f3819[_0x1ae892(0x1f2)]);}catch(_0x25c388){this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819['command'],{'success':![],'message':_0x1ae892(0x296)+_0x25c388[_0x1ae892(0x13e)]},_0x1f3819[_0x1ae892(0x1f2)]);}}else{if(_0x1f3819[_0x1ae892(0x286)]===_0x1ae892(0x120)){const _0x4173a3=await getWeatherContext(this),_0x13ddf6=await getCalendarContext(this);this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819['command'],{'success':!![],'weather':_0x4173a3,'calendar':_0x13ddf6},_0x1f3819[_0x1ae892(0x1f2)]);}else{if(_0x1f3819[_0x1ae892(0x286)]===_0x1ae892(0x17d)){}else{if(_0x1f3819[_0x1ae892(0x286)]==='getLtmData'){if(!this[_0x1ae892(0x211)])return this[_0x1ae892(0x20c)](_0x1f3819['from'],_0x1f3819[_0x1ae892(0x286)],{'success':![],'isPro':![]},_0x1f3819[_0x1ae892(0x1f2)]);let _0x33df5c={'status':_0x1ae892(0x1d4),'details':'','lastCheck':0x0};try{_0x33df5c[_0x1ae892(0x1a2)]=(await this[_0x1ae892(0x1c3)](LTM_DP_DRIFT_STATUS))[_0x1ae892(0x1e6)],_0x33df5c['details']=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x1ae892(0x1e6)],_0x33df5c[_0x1ae892(0x234)]=(await this[_0x1ae892(0x1c3)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x53cd5f){}const _0x5dff01=this['analysisHistory']||[];this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x33df5c,'analysisHistory':_0x5dff01},_0x1f3819['callback']);}else{if(_0x1f3819[_0x1ae892(0x286)]===_0x1ae892(0x22e)){const _0x5df95a=this[_0x1ae892(0x109)][_0x1ae892(0x207)],_0x5159ea=new Date(),_0x199eb1=new Date(_0x5159ea[_0x1ae892(0x20b)](),_0x5159ea[_0x1ae892(0xee)](),_0x5159ea['getDate']())[_0x1ae892(0x22c)](),_0x2ed05a=this[_0x1ae892(0x27e)][_0x1ae892(0x1d9)](_0x291c68=>new Date(_0x291c68['timestamp'])[_0x1ae892(0x22c)]()>_0x199eb1)[_0x1ae892(0x207)],_0x1bd4ca=new Array(0x18)['fill'](0x0);this[_0x1ae892(0x27e)]['forEach'](_0x33bb25=>{const _0x52758c=_0x1ae892,_0x269eb1=new Date(_0x33bb25[_0x52758c(0x276)]);if(_0x269eb1['getTime']()>_0x199eb1)_0x1bd4ca[_0x269eb1[_0x52758c(0x1b4)]()]++;});let _0x247703={'status':_0x1ae892(0x1d4)};try{_0x247703[_0x1ae892(0x1a2)]=(await this[_0x1ae892(0x1c3)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x10fd4b){}let _0xaf5a14='';try{const _0x16c9de=await this['getStateAsync'](_0x1ae892(0x1d8));_0xaf5a14=_0x16c9de?_0x16c9de[_0x1ae892(0x1e6)]:'';}catch(_0x22884d){}let _0x262b94=null;!this[_0x1ae892(0x1a1)]&&(_0x262b94=this[_0x1ae892(0x256)][_0x1ae892(0x298)]?_0x1ae892(0x80):_0x1ae892(0x2a4));let _0x174447={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x443d16=await this[_0x1ae892(0x1c3)](_0x1ae892(0x1bc)),_0x3a65e5=await this[_0x1ae892(0x1c3)](_0x1ae892(0x163)),_0x3dcada=await this[_0x1ae892(0x1c3)](_0x1ae892(0xb6)),_0x195714=await this['getStateAsync'](_0x1ae892(0xcc)),_0x5ce78e=await this[_0x1ae892(0x1c3)]('analysis.automation.autoApply');_0x443d16&&_0x443d16[_0x1ae892(0x1e6)]&&(_0x174447[_0x1ae892(0x205)]=!![],_0x174447[_0x1ae892(0x1f6)]=_0x3a65e5?_0x3a65e5[_0x1ae892(0x1e6)]:'',_0x174447[_0x1ae892(0x91)]=_0x3dcada?_0x3dcada['val']:'',_0x174447['targetValue']=_0x195714?_0x195714[_0x1ae892(0x1e6)]:''),_0x174447[_0x1ae892(0x1bf)]=_0x5ce78e?!!_0x5ce78e['val']:![];}catch(_0x580883){}this['sendTo'](_0x1f3819[_0x1ae892(0x198)],_0x1f3819[_0x1ae892(0x286)],{'success':!![],'eventHistory':this[_0x1ae892(0xa0)]['slice'](0x0,0xf),'stats':{'digestCount':_0x5df95a,'eventCountToday':_0x2ed05a,'hourlyActivity':_0x1bd4ca,'driftStatus':_0x247703[_0x1ae892(0x1a2)],'isPresent':this[_0x1ae892(0x114)],'presenceWho':_0xaf5a14,'minDays':this[_0x1ae892(0x256)]['minDaysForBaseline']||0x7,'stbDays':this[_0x1ae892(0x256)][_0x1ae892(0x28d)]||0xe,'ltbDays':this[_0x1ae892(0x256)][_0x1ae892(0x146)]||0x3c,'systemError':_0x262b94},'automation':_0x174447},_0x1f3819[_0x1ae892(0x1f2)]);}else{if(_0x1f3819[_0x1ae892(0x286)]===_0x1ae892(0x154)){const _0x1983c2=await this[_0x1ae892(0x179)](_0x1ae892(0x10c),_0x1ae892(0x1be)),_0x2ceea0=[];if(_0x1983c2)for(const _0x1181de in _0x1983c2){const _0x47b54a=_0x1983c2[_0x1181de],_0x1a4885=(_0x47b54a[_0x1ae892(0x108)]&&typeof _0x47b54a[_0x1ae892(0x108)][_0x1ae892(0x2a0)]===_0x1ae892(0x265)?_0x47b54a[_0x1ae892(0x108)]['name']['de']:_0x47b54a[_0x1ae892(0x108)][_0x1ae892(0x2a0)])||_0x47b54a[_0x1ae892(0x108)][_0x1ae892(0x2a0)];_0x2ceea0[_0x1ae892(0xf4)]({'id':_0x1181de,'name':_0x1a4885});}this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819[_0x1ae892(0x286)],{'success':!![],'enums':_0x2ceea0},_0x1f3819[_0x1ae892(0x1f2)]);}else{if(_0x1f3819[_0x1ae892(0x286)]===_0x1ae892(0x15b))try{const _0x4a767f=await scanForDevices(this,_0x1f3819[_0x1ae892(0x13e)]||{});this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819['command'],{'success':!![],'devices':_0x4a767f},_0x1f3819['callback']);}catch(_0x1f8cb6){this['sendTo'](_0x1f3819[_0x1ae892(0x198)],_0x1f3819[_0x1ae892(0x286)],{'success':![],'error':_0x1f8cb6['message']},_0x1f3819[_0x1ae892(0x1f2)]);}else{if(_0x1f3819['command']===_0x1ae892(0x10d)){const _0x5ca2a7=_0x1f3819[_0x1ae892(0x13e)][_0x1ae892(0x260)];if(!_0x5ca2a7)return this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819[_0x1ae892(0x286)],{'success':![],'error':'No\x20instance'},_0x1f3819[_0x1ae892(0x1f2)]);const _0x23a522=await getCalendarNames(this,_0x5ca2a7);this['sendTo'](_0x1f3819[_0x1ae892(0x198)],_0x1f3819[_0x1ae892(0x286)],{'success':!![],'names':_0x23a522},_0x1f3819[_0x1ae892(0x1f2)]);}else{if(_0x1f3819[_0x1ae892(0x286)]===_0x1ae892(0x18c)){const {targetId:_0x438e47,targetValue:_0xf255be}=_0x1f3819[_0x1ae892(0x13e)];this[_0x1ae892(0x162)][_0x1ae892(0x221)]('üß™\x20Simulating\x20Butler\x20Proposal:\x20'+_0x438e47+_0x1ae892(0x29d)+_0xf255be),await this[_0x1ae892(0x77)](_0x1ae892(0x1bc),{'val':!![],'ack':!![]}),await this[_0x1ae892(0x77)](_0x1ae892(0x163),{'val':_0x1ae892(0x94)+_0x438e47,'ack':!![]}),await this[_0x1ae892(0x77)](_0x1ae892(0xb6),{'val':_0x438e47,'ack':!![]}),await this[_0x1ae892(0x77)]('analysis.automation.targetValue',{'val':_0xf255be,'ack':!![]}),this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819[_0x1ae892(0x286)],{'success':!![]},_0x1f3819['callback']);}else{if(_0x1f3819['command']==='submitFeedback'){const {historyId:_0x226fce,rating:_0x23a772,comment:_0x245786,alertReason:_0x57fbf7}=_0x1f3819[_0x1ae892(0x13e)];_0x226fce&&_0x23a772?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x226fce,'rating':_0x23a772,'comment':_0x245786,'alertReason':_0x57fbf7}),this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819['command'],{'success':!![]},_0x1f3819[_0x1ae892(0x1f2)])):this[_0x1ae892(0x20c)](_0x1f3819[_0x1ae892(0x198)],_0x1f3819[_0x1ae892(0x286)],{'success':![],'error':_0x1ae892(0xd6)},_0x1f3819[_0x1ae892(0x1f2)]);}else _0x1f3819['command']===_0x1ae892(0x127)&&(this[_0x1ae892(0x162)][_0x1ae892(0x221)](_0x1ae892(0xb8)),await this[_0x1ae892(0x77)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x1ae892(0x77)](_0x1ae892(0x163),{'val':'','ack':!![]}),this[_0x1ae892(0x20c)](_0x1f3819['from'],_0x1f3819[_0x1ae892(0x286)],{'success':!![]},_0x1f3819[_0x1ae892(0x1f2)]));}}}}}}}}}}catch(_0x2b4dbb){this[_0x1ae892(0x162)][_0x1ae892(0x191)](_0x1ae892(0x1ff)+_0x1f3819[_0x1ae892(0x286)]+':\x20'+_0x2b4dbb[_0x1ae892(0x13e)]);if(_0x1f3819['callback'])this[_0x1ae892(0x20c)](_0x1f3819['from'],_0x1f3819[_0x1ae892(0x286)],{'success':![],'error':_0x2b4dbb[_0x1ae892(0x13e)]},_0x1f3819['callback']);}}}if(require['main']!==module)module[a0_0x481010(0x297)]=_0x1ce946=>new CogniLiving(_0x1ce946);else new CogniLiving();