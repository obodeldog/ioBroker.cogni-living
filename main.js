const a0_0x2c8e3e=a0_0x4278;(function(_0x32c2b4,_0x126b0e){const _0x561b26=a0_0x4278,_0x5ad255=_0x32c2b4();while(!![]){try{const _0xad8007=-parseInt(_0x561b26(0x214))/0x1*(parseInt(_0x561b26(0xe7))/0x2)+parseInt(_0x561b26(0x157))/0x3+parseInt(_0x561b26(0x238))/0x4+parseInt(_0x561b26(0x192))/0x5*(parseInt(_0x561b26(0x15d))/0x6)+parseInt(_0x561b26(0x154))/0x7+parseInt(_0x561b26(0x13b))/0x8+parseInt(_0x561b26(0x183))/0x9*(-parseInt(_0x561b26(0x213))/0xa);if(_0xad8007===_0x126b0e)break;else _0x5ad255['push'](_0x5ad255['shift']());}catch(_0x4ac798){_0x5ad255['push'](_0x5ad255['shift']());}}}(a0_0x15cb,0xa8444));const a0_0x4b9618=(function(){let _0x527a8b=!![];return function(_0x59ba2b,_0x4c0f85){const _0x3d9b21=_0x527a8b?function(){if(_0x4c0f85){const _0x37963b=_0x4c0f85['apply'](_0x59ba2b,arguments);return _0x4c0f85=null,_0x37963b;}}:function(){};return _0x527a8b=![],_0x3d9b21;};}()),a0_0x3ad28c=a0_0x4b9618(this,function(){const _0x54e8d7=a0_0x4278;return a0_0x3ad28c[_0x54e8d7(0x12d)]()[_0x54e8d7(0x1b5)](_0x54e8d7(0x1ca))[_0x54e8d7(0x12d)]()['constructor'](a0_0x3ad28c)['search'](_0x54e8d7(0x1ca));});function a0_0x15cb(){const _0x1d6362=['triggerEnergyPrediction\x20Error:\x20','common','checkLicense','getTime','appendToLog','endsWith','callback','setHours','activeModules','application/json','system.adapter.ical.','temperature','enum.rooms.*','analysis.training.status','startSystem','pressureBuffer','DAY','forecast.current.weather','getForeignStateAsync','calendarCheckTimer','system','Aktiv\x20(','string','processSensorEvent','open','1077740nGRPwm','subscribeForeignStatesAsync','ðŸ”®\x20Energy\x20Prediction\x20triggered\x20(','./lib/scanner','Room\x20Dwell\x20Time\x20Stats','useCalendar','response','weatherunderground.0','testApiKey','ðŸ“¦\x20Restored\x20','system.adapter.ical.é¦™','command','analysis.energy.warmupTargets','value','updateHealthVector','memoryCache','now','TRAIN_TOPOLOGY','protectAiMemory','moduleSecurity','Corrupt','ltmJob','json','analysis.automation.description','initZombies','infrasoundEnabled','fill','triggerGaitAnalysis\x20error:\x20','98CXgbHl','threshold_exceeded','abortExitTimer','config','scanForDevices','split','ðŸ”Š\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','initHistory','\x20(Bewohner\x20anwesend\x20-\x20normal)','stringify','setDate','Gemini\x20Report\x20Night','includes','sensorLastValues','enum','calendarName','some','info','VACATION','historyJob','subscribeForeignStates','forEach','getHistoryData','scanDevices','bind','getEnums','object','parse','briefingJob','dailyDigests','toLocaleDateString','max','sendTo','LTM.dailyDigests','error','checkWifiPresence:\x20Error\x20checking\x20','ðŸš¨\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','heiter','Init...','de-DE','saveDailyHistory','analysis.health.todayRoomDetails','getGenerativeModel','Â°C,\x20AuÃŸen:\x20','\x20Tage)','runPythonHealthCheck','toLocaleTimeString','bin','onStateChange','presenceDevices','window','triggerHealth\x20error:\x20','No\x20data','security','SET_LEARNING_MODE','name','rows','message','analysis.energy.warmupSources','checkCalendarTriggers','min','runGeminiAnalysis','createDailyDigest','join','setState','createAllObjects','\x20(Threshold)','slice','âš \x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','./lib/ai_agent','toString','Manual\x20Event','stopService','currentSystemMode','moduleEnergy','geminiModel','Say\x20Hello','getAbsoluteDefaultDataDir','./lib/python_bridge','existsSync','onMessage','inactivityThresholdHours','LTM.rawEventLog',':\x20Temp-Differenz\x20','7379504GqAhHx','state','readFileSync','loadSystemMode','triggerDailyDigest','analysis.visualization.pulse','health','./lib/setup','2-digit','\x20events\x20from\x20standard\x20storage.','runAutopilot','toISOString','ack','Gute\x20LÃ¼ftungsmÃ¶glichkeit!','instance','sources','analysis.automation.patternDetected','path','round','Current.WeatherText','roomIntegratorTimer','Niemand','debug','triggerGaitAnalysis','system.presenceWho','9424576ClmzTi','shift','lastTrackerEventTime','3716124PygbSk','ðŸš¶\x20Gait\x20Analysis\x20triggered\x20with\x20','analysis.prediction.trackerConfidence','times','filter','all','12774FUvunh','checkWifiPresence','analysis.activity.roomStats','Lernphase\x20(','manual','unshift','handleInfrasound','Gemini\x20Report\x20Day','daswetter.0','getStateAsync','setObjectNotExistsAsync','date','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','presenceCheckTimer','thermostat','NextHours.Location_1.Day_1.current.symbol_desc','.data.table','TRAIN_SECURITY','genAI','analysisTimer','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','setStateAsync','SYSTEM_MODES','history','{\x22history\x22:{}}','getOverviewData','analysis.training.triggerEnergy','todayVector','\x20rooms)','analysis.safety.infrasoundAlert','toFixed','infrasoundSensorId','add','dependencyInstallInProgress','getDate','TRAIN_HEALTH','isGracePeriodActive','./lib/scheduler','26154081xLVkpB','scheduleJob','â˜€ï¸\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','Sonne:\x20','geminiApiKey','cancel','analysis.security.lastScore','triggerBriefing','sendMorningBriefing','number','getForeignObjectsAsync','analysis.health.todayVector','getHours','Adapter','Event','105VjRaDv','val','telegram','executeAutomationAction','Gemini\x20Init\x20Error:\x20','...','refreshCalendar','analysis.trigger','ðŸ’¨\x20LÃ¼ftung\x20in\x20','.last_seen','from','substring','ANALYZE_GAIT','./lib/automation','infrasoundLocked','scanThermostats','âœ…\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','General\x20Activity\x20Trend','version','analysis.activity.roomHistory','sendNotification','rawEventLog','Daily\x20Room\x20Details\x20(48x30min)','ready','initSchedules','text','comfort','generateHealthReport','devices','pop','Warte\x20auf\x20Analyse...','klar','isProVersion','motion','automation.triggerAction','search','.uptime','updateSchedulePreview','toLowerCase','pulse','Verbindung\x20erfolgreich:\x20','mkdirSync','LTM.trainingData.sequences','warn','./lib/topology','LTM.triggerDailyDigest','moduleComfort','Scan\x20Error:\x20','startService','infrasoundThreshold','Room\x20History\x20(24h\x20Buckets)','Keine\x20Daten','Â°C\x20(Innen:\x20','setPresence','onUnload','systemConfig','(((.+)+)+)+$','analyzeWindowOpening\x20error:\x20','./lib/installer','push','Unbekannt','abs','communicate.request','events.history','.system.mode',',\x20Events:\x0a','PREDICT_ENERGY','send','type','.json','length','analysis.energy.warmupTimes','checkSolarCondition','eventHistory','\x20-\x20','Guest\x20Mode','energy','triggerInfrasoundCorrelation','models/gemini-flash-latest','NORMAL','exports','Standard','getMinutes','infrasoundArmingId','ðŸ’¾\x20Saving\x20Daily\x20History\x20for\x20','\x20Kalender-Adapter\x20gefunden.','reduce','Â°C)','getObjectViewAsync','analysis.ventilation.lastWindow','utf8','analysis.prediction.trackerTopRoom','generateContent','analysis.health.geminiNight','analysis.automation.targetId','isPresent','@google/generative-ai','Warm-Up\x20Time','\x20>\x20','sunny','onReady','values','healthTrendInterval','python','analysis.training.triggerSecurity','LTM.baselineStatus','haustÃ¼r','find','bootTime','Unknown','ðŸ”Š\x20Infraschall:\x20','analysis.training.triggerHealth','triggerEnergyPrediction','log','refreshCalendar\x20failed:\x20','analyzeWindowOpening','SYSTEM_DP_MODE','clear','Party\x20Mode','@iobroker/adapter-core','lastAlertState','weatherTempId','cogni-living','analysis.health.activityTrend','cleanupGhostInterventions','trackerHeartbeat','timestamp','online','guest','10tadBxW','4621nRmNMg','modules','isArray','isSolar','Sec-Training\x20started...','moduleHealth','stateChange','CALCULATE_HEALTH_TREND','analysisHistory','subscribeStates','location'];a0_0x15cb=function(){return _0x1d6362;};return a0_0x15cb();}a0_0x3ad28c();function a0_0x4278(_0xa8db1a,_0x175b95){const _0x168380=a0_0x15cb();return a0_0x4278=function(_0x3ad28c,_0x4b9618){_0x3ad28c=_0x3ad28c-0xd0;let _0x15cbd6=_0x168380[_0x3ad28c];return _0x15cbd6;},a0_0x4278(_0xa8db1a,_0x175b95);}'use strict';const utils=require(a0_0x2c8e3e(0x209)),{GoogleGenerativeAI}=require(a0_0x2c8e3e(0x1f2)),path=require(a0_0x2c8e3e(0x14c)),fs=require('fs'),installer=require(a0_0x2c8e3e(0x1cc)),scanner=require(a0_0x2c8e3e(0x23b)),schedulers=require(a0_0x2c8e3e(0x182)),topology=require(a0_0x2c8e3e(0x1be)),setup=require(a0_0x2c8e3e(0x142)),recorder=require('./lib/recorder'),pythonBridge=require(a0_0x2c8e3e(0x135)),aiAgent=require(a0_0x2c8e3e(0x12c)),deadMan=require('./lib/dead_man'),automation=require(a0_0x2c8e3e(0x19f)),GEMINI_MODEL=a0_0x2c8e3e(0x1e0);class CogniLiving extends utils[a0_0x2c8e3e(0x190)]{constructor(_0xfa3c20){const _0x18b63e=a0_0x2c8e3e;super({..._0xfa3c20,'name':_0x18b63e(0x20c)}),this['eventHistory']=[],this[_0x18b63e(0x21c)]=[],this[_0x18b63e(0x1a7)]=[],this[_0x18b63e(0x104)]=[],this['sensorLastValues']={},this[_0x18b63e(0x1c9)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x18b63e(0x181)]=![],this[_0x18b63e(0x16f)]=null,this['geminiModel']=null,this['currentSystemMode']=setup[_0x18b63e(0x173)][_0x18b63e(0x1e1)],this[_0x18b63e(0x1b2)]=![],this[_0x18b63e(0x20a)]=![],this[_0x18b63e(0x170)]=null,this[_0x18b63e(0x232)]=null,this[_0x18b63e(0x16a)]=null,this[_0x18b63e(0xe0)]=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this[_0x18b63e(0x103)]=null,this[_0x18b63e(0xfa)]=null,this[_0x18b63e(0x20f)]=null,this[_0x18b63e(0x1f8)]=null,this[_0x18b63e(0x14f)]=null,this[_0x18b63e(0x17e)]=![],this[_0x18b63e(0x156)]=Date['now'](),this[_0x18b63e(0xda)]=null,this[_0x18b63e(0x1fe)]=Date['now'](),this[_0x18b63e(0x1a0)]=![],this[_0x18b63e(0x22e)]=[],this[_0x18b63e(0x227)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x18b63e(0x1a9),this['onReady'][_0x18b63e(0xff)](this)),this['on'](_0x18b63e(0x21a),this['onStateChange'][_0x18b63e(0xff)](this)),this['on']('unload',this[_0x18b63e(0x1c8)][_0x18b63e(0xff)](this)),this['on'](_0x18b63e(0x120),this[_0x18b63e(0x137)][_0x18b63e(0xff)](this));}async[a0_0x2c8e3e(0x1f6)](){const _0x496080=a0_0x2c8e3e;this[_0x496080(0x203)][_0x496080(0xf8)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x496080(0x1a4)]+')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)');if(this[_0x496080(0xea)][_0x496080(0x219)]!==undefined)this[_0x496080(0x227)][_0x496080(0x141)]=this[_0x496080(0xea)][_0x496080(0x219)];if(this['config'][_0x496080(0xde)]!==undefined)this[_0x496080(0x227)][_0x496080(0x11c)]=this[_0x496080(0xea)]['moduleSecurity'];if(this['config'][_0x496080(0x131)]!==undefined)this['activeModules'][_0x496080(0x1de)]=this[_0x496080(0xea)]['moduleEnergy'];if(this[_0x496080(0xea)][_0x496080(0x1c0)]!==undefined)this['activeModules'][_0x496080(0x1ac)]=this['config']['moduleComfort'];if(this['config'][_0x496080(0x215)])this['activeModules']={...this[_0x496080(0x227)],...this[_0x496080(0xea)][_0x496080(0x215)]};this[_0x496080(0x22d)]();}async[a0_0x2c8e3e(0x22d)](){const _0x2ba90b=a0_0x2c8e3e;await setup[_0x2ba90b(0xe3)](this);try{this[_0x2ba90b(0x1b2)]=await setup[_0x2ba90b(0x221)](this['config']['licenseKey']);}catch(_0xcee1fe){}if(!this[_0x2ba90b(0xea)][_0x2ba90b(0x138)]||this[_0x2ba90b(0xea)][_0x2ba90b(0x138)]<0.1)this[_0x2ba90b(0xea)][_0x2ba90b(0x138)]=0xc;await setup[_0x2ba90b(0xee)](this),await setup['initSystemConfig'](this);try{const _0x285757=await this[_0x2ba90b(0x166)](_0x2ba90b(0x1d9)),_0x13669b=await this[_0x2ba90b(0x166)]('analysis.energy.warmupSources');_0x285757&&_0x285757[_0x2ba90b(0x193)]&&_0x13669b&&_0x13669b[_0x2ba90b(0x193)]&&(Date[_0x2ba90b(0xdb)]()-_0x285757['ts']<0x4*0xe10*0x3e8&&(this['memoryCache']={'times':JSON[_0x2ba90b(0x102)](_0x285757[_0x2ba90b(0x193)]),'sources':JSON[_0x2ba90b(0x102)](_0x13669b['val'])}));}catch(_0x3a61f1){}if(this[_0x2ba90b(0xea)][_0x2ba90b(0x187)])try{this[_0x2ba90b(0x16f)]=new GoogleGenerativeAI(this[_0x2ba90b(0xea)][_0x2ba90b(0x187)]),this[_0x2ba90b(0x132)]=this[_0x2ba90b(0x16f)][_0x2ba90b(0x111)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2ba90b(0x228)}});}catch(_0x341e09){this['log'][_0x2ba90b(0x109)](_0x2ba90b(0x196)+_0x341e09[_0x2ba90b(0x120)]);}await setup[_0x2ba90b(0x128)](this),await this['loadSystemMode'](),schedulers[_0x2ba90b(0x1aa)](this),await this[_0x2ba90b(0x167)](_0x2ba90b(0x140),{'type':_0x2ba90b(0x13c),'common':{'name':'Live\x20Event\x20Pulse','type':_0x2ba90b(0x18c),'role':_0x2ba90b(0xd8),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2ba90b(0x15f),{'type':_0x2ba90b(0x13c),'common':{'name':_0x2ba90b(0x23c),'type':_0x2ba90b(0x235),'role':'json','read':!![],'write':![],'def':_0x2ba90b(0x171)},'native':{}}),await this[_0x2ba90b(0x167)](_0x2ba90b(0x1a5),{'type':_0x2ba90b(0x13c),'common':{'name':_0x2ba90b(0x1c4),'type':'string','role':_0x2ba90b(0xe1),'read':!![],'write':![],'def':_0x2ba90b(0x175)},'native':{}}),await this['setObjectNotExistsAsync'](_0x2ba90b(0x1ef),{'type':_0x2ba90b(0x13c),'common':{'name':_0x2ba90b(0xf2),'type':_0x2ba90b(0x235),'role':_0x2ba90b(0x1ab),'read':!![],'write':![],'def':_0x2ba90b(0x1b0)},'native':{}}),await this[_0x2ba90b(0x167)]('analysis.health.geminiDay',{'type':_0x2ba90b(0x13c),'common':{'name':_0x2ba90b(0x164),'type':_0x2ba90b(0x235),'role':_0x2ba90b(0x1ab),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x2ba90b(0x167)]('analysis.health.todayVector',{'type':_0x2ba90b(0x13c),'common':{'name':'Daily\x20Activity\x20Vector\x20(48x30min)','type':_0x2ba90b(0x235),'role':_0x2ba90b(0xe1),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x2ba90b(0x167)](_0x2ba90b(0x110),{'type':_0x2ba90b(0x13c),'common':{'name':_0x2ba90b(0x1a8),'type':_0x2ba90b(0x235),'role':_0x2ba90b(0xe1),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x2ba90b(0x167)]('analysis.health.activityTrend',{'type':_0x2ba90b(0x13c),'common':{'name':_0x2ba90b(0x1a3),'type':_0x2ba90b(0x18c),'role':_0x2ba90b(0xd8),'unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x2ba90b(0x1d9),{'type':_0x2ba90b(0x13c),'common':{'name':_0x2ba90b(0x1f3),'type':'string','role':_0x2ba90b(0xe1),'read':!![],'write':![]},'native':{}});try{const _0x342099=await this[_0x2ba90b(0x166)](_0x2ba90b(0x1d1));if(_0x342099&&_0x342099['val']){this[_0x2ba90b(0x1db)]=JSON[_0x2ba90b(0x102)](_0x342099[_0x2ba90b(0x193)]);if(this[_0x2ba90b(0x1b2)]){const _0x11213e=await this[_0x2ba90b(0x166)](_0x2ba90b(0x139));if(_0x11213e&&_0x11213e['val'])this['rawEventLog']=JSON[_0x2ba90b(0x102)](_0x11213e[_0x2ba90b(0x193)]);}this[_0x2ba90b(0x203)][_0x2ba90b(0xf8)](_0x2ba90b(0xd4)+this['eventHistory'][_0x2ba90b(0x1d8)]+_0x2ba90b(0x144));}}catch(_0x59f377){this[_0x2ba90b(0x1db)]=[];}try{const _0x41804c=await this['getStateAsync'](_0x2ba90b(0x108));if(_0x41804c&&_0x41804c[_0x2ba90b(0x193)])this[_0x2ba90b(0x104)]=JSON[_0x2ba90b(0x102)](_0x41804c[_0x2ba90b(0x193)]);}catch(_0x3edd41){this[_0x2ba90b(0x104)]=[];}const _0x238b8b=this[_0x2ba90b(0x104)][_0x2ba90b(0x1d8)]>=(this[_0x2ba90b(0xea)]['minDaysForBaseline']||0x7)?_0x2ba90b(0x234)+this['dailyDigests'][_0x2ba90b(0x1d8)]+_0x2ba90b(0x113):_0x2ba90b(0x160)+this[_0x2ba90b(0x104)][_0x2ba90b(0x1d8)]+'/'+(this[_0x2ba90b(0xea)]['minDaysForBaseline']||0x7)+')';await this[_0x2ba90b(0x172)](_0x2ba90b(0x1fb),{'val':_0x238b8b,'ack':!![]}),this[_0x2ba90b(0x21d)](_0x2ba90b(0x199)),this['subscribeStates'](_0x2ba90b(0x1bf)),this[_0x2ba90b(0x21d)]('analysis.training.triggerHealth');this['config'][_0x2ba90b(0xe4)]&&this['config'][_0x2ba90b(0x17c)]&&this[_0x2ba90b(0x227)][_0x2ba90b(0x11c)]&&this[_0x2ba90b(0xfb)](this[_0x2ba90b(0xea)][_0x2ba90b(0x17c)]);const _0x3413f6=this[_0x2ba90b(0xea)][_0x2ba90b(0x1ae)];if(_0x3413f6)for(const _0x2bdfb0 of _0x3413f6){await this['subscribeForeignStatesAsync'](_0x2bdfb0['id']);}const _0x37e113=this[_0x2ba90b(0xea)][_0x2ba90b(0x118)];if(_0x37e113)for(const _0x59c46e of _0x37e113){await this[_0x2ba90b(0x239)](_0x59c46e);}const _0x5c33b3=require('node-schedule');if(this[_0x2ba90b(0xfa)])this[_0x2ba90b(0xfa)][_0x2ba90b(0x188)]();this[_0x2ba90b(0xfa)]=_0x5c33b3[_0x2ba90b(0x184)]('59\x2023\x20*\x20*\x20*',()=>{this['saveDailyHistory']();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this[_0x2ba90b(0x14f)])clearInterval(this[_0x2ba90b(0x14f)]);this['integrateRoomTime'](),this[_0x2ba90b(0x14f)]=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this['healthTrendInterval'])clearInterval(this[_0x2ba90b(0x1f8)]);this[_0x2ba90b(0x1f8)]=setInterval(()=>{const _0x144ac7=_0x2ba90b;this[_0x144ac7(0x1b2)]&&this['activeModules'][_0x144ac7(0x141)]&&this[_0x144ac7(0x114)]();},0x4*0x3c*0x3c*0x3e8);if(this['analysisTimer'])clearInterval(this[_0x2ba90b(0x170)]);this[_0x2ba90b(0x227)][_0x2ba90b(0x1de)]&&(this[_0x2ba90b(0x170)]=setInterval(()=>{const _0x4ecbc6=_0x2ba90b;this[_0x4ecbc6(0x202)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x2ba90b(0x202)](),0x2710));if(this['calendarCheckTimer'])clearInterval(this[_0x2ba90b(0x232)]);this[_0x2ba90b(0xea)][_0x2ba90b(0xd0)]&&this[_0x2ba90b(0x227)]['energy']&&(this['calendarCheckTimer']=setInterval(()=>{const _0x1b938c=_0x2ba90b;automation[_0x1b938c(0x122)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x2ba90b(0x122)](this),0x3a98));if(this[_0x2ba90b(0x16a)])clearInterval(this[_0x2ba90b(0x16a)]);this[_0x2ba90b(0xea)][_0x2ba90b(0x118)]&&this['config'][_0x2ba90b(0x118)][_0x2ba90b(0x1d8)]>0x0&&(this[_0x2ba90b(0x16a)]=setInterval(async()=>{const _0x473a8d=_0x2ba90b;await this[_0x473a8d(0x15e)]();},0x3c*0x3e8),setTimeout(async()=>await this['checkWifiPresence'](),0x1388));const _0x3b4ac3=path[_0x2ba90b(0x126)](__dirname,'.venv',_0x2ba90b(0x116),_0x2ba90b(0x1f9));pythonBridge[_0x2ba90b(0x1c2)](this,_0x3b4ac3);}['onUnload'](_0x20fb62){const _0x59c52b=a0_0x2c8e3e;if(this[_0x59c52b(0xfa)])this[_0x59c52b(0xfa)][_0x59c52b(0x188)]();this['saveDailyHistory']()['then'](()=>{const _0x4ae31f=_0x59c52b;if(this[_0x4ae31f(0x170)])clearInterval(this[_0x4ae31f(0x170)]);if(this[_0x4ae31f(0x232)])clearInterval(this[_0x4ae31f(0x232)]);if(this[_0x4ae31f(0x16a)])clearInterval(this['presenceCheckTimer']);if(this['roomIntegratorTimer'])clearInterval(this['roomIntegratorTimer']);recorder[_0x4ae31f(0xe9)](this),pythonBridge[_0x4ae31f(0x12f)](this),_0x20fb62();});}async['replayTodayEvents'](){const _0x5a97f2=a0_0x2c8e3e;if(!this['eventHistory']||this[_0x5a97f2(0x1db)][_0x5a97f2(0x1d8)]===0x0){this[_0x5a97f2(0x203)][_0x5a97f2(0x1bd)](_0x5a97f2(0x12b));return;}this['log']['info']('â†º\x20Replaying\x20'+this[_0x5a97f2(0x1db)][_0x5a97f2(0x1d8)]+'\x20events\x20from\x20today...');const _0x4cf644=new Date()[_0x5a97f2(0x226)](0x0,0x0,0x0,0x0),_0x2d90f2=_0x5a97f2(0x1a5);let _0x533292={'history':{},'date':new Date()[_0x5a97f2(0x105)]()};const _0x2f9110=_0x5a97f2(0x18e),_0x43191f='analysis.health.todayRoomDetails';let _0x517c51=new Array(0x30)[_0x5a97f2(0xe5)](0x0),_0x1b8477=Array[_0x5a97f2(0x19c)]({'length':0x30},()=>[]);this[_0x5a97f2(0x1db)][_0x5a97f2(0xfc)](_0x500350=>{const _0x2839f8=_0x5a97f2;if(_0x500350[_0x2839f8(0x210)]>=_0x4cf644){if(recorder['isRelevantActivity'](_0x500350[_0x2839f8(0x1d6)],_0x500350['value'])){const _0x29d81=new Date(_0x500350[_0x2839f8(0x210)]),_0x1be2e7=_0x29d81[_0x2839f8(0x18f)]()*0x2+(_0x29d81['getMinutes']()>=0x1e?0x1:0x0);if(_0x1be2e7<0x30){_0x517c51[_0x1be2e7]++;const _0x5ba605=_0x500350[_0x2839f8(0x21e)]||_0x500350[_0x2839f8(0x11e)]||'?';let _0x4283aa=_0x1b8477[_0x1be2e7];!_0x4283aa[_0x2839f8(0xf3)](_0x5ba605)&&_0x4283aa[_0x2839f8(0x1cd)](_0x5ba605);}const _0x58462f=_0x29d81[_0x2839f8(0x18f)]();let _0x5c2559=_0x500350[_0x2839f8(0x21e)]||_0x2839f8(0x1ff);const _0x4545ba=(this['config'][_0x2839f8(0x1ae)]||[])['find'](_0x1de5f4=>_0x1de5f4['location']===_0x5c2559);if(_0x4545ba)_0x5c2559=_0x4545ba['location'];if(!_0x533292[_0x2839f8(0x174)][_0x5c2559])_0x533292[_0x2839f8(0x174)][_0x5c2559]=new Array(0x18)[_0x2839f8(0xe5)](0x0);if(_0x533292[_0x2839f8(0x174)][_0x5c2559][_0x58462f]<0x3c)_0x533292['history'][_0x5c2559][_0x58462f]++;}}});const _0x294335=await this['getStateAsync'](_0x2d90f2);(!_0x294335||!_0x294335['val']||_0x294335[_0x5a97f2(0x193)]==='{}'||_0x294335[_0x5a97f2(0x193)]['includes']('\x22history\x22:{}'))&&await this['setStateAsync'](_0x2d90f2,{'val':JSON[_0x5a97f2(0xf0)](_0x533292),'ack':!![]}),await this[_0x5a97f2(0x172)](_0x2f9110,{'val':JSON['stringify'](_0x517c51),'ack':!![]}),await this[_0x5a97f2(0x172)](_0x43191f,{'val':JSON[_0x5a97f2(0xf0)](_0x1b8477),'ack':!![]}),this['log'][_0x5a97f2(0xf8)](_0x5a97f2(0x1a2));}async[a0_0x2c8e3e(0x10f)](){const _0x1acfc3=a0_0x2c8e3e;if(!this[_0x1acfc3(0x227)][_0x1acfc3(0x141)])return;const _0x1900ff=new Date()[_0x1acfc3(0x146)]()[_0x1acfc3(0xec)]('T')[0x0];this[_0x1acfc3(0x203)][_0x1acfc3(0x151)](_0x1acfc3(0x1e6)+_0x1900ff+_0x1acfc3(0x197));try{const [_0x8fd8c9,_0x215309,_0x197902,_0x4240a9,_0x58687e,_0x373d15]=await Promise[_0x1acfc3(0x15c)]([this[_0x1acfc3(0x166)](_0x1acfc3(0x1a5)),this[_0x1acfc3(0x166)](_0x1acfc3(0x1ef)),this['getStateAsync']('analysis.health.geminiDay'),this[_0x1acfc3(0x166)](_0x1acfc3(0x189)),this['getStateAsync'](_0x1acfc3(0x18e)),this[_0x1acfc3(0x166)]('analysis.health.activityTrend')]),_0x1095fc=this[_0x1acfc3(0x1db)][_0x1acfc3(0x15b)](_0x49bf08=>_0x49bf08[_0x1acfc3(0x210)]>=new Date()[_0x1acfc3(0x226)](0x0,0x0,0x0,0x0)&&(_0x49bf08['name']['toLowerCase']()[_0x1acfc3(0xf3)](_0x1acfc3(0x1fc))||_0x49bf08[_0x1acfc3(0x11e)]['toLowerCase']()['includes']('terrasse'))&&(_0x49bf08[_0x1acfc3(0xd8)]===!![]||_0x49bf08[_0x1acfc3(0xd8)]===_0x1acfc3(0x237)))[_0x1acfc3(0x1d8)];let _0x709851=0x55;if(_0x373d15&&_0x373d15[_0x1acfc3(0x193)]!==undefined)_0x709851=Math[_0x1acfc3(0x123)](0x64,Math[_0x1acfc3(0x106)](0x14,Math[_0x1acfc3(0x14d)](0x50+Number(_0x373d15[_0x1acfc3(0x193)])*0x5)));const _0x29b7a9={'date':_0x1900ff,'timestamp':Date[_0x1acfc3(0xdb)](),'roomHistory':_0x8fd8c9?.[_0x1acfc3(0x193)]?JSON[_0x1acfc3(0x102)](_0x8fd8c9[_0x1acfc3(0x193)]):{},'geminiNight':_0x215309?.[_0x1acfc3(0x193)]||'Keine\x20Daten','geminiDay':_0x197902?.['val']||_0x1acfc3(0x1c5),'anomalyScore':_0x4240a9?.[_0x1acfc3(0x193)]||0.1,'todayVector':_0x58687e?.[_0x1acfc3(0x193)]?JSON[_0x1acfc3(0x102)](_0x58687e[_0x1acfc3(0x193)]):new Array(0x30)[_0x1acfc3(0xe5)](0x0),'batteryLevel':_0x709851,'freshAirCount':_0x1095fc,'eventHistory':this[_0x1acfc3(0x1db)]},_0x1e81e5=utils[_0x1acfc3(0x134)](),_0x390321=path['join'](_0x1e81e5,_0x1acfc3(0x20c),_0x1acfc3(0x174));if(!fs[_0x1acfc3(0x136)](_0x390321))fs[_0x1acfc3(0x1bb)](_0x390321,{'recursive':!![]});const _0x588048=path['join'](_0x390321,_0x1900ff+_0x1acfc3(0x1d7));fs['writeFileSync'](_0x588048,JSON[_0x1acfc3(0xf0)](_0x29b7a9)),this[_0x1acfc3(0x203)][_0x1acfc3(0xf8)]('âœ…\x20History\x20saved:\x20'+_0x588048);}catch(_0x59ad77){this['log'][_0x1acfc3(0x109)]('History\x20Save\x20Error:\x20'+_0x59ad77[_0x1acfc3(0x120)]);}}async['integrateRoomTime'](){const _0xb00f3=a0_0x2c8e3e;if(!this[_0xb00f3(0x1f1)])return;try{let _0x7ddefd=null;try{const _0x17c7b7=await this[_0xb00f3(0x166)](_0xb00f3(0x1ed)),_0x241788=await this[_0xb00f3(0x166)](_0xb00f3(0x159));if(_0x17c7b7&&_0x17c7b7[_0xb00f3(0x193)]&&_0x241788&&_0x241788['val']&&_0x241788[_0xb00f3(0x193)]>0.3){if(_0x17c7b7[_0xb00f3(0x193)]!==_0xb00f3(0x1ff)&&_0x17c7b7[_0xb00f3(0x193)]!==_0xb00f3(0x10d))_0x7ddefd=_0x17c7b7['val'];}}catch(_0x28acd3){}if(!_0x7ddefd){const _0x307727=this[_0xb00f3(0xea)][_0xb00f3(0x1ae)]||[];for(const _0x14d047 of _0x307727){if(_0x14d047[_0xb00f3(0x1d6)]===_0xb00f3(0x1b3)&&_0x14d047[_0xb00f3(0x21e)])try{const _0x3cfa03=await this['getForeignStateAsync'](_0x14d047['id']);if(_0x3cfa03&&(_0x3cfa03[_0xb00f3(0x193)]===!![]||_0x3cfa03[_0xb00f3(0x193)]==='on'||_0x3cfa03[_0xb00f3(0x193)]===0x1)){_0x7ddefd=_0x14d047[_0xb00f3(0x21e)];break;}}catch(_0x5b8f67){}}}if(!_0x7ddefd)return;const _0x5f0a4b=this[_0xb00f3(0xea)][_0xb00f3(0x1ae)]||[];let _0x1c72b1=_0x7ddefd;const _0x19d63e=_0x5f0a4b[_0xb00f3(0x1fd)](_0x212da3=>_0x212da3[_0xb00f3(0x21e)]&&_0x212da3[_0xb00f3(0x21e)]['toLowerCase']()===_0x7ddefd['toLowerCase']());if(_0x19d63e)_0x1c72b1=_0x19d63e[_0xb00f3(0x21e)];const _0x473d11=_0xb00f3(0x1a5),_0x17ef00=await this[_0xb00f3(0x166)](_0x473d11),_0x1f1ece=new Date()['toLocaleDateString']();let _0x379ed7={'history':{},'date':_0x1f1ece};if(_0x17ef00&&_0x17ef00['val'])try{_0x379ed7=JSON[_0xb00f3(0x102)](_0x17ef00[_0xb00f3(0x193)]);}catch(_0x34f370){}_0x379ed7['date']!==_0x1f1ece&&(_0x379ed7[_0xb00f3(0x174)]={},_0x379ed7[_0xb00f3(0x168)]=_0x1f1ece);if(!_0x379ed7[_0xb00f3(0x174)][_0x1c72b1])_0x379ed7[_0xb00f3(0x174)][_0x1c72b1]=new Array(0x18)[_0xb00f3(0xe5)](0x0);const _0x4b2440=new Date()[_0xb00f3(0x18f)]();if(_0x379ed7[_0xb00f3(0x174)][_0x1c72b1][_0x4b2440]<0x3c)_0x379ed7[_0xb00f3(0x174)][_0x1c72b1][_0x4b2440]++;await this[_0xb00f3(0x172)](_0x473d11,{'val':JSON[_0xb00f3(0xf0)](_0x379ed7),'ack':!![]});}catch(_0x15a89b){this[_0xb00f3(0x203)]['warn']('[Integrator]\x20Error:\x20'+_0x15a89b[_0xb00f3(0x120)]);}}async[a0_0x2c8e3e(0x137)](_0x261972){const _0x492a55=a0_0x2c8e3e;if(typeof _0x261972===_0x492a55(0x101)&&_0x261972['message']){if(_0x261972[_0x492a55(0xd6)]===_0x492a55(0xfd)){const _0x5df29e=_0x261972[_0x492a55(0x120)][_0x492a55(0x168)],_0x26c18b=utils[_0x492a55(0x134)](),_0x7ad827=path['join'](_0x26c18b,_0x492a55(0x20c),_0x492a55(0x174),_0x5df29e+_0x492a55(0x1d7));if(fs[_0x492a55(0x136)](_0x7ad827))try{const _0x3cdcf6=JSON['parse'](fs[_0x492a55(0x13d)](_0x7ad827,_0x492a55(0x1ec)));this[_0x492a55(0x107)](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':!![],'data':_0x3cdcf6},_0x261972[_0x492a55(0x225)]);}catch(_0x1879af){this[_0x492a55(0x107)](_0x261972['from'],_0x261972[_0x492a55(0xd6)],{'success':![],'error':_0x492a55(0xdf)},_0x261972[_0x492a55(0x225)]);}else this[_0x492a55(0x107)](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':![],'error':_0x492a55(0x11b)},_0x261972['callback']);}else{if(_0x261972[_0x492a55(0xd6)]===_0x492a55(0x176)){const _0x2a7312=this['dailyDigests'][_0x492a55(0x1d8)];let _0x18b2c4=new Array(0x30)['fill'](0x0),_0x4aee56=Array['from']({'length':0x30},()=>[]);try{const _0x5d087f=await this[_0x492a55(0x166)](_0x492a55(0x18e));if(_0x5d087f&&_0x5d087f[_0x492a55(0x193)])_0x18b2c4=JSON[_0x492a55(0x102)](_0x5d087f[_0x492a55(0x193)]);const _0x2d3328=await this[_0x492a55(0x166)](_0x492a55(0x110));if(_0x2d3328&&_0x2d3328['val'])_0x4aee56=JSON['parse'](_0x2d3328[_0x492a55(0x193)]);}catch(_0x2e1e40){}let _0x17e9f3=new Array(0x30)[_0x492a55(0xe5)](0x0);try{const _0x4c8fe8=new Date();_0x4c8fe8[_0x492a55(0xf1)](_0x4c8fe8[_0x492a55(0x17f)]()-0x1);const _0x3923cb=_0x4c8fe8[_0x492a55(0x146)]()[_0x492a55(0xec)]('T')[0x0],_0x484f87=utils[_0x492a55(0x134)](),_0x1de508=path[_0x492a55(0x126)](_0x484f87,_0x492a55(0x20c),'history',_0x3923cb+'.json');if(fs['existsSync'](_0x1de508)){const _0x4942bd=JSON['parse'](fs[_0x492a55(0x13d)](_0x1de508,_0x492a55(0x1ec)));if(_0x4942bd&&_0x4942bd[_0x492a55(0x178)])_0x17e9f3=_0x4942bd['todayVector'];}}catch(_0x21bffc){}let _0x39d7f1={'today':{},'yesterday':{}};try{const _0x46cc94=await this[_0x492a55(0x166)](_0x492a55(0x15f));if(_0x46cc94&&_0x46cc94[_0x492a55(0x193)])_0x39d7f1=JSON[_0x492a55(0x102)](_0x46cc94['val']);}catch(_0x12517a){}let _0x40eb63=null;try{const _0x209a1d=await this['getStateAsync'](_0x492a55(0x20d));if(_0x209a1d)_0x40eb63=_0x209a1d['val'];}catch(_0x36ca4d){}if(_0x40eb63===undefined||_0x40eb63===null){const _0x33695b=_0x18b2c4[_0x492a55(0x1e8)]((_0x4f7c22,_0x286a8b)=>_0x4f7c22+_0x286a8b,0x0),_0xd28dcc=Math[_0x492a55(0x123)](0x2,Math['max'](-0x2,(0x64-_0x33695b)/0x32));_0x40eb63=_0xd28dcc;}let _0x16635d=![],_0x57a6b9='',_0x1b0cc8='',_0x11456b='';try{const _0x54b3dd=await this[_0x492a55(0x166)](_0x492a55(0x14b));if(_0x54b3dd&&_0x54b3dd[_0x492a55(0x193)]){_0x16635d=!![];const _0x2ea10b=await this['getStateAsync'](_0x492a55(0xe2));_0x57a6b9=_0x2ea10b?_0x2ea10b[_0x492a55(0x193)]:'';const _0x5b191d=await this[_0x492a55(0x166)](_0x492a55(0x1f0));_0x1b0cc8=_0x5b191d?_0x5b191d[_0x492a55(0x193)]:'';const _0x5c6e04=await this['getStateAsync']('analysis.automation.targetValue');_0x11456b=_0x5c6e04?_0x5c6e04['val']:'';}}catch(_0x476c5f){}const _0x482844=await this[_0x492a55(0x1da)](),_0x23a4bd=(this[_0x492a55(0xea)]['devices']||[])[_0x492a55(0xf7)](_0x535039=>_0x535039[_0x492a55(0x217)]),_0x150f78=_0x482844&&_0x23a4bd;let _0x2f31e9='';try{const _0x2146d7=await this['getStateAsync']('system.presenceWho');if(_0x2146d7&&_0x2146d7[_0x492a55(0x193)])_0x2f31e9=_0x2146d7[_0x492a55(0x193)];}catch(_0x162263){}this[_0x492a55(0x107)](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':!![],'eventHistory':this[_0x492a55(0x1db)][_0x492a55(0x12a)](0x0,0x7d0),'stats':{'digestCount':_0x2a7312,'isPresent':this['isPresent'],'hourlyActivity':_0x18b2c4,'hourlyDetails':_0x4aee56,'yesterdayActivity':_0x17e9f3,'solarActive':_0x150f78,'presenceWho':_0x2f31e9,'roomStats':_0x39d7f1,'activityTrend':_0x40eb63,'modules':this['activeModules']},'automation':{'detected':_0x16635d,'description':_0x57a6b9,'targetId':_0x1b0cc8,'targetValue':_0x11456b}},_0x261972[_0x492a55(0x225)]);}else{if(_0x261972['command']==='checkThermostats')try{const _0x1457b3=await automation[_0x492a55(0x1a1)](this);this['sendTo'](_0x261972[_0x492a55(0x19c)],_0x261972['command'],{'success':!![],'results':_0x1457b3},_0x261972['callback']);}catch(_0x57f17f){this['sendTo'](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':![],'error':_0x57f17f[_0x492a55(0x120)]},_0x261972['callback']);}else{if(_0x261972[_0x492a55(0xd6)]===_0x492a55(0xfe))try{const _0x163e41=await scanner[_0x492a55(0xeb)](this,_0x261972['message']||{});this['sendTo'](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':!![],'devices':_0x163e41},_0x261972[_0x492a55(0x225)]);}catch(_0x4c3f46){}else{if(_0x261972[_0x492a55(0xd6)]===_0x492a55(0x100)){const _0x155481=await this[_0x492a55(0x18d)]('enum.functions.*',_0x492a55(0xf5)),_0x5edab1=[];if(_0x155481)for(const _0x42b216 in _0x155481){let _0x4a51fb=_0x155481[_0x42b216][_0x492a55(0x220)][_0x492a55(0x11e)];if(_0x4a51fb&&typeof _0x4a51fb===_0x492a55(0x101))_0x4a51fb=_0x4a51fb['de']||_0x4a51fb['en']||Object[_0x492a55(0x1f7)](_0x4a51fb)[0x0]||JSON['stringify'](_0x4a51fb);_0x5edab1[_0x492a55(0x1cd)]({'id':_0x42b216,'name':String(_0x4a51fb||_0x42b216)});}const _0x14942e=await this[_0x492a55(0x18d)](_0x492a55(0x22b),_0x492a55(0xf5)),_0x2854bf=[];if(_0x14942e)for(const _0x576543 in _0x14942e){let _0x129ce0=_0x14942e[_0x576543][_0x492a55(0x220)]['name'];if(_0x129ce0&&typeof _0x129ce0===_0x492a55(0x101))_0x129ce0=_0x129ce0['de']||_0x129ce0['en']||Object[_0x492a55(0x1f7)](_0x129ce0)[0x0]||JSON[_0x492a55(0xf0)](_0x129ce0);_0x2854bf[_0x492a55(0x1cd)](String(_0x129ce0||_0x576543[_0x492a55(0xec)]('.')[_0x492a55(0x1af)]()));}this[_0x492a55(0x107)](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':!![],'enums':_0x5edab1,'rooms':_0x2854bf},_0x261972[_0x492a55(0x225)]);}else{if(_0x261972['command']==='getCalendarNames')try{const _0x448949=await this['getObjectViewAsync'](_0x492a55(0x233),_0x492a55(0x149),{'startkey':'system.adapter.ical.','endkey':_0x492a55(0xd5)}),_0x28b67b=new Set();if(_0x448949&&_0x448949[_0x492a55(0x11f)])for(const _0x1332ce of _0x448949[_0x492a55(0x11f)]){const _0x258fec=_0x1332ce['id']['replace']('system.adapter.',''),_0x4ec31b=await this['getForeignStateAsync'](_0x258fec+_0x492a55(0x16d));let _0x144193=![];if(_0x4ec31b&&_0x4ec31b['val']){const _0x38aee5=typeof _0x4ec31b['val']===_0x492a55(0x235)?JSON['parse'](_0x4ec31b[_0x492a55(0x193)]):_0x4ec31b[_0x492a55(0x193)];Array[_0x492a55(0x216)](_0x38aee5)&&_0x38aee5[_0x492a55(0xfc)](_0x294c27=>{const _0x1b19b8=_0x492a55;_0x294c27[_0x1b19b8(0xf6)]&&(_0x28b67b[_0x1b19b8(0x17d)](_0x294c27[_0x1b19b8(0xf6)]),_0x144193=!![]);});}!_0x144193&&_0x28b67b[_0x492a55(0x17d)](_0x258fec);}const _0x2e6322=Array[_0x492a55(0x19c)](_0x28b67b);if(_0x2e6322[_0x492a55(0x1d8)]===0x0)_0x2e6322[_0x492a55(0x1cd)](_0x492a55(0x1e3));this['sendTo'](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':!![],'names':_0x2e6322},_0x261972['callback']);}catch(_0x4f92a8){this['sendTo'](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':![],'error':_0x492a55(0x1c1)+_0x4f92a8[_0x492a55(0x120)]},_0x261972[_0x492a55(0x225)]);}else{if(_0x261972['command']===_0x492a55(0x198))try{await automation[_0x492a55(0x1b7)](this),this['sendTo'](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':!![]},_0x261972[_0x492a55(0x225)]);}catch(_0x1d5bd3){this['log'][_0x492a55(0x1bd)](_0x492a55(0x204)+_0x1d5bd3[_0x492a55(0x120)]),this[_0x492a55(0x107)](_0x261972['from'],_0x261972['command'],{'success':![],'error':_0x1d5bd3['message']},_0x261972['callback']);}else{if(_0x261972['command']===_0x492a55(0xd3))try{const _0x243f39=_0x261972[_0x492a55(0x120)]?_0x261972[_0x492a55(0x120)]['apiKey']:'';if(!_0x243f39)throw new Error('Kein\x20API\x20Key\x20Ã¼bergeben.');const _0x1d4eea=new GoogleGenerativeAI(_0x243f39),_0x29bb35=_0x1d4eea[_0x492a55(0x111)]({'model':GEMINI_MODEL}),_0xd3aa2b=await _0x29bb35[_0x492a55(0x1ee)](_0x492a55(0x133)),_0x1f4b3b=await _0xd3aa2b[_0x492a55(0xd1)],_0x2428cb=_0x1f4b3b['text']();this['sendTo'](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':!![],'message':_0x492a55(0x1ba)+_0x2428cb[_0x492a55(0x19d)](0x0,0x14)+_0x492a55(0x197)},_0x261972['callback']);}catch(_0x1ea1f1){this['sendTo'](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':![],'message':_0x1ea1f1['message']},_0x261972[_0x492a55(0x225)]);}else{if(_0x261972['command']==='testContext')try{const _0x8d5cbb=await this['checkSolarCondition'](),_0x1b7d77=await this[_0x492a55(0x1ea)]('system','instance',{'startkey':_0x492a55(0x229),'endkey':_0x492a55(0xd5)}),_0x342fa2=_0x1b7d77&&_0x1b7d77[_0x492a55(0x11f)]?_0x1b7d77['rows']['length']:0x0;this[_0x492a55(0x107)](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':!![],'weather':_0x492a55(0x186)+_0x8d5cbb+',\x20Temp:\x20'+(this[_0x492a55(0xf4)][this[_0x492a55(0xea)]['outdoorSensorId']]||'?')+'Â°C','calendar':_0x342fa2+_0x492a55(0x1e7)},_0x261972['callback']);}catch(_0x2fe5b0){this[_0x492a55(0x107)](_0x261972[_0x492a55(0x19c)],_0x261972[_0x492a55(0xd6)],{'success':![]},_0x261972[_0x492a55(0x225)]);}}}}}}}}}}}[a0_0x2c8e3e(0x114)](){const _0x2931f4=a0_0x2c8e3e;if(!this[_0x2931f4(0x227)]['health'])return;this[_0x2931f4(0x203)][_0x2931f4(0x151)]('ðŸ\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...');try{const _0x183910=this[_0x2931f4(0x1a7)]||[];pythonBridge[_0x2931f4(0x1d5)](this,_0x2931f4(0x21b),{'events':_0x183910});}catch(_0x3850c6){this['log'][_0x2931f4(0x1bd)](_0x2931f4(0x169));}}async[a0_0x2c8e3e(0x117)](_0x44304b,_0x291463){const _0x48dcc6=a0_0x2c8e3e;if(!_0x291463||this['dependencyInstallInProgress'])return;if(_0x44304b[_0x48dcc6(0xf3)](_0x48dcc6(0x194))&&_0x44304b[_0x48dcc6(0x224)](_0x48dcc6(0x1d0))&&_0x291463['val'])return;if(this['config'][_0x48dcc6(0xe4)]&&_0x44304b===this[_0x48dcc6(0xea)][_0x48dcc6(0x17c)]&&this[_0x48dcc6(0x227)][_0x48dcc6(0x11c)]){this[_0x48dcc6(0x163)](_0x291463[_0x48dcc6(0x193)]);return;}if(_0x291463[_0x48dcc6(0x147)]&&_0x44304b['endsWith'](_0x48dcc6(0x1b9)))return;if(_0x44304b===this['namespace']+_0x48dcc6(0x1d2)){if(_0x291463[_0x48dcc6(0x193)]&&Object[_0x48dcc6(0x1f7)](setup[_0x48dcc6(0x173)])[_0x48dcc6(0xf3)](_0x291463[_0x48dcc6(0x193)])){this[_0x48dcc6(0x130)]=_0x291463[_0x48dcc6(0x193)];if(_0x291463[_0x48dcc6(0x193)]===setup[_0x48dcc6(0x173)][_0x48dcc6(0xf9)])await recorder[_0x48dcc6(0x1c7)](this,![]);else await recorder[_0x48dcc6(0x1c7)](this,!![]);if(this[_0x48dcc6(0x1b2)]){let _0x5ccaad=![],_0x1b9e3d=0x0,_0x38a9dd=_0x48dcc6(0x161);if(this[_0x48dcc6(0x130)]==='party')_0x5ccaad=!![],_0x1b9e3d=0x168,_0x38a9dd=_0x48dcc6(0x208);else this[_0x48dcc6(0x130)]===_0x48dcc6(0x212)&&(_0x5ccaad=!![],_0x1b9e3d=0x5a0,_0x38a9dd=_0x48dcc6(0x1dd));pythonBridge['send'](this,_0x48dcc6(0x11d),{'active':_0x5ccaad,'duration':_0x1b9e3d,'label':_0x38a9dd}),await this[_0x48dcc6(0x172)]('analysis.security.learningStatus',{'val':JSON['stringify']({'active':_0x5ccaad,'label':_0x38a9dd,'timestamp':Date[_0x48dcc6(0xdb)]()}),'ack':!![]});}}if(!_0x291463[_0x48dcc6(0x147)])this[_0x48dcc6(0x127)](_0x44304b,{'val':this[_0x48dcc6(0x130)],'ack':!![]});return;}if(_0x44304b[_0x48dcc6(0x224)](_0x48dcc6(0x121))&&_0x291463[_0x48dcc6(0x147)])this[_0x48dcc6(0xdd)](_0x291463[_0x48dcc6(0x193)]);if(_0x44304b[_0x48dcc6(0x224)](_0x48dcc6(0x1d9))&&_0x291463[_0x48dcc6(0x147)]&&this['activeModules'][_0x48dcc6(0x1de)])automation['checkCalendarTriggers'](this);if(!_0x291463[_0x48dcc6(0x147)]){if(_0x44304b['includes'](_0x48dcc6(0x199))&&_0x291463[_0x48dcc6(0x193)]){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]}),aiAgent[_0x48dcc6(0x124)](this);return;}if(_0x44304b[_0x48dcc6(0xf3)](_0x48dcc6(0x13f))&&_0x291463['val']){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]});if(this[_0x48dcc6(0x1b2)])aiAgent[_0x48dcc6(0x125)](this,pythonBridge);return;}if(_0x44304b['includes'](_0x48dcc6(0x18a))&&_0x291463['val']){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]}),aiAgent[_0x48dcc6(0x18b)](this);return;}if(_0x44304b[_0x48dcc6(0xf3)](_0x48dcc6(0x1b4))&&_0x291463['val']){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]}),aiAgent[_0x48dcc6(0x195)](this);return;}if(_0x44304b[_0x48dcc6(0xf3)](_0x48dcc6(0x1fa))&&_0x291463[_0x48dcc6(0x193)]){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]});if(this[_0x48dcc6(0x1b2)])try{const _0x4a07ca=await this[_0x48dcc6(0x166)](_0x48dcc6(0x1bc));if(_0x4a07ca&&_0x4a07ca['val']){const _0x3feeb4=JSON[_0x48dcc6(0x102)](_0x4a07ca[_0x48dcc6(0x193)]);this[_0x48dcc6(0x172)](_0x48dcc6(0x22c),{'val':_0x48dcc6(0x218),'ack':!![]}),pythonBridge[_0x48dcc6(0x1d5)](this,_0x48dcc6(0x16e),{'sequences':_0x3feeb4});}}catch(_0x5d1383){}return;}if(_0x44304b['includes'](_0x48dcc6(0x201))&&_0x291463[_0x48dcc6(0x193)]){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]});try{aiAgent[_0x48dcc6(0x1ad)](this,'NIGHT'),setTimeout(()=>aiAgent[_0x48dcc6(0x1ad)](this,_0x48dcc6(0x22f)),0x2ee0);if(this[_0x48dcc6(0x1b2)]){this[_0x48dcc6(0x114)]();const _0x3fcca5=await this[_0x48dcc6(0x166)](_0x48dcc6(0x108));if(_0x3fcca5&&_0x3fcca5[_0x48dcc6(0x193)])pythonBridge[_0x48dcc6(0x1d5)](this,_0x48dcc6(0x180),{'digests':JSON[_0x48dcc6(0x102)](_0x3fcca5[_0x48dcc6(0x193)])});}}catch(_0x27d9b8){this[_0x48dcc6(0x203)][_0x48dcc6(0x1bd)](_0x48dcc6(0x11a)+_0x27d9b8['message']);}return;}if(_0x44304b[_0x48dcc6(0xf3)](_0x48dcc6(0x177))&&_0x291463['val']){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]}),await this[_0x48dcc6(0x202)]();return;}if(_0x44304b[_0x48dcc6(0xf3)]('analysis.training.triggerComfort')&&_0x291463[_0x48dcc6(0x193)]){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]});if(this[_0x48dcc6(0x1b2)])try{const _0x62fe22=await this['getStateAsync'](_0x48dcc6(0x139));if(_0x62fe22&&_0x62fe22['val']){const _0x33e648={};if(this[_0x48dcc6(0xea)]['devices'])this['config']['devices'][_0x48dcc6(0xfc)](_0x31f1e5=>{const _0x537541=_0x48dcc6;if(_0x31f1e5['id']&&_0x31f1e5[_0x537541(0x1d6)])_0x33e648[_0x31f1e5['id']]=_0x31f1e5[_0x537541(0x1d6)];});pythonBridge['send'](this,'TRAIN_COMFORT',{'events':JSON['parse'](_0x62fe22[_0x48dcc6(0x193)]),'deviceMap':_0x33e648});}}catch(_0x3ad032){}return;}if(_0x44304b[_0x48dcc6(0xf3)]('analysis.training.triggerTopology')&&_0x291463[_0x48dcc6(0x193)]){this[_0x48dcc6(0x127)](_0x44304b,{'val':![],'ack':!![]}),topology['updateTopology'](this);if(this['isProVersion'])try{const _0x1a1111=await this[_0x48dcc6(0x166)]('LTM.trainingData.sequences');if(_0x1a1111&&_0x1a1111['val'])pythonBridge[_0x48dcc6(0x1d5)](this,_0x48dcc6(0xdc),{'sequences':JSON[_0x48dcc6(0x102)](_0x1a1111[_0x48dcc6(0x193)])});}catch(_0x37db6f){}return;}}const _0x5de45f=(this[_0x48dcc6(0xea)][_0x48dcc6(0x1ae)]||[])[_0x48dcc6(0x1fd)](_0x50a481=>_0x50a481['id']===_0x44304b);if(_0x5de45f){const _0x11aa7a=await recorder[_0x48dcc6(0x236)](this,_0x44304b,_0x291463,_0x5de45f);_0x11aa7a&&this[_0x48dcc6(0x127)](_0x48dcc6(0x140),{'val':Date['now'](),'ack':!![]});_0x11aa7a&&_0x11aa7a[_0x48dcc6(0x1d6)]===_0x48dcc6(0x1b3)&&_0x11aa7a['location']&&this[_0x48dcc6(0x1b2)]&&deadMan['updateLocation'](this,_0x11aa7a[_0x48dcc6(0x21e)]);_0x291463['val']&&(_0x291463['val']===!![]||_0x291463[_0x48dcc6(0x193)]===0x1||String(_0x291463[_0x48dcc6(0x193)])['toLowerCase']()==='open')&&(_0x5de45f[_0x48dcc6(0x1d6)]&&(_0x5de45f[_0x48dcc6(0x1d6)][_0x48dcc6(0xf3)](_0x48dcc6(0x119))||_0x5de45f['type'][_0x48dcc6(0xf3)]('door'))&&this[_0x48dcc6(0x205)](_0x5de45f));if(_0x5de45f[_0x48dcc6(0x1d6)]===_0x48dcc6(0x22a)||_0x5de45f[_0x48dcc6(0x1d6)]===_0x48dcc6(0x16b)){if(this[_0x48dcc6(0x227)][_0x48dcc6(0x1de)])automation[_0x48dcc6(0x20e)](this);}}}async['protectAiMemory'](_0x1d70cd){const _0x3e29ec=a0_0x2c8e3e;if(!this[_0x3e29ec(0xda)]||Date[_0x3e29ec(0xdb)]()-this[_0x3e29ec(0x1fe)]>0x493e0)return;try{const _0x211610=JSON[_0x3e29ec(0x102)](_0x1d70cd),_0x336415=this[_0x3e29ec(0xda)][_0x3e29ec(0x14a)];let _0x448402=![];for(const _0x5d240d in _0x336415){if(_0x336415[_0x5d240d]['includes']('AI')&&_0x211610[_0x5d240d]&&!_0x211610[_0x5d240d]['includes']('AI')){_0x448402=!![];break;}}_0x448402&&(await this[_0x3e29ec(0x172)](_0x3e29ec(0x1d9),{'val':JSON[_0x3e29ec(0xf0)](this[_0x3e29ec(0xda)][_0x3e29ec(0x15a)]),'ack':!![]}),await this[_0x3e29ec(0x172)](_0x3e29ec(0x121),{'val':JSON['stringify'](this[_0x3e29ec(0xda)]['sources']),'ack':!![]}));}catch(_0x2dc1f9){}}async[a0_0x2c8e3e(0x13e)](){const _0x599862=a0_0x2c8e3e;try{const _0x5b0940=await this[_0x599862(0x166)](setup[_0x599862(0x206)]);if(_0x5b0940&&_0x5b0940['val'])this[_0x599862(0x130)]=_0x5b0940['val'];}catch(_0x1ed7be){this[_0x599862(0x130)]=setup[_0x599862(0x173)][_0x599862(0x1e1)];}}async[a0_0x2c8e3e(0x15e)](){const _0x49b40d=a0_0x2c8e3e,_0x47bb5c=this[_0x49b40d(0xea)][_0x49b40d(0x118)]||[];if(_0x47bb5c[_0x49b40d(0x1d8)]===0x0)return![];const _0x2e5fba=[],_0x391a1c=Date[_0x49b40d(0xdb)](),_0x4fa9ec=0x5*0x3c*0x3e8;for(const _0x5925d2 of _0x47bb5c){try{let _0x25ba9e=![];try{const _0x30bcca=await this['getForeignStateAsync'](_0x5925d2+'.isOnline');if(_0x30bcca&&_0x30bcca[_0x49b40d(0x193)]===!![])_0x25ba9e=!![];}catch(_0x4cb6cc){}if(!_0x25ba9e)try{const _0x30a1bf=await this['getForeignStateAsync'](_0x5925d2+_0x49b40d(0x19b));if(_0x30a1bf&&_0x30a1bf['ts']){const _0x47cc24=_0x391a1c-_0x30a1bf['ts'];if(_0x47cc24<_0x4fa9ec)_0x25ba9e=!![];}}catch(_0x5d4074){}if(!_0x25ba9e)try{const _0x34397f=await this[_0x49b40d(0x231)](_0x5925d2+_0x49b40d(0x1b6));if(_0x34397f&&typeof _0x34397f[_0x49b40d(0x193)]===_0x49b40d(0x18c)&&_0x34397f[_0x49b40d(0x193)]>0x0)_0x25ba9e=!![];}catch(_0x278abb){}if(!_0x25ba9e)try{const _0x1ad207=await this[_0x49b40d(0x231)](_0x5925d2);if(_0x1ad207){const _0x140531=_0x391a1c-(_0x1ad207['ts']||0x0);_0x140531<_0x4fa9ec&&(_0x1ad207[_0x49b40d(0x193)]===!![]||_0x1ad207[_0x49b40d(0x193)]===_0x49b40d(0x211)||_0x1ad207[_0x49b40d(0x193)]===0x1)&&(_0x25ba9e=!![]);}}catch(_0x55368c){}if(_0x25ba9e){const _0x39cd14=_0x5925d2[_0x49b40d(0xec)]('.'),_0x550f19=_0x39cd14[_0x39cd14[_0x49b40d(0x1d8)]-0x1]||_0x5925d2;_0x2e5fba[_0x49b40d(0x1cd)](_0x550f19);}}catch(_0x168f23){this[_0x49b40d(0x203)][_0x49b40d(0x1bd)](_0x49b40d(0x10a)+_0x5925d2+':\x20'+_0x168f23[_0x49b40d(0x120)]);}}const _0x18c6c5=_0x2e5fba['length']>0x0?_0x2e5fba['join'](',\x20'):_0x49b40d(0x150);return await this[_0x49b40d(0x172)](_0x49b40d(0x153),{'val':_0x18c6c5,'ack':!![]}),_0x2e5fba[_0x49b40d(0x1d8)]>0x0;}async[a0_0x2c8e3e(0x145)](){const _0x57141a=a0_0x2c8e3e;await aiAgent[_0x57141a(0x124)](this);this[_0x57141a(0x227)]['health']&&(this[_0x57141a(0xd9)](),this[_0x57141a(0x152)]());if(this[_0x57141a(0x227)][_0x57141a(0x1de)])this[_0x57141a(0x202)]();}async[a0_0x2c8e3e(0x1da)](){const _0x222de6=a0_0x2c8e3e,_0x456e54=[_0x222de6(0xd2),'accuweather.0',_0x222de6(0x165)],_0x2e9bd0=[_0x222de6(0x230),_0x222de6(0x14e),_0x222de6(0x16c)];for(const _0x316acf of _0x456e54){for(const _0x4d8559 of _0x2e9bd0){try{const _0x2b3d04=_0x316acf+'.'+_0x4d8559,_0x20849a=await this['getForeignStateAsync'](_0x2b3d04);if(_0x20849a&&_0x20849a[_0x222de6(0x193)]){const _0x9130fb=String(_0x20849a[_0x222de6(0x193)])[_0x222de6(0x1b8)]();if(_0x9130fb[_0x222de6(0xf3)](_0x222de6(0x1f5))||_0x9130fb[_0x222de6(0xf3)](_0x222de6(0x10c))||_0x9130fb[_0x222de6(0xf3)](_0x222de6(0x1b1))||_0x9130fb['includes']('sonn')||_0x9130fb[_0x222de6(0xf3)](_0x222de6(0x207)))return this['log'][_0x222de6(0x151)](_0x222de6(0x185)+_0x2b3d04),!![];}}catch(_0x5bfc16){}}}return![];}[a0_0x2c8e3e(0x152)](){const _0x2a12dc=a0_0x2c8e3e;if(!this[_0x2a12dc(0x1b2)])return;try{this['getStateAsync']('LTM.trainingData.sequences',(_0x284ea2,_0x10c758)=>{const _0x2e50c8=_0x2a12dc;if(_0x284ea2||!_0x10c758||!_0x10c758[_0x2e50c8(0x193)])return;try{const _0x220569=JSON['parse'](_0x10c758[_0x2e50c8(0x193)]);if(!_0x220569||_0x220569[_0x2e50c8(0x1d8)]===0x0)return;pythonBridge[_0x2e50c8(0x1d5)](this,_0x2e50c8(0x19e),{'sequences':_0x220569}),this[_0x2e50c8(0x203)][_0x2e50c8(0x151)](_0x2e50c8(0x158)+_0x220569['length']+'\x20sequences');}catch(_0x33df26){this['log'][_0x2e50c8(0x1bd)]('triggerGaitAnalysis\x20parse\x20error:\x20'+_0x33df26[_0x2e50c8(0x120)]);}});}catch(_0x5d61ec){this['log'][_0x2a12dc(0x1bd)](_0x2a12dc(0xe6)+_0x5d61ec['message']);}}async['triggerEnergyPrediction'](){const _0x19b0b1=a0_0x2c8e3e;if(!this['isProVersion']||!this[_0x19b0b1(0x227)]['energy'])return;try{const _0x1665c4={},_0x491b19={},_0x1d648f=this[_0x19b0b1(0xea)][_0x19b0b1(0x1ae)]||[];for(const _0x375009 of _0x1d648f){if((_0x375009[_0x19b0b1(0x1d6)]===_0x19b0b1(0x22a)||_0x375009['type']===_0x19b0b1(0x16b))&&_0x375009[_0x19b0b1(0x21e)])try{const _0x222336=await this[_0x19b0b1(0x231)](_0x375009['id']);_0x222336&&typeof _0x222336[_0x19b0b1(0x193)]===_0x19b0b1(0x18c)&&(_0x1665c4[_0x375009[_0x19b0b1(0x21e)]]=_0x222336[_0x19b0b1(0x193)],_0x491b19[_0x375009[_0x19b0b1(0x21e)]]=_0x375009[_0x19b0b1(0x217)]||![]);}catch(_0x514f1d){}}let _0x4d661f=0xa;if(this[_0x19b0b1(0xea)][_0x19b0b1(0x20b)])try{const _0x32f988=await this[_0x19b0b1(0x231)](this[_0x19b0b1(0xea)][_0x19b0b1(0x20b)]);if(_0x32f988&&typeof _0x32f988['val']===_0x19b0b1(0x18c))_0x4d661f=_0x32f988['val'];}catch(_0x4955a8){}const _0x1be597=await this[_0x19b0b1(0x1da)]();let _0x3c8950={};try{const _0x2e52a3=await this[_0x19b0b1(0x166)](_0x19b0b1(0xd7));if(_0x2e52a3&&_0x2e52a3[_0x19b0b1(0x193)])_0x3c8950=JSON[_0x19b0b1(0x102)](_0x2e52a3['val']);}catch(_0x1ca95a){}pythonBridge[_0x19b0b1(0x1d5)](this,_0x19b0b1(0x1d4),{'current_temps':_0x1665c4,'t_out':_0x4d661f,'is_sunny':_0x1be597,'solar_flags':_0x491b19,'warmup_targets':_0x3c8950}),this[_0x19b0b1(0x203)][_0x19b0b1(0xf8)](_0x19b0b1(0x23a)+Object['keys'](_0x1665c4)[_0x19b0b1(0x1d8)]+_0x19b0b1(0x179));}catch(_0x38ee7a){this[_0x19b0b1(0x203)][_0x19b0b1(0x1bd)](_0x19b0b1(0x21f)+_0x38ee7a[_0x19b0b1(0x120)]);}}[a0_0x2c8e3e(0xd9)](){const _0x2b6c04=a0_0x2c8e3e;if(!this[_0x2b6c04(0x1a7)]||this[_0x2b6c04(0x1a7)][_0x2b6c04(0x1d8)]===0x0)return;const _0xd6d719=new Array(0x30)[_0x2b6c04(0xe5)](0x0),_0x1af827=Array[_0x2b6c04(0x19c)]({'length':0x30},()=>[]),_0x15fe10=new Date()[_0x2b6c04(0x226)](0x0,0x0,0x0,0x0);this[_0x2b6c04(0x1a7)][_0x2b6c04(0xfc)](_0x12df52=>{const _0x45a98d=_0x2b6c04,_0x5ad0a6=new Date(_0x12df52[_0x45a98d(0x210)]);if(_0x5ad0a6[_0x45a98d(0x222)]()>=_0x15fe10){const _0x2aecc1=_0x5ad0a6['getHours'](),_0x40c896=_0x5ad0a6[_0x45a98d(0x1e4)](),_0x237d48=_0x2aecc1*0x2+Math['floor'](_0x40c896/0x1e);_0x237d48>=0x0&&_0x237d48<0x30&&(_0xd6d719[_0x237d48]++,_0x1af827[_0x237d48][_0x45a98d(0x1cd)]({'time':_0x5ad0a6[_0x45a98d(0x115)](_0x45a98d(0x10e),{'hour':_0x45a98d(0x143),'minute':_0x45a98d(0x143)}),'location':_0x12df52['location']||_0x45a98d(0x1ce),'type':_0x12df52[_0x45a98d(0x1d6)]||_0x45a98d(0x191)}));}}),this[_0x2b6c04(0x172)](_0x2b6c04(0x18e),{'val':JSON['stringify'](_0xd6d719),'ack':!![]}),this['setStateAsync'](_0x2b6c04(0x110),{'val':JSON['stringify'](_0x1af827),'ack':!![]});}async['handleInfrasound'](_0x1561fc){const _0x37d129=a0_0x2c8e3e;if(!this[_0x37d129(0xea)][_0x37d129(0xe4)]||typeof _0x1561fc!==_0x37d129(0x18c))return;const _0x51b0d0=this[_0x37d129(0xea)][_0x37d129(0x1c3)]||0.04;this['pressureBuffer']['push']({'timestamp':Date[_0x37d129(0xdb)](),'value':_0x1561fc}),this[_0x37d129(0x22e)]['length']>0x64&&this['pressureBuffer'][_0x37d129(0x155)](),_0x1561fc>_0x51b0d0&&!this['infrasoundLocked']&&(this[_0x37d129(0x1a0)]=!![],this['log']['warn']('ðŸ”Š\x20Infraschall-Alarm:\x20'+_0x1561fc[_0x37d129(0x17b)](0x4)+_0x37d129(0x1f4)+_0x51b0d0+_0x37d129(0x129)),await this[_0x37d129(0x1df)](_0x1561fc,_0x37d129(0xe8)),setTimeout(()=>{const _0x1fd4d3=_0x37d129;this[_0x1fd4d3(0x1a0)]=![];},0x5*0x3c*0x3e8));}async[a0_0x2c8e3e(0x1df)](_0x473214,_0x349be4){const _0x576668=a0_0x2c8e3e;if(!this[_0x576668(0x1f1)]){const _0x5d45d1=this[_0x576668(0x1db)]['slice'](0x0,0xa),_0x5bc9ba=_0x5d45d1['map'](_0x299c61=>new Date(_0x299c61[_0x576668(0x210)])[_0x576668(0x115)](_0x576668(0x10e))+_0x576668(0x1dc)+(_0x299c61[_0x576668(0x21e)]||'Unknown')+':\x20'+_0x299c61[_0x576668(0x11e)])[_0x576668(0x126)]('\x0a');this[_0x576668(0x203)][_0x576668(0x1bd)](_0x576668(0xed)+_0x473214[_0x576668(0x17b)](0x4)+_0x576668(0x1d3)+_0x5bc9ba);if(this[_0x576668(0xea)][_0x576668(0x1e5)])try{const _0x16b61e=await this[_0x576668(0x231)](this[_0x576668(0xea)][_0x576668(0x1e5)]);_0x16b61e&&_0x16b61e['val']===!![]&&(await this[_0x576668(0x172)](_0x576668(0x17a),{'val':JSON['stringify']({'timestamp':Date[_0x576668(0xdb)](),'pressure':_0x473214[_0x576668(0x17b)](0x4),'eventType':_0x349be4,'recentEvents':_0x5d45d1['slice'](0x0,0x3)}),'ack':!![]}),this[_0x576668(0x203)][_0x576668(0x109)](_0x576668(0x10b)));}catch(_0x24389a){}}else this[_0x576668(0x203)]['debug'](_0x576668(0x200)+_0x473214['toFixed'](0x4)+_0x576668(0xef));}async[a0_0x2c8e3e(0x205)](_0x2cd323){const _0xf4ef5a=a0_0x2c8e3e;if(!_0x2cd323||!_0x2cd323[_0xf4ef5a(0x21e)])return;try{const _0x4ae429=(this[_0xf4ef5a(0xea)][_0xf4ef5a(0x1ae)]||[])[_0xf4ef5a(0x15b)](_0x33b5df=>_0x33b5df[_0xf4ef5a(0x21e)]===_0x2cd323[_0xf4ef5a(0x21e)]&&(_0x33b5df[_0xf4ef5a(0x1d6)]===_0xf4ef5a(0x22a)||_0x33b5df['type']===_0xf4ef5a(0x16b)));if(_0x4ae429['length']===0x0)return;const _0xe4cfad=await this['getForeignStateAsync'](_0x4ae429[0x0]['id']);if(!_0xe4cfad||typeof _0xe4cfad[_0xf4ef5a(0x193)]!==_0xf4ef5a(0x18c))return;const _0x3bc3a4=_0xe4cfad['val'];let _0x479d6f=null;if(this[_0xf4ef5a(0xea)]['weatherTempId']){const _0x2c444f=await this[_0xf4ef5a(0x231)](this[_0xf4ef5a(0xea)][_0xf4ef5a(0x20b)]);_0x2c444f&&typeof _0x2c444f['val']==='number'&&(_0x479d6f=_0x2c444f['val']);}if(_0x479d6f!==null){const _0x57853b=Math[_0xf4ef5a(0x1cf)](_0x3bc3a4-_0x479d6f);_0x57853b>0x3&&(this[_0xf4ef5a(0x203)][_0xf4ef5a(0x151)](_0xf4ef5a(0x19a)+_0x2cd323[_0xf4ef5a(0x21e)]+_0xf4ef5a(0x13a)+_0x57853b['toFixed'](0x1)+_0xf4ef5a(0x1c6)+_0x3bc3a4+_0xf4ef5a(0x112)+_0x479d6f+_0xf4ef5a(0x1e9)),await this[_0xf4ef5a(0x172)](_0xf4ef5a(0x1eb),{'val':JSON[_0xf4ef5a(0xf0)]({'room':_0x2cd323['location'],'timestamp':Date[_0xf4ef5a(0xdb)](),'tempDiff':_0x57853b[_0xf4ef5a(0x17b)](0x1),'recommendation':_0x57853b>0x5?_0xf4ef5a(0x148):'LÃ¼ften\x20empfohlen'}),'ack':!![]}));}}catch(_0x5374c2){this[_0xf4ef5a(0x203)][_0xf4ef5a(0x1bd)](_0xf4ef5a(0x1cb)+_0x5374c2[_0xf4ef5a(0x120)]);}}async[a0_0x2c8e3e(0x223)](_0x42108f){const _0x25e7a1=a0_0x2c8e3e;if(!_0x42108f||typeof _0x42108f!==_0x25e7a1(0x101))return;const _0x2d6088={'timestamp':_0x42108f[_0x25e7a1(0x210)]||Date['now'](),'id':_0x42108f['id']||Date['now']()[_0x25e7a1(0x12d)](),'name':_0x42108f[_0x25e7a1(0x11e)]||_0x25e7a1(0x12e),'type':_0x42108f[_0x25e7a1(0x1d6)]||'custom','location':_0x42108f[_0x25e7a1(0x21e)]||'Unknown','value':_0x42108f[_0x25e7a1(0xd8)]||null};this[_0x25e7a1(0x1db)][_0x25e7a1(0x162)](_0x2d6088);if(this['eventHistory'][_0x25e7a1(0x1d8)]>0x1388)this[_0x25e7a1(0x1db)][_0x25e7a1(0x1af)]();await this[_0x25e7a1(0x172)](_0x25e7a1(0x1d1),{'val':JSON[_0x25e7a1(0xf0)](this[_0x25e7a1(0x1db)]),'ack':!![]}),this[_0x25e7a1(0x203)]['debug']('ðŸ“\x20Manual\x20event\x20logged:\x20'+_0x2d6088[_0x25e7a1(0x11e)]+'\x20('+_0x2d6088[_0x25e7a1(0x21e)]+')');}[a0_0x2c8e3e(0x1a6)](_0x635def){}}if(require['main']!==module)module[a0_0x2c8e3e(0x1e2)]=_0x5ae715=>new CogniLiving(_0x5ae715);else new CogniLiving();