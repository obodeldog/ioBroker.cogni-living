const a0_0x3344a6=a0_0xfafb;(function(_0x158447,_0x53451b){const _0x45f304=a0_0xfafb,_0xddce5e=_0x158447();while(!![]){try{const _0x41e799=parseInt(_0x45f304(0x2e6))/0x1*(-parseInt(_0x45f304(0x1dd))/0x2)+-parseInt(_0x45f304(0x32b))/0x3+parseInt(_0x45f304(0x2df))/0x4*(-parseInt(_0x45f304(0x2c9))/0x5)+parseInt(_0x45f304(0x29a))/0x6*(-parseInt(_0x45f304(0x2fe))/0x7)+-parseInt(_0x45f304(0x26c))/0x8*(-parseInt(_0x45f304(0x308))/0x9)+parseInt(_0x45f304(0x2e0))/0xa*(-parseInt(_0x45f304(0x2a0))/0xb)+-parseInt(_0x45f304(0x254))/0xc*(-parseInt(_0x45f304(0x26f))/0xd);if(_0x41e799===_0x53451b)break;else _0xddce5e['push'](_0xddce5e['shift']());}catch(_0x5ce09f){_0xddce5e['push'](_0xddce5e['shift']());}}}(a0_0x578c,0x452a8));function a0_0xfafb(_0x724c24,_0x2d7ef7){const _0x4eab33=a0_0x578c();return a0_0xfafb=function(_0x38f19c,_0x3b581e){_0x38f19c=_0x38f19c-0x1aa;let _0x578c60=_0x4eab33[_0x38f19c];return _0x578c60;},a0_0xfafb(_0x724c24,_0x2d7ef7);}const a0_0x3b581e=(function(){let _0x217e6e=!![];return function(_0x4f3f9,_0x40c16d){const _0x4228c6=_0x217e6e?function(){const _0x33d8a7=a0_0xfafb;if(_0x40c16d){const _0x59918d=_0x40c16d[_0x33d8a7(0x2a2)](_0x4f3f9,arguments);return _0x40c16d=null,_0x59918d;}}:function(){};return _0x217e6e=![],_0x4228c6;};}()),a0_0x38f19c=a0_0x3b581e(this,function(){const _0x47ad4a=a0_0xfafb;return a0_0x38f19c[_0x47ad4a(0x293)]()['search'](_0x47ad4a(0x1f8))[_0x47ad4a(0x293)]()[_0x47ad4a(0x2e9)](a0_0x38f19c)[_0x47ad4a(0x230)](_0x47ad4a(0x1f8));});a0_0x38f19c();'use strict';const utils=require(a0_0x3344a6(0x27c)),{GoogleGenerativeAI}=require(a0_0x3344a6(0x2ab)),schedule=require('node-schedule'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x3344a6(0x1ea),LTM_SCHEDULE=a0_0x3344a6(0x302),MODE_RESET_SCHEDULE=a0_0x3344a6(0x211),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x3344a6(0x277),LTM_DP_DAILY_DIGESTS=a0_0x3344a6(0x1fa),LTM_DP_STATUS=a0_0x3344a6(0x25d),LTM_DP_TRIGGER_DIGEST=a0_0x3344a6(0x22e),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x3344a6(0x1f0),LTM_DP_DRIFT_STATUS=a0_0x3344a6(0x1e1),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x3344a6(0x261),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x3344a6(0x314),a0_0x3344a6(0x1b3),'update',a0_0x3344a6(0x320),a0_0x3344a6(0x330),a0_0x3344a6(0x2ce),a0_0x3344a6(0x335),'maintenance',a0_0x3344a6(0x2e7),a0_0x3344a6(0x1cd),a0_0x3344a6(0x2d0),a0_0x3344a6(0x224),a0_0x3344a6(0x1d4),a0_0x3344a6(0x212),a0_0x3344a6(0x2c1),'firmware',a0_0x3344a6(0x2ec),a0_0x3344a6(0x1e5)],BAD_NAMES=[a0_0x3344a6(0x30a),a0_0x3344a6(0x2f4),a0_0x3344a6(0x2c7),a0_0x3344a6(0x1e0),a0_0x3344a6(0x2c3),'brightness','on',a0_0x3344a6(0x2a1),a0_0x3344a6(0x2a5),a0_0x3344a6(0x201),a0_0x3344a6(0x202),a0_0x3344a6(0x1ef),'cover',a0_0x3344a6(0x209),'motion',a0_0x3344a6(0x315),a0_0x3344a6(0x256),'temperature',a0_0x3344a6(0x1c7),'power','energy',a0_0x3344a6(0x252),a0_0x3344a6(0x2bd),'actual_temperature',a0_0x3344a6(0x28d)],ADAPTER_BLACKLIST=[a0_0x3344a6(0x333),a0_0x3344a6(0x1da),a0_0x3344a6(0x30e),a0_0x3344a6(0x305),a0_0x3344a6(0x2fd),'material.','icons-mfd.',a0_0x3344a6(0x25b),a0_0x3344a6(0x32c),a0_0x3344a6(0x2bc),a0_0x3344a6(0x28e)],SYSTEM_MODES={'NORMAL':a0_0x3344a6(0x2cf),'VACATION':a0_0x3344a6(0x28f),'PARTY':'party','GUEST':a0_0x3344a6(0x2e3)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x3344a6(0x331)],SYSTEM_MODES[a0_0x3344a6(0x2aa)]],PERSONA_MAPPING={'generic':a0_0x3344a6(0x336),'senior_aal':a0_0x3344a6(0x284),'family':a0_0x3344a6(0x214),'single_comfort':a0_0x3344a6(0x2a8),'security':'PRIORITÃ„T:\x20Sicherheit.'};class CogniLiving extends utils[a0_0x3344a6(0x23c)]{constructor(_0xaf7c4e){const _0x57cecd=a0_0x3344a6;super({..._0xaf7c4e,'name':_0x57cecd(0x31e)}),this[_0x57cecd(0x328)]=[],this[_0x57cecd(0x285)]=[],this['feedbackHistory']=[],this[_0x57cecd(0x290)]=[],this[_0x57cecd(0x2ae)]=[],this[_0x57cecd(0x2fc)]={},this[_0x57cecd(0x1d9)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x57cecd(0x325)]=null,this[_0x57cecd(0x264)]=null,this[_0x57cecd(0x24a)]=![],this[_0x57cecd(0x2d5)]=null,this[_0x57cecd(0x203)]=null,this[_0x57cecd(0x32a)]=SYSTEM_MODES[_0x57cecd(0x279)],this[_0x57cecd(0x244)]=![],this['lastAlertState']=![],this[_0x57cecd(0x2e4)]=_0x57cecd(0x298),this[_0x57cecd(0x1ed)]=null,this[_0x57cecd(0x1d0)]=null,this[_0x57cecd(0x220)]=null,this[_0x57cecd(0x2de)]=null,this[_0x57cecd(0x304)]=null,this['on'](_0x57cecd(0x280),this[_0x57cecd(0x210)][_0x57cecd(0x257)](this)),this['on'](_0x57cecd(0x310),this[_0x57cecd(0x2e2)][_0x57cecd(0x257)](this)),this['on']('unload',this[_0x57cecd(0x2b1)][_0x57cecd(0x257)](this)),this['on'](_0x57cecd(0x283),this[_0x57cecd(0x2be)][_0x57cecd(0x257)](this));}async['onReady'](){const _0x11589a=a0_0x3344a6;this[_0x11589a(0x225)][_0x11589a(0x200)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x11589a(0x23f)]+')'),await initZombies(this),this[_0x11589a(0x32e)][_0x11589a(0x1af)]=this['config'][_0x11589a(0x1af)]||'';try{this['isProVersion']=await checkLicense(this,this[_0x11589a(0x32e)]['licenseKey']);}catch(_0xef94ed){}if(!this[_0x11589a(0x32e)][_0x11589a(0x206)]||this[_0x11589a(0x32e)][_0x11589a(0x206)]<0.1)this['config'][_0x11589a(0x206)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x11589a(0x32e)][_0x11589a(0x2bf)])try{this[_0x11589a(0x2d5)]=new GoogleGenerativeAI(this[_0x11589a(0x32e)][_0x11589a(0x2bf)]),this[_0x11589a(0x203)]=this[_0x11589a(0x2d5)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x11589a(0x1c8)}}),this[_0x11589a(0x225)][_0x11589a(0x200)]('Gemini\x20AI\x20initialized.');}catch(_0x350165){this[_0x11589a(0x225)][_0x11589a(0x2e7)](_0x11589a(0x2fa)+_0x350165[_0x11589a(0x283)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates']('analysis.trigger'),this[_0x11589a(0x338)](LTM_DP_TRIGGER_DIGEST),this[_0x11589a(0x338)](_0x11589a(0x28a)),this[_0x11589a(0x338)](_0x11589a(0x2ed)),this[_0x11589a(0x338)]('analysis.automation.triggerAction'),this[_0x11589a(0x338)]('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x11589a(0x1ed)])clearInterval(this[_0x11589a(0x1ed)]);const _0x346616=this[_0x11589a(0x32e)][_0x11589a(0x27b)]||0xf;_0x346616>0x0&&(this['log'][_0x11589a(0x200)](_0x11589a(0x1bb)+_0x346616+_0x11589a(0x242)),this[_0x11589a(0x1ed)]=setInterval(()=>{runAutopilot(this);},_0x346616*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this);}[a0_0x3344a6(0x2b1)](_0x5357dc){const _0x275610=a0_0x3344a6;if(this[_0x275610(0x1ed)])clearInterval(this['analysisTimer']);if(this[_0x275610(0x2de)])clearInterval(this['driftAnalysisTimer']);if(this[_0x275610(0x1d0)])this['ltmJob'][_0x275610(0x231)]();if(this[_0x275610(0x220)])this[_0x275610(0x220)]['cancel']();if(this[_0x275610(0x304)])this[_0x275610(0x304)][_0x275610(0x231)]();if(this[_0x275610(0x325)])clearTimeout(this[_0x275610(0x325)]);if(this['exitGraceTimer'])clearTimeout(this[_0x275610(0x264)]);_0x5357dc();}async[a0_0x3344a6(0x2e2)](_0x219fe2,_0x79aff8){const _0xdeb89e=a0_0x3344a6;if(!_0x79aff8)return;if(_0x219fe2[_0xdeb89e(0x2d1)](_0xdeb89e(0x20f))&&_0x219fe2[_0xdeb89e(0x20e)](_0xdeb89e(0x1b7))&&_0x79aff8['val']){await handleTelegramResponse(this,_0x79aff8[_0xdeb89e(0x2e8)]);return;}if(_0x219fe2===this['namespace']+'.'+SYSTEM_DP_MODE){_0x79aff8[_0xdeb89e(0x2e8)]&&Object['values'](SYSTEM_MODES)[_0xdeb89e(0x2d1)](_0x79aff8['val'])&&(this['currentSystemMode']=_0x79aff8['val'],_0x79aff8[_0xdeb89e(0x2e8)]===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x79aff8[_0xdeb89e(0x1fb)])this['setState'](_0x219fe2,{'val':this[_0xdeb89e(0x32a)],'ack':!![]});return;}if(!_0x79aff8[_0xdeb89e(0x1fb)]){_0x219fe2['includes']('analysis.trigger')&&_0x79aff8[_0xdeb89e(0x2e8)]&&(this[_0xdeb89e(0x1c6)](_0x219fe2,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x219fe2[_0xdeb89e(0x2d1)](_0xdeb89e(0x286))&&_0x79aff8[_0xdeb89e(0x2e8)]){this[_0xdeb89e(0x1c6)](_0x219fe2,{'val':![],'ack':!![]});if(this[_0xdeb89e(0x244)])createDailyDigest(this);}_0x219fe2[_0xdeb89e(0x2d1)](_0xdeb89e(0x1bf))&&_0x79aff8[_0xdeb89e(0x2e8)]&&(this[_0xdeb89e(0x1c6)](_0x219fe2,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x219fe2['includes'](_0xdeb89e(0x2dc))&&_0x79aff8[_0xdeb89e(0x2e8)]&&(this['setState'](_0x219fe2,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0xdeb89e(0x32e)][_0xdeb89e(0x26b)]&&this[_0xdeb89e(0x32e)][_0xdeb89e(0x26b)][_0xdeb89e(0x2d1)](_0x219fe2)){await checkWifiPresence(this);return;}const _0x5650b1=(this['config'][_0xdeb89e(0x21f)]||[])[_0xdeb89e(0x30c)](_0x16378a=>_0x16378a['id']===_0x219fe2);if(_0x5650b1)processSensorEvent(this,_0x219fe2,_0x79aff8,_0x5650b1);}async[a0_0x3344a6(0x2be)](_0x4a1a28){const _0x339658=a0_0x3344a6;if(typeof _0x4a1a28==='object'&&_0x4a1a28[_0x339658(0x283)])try{if(_0x4a1a28[_0x339658(0x1b1)]===_0x339658(0x2ac)){}else{if(_0x4a1a28[_0x339658(0x1b1)]===_0x339658(0x2ad)){}else{if(_0x4a1a28['command']==='getLtmData'){if(!this[_0x339658(0x244)])return this[_0x339658(0x278)](_0x4a1a28[_0x339658(0x2fb)],_0x4a1a28[_0x339658(0x1b1)],{'success':![],'isPro':![]},_0x4a1a28[_0x339658(0x2c0)]);let _0x4b35dd={'status':_0x339658(0x20d),'details':'','lastCheck':0x0};try{_0x4b35dd[_0x339658(0x209)]=(await this[_0x339658(0x217)](LTM_DP_DRIFT_STATUS))[_0x339658(0x2e8)],_0x4b35dd[_0x339658(0x216)]=(await this[_0x339658(0x217)](LTM_DP_DRIFT_DETAILS))['val'],_0x4b35dd[_0x339658(0x309)]=(await this[_0x339658(0x217)](LTM_DP_DRIFT_LAST_CHECK))[_0x339658(0x2e8)];}catch(_0x226bfa){}const _0x454699=this['analysisHistory']||[];this[_0x339658(0x278)](_0x4a1a28['from'],_0x4a1a28[_0x339658(0x1b1)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x4b35dd,'analysisHistory':_0x454699},_0x4a1a28[_0x339658(0x2c0)]);}else{if(_0x4a1a28[_0x339658(0x1b1)]===_0x339658(0x25c)){const _0x16f8da=this[_0x339658(0x2ae)][_0x339658(0x1ce)],_0x5ae4=new Date(),_0x578c5a=new Date(_0x5ae4[_0x339658(0x2f8)](),_0x5ae4['getMonth'](),_0x5ae4[_0x339658(0x2ee)]())[_0x339658(0x23e)](),_0x226846=this[_0x339658(0x290)][_0x339658(0x2b5)](_0x2f8d65=>new Date(_0x2f8d65[_0x339658(0x28b)])[_0x339658(0x23e)]()>_0x578c5a)[_0x339658(0x1ce)],_0x28b0dd=new Array(0x18)[_0x339658(0x258)](0x0);this[_0x339658(0x290)][_0x339658(0x2ff)](_0x1f7422=>{const _0xee480c=_0x339658,_0x40101b=new Date(_0x1f7422['timestamp']);_0x40101b[_0xee480c(0x23e)]()>_0x578c5a&&_0x28b0dd[_0x40101b[_0xee480c(0x2d7)]()]++;});let _0x2b2d38={'status':_0x339658(0x20d)};try{_0x2b2d38[_0x339658(0x209)]=(await this[_0x339658(0x217)](LTM_DP_DRIFT_STATUS))[_0x339658(0x2e8)];}catch(_0x300542){}let _0x560315='';try{const _0x1f7918=await this[_0x339658(0x217)](_0x339658(0x1e4));_0x560315=_0x1f7918?_0x1f7918[_0x339658(0x2e8)]:'';}catch(_0x291b1f){}let _0x182389=null;!this[_0x339658(0x203)]&&(_0x182389=this[_0x339658(0x32e)][_0x339658(0x2bf)]?_0x339658(0x2b4):_0x339658(0x311));let _0x7257df={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x3de5df=await this['getStateAsync']('analysis.automation.patternDetected'),_0x40e309=await this[_0x339658(0x217)](_0x339658(0x22c)),_0x3910d0=await this[_0x339658(0x217)]('analysis.automation.targetId'),_0x67152b=await this[_0x339658(0x217)](_0x339658(0x223)),_0x35593f=await this[_0x339658(0x217)](_0x339658(0x245));_0x3de5df&&_0x3de5df[_0x339658(0x2e8)]&&(_0x7257df[_0x339658(0x2dd)]=!![],_0x7257df[_0x339658(0x2e1)]=_0x40e309?_0x40e309['val']:'',_0x7257df['targetId']=_0x3910d0?_0x3910d0[_0x339658(0x2e8)]:'',_0x7257df[_0x339658(0x287)]=_0x67152b?_0x67152b[_0x339658(0x2e8)]:''),_0x7257df[_0x339658(0x235)]=_0x35593f?!!_0x35593f[_0x339658(0x2e8)]:![];}catch(_0xbca59f){}this['sendTo'](_0x4a1a28[_0x339658(0x2fb)],_0x4a1a28[_0x339658(0x1b1)],{'success':!![],'eventHistory':this[_0x339658(0x328)][_0x339658(0x243)](0x0,0xf),'stats':{'digestCount':_0x16f8da,'eventCountToday':_0x226846,'hourlyActivity':_0x28b0dd,'driftStatus':_0x2b2d38[_0x339658(0x209)],'isPresent':this[_0x339658(0x29f)],'presenceWho':_0x560315,'minDays':this[_0x339658(0x32e)]['minDaysForBaseline']||0x7,'stbDays':this['config'][_0x339658(0x221)]||0xe,'ltbDays':this['config'][_0x339658(0x2f5)]||0x3c,'systemError':_0x182389},'automation':_0x7257df},_0x4a1a28[_0x339658(0x2c0)]);}else{if(_0x4a1a28[_0x339658(0x1b1)]==='getEnums'){const _0x11eba4=await this['getForeignObjectsAsync']('enum.functions.*',_0x339658(0x1f3)),_0x5c1783=[];if(_0x11eba4)for(const _0x422857 in _0x11eba4){const _0xa02bb1=_0x11eba4[_0x422857],_0x2745ff=(_0xa02bb1[_0x339658(0x1e7)]&&typeof _0xa02bb1[_0x339658(0x1e7)][_0x339658(0x2ba)]===_0x339658(0x1e9)?_0xa02bb1[_0x339658(0x1e7)][_0x339658(0x2ba)]['de']:_0xa02bb1['common'][_0x339658(0x2ba)])||_0xa02bb1[_0x339658(0x1e7)]['name'];_0x5c1783[_0x339658(0x1b8)]({'id':_0x422857,'name':_0x2745ff});}this['sendTo'](_0x4a1a28[_0x339658(0x2fb)],_0x4a1a28[_0x339658(0x1b1)],{'success':!![],'enums':_0x5c1783},_0x4a1a28[_0x339658(0x2c0)]);}else{if(_0x4a1a28['command']===_0x339658(0x2b7))try{const _0x127c65=await scanForDevices(this,_0x4a1a28[_0x339658(0x283)]||{});this[_0x339658(0x278)](_0x4a1a28[_0x339658(0x2fb)],_0x4a1a28[_0x339658(0x1b1)],{'success':!![],'devices':_0x127c65},_0x4a1a28['callback']);}catch(_0x43f466){this[_0x339658(0x278)](_0x4a1a28[_0x339658(0x2fb)],_0x4a1a28[_0x339658(0x1b1)],{'success':![],'error':_0x43f466[_0x339658(0x283)]},_0x4a1a28[_0x339658(0x2c0)]);}else{if(_0x4a1a28[_0x339658(0x1b1)]===_0x339658(0x226)){}else{if(_0x4a1a28[_0x339658(0x1b1)]===_0x339658(0x1d6)){}else{if(_0x4a1a28[_0x339658(0x1b1)]===_0x339658(0x1e6)){}else _0x4a1a28[_0x339658(0x1b1)]==='dismissAutomation'&&(this[_0x339658(0x225)]['info']('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x339658(0x2f7),{'val':![],'ack':!![]}),await this[_0x339658(0x2b0)](_0x339658(0x22c),{'val':'','ack':!![]}),this[_0x339658(0x278)](_0x4a1a28[_0x339658(0x2fb)],_0x4a1a28[_0x339658(0x1b1)],{'success':!![]},_0x4a1a28[_0x339658(0x2c0)]));}}}}}}}}}catch(_0x39e953){}}}async function initZombies(_0x5d4cf8){}async function initHistory(_0x40fd9b){const _0xe212e7=a0_0x3344a6;try{const _0x370d67=await _0x40fd9b[_0xe212e7(0x217)](_0xe212e7(0x1b5));_0x370d67&&_0x370d67[_0xe212e7(0x2e8)]&&(_0x40fd9b[_0xe212e7(0x328)]=JSON['parse'](_0x370d67[_0xe212e7(0x2e8)]['toString']()));}catch(_0x145d68){_0x40fd9b['eventHistory']=[];}try{const _0x44bb60=await _0x40fd9b[_0xe212e7(0x217)](_0xe212e7(0x2b8));if(_0x44bb60&&_0x44bb60[_0xe212e7(0x2e8)])_0x40fd9b[_0xe212e7(0x285)]=JSON[_0xe212e7(0x2a7)](_0x44bb60[_0xe212e7(0x2e8)][_0xe212e7(0x293)]());}catch(_0x452775){_0x40fd9b[_0xe212e7(0x285)]=[];}}async function initSystemConfig(_0x4c7b5e){const _0x3b5137=a0_0x3344a6;try{const _0x4ad5e9=await _0x4c7b5e[_0x3b5137(0x1fe)](_0x3b5137(0x316));_0x4ad5e9&&_0x4ad5e9[_0x3b5137(0x1e7)]&&(_0x4c7b5e[_0x3b5137(0x1d9)]={'latitude':_0x4ad5e9['common'][_0x3b5137(0x1ca)]||0x0,'longitude':_0x4ad5e9[_0x3b5137(0x1e7)][_0x3b5137(0x1be)]||0x0,'city':_0x4ad5e9['common'][_0x3b5137(0x1f1)]||''});}catch(_0x35b31e){}}async function checkLicense(_0xe53dbd,_0x4e1f54){const _0x56dc4f=a0_0x3344a6;if(!_0x4e1f54)return![];_0xe53dbd[_0x56dc4f(0x2e4)]=await getSystemUUID(_0xe53dbd);if(_0x4e1f54===_0x56dc4f(0x2e5)||_0x4e1f54[_0x56dc4f(0x259)](_0x56dc4f(0x1ba)))return!![];return![];}async function getSystemUUID(_0x5c3196){const _0x45830e=a0_0x3344a6;try{const _0x23c451=await _0x5c3196[_0x45830e(0x1fe)](_0x45830e(0x1f5));if(_0x23c451&&_0x23c451[_0x45830e(0x327)]&&_0x23c451[_0x45830e(0x327)][_0x45830e(0x263)])return _0x23c451['native'][_0x45830e(0x263)];return _0x45830e(0x26d);}catch(_0x4002a7){return _0x45830e(0x31d);}}async function createAllObjects(_0xa0222){const _0x25e1d8=a0_0x3344a6;await checkSystemObjects(_0xa0222),await _0xa0222['setObjectNotExistsAsync'](_0x25e1d8(0x1e4),{'type':_0x25e1d8(0x2c7),'common':{'name':'Who\x20is\x20present?','type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x1ad),'read':!![],'write':![],'def':''},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x22f),{'type':_0x25e1d8(0x2c7),'common':{'name':'Last\x20raw\x20event','type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x21d),'read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x1b5),{'type':'state','common':{'name':_0x25e1d8(0x2f0),'type':'string','role':_0x25e1d8(0x21d),'read':!![],'write':![]},'native':{}}),await _0xa0222['setObjectNotExistsAsync']('analysis.trigger',{'type':'state','common':{'name':_0x25e1d8(0x1d1),'type':_0x25e1d8(0x2c8),'role':_0x25e1d8(0x307),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x2ed),{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x322),'type':'boolean','role':_0x25e1d8(0x307),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xa0222['setObjectNotExistsAsync']('analysis.lastResult',{'type':_0x25e1d8(0x2c7),'common':{'name':'Last\x20Result','type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x21d),'read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x241),{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x262),'type':_0x25e1d8(0x2c8),'role':_0x25e1d8(0x1bd),'read':!![],'write':![],'def':![]},'native':{}}),await _0xa0222['setObjectNotExistsAsync'](_0x25e1d8(0x1cc),{'type':'state','common':{'name':'AI\x20Emergency\x20Status','type':_0x25e1d8(0x2c8),'role':_0x25e1d8(0x313),'read':!![],'write':![],'def':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x1fd),{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x291),'type':'string','role':_0x25e1d8(0x229),'read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x270),{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x1ee),'type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x1ad),'read':!![],'write':![]},'native':{}}),await _0xa0222['setObjectNotExistsAsync'](_0x25e1d8(0x2d8),{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x1f6),'type':_0x25e1d8(0x1aa),'role':'state','read':!![],'write':![],'def':'N/A'},'native':{}}),await _0xa0222['setObjectNotExistsAsync'](_0x25e1d8(0x1cb),{'type':_0x25e1d8(0x2c7),'common':{'name':'Comfort\x20Summary','type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x1ad),'read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x289),{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x2c6),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x266)](_0x25e1d8(0x276),{'type':_0x25e1d8(0x21e),'common':{'name':_0x25e1d8(0x272)},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x2f7),{'type':'state','common':{'name':'Pattern\x20Detected','type':_0x25e1d8(0x2c8),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)]('analysis.automation.description',{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x1fc),'type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x1ad),'read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x2b9),{'type':'state','common':{'name':_0x25e1d8(0x1e3),'type':_0x25e1d8(0x1aa),'role':'text','read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x213),{'type':_0x25e1d8(0x2c7),'common':{'name':'Target\x20ID','type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x223),{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x1c9),'type':'string','role':_0x25e1d8(0x1ad),'read':!![],'write':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x245),{'type':_0x25e1d8(0x2c7),'common':{'name':_0x25e1d8(0x2f3),'type':_0x25e1d8(0x2c8),'role':'switch','read':!![],'write':!![],'def':![]},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)](_0x25e1d8(0x1df),{'type':_0x25e1d8(0x2c7),'common':{'name':'Trigger\x20Action\x20Now','type':_0x25e1d8(0x2c8),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0xa0222['setObjectNotExistsAsync'](_0x25e1d8(0x2b8),{'type':'state','common':{'name':_0x25e1d8(0x222),'type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x21d),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0xa0222['setObjectNotExistsAsync'](_0x25e1d8(0x1f2),{'type':_0x25e1d8(0x2c7),'common':{'name':'Feedback\x20Log','type':'string','role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0xa0222[_0x25e1d8(0x266)](_0x25e1d8(0x218),{'type':_0x25e1d8(0x21e),'common':{'name':_0x25e1d8(0x268)},'native':{}}),await _0xa0222['setObjectNotExistsAsync']('analysis.health.sleepScore',{'type':_0x25e1d8(0x2c7),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x25e1d8(0x1de),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0xa0222[_0x25e1d8(0x1ff)]('analysis.health.restlessness',{'type':_0x25e1d8(0x2c7),'common':{'name':'Restlessness\x20Level','type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x1ad),'read':!![],'write':![],'def':'none'},'native':{}}),await _0xa0222['setObjectNotExistsAsync']('analysis.health.notes',{'type':_0x25e1d8(0x2c7),'common':{'name':'Health\x20Notes','type':_0x25e1d8(0x1aa),'role':_0x25e1d8(0x1ad),'read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0xa0222),await checkLtmDriftObjects(_0xa0222);}async function checkSystemObjects(_0x125d3c){const _0x440567=a0_0x3344a6;await _0x125d3c[_0x440567(0x266)](_0x440567(0x251),{'type':_0x440567(0x21e),'common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0x125d3c[_0x440567(0x266)](SYSTEM_DP_MODE,{'type':'state','common':{'name':'System\x20Mode','type':_0x440567(0x1aa),'role':_0x440567(0x2c7),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x440567(0x279)],'states':{[SYSTEM_MODES[_0x440567(0x279)]]:'Normal',[SYSTEM_MODES[_0x440567(0x249)]]:_0x440567(0x27e),[SYSTEM_MODES[_0x440567(0x331)]]:_0x440567(0x246),[SYSTEM_MODES[_0x440567(0x2aa)]]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x2fa466){const _0x5c8b7e=a0_0x3344a6;await _0x2fa466[_0x5c8b7e(0x266)](_0x5c8b7e(0x2c2),{'type':'channel','common':{'name':_0x5c8b7e(0x2c2)},'native':{}}),await _0x2fa466[_0x5c8b7e(0x266)](LTM_DP_RAW_LOG,{'type':_0x5c8b7e(0x2c7),'common':{'name':_0x5c8b7e(0x306),'type':'string','role':_0x5c8b7e(0x21d),'read':!![],'write':![]},'native':{}}),await _0x2fa466[_0x5c8b7e(0x266)](LTM_DP_DAILY_DIGESTS,{'type':_0x5c8b7e(0x2c7),'common':{'name':_0x5c8b7e(0x27a),'type':_0x5c8b7e(0x1aa),'role':_0x5c8b7e(0x21d),'read':!![],'write':![]},'native':{}}),await _0x2fa466[_0x5c8b7e(0x266)](LTM_DP_STATUS,{'type':_0x5c8b7e(0x2c7),'common':{'name':_0x5c8b7e(0x2ca),'type':_0x5c8b7e(0x1aa),'role':_0x5c8b7e(0x1ad),'read':!![],'write':![]},'native':{}}),await _0x2fa466[_0x5c8b7e(0x266)](LTM_DP_TRIGGER_DIGEST,{'type':_0x5c8b7e(0x2c7),'common':{'name':_0x5c8b7e(0x2cc),'type':_0x5c8b7e(0x2c8),'role':_0x5c8b7e(0x307),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2fa466[_0x5c8b7e(0x266)](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':'Baseline\x20Status','type':_0x5c8b7e(0x1aa),'role':_0x5c8b7e(0x1ad),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x26cd24){const _0x1913ae=a0_0x3344a6;await _0x26cd24[_0x1913ae(0x266)](LTM_DP_DRIFT_CHANNEL,{'type':_0x1913ae(0x21e),'common':{'name':_0x1913ae(0x22b)},'native':{}}),await _0x26cd24[_0x1913ae(0x266)](LTM_DP_DRIFT_STATUS,{'type':_0x1913ae(0x2c7),'common':{'name':'Drift\x20Status','type':_0x1913ae(0x1aa),'role':'state','read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x26cd24[_0x1913ae(0x266)](LTM_DP_DRIFT_DETAILS,{'type':_0x1913ae(0x2c7),'common':{'name':_0x1913ae(0x207),'type':_0x1913ae(0x1aa),'role':'text','read':!![],'write':![]},'native':{}}),await _0x26cd24[_0x1913ae(0x266)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x1913ae(0x2c7),'common':{'name':_0x1913ae(0x248),'type':'number','role':_0x1913ae(0x260),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x137403){const _0x300392=a0_0x3344a6;try{const _0x28e1d6=await _0x137403['getStateAsync'](SYSTEM_DP_MODE);_0x28e1d6&&_0x28e1d6[_0x300392(0x2e8)]&&Object[_0x300392(0x269)](SYSTEM_MODES)[_0x300392(0x2d1)](_0x28e1d6[_0x300392(0x2e8)])?_0x137403['currentSystemMode']=_0x28e1d6['val']:(_0x137403['currentSystemMode']=SYSTEM_MODES[_0x300392(0x279)],await _0x137403[_0x300392(0x2b0)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x300392(0x279)],'ack':!![]}));}catch(_0x2dac8d){_0x137403['currentSystemMode']=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x5497ae){const _0x387956=a0_0x3344a6;try{const _0x36a7b4=await _0x5497ae['getStateAsync'](LTM_DP_RAW_LOG);if(_0x36a7b4&&_0x36a7b4[_0x387956(0x2e8)])_0x5497ae[_0x387956(0x290)]=JSON[_0x387956(0x2a7)](_0x36a7b4['val']);}catch(_0x16c693){_0x5497ae[_0x387956(0x290)]=[];}}async function saveRawEventLog(_0x585f36){const _0x47b234=a0_0x3344a6;_0x585f36['rawEventLog'][_0x47b234(0x1ce)]>RAW_LOG_MAX_SIZE&&_0x585f36[_0x47b234(0x290)][_0x47b234(0x23b)](0x0,_0x585f36[_0x47b234(0x290)][_0x47b234(0x1ce)]-RAW_LOG_MAX_SIZE),await _0x585f36[_0x47b234(0x2b0)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x585f36['rawEventLog']),'ack':!![]});}async function saveDailyDigests(_0x2299af,_0x3deda1=!![]){const _0x19dede=a0_0x3344a6,_0x3f616e=_0x2299af[_0x19dede(0x32e)][_0x19dede(0x2f5)]||0x3c;_0x2299af[_0x19dede(0x2ae)][_0x19dede(0x1ce)]>_0x3f616e&&_0x2299af[_0x19dede(0x2ae)]['splice'](0x0,_0x2299af[_0x19dede(0x2ae)][_0x19dede(0x1ce)]-_0x3f616e);await _0x2299af[_0x19dede(0x2b0)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x2299af['dailyDigests']),'ack':!![]});if(_0x3deda1)await updateBaselineStatus(_0x2299af);}function a0_0x578c(){const _0x2e2dd9=['driftAnalysisTimer','12DcmXiN','8830OpAuzU','description','onStateChange','guest','systemUUID','TEST-PRO-KEY','179033bxXLky','error','val','constructor','08:00','ical.0','reachable','analysis.triggerBriefing','getDate','Briefing\x20Sched\x20Error:\x20','Event\x20History','\x20events','online','Auto\x20Apply\x20Rule','currentposition','ltmLtbWindowDays','catch','analysis.automation.patternDetected','getFullYear','Lernphase\x20(','Gemini\x20Init\x20Error:\x20','from','sensorLastValues','history.','112rqMdcY','forEach','Generating\x20Morning\x20Briefing...','.NextHours.Location_1.Day_1.current.symbol_desc','0\x203\x20*\x20*\x20*','enum.rooms.*','briefingJob','vis.','Raw\x20Log','button','486VFnukP','lastCheck','targetposition','licht','find','ðŸš¨\x20EMERGENCY','info.','selectedFunctionIds','stateChange','Kein\x20API\x20Key!','ltmDriftCheckIntervalHours','indicator.alarm.fire','scriptProblem','presence','system.config','sendToAsync','now','toLocaleString','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','split','uuid-error','cogni-living','some','unreach','lastIndexOf','Trigger\x20Briefing\x20(Test)','notifyPushoverRecipient','.forecast.current.state','exitTimer','main','native','eventHistory','getForeignStateAsync','currentSystemMode','1520799XiGwMH','echarts.','toFixed','config','Error\x20checking\x20WiFi:\x20','lowbat','PARTY','enum.functions.*','system.','Scheduling\x20Morning\x20Briefing\x20for\x20','connection','Analysiere\x20ausgewogen.','schalter','subscribeStates','exports','string','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','pop','text','sleepScore','licenseKey','notifyTelegramInstance','command','time','scriptEnabled','toLowerCase','events.history','custom','communicate.request','push','lock','PRO-','Starting\x20Autopilot\x20(','KALENDER\x20ERROR:\x20','indicator.alarm','longitude','triggerBriefing','Success:\x20Compressed\x20','weatherInstance','\x20hours.\x20Potential\x20incapacitation.','motion','baselineDrift','Sending\x20notification:\x20\x22','setState','humidity','application/json','Target\x20Value','latitude','analysis.comfortSummary','analysis.isEmergency','fault','length','Cogni-Living','ltmJob','Trigger\x20Analysis','ðŸŒ…\x20Daily\x20Briefing:\x0a','Started\x20at\x20','stick_unreach','temperature','simulateButler','\x20sensors...','stringify','systemConfig','admin.','WETTER\x20ERROR:\x20','lampe','2ktMKoO','number','analysis.automation.triggerAction','level','LTM.driftAnalysis.baselineDrift','\x20|\x20','Action','system.presenceWho','link_quality','submitFeedback','common','.\x20OUTPUT:\x20Nur\x20Text.','object','models/gemini-flash-latest','Subscribing\x20to\x20','write','analysisTimer','Activity\x20Summary','blind','LTM.driftAnalysis','city','analysis.feedbackHistory','enum','driftDetails','system.meta.uuid','Deviation','Wetter:\x20Deaktiviert','(((.+)+)+)+$','KALENDER:\x20Keine\x20Daten','LTM.dailyDigests','ack','Description','analysis.alertReason','getForeignObjectAsync','setObjectNotExistsAsync','info','position','shutter','geminiModel','.data.table','Error:\x20','inactivityThresholdHours','Drift\x20Details','COGNI_REQUEST_CALL','status','notifyEmailRecipient','siren','notifyTelegramEnabled','N/A','endsWith','telegram','onReady','0\x204\x20*\x20*\x20*','config_pending','analysis.automation.targetId','Fokus\x20auf\x20Familienroutinen.','weather','details','getStateAsync','analysis.health','calendarInstance','weatherunderground.0','send','substring','json','channel','devices','modeResetJob','ltmStbWindowDays','Logbook','analysis.automation.targetValue','direction','log','getCalendarNames','sensor','.\x20ZUSATZ:\x20','text.alarm','event','Drift\x20Analysis','analysis.automation.description','daswetter.0','LTM.triggerDailyDigest','events.lastEvent','search','cancel','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','Skipped\x20(No\x20AI\x20or\x20Data)','\x20*\x20*\x20*','autoApply','Feedback\x20saved:\x20','notifyEmailInstance','notifyTelegramRecipient','.communicate.request','unshift','splice','Adapter','light','getTime','version','accuweather.0','analysis.isAlert','\x20min).','slice','isProVersion','analysis.automation.autoApply','Party','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','Last\x20Check','VACATION','isGracePeriodActive','trim','sound','.\x20DATEN:\x20Schlaf\x20','health','notifyEmailEnabled','system.isPresent','system','setpoint','Reset\x20Sched\x20Error:\x20','3732ndbDTg','.Summary.Current','occupancy','bind','fill','startsWith','tÃ¼r','flot.','getOverviewData','LTM.processingStatus','generic','daswetter','date','LTM.driftAnalysis.lastCheck','AI\x20Alert\x20Status','uuid','exitGraceTimer','fenster','extendObjectAsync','activityLevel','Health\x20&\x20Sleep\x20Analysis','values','bewegung','presenceDevices','38296mBOqXR','uuid-not-found','klima','86983dgyEIV','analysis.activitySummary','accuweather','Automation\x20Proposals','response','map','join','analysis.automation','LTM.rawEventLog','sendTo','NORMAL','Daily\x20Digests','analysisInterval','@iobroker/adapter-core','LTM\x20Sched\x20Error:\x20','Urlaub','_calName','ready','[TEST]\x20','scheduleJob','message','PRIORITÃ„T:\x20Gesundheit/AAL.','analysisHistory','triggerDailyDigest','targetValue','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','analysis.comfortSuggestion','system.mode','timestamp','Error\x20reading\x20calendar\x20table:\x20','set_temperature','simple-api.','vacation','rawEventLog','Alert\x20Reason','calendarSelection','toString','prÃ¤senz','indexOf','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','retry','unknown','ðŸ“¡\x20Hooking\x20into\x20','193236BEldzL','lastAlertState','sort','openweathermap.0','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','isPresent','6743xySrol','off','apply','generateContent','KALENDER:\x20','switch','getForeignObjectsAsync','parse','Fokus\x20auf\x20Komfort.','aiPersona','GUEST','@google/generative-ai','testApiKey','testNotification','dailyDigests','\x0aSTB:\x20','setStateAsync','onUnload','briefingEnabled','members','KI-Modell\x20nicht\x20initialisiert','filter','subscribeForeignStatesAsync','scanDevices','analysis.analysisHistory','analysis.automation.suggestedAction','name','role','javascript.','valve','onMessage','geminiApiKey','callback','dutycycle','LTM','value','isArray','openweathermap','Comfort\x20Suggestion','state','boolean','522590grkRRy','Processing\x20Status','notifyPushoverEnabled','Trigger\x20Digest','summary','rssi','normal','working','includes','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','Deaktiviert\x20(Pro-Feature)','door','genAI','\x20for\x20interactive\x20buttons...','getHours','analysis.deviationFromBaseline','Drift\x20Sched\x20Error:\x20','minDaysForBaseline','lights','automation.triggerAction','detected'];a0_0x578c=function(){return _0x2e2dd9;};return a0_0x578c();}async function updateAnalysisHistory(_0x2f34a1,_0x3dba5e){const _0x5a39aa=a0_0x3344a6;_0x2f34a1[_0x5a39aa(0x285)][_0x5a39aa(0x23a)](_0x3dba5e);if(_0x2f34a1[_0x5a39aa(0x285)]['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x2f34a1[_0x5a39aa(0x285)][_0x5a39aa(0x1ac)]();await _0x2f34a1['setStateAsync'](_0x5a39aa(0x2b8),{'val':JSON[_0x5a39aa(0x1d8)](_0x2f34a1[_0x5a39aa(0x285)]),'ack':!![]});}async function updateBaselineStatus(_0x136db2){const _0x41cd5f=a0_0x3344a6;if(!_0x136db2['isProVersion']){await _0x136db2[_0x41cd5f(0x2b0)](LTM_DP_BASELINE_STATUS,{'val':_0x41cd5f(0x2d3),'ack':!![]});return;}const _0x22bbbf=_0x136db2[_0x41cd5f(0x2ae)][_0x41cd5f(0x1ce)]>=(_0x136db2['config'][_0x41cd5f(0x2da)]||0x7)?'Aktiv\x20('+_0x136db2[_0x41cd5f(0x2ae)][_0x41cd5f(0x1ce)]+'\x20Tage)':_0x41cd5f(0x2f9)+_0x136db2[_0x41cd5f(0x2ae)][_0x41cd5f(0x1ce)]+'/'+(_0x136db2[_0x41cd5f(0x32e)][_0x41cd5f(0x2da)]||0x7)+')';await _0x136db2[_0x41cd5f(0x2b0)](LTM_DP_BASELINE_STATUS,{'val':_0x22bbbf,'ack':!![]});}async function initSensorSubscriptions(_0x4e2b59){const _0x5bcc65=a0_0x3344a6,_0x5c8999=_0x4e2b59['config'][_0x5bcc65(0x21f)];if(_0x5c8999&&_0x5c8999[_0x5bcc65(0x1ce)]>0x0){_0x4e2b59[_0x5bcc65(0x225)]['info'](_0x5bcc65(0x1eb)+_0x5c8999[_0x5bcc65(0x1ce)]+_0x5bcc65(0x1d7));for(const _0x21601b of _0x5c8999){if(_0x21601b['id']){await _0x4e2b59[_0x5bcc65(0x2b6)](_0x21601b['id']);try{const _0x355047=await _0x4e2b59[_0x5bcc65(0x329)](_0x21601b['id']);if(_0x355047)_0x4e2b59['sensorLastValues'][_0x21601b['id']]=_0x355047[_0x5bcc65(0x2e8)];}catch(_0x48a7c5){}}}}}async function initPresenceSubscriptions(_0x504130){const _0x388179=a0_0x3344a6,_0xa2bd24=_0x504130[_0x388179(0x32e)][_0x388179(0x26b)]||[];if(_0xa2bd24[_0x388179(0x1ce)]>0x0){_0x504130['log'][_0x388179(0x200)](_0x388179(0x1eb)+_0xa2bd24[_0x388179(0x1ce)]+'\x20presence\x20devices...');for(const _0x28a506 of _0xa2bd24){await _0x504130['subscribeForeignStatesAsync'](_0x28a506);}try{await checkWifiPresence(_0x504130);}catch(_0x54dbd0){}}}async function getWeatherContext(_0x4d57cc){const _0x16c82b=a0_0x3344a6;try{if(!_0x4d57cc['config']['useWeather'])return _0x16c82b(0x1f7);let _0x556df9='';const _0x42d152=_0x4d57cc[_0x16c82b(0x32e)][_0x16c82b(0x1c1)];if(_0x42d152)try{if(_0x42d152['includes'](_0x16c82b(0x271))){const _0x47ec6c=await _0x4d57cc['getForeignStateAsync'](_0x42d152+_0x16c82b(0x255));if(_0x47ec6c&&_0x47ec6c[_0x16c82b(0x2e8)])_0x556df9=_0x47ec6c['val'];}else{if(_0x42d152[_0x16c82b(0x2d1)](_0x16c82b(0x25f))){const _0x3a6c54=await _0x4d57cc['getForeignStateAsync'](_0x42d152+_0x16c82b(0x301));if(_0x3a6c54&&_0x3a6c54[_0x16c82b(0x2e8)])_0x556df9=_0x3a6c54[_0x16c82b(0x2e8)];}else{if(_0x42d152['includes'](_0x16c82b(0x2c5))){const _0x2457f6=await _0x4d57cc['getForeignStateAsync'](_0x42d152+_0x16c82b(0x324));if(_0x2457f6&&_0x2457f6[_0x16c82b(0x2e8)])_0x556df9=_0x2457f6[_0x16c82b(0x2e8)];}}}}catch(_0x2f7273){}if(!_0x556df9){const _0x5c9158=[_0x16c82b(0x240),_0x16c82b(0x22d),_0x16c82b(0x21a),_0x16c82b(0x29d)];for(const _0x261537 of _0x5c9158){try{const _0x5ea1e8=await _0x4d57cc[_0x16c82b(0x1fe)](_0x261537);if(_0x5ea1e8){if(_0x261537[_0x16c82b(0x2d1)](_0x16c82b(0x271))){const _0x1f74c1=await _0x4d57cc['getForeignStateAsync'](_0x261537+'.Summary.Current');if(_0x1f74c1&&_0x1f74c1['val']){_0x556df9=_0x1f74c1[_0x16c82b(0x2e8)];break;}}}}catch(_0x11a2bf){}}}return _0x556df9?'WETTER:\x20'+_0x556df9:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x38d3a6){return _0x16c82b(0x1db)+_0x38d3a6['message'];}}async function getCalendarContext(_0x81d71c){const _0x1f12c7=a0_0x3344a6;try{if(!_0x81d71c['config']['useCalendar'])return'Kalender:\x20Deaktiviert';let _0x29e778=_0x81d71c['config'][_0x1f12c7(0x219)]||_0x1f12c7(0x2eb),_0x38b7da=_0x81d71c[_0x1f12c7(0x32e)][_0x1f12c7(0x292)]||[];if(typeof _0x38b7da===_0x1f12c7(0x1aa))_0x38b7da=_0x38b7da['split'](',');try{const _0x305569=await _0x81d71c[_0x1f12c7(0x329)](_0x29e778+_0x1f12c7(0x204));if(_0x305569&&_0x305569[_0x1f12c7(0x2e8)]){let _0x1bf4b0=tryParse(_0x305569[_0x1f12c7(0x2e8)]);if(_0x1bf4b0&&Array[_0x1f12c7(0x2c4)](_0x1bf4b0)){if(_0x38b7da[_0x1f12c7(0x1ce)]>0x0)_0x1bf4b0=_0x1bf4b0[_0x1f12c7(0x2b5)](_0x49bbfa=>_0x38b7da[_0x1f12c7(0x2d1)](_0x49bbfa[_0x1f12c7(0x27f)]||''));else return _0x1f12c7(0x296);if(_0x1bf4b0[_0x1f12c7(0x1ce)]>0x0){const _0x29c850=_0x1bf4b0[_0x1f12c7(0x243)](0x0,0x3)['map'](_0x3db54c=>{const _0x4bf0ea=_0x1f12c7;let _0x331b86=_0x3db54c['date'];if(_0x3db54c[_0x4bf0ea(0x1b2)])_0x331b86+='\x20'+_0x3db54c['time'];return _0x331b86+':\x20'+_0x3db54c[_0x4bf0ea(0x22a)]+'\x20('+_0x3db54c[_0x4bf0ea(0x27f)]+')';});return _0x1f12c7(0x2a4)+_0x29c850['join'](_0x1f12c7(0x1e2));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x336f7e){_0x81d71c['log']['warn'](_0x1f12c7(0x28c)+_0x336f7e[_0x1f12c7(0x283)]);}return _0x1f12c7(0x1f9);}catch(_0x51ab7a){return _0x1f12c7(0x1bc)+_0x51ab7a[_0x1f12c7(0x283)];}}async function getCalendarNames(_0x3b3847,_0x5b2d15){const _0x59a84f=a0_0x3344a6;try{const _0x337f1a=await _0x3b3847[_0x59a84f(0x329)](_0x5b2d15+_0x59a84f(0x204));if(_0x337f1a&&_0x337f1a[_0x59a84f(0x2e8)]){const _0x455010=tryParse(_0x337f1a[_0x59a84f(0x2e8)]);if(_0x455010&&Array[_0x59a84f(0x2c4)](_0x455010)){const _0x2eb2c9=[...new Set(_0x455010[_0x59a84f(0x274)](_0x3308ca=>_0x3308ca[_0x59a84f(0x27f)])[_0x59a84f(0x2b5)](Boolean))];return _0x2eb2c9[_0x59a84f(0x29c)]();}}return[];}catch(_0x5dea61){return _0x3b3847[_0x59a84f(0x225)]['error']('getCalendarNames\x20Error:\x20'+_0x5dea61[_0x59a84f(0x283)]),[];}}async function checkWifiPresence(_0x217faf){const _0x58fa08=a0_0x3344a6;try{const _0x736f8a=_0x217faf[_0x58fa08(0x32e)][_0x58fa08(0x26b)]||[];let _0x2263d9=![];const _0x144c6b=[];for(const _0x3b12e9 of _0x736f8a){try{const _0x9ba36a=await _0x217faf['getForeignStateAsync'](_0x3b12e9);if(_0x9ba36a&&(_0x9ba36a['val']===!![]||_0x9ba36a[_0x58fa08(0x2e8)]===_0x58fa08(0x2f2)||_0x9ba36a[_0x58fa08(0x2e8)]===0x1)){_0x2263d9=!![];const _0x4965f8=await _0x217faf['getForeignObjectAsync'](_0x3b12e9);let _0x1ca3a3=_0x3b12e9;_0x4965f8&&_0x4965f8[_0x58fa08(0x1e7)]&&_0x4965f8[_0x58fa08(0x1e7)]['name']&&(_0x1ca3a3=typeof _0x4965f8[_0x58fa08(0x1e7)][_0x58fa08(0x2ba)]===_0x58fa08(0x1e9)?_0x4965f8[_0x58fa08(0x1e7)][_0x58fa08(0x2ba)]['de']||_0x4965f8[_0x58fa08(0x1e7)][_0x58fa08(0x2ba)]['en']:_0x4965f8[_0x58fa08(0x1e7)][_0x58fa08(0x2ba)]),_0x144c6b[_0x58fa08(0x1b8)](_0x1ca3a3);}}catch(_0x3c9af7){}}return await _0x217faf['setStateAsync'](_0x58fa08(0x1e4),{'val':_0x144c6b[_0x58fa08(0x275)](',\x20'),'ack':!![]}),_0x2263d9&&(_0x217faf[_0x58fa08(0x325)]&&(_0x217faf['log'][_0x58fa08(0x200)](_0x58fa08(0x247)),abortExitTimer(_0x217faf)),!_0x217faf[_0x58fa08(0x29f)]&&_0x217faf[_0x58fa08(0x32a)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x217faf,!![])),_0x2263d9;}catch(_0x305b3d){return _0x217faf[_0x58fa08(0x225)][_0x58fa08(0x2e7)](_0x58fa08(0x32f)+_0x305b3d['message']),![];}}function startExitTimer(_0x33020f){const _0x5c56d9=a0_0x3344a6;abortExitTimer(_0x33020f),_0x33020f[_0x5c56d9(0x24a)]=!![],_0x33020f['exitGraceTimer']=setTimeout(()=>{_0x33020f['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x33020f['exitTimer']=setTimeout(()=>{const _0x1706b2=_0x5c56d9;setPresence(_0x33020f,![]),_0x33020f[_0x1706b2(0x325)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x4ac27c){const _0x96bde8=a0_0x3344a6;if(_0x4ac27c[_0x96bde8(0x325)])clearTimeout(_0x4ac27c['exitTimer']);if(_0x4ac27c['exitGraceTimer'])clearTimeout(_0x4ac27c[_0x96bde8(0x264)]);_0x4ac27c['exitTimer']=null,_0x4ac27c[_0x96bde8(0x264)]=null,_0x4ac27c[_0x96bde8(0x24a)]=![];}async function setPresence(_0x215bbc,_0x78912a){const _0x1f5e1e=a0_0x3344a6;if(_0x215bbc[_0x1f5e1e(0x29f)]===_0x78912a)return;_0x215bbc[_0x1f5e1e(0x29f)]=_0x78912a,await _0x215bbc['setStateAsync'](_0x1f5e1e(0x250),{'val':_0x78912a,'ack':!![]});}async function saveFeedback(_0x39372f,_0xf4ebe1){const _0x1d009b=a0_0x3344a6;_0x39372f['log'][_0x1d009b(0x200)](_0x1d009b(0x236)+JSON[_0x1d009b(0x1d8)](_0xf4ebe1));}async function runBaselineDriftAnalysis(_0x49f547){const _0x3f2e82=a0_0x3344a6;if(!_0x49f547['isProVersion']||!_0x49f547[_0x3f2e82(0x203)])return;const _0x3f3442=_0x49f547['config'][_0x3f2e82(0x221)]||0xe;if(_0x49f547[_0x3f2e82(0x2ae)][_0x3f2e82(0x1ce)]<_0x3f3442+(_0x49f547['config'][_0x3f2e82(0x2da)]||0x7)){await _0x49f547[_0x3f2e82(0x2b0)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x21a081=_0x49f547[_0x3f2e82(0x2ae)]['slice'](-_0x3f3442),_0x5457fa=_0x49f547['dailyDigests']['slice'](0x0,_0x49f547['dailyDigests']['length']-_0x3f3442),_0x432fb4=_0x3f2e82(0x288)+JSON[_0x3f2e82(0x1d8)](_0x5457fa)+_0x3f2e82(0x2af)+JSON[_0x3f2e82(0x1d8)](_0x21a081);try{const _0x510f62=await _0x49f547[_0x3f2e82(0x203)][_0x3f2e82(0x2a3)](_0x432fb4),_0x4d87f7=JSON[_0x3f2e82(0x2a7)](_0x510f62[_0x3f2e82(0x273)][_0x3f2e82(0x1ad)]()['replace'](/```json|```/g,'')[_0x3f2e82(0x24b)]());_0x4d87f7[_0x3f2e82(0x1c4)]&&(await _0x49f547[_0x3f2e82(0x2b0)](LTM_DP_DRIFT_STATUS,{'val':_0x4d87f7[_0x3f2e82(0x1c4)],'ack':!![]}),await _0x49f547[_0x3f2e82(0x2b0)](LTM_DP_DRIFT_DETAILS,{'val':_0x4d87f7[_0x3f2e82(0x1f4)],'ack':!![]}),await _0x49f547[_0x3f2e82(0x2b0)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x3f2e82(0x318)](),'ack':!![]}));}catch(_0x1ac058){}}function setupLtmScheduler(_0x3cebe3){const _0x1b4e73=a0_0x3344a6;try{if(_0x3cebe3[_0x1b4e73(0x1d0)])_0x3cebe3[_0x1b4e73(0x1d0)][_0x1b4e73(0x231)]();if(!_0x3cebe3['isProVersion']){_0x3cebe3['setStateAsync'](LTM_DP_STATUS,{'val':_0x1b4e73(0x2d3),'ack':!![]});return;}_0x3cebe3[_0x1b4e73(0x1d0)]=schedule[_0x1b4e73(0x282)](LTM_SCHEDULE,()=>createDailyDigest(_0x3cebe3));}catch(_0x4fc22c){_0x3cebe3['log'][_0x1b4e73(0x2e7)](_0x1b4e73(0x27d)+_0x4fc22c['message']);}}function setupModeResetScheduler(_0x54c5b0){const _0x46773a=a0_0x3344a6;try{if(_0x54c5b0[_0x46773a(0x220)])_0x54c5b0[_0x46773a(0x220)][_0x46773a(0x231)]();_0x54c5b0['modeResetJob']=schedule[_0x46773a(0x282)](MODE_RESET_SCHEDULE,async()=>{const _0x13d6c4=_0x46773a;await loadSystemMode(_0x54c5b0),AUTO_RESET_MODES[_0x13d6c4(0x2d1)](_0x54c5b0[_0x13d6c4(0x32a)])&&await _0x54c5b0[_0x13d6c4(0x2b0)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x13d6c4(0x279)],'ack':![]});});}catch(_0x315c5c){_0x54c5b0[_0x46773a(0x225)][_0x46773a(0x2e7)](_0x46773a(0x253)+_0x315c5c[_0x46773a(0x283)]);}}function setupDriftAnalysisScheduler(_0x2e4543){const _0x31a5a3=a0_0x3344a6;try{if(_0x2e4543[_0x31a5a3(0x2de)])clearInterval(_0x2e4543[_0x31a5a3(0x2de)]);if(!_0x2e4543['isProVersion'])return;_0x2e4543[_0x31a5a3(0x2de)]=setInterval(()=>runBaselineDriftAnalysis(_0x2e4543),(_0x2e4543[_0x31a5a3(0x32e)][_0x31a5a3(0x312)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x2e4543),0x1388);}catch(_0x4ec37c){_0x2e4543[_0x31a5a3(0x225)][_0x31a5a3(0x2e7)](_0x31a5a3(0x2d9)+_0x4ec37c['message']);}}function setupBriefingScheduler(_0x81cf29){const _0x30925=a0_0x3344a6;try{if(_0x81cf29[_0x30925(0x304)])_0x81cf29[_0x30925(0x304)][_0x30925(0x231)]();if(!_0x81cf29[_0x30925(0x32e)][_0x30925(0x2b2)])return;const _0x1b1ed8=(_0x81cf29[_0x30925(0x32e)]['briefingTime']||_0x30925(0x2ea))[_0x30925(0x31c)](':'),_0x3a2ea2=parseInt(_0x1b1ed8[0x0])||0x8,_0x1acd2e=parseInt(_0x1b1ed8[0x1])||0x0,_0x4cfad6=_0x1acd2e+'\x20'+_0x3a2ea2+_0x30925(0x234);_0x81cf29[_0x30925(0x225)][_0x30925(0x200)](_0x30925(0x334)+_0x3a2ea2+':'+(_0x1acd2e<0xa?'0'+_0x1acd2e:_0x1acd2e)),_0x81cf29[_0x30925(0x304)]=schedule[_0x30925(0x282)](_0x4cfad6,()=>{sendMorningBriefing(_0x81cf29);});}catch(_0x2cf58b){_0x81cf29[_0x30925(0x225)][_0x30925(0x2e7)](_0x30925(0x2ef)+_0x2cf58b['message']);}}async function sendNotification(_0x2efa63,_0x29c442,_0x581c00=![],_0x5c74ea=![]){const _0x1a44b5=a0_0x3344a6;_0x2efa63['log']['info']((_0x581c00?_0x1a44b5(0x281):'')+_0x1a44b5(0x1c5)+_0x29c442+'\x22');const _0x5bfa0c=_0x2efa63['config'];let _0x243ef8=0x0;_0x5bfa0c[_0x1a44b5(0x20c)]&&(await _0x2efa63[_0x1a44b5(0x317)](_0x5bfa0c[_0x1a44b5(0x1b0)],_0x1a44b5(0x21b),{'text':_0x29c442,'user':_0x5bfa0c[_0x1a44b5(0x238)]}),_0x243ef8++);if(_0x5bfa0c[_0x1a44b5(0x2cb)]){let _0x3b51d2={'message':_0x29c442,'title':_0x5c74ea?_0x1a44b5(0x30d):_0x1a44b5(0x1cf),'priority':_0x5c74ea?0x2:0x1,'device':_0x5bfa0c[_0x1a44b5(0x323)]};_0x5c74ea&&(_0x3b51d2[_0x1a44b5(0x297)]=0x1e,_0x3b51d2['expire']=0xe10,_0x3b51d2[_0x1a44b5(0x24c)]=_0x1a44b5(0x20b)),await this['sendToAsync'](_0x5bfa0c['notifyPushoverInstance'],_0x1a44b5(0x21b),_0x3b51d2),_0x243ef8++;}return _0x5bfa0c[_0x1a44b5(0x24f)]&&(await this[_0x1a44b5(0x317)](_0x5bfa0c[_0x1a44b5(0x237)],_0x1a44b5(0x21b),{'text':_0x29c442,'to':_0x5bfa0c[_0x1a44b5(0x20a)]}),_0x243ef8++),_0x243ef8;}async function setupTelegramListener(_0x50f33c){const _0x3b0222=a0_0x3344a6,_0x37df3b=_0x50f33c[_0x3b0222(0x32e)][_0x3b0222(0x1b0)];_0x50f33c[_0x3b0222(0x32e)]['notifyTelegramEnabled']&&_0x37df3b&&(_0x50f33c['log'][_0x3b0222(0x200)](_0x3b0222(0x299)+_0x37df3b+_0x3b0222(0x2d6)),await _0x50f33c['subscribeForeignStatesAsync'](_0x37df3b+_0x3b0222(0x239)));}async function handleTelegramResponse(_0x49ed90,_0x55e612){const _0x165cb3=a0_0x3344a6;let _0x55ac4c=_0x55e612;_0x55e612[_0x165cb3(0x259)]('[')&&(_0x55ac4c=_0x55e612[_0x165cb3(0x21c)](_0x55e612[_0x165cb3(0x295)](']')+0x1));if(_0x55ac4c==='COGNI_CONFIRM_OK')_0x49ed90[_0x165cb3(0x225)]['info']('âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.'),await _0x49ed90[_0x165cb3(0x2b0)](_0x165cb3(0x241),{'val':![],'ack':!![]}),await _0x49ed90[_0x165cb3(0x2b0)](_0x165cb3(0x1fd),{'val':_0x165cb3(0x1ab),'ack':!![]}),_0x49ed90[_0x165cb3(0x29b)]=![],sendNotification(_0x49ed90,'âœ…\x20Alarm\x20quittiert.\x20System\x20normal.',![]);else _0x55ac4c===_0x165cb3(0x208)&&(_0x49ed90[_0x165cb3(0x225)]['warn'](_0x165cb3(0x2d2)),sendNotification(_0x49ed90,_0x165cb3(0x232),![],!![]));}async function runAutopilot(_0x22c0c8){const _0x34436f=a0_0x3344a6,_0x3a931=_0x22c0c8[_0x34436f(0x32e)][_0x34436f(0x206)],_0x36f747=_0x22c0c8[_0x34436f(0x328)][_0x34436f(0x1ce)]>0x0?_0x22c0c8['eventHistory'][0x0][_0x34436f(0x28b)]:Date['now'](),_0x1fed8d=(Date[_0x34436f(0x318)]()-_0x36f747)/(0x3e8*0x3c*0x3c);let _0x131a4d='';_0x22c0c8[_0x34436f(0x32e)]['inactivityMonitoringEnabled']&&_0x22c0c8[_0x34436f(0x32a)]===SYSTEM_MODES['NORMAL']&&_0x22c0c8[_0x34436f(0x29f)]&&(_0x1fed8d>_0x3a931&&(_0x131a4d=_0x34436f(0x29e)+_0x1fed8d[_0x34436f(0x32d)](0x1)+_0x34436f(0x1c2))),runGeminiAnalysis(_0x22c0c8,_0x131a4d)[_0x34436f(0x2f6)](_0x21f31d=>_0x22c0c8[_0x34436f(0x225)][_0x34436f(0x2e7)](_0x21f31d));}async function createDailyDigest(_0x2e7533){const _0x10e709=a0_0x3344a6;if(!_0x2e7533['isProVersion'])return;await _0x2e7533[_0x10e709(0x2b0)](LTM_DP_STATUS,{'val':_0x10e709(0x1d3)+new Date()[_0x10e709(0x319)](),'ack':!![]});if(!_0x2e7533['geminiModel']||_0x2e7533[_0x10e709(0x290)][_0x10e709(0x1ce)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2e7533[_0x10e709(0x2b0)](LTM_DP_STATUS,{'val':_0x10e709(0x233),'ack':!![]});return;}const _0x4a95a3=JSON[_0x10e709(0x2a7)](JSON['stringify'](_0x2e7533['rawEventLog'])),_0x19b18f=_0x4a95a3[_0x10e709(0x1ce)],_0xc9d4e5='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x10e709(0x1d8)](_0x4a95a3);try{const _0xcd3fb5=await _0x2e7533['geminiModel'][_0x10e709(0x2a3)](_0xc9d4e5),_0x4410a7=JSON['parse'](_0xcd3fb5[_0x10e709(0x273)][_0x10e709(0x1ad)]()['replace'](/```json|```/g,'')[_0x10e709(0x24b)]());_0x4410a7['summary']&&(_0x2e7533[_0x10e709(0x2ae)][_0x10e709(0x1b8)]({'timestamp':new Date()['toISOString'](),'eventCount':_0x19b18f,'summary':_0x4410a7[_0x10e709(0x2cd)],'activityLevel':_0x4410a7[_0x10e709(0x267)],'systemMode':_0x2e7533[_0x10e709(0x32a)]}),await saveDailyDigests(_0x2e7533),_0x2e7533[_0x10e709(0x290)]=[],await saveRawEventLog(_0x2e7533),await _0x2e7533[_0x10e709(0x2b0)](LTM_DP_STATUS,{'val':_0x10e709(0x1c0)+_0x19b18f+_0x10e709(0x2f1),'ack':!![]}));}catch(_0x1f3592){await _0x2e7533['setStateAsync'](LTM_DP_STATUS,{'val':_0x10e709(0x205)+_0x1f3592['message'],'ack':!![]});}}async function sendMorningBriefing(_0x37b962){const _0x59da54=a0_0x3344a6;if(!_0x37b962['geminiModel'])return;_0x37b962[_0x59da54(0x225)][_0x59da54(0x200)](_0x59da54(0x300));const _0x131176=_0x37b962[_0x59da54(0x2ae)]['length']>0x0?_0x37b962['dailyDigests'][_0x37b962['dailyDigests'][_0x59da54(0x1ce)]-0x1]:null,_0x546c18=_0x131176&&_0x131176[_0x59da54(0x24e)]?_0x131176[_0x59da54(0x24e)][_0x59da54(0x1ae)]:'N/A',_0x3386e3=new Date();_0x3386e3['setHours'](0x4,0x0,0x0,0x0);const _0x48e19f=_0x37b962[_0x59da54(0x328)][_0x59da54(0x2b5)](_0xbc6419=>new Date(_0xbc6419['timestamp'])>_0x3386e3),_0xda8315=PERSONA_MAPPING[_0x37b962[_0x59da54(0x32e)][_0x59da54(0x2a9)]||_0x59da54(0x25e)],_0x19f89d=_0x37b962[_0x59da54(0x32e)]['livingContext']||'',_0x1b40e0=await getWeatherContext(_0x37b962),_0x51f29d=await getCalendarContext(_0x37b962),_0x38ebe0=_0x59da54(0x31b)+_0xda8315+'.\x20KONTEXT:\x20'+_0x19f89d+_0x59da54(0x228)+_0x1b40e0+'\x20'+_0x51f29d+_0x59da54(0x24d)+_0x546c18+_0x59da54(0x31a)+JSON['stringify'](_0x48e19f[_0x59da54(0x243)](0x0,0xa))+_0x59da54(0x1e8);try{const _0x1036eb=await _0x37b962['geminiModel'][_0x59da54(0x2a3)](_0x38ebe0),_0x3abfdc=_0x59da54(0x1d2)+_0x1036eb['response']['text']()[_0x59da54(0x24b)]();sendNotification(_0x37b962,_0x3abfdc),_0x37b962[_0x59da54(0x225)][_0x59da54(0x200)]('Morning\x20Briefing\x20sent.');}catch(_0x5cfb8d){_0x37b962['log'][_0x59da54(0x2e7)]('Briefing\x20Error:\x20'+_0x5cfb8d[_0x59da54(0x283)]);}}async function scanForDevices(_0x46883a,_0x32b9a6){const _0x6e393e=a0_0x3344a6;_0x46883a[_0x6e393e(0x225)][_0x6e393e(0x200)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x19d66a=[],_0x45f3ff=await _0x46883a[_0x6e393e(0x2a6)]('*'),_0x42e8f9=await _0x46883a[_0x6e393e(0x2a6)](_0x6e393e(0x332),_0x6e393e(0x1f3)),_0x5d266f=await _0x46883a[_0x6e393e(0x2a6)](_0x6e393e(0x303),'enum'),_0x439100={};if(_0x42e8f9)for(const _0x2801b2 in _0x42e8f9){const _0x3c7eea=_0x42e8f9[_0x2801b2][_0x6e393e(0x1e7)]['members']||[];_0x3c7eea[_0x6e393e(0x2ff)](_0x20d5bc=>{const _0x25290a=_0x6e393e;if(!_0x439100[_0x20d5bc])_0x439100[_0x20d5bc]=[];_0x439100[_0x20d5bc][_0x25290a(0x1b8)](_0x2801b2);});}const _0x59149a={};if(_0x5d266f)for(const _0x18efb6 in _0x5d266f){const _0x5e593a=_0x5d266f[_0x18efb6][_0x6e393e(0x1e7)][_0x6e393e(0x2b3)]||[],_0x205197=typeof _0x5d266f[_0x18efb6][_0x6e393e(0x1e7)]['name']===_0x6e393e(0x1e9)?_0x5d266f[_0x18efb6][_0x6e393e(0x1e7)][_0x6e393e(0x2ba)]['de']:_0x5d266f[_0x18efb6][_0x6e393e(0x1e7)]['name'];_0x5e593a['forEach'](_0x35c54f=>_0x59149a[_0x35c54f]=_0x205197);}const _0x14dca3=_0x32b9a6[_0x6e393e(0x30f)]||[],_0x159c47=_0x32b9a6[_0x6e393e(0x1c3)]!==![],_0x16ec73=_0x32b9a6['doors']!==![],_0x16efc6=_0x32b9a6[_0x6e393e(0x2db)]!==![],_0x3f1336=_0x32b9a6[_0x6e393e(0x1d5)]===!![],_0x4c90fc=_0x32b9a6[_0x6e393e(0x215)]===!![];for(const _0x48f56d in _0x45f3ff){const _0xbd19fc=_0x45f3ff[_0x48f56d];if(_0xbd19fc['type']!=='state'||!_0xbd19fc['common'])continue;if(ADAPTER_BLACKLIST[_0x6e393e(0x31f)](_0xe3495=>_0x48f56d[_0x6e393e(0x259)](_0xe3495))&&!_0x4c90fc)continue;const _0x541844=(_0xbd19fc['common'][_0x6e393e(0x2bb)]||'')[_0x6e393e(0x1b4)]();let _0x4cafc6=(typeof _0xbd19fc['common']['name']===_0x6e393e(0x1e9)?_0xbd19fc[_0x6e393e(0x1e7)][_0x6e393e(0x2ba)]['de']:_0xbd19fc[_0x6e393e(0x1e7)][_0x6e393e(0x2ba)])||_0x48f56d;const _0x2d2f4c=_0x4cafc6[_0x6e393e(0x1b4)]();let _0x3fdd67=![],_0x41f2a3=![];if(_0x14dca3[_0x6e393e(0x1ce)]>0x0){const _0x152b85=_0x439100[_0x48f56d]||[],_0x51f559=_0x48f56d[_0x6e393e(0x31c)]('.')[_0x6e393e(0x243)](0x0,-0x1)[_0x6e393e(0x275)]('.'),_0x27d857=_0x439100[_0x51f559]||[];(_0x152b85[_0x6e393e(0x31f)](_0x2214b7=>_0x14dca3[_0x6e393e(0x2d1)](_0x2214b7))||_0x27d857['some'](_0x3ffef6=>_0x14dca3['includes'](_0x3ffef6)))&&(_0x3fdd67=!![],_0x41f2a3=!![]);}if(!_0x3fdd67&&!_0x4c90fc){if(HARD_IGNORE_TERMS[_0x6e393e(0x31f)](_0x297011=>_0x48f56d[_0x6e393e(0x2d1)](_0x297011)||_0x2d2f4c[_0x6e393e(0x2d1)](_0x297011[_0x6e393e(0x1b4)]())))continue;}if(BAD_NAMES[_0x6e393e(0x31f)](_0x486bca=>_0x2d2f4c===_0x486bca||_0x2d2f4c[_0x6e393e(0x20e)]('.'+_0x486bca))){const _0x461e2b=_0x48f56d[_0x6e393e(0x31c)]('.');if(_0x461e2b[_0x6e393e(0x1ce)]>0x2){const _0x377a5e=_0x461e2b[_0x6e393e(0x243)](0x0,-0x1)[_0x6e393e(0x275)]('.'),_0x1abc4c=_0x45f3ff[_0x377a5e];if(_0x1abc4c&&_0x1abc4c['common']&&_0x1abc4c[_0x6e393e(0x1e7)][_0x6e393e(0x2ba)]){const _0x52c2fd=typeof _0x1abc4c[_0x6e393e(0x1e7)][_0x6e393e(0x2ba)]===_0x6e393e(0x1e9)?_0x1abc4c[_0x6e393e(0x1e7)][_0x6e393e(0x2ba)]['de']:_0x1abc4c[_0x6e393e(0x1e7)][_0x6e393e(0x2ba)];_0x52c2fd&&!_0x4cafc6[_0x6e393e(0x2d1)](_0x52c2fd)&&(_0x4cafc6=_0x52c2fd+'\x20'+_0x4cafc6);}}}let _0x20a588='';if(_0x159c47&&(_0x541844[_0x6e393e(0x2d1)]('motion')||_0x541844[_0x6e393e(0x2d1)](_0x6e393e(0x256))||_0x2d2f4c['includes'](_0x6e393e(0x26a))||_0x2d2f4c[_0x6e393e(0x2d1)](_0x6e393e(0x294))))_0x20a588='motion';else{if(!_0x20a588&&_0x16ec73&&(_0x541844['includes'](_0x6e393e(0x2d4))||_0x541844['includes']('window')||_0x541844[_0x6e393e(0x2d1)](_0x6e393e(0x1b9))||_0x541844[_0x6e393e(0x2d1)](_0x6e393e(0x1ef))||_0x541844[_0x6e393e(0x2d1)]('shutter')||_0x2d2f4c['includes'](_0x6e393e(0x265))||_0x2d2f4c[_0x6e393e(0x2d1)](_0x6e393e(0x25a))||_0x2d2f4c[_0x6e393e(0x2d1)]('rollladen')))_0x20a588='door';else{if(!_0x20a588&&_0x16efc6&&(_0x541844[_0x6e393e(0x2d1)](_0x6e393e(0x23d))||_0x541844[_0x6e393e(0x2d1)](_0x6e393e(0x2a5))||_0x541844[_0x6e393e(0x2d1)]('dimmer')||_0x2d2f4c[_0x6e393e(0x2d1)](_0x6e393e(0x30b))||_0x2d2f4c[_0x6e393e(0x2d1)](_0x6e393e(0x1dc))||_0x2d2f4c[_0x6e393e(0x2d1)](_0x6e393e(0x337)))){if(_0xbd19fc[_0x6e393e(0x1e7)][_0x6e393e(0x1ec)]||_0x541844['includes'](_0x6e393e(0x227)))_0x20a588=_0x6e393e(0x23d);}else{if(!_0x20a588&&_0x3f1336&&(_0x541844['includes'](_0x6e393e(0x1d5))||_0x541844['includes'](_0x6e393e(0x1c7))||_0x541844[_0x6e393e(0x2d1)]('thermostat')||_0x2d2f4c[_0x6e393e(0x2d1)]('temp')||_0x2d2f4c[_0x6e393e(0x2d1)](_0x6e393e(0x26e))||_0x2d2f4c[_0x6e393e(0x2d1)]('heizung')))_0x20a588=_0x6e393e(0x1d5);else{if(!_0x20a588&&_0x41f2a3)_0x20a588=_0x6e393e(0x1b6);}}}}if(_0x20a588){let _0x37a66f=_0x59149a[_0x48f56d]||'';if(!_0x37a66f){let _0x1122f5=_0x48f56d;for(let _0x2a5811=0x0;_0x2a5811<0x3;_0x2a5811++){const _0x4c2788=_0x1122f5[_0x6e393e(0x321)]('.');if(_0x4c2788===-0x1)break;_0x1122f5=_0x1122f5[_0x6e393e(0x21c)](0x0,_0x4c2788);if(_0x59149a[_0x1122f5]){_0x37a66f=_0x59149a[_0x1122f5];break;}}}_0x19d66a[_0x6e393e(0x1b8)]({'id':_0x48f56d,'name':_0x4cafc6,'location':_0x37a66f,'type':_0x20a588,'logDuplicates':_0x20a588===_0x6e393e(0x1c3),'isExit':![],'_score':_0x37a66f?0x50:_0x20a588===_0x6e393e(0x1b6)?0x5a:0x28});}}return _0x19d66a['sort']((_0x1d4265,_0x3eb8cb)=>_0x3eb8cb['_score']-_0x1d4265['_score']),_0x19d66a;}if(require[a0_0x3344a6(0x326)]!==module)module[a0_0x3344a6(0x339)]=_0x223706=>new CogniLiving(_0x223706);else new CogniLiving();