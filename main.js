const a0_0x2a8f54=a0_0x3452;(function(_0x238148,_0xe06976){const _0x2dbeab=a0_0x3452,_0x517067=_0x238148();while(!![]){try{const _0x36ee79=parseInt(_0x2dbeab(0x318))/0x1+parseInt(_0x2dbeab(0x264))/0x2+-parseInt(_0x2dbeab(0x1ce))/0x3*(-parseInt(_0x2dbeab(0x1cf))/0x4)+-parseInt(_0x2dbeab(0x2de))/0x5*(parseInt(_0x2dbeab(0x1bc))/0x6)+-parseInt(_0x2dbeab(0x312))/0x7*(parseInt(_0x2dbeab(0x31d))/0x8)+parseInt(_0x2dbeab(0x25c))/0x9+-parseInt(_0x2dbeab(0x217))/0xa*(parseInt(_0x2dbeab(0x2b9))/0xb);if(_0x36ee79===_0xe06976)break;else _0x517067['push'](_0x517067['shift']());}catch(_0x2a5615){_0x517067['push'](_0x517067['shift']());}}}(a0_0x52c2,0x79a6d));const a0_0xf354df=(function(){let _0x5a57fb=!![];return function(_0x1b88de,_0x26d35c){const _0x102e4e=_0x5a57fb?function(){const _0x2194f5=a0_0x3452;if(_0x26d35c){const _0x41ea0a=_0x26d35c[_0x2194f5(0x2d6)](_0x1b88de,arguments);return _0x26d35c=null,_0x41ea0a;}}:function(){};return _0x5a57fb=![],_0x102e4e;};}()),a0_0x48640f=a0_0xf354df(this,function(){const _0x2f2832=a0_0x3452;return a0_0x48640f[_0x2f2832(0x20e)]()[_0x2f2832(0x2ee)]('(((.+)+)+)+$')[_0x2f2832(0x20e)]()[_0x2f2832(0x2cd)](a0_0x48640f)['search'](_0x2f2832(0x21e));});a0_0x48640f();'use strict';const utils=require(a0_0x2a8f54(0x1e4)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x2a8f54(0x26b)),{spawn,exec}=require(a0_0x2a8f54(0x1ec)),path=require(a0_0x2a8f54(0x1dc)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x2a8f54(0x367),LTM_SCHEDULE=a0_0x2a8f54(0x2e4),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x2a8f54(0x327),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x2a8f54(0x325),LTM_DP_TRIGGER_DIGEST=a0_0x2a8f54(0x2b6),LTM_DP_BASELINE_STATUS=a0_0x2a8f54(0x2ba),LTM_DP_DRIFT_CHANNEL=a0_0x2a8f54(0x20f),LTM_DP_DRIFT_STATUS=a0_0x2a8f54(0x2c0),LTM_DP_DRIFT_DETAILS=a0_0x2a8f54(0x361),LTM_DP_DRIFT_LAST_CHECK=a0_0x2a8f54(0x2e9),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x2a8f54(0x1df),'VACATION':a0_0x2a8f54(0x2fd),'PARTY':'party','GUEST':a0_0x2a8f54(0x305)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x2a8f54(0x32e)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x2a8f54(0x2c2),'senior_aal':a0_0x2a8f54(0x365),'family':a0_0x2a8f54(0x37b),'single_comfort':a0_0x2a8f54(0x1fe),'security':'PRIORITÃ„T:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process['platform']===a0_0x2a8f54(0x2b3),PERSISTENT_DIR=path[a0_0x2a8f54(0x364)](__dirname,a0_0x2a8f54(0x1ed)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x2a8f54(0x357),a0_0x2a8f54(0x221)):path[a0_0x2a8f54(0x364)](VENV_PATH,a0_0x2a8f54(0x1e0),'python'),PIP_EXE=IS_WIN?path[a0_0x2a8f54(0x364)](VENV_PATH,a0_0x2a8f54(0x357),a0_0x2a8f54(0x240)):path[a0_0x2a8f54(0x364)](VENV_PATH,'bin',a0_0x2a8f54(0x2c6));let activeSequence=[],sequenceTimer=null;async function startSystem(_0x412205){const _0x50f035=a0_0x2a8f54;_0x412205['log'][_0x50f035(0x2c5)]('ðŸš€\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.0)...'),await initZombies(_0x412205);try{_0x412205[_0x50f035(0x20c)]=await checkLicense(_0x412205[_0x50f035(0x1e1)][_0x50f035(0x269)]);}catch(_0x5e4be9){}if(!_0x412205[_0x50f035(0x1e1)][_0x50f035(0x301)]||_0x412205['config']['inactivityThresholdHours']<0.1)_0x412205[_0x50f035(0x1e1)][_0x50f035(0x301)]=0xc;await initHistory(_0x412205),await initSystemConfig(_0x412205);if(_0x412205[_0x50f035(0x1e1)][_0x50f035(0x2d9)])try{_0x412205['genAI']=new GoogleGenerativeAI(_0x412205[_0x50f035(0x1e1)][_0x50f035(0x2d9)]),_0x412205[_0x50f035(0x260)]=_0x412205[_0x50f035(0x375)][_0x50f035(0x27b)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x50f035(0x283)}}),_0x412205[_0x50f035(0x2a4)]['info'](_0x50f035(0x215));}catch(_0x5b4996){_0x412205[_0x50f035(0x2a4)]['error'](_0x50f035(0x1d6)+_0x5b4996[_0x50f035(0x30b)]);}await createAllObjects(_0x412205),await loadSystemMode(_0x412205),await loadRawEventLog(_0x412205),await loadDailyDigests(_0x412205),_0x412205[_0x50f035(0x1d7)](_0x50f035(0x2a7)),_0x412205[_0x50f035(0x1d7)](LTM_DP_TRIGGER_DIGEST),_0x412205[_0x50f035(0x1d7)](_0x50f035(0x36c)),_0x412205['subscribeStates'](_0x50f035(0x23a)),_0x412205[_0x50f035(0x1d7)](_0x50f035(0x1fa)),_0x412205['subscribeStates'](_0x50f035(0x347)),_0x412205[_0x50f035(0x1d7)](_0x50f035(0x1d5)),_0x412205[_0x50f035(0x1d7)](_0x50f035(0x1cd)),_0x412205[_0x50f035(0x1d7)](_0x50f035(0x352)),_0x412205[_0x50f035(0x1d7)](_0x50f035(0x1f8)),_0x412205[_0x50f035(0x1d7)](_0x50f035(0x36d)),await initSensorSubscriptions(_0x412205),await initPresenceSubscriptions(_0x412205),await setupTelegramListener(_0x412205),setTimeout(()=>checkWifiPresence(_0x412205),0x1388);if(_0x412205['analysisTimer'])clearInterval(_0x412205[_0x50f035(0x2ac)]);const _0x1ec1b6=_0x412205[_0x50f035(0x1e1)][_0x50f035(0x28b)]||0xf;_0x1ec1b6>0x0&&(_0x412205[_0x50f035(0x2ac)]=setInterval(()=>{runAutopilot(_0x412205);},_0x1ec1b6*0x3c*0x3e8)),setupLtmScheduler(_0x412205),setupModeResetScheduler(_0x412205),setupDriftAnalysisScheduler(_0x412205),setupBriefingScheduler(_0x412205),startPythonService(_0x412205),setTimeout(()=>{const _0x5e15b8=_0x50f035;_0x412205[_0x5e15b8(0x21c)]&&(runPythonHealthCheck(_0x412205),triggerGaitAnalysis(_0x412205),triggerEnergyPrediction(_0x412205)),updateHealthVector(_0x412205);},0x1388);}async function runAutopilot(_0x4f56df){const _0x1e00a4=a0_0x2a8f54;_0x4f56df['log']['debug'](_0x1e00a4(0x1cb)),await runGeminiAnalysis(_0x4f56df),updateHealthVector(_0x4f56df),triggerGaitAnalysis(_0x4f56df),triggerEnergyPrediction(_0x4f56df);}async function triggerGaitAnalysis(_0x37d2ca){const _0x5f12df=a0_0x2a8f54;if(!_0x37d2ca['isProVersion'])return;try{const _0x2f2d43=await _0x37d2ca[_0x5f12df(0x1c4)](_0x5f12df(0x295));_0x2f2d43&&_0x2f2d43[_0x5f12df(0x22d)]&&sendToPython(_0x37d2ca,_0x5f12df(0x2e6),{'sequences':JSON[_0x5f12df(0x321)](_0x2f2d43[_0x5f12df(0x22d)])});}catch(_0x4b273b){}}async function triggerEnergyPrediction(_0x10a79e){const _0x307265=a0_0x2a8f54;if(!_0x10a79e[_0x307265(0x20c)])return;try{const _0x421fdd=await getOutsideTemperatureNumeric(_0x10a79e);if(_0x421fdd===null)return;const _0x110ab3={},_0x2ae444=_0x10a79e[_0x307265(0x1e1)][_0x307265(0x224)]||[];for(const _0x743462 of _0x2ae444){if(_0x743462['type']===_0x307265(0x1dd)&&_0x743462[_0x307265(0x206)]){const _0x3a83de=_0x10a79e[_0x307265(0x1c8)][_0x743462['id']];if(_0x3a83de!==undefined)_0x110ab3[_0x743462[_0x307265(0x206)]]=_0x3a83de;}}Object[_0x307265(0x1e3)](_0x110ab3)[_0x307265(0x24a)]>0x0&&sendToPython(_0x10a79e,_0x307265(0x214),{'current_temps':_0x110ab3,'t_out':_0x421fdd});}catch(_0x5b6a74){}}function updateHealthVector(_0x2cf4fa){const _0x2b6963=a0_0x2a8f54;if(!_0x2cf4fa[_0x2b6963(0x35e)]||_0x2cf4fa['rawEventLog'][_0x2b6963(0x24a)]===0x0)return;const _0x53da0b=new Array(0x60)[_0x2b6963(0x227)](0x0),_0x4286f4=new Date()[_0x2b6963(0x20d)](0x0,0x0,0x0,0x0);_0x2cf4fa[_0x2b6963(0x35e)][_0x2b6963(0x35b)](_0x7a8638=>{const _0x22aa6e=_0x2b6963,_0x2f7722=new Date(_0x7a8638['timestamp']);if(_0x2f7722[_0x22aa6e(0x2a6)]()>=_0x4286f4){const _0x349420=_0x2f7722[_0x22aa6e(0x20b)](),_0x4bdd1f=_0x2f7722[_0x22aa6e(0x1bb)](),_0x2ad7d8=_0x349420*0x4+Math[_0x22aa6e(0x1e7)](_0x4bdd1f/0xf);if(_0x2ad7d8>=0x0&&_0x2ad7d8<0x60)_0x53da0b[_0x2ad7d8]++;}}),_0x2cf4fa[_0x2b6963(0x282)]('analysis.health.todayVector',{'val':JSON[_0x2b6963(0x1f7)](_0x53da0b),'ack':!![]});}async function scanForDevices(_0x3db713,_0xb366eb){const _0x45065c=a0_0x2a8f54;_0x3db713[_0x45065c(0x2a4)]['info'](_0x45065c(0x1f1));const _0x121994=[],_0x31a1d3=await _0x3db713[_0x45065c(0x1e5)]('*');for(const _0x1a6d19 in _0x31a1d3){const _0x5a8f9e=_0x31a1d3[_0x1a6d19];if(_0x5a8f9e&&_0x5a8f9e[_0x45065c(0x2aa)]&&_0x5a8f9e[_0x45065c(0x2bd)]==='state'){const _0x25fc09=(_0x5a8f9e[_0x45065c(0x2aa)][_0x45065c(0x27f)]&&typeof _0x5a8f9e['common']['name']===_0x45065c(0x2f9)?_0x5a8f9e[_0x45065c(0x2aa)]['name']['de']:_0x5a8f9e[_0x45065c(0x2aa)][_0x45065c(0x27f)])||'',_0xbe341d=_0x5a8f9e[_0x45065c(0x2aa)][_0x45065c(0x20a)]||'';let _0x28d460=null;if(_0xb366eb['motion']&&(_0xbe341d[_0x45065c(0x2a1)](_0x45065c(0x297))||_0x25fc09[_0x45065c(0x2c7)]()[_0x45065c(0x2a1)](_0x45065c(0x33c))))_0x28d460=_0x45065c(0x297);else{if(_0xb366eb[_0x45065c(0x1d9)]&&(_0xbe341d[_0x45065c(0x2a1)](_0x45065c(0x377))||_0xbe341d['includes'](_0x45065c(0x2cf))||_0x25fc09[_0x45065c(0x2c7)]()[_0x45065c(0x2a1)]('tÃ¼r')||_0x25fc09[_0x45065c(0x2c7)]()[_0x45065c(0x2a1)](_0x45065c(0x27c))))_0x28d460=_0x45065c(0x377);else{if(_0xb366eb['lights']&&(_0xbe341d[_0x45065c(0x2a1)](_0x45065c(0x25d))||_0xbe341d[_0x45065c(0x2a1)](_0x45065c(0x228))||_0x25fc09['toLowerCase']()[_0x45065c(0x2a1)](_0x45065c(0x21f))))_0x28d460='light';else{if(_0xb366eb['temperature']&&(_0xbe341d[_0x45065c(0x2a1)](_0x45065c(0x1dd))||_0x25fc09['toLowerCase']()[_0x45065c(0x2a1)](_0x45065c(0x1d4))))_0x28d460=_0x45065c(0x1dd);}}}if(_0x28d460){let _0x593604='';const _0x5293d1=_0x1a6d19[_0x45065c(0x1be)]('.');if(_0x5293d1['length']>0x2)_0x593604=_0x5293d1[0x2];_0x121994['push']({'id':_0x1a6d19,'name':_0x25fc09||_0x1a6d19,'type':_0x28d460,'location':_0x593604,'_score':0x32});}}}return _0x121994;}async function getWeatherContext(_0x5f1094){const _0x3c56b7=a0_0x2a8f54;if(!_0x5f1094['config'][_0x3c56b7(0x2db)]||!_0x5f1094[_0x3c56b7(0x1e1)][_0x3c56b7(0x279)])return _0x3c56b7(0x1bf);try{const _0x46d255=_0x5f1094[_0x3c56b7(0x1e1)][_0x3c56b7(0x279)];let _0x439e0c=await _0x5f1094['getForeignStateAsync'](_0x46d255+_0x3c56b7(0x2cc));if(!_0x439e0c)_0x439e0c=await _0x5f1094[_0x3c56b7(0x36a)](_0x46d255+_0x3c56b7(0x32a));let _0x520b86=await _0x5f1094[_0x3c56b7(0x36a)](_0x46d255+_0x3c56b7(0x257));if(!_0x520b86)_0x520b86=await _0x5f1094[_0x3c56b7(0x36a)](_0x46d255+'.forecast.current.state');if(_0x439e0c&&_0x520b86)return _0x439e0c[_0x3c56b7(0x22d)]+_0x3c56b7(0x1ca)+_0x520b86['val'];}catch(_0x1b17ac){}return _0x3c56b7(0x1eb);}async function getCalendarContext(_0xf7ea83){const _0xc570b6=a0_0x2a8f54;if(!_0xf7ea83[_0xc570b6(0x1e1)][_0xc570b6(0x2da)]||!_0xf7ea83[_0xc570b6(0x1e1)][_0xc570b6(0x239)])return _0xc570b6(0x1bd);return _0xc570b6(0x1c5);}async function getCalendarNames(_0x2f034e,_0x311153){return[];}async function saveFeedback(_0x360f05,_0x776535){const _0x29dbe6=a0_0x2a8f54;_0x360f05['log'][_0x29dbe6(0x2c5)]('ðŸ“\x20Feedback\x20received:\x20'+_0x776535[_0x29dbe6(0x204)]);}async function sendMorningBriefing(_0x33f67a){const _0x122806=a0_0x2a8f54;if(!_0x33f67a[_0x122806(0x260)])return;try{const _0x434a44=_0x122806(0x24c),_0x2e322c=await _0x33f67a[_0x122806(0x260)][_0x122806(0x28d)](_0x434a44),_0x208af5=_0x2e322c[_0x122806(0x31b)][_0x122806(0x22a)]();sendNotification(_0x33f67a,'ðŸŒ…\x20Morning\x20Briefing:\x0a'+_0x208af5);}catch(_0x35adc8){_0x33f67a[_0x122806(0x2a4)][_0x122806(0x32b)]('Briefing\x20Error:\x20'+_0x35adc8[_0x122806(0x30b)]);}}function checkAndInstall(_0x690121){const _0x3cd3ce=a0_0x2a8f54;if(!fs['existsSync'](VENV_PATH)||!fs['existsSync'](PIP_EXE))return _0x690121[_0x3cd3ce(0x2a4)][_0x3cd3ce(0x298)]('âš ï¸\x20Python\x20VENV\x20missing.\x20Installing\x20locally...'),installPythonDependencies(_0x690121),![];return!![];}function installPythonDependencies(_0x13b3b4){const _0x3e3855=a0_0x2a8f54;if(_0x13b3b4[_0x3e3855(0x28e)])return;_0x13b3b4[_0x3e3855(0x28e)]=!![];const _0x334a8e=path[_0x3e3855(0x364)](__dirname,_0x3e3855(0x1db),_0x3e3855(0x2c9));stopPythonService(_0x13b3b4);if(fs[_0x3e3855(0x306)](VENV_PATH))try{fs[_0x3e3855(0x22e)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x1509be){}exec(_0x3e3855(0x255)+VENV_PATH+'\x22',_0x425579=>{const _0x19c5fd=_0x3e3855;if(_0x425579){_0x13b3b4[_0x19c5fd(0x2a4)][_0x19c5fd(0x32b)]('âŒ\x20VENV\x20FAILED:\x20'+_0x425579[_0x19c5fd(0x30b)]),_0x13b3b4[_0x19c5fd(0x28e)]=![];return;}installRequirementsInVenv(_0x13b3b4,_0x334a8e);});}function installRequirementsInVenv(_0x221743,_0x4e79d7){const _0x1253d7=a0_0x2a8f54;_0x221743['log']['info'](_0x1253d7(0x2ef));const _0x2d0761='\x22'+PIP_EXE+_0x1253d7(0x23f)+_0x4e79d7+'\x22';exec(_0x2d0761,{'timeout':0x124f80},(_0x69498,_0x17500f,_0x3548ab)=>{const _0x12ac0a=_0x1253d7;_0x221743[_0x12ac0a(0x28e)]=![],_0x69498?_0x221743[_0x12ac0a(0x2a4)][_0x12ac0a(0x32b)](_0x12ac0a(0x2ab)+(_0x3548ab||_0x69498[_0x12ac0a(0x30b)])):(_0x221743[_0x12ac0a(0x2a4)][_0x12ac0a(0x2c5)](_0x12ac0a(0x349)),startSystem(_0x221743));});}function a0_0x3452(_0x4f9dcd,_0x5c5101){const _0x1c214c=a0_0x52c2();return a0_0x3452=function(_0x48640f,_0xf354df){_0x48640f=_0x48640f-0x1ba;let _0x52c2c2=_0x1c214c[_0x48640f];return _0x52c2c2;},a0_0x3452(_0x4f9dcd,_0x5c5101);}async function initZombies(_0x590326){const _0x210cd4=a0_0x2a8f54;try{const _0x2b18fe=[_0x210cd4(0x241),'events.history_debug_00'];for(const _0xc0387d of _0x2b18fe){try{const _0x5eeebe=await _0x590326[_0x210cd4(0x2a2)](_0xc0387d);if(_0x5eeebe)await _0x590326[_0x210cd4(0x351)](_0xc0387d);}catch(_0x1f1f71){}}}catch(_0x73f419){}}async function checkLicense(_0x5a730d){return!![];}function a0_0x52c2(){const _0x178dce=['heating','Today\x20Vector\x20(15m)','776482kpCluB','eventHistory','baselineDrift','response','contact','24ahBwTs','analysis.energy','BUTLER\x20Execution\x20Error:\x20','Train\x20Energy','parse','confidence','analysis.security.lastCheck','Err:\x20','LTM.processingStatus','onReady','LTM.rawEventLog','weatherunderground','version','.forecast.current.temperature','error','payload','analysis.health.isAnomaly','PARTY','Trend','system.presenceWho','Unknown','.\x20EMERGENCY:\x20','analysis.training','COGNI_CONFIRM_OK','sendToAsync','Detected\x20Patterns','ltmDriftCheckIntervalHours','setForeignStateAsync','date','[PYTHON]\x20','Kein\x20API\x20Key!','bewegung','briefingJob','analysis.health.trendDiagnosis','ANALYZE_HEALTH','Trigger\x20Briefing','analysis.security.lastScore','ðŸ•¸ï¸\x20Topology\x20Map\x20updated.','getMonth','details','cancel','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','analysis.automation.autoApply','simulateButler','âœ…\x20INSTALL\x20SUCCESS.','some','latitude','occupancy','TRAINING_COMPLETE','trim','send','analysis.automation.patternDetected','delObjectAsync','analysis.training.triggerEnergy','User\x20dismissed\x20automation\x20proposal.','Reset\x20Sched\x20Error:\x20','âœ…\x20HEALTH\x20TRAINED.','unload','Scripts','Auto\x20Apply','change_percent','getDate','forEach','TRAIN_ENERGY','BUILD_TOPOLOGY','rawEventLog','extendObjectAsync','LTM\x20Sched\x20Error:\x20','LTM.driftAnalysis.driftDetails','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','analysis.security.topologyMatrix','join','PRIORITÃ„T:\x20Gesundheit/AAL.','automation.triggerAction','models/gemini-flash-latest','analysis.health.lastCheck','ðŸ§ \x20Triggering\x20Security\x20Training...','getForeignStateAsync','analysis.health.trendValue','system.mode','analysis.training.triggerTopology','stdout','indexOf','json','analysis.security','\x0aGrund:\x20','Heating\x20Score','button','genAI','system.isPresent','door','âš ï¸\x20ALARM:\x20','analysis.alertReason','TRAIN_COMFORT','Fokus\x20auf\x20Familienroutinen.','indicator.alarm','triggerBriefing','getMinutes','264WIBkWy','Kalender\x20deaktiviert.','split','Wetterdaten\x20deaktiviert.','unshift','analysis.automation.detectedPatterns','Train\x20Comfort','setObjectNotExistsAsync','getStateAsync','Keine\x20Termine.','Event\x20History','isExit','sensorLastValues','Pattern\x20Detected','Â°C,\x20','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','longitude','analysis.training.triggerHealth','93nOFHsR','28068KqSJGC','outdoorSensorId','ANOMALY','isAlert','livingContext','temperatur','analysis.training.triggerSecurity','Gemini\x20Init\x20Error:\x20','subscribeStates','Started...','doors','Cogni-Living','python_service','path','temperature','dimmer','normal','bin','config','testContext','keys','@iobroker/adapter-core','getForeignObjectsAsync','Last\x20Check','floor','Raw\x20Log','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','description','Keine\x20Wetterdaten\x20verfÃ¼gbar.','child_process','.venv','ENERGY_PREDICT_RESULT','notifyPushoverEnabled','08:00','ðŸ”\x20Scanning\x20for\x20devices...','Target\x20ID','text.alarm','telegram','ENERGY_TRAIN_RESULT','generic','stringify','analysis.training.triggerComfort','analysis.activitySummary','analysis.automation.triggerAction','onUnload','\x20->\x20','GAIT_RESULT','Fokus\x20auf\x20Komfort.','state','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','sendTo','close','cogni-living','rating','splice','location','status','TOPOLOGY_RESULT','\x20*\x20*\x20*','role','getHours','isProVersion','setHours','toString','LTM.driftAnalysis','channel','Activity\x20Summary','substring','bind','PREDICT_ENERGY','Gemini\x20AI\x20initialized.','value','27760bqUMSW','scheduleJob','write','.NextHours.Location_1.Day_1.current.temp_value','analysis.energy.heatingScore','pythonProcess','exitGraceTimer','(((.+)+)+)+$','licht','instance','python.exe','ack','stdin','devices','activityLevel','\x0aSTB:\x20','fill','switch','Success','text','Keine\x20Details.','analysis.security.currentThreshold','val','rmSync','startsWith',')\x20-\x20SAFE\x20BOOT','COGNI_REQUEST_CALL','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','replace','push','threshold','System\x20Mode','setState','cogni-living\x20adapter\x20starting\x20(v','calendarInstance','analysis.triggerBriefing','ðŸ\x20Python\x20Pong','currentSystemMode','Daily\x20Digests','.\x20SYSTEM_MODE:\x20','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','pip.exe','analysis.history_debug_00','HEALTH_RESULT','python3','Gait\x20Speed\x20Trend','Current\x20Threshold','summary','onMessage','callback','ltmJob','length','Deaktiviert\x20(Pro-Feature)','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','reason','Drift\x20Sched\x20Error:\x20','expire','toFixed','number','kontakt','round','enum.functions.*','python3\x20-m\x20venv\x20\x22','analysis.health','.Current.WeatherText','analysis.analysisHistory','exitTimer','AI\x20Training','onStateChange','3272715JcMHsY','light','city','string','geminiModel','analysis.isAlert','Briefing\x20Sched\x20Error:\x20','Digest','1984228nMetOh','No\x20instance','stateChange','driftAnalysisTimer','aiPersona','licenseKey','testApiKey','node-schedule','Restoring\x20sensor\x20cache...','insulation','Success:\x20','briefingEnabled','Last\x20raw\x20event','ltmStbWindowDays','notifyEmailEnabled','lampe','Trigger\x20Analysis','dismissAutomation','Missing\x20data','Gemini\x20Error:\x20','Skipped\x20(No\x20AI\x20or\x20Data)','weatherInstance','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','getGenerativeModel','fenster','debug','TREND_RESULT','name','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','Sequences','setStateAsync','application/json','toISOString','system','presenceDevices','VACATION','autoApply','ltmLtbWindowDays','analysis.health.todayVector','analysisInterval','Regel\x20erkannt:\x20','generateContent','dependencyInstallInProgress','map','minDaysForBaseline','modeResetJob','Adapter','COMFORT_RESULT','LTM','LTM.trainingData.sequences','Target\x20Value','motion','warn','endsWith','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','notifyTelegramEnabled','analysis.automation.targetValue','kill','command','notifyTelegramRecipient','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','includes','getObjectAsync','SECURITY_RESULT','log','TRAIN_HEALTH','getTime','analysis.trigger','heizung','analysis.automation.targetId','common','âŒ\x20INSTALL\x20FAILED:\x20','analysisTimer','\x20Tage)','unknown','subscribeForeignStatesAsync','.\x20KONTEXT:\x20','systemConfig','alertReason','win32','namespace','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','LTM.triggerDailyDigest','driftDetails','analysis.training.status','3861JovebK','LTM.baselineStatus','Topology\x20Error:\x20','success','type','\x20new\x20patterns.','schalter','LTM.driftAnalysis.baselineDrift','Error\x20launching\x20Python:\x20','Analysiere\x20ausgewogen.','indicator','notifyEmailRecipient','info','pip','toLowerCase','getLtmData','requirements.txt','pop','Temperature\x20Forecast','.Current.Temperature','constructor','Build\x20Topology','window','slice','analysis.automation.description','lastAlertState','shift','\x20=\x20','Anomaly\x20Score','apply','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','Activity-Level','geminiApiKey','useCalendar','useWeather','events.history','targetId','27920MpjvYG','Failed:\x20','NORMAL','detected','getFullYear','enum','0\x203\x20*\x20*\x20*','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','ANALYZE_GAIT','HEALTH_TRAIN_RESULT','getForeignObjectAsync','LTM.driftAnalysis.lastCheck','isPresent','filter','toLocaleTimeString','timestamp','search','Installing\x20pip\x20packages...','N/A','Anomaly\x20Detected','systemUUID','from','analysis.energy.insulationScore','OK:\x20','Aktiv\x20(','automationProposal','isGracePeriodActive','object','Who\x20is\x20present?','notifyPushoverRecipient','now','vacation','Unbekannt','service.py','dailyDigests','inactivityThresholdHours','LTM.trainingData.thermodynamics','values','Sec-Training\x20started...','guest','existsSync','ANALYZE_SEQUENCE','[RESULT]','Kein\x20API\x20Key.','loc','message','events.lastEvent','siren','analysis.energy.forecast','analysis.health.gaitSpeed','PONG','analysisHistory','1473269SvYJda','prÃ¤senz','boolean','find'];a0_0x52c2=function(){return _0x178dce;};return a0_0x52c2();}async function initHistory(_0x59873d){const _0x24f9a3=a0_0x2a8f54;try{const _0xeb905e=await _0x59873d['getStateAsync'](_0x24f9a3(0x2dc));_0xeb905e&&_0xeb905e[_0x24f9a3(0x22d)]&&(_0x59873d[_0x24f9a3(0x319)]=JSON[_0x24f9a3(0x321)](_0xeb905e['val'][_0x24f9a3(0x20e)]()));}catch(_0x540153){_0x59873d['eventHistory']=[];}try{const _0x88f528=await _0x59873d['getStateAsync']('analysis.analysisHistory');if(_0x88f528&&_0x88f528[_0x24f9a3(0x22d)])_0x59873d['analysisHistory']=JSON[_0x24f9a3(0x321)](_0x88f528[_0x24f9a3(0x22d)][_0x24f9a3(0x20e)]());}catch(_0xe64e66){_0x59873d[_0x24f9a3(0x311)]=[];}if(_0x59873d[_0x24f9a3(0x319)]&&_0x59873d[_0x24f9a3(0x319)]['length']>0x0){_0x59873d[_0x24f9a3(0x2a4)][_0x24f9a3(0x2c5)](_0x24f9a3(0x26c));for(let _0x535800=_0x59873d[_0x24f9a3(0x319)]['length']-0x1;_0x535800>=0x0;_0x535800--){const _0x310e4e=_0x59873d[_0x24f9a3(0x319)][_0x535800];if(_0x310e4e&&_0x310e4e['id']!==undefined&&_0x310e4e[_0x24f9a3(0x216)]!==undefined)_0x59873d[_0x24f9a3(0x1c8)][_0x310e4e['id']]=_0x310e4e['value'];}}}async function initSystemConfig(_0x3aa324){const _0xcd728f=a0_0x2a8f54;try{const _0x2aa058=await _0x3aa324[_0xcd728f(0x2e8)]('system.config');if(_0x2aa058&&_0x2aa058[_0xcd728f(0x2aa)])_0x3aa324['systemConfig']={'latitude':_0x2aa058[_0xcd728f(0x2aa)][_0xcd728f(0x34b)]||0x0,'longitude':_0x2aa058['common'][_0xcd728f(0x1cc)]||0x0,'city':_0x2aa058[_0xcd728f(0x2aa)][_0xcd728f(0x25e)]||''};}catch(_0xde5a46){}}async function createAllObjects(_0x308dc6){const _0x78fc0d=a0_0x2a8f54;await _0x308dc6['extendObjectAsync'](_0x78fc0d(0x285),{'type':_0x78fc0d(0x210),'common':{'name':'System'},'native':{}}),await _0x308dc6['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x236),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x1ff),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x78fc0d(0x2e0)]},'native':{}}),await _0x308dc6['setObjectNotExistsAsync'](_0x78fc0d(0x330),{'type':'state','common':{'name':_0x78fc0d(0x2fa),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)]('events.lastEvent',{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x270),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x370),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)]('events.history',{'type':'state','common':{'name':_0x78fc0d(0x1c6),'type':_0x78fc0d(0x25f),'role':'json','read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x35f)](_0x78fc0d(0x333),{'type':_0x78fc0d(0x210),'common':{'name':_0x78fc0d(0x25a)},'native':{}}),await _0x308dc6['setObjectNotExistsAsync'](_0x78fc0d(0x1d5),{'type':'state','common':{'name':'Train\x20Security','type':'boolean','role':_0x78fc0d(0x374),'read':!![],'write':!![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)]('analysis.training.triggerHealth',{'type':_0x78fc0d(0x1ff),'common':{'name':'Train\x20Health','type':_0x78fc0d(0x314),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x308dc6['setObjectNotExistsAsync']('analysis.training.triggerEnergy',{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x320),'type':'boolean','role':_0x78fc0d(0x374),'read':!![],'write':!![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x1f8),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x1c2),'type':_0x78fc0d(0x314),'role':_0x78fc0d(0x374),'read':!![],'write':!![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x36d),{'type':'state','common':{'name':_0x78fc0d(0x2ce),'type':_0x78fc0d(0x314),'role':_0x78fc0d(0x374),'read':!![],'write':!![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)]('analysis.training.status',{'type':_0x78fc0d(0x1ff),'common':{'name':'Training\x20Status','type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x22a),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x35f)](_0x78fc0d(0x371),{'type':_0x78fc0d(0x210),'common':{'name':'Security\x20Monitor'},'native':{}}),await _0x308dc6['setObjectNotExistsAsync'](_0x78fc0d(0x341),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x2d5),'type':_0x78fc0d(0x251),'role':_0x78fc0d(0x216),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x22c),{'type':'state','common':{'name':_0x78fc0d(0x245),'type':_0x78fc0d(0x251),'role':_0x78fc0d(0x216),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x308dc6['setObjectNotExistsAsync'](_0x78fc0d(0x323),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x1e6),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x339),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x363),{'type':_0x78fc0d(0x1ff),'common':{'name':'Topology\x20Matrix','type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x370),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x35f)](_0x78fc0d(0x256),{'type':_0x78fc0d(0x210),'common':{'name':'Health\x20Analysis'},'native':{}}),await _0x308dc6['setObjectNotExistsAsync'](_0x78fc0d(0x368),{'type':'state','common':{'name':_0x78fc0d(0x1e6),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x339),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x32d),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x2f1),'type':'boolean','role':_0x78fc0d(0x2c3),'read':!![],'write':![]},'native':{}}),await _0x308dc6['setObjectNotExistsAsync'](_0x78fc0d(0x33e),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x32f),'type':'string','role':_0x78fc0d(0x22a),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x36b),{'type':_0x78fc0d(0x1ff),'common':{'name':'Trend\x20Value','type':_0x78fc0d(0x251),'role':'value','read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x28a),{'type':'state','common':{'name':_0x78fc0d(0x317),'type':'string','role':_0x78fc0d(0x370),'read':!![],'write':![]},'native':{}}),await _0x308dc6['setObjectNotExistsAsync'](_0x78fc0d(0x30f),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x244),'type':_0x78fc0d(0x251),'role':_0x78fc0d(0x216),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x35f)](_0x78fc0d(0x31e),{'type':_0x78fc0d(0x210),'common':{'name':'Energy\x20Intelligence'},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x2f4),{'type':_0x78fc0d(0x1ff),'common':{'name':'Insulation\x20Score','type':_0x78fc0d(0x25f),'role':'text','read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x21b),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x373),'type':_0x78fc0d(0x25f),'role':'text','read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)]('analysis.energy.forecast',{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x2cb),'type':_0x78fc0d(0x25f),'role':'json','read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x35f)](_0x78fc0d(0x294),{'type':'channel','common':{'name':_0x78fc0d(0x294)},'native':{}}),await _0x308dc6[_0x78fc0d(0x35f)](LTM_DP_RAW_LOG,{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x1e8),'type':'string','role':_0x78fc0d(0x370),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x35f)](LTM_DP_DAILY_DIGESTS,{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x23d),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x370),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)]('LTM.trainingData.sequences',{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x281),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x370),'read':!![],'write':![]},'native':{}}),await _0x308dc6['setObjectNotExistsAsync'](_0x78fc0d(0x302),{'type':'state','common':{'name':'Thermodynamics','type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x370),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x2a7),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x274),'type':'boolean','role':_0x78fc0d(0x374),'read':!![],'write':!![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x23a),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x340),'type':_0x78fc0d(0x314),'role':_0x78fc0d(0x374),'read':!![],'write':!![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x261),{'type':_0x78fc0d(0x1ff),'common':{'name':'Alert\x20Status','type':_0x78fc0d(0x314),'role':_0x78fc0d(0x37c),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x379),{'type':'state','common':{'name':'Alert\x20Reason','type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x1f3),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x1f9),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x211),'type':_0x78fc0d(0x25f),'role':'text','read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)]('analysis.automation.patternDetected',{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x1c9),'type':_0x78fc0d(0x314),'role':_0x78fc0d(0x2c3),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x2d1),{'type':'state','common':{'name':'Description','type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x22a),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x1c1),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x336),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x370),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x2a9),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x1f2),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x22a),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x29c),{'type':'state','common':{'name':_0x78fc0d(0x296),'type':_0x78fc0d(0x25f),'role':_0x78fc0d(0x22a),'read':!![],'write':![]},'native':{}}),await _0x308dc6[_0x78fc0d(0x1c3)](_0x78fc0d(0x347),{'type':_0x78fc0d(0x1ff),'common':{'name':_0x78fc0d(0x358),'type':_0x78fc0d(0x314),'role':'switch','read':!![],'write':!![]},'native':{}}),await _0x308dc6['setObjectNotExistsAsync']('analysis.automation.triggerAction',{'type':_0x78fc0d(0x1ff),'common':{'name':'Trigger\x20Action','type':_0x78fc0d(0x314),'role':_0x78fc0d(0x374),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x2ee7b9){const _0x585eff=a0_0x2a8f54;try{const _0x4ea87d=await _0x2ee7b9[_0x585eff(0x1c4)](SYSTEM_DP_MODE);_0x4ea87d&&_0x4ea87d['val']&&Object[_0x585eff(0x303)](SYSTEM_MODES)['includes'](_0x4ea87d[_0x585eff(0x22d)])?_0x2ee7b9[_0x585eff(0x23c)]=_0x4ea87d[_0x585eff(0x22d)]:(_0x2ee7b9[_0x585eff(0x23c)]=SYSTEM_MODES[_0x585eff(0x2e0)],await _0x2ee7b9['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x585eff(0x2e0)],'ack':!![]}));}catch(_0x434805){_0x2ee7b9[_0x585eff(0x23c)]=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x4417a8){const _0x3672da=a0_0x2a8f54;try{const _0x325865=await _0x4417a8[_0x3672da(0x1c4)](LTM_DP_RAW_LOG);if(_0x325865&&_0x325865['val'])_0x4417a8['rawEventLog']=JSON[_0x3672da(0x321)](_0x325865[_0x3672da(0x22d)]);}catch(_0x3df8e4){_0x4417a8[_0x3672da(0x35e)]=[];}}async function saveRawEventLog(_0x41c1a7){const _0x5783e2=a0_0x2a8f54;if(_0x41c1a7[_0x5783e2(0x35e)]['length']>RAW_LOG_MAX_SIZE)_0x41c1a7[_0x5783e2(0x35e)][_0x5783e2(0x205)](0x0,_0x41c1a7[_0x5783e2(0x35e)][_0x5783e2(0x24a)]-RAW_LOG_MAX_SIZE);await _0x41c1a7[_0x5783e2(0x282)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x41c1a7['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x3086d7){const _0x2635a7=a0_0x2a8f54;try{const _0x30e938=await _0x3086d7[_0x2635a7(0x1c4)](LTM_DP_DAILY_DIGESTS);if(_0x30e938&&_0x30e938[_0x2635a7(0x22d)])_0x3086d7[_0x2635a7(0x300)]=JSON[_0x2635a7(0x321)](_0x30e938[_0x2635a7(0x22d)]);}catch(_0x1a62e9){_0x3086d7[_0x2635a7(0x300)]=[];}await updateBaselineStatus(_0x3086d7);}async function saveDailyDigests(_0x433f48,_0x41b6a8=!![]){const _0x393739=a0_0x2a8f54,_0x30bf8c=_0x433f48[_0x393739(0x1e1)][_0x393739(0x289)]||0x3c;_0x433f48[_0x393739(0x300)][_0x393739(0x24a)]>_0x30bf8c&&_0x433f48[_0x393739(0x300)][_0x393739(0x205)](0x0,_0x433f48[_0x393739(0x300)][_0x393739(0x24a)]-_0x30bf8c);await _0x433f48[_0x393739(0x282)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x393739(0x1f7)](_0x433f48[_0x393739(0x300)]),'ack':!![]});if(_0x41b6a8)await updateBaselineStatus(_0x433f48);}async function updateAnalysisHistory(_0x1a9860,_0x1f6174){const _0x5f4166=a0_0x2a8f54;_0x1a9860[_0x5f4166(0x311)][_0x5f4166(0x1c0)](_0x1f6174);if(_0x1a9860['analysisHistory']['length']>HISTORY_MAX_SIZE)_0x1a9860[_0x5f4166(0x311)][_0x5f4166(0x2ca)]();await _0x1a9860[_0x5f4166(0x282)](_0x5f4166(0x258),{'val':JSON[_0x5f4166(0x1f7)](_0x1a9860[_0x5f4166(0x311)]),'ack':!![]});}async function updateBaselineStatus(_0xc4029e){const _0x490797=a0_0x2a8f54;if(!_0xc4029e[_0x490797(0x20c)]){await _0xc4029e[_0x490797(0x282)](LTM_DP_BASELINE_STATUS,{'val':_0x490797(0x24b),'ack':!![]});return;}const _0x118892=_0xc4029e[_0x490797(0x300)][_0x490797(0x24a)]>=(_0xc4029e[_0x490797(0x1e1)][_0x490797(0x290)]||0x7)?_0x490797(0x2f6)+_0xc4029e[_0x490797(0x300)][_0x490797(0x24a)]+_0x490797(0x2ad):'Lernphase\x20('+_0xc4029e[_0x490797(0x300)][_0x490797(0x24a)]+'/'+(_0xc4029e[_0x490797(0x1e1)][_0x490797(0x290)]||0x7)+')';await _0xc4029e['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x118892,'ack':!![]});}async function initSensorSubscriptions(_0x5ed515){const _0x27036a=a0_0x2a8f54,_0x28e1c5=_0x5ed515['config'][_0x27036a(0x224)];if(_0x28e1c5)for(const _0x57294c of _0x28e1c5){await _0x5ed515[_0x27036a(0x2af)](_0x57294c['id']);}}async function initPresenceSubscriptions(_0x295fc0){const _0x1b0c26=a0_0x2a8f54,_0x532385=_0x295fc0[_0x1b0c26(0x1e1)][_0x1b0c26(0x286)];if(_0x532385)for(const _0x359f6d of _0x532385){await _0x295fc0['subscribeForeignStatesAsync'](_0x359f6d);}}async function setupTelegramListener(_0x7c092b){const _0x338cf5=a0_0x2a8f54,_0x4ff0fa=_0x7c092b[_0x338cf5(0x1e1)]['notifyTelegramInstance'];if(_0x7c092b[_0x338cf5(0x1e1)]['notifyTelegramEnabled']&&_0x4ff0fa)await _0x7c092b[_0x338cf5(0x2af)](_0x4ff0fa+'.communicate.request');}async function checkWifiPresence(_0x295799){const _0x2ea55a=a0_0x2a8f54;try{const _0xa802f=_0x295799['config']['presenceDevices']||[];let _0x40794e=![];const _0x1a177e=[];for(const _0x23cc1e of _0xa802f){try{const _0x373279=await _0x295799[_0x2ea55a(0x36a)](_0x23cc1e);_0x373279&&(_0x373279[_0x2ea55a(0x22d)]===!![]||_0x373279[_0x2ea55a(0x22d)]==='online'||_0x373279[_0x2ea55a(0x22d)]===0x1)&&(_0x40794e=!![],_0x1a177e['push'](_0x23cc1e));}catch(_0x39716b){}}return await _0x295799[_0x2ea55a(0x282)](_0x2ea55a(0x330),{'val':_0x1a177e[_0x2ea55a(0x364)](',\x20'),'ack':!![]}),_0x40794e&&(_0x295799[_0x2ea55a(0x259)]&&(_0x295799[_0x2ea55a(0x2a4)]['info']('WiFi\x20Presence\x20detected.'),abortExitTimer(_0x295799)),!_0x295799[_0x2ea55a(0x2ea)]&&_0x295799[_0x2ea55a(0x23c)]===SYSTEM_MODES[_0x2ea55a(0x2e0)]&&await setPresence(_0x295799,!![])),_0x40794e;}catch(_0x4e2449){return![];}}function startExitTimer(_0x1aa3b1){const _0x279124=a0_0x2a8f54;abortExitTimer(_0x1aa3b1),_0x1aa3b1[_0x279124(0x2f8)]=!![],_0x1aa3b1[_0x279124(0x21d)]=setTimeout(()=>{const _0x473251=_0x279124;_0x1aa3b1[_0x473251(0x2f8)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x1aa3b1[_0x279124(0x259)]=setTimeout(()=>{setPresence(_0x1aa3b1,![]),_0x1aa3b1['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x4499f2){const _0x30180b=a0_0x2a8f54;if(_0x4499f2['exitTimer'])clearTimeout(_0x4499f2[_0x30180b(0x259)]);if(_0x4499f2['exitGraceTimer'])clearTimeout(_0x4499f2[_0x30180b(0x21d)]);_0x4499f2[_0x30180b(0x259)]=null,_0x4499f2['exitGraceTimer']=null,_0x4499f2[_0x30180b(0x2f8)]=![];}async function setPresence(_0x1b96e9,_0xaf4b0f){const _0x7eddf5=a0_0x2a8f54;if(_0x1b96e9[_0x7eddf5(0x2ea)]===_0xaf4b0f)return;_0x1b96e9[_0x7eddf5(0x2ea)]=_0xaf4b0f,await _0x1b96e9[_0x7eddf5(0x282)](_0x7eddf5(0x376),{'val':_0xaf4b0f,'ack':!![]});}async function executeAutomationAction(_0x29f461){const _0x22d222=a0_0x2a8f54;try{const _0x3e32d9=await _0x29f461[_0x22d222(0x1c4)](_0x22d222(0x2a9)),_0x5af04e=await _0x29f461[_0x22d222(0x1c4)](_0x22d222(0x29c));if(_0x3e32d9&&_0x3e32d9[_0x22d222(0x22d)]&&_0x5af04e){const _0x5a3d05=_0x3e32d9['val'];let _0xef9938=_0x5af04e[_0x22d222(0x22d)];try{_0xef9938=JSON[_0x22d222(0x321)](_0xef9938);}catch(_0x3d612b){}_0x29f461[_0x22d222(0x2a4)][_0x22d222(0x2c5)](_0x22d222(0x362)+_0x5a3d05+_0x22d222(0x2d4)+_0xef9938),await _0x29f461[_0x22d222(0x338)](_0x5a3d05,_0xef9938);}else _0x29f461[_0x22d222(0x2a4)][_0x22d222(0x298)](_0x22d222(0x232));}catch(_0x3a5a35){_0x29f461[_0x22d222(0x2a4)][_0x22d222(0x32b)](_0x22d222(0x31f)+_0x3a5a35[_0x22d222(0x30b)]);}}async function processSensorEvent(_0x4372a8,_0x49a8bb,_0xb439e4,_0x1de2f8){const _0x5cb446=a0_0x2a8f54;if(!_0x1de2f8)return;const _0x403101=_0xb439e4['val'],_0xc8a7a4=Date[_0x5cb446(0x2fc)](),_0x438594=_0x4372a8['sensorLastValues'][_0x49a8bb];_0x4372a8[_0x5cb446(0x1c8)][_0x49a8bb]=_0x403101;if(!_0x1de2f8['logDuplicates']&&_0x438594!=undefined&&_0x438594==_0x403101)return;const _0x4ffa6d=(_0x1de2f8[_0x5cb446(0x2bd)]||'')[_0x5cb446(0x2c7)](),_0x20f6be=_0x4ffa6d[_0x5cb446(0x2a1)](_0x5cb446(0x1dd))||_0x4ffa6d[_0x5cb446(0x2a1)]('temperatur')||_0x4ffa6d['includes']('klima')||_0x4ffa6d[_0x5cb446(0x2a1)](_0x5cb446(0x2a8));_0x4372a8['isProVersion']&&_0x20f6be&&recordThermodynamics(_0x4372a8,_0x49a8bb,_0x403101,_0x1de2f8[_0x5cb446(0x206)]);const _0x12cd81={'timestamp':_0xc8a7a4,'id':_0x49a8bb,'name':_0x1de2f8[_0x5cb446(0x27f)],'type':_0x1de2f8['type'],'location':_0x1de2f8['location'],'value':_0x403101};_0x4372a8['eventHistory'][_0x5cb446(0x1c0)](_0x12cd81);if(_0x4372a8['eventHistory'][_0x5cb446(0x24a)]>HISTORY_MAX_SIZE)_0x4372a8[_0x5cb446(0x319)][_0x5cb446(0x2ca)]();await _0x4372a8[_0x5cb446(0x282)](_0x5cb446(0x30c),{'val':JSON[_0x5cb446(0x1f7)](_0x12cd81),'ack':!![]}),await _0x4372a8[_0x5cb446(0x282)](_0x5cb446(0x2dc),{'val':JSON[_0x5cb446(0x1f7)](_0x4372a8[_0x5cb446(0x319)]),'ack':!![]});_0x4372a8[_0x5cb446(0x20c)]&&(_0x4372a8[_0x5cb446(0x35e)][_0x5cb446(0x234)](_0x12cd81),await saveRawEventLog(_0x4372a8),recordSequence(_0x4372a8,_0x12cd81));if(_0x1de2f8[_0x5cb446(0x1c7)]&&_0x403101===!![]){if(_0x4372a8[_0x5cb446(0x2ea)]&&!_0x4372a8[_0x5cb446(0x2f8)])startExitTimer(_0x4372a8);else{if(!_0x4372a8[_0x5cb446(0x2ea)])setPresence(_0x4372a8,!![]);}}else{if(_0x1de2f8['type']===_0x5cb446(0x297)&&_0x403101===!![]){if(_0x4372a8[_0x5cb446(0x259)])abortExitTimer(_0x4372a8);if(!_0x4372a8[_0x5cb446(0x2ea)]&&_0x4372a8[_0x5cb446(0x23c)]===SYSTEM_MODES[_0x5cb446(0x2e0)])setPresence(_0x4372a8,!![]);}}}async function recordThermodynamics(_0x35ab98,_0x317ee4,_0x1b41a7,_0x5d7949){const _0x3f74f1=a0_0x2a8f54,_0x267b96=await getOutsideTemperatureNumeric(_0x35ab98),_0x4506ea=await _0x35ab98[_0x3f74f1(0x1c4)](_0x3f74f1(0x302));let _0x32fcd2=[];if(_0x4506ea&&_0x4506ea[_0x3f74f1(0x22d)])try{_0x32fcd2=JSON[_0x3f74f1(0x321)](_0x4506ea[_0x3f74f1(0x22d)]);}catch(_0x53dba1){}_0x32fcd2[_0x3f74f1(0x234)]({'ts':Date['now'](),'room':_0x5d7949||_0x3f74f1(0x331),'t_in':_0x1b41a7,'t_out':_0x267b96});if(_0x32fcd2[_0x3f74f1(0x24a)]>THERMO_LOG_SIZE)_0x32fcd2[_0x3f74f1(0x2d3)]();await _0x35ab98[_0x3f74f1(0x282)](_0x3f74f1(0x302),{'val':JSON[_0x3f74f1(0x1f7)](_0x32fcd2),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x11c50b){const _0x14a5f1=a0_0x2a8f54;if(_0x11c50b['config'][_0x14a5f1(0x1d0)])try{const _0xb0638c=await _0x11c50b[_0x14a5f1(0x36a)](_0x11c50b[_0x14a5f1(0x1e1)][_0x14a5f1(0x1d0)]);if(_0xb0638c&&_0xb0638c[_0x14a5f1(0x22d)]!==undefined&&_0xb0638c[_0x14a5f1(0x22d)]!==null)return parseFloat(_0xb0638c[_0x14a5f1(0x22d)]);}catch(_0x2d98d1){}const _0x3ddaeb=_0x11c50b['config']['weatherInstance'];if(!_0x11c50b[_0x14a5f1(0x1e1)][_0x14a5f1(0x2db)]||!_0x3ddaeb)return null;try{let _0x114afa='';if(_0x3ddaeb[_0x14a5f1(0x2a1)]('accuweather'))_0x114afa=_0x3ddaeb+_0x14a5f1(0x2cc);else{if(_0x3ddaeb[_0x14a5f1(0x2a1)]('daswetter'))_0x114afa=_0x3ddaeb+_0x14a5f1(0x21a);else{if(_0x3ddaeb[_0x14a5f1(0x2a1)]('openweathermap'))_0x114afa=_0x3ddaeb+_0x14a5f1(0x32a);else{if(_0x3ddaeb['includes'](_0x14a5f1(0x328)))_0x114afa=_0x3ddaeb+'.forecast.current.temp';}}}if(_0x114afa){const _0x410a75=await _0x11c50b['getForeignStateAsync'](_0x114afa);if(_0x410a75&&_0x410a75[_0x14a5f1(0x22d)]!==undefined&&_0x410a75[_0x14a5f1(0x22d)]!==null)return parseFloat(_0x410a75[_0x14a5f1(0x22d)]);}}catch(_0x4e1549){}return null;}async function recordSequence(_0x59ef05,_0xdd9372){const _0xd73df9=a0_0x2a8f54,_0x14eaff=(_0xdd9372['type']||'')[_0xd73df9(0x2c7)](),_0x420573=[_0xd73df9(0x297),_0xd73df9(0x33c),_0xd73df9(0x313),'presence',_0xd73df9(0x34c),_0xd73df9(0x377),'tÃ¼r',_0xd73df9(0x2cf),_0xd73df9(0x27c),_0xd73df9(0x31c),_0xd73df9(0x252),_0xd73df9(0x25d),_0xd73df9(0x21f),_0xd73df9(0x228),_0xd73df9(0x2bf),_0xd73df9(0x1de),_0xd73df9(0x273)];if(!_0x420573[_0xd73df9(0x34a)](_0x5b8983=>_0x14eaff[_0xd73df9(0x2a1)](_0x5b8983)))return;if(!_0xdd9372[_0xd73df9(0x216)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0xd73df9(0x234)]({'loc':_0xdd9372[_0xd73df9(0x206)]||_0xd73df9(0x331),'id':_0xdd9372['id'],'ts':Date[_0xd73df9(0x2fc)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x59ef05);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x349692){const _0x1be0e2=a0_0x2a8f54;try{const _0x977266=await _0x349692[_0x1be0e2(0x1c4)]('LTM.trainingData.sequences');let _0x1e12bb=[];if(_0x977266&&_0x977266[_0x1be0e2(0x22d)])try{_0x1e12bb=JSON[_0x1be0e2(0x321)](_0x977266[_0x1be0e2(0x22d)]);}catch(_0x457fd1){}const _0xb1999f=activeSequence[0x0]['ts'],_0x32f07b=activeSequence['map'](_0x45cea1=>({'loc':_0x45cea1[_0x1be0e2(0x30a)],'t_delta':Math[_0x1be0e2(0x253)]((_0x45cea1['ts']-_0xb1999f)/0x3e8)})),_0x4fae86={'timestamp':new Date(_0xb1999f)[_0x1be0e2(0x284)](),'steps':_0x32f07b,'duration':Math[_0x1be0e2(0x253)]((activeSequence[activeSequence['length']-0x1]['ts']-_0xb1999f)/0x3e8),'daytime':new Date(_0xb1999f)[_0x1be0e2(0x20b)]()};_0x1e12bb['push'](_0x4fae86);if(_0x1e12bb[_0x1be0e2(0x24a)]>MAX_TRAINING_SET_SIZE)_0x1e12bb[_0x1be0e2(0x2d3)]();await _0x349692['setStateAsync'](_0x1be0e2(0x295),{'val':JSON['stringify'](_0x1e12bb),'ack':!![]}),runSecurityCheck(_0x349692,_0x4fae86);}catch(_0x5deffd){_0x349692['log']['error']('[RECORDER]\x20Error:\x20'+_0x5deffd['message']);}}function runSecurityCheck(_0x40ad72,_0x3671df){const _0x2c9468=a0_0x2a8f54;if(!_0x40ad72[_0x2c9468(0x20c)])return;sendToPython(_0x40ad72,_0x2c9468(0x307),{'sequence':_0x3671df});}function sendToPython(_0x451c3c,_0xc193fa,_0x44dbc4={}){const _0x12b8fa=a0_0x2a8f54;if(!_0x451c3c[_0x12b8fa(0x21c)]||!_0x451c3c[_0x12b8fa(0x21c)]['stdin']['writable'])return;const _0x1eca37=JSON[_0x12b8fa(0x1f7)]({'command':_0xc193fa,..._0x44dbc4});try{_0x451c3c[_0x12b8fa(0x21c)][_0x12b8fa(0x223)][_0x12b8fa(0x219)](_0x1eca37+'\x0a');}catch(_0x354517){}}function startPythonService(_0x1faa61){const _0x21d3fe=a0_0x2a8f54;let _0x20a474=_0x21d3fe(0x243);if(fs[_0x21d3fe(0x306)](PYTHON_EXE))_0x20a474=PYTHON_EXE;try{const _0x26a7fc=path['join'](__dirname,_0x21d3fe(0x1db),_0x21d3fe(0x2ff));_0x1faa61[_0x21d3fe(0x21c)]=spawn(_0x20a474,[_0x26a7fc]),_0x1faa61[_0x21d3fe(0x21c)][_0x21d3fe(0x36e)]['on']('data',_0x16a3ad=>{const _0x4cade7=_0x21d3fe,_0x24d8c5=_0x16a3ad['toString']()[_0x4cade7(0x1be)]('\x0a');_0x24d8c5[_0x4cade7(0x35b)](_0x5d351e=>{const _0x5e82ba=_0x4cade7,_0xb62725=_0x5d351e['trim']();if(!_0xb62725)return;if(_0xb62725[_0x5e82ba(0x22f)]('[LOG]'))_0x1faa61[_0x5e82ba(0x2a4)][_0x5e82ba(0x27d)](_0x5e82ba(0x33a)+_0xb62725[_0x5e82ba(0x212)](0x5)['trim']());else{if(_0xb62725[_0x5e82ba(0x22f)](_0x5e82ba(0x308)))try{const _0x25b3a2=JSON[_0x5e82ba(0x321)](_0xb62725[_0x5e82ba(0x212)](0x8)[_0x5e82ba(0x34e)]());handlePythonResult(_0x1faa61,_0x25b3a2);}catch(_0x50dec0){}}});}),_0x1faa61[_0x21d3fe(0x21c)]['on'](_0x21d3fe(0x202),_0x1620cc=>{const _0x1fcc49=_0x21d3fe;_0x1faa61[_0x1fcc49(0x21c)]=null;});}catch(_0x2b07ad){_0x1faa61['log']['error'](_0x21d3fe(0x2c1)+_0x2b07ad['message']);}}function stopPythonService(_0x22e503){const _0x516c18=a0_0x2a8f54;if(_0x22e503['pythonProcess']){try{_0x22e503[_0x516c18(0x21c)][_0x516c18(0x29d)]();}catch(_0x5c8897){}_0x22e503[_0x516c18(0x21c)]=null;}}function handlePythonResult(_0x19d55b,_0x423d72){const _0x578c9f=a0_0x2a8f54;if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x310))_0x19d55b[_0x578c9f(0x2a4)]['debug'](_0x578c9f(0x23b));else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x2a3)){const {anomaly_score:_0x45739c,is_anomaly:_0x4251c9,threshold:_0x50eff1,explanation:_0x1a2b3d}=_0x423d72[_0x578c9f(0x32c)];_0x19d55b[_0x578c9f(0x2a4)][_0x578c9f(0x2c5)](_0x578c9f(0x2e5)+_0x45739c['toFixed'](0x5)+_0x578c9f(0x1fc)+(_0x4251c9?_0x578c9f(0x1d1):'OK')),_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x341),{'val':_0x45739c,'ack':!![]}),_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x323),{'val':new Date()['toISOString'](),'ack':!![]});if(_0x50eff1)_0x19d55b['setStateAsync'](_0x578c9f(0x22c),{'val':_0x50eff1,'ack':!![]});if(_0x4251c9){let _0x6d55d0=_0x578c9f(0x2b5)+_0x45739c[_0x578c9f(0x250)](0x4)+')';if(_0x1a2b3d&&_0x1a2b3d!=='Unknown')_0x6d55d0+=_0x578c9f(0x372)+_0x1a2b3d;_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x261),{'val':!![],'ack':!![]}),_0x19d55b['setStateAsync'](_0x578c9f(0x379),{'val':_0x6d55d0,'ack':!![]}),sendNotification(_0x19d55b,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x6d55d0,![],!![]);}}else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x34d)){const _0x84a586=_0x423d72[_0x578c9f(0x32c)][_0x578c9f(0x344)]||'',_0x12e133=_0x423d72[_0x578c9f(0x32c)][_0x578c9f(0x235)],_0x1aef61=_0x423d72[_0x578c9f(0x32c)][_0x578c9f(0x2bc)]?_0x578c9f(0x26e)+new Date()[_0x578c9f(0x2ec)]()+'\x20('+_0x84a586+')':_0x578c9f(0x2df)+_0x423d72[_0x578c9f(0x32c)][_0x578c9f(0x24d)];_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x2b8),{'val':_0x1aef61,'ack':!![]});if(_0x423d72['payload']['success']&&_0x12e133)_0x19d55b[_0x578c9f(0x282)]('analysis.security.currentThreshold',{'val':_0x12e133,'ack':!![]});}else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x293)){const {patterns:_0x15558b}=_0x423d72[_0x578c9f(0x32c)];if(_0x15558b&&_0x15558b['length']>0x0){_0x19d55b[_0x578c9f(0x2a4)][_0x578c9f(0x2c5)](_0x578c9f(0x1e9)+_0x15558b[_0x578c9f(0x24a)]+_0x578c9f(0x2be)),_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x1c1),{'val':JSON[_0x578c9f(0x1f7)](_0x15558b),'ack':!![]});const _0x5bcf6d=_0x15558b[0x0],_0x4d4838=_0x578c9f(0x28c)+_0x5bcf6d['rule']+'\x20('+(_0x5bcf6d[_0x578c9f(0x322)]*0x64)[_0x578c9f(0x250)](0x0)+'%)';_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x350),{'val':!![],'ack':!![]}),_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x2d1),{'val':_0x4d4838,'ack':!![]});}else _0x19d55b[_0x578c9f(0x2a4)][_0x578c9f(0x2c5)](_0x578c9f(0x200)),_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x350),{'val':![],'ack':!![]}),_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x1c1),{'val':'[]','ack':!![]});}else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x1f5)){if(_0x423d72[_0x578c9f(0x32c)][_0x578c9f(0x2bc)])try{const _0x37611e=JSON['parse'](_0x423d72[_0x578c9f(0x32c)][_0x578c9f(0x344)]);if(_0x37611e[_0x578c9f(0x26d)])_0x19d55b['setStateAsync'](_0x578c9f(0x2f4),{'val':JSON[_0x578c9f(0x1f7)](_0x37611e[_0x578c9f(0x26d)]),'ack':!![]});if(_0x37611e[_0x578c9f(0x316)])_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x21b),{'val':JSON[_0x578c9f(0x1f7)](_0x37611e[_0x578c9f(0x316)]),'ack':!![]});}catch(_0x49b0a2){}}else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x2e7)){if(_0x423d72[_0x578c9f(0x32c)][_0x578c9f(0x2bc)])_0x19d55b[_0x578c9f(0x2a4)]['info'](_0x578c9f(0x355));}else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x242))_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x368),{'val':new Date()['toISOString'](),'ack':!![]}),_0x19d55b['setStateAsync']('analysis.health.isAnomaly',{'val':_0x423d72['payload']['is_anomaly'],'ack':!![]});else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x27e))_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x33e),{'val':_0x423d72[_0x578c9f(0x32c)]['diagnosis'],'ack':!![]}),_0x19d55b['setStateAsync'](_0x578c9f(0x36b),{'val':_0x423d72[_0x578c9f(0x32c)][_0x578c9f(0x359)],'ack':!![]});else{if(_0x423d72['type']===_0x578c9f(0x1fd)){const {speed_trend:_0x1fad22}=_0x423d72[_0x578c9f(0x32c)];_0x1fad22!==undefined&&_0x19d55b['setStateAsync'](_0x578c9f(0x30f),{'val':_0x1fad22,'ack':!![]});}else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x1ee)){const {forecast:_0x1fc105}=_0x423d72['payload'];_0x1fc105&&_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x30e),{'val':JSON[_0x578c9f(0x1f7)](_0x1fc105),'ack':!![]});}else{if(_0x423d72[_0x578c9f(0x2bd)]===_0x578c9f(0x208)){const {data:_0x303ffc}=_0x423d72[_0x578c9f(0x32c)];_0x303ffc&&(_0x19d55b[_0x578c9f(0x2a4)][_0x578c9f(0x2c5)](_0x578c9f(0x342)),_0x19d55b[_0x578c9f(0x282)](_0x578c9f(0x363),{'val':JSON[_0x578c9f(0x1f7)](_0x303ffc),'ack':!![]}));}}}}}}}}}}}}function runPythonHealthCheck(_0x21fe93){const _0x1f62cf=a0_0x2a8f54;if(!_0x21fe93[_0x1f62cf(0x300)]||_0x21fe93[_0x1f62cf(0x300)][_0x1f62cf(0x24a)]<0x2)return;const _0x3b38af=_0x21fe93['dailyDigests'][_0x1f62cf(0x28f)](_0x160d5d=>{const _0x48bd34=_0x1f62cf,_0x2c14c6=(_0x160d5d[_0x48bd34(0x225)]||'')[_0x48bd34(0x2c7)]();return ACTIVITY_LEVEL_MAP[_0x2c14c6]||0x32;});sendToPython(_0x21fe93,'ANALYZE_TREND',{'values':_0x3b38af,'tag':_0x1f62cf(0x2d8)});}async function handleTelegramResponse(_0x1c821f,_0x20c903){const _0x3cf724=a0_0x2a8f54;let _0x2cf8ae=_0x20c903;_0x20c903[_0x3cf724(0x22f)]('[')&&(_0x2cf8ae=_0x20c903[_0x3cf724(0x212)](_0x20c903[_0x3cf724(0x36f)](']')+0x1));if(_0x2cf8ae===_0x3cf724(0x334))await _0x1c821f[_0x3cf724(0x282)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x1c821f['setStateAsync']('analysis.alertReason',{'val':_0x3cf724(0x27a),'ack':!![]}),_0x1c821f['lastAlertState']=![],sendNotification(_0x1c821f,_0x3cf724(0x2d7),![]);else _0x2cf8ae===_0x3cf724(0x231)&&sendNotification(_0x1c821f,'ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]);}async function sendNotification(_0x572951,_0x404744,_0x529c4e=![],_0x25be60=![]){const _0x59d195=a0_0x2a8f54,_0x1c2f69=_0x572951[_0x59d195(0x1e1)];if(_0x1c2f69[_0x59d195(0x29b)]){let _0x465578={};(_0x404744[_0x59d195(0x2a1)]('Alarm')||_0x25be60)&&(_0x465578={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':_0x59d195(0x334)}],[{'text':_0x59d195(0x29a),'callback_data':_0x59d195(0x231)}]]}}),await _0x572951[_0x59d195(0x335)](_0x1c2f69['notifyTelegramInstance'],_0x59d195(0x34f),{'text':_0x404744,'user':_0x1c2f69[_0x59d195(0x29f)],..._0x465578});}if(_0x1c2f69[_0x59d195(0x1ef)]){let _0x48ef3a={'message':_0x404744,'title':_0x25be60?'ðŸš¨\x20EMERGENCY':_0x59d195(0x1da),'priority':_0x25be60?0x2:0x1,'device':_0x1c2f69[_0x59d195(0x2fb)]};_0x25be60&&(_0x48ef3a['retry']=0x1e,_0x48ef3a[_0x59d195(0x24f)]=0xe10,_0x48ef3a['sound']=_0x59d195(0x30d)),await _0x572951[_0x59d195(0x335)](_0x1c2f69['notifyPushoverInstance'],_0x59d195(0x34f),_0x48ef3a);}_0x1c2f69[_0x59d195(0x272)]&&await _0x572951['sendToAsync'](_0x1c2f69['notifyEmailInstance'],_0x59d195(0x34f),{'text':_0x404744,'to':_0x1c2f69[_0x59d195(0x2c4)]});}async function runGeminiAnalysis(_0x2fefc4,_0x219830=''){const _0x12c384=a0_0x2a8f54;if(!_0x2fefc4[_0x12c384(0x260)])return;if(_0x2fefc4[_0x12c384(0x319)][_0x12c384(0x24a)]===0x0)return;const _0x1208ce=_0x2fefc4[_0x12c384(0x319)]['slice'](0x0,0xf),_0x2c02a4=await getWeatherContext(_0x2fefc4),_0x42b4ed=_0x2fefc4[_0x12c384(0x23c)],_0x5cd53e=PERSONA_MAPPING[_0x2fefc4[_0x12c384(0x1e1)][_0x12c384(0x268)]||_0x12c384(0x1f6)],_0x235fd0=_0x2fefc4['config'][_0x12c384(0x1d3)]||_0x12c384(0x22b);let _0x2a28d1=_0x12c384(0x2fe);try{const _0x4e1b8f=await _0x2fefc4[_0x12c384(0x1c4)](_0x12c384(0x330));if(_0x4e1b8f&&_0x4e1b8f[_0x12c384(0x22d)])_0x2a28d1=_0x4e1b8f['val'];}catch(_0x37f25a){}let _0x1bd3a3=![];try{const _0x100f02=await _0x2fefc4[_0x12c384(0x1c4)](_0x12c384(0x347));if(_0x100f02&&_0x100f02[_0x12c384(0x22d)])_0x1bd3a3=!![];}catch(_0x31c145){}const _0x456463=_0x12c384(0x346)+_0x5cd53e+_0x12c384(0x2b0)+_0x235fd0+_0x12c384(0x23e)+_0x42b4ed+'.\x20WETTER:\x20'+_0x2c02a4+'.\x20ANWESEND:\x20'+_0x2a28d1+'.\x20EVENTS:\x20'+JSON[_0x12c384(0x1f7)](_0x1208ce)+_0x12c384(0x332)+_0x219830+_0x12c384(0x280);try{const _0x57afb8=await _0x2fefc4[_0x12c384(0x260)][_0x12c384(0x28d)](_0x456463),_0x285686=JSON[_0x12c384(0x321)](_0x57afb8[_0x12c384(0x31b)][_0x12c384(0x22a)]()[_0x12c384(0x233)](/```json|```/g,'')[_0x12c384(0x34e)]());await _0x2fefc4[_0x12c384(0x282)]('analysis.lastResult',{'val':JSON[_0x12c384(0x1f7)](_0x285686),'ack':!![]});if(_0x285686[_0x12c384(0x246)])await _0x2fefc4[_0x12c384(0x282)](_0x12c384(0x1f9),{'val':_0x285686[_0x12c384(0x246)],'ack':!![]});const _0x2fb942={'timestamp':Date[_0x12c384(0x2fc)](),'id':Date[_0x12c384(0x2fc)]()[_0x12c384(0x20e)](),'analysis':{'activity':{'summary':_0x285686['summary'],'isAlert':_0x285686[_0x12c384(0x1d2)],'alertReason':_0x285686[_0x12c384(0x2b2)]},'comfort':{'automationProposal':_0x285686[_0x12c384(0x2f7)]}}};await updateAnalysisHistory(_0x2fefc4,_0x2fb942);const _0x4ad5e4=_0x285686['isAlert']||![];_0x4ad5e4!==_0x2fefc4[_0x12c384(0x2d2)]&&(await _0x2fefc4[_0x12c384(0x282)](_0x12c384(0x261),{'val':_0x4ad5e4,'ack':!![]}),_0x2fefc4[_0x12c384(0x2d2)]=_0x4ad5e4,_0x4ad5e4&&(await _0x2fefc4['setStateAsync'](_0x12c384(0x379),{'val':_0x285686[_0x12c384(0x2b2)],'ack':!![]}),sendNotification(_0x2fefc4,_0x12c384(0x378)+_0x285686['alertReason'],![],_0x285686['isEmergency'])));if(_0x285686[_0x12c384(0x2f7)]&&_0x285686[_0x12c384(0x2f7)][_0x12c384(0x2e1)]){await _0x2fefc4[_0x12c384(0x282)](_0x12c384(0x350),{'val':!![],'ack':!![]}),await _0x2fefc4[_0x12c384(0x282)](_0x12c384(0x2d1),{'val':_0x285686[_0x12c384(0x2f7)][_0x12c384(0x1ea)],'ack':!![]}),await _0x2fefc4[_0x12c384(0x282)](_0x12c384(0x2a9),{'val':_0x285686[_0x12c384(0x2f7)][_0x12c384(0x2dd)],'ack':!![]}),await _0x2fefc4[_0x12c384(0x282)](_0x12c384(0x29c),{'val':JSON[_0x12c384(0x1f7)](_0x285686[_0x12c384(0x2f7)]['targetValue']),'ack':!![]});if(_0x1bd3a3)executeAutomationAction(_0x2fefc4);}}catch(_0x1d7e3d){_0x2fefc4['log'][_0x12c384(0x32b)](_0x12c384(0x277)+_0x1d7e3d[_0x12c384(0x30b)]);}}async function createDailyDigest(_0xbdc5f0){const _0x1db4d9=a0_0x2a8f54;if(!_0xbdc5f0[_0x1db4d9(0x20c)])return;await _0xbdc5f0[_0x1db4d9(0x282)](LTM_DP_STATUS,{'val':_0x1db4d9(0x1d8),'ack':!![]});if(!_0xbdc5f0['geminiModel']||_0xbdc5f0[_0x1db4d9(0x35e)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0xbdc5f0[_0x1db4d9(0x282)](LTM_DP_STATUS,{'val':_0x1db4d9(0x278),'ack':!![]});return;}const _0x5c8e12=JSON[_0x1db4d9(0x321)](JSON[_0x1db4d9(0x1f7)](_0xbdc5f0[_0x1db4d9(0x35e)])),_0x37d331=_0x5c8e12[_0x1db4d9(0x24a)],_0x5a1f43='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON['stringify'](_0x5c8e12);try{const _0x1065b5=await _0xbdc5f0['geminiModel'][_0x1db4d9(0x28d)](_0x5a1f43),_0x38bcd8=JSON[_0x1db4d9(0x321)](_0x1065b5['response'][_0x1db4d9(0x22a)]()[_0x1db4d9(0x233)](/```json|```/g,'')['trim']()),_0x1711b4={'timestamp':new Date()[_0x1db4d9(0x284)](),'eventCount':_0x37d331,'summary':_0x38bcd8['summary']||_0x1db4d9(0x263),'activityLevel':_0x38bcd8[_0x1db4d9(0x225)]||_0x1db4d9(0x1df),'systemMode':_0xbdc5f0[_0x1db4d9(0x23c)]};_0xbdc5f0[_0x1db4d9(0x300)][_0x1db4d9(0x234)](_0x1711b4),await saveDailyDigests(_0xbdc5f0),_0xbdc5f0[_0x1db4d9(0x35e)]=[],await saveRawEventLog(_0xbdc5f0),await _0xbdc5f0[_0x1db4d9(0x282)](LTM_DP_STATUS,{'val':_0x1db4d9(0x229),'ack':!![]});if(_0xbdc5f0[_0x1db4d9(0x20c)])sendToPython(_0xbdc5f0,_0x1db4d9(0x33f),{'digest':_0x1711b4});}catch(_0x4d34ef){_0xbdc5f0[_0x1db4d9(0x2a4)]['error'](_0x4d34ef[_0x1db4d9(0x30b)]);}}function setupLtmScheduler(_0x105854){const _0x369560=a0_0x2a8f54;try{if(_0x105854['ltmJob'])_0x105854[_0x369560(0x249)][_0x369560(0x345)]();if(!_0x105854['isProVersion'])return;_0x105854[_0x369560(0x249)]=schedule[_0x369560(0x218)](LTM_SCHEDULE,()=>createDailyDigest(_0x105854));}catch(_0x2c81cb){_0x105854[_0x369560(0x2a4)]['error'](_0x369560(0x360)+_0x2c81cb[_0x369560(0x30b)]);}}function setupModeResetScheduler(_0x21e2a5){const _0x1c0d2b=a0_0x2a8f54;try{if(_0x21e2a5[_0x1c0d2b(0x291)])_0x21e2a5[_0x1c0d2b(0x291)][_0x1c0d2b(0x345)]();_0x21e2a5[_0x1c0d2b(0x291)]=schedule[_0x1c0d2b(0x218)](MODE_RESET_SCHEDULE,async()=>{const _0x15875d=_0x1c0d2b;await loadSystemMode(_0x21e2a5),AUTO_RESET_MODES[_0x15875d(0x2a1)](_0x21e2a5['currentSystemMode'])&&await _0x21e2a5['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x15875d(0x2e0)],'ack':![]});});}catch(_0x53a00e){_0x21e2a5[_0x1c0d2b(0x2a4)]['error'](_0x1c0d2b(0x354)+_0x53a00e[_0x1c0d2b(0x30b)]);}}function setupDriftAnalysisScheduler(_0xaa4fd9){const _0x4eee00=a0_0x2a8f54;try{if(_0xaa4fd9[_0x4eee00(0x267)])clearInterval(_0xaa4fd9[_0x4eee00(0x267)]);if(!_0xaa4fd9[_0x4eee00(0x20c)])return;_0xaa4fd9['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0xaa4fd9),(_0xaa4fd9[_0x4eee00(0x1e1)][_0x4eee00(0x337)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0xaa4fd9),0x1388);}catch(_0xa6759f){_0xaa4fd9[_0x4eee00(0x2a4)][_0x4eee00(0x32b)](_0x4eee00(0x24e)+_0xa6759f[_0x4eee00(0x30b)]);}}function setupBriefingScheduler(_0x4d2da2){const _0x2c4465=a0_0x2a8f54;try{if(_0x4d2da2[_0x2c4465(0x33d)])_0x4d2da2[_0x2c4465(0x33d)][_0x2c4465(0x345)]();if(!_0x4d2da2[_0x2c4465(0x1e1)][_0x2c4465(0x26f)])return;const _0x99e57=(_0x4d2da2[_0x2c4465(0x1e1)]['briefingTime']||_0x2c4465(0x1f0))['split'](':'),_0x1cae81=parseInt(_0x99e57[0x0])||0x8,_0x28c599=parseInt(_0x99e57[0x1])||0x0,_0x4dc591=_0x28c599+'\x20'+_0x1cae81+_0x2c4465(0x209);_0x4d2da2[_0x2c4465(0x33d)]=schedule[_0x2c4465(0x218)](_0x4dc591,()=>{sendMorningBriefing(_0x4d2da2);});}catch(_0x515acd){_0x4d2da2[_0x2c4465(0x2a4)][_0x2c4465(0x32b)](_0x2c4465(0x262)+_0x515acd[_0x2c4465(0x30b)]);}}async function runBaselineDriftAnalysis(_0x46b21a){const _0x4f5b1e=a0_0x2a8f54;if(!_0x46b21a['isProVersion']||!_0x46b21a[_0x4f5b1e(0x260)])return;const _0x147354=_0x46b21a['config']['ltmStbWindowDays']||0xe;if(_0x46b21a[_0x4f5b1e(0x300)][_0x4f5b1e(0x24a)]<_0x147354+0x7){await _0x46b21a[_0x4f5b1e(0x282)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x1b861f=_0x46b21a['dailyDigests'][_0x4f5b1e(0x2d0)](-_0x147354),_0x497a9e=_0x46b21a['dailyDigests'][_0x4f5b1e(0x2d0)](0x0,_0x46b21a['dailyDigests'][_0x4f5b1e(0x24a)]-_0x147354),_0x279a76='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON['stringify'](_0x497a9e)+_0x4f5b1e(0x226)+JSON[_0x4f5b1e(0x1f7)](_0x1b861f);try{const _0x1d1785=await _0x46b21a[_0x4f5b1e(0x260)]['generateContent'](_0x279a76),_0x63d82a=JSON['parse'](_0x1d1785[_0x4f5b1e(0x31b)][_0x4f5b1e(0x22a)]()[_0x4f5b1e(0x233)](/```json|```/g,'')['trim']());_0x63d82a[_0x4f5b1e(0x31a)]&&(await _0x46b21a[_0x4f5b1e(0x282)](LTM_DP_DRIFT_STATUS,{'val':_0x63d82a[_0x4f5b1e(0x31a)],'ack':!![]}),await _0x46b21a[_0x4f5b1e(0x282)](LTM_DP_DRIFT_DETAILS,{'val':_0x63d82a[_0x4f5b1e(0x2b7)],'ack':!![]}),await _0x46b21a[_0x4f5b1e(0x282)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4f5b1e(0x2fc)](),'ack':!![]}));}catch(_0x5a0d9a){}}class CogniLiving extends utils[a0_0x2a8f54(0x292)]{constructor(_0x50fe3d){const _0x5cc869=a0_0x2a8f54;super({..._0x50fe3d,'name':_0x5cc869(0x203)}),this[_0x5cc869(0x319)]=[],this[_0x5cc869(0x311)]=[],this[_0x5cc869(0x35e)]=[],this[_0x5cc869(0x300)]=[],this['sensorLastValues']={},this[_0x5cc869(0x2b1)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x5cc869(0x2ea)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x5cc869(0x2f8)]=![],this[_0x5cc869(0x375)]=null,this[_0x5cc869(0x260)]=null,this[_0x5cc869(0x23c)]=SYSTEM_MODES[_0x5cc869(0x2e0)],this[_0x5cc869(0x20c)]=![],this[_0x5cc869(0x2d2)]=![],this[_0x5cc869(0x2f2)]=_0x5cc869(0x2ae),this[_0x5cc869(0x2ac)]=null,this['ltmJob']=null,this[_0x5cc869(0x291)]=null,this[_0x5cc869(0x267)]=null,this[_0x5cc869(0x33d)]=null,this[_0x5cc869(0x21c)]=null,this[_0x5cc869(0x28e)]=![],this['on']('ready',this[_0x5cc869(0x326)][_0x5cc869(0x213)](this)),this['on'](_0x5cc869(0x266),this[_0x5cc869(0x25b)][_0x5cc869(0x213)](this)),this['on'](_0x5cc869(0x356),this['onUnload'][_0x5cc869(0x213)](this)),this['on'](_0x5cc869(0x30b),this[_0x5cc869(0x247)][_0x5cc869(0x213)](this));}async[a0_0x2a8f54(0x326)](){const _0x199c49=a0_0x2a8f54;this[_0x199c49(0x2a4)]['info'](_0x199c49(0x238)+this[_0x199c49(0x329)]+_0x199c49(0x230));if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x2a8f54(0x1fb)](_0x3d327c){const _0x46fc6d=a0_0x2a8f54;if(this['analysisTimer'])clearInterval(this[_0x46fc6d(0x2ac)]);if(this[_0x46fc6d(0x267)])clearInterval(this[_0x46fc6d(0x267)]);if(this['ltmJob'])this[_0x46fc6d(0x249)][_0x46fc6d(0x345)]();if(this[_0x46fc6d(0x291)])this[_0x46fc6d(0x291)][_0x46fc6d(0x345)]();if(this[_0x46fc6d(0x33d)])this['briefingJob'][_0x46fc6d(0x345)]();if(this[_0x46fc6d(0x259)])clearTimeout(this['exitTimer']);if(this[_0x46fc6d(0x21d)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x3d327c();}async[a0_0x2a8f54(0x25b)](_0x525a07,_0x3dc606){const _0xc04276=a0_0x2a8f54;if(!_0x3dc606||this[_0xc04276(0x28e)])return;if(_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x1f4))&&_0x525a07[_0xc04276(0x299)]('communicate.request')&&_0x3dc606[_0xc04276(0x22d)]){await handleTelegramResponse(this,_0x3dc606['val']);return;}if(_0x525a07===this[_0xc04276(0x2b4)]+'.'+SYSTEM_DP_MODE){if(_0x3dc606[_0xc04276(0x22d)]&&Object[_0xc04276(0x303)](SYSTEM_MODES)[_0xc04276(0x2a1)](_0x3dc606[_0xc04276(0x22d)])){this[_0xc04276(0x23c)]=_0x3dc606['val'];if(_0x3dc606[_0xc04276(0x22d)]===SYSTEM_MODES[_0xc04276(0x287)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x3dc606[_0xc04276(0x222)])this[_0xc04276(0x237)](_0x525a07,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x3dc606[_0xc04276(0x222)]){_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x2a7))&&_0x3dc606[_0xc04276(0x22d)]&&(this['setState'](_0x525a07,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x525a07[_0xc04276(0x2a1)]('triggerDailyDigest')&&_0x3dc606['val']){this[_0xc04276(0x237)](_0x525a07,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x1ba))&&_0x3dc606['val']&&(this['setState'](_0x525a07,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x366))&&_0x3dc606['val']&&(this['setState'](_0x525a07,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x1d5))&&_0x3dc606[_0xc04276(0x22d)]){this['setState'](_0x525a07,{'val':![],'ack':!![]});if(this[_0xc04276(0x20c)])try{const _0x80e3fe=await this['getStateAsync'](_0xc04276(0x295));if(_0x80e3fe&&_0x80e3fe[_0xc04276(0x22d)]){const _0x1e6a14=JSON[_0xc04276(0x321)](_0x80e3fe['val']);this['log'][_0xc04276(0x2c5)](_0xc04276(0x369)),this['setStateAsync']('analysis.training.status',{'val':_0xc04276(0x304),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x1e6a14});}}catch(_0x16b240){this[_0xc04276(0x2a4)][_0xc04276(0x32b)]('Training\x20Error:\x20'+_0x16b240[_0xc04276(0x30b)]);}}if(_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x1cd))&&_0x3dc606[_0xc04276(0x22d)]){this['setState'](_0x525a07,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x531229=await this[_0xc04276(0x1c4)](LTM_DP_DAILY_DIGESTS);if(_0x531229&&_0x531229[_0xc04276(0x22d)])sendToPython(this,_0xc04276(0x2a5),{'digests':JSON[_0xc04276(0x321)](_0x531229[_0xc04276(0x22d)])});}catch(_0x21b35e){}}if(_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x352))&&_0x3dc606[_0xc04276(0x22d)]){this[_0xc04276(0x237)](_0x525a07,{'val':![],'ack':!![]});if(this[_0xc04276(0x20c)])try{const _0x643fea=await this[_0xc04276(0x1c4)](_0xc04276(0x302));if(_0x643fea&&_0x643fea[_0xc04276(0x22d)])sendToPython(this,_0xc04276(0x35c),{'points':JSON[_0xc04276(0x321)](_0x643fea[_0xc04276(0x22d)])});}catch(_0x32f9a4){}}if(_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x1f8))&&_0x3dc606['val']){this[_0xc04276(0x237)](_0x525a07,{'val':![],'ack':!![]});if(this[_0xc04276(0x20c)])try{const _0x5e7e01=await this[_0xc04276(0x1c4)](LTM_DP_RAW_LOG);_0x5e7e01&&_0x5e7e01[_0xc04276(0x22d)]&&(this[_0xc04276(0x2a4)][_0xc04276(0x2c5)]('ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...'),sendToPython(this,_0xc04276(0x37a),{'events':JSON['parse'](_0x5e7e01['val'])}));}catch(_0x3503c3){}}if(_0x525a07[_0xc04276(0x2a1)](_0xc04276(0x36d))&&_0x3dc606[_0xc04276(0x22d)]){this[_0xc04276(0x237)](_0x525a07,{'val':![],'ack':!![]});if(this[_0xc04276(0x20c)])try{const _0x309ae0=await this[_0xc04276(0x1c4)](_0xc04276(0x295));if(_0x309ae0&&_0x309ae0[_0xc04276(0x22d)]){const _0x1f3b4a=JSON[_0xc04276(0x321)](_0x309ae0[_0xc04276(0x22d)]);this['log'][_0xc04276(0x2c5)]('ðŸ•¸ï¸\x20Building\x20Topology\x20Matrix...'),sendToPython(this,_0xc04276(0x35d),{'sequences':_0x1f3b4a});}}catch(_0x385422){this[_0xc04276(0x2a4)][_0xc04276(0x32b)](_0xc04276(0x2bb)+_0x385422['message']);}}return;}if(this[_0xc04276(0x1e1)][_0xc04276(0x286)]&&this['config']['presenceDevices'][_0xc04276(0x2a1)](_0x525a07)){await checkWifiPresence(this);return;}const _0x11466e=(this[_0xc04276(0x1e1)]['devices']||[])[_0xc04276(0x315)](_0x3e9a1c=>_0x3e9a1c['id']===_0x525a07);if(_0x11466e)processSensorEvent(this,_0x525a07,_0x3dc606,_0x11466e);}async[a0_0x2a8f54(0x247)](_0x4d2259){const _0x692fa8=a0_0x2a8f54;if(typeof _0x4d2259===_0x692fa8(0x2f9)&&_0x4d2259['message']){if(_0x4d2259[_0x692fa8(0x29e)]===_0x692fa8(0x26a)){const _0x4f5485=_0x4d2259['message']['apiKey']||this[_0x692fa8(0x1e1)]['geminiApiKey'];if(!_0x4f5485)return this[_0x692fa8(0x201)](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259['command'],{'success':![],'message':_0x692fa8(0x309)},_0x4d2259['callback']);try{const _0xa8315e=new GoogleGenerativeAI(_0x4f5485),_0x1a8d89=_0xa8315e[_0x692fa8(0x27b)]({'model':GEMINI_MODEL}),_0x16bf9b=await _0x1a8d89['generateContent']('Hi');this[_0x692fa8(0x201)](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259[_0x692fa8(0x29e)],{'success':!![],'message':_0x692fa8(0x2f5)+_0x16bf9b[_0x692fa8(0x31b)][_0x692fa8(0x22a)]()},_0x4d2259[_0x692fa8(0x248)]);}catch(_0x308210){this['sendTo'](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259[_0x692fa8(0x29e)],{'success':![],'message':_0x692fa8(0x324)+_0x308210['message']},_0x4d2259[_0x692fa8(0x248)]);}}else{if(_0x4d2259['command']===_0x692fa8(0x1e2)){const _0x50fbfe=await getWeatherContext(this),_0x507b02=await getCalendarContext(this);this[_0x692fa8(0x201)](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259['command'],{'success':!![],'weather':_0x50fbfe,'calendar':_0x507b02},_0x4d2259[_0x692fa8(0x248)]);}else{if(_0x4d2259['command']===_0x692fa8(0x2c8)){if(!this[_0x692fa8(0x20c)])return this[_0x692fa8(0x201)](_0x4d2259['from'],_0x4d2259['command'],{'success':![],'isPro':![]},_0x4d2259[_0x692fa8(0x248)]);let _0x1ede17={'status':_0x692fa8(0x2f0)};try{const _0x391447=await this[_0x692fa8(0x1c4)](LTM_DP_DRIFT_STATUS);_0x1ede17[_0x692fa8(0x207)]=_0x391447?_0x391447['val']:'N/A';}catch(_0xbbb979){}this[_0x692fa8(0x201)](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259[_0x692fa8(0x29e)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x1ede17,'analysisHistory':this[_0x692fa8(0x311)]},_0x4d2259[_0x692fa8(0x248)]);}else{if(_0x4d2259[_0x692fa8(0x29e)]==='getOverviewData'){const _0x2923cb=this['dailyDigests'][_0x692fa8(0x24a)],_0x349fd5=new Date(),_0x2c8138=new Date(_0x349fd5[_0x692fa8(0x2e2)](),_0x349fd5[_0x692fa8(0x343)](),_0x349fd5[_0x692fa8(0x35a)]())[_0x692fa8(0x2a6)](),_0x1c3a37=this[_0x692fa8(0x35e)][_0x692fa8(0x2eb)](_0x40698a=>new Date(_0x40698a[_0x692fa8(0x2ed)])['getTime']()>_0x2c8138)['length'],_0x4975d1=new Array(0x18)['fill'](0x0);this[_0x692fa8(0x35e)]['forEach'](_0x378a7e=>{const _0x2f27b1=_0x692fa8,_0x2e953b=new Date(_0x378a7e[_0x2f27b1(0x2ed)]);if(_0x2e953b[_0x2f27b1(0x2a6)]()>_0x2c8138)_0x4975d1[_0x2e953b[_0x2f27b1(0x20b)]()]++;});let _0x213a5c={'status':'N/A'};try{const _0x5a3578=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x213a5c['status']=_0x5a3578?_0x5a3578['val']:_0x692fa8(0x2f0);}catch(_0x3a3a79){}let _0x138f22='';try{const _0x20f842=await this['getStateAsync'](_0x692fa8(0x330));_0x138f22=_0x20f842?_0x20f842['val']:'';}catch(_0x58a013){}let _0x5185d=null;!this[_0x692fa8(0x260)]&&(_0x5185d=this['config']['geminiApiKey']?'KI-Modell\x20nicht\x20initialisiert':_0x692fa8(0x33b));let _0xbf3c77={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x2da2ca=await this[_0x692fa8(0x1c4)](_0x692fa8(0x350));if(_0x2da2ca&&_0x2da2ca[_0x692fa8(0x22d)]){_0xbf3c77[_0x692fa8(0x2e1)]=!![];const _0x1a9eac=await this[_0x692fa8(0x1c4)](_0x692fa8(0x2d1));_0xbf3c77['description']=_0x1a9eac?_0x1a9eac[_0x692fa8(0x22d)]:'';const _0x1480e1=await this[_0x692fa8(0x1c4)]('analysis.automation.targetId');_0xbf3c77[_0x692fa8(0x2dd)]=_0x1480e1?_0x1480e1[_0x692fa8(0x22d)]:'';const _0x5222a7=await this[_0x692fa8(0x1c4)](_0x692fa8(0x29c));_0xbf3c77['targetValue']=_0x5222a7?_0x5222a7[_0x692fa8(0x22d)]:'';}const _0x7f8405=await this[_0x692fa8(0x1c4)](_0x692fa8(0x347));_0xbf3c77[_0x692fa8(0x288)]=_0x7f8405?!!_0x7f8405[_0x692fa8(0x22d)]:![];}catch(_0x3de6fd){}this[_0x692fa8(0x201)](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259['command'],{'success':!![],'eventHistory':this[_0x692fa8(0x319)][_0x692fa8(0x2d0)](0x0,0xf),'stats':{'digestCount':_0x2923cb,'eventCountToday':_0x1c3a37,'hourlyActivity':_0x4975d1,'driftStatus':_0x213a5c[_0x692fa8(0x207)],'isPresent':this['isPresent'],'presenceWho':_0x138f22,'minDays':this[_0x692fa8(0x1e1)][_0x692fa8(0x290)]||0x7,'stbDays':this[_0x692fa8(0x1e1)][_0x692fa8(0x271)]||0xe,'ltbDays':this['config'][_0x692fa8(0x289)]||0x3c,'systemError':_0x5185d},'automation':_0xbf3c77},_0x4d2259[_0x692fa8(0x248)]);}else{if(_0x4d2259[_0x692fa8(0x29e)]==='scanDevices')try{const _0x23818e=await scanForDevices(this,_0x4d2259[_0x692fa8(0x30b)]||{});this['sendTo'](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259[_0x692fa8(0x29e)],{'success':!![],'devices':_0x23818e},_0x4d2259[_0x692fa8(0x248)]);}catch(_0x1250c2){this[_0x692fa8(0x201)](_0x4d2259['from'],_0x4d2259['command'],{'success':![],'error':_0x1250c2[_0x692fa8(0x30b)]},_0x4d2259[_0x692fa8(0x248)]);}else{if(_0x4d2259[_0x692fa8(0x29e)]==='getEnums'){const _0x587ee6=await this[_0x692fa8(0x1e5)](_0x692fa8(0x254),_0x692fa8(0x2e3)),_0x2355d2=[];if(_0x587ee6)for(const _0x417428 in _0x587ee6){const _0x25c2ee=_0x587ee6[_0x417428],_0x152ac5=(_0x25c2ee[_0x692fa8(0x2aa)]&&typeof _0x25c2ee[_0x692fa8(0x2aa)]['name']==='object'?_0x25c2ee['common']['name']['de']:_0x25c2ee['common'][_0x692fa8(0x27f)])||_0x25c2ee['common'][_0x692fa8(0x27f)];_0x2355d2[_0x692fa8(0x234)]({'id':_0x417428,'name':_0x152ac5});}this[_0x692fa8(0x201)](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259[_0x692fa8(0x29e)],{'success':!![],'enums':_0x2355d2},_0x4d2259['callback']);}else{if(_0x4d2259[_0x692fa8(0x29e)]==='getCalendarNames'){const _0x11f7da=_0x4d2259['message'][_0x692fa8(0x220)];if(!_0x11f7da)return this[_0x692fa8(0x201)](_0x4d2259['from'],_0x4d2259[_0x692fa8(0x29e)],{'success':![],'error':_0x692fa8(0x265)},_0x4d2259[_0x692fa8(0x248)]);const _0x483473=await getCalendarNames(this,_0x11f7da);this[_0x692fa8(0x201)](_0x4d2259['from'],_0x4d2259[_0x692fa8(0x29e)],{'success':!![],'names':_0x483473},_0x4d2259['callback']);}else{if(_0x4d2259['command']===_0x692fa8(0x348)){const {targetId:_0x58eb4b,targetValue:_0x22291d}=_0x4d2259[_0x692fa8(0x30b)];this[_0x692fa8(0x2a4)][_0x692fa8(0x2c5)]('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0x58eb4b+'\x20=\x20'+_0x22291d),await this['setStateAsync'](_0x692fa8(0x350),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x692fa8(0x2d1),{'val':_0x692fa8(0x2a0)+_0x58eb4b,'ack':!![]}),await this[_0x692fa8(0x282)]('analysis.automation.targetId',{'val':_0x58eb4b,'ack':!![]}),await this[_0x692fa8(0x282)](_0x692fa8(0x29c),{'val':_0x22291d,'ack':!![]}),this[_0x692fa8(0x201)](_0x4d2259['from'],_0x4d2259[_0x692fa8(0x29e)],{'success':!![]},_0x4d2259[_0x692fa8(0x248)]);}else{if(_0x4d2259['command']==='submitFeedback'){const {historyId:_0x55478e,rating:_0x3de7b9,comment:_0x4cf03c,alertReason:_0xb88d8f}=_0x4d2259[_0x692fa8(0x30b)];_0x55478e&&_0x3de7b9?(await saveFeedback(this,{'timestamp':Date[_0x692fa8(0x2fc)](),'historyId':_0x55478e,'rating':_0x3de7b9,'comment':_0x4cf03c,'alertReason':_0xb88d8f}),this[_0x692fa8(0x201)](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259[_0x692fa8(0x29e)],{'success':!![]},_0x4d2259[_0x692fa8(0x248)])):this[_0x692fa8(0x201)](_0x4d2259['from'],_0x4d2259[_0x692fa8(0x29e)],{'success':![],'error':_0x692fa8(0x276)},_0x4d2259[_0x692fa8(0x248)]);}else _0x4d2259[_0x692fa8(0x29e)]===_0x692fa8(0x275)&&(this[_0x692fa8(0x2a4)][_0x692fa8(0x2c5)](_0x692fa8(0x353)),await this[_0x692fa8(0x282)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this['setStateAsync'](_0x692fa8(0x2d1),{'val':'','ack':!![]}),this[_0x692fa8(0x201)](_0x4d2259[_0x692fa8(0x2f3)],_0x4d2259[_0x692fa8(0x29e)],{'success':!![]},_0x4d2259[_0x692fa8(0x248)]));}}}}}}}}}}}if(require['main']!==module)module['exports']=_0x2ea9df=>new CogniLiving(_0x2ea9df);else new CogniLiving();