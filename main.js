const a0_0x1e5d0b=a0_0x3c4a;(function(_0x16aa90,_0x5eb88d){const _0x2a55e2=a0_0x3c4a,_0x178f1c=_0x16aa90();while(!![]){try{const _0x1ffbe3=parseInt(_0x2a55e2(0x1e5))/0x1*(-parseInt(_0x2a55e2(0x18c))/0x2)+-parseInt(_0x2a55e2(0x189))/0x3*(-parseInt(_0x2a55e2(0x236))/0x4)+-parseInt(_0x2a55e2(0x19d))/0x5+parseInt(_0x2a55e2(0x2cd))/0x6+-parseInt(_0x2a55e2(0x228))/0x7*(parseInt(_0x2a55e2(0x277))/0x8)+parseInt(_0x2a55e2(0x17d))/0x9*(-parseInt(_0x2a55e2(0x2a7))/0xa)+parseInt(_0x2a55e2(0x28b))/0xb;if(_0x1ffbe3===_0x5eb88d)break;else _0x178f1c['push'](_0x178f1c['shift']());}catch(_0x5e5fc9){_0x178f1c['push'](_0x178f1c['shift']());}}}(a0_0x4cb3,0xed01c));function a0_0x4cb3(){const _0x4e497c=['enum','toUpperCase','haust√ºr','value.humidity','isArray','wohn','0\x204\x20*\x20*\x20*','baselineDrift','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','2329542ZAbBYz','GUEST','channel','analysis.health.notes','join','val','analysis.isAlert','daswetter.','Schalter/Licht','PROCESS','guest','_score','974250WMtQbh','INSTALL_TEST','logDuplicates','2yKGgvH','config','material.','ack','onMessage','selectedFunctionIds','analysis.analysisHistory','Deaktiviert\x20(Pro-Feature)','reachable','currentSystemMode','detectionState','scanForDevices','vacation','city','dailyDigests','LTM.triggerDailyDigest','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','9369565tVxGrs','TEST-PRO-KEY','apiKey','@iobroker/adapter-core','k√ºche','automationProposal','signal','split','application/json','driftDetails','de-DE','common','WORKING','getObjectAsync','generic','checkLtmObjects','Fenster/T√ºr','Last\x20Check','smoke','info','lampe','analysis.triggerBriefing','K√ºche','analysis.isEmergency','lastCheck','trim','summary','object','modeResetJob','User\x20Feedback:\x20Alarm\x20\x22','.Summary.Current','2-digit','icon','flur','longitude','subscribeForeignStatesAsync','resetAnalysisStates','getForeignStateAsync','runGeminiAnalysis','isEmergency','system.','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','Drift\x20Status','analysis.trigger','driftAnalysisTimer','isAlert','toLocaleString','scriptProblem','isPresent','triggerDailyDigest','abortExitTimer','none','getStateAsync','scheduleJob','Baseline\x20Status','Fehler:\x20','link_quality','.data.text','LTM.driftAnalysis.baselineDrift','getForeignObjectsAsync','unload','last_seen','Analysis\x20Error:\x20','UNREACH','PRO-','getGenerativeModel','analysis.comfortSummary','Badezimmer','analysis.automation.description','description','\x20sent','unknown','1738105FxQfoB','Generating\x20Morning\x20Briefing...','constructor','setHours','geminiModel','isGracePeriodActive','system.config','battery','subscribeStates','Raw\x20Log','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','generateContent','analysis.history_debug_03','enum.functions.*','restlessness','pop','lastAlertState','lights','bad','toISOString','\x0a\x0aA\x20(STB):\x0a','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','events.history_debug_01','history','type','main','t√ºr','onUnload','LTM','ltmJob','Daily\x20Digest\x20created\x20successfully.','‚ö†Ô∏è\x20Alarm','VACATION','systemUUID','presence','ON_TIME','some','native','javascript.0.script','feedbackHistory','Trigger\x20Digest','Temperatur','licht','comfort','enum.rooms.*','getCalendarContext','loadRawEventLog','button','string','toLowerCase','onStateChange','rawEventLog','Starting\x20Autopilot\x20(','catch','role','getSystemUUID','sendNotification','Garten','daswetter','version','events.history_debug_00','activity','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','status','includes','hue','openweathermap.0','14287GhUNfL','diele','Gemini\x20Init\x20Error:\x20','AES_KEY','Analysiere\x20Tag...','Schlafzimmer','isExit','Creating\x20Daily\x20Digest\x20from\x20','process','parse','0\x203\x20*\x20*\x20*','setupModeResetScheduler','sat','stringify','20rbMTDL','message','slice','ERROR_CODE','state','switch.light','\x20*\x20*\x20*','test','command','normal','testApiKey','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','WEEK_PROGRAM','\x22\x20was\x20','eventHistory','analysisTimer','fire','setupLtmScheduler','startExitTimer','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','livingContext','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','motion','Scheduling\x20Morning\x20Briefing\x20for\x20','COMBINED_PARAMETER','\x20sensors...','temp','.\x20PR√ÑSENZ:\x20','Bewegung','getEnums','LTM.driftAnalysis.lastCheck','LTM.rawEventLog','\x20min).\x20Watchdog\x20Limit:\x20','date','accuweather.','genAI','analysis.health.sleepScore','events.history_debug_04','PARTY','NORMAL','Missing\x20data','analysisHistory','\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}','activityLevel','loadDailyDigests','namespace','No\x20recent\x20activity.','STICKY_UNREACH','find','exitGraceTimer','log','accuweather.0','json','FAULT','notes','setPresence','error','Processing\x20Status','schlaf','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20','startsWith','CONFIG_PENDING','bewegung','weatherunderground.0','1304Woiipk','level','toFixed','flot.','write','setState','sendTo','last\x20action','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','patternDetected','(((.+)+)+)+$','08:00','systemConfig','apply','mode','geminiApiKey','archetype','value.temperature','sleepScore','LTM.baselineStatus','47990437zNMotS','\x20presence\x20devices...','admin.','griff','setupBriefingScheduler','colormode','latitude','presenceDevices','analysis.history_debug_01','system.mode','doors','events.history_debug_03','analysis.history_debug_02','briefingJob','push','analysis.comfortSuggestion','number','Baseline:\x20Inactive\x20(Pro\x20Feature).','text','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','minDaysForBaseline','sensorLastValues','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','DIRECTION','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','analysis.activitySummary','Licht','update','60VfoWdh','yr.','length','testNotification','toString','members','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','analysis.alertReason','Gemini\x20AI\x20initialized.','modelid','Aktiv\x20(','\x0aFEEDBACK:\x0a','replace','exitTimer','connection','wind','licenseKey','mac\x20address','[Test]\x20Notification','Daily\x20Digests','health','LTM.dailyDigests','WETTER:\x20Keine\x20Daten\x20(Adapter\x20aktiv,\x20aber\x20kein\x20Wert)','sensor.door','Drift\x20Details','submitFeedback','@google/generative-ai','checkLicense','useWeather','runAutopilot','now','response','calendarInstance','ltmStbWindowDays','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','.\x20PERSONA:\x20','Morning\x20Briefing\x20sent.','aiPersona','2891952QZkTIL','isProVersion','Drift\x20Analysis','SABOTAGE','N/A\x20(No\x20Activity)','getWeatherContext','callback','loadSystemMode','inactivityThresholdHours','üö®üö®\x20NOTFALL','node-schedule','ERROR','daswetter.0','OPERATING_VOLTAGE','rating','system.meta.uuid','onReady','extendObjectAsync','effect','wetter','RSSI','briefingTime','analysis.lastResult','üåÖ\x20Daily\x20Briefing:\x0a','level.dimmer','getForeignObjectAsync','system.isPresent','testContext','analysis.deviationFromBaseline','name','createDailyDigest','models/gemini-flash-latest','.\x20ORT:\x20','\x20raw\x20events...','ALARM','cogni-living\x20adapter\x20starting\x20(v','unshift','briefingEnabled','sendMorningBriefing','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','N/A','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','CONNECTION','alert','DUTYCYCLE','sort','saveRawEventLog','firmware','.NextHours.Location_1.Day_1.current.symbol_desc','LTM.driftAnalysis','analysis.automation.patternDetected','checkWifiPresence','cogni-living','location','timestamp','manufacturer','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','weather','saveFeedback','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','LOWBAT','analysis.history_debug_04','capabilities','weatherInstance','deviationFromBaseline','event','boolean','uuid','devices','Wohnzimmer','wohnungst√ºr','from','cancel','analysisInterval','setStateAsync','map','ical.0','alertReason','accuweather','processSensorEvent','No\x20recorded\x20events\x20yet.','Briefing\x20Error:\x20','delObjectAsync','sensor.window','bind','temperatur','SECTION','filter'];a0_0x4cb3=function(){return _0x4e497c;};return a0_0x4cb3();}const a0_0x36e1cb=(function(){let _0x107151=!![];return function(_0x29b569,_0x19b11a){const _0x44025a=_0x107151?function(){const _0x5f13a4=a0_0x3c4a;if(_0x19b11a){const _0x4efd0e=_0x19b11a[_0x5f13a4(0x284)](_0x29b569,arguments);return _0x19b11a=null,_0x4efd0e;}}:function(){};return _0x107151=![],_0x44025a;};}()),a0_0xa558ab=a0_0x36e1cb(this,function(){const _0x40b858=a0_0x3c4a;return a0_0xa558ab['toString']()['search'](_0x40b858(0x281))[_0x40b858(0x2ab)]()[_0x40b858(0x1e7)](a0_0xa558ab)['search'](_0x40b858(0x281));});a0_0xa558ab();'use strict';const utils=require(a0_0x1e5d0b(0x1a0)),{GoogleGenerativeAI}=require(a0_0x1e5d0b(0x2c1)),schedule=require(a0_0x1e5d0b(0x2d7)),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x1e5d0b(0x13b),LTM_SCHEDULE=a0_0x1e5d0b(0x232),MODE_RESET_SCHEDULE=a0_0x1e5d0b(0x17a),LTM_DP_RAW_LOG=a0_0x1e5d0b(0x256),LTM_DP_DAILY_DIGESTS=a0_0x1e5d0b(0x2bc),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x1e5d0b(0x19b),LTM_DP_BASELINE_STATUS=a0_0x1e5d0b(0x28a),LTM_DP_DRIFT_CHANNEL=a0_0x1e5d0b(0x14d),LTM_DP_DRIFT_STATUS=a0_0x1e5d0b(0x1d7),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x1e5d0b(0x255),SYSTEM_DP_MODE=a0_0x1e5d0b(0x294),SYSTEM_MODES={'NORMAL':a0_0x1e5d0b(0x23f),'VACATION':a0_0x1e5d0b(0x198),'PARTY':'party','GUEST':a0_0x1e5d0b(0x187)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x1e5d0b(0x25d)],SYSTEM_MODES[a0_0x1e5d0b(0x17e)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':a0_0x1e5d0b(0x249),'family':'Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','single_comfort':a0_0x1e5d0b(0x2c9),'security':a0_0x1e5d0b(0x241)};function a0_0x3c4a(_0x5a1d46,_0x273170){const _0x50aea7=a0_0x4cb3();return a0_0x3c4a=function(_0xa558ab,_0x36e1cb){_0xa558ab=_0xa558ab-0x12d;let _0x4cb3ef=_0x50aea7[_0xa558ab];return _0x4cb3ef;},a0_0x3c4a(_0x5a1d46,_0x273170);}class CogniLiving extends utils['Adapter']{constructor(_0x4ed73a){const _0xf05636=a0_0x1e5d0b;super({..._0x4ed73a,'name':_0xf05636(0x150)}),this[_0xf05636(0x244)]=[],this[_0xf05636(0x260)]=[],this[_0xf05636(0x20c)]=[],this[_0xf05636(0x218)]=[],this[_0xf05636(0x19a)]=[],this[_0xf05636(0x2a0)]={},this[_0xf05636(0x283)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0xf05636(0x1cd)]=!![],this[_0xf05636(0x2b4)]=null,this[_0xf05636(0x268)]=null,this[_0xf05636(0x1ea)]=![],this[_0xf05636(0x25a)]=null,this['geminiModel']=null,this[_0xf05636(0x195)]=SYSTEM_MODES[_0xf05636(0x25e)],this['isProVersion']=![],this[_0xf05636(0x1f5)]=![],this[_0xf05636(0x206)]=_0xf05636(0x1e4),this[_0xf05636(0x245)]=null,this[_0xf05636(0x202)]=null,this['modeResetJob']=null,this[_0xf05636(0x1c9)]=null,this[_0xf05636(0x298)]=null,this['on']('ready',this[_0xf05636(0x2dd)][_0xf05636(0x170)](this)),this['on']('stateChange',this[_0xf05636(0x217)]['bind'](this)),this['on'](_0xf05636(0x1d9),this['onUnload'][_0xf05636(0x170)](this)),this['on'](_0xf05636(0x237),this['onMessage'][_0xf05636(0x170)](this));}async[a0_0x1e5d0b(0x2dd)](){const _0xebf8f7=a0_0x1e5d0b;this[_0xebf8f7(0x269)][_0xebf8f7(0x1b0)](_0xebf8f7(0x13f)+this[_0xebf8f7(0x220)]+')');const _0x44c3d1=['analysis.history_debug_00',_0xebf8f7(0x293),_0xebf8f7(0x297),_0xebf8f7(0x1f1),_0xebf8f7(0x159),_0xebf8f7(0x221),_0xebf8f7(0x1fb),'events.history_debug_02',_0xebf8f7(0x296),_0xebf8f7(0x25c)];for(const _0x2dfbb8 of _0x44c3d1){try{const _0x1dbf38=await this[_0xebf8f7(0x1aa)](_0x2dfbb8);_0x1dbf38&&await this[_0xebf8f7(0x16e)](_0x2dfbb8);}catch(_0x5618d9){}}this[_0xebf8f7(0x18d)]['licenseKey']=this[_0xebf8f7(0x18d)]['licenseKey']||'',this[_0xebf8f7(0x2ce)]=await this['checkLicense'](this[_0xebf8f7(0x18d)][_0xebf8f7(0x2b7)]);if(!this['config'][_0xebf8f7(0x2d5)]||this[_0xebf8f7(0x18d)][_0xebf8f7(0x2d5)]<0.1)this[_0xebf8f7(0x18d)][_0xebf8f7(0x2d5)]=0xc;await this['loadHistoryFromState']();try{const _0x4d72db=await this['getForeignObjectAsync'](_0xebf8f7(0x1eb));_0x4d72db&&_0x4d72db[_0xebf8f7(0x1a8)]&&(this[_0xebf8f7(0x283)]={'latitude':_0x4d72db['common'][_0xebf8f7(0x291)]||0x0,'longitude':_0x4d72db[_0xebf8f7(0x1a8)][_0xebf8f7(0x1bf)]||0x0,'city':_0x4d72db[_0xebf8f7(0x1a8)][_0xebf8f7(0x199)]||''});}catch(_0x31844b){}if(this[_0xebf8f7(0x18d)][_0xebf8f7(0x286)])try{this[_0xebf8f7(0x25a)]=new GoogleGenerativeAI(this['config'][_0xebf8f7(0x286)]),this['geminiModel']=this[_0xebf8f7(0x25a)][_0xebf8f7(0x1de)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xebf8f7(0x1a5)}}),this[_0xebf8f7(0x269)][_0xebf8f7(0x1b0)](_0xebf8f7(0x2af));}catch(_0x3f2a96){this[_0xebf8f7(0x269)]['error'](_0xebf8f7(0x22a)+_0x3f2a96[_0xebf8f7(0x237)]);}await this['createAllObjects'](),await this[_0xebf8f7(0x2d4)](),await this[_0xebf8f7(0x213)](),await this[_0xebf8f7(0x263)](),this[_0xebf8f7(0x1ed)]('analysis.trigger'),this[_0xebf8f7(0x1ed)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0xebf8f7(0x294)),this[_0xebf8f7(0x1ed)](_0xebf8f7(0x1b2));const _0x4e865d=this['config'][_0xebf8f7(0x160)];if(_0x4e865d&&_0x4e865d['length']>0x0){this['log']['info']('Subscribing\x20to\x20'+_0x4e865d[_0xebf8f7(0x2a9)]+_0xebf8f7(0x250));for(const _0x4b192e of _0x4e865d){if(_0x4b192e['id']){await this[_0xebf8f7(0x1c0)](_0x4b192e['id']);try{const _0x3e1cdd=await this[_0xebf8f7(0x1c2)](_0x4b192e['id']);if(_0x3e1cdd)this['sensorLastValues'][_0x4b192e['id']]=_0x3e1cdd[_0xebf8f7(0x182)];}catch(_0x4a300e){}}}}const _0x29c5ff=this['config']['presenceDevices']||[];if(_0x29c5ff['length']>0x0){this[_0xebf8f7(0x269)][_0xebf8f7(0x1b0)]('Subscribing\x20to\x20'+_0x29c5ff[_0xebf8f7(0x2a9)]+_0xebf8f7(0x28c));for(const _0x436620 of _0x29c5ff){await this[_0xebf8f7(0x1c0)](_0x436620);}await this[_0xebf8f7(0x14f)]();}if(this[_0xebf8f7(0x245)])clearInterval(this[_0xebf8f7(0x245)]);const _0x2c76ad=this['config'][_0xebf8f7(0x165)]||0xf;_0x2c76ad>0x0&&(this[_0xebf8f7(0x269)]['info'](_0xebf8f7(0x219)+_0x2c76ad+_0xebf8f7(0x257)+this[_0xebf8f7(0x18d)][_0xebf8f7(0x2d5)]+'h.'),this[_0xebf8f7(0x245)]=setInterval(()=>this[_0xebf8f7(0x2c4)](),_0x2c76ad*0x3c*0x3e8)),this[_0xebf8f7(0x247)](),this[_0xebf8f7(0x233)](),this['setupDriftAnalysisScheduler'](),this[_0xebf8f7(0x28f)]();}async[a0_0x1e5d0b(0x2d2)](){const _0x26ea7e=a0_0x1e5d0b;if(!this[_0x26ea7e(0x18d)][_0x26ea7e(0x2c3)])return'';let _0x3a33cc='';if(this[_0x26ea7e(0x18d)]['weatherInstance'])try{if(this[_0x26ea7e(0x18d)]['weatherInstance'][_0x26ea7e(0x225)](_0x26ea7e(0x16a))){const _0x3f4011=await this['getForeignStateAsync'](this[_0x26ea7e(0x18d)][_0x26ea7e(0x15b)]+'.Summary.Current');if(_0x3f4011&&_0x3f4011['val'])_0x3a33cc=_0x3f4011[_0x26ea7e(0x182)];}else{if(this[_0x26ea7e(0x18d)][_0x26ea7e(0x15b)][_0x26ea7e(0x225)](_0x26ea7e(0x21f))){const _0x4efc84=await this[_0x26ea7e(0x1c2)](this['config'][_0x26ea7e(0x15b)]+_0x26ea7e(0x14c));if(_0x4efc84&&_0x4efc84[_0x26ea7e(0x182)])_0x3a33cc=_0x4efc84[_0x26ea7e(0x182)];}else{if(this[_0x26ea7e(0x18d)][_0x26ea7e(0x15b)][_0x26ea7e(0x225)]('openweathermap')){const _0xeacb67=await this[_0x26ea7e(0x1c2)](this['config'][_0x26ea7e(0x15b)]+'.forecast.current.state');if(_0xeacb67&&_0xeacb67['val'])_0x3a33cc=_0xeacb67[_0x26ea7e(0x182)];}}}}catch(_0x436276){}if(!_0x3a33cc){const _0x332dc1=[_0x26ea7e(0x26a),_0x26ea7e(0x2d9),_0x26ea7e(0x276),_0x26ea7e(0x227)];for(const _0x41c5c4 of _0x332dc1){try{const _0x225433=await this[_0x26ea7e(0x135)](_0x41c5c4);if(_0x225433){if(_0x41c5c4[_0x26ea7e(0x225)](_0x26ea7e(0x16a))){const _0x563e26=await this[_0x26ea7e(0x1c2)](_0x41c5c4+_0x26ea7e(0x1bb));if(_0x563e26){_0x3a33cc=_0x563e26[_0x26ea7e(0x182)];break;}}}}catch(_0x1be4a5){}}}return _0x3a33cc?'WETTER:\x20'+_0x3a33cc:_0x26ea7e(0x2bd);}async[a0_0x1e5d0b(0x212)](){const _0x18dc7f=a0_0x1e5d0b;if(!this['config']['useCalendar'])return'';let _0x6be9c1='',_0x265936=this['config'][_0x18dc7f(0x2c7)]||_0x18dc7f(0x168);try{const _0x3ebbc4=await this[_0x18dc7f(0x1c2)](_0x265936+_0x18dc7f(0x1d6));if(_0x3ebbc4&&_0x3ebbc4[_0x18dc7f(0x182)])_0x6be9c1=_0x3ebbc4['val'];else{const _0x159303=await this[_0x18dc7f(0x1c2)](_0x265936+'.data.table');_0x159303&&_0x159303['val']&&Array[_0x18dc7f(0x178)](_0x159303[_0x18dc7f(0x182)])&&_0x159303[_0x18dc7f(0x182)][_0x18dc7f(0x2a9)]>0x0&&(_0x6be9c1=_0x159303['val']['slice'](0x0,0x3)['map'](_0x328abd=>_0x328abd[_0x18dc7f(0x258)]+'\x20'+_0x328abd[_0x18dc7f(0x15d)])[_0x18dc7f(0x181)](',\x20'));}}catch(_0x36fa5){}return _0x6be9c1?'KALENDER:\x20'+_0x6be9c1:'KALENDER:\x20Keine\x20Termine\x20gefunden';}async[a0_0x1e5d0b(0x197)](_0x4ab57e={}){const _0x36bc6a=a0_0x1e5d0b;this[_0x36bc6a(0x269)][_0x36bc6a(0x1b0)]('Starting\x20Smart\x20Scan\x20with\x20filters:\x20'+JSON[_0x36bc6a(0x235)](_0x4ab57e));const _0x4651dc=[],_0x3ae3c9=_0x4ab57e[_0x36bc6a(0x24d)]!==![],_0x5b7d7f=_0x4ab57e[_0x36bc6a(0x295)]!==![],_0x2155e3=_0x4ab57e[_0x36bc6a(0x1f6)]!==![],_0x41660c=_0x4ab57e['temperature']===!![],_0xb2ff26=_0x4ab57e[_0x36bc6a(0x155)]===!![],_0x570368=_0x4ab57e[_0x36bc6a(0x191)]||[],_0x1ceaba=await this[_0x36bc6a(0x1d8)](_0x36bc6a(0x211),_0x36bc6a(0x174)),_0x37df4d=await this[_0x36bc6a(0x1d8)](_0x36bc6a(0x1f2),'enum'),_0x15ad8f={},_0x4b7b27={},_0x53a2b0={},_0x159f91=(_0x33a761,_0x1aabcf,_0x298568=![])=>{const _0x5d87b5=_0x36bc6a;if(!_0x33a761)return;for(const _0x2e48ec in _0x33a761){const _0x5a0cb7=_0x33a761[_0x2e48ec];if(_0x5a0cb7&&_0x5a0cb7[_0x5d87b5(0x1a8)]&&_0x5a0cb7[_0x5d87b5(0x1a8)]['members']){const _0x312d07=(typeof _0x5a0cb7[_0x5d87b5(0x1a8)]['name']==='object'?_0x5a0cb7[_0x5d87b5(0x1a8)]['name']['de']:_0x5a0cb7['common'][_0x5d87b5(0x139)])||_0x5a0cb7[_0x5d87b5(0x1a8)][_0x5d87b5(0x139)];if(_0x298568)_0x53a2b0[_0x2e48ec]=_0x312d07;for(const _0x57e35f of _0x5a0cb7[_0x5d87b5(0x1a8)][_0x5d87b5(0x2ac)]){if(_0x298568){if(!_0x1aabcf[_0x57e35f])_0x1aabcf[_0x57e35f]=[];_0x1aabcf[_0x57e35f]['push'](_0x2e48ec);}else _0x1aabcf[_0x57e35f]=_0x312d07;}}}};_0x159f91(_0x1ceaba,_0x15ad8f),_0x159f91(_0x37df4d,_0x4b7b27,!![]);const _0xefb73a=await this[_0x36bc6a(0x1d8)]('*','state'),_0x28bc95=[_0x36bc6a(0x1dc),_0x36bc6a(0x158),_0x36bc6a(0x130),_0x36bc6a(0x2d8),_0x36bc6a(0x26c),_0x36bc6a(0x2d0),_0x36bc6a(0x13e),_0x36bc6a(0x274),_0x36bc6a(0x148),_0x36bc6a(0x1a9),_0x36bc6a(0x2a2),_0x36bc6a(0x266),_0x36bc6a(0x2da),'VIRTUAL_CHANNEL',_0x36bc6a(0x18a),_0x36bc6a(0x24f),_0x36bc6a(0x242),_0x36bc6a(0x208),_0x36bc6a(0x172),_0x36bc6a(0x239),_0x36bc6a(0x186),_0x36bc6a(0x22b),_0x36bc6a(0x146),_0x36bc6a(0x194),_0x36bc6a(0x1d5),_0x36bc6a(0x1ec),_0x36bc6a(0x2a6),_0x36bc6a(0x14b),_0x36bc6a(0x220),_0x36bc6a(0x2b5),_0x36bc6a(0x1b0),_0x36bc6a(0x1a3),_0x36bc6a(0x1da),_0x36bc6a(0x27e),_0x36bc6a(0x287),_0x36bc6a(0x147),_0x36bc6a(0x285),_0x36bc6a(0x290),_0x36bc6a(0x12e),'xy','ct',_0x36bc6a(0x226),_0x36bc6a(0x234),'productname',_0x36bc6a(0x153),_0x36bc6a(0x2b0),'uniqueid',_0x36bc6a(0x23e),_0x36bc6a(0x2b8),'description',_0x36bc6a(0x15a),_0x36bc6a(0x230),'scriptEnabled',_0x36bc6a(0x1cc),_0x36bc6a(0x20b),_0x36bc6a(0x196),'summary',_0x36bc6a(0x1bd),_0x36bc6a(0x1fc),'forecast',_0x36bc6a(0x1b0),_0x36bc6a(0x26b)];if(!_0xb2ff26)_0x28bc95[_0x36bc6a(0x299)](_0x36bc6a(0x12f),_0x36bc6a(0x155),_0x36bc6a(0x2b6),'pressure','uv','rain','precip');const _0x23fa17=[_0x36bc6a(0x1c5),_0x36bc6a(0x28d),'info.','vis.','history.',_0x36bc6a(0x18e),'icons-mfd.',_0x36bc6a(0x27a)];if(!_0xb2ff26)_0x23fa17['push'](_0x36bc6a(0x184),'weatherunderground.',_0x36bc6a(0x259),_0x36bc6a(0x2a8),'openweathermap.');const _0x372368=(_0x5bc7a3,_0x34a404,_0x1a23a0=![])=>{const _0x1c5202=_0x36bc6a,_0x3d1842=_0x5bc7a3['split']('.');if(_0x34a404[_0x5bc7a3])return _0x34a404[_0x5bc7a3];if(_0x3d1842['length']>0x2&&_0x34a404[_0x3d1842[_0x1c5202(0x238)](0x0,-0x1)['join']('.')])return _0x34a404[_0x3d1842[_0x1c5202(0x238)](0x0,-0x1)[_0x1c5202(0x181)]('.')];if(_0x3d1842['length']>0x3&&_0x34a404[_0x3d1842[_0x1c5202(0x238)](0x0,-0x2)['join']('.')])return _0x34a404[_0x3d1842['slice'](0x0,-0x2)['join']('.')];return _0x1a23a0?[]:null;};for(const _0x49aad5 in _0xefb73a){const _0x12bd5c=_0xefb73a[_0x49aad5];if(!_0x12bd5c||!_0x12bd5c[_0x36bc6a(0x1a8)])continue;if(_0x23fa17[_0x36bc6a(0x209)](_0x57c4df=>_0x49aad5[_0x36bc6a(0x273)](_0x57c4df)))continue;const _0x5e8a27=_0x12bd5c[_0x36bc6a(0x1a8)][_0x36bc6a(0x21b)]||'',_0x176e46=(_0x12bd5c[_0x36bc6a(0x1a8)][_0x36bc6a(0x139)]&&typeof _0x12bd5c[_0x36bc6a(0x1a8)]['name']===_0x36bc6a(0x1b8)?_0x12bd5c['common'][_0x36bc6a(0x139)]['de']:_0x12bd5c[_0x36bc6a(0x1a8)][_0x36bc6a(0x139)])||'',_0x34f9f7=_0x176e46?_0x176e46[_0x36bc6a(0x216)]():'',_0x29eeb3=_0x49aad5[_0x36bc6a(0x216)](),_0x43751e=_0x372368(_0x49aad5,_0x15ad8f),_0x5b6455=_0x372368(_0x49aad5,_0x4b7b27,!![]);let _0x1c627a=null,_0x521dc8=![];if(_0x5b6455&&_0x5b6455[_0x36bc6a(0x2a9)]>0x0){const _0x4ca414=_0x5b6455[_0x36bc6a(0x267)](_0x446dfc=>_0x570368[_0x36bc6a(0x225)](_0x446dfc));if(_0x4ca414){_0x521dc8=!![];const _0x25ca6e=_0x53a2b0[_0x4ca414];if(_0x29eeb3[_0x36bc6a(0x225)](_0x36bc6a(0x207))||_0x29eeb3['includes'](_0x36bc6a(0x24d)))_0x1c627a=_0x36bc6a(0x253);else{if(_0x29eeb3[_0x36bc6a(0x225)](_0x36bc6a(0x1af))||_0x29eeb3[_0x36bc6a(0x225)](_0x36bc6a(0x246))||_0x34f9f7[_0x36bc6a(0x225)]('rauch'))_0x1c627a='Rauchmelder';else{if(_0x29eeb3[_0x36bc6a(0x225)](_0x36bc6a(0x23a))||_0x29eeb3[_0x36bc6a(0x225)](_0x36bc6a(0x278))||_0x29eeb3['includes']('on'))_0x1c627a=_0x36bc6a(0x185);else _0x1c627a=_0x25ca6e;}}}}if(!_0x521dc8&&!_0xb2ff26){if(_0x28bc95[_0x36bc6a(0x209)](_0x173c83=>_0x34f9f7[_0x36bc6a(0x225)](_0x173c83)||_0x49aad5[_0x36bc6a(0x175)]()[_0x36bc6a(0x225)](_0x173c83)))continue;}if(!_0x1c627a&&_0x3ae3c9){if(_0x5e8a27[_0x36bc6a(0x225)]('sensor.motion')||_0x5e8a27[_0x36bc6a(0x225)]('occupancy')||_0x34f9f7['includes'](_0x36bc6a(0x275))||_0x34f9f7[_0x36bc6a(0x225)]('pr√§senz'))_0x1c627a='Bewegung';}!_0x1c627a&&_0x5b7d7f&&((_0x29eeb3[_0x36bc6a(0x225)]('shutter_contact')||_0x5e8a27[_0x36bc6a(0x225)](_0x36bc6a(0x2be))||_0x5e8a27[_0x36bc6a(0x225)](_0x36bc6a(0x16f))||(_0x34f9f7[_0x36bc6a(0x225)]('fenster')||_0x34f9f7[_0x36bc6a(0x225)]('t√ºr'))&&!_0x34f9f7['includes'](_0x36bc6a(0x251))&&!_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x28e))&&(_0x12bd5c[_0x36bc6a(0x1a8)][_0x36bc6a(0x1fd)]===_0x36bc6a(0x15e)||_0x12bd5c[_0x36bc6a(0x1a8)][_0x36bc6a(0x1fd)]===_0x36bc6a(0x29b)))&&(_0x1c627a=_0x36bc6a(0x1ad)));if(!_0x1c627a&&_0x2155e3){if((_0x5e8a27[_0x36bc6a(0x225)](_0x36bc6a(0x23b))||_0x5e8a27[_0x36bc6a(0x225)](_0x36bc6a(0x134))||_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x20f))||_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x1b1)))&&_0x12bd5c[_0x36bc6a(0x1a8)][_0x36bc6a(0x27b)])_0x1c627a=_0x36bc6a(0x2a5);}if(!_0x1c627a&&_0x41660c){if(_0x5e8a27[_0x36bc6a(0x225)](_0x36bc6a(0x288))||_0x5e8a27[_0x36bc6a(0x225)](_0x36bc6a(0x177))||_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x171)))_0x1c627a=_0x36bc6a(0x20e);}if(_0x1c627a){let _0x2f7221=_0x43751e||'';if(!_0x2f7221){if(_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x1f7)))_0x2f7221=_0x36bc6a(0x1e0);else{if(_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x1a1)))_0x2f7221=_0x36bc6a(0x1b3);else{if(_0x34f9f7['includes'](_0x36bc6a(0x179)))_0x2f7221=_0x36bc6a(0x161);else{if(_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x271)))_0x2f7221=_0x36bc6a(0x22d);else{if(_0x34f9f7['includes'](_0x36bc6a(0x1be))||_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x229)))_0x2f7221='Flur';else{if(_0x34f9f7[_0x36bc6a(0x225)]('garten'))_0x2f7221=_0x36bc6a(0x21e);}}}}}}let _0x128db2=![];_0x1c627a==='Fenster/T√ºr'&&((_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x176))||_0x34f9f7[_0x36bc6a(0x225)]('eingang')||_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x162))||_0x2f7221&&_0x2f7221['toLowerCase']()[_0x36bc6a(0x225)](_0x36bc6a(0x1be))&&_0x34f9f7[_0x36bc6a(0x225)](_0x36bc6a(0x1ff)))&&(_0x128db2=!![]));let _0x3903fb=0x0;if(_0x521dc8)_0x3903fb+=0x1e;else{if(_0x43751e)_0x3903fb+=0x14;else{if(_0x2f7221)_0x3903fb+=0xa;}}if(_0x128db2)_0x3903fb+=0x5;_0x4651dc[_0x36bc6a(0x299)]({'id':_0x49aad5,'name':_0x176e46||_0x49aad5,'type':_0x1c627a,'location':_0x2f7221,'logDuplicates':_0x1c627a===_0x36bc6a(0x253),'isExit':_0x128db2,'_score':_0x3903fb});}}return _0x4651dc[_0x36bc6a(0x149)]((_0x3e566b,_0x3ace77)=>_0x3ace77['_score']-_0x3e566b[_0x36bc6a(0x188)]),_0x4651dc;}async['checkWifiPresence'](){const _0x27b8ce=a0_0x1e5d0b,_0x4abafe=this[_0x27b8ce(0x18d)]['presenceDevices']||[];let _0x42ed17=![];for(const _0x20e3a2 of _0x4abafe){try{const _0x15bc63=await this[_0x27b8ce(0x1c2)](_0x20e3a2);if(_0x15bc63&&(_0x15bc63[_0x27b8ce(0x182)]===!![]||_0x15bc63['val']==='online'||_0x15bc63['val']===0x1)){_0x42ed17=!![];break;}}catch(_0x5beea6){}}return _0x42ed17&&(this['exitTimer']&&(this[_0x27b8ce(0x269)][_0x27b8ce(0x1b0)](_0x27b8ce(0x1fa)),this[_0x27b8ce(0x1cf)]()),!this[_0x27b8ce(0x1cd)]&&this[_0x27b8ce(0x195)]===SYSTEM_MODES[_0x27b8ce(0x25e)]&&this[_0x27b8ce(0x26e)](!![])),_0x42ed17;}async[a0_0x1e5d0b(0x217)](_0x4075ee,_0x2ab9ad){const _0x537dab=a0_0x1e5d0b;if(!_0x2ab9ad)return;if(_0x4075ee===this[_0x537dab(0x264)]+'.'+SYSTEM_DP_MODE){_0x2ab9ad[_0x537dab(0x182)]&&Object['values'](SYSTEM_MODES)[_0x537dab(0x225)](_0x2ab9ad[_0x537dab(0x182)])&&(this[_0x537dab(0x195)]=_0x2ab9ad[_0x537dab(0x182)],_0x2ab9ad[_0x537dab(0x182)]===SYSTEM_MODES[_0x537dab(0x205)]?this[_0x537dab(0x26e)](![]):this[_0x537dab(0x26e)](!![]));if(!_0x2ab9ad['ack'])this[_0x537dab(0x27c)](_0x4075ee,{'val':this[_0x537dab(0x195)],'ack':!![]});return;}if(!_0x2ab9ad[_0x537dab(0x18f)]){_0x4075ee[_0x537dab(0x225)](_0x537dab(0x1c8))&&_0x2ab9ad['val']&&(this[_0x537dab(0x27c)](_0x4075ee,{'val':![],'ack':!![]}),this[_0x537dab(0x1c3)]());if(_0x4075ee[_0x537dab(0x225)](_0x537dab(0x1ce))&&_0x2ab9ad['val']){this[_0x537dab(0x27c)](_0x4075ee,{'val':![],'ack':!![]});if(this['isProVersion'])this['createDailyDigest']();}_0x4075ee[_0x537dab(0x225)]('triggerBriefing')&&_0x2ab9ad[_0x537dab(0x182)]&&(this['setState'](_0x4075ee,{'val':![],'ack':!![]}),this[_0x537dab(0x142)]());return;}if(this['config'][_0x537dab(0x292)]&&this['config'][_0x537dab(0x292)][_0x537dab(0x225)](_0x4075ee)){await this[_0x537dab(0x14f)]();return;}const _0x164315=(this[_0x537dab(0x18d)][_0x537dab(0x160)]||[])[_0x537dab(0x267)](_0x39bfcd=>_0x39bfcd['id']===_0x4075ee);if(_0x164315)this['processSensorEvent'](_0x4075ee,_0x2ab9ad,_0x164315);}async[a0_0x1e5d0b(0x16b)](_0x16d71e,_0x3eca70,_0xc5dc4e){const _0x514198=a0_0x1e5d0b;if(!_0xc5dc4e[_0x514198(0x18b)]&&this[_0x514198(0x2a0)][_0x16d71e]===_0x3eca70[_0x514198(0x182)])return;this['sensorLastValues'][_0x16d71e]=_0x3eca70[_0x514198(0x182)];if(this['isGracePeriodActive'])return;const _0x19f7b1=await this[_0x514198(0x14f)]();if(_0x19f7b1){if(!this[_0x514198(0x1cd)])this['setPresence'](!![]);}else{const _0x300243=_0xc5dc4e[_0x514198(0x22e)]===!![];_0x300243?this['startExitTimer']():(this[_0x514198(0x2b4)]&&(this[_0x514198(0x269)][_0x514198(0x1b0)](_0x514198(0x145)),this['abortExitTimer']()),!this[_0x514198(0x1cd)]&&this[_0x514198(0x195)]===SYSTEM_MODES['NORMAL']&&this[_0x514198(0x26e)](!![]));}const _0x1dbf63={'timestamp':_0x3eca70['ts'],'id':_0x16d71e,'name':_0xc5dc4e['name'],'value':_0x3eca70[_0x514198(0x182)],'location':_0xc5dc4e[_0x514198(0x151)],'type':_0xc5dc4e[_0x514198(0x1fd)]};this[_0x514198(0x244)][_0x514198(0x140)](_0x1dbf63);if(this[_0x514198(0x244)][_0x514198(0x2a9)]>HISTORY_MAX_SIZE)this[_0x514198(0x244)][_0x514198(0x1f4)]();await this[_0x514198(0x166)]('events.lastEvent',{'val':JSON[_0x514198(0x235)](_0x1dbf63),'ack':!![]}),await this[_0x514198(0x166)]('events.history',{'val':JSON[_0x514198(0x235)](this[_0x514198(0x244)]),'ack':!![]}),this[_0x514198(0x218)][_0x514198(0x299)]({'timestamp':new Date(_0x3eca70['ts'])[_0x514198(0x1f8)](),'sensorName':_0xc5dc4e['name'],'location':_0xc5dc4e[_0x514198(0x151)],'value':_0x3eca70['val']}),await this[_0x514198(0x14a)]();}[a0_0x1e5d0b(0x248)](){const _0x594f8d=a0_0x1e5d0b;this[_0x594f8d(0x1cf)](),this[_0x594f8d(0x1ea)]=!![],this['exitGraceTimer']=setTimeout(()=>{const _0xf1425f=_0x594f8d;this[_0xf1425f(0x1ea)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x594f8d(0x2b4)]=setTimeout(()=>{const _0x18d08e=_0x594f8d;this[_0x18d08e(0x26e)](![]),this[_0x18d08e(0x2b4)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x1e5d0b(0x1cf)](){const _0x268f39=a0_0x1e5d0b;if(this['exitTimer'])clearTimeout(this[_0x268f39(0x2b4)]);if(this['exitGraceTimer'])clearTimeout(this[_0x268f39(0x268)]);this['exitTimer']=null,this[_0x268f39(0x268)]=null,this[_0x268f39(0x1ea)]=![];}async['setPresence'](_0x30bad9){const _0x3993bb=a0_0x1e5d0b;if(this[_0x3993bb(0x1cd)]===_0x30bad9)return;this[_0x3993bb(0x1cd)]=_0x30bad9,await this['setStateAsync'](_0x3993bb(0x136),{'val':_0x30bad9,'ack':!![]});}['runAutopilot'](){const _0x195ac3=a0_0x1e5d0b,_0x3f4b2e=this['config'][_0x195ac3(0x2d5)],_0x422608=this[_0x195ac3(0x18d)]['inactivityMonitoringEnabled'],_0x37e7be=this[_0x195ac3(0x244)][_0x195ac3(0x2a9)]>0x0?this['eventHistory'][0x0][_0x195ac3(0x152)]:Date[_0x195ac3(0x2c5)](),_0x4c6d39=(Date['now']()-_0x37e7be)/(0x3e8*0x3c*0x3c);let _0x1f7152='';_0x422608&&this[_0x195ac3(0x195)]===SYSTEM_MODES[_0x195ac3(0x25e)]&&this[_0x195ac3(0x1cd)]&&(_0x4c6d39>_0x3f4b2e&&(_0x1f7152=_0x195ac3(0x29e)+_0x4c6d39[_0x195ac3(0x279)](0x1)+'\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.'));if(_0x1f7152){this['runGeminiAnalysis'](_0x1f7152)[_0x195ac3(0x21a)](_0x35df0e=>this[_0x195ac3(0x269)][_0x195ac3(0x26f)](_0x35df0e));return;}const _0x2cc7cd=Date['now'](),_0x13c7da=_0x2cc7cd-_0x37e7be,_0x5716db=(this[_0x195ac3(0x18d)][_0x195ac3(0x165)]||0xf)*0x3c*0x3e8;this[_0x195ac3(0x244)][_0x195ac3(0x2a9)]>0x0&&_0x13c7da<=_0x5716db?this['runGeminiAnalysis']()['catch'](_0x2a8b4c=>this[_0x195ac3(0x269)]['error'](_0x2a8b4c)):!this[_0x195ac3(0x1f5)]&&(this[_0x195ac3(0x27c)](_0x195ac3(0x183),{'val':![],'ack':!![]}),this[_0x195ac3(0x27c)]('analysis.isEmergency',{'val':![],'ack':!![]}));}async[a0_0x1e5d0b(0x1c3)](_0x488ddd=''){const _0x2ec881=a0_0x1e5d0b;if(!this[_0x2ec881(0x1e9)])return;const _0x3bfd33=this[_0x2ec881(0x244)][_0x2ec881(0x2a9)]>0x0?this[_0x2ec881(0x244)]:[{'note':_0x2ec881(0x16c)}],_0x489416=PERSONA_MAPPING[this[_0x2ec881(0x18d)][_0x2ec881(0x2cc)]||_0x2ec881(0x1ab)],_0x2254c1=this[_0x2ec881(0x18d)]['livingContext']||'',_0x45f501=this['currentSystemMode'],_0x3797ed=await this['getWeatherContext'](),_0x36951f=await this['getCalendarContext'](),_0x366e56=(_0x3797ed+'\x20'+_0x36951f)[_0x2ec881(0x1b6)](),_0x11f5c2=new Date(),_0x5b3023=_0x11f5c2[_0x2ec881(0x1cb)](_0x2ec881(0x1a7),{'weekday':'long','hour':'2-digit','minute':_0x2ec881(0x1bc)}),_0x296b23=this['systemConfig'];let _0x204c0f='';if(this[_0x2ec881(0x20c)][_0x2ec881(0x2a9)]>0x0){const _0x338845=this[_0x2ec881(0x20c)]['slice'](0x0,0x3)[_0x2ec881(0x167)](_0x30c9d4=>_0x2ec881(0x1ba)+_0x30c9d4['alertReason']+_0x2ec881(0x243)+_0x30c9d4[_0x2ec881(0x2db)]+'.')[_0x2ec881(0x181)]('\x0a');_0x204c0f=_0x2ec881(0x2b2)+_0x338845+'\x0a';}const _0x263dd6=_0x488ddd?'\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a'+_0x488ddd+_0x2ec881(0x17c):'',_0x2307b=_0x2ec881(0x29c),_0xa7650a=_0x2ec881(0x2a1)+_0x5b3023+_0x2ec881(0x13c)+_0x296b23['city']+_0x2ec881(0x223)+_0x45f501+_0x2ec881(0x252)+(this[_0x2ec881(0x1cd)]?'Ja':'Nein')+_0x2ec881(0x1ef)+_0x2254c1+_0x2ec881(0x2ca)+_0x489416+_0x2ec881(0x24c)+_0x366e56+_0x2ec881(0x2ad)+_0x2307b+'\x20'+_0x204c0f+'\x20'+_0x263dd6+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20'+JSON[_0x2ec881(0x235)](_0x3bfd33)+_0x2ec881(0x1c6);try{const _0x1c7429=await this[_0x2ec881(0x1e9)]['generateContent'](_0xa7650a),_0x1fe246=_0x1c7429[_0x2ec881(0x2c6)]['text']()[_0x2ec881(0x2b3)](/```json|```/g,'')['trim'](),_0x289e17=JSON[_0x2ec881(0x231)](_0x1fe246);await this['setStateAsync'](_0x2ec881(0x132),{'val':_0x1fe246,'ack':!![]}),await this[_0x2ec881(0x166)](_0x2ec881(0x2ae),{'val':_0x289e17[_0x2ec881(0x222)]['alertReason']||'','ack':!![]}),await this[_0x2ec881(0x166)](_0x2ec881(0x2a4),{'val':_0x289e17[_0x2ec881(0x222)][_0x2ec881(0x1b7)]||_0x2ec881(0x144),'ack':!![]}),await this[_0x2ec881(0x166)](_0x2ec881(0x138),{'val':_0x289e17[_0x2ec881(0x222)][_0x2ec881(0x15c)]||_0x2ec881(0x144),'ack':!![]});_0x289e17[_0x2ec881(0x210)]&&(await this[_0x2ec881(0x166)](_0x2ec881(0x1df),{'val':_0x289e17['comfort'][_0x2ec881(0x1b7)]||'','ack':!![]}),await this[_0x2ec881(0x166)](_0x2ec881(0x29a),{'val':_0x289e17[_0x2ec881(0x210)]['suggestion']||'','ack':!![]}),_0x289e17[_0x2ec881(0x210)]['automationProposal']&&(await this['setStateAsync'](_0x2ec881(0x14e),{'val':_0x289e17['comfort'][_0x2ec881(0x1a2)][_0x2ec881(0x280)]||![],'ack':!![]}),await this[_0x2ec881(0x166)](_0x2ec881(0x1e1),{'val':_0x289e17[_0x2ec881(0x210)][_0x2ec881(0x1a2)][_0x2ec881(0x1e2)]||'','ack':!![]}),await this[_0x2ec881(0x166)]('analysis.automation.suggestedAction',{'val':_0x289e17[_0x2ec881(0x210)]['automationProposal']['suggestedAction']||'','ack':!![]})));_0x289e17[_0x2ec881(0x2bb)]&&(await this[_0x2ec881(0x166)](_0x2ec881(0x25b),{'val':typeof _0x289e17[_0x2ec881(0x2bb)][_0x2ec881(0x289)]===_0x2ec881(0x29b)?_0x289e17[_0x2ec881(0x2bb)]['sleepScore']:0x0,'ack':!![]}),await this[_0x2ec881(0x166)]('analysis.health.restlessness',{'val':_0x289e17['health'][_0x2ec881(0x1f3)]||'none','ack':!![]}),await this[_0x2ec881(0x166)](_0x2ec881(0x180),{'val':_0x289e17[_0x2ec881(0x2bb)][_0x2ec881(0x26d)]||'','ack':!![]}));const _0xcbfc62=_0x289e17['activity'][_0x2ec881(0x1ca)]||![],_0x1ce2a4=_0x289e17[_0x2ec881(0x222)][_0x2ec881(0x1c4)]||![];if(_0xcbfc62||_0x1ce2a4){await this[_0x2ec881(0x166)](_0x2ec881(0x183),{'val':!![],'ack':!![]}),await this[_0x2ec881(0x166)](_0x2ec881(0x1b4),{'val':_0x1ce2a4,'ack':!![]});if(!this[_0x2ec881(0x1f5)]||_0x1ce2a4){const _0x34e08c=_0x1ce2a4?_0x2ec881(0x2d6):_0x2ec881(0x204);this[_0x2ec881(0x21d)](_0x34e08c+':\x20'+_0x289e17['activity'][_0x2ec881(0x169)],![],_0x1ce2a4);}}else await this[_0x2ec881(0x166)](_0x2ec881(0x183),{'val':![],'ack':!![]}),await this[_0x2ec881(0x166)](_0x2ec881(0x1b4),{'val':![],'ack':!![]});this[_0x2ec881(0x1f5)]=_0xcbfc62||_0x1ce2a4;const _0x2fcd1a={'timestamp':Date[_0x2ec881(0x2c5)](),'id':Date['now']()[_0x2ec881(0x2ab)](),'analysis':_0x289e17,'systemMode':_0x45f501,'isPro':this[_0x2ec881(0x2ce)]};this['updateAnalysisHistory'](_0x2fcd1a);}catch(_0x2cff47){this[_0x2ec881(0x269)][_0x2ec881(0x26f)](_0x2ec881(0x1db)+_0x2cff47[_0x2ec881(0x237)]);}}async[a0_0x1e5d0b(0x13a)](){const _0x1445da=a0_0x1e5d0b;if(!this['geminiModel']||this[_0x1445da(0x218)][_0x1445da(0x2a9)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x1445da(0x166)](LTM_DP_STATUS,{'val':_0x1445da(0x2a3),'ack':!![]});return;}this[_0x1445da(0x269)][_0x1445da(0x1b0)](_0x1445da(0x22f)+this['rawEventLog'][_0x1445da(0x2a9)]+_0x1445da(0x13d)),await this[_0x1445da(0x166)](LTM_DP_STATUS,{'val':_0x1445da(0x22c),'ack':!![]});const _0x27bdf4=this[_0x1445da(0x218)][_0x1445da(0x2a9)]>0x320?this[_0x1445da(0x218)]['slice'](this[_0x1445da(0x218)]['length']-0x320):this[_0x1445da(0x218)],_0x16384b=PERSONA_MAPPING[this[_0x1445da(0x18d)][_0x1445da(0x2cc)]||_0x1445da(0x1ab)],_0x13cfa8=_0x1445da(0x157)+_0x16384b+_0x1445da(0x143)+JSON[_0x1445da(0x235)](_0x27bdf4)+_0x1445da(0x261);try{const _0x66967b=await this[_0x1445da(0x1e9)][_0x1445da(0x1f0)](_0x13cfa8),_0x282505=_0x66967b[_0x1445da(0x2c6)][_0x1445da(0x29d)]()[_0x1445da(0x2b3)](/```json|```/g,'')[_0x1445da(0x1b6)](),_0x5bfa63=JSON[_0x1445da(0x231)](_0x282505),_0x2d7ec1={'timestamp':new Date()[_0x1445da(0x1f8)](),'eventCount':this[_0x1445da(0x218)][_0x1445da(0x2a9)],'summary':_0x5bfa63['summary'],'activityLevel':_0x5bfa63[_0x1445da(0x262)],'health':{'sleepScore':_0x5bfa63[_0x1445da(0x2bb)]?_0x5bfa63[_0x1445da(0x2bb)][_0x1445da(0x289)]:0x0,'restlessness':_0x5bfa63['health']?_0x5bfa63['health'][_0x1445da(0x1f3)]:_0x1445da(0x1d0)},'systemMode':this[_0x1445da(0x195)]};this['dailyDigests'][_0x1445da(0x299)](_0x2d7ec1),await this['saveDailyDigests'](),this[_0x1445da(0x218)]=[],await this[_0x1445da(0x14a)](),await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x1445da(0x154),'ack':!![]}),this[_0x1445da(0x269)][_0x1445da(0x1b0)](_0x1445da(0x203));}catch(_0x573494){this[_0x1445da(0x269)][_0x1445da(0x26f)]('Daily\x20Digest\x20Error:\x20'+_0x573494[_0x1445da(0x237)]),await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x1445da(0x1d4)+_0x573494[_0x1445da(0x237)],'ack':!![]});}}[a0_0x1e5d0b(0x28f)](){const _0x1b023b=a0_0x1e5d0b;if(this['briefingJob'])this[_0x1b023b(0x298)][_0x1b023b(0x164)]();if(!this[_0x1b023b(0x18d)][_0x1b023b(0x141)])return;const _0x2349fc=(this['config'][_0x1b023b(0x131)]||_0x1b023b(0x282))[_0x1b023b(0x1a4)](':'),_0x54fd87=parseInt(_0x2349fc[0x0])||0x8,_0x2648ba=parseInt(_0x2349fc[0x1])||0x0,_0xf71978=_0x2648ba+'\x20'+_0x54fd87+_0x1b023b(0x23c);this[_0x1b023b(0x269)][_0x1b023b(0x1b0)](_0x1b023b(0x24e)+_0x54fd87+':'+(_0x2648ba<0xa?'0'+_0x2648ba:_0x2648ba)),this[_0x1b023b(0x298)]=schedule[_0x1b023b(0x1d2)](_0xf71978,()=>{const _0x3d0043=_0x1b023b;this[_0x3d0043(0x142)]();});}async[a0_0x1e5d0b(0x142)](){const _0x33c9ae=a0_0x1e5d0b;if(!this[_0x33c9ae(0x1e9)])return;this[_0x33c9ae(0x269)][_0x33c9ae(0x1b0)](_0x33c9ae(0x1e6));const _0x14dfb5=this[_0x33c9ae(0x19a)][_0x33c9ae(0x2a9)]>0x0?this[_0x33c9ae(0x19a)][this[_0x33c9ae(0x19a)][_0x33c9ae(0x2a9)]-0x1]:null,_0x2cd593=_0x14dfb5&&_0x14dfb5['health']?_0x14dfb5[_0x33c9ae(0x2bb)]['sleepScore']:_0x33c9ae(0x144),_0x12492c=new Date();_0x12492c[_0x33c9ae(0x1e8)](0x4,0x0,0x0,0x0);const _0x273ef0=this[_0x33c9ae(0x244)][_0x33c9ae(0x173)](_0x18a770=>new Date(_0x18a770[_0x33c9ae(0x152)])>_0x12492c),_0x53c49d=PERSONA_MAPPING[this['config'][_0x33c9ae(0x2cc)]||_0x33c9ae(0x1ab)],_0x348ada=this[_0x33c9ae(0x18d)][_0x33c9ae(0x24a)]||'',_0x30075a=await this[_0x33c9ae(0x2d2)](),_0x3b3f4f=await this[_0x33c9ae(0x212)](),_0x284809=_0x33c9ae(0x27f)+_0x53c49d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20'+_0x348ada+_0x33c9ae(0x24b)+_0x30075a+'\x20'+_0x3b3f4f+_0x33c9ae(0x272)+_0x2cd593+'/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20'+JSON[_0x33c9ae(0x235)](_0x273ef0['slice'](0x0,0xa))+_0x33c9ae(0x19c);try{const _0x31b882=await this[_0x33c9ae(0x1e9)][_0x33c9ae(0x1f0)](_0x284809),_0x184af2=_0x33c9ae(0x133)+_0x31b882[_0x33c9ae(0x2c6)][_0x33c9ae(0x29d)]()['trim']();this['sendNotification'](_0x184af2),this[_0x33c9ae(0x269)][_0x33c9ae(0x1b0)](_0x33c9ae(0x2cb));}catch(_0x2c1a1d){this['log']['error'](_0x33c9ae(0x16d)+_0x2c1a1d['message']);}}async['updateBaselineStatus'](){const _0x41b98e=a0_0x1e5d0b;if(!this[_0x41b98e(0x2ce)]){await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x41b98e(0x193),'ack':!![]});return;}const _0x39ed93=this['dailyDigests'][_0x41b98e(0x2a9)]>=(this['config'][_0x41b98e(0x29f)]||0x7)?_0x41b98e(0x2b1)+this[_0x41b98e(0x19a)][_0x41b98e(0x2a9)]+'\x20Tage)':'Lernphase\x20('+this['dailyDigests'][_0x41b98e(0x2a9)]+'/'+(this['config'][_0x41b98e(0x29f)]||0x7)+')';await this[_0x41b98e(0x166)](LTM_DP_BASELINE_STATUS,{'val':_0x39ed93,'ack':!![]});}async['updateAnalysisHistory'](_0x391b94){const _0x179925=a0_0x1e5d0b;this[_0x179925(0x260)][_0x179925(0x140)](_0x391b94);if(this[_0x179925(0x260)]['length']>ANALYSIS_HISTORY_MAX_SIZE)this[_0x179925(0x260)][_0x179925(0x1f4)]();await this[_0x179925(0x166)](_0x179925(0x192),{'val':JSON[_0x179925(0x235)](this['analysisHistory']),'ack':!![]});}['setupModeResetScheduler'](){const _0x48df54=a0_0x1e5d0b;if(this[_0x48df54(0x1b9)])this[_0x48df54(0x1b9)][_0x48df54(0x164)]();this[_0x48df54(0x1b9)]=schedule[_0x48df54(0x1d2)](MODE_RESET_SCHEDULE,async()=>{const _0xe860a2=_0x48df54;await this['loadSystemMode'](),AUTO_RESET_MODES[_0xe860a2(0x225)](this[_0xe860a2(0x195)])&&await this[_0xe860a2(0x166)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}async[a0_0x1e5d0b(0x1c1)](){const _0x1ce420=a0_0x1e5d0b;await this[_0x1ce420(0x166)](_0x1ce420(0x2a4),{'val':_0x1ce420(0x265),'ack':!![]}),await this[_0x1ce420(0x166)](_0x1ce420(0x138),{'val':this[_0x1ce420(0x2ce)]?_0x1ce420(0x2d1):'N/A\x20(Pro\x20Feature)','ack':!![]}),await this[_0x1ce420(0x166)]('analysis.isAlert',{'val':![],'ack':!![]}),await this[_0x1ce420(0x166)](_0x1ce420(0x1b4),{'val':![],'ack':!![]}),this[_0x1ce420(0x1f5)]=![];}async[a0_0x1e5d0b(0x1ac)](){const _0x54d515=a0_0x1e5d0b;await this[_0x54d515(0x12d)](_0x54d515(0x201),{'type':_0x54d515(0x17f),'common':{'name':'LTM'},'native':{}}),await this[_0x54d515(0x12d)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x54d515(0x1ee),'type':_0x54d515(0x215),'role':_0x54d515(0x26b),'read':!![],'write':![]},'native':{}}),await this[_0x54d515(0x12d)](LTM_DP_DAILY_DIGESTS,{'type':_0x54d515(0x23a),'common':{'name':_0x54d515(0x2ba),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x54d515(0x12d)](LTM_DP_STATUS,{'type':_0x54d515(0x23a),'common':{'name':_0x54d515(0x270),'type':'string','role':_0x54d515(0x29d),'read':!![],'write':![]},'native':{}}),await this[_0x54d515(0x12d)](LTM_DP_TRIGGER_DIGEST,{'type':_0x54d515(0x23a),'common':{'name':_0x54d515(0x20d),'type':'boolean','role':_0x54d515(0x214),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x54d515(0x12d)](LTM_DP_BASELINE_STATUS,{'type':_0x54d515(0x23a),'common':{'name':_0x54d515(0x1d3),'type':'string','role':_0x54d515(0x29d),'read':!![],'write':![]},'native':{}});}async['checkLtmDriftObjects'](){const _0x4b8d63=a0_0x1e5d0b;await this[_0x4b8d63(0x12d)](LTM_DP_DRIFT_CHANNEL,{'type':_0x4b8d63(0x17f),'common':{'name':_0x4b8d63(0x2cf)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x4b8d63(0x23a),'common':{'name':_0x4b8d63(0x1c7),'type':'string','role':_0x4b8d63(0x23a),'read':!![],'write':![],'def':_0x4b8d63(0x144)},'native':{}}),await this[_0x4b8d63(0x12d)](LTM_DP_DRIFT_DETAILS,{'type':_0x4b8d63(0x23a),'common':{'name':_0x4b8d63(0x2bf),'type':_0x4b8d63(0x215),'role':_0x4b8d63(0x29d),'read':!![],'write':![]},'native':{}}),await this[_0x4b8d63(0x12d)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x4b8d63(0x23a),'common':{'name':_0x4b8d63(0x1ae),'type':_0x4b8d63(0x29b),'role':_0x4b8d63(0x258),'read':!![],'write':![]},'native':{}});}async['runBaselineDriftAnalysis'](){const _0x1320d7=a0_0x1e5d0b;if(!this['isProVersion']||!this[_0x1320d7(0x1e9)])return;const _0x32c5ee=this[_0x1320d7(0x18d)][_0x1320d7(0x2c8)]||0xe;if(this[_0x1320d7(0x19a)][_0x1320d7(0x2a9)]<_0x32c5ee+(this[_0x1320d7(0x18d)][_0x1320d7(0x29f)]||0x7)){await this[_0x1320d7(0x166)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x3bd3e3=this[_0x1320d7(0x19a)]['slice'](-_0x32c5ee),_0x53e21e=this['dailyDigests'][_0x1320d7(0x238)](0x0,this['dailyDigests'][_0x1320d7(0x2a9)]-_0x32c5ee),_0x33a3e6='ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a'+JSON[_0x1320d7(0x235)](_0x53e21e)+_0x1320d7(0x1f9)+JSON[_0x1320d7(0x235)](_0x3bd3e3);try{const _0x3cacd3=await this[_0x1320d7(0x1e9)][_0x1320d7(0x1f0)](_0x33a3e6),_0x3a0ed2=JSON[_0x1320d7(0x231)](_0x3cacd3[_0x1320d7(0x2c6)][_0x1320d7(0x29d)]()[_0x1320d7(0x2b3)](/```json|```/g,'')[_0x1320d7(0x1b6)]());_0x3a0ed2[_0x1320d7(0x17b)]&&(await this[_0x1320d7(0x166)](LTM_DP_DRIFT_STATUS,{'val':_0x3a0ed2['baselineDrift'],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x3a0ed2[_0x1320d7(0x1a6)],'ack':!![]}),await this[_0x1320d7(0x166)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x5bbb4c){}}async[a0_0x1e5d0b(0x2d4)](){const _0x1b71a1=a0_0x1e5d0b;try{const _0x2e9f39=await this['getStateAsync'](SYSTEM_DP_MODE);_0x2e9f39&&_0x2e9f39[_0x1b71a1(0x182)]&&Object['values'](SYSTEM_MODES)[_0x1b71a1(0x225)](_0x2e9f39['val'])?this[_0x1b71a1(0x195)]=_0x2e9f39[_0x1b71a1(0x182)]:(this[_0x1b71a1(0x195)]=SYSTEM_MODES[_0x1b71a1(0x25e)],await this[_0x1b71a1(0x166)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1b71a1(0x25e)],'ack':!![]}));}catch(_0x55d9f3){this[_0x1b71a1(0x195)]=SYSTEM_MODES[_0x1b71a1(0x25e)];}}async[a0_0x1e5d0b(0x21c)](){const _0x1851cf=a0_0x1e5d0b;try{const _0x5ce844=await this[_0x1851cf(0x135)](_0x1851cf(0x2dc));if(_0x5ce844&&_0x5ce844[_0x1851cf(0x20a)]&&_0x5ce844[_0x1851cf(0x20a)][_0x1851cf(0x15f)])return _0x5ce844[_0x1851cf(0x20a)][_0x1851cf(0x15f)];return'uuid-not-found';}catch(_0x837f1e){return'uuid-error';}}async[a0_0x1e5d0b(0x2c2)](_0x1785e0){const _0x1e9fdf=a0_0x1e5d0b;if(!_0x1785e0)return![];this['systemUUID']=await this['getSystemUUID']();if(_0x1785e0===_0x1e9fdf(0x19e)||_0x1785e0[_0x1e9fdf(0x273)](_0x1e9fdf(0x1dd)))return!![];return![];}[a0_0x1e5d0b(0x200)](_0x36caf7){const _0x1879ad=a0_0x1e5d0b;if(this['analysisTimer'])clearInterval(this[_0x1879ad(0x245)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x1879ad(0x1c9)]);if(this[_0x1879ad(0x202)])this[_0x1879ad(0x202)][_0x1879ad(0x164)]();if(this[_0x1879ad(0x1b9)])this[_0x1879ad(0x1b9)][_0x1879ad(0x164)]();if(this['briefingJob'])this['briefingJob']['cancel']();if(this[_0x1879ad(0x2b4)])clearTimeout(this[_0x1879ad(0x2b4)]);if(this[_0x1879ad(0x268)])clearTimeout(this['exitGraceTimer']);_0x36caf7();}async[a0_0x1e5d0b(0x190)](_0x356765){const _0x511f85=a0_0x1e5d0b;if(typeof _0x356765===_0x511f85(0x1b8)&&_0x356765[_0x511f85(0x237)]){if(_0x356765[_0x511f85(0x23e)]===_0x511f85(0x240)){if(!_0x356765[_0x511f85(0x237)][_0x511f85(0x19f)])return this['sendTo'](_0x356765[_0x511f85(0x163)],_0x356765[_0x511f85(0x23e)],{'success':![],'message':'No\x20Key'},_0x356765['callback']);try{const _0x1738bb=new GoogleGenerativeAI(_0x356765[_0x511f85(0x237)][_0x511f85(0x19f)])[_0x511f85(0x1de)]({'model':_0x511f85(0x13b)});await _0x1738bb[_0x511f85(0x1f0)](_0x511f85(0x23d)),this[_0x511f85(0x27d)](_0x356765[_0x511f85(0x163)],_0x356765['command'],{'success':!![],'message':'Success'},_0x356765[_0x511f85(0x2d3)]);}catch(_0x4ed7d0){this[_0x511f85(0x27d)](_0x356765[_0x511f85(0x163)],_0x356765[_0x511f85(0x23e)],{'success':![],'message':_0x4ed7d0[_0x511f85(0x237)]},_0x356765[_0x511f85(0x2d3)]);}}else{if(_0x356765[_0x511f85(0x23e)]===_0x511f85(0x2aa)){const _0x4a9da0=await this[_0x511f85(0x21d)](_0x511f85(0x2b9),!![]);this[_0x511f85(0x27d)](_0x356765[_0x511f85(0x163)],_0x356765[_0x511f85(0x23e)],{'success':_0x4a9da0>0x0,'message':_0x4a9da0+_0x511f85(0x1e3)},_0x356765[_0x511f85(0x2d3)]);}else{if(_0x356765['command']==='getLtmData'){if(!this[_0x511f85(0x2ce)])return this[_0x511f85(0x27d)](_0x356765[_0x511f85(0x163)],_0x356765[_0x511f85(0x23e)],{'success':![],'isPro':![]},_0x356765[_0x511f85(0x2d3)]);let _0x9ae00b={'status':_0x511f85(0x144),'details':'','lastCheck':0x0};try{_0x9ae00b[_0x511f85(0x224)]=(await this[_0x511f85(0x1d1)](LTM_DP_DRIFT_STATUS))[_0x511f85(0x182)],_0x9ae00b['details']=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x511f85(0x182)],_0x9ae00b[_0x511f85(0x1b5)]=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x511f85(0x182)];}catch(_0x24bcbc){}this['sendTo'](_0x356765[_0x511f85(0x163)],_0x356765[_0x511f85(0x23e)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x9ae00b,'analysisHistory':this['analysisHistory']},_0x356765[_0x511f85(0x2d3)]);}else{if(_0x356765[_0x511f85(0x23e)]===_0x511f85(0x254)){const _0x354f20=await this[_0x511f85(0x1d8)](_0x511f85(0x1f2),'enum'),_0x2168f2=[];if(_0x354f20)for(const _0x1f71dd in _0x354f20){const _0x5ccffc=_0x354f20[_0x1f71dd],_0x1b1fda=(_0x5ccffc[_0x511f85(0x1a8)]&&typeof _0x5ccffc[_0x511f85(0x1a8)][_0x511f85(0x139)]===_0x511f85(0x1b8)?_0x5ccffc['common'][_0x511f85(0x139)]['de']:_0x5ccffc[_0x511f85(0x1a8)][_0x511f85(0x139)])||_0x5ccffc[_0x511f85(0x1a8)][_0x511f85(0x139)];_0x2168f2[_0x511f85(0x299)]({'id':_0x1f71dd,'name':_0x1b1fda});}this[_0x511f85(0x27d)](_0x356765['from'],_0x356765[_0x511f85(0x23e)],{'success':!![],'enums':_0x2168f2},_0x356765[_0x511f85(0x2d3)]);}else{if(_0x356765[_0x511f85(0x23e)]==='scanDevices')try{const _0x34b02e=await this[_0x511f85(0x197)](_0x356765[_0x511f85(0x237)]||{});this[_0x511f85(0x27d)](_0x356765[_0x511f85(0x163)],_0x356765[_0x511f85(0x23e)],{'success':!![],'devices':_0x34b02e},_0x356765[_0x511f85(0x2d3)]);}catch(_0x554ebb){this[_0x511f85(0x27d)](_0x356765[_0x511f85(0x163)],_0x356765['command'],{'success':![],'error':_0x554ebb[_0x511f85(0x237)]},_0x356765[_0x511f85(0x2d3)]);}else{if(_0x356765[_0x511f85(0x23e)]===_0x511f85(0x2c0)){const {historyId:_0x1b4f3a,rating:_0x88b939,comment:_0x5eb0e4,alertReason:_0x2fc7b8}=_0x356765[_0x511f85(0x237)];_0x1b4f3a&&_0x88b939?(await this[_0x511f85(0x156)]({'timestamp':Date[_0x511f85(0x2c5)](),'historyId':_0x1b4f3a,'rating':_0x88b939,'comment':_0x5eb0e4,'alertReason':_0x2fc7b8}),this[_0x511f85(0x27d)](_0x356765[_0x511f85(0x163)],_0x356765[_0x511f85(0x23e)],{'success':!![]},_0x356765['callback'])):this['sendTo'](_0x356765[_0x511f85(0x163)],_0x356765[_0x511f85(0x23e)],{'success':![],'error':_0x511f85(0x25f)},_0x356765[_0x511f85(0x2d3)]);}else{if(_0x356765['command']===_0x511f85(0x137)){const _0x478cb4=await this[_0x511f85(0x2d2)](),_0x544585=await this['getCalendarContext']();this[_0x511f85(0x27d)](_0x356765['from'],_0x356765[_0x511f85(0x23e)],{'success':!![],'weather':_0x478cb4,'calendar':_0x544585},_0x356765[_0x511f85(0x2d3)]);}}}}}}}}}}if(require[a0_0x1e5d0b(0x1fe)]!==module)module['exports']=_0x4e6917=>new CogniLiving(_0x4e6917);else new CogniLiving();