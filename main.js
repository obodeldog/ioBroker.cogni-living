function a0_0x36c6(){const _0x45e660=['ready','getLtmData','26llieoG','\x20->\x20','getOverviewData','slice','pr√§senz','modeResetJob','cogni-living\x20adapter\x20starting\x20(v','telegram','getMonth','round','analysis.automation.description','analysis.automation.targetId','isProVersion','233uEWPZj','0\x204\x20*\x20*\x20*','setupLtmScheduler','‚ö†Ô∏è\x20Python\x20missing\x20libs.\x20Auto-Install\x20triggered.','cancel','parse',')\x20-\x20CLASS\x20MODE','LTM.baselineStatus','getStateAsync','‚ùå\x20PIP\x20INSTALL\x20FAILED:\x20','TRAINING_COMPLETE','ANALYZE_SEQUENCE','LTM.driftAnalysis.driftDetails','stateChange','üõ°Ô∏è\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','setStateAsync','info','requirements.txt','exitTimer','setupDriftAnalysisScheduler','üêç\x20Python\x20Pong','stdin','startsWith','TRAIN_HEALTH','object','runSecurityCheck','stringify','analysis.security.lastScore','length','command','type','briefingJob','getCalendarContext','Training\x20Error:\x20','includes','getHours','debug','20814AKoegC','initPresenceSubscriptions','namespace','geminiApiKey','Gemini\x20Init\x20Error:\x20','[RESULT]','toLowerCase','toISOString','Fokus\x20auf\x20Familienroutinen.','handlePythonResult','KI-Modell\x20nicht\x20initialisiert','loc','cpu_feature_guard','trim','ack','presenceDevices','checkLicense','forEach','analysisInterval','status','TRAIN_ENERGY','bind','onMessage','inactivityThresholdHours','analysis.training.triggerHealth','runGeminiAnalysis','toString','analysisHistory','getDate','Success:\x20','20azqftE','sequenceTimer','9112OmvgYL','python3\x20-m\x20venv\x20\x22','‚úÖ\x20HEALTH\x20TRAINED:\x20','405468jmsssV','Sec-Training\x20started...','vacation','isPresent','light','autoApply','üõ†Ô∏è\x20MAINTENANCE\x20MODE:\x20Installing\x20Python\x20dependencies.\x20Do\x20not\x20restart!','0\x203\x20*\x20*\x20*','targetId','loadDailyDigests','warn','heizung','analysis.automation.autoApply','timestamp','error','analysis.triggerBriefing','triggerBriefing','startExitTimer','exitGraceTimer','insulation','(((.+)+)+)+$','triggerDailyDigest','[PYTHON]\x20','scanDevices','unload','existsSync','window','üêç\x20Stopping\x20Python...','7715818eCxeDR','sendTo','getFullYear','initSensorSubscriptions','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','some','stdout','PARTY','write','system.mode','analysis.training.triggerEnergy','Scripts','recordSequence','constructor','system.presenceWho','substring','analysis.automation.targetValue','installRequirementsInVenv','analysis.energy.insulationScore','from','createAllObjects','now','LTM.trainingData.sequences','door','analysisTimer','analysis.health.isAnomaly','‚ùå\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv','Adapter','shift','presence','endsWith','licht','executeAutomationAction','search','genAI','dimmer','cogni-living','exports','rawEventLog','values','contact','checkWifiPresence','kontakt','communicate.request','motion','setPresence','Failed:\x20','join','fill','analysis.training.status','automation.triggerAction','unknown','unshift','783532SrdxMh','getOutsideTemperatureNumeric','PONG','onReady','heating','devices','installPythonDependencies','path','licenseKey','17874132CvSEAn','dependencyInstallInProgress','fenster','@google/generative-ai','isExit','GUEST','sendToPython','initZombies','LTM.dailyDigests','events.lastEvent','testApiKey','25gGVwGC','Error\x20launching\x20Python:\x20','apply','service.py','ENERGY_TRAIN_RESULT','systemUUID','dailyDigests','No\x20module\x20named','payload','initHistory','LTM.processingStatus','runAutopilot','geminiModel','startPythonService','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','ltmStbWindowDays','close','python_service','pythonProcess','Fokus\x20auf\x20Komfort.','6362NkmpQI','toLocaleTimeString','platform','lastAlertState','log','switch','setupTelegramListener','initSystemConfig','11511siNXbU','message','callback','setupModeResetScheduler','python3','application/json','@iobroker/adapter-core','analysis.isAlert','LTM.driftAnalysis','python','HEALTH_TRAIN_RESULT','activeSequence','value','logDuplicates','VACATION','feedbackHistory','‚ö†Ô∏è\x20VENV\x20missing.\x20Attempting\x20install...','getGenerativeModel','pip.exe','üß†\x20Triggering\x20Security\x20Training...','data','targetValue','eventHistory','description','analysis.training.triggerSecurity','push','ltmLtbWindowDays','bin','guest','driftAnalysisTimer','loadRawEventLog','systemConfig','split','LTM.driftAnalysis.lastCheck','setState','N/A','analysis.automation.patternDetected','analysis.trigger','processSensorEvent','getTime','stderr','NORMAL','detected','LTM.driftAnalysis.baselineDrift','val','saveCompletedSequence','recordThermodynamics','schalter','location','runPythonHealthCheck','ltmJob','PRIORIT√ÑT:\x20Gesundheit/AAL.','currentSystemMode','[RECORDER]\x20Error\x20saving\x20sequence:\x20','subscribeStates','kill','Analysiere\x20ausgewogen.','temperature','scanForDevices','[LOG]','isGracePeriodActive','[PYTHON\x20ERR]\x20','onUnload','2541iMEnYB','config','SECURITY_RESULT','sensorLastValues','klima','occupancy','setupBriefingScheduler','üêç\x20Using\x20VENV\x20Python:\x20'];a0_0x36c6=function(){return _0x45e660;};return a0_0x36c6();}const a0_0x498dfa=a0_0x154b;(function(_0x34e0b3,_0x132a97){const _0x90d6a1=a0_0x154b,_0x5eabf4=_0x34e0b3();while(!![]){try{const _0x592fba=-parseInt(_0x90d6a1(0x222))/0x1*(-parseInt(_0x90d6a1(0x1c4))/0x2)+-parseInt(_0x90d6a1(0x26a))/0x3+-parseInt(_0x90d6a1(0x2bb))/0x4*(parseInt(_0x90d6a1(0x1b0))/0x5)+-parseInt(_0x90d6a1(0x247))/0x6*(-parseInt(_0x90d6a1(0x20b))/0x7)+-parseInt(_0x90d6a1(0x267))/0x8*(-parseInt(_0x90d6a1(0x1cc))/0x9)+parseInt(_0x90d6a1(0x265))/0xa*(parseInt(_0x90d6a1(0x286))/0xb)+-parseInt(_0x90d6a1(0x1a5))/0xc*(parseInt(_0x90d6a1(0x215))/0xd);if(_0x592fba===_0x132a97)break;else _0x5eabf4['push'](_0x5eabf4['shift']());}catch(_0x45d3a9){_0x5eabf4['push'](_0x5eabf4['shift']());}}}(a0_0x36c6,0xbb214));const a0_0x4a4749=(function(){let _0x1f6f38=!![];return function(_0x131095,_0x164dcd){const _0x4cf49d=_0x1f6f38?function(){const _0x5865da=a0_0x154b;if(_0x164dcd){const _0x1ce36e=_0x164dcd[_0x5865da(0x1b2)](_0x131095,arguments);return _0x164dcd=null,_0x1ce36e;}}:function(){};return _0x1f6f38=![],_0x4cf49d;};}()),a0_0x41f64d=a0_0x4a4749(this,function(){const _0x3e653e=a0_0x154b;return a0_0x41f64d[_0x3e653e(0x261)]()[_0x3e653e(0x2a7)](_0x3e653e(0x27e))['toString']()[_0x3e653e(0x293)](a0_0x41f64d)[_0x3e653e(0x2a7)]('(((.+)+)+)+$');});a0_0x41f64d();'use strict';const utils=require(a0_0x498dfa(0x1d2)),{GoogleGenerativeAI}=require(a0_0x498dfa(0x1a8)),schedule=require('node-schedule'),{spawn,exec}=require('child_process'),path=require(a0_0x498dfa(0x2c2)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x498dfa(0x271),MODE_RESET_SCHEDULE=a0_0x498dfa(0x223),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x498dfa(0x1ad),LTM_DP_STATUS=a0_0x498dfa(0x1ba),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x498dfa(0x229),LTM_DP_DRIFT_CHANNEL=a0_0x498dfa(0x1d4),LTM_DP_DRIFT_STATUS=a0_0x498dfa(0x1f7),LTM_DP_DRIFT_DETAILS=a0_0x498dfa(0x22e),LTM_DP_DRIFT_LAST_CHECK=a0_0x498dfa(0x1ed),SYSTEM_DP_MODE=a0_0x498dfa(0x28f),SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x498dfa(0x26c),'PARTY':'party','GUEST':a0_0x498dfa(0x1e8)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x498dfa(0x28d)],SYSTEM_MODES[a0_0x498dfa(0x1aa)]],PERSONA_MAPPING={'generic':a0_0x498dfa(0x204),'senior_aal':a0_0x498dfa(0x1ff),'family':a0_0x498dfa(0x24f),'single_comfort':a0_0x498dfa(0x1c3),'security':'PRIORIT√ÑT:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x498dfa(0x1c6)]==='win32',VENV_PATH=path['join'](__dirname,'.venv'),PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x498dfa(0x291),'python.exe'):path['join'](VENV_PATH,a0_0x498dfa(0x1e7),a0_0x498dfa(0x1d5)),PIP_EXE=IS_WIN?path['join'](VENV_PATH,'Scripts',a0_0x498dfa(0x1de)):path[a0_0x498dfa(0x2b5)](VENV_PATH,a0_0x498dfa(0x1e7),'pip');function a0_0x154b(_0x9bf279,_0x3206c4){const _0xed1c3d=a0_0x36c6();return a0_0x154b=function(_0x41f64d,_0x4a4749){_0x41f64d=_0x41f64d-0x1a4;let _0x36c6a9=_0xed1c3d[_0x41f64d];return _0x36c6a9;},a0_0x154b(_0x9bf279,_0x3206c4);}class CogniLiving extends utils[a0_0x498dfa(0x2a1)]{constructor(_0x577fa4){const _0x34e6eb=a0_0x498dfa;super({..._0x577fa4,'name':_0x34e6eb(0x2aa)}),this[_0x34e6eb(0x1e2)]=[],this[_0x34e6eb(0x262)]=[],this[_0x34e6eb(0x1db)]=[],this[_0x34e6eb(0x2ac)]=[],this[_0x34e6eb(0x1b6)]=[],this['sensorLastValues']={},this[_0x34e6eb(0x1eb)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x34e6eb(0x26d)]=!![],this['exitTimer']=null,this[_0x34e6eb(0x27c)]=null,this[_0x34e6eb(0x208)]=![],this['genAI']=null,this[_0x34e6eb(0x1bc)]=null,this['currentSystemMode']=SYSTEM_MODES[_0x34e6eb(0x1f5)],this[_0x34e6eb(0x221)]=![],this[_0x34e6eb(0x1c7)]=![],this[_0x34e6eb(0x1b5)]=_0x34e6eb(0x2b9),this[_0x34e6eb(0x29e)]=null,this['ltmJob']=null,this[_0x34e6eb(0x21a)]=null,this[_0x34e6eb(0x1e9)]=null,this[_0x34e6eb(0x241)]=null,this[_0x34e6eb(0x1c2)]=null,this['dependencyInstallInProgress']=![],this[_0x34e6eb(0x1d7)]=[],this['sequenceTimer']=null,this['on'](_0x34e6eb(0x213),this['onReady'][_0x34e6eb(0x25c)](this)),this['on'](_0x34e6eb(0x22f),this['onStateChange']['bind'](this)),this['on'](_0x34e6eb(0x282),this[_0x34e6eb(0x20a)][_0x34e6eb(0x25c)](this)),this['on'](_0x34e6eb(0x1cd),this[_0x34e6eb(0x25d)]['bind'](this));}async[a0_0x498dfa(0x2be)](){const _0x143a71=a0_0x498dfa;this[_0x143a71(0x1c8)]['info'](_0x143a71(0x21b)+this['version']+_0x143a71(0x228)),await this[_0x143a71(0x1ac)](),this[_0x143a71(0x20c)][_0x143a71(0x1a4)]=this[_0x143a71(0x20c)][_0x143a71(0x1a4)]||'';try{this[_0x143a71(0x221)]=await this[_0x143a71(0x257)](this[_0x143a71(0x20c)][_0x143a71(0x1a4)]);}catch(_0x419480){}if(!this[_0x143a71(0x20c)][_0x143a71(0x25e)]||this[_0x143a71(0x20c)][_0x143a71(0x25e)]<0.1)this[_0x143a71(0x20c)][_0x143a71(0x25e)]=0xc;await this[_0x143a71(0x1b9)](),await this[_0x143a71(0x1cb)]();if(this[_0x143a71(0x20c)][_0x143a71(0x24a)])try{this[_0x143a71(0x2a8)]=new GoogleGenerativeAI(this[_0x143a71(0x20c)]['geminiApiKey']),this[_0x143a71(0x1bc)]=this['genAI'][_0x143a71(0x1dd)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x143a71(0x1d1)}}),this[_0x143a71(0x1c8)][_0x143a71(0x232)]('Gemini\x20AI\x20initialized.');}catch(_0x23a9bd){this['log']['error'](_0x143a71(0x24b)+_0x23a9bd[_0x143a71(0x1cd)]);}await this[_0x143a71(0x29a)](),await this['loadSystemMode'](),await this[_0x143a71(0x1ea)](),await this[_0x143a71(0x273)](),this[_0x143a71(0x202)]('analysis.trigger'),this[_0x143a71(0x202)](LTM_DP_TRIGGER_DIGEST),this[_0x143a71(0x202)]('system.mode'),this['subscribeStates'](_0x143a71(0x279)),this['subscribeStates']('analysis.automation.triggerAction'),this[_0x143a71(0x202)](_0x143a71(0x276)),this[_0x143a71(0x202)](_0x143a71(0x1e4)),this[_0x143a71(0x202)](_0x143a71(0x25f)),this[_0x143a71(0x202)](_0x143a71(0x290)),await this[_0x143a71(0x289)](),await this[_0x143a71(0x248)](),await this[_0x143a71(0x1ca)](),setTimeout(()=>this[_0x143a71(0x2af)](),0x1388);if(this[_0x143a71(0x29e)])clearInterval(this[_0x143a71(0x29e)]);const _0x233318=this[_0x143a71(0x20c)][_0x143a71(0x259)]||0xf;_0x233318>0x0&&(this['analysisTimer']=setInterval(()=>{const _0x3f84c4=_0x143a71;this[_0x3f84c4(0x1bb)]();},_0x233318*0x3c*0x3e8)),this[_0x143a71(0x224)](),this[_0x143a71(0x1cf)](),this[_0x143a71(0x235)](),this[_0x143a71(0x211)](),this[_0x143a71(0x1bd)](),setTimeout(()=>{const _0x47a366=_0x143a71;if(this[_0x47a366(0x1c2)])this[_0x47a366(0x1fd)]();},0x1388);}[a0_0x498dfa(0x20a)](_0x21d070){const _0x1dec97=a0_0x498dfa;if(this[_0x1dec97(0x29e)])clearInterval(this['analysisTimer']);if(this[_0x1dec97(0x1e9)])clearInterval(this['driftAnalysisTimer']);if(this[_0x1dec97(0x1fe)])this[_0x1dec97(0x1fe)][_0x1dec97(0x226)]();if(this[_0x1dec97(0x21a)])this['modeResetJob'][_0x1dec97(0x226)]();if(this['briefingJob'])this[_0x1dec97(0x241)]['cancel']();if(this[_0x1dec97(0x234)])clearTimeout(this['exitTimer']);if(this[_0x1dec97(0x27c)])clearTimeout(this['exitGraceTimer']);this['stopPythonService'](),_0x21d070();}async['onStateChange'](_0x28dc11,_0x2c65b8){const _0x1e3d30=a0_0x498dfa;if(!_0x2c65b8)return;if(this['dependencyInstallInProgress'])return;if(_0x28dc11[_0x1e3d30(0x244)](_0x1e3d30(0x21c))&&_0x28dc11[_0x1e3d30(0x2a4)](_0x1e3d30(0x2b1))&&_0x2c65b8[_0x1e3d30(0x1f8)]){await this['handleTelegramResponse'](_0x2c65b8[_0x1e3d30(0x1f8)]);return;}if(_0x28dc11===this[_0x1e3d30(0x249)]+'.'+SYSTEM_DP_MODE){_0x2c65b8[_0x1e3d30(0x1f8)]&&Object[_0x1e3d30(0x2ad)](SYSTEM_MODES)['includes'](_0x2c65b8[_0x1e3d30(0x1f8)])&&(this[_0x1e3d30(0x200)]=_0x2c65b8[_0x1e3d30(0x1f8)],_0x2c65b8[_0x1e3d30(0x1f8)]===SYSTEM_MODES[_0x1e3d30(0x1da)]?await this[_0x1e3d30(0x2b3)](![]):await this[_0x1e3d30(0x2b3)](!![]));if(!_0x2c65b8[_0x1e3d30(0x255)])this[_0x1e3d30(0x1ee)](_0x28dc11,{'val':this[_0x1e3d30(0x200)],'ack':!![]});return;}if(!_0x2c65b8[_0x1e3d30(0x255)]){_0x28dc11[_0x1e3d30(0x244)](_0x1e3d30(0x1f1))&&_0x2c65b8[_0x1e3d30(0x1f8)]&&(this[_0x1e3d30(0x1ee)](_0x28dc11,{'val':![],'ack':!![]}),this[_0x1e3d30(0x260)]());if(_0x28dc11[_0x1e3d30(0x244)](_0x1e3d30(0x27f))&&_0x2c65b8[_0x1e3d30(0x1f8)]){this[_0x1e3d30(0x1ee)](_0x28dc11,{'val':![],'ack':!![]});if(this[_0x1e3d30(0x221)])this['createDailyDigest']();}_0x28dc11[_0x1e3d30(0x244)](_0x1e3d30(0x27a))&&_0x2c65b8[_0x1e3d30(0x1f8)]&&(this[_0x1e3d30(0x1ee)](_0x28dc11,{'val':![],'ack':!![]}),this['sendMorningBriefing']());_0x28dc11[_0x1e3d30(0x244)](_0x1e3d30(0x2b8))&&_0x2c65b8[_0x1e3d30(0x1f8)]&&(this[_0x1e3d30(0x1ee)](_0x28dc11,{'val':![],'ack':!![]}),this[_0x1e3d30(0x2a6)]());if(_0x28dc11[_0x1e3d30(0x244)](_0x1e3d30(0x1e4))&&_0x2c65b8[_0x1e3d30(0x1f8)]){this['setState'](_0x28dc11,{'val':![],'ack':!![]});if(!this[_0x1e3d30(0x221)])return;try{const _0x3e3c71=await this[_0x1e3d30(0x22a)](_0x1e3d30(0x29c));if(_0x3e3c71&&_0x3e3c71[_0x1e3d30(0x1f8)]){const _0x3761f5=JSON[_0x1e3d30(0x227)](_0x3e3c71[_0x1e3d30(0x1f8)]);this[_0x1e3d30(0x1c8)][_0x1e3d30(0x232)](_0x1e3d30(0x1df)),this['setStateAsync'](_0x1e3d30(0x2b7),{'val':_0x1e3d30(0x26b),'ack':!![]}),this['sendToPython']('TRAIN_SECURITY',{'sequences':_0x3761f5});}}catch(_0x44ccb4){this[_0x1e3d30(0x1c8)]['error'](_0x1e3d30(0x243)+_0x44ccb4[_0x1e3d30(0x1cd)]);}}if(_0x28dc11['includes'](_0x1e3d30(0x25f))&&_0x2c65b8[_0x1e3d30(0x1f8)]){this[_0x1e3d30(0x1ee)](_0x28dc11,{'val':![],'ack':!![]});if(!this[_0x1e3d30(0x221)])return;try{const _0xb928aa=await this[_0x1e3d30(0x22a)](LTM_DP_DAILY_DIGESTS);_0xb928aa&&_0xb928aa['val']&&this[_0x1e3d30(0x1ab)](_0x1e3d30(0x239),{'digests':JSON[_0x1e3d30(0x227)](_0xb928aa['val'])});}catch(_0x212390){}}if(_0x28dc11[_0x1e3d30(0x244)](_0x1e3d30(0x290))&&_0x2c65b8[_0x1e3d30(0x1f8)]){this[_0x1e3d30(0x1ee)](_0x28dc11,{'val':![],'ack':!![]});if(!this[_0x1e3d30(0x221)])return;try{const _0x4a23f8=await this['getStateAsync']('LTM.trainingData.thermodynamics');_0x4a23f8&&_0x4a23f8[_0x1e3d30(0x1f8)]&&this['sendToPython'](_0x1e3d30(0x25b),{'points':JSON['parse'](_0x4a23f8['val'])});}catch(_0x2de5d4){}}return;}if(this[_0x1e3d30(0x20c)]['presenceDevices']&&this[_0x1e3d30(0x20c)][_0x1e3d30(0x256)][_0x1e3d30(0x244)](_0x28dc11)){await this[_0x1e3d30(0x2af)]();return;}const _0x56dd82=(this[_0x1e3d30(0x20c)][_0x1e3d30(0x2c0)]||[])['find'](_0x1ed80c=>_0x1ed80c['id']===_0x28dc11);if(_0x56dd82)this[_0x1e3d30(0x1f2)](_0x28dc11,_0x2c65b8,_0x56dd82);}async[a0_0x498dfa(0x25d)](_0x2238fc){const _0x3e5656=a0_0x498dfa;if(typeof _0x2238fc===_0x3e5656(0x23a)&&_0x2238fc[_0x3e5656(0x1cd)]){if(_0x2238fc['command']===_0x3e5656(0x1af)){}else{if(_0x2238fc[_0x3e5656(0x23f)]==='testContext'){const _0x41ded8=await this['getWeatherContext'](),_0x33f0c5=await this[_0x3e5656(0x242)]();this[_0x3e5656(0x287)](_0x2238fc[_0x3e5656(0x299)],_0x2238fc[_0x3e5656(0x23f)],{'success':!![],'weather':_0x41ded8,'calendar':_0x33f0c5},_0x2238fc[_0x3e5656(0x1ce)]);}else{if(_0x2238fc[_0x3e5656(0x23f)]===_0x3e5656(0x214)){if(!this['isProVersion'])return this[_0x3e5656(0x287)](_0x2238fc[_0x3e5656(0x299)],_0x2238fc[_0x3e5656(0x23f)],{'success':![],'isPro':![]},_0x2238fc[_0x3e5656(0x1ce)]);let _0x469818={'status':'N/A'};try{_0x469818['status']=(await this[_0x3e5656(0x22a)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x1fd312){}this[_0x3e5656(0x287)](_0x2238fc['from'],_0x2238fc['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x3e5656(0x1b6)],'driftAnalysis':_0x469818,'analysisHistory':this[_0x3e5656(0x262)]},_0x2238fc[_0x3e5656(0x1ce)]);}else{if(_0x2238fc[_0x3e5656(0x23f)]===_0x3e5656(0x217)){const _0x3534ef=this[_0x3e5656(0x1b6)][_0x3e5656(0x23e)],_0x43e07f=new Date(),_0x52b368=new Date(_0x43e07f[_0x3e5656(0x288)](),_0x43e07f[_0x3e5656(0x21d)](),_0x43e07f[_0x3e5656(0x263)]())[_0x3e5656(0x1f3)](),_0x56b9a7=this[_0x3e5656(0x2ac)]['filter'](_0x53dd44=>new Date(_0x53dd44[_0x3e5656(0x277)])[_0x3e5656(0x1f3)]()>_0x52b368)['length'],_0x48dbc3=new Array(0x18)[_0x3e5656(0x2b6)](0x0);this['rawEventLog']['forEach'](_0x2a596e=>{const _0x34f244=_0x3e5656,_0x53888b=new Date(_0x2a596e[_0x34f244(0x277)]);if(_0x53888b[_0x34f244(0x1f3)]()>_0x52b368)_0x48dbc3[_0x53888b[_0x34f244(0x245)]()]++;});let _0x1bab88={'status':_0x3e5656(0x1ef)};try{_0x1bab88[_0x3e5656(0x25a)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x3e5656(0x1f8)];}catch(_0x1a967e){}let _0x88b989='';try{const _0x5bd5c7=await this[_0x3e5656(0x22a)](_0x3e5656(0x294));_0x88b989=_0x5bd5c7?_0x5bd5c7['val']:'';}catch(_0x52eb3f){}let _0x431d87=null;!this[_0x3e5656(0x1bc)]&&(_0x431d87=this['config'][_0x3e5656(0x24a)]?_0x3e5656(0x251):'Kein\x20API\x20Key!');let _0x5b19f4={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x44d7c0=await this[_0x3e5656(0x22a)](_0x3e5656(0x1f0)),_0x395df3=await this[_0x3e5656(0x22a)](_0x3e5656(0x21f)),_0x9fea58=await this['getStateAsync'](_0x3e5656(0x220)),_0x43f8d8=await this[_0x3e5656(0x22a)](_0x3e5656(0x296)),_0x47ecab=await this['getStateAsync'](_0x3e5656(0x276));_0x44d7c0&&_0x44d7c0[_0x3e5656(0x1f8)]&&(_0x5b19f4[_0x3e5656(0x1f6)]=!![],_0x5b19f4[_0x3e5656(0x1e3)]=_0x395df3?_0x395df3[_0x3e5656(0x1f8)]:'',_0x5b19f4[_0x3e5656(0x272)]=_0x9fea58?_0x9fea58[_0x3e5656(0x1f8)]:'',_0x5b19f4[_0x3e5656(0x1e1)]=_0x43f8d8?_0x43f8d8[_0x3e5656(0x1f8)]:''),_0x5b19f4[_0x3e5656(0x26f)]=_0x47ecab?!!_0x47ecab[_0x3e5656(0x1f8)]:![];}catch(_0x385408){}this[_0x3e5656(0x287)](_0x2238fc[_0x3e5656(0x299)],_0x2238fc[_0x3e5656(0x23f)],{'success':!![],'eventHistory':this['eventHistory'][_0x3e5656(0x218)](0x0,0xf),'stats':{'digestCount':_0x3534ef,'eventCountToday':_0x56b9a7,'hourlyActivity':_0x48dbc3,'driftStatus':_0x1bab88[_0x3e5656(0x25a)],'isPresent':this[_0x3e5656(0x26d)],'presenceWho':_0x88b989,'minDays':this[_0x3e5656(0x20c)]['minDaysForBaseline']||0x7,'stbDays':this[_0x3e5656(0x20c)][_0x3e5656(0x1bf)]||0xe,'ltbDays':this[_0x3e5656(0x20c)][_0x3e5656(0x1e6)]||0x3c,'systemError':_0x431d87},'automation':_0x5b19f4},_0x2238fc[_0x3e5656(0x1ce)]);}else{if(_0x2238fc['command']===_0x3e5656(0x281))try{const _0x505799=await this[_0x3e5656(0x206)](_0x2238fc['message']||{});this[_0x3e5656(0x287)](_0x2238fc[_0x3e5656(0x299)],_0x2238fc[_0x3e5656(0x23f)],{'success':!![],'devices':_0x505799},_0x2238fc['callback']);}catch(_0x56b5aa){this['sendTo'](_0x2238fc[_0x3e5656(0x299)],_0x2238fc[_0x3e5656(0x23f)],{'success':![],'error':_0x56b5aa[_0x3e5656(0x1cd)]},_0x2238fc['callback']);}}}}}}}async[a0_0x498dfa(0x1f2)](_0xabd72c,_0x5e0b3b,_0x1e8d4a){const _0x263063=a0_0x498dfa;if(!_0x1e8d4a)return;const _0x5b4535=_0x5e0b3b[_0x263063(0x1f8)],_0x13b2ce=Date[_0x263063(0x29b)](),_0x5ca715=this[_0x263063(0x20e)][_0xabd72c];this[_0x263063(0x20e)][_0xabd72c]=_0x5b4535;if(!_0x1e8d4a[_0x263063(0x1d9)]&&_0x5ca715!=undefined&&_0x5ca715==_0x5b4535)return;const _0x1b89cb=(_0x1e8d4a[_0x263063(0x240)]||'')[_0x263063(0x24d)](),_0x324c2e=_0x1b89cb[_0x263063(0x244)](_0x263063(0x205))||_0x1b89cb[_0x263063(0x244)]('temperatur')||_0x1b89cb[_0x263063(0x244)](_0x263063(0x20f))||_0x1b89cb[_0x263063(0x244)](_0x263063(0x275));this[_0x263063(0x221)]&&_0x324c2e&&this[_0x263063(0x1fa)](_0xabd72c,_0x5b4535,_0x1e8d4a[_0x263063(0x1fc)]);const _0x3ddf9e={'timestamp':_0x13b2ce,'id':_0xabd72c,'name':_0x1e8d4a['name'],'type':_0x1e8d4a[_0x263063(0x240)],'location':_0x1e8d4a['location'],'value':_0x5b4535};this[_0x263063(0x1e2)][_0x263063(0x2ba)](_0x3ddf9e);if(this[_0x263063(0x1e2)][_0x263063(0x23e)]>HISTORY_MAX_SIZE)this['eventHistory']['pop']();await this[_0x263063(0x231)](_0x263063(0x1ae),{'val':JSON[_0x263063(0x23c)](_0x3ddf9e),'ack':!![]}),await this[_0x263063(0x231)]('events.history',{'val':JSON['stringify'](this[_0x263063(0x1e2)]),'ack':!![]});this[_0x263063(0x221)]&&(this[_0x263063(0x2ac)]['push'](_0x3ddf9e),await this['saveRawEventLog'](),this[_0x263063(0x292)](_0x3ddf9e));if(_0x1e8d4a[_0x263063(0x1a9)]&&_0x5b4535===!![]){if(this[_0x263063(0x26d)]&&!this[_0x263063(0x208)])this[_0x263063(0x27b)]();else{if(!this[_0x263063(0x26d)])this[_0x263063(0x2b3)](!![]);}}else{if(_0x1e8d4a[_0x263063(0x240)]===_0x263063(0x2b2)&&_0x5b4535===!![]){if(this[_0x263063(0x234)])this['abortExitTimer']();if(!this[_0x263063(0x26d)]&&this[_0x263063(0x200)]===SYSTEM_MODES[_0x263063(0x1f5)])this['setPresence'](!![]);}}}async['recordSequence'](_0x54804e){const _0x24ea72=a0_0x498dfa,_0x4b020f=(_0x54804e[_0x24ea72(0x240)]||'')[_0x24ea72(0x24d)](),_0x165f86=[_0x24ea72(0x2b2),'bewegung',_0x24ea72(0x219),_0x24ea72(0x2a3),_0x24ea72(0x210),_0x24ea72(0x29d),'t√ºr',_0x24ea72(0x284),_0x24ea72(0x1a7),_0x24ea72(0x2ae),_0x24ea72(0x2b0),_0x24ea72(0x26e),_0x24ea72(0x2a5),_0x24ea72(0x1c9),_0x24ea72(0x1fb),_0x24ea72(0x2a9),'lampe'];if(!_0x165f86[_0x24ea72(0x28b)](_0x5d8fae=>_0x4b020f[_0x24ea72(0x244)](_0x5d8fae)))return;if(!_0x54804e[_0x24ea72(0x1d8)])return;if(this[_0x24ea72(0x266)])clearTimeout(this[_0x24ea72(0x266)]);this[_0x24ea72(0x1d7)][_0x24ea72(0x1e5)]({'loc':_0x54804e[_0x24ea72(0x1fc)]||'Unknown','id':_0x54804e['id'],'ts':Date[_0x24ea72(0x29b)]()}),this['log']['debug']('[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20'+_0x54804e[_0x24ea72(0x1fc)]+'\x20(Length:\x20'+this[_0x24ea72(0x1d7)]['length']+')'),this[_0x24ea72(0x266)]=setTimeout(async()=>{const _0x163fb9=_0x24ea72;if(this[_0x163fb9(0x1d7)][_0x163fb9(0x23e)]>0x1)await this[_0x163fb9(0x1f9)]();this[_0x163fb9(0x1d7)]=[];},SEQUENCE_TIMEOUT_MS);}async[a0_0x498dfa(0x1f9)](){const _0x4bfaaa=a0_0x498dfa;try{const _0x1debc6=await this[_0x4bfaaa(0x22a)](_0x4bfaaa(0x29c));let _0x5063af=[];if(_0x1debc6&&_0x1debc6[_0x4bfaaa(0x1f8)])try{_0x5063af=JSON[_0x4bfaaa(0x227)](_0x1debc6['val']);}catch(_0x541b2b){}const _0x2f4a7d=this[_0x4bfaaa(0x1d7)][0x0]['ts'],_0x181075=this['activeSequence']['map'](_0x2a8e7c=>({'loc':_0x2a8e7c[_0x4bfaaa(0x252)],'t_delta':Math[_0x4bfaaa(0x21e)]((_0x2a8e7c['ts']-_0x2f4a7d)/0x3e8)})),_0x397a2c={'timestamp':new Date(_0x2f4a7d)['toISOString'](),'steps':_0x181075,'duration':Math[_0x4bfaaa(0x21e)]((this['activeSequence'][this[_0x4bfaaa(0x1d7)][_0x4bfaaa(0x23e)]-0x1]['ts']-_0x2f4a7d)/0x3e8),'daytime':new Date(_0x2f4a7d)['getHours']()};_0x5063af[_0x4bfaaa(0x1e5)](_0x397a2c);if(_0x5063af['length']>MAX_TRAINING_SET_SIZE)_0x5063af[_0x4bfaaa(0x2a2)]();await this[_0x4bfaaa(0x231)](_0x4bfaaa(0x29c),{'val':JSON[_0x4bfaaa(0x23c)](_0x5063af),'ack':!![]}),this['runSecurityCheck'](_0x397a2c);}catch(_0x22a210){this[_0x4bfaaa(0x1c8)][_0x4bfaaa(0x278)](_0x4bfaaa(0x201)+_0x22a210[_0x4bfaaa(0x1cd)]);}}[a0_0x498dfa(0x23b)](_0x1ce7e7){const _0x56eb7c=a0_0x498dfa;if(!this[_0x56eb7c(0x221)])return;this[_0x56eb7c(0x1c8)][_0x56eb7c(0x246)](_0x56eb7c(0x230)),this['sendToPython'](_0x56eb7c(0x22d),{'sequence':_0x1ce7e7});}[a0_0x498dfa(0x2c1)](){const _0x160c9c=a0_0x498dfa;if(this[_0x160c9c(0x1a6)])return;this[_0x160c9c(0x1a6)]=!![];const _0x1305f9=path[_0x160c9c(0x2b5)](__dirname,_0x160c9c(0x1c1),_0x160c9c(0x233));this['log'][_0x160c9c(0x232)](_0x160c9c(0x270)),this['stopPythonService']();if(fs[_0x160c9c(0x283)](VENV_PATH)){if(!fs[_0x160c9c(0x283)](PIP_EXE)){this[_0x160c9c(0x1c8)][_0x160c9c(0x274)]('‚ö†Ô∏è\x20Broken\x20venv\x20detected.\x20Repairing...');try{fs['rmSync'](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x3333a4){}}}!fs['existsSync'](VENV_PATH)?exec(_0x160c9c(0x268)+VENV_PATH+'\x22',_0x794034=>{const _0xab1b86=_0x160c9c;if(_0x794034){this[_0xab1b86(0x1c8)][_0xab1b86(0x278)](_0xab1b86(0x2a0)),this['dependencyInstallInProgress']=![];return;}this[_0xab1b86(0x297)](_0x1305f9);}):this[_0x160c9c(0x297)](_0x1305f9);}[a0_0x498dfa(0x297)](_0x37c0db){const _0x117b3f=a0_0x498dfa;this[_0x117b3f(0x1c8)][_0x117b3f(0x232)]('Installing\x20dependencies\x20into\x20venv...');const _0x3929bf='\x22'+PIP_EXE+'\x22\x20install\x20-r\x20\x22'+_0x37c0db+'\x22';exec(_0x3929bf,{'timeout':0x124f80,'maxBuffer':0x400*0x400*0x32},_0x20dbf8=>{const _0x2df07a=_0x117b3f;this[_0x2df07a(0x1a6)]=![],_0x20dbf8?this['log'][_0x2df07a(0x278)](_0x2df07a(0x22b)+_0x20dbf8[_0x2df07a(0x1cd)]):(this[_0x2df07a(0x1c8)][_0x2df07a(0x232)]('‚úÖ\x20INSTALLATION\x20COMPLETE.\x20Starting\x20Service...'),this[_0x2df07a(0x1bd)]());});}[a0_0x498dfa(0x1bd)](){const _0x2f8464=a0_0x498dfa;if(this['dependencyInstallInProgress'])return;let _0x3907d6=_0x2f8464(0x1d0);if(fs[_0x2f8464(0x283)](PYTHON_EXE))this[_0x2f8464(0x1c8)][_0x2f8464(0x232)](_0x2f8464(0x212)+PYTHON_EXE),_0x3907d6=PYTHON_EXE;else{this[_0x2f8464(0x1c8)]['warn'](_0x2f8464(0x1dc)),this['installPythonDependencies']();return;}try{const _0x5ac820=path[_0x2f8464(0x2b5)](__dirname,'python_service',_0x2f8464(0x1b3));this[_0x2f8464(0x1c2)]=spawn(_0x3907d6,[_0x5ac820]),this[_0x2f8464(0x1c2)][_0x2f8464(0x28c)]['on'](_0x2f8464(0x1e0),_0x489a47=>{const _0x1a594c=_0x2f8464,_0x2bd73a=_0x489a47[_0x1a594c(0x261)]()[_0x1a594c(0x1ec)]('\x0a');_0x2bd73a[_0x1a594c(0x258)](_0x446fa4=>{const _0x369171=_0x1a594c,_0x3613b0=_0x446fa4[_0x369171(0x254)]();if(!_0x3613b0)return;if(_0x3613b0[_0x369171(0x238)](_0x369171(0x207)))this[_0x369171(0x1c8)][_0x369171(0x246)](_0x369171(0x280)+_0x3613b0[_0x369171(0x295)](0x5)[_0x369171(0x254)]());else{if(_0x3613b0[_0x369171(0x238)](_0x369171(0x24c)))try{const _0x2878a6=JSON[_0x369171(0x227)](_0x3613b0[_0x369171(0x295)](0x8)['trim']());this[_0x369171(0x250)](_0x2878a6);}catch(_0x3f4701){this[_0x369171(0x1c8)][_0x369171(0x274)]('Invalid\x20JSON:\x20'+_0x3613b0);}}(_0x3613b0[_0x369171(0x244)](_0x369171(0x1b7))||_0x3613b0[_0x369171(0x244)]('Bibliotheken\x20nicht\x20gefunden'))&&(this[_0x369171(0x1c8)][_0x369171(0x274)](_0x369171(0x225)),this[_0x369171(0x2c1)]());});}),this['pythonProcess'][_0x2f8464(0x1f4)]['on'](_0x2f8464(0x1e0),_0x68e0c9=>{const _0x48f23a=_0x2f8464,_0x1f82b8=_0x68e0c9[_0x48f23a(0x261)]()['trim']();if(!_0x1f82b8[_0x48f23a(0x244)](_0x48f23a(0x253)))this[_0x48f23a(0x1c8)][_0x48f23a(0x278)](_0x48f23a(0x209)+_0x1f82b8);}),this[_0x2f8464(0x1c2)]['on'](_0x2f8464(0x1c0),_0xca8cc4=>{const _0x46c76a=_0x2f8464;this[_0x46c76a(0x1c8)][_0x46c76a(0x232)]('[PYTHON]\x20Exited\x20code\x20'+_0xca8cc4),this[_0x46c76a(0x1c2)]=null;});}catch(_0x11361b){this['log']['error'](_0x2f8464(0x1b1)+_0x11361b['message']);}}['stopPythonService'](){const _0x5e4606=a0_0x498dfa;if(this[_0x5e4606(0x1c2)]){this[_0x5e4606(0x1c8)]['info'](_0x5e4606(0x285));try{this[_0x5e4606(0x1c2)][_0x5e4606(0x203)]();}catch(_0x4c3687){}this[_0x5e4606(0x1c2)]=null;}}[a0_0x498dfa(0x250)](_0x29ef35){const _0x199459=a0_0x498dfa;if(_0x29ef35['type']===_0x199459(0x2bd))this[_0x199459(0x1c8)][_0x199459(0x246)](_0x199459(0x236));else{if(_0x29ef35[_0x199459(0x240)]===_0x199459(0x20d)){const {anomaly_score:_0x124b75,is_anomaly:_0x4e6328,threshold:_0x10750a}=_0x29ef35[_0x199459(0x1b8)];this[_0x199459(0x1c8)]['info'](_0x199459(0x1be)+_0x124b75['toFixed'](0x5)+_0x199459(0x216)+(_0x4e6328?'ANOMALY':'OK')),this[_0x199459(0x231)](_0x199459(0x23d),{'val':_0x124b75,'ack':!![]}),this['setStateAsync']('analysis.security.lastCheck',{'val':new Date()[_0x199459(0x24e)](),'ack':!![]});if(_0x4e6328){const _0x25c462=_0x199459(0x28a)+_0x124b75['toFixed'](0x4)+')';this[_0x199459(0x231)](_0x199459(0x1d3),{'val':!![],'ack':!![]}),this['setStateAsync']('analysis.alertReason',{'val':_0x25c462,'ack':!![]}),this['sendNotification']('‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20'+_0x25c462,![],!![]);}}else{if(_0x29ef35['type']===_0x199459(0x22c)){const {success:_0x37941a,details:_0x346481}=_0x29ef35[_0x199459(0x1b8)];this[_0x199459(0x231)](_0x199459(0x2b7),{'val':_0x37941a?_0x199459(0x264)+new Date()[_0x199459(0x1c5)]()+'\x20('+_0x346481+')':_0x199459(0x2b4)+_0x346481,'ack':!![]});}else{if(_0x29ef35['type']===_0x199459(0x1b4)){const {success:_0x1a7d8f,details:_0x2b112f}=_0x29ef35['payload'];if(_0x1a7d8f)try{const _0x4cf308=JSON[_0x199459(0x227)](_0x2b112f);if(_0x4cf308[_0x199459(0x27d)])this[_0x199459(0x231)](_0x199459(0x298),{'val':JSON[_0x199459(0x23c)](_0x4cf308[_0x199459(0x27d)]),'ack':!![]});if(_0x4cf308[_0x199459(0x2bf)])this[_0x199459(0x231)]('analysis.energy.heatingScore',{'val':JSON[_0x199459(0x23c)](_0x4cf308[_0x199459(0x2bf)]),'ack':!![]});}catch(_0x5ecc2b){}}else{if(_0x29ef35['type']===_0x199459(0x1d6)){const {success:_0x2148f1,details:_0x37d587}=_0x29ef35[_0x199459(0x1b8)];if(_0x2148f1)this['log'][_0x199459(0x232)](_0x199459(0x269)+_0x37d587);}else{if(_0x29ef35[_0x199459(0x240)]==='HEALTH_RESULT'){const {is_anomaly:_0x4cb8fe,details:_0x35f8d3}=_0x29ef35[_0x199459(0x1b8)];this[_0x199459(0x231)]('analysis.health.lastCheck',{'val':new Date()[_0x199459(0x24e)](),'ack':!![]}),this[_0x199459(0x231)](_0x199459(0x29f),{'val':_0x4cb8fe,'ack':!![]});}}}}}}}[a0_0x498dfa(0x1ab)](_0xba3bc0,_0x368178={}){const _0x891c78=a0_0x498dfa;if(!this[_0x891c78(0x1c2)]||!this[_0x891c78(0x1c2)][_0x891c78(0x237)]['writable'])return;const _0xbc2194=JSON[_0x891c78(0x23c)]({'command':_0xba3bc0,..._0x368178});try{this[_0x891c78(0x1c2)][_0x891c78(0x237)][_0x891c78(0x28e)](_0xbc2194+'\x0a');}catch(_0x5722e9){}}async[a0_0x498dfa(0x206)](_0x2757eb){}async[a0_0x498dfa(0x2bc)](){}async['recordThermodynamics'](_0x42fb4f,_0x3ddf78,_0xd2e05a){}}if(require['main']!==module)module[a0_0x498dfa(0x2ab)]=_0x288010=>new CogniLiving(_0x288010);else new CogniLiving();