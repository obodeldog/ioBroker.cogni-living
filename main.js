const a0_0x431431=a0_0xe0e8;(function(_0x1f90c1,_0x134597){const _0x5a168b=a0_0xe0e8,_0xfe7076=_0x1f90c1();while(!![]){try{const _0x405011=parseInt(_0x5a168b(0x226))/0x1*(-parseInt(_0x5a168b(0x2a4))/0x2)+-parseInt(_0x5a168b(0x210))/0x3*(parseInt(_0x5a168b(0x304))/0x4)+-parseInt(_0x5a168b(0x332))/0x5+-parseInt(_0x5a168b(0x1a5))/0x6*(-parseInt(_0x5a168b(0x301))/0x7)+parseInt(_0x5a168b(0x2c4))/0x8*(-parseInt(_0x5a168b(0x366))/0x9)+-parseInt(_0x5a168b(0x214))/0xa+parseInt(_0x5a168b(0x34a))/0xb;if(_0x405011===_0x134597)break;else _0xfe7076['push'](_0xfe7076['shift']());}catch(_0x5dd545){_0xfe7076['push'](_0xfe7076['shift']());}}}(a0_0x393c,0x4ac0a));const a0_0x465926=(function(){let _0x1affe4=!![];return function(_0x55be69,_0x3770a8){const _0x2191e9=_0x1affe4?function(){if(_0x3770a8){const _0x42e00f=_0x3770a8['apply'](_0x55be69,arguments);return _0x3770a8=null,_0x42e00f;}}:function(){};return _0x1affe4=![],_0x2191e9;};}()),a0_0x2ca9e3=a0_0x465926(this,function(){const _0x517b87=a0_0xe0e8;return a0_0x2ca9e3[_0x517b87(0x2fc)]()['search']('(((.+)+)+)+$')[_0x517b87(0x2fc)]()[_0x517b87(0x206)](a0_0x2ca9e3)[_0x517b87(0x294)]('(((.+)+)+)+$');});a0_0x2ca9e3();function a0_0xe0e8(_0x4a1585,_0x57edb9){const _0x45d405=a0_0x393c();return a0_0xe0e8=function(_0x2ca9e3,_0x465926){_0x2ca9e3=_0x2ca9e3-0x19b;let _0x393c25=_0x45d405[_0x2ca9e3];return _0x393c25;},a0_0xe0e8(_0x4a1585,_0x57edb9);}function a0_0x393c(){const _0x465b2e=['LTM.rawEventLog','updateAnalysisHistory','Trigger\x20Analysis','sensorLastValues','4LwDWqf','lights','health','Badezimmer','ltmStbWindowDays','saveFeedback','send','analysis.isEmergency','saveRawEventLog','unload','notifyWhatsappInstance','sat','pr√§senz','ack','garten','createAllObjects','temperatur','analysis.comfortSummary','_score','application/json','history.','push','devices','System\x20Mode','NORMAL','info','scanForDevices','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','indicator.alarm.fire','getEnums','dailyDigests','motion','4336oyHumr','getStateAsync','PARTY','flot.','isProVersion','mac\x20address','loadRawEventLog','subscribeStates','onUnload','text','Automation\x20Proposals','WEEK_PROGRAM','notifyWhatsappEnabled','checkLicense','notifyTelegramInstance','GUEST','Feedback\x20Log','checkSystemObjects','systemConfig','isGracePeriodActive','notes','Cogni-Living\x20Alert','enum','ready','exitGraceTimer','notifyEmailInstance','javascript.0.script','notifyPushoverRecipient','events.history_debug_01','values','diele','Flur','N/A','members','eventHistory','analysis.automation.suggestedAction','driftDetails','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','t√ºr','analysisHistory','system','[TEST]\x20','smoke','date','Adapter','cogni-living\x20adapter\x20starting\x20(v','wohnungst√ºr','retry','No\x20recent\x20activity.','events.history_debug_04','from','Starting\x20Smart\x20Scan\x20with\x20filters:\x20','Sending\x20notification:\x20\x22','analysis.deviationFromBaseline','ERROR','toString','analysis.health.sleepScore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','\x20sent','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','84RiHLym','startExitTimer','firmware','244VrnkEH','Health\x20Notes','update','geminiModel','getSystemUUID','AI\x20Emergency\x20Status','toFixed','@google/generative-ai','@iobroker/adapter-core','toUpperCase','griff','text.alarm','RSSI','events.history_debug_03','online','pop','de-DE','Gemini\x20AI\x20initialized.','LTM.baselineStatus','sensor.window','.\x20PERSONA:\x20','notifyEmailEnabled','write','onStateChange','currentSystemMode','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','Trigger\x20Digest','Schlafzimmer','loadSystemMode','processSensorEvent','signal','systemUUID','setupModeResetScheduler','Drift\x20Details','LTM.driftAnalysis.baselineDrift','temp','accuweather.','\x20presence\x20devices...','Success','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','analysis.history_debug_01','pressure','exports','object','Baseline:\x20Inactive\x20(Pro\x20Feature).','openweathermap.','862800FOqLDq','.\x20ORT:\x20','Deaktiviert\x20(Pro-Feature)','LOWBAT','deviationFromBaseline','Alert\x20Reason','abortExitTimer','temperature','alert','Licht','onMessage','VIRTUAL_CHANNEL','scriptProblem','process','unknown','User\x20Feedback:\x20Alarm\x20\x22','battery','weather','bind','boolean','now','Missing\x20data','isPresent','No\x20recorded\x20events\x20yet.','14828121tuFwhz','Pattern\x20Detected','CONNECTION','checkWifiPresence','toLocaleString','Gemini\x20Init\x20Error:\x20','level.dimmer','daswetter.','notifySignalRecipient','generateContent','system.isPresent','lastAlertState','details','version','sendNotification','analysis.health.notes','occupancy','vis.','includes','stateChange','testApiKey','common','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ltmJob','baselineDrift','namespace','Wohnzimmer','analysis.health','8415clLfJJ','mode','eingang','notifyPushoverEnabled','restlessness','long','sendToAsync','sendTo','ALARM','icons-mfd.','enum.functions.*','\x22\x20was\x20','isAlert','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22Pr√§gnante\x20Zusammenfassung\x20des\x20Tages\x20(max\x202\x20S√§tze).\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activityLevel\x22:\x20\x22sehr\x20niedrig|niedrig|normal|hoch|sehr\x20hoch\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22sleepScore\x22:\x20number\x20(0-100,\x20Gesamtbewertung\x20der\x20Nachtruhe/Schlafqualit√§t\x20des\x20vergangenen\x2024h\x20Zyklus),\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','setStateAsync','connection','toISOString','minDaysForBaseline','142932nIKBgp','Event\x20History','createDailyDigest','loadHistoryFromState','Restlessness\x20Level','enum.rooms.*','productname','Processing\x20Status','DUTYCYCLE','siren','none','analysis.feedbackHistory','inactivityThresholdHours','effect','getGenerativeModel','analysis.lastResult','setObjectNotExistsAsync','summary','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','hue','activity','analysisInterval','name','join','command','unshift','AI\x20Alert\x20Status','analysis.automation.patternDetected','map','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','Last\x20Result','last\x20action','getLtmData','admin.','events.history','SABOTAGE','Fehler:\x20','runGeminiAnalysis','wohn','Comfort\x20Suggestion','analysisTimer','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','Analysiere\x20Tag...','analysis.isAlert','.\x20PR√ÑSENZ:\x20','channel','wetter','find','icon','notifyTelegramRecipient','resetAnalysisStates','sensor.motion','modelid','Rauchmelder','level','‚ö†Ô∏è\x20Alarm','ON_TIME','exitTimer','Health\x20&\x20Sleep\x20Analysis','native','Daily\x20Digests','presence','Presence\x20Status','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','N/A\x20(No\x20Activity)','analysis.comfortSuggestion','ltmLtbWindowDays','Raw\x20Log','getForeignObjectsAsync','detectionState','latitude','analysis.history_debug_03','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','description','checkLtmObjects','response','slice','scriptEnabled','Bewegung','location','modeResetJob','manufacturer','Deviation','setupLtmScheduler','bad','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','state','[Test]\x20Notification','notifyTelegramEnabled','error','N/A\x20(Learning)','analysis.trigger','schlaf','button','config','2-digit','scheduleJob','constructor','extendObjectAsync','automationProposal','aiPersona','getForeignObjectAsync','message','ltmDriftCheckIntervalHours','k√ºche','system.meta.uuid','uuid-error','13272ckHSmx','genAI','suggestedAction','comfort','2323330VEHtax','number','livingContext','submitFeedback','Last\x20Check','uuid-not-found','sound','\x20min).\x20Watchdog\x20Limit:\x20','AES_KEY','trim','\x0a\x0aA\x20(STB):\x0a','switch.light','alertReason','precip','callback','shutter_contact','testNotification','setPresence','73081VMNbuK','licht','normal','Party','models/gemini-flash-latest','analysis.analysisHistory','system.mode','notifyEmailRecipient','0\x203\x20*\x20*\x20*','json','updateBaselineStatus','material.','licenseKey','Normal','selectedFunctionIds','Fenster/T√ºr','toLowerCase','COMBINED_PARAMETER','capabilities','fire','Drift\x20Status','runAutopilot','indicator.alarm','LTM.driftAnalysis','setupDriftAnalysisScheduler','sort','rain','suggestion','SECTION','apiKey','runBaselineDriftAnalysis','saveDailyDigests','splice','val','analysis.history_debug_02','setState','UNREACH','events.history_debug_02','notifyWhatsappRecipient','LTM.processingStatus','length','System\x20Status\x20&\x20Control','geminiApiKey','weatherunderground.','LTM.driftAnalysis.driftDetails','string','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','WORKING','system.config','LTM','LTM.triggerDailyDigest','timestamp','analysis.history_debug_04','getForeignStateAsync','sleepScore','üö®\x20EMERGENCY','analysis.automation','split','catch','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','cogni-living','Creating\x20Daily\x20Digest\x20from\x20','analysis.alertReason','notifySignalEnabled','flur','guest','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT\x20(Schlaf/Unruhe).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100,\x20100=perfekt,\x20sch√§tze\x20bei\x20Nachtdaten),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','CONFIG_PENDING','Description','TEST-PRO-KEY','parse','link_quality','Subscribing\x20to\x20','\x20raw\x20events...','Starting\x20Autopilot\x20(','events.lastEvent','uuid','Activity\x20Summary','rawEventLog','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','LTM.driftAnalysis.lastCheck','type','status','rating','subscribeForeignStatesAsync','replace','system.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','0\x204\x20*\x20*\x20*','value.humidity','feedbackHistory','checkLtmDriftObjects','inactivityMonitoringEnabled','driftAnalysisTimer','\x0aFEEDBACK:\x0a','presenceDevices','node-schedule','vacation','loadDailyDigests','Drift\x20Analysis','onReady','analysis.activitySummary','lampe','Temperatur','Logbook','log','party','stringify','city','Action','search','PRO-','some','longitude','generic','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','yr.','Analysis\x20Error:\x20','analysis.health.restlessness','\x20(EMERGENCY)','lastCheck','cancel'];a0_0x393c=function(){return _0x465b2e;};return a0_0x393c();}'use strict';const utils=require(a0_0x431431(0x30c)),{GoogleGenerativeAI}=require(a0_0x431431(0x30b)),schedule=require(a0_0x431431(0x286)),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL=a0_0x431431(0x22a),ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE=a0_0x431431(0x22e),LTM_DP_RAW_LOG=a0_0x431431(0x2a0),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x431431(0x24d),LTM_DP_TRIGGER_DIGEST=a0_0x431431(0x258),LTM_DP_BASELINE_STATUS=a0_0x431431(0x316),LTM_DP_DRIFT_CHANNEL=a0_0x431431(0x23d),LTM_DP_DRIFT_STATUS=a0_0x431431(0x326),LTM_DP_DRIFT_DETAILS=a0_0x431431(0x252),LTM_DP_DRIFT_LAST_CHECK=a0_0x431431(0x276),SYSTEM_DP_MODE=a0_0x431431(0x22c),MODE_RESET_SCHEDULE=a0_0x431431(0x27e),SYSTEM_MODES={'NORMAL':a0_0x431431(0x228),'VACATION':a0_0x431431(0x287),'PARTY':a0_0x431431(0x290),'GUEST':a0_0x431431(0x267)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x431431(0x31d),'senior_aal':a0_0x431431(0x2e9),'family':a0_0x431431(0x1ed),'single_comfort':a0_0x431431(0x1c2),'security':a0_0x431431(0x299)};class CogniLiving extends utils[a0_0x431431(0x2f1)]{constructor(_0x283e39){const _0x1f7eef=a0_0x431431;super({..._0x283e39,'name':_0x1f7eef(0x262)}),this[_0x1f7eef(0x2e6)]=[],this['analysisHistory']=[],this[_0x1f7eef(0x280)]=[],this[_0x1f7eef(0x274)]=[],this['dailyDigests']=[],this[_0x1f7eef(0x2a3)]={},this[_0x1f7eef(0x2d6)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x1f7eef(0x348)]=!![],this[_0x1f7eef(0x1de)]=null,this[_0x1f7eef(0x2dc)]=null,this[_0x1f7eef(0x2d7)]=![],this[_0x1f7eef(0x211)]=null,this[_0x1f7eef(0x307)]=null,this[_0x1f7eef(0x31c)]=SYSTEM_MODES[_0x1f7eef(0x2bc)],this[_0x1f7eef(0x2c8)]=![],this[_0x1f7eef(0x355)]=![],this[_0x1f7eef(0x323)]=_0x1f7eef(0x340),this['analysisTimer']=null,this[_0x1f7eef(0x361)]=null,this[_0x1f7eef(0x1f5)]=null,this[_0x1f7eef(0x283)]=null,this['on'](_0x1f7eef(0x2db),this[_0x1f7eef(0x28a)][_0x1f7eef(0x344)](this)),this['on'](_0x1f7eef(0x35d),this[_0x1f7eef(0x31b)]['bind'](this)),this['on'](_0x1f7eef(0x2ad),this['onUnload'][_0x1f7eef(0x344)](this)),this['on'](_0x1f7eef(0x20b),this['onMessage'][_0x1f7eef(0x344)](this));}async[a0_0x431431(0x28a)](){const _0x11a118=a0_0x431431;this[_0x11a118(0x28f)]['info'](_0x11a118(0x2f2)+this['version']+')');const _0x272d76=['analysis.history_debug_00',_0x11a118(0x32c),_0x11a118(0x248),_0x11a118(0x1ec),_0x11a118(0x25a),'events.history_debug_00',_0x11a118(0x2e0),_0x11a118(0x24b),_0x11a118(0x311),_0x11a118(0x2f6)];for(const _0x5c607f of _0x272d76){try{const _0x3a738d=await this['getObjectAsync'](_0x5c607f);_0x3a738d&&await this['delObjectAsync'](_0x5c607f);}catch(_0x352bc2){}}this['config'][_0x11a118(0x232)]=this[_0x11a118(0x203)][_0x11a118(0x232)]||'',this[_0x11a118(0x2c8)]=await this[_0x11a118(0x2d1)](this['config']['licenseKey']);if(!this[_0x11a118(0x203)][_0x11a118(0x1b1)]||this[_0x11a118(0x203)]['inactivityThresholdHours']<0.1)this['config'][_0x11a118(0x1b1)]=0xc;await this[_0x11a118(0x1a8)]();try{const _0x141e5b=await this[_0x11a118(0x20a)](_0x11a118(0x256));_0x141e5b&&_0x141e5b[_0x11a118(0x35f)]&&(this[_0x11a118(0x2d6)]={'latitude':_0x141e5b[_0x11a118(0x35f)][_0x11a118(0x1eb)]||0x0,'longitude':_0x141e5b['common'][_0x11a118(0x297)]||0x0,'city':_0x141e5b['common']['city']||''});}catch(_0x25748f){}if(this[_0x11a118(0x203)][_0x11a118(0x250)])try{this[_0x11a118(0x211)]=new GoogleGenerativeAI(this[_0x11a118(0x203)]['geminiApiKey']),this[_0x11a118(0x307)]=this[_0x11a118(0x211)][_0x11a118(0x1b3)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x11a118(0x2b7)}}),this[_0x11a118(0x28f)][_0x11a118(0x2bd)](_0x11a118(0x315));}catch(_0x50c170){this[_0x11a118(0x28f)]['error'](_0x11a118(0x34f)+_0x50c170[_0x11a118(0x20b)]);}await this[_0x11a118(0x2b3)](),await this[_0x11a118(0x320)](),await this[_0x11a118(0x2ca)](),await this['loadDailyDigests'](),this[_0x11a118(0x2cb)](_0x11a118(0x200)),this[_0x11a118(0x2cb)](LTM_DP_TRIGGER_DIGEST),this[_0x11a118(0x2cb)](_0x11a118(0x22c));const _0x39241f=this['config']['devices'];if(_0x39241f&&_0x39241f[_0x11a118(0x24e)]>0x0){this[_0x11a118(0x28f)]['info']('Subscribing\x20to\x20'+_0x39241f[_0x11a118(0x24e)]+'\x20sensors...');for(const _0x18e1a7 of _0x39241f){if(_0x18e1a7['id']){await this[_0x11a118(0x27a)](_0x18e1a7['id']);try{const _0x25633d=await this[_0x11a118(0x25b)](_0x18e1a7['id']);if(_0x25633d)this[_0x11a118(0x2a3)][_0x18e1a7['id']]=_0x25633d[_0x11a118(0x247)];}catch(_0x46f29b){}}}}const _0x4b079c=this['config'][_0x11a118(0x285)]||[];if(_0x4b079c['length']>0x0){this['log']['info'](_0x11a118(0x26e)+_0x4b079c['length']+_0x11a118(0x329));for(const _0x186815 of _0x4b079c){await this[_0x11a118(0x27a)](_0x186815);}await this[_0x11a118(0x34d)]();}if(this[_0x11a118(0x1cd)])clearInterval(this[_0x11a118(0x1cd)]);const _0x5c5fc1=this[_0x11a118(0x203)]['analysisInterval']||0xf;_0x5c5fc1>0x0&&(this[_0x11a118(0x28f)]['info'](_0x11a118(0x270)+_0x5c5fc1+_0x11a118(0x21b)+this['config']['inactivityThresholdHours']+'h.'),this[_0x11a118(0x1cd)]=setInterval(()=>this[_0x11a118(0x23b)](),_0x5c5fc1*0x3c*0x3e8)),this['setupLtmScheduler'](),this[_0x11a118(0x324)](),this[_0x11a118(0x23e)]();}async[a0_0x431431(0x2be)](_0x1f6401={}){const _0x3a04be=a0_0x431431;this[_0x3a04be(0x28f)][_0x3a04be(0x2bd)](_0x3a04be(0x2f8)+JSON[_0x3a04be(0x291)](_0x1f6401));const _0x1cdc49=[],_0x26d15b=_0x1f6401[_0x3a04be(0x2c3)]!==![],_0x3a50ba=_0x1f6401['doors']!==![],_0x2b4d7b=_0x1f6401[_0x3a04be(0x2a5)]!==![],_0x50b1fc=_0x1f6401[_0x3a04be(0x339)]===!![],_0x23a213=_0x1f6401['weather']===!![],_0x352bb9=_0x1f6401[_0x3a04be(0x234)]||[],_0x1493f9=await this[_0x3a04be(0x1e9)](_0x3a04be(0x1aa),_0x3a04be(0x2da)),_0x5102f1=await this[_0x3a04be(0x1e9)]('enum.functions.*','enum'),_0x185014={},_0x3f4f4a={},_0x53090b={},_0x172a5b=(_0x507b57,_0x1b6ef5,_0x187cdb=![])=>{const _0x44af5a=_0x3a04be;if(!_0x507b57)return;for(const _0x6faa0d in _0x507b57){const _0x593eb8=_0x507b57[_0x6faa0d];if(_0x593eb8&&_0x593eb8[_0x44af5a(0x35f)]&&_0x593eb8[_0x44af5a(0x35f)][_0x44af5a(0x2e5)]){const _0x262951=(typeof _0x593eb8[_0x44af5a(0x35f)][_0x44af5a(0x1bb)]===_0x44af5a(0x32f)?_0x593eb8[_0x44af5a(0x35f)]['name']['de']:_0x593eb8[_0x44af5a(0x35f)][_0x44af5a(0x1bb)])||_0x593eb8['common'][_0x44af5a(0x1bb)];if(_0x187cdb)_0x53090b[_0x6faa0d]=_0x262951;for(const _0x380b07 of _0x593eb8[_0x44af5a(0x35f)][_0x44af5a(0x2e5)]){if(_0x187cdb){if(!_0x1b6ef5[_0x380b07])_0x1b6ef5[_0x380b07]=[];_0x1b6ef5[_0x380b07][_0x44af5a(0x2b9)](_0x6faa0d);}else _0x1b6ef5[_0x380b07]=_0x262951;}}}};_0x172a5b(_0x1493f9,_0x185014),_0x172a5b(_0x5102f1,_0x3f4f4a,!![]);const _0x2b1eb0=await this[_0x3a04be(0x1e9)]('*',_0x3a04be(0x1fb)),_0x4f6d95=[_0x3a04be(0x24a),_0x3a04be(0x335),_0x3a04be(0x310),_0x3a04be(0x2fb),'FAULT',_0x3a04be(0x1c8),_0x3a04be(0x19b),_0x3a04be(0x269),_0x3a04be(0x1ad),_0x3a04be(0x255),'DIRECTION','STICKY_UNREACH','OPERATING_VOLTAGE',_0x3a04be(0x33d),'INSTALL_TEST',_0x3a04be(0x237),_0x3a04be(0x2cf),_0x3a04be(0x1dd),_0x3a04be(0x242),'ERROR_CODE','PROCESS',_0x3a04be(0x21c),_0x3a04be(0x34c),'reachable',_0x3a04be(0x26d),_0x3a04be(0x342),_0x3a04be(0x306),_0x3a04be(0x303),_0x3a04be(0x357),_0x3a04be(0x1a2),_0x3a04be(0x2bd),_0x3a04be(0x322),'last_seen',_0x3a04be(0x1c4),'archetype',_0x3a04be(0x33a),_0x3a04be(0x367),'colormode',_0x3a04be(0x1b2),'xy','ct',_0x3a04be(0x1b8),_0x3a04be(0x2af),_0x3a04be(0x1ab),_0x3a04be(0x1f6),_0x3a04be(0x1d9),'uniqueid',_0x3a04be(0x1bd),_0x3a04be(0x2c9),_0x3a04be(0x1ee),_0x3a04be(0x238),_0x3a04be(0x33f),_0x3a04be(0x1f2),_0x3a04be(0x33e),_0x3a04be(0x2de),_0x3a04be(0x1ea),_0x3a04be(0x1b6),_0x3a04be(0x1d5),'history','forecast',_0x3a04be(0x2bd),_0x3a04be(0x22f)];if(!_0x23a213)_0x4f6d95[_0x3a04be(0x2b9)](_0x3a04be(0x1d3),_0x3a04be(0x343),'wind',_0x3a04be(0x32d),'uv',_0x3a04be(0x240),_0x3a04be(0x221));const _0x2bb319=[_0x3a04be(0x27c),_0x3a04be(0x1c6),'info.',_0x3a04be(0x35b),_0x3a04be(0x2b8),_0x3a04be(0x231),_0x3a04be(0x19c),_0x3a04be(0x2c7)];if(!_0x23a213)_0x2bb319[_0x3a04be(0x2b9)](_0x3a04be(0x351),_0x3a04be(0x251),_0x3a04be(0x328),_0x3a04be(0x29a),_0x3a04be(0x331));const _0x48d2d5=(_0x695849,_0x114a38,_0x314727=![])=>{const _0x3ae7ce=_0x3a04be,_0x36b1f3=_0x695849[_0x3ae7ce(0x25f)]('.');if(_0x114a38[_0x695849])return _0x114a38[_0x695849];if(_0x36b1f3[_0x3ae7ce(0x24e)]>0x2&&_0x114a38[_0x36b1f3[_0x3ae7ce(0x1f1)](0x0,-0x1)[_0x3ae7ce(0x1bc)]('.')])return _0x114a38[_0x36b1f3[_0x3ae7ce(0x1f1)](0x0,-0x1)['join']('.')];if(_0x36b1f3[_0x3ae7ce(0x24e)]>0x3&&_0x114a38[_0x36b1f3[_0x3ae7ce(0x1f1)](0x0,-0x2)[_0x3ae7ce(0x1bc)]('.')])return _0x114a38[_0x36b1f3[_0x3ae7ce(0x1f1)](0x0,-0x2)[_0x3ae7ce(0x1bc)]('.')];return _0x314727?[]:null;};for(const _0xcc5f38 in _0x2b1eb0){const _0xd4caa0=_0x2b1eb0[_0xcc5f38];if(!_0xd4caa0||!_0xd4caa0[_0x3a04be(0x35f)])continue;if(_0x2bb319[_0x3a04be(0x296)](_0x36e0e9=>_0xcc5f38['startsWith'](_0x36e0e9)))continue;const _0x11336f=_0xd4caa0['common']['role']||'',_0x16c421=(_0xd4caa0[_0x3a04be(0x35f)][_0x3a04be(0x1bb)]&&typeof _0xd4caa0['common']['name']===_0x3a04be(0x32f)?_0xd4caa0[_0x3a04be(0x35f)]['name']['de']:_0xd4caa0[_0x3a04be(0x35f)][_0x3a04be(0x1bb)])||'',_0x282c5c=_0x16c421?_0x16c421[_0x3a04be(0x236)]():'',_0x9c691d=_0xcc5f38['toLowerCase'](),_0x2dff93=_0x48d2d5(_0xcc5f38,_0x185014),_0x196a75=_0x48d2d5(_0xcc5f38,_0x3f4f4a,!![]);let _0x40febf=null,_0x4b75a0=![];if(_0x196a75&&_0x196a75[_0x3a04be(0x24e)]>0x0){const _0xbae9b7=_0x196a75[_0x3a04be(0x1d4)](_0x459fb7=>_0x352bb9[_0x3a04be(0x35c)](_0x459fb7));if(_0xbae9b7){_0x4b75a0=!![];const _0x510f62=_0x53090b[_0xbae9b7];if(_0x9c691d[_0x3a04be(0x35c)](_0x3a04be(0x1e2))||_0x9c691d[_0x3a04be(0x35c)]('motion'))_0x40febf=_0x3a04be(0x1f3);else{if(_0x9c691d['includes'](_0x3a04be(0x2ef))||_0x9c691d[_0x3a04be(0x35c)](_0x3a04be(0x239))||_0x282c5c[_0x3a04be(0x35c)]('rauch'))_0x40febf=_0x3a04be(0x1da);else{if(_0x9c691d[_0x3a04be(0x35c)](_0x3a04be(0x1fb))||_0x9c691d[_0x3a04be(0x35c)](_0x3a04be(0x1db))||_0x9c691d[_0x3a04be(0x35c)]('on'))_0x40febf='Schalter/Licht';else _0x40febf=_0x510f62;}}}}if(!_0x4b75a0&&!_0x23a213){if(_0x4f6d95[_0x3a04be(0x296)](_0x575e94=>_0x282c5c[_0x3a04be(0x35c)](_0x575e94)||_0xcc5f38[_0x3a04be(0x30d)]()[_0x3a04be(0x35c)](_0x575e94)))continue;}if(!_0x40febf&&_0x26d15b){if(_0x11336f[_0x3a04be(0x35c)](_0x3a04be(0x1d8))||_0x11336f[_0x3a04be(0x35c)](_0x3a04be(0x35a))||_0x282c5c[_0x3a04be(0x35c)]('bewegung')||_0x282c5c['includes'](_0x3a04be(0x2b0)))_0x40febf='Bewegung';}!_0x40febf&&_0x3a50ba&&((_0x9c691d[_0x3a04be(0x35c)](_0x3a04be(0x223))||_0x11336f[_0x3a04be(0x35c)]('sensor.door')||_0x11336f['includes'](_0x3a04be(0x317))||(_0x282c5c[_0x3a04be(0x35c)]('fenster')||_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x2eb)))&&!_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x327))&&!_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x30e))&&(_0xd4caa0[_0x3a04be(0x35f)]['type']===_0x3a04be(0x345)||_0xd4caa0[_0x3a04be(0x35f)][_0x3a04be(0x277)]===_0x3a04be(0x215)))&&(_0x40febf=_0x3a04be(0x235)));if(!_0x40febf&&_0x2b4d7b){if((_0x11336f['includes'](_0x3a04be(0x21f))||_0x11336f[_0x3a04be(0x35c)](_0x3a04be(0x350))||_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x227))||_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x28c)))&&_0xd4caa0[_0x3a04be(0x35f)][_0x3a04be(0x31a)])_0x40febf=_0x3a04be(0x33b);}if(!_0x40febf&&_0x50b1fc){if(_0x11336f['includes']('value.temperature')||_0x11336f[_0x3a04be(0x35c)](_0x3a04be(0x27f))||_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x2b4)))_0x40febf=_0x3a04be(0x28d);}if(_0x40febf){let _0x593fb4=_0x2dff93||'';if(!_0x593fb4){if(_0x282c5c['includes'](_0x3a04be(0x1f9)))_0x593fb4=_0x3a04be(0x2a7);else{if(_0x282c5c['includes'](_0x3a04be(0x20d)))_0x593fb4='K√ºche';else{if(_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x1cb)))_0x593fb4=_0x3a04be(0x364);else{if(_0x282c5c['includes'](_0x3a04be(0x201)))_0x593fb4=_0x3a04be(0x31f);else{if(_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x266))||_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x2e2)))_0x593fb4=_0x3a04be(0x2e3);else{if(_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x2b2)))_0x593fb4='Garten';}}}}}}let _0x6c88ef=![];_0x40febf===_0x3a04be(0x235)&&((_0x282c5c[_0x3a04be(0x35c)]('haust√ºr')||_0x282c5c[_0x3a04be(0x35c)](_0x3a04be(0x368))||_0x282c5c['includes'](_0x3a04be(0x2f3))||_0x593fb4&&_0x593fb4[_0x3a04be(0x236)]()['includes']('flur')&&_0x282c5c[_0x3a04be(0x35c)]('t√ºr'))&&(_0x6c88ef=!![]));let _0x53951e=0x0;if(_0x4b75a0)_0x53951e+=0x1e;else{if(_0x2dff93)_0x53951e+=0x14;else{if(_0x593fb4)_0x53951e+=0xa;}}if(_0x6c88ef)_0x53951e+=0x5;_0x1cdc49[_0x3a04be(0x2b9)]({'id':_0xcc5f38,'name':_0x16c421||_0xcc5f38,'type':_0x40febf,'location':_0x593fb4,'logDuplicates':_0x40febf===_0x3a04be(0x1f3),'isExit':_0x6c88ef,'_score':_0x53951e});}}return _0x1cdc49[_0x3a04be(0x23f)]((_0x2ce23f,_0x55bdef)=>_0x55bdef['_score']-_0x2ce23f[_0x3a04be(0x2b6)]),_0x1cdc49;}async[a0_0x431431(0x34d)](){const _0x53745a=a0_0x431431,_0x2633ee=this[_0x53745a(0x203)]['presenceDevices']||[];let _0xcbcaa2=![];for(const _0x12ab94 of _0x2633ee){try{const _0x11624f=await this[_0x53745a(0x25b)](_0x12ab94);if(_0x11624f&&(_0x11624f[_0x53745a(0x247)]===!![]||_0x11624f[_0x53745a(0x247)]===_0x53745a(0x312)||_0x11624f[_0x53745a(0x247)]===0x1)){_0xcbcaa2=!![];break;}}catch(_0x52dfda){}}return _0xcbcaa2&&(this['exitTimer']&&(this[_0x53745a(0x28f)]['info'](_0x53745a(0x2ea)),this[_0x53745a(0x338)]()),!this[_0x53745a(0x348)]&&this[_0x53745a(0x31c)]===SYSTEM_MODES[_0x53745a(0x2bc)]&&this[_0x53745a(0x225)](!![])),_0xcbcaa2;}async['onStateChange'](_0x27c0ac,_0x57744a){const _0x543dc7=a0_0x431431;if(!_0x57744a)return;if(_0x27c0ac===this[_0x543dc7(0x363)]+'.'+SYSTEM_DP_MODE){_0x57744a[_0x543dc7(0x247)]&&Object['values'](SYSTEM_MODES)[_0x543dc7(0x35c)](_0x57744a[_0x543dc7(0x247)])&&(this['currentSystemMode']=_0x57744a['val'],_0x57744a[_0x543dc7(0x247)]===SYSTEM_MODES['VACATION']?this['setPresence'](![]):this[_0x543dc7(0x225)](!![]));if(!_0x57744a[_0x543dc7(0x2b1)])this[_0x543dc7(0x249)](_0x27c0ac,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x57744a[_0x543dc7(0x2b1)]){_0x27c0ac[_0x543dc7(0x35c)](_0x543dc7(0x200))&&_0x57744a[_0x543dc7(0x247)]&&(this[_0x543dc7(0x249)](_0x27c0ac,{'val':![],'ack':!![]}),this[_0x543dc7(0x1ca)]());if(_0x27c0ac[_0x543dc7(0x35c)]('triggerDailyDigest')&&_0x57744a[_0x543dc7(0x247)]){this[_0x543dc7(0x249)](_0x27c0ac,{'val':![],'ack':!![]});if(this[_0x543dc7(0x2c8)])this[_0x543dc7(0x1a7)]();}return;}if(this[_0x543dc7(0x203)]['presenceDevices']&&this[_0x543dc7(0x203)][_0x543dc7(0x285)]['includes'](_0x27c0ac)){await this['checkWifiPresence']();return;}const _0x99d24a=(this['config'][_0x543dc7(0x2ba)]||[])[_0x543dc7(0x1d4)](_0x398978=>_0x398978['id']===_0x27c0ac);if(_0x99d24a)this['processSensorEvent'](_0x27c0ac,_0x57744a,_0x99d24a);}async[a0_0x431431(0x321)](_0x2e3663,_0x474628,_0x445862){const _0x40fac3=a0_0x431431;if(!_0x445862['logDuplicates']&&this[_0x40fac3(0x2a3)][_0x2e3663]===_0x474628[_0x40fac3(0x247)])return;this[_0x40fac3(0x2a3)][_0x2e3663]=_0x474628[_0x40fac3(0x247)];if(this['isGracePeriodActive'])return;const _0x599fb4=await this[_0x40fac3(0x34d)]();if(_0x599fb4){if(!this[_0x40fac3(0x348)])this['setPresence'](!![]);}else{const _0x2e6089=_0x445862['isExit']===!![];_0x2e6089?this[_0x40fac3(0x302)]():(this[_0x40fac3(0x1de)]&&(this['log'][_0x40fac3(0x2bd)](_0x40fac3(0x32b)),this[_0x40fac3(0x338)]()),!this[_0x40fac3(0x348)]&&this['currentSystemMode']===SYSTEM_MODES[_0x40fac3(0x2bc)]&&this[_0x40fac3(0x225)](!![]));}const _0x5bcec4={'timestamp':_0x474628['ts'],'id':_0x2e3663,'name':_0x445862['name'],'value':_0x474628['val'],'location':_0x445862[_0x40fac3(0x1f4)],'type':_0x445862[_0x40fac3(0x277)]};this[_0x40fac3(0x2e6)]['unshift'](_0x5bcec4);if(this[_0x40fac3(0x2e6)]['length']>HISTORY_MAX_SIZE)this[_0x40fac3(0x2e6)][_0x40fac3(0x313)]();await this[_0x40fac3(0x1a1)](_0x40fac3(0x271),{'val':JSON['stringify'](_0x5bcec4),'ack':!![]}),await this[_0x40fac3(0x1a1)](_0x40fac3(0x1c7),{'val':JSON['stringify'](this[_0x40fac3(0x2e6)]),'ack':!![]}),this[_0x40fac3(0x274)]['push']({'timestamp':new Date(_0x474628['ts'])[_0x40fac3(0x1a3)](),'sensorName':_0x445862[_0x40fac3(0x1bb)],'location':_0x445862[_0x40fac3(0x1f4)],'value':_0x474628['val']}),await this[_0x40fac3(0x2ac)]();}[a0_0x431431(0x302)](){const _0x13e667=a0_0x431431;this['abortExitTimer'](),this['isGracePeriodActive']=!![],this[_0x13e667(0x2dc)]=setTimeout(()=>{const _0x48e3a2=_0x13e667;this[_0x48e3a2(0x2d7)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x13e667(0x1de)]=setTimeout(()=>{const _0x3a4c81=_0x13e667;this[_0x3a4c81(0x225)](![]),this['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x431431(0x338)](){const _0x44aec5=a0_0x431431;if(this[_0x44aec5(0x1de)])clearTimeout(this['exitTimer']);if(this[_0x44aec5(0x2dc)])clearTimeout(this[_0x44aec5(0x2dc)]);this[_0x44aec5(0x1de)]=null,this[_0x44aec5(0x2dc)]=null,this[_0x44aec5(0x2d7)]=![];}async[a0_0x431431(0x225)](_0xe32e10){const _0x4de655=a0_0x431431;if(this[_0x4de655(0x348)]===_0xe32e10)return;this[_0x4de655(0x348)]=_0xe32e10,await this[_0x4de655(0x1a1)]('system.isPresent',{'val':_0xe32e10,'ack':!![]});}['runAutopilot'](){const _0x36c3b9=a0_0x431431,_0xf2ea78=this['config'][_0x36c3b9(0x1b1)],_0x2c0b86=this[_0x36c3b9(0x203)][_0x36c3b9(0x282)],_0x244431=this[_0x36c3b9(0x2e6)][_0x36c3b9(0x24e)]>0x0?this[_0x36c3b9(0x2e6)][0x0][_0x36c3b9(0x259)]:Date['now'](),_0xc5a474=(Date[_0x36c3b9(0x346)]()-_0x244431)/(0x3e8*0x3c*0x3c);let _0x1165f9='';_0x2c0b86&&this[_0x36c3b9(0x31c)]===SYSTEM_MODES['NORMAL']&&this[_0x36c3b9(0x348)]&&(_0xc5a474>_0xf2ea78&&(_0x1165f9=_0x36c3b9(0x1ce)+_0xc5a474[_0x36c3b9(0x30a)](0x1)+_0x36c3b9(0x1e4)));if(_0x1165f9){this[_0x36c3b9(0x1ca)](_0x1165f9)['catch'](_0x16ea0c=>this['log'][_0x36c3b9(0x1fe)](_0x16ea0c));return;}const _0x5f3339=Date['now'](),_0x548fdb=_0x5f3339-_0x244431,_0x48a165=(this[_0x36c3b9(0x203)][_0x36c3b9(0x1ba)]||0xf)*0x3c*0x3e8;this[_0x36c3b9(0x2e6)][_0x36c3b9(0x24e)]>0x0&&_0x548fdb<=_0x48a165?this[_0x36c3b9(0x1ca)]()[_0x36c3b9(0x260)](_0x80636f=>this['log'][_0x36c3b9(0x1fe)](_0x80636f)):!this['lastAlertState']&&(this[_0x36c3b9(0x249)](_0x36c3b9(0x1d0),{'val':![],'ack':!![]}),this['setState'](_0x36c3b9(0x2ab),{'val':![],'ack':!![]}));}async[a0_0x431431(0x1ca)](_0x4b61a6=''){const _0x54c853=a0_0x431431;if(!this[_0x54c853(0x307)])return;const _0x3292a6=this[_0x54c853(0x2e6)][_0x54c853(0x24e)]>0x0?this[_0x54c853(0x2e6)]:[{'note':_0x54c853(0x349)}],_0x50df54=PERSONA_MAPPING[this[_0x54c853(0x203)][_0x54c853(0x209)]||_0x54c853(0x298)],_0x25cde7=this['config'][_0x54c853(0x216)]||'',_0x604ef9=this[_0x54c853(0x31c)],_0x40ea80=new Date(),_0x40678a=_0x40ea80[_0x54c853(0x34e)](_0x54c853(0x314),{'weekday':_0x54c853(0x36b),'hour':_0x54c853(0x204),'minute':'2-digit'}),_0x5b32fd=this['systemConfig'];let _0x172d08='';if(this[_0x54c853(0x280)][_0x54c853(0x24e)]>0x0){const _0x4d8e1c=this['feedbackHistory'][_0x54c853(0x1f1)](0x0,0x3)[_0x54c853(0x1c1)](_0x4254ad=>_0x54c853(0x341)+_0x4254ad[_0x54c853(0x220)]+_0x54c853(0x19e)+_0x4254ad[_0x54c853(0x279)]+'.')[_0x54c853(0x1bc)]('\x0a');_0x172d08=_0x54c853(0x284)+_0x4d8e1c+'\x0a';}const _0x1c687d=_0x4b61a6?_0x54c853(0x1b7)+_0x4b61a6+_0x54c853(0x1fa):'',_0x4db5ac=_0x54c853(0x330),_0x511e57='ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20'+_0x40678a+_0x54c853(0x333)+_0x5b32fd[_0x54c853(0x292)]+_0x54c853(0x2bf)+_0x604ef9+_0x54c853(0x1d1)+(this[_0x54c853(0x348)]?'Ja':'Nein')+_0x54c853(0x300)+_0x25cde7+_0x54c853(0x318)+_0x50df54+_0x54c853(0x360)+_0x4db5ac+'\x20'+_0x172d08+'\x20'+_0x1c687d+_0x54c853(0x2fe)+JSON[_0x54c853(0x291)](_0x3292a6)+_0x54c853(0x268);try{const _0x45d0d3=await this[_0x54c853(0x307)][_0x54c853(0x353)](_0x511e57),_0x2bc621=_0x45d0d3[_0x54c853(0x1f0)][_0x54c853(0x2cd)]()['replace'](/```json|```/g,'')[_0x54c853(0x21d)](),_0x1fbb3c=JSON['parse'](_0x2bc621);await this['setStateAsync'](_0x54c853(0x1b4),{'val':_0x2bc621,'ack':!![]}),await this[_0x54c853(0x1a1)](_0x54c853(0x264),{'val':_0x1fbb3c[_0x54c853(0x1b9)][_0x54c853(0x220)]||'','ack':!![]}),await this[_0x54c853(0x1a1)](_0x54c853(0x28b),{'val':_0x1fbb3c[_0x54c853(0x1b9)][_0x54c853(0x1b6)]||'N/A','ack':!![]}),await this[_0x54c853(0x1a1)](_0x54c853(0x2fa),{'val':_0x1fbb3c[_0x54c853(0x1b9)][_0x54c853(0x336)]||_0x54c853(0x2e4),'ack':!![]});_0x1fbb3c[_0x54c853(0x213)]&&(await this['setStateAsync'](_0x54c853(0x2b5),{'val':_0x1fbb3c[_0x54c853(0x213)][_0x54c853(0x1b6)]||'','ack':!![]}),await this['setStateAsync'](_0x54c853(0x1e6),{'val':_0x1fbb3c[_0x54c853(0x213)][_0x54c853(0x241)]||'','ack':!![]}),_0x1fbb3c[_0x54c853(0x213)]['automationProposal']&&(await this[_0x54c853(0x1a1)](_0x54c853(0x1c0),{'val':_0x1fbb3c[_0x54c853(0x213)]['automationProposal']['patternDetected']||![],'ack':!![]}),await this[_0x54c853(0x1a1)]('analysis.automation.description',{'val':_0x1fbb3c[_0x54c853(0x213)][_0x54c853(0x208)][_0x54c853(0x1ee)]||'','ack':!![]}),await this[_0x54c853(0x1a1)](_0x54c853(0x2e7),{'val':_0x1fbb3c[_0x54c853(0x213)][_0x54c853(0x208)][_0x54c853(0x212)]||'','ack':!![]})));_0x1fbb3c['health']&&(await this['setStateAsync'](_0x54c853(0x2fd),{'val':typeof _0x1fbb3c[_0x54c853(0x2a6)]['sleepScore']===_0x54c853(0x215)?_0x1fbb3c[_0x54c853(0x2a6)][_0x54c853(0x25c)]:0x0,'ack':!![]}),await this[_0x54c853(0x1a1)](_0x54c853(0x29c),{'val':_0x1fbb3c[_0x54c853(0x2a6)][_0x54c853(0x36a)]||_0x54c853(0x1af),'ack':!![]}),await this['setStateAsync']('analysis.health.notes',{'val':_0x1fbb3c[_0x54c853(0x2a6)][_0x54c853(0x2d8)]||'','ack':!![]}));const _0x3fcee9=_0x1fbb3c[_0x54c853(0x1b9)][_0x54c853(0x19f)]||![],_0x330b13=_0x1fbb3c['activity']['isEmergency']||![];if(_0x3fcee9||_0x330b13){await this['setStateAsync'](_0x54c853(0x1d0),{'val':!![],'ack':!![]}),await this[_0x54c853(0x1a1)](_0x54c853(0x2ab),{'val':_0x330b13,'ack':!![]});if(!this[_0x54c853(0x355)]||_0x330b13){const _0x556c93=_0x330b13?'üö®üö®\x20NOTFALL':_0x54c853(0x1dc);this[_0x54c853(0x358)](_0x556c93+':\x20'+_0x1fbb3c[_0x54c853(0x1b9)][_0x54c853(0x220)],![],_0x330b13);}}else await this['setStateAsync'](_0x54c853(0x1d0),{'val':![],'ack':!![]}),await this[_0x54c853(0x1a1)]('analysis.isEmergency',{'val':![],'ack':!![]});this[_0x54c853(0x355)]=_0x3fcee9||_0x330b13;const _0x3c4d1c={'timestamp':Date[_0x54c853(0x346)](),'id':Date[_0x54c853(0x346)]()[_0x54c853(0x2fc)](),'analysis':_0x1fbb3c,'systemMode':_0x604ef9,'isPro':this[_0x54c853(0x2c8)]};this[_0x54c853(0x2a1)](_0x3c4d1c);}catch(_0x1cce38){this[_0x54c853(0x28f)][_0x54c853(0x1fe)](_0x54c853(0x29b)+_0x1cce38[_0x54c853(0x20b)]);}}async[a0_0x431431(0x1a7)](){const _0x6681a3=a0_0x431431;if(!this['geminiModel']||this[_0x6681a3(0x274)][_0x6681a3(0x24e)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x6681a3(0x1a1)](LTM_DP_STATUS,{'val':_0x6681a3(0x254),'ack':!![]});return;}this[_0x6681a3(0x28f)][_0x6681a3(0x2bd)](_0x6681a3(0x263)+this['rawEventLog'][_0x6681a3(0x24e)]+_0x6681a3(0x26f)),await this[_0x6681a3(0x1a1)](LTM_DP_STATUS,{'val':_0x6681a3(0x1cf),'ack':!![]});const _0x3e2882=this[_0x6681a3(0x274)][_0x6681a3(0x24e)]>0x320?this[_0x6681a3(0x274)][_0x6681a3(0x1f1)](this['rawEventLog'][_0x6681a3(0x24e)]-0x320):this['rawEventLog'],_0x44e37d=PERSONA_MAPPING[this[_0x6681a3(0x203)][_0x6681a3(0x209)]||_0x6681a3(0x298)],_0x2e6735='ROLLE:\x20Data\x20Analyst.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20'+_0x44e37d+_0x6681a3(0x27d)+JSON[_0x6681a3(0x291)](_0x3e2882)+_0x6681a3(0x1a0);try{const _0x4f8875=await this['geminiModel'][_0x6681a3(0x353)](_0x2e6735),_0x2f9d1b=_0x4f8875[_0x6681a3(0x1f0)][_0x6681a3(0x2cd)]()[_0x6681a3(0x27b)](/```json|```/g,'')[_0x6681a3(0x21d)](),_0x3671e5=JSON[_0x6681a3(0x26c)](_0x2f9d1b),_0x406acf={'timestamp':new Date()['toISOString'](),'eventCount':this['rawEventLog'][_0x6681a3(0x24e)],'summary':_0x3671e5[_0x6681a3(0x1b6)],'activityLevel':_0x3671e5['activityLevel'],'systemMode':this['currentSystemMode'],'health':{'sleepScore':_0x3671e5['health']?_0x3671e5[_0x6681a3(0x2a6)]['sleepScore']:0x0,'restlessness':_0x3671e5[_0x6681a3(0x2a6)]?_0x3671e5[_0x6681a3(0x2a6)][_0x6681a3(0x36a)]:'none'}};this['dailyDigests'][_0x6681a3(0x2b9)](_0x406acf),await this[_0x6681a3(0x245)](),this[_0x6681a3(0x274)]=[],await this[_0x6681a3(0x2ac)](),await this[_0x6681a3(0x1a1)](LTM_DP_STATUS,{'val':_0x6681a3(0x261),'ack':!![]}),this[_0x6681a3(0x28f)][_0x6681a3(0x2bd)]('Daily\x20Digest\x20created\x20successfully.');}catch(_0x2e61aa){this[_0x6681a3(0x28f)][_0x6681a3(0x1fe)]('Daily\x20Digest\x20Error:\x20'+_0x2e61aa[_0x6681a3(0x20b)]),await this[_0x6681a3(0x1a1)](LTM_DP_STATUS,{'val':_0x6681a3(0x1c9)+_0x2e61aa['message'],'ack':!![]});}}async[a0_0x431431(0x1a8)](){const _0x4e6a7f=a0_0x431431;try{const _0x435809=await this[_0x4e6a7f(0x2c5)]('events.history');_0x435809&&_0x435809[_0x4e6a7f(0x247)]&&(this[_0x4e6a7f(0x2e6)]=JSON[_0x4e6a7f(0x26c)](_0x435809['val']['toString']()));}catch(_0x25c95c){this[_0x4e6a7f(0x2e6)]=[];}try{const _0x1aa570=await this['getStateAsync'](_0x4e6a7f(0x22b));if(_0x1aa570&&_0x1aa570['val'])this['analysisHistory']=JSON[_0x4e6a7f(0x26c)](_0x1aa570[_0x4e6a7f(0x247)][_0x4e6a7f(0x2fc)]());}catch(_0x19f743){this['analysisHistory']=[];}}async[a0_0x431431(0x2b3)](){const _0xd32cde=a0_0x431431;await this['checkSystemObjects'](),await this[_0xd32cde(0x1b5)](_0xd32cde(0x354),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x1e3),'type':'boolean','role':'indicator','read':!![],'write':![],'def':!![]},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x271),{'type':_0xd32cde(0x1fb),'common':{'name':'Last\x20raw\x20event','type':_0xd32cde(0x253),'role':_0xd32cde(0x22f),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xd32cde(0x1c7),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x1a6),'type':'string','role':_0xd32cde(0x22f),'read':!![],'write':![]},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x200),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x2a2),'type':_0xd32cde(0x345),'role':_0xd32cde(0x202),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xd32cde(0x1b4),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x1c3),'type':'string','role':_0xd32cde(0x22f),'read':!![],'write':![]},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x1d0),{'type':'state','common':{'name':_0xd32cde(0x1bf),'type':_0xd32cde(0x345),'role':_0xd32cde(0x23c),'read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xd32cde(0x2ab),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x309),'type':_0xd32cde(0x345),'role':_0xd32cde(0x2c0),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x264),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x337),'type':_0xd32cde(0x253),'role':_0xd32cde(0x30f),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xd32cde(0x28b),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x273),'type':_0xd32cde(0x253),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x2fa),{'type':'state','common':{'name':_0xd32cde(0x1f7),'type':_0xd32cde(0x253),'role':'state','read':!![],'write':![],'def':_0xd32cde(0x2e4)},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x2b5),{'type':_0xd32cde(0x1fb),'common':{'name':'Comfort\x20Summary','type':_0xd32cde(0x253),'role':_0xd32cde(0x2cd),'read':!![],'write':![]},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x1e6),{'type':'state','common':{'name':_0xd32cde(0x1cc),'type':_0xd32cde(0x253),'role':_0xd32cde(0x2cd),'read':!![],'write':![]},'native':{}}),await this[_0xd32cde(0x207)](_0xd32cde(0x25e),{'type':_0xd32cde(0x1d2),'common':{'name':_0xd32cde(0x2ce)},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x1c0),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x34b),'type':_0xd32cde(0x345),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await this[_0xd32cde(0x1b5)]('analysis.automation.description',{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x26a),'type':_0xd32cde(0x253),'role':_0xd32cde(0x2cd),'read':!![],'write':![]},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x2e7),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x293),'type':_0xd32cde(0x253),'role':_0xd32cde(0x2cd),'read':!![],'write':![]},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x22b),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x28e),'type':'string','role':_0xd32cde(0x22f),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0xd32cde(0x1b0),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x2d4),'type':'string','role':_0xd32cde(0x22f),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0xd32cde(0x207)](_0xd32cde(0x365),{'type':_0xd32cde(0x1d2),'common':{'name':_0xd32cde(0x1df)},'native':{}}),await this['setObjectNotExistsAsync'](_0xd32cde(0x2fd),{'type':_0xd32cde(0x1fb),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0xd32cde(0x215),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await this['setObjectNotExistsAsync'](_0xd32cde(0x29c),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x1a9),'type':'string','role':_0xd32cde(0x2cd),'read':!![],'write':![],'def':_0xd32cde(0x1af)},'native':{}}),await this[_0xd32cde(0x1b5)](_0xd32cde(0x359),{'type':_0xd32cde(0x1fb),'common':{'name':_0xd32cde(0x305),'type':'string','role':_0xd32cde(0x2cd),'read':!![],'write':![],'def':''},'native':{}}),await this[_0xd32cde(0x1ef)](),await this[_0xd32cde(0x281)]();}async[a0_0x431431(0x2d5)](){const _0x522afc=a0_0x431431;await this['extendObjectAsync'](_0x522afc(0x2ed),{'type':_0x522afc(0x1d2),'common':{'name':_0x522afc(0x24f)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x522afc(0x1fb),'common':{'name':_0x522afc(0x2bb),'type':_0x522afc(0x253),'role':_0x522afc(0x1fb),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x522afc(0x2bc)],'states':{[SYSTEM_MODES[_0x522afc(0x2bc)]]:_0x522afc(0x233),[SYSTEM_MODES['VACATION']]:'Urlaub',[SYSTEM_MODES[_0x522afc(0x2c6)]]:_0x522afc(0x229),[SYSTEM_MODES[_0x522afc(0x2d3)]]:'Gast'}},'native':{}});}async['sendNotification'](_0x558a93,_0x97e3e2=![],_0x518736=![]){const _0x24c060=a0_0x431431;this[_0x24c060(0x28f)][_0x24c060(0x2bd)]((_0x97e3e2?_0x24c060(0x2ee):'')+_0x24c060(0x2f9)+_0x558a93+'\x22'+(_0x518736?_0x24c060(0x29d):''));const _0x1364aa=this[_0x24c060(0x203)];let _0x389453=0x0;_0x1364aa[_0x24c060(0x1fd)]&&_0x1364aa[_0x24c060(0x2d2)]&&(await this['sendToAsync'](_0x1364aa['notifyTelegramInstance'],'send',{'text':_0x558a93,'user':_0x1364aa[_0x24c060(0x1d6)]}),_0x389453++);if(_0x1364aa[_0x24c060(0x369)]&&_0x1364aa['notifyPushoverInstance']){let _0x3cfe36={'message':_0x558a93,'title':_0x518736?_0x24c060(0x25d):_0x24c060(0x2d9),'priority':_0x518736?0x2:0x1,'device':_0x1364aa[_0x24c060(0x2df)]};_0x518736&&(_0x3cfe36[_0x24c060(0x2f4)]=0x1e,_0x3cfe36['expire']=0xe10,_0x3cfe36[_0x24c060(0x21a)]=_0x24c060(0x1ae)),await this[_0x24c060(0x36c)](_0x1364aa['notifyPushoverInstance'],_0x24c060(0x2aa),_0x3cfe36),_0x389453++;}return _0x1364aa[_0x24c060(0x319)]&&_0x1364aa[_0x24c060(0x2dd)]&&(await this[_0x24c060(0x36c)](_0x1364aa['notifyEmailInstance'],_0x24c060(0x2aa),{'text':_0x558a93,'to':_0x1364aa[_0x24c060(0x22d)]}),_0x389453++),_0x1364aa[_0x24c060(0x2d0)]&&_0x1364aa[_0x24c060(0x2ae)]&&(await this[_0x24c060(0x36c)](_0x1364aa[_0x24c060(0x2ae)],_0x24c060(0x2aa),{'text':_0x558a93,'phone':_0x1364aa[_0x24c060(0x24c)]}),_0x389453++),_0x1364aa[_0x24c060(0x265)]&&_0x1364aa['notifySignalInstance']&&(await this['sendToAsync'](_0x1364aa['notifySignalInstance'],'send',{'text':_0x558a93,'phone':_0x1364aa[_0x24c060(0x352)]}),_0x389453++),_0x389453;}async['loadRawEventLog'](){const _0x1184d5=a0_0x431431;try{const _0x5c669f=await this[_0x1184d5(0x2c5)](LTM_DP_RAW_LOG);if(_0x5c669f&&_0x5c669f['val'])this[_0x1184d5(0x274)]=JSON['parse'](_0x5c669f['val']);}catch(_0x25d159){this[_0x1184d5(0x274)]=[];}}async['saveRawEventLog'](){const _0x59c797=a0_0x431431;this[_0x59c797(0x274)][_0x59c797(0x24e)]>RAW_LOG_MAX_SIZE&&this['rawEventLog']['splice'](0x0,this[_0x59c797(0x274)][_0x59c797(0x24e)]-RAW_LOG_MAX_SIZE),await this[_0x59c797(0x1a1)](LTM_DP_RAW_LOG,{'val':JSON[_0x59c797(0x291)](this[_0x59c797(0x274)]),'ack':!![]});}async[a0_0x431431(0x288)](){const _0x4af25a=a0_0x431431;try{const _0x311976=await this[_0x4af25a(0x2c5)](LTM_DP_DAILY_DIGESTS);if(_0x311976&&_0x311976[_0x4af25a(0x247)])this[_0x4af25a(0x2c2)]=JSON[_0x4af25a(0x26c)](_0x311976[_0x4af25a(0x247)]);}catch(_0x329d2a){this[_0x4af25a(0x2c2)]=[];}await this[_0x4af25a(0x230)]();}async[a0_0x431431(0x245)](_0x305cf6=!![]){const _0xd6017b=a0_0x431431,_0x158c24=this[_0xd6017b(0x203)][_0xd6017b(0x1e7)]||0x3c;this['dailyDigests'][_0xd6017b(0x24e)]>_0x158c24&&this[_0xd6017b(0x2c2)][_0xd6017b(0x246)](0x0,this[_0xd6017b(0x2c2)][_0xd6017b(0x24e)]-_0x158c24);await this[_0xd6017b(0x1a1)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0xd6017b(0x291)](this[_0xd6017b(0x2c2)]),'ack':!![]});if(_0x305cf6)await this[_0xd6017b(0x230)]();}[a0_0x431431(0x1f8)](){const _0x52b1a5=a0_0x431431;if(this[_0x52b1a5(0x361)])this[_0x52b1a5(0x361)][_0x52b1a5(0x29f)]();if(!this[_0x52b1a5(0x2c8)]){this[_0x52b1a5(0x1a1)](LTM_DP_STATUS,{'val':_0x52b1a5(0x334),'ack':!![]});return;}this['ltmJob']=schedule[_0x52b1a5(0x205)](LTM_SCHEDULE,()=>this[_0x52b1a5(0x1a7)]());}[a0_0x431431(0x23e)](){const _0x4e2ed9=a0_0x431431;if(this[_0x4e2ed9(0x283)])clearInterval(this[_0x4e2ed9(0x283)]);if(!this[_0x4e2ed9(0x2c8)])return;this[_0x4e2ed9(0x283)]=setInterval(()=>this[_0x4e2ed9(0x244)](),(this[_0x4e2ed9(0x203)][_0x4e2ed9(0x20c)]||0x18)*0x36ee80),setTimeout(()=>this[_0x4e2ed9(0x244)](),0x1388);}async[a0_0x431431(0x1d7)](){const _0x18e687=a0_0x431431;await this['setStateAsync'](_0x18e687(0x28b),{'val':_0x18e687(0x2f5),'ack':!![]}),await this['setStateAsync'](_0x18e687(0x2fa),{'val':this['isProVersion']?_0x18e687(0x1e5):'N/A\x20(Pro\x20Feature)','ack':!![]}),await this['setStateAsync'](_0x18e687(0x1d0),{'val':![],'ack':!![]}),await this[_0x18e687(0x1a1)](_0x18e687(0x2ab),{'val':![],'ack':!![]}),this['lastAlertState']=![];}async[a0_0x431431(0x2a1)](_0x405955){const _0x48f5ff=a0_0x431431;this[_0x48f5ff(0x2ec)][_0x48f5ff(0x1be)](_0x405955);if(this['analysisHistory'][_0x48f5ff(0x24e)]>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0x48f5ff(0x313)]();await this[_0x48f5ff(0x1a1)](_0x48f5ff(0x22b),{'val':JSON['stringify'](this['analysisHistory']),'ack':!![]});}[a0_0x431431(0x324)](){const _0x1e0a2a=a0_0x431431;if(this['modeResetJob'])this[_0x1e0a2a(0x1f5)][_0x1e0a2a(0x29f)]();this[_0x1e0a2a(0x1f5)]=schedule[_0x1e0a2a(0x205)](MODE_RESET_SCHEDULE,async()=>{const _0x30c6b5=_0x1e0a2a;await this[_0x30c6b5(0x320)](),AUTO_RESET_MODES['includes'](this[_0x30c6b5(0x31c)])&&await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x30c6b5(0x2bc)],'ack':![]});});}async[a0_0x431431(0x230)](){const _0x4c5d07=a0_0x431431;if(!this['isProVersion']){await this[_0x4c5d07(0x1a1)](LTM_DP_BASELINE_STATUS,{'val':_0x4c5d07(0x334),'ack':!![]});return;}const _0x4cbcaa=this[_0x4c5d07(0x2c2)][_0x4c5d07(0x24e)]>=(this[_0x4c5d07(0x203)][_0x4c5d07(0x1a4)]||0x7)?'Aktiv\x20('+this[_0x4c5d07(0x2c2)][_0x4c5d07(0x24e)]+'\x20Tage)':'Lernphase\x20('+this['dailyDigests']['length']+'/'+(this[_0x4c5d07(0x203)][_0x4c5d07(0x1a4)]||0x7)+')';await this[_0x4c5d07(0x1a1)](LTM_DP_BASELINE_STATUS,{'val':_0x4cbcaa,'ack':!![]});}async[a0_0x431431(0x1ef)](){const _0x11f3e4=a0_0x431431;await this[_0x11f3e4(0x207)]('LTM',{'type':'channel','common':{'name':_0x11f3e4(0x257)},'native':{}}),await this['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x11f3e4(0x1fb),'common':{'name':_0x11f3e4(0x1e8),'type':_0x11f3e4(0x253),'role':_0x11f3e4(0x22f),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x11f3e4(0x1e1),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_STATUS,{'type':'state','common':{'name':_0x11f3e4(0x1ac),'type':_0x11f3e4(0x253),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x11f3e4(0x207)](LTM_DP_TRIGGER_DIGEST,{'type':_0x11f3e4(0x1fb),'common':{'name':_0x11f3e4(0x31e),'type':_0x11f3e4(0x345),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x11f3e4(0x1fb),'common':{'name':'Baseline\x20Status','type':_0x11f3e4(0x253),'role':_0x11f3e4(0x2cd),'read':!![],'write':![]},'native':{}});}async[a0_0x431431(0x281)](){const _0x35b8de=a0_0x431431;await this['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x35b8de(0x1d2),'common':{'name':_0x35b8de(0x289)},'native':{}}),await this[_0x35b8de(0x207)](LTM_DP_DRIFT_STATUS,{'type':_0x35b8de(0x1fb),'common':{'name':_0x35b8de(0x23a),'type':_0x35b8de(0x253),'role':'state','read':!![],'write':![],'def':_0x35b8de(0x2e4)},'native':{}}),await this[_0x35b8de(0x207)](LTM_DP_DRIFT_DETAILS,{'type':_0x35b8de(0x1fb),'common':{'name':_0x35b8de(0x325),'type':'string','role':_0x35b8de(0x2cd),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x35b8de(0x218),'type':_0x35b8de(0x215),'role':_0x35b8de(0x2f0),'read':!![],'write':![]},'native':{}});}async[a0_0x431431(0x244)](){const _0x1c9aca=a0_0x431431;if(!this[_0x1c9aca(0x2c8)]||!this['geminiModel'])return;const _0x28454d=this[_0x1c9aca(0x203)][_0x1c9aca(0x2a8)]||0xe;if(this[_0x1c9aca(0x2c2)][_0x1c9aca(0x24e)]<_0x28454d+(this[_0x1c9aca(0x203)][_0x1c9aca(0x1a4)]||0x7)){await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x1c9aca(0x1ff),'ack':!![]});return;}const _0x4e18e8=this['dailyDigests']['slice'](-_0x28454d),_0x200ce9=this[_0x1c9aca(0x2c2)]['slice'](0x0,this[_0x1c9aca(0x2c2)]['length']-_0x28454d),_0x12b674=_0x1c9aca(0x275)+JSON['stringify'](_0x200ce9)+_0x1c9aca(0x21e)+JSON[_0x1c9aca(0x291)](_0x4e18e8);try{const _0x27d824=await this['geminiModel'][_0x1c9aca(0x353)](_0x12b674),_0x4a8537=JSON['parse'](_0x27d824[_0x1c9aca(0x1f0)][_0x1c9aca(0x2cd)]()['replace'](/```json|```/g,'')[_0x1c9aca(0x21d)]());_0x4a8537[_0x1c9aca(0x362)]&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x4a8537[_0x1c9aca(0x362)],'ack':!![]}),await this[_0x1c9aca(0x1a1)](LTM_DP_DRIFT_DETAILS,{'val':_0x4a8537[_0x1c9aca(0x2e8)],'ack':!![]}),await this[_0x1c9aca(0x1a1)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x1c9aca(0x346)](),'ack':!![]}));}catch(_0x7481f2){}}async[a0_0x431431(0x320)](){const _0x218223=a0_0x431431;try{const _0x202940=await this['getStateAsync'](SYSTEM_DP_MODE);_0x202940&&_0x202940['val']&&Object[_0x218223(0x2e1)](SYSTEM_MODES)[_0x218223(0x35c)](_0x202940[_0x218223(0x247)])?this['currentSystemMode']=_0x202940['val']:(this['currentSystemMode']=SYSTEM_MODES['NORMAL'],await this[_0x218223(0x1a1)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x218223(0x2bc)],'ack':!![]}));}catch(_0xa81005){this['currentSystemMode']=SYSTEM_MODES[_0x218223(0x2bc)];}}async[a0_0x431431(0x308)](){const _0x5e60e1=a0_0x431431;try{const _0x50729e=await this[_0x5e60e1(0x20a)](_0x5e60e1(0x20e));if(_0x50729e&&_0x50729e[_0x5e60e1(0x1e0)]&&_0x50729e['native']['uuid'])return _0x50729e[_0x5e60e1(0x1e0)][_0x5e60e1(0x272)];return _0x5e60e1(0x219);}catch(_0x15177a){return _0x5e60e1(0x20f);}}async[a0_0x431431(0x2d1)](_0x43ee46){const _0xac4f4a=a0_0x431431;if(!_0x43ee46)return![];this[_0xac4f4a(0x323)]=await this['getSystemUUID']();if(_0x43ee46===_0xac4f4a(0x26b)||_0x43ee46['startsWith'](_0xac4f4a(0x295)))return!![];return![];}[a0_0x431431(0x2cc)](_0x44fa41){const _0x5f0ec6=a0_0x431431;if(this[_0x5f0ec6(0x1cd)])clearInterval(this['analysisTimer']);if(this[_0x5f0ec6(0x283)])clearInterval(this[_0x5f0ec6(0x283)]);if(this[_0x5f0ec6(0x361)])this[_0x5f0ec6(0x361)]['cancel']();if(this[_0x5f0ec6(0x1f5)])this[_0x5f0ec6(0x1f5)][_0x5f0ec6(0x29f)]();if(this[_0x5f0ec6(0x1de)])clearTimeout(this[_0x5f0ec6(0x1de)]);if(this[_0x5f0ec6(0x2dc)])clearTimeout(this[_0x5f0ec6(0x2dc)]);_0x44fa41();}async[a0_0x431431(0x33c)](_0x3e04ae){const _0x4eabdb=a0_0x431431;if(typeof _0x3e04ae===_0x4eabdb(0x32f)&&_0x3e04ae[_0x4eabdb(0x20b)]){if(_0x3e04ae['command']===_0x4eabdb(0x35e)){if(!_0x3e04ae['message'][_0x4eabdb(0x243)])return this[_0x4eabdb(0x36d)](_0x3e04ae['from'],_0x3e04ae['command'],{'success':![],'message':'No\x20Key'},_0x3e04ae[_0x4eabdb(0x222)]);try{const _0x1e2541=new GoogleGenerativeAI(_0x3e04ae[_0x4eabdb(0x20b)][_0x4eabdb(0x243)])[_0x4eabdb(0x1b3)]({'model':_0x4eabdb(0x22a)});await _0x1e2541['generateContent']('test'),this[_0x4eabdb(0x36d)](_0x3e04ae[_0x4eabdb(0x2f7)],_0x3e04ae[_0x4eabdb(0x1bd)],{'success':!![],'message':_0x4eabdb(0x32a)},_0x3e04ae['callback']);}catch(_0x55a66f){this[_0x4eabdb(0x36d)](_0x3e04ae[_0x4eabdb(0x2f7)],_0x3e04ae['command'],{'success':![],'message':_0x55a66f['message']},_0x3e04ae[_0x4eabdb(0x222)]);}}else{if(_0x3e04ae[_0x4eabdb(0x1bd)]===_0x4eabdb(0x224)){const _0x107cdc=await this['sendNotification'](_0x4eabdb(0x1fc),!![]);this[_0x4eabdb(0x36d)](_0x3e04ae[_0x4eabdb(0x2f7)],_0x3e04ae['command'],{'success':_0x107cdc>0x0,'message':_0x107cdc+_0x4eabdb(0x2ff)},_0x3e04ae['callback']);}else{if(_0x3e04ae[_0x4eabdb(0x1bd)]===_0x4eabdb(0x1c5)){if(!this[_0x4eabdb(0x2c8)])return this['sendTo'](_0x3e04ae[_0x4eabdb(0x2f7)],_0x3e04ae[_0x4eabdb(0x1bd)],{'success':![],'isPro':![]},_0x3e04ae[_0x4eabdb(0x222)]);let _0x223d7a={'status':_0x4eabdb(0x2e4),'details':'','lastCheck':0x0};try{_0x223d7a[_0x4eabdb(0x278)]=(await this[_0x4eabdb(0x2c5)](LTM_DP_DRIFT_STATUS))[_0x4eabdb(0x247)],_0x223d7a[_0x4eabdb(0x356)]=(await this[_0x4eabdb(0x2c5)](LTM_DP_DRIFT_DETAILS))[_0x4eabdb(0x247)],_0x223d7a[_0x4eabdb(0x29e)]=(await this[_0x4eabdb(0x2c5)](LTM_DP_DRIFT_LAST_CHECK))[_0x4eabdb(0x247)];}catch(_0x3aed9b){}this[_0x4eabdb(0x36d)](_0x3e04ae[_0x4eabdb(0x2f7)],_0x3e04ae[_0x4eabdb(0x1bd)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x4eabdb(0x2c2)],'driftAnalysis':_0x223d7a,'analysisHistory':this[_0x4eabdb(0x2ec)]},_0x3e04ae[_0x4eabdb(0x222)]);}else{if(_0x3e04ae['command']===_0x4eabdb(0x2c1)){const _0x2ec0db=await this[_0x4eabdb(0x1e9)](_0x4eabdb(0x19d),'enum'),_0x4b79a4=[];if(_0x2ec0db)for(const _0x3bc7b9 in _0x2ec0db){const _0x1470cb=_0x2ec0db[_0x3bc7b9],_0x17caa5=(_0x1470cb[_0x4eabdb(0x35f)]&&typeof _0x1470cb[_0x4eabdb(0x35f)][_0x4eabdb(0x1bb)]===_0x4eabdb(0x32f)?_0x1470cb[_0x4eabdb(0x35f)][_0x4eabdb(0x1bb)]['de']:_0x1470cb[_0x4eabdb(0x35f)][_0x4eabdb(0x1bb)])||_0x1470cb[_0x4eabdb(0x35f)][_0x4eabdb(0x1bb)];_0x4b79a4['push']({'id':_0x3bc7b9,'name':_0x17caa5});}this[_0x4eabdb(0x36d)](_0x3e04ae['from'],_0x3e04ae[_0x4eabdb(0x1bd)],{'success':!![],'enums':_0x4b79a4},_0x3e04ae[_0x4eabdb(0x222)]);}else{if(_0x3e04ae['command']==='scanDevices')try{const _0x44fc63=await this['scanForDevices'](_0x3e04ae[_0x4eabdb(0x20b)]||{});this[_0x4eabdb(0x36d)](_0x3e04ae['from'],_0x3e04ae[_0x4eabdb(0x1bd)],{'success':!![],'devices':_0x44fc63},_0x3e04ae[_0x4eabdb(0x222)]);}catch(_0x371cd5){this[_0x4eabdb(0x36d)](_0x3e04ae[_0x4eabdb(0x2f7)],_0x3e04ae[_0x4eabdb(0x1bd)],{'success':![],'error':_0x371cd5[_0x4eabdb(0x20b)]},_0x3e04ae['callback']);}else{if(_0x3e04ae[_0x4eabdb(0x1bd)]===_0x4eabdb(0x217)){const {historyId:_0x5299a0,rating:_0x145e3d,comment:_0x438436,alertReason:_0x4be4de}=_0x3e04ae['message'];_0x5299a0&&_0x145e3d?(await this[_0x4eabdb(0x2a9)]({'timestamp':Date[_0x4eabdb(0x346)](),'historyId':_0x5299a0,'rating':_0x145e3d,'comment':_0x438436,'alertReason':_0x4be4de}),this[_0x4eabdb(0x36d)](_0x3e04ae[_0x4eabdb(0x2f7)],_0x3e04ae[_0x4eabdb(0x1bd)],{'success':!![]},_0x3e04ae[_0x4eabdb(0x222)])):this[_0x4eabdb(0x36d)](_0x3e04ae[_0x4eabdb(0x2f7)],_0x3e04ae[_0x4eabdb(0x1bd)],{'success':![],'error':_0x4eabdb(0x347)},_0x3e04ae[_0x4eabdb(0x222)]);}}}}}}}}}if(require['main']!==module)module[a0_0x431431(0x32e)]=_0x5ceda7=>new CogniLiving(_0x5ceda7);else new CogniLiving();