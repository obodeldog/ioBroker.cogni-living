function a0_0xf271(){const _0x3f498a=['fill','manual','SYSTEM_MODES','createAllObjects','updateTopologyMatrix','calendarName','slice','klar','abs','system.mode','subscribeStates','3065475SaPBmv','PYTHON_EXE','find','generateContent','NextHours.Location_1.Day_1.current.symbol_desc','initHistory','ack','TRAIN_ENERGY','map','createDailyDigest','scanThermostats','Active\x20Ventilation\x20Alerts','\x20Tage)','.data.table','PINN\x20AI\x20Forecast','command','isGracePeriodActive','licenseKey','config','eventHistory','ANALYZE_TREND','371cNjljE','SET_LEARNING_MODE','cogni-living\x20adapter\x20starting\x20(v','presenceDevices','Gesendet','getForeignStateAsync','error','enum','Fehler:\x20','weatherunderground.0','onReady','getForeignObjectsAsync','daswetter.0','triggerGaitAnalysis','updateHealthVector','exitGraceTimer','TRAIN_HEALTH','VACATION','5WrIlyA','setObjectNotExistsAsync','loadSystemMode','getState','callback','apply','object','inactivityThresholdHours','LTM.trainingData.sequences','startService','heiter','./lib/recorder','message','json','systemConfig','97518IKhupN','triggerEnergyPrediction','sonn','minutes_safe','cancel','analysisHistory','setupLtmScheduler','length','./lib/setup','analysis.automation.description','setState','driftAnalysisTimer','961816CudQdY','notifyTelegramEnabled','clear','forEach','analysis.automation.targetId','sendMorningBriefing','.communicate.request','getOverviewData','apiKey','name','ANALYZE_GAIT','Sec-Training\x20started...','checkCalendarTriggers','Kein\x20Wetter-Adapter','exitTimer','onStateChange','toLowerCase','useWeather','initSystemConfig','LTM.dailyDigests','./lib/scheduler','./lib/ai_agent','setupBriefingScheduler','namespace','modeResetJob','values','analysis.training.triggerTopology','processSensorEvent','analysis.trigger','SET_TOPOLOGY','sort','state','isPresent','Lernphase\x20(','location','triggerBriefing','val','floor','checkThermostats','type','setupModeResetScheduler','analysis.security.learningStatus','simulateEnergyMPC','TRAIN_SECURITY','WiFi\x20Presence\x20detected.','getGenerativeModel','cogni-living','Heizung\x20kann\x20','setPresence','system.presenceWho','motion','automation.triggerAction','783028rcytcl','3256263KvKpQW','communicate.request','analysis.triggerBriefing','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','analysis.automation.triggerAction','currentSystemMode','_calName','(((.+)+)+)+$','some','onUnload','parse','rawEventLog','SYSTEM_DP_MODE','OPTIMIZE_ENERGY','Kein\x20API\x20Key\x20Ã¼bergeben','log','lastAlertState','enum.rooms.*','dailyDigests','./lib/python_bridge','sendTo','info','scanDevices','scanForDevices','updateLocation','timestamp','abortExitTimer','minDaysForBaseline','./lib/dead_man','devices','enum.functions.*','1026948SukZVq','genAI','push','setupDriftAnalysisScheduler','testApiKey','now','Activity-Level','initZombies','analysis.training.triggerHealth','isSolar',')\x20-\x20Phase\x20C\x20(Adaptive\x20Security\x20&\x20Smart\x20Schedule)','startSystem','analysis.automation.autoApply','runGeminiAnalysis','PREDICT_ENERGY','exports','runAutopilot','runPythonHealthCheck','scores','notifyTelegramInstance','getMinutes','setStateAsync','dismissAutomation','endsWith','subscribeForeignStatesAsync','matrix','analysis.training.triggerSecurity','constructor','LTM.trainingData.thermodynamics','getOutsideTemperatureNumeric','isProVersion','LTM.rawEventLog','2286832Uhacja','version','checkWifiPresence','sunny','analysisTimer','from','briefingJob','Verbunden','Instanz\x20nicht\x20gefunden','dependencyInstallInProgress','testNotification','debug','bind','analysis.training.triggerComfort','geminiApiKey','analysis.training.triggerEnergy','@google/generative-ai','common','TRAIN_COMFORT','send','analysis.health.todayVector','analysis.automation.patternDetected','string','analysis.energy.insulationScore','getHours','keys','getEnums','text','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','Gemini\x20AI\x20initialized.','./lib/automation','getForeignObjectAsync','calendarInstance','analysis.automation.targetValue','ltmJob','updateTopology','includes','Guest\x20Mode','search','stringify','getStateAsync','toString','geminiModel','simulateButler','stopService','NORMAL','temperature','add','join','updated','checkSolarCondition','setHours','analysis.training.status','application/json','Simulation\x20durch\x20Admin\x20(Test)','testContext','Gemini\x20Init\x20Error:\x20'];a0_0xf271=function(){return _0x3f498a;};return a0_0xf271();}const a0_0x5a3017=a0_0x18d5;(function(_0x2ddfe0,_0x3836a0){const _0xb84aa8=a0_0x18d5,_0x3785de=_0x2ddfe0();while(!![]){try{const _0xc64556=-parseInt(_0xb84aa8(0x1db))/0x1+-parseInt(_0xb84aa8(0x22f))/0x2+parseInt(_0xb84aa8(0x199))/0x3+-parseInt(_0xb84aa8(0x20f))/0x4*(-parseInt(_0xb84aa8(0x1c0))/0x5)+parseInt(_0xb84aa8(0x1cf))/0x6*(parseInt(_0xb84aa8(0x1ae))/0x7)+parseInt(_0xb84aa8(0x24f))/0x8+-parseInt(_0xb84aa8(0x210))/0x9;if(_0xc64556===_0x3836a0)break;else _0x3785de['push'](_0x3785de['shift']());}catch(_0x4344df){_0x3785de['push'](_0x3785de['shift']());}}}(a0_0xf271,0x80d84));const a0_0x19f919=(function(){let _0x41a170=!![];return function(_0x3af4da,_0x25c9e5){const _0x353b61=_0x41a170?function(){const _0x5d955f=a0_0x18d5;if(_0x25c9e5){const _0x4c4139=_0x25c9e5[_0x5d955f(0x1c5)](_0x3af4da,arguments);return _0x25c9e5=null,_0x4c4139;}}:function(){};return _0x41a170=![],_0x353b61;};}()),a0_0x318012=a0_0x19f919(this,function(){const _0x27ff12=a0_0x18d5;return a0_0x318012[_0x27ff12(0x17e)]()['search']('(((.+)+)+)+$')['toString']()[_0x27ff12(0x24a)](a0_0x318012)[_0x27ff12(0x17b)](_0x27ff12(0x217));});a0_0x318012();function a0_0x18d5(_0x5279b1,_0x4c4f27){const _0x5b7c5b=a0_0xf271();return a0_0x18d5=function(_0x318012,_0x19f919){_0x318012=_0x318012-0x15b;let _0xf2710=_0x5b7c5b[_0x318012];return _0xf2710;},a0_0x18d5(_0x5279b1,_0x4c4f27);}'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x5a3017(0x165)),installer=require('./lib/installer'),scanner=require('./lib/scanner'),schedulers=require(a0_0x5a3017(0x1ef)),topology=require('./lib/topology'),setup=require(a0_0x5a3017(0x1d7)),recorder=require(a0_0x5a3017(0x1cb)),pythonBridge=require(a0_0x5a3017(0x223)),aiAgent=require(a0_0x5a3017(0x1f0)),deadMan=require(a0_0x5a3017(0x22c)),automation=require(a0_0x5a3017(0x173)),GEMINI_MODEL='models/gemini-flash-latest',ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils['Adapter']{constructor(_0x497845){const _0x53fc56=a0_0x5a3017;super({..._0x497845,'name':_0x53fc56(0x209)}),this[_0x53fc56(0x1ac)]=[],this[_0x53fc56(0x1d4)]=[],this['rawEventLog']=[],this[_0x53fc56(0x222)]=[],this['sensorLastValues']={},this[_0x53fc56(0x1ce)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x53fc56(0x1fb)]=!![],this[_0x53fc56(0x1e9)]=null,this[_0x53fc56(0x1bd)]=null,this[_0x53fc56(0x1a9)]=![],this[_0x53fc56(0x230)]=null,this[_0x53fc56(0x17f)]=null,this[_0x53fc56(0x215)]=setup[_0x53fc56(0x190)][_0x53fc56(0x182)],this[_0x53fc56(0x24d)]=![],this[_0x53fc56(0x220)]=![],this[_0x53fc56(0x253)]=null,this[_0x53fc56(0x177)]=null,this[_0x53fc56(0x1f3)]=null,this['driftAnalysisTimer']=null,this[_0x53fc56(0x15b)]=null,this[_0x53fc56(0x15e)]=![],this['on']('ready',this['onReady'][_0x53fc56(0x161)](this)),this['on']('stateChange',this[_0x53fc56(0x1ea)][_0x53fc56(0x161)](this)),this['on']('unload',this[_0x53fc56(0x219)][_0x53fc56(0x161)](this)),this['on'](_0x53fc56(0x1cc),this['onMessage'][_0x53fc56(0x161)](this));}async[a0_0x5a3017(0x1b8)](){const _0xb5d6c4=a0_0x5a3017;this[_0xb5d6c4(0x21f)][_0xb5d6c4(0x225)](_0xb5d6c4(0x1b0)+this[_0xb5d6c4(0x250)]+_0xb5d6c4(0x239));if(!installer['checkAndInstall'](this,()=>this[_0xb5d6c4(0x23a)]()))return;}async[a0_0x5a3017(0x23a)](){const _0x168937=a0_0x5a3017;await setup[_0x168937(0x236)](this);try{this['isProVersion']=await setup['checkLicense'](this[_0x168937(0x1ab)][_0x168937(0x1aa)]);}catch(_0x16e153){}if(!this['config']['inactivityThresholdHours']||this[_0x168937(0x1ab)][_0x168937(0x1c7)]<0.1)this[_0x168937(0x1ab)][_0x168937(0x1c7)]=0xc;await setup[_0x168937(0x19e)](this),await setup[_0x168937(0x1ed)](this);if(this[_0x168937(0x1ab)][_0x168937(0x163)])try{this[_0x168937(0x230)]=new GoogleGenerativeAI(this[_0x168937(0x1ab)]['geminiApiKey']),this[_0x168937(0x17f)]=this['genAI'][_0x168937(0x208)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x168937(0x18a)}}),this[_0x168937(0x21f)][_0x168937(0x225)](_0x168937(0x172));}catch(_0x5611c3){this[_0x168937(0x21f)][_0x168937(0x1b4)](_0x168937(0x18d)+_0x5611c3[_0x168937(0x1cc)]);}await setup[_0x168937(0x191)](this),await this['loadSystemMode'](),await this[_0x168937(0x1c1)]('analysis.energy.pinnForecast',{'type':_0x168937(0x1fa),'common':{'name':_0x168937(0x1a7),'type':_0x168937(0x16b),'role':_0x168937(0x1cd),'read':!![],'write':![]},'native':{}}),await this[_0x168937(0x1c1)]('analysis.energy.ventilationAlerts',{'type':_0x168937(0x1fa),'common':{'name':_0x168937(0x1a4),'type':_0x168937(0x16b),'role':_0x168937(0x1cd),'read':!![],'write':![]},'native':{}}),await this[_0x168937(0x1c1)]('analysis.energy.warmupTimes',{'type':_0x168937(0x1fa),'common':{'name':'Warm-Up\x20Time\x20(Minutes\x20to\x2021Â°C)','type':'string','role':_0x168937(0x1cd),'read':!![],'write':![]},'native':{}});try{const _0x484476=await this[_0x168937(0x17d)](_0x168937(0x24e));if(_0x484476&&_0x484476[_0x168937(0x1ff)])this[_0x168937(0x21b)]=JSON[_0x168937(0x21a)](_0x484476[_0x168937(0x1ff)]);}catch(_0x19ad47){this[_0x168937(0x21b)]=[];}try{const _0x3bfa1f=await this[_0x168937(0x17d)](_0x168937(0x1ee));if(_0x3bfa1f&&_0x3bfa1f['val'])this[_0x168937(0x222)]=JSON['parse'](_0x3bfa1f[_0x168937(0x1ff)]);}catch(_0x15812c){this[_0x168937(0x222)]=[];}const _0x196b94=this['dailyDigests']['length']>=(this['config'][_0x168937(0x22b)]||0x7)?'Aktiv\x20('+this[_0x168937(0x222)][_0x168937(0x1d6)]+_0x168937(0x1a5):_0x168937(0x1fc)+this['dailyDigests']['length']+'/'+(this[_0x168937(0x1ab)]['minDaysForBaseline']||0x7)+')';await this[_0x168937(0x244)]('LTM.baselineStatus',{'val':_0x196b94,'ack':!![]}),this[_0x168937(0x198)](_0x168937(0x1f7)),this[_0x168937(0x198)]('LTM.triggerDailyDigest'),this[_0x168937(0x198)](_0x168937(0x197)),this[_0x168937(0x198)](_0x168937(0x212)),this['subscribeStates'](_0x168937(0x214)),this[_0x168937(0x198)](_0x168937(0x23b)),this['subscribeStates'](_0x168937(0x249)),this['subscribeStates'](_0x168937(0x237)),this[_0x168937(0x198)](_0x168937(0x164)),this[_0x168937(0x198)](_0x168937(0x162)),this[_0x168937(0x198)](_0x168937(0x1f5)),this[_0x168937(0x198)]('analysis.energy.mpcActive');const _0x543e78=this['config'][_0x168937(0x22d)];if(_0x543e78)for(const _0x5ea50b of _0x543e78){await this[_0x168937(0x247)](_0x5ea50b['id']);}const _0x23ea2f=this[_0x168937(0x1ab)]['presenceDevices'];if(_0x23ea2f)for(const _0x24b728 of _0x23ea2f){await this['subscribeForeignStatesAsync'](_0x24b728);}if(this[_0x168937(0x1ab)][_0x168937(0x1dc)]&&this['config'][_0x168937(0x242)])await this[_0x168937(0x247)](this[_0x168937(0x1ab)][_0x168937(0x242)]+_0x168937(0x1e1));setTimeout(()=>this[_0x168937(0x251)](),0x1388);if(this[_0x168937(0x253)])clearInterval(this['analysisTimer']);const _0x1c3156=this[_0x168937(0x1ab)]['analysisInterval']||0xf;_0x1c3156>0x0&&(this[_0x168937(0x253)]=setInterval(()=>{const _0x4806c8=_0x168937;this[_0x4806c8(0x23f)](),automation[_0x4806c8(0x1e7)](this);},_0x1c3156*0x3c*0x3e8)),setTimeout(()=>automation[_0x168937(0x1e7)](this),0x2710),schedulers[_0x168937(0x1d5)](this,()=>aiAgent[_0x168937(0x1a2)](this,pythonBridge)),schedulers[_0x168937(0x203)](this),schedulers[_0x168937(0x232)](this,()=>aiAgent['runBaselineDriftAnalysis'](this)),schedulers[_0x168937(0x1f1)](this,()=>aiAgent[_0x168937(0x1e0)](this)),pythonBridge[_0x168937(0x1c9)](this,installer[_0x168937(0x19a)]),setTimeout(async()=>{const _0x1854a9=_0x168937;await topology[_0x1854a9(0x178)](this);try{const _0x1bc31e=await this[_0x1854a9(0x17d)]('analysis.topology.structure');if(_0x1bc31e&&_0x1bc31e['val'])pythonBridge[_0x1854a9(0x168)](this,_0x1854a9(0x1f8),JSON[_0x1854a9(0x21a)](_0x1bc31e[_0x1854a9(0x1ff)]));}catch(_0x2db1f6){}this[_0x1854a9(0x240)](),this[_0x1854a9(0x1bb)](),this[_0x1854a9(0x1d0)](),this[_0x1854a9(0x1bc)]();},0x1388);}[a0_0x5a3017(0x219)](_0x3912ae){const _0x85015=a0_0x5a3017;if(this['analysisTimer'])clearInterval(this[_0x85015(0x253)]);if(this[_0x85015(0x1da)])clearInterval(this[_0x85015(0x1da)]);if(this[_0x85015(0x177)])this[_0x85015(0x177)]['cancel']();if(this[_0x85015(0x1f3)])this[_0x85015(0x1f3)]['cancel']();if(this[_0x85015(0x15b)])this[_0x85015(0x15b)][_0x85015(0x1d3)]();recorder[_0x85015(0x22a)](this),pythonBridge[_0x85015(0x181)](this),_0x3912ae();}async[a0_0x5a3017(0x1ea)](_0x4896a9,_0x3a0451){const _0x38b7ee=a0_0x5a3017;if(!_0x3a0451||this[_0x38b7ee(0x15e)])return;if(_0x4896a9[_0x38b7ee(0x179)]('telegram')&&_0x4896a9[_0x38b7ee(0x246)](_0x38b7ee(0x211))&&_0x3a0451[_0x38b7ee(0x1ff)])return;if(_0x4896a9===this[_0x38b7ee(0x1f2)]+'.system.mode'){if(_0x3a0451['val']&&Object['values'](setup[_0x38b7ee(0x190)])[_0x38b7ee(0x179)](_0x3a0451[_0x38b7ee(0x1ff)])){this['currentSystemMode']=_0x3a0451[_0x38b7ee(0x1ff)];if(_0x3a0451[_0x38b7ee(0x1ff)]===setup[_0x38b7ee(0x190)][_0x38b7ee(0x1bf)])await recorder[_0x38b7ee(0x20b)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x38b7ee(0x24d)]){let _0x54bdfc=![],_0x3c73ab=0x0,_0x3fcea5=_0x38b7ee(0x18f);if(this[_0x38b7ee(0x215)]==='party')_0x54bdfc=!![],_0x3c73ab=0x168,_0x3fcea5='Party\x20Mode';else this[_0x38b7ee(0x215)]==='guest'&&(_0x54bdfc=!![],_0x3c73ab=0x5a0,_0x3fcea5=_0x38b7ee(0x17a));pythonBridge[_0x38b7ee(0x168)](this,_0x38b7ee(0x1af),{'active':_0x54bdfc,'duration':_0x3c73ab,'label':_0x3fcea5}),await this['setStateAsync'](_0x38b7ee(0x204),{'val':JSON[_0x38b7ee(0x17c)]({'active':_0x54bdfc,'label':_0x3fcea5,'timestamp':Date[_0x38b7ee(0x234)]()}),'ack':!![]});}}if(!_0x3a0451[_0x38b7ee(0x19f)])this[_0x38b7ee(0x1d9)](_0x4896a9,{'val':this[_0x38b7ee(0x215)],'ack':!![]});return;}if(!_0x3a0451[_0x38b7ee(0x19f)]){_0x4896a9[_0x38b7ee(0x179)](_0x38b7ee(0x1f7))&&_0x3a0451['val']&&(this['setState'](_0x4896a9,{'val':![],'ack':!![]}),aiAgent[_0x38b7ee(0x23c)](this));if(_0x4896a9['includes']('triggerDailyDigest')&&_0x3a0451['val']){this['setState'](_0x4896a9,{'val':![],'ack':!![]});if(this[_0x38b7ee(0x24d)])aiAgent[_0x38b7ee(0x1a2)](this,pythonBridge);}_0x4896a9[_0x38b7ee(0x179)](_0x38b7ee(0x1fe))&&_0x3a0451['val']&&(this[_0x38b7ee(0x1d9)](_0x4896a9,{'val':![],'ack':!![]}),aiAgent[_0x38b7ee(0x1e0)](this));_0x4896a9['includes'](_0x38b7ee(0x20e))&&_0x3a0451[_0x38b7ee(0x1ff)]&&(this[_0x38b7ee(0x1d9)](_0x4896a9,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this));if(_0x4896a9[_0x38b7ee(0x179)](_0x38b7ee(0x249))&&_0x3a0451[_0x38b7ee(0x1ff)]){this[_0x38b7ee(0x1d9)](_0x4896a9,{'val':![],'ack':!![]});if(this[_0x38b7ee(0x24d)])try{const _0x2ce8a2=await this[_0x38b7ee(0x17d)]('LTM.trainingData.sequences');if(_0x2ce8a2&&_0x2ce8a2[_0x38b7ee(0x1ff)]){const _0xa060d8=JSON[_0x38b7ee(0x21a)](_0x2ce8a2[_0x38b7ee(0x1ff)]);this[_0x38b7ee(0x244)](_0x38b7ee(0x189),{'val':_0x38b7ee(0x1e6),'ack':!![]}),pythonBridge[_0x38b7ee(0x168)](this,_0x38b7ee(0x206),{'sequences':_0xa060d8});}}catch(_0x1bc742){}}if(_0x4896a9[_0x38b7ee(0x179)](_0x38b7ee(0x237))&&_0x3a0451['val']){this[_0x38b7ee(0x1d9)](_0x4896a9,{'val':![],'ack':!![]});if(this[_0x38b7ee(0x24d)])try{const _0x2a1622=await this['getStateAsync']('LTM.dailyDigests');if(_0x2a1622&&_0x2a1622['val'])pythonBridge[_0x38b7ee(0x168)](this,_0x38b7ee(0x1be),{'digests':JSON[_0x38b7ee(0x21a)](_0x2a1622[_0x38b7ee(0x1ff)])});}catch(_0x4b6c40){}}if(_0x4896a9['includes']('analysis.training.triggerEnergy')&&_0x3a0451['val']){this[_0x38b7ee(0x1d9)](_0x4896a9,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x36d852=await this[_0x38b7ee(0x17d)](_0x38b7ee(0x24b));if(_0x36d852&&_0x36d852[_0x38b7ee(0x1ff)])pythonBridge[_0x38b7ee(0x168)](this,_0x38b7ee(0x1a0),{'points':JSON[_0x38b7ee(0x21a)](_0x36d852['val'])});}catch(_0x3aa283){}}if(_0x4896a9['includes'](_0x38b7ee(0x162))&&_0x3a0451['val']){this[_0x38b7ee(0x1d9)](_0x4896a9,{'val':![],'ack':!![]});if(this[_0x38b7ee(0x24d)])try{const _0x138783=await this['getStateAsync'](_0x38b7ee(0x24e));if(_0x138783&&_0x138783[_0x38b7ee(0x1ff)])pythonBridge['send'](this,_0x38b7ee(0x167),{'events':JSON[_0x38b7ee(0x21a)](_0x138783[_0x38b7ee(0x1ff)])});}catch(_0x2cdb03){}}_0x4896a9[_0x38b7ee(0x179)]('analysis.training.triggerTopology')&&_0x3a0451['val']&&(this['setState'](_0x4896a9,{'val':![],'ack':!![]}),topology[_0x38b7ee(0x178)](this));return;}if(this['config'][_0x38b7ee(0x1b1)]&&this[_0x38b7ee(0x1ab)][_0x38b7ee(0x1b1)][_0x38b7ee(0x179)](_0x4896a9)){await this[_0x38b7ee(0x251)]();return;}const _0x382663=(this[_0x38b7ee(0x1ab)][_0x38b7ee(0x22d)]||[])[_0x38b7ee(0x19b)](_0x1b6e5b=>_0x1b6e5b['id']===_0x4896a9);if(_0x382663){const _0x5b118d=await recorder[_0x38b7ee(0x1f6)](this,_0x4896a9,_0x3a0451,_0x382663);_0x5b118d&&_0x5b118d[_0x38b7ee(0x202)]===_0x38b7ee(0x20d)&&_0x5b118d[_0x38b7ee(0x1fd)]&&this['isProVersion']&&deadMan[_0x38b7ee(0x228)](this,_0x5b118d[_0x38b7ee(0x1fd)]);}}async['onMessage'](_0x4deb51){const _0x546c13=a0_0x5a3017;if(typeof _0x4deb51===_0x546c13(0x1c6)&&_0x4deb51[_0x546c13(0x1cc)]){if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x201))try{const _0x184b64=await automation[_0x546c13(0x1a3)](this);this['sendTo'](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':!![],'results':_0x184b64},_0x4deb51[_0x546c13(0x1c4)]);}catch(_0x166347){this['sendTo'](_0x4deb51[_0x546c13(0x254)],_0x4deb51['command'],{'success':![],'error':_0x166347[_0x546c13(0x1cc)]},_0x4deb51['callback']);}else{if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x205))try{const {current_temps:_0x54205e,t_out:_0x5e5d30,targets:_0x551a59,t_forecast:_0xbcc467}=_0x4deb51[_0x546c13(0x1cc)],_0x26f5e9=[];let _0x208cb8={};try{const _0x4b560b=await this['getStateAsync'](_0x546c13(0x16c));if(_0x4b560b&&_0x4b560b['val']){const _0x1c57cb=JSON[_0x546c13(0x21a)](_0x4b560b[_0x546c13(0x1ff)]);_0x208cb8=_0x1c57cb[_0x546c13(0x241)]||_0x1c57cb;}}catch(_0x287e1a){}const _0x267fa1=_0xbcc467!==undefined&&_0xbcc467!==null?(_0x5e5d30+_0xbcc467)/0x2:_0x5e5d30;for(const [_0x536125,_0x2ac66c]of Object['entries'](_0x54205e)){const _0x3f0b5e=_0x551a59[_0x536125]||0x15;if(_0x2ac66c<=_0x3f0b5e)continue;let _0x3d833c=_0x208cb8[_0x536125]||-0.5;if(_0x3d833c>=0x0)_0x3d833c=-0.5;const _0xa81015=Math[_0x546c13(0x196)](_0x3d833c),_0x10f617=_0x2ac66c-_0x3f0b5e;let _0x2ac44f=Math[_0x546c13(0x200)](_0x10f617/_0xa81015*0x3c);const _0x24d98f=_0x2ac66c-_0x5e5d30,_0x34757b=_0x2ac66c-_0x267fa1;if(_0x34757b!==0x0&&_0x24d98f!==0x0){const _0x549890=_0x24d98f/_0x34757b;_0x2ac44f=Math['floor'](_0x2ac44f*_0x549890);}if(_0x2ac44f>0xf){if(_0x2ac44f>0xf0)_0x2ac44f=0xf0;_0x26f5e9[_0x546c13(0x231)]({'room':_0x536125,'minutes_safe':_0x2ac44f,'target':_0x3f0b5e,'current':_0x2ac66c,'savings_msg':_0x546c13(0x20a)+_0x2ac44f+'\x20min\x20ausbleiben.'});}}_0x26f5e9[_0x546c13(0x1f9)]((_0x4b4842,_0x4931be)=>_0x4931be[_0x546c13(0x1d2)]-_0x4b4842[_0x546c13(0x1d2)]),this[_0x546c13(0x224)](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':!![],'proposals':_0x26f5e9},_0x4deb51['callback']);}catch(_0x1f682c){this[_0x546c13(0x224)](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':![],'error':_0x1f682c[_0x546c13(0x1cc)]},_0x4deb51[_0x546c13(0x1c4)]);}else{if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x245))await this[_0x546c13(0x244)](_0x546c13(0x16a),{'val':![],'ack':!![]}),await this[_0x546c13(0x244)](_0x546c13(0x1d8),{'val':'','ack':!![]}),await this['setStateAsync'](_0x546c13(0x1df),{'val':'','ack':!![]}),this['sendTo'](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':!![]},_0x4deb51['callback']);else{if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x180)){const {targetId:_0x24cebe,targetValue:_0x558fb0}=_0x4deb51['message'];await this[_0x546c13(0x244)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x546c13(0x1d8),{'val':_0x546c13(0x18b),'ack':!![]}),await this['setStateAsync']('analysis.automation.targetId',{'val':_0x24cebe,'ack':!![]}),await this[_0x546c13(0x244)](_0x546c13(0x176),{'val':String(_0x558fb0),'ack':!![]}),this['sendTo'](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':!![]},_0x4deb51[_0x546c13(0x1c4)]);}else{if(_0x4deb51['command']===_0x546c13(0x233))try{const _0x3ee4b0=_0x4deb51[_0x546c13(0x1cc)][_0x546c13(0x1e3)];if(!_0x3ee4b0)throw new Error(_0x546c13(0x21e));const _0x31470c=new GoogleGenerativeAI(_0x3ee4b0),_0xb37bc5=_0x31470c[_0x546c13(0x208)]({'model':GEMINI_MODEL}),_0x21ee40=await _0xb37bc5[_0x546c13(0x19c)]('Test'),_0x473064=await _0x21ee40['response'];if(_0x473064[_0x546c13(0x170)]())this['sendTo'](_0x4deb51[_0x546c13(0x254)],_0x4deb51['command'],{'success':!![],'message':'Verbindung\x20erfolgreich!'},_0x4deb51['callback']);else throw new Error('Keine\x20Antwort\x20von\x20Gemini');}catch(_0x397f13){this[_0x546c13(0x224)](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':![],'message':_0x397f13[_0x546c13(0x1cc)]},_0x4deb51['callback']);}else{if(_0x4deb51['command']===_0x546c13(0x226))try{const _0x4a5344=await scanner[_0x546c13(0x227)](this,_0x4deb51[_0x546c13(0x1cc)]||{});this['sendTo'](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':!![],'devices':_0x4a5344},_0x4deb51[_0x546c13(0x1c4)]);}catch(_0x5a9b49){this[_0x546c13(0x224)](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':![],'error':_0x5a9b49[_0x546c13(0x1cc)]},_0x4deb51[_0x546c13(0x1c4)]);}else{if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x192))try{const {matrix:_0x22071f}=_0x4deb51[_0x546c13(0x1cc)],_0x598c92=await this[_0x546c13(0x17d)]('analysis.topology.structure');if(_0x598c92&&_0x598c92[_0x546c13(0x1ff)]){const _0x3f1cd9=JSON[_0x546c13(0x21a)](_0x598c92[_0x546c13(0x1ff)]);_0x3f1cd9[_0x546c13(0x248)]=_0x22071f,_0x3f1cd9[_0x546c13(0x186)]=Date[_0x546c13(0x234)](),await this[_0x546c13(0x244)]('analysis.topology.structure',{'val':JSON[_0x546c13(0x17c)](_0x3f1cd9),'ack':!![]}),pythonBridge[_0x546c13(0x168)](this,_0x546c13(0x1f8),_0x3f1cd9);}this[_0x546c13(0x224)](_0x4deb51['from'],_0x4deb51[_0x546c13(0x1a8)],{'success':!![]},_0x4deb51['callback']);}catch(_0xf9e42a){this[_0x546c13(0x21f)][_0x546c13(0x1b4)](_0xf9e42a);}else{if(_0x4deb51['command']==='getLtmData')this[_0x546c13(0x224)](_0x4deb51['from'],_0x4deb51['command'],{'success':!![],'dailyDigests':this[_0x546c13(0x222)]||[],'analysisHistory':this['analysisHistory']||[]},_0x4deb51[_0x546c13(0x1c4)]);else{if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x1e2)){const _0x34a332=this[_0x546c13(0x222)][_0x546c13(0x1d6)],_0x566676=new Array(0x18)[_0x546c13(0x18e)](0x0),_0x45165c=new Date()['setHours'](0x0,0x0,0x0,0x0);this[_0x546c13(0x1ac)]&&this[_0x546c13(0x1ac)][_0x546c13(0x1de)](_0x520f4f=>{const _0x15a9d4=_0x546c13;if(_0x520f4f[_0x15a9d4(0x229)]>=_0x45165c){const _0x480bb7=new Date(_0x520f4f[_0x15a9d4(0x229)])[_0x15a9d4(0x16d)]();if(_0x480bb7>=0x0&&_0x480bb7<0x18)_0x566676[_0x480bb7]++;}});let _0x1a9150=![],_0x4beba9='',_0x2b0351='',_0x3b1cd0='';try{const _0x3e5314=await this[_0x546c13(0x17d)]('analysis.automation.patternDetected');if(_0x3e5314&&_0x3e5314['val']){_0x1a9150=!![];const _0x108564=await this[_0x546c13(0x17d)]('analysis.automation.description');_0x4beba9=_0x108564?_0x108564[_0x546c13(0x1ff)]:'';const _0x37a8ad=await this[_0x546c13(0x17d)]('analysis.automation.targetId');_0x2b0351=_0x37a8ad?_0x37a8ad[_0x546c13(0x1ff)]:'';const _0xec4d01=await this['getStateAsync'](_0x546c13(0x176));_0x3b1cd0=_0xec4d01?_0xec4d01['val']:'';}}catch(_0x46dc6d){}const _0xa5dc40=await this[_0x546c13(0x187)](),_0x5e2ce5=(this[_0x546c13(0x1ab)]['devices']||[])[_0x546c13(0x218)](_0xe23e05=>_0xe23e05[_0x546c13(0x238)]),_0x54b411=_0xa5dc40&&_0x5e2ce5;this[_0x546c13(0x224)](_0x4deb51['from'],_0x4deb51['command'],{'success':!![],'eventHistory':this[_0x546c13(0x1ac)][_0x546c13(0x194)](0x0,0xf),'stats':{'digestCount':_0x34a332,'isPresent':this[_0x546c13(0x1fb)],'hourlyActivity':_0x566676,'solarActive':_0x54b411},'automation':{'detected':_0x1a9150,'description':_0x4beba9,'targetId':_0x2b0351,'targetValue':_0x3b1cd0}},_0x4deb51[_0x546c13(0x1c4)]);}else{if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x16f)){const _0x3a03e0=await this[_0x546c13(0x1b9)](_0x546c13(0x22e),_0x546c13(0x1b5)),_0x42eef2=[];if(_0x3a03e0)for(const _0x30ecf4 in _0x3a03e0){const _0x2e1913=_0x3a03e0[_0x30ecf4],_0xb640f0=(_0x2e1913['common']&&typeof _0x2e1913[_0x546c13(0x166)]['name']===_0x546c13(0x1c6)?_0x2e1913['common'][_0x546c13(0x1e4)]['de']:_0x2e1913[_0x546c13(0x166)][_0x546c13(0x1e4)])||_0x2e1913[_0x546c13(0x166)][_0x546c13(0x1e4)];_0x42eef2[_0x546c13(0x231)]({'id':_0x30ecf4,'name':_0xb640f0});}const _0x472cc7=await this[_0x546c13(0x1b9)](_0x546c13(0x221),'enum'),_0x1a5f02=[];if(_0x472cc7)for(const _0x1ca591 in _0x472cc7){const _0x256105=_0x472cc7[_0x1ca591],_0x88b0f2=(_0x256105[_0x546c13(0x166)]&&typeof _0x256105[_0x546c13(0x166)]['name']===_0x546c13(0x1c6)?_0x256105[_0x546c13(0x166)][_0x546c13(0x1e4)]['de']:_0x256105[_0x546c13(0x166)][_0x546c13(0x1e4)])||_0x1ca591['split']('.')['pop']();_0x1a5f02['push'](_0x88b0f2);}this[_0x546c13(0x224)](_0x4deb51['from'],_0x4deb51[_0x546c13(0x1a8)],{'success':!![],'enums':_0x42eef2,'rooms':_0x1a5f02},_0x4deb51[_0x546c13(0x1c4)]);}else{if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x18c))try{let _0x20d165=_0x546c13(0x1e8),_0x49164c='Kein\x20Kalender-Adapter';if(this[_0x546c13(0x1ab)][_0x546c13(0x1ec)]){const _0x1098a5=await recorder[_0x546c13(0x24c)](this);_0x20d165=_0x1098a5!==null?_0x1098a5+'Â°C':'Daten\x20nicht\x20verfÃ¼gbar';}if(this[_0x546c13(0x1ab)][_0x546c13(0x175)]){const _0x250c88=await this[_0x546c13(0x174)]('system.adapter.'+this[_0x546c13(0x1ab)][_0x546c13(0x175)]);_0x49164c=_0x250c88?_0x546c13(0x15c):_0x546c13(0x15d);}this[_0x546c13(0x224)](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':!![],'weather':_0x20d165,'calendar':_0x49164c},_0x4deb51[_0x546c13(0x1c4)]);}catch(_0x2bc5e8){this[_0x546c13(0x224)](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':![],'error':_0x2bc5e8[_0x546c13(0x1cc)]},_0x4deb51[_0x546c13(0x1c4)]);}else{if(_0x4deb51[_0x546c13(0x1a8)]==='getCalendarNames')try{const _0x4c15ac=_0x4deb51['message']['instance'],_0x3edb56=await this['getForeignStateAsync'](_0x4c15ac+_0x546c13(0x1a6));let _0x257d59=[];if(_0x3edb56&&_0x3edb56[_0x546c13(0x1ff)]){const _0x5f4094=JSON[_0x546c13(0x21a)](_0x3edb56[_0x546c13(0x1ff)]),_0x3266cd=new Set();Array['isArray'](_0x5f4094)&&_0x5f4094[_0x546c13(0x1de)](_0xb1f77b=>{const _0x14538f=_0x546c13;if(_0xb1f77b[_0x14538f(0x216)])_0x3266cd[_0x14538f(0x184)](_0xb1f77b['_calName']);else{if(_0xb1f77b[_0x14538f(0x193)])_0x3266cd['add'](_0xb1f77b[_0x14538f(0x193)]);}}),_0x257d59=Array[_0x546c13(0x254)](_0x3266cd)['sort']();}if(_0x257d59['length']===0x0)_0x257d59=['Standard'];this[_0x546c13(0x224)](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':!![],'names':_0x257d59},_0x4deb51['callback']);}catch(_0x46a5ce){this[_0x546c13(0x224)](_0x4deb51['from'],_0x4deb51['command'],{'success':![],'error':_0x46a5ce['message']},_0x4deb51['callback']);}else{if(_0x4deb51[_0x546c13(0x1a8)]===_0x546c13(0x15f))try{await setup['sendNotification'](this,_0x546c13(0x171),![],![]),this['sendTo'](_0x4deb51[_0x546c13(0x254)],_0x4deb51['command'],{'success':!![],'message':_0x546c13(0x1b2)},_0x4deb51[_0x546c13(0x1c4)]);}catch(_0x3224b1){this[_0x546c13(0x21f)]['error']('Notification\x20Test\x20Failed:\x20'+_0x3224b1[_0x546c13(0x1cc)]),this[_0x546c13(0x224)](_0x4deb51[_0x546c13(0x254)],_0x4deb51[_0x546c13(0x1a8)],{'success':![],'message':_0x546c13(0x1b6)+_0x3224b1['message']},_0x4deb51['callback']);}}}}}}}}}}}}}}}async[a0_0x5a3017(0x1c2)](){const _0x1d53c8=a0_0x5a3017;try{const _0x3ff380=await this['getStateAsync'](setup[_0x1d53c8(0x21c)]);_0x3ff380&&_0x3ff380['val']&&Object[_0x1d53c8(0x1f4)](setup['SYSTEM_MODES'])[_0x1d53c8(0x179)](_0x3ff380[_0x1d53c8(0x1ff)])?this['currentSystemMode']=_0x3ff380[_0x1d53c8(0x1ff)]:(this[_0x1d53c8(0x215)]=setup['SYSTEM_MODES'][_0x1d53c8(0x182)],await this['setStateAsync'](setup[_0x1d53c8(0x21c)],{'val':setup[_0x1d53c8(0x190)][_0x1d53c8(0x182)],'ack':!![]}));}catch(_0x27abfb){this[_0x1d53c8(0x215)]=setup[_0x1d53c8(0x190)][_0x1d53c8(0x182)];}}async[a0_0x5a3017(0x251)](){const _0x3ad457=a0_0x5a3017;try{const _0x5b0ed2=this[_0x3ad457(0x1ab)]['presenceDevices']||[];let _0x2277d4=![];const _0x25241a=[];for(const _0x13ee03 of _0x5b0ed2){try{const _0x224c83=await this[_0x3ad457(0x1b3)](_0x13ee03);_0x224c83&&(_0x224c83[_0x3ad457(0x1ff)]===!![]||_0x224c83[_0x3ad457(0x1ff)]==='online'||_0x224c83[_0x3ad457(0x1ff)]===0x1)&&(_0x2277d4=!![],_0x25241a[_0x3ad457(0x231)](_0x13ee03));}catch(_0x1e8951){}}return await this['setStateAsync'](_0x3ad457(0x20c),{'val':_0x25241a[_0x3ad457(0x185)](',\x20'),'ack':!![]}),_0x2277d4&&(this[_0x3ad457(0x1e9)]&&(this[_0x3ad457(0x21f)][_0x3ad457(0x225)](_0x3ad457(0x207)),recorder[_0x3ad457(0x22a)](this)),!this[_0x3ad457(0x1fb)]&&this[_0x3ad457(0x215)]===setup[_0x3ad457(0x190)][_0x3ad457(0x182)]&&await recorder['setPresence'](this,!![])),_0x2277d4;}catch(_0x8927e1){return![];}}async[a0_0x5a3017(0x23f)](){const _0xcc4f02=a0_0x5a3017;this[_0xcc4f02(0x21f)][_0xcc4f02(0x160)](_0xcc4f02(0x213)),await aiAgent[_0xcc4f02(0x23c)](this),this[_0xcc4f02(0x1bc)](),this['triggerGaitAnalysis'](),this[_0xcc4f02(0x1d0)]();}async[a0_0x5a3017(0x187)](){const _0x19acd7=a0_0x5a3017,_0x20067c=[_0x19acd7(0x1b7),'accuweather.0',_0x19acd7(0x1ba)],_0x194110=['forecast.current.weather','Current.WeatherText',_0x19acd7(0x19d)];for(const _0x446219 of _0x20067c){for(const _0x265b00 of _0x194110){try{const _0x2b5353=_0x446219+'.'+_0x265b00,_0x29fe3b=await this[_0x19acd7(0x1b3)](_0x2b5353);if(_0x29fe3b&&_0x29fe3b[_0x19acd7(0x1ff)]){const _0x4fed1c=String(_0x29fe3b[_0x19acd7(0x1ff)])[_0x19acd7(0x1eb)]();if(_0x4fed1c[_0x19acd7(0x179)](_0x19acd7(0x1d1))||_0x4fed1c[_0x19acd7(0x179)](_0x19acd7(0x252))||_0x4fed1c[_0x19acd7(0x179)](_0x19acd7(0x195))||_0x4fed1c['includes'](_0x19acd7(0x1dd))||_0x4fed1c['includes'](_0x19acd7(0x1ca)))return!![];}}catch(_0x2e72dd){}}}return![];}['triggerGaitAnalysis'](){const _0x3bc8ed=a0_0x5a3017;if(!this[_0x3bc8ed(0x24d)])return;try{this[_0x3bc8ed(0x1c3)](_0x3bc8ed(0x1c8),(_0x1e1eb3,_0x2a9355)=>{const _0x38b735=_0x3bc8ed;_0x2a9355&&_0x2a9355[_0x38b735(0x1ff)]&&pythonBridge[_0x38b735(0x168)](this,_0x38b735(0x1e5),{'sequences':JSON[_0x38b735(0x21a)](_0x2a9355[_0x38b735(0x1ff)])});});}catch(_0x38cdc7){}}async[a0_0x5a3017(0x1d0)](){const _0xae38d6=a0_0x5a3017;if(!this[_0xae38d6(0x24d)])return;try{const _0x3a3ed=await recorder[_0xae38d6(0x24c)](this);if(_0x3a3ed===null)return;const _0x43a9ae={},_0x54fcbe={},_0x941b98=this[_0xae38d6(0x1ab)][_0xae38d6(0x22d)]||[];for(const _0x3bdd88 of _0x941b98){if(_0x3bdd88[_0xae38d6(0x202)]===_0xae38d6(0x183)&&_0x3bdd88[_0xae38d6(0x1fd)]){const _0x15b995=this['sensorLastValues'][_0x3bdd88['id']];if(_0x15b995!==undefined)_0x43a9ae[_0x3bdd88['location']]=_0x15b995;if(_0x3bdd88[_0xae38d6(0x238)])_0x54fcbe[_0x3bdd88['location']]=!![];}}const _0x55561f=await this[_0xae38d6(0x187)]();Object[_0xae38d6(0x16e)](_0x43a9ae)[_0xae38d6(0x1d6)]>0x0&&(pythonBridge[_0xae38d6(0x168)](this,_0xae38d6(0x23d),{'current_temps':_0x43a9ae,'t_out':_0x3a3ed,'is_sunny':_0x55561f,'solar_flags':_0x54fcbe}),pythonBridge[_0xae38d6(0x168)](this,_0xae38d6(0x21d),{'current_temps':_0x43a9ae,'t_out':_0x3a3ed,'targets':{}}));}catch(_0x615431){}}[a0_0x5a3017(0x1bc)](){const _0x19ab5e=a0_0x5a3017;if(!this[_0x19ab5e(0x21b)]||this[_0x19ab5e(0x21b)][_0x19ab5e(0x1d6)]===0x0)return;const _0x5171ca=new Array(0x60)[_0x19ab5e(0x18e)](0x0),_0x225fa5=new Date()[_0x19ab5e(0x188)](0x0,0x0,0x0,0x0);this[_0x19ab5e(0x21b)]['forEach'](_0xa3a6a6=>{const _0x5bab1c=_0x19ab5e,_0x137229=new Date(_0xa3a6a6[_0x5bab1c(0x229)]);if(_0x137229['getTime']()>=_0x225fa5){const _0x2e058d=_0x137229['getHours'](),_0x1af4eb=_0x137229[_0x5bab1c(0x243)](),_0x2381c3=_0x2e058d*0x4+Math[_0x5bab1c(0x200)](_0x1af4eb/0xf);if(_0x2381c3>=0x0&&_0x2381c3<0x60)_0x5171ca[_0x2381c3]++;}}),this[_0x19ab5e(0x244)](_0x19ab5e(0x169),{'val':JSON[_0x19ab5e(0x17c)](_0x5171ca),'ack':!![]});}[a0_0x5a3017(0x240)](){const _0x2368ba=a0_0x5a3017;if(!this[_0x2368ba(0x222)]||this['dailyDigests'][_0x2368ba(0x1d6)]<0x2)return;const _0x3bbe=this[_0x2368ba(0x222)][_0x2368ba(0x1a1)](_0xdb90fc=>{const _0x561548=_0x2368ba,_0x479daf=(_0xdb90fc['activityLevel']||'')[_0x561548(0x1eb)]();return ACTIVITY_LEVEL_MAP[_0x479daf]||0x32;});pythonBridge[_0x2368ba(0x168)](this,_0x2368ba(0x1ad),{'values':_0x3bbe,'tag':_0x2368ba(0x235)});}}if(require['main']!==module)module[a0_0x5a3017(0x23e)]=_0x5616fd=>new CogniLiving(_0x5616fd);else new CogniLiving();