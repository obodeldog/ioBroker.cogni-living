function a0_0x4625(){const _0x5ea833=['.NextHours.Location_1.Day_1.current.temp_value','version','analysis.triggerBriefing','submitFeedback','\x20sensors...','analysis.health.trendValue','Fokus\x20auf\x20Komfort.','event','error','‚úÖ\x20Alles\x20OK\x20(Reset)]','icons-mfd.','loc','_calName','response','.venv','info.','triggerBriefing','setupTelegramListener','path','toLowerCase','analysisHistory','python3','setState','existsSync','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','data','runAutopilot','SECURITY_RESULT','t√ºr','location','isGracePeriodActive','json','Train\x20Energy','lastAlertState','calendarInstance','toISOString','Unbekannt','text','TRAIN_ENERGY','PRIORIT√ÑT:\x20Gesundheit/AAL.','installRequirementsInVenv','common','isProVersion','vis.','KI-Modell\x20nicht\x20initialisiert','events.history','isArray','uuid','analysis.automation.patternDetected','details','loadRawEventLog','activityLevel','switch','Last\x20raw\x20event','216185yGwbpj','analysis.alertReason','state','\x20sequences...','executeAutomationAction','analysis.security.lastScore','telegram','application/json','generic','members','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','.\x20ANWESEND:\x20','payload','analysis.security','system.isPresent','.\x20EVENTS:\x20','blind','minDaysForBaseline','Failed:\x20','sendMorningBriefing','sendTo','Scripts','health','initHistory','subscribeForeignStatesAsync','üß†\x20Triggering\x20Security\x20Training\x20with\x20','onReady','length','OK:\x20','isExit','klima','TREND_RESULT','ANOMALY','sendToAsync','@iobroker/adapter-core','installPythonDependencies','flot.','getSystemUUID','[RESULT]','cancel','command','pop','stopPythonService','humidity','Scanning\x20for\x20devices...','[RECORDER]\x20Error\x20saving\x20sequence:\x20','Activity\x20Summary','normal','system.config','analysis.lastResult','history.','split','dimmer','Energy\x20Intelligence','.\x20WETTER:\x20','scheduleJob','ltmLtbWindowDays','lastIndexOf','temperature','2772737opWvgy','search','Sequences','getStateAsync','.\x20ZUSATZ:\x20','Activity-Level','events.history_debug_00','saveFeedback','latitude','weatherInstance','analysis.automation.description','detected','runPythonHealthCheck','PARTY','isPresent','heizung','setObjectNotExistsAsync','send','briefingJob','32862oDjybV','eventHistory','Train\x20Security','Keine\x20Termine','python3\x20-m\x20venv\x20\x22','Fokus\x20auf\x20Familienroutinen.','analysis.energy.heatingScore','isEmergency','HEALTH_RESULT','setupModeResetScheduler','indicator','system.presenceWho','python','isAlert','\x20days\x20of\x20activity\x20data\x20to\x20Python...','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','toString','analysis.automation.triggerAction','simulateButler','No\x20instance','checkLicense','224328BxzQMl','subscribeStates','getMonth','geminiApiKey','position','message','notifyEmailRecipient','ANALYZE_HEALTH','stringify','window','updateAnalysisHistory','occupancy','\x22\x20-c\x20\x22import\x20tensorflow;\x20print(\x27OK\x27)\x22','Auto\x20Apply','startPythonService','devices','sound','type','\x20=\x20','N/A\x20(Learning)','licht','javascript.','analysis.training.status','saveCompletedSequence','simple-api.','getEnums','Trend\x20Value','createAllObjects','Err:\x20','selectedFunctionIds','unknown','setupBriefingScheduler','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','lampe',')\x20-\x20MONOLITH\x20STABLE',').\x20Panic\x20Mode.','üß™\x20Simulating\x20Butler\x20Proposal:\x20','.\x20SYSTEM_MODE:\x20','analysis.training.triggerSecurity','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','status','sensorLastValues','System\x20Mode','Feedback:\x20','licenseKey','weather','guest','scanForDevices','‚ö†Ô∏è\x20Missing\x20Libs\x20(','NORMAL','Briefing\x20Error:\x20','[PYTHON]\x20Exited\x20','models/gemini-flash-latest','system.mode','off','loadDailyDigests','LTM.trainingData.sequences','\x20(Length:\x20','events.lastEvent','setupLtmScheduler','power','openweathermap','heating','analysis.health.lastCheck','stdin','door','temperatur','Vom\x20Benutzer\x20best√§tigt\x20(OK).','üåÖ\x20Daily\x20Briefing:\x0a','onMessage','parse','Generating\x20Morning\x20Briefing...','brightness','handleTelegramResponse','replace','currentSystemMode','bewegung','bind','extendObjectAsync','.\x20DATEN:\x20Schlaf\x20','testApiKey','initSystemConfig','callback','ANALYZE_SEQUENCE','ack','User\x20dismissed\x20automation\x20proposal.','getTime','dailyDigests','exitGraceTimer','Training\x20Status','20hYBifZ','notifyPushoverRecipient','sort','livingContext','exitTimer','Gemini\x20Init\x20Error:\x20','TRAIN_HEALTH','pip','channel','namespace','material.','analysis.activitySummary','startsWith','includes','testContext','string','üêç\x20Python\x20Pong','fill','runSecurityCheck','handlePythonResult','Last\x20Check','setStateAsync','System','createDailyDigest','dependencyInstallInProgress','saveRawEventLog','Alert\x20Status','summary','analysis.energy','.\x20KONTEXT:\x20','runGeminiAnalysis','\x20->\x20','Anomaly\x20Score','üêç\x20Using\x20VENV:\x20','round','splice','getForeignObjectsAsync','Target\x20ID','delObjectAsync','sendToPython','‚úÖ\x20HEALTH\x20TRAINED:\x20','LTM.driftAnalysis.baselineDrift','Alarm','Installing\x20pip\x20packages\x20(Force\x20Reinstall)...','light','No\x20module\x20named','warn','Trigger\x20Analysis','onStateChange','LTM.rawEventLog','level','role','(((.+)+)+)+$','ltmJob','alertReason','getForeignStateAsync','analysis.health','log','notifyEmailEnabled','online','Skipped\x20(No\x20AI\x20or\x20Data)','setupDriftAnalysisScheduler','child_process','notifyTelegramInstance','config','analysis.training','rawEventLog','useCalendar','abortExitTimer','78472PSIMCO','analysis.trigger','getCalendarNames','ltmStbWindowDays','substring','analysis.training.triggerHealth','16xKcgzI','Description','‚ö†Ô∏è\x20ALARM:\x20','briefingTime','4ORyYNx','Security\x20Monitor','weatherunderground','info','VACATION','scanDevices','system.','timestamp','7020675QPEgiz','panicMode','PRIORIT√ÑT:\x20Sicherheit.','from','notifyTelegramEnabled','LTM.driftAnalysis','button','Insulation\x20Score','targetId','notifyPushoverInstance','Trend','admin.','write','service.py','unload','vacation','system','analysis.automation.targetId','.data.table','üõ°Ô∏è\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','map','node-schedule','Raw\x20Log','analysis.energy.insulationScore','name','LTM','ENERGY_TRAIN_RESULT','sequenceTimer','üêç\x20Stopping\x20Python...','analysis.automation.targetValue','@google/generative-ai','TRAINING_COMPLETE','ready','recordSequence','Train\x20Health','Digest','daswetter','Success','automationProposal','Pattern\x20Detected','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','insulation','setPresence','enum.functions.*','pip.exe','pythonProcess','analysis.security.lastCheck','initSensorSubscriptions','Event\x20History','generateContent','driftAnalysisTimer','HARD\x20WATCHDOG:\x20No\x20activity\x20for\x20','847muKNZj','dismissAutomation','Cogni-Living','communicate.request','python.exe','debug','getOutsideTemperatureNumeric','join','8vYykeI','enum','stderr','.Current.Temperature','boolean','Thermodynamics','autoApply','apiKey','values','‚ùå\x20VERIFICATION\x20FAILED.\x20Tensorflow\x20missing.\x20Panic\x20Mode.','08:00','processSensorEvent','Analysiere\x20ausgewogen.','python_service','üêç\x20Guardian\x20Diagnosis:\x20','getCalendarContext','initPresenceSubscriptions','cover','.\x20EMERGENCY:\x20','loadSystemMode','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','shift','inactivityThresholdHours','kontakt','slice','startExitTimer','PONG','‚úÖ\x20VERIFICATION\x20PASSED.\x20Starting\x20Service.','doors','toFixed','description','getLtmData','LTM.processingStatus','analysis.training.triggerEnergy','sendNotification','[PYTHON]\x20','analysis.analysisHistory','currentposition','endsWith','Kein\x20API\x20Key.','activeSequence','longitude','Who\x20is\x20present?','Alert\x20Reason','presence','üö®\x20EMERGENCY','updateBaselineStatus','saveDailyDigests','getHours','checkWifiPresence','analysis.isAlert','push','Kalender:\x20Deaktiviert','indicator.alarm','COGNI_REQUEST_CALL','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','presenceDevices','geminiModel','21264240hNsmun','Guardian:\x20Sending\x20','/100.\x20OUTPUT:\x20Text.','requirements.txt','LTM.trainingData.thermodynamics','Success:\x20','getGenerativeModel','N/A','üõ†Ô∏è\x20MAINTENANCE\x20MODE:\x20Reinstalling\x20Python\x20environment.\x20DO\x20NOT\x20RESTART.','stateChange','HEALTH_TRAIN_RESULT','systemConfig','Training\x20Error:\x20','date','genAI','number','lights','LTM.dailyDigests','COGNI_CONFIRM_OK','ltmDriftCheckIntervalHours','Gemini\x20Error:\x20','recordThermodynamics','getWeatherContext','modeResetJob','briefingEnabled','writable','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','initZombies','‚ùå\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv','valve','useWeather','automation.triggerAction','object','pr√§senz','analysis.health.isAnomaly','filter','value','unshift','now','LTM.triggerDailyDigest','val','forEach','trim','baselineDrift','‚ùå\x20INSTALL\x20FAILED:\x20','Gemini\x20AI\x20initialized.','analysisTimer','Unknown','setpoint','city','KALENDER:\x20','rmSync','analysis.history_debug_00','notifyEmailInstance','Subscribing\x20to\x20','Anomaly\x20Detected','motion','analysis.automation.autoApply','runBaselineDriftAnalysis','Lernphase\x20('];a0_0x4625=function(){return _0x5ea833;};return a0_0x4625();}const a0_0x20bea8=a0_0x1e3b;(function(_0x424781,_0x5dd151){const _0x537e21=a0_0x1e3b,_0x2e348f=_0x424781();while(!![]){try{const _0x7d386=parseInt(_0x537e21(0x338))/0x1*(-parseInt(_0x537e21(0x33e))/0x2)+-parseInt(_0x537e21(0x299))/0x3+-parseInt(_0x537e21(0x342))/0x4*(parseInt(_0x537e21(0x236))/0x5)+-parseInt(_0x537e21(0x284))/0x6*(-parseInt(_0x537e21(0x181))/0x7)+-parseInt(_0x537e21(0x189))/0x8*(parseInt(_0x537e21(0x34a))/0x9)+-parseInt(_0x537e21(0x2f3))/0xa*(parseInt(_0x537e21(0x271))/0xb)+parseInt(_0x537e21(0x1c4))/0xc;if(_0x7d386===_0x5dd151)break;else _0x2e348f['push'](_0x2e348f['shift']());}catch(_0x4911d8){_0x2e348f['push'](_0x2e348f['shift']());}}}(a0_0x4625,0x62d03));const a0_0x1ae609=(function(){let _0x62b98f=!![];return function(_0x52a82e,_0x56559f){const _0x4fa7f8=_0x62b98f?function(){if(_0x56559f){const _0x3b94de=_0x56559f['apply'](_0x52a82e,arguments);return _0x56559f=null,_0x3b94de;}}:function(){};return _0x62b98f=![],_0x4fa7f8;};}()),a0_0x4ab7cd=a0_0x1ae609(this,function(){const _0x59521c=a0_0x1e3b;return a0_0x4ab7cd[_0x59521c(0x294)]()[_0x59521c(0x272)](_0x59521c(0x327))['toString']()['constructor'](a0_0x4ab7cd)[_0x59521c(0x272)](_0x59521c(0x327));});a0_0x4ab7cd();'use strict';function a0_0x1e3b(_0x3743e2,_0x240b60){const _0x318b0a=a0_0x4625();return a0_0x1e3b=function(_0x4ab7cd,_0x1ae609){_0x4ab7cd=_0x4ab7cd-0x15a;let _0x4625c3=_0x318b0a[_0x4ab7cd];return _0x4625c3;},a0_0x1e3b(_0x3743e2,_0x240b60);}const utils=require(a0_0x20bea8(0x258)),{GoogleGenerativeAI}=require(a0_0x20bea8(0x16b)),schedule=require(a0_0x20bea8(0x162)),{spawn,exec}=require(a0_0x20bea8(0x331)),path=require(a0_0x20bea8(0x212)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x20bea8(0x2cd),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x20bea8(0x324),LTM_DP_DAILY_DIGESTS=a0_0x20bea8(0x1d5),LTM_DP_STATUS=a0_0x20bea8(0x1aa),LTM_DP_TRIGGER_DIGEST=a0_0x20bea8(0x1eb),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x20bea8(0x34f),LTM_DP_DRIFT_STATUS=a0_0x20bea8(0x31c),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x20bea8(0x2ce),SYSTEM_MODES={'NORMAL':a0_0x20bea8(0x265),'VACATION':a0_0x20bea8(0x15c),'PARTY':'party','GUEST':a0_0x20bea8(0x2c7)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x20bea8(0x27e)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x20bea8(0x195),'senior_aal':a0_0x20bea8(0x227),'family':a0_0x20bea8(0x289),'single_comfort':a0_0x20bea8(0x206),'security':a0_0x20bea8(0x34c)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},BAD_NAMES=['targetposition',a0_0x20bea8(0x1af),a0_0x20bea8(0x238),a0_0x20bea8(0x325),'value',a0_0x20bea8(0x2e1),'on',a0_0x20bea8(0x2cf),a0_0x20bea8(0x234),a0_0x20bea8(0x29d),'shutter',a0_0x20bea8(0x246),a0_0x20bea8(0x19a),a0_0x20bea8(0x2c1),a0_0x20bea8(0x1fc),a0_0x20bea8(0x1b6),a0_0x20bea8(0x2a4),a0_0x20bea8(0x270),a0_0x20bea8(0x261),a0_0x20bea8(0x2d5),'energy',a0_0x20bea8(0x1f4),a0_0x20bea8(0x1e1),'actual_temperature','set_temperature'],ADAPTER_BLACKLIST=[a0_0x20bea8(0x348),a0_0x20bea8(0x355),a0_0x20bea8(0x20f),a0_0x20bea8(0x22b),a0_0x20bea8(0x268),a0_0x20bea8(0x2fd),a0_0x20bea8(0x20a),a0_0x20bea8(0x25a),'echarts.',a0_0x20bea8(0x2ae),a0_0x20bea8(0x2b1)],IS_WIN=process['platform']==='win32',VENV_PATH=path[a0_0x20bea8(0x188)](__dirname,a0_0x20bea8(0x20e)),PYTHON_EXE=IS_WIN?path[a0_0x20bea8(0x188)](VENV_PATH,a0_0x20bea8(0x24b),a0_0x20bea8(0x185)):path[a0_0x20bea8(0x188)](VENV_PATH,'bin',a0_0x20bea8(0x290)),PIP_EXE=IS_WIN?path[a0_0x20bea8(0x188)](VENV_PATH,a0_0x20bea8(0x24b),a0_0x20bea8(0x179)):path[a0_0x20bea8(0x188)](VENV_PATH,'bin',a0_0x20bea8(0x2fa));class CogniLiving extends utils['Adapter']{constructor(_0x13493f){const _0x8c0986=a0_0x20bea8;super({..._0x13493f,'name':'cogni-living'}),this['eventHistory']=[],this[_0x8c0986(0x214)]=[],this[_0x8c0986(0x335)]=[],this[_0x8c0986(0x2f0)]=[],this['sensorLastValues']={},this[_0x8c0986(0x1cf)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x8c0986(0x2f7)]=null,this['exitGraceTimer']=null,this[_0x8c0986(0x21e)]=![],this[_0x8c0986(0x1d2)]=null,this['geminiModel']=null,this[_0x8c0986(0x2e4)]=SYSTEM_MODES[_0x8c0986(0x2ca)],this[_0x8c0986(0x22a)]=![],this[_0x8c0986(0x221)]=![],this['systemUUID']=_0x8c0986(0x2b7),this[_0x8c0986(0x1f2)]=null,this['ltmJob']=null,this[_0x8c0986(0x1db)]=null,this[_0x8c0986(0x17f)]=null,this[_0x8c0986(0x283)]=null,this[_0x8c0986(0x17a)]=null,this[_0x8c0986(0x30b)]=![],this['panicMode']=![],this[_0x8c0986(0x1b2)]=[],this[_0x8c0986(0x168)]=null,this['on'](_0x8c0986(0x16d),this[_0x8c0986(0x250)][_0x8c0986(0x2e6)](this)),this['on'](_0x8c0986(0x1cd),this[_0x8c0986(0x323)]['bind'](this)),this['on'](_0x8c0986(0x15b),this['onUnload'][_0x8c0986(0x2e6)](this)),this['on']('message',this[_0x8c0986(0x2de)][_0x8c0986(0x2e6)](this));}async[a0_0x20bea8(0x250)](){const _0x5716d6=a0_0x20bea8;this[_0x5716d6(0x32c)][_0x5716d6(0x345)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x5716d6(0x201)]+_0x5716d6(0x2bb)),await this[_0x5716d6(0x1df)](),this[_0x5716d6(0x333)]['licenseKey']=this['config'][_0x5716d6(0x2c5)]||'';try{this[_0x5716d6(0x22a)]=await this[_0x5716d6(0x298)](this['config'][_0x5716d6(0x2c5)]);}catch(_0x352b91){}if(!this[_0x5716d6(0x333)][_0x5716d6(0x1a0)]||this[_0x5716d6(0x333)][_0x5716d6(0x1a0)]<0.1)this[_0x5716d6(0x333)][_0x5716d6(0x1a0)]=0xc;await this[_0x5716d6(0x24d)](),await this[_0x5716d6(0x2ea)]();if(this['config'][_0x5716d6(0x29c)])try{this[_0x5716d6(0x1d2)]=new GoogleGenerativeAI(this[_0x5716d6(0x333)]['geminiApiKey']),this[_0x5716d6(0x1c3)]=this['genAI'][_0x5716d6(0x1ca)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x5716d6(0x23d)}}),this[_0x5716d6(0x32c)][_0x5716d6(0x345)](_0x5716d6(0x1f1));}catch(_0x391e02){this[_0x5716d6(0x32c)][_0x5716d6(0x208)](_0x5716d6(0x2f8)+_0x391e02[_0x5716d6(0x29e)]);}await this[_0x5716d6(0x2b4)](),await this[_0x5716d6(0x19c)](),await this['loadRawEventLog'](),await this[_0x5716d6(0x2d0)](),this['subscribeStates'](_0x5716d6(0x339)),this[_0x5716d6(0x29a)](LTM_DP_TRIGGER_DIGEST),this[_0x5716d6(0x29a)](_0x5716d6(0x2ce)),this[_0x5716d6(0x29a)](_0x5716d6(0x202)),this[_0x5716d6(0x29a)](_0x5716d6(0x295)),this[_0x5716d6(0x29a)]('analysis.automation.autoApply'),this[_0x5716d6(0x29a)](_0x5716d6(0x2bf)),this[_0x5716d6(0x29a)](_0x5716d6(0x33d)),this['subscribeStates']('analysis.training.triggerEnergy'),await this[_0x5716d6(0x17c)](),await this[_0x5716d6(0x199)](),await this[_0x5716d6(0x211)](),setTimeout(()=>this['checkWifiPresence'](),0x1388);if(this[_0x5716d6(0x1f2)])clearInterval(this[_0x5716d6(0x1f2)]);const _0x1e5387=this[_0x5716d6(0x333)]['analysisInterval']||0xf;_0x1e5387>0x0&&(this[_0x5716d6(0x1f2)]=setInterval(()=>{const _0x279472=_0x5716d6;this[_0x279472(0x21a)]();},_0x1e5387*0x3c*0x3e8)),this['setupLtmScheduler'](),this[_0x5716d6(0x28d)](),this['setupDriftAnalysisScheduler'](),this['setupBriefingScheduler'](),this[_0x5716d6(0x2a7)](),setTimeout(()=>{const _0x5c5114=_0x5716d6;if(this[_0x5c5114(0x17a)])this['runPythonHealthCheck']();},0x1388);}['onUnload'](_0x51da0a){const _0x5918a8=a0_0x20bea8;if(this[_0x5918a8(0x1f2)])clearInterval(this['analysisTimer']);if(this[_0x5918a8(0x17f)])clearInterval(this['driftAnalysisTimer']);if(this[_0x5918a8(0x328)])this['ltmJob'][_0x5918a8(0x25d)]();if(this[_0x5918a8(0x1db)])this[_0x5918a8(0x1db)][_0x5918a8(0x25d)]();if(this[_0x5918a8(0x283)])this['briefingJob'][_0x5918a8(0x25d)]();if(this[_0x5918a8(0x2f7)])clearTimeout(this[_0x5918a8(0x2f7)]);if(this[_0x5918a8(0x2f1)])clearTimeout(this[_0x5918a8(0x2f1)]);this['stopPythonService'](),_0x51da0a();}async[a0_0x20bea8(0x323)](_0x35459c,_0x1e70bd){const _0x21d285=a0_0x20bea8;if(!_0x1e70bd)return;if(this[_0x21d285(0x30b)]||this[_0x21d285(0x34b)])return;if(_0x35459c[_0x21d285(0x300)](_0x21d285(0x23c))&&_0x35459c[_0x21d285(0x1b0)](_0x21d285(0x184))&&_0x1e70bd['val']){await this[_0x21d285(0x2e2)](_0x1e70bd[_0x21d285(0x1ec)]);return;}if(_0x35459c===this[_0x21d285(0x2fc)]+'.'+SYSTEM_DP_MODE){_0x1e70bd[_0x21d285(0x1ec)]&&Object[_0x21d285(0x191)](SYSTEM_MODES)[_0x21d285(0x300)](_0x1e70bd[_0x21d285(0x1ec)])&&(this[_0x21d285(0x2e4)]=_0x1e70bd['val'],_0x1e70bd['val']===SYSTEM_MODES[_0x21d285(0x346)]?await this['setPresence'](![]):await this['setPresence'](!![]));if(!_0x1e70bd[_0x21d285(0x2ed)])this[_0x21d285(0x216)](_0x35459c,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x1e70bd['ack']){_0x35459c['includes'](_0x21d285(0x339))&&_0x1e70bd[_0x21d285(0x1ec)]&&(this['setState'](_0x35459c,{'val':![],'ack':!![]}),this[_0x21d285(0x311)]());if(_0x35459c[_0x21d285(0x300)]('triggerDailyDigest')&&_0x1e70bd[_0x21d285(0x1ec)]){this['setState'](_0x35459c,{'val':![],'ack':!![]});if(this[_0x21d285(0x22a)])this[_0x21d285(0x30a)]();}_0x35459c['includes'](_0x21d285(0x210))&&_0x1e70bd['val']&&(this[_0x21d285(0x216)](_0x35459c,{'val':![],'ack':!![]}),this[_0x21d285(0x249)]());_0x35459c[_0x21d285(0x300)](_0x21d285(0x1e3))&&_0x1e70bd[_0x21d285(0x1ec)]&&(this[_0x21d285(0x216)](_0x35459c,{'val':![],'ack':!![]}),this[_0x21d285(0x23a)]());if(_0x35459c['includes'](_0x21d285(0x2bf))&&_0x1e70bd[_0x21d285(0x1ec)]){this[_0x21d285(0x216)](_0x35459c,{'val':![],'ack':!![]});if(!this['isProVersion'])return;try{const _0x5a4359=await this[_0x21d285(0x274)](_0x21d285(0x2d1));if(_0x5a4359&&_0x5a4359['val']){const _0x940b17=JSON[_0x21d285(0x2df)](_0x5a4359[_0x21d285(0x1ec)]);this[_0x21d285(0x32c)][_0x21d285(0x345)](_0x21d285(0x24f)+_0x940b17[_0x21d285(0x251)]+_0x21d285(0x239)),this['setStateAsync'](_0x21d285(0x2af),{'val':'Sec-Training\x20started...','ack':!![]}),this[_0x21d285(0x31a)]('TRAIN_SECURITY',{'sequences':_0x940b17});}}catch(_0x4157d6){this[_0x21d285(0x32c)][_0x21d285(0x208)](_0x21d285(0x1d0)+_0x4157d6['message']);}}if(_0x35459c[_0x21d285(0x300)](_0x21d285(0x33d))&&_0x1e70bd[_0x21d285(0x1ec)]){this['setState'](_0x35459c,{'val':![],'ack':!![]});if(!this['isProVersion'])return;try{const _0x174422=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);_0x174422&&_0x174422[_0x21d285(0x1ec)]&&this[_0x21d285(0x31a)](_0x21d285(0x2f9),{'digests':JSON[_0x21d285(0x2df)](_0x174422['val'])});}catch(_0x31956b){}}if(_0x35459c[_0x21d285(0x300)](_0x21d285(0x1ab))&&_0x1e70bd['val']){this[_0x21d285(0x216)](_0x35459c,{'val':![],'ack':!![]});if(!this[_0x21d285(0x22a)])return;try{const _0x3c432f=await this[_0x21d285(0x274)](_0x21d285(0x1c8));_0x3c432f&&_0x3c432f[_0x21d285(0x1ec)]&&this[_0x21d285(0x31a)](_0x21d285(0x226),{'points':JSON['parse'](_0x3c432f[_0x21d285(0x1ec)])});}catch(_0x4eb071){}}return;}if(this[_0x21d285(0x333)]['presenceDevices']&&this[_0x21d285(0x333)]['presenceDevices'][_0x21d285(0x300)](_0x35459c)){await this[_0x21d285(0x1bb)]();return;}const _0xe2ea29=(this[_0x21d285(0x333)]['devices']||[])['find'](_0x3ceb53=>_0x3ceb53['id']===_0x35459c);if(_0xe2ea29)this[_0x21d285(0x194)](_0x35459c,_0x1e70bd,_0xe2ea29);}async[a0_0x20bea8(0x2de)](_0x48e2d4){const _0x555639=a0_0x20bea8;if(typeof _0x48e2d4===_0x555639(0x1e4)&&_0x48e2d4[_0x555639(0x29e)]){if(_0x48e2d4[_0x555639(0x25e)]===_0x555639(0x2e9)){const _0x58e029=_0x48e2d4[_0x555639(0x29e)][_0x555639(0x190)]||this[_0x555639(0x333)]['geminiApiKey'];if(!_0x58e029)return this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':![],'message':_0x555639(0x1b1)},_0x48e2d4[_0x555639(0x2eb)]);try{const _0x19b0f7=new GoogleGenerativeAI(_0x58e029),_0x338e32=_0x19b0f7[_0x555639(0x1ca)]({'model':GEMINI_MODEL}),_0x2fbe79=await _0x338e32[_0x555639(0x17e)]('Hi');this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':!![],'message':_0x555639(0x252)+_0x2fbe79[_0x555639(0x20d)][_0x555639(0x225)]()},_0x48e2d4[_0x555639(0x2eb)]);}catch(_0x174f5e){this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':![],'message':_0x555639(0x2b5)+_0x174f5e['message']},_0x48e2d4[_0x555639(0x2eb)]);}}else{if(_0x48e2d4[_0x555639(0x25e)]===_0x555639(0x301)){const _0x408f6c=await this[_0x555639(0x1da)](),_0x3a9c3c=await this['getCalendarContext']();this['sendTo'](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4['command'],{'success':!![],'weather':_0x408f6c,'calendar':_0x3a9c3c},_0x48e2d4[_0x555639(0x2eb)]);}else{if(_0x48e2d4['command']===_0x555639(0x1a9)){if(!this[_0x555639(0x22a)])return this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':![],'isPro':![]},_0x48e2d4[_0x555639(0x2eb)]);let _0x9e0dc7={'status':'N/A','details':''};try{const _0x10dfce=await this[_0x555639(0x274)](LTM_DP_DRIFT_STATUS),_0x1c7315=await this[_0x555639(0x274)](LTM_DP_DRIFT_DETAILS);_0x9e0dc7[_0x555639(0x2c1)]=_0x10dfce?_0x10dfce[_0x555639(0x1ec)]:_0x555639(0x1cb),_0x9e0dc7[_0x555639(0x231)]=_0x1c7315?_0x1c7315['val']:'';}catch(_0x5b4a98){}this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x9e0dc7,'analysisHistory':this['analysisHistory']},_0x48e2d4['callback']);}else{if(_0x48e2d4[_0x555639(0x25e)]==='getOverviewData'){const _0x509df0=this[_0x555639(0x2f0)][_0x555639(0x251)],_0x3013f6=new Date(),_0x3312fc=new Date(_0x3013f6['getFullYear'](),_0x3013f6[_0x555639(0x29b)](),_0x3013f6['getDate']())[_0x555639(0x2ef)](),_0x1355a3=this[_0x555639(0x335)][_0x555639(0x1e7)](_0x40a317=>new Date(_0x40a317[_0x555639(0x349)])[_0x555639(0x2ef)]()>_0x3312fc)[_0x555639(0x251)],_0x5db5b6=new Array(0x18)[_0x555639(0x304)](0x0);this['rawEventLog'][_0x555639(0x1ed)](_0x47689b=>{const _0x868d00=_0x555639,_0x5eb071=new Date(_0x47689b[_0x868d00(0x349)]);if(_0x5eb071[_0x868d00(0x2ef)]()>_0x3312fc)_0x5db5b6[_0x5eb071['getHours']()]++;});let _0x106880={'status':_0x555639(0x1cb)};try{const _0x3e121e=await this[_0x555639(0x274)](LTM_DP_DRIFT_STATUS);_0x106880['status']=_0x3e121e?_0x3e121e[_0x555639(0x1ec)]:_0x555639(0x1cb);}catch(_0x2304b3){}let _0x121eb2='';try{const _0x3ad63b=await this[_0x555639(0x274)](_0x555639(0x28f));_0x121eb2=_0x3ad63b?_0x3ad63b[_0x555639(0x1ec)]:'';}catch(_0x26f734){}let _0x3c5871=null;!this[_0x555639(0x1c3)]&&(_0x3c5871=this[_0x555639(0x333)]['geminiApiKey']?_0x555639(0x22c):'Kein\x20API\x20Key!');let _0x340bc4={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x403a47=await this[_0x555639(0x274)](_0x555639(0x230)),_0x2beac1=await this[_0x555639(0x274)](_0x555639(0x27b)),_0x29f143=await this['getStateAsync'](_0x555639(0x15e)),_0x54f259=await this['getStateAsync'](_0x555639(0x16a)),_0x3ef583=await this[_0x555639(0x274)](_0x555639(0x1fd));_0x403a47&&_0x403a47['val']&&(_0x340bc4[_0x555639(0x27c)]=!![],_0x340bc4[_0x555639(0x1a8)]=_0x2beac1?_0x2beac1[_0x555639(0x1ec)]:'',_0x340bc4[_0x555639(0x352)]=_0x29f143?_0x29f143[_0x555639(0x1ec)]:'',_0x340bc4['targetValue']=_0x54f259?_0x54f259['val']:''),_0x340bc4[_0x555639(0x18f)]=_0x3ef583?!!_0x3ef583[_0x555639(0x1ec)]:![];}catch(_0x4ced32){}this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':!![],'eventHistory':this[_0x555639(0x285)][_0x555639(0x1a2)](0x0,0xf),'stats':{'digestCount':_0x509df0,'eventCountToday':_0x1355a3,'hourlyActivity':_0x5db5b6,'driftStatus':_0x106880[_0x555639(0x2c1)],'isPresent':this['isPresent'],'presenceWho':_0x121eb2,'minDays':this['config']['minDaysForBaseline']||0x7,'stbDays':this['config'][_0x555639(0x33b)]||0xe,'ltbDays':this[_0x555639(0x333)]['ltmLtbWindowDays']||0x3c,'systemError':_0x3c5871},'automation':_0x340bc4},_0x48e2d4[_0x555639(0x2eb)]);}else{if(_0x48e2d4[_0x555639(0x25e)]===_0x555639(0x347))try{const _0x59facb=await this[_0x555639(0x2c8)](_0x48e2d4['message']||{});this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4['command'],{'success':!![],'devices':_0x59facb},_0x48e2d4[_0x555639(0x2eb)]);}catch(_0x427e04){this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':![],'error':_0x427e04[_0x555639(0x29e)]},_0x48e2d4[_0x555639(0x2eb)]);}else{if(_0x48e2d4['command']===_0x555639(0x2b2)){const _0x46b5bd=await this[_0x555639(0x317)](_0x555639(0x178),_0x555639(0x18a)),_0x259604=[];if(_0x46b5bd)for(const _0x1af814 in _0x46b5bd){const _0x1770fd=_0x46b5bd[_0x1af814],_0x64a5ac=(_0x1770fd[_0x555639(0x229)]&&typeof _0x1770fd[_0x555639(0x229)]['name']===_0x555639(0x1e4)?_0x1770fd[_0x555639(0x229)][_0x555639(0x165)]['de']:_0x1770fd[_0x555639(0x229)][_0x555639(0x165)])||_0x1770fd[_0x555639(0x229)]['name'];_0x259604[_0x555639(0x1bd)]({'id':_0x1af814,'name':_0x64a5ac});}this[_0x555639(0x24a)](_0x48e2d4['from'],_0x48e2d4[_0x555639(0x25e)],{'success':!![],'enums':_0x259604},_0x48e2d4[_0x555639(0x2eb)]);}else{if(_0x48e2d4['command']==='getCalendarNames'){const _0x8dd6bb=_0x48e2d4[_0x555639(0x29e)]['instance'];if(!_0x8dd6bb)return this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':![],'error':_0x555639(0x297)},_0x48e2d4[_0x555639(0x2eb)]);const _0x46dafc=await this[_0x555639(0x33a)](_0x8dd6bb);this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4['command'],{'success':!![],'names':_0x46dafc},_0x48e2d4[_0x555639(0x2eb)]);}else{if(_0x48e2d4[_0x555639(0x25e)]===_0x555639(0x296)){const {targetId:_0x2aa9c5,targetValue:_0x3295b5}=_0x48e2d4[_0x555639(0x29e)];this[_0x555639(0x32c)][_0x555639(0x345)](_0x555639(0x2bd)+_0x2aa9c5+_0x555639(0x2ab)+_0x3295b5),await this[_0x555639(0x308)](_0x555639(0x230),{'val':!![],'ack':!![]}),await this[_0x555639(0x308)](_0x555639(0x27b),{'val':_0x555639(0x1c1)+_0x2aa9c5,'ack':!![]}),await this['setStateAsync'](_0x555639(0x15e),{'val':_0x2aa9c5,'ack':!![]}),await this[_0x555639(0x308)](_0x555639(0x16a),{'val':_0x3295b5,'ack':!![]}),this[_0x555639(0x24a)](_0x48e2d4['from'],_0x48e2d4[_0x555639(0x25e)],{'success':!![]},_0x48e2d4[_0x555639(0x2eb)]);}else{if(_0x48e2d4[_0x555639(0x25e)]===_0x555639(0x203)){const {historyId:_0x28d659,rating:_0x4dcfbe,comment:_0x26c4c9,alertReason:_0x2f36e9}=_0x48e2d4[_0x555639(0x29e)];_0x28d659&&_0x4dcfbe?(await this[_0x555639(0x278)]({'timestamp':Date['now'](),'historyId':_0x28d659,'rating':_0x4dcfbe,'comment':_0x26c4c9,'alertReason':_0x2f36e9}),this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':!![]},_0x48e2d4[_0x555639(0x2eb)])):this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':![],'error':'Missing\x20data'},_0x48e2d4['callback']);}else _0x48e2d4[_0x555639(0x25e)]===_0x555639(0x182)&&(this['log'][_0x555639(0x345)](_0x555639(0x2ee)),await this[_0x555639(0x308)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x555639(0x308)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x555639(0x24a)](_0x48e2d4[_0x555639(0x34d)],_0x48e2d4[_0x555639(0x25e)],{'success':!![]},_0x48e2d4[_0x555639(0x2eb)]));}}}}}}}}}}async[a0_0x20bea8(0x194)](_0x52b944,_0x7a7b9f,_0x3ffc4a){const _0x11f320=a0_0x20bea8;if(!_0x3ffc4a)return;const _0x2203c7=_0x7a7b9f['val'],_0x45aeb5=Date[_0x11f320(0x1ea)](),_0xbe3b75=this[_0x11f320(0x2c2)][_0x52b944];this[_0x11f320(0x2c2)][_0x52b944]=_0x2203c7;if(!_0x3ffc4a['logDuplicates']&&_0xbe3b75!=undefined&&_0xbe3b75==_0x2203c7)return;const _0x1e6d2c=(_0x3ffc4a['type']||'')[_0x11f320(0x213)](),_0x5528a3=_0x1e6d2c['includes']('temperature')||_0x1e6d2c[_0x11f320(0x300)](_0x11f320(0x2db))||_0x1e6d2c[_0x11f320(0x300)](_0x11f320(0x254))||_0x1e6d2c[_0x11f320(0x300)](_0x11f320(0x280));this[_0x11f320(0x22a)]&&_0x5528a3&&this[_0x11f320(0x1d9)](_0x52b944,_0x2203c7,_0x3ffc4a[_0x11f320(0x21d)]);const _0x19c5be={'timestamp':_0x45aeb5,'id':_0x52b944,'name':_0x3ffc4a[_0x11f320(0x165)],'type':_0x3ffc4a[_0x11f320(0x2aa)],'location':_0x3ffc4a[_0x11f320(0x21d)],'value':_0x2203c7};this[_0x11f320(0x285)][_0x11f320(0x1e9)](_0x19c5be);if(this['eventHistory'][_0x11f320(0x251)]>HISTORY_MAX_SIZE)this[_0x11f320(0x285)]['pop']();await this[_0x11f320(0x308)](_0x11f320(0x2d3),{'val':JSON[_0x11f320(0x2a1)](_0x19c5be),'ack':!![]}),await this[_0x11f320(0x308)](_0x11f320(0x22d),{'val':JSON[_0x11f320(0x2a1)](this[_0x11f320(0x285)]),'ack':!![]});this['isProVersion']&&(this[_0x11f320(0x335)][_0x11f320(0x1bd)](_0x19c5be),await this['saveRawEventLog'](),this[_0x11f320(0x16e)](_0x19c5be));if(_0x3ffc4a[_0x11f320(0x253)]&&_0x2203c7===!![]){if(this['isPresent']&&!this[_0x11f320(0x21e)])this['startExitTimer']();else{if(!this[_0x11f320(0x27f)])this[_0x11f320(0x177)](!![]);}}else{if(_0x3ffc4a[_0x11f320(0x2aa)]===_0x11f320(0x1fc)&&_0x2203c7===!![]){if(this['exitTimer'])this[_0x11f320(0x337)]();if(!this[_0x11f320(0x27f)]&&this[_0x11f320(0x2e4)]===SYSTEM_MODES['NORMAL'])this[_0x11f320(0x177)](!![]);}}}async[a0_0x20bea8(0x16e)](_0x4479be){const _0x5ce9da=a0_0x20bea8,_0x56bfef=(_0x4479be[_0x5ce9da(0x2aa)]||'')[_0x5ce9da(0x213)](),_0x1d13bd=[_0x5ce9da(0x1fc),_0x5ce9da(0x2e5),_0x5ce9da(0x1e5),'presence','occupancy',_0x5ce9da(0x2da),_0x5ce9da(0x21c),'window','fenster','contact',_0x5ce9da(0x1a1),_0x5ce9da(0x31f),_0x5ce9da(0x2ad),'switch','schalter',_0x5ce9da(0x26a),_0x5ce9da(0x2ba)];if(!_0x1d13bd['some'](_0xeed9c7=>_0x56bfef[_0x5ce9da(0x300)](_0xeed9c7)))return;if(!_0x4479be['value'])return;if(this[_0x5ce9da(0x168)])clearTimeout(this[_0x5ce9da(0x168)]);this[_0x5ce9da(0x1b2)][_0x5ce9da(0x1bd)]({'loc':_0x4479be['location']||_0x5ce9da(0x1f3),'id':_0x4479be['id'],'ts':Date[_0x5ce9da(0x1ea)]()}),this['log'][_0x5ce9da(0x186)](_0x5ce9da(0x2b9)+_0x4479be[_0x5ce9da(0x21d)]+_0x5ce9da(0x2d2)+this['activeSequence'][_0x5ce9da(0x251)]+')'),this[_0x5ce9da(0x168)]=setTimeout(async()=>{const _0x2975e6=_0x5ce9da;if(this[_0x2975e6(0x1b2)]['length']>0x1)await this[_0x2975e6(0x2b0)]();this[_0x2975e6(0x1b2)]=[];},SEQUENCE_TIMEOUT_MS);}async[a0_0x20bea8(0x2b0)](){const _0x15ccd2=a0_0x20bea8;try{const _0x3c0da5=await this[_0x15ccd2(0x274)]('LTM.trainingData.sequences');let _0x2674e9=[];if(_0x3c0da5&&_0x3c0da5['val'])try{_0x2674e9=JSON['parse'](_0x3c0da5[_0x15ccd2(0x1ec)]);}catch(_0x4f3fb9){}const _0x3b1705=this[_0x15ccd2(0x1b2)][0x0]['ts'],_0x362894=this[_0x15ccd2(0x1b2)][_0x15ccd2(0x161)](_0x10f7c8=>({'loc':_0x10f7c8[_0x15ccd2(0x20b)],'t_delta':Math['round']((_0x10f7c8['ts']-_0x3b1705)/0x3e8)})),_0x1ed2c9={'timestamp':new Date(_0x3b1705)[_0x15ccd2(0x223)](),'steps':_0x362894,'duration':Math[_0x15ccd2(0x315)]((this['activeSequence'][this[_0x15ccd2(0x1b2)][_0x15ccd2(0x251)]-0x1]['ts']-_0x3b1705)/0x3e8),'daytime':new Date(_0x3b1705)[_0x15ccd2(0x1ba)]()};_0x2674e9[_0x15ccd2(0x1bd)](_0x1ed2c9);if(_0x2674e9[_0x15ccd2(0x251)]>MAX_TRAINING_SET_SIZE)_0x2674e9['shift']();await this['setStateAsync'](_0x15ccd2(0x2d1),{'val':JSON[_0x15ccd2(0x2a1)](_0x2674e9),'ack':!![]}),this[_0x15ccd2(0x305)](_0x1ed2c9);}catch(_0x37f3d1){this['log']['error'](_0x15ccd2(0x263)+_0x37f3d1['message']);}}[a0_0x20bea8(0x305)](_0x2aae1d){const _0x116bf7=a0_0x20bea8;if(!this[_0x116bf7(0x22a)])return;this['log'][_0x116bf7(0x186)](_0x116bf7(0x160)),this[_0x116bf7(0x31a)](_0x116bf7(0x2ec),{'sequence':_0x2aae1d});}[a0_0x20bea8(0x259)](){const _0x4b6218=a0_0x20bea8;if(this[_0x4b6218(0x30b)]||this['panicMode'])return;this[_0x4b6218(0x30b)]=!![];const _0x32b528=path[_0x4b6218(0x188)](__dirname,'python_service',_0x4b6218(0x1c7));this[_0x4b6218(0x32c)][_0x4b6218(0x345)](_0x4b6218(0x1cc)),this[_0x4b6218(0x260)]();if(fs[_0x4b6218(0x217)](VENV_PATH))try{fs[_0x4b6218(0x1f7)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x182fc9){}exec(_0x4b6218(0x288)+VENV_PATH+'\x22',_0x4f5560=>{const _0x5aea63=_0x4b6218;if(_0x4f5560){this[_0x5aea63(0x32c)][_0x5aea63(0x208)](_0x5aea63(0x1e0)),this['dependencyInstallInProgress']=![],this['panicMode']=!![];return;}this['installRequirementsInVenv'](_0x32b528);});}[a0_0x20bea8(0x228)](_0x1437de){const _0x241d69=a0_0x20bea8;this[_0x241d69(0x32c)][_0x241d69(0x345)](_0x241d69(0x31e));const _0x20354d='\x22'+PIP_EXE+_0x241d69(0x1de)+_0x1437de+'\x22';exec(_0x20354d,{'timeout':0x124f80},(_0x4e4bd1,_0x1b81fd,_0x78128)=>{const _0x1203d2=_0x241d69;this[_0x1203d2(0x30b)]=![],_0x4e4bd1?(this['log']['error'](_0x1203d2(0x1f0)+(_0x78128||_0x4e4bd1[_0x1203d2(0x29e)])),this[_0x1203d2(0x34b)]=!![]):(this[_0x1203d2(0x32c)][_0x1203d2(0x345)]('‚úÖ\x20INSTALL\x20SUCCESS.\x20Verifying...'),exec('\x22'+PYTHON_EXE+_0x1203d2(0x2a5),(_0x5e5ce2,_0x168bb6)=>{const _0x58113b=_0x1203d2;_0x168bb6&&_0x168bb6[_0x58113b(0x300)]('OK')?(this[_0x58113b(0x32c)][_0x58113b(0x345)](_0x58113b(0x1a5)),this[_0x58113b(0x2a7)]()):(this[_0x58113b(0x32c)][_0x58113b(0x208)](_0x58113b(0x192)),this[_0x58113b(0x34b)]=!![]);}));});}['startPythonService'](){const _0x241881=a0_0x20bea8;if(this[_0x241881(0x30b)]||this['panicMode'])return;let _0x3ef90e=_0x241881(0x215);if(fs[_0x241881(0x217)](PYTHON_EXE))this[_0x241881(0x32c)]['info'](_0x241881(0x314)+PYTHON_EXE),_0x3ef90e=PYTHON_EXE;else{this['log'][_0x241881(0x321)]('‚ö†Ô∏è\x20VENV\x20missing.\x20Reinstalling...'),this['installPythonDependencies']();return;}try{const _0x1512c3=path[_0x241881(0x188)](__dirname,_0x241881(0x196),_0x241881(0x15a));this[_0x241881(0x17a)]=spawn(_0x3ef90e,[_0x1512c3]),this['pythonProcess']['stdout']['on'](_0x241881(0x219),_0x1717d1=>{const _0x1fb39d=_0x241881,_0x52d781=_0x1717d1[_0x1fb39d(0x294)]()[_0x1fb39d(0x269)]('\x0a');_0x52d781['forEach'](_0x5aaf72=>{const _0x5eb07b=_0x1fb39d,_0x4e40f1=_0x5aaf72[_0x5eb07b(0x1ee)]();if(!_0x4e40f1)return;if(_0x4e40f1[_0x5eb07b(0x2ff)]('[LOG]'))this[_0x5eb07b(0x32c)]['debug'](_0x5eb07b(0x1ad)+_0x4e40f1[_0x5eb07b(0x33c)](0x5)[_0x5eb07b(0x1ee)]());else{if(_0x4e40f1[_0x5eb07b(0x2ff)](_0x5eb07b(0x25c)))try{const _0xff21a2=JSON['parse'](_0x4e40f1['substring'](0x8)[_0x5eb07b(0x1ee)]());this[_0x5eb07b(0x306)](_0xff21a2);}catch(_0x245592){this['log'][_0x5eb07b(0x321)]('Invalid\x20JSON:\x20'+_0x4e40f1);}}_0x4e40f1['includes'](_0x5eb07b(0x320))&&(this[_0x5eb07b(0x32c)][_0x5eb07b(0x208)](_0x5eb07b(0x2c9)+_0x4e40f1+_0x5eb07b(0x2bc)),this[_0x5eb07b(0x34b)]=!![],this[_0x5eb07b(0x260)]());});}),this['pythonProcess'][_0x241881(0x18b)]['on']('data',_0x1edc67=>{const _0x15ec67=_0x241881,_0x2712aa=_0x1edc67[_0x15ec67(0x294)]()[_0x15ec67(0x1ee)]();if(!_0x2712aa[_0x15ec67(0x300)]('cpu_feature_guard'))this[_0x15ec67(0x32c)][_0x15ec67(0x208)]('[PYTHON\x20ERR]\x20'+_0x2712aa);}),this[_0x241881(0x17a)]['on']('close',_0x17d109=>{const _0x570123=_0x241881;this['log'][_0x570123(0x345)](_0x570123(0x2cc)+_0x17d109),this[_0x570123(0x17a)]=null,_0x17d109!==0x0&&!this[_0x570123(0x34b)]&&setTimeout(()=>this[_0x570123(0x2a7)](),0x7530);});}catch(_0x164685){this[_0x241881(0x32c)][_0x241881(0x208)]('Error\x20launching\x20Python:\x20'+_0x164685['message']);}}[a0_0x20bea8(0x260)](){const _0x40ac9d=a0_0x20bea8;if(this[_0x40ac9d(0x17a)]){this[_0x40ac9d(0x32c)][_0x40ac9d(0x345)](_0x40ac9d(0x169));try{this[_0x40ac9d(0x17a)]['kill']();}catch(_0x158fd7){}this[_0x40ac9d(0x17a)]=null;}}[a0_0x20bea8(0x306)](_0x12b2f8){const _0x31b94f=a0_0x20bea8;if(_0x12b2f8[_0x31b94f(0x2aa)]===_0x31b94f(0x1a4))this[_0x31b94f(0x32c)][_0x31b94f(0x186)](_0x31b94f(0x303));else{if(_0x12b2f8['type']===_0x31b94f(0x21b)){const {anomaly_score:_0x47bc47,is_anomaly:_0x17e6d8,threshold:_0x376f4f}=_0x12b2f8[_0x31b94f(0x242)];this[_0x31b94f(0x32c)][_0x31b94f(0x345)](_0x31b94f(0x240)+_0x47bc47[_0x31b94f(0x1a7)](0x5)+_0x31b94f(0x312)+(_0x17e6d8?_0x31b94f(0x256):'OK')),this[_0x31b94f(0x308)](_0x31b94f(0x23b),{'val':_0x47bc47,'ack':!![]}),this[_0x31b94f(0x308)](_0x31b94f(0x17b),{'val':new Date()[_0x31b94f(0x223)](),'ack':!![]});if(_0x17e6d8){const _0x1d5522='Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x47bc47[_0x31b94f(0x1a7)](0x4)+')';this[_0x31b94f(0x308)](_0x31b94f(0x1bc),{'val':!![],'ack':!![]}),this[_0x31b94f(0x308)](_0x31b94f(0x237),{'val':_0x1d5522,'ack':!![]}),this[_0x31b94f(0x1ac)]('‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20'+_0x1d5522,![],!![]);}}else{if(_0x12b2f8[_0x31b94f(0x2aa)]===_0x31b94f(0x16c)){const {success:_0x628b1d,details:_0x2190f0}=_0x12b2f8[_0x31b94f(0x242)];this[_0x31b94f(0x308)](_0x31b94f(0x2af),{'val':_0x628b1d?_0x31b94f(0x1c9)+new Date()['toLocaleTimeString']()+'\x20('+_0x2190f0+')':_0x31b94f(0x248)+_0x2190f0,'ack':!![]});}else{if(_0x12b2f8[_0x31b94f(0x2aa)]===_0x31b94f(0x167)){const {success:_0x4fe33d,details:_0x56c349}=_0x12b2f8[_0x31b94f(0x242)];if(_0x4fe33d)try{const _0x480e18=JSON['parse'](_0x56c349);if(_0x480e18[_0x31b94f(0x176)])this[_0x31b94f(0x308)](_0x31b94f(0x164),{'val':JSON[_0x31b94f(0x2a1)](_0x480e18[_0x31b94f(0x176)]),'ack':!![]});if(_0x480e18[_0x31b94f(0x2d7)])this[_0x31b94f(0x308)](_0x31b94f(0x28a),{'val':JSON[_0x31b94f(0x2a1)](_0x480e18[_0x31b94f(0x2d7)]),'ack':!![]});}catch(_0x3f23b4){}}else{if(_0x12b2f8[_0x31b94f(0x2aa)]===_0x31b94f(0x1ce)){const {success:_0x2e91c9,details:_0x265b93}=_0x12b2f8[_0x31b94f(0x242)];if(_0x2e91c9)this['log'][_0x31b94f(0x345)](_0x31b94f(0x31b)+_0x265b93);}else{if(_0x12b2f8['type']===_0x31b94f(0x28c)){const {is_anomaly:_0x47161b,details:_0x245754}=_0x12b2f8[_0x31b94f(0x242)];this['setStateAsync'](_0x31b94f(0x2d8),{'val':new Date()[_0x31b94f(0x223)](),'ack':!![]}),this[_0x31b94f(0x308)](_0x31b94f(0x1e6),{'val':_0x47161b,'ack':!![]});}else{if(_0x12b2f8['type']===_0x31b94f(0x255)){const {diagnosis:_0x569c81,change_percent:_0x23ea3d}=_0x12b2f8[_0x31b94f(0x242)];this[_0x31b94f(0x32c)][_0x31b94f(0x345)](_0x31b94f(0x197)+_0x569c81+'\x20('+_0x23ea3d+'%)'),this['setStateAsync']('analysis.health.trendDiagnosis',{'val':_0x569c81,'ack':!![]}),this[_0x31b94f(0x308)](_0x31b94f(0x205),{'val':_0x23ea3d,'ack':!![]});}}}}}}}}['sendToPython'](_0x1df81e,_0x35f1d2={}){const _0x5cd454=a0_0x20bea8;if(!this[_0x5cd454(0x17a)]||!this[_0x5cd454(0x17a)][_0x5cd454(0x2d9)][_0x5cd454(0x1dd)])return;const _0x29cd77=JSON[_0x5cd454(0x2a1)]({'command':_0x1df81e,..._0x35f1d2});try{this[_0x5cd454(0x17a)]['stdin'][_0x5cd454(0x356)](_0x29cd77+'\x0a');}catch(_0x1e7322){}}async[a0_0x20bea8(0x1df)](){const _0x2e9322=a0_0x20bea8;try{const _0x381c8e=[_0x2e9322(0x1f8),_0x2e9322(0x277)];for(const _0x219c3a of _0x381c8e){try{const _0x553fa6=await this['getObjectAsync'](_0x219c3a);if(_0x553fa6)await this[_0x2e9322(0x319)](_0x219c3a);}catch(_0x13054f){}}}catch(_0x1245fb){}}async[a0_0x20bea8(0x298)](_0x57e3b5){return!![];}async[a0_0x20bea8(0x25b)](){const _0x382909=a0_0x20bea8;return _0x382909(0x22f);}async[a0_0x20bea8(0x2ea)](){const _0x21bedd=a0_0x20bea8;try{const _0x21c0a1=await this['getForeignObjectAsync'](_0x21bedd(0x266));if(_0x21c0a1&&_0x21c0a1[_0x21bedd(0x229)])this[_0x21bedd(0x1cf)]={'latitude':_0x21c0a1[_0x21bedd(0x229)][_0x21bedd(0x279)]||0x0,'longitude':_0x21c0a1['common'][_0x21bedd(0x1b3)]||0x0,'city':_0x21c0a1['common'][_0x21bedd(0x1f5)]||''};}catch(_0x26605d){}}async[a0_0x20bea8(0x232)](){const _0x590ac7=a0_0x20bea8;try{const _0x57db80=await this[_0x590ac7(0x274)](LTM_DP_RAW_LOG);if(_0x57db80&&_0x57db80[_0x590ac7(0x1ec)])this['rawEventLog']=JSON[_0x590ac7(0x2df)](_0x57db80[_0x590ac7(0x1ec)]);}catch(_0x173297){this['rawEventLog']=[];}}async[a0_0x20bea8(0x30c)](){const _0xd3f0d2=a0_0x20bea8;if(this[_0xd3f0d2(0x335)][_0xd3f0d2(0x251)]>RAW_LOG_MAX_SIZE)this[_0xd3f0d2(0x335)][_0xd3f0d2(0x316)](0x0,this[_0xd3f0d2(0x335)]['length']-RAW_LOG_MAX_SIZE);await this[_0xd3f0d2(0x308)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](this[_0xd3f0d2(0x335)]),'ack':!![]});}async[a0_0x20bea8(0x2d0)](){const _0x22e215=a0_0x20bea8;try{const _0x248030=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x248030&&_0x248030[_0x22e215(0x1ec)])this[_0x22e215(0x2f0)]=JSON[_0x22e215(0x2df)](_0x248030[_0x22e215(0x1ec)]);}catch(_0xac3d1d){this[_0x22e215(0x2f0)]=[];}await this[_0x22e215(0x1b8)]();}async['saveDailyDigests'](_0x5108f1=!![]){const _0x4f5e8d=a0_0x20bea8,_0x17475c=this[_0x4f5e8d(0x333)][_0x4f5e8d(0x26e)]||0x3c;this[_0x4f5e8d(0x2f0)][_0x4f5e8d(0x251)]>_0x17475c&&this[_0x4f5e8d(0x2f0)][_0x4f5e8d(0x316)](0x0,this['dailyDigests']['length']-_0x17475c);await this['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x4f5e8d(0x2a1)](this['dailyDigests']),'ack':!![]});if(_0x5108f1)await this[_0x4f5e8d(0x1b8)]();}async[a0_0x20bea8(0x2a3)](_0xb9c3a8){const _0x1876ab=a0_0x20bea8;this[_0x1876ab(0x214)][_0x1876ab(0x1e9)](_0xb9c3a8);if(this[_0x1876ab(0x214)][_0x1876ab(0x251)]>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0x1876ab(0x25f)]();await this[_0x1876ab(0x308)](_0x1876ab(0x1ae),{'val':JSON[_0x1876ab(0x2a1)](this['analysisHistory']),'ack':!![]});}async[a0_0x20bea8(0x1b8)](){const _0x1a83cb=a0_0x20bea8;if(!this['isProVersion']){await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x3692c7=this[_0x1a83cb(0x2f0)][_0x1a83cb(0x251)]>=(this[_0x1a83cb(0x333)][_0x1a83cb(0x247)]||0x7)?'Aktiv\x20('+this[_0x1a83cb(0x2f0)][_0x1a83cb(0x251)]+'\x20Tage)':_0x1a83cb(0x1ff)+this[_0x1a83cb(0x2f0)][_0x1a83cb(0x251)]+'/'+(this['config'][_0x1a83cb(0x247)]||0x7)+')';await this[_0x1a83cb(0x308)](LTM_DP_BASELINE_STATUS,{'val':_0x3692c7,'ack':!![]});}async['loadSystemMode'](){const _0x2caa72=a0_0x20bea8;try{const _0x2be14c=await this['getStateAsync'](SYSTEM_DP_MODE);_0x2be14c&&_0x2be14c[_0x2caa72(0x1ec)]&&Object[_0x2caa72(0x191)](SYSTEM_MODES)['includes'](_0x2be14c['val'])?this[_0x2caa72(0x2e4)]=_0x2be14c['val']:(this[_0x2caa72(0x2e4)]=SYSTEM_MODES['NORMAL'],await this[_0x2caa72(0x308)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x2caa72(0x2ca)],'ack':!![]}));}catch(_0x33b5a6){this[_0x2caa72(0x2e4)]=SYSTEM_MODES[_0x2caa72(0x2ca)];}}async[a0_0x20bea8(0x2b4)](){const _0x4bf61b=a0_0x20bea8;await this[_0x4bf61b(0x2e7)](_0x4bf61b(0x15d),{'type':_0x4bf61b(0x2fb),'common':{'name':_0x4bf61b(0x309)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x2c3),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x238),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL']},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x28f),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x1b4),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x4bf61b(0x2d3),{'type':'state','common':{'name':_0x4bf61b(0x235),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x21f),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x4bf61b(0x22d),{'type':'state','common':{'name':_0x4bf61b(0x17d),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x21f),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x2e7)](_0x4bf61b(0x334),{'type':'channel','common':{'name':'AI\x20Training'},'native':{}}),await this['setObjectNotExistsAsync'](_0x4bf61b(0x2bf),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x286),'type':_0x4bf61b(0x18d),'role':_0x4bf61b(0x350),'read':!![],'write':!![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x33d),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x16f),'type':_0x4bf61b(0x18d),'role':_0x4bf61b(0x350),'read':!![],'write':!![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x4bf61b(0x1ab),{'type':'state','common':{'name':_0x4bf61b(0x220),'type':_0x4bf61b(0x18d),'role':_0x4bf61b(0x350),'read':!![],'write':!![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x2af),{'type':'state','common':{'name':_0x4bf61b(0x2f2),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x2e7)](_0x4bf61b(0x243),{'type':_0x4bf61b(0x2fb),'common':{'name':_0x4bf61b(0x343)},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x23b),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x313),'type':_0x4bf61b(0x1d3),'role':_0x4bf61b(0x1e8),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x17b),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x307),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x1d1),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x2e7)](_0x4bf61b(0x32b),{'type':'channel','common':{'name':'Health\x20Analysis'},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x2d8),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x307),'type':'string','role':_0x4bf61b(0x1d1),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)]('analysis.health.isAnomaly',{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x1fb),'type':_0x4bf61b(0x18d),'role':_0x4bf61b(0x28e),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.health.trendDiagnosis',{'type':'state','common':{'name':_0x4bf61b(0x354),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x4bf61b(0x205),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x2b3),'type':'number','role':_0x4bf61b(0x1e8),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x2e7)](_0x4bf61b(0x30f),{'type':_0x4bf61b(0x2fb),'common':{'name':_0x4bf61b(0x26b)},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x164),{'type':'state','common':{'name':_0x4bf61b(0x351),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x28a),{'type':_0x4bf61b(0x238),'common':{'name':'Heating\x20Score','type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x2e7)](_0x4bf61b(0x166),{'type':_0x4bf61b(0x2fb),'common':{'name':'LTM'},'native':{}}),await this['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x163),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x21f),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x2e7)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':'Daily\x20Digests','type':_0x4bf61b(0x302),'role':_0x4bf61b(0x21f),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x2d1),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x273),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x21f),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x4bf61b(0x1c8),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x18e),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x21f),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)]('analysis.trigger',{'type':'state','common':{'name':_0x4bf61b(0x322),'type':_0x4bf61b(0x18d),'role':_0x4bf61b(0x350),'read':!![],'write':!![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x4bf61b(0x202),{'type':_0x4bf61b(0x238),'common':{'name':'Trigger\x20Briefing','type':_0x4bf61b(0x18d),'role':'button','read':!![],'write':!![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x1bc),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x30d),'type':_0x4bf61b(0x18d),'role':_0x4bf61b(0x1bf),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x237),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x1b5),'type':'string','role':'text.alarm','read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x2fe),{'type':'state','common':{'name':_0x4bf61b(0x264),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x230),{'type':'state','common':{'name':_0x4bf61b(0x174),'type':_0x4bf61b(0x18d),'role':_0x4bf61b(0x28e),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)]('analysis.automation.description',{'type':'state','common':{'name':_0x4bf61b(0x33f),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x15e),{'type':_0x4bf61b(0x238),'common':{'name':_0x4bf61b(0x318),'type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x16a),{'type':'state','common':{'name':'Target\x20Value','type':_0x4bf61b(0x302),'role':_0x4bf61b(0x225),'read':!![],'write':![]},'native':{}}),await this[_0x4bf61b(0x281)](_0x4bf61b(0x1fd),{'type':'state','common':{'name':_0x4bf61b(0x2a6),'type':'boolean','role':_0x4bf61b(0x234),'read':!![],'write':!![]},'native':{}}),await this[_0x4bf61b(0x281)]('analysis.automation.triggerAction',{'type':_0x4bf61b(0x238),'common':{'name':'Trigger\x20Action','type':_0x4bf61b(0x18d),'role':_0x4bf61b(0x350),'read':!![],'write':!![]},'native':{}});}async[a0_0x20bea8(0x1d9)](_0x5b3ff4,_0x69c806,_0x5a8435){const _0x2a5943=a0_0x20bea8,_0x56463d=await this['getOutsideTemperatureNumeric'](),_0x3a891a=await this['getStateAsync'](_0x2a5943(0x1c8));let _0x742bfe=[];if(_0x3a891a&&_0x3a891a[_0x2a5943(0x1ec)])try{_0x742bfe=JSON[_0x2a5943(0x2df)](_0x3a891a['val']);}catch(_0x1033b8){}_0x742bfe[_0x2a5943(0x1bd)]({'ts':Date[_0x2a5943(0x1ea)](),'room':_0x5a8435||_0x2a5943(0x1f3),'t_in':_0x69c806,'t_out':_0x56463d});if(_0x742bfe['length']>THERMO_LOG_SIZE)_0x742bfe[_0x2a5943(0x19f)]();await this[_0x2a5943(0x308)](_0x2a5943(0x1c8),{'val':JSON['stringify'](_0x742bfe),'ack':!![]});}async[a0_0x20bea8(0x187)](){const _0x1f3655=a0_0x20bea8;if(this[_0x1f3655(0x333)]['outdoorSensorId'])try{const _0x779e9d=await this[_0x1f3655(0x32a)](this[_0x1f3655(0x333)]['outdoorSensorId']);if(_0x779e9d&&_0x779e9d[_0x1f3655(0x1ec)]!==undefined&&_0x779e9d[_0x1f3655(0x1ec)]!==null)return parseFloat(_0x779e9d[_0x1f3655(0x1ec)]);}catch(_0x162e8f){}const _0x374fe3=this[_0x1f3655(0x333)][_0x1f3655(0x27a)];if(!this['config'][_0x1f3655(0x1e2)]||!_0x374fe3)return null;try{let _0x1ee8ca='';if(_0x374fe3[_0x1f3655(0x300)]('accuweather'))_0x1ee8ca=_0x374fe3+_0x1f3655(0x18c);else{if(_0x374fe3[_0x1f3655(0x300)](_0x1f3655(0x171)))_0x1ee8ca=_0x374fe3+_0x1f3655(0x200);else{if(_0x374fe3[_0x1f3655(0x300)](_0x1f3655(0x2d6)))_0x1ee8ca=_0x374fe3+'.forecast.current.temperature';else{if(_0x374fe3[_0x1f3655(0x300)](_0x1f3655(0x344)))_0x1ee8ca=_0x374fe3+'.forecast.current.temp';}}}if(_0x1ee8ca){const _0x4e318e=await this[_0x1f3655(0x32a)](_0x1ee8ca);if(_0x4e318e&&_0x4e318e[_0x1f3655(0x1ec)]!==undefined&&_0x4e318e[_0x1f3655(0x1ec)]!==null)return parseFloat(_0x4e318e['val']);}}catch(_0x245b48){}return null;}async[a0_0x20bea8(0x2c8)](_0x1aac7d){const _0x4f6c57=a0_0x20bea8;this[_0x4f6c57(0x32c)]['info'](_0x4f6c57(0x262));const _0x2a516a=[],_0xff912d=await this[_0x4f6c57(0x317)]('*'),_0xd2136f=await this[_0x4f6c57(0x317)](_0x4f6c57(0x178),_0x4f6c57(0x18a)),_0x5e5370=await this[_0x4f6c57(0x317)]('enum.rooms.*',_0x4f6c57(0x18a)),_0x508cdf={};if(_0xd2136f)for(const _0x174b94 in _0xd2136f){const _0x42c407=_0xd2136f[_0x174b94][_0x4f6c57(0x229)][_0x4f6c57(0x23f)]||[];_0x42c407[_0x4f6c57(0x1ed)](_0x320545=>{const _0xda88a8=_0x4f6c57;if(!_0x508cdf[_0x320545])_0x508cdf[_0x320545]=[];_0x508cdf[_0x320545][_0xda88a8(0x1bd)](_0x174b94);});}const _0x2867c9={};if(_0x5e5370)for(const _0x3d97d9 in _0x5e5370){const _0x27c6e0=_0x5e5370[_0x3d97d9][_0x4f6c57(0x229)][_0x4f6c57(0x23f)]||[],_0x2c91a2=typeof _0x5e5370[_0x3d97d9]['common']['name']===_0x4f6c57(0x1e4)?_0x5e5370[_0x3d97d9][_0x4f6c57(0x229)][_0x4f6c57(0x165)]['de']:_0x5e5370[_0x3d97d9][_0x4f6c57(0x229)][_0x4f6c57(0x165)];_0x27c6e0[_0x4f6c57(0x1ed)](_0x36801e=>_0x2867c9[_0x36801e]=_0x2c91a2);}const _0x43a748=_0x1aac7d[_0x4f6c57(0x1fc)]!==![],_0x391e37=_0x1aac7d[_0x4f6c57(0x1a6)]!==![],_0x4de65d=_0x1aac7d[_0x4f6c57(0x1d4)]!==![],_0x1205cd=_0x1aac7d[_0x4f6c57(0x270)]===!![],_0x47b109=_0x1aac7d[_0x4f6c57(0x2c6)]===!![];for(const _0x4d65e5 in _0xff912d){const _0x539724=_0xff912d[_0x4d65e5];if(_0x539724[_0x4f6c57(0x2aa)]!==_0x4f6c57(0x238)||!_0x539724[_0x4f6c57(0x229)])continue;if(ADAPTER_BLACKLIST['some'](_0x4c6831=>_0x4d65e5['startsWith'](_0x4c6831))&&!_0x47b109)continue;const _0x325091=(_0x539724['common'][_0x4f6c57(0x326)]||'')[_0x4f6c57(0x213)]();let _0x48afff=(typeof _0x539724[_0x4f6c57(0x229)][_0x4f6c57(0x165)]===_0x4f6c57(0x1e4)?_0x539724[_0x4f6c57(0x229)][_0x4f6c57(0x165)]['de']:_0x539724['common'][_0x4f6c57(0x165)])||_0x4d65e5;const _0x36a6d7=_0x48afff[_0x4f6c57(0x213)]();let _0x3f86c7=![];if(_0x1aac7d[_0x4f6c57(0x2b6)]&&_0x1aac7d['selectedFunctionIds'][_0x4f6c57(0x251)]>0x0){const _0xe4fdce=_0x508cdf[_0x4d65e5]||[],_0x37e081=_0x4d65e5[_0x4f6c57(0x269)]('.')[_0x4f6c57(0x1a2)](0x0,-0x1)[_0x4f6c57(0x188)]('.'),_0x16205b=_0x508cdf[_0x37e081]||[];(_0xe4fdce['some'](_0x211815=>_0x1aac7d[_0x4f6c57(0x2b6)]['includes'](_0x211815))||_0x16205b['some'](_0x5cef31=>_0x1aac7d['selectedFunctionIds']['includes'](_0x5cef31)))&&(_0x3f86c7=!![]);}if(_0x47b109&&_0x4d65e5['includes'](_0x4f6c57(0x270)))_0x3f86c7=!![];if(!_0x3f86c7&&!_0x47b109){if(HARD_IGNORE_TERMS['some'](_0x2b8e0a=>_0x4d65e5[_0x4f6c57(0x300)](_0x2b8e0a)||_0x36a6d7[_0x4f6c57(0x300)](_0x2b8e0a[_0x4f6c57(0x213)]())))continue;}let _0x4b2381='';if(_0x43a748&&(_0x325091[_0x4f6c57(0x300)](_0x4f6c57(0x1fc))||_0x325091['includes'](_0x4f6c57(0x2a4))))_0x4b2381=_0x4f6c57(0x1fc);else{if(_0x391e37&&(_0x325091[_0x4f6c57(0x300)]('door')||_0x325091[_0x4f6c57(0x300)](_0x4f6c57(0x2a2))))_0x4b2381=_0x4f6c57(0x2da);else{if(_0x4de65d&&(_0x325091['includes'](_0x4f6c57(0x31f))||_0x325091[_0x4f6c57(0x300)](_0x4f6c57(0x234))))_0x4b2381=_0x4f6c57(0x31f);else{if(_0x1205cd&&(_0x325091['includes'](_0x4f6c57(0x270))||_0x325091[_0x4f6c57(0x300)]('humidity')))_0x4b2381='temperature';}}}if(_0x4b2381){let _0x577cda=_0x2867c9[_0x4d65e5]||'';if(!_0x577cda){let _0x3227b5=_0x4d65e5;for(let _0x5ca310=0x0;_0x5ca310<0x3;_0x5ca310++){const _0xabe065=_0x3227b5[_0x4f6c57(0x26f)]('.');if(_0xabe065===-0x1)break;_0x3227b5=_0x3227b5[_0x4f6c57(0x33c)](0x0,_0xabe065);if(_0x2867c9[_0x3227b5]){_0x577cda=_0x2867c9[_0x3227b5];break;}}}_0x2a516a[_0x4f6c57(0x1bd)]({'id':_0x4d65e5,'name':_0x48afff,'location':_0x577cda,'type':_0x4b2381,'logDuplicates':_0x4b2381===_0x4f6c57(0x1fc),'isExit':![],'_score':_0x577cda?0x50:0x28});}}return _0x2a516a;}async['runGeminiAnalysis'](_0x420f1e=''){const _0x4b85b2=a0_0x20bea8;if(!this['geminiModel'])return;if(this[_0x4b85b2(0x285)][_0x4b85b2(0x251)]===0x0)return;const _0x4b8623=this[_0x4b85b2(0x285)]['slice'](0x0,0xf),_0x5e164a=await this[_0x4b85b2(0x1da)](),_0x5c216e=this[_0x4b85b2(0x2e4)],_0x63c929=PERSONA_MAPPING[this['config']['aiPersona']||_0x4b85b2(0x23e)],_0x2c1f5b=this['config'][_0x4b85b2(0x2f6)]||'Keine\x20Details.';let _0x14cf01=_0x4b85b2(0x224);try{const _0x23bcb8=await this[_0x4b85b2(0x274)]('system.presenceWho');if(_0x23bcb8&&_0x23bcb8[_0x4b85b2(0x1ec)])_0x14cf01=_0x23bcb8[_0x4b85b2(0x1ec)];}catch(_0x240bf9){}let _0x447d2d=![];try{const _0x3c682f=await this['getStateAsync'](_0x4b85b2(0x1fd));if(_0x3c682f&&_0x3c682f['val'])_0x447d2d=!![];}catch(_0x4be87c){}const _0xb751bd='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x63c929+_0x4b85b2(0x310)+_0x2c1f5b+_0x4b85b2(0x2be)+_0x5c216e+_0x4b85b2(0x26c)+_0x5e164a+_0x4b85b2(0x241)+_0x14cf01+_0x4b85b2(0x245)+JSON[_0x4b85b2(0x2a1)](_0x4b8623)+_0x4b85b2(0x19b)+_0x420f1e+_0x4b85b2(0x19e);try{const _0x5b27c1=await this[_0x4b85b2(0x1c3)][_0x4b85b2(0x17e)](_0xb751bd),_0x9ec0bf=_0x5b27c1[_0x4b85b2(0x20d)][_0x4b85b2(0x225)]()[_0x4b85b2(0x2e3)](/```json|```/g,'')[_0x4b85b2(0x1ee)](),_0x3c6ddc=JSON[_0x4b85b2(0x2df)](_0x9ec0bf);await this[_0x4b85b2(0x308)](_0x4b85b2(0x267),{'val':JSON[_0x4b85b2(0x2a1)](_0x3c6ddc),'ack':!![]});if(_0x3c6ddc[_0x4b85b2(0x30e)])await this['setStateAsync'](_0x4b85b2(0x2fe),{'val':_0x3c6ddc[_0x4b85b2(0x30e)],'ack':!![]});const _0x443006={'timestamp':Date[_0x4b85b2(0x1ea)](),'id':Date[_0x4b85b2(0x1ea)]()[_0x4b85b2(0x294)](),'analysis':{'activity':{'summary':_0x3c6ddc['summary'],'isAlert':_0x3c6ddc['isAlert'],'alertReason':_0x3c6ddc['alertReason']},'comfort':{'automationProposal':_0x3c6ddc[_0x4b85b2(0x173)]}}};await this['updateAnalysisHistory'](_0x443006);const _0x1015a6=_0x3c6ddc[_0x4b85b2(0x291)]||![];_0x1015a6!==this['lastAlertState']&&(await this[_0x4b85b2(0x308)](_0x4b85b2(0x1bc),{'val':_0x1015a6,'ack':!![]}),this[_0x4b85b2(0x221)]=_0x1015a6,_0x1015a6&&(await this[_0x4b85b2(0x308)]('analysis.alertReason',{'val':_0x3c6ddc[_0x4b85b2(0x329)],'ack':!![]}),this['sendNotification'](_0x4b85b2(0x340)+_0x3c6ddc[_0x4b85b2(0x329)],![],_0x3c6ddc[_0x4b85b2(0x28b)])));if(_0x3c6ddc['automationProposal']&&_0x3c6ddc[_0x4b85b2(0x173)][_0x4b85b2(0x27c)]){await this[_0x4b85b2(0x308)](_0x4b85b2(0x230),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x4b85b2(0x27b),{'val':_0x3c6ddc[_0x4b85b2(0x173)][_0x4b85b2(0x1a8)],'ack':!![]}),await this[_0x4b85b2(0x308)](_0x4b85b2(0x15e),{'val':_0x3c6ddc[_0x4b85b2(0x173)][_0x4b85b2(0x352)],'ack':!![]}),await this[_0x4b85b2(0x308)](_0x4b85b2(0x16a),{'val':JSON[_0x4b85b2(0x2a1)](_0x3c6ddc[_0x4b85b2(0x173)]['targetValue']),'ack':!![]});if(_0x447d2d)this['executeAutomationAction']();}}catch(_0x97116){this[_0x4b85b2(0x32c)][_0x4b85b2(0x208)](_0x4b85b2(0x1d8)+_0x97116[_0x4b85b2(0x29e)]);}}async[a0_0x20bea8(0x30a)](){const _0xc6e60d=a0_0x20bea8;if(!this[_0xc6e60d(0x22a)])return;await this[_0xc6e60d(0x308)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!this[_0xc6e60d(0x1c3)]||this[_0xc6e60d(0x335)][_0xc6e60d(0x251)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0xc6e60d(0x308)](LTM_DP_STATUS,{'val':_0xc6e60d(0x32f),'ack':!![]});return;}const _0x397563=JSON[_0xc6e60d(0x2df)](JSON[_0xc6e60d(0x2a1)](this[_0xc6e60d(0x335)])),_0xd4349b=_0x397563[_0xc6e60d(0x251)],_0x40835e=_0xc6e60d(0x293)+JSON[_0xc6e60d(0x2a1)](_0x397563);try{const _0x332423=await this[_0xc6e60d(0x1c3)][_0xc6e60d(0x17e)](_0x40835e),_0xab1179=JSON[_0xc6e60d(0x2df)](_0x332423['response'][_0xc6e60d(0x225)]()[_0xc6e60d(0x2e3)](/```json|```/g,'')[_0xc6e60d(0x1ee)]()),_0x5bd1a8={'timestamp':new Date()[_0xc6e60d(0x223)](),'eventCount':_0xd4349b,'summary':_0xab1179[_0xc6e60d(0x30e)]||_0xc6e60d(0x170),'activityLevel':_0xab1179[_0xc6e60d(0x233)]||_0xc6e60d(0x265),'systemMode':this[_0xc6e60d(0x2e4)]};this[_0xc6e60d(0x2f0)][_0xc6e60d(0x1bd)](_0x5bd1a8),await this[_0xc6e60d(0x1b9)](),this[_0xc6e60d(0x335)]=[],await this[_0xc6e60d(0x30c)](),await this[_0xc6e60d(0x308)](LTM_DP_STATUS,{'val':_0xc6e60d(0x172),'ack':!![]});if(this[_0xc6e60d(0x22a)])this[_0xc6e60d(0x31a)](_0xc6e60d(0x2a0),{'digest':_0x5bd1a8});}catch(_0x3f625e){this[_0xc6e60d(0x32c)]['error'](_0x3f625e[_0xc6e60d(0x29e)]);}}async[a0_0x20bea8(0x1fe)](){const _0x3c781f=a0_0x20bea8;if(!this['isProVersion']||!this['geminiModel'])return;const _0x1674ab=this[_0x3c781f(0x333)][_0x3c781f(0x33b)]||0xe;if(this[_0x3c781f(0x2f0)][_0x3c781f(0x251)]<_0x1674ab+0x7){await this[_0x3c781f(0x308)](LTM_DP_DRIFT_STATUS,{'val':_0x3c781f(0x2ac),'ack':!![]});return;}const _0x2419a8=this[_0x3c781f(0x2f0)]['slice'](-_0x1674ab),_0x218e02=this[_0x3c781f(0x2f0)][_0x3c781f(0x1a2)](0x0,this[_0x3c781f(0x2f0)][_0x3c781f(0x251)]-_0x1674ab),_0x56ea41=_0x3c781f(0x218)+JSON[_0x3c781f(0x2a1)](_0x218e02)+'\x0aSTB:\x20'+JSON[_0x3c781f(0x2a1)](_0x2419a8);try{const _0x1d0b07=await this[_0x3c781f(0x1c3)][_0x3c781f(0x17e)](_0x56ea41),_0x47c4f5=JSON[_0x3c781f(0x2df)](_0x1d0b07[_0x3c781f(0x20d)][_0x3c781f(0x225)]()[_0x3c781f(0x2e3)](/```json|```/g,'')[_0x3c781f(0x1ee)]());_0x47c4f5[_0x3c781f(0x1ef)]&&(await this[_0x3c781f(0x308)](LTM_DP_DRIFT_STATUS,{'val':_0x47c4f5[_0x3c781f(0x1ef)],'ack':!![]}),await this[_0x3c781f(0x308)](LTM_DP_DRIFT_DETAILS,{'val':_0x47c4f5['driftDetails'],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x5af845){}}async[a0_0x20bea8(0x249)](){const _0x4d5ef6=a0_0x20bea8;if(!this['geminiModel'])return;this[_0x4d5ef6(0x32c)][_0x4d5ef6(0x345)](_0x4d5ef6(0x2e0));const _0xb183a1=this[_0x4d5ef6(0x2f0)][_0x4d5ef6(0x251)]>0x0?this[_0x4d5ef6(0x2f0)][this['dailyDigests'][_0x4d5ef6(0x251)]-0x1]:null,_0x2ff80e=_0xb183a1&&_0xb183a1[_0x4d5ef6(0x24c)]?_0xb183a1[_0x4d5ef6(0x24c)]['sleepScore']:_0x4d5ef6(0x1cb),_0x4842d3=new Date();_0x4842d3['setHours'](0x4,0x0,0x0,0x0);const _0x4c35a0=this[_0x4d5ef6(0x285)][_0x4d5ef6(0x1e7)](_0x1bdf4e=>new Date(_0x1bdf4e[_0x4d5ef6(0x349)])>_0x4842d3),_0x517cb7=PERSONA_MAPPING[this[_0x4d5ef6(0x333)]['aiPersona']||_0x4d5ef6(0x23e)],_0x3c5783=this[_0x4d5ef6(0x333)][_0x4d5ef6(0x2f6)]||'',_0x4a04db=await this['getWeatherContext'](),_0x31716a=await this[_0x4d5ef6(0x198)](),_0x2f2bcb='ROLLE:\x20Assistent.\x20AUFGABE:\x20Schreibe\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20'+_0x517cb7+_0x4d5ef6(0x310)+_0x3c5783+_0x4d5ef6(0x275)+_0x4a04db+'\x20'+_0x31716a+_0x4d5ef6(0x2e8)+_0x2ff80e+_0x4d5ef6(0x1c6);try{const _0x2e3952=await this['geminiModel']['generateContent'](_0x2f2bcb),_0x248dff=_0x4d5ef6(0x2dd)+_0x2e3952[_0x4d5ef6(0x20d)][_0x4d5ef6(0x225)]()['trim']();this[_0x4d5ef6(0x1ac)](_0x248dff);}catch(_0x2da796){this['log']['error'](_0x4d5ef6(0x2cb)+_0x2da796[_0x4d5ef6(0x29e)]);}}async['runAutopilot'](){const _0x18eda9=a0_0x20bea8,_0xe6660f=this[_0x18eda9(0x333)][_0x18eda9(0x1a0)],_0x427bca=this[_0x18eda9(0x285)][_0x18eda9(0x251)]>0x0?this[_0x18eda9(0x285)][0x0][_0x18eda9(0x349)]:Date[_0x18eda9(0x1ea)](),_0x2d99a9=(Date['now']()-_0x427bca)/(0x3e8*0x3c*0x3c);let _0x1dd261='';this[_0x18eda9(0x333)]['inactivityMonitoringEnabled']&&this[_0x18eda9(0x2e4)]===SYSTEM_MODES['NORMAL']&&this[_0x18eda9(0x27f)]&&(_0x2d99a9>_0xe6660f&&(_0x1dd261=_0x18eda9(0x180)+_0x2d99a9['toFixed'](0x1)+'h.')),this['runGeminiAnalysis'](_0x1dd261);}async[a0_0x20bea8(0x33a)](_0x5cf265){const _0x39126a=a0_0x20bea8;try{const _0x2eacbc=await this[_0x39126a(0x32a)](_0x5cf265+_0x39126a(0x15f));if(_0x2eacbc&&_0x2eacbc['val']){const _0x4b874d=JSON[_0x39126a(0x2df)](_0x2eacbc[_0x39126a(0x1ec)]);if(Array[_0x39126a(0x22e)](_0x4b874d))return[...new Set(_0x4b874d['map'](_0x42373d=>_0x42373d[_0x39126a(0x20c)])[_0x39126a(0x1e7)](Boolean))][_0x39126a(0x2f5)]();}}catch(_0x965f80){}return[];}async['getCalendarContext'](){const _0x42a2fc=a0_0x20bea8;if(!this[_0x42a2fc(0x333)][_0x42a2fc(0x336)])return _0x42a2fc(0x1be);const _0x49d604=this[_0x42a2fc(0x333)][_0x42a2fc(0x222)]||'ical.0';try{const _0x1d4b1c=await this[_0x42a2fc(0x32a)](_0x49d604+_0x42a2fc(0x15f));if(_0x1d4b1c&&_0x1d4b1c[_0x42a2fc(0x1ec)]){let _0x34af19=JSON[_0x42a2fc(0x2df)](_0x1d4b1c[_0x42a2fc(0x1ec)]);if(Array['isArray'](_0x34af19)){if(_0x34af19[_0x42a2fc(0x251)]>0x0)return _0x42a2fc(0x1f6)+_0x34af19[_0x42a2fc(0x1a2)](0x0,0x3)[_0x42a2fc(0x161)](_0x19ee38=>_0x19ee38[_0x42a2fc(0x207)])[_0x42a2fc(0x188)](',\x20');}}}catch(_0x7d558a){}return _0x42a2fc(0x287);}async[a0_0x20bea8(0x278)](_0x440dd0){const _0x4b3001=a0_0x20bea8;this[_0x4b3001(0x32c)][_0x4b3001(0x345)](_0x4b3001(0x2c4)+JSON[_0x4b3001(0x2a1)](_0x440dd0));}async[a0_0x20bea8(0x17c)](){const _0x5c971a=a0_0x20bea8,_0x2b31a5=this['config'][_0x5c971a(0x2a8)];if(_0x2b31a5&&_0x2b31a5['length']>0x0){this[_0x5c971a(0x32c)]['info']('Subscribing\x20to\x20'+_0x2b31a5[_0x5c971a(0x251)]+_0x5c971a(0x204));for(const _0x42feef of _0x2b31a5){if(_0x42feef['id']){await this[_0x5c971a(0x24e)](_0x42feef['id']);try{const _0x182829=await this[_0x5c971a(0x32a)](_0x42feef['id']);if(_0x182829)this[_0x5c971a(0x2c2)][_0x42feef['id']]=_0x182829[_0x5c971a(0x1ec)];}catch(_0x3a9a64){}}}}}async['initPresenceSubscriptions'](){const _0x4431a6=a0_0x20bea8,_0x927de7=this[_0x4431a6(0x333)][_0x4431a6(0x1c2)];if(_0x927de7&&_0x927de7[_0x4431a6(0x251)]>0x0){this[_0x4431a6(0x32c)][_0x4431a6(0x345)](_0x4431a6(0x1fa)+_0x927de7[_0x4431a6(0x251)]+'\x20presence\x20devices...');for(const _0x2da39f of _0x927de7){await this[_0x4431a6(0x24e)](_0x2da39f);}try{await this['checkWifiPresence']();}catch(_0x86bafb){}}}async[a0_0x20bea8(0x211)](){const _0x4364a7=a0_0x20bea8,_0xb09fec=this[_0x4364a7(0x333)][_0x4364a7(0x332)];this[_0x4364a7(0x333)]['notifyTelegramEnabled']&&_0xb09fec&&await this['subscribeForeignStatesAsync'](_0xb09fec+'.communicate.request');}async[a0_0x20bea8(0x2e2)](_0x4032e5){const _0x4b07fe=a0_0x20bea8;let _0x2b229a=_0x4032e5;_0x4032e5[_0x4b07fe(0x2ff)]('[')&&(_0x2b229a=_0x4032e5['substring'](_0x4032e5['indexOf'](']')+0x1));if(_0x2b229a==='COGNI_CONFIRM_OK')await this[_0x4b07fe(0x308)](_0x4b07fe(0x1bc),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x4b07fe(0x237),{'val':_0x4b07fe(0x2dc),'ack':!![]}),this[_0x4b07fe(0x221)]=![],this['sendNotification'](_0x4b07fe(0x175),![]);else _0x2b229a===_0x4b07fe(0x1c0)&&this[_0x4b07fe(0x1ac)](_0x4b07fe(0x2c0),![],!![]);}async[a0_0x20bea8(0x1ac)](_0x2b2b31,_0x56a67f=![],_0x1da7c1=![]){const _0x5e577e=a0_0x20bea8,_0x4d216b=this[_0x5e577e(0x333)];if(_0x4d216b[_0x5e577e(0x34e)]){let _0x2d383c={};(_0x2b2b31[_0x5e577e(0x300)](_0x5e577e(0x31d))||_0x1da7c1)&&(_0x2d383c={'reply_markup':{'inline_keyboard':[[{'text':_0x5e577e(0x209),'callback_data':_0x5e577e(0x1d6)}],[{'text':'üìû\x20R√ºckruf\x20anfordern','callback_data':_0x5e577e(0x1c0)}]]}}),await this[_0x5e577e(0x257)](_0x4d216b[_0x5e577e(0x332)],_0x5e577e(0x282),{'text':_0x2b2b31,'user':_0x4d216b['notifyTelegramRecipient'],..._0x2d383c});}if(_0x4d216b['notifyPushoverEnabled']){let _0x3fd4d1={'message':_0x2b2b31,'title':_0x1da7c1?_0x5e577e(0x1b7):_0x5e577e(0x183),'priority':_0x1da7c1?0x2:0x1,'device':_0x4d216b[_0x5e577e(0x2f4)]};_0x1da7c1&&(_0x3fd4d1['retry']=0x1e,_0x3fd4d1['expire']=0xe10,_0x3fd4d1[_0x5e577e(0x2a9)]='siren'),await this[_0x5e577e(0x257)](_0x4d216b[_0x5e577e(0x353)],_0x5e577e(0x282),_0x3fd4d1);}_0x4d216b[_0x5e577e(0x32d)]&&await this[_0x5e577e(0x257)](_0x4d216b[_0x5e577e(0x1f9)],'send',{'text':_0x2b2b31,'to':_0x4d216b[_0x5e577e(0x29f)]});}async['checkWifiPresence'](){const _0x31c9e0=a0_0x20bea8;try{const _0x1965a6=this[_0x31c9e0(0x333)][_0x31c9e0(0x1c2)]||[];let _0x385948=![];const _0x4f82d2=[];for(const _0x3c8f9f of _0x1965a6){try{const _0xcac804=await this['getForeignStateAsync'](_0x3c8f9f);_0xcac804&&(_0xcac804[_0x31c9e0(0x1ec)]===!![]||_0xcac804['val']===_0x31c9e0(0x32e)||_0xcac804[_0x31c9e0(0x1ec)]===0x1)&&(_0x385948=!![],_0x4f82d2[_0x31c9e0(0x1bd)](_0x3c8f9f));}catch(_0x1c3e2f){}}return await this[_0x31c9e0(0x308)](_0x31c9e0(0x28f),{'val':_0x4f82d2[_0x31c9e0(0x188)](',\x20'),'ack':!![]}),_0x385948&&(this['exitTimer']&&(this[_0x31c9e0(0x32c)][_0x31c9e0(0x345)](_0x31c9e0(0x19d)),this[_0x31c9e0(0x337)]()),!this[_0x31c9e0(0x27f)]&&this['currentSystemMode']===SYSTEM_MODES[_0x31c9e0(0x2ca)]&&await this['setPresence'](!![])),_0x385948;}catch(_0x3f0828){return this[_0x31c9e0(0x32c)][_0x31c9e0(0x208)]('Error\x20checking\x20WiFi:\x20'+_0x3f0828[_0x31c9e0(0x29e)]),![];}}[a0_0x20bea8(0x1a3)](){const _0x4053b4=a0_0x20bea8;this['abortExitTimer'](),this[_0x4053b4(0x21e)]=!![],this['exitGraceTimer']=setTimeout(()=>{const _0x55ed4f=_0x4053b4;this[_0x55ed4f(0x21e)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x4053b4(0x2f7)]=setTimeout(()=>{const _0x55e78c=_0x4053b4;this[_0x55e78c(0x177)](![]),this['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x20bea8(0x337)](){const _0x34e368=a0_0x20bea8;if(this[_0x34e368(0x2f7)])clearTimeout(this['exitTimer']);if(this['exitGraceTimer'])clearTimeout(this[_0x34e368(0x2f1)]);this['exitTimer']=null,this[_0x34e368(0x2f1)]=null,this[_0x34e368(0x21e)]=![];}async[a0_0x20bea8(0x177)](_0x37071e){const _0x17cad9=a0_0x20bea8;if(this[_0x17cad9(0x27f)]===_0x37071e)return;this['isPresent']=_0x37071e,await this[_0x17cad9(0x308)](_0x17cad9(0x244),{'val':_0x37071e,'ack':!![]});}[a0_0x20bea8(0x2d4)](){const _0x603626=a0_0x20bea8;if(this[_0x603626(0x328)])this[_0x603626(0x328)][_0x603626(0x25d)]();if(!this[_0x603626(0x22a)])return;this['ltmJob']=schedule[_0x603626(0x26d)](LTM_SCHEDULE,()=>this[_0x603626(0x30a)]());}[a0_0x20bea8(0x28d)](){const _0x247593=a0_0x20bea8;if(this[_0x247593(0x1db)])this['modeResetJob'][_0x247593(0x25d)]();this[_0x247593(0x1db)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x1a427b=_0x247593;await this[_0x1a427b(0x19c)](),AUTO_RESET_MODES[_0x1a427b(0x300)](this['currentSystemMode'])&&await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}[a0_0x20bea8(0x330)](){const _0x56f4ac=a0_0x20bea8;if(this[_0x56f4ac(0x17f)])clearInterval(this[_0x56f4ac(0x17f)]);if(!this[_0x56f4ac(0x22a)])return;this[_0x56f4ac(0x17f)]=setInterval(()=>this[_0x56f4ac(0x1fe)](),(this[_0x56f4ac(0x333)][_0x56f4ac(0x1d7)]||0x18)*0x36ee80),setTimeout(()=>this[_0x56f4ac(0x1fe)](),0x1388);}[a0_0x20bea8(0x2b8)](){const _0x4ec0ef=a0_0x20bea8;if(this[_0x4ec0ef(0x283)])this[_0x4ec0ef(0x283)][_0x4ec0ef(0x25d)]();if(!this[_0x4ec0ef(0x333)][_0x4ec0ef(0x1dc)])return;const _0x29ae64=(this['config'][_0x4ec0ef(0x341)]||_0x4ec0ef(0x193))[_0x4ec0ef(0x269)](':'),_0x2a2790=parseInt(_0x29ae64[0x0])||0x8,_0x2b2bfd=parseInt(_0x29ae64[0x1])||0x0,_0x2ed562=_0x2b2bfd+'\x20'+_0x2a2790+'\x20*\x20*\x20*';this[_0x4ec0ef(0x283)]=schedule[_0x4ec0ef(0x26d)](_0x2ed562,()=>{const _0xc01c41=_0x4ec0ef;this[_0xc01c41(0x249)]();});}[a0_0x20bea8(0x27d)](){const _0x136cba=a0_0x20bea8;if(!this[_0x136cba(0x2f0)]||this[_0x136cba(0x2f0)][_0x136cba(0x251)]<0x2)return;const _0x10374b=this[_0x136cba(0x2f0)][_0x136cba(0x161)](_0x542aa3=>{const _0x18791d=_0x136cba,_0x2f8e19=(_0x542aa3[_0x18791d(0x233)]||'')[_0x18791d(0x213)]();return ACTIVITY_LEVEL_MAP[_0x2f8e19]||0x32;});this[_0x136cba(0x32c)]['info'](_0x136cba(0x1c5)+_0x10374b[_0x136cba(0x251)]+_0x136cba(0x292)),this['sendToPython']('ANALYZE_TREND',{'values':_0x10374b,'tag':_0x136cba(0x276)});}}if(require['main']!==module)module['exports']=_0x5e9aa7=>new CogniLiving(_0x5e9aa7);else new CogniLiving();