const a0_0x32bd87=a0_0x18ed;(function(_0x2da751,_0x286b39){const _0x166d03=a0_0x18ed,_0x340c97=_0x2da751();while(!![]){try{const _0xc6ba8b=parseInt(_0x166d03(0x22d))/0x1+parseInt(_0x166d03(0x177))/0x2*(-parseInt(_0x166d03(0x1f5))/0x3)+-parseInt(_0x166d03(0x27e))/0x4+-parseInt(_0x166d03(0x340))/0x5+parseInt(_0x166d03(0x32b))/0x6+parseInt(_0x166d03(0x2db))/0x7+-parseInt(_0x166d03(0x257))/0x8*(-parseInt(_0x166d03(0x2b8))/0x9);if(_0xc6ba8b===_0x286b39)break;else _0x340c97['push'](_0x340c97['shift']());}catch(_0x2004b0){_0x340c97['push'](_0x340c97['shift']());}}}(a0_0x13f7,0x52329));const a0_0x83f978=(function(){let _0x2f435c=!![];return function(_0xaf50c0,_0x371202){const _0x122ba7=_0x2f435c?function(){const _0x48e2b9=a0_0x18ed;if(_0x371202){const _0x167d40=_0x371202[_0x48e2b9(0x21f)](_0xaf50c0,arguments);return _0x371202=null,_0x167d40;}}:function(){};return _0x2f435c=![],_0x122ba7;};}()),a0_0x561ed3=a0_0x83f978(this,function(){const _0x148127=a0_0x18ed;return a0_0x561ed3[_0x148127(0x173)]()['search'](_0x148127(0x29e))[_0x148127(0x173)]()['constructor'](a0_0x561ed3)[_0x148127(0x213)]('(((.+)+)+)+$');});a0_0x561ed3();'use strict';const utils=require(a0_0x32bd87(0x29f)),{GoogleGenerativeAI}=require(a0_0x32bd87(0x240)),schedule=require(a0_0x32bd87(0x1b0)),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x32bd87(0x1fd),LTM_SCHEDULE=a0_0x32bd87(0x2cf),MODE_RESET_SCHEDULE=a0_0x32bd87(0x32f),LTM_DP_RAW_LOG=a0_0x32bd87(0x2f0),LTM_DP_DAILY_DIGESTS=a0_0x32bd87(0x188),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x32bd87(0x1c9),LTM_DP_BASELINE_STATUS=a0_0x32bd87(0x1e4),LTM_DP_DRIFT_CHANNEL=a0_0x32bd87(0x18c),LTM_DP_DRIFT_STATUS=a0_0x32bd87(0x2ec),LTM_DP_DRIFT_DETAILS=a0_0x32bd87(0x1d4),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x32bd87(0x291),'PARTY':a0_0x32bd87(0x2b1),'GUEST':a0_0x32bd87(0x2a5)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x32bd87(0x313)],SYSTEM_MODES[a0_0x32bd87(0x294)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':a0_0x32bd87(0x284),'family':a0_0x32bd87(0x268),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':a0_0x32bd87(0x1d5)};function a0_0x18ed(_0x146293,_0x5380f3){const _0x19589e=a0_0x13f7();return a0_0x18ed=function(_0x561ed3,_0x83f978){_0x561ed3=_0x561ed3-0x169;let _0x13f7b7=_0x19589e[_0x561ed3];return _0x13f7b7;},a0_0x18ed(_0x146293,_0x5380f3);}function a0_0x13f7(){const _0xbf8463=['sendToAsync','Wetter:\x20Deaktiviert','message','driftDetails','events.history_debug_03','pop','write','473044mkAiNr','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','Generating\x20Morning\x20Briefing...','longitude','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','system','üö®\x20EMERGENCY','licht','config','fenster','isPresent','startExitTimer','alertReason','devices','FAULT','firmware','No\x20instance','ical.0','saveDailyDigests','@google/generative-ai','Cogni-Living\x20Alert','Drift\x20Status','subscribeStates','flot.','Baseline\x20Status','event','Licht','isExit','analysis.comfortSummary','loadSystemMode\x20failed:\x20','checkLtmDriftObjects','Daily\x20Digest\x20created\x20successfully.','events.history','k√ºche','system.mode','doors','analysis.automation.suggestedAction','button','level','createAllObjects','time','forecast','2216248meZcFR','detectionState','ltmDriftCheckIntervalHours','\x20sensors...','getStateAsync','KALENDER:\x20Keine\x20Daten','ltmStbWindowDays','system.meta.uuid','aiPersona','flur','daswetter.0','notifyEmailInstance','Nein','Schalter/Licht','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','sendNotification','lights','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','comfort','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','material.','onUnload','stateChange','city','analysis.lastResult','feedbackHistory','Fehler:\x20','livingContext','PRO-','scanDevices','onMessage','lastCheck','sensorLastValues','VIRTUAL_CHANNEL','notifySignalInstance','last_seen','checkLicense','Scheduling\x20Morning\x20Briefing\x20for\x20','summary','185756zQsvhM','accuweather.','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','text','dailyDigests','[Test]\x20Notification','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','callback','patternDetected','VACATION','Party','role','occupancy','eventHistory','startsWith','weatherunderground.0','events.history_debug_00','geminiApiKey','eingang','vacation','wohnungst√ºr','json','GUEST','analysisTimer','bind','history','analysis.automation.description','setHours','testContext','modelid','map','activity','(((.+)+)+)+$','@iobroker/adapter-core','analysis.activitySummary','health','delObjectAsync','analysis.comfortSuggestion','sensor.door','guest','minDaysForBaseline','ERROR','t√ºr','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','now','daswetter.','DIRECTION','LOWBAT','analysis.isAlert','Starting\x20Smart\x20Scan\x20with\x20filters:\x20','08:00','party','Urlaub','setState','trim','sendTo','CONNECTION','licenseKey','18yatpsY','find','common','values','Rauchmelder','Reset\x20Sched\x20Error:\x20','calendarSelection','Error\x20reading\x20calendar\x20table:\x20','lastAlertState','apiKey','test','Subscribing\x20to\x20','from','User\x20Feedback:\x20Alarm\x20\x22','Flur','lampe','siren','enum.rooms.*','_score','toISOString','analysis.automation.patternDetected','checkLtmObjects','mode','0\x203\x20*\x20*\x20*','createAllObjects\x20failed:\x20','toUpperCase','analysisInterval','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','sleepScore','TEST-PRO-KEY','UNREACH','bewegung','\x20*\x20*\x20*','Last\x20Check','val','2243304BmgtUj','.data.table','capabilities','getCalendarContext','replace','main','enum.functions.*','Gemini\x20AI\x20initialized.','tryParse','catch','KALENDER:\x20','submitFeedback','description','cancel','onReady','reachable','.\x20PERSONA:\x20','LTM.driftAnalysis.baselineDrift','SECTION','native','scriptEnabled','LTM.rawEventLog','restlessness','WORKING','response','STICKY_UNREACH','shutter_contact','value.temperature','genAI','Schlafzimmer','checkSystemObjects','systemUUID','notifyTelegramInstance','notifyWhatsappEnabled','No\x20recorded\x20events\x20yet.','sendMorningBriefing','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','rauch','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','temperature','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','manufacturer','channel','filter','wohn','admin.','scanForDevices','name','details','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','extendObjectAsync','WEEK_PROGRAM','scriptProblem','setupBriefingScheduler','Processing\x20Status','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','PARTY','cogni-living','notifyPushoverRecipient','toLowerCase','abortExitTimer','analysisHistory','value.humidity','System\x20Mode','loadSystemMode','deviationFromBaseline','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','.NextHours.Location_1.Day_1.current.symbol_desc','setPresence','griff','setupDriftAnalysisScheduler','Daily\x20Digests','‚ö†Ô∏è\x20Alarm','testNotification','bad','.Summary.Current','colormode','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','cogni-living\x20adapter\x20starting\x20(v','getEnums','236790LeyvJt','loadRawEventLog','garten','\x20sent','0\x204\x20*\x20*\x20*','Briefing\x20Error:\x20','analysis.isEmergency','Error\x20initHistory:\x20','events.history_debug_01','send','N/A','loadDailyDigests','WETTER:\x20Keine\x20Daten','ALARM','testApiKey','analysis.health.restlessness','notifyTelegramEnabled','sensor.motion','includes','System\x20Status\x20&\x20Control','ready','2944735UwbNWT','\x0a\x0aA\x20(STB):\x0a','createDailyDigest','connection','modeResetJob','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','OPERATING_VOLTAGE','\x20raw\x20events...','\x20(EMERGENCY)','getForeignStateAsync','isGracePeriodActive','notifySignalEnabled','toString','Bewegung','unshift','push','32tnuYqb','analysis.history_debug_00','boolean','useCalendar','runBaselineDriftAnalysis','object','K√ºche','triggerDailyDigest','Briefing\x20Sched\x20Error:\x20','some','isProVersion','weatherunderground.','getForeignObjectAsync','generic','loadRawEventLog\x20failed:\x20','icons-mfd.','expire','LTM.dailyDigests','getCalendarNames','status','onStateChange','LTM.driftAnalysis','setupLtmScheduler','SABOTAGE','exitGraceTimer','events.history_debug_04','inactivityMonitoringEnabled','uuid','Wohnzimmer','state','/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20','version','baselineDrift','Baseline:\x20Inactive\x20(Pro\x20Feature).','info','briefingJob','_calName','generateContent','checkWifiPresence','systemConfig','weatherInstance','presenceDevices','weather','COMBINED_PARAMETER','getGenerativeModel','inactivityThresholdHours','notifyWhatsappRecipient','parse','driftAnalysisTimer','namespace','CONFIG_PENDING','useWeather','error','history.','NORMAL','instance','Gemini\x20Init\x20Error:\x20','node-schedule','LTM','suggestion','2-digit','scheduleJob','analysis.trigger','briefingEnabled','Starting\x20Autopilot\x20(','stringify','notifyWhatsappInstance','string','isArray','Fenster/T√ºr','toFixed','KALENDER\x20ERROR:\x20','uniqueid','Adapter','getForeignObjectsAsync','currentSystemMode','getSystemUUID','ack','signal','openweathermap.','icon','schlaf','LTM.triggerDailyDigest','accuweather.0','update','de-DE','analysis.alertReason','INSTALL_TEST','motion','latitude','productname','Badezimmer','location','LTM.driftAnalysis.driftDetails','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','analysis.health.notes','type','system.config','openweathermap.0','enum','fire','Kalender:\x20Deaktiviert','command','No\x20Key','accuweather','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','Gast','effect','join','LTM.baselineStatus','Analysis\x20Error:\x20','Drift\x20Details','members','\x20|\x20','setupModeResetScheduler','.forecast.current.state','notifySignalRecipient','Raw\x20Log','openweathermap','üö®üö®\x20NOTFALL','Morning\x20Briefing\x20sent.','getWeatherContext','notifyPushoverInstance','\x0aFEEDBACK:\x0a','üåÖ\x20Daily\x20Briefing:\x0a','automationProposal','77808gLehRH','isAlert','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','exitTimer','activityLevel','subscribeForeignStatesAsync','events.lastEvent','runGeminiAnalysis','models/gemini-flash-latest','system.','ltmJob','processSensorEvent','getCalendarNames\x20Error:\x20','length','pr√§senz','daswetter','rawEventLog','sort','analysis.history_debug_04','date','analysis.history_debug_01','vis.','log','Garten','setStateAsync','number','notifyEmailEnabled','none','Drift\x20Sched\x20Error:\x20','temperatur','search','\x22\x20was\x20','switch.light','.\x20PR√ÑSENZ:\x20','geminiModel','retry','KALENDER:\x20Keine\x20relevanten\x20Termine','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','WETTER:\x20','split','notifyPushoverEnabled','unknown','apply','analysis.health.sleepScore','presence','saveRawEventLog','process','analysis.deviationFromBaseline','slice'];a0_0x13f7=function(){return _0xbf8463;};return a0_0x13f7();}class CogniLiving extends utils[a0_0x32bd87(0x1c0)]{constructor(_0x582ec2){const _0x5e294a=a0_0x32bd87;super({..._0x582ec2,'name':_0x5e294a(0x314)}),this[_0x5e294a(0x28b)]=[],this['analysisHistory']=[],this[_0x5e294a(0x270)]=[],this['rawEventLog']=[],this[_0x5e294a(0x282)]=[],this['sensorLastValues']={},this[_0x5e294a(0x19e)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x5e294a(0x237)]=!![],this['exitTimer']=null,this[_0x5e294a(0x18f)]=null,this[_0x5e294a(0x171)]=![],this[_0x5e294a(0x2f7)]=null,this[_0x5e294a(0x217)]=null,this[_0x5e294a(0x1c2)]=SYSTEM_MODES[_0x5e294a(0x1ad)],this[_0x5e294a(0x181)]=![],this['lastAlertState']=![],this['systemUUID']=_0x5e294a(0x21e),this[_0x5e294a(0x295)]=null,this['ltmJob']=null,this[_0x5e294a(0x16b)]=null,this[_0x5e294a(0x1a7)]=null,this[_0x5e294a(0x19a)]=null,this[_0x5e294a(0x2e9)]=this['onReady'][_0x5e294a(0x296)](this),this[_0x5e294a(0x18b)]=this[_0x5e294a(0x18b)]['bind'](this),this[_0x5e294a(0x26c)]=this[_0x5e294a(0x26c)]['bind'](this),this[_0x5e294a(0x275)]=this[_0x5e294a(0x275)][_0x5e294a(0x296)](this),this['runAutopilot']=this['runAutopilot']['bind'](this),this['runBaselineDriftAnalysis']=this[_0x5e294a(0x17b)][_0x5e294a(0x296)](this),this[_0x5e294a(0x2fe)]=this['sendMorningBriefing'][_0x5e294a(0x296)](this),this[_0x5e294a(0x169)]=this[_0x5e294a(0x169)][_0x5e294a(0x296)](this),this['on'](_0x5e294a(0x33f),this['onReady']),this['on'](_0x5e294a(0x26d),this[_0x5e294a(0x18b)]),this['on']('unload',this[_0x5e294a(0x26c)]),this['on'](_0x5e294a(0x228),this[_0x5e294a(0x275)]);}async[a0_0x32bd87(0x2e9)](){const _0x2c0452=a0_0x32bd87;this[_0x2c0452(0x20b)]['info'](_0x2c0452(0x329)+this['version']+')');try{const _0x18fd63=[_0x2c0452(0x178),_0x2c0452(0x209),'analysis.history_debug_02','analysis.history_debug_03',_0x2c0452(0x207),_0x2c0452(0x28e),_0x2c0452(0x333),'events.history_debug_02',_0x2c0452(0x22a),_0x2c0452(0x190)];for(const _0x5cc713 of _0x18fd63){try{const _0x4f8516=await this['getObjectAsync'](_0x5cc713);_0x4f8516&&await this[_0x2c0452(0x2a2)](_0x5cc713);}catch(_0x2a0559){}}}catch(_0x47e645){}this['config']['licenseKey']=this[_0x2c0452(0x235)]['licenseKey']||'';try{this[_0x2c0452(0x181)]=await this[_0x2c0452(0x27b)](this[_0x2c0452(0x235)][_0x2c0452(0x2b7)]);}catch(_0x547f46){this['log'][_0x2c0452(0x1ab)]('License\x20Check\x20failed:\x20'+_0x547f46[_0x2c0452(0x228)]);}if(!this['config'][_0x2c0452(0x1a4)]||this[_0x2c0452(0x235)][_0x2c0452(0x1a4)]<0.1)this[_0x2c0452(0x235)][_0x2c0452(0x1a4)]=0xc;try{await this['initHistory']();}catch(_0x4b3f12){this[_0x2c0452(0x20b)][_0x2c0452(0x1ab)](_0x2c0452(0x332)+_0x4b3f12[_0x2c0452(0x228)]);}try{const _0x5dc39f=await this[_0x2c0452(0x183)](_0x2c0452(0x1d8));_0x5dc39f&&_0x5dc39f[_0x2c0452(0x2ba)]&&(this[_0x2c0452(0x19e)]={'latitude':_0x5dc39f[_0x2c0452(0x2ba)][_0x2c0452(0x1d0)]||0x0,'longitude':_0x5dc39f[_0x2c0452(0x2ba)][_0x2c0452(0x230)]||0x0,'city':_0x5dc39f['common'][_0x2c0452(0x26e)]||''});}catch(_0x2d7f96){}if(this[_0x2c0452(0x235)][_0x2c0452(0x28f)])try{this[_0x2c0452(0x2f7)]=new GoogleGenerativeAI(this['config'][_0x2c0452(0x28f)]),this['geminiModel']=this[_0x2c0452(0x2f7)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x2c0452(0x20b)][_0x2c0452(0x199)](_0x2c0452(0x2e2));}catch(_0x526fdd){this[_0x2c0452(0x20b)][_0x2c0452(0x1ab)](_0x2c0452(0x1af)+_0x526fdd[_0x2c0452(0x228)]);}try{await this[_0x2c0452(0x254)]();}catch(_0x16e114){this[_0x2c0452(0x20b)][_0x2c0452(0x1ab)](_0x2c0452(0x2d0)+_0x16e114[_0x2c0452(0x228)]);}try{await this[_0x2c0452(0x31b)]();}catch(_0x5903b9){this[_0x2c0452(0x20b)]['error'](_0x2c0452(0x24a)+_0x5903b9[_0x2c0452(0x228)]);}try{await this[_0x2c0452(0x32c)]();}catch(_0x52f023){this[_0x2c0452(0x20b)][_0x2c0452(0x1ab)](_0x2c0452(0x185)+_0x52f023['message']);}try{await this[_0x2c0452(0x336)]();}catch(_0x5b168a){this[_0x2c0452(0x20b)][_0x2c0452(0x1ab)]('loadDailyDigests\x20failed:\x20'+_0x5b168a[_0x2c0452(0x228)]);}this[_0x2c0452(0x243)](_0x2c0452(0x1b5)),this[_0x2c0452(0x243)](LTM_DP_TRIGGER_DIGEST),this[_0x2c0452(0x243)](_0x2c0452(0x24f)),this[_0x2c0452(0x243)]('analysis.triggerBriefing');const _0x5215d1=this[_0x2c0452(0x235)][_0x2c0452(0x23a)];if(_0x5215d1&&_0x5215d1['length']>0x0){this['log'][_0x2c0452(0x199)]('Subscribing\x20to\x20'+_0x5215d1[_0x2c0452(0x202)]+_0x2c0452(0x25a));for(const _0x45ade7 of _0x5215d1){if(_0x45ade7['id']){await this['subscribeForeignStatesAsync'](_0x45ade7['id']);try{const _0x227394=await this[_0x2c0452(0x170)](_0x45ade7['id']);if(_0x227394)this['sensorLastValues'][_0x45ade7['id']]=_0x227394[_0x2c0452(0x2da)];}catch(_0x2dd1f9){}}}}const _0x152001=this[_0x2c0452(0x235)][_0x2c0452(0x1a0)]||[];if(_0x152001[_0x2c0452(0x202)]>0x0){this[_0x2c0452(0x20b)]['info'](_0x2c0452(0x2c3)+_0x152001[_0x2c0452(0x202)]+'\x20presence\x20devices...');for(const _0x74b182 of _0x152001){await this[_0x2c0452(0x1fa)](_0x74b182);}try{await this[_0x2c0452(0x19d)]();}catch(_0x2883c0){}}if(this['analysisTimer'])clearInterval(this[_0x2c0452(0x295)]);const _0x4a2cf0=this[_0x2c0452(0x235)][_0x2c0452(0x2d2)]||0xf;_0x4a2cf0>0x0&&(this[_0x2c0452(0x20b)][_0x2c0452(0x199)](_0x2c0452(0x1b7)+_0x4a2cf0+'\x20min).\x20Watchdog\x20Limit:\x20'+this[_0x2c0452(0x235)][_0x2c0452(0x1a4)]+'h.'),this['analysisTimer']=setInterval(this['runAutopilot'],_0x4a2cf0*0x3c*0x3e8)),this['setupLtmScheduler'](),this[_0x2c0452(0x1e9)](),this[_0x2c0452(0x321)](),this[_0x2c0452(0x310)]();}['onUnload'](_0x936d3){const _0x22a529=a0_0x32bd87;if(this['analysisTimer'])clearInterval(this['analysisTimer']);if(this[_0x22a529(0x1a7)])clearInterval(this[_0x22a529(0x1a7)]);if(this['ltmJob'])this[_0x22a529(0x1ff)][_0x22a529(0x2e8)]();if(this[_0x22a529(0x16b)])this['modeResetJob'][_0x22a529(0x2e8)]();if(this['briefingJob'])this[_0x22a529(0x19a)]['cancel']();if(this[_0x22a529(0x1f8)])clearTimeout(this[_0x22a529(0x1f8)]);if(this['exitGraceTimer'])clearTimeout(this[_0x22a529(0x18f)]);_0x936d3();}async[a0_0x32bd87(0x18b)](_0x31a2a2,_0x27bb11){const _0x411a5a=a0_0x32bd87;if(!_0x27bb11)return;if(_0x31a2a2===this[_0x411a5a(0x1a8)]+'.'+SYSTEM_DP_MODE){_0x27bb11[_0x411a5a(0x2da)]&&Object[_0x411a5a(0x2bb)](SYSTEM_MODES)[_0x411a5a(0x33d)](_0x27bb11[_0x411a5a(0x2da)])&&(this['currentSystemMode']=_0x27bb11[_0x411a5a(0x2da)],_0x27bb11['val']===SYSTEM_MODES['VACATION']?this[_0x411a5a(0x31f)](![]):this[_0x411a5a(0x31f)](!![]));if(!_0x27bb11[_0x411a5a(0x1c4)])this[_0x411a5a(0x2b3)](_0x31a2a2,{'val':this[_0x411a5a(0x1c2)],'ack':!![]});return;}if(!_0x27bb11[_0x411a5a(0x1c4)]){_0x31a2a2['includes'](_0x411a5a(0x1b5))&&_0x27bb11[_0x411a5a(0x2da)]&&(this['setState'](_0x31a2a2,{'val':![],'ack':!![]}),this[_0x411a5a(0x1fc)]());if(_0x31a2a2[_0x411a5a(0x33d)](_0x411a5a(0x17e))&&_0x27bb11['val']){this[_0x411a5a(0x2b3)](_0x31a2a2,{'val':![],'ack':!![]});if(this[_0x411a5a(0x181)])this[_0x411a5a(0x169)]();}_0x31a2a2[_0x411a5a(0x33d)]('triggerBriefing')&&_0x27bb11['val']&&(this[_0x411a5a(0x2b3)](_0x31a2a2,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this[_0x411a5a(0x235)][_0x411a5a(0x1a0)]&&this[_0x411a5a(0x235)][_0x411a5a(0x1a0)][_0x411a5a(0x33d)](_0x31a2a2)){await this[_0x411a5a(0x19d)]();return;}const _0x213d0b=(this[_0x411a5a(0x235)][_0x411a5a(0x23a)]||[])[_0x411a5a(0x2b9)](_0x1008ab=>_0x1008ab['id']===_0x31a2a2);if(_0x213d0b)this['processSensorEvent'](_0x31a2a2,_0x27bb11,_0x213d0b);}async[a0_0x32bd87(0x275)](_0x110291){const _0x4c364a=a0_0x32bd87;if(typeof _0x110291===_0x4c364a(0x17c)&&_0x110291['message'])try{if(_0x110291[_0x4c364a(0x1dd)]===_0x4c364a(0x339)){if(!_0x110291['message'][_0x4c364a(0x2c1)])return this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291['command'],{'success':![],'message':_0x4c364a(0x1de)},_0x110291[_0x4c364a(0x285)]);try{const _0x108dcf=new GoogleGenerativeAI(_0x110291[_0x4c364a(0x228)][_0x4c364a(0x2c1)])[_0x4c364a(0x1a3)]({'model':_0x4c364a(0x1fd)});await _0x108dcf[_0x4c364a(0x19c)](_0x4c364a(0x2c2)),this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291[_0x4c364a(0x1dd)],{'success':!![],'message':'Success'},_0x110291[_0x4c364a(0x285)]);}catch(_0x190ba9){this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291[_0x4c364a(0x1dd)],{'success':![],'message':_0x190ba9['message']},_0x110291[_0x4c364a(0x285)]);}}else{if(_0x110291[_0x4c364a(0x1dd)]===_0x4c364a(0x324)){const _0x1a8e97=await this[_0x4c364a(0x266)](_0x4c364a(0x283),!![]);this['sendTo'](_0x110291[_0x4c364a(0x2c4)],_0x110291[_0x4c364a(0x1dd)],{'success':_0x1a8e97>0x0,'message':_0x1a8e97+_0x4c364a(0x32e)},_0x110291['callback']);}else{if(_0x110291['command']==='getLtmData'){if(!this[_0x4c364a(0x181)])return this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291['command'],{'success':![],'isPro':![]},_0x110291[_0x4c364a(0x285)]);let _0x4b6062={'status':_0x4c364a(0x335),'details':'','lastCheck':0x0};try{_0x4b6062[_0x4c364a(0x18a)]=(await this[_0x4c364a(0x25b)](LTM_DP_DRIFT_STATUS))['val'],_0x4b6062[_0x4c364a(0x30b)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))['val'],_0x4b6062[_0x4c364a(0x276)]=(await this[_0x4c364a(0x25b)](LTM_DP_DRIFT_LAST_CHECK))[_0x4c364a(0x2da)];}catch(_0x54f020){}this['sendTo'](_0x110291[_0x4c364a(0x2c4)],_0x110291[_0x4c364a(0x1dd)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x4b6062,'analysisHistory':this[_0x4c364a(0x318)]},_0x110291[_0x4c364a(0x285)]);}else{if(_0x110291[_0x4c364a(0x1dd)]===_0x4c364a(0x32a)){const _0x1fa580=await this[_0x4c364a(0x1c1)]('enum.functions.*',_0x4c364a(0x1da)),_0x4023b2=[];if(_0x1fa580)for(const _0x1106af in _0x1fa580){const _0x58502e=_0x1fa580[_0x1106af],_0x3d7074=(_0x58502e[_0x4c364a(0x2ba)]&&typeof _0x58502e['common'][_0x4c364a(0x30a)]==='object'?_0x58502e[_0x4c364a(0x2ba)][_0x4c364a(0x30a)]['de']:_0x58502e[_0x4c364a(0x2ba)][_0x4c364a(0x30a)])||_0x58502e[_0x4c364a(0x2ba)][_0x4c364a(0x30a)];_0x4023b2[_0x4c364a(0x176)]({'id':_0x1106af,'name':_0x3d7074});}this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291['command'],{'success':!![],'enums':_0x4023b2},_0x110291['callback']);}else{if(_0x110291[_0x4c364a(0x1dd)]===_0x4c364a(0x274))try{const _0x44f1df=await this[_0x4c364a(0x309)](_0x110291['message']||{});this['sendTo'](_0x110291[_0x4c364a(0x2c4)],_0x110291['command'],{'success':!![],'devices':_0x44f1df},_0x110291[_0x4c364a(0x285)]);}catch(_0x368f3b){this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291[_0x4c364a(0x1dd)],{'success':![],'error':_0x368f3b['message']},_0x110291['callback']);}else{if(_0x110291[_0x4c364a(0x1dd)]===_0x4c364a(0x2e6)){const {historyId:_0x346347,rating:_0x4cce3c,comment:_0x4a27e9,alertReason:_0x3f6791}=_0x110291[_0x4c364a(0x228)];_0x346347&&_0x4cce3c?(await this['saveFeedback']({'timestamp':Date['now'](),'historyId':_0x346347,'rating':_0x4cce3c,'comment':_0x4a27e9,'alertReason':_0x3f6791}),this['sendTo'](_0x110291['from'],_0x110291[_0x4c364a(0x1dd)],{'success':!![]},_0x110291['callback'])):this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291['command'],{'success':![],'error':'Missing\x20data'},_0x110291[_0x4c364a(0x285)]);}else{if(_0x110291[_0x4c364a(0x1dd)]===_0x4c364a(0x29a)){const _0x386283=await this[_0x4c364a(0x1f0)](),_0x2a2311=await this[_0x4c364a(0x2de)]();this[_0x4c364a(0x2b5)](_0x110291['from'],_0x110291['command'],{'success':!![],'weather':_0x386283,'calendar':_0x2a2311},_0x110291[_0x4c364a(0x285)]);}else{if(_0x110291[_0x4c364a(0x1dd)]===_0x4c364a(0x189)){const _0x2caabc=_0x110291[_0x4c364a(0x228)][_0x4c364a(0x1ae)];if(!_0x2caabc)return this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291[_0x4c364a(0x1dd)],{'success':![],'error':_0x4c364a(0x23d)},_0x110291[_0x4c364a(0x285)]);const _0x588205=await this[_0x4c364a(0x189)](_0x2caabc);this[_0x4c364a(0x2b5)](_0x110291['from'],_0x110291[_0x4c364a(0x1dd)],{'success':!![],'names':_0x588205},_0x110291[_0x4c364a(0x285)]);}}}}}}}}}catch(_0x4ba7e2){if(_0x110291[_0x4c364a(0x285)])this[_0x4c364a(0x2b5)](_0x110291[_0x4c364a(0x2c4)],_0x110291['command'],{'success':![],'error':_0x4ba7e2[_0x4c364a(0x228)]},_0x110291[_0x4c364a(0x285)]);}}async[a0_0x32bd87(0x200)](_0x568750,_0x72b6e7,_0x397b35){const _0x32c902=a0_0x32bd87;if(!_0x397b35['logDuplicates']&&this['sensorLastValues'][_0x568750]===_0x72b6e7['val'])return;this[_0x32c902(0x277)][_0x568750]=_0x72b6e7[_0x32c902(0x2da)];if(this[_0x32c902(0x171)])return;const _0xe5e572=await this[_0x32c902(0x19d)]();if(_0xe5e572){if(!this[_0x32c902(0x237)])this[_0x32c902(0x31f)](!![]);}else{const _0x24cf24=_0x397b35[_0x32c902(0x248)]===!![];_0x24cf24?this[_0x32c902(0x238)]():(this['exitTimer']&&(this[_0x32c902(0x20b)][_0x32c902(0x199)](_0x32c902(0x21a)),this[_0x32c902(0x317)]()),!this['isPresent']&&this[_0x32c902(0x1c2)]===SYSTEM_MODES[_0x32c902(0x1ad)]&&this[_0x32c902(0x31f)](!![]));}const _0x3bc755={'timestamp':_0x72b6e7['ts'],'id':_0x568750,'name':_0x397b35[_0x32c902(0x30a)],'value':_0x72b6e7['val'],'location':_0x397b35['location'],'type':_0x397b35['type']};this[_0x32c902(0x28b)][_0x32c902(0x175)](_0x3bc755);if(this[_0x32c902(0x28b)][_0x32c902(0x202)]>HISTORY_MAX_SIZE)this[_0x32c902(0x28b)][_0x32c902(0x22b)]();await this[_0x32c902(0x20d)](_0x32c902(0x1fb),{'val':JSON[_0x32c902(0x1b8)](_0x3bc755),'ack':!![]}),await this[_0x32c902(0x20d)](_0x32c902(0x24d),{'val':JSON[_0x32c902(0x1b8)](this['eventHistory']),'ack':!![]}),this['rawEventLog'][_0x32c902(0x176)]({'timestamp':new Date(_0x72b6e7['ts'])[_0x32c902(0x2cb)](),'sensorName':_0x397b35[_0x32c902(0x30a)],'location':_0x397b35[_0x32c902(0x1d3)],'value':_0x72b6e7['val']}),await this['saveRawEventLog']();}async['runAutopilot'](){const _0x368d1d=a0_0x32bd87,_0x9d7c79=this[_0x368d1d(0x235)][_0x368d1d(0x1a4)],_0x30d6f1=this[_0x368d1d(0x235)][_0x368d1d(0x191)],_0x37ed0e=this['eventHistory'][_0x368d1d(0x202)]>0x0?this[_0x368d1d(0x28b)][0x0]['timestamp']:Date[_0x368d1d(0x2aa)](),_0x267f29=(Date[_0x368d1d(0x2aa)]()-_0x37ed0e)/(0x3e8*0x3c*0x3c);let _0x480b99='';_0x30d6f1&&this[_0x368d1d(0x1c2)]===SYSTEM_MODES['NORMAL']&&this[_0x368d1d(0x237)]&&(_0x267f29>_0x9d7c79&&(_0x480b99=_0x368d1d(0x301)+_0x267f29[_0x368d1d(0x1bd)](0x1)+_0x368d1d(0x312)));if(_0x480b99){this[_0x368d1d(0x1fc)](_0x480b99)[_0x368d1d(0x2e4)](_0x5624fe=>this[_0x368d1d(0x20b)][_0x368d1d(0x1ab)](_0x5624fe));return;}const _0x3fa769=Date[_0x368d1d(0x2aa)](),_0x4d1d13=_0x3fa769-_0x37ed0e,_0x5a312d=(this[_0x368d1d(0x235)]['analysisInterval']||0xf)*0x3c*0x3e8;this[_0x368d1d(0x28b)][_0x368d1d(0x202)]>0x0&&_0x4d1d13<=_0x5a312d?this['runGeminiAnalysis']()[_0x368d1d(0x2e4)](_0x3087d4=>this[_0x368d1d(0x20b)][_0x368d1d(0x1ab)](_0x3087d4)):!this[_0x368d1d(0x2c0)]&&(this[_0x368d1d(0x2b3)]('analysis.isAlert',{'val':![],'ack':!![]}),this['setState'](_0x368d1d(0x331),{'val':![],'ack':!![]}));}async[a0_0x32bd87(0x1fc)](_0x45073f=''){const _0x412e4e=a0_0x32bd87;if(!this[_0x412e4e(0x217)])return;const _0x5cfaed=this[_0x412e4e(0x28b)][_0x412e4e(0x202)]>0x0?this[_0x412e4e(0x28b)]:[{'note':_0x412e4e(0x2fd)}],_0x5e3329=PERSONA_MAPPING[this[_0x412e4e(0x235)]['aiPersona']||_0x412e4e(0x184)],_0x5a1fd6=this['config'][_0x412e4e(0x272)]||'',_0x251427=this[_0x412e4e(0x1c2)],_0x235ba8=await this[_0x412e4e(0x1f0)](),_0x5f3bcb=await this['getCalendarContext'](),_0x6b15a7=(_0x235ba8+'\x20'+_0x5f3bcb)[_0x412e4e(0x2b4)](),_0x47ebcb=new Date(),_0x3c1995=_0x47ebcb['toLocaleString'](_0x412e4e(0x1cc),{'weekday':'long','hour':'2-digit','minute':_0x412e4e(0x1b3)}),_0x8e90dd=this[_0x412e4e(0x19e)];let _0x2bdea6='';if(this[_0x412e4e(0x270)][_0x412e4e(0x202)]>0x0){const _0x1ebc14=this[_0x412e4e(0x270)][_0x412e4e(0x225)](0x0,0x3)['map'](_0xd3610=>_0x412e4e(0x2c5)+_0xd3610[_0x412e4e(0x239)]+_0x412e4e(0x214)+_0xd3610['rating']+'.')['join']('\x0a');_0x2bdea6=_0x412e4e(0x1f2)+_0x1ebc14+'\x0a';}const _0x2d543b=_0x45073f?_0x412e4e(0x280)+_0x45073f+_0x412e4e(0x231):'',_0x441066=_0x412e4e(0x198),_0x421a81=_0x412e4e(0x303)+_0x3c1995+'.\x20ORT:\x20'+_0x8e90dd[_0x412e4e(0x26e)]+_0x412e4e(0x30c)+_0x251427+_0x412e4e(0x216)+(this[_0x412e4e(0x237)]?'Ja':_0x412e4e(0x263))+'.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20'+_0x5a1fd6+_0x412e4e(0x2eb)+_0x5e3329+_0x412e4e(0x1e0)+_0x6b15a7+_0x412e4e(0x26a)+_0x441066+'\x20'+_0x2bdea6+'\x20'+_0x2d543b+_0x412e4e(0x2ff)+JSON[_0x412e4e(0x1b8)](_0x5cfaed)+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}';try{const _0x1a76d9=await this[_0x412e4e(0x217)][_0x412e4e(0x19c)](_0x421a81),_0x5d048c=_0x1a76d9['response'][_0x412e4e(0x281)]()[_0x412e4e(0x2df)](/```json|```/g,'')[_0x412e4e(0x2b4)](),_0x3fdb70=JSON[_0x412e4e(0x1a6)](_0x5d048c);await this[_0x412e4e(0x20d)](_0x412e4e(0x26f),{'val':_0x5d048c,'ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x1cd),{'val':_0x3fdb70[_0x412e4e(0x29d)][_0x412e4e(0x239)]||'','ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x2a0),{'val':_0x3fdb70[_0x412e4e(0x29d)][_0x412e4e(0x27d)]||_0x412e4e(0x335),'ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x224),{'val':_0x3fdb70[_0x412e4e(0x29d)][_0x412e4e(0x31c)]||'N/A','ack':!![]});_0x3fdb70[_0x412e4e(0x269)]&&(await this[_0x412e4e(0x20d)](_0x412e4e(0x249),{'val':_0x3fdb70[_0x412e4e(0x269)][_0x412e4e(0x27d)]||'','ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x2a3),{'val':_0x3fdb70[_0x412e4e(0x269)][_0x412e4e(0x1b2)]||'','ack':!![]}),_0x3fdb70[_0x412e4e(0x269)][_0x412e4e(0x1f4)]&&(await this[_0x412e4e(0x20d)](_0x412e4e(0x2cc),{'val':_0x3fdb70[_0x412e4e(0x269)][_0x412e4e(0x1f4)][_0x412e4e(0x286)]||![],'ack':!![]}),await this['setStateAsync'](_0x412e4e(0x298),{'val':_0x3fdb70[_0x412e4e(0x269)][_0x412e4e(0x1f4)][_0x412e4e(0x2e7)]||'','ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x251),{'val':_0x3fdb70[_0x412e4e(0x269)]['automationProposal']['suggestedAction']||'','ack':!![]})));_0x3fdb70[_0x412e4e(0x2a1)]&&(await this[_0x412e4e(0x20d)](_0x412e4e(0x220),{'val':typeof _0x3fdb70[_0x412e4e(0x2a1)][_0x412e4e(0x2d4)]===_0x412e4e(0x20e)?_0x3fdb70[_0x412e4e(0x2a1)][_0x412e4e(0x2d4)]:0x0,'ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x33a),{'val':_0x3fdb70[_0x412e4e(0x2a1)][_0x412e4e(0x2f1)]||_0x412e4e(0x210),'ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x1d6),{'val':_0x3fdb70[_0x412e4e(0x2a1)]['notes']||'','ack':!![]}));const _0x11949f=_0x3fdb70[_0x412e4e(0x29d)][_0x412e4e(0x1f6)]||![],_0x24b321=_0x3fdb70[_0x412e4e(0x29d)]['isEmergency']||![];if(_0x11949f||_0x24b321){await this[_0x412e4e(0x20d)]('analysis.isAlert',{'val':!![],'ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x331),{'val':_0x24b321,'ack':!![]});if(!this['lastAlertState']||_0x24b321){const _0x4b30fa=_0x24b321?_0x412e4e(0x1ee):_0x412e4e(0x323);this[_0x412e4e(0x266)](_0x4b30fa+':\x20'+_0x3fdb70[_0x412e4e(0x29d)]['alertReason'],![],_0x24b321);}}else await this[_0x412e4e(0x20d)](_0x412e4e(0x2ae),{'val':![],'ack':!![]}),await this[_0x412e4e(0x20d)](_0x412e4e(0x331),{'val':![],'ack':!![]});this[_0x412e4e(0x2c0)]=_0x11949f||_0x24b321;const _0x45f595={'timestamp':Date['now'](),'id':Date[_0x412e4e(0x2aa)]()[_0x412e4e(0x173)](),'analysis':_0x3fdb70,'systemMode':_0x251427,'isPro':this[_0x412e4e(0x181)]};this['updateAnalysisHistory'](_0x45f595);}catch(_0x46fe76){this[_0x412e4e(0x20b)][_0x412e4e(0x1ab)](_0x412e4e(0x1e5)+_0x46fe76['message']);}}async['createDailyDigest'](){const _0x404bb8=a0_0x32bd87;if(!this['geminiModel']||this[_0x404bb8(0x205)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x404bb8(0x20d)](LTM_DP_STATUS,{'val':_0x404bb8(0x16c),'ack':!![]});return;}this[_0x404bb8(0x20b)][_0x404bb8(0x199)]('Creating\x20Daily\x20Digest\x20from\x20'+this[_0x404bb8(0x205)][_0x404bb8(0x202)]+_0x404bb8(0x16e)),await this['setStateAsync'](LTM_DP_STATUS,{'val':'Analysiere\x20Tag...','ack':!![]});const _0x2162ff=this[_0x404bb8(0x205)][_0x404bb8(0x202)]>0x320?this[_0x404bb8(0x205)][_0x404bb8(0x225)](this['rawEventLog']['length']-0x320):this[_0x404bb8(0x205)],_0x48fd32=PERSONA_MAPPING[this[_0x404bb8(0x235)][_0x404bb8(0x25f)]||'generic'],_0x2429db=_0x404bb8(0x328)+_0x48fd32+_0x404bb8(0x31d)+JSON[_0x404bb8(0x1b8)](_0x2162ff)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}';try{const _0x552037=await this[_0x404bb8(0x217)][_0x404bb8(0x19c)](_0x2429db),_0x46f17a=_0x552037[_0x404bb8(0x2f3)][_0x404bb8(0x281)]()[_0x404bb8(0x2df)](/```json|```/g,'')[_0x404bb8(0x2b4)](),_0x42eeaa=JSON[_0x404bb8(0x1a6)](_0x46f17a),_0x367304={'timestamp':new Date()[_0x404bb8(0x2cb)](),'eventCount':this[_0x404bb8(0x205)][_0x404bb8(0x202)],'summary':_0x42eeaa[_0x404bb8(0x27d)],'activityLevel':_0x42eeaa[_0x404bb8(0x1f9)],'health':{'sleepScore':_0x42eeaa['health']?_0x42eeaa[_0x404bb8(0x2a1)][_0x404bb8(0x2d4)]:0x0,'restlessness':_0x42eeaa['health']?_0x42eeaa[_0x404bb8(0x2a1)][_0x404bb8(0x2f1)]:'none'},'systemMode':this[_0x404bb8(0x1c2)]};this[_0x404bb8(0x282)][_0x404bb8(0x176)](_0x367304),await this[_0x404bb8(0x23f)](),this[_0x404bb8(0x205)]=[],await this[_0x404bb8(0x222)](),await this[_0x404bb8(0x20d)](LTM_DP_STATUS,{'val':_0x404bb8(0x2a9),'ack':!![]}),this[_0x404bb8(0x20b)]['info'](_0x404bb8(0x24c));}catch(_0x35bc4f){this['log']['error']('Daily\x20Digest\x20Error:\x20'+_0x35bc4f[_0x404bb8(0x228)]),await this[_0x404bb8(0x20d)](LTM_DP_STATUS,{'val':_0x404bb8(0x271)+_0x35bc4f[_0x404bb8(0x228)],'ack':!![]});}}async['sendMorningBriefing'](){const _0x241750=a0_0x32bd87;if(!this[_0x241750(0x217)])return;this['log']['info'](_0x241750(0x22f));const _0xbe1d86=this[_0x241750(0x282)][_0x241750(0x202)]>0x0?this[_0x241750(0x282)][this[_0x241750(0x282)][_0x241750(0x202)]-0x1]:null,_0x2d439c=_0xbe1d86&&_0xbe1d86[_0x241750(0x2a1)]?_0xbe1d86[_0x241750(0x2a1)][_0x241750(0x2d4)]:_0x241750(0x335),_0x5355a6=new Date();_0x5355a6[_0x241750(0x299)](0x4,0x0,0x0,0x0);const _0x12789d=this[_0x241750(0x28b)]['filter'](_0x1085f6=>new Date(_0x1085f6['timestamp'])>_0x5355a6),_0x189ddc=PERSONA_MAPPING[this[_0x241750(0x235)][_0x241750(0x25f)]||_0x241750(0x184)],_0x4b1d49=this[_0x241750(0x235)][_0x241750(0x272)]||'',_0x5bff82=await this['getWeatherContext'](),_0x418e52=await this[_0x241750(0x2de)](),_0x318fe2=_0x241750(0x265)+_0x189ddc+_0x241750(0x2d3)+_0x4b1d49+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20'+_0x5bff82+'\x20'+_0x418e52+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20'+_0x2d439c+_0x241750(0x195)+JSON[_0x241750(0x1b8)](_0x12789d[_0x241750(0x225)](0x0,0xa))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.';try{const _0x2ed82e=await this[_0x241750(0x217)][_0x241750(0x19c)](_0x318fe2),_0x53feff=_0x241750(0x1f3)+_0x2ed82e[_0x241750(0x2f3)]['text']()['trim']();this[_0x241750(0x266)](_0x53feff),this[_0x241750(0x20b)]['info'](_0x241750(0x1ef));}catch(_0x471435){this[_0x241750(0x20b)][_0x241750(0x1ab)](_0x241750(0x330)+_0x471435['message']);}}['tryParse'](_0x4d8437){const _0x3efd64=a0_0x32bd87;if(typeof _0x4d8437===_0x3efd64(0x17c))return _0x4d8437;try{return JSON['parse'](_0x4d8437);}catch(_0x4081c5){return null;}}async[a0_0x32bd87(0x1f0)](){const _0x45c859=a0_0x32bd87;try{if(!this[_0x45c859(0x235)][_0x45c859(0x1aa)])return _0x45c859(0x227);let _0x41659a='';const _0x9771f0=this['config'][_0x45c859(0x19f)];if(_0x9771f0)try{if(_0x9771f0[_0x45c859(0x33d)]('accuweather')){const _0x338f22=await this['getForeignStateAsync'](_0x9771f0+_0x45c859(0x326));if(_0x338f22&&_0x338f22[_0x45c859(0x2da)])_0x41659a=_0x338f22[_0x45c859(0x2da)];}else{if(_0x9771f0['includes'](_0x45c859(0x204))){const _0x46b7ee=await this['getForeignStateAsync'](_0x9771f0+_0x45c859(0x31e));if(_0x46b7ee&&_0x46b7ee[_0x45c859(0x2da)])_0x41659a=_0x46b7ee[_0x45c859(0x2da)];}else{if(_0x9771f0['includes'](_0x45c859(0x1ed))){const _0x34f252=await this[_0x45c859(0x170)](_0x9771f0+_0x45c859(0x1ea));if(_0x34f252&&_0x34f252[_0x45c859(0x2da)])_0x41659a=_0x34f252[_0x45c859(0x2da)];}}}}catch(_0x3b2924){}if(!_0x41659a){const _0x2a09cd=[_0x45c859(0x1ca),_0x45c859(0x261),_0x45c859(0x28d),_0x45c859(0x1d9)];for(const _0x54f93a of _0x2a09cd){try{const _0x159baf=await this['getForeignObjectAsync'](_0x54f93a);if(_0x159baf){if(_0x54f93a[_0x45c859(0x33d)](_0x45c859(0x1df))){const _0x5d1daf=await this['getForeignStateAsync'](_0x54f93a+'.Summary.Current');if(_0x5d1daf&&_0x5d1daf[_0x45c859(0x2da)]){_0x41659a=_0x5d1daf['val'];break;}}}}catch(_0x15d746){}}}return _0x41659a?_0x45c859(0x21b)+_0x41659a:_0x45c859(0x337);}catch(_0x155af5){return'WETTER\x20ERROR:\x20'+_0x155af5['message'];}}async[a0_0x32bd87(0x2de)](){const _0x4c81e7=a0_0x32bd87;try{if(!this[_0x4c81e7(0x235)][_0x4c81e7(0x17a)])return _0x4c81e7(0x1dc);let _0x30479c=this['config']['calendarInstance']||_0x4c81e7(0x23e),_0x19f528=this[_0x4c81e7(0x235)][_0x4c81e7(0x2be)]||[];if(typeof _0x19f528===_0x4c81e7(0x1ba))_0x19f528=_0x19f528[_0x4c81e7(0x21c)](',');try{const _0x53de34=await this['getForeignStateAsync'](_0x30479c+_0x4c81e7(0x2dc));if(_0x53de34&&_0x53de34['val']){let _0x37c8cb=this[_0x4c81e7(0x2e3)](_0x53de34['val']);if(_0x37c8cb&&Array[_0x4c81e7(0x1bb)](_0x37c8cb)){if(_0x19f528[_0x4c81e7(0x202)]>0x0)_0x37c8cb=_0x37c8cb[_0x4c81e7(0x306)](_0x2d4f38=>_0x19f528['includes'](_0x2d4f38[_0x4c81e7(0x19b)]||''));else return _0x4c81e7(0x1f7);if(_0x37c8cb[_0x4c81e7(0x202)]>0x0){const _0x4e0db4=_0x37c8cb[_0x4c81e7(0x225)](0x0,0x3)['map'](_0x227197=>{const _0x18d70f=_0x4c81e7;let _0x52b0a5=_0x227197[_0x18d70f(0x208)];if(_0x227197[_0x18d70f(0x255)])_0x52b0a5+='\x20'+_0x227197['time'];return _0x52b0a5+':\x20'+_0x227197[_0x18d70f(0x246)]+'\x20('+_0x227197[_0x18d70f(0x19b)]+')';});return _0x4c81e7(0x2e5)+_0x4e0db4[_0x4c81e7(0x1e3)](_0x4c81e7(0x1e8));}else return _0x4c81e7(0x219);}}}catch(_0x336ad4){this['log']['warn'](_0x4c81e7(0x2bf)+_0x336ad4[_0x4c81e7(0x228)]);}return _0x4c81e7(0x25c);}catch(_0x2f5c02){return _0x4c81e7(0x1be)+_0x2f5c02['message'];}}async['getCalendarNames'](_0x3fc022){const _0x449030=a0_0x32bd87;try{const _0x34e90b=await this[_0x449030(0x170)](_0x3fc022+'.data.table');if(_0x34e90b&&_0x34e90b[_0x449030(0x2da)]){const _0x2857e7=this[_0x449030(0x2e3)](_0x34e90b[_0x449030(0x2da)]);if(_0x2857e7&&Array[_0x449030(0x1bb)](_0x2857e7)){const _0x531415=[...new Set(_0x2857e7[_0x449030(0x29c)](_0x38e383=>_0x38e383[_0x449030(0x19b)])[_0x449030(0x306)](Boolean))];return _0x531415['sort']();}}return[];}catch(_0x3245e7){return this[_0x449030(0x20b)][_0x449030(0x1ab)](_0x449030(0x201)+_0x3245e7[_0x449030(0x228)]),[];}}async[a0_0x32bd87(0x1c3)](){const _0x53e595=a0_0x32bd87;try{const _0x3a5ede=await this['getForeignObjectAsync'](_0x53e595(0x25e));if(_0x3a5ede&&_0x3a5ede[_0x53e595(0x2ee)]&&_0x3a5ede[_0x53e595(0x2ee)][_0x53e595(0x192)])return _0x3a5ede[_0x53e595(0x2ee)][_0x53e595(0x192)];return'uuid-not-found';}catch(_0x3d4e50){return'uuid-error';}}async[a0_0x32bd87(0x27b)](_0x1b0e3f){const _0x992376=a0_0x32bd87;if(!_0x1b0e3f)return![];this[_0x992376(0x2fa)]=await this[_0x992376(0x1c3)]();if(_0x1b0e3f===_0x992376(0x2d5)||_0x1b0e3f[_0x992376(0x28c)](_0x992376(0x273)))return!![];return![];}async[a0_0x32bd87(0x2cd)](){const _0x11d674=a0_0x32bd87;await this[_0x11d674(0x30d)](_0x11d674(0x1b1),{'type':'channel','common':{'name':_0x11d674(0x1b1)},'native':{}}),await this[_0x11d674(0x30d)](LTM_DP_RAW_LOG,{'type':_0x11d674(0x194),'common':{'name':_0x11d674(0x1ec),'type':_0x11d674(0x1ba),'role':_0x11d674(0x293),'read':!![],'write':![]},'native':{}}),await this[_0x11d674(0x30d)](LTM_DP_DAILY_DIGESTS,{'type':_0x11d674(0x194),'common':{'name':_0x11d674(0x322),'type':_0x11d674(0x1ba),'role':_0x11d674(0x293),'read':!![],'write':![]},'native':{}}),await this[_0x11d674(0x30d)](LTM_DP_STATUS,{'type':_0x11d674(0x194),'common':{'name':_0x11d674(0x311),'type':'string','role':_0x11d674(0x281),'read':!![],'write':![]},'native':{}}),await this[_0x11d674(0x30d)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':'Trigger\x20Digest','type':_0x11d674(0x179),'role':_0x11d674(0x252),'read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x11d674(0x194),'common':{'name':_0x11d674(0x245),'type':_0x11d674(0x1ba),'role':_0x11d674(0x281),'read':!![],'write':![]},'native':{}});}async[a0_0x32bd87(0x24b)](){const _0x3ff4fa=a0_0x32bd87;await this[_0x3ff4fa(0x30d)](LTM_DP_DRIFT_CHANNEL,{'type':_0x3ff4fa(0x305),'common':{'name':'Drift\x20Analysis'},'native':{}}),await this[_0x3ff4fa(0x30d)](LTM_DP_DRIFT_STATUS,{'type':_0x3ff4fa(0x194),'common':{'name':_0x3ff4fa(0x242),'type':_0x3ff4fa(0x1ba),'role':_0x3ff4fa(0x194),'read':!![],'write':![],'def':_0x3ff4fa(0x335)},'native':{}}),await this[_0x3ff4fa(0x30d)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x3ff4fa(0x1e6),'type':_0x3ff4fa(0x1ba),'role':_0x3ff4fa(0x281),'read':!![],'write':![]},'native':{}}),await this[_0x3ff4fa(0x30d)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x3ff4fa(0x2d9),'type':_0x3ff4fa(0x20e),'role':_0x3ff4fa(0x208),'read':!![],'write':![]},'native':{}});}async[a0_0x32bd87(0x2f9)](){const _0x1ddc84=a0_0x32bd87;await this[_0x1ddc84(0x30d)](_0x1ddc84(0x232),{'type':_0x1ddc84(0x305),'common':{'name':_0x1ddc84(0x33e)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x1ddc84(0x194),'common':{'name':_0x1ddc84(0x31a),'type':_0x1ddc84(0x1ba),'role':_0x1ddc84(0x194),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x1ddc84(0x1ad)],'states':{[SYSTEM_MODES[_0x1ddc84(0x1ad)]]:'Normal',[SYSTEM_MODES[_0x1ddc84(0x287)]]:_0x1ddc84(0x2b2),[SYSTEM_MODES[_0x1ddc84(0x313)]]:_0x1ddc84(0x288),[SYSTEM_MODES[_0x1ddc84(0x294)]]:_0x1ddc84(0x1e1)}},'native':{}});}async[a0_0x32bd87(0x266)](_0x1db60b,_0x85343d=![],_0xc74e5c=![]){const _0xdb2aeb=a0_0x32bd87;this['log'][_0xdb2aeb(0x199)]((_0x85343d?'[TEST]\x20':'')+'Sending\x20notification:\x20\x22'+_0x1db60b+'\x22'+(_0xc74e5c?_0xdb2aeb(0x16f):''));const _0xfbb360=this[_0xdb2aeb(0x235)];let _0x237d32=0x0;_0xfbb360[_0xdb2aeb(0x33b)]&&_0xfbb360['notifyTelegramInstance']&&(await this[_0xdb2aeb(0x226)](_0xfbb360[_0xdb2aeb(0x2fb)],_0xdb2aeb(0x334),{'text':_0x1db60b,'user':_0xfbb360['notifyTelegramRecipient']}),_0x237d32++);if(_0xfbb360[_0xdb2aeb(0x21d)]&&_0xfbb360['notifyPushoverInstance']){let _0x13324d={'message':_0x1db60b,'title':_0xc74e5c?_0xdb2aeb(0x233):_0xdb2aeb(0x241),'priority':_0xc74e5c?0x2:0x1,'device':_0xfbb360[_0xdb2aeb(0x315)]};_0xc74e5c&&(_0x13324d[_0xdb2aeb(0x218)]=0x1e,_0x13324d[_0xdb2aeb(0x187)]=0xe10,_0x13324d['sound']=_0xdb2aeb(0x2c8)),await this[_0xdb2aeb(0x226)](_0xfbb360[_0xdb2aeb(0x1f1)],_0xdb2aeb(0x334),_0x13324d),_0x237d32++;}return _0xfbb360[_0xdb2aeb(0x20f)]&&_0xfbb360[_0xdb2aeb(0x262)]&&(await this[_0xdb2aeb(0x226)](_0xfbb360[_0xdb2aeb(0x262)],_0xdb2aeb(0x334),{'text':_0x1db60b,'to':_0xfbb360['notifyEmailRecipient']}),_0x237d32++),_0xfbb360[_0xdb2aeb(0x2fc)]&&_0xfbb360[_0xdb2aeb(0x1b9)]&&(await this[_0xdb2aeb(0x226)](_0xfbb360[_0xdb2aeb(0x1b9)],_0xdb2aeb(0x334),{'text':_0x1db60b,'phone':_0xfbb360[_0xdb2aeb(0x1a5)]}),_0x237d32++),_0xfbb360[_0xdb2aeb(0x172)]&&_0xfbb360[_0xdb2aeb(0x279)]&&(await this[_0xdb2aeb(0x226)](_0xfbb360[_0xdb2aeb(0x279)],'send',{'text':_0x1db60b,'phone':_0xfbb360[_0xdb2aeb(0x1eb)]}),_0x237d32++),_0x237d32;}async[a0_0x32bd87(0x309)](_0x4e9f19={}){const _0x42636b=a0_0x32bd87;this['log'][_0x42636b(0x199)](_0x42636b(0x2af)+JSON[_0x42636b(0x1b8)](_0x4e9f19));const _0x2669a7=[],_0x53170d=_0x4e9f19['motion']!==![],_0x304efd=_0x4e9f19[_0x42636b(0x250)]!==![],_0x1a6daa=_0x4e9f19[_0x42636b(0x267)]!==![],_0x246c3c=_0x4e9f19[_0x42636b(0x302)]===!![],_0x43b322=_0x4e9f19[_0x42636b(0x1a1)]===!![],_0x7e9c9c=_0x4e9f19['selectedFunctionIds']||[],_0x192ffa=await this[_0x42636b(0x1c1)](_0x42636b(0x2c9),_0x42636b(0x1da)),_0x40084f=await this[_0x42636b(0x1c1)](_0x42636b(0x2e1),'enum'),_0x23763f={},_0x11bc43={},_0x4ff9d0={},_0x4037a4=(_0x12ae3d,_0x34d208,_0x34e8da=![])=>{const _0x23c1b9=_0x42636b;if(!_0x12ae3d)return;for(const _0x349e97 in _0x12ae3d){const _0x84327c=_0x12ae3d[_0x349e97];if(_0x84327c&&_0x84327c[_0x23c1b9(0x2ba)]&&_0x84327c[_0x23c1b9(0x2ba)][_0x23c1b9(0x1e7)]){const _0x10473f=(typeof _0x84327c[_0x23c1b9(0x2ba)][_0x23c1b9(0x30a)]==='object'?_0x84327c['common'][_0x23c1b9(0x30a)]['de']:_0x84327c['common'][_0x23c1b9(0x30a)])||_0x84327c['common'][_0x23c1b9(0x30a)];if(_0x34e8da)_0x4ff9d0[_0x349e97]=_0x10473f;for(const _0x17bc95 of _0x84327c[_0x23c1b9(0x2ba)][_0x23c1b9(0x1e7)]){if(_0x34e8da){if(!_0x34d208[_0x17bc95])_0x34d208[_0x17bc95]=[];_0x34d208[_0x17bc95][_0x23c1b9(0x176)](_0x349e97);}else _0x34d208[_0x17bc95]=_0x10473f;}}}};_0x4037a4(_0x192ffa,_0x23763f),_0x4037a4(_0x40084f,_0x11bc43,!![]);const _0x2336f4=await this[_0x42636b(0x1c1)]('*',_0x42636b(0x194)),_0x482af9=[_0x42636b(0x1fe),_0x42636b(0x308),'info.',_0x42636b(0x20a),_0x42636b(0x1ac),_0x42636b(0x26b),_0x42636b(0x186),_0x42636b(0x244)];if(!_0x43b322)_0x482af9[_0x42636b(0x176)](_0x42636b(0x2ab),_0x42636b(0x182),_0x42636b(0x27f),'yr.',_0x42636b(0x1c6));const _0x806659=[_0x42636b(0x2d6),_0x42636b(0x2ad),'RSSI',_0x42636b(0x2a7),_0x42636b(0x23b),_0x42636b(0x18e),_0x42636b(0x338),_0x42636b(0x1a9),'DUTYCYCLE',_0x42636b(0x2f2),_0x42636b(0x2ac),_0x42636b(0x2f4),_0x42636b(0x16d),_0x42636b(0x278),_0x42636b(0x1ce),_0x42636b(0x1a2),_0x42636b(0x30e),'ON_TIME',_0x42636b(0x2ed),'ERROR_CODE','PROCESS','AES_KEY',_0x42636b(0x2b6),_0x42636b(0x2ea),'link_quality','battery',_0x42636b(0x1cb),_0x42636b(0x23c),_0x42636b(0x196),_0x42636b(0x16a),_0x42636b(0x199),_0x42636b(0x1c5),_0x42636b(0x27a),'last\x20action','archetype','alert',_0x42636b(0x2ce),_0x42636b(0x327),_0x42636b(0x1e2),'xy','ct','hue','sat',_0x42636b(0x1d1),_0x42636b(0x304),_0x42636b(0x29b),_0x42636b(0x1bf),_0x42636b(0x1dd),'mac\x20address','description',_0x42636b(0x2dd),_0x42636b(0x223),_0x42636b(0x2ef),_0x42636b(0x30f),'javascript.0.script',_0x42636b(0x258),_0x42636b(0x27d),_0x42636b(0x1c7),_0x42636b(0x297),_0x42636b(0x256),_0x42636b(0x199),_0x42636b(0x293)],_0x4756bb=(_0x3f68dd,_0x43b168,_0x23922b=![])=>{const _0x2e579a=_0x42636b,_0x38a7c9=_0x3f68dd[_0x2e579a(0x21c)]('.');if(_0x43b168[_0x3f68dd])return _0x43b168[_0x3f68dd];if(_0x38a7c9[_0x2e579a(0x202)]>0x2&&_0x43b168[_0x38a7c9[_0x2e579a(0x225)](0x0,-0x1)[_0x2e579a(0x1e3)]('.')])return _0x43b168[_0x38a7c9[_0x2e579a(0x225)](0x0,-0x1)[_0x2e579a(0x1e3)]('.')];if(_0x38a7c9[_0x2e579a(0x202)]>0x3&&_0x43b168[_0x38a7c9[_0x2e579a(0x225)](0x0,-0x2)['join']('.')])return _0x43b168[_0x38a7c9[_0x2e579a(0x225)](0x0,-0x2)[_0x2e579a(0x1e3)]('.')];return _0x23922b?[]:null;};for(const _0x3b4d82 in _0x2336f4){const _0x2ffbbd=_0x2336f4[_0x3b4d82];if(!_0x2ffbbd||!_0x2ffbbd[_0x42636b(0x2ba)])continue;if(_0x482af9[_0x42636b(0x180)](_0x4ee7ce=>_0x3b4d82[_0x42636b(0x28c)](_0x4ee7ce)))continue;const _0x345454=_0x2ffbbd['common'][_0x42636b(0x289)]||'',_0x594fa5=(_0x2ffbbd[_0x42636b(0x2ba)][_0x42636b(0x30a)]&&typeof _0x2ffbbd[_0x42636b(0x2ba)]['name']===_0x42636b(0x17c)?_0x2ffbbd[_0x42636b(0x2ba)]['name']['de']:_0x2ffbbd[_0x42636b(0x2ba)][_0x42636b(0x30a)])||'',_0x478fee=_0x594fa5?_0x594fa5['toLowerCase']():'',_0x3f5a57=_0x3b4d82[_0x42636b(0x316)](),_0x21cceb=_0x4756bb(_0x3b4d82,_0x23763f),_0x4bde01=_0x4756bb(_0x3b4d82,_0x11bc43,!![]);let _0xb31f0d=null,_0x2fa970=![];if(_0x4bde01&&_0x4bde01[_0x42636b(0x202)]>0x0){const _0x5daf20=_0x4bde01[_0x42636b(0x2b9)](_0x1a04b1=>_0x7e9c9c[_0x42636b(0x33d)](_0x1a04b1));if(_0x5daf20){_0x2fa970=!![];const _0x4b4d13=_0x4ff9d0[_0x5daf20];if(_0x3f5a57[_0x42636b(0x33d)](_0x42636b(0x221))||_0x3f5a57[_0x42636b(0x33d)](_0x42636b(0x1cf)))_0xb31f0d='Bewegung';else{if(_0x3f5a57[_0x42636b(0x33d)]('smoke')||_0x3f5a57['includes'](_0x42636b(0x1db))||_0x478fee['includes'](_0x42636b(0x300)))_0xb31f0d=_0x42636b(0x2bc);else{if(_0x3f5a57[_0x42636b(0x33d)](_0x42636b(0x194))||_0x3f5a57[_0x42636b(0x33d)](_0x42636b(0x253))||_0x3f5a57[_0x42636b(0x33d)]('on'))_0xb31f0d=_0x42636b(0x264);else _0xb31f0d=_0x4b4d13;}}}}if(!_0x2fa970&&!_0x43b322){if(_0x806659['some'](_0x4bef64=>_0x478fee[_0x42636b(0x33d)](_0x4bef64)||_0x3b4d82[_0x42636b(0x2d1)]()['includes'](_0x4bef64)))continue;}if(!_0xb31f0d&&_0x53170d){if(_0x345454[_0x42636b(0x33d)](_0x42636b(0x33c))||_0x345454[_0x42636b(0x33d)](_0x42636b(0x28a))||_0x478fee[_0x42636b(0x33d)](_0x42636b(0x2d7))||_0x478fee[_0x42636b(0x33d)](_0x42636b(0x203)))_0xb31f0d=_0x42636b(0x174);}!_0xb31f0d&&_0x304efd&&((_0x3f5a57[_0x42636b(0x33d)](_0x42636b(0x2f5))||_0x345454['includes'](_0x42636b(0x2a4))||_0x345454[_0x42636b(0x33d)]('sensor.window')||(_0x478fee[_0x42636b(0x33d)](_0x42636b(0x236))||_0x478fee['includes'](_0x42636b(0x2a8)))&&!_0x478fee[_0x42636b(0x33d)]('temp')&&!_0x478fee['includes'](_0x42636b(0x320))&&(_0x2ffbbd[_0x42636b(0x2ba)][_0x42636b(0x1d7)]===_0x42636b(0x179)||_0x2ffbbd['common'][_0x42636b(0x1d7)]===_0x42636b(0x20e)))&&(_0xb31f0d=_0x42636b(0x1bc)));if(!_0xb31f0d&&_0x1a6daa){if((_0x345454[_0x42636b(0x33d)](_0x42636b(0x215))||_0x345454[_0x42636b(0x33d)]('level.dimmer')||_0x478fee[_0x42636b(0x33d)](_0x42636b(0x234))||_0x478fee[_0x42636b(0x33d)](_0x42636b(0x2c7)))&&_0x2ffbbd[_0x42636b(0x2ba)][_0x42636b(0x22c)])_0xb31f0d=_0x42636b(0x247);}if(!_0xb31f0d&&_0x246c3c){if(_0x345454['includes'](_0x42636b(0x2f6))||_0x345454[_0x42636b(0x33d)](_0x42636b(0x319))||_0x478fee[_0x42636b(0x33d)](_0x42636b(0x212)))_0xb31f0d='Temperatur';}if(_0xb31f0d){let _0xfb6f85=_0x21cceb||'';if(!_0xfb6f85){if(_0x478fee[_0x42636b(0x33d)](_0x42636b(0x325)))_0xfb6f85=_0x42636b(0x1d2);else{if(_0x478fee[_0x42636b(0x33d)](_0x42636b(0x24e)))_0xfb6f85=_0x42636b(0x17d);else{if(_0x478fee[_0x42636b(0x33d)](_0x42636b(0x307)))_0xfb6f85=_0x42636b(0x193);else{if(_0x478fee[_0x42636b(0x33d)](_0x42636b(0x1c8)))_0xfb6f85=_0x42636b(0x2f8);else{if(_0x478fee['includes']('flur')||_0x478fee[_0x42636b(0x33d)]('diele'))_0xfb6f85=_0x42636b(0x2c6);else{if(_0x478fee[_0x42636b(0x33d)](_0x42636b(0x32d)))_0xfb6f85=_0x42636b(0x20c);}}}}}}let _0x8ed318=![];_0xb31f0d===_0x42636b(0x1bc)&&((_0x478fee['includes']('haust√ºr')||_0x478fee[_0x42636b(0x33d)](_0x42636b(0x290))||_0x478fee[_0x42636b(0x33d)](_0x42636b(0x292))||_0xfb6f85&&_0xfb6f85['toLowerCase']()['includes'](_0x42636b(0x260))&&_0x478fee[_0x42636b(0x33d)](_0x42636b(0x2a8)))&&(_0x8ed318=!![]));let _0x4fd302=0x0;if(_0x2fa970)_0x4fd302+=0x1e;else{if(_0x21cceb)_0x4fd302+=0x14;else{if(_0xfb6f85)_0x4fd302+=0xa;}}if(_0x8ed318)_0x4fd302+=0x5;_0x2669a7[_0x42636b(0x176)]({'id':_0x3b4d82,'name':_0x594fa5||_0x3b4d82,'type':_0xb31f0d,'location':_0xfb6f85,'logDuplicates':_0xb31f0d===_0x42636b(0x174),'isExit':_0x8ed318,'_score':_0x4fd302});}}return _0x2669a7[_0x42636b(0x206)]((_0xf2a895,_0x521c6c)=>_0x521c6c[_0x42636b(0x2ca)]-_0xf2a895['_score']),_0x2669a7;}[a0_0x32bd87(0x18d)](){const _0x5a84f9=a0_0x32bd87;try{if(this[_0x5a84f9(0x1ff)])this[_0x5a84f9(0x1ff)]['cancel']();if(!this['isProVersion']){this[_0x5a84f9(0x20d)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this[_0x5a84f9(0x1ff)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>this[_0x5a84f9(0x169)]());}catch(_0xc808bb){this[_0x5a84f9(0x20b)][_0x5a84f9(0x1ab)]('LTM\x20Sched\x20Error:\x20'+_0xc808bb[_0x5a84f9(0x228)]);}}[a0_0x32bd87(0x1e9)](){const _0x545502=a0_0x32bd87;try{if(this['modeResetJob'])this[_0x545502(0x16b)]['cancel']();this[_0x545502(0x16b)]=schedule[_0x545502(0x1b4)](MODE_RESET_SCHEDULE,async()=>{const _0x50a711=_0x545502;await this[_0x50a711(0x31b)](),AUTO_RESET_MODES[_0x50a711(0x33d)](this['currentSystemMode'])&&await this[_0x50a711(0x20d)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x50a711(0x1ad)],'ack':![]});});}catch(_0x2139fb){this[_0x545502(0x20b)]['error'](_0x545502(0x2bd)+_0x2139fb[_0x545502(0x228)]);}}['setupDriftAnalysisScheduler'](){const _0x13207c=a0_0x32bd87;try{if(this[_0x13207c(0x1a7)])clearInterval(this[_0x13207c(0x1a7)]);if(!this[_0x13207c(0x181)])return;this['driftAnalysisTimer']=setInterval(()=>this['runBaselineDriftAnalysis'](),(this['config'][_0x13207c(0x259)]||0x18)*0x36ee80),setTimeout(()=>this[_0x13207c(0x17b)](),0x1388);}catch(_0x46974a){this['log'][_0x13207c(0x1ab)](_0x13207c(0x211)+_0x46974a[_0x13207c(0x228)]);}}[a0_0x32bd87(0x310)](){const _0x576a6a=a0_0x32bd87;try{if(this[_0x576a6a(0x19a)])this[_0x576a6a(0x19a)][_0x576a6a(0x2e8)]();if(!this[_0x576a6a(0x235)][_0x576a6a(0x1b6)])return;const _0x4c2a52=(this[_0x576a6a(0x235)]['briefingTime']||_0x576a6a(0x2b0))[_0x576a6a(0x21c)](':'),_0x47db3a=parseInt(_0x4c2a52[0x0])||0x8,_0x2f6e98=parseInt(_0x4c2a52[0x1])||0x0,_0x4beba5=_0x2f6e98+'\x20'+_0x47db3a+_0x576a6a(0x2d8);this['log'][_0x576a6a(0x199)](_0x576a6a(0x27c)+_0x47db3a+':'+(_0x2f6e98<0xa?'0'+_0x2f6e98:_0x2f6e98)),this[_0x576a6a(0x19a)]=schedule['scheduleJob'](_0x4beba5,()=>{const _0xfa681c=_0x576a6a;this[_0xfa681c(0x2fe)]();});}catch(_0x1ad586){this['log'][_0x576a6a(0x1ab)](_0x576a6a(0x17f)+_0x1ad586[_0x576a6a(0x228)]);}}async[a0_0x32bd87(0x17b)](){const _0x31ad7e=a0_0x32bd87;if(!this[_0x31ad7e(0x181)]||!this['geminiModel'])return;const _0x5e7b77=this[_0x31ad7e(0x235)][_0x31ad7e(0x25d)]||0xe;if(this['dailyDigests'][_0x31ad7e(0x202)]<_0x5e7b77+(this[_0x31ad7e(0x235)][_0x31ad7e(0x2a6)]||0x7)){await this[_0x31ad7e(0x20d)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x5ee5a8=this[_0x31ad7e(0x282)][_0x31ad7e(0x225)](-_0x5e7b77),_0x222724=this[_0x31ad7e(0x282)][_0x31ad7e(0x225)](0x0,this[_0x31ad7e(0x282)][_0x31ad7e(0x202)]-_0x5e7b77),_0x38c7f7=_0x31ad7e(0x22e)+JSON['stringify'](_0x222724)+_0x31ad7e(0x341)+JSON['stringify'](_0x5ee5a8);try{const _0x90fb7c=await this['geminiModel']['generateContent'](_0x38c7f7),_0x3c577c=JSON['parse'](_0x90fb7c['response'][_0x31ad7e(0x281)]()['replace'](/```json|```/g,'')[_0x31ad7e(0x2b4)]());_0x3c577c[_0x31ad7e(0x197)]&&(await this[_0x31ad7e(0x20d)](LTM_DP_DRIFT_STATUS,{'val':_0x3c577c[_0x31ad7e(0x197)],'ack':!![]}),await this[_0x31ad7e(0x20d)](LTM_DP_DRIFT_DETAILS,{'val':_0x3c577c[_0x31ad7e(0x229)],'ack':!![]}),await this[_0x31ad7e(0x20d)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x31ad7e(0x2aa)](),'ack':!![]}));}catch(_0x2006d4){}}}if(require[a0_0x32bd87(0x2e0)]!==module)module['exports']=_0x543ead=>new CogniLiving(_0x543ead);else new CogniLiving();