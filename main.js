const a0_0xba881a=a0_0x2265;(function(_0x5ea690,_0xb616b9){const _0x10504f=a0_0x2265,_0x2b0dc8=_0x5ea690();while(!![]){try{const _0x1fd12b=parseInt(_0x10504f(0x2a3))/0x1*(parseInt(_0x10504f(0x216))/0x2)+parseInt(_0x10504f(0x297))/0x3*(-parseInt(_0x10504f(0x2d9))/0x4)+parseInt(_0x10504f(0x2b8))/0x5*(parseInt(_0x10504f(0x284))/0x6)+parseInt(_0x10504f(0x2bb))/0x7+-parseInt(_0x10504f(0x288))/0x8+parseInt(_0x10504f(0x205))/0x9*(parseInt(_0x10504f(0x285))/0xa)+parseInt(_0x10504f(0x23a))/0xb*(-parseInt(_0x10504f(0x28d))/0xc);if(_0x1fd12b===_0xb616b9)break;else _0x2b0dc8['push'](_0x2b0dc8['shift']());}catch(_0x1eaf6f){_0x2b0dc8['push'](_0x2b0dc8['shift']());}}}(a0_0x21ff,0x98662));function a0_0x2265(_0x7b80c,_0x30ef0e){const _0x7d7c33=a0_0x21ff();return a0_0x2265=function(_0x18af07,_0x186877){_0x18af07=_0x18af07-0x1c4;let _0x21ff3c=_0x7d7c33[_0x18af07];return _0x21ff3c;},a0_0x2265(_0x7b80c,_0x30ef0e);}const a0_0x186877=(function(){let _0xe6e892=!![];return function(_0xb99e37,_0x209d51){const _0x37bf0f=_0xe6e892?function(){if(_0x209d51){const _0x1652cc=_0x209d51['apply'](_0xb99e37,arguments);return _0x209d51=null,_0x1652cc;}}:function(){};return _0xe6e892=![],_0x37bf0f;};}()),a0_0x18af07=a0_0x186877(this,function(){const _0xd206a5=a0_0x2265;return a0_0x18af07[_0xd206a5(0x1d7)]()['search'](_0xd206a5(0x2f7))[_0xd206a5(0x1d7)]()[_0xd206a5(0x1fe)](a0_0x18af07)['search'](_0xd206a5(0x2f7));});a0_0x18af07();'use strict';function a0_0x21ff(){const _0x272d6c=['accuweather.0','vis.','\x20Tage)','startsWith','brightness','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','PARTY','getForeignStateAsync','summary','initSystemConfig','\x0aSTB:\x20','121685rHLiDU','icon','\x20sensors...','4833717CvBNrV','switch','Urlaub','message','shutter','FAULT','history.','baselineDrift','normal','Last\x20raw\x20event','scanForDevices','_calName','Error\x20reading\x20calendar\x20table:\x20','occupancy','DIRECTION','runBaselineDriftAnalysis','useWeather','siren','common','ack','analysis.triggerBriefing','toLowerCase','some','getGenerativeModel','updateBaselineStatus','WETTER:\x20Keine\x20Daten\x20gefunden','scheduleJob','Scanning\x20for\x20devices\x20(Aggressive\x20Smart\x20Naming)...','json','substring','4DSHiZH','LTM\x20Sched\x20Error:\x20','level','Flur','üö®\x20EMERGENCY','scanDevices','tryParse','firmware','push','connection','08:00','cover','members','calendarSelection','response','power','filter','analysisTimer','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','N/A\x20(Learning)','Feedback\x20saved:\x20','analysisInterval','onUnload','city','type','eventHistory','getCalendarNames','geminiModel','analysisHistory','time','(((.+)+)+)+$','initPresenceSubscriptions','dailyDigests','Briefing\x20Sched\x20Error:\x20','state','position','Drift\x20Details','Subscribing\x20to\x20','targetposition','name','License\x20Check\x20failed:\x20','from','sendTo','accuweather','sendToAsync','info','NORMAL','Kalender:\x20Deaktiviert','isGracePeriodActive','Aktiv\x20(','\x20min).\x20Watchdog\x20Limit:\x20','processSensorEvent','getForeignObjectAsync','weatherunderground.0','devices','exitGraceTimer','SABOTAGE','retry','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','stringify','0\x204\x20*\x20*\x20*','uuid-error','Daily\x20Digests','updateAnalysisHistory','.data.table','string','Scheduling\x20Morning\x20Briefing\x20for\x20','custom','timestamp','CONFIG_PENDING','main','rawEventLog','ready','.Summary.Current','energy','log','online','currentposition','Reset\x20Sched\x20Error:\x20','PRO-','enum.functions.*','getLtmData','\x20*\x20*\x20*','send','WETTER:\x20','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','Cogni-Living','saveRawEventLog','includes','0\x203\x20*\x20*\x20*','slice','echarts.','Normal','splice','setStateAsync','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','stateChange','System\x20Mode','toString','join','Deaktiviert\x20(Pro-Feature)','setPresence','ERROR','length','getSystemUUID','createAllObjects','initZombies','presence','getCalendarNames\x20Error:\x20','events.history','toUpperCase','.INSTALL_TEST','enum','namespace','system.mode','Drift\x20Analysis','temp','ltmDriftCheckIntervalHours','checkSystemObjects','sendNotification','channel','WORKING','Party','notifyTelegramRecipient','\x20|\x20','uuid','TEST-PRO-KEY','history','expire','event','version','abortExitTimer','sendMorningBriefing','.NextHours.Location_1.Day_1.current.symbol_desc','isArray','presenceDevices','isProVersion','constructor','runGeminiAnalysis','.forecast.current.state','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','forEach','B√ºro','geminiApiKey','5602815mfWsRc','application/json','getForeignObjectsAsync','Baseline\x20Status','location','useCalendar','b√ºro','getEnums','Wetter:\x20Deaktiviert','\x20presence\x20devices...','systemUUID','sensorLastValues','exports','driftAnalysisTimer','lastIndexOf','subscribeStates','trim','92500nuVcuq','unknown','longitude','LTM.rawEventLog','config','triggerDailyDigest','info.','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','notifyPushoverRecipient','licht','LTM','map','checkLicense','bind','licenseKey','notifyPushoverEnabled','systemConfig','getCalendarContext','cogni-living\x20adapter\x20starting\x20(v','@iobroker/adapter-core','lights','Badezimmer','LTM.triggerDailyDigest','onMessage','wetter','runAutopilot','pop','Gemini\x20Init\x20Error:\x20','initHistory','exitTimer','Event\x20History','getOverviewData','modeResetJob','device','triggerBriefing','loadSystemMode','90266boWTVr','minDaysForBaseline','models/gemini-flash-latest','setupDriftAnalysisScheduler','Drift\x20Status','uuid-not-found','_score','error','scene','onReady','RSSI','currentSystemMode','VACATION','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','saveDailyDigests','motion','values','find','inactivityThresholdHours','Sending\x20notification:\x20\x22','system.meta.uuid','sort','isPresent','parse','startExitTimer','weather','toISOString','battery','sound','text','bewegung','onStateChange','setState','setupModeResetScheduler','role','genAI','GUEST','latitude','split','unshift','schlaf','group','callback','off','setObjectNotExistsAsync','Gemini\x20AI\x20initialized.','KALENDER:\x20Keine\x20Daten','ltmJob','getStateAsync','KALENDER:\x20Keine\x20relevanten\x20Termine','extendObjectAsync','briefingTime','LTM.baselineStatus','humidity','createDailyDigest','Lernphase\x20(','cancel','all_lights','status','logDuplicates','object','date','weatherInstance','checkWifiPresence',')\x20-\x20OBFUSCATION\x20SAFE\x20MODE','system.isPresent','DUTYCYCLE','bad','wohn','analysis.trigger','Starting\x20Autopilot\x20(','ALARM','driftDetails','material.','54FoWybD','10PQhawT','door','command','5862960mwpWYm','value','[TEST]\x20','guest','enum.rooms.*','840ebigKc','setupLtmScheduler','icons-mfd.','generateContent','Trigger\x20Digest','system.','events.lastEvent','checkLtmDriftObjects','Adapter','system','1576749QJOvTg','LTM.processingStatus','Last\x20Check','party','LOWBAT','@google/generative-ai','initSensorSubscriptions','N/A','temperature','briefingEnabled','warn','replace','20WrPGKG','notifyTelegramEnabled','Error\x20in\x20onMessage\x20command\x20','Processing\x20Status','val','briefingJob','flur','subscribeForeignStatesAsync','LTM.driftAnalysis.driftDetails','System\x20Status\x20&\x20Control'];a0_0x21ff=function(){return _0x272d6c;};return a0_0x21ff();}const utils=require(a0_0xba881a(0x229)),{GoogleGenerativeAI}=require(a0_0xba881a(0x29c)),schedule=require('node-schedule'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0xba881a(0x23c),LTM_SCHEDULE=a0_0xba881a(0x1ce),MODE_RESET_SCHEDULE=a0_0xba881a(0x315),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0xba881a(0x219),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0xba881a(0x298),LTM_DP_TRIGGER_DIGEST=a0_0xba881a(0x22c),LTM_DP_BASELINE_STATUS=a0_0xba881a(0x26e),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0xba881a(0x2ab),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE='system.mode',IGNORE_TERMS=['UNREACH',a0_0xba881a(0x29b),a0_0xba881a(0x244),a0_0xba881a(0x1db),a0_0xba881a(0x2c0),a0_0xba881a(0x311),a0_0xba881a(0x281),a0_0xba881a(0x31e),a0_0xba881a(0x27c),a0_0xba881a(0x1ee),a0_0xba881a(0x2c9),'STICKY_UNREACH','update',a0_0xba881a(0x2e0),a0_0xba881a(0x1f7),a0_0xba881a(0x2e2),'info','signal',a0_0xba881a(0x255),a0_0xba881a(0x242),a0_0xba881a(0x263),a0_0xba881a(0x273),'.SECTION','.TEST',a0_0xba881a(0x1e4),a0_0xba881a(0x22e),a0_0xba881a(0x253),'forecast',a0_0xba881a(0x2b5),a0_0xba881a(0x2b9),'wind','pressure','uv',a0_0xba881a(0x1f4)],GENERIC_NAMES=[a0_0xba881a(0x2ff),a0_0xba881a(0x326),a0_0xba881a(0x2fb),a0_0xba881a(0x2db),a0_0xba881a(0x289),a0_0xba881a(0x2b1),'on',a0_0xba881a(0x265),a0_0xba881a(0x2bc),a0_0xba881a(0x2fc),a0_0xba881a(0x2bf),'blind',a0_0xba881a(0x2e4),a0_0xba881a(0x274),a0_0xba881a(0x249),a0_0xba881a(0x1e0),a0_0xba881a(0x2c8),a0_0xba881a(0x29f),a0_0xba881a(0x26f),a0_0xba881a(0x2e8),a0_0xba881a(0x323)],ADAPTER_BLACKLIST=[a0_0xba881a(0x292),'admin.',a0_0xba881a(0x21c),a0_0xba881a(0x2ae),a0_0xba881a(0x2c1),a0_0xba881a(0x283),a0_0xba881a(0x28f),'flot.',a0_0xba881a(0x1d0)],SYSTEM_MODES={'NORMAL':a0_0xba881a(0x2c3),'VACATION':'vacation','PARTY':a0_0xba881a(0x29a),'GUEST':a0_0xba881a(0x28b)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0xba881a(0x2b3)],SYSTEM_MODES[a0_0xba881a(0x25e)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0xba881a(0x2eb),'senior_aal':a0_0xba881a(0x21d),'family':a0_0xba881a(0x247),'single_comfort':a0_0xba881a(0x1d4),'security':a0_0xba881a(0x1ca)};class CogniLiving extends utils[a0_0xba881a(0x295)]{constructor(_0x1a2bf7){const _0x6200b4=a0_0xba881a;super({..._0x1a2bf7,'name':'cogni-living'}),this[_0x6200b4(0x2f2)]=[],this['analysisHistory']=[],this['feedbackHistory']=[],this[_0x6200b4(0x320)]=[],this['dailyDigests']=[],this[_0x6200b4(0x210)]={},this[_0x6200b4(0x226)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x6200b4(0x250)]=!![],this['exitTimer']=null,this[_0x6200b4(0x310)]=null,this[_0x6200b4(0x309)]=![],this['genAI']=null,this[_0x6200b4(0x2f4)]=null,this[_0x6200b4(0x245)]=SYSTEM_MODES[_0x6200b4(0x307)],this[_0x6200b4(0x1fd)]=![],this['lastAlertState']=![],this[_0x6200b4(0x20f)]=_0x6200b4(0x217),this[_0x6200b4(0x2ea)]=null,this[_0x6200b4(0x269)]=null,this[_0x6200b4(0x236)]=null,this[_0x6200b4(0x212)]=null,this[_0x6200b4(0x2a8)]=null,this['on'](_0x6200b4(0x321),this[_0x6200b4(0x243)]['bind'](this)),this['on'](_0x6200b4(0x1d5),this[_0x6200b4(0x259)][_0x6200b4(0x223)](this)),this['on']('unload',this[_0x6200b4(0x2ef)][_0x6200b4(0x223)](this)),this['on'](_0x6200b4(0x2be),this[_0x6200b4(0x22d)][_0x6200b4(0x223)](this));}async[a0_0xba881a(0x243)](){const _0x476602=a0_0xba881a;this['log'][_0x476602(0x306)](_0x476602(0x228)+this[_0x476602(0x1f7)]+_0x476602(0x27a)),await this[_0x476602(0x1df)](),this[_0x476602(0x21a)][_0x476602(0x224)]=this['config'][_0x476602(0x224)]||'';try{this[_0x476602(0x1fd)]=await this['checkLicense'](this[_0x476602(0x21a)]['licenseKey']);}catch(_0x4f951a){this['log'][_0x476602(0x241)](_0x476602(0x301)+_0x4f951a[_0x476602(0x2be)]);}if(!this[_0x476602(0x21a)][_0x476602(0x24c)]||this['config']['inactivityThresholdHours']<0.1)this['config'][_0x476602(0x24c)]=0xc;await this[_0x476602(0x232)](),await this[_0x476602(0x2b6)]();if(this[_0x476602(0x21a)][_0x476602(0x204)])try{this[_0x476602(0x25d)]=new GoogleGenerativeAI(this[_0x476602(0x21a)][_0x476602(0x204)]),this['geminiModel']=this['genAI'][_0x476602(0x2d2)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x476602(0x206)}}),this[_0x476602(0x324)]['info'](_0x476602(0x267));}catch(_0x3e3003){this[_0x476602(0x324)][_0x476602(0x241)](_0x476602(0x231)+_0x3e3003['message']);}await this[_0x476602(0x1de)](),await this['loadSystemMode'](),await this['loadRawEventLog'](),await this['loadDailyDigests'](),this[_0x476602(0x214)]('analysis.trigger'),this[_0x476602(0x214)](LTM_DP_TRIGGER_DIGEST),this[_0x476602(0x214)](_0x476602(0x1e7)),this[_0x476602(0x214)](_0x476602(0x2cf)),await this['initSensorSubscriptions'](),await this[_0x476602(0x2f8)]();if(this[_0x476602(0x2ea)])clearInterval(this[_0x476602(0x2ea)]);const _0x4fc86e=this[_0x476602(0x21a)][_0x476602(0x2ee)]||0xf;_0x4fc86e>0x0&&(this[_0x476602(0x324)][_0x476602(0x306)](_0x476602(0x280)+_0x4fc86e+_0x476602(0x30b)+this[_0x476602(0x21a)][_0x476602(0x24c)]+'h.'),this[_0x476602(0x2ea)]=setInterval(()=>{this['runAutopilot']();},_0x4fc86e*0x3c*0x3e8)),this['setupLtmScheduler'](),this[_0x476602(0x25b)](),this['setupDriftAnalysisScheduler'](),this['setupBriefingScheduler']();}[a0_0xba881a(0x2ef)](_0x383e5d){const _0x5133cb=a0_0xba881a;if(this[_0x5133cb(0x2ea)])clearInterval(this[_0x5133cb(0x2ea)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x5133cb(0x212)]);if(this[_0x5133cb(0x269)])this[_0x5133cb(0x269)]['cancel']();if(this[_0x5133cb(0x236)])this[_0x5133cb(0x236)][_0x5133cb(0x272)]();if(this['briefingJob'])this[_0x5133cb(0x2a8)][_0x5133cb(0x272)]();if(this[_0x5133cb(0x233)])clearTimeout(this[_0x5133cb(0x233)]);if(this[_0x5133cb(0x310)])clearTimeout(this[_0x5133cb(0x310)]);_0x383e5d();}async[a0_0xba881a(0x259)](_0x23c717,_0x39c349){const _0x2f70aa=a0_0xba881a;if(!_0x39c349)return;if(_0x23c717===this[_0x2f70aa(0x1e6)]+'.'+SYSTEM_DP_MODE){_0x39c349['val']&&Object['values'](SYSTEM_MODES)[_0x2f70aa(0x1cd)](_0x39c349[_0x2f70aa(0x2a7)])&&(this[_0x2f70aa(0x245)]=_0x39c349[_0x2f70aa(0x2a7)],_0x39c349[_0x2f70aa(0x2a7)]===SYSTEM_MODES[_0x2f70aa(0x246)]?await this[_0x2f70aa(0x1da)](![]):await this[_0x2f70aa(0x1da)](!![]));if(!_0x39c349[_0x2f70aa(0x2ce)])this[_0x2f70aa(0x25a)](_0x23c717,{'val':this[_0x2f70aa(0x245)],'ack':!![]});return;}if(!_0x39c349[_0x2f70aa(0x2ce)]){_0x23c717[_0x2f70aa(0x1cd)](_0x2f70aa(0x27f))&&_0x39c349['val']&&(this[_0x2f70aa(0x25a)](_0x23c717,{'val':![],'ack':!![]}),this['runGeminiAnalysis']());if(_0x23c717[_0x2f70aa(0x1cd)](_0x2f70aa(0x21b))&&_0x39c349[_0x2f70aa(0x2a7)]){this[_0x2f70aa(0x25a)](_0x23c717,{'val':![],'ack':!![]});if(this[_0x2f70aa(0x1fd)])this[_0x2f70aa(0x270)]();}_0x23c717[_0x2f70aa(0x1cd)](_0x2f70aa(0x238))&&_0x39c349[_0x2f70aa(0x2a7)]&&(this[_0x2f70aa(0x25a)](_0x23c717,{'val':![],'ack':!![]}),this['sendMorningBriefing']());return;}if(this['config']['presenceDevices']&&this[_0x2f70aa(0x21a)][_0x2f70aa(0x1fc)][_0x2f70aa(0x1cd)](_0x23c717)){await this[_0x2f70aa(0x279)]();return;}const _0x111fdb=(this[_0x2f70aa(0x21a)][_0x2f70aa(0x30f)]||[])[_0x2f70aa(0x24b)](_0xbeaab5=>_0xbeaab5['id']===_0x23c717);if(_0x111fdb)this['processSensorEvent'](_0x23c717,_0x39c349,_0x111fdb);}async['onMessage'](_0x6dce72){const _0x42bd5d=a0_0xba881a;if(typeof _0x6dce72==='object'&&_0x6dce72[_0x42bd5d(0x2be)])try{if(_0x6dce72[_0x42bd5d(0x287)]==='testApiKey'){}else{if(_0x6dce72[_0x42bd5d(0x287)]==='testNotification'){}else{if(_0x6dce72['command']===_0x42bd5d(0x1c6)){}else{if(_0x6dce72['command']===_0x42bd5d(0x235)){const _0x49288e=this[_0x42bd5d(0x2f9)]['length'],_0x42af89=this[_0x42bd5d(0x2f2)][_0x42bd5d(0x1dc)]>0x0?this[_0x42bd5d(0x2f2)][0x0]:null,_0x3435c5=this['eventHistory']['filter'](_0x4dcc8a=>_0x4dcc8a[_0x42bd5d(0x31d)]>new Date()['setHours'](0x0,0x0,0x0,0x0))[_0x42bd5d(0x1dc)];let _0x61b38={'status':_0x42bd5d(0x29e)};try{_0x61b38[_0x42bd5d(0x274)]=(await this[_0x42bd5d(0x26a)](LTM_DP_DRIFT_STATUS))[_0x42bd5d(0x2a7)];}catch(_0xa9b1e6){}this[_0x42bd5d(0x303)](_0x6dce72[_0x42bd5d(0x302)],_0x6dce72[_0x42bd5d(0x287)],{'success':!![],'eventHistory':this[_0x42bd5d(0x2f2)][_0x42bd5d(0x1cf)](0x0,0xf),'stats':{'digestCount':_0x49288e,'eventCountToday':_0x3435c5,'driftStatus':_0x61b38[_0x42bd5d(0x274)],'isPresent':this[_0x42bd5d(0x250)]}},_0x6dce72[_0x42bd5d(0x264)]);}else{if(_0x6dce72['command']===_0x42bd5d(0x20c)){const _0x5b0491=await this[_0x42bd5d(0x207)](_0x42bd5d(0x1c5),_0x42bd5d(0x1e5)),_0x4786d2=[];if(_0x5b0491)for(const _0x3fb020 in _0x5b0491){const _0x321dd6=_0x5b0491[_0x3fb020],_0x278da8=(_0x321dd6[_0x42bd5d(0x2cd)]&&typeof _0x321dd6[_0x42bd5d(0x2cd)][_0x42bd5d(0x300)]===_0x42bd5d(0x276)?_0x321dd6[_0x42bd5d(0x2cd)][_0x42bd5d(0x300)]['de']:_0x321dd6['common'][_0x42bd5d(0x300)])||_0x321dd6[_0x42bd5d(0x2cd)][_0x42bd5d(0x300)];_0x4786d2[_0x42bd5d(0x2e1)]({'id':_0x3fb020,'name':_0x278da8});}this[_0x42bd5d(0x303)](_0x6dce72[_0x42bd5d(0x302)],_0x6dce72[_0x42bd5d(0x287)],{'success':!![],'enums':_0x4786d2},_0x6dce72[_0x42bd5d(0x264)]);}else{if(_0x6dce72[_0x42bd5d(0x287)]===_0x42bd5d(0x2de))try{const _0x1c6c9c=await this['scanForDevices'](_0x6dce72[_0x42bd5d(0x2be)]||{});this[_0x42bd5d(0x303)](_0x6dce72[_0x42bd5d(0x302)],_0x6dce72['command'],{'success':!![],'devices':_0x1c6c9c},_0x6dce72[_0x42bd5d(0x264)]);}catch(_0x3a76e0){this['sendTo'](_0x6dce72[_0x42bd5d(0x302)],_0x6dce72[_0x42bd5d(0x287)],{'success':![],'error':_0x3a76e0[_0x42bd5d(0x2be)]},_0x6dce72[_0x42bd5d(0x264)]);}}}}}}}catch(_0x41d4ba){this['log']['error'](_0x42bd5d(0x2a5)+_0x6dce72[_0x42bd5d(0x287)]+':\x20'+_0x41d4ba['message']);if(_0x6dce72[_0x42bd5d(0x264)])this[_0x42bd5d(0x303)](_0x6dce72[_0x42bd5d(0x302)],_0x6dce72[_0x42bd5d(0x287)],{'success':![],'error':_0x41d4ba[_0x42bd5d(0x2be)]},_0x6dce72['callback']);}}async[a0_0xba881a(0x30c)](_0x3cffc6,_0x13eb1e,_0x2eb915){const _0x157c82=a0_0xba881a;if(!_0x2eb915[_0x157c82(0x275)]&&this[_0x157c82(0x210)][_0x3cffc6]===_0x13eb1e['val'])return;this['sensorLastValues'][_0x3cffc6]=_0x13eb1e[_0x157c82(0x2a7)];if(this[_0x157c82(0x309)])return;const _0x11a64a=await this['checkWifiPresence']();if(_0x11a64a){if(!this[_0x157c82(0x250)])await this[_0x157c82(0x1da)](!![]);}else{const _0x430ef9=_0x2eb915['isExit']===!![];_0x430ef9?this['startExitTimer']():(this[_0x157c82(0x233)]&&this[_0x157c82(0x1f8)](),!this[_0x157c82(0x250)]&&this[_0x157c82(0x245)]===SYSTEM_MODES['NORMAL']&&await this['setPresence'](!![]));}const _0x3269e5={'timestamp':_0x13eb1e['ts'],'id':_0x3cffc6,'name':_0x2eb915[_0x157c82(0x300)],'value':_0x13eb1e[_0x157c82(0x2a7)],'location':_0x2eb915[_0x157c82(0x209)],'type':_0x2eb915['type']};this[_0x157c82(0x2f2)]['unshift'](_0x3269e5);if(this[_0x157c82(0x2f2)][_0x157c82(0x1dc)]>HISTORY_MAX_SIZE)this[_0x157c82(0x2f2)][_0x157c82(0x230)]();await this[_0x157c82(0x1d3)](_0x157c82(0x293),{'val':JSON['stringify'](_0x3269e5),'ack':!![]}),await this[_0x157c82(0x1d3)](_0x157c82(0x1e2),{'val':JSON[_0x157c82(0x314)](this[_0x157c82(0x2f2)]),'ack':!![]}),this['rawEventLog']['push']({'timestamp':new Date(_0x13eb1e['ts'])[_0x157c82(0x254)](),'sensorName':_0x2eb915[_0x157c82(0x300)],'location':_0x2eb915[_0x157c82(0x209)],'value':_0x13eb1e[_0x157c82(0x2a7)]}),await this[_0x157c82(0x1cc)]();}async[a0_0xba881a(0x22f)](){}async[a0_0xba881a(0x1ff)](_0x387e17=''){}async['createDailyDigest'](){}async[a0_0xba881a(0x1f9)](){}async[a0_0xba881a(0x2c5)](_0x14a474){const _0x4f1b2c=a0_0xba881a;this[_0x4f1b2c(0x324)][_0x4f1b2c(0x306)](_0x4f1b2c(0x2d6));const _0xa8b20b=[],_0x417326=await this['getForeignObjectsAsync']('*'),_0x5cb8f6=await this['getForeignObjectsAsync'](_0x4f1b2c(0x28c),_0x4f1b2c(0x1e5)),_0x3bf96a=await this[_0x4f1b2c(0x207)]('enum.functions.*',_0x4f1b2c(0x1e5)),_0x46b59c={};if(_0x5cb8f6)for(const _0x41d0f8 in _0x5cb8f6){const _0x58b631=_0x5cb8f6[_0x41d0f8][_0x4f1b2c(0x2cd)][_0x4f1b2c(0x2e5)]||[],_0x2e950f=typeof _0x5cb8f6[_0x41d0f8][_0x4f1b2c(0x2cd)][_0x4f1b2c(0x300)]===_0x4f1b2c(0x276)?_0x5cb8f6[_0x41d0f8][_0x4f1b2c(0x2cd)][_0x4f1b2c(0x300)]['de']:_0x5cb8f6[_0x41d0f8][_0x4f1b2c(0x2cd)][_0x4f1b2c(0x300)];_0x58b631['forEach'](_0x1810f0=>_0x46b59c[_0x1810f0]=_0x2e950f);}const _0x58cbbe={};if(_0x3bf96a)for(const _0x5b4d47 in _0x3bf96a){const _0x4dd069=_0x3bf96a[_0x5b4d47][_0x4f1b2c(0x2cd)][_0x4f1b2c(0x2e5)]||[],_0x44f456=_0x5b4d47[_0x4f1b2c(0x260)]('.')[_0x4f1b2c(0x230)]()[_0x4f1b2c(0x2d0)]();_0x4dd069[_0x4f1b2c(0x202)](_0x530a21=>{const _0x188bb5=_0x4f1b2c;if(!_0x58cbbe[_0x530a21])_0x58cbbe[_0x530a21]=[];_0x58cbbe[_0x530a21][_0x188bb5(0x2e1)](_0x44f456);});}const _0x1f14d4=_0x14a474['selectedFunctionIds']||[],_0x20b44e=_0x14a474[_0x4f1b2c(0x249)]!==![],_0x577ed8=_0x14a474['doors']!==![],_0x199d3c=_0x14a474[_0x4f1b2c(0x22a)]!==![],_0x253426=_0x14a474[_0x4f1b2c(0x29f)]===!![],_0x28c85c=_0x14a474[_0x4f1b2c(0x253)]===!![];for(const _0x127957 in _0x417326){const _0x54cf01=_0x417326[_0x127957];if(_0x54cf01[_0x4f1b2c(0x2f1)]!==_0x4f1b2c(0x2fb)||!_0x54cf01[_0x4f1b2c(0x2cd)])continue;if(ADAPTER_BLACKLIST[_0x4f1b2c(0x2d1)](_0x42fdbc=>_0x127957['startsWith'](_0x42fdbc))&&!_0x28c85c)continue;const _0x1d5fa6=(_0x54cf01[_0x4f1b2c(0x2cd)][_0x4f1b2c(0x25c)]||'')['toLowerCase']();let _0x44bfcc=(typeof _0x54cf01['common'][_0x4f1b2c(0x300)]===_0x4f1b2c(0x276)?_0x54cf01['common'][_0x4f1b2c(0x300)]['de']:_0x54cf01[_0x4f1b2c(0x2cd)]['name'])||_0x127957;const _0xfa4ca7=_0x44bfcc[_0x4f1b2c(0x2d0)](),_0x347735=GENERIC_NAMES['some'](_0xb8736b=>_0xfa4ca7['includes'](_0xb8736b));if(_0x347735){let _0x2cffee='',_0x404030=_0x127957;for(let _0x5dc55f=0x0;_0x5dc55f<0x3;_0x5dc55f++){const _0x3ad3f4=_0x404030[_0x4f1b2c(0x213)]('.');if(_0x3ad3f4===-0x1)break;_0x404030=_0x404030[_0x4f1b2c(0x2d8)](0x0,_0x3ad3f4);const _0x5adf37=_0x417326[_0x404030];if(_0x5adf37&&_0x5adf37[_0x4f1b2c(0x2cd)]&&_0x5adf37[_0x4f1b2c(0x2cd)]['name']){const _0x243a97=typeof _0x5adf37['common']['name']===_0x4f1b2c(0x276)?_0x5adf37[_0x4f1b2c(0x2cd)][_0x4f1b2c(0x300)]['de']:_0x5adf37['common'][_0x4f1b2c(0x300)],_0x10a409=_0x243a97?_0x243a97[_0x4f1b2c(0x2d0)]():'';if(_0x243a97&&!_0x10a409[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x1ed))&&!_0x10a409[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x237))&&_0x243a97[_0x4f1b2c(0x1dc)]>0x3){_0x2cffee=_0x243a97;break;}}}_0x2cffee&&!_0xfa4ca7[_0x4f1b2c(0x1cd)](_0x2cffee[_0x4f1b2c(0x2d0)]())&&(_0x44bfcc=_0x2cffee+'\x20'+_0x44bfcc);}const _0x1655ac=_0x58cbbe[_0x127957]||[];let _0x3d7c04=![],_0x187d02=![];if(_0x1f14d4[_0x4f1b2c(0x1dc)]>0x0)for(const _0x1f9950 of _0x1f14d4){if(_0x3bf96a[_0x1f9950]&&_0x3bf96a[_0x1f9950][_0x4f1b2c(0x2cd)][_0x4f1b2c(0x2e5)]){const _0x556512=_0x3bf96a[_0x1f9950][_0x4f1b2c(0x2cd)]['members'];if(_0x556512[_0x4f1b2c(0x1cd)](_0x127957)||_0x556512[_0x4f1b2c(0x2d1)](_0x4d0d35=>_0x127957[_0x4f1b2c(0x2b0)](_0x4d0d35+'.'))){_0x3d7c04=!![],_0x187d02=!![];break;}}}if(!_0x3d7c04&&!_0x28c85c){if(IGNORE_TERMS[_0x4f1b2c(0x2d1)](_0x94fd24=>_0x127957[_0x4f1b2c(0x1e3)]()[_0x4f1b2c(0x1cd)](_0x94fd24)||_0xfa4ca7[_0x4f1b2c(0x1cd)](_0x94fd24[_0x4f1b2c(0x2d0)]()))){if(!_0x1d5fa6['includes'](_0x4f1b2c(0x249))&&!_0x1d5fa6[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x286))&&!_0x1d5fa6[_0x4f1b2c(0x1cd)]('switch'))continue;}}let _0x220ff6='';if(_0x20b44e&&(_0x1d5fa6['includes'](_0x4f1b2c(0x249))||_0xfa4ca7['includes'](_0x4f1b2c(0x258))))_0x220ff6=_0x4f1b2c(0x249);else{if(!_0x220ff6&&_0x577ed8&&(_0x1d5fa6[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x286))||_0x1d5fa6[_0x4f1b2c(0x1cd)]('window')||_0xfa4ca7[_0x4f1b2c(0x1cd)]('fenster')||_0xfa4ca7[_0x4f1b2c(0x1cd)]('t√ºr')))_0x220ff6=_0x4f1b2c(0x286);else{if(!_0x220ff6&&_0x199d3c&&(_0x1d5fa6[_0x4f1b2c(0x1cd)]('light')||_0xfa4ca7[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x21f))))_0x220ff6='light';else{if(!_0x220ff6&&_0x253426&&(_0x1d5fa6['includes'](_0x4f1b2c(0x29f))||_0xfa4ca7[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x1e9))))_0x220ff6=_0x4f1b2c(0x29f);else{if(!_0x220ff6&&_0x187d02)_0x220ff6=_0x4f1b2c(0x31c);}}}}if(_0x220ff6){let _0x39d7d4=_0x46b59c[_0x127957]||'';if(!_0x39d7d4){let _0x19d56a=_0x127957;for(let _0xca9ed7=0x0;_0xca9ed7<0x3;_0xca9ed7++){const _0x250e4a=_0x19d56a[_0x4f1b2c(0x213)]('.');if(_0x250e4a===-0x1)break;_0x19d56a=_0x19d56a[_0x4f1b2c(0x2d8)](0x0,_0x250e4a);if(_0x46b59c[_0x19d56a]){_0x39d7d4=_0x46b59c[_0x19d56a];break;}}}if(!_0x39d7d4){if(_0xfa4ca7[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x27d)))_0x39d7d4=_0x4f1b2c(0x22b);else{if(_0xfa4ca7[_0x4f1b2c(0x1cd)]('k√ºche'))_0x39d7d4='K√ºche';else{if(_0xfa4ca7[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x27e)))_0x39d7d4='Wohnzimmer';else{if(_0xfa4ca7['includes'](_0x4f1b2c(0x262)))_0x39d7d4='Schlafzimmer';else{if(_0xfa4ca7[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x2a9)))_0x39d7d4=_0x4f1b2c(0x2dc);else{if(_0xfa4ca7[_0x4f1b2c(0x1cd)](_0x4f1b2c(0x20b)))_0x39d7d4=_0x4f1b2c(0x203);}}}}}}_0xa8b20b[_0x4f1b2c(0x2e1)]({'id':_0x127957,'name':_0x44bfcc,'location':_0x39d7d4,'type':_0x220ff6,'logDuplicates':_0x220ff6===_0x4f1b2c(0x249),'isExit':![],'_score':_0x39d7d4?0x50:_0x220ff6===_0x4f1b2c(0x31c)?0x5a:0x28});}}return _0xa8b20b[_0x4f1b2c(0x24f)]((_0x48056d,_0x79bc17)=>_0x79bc17['_score']-_0x48056d[_0x4f1b2c(0x240)]),_0xa8b20b;}[a0_0xba881a(0x2df)](_0x28ac53){const _0x2038cb=a0_0xba881a;if(typeof _0x28ac53===_0x2038cb(0x276))return _0x28ac53;try{return JSON[_0x2038cb(0x251)](_0x28ac53);}catch(_0x219f4c){return null;}}async[a0_0xba881a(0x1df)](){}async[a0_0xba881a(0x232)](){}async['initSystemConfig'](){const _0x588d74=a0_0xba881a;try{const _0x52e233=await this[_0x588d74(0x30d)]('system.config');_0x52e233&&_0x52e233[_0x588d74(0x2cd)]&&(this['systemConfig']={'latitude':_0x52e233[_0x588d74(0x2cd)][_0x588d74(0x25f)]||0x0,'longitude':_0x52e233[_0x588d74(0x2cd)][_0x588d74(0x218)]||0x0,'city':_0x52e233[_0x588d74(0x2cd)][_0x588d74(0x2f0)]||''});}catch(_0x4912e0){}}async[a0_0xba881a(0x222)](_0x4a41d8){const _0x17d230=a0_0xba881a;if(!_0x4a41d8)return![];this['systemUUID']=await this['getSystemUUID']();if(_0x4a41d8===_0x17d230(0x1f3)||_0x4a41d8['startsWith'](_0x17d230(0x1c4)))return!![];return![];}async[a0_0xba881a(0x1dd)](){const _0x61c9af=a0_0xba881a;try{const _0x261308=await this[_0x61c9af(0x30d)](_0x61c9af(0x24e));if(_0x261308&&_0x261308['native']&&_0x261308['native']['uuid'])return _0x261308['native'][_0x61c9af(0x1f2)];return _0x61c9af(0x23f);}catch(_0x3c925b){return _0x61c9af(0x316);}}async['createAllObjects'](){const _0x5563d7=a0_0xba881a;await this[_0x5563d7(0x1eb)](),await this[_0x5563d7(0x266)](_0x5563d7(0x293),{'type':_0x5563d7(0x2fb),'common':{'name':_0x5563d7(0x2c4),'type':_0x5563d7(0x31a),'role':_0x5563d7(0x2d7),'read':!![],'write':![]},'native':{}}),await this[_0x5563d7(0x266)]('events.history',{'type':_0x5563d7(0x2fb),'common':{'name':_0x5563d7(0x234),'type':_0x5563d7(0x31a),'role':_0x5563d7(0x2d7),'read':!![],'write':![]},'native':{}}),await this['checkLtmObjects'](),await this['checkLtmDriftObjects']();}async[a0_0xba881a(0x1eb)](){const _0x5aaa7d=a0_0xba881a;await this[_0x5aaa7d(0x26c)](_0x5aaa7d(0x296),{'type':_0x5aaa7d(0x1ed),'common':{'name':_0x5aaa7d(0x2ac)},'native':{}}),await this[_0x5aaa7d(0x26c)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x5aaa7d(0x1d6),'type':_0x5aaa7d(0x31a),'role':_0x5aaa7d(0x2fb),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x5aaa7d(0x307)]]:_0x5aaa7d(0x1d1),[SYSTEM_MODES['VACATION']]:_0x5aaa7d(0x2bd),[SYSTEM_MODES[_0x5aaa7d(0x2b3)]]:_0x5aaa7d(0x1ef),[SYSTEM_MODES[_0x5aaa7d(0x25e)]]:'Gast'}},'native':{}});}async['checkLtmObjects'](){const _0x59701f=a0_0xba881a;await this['extendObjectAsync'](_0x59701f(0x220),{'type':'channel','common':{'name':'LTM'},'native':{}}),await this['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x59701f(0x2fb),'common':{'name':'Raw\x20Log','type':_0x59701f(0x31a),'role':_0x59701f(0x2d7),'read':!![],'write':![]},'native':{}}),await this[_0x59701f(0x26c)](LTM_DP_DAILY_DIGESTS,{'type':_0x59701f(0x2fb),'common':{'name':_0x59701f(0x317),'type':_0x59701f(0x31a),'role':_0x59701f(0x2d7),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_STATUS,{'type':'state','common':{'name':_0x59701f(0x2a6),'type':_0x59701f(0x31a),'role':_0x59701f(0x257),'read':!![],'write':![]},'native':{}}),await this[_0x59701f(0x26c)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x59701f(0x291),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x59701f(0x2fb),'common':{'name':_0x59701f(0x208),'type':_0x59701f(0x31a),'role':_0x59701f(0x257),'read':!![],'write':![]},'native':{}});}async[a0_0xba881a(0x294)](){const _0x4e5573=a0_0xba881a;await this[_0x4e5573(0x26c)](LTM_DP_DRIFT_CHANNEL,{'type':_0x4e5573(0x1ed),'common':{'name':_0x4e5573(0x1e8)},'native':{}}),await this[_0x4e5573(0x26c)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x4e5573(0x23e),'type':_0x4e5573(0x31a),'role':_0x4e5573(0x2fb),'read':!![],'write':![],'def':_0x4e5573(0x29e)},'native':{}}),await this[_0x4e5573(0x26c)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x4e5573(0x2fd),'type':'string','role':_0x4e5573(0x257),'read':!![],'write':![]},'native':{}}),await this[_0x4e5573(0x26c)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x4e5573(0x2fb),'common':{'name':_0x4e5573(0x299),'type':'number','role':_0x4e5573(0x277),'read':!![],'write':![]},'native':{}});}async[a0_0xba881a(0x239)](){const _0x3da278=a0_0xba881a;try{const _0x56d271=await this[_0x3da278(0x26a)](SYSTEM_DP_MODE);_0x56d271&&_0x56d271['val']&&Object[_0x3da278(0x24a)](SYSTEM_MODES)[_0x3da278(0x1cd)](_0x56d271[_0x3da278(0x2a7)])?this['currentSystemMode']=_0x56d271[_0x3da278(0x2a7)]:(this[_0x3da278(0x245)]=SYSTEM_MODES['NORMAL'],await this[_0x3da278(0x1d3)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3da278(0x307)],'ack':!![]}));}catch(_0x4a44fe){this[_0x3da278(0x245)]=SYSTEM_MODES[_0x3da278(0x307)];}}async['loadRawEventLog'](){const _0x51906c=a0_0xba881a;try{const _0x214dc9=await this[_0x51906c(0x26a)](LTM_DP_RAW_LOG);if(_0x214dc9&&_0x214dc9[_0x51906c(0x2a7)])this[_0x51906c(0x320)]=JSON[_0x51906c(0x251)](_0x214dc9[_0x51906c(0x2a7)]);}catch(_0x2cd3b0){this[_0x51906c(0x320)]=[];}}async['loadDailyDigests'](){const _0xcbdd92=a0_0xba881a;try{const _0x494409=await this[_0xcbdd92(0x26a)](LTM_DP_DAILY_DIGESTS);if(_0x494409&&_0x494409[_0xcbdd92(0x2a7)])this['dailyDigests']=JSON[_0xcbdd92(0x251)](_0x494409[_0xcbdd92(0x2a7)]);}catch(_0x413864){this['dailyDigests']=[];}await this['updateBaselineStatus']();}async['saveRawEventLog'](){const _0x18e79b=a0_0xba881a;this['rawEventLog']['length']>RAW_LOG_MAX_SIZE&&this['rawEventLog'][_0x18e79b(0x1d2)](0x0,this['rawEventLog'][_0x18e79b(0x1dc)]-RAW_LOG_MAX_SIZE),await this[_0x18e79b(0x1d3)](LTM_DP_RAW_LOG,{'val':JSON[_0x18e79b(0x314)](this[_0x18e79b(0x320)]),'ack':!![]});}async[a0_0xba881a(0x248)](_0x4292d6=!![]){const _0x3fb606=a0_0xba881a,_0x317981=this[_0x3fb606(0x21a)]['ltmLtbWindowDays']||0x3c;this[_0x3fb606(0x2f9)][_0x3fb606(0x1dc)]>_0x317981&&this['dailyDigests']['splice'](0x0,this[_0x3fb606(0x2f9)][_0x3fb606(0x1dc)]-_0x317981);await this[_0x3fb606(0x1d3)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x3fb606(0x314)](this[_0x3fb606(0x2f9)]),'ack':!![]});if(_0x4292d6)await this['updateBaselineStatus']();}async[a0_0xba881a(0x318)](_0x5056e7){const _0xa09581=a0_0xba881a;this[_0xa09581(0x2f5)][_0xa09581(0x261)](_0x5056e7);if(this['analysisHistory'][_0xa09581(0x1dc)]>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0xa09581(0x230)]();await this[_0xa09581(0x1d3)]('analysis.analysisHistory',{'val':JSON[_0xa09581(0x314)](this['analysisHistory']),'ack':!![]});}async[a0_0xba881a(0x2d3)](){const _0x4ae60c=a0_0xba881a;if(!this['isProVersion']){await this[_0x4ae60c(0x1d3)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x4c9289=this['dailyDigests'][_0x4ae60c(0x1dc)]>=(this['config'][_0x4ae60c(0x23b)]||0x7)?_0x4ae60c(0x30a)+this[_0x4ae60c(0x2f9)]['length']+_0x4ae60c(0x2af):_0x4ae60c(0x271)+this[_0x4ae60c(0x2f9)][_0x4ae60c(0x1dc)]+'/'+(this[_0x4ae60c(0x21a)][_0x4ae60c(0x23b)]||0x7)+')';await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x4c9289,'ack':!![]});}async[a0_0xba881a(0x29d)](){const _0x4b36f0=a0_0xba881a,_0x4d3ecf=this[_0x4b36f0(0x21a)]['devices'];if(_0x4d3ecf&&_0x4d3ecf[_0x4b36f0(0x1dc)]>0x0){this[_0x4b36f0(0x324)][_0x4b36f0(0x306)](_0x4b36f0(0x2fe)+_0x4d3ecf[_0x4b36f0(0x1dc)]+_0x4b36f0(0x2ba));for(const _0x5e0471 of _0x4d3ecf){if(_0x5e0471['id']){await this[_0x4b36f0(0x2aa)](_0x5e0471['id']);try{const _0x1f96bf=await this['getForeignStateAsync'](_0x5e0471['id']);if(_0x1f96bf)this[_0x4b36f0(0x210)][_0x5e0471['id']]=_0x1f96bf[_0x4b36f0(0x2a7)];}catch(_0x4170cf){}}}}}async['initPresenceSubscriptions'](){const _0x5e8555=a0_0xba881a,_0x22a256=this['config']['presenceDevices']||[];if(_0x22a256[_0x5e8555(0x1dc)]>0x0){this[_0x5e8555(0x324)][_0x5e8555(0x306)](_0x5e8555(0x2fe)+_0x22a256['length']+_0x5e8555(0x20e));for(const _0x591115 of _0x22a256){await this[_0x5e8555(0x2aa)](_0x591115);}try{await this['checkWifiPresence']();}catch(_0x902b3d){}}}async['getWeatherContext'](){const _0x802973=a0_0xba881a;try{if(!this[_0x802973(0x21a)][_0x802973(0x2cb)])return _0x802973(0x20d);let _0x12ff11='';const _0x3519e9=this[_0x802973(0x21a)][_0x802973(0x278)];if(_0x3519e9)try{if(_0x3519e9[_0x802973(0x1cd)](_0x802973(0x304))){const _0x25b04c=await this['getForeignStateAsync'](_0x3519e9+_0x802973(0x322));if(_0x25b04c&&_0x25b04c[_0x802973(0x2a7)])_0x12ff11=_0x25b04c[_0x802973(0x2a7)];}else{if(_0x3519e9['includes']('daswetter')){const _0x103833=await this[_0x802973(0x2b4)](_0x3519e9+_0x802973(0x1fa));if(_0x103833&&_0x103833['val'])_0x12ff11=_0x103833[_0x802973(0x2a7)];}else{if(_0x3519e9['includes']('openweathermap')){const _0x89064a=await this[_0x802973(0x2b4)](_0x3519e9+_0x802973(0x200));if(_0x89064a&&_0x89064a[_0x802973(0x2a7)])_0x12ff11=_0x89064a['val'];}}}}catch(_0xd0c01c){}if(!_0x12ff11){const _0x245804=[_0x802973(0x2ad),'daswetter.0',_0x802973(0x30e),'openweathermap.0'];for(const _0xdc3702 of _0x245804){try{const _0x8de242=await this[_0x802973(0x30d)](_0xdc3702);if(_0x8de242){if(_0xdc3702['includes']('accuweather')){const _0x56b95b=await this[_0x802973(0x2b4)](_0xdc3702+'.Summary.Current');if(_0x56b95b&&_0x56b95b[_0x802973(0x2a7)]){_0x12ff11=_0x56b95b[_0x802973(0x2a7)];break;}}}}catch(_0x26fa2e){}}}return _0x12ff11?_0x802973(0x1c9)+_0x12ff11:_0x802973(0x2d4);}catch(_0x54f87f){return'WETTER\x20ERROR:\x20'+_0x54f87f['message'];}}async[a0_0xba881a(0x227)](){const _0x31e6ef=a0_0xba881a;try{if(!this[_0x31e6ef(0x21a)][_0x31e6ef(0x20a)])return _0x31e6ef(0x308);let _0x1298aa=this['config']['calendarInstance']||'ical.0',_0x31638b=this[_0x31e6ef(0x21a)][_0x31e6ef(0x2e6)]||[];if(typeof _0x31638b===_0x31e6ef(0x31a))_0x31638b=_0x31638b[_0x31e6ef(0x260)](',');try{const _0x410393=await this[_0x31e6ef(0x2b4)](_0x1298aa+_0x31e6ef(0x319));if(_0x410393&&_0x410393['val']){let _0x6e3858=this[_0x31e6ef(0x2df)](_0x410393['val']);if(_0x6e3858&&Array[_0x31e6ef(0x1fb)](_0x6e3858)){if(_0x31638b[_0x31e6ef(0x1dc)]>0x0)_0x6e3858=_0x6e3858[_0x31e6ef(0x2e9)](_0xebb629=>_0x31638b[_0x31e6ef(0x1cd)](_0xebb629[_0x31e6ef(0x2c6)]||''));else return _0x31e6ef(0x313);if(_0x6e3858[_0x31e6ef(0x1dc)]>0x0){const _0x2d80f7=_0x6e3858[_0x31e6ef(0x1cf)](0x0,0x3)[_0x31e6ef(0x221)](_0x36b87d=>{const _0x7d032f=_0x31e6ef;let _0x44f2b1=_0x36b87d['date'];if(_0x36b87d[_0x7d032f(0x2f6)])_0x44f2b1+='\x20'+_0x36b87d['time'];return _0x44f2b1+':\x20'+_0x36b87d[_0x7d032f(0x1f6)]+'\x20('+_0x36b87d[_0x7d032f(0x2c6)]+')';});return'KALENDER:\x20'+_0x2d80f7[_0x31e6ef(0x1d8)](_0x31e6ef(0x1f1));}else return _0x31e6ef(0x26b);}}}catch(_0x3dcffa){this['log'][_0x31e6ef(0x2a1)](_0x31e6ef(0x2c7)+_0x3dcffa['message']);}return _0x31e6ef(0x268);}catch(_0x1f110c){return'KALENDER\x20ERROR:\x20'+_0x1f110c[_0x31e6ef(0x2be)];}}async[a0_0xba881a(0x2f3)](_0x5e4ee3){const _0x1ceb5a=a0_0xba881a;try{const _0x3f4198=await this[_0x1ceb5a(0x2b4)](_0x5e4ee3+'.data.table');if(_0x3f4198&&_0x3f4198[_0x1ceb5a(0x2a7)]){const _0x2189f7=this[_0x1ceb5a(0x2df)](_0x3f4198[_0x1ceb5a(0x2a7)]);if(_0x2189f7&&Array[_0x1ceb5a(0x1fb)](_0x2189f7)){const _0x31bf7b=[...new Set(_0x2189f7[_0x1ceb5a(0x221)](_0x6c7ca9=>_0x6c7ca9[_0x1ceb5a(0x2c6)])[_0x1ceb5a(0x2e9)](Boolean))];return _0x31bf7b[_0x1ceb5a(0x24f)]();}}return[];}catch(_0x52b6ec){return this[_0x1ceb5a(0x324)][_0x1ceb5a(0x241)](_0x1ceb5a(0x1e1)+_0x52b6ec[_0x1ceb5a(0x2be)]),[];}}async[a0_0xba881a(0x279)](){const _0x5d7621=a0_0xba881a;try{const _0x33156c=this[_0x5d7621(0x21a)]['presenceDevices']||[];let _0x29e7cf=![];for(const _0x291e73 of _0x33156c){try{const _0x46ce51=await this['getForeignStateAsync'](_0x291e73);if(_0x46ce51&&(_0x46ce51[_0x5d7621(0x2a7)]===!![]||_0x46ce51[_0x5d7621(0x2a7)]===_0x5d7621(0x325)||_0x46ce51['val']===0x1)){_0x29e7cf=!![];break;}}catch(_0x295ff8){}}return _0x29e7cf&&(this[_0x5d7621(0x233)]&&(this[_0x5d7621(0x324)]['info'](_0x5d7621(0x2b2)),this['abortExitTimer']()),!this[_0x5d7621(0x250)]&&this[_0x5d7621(0x245)]===SYSTEM_MODES['NORMAL']&&await this[_0x5d7621(0x1da)](!![])),_0x29e7cf;}catch(_0xacb71a){return this[_0x5d7621(0x324)][_0x5d7621(0x241)]('Error\x20checking\x20WiFi:\x20'+_0xacb71a[_0x5d7621(0x2be)]),![];}}[a0_0xba881a(0x252)](){const _0x2115cd=a0_0xba881a;this[_0x2115cd(0x1f8)](),this[_0x2115cd(0x309)]=!![],this[_0x2115cd(0x310)]=setTimeout(()=>{const _0x24cf8b=_0x2115cd;this[_0x24cf8b(0x309)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x2115cd(0x233)]=setTimeout(()=>{const _0xbec688=_0x2115cd;this[_0xbec688(0x1da)](![]),this[_0xbec688(0x233)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}['abortExitTimer'](){const _0x4ec83a=a0_0xba881a;if(this[_0x4ec83a(0x233)])clearTimeout(this[_0x4ec83a(0x233)]);if(this[_0x4ec83a(0x310)])clearTimeout(this[_0x4ec83a(0x310)]);this[_0x4ec83a(0x233)]=null,this[_0x4ec83a(0x310)]=null,this[_0x4ec83a(0x309)]=![];}async[a0_0xba881a(0x1da)](_0x5b51e8){const _0x49515d=a0_0xba881a;if(this[_0x49515d(0x250)]===_0x5b51e8)return;this[_0x49515d(0x250)]=_0x5b51e8,await this[_0x49515d(0x1d3)](_0x49515d(0x27b),{'val':_0x5b51e8,'ack':!![]});}async['saveFeedback'](_0x5962af){const _0x4b2e67=a0_0xba881a;this[_0x4b2e67(0x324)]['info'](_0x4b2e67(0x2ed)+JSON[_0x4b2e67(0x314)](_0x5962af));}async[a0_0xba881a(0x2ca)](){const _0x58764e=a0_0xba881a;if(!this[_0x58764e(0x1fd)]||!this[_0x58764e(0x2f4)])return;const _0x467b53=this['config']['ltmStbWindowDays']||0xe;if(this[_0x58764e(0x2f9)][_0x58764e(0x1dc)]<_0x467b53+(this[_0x58764e(0x21a)][_0x58764e(0x23b)]||0x7)){await this[_0x58764e(0x1d3)](LTM_DP_DRIFT_STATUS,{'val':_0x58764e(0x2ec),'ack':!![]});return;}const _0x24452c=this['dailyDigests']['slice'](-_0x467b53),_0x4f6b0d=this[_0x58764e(0x2f9)][_0x58764e(0x1cf)](0x0,this[_0x58764e(0x2f9)]['length']-_0x467b53),_0x36e63e=_0x58764e(0x201)+JSON['stringify'](_0x4f6b0d)+_0x58764e(0x2b7)+JSON[_0x58764e(0x314)](_0x24452c);try{const _0x1e4108=await this['geminiModel'][_0x58764e(0x290)](_0x36e63e),_0x5946ce=JSON[_0x58764e(0x251)](_0x1e4108[_0x58764e(0x2e7)]['text']()[_0x58764e(0x2a2)](/```json|```/g,'')[_0x58764e(0x215)]());_0x5946ce['baselineDrift']&&(await this[_0x58764e(0x1d3)](LTM_DP_DRIFT_STATUS,{'val':_0x5946ce[_0x58764e(0x2c2)],'ack':!![]}),await this[_0x58764e(0x1d3)](LTM_DP_DRIFT_DETAILS,{'val':_0x5946ce[_0x58764e(0x282)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x3edc7f){}}[a0_0xba881a(0x28e)](){const _0x3a6902=a0_0xba881a;try{if(this['ltmJob'])this[_0x3a6902(0x269)][_0x3a6902(0x272)]();if(!this['isProVersion']){this[_0x3a6902(0x1d3)](LTM_DP_STATUS,{'val':_0x3a6902(0x1d9),'ack':!![]});return;}this['ltmJob']=schedule[_0x3a6902(0x2d5)](LTM_SCHEDULE,()=>this[_0x3a6902(0x270)]());}catch(_0x33c11c){this[_0x3a6902(0x324)][_0x3a6902(0x241)](_0x3a6902(0x2da)+_0x33c11c['message']);}}[a0_0xba881a(0x25b)](){const _0x14faae=a0_0xba881a;try{if(this['modeResetJob'])this[_0x14faae(0x236)][_0x14faae(0x272)]();this[_0x14faae(0x236)]=schedule[_0x14faae(0x2d5)](MODE_RESET_SCHEDULE,async()=>{const _0x4b48af=_0x14faae;await this[_0x4b48af(0x239)](),AUTO_RESET_MODES[_0x4b48af(0x1cd)](this[_0x4b48af(0x245)])&&await this[_0x4b48af(0x1d3)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x5dbfc0){this['log'][_0x14faae(0x241)](_0x14faae(0x327)+_0x5dbfc0[_0x14faae(0x2be)]);}}[a0_0xba881a(0x23d)](){const _0x54eefe=a0_0xba881a;try{if(this[_0x54eefe(0x212)])clearInterval(this[_0x54eefe(0x212)]);if(!this[_0x54eefe(0x1fd)])return;this[_0x54eefe(0x212)]=setInterval(()=>this[_0x54eefe(0x2ca)](),(this[_0x54eefe(0x21a)][_0x54eefe(0x1ea)]||0x18)*0x36ee80),setTimeout(()=>this[_0x54eefe(0x2ca)](),0x1388);}catch(_0x474d01){this[_0x54eefe(0x324)]['error']('Drift\x20Sched\x20Error:\x20'+_0x474d01['message']);}}['setupBriefingScheduler'](){const _0x468eeb=a0_0xba881a;try{if(this[_0x468eeb(0x2a8)])this[_0x468eeb(0x2a8)][_0x468eeb(0x272)]();if(!this[_0x468eeb(0x21a)][_0x468eeb(0x2a0)])return;const _0x4fa6c5=(this[_0x468eeb(0x21a)][_0x468eeb(0x26d)]||_0x468eeb(0x2e3))[_0x468eeb(0x260)](':'),_0x36b73c=parseInt(_0x4fa6c5[0x0])||0x8,_0x230e1f=parseInt(_0x4fa6c5[0x1])||0x0,_0x57ea50=_0x230e1f+'\x20'+_0x36b73c+_0x468eeb(0x1c7);this['log']['info'](_0x468eeb(0x31b)+_0x36b73c+':'+(_0x230e1f<0xa?'0'+_0x230e1f:_0x230e1f)),this[_0x468eeb(0x2a8)]=schedule[_0x468eeb(0x2d5)](_0x57ea50,()=>{this['sendMorningBriefing']();});}catch(_0x9282ac){this['log']['error'](_0x468eeb(0x2fa)+_0x9282ac[_0x468eeb(0x2be)]);}}async[a0_0xba881a(0x1ec)](_0x3a18e8,_0x1a2ade=![],_0x1fda5e=![]){const _0x3a39f6=a0_0xba881a;this['log'][_0x3a39f6(0x306)]((_0x1a2ade?_0x3a39f6(0x28a):'')+_0x3a39f6(0x24d)+_0x3a18e8+'\x22');const _0x4ec428=this[_0x3a39f6(0x21a)];let _0x2304c8=0x0;_0x4ec428[_0x3a39f6(0x2a4)]&&(await this[_0x3a39f6(0x305)](_0x4ec428['notifyTelegramInstance'],_0x3a39f6(0x1c8),{'text':_0x3a18e8,'user':_0x4ec428[_0x3a39f6(0x1f0)]}),_0x2304c8++);if(_0x4ec428[_0x3a39f6(0x225)]){let _0x4c7812={'message':_0x3a18e8,'title':_0x1fda5e?_0x3a39f6(0x2dd):_0x3a39f6(0x1cb),'priority':_0x1fda5e?0x2:0x1,'device':_0x4ec428[_0x3a39f6(0x21e)]};_0x1fda5e&&(_0x4c7812[_0x3a39f6(0x312)]=0x1e,_0x4c7812[_0x3a39f6(0x1f5)]=0xe10,_0x4c7812[_0x3a39f6(0x256)]=_0x3a39f6(0x2cc)),await this[_0x3a39f6(0x305)](_0x4ec428['notifyPushoverInstance'],_0x3a39f6(0x1c8),_0x4c7812),_0x2304c8++;}return _0x4ec428['notifyEmailEnabled']&&(await this[_0x3a39f6(0x305)](_0x4ec428['notifyEmailInstance'],_0x3a39f6(0x1c8),{'text':_0x3a18e8,'to':_0x4ec428['notifyEmailRecipient']}),_0x2304c8++),_0x2304c8;}}if(require[a0_0xba881a(0x31f)]!==module)module[a0_0xba881a(0x211)]=_0x414e5c=>new CogniLiving(_0x414e5c);else new CogniLiving();