const a0_0xbd2efa=a0_0x45af;(function(_0x55947f,_0x1c769f){const _0x11f206=a0_0x45af,_0x5cc836=_0x55947f();while(!![]){try{const _0x4e7a4d=-parseInt(_0x11f206(0x28d))/0x1+parseInt(_0x11f206(0x2fd))/0x2+parseInt(_0x11f206(0x2f6))/0x3+parseInt(_0x11f206(0x299))/0x4+parseInt(_0x11f206(0x295))/0x5*(parseInt(_0x11f206(0x28a))/0x6)+-parseInt(_0x11f206(0x2fe))/0x7*(parseInt(_0x11f206(0x2e1))/0x8)+-parseInt(_0x11f206(0x2da))/0x9;if(_0x4e7a4d===_0x1c769f)break;else _0x5cc836['push'](_0x5cc836['shift']());}catch(_0x2f0413){_0x5cc836['push'](_0x5cc836['shift']());}}}(a0_0x45ec,0xc879e));const a0_0x257266=(function(){let _0x458192=!![];return function(_0x6d0f9c,_0x193923){const _0x53993c=_0x458192?function(){const _0x59e67a=a0_0x45af;if(_0x193923){const _0x5ed113=_0x193923[_0x59e67a(0x2ed)](_0x6d0f9c,arguments);return _0x193923=null,_0x5ed113;}}:function(){};return _0x458192=![],_0x53993c;};}()),a0_0x3150ef=a0_0x257266(this,function(){const _0x15a81c=a0_0x45af;return a0_0x3150ef['toString']()[_0x15a81c(0x2d8)](_0x15a81c(0x287))[_0x15a81c(0x2f8)]()[_0x15a81c(0x263)](a0_0x3150ef)[_0x15a81c(0x2d8)](_0x15a81c(0x287));});a0_0x3150ef();'use strict';const utils=require(a0_0xbd2efa(0x232)),{GoogleGenerativeAI}=require(a0_0xbd2efa(0x2c5)),installer=require(a0_0xbd2efa(0x21a)),scanner=require(a0_0xbd2efa(0x2c2)),schedulers=require(a0_0xbd2efa(0x2b6)),topology=require(a0_0xbd2efa(0x200)),setup=require(a0_0xbd2efa(0x2dc)),recorder=require(a0_0xbd2efa(0x2d5)),pythonBridge=require(a0_0xbd2efa(0x2f3)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0xbd2efa(0x2e4)),automation=require(a0_0xbd2efa(0x296)),GEMINI_MODEL=a0_0xbd2efa(0x26d),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};function a0_0x45ec(){const _0x374c00=['presenceDevices','Gemini\x20AI\x20initialized.','error','sendTo','analysis.energy.insulationScore','values','subscribeForeignStatesAsync','analysis.training.triggerComfort','forEach','string','automation.triggerAction',')\x20-\x20Phase\x20D\x20(Forensic\x20Calibration)','analysis.energy.warmupTargets','getState','infrasoundLocked','ErklÃ¤rt\x20durch:\x20','abs','analysis.energy.rlPenalties','@iobroker/adapter-core','toFixed','activityLevel','Active\x20Calendar\x20Enforcements\x20(Locks)','analysis.automation.autoApply','subscribeForeignStates','triggerBriefing','Activity-Level','\x20Tage)','sendNotification','version','Party\x20Mode','OPTIMIZE_ENERGY','Heizung\x20kann\x20','Memory\x20Hydration\x20Failed:\x20','analysisInterval','createDailyDigest','runPythonHealthCheck','getLtmData','initZombies','processSensorEvent','Instanz\x20nicht\x20gefunden','INTERNAL','Fehler:\x20','geminiModel','executeAutomationAction','â¤ï¸\x20Auto-Heartbeat:\x20Aktualisiere\x20Gesundheits-Trends...','lastAlertState','add','getOutsideTemperatureNumeric','callback','currentSystemMode','testContext','onUnload','NextHours.Location_1.Day_1.current.symbol_desc','Keine\x20Sensor-AktivitÃ¤t','briefingJob','\x20hPa\x20(Limit:\x20','dependencyInstallInProgress','triggerDailyDigest','ðŸ§ \x20Memory\x20Protection:\x20Restoring\x20persisted\x20AI-Calculations\x20(preventing\x20\x27Cold\x20Start\x27\x20amnesia).','now','Notification\x20Test\x20Failed:\x20','getOverviewData','bind','simulateButler','door','text','analysis.energy.pinnForecast','constructor','thermostat','info','_calName','isPresent','useWeather','sensor.door','runBaselineDriftAnalysis','loadSystemMode','setPresence','models/gemini-flash-latest','warn','guest','getHours','SET_LEARNING_MODE','checkThermostats','ltmJob','rawEventLog','main','Gesendet','weatherunderground.0','infrasoundThreshold','cleanupGhostInterventions','VACATION','startService','analysis.health.todayVector','runAutopilot','ANALYZE_TREND','cancel','checkWifiPresence','ðŸš¨\x20DRUCKWELLEN-ALARM!\x20StÃ¤rke:\x20','Sensors\x20used\x20for\x20Gait\x20Analysis','location','motion','analysis.training.triggerTopology','dailyDigests','(((.+)+)+)+$','getStateAsync','analysis.health.gaitDebug','1832202aahwHB','Warm-Up\x20Target\x20Temps\x20(JSON)','Nuukanni\x20Security','84204IcuZHP','setObjectNotExistsAsync','Lernphase\x20(','subscribeStates','scanDevices','window','enum','times','20YHrvqe','./lib/automation','number','notifyTelegramInstance','4613328AGmxqS','split','PINN\x20AI\x20Forecast','klar','Current.WeatherText','triggerEnergyPrediction','Kein\x20Wetter-Adapter','driftAnalysisTimer','eventHistory','General\x20Activity\x20Trend\x20(%)','trackerHeartbeat','object','[Calibration]\x20Window\x20','handleInfrasound','[Infrasound]\x20Subscribing\x20to\x20external\x20sensor:\x20','analysis.energy.warmupTimes','ANOMALY\x20(Real\x20Threat?)','triggerGaitAnalysis','LTM.dailyDigests','response','analysis.training.triggerHealth','endsWith','Standard','infrasoundArmingId','isGracePeriodActive','.communicate.request','floor','getTime','{\x22default\x22:\x2021}','./lib/scheduler','push','SYSTEM_MODES','cogni-living','trackerEnabled','analysis.automation.description','stringify','isArray','NORMAL','join','type','telegram','./lib/scanner','json','setupLtmScheduler','@google/generative-ai','\x20min\x20ausbleiben.','length','system.presenceWho','common','ðŸ§ \x20Memory:\x20Cache\x20hydrated\x20with\x20','getGenerativeModel','role','TRAIN_HEALTH','isProVersion','clear','.system.mode','abortExitTimer','accuweather.0','protectAiMemory','checkLicense','./lib/recorder','analysis.training.status','pressureBuffer','search','SYSTEM_DP_MODE','31856832aNcLfh','party','./lib/setup','memoryCache','sunny','analysis.security.learningStatus','analysis.health.activityTrend','3104uzSNil','WiFi\x20Presence\x20detected.','entries','./lib/dead_man','sonn','setupDriftAnalysisScheduler','Keine\x20Antwort\x20von\x20Gemini','Verbunden','filter','includes','state','infrasoundSensorId','apply','Forensic\x20Infrasound\x20Log','minDaysForBaseline','Simulation\x20durch\x20Admin\x20(Test)','analysis.trigger','analysisHistory','./lib/python_bridge','generateContent','CALIB','4654185HbjDhN','unload','toString','exitTimer','Aktiv\x20(','apiKey','genAI','1373622nllOGn','3031mCvXwj','stopService','\x20hPa\x20(Threshold:\x20','from','resetRLPenalty','analysis.energy.activeEnforcements','isSolar','getMinutes','LTM.trainingData.sequences','ack','Active\x20Ventilation\x20Alerts','analysis.automation.targetId','lastTrackerEventTime','geminiApiKey','onReady','infrasoundEnabled','cogni-living\x20adapter\x20starting\x20(v','Sec-Training\x20started...','systemConfig','Verbindung\x20erfolgreich!','temperature','.data.table','val','LTM.triggerDailyDigest','devices','sources','\x20rooms\x20(preventing\x20Cold\x20Start\x20Amnesia).','TRACK_EVENT','analysis.topology.structure','Guest\x20Mode','monitorEnforcements','sensorLastValues','inactivityThresholdHours','runGeminiAnalysis','send','analysis.training.triggerSecurity','minutes_safe','application/json','TRAIN_SECURITY','TRAIN_COMFORT','dismissAutomation','notifyPushoverInstance','log','exports','analysis.energy.mpcActive','appendToLog','instance','getForeignObjectAsync','LTM.trainingData.thermodynamics','updateTopology','online','Warm-Up\x20Time\x20(Minutes\x20to\x20Target)','command','triggerInfrasoundCorrelation','updateTopologyMatrix','stateChange','find','exitGraceTimer','getForeignStateAsync','analysis.automation.triggerAction','ANALYZE_GAIT','parse','analysis.energy.warmupSources','analysis.automation.patternDetected','setState','Gait\x20Speed\x20Calculation\x20Proof','analysis.security.infrasoundLog','SET_TOPOLOGY','some','config','notifyTelegramEnabled','timestamp','system.mode','analyzeWindowOpening','daswetter.0','scores','message','updated','pop','analysis.training.triggerEnergy','scanForDevices','calendarInstance','./lib/topology','setStateAsync','slice','setHours','updateHealthVector','PYTHON_EXE','[Infrasound]\x20ðŸŸ¡\x20Debug-Mode:\x20Alarm\x20detected\x20but\x20suppressed\x20because\x20presence=true.','toLowerCase','testApiKey','namespace','\x27\x20wurde\x20manuell\x20vom\x20Benutzer\x20gelÃ¶scht.','getForeignObjectsAsync','sensor.window','updateLocation','forecast.current.weather','modeResetJob','Adapter','\x20hPa.\x20Einbruch\x20wahrscheinlich.','checkSolarCondition','[Forensics]\x20Save\x20failed:\x20','name','healthTrendInterval','LTM.rawEventLog','getCalendarNames','notifyPushoverEnabled','key','./lib/installer','sort','TRAIN_ENERGY','analysisTimer','[Infrasound]\x20ðŸš¨\x20ALARM\x20TRIGGERED!\x20Pressure\x20Wave:\x20','simulateEnergyMPC'];a0_0x45ec=function(){return _0x374c00;};return a0_0x45ec();}class CogniLiving extends utils[a0_0xbd2efa(0x210)]{constructor(_0x3a6288){const _0x17b589=a0_0xbd2efa;super({..._0x3a6288,'name':_0x17b589(0x2b9)}),this[_0x17b589(0x2a1)]=[],this[_0x17b589(0x2f2)]=[],this[_0x17b589(0x274)]=[],this[_0x17b589(0x286)]=[],this[_0x17b589(0x1cd)]={},this[_0x17b589(0x310)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x17b589(0x267)]=!![],this['exitTimer']=null,this[_0x17b589(0x1e7)]=null,this[_0x17b589(0x2b1)]=![],this[_0x17b589(0x2fc)]=null,this['geminiModel']=null,this[_0x17b589(0x251)]=setup[_0x17b589(0x2b8)][_0x17b589(0x2be)],this['isProVersion']=![],this[_0x17b589(0x24d)]=![],this[_0x17b589(0x21d)]=null,this['ltmJob']=null,this[_0x17b589(0x20f)]=null,this[_0x17b589(0x2a0)]=null,this[_0x17b589(0x256)]=null,this[_0x17b589(0x2a3)]=null,this['healthTrendInterval']=null,this[_0x17b589(0x258)]=![],this['lastTrackerEventTime']=Date[_0x17b589(0x25b)](),this[_0x17b589(0x2dd)]=null,this['bootTime']=Date['now'](),this[_0x17b589(0x22e)]=![],this[_0x17b589(0x2d7)]=[],this['on']('ready',this['onReady']['bind'](this)),this['on'](_0x17b589(0x1e5),this['onStateChange'][_0x17b589(0x25e)](this)),this['on'](_0x17b589(0x2f7),this[_0x17b589(0x253)]['bind'](this)),this['on'](_0x17b589(0x1fa),this['onMessage'][_0x17b589(0x25e)](this));}async[a0_0xbd2efa(0x30c)](){const _0x4cb75b=a0_0xbd2efa;this[_0x4cb75b(0x1d8)][_0x4cb75b(0x265)](_0x4cb75b(0x30e)+this[_0x4cb75b(0x23c)]+_0x4cb75b(0x22b));if(!installer['checkAndInstall'](this,()=>this['startSystem']()))return;}async['startSystem'](){const _0x4db421=a0_0xbd2efa;await setup[_0x4db421(0x245)](this);try{this[_0x4db421(0x2ce)]=await setup[_0x4db421(0x2d4)](this[_0x4db421(0x1f3)]['licenseKey']);}catch(_0x5ae4be){}if(!this[_0x4db421(0x1f3)][_0x4db421(0x1ce)]||this['config'][_0x4db421(0x1ce)]<0.1)this[_0x4db421(0x1f3)][_0x4db421(0x1ce)]=0xc;await setup['initHistory'](this),await setup['initSystemConfig'](this);try{const _0x3d1862=await this[_0x4db421(0x288)](_0x4db421(0x2a8)),_0x76c608=await this[_0x4db421(0x288)](_0x4db421(0x1ec));_0x3d1862&&_0x3d1862[_0x4db421(0x314)]&&_0x76c608&&_0x76c608['val']&&(Date[_0x4db421(0x25b)]()-_0x3d1862['ts']<0x4*0xe10*0x3e8&&(this['memoryCache']={'times':JSON[_0x4db421(0x1eb)](_0x3d1862[_0x4db421(0x314)]),'sources':JSON[_0x4db421(0x1eb)](_0x76c608[_0x4db421(0x314)])},this[_0x4db421(0x1d8)]['info'](_0x4db421(0x2ca)+Object['keys'](this[_0x4db421(0x2dd)][_0x4db421(0x294)])[_0x4db421(0x2c7)]+_0x4db421(0x318))));}catch(_0x112cb9){this[_0x4db421(0x1d8)][_0x4db421(0x26e)](_0x4db421(0x240)+_0x112cb9[_0x4db421(0x1fa)]);}if(this['config']['geminiApiKey'])try{this[_0x4db421(0x2fc)]=new GoogleGenerativeAI(this[_0x4db421(0x1f3)][_0x4db421(0x30b)]),this[_0x4db421(0x24a)]=this[_0x4db421(0x2fc)][_0x4db421(0x2cb)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x4db421(0x1d3)}}),this[_0x4db421(0x1d8)]['info'](_0x4db421(0x221));}catch(_0x56e943){this['log'][_0x4db421(0x222)]('Gemini\x20Init\x20Error:\x20'+_0x56e943[_0x4db421(0x1fa)]);}await setup['createAllObjects'](this),await this[_0x4db421(0x26b)](),await this[_0x4db421(0x28e)](_0x4db421(0x262),{'type':_0x4db421(0x2eb),'common':{'name':_0x4db421(0x29b),'type':_0x4db421(0x229),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x4db421(0x28e)]('analysis.energy.ventilationAlerts',{'type':_0x4db421(0x2eb),'common':{'name':_0x4db421(0x308),'type':_0x4db421(0x229),'role':_0x4db421(0x2c3),'read':!![],'write':![]},'native':{}}),await this[_0x4db421(0x28e)](_0x4db421(0x2a8),{'type':_0x4db421(0x2eb),'common':{'name':_0x4db421(0x1e1),'type':_0x4db421(0x229),'role':_0x4db421(0x2c3),'read':!![],'write':![]},'native':{}}),await this[_0x4db421(0x28e)](_0x4db421(0x22c),{'type':_0x4db421(0x2eb),'common':{'name':_0x4db421(0x28b),'type':_0x4db421(0x229),'role':_0x4db421(0x2c3),'read':!![],'write':!![],'def':_0x4db421(0x2b5)},'native':{}}),await this[_0x4db421(0x28e)](_0x4db421(0x231),{'type':'state','common':{'name':'Reinforcement\x20Learning\x20Penalties','type':'string','role':'json','read':!![],'write':![],'def':'{}'},'native':{}}),await this['setObjectNotExistsAsync'](_0x4db421(0x2e0),{'type':'state','common':{'name':_0x4db421(0x2a2),'type':_0x4db421(0x297),'role':'value','unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.health.gaitSensors',{'type':_0x4db421(0x2eb),'common':{'name':_0x4db421(0x282),'type':_0x4db421(0x229),'role':_0x4db421(0x261),'read':!![],'write':![]},'native':{}}),await this[_0x4db421(0x28e)](_0x4db421(0x303),{'type':_0x4db421(0x2eb),'common':{'name':_0x4db421(0x235),'type':_0x4db421(0x229),'role':_0x4db421(0x2c3),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x4db421(0x1f0),{'type':_0x4db421(0x2eb),'common':{'name':_0x4db421(0x2ee),'type':_0x4db421(0x229),'role':_0x4db421(0x2c3),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x4db421(0x28e)](_0x4db421(0x289),{'type':_0x4db421(0x2eb),'common':{'name':_0x4db421(0x1ef),'type':_0x4db421(0x229),'role':_0x4db421(0x261),'read':!![],'write':![]},'native':{}});try{const _0x53eb23=await this[_0x4db421(0x288)](_0x4db421(0x216));if(_0x53eb23&&_0x53eb23[_0x4db421(0x314)])this[_0x4db421(0x274)]=JSON['parse'](_0x53eb23[_0x4db421(0x314)]);}catch(_0x21438e){this[_0x4db421(0x274)]=[];}try{const _0x14a4ed=await this[_0x4db421(0x288)](_0x4db421(0x2ab));if(_0x14a4ed&&_0x14a4ed[_0x4db421(0x314)])this[_0x4db421(0x286)]=JSON[_0x4db421(0x1eb)](_0x14a4ed['val']);}catch(_0x201005){this[_0x4db421(0x286)]=[];}const _0x46dd2b=this[_0x4db421(0x286)][_0x4db421(0x2c7)]>=(this[_0x4db421(0x1f3)][_0x4db421(0x2ef)]||0x7)?_0x4db421(0x2fa)+this['dailyDigests'][_0x4db421(0x2c7)]+_0x4db421(0x23a):_0x4db421(0x28f)+this[_0x4db421(0x286)][_0x4db421(0x2c7)]+'/'+(this['config'][_0x4db421(0x2ef)]||0x7)+')';await this[_0x4db421(0x201)]('LTM.baselineStatus',{'val':_0x46dd2b,'ack':!![]}),this[_0x4db421(0x290)](_0x4db421(0x2f1)),this['subscribeStates'](_0x4db421(0x315)),this['subscribeStates'](_0x4db421(0x1f6)),this[_0x4db421(0x290)]('analysis.triggerBriefing'),this[_0x4db421(0x290)](_0x4db421(0x1e9)),this['subscribeStates'](_0x4db421(0x236)),this[_0x4db421(0x290)]('analysis.training.triggerSecurity'),this[_0x4db421(0x290)](_0x4db421(0x2ad)),this[_0x4db421(0x290)](_0x4db421(0x1fd)),this['subscribeStates'](_0x4db421(0x227)),this[_0x4db421(0x290)]('analysis.training.triggerTopology'),this['subscribeStates'](_0x4db421(0x1da)),this['subscribeStates'](_0x4db421(0x1ec));this[_0x4db421(0x1f3)]['infrasoundEnabled']&&this[_0x4db421(0x1f3)][_0x4db421(0x2ec)]&&(this[_0x4db421(0x1d8)][_0x4db421(0x265)](_0x4db421(0x2a7)+this[_0x4db421(0x1f3)][_0x4db421(0x2ec)]),this[_0x4db421(0x237)](this['config'][_0x4db421(0x2ec)]));const _0x540b79=this[_0x4db421(0x1f3)]['devices'];if(_0x540b79)for(const _0x5edce4 of _0x540b79){await this[_0x4db421(0x226)](_0x5edce4['id']);}const _0x207406=this['config'][_0x4db421(0x220)];if(_0x207406)for(const _0x354740 of _0x207406){await this[_0x4db421(0x226)](_0x354740);}if(this[_0x4db421(0x1f3)][_0x4db421(0x1f4)]&&this[_0x4db421(0x1f3)]['notifyTelegramInstance'])await this[_0x4db421(0x226)](this[_0x4db421(0x1f3)][_0x4db421(0x298)]+_0x4db421(0x2b2));setTimeout(()=>this[_0x4db421(0x280)](),0x1388);if(this[_0x4db421(0x21d)])clearInterval(this[_0x4db421(0x21d)]);const _0x1e5342=this['config'][_0x4db421(0x241)]||0xf;_0x1e5342>0x0&&(this[_0x4db421(0x21d)]=setInterval(()=>{const _0x18395d=_0x4db421;this[_0x18395d(0x27d)](),automation['checkCalendarTriggers'](this),automation[_0x18395d(0x1cc)](this);},_0x1e5342*0x3c*0x3e8));setTimeout(()=>{const _0x59d3c8=_0x4db421;automation['checkCalendarTriggers'](this),automation[_0x59d3c8(0x1cc)](this);},0x2710);this[_0x4db421(0x1f3)][_0x4db421(0x2ba)]!==![]&&(this['trackerHeartbeat']=setInterval(()=>{const _0x499efc=_0x4db421;if(this[_0x499efc(0x2ce)]){const _0x51496a=Date[_0x499efc(0x25b)](),_0x5710a3=this[_0x499efc(0x30a)]||_0x51496a,_0x586f4e=(_0x51496a-_0x5710a3)/0x3e8;_0x586f4e>0x2&&(this[_0x499efc(0x30a)]=_0x51496a,pythonBridge[_0x499efc(0x1d0)](this,_0x499efc(0x319),{'room':null,'dt':_0x586f4e}));}},0xbb8));if(this[_0x4db421(0x215)])clearInterval(this[_0x4db421(0x215)]);this[_0x4db421(0x215)]=setInterval(()=>{const _0x13e7c5=_0x4db421;this[_0x13e7c5(0x2ce)]&&(this[_0x13e7c5(0x1d8)][_0x13e7c5(0x265)](_0x13e7c5(0x24c)),this[_0x13e7c5(0x243)]());},0x4*0x3c*0x3c*0x3e8),schedulers[_0x4db421(0x2c4)](this,()=>aiAgent[_0x4db421(0x242)](this,pythonBridge)),schedulers['setupModeResetScheduler'](this),schedulers[_0x4db421(0x2e6)](this,()=>aiAgent[_0x4db421(0x26a)](this)),schedulers['setupBriefingScheduler'](this,()=>aiAgent['sendMorningBriefing'](this)),pythonBridge[_0x4db421(0x27b)](this,installer[_0x4db421(0x205)]),setTimeout(async()=>{const _0x39752c=_0x4db421;await topology['updateTopology'](this);try{const _0x276a8b=await this['getStateAsync'](_0x39752c(0x31a));if(_0x276a8b&&_0x276a8b[_0x39752c(0x314)])pythonBridge[_0x39752c(0x1d0)](this,_0x39752c(0x1f1),JSON[_0x39752c(0x1eb)](_0x276a8b['val']));}catch(_0x36ef91){}this[_0x39752c(0x243)](),this[_0x39752c(0x2aa)](),this[_0x39752c(0x29e)](),this['updateHealthVector']();},0x1388);}[a0_0xbd2efa(0x253)](_0x28345d){const _0x361929=a0_0xbd2efa;if(this[_0x361929(0x21d)])clearInterval(this[_0x361929(0x21d)]);if(this[_0x361929(0x2a0)])clearInterval(this[_0x361929(0x2a0)]);if(this[_0x361929(0x2a3)])clearInterval(this[_0x361929(0x2a3)]);if(this[_0x361929(0x215)])clearInterval(this[_0x361929(0x215)]);if(this[_0x361929(0x273)])this[_0x361929(0x273)][_0x361929(0x27f)]();if(this[_0x361929(0x20f)])this[_0x361929(0x20f)][_0x361929(0x27f)]();if(this[_0x361929(0x256)])this[_0x361929(0x256)]['cancel']();recorder[_0x361929(0x2d1)](this),pythonBridge[_0x361929(0x2ff)](this),_0x28345d();}async['onStateChange'](_0x5302f7,_0x2c0597){const _0x1edff4=a0_0xbd2efa;if(!_0x2c0597||this[_0x1edff4(0x258)])return;if(_0x5302f7['includes'](_0x1edff4(0x2c1))&&_0x5302f7[_0x1edff4(0x2ae)]('communicate.request')&&_0x2c0597[_0x1edff4(0x314)])return;if(this[_0x1edff4(0x1f3)][_0x1edff4(0x30d)]&&_0x5302f7===this[_0x1edff4(0x1f3)][_0x1edff4(0x2ec)]){this[_0x1edff4(0x2a6)](_0x2c0597[_0x1edff4(0x314)]);return;}if(_0x5302f7===this[_0x1edff4(0x209)]+_0x1edff4(0x2d0)){if(_0x2c0597[_0x1edff4(0x314)]&&Object[_0x1edff4(0x225)](setup[_0x1edff4(0x2b8)])[_0x1edff4(0x2ea)](_0x2c0597[_0x1edff4(0x314)])){this[_0x1edff4(0x251)]=_0x2c0597[_0x1edff4(0x314)];if(_0x2c0597[_0x1edff4(0x314)]===setup['SYSTEM_MODES'][_0x1edff4(0x27a)])await recorder[_0x1edff4(0x26c)](this,![]);else await recorder[_0x1edff4(0x26c)](this,!![]);if(this[_0x1edff4(0x2ce)]){let _0x14856d=![],_0x26c971=0x0,_0x137707='manual';if(this[_0x1edff4(0x251)]===_0x1edff4(0x2db))_0x14856d=!![],_0x26c971=0x168,_0x137707=_0x1edff4(0x23d);else this[_0x1edff4(0x251)]===_0x1edff4(0x26f)&&(_0x14856d=!![],_0x26c971=0x5a0,_0x137707=_0x1edff4(0x1cb));pythonBridge[_0x1edff4(0x1d0)](this,_0x1edff4(0x271),{'active':_0x14856d,'duration':_0x26c971,'label':_0x137707}),await this[_0x1edff4(0x201)](_0x1edff4(0x2df),{'val':JSON[_0x1edff4(0x2bc)]({'active':_0x14856d,'label':_0x137707,'timestamp':Date[_0x1edff4(0x25b)]()}),'ack':!![]});}}if(!_0x2c0597[_0x1edff4(0x307)])this[_0x1edff4(0x1ee)](_0x5302f7,{'val':this['currentSystemMode'],'ack':!![]});return;}_0x5302f7[_0x1edff4(0x2ae)](_0x1edff4(0x1ec))&&_0x2c0597[_0x1edff4(0x307)]&&this[_0x1edff4(0x2d3)](_0x2c0597['val']);if(!_0x2c0597[_0x1edff4(0x307)]){if(_0x5302f7['includes'](_0x1edff4(0x2f1))&&_0x2c0597[_0x1edff4(0x314)]){this[_0x1edff4(0x1ee)](_0x5302f7,{'val':![],'ack':!![]}),aiAgent[_0x1edff4(0x1cf)](this);return;}if(_0x5302f7[_0x1edff4(0x2ea)](_0x1edff4(0x259))&&_0x2c0597[_0x1edff4(0x314)]){this['setState'](_0x5302f7,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent[_0x1edff4(0x242)](this,pythonBridge);return;}if(_0x5302f7['includes'](_0x1edff4(0x238))&&_0x2c0597[_0x1edff4(0x314)]){this[_0x1edff4(0x1ee)](_0x5302f7,{'val':![],'ack':!![]}),aiAgent['sendMorningBriefing'](this);return;}if(_0x5302f7[_0x1edff4(0x2ea)](_0x1edff4(0x22a))&&_0x2c0597[_0x1edff4(0x314)]){this[_0x1edff4(0x1ee)](_0x5302f7,{'val':![],'ack':!![]}),aiAgent[_0x1edff4(0x24b)](this);return;}if(_0x5302f7[_0x1edff4(0x2ea)](_0x1edff4(0x1d1))&&_0x2c0597[_0x1edff4(0x314)]){this[_0x1edff4(0x1ee)](_0x5302f7,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x21021c=await this[_0x1edff4(0x288)](_0x1edff4(0x306));if(_0x21021c&&_0x21021c[_0x1edff4(0x314)]){const _0x4bef74=JSON[_0x1edff4(0x1eb)](_0x21021c['val']);this[_0x1edff4(0x201)](_0x1edff4(0x2d6),{'val':_0x1edff4(0x30f),'ack':!![]}),pythonBridge['send'](this,_0x1edff4(0x1d4),{'sequences':_0x4bef74});}}catch(_0x2d7435){}return;}if(_0x5302f7['includes']('analysis.training.triggerHealth')&&_0x2c0597['val']){this[_0x1edff4(0x1ee)](_0x5302f7,{'val':![],'ack':!![]});if(this[_0x1edff4(0x2ce)])try{const _0x395825=await this['getStateAsync'](_0x1edff4(0x2ab));if(_0x395825&&_0x395825[_0x1edff4(0x314)])pythonBridge[_0x1edff4(0x1d0)](this,_0x1edff4(0x2cd),{'digests':JSON[_0x1edff4(0x1eb)](_0x395825[_0x1edff4(0x314)])});}catch(_0x6927fb){}return;}if(_0x5302f7['includes']('analysis.training.triggerEnergy')&&_0x2c0597['val']){this[_0x1edff4(0x1ee)](_0x5302f7,{'val':![],'ack':!![]});if(this[_0x1edff4(0x2ce)])try{const _0x5999e7=await this[_0x1edff4(0x288)](_0x1edff4(0x1de));if(_0x5999e7&&_0x5999e7[_0x1edff4(0x314)])pythonBridge[_0x1edff4(0x1d0)](this,_0x1edff4(0x21c),{'points':JSON[_0x1edff4(0x1eb)](_0x5999e7[_0x1edff4(0x314)])});}catch(_0x306f07){}return;}if(_0x5302f7[_0x1edff4(0x2ea)](_0x1edff4(0x227))&&_0x2c0597['val']){this[_0x1edff4(0x1ee)](_0x5302f7,{'val':![],'ack':!![]});if(this[_0x1edff4(0x2ce)])try{const _0x1510b1=await this[_0x1edff4(0x288)](_0x1edff4(0x216));if(_0x1510b1&&_0x1510b1['val'])pythonBridge[_0x1edff4(0x1d0)](this,_0x1edff4(0x1d5),{'events':JSON[_0x1edff4(0x1eb)](_0x1510b1['val'])});}catch(_0x3ef827){}return;}if(_0x5302f7[_0x1edff4(0x2ea)](_0x1edff4(0x285))&&_0x2c0597[_0x1edff4(0x314)]){this[_0x1edff4(0x1ee)](_0x5302f7,{'val':![],'ack':!![]}),topology[_0x1edff4(0x1df)](this);return;}}if(this['config'][_0x1edff4(0x220)]&&this['config'][_0x1edff4(0x220)][_0x1edff4(0x2ea)](_0x5302f7)){await this[_0x1edff4(0x280)]();return;}const _0x5734f2=(this['config'][_0x1edff4(0x316)]||[])[_0x1edff4(0x1e6)](_0x4f951a=>_0x4f951a['id']===_0x5302f7);if(_0x5734f2){const _0x40f460=await recorder[_0x1edff4(0x246)](this,_0x5302f7,_0x2c0597,_0x5734f2);_0x40f460&&_0x40f460['type']===_0x1edff4(0x284)&&_0x40f460[_0x1edff4(0x283)]&&this[_0x1edff4(0x2ce)]&&deadMan[_0x1edff4(0x20d)](this,_0x40f460[_0x1edff4(0x283)]),_0x2c0597[_0x1edff4(0x314)]&&(_0x2c0597[_0x1edff4(0x314)]===!![]||_0x2c0597['val']===0x1||String(_0x2c0597['val'])[_0x1edff4(0x207)]()==='open')&&(_0x5734f2[_0x1edff4(0x2c0)]&&(_0x5734f2[_0x1edff4(0x2c0)]['includes'](_0x1edff4(0x292))||_0x5734f2['type']['includes'](_0x1edff4(0x260))||_0x5734f2['type'][_0x1edff4(0x2ea)]('magnet'))&&this['analyzeWindowOpening'](_0x5734f2)),(_0x5734f2[_0x1edff4(0x2c0)]===_0x1edff4(0x312)||_0x5734f2['type']===_0x1edff4(0x264))&&automation[_0x1edff4(0x279)](this);}}async[a0_0xbd2efa(0x2d3)](_0x5476b9){const _0x1e62dc=a0_0xbd2efa;if(!this['memoryCache']||Date[_0x1e62dc(0x25b)]()-this['bootTime']>0x493e0)return;if(!this[_0x1e62dc(0x2dd)][_0x1e62dc(0x317)]||!this[_0x1e62dc(0x2dd)][_0x1e62dc(0x294)])return;try{const _0x1f0c85=JSON[_0x1e62dc(0x1eb)](_0x5476b9),_0x50a0ac=this[_0x1e62dc(0x2dd)]['sources'];let _0x302ef5=![];for(const _0x51bf8d in _0x50a0ac){if(_0x50a0ac[_0x51bf8d][_0x1e62dc(0x2ea)]('AI')&&_0x1f0c85[_0x51bf8d]&&!_0x1f0c85[_0x51bf8d]['includes']('AI')){_0x302ef5=!![];break;}}_0x302ef5&&(this[_0x1e62dc(0x1d8)][_0x1e62dc(0x265)](_0x1e62dc(0x25a)),await this[_0x1e62dc(0x201)](_0x1e62dc(0x2a8),{'val':JSON[_0x1e62dc(0x2bc)](this[_0x1e62dc(0x2dd)]['times']),'ack':!![]}),await this['setStateAsync']('analysis.energy.warmupSources',{'val':JSON[_0x1e62dc(0x2bc)](this[_0x1e62dc(0x2dd)][_0x1e62dc(0x317)]),'ack':!![]}));}catch(_0x81fce5){}}async['onMessage'](_0x1336df){const _0x138513=a0_0xbd2efa;if(typeof _0x1336df===_0x138513(0x2a4)&&_0x1336df['message']){if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x272))try{const _0x1e58dd=await automation['scanThermostats'](this);this[_0x138513(0x223)](_0x1336df['from'],_0x1336df['command'],{'success':!![],'results':_0x1e58dd},_0x1336df[_0x138513(0x250)]);}catch(_0x4f8f8f){this[_0x138513(0x223)](_0x1336df['from'],_0x1336df[_0x138513(0x1e2)],{'success':![],'error':_0x4f8f8f['message']},_0x1336df[_0x138513(0x250)]);}else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x21f))try{const {current_temps:_0x1ca6e,t_out:_0xd04244,targets:_0x46f64c,t_forecast:_0x8339c3}=_0x1336df[_0x138513(0x1fa)],_0x5e95b8=[];let _0x8176b7={};try{const _0x254981=await this[_0x138513(0x288)](_0x138513(0x224));if(_0x254981&&_0x254981['val']){const _0x45f30f=JSON['parse'](_0x254981[_0x138513(0x314)]);_0x8176b7=_0x45f30f[_0x138513(0x1f9)]||_0x45f30f;}}catch(_0xf52d7c){}const _0x109b01=_0x8339c3!==undefined&&_0x8339c3!==null?(_0xd04244+_0x8339c3)/0x2:_0xd04244;for(const [_0xf89dae,_0x36147c]of Object[_0x138513(0x2e3)](_0x1ca6e)){const _0x390738=_0x46f64c[_0xf89dae]||0x15;if(_0x36147c<=_0x390738)continue;let _0x1318eb=_0x8176b7[_0xf89dae]||-0.5;if(_0x1318eb>=0x0)_0x1318eb=-0.5;const _0x2398ca=Math[_0x138513(0x230)](_0x1318eb),_0x55da68=_0x36147c-_0x390738;let _0x72659b=Math[_0x138513(0x2b3)](_0x55da68/_0x2398ca*0x3c);const _0x3ad724=_0x36147c-_0xd04244,_0x15dc67=_0x36147c-_0x109b01;if(_0x15dc67!==0x0&&_0x3ad724!==0x0){const _0x121aef=_0x3ad724/_0x15dc67;_0x72659b=Math['floor'](_0x72659b*_0x121aef);}if(_0x72659b>0xf){if(_0x72659b>0xf0)_0x72659b=0xf0;_0x5e95b8[_0x138513(0x2b7)]({'room':_0xf89dae,'minutes_safe':_0x72659b,'target':_0x390738,'current':_0x36147c,'savings_msg':_0x138513(0x23f)+_0x72659b+_0x138513(0x2c6)});}}_0x5e95b8[_0x138513(0x21b)]((_0x37bee0,_0x477373)=>_0x477373[_0x138513(0x1d2)]-_0x37bee0[_0x138513(0x1d2)]),this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![],'proposals':_0x5e95b8},_0x1336df['callback']);}catch(_0x3d5ea9){this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':![],'error':_0x3d5ea9['message']},_0x1336df[_0x138513(0x250)]);}else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x302))try{const _0x48b9ab=_0x1336df['message'][_0x138513(0x219)],_0x1189ed=_0x138513(0x231),_0x20b8e3=await this[_0x138513(0x288)](_0x1189ed);let _0xbd3dac={};if(_0x20b8e3&&_0x20b8e3['val'])try{_0xbd3dac=JSON['parse'](_0x20b8e3['val']);}catch(_0x56d772){}_0x48b9ab&&_0xbd3dac[_0x48b9ab]?(delete _0xbd3dac[_0x48b9ab],await this[_0x138513(0x201)](_0x1189ed,{'val':JSON['stringify'](_0xbd3dac),'ack':!![]}),this[_0x138513(0x1d8)][_0x138513(0x265)]('ðŸŽ“\x20[RL-RESET]\x20Lern-Sperre\x20(Penalty)\x20fÃ¼r\x20\x27'+_0x48b9ab+_0x138513(0x20a)),this[_0x138513(0x223)](_0x1336df['from'],_0x1336df[_0x138513(0x1e2)],{'success':!![]},_0x1336df['callback'])):this[_0x138513(0x223)](_0x1336df['from'],_0x1336df['command'],{'success':![],'error':'Key\x20not\x20found\x20or\x20not\x20provided'},_0x1336df['callback']);}catch(_0x34d844){this[_0x138513(0x223)](_0x1336df['from'],_0x1336df[_0x138513(0x1e2)],{'success':![],'error':_0x34d844[_0x138513(0x1fa)]},_0x1336df[_0x138513(0x250)]);}else{if(_0x1336df['command']===_0x138513(0x1d6))await this[_0x138513(0x201)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this['setStateAsync'](_0x138513(0x2bb),{'val':'','ack':!![]}),await this[_0x138513(0x201)](_0x138513(0x309),{'val':'','ack':!![]}),this['sendTo'](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![]},_0x1336df[_0x138513(0x250)]);else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x25f)){const {targetId:_0x5b7766,targetValue:_0x41751c}=_0x1336df[_0x138513(0x1fa)];await this[_0x138513(0x201)](_0x138513(0x1ed),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x138513(0x2bb),{'val':_0x138513(0x2f0),'ack':!![]}),await this[_0x138513(0x201)](_0x138513(0x309),{'val':_0x5b7766,'ack':!![]}),await this[_0x138513(0x201)]('analysis.automation.targetValue',{'val':String(_0x41751c),'ack':!![]}),this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![]},_0x1336df['callback']);}else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x208))try{const _0x10d362=_0x1336df[_0x138513(0x1fa)][_0x138513(0x2fb)];if(!_0x10d362)throw new Error('Kein\x20API\x20Key\x20Ã¼bergeben');const _0x5a6f0b=new GoogleGenerativeAI(_0x10d362),_0x5c6e9d=_0x5a6f0b[_0x138513(0x2cb)]({'model':GEMINI_MODEL}),_0x5091f9=await _0x5c6e9d[_0x138513(0x2f4)]('Test'),_0x2fdc9b=await _0x5091f9[_0x138513(0x2ac)];if(_0x2fdc9b[_0x138513(0x261)]())this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![],'message':_0x138513(0x311)},_0x1336df[_0x138513(0x250)]);else throw new Error(_0x138513(0x2e7));}catch(_0x5554aa){this[_0x138513(0x223)](_0x1336df['from'],_0x1336df['command'],{'success':![],'message':_0x5554aa[_0x138513(0x1fa)]},_0x1336df['callback']);}else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x291))try{const _0x2e0cf5=await scanner[_0x138513(0x1fe)](this,_0x1336df['message']||{});this['sendTo'](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![],'devices':_0x2e0cf5},_0x1336df['callback']);}catch(_0x47fad){this[_0x138513(0x223)](_0x1336df['from'],_0x1336df['command'],{'success':![],'error':_0x47fad['message']},_0x1336df[_0x138513(0x250)]);}else{if(_0x1336df['command']===_0x138513(0x1e4))try{const {matrix:_0x2594aa}=_0x1336df[_0x138513(0x1fa)],_0x11cd26=await this[_0x138513(0x288)](_0x138513(0x31a));if(_0x11cd26&&_0x11cd26['val']){const _0x512c13=JSON[_0x138513(0x1eb)](_0x11cd26[_0x138513(0x314)]);_0x512c13['matrix']=_0x2594aa,_0x512c13[_0x138513(0x1fb)]=Date[_0x138513(0x25b)](),await this[_0x138513(0x201)](_0x138513(0x31a),{'val':JSON[_0x138513(0x2bc)](_0x512c13),'ack':!![]}),pythonBridge[_0x138513(0x1d0)](this,_0x138513(0x1f1),_0x512c13);}this[_0x138513(0x223)](_0x1336df['from'],_0x1336df[_0x138513(0x1e2)],{'success':!![]},_0x1336df[_0x138513(0x250)]);}catch(_0x4fb644){this[_0x138513(0x1d8)][_0x138513(0x222)](_0x4fb644);}else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x244))this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![],'dailyDigests':this['dailyDigests']||[],'analysisHistory':this[_0x138513(0x2f2)]||[]},_0x1336df[_0x138513(0x250)]);else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x25d)){const _0x54e8b9=this[_0x138513(0x286)][_0x138513(0x2c7)],_0x257161=new Array(0x18)['fill'](0x0),_0x2807d6=new Date()[_0x138513(0x203)](0x0,0x0,0x0,0x0);this['eventHistory']&&this[_0x138513(0x2a1)][_0x138513(0x228)](_0x19599c=>{const _0x2b7855=_0x138513;if(_0x19599c[_0x2b7855(0x1f5)]>=_0x2807d6){const _0x3070d4=new Date(_0x19599c['timestamp'])[_0x2b7855(0x270)]();if(_0x3070d4>=0x0&&_0x3070d4<0x18)_0x257161[_0x3070d4]++;}});let _0xf8f642=![],_0x489e25='',_0x5eb3ea='',_0x2803c1='';try{const _0x3a8c35=await this[_0x138513(0x288)]('analysis.automation.patternDetected');if(_0x3a8c35&&_0x3a8c35['val']){_0xf8f642=!![];const _0x464e0c=await this[_0x138513(0x288)](_0x138513(0x2bb));_0x489e25=_0x464e0c?_0x464e0c[_0x138513(0x314)]:'';const _0x3c744f=await this[_0x138513(0x288)](_0x138513(0x309));_0x5eb3ea=_0x3c744f?_0x3c744f['val']:'';const _0x3b8c89=await this['getStateAsync']('analysis.automation.targetValue');_0x2803c1=_0x3b8c89?_0x3b8c89['val']:'';}}catch(_0x329e00){}const _0x745550=await this[_0x138513(0x212)](),_0x8f879f=(this['config'][_0x138513(0x316)]||[])[_0x138513(0x1f2)](_0xb12c0b=>_0xb12c0b[_0x138513(0x304)]),_0x448377=_0x745550&&_0x8f879f;let _0x47d076='';try{const _0x1f073a=await this[_0x138513(0x288)](_0x138513(0x2c8));if(_0x1f073a&&_0x1f073a['val'])_0x47d076=_0x1f073a['val'];}catch(_0x37df43){}this['sendTo'](_0x1336df['from'],_0x1336df['command'],{'success':!![],'eventHistory':this[_0x138513(0x2a1)][_0x138513(0x202)](0x0,0xf),'stats':{'digestCount':_0x54e8b9,'isPresent':this[_0x138513(0x267)],'hourlyActivity':_0x257161,'solarActive':_0x448377,'presenceWho':_0x47d076},'automation':{'detected':_0xf8f642,'description':_0x489e25,'targetId':_0x5eb3ea,'targetValue':_0x2803c1}},_0x1336df['callback']);}else{if(_0x1336df[_0x138513(0x1e2)]==='getEnums'){const _0x5a43c2=await this[_0x138513(0x20b)]('enum.functions.*','enum'),_0x48e19d=[];if(_0x5a43c2)for(const _0xa1ff7 in _0x5a43c2){const _0x93a6da=_0x5a43c2[_0xa1ff7],_0x55f81a=(_0x93a6da['common']&&typeof _0x93a6da[_0x138513(0x2c9)][_0x138513(0x214)]==='object'?_0x93a6da['common'][_0x138513(0x214)]['de']:_0x93a6da[_0x138513(0x2c9)]['name'])||_0x93a6da[_0x138513(0x2c9)][_0x138513(0x214)];_0x48e19d[_0x138513(0x2b7)]({'id':_0xa1ff7,'name':_0x55f81a});}const _0x481ca4=await this[_0x138513(0x20b)]('enum.rooms.*',_0x138513(0x293)),_0x378034=[];if(_0x481ca4)for(const _0xd0c235 in _0x481ca4){const _0x323157=_0x481ca4[_0xd0c235],_0x3dc81c=(_0x323157[_0x138513(0x2c9)]&&typeof _0x323157[_0x138513(0x2c9)][_0x138513(0x214)]===_0x138513(0x2a4)?_0x323157[_0x138513(0x2c9)][_0x138513(0x214)]['de']:_0x323157[_0x138513(0x2c9)]['name'])||_0xd0c235[_0x138513(0x29a)]('.')[_0x138513(0x1fc)]();_0x378034[_0x138513(0x2b7)](_0x3dc81c);}this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df['command'],{'success':!![],'enums':_0x48e19d,'rooms':_0x378034},_0x1336df[_0x138513(0x250)]);}else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x252))try{let _0xa62d84=_0x138513(0x29f),_0x5440c9='Kein\x20Kalender-Adapter';if(this[_0x138513(0x1f3)][_0x138513(0x268)]){const _0x2efc83=await recorder['getOutsideTemperatureNumeric'](this);_0xa62d84=_0x2efc83!==null?_0x2efc83+'Â°C':'Daten\x20nicht\x20verfÃ¼gbar';}if(this['config']['calendarInstance']){const _0x37a5b9=await this[_0x138513(0x1dd)]('system.adapter.'+this[_0x138513(0x1f3)][_0x138513(0x1ff)]);_0x5440c9=_0x37a5b9?_0x138513(0x2e8):_0x138513(0x247);}this['sendTo'](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![],'weather':_0xa62d84,'calendar':_0x5440c9},_0x1336df[_0x138513(0x250)]);}catch(_0x53b939){this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':![],'error':_0x53b939['message']},_0x1336df[_0x138513(0x250)]);}else{if(_0x1336df[_0x138513(0x1e2)]===_0x138513(0x217))try{const _0x7c4c56=_0x1336df['message'][_0x138513(0x1dc)],_0x8551d6=await this[_0x138513(0x1e8)](_0x7c4c56+_0x138513(0x313));let _0x5ceb82=[];if(_0x8551d6&&_0x8551d6['val']){const _0x2a9d3e=JSON[_0x138513(0x1eb)](_0x8551d6['val']),_0x1436cf=new Set();Array[_0x138513(0x2bd)](_0x2a9d3e)&&_0x2a9d3e[_0x138513(0x228)](_0x127807=>{const _0x23117b=_0x138513;if(_0x127807[_0x23117b(0x266)])_0x1436cf[_0x23117b(0x24e)](_0x127807['_calName']);else{if(_0x127807['calendarName'])_0x1436cf[_0x23117b(0x24e)](_0x127807['calendarName']);}}),_0x5ceb82=Array[_0x138513(0x301)](_0x1436cf)[_0x138513(0x21b)]();}if(_0x5ceb82[_0x138513(0x2c7)]===0x0)_0x5ceb82=[_0x138513(0x2af)];this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![],'names':_0x5ceb82},_0x1336df[_0x138513(0x250)]);}catch(_0x22f73a){this['sendTo'](_0x1336df['from'],_0x1336df[_0x138513(0x1e2)],{'success':![],'error':_0x22f73a[_0x138513(0x1fa)]},_0x1336df[_0x138513(0x250)]);}else{if(_0x1336df['command']==='testNotification')try{await setup[_0x138513(0x23b)](this,'ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.',![],![]),this['sendTo'](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':!![],'message':_0x138513(0x276)},_0x1336df[_0x138513(0x250)]);}catch(_0x3153b9){this['log'][_0x138513(0x222)](_0x138513(0x25c)+_0x3153b9[_0x138513(0x1fa)]),this[_0x138513(0x223)](_0x1336df[_0x138513(0x301)],_0x1336df[_0x138513(0x1e2)],{'success':![],'message':_0x138513(0x249)+_0x3153b9['message']},_0x1336df['callback']);}}}}}}}}}}}}}}}}async[a0_0xbd2efa(0x26b)](){const _0x26bd62=a0_0xbd2efa;try{const _0x4b787b=await this[_0x26bd62(0x288)](setup[_0x26bd62(0x2d9)]);_0x4b787b&&_0x4b787b[_0x26bd62(0x314)]&&Object[_0x26bd62(0x225)](setup[_0x26bd62(0x2b8)])['includes'](_0x4b787b['val'])?this[_0x26bd62(0x251)]=_0x4b787b[_0x26bd62(0x314)]:(this[_0x26bd62(0x251)]=setup['SYSTEM_MODES'][_0x26bd62(0x2be)],await this[_0x26bd62(0x201)](setup[_0x26bd62(0x2d9)],{'val':setup[_0x26bd62(0x2b8)][_0x26bd62(0x2be)],'ack':!![]}));}catch(_0x436365){this[_0x26bd62(0x251)]=setup[_0x26bd62(0x2b8)]['NORMAL'];}}async[a0_0xbd2efa(0x280)](){const _0x2ee98f=a0_0xbd2efa;try{const _0x39c3a1=this[_0x2ee98f(0x1f3)]['presenceDevices']||[];let _0x26a94b=![];const _0x1119b7=[];for(const _0x2b18ed of _0x39c3a1){try{const _0x32a967=await this['getForeignStateAsync'](_0x2b18ed);_0x32a967&&(_0x32a967['val']===!![]||_0x32a967[_0x2ee98f(0x314)]===_0x2ee98f(0x1e0)||_0x32a967[_0x2ee98f(0x314)]===0x1)&&(_0x26a94b=!![],_0x1119b7[_0x2ee98f(0x2b7)](_0x2b18ed));}catch(_0x5172ed){}}return await this[_0x2ee98f(0x201)](_0x2ee98f(0x2c8),{'val':_0x1119b7[_0x2ee98f(0x2bf)](',\x20'),'ack':!![]}),_0x26a94b&&(this[_0x2ee98f(0x2f9)]&&(this[_0x2ee98f(0x1d8)][_0x2ee98f(0x265)](_0x2ee98f(0x2e2)),recorder[_0x2ee98f(0x2d1)](this)),!this['isPresent']&&this[_0x2ee98f(0x251)]===setup['SYSTEM_MODES'][_0x2ee98f(0x2be)]&&await recorder[_0x2ee98f(0x26c)](this,!![])),_0x26a94b;}catch(_0x1eafb8){return![];}}async['runAutopilot'](){const _0x55cb4b=a0_0xbd2efa;this[_0x55cb4b(0x1d8)]['debug']('ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...'),await aiAgent[_0x55cb4b(0x1cf)](this),this[_0x55cb4b(0x204)](),this[_0x55cb4b(0x2aa)](),this[_0x55cb4b(0x29e)]();}async[a0_0xbd2efa(0x212)](){const _0x5abfc3=a0_0xbd2efa,_0x5208de=[_0x5abfc3(0x277),_0x5abfc3(0x2d2),_0x5abfc3(0x1f8)],_0x1d8638=[_0x5abfc3(0x20e),_0x5abfc3(0x29d),_0x5abfc3(0x254)];for(const _0x5e22d3 of _0x5208de){for(const _0x4688c8 of _0x1d8638){try{const _0x3de9f1=_0x5e22d3+'.'+_0x4688c8,_0xf1cc4e=await this[_0x5abfc3(0x1e8)](_0x3de9f1);if(_0xf1cc4e&&_0xf1cc4e[_0x5abfc3(0x314)]){const _0x143341=String(_0xf1cc4e[_0x5abfc3(0x314)])[_0x5abfc3(0x207)]();if(_0x143341[_0x5abfc3(0x2ea)](_0x5abfc3(0x2e5))||_0x143341['includes'](_0x5abfc3(0x2de))||_0x143341[_0x5abfc3(0x2ea)](_0x5abfc3(0x29c))||_0x143341[_0x5abfc3(0x2ea)](_0x5abfc3(0x2cf))||_0x143341[_0x5abfc3(0x2ea)]('heiter'))return!![];}}catch(_0x5967cb){}}}return![];}[a0_0xbd2efa(0x2aa)](){const _0x5bd3f9=a0_0xbd2efa;if(!this['isProVersion'])return;try{this[_0x5bd3f9(0x22d)]('LTM.trainingData.sequences',(_0x596148,_0x3adf65)=>{const _0x595fc5=_0x5bd3f9;_0x3adf65&&_0x3adf65[_0x595fc5(0x314)]&&pythonBridge['send'](this,_0x595fc5(0x1ea),{'sequences':JSON[_0x595fc5(0x1eb)](_0x3adf65[_0x595fc5(0x314)])});});}catch(_0x4c74c3){}}async[a0_0xbd2efa(0x29e)](){const _0x2f5df9=a0_0xbd2efa;if(!this['isProVersion'])return;try{const _0x7d87d2=await recorder[_0x2f5df9(0x24f)](this);if(_0x7d87d2===null)return;const _0x143680={},_0x2c57c7={},_0x3713e1=this['config'][_0x2f5df9(0x316)]||[];for(const _0x1a16ed of _0x3713e1){if(_0x1a16ed['type']==='temperature'&&_0x1a16ed[_0x2f5df9(0x283)]){const _0x1bf23f=this[_0x2f5df9(0x1cd)][_0x1a16ed['id']];if(_0x1bf23f!==undefined)_0x143680[_0x1a16ed[_0x2f5df9(0x283)]]=_0x1bf23f;if(_0x1a16ed['isSolar'])_0x2c57c7[_0x1a16ed[_0x2f5df9(0x283)]]=!![];}}const _0x50bfaa=await this[_0x2f5df9(0x212)]();let _0x501988={};try{const _0xe3fbf3=await this[_0x2f5df9(0x288)](_0x2f5df9(0x22c));if(_0xe3fbf3&&_0xe3fbf3[_0x2f5df9(0x314)])_0x501988=JSON['parse'](_0xe3fbf3[_0x2f5df9(0x314)]);}catch(_0x4370ee){}Object['keys'](_0x143680)[_0x2f5df9(0x2c7)]>0x0&&(pythonBridge[_0x2f5df9(0x1d0)](this,'PREDICT_ENERGY',{'current_temps':_0x143680,'t_out':_0x7d87d2,'is_sunny':_0x50bfaa,'solar_flags':_0x2c57c7,'warmup_targets':_0x501988}),pythonBridge['send'](this,_0x2f5df9(0x23e),{'current_temps':_0x143680,'t_out':_0x7d87d2,'targets':{}}));}catch(_0x38fe2){}}[a0_0xbd2efa(0x204)](){const _0x44d21a=a0_0xbd2efa;if(!this[_0x44d21a(0x274)]||this[_0x44d21a(0x274)][_0x44d21a(0x2c7)]===0x0)return;const _0x34d3fb=new Array(0x60)['fill'](0x0),_0x44c518=new Date()['setHours'](0x0,0x0,0x0,0x0);this[_0x44d21a(0x274)][_0x44d21a(0x228)](_0x4ed5b0=>{const _0x36fd82=_0x44d21a,_0x19c1b1=new Date(_0x4ed5b0[_0x36fd82(0x1f5)]);if(_0x19c1b1[_0x36fd82(0x2b4)]()>=_0x44c518){const _0x1b1cd6=_0x19c1b1[_0x36fd82(0x270)](),_0x4dea3b=_0x19c1b1[_0x36fd82(0x305)](),_0x33b11a=_0x1b1cd6*0x4+Math[_0x36fd82(0x2b3)](_0x4dea3b/0xf);if(_0x33b11a>=0x0&&_0x33b11a<0x60)_0x34d3fb[_0x33b11a]++;}}),this[_0x44d21a(0x201)](_0x44d21a(0x27c),{'val':JSON['stringify'](_0x34d3fb),'ack':!![]});}[a0_0xbd2efa(0x243)](){const _0x3519c0=a0_0xbd2efa;if(!this[_0x3519c0(0x286)]||this[_0x3519c0(0x286)][_0x3519c0(0x2c7)]<0x2)return;const _0x41042e=this['dailyDigests']['map'](_0x5dda32=>{const _0x3a718a=_0x3519c0,_0x19a08f=(_0x5dda32[_0x3a718a(0x234)]||'')[_0x3a718a(0x207)]();return ACTIVITY_LEVEL_MAP[_0x19a08f]||0x32;});pythonBridge[_0x3519c0(0x1d0)](this,_0x3519c0(0x27e),{'values':_0x41042e,'tag':_0x3519c0(0x239)});}async[a0_0xbd2efa(0x2a6)](_0x1f49fb){const _0x269475=a0_0xbd2efa;if(_0x1f49fb==null||typeof _0x1f49fb!==_0x269475(0x297))return;const _0x115764=Date['now']();this[_0x269475(0x2d7)][_0x269475(0x2b7)]({'ts':_0x115764,'val':_0x1f49fb}),this[_0x269475(0x2d7)]=this[_0x269475(0x2d7)][_0x269475(0x2e9)](_0x893851=>_0x115764-_0x893851['ts']<0x1388);if(this[_0x269475(0x22e)])return;if(this['config'][_0x269475(0x2b0)]){const _0x44b683=await this[_0x269475(0x1e8)](this[_0x269475(0x1f3)]['infrasoundArmingId']);if(_0x44b683&&!_0x44b683[_0x269475(0x314)])return;}const _0x2e7492=this[_0x269475(0x1f3)][_0x269475(0x278)]||0.04;if(Math['abs'](_0x1f49fb)>=_0x2e7492){this['log']['warn'](_0x269475(0x21e)+_0x1f49fb+_0x269475(0x257)+_0x2e7492+')'),await this[_0x269475(0x201)]('security.alarm_triggered',{'val':!![],'ack':!![]});const _0xcf2148=this[_0x269475(0x267)];_0xcf2148?(this[_0x269475(0x1d8)][_0x269475(0x265)](_0x269475(0x206)),this[_0x269475(0x1e3)](_0x1f49fb,_0x269475(0x248))):(this[_0x269475(0x1e3)](_0x1f49fb,'ALARM'),this[_0x269475(0x23b)](_0x269475(0x281)+_0x1f49fb+_0x269475(0x211))),this[_0x269475(0x22e)]=!![],setTimeout(()=>{this['infrasoundLocked']=![];},0x2710);}}async[a0_0xbd2efa(0x1e3)](_0x5c56b1,_0x7c182f='ALARM'){const _0x59f6b4=a0_0xbd2efa,_0x17d7e1=Date[_0x59f6b4(0x25b)](),_0x2c5653=this['config'][_0x59f6b4(0x316)]||[];setTimeout(async()=>{const _0x365464=_0x59f6b4;let _0x556618=null,_0x47e4c6=_0x365464(0x255);const _0x1188e9=[],_0x246ebc=_0x2c5653[_0x365464(0x2e9)](_0x8ee2d5=>_0x8ee2d5[_0x365464(0x2c0)]&&(_0x8ee2d5['type'][_0x365464(0x2ea)](_0x365464(0x292))||_0x8ee2d5[_0x365464(0x2c0)][_0x365464(0x2ea)](_0x365464(0x260))||_0x8ee2d5['type'][_0x365464(0x2ea)]('magnet')||_0x8ee2d5[_0x365464(0x2c0)][_0x365464(0x2ea)]('reed'))||_0x8ee2d5['role']&&(_0x8ee2d5['role'][_0x365464(0x2ea)](_0x365464(0x20c))||_0x8ee2d5[_0x365464(0x2cc)][_0x365464(0x2ea)](_0x365464(0x269))));for(const _0x8f1a3a of _0x246ebc){try{const _0x487bc1=await this['getForeignStateAsync'](_0x8f1a3a['id']);if(_0x487bc1){if(_0x487bc1['ts']>=_0x17d7e1-0x7d0){_0x556618=_0x8f1a3a['name']||_0x8f1a3a['id'],_0x47e4c6=_0x365464(0x22f)+_0x556618;break;}}}catch(_0x147691){}}const _0xa13a56={'timestamp':_0x17d7e1,'pressure':_0x5c56b1,'isMatch':!!_0x556618,'explanation':_0x47e4c6,'type':_0x7c182f};await this[_0x365464(0x1db)](_0xa13a56),this[_0x365464(0x1d8)]['info']('[Forensics]\x20Infrasound\x20Event\x20correlated:\x20'+(!!_0x556618?'MATCH\x20(False\x20Positive)':_0x365464(0x2a9)));},0x1388);}async[a0_0xbd2efa(0x1f7)](_0x3c20ba){const _0x5e1ff3=Date['now'](),_0x47879b=_0x3c20ba['name']||_0x3c20ba['id']['split']('.')['pop']();let _0x29167d=0x0;setTimeout(async()=>{const _0x499f83=a0_0x45af;this[_0x499f83(0x2d7)][_0x499f83(0x228)](_0x2b5031=>{const _0x338a20=_0x499f83;_0x2b5031['ts']>=_0x5e1ff3-0xfa0&&_0x2b5031['ts']<=_0x5e1ff3+0x3e8&&(Math[_0x338a20(0x230)](_0x2b5031['val'])>Math[_0x338a20(0x230)](_0x29167d)&&(_0x29167d=_0x2b5031[_0x338a20(0x314)]));});const _0x276062=this[_0x499f83(0x1f3)][_0x499f83(0x278)]||0.04,_0x2e9e38=Math[_0x499f83(0x230)](_0x29167d)>=_0x276062,_0x1deb14={'timestamp':_0x5e1ff3,'pressure':_0x29167d,'isMatch':_0x2e9e38,'explanation':'Fenster\x20geÃ¶ffnet:\x20'+_0x47879b,'type':_0x499f83(0x2f5)};await this[_0x499f83(0x1db)](_0x1deb14),this[_0x499f83(0x1d8)]['debug'](_0x499f83(0x2a5)+_0x47879b+'\x20opened.\x20Peak\x20Pressure:\x20'+_0x29167d[_0x499f83(0x233)](0x4)+_0x499f83(0x300)+_0x276062+')');},0x1f4);}async[a0_0xbd2efa(0x1db)](_0x597da7){const _0x37053f=a0_0xbd2efa;try{const _0x32d79a=await this['getStateAsync'](_0x37053f(0x1f0));let _0x1ae493=[];if(_0x32d79a&&_0x32d79a['val'])_0x1ae493=JSON['parse'](_0x32d79a[_0x37053f(0x314)]);_0x1ae493['unshift'](_0x597da7);if(_0x1ae493[_0x37053f(0x2c7)]>0x14)_0x1ae493=_0x1ae493['slice'](0x0,0x14);await this[_0x37053f(0x201)](_0x37053f(0x1f0),{'val':JSON[_0x37053f(0x2bc)](_0x1ae493),'ack':!![]});}catch(_0x136ee0){this['log'][_0x37053f(0x222)](_0x37053f(0x213)+_0x136ee0[_0x37053f(0x1fa)]);}}[a0_0xbd2efa(0x23b)](_0x5e911e){const _0x4cc230=a0_0xbd2efa;this['config'][_0x4cc230(0x218)]&&this[_0x4cc230(0x1f3)][_0x4cc230(0x1d7)]&&this[_0x4cc230(0x223)](this[_0x4cc230(0x1f3)][_0x4cc230(0x1d7)],_0x4cc230(0x1d0),{'message':_0x5e911e,'title':_0x4cc230(0x28c),'priority':0x1}),this[_0x4cc230(0x1f3)][_0x4cc230(0x1f4)]&&this[_0x4cc230(0x1f3)][_0x4cc230(0x298)]&&this['sendTo'](this['config']['notifyTelegramInstance'],_0x4cc230(0x1d0),{'text':_0x5e911e});}}function a0_0x45af(_0x17e555,_0x58bc5d){const _0x27bf7b=a0_0x45ec();return a0_0x45af=function(_0x3150ef,_0x257266){_0x3150ef=_0x3150ef-0x1cb;let _0x45ec0e=_0x27bf7b[_0x3150ef];return _0x45ec0e;},a0_0x45af(_0x17e555,_0x58bc5d);}if(require[a0_0xbd2efa(0x275)]!==module)module[a0_0xbd2efa(0x1d9)]=_0x114da8=>new CogniLiving(_0x114da8);else new CogniLiving();