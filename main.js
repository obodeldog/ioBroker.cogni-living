const a0_0x40ed77=a0_0x2a0a;(function(_0x12ab02,_0x47d4ae){const _0x3fdc7d=a0_0x2a0a,_0x45d07e=_0x12ab02();while(!![]){try{const _0xe23e25=-parseInt(_0x3fdc7d(0x126))/0x1*(parseInt(_0x3fdc7d(0x193))/0x2)+-parseInt(_0x3fdc7d(0x23d))/0x3+parseInt(_0x3fdc7d(0x139))/0x4+-parseInt(_0x3fdc7d(0x1e4))/0x5+-parseInt(_0x3fdc7d(0x215))/0x6*(-parseInt(_0x3fdc7d(0xf7))/0x7)+parseInt(_0x3fdc7d(0x1ae))/0x8*(-parseInt(_0x3fdc7d(0x141))/0x9)+parseInt(_0x3fdc7d(0x1d9))/0xa*(parseInt(_0x3fdc7d(0x1d5))/0xb);if(_0xe23e25===_0x47d4ae)break;else _0x45d07e['push'](_0x45d07e['shift']());}catch(_0xba5d82){_0x45d07e['push'](_0x45d07e['shift']());}}}(a0_0x433d,0xea639));const a0_0x10c6b3=(function(){let _0x24d269=!![];return function(_0x1fe67c,_0x3d7f6c){const _0x98e97=_0x24d269?function(){if(_0x3d7f6c){const _0x42a3fe=_0x3d7f6c['apply'](_0x1fe67c,arguments);return _0x3d7f6c=null,_0x42a3fe;}}:function(){};return _0x24d269=![],_0x98e97;};}()),a0_0xa69170=a0_0x10c6b3(this,function(){const _0x51b00e=a0_0x2a0a;return a0_0xa69170['toString']()[_0x51b00e(0x16c)](_0x51b00e(0x18c))[_0x51b00e(0x11c)]()[_0x51b00e(0x224)](a0_0xa69170)['search']('(((.+)+)+)+$');});a0_0xa69170();'use strict';function a0_0x2a0a(_0x59a8bf,_0x4fbf9b){const _0x2bba5f=a0_0x433d();return a0_0x2a0a=function(_0xa69170,_0x10c6b3){_0xa69170=_0xa69170-0xef;let _0x433dd9=_0x2bba5f[_0xa69170];return _0x433dd9;},a0_0x2a0a(_0x59a8bf,_0x4fbf9b);}const utils=require(a0_0x40ed77(0x147)),{GoogleGenerativeAI}=require(a0_0x40ed77(0x167)),schedule=require(a0_0x40ed77(0x107)),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL=a0_0x40ed77(0x170),ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE=a0_0x40ed77(0x20e),LTM_DP_RAW_LOG=a0_0x40ed77(0x200),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x40ed77(0x15a),LTM_DP_TRIGGER_DIGEST=a0_0x40ed77(0x231),LTM_DP_BASELINE_STATUS=a0_0x40ed77(0x190),LTM_DP_DRIFT_CHANNEL=a0_0x40ed77(0x154),LTM_DP_DRIFT_STATUS=a0_0x40ed77(0x128),LTM_DP_DRIFT_DETAILS=a0_0x40ed77(0x14e),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x40ed77(0x1e7),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x40ed77(0xfd),'PARTY':a0_0x40ed77(0x117),'GUEST':a0_0x40ed77(0x175)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x40ed77(0x236)],SYSTEM_MODES[a0_0x40ed77(0x131)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x40ed77(0x1fe),'senior_aal':a0_0x40ed77(0x1fb),'family':a0_0x40ed77(0x1d8),'single_comfort':a0_0x40ed77(0x1eb),'security':a0_0x40ed77(0x18e)};class CogniLiving extends utils[a0_0x40ed77(0x133)]{constructor(_0x8a9876){const _0x3c76eb=a0_0x40ed77;super({..._0x8a9876,'name':_0x3c76eb(0x186)}),this[_0x3c76eb(0x12d)]=[],this[_0x3c76eb(0x1b8)]=[],this[_0x3c76eb(0x1f6)]=[],this[_0x3c76eb(0x17c)]=[],this['dailyDigests']=[],this[_0x3c76eb(0x1e0)]={},this[_0x3c76eb(0x149)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x3c76eb(0x1e2)]=!![],this['exitTimer']=null,this[_0x3c76eb(0x100)]=null,this[_0x3c76eb(0x104)]=![],this[_0x3c76eb(0x17a)]=null,this[_0x3c76eb(0x225)]=null,this[_0x3c76eb(0x14b)]=SYSTEM_MODES[_0x3c76eb(0x179)],this[_0x3c76eb(0x1ed)]=![],this[_0x3c76eb(0x1bc)]=![],this[_0x3c76eb(0x12a)]=_0x3c76eb(0x111),this[_0x3c76eb(0x1d7)]=null,this[_0x3c76eb(0x1e1)]=null,this[_0x3c76eb(0x201)]=null,this[_0x3c76eb(0x178)]=null,this['on'](_0x3c76eb(0x221),this['onReady'][_0x3c76eb(0x1ff)](this)),this['on'](_0x3c76eb(0x1f5),this[_0x3c76eb(0x182)]['bind'](this)),this['on'](_0x3c76eb(0x1a2),this[_0x3c76eb(0x206)][_0x3c76eb(0x1ff)](this)),this['on'](_0x3c76eb(0x116),this[_0x3c76eb(0xf0)][_0x3c76eb(0x1ff)](this));}async[a0_0x40ed77(0x209)](){const _0x97a829=a0_0x40ed77;this[_0x97a829(0xff)]['info'](_0x97a829(0xf4)+this['version']+_0x97a829(0x21e)),await this['cleanUpZombies'](),this[_0x97a829(0x1b0)]['licenseKey']=this['config'][_0x97a829(0x1f2)]||'',this[_0x97a829(0x1ed)]=await this[_0x97a829(0x1b1)](this[_0x97a829(0x1b0)][_0x97a829(0x1f2)]);if(!this[_0x97a829(0x1b0)][_0x97a829(0x1cf)]||this['config'][_0x97a829(0x1cf)]<0.1)this['config'][_0x97a829(0x1cf)]=0xc;await this[_0x97a829(0x1b3)]();try{const _0x1fc127=await this[_0x97a829(0x214)]('system.config');_0x1fc127&&_0x1fc127['common']&&(this[_0x97a829(0x149)]={'latitude':_0x1fc127[_0x97a829(0x203)][_0x97a829(0x161)]||0x0,'longitude':_0x1fc127[_0x97a829(0x203)][_0x97a829(0x164)]||0x0,'city':_0x1fc127[_0x97a829(0x203)]['city']||''},this['log'][_0x97a829(0x110)]('üìç\x20Standort\x20geladen:\x20'+this[_0x97a829(0x149)][_0x97a829(0x102)]));}catch(_0x44bae3){this[_0x97a829(0xff)]['warn'](_0x97a829(0x1a6));}if(this[_0x97a829(0x1b0)][_0x97a829(0x176)])try{this['genAI']=new GoogleGenerativeAI(this[_0x97a829(0x1b0)][_0x97a829(0x176)]),this[_0x97a829(0x225)]=this[_0x97a829(0x17a)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x97a829(0x1c5)}}),this['log']['info']('Gemini\x20AI\x20initialized.');}catch(_0x19eb8b){this['log'][_0x97a829(0x129)](_0x97a829(0x143)+_0x19eb8b['message']);}else this[_0x97a829(0xff)][_0x97a829(0x205)](_0x97a829(0x17d));await this['createAllObjects'](),await this[_0x97a829(0x1d0)](),await this[_0x97a829(0x21a)](),await this['loadDailyDigests'](),this['subscribeStates'](_0x97a829(0xfe)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this['subscribeStates']('system.mode');const _0x45dfed=this[_0x97a829(0x1b0)]['devices'];if(_0x45dfed&&_0x45dfed[_0x97a829(0x144)]>0x0){this[_0x97a829(0xff)][_0x97a829(0x110)](_0x97a829(0x204)+_0x45dfed[_0x97a829(0x144)]+_0x97a829(0x10d));for(const _0x2494ef of _0x45dfed){if(_0x2494ef['id']){await this[_0x97a829(0x1af)](_0x2494ef['id']);try{const _0x4372c1=await this[_0x97a829(0x123)](_0x2494ef['id']);if(_0x4372c1)this[_0x97a829(0x1e0)][_0x2494ef['id']]=_0x4372c1[_0x97a829(0x18d)];}catch(_0x836e20){}}}}if(this[_0x97a829(0x1d7)])clearInterval(this[_0x97a829(0x1d7)]);const _0xa2c367=this[_0x97a829(0x1b0)][_0x97a829(0x1de)]||0xf;_0xa2c367>0x0&&(this[_0x97a829(0xff)][_0x97a829(0x110)](_0x97a829(0x1f9)+_0xa2c367+_0x97a829(0x220)+this[_0x97a829(0x1b0)][_0x97a829(0x1cf)]+'h.'),this[_0x97a829(0x1d7)]=setInterval(()=>this[_0x97a829(0x163)](),_0xa2c367*0x3c*0x3e8)),this[_0x97a829(0x146)](),this[_0x97a829(0x19f)](),this[_0x97a829(0x187)]();}async[a0_0x40ed77(0x194)](){const _0x3812a6=a0_0x40ed77,_0x401634=['analysis.history_debug_00','analysis.history_debug_01','analysis.history_debug_02',_0x3812a6(0x1b7),'analysis.history_debug_04',_0x3812a6(0x20b),_0x3812a6(0x226),_0x3812a6(0x153),_0x3812a6(0x17e),_0x3812a6(0x197)];for(const _0xd8f283 of _0x401634){try{const _0xa40a8=await this[_0x3812a6(0x1ea)](_0xd8f283);_0xa40a8&&await this['delObjectAsync'](_0xd8f283);}catch(_0x50f58b){}}}async[a0_0x40ed77(0x1b3)](){const _0x47b1fe=a0_0x40ed77;try{const _0x12f196=await this[_0x47b1fe(0x1e5)]('events.history');_0x12f196&&_0x12f196[_0x47b1fe(0x18d)]&&(this[_0x47b1fe(0x12d)]=JSON[_0x47b1fe(0x1e8)](_0x12f196[_0x47b1fe(0x18d)]['toString']()),this[_0x47b1fe(0xff)][_0x47b1fe(0x110)]('Loaded\x20'+this['eventHistory'][_0x47b1fe(0x144)]+'\x20events\x20from\x20history.'));}catch(_0x3b01cf){this['eventHistory']=[];}try{const _0x37fcfc=await this[_0x47b1fe(0x1e5)]('analysis.analysisHistory');if(_0x37fcfc&&_0x37fcfc[_0x47b1fe(0x18d)])this[_0x47b1fe(0x1b8)]=JSON['parse'](_0x37fcfc[_0x47b1fe(0x18d)][_0x47b1fe(0x11c)]());}catch(_0x4f4c8d){this[_0x47b1fe(0x1b8)]=[];}}[a0_0x40ed77(0x182)](_0x4bc484,_0x2c0826){const _0xe162f=a0_0x40ed77;if(!_0x2c0826)return;if(_0x4bc484===this[_0xe162f(0x11a)]+'.'+SYSTEM_DP_MODE){_0x2c0826[_0xe162f(0x18d)]&&Object['values'](SYSTEM_MODES)[_0xe162f(0x166)](_0x2c0826[_0xe162f(0x18d)])&&(this[_0xe162f(0x14b)]=_0x2c0826['val'],_0x2c0826['val']===SYSTEM_MODES[_0xe162f(0xf9)]?this[_0xe162f(0x1f0)](![]):this[_0xe162f(0x1f0)](!![]));if(!_0x2c0826['ack'])this[_0xe162f(0x1ca)](_0x4bc484,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x2c0826[_0xe162f(0x196)]){_0x4bc484[_0xe162f(0x166)](_0xe162f(0xfe))&&_0x2c0826[_0xe162f(0x18d)]&&(this['log'][_0xe162f(0x110)]('Manual\x20Analysis\x20Trigger\x20detected!'),this['setState'](_0x4bc484,{'val':![],'ack':!![]}),this[_0xe162f(0x1ad)]());if(_0x4bc484[_0xe162f(0x166)](_0xe162f(0x16b))&&_0x2c0826[_0xe162f(0x18d)]){this[_0xe162f(0x1ca)](_0x4bc484,{'val':![],'ack':!![]});if(this['isProVersion'])this[_0xe162f(0x124)]();}return;}const _0x1662cd=(this[_0xe162f(0x1b0)][_0xe162f(0x235)]||[])[_0xe162f(0x183)](_0x7f25c4=>_0x7f25c4['id']===_0x4bc484);if(_0x1662cd)this['processSensorEvent'](_0x4bc484,_0x2c0826,_0x1662cd);}async['processSensorEvent'](_0x343405,_0x5bd4f5,_0x5c655a){const _0x1ee684=a0_0x40ed77;if(!_0x5c655a[_0x1ee684(0x1f3)]&&this[_0x1ee684(0x1e0)][_0x343405]===_0x5bd4f5[_0x1ee684(0x18d)])return;this[_0x1ee684(0x1e0)][_0x343405]=_0x5bd4f5[_0x1ee684(0x18d)];if(this['isGracePeriodActive']){this[_0x1ee684(0xff)][_0x1ee684(0x1b2)]('Ignoring\x20event\x20during\x20Exit\x20Grace\x20Period:\x20'+_0x5c655a[_0x1ee684(0x114)]);return;}const _0x3b5457=_0x5c655a[_0x1ee684(0x22d)]===_0x1ee684(0x20d)&&(_0x5c655a[_0x1ee684(0x114)][_0x1ee684(0x22a)]()[_0x1ee684(0x166)]('haust√ºr')||_0x5c655a[_0x1ee684(0x114)][_0x1ee684(0x22a)]()[_0x1ee684(0x166)](_0x1ee684(0x1a5))||_0x5c655a[_0x1ee684(0x1bb)][_0x1ee684(0x22a)]()[_0x1ee684(0x166)](_0x1ee684(0x13d)));_0x3b5457&&!_0x5bd4f5[_0x1ee684(0x18d)]?this[_0x1ee684(0x23b)]():(this['exitTimer']&&(this['log']['info'](_0x1ee684(0x19d)),this[_0x1ee684(0x228)]()),!this[_0x1ee684(0x1e2)]&&this[_0x1ee684(0x14b)]===SYSTEM_MODES[_0x1ee684(0x179)]&&this['setPresence'](!![]));const _0x1e292b={'timestamp':_0x5bd4f5['ts'],'id':_0x343405,'name':_0x5c655a['name'],'value':_0x5bd4f5[_0x1ee684(0x18d)],'location':_0x5c655a[_0x1ee684(0x1bb)],'type':_0x5c655a[_0x1ee684(0x22d)]};this['eventHistory'][_0x1ee684(0x150)](_0x1e292b);if(this[_0x1ee684(0x12d)][_0x1ee684(0x144)]>HISTORY_MAX_SIZE)this[_0x1ee684(0x12d)][_0x1ee684(0x17b)]();await this[_0x1ee684(0x223)]('events.lastEvent',{'val':JSON['stringify'](_0x1e292b),'ack':!![]}),await this[_0x1ee684(0x223)]('events.history',{'val':JSON['stringify'](this[_0x1ee684(0x12d)]),'ack':!![]}),this[_0x1ee684(0x17c)][_0x1ee684(0x1b9)]({'timestamp':new Date(_0x5bd4f5['ts'])[_0x1ee684(0x125)](),'sensorName':_0x5c655a[_0x1ee684(0x114)],'location':_0x5c655a[_0x1ee684(0x1bb)],'value':_0x5bd4f5[_0x1ee684(0x18d)]}),await this['saveRawEventLog']();}[a0_0x40ed77(0x23b)](){const _0xb91d45=a0_0x40ed77;this[_0xb91d45(0xff)][_0xb91d45(0x110)]('Haust√ºr\x20Event:\x20Starte\x20Exit-Logik\x20('+EXIT_TIMER_MINUTES+_0xb91d45(0x238)+EXIT_GRACE_PERIOD_SECONDS+_0xb91d45(0xf5)),this[_0xb91d45(0x228)](),this[_0xb91d45(0x104)]=!![],this['exitGraceTimer']=setTimeout(()=>{const _0x58067e=_0xb91d45;this[_0x58067e(0x104)]=![],this[_0x58067e(0xff)][_0x58067e(0x1b2)](_0x58067e(0x1f7));},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0xb91d45(0x1ec)]=setTimeout(()=>{const _0x25dad2=_0xb91d45;this['log'][_0x25dad2(0x110)](_0x25dad2(0x13a)),this['setPresence'](![]),this[_0x25dad2(0x1ec)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x40ed77(0x228)](){const _0x4bc88=a0_0x40ed77;if(this[_0x4bc88(0x1ec)])clearTimeout(this[_0x4bc88(0x1ec)]);if(this[_0x4bc88(0x100)])clearTimeout(this['exitGraceTimer']);this[_0x4bc88(0x1ec)]=null,this[_0x4bc88(0x100)]=null,this[_0x4bc88(0x104)]=![];}async[a0_0x40ed77(0x1f0)](_0x46f054){const _0x5a217e=a0_0x40ed77;if(this[_0x5a217e(0x1e2)]===_0x46f054)return;this[_0x5a217e(0x1e2)]=_0x46f054,await this[_0x5a217e(0x223)](_0x5a217e(0x1a8),{'val':_0x46f054,'ack':!![]}),this[_0x5a217e(0xff)][_0x5a217e(0x110)](_0x5a217e(0x151)+(_0x46f054?_0x5a217e(0x1df):'ABWESEND\x20‚úàÔ∏è'));}[a0_0x40ed77(0x163)](){const _0x3ed254=a0_0x40ed77,_0x165a12=this['config'][_0x3ed254(0x1cf)],_0x25976a=this[_0x3ed254(0x1b0)][_0x3ed254(0x184)],_0x6f985b=this[_0x3ed254(0x12d)][_0x3ed254(0x144)]>0x0?this[_0x3ed254(0x12d)][0x0]['timestamp']:Date[_0x3ed254(0x132)](),_0x1d00a0=(Date[_0x3ed254(0x132)]()-_0x6f985b)/(0x3e8*0x3c*0x3c);let _0xfba6d5='';_0x25976a&&this[_0x3ed254(0x14b)]===SYSTEM_MODES[_0x3ed254(0x179)]&&this[_0x3ed254(0x1e2)]&&(_0x1d00a0>_0x165a12&&(this[_0x3ed254(0xff)][_0x3ed254(0x205)](_0x3ed254(0x12b)+_0x1d00a0['toFixed'](0x1)+_0x3ed254(0x1c3)),_0xfba6d5=_0x3ed254(0x11b)+_0x1d00a0[_0x3ed254(0x229)](0x1)+_0x3ed254(0xf2)));if(_0xfba6d5){this[_0x3ed254(0x1ad)](_0xfba6d5)[_0x3ed254(0x1a7)](_0x2f0dd1=>this[_0x3ed254(0xff)][_0x3ed254(0x129)](_0x2f0dd1));return;}const _0x1138c6=Date[_0x3ed254(0x132)](),_0x581075=_0x1138c6-_0x6f985b,_0x57c13c=(this[_0x3ed254(0x1b0)]['analysisInterval']||0xf)*0x3c*0x3e8;this[_0x3ed254(0x12d)][_0x3ed254(0x144)]>0x0&&_0x581075<=_0x57c13c?this['runGeminiAnalysis']()[_0x3ed254(0x1a7)](_0xd054c9=>this[_0x3ed254(0xff)]['error'](_0xd054c9)):!this[_0x3ed254(0x1bc)]&&(this[_0x3ed254(0x1ca)]('analysis.isAlert',{'val':![],'ack':!![]}),this[_0x3ed254(0x1ca)]('analysis.isEmergency',{'val':![],'ack':!![]}));}async[a0_0x40ed77(0x1ad)](_0x28324b=''){const _0x42c9b7=a0_0x40ed77;this[_0x42c9b7(0xff)][_0x42c9b7(0x110)]('ü§ñ\x20Starting\x20Gemini\x20Analysis...');if(!this['geminiModel']){this[_0x42c9b7(0xff)][_0x42c9b7(0x129)](_0x42c9b7(0x1d1));return;}const _0x3a6043=this[_0x42c9b7(0x12d)][_0x42c9b7(0x144)]>0x0?this[_0x42c9b7(0x12d)]:[{'note':_0x42c9b7(0x1c9)}],_0x1867a8=PERSONA_MAPPING[this['config'][_0x42c9b7(0x118)]||_0x42c9b7(0x10e)],_0x31b707=this['config']['livingContext']||'',_0x588e85=this[_0x42c9b7(0x14b)],_0x1ec662=new Date(),_0x265062=_0x1ec662[_0x42c9b7(0x1ef)](_0x42c9b7(0x21c),{'weekday':'long','hour':'2-digit','minute':'2-digit'}),_0x561c02=this[_0x42c9b7(0x149)];let _0x356a77='';if(this['feedbackHistory'][_0x42c9b7(0x144)]>0x0){const _0x59a079=this[_0x42c9b7(0x1f6)][_0x42c9b7(0x1fc)](0x0,0x3)[_0x42c9b7(0x162)](_0x3f5fd7=>_0x42c9b7(0x1da)+_0x3f5fd7[_0x42c9b7(0x19e)]+'\x22\x20was\x20'+_0x3f5fd7['rating']+'.')[_0x42c9b7(0x1dd)]('\x0a');_0x356a77='\x0aFEEDBACK:\x0a'+_0x59a079+'\x0a';}const _0x37250a=_0x28324b?_0x42c9b7(0x12c)+_0x28324b+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x40e5f8=_0x42c9b7(0x237),_0x1df949=_0x42c9b7(0x173)+_0x265062+_0x42c9b7(0x211)+_0x561c02[_0x42c9b7(0x102)]+_0x42c9b7(0x140)+_0x588e85+_0x42c9b7(0x1a0)+(this[_0x42c9b7(0x1e2)]?'Ja':_0x42c9b7(0x11d))+_0x42c9b7(0x10b)+_0x31b707+_0x42c9b7(0xf3)+_0x1867a8+_0x42c9b7(0x101)+_0x40e5f8+'\x20'+_0x356a77+'\x20'+_0x37250a+_0x42c9b7(0x19a)+JSON['stringify'](_0x3a6043)+_0x42c9b7(0x158);try{this['log']['debug']('Sending\x20Prompt\x20(Length:\x20'+_0x1df949[_0x42c9b7(0x144)]+')...');const _0x28dbd1=await this[_0x42c9b7(0x225)]['generateContent'](_0x1df949),_0xf4cc36=_0x28dbd1['response'][_0x42c9b7(0x16e)]()[_0x42c9b7(0x14d)](/```json|```/g,'')[_0x42c9b7(0x13c)]();this[_0x42c9b7(0xff)][_0x42c9b7(0x110)](_0x42c9b7(0x1d4));const _0x6e62a6=JSON[_0x42c9b7(0x1e8)](_0xf4cc36);await this[_0x42c9b7(0x223)](_0x42c9b7(0x1db),{'val':_0xf4cc36,'ack':!![]}),await this[_0x42c9b7(0x223)]('analysis.alertReason',{'val':_0x6e62a6[_0x42c9b7(0x198)][_0x42c9b7(0x19e)]||'','ack':!![]}),await this[_0x42c9b7(0x223)](_0x42c9b7(0x1ac),{'val':_0x6e62a6[_0x42c9b7(0x198)][_0x42c9b7(0x18f)]||_0x42c9b7(0x23c),'ack':!![]});const _0x19a46f=_0x6e62a6['activity']['isAlert']||![],_0x3d897a=_0x6e62a6['activity']['isEmergency']||![];if(_0x19a46f||_0x3d897a){await this[_0x42c9b7(0x223)]('analysis.isAlert',{'val':!![],'ack':!![]}),await this[_0x42c9b7(0x223)](_0x42c9b7(0x119),{'val':_0x3d897a,'ack':!![]});if(!this[_0x42c9b7(0x1bc)]||_0x3d897a){const _0x14d521=_0x3d897a?'üö®üö®\x20NOTFALL':_0x42c9b7(0x239);this[_0x42c9b7(0x10f)](_0x14d521+':\x20'+_0x6e62a6[_0x42c9b7(0x198)]['alertReason'],![],_0x3d897a);}}else await this['setStateAsync'](_0x42c9b7(0x188),{'val':![],'ack':!![]}),await this[_0x42c9b7(0x223)](_0x42c9b7(0x119),{'val':![],'ack':!![]});this[_0x42c9b7(0x1bc)]=_0x19a46f||_0x3d897a;const _0x43fbd0={'timestamp':Date[_0x42c9b7(0x132)](),'id':Date[_0x42c9b7(0x132)]()[_0x42c9b7(0x11c)](),'analysis':_0x6e62a6,'systemMode':_0x588e85,'isPro':this[_0x42c9b7(0x1ed)]};this[_0x42c9b7(0x1be)](_0x43fbd0);}catch(_0x229deb){this[_0x42c9b7(0xff)]['error']('Analysis\x20Error:\x20'+_0x229deb[_0x42c9b7(0x116)]);}}async[a0_0x40ed77(0x124)](){const _0x4c8465=a0_0x40ed77;if(!this[_0x4c8465(0x1ed)])return;await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x4c8465(0x156)+new Date()[_0x4c8465(0x1ef)](),'ack':!![]});if(!this[_0x4c8465(0x225)]||this[_0x4c8465(0x17c)][_0x4c8465(0x144)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x4c8465(0x223)](LTM_DP_STATUS,{'val':_0x4c8465(0x1f1),'ack':!![]});return;}const _0x4f7cad=JSON[_0x4c8465(0x1e8)](JSON['stringify'](this[_0x4c8465(0x17c)])),_0x2715b4=(this['config'][_0x4c8465(0x171)]||'')[_0x4c8465(0x217)](0x0,0x3e8),_0x502208=_0x4c8465(0x232)+_0x2715b4+_0x4c8465(0x172)+JSON[_0x4c8465(0x1ce)](_0x4f7cad);try{const _0x18f5d3=await this['geminiModel'][_0x4c8465(0x180)](_0x502208),_0x22f1b5=JSON[_0x4c8465(0x1e8)](_0x18f5d3[_0x4c8465(0x219)][_0x4c8465(0x16e)]()['replace'](/```json|```/g,'')['trim']());_0x22f1b5[_0x4c8465(0x18f)]&&(this[_0x4c8465(0x109)][_0x4c8465(0x1b9)]({'timestamp':new Date()[_0x4c8465(0x125)](),'eventCount':_0x4f7cad['length'],'summary':_0x22f1b5[_0x4c8465(0x18f)],'activityLevel':_0x22f1b5[_0x4c8465(0x20c)],'systemMode':this[_0x4c8465(0x14b)]}),await this[_0x4c8465(0x1c1)](),this[_0x4c8465(0x17c)]=[],await this[_0x4c8465(0x14a)](),await this[_0x4c8465(0x223)](LTM_DP_STATUS,{'val':_0x4c8465(0x1b4)+_0x4f7cad[_0x4c8465(0x144)]+_0x4c8465(0x21d),'ack':!![]}));}catch(_0x34a018){await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x4c8465(0x1c4)+_0x34a018[_0x4c8465(0x116)],'ack':!![]});}}async[a0_0x40ed77(0x195)](){const _0xd2e2b9=a0_0x40ed77;await this['checkSystemObjects'](),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x1a8),{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x134),'type':_0xd2e2b9(0x218),'role':_0xd2e2b9(0x11e),'read':!![],'write':![],'def':!![]},'native':{}}),await this[_0xd2e2b9(0x174)]('events.lastEvent',{'type':_0xd2e2b9(0x10a),'common':{'name':'Last\x20raw\x20event','type':'string','role':_0xd2e2b9(0x18a),'read':!![],'write':![]},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x210),{'type':_0xd2e2b9(0x10a),'common':{'name':'Event\x20History','type':_0xd2e2b9(0x1e9),'role':_0xd2e2b9(0x18a),'read':!![],'write':![]},'native':{}}),await this[_0xd2e2b9(0x174)]('analysis.trigger',{'type':_0xd2e2b9(0x10a),'common':{'name':'Trigger\x20Analysis','type':_0xd2e2b9(0x218),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.lastResult',{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x1cb),'type':_0xd2e2b9(0x1e9),'role':_0xd2e2b9(0x18a),'read':!![],'write':![]},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x188),{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x22b),'type':_0xd2e2b9(0x218),'role':_0xd2e2b9(0x1c6),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x119),{'type':_0xd2e2b9(0x10a),'common':{'name':'AI\x20Emergency\x20Status','type':_0xd2e2b9(0x218),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xd2e2b9(0xfc),{'type':'state','common':{'name':_0xd2e2b9(0x122),'type':_0xd2e2b9(0x1e9),'role':_0xd2e2b9(0x185),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.activitySummary',{'type':'state','common':{'name':_0xd2e2b9(0x1ba),'type':_0xd2e2b9(0x1e9),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x138),{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x191),'type':'string','role':'state','read':!![],'write':![],'def':_0xd2e2b9(0x23c)},'native':{}}),await this[_0xd2e2b9(0x174)]('analysis.comfortSummary',{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x148),'type':_0xd2e2b9(0x1e9),'role':_0xd2e2b9(0x16e),'read':!![],'write':![]},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x234),{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x21b),'type':_0xd2e2b9(0x1e9),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0xd2e2b9(0x230)](_0xd2e2b9(0x127),{'type':_0xd2e2b9(0xf8),'common':{'name':_0xd2e2b9(0x11f)},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x181),{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x1d2),'type':'boolean','role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x13f),{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x1b5),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await this[_0xd2e2b9(0x174)]('analysis.automation.suggestedAction',{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x15d),'type':_0xd2e2b9(0x1e9),'role':_0xd2e2b9(0x16e),'read':!![],'write':![]},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x135),{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x14c),'type':_0xd2e2b9(0x1e9),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0xd2e2b9(0x174)](_0xd2e2b9(0x168),{'type':_0xd2e2b9(0x10a),'common':{'name':_0xd2e2b9(0x130),'type':_0xd2e2b9(0x1e9),'role':_0xd2e2b9(0x18a),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['checkLtmObjects'](),await this[_0xd2e2b9(0x227)]();}async['checkSystemObjects'](){const _0xf70889=a0_0x40ed77;await this[_0xf70889(0x230)]('system',{'type':_0xf70889(0xf8),'common':{'name':_0xf70889(0x103)},'native':{}}),await this[_0xf70889(0x230)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0xf70889(0x199),'type':'string','role':_0xf70889(0x10a),'read':!![],'write':!![],'def':SYSTEM_MODES[_0xf70889(0x179)],'states':{[SYSTEM_MODES[_0xf70889(0x179)]]:'Normal',[SYSTEM_MODES['VACATION']]:_0xf70889(0x1cd),[SYSTEM_MODES[_0xf70889(0x236)]]:_0xf70889(0x1c0),[SYSTEM_MODES[_0xf70889(0x131)]]:_0xf70889(0x142)}},'native':{}});}async[a0_0x40ed77(0x10f)](_0x5bd208,_0x421678=![],_0x37e7d3=![]){const _0xbdc313=a0_0x40ed77;this[_0xbdc313(0xff)]['info']((_0x421678?_0xbdc313(0x14f):'')+'Sending\x20notification:\x20\x22'+_0x5bd208+'\x22'+(_0x37e7d3?'\x20(EMERGENCY)':''));const _0x1f86ae=this['config'];let _0x144453=0x0;_0x1f86ae[_0xbdc313(0x1a4)]&&_0x1f86ae[_0xbdc313(0x23e)]&&(await this[_0xbdc313(0x13e)](_0x1f86ae[_0xbdc313(0x23e)],_0xbdc313(0x1bd),{'text':_0x5bd208,'user':_0x1f86ae[_0xbdc313(0x208)]}),_0x144453++);if(_0x1f86ae[_0xbdc313(0x22c)]&&_0x1f86ae['notifyPushoverInstance']){let _0x25efb5={'message':_0x5bd208,'title':_0x37e7d3?'üö®\x20EMERGENCY':_0xbdc313(0x157),'priority':_0x37e7d3?0x2:0x1,'device':_0x1f86ae[_0xbdc313(0x15c)]};_0x37e7d3&&(_0x25efb5[_0xbdc313(0x113)]=0x1e,_0x25efb5['expire']=0xe10,_0x25efb5[_0xbdc313(0x1d3)]='siren'),await this[_0xbdc313(0x13e)](_0x1f86ae[_0xbdc313(0x1cc)],_0xbdc313(0x1bd),_0x25efb5),_0x144453++;}return _0x1f86ae[_0xbdc313(0x216)]&&_0x1f86ae[_0xbdc313(0x1a1)]&&(await this[_0xbdc313(0x13e)](_0x1f86ae[_0xbdc313(0x1a1)],_0xbdc313(0x1bd),{'text':_0x5bd208,'to':_0x1f86ae[_0xbdc313(0x15e)]}),_0x144453++),_0x1f86ae[_0xbdc313(0x1c7)]&&_0x1f86ae[_0xbdc313(0x169)]&&(await this[_0xbdc313(0x13e)](_0x1f86ae[_0xbdc313(0x169)],'send',{'text':_0x5bd208,'phone':_0x1f86ae[_0xbdc313(0x108)]}),_0x144453++),_0x1f86ae[_0xbdc313(0x165)]&&_0x1f86ae[_0xbdc313(0x16a)]&&(await this[_0xbdc313(0x13e)](_0x1f86ae[_0xbdc313(0x16a)],_0xbdc313(0x1bd),{'text':_0x5bd208,'phone':_0x1f86ae[_0xbdc313(0x19c)]}),_0x144453++),_0x144453;}async['loadRawEventLog'](){const _0x2196b2=a0_0x40ed77;try{const _0x2bc96a=await this[_0x2196b2(0x1e5)](LTM_DP_RAW_LOG);if(_0x2bc96a&&_0x2bc96a[_0x2196b2(0x18d)])this[_0x2196b2(0x17c)]=JSON[_0x2196b2(0x1e8)](_0x2bc96a[_0x2196b2(0x18d)]);}catch(_0x4acfc6){this['rawEventLog']=[];}}async[a0_0x40ed77(0x14a)](){const _0x1cf768=a0_0x40ed77;this[_0x1cf768(0x17c)][_0x1cf768(0x144)]>RAW_LOG_MAX_SIZE&&this[_0x1cf768(0x17c)]['splice'](0x0,this[_0x1cf768(0x17c)][_0x1cf768(0x144)]-RAW_LOG_MAX_SIZE),await this[_0x1cf768(0x223)](LTM_DP_RAW_LOG,{'val':JSON[_0x1cf768(0x1ce)](this[_0x1cf768(0x17c)]),'ack':!![]});}async[a0_0x40ed77(0x189)](){const _0x463534=a0_0x40ed77;try{const _0x3cd309=await this[_0x463534(0x1e5)](LTM_DP_DAILY_DIGESTS);if(_0x3cd309&&_0x3cd309[_0x463534(0x18d)])this[_0x463534(0x109)]=JSON['parse'](_0x3cd309[_0x463534(0x18d)]);}catch(_0x49f411){this[_0x463534(0x109)]=[];}await this[_0x463534(0xfa)]();}async[a0_0x40ed77(0x1c1)](_0x58a947=!![]){const _0x123e1e=a0_0x40ed77,_0x35be2a=this[_0x123e1e(0x1b0)][_0x123e1e(0x120)]||0x3c;this[_0x123e1e(0x109)][_0x123e1e(0x144)]>_0x35be2a&&this[_0x123e1e(0x109)][_0x123e1e(0xef)](0x0,this[_0x123e1e(0x109)]['length']-_0x35be2a);await this[_0x123e1e(0x223)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x123e1e(0x1ce)](this[_0x123e1e(0x109)]),'ack':!![]});if(_0x58a947)await this['updateBaselineStatus']();}[a0_0x40ed77(0x146)](){const _0x290590=a0_0x40ed77;if(this[_0x290590(0x1e1)])this[_0x290590(0x1e1)][_0x290590(0x137)]();if(!this[_0x290590(0x1ed)]){this[_0x290590(0x223)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this[_0x290590(0x1e1)]=schedule[_0x290590(0x1e6)](LTM_SCHEDULE,()=>this[_0x290590(0x124)]());}['setupDriftAnalysisScheduler'](){const _0x2dbd82=a0_0x40ed77;if(this[_0x2dbd82(0x178)])clearInterval(this[_0x2dbd82(0x178)]);if(!this[_0x2dbd82(0x1ed)])return;this[_0x2dbd82(0x178)]=setInterval(()=>this[_0x2dbd82(0x115)](),(this[_0x2dbd82(0x1b0)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>this['runBaselineDriftAnalysis'](),0x1388);}async[a0_0x40ed77(0x19b)](){const _0x27f54b=a0_0x40ed77;await this[_0x27f54b(0x223)](_0x27f54b(0x1ac),{'val':_0x27f54b(0x20f),'ack':!![]}),await this[_0x27f54b(0x223)]('analysis.deviationFromBaseline',{'val':this['isProVersion']?'N/A\x20(No\x20Activity)':_0x27f54b(0x1a9),'ack':!![]}),await this[_0x27f54b(0x223)](_0x27f54b(0x188),{'val':![],'ack':!![]}),await this[_0x27f54b(0x223)](_0x27f54b(0x119),{'val':![],'ack':!![]}),this['lastAlertState']=![];}async['updateAnalysisHistory'](_0x59a718){const _0x3ca615=a0_0x40ed77;this['analysisHistory'][_0x3ca615(0x150)](_0x59a718);if(this[_0x3ca615(0x1b8)][_0x3ca615(0x144)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x3ca615(0x1b8)]['pop']();await this[_0x3ca615(0x223)](_0x3ca615(0x135),{'val':JSON[_0x3ca615(0x1ce)](this[_0x3ca615(0x1b8)]),'ack':!![]});}[a0_0x40ed77(0x19f)](){const _0x2fedea=a0_0x40ed77;if(this[_0x2fedea(0x201)])this[_0x2fedea(0x201)][_0x2fedea(0x137)]();this['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x4dcbf7=_0x2fedea;await this['loadSystemMode'](),AUTO_RESET_MODES[_0x4dcbf7(0x166)](this['currentSystemMode'])&&await this[_0x4dcbf7(0x223)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x4dcbf7(0x179)],'ack':![]});});}async[a0_0x40ed77(0xfa)](){const _0x1d4b38=a0_0x40ed77;if(!this[_0x1d4b38(0x1ed)]){await this[_0x1d4b38(0x223)](LTM_DP_BASELINE_STATUS,{'val':_0x1d4b38(0x1dc),'ack':!![]});return;}const _0x37b805=this[_0x1d4b38(0x109)][_0x1d4b38(0x144)]>=(this[_0x1d4b38(0x1b0)][_0x1d4b38(0x212)]||0x7)?'Aktiv\x20('+this[_0x1d4b38(0x109)][_0x1d4b38(0x144)]+'\x20Tage)':_0x1d4b38(0x17f)+this[_0x1d4b38(0x109)]['length']+'/'+(this[_0x1d4b38(0x1b0)][_0x1d4b38(0x212)]||0x7)+')';await this[_0x1d4b38(0x223)](LTM_DP_BASELINE_STATUS,{'val':_0x37b805,'ack':!![]});}async[a0_0x40ed77(0x23f)](){const _0x55a992=a0_0x40ed77;await this[_0x55a992(0x230)](_0x55a992(0x160),{'type':_0x55a992(0xf8),'common':{'name':_0x55a992(0x160)},'native':{}}),await this[_0x55a992(0x230)](LTM_DP_RAW_LOG,{'type':_0x55a992(0x10a),'common':{'name':'Raw\x20Log','type':_0x55a992(0x1e9),'role':_0x55a992(0x18a),'read':!![],'write':![]},'native':{}}),await this[_0x55a992(0x230)](LTM_DP_DAILY_DIGESTS,{'type':_0x55a992(0x10a),'common':{'name':_0x55a992(0x145),'type':'string','role':_0x55a992(0x18a),'read':!![],'write':![]},'native':{}}),await this[_0x55a992(0x230)](LTM_DP_STATUS,{'type':_0x55a992(0x10a),'common':{'name':_0x55a992(0x1c8),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await this[_0x55a992(0x230)](LTM_DP_TRIGGER_DIGEST,{'type':_0x55a992(0x10a),'common':{'name':'Trigger\x20Digest','type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x55a992(0x230)](LTM_DP_BASELINE_STATUS,{'type':_0x55a992(0x10a),'common':{'name':_0x55a992(0x22e),'type':'string','role':_0x55a992(0x16e),'read':!![],'write':![]},'native':{}});}async[a0_0x40ed77(0x227)](){const _0x1f3e9a=a0_0x40ed77;await this[_0x1f3e9a(0x230)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':'Drift\x20Analysis'},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x1f3e9a(0x10a),'common':{'name':_0x1f3e9a(0x136),'type':'string','role':_0x1f3e9a(0x10a),'read':!![],'write':![],'def':_0x1f3e9a(0x23c)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x1f3e9a(0x10a),'common':{'name':_0x1f3e9a(0x1fa),'type':'string','role':_0x1f3e9a(0x16e),'read':!![],'write':![]},'native':{}}),await this[_0x1f3e9a(0x230)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x1f3e9a(0x10a),'common':{'name':_0x1f3e9a(0x1d6),'type':'number','role':_0x1f3e9a(0x13b),'read':!![],'write':![]},'native':{}});}async['runBaselineDriftAnalysis'](){const _0x3e775c=a0_0x40ed77;if(!this[_0x3e775c(0x1ed)]||!this['geminiModel'])return;const _0xd73da7=this[_0x3e775c(0x1b0)][_0x3e775c(0x21f)]||0xe;if(this['dailyDigests'][_0x3e775c(0x144)]<_0xd73da7+(this[_0x3e775c(0x1b0)][_0x3e775c(0x212)]||0x7)){await this[_0x3e775c(0x223)](LTM_DP_DRIFT_STATUS,{'val':_0x3e775c(0x1a3),'ack':!![]});return;}const _0x3fa1f6=this[_0x3e775c(0x109)][_0x3e775c(0x1fc)](-_0xd73da7),_0x286127=this[_0x3e775c(0x109)][_0x3e775c(0x1fc)](0x0,this['dailyDigests']['length']-_0xd73da7),_0x592f49=_0x3e775c(0x1ab)+JSON[_0x3e775c(0x1ce)](_0x286127)+_0x3e775c(0x155)+JSON[_0x3e775c(0x1ce)](_0x3fa1f6);try{const _0x28bf09=await this['geminiModel'][_0x3e775c(0x180)](_0x592f49),_0x13c247=JSON['parse'](_0x28bf09[_0x3e775c(0x219)][_0x3e775c(0x16e)]()[_0x3e775c(0x14d)](/```json|```/g,'')['trim']());_0x13c247['baselineDrift']&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x13c247[_0x3e775c(0xf1)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x13c247[_0x3e775c(0x1b6)],'ack':!![]}),await this[_0x3e775c(0x223)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x3e775c(0x132)](),'ack':!![]}));}catch(_0x5c5585){}}async['loadSystemMode'](){const _0x4e6a1d=a0_0x40ed77;try{const _0x1de822=await this[_0x4e6a1d(0x1e5)](SYSTEM_DP_MODE);_0x1de822&&_0x1de822['val']&&Object['values'](SYSTEM_MODES)[_0x4e6a1d(0x166)](_0x1de822[_0x4e6a1d(0x18d)])?this[_0x4e6a1d(0x14b)]=_0x1de822[_0x4e6a1d(0x18d)]:(this['currentSystemMode']=SYSTEM_MODES['NORMAL'],await this[_0x4e6a1d(0x223)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x4e6a1d(0x179)],'ack':!![]}));}catch(_0x35531b){this[_0x4e6a1d(0x14b)]=SYSTEM_MODES[_0x4e6a1d(0x179)];}}async['getSystemUUID'](){const _0x31de81=a0_0x40ed77;try{const _0x715b2b=await this[_0x31de81(0x214)](_0x31de81(0x15f));if(_0x715b2b&&_0x715b2b[_0x31de81(0x16f)]&&_0x715b2b[_0x31de81(0x16f)][_0x31de81(0x233)])return _0x715b2b[_0x31de81(0x16f)][_0x31de81(0x233)];return _0x31de81(0x112);}catch(_0x1c99e7){return _0x31de81(0x1e3);}}async[a0_0x40ed77(0x1b1)](_0xf4a6d3){const _0x2cdd6f=a0_0x40ed77;if(!_0xf4a6d3)return![];this[_0x2cdd6f(0x12a)]=await this[_0x2cdd6f(0xfb)]();if(_0xf4a6d3===_0x2cdd6f(0x10c)||_0xf4a6d3[_0x2cdd6f(0x22f)]('PRO-'))return!![];return![];}[a0_0x40ed77(0x206)](_0x654bd7){const _0x29a23a=a0_0x40ed77;if(this[_0x29a23a(0x1d7)])clearInterval(this[_0x29a23a(0x1d7)]);if(this[_0x29a23a(0x178)])clearInterval(this['driftAnalysisTimer']);if(this[_0x29a23a(0x1e1)])this[_0x29a23a(0x1e1)][_0x29a23a(0x137)]();if(this[_0x29a23a(0x201)])this['modeResetJob'][_0x29a23a(0x137)]();if(this['exitTimer'])clearTimeout(this[_0x29a23a(0x1ec)]);if(this[_0x29a23a(0x100)])clearTimeout(this[_0x29a23a(0x100)]);_0x654bd7();}async[a0_0x40ed77(0xf0)](_0x2dc823){const _0x4d7be3=a0_0x40ed77;if(typeof _0x2dc823===_0x4d7be3(0x106)&&_0x2dc823[_0x4d7be3(0x116)]){if(_0x2dc823['command']===_0x4d7be3(0x18b)){if(!_0x2dc823[_0x4d7be3(0x116)][_0x4d7be3(0x1aa)])return this[_0x4d7be3(0x222)](_0x2dc823['from'],_0x2dc823[_0x4d7be3(0x1f8)],{'success':![],'message':_0x4d7be3(0x213)},_0x2dc823[_0x4d7be3(0x16d)]);try{const _0x10670c=new GoogleGenerativeAI(_0x2dc823[_0x4d7be3(0x116)][_0x4d7be3(0x1aa)])[_0x4d7be3(0x20a)]({'model':_0x4d7be3(0x170)});await _0x10670c[_0x4d7be3(0x180)]('test'),this[_0x4d7be3(0x222)](_0x2dc823['from'],_0x2dc823[_0x4d7be3(0x1f8)],{'success':!![],'message':_0x4d7be3(0x1f4)},_0x2dc823['callback']);}catch(_0x157d5f){this['sendTo'](_0x2dc823['from'],_0x2dc823['command'],{'success':![],'message':_0x157d5f[_0x4d7be3(0x116)]},_0x2dc823[_0x4d7be3(0x16d)]);}}else{if(_0x2dc823[_0x4d7be3(0x1f8)]===_0x4d7be3(0x105)){const _0x2a856f=await this[_0x4d7be3(0x10f)]('[Test]\x20Notification',!![]);this[_0x4d7be3(0x222)](_0x2dc823[_0x4d7be3(0x1bf)],_0x2dc823[_0x4d7be3(0x1f8)],{'success':_0x2a856f>0x0,'message':_0x2a856f+_0x4d7be3(0x121)},_0x2dc823[_0x4d7be3(0x16d)]);}else{if(_0x2dc823[_0x4d7be3(0x1f8)]===_0x4d7be3(0x1ee)){if(!this[_0x4d7be3(0x1ed)])return this[_0x4d7be3(0x222)](_0x2dc823[_0x4d7be3(0x1bf)],_0x2dc823[_0x4d7be3(0x1f8)],{'success':![],'isPro':![]},_0x2dc823['callback']);let _0x12b894={'status':'N/A','details':'','lastCheck':0x0};try{_0x12b894[_0x4d7be3(0x23a)]=(await this[_0x4d7be3(0x1e5)](LTM_DP_DRIFT_STATUS))[_0x4d7be3(0x18d)],_0x12b894[_0x4d7be3(0x192)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x4d7be3(0x18d)],_0x12b894[_0x4d7be3(0x12f)]=(await this[_0x4d7be3(0x1e5)](LTM_DP_DRIFT_LAST_CHECK))[_0x4d7be3(0x18d)];}catch(_0xfdd4b6){}this[_0x4d7be3(0x222)](_0x2dc823[_0x4d7be3(0x1bf)],_0x2dc823[_0x4d7be3(0x1f8)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x4d7be3(0x109)],'driftAnalysis':_0x12b894,'analysisHistory':this[_0x4d7be3(0x1b8)]},_0x2dc823[_0x4d7be3(0x16d)]);}else{if(_0x2dc823[_0x4d7be3(0x1f8)]===_0x4d7be3(0x207)){const _0x368227=await this[_0x4d7be3(0x159)](_0x4d7be3(0x15b),_0x4d7be3(0x1fd)),_0xd28639=[];if(_0x368227)for(const _0x428b4f in _0x368227){const _0x22a336=_0x368227[_0x428b4f],_0x5ac641=(_0x22a336[_0x4d7be3(0x203)]&&typeof _0x22a336[_0x4d7be3(0x203)][_0x4d7be3(0x114)]===_0x4d7be3(0x106)?_0x22a336[_0x4d7be3(0x203)][_0x4d7be3(0x114)]['de']:_0x22a336['common'][_0x4d7be3(0x114)])||_0x22a336['common'][_0x4d7be3(0x114)];_0xd28639[_0x4d7be3(0x1b9)]({'id':_0x428b4f,'name':_0x5ac641});}this[_0x4d7be3(0x222)](_0x2dc823[_0x4d7be3(0x1bf)],_0x2dc823['command'],{'success':!![],'enums':_0xd28639},_0x2dc823['callback']);}else{if(_0x2dc823['command']===_0x4d7be3(0x177)){this[_0x4d7be3(0xff)][_0x4d7be3(0x110)](_0x4d7be3(0x1c2));const _0x3fcf00=_0x2dc823[_0x4d7be3(0x116)]||{};try{const _0x20d5da=await this['scanForDevices'](_0x3fcf00);this['sendTo'](_0x2dc823['from'],_0x2dc823[_0x4d7be3(0x1f8)],{'success':!![],'devices':_0x20d5da},_0x2dc823['callback']);}catch(_0x40e95a){this[_0x4d7be3(0x222)](_0x2dc823[_0x4d7be3(0x1bf)],_0x2dc823[_0x4d7be3(0x1f8)],{'success':![],'error':_0x40e95a[_0x4d7be3(0x116)]},_0x2dc823['callback']);}}else{if(_0x2dc823[_0x4d7be3(0x1f8)]===_0x4d7be3(0xf6)){const {historyId:_0x1a299e,rating:_0x207f7e,comment:_0x5f1395,alertReason:_0x3a478f}=_0x2dc823[_0x4d7be3(0x116)];_0x1a299e&&_0x207f7e?(await this[_0x4d7be3(0x152)]({'timestamp':Date[_0x4d7be3(0x132)](),'historyId':_0x1a299e,'rating':_0x207f7e,'comment':_0x5f1395,'alertReason':_0x3a478f}),this[_0x4d7be3(0x222)](_0x2dc823[_0x4d7be3(0x1bf)],_0x2dc823[_0x4d7be3(0x1f8)],{'success':!![]},_0x2dc823[_0x4d7be3(0x16d)])):this[_0x4d7be3(0x222)](_0x2dc823[_0x4d7be3(0x1bf)],_0x2dc823['command'],{'success':![],'error':'Missing\x20data'},_0x2dc823[_0x4d7be3(0x16d)]);}}}}}}}}}if(require[a0_0x40ed77(0x202)]!==module)module[a0_0x40ed77(0x12e)]=_0x4c0e5f=>new CogniLiving(_0x4c0e5f);else new CogniLiving();function a0_0x433d(){const _0x3b2d0a=['\x20sensors...','generic','sendNotification','info','unknown','uuid-not-found','retry','name','runBaselineDriftAnalysis','message','party','aiPersona','analysis.isEmergency','namespace','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','toString','Nein','indicator','Automation\x20Proposals','ltmLtbWindowDays','\x20sent','Alert\x20Reason','getForeignStateAsync','createDailyDigest','toISOString','2vytGJi','analysis.automation','LTM.driftAnalysis.baselineDrift','error','systemUUID','üö®\x20Dead\x20Man\x27s\x20Switch:\x20Keine\x20Aktivit√§t\x20seit\x20','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','eventHistory','exports','lastCheck','Feedback\x20Log','GUEST','now','Adapter','Presence\x20Status','analysis.analysisHistory','Drift\x20Status','cancel','analysis.deviationFromBaseline','1816732tlsjXA','Exit-Timer\x20abgelaufen:\x20Keine\x20Bewegung\x20innen\x20erkannt\x20->\x20ABWESEND.','date','trim','flur','sendToAsync','analysis.automation.description','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','9wzeQmv','Gast','Gemini\x20Init\x20Error:\x20','length','Daily\x20Digests','setupLtmScheduler','@iobroker/adapter-core','Comfort\x20Summary','systemConfig','saveRawEventLog','currentSystemMode','Logbook','replace','LTM.driftAnalysis.driftDetails','[TEST]\x20','unshift','Pr√§senz-Status\x20ge√§ndert:\x20','saveFeedback','events.history_debug_02','LTM.driftAnalysis','\x0a\x0aA\x20(STB):\x0a','Started\x20at\x20','Cogni-Living\x20Alert','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20}\x20}','getForeignObjectsAsync','LTM.processingStatus','enum.functions.*','notifyPushoverRecipient','Action','notifyEmailRecipient','system.meta.uuid','LTM','latitude','map','runAutopilot','longitude','notifySignalEnabled','includes','@google/generative-ai','analysis.feedbackHistory','notifyWhatsappInstance','notifySignalInstance','triggerDailyDigest','search','callback','text','native','models/gemini-flash-latest','livingContext','.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','setObjectNotExistsAsync','guest','geminiApiKey','scanDevices','driftAnalysisTimer','NORMAL','genAI','pop','rawEventLog','Gemini\x20API\x20Key\x20missing.\x20AI\x20features\x20disabled.','events.history_debug_03','Lernphase\x20(','generateContent','analysis.automation.patternDetected','onStateChange','find','inactivityMonitoringEnabled','text.alarm','cogni-living','setupDriftAnalysisScheduler','analysis.isAlert','loadDailyDigests','json','testApiKey','(((.+)+)+)+$','val','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','summary','LTM.baselineStatus','Deviation','details','1416574jwNjzD','cleanUpZombies','createAllObjects','ack','events.history_debug_04','activity','System\x20Mode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','resetAnalysisStates','notifySignalRecipient','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','alertReason','setupModeResetScheduler','.\x20PR√ÑSENZ:\x20','notifyEmailInstance','unload','N/A\x20(Learning)','notifyTelegramEnabled','eingang','Konnte\x20System-Standort\x20nicht\x20laden.','catch','system.isPresent','N/A\x20(Pro\x20Feature)','apiKey','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','analysis.activitySummary','runGeminiAnalysis','5476360AgwUGm','subscribeForeignStatesAsync','config','checkLicense','debug','loadHistoryFromState','Success:\x20Compressed\x20','Description','driftDetails','analysis.history_debug_03','analysisHistory','push','Activity\x20Summary','location','lastAlertState','send','updateAnalysisHistory','from','Party','saveDailyDigests','Received\x20scanDevices\x20request\x20from\x20Admin\x20UI.','\x20Stunden!','Error:\x20','application/json','indicator.alarm','notifyWhatsappEnabled','Processing\x20Status','No\x20recorded\x20events\x20yet.','setState','Last\x20Result','notifyPushoverInstance','Urlaub','stringify','inactivityThresholdHours','loadSystemMode','‚ùå\x20Gemini\x20Model\x20not\x20initialized!\x20Check\x20API\x20Key.','Pattern\x20Detected','sound','‚úÖ\x20Gemini\x20Response\x20received.','11sqPXlI','Last\x20Check','analysisTimer','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','37435630kPTpYI','User\x20Feedback:\x20Alarm\x20\x22','analysis.lastResult','Deaktiviert\x20(Pro-Feature)','join','analysisInterval','ANWESEND\x20üè†','sensorLastValues','ltmJob','isPresent','uuid-error','7687530SnVXJC','getStateAsync','scheduleJob','system.mode','parse','string','getObjectAsync','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','exitTimer','isProVersion','getLtmData','toLocaleString','setPresence','Skipped\x20(No\x20AI\x20or\x20Data)','licenseKey','logDuplicates','Success','stateChange','feedbackHistory','Exit\x20Grace\x20Period\x20beendet.\x20√úberwache\x20nun\x20Innenraum...','command','Starting\x20Autopilot\x20(','Drift\x20Details','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20ungew√∂hnliche\x20n√§chtliche\x20Aktivit√§t.','slice','enum','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','bind','LTM.rawEventLog','modeResetJob','main','common','Subscribing\x20to\x20','warn','onUnload','getEnums','notifyTelegramRecipient','onReady','getGenerativeModel','events.history_debug_00','activityLevel','Fenster/T√ºr','0\x203\x20*\x20*\x20*','No\x20recent\x20activity.','events.history','.\x20ORT:\x20','minDaysForBaseline','No\x20Key','getForeignObjectAsync','24gOqrQI','notifyEmailEnabled','substring','boolean','response','loadRawEventLog','Comfort\x20Suggestion','de-DE','\x20events',')\x20-\x20DEBUG\x20MODE\x20ENABLED','ltmStbWindowDays','\x20min).\x20Watchdog\x20Limit:\x20','ready','sendTo','setStateAsync','constructor','geminiModel','events.history_debug_01','checkLtmDriftObjects','abortExitTimer','toFixed','toLowerCase','AI\x20Alert\x20Status','notifyPushoverEnabled','type','Baseline\x20Status','startsWith','extendObjectAsync','LTM.triggerDailyDigest','ROLLE:\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20KONTEXT:\x20','uuid','analysis.comfortSuggestion','devices','PARTY','Baseline:\x20Inactive\x20(Pro\x20Feature).','min\x20Timer,\x20','‚ö†Ô∏è\x20Alarm','status','startExitTimer','N/A','4545720oCzKyl','notifyTelegramInstance','checkLtmObjects','splice','onMessage','baselineDrift','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','.\x20PERSONA:\x20','cogni-living\x20adapter\x20starting\x20(v','s\x20Grace).','submitFeedback','3353308gpNqLP','channel','VACATION','updateBaselineStatus','getSystemUUID','analysis.alertReason','vacation','analysis.trigger','log','exitGraceTimer','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','city','System\x20Status\x20&\x20Control','isGracePeriodActive','testNotification','object','node-schedule','notifyWhatsappRecipient','dailyDigests','state','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','TEST-PRO-KEY'];a0_0x433d=function(){return _0x3b2d0a;};return a0_0x433d();}