const a0_0xbecd4a=a0_0x3fd4;(function(_0x343e53,_0x49a269){const _0x330264=a0_0x3fd4,_0x5c6a2e=_0x343e53();while(!![]){try{const _0x5a472e=-parseInt(_0x330264(0x125))/0x1*(-parseInt(_0x330264(0x11f))/0x2)+-parseInt(_0x330264(0x10b))/0x3*(parseInt(_0x330264(0x1e3))/0x4)+parseInt(_0x330264(0xd7))/0x5*(-parseInt(_0x330264(0x20a))/0x6)+parseInt(_0x330264(0x11a))/0x7*(-parseInt(_0x330264(0x1de))/0x8)+parseInt(_0x330264(0x20c))/0x9*(parseInt(_0x330264(0x1e5))/0xa)+parseInt(_0x330264(0x193))/0xb*(parseInt(_0x330264(0x150))/0xc)+parseInt(_0x330264(0x216))/0xd;if(_0x5a472e===_0x49a269)break;else _0x5c6a2e['push'](_0x5c6a2e['shift']());}catch(_0x9d3f5a){_0x5c6a2e['push'](_0x5c6a2e['shift']());}}}(a0_0x85df,0x3ebcb));function a0_0x3fd4(_0x3b96ae,_0x1cac75){const _0x16e6a7=a0_0x85df();return a0_0x3fd4=function(_0x360858,_0x1ec849){_0x360858=_0x360858-0xc7;let _0x85dfbd=_0x16e6a7[_0x360858];return _0x85dfbd;},a0_0x3fd4(_0x3b96ae,_0x1cac75);}const a0_0x1ec849=(function(){let _0x367481=!![];return function(_0x14ce01,_0x1a8cb8){const _0x3294ea=_0x367481?function(){const _0x3d434a=a0_0x3fd4;if(_0x1a8cb8){const _0x65814d=_0x1a8cb8[_0x3d434a(0x157)](_0x14ce01,arguments);return _0x1a8cb8=null,_0x65814d;}}:function(){};return _0x367481=![],_0x3294ea;};}()),a0_0x360858=a0_0x1ec849(this,function(){const _0x2549f8=a0_0x3fd4;return a0_0x360858['toString']()[_0x2549f8(0x1eb)](_0x2549f8(0x1f4))[_0x2549f8(0x156)]()[_0x2549f8(0x144)](a0_0x360858)[_0x2549f8(0x1eb)]('(((.+)+)+)+$');});a0_0x360858();'use strict';const utils=require(a0_0xbecd4a(0x218)),{GoogleGenerativeAI}=require(a0_0xbecd4a(0x1b0)),path=require(a0_0xbecd4a(0x1ae)),fs=require('fs'),installer=require(a0_0xbecd4a(0x16c)),scanner=require('./lib/scanner'),schedulers=require('./lib/scheduler'),topology=require(a0_0xbecd4a(0x14c)),setup=require(a0_0xbecd4a(0x175)),recorder=require(a0_0xbecd4a(0x197)),pythonBridge=require(a0_0xbecd4a(0x204)),aiAgent=require(a0_0xbecd4a(0xe2)),deadMan=require(a0_0xbecd4a(0x191)),automation=require(a0_0xbecd4a(0x222)),GEMINI_MODEL=a0_0xbecd4a(0xdc);function a0_0x85df(){const _0x448347=['fill','getAbsoluteDefaultDataDir','triggerBriefing','shift','split','keys','isSolar','dependencyInstallInProgress','text','...','healthTrendInterval','TRAIN_SECURITY','briefingJob','events.history','ack','motion','updateHealthVector','General\x20Activity\x20Trend','sendNotification','filter','loadSystemMode','readFileSync','generateHealthReport','runGeminiAnalysis','./lib/dead_man','analysis.automation.patternDetected','11CHJTvn','analysis.prediction.trackerConfidence','isRelevantActivity','runPythonHealthCheck','./lib/recorder','name','analysis.security.learningStatus','[PythonBridge]\x20Forwarding\x20command:\x20','VACATION','analysis.visualization.pulse','NORMAL','.uptime','sensorLastValues','geminiModel','enum.rooms.*','scanDevices','generateContent','analysis.training.triggerTopology','weatherTempId','getForeignStateAsync','L√ºften\x20empfohlen','infrasoundThreshold','calendarName','Sonne:\x20','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','rawEventLog','analysis.health.todayRoomDetails','path','Init...','@google/generative-ai','response','type','command','toLocaleTimeString','currentSystemMode','onStateChange','createAllObjects','onReady','add','getEnums','times','analysis.ventilation.lastWindow','analysis.prediction.trackerTopRoom','log','initSystemConfig','temperature','isArray','TRAIN_COMFORT','pop','cogni-living','lastTrackerEventTime','triggerGaitAnalysis\x20parse\x20error:\x20','klar','config','max','getObjectViewAsync','initSchedules','analysis.security.lastScore','updateTopologyMatrix','getStateAsync','writeFileSync','LTM.triggerDailyDigest','\x20-\x20','common','updateLocation','getHours','setObjectNotExistsAsync','modeResetJob','infrasoundArmingId','Gemini\x20Report\x20Day','toLocaleDateString','analysis.health.geminiNight','updateSchedulePreview','warn','PREDICT_ENERGY','208rFmXKC','startSystem','open','main','onMessage','4BRdlOD','Gemini\x20Init\x20Error:\x20','70tlfCib','de-DE','moduleEnergy','slice','stateChange','analysis.energy.warmupSources','search','cogni-living\x20adapter\x20starting\x20(v','energy','info','infrasoundEnabled','üí®\x20L√ºftung\x20in\x20','getCalendarNames','analysis.health.activityTrend','rows','(((.+)+)+)+$','node-schedule','health','getDate','checkLicense','LTM.dailyDigests','comfort','.last_seen','\x20sequences','devices','¬∞C,\x20Au√üen:\x20','licenseKey','CALCULATE_HEALTH_TREND','üíæ\x20Saving\x20Daily\x20History\x20for\x20','version',':\x20Temp-Differenz\x20','./lib/python_bridge','isGracePeriodActive','round','59\x2023\x20*\x20*\x20*','üï∏Ô∏è\x20Topology\x20Matrix\x20manually\x20updated\x20by\x20user.','moduleHealth','6yHhnPK','min','257724HieyjS','value','system.adapter.','scanForDevices','SYSTEM_MODES','onUnload','map','ltmJob','message','Daily\x20Room\x20Details\x20(48x30min)','7634978vyQZkm','analysis.training.triggerComfort','@iobroker/adapter-core','unshift','analysis.training.triggerEnergy','matrix','calendarCheckTimer','stringify','getOverviewData','refreshCalendar\x20failed:\x20','replayTodayEvents','bind','./lib/automation','unload','parse','analysis.trigger','analysis.training.triggerHealth','No\x20data','timestamp','substring','TRAIN_HEALTH','Invalid\x20matrix\x20data','üìù\x20Manual\x20event\x20logged:\x20','testContext','weatherunderground.0','\x22history\x22:{}','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','number','subscribeStates','checkSolarCondition','utf8','object','Warm-Up\x20Time','moduleComfort','lastAlertState','analyzeWindowOpening','sonn','accuweather.0','refreshCalendar','Gemini\x20Report\x20Night','LTM.trainingData.sequences','door','from','floor','debug','.system.mode','analysis.health.geminiDay','exitGraceTimer','system.adapter.ical.È¶ô','processSensorEvent','presenceDevices','automation.triggerAction','Room\x20Dwell\x20Time\x20Stats','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','triggerGaitAnalysis','\x20events\x20from\x20today...','2478725MFIbNG','infrasoundSensorId','mkdirSync','window','setState','models/gemini-flash-latest','toFixed','checkWifiPresence','join','memoryCache','LTM.rawEventLog','./lib/ai_agent','Party\x20Mode','clear','getForeignObjectsAsync','instance','updateTopologyMatrix\x20failed:\x20','‚Ü∫\x20Replaying\x20','bin',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','appendToLog','integrateRoomTime','.json','length','sendMorningBriefing','getTime','roomIntegratorTimer','callback','triggerHealth\x20error:\x20','getMinutes','system.adapter.ical.','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','Lernphase\x20(','scanThermostats','triggerEnergyPrediction','now','endsWith','pythonBridge','infrasoundLocked','analysis.health.todayVector','existsSync','Unknown','system','activeModules','\x20rooms)','createDailyDigest','enum','Keine\x20Daten','party','analysis.activity.roomStats','exports','Warte\x20auf\x20Analyse...','1137039xlOdNS','pressureBuffer',',\x20Events:\x0a','Guest\x20Mode','testApiKey','moduleSecurity','setStateAsync','telegram','manual','No\x20topology\x20data\x20found','\x20>\x20','checkThermostats','analysis.automation.targetId','isProVersion','Unbekannt','122990OgMdTt','\x20Tage)','eventHistory','isPresent','sources','36282vnRAUF','saveDailyHistory','string','updateTopology','communicate.request','some','22PVrKDv','values','includes','cancel','error','analyzeWindowOpening\x20error:\x20','enum.functions.*','analysis.activity.roomHistory','find',',\x20Temp:\x20','setPresence','analysis.energy.warmupTimes','security','thermostat','triggerInfrasoundCorrelation','toLowerCase','NIGHT','subscribeForeignStates','minDaysForBaseline','abs','Sec-Training\x20started...','bootTime','modules','analysis.topology.structure','protectAiMemory','analysis.automation.targetValue','¬∞C)','dailyDigests','analysis.safety.infrasoundAlert','history','ERROR','constructor','location','Verbindung\x20erfolgreich:\x20','push','setHours','checkCalendarTriggers','NextHours.Location_1.Day_1.current.symbol_desc','Manual\x20Event','./lib/topology','geminiApiKey','inactivityThresholdHours','{\x22history\x22:{}}','4820268eJIDLe','TRAIN_TOPOLOGY','application/json','online','val','subscribeForeignStatesAsync','toString','apply','genAI','\x20events\x20from\x20standard\x20storage.','json','system.presenceWho','startService','trackerHeartbeat','Current.WeatherText','send','Live\x20Event\x20Pulse','SET_LEARNING_MODE','‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','presenceCheckTimer','ready','cleanupGhostInterventions','Room\x20History\x20(24h\x20Buckets)','historyJob','handleInfrasound','todayVector','getGenerativeModel','useCalendar','./lib/installer','analysisTimer','.data.table','Niemand','date','¬∞C\x20(Innen:\x20','state','analysis.training.status','sendTo','./lib/setup','forEach','namespace','‚úÖ\x20History\x20saved:\x20'];a0_0x85df=function(){return _0x448347;};return a0_0x85df();}class CogniLiving extends utils['Adapter']{constructor(_0x466190){const _0x4f970d=a0_0xbecd4a;super({..._0x466190,'name':_0x4f970d(0x1c4)}),this[_0x4f970d(0x11c)]=[],this['analysisHistory']=[],this[_0x4f970d(0x1ac)]=[],this['dailyDigests']=[],this['sensorLastValues']={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this[_0x4f970d(0xce)]=null,this[_0x4f970d(0x205)]=![],this[_0x4f970d(0x158)]=null,this['geminiModel']=null,this[_0x4f970d(0x1b5)]=setup['SYSTEM_MODES'][_0x4f970d(0x19d)],this[_0x4f970d(0x118)]=![],this[_0x4f970d(0x239)]=![],this[_0x4f970d(0x16d)]=null,this[_0x4f970d(0x21c)]=null,this[_0x4f970d(0x163)]=null,this[_0x4f970d(0x213)]=null,this[_0x4f970d(0x1d6)]=null,this['driftAnalysisTimer']=null,this[_0x4f970d(0x185)]=null,this[_0x4f970d(0x167)]=null,this[_0x4f970d(0x15d)]=null,this[_0x4f970d(0x183)]=null,this[_0x4f970d(0xf1)]=null,this[_0x4f970d(0x180)]=![],this[_0x4f970d(0x1c5)]=Date[_0x4f970d(0xfa)](),this['memoryCache']=null,this[_0x4f970d(0x13a)]=Date[_0x4f970d(0xfa)](),this[_0x4f970d(0xfd)]=![],this['pressureBuffer']=[],this[_0x4f970d(0x102)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x4f970d(0x164),this['onReady'][_0x4f970d(0x221)](this)),this['on'](_0x4f970d(0x1e9),this[_0x4f970d(0x1b6)][_0x4f970d(0x221)](this)),this['on'](_0x4f970d(0x223),this[_0x4f970d(0x211)][_0x4f970d(0x221)](this)),this['on'](_0x4f970d(0x214),this['onMessage'][_0x4f970d(0x221)](this));}async[a0_0xbecd4a(0x1b8)](){const _0x917b13=a0_0xbecd4a;this[_0x917b13(0x1be)][_0x917b13(0x1ee)](_0x917b13(0x1ec)+this[_0x917b13(0x202)]+_0x917b13(0xea));if(this[_0x917b13(0x1c8)][_0x917b13(0x209)]!==undefined)this['activeModules']['health']=this[_0x917b13(0x1c8)][_0x917b13(0x209)];if(this['config'][_0x917b13(0x110)]!==undefined)this[_0x917b13(0x102)]['security']=this['config'][_0x917b13(0x110)];if(this[_0x917b13(0x1c8)][_0x917b13(0x1e7)]!==undefined)this[_0x917b13(0x102)]['energy']=this[_0x917b13(0x1c8)][_0x917b13(0x1e7)];if(this[_0x917b13(0x1c8)][_0x917b13(0x238)]!==undefined)this[_0x917b13(0x102)][_0x917b13(0x1fa)]=this[_0x917b13(0x1c8)][_0x917b13(0x238)];if(this[_0x917b13(0x1c8)][_0x917b13(0x13b)])this['activeModules']={...this['activeModules'],...this[_0x917b13(0x1c8)][_0x917b13(0x13b)]};this['startSystem']();}async[a0_0xbecd4a(0x1df)](){const _0x37fe4d=a0_0xbecd4a;await setup['initZombies'](this);try{this[_0x37fe4d(0x118)]=await setup[_0x37fe4d(0x1f8)](this[_0x37fe4d(0x1c8)][_0x37fe4d(0x1ff)]);}catch(_0x42b6be){}if(!this[_0x37fe4d(0x1c8)][_0x37fe4d(0x14e)]||this['config'][_0x37fe4d(0x14e)]<0.1)this[_0x37fe4d(0x1c8)][_0x37fe4d(0x14e)]=0xc;await setup['initHistory'](this),await setup[_0x37fe4d(0x1bf)](this),topology[_0x37fe4d(0x122)](this);try{const _0x50fc38=await this[_0x37fe4d(0x1ce)](_0x37fe4d(0x130)),_0x231cf6=await this['getStateAsync']('analysis.energy.warmupSources');_0x50fc38&&_0x50fc38[_0x37fe4d(0x154)]&&_0x231cf6&&_0x231cf6[_0x37fe4d(0x154)]&&(Date[_0x37fe4d(0xfa)]()-_0x50fc38['ts']<0x4*0xe10*0x3e8&&(this['memoryCache']={'times':JSON[_0x37fe4d(0x224)](_0x50fc38[_0x37fe4d(0x154)]),'sources':JSON[_0x37fe4d(0x224)](_0x231cf6['val'])}));}catch(_0x5adb7d){}if(this[_0x37fe4d(0x1c8)][_0x37fe4d(0x14d)])try{this[_0x37fe4d(0x158)]=new GoogleGenerativeAI(this[_0x37fe4d(0x1c8)][_0x37fe4d(0x14d)]),this[_0x37fe4d(0x1a0)]=this[_0x37fe4d(0x158)][_0x37fe4d(0x16a)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x37fe4d(0x152)}});}catch(_0x107a0c){this[_0x37fe4d(0x1be)][_0x37fe4d(0x129)](_0x37fe4d(0x1e4)+_0x107a0c[_0x37fe4d(0x214)]);}await setup[_0x37fe4d(0x1b7)](this),await this[_0x37fe4d(0x18d)](),schedulers[_0x37fe4d(0x1cb)](this),await this[_0x37fe4d(0x1d5)](_0x37fe4d(0x19c),{'type':_0x37fe4d(0x172),'common':{'name':_0x37fe4d(0x160),'type':_0x37fe4d(0x232),'role':_0x37fe4d(0x20d),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x37fe4d(0x108),{'type':_0x37fe4d(0x172),'common':{'name':_0x37fe4d(0xd3),'type':'string','role':_0x37fe4d(0x15a),'read':!![],'write':![],'def':'{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}'},'native':{}}),await this[_0x37fe4d(0x1d5)](_0x37fe4d(0x12c),{'type':'state','common':{'name':_0x37fe4d(0x166),'type':'string','role':_0x37fe4d(0x15a),'read':!![],'write':![],'def':_0x37fe4d(0x14f)},'native':{}}),await this['setObjectNotExistsAsync'](_0x37fe4d(0x1da),{'type':'state','common':{'name':_0x37fe4d(0x23e),'type':_0x37fe4d(0x121),'role':_0x37fe4d(0x181),'read':!![],'write':![],'def':_0x37fe4d(0x10a)},'native':{}}),await this[_0x37fe4d(0x1d5)](_0x37fe4d(0xcd),{'type':_0x37fe4d(0x172),'common':{'name':_0x37fe4d(0x1d8),'type':_0x37fe4d(0x121),'role':'text','read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x37fe4d(0x1d5)](_0x37fe4d(0xfe),{'type':_0x37fe4d(0x172),'common':{'name':'Daily\x20Activity\x20Vector\x20(48x30min)','type':_0x37fe4d(0x121),'role':_0x37fe4d(0x15a),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x37fe4d(0x1d5)](_0x37fe4d(0x1ad),{'type':_0x37fe4d(0x172),'common':{'name':_0x37fe4d(0x215),'type':'string','role':_0x37fe4d(0x15a),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x37fe4d(0x1d5)](_0x37fe4d(0x1f2),{'type':_0x37fe4d(0x172),'common':{'name':_0x37fe4d(0x18a),'type':_0x37fe4d(0x232),'role':'value','unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x37fe4d(0x1d5)](_0x37fe4d(0x130),{'type':_0x37fe4d(0x172),'common':{'name':_0x37fe4d(0x237),'type':_0x37fe4d(0x121),'role':_0x37fe4d(0x15a),'read':!![],'write':![]},'native':{}});try{const _0x315b46=await this[_0x37fe4d(0x1ce)](_0x37fe4d(0x186));if(_0x315b46&&_0x315b46[_0x37fe4d(0x154)]){this[_0x37fe4d(0x11c)]=JSON[_0x37fe4d(0x224)](_0x315b46[_0x37fe4d(0x154)]);if(this[_0x37fe4d(0x118)]){const _0x2fe0ff=await this[_0x37fe4d(0x1ce)]('LTM.rawEventLog');if(_0x2fe0ff&&_0x2fe0ff[_0x37fe4d(0x154)])this[_0x37fe4d(0x1ac)]=JSON[_0x37fe4d(0x224)](_0x2fe0ff[_0x37fe4d(0x154)]);}this['log']['info']('üì¶\x20Restored\x20'+this['eventHistory'][_0x37fe4d(0xee)]+_0x37fe4d(0x159));}}catch(_0x2d9af0){this[_0x37fe4d(0x11c)]=[];}try{const _0x5ce969=await this[_0x37fe4d(0x1ce)](_0x37fe4d(0x1f9));if(_0x5ce969&&_0x5ce969[_0x37fe4d(0x154)])this[_0x37fe4d(0x140)]=JSON[_0x37fe4d(0x224)](_0x5ce969[_0x37fe4d(0x154)]);}catch(_0x5a6582){this['dailyDigests']=[];}const _0x4b06ea=this[_0x37fe4d(0x140)][_0x37fe4d(0xee)]>=(this[_0x37fe4d(0x1c8)][_0x37fe4d(0x137)]||0x7)?'Aktiv\x20('+this['dailyDigests']['length']+_0x37fe4d(0x11b):_0x37fe4d(0xf7)+this['dailyDigests'][_0x37fe4d(0xee)]+'/'+(this['config'][_0x37fe4d(0x137)]||0x7)+')';await this[_0x37fe4d(0x111)]('LTM.baselineStatus',{'val':_0x4b06ea,'ack':!![]}),this['subscribeStates']('analysis.trigger'),this[_0x37fe4d(0x233)](_0x37fe4d(0x1d0)),this[_0x37fe4d(0x233)](_0x37fe4d(0x226));this[_0x37fe4d(0x1c8)][_0x37fe4d(0x1ef)]&&this[_0x37fe4d(0x1c8)][_0x37fe4d(0xd8)]&&this['activeModules']['security']&&this[_0x37fe4d(0x136)](this[_0x37fe4d(0x1c8)][_0x37fe4d(0xd8)]);const _0x1294ad=this[_0x37fe4d(0x1c8)][_0x37fe4d(0x1fd)];if(_0x1294ad)for(const _0x319908 of _0x1294ad){await this['subscribeForeignStatesAsync'](_0x319908['id']);}const _0x2f76d6=this[_0x37fe4d(0x1c8)][_0x37fe4d(0xd1)];if(_0x2f76d6)for(const _0x3e5608 of _0x2f76d6){await this[_0x37fe4d(0x155)](_0x3e5608);}const _0x5c2eb1=require(_0x37fe4d(0x1f5));if(this[_0x37fe4d(0x167)])this[_0x37fe4d(0x167)]['cancel']();this[_0x37fe4d(0x167)]=_0x5c2eb1['scheduleJob'](_0x37fe4d(0x207),()=>{const _0x5f0461=_0x37fe4d;this[_0x5f0461(0x120)]();}),setTimeout(()=>this[_0x37fe4d(0x220)](),0x1388);if(this[_0x37fe4d(0xf1)])clearInterval(this['roomIntegratorTimer']);this['integrateRoomTime'](),this[_0x37fe4d(0xf1)]=setInterval(async()=>{const _0x588b08=_0x37fe4d;await this[_0x588b08(0xec)]();},0x3c*0x3e8);if(this[_0x37fe4d(0x183)])clearInterval(this[_0x37fe4d(0x183)]);this[_0x37fe4d(0x183)]=setInterval(()=>{const _0x20c969=_0x37fe4d;this['isProVersion']&&this[_0x20c969(0x102)][_0x20c969(0x1f6)]&&this[_0x20c969(0x196)]();},0x4*0x3c*0x3c*0x3e8);if(this['analysisTimer'])clearInterval(this[_0x37fe4d(0x16d)]);this[_0x37fe4d(0x102)][_0x37fe4d(0x1ed)]&&(this[_0x37fe4d(0x16d)]=setInterval(()=>{const _0x500ccd=_0x37fe4d;this[_0x500ccd(0xf9)]();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x37fe4d(0xf9)](),0x2710));if(this[_0x37fe4d(0x21c)])clearInterval(this[_0x37fe4d(0x21c)]);this[_0x37fe4d(0x1c8)][_0x37fe4d(0x16b)]&&this[_0x37fe4d(0x102)][_0x37fe4d(0x1ed)]&&(this[_0x37fe4d(0x21c)]=setInterval(()=>{const _0x3b050e=_0x37fe4d;automation[_0x3b050e(0x149)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x37fe4d(0x149)](this),0x3a98));if(this[_0x37fe4d(0x163)])clearInterval(this[_0x37fe4d(0x163)]);this['config'][_0x37fe4d(0xd1)]&&this['config'][_0x37fe4d(0xd1)][_0x37fe4d(0xee)]>0x0&&(this[_0x37fe4d(0x163)]=setInterval(async()=>{const _0x110085=_0x37fe4d;await this[_0x110085(0xde)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0x37fe4d(0xde)](),0x1388));const _0x29f377=path[_0x37fe4d(0xdf)](__dirname,'.venv',_0x37fe4d(0xe9),'python');pythonBridge[_0x37fe4d(0x15c)](this,_0x29f377);}[a0_0xbecd4a(0x211)](_0x1f49c4){const _0x78bbf2=a0_0xbecd4a;if(this['historyJob'])this[_0x78bbf2(0x167)][_0x78bbf2(0x128)]();this[_0x78bbf2(0x120)]()['then'](()=>{const _0x2fdc1d=_0x78bbf2;if(this[_0x2fdc1d(0x16d)])clearInterval(this[_0x2fdc1d(0x16d)]);if(this[_0x2fdc1d(0x21c)])clearInterval(this[_0x2fdc1d(0x21c)]);if(this[_0x2fdc1d(0x163)])clearInterval(this[_0x2fdc1d(0x163)]);if(this[_0x2fdc1d(0xf1)])clearInterval(this['roomIntegratorTimer']);recorder['abortExitTimer'](this),pythonBridge['stopService'](this),_0x1f49c4();});}async[a0_0xbecd4a(0x220)](){const _0x5693ed=a0_0xbecd4a;if(!this['eventHistory']||this[_0x5693ed(0x11c)][_0x5693ed(0xee)]===0x0){this[_0x5693ed(0x1be)][_0x5693ed(0x1dc)](_0x5693ed(0x230));return;}this[_0x5693ed(0x1be)][_0x5693ed(0x1ee)](_0x5693ed(0xe8)+this['eventHistory'][_0x5693ed(0xee)]+_0x5693ed(0xd6));const _0x24fff0=new Date()[_0x5693ed(0x148)](0x0,0x0,0x0,0x0),_0x45fc99=_0x5693ed(0x12c);let _0x5204ad={'history':{},'date':new Date()[_0x5693ed(0x1d9)]()};const _0x55bad0='analysis.health.todayVector',_0x41ba10=_0x5693ed(0x1ad);let _0x598a76=new Array(0x30)[_0x5693ed(0x179)](0x0),_0x210847=Array['from']({'length':0x30},()=>[]);this[_0x5693ed(0x11c)][_0x5693ed(0x176)](_0x3370b1=>{const _0x31acdd=_0x5693ed;if(_0x3370b1['timestamp']>=_0x24fff0){if(recorder[_0x31acdd(0x195)](_0x3370b1[_0x31acdd(0x1b2)],_0x3370b1[_0x31acdd(0x20d)])){const _0x4fb0d2=new Date(_0x3370b1[_0x31acdd(0x228)]),_0x3a7963=_0x4fb0d2['getHours']()*0x2+(_0x4fb0d2[_0x31acdd(0xf4)]()>=0x1e?0x1:0x0);if(_0x3a7963<0x30){_0x598a76[_0x3a7963]++;const _0x168211=_0x3370b1['location']||_0x3370b1[_0x31acdd(0x198)]||'?';let _0xd2f7a=_0x210847[_0x3a7963];!_0xd2f7a[_0x31acdd(0x127)](_0x168211)&&_0xd2f7a[_0x31acdd(0x147)](_0x168211);}const _0x23a611=_0x4fb0d2['getHours']();let _0x3d0ae5=_0x3370b1[_0x31acdd(0x145)]||'Unknown';const _0x16cf42=(this[_0x31acdd(0x1c8)]['devices']||[])[_0x31acdd(0x12d)](_0x5e01aa=>_0x5e01aa[_0x31acdd(0x145)]===_0x3d0ae5);if(_0x16cf42)_0x3d0ae5=_0x16cf42[_0x31acdd(0x145)];if(!_0x5204ad['history'][_0x3d0ae5])_0x5204ad[_0x31acdd(0x142)][_0x3d0ae5]=new Array(0x18)[_0x31acdd(0x179)](0x0);if(_0x5204ad['history'][_0x3d0ae5][_0x23a611]<0x3c)_0x5204ad[_0x31acdd(0x142)][_0x3d0ae5][_0x23a611]++;}}});const _0x4a9d66=await this[_0x5693ed(0x1ce)](_0x45fc99);(!_0x4a9d66||!_0x4a9d66['val']||_0x4a9d66[_0x5693ed(0x154)]==='{}'||_0x4a9d66[_0x5693ed(0x154)]['includes'](_0x5693ed(0x22f)))&&await this['setStateAsync'](_0x45fc99,{'val':JSON['stringify'](_0x5204ad),'ack':!![]}),await this[_0x5693ed(0x111)](_0x55bad0,{'val':JSON[_0x5693ed(0x21d)](_0x598a76),'ack':!![]}),await this[_0x5693ed(0x111)](_0x41ba10,{'val':JSON['stringify'](_0x210847),'ack':!![]}),this[_0x5693ed(0x1be)][_0x5693ed(0x1ee)](_0x5693ed(0x231));}async[a0_0xbecd4a(0x120)](){const _0x429250=a0_0xbecd4a;if(!this[_0x429250(0x102)][_0x429250(0x1f6)])return;const _0x509c2f=new Date()['toISOString']()['split']('T')[0x0];this[_0x429250(0x1be)]['debug'](_0x429250(0x201)+_0x509c2f+_0x429250(0x182));try{const [_0xdaa352,_0x5ddef3,_0x58f03e,_0x2df021,_0x3ad1b,_0x4232b4,_0x315f2f]=await Promise['all']([this['getStateAsync'](_0x429250(0x12c)),this[_0x429250(0x1ce)](_0x429250(0x1da)),this[_0x429250(0x1ce)]('analysis.health.geminiDay'),this[_0x429250(0x1ce)](_0x429250(0x1cc)),this['getStateAsync'](_0x429250(0xfe)),this['getStateAsync'](_0x429250(0x1f2)),this[_0x429250(0x1ce)]('analysis.health.gaitSpeed')]),_0x476268=new Date()[_0x429250(0x148)](0x0,0x0,0x0,0x0),_0x40a17b=this[_0x429250(0x11c)][_0x429250(0x18c)](_0x17ba09=>_0x17ba09[_0x429250(0x228)]>=_0x476268&&(_0x17ba09[_0x429250(0x198)]['toLowerCase']()[_0x429250(0x127)]('haust√ºr')||_0x17ba09[_0x429250(0x198)][_0x429250(0x134)]()[_0x429250(0x127)]('terrasse'))&&(_0x17ba09['value']===!![]||_0x17ba09[_0x429250(0x20d)]===_0x429250(0x1e0)))[_0x429250(0xee)];let _0x37a948=0x55;if(_0x4232b4&&_0x4232b4[_0x429250(0x154)]!==undefined)_0x37a948=Math[_0x429250(0x20b)](0x64,Math['max'](0x14,Math[_0x429250(0x206)](0x50+Number(_0x4232b4[_0x429250(0x154)])*0x5)));const _0x472257=this[_0x429250(0x11c)]['filter'](_0x42e261=>_0x42e261[_0x429250(0x228)]>=_0x476268),_0x39659e={'date':_0x509c2f,'timestamp':Date['now'](),'roomHistory':_0xdaa352?.[_0x429250(0x154)]?JSON[_0x429250(0x224)](_0xdaa352[_0x429250(0x154)]):{},'geminiNight':_0x5ddef3?.['val']||_0x429250(0x106),'geminiDay':_0x58f03e?.[_0x429250(0x154)]||'Keine\x20Daten','anomalyScore':_0x2df021?.[_0x429250(0x154)]||0.1,'todayVector':_0x3ad1b?.[_0x429250(0x154)]?JSON['parse'](_0x3ad1b[_0x429250(0x154)]):new Array(0x30)['fill'](0x0),'batteryLevel':_0x37a948,'freshAirCount':_0x40a17b,'gaitSpeed':_0x315f2f?.['val']!==undefined&&_0x315f2f?.[_0x429250(0x154)]!==null?Number(_0x315f2f['val']):null,'eventHistory':_0x472257},_0x3c70ef=utils[_0x429250(0x17a)](),_0x413fb6=path['join'](_0x3c70ef,_0x429250(0x1c4),'history');if(!fs[_0x429250(0xff)](_0x413fb6))fs[_0x429250(0xd9)](_0x413fb6,{'recursive':!![]});const _0x3cebbf=path['join'](_0x413fb6,_0x509c2f+_0x429250(0xed));fs[_0x429250(0x1cf)](_0x3cebbf,JSON[_0x429250(0x21d)](_0x39659e)),this[_0x429250(0x1be)]['info'](_0x429250(0x178)+_0x3cebbf);}catch(_0x5553ef){this['log']['error']('History\x20Save\x20Error:\x20'+_0x5553ef[_0x429250(0x214)]);}}async[a0_0xbecd4a(0xec)](){const _0x48cdf5=a0_0xbecd4a;if(!this['isPresent'])return;try{let _0x589241=null;try{const _0x38c07c=await this['getStateAsync'](_0x48cdf5(0x1bd)),_0x21ea0a=await this[_0x48cdf5(0x1ce)](_0x48cdf5(0x194));if(_0x38c07c&&_0x38c07c[_0x48cdf5(0x154)]&&_0x21ea0a&&_0x21ea0a[_0x48cdf5(0x154)]&&_0x21ea0a[_0x48cdf5(0x154)]>0.3){if(_0x38c07c[_0x48cdf5(0x154)]!==_0x48cdf5(0x100)&&_0x38c07c[_0x48cdf5(0x154)]!==_0x48cdf5(0x1af))_0x589241=_0x38c07c[_0x48cdf5(0x154)];}}catch(_0x2ac3da){}if(!_0x589241){const _0x41bebf=this[_0x48cdf5(0x1c8)][_0x48cdf5(0x1fd)]||[];for(const _0x45dd19 of _0x41bebf){if(_0x45dd19[_0x48cdf5(0x1b2)]===_0x48cdf5(0x188)&&_0x45dd19[_0x48cdf5(0x145)])try{const _0x33aa6b=await this['getForeignStateAsync'](_0x45dd19['id']);if(_0x33aa6b&&(_0x33aa6b[_0x48cdf5(0x154)]===!![]||_0x33aa6b[_0x48cdf5(0x154)]==='on'||_0x33aa6b['val']===0x1)){_0x589241=_0x45dd19['location'];break;}}catch(_0x14878b){}}}if(!_0x589241)return;const _0x16e6f7=this[_0x48cdf5(0x1c8)][_0x48cdf5(0x1fd)]||[];let _0x3ad839=_0x589241;const _0x3b802d=_0x16e6f7['find'](_0xae90e0=>_0xae90e0['location']&&_0xae90e0[_0x48cdf5(0x145)][_0x48cdf5(0x134)]()===_0x589241[_0x48cdf5(0x134)]());if(_0x3b802d)_0x3ad839=_0x3b802d['location'];const _0x40b64d=_0x48cdf5(0x12c),_0x30f274=await this[_0x48cdf5(0x1ce)](_0x40b64d),_0x4a8324=new Date()[_0x48cdf5(0x1d9)]();let _0x1edf62={'history':{},'date':_0x4a8324};if(_0x30f274&&_0x30f274['val'])try{_0x1edf62=JSON[_0x48cdf5(0x224)](_0x30f274[_0x48cdf5(0x154)]);}catch(_0xa00751){}_0x1edf62[_0x48cdf5(0x170)]!==_0x4a8324&&(_0x1edf62['history']={},_0x1edf62[_0x48cdf5(0x170)]=_0x4a8324);if(!_0x1edf62[_0x48cdf5(0x142)][_0x3ad839])_0x1edf62[_0x48cdf5(0x142)][_0x3ad839]=new Array(0x18)[_0x48cdf5(0x179)](0x0);const _0x1e2bab=new Date()[_0x48cdf5(0x1d4)]();if(_0x1edf62[_0x48cdf5(0x142)][_0x3ad839][_0x1e2bab]<0x3c)_0x1edf62[_0x48cdf5(0x142)][_0x3ad839][_0x1e2bab]++;await this['setStateAsync'](_0x40b64d,{'val':JSON['stringify'](_0x1edf62),'ack':!![]});}catch(_0x481a7d){this[_0x48cdf5(0x1be)][_0x48cdf5(0x1dc)]('[Integrator]\x20Error:\x20'+_0x481a7d['message']);}}async[a0_0xbecd4a(0x1e2)](_0x17a788){const _0x122e51=a0_0xbecd4a;if(typeof _0x17a788===_0x122e51(0x236)&&_0x17a788['message']){if(_0x17a788[_0x122e51(0x1b3)]==='getHistoryData'){const _0x2dd660=_0x17a788[_0x122e51(0x214)][_0x122e51(0x170)],_0x4ed30b=utils[_0x122e51(0x17a)](),_0x3925cf=path[_0x122e51(0xdf)](_0x4ed30b,_0x122e51(0x1c4),_0x122e51(0x142),_0x2dd660+'.json');if(fs[_0x122e51(0xff)](_0x3925cf))try{const _0x3c2c3b=JSON['parse'](fs[_0x122e51(0x18e)](_0x3925cf,_0x122e51(0x235)));this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':!![],'data':_0x3c2c3b},_0x17a788[_0x122e51(0xf2)]);}catch(_0x2edbc6){this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':![],'error':'Corrupt'},_0x17a788[_0x122e51(0xf2)]);}else this[_0x122e51(0x174)](_0x17a788['from'],_0x17a788[_0x122e51(0x1b3)],{'success':![],'error':_0x122e51(0x227)},_0x17a788[_0x122e51(0xf2)]);}else{if(_0x17a788[_0x122e51(0x1b3)]===_0x122e51(0x21e)){const _0x1e5b41=this[_0x122e51(0x140)][_0x122e51(0xee)];let _0x41aee2=new Array(0x30)[_0x122e51(0x179)](0x0),_0x17e72a=Array['from']({'length':0x30},()=>[]);try{const _0x42a7fa=await this[_0x122e51(0x1ce)]('analysis.health.todayVector');if(_0x42a7fa&&_0x42a7fa[_0x122e51(0x154)])_0x41aee2=JSON['parse'](_0x42a7fa[_0x122e51(0x154)]);const _0xb1f54b=await this[_0x122e51(0x1ce)](_0x122e51(0x1ad));if(_0xb1f54b&&_0xb1f54b[_0x122e51(0x154)])_0x17e72a=JSON[_0x122e51(0x224)](_0xb1f54b[_0x122e51(0x154)]);}catch(_0x253e27){}let _0x47e5f3=new Array(0x30)[_0x122e51(0x179)](0x0);try{const _0x389900=new Date();_0x389900['setDate'](_0x389900[_0x122e51(0x1f7)]()-0x1);const _0x324c1d=_0x389900['toISOString']()[_0x122e51(0x17d)]('T')[0x0],_0xf3e54d=utils['getAbsoluteDefaultDataDir'](),_0x53092b=path['join'](_0xf3e54d,'cogni-living',_0x122e51(0x142),_0x324c1d+_0x122e51(0xed));if(fs[_0x122e51(0xff)](_0x53092b)){const _0xb8ecff=JSON[_0x122e51(0x224)](fs['readFileSync'](_0x53092b,'utf8'));if(_0xb8ecff&&_0xb8ecff['todayVector'])_0x47e5f3=_0xb8ecff[_0x122e51(0x169)];}}catch(_0x2b7b80){}let _0x38c8bd={'today':{},'yesterday':{}};try{const _0x3a2d80=await this[_0x122e51(0x1ce)](_0x122e51(0x108));if(_0x3a2d80&&_0x3a2d80[_0x122e51(0x154)])_0x38c8bd=JSON['parse'](_0x3a2d80['val']);}catch(_0x1e530f){}let _0x5c84d1=null;try{const _0x4013d9=await this[_0x122e51(0x1ce)](_0x122e51(0x1f2));if(_0x4013d9)_0x5c84d1=_0x4013d9[_0x122e51(0x154)];}catch(_0xf1022a){}if(_0x5c84d1===undefined||_0x5c84d1===null){const _0x2447c4=_0x41aee2['reduce']((_0x1b4962,_0x1a9e75)=>_0x1b4962+_0x1a9e75,0x0),_0x1f7b85=Math[_0x122e51(0x20b)](0x2,Math[_0x122e51(0x1c9)](-0x2,(0x64-_0x2447c4)/0x32));_0x5c84d1=_0x1f7b85;}let _0x4bd86b=![],_0x111dac='',_0x45f937='',_0x98a0ce='';try{const _0x3f703e=await this['getStateAsync'](_0x122e51(0x192));if(_0x3f703e&&_0x3f703e['val']){_0x4bd86b=!![];const _0x8292d1=await this[_0x122e51(0x1ce)]('analysis.automation.description');_0x111dac=_0x8292d1?_0x8292d1[_0x122e51(0x154)]:'';const _0x515dca=await this[_0x122e51(0x1ce)](_0x122e51(0x117));_0x45f937=_0x515dca?_0x515dca['val']:'';const _0x3fec5c=await this[_0x122e51(0x1ce)](_0x122e51(0x13e));_0x98a0ce=_0x3fec5c?_0x3fec5c[_0x122e51(0x154)]:'';}}catch(_0x89fb34){}const _0x37d11f=await this[_0x122e51(0x234)](),_0x5f4c14=(this[_0x122e51(0x1c8)][_0x122e51(0x1fd)]||[])[_0x122e51(0x124)](_0x53b912=>_0x53b912[_0x122e51(0x17f)]),_0x284d62=_0x37d11f&&_0x5f4c14;let _0x59428f='';try{const _0x396a0f=await this['getStateAsync'](_0x122e51(0x15b));if(_0x396a0f&&_0x396a0f[_0x122e51(0x154)])_0x59428f=_0x396a0f[_0x122e51(0x154)];}catch(_0x3957e5){}this['sendTo'](_0x17a788['from'],_0x17a788['command'],{'success':!![],'eventHistory':this[_0x122e51(0x11c)][_0x122e51(0x1e8)](0x0,0x7d0),'stats':{'digestCount':_0x1e5b41,'isPresent':this['isPresent'],'hourlyActivity':_0x41aee2,'hourlyDetails':_0x17e72a,'yesterdayActivity':_0x47e5f3,'solarActive':_0x284d62,'presenceWho':_0x59428f,'roomStats':_0x38c8bd,'activityTrend':_0x5c84d1,'modules':this[_0x122e51(0x102)]},'automation':{'detected':_0x4bd86b,'description':_0x111dac,'targetId':_0x45f937,'targetValue':_0x98a0ce}},_0x17a788[_0x122e51(0xf2)]);}else{if(_0x17a788[_0x122e51(0x1b3)]===_0x122e51(0x116))try{const _0x51a380=await automation[_0x122e51(0xf8)](this);this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':!![],'results':_0x51a380},_0x17a788['callback']);}catch(_0x20c593){this[_0x122e51(0x174)](_0x17a788['from'],_0x17a788[_0x122e51(0x1b3)],{'success':![],'error':_0x20c593[_0x122e51(0x214)]},_0x17a788[_0x122e51(0xf2)]);}else{if(_0x17a788['command']===_0x122e51(0x1a2))try{const _0x5eee50=await scanner[_0x122e51(0x20f)](this,_0x17a788[_0x122e51(0x214)]||{});this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':!![],'devices':_0x5eee50},_0x17a788[_0x122e51(0xf2)]);}catch(_0x27face){}else{if(_0x17a788[_0x122e51(0x1b3)]===_0x122e51(0x1ba)){const _0x3a7bf7=await this[_0x122e51(0xe5)](_0x122e51(0x12b),_0x122e51(0x105)),_0x2f3dae=[];if(_0x3a7bf7)for(const _0x49373a in _0x3a7bf7){let _0x2cefe9=_0x3a7bf7[_0x49373a][_0x122e51(0x1d2)][_0x122e51(0x198)];if(_0x2cefe9&&typeof _0x2cefe9===_0x122e51(0x236))_0x2cefe9=_0x2cefe9['de']||_0x2cefe9['en']||Object['values'](_0x2cefe9)[0x0]||JSON[_0x122e51(0x21d)](_0x2cefe9);_0x2f3dae[_0x122e51(0x147)]({'id':_0x49373a,'name':String(_0x2cefe9||_0x49373a)});}const _0x23ee1f=await this[_0x122e51(0xe5)](_0x122e51(0x1a1),'enum'),_0x2d26c4=[];if(_0x23ee1f)for(const _0x12b21f in _0x23ee1f){let _0x2eaf22=_0x23ee1f[_0x12b21f][_0x122e51(0x1d2)][_0x122e51(0x198)];if(_0x2eaf22&&typeof _0x2eaf22===_0x122e51(0x236))_0x2eaf22=_0x2eaf22['de']||_0x2eaf22['en']||Object[_0x122e51(0x126)](_0x2eaf22)[0x0]||JSON['stringify'](_0x2eaf22);_0x2d26c4['push'](String(_0x2eaf22||_0x12b21f[_0x122e51(0x17d)]('.')[_0x122e51(0x1c3)]()));}this['sendTo'](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':!![],'enums':_0x2f3dae,'rooms':_0x2d26c4},_0x17a788[_0x122e51(0xf2)]);}else{if(_0x17a788[_0x122e51(0x1b3)]===_0x122e51(0x1f1))try{const _0x288477=await this['getObjectViewAsync']('system',_0x122e51(0xe6),{'startkey':_0x122e51(0xf5),'endkey':_0x122e51(0xcf)}),_0x38847d=new Set();if(_0x288477&&_0x288477['rows'])for(const _0xd3c627 of _0x288477[_0x122e51(0x1f3)]){const _0x8bc06c=_0xd3c627['id']['replace'](_0x122e51(0x20e),''),_0x2027f8=await this[_0x122e51(0x1a6)](_0x8bc06c+_0x122e51(0x16e));let _0x5dc698=![];if(_0x2027f8&&_0x2027f8[_0x122e51(0x154)]){const _0x52a959=typeof _0x2027f8[_0x122e51(0x154)]===_0x122e51(0x121)?JSON['parse'](_0x2027f8[_0x122e51(0x154)]):_0x2027f8['val'];Array[_0x122e51(0x1c1)](_0x52a959)&&_0x52a959[_0x122e51(0x176)](_0x45c74f=>{const _0x2cf0b8=_0x122e51;_0x45c74f[_0x2cf0b8(0x1a9)]&&(_0x38847d[_0x2cf0b8(0x1b9)](_0x45c74f['calendarName']),_0x5dc698=!![]);});}!_0x5dc698&&_0x38847d[_0x122e51(0x1b9)](_0x8bc06c);}const _0x563af9=Array[_0x122e51(0xc9)](_0x38847d);if(_0x563af9[_0x122e51(0xee)]===0x0)_0x563af9[_0x122e51(0x147)]('Standard');this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':!![],'names':_0x563af9},_0x17a788['callback']);}catch(_0x407e39){this[_0x122e51(0x174)](_0x17a788['from'],_0x17a788['command'],{'success':![],'error':'Scan\x20Error:\x20'+_0x407e39[_0x122e51(0x214)]},_0x17a788[_0x122e51(0xf2)]);}else{if(_0x17a788[_0x122e51(0x1b3)]===_0x122e51(0x23d))try{await automation[_0x122e51(0x1db)](this),this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':!![]},_0x17a788[_0x122e51(0xf2)]);}catch(_0x417204){this[_0x122e51(0x1be)]['warn'](_0x122e51(0x21f)+_0x417204[_0x122e51(0x214)]),this['sendTo'](_0x17a788[_0x122e51(0xc9)],_0x17a788['command'],{'success':![],'error':_0x417204[_0x122e51(0x214)]},_0x17a788[_0x122e51(0xf2)]);}else{if(_0x17a788['command']===_0x122e51(0x1cd))try{const _0x2f9fba=_0x17a788['message'][_0x122e51(0x21b)];if(!_0x2f9fba||!Array[_0x122e51(0x1c1)](_0x2f9fba))throw new Error(_0x122e51(0x22b));const _0x56e0b6=await this[_0x122e51(0x1ce)](_0x122e51(0x13c));if(_0x56e0b6&&_0x56e0b6['val']){const _0x2aec48=JSON['parse'](_0x56e0b6[_0x122e51(0x154)]);_0x2aec48[_0x122e51(0x21b)]=_0x2f9fba,_0x2aec48['updated']=Date['now'](),await this['setStateAsync']('analysis.topology.structure',{'val':JSON['stringify'](_0x2aec48),'ack':!![]}),this[_0x122e51(0x1be)][_0x122e51(0xcb)](_0x122e51(0x208)),this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':!![]},_0x17a788[_0x122e51(0xf2)]);}else throw new Error(_0x122e51(0x114));}catch(_0x1e184c){this['log'][_0x122e51(0x1dc)](_0x122e51(0xe7)+_0x1e184c[_0x122e51(0x214)]),this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':![],'error':_0x1e184c['message']},_0x17a788[_0x122e51(0xf2)]);}else{if(_0x17a788['command']===_0x122e51(0xfc))try{const _0x237767=_0x17a788['message'][_0x122e51(0x1b3)],_0x1de440=_0x17a788[_0x122e51(0x214)];this['log'][_0x122e51(0xcb)](_0x122e51(0x19a)+_0x237767),pythonBridge['send'](this,_0x237767,_0x1de440,_0x37c177=>{const _0xf9eb60=_0x122e51;this[_0xf9eb60(0x174)](_0x17a788[_0xf9eb60(0xc9)],_0x17a788[_0xf9eb60(0x1b3)],_0x37c177,_0x17a788[_0xf9eb60(0xf2)]);});}catch(_0x323d5c){this['log'][_0x122e51(0x1dc)]('pythonBridge\x20command\x20failed:\x20'+_0x323d5c[_0x122e51(0x214)]),this['sendTo'](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'type':_0x122e51(0x143),'payload':_0x323d5c[_0x122e51(0x214)]},_0x17a788[_0x122e51(0xf2)]);}else{if(_0x17a788[_0x122e51(0x1b3)]===_0x122e51(0x10f))try{const _0x3a2b7c=_0x17a788[_0x122e51(0x214)]?_0x17a788[_0x122e51(0x214)]['apiKey']:'';if(!_0x3a2b7c)throw new Error('Kein\x20API\x20Key\x20√ºbergeben.');const _0x7b062a=new GoogleGenerativeAI(_0x3a2b7c),_0x4f3c32=_0x7b062a[_0x122e51(0x16a)]({'model':GEMINI_MODEL}),_0x1276ca=await _0x4f3c32[_0x122e51(0x1a3)]('Say\x20Hello'),_0x4e4689=await _0x1276ca[_0x122e51(0x1b1)],_0xeec691=_0x4e4689[_0x122e51(0x181)]();this['sendTo'](_0x17a788[_0x122e51(0xc9)],_0x17a788['command'],{'success':!![],'message':_0x122e51(0x146)+_0xeec691[_0x122e51(0x229)](0x0,0x14)+_0x122e51(0x182)},_0x17a788[_0x122e51(0xf2)]);}catch(_0x46e0c4){this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':![],'message':_0x46e0c4['message']},_0x17a788['callback']);}else{if(_0x17a788[_0x122e51(0x1b3)]===_0x122e51(0x22d))try{const _0xa175b2=await this[_0x122e51(0x234)](),_0x21547b=await this[_0x122e51(0x1ca)](_0x122e51(0x101),_0x122e51(0xe6),{'startkey':'system.adapter.ical.','endkey':_0x122e51(0xcf)}),_0x3e948c=_0x21547b&&_0x21547b[_0x122e51(0x1f3)]?_0x21547b[_0x122e51(0x1f3)][_0x122e51(0xee)]:0x0;this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788[_0x122e51(0x1b3)],{'success':!![],'weather':_0x122e51(0x1aa)+_0xa175b2+_0x122e51(0x12e)+(this[_0x122e51(0x19f)][this[_0x122e51(0x1c8)]['outdoorSensorId']]||'?')+'¬∞C','calendar':_0x3e948c+'\x20Kalender-Adapter\x20gefunden.'},_0x17a788[_0x122e51(0xf2)]);}catch(_0x2ceaae){this[_0x122e51(0x174)](_0x17a788[_0x122e51(0xc9)],_0x17a788['command'],{'success':![]},_0x17a788[_0x122e51(0xf2)]);}}}}}}}}}}}}}[a0_0xbecd4a(0x196)](){const _0x4b0da6=a0_0xbecd4a;if(!this[_0x4b0da6(0x102)][_0x4b0da6(0x1f6)])return;this[_0x4b0da6(0x1be)][_0x4b0da6(0xcb)](_0x4b0da6(0x1ab));try{const _0x4ba4da=this[_0x4b0da6(0x1ac)]||[];pythonBridge['send'](this,_0x4b0da6(0x200),{'events':_0x4ba4da});}catch(_0x5301f6){this[_0x4b0da6(0x1be)][_0x4b0da6(0x1dc)](_0x4b0da6(0xf6));}}async['onStateChange'](_0x2f8d30,_0xe3ce58){const _0x34e9ba=a0_0xbecd4a;if(!_0xe3ce58||this['dependencyInstallInProgress'])return;if(_0x2f8d30['includes'](_0x34e9ba(0x112))&&_0x2f8d30[_0x34e9ba(0xfb)](_0x34e9ba(0x123))&&_0xe3ce58[_0x34e9ba(0x154)])return;if(this['config']['infrasoundEnabled']&&_0x2f8d30===this[_0x34e9ba(0x1c8)][_0x34e9ba(0xd8)]&&this['activeModules'][_0x34e9ba(0x131)]){this['handleInfrasound'](_0xe3ce58[_0x34e9ba(0x154)]);return;}if(_0xe3ce58[_0x34e9ba(0x187)]&&_0x2f8d30[_0x34e9ba(0xfb)]('pulse'))return;if(_0x2f8d30===this[_0x34e9ba(0x177)]+_0x34e9ba(0xcc)){if(_0xe3ce58[_0x34e9ba(0x154)]&&Object[_0x34e9ba(0x126)](setup[_0x34e9ba(0x210)])[_0x34e9ba(0x127)](_0xe3ce58[_0x34e9ba(0x154)])){this[_0x34e9ba(0x1b5)]=_0xe3ce58[_0x34e9ba(0x154)];if(_0xe3ce58[_0x34e9ba(0x154)]===setup[_0x34e9ba(0x210)][_0x34e9ba(0x19b)])await recorder[_0x34e9ba(0x12f)](this,![]);else await recorder[_0x34e9ba(0x12f)](this,!![]);if(this['isProVersion']){let _0x2e8ba3=![],_0x5e5b55=0x0,_0x55171f=_0x34e9ba(0x113);if(this[_0x34e9ba(0x1b5)]===_0x34e9ba(0x107))_0x2e8ba3=!![],_0x5e5b55=0x168,_0x55171f=_0x34e9ba(0xe3);else this['currentSystemMode']==='guest'&&(_0x2e8ba3=!![],_0x5e5b55=0x5a0,_0x55171f=_0x34e9ba(0x10e));pythonBridge[_0x34e9ba(0x15f)](this,_0x34e9ba(0x161),{'active':_0x2e8ba3,'duration':_0x5e5b55,'label':_0x55171f}),await this[_0x34e9ba(0x111)](_0x34e9ba(0x199),{'val':JSON[_0x34e9ba(0x21d)]({'active':_0x2e8ba3,'label':_0x55171f,'timestamp':Date[_0x34e9ba(0xfa)]()}),'ack':!![]});}}if(!_0xe3ce58['ack'])this['setState'](_0x2f8d30,{'val':this[_0x34e9ba(0x1b5)],'ack':!![]});return;}if(_0x2f8d30[_0x34e9ba(0xfb)]('analysis.energy.warmupSources')&&_0xe3ce58[_0x34e9ba(0x187)])this[_0x34e9ba(0x13d)](_0xe3ce58[_0x34e9ba(0x154)]);if(_0x2f8d30[_0x34e9ba(0xfb)](_0x34e9ba(0x130))&&_0xe3ce58[_0x34e9ba(0x187)]&&this[_0x34e9ba(0x102)][_0x34e9ba(0x1ed)])automation['checkCalendarTriggers'](this);if(!_0xe3ce58['ack']){if(_0x2f8d30[_0x34e9ba(0x127)](_0x34e9ba(0x225))&&_0xe3ce58[_0x34e9ba(0x154)]){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]}),aiAgent[_0x34e9ba(0x190)](this);return;}if(_0x2f8d30[_0x34e9ba(0x127)]('triggerDailyDigest')&&_0xe3ce58['val']){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent[_0x34e9ba(0x104)](this,pythonBridge);return;}if(_0x2f8d30[_0x34e9ba(0x127)](_0x34e9ba(0x17b))&&_0xe3ce58[_0x34e9ba(0x154)]){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]}),aiAgent[_0x34e9ba(0xef)](this);return;}if(_0x2f8d30['includes'](_0x34e9ba(0xd2))&&_0xe3ce58['val']){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x2f8d30[_0x34e9ba(0x127)]('analysis.training.triggerSecurity')&&_0xe3ce58[_0x34e9ba(0x154)]){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x3d1fc5=await this[_0x34e9ba(0x1ce)](_0x34e9ba(0xc7));if(_0x3d1fc5&&_0x3d1fc5[_0x34e9ba(0x154)]){const _0x30f180=JSON[_0x34e9ba(0x224)](_0x3d1fc5[_0x34e9ba(0x154)]);this[_0x34e9ba(0x111)](_0x34e9ba(0x173),{'val':_0x34e9ba(0x139),'ack':!![]}),pythonBridge['send'](this,_0x34e9ba(0x184),{'sequences':_0x30f180});}}catch(_0x1815c7){}return;}if(_0x2f8d30['includes'](_0x34e9ba(0x226))&&_0xe3ce58[_0x34e9ba(0x154)]){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]});try{aiAgent[_0x34e9ba(0x18f)](this,_0x34e9ba(0x135)),setTimeout(()=>aiAgent['generateHealthReport'](this,'DAY'),0x2ee0);if(this['isProVersion']){this['runPythonHealthCheck']();const _0x3b2b58=await this[_0x34e9ba(0x1ce)](_0x34e9ba(0x1f9));if(_0x3b2b58&&_0x3b2b58[_0x34e9ba(0x154)])pythonBridge[_0x34e9ba(0x15f)](this,_0x34e9ba(0x22a),{'digests':JSON[_0x34e9ba(0x224)](_0x3b2b58[_0x34e9ba(0x154)])});}}catch(_0xe97dc3){this[_0x34e9ba(0x1be)][_0x34e9ba(0x1dc)](_0x34e9ba(0xf3)+_0xe97dc3[_0x34e9ba(0x214)]);}return;}if(_0x2f8d30['includes'](_0x34e9ba(0x21a))&&_0xe3ce58['val']){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]}),await this[_0x34e9ba(0xf9)]();return;}if(_0x2f8d30[_0x34e9ba(0x127)](_0x34e9ba(0x217))&&_0xe3ce58[_0x34e9ba(0x154)]){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]});if(this[_0x34e9ba(0x118)])try{const _0x13134f=await this[_0x34e9ba(0x1ce)](_0x34e9ba(0xe1));if(_0x13134f&&_0x13134f[_0x34e9ba(0x154)]){const _0x45e674={};if(this[_0x34e9ba(0x1c8)][_0x34e9ba(0x1fd)])this[_0x34e9ba(0x1c8)]['devices'][_0x34e9ba(0x176)](_0xfd6bd2=>{if(_0xfd6bd2['id']&&_0xfd6bd2['type'])_0x45e674[_0xfd6bd2['id']]=_0xfd6bd2['type'];});pythonBridge[_0x34e9ba(0x15f)](this,_0x34e9ba(0x1c2),{'events':JSON[_0x34e9ba(0x224)](_0x13134f[_0x34e9ba(0x154)]),'deviceMap':_0x45e674});}}catch(_0x155796){}return;}if(_0x2f8d30[_0x34e9ba(0x127)](_0x34e9ba(0x1a4))&&_0xe3ce58['val']){this[_0x34e9ba(0xdb)](_0x2f8d30,{'val':![],'ack':!![]}),topology[_0x34e9ba(0x122)](this);if(this['isProVersion'])try{const _0x16a467=await this[_0x34e9ba(0x1ce)](_0x34e9ba(0xc7));if(_0x16a467&&_0x16a467[_0x34e9ba(0x154)])pythonBridge['send'](this,_0x34e9ba(0x151),{'sequences':JSON[_0x34e9ba(0x224)](_0x16a467[_0x34e9ba(0x154)])});}catch(_0x34357c){}return;}}const _0x21d5b6=(this[_0x34e9ba(0x1c8)]['devices']||[])[_0x34e9ba(0x12d)](_0x2e7a39=>_0x2e7a39['id']===_0x2f8d30);if(_0x21d5b6){const _0x503b6a=await recorder[_0x34e9ba(0xd0)](this,_0x2f8d30,_0xe3ce58,_0x21d5b6);_0x503b6a&&this['setState'](_0x34e9ba(0x19c),{'val':Date['now'](),'ack':!![]});_0x503b6a&&_0x503b6a[_0x34e9ba(0x1b2)]==='motion'&&_0x503b6a['location']&&this['isProVersion']&&deadMan[_0x34e9ba(0x1d3)](this,_0x503b6a['location']);_0xe3ce58['val']&&(_0xe3ce58[_0x34e9ba(0x154)]===!![]||_0xe3ce58[_0x34e9ba(0x154)]===0x1||String(_0xe3ce58['val'])[_0x34e9ba(0x134)]()===_0x34e9ba(0x1e0))&&(_0x21d5b6[_0x34e9ba(0x1b2)]&&(_0x21d5b6[_0x34e9ba(0x1b2)][_0x34e9ba(0x127)](_0x34e9ba(0xda))||_0x21d5b6[_0x34e9ba(0x1b2)]['includes'](_0x34e9ba(0xc8)))&&this[_0x34e9ba(0x23a)](_0x21d5b6));if(_0x21d5b6['type']===_0x34e9ba(0x1c0)||_0x21d5b6[_0x34e9ba(0x1b2)]===_0x34e9ba(0x132)){if(this[_0x34e9ba(0x102)][_0x34e9ba(0x1ed)])automation[_0x34e9ba(0x165)](this);}}}async[a0_0xbecd4a(0x13d)](_0x532a9d){const _0x185f91=a0_0xbecd4a;if(!this['memoryCache']||Date[_0x185f91(0xfa)]()-this[_0x185f91(0x13a)]>0x493e0)return;try{const _0x30dad0=JSON[_0x185f91(0x224)](_0x532a9d),_0x447a48=this[_0x185f91(0xe0)][_0x185f91(0x11e)];let _0x169325=![];for(const _0x382081 in _0x447a48){if(_0x447a48[_0x382081][_0x185f91(0x127)]('AI')&&_0x30dad0[_0x382081]&&!_0x30dad0[_0x382081][_0x185f91(0x127)]('AI')){_0x169325=!![];break;}}_0x169325&&(await this[_0x185f91(0x111)](_0x185f91(0x130),{'val':JSON[_0x185f91(0x21d)](this[_0x185f91(0xe0)][_0x185f91(0x1bb)]),'ack':!![]}),await this[_0x185f91(0x111)](_0x185f91(0x1ea),{'val':JSON[_0x185f91(0x21d)](this[_0x185f91(0xe0)][_0x185f91(0x11e)]),'ack':!![]}));}catch(_0x504a40){}}async['loadSystemMode'](){const _0x5e4edf=a0_0xbecd4a;try{const _0x402840=await this[_0x5e4edf(0x1ce)](setup['SYSTEM_DP_MODE']);if(_0x402840&&_0x402840[_0x5e4edf(0x154)])this[_0x5e4edf(0x1b5)]=_0x402840[_0x5e4edf(0x154)];}catch(_0x18f2f9){this['currentSystemMode']=setup[_0x5e4edf(0x210)][_0x5e4edf(0x19d)];}}async[a0_0xbecd4a(0xde)](){const _0x41f1f7=a0_0xbecd4a,_0x1d8a21=this['config'][_0x41f1f7(0xd1)]||[];if(_0x1d8a21[_0x41f1f7(0xee)]===0x0)return![];const _0x45aed2=[],_0x2f6e25=Date['now'](),_0x11dfbd=0x5*0x3c*0x3e8;for(const _0x5b4114 of _0x1d8a21){try{let _0x48cfc6=![];try{const _0x2a5b80=await this[_0x41f1f7(0x1a6)](_0x5b4114+'.isOnline');if(_0x2a5b80&&_0x2a5b80['val']===!![])_0x48cfc6=!![];}catch(_0x223d79){}if(!_0x48cfc6)try{const _0x326c96=await this[_0x41f1f7(0x1a6)](_0x5b4114+_0x41f1f7(0x1fb));if(_0x326c96&&_0x326c96['ts']){const _0x41279d=_0x2f6e25-_0x326c96['ts'];if(_0x41279d<_0x11dfbd)_0x48cfc6=!![];}}catch(_0x331bfe){}if(!_0x48cfc6)try{const _0x2772dd=await this[_0x41f1f7(0x1a6)](_0x5b4114+_0x41f1f7(0x19e));if(_0x2772dd&&typeof _0x2772dd['val']==='number'&&_0x2772dd['val']>0x0)_0x48cfc6=!![];}catch(_0x280041){}if(!_0x48cfc6)try{const _0x5273f0=await this[_0x41f1f7(0x1a6)](_0x5b4114);if(_0x5273f0){const _0xc8ccad=_0x2f6e25-(_0x5273f0['ts']||0x0);_0xc8ccad<_0x11dfbd&&(_0x5273f0[_0x41f1f7(0x154)]===!![]||_0x5273f0[_0x41f1f7(0x154)]===_0x41f1f7(0x153)||_0x5273f0[_0x41f1f7(0x154)]===0x1)&&(_0x48cfc6=!![]);}}catch(_0x3a3694){}if(_0x48cfc6){const _0x17324c=_0x5b4114[_0x41f1f7(0x17d)]('.'),_0x2a814a=_0x17324c[_0x17324c[_0x41f1f7(0xee)]-0x1]||_0x5b4114;_0x45aed2[_0x41f1f7(0x147)](_0x2a814a);}}catch(_0x5b5223){this[_0x41f1f7(0x1be)][_0x41f1f7(0x1dc)]('checkWifiPresence:\x20Error\x20checking\x20'+_0x5b4114+':\x20'+_0x5b5223[_0x41f1f7(0x214)]);}}const _0xee0438=_0x45aed2[_0x41f1f7(0xee)]>0x0?_0x45aed2[_0x41f1f7(0xdf)](',\x20'):_0x41f1f7(0x16f);return await this[_0x41f1f7(0x111)]('system.presenceWho',{'val':_0xee0438,'ack':!![]}),_0x45aed2[_0x41f1f7(0xee)]>0x0;}async['runAutopilot'](){const _0x4bcd95=a0_0xbecd4a;await aiAgent[_0x4bcd95(0x190)](this);this['activeModules']['health']&&(this['updateHealthVector'](),this[_0x4bcd95(0xd5)]());if(this[_0x4bcd95(0x102)]['energy'])this['triggerEnergyPrediction']();}async[a0_0xbecd4a(0x234)](){const _0x1eb2fa=a0_0xbecd4a,_0xf620f4=[_0x1eb2fa(0x22e),_0x1eb2fa(0x23c),'daswetter.0'],_0x16848e=['forecast.current.weather',_0x1eb2fa(0x15e),_0x1eb2fa(0x14a)];for(const _0x2803e4 of _0xf620f4){for(const _0x3c1208 of _0x16848e){try{const _0x50ed12=_0x2803e4+'.'+_0x3c1208,_0x1d569d=await this[_0x1eb2fa(0x1a6)](_0x50ed12);if(_0x1d569d&&_0x1d569d['val']){const _0x3e8045=String(_0x1d569d[_0x1eb2fa(0x154)])['toLowerCase']();if(_0x3e8045[_0x1eb2fa(0x127)]('sunny')||_0x3e8045[_0x1eb2fa(0x127)]('heiter')||_0x3e8045['includes'](_0x1eb2fa(0x1c7))||_0x3e8045[_0x1eb2fa(0x127)](_0x1eb2fa(0x23b))||_0x3e8045[_0x1eb2fa(0x127)](_0x1eb2fa(0xe4)))return this[_0x1eb2fa(0x1be)][_0x1eb2fa(0xcb)](_0x1eb2fa(0x162)+_0x50ed12),!![];}}catch(_0x3dae02){}}}return![];}[a0_0xbecd4a(0xd5)](){const _0x1e0c67=a0_0xbecd4a;if(!this[_0x1e0c67(0x118)])return;try{this[_0x1e0c67(0x1ce)](_0x1e0c67(0xc7),(_0x124b68,_0x59d719)=>{const _0x23d241=_0x1e0c67;if(_0x124b68||!_0x59d719||!_0x59d719[_0x23d241(0x154)])return;try{const _0x9dde27=JSON[_0x23d241(0x224)](_0x59d719[_0x23d241(0x154)]);if(!_0x9dde27||_0x9dde27[_0x23d241(0xee)]===0x0)return;pythonBridge[_0x23d241(0x15f)](this,'ANALYZE_GAIT',{'sequences':_0x9dde27}),this[_0x23d241(0x1be)][_0x23d241(0xcb)]('üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20'+_0x9dde27[_0x23d241(0xee)]+_0x23d241(0x1fc));}catch(_0x19db0a){this[_0x23d241(0x1be)][_0x23d241(0x1dc)](_0x23d241(0x1c6)+_0x19db0a[_0x23d241(0x214)]);}});}catch(_0x4c4ac3){this[_0x1e0c67(0x1be)][_0x1e0c67(0x1dc)]('triggerGaitAnalysis\x20error:\x20'+_0x4c4ac3[_0x1e0c67(0x214)]);}}async[a0_0xbecd4a(0xf9)](){const _0x3e6361=a0_0xbecd4a;if(!this[_0x3e6361(0x118)]||!this[_0x3e6361(0x102)][_0x3e6361(0x1ed)])return;try{const _0x1b16f={},_0x159708={},_0x4a368a=this[_0x3e6361(0x1c8)][_0x3e6361(0x1fd)]||[];for(const _0x1016d7 of _0x4a368a){if((_0x1016d7[_0x3e6361(0x1b2)]==='temperature'||_0x1016d7[_0x3e6361(0x1b2)]==='thermostat')&&_0x1016d7[_0x3e6361(0x145)])try{const _0x2a0e6d=await this[_0x3e6361(0x1a6)](_0x1016d7['id']);_0x2a0e6d&&typeof _0x2a0e6d[_0x3e6361(0x154)]===_0x3e6361(0x232)&&(_0x1b16f[_0x1016d7[_0x3e6361(0x145)]]=_0x2a0e6d['val'],_0x159708[_0x1016d7[_0x3e6361(0x145)]]=_0x1016d7[_0x3e6361(0x17f)]||![]);}catch(_0x4a7fba){}}let _0xf2a4a=0xa;if(this[_0x3e6361(0x1c8)][_0x3e6361(0x1a5)])try{const _0x2415a2=await this[_0x3e6361(0x1a6)](this['config']['weatherTempId']);if(_0x2415a2&&typeof _0x2415a2[_0x3e6361(0x154)]===_0x3e6361(0x232))_0xf2a4a=_0x2415a2[_0x3e6361(0x154)];}catch(_0x360f6d){}const _0x1a89e3=await this[_0x3e6361(0x234)]();let _0x590710={};try{const _0xd4210=await this['getStateAsync']('analysis.energy.warmupTargets');if(_0xd4210&&_0xd4210[_0x3e6361(0x154)])_0x590710=JSON[_0x3e6361(0x224)](_0xd4210[_0x3e6361(0x154)]);}catch(_0x5746a7){}pythonBridge[_0x3e6361(0x15f)](this,_0x3e6361(0x1dd),{'current_temps':_0x1b16f,'t_out':_0xf2a4a,'is_sunny':_0x1a89e3,'solar_flags':_0x159708,'warmup_targets':_0x590710}),this[_0x3e6361(0x1be)][_0x3e6361(0x1ee)]('üîÆ\x20Energy\x20Prediction\x20triggered\x20('+Object[_0x3e6361(0x17e)](_0x1b16f)[_0x3e6361(0xee)]+_0x3e6361(0x103));}catch(_0x5c0bc7){this[_0x3e6361(0x1be)]['warn']('triggerEnergyPrediction\x20Error:\x20'+_0x5c0bc7[_0x3e6361(0x214)]);}}[a0_0xbecd4a(0x189)](){const _0x267ca5=a0_0xbecd4a;if(!this['rawEventLog']||this[_0x267ca5(0x1ac)]['length']===0x0)return;const _0x349acf=new Array(0x30)[_0x267ca5(0x179)](0x0),_0x27daa7=Array[_0x267ca5(0xc9)]({'length':0x30},()=>[]),_0x4c5cd1=new Date()['setHours'](0x0,0x0,0x0,0x0);this['rawEventLog']['forEach'](_0x405456=>{const _0x1ef961=_0x267ca5,_0x1abf84=new Date(_0x405456[_0x1ef961(0x228)]);if(_0x1abf84[_0x1ef961(0xf0)]()>=_0x4c5cd1){const _0x456666=_0x1abf84[_0x1ef961(0x1d4)](),_0xdb0fa0=_0x1abf84['getMinutes'](),_0x356d6e=_0x456666*0x2+Math[_0x1ef961(0xca)](_0xdb0fa0/0x1e);_0x356d6e>=0x0&&_0x356d6e<0x30&&(_0x349acf[_0x356d6e]++,_0x27daa7[_0x356d6e][_0x1ef961(0x147)]({'time':_0x1abf84[_0x1ef961(0x1b4)](_0x1ef961(0x1e6),{'hour':'2-digit','minute':'2-digit'}),'location':_0x405456[_0x1ef961(0x145)]||_0x1ef961(0x119),'type':_0x405456['type']||'Event'}));}}),this[_0x267ca5(0x111)]('analysis.health.todayVector',{'val':JSON[_0x267ca5(0x21d)](_0x349acf),'ack':!![]}),this[_0x267ca5(0x111)]('analysis.health.todayRoomDetails',{'val':JSON[_0x267ca5(0x21d)](_0x27daa7),'ack':!![]});}async[a0_0xbecd4a(0x168)](_0x3753a3){const _0x232030=a0_0xbecd4a;if(!this[_0x232030(0x1c8)][_0x232030(0x1ef)]||typeof _0x3753a3!==_0x232030(0x232))return;const _0x498d16=this['config'][_0x232030(0x1a8)]||0.04;this[_0x232030(0x10c)]['push']({'timestamp':Date[_0x232030(0xfa)](),'value':_0x3753a3}),this[_0x232030(0x10c)][_0x232030(0xee)]>0x64&&this[_0x232030(0x10c)][_0x232030(0x17c)](),_0x3753a3>_0x498d16&&!this[_0x232030(0xfd)]&&(this[_0x232030(0xfd)]=!![],this[_0x232030(0x1be)][_0x232030(0x1dc)]('üîä\x20Infraschall-Alarm:\x20'+_0x3753a3['toFixed'](0x4)+_0x232030(0x115)+_0x498d16+'\x20(Threshold)'),await this[_0x232030(0x133)](_0x3753a3,'threshold_exceeded'),setTimeout(()=>{const _0x1a897e=_0x232030;this[_0x1a897e(0xfd)]=![];},0x5*0x3c*0x3e8));}async[a0_0xbecd4a(0x133)](_0x3b51df,_0x1784e5){const _0x9bbb3=a0_0xbecd4a;if(!this[_0x9bbb3(0x11d)]){const _0x30efe4=this[_0x9bbb3(0x11c)][_0x9bbb3(0x1e8)](0x0,0xa),_0xfaa8ea=_0x30efe4[_0x9bbb3(0x212)](_0x285dfe=>new Date(_0x285dfe['timestamp'])[_0x9bbb3(0x1b4)](_0x9bbb3(0x1e6))+_0x9bbb3(0x1d1)+(_0x285dfe[_0x9bbb3(0x145)]||_0x9bbb3(0x100))+':\x20'+_0x285dfe[_0x9bbb3(0x198)])[_0x9bbb3(0xdf)]('\x0a');this[_0x9bbb3(0x1be)]['warn'](_0x9bbb3(0xd4)+_0x3b51df[_0x9bbb3(0xdd)](0x4)+_0x9bbb3(0x10d)+_0xfaa8ea);if(this['config'][_0x9bbb3(0x1d7)])try{const _0x2a6342=await this[_0x9bbb3(0x1a6)](this['config'][_0x9bbb3(0x1d7)]);_0x2a6342&&_0x2a6342['val']===!![]&&(await this[_0x9bbb3(0x111)](_0x9bbb3(0x141),{'val':JSON[_0x9bbb3(0x21d)]({'timestamp':Date['now'](),'pressure':_0x3b51df[_0x9bbb3(0xdd)](0x4),'eventType':_0x1784e5,'recentEvents':_0x30efe4[_0x9bbb3(0x1e8)](0x0,0x3)}),'ack':!![]}),this[_0x9bbb3(0x1be)][_0x9bbb3(0x129)]('üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!'));}catch(_0x3c3d92){}}else this[_0x9bbb3(0x1be)]['debug']('üîä\x20Infraschall:\x20'+_0x3b51df[_0x9bbb3(0xdd)](0x4)+'\x20(Bewohner\x20anwesend\x20-\x20normal)');}async[a0_0xbecd4a(0x23a)](_0x514174){const _0x10d147=a0_0xbecd4a;if(!_0x514174||!_0x514174[_0x10d147(0x145)])return;try{const _0x311a4a=(this['config'][_0x10d147(0x1fd)]||[])[_0x10d147(0x18c)](_0x27e575=>_0x27e575[_0x10d147(0x145)]===_0x514174['location']&&(_0x27e575['type']===_0x10d147(0x1c0)||_0x27e575['type']===_0x10d147(0x132)));if(_0x311a4a[_0x10d147(0xee)]===0x0)return;const _0x4df37f=await this[_0x10d147(0x1a6)](_0x311a4a[0x0]['id']);if(!_0x4df37f||typeof _0x4df37f[_0x10d147(0x154)]!==_0x10d147(0x232))return;const _0xb1adb2=_0x4df37f[_0x10d147(0x154)];let _0x22a3e2=null;if(this[_0x10d147(0x1c8)][_0x10d147(0x1a5)]){const _0x48d93a=await this[_0x10d147(0x1a6)](this[_0x10d147(0x1c8)][_0x10d147(0x1a5)]);_0x48d93a&&typeof _0x48d93a['val']===_0x10d147(0x232)&&(_0x22a3e2=_0x48d93a['val']);}if(_0x22a3e2!==null){const _0x590226=Math[_0x10d147(0x138)](_0xb1adb2-_0x22a3e2);_0x590226>0x3&&(this[_0x10d147(0x1be)][_0x10d147(0xcb)](_0x10d147(0x1f0)+_0x514174[_0x10d147(0x145)]+_0x10d147(0x203)+_0x590226[_0x10d147(0xdd)](0x1)+_0x10d147(0x171)+_0xb1adb2+_0x10d147(0x1fe)+_0x22a3e2+_0x10d147(0x13f)),await this[_0x10d147(0x111)](_0x10d147(0x1bc),{'val':JSON[_0x10d147(0x21d)]({'room':_0x514174['location'],'timestamp':Date[_0x10d147(0xfa)](),'tempDiff':_0x590226[_0x10d147(0xdd)](0x1),'recommendation':_0x590226>0x5?'Gute\x20L√ºftungsm√∂glichkeit!':_0x10d147(0x1a7)}),'ack':!![]}));}}catch(_0x102683){this[_0x10d147(0x1be)][_0x10d147(0x1dc)](_0x10d147(0x12a)+_0x102683[_0x10d147(0x214)]);}}async[a0_0xbecd4a(0xeb)](_0x2dc8ea){const _0x5b94d4=a0_0xbecd4a;if(!_0x2dc8ea||typeof _0x2dc8ea!==_0x5b94d4(0x236))return;const _0x2404a2={'timestamp':_0x2dc8ea['timestamp']||Date[_0x5b94d4(0xfa)](),'id':_0x2dc8ea['id']||Date[_0x5b94d4(0xfa)]()[_0x5b94d4(0x156)](),'name':_0x2dc8ea['name']||_0x5b94d4(0x14b),'type':_0x2dc8ea['type']||'custom','location':_0x2dc8ea['location']||'Unknown','value':_0x2dc8ea[_0x5b94d4(0x20d)]||null};this[_0x5b94d4(0x11c)][_0x5b94d4(0x219)](_0x2404a2);if(this[_0x5b94d4(0x11c)][_0x5b94d4(0xee)]>0x1388)this[_0x5b94d4(0x11c)]['pop']();await this[_0x5b94d4(0x111)](_0x5b94d4(0x186),{'val':JSON[_0x5b94d4(0x21d)](this[_0x5b94d4(0x11c)]),'ack':!![]}),this[_0x5b94d4(0x1be)][_0x5b94d4(0xcb)](_0x5b94d4(0x22c)+_0x2404a2['name']+'\x20('+_0x2404a2[_0x5b94d4(0x145)]+')');}[a0_0xbecd4a(0x18b)](_0x2a7bbf){}}if(require[a0_0xbecd4a(0x1e1)]!==module)module[a0_0xbecd4a(0x109)]=_0x199bad=>new CogniLiving(_0x199bad);else new CogniLiving();