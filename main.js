const a0_0x4297cf=a0_0x2b0a;(function(_0x1a8476,_0x30c1f2){const _0xb2d91d=a0_0x2b0a,_0x4df9c8=_0x1a8476();while(!![]){try{const _0x3f31b4=-parseInt(_0xb2d91d(0x250))/0x1+parseInt(_0xb2d91d(0x2a2))/0x2+-parseInt(_0xb2d91d(0x22d))/0x3*(parseInt(_0xb2d91d(0x260))/0x4)+-parseInt(_0xb2d91d(0x2a7))/0x5+parseInt(_0xb2d91d(0x300))/0x6+parseInt(_0xb2d91d(0x225))/0x7+-parseInt(_0xb2d91d(0x326))/0x8;if(_0x3f31b4===_0x30c1f2)break;else _0x4df9c8['push'](_0x4df9c8['shift']());}catch(_0x4a363c){_0x4df9c8['push'](_0x4df9c8['shift']());}}}(a0_0xf531,0x9a9f5));const a0_0x13c284=(function(){let _0x1c47d4=!![];return function(_0x5d2c33,_0xd63990){const _0x19b095=_0x1c47d4?function(){const _0x431102=a0_0x2b0a;if(_0xd63990){const _0x542731=_0xd63990[_0x431102(0x227)](_0x5d2c33,arguments);return _0xd63990=null,_0x542731;}}:function(){};return _0x1c47d4=![],_0x19b095;};}()),a0_0x47e2ed=a0_0x13c284(this,function(){const _0x47a5a3=a0_0x2b0a;return a0_0x47e2ed['toString']()[_0x47a5a3(0x199)]('(((.+)+)+)+$')['toString']()[_0x47a5a3(0x1f3)](a0_0x47e2ed)['search'](_0x47a5a3(0x2ad));});function a0_0x2b0a(_0x5455d9,_0x4617d8){const _0x1a596d=a0_0xf531();return a0_0x2b0a=function(_0x47e2ed,_0x13c284){_0x47e2ed=_0x47e2ed-0x195;let _0xf531c3=_0x1a596d[_0x47e2ed];return _0xf531c3;},a0_0x2b0a(_0x5455d9,_0x4617d8);}a0_0x47e2ed();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x4297cf(0x299)),schedule=require('node-schedule'),HISTORY_MAX_SIZE=0x32,ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',LTM_DP_RAW_LOG=a0_0x4297cf(0x31b),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x4297cf(0x1f4),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x4297cf(0x219),LTM_DP_DRIFT_STATUS=a0_0x4297cf(0x30e),LTM_DP_DRIFT_DETAILS=a0_0x4297cf(0x1ec),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x4297cf(0x248),SYSTEM_MODES={'NORMAL':a0_0x4297cf(0x1de),'VACATION':a0_0x4297cf(0x212),'PARTY':a0_0x4297cf(0x1f6),'GUEST':a0_0x4297cf(0x1b2)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x4297cf(0x239)],SYSTEM_MODES[a0_0x4297cf(0x20c)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x4297cf(0x21f),'senior_aal':a0_0x4297cf(0x298),'family':'Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','single_comfort':a0_0x4297cf(0x2d3),'security':a0_0x4297cf(0x2e6)};function a0_0xf531(){const _0x1776c2=['initHistory','[TEST]\x20','TEST-PRO-KEY','getForeignObjectsAsync','Comfort\x20Summary','sendMorningBriefing','send','main','analysis.automation.description','Activity\x20Summary','setObjectNotExistsAsync','Presence\x20Status','Last\x20Result','weatherInstance','daswetter.0','none','LTM','native','push','scanDevices','Baseline:\x20Inactive\x20(Pro\x20Feature).','sound','application/json','systemConfig','toString','briefingJob','expire','stringify','filter','loadDailyDigests','Aktiv\x20(','cogni-living\x20adapter\x20starting\x20(v','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','from','common','Health\x20&\x20Sleep\x20Analysis','exitGraceTimer','modeResetJob','driftAnalysisTimer','analysis.history_debug_00','\x0aFEEDBACK:\x0a','License\x20Check\x20failed:\x20','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','WETTER:\x20','licenseKey','analysis.health.sleepScore','events.lastEvent','openweathermap','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','analysis.trigger','analysis.isEmergency','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','N/A','[Test]\x20Notification','Sleep\x20Score\x20(0-100)','analysis.history_debug_03','exitTimer','Fehler:\x20','sensorLastValues','cogni-living','deviationFromBaseline','config','createDailyDigest','getCalendarNames','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','Drift\x20Status','loadRawEventLog\x20failed:\x20','namespace','No\x20Key','number','replace','analysis.triggerBriefing','analysis.comfortSummary','notifyWhatsappInstance','siren','accuweather.0','Processing\x20Status','5793336WKSQUc','useCalendar','inactivityMonitoringEnabled','minDaysForBaseline','checkLtmDriftObjects','onStateChange','Raw\x20Log','Daily\x20Digest\x20Error:\x20','Feedback\x20Log','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','info','enum.functions.*','calendarInstance','abortExitTimer','LTM.driftAnalysis.baselineDrift','Starting\x20Autopilot\x20(','ack','Briefing\x20Sched\x20Error:\x20','testNotification','notes','rawEventLog','toLocaleString','Health\x20Notes','uuid','checkWifiPresence','unload','testApiKey','LTM.rawEventLog','setupDriftAnalysisScheduler','cancel','loadSystemMode\x20failed:\x20','status','useWeather','Last\x20Check','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','analysisTimer','System\x20Mode','includes','43552fLNnyh','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','.forecast.current.state','ready','setupLtmScheduler','analysis.alertReason','notifyTelegramRecipient','Analysiere\x20Tag...','search','parse','08:00','version','Logbook','updateAnalysisHistory','type','setHours','callback','saveRawEventLog','briefingTime','Subscribing\x20to\x20','unshift','notifyPushoverInstance','subscribeStates','updateBaselineStatus','slice','\x20sensors...','VACATION','startExitTimer','lastCheck','onReady','Trigger\x20Briefing\x20(Test)','indicator.alarm.fire','Alert\x20Reason','guest','stateChange','lastAlertState','notifyTelegramInstance','weatherunderground.0','KALENDER:\x20Keine\x20relevanten\x20Termine','loadSystemMode','isAlert','runBaselineDriftAnalysis','summary','scheduleJob','sendToAsync','subscribeForeignStatesAsync','date','User\x20Feedback:\x20Alarm\x20\x22','message','isPresent','getStateAsync','loadDailyDigests\x20failed:\x20','currentSystemMode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','genAI','apiKey','suggestedAction','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','sendTo','Trigger\x20Digest','Error\x20creating\x20objects:\x20','uuid-not-found','instance','Lernphase\x20(','state','analysis.isAlert','patternDetected','notifyTelegramEnabled','response','sleepScore','analysis.activitySummary','indicator.alarm','inactivityThresholdHours','Pattern\x20Detected','üö®\x20EMERGENCY','runAutopilot','string','normal','Error\x20initHistory:\x20','setupModeResetScheduler','json','health','onMessage','indicator','sort','KALENDER:\x20','\x20|\x20','notifySignalRecipient','isEmergency','Normal','briefingEnabled','LTM.driftAnalysis.driftDetails','Error\x20reading\x20calendar\x20table:\x20','Generating\x20Morning\x20Briefing...','bind','Kalender:\x20Deaktiviert','geminiApiKey','No\x20recorded\x20events\x20yet.','constructor','LTM.processingStatus','analysis.health.notes','party','notifyEmailInstance','automationProposal','pop','Gemini\x20Init\x20Error:\x20','üö®üö®\x20NOTFALL','presenceDevices','activity','toISOString','time','Action','find','analysisInterval','\x20sent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','comfort','val','AI\x20Emergency\x20Status','analysis.health.restlessness','trim','getCalendarContext','Drift\x20Analysis','GUEST','events.history_debug_04','notifyWhatsappRecipient','Deaktiviert\x20(Pro-Feature)','setPresence','analysis.history_debug_04','vacation','Wetter:\x20Deaktiviert','analysis.lastResult','getGenerativeModel','Deviation','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','setStateAsync','LTM.driftAnalysis','latitude','analysis.automation.suggestedAction','events.history','Comfort\x20Suggestion','loadRawEventLog','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','enum','checkLicense','analysis.analysisHistory','.data.table','generic','8376417ozdTdc','details','apply','system.config','analysis.comfortSuggestion','command','livingContext','triggerDailyDigest','4059LnacSX','notifyEmailRecipient','.Summary.Current','events.history_debug_02','Gast','dailyDigests','values','extendObjectAsync','\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}','onUnload','name','text','PARTY','map','now','aiPersona','getWeatherContext','sendNotification','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','KALENDER:\x20Keine\x20Daten','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','activityLevel','Event\x20History','restlessness','warn','Daily\x20Digests','analysis.history_debug_02','system.mode','retry','feedbackHistory','Adapter','Briefing\x20Error:\x20','getCalendarNames\x20Error:\x20','createAllObjects','Missing\x20data','697927cXmHso','events.history_debug_03','LTM\x20Sched\x20Error:\x20','runGeminiAnalysis','description','analysis.automation.patternDetected','accuweather','\x20*\x20*\x20*','System\x20Status\x20&\x20Control','testContext','Error\x20checking\x20WiFi:\x20','getLtmData','isGracePeriodActive','isProVersion','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','catch','2816zNHAHg','\x20Tage)','Daily\x20Digest\x20created\x20successfully.','Autopilot\x20error:\x20','\x20(EMERGENCY)','.NextHours.Location_1.Day_1.current.symbol_desc','ical.0','analysis.history_debug_01','error','geminiModel','alertReason','analysisHistory','PRO-','\x20raw\x20events...','\x20min).\x20Watchdog\x20Limit:\x20','_calName','Description','analysis.deviationFromBaseline','setupBriefingScheduler','WETTER:\x20Keine\x20Daten','getForeignStateAsync','Gemini\x20AI\x20initialized.','Drift\x20Sched\x20Error:\x20','2-digit','unknown','tryParse','longitude','boolean','Sending\x20notification:\x20\x22','checkLtmObjects','location','events.history_debug_00','length','notifyWhatsappEnabled','Baseline\x20Status','isArray','notifyPushoverRecipient','generateContent','log','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ltmJob','object','button','eventHistory','Urlaub','system','openweathermap.0','checkSystemObjects','devices','timestamp','isExit','getForeignObjectAsync','system.isPresent','de-DE','join','channel','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','@google/generative-ai','ltmDriftCheckIntervalHours','saveDailyDigests','createAllObjects\x20failed:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','events.history_debug_01','Reset\x20Sched\x20Error:\x20','calendarSelection','getSystemUUID','2052136CexWCH','toFixed','Morning\x20Briefing\x20sent.','split','NORMAL','4495195bGNleU','setState','city','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','logDuplicates','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','(((.+)+)+)+$','getEnums','\x20presence\x20devices...','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','Success','Creating\x20Daily\x20Digest\x20from\x20'];a0_0xf531=function(){return _0x1776c2;};return a0_0xf531();}class CogniLiving extends utils[a0_0x4297cf(0x24b)]{constructor(_0xf89239){const _0x9b455e=a0_0x4297cf;super({..._0xf89239,'name':_0x9b455e(0x2ee)}),this[_0x9b455e(0x28b)]=[],this[_0x9b455e(0x26b)]=[],this[_0x9b455e(0x24a)]=[],this[_0x9b455e(0x314)]=[],this[_0x9b455e(0x232)]=[],this[_0x9b455e(0x2ed)]={},this[_0x9b455e(0x2ca)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x9b455e(0x1c2)]=!![],this['exitTimer']=null,this[_0x9b455e(0x2d7)]=null,this['isGracePeriodActive']=![],this['genAI']=null,this[_0x9b455e(0x269)]=null,this[_0x9b455e(0x1c5)]=SYSTEM_MODES[_0x9b455e(0x2a6)],this['isProVersion']=![],this['lastAlertState']=![],this['systemUUID']=_0x9b455e(0x278),this[_0x9b455e(0x323)]=null,this[_0x9b455e(0x288)]=null,this[_0x9b455e(0x2d8)]=null,this[_0x9b455e(0x2d9)]=null,this[_0x9b455e(0x2cc)]=null,this['on'](_0x9b455e(0x329),this[_0x9b455e(0x1ae)][_0x9b455e(0x1ef)](this)),this['on'](_0x9b455e(0x1b3),this['onStateChange']['bind'](this)),this['on'](_0x9b455e(0x319),this[_0x9b455e(0x236)][_0x9b455e(0x1ef)](this)),this['on'](_0x9b455e(0x1c1),this[_0x9b455e(0x1e3)]['bind'](this));}async[a0_0x4297cf(0x2b3)](){const _0x392101=a0_0x4297cf;try{const _0x2842aa=await this[_0x392101(0x1c3)](_0x392101(0x21c));_0x2842aa&&_0x2842aa['val']&&(this['eventHistory']=JSON[_0x392101(0x19a)](_0x2842aa[_0x392101(0x206)][_0x392101(0x2cb)]()));}catch(_0x492ac5){this[_0x392101(0x28b)]=[];}try{const _0x3ac377=await this['getStateAsync'](_0x392101(0x222));if(_0x3ac377&&_0x3ac377[_0x392101(0x206)])this[_0x392101(0x26b)]=JSON[_0x392101(0x19a)](_0x3ac377[_0x392101(0x206)][_0x392101(0x2cb)]());}catch(_0x13b43f){this[_0x392101(0x26b)]=[];}}async[a0_0x4297cf(0x28f)](){const _0x36ff9e=a0_0x4297cf;await this['extendObjectAsync'](_0x36ff9e(0x28d),{'type':_0x36ff9e(0x297),'common':{'name':_0x36ff9e(0x258)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x36ff9e(0x1d1),'common':{'name':_0x36ff9e(0x324),'type':_0x36ff9e(0x1dd),'role':_0x36ff9e(0x1d1),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x36ff9e(0x2a6)]]:_0x36ff9e(0x1ea),[SYSTEM_MODES[_0x36ff9e(0x1ab)]]:_0x36ff9e(0x28c),[SYSTEM_MODES[_0x36ff9e(0x239)]]:'Party',[SYSTEM_MODES[_0x36ff9e(0x20c)]]:_0x36ff9e(0x231)}},'native':{}});}async['checkLtmObjects'](){const _0x3d44e0=a0_0x4297cf;await this['extendObjectAsync'](_0x3d44e0(0x2c3),{'type':_0x3d44e0(0x297),'common':{'name':_0x3d44e0(0x2c3)},'native':{}}),await this[_0x3d44e0(0x234)](LTM_DP_RAW_LOG,{'type':_0x3d44e0(0x1d1),'common':{'name':_0x3d44e0(0x306),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x3d44e0(0x1d1),'common':{'name':_0x3d44e0(0x246),'type':_0x3d44e0(0x1dd),'role':_0x3d44e0(0x1e1),'read':!![],'write':![]},'native':{}}),await this[_0x3d44e0(0x234)](LTM_DP_STATUS,{'type':_0x3d44e0(0x1d1),'common':{'name':_0x3d44e0(0x2ff),'type':_0x3d44e0(0x1dd),'role':_0x3d44e0(0x238),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x3d44e0(0x1d1),'common':{'name':_0x3d44e0(0x1cc),'type':_0x3d44e0(0x27b),'role':_0x3d44e0(0x28a),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x3d44e0(0x234)](LTM_DP_BASELINE_STATUS,{'type':_0x3d44e0(0x1d1),'common':{'name':_0x3d44e0(0x282),'type':_0x3d44e0(0x1dd),'role':_0x3d44e0(0x238),'read':!![],'write':![]},'native':{}});}async[a0_0x4297cf(0x304)](){const _0x1a76e9=a0_0x4297cf;await this[_0x1a76e9(0x234)](LTM_DP_DRIFT_CHANNEL,{'type':_0x1a76e9(0x297),'common':{'name':_0x1a76e9(0x20b)},'native':{}}),await this[_0x1a76e9(0x234)](LTM_DP_DRIFT_STATUS,{'type':_0x1a76e9(0x1d1),'common':{'name':_0x1a76e9(0x2f4),'type':'string','role':_0x1a76e9(0x1d1),'read':!![],'write':![],'def':_0x1a76e9(0x2e7)},'native':{}}),await this[_0x1a76e9(0x234)](LTM_DP_DRIFT_DETAILS,{'type':_0x1a76e9(0x1d1),'common':{'name':'Drift\x20Details','type':_0x1a76e9(0x1dd),'role':_0x1a76e9(0x238),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x1a76e9(0x1d1),'common':{'name':_0x1a76e9(0x321),'type':_0x1a76e9(0x2f8),'role':_0x1a76e9(0x1bf),'read':!![],'write':![]},'native':{}});}async[a0_0x4297cf(0x24e)](){const _0xaf175a=a0_0x4297cf;try{await this[_0xaf175a(0x28f)](),await this[_0xaf175a(0x2bd)](_0xaf175a(0x294),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x2be),'type':_0xaf175a(0x27b),'role':_0xaf175a(0x1e4),'read':!![],'write':![],'def':!![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xaf175a(0x2e1),{'type':_0xaf175a(0x1d1),'common':{'name':'Last\x20raw\x20event','type':_0xaf175a(0x1dd),'role':_0xaf175a(0x1e1),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xaf175a(0x21c),{'type':'state','common':{'name':_0xaf175a(0x243),'type':_0xaf175a(0x1dd),'role':_0xaf175a(0x1e1),'read':!![],'write':![]},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x2e4),{'type':_0xaf175a(0x1d1),'common':{'name':'Trigger\x20Analysis','type':'boolean','role':_0xaf175a(0x28a),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xaf175a(0x2fa),{'type':'state','common':{'name':_0xaf175a(0x1af),'type':_0xaf175a(0x27b),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x214),{'type':'state','common':{'name':_0xaf175a(0x2bf),'type':_0xaf175a(0x1dd),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x1d2),{'type':'state','common':{'name':'AI\x20Alert\x20Status','type':_0xaf175a(0x27b),'role':_0xaf175a(0x1d8),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x2e5),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x207),'type':_0xaf175a(0x27b),'role':_0xaf175a(0x1b0),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x196),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x1b1),'type':_0xaf175a(0x1dd),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x1d7),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x2bc),'type':_0xaf175a(0x1dd),'role':'text','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xaf175a(0x271),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x216),'type':_0xaf175a(0x1dd),'role':_0xaf175a(0x1d1),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x2fb),{'type':'state','common':{'name':_0xaf175a(0x2b7),'type':_0xaf175a(0x1dd),'role':_0xaf175a(0x238),'read':!![],'write':![]},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x229),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x21d),'type':_0xaf175a(0x1dd),'role':_0xaf175a(0x238),'read':!![],'write':![]},'native':{}}),await this[_0xaf175a(0x234)]('analysis.automation',{'type':_0xaf175a(0x297),'common':{'name':'Automation\x20Proposals'},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x255),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x1da),'type':'boolean','role':_0xaf175a(0x1e4),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0xaf175a(0x2bd)](_0xaf175a(0x2bb),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x270),'type':_0xaf175a(0x1dd),'role':_0xaf175a(0x238),'read':!![],'write':![]},'native':{}}),await this[_0xaf175a(0x2bd)]('analysis.automation.suggestedAction',{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x200),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0xaf175a(0x222),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x19d),'type':_0xaf175a(0x1dd),'role':_0xaf175a(0x1e1),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0xaf175a(0x2bd)]('analysis.feedbackHistory',{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x308),'type':_0xaf175a(0x1dd),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0xaf175a(0x234)]('analysis.health',{'type':_0xaf175a(0x297),'common':{'name':_0xaf175a(0x2d6)},'native':{}}),await this['setObjectNotExistsAsync'](_0xaf175a(0x2e0),{'type':'state','common':{'name':_0xaf175a(0x2e9),'type':'number','role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await this['setObjectNotExistsAsync']('analysis.health.restlessness',{'type':_0xaf175a(0x1d1),'common':{'name':'Restlessness\x20Level','type':'string','role':_0xaf175a(0x238),'read':!![],'write':![],'def':'none'},'native':{}}),await this['setObjectNotExistsAsync'](_0xaf175a(0x1f5),{'type':_0xaf175a(0x1d1),'common':{'name':_0xaf175a(0x316),'type':_0xaf175a(0x1dd),'role':_0xaf175a(0x238),'read':!![],'write':![],'def':''},'native':{}}),await this[_0xaf175a(0x27d)](),await this['checkLtmDriftObjects']();}catch(_0x13a927){this[_0xaf175a(0x286)]['error'](_0xaf175a(0x1cd)+_0x13a927[_0xaf175a(0x1c1)]);}}async[a0_0x4297cf(0x1b8)](){const _0x3af5c0=a0_0x4297cf;try{const _0x3ce234=await this[_0x3af5c0(0x1c3)](SYSTEM_DP_MODE);_0x3ce234&&_0x3ce234[_0x3af5c0(0x206)]&&Object[_0x3af5c0(0x233)](SYSTEM_MODES)[_0x3af5c0(0x325)](_0x3ce234[_0x3af5c0(0x206)])?this[_0x3af5c0(0x1c5)]=_0x3ce234['val']:(this[_0x3af5c0(0x1c5)]=SYSTEM_MODES[_0x3af5c0(0x2a6)],await this[_0x3af5c0(0x218)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3af5c0(0x2a6)],'ack':!![]}));}catch(_0x36f8cb){this[_0x3af5c0(0x1c5)]=SYSTEM_MODES[_0x3af5c0(0x2a6)];}}async[a0_0x4297cf(0x21e)](){const _0x29eca0=a0_0x4297cf;try{const _0x380eea=await this[_0x29eca0(0x1c3)](LTM_DP_RAW_LOG);if(_0x380eea&&_0x380eea[_0x29eca0(0x206)])this['rawEventLog']=JSON[_0x29eca0(0x19a)](_0x380eea[_0x29eca0(0x206)]);}catch(_0x55c7c4){this[_0x29eca0(0x314)]=[];}}async[a0_0x4297cf(0x2d0)](){const _0x48a153=a0_0x4297cf;try{const _0x14dafb=await this[_0x48a153(0x1c3)](LTM_DP_DAILY_DIGESTS);if(_0x14dafb&&_0x14dafb[_0x48a153(0x206)])this[_0x48a153(0x232)]=JSON[_0x48a153(0x19a)](_0x14dafb[_0x48a153(0x206)]);}catch(_0x20c367){this[_0x48a153(0x232)]=[];}await this[_0x48a153(0x1a8)]();}async[a0_0x4297cf(0x1a8)](){const _0x364e96=a0_0x4297cf;if(!this['isProVersion']){await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x364e96(0x20f),'ack':!![]});return;}const _0x1fdf94=this[_0x364e96(0x232)]['length']>=(this[_0x364e96(0x2f0)][_0x364e96(0x303)]||0x7)?_0x364e96(0x2d1)+this['dailyDigests'][_0x364e96(0x280)]+_0x364e96(0x261):_0x364e96(0x1d0)+this[_0x364e96(0x232)][_0x364e96(0x280)]+'/'+(this[_0x364e96(0x2f0)][_0x364e96(0x303)]||0x7)+')';await this[_0x364e96(0x218)](LTM_DP_BASELINE_STATUS,{'val':_0x1fdf94,'ack':!![]});}[a0_0x4297cf(0x195)](){const _0x2efea3=a0_0x4297cf;try{if(this['ltmJob'])this[_0x2efea3(0x288)][_0x2efea3(0x31d)]();if(!this[_0x2efea3(0x25d)]){this[_0x2efea3(0x218)](LTM_DP_STATUS,{'val':_0x2efea3(0x20f),'ack':!![]});return;}this['ltmJob']=schedule[_0x2efea3(0x1bc)](LTM_SCHEDULE,()=>this['createDailyDigest']());}catch(_0x27ad27){this[_0x2efea3(0x286)][_0x2efea3(0x268)](_0x2efea3(0x252)+_0x27ad27[_0x2efea3(0x1c1)]);}}[a0_0x4297cf(0x1e0)](){const _0x38c1a4=a0_0x4297cf;try{if(this[_0x38c1a4(0x2d8)])this[_0x38c1a4(0x2d8)][_0x38c1a4(0x31d)]();this[_0x38c1a4(0x2d8)]=schedule[_0x38c1a4(0x1bc)](MODE_RESET_SCHEDULE,async()=>{const _0x1d617a=_0x38c1a4;await this['loadSystemMode'](),AUTO_RESET_MODES[_0x1d617a(0x325)](this[_0x1d617a(0x1c5)])&&await this[_0x1d617a(0x218)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x1d617a(0x2a6)],'ack':![]});});}catch(_0x23b08c){this['log'][_0x38c1a4(0x268)](_0x38c1a4(0x29f)+_0x23b08c[_0x38c1a4(0x1c1)]);}}['setupDriftAnalysisScheduler'](){const _0x248ace=a0_0x4297cf;try{if(this[_0x248ace(0x2d9)])clearInterval(this[_0x248ace(0x2d9)]);if(!this[_0x248ace(0x25d)])return;this['driftAnalysisTimer']=setInterval(()=>this[_0x248ace(0x1ba)](),(this['config'][_0x248ace(0x29a)]||0x18)*0x36ee80),setTimeout(()=>this[_0x248ace(0x1ba)](),0x1388);}catch(_0x3e02cb){this[_0x248ace(0x286)][_0x248ace(0x268)](_0x248ace(0x276)+_0x3e02cb[_0x248ace(0x1c1)]);}}[a0_0x4297cf(0x272)](){const _0x5bd334=a0_0x4297cf;try{if(this[_0x5bd334(0x2cc)])this['briefingJob'][_0x5bd334(0x31d)]();if(!this[_0x5bd334(0x2f0)][_0x5bd334(0x1eb)])return;const _0x5ee389=(this[_0x5bd334(0x2f0)][_0x5bd334(0x1a3)]||_0x5bd334(0x19b))[_0x5bd334(0x2a5)](':'),_0x3fff30=parseInt(_0x5ee389[0x0])||0x8,_0x4f62ff=parseInt(_0x5ee389[0x1])||0x0,_0x486e3a=_0x4f62ff+'\x20'+_0x3fff30+_0x5bd334(0x257);this[_0x5bd334(0x286)]['info']('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x3fff30+':'+(_0x4f62ff<0xa?'0'+_0x4f62ff:_0x4f62ff)),this[_0x5bd334(0x2cc)]=schedule[_0x5bd334(0x1bc)](_0x486e3a,()=>{const _0x22b561=_0x5bd334;this[_0x22b561(0x2b8)]();});}catch(_0x483816){this[_0x5bd334(0x286)][_0x5bd334(0x268)](_0x5bd334(0x311)+_0x483816[_0x5bd334(0x1c1)]);}}async[a0_0x4297cf(0x1ae)](){const _0xa9a8f4=a0_0x4297cf;this[_0xa9a8f4(0x286)][_0xa9a8f4(0x30a)](_0xa9a8f4(0x2d2)+this[_0xa9a8f4(0x19c)]+')');try{const _0x1a634e=[_0xa9a8f4(0x2da),_0xa9a8f4(0x267),_0xa9a8f4(0x247),_0xa9a8f4(0x2ea),_0xa9a8f4(0x211),_0xa9a8f4(0x27f),_0xa9a8f4(0x29e),_0xa9a8f4(0x230),_0xa9a8f4(0x251),_0xa9a8f4(0x20d)];for(const _0x4bb54f of _0x1a634e){try{const _0x155909=await this['getObjectAsync'](_0x4bb54f);_0x155909&&await this['delObjectAsync'](_0x4bb54f);}catch(_0x50e0f5){}}}catch(_0x73ba33){}this[_0xa9a8f4(0x2f0)][_0xa9a8f4(0x2df)]=this['config'][_0xa9a8f4(0x2df)]||'';try{this[_0xa9a8f4(0x25d)]=await this[_0xa9a8f4(0x221)](this[_0xa9a8f4(0x2f0)]['licenseKey']);}catch(_0x2ded80){this[_0xa9a8f4(0x286)][_0xa9a8f4(0x268)](_0xa9a8f4(0x2dc)+_0x2ded80[_0xa9a8f4(0x1c1)]);}if(!this[_0xa9a8f4(0x2f0)][_0xa9a8f4(0x1d9)]||this[_0xa9a8f4(0x2f0)]['inactivityThresholdHours']<0.1)this[_0xa9a8f4(0x2f0)][_0xa9a8f4(0x1d9)]=0xc;try{await this[_0xa9a8f4(0x2b3)]();}catch(_0x43aaaf){this[_0xa9a8f4(0x286)]['error'](_0xa9a8f4(0x1df)+_0x43aaaf[_0xa9a8f4(0x1c1)]);}try{const _0x43fe17=await this[_0xa9a8f4(0x293)](_0xa9a8f4(0x228));_0x43fe17&&_0x43fe17[_0xa9a8f4(0x2d5)]&&(this['systemConfig']={'latitude':_0x43fe17[_0xa9a8f4(0x2d5)][_0xa9a8f4(0x21a)]||0x0,'longitude':_0x43fe17['common'][_0xa9a8f4(0x27a)]||0x0,'city':_0x43fe17['common'][_0xa9a8f4(0x2a9)]||''});}catch(_0x488549){}if(this[_0xa9a8f4(0x2f0)][_0xa9a8f4(0x1f1)])try{this[_0xa9a8f4(0x1c7)]=new GoogleGenerativeAI(this[_0xa9a8f4(0x2f0)][_0xa9a8f4(0x1f1)]),this[_0xa9a8f4(0x269)]=this['genAI'][_0xa9a8f4(0x215)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xa9a8f4(0x2c9)}}),this[_0xa9a8f4(0x286)][_0xa9a8f4(0x30a)](_0xa9a8f4(0x275));}catch(_0x4d9f10){this[_0xa9a8f4(0x286)][_0xa9a8f4(0x268)](_0xa9a8f4(0x1fa)+_0x4d9f10[_0xa9a8f4(0x1c1)]);}try{await this[_0xa9a8f4(0x24e)]();}catch(_0x378f2e){this[_0xa9a8f4(0x286)][_0xa9a8f4(0x268)](_0xa9a8f4(0x29c)+_0x378f2e['message']);}try{await this[_0xa9a8f4(0x1b8)]();}catch(_0x38755a){this[_0xa9a8f4(0x286)][_0xa9a8f4(0x268)](_0xa9a8f4(0x31e)+_0x38755a['message']);}try{await this[_0xa9a8f4(0x21e)]();}catch(_0x2a5e81){this[_0xa9a8f4(0x286)]['error'](_0xa9a8f4(0x2f5)+_0x2a5e81[_0xa9a8f4(0x1c1)]);}try{await this[_0xa9a8f4(0x2d0)]();}catch(_0x12e6ee){this[_0xa9a8f4(0x286)][_0xa9a8f4(0x268)](_0xa9a8f4(0x1c4)+_0x12e6ee[_0xa9a8f4(0x1c1)]);}this['subscribeStates'](_0xa9a8f4(0x2e4)),this[_0xa9a8f4(0x1a7)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0xa9a8f4(0x248)),this['subscribeStates'](_0xa9a8f4(0x2fa));const _0x477747=this[_0xa9a8f4(0x2f0)][_0xa9a8f4(0x290)];if(_0x477747&&_0x477747['length']>0x0){this[_0xa9a8f4(0x286)]['info'](_0xa9a8f4(0x1a4)+_0x477747[_0xa9a8f4(0x280)]+_0xa9a8f4(0x1aa));for(const _0x9eb870 of _0x477747){if(_0x9eb870['id']){await this[_0xa9a8f4(0x1be)](_0x9eb870['id']);try{const _0x310a04=await this[_0xa9a8f4(0x274)](_0x9eb870['id']);if(_0x310a04)this[_0xa9a8f4(0x2ed)][_0x9eb870['id']]=_0x310a04[_0xa9a8f4(0x206)];}catch(_0x425a44){}}}}const _0x500398=this[_0xa9a8f4(0x2f0)][_0xa9a8f4(0x1fc)]||[];if(_0x500398[_0xa9a8f4(0x280)]>0x0){this['log'][_0xa9a8f4(0x30a)](_0xa9a8f4(0x1a4)+_0x500398[_0xa9a8f4(0x280)]+_0xa9a8f4(0x2af));for(const _0x366448 of _0x500398){await this[_0xa9a8f4(0x1be)](_0x366448);}try{await this[_0xa9a8f4(0x318)]();}catch(_0x145e0e){}}if(this[_0xa9a8f4(0x323)])clearInterval(this[_0xa9a8f4(0x323)]);const _0x3af0fb=this[_0xa9a8f4(0x2f0)][_0xa9a8f4(0x202)]||0xf;_0x3af0fb>0x0&&(this['log'][_0xa9a8f4(0x30a)](_0xa9a8f4(0x30f)+_0x3af0fb+_0xa9a8f4(0x26e)+this[_0xa9a8f4(0x2f0)]['inactivityThresholdHours']+'h.'),this['analysisTimer']=setInterval(()=>{const _0x1d747c=_0xa9a8f4;try{this[_0x1d747c(0x1dc)]();}catch(_0x15b482){this['log'][_0x1d747c(0x268)](_0x1d747c(0x263)+_0x15b482[_0x1d747c(0x1c1)]);}},_0x3af0fb*0x3c*0x3e8)),this[_0xa9a8f4(0x195)](),this['setupModeResetScheduler'](),this[_0xa9a8f4(0x31c)](),this[_0xa9a8f4(0x272)]();}[a0_0x4297cf(0x236)](_0x5a0120){const _0x387961=a0_0x4297cf;if(this[_0x387961(0x323)])clearInterval(this['analysisTimer']);if(this['driftAnalysisTimer'])clearInterval(this['driftAnalysisTimer']);if(this[_0x387961(0x288)])this[_0x387961(0x288)][_0x387961(0x31d)]();if(this[_0x387961(0x2d8)])this[_0x387961(0x2d8)][_0x387961(0x31d)]();if(this[_0x387961(0x2cc)])this['briefingJob'][_0x387961(0x31d)]();if(this['exitTimer'])clearTimeout(this[_0x387961(0x2eb)]);if(this['exitGraceTimer'])clearTimeout(this[_0x387961(0x2d7)]);_0x5a0120();}async[a0_0x4297cf(0x305)](_0x59eecf,_0x17f132){const _0x40b9b4=a0_0x4297cf;if(!_0x17f132)return;if(_0x59eecf===this[_0x40b9b4(0x2f6)]+'.'+SYSTEM_DP_MODE){_0x17f132[_0x40b9b4(0x206)]&&Object[_0x40b9b4(0x233)](SYSTEM_MODES)[_0x40b9b4(0x325)](_0x17f132[_0x40b9b4(0x206)])&&(this[_0x40b9b4(0x1c5)]=_0x17f132[_0x40b9b4(0x206)],_0x17f132[_0x40b9b4(0x206)]===SYSTEM_MODES[_0x40b9b4(0x1ab)]?this[_0x40b9b4(0x210)](![]):this[_0x40b9b4(0x210)](!![]));if(!_0x17f132[_0x40b9b4(0x310)])this[_0x40b9b4(0x2a8)](_0x59eecf,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x17f132[_0x40b9b4(0x310)]){_0x59eecf[_0x40b9b4(0x325)](_0x40b9b4(0x2e4))&&_0x17f132[_0x40b9b4(0x206)]&&(this['setState'](_0x59eecf,{'val':![],'ack':!![]}),this[_0x40b9b4(0x253)]());if(_0x59eecf[_0x40b9b4(0x325)](_0x40b9b4(0x22c))&&_0x17f132[_0x40b9b4(0x206)]){this[_0x40b9b4(0x2a8)](_0x59eecf,{'val':![],'ack':!![]});if(this[_0x40b9b4(0x25d)])this[_0x40b9b4(0x2f1)]();}_0x59eecf['includes']('triggerBriefing')&&_0x17f132[_0x40b9b4(0x206)]&&(this['setState'](_0x59eecf,{'val':![],'ack':!![]}),this[_0x40b9b4(0x2b8)]());return;}if(this['config'][_0x40b9b4(0x1fc)]&&this[_0x40b9b4(0x2f0)][_0x40b9b4(0x1fc)][_0x40b9b4(0x325)](_0x59eecf)){await this['checkWifiPresence']();return;}const _0x16e87f=(this[_0x40b9b4(0x2f0)][_0x40b9b4(0x290)]||[])[_0x40b9b4(0x201)](_0x3b5cfa=>_0x3b5cfa['id']===_0x59eecf);if(_0x16e87f)this['processSensorEvent'](_0x59eecf,_0x17f132,_0x16e87f);}async[a0_0x4297cf(0x1e3)](_0x4402b0){const _0x1c9b2d=a0_0x4297cf;if(typeof _0x4402b0===_0x1c9b2d(0x289)&&_0x4402b0[_0x1c9b2d(0x1c1)])try{if(_0x4402b0[_0x1c9b2d(0x22a)]===_0x1c9b2d(0x31a)){if(!_0x4402b0[_0x1c9b2d(0x1c1)][_0x1c9b2d(0x1c8)])return this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':![],'message':_0x1c9b2d(0x2f7)},_0x4402b0[_0x1c9b2d(0x1a1)]);try{const _0x30e845=new GoogleGenerativeAI(_0x4402b0[_0x1c9b2d(0x1c1)][_0x1c9b2d(0x1c8)])['getGenerativeModel']({'model':'models/gemini-flash-latest'});await _0x30e845[_0x1c9b2d(0x285)]('test'),this['sendTo'](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':!![],'message':_0x1c9b2d(0x2b1)},_0x4402b0[_0x1c9b2d(0x1a1)]);}catch(_0x212077){this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':![],'message':_0x212077['message']},_0x4402b0[_0x1c9b2d(0x1a1)]);}}else{if(_0x4402b0[_0x1c9b2d(0x22a)]===_0x1c9b2d(0x312)){const _0x52abff=await this['sendNotification'](_0x1c9b2d(0x2e8),!![]);this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0['command'],{'success':_0x52abff>0x0,'message':_0x52abff+_0x1c9b2d(0x203)},_0x4402b0[_0x1c9b2d(0x1a1)]);}else{if(_0x4402b0['command']===_0x1c9b2d(0x25b)){if(!this[_0x1c9b2d(0x25d)])return this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0['command'],{'success':![],'isPro':![]},_0x4402b0[_0x1c9b2d(0x1a1)]);let _0x4ff5f6={'status':_0x1c9b2d(0x2e7),'details':'','lastCheck':0x0};try{_0x4ff5f6[_0x1c9b2d(0x31f)]=(await this[_0x1c9b2d(0x1c3)](LTM_DP_DRIFT_STATUS))[_0x1c9b2d(0x206)],_0x4ff5f6[_0x1c9b2d(0x226)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))['val'],_0x4ff5f6[_0x1c9b2d(0x1ad)]=(await this[_0x1c9b2d(0x1c3)](LTM_DP_DRIFT_LAST_CHECK))[_0x1c9b2d(0x206)];}catch(_0x160587){}this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0['command'],{'success':!![],'isPro':!![],'dailyDigests':this[_0x1c9b2d(0x232)],'driftAnalysis':_0x4ff5f6,'analysisHistory':this[_0x1c9b2d(0x26b)]},_0x4402b0[_0x1c9b2d(0x1a1)]);}else{if(_0x4402b0[_0x1c9b2d(0x22a)]===_0x1c9b2d(0x2ae)){const _0x145dd8=await this[_0x1c9b2d(0x2b6)](_0x1c9b2d(0x30b),_0x1c9b2d(0x220)),_0x26f525=[];if(_0x145dd8)for(const _0x1790b8 in _0x145dd8){const _0x1ded6f=_0x145dd8[_0x1790b8],_0x1ee049=(_0x1ded6f[_0x1c9b2d(0x2d5)]&&typeof _0x1ded6f[_0x1c9b2d(0x2d5)]['name']===_0x1c9b2d(0x289)?_0x1ded6f['common'][_0x1c9b2d(0x237)]['de']:_0x1ded6f['common']['name'])||_0x1ded6f[_0x1c9b2d(0x2d5)][_0x1c9b2d(0x237)];_0x26f525['push']({'id':_0x1790b8,'name':_0x1ee049});}this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':!![],'enums':_0x26f525},_0x4402b0[_0x1c9b2d(0x1a1)]);}else{if(_0x4402b0[_0x1c9b2d(0x22a)]===_0x1c9b2d(0x2c6))try{const _0xeb2634=await this['scanForDevices'](_0x4402b0[_0x1c9b2d(0x1c1)]||{});this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':!![],'devices':_0xeb2634},_0x4402b0['callback']);}catch(_0x5e1b5c){this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':![],'error':_0x5e1b5c[_0x1c9b2d(0x1c1)]},_0x4402b0['callback']);}else{if(_0x4402b0[_0x1c9b2d(0x22a)]==='submitFeedback'){const {historyId:_0x297416,rating:_0x5c51a7,comment:_0x1e3b7d,alertReason:_0x223cf7}=_0x4402b0['message'];_0x297416&&_0x5c51a7?(await this['saveFeedback']({'timestamp':Date['now'](),'historyId':_0x297416,'rating':_0x5c51a7,'comment':_0x1e3b7d,'alertReason':_0x223cf7}),this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0['command'],{'success':!![]},_0x4402b0[_0x1c9b2d(0x1a1)])):this['sendTo'](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':![],'error':_0x1c9b2d(0x24f)},_0x4402b0[_0x1c9b2d(0x1a1)]);}else{if(_0x4402b0[_0x1c9b2d(0x22a)]===_0x1c9b2d(0x259)){const _0x276758=await this[_0x1c9b2d(0x23d)](),_0x1a33d0=await this[_0x1c9b2d(0x20a)]();this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0['command'],{'success':!![],'weather':_0x276758,'calendar':_0x1a33d0},_0x4402b0[_0x1c9b2d(0x1a1)]);}else{if(_0x4402b0[_0x1c9b2d(0x22a)]==='getCalendarNames'){const _0x5c2337=_0x4402b0[_0x1c9b2d(0x1c1)][_0x1c9b2d(0x1cf)];if(!_0x5c2337)return this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':![],'error':'No\x20instance'},_0x4402b0[_0x1c9b2d(0x1a1)]);const _0x1f9691=await this[_0x1c9b2d(0x2f2)](_0x5c2337);this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':!![],'names':_0x1f9691},_0x4402b0[_0x1c9b2d(0x1a1)]);}}}}}}}}}catch(_0x246d3d){if(_0x4402b0[_0x1c9b2d(0x1a1)])this[_0x1c9b2d(0x1cb)](_0x4402b0[_0x1c9b2d(0x2d4)],_0x4402b0[_0x1c9b2d(0x22a)],{'success':![],'error':_0x246d3d['message']},_0x4402b0[_0x1c9b2d(0x1a1)]);}}async['processSensorEvent'](_0x416d31,_0x284be1,_0x29150f){const _0x3c6f34=a0_0x4297cf;if(!_0x29150f[_0x3c6f34(0x2ab)]&&this[_0x3c6f34(0x2ed)][_0x416d31]===_0x284be1[_0x3c6f34(0x206)])return;this[_0x3c6f34(0x2ed)][_0x416d31]=_0x284be1[_0x3c6f34(0x206)];if(this['isGracePeriodActive'])return;const _0x1d1b53=await this[_0x3c6f34(0x318)]();if(_0x1d1b53){if(!this[_0x3c6f34(0x1c2)])this[_0x3c6f34(0x210)](!![]);}else{const _0x1647fa=_0x29150f[_0x3c6f34(0x292)]===!![];_0x1647fa?this[_0x3c6f34(0x1ac)]():(this[_0x3c6f34(0x2eb)]&&(this['log'][_0x3c6f34(0x30a)]('Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.'),this['abortExitTimer']()),!this[_0x3c6f34(0x1c2)]&&this[_0x3c6f34(0x1c5)]===SYSTEM_MODES[_0x3c6f34(0x2a6)]&&this[_0x3c6f34(0x210)](!![]));}const _0x2ae818={'timestamp':_0x284be1['ts'],'id':_0x416d31,'name':_0x29150f['name'],'value':_0x284be1['val'],'location':_0x29150f[_0x3c6f34(0x27e)],'type':_0x29150f[_0x3c6f34(0x19f)]};this[_0x3c6f34(0x28b)][_0x3c6f34(0x1a5)](_0x2ae818);if(this[_0x3c6f34(0x28b)]['length']>HISTORY_MAX_SIZE)this['eventHistory'][_0x3c6f34(0x1f9)]();await this['setStateAsync'](_0x3c6f34(0x2e1),{'val':JSON[_0x3c6f34(0x2ce)](_0x2ae818),'ack':!![]}),await this[_0x3c6f34(0x218)]('events.history',{'val':JSON['stringify'](this['eventHistory']),'ack':!![]}),this[_0x3c6f34(0x314)][_0x3c6f34(0x2c5)]({'timestamp':new Date(_0x284be1['ts'])[_0x3c6f34(0x1fe)](),'sensorName':_0x29150f[_0x3c6f34(0x237)],'location':_0x29150f[_0x3c6f34(0x27e)],'value':_0x284be1[_0x3c6f34(0x206)]}),await this[_0x3c6f34(0x1a2)]();}async['runAutopilot'](){const _0x355b8a=a0_0x4297cf,_0x560145=this[_0x355b8a(0x2f0)][_0x355b8a(0x1d9)],_0x58e71f=this[_0x355b8a(0x2f0)][_0x355b8a(0x302)],_0x29e2ed=this[_0x355b8a(0x28b)][_0x355b8a(0x280)]>0x0?this[_0x355b8a(0x28b)][0x0][_0x355b8a(0x291)]:Date[_0x355b8a(0x23b)](),_0x216cf1=(Date[_0x355b8a(0x23b)]()-_0x29e2ed)/(0x3e8*0x3c*0x3c);let _0x382388='';_0x58e71f&&this[_0x355b8a(0x1c5)]===SYSTEM_MODES[_0x355b8a(0x2a6)]&&this['isPresent']&&(_0x216cf1>_0x560145&&(_0x382388=_0x355b8a(0x23f)+_0x216cf1[_0x355b8a(0x2a3)](0x1)+'\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.'));if(_0x382388){this[_0x355b8a(0x253)](_0x382388)[_0x355b8a(0x25f)](_0x1ccadd=>this[_0x355b8a(0x286)][_0x355b8a(0x268)](_0x1ccadd));return;}const _0x4b3af3=Date['now'](),_0x8775c=_0x4b3af3-_0x29e2ed,_0x5d8c8b=(this[_0x355b8a(0x2f0)][_0x355b8a(0x202)]||0xf)*0x3c*0x3e8;this['eventHistory'][_0x355b8a(0x280)]>0x0&&_0x8775c<=_0x5d8c8b?this[_0x355b8a(0x253)]()['catch'](_0x1f50f8=>this[_0x355b8a(0x286)][_0x355b8a(0x268)](_0x1f50f8)):!this[_0x355b8a(0x1b4)]&&(this['setState']('analysis.isAlert',{'val':![],'ack':!![]}),this[_0x355b8a(0x2a8)](_0x355b8a(0x2e5),{'val':![],'ack':!![]}));}async[a0_0x4297cf(0x253)](_0x134f97=''){const _0x72651=a0_0x4297cf;if(!this[_0x72651(0x269)])return;const _0x49ebca=this[_0x72651(0x28b)][_0x72651(0x280)]>0x0?this['eventHistory']:[{'note':_0x72651(0x1f2)}],_0x21c808=PERSONA_MAPPING[this[_0x72651(0x2f0)][_0x72651(0x23c)]||_0x72651(0x224)],_0x5d45ed=this[_0x72651(0x2f0)]['livingContext']||'',_0x4ef94e=this[_0x72651(0x1c5)],_0x38975e=await this[_0x72651(0x23d)](),_0x412eaf=await this[_0x72651(0x20a)](),_0x407ce1=(_0x38975e+'\x20'+_0x412eaf)['trim'](),_0x31ab4f=new Date(),_0x37afcd=_0x31ab4f[_0x72651(0x315)](_0x72651(0x295),{'weekday':'long','hour':_0x72651(0x277),'minute':'2-digit'}),_0x3b0331=this[_0x72651(0x2ca)];let _0x4cc483='';if(this['feedbackHistory']['length']>0x0){const _0xe20426=this[_0x72651(0x24a)][_0x72651(0x1a9)](0x0,0x3)[_0x72651(0x23a)](_0x5356fc=>_0x72651(0x1c0)+_0x5356fc[_0x72651(0x26a)]+'\x22\x20was\x20'+_0x5356fc['rating']+'.')[_0x72651(0x296)]('\x0a');_0x4cc483=_0x72651(0x2db)+_0xe20426+'\x0a';}const _0x133312=_0x134f97?'\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a'+_0x134f97+_0x72651(0x322):'',_0x418e2d=_0x72651(0x2c7),_0x12972f=_0x72651(0x2aa)+_0x37afcd+'.\x20ORT:\x20'+_0x3b0331['city']+_0x72651(0x2dd)+_0x4ef94e+'.\x20PR√ÑSENZ:\x20'+(this[_0x72651(0x1c2)]?'Ja':'Nein')+_0x72651(0x241)+_0x5d45ed+'.\x20PERSONA:\x20'+_0x21c808+_0x72651(0x2e3)+_0x407ce1+_0x72651(0x287)+_0x418e2d+'\x20'+_0x4cc483+'\x20'+_0x133312+_0x72651(0x29d)+JSON[_0x72651(0x2ce)](_0x49ebca)+_0x72651(0x309);try{const _0x3f641c=await this[_0x72651(0x269)][_0x72651(0x285)](_0x12972f),_0x1c19d5=_0x3f641c[_0x72651(0x1d5)][_0x72651(0x238)]()['replace'](/```json|```/g,'')[_0x72651(0x209)](),_0x3c8a2a=JSON[_0x72651(0x19a)](_0x1c19d5);await this[_0x72651(0x218)](_0x72651(0x214),{'val':_0x1c19d5,'ack':!![]}),await this[_0x72651(0x218)](_0x72651(0x196),{'val':_0x3c8a2a[_0x72651(0x1fd)][_0x72651(0x26a)]||'','ack':!![]}),await this[_0x72651(0x218)](_0x72651(0x1d7),{'val':_0x3c8a2a[_0x72651(0x1fd)][_0x72651(0x1bb)]||_0x72651(0x2e7),'ack':!![]}),await this[_0x72651(0x218)]('analysis.deviationFromBaseline',{'val':_0x3c8a2a[_0x72651(0x1fd)][_0x72651(0x2ef)]||'N/A','ack':!![]});_0x3c8a2a[_0x72651(0x205)]&&(await this[_0x72651(0x218)]('analysis.comfortSummary',{'val':_0x3c8a2a['comfort'][_0x72651(0x1bb)]||'','ack':!![]}),await this[_0x72651(0x218)](_0x72651(0x229),{'val':_0x3c8a2a[_0x72651(0x205)]['suggestion']||'','ack':!![]}),_0x3c8a2a[_0x72651(0x205)][_0x72651(0x1f8)]&&(await this[_0x72651(0x218)](_0x72651(0x255),{'val':_0x3c8a2a['comfort'][_0x72651(0x1f8)][_0x72651(0x1d3)]||![],'ack':!![]}),await this[_0x72651(0x218)](_0x72651(0x2bb),{'val':_0x3c8a2a[_0x72651(0x205)][_0x72651(0x1f8)][_0x72651(0x254)]||'','ack':!![]}),await this[_0x72651(0x218)](_0x72651(0x21b),{'val':_0x3c8a2a['comfort'][_0x72651(0x1f8)][_0x72651(0x1c9)]||'','ack':!![]})));_0x3c8a2a['health']&&(await this[_0x72651(0x218)](_0x72651(0x2e0),{'val':typeof _0x3c8a2a[_0x72651(0x1e2)][_0x72651(0x1d6)]===_0x72651(0x2f8)?_0x3c8a2a[_0x72651(0x1e2)][_0x72651(0x1d6)]:0x0,'ack':!![]}),await this[_0x72651(0x218)](_0x72651(0x208),{'val':_0x3c8a2a['health'][_0x72651(0x244)]||_0x72651(0x2c2),'ack':!![]}),await this['setStateAsync']('analysis.health.notes',{'val':_0x3c8a2a[_0x72651(0x1e2)][_0x72651(0x313)]||'','ack':!![]}));const _0x1ed809=_0x3c8a2a['activity'][_0x72651(0x1b9)]||![],_0x3d175b=_0x3c8a2a[_0x72651(0x1fd)][_0x72651(0x1e9)]||![];if(_0x1ed809||_0x3d175b){await this[_0x72651(0x218)](_0x72651(0x1d2),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x72651(0x2e5),{'val':_0x3d175b,'ack':!![]});if(!this[_0x72651(0x1b4)]||_0x3d175b){const _0x4d47a4=_0x3d175b?_0x72651(0x1fb):'‚ö†Ô∏è\x20Alarm';this['sendNotification'](_0x4d47a4+':\x20'+_0x3c8a2a[_0x72651(0x1fd)][_0x72651(0x26a)],![],_0x3d175b);}}else await this[_0x72651(0x218)]('analysis.isAlert',{'val':![],'ack':!![]}),await this[_0x72651(0x218)]('analysis.isEmergency',{'val':![],'ack':!![]});this['lastAlertState']=_0x1ed809||_0x3d175b;const _0x1a9b1e={'timestamp':Date[_0x72651(0x23b)](),'id':Date[_0x72651(0x23b)]()[_0x72651(0x2cb)](),'analysis':_0x3c8a2a,'systemMode':_0x4ef94e,'isPro':this[_0x72651(0x25d)]};this['updateAnalysisHistory'](_0x1a9b1e);}catch(_0x3fd6ab){this['log'][_0x72651(0x268)]('Analysis\x20Error:\x20'+_0x3fd6ab[_0x72651(0x1c1)]);}}async[a0_0x4297cf(0x2f1)](){const _0x339baa=a0_0x4297cf;if(!this[_0x339baa(0x269)]||this['rawEventLog']['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x339baa(0x218)](LTM_DP_STATUS,{'val':_0x339baa(0x327),'ack':!![]});return;}this[_0x339baa(0x286)][_0x339baa(0x30a)](_0x339baa(0x2b2)+this['rawEventLog'][_0x339baa(0x280)]+_0x339baa(0x26d)),await this[_0x339baa(0x218)](LTM_DP_STATUS,{'val':_0x339baa(0x198),'ack':!![]});const _0x2d1950=this[_0x339baa(0x314)][_0x339baa(0x280)]>0x320?this['rawEventLog'][_0x339baa(0x1a9)](this['rawEventLog'][_0x339baa(0x280)]-0x320):this['rawEventLog'],_0x34a20f=PERSONA_MAPPING[this['config']['aiPersona']||_0x339baa(0x224)],_0x51abc9=_0x339baa(0x2b0)+_0x34a20f+_0x339baa(0x204)+JSON[_0x339baa(0x2ce)](_0x2d1950)+_0x339baa(0x235);try{const _0x262a57=await this[_0x339baa(0x269)][_0x339baa(0x285)](_0x51abc9),_0x554fe6=_0x262a57[_0x339baa(0x1d5)]['text']()[_0x339baa(0x2f9)](/```json|```/g,'')[_0x339baa(0x209)](),_0x240e4d=JSON[_0x339baa(0x19a)](_0x554fe6),_0x244115={'timestamp':new Date()[_0x339baa(0x1fe)](),'eventCount':this['rawEventLog'][_0x339baa(0x280)],'summary':_0x240e4d[_0x339baa(0x1bb)],'activityLevel':_0x240e4d[_0x339baa(0x242)],'health':{'sleepScore':_0x240e4d['health']?_0x240e4d[_0x339baa(0x1e2)][_0x339baa(0x1d6)]:0x0,'restlessness':_0x240e4d['health']?_0x240e4d[_0x339baa(0x1e2)][_0x339baa(0x244)]:'none'},'systemMode':this[_0x339baa(0x1c5)]};this[_0x339baa(0x232)]['push'](_0x244115),await this[_0x339baa(0x29b)](),this['rawEventLog']=[],await this['saveRawEventLog'](),await this[_0x339baa(0x218)](LTM_DP_STATUS,{'val':_0x339baa(0x2ac),'ack':!![]}),this[_0x339baa(0x286)][_0x339baa(0x30a)](_0x339baa(0x262));}catch(_0x39e660){this[_0x339baa(0x286)]['error'](_0x339baa(0x307)+_0x39e660[_0x339baa(0x1c1)]),await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x339baa(0x2ec)+_0x39e660[_0x339baa(0x1c1)],'ack':!![]});}}async['sendMorningBriefing'](){const _0x2eb283=a0_0x4297cf;if(!this[_0x2eb283(0x269)])return;this[_0x2eb283(0x286)][_0x2eb283(0x30a)](_0x2eb283(0x1ee));const _0x1d4ce2=this[_0x2eb283(0x232)]['length']>0x0?this['dailyDigests'][this[_0x2eb283(0x232)][_0x2eb283(0x280)]-0x1]:null,_0x501528=_0x1d4ce2&&_0x1d4ce2['health']?_0x1d4ce2['health'][_0x2eb283(0x1d6)]:_0x2eb283(0x2e7),_0x2f413b=new Date();_0x2f413b[_0x2eb283(0x1a0)](0x4,0x0,0x0,0x0);const _0x306755=this[_0x2eb283(0x28b)][_0x2eb283(0x2cf)](_0x18afe6=>new Date(_0x18afe6['timestamp'])>_0x2f413b),_0x19da81=PERSONA_MAPPING[this[_0x2eb283(0x2f0)][_0x2eb283(0x23c)]||_0x2eb283(0x224)],_0x57db8e=this[_0x2eb283(0x2f0)][_0x2eb283(0x22b)]||'',_0x255ffe=await this[_0x2eb283(0x23d)](),_0x56e7e6=await this[_0x2eb283(0x20a)](),_0x1c8e44='ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20'+_0x19da81+_0x2eb283(0x2f3)+_0x57db8e+_0x2eb283(0x1c6)+_0x255ffe+'\x20'+_0x56e7e6+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20'+_0x501528+'/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20'+JSON[_0x2eb283(0x2ce)](_0x306755[_0x2eb283(0x1a9)](0x0,0xa))+_0x2eb283(0x217);try{const _0x5e50e5=await this[_0x2eb283(0x269)]['generateContent'](_0x1c8e44),_0x12c650='üåÖ\x20Daily\x20Briefing:\x0a'+_0x5e50e5[_0x2eb283(0x1d5)]['text']()['trim']();this[_0x2eb283(0x23e)](_0x12c650),this['log'][_0x2eb283(0x30a)](_0x2eb283(0x2a4));}catch(_0x119cf0){this[_0x2eb283(0x286)][_0x2eb283(0x268)](_0x2eb283(0x24c)+_0x119cf0[_0x2eb283(0x1c1)]);}}['tryParse'](_0x25f55c){const _0x4a175a=a0_0x4297cf;if(typeof _0x25f55c==='object')return _0x25f55c;try{return JSON[_0x4a175a(0x19a)](_0x25f55c);}catch(_0x3c2645){return null;}}async[a0_0x4297cf(0x23d)](){const _0x277ec3=a0_0x4297cf;try{if(!this[_0x277ec3(0x2f0)][_0x277ec3(0x320)])return _0x277ec3(0x213);let _0x167187='';const _0x4a4acd=this[_0x277ec3(0x2f0)][_0x277ec3(0x2c0)];if(_0x4a4acd)try{if(_0x4a4acd[_0x277ec3(0x325)](_0x277ec3(0x256))){const _0x4e3309=await this[_0x277ec3(0x274)](_0x4a4acd+_0x277ec3(0x22f));if(_0x4e3309&&_0x4e3309['val'])_0x167187=_0x4e3309[_0x277ec3(0x206)];}else{if(_0x4a4acd[_0x277ec3(0x325)]('daswetter')){const _0x2be99c=await this[_0x277ec3(0x274)](_0x4a4acd+_0x277ec3(0x265));if(_0x2be99c&&_0x2be99c[_0x277ec3(0x206)])_0x167187=_0x2be99c['val'];}else{if(_0x4a4acd[_0x277ec3(0x325)](_0x277ec3(0x2e2))){const _0x2ba737=await this['getForeignStateAsync'](_0x4a4acd+_0x277ec3(0x328));if(_0x2ba737&&_0x2ba737[_0x277ec3(0x206)])_0x167187=_0x2ba737[_0x277ec3(0x206)];}}}}catch(_0x4abfaa){}if(!_0x167187){const _0x10509f=[_0x277ec3(0x2fe),_0x277ec3(0x2c1),_0x277ec3(0x1b6),_0x277ec3(0x28e)];for(const _0x435cb6 of _0x10509f){try{const _0x42fd51=await this[_0x277ec3(0x293)](_0x435cb6);if(_0x42fd51){if(_0x435cb6['includes'](_0x277ec3(0x256))){const _0x491efe=await this['getForeignStateAsync'](_0x435cb6+'.Summary.Current');if(_0x491efe&&_0x491efe['val']){_0x167187=_0x491efe[_0x277ec3(0x206)];break;}}}}catch(_0xaa8561){}}}return _0x167187?_0x277ec3(0x2de)+_0x167187:_0x277ec3(0x273);}catch(_0x1ce173){return'WETTER\x20ERROR:\x20'+_0x1ce173[_0x277ec3(0x1c1)];}}async[a0_0x4297cf(0x20a)](){const _0x5adafb=a0_0x4297cf;try{if(!this['config'][_0x5adafb(0x301)])return _0x5adafb(0x1f0);let _0xc31c3f=this[_0x5adafb(0x2f0)][_0x5adafb(0x30c)]||_0x5adafb(0x266),_0x448d1b=this[_0x5adafb(0x2f0)][_0x5adafb(0x2a0)]||[];if(typeof _0x448d1b===_0x5adafb(0x1dd))_0x448d1b=_0x448d1b['split'](',');try{const _0x413eb0=await this['getForeignStateAsync'](_0xc31c3f+_0x5adafb(0x223));if(_0x413eb0&&_0x413eb0['val']){let _0x3c9086=this[_0x5adafb(0x279)](_0x413eb0[_0x5adafb(0x206)]);if(_0x3c9086&&Array[_0x5adafb(0x283)](_0x3c9086)){if(_0x448d1b[_0x5adafb(0x280)]>0x0)_0x3c9086=_0x3c9086[_0x5adafb(0x2cf)](_0x5024f7=>_0x448d1b['includes'](_0x5024f7[_0x5adafb(0x26f)]||''));else return _0x5adafb(0x25e);if(_0x3c9086[_0x5adafb(0x280)]>0x0){const _0x16b032=_0x3c9086[_0x5adafb(0x1a9)](0x0,0x3)[_0x5adafb(0x23a)](_0x1d861d=>{const _0x8bb3ca=_0x5adafb;let _0x3e48a3=_0x1d861d[_0x8bb3ca(0x1bf)];if(_0x1d861d[_0x8bb3ca(0x1ff)])_0x3e48a3+='\x20'+_0x1d861d[_0x8bb3ca(0x1ff)];return _0x3e48a3+':\x20'+_0x1d861d['event']+'\x20('+_0x1d861d[_0x8bb3ca(0x26f)]+')';});return _0x5adafb(0x1e6)+_0x16b032[_0x5adafb(0x296)](_0x5adafb(0x1e7));}else return _0x5adafb(0x1b7);}}}catch(_0xaa4a49){this[_0x5adafb(0x286)][_0x5adafb(0x245)](_0x5adafb(0x1ed)+_0xaa4a49[_0x5adafb(0x1c1)]);}return _0x5adafb(0x240);}catch(_0x4f6a76){return'KALENDER\x20ERROR:\x20'+_0x4f6a76[_0x5adafb(0x1c1)];}}async[a0_0x4297cf(0x2f2)](_0x488d63){const _0x29bcce=a0_0x4297cf;try{const _0x5f2b43=await this[_0x29bcce(0x274)](_0x488d63+_0x29bcce(0x223));if(_0x5f2b43&&_0x5f2b43['val']){const _0x13d0d8=this[_0x29bcce(0x279)](_0x5f2b43[_0x29bcce(0x206)]);if(_0x13d0d8&&Array[_0x29bcce(0x283)](_0x13d0d8)){const _0x28b9bd=[...new Set(_0x13d0d8['map'](_0x5bdbaf=>_0x5bdbaf['_calName'])[_0x29bcce(0x2cf)](Boolean))];return _0x28b9bd[_0x29bcce(0x1e5)]();}}return[];}catch(_0x5c7684){return this['log']['error'](_0x29bcce(0x24d)+_0x5c7684[_0x29bcce(0x1c1)]),[];}}async['checkWifiPresence'](){const _0x337ef7=a0_0x4297cf;try{const _0x3d8ad2=this[_0x337ef7(0x2f0)][_0x337ef7(0x1fc)]||[];let _0x564721=![];for(const _0x280439 of _0x3d8ad2){try{const _0x57e8f8=await this[_0x337ef7(0x274)](_0x280439);if(_0x57e8f8&&(_0x57e8f8['val']===!![]||_0x57e8f8[_0x337ef7(0x206)]==='online'||_0x57e8f8['val']===0x1)){_0x564721=!![];break;}}catch(_0x55a420){}}return _0x564721&&(this['exitTimer']&&(this[_0x337ef7(0x286)][_0x337ef7(0x30a)](_0x337ef7(0x1ca)),this[_0x337ef7(0x30d)]()),!this[_0x337ef7(0x1c2)]&&this[_0x337ef7(0x1c5)]===SYSTEM_MODES[_0x337ef7(0x2a6)]&&this[_0x337ef7(0x210)](!![])),_0x564721;}catch(_0x3b5902){return this['log'][_0x337ef7(0x268)](_0x337ef7(0x25a)+_0x3b5902[_0x337ef7(0x1c1)]),![];}}async['startExitTimer'](){const _0x3b8952=a0_0x4297cf;this[_0x3b8952(0x30d)](),this[_0x3b8952(0x25c)]=!![],this[_0x3b8952(0x2d7)]=setTimeout(()=>{const _0x41d2d8=_0x3b8952;this[_0x41d2d8(0x25c)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x3b8952(0x2eb)]=setTimeout(()=>{const _0x78450f=_0x3b8952;this[_0x78450f(0x210)](![]),this[_0x78450f(0x2eb)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}async[a0_0x4297cf(0x30d)](){const _0x10c84c=a0_0x4297cf;if(this['exitTimer'])clearTimeout(this['exitTimer']);if(this['exitGraceTimer'])clearTimeout(this[_0x10c84c(0x2d7)]);this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x10c84c(0x25c)]=![];}async['setPresence'](_0x4601b8){const _0x1edce6=a0_0x4297cf;if(this[_0x1edce6(0x1c2)]===_0x4601b8)return;this[_0x1edce6(0x1c2)]=_0x4601b8,await this['setStateAsync'](_0x1edce6(0x294),{'val':_0x4601b8,'ack':!![]});}async['getSystemUUID'](){const _0x2f67e2=a0_0x4297cf;try{const _0x1e6efe=await this[_0x2f67e2(0x293)]('system.meta.uuid');if(_0x1e6efe&&_0x1e6efe[_0x2f67e2(0x2c4)]&&_0x1e6efe[_0x2f67e2(0x2c4)]['uuid'])return _0x1e6efe[_0x2f67e2(0x2c4)][_0x2f67e2(0x317)];return _0x2f67e2(0x1ce);}catch(_0x5dcae3){return'uuid-error';}}async['checkLicense'](_0x3052ba){const _0x1c78fb=a0_0x4297cf;if(!_0x3052ba)return![];this['systemUUID']=await this[_0x1c78fb(0x2a1)]();if(_0x3052ba===_0x1c78fb(0x2b5)||_0x3052ba['startsWith'](_0x1c78fb(0x26c)))return!![];return![];}async[a0_0x4297cf(0x19e)](_0x4586aa){const _0xbca1f2=a0_0x4297cf;this[_0xbca1f2(0x26b)][_0xbca1f2(0x1a5)](_0x4586aa);if(this[_0xbca1f2(0x26b)][_0xbca1f2(0x280)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0xbca1f2(0x26b)][_0xbca1f2(0x1f9)]();await this[_0xbca1f2(0x218)](_0xbca1f2(0x222),{'val':JSON[_0xbca1f2(0x2ce)](this[_0xbca1f2(0x26b)]),'ack':!![]});}async[a0_0x4297cf(0x23e)](_0x3625d2,_0xa5e3cd=![],_0x57a8b2=![]){const _0x3ff621=a0_0x4297cf;this[_0x3ff621(0x286)]['info']((_0xa5e3cd?_0x3ff621(0x2b4):'')+_0x3ff621(0x27c)+_0x3625d2+'\x22'+(_0x57a8b2?_0x3ff621(0x264):''));const _0x169d4d=this['config'];let _0x14af93=0x0;_0x169d4d[_0x3ff621(0x1d4)]&&_0x169d4d[_0x3ff621(0x1b5)]&&(await this['sendToAsync'](_0x169d4d[_0x3ff621(0x1b5)],_0x3ff621(0x2b9),{'text':_0x3625d2,'user':_0x169d4d[_0x3ff621(0x197)]}),_0x14af93++);if(_0x169d4d['notifyPushoverEnabled']&&_0x169d4d[_0x3ff621(0x1a6)]){let _0x5bcef6={'message':_0x3625d2,'title':_0x57a8b2?_0x3ff621(0x1db):'Cogni-Living\x20Alert','priority':_0x57a8b2?0x2:0x1,'device':_0x169d4d[_0x3ff621(0x284)]};_0x57a8b2&&(_0x5bcef6[_0x3ff621(0x249)]=0x1e,_0x5bcef6[_0x3ff621(0x2cd)]=0xe10,_0x5bcef6[_0x3ff621(0x2c8)]=_0x3ff621(0x2fd)),await this[_0x3ff621(0x1bd)](_0x169d4d[_0x3ff621(0x1a6)],'send',_0x5bcef6),_0x14af93++;}return _0x169d4d['notifyEmailEnabled']&&_0x169d4d[_0x3ff621(0x1f7)]&&(await this[_0x3ff621(0x1bd)](_0x169d4d[_0x3ff621(0x1f7)],'send',{'text':_0x3625d2,'to':_0x169d4d[_0x3ff621(0x22e)]}),_0x14af93++),_0x169d4d[_0x3ff621(0x281)]&&_0x169d4d[_0x3ff621(0x2fc)]&&(await this[_0x3ff621(0x1bd)](_0x169d4d[_0x3ff621(0x2fc)],_0x3ff621(0x2b9),{'text':_0x3625d2,'phone':_0x169d4d[_0x3ff621(0x20e)]}),_0x14af93++),_0x169d4d['notifySignalEnabled']&&_0x169d4d['notifySignalInstance']&&(await this[_0x3ff621(0x1bd)](_0x169d4d['notifySignalInstance'],_0x3ff621(0x2b9),{'text':_0x3625d2,'phone':_0x169d4d[_0x3ff621(0x1e8)]}),_0x14af93++),_0x14af93;}}if(require[a0_0x4297cf(0x2ba)]!==module)module['exports']=_0x22aaf0=>new CogniLiving(_0x22aaf0);else new CogniLiving();