const a0_0x5b2d07=a0_0x2816;(function(_0x101f72,_0x499e2b){const _0x4c19b6=a0_0x2816,_0x24d0d1=_0x101f72();while(!![]){try{const _0x29cfbc=-parseInt(_0x4c19b6(0x340))/0x1*(-parseInt(_0x4c19b6(0x200))/0x2)+parseInt(_0x4c19b6(0x1c4))/0x3*(-parseInt(_0x4c19b6(0x262))/0x4)+parseInt(_0x4c19b6(0x188))/0x5*(parseInt(_0x4c19b6(0x2bb))/0x6)+parseInt(_0x4c19b6(0x2a9))/0x7+parseInt(_0x4c19b6(0x1d1))/0x8+-parseInt(_0x4c19b6(0x252))/0x9*(parseInt(_0x4c19b6(0x184))/0xa)+-parseInt(_0x4c19b6(0x2c7))/0xb;if(_0x29cfbc===_0x499e2b)break;else _0x24d0d1['push'](_0x24d0d1['shift']());}catch(_0x396133){_0x24d0d1['push'](_0x24d0d1['shift']());}}}(a0_0x5c23,0xa0243));const a0_0x5ac6d8=(function(){let _0x3f34eb=!![];return function(_0x2998d0,_0x14ca86){const _0x50ccfe=_0x3f34eb?function(){const _0x4958e7=a0_0x2816;if(_0x14ca86){const _0x124f54=_0x14ca86[_0x4958e7(0x17a)](_0x2998d0,arguments);return _0x14ca86=null,_0x124f54;}}:function(){};return _0x3f34eb=![],_0x50ccfe;};}()),a0_0x3c711e=a0_0x5ac6d8(this,function(){const _0x43ff33=a0_0x2816;return a0_0x3c711e[_0x43ff33(0x1a3)]()[_0x43ff33(0x16e)]('(((.+)+)+)+$')[_0x43ff33(0x1a3)]()[_0x43ff33(0x343)](a0_0x3c711e)[_0x43ff33(0x16e)](_0x43ff33(0x2b7));});a0_0x3c711e();'use strict';const utils=require(a0_0x5b2d07(0x2ab)),{GoogleGenerativeAI}=require(a0_0x5b2d07(0x30e)),schedule=require(a0_0x5b2d07(0x1a6)),{spawn,exec}=require(a0_0x5b2d07(0x32f)),path=require(a0_0x5b2d07(0x250)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x5b2d07(0x1f4),MODE_RESET_SCHEDULE=a0_0x5b2d07(0x313),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x5b2d07(0x22e),LTM_DP_DAILY_DIGESTS=a0_0x5b2d07(0x21f),LTM_DP_STATUS=a0_0x5b2d07(0x31c),LTM_DP_TRIGGER_DIGEST=a0_0x5b2d07(0x352),LTM_DP_BASELINE_STATUS=a0_0x5b2d07(0x2e6),LTM_DP_DRIFT_CHANNEL=a0_0x5b2d07(0x25f),LTM_DP_DRIFT_STATUS=a0_0x5b2d07(0x27c),LTM_DP_DRIFT_DETAILS=a0_0x5b2d07(0x1a7),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x5b2d07(0x261),HARD_IGNORE_TERMS=[a0_0x5b2d07(0x1aa),a0_0x5b2d07(0x2cf),a0_0x5b2d07(0x292),a0_0x5b2d07(0x2ed),a0_0x5b2d07(0x2f1),a0_0x5b2d07(0x1ff),a0_0x5b2d07(0x177),a0_0x5b2d07(0x23e),a0_0x5b2d07(0x196),a0_0x5b2d07(0x17e),a0_0x5b2d07(0x317),'direction',a0_0x5b2d07(0x30d),'config_pending',a0_0x5b2d07(0x16c),a0_0x5b2d07(0x1fe),a0_0x5b2d07(0x1e3),a0_0x5b2d07(0x2c2)],BAD_NAMES=[a0_0x5b2d07(0x2cb),'currentposition',a0_0x5b2d07(0x27d),a0_0x5b2d07(0x228),a0_0x5b2d07(0x1e6),a0_0x5b2d07(0x212),'on','off','switch',a0_0x5b2d07(0x1c7),a0_0x5b2d07(0x181),a0_0x5b2d07(0x28e),a0_0x5b2d07(0x1e4),a0_0x5b2d07(0x27e),a0_0x5b2d07(0x333),'presence',a0_0x5b2d07(0x322),'temperature',a0_0x5b2d07(0x342),a0_0x5b2d07(0x26d),a0_0x5b2d07(0x240),'setpoint','valve',a0_0x5b2d07(0x315),'set_temperature'],ADAPTER_BLACKLIST=['system.',a0_0x5b2d07(0x2d3),'info.',a0_0x5b2d07(0x1f9),'history.','material.',a0_0x5b2d07(0x26f),a0_0x5b2d07(0x1e9),a0_0x5b2d07(0x180),'javascript.',a0_0x5b2d07(0x201)],SYSTEM_MODES={'NORMAL':a0_0x5b2d07(0x232),'VACATION':a0_0x5b2d07(0x2d5),'PARTY':a0_0x5b2d07(0x295),'GUEST':a0_0x5b2d07(0x27f)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x5b2d07(0x246),'family':a0_0x5b2d07(0x233),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x5b2d07(0x21e)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};async function initZombies(_0x4afadd){const _0x3ee756=a0_0x5b2d07;try{const _0x3c2be7=[_0x3ee756(0x2db),'events.history_debug_00'];for(const _0x6d8afe of _0x3c2be7){try{const _0x3721d0=await _0x4afadd[_0x3ee756(0x2a5)](_0x6d8afe);_0x3721d0&&await _0x4afadd[_0x3ee756(0x214)](_0x6d8afe);}catch(_0x51ab11){}}}catch(_0x511f6f){}}async function initHistory(_0xe04b06){const _0x358b39=a0_0x5b2d07;try{const _0x4bb5fe=await _0xe04b06['getStateAsync']('events.history');_0x4bb5fe&&_0x4bb5fe[_0x358b39(0x348)]&&(_0xe04b06['eventHistory']=JSON['parse'](_0x4bb5fe[_0x358b39(0x348)]['toString']()));}catch(_0x46b55c){_0xe04b06['eventHistory']=[];}try{const _0x198743=await _0xe04b06[_0x358b39(0x274)](_0x358b39(0x277));if(_0x198743&&_0x198743['val'])_0xe04b06[_0x358b39(0x2ea)]=JSON[_0x358b39(0x1b3)](_0x198743['val'][_0x358b39(0x1a3)]());}catch(_0x1a416d){_0xe04b06[_0x358b39(0x2ea)]=[];}if(_0xe04b06[_0x358b39(0x243)]&&_0xe04b06[_0x358b39(0x243)][_0x358b39(0x2d7)]>0x0){_0xe04b06[_0x358b39(0x329)][_0x358b39(0x311)](_0x358b39(0x32c)+_0xe04b06['eventHistory'][_0x358b39(0x2d7)]+_0x358b39(0x318));for(let _0x1597ce=_0xe04b06[_0x358b39(0x243)][_0x358b39(0x2d7)]-0x1;_0x1597ce>=0x0;_0x1597ce--){const _0x2a9dde=_0xe04b06[_0x358b39(0x243)][_0x1597ce];_0x2a9dde&&_0x2a9dde['id']!==undefined&&_0x2a9dde[_0x358b39(0x1e6)]!==undefined&&(_0xe04b06[_0x358b39(0x23f)][_0x2a9dde['id']]=_0x2a9dde['value']);}}}async function initSystemConfig(_0x3520ab){const _0x2d2ee2=a0_0x5b2d07;try{const _0x50792a=await _0x3520ab[_0x2d2ee2(0x2e1)](_0x2d2ee2(0x2a0));_0x50792a&&_0x50792a['common']&&(_0x3520ab[_0x2d2ee2(0x187)]={'latitude':_0x50792a[_0x2d2ee2(0x17f)][_0x2d2ee2(0x2c3)]||0x0,'longitude':_0x50792a['common']['longitude']||0x0,'city':_0x50792a[_0x2d2ee2(0x17f)][_0x2d2ee2(0x2d1)]||''});}catch(_0x1893e9){}}async function checkLicense(_0x22fb03,_0x1964a2){const _0x54a57c=a0_0x5b2d07;if(!_0x1964a2)return![];_0x22fb03[_0x54a57c(0x287)]=await getSystemUUID(_0x22fb03);if(_0x1964a2===_0x54a57c(0x231)||_0x1964a2['startsWith'](_0x54a57c(0x173)))return!![];return![];}async function getSystemUUID(_0x3fdc29){const _0x5e1cc8=a0_0x5b2d07;try{const _0x55990b=await _0x3fdc29[_0x5e1cc8(0x2e1)]('system.meta.uuid');if(_0x55990b&&_0x55990b[_0x5e1cc8(0x2d6)]&&_0x55990b[_0x5e1cc8(0x2d6)][_0x5e1cc8(0x18b)])return _0x55990b[_0x5e1cc8(0x2d6)][_0x5e1cc8(0x18b)];return _0x5e1cc8(0x19f);}catch(_0x219cab){return _0x5e1cc8(0x2b9);}}async function createAllObjects(_0x28c98c){const _0x18d7fe=a0_0x5b2d07;await checkSystemObjects(_0x28c98c),await _0x28c98c[_0x18d7fe(0x215)]('system.presenceWho',{'type':_0x18d7fe(0x27d),'common':{'name':'Who\x20is\x20present?','type':'string','role':_0x18d7fe(0x1bf),'read':!![],'write':![],'def':''},'native':{}}),await _0x28c98c['setObjectNotExistsAsync']('events.lastEvent',{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x30c),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x2ae),{'type':'state','common':{'name':'Event\x20History','type':'string','role':_0x18d7fe(0x2fe),'read':!![],'write':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)]('analysis.trigger',{'type':'state','common':{'name':'Trigger\x20Analysis','type':_0x18d7fe(0x1c1),'role':_0x18d7fe(0x2d4),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x344),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x1ef),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x283),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x2fd),'type':_0x18d7fe(0x2c8),'role':_0x18d7fe(0x2fe),'read':!![],'write':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x350),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x206),'type':_0x18d7fe(0x1c1),'role':_0x18d7fe(0x20e),'read':!![],'write':![],'def':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x330),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x325),'type':'boolean','role':_0x18d7fe(0x19e),'read':!![],'write':![],'def':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)]('analysis.alertReason',{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x23a),'type':'string','role':_0x18d7fe(0x305),'read':!![],'write':![]},'native':{}}),await _0x28c98c['setObjectNotExistsAsync'](_0x18d7fe(0x355),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x2ad),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x28c98c['setObjectNotExistsAsync']('analysis.deviationFromBaseline',{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x1fd),'type':'string','role':'state','read':!![],'write':![],'def':_0x18d7fe(0x33b)},'native':{}}),await _0x28c98c['setObjectNotExistsAsync'](_0x18d7fe(0x30a),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x2aa),'type':_0x18d7fe(0x2c8),'role':'text','read':!![],'write':![]},'native':{}}),await _0x28c98c['setObjectNotExistsAsync']('analysis.comfortSuggestion',{'type':'state','common':{'name':_0x18d7fe(0x302),'type':_0x18d7fe(0x2c8),'role':_0x18d7fe(0x1bf),'read':!![],'write':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x280)](_0x18d7fe(0x223),{'type':'channel','common':{'name':'Automation\x20Proposals'},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x28f),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x2d0),'type':_0x18d7fe(0x1c1),'role':_0x18d7fe(0x16d),'read':!![],'write':![],'def':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x1c3),{'type':_0x18d7fe(0x27d),'common':{'name':'Description','type':_0x18d7fe(0x2c8),'role':_0x18d7fe(0x1bf),'read':!![],'write':![]},'native':{}}),await _0x28c98c['setObjectNotExistsAsync'](_0x18d7fe(0x34e),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x26e),'type':_0x18d7fe(0x2c8),'role':_0x18d7fe(0x1bf),'read':!![],'write':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x1c6),{'type':_0x18d7fe(0x27d),'common':{'name':'Target\x20ID','type':_0x18d7fe(0x2c8),'role':_0x18d7fe(0x1bf),'read':!![],'write':![]},'native':{}}),await _0x28c98c['setObjectNotExistsAsync']('analysis.automation.targetValue',{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x2d2),'type':_0x18d7fe(0x2c8),'role':_0x18d7fe(0x1bf),'read':!![],'write':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x1c0),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x301),'type':_0x18d7fe(0x1c1),'role':_0x18d7fe(0x1a8),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)]('analysis.automation.triggerAction',{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x2a7),'type':_0x18d7fe(0x1c1),'role':_0x18d7fe(0x2d4),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x28c98c['setObjectNotExistsAsync']('analysis.analysisHistory',{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x32d),'type':_0x18d7fe(0x2c8),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x1f0),{'type':_0x18d7fe(0x27d),'common':{'name':'Feedback\x20Log','type':_0x18d7fe(0x2c8),'role':_0x18d7fe(0x2fe),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x28c98c['extendObjectAsync'](_0x18d7fe(0x300),{'type':_0x18d7fe(0x1df),'common':{'name':_0x18d7fe(0x289)},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x1a5),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x1a9),'type':_0x18d7fe(0x1cb),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x28c98c['setObjectNotExistsAsync'](_0x18d7fe(0x238),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x255),'type':'string','role':_0x18d7fe(0x1bf),'read':!![],'write':![],'def':'none'},'native':{}}),await _0x28c98c['setObjectNotExistsAsync'](_0x18d7fe(0x263),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x189),'type':'string','role':_0x18d7fe(0x1bf),'read':!![],'write':![],'def':''},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x269),{'type':_0x18d7fe(0x27d),'common':{'name':_0x18d7fe(0x1af),'type':_0x18d7fe(0x2c8),'role':_0x18d7fe(0x1bf),'read':!![],'write':![],'def':_0x18d7fe(0x33b)},'native':{}}),await _0x28c98c[_0x18d7fe(0x215)](_0x18d7fe(0x33f),{'type':_0x18d7fe(0x27d),'common':{'name':'Trend\x20Value\x20(%)','type':_0x18d7fe(0x1cb),'role':_0x18d7fe(0x1e6),'read':!![],'write':![],'def':0x0},'native':{}}),await checkLtmObjects(_0x28c98c),await checkLtmDriftObjects(_0x28c98c);}async function checkSystemObjects(_0x4610fe){const _0x28f678=a0_0x5b2d07;await _0x4610fe[_0x28f678(0x280)](_0x28f678(0x353),{'type':_0x28f678(0x1df),'common':{'name':_0x28f678(0x296)},'native':{}}),await _0x4610fe[_0x28f678(0x280)](SYSTEM_DP_MODE,{'type':_0x28f678(0x27d),'common':{'name':_0x28f678(0x266),'type':'string','role':_0x28f678(0x27d),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x28f678(0x258)],'states':{[SYSTEM_MODES[_0x28f678(0x258)]]:_0x28f678(0x1d8),[SYSTEM_MODES[_0x28f678(0x19c)]]:_0x28f678(0x33a),[SYSTEM_MODES[_0x28f678(0x312)]]:_0x28f678(0x310),[SYSTEM_MODES[_0x28f678(0x1f5)]]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x22a30b){const _0xdd854=a0_0x5b2d07;await _0x22a30b[_0xdd854(0x280)](_0xdd854(0x2c9),{'type':_0xdd854(0x1df),'common':{'name':'LTM'},'native':{}}),await _0x22a30b[_0xdd854(0x280)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0xdd854(0x26c),'type':_0xdd854(0x2c8),'role':_0xdd854(0x2fe),'read':!![],'write':![]},'native':{}}),await _0x22a30b[_0xdd854(0x280)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0xdd854(0x1c9),'type':_0xdd854(0x2c8),'role':'json','read':!![],'write':![]},'native':{}}),await _0x22a30b[_0xdd854(0x280)](LTM_DP_STATUS,{'type':_0xdd854(0x27d),'common':{'name':_0xdd854(0x225),'type':_0xdd854(0x2c8),'role':_0xdd854(0x1bf),'read':!![],'write':![]},'native':{}}),await _0x22a30b['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0xdd854(0x27d),'common':{'name':'Trigger\x20Digest','type':'boolean','role':_0xdd854(0x2d4),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x22a30b['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0xdd854(0x27d),'common':{'name':_0xdd854(0x2e2),'type':_0xdd854(0x2c8),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x5548e0){const _0x338d2b=a0_0x5b2d07;await _0x5548e0['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x338d2b(0x175)},'native':{}}),await _0x5548e0[_0x338d2b(0x280)](LTM_DP_DRIFT_STATUS,{'type':_0x338d2b(0x27d),'common':{'name':_0x338d2b(0x30f),'type':_0x338d2b(0x2c8),'role':_0x338d2b(0x27d),'read':!![],'write':![],'def':_0x338d2b(0x33b)},'native':{}}),await _0x5548e0[_0x338d2b(0x280)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x338d2b(0x20a),'type':'string','role':_0x338d2b(0x1bf),'read':!![],'write':![]},'native':{}}),await _0x5548e0[_0x338d2b(0x280)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x338d2b(0x31e),'type':_0x338d2b(0x1cb),'role':_0x338d2b(0x307),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x19c679){const _0x2eed9b=a0_0x5b2d07;try{const _0x2a3e22=await _0x19c679[_0x2eed9b(0x274)](SYSTEM_DP_MODE);_0x2a3e22&&_0x2a3e22[_0x2eed9b(0x348)]&&Object[_0x2eed9b(0x2fa)](SYSTEM_MODES)[_0x2eed9b(0x18a)](_0x2a3e22[_0x2eed9b(0x348)])?_0x19c679['currentSystemMode']=_0x2a3e22[_0x2eed9b(0x348)]:(_0x19c679[_0x2eed9b(0x259)]=SYSTEM_MODES[_0x2eed9b(0x258)],await _0x19c679[_0x2eed9b(0x29c)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x2eed9b(0x258)],'ack':!![]}));}catch(_0x5d0ab3){_0x19c679[_0x2eed9b(0x259)]=SYSTEM_MODES[_0x2eed9b(0x258)];}}async function loadRawEventLog(_0x3f3582){const _0x243375=a0_0x5b2d07;try{const _0x27c7f0=await _0x3f3582[_0x243375(0x274)](LTM_DP_RAW_LOG);if(_0x27c7f0&&_0x27c7f0[_0x243375(0x348)])_0x3f3582[_0x243375(0x235)]=JSON[_0x243375(0x1b3)](_0x27c7f0[_0x243375(0x348)]);}catch(_0x2a39bd){_0x3f3582['rawEventLog']=[];}}async function saveRawEventLog(_0xf2d919){const _0x272cd7=a0_0x5b2d07;_0xf2d919[_0x272cd7(0x235)]['length']>RAW_LOG_MAX_SIZE&&_0xf2d919[_0x272cd7(0x235)][_0x272cd7(0x171)](0x0,_0xf2d919[_0x272cd7(0x235)][_0x272cd7(0x2d7)]-RAW_LOG_MAX_SIZE),await _0xf2d919[_0x272cd7(0x29c)](LTM_DP_RAW_LOG,{'val':JSON[_0x272cd7(0x178)](_0xf2d919[_0x272cd7(0x235)]),'ack':!![]});}async function loadDailyDigests(_0x4ab150){const _0x593d47=a0_0x5b2d07;try{const _0x999c89=await _0x4ab150[_0x593d47(0x274)](LTM_DP_DAILY_DIGESTS);if(_0x999c89&&_0x999c89[_0x593d47(0x348)])_0x4ab150[_0x593d47(0x288)]=JSON[_0x593d47(0x1b3)](_0x999c89['val']);}catch(_0x2dbd2c){_0x4ab150[_0x593d47(0x288)]=[];}await updateBaselineStatus(_0x4ab150);}async function saveDailyDigests(_0x5b7c12,_0x59ef4f=!![]){const _0x379ffc=a0_0x5b2d07,_0x514e19=_0x5b7c12[_0x379ffc(0x34d)]['ltmLtbWindowDays']||0x3c;_0x5b7c12[_0x379ffc(0x288)][_0x379ffc(0x2d7)]>_0x514e19&&_0x5b7c12[_0x379ffc(0x288)]['splice'](0x0,_0x5b7c12['dailyDigests'][_0x379ffc(0x2d7)]-_0x514e19);await _0x5b7c12['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x379ffc(0x178)](_0x5b7c12['dailyDigests']),'ack':!![]});if(_0x59ef4f)await updateBaselineStatus(_0x5b7c12);}async function updateAnalysisHistory(_0x37fc5f,_0x47ba4a){const _0x17258f=a0_0x5b2d07;_0x37fc5f[_0x17258f(0x2ea)][_0x17258f(0x2e0)](_0x47ba4a);if(_0x37fc5f[_0x17258f(0x2ea)][_0x17258f(0x2d7)]>ANALYSIS_HISTORY_MAX_SIZE)_0x37fc5f[_0x17258f(0x2ea)][_0x17258f(0x1f7)]();await _0x37fc5f['setStateAsync']('analysis.analysisHistory',{'val':JSON[_0x17258f(0x178)](_0x37fc5f[_0x17258f(0x2ea)]),'ack':!![]});}async function updateBaselineStatus(_0x4f4cd3){const _0x1ccc59=a0_0x5b2d07;if(!_0x4f4cd3['isProVersion']){await _0x4f4cd3[_0x1ccc59(0x29c)](LTM_DP_BASELINE_STATUS,{'val':_0x1ccc59(0x21b),'ack':!![]});return;}const _0x1cf5b8=_0x4f4cd3[_0x1ccc59(0x288)][_0x1ccc59(0x2d7)]>=(_0x4f4cd3[_0x1ccc59(0x34d)][_0x1ccc59(0x347)]||0x7)?_0x1ccc59(0x1d3)+_0x4f4cd3['dailyDigests'][_0x1ccc59(0x2d7)]+'\x20Tage)':_0x1ccc59(0x17c)+_0x4f4cd3['dailyDigests'][_0x1ccc59(0x2d7)]+'/'+(_0x4f4cd3[_0x1ccc59(0x34d)][_0x1ccc59(0x347)]||0x7)+')';await _0x4f4cd3[_0x1ccc59(0x29c)](LTM_DP_BASELINE_STATUS,{'val':_0x1cf5b8,'ack':!![]});}async function initSensorSubscriptions(_0x3f8182){const _0x16ef26=a0_0x5b2d07,_0x4dd95e=_0x3f8182[_0x16ef26(0x34d)][_0x16ef26(0x222)];if(_0x4dd95e&&_0x4dd95e[_0x16ef26(0x2d7)]>0x0){_0x3f8182[_0x16ef26(0x329)][_0x16ef26(0x311)]('Subscribing\x20to\x20'+_0x4dd95e[_0x16ef26(0x2d7)]+'\x20sensors...');for(const _0x25c2ae of _0x4dd95e){if(_0x25c2ae['id']){await _0x3f8182[_0x16ef26(0x291)](_0x25c2ae['id']);try{const _0x1e6086=await _0x3f8182[_0x16ef26(0x245)](_0x25c2ae['id']);if(_0x1e6086)_0x3f8182[_0x16ef26(0x23f)][_0x25c2ae['id']]=_0x1e6086['val'];}catch(_0xee4da6){}}}}}async function initPresenceSubscriptions(_0x16f16f){const _0x239122=a0_0x5b2d07,_0x534a3b=_0x16f16f[_0x239122(0x34d)][_0x239122(0x191)]||[];if(_0x534a3b[_0x239122(0x2d7)]>0x0){_0x16f16f[_0x239122(0x329)][_0x239122(0x311)]('Subscribing\x20to\x20'+_0x534a3b[_0x239122(0x2d7)]+'\x20presence\x20devices...');for(const _0x3d2838 of _0x534a3b){await _0x16f16f[_0x239122(0x291)](_0x3d2838);}try{await checkWifiPresence(_0x16f16f);}catch(_0x4aecf6){}}}async function getWeatherContext(_0x240fa9){const _0x4a86b6=a0_0x5b2d07;try{if(!_0x240fa9[_0x4a86b6(0x34d)][_0x4a86b6(0x285)])return'Wetter:\x20Deaktiviert';let _0x240e4d='';const _0x120506=_0x240fa9['config'][_0x4a86b6(0x221)];if(_0x120506)try{if(_0x120506['includes'](_0x4a86b6(0x2b0))){const _0x2e3be7=await _0x240fa9[_0x4a86b6(0x245)](_0x120506+_0x4a86b6(0x1ba));if(_0x2e3be7&&_0x2e3be7['val'])_0x240e4d=_0x2e3be7[_0x4a86b6(0x348)];}else{if(_0x120506[_0x4a86b6(0x18a)]('daswetter')){const _0x2cd6b0=await _0x240fa9['getForeignStateAsync'](_0x120506+_0x4a86b6(0x1bb));if(_0x2cd6b0&&_0x2cd6b0[_0x4a86b6(0x348)])_0x240e4d=_0x2cd6b0['val'];}else{if(_0x120506[_0x4a86b6(0x18a)]('openweathermap')){const _0x21f3f1=await _0x240fa9[_0x4a86b6(0x245)](_0x120506+_0x4a86b6(0x2f3));if(_0x21f3f1&&_0x21f3f1[_0x4a86b6(0x348)])_0x240e4d=_0x21f3f1[_0x4a86b6(0x348)];}}}}catch(_0x31c3e6){}if(!_0x240e4d){const _0x1d188c=[_0x4a86b6(0x239),'daswetter.0','weatherunderground.0',_0x4a86b6(0x2e3)];for(const _0x23d072 of _0x1d188c){try{const _0x22d5e9=await _0x240fa9[_0x4a86b6(0x2e1)](_0x23d072);if(_0x22d5e9){if(_0x23d072[_0x4a86b6(0x18a)]('accuweather')){const _0x3e0a14=await _0x240fa9[_0x4a86b6(0x245)](_0x23d072+_0x4a86b6(0x1ba));if(_0x3e0a14&&_0x3e0a14[_0x4a86b6(0x348)]){_0x240e4d=_0x3e0a14[_0x4a86b6(0x348)];break;}}}}catch(_0x374cc8){}}}return _0x240e4d?'WETTER:\x20'+_0x240e4d:_0x4a86b6(0x2a3);}catch(_0x40cb6d){return _0x4a86b6(0x217)+_0x40cb6d['message'];}}async function getCalendarContext(_0x4ed8ad){const _0x42d9d9=a0_0x5b2d07;try{if(!_0x4ed8ad[_0x42d9d9(0x34d)][_0x42d9d9(0x2f7)])return _0x42d9d9(0x24d);let _0x1712b0=_0x4ed8ad['config']['calendarInstance']||_0x42d9d9(0x1cd),_0x292b67=_0x4ed8ad['config'][_0x42d9d9(0x2c1)]||[];if(typeof _0x292b67===_0x42d9d9(0x2c8))_0x292b67=_0x292b67[_0x42d9d9(0x28d)](',');try{const _0x2cd83b=await _0x4ed8ad[_0x42d9d9(0x245)](_0x1712b0+_0x42d9d9(0x306));if(_0x2cd83b&&_0x2cd83b[_0x42d9d9(0x348)]){let _0x536482=tryParse(_0x2cd83b[_0x42d9d9(0x348)]);if(_0x536482&&Array['isArray'](_0x536482)){if(_0x292b67[_0x42d9d9(0x2d7)]>0x0)_0x536482=_0x536482[_0x42d9d9(0x25b)](_0x12427d=>_0x292b67['includes'](_0x12427d['_calName']||''));else return _0x42d9d9(0x190);if(_0x536482[_0x42d9d9(0x2d7)]>0x0){const _0x2f8706=_0x536482['slice'](0x0,0x3)[_0x42d9d9(0x1c2)](_0x4c54ba=>{const _0x30cab0=_0x42d9d9;let _0x5ed7d0=_0x4c54ba[_0x30cab0(0x307)];if(_0x4c54ba[_0x30cab0(0x308)])_0x5ed7d0+='\x20'+_0x4c54ba[_0x30cab0(0x308)];return _0x5ed7d0+':\x20'+_0x4c54ba['event']+'\x20('+_0x4c54ba[_0x30cab0(0x2f6)]+')';});return _0x42d9d9(0x1f8)+_0x2f8706[_0x42d9d9(0x2dc)](_0x42d9d9(0x227));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x191cc4){_0x4ed8ad[_0x42d9d9(0x329)][_0x42d9d9(0x254)]('Error\x20reading\x20calendar\x20table:\x20'+_0x191cc4['message']);}return _0x42d9d9(0x2dd);}catch(_0x466970){return _0x42d9d9(0x275)+_0x466970[_0x42d9d9(0x26b)];}}async function getCalendarNames(_0x1782bd,_0x397317){const _0x4c5244=a0_0x5b2d07;try{const _0x3988fb=await _0x1782bd[_0x4c5244(0x245)](_0x397317+_0x4c5244(0x306));if(_0x3988fb&&_0x3988fb[_0x4c5244(0x348)]){const _0x1986ae=tryParse(_0x3988fb[_0x4c5244(0x348)]);if(_0x1986ae&&Array['isArray'](_0x1986ae)){const _0x1f2e1c=[...new Set(_0x1986ae[_0x4c5244(0x1c2)](_0x408e0c=>_0x408e0c['_calName'])[_0x4c5244(0x25b)](Boolean))];return _0x1f2e1c[_0x4c5244(0x2c6)]();}}return[];}catch(_0x1a9e8b){return _0x1782bd[_0x4c5244(0x329)][_0x4c5244(0x196)](_0x4c5244(0x1d4)+_0x1a9e8b['message']),[];}}async function checkWifiPresence(_0x41966e){const _0x470945=a0_0x5b2d07;try{const _0x37c26f=_0x41966e[_0x470945(0x34d)]['presenceDevices']||[];let _0x51e8ee=![];const _0x16714f=[];for(const _0x54cec2 of _0x37c26f){try{const _0x333746=await _0x41966e[_0x470945(0x245)](_0x54cec2);if(_0x333746&&(_0x333746[_0x470945(0x348)]===!![]||_0x333746[_0x470945(0x348)]===_0x470945(0x264)||_0x333746[_0x470945(0x348)]===0x1)){_0x51e8ee=!![];const _0x145834=await _0x41966e[_0x470945(0x2e1)](_0x54cec2);let _0x48447c=_0x54cec2;_0x145834&&_0x145834[_0x470945(0x17f)]&&_0x145834[_0x470945(0x17f)][_0x470945(0x2ca)]&&(_0x48447c=typeof _0x145834[_0x470945(0x17f)]['name']===_0x470945(0x210)?_0x145834['common'][_0x470945(0x2ca)]['de']||_0x145834[_0x470945(0x17f)][_0x470945(0x2ca)]['en']:_0x145834[_0x470945(0x17f)]['name']),_0x16714f[_0x470945(0x2bc)](_0x48447c);}}catch(_0x308bcf){}}return await _0x41966e['setStateAsync'](_0x470945(0x332),{'val':_0x16714f[_0x470945(0x2dc)](',\x20'),'ack':!![]}),_0x51e8ee&&(_0x41966e['exitTimer']&&(_0x41966e[_0x470945(0x329)][_0x470945(0x311)](_0x470945(0x328)),abortExitTimer(_0x41966e)),!_0x41966e[_0x470945(0x24e)]&&_0x41966e[_0x470945(0x259)]===SYSTEM_MODES[_0x470945(0x258)]&&await setPresence(_0x41966e,!![])),_0x51e8ee;}catch(_0x2841f6){return _0x41966e['log'][_0x470945(0x196)]('Error\x20checking\x20WiFi:\x20'+_0x2841f6[_0x470945(0x26b)]),![];}}function startExitTimer(_0x567052){const _0x210740=a0_0x5b2d07;abortExitTimer(_0x567052),_0x567052[_0x210740(0x294)]=!![],_0x567052['exitGraceTimer']=setTimeout(()=>{_0x567052['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x567052[_0x210740(0x23d)]=setTimeout(()=>{const _0xf59f7d=_0x210740;setPresence(_0x567052,![]),_0x567052[_0xf59f7d(0x23d)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x37aa22){const _0x106ad1=a0_0x5b2d07;if(_0x37aa22[_0x106ad1(0x23d)])clearTimeout(_0x37aa22['exitTimer']);if(_0x37aa22[_0x106ad1(0x23b)])clearTimeout(_0x37aa22['exitGraceTimer']);_0x37aa22[_0x106ad1(0x23d)]=null,_0x37aa22[_0x106ad1(0x23b)]=null,_0x37aa22['isGracePeriodActive']=![];}async function setPresence(_0x84fbe7,_0xdb300b){const _0x909499=a0_0x5b2d07;if(_0x84fbe7['isPresent']===_0xdb300b)return;_0x84fbe7['isPresent']=_0xdb300b,await _0x84fbe7['setStateAsync'](_0x909499(0x2e5),{'val':_0xdb300b,'ack':!![]});}async function saveFeedback(_0x304c8a,_0x53c353){const _0x1d67b4=a0_0x5b2d07;_0x304c8a[_0x1d67b4(0x329)]['info'](_0x1d67b4(0x197)+JSON[_0x1d67b4(0x178)](_0x53c353));}async function runBaselineDriftAnalysis(_0x40900a){const _0x323eb7=a0_0x5b2d07;if(!_0x40900a[_0x323eb7(0x198)]||!_0x40900a[_0x323eb7(0x2b8)])return;const _0x457112=_0x40900a['config'][_0x323eb7(0x1bd)]||0xe;if(_0x40900a['dailyDigests']['length']<_0x457112+(_0x40900a[_0x323eb7(0x34d)][_0x323eb7(0x347)]||0x7)){await _0x40900a['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x323eb7(0x193),'ack':!![]});return;}const _0x10b060=_0x40900a[_0x323eb7(0x288)][_0x323eb7(0x226)](-_0x457112),_0x2a6bfe=_0x40900a['dailyDigests'][_0x323eb7(0x226)](0x0,_0x40900a[_0x323eb7(0x288)]['length']-_0x457112),_0x3577a5='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x323eb7(0x178)](_0x2a6bfe)+_0x323eb7(0x339)+JSON[_0x323eb7(0x178)](_0x10b060);try{const _0x550a07=await _0x40900a[_0x323eb7(0x2b8)][_0x323eb7(0x279)](_0x3577a5),_0x43b864=JSON['parse'](_0x550a07['response'][_0x323eb7(0x1bf)]()[_0x323eb7(0x1ca)](/```json|```/g,'')[_0x323eb7(0x18d)]());_0x43b864['baselineDrift']&&(await _0x40900a[_0x323eb7(0x29c)](LTM_DP_DRIFT_STATUS,{'val':_0x43b864[_0x323eb7(0x204)],'ack':!![]}),await _0x40900a[_0x323eb7(0x29c)](LTM_DP_DRIFT_DETAILS,{'val':_0x43b864[_0x323eb7(0x28a)],'ack':!![]}),await _0x40900a[_0x323eb7(0x29c)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x4cc3eb){}}function setupLtmScheduler(_0x57ce92){const _0x1f4327=a0_0x5b2d07;try{if(_0x57ce92[_0x1f4327(0x22c)])_0x57ce92[_0x1f4327(0x22c)][_0x1f4327(0x2b6)]();if(!_0x57ce92['isProVersion']){_0x57ce92[_0x1f4327(0x29c)](LTM_DP_STATUS,{'val':_0x1f4327(0x21b),'ack':!![]});return;}_0x57ce92[_0x1f4327(0x22c)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x57ce92));}catch(_0x5bab37){_0x57ce92['log']['error']('LTM\x20Sched\x20Error:\x20'+_0x5bab37[_0x1f4327(0x26b)]);}}function setupModeResetScheduler(_0x3ab9cd){const _0xbef3b3=a0_0x5b2d07;try{if(_0x3ab9cd[_0xbef3b3(0x194)])_0x3ab9cd[_0xbef3b3(0x194)][_0xbef3b3(0x2b6)]();_0x3ab9cd[_0xbef3b3(0x194)]=schedule[_0xbef3b3(0x185)](MODE_RESET_SCHEDULE,async()=>{const _0x2eb729=_0xbef3b3;await loadSystemMode(_0x3ab9cd),AUTO_RESET_MODES[_0x2eb729(0x18a)](_0x3ab9cd[_0x2eb729(0x259)])&&await _0x3ab9cd[_0x2eb729(0x29c)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x2eb729(0x258)],'ack':![]});});}catch(_0x1c5f11){_0x3ab9cd[_0xbef3b3(0x329)][_0xbef3b3(0x196)](_0xbef3b3(0x1e5)+_0x1c5f11[_0xbef3b3(0x26b)]);}}function a0_0x5c23(){const _0x5039a6=['Pattern\x20Detected','city','Target\x20Value','admin.','button','vacation','native','length','startsWith','\x20=\x20','requirements.txt','analysis.history_debug_00','join','KALENDER:\x20Keine\x20Daten','detected','stdin','unshift','getForeignObjectAsync','Baseline\x20Status','openweathermap.0','notifyTelegramRecipient','system.isPresent','LTM.baselineStatus','main','door','notifyTelegramEnabled','analysisHistory','inactivityThresholdHours','getForeignObjectsAsync','unreach','notifyEmailEnabled','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','description','lowbat','_score','.forecast.current.state','\x20(Value:\x20','Adapter','_calName','useCalendar','pr√§senz','analysisInterval','values','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','version','Last\x20Result','json','pythonProcess','analysis.health','Auto\x20Apply\x20Rule','Comfort\x20Suggestion','bewegung','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','text.alarm','.data.table','date','time','temperature','analysis.comfortSummary','targetValue','Last\x20raw\x20event','stick_unreach','@google/generative-ai','Drift\x20Status','Party','info','PARTY','0\x204\x20*\x20*\x20*','write','actual_temperature','lastCheck','working','\x20events)...','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','ANALYZE_TREND','Started\x20at\x20','LTM.processingStatus','driftAnalysisTimer','Last\x20Check','TREND_RESULT','onUnload','PONG','occupancy','callback','catch','AI\x20Emergency\x20Status','weather','autoApply','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','log','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','unload','Restoring\x20sensor\x20cache\x20from\x20history\x20(','Logbook','Briefing\x20Error:\x20','child_process','analysis.isEmergency','enum.functions.*','system.presenceWho','motion','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','send','Failed\x20to\x20send\x20to\x20Python:\x20','stderr','\x0aSTB:\x20','Urlaub','N/A','sendToAsync','aiPersona','.\x20OUTPUT:\x20Nur\x20Text.','analysis.health.trendValue','29275VqGWKc','setForeignStateAsync','humidity','constructor','analysis.triggerBriefing','subscribeStates','getFullYear','minDaysForBaseline','val','kill','Generating\x20Morning\x20Briefing...','command','Gemini\x20Init\x20Error:\x20','config','analysis.automation.suggestedAction','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','analysis.isAlert','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','LTM.triggerDailyDigest','system','Entry\x20detected\x20via\x20','analysis.activitySummary','Bibliotheken\x20nicht\x20gefunden','dutycycle','indicator','search','setState','Kein\x20API\x20Key!','splice','Details:\x20','PRO-','\x20min).','Drift\x20Analysis','dependencyInstallInProgress','connection','stringify','No\x20module\x20named','apply','üìû\x20R√ºckruf\x20anfordern','Lernphase\x20(','getHours','fault','common','echarts.','shutter','stdout','python3','63590NpQvQK','scheduleJob','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','systemConfig','6288055JpTOmN','Health\x20Notes','includes','uuid','Missing\x20data','trim','submitFeedback','üêç\x20Starting\x20Python\x20Sidecar:\x20','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','presenceDevices','Skipped\x20(No\x20AI\x20or\x20Data)','N/A\x20(Learning)','modeResetJob','‚ö†Ô∏è\x20ALARM:\x20','error','Feedback\x20saved:\x20','isProVersion','activityLevel','setHours','lights','VACATION','Starting\x20Autopilot\x20(','indicator.alarm.fire','uuid-not-found','\x20events','.\x0a\x20\x20\x20\x20KONTEXT:\x20','scanDevices','toString','inactivityMonitoringEnabled','analysis.health.sleepScore','node-schedule','LTM.driftAnalysis.driftDetails','switch','Sleep\x20Score\x20(0-100)','scriptProblem','some','type','location','debug','Trend\x20Diagnosis\x20(Python)','genAI','briefingEnabled','analysisTimer','parse','.communicate.request','Activity-Level','Event\x20received:\x20','Keiner','generic','Gemini\x20AI\x20initialized.','.Summary.Current','.NextHours.Location_1.Day_1.current.symbol_desc','namespace','ltmStbWindowDays','Scheduling\x20Morning\x20Briefing\x20for\x20','text','analysis.automation.autoApply','boolean','map','analysis.automation.description','34476OTwAii','klima','analysis.automation.targetId','position','Exit\x20Sensor\x20triggered\x20(','Daily\x20Digests','replace','number','fenster','ical.0','KI-Modell\x20nicht\x20initialisiert','thermostat','üß™\x20Simulating\x20Butler\x20Proposal:\x20','5340296uzUtwG','Guardian:\x20Sending\x20','Aktiv\x20(','getCalendarNames\x20Error:\x20','data','livingContext','\x20hours.\x20Potential\x20incapacitation.','Normal','analysis.automation.targetValue','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','Error\x20in\x20onMessage\x20command\x20','notifyPushoverInstance','Success:\x20Compressed\x20','isExit','channel','response','custom','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','reachable','cover','Reset\x20Sched\x20Error:\x20','value','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','08:00','flot.','forEach','getCalendarNames','Error\x20launching\x20Python\x20service:\x20','üì°\x20Hooking\x20into\x20','close','Trigger\x20Briefing\x20(Test)','analysis.feedbackHistory','Alarm','briefingTime','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','0\x203\x20*\x20*\x20*','GUEST','isAlert','pop','KALENDER:\x20','vis.','Drift\x20Sched\x20Error:\x20','IGNORING\x20DUPLICATE\x20(Cached):\x20','üåÖ\x20Daily\x20Briefing:\x0a','Deviation','firmware','rssi','44lqWlNP','simple-api.',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','automationProposal','baselineDrift','[PYTHON]\x20','AI\x20Alert\x20Status','bind','...','testApiKey','Drift\x20Details','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','Cogni-Living','indicator.alarm','details','object','.\x20ZUSATZ:\x20','brightness','timestamp','delObjectAsync','setObjectNotExistsAsync','[LOG]','WETTER\x20ERROR:\x20','python_service','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','health','Deaktiviert\x20(Pro-Feature)','payload','[RESULT]','PRIORIT√ÑT:\x20Sicherheit.','LTM.dailyDigests','analysis.alertReason','weatherInstance','devices','analysis.automation','‚úÖ\x20Alles\x20OK\x20(Reset)','Processing\x20Status','slice','\x20|\x20','level','schalter','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','selectedFunctionIds','ltmJob','exports','LTM.rawEventLog','Sending\x20notification:\x20\x22','üö®\x20EMERGENCY','TEST-PRO-KEY','normal','Fokus\x20auf\x20Familienroutinen.','.\x20KONTEXT:\x20','rawEventLog','onReady','lastAlertState','analysis.health.restlessness','accuweather.0','Alert\x20Reason','exitGraceTimer','notifyPushoverRecipient','exitTimer','maintenance','sensorLastValues','energy','Gemini\x20Analysis\x20Error:\x20','targetId','eventHistory','.\x20Welcome\x20home.','getForeignStateAsync','PRIORIT√ÑT:\x20Gesundheit/AAL.','expire','alertReason','find','Invalid\x20JSON\x20from\x20Python:\x20','temp','analysis.trigger','Kalender:\x20Deaktiviert','isPresent','sound','path','\x22\x20--break-system-packages','549ZIAzMG','Error:\x20','warn','Restlessness\x20Level','application/json','Briefing\x20Sched\x20Error:\x20','NORMAL','currentSystemMode','geminiApiKey','filter','automation.triggerAction','endsWith','simulateButler','LTM.driftAnalysis','rollladen','system.mode','236DXFqse','analysis.health.notes','online','retry','System\x20Mode','\x20*\x20*\x20*','indexOf','analysis.health.trendDiagnosis','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','message','Raw\x20Log','power','Action','icons-mfd.','BUTLER\x20Execution\x20Error:\x20','siren','‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20','üêç\x20Guardian\x20Diagnosis\x20(','getStateAsync','KALENDER\x20ERROR:\x20','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','analysis.analysisHistory','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','generateContent','cogni-living','light','LTM.driftAnalysis.baselineDrift','state','status','guest','extendObjectAsync','COGNI_CONFIRM_OK','licenseKey','analysis.lastResult','summary','useWeather','enum.rooms.*','systemUUID','dailyDigests','Health\x20&\x20Sleep\x20Analysis','driftDetails','from','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','split','blind','analysis.automation.patternDetected','briefingJob','subscribeForeignStatesAsync','update','dimmer','isGracePeriodActive','party','System\x20Status\x20&\x20Control','[TEST]\x20','ready','toLowerCase','User\x20dismissed\x20automation\x20proposal.','getMonth','setStateAsync','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','toLocaleString','unknown','system.config','isEmergency','notifyPushoverEnabled','WETTER:\x20Keine\x20Daten\x20gefunden','triggerBriefing','getObjectAsync','now','Trigger\x20Action\x20Now','ack','4439603FJClQS','Comfort\x20Summary','@iobroker/adapter-core','fill','Activity\x20Summary','events.history','notifyTelegramInstance','accuweather','getDate','getTime','sendTo','enum','analysis.automation.triggerAction','cancel','(((.+)+)+)+$','geminiModel','uuid-error','onStateChange','6QQHWMV','push','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','substring','COGNI_REQUEST_CALL','role','calendarSelection','link_quality','latitude','telegram','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','sort','16297171dcGMZY','string','LTM','name','targetposition','[PYTHON\x20ERR]\x20','sensor','sleepScore','scriptEnabled'];a0_0x5c23=function(){return _0x5039a6;};return a0_0x5c23();}function setupDriftAnalysisScheduler(_0x19f8a9){const _0x3543e6=a0_0x5b2d07;try{if(_0x19f8a9[_0x3543e6(0x31d)])clearInterval(_0x19f8a9[_0x3543e6(0x31d)]);if(!_0x19f8a9['isProVersion'])return;_0x19f8a9['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x19f8a9),(_0x19f8a9[_0x3543e6(0x34d)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x19f8a9),0x1388);}catch(_0x396b8e){_0x19f8a9[_0x3543e6(0x329)][_0x3543e6(0x196)](_0x3543e6(0x1fa)+_0x396b8e[_0x3543e6(0x26b)]);}}function setupBriefingScheduler(_0x4e7c7d){const _0x38c1ac=a0_0x5b2d07;try{if(_0x4e7c7d[_0x38c1ac(0x290)])_0x4e7c7d[_0x38c1ac(0x290)][_0x38c1ac(0x2b6)]();if(!_0x4e7c7d['config'][_0x38c1ac(0x1b1)])return;const _0x4af7f8=(_0x4e7c7d[_0x38c1ac(0x34d)][_0x38c1ac(0x1f2)]||_0x38c1ac(0x1e8))[_0x38c1ac(0x28d)](':'),_0x57ecbf=parseInt(_0x4af7f8[0x0])||0x8,_0x4d37f2=parseInt(_0x4af7f8[0x1])||0x0,_0x29fbd4=_0x4d37f2+'\x20'+_0x57ecbf+_0x38c1ac(0x267);_0x4e7c7d[_0x38c1ac(0x329)][_0x38c1ac(0x311)](_0x38c1ac(0x1be)+_0x57ecbf+':'+(_0x4d37f2<0xa?'0'+_0x4d37f2:_0x4d37f2)),_0x4e7c7d[_0x38c1ac(0x290)]=schedule[_0x38c1ac(0x185)](_0x29fbd4,()=>{sendMorningBriefing(_0x4e7c7d);});}catch(_0x127fbf){_0x4e7c7d[_0x38c1ac(0x329)][_0x38c1ac(0x196)](_0x38c1ac(0x257)+_0x127fbf[_0x38c1ac(0x26b)]);}}async function sendNotification(_0x4f7702,_0x490c2b,_0x5afa8d=![],_0x333343=![]){const _0x25efd4=a0_0x5b2d07;_0x4f7702[_0x25efd4(0x329)][_0x25efd4(0x311)]((_0x5afa8d?_0x25efd4(0x297):'')+_0x25efd4(0x22f)+_0x490c2b+'\x22');const _0x3e5fc8=_0x4f7702[_0x25efd4(0x34d)];let _0x19d9c2=0x0;if(_0x3e5fc8[_0x25efd4(0x2e9)]){let _0x53d447={};(_0x490c2b[_0x25efd4(0x18a)](_0x25efd4(0x1f1))||_0x333343)&&(_0x53d447={'reply_markup':{'inline_keyboard':[[{'text':_0x25efd4(0x224),'callback_data':_0x25efd4(0x281)}],[{'text':_0x25efd4(0x17b),'callback_data':_0x25efd4(0x2bf)}]]}}),await _0x4f7702[_0x25efd4(0x33c)](_0x3e5fc8[_0x25efd4(0x2af)],_0x25efd4(0x336),{'text':_0x490c2b,'user':_0x3e5fc8[_0x25efd4(0x2e4)],..._0x53d447}),_0x19d9c2++;}if(_0x3e5fc8[_0x25efd4(0x2a2)]){let _0x4acdfb={'message':_0x490c2b,'title':_0x333343?_0x25efd4(0x230):_0x25efd4(0x20d),'priority':_0x333343?0x2:0x1,'device':_0x3e5fc8[_0x25efd4(0x23c)]};_0x333343&&(_0x4acdfb[_0x25efd4(0x265)]=0x1e,_0x4acdfb[_0x25efd4(0x247)]=0xe10,_0x4acdfb[_0x25efd4(0x24f)]=_0x25efd4(0x271)),await _0x4f7702[_0x25efd4(0x33c)](_0x3e5fc8[_0x25efd4(0x1dc)],_0x25efd4(0x336),_0x4acdfb),_0x19d9c2++;}return _0x3e5fc8[_0x25efd4(0x2ee)]&&(await _0x4f7702[_0x25efd4(0x33c)](_0x3e5fc8['notifyEmailInstance'],_0x25efd4(0x336),{'text':_0x490c2b,'to':_0x3e5fc8['notifyEmailRecipient']}),_0x19d9c2++),_0x19d9c2;}async function setupTelegramListener(_0x4d2b17){const _0x4868d6=a0_0x5b2d07,_0x1f4206=_0x4d2b17[_0x4868d6(0x34d)]['notifyTelegramInstance'];_0x4d2b17['config'][_0x4868d6(0x2e9)]&&_0x1f4206&&(_0x4d2b17[_0x4868d6(0x329)][_0x4868d6(0x311)](_0x4868d6(0x1ed)+_0x1f4206+'\x20for\x20interactive\x20buttons...'),await _0x4d2b17[_0x4868d6(0x291)](_0x1f4206+_0x4868d6(0x1b4)));}async function handleTelegramResponse(_0x19e285,_0x321fbc){const _0x2689c5=a0_0x5b2d07;let _0x3cbe08=_0x321fbc;_0x321fbc['startsWith']('[')&&(_0x3cbe08=_0x321fbc['substring'](_0x321fbc[_0x2689c5(0x268)](']')+0x1));if(_0x3cbe08===_0x2689c5(0x281))_0x19e285[_0x2689c5(0x329)][_0x2689c5(0x311)](_0x2689c5(0x304)),await _0x19e285['setStateAsync'](_0x2689c5(0x350),{'val':![],'ack':!![]}),await _0x19e285[_0x2689c5(0x29c)](_0x2689c5(0x220),{'val':'Vom\x20Benutzer\x20best√§tigt\x20(OK).','ack':!![]}),_0x19e285['lastAlertState']=![],sendNotification(_0x19e285,_0x2689c5(0x20b),![]);else _0x3cbe08===_0x2689c5(0x2bf)&&(_0x19e285[_0x2689c5(0x329)][_0x2689c5(0x254)](_0x2689c5(0x26a)),sendNotification(_0x19e285,'üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.',![],!![]));}async function runAutopilot(_0x1ddbc2){const _0x257cad=a0_0x5b2d07,_0x46759e=_0x1ddbc2[_0x257cad(0x34d)]['inactivityThresholdHours'],_0x3fd51=_0x1ddbc2['eventHistory'][_0x257cad(0x2d7)]>0x0?_0x1ddbc2[_0x257cad(0x243)][0x0][_0x257cad(0x213)]:Date[_0x257cad(0x2a6)](),_0x14b81f=(Date[_0x257cad(0x2a6)]()-_0x3fd51)/(0x3e8*0x3c*0x3c);let _0x419c30='';_0x1ddbc2[_0x257cad(0x34d)][_0x257cad(0x1a4)]&&_0x1ddbc2[_0x257cad(0x259)]===SYSTEM_MODES[_0x257cad(0x258)]&&_0x1ddbc2[_0x257cad(0x24e)]&&(_0x14b81f>_0x46759e&&(_0x419c30=_0x257cad(0x334)+_0x14b81f['toFixed'](0x1)+_0x257cad(0x1d7))),runGeminiAnalysis(_0x1ddbc2,_0x419c30)[_0x257cad(0x324)](_0x488eb0=>_0x1ddbc2[_0x257cad(0x329)]['error'](_0x488eb0));}async function createDailyDigest(_0x546451){const _0x59dddc=a0_0x5b2d07;if(!_0x546451[_0x59dddc(0x198)])return;await _0x546451[_0x59dddc(0x29c)](LTM_DP_STATUS,{'val':_0x59dddc(0x31b)+new Date()[_0x59dddc(0x29e)](),'ack':!![]});if(!_0x546451[_0x59dddc(0x2b8)]||_0x546451[_0x59dddc(0x235)][_0x59dddc(0x2d7)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x546451['setStateAsync'](LTM_DP_STATUS,{'val':_0x59dddc(0x192),'ack':!![]});return;}const _0x2fa69f=JSON[_0x59dddc(0x1b3)](JSON['stringify'](_0x546451['rawEventLog'])),_0x57749e=_0x2fa69f[_0x59dddc(0x2d7)],_0xb63d00=_0x59dddc(0x34f)+JSON[_0x59dddc(0x178)](_0x2fa69f);try{const _0x177505=await _0x546451[_0x59dddc(0x2b8)][_0x59dddc(0x279)](_0xb63d00),_0x5ba83d=JSON['parse'](_0x177505[_0x59dddc(0x1e0)]['text']()[_0x59dddc(0x1ca)](/```json|```/g,'')['trim']());_0x5ba83d[_0x59dddc(0x284)]&&(_0x546451[_0x59dddc(0x288)][_0x59dddc(0x2bc)]({'timestamp':new Date()['toISOString'](),'eventCount':_0x57749e,'summary':_0x5ba83d[_0x59dddc(0x284)],'activityLevel':_0x5ba83d[_0x59dddc(0x199)],'systemMode':_0x546451['currentSystemMode']}),await saveDailyDigests(_0x546451),_0x546451[_0x59dddc(0x235)]=[],await saveRawEventLog(_0x546451),await _0x546451[_0x59dddc(0x29c)](LTM_DP_STATUS,{'val':_0x59dddc(0x1dd)+_0x57749e+_0x59dddc(0x1a0),'ack':!![]}),runPythonHealthCheck(_0x546451));}catch(_0x3f2931){await _0x546451[_0x59dddc(0x29c)](LTM_DP_STATUS,{'val':_0x59dddc(0x253)+_0x3f2931[_0x59dddc(0x26b)],'ack':!![]});}}async function sendMorningBriefing(_0x4904fe){const _0x24925c=a0_0x5b2d07;if(!_0x4904fe[_0x24925c(0x2b8)])return;_0x4904fe[_0x24925c(0x329)][_0x24925c(0x311)](_0x24925c(0x34a));const _0x3388a4=_0x4904fe[_0x24925c(0x288)][_0x24925c(0x2d7)]>0x0?_0x4904fe[_0x24925c(0x288)][_0x4904fe[_0x24925c(0x288)][_0x24925c(0x2d7)]-0x1]:null,_0x47ac83=_0x3388a4&&_0x3388a4[_0x24925c(0x21a)]?_0x3388a4[_0x24925c(0x21a)][_0x24925c(0x2ce)]:_0x24925c(0x33b),_0x58a376=new Date();_0x58a376[_0x24925c(0x19a)](0x4,0x0,0x0,0x0);const _0x447735=_0x4904fe['eventHistory'][_0x24925c(0x25b)](_0x3b79d0=>new Date(_0x3b79d0[_0x24925c(0x213)])>_0x58a376),_0x3f0b75=PERSONA_MAPPING[_0x4904fe['config'][_0x24925c(0x33d)]||_0x24925c(0x1b8)],_0x4a3e0f=_0x4904fe[_0x24925c(0x34d)][_0x24925c(0x1d6)]||'',_0x23dc26=await getWeatherContext(_0x4904fe),_0x4aa339=await getCalendarContext(_0x4904fe),_0x52a9fa=_0x24925c(0x276)+_0x3f0b75+_0x24925c(0x234)+_0x4a3e0f+_0x24925c(0x211)+_0x23dc26+'\x20'+_0x4aa339+'.\x20DATEN:\x20Schlaf\x20'+_0x47ac83+_0x24925c(0x186)+JSON[_0x24925c(0x178)](_0x447735[_0x24925c(0x226)](0x0,0xa))+_0x24925c(0x33e);try{const _0x11fa0b=await _0x4904fe[_0x24925c(0x2b8)][_0x24925c(0x279)](_0x52a9fa),_0x27c191=_0x24925c(0x1fc)+_0x11fa0b[_0x24925c(0x1e0)][_0x24925c(0x1bf)]()[_0x24925c(0x18d)]();sendNotification(_0x4904fe,_0x27c191),_0x4904fe[_0x24925c(0x329)][_0x24925c(0x311)]('Morning\x20Briefing\x20sent.');}catch(_0x33e114){_0x4904fe[_0x24925c(0x329)][_0x24925c(0x196)](_0x24925c(0x32e)+_0x33e114[_0x24925c(0x26b)]);}}function a0_0x2816(_0x29af03,_0x56cae1){const _0x11fb25=a0_0x5c23();return a0_0x2816=function(_0x3c711e,_0x5ac6d8){_0x3c711e=_0x3c711e-0x16c;let _0x5c237c=_0x11fb25[_0x3c711e];return _0x5c237c;},a0_0x2816(_0x29af03,_0x56cae1);}async function scanForDevices(_0x14e0ee,_0x5dbf60){const _0x109973=a0_0x5b2d07;_0x14e0ee[_0x109973(0x329)][_0x109973(0x311)](_0x109973(0x28c));const _0x296fbb=[],_0x17c1ca=await _0x14e0ee[_0x109973(0x2ec)]('*'),_0x4c65e5=await _0x14e0ee['getForeignObjectsAsync']('enum.functions.*',_0x109973(0x2b4)),_0x41a6c5=await _0x14e0ee[_0x109973(0x2ec)](_0x109973(0x286),_0x109973(0x2b4)),_0x2bf70c={};if(_0x4c65e5)for(const _0x4c978f in _0x4c65e5){const _0x238939=_0x4c65e5[_0x4c978f][_0x109973(0x17f)]['members']||[];_0x238939[_0x109973(0x1ea)](_0x320c6a=>{const _0x122209=_0x109973;if(!_0x2bf70c[_0x320c6a])_0x2bf70c[_0x320c6a]=[];_0x2bf70c[_0x320c6a][_0x122209(0x2bc)](_0x4c978f);});}const _0x275e6e={};if(_0x41a6c5)for(const _0xf2ba7f in _0x41a6c5){const _0x5ade27=_0x41a6c5[_0xf2ba7f]['common']['members']||[],_0x592827=typeof _0x41a6c5[_0xf2ba7f]['common'][_0x109973(0x2ca)]===_0x109973(0x210)?_0x41a6c5[_0xf2ba7f]['common']['name']['de']:_0x41a6c5[_0xf2ba7f][_0x109973(0x17f)][_0x109973(0x2ca)];_0x5ade27[_0x109973(0x1ea)](_0x14c50d=>_0x275e6e[_0x14c50d]=_0x592827);}const _0x1aab7f=_0x5dbf60[_0x109973(0x22b)]||[],_0x500208=_0x5dbf60['motion']!==![],_0x511eac=_0x5dbf60['doors']!==![],_0x265c6e=_0x5dbf60[_0x109973(0x19b)]!==![],_0x14a9f0=_0x5dbf60[_0x109973(0x309)]===!![],_0x27608d=_0x5dbf60[_0x109973(0x326)]===!![];for(const _0x58af56 in _0x17c1ca){const _0x518fbf=_0x17c1ca[_0x58af56];if(_0x518fbf['type']!==_0x109973(0x27d)||!_0x518fbf[_0x109973(0x17f)])continue;if(ADAPTER_BLACKLIST[_0x109973(0x1ab)](_0x1198e6=>_0x58af56[_0x109973(0x2d8)](_0x1198e6))&&!_0x27608d)continue;const _0x590c38=(_0x518fbf[_0x109973(0x17f)][_0x109973(0x2c0)]||'')[_0x109973(0x299)]();let _0x4a98fa=(typeof _0x518fbf['common'][_0x109973(0x2ca)]===_0x109973(0x210)?_0x518fbf[_0x109973(0x17f)][_0x109973(0x2ca)]['de']:_0x518fbf[_0x109973(0x17f)][_0x109973(0x2ca)])||_0x58af56;const _0x46a7a8=_0x4a98fa[_0x109973(0x299)]();let _0xb8aae5=![],_0x410de3=![];if(_0x1aab7f[_0x109973(0x2d7)]>0x0){const _0x351428=_0x2bf70c[_0x58af56]||[],_0x1e9d0d=_0x58af56[_0x109973(0x28d)]('.')['slice'](0x0,-0x1)[_0x109973(0x2dc)]('.'),_0x4f6d54=_0x2bf70c[_0x1e9d0d]||[];(_0x351428[_0x109973(0x1ab)](_0x5c15d6=>_0x1aab7f[_0x109973(0x18a)](_0x5c15d6))||_0x4f6d54['some'](_0x119309=>_0x1aab7f[_0x109973(0x18a)](_0x119309)))&&(_0xb8aae5=!![],_0x410de3=!![]);}if(!_0xb8aae5&&!_0x27608d){if(HARD_IGNORE_TERMS[_0x109973(0x1ab)](_0x40e156=>_0x58af56[_0x109973(0x18a)](_0x40e156)||_0x46a7a8[_0x109973(0x18a)](_0x40e156['toLowerCase']())))continue;}if(BAD_NAMES[_0x109973(0x1ab)](_0x185829=>_0x46a7a8===_0x185829||_0x46a7a8[_0x109973(0x25d)]('.'+_0x185829))){const _0x5df3e8=_0x58af56[_0x109973(0x28d)]('.');if(_0x5df3e8['length']>0x2){const _0xfbae8b=_0x5df3e8['slice'](0x0,-0x1)[_0x109973(0x2dc)]('.'),_0xcb73b5=_0x17c1ca[_0xfbae8b];if(_0xcb73b5&&_0xcb73b5[_0x109973(0x17f)]&&_0xcb73b5[_0x109973(0x17f)]['name']){const _0x109616=typeof _0xcb73b5[_0x109973(0x17f)]['name']===_0x109973(0x210)?_0xcb73b5['common']['name']['de']:_0xcb73b5[_0x109973(0x17f)][_0x109973(0x2ca)];_0x109616&&!_0x4a98fa[_0x109973(0x18a)](_0x109616)&&(_0x4a98fa=_0x109616+'\x20'+_0x4a98fa);}}}let _0x139684='';if(_0x500208&&(_0x590c38[_0x109973(0x18a)]('motion')||_0x590c38[_0x109973(0x18a)](_0x109973(0x322))||_0x46a7a8[_0x109973(0x18a)](_0x109973(0x303))||_0x46a7a8[_0x109973(0x18a)](_0x109973(0x2f8))))_0x139684=_0x109973(0x333);else{if(!_0x139684&&_0x511eac&&(_0x590c38[_0x109973(0x18a)](_0x109973(0x2e8))||_0x590c38[_0x109973(0x18a)]('window')||_0x590c38[_0x109973(0x18a)]('lock')||_0x590c38[_0x109973(0x18a)](_0x109973(0x28e))||_0x590c38[_0x109973(0x18a)](_0x109973(0x181))||_0x46a7a8[_0x109973(0x18a)](_0x109973(0x1cc))||_0x46a7a8['includes']('t√ºr')||_0x46a7a8['includes'](_0x109973(0x260))))_0x139684=_0x109973(0x2e8);else{if(!_0x139684&&_0x265c6e&&(_0x590c38[_0x109973(0x18a)](_0x109973(0x27b))||_0x590c38[_0x109973(0x18a)](_0x109973(0x1a8))||_0x590c38['includes'](_0x109973(0x293))||_0x46a7a8[_0x109973(0x18a)]('licht')||_0x46a7a8[_0x109973(0x18a)]('lampe')||_0x46a7a8[_0x109973(0x18a)](_0x109973(0x229)))){if(_0x518fbf[_0x109973(0x17f)][_0x109973(0x314)]||_0x590c38[_0x109973(0x18a)](_0x109973(0x2cd)))_0x139684=_0x109973(0x27b);}else{if(!_0x139684&&_0x14a9f0&&(_0x590c38[_0x109973(0x18a)]('temperature')||_0x590c38[_0x109973(0x18a)](_0x109973(0x342))||_0x590c38[_0x109973(0x18a)](_0x109973(0x1cf))||_0x46a7a8[_0x109973(0x18a)](_0x109973(0x24b))||_0x46a7a8[_0x109973(0x18a)](_0x109973(0x1c5))||_0x46a7a8[_0x109973(0x18a)]('heizung')))_0x139684=_0x109973(0x309);else{if(!_0x139684&&_0x410de3)_0x139684=_0x109973(0x1e1);}}}}if(_0x139684){let _0x117056=_0x275e6e[_0x58af56]||'';if(!_0x117056){let _0x2e2e23=_0x58af56;for(let _0x1f2b15=0x0;_0x1f2b15<0x3;_0x1f2b15++){const _0x2ca121=_0x2e2e23['lastIndexOf']('.');if(_0x2ca121===-0x1)break;_0x2e2e23=_0x2e2e23[_0x109973(0x2be)](0x0,_0x2ca121);if(_0x275e6e[_0x2e2e23]){_0x117056=_0x275e6e[_0x2e2e23];break;}}}_0x296fbb[_0x109973(0x2bc)]({'id':_0x58af56,'name':_0x4a98fa,'location':_0x117056,'type':_0x139684,'logDuplicates':_0x139684==='motion','isExit':![],'_score':_0x117056?0x50:_0x139684==='custom'?0x5a:0x28});}}return _0x296fbb['sort']((_0x248e62,_0x56e891)=>_0x56e891[_0x109973(0x2f2)]-_0x248e62[_0x109973(0x2f2)]),_0x296fbb;}async function executeAutomationAction(_0x307752){const _0x5c7f08=a0_0x5b2d07;try{const _0x34f53f=await _0x307752['getStateAsync']('analysis.automation.targetId'),_0x21b376=await _0x307752[_0x5c7f08(0x274)](_0x5c7f08(0x1d9));if(_0x34f53f&&_0x34f53f[_0x5c7f08(0x348)]&&_0x21b376){const _0x3eac23=_0x34f53f[_0x5c7f08(0x348)];let _0x1bcdd0=_0x21b376['val'];try{_0x1bcdd0=JSON[_0x5c7f08(0x1b3)](_0x1bcdd0);}catch(_0x884934){}_0x307752[_0x5c7f08(0x329)][_0x5c7f08(0x311)](_0x5c7f08(0x1da)+_0x3eac23+_0x5c7f08(0x2d9)+_0x1bcdd0),await _0x307752[_0x5c7f08(0x341)](_0x3eac23,_0x1bcdd0);}else _0x307752[_0x5c7f08(0x329)]['warn'](_0x5c7f08(0x278));}catch(_0x27e9df){_0x307752[_0x5c7f08(0x329)]['error'](_0x5c7f08(0x270)+_0x27e9df['message']);}}function tryParse(_0x5c1b41){const _0x1289fb=a0_0x5b2d07;try{return JSON[_0x1289fb(0x1b3)](_0x5c1b41);}catch(_0x39ede3){return null;}}async function processSensorEvent(_0x26f2cd,_0x38e2d6,_0x1e4433,_0xaf5de){const _0x126f96=a0_0x5b2d07;if(!_0xaf5de)return;const _0x200788=_0x1e4433[_0x126f96(0x348)],_0x2e3d9a=Date[_0x126f96(0x2a6)]();_0x26f2cd[_0x126f96(0x329)][_0x126f96(0x1ae)](_0x126f96(0x1b6)+_0x38e2d6+_0x126f96(0x2d9)+_0x200788);const _0x1944d7=_0x26f2cd[_0x126f96(0x23f)][_0x38e2d6];_0x26f2cd[_0x126f96(0x23f)][_0x38e2d6]=_0x200788;if(!_0xaf5de['logDuplicates']&&_0x1944d7!=undefined&&_0x1944d7==_0x200788){_0x26f2cd[_0x126f96(0x329)][_0x126f96(0x1ae)](_0x126f96(0x1fb)+_0xaf5de['name']+_0x126f96(0x2f4)+_0x200788+')');return;}const _0x329e45={'timestamp':_0x2e3d9a,'id':_0x38e2d6,'name':_0xaf5de[_0x126f96(0x2ca)],'type':_0xaf5de[_0x126f96(0x1ac)],'location':_0xaf5de[_0x126f96(0x1ad)],'value':_0x200788};_0x26f2cd['eventHistory'][_0x126f96(0x2e0)](_0x329e45);if(_0x26f2cd[_0x126f96(0x243)][_0x126f96(0x2d7)]>HISTORY_MAX_SIZE)_0x26f2cd['eventHistory'][_0x126f96(0x1f7)]();await _0x26f2cd[_0x126f96(0x29c)]('events.lastEvent',{'val':JSON[_0x126f96(0x178)](_0x329e45),'ack':!![]}),await _0x26f2cd[_0x126f96(0x29c)]('events.history',{'val':JSON[_0x126f96(0x178)](_0x26f2cd[_0x126f96(0x243)]),'ack':!![]});_0x26f2cd[_0x126f96(0x198)]&&(_0x26f2cd[_0x126f96(0x235)][_0x126f96(0x2bc)](_0x329e45),await saveRawEventLog(_0x26f2cd));if(_0xaf5de[_0x126f96(0x1de)]&&_0x200788===!![]){if(_0x26f2cd[_0x126f96(0x24e)]&&!_0x26f2cd[_0x126f96(0x294)])_0x26f2cd[_0x126f96(0x329)][_0x126f96(0x311)](_0x126f96(0x1c8)+_0xaf5de['name']+').\x20Starting\x20Timer.'),startExitTimer(_0x26f2cd);else!_0x26f2cd[_0x126f96(0x24e)]&&(_0x26f2cd['log']['info'](_0x126f96(0x354)+_0xaf5de['name']+_0x126f96(0x244)),await setPresence(_0x26f2cd,!![]));}else _0xaf5de['type']===_0x126f96(0x333)&&_0x200788===!![]&&(_0x26f2cd[_0x126f96(0x23d)]&&(_0x26f2cd[_0x126f96(0x329)][_0x126f96(0x311)](_0x126f96(0x22a)),abortExitTimer(_0x26f2cd)),!_0x26f2cd[_0x126f96(0x24e)]&&_0x26f2cd[_0x126f96(0x259)]===SYSTEM_MODES[_0x126f96(0x258)]&&await setPresence(_0x26f2cd,!![]));}async function runGeminiAnalysis(_0x5126c4,_0x4a2f24=''){const _0xe96998=a0_0x5b2d07;if(!_0x5126c4[_0xe96998(0x2b8)])return;if(_0x5126c4['eventHistory'][_0xe96998(0x2d7)]===0x0)return;const _0x2b397a=_0x5126c4[_0xe96998(0x243)]['slice'](0x0,0xf),_0x2ac556=await getWeatherContext(_0x5126c4),_0x300c4b=_0x5126c4[_0xe96998(0x259)],_0x537cc9=PERSONA_MAPPING[_0x5126c4[_0xe96998(0x34d)][_0xe96998(0x33d)]||_0xe96998(0x1b8)],_0x5c8cd3=_0x5126c4['config'][_0xe96998(0x1d6)]||'Keine\x20Details.';let _0xac5cb3=![];try{const _0x41e4ed=await _0x5126c4[_0xe96998(0x274)](_0xe96998(0x1c0));if(_0x41e4ed&&_0x41e4ed[_0xe96998(0x348)])_0xac5cb3=!![];}catch(_0x29885f){}const _0x3a123d=_0xe96998(0x2ef)+_0x537cc9+_0xe96998(0x1a1)+_0x5c8cd3+_0xe96998(0x2c5)+_0x300c4b+'.\x0a\x20\x20\x20\x20WETTER:\x20'+_0x2ac556+_0xe96998(0x351)+(_0x4a2f24||_0xe96998(0x1b7))+_0xe96998(0x1f3)+JSON[_0xe96998(0x178)](_0x2b397a)+_0xe96998(0x219);try{const _0x2868ed=await _0x5126c4[_0xe96998(0x2b8)][_0xe96998(0x279)](_0x3a123d),_0x2f9e24=_0x2868ed[_0xe96998(0x1e0)][_0xe96998(0x1bf)]()[_0xe96998(0x1ca)](/```json|```/g,'')[_0xe96998(0x18d)](),_0x491861=JSON[_0xe96998(0x1b3)](_0x2f9e24);await _0x5126c4['setStateAsync'](_0xe96998(0x283),{'val':JSON[_0xe96998(0x178)](_0x491861),'ack':!![]});const _0x240e2a=_0x491861[_0xe96998(0x1f6)]||![];_0x240e2a!==_0x5126c4[_0xe96998(0x237)]&&(await _0x5126c4[_0xe96998(0x29c)]('analysis.isAlert',{'val':_0x240e2a,'ack':!![]}),_0x5126c4[_0xe96998(0x237)]=_0x240e2a,_0x240e2a&&(await _0x5126c4['setStateAsync'](_0xe96998(0x220),{'val':_0x491861[_0xe96998(0x248)],'ack':!![]}),sendNotification(_0x5126c4,_0xe96998(0x195)+_0x491861[_0xe96998(0x248)],![],_0x491861[_0xe96998(0x2a1)]))),_0x491861['automationProposal']&&_0x491861[_0xe96998(0x203)]['detected']&&_0x491861[_0xe96998(0x203)][_0xe96998(0x242)]&&(_0x5126c4['log'][_0xe96998(0x311)](_0xe96998(0x1e7)+_0x491861[_0xe96998(0x203)][_0xe96998(0x2f0)]),await _0x5126c4[_0xe96998(0x29c)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x5126c4[_0xe96998(0x29c)](_0xe96998(0x1c3),{'val':_0x491861[_0xe96998(0x203)][_0xe96998(0x2f0)],'ack':!![]}),await _0x5126c4[_0xe96998(0x29c)](_0xe96998(0x1c6),{'val':_0x491861[_0xe96998(0x203)][_0xe96998(0x242)],'ack':!![]}),await _0x5126c4[_0xe96998(0x29c)](_0xe96998(0x1d9),{'val':JSON[_0xe96998(0x178)](_0x491861[_0xe96998(0x203)]['targetValue']),'ack':!![]}),_0xac5cb3&&(_0x5126c4['log']['info'](_0xe96998(0x1e2)+_0x491861[_0xe96998(0x203)][_0xe96998(0x242)]+_0xe96998(0x208)),await executeAutomationAction(_0x5126c4)));}catch(_0x1a977a){_0x5126c4[_0xe96998(0x329)][_0xe96998(0x196)](_0xe96998(0x241)+_0x1a977a[_0xe96998(0x26b)]);}}function installPythonDependencies(_0x225efc){const _0x4e4d65=a0_0x5b2d07;if(_0x225efc[_0x4e4d65(0x176)])return;_0x225efc['dependencyInstallInProgress']=!![];const _0x4b0c06=path['join'](__dirname,_0x4e4d65(0x218),_0x4e4d65(0x2da));_0x225efc[_0x4e4d65(0x329)][_0x4e4d65(0x311)](_0x4e4d65(0x29d)+_0x4b0c06+'...'),stopPythonService(_0x225efc);const _0x4ac80f='python3\x20-m\x20pip\x20install\x20-r\x20\x22'+_0x4b0c06+_0x4e4d65(0x251);exec(_0x4ac80f,(_0x3c1281,_0x197d37,_0x1bc49a)=>{const _0xb6450a=_0x4e4d65;_0x225efc[_0xb6450a(0x176)]=![],_0x3c1281?(_0x225efc['log'][_0xb6450a(0x196)](_0xb6450a(0x272)+_0x4ac80f),_0x225efc[_0xb6450a(0x329)][_0xb6450a(0x196)](_0xb6450a(0x172)+(_0x1bc49a||_0x3c1281[_0xb6450a(0x26b)]))):(_0x225efc['log'][_0xb6450a(0x311)](_0xb6450a(0x2fb)),startPythonService(_0x225efc));});}function sendToPython(_0x230041,_0x2e9d0b,_0x283918={}){const _0x3f9995=a0_0x5b2d07;if(!_0x230041[_0x3f9995(0x2ff)]||!_0x230041[_0x3f9995(0x2ff)][_0x3f9995(0x2df)]['writable'])return;const _0x47430a=JSON['stringify']({'command':_0x2e9d0b,..._0x283918});try{_0x230041[_0x3f9995(0x2ff)][_0x3f9995(0x2df)][_0x3f9995(0x314)](_0x47430a+'\x0a');}catch(_0x322b0b){_0x230041[_0x3f9995(0x329)][_0x3f9995(0x196)](_0x3f9995(0x337)+_0x322b0b[_0x3f9995(0x26b)]);}}function runPythonHealthCheck(_0x17dffe){const _0x2ce01c=a0_0x5b2d07;if(!_0x17dffe[_0x2ce01c(0x288)]||_0x17dffe[_0x2ce01c(0x288)][_0x2ce01c(0x2d7)]<0x2){_0x17dffe[_0x2ce01c(0x329)][_0x2ce01c(0x311)](_0x2ce01c(0x2bd));return;}const _0x4f39cc=_0x17dffe['dailyDigests'][_0x2ce01c(0x1c2)](_0x2e6f7a=>{const _0x3ad465=_0x2ce01c,_0x51a019=(_0x2e6f7a[_0x3ad465(0x199)]||'')[_0x3ad465(0x299)]();return ACTIVITY_LEVEL_MAP[_0x51a019]||0x32;});_0x17dffe[_0x2ce01c(0x329)][_0x2ce01c(0x311)](_0x2ce01c(0x1d2)+_0x4f39cc['length']+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x17dffe,_0x2ce01c(0x31a),{'values':_0x4f39cc,'tag':_0x2ce01c(0x1b5)});}function handlePythonResult(_0x35d94c,_0x224a20){const _0x4da399=a0_0x5b2d07;if(_0x224a20[_0x4da399(0x1ac)]===_0x4da399(0x321))_0x35d94c['log'][_0x4da399(0x1ae)](_0x4da399(0x335));else{if(_0x224a20[_0x4da399(0x1ac)]===_0x4da399(0x31f)){const {tag:_0x2d7f98,diagnosis:_0x10f73d,change_percent:_0x5d46f9}=_0x224a20[_0x4da399(0x21c)];_0x35d94c[_0x4da399(0x329)]['info'](_0x4da399(0x273)+_0x2d7f98+'):\x20'+_0x10f73d+'\x20('+_0x5d46f9+'%)'),_0x35d94c['setStateAsync'](_0x4da399(0x269),{'val':_0x10f73d,'ack':!![]}),_0x35d94c[_0x4da399(0x29c)]('analysis.health.trendValue',{'val':_0x5d46f9,'ack':!![]});}}}function startPythonService(_0x486aad){const _0x9eadeb=a0_0x5b2d07;try{const _0xaafce8=path[_0x9eadeb(0x2dc)](__dirname,_0x9eadeb(0x218),'service.py');_0x486aad[_0x9eadeb(0x329)][_0x9eadeb(0x311)](_0x9eadeb(0x18f)+_0xaafce8),_0x486aad[_0x9eadeb(0x2ff)]=spawn(_0x9eadeb(0x183),[_0xaafce8]),_0x486aad[_0x9eadeb(0x2ff)][_0x9eadeb(0x182)]['on'](_0x9eadeb(0x1d5),_0x4fe2ba=>{const _0x325fba=_0x9eadeb,_0x3667ed=_0x4fe2ba[_0x325fba(0x1a3)]()[_0x325fba(0x28d)]('\x0a');_0x3667ed[_0x325fba(0x1ea)](_0x13bd9f=>{const _0xe156b5=_0x325fba,_0x3c3115=_0x13bd9f[_0xe156b5(0x18d)]();if(!_0x3c3115)return;if(_0x3c3115[_0xe156b5(0x2d8)](_0xe156b5(0x216)))_0x486aad[_0xe156b5(0x329)][_0xe156b5(0x1ae)](_0xe156b5(0x205)+_0x3c3115['substring'](0x5)['trim']());else{if(_0x3c3115[_0xe156b5(0x2d8)](_0xe156b5(0x21d)))try{const _0x315517=JSON[_0xe156b5(0x1b3)](_0x3c3115[_0xe156b5(0x2be)](0x8)[_0xe156b5(0x18d)]());handlePythonResult(_0x486aad,_0x315517);}catch(_0x162005){_0x486aad[_0xe156b5(0x329)][_0xe156b5(0x254)](_0xe156b5(0x24a)+_0x3c3115);}}(_0x3c3115[_0xe156b5(0x18a)](_0xe156b5(0x179))||_0x3c3115[_0xe156b5(0x18a)](_0xe156b5(0x356)))&&(_0x486aad[_0xe156b5(0x329)][_0xe156b5(0x254)]('‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...'),installPythonDependencies(_0x486aad));});}),_0x486aad[_0x9eadeb(0x2ff)][_0x9eadeb(0x338)]['on'](_0x9eadeb(0x1d5),_0x500452=>{const _0x33e49a=_0x9eadeb,_0x4292a5=_0x500452[_0x33e49a(0x1a3)]()[_0x33e49a(0x18d)]();_0x486aad['log']['error'](_0x33e49a(0x2cc)+_0x4292a5);}),_0x486aad[_0x9eadeb(0x2ff)]['on'](_0x9eadeb(0x1ee),_0x29dd81=>{const _0x14cbb9=_0x9eadeb;_0x486aad[_0x14cbb9(0x329)]['info'](_0x14cbb9(0x20c)+_0x29dd81),_0x486aad[_0x14cbb9(0x2ff)]=null;}),_0x486aad[_0x9eadeb(0x2ff)]['on'](_0x9eadeb(0x196),_0x39efc0=>{const _0x3c1ec5=_0x9eadeb;_0x486aad[_0x3c1ec5(0x329)][_0x3c1ec5(0x254)](_0x3c1ec5(0x32a)+_0x39efc0[_0x3c1ec5(0x26b)]);});}catch(_0x149ab1){_0x486aad[_0x9eadeb(0x329)][_0x9eadeb(0x196)](_0x9eadeb(0x1ec)+_0x149ab1[_0x9eadeb(0x26b)]);}}function stopPythonService(_0x3fa7e0){const _0xe23806=a0_0x5b2d07;if(_0x3fa7e0[_0xe23806(0x2ff)]){_0x3fa7e0[_0xe23806(0x329)][_0xe23806(0x311)]('üêç\x20Stopping\x20Python\x20Sidecar...');try{_0x3fa7e0[_0xe23806(0x2ff)][_0xe23806(0x349)]();}catch(_0x5cf1dc){_0x3fa7e0[_0xe23806(0x329)][_0xe23806(0x254)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x5cf1dc[_0xe23806(0x26b)]);}_0x3fa7e0['pythonProcess']=null;}}class CogniLiving extends utils[a0_0x5b2d07(0x2f5)]{constructor(_0x3c660e){const _0x662fd7=a0_0x5b2d07;super({..._0x3c660e,'name':_0x662fd7(0x27a)}),this[_0x662fd7(0x243)]=[],this[_0x662fd7(0x2ea)]=[],this['feedbackHistory']=[],this[_0x662fd7(0x235)]=[],this[_0x662fd7(0x288)]=[],this[_0x662fd7(0x23f)]={},this[_0x662fd7(0x187)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x662fd7(0x23d)]=null,this[_0x662fd7(0x23b)]=null,this[_0x662fd7(0x294)]=![],this[_0x662fd7(0x1b0)]=null,this[_0x662fd7(0x2b8)]=null,this[_0x662fd7(0x259)]=SYSTEM_MODES[_0x662fd7(0x258)],this[_0x662fd7(0x198)]=![],this[_0x662fd7(0x237)]=![],this[_0x662fd7(0x287)]=_0x662fd7(0x29f),this['analysisTimer']=null,this[_0x662fd7(0x22c)]=null,this[_0x662fd7(0x194)]=null,this[_0x662fd7(0x31d)]=null,this['briefingJob']=null,this['pythonProcess']=null,this[_0x662fd7(0x176)]=![],this['on'](_0x662fd7(0x298),this[_0x662fd7(0x236)]['bind'](this)),this['on']('stateChange',this[_0x662fd7(0x2ba)]['bind'](this)),this['on'](_0x662fd7(0x32b),this['onUnload'][_0x662fd7(0x207)](this)),this['on'](_0x662fd7(0x26b),this['onMessage'][_0x662fd7(0x207)](this));}async['onReady'](){const _0x44fd84=a0_0x5b2d07;this[_0x44fd84(0x329)][_0x44fd84(0x311)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x44fd84(0x2fc)]+_0x44fd84(0x202)),await initZombies(this),this[_0x44fd84(0x34d)][_0x44fd84(0x282)]=this[_0x44fd84(0x34d)]['licenseKey']||'';try{this[_0x44fd84(0x198)]=await checkLicense(this,this[_0x44fd84(0x34d)]['licenseKey']);}catch(_0x3e4d0f){}if(!this['config'][_0x44fd84(0x2eb)]||this[_0x44fd84(0x34d)]['inactivityThresholdHours']<0.1)this[_0x44fd84(0x34d)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x44fd84(0x34d)][_0x44fd84(0x25a)])try{this[_0x44fd84(0x1b0)]=new GoogleGenerativeAI(this[_0x44fd84(0x34d)][_0x44fd84(0x25a)]),this[_0x44fd84(0x2b8)]=this[_0x44fd84(0x1b0)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x44fd84(0x256)}}),this[_0x44fd84(0x329)][_0x44fd84(0x311)](_0x44fd84(0x1b9));}catch(_0x5072e2){this[_0x44fd84(0x329)]['error'](_0x44fd84(0x34c)+_0x5072e2[_0x44fd84(0x26b)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x44fd84(0x345)](_0x44fd84(0x24c)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x44fd84(0x345)](_0x44fd84(0x261)),this[_0x44fd84(0x345)]('analysis.triggerBriefing'),this[_0x44fd84(0x345)](_0x44fd84(0x2b5)),this['subscribeStates']('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this['analysisTimer']);const _0x36ea16=this[_0x44fd84(0x34d)][_0x44fd84(0x2f9)]||0xf;_0x36ea16>0x0&&(this[_0x44fd84(0x329)]['info'](_0x44fd84(0x19d)+_0x36ea16+_0x44fd84(0x174)),this[_0x44fd84(0x1b2)]=setInterval(()=>{runAutopilot(this);},_0x36ea16*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x3195e5=_0x44fd84;this[_0x3195e5(0x2ff)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x5b2d07(0x320)](_0x46b4c0){const _0x94627b=a0_0x5b2d07;if(this[_0x94627b(0x1b2)])clearInterval(this[_0x94627b(0x1b2)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x94627b(0x31d)]);if(this[_0x94627b(0x22c)])this[_0x94627b(0x22c)]['cancel']();if(this['modeResetJob'])this[_0x94627b(0x194)][_0x94627b(0x2b6)]();if(this['briefingJob'])this[_0x94627b(0x290)][_0x94627b(0x2b6)]();if(this[_0x94627b(0x23d)])clearTimeout(this['exitTimer']);if(this[_0x94627b(0x23b)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x46b4c0();}async[a0_0x5b2d07(0x2ba)](_0x4780d3,_0x3a1b36){const _0x305158=a0_0x5b2d07;if(!_0x3a1b36)return;if(_0x4780d3[_0x305158(0x18a)](_0x305158(0x2c4))&&_0x4780d3[_0x305158(0x25d)]('communicate.request')&&_0x3a1b36[_0x305158(0x348)]){await handleTelegramResponse(this,_0x3a1b36[_0x305158(0x348)]);return;}if(_0x4780d3===this[_0x305158(0x1bc)]+'.'+SYSTEM_DP_MODE){_0x3a1b36['val']&&Object[_0x305158(0x2fa)](SYSTEM_MODES)[_0x305158(0x18a)](_0x3a1b36[_0x305158(0x348)])&&(this['currentSystemMode']=_0x3a1b36['val'],_0x3a1b36[_0x305158(0x348)]===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x3a1b36[_0x305158(0x2a8)])this[_0x305158(0x16f)](_0x4780d3,{'val':this[_0x305158(0x259)],'ack':!![]});return;}if(!_0x3a1b36[_0x305158(0x2a8)]){_0x4780d3[_0x305158(0x18a)](_0x305158(0x24c))&&_0x3a1b36[_0x305158(0x348)]&&(this['setState'](_0x4780d3,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x4780d3[_0x305158(0x18a)]('triggerDailyDigest')&&_0x3a1b36[_0x305158(0x348)]){this[_0x305158(0x16f)](_0x4780d3,{'val':![],'ack':!![]});if(this[_0x305158(0x198)])createDailyDigest(this);}_0x4780d3[_0x305158(0x18a)](_0x305158(0x2a4))&&_0x3a1b36['val']&&(this['setState'](_0x4780d3,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x4780d3[_0x305158(0x18a)](_0x305158(0x25c))&&_0x3a1b36[_0x305158(0x348)]&&(this['setState'](_0x4780d3,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x305158(0x34d)][_0x305158(0x191)]&&this[_0x305158(0x34d)][_0x305158(0x191)]['includes'](_0x4780d3)){await checkWifiPresence(this);return;}const _0x458c5a=(this[_0x305158(0x34d)][_0x305158(0x222)]||[])[_0x305158(0x249)](_0x3717a2=>_0x3717a2['id']===_0x4780d3);if(_0x458c5a)processSensorEvent(this,_0x4780d3,_0x3a1b36,_0x458c5a);}async['onMessage'](_0x3a2924){const _0x4afa3f=a0_0x5b2d07;if(typeof _0x3a2924==='object'&&_0x3a2924[_0x4afa3f(0x26b)])try{if(_0x3a2924[_0x4afa3f(0x34b)]===_0x4afa3f(0x209)){}else{if(_0x3a2924['command']==='testNotification'){}else{if(_0x3a2924[_0x4afa3f(0x34b)]==='getLtmData'){if(!this[_0x4afa3f(0x198)])return this[_0x4afa3f(0x2b3)](_0x3a2924[_0x4afa3f(0x28b)],_0x3a2924[_0x4afa3f(0x34b)],{'success':![],'isPro':![]},_0x3a2924['callback']);let _0x164c8b={'status':_0x4afa3f(0x33b),'details':'','lastCheck':0x0};try{_0x164c8b['status']=(await this[_0x4afa3f(0x274)](LTM_DP_DRIFT_STATUS))[_0x4afa3f(0x348)],_0x164c8b[_0x4afa3f(0x20f)]=(await this[_0x4afa3f(0x274)](LTM_DP_DRIFT_DETAILS))[_0x4afa3f(0x348)],_0x164c8b[_0x4afa3f(0x316)]=(await this[_0x4afa3f(0x274)](LTM_DP_DRIFT_LAST_CHECK))[_0x4afa3f(0x348)];}catch(_0x119d0a){}const _0x4743ff=this['analysisHistory']||[];this[_0x4afa3f(0x2b3)](_0x3a2924[_0x4afa3f(0x28b)],_0x3a2924[_0x4afa3f(0x34b)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x164c8b,'analysisHistory':_0x4743ff},_0x3a2924['callback']);}else{if(_0x3a2924[_0x4afa3f(0x34b)]==='getOverviewData'){const _0x521101=this[_0x4afa3f(0x288)][_0x4afa3f(0x2d7)],_0x205d5f=new Date(),_0x59fdcb=new Date(_0x205d5f[_0x4afa3f(0x346)](),_0x205d5f[_0x4afa3f(0x29b)](),_0x205d5f[_0x4afa3f(0x2b1)]())['getTime'](),_0x51d191=this['rawEventLog'][_0x4afa3f(0x25b)](_0x300419=>new Date(_0x300419[_0x4afa3f(0x213)])[_0x4afa3f(0x2b2)]()>_0x59fdcb)[_0x4afa3f(0x2d7)],_0x337db1=new Array(0x18)[_0x4afa3f(0x2ac)](0x0);this[_0x4afa3f(0x235)][_0x4afa3f(0x1ea)](_0x2b234e=>{const _0x470121=_0x4afa3f,_0x4e028e=new Date(_0x2b234e['timestamp']);if(_0x4e028e[_0x470121(0x2b2)]()>_0x59fdcb)_0x337db1[_0x4e028e[_0x470121(0x17d)]()]++;});let _0x246a3e={'status':_0x4afa3f(0x33b)};try{_0x246a3e[_0x4afa3f(0x27e)]=(await this[_0x4afa3f(0x274)](LTM_DP_DRIFT_STATUS))[_0x4afa3f(0x348)];}catch(_0x2e77e1){}let _0x4f79d7='';try{const _0x2e35ae=await this[_0x4afa3f(0x274)](_0x4afa3f(0x332));_0x4f79d7=_0x2e35ae?_0x2e35ae['val']:'';}catch(_0x43573a){}let _0x25d1c0=null;!this[_0x4afa3f(0x2b8)]&&(_0x25d1c0=this[_0x4afa3f(0x34d)]['geminiApiKey']?_0x4afa3f(0x1ce):_0x4afa3f(0x170));let _0x32533a={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0xe33410=await this[_0x4afa3f(0x274)]('analysis.automation.patternDetected'),_0x3c2b41=await this[_0x4afa3f(0x274)](_0x4afa3f(0x1c3)),_0x426eba=await this[_0x4afa3f(0x274)](_0x4afa3f(0x1c6)),_0x21e530=await this[_0x4afa3f(0x274)](_0x4afa3f(0x1d9)),_0x53a130=await this[_0x4afa3f(0x274)](_0x4afa3f(0x1c0));_0xe33410&&_0xe33410[_0x4afa3f(0x348)]&&(_0x32533a[_0x4afa3f(0x2de)]=!![],_0x32533a[_0x4afa3f(0x2f0)]=_0x3c2b41?_0x3c2b41[_0x4afa3f(0x348)]:'',_0x32533a[_0x4afa3f(0x242)]=_0x426eba?_0x426eba[_0x4afa3f(0x348)]:'',_0x32533a[_0x4afa3f(0x30b)]=_0x21e530?_0x21e530[_0x4afa3f(0x348)]:''),_0x32533a[_0x4afa3f(0x327)]=_0x53a130?!!_0x53a130[_0x4afa3f(0x348)]:![];}catch(_0x6ca1b5){}this[_0x4afa3f(0x2b3)](_0x3a2924[_0x4afa3f(0x28b)],_0x3a2924[_0x4afa3f(0x34b)],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0xf),'stats':{'digestCount':_0x521101,'eventCountToday':_0x51d191,'hourlyActivity':_0x337db1,'driftStatus':_0x246a3e[_0x4afa3f(0x27e)],'isPresent':this['isPresent'],'presenceWho':_0x4f79d7,'minDays':this[_0x4afa3f(0x34d)]['minDaysForBaseline']||0x7,'stbDays':this['config'][_0x4afa3f(0x1bd)]||0xe,'ltbDays':this[_0x4afa3f(0x34d)]['ltmLtbWindowDays']||0x3c,'systemError':_0x25d1c0},'automation':_0x32533a},_0x3a2924[_0x4afa3f(0x323)]);}else{if(_0x3a2924[_0x4afa3f(0x34b)]==='getEnums'){const _0x39eb59=await this['getForeignObjectsAsync'](_0x4afa3f(0x331),'enum'),_0x594b70=[];if(_0x39eb59)for(const _0x455361 in _0x39eb59){const _0x18776d=_0x39eb59[_0x455361],_0x3dc399=(_0x18776d['common']&&typeof _0x18776d[_0x4afa3f(0x17f)][_0x4afa3f(0x2ca)]===_0x4afa3f(0x210)?_0x18776d[_0x4afa3f(0x17f)][_0x4afa3f(0x2ca)]['de']:_0x18776d[_0x4afa3f(0x17f)]['name'])||_0x18776d[_0x4afa3f(0x17f)][_0x4afa3f(0x2ca)];_0x594b70[_0x4afa3f(0x2bc)]({'id':_0x455361,'name':_0x3dc399});}this[_0x4afa3f(0x2b3)](_0x3a2924[_0x4afa3f(0x28b)],_0x3a2924[_0x4afa3f(0x34b)],{'success':!![],'enums':_0x594b70},_0x3a2924[_0x4afa3f(0x323)]);}else{if(_0x3a2924[_0x4afa3f(0x34b)]===_0x4afa3f(0x1a2))try{const _0x35e0ec=await scanForDevices(this,_0x3a2924[_0x4afa3f(0x26b)]||{});this[_0x4afa3f(0x2b3)](_0x3a2924['from'],_0x3a2924[_0x4afa3f(0x34b)],{'success':!![],'devices':_0x35e0ec},_0x3a2924['callback']);}catch(_0x5299d3){this[_0x4afa3f(0x2b3)](_0x3a2924[_0x4afa3f(0x28b)],_0x3a2924['command'],{'success':![],'error':_0x5299d3['message']},_0x3a2924['callback']);}else{if(_0x3a2924[_0x4afa3f(0x34b)]===_0x4afa3f(0x1eb)){const _0x47a3c0=_0x3a2924[_0x4afa3f(0x26b)]['instance'];if(!_0x47a3c0)return this['sendTo'](_0x3a2924[_0x4afa3f(0x28b)],_0x3a2924['command'],{'success':![],'error':'No\x20instance'},_0x3a2924['callback']);const _0x28d19b=await getCalendarNames(this,_0x47a3c0);this['sendTo'](_0x3a2924['from'],_0x3a2924[_0x4afa3f(0x34b)],{'success':!![],'names':_0x28d19b},_0x3a2924['callback']);}else{if(_0x3a2924[_0x4afa3f(0x34b)]===_0x4afa3f(0x25e)){const {targetId:_0x1b288e,targetValue:_0x4ac00a}=_0x3a2924['message'];this[_0x4afa3f(0x329)][_0x4afa3f(0x311)](_0x4afa3f(0x1d0)+_0x1b288e+_0x4afa3f(0x2d9)+_0x4ac00a),await this[_0x4afa3f(0x29c)](_0x4afa3f(0x28f),{'val':!![],'ack':!![]}),await this[_0x4afa3f(0x29c)](_0x4afa3f(0x1c3),{'val':_0x4afa3f(0x319)+_0x1b288e,'ack':!![]}),await this[_0x4afa3f(0x29c)](_0x4afa3f(0x1c6),{'val':_0x1b288e,'ack':!![]}),await this[_0x4afa3f(0x29c)]('analysis.automation.targetValue',{'val':_0x4ac00a,'ack':!![]}),this[_0x4afa3f(0x2b3)](_0x3a2924['from'],_0x3a2924[_0x4afa3f(0x34b)],{'success':!![]},_0x3a2924[_0x4afa3f(0x323)]);}else{if(_0x3a2924[_0x4afa3f(0x34b)]===_0x4afa3f(0x18e)){const {historyId:_0x372c33,rating:_0x329603,comment:_0x24e33e,alertReason:_0x3538d3}=_0x3a2924[_0x4afa3f(0x26b)];_0x372c33&&_0x329603?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x372c33,'rating':_0x329603,'comment':_0x24e33e,'alertReason':_0x3538d3}),this[_0x4afa3f(0x2b3)](_0x3a2924['from'],_0x3a2924[_0x4afa3f(0x34b)],{'success':!![]},_0x3a2924['callback'])):this[_0x4afa3f(0x2b3)](_0x3a2924[_0x4afa3f(0x28b)],_0x3a2924[_0x4afa3f(0x34b)],{'success':![],'error':_0x4afa3f(0x18c)},_0x3a2924[_0x4afa3f(0x323)]);}else _0x3a2924[_0x4afa3f(0x34b)]==='dismissAutomation'&&(this[_0x4afa3f(0x329)][_0x4afa3f(0x311)](_0x4afa3f(0x29a)),await this[_0x4afa3f(0x29c)](_0x4afa3f(0x28f),{'val':![],'ack':!![]}),await this[_0x4afa3f(0x29c)](_0x4afa3f(0x1c3),{'val':'','ack':!![]}),this[_0x4afa3f(0x2b3)](_0x3a2924[_0x4afa3f(0x28b)],_0x3a2924['command'],{'success':!![]},_0x3a2924['callback']));}}}}}}}}}catch(_0x10303f){this[_0x4afa3f(0x329)][_0x4afa3f(0x196)](_0x4afa3f(0x1db)+_0x3a2924[_0x4afa3f(0x34b)]+':\x20'+_0x10303f[_0x4afa3f(0x26b)]);if(_0x3a2924[_0x4afa3f(0x323)])this[_0x4afa3f(0x2b3)](_0x3a2924['from'],_0x3a2924[_0x4afa3f(0x34b)],{'success':![],'error':_0x10303f[_0x4afa3f(0x26b)]},_0x3a2924[_0x4afa3f(0x323)]);}}}if(require[a0_0x5b2d07(0x2e7)]!==module)module[a0_0x5b2d07(0x22d)]=_0x30a3b7=>new CogniLiving(_0x30a3b7);else new CogniLiving();