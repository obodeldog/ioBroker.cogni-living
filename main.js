const a0_0x1a07fc=a0_0x22f0;(function(_0x55a67b,_0x2a66b0){const _0x467816=a0_0x22f0,_0x50c0e0=_0x55a67b();while(!![]){try{const _0x4c6832=parseInt(_0x467816(0x13f))/0x1+parseInt(_0x467816(0x1c4))/0x2+-parseInt(_0x467816(0x158))/0x3*(parseInt(_0x467816(0x286))/0x4)+-parseInt(_0x467816(0x19d))/0x5+-parseInt(_0x467816(0x29f))/0x6*(-parseInt(_0x467816(0xde))/0x7)+parseInt(_0x467816(0xca))/0x8*(-parseInt(_0x467816(0x239))/0x9)+parseInt(_0x467816(0x2ab))/0xa;if(_0x4c6832===_0x2a66b0)break;else _0x50c0e0['push'](_0x50c0e0['shift']());}catch(_0x1a2313){_0x50c0e0['push'](_0x50c0e0['shift']());}}}(a0_0x5f56,0x748bb));const a0_0x72e5f7=(function(){let _0x443df6=!![];return function(_0x5b9865,_0x25a5a0){const _0x51e612=_0x443df6?function(){if(_0x25a5a0){const _0x3cb3be=_0x25a5a0['apply'](_0x5b9865,arguments);return _0x25a5a0=null,_0x3cb3be;}}:function(){};return _0x443df6=![],_0x51e612;};}()),a0_0x4ac999=a0_0x72e5f7(this,function(){const _0x3da28d=a0_0x22f0;return a0_0x4ac999[_0x3da28d(0x1b7)]()['search'](_0x3da28d(0x14f))[_0x3da28d(0x1b7)]()[_0x3da28d(0x264)](a0_0x4ac999)[_0x3da28d(0xf4)]('(((.+)+)+)+$');});a0_0x4ac999();'use strict';const utils=require(a0_0x1a07fc(0x208)),{GoogleGenerativeAI}=require(a0_0x1a07fc(0x173)),schedule=require(a0_0x1a07fc(0x146)),{spawn,exec}=require(a0_0x1a07fc(0xc4)),path=require(a0_0x1a07fc(0x115)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x1a07fc(0xe5),LTM_SCHEDULE=a0_0x1a07fc(0x2b0),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x1a07fc(0x106),LTM_DP_DAILY_DIGESTS=a0_0x1a07fc(0x248),LTM_DP_STATUS=a0_0x1a07fc(0xc1),LTM_DP_TRIGGER_DIGEST=a0_0x1a07fc(0x2a7),LTM_DP_BASELINE_STATUS=a0_0x1a07fc(0x1e6),LTM_DP_DRIFT_CHANNEL=a0_0x1a07fc(0x176),LTM_DP_DRIFT_STATUS=a0_0x1a07fc(0x2b6),LTM_DP_DRIFT_DETAILS=a0_0x1a07fc(0x2a8),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x1a07fc(0x190),a0_0x1a07fc(0x1c6),a0_0x1a07fc(0xf7),a0_0x1a07fc(0x2cf),a0_0x1a07fc(0x1db),a0_0x1a07fc(0x257),a0_0x1a07fc(0x134),a0_0x1a07fc(0x2cc),a0_0x1a07fc(0x136),a0_0x1a07fc(0xdf),a0_0x1a07fc(0x28b),a0_0x1a07fc(0x244),a0_0x1a07fc(0x187),'config_pending',a0_0x1a07fc(0x125),a0_0x1a07fc(0x15b),'reachable',a0_0x1a07fc(0x26d)],BAD_NAMES=[a0_0x1a07fc(0x181),a0_0x1a07fc(0x2b1),a0_0x1a07fc(0x1b8),a0_0x1a07fc(0x13a),a0_0x1a07fc(0x235),a0_0x1a07fc(0x228),'on','off','switch',a0_0x1a07fc(0x2bf),a0_0x1a07fc(0xbb),a0_0x1a07fc(0xcc),a0_0x1a07fc(0x124),a0_0x1a07fc(0x299),a0_0x1a07fc(0x1e0),a0_0x1a07fc(0xee),'occupancy',a0_0x1a07fc(0x292),'humidity','power',a0_0x1a07fc(0x2c3),a0_0x1a07fc(0x1c9),a0_0x1a07fc(0xe9),a0_0x1a07fc(0x219),a0_0x1a07fc(0x1bd)],ADAPTER_BLACKLIST=['system.',a0_0x1a07fc(0x1b4),a0_0x1a07fc(0x16e),'vis.','history.',a0_0x1a07fc(0x175),a0_0x1a07fc(0x192),a0_0x1a07fc(0x22a),'echarts.',a0_0x1a07fc(0x20b),a0_0x1a07fc(0x1b1)],SYSTEM_MODES={'NORMAL':a0_0x1a07fc(0x15a),'VACATION':a0_0x1a07fc(0x23d),'PARTY':a0_0x1a07fc(0x165),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x1a07fc(0x214)]],PERSONA_MAPPING={'generic':a0_0x1a07fc(0x221),'senior_aal':'PRIORITÃ„T:\x20Gesundheit/AAL.','family':a0_0x1a07fc(0xe6),'single_comfort':a0_0x1a07fc(0x110),'security':a0_0x1a07fc(0xd7)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x488a15){const _0x1bc0f9=a0_0x1a07fc;try{const _0x4232f2=['analysis.history_debug_00',_0x1bc0f9(0xf0)];for(const _0x56a4b9 of _0x4232f2){try{const _0x3aaad4=await _0x488a15[_0x1bc0f9(0x1eb)](_0x56a4b9);_0x3aaad4&&await _0x488a15['delObjectAsync'](_0x56a4b9);}catch(_0x5b7b92){}}}catch(_0x2af7c2){}}async function initHistory(_0xc42b63){const _0x156a7a=a0_0x1a07fc;try{const _0x1041c9=await _0xc42b63[_0x156a7a(0x1a3)]('events.history');_0x1041c9&&_0x1041c9[_0x156a7a(0x24d)]&&(_0xc42b63[_0x156a7a(0x28e)]=JSON[_0x156a7a(0x1e8)](_0x1041c9[_0x156a7a(0x24d)][_0x156a7a(0x1b7)]()));}catch(_0x51a986){_0xc42b63[_0x156a7a(0x28e)]=[];}try{const _0x214bed=await _0xc42b63[_0x156a7a(0x1a3)](_0x156a7a(0x162));if(_0x214bed&&_0x214bed['val'])_0xc42b63['analysisHistory']=JSON[_0x156a7a(0x1e8)](_0x214bed[_0x156a7a(0x24d)]['toString']());}catch(_0x851415){_0xc42b63['analysisHistory']=[];}if(_0xc42b63['eventHistory']&&_0xc42b63['eventHistory'][_0x156a7a(0x10b)]>0x0){_0xc42b63['log']['info'](_0x156a7a(0xef)+_0xc42b63[_0x156a7a(0x28e)][_0x156a7a(0x10b)]+_0x156a7a(0x249));for(let _0x4a2dd3=_0xc42b63['eventHistory'][_0x156a7a(0x10b)]-0x1;_0x4a2dd3>=0x0;_0x4a2dd3--){const _0x56c46d=_0xc42b63['eventHistory'][_0x4a2dd3];_0x56c46d&&_0x56c46d['id']!==undefined&&_0x56c46d[_0x156a7a(0x235)]!==undefined&&(_0xc42b63['sensorLastValues'][_0x56c46d['id']]=_0x56c46d[_0x156a7a(0x235)]);}}}async function initSystemConfig(_0x1a2404){const _0x32feb8=a0_0x1a07fc;try{const _0x963ce=await _0x1a2404[_0x32feb8(0x1a8)](_0x32feb8(0x1b5));_0x963ce&&_0x963ce['common']&&(_0x1a2404[_0x32feb8(0x23a)]={'latitude':_0x963ce['common'][_0x32feb8(0x295)]||0x0,'longitude':_0x963ce[_0x32feb8(0x234)][_0x32feb8(0x11b)]||0x0,'city':_0x963ce['common'][_0x32feb8(0x10e)]||''});}catch(_0x5d72e0){}}async function checkLicense(_0x3514bb,_0x1dae93){const _0xd130f2=a0_0x1a07fc;if(!_0x1dae93)return![];_0x3514bb[_0xd130f2(0x27b)]=await getSystemUUID(_0x3514bb);if(_0x1dae93===_0xd130f2(0x271)||_0x1dae93['startsWith'](_0xd130f2(0xc7)))return!![];return![];}async function getSystemUUID(_0x7416d8){const _0x52bc38=a0_0x1a07fc;try{const _0x3be656=await _0x7416d8[_0x52bc38(0x1a8)](_0x52bc38(0x2c1));if(_0x3be656&&_0x3be656[_0x52bc38(0x2c5)]&&_0x3be656['native'][_0x52bc38(0x114)])return _0x3be656[_0x52bc38(0x2c5)]['uuid'];return _0x52bc38(0x25a);}catch(_0x319deb){return _0x52bc38(0x1d6);}}async function createAllObjects(_0x39116b){const _0x3ada65=a0_0x1a07fc;await checkSystemObjects(_0x39116b),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x1f1),{'type':_0x3ada65(0x1b8),'common':{'name':'Who\x20is\x20present?','type':'string','role':_0x3ada65(0x28f),'read':!![],'write':![],'def':''},'native':{}}),await _0x39116b['setObjectNotExistsAsync'](_0x3ada65(0x180),{'type':'state','common':{'name':_0x3ada65(0x17c),'type':_0x3ada65(0x298),'role':_0x3ada65(0x13c),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x1d8),{'type':'state','common':{'name':'Event\x20History','type':_0x3ada65(0x298),'role':_0x3ada65(0x13c),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x140),{'type':_0x3ada65(0x1b8),'common':{'name':'Trigger\x20Analysis','type':_0x3ada65(0x24a),'role':_0x3ada65(0x168),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x39116b['setObjectNotExistsAsync'](_0x3ada65(0x127),{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x29d),'type':_0x3ada65(0x24a),'role':_0x3ada65(0x168),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)]('analysis.lastResult',{'type':_0x3ada65(0x1b8),'common':{'name':'Last\x20Result','type':_0x3ada65(0x298),'role':_0x3ada65(0x13c),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)]('analysis.isAlert',{'type':_0x3ada65(0x1b8),'common':{'name':'AI\x20Alert\x20Status','type':_0x3ada65(0x24a),'role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0xbd),{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x27a),'type':_0x3ada65(0x24a),'role':_0x3ada65(0x138),'read':!![],'write':![],'def':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)]('analysis.alertReason',{'type':_0x3ada65(0x1b8),'common':{'name':'Alert\x20Reason','type':_0x3ada65(0x298),'role':_0x3ada65(0x104),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)]('analysis.activitySummary',{'type':'state','common':{'name':'Activity\x20Summary','type':_0x3ada65(0x298),'role':_0x3ada65(0x28f),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x267),{'type':_0x3ada65(0x1b8),'common':{'name':'Deviation','type':_0x3ada65(0x298),'role':'state','read':!![],'write':![],'def':_0x3ada65(0x148)},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x275),{'type':'state','common':{'name':'Comfort\x20Summary','type':'string','role':_0x3ada65(0x28f),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x167),{'type':_0x3ada65(0x1b8),'common':{'name':'Comfort\x20Suggestion','type':_0x3ada65(0x298),'role':_0x3ada65(0x28f),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x247)](_0x3ada65(0x18e),{'type':_0x3ada65(0x111),'common':{'name':_0x3ada65(0x13e)},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x19e),{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x163),'type':_0x3ada65(0x24a),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0xce),{'type':_0x3ada65(0x1b8),'common':{'name':'Description','type':'string','role':_0x3ada65(0x28f),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)]('analysis.automation.suggestedAction',{'type':_0x3ada65(0x1b8),'common':{'name':'Action','type':_0x3ada65(0x298),'role':_0x3ada65(0x28f),'read':!![],'write':![]},'native':{}}),await _0x39116b['setObjectNotExistsAsync'](_0x3ada65(0x204),{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x12e),'type':_0x3ada65(0x298),'role':'text','read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)]('analysis.automation.targetValue',{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x20a),'type':_0x3ada65(0x298),'role':_0x3ada65(0x28f),'read':!![],'write':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)]('analysis.automation.autoApply',{'type':'state','common':{'name':_0x3ada65(0x1bc),'type':_0x3ada65(0x24a),'role':'switch','read':!![],'write':!![],'def':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x117),{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0xc5),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)]('analysis.analysisHistory',{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x188),'type':_0x3ada65(0x298),'role':_0x3ada65(0x13c),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0xec),{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x206),'type':_0x3ada65(0x298),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x39116b['extendObjectAsync'](_0x3ada65(0x20d),{'type':_0x3ada65(0x111),'common':{'name':_0x3ada65(0x25f)},'native':{}}),await _0x39116b['setObjectNotExistsAsync'](_0x3ada65(0x253),{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x1c7),'type':'number','role':_0x3ada65(0x25e),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x39116b['setObjectNotExistsAsync']('analysis.health.restlessness',{'type':_0x3ada65(0x1b8),'common':{'name':'Restlessness\x20Level','type':_0x3ada65(0x298),'role':_0x3ada65(0x28f),'read':!![],'write':![],'def':_0x3ada65(0x256)},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x130),{'type':'state','common':{'name':_0x3ada65(0xd9),'type':_0x3ada65(0x298),'role':_0x3ada65(0x28f),'read':!![],'write':![],'def':''},'native':{}}),await _0x39116b['setObjectNotExistsAsync'](_0x3ada65(0xf5),{'type':'state','common':{'name':_0x3ada65(0x153),'type':_0x3ada65(0x298),'role':_0x3ada65(0x28f),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x15e),{'type':'state','common':{'name':_0x3ada65(0x243),'type':'number','role':_0x3ada65(0x235),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x39116b[_0x3ada65(0x247)](_0x3ada65(0xfd),{'type':_0x3ada65(0x111),'common':{'name':_0x3ada65(0x294)},'native':{}}),await _0x39116b['setObjectNotExistsAsync']('LTM.trainingData.sequences',{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x26e),'type':_0x3ada65(0x298),'role':_0x3ada65(0x13c),'read':!![],'write':![],'def':'[]','desc':_0x3ada65(0x2a5)},'native':{}}),await _0x39116b[_0x3ada65(0x1f6)](_0x3ada65(0x11d),{'type':_0x3ada65(0x1b8),'common':{'name':_0x3ada65(0x171),'type':_0x3ada65(0x298),'role':'json','read':!![],'write':![],'def':'[]','desc':_0x3ada65(0x272)},'native':{}}),await checkLtmObjects(_0x39116b),await checkLtmDriftObjects(_0x39116b);}async function checkSystemObjects(_0xfdd469){const _0xe9653=a0_0x1a07fc;await _0xfdd469[_0xe9653(0x247)](_0xe9653(0x23e),{'type':_0xe9653(0x111),'common':{'name':_0xe9653(0x164)},'native':{}}),await _0xfdd469[_0xe9653(0x247)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0xe9653(0x2c2),'type':_0xe9653(0x298),'role':_0xe9653(0x1b8),'read':!![],'write':!![],'def':SYSTEM_MODES[_0xe9653(0x24e)],'states':{[SYSTEM_MODES[_0xe9653(0x24e)]]:_0xe9653(0xc3),[SYSTEM_MODES['VACATION']]:_0xe9653(0x203),[SYSTEM_MODES[_0xe9653(0x2b3)]]:_0xe9653(0x2d1),[SYSTEM_MODES[_0xe9653(0x214)]]:_0xe9653(0x25b)}},'native':{}});}async function checkLtmObjects(_0x42601c){const _0x19f46e=a0_0x1a07fc;await _0x42601c[_0x19f46e(0x247)]('LTM',{'type':_0x19f46e(0x111),'common':{'name':'LTM'},'native':{}}),await _0x42601c[_0x19f46e(0x247)](LTM_DP_RAW_LOG,{'type':_0x19f46e(0x1b8),'common':{'name':_0x19f46e(0x122),'type':_0x19f46e(0x298),'role':_0x19f46e(0x13c),'read':!![],'write':![]},'native':{}}),await _0x42601c[_0x19f46e(0x247)](LTM_DP_DAILY_DIGESTS,{'type':_0x19f46e(0x1b8),'common':{'name':_0x19f46e(0x1cb),'type':'string','role':_0x19f46e(0x13c),'read':!![],'write':![]},'native':{}}),await _0x42601c[_0x19f46e(0x247)](LTM_DP_STATUS,{'type':_0x19f46e(0x1b8),'common':{'name':_0x19f46e(0x1bb),'type':'string','role':_0x19f46e(0x28f),'read':!![],'write':![]},'native':{}}),await _0x42601c['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x19f46e(0x1b8),'common':{'name':'Trigger\x20Digest','type':_0x19f46e(0x24a),'role':_0x19f46e(0x168),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x42601c['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x19f46e(0x1b8),'common':{'name':'Baseline\x20Status','type':'string','role':'text','read':!![],'write':![]},'native':{}});}function a0_0x22f0(_0x20047b,_0x450cc7){const _0x17144b=a0_0x5f56();return a0_0x22f0=function(_0x4ac999,_0x72e5f7){_0x4ac999=_0x4ac999-0xba;let _0x5f5676=_0x17144b[_0x4ac999];return _0x5f5676;},a0_0x22f0(_0x20047b,_0x450cc7);}async function checkLtmDriftObjects(_0x4e4004){const _0x1a0f27=a0_0x1a07fc;await _0x4e4004[_0x1a0f27(0x247)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':'Drift\x20Analysis'},'native':{}}),await _0x4e4004[_0x1a0f27(0x247)](LTM_DP_DRIFT_STATUS,{'type':_0x1a0f27(0x1b8),'common':{'name':'Drift\x20Status','type':'string','role':_0x1a0f27(0x1b8),'read':!![],'write':![],'def':_0x1a0f27(0x148)},'native':{}}),await _0x4e4004[_0x1a0f27(0x247)](LTM_DP_DRIFT_DETAILS,{'type':_0x1a0f27(0x1b8),'common':{'name':_0x1a0f27(0x154),'type':_0x1a0f27(0x298),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4e4004[_0x1a0f27(0x247)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':'Last\x20Check','type':_0x1a0f27(0x289),'role':_0x1a0f27(0x274),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x968644){const _0x3cefa7=a0_0x1a07fc;try{const _0x1d7c2b=await _0x968644[_0x3cefa7(0x1a3)](SYSTEM_DP_MODE);_0x1d7c2b&&_0x1d7c2b[_0x3cefa7(0x24d)]&&Object[_0x3cefa7(0x21a)](SYSTEM_MODES)[_0x3cefa7(0x1a0)](_0x1d7c2b[_0x3cefa7(0x24d)])?_0x968644[_0x3cefa7(0xff)]=_0x1d7c2b[_0x3cefa7(0x24d)]:(_0x968644['currentSystemMode']=SYSTEM_MODES[_0x3cefa7(0x24e)],await _0x968644[_0x3cefa7(0x21c)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3cefa7(0x24e)],'ack':!![]}));}catch(_0x34afc7){_0x968644[_0x3cefa7(0xff)]=SYSTEM_MODES[_0x3cefa7(0x24e)];}}async function loadRawEventLog(_0x1699e6){const _0x3c4da1=a0_0x1a07fc;try{const _0x11f1eb=await _0x1699e6[_0x3c4da1(0x1a3)](LTM_DP_RAW_LOG);if(_0x11f1eb&&_0x11f1eb[_0x3c4da1(0x24d)])_0x1699e6[_0x3c4da1(0x183)]=JSON['parse'](_0x11f1eb[_0x3c4da1(0x24d)]);}catch(_0x5994ed){_0x1699e6[_0x3c4da1(0x183)]=[];}}async function saveRawEventLog(_0x482a3a){const _0x5352a1=a0_0x1a07fc;_0x482a3a[_0x5352a1(0x183)]['length']>RAW_LOG_MAX_SIZE&&_0x482a3a[_0x5352a1(0x183)][_0x5352a1(0xf3)](0x0,_0x482a3a[_0x5352a1(0x183)][_0x5352a1(0x10b)]-RAW_LOG_MAX_SIZE),await _0x482a3a['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x5352a1(0x233)](_0x482a3a[_0x5352a1(0x183)]),'ack':!![]});}async function loadDailyDigests(_0x317405){const _0x3d3cc5=a0_0x1a07fc;try{const _0xefc1ad=await _0x317405[_0x3d3cc5(0x1a3)](LTM_DP_DAILY_DIGESTS);if(_0xefc1ad&&_0xefc1ad[_0x3d3cc5(0x24d)])_0x317405['dailyDigests']=JSON['parse'](_0xefc1ad[_0x3d3cc5(0x24d)]);}catch(_0x379555){_0x317405['dailyDigests']=[];}await updateBaselineStatus(_0x317405);}async function saveDailyDigests(_0x2a3b64,_0x50a3a0=!![]){const _0x49b5f4=a0_0x1a07fc,_0x1cea05=_0x2a3b64[_0x49b5f4(0x195)][_0x49b5f4(0x2c8)]||0x3c;_0x2a3b64['dailyDigests'][_0x49b5f4(0x10b)]>_0x1cea05&&_0x2a3b64['dailyDigests']['splice'](0x0,_0x2a3b64[_0x49b5f4(0x11c)][_0x49b5f4(0x10b)]-_0x1cea05);await _0x2a3b64['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x2a3b64[_0x49b5f4(0x11c)]),'ack':!![]});if(_0x50a3a0)await updateBaselineStatus(_0x2a3b64);}async function updateAnalysisHistory(_0x5ed176,_0x341712){const _0x321549=a0_0x1a07fc;_0x5ed176[_0x321549(0x112)][_0x321549(0x1c5)](_0x341712);if(_0x5ed176[_0x321549(0x112)][_0x321549(0x10b)]>ANALYSIS_HISTORY_MAX_SIZE)_0x5ed176[_0x321549(0x112)][_0x321549(0x177)]();await _0x5ed176[_0x321549(0x21c)](_0x321549(0x162),{'val':JSON[_0x321549(0x233)](_0x5ed176[_0x321549(0x112)]),'ack':!![]});}async function updateBaselineStatus(_0x46746b){const _0x4ec005=a0_0x1a07fc;if(!_0x46746b['isProVersion']){await _0x46746b[_0x4ec005(0x21c)](LTM_DP_BASELINE_STATUS,{'val':_0x4ec005(0x10f),'ack':!![]});return;}const _0x3cf68c=_0x46746b['dailyDigests']['length']>=(_0x46746b[_0x4ec005(0x195)][_0x4ec005(0x131)]||0x7)?_0x4ec005(0x22d)+_0x46746b[_0x4ec005(0x11c)][_0x4ec005(0x10b)]+_0x4ec005(0x22e):'Lernphase\x20('+_0x46746b['dailyDigests']['length']+'/'+(_0x46746b[_0x4ec005(0x195)][_0x4ec005(0x131)]||0x7)+')';await _0x46746b[_0x4ec005(0x21c)](LTM_DP_BASELINE_STATUS,{'val':_0x3cf68c,'ack':!![]});}async function initSensorSubscriptions(_0x2e593d){const _0x4c0a22=a0_0x1a07fc,_0x2dafbe=_0x2e593d[_0x4c0a22(0x195)]['devices'];if(_0x2dafbe&&_0x2dafbe['length']>0x0){_0x2e593d['log'][_0x4c0a22(0x26b)](_0x4c0a22(0x2be)+_0x2dafbe[_0x4c0a22(0x10b)]+'\x20sensors...');for(const _0x437f87 of _0x2dafbe){if(_0x437f87['id']){await _0x2e593d[_0x4c0a22(0x1d9)](_0x437f87['id']);try{const _0x198b86=await _0x2e593d[_0x4c0a22(0x129)](_0x437f87['id']);if(_0x198b86)_0x2e593d[_0x4c0a22(0x265)][_0x437f87['id']]=_0x198b86[_0x4c0a22(0x24d)];}catch(_0x5b0951){}}}}}function a0_0x5f56(){const _0x58d241=['automationProposal','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','.\x0a\x20\x20\x20\x20WETTER:\x20','text.alarm','âŒ\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20','LTM.rawEventLog','message','ack','sendToAsync','from','length','User\x20dismissed\x20automation\x20proposal.','version','city','Deaktiviert\x20(Pro-Feature)','Fokus\x20auf\x20Komfort.','channel','analysisHistory','toISOString','uuid','path','[RESULT]','analysis.automation.triggerAction','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','forEach','notifyPushoverRecipient','longitude','dailyDigests','LTM.trainingData.thermodynamics','sendTo','endsWith','setForeignStateAsync','testApiKey','Raw\x20Log','ðŸ\x20Stopping\x20Python\x20Sidecar...','cover','dutycycle','writable','analysis.triggerBriefing','expire','getForeignStateAsync','stateChange','cogni-living','[PYTHON]\x20','.forecast.current.state','Target\x20ID','enum.rooms.*','analysis.health.notes','minDaysForBaseline','ðŸš¨\x20EMERGENCY','Exit\x20Sensor\x20triggered\x20(','connection','\x20min).','error','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','indicator.alarm.fire','ML-Libs\x20fehlen','level','Keine\x20Analyse.','json','ical.0','Automation\x20Proposals','315591MLybPj','analysis.trigger','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','geminiModel','bind','âœ…\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','role','node-schedule','map','N/A','analysis.automation.targetValue','summary','join','debug','generic','weatherunderground.0','(((.+)+)+)+$','now','replace','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Trend\x20Diagnosis\x20(Python)','Drift\x20Details','Bibliotheken\x20nicht\x20gefunden','command','sleepScore','1614itMZLV','ltmJob','normal','firmware','_score','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','analysis.health.trendValue','modeResetJob','VACATION','callback','analysis.analysisHistory','Pattern\x20Detected','System\x20Status\x20&\x20Control','party','isAlert','analysis.comfortSuggestion','button','alertReason','setState','logDuplicates','lights','getHours','info.','python_service','Error\x20checking\x20WiFi:\x20','Thermodynamic\x20Data\x20Points','.Current.Temperature','@google/generative-ai','TREND_RESULT','material.','LTM.driftAnalysis','pop','details','dismissAutomation','python3\x20-m\x20pip\x20install\x20-r\x20\x22','N/A\x20(Learning)','Last\x20raw\x20event','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','\x20(Length:\x20','notifyPushoverEnabled','events.lastEvent','targetposition','Sending\x20notification:\x20\x22','rawEventLog','setHours','âœ…\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','weatherunderground','stick_unreach','Logbook','members','getForeignObjectsAsync','lock','apiKey','.NextHours.Location_1.Day_1.current.temp_value','analysis.automation','No\x20module\x20named\x20pip','scriptProblem','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','icons-mfd.','Say\x20Hello','event','config','âœ…\x20PRO\x20ACTIVATED','getGenerativeModel','.\x0a\x20\x20\x20\x20KONTEXT:\x20','useWeather','Could\x20not\x20kill\x20Python\x20process:\x20','location','driftAnalysisTimer','551575bnyZBa','analysis.automation.patternDetected','inactivityMonitoringEnabled','includes','Gemini\x20Init\x20Error:\x20','isGracePeriodActive','getStateAsync','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','slice','licenseKey','getForeignObjectAsync','[PYTHON\x20ERR]\x20','Gemini\x20Analysis\x20Error:\x20','Drift\x20Sched\x20Error:\x20',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','schalter','subscribeStates','detected','livingContext','simple-api.','telegram','selectedFunctionIds','admin.','system.config','\x20=\x20','toString','state','custom','accuweather','Processing\x20Status','Auto\x20Apply\x20Rule','set_temperature','âŒ\x20FREE\x20MODE','autoApply','submitFeedback','Error\x20launching\x20Python\x20service:\x20','Invalid\x20JSON\x20from\x20Python:\x20','\x20for\x20interactive\x20buttons...','71694cuStLF','unshift','scriptEnabled','Sleep\x20Score\x20(0-100)','onMessage','setpoint','toLowerCase','Daily\x20Digests','getTime','analysis.alertReason','notifyTelegramRecipient','ðŸ\x20Guardian\x20Diagnosis\x20(','notifyTelegramInstance','KALENDER:\x20Keine\x20Daten','licht','push','log','weatherInstance','uuid-error','calendarInstance','events.history','subscribeForeignStatesAsync','door','lowbat','getOverviewData','service.py','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','getLtmData','motion','Skipped\x20(No\x20AI\x20or\x20Data)','exports','\x20(Value:\x20','devices','Cogni-Living','LTM.baselineStatus','triggerBriefing','parse','.forecast.current.temperature','baselineDrift','getObjectAsync','.forecast.current.temp','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','BUTLER\x20Execution\x20Error:\x20','targetValue','split','system.presenceWho','08:00','COGNI_REQUEST_CALL','notifyTelegramEnabled','shift','setObjectNotExistsAsync','\x20presence\x20devices...','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','[TEST]\x20','\x20(Type\x20\x27','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','loc','payload','analysis.automation.autoApply','ðŸŒ…\x20Daily\x20Briefing:\x0a','dependencyInstallInProgress','driftDetails','analysis.activitySummary','Urlaub','analysis.automation.targetId','exitTimer','Feedback\x20Log','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','@iobroker/adapter-core','exitGraceTimer','Target\x20Value','javascript.','ready','analysis.health','response','write','sort','\x20(Value\x20is\x20falsy:\x20','notifyEmailInstance','.communicate.request','GUEST','.\x20ZUSATZ:\x20','Started\x20at\x20','rollladen','analysis.isAlert','actual_temperature','values','.\x20DATEN:\x20Schlaf\x20','setStateAsync','fenster','switch','notifyPushoverInstance','targetId','Analysiere\x20ausgewogen.','.NextHours.Location_1.Day_1.current.symbol_desc','onReady','ANALYZE_TREND','substring','Verbindung\x20erfolgreich!\x20Antwort:\x20','.\x20KONTEXT:\x20','brightness','onUnload','flot.','analysisInterval','enum','Aktiv\x20(','\x20Tage)','KALENDER\x20ERROR:\x20','instance','send','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','stringify','common','value','heizung','COGNI_CONFIRM_OK','openweathermap','1998PUYFgT','systemConfig','object','Activity-Level','vacation','system','WETTER\x20ERROR:\x20','.data.table','calendarSelection','window','Trend\x20Value\x20(%)','direction','name','Kalender:\x20Deaktiviert','extendObjectAsync','LTM.dailyDigests','\x20events)...','boolean','generateContent','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','val','NORMAL','briefingJob','\x20|\x20','some','contact','analysis.health.sleepScore','requirements.txt','ltmStbWindowDays','none','rssi','KALENDER:\x20','retry','uuid-not-found','Gast','simulateButler','KALENDER:\x20Keine\x20relevanten\x20Termine','value.health','Health\x20&\x20Sleep\x20Analysis','find','doors','feedbackHistory','aiPersona','constructor','sensorLastValues','communicate.request','analysis.deviationFromBaseline','Wetter:\x20Deaktiviert','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.','info','briefingTime','link_quality','Recorded\x20Motion\x20Sequences','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','time','TEST-PRO-KEY','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','LTM.trainingData.sequences','date','analysis.comfortSummary','isProVersion','\x20|\x20Status:\x20','python3','scanDevices','AI\x20Emergency\x20Status','systemUUID','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','toFixed','description','cancel','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','Morning\x20Briefing\x20sent.','WETTER:\x20Keine\x20Daten\x20gefunden','genAI','Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip','main','3524kGskDY','type','...','number','namespace','working','data','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','eventHistory','text','isArray','Scheduling\x20Morning\x20Briefing\x20for\x20','temperature','close','Training\x20Data\x20Sets','latitude','Failed\x20to\x20send\x20to\x20Python:\x20','getDate','string','status','notifyEmailRecipient','_calName','Unknown','Trigger\x20Briefing\x20(Test)','outdoorSensorId','114486aowktn','\x22\x20--break-system-packages\x20--user','Guardian:\x20Sending\x20','isPresent','Error\x20in\x20onMessage\x20command\x20','warn','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','system.isPresent','LTM.triggerDailyDigest','LTM.driftAnalysis.driftDetails','siren','.\x20OUTPUT:\x20Nur\x20Text.','6433470unGbMA','temp','pythonProcess','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','Error\x20reading\x20calendar\x20table:\x20','0\x203\x20*\x20*\x20*','currentposition','system.mode','PARTY','presenceDevices','Kein\x20API\x20Key\x20eingegeben.','LTM.driftAnalysis.baselineDrift','Missing\x20data','\x0aSTB:\x20','startsWith','accuweather.0','Briefing\x20Sched\x20Error:\x20','useCalendar','isEmergency','Subscribing\x20to\x20','position','catch','system.meta.uuid','System\x20Mode','energy','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','native','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','âš ï¸\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...','ltmLtbWindowDays','onStateChange','health','prÃ¤senz','maintenance','Error\x20reading\x20outdoor\x20sensor\x20','trim','unreach','getFullYear','Party','getMonth','shutter','[LOG]','analysis.isEmergency','inactivityThresholdHours','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','Reset\x20Sched\x20Error:\x20','LTM.processingStatus','Starting\x20Autopilot\x20(','Normal','child_process','Trigger\x20Action\x20Now','\x22\x20--break-system-packages','PRO-','geminiApiKey','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','7904gZpoyG','Generating\x20Morning\x20Briefing...','blind','lastAlertState','analysis.automation.description','notifyEmailEnabled','.Summary.Current','enum.functions.*','activityLevel','[LICENSE\x20CHECK]\x20Key\x20present:\x20','Gemini\x20AI\x20initialized.','daswetter.0','stderr','PRIORITÃ„T:\x20Sicherheit.','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','Health\x20Notes','klima','kill','):\x20','Error:\x20','105TWDGHK','fault','occupancy','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','lastIndexOf','light','stdin','models/gemini-flash-latest','Fokus\x20auf\x20Familienroutinen.','ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','Feedback\x20saved:\x20','valve','filter','\x20events','analysis.feedbackHistory','Keiner','presence','Restoring\x20sensor\x20cache\x20from\x20history\x20(','events.history_debug_00','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','splice','search','analysis.health.trendDiagnosis','analysisTimer','update','timestamp','isExit','briefingEnabled','online','Event\x20received:\x20','LTM.trainingData','daswetter','currentSystemMode','weather'];a0_0x5f56=function(){return _0x58d241;};return a0_0x5f56();}async function initPresenceSubscriptions(_0x12f12c){const _0x379476=a0_0x1a07fc,_0x417cfc=_0x12f12c[_0x379476(0x195)][_0x379476(0x2b4)]||[];if(_0x417cfc[_0x379476(0x10b)]>0x0){_0x12f12c[_0x379476(0x1d4)][_0x379476(0x26b)](_0x379476(0x2be)+_0x417cfc[_0x379476(0x10b)]+_0x379476(0x1f7));for(const _0x40a98c of _0x417cfc){await _0x12f12c['subscribeForeignStatesAsync'](_0x40a98c);}try{await checkWifiPresence(_0x12f12c);}catch(_0x50817d){}}}async function getWeatherContext(_0x31234f){const _0x278391=a0_0x1a07fc;try{if(!_0x31234f[_0x278391(0x195)][_0x278391(0x199)])return _0x278391(0x268);let _0x363708='';const _0x5cec06=_0x31234f[_0x278391(0x195)]['weatherInstance'];if(_0x5cec06)try{if(_0x5cec06['includes'](_0x278391(0x1ba))){const _0x593ff4=await _0x31234f[_0x278391(0x129)](_0x5cec06+_0x278391(0xd0));if(_0x593ff4&&_0x593ff4[_0x278391(0x24d)])_0x363708=_0x593ff4['val'];}else{if(_0x5cec06[_0x278391(0x1a0)](_0x278391(0xfe))){const _0x357f3e=await _0x31234f[_0x278391(0x129)](_0x5cec06+_0x278391(0x222));if(_0x357f3e&&_0x357f3e['val'])_0x363708=_0x357f3e[_0x278391(0x24d)];}else{if(_0x5cec06['includes'](_0x278391(0x238))){const _0x405c0d=await _0x31234f['getForeignStateAsync'](_0x5cec06+_0x278391(0x12d));if(_0x405c0d&&_0x405c0d['val'])_0x363708=_0x405c0d[_0x278391(0x24d)];}}}}catch(_0x4dd33d){}if(!_0x363708){const _0x333d07=[_0x278391(0x2ba),_0x278391(0xd5),_0x278391(0x14e),'openweathermap.0'];for(const _0x47cc6b of _0x333d07){try{const _0x500548=await _0x31234f[_0x278391(0x1a8)](_0x47cc6b);if(_0x500548){if(_0x47cc6b[_0x278391(0x1a0)]('accuweather')){const _0x289ea=await _0x31234f[_0x278391(0x129)](_0x47cc6b+'.Summary.Current');if(_0x289ea&&_0x289ea[_0x278391(0x24d)]){_0x363708=_0x289ea[_0x278391(0x24d)];break;}}}}catch(_0x4eeeba){}}}return _0x363708?'WETTER:\x20'+_0x363708:_0x278391(0x282);}catch(_0x3b9f98){return _0x278391(0x23f)+_0x3b9f98['message'];}}async function getCalendarContext(_0x3cce25){const _0x309397=a0_0x1a07fc;try{if(!_0x3cce25[_0x309397(0x195)][_0x309397(0x2bc)])return _0x309397(0x246);let _0x1502b5=_0x3cce25[_0x309397(0x195)][_0x309397(0x1d7)]||_0x309397(0x13d),_0x1adc64=_0x3cce25[_0x309397(0x195)][_0x309397(0x241)]||[];if(typeof _0x1adc64===_0x309397(0x298))_0x1adc64=_0x1adc64[_0x309397(0x1f0)](',');try{const _0x3d3ece=await _0x3cce25[_0x309397(0x129)](_0x1502b5+_0x309397(0x240));if(_0x3d3ece&&_0x3d3ece[_0x309397(0x24d)]){let _0xaa8ee4=tryParse(_0x3d3ece[_0x309397(0x24d)]);if(_0xaa8ee4&&Array[_0x309397(0x290)](_0xaa8ee4)){if(_0x1adc64['length']>0x0)_0xaa8ee4=_0xaa8ee4[_0x309397(0xea)](_0x246d0e=>_0x1adc64['includes'](_0x246d0e[_0x309397(0x29b)]||''));else return _0x309397(0x280);if(_0xaa8ee4[_0x309397(0x10b)]>0x0){const _0x2a3b45=_0xaa8ee4[_0x309397(0x1a6)](0x0,0x3)[_0x309397(0x147)](_0x4c1975=>{const _0x27899c=_0x309397;let _0x40167f=_0x4c1975[_0x27899c(0x274)];if(_0x4c1975['time'])_0x40167f+='\x20'+_0x4c1975[_0x27899c(0x270)];return _0x40167f+':\x20'+_0x4c1975[_0x27899c(0x194)]+'\x20('+_0x4c1975[_0x27899c(0x29b)]+')';});return _0x309397(0x258)+_0x2a3b45['join'](_0x309397(0x250));}else return _0x309397(0x25d);}}}catch(_0x50aaa8){_0x3cce25[_0x309397(0x1d4)][_0x309397(0x2a4)](_0x309397(0x2af)+_0x50aaa8[_0x309397(0x107)]);}return _0x309397(0x1d1);}catch(_0x465ca2){return _0x309397(0x22f)+_0x465ca2[_0x309397(0x107)];}}async function getCalendarNames(_0x703b8c,_0x108e48){const _0x23d2b6=a0_0x1a07fc;try{const _0x3a1a7b=await _0x703b8c[_0x23d2b6(0x129)](_0x108e48+'.data.table');if(_0x3a1a7b&&_0x3a1a7b[_0x23d2b6(0x24d)]){const _0x511c81=tryParse(_0x3a1a7b[_0x23d2b6(0x24d)]);if(_0x511c81&&Array['isArray'](_0x511c81)){const _0x22dc47=[...new Set(_0x511c81['map'](_0x53a88b=>_0x53a88b[_0x23d2b6(0x29b)])[_0x23d2b6(0xea)](Boolean))];return _0x22dc47[_0x23d2b6(0x210)]();}}return[];}catch(_0x194207){return _0x703b8c[_0x23d2b6(0x1d4)]['error']('getCalendarNames\x20Error:\x20'+_0x194207[_0x23d2b6(0x107)]),[];}}async function checkWifiPresence(_0x1ac472){const _0x59adb6=a0_0x1a07fc;try{const _0x315b53=_0x1ac472[_0x59adb6(0x195)][_0x59adb6(0x2b4)]||[];let _0x5d3f65=![];const _0x84f357=[];for(const _0x33e0a7 of _0x315b53){try{const _0x25537f=await _0x1ac472[_0x59adb6(0x129)](_0x33e0a7);if(_0x25537f&&(_0x25537f[_0x59adb6(0x24d)]===!![]||_0x25537f[_0x59adb6(0x24d)]===_0x59adb6(0xfb)||_0x25537f[_0x59adb6(0x24d)]===0x1)){_0x5d3f65=!![];const _0x20b2f0=await _0x1ac472[_0x59adb6(0x1a8)](_0x33e0a7);let _0x25e2b7=_0x33e0a7;_0x20b2f0&&_0x20b2f0[_0x59adb6(0x234)]&&_0x20b2f0[_0x59adb6(0x234)][_0x59adb6(0x245)]&&(_0x25e2b7=typeof _0x20b2f0['common'][_0x59adb6(0x245)]===_0x59adb6(0x23b)?_0x20b2f0['common'][_0x59adb6(0x245)]['de']||_0x20b2f0[_0x59adb6(0x234)][_0x59adb6(0x245)]['en']:_0x20b2f0[_0x59adb6(0x234)]['name']),_0x84f357[_0x59adb6(0x1d3)](_0x25e2b7);}}catch(_0x319167){}}return await _0x1ac472[_0x59adb6(0x21c)]('system.presenceWho',{'val':_0x84f357[_0x59adb6(0x14b)](',\x20'),'ack':!![]}),_0x5d3f65&&(_0x1ac472[_0x59adb6(0x205)]&&(_0x1ac472[_0x59adb6(0x1d4)][_0x59adb6(0x26b)](_0x59adb6(0xf1)),abortExitTimer(_0x1ac472)),!_0x1ac472[_0x59adb6(0x2a2)]&&_0x1ac472[_0x59adb6(0xff)]===SYSTEM_MODES[_0x59adb6(0x24e)]&&await setPresence(_0x1ac472,!![])),_0x5d3f65;}catch(_0x3a5be7){return _0x1ac472[_0x59adb6(0x1d4)][_0x59adb6(0x136)](_0x59adb6(0x170)+_0x3a5be7['message']),![];}}function startExitTimer(_0x4f686d){const _0x2b60b2=a0_0x1a07fc;abortExitTimer(_0x4f686d),_0x4f686d[_0x2b60b2(0x1a2)]=!![],_0x4f686d['exitGraceTimer']=setTimeout(()=>{_0x4f686d['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4f686d[_0x2b60b2(0x205)]=setTimeout(()=>{const _0x11e9bb=_0x2b60b2;setPresence(_0x4f686d,![]),_0x4f686d[_0x11e9bb(0x205)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x389e78){const _0x10b838=a0_0x1a07fc;if(_0x389e78[_0x10b838(0x205)])clearTimeout(_0x389e78[_0x10b838(0x205)]);if(_0x389e78[_0x10b838(0x209)])clearTimeout(_0x389e78[_0x10b838(0x209)]);_0x389e78[_0x10b838(0x205)]=null,_0x389e78[_0x10b838(0x209)]=null,_0x389e78[_0x10b838(0x1a2)]=![];}async function setPresence(_0x5b7d47,_0x2ba486){const _0x1fcc9d=a0_0x1a07fc;if(_0x5b7d47['isPresent']===_0x2ba486)return;_0x5b7d47['isPresent']=_0x2ba486,await _0x5b7d47['setStateAsync'](_0x1fcc9d(0x2a6),{'val':_0x2ba486,'ack':!![]});}async function saveFeedback(_0x32cffc,_0x39988a){const _0x12342b=a0_0x1a07fc;_0x32cffc[_0x12342b(0x1d4)][_0x12342b(0x26b)](_0x12342b(0xe8)+JSON[_0x12342b(0x233)](_0x39988a));}async function runBaselineDriftAnalysis(_0x4e3eef){const _0x239eba=a0_0x1a07fc;if(!_0x4e3eef[_0x239eba(0x276)]||!_0x4e3eef[_0x239eba(0x142)])return;const _0x5b77e0=_0x4e3eef[_0x239eba(0x195)][_0x239eba(0x255)]||0xe;if(_0x4e3eef[_0x239eba(0x11c)]['length']<_0x5b77e0+(_0x4e3eef['config'][_0x239eba(0x131)]||0x7)){await _0x4e3eef['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x239eba(0x17b),'ack':!![]});return;}const _0x302b36=_0x4e3eef['dailyDigests'][_0x239eba(0x1a6)](-_0x5b77e0),_0x23f8a2=_0x4e3eef[_0x239eba(0x11c)][_0x239eba(0x1a6)](0x0,_0x4e3eef['dailyDigests']['length']-_0x5b77e0),_0x2eb26b=_0x239eba(0x15d)+JSON[_0x239eba(0x233)](_0x23f8a2)+_0x239eba(0x2b8)+JSON[_0x239eba(0x233)](_0x302b36);try{const _0x672feb=await _0x4e3eef[_0x239eba(0x142)][_0x239eba(0x24b)](_0x2eb26b),_0xce8af4=JSON[_0x239eba(0x1e8)](_0x672feb[_0x239eba(0x20e)][_0x239eba(0x28f)]()[_0x239eba(0x151)](/```json|```/g,'')[_0x239eba(0x2ce)]());_0xce8af4[_0x239eba(0x1ea)]&&(await _0x4e3eef['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0xce8af4['baselineDrift'],'ack':!![]}),await _0x4e3eef[_0x239eba(0x21c)](LTM_DP_DRIFT_DETAILS,{'val':_0xce8af4[_0x239eba(0x201)],'ack':!![]}),await _0x4e3eef[_0x239eba(0x21c)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x239eba(0x150)](),'ack':!![]}));}catch(_0x179220){}}function setupLtmScheduler(_0x2fb185){const _0x1faff4=a0_0x1a07fc;try{if(_0x2fb185[_0x1faff4(0x159)])_0x2fb185[_0x1faff4(0x159)][_0x1faff4(0x27f)]();if(!_0x2fb185['isProVersion']){_0x2fb185['setStateAsync'](LTM_DP_STATUS,{'val':_0x1faff4(0x10f),'ack':!![]});return;}_0x2fb185[_0x1faff4(0x159)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x2fb185));}catch(_0x12ccde){_0x2fb185[_0x1faff4(0x1d4)]['error']('LTM\x20Sched\x20Error:\x20'+_0x12ccde['message']);}}function setupModeResetScheduler(_0x3df5ae){const _0x282217=a0_0x1a07fc;try{if(_0x3df5ae[_0x282217(0x15f)])_0x3df5ae['modeResetJob'][_0x282217(0x27f)]();_0x3df5ae[_0x282217(0x15f)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x175e89=_0x282217;await loadSystemMode(_0x3df5ae),AUTO_RESET_MODES[_0x175e89(0x1a0)](_0x3df5ae[_0x175e89(0xff)])&&await _0x3df5ae[_0x175e89(0x21c)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x175e89(0x24e)],'ack':![]});});}catch(_0x1c2e36){_0x3df5ae['log']['error'](_0x282217(0xc0)+_0x1c2e36['message']);}}function setupDriftAnalysisScheduler(_0x426f4a){const _0x1c93d0=a0_0x1a07fc;try{if(_0x426f4a[_0x1c93d0(0x19c)])clearInterval(_0x426f4a['driftAnalysisTimer']);if(!_0x426f4a[_0x1c93d0(0x276)])return;_0x426f4a[_0x1c93d0(0x19c)]=setInterval(()=>runBaselineDriftAnalysis(_0x426f4a),(_0x426f4a[_0x1c93d0(0x195)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x426f4a),0x1388);}catch(_0x450967){_0x426f4a[_0x1c93d0(0x1d4)]['error'](_0x1c93d0(0x1ab)+_0x450967[_0x1c93d0(0x107)]);}}function setupBriefingScheduler(_0x2b50d5){const _0x20ead6=a0_0x1a07fc;try{if(_0x2b50d5[_0x20ead6(0x24f)])_0x2b50d5['briefingJob']['cancel']();if(!_0x2b50d5['config'][_0x20ead6(0xfa)])return;const _0x387930=(_0x2b50d5['config'][_0x20ead6(0x26c)]||_0x20ead6(0x1f2))['split'](':'),_0x51e67b=parseInt(_0x387930[0x0])||0x8,_0x523a71=parseInt(_0x387930[0x1])||0x0,_0x3a5751=_0x523a71+'\x20'+_0x51e67b+'\x20*\x20*\x20*';_0x2b50d5['log'][_0x20ead6(0x26b)](_0x20ead6(0x291)+_0x51e67b+':'+(_0x523a71<0xa?'0'+_0x523a71:_0x523a71)),_0x2b50d5[_0x20ead6(0x24f)]=schedule['scheduleJob'](_0x3a5751,()=>{sendMorningBriefing(_0x2b50d5);});}catch(_0x3f1f37){_0x2b50d5[_0x20ead6(0x1d4)][_0x20ead6(0x136)](_0x20ead6(0x2bb)+_0x3f1f37[_0x20ead6(0x107)]);}}async function sendNotification(_0x4b89f1,_0x3e5c29,_0x3da52d=![],_0x2e63aa=![]){const _0x20e353=a0_0x1a07fc;_0x4b89f1[_0x20e353(0x1d4)]['info']((_0x3da52d?_0x20e353(0x1f9):'')+_0x20e353(0x182)+_0x3e5c29+'\x22');const _0x38fe60=_0x4b89f1[_0x20e353(0x195)];let _0x430963=0x0;if(_0x38fe60['notifyTelegramEnabled']){let _0x4743ba={};(_0x3e5c29['includes']('Alarm')||_0x2e63aa)&&(_0x4743ba={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':_0x20e353(0x237)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x20e353(0x1f3)}]]}}),await _0x4b89f1['sendToAsync'](_0x38fe60[_0x20e353(0x1d0)],_0x20e353(0x231),{'text':_0x3e5c29,'user':_0x38fe60[_0x20e353(0x1ce)],..._0x4743ba}),_0x430963++;}if(_0x38fe60[_0x20e353(0x17f)]){let _0x23eedf={'message':_0x3e5c29,'title':_0x2e63aa?_0x20e353(0x132):_0x20e353(0x1e5),'priority':_0x2e63aa?0x2:0x1,'device':_0x38fe60[_0x20e353(0x11a)]};_0x2e63aa&&(_0x23eedf[_0x20e353(0x259)]=0x1e,_0x23eedf[_0x20e353(0x128)]=0xe10,_0x23eedf['sound']=_0x20e353(0x2a9)),await _0x4b89f1[_0x20e353(0x109)](_0x38fe60[_0x20e353(0x21f)],_0x20e353(0x231),_0x23eedf),_0x430963++;}return _0x38fe60[_0x20e353(0xcf)]&&(await _0x4b89f1['sendToAsync'](_0x38fe60[_0x20e353(0x212)],_0x20e353(0x231),{'text':_0x3e5c29,'to':_0x38fe60[_0x20e353(0x29a)]}),_0x430963++),_0x430963;}async function setupTelegramListener(_0x29b572){const _0xb61135=a0_0x1a07fc,_0x3b63b9=_0x29b572['config'][_0xb61135(0x1d0)];_0x29b572['config'][_0xb61135(0x1f4)]&&_0x3b63b9&&(_0x29b572[_0xb61135(0x1d4)]['info']('ðŸ“¡\x20Hooking\x20into\x20'+_0x3b63b9+_0xb61135(0x1c3)),await _0x29b572[_0xb61135(0x1d9)](_0x3b63b9+_0xb61135(0x213)));}async function handleTelegramResponse(_0x25a8fb,_0x231db2){const _0x34339=a0_0x1a07fc;let _0x2ea9d0=_0x231db2;_0x231db2['startsWith']('[')&&(_0x2ea9d0=_0x231db2[_0x34339(0x225)](_0x231db2['indexOf'](']')+0x1));if(_0x2ea9d0===_0x34339(0x237))_0x25a8fb['log']['info'](_0x34339(0xe1)),await _0x25a8fb[_0x34339(0x21c)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x25a8fb['setStateAsync'](_0x34339(0x1cd),{'val':_0x34339(0x1a4),'ack':!![]}),_0x25a8fb['lastAlertState']=![],sendNotification(_0x25a8fb,_0x34339(0x24c),![]);else _0x2ea9d0===_0x34339(0x1f3)&&(_0x25a8fb[_0x34339(0x1d4)]['warn'](_0x34339(0x141)),sendNotification(_0x25a8fb,'ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]));}async function runAutopilot(_0x21e659){const _0x4114da=a0_0x1a07fc,_0x116c91=_0x21e659[_0x4114da(0x195)]['inactivityThresholdHours'],_0x258154=_0x21e659[_0x4114da(0x28e)][_0x4114da(0x10b)]>0x0?_0x21e659[_0x4114da(0x28e)][0x0][_0x4114da(0xf8)]:Date[_0x4114da(0x150)](),_0x1577ef=(Date['now']()-_0x258154)/(0x3e8*0x3c*0x3c);let _0x2d42c2='';_0x21e659['config'][_0x4114da(0x19f)]&&_0x21e659[_0x4114da(0xff)]===SYSTEM_MODES['NORMAL']&&_0x21e659[_0x4114da(0x2a2)]&&(_0x1577ef>_0x116c91&&(_0x2d42c2=_0x4114da(0xc9)+_0x1577ef[_0x4114da(0x27d)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0x21e659,_0x2d42c2)[_0x4114da(0x2c0)](_0x13eb6f=>_0x21e659['log'][_0x4114da(0x136)](_0x13eb6f));}async function createDailyDigest(_0x179191){const _0x481298=a0_0x1a07fc;if(!_0x179191['isProVersion'])return;await _0x179191[_0x481298(0x21c)](LTM_DP_STATUS,{'val':_0x481298(0x216)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x179191[_0x481298(0x142)]||_0x179191['rawEventLog'][_0x481298(0x10b)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x179191[_0x481298(0x21c)](LTM_DP_STATUS,{'val':_0x481298(0x1e1),'ack':!![]});return;}const _0x5446e0=JSON[_0x481298(0x1e8)](JSON[_0x481298(0x233)](_0x179191['rawEventLog'])),_0x3d75e8=_0x5446e0['length'],_0x51616b=_0x481298(0x2c6)+JSON['stringify'](_0x5446e0);try{const _0x173f2a=await _0x179191[_0x481298(0x142)][_0x481298(0x24b)](_0x51616b),_0x4f891d=JSON[_0x481298(0x1e8)](_0x173f2a[_0x481298(0x20e)][_0x481298(0x28f)]()[_0x481298(0x151)](/```json|```/g,'')[_0x481298(0x2ce)]());_0x4f891d[_0x481298(0x14a)]&&(_0x179191['dailyDigests'][_0x481298(0x1d3)]({'timestamp':new Date()[_0x481298(0x113)](),'eventCount':_0x3d75e8,'summary':_0x4f891d[_0x481298(0x14a)],'activityLevel':_0x4f891d['activityLevel'],'systemMode':_0x179191[_0x481298(0xff)]}),await saveDailyDigests(_0x179191),_0x179191['rawEventLog']=[],await saveRawEventLog(_0x179191),await _0x179191[_0x481298(0x21c)](LTM_DP_STATUS,{'val':'Success:\x20Compressed\x20'+_0x3d75e8+_0x481298(0xeb),'ack':!![]}),runPythonHealthCheck(_0x179191));}catch(_0x10d326){await _0x179191[_0x481298(0x21c)](LTM_DP_STATUS,{'val':_0x481298(0xdd)+_0x10d326[_0x481298(0x107)],'ack':!![]});}}async function sendMorningBriefing(_0x4daf4a){const _0x3885d8=a0_0x1a07fc;if(!_0x4daf4a[_0x3885d8(0x142)])return;_0x4daf4a[_0x3885d8(0x1d4)][_0x3885d8(0x26b)](_0x3885d8(0xcb));const _0x3e08f2=_0x4daf4a[_0x3885d8(0x11c)][_0x3885d8(0x10b)]>0x0?_0x4daf4a[_0x3885d8(0x11c)][_0x4daf4a[_0x3885d8(0x11c)][_0x3885d8(0x10b)]-0x1]:null,_0xf5ecd8=_0x3e08f2&&_0x3e08f2[_0x3885d8(0x2ca)]?_0x3e08f2[_0x3885d8(0x2ca)][_0x3885d8(0x157)]:_0x3885d8(0x148),_0x5ba25d=new Date();_0x5ba25d[_0x3885d8(0x184)](0x4,0x0,0x0,0x0);const _0xb6b0ee=_0x4daf4a['eventHistory'][_0x3885d8(0xea)](_0x5a5a34=>new Date(_0x5a5a34['timestamp'])>_0x5ba25d),_0x2b5a66=PERSONA_MAPPING[_0x4daf4a[_0x3885d8(0x195)]['aiPersona']||_0x3885d8(0x14d)],_0x17ed92=_0x4daf4a[_0x3885d8(0x195)][_0x3885d8(0x1b0)]||'',_0x43e38d=await getWeatherContext(_0x4daf4a),_0x93e2fc=await getCalendarContext(_0x4daf4a),_0x5ca122=_0x3885d8(0x102)+_0x2b5a66+_0x3885d8(0x227)+_0x17ed92+_0x3885d8(0x215)+_0x43e38d+'\x20'+_0x93e2fc+_0x3885d8(0x21b)+_0xf5ecd8+_0x3885d8(0x1fb)+JSON[_0x3885d8(0x233)](_0xb6b0ee[_0x3885d8(0x1a6)](0x0,0xa))+_0x3885d8(0x2aa);try{const _0x2ea422=await _0x4daf4a[_0x3885d8(0x142)][_0x3885d8(0x24b)](_0x5ca122),_0x5aecce=_0x3885d8(0x1ff)+_0x2ea422[_0x3885d8(0x20e)][_0x3885d8(0x28f)]()[_0x3885d8(0x2ce)]();sendNotification(_0x4daf4a,_0x5aecce),_0x4daf4a[_0x3885d8(0x1d4)][_0x3885d8(0x26b)](_0x3885d8(0x281));}catch(_0x5d05bb){_0x4daf4a[_0x3885d8(0x1d4)]['error']('Briefing\x20Error:\x20'+_0x5d05bb['message']);}}async function scanForDevices(_0x449aa0,_0x5c4169){const _0x3ee06a=a0_0x1a07fc;_0x449aa0[_0x3ee06a(0x1d4)][_0x3ee06a(0x26b)](_0x3ee06a(0x269));const _0x11f8de=[],_0x1f0bdd=await _0x449aa0[_0x3ee06a(0x18a)]('*'),_0x36eaa5=await _0x449aa0[_0x3ee06a(0x18a)](_0x3ee06a(0xd1),_0x3ee06a(0x22c)),_0x2b3350=await _0x449aa0[_0x3ee06a(0x18a)](_0x3ee06a(0x12f),_0x3ee06a(0x22c)),_0x45f131={};if(_0x36eaa5)for(const _0x4f821c in _0x36eaa5){const _0x10669a=_0x36eaa5[_0x4f821c]['common'][_0x3ee06a(0x189)]||[];_0x10669a[_0x3ee06a(0x119)](_0x51f32c=>{const _0xccbbbf=_0x3ee06a;if(!_0x45f131[_0x51f32c])_0x45f131[_0x51f32c]=[];_0x45f131[_0x51f32c][_0xccbbbf(0x1d3)](_0x4f821c);});}const _0x7f7427={};if(_0x2b3350)for(const _0x345215 in _0x2b3350){const _0x211958=_0x2b3350[_0x345215][_0x3ee06a(0x234)]['members']||[],_0x586a96=typeof _0x2b3350[_0x345215]['common'][_0x3ee06a(0x245)]===_0x3ee06a(0x23b)?_0x2b3350[_0x345215]['common'][_0x3ee06a(0x245)]['de']:_0x2b3350[_0x345215]['common'][_0x3ee06a(0x245)];_0x211958[_0x3ee06a(0x119)](_0x50a399=>_0x7f7427[_0x50a399]=_0x586a96);}const _0x2c4998=_0x5c4169[_0x3ee06a(0x1b3)]||[],_0x3d5342=_0x5c4169[_0x3ee06a(0x1e0)]!==![],_0x3c0911=_0x5c4169[_0x3ee06a(0x261)]!==![],_0x183d7a=_0x5c4169[_0x3ee06a(0x16c)]!==![],_0x29b517=_0x5c4169['temperature']===!![],_0x3fb410=_0x5c4169[_0x3ee06a(0x100)]===!![];for(const _0x35b659 in _0x1f0bdd){const _0x270fc9=_0x1f0bdd[_0x35b659];if(_0x270fc9[_0x3ee06a(0x287)]!==_0x3ee06a(0x1b8)||!_0x270fc9[_0x3ee06a(0x234)])continue;if(ADAPTER_BLACKLIST[_0x3ee06a(0x251)](_0x4cf3b7=>_0x35b659[_0x3ee06a(0x2b9)](_0x4cf3b7))&&!_0x3fb410)continue;const _0x22ac07=(_0x270fc9[_0x3ee06a(0x234)][_0x3ee06a(0x145)]||'')[_0x3ee06a(0x1ca)]();let _0x4fe890=(typeof _0x270fc9[_0x3ee06a(0x234)][_0x3ee06a(0x245)]===_0x3ee06a(0x23b)?_0x270fc9[_0x3ee06a(0x234)][_0x3ee06a(0x245)]['de']:_0x270fc9['common'][_0x3ee06a(0x245)])||_0x35b659;const _0x3c51c4=_0x4fe890[_0x3ee06a(0x1ca)]();let _0x342b33=![],_0x476293=![];if(_0x2c4998[_0x3ee06a(0x10b)]>0x0){const _0x2d951c=_0x45f131[_0x35b659]||[],_0x564255=_0x35b659[_0x3ee06a(0x1f0)]('.')[_0x3ee06a(0x1a6)](0x0,-0x1)[_0x3ee06a(0x14b)]('.'),_0x4cd322=_0x45f131[_0x564255]||[];(_0x2d951c['some'](_0x2bc67d=>_0x2c4998[_0x3ee06a(0x1a0)](_0x2bc67d))||_0x4cd322[_0x3ee06a(0x251)](_0x3f3fd9=>_0x2c4998[_0x3ee06a(0x1a0)](_0x3f3fd9)))&&(_0x342b33=!![],_0x476293=!![]);}if(!_0x342b33&&!_0x3fb410){if(HARD_IGNORE_TERMS[_0x3ee06a(0x251)](_0x5b1e0f=>_0x35b659[_0x3ee06a(0x1a0)](_0x5b1e0f)||_0x3c51c4['includes'](_0x5b1e0f[_0x3ee06a(0x1ca)]())))continue;}if(BAD_NAMES[_0x3ee06a(0x251)](_0x388257=>_0x3c51c4===_0x388257||_0x3c51c4[_0x3ee06a(0x11f)]('.'+_0x388257))){const _0x3761f5=_0x35b659[_0x3ee06a(0x1f0)]('.');if(_0x3761f5[_0x3ee06a(0x10b)]>0x2){const _0x2583fb=_0x3761f5['slice'](0x0,-0x1)[_0x3ee06a(0x14b)]('.'),_0x1913dd=_0x1f0bdd[_0x2583fb];if(_0x1913dd&&_0x1913dd[_0x3ee06a(0x234)]&&_0x1913dd[_0x3ee06a(0x234)]['name']){const _0x510f1f=typeof _0x1913dd[_0x3ee06a(0x234)]['name']===_0x3ee06a(0x23b)?_0x1913dd[_0x3ee06a(0x234)][_0x3ee06a(0x245)]['de']:_0x1913dd[_0x3ee06a(0x234)][_0x3ee06a(0x245)];_0x510f1f&&!_0x4fe890[_0x3ee06a(0x1a0)](_0x510f1f)&&(_0x4fe890=_0x510f1f+'\x20'+_0x4fe890);}}}let _0x1d03e5='';if(_0x3d5342&&(_0x22ac07[_0x3ee06a(0x1a0)](_0x3ee06a(0x1e0))||_0x22ac07[_0x3ee06a(0x1a0)]('occupancy')||_0x3c51c4[_0x3ee06a(0x1a0)]('bewegung')||_0x3c51c4[_0x3ee06a(0x1a0)](_0x3ee06a(0x2cb))))_0x1d03e5=_0x3ee06a(0x1e0);else{if(!_0x1d03e5&&_0x3c0911&&(_0x22ac07[_0x3ee06a(0x1a0)](_0x3ee06a(0x1da))||_0x22ac07[_0x3ee06a(0x1a0)](_0x3ee06a(0x242))||_0x22ac07[_0x3ee06a(0x1a0)](_0x3ee06a(0x18b))||_0x22ac07[_0x3ee06a(0x1a0)](_0x3ee06a(0xcc))||_0x22ac07['includes']('shutter')||_0x3c51c4['includes'](_0x3ee06a(0x21d))||_0x3c51c4[_0x3ee06a(0x1a0)]('tÃ¼r')||_0x3c51c4['includes'](_0x3ee06a(0x217))))_0x1d03e5=_0x3ee06a(0x1da);else{if(!_0x1d03e5&&_0x183d7a&&(_0x22ac07[_0x3ee06a(0x1a0)](_0x3ee06a(0xe3))||_0x22ac07['includes'](_0x3ee06a(0x21e))||_0x22ac07[_0x3ee06a(0x1a0)]('dimmer')||_0x3c51c4[_0x3ee06a(0x1a0)](_0x3ee06a(0x1d2))||_0x3c51c4[_0x3ee06a(0x1a0)]('lampe')||_0x3c51c4[_0x3ee06a(0x1a0)](_0x3ee06a(0x1ad)))){if(_0x270fc9[_0x3ee06a(0x234)][_0x3ee06a(0x20f)]||_0x22ac07[_0x3ee06a(0x1a0)]('sensor'))_0x1d03e5=_0x3ee06a(0xe3);}else{if(!_0x1d03e5&&_0x29b517&&(_0x22ac07[_0x3ee06a(0x1a0)]('temperature')||_0x22ac07[_0x3ee06a(0x1a0)]('humidity')||_0x22ac07[_0x3ee06a(0x1a0)]('thermostat')||_0x3c51c4[_0x3ee06a(0x1a0)](_0x3ee06a(0x2ac))||_0x3c51c4[_0x3ee06a(0x1a0)](_0x3ee06a(0xda))||_0x3c51c4['includes']('heizung')))_0x1d03e5=_0x3ee06a(0x292);else{if(!_0x1d03e5&&_0x476293)_0x1d03e5=_0x3ee06a(0x1b9);}}}}if(_0x1d03e5){let _0x12656e=_0x7f7427[_0x35b659]||'';if(!_0x12656e){let _0x399280=_0x35b659;for(let _0x49350e=0x0;_0x49350e<0x3;_0x49350e++){const _0x45d487=_0x399280[_0x3ee06a(0xe2)]('.');if(_0x45d487===-0x1)break;_0x399280=_0x399280[_0x3ee06a(0x225)](0x0,_0x45d487);if(_0x7f7427[_0x399280]){_0x12656e=_0x7f7427[_0x399280];break;}}}_0x11f8de[_0x3ee06a(0x1d3)]({'id':_0x35b659,'name':_0x4fe890,'location':_0x12656e,'type':_0x1d03e5,'logDuplicates':_0x1d03e5===_0x3ee06a(0x1e0),'isExit':![],'_score':_0x12656e?0x50:_0x1d03e5==='custom'?0x5a:0x28});}}return _0x11f8de[_0x3ee06a(0x210)]((_0x5756bf,_0x3ec487)=>_0x3ec487[_0x3ee06a(0x15c)]-_0x5756bf['_score']),_0x11f8de;}async function executeAutomationAction(_0x200f37){const _0x3a711f=a0_0x1a07fc;try{const _0x33779b=await _0x200f37[_0x3a711f(0x1a3)](_0x3a711f(0x204)),_0x4901db=await _0x200f37[_0x3a711f(0x1a3)](_0x3a711f(0x149));if(_0x33779b&&_0x33779b[_0x3a711f(0x24d)]&&_0x4901db){const _0x5a742d=_0x33779b['val'];let _0x3843ee=_0x4901db[_0x3a711f(0x24d)];try{_0x3843ee=JSON[_0x3a711f(0x1e8)](_0x3843ee);}catch(_0x5e7c18){}_0x200f37[_0x3a711f(0x1d4)]['info'](_0x3a711f(0xf2)+_0x5a742d+_0x3a711f(0x1b6)+_0x3843ee),await _0x200f37[_0x3a711f(0x120)](_0x5a742d,_0x3843ee);}else _0x200f37['log'][_0x3a711f(0x2a4)](_0x3a711f(0x152));}catch(_0x101fb2){_0x200f37['log'][_0x3a711f(0x136)](_0x3a711f(0x1ee)+_0x101fb2[_0x3a711f(0x107)]);}}function tryParse(_0x595dc5){try{return JSON['parse'](_0x595dc5);}catch(_0x192bf4){return null;}}async function recordSequence(_0x2eab9c,_0x2e4a28){const _0x407e92=a0_0x1a07fc,_0xc1e8e=(_0x2e4a28[_0x407e92(0x287)]||'')['toLowerCase'](),_0x263362=['motion','bewegung',_0x407e92(0x2cb),_0x407e92(0xee),_0x407e92(0xe0),_0x407e92(0x1da),'tÃ¼r',_0x407e92(0x242),_0x407e92(0x21d),_0x407e92(0x252),'kontakt',_0x407e92(0xe3),_0x407e92(0x1d2),_0x407e92(0x21e),_0x407e92(0x1ad),'dimmer','lampe'];if(!_0x263362[_0x407e92(0x251)](_0x1dc4b=>_0xc1e8e[_0x407e92(0x1a0)](_0x1dc4b))){_0x2eab9c[_0x407e92(0x1d4)][_0x407e92(0x14c)](_0x407e92(0x1f8)+_0x2e4a28['id']+_0x407e92(0x1fa)+_0x2e4a28[_0x407e92(0x287)]+'\x27\x20not\x20in\x20allowed\x20list)');return;}if(!_0x2e4a28[_0x407e92(0x235)]){_0x2eab9c['log'][_0x407e92(0x14c)](_0x407e92(0x1f8)+_0x2e4a28['id']+_0x407e92(0x211)+_0x2e4a28['value']+')');return;}_0x2eab9c[_0x407e92(0x1d4)][_0x407e92(0x14c)]('[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20'+_0x2e4a28['id']+'\x20('+_0x2e4a28['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x1bcd61={'loc':_0x2e4a28[_0x407e92(0x19b)]||_0x407e92(0x29c),'id':_0x2e4a28['id'],'ts':Date['now']()};activeSequence[_0x407e92(0x1d3)](_0x1bcd61),_0x2eab9c[_0x407e92(0x1d4)][_0x407e92(0x14c)](_0x407e92(0x1a5)+_0x1bcd61[_0x407e92(0x1fc)]+_0x407e92(0x17e)+activeSequence[_0x407e92(0x10b)]+')'),sequenceTimer=setTimeout(async()=>{const _0x18f491=_0x407e92;activeSequence['length']>0x1?await saveCompletedSequence(_0x2eab9c):(_0x2eab9c[_0x18f491(0x1d4)][_0x18f491(0x14c)](_0x18f491(0x2c4)+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x57e474){const _0x1790fc=a0_0x1a07fc;try{_0x57e474[_0x1790fc(0x1d4)]['info'](_0x1790fc(0x118)+activeSequence[_0x1790fc(0x10b)]+').\x20Saving\x20to\x20Training\x20Data.');const _0x4b02c0=await _0x57e474[_0x1790fc(0x1a3)](_0x1790fc(0x273));let _0x12e103=[];if(_0x4b02c0&&_0x4b02c0['val'])try{_0x12e103=JSON['parse'](_0x4b02c0['val']);}catch(_0x2db78f){}const _0x3bbc78=activeSequence[0x0]['ts'],_0x12ff3f=activeSequence[_0x1790fc(0x147)](_0x15bd6f=>({'loc':_0x15bd6f['loc'],'t_delta':Math['round']((_0x15bd6f['ts']-_0x3bbc78)/0x3e8)})),_0x2c4576={'timestamp':new Date(_0x3bbc78)[_0x1790fc(0x113)](),'steps':_0x12ff3f,'duration':Math['round']((activeSequence[activeSequence[_0x1790fc(0x10b)]-0x1]['ts']-_0x3bbc78)/0x3e8),'daytime':new Date(_0x3bbc78)[_0x1790fc(0x16d)]()};_0x12e103[_0x1790fc(0x1d3)](_0x2c4576),_0x12e103[_0x1790fc(0x10b)]>MAX_TRAINING_SET_SIZE&&_0x12e103[_0x1790fc(0x1f5)](),await _0x57e474[_0x1790fc(0x21c)](_0x1790fc(0x273),{'val':JSON[_0x1790fc(0x233)](_0x12e103),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x2577c6){_0x57e474[_0x1790fc(0x1d4)][_0x1790fc(0x136)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x2577c6[_0x1790fc(0x107)]);}}async function getOutsideTemperatureNumeric(_0x2c4218){const _0x3cd4ef=a0_0x1a07fc;if(_0x2c4218[_0x3cd4ef(0x195)][_0x3cd4ef(0x29e)])try{const _0x21e42d=await _0x2c4218[_0x3cd4ef(0x129)](_0x2c4218['config'][_0x3cd4ef(0x29e)]);if(_0x21e42d&&_0x21e42d[_0x3cd4ef(0x24d)]!==undefined&&_0x21e42d['val']!==null){const _0x3a5d74=parseFloat(_0x21e42d[_0x3cd4ef(0x24d)]);if(!isNaN(_0x3a5d74))return _0x3a5d74;}}catch(_0x1cf7ed){_0x2c4218[_0x3cd4ef(0x1d4)][_0x3cd4ef(0x2a4)](_0x3cd4ef(0x2cd)+_0x2c4218[_0x3cd4ef(0x195)][_0x3cd4ef(0x29e)]+':\x20'+_0x1cf7ed[_0x3cd4ef(0x107)]);}const _0x371571=_0x2c4218[_0x3cd4ef(0x195)][_0x3cd4ef(0x1d5)];if(!_0x2c4218[_0x3cd4ef(0x195)][_0x3cd4ef(0x199)]||!_0x371571)return null;try{let _0x3c916a='';if(_0x371571[_0x3cd4ef(0x1a0)](_0x3cd4ef(0x1ba)))_0x3c916a=_0x371571+_0x3cd4ef(0x172);else{if(_0x371571[_0x3cd4ef(0x1a0)](_0x3cd4ef(0xfe)))_0x3c916a=_0x371571+_0x3cd4ef(0x18d);else{if(_0x371571[_0x3cd4ef(0x1a0)](_0x3cd4ef(0x238)))_0x3c916a=_0x371571+_0x3cd4ef(0x1e9);else{if(_0x371571[_0x3cd4ef(0x1a0)](_0x3cd4ef(0x186)))_0x3c916a=_0x371571+_0x3cd4ef(0x1ec);}}}if(_0x3c916a){const _0x41a5d9=await _0x2c4218[_0x3cd4ef(0x129)](_0x3c916a);if(_0x41a5d9&&_0x41a5d9[_0x3cd4ef(0x24d)]!==undefined&&_0x41a5d9[_0x3cd4ef(0x24d)]!==null)return parseFloat(_0x41a5d9[_0x3cd4ef(0x24d)]);}}catch(_0x22806a){}return null;}async function recordThermodynamics(_0x54566d,_0x43f286,_0x5b4a01,_0x1a5c6c){const _0x2fc70e=a0_0x1a07fc,_0x5250c2=await getOutsideTemperatureNumeric(_0x54566d),_0xba5a95=await _0x54566d[_0x2fc70e(0x1a3)](_0x2fc70e(0x11d));let _0x1f2ff4=[];if(_0xba5a95&&_0xba5a95[_0x2fc70e(0x24d)])try{_0x1f2ff4=JSON[_0x2fc70e(0x1e8)](_0xba5a95[_0x2fc70e(0x24d)]);}catch(_0x2a9131){}_0x1f2ff4[_0x2fc70e(0x1d3)]({'ts':Date[_0x2fc70e(0x150)](),'room':_0x1a5c6c||_0x2fc70e(0x29c),'t_in':_0x5b4a01,'t_out':_0x5250c2});if(_0x1f2ff4[_0x2fc70e(0x10b)]>THERMO_LOG_SIZE)_0x1f2ff4[_0x2fc70e(0x1f5)]();await _0x54566d[_0x2fc70e(0x21c)](_0x2fc70e(0x11d),{'val':JSON[_0x2fc70e(0x233)](_0x1f2ff4),'ack':!![]});}function installPythonDependencies(_0x4c639b){const _0x3a3a55=a0_0x1a07fc;if(_0x4c639b[_0x3a3a55(0x200)])return;_0x4c639b['dependencyInstallInProgress']=!![];const _0x5c52bf=path[_0x3a3a55(0x14b)](__dirname,_0x3a3a55(0x16f),_0x3a3a55(0x254));_0x4c639b[_0x3a3a55(0x1d4)][_0x3a3a55(0x26b)](_0x3a3a55(0x191)+_0x5c52bf+_0x3a3a55(0x288)),stopPythonService(_0x4c639b);const _0x2c88ce='python3\x20-m\x20pip\x20install\x20-r\x20\x22'+_0x5c52bf+_0x3a3a55(0xc6);exec(_0x2c88ce,(_0x1bbe44,_0x474f4f,_0x316e7f)=>{const _0x457ae9=_0x3a3a55,_0x2f6adc=_0x316e7f&&_0x316e7f[_0x457ae9(0x1a0)](_0x457ae9(0x18f))||_0x1bbe44&&_0x1bbe44[_0x457ae9(0x107)][_0x457ae9(0x1a0)](_0x457ae9(0x18f));if(_0x2f6adc){_0x4c639b[_0x457ae9(0x1d4)][_0x457ae9(0x2a4)](_0x457ae9(0x2c7)),exec(_0x457ae9(0x1de),(_0x474eb7,_0x487362,_0x38eff0)=>{const _0x46eca9=_0x457ae9;_0x474eb7?(_0x4c639b['log'][_0x46eca9(0x136)]('âŒ\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.'),_0x4c639b['log'][_0x46eca9(0x136)](_0x46eca9(0x284)),_0x4c639b[_0x46eca9(0x200)]=![]):(_0x4c639b[_0x46eca9(0x1d4)]['info'](_0x46eca9(0x144)),exec(_0x46eca9(0x17a)+_0x5c52bf+_0x46eca9(0x2a0),(_0x4cc1a7,_0x3bbce4,_0x3b06f3)=>{const _0x458334=_0x46eca9;_0x4cc1a7?_0x4c639b[_0x458334(0x1d4)]['error'](_0x458334(0x105)+_0x4cc1a7[_0x458334(0x107)]):(_0x4c639b['log']['info'](_0x458334(0x185)),startPythonService(_0x4c639b)),_0x4c639b[_0x458334(0x200)]=![];}));});return;}_0x4c639b[_0x457ae9(0x200)]=![],_0x1bbe44?(_0x4c639b[_0x457ae9(0x1d4)][_0x457ae9(0x136)](_0x457ae9(0x26a)),_0x4c639b[_0x457ae9(0x1d4)][_0x457ae9(0x136)]('Details:\x20'+(_0x316e7f||_0x1bbe44[_0x457ae9(0x107)]))):(_0x4c639b[_0x457ae9(0x1d4)][_0x457ae9(0x26b)](_0x457ae9(0x232)),startPythonService(_0x4c639b));});}async function processSensorEvent(_0xfc1b8,_0x241b4d,_0x335c88,_0x67373f){const _0x19fbce=a0_0x1a07fc;if(!_0x67373f)return;const _0x206b08=_0x335c88[_0x19fbce(0x24d)],_0x561abe=Date['now']();_0xfc1b8[_0x19fbce(0x1d4)]['debug'](_0x19fbce(0xfc)+_0x241b4d+'\x20=\x20'+_0x206b08);const _0x396e84=_0xfc1b8['sensorLastValues'][_0x241b4d];_0xfc1b8[_0x19fbce(0x265)][_0x241b4d]=_0x206b08;if(!_0x67373f[_0x19fbce(0x16b)]&&_0x396e84!=undefined&&_0x396e84==_0x206b08){_0xfc1b8['log']['debug']('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x67373f[_0x19fbce(0x245)]+_0x19fbce(0x1e3)+_0x206b08+')');return;}const _0x3d10f4=(_0x67373f['type']||'')[_0x19fbce(0x1ca)](),_0x540684=_0x3d10f4[_0x19fbce(0x1a0)](_0x19fbce(0x292))||_0x3d10f4[_0x19fbce(0x1a0)]('temperatur')||_0x3d10f4[_0x19fbce(0x1a0)]('klima')||_0x3d10f4[_0x19fbce(0x1a0)](_0x19fbce(0x236));_0xfc1b8['isProVersion']&&_0x540684&&recordThermodynamics(_0xfc1b8,_0x241b4d,_0x206b08,_0x67373f[_0x19fbce(0x19b)]);const _0x4983e7={'timestamp':_0x561abe,'id':_0x241b4d,'name':_0x67373f[_0x19fbce(0x245)],'type':_0x67373f[_0x19fbce(0x287)],'location':_0x67373f[_0x19fbce(0x19b)],'value':_0x206b08};_0xfc1b8['eventHistory']['unshift'](_0x4983e7);if(_0xfc1b8['eventHistory']['length']>HISTORY_MAX_SIZE)_0xfc1b8[_0x19fbce(0x28e)][_0x19fbce(0x177)]();await _0xfc1b8['setStateAsync']('events.lastEvent',{'val':JSON[_0x19fbce(0x233)](_0x4983e7),'ack':!![]}),await _0xfc1b8[_0x19fbce(0x21c)](_0x19fbce(0x1d8),{'val':JSON['stringify'](_0xfc1b8[_0x19fbce(0x28e)]),'ack':!![]});_0xfc1b8['isProVersion']&&(_0xfc1b8['rawEventLog']['push'](_0x4983e7),await saveRawEventLog(_0xfc1b8),recordSequence(_0xfc1b8,_0x4983e7));if(_0x67373f[_0x19fbce(0xf9)]&&_0x206b08===!![]){if(_0xfc1b8[_0x19fbce(0x2a2)]&&!_0xfc1b8[_0x19fbce(0x1a2)])_0xfc1b8[_0x19fbce(0x1d4)]['info'](_0x19fbce(0x133)+_0x67373f[_0x19fbce(0x245)]+').\x20Starting\x20Timer.'),startExitTimer(_0xfc1b8);else!_0xfc1b8[_0x19fbce(0x2a2)]&&(_0xfc1b8[_0x19fbce(0x1d4)][_0x19fbce(0x26b)]('Entry\x20detected\x20via\x20'+_0x67373f[_0x19fbce(0x245)]+'.\x20Welcome\x20home.'),await setPresence(_0xfc1b8,!![]));}else _0x67373f[_0x19fbce(0x287)]===_0x19fbce(0x1e0)&&_0x206b08===!![]&&(_0xfc1b8['exitTimer']&&(_0xfc1b8[_0x19fbce(0x1d4)][_0x19fbce(0x26b)]('Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.'),abortExitTimer(_0xfc1b8)),!_0xfc1b8[_0x19fbce(0x2a2)]&&_0xfc1b8[_0x19fbce(0xff)]===SYSTEM_MODES[_0x19fbce(0x24e)]&&await setPresence(_0xfc1b8,!![]));}async function runGeminiAnalysis(_0x48a69d,_0x442473=''){const _0x420ffa=a0_0x1a07fc;if(!_0x48a69d[_0x420ffa(0x142)])return;if(_0x48a69d['eventHistory'][_0x420ffa(0x10b)]===0x0)return;const _0x45d076=_0x48a69d['eventHistory'][_0x420ffa(0x1a6)](0x0,0xf),_0x2fc86a=await getWeatherContext(_0x48a69d),_0x3a2719=_0x48a69d[_0x420ffa(0xff)],_0x353584=PERSONA_MAPPING[_0x48a69d[_0x420ffa(0x195)][_0x420ffa(0x263)]||_0x420ffa(0x14d)],_0x18a180=_0x48a69d[_0x420ffa(0x195)][_0x420ffa(0x1b0)]||'Keine\x20Details.';let _0x523d29=![];try{const _0x4f1ca2=await _0x48a69d[_0x420ffa(0x1a3)](_0x420ffa(0x1fe));if(_0x4f1ca2&&_0x4f1ca2['val'])_0x523d29=!![];}catch(_0x378dc5){}const _0x37f950='\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20'+_0x353584+_0x420ffa(0x198)+_0x18a180+_0x420ffa(0x2ae)+_0x3a2719+_0x420ffa(0x103)+_0x2fc86a+_0x420ffa(0x207)+(_0x442473||_0x420ffa(0xed))+'.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20'+JSON[_0x420ffa(0x233)](_0x45d076)+_0x420ffa(0x17d);try{const _0x576cae=await _0x48a69d['geminiModel'][_0x420ffa(0x24b)](_0x37f950),_0x358758=_0x576cae[_0x420ffa(0x20e)][_0x420ffa(0x28f)]()['replace'](/```json|```/g,'')['trim'](),_0x1e1b17=JSON[_0x420ffa(0x1e8)](_0x358758);await _0x48a69d[_0x420ffa(0x21c)]('analysis.lastResult',{'val':JSON['stringify'](_0x1e1b17),'ack':!![]});_0x1e1b17[_0x420ffa(0x14a)]&&await _0x48a69d['setStateAsync'](_0x420ffa(0x202),{'val':_0x1e1b17['summary'],'ack':!![]});const _0x22d421={'timestamp':Date[_0x420ffa(0x150)](),'id':Date[_0x420ffa(0x150)]()[_0x420ffa(0x1b7)](),'analysis':{'activity':{'summary':_0x1e1b17[_0x420ffa(0x14a)]||_0x420ffa(0x13b),'isAlert':_0x1e1b17[_0x420ffa(0x166)]||![],'alertReason':_0x1e1b17[_0x420ffa(0x169)]},'comfort':{'automationProposal':_0x1e1b17['automationProposal']}}};await updateAnalysisHistory(_0x48a69d,_0x22d421);const _0x194afd=_0x1e1b17[_0x420ffa(0x166)]||![];_0x194afd!==_0x48a69d[_0x420ffa(0xcd)]&&(await _0x48a69d[_0x420ffa(0x21c)](_0x420ffa(0x218),{'val':_0x194afd,'ack':!![]}),_0x48a69d[_0x420ffa(0xcd)]=_0x194afd,_0x194afd&&(await _0x48a69d[_0x420ffa(0x21c)](_0x420ffa(0x1cd),{'val':_0x1e1b17[_0x420ffa(0x169)],'ack':!![]}),sendNotification(_0x48a69d,'âš ï¸\x20ALARM:\x20'+_0x1e1b17[_0x420ffa(0x169)],![],_0x1e1b17[_0x420ffa(0x2bd)]))),_0x1e1b17[_0x420ffa(0x101)]&&_0x1e1b17[_0x420ffa(0x101)][_0x420ffa(0x1af)]&&_0x1e1b17['automationProposal'][_0x420ffa(0x220)]&&(_0x48a69d[_0x420ffa(0x1d4)][_0x420ffa(0x26b)]('ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20'+_0x1e1b17[_0x420ffa(0x101)][_0x420ffa(0x27e)]),await _0x48a69d['setStateAsync'](_0x420ffa(0x19e),{'val':!![],'ack':!![]}),await _0x48a69d[_0x420ffa(0x21c)]('analysis.automation.description',{'val':_0x1e1b17[_0x420ffa(0x101)]['description'],'ack':!![]}),await _0x48a69d[_0x420ffa(0x21c)](_0x420ffa(0x204),{'val':_0x1e1b17[_0x420ffa(0x101)][_0x420ffa(0x220)],'ack':!![]}),await _0x48a69d[_0x420ffa(0x21c)]('analysis.automation.targetValue',{'val':JSON[_0x420ffa(0x233)](_0x1e1b17['automationProposal'][_0x420ffa(0x1ef)]),'ack':!![]}),_0x523d29&&(_0x48a69d['log'][_0x420ffa(0x26b)](_0x420ffa(0xd8)+_0x1e1b17[_0x420ffa(0x101)][_0x420ffa(0x220)]+'...'),await executeAutomationAction(_0x48a69d)));}catch(_0x4a99da){_0x48a69d['log']['error'](_0x420ffa(0x1aa)+_0x4a99da[_0x420ffa(0x107)]);}}function sendToPython(_0x534215,_0xc8e4a7,_0x48f8c8={}){const _0x25fd61=a0_0x1a07fc;if(!_0x534215[_0x25fd61(0x2ad)]||!_0x534215[_0x25fd61(0x2ad)][_0x25fd61(0xe4)][_0x25fd61(0x126)])return;const _0x154139=JSON[_0x25fd61(0x233)]({'command':_0xc8e4a7,..._0x48f8c8});try{_0x534215['pythonProcess']['stdin'][_0x25fd61(0x20f)](_0x154139+'\x0a');}catch(_0xf87aa1){_0x534215[_0x25fd61(0x1d4)][_0x25fd61(0x136)](_0x25fd61(0x296)+_0xf87aa1['message']);}}function runPythonHealthCheck(_0x64cc65){const _0x3dae37=a0_0x1a07fc;if(!_0x64cc65[_0x3dae37(0x11c)]||_0x64cc65[_0x3dae37(0x11c)][_0x3dae37(0x10b)]<0x2){_0x64cc65[_0x3dae37(0x1d4)][_0x3dae37(0x26b)](_0x3dae37(0xbf));return;}const _0x2da124=_0x64cc65[_0x3dae37(0x11c)][_0x3dae37(0x147)](_0x3eba09=>{const _0x368304=_0x3dae37,_0x104ea2=(_0x3eba09[_0x368304(0xd2)]||'')[_0x368304(0x1ca)]();return ACTIVITY_LEVEL_MAP[_0x104ea2]||0x32;});_0x64cc65['log'][_0x3dae37(0x26b)](_0x3dae37(0x2a1)+_0x2da124[_0x3dae37(0x10b)]+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x64cc65,_0x3dae37(0x224),{'values':_0x2da124,'tag':_0x3dae37(0x23c)});}function handlePythonResult(_0x40f559,_0x3ebb74){const _0xe83167=a0_0x1a07fc;if(_0x3ebb74[_0xe83167(0x287)]==='PONG')_0x40f559[_0xe83167(0x1d4)][_0xe83167(0x14c)](_0xe83167(0xe7));else{if(_0x3ebb74[_0xe83167(0x287)]===_0xe83167(0x174)){const {tag:_0x65c04,diagnosis:_0x28471a,change_percent:_0x18da63}=_0x3ebb74[_0xe83167(0x1fd)];_0x40f559[_0xe83167(0x1d4)][_0xe83167(0x26b)](_0xe83167(0x1cf)+_0x65c04+_0xe83167(0xdc)+_0x28471a+'\x20('+_0x18da63+'%)'),_0x40f559['setStateAsync']('analysis.health.trendDiagnosis',{'val':_0x28471a,'ack':!![]}),_0x40f559['setStateAsync'](_0xe83167(0x15e),{'val':_0x18da63,'ack':!![]});}}}function startPythonService(_0xba4b7c){const _0x4efc95=a0_0x1a07fc;try{const _0x389cea=path[_0x4efc95(0x14b)](__dirname,_0x4efc95(0x16f),_0x4efc95(0x1dd));_0xba4b7c['log']['info'](_0x4efc95(0x1ed)+_0x389cea),_0xba4b7c['pythonProcess']=spawn(_0x4efc95(0x278),[_0x389cea]),_0xba4b7c[_0x4efc95(0x2ad)]['stdout']['on'](_0x4efc95(0x28c),_0x57d673=>{const _0x3f7306=_0x4efc95,_0x2bcb38=_0x57d673[_0x3f7306(0x1b7)]()[_0x3f7306(0x1f0)]('\x0a');_0x2bcb38['forEach'](_0xe1b126=>{const _0x38829f=_0x3f7306,_0x1d5f3d=_0xe1b126['trim']();if(!_0x1d5f3d)return;if(_0x1d5f3d[_0x38829f(0x2b9)](_0x38829f(0xbc)))_0xba4b7c[_0x38829f(0x1d4)][_0x38829f(0x14c)](_0x38829f(0x12c)+_0x1d5f3d[_0x38829f(0x225)](0x5)['trim']());else{if(_0x1d5f3d[_0x38829f(0x2b9)](_0x38829f(0x116)))try{const _0x2bd986=JSON['parse'](_0x1d5f3d[_0x38829f(0x225)](0x8)['trim']());handlePythonResult(_0xba4b7c,_0x2bd986);}catch(_0x7c84be){_0xba4b7c['log'][_0x38829f(0x2a4)](_0x38829f(0x1c2)+_0x1d5f3d);}}(_0x1d5f3d[_0x38829f(0x1a0)]('No\x20module\x20named')||_0x1d5f3d[_0x38829f(0x1a0)](_0x38829f(0x155))||_0x1d5f3d[_0x38829f(0x1a0)](_0x38829f(0x139)))&&(_0xba4b7c[_0x38829f(0x1d4)][_0x38829f(0x2a4)](_0x38829f(0x28d)),installPythonDependencies(_0xba4b7c));});}),_0xba4b7c[_0x4efc95(0x2ad)][_0x4efc95(0xd6)]['on']('data',_0x1bf7c0=>{const _0x38942c=_0x4efc95,_0x1346bb=_0x1bf7c0['toString']()['trim']();_0xba4b7c[_0x38942c(0x1d4)]['error'](_0x38942c(0x1a9)+_0x1346bb);}),_0xba4b7c['pythonProcess']['on'](_0x4efc95(0x293),_0x420c6e=>{const _0x2de715=_0x4efc95;_0xba4b7c[_0x2de715(0x1d4)][_0x2de715(0x26b)](_0x2de715(0x27c)+_0x420c6e),_0xba4b7c['pythonProcess']=null;}),_0xba4b7c[_0x4efc95(0x2ad)]['on'](_0x4efc95(0x136),_0x4344b3=>{const _0x51d172=_0x4efc95;_0xba4b7c['log'][_0x51d172(0x2a4)]('[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20'+_0x4344b3[_0x51d172(0x107)]);});}catch(_0x50e866){_0xba4b7c[_0x4efc95(0x1d4)][_0x4efc95(0x136)](_0x4efc95(0x1c1)+_0x50e866[_0x4efc95(0x107)]);}}function stopPythonService(_0x364c08){const _0xbeae07=a0_0x1a07fc;if(_0x364c08[_0xbeae07(0x2ad)]){_0x364c08['log'][_0xbeae07(0x26b)](_0xbeae07(0x123));try{_0x364c08[_0xbeae07(0x2ad)][_0xbeae07(0xdb)]();}catch(_0x352130){_0x364c08[_0xbeae07(0x1d4)][_0xbeae07(0x2a4)](_0xbeae07(0x19a)+_0x352130[_0xbeae07(0x107)]);}_0x364c08[_0xbeae07(0x2ad)]=null;}}class CogniLiving extends utils['Adapter']{constructor(_0x3e2705){const _0x374089=a0_0x1a07fc;super({..._0x3e2705,'name':_0x374089(0x12b)}),this[_0x374089(0x28e)]=[],this[_0x374089(0x112)]=[],this[_0x374089(0x262)]=[],this[_0x374089(0x183)]=[],this['dailyDigests']=[],this['sensorLastValues']={},this[_0x374089(0x23a)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x374089(0x205)]=null,this[_0x374089(0x209)]=null,this['isGracePeriodActive']=![],this[_0x374089(0x283)]=null,this[_0x374089(0x142)]=null,this[_0x374089(0xff)]=SYSTEM_MODES[_0x374089(0x24e)],this['isProVersion']=![],this['lastAlertState']=![],this[_0x374089(0x27b)]='unknown',this['analysisTimer']=null,this[_0x374089(0x159)]=null,this[_0x374089(0x15f)]=null,this[_0x374089(0x19c)]=null,this[_0x374089(0x24f)]=null,this[_0x374089(0x2ad)]=null,this[_0x374089(0x200)]=![],this['on'](_0x374089(0x20c),this[_0x374089(0x223)]['bind'](this)),this['on'](_0x374089(0x12a),this[_0x374089(0x2c9)][_0x374089(0x143)](this)),this['on']('unload',this[_0x374089(0x229)][_0x374089(0x143)](this)),this['on'](_0x374089(0x107),this[_0x374089(0x1c8)][_0x374089(0x143)](this));}async[a0_0x1a07fc(0x223)](){const _0x1ef5cb=a0_0x1a07fc;this['log']['info']('cogni-living\x20adapter\x20starting\x20(v'+this[_0x1ef5cb(0x10d)]+_0x1ef5cb(0x1ac)),await initZombies(this),this['config'][_0x1ef5cb(0x1a7)]=this[_0x1ef5cb(0x195)][_0x1ef5cb(0x1a7)]||'';try{this[_0x1ef5cb(0x276)]=await checkLicense(this,this[_0x1ef5cb(0x195)]['licenseKey']);}catch(_0x20b3f5){}this[_0x1ef5cb(0x1d4)]['info'](_0x1ef5cb(0xd3)+!!this[_0x1ef5cb(0x195)][_0x1ef5cb(0x1a7)]+_0x1ef5cb(0x277)+(this['isProVersion']?_0x1ef5cb(0x196):_0x1ef5cb(0x1be)));if(!this['config'][_0x1ef5cb(0xbe)]||this['config'][_0x1ef5cb(0xbe)]<0.1)this[_0x1ef5cb(0x195)][_0x1ef5cb(0xbe)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config']['geminiApiKey'])try{this[_0x1ef5cb(0x283)]=new GoogleGenerativeAI(this['config'][_0x1ef5cb(0xc8)]),this[_0x1ef5cb(0x142)]=this['genAI'][_0x1ef5cb(0x197)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x1ef5cb(0x1d4)][_0x1ef5cb(0x26b)](_0x1ef5cb(0xd4));}catch(_0xbf6654){this[_0x1ef5cb(0x1d4)]['error'](_0x1ef5cb(0x1a1)+_0xbf6654[_0x1ef5cb(0x107)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates'](_0x1ef5cb(0x140)),this[_0x1ef5cb(0x1ae)](LTM_DP_TRIGGER_DIGEST),this[_0x1ef5cb(0x1ae)](_0x1ef5cb(0x2b2)),this[_0x1ef5cb(0x1ae)](_0x1ef5cb(0x127)),this[_0x1ef5cb(0x1ae)](_0x1ef5cb(0x117)),this[_0x1ef5cb(0x1ae)](_0x1ef5cb(0x1fe)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x1ef5cb(0xf6)])clearInterval(this[_0x1ef5cb(0xf6)]);const _0x1829c3=this['config'][_0x1ef5cb(0x22b)]||0xf;_0x1829c3>0x0&&(this[_0x1ef5cb(0x1d4)][_0x1ef5cb(0x26b)](_0x1ef5cb(0xc2)+_0x1829c3+_0x1ef5cb(0x135)),this[_0x1ef5cb(0xf6)]=setInterval(()=>{runAutopilot(this);},_0x1829c3*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x27ed0b=_0x1ef5cb;this[_0x27ed0b(0x2ad)]&&runPythonHealthCheck(this);},0x1388);}['onUnload'](_0x12f8bf){const _0x41e506=a0_0x1a07fc;if(this[_0x41e506(0xf6)])clearInterval(this['analysisTimer']);if(this[_0x41e506(0x19c)])clearInterval(this[_0x41e506(0x19c)]);if(this[_0x41e506(0x159)])this['ltmJob'][_0x41e506(0x27f)]();if(this[_0x41e506(0x15f)])this['modeResetJob'][_0x41e506(0x27f)]();if(this[_0x41e506(0x24f)])this[_0x41e506(0x24f)]['cancel']();if(this[_0x41e506(0x205)])clearTimeout(this[_0x41e506(0x205)]);if(this[_0x41e506(0x209)])clearTimeout(this[_0x41e506(0x209)]);stopPythonService(this),_0x12f8bf();}async[a0_0x1a07fc(0x2c9)](_0x111d78,_0x1b67d3){const _0x1cad4b=a0_0x1a07fc;if(!_0x1b67d3)return;if(_0x111d78['includes'](_0x1cad4b(0x1b2))&&_0x111d78[_0x1cad4b(0x11f)](_0x1cad4b(0x266))&&_0x1b67d3[_0x1cad4b(0x24d)]){await handleTelegramResponse(this,_0x1b67d3[_0x1cad4b(0x24d)]);return;}if(_0x111d78===this[_0x1cad4b(0x28a)]+'.'+SYSTEM_DP_MODE){_0x1b67d3['val']&&Object[_0x1cad4b(0x21a)](SYSTEM_MODES)[_0x1cad4b(0x1a0)](_0x1b67d3[_0x1cad4b(0x24d)])&&(this[_0x1cad4b(0xff)]=_0x1b67d3[_0x1cad4b(0x24d)],_0x1b67d3[_0x1cad4b(0x24d)]===SYSTEM_MODES[_0x1cad4b(0x160)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x1b67d3[_0x1cad4b(0x108)])this[_0x1cad4b(0x16a)](_0x111d78,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x1b67d3[_0x1cad4b(0x108)]){_0x111d78[_0x1cad4b(0x1a0)](_0x1cad4b(0x140))&&_0x1b67d3['val']&&(this[_0x1cad4b(0x16a)](_0x111d78,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x111d78[_0x1cad4b(0x1a0)]('triggerDailyDigest')&&_0x1b67d3['val']){this['setState'](_0x111d78,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x111d78['includes'](_0x1cad4b(0x1e7))&&_0x1b67d3[_0x1cad4b(0x24d)]&&(this['setState'](_0x111d78,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x111d78[_0x1cad4b(0x1a0)]('automation.triggerAction')&&_0x1b67d3[_0x1cad4b(0x24d)]&&(this['setState'](_0x111d78,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x1cad4b(0x195)]['presenceDevices']&&this[_0x1cad4b(0x195)][_0x1cad4b(0x2b4)][_0x1cad4b(0x1a0)](_0x111d78)){await checkWifiPresence(this);return;}const _0x20e80c=(this[_0x1cad4b(0x195)][_0x1cad4b(0x1e4)]||[])[_0x1cad4b(0x260)](_0x336961=>_0x336961['id']===_0x111d78);if(_0x20e80c)processSensorEvent(this,_0x111d78,_0x1b67d3,_0x20e80c);}async['onMessage'](_0x2482dc){const _0x46d7a6=a0_0x1a07fc;if(typeof _0x2482dc===_0x46d7a6(0x23b)&&_0x2482dc[_0x46d7a6(0x107)])try{if(_0x2482dc['command']===_0x46d7a6(0x121)){const _0x51ea6b=_0x2482dc['message'][_0x46d7a6(0x18c)]||this[_0x46d7a6(0x195)]['geminiApiKey'];if(!_0x51ea6b)return this['sendTo'](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc[_0x46d7a6(0x156)],{'success':![],'message':_0x46d7a6(0x2b5)},_0x2482dc[_0x46d7a6(0x161)]);try{const _0x58de6b=new GoogleGenerativeAI(_0x51ea6b),_0x3cbd6f=_0x58de6b['getGenerativeModel']({'model':GEMINI_MODEL}),_0x51bced=await _0x3cbd6f['generateContent'](_0x46d7a6(0x193)),_0x21ebcc=await _0x51bced['response'],_0x354f11=_0x21ebcc[_0x46d7a6(0x28f)]();this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc['command'],{'success':!![],'message':_0x46d7a6(0x226)+_0x354f11[_0x46d7a6(0x225)](0x0,0x14)+_0x46d7a6(0x288)},_0x2482dc['callback']);}catch(_0x258566){this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc[_0x46d7a6(0x156)],{'success':![],'message':'Fehler:\x20'+_0x258566[_0x46d7a6(0x107)]},_0x2482dc[_0x46d7a6(0x161)]);}}else{if(_0x2482dc[_0x46d7a6(0x156)]==='testNotification'){}else{if(_0x2482dc[_0x46d7a6(0x156)]===_0x46d7a6(0x1df)){if(!this[_0x46d7a6(0x276)])return this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc['command'],{'success':![],'isPro':![]},_0x2482dc[_0x46d7a6(0x161)]);let _0x20d53f={'status':'N/A','details':'','lastCheck':0x0};try{_0x20d53f[_0x46d7a6(0x299)]=(await this[_0x46d7a6(0x1a3)](LTM_DP_DRIFT_STATUS))[_0x46d7a6(0x24d)],_0x20d53f[_0x46d7a6(0x178)]=(await this[_0x46d7a6(0x1a3)](LTM_DP_DRIFT_DETAILS))['val'],_0x20d53f['lastCheck']=(await this[_0x46d7a6(0x1a3)](LTM_DP_DRIFT_LAST_CHECK))[_0x46d7a6(0x24d)];}catch(_0x5b3c4a){}const _0x3fabba=this['analysisHistory']||[];this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x20d53f,'analysisHistory':_0x3fabba},_0x2482dc['callback']);}else{if(_0x2482dc[_0x46d7a6(0x156)]===_0x46d7a6(0x1dc)){const _0x46ba0c=this['dailyDigests'][_0x46d7a6(0x10b)],_0x220e42=new Date(),_0x48d13d=new Date(_0x220e42[_0x46d7a6(0x2d0)](),_0x220e42[_0x46d7a6(0xba)](),_0x220e42[_0x46d7a6(0x297)]())[_0x46d7a6(0x1cc)](),_0x46d321=this['rawEventLog'][_0x46d7a6(0xea)](_0x4f6558=>new Date(_0x4f6558[_0x46d7a6(0xf8)])[_0x46d7a6(0x1cc)]()>_0x48d13d)[_0x46d7a6(0x10b)],_0x272336=new Array(0x18)['fill'](0x0);this[_0x46d7a6(0x183)][_0x46d7a6(0x119)](_0x53d294=>{const _0x368b4d=_0x46d7a6,_0x19a78b=new Date(_0x53d294[_0x368b4d(0xf8)]);if(_0x19a78b['getTime']()>_0x48d13d)_0x272336[_0x19a78b[_0x368b4d(0x16d)]()]++;});let _0x246d9a={'status':_0x46d7a6(0x148)};try{_0x246d9a[_0x46d7a6(0x299)]=(await this[_0x46d7a6(0x1a3)](LTM_DP_DRIFT_STATUS))[_0x46d7a6(0x24d)];}catch(_0x133533){}let _0x1ca653='';try{const _0x32973e=await this['getStateAsync']('system.presenceWho');_0x1ca653=_0x32973e?_0x32973e[_0x46d7a6(0x24d)]:'';}catch(_0x4be443){}let _0x4feffa=null;!this[_0x46d7a6(0x142)]&&(_0x4feffa=this[_0x46d7a6(0x195)][_0x46d7a6(0xc8)]?'KI-Modell\x20nicht\x20initialisiert':'Kein\x20API\x20Key!');let _0x310ee8={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x54ee23=await this['getStateAsync']('analysis.automation.patternDetected'),_0xf28246=await this['getStateAsync'](_0x46d7a6(0xce)),_0x125b35=await this[_0x46d7a6(0x1a3)]('analysis.automation.targetId'),_0xfe3116=await this[_0x46d7a6(0x1a3)](_0x46d7a6(0x149)),_0x161dbf=await this[_0x46d7a6(0x1a3)](_0x46d7a6(0x1fe));_0x54ee23&&_0x54ee23[_0x46d7a6(0x24d)]&&(_0x310ee8[_0x46d7a6(0x1af)]=!![],_0x310ee8[_0x46d7a6(0x27e)]=_0xf28246?_0xf28246[_0x46d7a6(0x24d)]:'',_0x310ee8['targetId']=_0x125b35?_0x125b35[_0x46d7a6(0x24d)]:'',_0x310ee8[_0x46d7a6(0x1ef)]=_0xfe3116?_0xfe3116[_0x46d7a6(0x24d)]:''),_0x310ee8[_0x46d7a6(0x1bf)]=_0x161dbf?!!_0x161dbf[_0x46d7a6(0x24d)]:![];}catch(_0x361b9c){}this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc[_0x46d7a6(0x156)],{'success':!![],'eventHistory':this[_0x46d7a6(0x28e)][_0x46d7a6(0x1a6)](0x0,0xf),'stats':{'digestCount':_0x46ba0c,'eventCountToday':_0x46d321,'hourlyActivity':_0x272336,'driftStatus':_0x246d9a[_0x46d7a6(0x299)],'isPresent':this[_0x46d7a6(0x2a2)],'presenceWho':_0x1ca653,'minDays':this[_0x46d7a6(0x195)][_0x46d7a6(0x131)]||0x7,'stbDays':this[_0x46d7a6(0x195)][_0x46d7a6(0x255)]||0xe,'ltbDays':this[_0x46d7a6(0x195)][_0x46d7a6(0x2c8)]||0x3c,'systemError':_0x4feffa},'automation':_0x310ee8},_0x2482dc[_0x46d7a6(0x161)]);}else{if(_0x2482dc[_0x46d7a6(0x156)]==='getEnums'){const _0x133e06=await this[_0x46d7a6(0x18a)](_0x46d7a6(0xd1),_0x46d7a6(0x22c)),_0x4bab9a=[];if(_0x133e06)for(const _0x57a459 in _0x133e06){const _0x1a2fdd=_0x133e06[_0x57a459],_0x2e6127=(_0x1a2fdd[_0x46d7a6(0x234)]&&typeof _0x1a2fdd['common']['name']==='object'?_0x1a2fdd[_0x46d7a6(0x234)][_0x46d7a6(0x245)]['de']:_0x1a2fdd['common'][_0x46d7a6(0x245)])||_0x1a2fdd[_0x46d7a6(0x234)][_0x46d7a6(0x245)];_0x4bab9a['push']({'id':_0x57a459,'name':_0x2e6127});}this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc[_0x46d7a6(0x156)],{'success':!![],'enums':_0x4bab9a},_0x2482dc['callback']);}else{if(_0x2482dc['command']===_0x46d7a6(0x279))try{const _0x159f00=await scanForDevices(this,_0x2482dc['message']||{});this['sendTo'](_0x2482dc['from'],_0x2482dc[_0x46d7a6(0x156)],{'success':!![],'devices':_0x159f00},_0x2482dc[_0x46d7a6(0x161)]);}catch(_0x23aeae){this['sendTo'](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc['command'],{'success':![],'error':_0x23aeae[_0x46d7a6(0x107)]},_0x2482dc[_0x46d7a6(0x161)]);}else{if(_0x2482dc['command']==='getCalendarNames'){const _0x47951d=_0x2482dc[_0x46d7a6(0x107)][_0x46d7a6(0x230)];if(!_0x47951d)return this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc[_0x46d7a6(0x156)],{'success':![],'error':'No\x20instance'},_0x2482dc[_0x46d7a6(0x161)]);const _0x2ef9f7=await getCalendarNames(this,_0x47951d);this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc[_0x46d7a6(0x156)],{'success':!![],'names':_0x2ef9f7},_0x2482dc[_0x46d7a6(0x161)]);}else{if(_0x2482dc['command']===_0x46d7a6(0x25c)){const {targetId:_0x505718,targetValue:_0x2338bd}=_0x2482dc[_0x46d7a6(0x107)];this[_0x46d7a6(0x1d4)]['info'](_0x46d7a6(0x26f)+_0x505718+_0x46d7a6(0x1b6)+_0x2338bd),await this[_0x46d7a6(0x21c)](_0x46d7a6(0x19e),{'val':!![],'ack':!![]}),await this[_0x46d7a6(0x21c)](_0x46d7a6(0xce),{'val':_0x46d7a6(0x137)+_0x505718,'ack':!![]}),await this[_0x46d7a6(0x21c)]('analysis.automation.targetId',{'val':_0x505718,'ack':!![]}),await this[_0x46d7a6(0x21c)](_0x46d7a6(0x149),{'val':_0x2338bd,'ack':!![]}),this['sendTo'](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc['command'],{'success':!![]},_0x2482dc[_0x46d7a6(0x161)]);}else{if(_0x2482dc[_0x46d7a6(0x156)]===_0x46d7a6(0x1c0)){const {historyId:_0x3c0d25,rating:_0x14afb7,comment:_0x26b1ae,alertReason:_0x52c20a}=_0x2482dc[_0x46d7a6(0x107)];_0x3c0d25&&_0x14afb7?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x3c0d25,'rating':_0x14afb7,'comment':_0x26b1ae,'alertReason':_0x52c20a}),this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc['command'],{'success':!![]},_0x2482dc[_0x46d7a6(0x161)])):this[_0x46d7a6(0x11e)](_0x2482dc['from'],_0x2482dc[_0x46d7a6(0x156)],{'success':![],'error':_0x46d7a6(0x2b7)},_0x2482dc[_0x46d7a6(0x161)]);}else _0x2482dc[_0x46d7a6(0x156)]===_0x46d7a6(0x179)&&(this[_0x46d7a6(0x1d4)][_0x46d7a6(0x26b)](_0x46d7a6(0x10c)),await this[_0x46d7a6(0x21c)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x46d7a6(0x21c)]('analysis.automation.description',{'val':'','ack':!![]}),this['sendTo'](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc['command'],{'success':!![]},_0x2482dc[_0x46d7a6(0x161)]));}}}}}}}}}catch(_0x5199e7){this[_0x46d7a6(0x1d4)][_0x46d7a6(0x136)](_0x46d7a6(0x2a3)+_0x2482dc[_0x46d7a6(0x156)]+':\x20'+_0x5199e7[_0x46d7a6(0x107)]);if(_0x2482dc[_0x46d7a6(0x161)])this[_0x46d7a6(0x11e)](_0x2482dc[_0x46d7a6(0x10a)],_0x2482dc[_0x46d7a6(0x156)],{'success':![],'error':_0x5199e7[_0x46d7a6(0x107)]},_0x2482dc[_0x46d7a6(0x161)]);}}}if(require[a0_0x1a07fc(0x285)]!==module)module[a0_0x1a07fc(0x1e2)]=_0x1cbba7=>new CogniLiving(_0x1cbba7);else new CogniLiving();