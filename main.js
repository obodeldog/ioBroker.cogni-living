const a0_0x95af01=a0_0x2ab6;(function(_0x3d0136,_0x4b2970){const _0x2b1c54=a0_0x2ab6,_0x4cf136=_0x3d0136();while(!![]){try{const _0x3ef2ff=parseInt(_0x2b1c54(0x232))/0x1+parseInt(_0x2b1c54(0x243))/0x2*(-parseInt(_0x2b1c54(0x267))/0x3)+parseInt(_0x2b1c54(0x289))/0x4*(parseInt(_0x2b1c54(0x1d3))/0x5)+parseInt(_0x2b1c54(0x271))/0x6+-parseInt(_0x2b1c54(0x209))/0x7+parseInt(_0x2b1c54(0x292))/0x8+-parseInt(_0x2b1c54(0x25b))/0x9;if(_0x3ef2ff===_0x4b2970)break;else _0x4cf136['push'](_0x4cf136['shift']());}catch(_0x133190){_0x4cf136['push'](_0x4cf136['shift']());}}}(a0_0x3d10,0xef267));const a0_0x594ca5=(function(){let _0x5bc25c=!![];return function(_0xb252a3,_0x3a20ac){const _0x533fc8=_0x5bc25c?function(){const _0x115d15=a0_0x2ab6;if(_0x3a20ac){const _0x44e690=_0x3a20ac[_0x115d15(0x263)](_0xb252a3,arguments);return _0x3a20ac=null,_0x44e690;}}:function(){};return _0x5bc25c=![],_0x533fc8;};}()),a0_0x50c629=a0_0x594ca5(this,function(){const _0x235d3b=a0_0x2ab6;return a0_0x50c629[_0x235d3b(0x23e)]()[_0x235d3b(0x1de)](_0x235d3b(0x1f7))[_0x235d3b(0x23e)]()[_0x235d3b(0x280)](a0_0x50c629)[_0x235d3b(0x1de)]('(((.+)+)+)+$');});a0_0x50c629();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x95af01(0x26f)),schedule=require(a0_0x95af01(0x20b)),{spawn,exec}=require(a0_0x95af01(0x230)),path=require('path'),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x95af01(0x27c),LTM_SCHEDULE=a0_0x95af01(0x26b),MODE_RESET_SCHEDULE=a0_0x95af01(0x24c),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x95af01(0x258),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x95af01(0x25a),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x95af01(0x221),LTM_DP_DRIFT_CHANNEL=a0_0x95af01(0x245),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x95af01(0x1eb),LTM_DP_DRIFT_LAST_CHECK=a0_0x95af01(0x281),SYSTEM_DP_MODE=a0_0x95af01(0x1e1),SYSTEM_MODES={'NORMAL':'normal','VACATION':'vacation','PARTY':a0_0x95af01(0x1da),'GUEST':a0_0x95af01(0x223)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x95af01(0x1ea)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x95af01(0x203),'senior_aal':a0_0x95af01(0x1d5),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x95af01(0x20d),'security':a0_0x95af01(0x205)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x95af01(0x288)]==='win32',VENV_PATH=path[a0_0x95af01(0x246)](__dirname,a0_0x95af01(0x1d9)),PYTHON_EXE=IS_WIN?path[a0_0x95af01(0x246)](VENV_PATH,'Scripts',a0_0x95af01(0x215)):path['join'](VENV_PATH,a0_0x95af01(0x214),'python'),PIP_EXE=IS_WIN?path[a0_0x95af01(0x246)](VENV_PATH,a0_0x95af01(0x1d8),a0_0x95af01(0x29a)):path[a0_0x95af01(0x246)](VENV_PATH,a0_0x95af01(0x214),a0_0x95af01(0x25d));let activeSequence=[],sequenceTimer=null;class CogniLiving extends utils[a0_0x95af01(0x27e)]{constructor(_0x49f12e){const _0x7e53b3=a0_0x95af01;super({..._0x49f12e,'name':_0x7e53b3(0x21d)}),this[_0x7e53b3(0x1f5)]=[],this['analysisHistory']=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x7e53b3(0x20e)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x7e53b3(0x247)]=!![],this[_0x7e53b3(0x1ca)]=null,this[_0x7e53b3(0x1f9)]=null,this['isGracePeriodActive']=![],this[_0x7e53b3(0x1db)]=null,this[_0x7e53b3(0x224)]=null,this[_0x7e53b3(0x25e)]=SYSTEM_MODES[_0x7e53b3(0x25c)],this[_0x7e53b3(0x293)]=![],this['lastAlertState']=![],this[_0x7e53b3(0x1df)]='unknown',this[_0x7e53b3(0x285)]=null,this[_0x7e53b3(0x22b)]=null,this[_0x7e53b3(0x26d)]=null,this['driftAnalysisTimer']=null,this[_0x7e53b3(0x1e4)]=null,this[_0x7e53b3(0x242)]=null,this[_0x7e53b3(0x29b)]=![],this['on']('ready',this[_0x7e53b3(0x212)]['bind'](this)),this['on'](_0x7e53b3(0x295),this[_0x7e53b3(0x28b)]['bind'](this)),this['on'](_0x7e53b3(0x29c),this['onUnload'][_0x7e53b3(0x23b)](this)),this['on'](_0x7e53b3(0x1fc),this[_0x7e53b3(0x1d7)]['bind'](this));}async[a0_0x95af01(0x212)](){const _0x126785=a0_0x95af01;this[_0x126785(0x287)][_0x126785(0x220)](_0x126785(0x299)+this['version']+')'),await initZombies(this),this[_0x126785(0x236)][_0x126785(0x20c)]=this[_0x126785(0x236)][_0x126785(0x20c)]||'';try{this[_0x126785(0x293)]=await checkLicense(this,this[_0x126785(0x236)][_0x126785(0x20c)]);}catch(_0x158917){}if(!this[_0x126785(0x236)][_0x126785(0x204)]||this[_0x126785(0x236)][_0x126785(0x204)]<0.1)this[_0x126785(0x236)][_0x126785(0x204)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config']['geminiApiKey'])try{this[_0x126785(0x1db)]=new GoogleGenerativeAI(this['config'][_0x126785(0x290)]),this[_0x126785(0x224)]=this[_0x126785(0x1db)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x126785(0x262)}}),this[_0x126785(0x287)]['info']('Gemini\x20AI\x20initialized.');}catch(_0x794366){this[_0x126785(0x287)][_0x126785(0x286)]('Gemini\x20Init\x20Error:\x20'+_0x794366[_0x126785(0x1fc)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x126785(0x26c)]('analysis.trigger'),this[_0x126785(0x26c)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x126785(0x1e1)),this['subscribeStates'](_0x126785(0x21c)),this[_0x126785(0x26c)](_0x126785(0x24b)),this['subscribeStates'](_0x126785(0x27a)),this[_0x126785(0x26c)]('analysis.training.triggerSecurity'),this['subscribeStates'](_0x126785(0x1f1)),this['subscribeStates'](_0x126785(0x1f3)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x126785(0x285)])clearInterval(this[_0x126785(0x285)]);const _0xe24535=this['config'][_0x126785(0x270)]||0xf;_0xe24535>0x0&&(this[_0x126785(0x285)]=setInterval(()=>{runAutopilot(this);},_0xe24535*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{if(this['pythonProcess'])runPythonHealthCheck(this);},0x1388);}[a0_0x95af01(0x283)](_0x2dd5b1){const _0x3a852b=a0_0x95af01;if(this[_0x3a852b(0x285)])clearInterval(this[_0x3a852b(0x285)]);if(this[_0x3a852b(0x24a)])clearInterval(this[_0x3a852b(0x24a)]);if(this[_0x3a852b(0x22b)])this[_0x3a852b(0x22b)][_0x3a852b(0x1cf)]();if(this['modeResetJob'])this[_0x3a852b(0x26d)]['cancel']();if(this[_0x3a852b(0x1e4)])this[_0x3a852b(0x1e4)][_0x3a852b(0x1cf)]();if(this[_0x3a852b(0x1ca)])clearTimeout(this[_0x3a852b(0x1ca)]);if(this[_0x3a852b(0x1f9)])clearTimeout(this[_0x3a852b(0x1f9)]);stopPythonService(this),_0x2dd5b1();}async[a0_0x95af01(0x28b)](_0x2d20ab,_0x52099f){const _0x16fa27=a0_0x95af01;if(!_0x52099f)return;if(this[_0x16fa27(0x29b)])return;if(_0x2d20ab['includes'](_0x16fa27(0x248))&&_0x2d20ab[_0x16fa27(0x27d)]('communicate.request')&&_0x52099f[_0x16fa27(0x1cb)]){await handleTelegramResponse(this,_0x52099f[_0x16fa27(0x1cb)]);return;}if(_0x2d20ab===this['namespace']+'.'+SYSTEM_DP_MODE){_0x52099f[_0x16fa27(0x1cb)]&&Object[_0x16fa27(0x244)](SYSTEM_MODES)[_0x16fa27(0x256)](_0x52099f[_0x16fa27(0x1cb)])&&(this['currentSystemMode']=_0x52099f['val'],_0x52099f[_0x16fa27(0x1cb)]===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x52099f['ack'])this['setState'](_0x2d20ab,{'val':this[_0x16fa27(0x25e)],'ack':!![]});return;}if(!_0x52099f[_0x16fa27(0x1ff)]){_0x2d20ab[_0x16fa27(0x256)]('analysis.trigger')&&_0x52099f[_0x16fa27(0x1cb)]&&(this[_0x16fa27(0x1e3)](_0x2d20ab,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x2d20ab['includes'](_0x16fa27(0x1d6))&&_0x52099f[_0x16fa27(0x1cb)]){this[_0x16fa27(0x1e3)](_0x2d20ab,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x2d20ab[_0x16fa27(0x256)]('triggerBriefing')&&_0x52099f['val']&&(this[_0x16fa27(0x1e3)](_0x2d20ab,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x2d20ab[_0x16fa27(0x256)](_0x16fa27(0x229))&&_0x52099f[_0x16fa27(0x1cb)]&&(this['setState'](_0x2d20ab,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x2d20ab['includes'](_0x16fa27(0x20f))&&_0x52099f[_0x16fa27(0x1cb)]){this[_0x16fa27(0x1e3)](_0x2d20ab,{'val':![],'ack':!![]});if(!this[_0x16fa27(0x293)])return;try{const _0x13b6cf=await this[_0x16fa27(0x20a)]('LTM.trainingData.sequences');if(_0x13b6cf&&_0x13b6cf[_0x16fa27(0x1cb)]){const _0x595e2e=JSON[_0x16fa27(0x296)](_0x13b6cf[_0x16fa27(0x1cb)]);this[_0x16fa27(0x287)][_0x16fa27(0x220)](_0x16fa27(0x275)),this[_0x16fa27(0x1ec)](_0x16fa27(0x222),{'val':_0x16fa27(0x273),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x595e2e});}}catch(_0x536271){this['log'][_0x16fa27(0x286)](_0x16fa27(0x279)+_0x536271[_0x16fa27(0x1fc)]);}}if(_0x2d20ab['includes']('analysis.training.triggerHealth')&&_0x52099f[_0x16fa27(0x1cb)]){this[_0x16fa27(0x1e3)](_0x2d20ab,{'val':![],'ack':!![]});if(!this[_0x16fa27(0x293)])return;try{const _0x28f900=await this[_0x16fa27(0x20a)](LTM_DP_DAILY_DIGESTS);_0x28f900&&_0x28f900['val']&&sendToPython(this,_0x16fa27(0x22d),{'digests':JSON[_0x16fa27(0x296)](_0x28f900[_0x16fa27(0x1cb)])});}catch(_0x35928e){}}if(_0x2d20ab[_0x16fa27(0x256)](_0x16fa27(0x1f3))&&_0x52099f[_0x16fa27(0x1cb)]){this[_0x16fa27(0x1e3)](_0x2d20ab,{'val':![],'ack':!![]});if(!this['isProVersion'])return;try{const _0x48ce62=await this['getStateAsync'](_0x16fa27(0x1fe));_0x48ce62&&_0x48ce62[_0x16fa27(0x1cb)]&&sendToPython(this,'TRAIN_ENERGY',{'points':JSON[_0x16fa27(0x296)](_0x48ce62['val'])});}catch(_0x82e323){}}return;}if(this['config'][_0x16fa27(0x207)]&&this[_0x16fa27(0x236)][_0x16fa27(0x207)][_0x16fa27(0x256)](_0x2d20ab)){await checkWifiPresence(this);return;}const _0x1e703b=(this[_0x16fa27(0x236)][_0x16fa27(0x1f4)]||[])[_0x16fa27(0x213)](_0xa922a1=>_0xa922a1['id']===_0x2d20ab);if(_0x1e703b)processSensorEvent(this,_0x2d20ab,_0x52099f,_0x1e703b);}async[a0_0x95af01(0x1d7)](_0xd032ef){const _0x8b86a1=a0_0x95af01;if(typeof _0xd032ef===_0x8b86a1(0x284)&&_0xd032ef[_0x8b86a1(0x1fc)]){if(_0xd032ef[_0x8b86a1(0x21a)]===_0x8b86a1(0x24e)){}}}}async function processSensorEvent(_0x28373e,_0x519575,_0x38f3ce,_0x25e499){const _0x21581c=a0_0x95af01;if(!_0x25e499)return;const _0x1107e9=_0x38f3ce['val'],_0x1b60ae=Date[_0x21581c(0x22c)](),_0x50653f=_0x28373e[_0x21581c(0x20e)][_0x519575];_0x28373e['sensorLastValues'][_0x519575]=_0x1107e9;if(!_0x25e499[_0x21581c(0x217)]&&_0x50653f!=undefined&&_0x50653f==_0x1107e9)return;const _0x2707d8=(_0x25e499['type']||'')[_0x21581c(0x235)](),_0x4ad4f9=_0x2707d8['includes'](_0x21581c(0x23d))||_0x2707d8[_0x21581c(0x256)](_0x21581c(0x211))||_0x2707d8[_0x21581c(0x256)](_0x21581c(0x26a))||_0x2707d8[_0x21581c(0x256)](_0x21581c(0x200));_0x28373e[_0x21581c(0x293)]&&_0x4ad4f9&&recordThermodynamics(_0x28373e,_0x519575,_0x1107e9,_0x25e499[_0x21581c(0x294)]);const _0x45b8c3={'timestamp':_0x1b60ae,'id':_0x519575,'name':_0x25e499[_0x21581c(0x261)],'type':_0x25e499[_0x21581c(0x201)],'location':_0x25e499[_0x21581c(0x294)],'value':_0x1107e9};_0x28373e[_0x21581c(0x1f5)][_0x21581c(0x1f8)](_0x45b8c3);if(_0x28373e[_0x21581c(0x1f5)]['length']>HISTORY_MAX_SIZE)_0x28373e[_0x21581c(0x1f5)]['pop']();await _0x28373e[_0x21581c(0x1ec)]('events.lastEvent',{'val':JSON[_0x21581c(0x23a)](_0x45b8c3),'ack':!![]}),await _0x28373e['setStateAsync'](_0x21581c(0x1d4),{'val':JSON[_0x21581c(0x23a)](_0x28373e[_0x21581c(0x1f5)]),'ack':!![]});_0x28373e[_0x21581c(0x293)]&&(_0x28373e[_0x21581c(0x253)]['push'](_0x45b8c3),await saveRawEventLog(_0x28373e),recordSequence(_0x28373e,_0x45b8c3));if(_0x25e499[_0x21581c(0x1e8)]&&_0x1107e9===!![]){if(_0x28373e['isPresent']&&!_0x28373e[_0x21581c(0x249)])startExitTimer(_0x28373e);else{if(!_0x28373e[_0x21581c(0x247)])setPresence(_0x28373e,!![]);}}else{if(_0x25e499[_0x21581c(0x201)]===_0x21581c(0x216)&&_0x1107e9===!![]){if(_0x28373e[_0x21581c(0x1ca)])abortExitTimer(_0x28373e);if(!_0x28373e[_0x21581c(0x247)]&&_0x28373e[_0x21581c(0x25e)]===SYSTEM_MODES[_0x21581c(0x25c)])setPresence(_0x28373e,!![]);}}}async function recordSequence(_0xcfb1d7,_0x55bc33){const _0x5378e9=a0_0x95af01,_0x252c32=(_0x55bc33[_0x5378e9(0x201)]||'')['toLowerCase'](),_0x326f8c=[_0x5378e9(0x216),_0x5378e9(0x225),_0x5378e9(0x268),_0x5378e9(0x24f),_0x5378e9(0x23f),'door','tÃ¼r',_0x5378e9(0x1e7),'fenster','contact',_0x5378e9(0x26e),_0x5378e9(0x1dd),_0x5378e9(0x28c),_0x5378e9(0x208),_0x5378e9(0x1fd),'dimmer',_0x5378e9(0x282)];if(!_0x326f8c[_0x5378e9(0x27f)](_0x59a4fd=>_0x252c32[_0x5378e9(0x256)](_0x59a4fd)))return;if(!_0x55bc33[_0x5378e9(0x28a)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x5378e9(0x1f6)]({'loc':_0x55bc33[_0x5378e9(0x294)]||_0x5378e9(0x1e2),'id':_0x55bc33['id'],'ts':Date[_0x5378e9(0x22c)]()}),_0xcfb1d7[_0x5378e9(0x287)][_0x5378e9(0x1cd)]('[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20'+_0x55bc33[_0x5378e9(0x294)]+_0x5378e9(0x1e5)+activeSequence['length']+')'),sequenceTimer=setTimeout(async()=>{const _0x5ae073=_0x5378e9;if(activeSequence[_0x5ae073(0x255)]>0x1)await saveCompletedSequence(_0xcfb1d7);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x396ded){const _0x5c8b11=a0_0x95af01;try{const _0x48184d=await _0x396ded[_0x5c8b11(0x20a)](_0x5c8b11(0x202));let _0x230628=[];if(_0x48184d&&_0x48184d['val'])try{_0x230628=JSON[_0x5c8b11(0x296)](_0x48184d[_0x5c8b11(0x1cb)]);}catch(_0x44cd87){}const _0x22ba2e=activeSequence[0x0]['ts'],_0x422821=activeSequence[_0x5c8b11(0x291)](_0x14454f=>({'loc':_0x14454f[_0x5c8b11(0x298)],'t_delta':Math[_0x5c8b11(0x1e9)]((_0x14454f['ts']-_0x22ba2e)/0x3e8)})),_0x577a05={'timestamp':new Date(_0x22ba2e)[_0x5c8b11(0x260)](),'steps':_0x422821,'duration':Math[_0x5c8b11(0x1e9)]((activeSequence[activeSequence[_0x5c8b11(0x255)]-0x1]['ts']-_0x22ba2e)/0x3e8),'daytime':new Date(_0x22ba2e)[_0x5c8b11(0x1dc)]()};_0x230628[_0x5c8b11(0x1f6)](_0x577a05);if(_0x230628[_0x5c8b11(0x255)]>MAX_TRAINING_SET_SIZE)_0x230628[_0x5c8b11(0x22a)]();await _0x396ded[_0x5c8b11(0x1ec)]('LTM.trainingData.sequences',{'val':JSON[_0x5c8b11(0x23a)](_0x230628),'ack':!![]}),runSecurityCheck(_0x396ded,_0x577a05);}catch(_0x9d90f6){_0x396ded[_0x5c8b11(0x287)]['error']('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x9d90f6[_0x5c8b11(0x1fc)]);}}function runSecurityCheck(_0x595027,_0x2d22d7){const _0x40ac70=a0_0x95af01;if(!_0x595027[_0x40ac70(0x293)])return;_0x595027['log'][_0x40ac70(0x1cd)](_0x40ac70(0x241)),sendToPython(_0x595027,'ANALYZE_SEQUENCE',{'sequence':_0x2d22d7});}function installPythonDependencies(_0x3e6240){const _0x551bff=a0_0x95af01;if(_0x3e6240[_0x551bff(0x29b)]){_0x3e6240[_0x551bff(0x287)][_0x551bff(0x22e)](_0x551bff(0x1c9));return;}_0x3e6240[_0x551bff(0x29b)]=!![];const _0x18c340=path[_0x551bff(0x246)](__dirname,'python_service',_0x551bff(0x27b));_0x3e6240['log']['info'](_0x551bff(0x269)),stopPythonService(_0x3e6240);if(fs['existsSync'](VENV_PATH)){if(!fs[_0x551bff(0x251)](PIP_EXE)){_0x3e6240[_0x551bff(0x287)][_0x551bff(0x22e)](_0x551bff(0x257));try{fs[_0x551bff(0x265)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x2f38f3){}}}!fs['existsSync'](VENV_PATH)?exec(_0x551bff(0x1e0)+VENV_PATH+'\x22',_0x34f9bf=>{const _0x5e4ce6=_0x551bff;if(_0x34f9bf){_0x3e6240[_0x5e4ce6(0x287)]['error'](_0x5e4ce6(0x21e)),_0x3e6240[_0x5e4ce6(0x29b)]=![];return;}installRequirementsInVenv(_0x3e6240,_0x18c340);}):installRequirementsInVenv(_0x3e6240,_0x18c340);}function installRequirementsInVenv(_0x4b632d,_0x458cae){const _0xbf2358=a0_0x95af01;_0x4b632d['log'][_0xbf2358(0x220)](_0xbf2358(0x231));const _0x3c758e='\x22'+PIP_EXE+_0xbf2358(0x1fa)+_0x458cae+'\x22';exec(_0x3c758e,{'timeout':0x124f80,'maxBuffer':0x400*0x400*0x32},(_0x1e57a2,_0x231570,_0x45ee62)=>{const _0xf40a80=_0xbf2358;_0x4b632d[_0xf40a80(0x29b)]=![],_0x1e57a2?_0x4b632d[_0xf40a80(0x287)][_0xf40a80(0x286)]('âŒ\x20PIP\x20INSTALL\x20FAILED:\x20'+(_0x45ee62||_0x1e57a2[_0xf40a80(0x1fc)])):(_0x4b632d[_0xf40a80(0x287)]['info'](_0xf40a80(0x206)),startPythonService(_0x4b632d));});}function startPythonService(_0x1bbf4e){const _0x3b7765=a0_0x95af01;if(_0x1bbf4e[_0x3b7765(0x29b)])return;let _0x50ccb7=_0x3b7765(0x227);if(fs[_0x3b7765(0x251)](PYTHON_EXE))_0x1bbf4e[_0x3b7765(0x287)][_0x3b7765(0x220)]('ðŸ\x20Using\x20VENV\x20Python:\x20'+PYTHON_EXE),_0x50ccb7=PYTHON_EXE;else{_0x1bbf4e[_0x3b7765(0x287)][_0x3b7765(0x22e)](_0x3b7765(0x25f)),installPythonDependencies(_0x1bbf4e);return;}try{const _0x39a9c2=path[_0x3b7765(0x246)](__dirname,'python_service',_0x3b7765(0x1f0));_0x1bbf4e['pythonProcess']=spawn(_0x50ccb7,[_0x39a9c2]),_0x1bbf4e['pythonProcess'][_0x3b7765(0x1cc)]['on'](_0x3b7765(0x233),_0xa716b5=>{const _0x583a5c=_0x3b7765,_0x4ee603=_0xa716b5['toString']()[_0x583a5c(0x234)]('\x0a');_0x4ee603[_0x583a5c(0x219)](_0x5124b5=>{const _0x512fb8=_0x583a5c,_0x5b3acb=_0x5124b5[_0x512fb8(0x21f)]();if(!_0x5b3acb)return;if(_0x5b3acb[_0x512fb8(0x264)](_0x512fb8(0x28d)))_0x1bbf4e[_0x512fb8(0x287)][_0x512fb8(0x1cd)]('[PYTHON]\x20'+_0x5b3acb[_0x512fb8(0x252)](0x5)[_0x512fb8(0x21f)]());else{if(_0x5b3acb['startsWith'](_0x512fb8(0x266)))try{const _0x5c6c6c=JSON[_0x512fb8(0x296)](_0x5b3acb[_0x512fb8(0x252)](0x8)[_0x512fb8(0x21f)]());handlePythonResult(_0x1bbf4e,_0x5c6c6c);}catch(_0x1327fc){_0x1bbf4e[_0x512fb8(0x287)]['warn'](_0x512fb8(0x24d)+_0x5b3acb);}}(_0x5b3acb[_0x512fb8(0x256)]('No\x20module\x20named')||_0x5b3acb['includes']('Bibliotheken\x20nicht\x20gefunden'))&&(_0x1bbf4e[_0x512fb8(0x287)][_0x512fb8(0x22e)](_0x512fb8(0x1ce)),installPythonDependencies(_0x1bbf4e));});}),_0x1bbf4e[_0x3b7765(0x242)][_0x3b7765(0x1d0)]['on'](_0x3b7765(0x233),_0xc4ba10=>{const _0x233099=_0x3b7765,_0x509e7d=_0xc4ba10[_0x233099(0x23e)]()[_0x233099(0x21f)]();if(!_0x509e7d[_0x233099(0x256)](_0x233099(0x237)))_0x1bbf4e['log']['error'](_0x233099(0x239)+_0x509e7d);}),_0x1bbf4e[_0x3b7765(0x242)]['on']('close',_0xe22bb3=>{const _0x91af3=_0x3b7765;_0x1bbf4e['log'][_0x91af3(0x220)]('[PYTHON]\x20Exited\x20code\x20'+_0xe22bb3),_0x1bbf4e[_0x91af3(0x242)]=null;}),_0x1bbf4e['pythonProcess']['on'](_0x3b7765(0x286),_0x37a721=>{const _0x13afda=_0x3b7765;_0x1bbf4e[_0x13afda(0x287)][_0x13afda(0x22e)](_0x13afda(0x254)+_0x37a721['message']);});}catch(_0x3744ce){_0x1bbf4e[_0x3b7765(0x287)]['error'](_0x3b7765(0x238)+_0x3744ce[_0x3b7765(0x1fc)]);}}function stopPythonService(_0x119bbf){const _0x4cdf16=a0_0x95af01;if(_0x119bbf[_0x4cdf16(0x242)]){_0x119bbf[_0x4cdf16(0x287)][_0x4cdf16(0x220)]('ðŸ\x20Stopping\x20Python...');try{_0x119bbf[_0x4cdf16(0x242)][_0x4cdf16(0x22f)]();}catch(_0x3dce0f){}_0x119bbf[_0x4cdf16(0x242)]=null;}}function handlePythonResult(_0xdf9848,_0x33c906){const _0x3fbd1a=a0_0x95af01;if(_0x33c906[_0x3fbd1a(0x201)]==='PONG')_0xdf9848[_0x3fbd1a(0x287)]['debug'](_0x3fbd1a(0x277));else{if(_0x33c906[_0x3fbd1a(0x201)]===_0x3fbd1a(0x1e6)){const {anomaly_score:_0x5e62fa,is_anomaly:_0x313a43,threshold:_0x2d4a56}=_0x33c906[_0x3fbd1a(0x1ef)];_0xdf9848[_0x3fbd1a(0x287)][_0x3fbd1a(0x220)]('ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20'+_0x5e62fa[_0x3fbd1a(0x1fb)](0x5)+_0x3fbd1a(0x297)+(_0x313a43?_0x3fbd1a(0x250):'OK')),_0xdf9848[_0x3fbd1a(0x1ec)](_0x3fbd1a(0x218),{'val':_0x5e62fa,'ack':!![]}),_0xdf9848['setStateAsync']('analysis.security.lastCheck',{'val':new Date()[_0x3fbd1a(0x260)](),'ack':!![]});if(_0x313a43){const _0x5d2f28=_0x3fbd1a(0x274)+_0x5e62fa[_0x3fbd1a(0x1fb)](0x4)+')';_0xdf9848[_0x3fbd1a(0x1ec)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0xdf9848[_0x3fbd1a(0x1ec)](_0x3fbd1a(0x228),{'val':_0x5d2f28,'ack':!![]}),sendNotification(_0xdf9848,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x5d2f28,![],!![]);}}else{if(_0x33c906['type']===_0x3fbd1a(0x226)){const {success:_0x5574cb,details:_0x5ee46c}=_0x33c906['payload'];_0xdf9848[_0x3fbd1a(0x1ec)](_0x3fbd1a(0x222),{'val':_0x5574cb?'Success:\x20'+new Date()[_0x3fbd1a(0x272)]()+'\x20('+_0x5ee46c+')':'Failed:\x20'+_0x5ee46c,'ack':!![]});}else{if(_0x33c906[_0x3fbd1a(0x201)]===_0x3fbd1a(0x259)){const {success:_0x58c9ce,details:_0x4f1ace}=_0x33c906[_0x3fbd1a(0x1ef)];if(_0x58c9ce)try{const _0x29477c=JSON[_0x3fbd1a(0x296)](_0x4f1ace);if(_0x29477c['insulation'])_0xdf9848[_0x3fbd1a(0x1ec)]('analysis.energy.insulationScore',{'val':JSON[_0x3fbd1a(0x23a)](_0x29477c[_0x3fbd1a(0x1ee)]),'ack':!![]});if(_0x29477c['heating'])_0xdf9848['setStateAsync']('analysis.energy.heatingScore',{'val':JSON[_0x3fbd1a(0x23a)](_0x29477c[_0x3fbd1a(0x1d1)]),'ack':!![]});}catch(_0x4cd5e2){}}}}}}function sendToPython(_0x254882,_0x2cc330,_0x389d20={}){const _0x3f7299=a0_0x95af01;if(!_0x254882[_0x3f7299(0x242)]||!_0x254882[_0x3f7299(0x242)]['stdin']['writable'])return;const _0x4a2321=JSON['stringify']({'command':_0x2cc330,..._0x389d20});try{_0x254882[_0x3f7299(0x242)]['stdin']['write'](_0x4a2321+'\x0a');}catch(_0xb05a06){}}async function initZombies(_0x40dd8b){}async function checkLicense(_0x5b919b,_0x291424){return!![];}async function getSystemUUID(_0x42d752){const _0x42bcde=a0_0x95af01;return _0x42bcde(0x23c);}async function initSystemConfig(_0x9808b7){const _0x55fa34=a0_0x95af01;try{const _0x4f70ef=await _0x9808b7[_0x55fa34(0x278)](_0x55fa34(0x28e));if(_0x4f70ef&&_0x4f70ef['common'])_0x9808b7[_0x55fa34(0x21b)]={'latitude':_0x4f70ef[_0x55fa34(0x1d2)][_0x55fa34(0x29d)]||0x0,'longitude':_0x4f70ef[_0x55fa34(0x1d2)][_0x55fa34(0x276)]||0x0,'city':_0x4f70ef['common'][_0x55fa34(0x1ed)]||''};}catch(_0x509d87){}}async function loadRawEventLog(_0xea0b56){const _0x4ee449=a0_0x95af01;try{const _0x1f5eba=await _0xea0b56[_0x4ee449(0x20a)](LTM_DP_RAW_LOG);if(_0x1f5eba&&_0x1f5eba[_0x4ee449(0x1cb)])_0xea0b56[_0x4ee449(0x253)]=JSON[_0x4ee449(0x296)](_0x1f5eba['val']);}catch(_0x483091){_0xea0b56[_0x4ee449(0x253)]=[];}}async function saveRawEventLog(_0xece8e9){const _0x35b451=a0_0x95af01;if(_0xece8e9[_0x35b451(0x253)][_0x35b451(0x255)]>RAW_LOG_MAX_SIZE)_0xece8e9[_0x35b451(0x253)]['splice'](0x0,_0xece8e9[_0x35b451(0x253)][_0x35b451(0x255)]-RAW_LOG_MAX_SIZE);await _0xece8e9[_0x35b451(0x1ec)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0xece8e9[_0x35b451(0x253)]),'ack':!![]});}async function loadDailyDigests(_0x317a47){const _0x3f5dbc=a0_0x95af01;try{const _0x35fd80=await _0x317a47['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x35fd80&&_0x35fd80[_0x3f5dbc(0x1cb)])_0x317a47[_0x3f5dbc(0x240)]=JSON[_0x3f5dbc(0x296)](_0x35fd80[_0x3f5dbc(0x1cb)]);}catch(_0x125edd){_0x317a47[_0x3f5dbc(0x240)]=[];}}async function saveDailyDigests(_0x34f523){const _0x2d4cb0=a0_0x95af01;await _0x34f523[_0x2d4cb0(0x1ec)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x34f523[_0x2d4cb0(0x240)]),'ack':!![]});}function a0_0x3d10(){const _0x6995ec=['LTM.processingStatus','17041869yBQzyh','NORMAL','pip','currentSystemMode','âš ï¸\x20VENV\x20missing.\x20Attempting\x20install...','toISOString','name','application/json','apply','startsWith','rmSync','[RESULT]','416055qyhfME','prÃ¤senz','ðŸ› ï¸\x20MAINTENANCE\x20MODE\x20ACTIVATED:\x20Installing\x20Python\x20dependencies.\x20This\x20can\x20take\x2015\x20minutes.\x20Please\x20wait\x20and\x20do\x20NOT\x20restart.','klima','0\x203\x20*\x20*\x20*','subscribeStates','modeResetJob','kontakt','@google/generative-ai','analysisInterval','11041596FdBGrl','toLocaleTimeString','Sec-Training\x20started...','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','ðŸ§ \x20Triggering\x20Security\x20Training...','longitude','ðŸ\x20Python\x20Pong','getForeignObjectAsync','Training\x20Error:\x20','analysis.automation.autoApply','requirements.txt','models/gemini-flash-latest','endsWith','Adapter','some','constructor','LTM.driftAnalysis.lastCheck','lampe','onUnload','object','analysisTimer','error','log','platform','3755980HuobqX','value','onStateChange','licht','[LOG]','system.config','exports','geminiApiKey','map','5882192fSRfxa','isProVersion','location','stateChange','parse','\x20->\x20','loc','cogni-living\x20adapter\x20starting\x20(v','pip.exe','dependencyInstallInProgress','unload','latitude','âš ï¸\x20Installation\x20already\x20in\x20progress.\x20Waiting...','exitTimer','val','stdout','debug','âš ï¸\x20Python\x20missing\x20libs.\x20Auto-Install\x20triggered.','cancel','stderr','heating','common','5LrfpJO','events.history','PRIORITÃ„T:\x20Gesundheit/AAL.','triggerDailyDigest','onMessage','Scripts','.venv','party','genAI','getHours','light','search','systemUUID','python3\x20-m\x20venv\x20\x22','system.mode','Unknown','setState','briefingJob','\x20(Length:\x20','SECURITY_RESULT','window','isExit','round','PARTY','LTM.driftAnalysis.driftDetails','setStateAsync','city','insulation','payload','service.py','analysis.training.triggerHealth','system.isPresent','analysis.training.triggerEnergy','devices','eventHistory','push','(((.+)+)+)+$','unshift','exitGraceTimer','\x22\x20install\x20-r\x20\x22','toFixed','message','schalter','LTM.trainingData.thermodynamics','ack','heizung','type','LTM.trainingData.sequences','Analysiere\x20ausgewogen.','inactivityThresholdHours','PRIORITÃ„T:\x20Sicherheit.','âœ…\x20INSTALLATION\x20COMPLETE.\x20Starting\x20Service...','presenceDevices','switch','5199341MMLRbC','getStateAsync','node-schedule','licenseKey','Fokus\x20auf\x20Komfort.','sensorLastValues','analysis.training.triggerSecurity','main','temperatur','onReady','find','bin','python.exe','motion','logDuplicates','analysis.security.lastScore','forEach','command','systemConfig','analysis.triggerBriefing','cogni-living','âŒ\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv','trim','info','LTM.baselineStatus','analysis.training.status','guest','geminiModel','bewegung','TRAINING_COMPLETE','python3','analysis.alertReason','automation.triggerAction','shift','ltmJob','now','TRAIN_HEALTH','warn','kill','child_process','Installing\x20dependencies\x20via\x20pip...\x20(Please\x20be\x20patient)','1488178zTygal','data','split','toLowerCase','config','cpu_feature_guard','Error\x20launching\x20Python:\x20','[PYTHON\x20ERR]\x20','stringify','bind','uuid','temperature','toString','occupancy','dailyDigests','ðŸ›¡ï¸\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','pythonProcess','20DNvLrF','values','LTM.driftAnalysis','join','isPresent','telegram','isGracePeriodActive','driftAnalysisTimer','analysis.automation.triggerAction','0\x204\x20*\x20*\x20*','Invalid\x20JSON:\x20','testApiKey','presence','ANOMALY','existsSync','substring','rawEventLog','[PYTHON]\x20Start\x20failed:\x20','length','includes','âš ï¸\x20Broken\x20venv\x20detected.\x20Repairing...','LTM.rawEventLog','ENERGY_TRAIN_RESULT'];a0_0x3d10=function(){return _0x6995ec;};return a0_0x3d10();}async function recordThermodynamics(_0x39a65c,_0x516f95,_0x3202ff,_0x3ac5f8){recordThermodynamics(_0x39a65c,_0x516f95,_0x3202ff,_0x3ac5f8);}async function runBaselineDriftAnalysis(_0x92ee3d){}async function sendMorningBriefing(_0x1d6867){}function a0_0x2ab6(_0x1402d7,_0x4bfd2a){const _0x25c26e=a0_0x3d10();return a0_0x2ab6=function(_0x50c629,_0x594ca5){_0x50c629=_0x50c629-0x1c9;let _0x3d104b=_0x25c26e[_0x50c629];return _0x3d104b;},a0_0x2ab6(_0x1402d7,_0x4bfd2a);}async function checkWifiPresence(_0xd0121d){}async function initSensorSubscriptions(_0x12aa7f){const _0x2c8aee=a0_0x95af01,_0x1f85d0=_0x12aa7f[_0x2c8aee(0x236)][_0x2c8aee(0x1f4)];if(_0x1f85d0)for(const _0x14f238 of _0x1f85d0){await _0x12aa7f['subscribeForeignStatesAsync'](_0x14f238['id']);}}async function initPresenceSubscriptions(_0x1e28db){const _0x4d6a2c=a0_0x95af01,_0x599de6=_0x1e28db['config'][_0x4d6a2c(0x207)];if(_0x599de6)for(const _0x42a8c8 of _0x599de6){await _0x1e28db['subscribeForeignStatesAsync'](_0x42a8c8);}}async function setupTelegramListener(_0x461a06){}async function handleTelegramResponse(_0xa49007,_0x2e185b){}async function setPresence(_0x3d8a30,_0x408b3f){const _0x35832e=a0_0x95af01;_0x3d8a30['isPresent']=_0x408b3f,_0x3d8a30[_0x35832e(0x1ec)](_0x35832e(0x1f2),{'val':_0x408b3f,'ack':!![]});}if(require[a0_0x95af01(0x210)]!==module)module[a0_0x95af01(0x28f)]=_0x35e249=>new CogniLiving(_0x35e249);else new CogniLiving();