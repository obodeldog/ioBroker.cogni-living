const a0_0x290fb5=a0_0x24d4;function a0_0x4beb(){const _0x40e7e2=['getSystemUUID','Lernphase\x20(','analysis.history_debug_02','testNotification','createDailyDigest','eingang','analysis.history_debug_03','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','Last\x20raw\x20event','send','\x20events','checkLtmDriftObjects','setPresence','36KoiMKO','error','analysis.isEmergency','onMessage','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','4773669WznWVI','Description','\x20min).\x20Watchdog\x20Limit:\x20','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20ungew√∂hnliche\x20n√§chtliche\x20Aktivit√§t.','cleanUpZombies','Comfort\x20Summary','Feedback\x20Log','node-schedule','sound','Drift\x20Status','status','analysis.trigger','bind','latitude','\x22\x20was\x20','isGracePeriodActive','driftAnalysisTimer','runAutopilot','system.isPresent','eventHistory','scanDevices','(((.+)+)+)+$','analysis.history_debug_00','substring','enum.functions.*','setStateAsync','analysisInterval','No\x20recorded\x20events\x20yet.','analysisHistory','geminiModel','analysis.comfortSuggestion','notifyEmailInstance','Sending\x20notification:\x20\x22','.\x20PERSONA:\x20','logDuplicates','analysisTimer','System\x20Mode','\x20sensors...','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20}\x20}','sendTo','getForeignStateAsync','splice','AI\x20Alert\x20Status','\x20Tage)','analysis.analysisHistory','triggerDailyDigest','18030PObWFw','unload','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','analysis.lastResult','toString','date','length','Activity\x20Summary','Deaktiviert\x20(Pro-Feature)','application/json','subscribeStates','LTM.driftAnalysis','notifyEmailEnabled','Cogni-Living\x20Alert','licenseKey','expire','abortExitTimer','suggestion','setupModeResetScheduler','Last\x20Result','cancel','location','N/A\x20(Pro\x20Feature)','inactivityMonitoringEnabled','notifyWhatsappRecipient','Success:\x20Compressed\x20','onReady','.\x20PR√ÑSENZ:\x20','LTM.baselineStatus','analysis.comfortSummary','indicator.alarm.fire','notifyPushoverRecipient','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','system.config','button','deviationFromBaseline','@iobroker/adapter-core','Subscribing\x20to\x20','Trigger\x20Digest','Success','pop','currentSystemMode','N/A\x20(No\x20Activity)','GUEST','isProVersion','setupLtmScheduler','events.lastEvent','common','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','info','name','state','modeResetJob','join','Fenster/T√ºr','version','2ytJWZp','@google/generative-ai','Baseline:\x20Inactive\x20(Pro\x20Feature).','loadHistoryFromState','1376328CNeCXA','checkLtmObjects','models/gemini-flash-latest','values','Aktiv\x20(','updateBaselineStatus','User\x20Feedback:\x20Alarm\x20\x22','native','[TEST]\x20','analysis.isAlert','inactivityThresholdHours','long','analysis.automation.patternDetected','submitFeedback','notifyEmailRecipient','normal','6601600YAfziV','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','isPresent','setupDriftAnalysisScheduler','Trigger\x20Analysis','analysis.automation.description','timestamp','ltmJob','systemConfig','ltmStbWindowDays','Gast','35874685gkzvbp','getStateAsync','from','baselineDrift','Urlaub','constructor','cogni-living\x20adapter\x20starting\x20(v','events.history_debug_00','Logbook','command','stringify','suggestedAction','createAllObjects','Normal','slice','NORMAL','1588358UWbHVX','onUnload','setState','sensorLastValues','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','uuid','exitTimer','log','indicator','checkLicense','type','runBaselineDriftAnalysis','unknown','trim','notifySignalInstance','Last\x20Check','extendObjectAsync','Drift\x20Analysis','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','No\x20recent\x20activity.','exports','\x20sent','config','getForeignObjectsAsync','Alert\x20Reason','onStateChange','analysis.feedbackHistory','notifyTelegramInstance','notifyPushoverEnabled','Error:\x20','Daily\x20Digests','notifyWhatsappInstance','search','summary','rawEventLog','devices','analysis.deviationFromBaseline','resetAnalysisStates','comfort','livingContext','Analysis\x20Error:\x20','cogni-living','isEmergency','7NqFIuO','notifyTelegramRecipient','3991350OukSJR','2-digit','channel','includes','LTM.driftAnalysis.driftDetails','feedbackHistory','dailyDigests','LTM.triggerDailyDigest','callback','apiKey','main','parse','LTM.processingStatus','getObjectAsync','system.mode','val','Baseline\x20Status','automationProposal','analysis.alertReason','boolean','notifyPushoverInstance','system','events.history_debug_01','map','loadRawEventLog','generateContent','driftDetails','Nein','push','exitGraceTimer','analysis.history_debug_01','testApiKey','vacation','saveRawEventLog','AI\x20Emergency\x20Status','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','activity','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','siren','toLocaleString','stateChange','LTM.dailyDigests','string','alertReason','events.history_debug_03','text.alarm','LTM.driftAnalysis.lastCheck','namespace','LTM','now','setObjectNotExistsAsync','catch','Processing\x20Status','Deviation','.\x20ORT:\x20','updateAnalysisHistory','toFixed','de-DE','\x0a\x0aA\x20(STB):\x0a','PARTY','text','ltmDriftCheckIntervalHours','sendNotification','Gemini\x20AI\x20initialized.','analysis.activitySummary','[Test]\x20Notification','LTM.rawEventLog','15PabuAZ','scanForDevices','indicator.alarm','events.history','scheduleJob','loadSystemMode','json','notifySignalRecipient','N/A','Pattern\x20Detected','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','Started\x20at\x20','processSensorEvent','sendToAsync','uuid-not-found','party','loadDailyDigests','message','checkSystemObjects','response','ROLLE:\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20KONTEXT:\x20','toISOString','lastCheck','runGeminiAnalysis','analysis.automation.suggestedAction','ack','events.history_debug_04','genAI','minDaysForBaseline','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','Starting\x20Autopilot\x20(','\x0aFEEDBACK:\x0a','saveFeedback','events.history_debug_02','delObjectAsync','ready','Drift\x20Details','replace','VACATION','saveDailyDigests','Adapter','No\x20Key','getEnums','System\x20Status\x20&\x20Control','object','lastAlertState'];a0_0x4beb=function(){return _0x40e7e2;};return a0_0x4beb();}(function(_0x417b13,_0x145c1c){const _0x2126c9=a0_0x24d4,_0x16f629=_0x417b13();while(!![]){try{const _0x48db8d=parseInt(_0x2126c9(0x15c))/0x1*(parseInt(_0x2126c9(0x18c))/0x2)+parseInt(_0x2126c9(0xf6))/0x3+-parseInt(_0x2126c9(0x160))/0x4*(-parseInt(_0x2126c9(0x1fc))/0x5)+-parseInt(_0x2126c9(0x1b9))/0x6*(-parseInt(_0x2126c9(0x1b7))/0x7)+-parseInt(_0x2126c9(0x170))/0x8+-parseInt(_0x2126c9(0xf1))/0x9*(-parseInt(_0x2126c9(0x124))/0xa)+-parseInt(_0x2126c9(0x17c))/0xb;if(_0x48db8d===_0x145c1c)break;else _0x16f629['push'](_0x16f629['shift']());}catch(_0x408182){_0x16f629['push'](_0x16f629['shift']());}}}(a0_0x4beb,0xc2c21));function a0_0x24d4(_0x4cd084,_0x3d312b){const _0xa35c21=a0_0x4beb();return a0_0x24d4=function(_0xeb479a,_0x18e5e1){_0xeb479a=_0xeb479a-0xda;let _0x4beb48=_0xa35c21[_0xeb479a];return _0x4beb48;},a0_0x24d4(_0x4cd084,_0x3d312b);}const a0_0x18e5e1=(function(){let _0x543073=!![];return function(_0x58ad64,_0x4a62d3){const _0x20f756=_0x543073?function(){if(_0x4a62d3){const _0x1e4ab6=_0x4a62d3['apply'](_0x58ad64,arguments);return _0x4a62d3=null,_0x1e4ab6;}}:function(){};return _0x543073=![],_0x20f756;};}()),a0_0xeb479a=a0_0x18e5e1(this,function(){const _0x5a0c6e=a0_0x24d4;return a0_0xeb479a['toString']()['search'](_0x5a0c6e(0x10b))[_0x5a0c6e(0x128)]()[_0x5a0c6e(0x181)](a0_0xeb479a)[_0x5a0c6e(0x1ac)](_0x5a0c6e(0x10b));});a0_0xeb479a();'use strict';const utils=require(a0_0x290fb5(0x148)),{GoogleGenerativeAI}=require(a0_0x290fb5(0x15d)),schedule=require(a0_0x290fb5(0xfd)),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL=a0_0x290fb5(0x162),ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE='0\x203\x20*\x20*\x20*',LTM_DP_RAW_LOG=a0_0x290fb5(0x1fb),LTM_DP_DAILY_DIGESTS=a0_0x290fb5(0x1e2),LTM_DP_STATUS=a0_0x290fb5(0x1c5),LTM_DP_TRIGGER_DIGEST=a0_0x290fb5(0x1c0),LTM_DP_BASELINE_STATUS=a0_0x290fb5(0x140),LTM_DP_DRIFT_CHANNEL=a0_0x290fb5(0x12f),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x290fb5(0x1bd),LTM_DP_DRIFT_LAST_CHECK=a0_0x290fb5(0x1e7),SYSTEM_DP_MODE=a0_0x290fb5(0x1c7),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',SYSTEM_MODES={'NORMAL':a0_0x290fb5(0x16f),'VACATION':a0_0x290fb5(0x1d9),'PARTY':a0_0x290fb5(0x20b),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x290fb5(0x1f4)],SYSTEM_MODES[a0_0x290fb5(0x14f)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x290fb5(0x206),'senior_aal':a0_0x290fb5(0xf9),'family':'Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','single_comfort':a0_0x290fb5(0x1de),'security':a0_0x290fb5(0x171)};class CogniLiving extends utils[a0_0x290fb5(0xde)]{constructor(_0x32e52b){const _0x2fdcbc=a0_0x290fb5;super({..._0x32e52b,'name':_0x2fdcbc(0x1b5)}),this[_0x2fdcbc(0x109)]=[],this[_0x2fdcbc(0x112)]=[],this[_0x2fdcbc(0x1be)]=[],this['rawEventLog']=[],this[_0x2fdcbc(0x1bf)]=[],this[_0x2fdcbc(0x18f)]={},this[_0x2fdcbc(0x179)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x2fdcbc(0x173)]=!![],this[_0x2fdcbc(0x192)]=null,this['exitGraceTimer']=null,this[_0x2fdcbc(0x105)]=![],this[_0x2fdcbc(0x217)]=null,this[_0x2fdcbc(0x113)]=null,this['currentSystemMode']=SYSTEM_MODES[_0x2fdcbc(0x18b)],this[_0x2fdcbc(0x150)]=![],this['lastAlertState']=![],this['systemUUID']=_0x2fdcbc(0x198),this[_0x2fdcbc(0x119)]=null,this['ltmJob']=null,this[_0x2fdcbc(0x158)]=null,this[_0x2fdcbc(0x106)]=null,this['on'](_0x2fdcbc(0x21f),this[_0x2fdcbc(0x13e)][_0x2fdcbc(0x102)](this)),this['on'](_0x2fdcbc(0x1e1),this[_0x2fdcbc(0x1a5)][_0x2fdcbc(0x102)](this)),this['on'](_0x2fdcbc(0x125),this[_0x2fdcbc(0x18d)][_0x2fdcbc(0x102)](this)),this['on'](_0x2fdcbc(0x20d),this[_0x2fdcbc(0xf4)][_0x2fdcbc(0x102)](this));}async[a0_0x290fb5(0x13e)](){const _0x1ce55a=a0_0x290fb5;this[_0x1ce55a(0x193)][_0x1ce55a(0x155)](_0x1ce55a(0x182)+this[_0x1ce55a(0x15b)]+')'),await this[_0x1ce55a(0xfa)](),this[_0x1ce55a(0x1a2)][_0x1ce55a(0x132)]=this[_0x1ce55a(0x1a2)][_0x1ce55a(0x132)]||'',this['isProVersion']=await this[_0x1ce55a(0x195)](this[_0x1ce55a(0x1a2)][_0x1ce55a(0x132)]);if(!this[_0x1ce55a(0x1a2)][_0x1ce55a(0x16a)]||this[_0x1ce55a(0x1a2)]['inactivityThresholdHours']<0.1)this[_0x1ce55a(0x1a2)][_0x1ce55a(0x16a)]=0xc;await this['loadHistoryFromState']();try{const _0x315375=await this['getForeignObjectAsync'](_0x1ce55a(0x145));_0x315375&&_0x315375[_0x1ce55a(0x153)]&&(this[_0x1ce55a(0x179)]={'latitude':_0x315375[_0x1ce55a(0x153)][_0x1ce55a(0x103)]||0x0,'longitude':_0x315375[_0x1ce55a(0x153)]['longitude']||0x0,'city':_0x315375['common']['city']||''});}catch(_0x267172){}if(this['config']['geminiApiKey'])try{this['genAI']=new GoogleGenerativeAI(this[_0x1ce55a(0x1a2)]['geminiApiKey']),this[_0x1ce55a(0x113)]=this[_0x1ce55a(0x217)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x1ce55a(0x12d)}}),this[_0x1ce55a(0x193)][_0x1ce55a(0x155)](_0x1ce55a(0x1f8));}catch(_0x5195f9){this['log'][_0x1ce55a(0xf2)]('Gemini\x20Init\x20Error:\x20'+_0x5195f9[_0x1ce55a(0x20d)]);}await this[_0x1ce55a(0x188)](),await this[_0x1ce55a(0x201)](),await this[_0x1ce55a(0x1d1)](),await this[_0x1ce55a(0x20c)](),this[_0x1ce55a(0x12e)](_0x1ce55a(0x101)),this[_0x1ce55a(0x12e)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates']('system.mode');const _0x5c9d1a=this[_0x1ce55a(0x1a2)][_0x1ce55a(0x1af)];if(_0x5c9d1a&&_0x5c9d1a['length']>0x0){this['log'][_0x1ce55a(0x155)](_0x1ce55a(0x149)+_0x5c9d1a[_0x1ce55a(0x12a)]+_0x1ce55a(0x11b));for(const _0x3af5c5 of _0x5c9d1a){if(_0x3af5c5['id']){await this['subscribeForeignStatesAsync'](_0x3af5c5['id']);try{const _0x186d4a=await this[_0x1ce55a(0x11e)](_0x3af5c5['id']);if(_0x186d4a)this['sensorLastValues'][_0x3af5c5['id']]=_0x186d4a[_0x1ce55a(0x1c8)];}catch(_0x11fbb1){}}}}if(this[_0x1ce55a(0x119)])clearInterval(this[_0x1ce55a(0x119)]);const _0x132515=this[_0x1ce55a(0x1a2)][_0x1ce55a(0x110)]||0xf;_0x132515>0x0&&(this[_0x1ce55a(0x193)]['info'](_0x1ce55a(0x21a)+_0x132515+_0x1ce55a(0xf8)+this[_0x1ce55a(0x1a2)]['inactivityThresholdHours']+'h.'),this[_0x1ce55a(0x119)]=setInterval(()=>this[_0x1ce55a(0x107)](),_0x132515*0x3c*0x3e8)),this[_0x1ce55a(0x151)](),this[_0x1ce55a(0x136)](),this[_0x1ce55a(0x174)]();}async[a0_0x290fb5(0xfa)](){const _0x334b25=a0_0x290fb5,_0x19dd68=[_0x334b25(0x10c),_0x334b25(0x1d7),_0x334b25(0xe6),_0x334b25(0xea),'analysis.history_debug_04',_0x334b25(0x183),_0x334b25(0x1cf),_0x334b25(0x21d),_0x334b25(0x1e5),_0x334b25(0x216)];for(const _0x3afc03 of _0x19dd68){try{const _0x24812d=await this[_0x334b25(0x1c6)](_0x3afc03);_0x24812d&&await this[_0x334b25(0x21e)](_0x3afc03);}catch(_0x59c27f){}}}async[a0_0x290fb5(0x15f)](){const _0x2e9e71=a0_0x290fb5;try{const _0x22d73b=await this[_0x2e9e71(0x17d)]('events.history');_0x22d73b&&_0x22d73b['val']&&(this[_0x2e9e71(0x109)]=JSON[_0x2e9e71(0x1c4)](_0x22d73b[_0x2e9e71(0x1c8)]['toString']()));}catch(_0x241731){this[_0x2e9e71(0x109)]=[];}try{const _0x2fddef=await this[_0x2e9e71(0x17d)](_0x2e9e71(0x122));if(_0x2fddef&&_0x2fddef[_0x2e9e71(0x1c8)])this[_0x2e9e71(0x112)]=JSON[_0x2e9e71(0x1c4)](_0x2fddef[_0x2e9e71(0x1c8)][_0x2e9e71(0x128)]());}catch(_0x2b4d7a){this[_0x2e9e71(0x112)]=[];}}[a0_0x290fb5(0x1a5)](_0x2adef4,_0x331456){const _0x2b13a8=a0_0x290fb5;if(!_0x331456)return;if(_0x2adef4===this[_0x2b13a8(0x1e8)]+'.'+SYSTEM_DP_MODE){_0x331456[_0x2b13a8(0x1c8)]&&Object[_0x2b13a8(0x163)](SYSTEM_MODES)[_0x2b13a8(0x1bc)](_0x331456[_0x2b13a8(0x1c8)])&&(this[_0x2b13a8(0x14d)]=_0x331456[_0x2b13a8(0x1c8)],_0x331456['val']===SYSTEM_MODES[_0x2b13a8(0xdc)]?this[_0x2b13a8(0xf0)](![]):this['setPresence'](!![]));if(!_0x331456['ack'])this[_0x2b13a8(0x18e)](_0x2adef4,{'val':this[_0x2b13a8(0x14d)],'ack':!![]});return;}if(!_0x331456[_0x2b13a8(0x215)]){_0x2adef4[_0x2b13a8(0x1bc)](_0x2b13a8(0x101))&&_0x331456[_0x2b13a8(0x1c8)]&&(this[_0x2b13a8(0x18e)](_0x2adef4,{'val':![],'ack':!![]}),this[_0x2b13a8(0x213)]());if(_0x2adef4['includes'](_0x2b13a8(0x123))&&_0x331456[_0x2b13a8(0x1c8)]){this['setState'](_0x2adef4,{'val':![],'ack':!![]});if(this[_0x2b13a8(0x150)])this['createDailyDigest']();}return;}const _0x15269d=(this['config'][_0x2b13a8(0x1af)]||[])['find'](_0x2ee4d3=>_0x2ee4d3['id']===_0x2adef4);if(_0x15269d)this[_0x2b13a8(0x208)](_0x2adef4,_0x331456,_0x15269d);}async[a0_0x290fb5(0x208)](_0x272dc2,_0x1e4556,_0x2577ad){const _0x575e5b=a0_0x290fb5;if(!_0x2577ad[_0x575e5b(0x118)]&&this[_0x575e5b(0x18f)][_0x272dc2]===_0x1e4556[_0x575e5b(0x1c8)])return;this[_0x575e5b(0x18f)][_0x272dc2]=_0x1e4556[_0x575e5b(0x1c8)];if(this[_0x575e5b(0x105)])return;const _0x135280=_0x2577ad[_0x575e5b(0x196)]===_0x575e5b(0x15a)&&(_0x2577ad[_0x575e5b(0x156)]['toLowerCase']()[_0x575e5b(0x1bc)]('haust√ºr')||_0x2577ad[_0x575e5b(0x156)]['toLowerCase']()[_0x575e5b(0x1bc)](_0x575e5b(0xe9))||_0x2577ad['location']['toLowerCase']()['includes']('flur'));_0x135280&&!_0x1e4556['val']?this['startExitTimer']():(this[_0x575e5b(0x192)]&&this[_0x575e5b(0x134)](),!this[_0x575e5b(0x173)]&&this[_0x575e5b(0x14d)]===SYSTEM_MODES['NORMAL']&&this[_0x575e5b(0xf0)](!![]));const _0x192dc7={'timestamp':_0x1e4556['ts'],'id':_0x272dc2,'name':_0x2577ad[_0x575e5b(0x156)],'value':_0x1e4556['val'],'location':_0x2577ad[_0x575e5b(0x139)],'type':_0x2577ad[_0x575e5b(0x196)]};this[_0x575e5b(0x109)]['unshift'](_0x192dc7);if(this['eventHistory'][_0x575e5b(0x12a)]>HISTORY_MAX_SIZE)this[_0x575e5b(0x109)]['pop']();await this[_0x575e5b(0x10f)](_0x575e5b(0x152),{'val':JSON['stringify'](_0x192dc7),'ack':!![]}),await this[_0x575e5b(0x10f)](_0x575e5b(0x1ff),{'val':JSON[_0x575e5b(0x186)](this[_0x575e5b(0x109)]),'ack':!![]}),this[_0x575e5b(0x1ae)]['push']({'timestamp':new Date(_0x1e4556['ts'])[_0x575e5b(0x211)](),'sensorName':_0x2577ad['name'],'location':_0x2577ad[_0x575e5b(0x139)],'value':_0x1e4556[_0x575e5b(0x1c8)]}),await this['saveRawEventLog']();}['startExitTimer'](){const _0xdf7456=a0_0x290fb5;this[_0xdf7456(0x134)](),this[_0xdf7456(0x105)]=!![],this[_0xdf7456(0x1d6)]=setTimeout(()=>{const _0x19effe=_0xdf7456;this[_0x19effe(0x105)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this['exitTimer']=setTimeout(()=>{const _0x3ed6e2=_0xdf7456;this['setPresence'](![]),this[_0x3ed6e2(0x192)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x290fb5(0x134)](){const _0x4e4cdd=a0_0x290fb5;if(this[_0x4e4cdd(0x192)])clearTimeout(this[_0x4e4cdd(0x192)]);if(this[_0x4e4cdd(0x1d6)])clearTimeout(this[_0x4e4cdd(0x1d6)]);this[_0x4e4cdd(0x192)]=null,this['exitGraceTimer']=null,this[_0x4e4cdd(0x105)]=![];}async['setPresence'](_0x5672d1){const _0xd8a85=a0_0x290fb5;if(this['isPresent']===_0x5672d1)return;this[_0xd8a85(0x173)]=_0x5672d1,await this[_0xd8a85(0x10f)](_0xd8a85(0x108),{'val':_0x5672d1,'ack':!![]});}[a0_0x290fb5(0x107)](){const _0x327dc9=a0_0x290fb5,_0xbdfd58=this[_0x327dc9(0x1a2)][_0x327dc9(0x16a)],_0x3ef712=this[_0x327dc9(0x1a2)][_0x327dc9(0x13b)],_0x395a84=this[_0x327dc9(0x109)][_0x327dc9(0x12a)]>0x0?this[_0x327dc9(0x109)][0x0][_0x327dc9(0x177)]:Date[_0x327dc9(0x1ea)](),_0x236c3e=(Date['now']()-_0x395a84)/(0x3e8*0x3c*0x3c);let _0x1d3ac1='';_0x3ef712&&this[_0x327dc9(0x14d)]===SYSTEM_MODES[_0x327dc9(0x18b)]&&this[_0x327dc9(0x173)]&&(_0x236c3e>_0xbdfd58&&(_0x1d3ac1=_0x327dc9(0x154)+_0x236c3e[_0x327dc9(0x1f1)](0x1)+_0x327dc9(0xf5)));if(_0x1d3ac1){this[_0x327dc9(0x213)](_0x1d3ac1)[_0x327dc9(0x1ec)](_0xe59725=>this[_0x327dc9(0x193)]['error'](_0xe59725));return;}const _0x5108d8=Date[_0x327dc9(0x1ea)](),_0x266ea1=_0x5108d8-_0x395a84,_0x4414e9=(this['config'][_0x327dc9(0x110)]||0xf)*0x3c*0x3e8;this[_0x327dc9(0x109)][_0x327dc9(0x12a)]>0x0&&_0x266ea1<=_0x4414e9?this[_0x327dc9(0x213)]()[_0x327dc9(0x1ec)](_0x590803=>this[_0x327dc9(0x193)][_0x327dc9(0xf2)](_0x590803)):!this[_0x327dc9(0xe3)]&&(this[_0x327dc9(0x18e)](_0x327dc9(0x169),{'val':![],'ack':!![]}),this[_0x327dc9(0x18e)]('analysis.isEmergency',{'val':![],'ack':!![]}));}async['runGeminiAnalysis'](_0x137649=''){const _0x28a59c=a0_0x290fb5;if(!this[_0x28a59c(0x113)])return;const _0x3a4331=this['eventHistory']['length']>0x0?this[_0x28a59c(0x109)]:[{'note':_0x28a59c(0x111)}],_0x5b017d=PERSONA_MAPPING[this['config']['aiPersona']||'generic'],_0x440e66=this['config'][_0x28a59c(0x1b3)]||'',_0x4cc0dc=this[_0x28a59c(0x14d)],_0x236db8=new Date(),_0x2d232e=_0x236db8[_0x28a59c(0x1e0)](_0x28a59c(0x1f2),{'weekday':_0x28a59c(0x16b),'hour':_0x28a59c(0x1ba),'minute':_0x28a59c(0x1ba)}),_0x4ed953=this[_0x28a59c(0x179)];let _0xd6790c='';if(this[_0x28a59c(0x1be)][_0x28a59c(0x12a)]>0x0){const _0x14c06b=this[_0x28a59c(0x1be)]['slice'](0x0,0x3)[_0x28a59c(0x1d0)](_0x1f4a2f=>_0x28a59c(0x166)+_0x1f4a2f[_0x28a59c(0x1e4)]+_0x28a59c(0x104)+_0x1f4a2f['rating']+'.')[_0x28a59c(0x159)]('\x0a');_0xd6790c=_0x28a59c(0x21b)+_0x14c06b+'\x0a';}const _0x1dbb50=_0x137649?_0x28a59c(0x190)+_0x137649+_0x28a59c(0x19e):'',_0x47e5dd=_0x28a59c(0x15e),_0x11b814=_0x28a59c(0x126)+_0x2d232e+_0x28a59c(0x1ef)+_0x4ed953['city']+_0x28a59c(0x172)+_0x4cc0dc+_0x28a59c(0x13f)+(this[_0x28a59c(0x173)]?'Ja':_0x28a59c(0x1d4))+_0x28a59c(0x219)+_0x440e66+_0x28a59c(0x117)+_0x5b017d+_0x28a59c(0x144)+_0x47e5dd+'\x20'+_0xd6790c+'\x20'+_0x1dbb50+_0x28a59c(0xeb)+JSON['stringify'](_0x3a4331)+_0x28a59c(0x11c);try{const _0x138e16=await this[_0x28a59c(0x113)][_0x28a59c(0x1d2)](_0x11b814),_0x45de6d=_0x138e16['response'][_0x28a59c(0x1f5)]()['replace'](/```json|```/g,'')[_0x28a59c(0x199)](),_0x3adba0=JSON[_0x28a59c(0x1c4)](_0x45de6d);await this[_0x28a59c(0x10f)](_0x28a59c(0x127),{'val':_0x45de6d,'ack':!![]}),await this['setStateAsync']('analysis.alertReason',{'val':_0x3adba0[_0x28a59c(0x1dd)][_0x28a59c(0x1e4)]||'','ack':!![]}),await this[_0x28a59c(0x10f)](_0x28a59c(0x1f9),{'val':_0x3adba0['activity'][_0x28a59c(0x1ad)]||_0x28a59c(0x204),'ack':!![]}),await this[_0x28a59c(0x10f)](_0x28a59c(0x1b0),{'val':_0x3adba0[_0x28a59c(0x1dd)][_0x28a59c(0x147)]||'N/A','ack':!![]});_0x3adba0['comfort']&&(await this['setStateAsync'](_0x28a59c(0x141),{'val':_0x3adba0['comfort']['summary']||'','ack':!![]}),await this['setStateAsync']('analysis.comfortSuggestion',{'val':_0x3adba0[_0x28a59c(0x1b2)][_0x28a59c(0x135)]||'','ack':!![]}),_0x3adba0[_0x28a59c(0x1b2)][_0x28a59c(0x1ca)]&&(await this[_0x28a59c(0x10f)](_0x28a59c(0x16c),{'val':_0x3adba0[_0x28a59c(0x1b2)][_0x28a59c(0x1ca)]['patternDetected']||![],'ack':!![]}),await this[_0x28a59c(0x10f)](_0x28a59c(0x176),{'val':_0x3adba0[_0x28a59c(0x1b2)]['automationProposal']['description']||'','ack':!![]}),await this[_0x28a59c(0x10f)](_0x28a59c(0x214),{'val':_0x3adba0[_0x28a59c(0x1b2)][_0x28a59c(0x1ca)][_0x28a59c(0x187)]||'','ack':!![]})));const _0x30a37e=_0x3adba0[_0x28a59c(0x1dd)]['isAlert']||![],_0x1fb721=_0x3adba0['activity'][_0x28a59c(0x1b6)]||![];if(_0x30a37e||_0x1fb721){await this['setStateAsync']('analysis.isAlert',{'val':!![],'ack':!![]}),await this[_0x28a59c(0x10f)](_0x28a59c(0xf3),{'val':_0x1fb721,'ack':!![]});if(!this['lastAlertState']||_0x1fb721){const _0x32699d=_0x1fb721?'üö®üö®\x20NOTFALL':'‚ö†Ô∏è\x20Alarm';this[_0x28a59c(0x1f7)](_0x32699d+':\x20'+_0x3adba0[_0x28a59c(0x1dd)][_0x28a59c(0x1e4)],![],_0x1fb721);}}else await this[_0x28a59c(0x10f)]('analysis.isAlert',{'val':![],'ack':!![]}),await this[_0x28a59c(0x10f)](_0x28a59c(0xf3),{'val':![],'ack':!![]});this[_0x28a59c(0xe3)]=_0x30a37e||_0x1fb721;const _0x1f7212={'timestamp':Date[_0x28a59c(0x1ea)](),'id':Date[_0x28a59c(0x1ea)]()['toString'](),'analysis':_0x3adba0,'systemMode':_0x4cc0dc,'isPro':this['isProVersion']};this[_0x28a59c(0x1f0)](_0x1f7212);}catch(_0x2e47cd){this[_0x28a59c(0x193)][_0x28a59c(0xf2)](_0x28a59c(0x1b4)+_0x2e47cd[_0x28a59c(0x20d)]);}}async[a0_0x290fb5(0xe8)](){const _0x254a34=a0_0x290fb5;if(!this[_0x254a34(0x150)])return;await this[_0x254a34(0x10f)](LTM_DP_STATUS,{'val':_0x254a34(0x207)+new Date()[_0x254a34(0x1e0)](),'ack':!![]});if(!this['geminiModel']||this['rawEventLog'][_0x254a34(0x12a)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x254a34(0x10f)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x4df676=JSON[_0x254a34(0x1c4)](JSON[_0x254a34(0x186)](this[_0x254a34(0x1ae)])),_0x15eb8b=(this[_0x254a34(0x1a2)][_0x254a34(0x1b3)]||'')[_0x254a34(0x10d)](0x0,0x3e8),_0x5dfc62=_0x254a34(0x210)+_0x15eb8b+'.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x254a34(0x186)](_0x4df676);try{const _0x3ad526=await this['geminiModel'][_0x254a34(0x1d2)](_0x5dfc62),_0x558e6d=JSON[_0x254a34(0x1c4)](_0x3ad526['response'][_0x254a34(0x1f5)]()['replace'](/```json|```/g,'')[_0x254a34(0x199)]());_0x558e6d[_0x254a34(0x1ad)]&&(this['dailyDigests'][_0x254a34(0x1d5)]({'timestamp':new Date()[_0x254a34(0x211)](),'eventCount':_0x4df676['length'],'summary':_0x558e6d[_0x254a34(0x1ad)],'activityLevel':_0x558e6d['activityLevel'],'systemMode':this[_0x254a34(0x14d)]}),await this[_0x254a34(0xdd)](),this['rawEventLog']=[],await this[_0x254a34(0x1da)](),await this[_0x254a34(0x10f)](LTM_DP_STATUS,{'val':_0x254a34(0x13d)+_0x4df676[_0x254a34(0x12a)]+_0x254a34(0xee),'ack':!![]}));}catch(_0x298817){await this[_0x254a34(0x10f)](LTM_DP_STATUS,{'val':_0x254a34(0x1a9)+_0x298817[_0x254a34(0x20d)],'ack':!![]});}}async[a0_0x290fb5(0x188)](){const _0x3db21c=a0_0x290fb5;await this[_0x3db21c(0x20e)](),await this[_0x3db21c(0x1eb)](_0x3db21c(0x108),{'type':_0x3db21c(0x157),'common':{'name':'Presence\x20Status','type':_0x3db21c(0x1cc),'role':'indicator','read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x152),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0xec),'type':_0x3db21c(0x1e3),'role':_0x3db21c(0x202),'read':!![],'write':![]},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x1ff),{'type':_0x3db21c(0x157),'common':{'name':'Event\x20History','type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x101),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0x175),'type':_0x3db21c(0x1cc),'role':_0x3db21c(0x146),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x127),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0x137),'type':_0x3db21c(0x1e3),'role':_0x3db21c(0x202),'read':!![],'write':![]},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x169),{'type':'state','common':{'name':_0x3db21c(0x120),'type':_0x3db21c(0x1cc),'role':_0x3db21c(0x1fe),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x3db21c(0x1eb)]('analysis.isEmergency',{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0x1db),'type':'boolean','role':_0x3db21c(0x142),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x1cb),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0x1a4),'type':_0x3db21c(0x1e3),'role':_0x3db21c(0x1e6),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x3db21c(0x1f9),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0x12b),'type':_0x3db21c(0x1e3),'role':_0x3db21c(0x1f5),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x3db21c(0x1b0),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0x1ee),'type':_0x3db21c(0x1e3),'role':_0x3db21c(0x157),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x141),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0xfb),'type':_0x3db21c(0x1e3),'role':_0x3db21c(0x1f5),'read':!![],'write':![]},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x114),{'type':_0x3db21c(0x157),'common':{'name':'Comfort\x20Suggestion','type':'string','role':_0x3db21c(0x1f5),'read':!![],'write':![]},'native':{}}),await this[_0x3db21c(0x19c)]('analysis.automation',{'type':_0x3db21c(0x1bb),'common':{'name':'Automation\x20Proposals'},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x16c),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0x205),'type':_0x3db21c(0x1cc),'role':_0x3db21c(0x194),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x3db21c(0x1eb)]('analysis.automation.description',{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0xf7),'type':_0x3db21c(0x1e3),'role':'text','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x3db21c(0x214),{'type':'state','common':{'name':'Action','type':_0x3db21c(0x1e3),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x3db21c(0x1eb)](_0x3db21c(0x122),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0x184),'type':_0x3db21c(0x1e3),'role':_0x3db21c(0x202),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x3db21c(0x1a6),{'type':_0x3db21c(0x157),'common':{'name':_0x3db21c(0xfc),'type':_0x3db21c(0x1e3),'role':_0x3db21c(0x202),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['checkLtmObjects'](),await this[_0x3db21c(0xef)]();}async['checkSystemObjects'](){const _0x393661=a0_0x290fb5;await this[_0x393661(0x19c)](_0x393661(0x1ce),{'type':'channel','common':{'name':_0x393661(0xe1)},'native':{}}),await this[_0x393661(0x19c)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x393661(0x11a),'type':_0x393661(0x1e3),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES['NORMAL']]:_0x393661(0x189),[SYSTEM_MODES[_0x393661(0xdc)]]:_0x393661(0x180),[SYSTEM_MODES[_0x393661(0x1f4)]]:'Party',[SYSTEM_MODES[_0x393661(0x14f)]]:_0x393661(0x17b)}},'native':{}});}async['sendNotification'](_0x24da9d,_0x2a8fb3=![],_0x28f9ff=![]){const _0xfa1890=a0_0x290fb5;this['log'][_0xfa1890(0x155)]((_0x2a8fb3?_0xfa1890(0x168):'')+_0xfa1890(0x116)+_0x24da9d+'\x22'+(_0x28f9ff?'\x20(EMERGENCY)':''));const _0x25465d=this['config'];let _0x2b1656=0x0;_0x25465d['notifyTelegramEnabled']&&_0x25465d[_0xfa1890(0x1a7)]&&(await this['sendToAsync'](_0x25465d[_0xfa1890(0x1a7)],_0xfa1890(0xed),{'text':_0x24da9d,'user':_0x25465d[_0xfa1890(0x1b8)]}),_0x2b1656++);if(_0x25465d[_0xfa1890(0x1a8)]&&_0x25465d[_0xfa1890(0x1cd)]){let _0x4cb08b={'message':_0x24da9d,'title':_0x28f9ff?'üö®\x20EMERGENCY':_0xfa1890(0x131),'priority':_0x28f9ff?0x2:0x1,'device':_0x25465d[_0xfa1890(0x143)]};_0x28f9ff&&(_0x4cb08b['retry']=0x1e,_0x4cb08b[_0xfa1890(0x133)]=0xe10,_0x4cb08b[_0xfa1890(0xfe)]=_0xfa1890(0x1df)),await this[_0xfa1890(0x209)](_0x25465d['notifyPushoverInstance'],'send',_0x4cb08b),_0x2b1656++;}return _0x25465d[_0xfa1890(0x130)]&&_0x25465d[_0xfa1890(0x115)]&&(await this[_0xfa1890(0x209)](_0x25465d[_0xfa1890(0x115)],_0xfa1890(0xed),{'text':_0x24da9d,'to':_0x25465d[_0xfa1890(0x16e)]}),_0x2b1656++),_0x25465d['notifyWhatsappEnabled']&&_0x25465d[_0xfa1890(0x1ab)]&&(await this[_0xfa1890(0x209)](_0x25465d[_0xfa1890(0x1ab)],'send',{'text':_0x24da9d,'phone':_0x25465d[_0xfa1890(0x13c)]}),_0x2b1656++),_0x25465d['notifySignalEnabled']&&_0x25465d[_0xfa1890(0x19a)]&&(await this[_0xfa1890(0x209)](_0x25465d[_0xfa1890(0x19a)],_0xfa1890(0xed),{'text':_0x24da9d,'phone':_0x25465d[_0xfa1890(0x203)]}),_0x2b1656++),_0x2b1656;}async[a0_0x290fb5(0x1d1)](){const _0xed99c6=a0_0x290fb5;try{const _0x43f1fe=await this[_0xed99c6(0x17d)](LTM_DP_RAW_LOG);if(_0x43f1fe&&_0x43f1fe['val'])this['rawEventLog']=JSON[_0xed99c6(0x1c4)](_0x43f1fe['val']);}catch(_0x237471){this[_0xed99c6(0x1ae)]=[];}}async['saveRawEventLog'](){const _0x306fd7=a0_0x290fb5;this[_0x306fd7(0x1ae)][_0x306fd7(0x12a)]>RAW_LOG_MAX_SIZE&&this[_0x306fd7(0x1ae)]['splice'](0x0,this['rawEventLog']['length']-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON['stringify'](this[_0x306fd7(0x1ae)]),'ack':!![]});}async[a0_0x290fb5(0x20c)](){const _0x5dd489=a0_0x290fb5;try{const _0x47a18d=await this[_0x5dd489(0x17d)](LTM_DP_DAILY_DIGESTS);if(_0x47a18d&&_0x47a18d[_0x5dd489(0x1c8)])this[_0x5dd489(0x1bf)]=JSON[_0x5dd489(0x1c4)](_0x47a18d[_0x5dd489(0x1c8)]);}catch(_0x48dcf3){this['dailyDigests']=[];}await this[_0x5dd489(0x165)]();}async['saveDailyDigests'](_0x3aa15e=!![]){const _0x5c06de=a0_0x290fb5,_0x5d0e73=this[_0x5c06de(0x1a2)]['ltmLtbWindowDays']||0x3c;this['dailyDigests'][_0x5c06de(0x12a)]>_0x5d0e73&&this[_0x5c06de(0x1bf)][_0x5c06de(0x11f)](0x0,this[_0x5c06de(0x1bf)][_0x5c06de(0x12a)]-_0x5d0e73);await this[_0x5c06de(0x10f)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5c06de(0x186)](this[_0x5c06de(0x1bf)]),'ack':!![]});if(_0x3aa15e)await this['updateBaselineStatus']();}[a0_0x290fb5(0x151)](){const _0x1e0ab1=a0_0x290fb5;if(this[_0x1e0ab1(0x178)])this[_0x1e0ab1(0x178)][_0x1e0ab1(0x138)]();if(!this['isProVersion']){this['setStateAsync'](LTM_DP_STATUS,{'val':_0x1e0ab1(0x12c),'ack':!![]});return;}this[_0x1e0ab1(0x178)]=schedule[_0x1e0ab1(0x200)](LTM_SCHEDULE,()=>this[_0x1e0ab1(0xe8)]());}[a0_0x290fb5(0x174)](){const _0x414d23=a0_0x290fb5;if(this['driftAnalysisTimer'])clearInterval(this[_0x414d23(0x106)]);if(!this['isProVersion'])return;this[_0x414d23(0x106)]=setInterval(()=>this[_0x414d23(0x197)](),(this['config'][_0x414d23(0x1f6)]||0x18)*0x36ee80),setTimeout(()=>this['runBaselineDriftAnalysis'](),0x1388);}async[a0_0x290fb5(0x1b1)](){const _0x22f36c=a0_0x290fb5;await this[_0x22f36c(0x10f)]('analysis.activitySummary',{'val':_0x22f36c(0x19f),'ack':!![]}),await this['setStateAsync'](_0x22f36c(0x1b0),{'val':this[_0x22f36c(0x150)]?_0x22f36c(0x14e):_0x22f36c(0x13a),'ack':!![]}),await this[_0x22f36c(0x10f)](_0x22f36c(0x169),{'val':![],'ack':!![]}),await this[_0x22f36c(0x10f)]('analysis.isEmergency',{'val':![],'ack':!![]}),this[_0x22f36c(0xe3)]=![];}async['updateAnalysisHistory'](_0x5c422a){const _0x8f6272=a0_0x290fb5;this[_0x8f6272(0x112)]['unshift'](_0x5c422a);if(this[_0x8f6272(0x112)][_0x8f6272(0x12a)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x8f6272(0x112)][_0x8f6272(0x14c)]();await this[_0x8f6272(0x10f)](_0x8f6272(0x122),{'val':JSON['stringify'](this['analysisHistory']),'ack':!![]});}[a0_0x290fb5(0x136)](){const _0xe36698=a0_0x290fb5;if(this[_0xe36698(0x158)])this[_0xe36698(0x158)]['cancel']();this[_0xe36698(0x158)]=schedule[_0xe36698(0x200)](MODE_RESET_SCHEDULE,async()=>{const _0x13ade4=_0xe36698;await this[_0x13ade4(0x201)](),AUTO_RESET_MODES[_0x13ade4(0x1bc)](this[_0x13ade4(0x14d)])&&await this[_0x13ade4(0x10f)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x13ade4(0x18b)],'ack':![]});});}async[a0_0x290fb5(0x165)](){const _0x23e3cf=a0_0x290fb5;if(!this[_0x23e3cf(0x150)]){await this[_0x23e3cf(0x10f)](LTM_DP_BASELINE_STATUS,{'val':_0x23e3cf(0x12c),'ack':!![]});return;}const _0x2883e4=this['dailyDigests'][_0x23e3cf(0x12a)]>=(this['config'][_0x23e3cf(0x218)]||0x7)?_0x23e3cf(0x164)+this[_0x23e3cf(0x1bf)]['length']+_0x23e3cf(0x121):_0x23e3cf(0xe5)+this[_0x23e3cf(0x1bf)][_0x23e3cf(0x12a)]+'/'+(this[_0x23e3cf(0x1a2)][_0x23e3cf(0x218)]||0x7)+')';await this[_0x23e3cf(0x10f)](LTM_DP_BASELINE_STATUS,{'val':_0x2883e4,'ack':!![]});}async[a0_0x290fb5(0x161)](){const _0x278778=a0_0x290fb5;await this[_0x278778(0x19c)](_0x278778(0x1e9),{'type':_0x278778(0x1bb),'common':{'name':_0x278778(0x1e9)},'native':{}}),await this[_0x278778(0x19c)](LTM_DP_RAW_LOG,{'type':_0x278778(0x157),'common':{'name':'Raw\x20Log','type':_0x278778(0x1e3),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x278778(0x19c)](LTM_DP_DAILY_DIGESTS,{'type':_0x278778(0x157),'common':{'name':_0x278778(0x1aa),'type':_0x278778(0x1e3),'role':_0x278778(0x202),'read':!![],'write':![]},'native':{}}),await this[_0x278778(0x19c)](LTM_DP_STATUS,{'type':_0x278778(0x157),'common':{'name':_0x278778(0x1ed),'type':_0x278778(0x1e3),'role':_0x278778(0x1f5),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x278778(0x157),'common':{'name':_0x278778(0x14a),'type':'boolean','role':_0x278778(0x146),'read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x278778(0x157),'common':{'name':_0x278778(0x1c9),'type':_0x278778(0x1e3),'role':_0x278778(0x1f5),'read':!![],'write':![]},'native':{}});}async[a0_0x290fb5(0xef)](){const _0x1450b0=a0_0x290fb5;await this[_0x1450b0(0x19c)](LTM_DP_DRIFT_CHANNEL,{'type':_0x1450b0(0x1bb),'common':{'name':_0x1450b0(0x19d)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x1450b0(0x157),'common':{'name':_0x1450b0(0xff),'type':_0x1450b0(0x1e3),'role':_0x1450b0(0x157),'read':!![],'write':![],'def':_0x1450b0(0x204)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x1450b0(0xda),'type':_0x1450b0(0x1e3),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x1450b0(0x19c)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x1450b0(0x157),'common':{'name':_0x1450b0(0x19b),'type':'number','role':_0x1450b0(0x129),'read':!![],'write':![]},'native':{}});}async[a0_0x290fb5(0x197)](){const _0x3ec6c3=a0_0x290fb5;if(!this['isProVersion']||!this[_0x3ec6c3(0x113)])return;const _0x50a378=this[_0x3ec6c3(0x1a2)][_0x3ec6c3(0x17a)]||0xe;if(this['dailyDigests'][_0x3ec6c3(0x12a)]<_0x50a378+(this[_0x3ec6c3(0x1a2)][_0x3ec6c3(0x218)]||0x7)){await this[_0x3ec6c3(0x10f)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x58c270=this[_0x3ec6c3(0x1bf)][_0x3ec6c3(0x18a)](-_0x50a378),_0x2e40a9=this[_0x3ec6c3(0x1bf)][_0x3ec6c3(0x18a)](0x0,this[_0x3ec6c3(0x1bf)][_0x3ec6c3(0x12a)]-_0x50a378),_0x598089=_0x3ec6c3(0x1dc)+JSON['stringify'](_0x2e40a9)+_0x3ec6c3(0x1f3)+JSON[_0x3ec6c3(0x186)](_0x58c270);try{const _0x1bb3ac=await this[_0x3ec6c3(0x113)][_0x3ec6c3(0x1d2)](_0x598089),_0x36df2a=JSON[_0x3ec6c3(0x1c4)](_0x1bb3ac[_0x3ec6c3(0x20f)][_0x3ec6c3(0x1f5)]()[_0x3ec6c3(0xdb)](/```json|```/g,'')[_0x3ec6c3(0x199)]());_0x36df2a['baselineDrift']&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x36df2a[_0x3ec6c3(0x17f)],'ack':!![]}),await this[_0x3ec6c3(0x10f)](LTM_DP_DRIFT_DETAILS,{'val':_0x36df2a[_0x3ec6c3(0x1d3)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x3ec6c3(0x1ea)](),'ack':!![]}));}catch(_0x249334){}}async[a0_0x290fb5(0x201)](){const _0x397ab9=a0_0x290fb5;try{const _0x208980=await this[_0x397ab9(0x17d)](SYSTEM_DP_MODE);_0x208980&&_0x208980[_0x397ab9(0x1c8)]&&Object['values'](SYSTEM_MODES)[_0x397ab9(0x1bc)](_0x208980[_0x397ab9(0x1c8)])?this[_0x397ab9(0x14d)]=_0x208980[_0x397ab9(0x1c8)]:(this[_0x397ab9(0x14d)]=SYSTEM_MODES[_0x397ab9(0x18b)],await this[_0x397ab9(0x10f)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x397ab9(0x18b)],'ack':!![]}));}catch(_0x2e0c4e){this[_0x397ab9(0x14d)]=SYSTEM_MODES[_0x397ab9(0x18b)];}}async[a0_0x290fb5(0xe4)](){const _0x22728c=a0_0x290fb5;try{const _0x238975=await this['getForeignObjectAsync']('system.meta.uuid');if(_0x238975&&_0x238975[_0x22728c(0x167)]&&_0x238975[_0x22728c(0x167)]['uuid'])return _0x238975[_0x22728c(0x167)][_0x22728c(0x191)];return _0x22728c(0x20a);}catch(_0x19e01e){return'uuid-error';}}async[a0_0x290fb5(0x195)](_0x3d5c08){const _0x44bb6f=a0_0x290fb5;if(!_0x3d5c08)return![];this['systemUUID']=await this[_0x44bb6f(0xe4)]();if(_0x3d5c08==='TEST-PRO-KEY'||_0x3d5c08['startsWith']('PRO-'))return!![];return![];}[a0_0x290fb5(0x18d)](_0x33f375){const _0x3cbb8a=a0_0x290fb5;if(this[_0x3cbb8a(0x119)])clearInterval(this[_0x3cbb8a(0x119)]);if(this[_0x3cbb8a(0x106)])clearInterval(this['driftAnalysisTimer']);if(this['ltmJob'])this['ltmJob'][_0x3cbb8a(0x138)]();if(this[_0x3cbb8a(0x158)])this[_0x3cbb8a(0x158)][_0x3cbb8a(0x138)]();if(this['exitTimer'])clearTimeout(this['exitTimer']);if(this[_0x3cbb8a(0x1d6)])clearTimeout(this['exitGraceTimer']);_0x33f375();}async[a0_0x290fb5(0xf4)](_0x5ec244){const _0x59fded=a0_0x290fb5;if(typeof _0x5ec244===_0x59fded(0xe2)&&_0x5ec244[_0x59fded(0x20d)]){if(_0x5ec244[_0x59fded(0x185)]===_0x59fded(0x1d8)){if(!_0x5ec244[_0x59fded(0x20d)][_0x59fded(0x1c2)])return this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244[_0x59fded(0x185)],{'success':![],'message':_0x59fded(0xdf)},_0x5ec244[_0x59fded(0x1c1)]);try{const _0x15ba84=new GoogleGenerativeAI(_0x5ec244[_0x59fded(0x20d)][_0x59fded(0x1c2)])['getGenerativeModel']({'model':'models/gemini-flash-latest'});await _0x15ba84['generateContent']('test'),this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244[_0x59fded(0x185)],{'success':!![],'message':_0x59fded(0x14b)},_0x5ec244['callback']);}catch(_0x147a93){this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244[_0x59fded(0x185)],{'success':![],'message':_0x147a93['message']},_0x5ec244[_0x59fded(0x1c1)]);}}else{if(_0x5ec244['command']===_0x59fded(0xe7)){const _0x53d003=await this['sendNotification'](_0x59fded(0x1fa),!![]);this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244[_0x59fded(0x185)],{'success':_0x53d003>0x0,'message':_0x53d003+_0x59fded(0x1a1)},_0x5ec244[_0x59fded(0x1c1)]);}else{if(_0x5ec244['command']==='getLtmData'){if(!this[_0x59fded(0x150)])return this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244['command'],{'success':![],'isPro':![]},_0x5ec244[_0x59fded(0x1c1)]);let _0x5582ec={'status':_0x59fded(0x204),'details':'','lastCheck':0x0};try{_0x5582ec[_0x59fded(0x100)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x59fded(0x1c8)],_0x5582ec['details']=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x59fded(0x1c8)],_0x5582ec[_0x59fded(0x212)]=(await this[_0x59fded(0x17d)](LTM_DP_DRIFT_LAST_CHECK))[_0x59fded(0x1c8)];}catch(_0x3ab6b1){}this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244[_0x59fded(0x185)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x59fded(0x1bf)],'driftAnalysis':_0x5582ec,'analysisHistory':this['analysisHistory']},_0x5ec244[_0x59fded(0x1c1)]);}else{if(_0x5ec244[_0x59fded(0x185)]===_0x59fded(0xe0)){const _0x28d903=await this[_0x59fded(0x1a3)](_0x59fded(0x10e),'enum'),_0x298704=[];if(_0x28d903)for(const _0x74327d in _0x28d903){const _0x4a028b=_0x28d903[_0x74327d],_0x134f2f=(_0x4a028b['common']&&typeof _0x4a028b[_0x59fded(0x153)][_0x59fded(0x156)]===_0x59fded(0xe2)?_0x4a028b[_0x59fded(0x153)][_0x59fded(0x156)]['de']:_0x4a028b[_0x59fded(0x153)][_0x59fded(0x156)])||_0x4a028b['common']['name'];_0x298704['push']({'id':_0x74327d,'name':_0x134f2f});}this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244[_0x59fded(0x185)],{'success':!![],'enums':_0x298704},_0x5ec244[_0x59fded(0x1c1)]);}else{if(_0x5ec244[_0x59fded(0x185)]===_0x59fded(0x10a))try{const _0x45e6e9=await this[_0x59fded(0x1fd)](_0x5ec244[_0x59fded(0x20d)]||{});this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244['command'],{'success':!![],'devices':_0x45e6e9},_0x5ec244[_0x59fded(0x1c1)]);}catch(_0x2bde0a){this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244[_0x59fded(0x185)],{'success':![],'error':_0x2bde0a['message']},_0x5ec244[_0x59fded(0x1c1)]);}else{if(_0x5ec244[_0x59fded(0x185)]===_0x59fded(0x16d)){const {historyId:_0x360d39,rating:_0x1d4993,comment:_0x2dadae,alertReason:_0x1c5741}=_0x5ec244['message'];_0x360d39&&_0x1d4993?(await this[_0x59fded(0x21c)]({'timestamp':Date['now'](),'historyId':_0x360d39,'rating':_0x1d4993,'comment':_0x2dadae,'alertReason':_0x1c5741}),this['sendTo'](_0x5ec244['from'],_0x5ec244[_0x59fded(0x185)],{'success':!![]},_0x5ec244[_0x59fded(0x1c1)])):this[_0x59fded(0x11d)](_0x5ec244[_0x59fded(0x17e)],_0x5ec244[_0x59fded(0x185)],{'success':![],'error':'Missing\x20data'},_0x5ec244[_0x59fded(0x1c1)]);}}}}}}}}}if(require[a0_0x290fb5(0x1c3)]!==module)module[a0_0x290fb5(0x1a0)]=_0x4555e8=>new CogniLiving(_0x4555e8);else new CogniLiving();