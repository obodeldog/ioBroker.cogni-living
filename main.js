const a0_0x40519e=a0_0x2f64;function a0_0x2f64(_0x44a329,_0x45d89e){const _0x548b84=a0_0x1a23();return a0_0x2f64=function(_0x941be9,_0x5a06a8){_0x941be9=_0x941be9-0x10b;let _0x1a231b=_0x548b84[_0x941be9];return _0x1a231b;},a0_0x2f64(_0x44a329,_0x45d89e);}(function(_0x55c704,_0x5536ea){const _0x45a819=a0_0x2f64,_0x377281=_0x55c704();while(!![]){try{const _0x37ae0b=parseInt(_0x45a819(0x173))/0x1+parseInt(_0x45a819(0x1ba))/0x2*(-parseInt(_0x45a819(0x110))/0x3)+parseInt(_0x45a819(0x111))/0x4*(-parseInt(_0x45a819(0x19c))/0x5)+-parseInt(_0x45a819(0x137))/0x6*(parseInt(_0x45a819(0x13c))/0x7)+parseInt(_0x45a819(0x1c7))/0x8*(parseInt(_0x45a819(0x1b3))/0x9)+-parseInt(_0x45a819(0x136))/0xa*(parseInt(_0x45a819(0x147))/0xb)+-parseInt(_0x45a819(0x1ab))/0xc*(parseInt(_0x45a819(0x130))/0xd);if(_0x37ae0b===_0x5536ea)break;else _0x377281['push'](_0x377281['shift']());}catch(_0x411ece){_0x377281['push'](_0x377281['shift']());}}}(a0_0x1a23,0xdb119));const a0_0x5a06a8=(function(){let _0x266987=!![];return function(_0x1f446e,_0x30b508){const _0x10653e=_0x266987?function(){const _0x4e21bb=a0_0x2f64;if(_0x30b508){const _0x550f7a=_0x30b508[_0x4e21bb(0x15e)](_0x1f446e,arguments);return _0x30b508=null,_0x550f7a;}}:function(){};return _0x266987=![],_0x10653e;};}()),a0_0x941be9=a0_0x5a06a8(this,function(){const _0x2e19a7=a0_0x2f64;return a0_0x941be9[_0x2e19a7(0x154)]()[_0x2e19a7(0x1a4)](_0x2e19a7(0x166))[_0x2e19a7(0x154)]()['constructor'](a0_0x941be9)[_0x2e19a7(0x1a4)](_0x2e19a7(0x166));});a0_0x941be9();function a0_0x1a23(){const _0x295ed7=['Daten\x20nicht\x20verfÃ¼gbar','main','analysisHistory','Verbindung\x20erfolgreich!','dependencyInstallInProgress','now','TRAIN_COMFORT','fill','onUnload','1563jSePWR','1175092FspRQv','setPresence','getForeignStateAsync','TRAIN_ENERGY','updateTopology','bind','./lib/python_bridge','geminiModel','send','log','LTM.dailyDigests','config','scanDevices','communicate.request','temperature','modeResetJob','stringify','setupModeResetScheduler','startSystem','./lib/setup','Kein\x20Wetter-Adapter','system.presenceWho','getEnums','onMessage','genAI','analysis.training.triggerTopology','Instanz\x20nicht\x20gefunden','notifyTelegramInstance','onReady','initSystemConfig','analysis.topology.structure','299XiGcHF','Lernphase\x20(','checkLicense','driftAnalysisTimer','.communicate.request','triggerEnergyPrediction','1270DGmdiB','846SKxAcq','version','sendTo','ready','cogni-living','2877ZWAwzI','enum','object','runAutopilot','find','runGeminiAnalysis','minDaysForBaseline','SYSTEM_MODES','PREDICT_ENERGY','pop','updated','119273aAaSTS','stopService','Kein\x20Kalender-Adapter','ltmJob','TRAIN_SECURITY','enum.functions.*','callback','response','LTM.trainingData.sequences','PYTHON_EXE','enum.rooms.*','info','exports','toString','Test','telegram','getTime','LTM.rawEventLog','push','ANALYZE_GAIT','exitTimer','motion','currentSystemMode','apply','VACATION','activityLevel','./lib/ai_agent','abortExitTimer','isGracePeriodActive','updateHealthVector','createAllObjects','(((.+)+)+)+$','getState','ack','loadSystemMode','createDailyDigest','calendarName','eventHistory','getCalendarNames','getStateAsync','isArray','initHistory','cogni-living\x20adapter\x20starting\x20(v','from','1455052iyhfgm','application/json','name','Kein\x20API\x20Key\x20Ã¼bergeben',')\x20-\x20Phase\x20C\x20(Hardened)','updateTopologyMatrix','licenseKey','systemConfig','analysis.training.triggerHealth','inactivityThresholdHours','keys','system.adapter.','@google/generative-ai','analysis.training.triggerComfort','Fehler:\x20','triggerGaitAnalysis','SYSTEM_DP_MODE','setupDriftAnalysisScheduler','toLowerCase','sendMorningBriefing','getForeignObjectsAsync','dailyDigests','runPythonHealthCheck','val','analysis.training.triggerSecurity','Adapter','sendNotification','unload','parse','generateContent','getOverviewData','Gemini\x20Init\x20Error:\x20','geminiApiKey','cancel','includes','calendarInstance','analysis.health.todayVector','stateChange','presenceDevices','Gemini\x20AI\x20initialized.','setState','5IxjEug','sensorLastValues','.system.mode','analysis.automation.autoApply','command','timestamp','Verbunden','processSensorEvent','search','./lib/installer','exitGraceTimer','online','checkAndInstall','setStateAsync','analysis.training.status','250872sPAnfv','endsWith','analysis.trigger','getHours','error','split','setHours','analysis.automation.triggerAction','15284205Konupn','Notification\x20Test\x20Failed:\x20','subscribeForeignStatesAsync','LTM.trainingData.thermodynamics','length','ANALYZE_TREND','./lib/dead_man','178iDbDcz','getGenerativeModel','onStateChange','updateLocation','./lib/topology','add','subscribeStates','checkWifiPresence','./lib/scheduler','analysis.triggerBriefing','rawEventLog','isPresent','location','8FKZeIo','type','namespace','join','getMinutes','_calName','./lib/recorder','setupLtmScheduler','message','getOutsideTemperatureNumeric','apiKey','lastAlertState','analysis.training.triggerEnergy','automation.triggerAction','SET_TOPOLOGY','runBaselineDriftAnalysis','.data.table','initZombies','devices','testApiKey','isProVersion','notifyTelegramEnabled','LTM.baselineStatus','text','common','slice','analysisTimer','triggerBriefing','NORMAL'];a0_0x1a23=function(){return _0x295ed7;};return a0_0x1a23();}'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x40519e(0x17f)),installer=require(a0_0x40519e(0x1a5)),scanner=require('./lib/scanner'),schedulers=require(a0_0x40519e(0x1c2)),topology=require(a0_0x40519e(0x1be)),setup=require(a0_0x40519e(0x124)),recorder=require(a0_0x40519e(0x1cd)),pythonBridge=require(a0_0x40519e(0x117)),aiAgent=require(a0_0x40519e(0x161)),deadMan=require(a0_0x40519e(0x1b9)),GEMINI_MODEL='models/gemini-flash-latest',ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils[a0_0x40519e(0x18c)]{constructor(_0x3f816b){const _0x53d7eb=a0_0x40519e;super({..._0x3f816b,'name':_0x53d7eb(0x13b)}),this[_0x53d7eb(0x16c)]=[],this[_0x53d7eb(0x1e6)]=[],this['rawEventLog']=[],this[_0x53d7eb(0x188)]=[],this['sensorLastValues']={},this[_0x53d7eb(0x17a)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x53d7eb(0x1c5)]=!![],this[_0x53d7eb(0x15b)]=null,this[_0x53d7eb(0x1a6)]=null,this[_0x53d7eb(0x163)]=![],this[_0x53d7eb(0x129)]=null,this[_0x53d7eb(0x118)]=null,this[_0x53d7eb(0x15d)]=setup[_0x53d7eb(0x143)][_0x53d7eb(0x1e3)],this[_0x53d7eb(0x1db)]=![],this[_0x53d7eb(0x1d2)]=![],this[_0x53d7eb(0x1e1)]=null,this[_0x53d7eb(0x14a)]=null,this[_0x53d7eb(0x120)]=null,this[_0x53d7eb(0x133)]=null,this['briefingJob']=null,this[_0x53d7eb(0x10b)]=![],this['on'](_0x53d7eb(0x13a),this[_0x53d7eb(0x12d)][_0x53d7eb(0x116)](this)),this['on'](_0x53d7eb(0x198),this['onStateChange'][_0x53d7eb(0x116)](this)),this['on'](_0x53d7eb(0x18e),this[_0x53d7eb(0x10f)]['bind'](this)),this['on'](_0x53d7eb(0x1cf),this[_0x53d7eb(0x128)][_0x53d7eb(0x116)](this));}async[a0_0x40519e(0x12d)](){const _0x190485=a0_0x40519e;this['log'][_0x190485(0x152)](_0x190485(0x171)+this[_0x190485(0x138)]+_0x190485(0x177));if(!installer[_0x190485(0x1a8)](this,()=>this[_0x190485(0x123)]()))return;}async[a0_0x40519e(0x123)](){const _0x3509e4=a0_0x40519e;await setup[_0x3509e4(0x1d8)](this);try{this[_0x3509e4(0x1db)]=await setup[_0x3509e4(0x132)](this[_0x3509e4(0x11c)][_0x3509e4(0x179)]);}catch(_0x5f10e1){}if(!this[_0x3509e4(0x11c)]['inactivityThresholdHours']||this[_0x3509e4(0x11c)][_0x3509e4(0x17c)]<0.1)this[_0x3509e4(0x11c)][_0x3509e4(0x17c)]=0xc;await setup[_0x3509e4(0x170)](this),await setup[_0x3509e4(0x12e)](this);if(this[_0x3509e4(0x11c)][_0x3509e4(0x193)])try{this[_0x3509e4(0x129)]=new GoogleGenerativeAI(this['config']['geminiApiKey']),this[_0x3509e4(0x118)]=this['genAI'][_0x3509e4(0x1bb)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x3509e4(0x174)}}),this[_0x3509e4(0x11a)]['info'](_0x3509e4(0x19a));}catch(_0x5616c7){this[_0x3509e4(0x11a)][_0x3509e4(0x1af)](_0x3509e4(0x192)+_0x5616c7[_0x3509e4(0x1cf)]);}await setup[_0x3509e4(0x165)](this),await this['loadSystemMode']();try{const _0x215ada=await this[_0x3509e4(0x16e)](_0x3509e4(0x158));if(_0x215ada&&_0x215ada[_0x3509e4(0x18a)])this[_0x3509e4(0x1c4)]=JSON['parse'](_0x215ada['val']);}catch(_0x1de6b7){this['rawEventLog']=[];}try{const _0x24813b=await this['getStateAsync'](_0x3509e4(0x11b));if(_0x24813b&&_0x24813b['val'])this['dailyDigests']=JSON[_0x3509e4(0x18f)](_0x24813b[_0x3509e4(0x18a)]);}catch(_0x14737c){this['dailyDigests']=[];}const _0x211544=this[_0x3509e4(0x188)][_0x3509e4(0x1b7)]>=(this['config'][_0x3509e4(0x142)]||0x7)?'Aktiv\x20('+this[_0x3509e4(0x188)]['length']+'\x20Tage)':_0x3509e4(0x131)+this[_0x3509e4(0x188)][_0x3509e4(0x1b7)]+'/'+(this['config'][_0x3509e4(0x142)]||0x7)+')';await this[_0x3509e4(0x1a9)](_0x3509e4(0x1dd),{'val':_0x211544,'ack':!![]}),this[_0x3509e4(0x1c0)](_0x3509e4(0x1ad)),this['subscribeStates']('LTM.triggerDailyDigest'),this['subscribeStates']('system.mode'),this[_0x3509e4(0x1c0)](_0x3509e4(0x1c3)),this[_0x3509e4(0x1c0)](_0x3509e4(0x1b2)),this[_0x3509e4(0x1c0)](_0x3509e4(0x19f)),this[_0x3509e4(0x1c0)](_0x3509e4(0x18b)),this[_0x3509e4(0x1c0)](_0x3509e4(0x17b)),this['subscribeStates'](_0x3509e4(0x1d3)),this[_0x3509e4(0x1c0)](_0x3509e4(0x180)),this[_0x3509e4(0x1c0)]('analysis.training.triggerTopology');const _0x2b149f=this[_0x3509e4(0x11c)][_0x3509e4(0x1d9)];if(_0x2b149f)for(const _0x4b529f of _0x2b149f){await this['subscribeForeignStatesAsync'](_0x4b529f['id']);}const _0x12c688=this[_0x3509e4(0x11c)]['presenceDevices'];if(_0x12c688)for(const _0x2cd5f4 of _0x12c688){await this[_0x3509e4(0x1b5)](_0x2cd5f4);}if(this[_0x3509e4(0x11c)][_0x3509e4(0x1dc)]&&this[_0x3509e4(0x11c)][_0x3509e4(0x12c)])await this[_0x3509e4(0x1b5)](this['config'][_0x3509e4(0x12c)]+_0x3509e4(0x134));setTimeout(()=>this['checkWifiPresence'](),0x1388);if(this[_0x3509e4(0x1e1)])clearInterval(this[_0x3509e4(0x1e1)]);const _0x1b0690=this[_0x3509e4(0x11c)]['analysisInterval']||0xf;_0x1b0690>0x0&&(this[_0x3509e4(0x1e1)]=setInterval(()=>{const _0x2fa538=_0x3509e4;this[_0x2fa538(0x13f)]();},_0x1b0690*0x3c*0x3e8)),schedulers[_0x3509e4(0x1ce)](this,()=>aiAgent[_0x3509e4(0x16a)](this,pythonBridge)),schedulers[_0x3509e4(0x122)](this),schedulers[_0x3509e4(0x184)](this,()=>aiAgent[_0x3509e4(0x1d6)](this)),schedulers['setupBriefingScheduler'](this,()=>aiAgent['sendMorningBriefing'](this)),pythonBridge['startService'](this,installer[_0x3509e4(0x150)]),setTimeout(async()=>{const _0xc45357=_0x3509e4;await topology[_0xc45357(0x115)](this);try{const _0x5a09b7=await this[_0xc45357(0x16e)](_0xc45357(0x12f));if(_0x5a09b7&&_0x5a09b7['val'])pythonBridge[_0xc45357(0x119)](this,_0xc45357(0x1d5),JSON['parse'](_0x5a09b7[_0xc45357(0x18a)]));}catch(_0x982dfc){}this[_0xc45357(0x189)](),this['triggerGaitAnalysis'](),this[_0xc45357(0x135)](),this[_0xc45357(0x164)]();},0x1388);}[a0_0x40519e(0x10f)](_0x1a89ab){const _0x4b5b29=a0_0x40519e;if(this[_0x4b5b29(0x1e1)])clearInterval(this['analysisTimer']);if(this['driftAnalysisTimer'])clearInterval(this[_0x4b5b29(0x133)]);if(this[_0x4b5b29(0x14a)])this[_0x4b5b29(0x14a)][_0x4b5b29(0x194)]();if(this[_0x4b5b29(0x120)])this[_0x4b5b29(0x120)][_0x4b5b29(0x194)]();if(this['briefingJob'])this['briefingJob'][_0x4b5b29(0x194)]();recorder[_0x4b5b29(0x162)](this),pythonBridge[_0x4b5b29(0x148)](this),_0x1a89ab();}async[a0_0x40519e(0x1bc)](_0x2e87b9,_0xd4e6a1){const _0x3e0d76=a0_0x40519e;if(!_0xd4e6a1||this[_0x3e0d76(0x10b)])return;if(_0x2e87b9[_0x3e0d76(0x195)](_0x3e0d76(0x156))&&_0x2e87b9[_0x3e0d76(0x1ac)](_0x3e0d76(0x11e))&&_0xd4e6a1[_0x3e0d76(0x18a)])return;if(_0x2e87b9===this[_0x3e0d76(0x1c9)]+_0x3e0d76(0x19e)){if(_0xd4e6a1[_0x3e0d76(0x18a)]&&Object['values'](setup['SYSTEM_MODES'])[_0x3e0d76(0x195)](_0xd4e6a1[_0x3e0d76(0x18a)])){this[_0x3e0d76(0x15d)]=_0xd4e6a1[_0x3e0d76(0x18a)];if(_0xd4e6a1[_0x3e0d76(0x18a)]===setup['SYSTEM_MODES'][_0x3e0d76(0x15f)])await recorder['setPresence'](this,![]);else await recorder[_0x3e0d76(0x112)](this,!![]);}if(!_0xd4e6a1[_0x3e0d76(0x168)])this[_0x3e0d76(0x19b)](_0x2e87b9,{'val':this[_0x3e0d76(0x15d)],'ack':!![]});return;}if(!_0xd4e6a1['ack']){_0x2e87b9['includes']('analysis.trigger')&&_0xd4e6a1[_0x3e0d76(0x18a)]&&(this['setState'](_0x2e87b9,{'val':![],'ack':!![]}),aiAgent[_0x3e0d76(0x141)](this));if(_0x2e87b9[_0x3e0d76(0x195)]('triggerDailyDigest')&&_0xd4e6a1[_0x3e0d76(0x18a)]){this[_0x3e0d76(0x19b)](_0x2e87b9,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent['createDailyDigest'](this,pythonBridge);}_0x2e87b9[_0x3e0d76(0x195)](_0x3e0d76(0x1e2))&&_0xd4e6a1[_0x3e0d76(0x18a)]&&(this[_0x3e0d76(0x19b)](_0x2e87b9,{'val':![],'ack':!![]}),aiAgent[_0x3e0d76(0x186)](this));_0x2e87b9['includes'](_0x3e0d76(0x1d4))&&_0xd4e6a1[_0x3e0d76(0x18a)]&&(this['setState'](_0x2e87b9,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this));if(_0x2e87b9[_0x3e0d76(0x195)]('analysis.training.triggerSecurity')&&_0xd4e6a1[_0x3e0d76(0x18a)]){this[_0x3e0d76(0x19b)](_0x2e87b9,{'val':![],'ack':!![]});if(this[_0x3e0d76(0x1db)])try{const _0x2f8680=await this[_0x3e0d76(0x16e)](_0x3e0d76(0x14f));if(_0x2f8680&&_0x2f8680[_0x3e0d76(0x18a)]){const _0x54ef35=JSON[_0x3e0d76(0x18f)](_0x2f8680[_0x3e0d76(0x18a)]);this['setStateAsync'](_0x3e0d76(0x1aa),{'val':'Sec-Training\x20started...','ack':!![]}),pythonBridge[_0x3e0d76(0x119)](this,_0x3e0d76(0x14b),{'sequences':_0x54ef35});}}catch(_0x46922b){}}if(_0x2e87b9[_0x3e0d76(0x195)](_0x3e0d76(0x17b))&&_0xd4e6a1[_0x3e0d76(0x18a)]){this[_0x3e0d76(0x19b)](_0x2e87b9,{'val':![],'ack':!![]});if(this[_0x3e0d76(0x1db)])try{const _0x3b6321=await this[_0x3e0d76(0x16e)]('LTM.dailyDigests');if(_0x3b6321&&_0x3b6321[_0x3e0d76(0x18a)])pythonBridge[_0x3e0d76(0x119)](this,'TRAIN_HEALTH',{'digests':JSON['parse'](_0x3b6321[_0x3e0d76(0x18a)])});}catch(_0xc8e001){}}if(_0x2e87b9[_0x3e0d76(0x195)](_0x3e0d76(0x1d3))&&_0xd4e6a1[_0x3e0d76(0x18a)]){this['setState'](_0x2e87b9,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x384e8e=await this[_0x3e0d76(0x16e)](_0x3e0d76(0x1b6));if(_0x384e8e&&_0x384e8e[_0x3e0d76(0x18a)])pythonBridge[_0x3e0d76(0x119)](this,_0x3e0d76(0x114),{'points':JSON['parse'](_0x384e8e[_0x3e0d76(0x18a)])});}catch(_0x38b48f){}}if(_0x2e87b9[_0x3e0d76(0x195)](_0x3e0d76(0x180))&&_0xd4e6a1['val']){this[_0x3e0d76(0x19b)](_0x2e87b9,{'val':![],'ack':!![]});if(this[_0x3e0d76(0x1db)])try{const _0x4f8ef6=await this[_0x3e0d76(0x16e)](_0x3e0d76(0x158));if(_0x4f8ef6&&_0x4f8ef6[_0x3e0d76(0x18a)])pythonBridge[_0x3e0d76(0x119)](this,_0x3e0d76(0x10d),{'events':JSON[_0x3e0d76(0x18f)](_0x4f8ef6['val'])});}catch(_0x63831c){}}_0x2e87b9[_0x3e0d76(0x195)](_0x3e0d76(0x12a))&&_0xd4e6a1[_0x3e0d76(0x18a)]&&(this[_0x3e0d76(0x19b)](_0x2e87b9,{'val':![],'ack':!![]}),topology[_0x3e0d76(0x115)](this));return;}if(this[_0x3e0d76(0x11c)][_0x3e0d76(0x199)]&&this[_0x3e0d76(0x11c)][_0x3e0d76(0x199)][_0x3e0d76(0x195)](_0x2e87b9)){await this[_0x3e0d76(0x1c1)]();return;}const _0x4ab7d1=(this[_0x3e0d76(0x11c)][_0x3e0d76(0x1d9)]||[])[_0x3e0d76(0x140)](_0x19eb54=>_0x19eb54['id']===_0x2e87b9);if(_0x4ab7d1){const _0x333db1=await recorder[_0x3e0d76(0x1a3)](this,_0x2e87b9,_0xd4e6a1,_0x4ab7d1);_0x333db1&&_0x333db1[_0x3e0d76(0x1c8)]===_0x3e0d76(0x15c)&&_0x333db1[_0x3e0d76(0x1c6)]&&this[_0x3e0d76(0x1db)]&&deadMan[_0x3e0d76(0x1bd)](this,_0x333db1[_0x3e0d76(0x1c6)]);}}async[a0_0x40519e(0x128)](_0x2f9525){const _0x243967=a0_0x40519e;if(typeof _0x2f9525===_0x243967(0x13e)&&_0x2f9525[_0x243967(0x1cf)]){if(_0x2f9525['command']===_0x243967(0x1da))try{const _0x25be79=_0x2f9525[_0x243967(0x1cf)][_0x243967(0x1d1)];if(!_0x25be79)throw new Error(_0x243967(0x176));const _0x26614d=new GoogleGenerativeAI(_0x25be79),_0x3a7c1e=_0x26614d[_0x243967(0x1bb)]({'model':GEMINI_MODEL}),_0x103b6f=await _0x3a7c1e[_0x243967(0x190)](_0x243967(0x155)),_0x6b0940=await _0x103b6f[_0x243967(0x14e)];if(_0x6b0940[_0x243967(0x1de)]())this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':!![],'message':_0x243967(0x1e7)},_0x2f9525[_0x243967(0x14d)]);else throw new Error('Keine\x20Antwort\x20von\x20Gemini');}catch(_0x9302e9){this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':![],'message':_0x9302e9[_0x243967(0x1cf)]},_0x2f9525[_0x243967(0x14d)]);}else{if(_0x2f9525[_0x243967(0x1a0)]===_0x243967(0x11d))try{const _0xd2c978=await scanner['scanForDevices'](this,_0x2f9525[_0x243967(0x1cf)]||{});this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525['command'],{'success':!![],'devices':_0xd2c978},_0x2f9525[_0x243967(0x14d)]);}catch(_0x384dbb){this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':![],'error':_0x384dbb[_0x243967(0x1cf)]},_0x2f9525[_0x243967(0x14d)]);}else{if(_0x2f9525[_0x243967(0x1a0)]===_0x243967(0x178))try{const {matrix:_0x217566}=_0x2f9525[_0x243967(0x1cf)],_0x49804e=await this[_0x243967(0x16e)](_0x243967(0x12f));if(_0x49804e&&_0x49804e[_0x243967(0x18a)]){const _0x5779ae=JSON[_0x243967(0x18f)](_0x49804e['val']);_0x5779ae['matrix']=_0x217566,_0x5779ae[_0x243967(0x146)]=Date[_0x243967(0x10c)](),await this['setStateAsync']('analysis.topology.structure',{'val':JSON['stringify'](_0x5779ae),'ack':!![]}),pythonBridge[_0x243967(0x119)](this,'SET_TOPOLOGY',_0x5779ae);}this[_0x243967(0x139)](_0x2f9525['from'],_0x2f9525[_0x243967(0x1a0)],{'success':!![]},_0x2f9525[_0x243967(0x14d)]);}catch(_0x468967){this[_0x243967(0x11a)][_0x243967(0x1af)](_0x468967);}else{if(_0x2f9525[_0x243967(0x1a0)]==='getLtmData')this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':!![],'dailyDigests':this['dailyDigests']||[],'analysisHistory':this[_0x243967(0x1e6)]||[]},_0x2f9525[_0x243967(0x14d)]);else{if(_0x2f9525[_0x243967(0x1a0)]===_0x243967(0x191)){const _0x1d5dfc=this[_0x243967(0x188)][_0x243967(0x1b7)],_0x225f5f=new Array(0x18)[_0x243967(0x10e)](0x0),_0x4d3cfd=new Date()[_0x243967(0x1b1)](0x0,0x0,0x0,0x0);this['eventHistory']&&this[_0x243967(0x16c)]['forEach'](_0x77fbf=>{const _0xcdc77c=_0x243967;if(_0x77fbf[_0xcdc77c(0x1a1)]>=_0x4d3cfd){const _0x4639c2=new Date(_0x77fbf['timestamp'])['getHours']();if(_0x4639c2>=0x0&&_0x4639c2<0x18)_0x225f5f[_0x4639c2]++;}}),this['sendTo'](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':!![],'eventHistory':this[_0x243967(0x16c)][_0x243967(0x1e0)](0x0,0xf),'stats':{'digestCount':_0x1d5dfc,'isPresent':this[_0x243967(0x1c5)],'hourlyActivity':_0x225f5f},'automation':{'detected':![]}},_0x2f9525['callback']);}else{if(_0x2f9525[_0x243967(0x1a0)]===_0x243967(0x127)){const _0xa26b8c=await this['getForeignObjectsAsync'](_0x243967(0x14c),'enum'),_0x4a8f59=[];if(_0xa26b8c)for(const _0x1a421d in _0xa26b8c){const _0x43c216=_0xa26b8c[_0x1a421d],_0x5a2c18=(_0x43c216['common']&&typeof _0x43c216['common'][_0x243967(0x175)]==='object'?_0x43c216[_0x243967(0x1df)]['name']['de']:_0x43c216[_0x243967(0x1df)][_0x243967(0x175)])||_0x43c216[_0x243967(0x1df)][_0x243967(0x175)];_0x4a8f59[_0x243967(0x159)]({'id':_0x1a421d,'name':_0x5a2c18});}const _0x31e286=await this[_0x243967(0x187)](_0x243967(0x151),_0x243967(0x13d)),_0x46f9de=[];if(_0x31e286)for(const _0x5454f9 in _0x31e286){const _0x352fbc=_0x31e286[_0x5454f9],_0x5d0738=(_0x352fbc[_0x243967(0x1df)]&&typeof _0x352fbc[_0x243967(0x1df)]['name']===_0x243967(0x13e)?_0x352fbc[_0x243967(0x1df)][_0x243967(0x175)]['de']:_0x352fbc[_0x243967(0x1df)]['name'])||_0x5454f9[_0x243967(0x1b0)]('.')[_0x243967(0x145)]();_0x46f9de['push'](_0x5d0738);}this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':!![],'enums':_0x4a8f59,'rooms':_0x46f9de},_0x2f9525['callback']);}else{if(_0x2f9525[_0x243967(0x1a0)]==='testContext')try{let _0x5e41dc=_0x243967(0x125),_0x3d04ea=_0x243967(0x149);if(this[_0x243967(0x11c)]['weatherInstance']){const _0x2d6d57=await recorder[_0x243967(0x1d0)](this);_0x5e41dc=_0x2d6d57!==null?_0x2d6d57+'Â°C':_0x243967(0x1e4);}if(this[_0x243967(0x11c)][_0x243967(0x196)]){const _0x2b073f=await this['getForeignObjectAsync'](_0x243967(0x17e)+this[_0x243967(0x11c)][_0x243967(0x196)]);_0x3d04ea=_0x2b073f?_0x243967(0x1a2):_0x243967(0x12b);}this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525['command'],{'success':!![],'weather':_0x5e41dc,'calendar':_0x3d04ea},_0x2f9525[_0x243967(0x14d)]);}catch(_0x438465){this[_0x243967(0x139)](_0x2f9525['from'],_0x2f9525[_0x243967(0x1a0)],{'success':![],'error':_0x438465[_0x243967(0x1cf)]},_0x2f9525['callback']);}else{if(_0x2f9525['command']===_0x243967(0x16d))try{const _0x88c7a6=_0x2f9525[_0x243967(0x1cf)]['instance'],_0x38fd2a=await this['getForeignStateAsync'](_0x88c7a6+_0x243967(0x1d7));let _0x5f4e1a=[];if(_0x38fd2a&&_0x38fd2a[_0x243967(0x18a)]){const _0x489527=JSON[_0x243967(0x18f)](_0x38fd2a[_0x243967(0x18a)]),_0x6b603=new Set();Array[_0x243967(0x16f)](_0x489527)&&_0x489527['forEach'](_0x7cec32=>{const _0x3fe0f0=_0x243967;if(_0x7cec32[_0x3fe0f0(0x1cc)])_0x6b603[_0x3fe0f0(0x1bf)](_0x7cec32['_calName']);else{if(_0x7cec32['calendarName'])_0x6b603['add'](_0x7cec32[_0x3fe0f0(0x16b)]);}}),_0x5f4e1a=Array[_0x243967(0x172)](_0x6b603)['sort']();}if(_0x5f4e1a[_0x243967(0x1b7)]===0x0)_0x5f4e1a=['Standard'];this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':!![],'names':_0x5f4e1a},_0x2f9525[_0x243967(0x14d)]);}catch(_0x400dae){this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':![],'error':_0x400dae['message']},_0x2f9525[_0x243967(0x14d)]);}else{if(_0x2f9525[_0x243967(0x1a0)]==='testNotification')try{await setup[_0x243967(0x18d)](this,'ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.',![],![]),this['sendTo'](_0x2f9525['from'],_0x2f9525[_0x243967(0x1a0)],{'success':!![],'message':'Gesendet'},_0x2f9525[_0x243967(0x14d)]);}catch(_0x2073c6){this[_0x243967(0x11a)][_0x243967(0x1af)](_0x243967(0x1b4)+_0x2073c6[_0x243967(0x1cf)]),this[_0x243967(0x139)](_0x2f9525[_0x243967(0x172)],_0x2f9525[_0x243967(0x1a0)],{'success':![],'message':_0x243967(0x181)+_0x2073c6[_0x243967(0x1cf)]},_0x2f9525[_0x243967(0x14d)]);}}}}}}}}}}}async[a0_0x40519e(0x169)](){const _0x47f7e9=a0_0x40519e;try{const _0x17fa2d=await this[_0x47f7e9(0x16e)](setup[_0x47f7e9(0x183)]);_0x17fa2d&&_0x17fa2d[_0x47f7e9(0x18a)]&&Object['values'](setup[_0x47f7e9(0x143)])[_0x47f7e9(0x195)](_0x17fa2d[_0x47f7e9(0x18a)])?this[_0x47f7e9(0x15d)]=_0x17fa2d[_0x47f7e9(0x18a)]:(this['currentSystemMode']=setup[_0x47f7e9(0x143)][_0x47f7e9(0x1e3)],await this[_0x47f7e9(0x1a9)](setup[_0x47f7e9(0x183)],{'val':setup[_0x47f7e9(0x143)][_0x47f7e9(0x1e3)],'ack':!![]}));}catch(_0xc82c1f){this['currentSystemMode']=setup[_0x47f7e9(0x143)]['NORMAL'];}}async[a0_0x40519e(0x1c1)](){const _0x42923f=a0_0x40519e;try{const _0x6a67ef=this[_0x42923f(0x11c)]['presenceDevices']||[];let _0x2e0dcb=![];const _0x4df003=[];for(const _0x58c82d of _0x6a67ef){try{const _0x3d116b=await this[_0x42923f(0x113)](_0x58c82d);_0x3d116b&&(_0x3d116b[_0x42923f(0x18a)]===!![]||_0x3d116b[_0x42923f(0x18a)]===_0x42923f(0x1a7)||_0x3d116b[_0x42923f(0x18a)]===0x1)&&(_0x2e0dcb=!![],_0x4df003['push'](_0x58c82d));}catch(_0x253976){}}return await this['setStateAsync'](_0x42923f(0x126),{'val':_0x4df003[_0x42923f(0x1ca)](',\x20'),'ack':!![]}),_0x2e0dcb&&(this[_0x42923f(0x15b)]&&(this[_0x42923f(0x11a)][_0x42923f(0x152)]('WiFi\x20Presence\x20detected.'),recorder[_0x42923f(0x162)](this)),!this['isPresent']&&this[_0x42923f(0x15d)]===setup[_0x42923f(0x143)]['NORMAL']&&await recorder[_0x42923f(0x112)](this,!![])),_0x2e0dcb;}catch(_0x4bbb3e){return![];}}async[a0_0x40519e(0x13f)](){const _0x3078d8=a0_0x40519e;this['log']['debug']('ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...'),await aiAgent[_0x3078d8(0x141)](this),this['updateHealthVector'](),this[_0x3078d8(0x182)](),this['triggerEnergyPrediction']();}[a0_0x40519e(0x182)](){const _0x16e3f3=a0_0x40519e;if(!this['isProVersion'])return;try{this[_0x16e3f3(0x167)]('LTM.trainingData.sequences',(_0x58d5c0,_0x467ad1)=>{const _0x19f87c=_0x16e3f3;_0x467ad1&&_0x467ad1[_0x19f87c(0x18a)]&&pythonBridge['send'](this,_0x19f87c(0x15a),{'sequences':JSON['parse'](_0x467ad1[_0x19f87c(0x18a)])});});}catch(_0x572f14){}}async['triggerEnergyPrediction'](){const _0x5c70af=a0_0x40519e;if(!this[_0x5c70af(0x1db)])return;try{const _0x12806f=await recorder['getOutsideTemperatureNumeric'](this);if(_0x12806f===null)return;const _0xa9f9be={},_0x490015=this[_0x5c70af(0x11c)][_0x5c70af(0x1d9)]||[];for(const _0x5981e1 of _0x490015){if(_0x5981e1[_0x5c70af(0x1c8)]===_0x5c70af(0x11f)&&_0x5981e1[_0x5c70af(0x1c6)]){const _0x4d4440=this[_0x5c70af(0x19d)][_0x5981e1['id']];if(_0x4d4440!==undefined)_0xa9f9be[_0x5981e1[_0x5c70af(0x1c6)]]=_0x4d4440;}}Object[_0x5c70af(0x17d)](_0xa9f9be)[_0x5c70af(0x1b7)]>0x0&&pythonBridge[_0x5c70af(0x119)](this,_0x5c70af(0x144),{'current_temps':_0xa9f9be,'t_out':_0x12806f});}catch(_0x56f479){}}[a0_0x40519e(0x164)](){const _0x7979b0=a0_0x40519e;if(!this[_0x7979b0(0x1c4)]||this[_0x7979b0(0x1c4)][_0x7979b0(0x1b7)]===0x0)return;const _0x407a3f=new Array(0x60)[_0x7979b0(0x10e)](0x0),_0x13af40=new Date()[_0x7979b0(0x1b1)](0x0,0x0,0x0,0x0);this['rawEventLog']['forEach'](_0x170bb7=>{const _0x412a0d=_0x7979b0,_0x3b6669=new Date(_0x170bb7[_0x412a0d(0x1a1)]);if(_0x3b6669[_0x412a0d(0x157)]()>=_0x13af40){const _0x4096ea=_0x3b6669[_0x412a0d(0x1ae)](),_0x503043=_0x3b6669[_0x412a0d(0x1cb)](),_0x4449e7=_0x4096ea*0x4+Math['floor'](_0x503043/0xf);if(_0x4449e7>=0x0&&_0x4449e7<0x60)_0x407a3f[_0x4449e7]++;}}),this['setStateAsync'](_0x7979b0(0x197),{'val':JSON[_0x7979b0(0x121)](_0x407a3f),'ack':!![]});}['runPythonHealthCheck'](){const _0x5bc42f=a0_0x40519e;if(!this[_0x5bc42f(0x188)]||this[_0x5bc42f(0x188)]['length']<0x2)return;const _0x154d5d=this[_0x5bc42f(0x188)]['map'](_0x506d46=>{const _0xaeba8=_0x5bc42f,_0x2eca37=(_0x506d46[_0xaeba8(0x160)]||'')[_0xaeba8(0x185)]();return ACTIVITY_LEVEL_MAP[_0x2eca37]||0x32;});pythonBridge['send'](this,_0x5bc42f(0x1b8),{'values':_0x154d5d,'tag':'Activity-Level'});}}if(require[a0_0x40519e(0x1e5)]!==module)module[a0_0x40519e(0x153)]=_0x560380=>new CogniLiving(_0x560380);else new CogniLiving();