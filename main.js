const a0_0x42ed3a=a0_0x5743;(function(_0x16b69e,_0x1951f4){const _0x63347b=a0_0x5743,_0xca7e1a=_0x16b69e();while(!![]){try{const _0x4213bb=-parseInt(_0x63347b(0x104))/0x1+parseInt(_0x63347b(0x273))/0x2*(-parseInt(_0x63347b(0x191))/0x3)+-parseInt(_0x63347b(0x2f0))/0x4+-parseInt(_0x63347b(0x140))/0x5*(parseInt(_0x63347b(0x307))/0x6)+-parseInt(_0x63347b(0x268))/0x7+-parseInt(_0x63347b(0x194))/0x8*(-parseInt(_0x63347b(0x16d))/0x9)+-parseInt(_0x63347b(0x1d2))/0xa*(-parseInt(_0x63347b(0x264))/0xb);if(_0x4213bb===_0x1951f4)break;else _0xca7e1a['push'](_0xca7e1a['shift']());}catch(_0x10db12){_0xca7e1a['push'](_0xca7e1a['shift']());}}}(a0_0xb1c8,0x75903));const a0_0x3009a6=(function(){let _0x211ecf=!![];return function(_0x436964,_0x5b9f60){const _0xb21bd4=_0x211ecf?function(){const _0x42866c=a0_0x5743;if(_0x5b9f60){const _0xf76cf1=_0x5b9f60[_0x42866c(0x220)](_0x436964,arguments);return _0x5b9f60=null,_0xf76cf1;}}:function(){};return _0x211ecf=![],_0xb21bd4;};}()),a0_0x87b78c=a0_0x3009a6(this,function(){const _0x36c7b4=a0_0x5743;return a0_0x87b78c[_0x36c7b4(0x1bd)]()['search']('(((.+)+)+)+$')[_0x36c7b4(0x1bd)]()[_0x36c7b4(0x289)](a0_0x87b78c)['search'](_0x36c7b4(0x305));});a0_0x87b78c();'use strict';const utils=require(a0_0x42ed3a(0x292)),{GoogleGenerativeAI}=require(a0_0x42ed3a(0x123)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x42ed3a(0x179)),path=require(a0_0x42ed3a(0x16e)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x42ed3a(0x312),LTM_SCHEDULE=a0_0x42ed3a(0x1ba),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x42ed3a(0x2b4),LTM_DP_DAILY_DIGESTS=a0_0x42ed3a(0x17a),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x42ed3a(0x2ac),LTM_DP_BASELINE_STATUS=a0_0x42ed3a(0x16a),LTM_DP_DRIFT_CHANNEL=a0_0x42ed3a(0x19f),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x42ed3a(0x109),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x42ed3a(0x2c2),HARD_IGNORE_TERMS=[a0_0x42ed3a(0x2df),a0_0x42ed3a(0x1f8),a0_0x42ed3a(0x1e1),a0_0x42ed3a(0x2d4),'lowbat',a0_0x42ed3a(0x1c6),a0_0x42ed3a(0x2a4),a0_0x42ed3a(0x222),a0_0x42ed3a(0x1be),a0_0x42ed3a(0x13f),a0_0x42ed3a(0x21c),'direction',a0_0x42ed3a(0x159),a0_0x42ed3a(0x1b4),a0_0x42ed3a(0x112),'firmware',a0_0x42ed3a(0x203),'link_quality'],BAD_NAMES=[a0_0x42ed3a(0x309),a0_0x42ed3a(0x2d9),'state',a0_0x42ed3a(0x19d),a0_0x42ed3a(0x235),a0_0x42ed3a(0x128),'on','off',a0_0x42ed3a(0x205),a0_0x42ed3a(0x11d),a0_0x42ed3a(0x2bc),a0_0x42ed3a(0x2aa),a0_0x42ed3a(0x228),a0_0x42ed3a(0x189),a0_0x42ed3a(0x1ac),'presence',a0_0x42ed3a(0x24d),a0_0x42ed3a(0x253),a0_0x42ed3a(0x213),a0_0x42ed3a(0x2c1),a0_0x42ed3a(0x2dc),'setpoint',a0_0x42ed3a(0x1f4),'actual_temperature','set_temperature'],ADAPTER_BLACKLIST=[a0_0x42ed3a(0x302),a0_0x42ed3a(0x2a8),'info.',a0_0x42ed3a(0x2e6),'history.','material.',a0_0x42ed3a(0x2cb),a0_0x42ed3a(0x1ad),a0_0x42ed3a(0x2c6),a0_0x42ed3a(0x22d),a0_0x42ed3a(0x2d8)],SYSTEM_MODES={'NORMAL':a0_0x42ed3a(0x231),'VACATION':'vacation','PARTY':a0_0x42ed3a(0x137),'GUEST':a0_0x42ed3a(0x147)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x42ed3a(0x30d)],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x42ed3a(0x224),'family':a0_0x42ed3a(0x2e1),'single_comfort':a0_0x42ed3a(0x103),'security':a0_0x42ed3a(0x20f)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0xe80329){const _0x3bbd22=a0_0x42ed3a;try{const _0x4373aa=[_0x3bbd22(0x16b),_0x3bbd22(0x23f)];for(const _0x4e9b32 of _0x4373aa){try{const _0xc4a434=await _0xe80329[_0x3bbd22(0x1ae)](_0x4e9b32);_0xc4a434&&await _0xe80329[_0x3bbd22(0x279)](_0x4e9b32);}catch(_0x5a72dd){}}}catch(_0x2a4437){}}async function initHistory(_0x22b867){const _0x4bdcee=a0_0x42ed3a;try{const _0x348d55=await _0x22b867['getStateAsync']('events.history');_0x348d55&&_0x348d55[_0x4bdcee(0x1f0)]&&(_0x22b867[_0x4bdcee(0x2d6)]=JSON[_0x4bdcee(0x2de)](_0x348d55[_0x4bdcee(0x1f0)][_0x4bdcee(0x1bd)]()));}catch(_0x519789){_0x22b867[_0x4bdcee(0x2d6)]=[];}try{const _0x133d4a=await _0x22b867[_0x4bdcee(0x156)](_0x4bdcee(0x299));if(_0x133d4a&&_0x133d4a[_0x4bdcee(0x1f0)])_0x22b867[_0x4bdcee(0x24a)]=JSON[_0x4bdcee(0x2de)](_0x133d4a[_0x4bdcee(0x1f0)][_0x4bdcee(0x1bd)]());}catch(_0x4a321d){_0x22b867['analysisHistory']=[];}if(_0x22b867[_0x4bdcee(0x2d6)]&&_0x22b867['eventHistory'][_0x4bdcee(0x2f3)]>0x0){_0x22b867[_0x4bdcee(0x257)]['info'](_0x4bdcee(0x154)+_0x22b867['eventHistory']['length']+_0x4bdcee(0x1c3));for(let _0x210b7e=_0x22b867['eventHistory'][_0x4bdcee(0x2f3)]-0x1;_0x210b7e>=0x0;_0x210b7e--){const _0x22e0b7=_0x22b867['eventHistory'][_0x210b7e];_0x22e0b7&&_0x22e0b7['id']!==undefined&&_0x22e0b7['value']!==undefined&&(_0x22b867[_0x4bdcee(0x126)][_0x22e0b7['id']]=_0x22e0b7['value']);}}}async function initSystemConfig(_0x57e0f3){const _0x3045d0=a0_0x42ed3a;try{const _0x39450b=await _0x57e0f3[_0x3045d0(0x2f2)](_0x3045d0(0x25d));_0x39450b&&_0x39450b['common']&&(_0x57e0f3['systemConfig']={'latitude':_0x39450b[_0x3045d0(0x1f7)][_0x3045d0(0x2a5)]||0x0,'longitude':_0x39450b['common'][_0x3045d0(0x162)]||0x0,'city':_0x39450b[_0x3045d0(0x1f7)][_0x3045d0(0x2cd)]||''});}catch(_0x66540b){}}async function checkLicense(_0x4bf3cc,_0x4fc916){const _0x4b2827=a0_0x42ed3a;if(!_0x4fc916)return![];_0x4bf3cc[_0x4b2827(0x200)]=await getSystemUUID(_0x4bf3cc);if(_0x4fc916===_0x4b2827(0x225)||_0x4fc916[_0x4b2827(0x136)](_0x4b2827(0x2ec)))return!![];return![];}async function getSystemUUID(_0x68d826){const _0x2b13a4=a0_0x42ed3a;try{const _0x5e9a53=await _0x68d826['getForeignObjectAsync'](_0x2b13a4(0x1a0));if(_0x5e9a53&&_0x5e9a53[_0x2b13a4(0x214)]&&_0x5e9a53[_0x2b13a4(0x214)][_0x2b13a4(0x1e5)])return _0x5e9a53[_0x2b13a4(0x214)][_0x2b13a4(0x1e5)];return _0x2b13a4(0x176);}catch(_0x385dea){return _0x2b13a4(0x1e8);}}async function createAllObjects(_0x415cae){const _0x37ed94=a0_0x42ed3a;await checkSystemObjects(_0x415cae),await _0x415cae['setObjectNotExistsAsync'](_0x37ed94(0x24c),{'type':_0x37ed94(0x120),'common':{'name':'Who\x20is\x20present?','type':'string','role':_0x37ed94(0x1fc),'read':!![],'write':![],'def':''},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x201),{'type':_0x37ed94(0x120),'common':{'name':'Last\x20raw\x20event','type':_0x37ed94(0x2b5),'role':_0x37ed94(0x153),'read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x22a),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x148),'type':_0x37ed94(0x2b5),'role':'json','read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)]('analysis.trigger',{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x2b1),'type':_0x37ed94(0x142),'role':_0x37ed94(0x27e),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x415cae['setObjectNotExistsAsync'](_0x37ed94(0x244),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x138),'type':_0x37ed94(0x142),'role':_0x37ed94(0x27e),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x2c7),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x21d),'type':_0x37ed94(0x2b5),'role':_0x37ed94(0x153),'read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)]('analysis.isAlert',{'type':_0x37ed94(0x120),'common':{'name':'AI\x20Alert\x20Status','type':_0x37ed94(0x142),'role':_0x37ed94(0x295),'read':!![],'write':![],'def':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x135),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x1b7),'type':_0x37ed94(0x142),'role':_0x37ed94(0x27d),'read':!![],'write':![],'def':![]},'native':{}}),await _0x415cae['setObjectNotExistsAsync']('analysis.alertReason',{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x2a6),'type':_0x37ed94(0x2b5),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)]('analysis.activitySummary',{'type':_0x37ed94(0x120),'common':{'name':'Activity\x20Summary','type':_0x37ed94(0x2b5),'role':'text','read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)]('analysis.deviationFromBaseline',{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x217),'type':'string','role':'state','read':!![],'write':![],'def':_0x37ed94(0x15d)},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x2b0),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x1d3),'type':_0x37ed94(0x2b5),'role':'text','read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x1ab),{'type':'state','common':{'name':_0x37ed94(0x15a),'type':_0x37ed94(0x2b5),'role':_0x37ed94(0x1fc),'read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x19b)](_0x37ed94(0x290),{'type':_0x37ed94(0x28a),'common':{'name':_0x37ed94(0x26d)},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x12d),{'type':_0x37ed94(0x120),'common':{'name':'Pattern\x20Detected','type':_0x37ed94(0x142),'role':_0x37ed94(0x1ff),'read':!![],'write':![],'def':![]},'native':{}}),await _0x415cae['setObjectNotExistsAsync'](_0x37ed94(0x18c),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x255),'type':_0x37ed94(0x2b5),'role':_0x37ed94(0x1fc),'read':!![],'write':![]},'native':{}}),await _0x415cae['setObjectNotExistsAsync'](_0x37ed94(0x178),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x303),'type':_0x37ed94(0x2b5),'role':'text','read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x2bb),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x17e),'type':_0x37ed94(0x2b5),'role':_0x37ed94(0x1fc),'read':!![],'write':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x1af),{'type':_0x37ed94(0x120),'common':{'name':'Target\x20Value','type':_0x37ed94(0x2b5),'role':'text','read':!![],'write':![]},'native':{}}),await _0x415cae['setObjectNotExistsAsync']('analysis.automation.autoApply',{'type':'state','common':{'name':'Auto\x20Apply\x20Rule','type':_0x37ed94(0x142),'role':_0x37ed94(0x205),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)]('analysis.automation.triggerAction',{'type':'state','common':{'name':'Trigger\x20Action\x20Now','type':_0x37ed94(0x142),'role':_0x37ed94(0x27e),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x299),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x1a4),'type':'string','role':_0x37ed94(0x153),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x2a0),{'type':_0x37ed94(0x120),'common':{'name':'Feedback\x20Log','type':'string','role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x415cae['extendObjectAsync'](_0x37ed94(0x2eb),{'type':'channel','common':{'name':_0x37ed94(0x2fe)},'native':{}}),await _0x415cae['setObjectNotExistsAsync'](_0x37ed94(0x1c2),{'type':'state','common':{'name':_0x37ed94(0x108),'type':_0x37ed94(0x1ee),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x415cae[_0x37ed94(0x288)]('analysis.health.restlessness',{'type':_0x37ed94(0x120),'common':{'name':'Restlessness\x20Level','type':_0x37ed94(0x2b5),'role':_0x37ed94(0x1fc),'read':!![],'write':![],'def':'none'},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x19a),{'type':'state','common':{'name':_0x37ed94(0x30b),'type':_0x37ed94(0x2b5),'role':_0x37ed94(0x1fc),'read':!![],'write':![],'def':''},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x23c),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x117),'type':'string','role':_0x37ed94(0x1fc),'read':!![],'write':![],'def':_0x37ed94(0x15d)},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x16f),{'type':'state','common':{'name':_0x37ed94(0x23b),'type':_0x37ed94(0x1ee),'role':'value','read':!![],'write':![],'def':0x0},'native':{}}),await _0x415cae[_0x37ed94(0x19b)](_0x37ed94(0x1e3),{'type':_0x37ed94(0x28a),'common':{'name':_0x37ed94(0x293)},'native':{}}),await _0x415cae[_0x37ed94(0x288)](_0x37ed94(0x2ba),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x22f),'type':_0x37ed94(0x2b5),'role':_0x37ed94(0x153),'read':!![],'write':![],'def':'[]','desc':'Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training'},'native':{}}),await _0x415cae['setObjectNotExistsAsync'](_0x37ed94(0x2ef),{'type':_0x37ed94(0x120),'common':{'name':_0x37ed94(0x29e),'type':_0x37ed94(0x2b5),'role':'json','read':!![],'write':![],'def':'[]','desc':'Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time'},'native':{}}),await checkLtmObjects(_0x415cae),await checkLtmDriftObjects(_0x415cae);}async function checkSystemObjects(_0x127271){const _0x2e1607=a0_0x42ed3a;await _0x127271['extendObjectAsync'](_0x2e1607(0x285),{'type':_0x2e1607(0x28a),'common':{'name':_0x2e1607(0x181)},'native':{}}),await _0x127271['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x2e1607(0x120),'common':{'name':_0x2e1607(0x2d1),'type':'string','role':_0x2e1607(0x120),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x2e1607(0x13b)],'states':{[SYSTEM_MODES[_0x2e1607(0x13b)]]:'Normal',[SYSTEM_MODES[_0x2e1607(0x1a8)]]:_0x2e1607(0x163),[SYSTEM_MODES[_0x2e1607(0x30d)]]:_0x2e1607(0x2b9),[SYSTEM_MODES['GUEST']]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x527db5){const _0x5f1dc1=a0_0x42ed3a;await _0x527db5[_0x5f1dc1(0x19b)](_0x5f1dc1(0x258),{'type':_0x5f1dc1(0x28a),'common':{'name':'LTM'},'native':{}}),await _0x527db5[_0x5f1dc1(0x19b)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':'Raw\x20Log','type':'string','role':_0x5f1dc1(0x153),'read':!![],'write':![]},'native':{}}),await _0x527db5['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x5f1dc1(0x120),'common':{'name':_0x5f1dc1(0x296),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x527db5['extendObjectAsync'](LTM_DP_STATUS,{'type':'state','common':{'name':_0x5f1dc1(0x186),'type':_0x5f1dc1(0x2b5),'role':_0x5f1dc1(0x1fc),'read':!![],'write':![]},'native':{}}),await _0x527db5['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x5f1dc1(0x2e7),'type':_0x5f1dc1(0x142),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x527db5[_0x5f1dc1(0x19b)](LTM_DP_BASELINE_STATUS,{'type':_0x5f1dc1(0x120),'common':{'name':_0x5f1dc1(0x173),'type':_0x5f1dc1(0x2b5),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4ceef4){const _0x273c0f=a0_0x42ed3a;await _0x4ceef4[_0x273c0f(0x19b)](LTM_DP_DRIFT_CHANNEL,{'type':_0x273c0f(0x28a),'common':{'name':_0x273c0f(0x276)},'native':{}}),await _0x4ceef4[_0x273c0f(0x19b)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':'Drift\x20Status','type':'string','role':_0x273c0f(0x120),'read':!![],'write':![],'def':_0x273c0f(0x15d)},'native':{}}),await _0x4ceef4[_0x273c0f(0x19b)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':'Drift\x20Details','type':_0x273c0f(0x2b5),'role':'text','read':!![],'write':![]},'native':{}}),await _0x4ceef4[_0x273c0f(0x19b)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x273c0f(0x120),'common':{'name':_0x273c0f(0x168),'type':'number','role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x1a35b8){const _0xd79cf=a0_0x42ed3a;try{const _0x56eafc=await _0x1a35b8[_0xd79cf(0x156)](SYSTEM_DP_MODE);_0x56eafc&&_0x56eafc[_0xd79cf(0x1f0)]&&Object[_0xd79cf(0x1e0)](SYSTEM_MODES)[_0xd79cf(0x20c)](_0x56eafc[_0xd79cf(0x1f0)])?_0x1a35b8[_0xd79cf(0x275)]=_0x56eafc['val']:(_0x1a35b8[_0xd79cf(0x275)]=SYSTEM_MODES['NORMAL'],await _0x1a35b8[_0xd79cf(0x2fb)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x4d869d){_0x1a35b8[_0xd79cf(0x275)]=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0x738622){const _0x14b088=a0_0x42ed3a;try{const _0x8a940e=await _0x738622['getStateAsync'](LTM_DP_RAW_LOG);if(_0x8a940e&&_0x8a940e[_0x14b088(0x1f0)])_0x738622[_0x14b088(0x114)]=JSON[_0x14b088(0x2de)](_0x8a940e[_0x14b088(0x1f0)]);}catch(_0x1ca4e8){_0x738622[_0x14b088(0x114)]=[];}}async function saveRawEventLog(_0x3304b1){const _0x335a75=a0_0x42ed3a;_0x3304b1[_0x335a75(0x114)][_0x335a75(0x2f3)]>RAW_LOG_MAX_SIZE&&_0x3304b1[_0x335a75(0x114)][_0x335a75(0x2be)](0x0,_0x3304b1[_0x335a75(0x114)]['length']-RAW_LOG_MAX_SIZE),await _0x3304b1[_0x335a75(0x2fb)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x3304b1[_0x335a75(0x114)]),'ack':!![]});}async function loadDailyDigests(_0x37eff4){const _0x9c4ce5=a0_0x42ed3a;try{const _0x2b42fd=await _0x37eff4[_0x9c4ce5(0x156)](LTM_DP_DAILY_DIGESTS);if(_0x2b42fd&&_0x2b42fd[_0x9c4ce5(0x1f0)])_0x37eff4[_0x9c4ce5(0x1d7)]=JSON[_0x9c4ce5(0x2de)](_0x2b42fd[_0x9c4ce5(0x1f0)]);}catch(_0x506447){_0x37eff4['dailyDigests']=[];}await updateBaselineStatus(_0x37eff4);}async function saveDailyDigests(_0x2e0179,_0x5abe9b=!![]){const _0x17f2ff=a0_0x42ed3a,_0x361937=_0x2e0179['config'][_0x17f2ff(0x318)]||0x3c;_0x2e0179[_0x17f2ff(0x1d7)][_0x17f2ff(0x2f3)]>_0x361937&&_0x2e0179['dailyDigests'][_0x17f2ff(0x2be)](0x0,_0x2e0179[_0x17f2ff(0x1d7)]['length']-_0x361937);await _0x2e0179[_0x17f2ff(0x2fb)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x17f2ff(0x2c9)](_0x2e0179[_0x17f2ff(0x1d7)]),'ack':!![]});if(_0x5abe9b)await updateBaselineStatus(_0x2e0179);}async function updateAnalysisHistory(_0x483460,_0x2d5352){const _0x3dd875=a0_0x42ed3a;_0x483460[_0x3dd875(0x24a)]['unshift'](_0x2d5352);if(_0x483460['analysisHistory']['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x483460[_0x3dd875(0x24a)][_0x3dd875(0x18e)]();await _0x483460[_0x3dd875(0x2fb)]('analysis.analysisHistory',{'val':JSON['stringify'](_0x483460[_0x3dd875(0x24a)]),'ack':!![]});}async function updateBaselineStatus(_0x5c2ca6){const _0x5ad4d0=a0_0x42ed3a;if(!_0x5c2ca6[_0x5ad4d0(0x238)]){await _0x5c2ca6[_0x5ad4d0(0x2fb)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x26d288=_0x5c2ca6[_0x5ad4d0(0x1d7)][_0x5ad4d0(0x2f3)]>=(_0x5c2ca6[_0x5ad4d0(0x16c)]['minDaysForBaseline']||0x7)?_0x5ad4d0(0x195)+_0x5c2ca6['dailyDigests'][_0x5ad4d0(0x2f3)]+_0x5ad4d0(0x143):_0x5ad4d0(0x11e)+_0x5c2ca6[_0x5ad4d0(0x1d7)][_0x5ad4d0(0x2f3)]+'/'+(_0x5c2ca6['config'][_0x5ad4d0(0x232)]||0x7)+')';await _0x5c2ca6[_0x5ad4d0(0x2fb)](LTM_DP_BASELINE_STATUS,{'val':_0x26d288,'ack':!![]});}async function initSensorSubscriptions(_0x5d369b){const _0x10729c=a0_0x42ed3a,_0x251f2b=_0x5d369b[_0x10729c(0x16c)][_0x10729c(0x291)];if(_0x251f2b&&_0x251f2b['length']>0x0){_0x5d369b[_0x10729c(0x257)][_0x10729c(0x15e)](_0x10729c(0x165)+_0x251f2b[_0x10729c(0x2f3)]+'\x20sensors...');for(const _0x4974b4 of _0x251f2b){if(_0x4974b4['id']){await _0x5d369b[_0x10729c(0x1b3)](_0x4974b4['id']);try{const _0x36838d=await _0x5d369b[_0x10729c(0x14f)](_0x4974b4['id']);if(_0x36838d)_0x5d369b[_0x10729c(0x126)][_0x4974b4['id']]=_0x36838d[_0x10729c(0x1f0)];}catch(_0x1a8c79){}}}}}async function initPresenceSubscriptions(_0x2d73c5){const _0x210407=a0_0x42ed3a,_0xff247d=_0x2d73c5[_0x210407(0x16c)][_0x210407(0x185)]||[];if(_0xff247d[_0x210407(0x2f3)]>0x0){_0x2d73c5[_0x210407(0x257)]['info'](_0x210407(0x165)+_0xff247d['length']+_0x210407(0x107));for(const _0x28c4a6 of _0xff247d){await _0x2d73c5[_0x210407(0x1b3)](_0x28c4a6);}try{await checkWifiPresence(_0x2d73c5);}catch(_0x48355c){}}}async function getWeatherContext(_0x36f144){const _0x228a27=a0_0x42ed3a;try{if(!_0x36f144[_0x228a27(0x16c)]['useWeather'])return _0x228a27(0x272);let _0x1987e1='';const _0x40aadb=_0x36f144['config'][_0x228a27(0x26a)];if(_0x40aadb)try{if(_0x40aadb['includes'](_0x228a27(0x105))){const _0x1ee384=await _0x36f144[_0x228a27(0x14f)](_0x40aadb+_0x228a27(0x210));if(_0x1ee384&&_0x1ee384[_0x228a27(0x1f0)])_0x1987e1=_0x1ee384[_0x228a27(0x1f0)];}else{if(_0x40aadb[_0x228a27(0x20c)](_0x228a27(0x26b))){const _0x28ae0f=await _0x36f144[_0x228a27(0x14f)](_0x40aadb+_0x228a27(0x233));if(_0x28ae0f&&_0x28ae0f[_0x228a27(0x1f0)])_0x1987e1=_0x28ae0f[_0x228a27(0x1f0)];}else{if(_0x40aadb[_0x228a27(0x20c)](_0x228a27(0x155))){const _0x5904ec=await _0x36f144[_0x228a27(0x14f)](_0x40aadb+_0x228a27(0x175));if(_0x5904ec&&_0x5904ec[_0x228a27(0x1f0)])_0x1987e1=_0x5904ec['val'];}}}}catch(_0x2f847e){}if(!_0x1987e1){const _0x3aca3c=[_0x228a27(0x30f),'daswetter.0',_0x228a27(0x133),_0x228a27(0x106)];for(const _0x58623a of _0x3aca3c){try{const _0x5ee7e4=await _0x36f144[_0x228a27(0x2f2)](_0x58623a);if(_0x5ee7e4){if(_0x58623a[_0x228a27(0x20c)]('accuweather')){const _0x590920=await _0x36f144[_0x228a27(0x14f)](_0x58623a+_0x228a27(0x210));if(_0x590920&&_0x590920['val']){_0x1987e1=_0x590920[_0x228a27(0x1f0)];break;}}}}catch(_0x254174){}}}return _0x1987e1?_0x228a27(0x2fc)+_0x1987e1:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x25289b){return'WETTER\x20ERROR:\x20'+_0x25289b[_0x228a27(0x2e8)];}}async function getCalendarContext(_0x29c2d0){const _0x23abec=a0_0x42ed3a;try{if(!_0x29c2d0['config'][_0x23abec(0x1df)])return _0x23abec(0x24e);let _0x584846=_0x29c2d0[_0x23abec(0x16c)][_0x23abec(0x2f6)]||_0x23abec(0x216),_0x28711e=_0x29c2d0[_0x23abec(0x16c)][_0x23abec(0x1e9)]||[];if(typeof _0x28711e==='string')_0x28711e=_0x28711e[_0x23abec(0x316)](',');try{const _0x5c0dbf=await _0x29c2d0[_0x23abec(0x14f)](_0x584846+_0x23abec(0x196));if(_0x5c0dbf&&_0x5c0dbf['val']){let _0x37f0b5=tryParse(_0x5c0dbf[_0x23abec(0x1f0)]);if(_0x37f0b5&&Array[_0x23abec(0x2f4)](_0x37f0b5)){if(_0x28711e['length']>0x0)_0x37f0b5=_0x37f0b5['filter'](_0x26920f=>_0x28711e['includes'](_0x26920f[_0x23abec(0x1fa)]||''));else return _0x23abec(0x239);if(_0x37f0b5['length']>0x0){const _0x4ca7ab=_0x37f0b5[_0x23abec(0x2b6)](0x0,0x3)['map'](_0xed7f79=>{const _0x2fdfeb=_0x23abec;let _0x1a389c=_0xed7f79[_0x2fdfeb(0x151)];if(_0xed7f79[_0x2fdfeb(0x1aa)])_0x1a389c+='\x20'+_0xed7f79['time'];return _0x1a389c+':\x20'+_0xed7f79[_0x2fdfeb(0x121)]+'\x20('+_0xed7f79['_calName']+')';});return _0x23abec(0x29b)+_0x4ca7ab['join'](_0x23abec(0x1c9));}else return _0x23abec(0x2e0);}}}catch(_0x35b2c4){_0x29c2d0[_0x23abec(0x257)][_0x23abec(0x25a)](_0x23abec(0x254)+_0x35b2c4['message']);}return _0x23abec(0x11a);}catch(_0x99797d){return _0x23abec(0x2db)+_0x99797d[_0x23abec(0x2e8)];}}async function getCalendarNames(_0x1f596e,_0x119b0b){const _0x51a37c=a0_0x42ed3a;try{const _0x105f49=await _0x1f596e[_0x51a37c(0x14f)](_0x119b0b+_0x51a37c(0x196));if(_0x105f49&&_0x105f49[_0x51a37c(0x1f0)]){const _0x222a56=tryParse(_0x105f49[_0x51a37c(0x1f0)]);if(_0x222a56&&Array[_0x51a37c(0x2f4)](_0x222a56)){const _0x3cc2a4=[...new Set(_0x222a56['map'](_0x59e757=>_0x59e757[_0x51a37c(0x1fa)])[_0x51a37c(0x250)](Boolean))];return _0x3cc2a4[_0x51a37c(0x1db)]();}}return[];}catch(_0x16fc2d){return _0x1f596e['log'][_0x51a37c(0x1be)](_0x51a37c(0x2a7)+_0x16fc2d[_0x51a37c(0x2e8)]),[];}}async function checkWifiPresence(_0x2c5114){const _0x50932a=a0_0x42ed3a;try{const _0x517e5d=_0x2c5114[_0x50932a(0x16c)][_0x50932a(0x185)]||[];let _0x991707=![];const _0x6bd7eb=[];for(const _0x26f0ca of _0x517e5d){try{const _0x4d4235=await _0x2c5114['getForeignStateAsync'](_0x26f0ca);if(_0x4d4235&&(_0x4d4235[_0x50932a(0x1f0)]===!![]||_0x4d4235['val']===_0x50932a(0x1d6)||_0x4d4235[_0x50932a(0x1f0)]===0x1)){_0x991707=!![];const _0x32d350=await _0x2c5114[_0x50932a(0x2f2)](_0x26f0ca);let _0x5a9863=_0x26f0ca;_0x32d350&&_0x32d350[_0x50932a(0x1f7)]&&_0x32d350['common']['name']&&(_0x5a9863=typeof _0x32d350[_0x50932a(0x1f7)]['name']===_0x50932a(0x1e6)?_0x32d350['common']['name']['de']||_0x32d350[_0x50932a(0x1f7)][_0x50932a(0x26c)]['en']:_0x32d350[_0x50932a(0x1f7)]['name']),_0x6bd7eb[_0x50932a(0x11f)](_0x5a9863);}}catch(_0xc3f2be){}}return await _0x2c5114[_0x50932a(0x2fb)]('system.presenceWho',{'val':_0x6bd7eb['join'](',\x20'),'ack':!![]}),_0x991707&&(_0x2c5114[_0x50932a(0x1c7)]&&(_0x2c5114[_0x50932a(0x257)][_0x50932a(0x15e)](_0x50932a(0x2f7)),abortExitTimer(_0x2c5114)),!_0x2c5114[_0x50932a(0x1fd)]&&_0x2c5114[_0x50932a(0x275)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x2c5114,!![])),_0x991707;}catch(_0x3af6eb){return _0x2c5114[_0x50932a(0x257)]['error'](_0x50932a(0x2ab)+_0x3af6eb['message']),![];}}function startExitTimer(_0x58c640){const _0x3af9ca=a0_0x42ed3a;abortExitTimer(_0x58c640),_0x58c640[_0x3af9ca(0x164)]=!![],_0x58c640[_0x3af9ca(0x1ea)]=setTimeout(()=>{const _0x1a07b8=_0x3af9ca;_0x58c640[_0x1a07b8(0x164)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x58c640[_0x3af9ca(0x1c7)]=setTimeout(()=>{const _0x4a956c=_0x3af9ca;setPresence(_0x58c640,![]),_0x58c640[_0x4a956c(0x1c7)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x22e59d){const _0x28a693=a0_0x42ed3a;if(_0x22e59d[_0x28a693(0x1c7)])clearTimeout(_0x22e59d['exitTimer']);if(_0x22e59d[_0x28a693(0x1ea)])clearTimeout(_0x22e59d[_0x28a693(0x1ea)]);_0x22e59d['exitTimer']=null,_0x22e59d[_0x28a693(0x1ea)]=null,_0x22e59d[_0x28a693(0x164)]=![];}async function setPresence(_0x2089eb,_0x3fb76a){const _0x70bdcb=a0_0x42ed3a;if(_0x2089eb[_0x70bdcb(0x1fd)]===_0x3fb76a)return;_0x2089eb[_0x70bdcb(0x1fd)]=_0x3fb76a,await _0x2089eb[_0x70bdcb(0x2fb)]('system.isPresent',{'val':_0x3fb76a,'ack':!![]});}async function saveFeedback(_0x10e040,_0xdb2781){const _0x1750d2=a0_0x42ed3a;_0x10e040[_0x1750d2(0x257)][_0x1750d2(0x15e)](_0x1750d2(0x1d9)+JSON[_0x1750d2(0x2c9)](_0xdb2781));}async function runBaselineDriftAnalysis(_0x39367a){const _0x5c30b0=a0_0x42ed3a;if(!_0x39367a['isProVersion']||!_0x39367a[_0x5c30b0(0x134)])return;const _0x5c8cac=_0x39367a[_0x5c30b0(0x16c)][_0x5c30b0(0x1d5)]||0xe;if(_0x39367a[_0x5c30b0(0x1d7)][_0x5c30b0(0x2f3)]<_0x5c8cac+(_0x39367a[_0x5c30b0(0x16c)]['minDaysForBaseline']||0x7)){await _0x39367a[_0x5c30b0(0x2fb)](LTM_DP_DRIFT_STATUS,{'val':_0x5c30b0(0x17c),'ack':!![]});return;}const _0x56e4e4=_0x39367a[_0x5c30b0(0x1d7)]['slice'](-_0x5c8cac),_0x18cb98=_0x39367a[_0x5c30b0(0x1d7)][_0x5c30b0(0x2b6)](0x0,_0x39367a[_0x5c30b0(0x1d7)][_0x5c30b0(0x2f3)]-_0x5c8cac),_0x37a196=_0x5c30b0(0x1ec)+JSON[_0x5c30b0(0x2c9)](_0x18cb98)+_0x5c30b0(0x171)+JSON['stringify'](_0x56e4e4);try{const _0x113c51=await _0x39367a['geminiModel']['generateContent'](_0x37a196),_0x5445da=JSON['parse'](_0x113c51['response'][_0x5c30b0(0x1fc)]()[_0x5c30b0(0x15b)](/```json|```/g,'')[_0x5c30b0(0x301)]());_0x5445da[_0x5c30b0(0x2b8)]&&(await _0x39367a['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x5445da[_0x5c30b0(0x2b8)],'ack':!![]}),await _0x39367a[_0x5c30b0(0x2fb)](LTM_DP_DRIFT_DETAILS,{'val':_0x5445da[_0x5c30b0(0x282)],'ack':!![]}),await _0x39367a[_0x5c30b0(0x2fb)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x5c30b0(0x287)](),'ack':!![]}));}catch(_0x48a838){}}function setupLtmScheduler(_0x55b9a1){const _0x174f5c=a0_0x42ed3a;try{if(_0x55b9a1[_0x174f5c(0x21e)])_0x55b9a1['ltmJob'][_0x174f5c(0x167)]();if(!_0x55b9a1[_0x174f5c(0x238)]){_0x55b9a1[_0x174f5c(0x2fb)](LTM_DP_STATUS,{'val':_0x174f5c(0x212),'ack':!![]});return;}_0x55b9a1[_0x174f5c(0x21e)]=schedule[_0x174f5c(0x2d0)](LTM_SCHEDULE,()=>createDailyDigest(_0x55b9a1));}catch(_0x200e11){_0x55b9a1[_0x174f5c(0x257)][_0x174f5c(0x1be)](_0x174f5c(0x17b)+_0x200e11['message']);}}function setupModeResetScheduler(_0xe88bb3){const _0x218374=a0_0x42ed3a;try{if(_0xe88bb3[_0x218374(0x1c5)])_0xe88bb3[_0x218374(0x1c5)][_0x218374(0x167)]();_0xe88bb3[_0x218374(0x1c5)]=schedule[_0x218374(0x2d0)](MODE_RESET_SCHEDULE,async()=>{const _0x7e8703=_0x218374;await loadSystemMode(_0xe88bb3),AUTO_RESET_MODES['includes'](_0xe88bb3['currentSystemMode'])&&await _0xe88bb3[_0x7e8703(0x2fb)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x4bfb3b){_0xe88bb3[_0x218374(0x257)][_0x218374(0x1be)](_0x218374(0x1c4)+_0x4bfb3b['message']);}}function setupDriftAnalysisScheduler(_0x3b2359){const _0x5affc0=a0_0x42ed3a;try{if(_0x3b2359[_0x5affc0(0x1a1)])clearInterval(_0x3b2359['driftAnalysisTimer']);if(!_0x3b2359[_0x5affc0(0x238)])return;_0x3b2359[_0x5affc0(0x1a1)]=setInterval(()=>runBaselineDriftAnalysis(_0x3b2359),(_0x3b2359['config'][_0x5affc0(0x2b2)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3b2359),0x1388);}catch(_0x3bdca1){_0x3b2359[_0x5affc0(0x257)][_0x5affc0(0x1be)]('Drift\x20Sched\x20Error:\x20'+_0x3bdca1[_0x5affc0(0x2e8)]);}}function setupBriefingScheduler(_0x228aa8){const _0x53606f=a0_0x42ed3a;try{if(_0x228aa8[_0x53606f(0x2e9)])_0x228aa8[_0x53606f(0x2e9)]['cancel']();if(!_0x228aa8[_0x53606f(0x16c)][_0x53606f(0x10e)])return;const _0x3b84d9=(_0x228aa8[_0x53606f(0x16c)][_0x53606f(0x10b)]||_0x53606f(0x2ad))[_0x53606f(0x316)](':'),_0x3eee8a=parseInt(_0x3b84d9[0x0])||0x8,_0x1e0b1b=parseInt(_0x3b84d9[0x1])||0x0,_0x21a783=_0x1e0b1b+'\x20'+_0x3eee8a+_0x53606f(0x22e);_0x228aa8[_0x53606f(0x257)][_0x53606f(0x15e)](_0x53606f(0x193)+_0x3eee8a+':'+(_0x1e0b1b<0xa?'0'+_0x1e0b1b:_0x1e0b1b)),_0x228aa8[_0x53606f(0x2e9)]=schedule[_0x53606f(0x2d0)](_0x21a783,()=>{sendMorningBriefing(_0x228aa8);});}catch(_0x2859b3){_0x228aa8[_0x53606f(0x257)]['error'](_0x53606f(0x160)+_0x2859b3[_0x53606f(0x2e8)]);}}async function sendNotification(_0x5c6ffe,_0x5dbd1e,_0x1ca781=![],_0xe23ff9=![]){const _0x4d2563=a0_0x42ed3a;_0x5c6ffe[_0x4d2563(0x257)][_0x4d2563(0x15e)]((_0x1ca781?_0x4d2563(0x13e):'')+_0x4d2563(0x1b0)+_0x5dbd1e+'\x22');const _0x363f47=_0x5c6ffe['config'];let _0xae9e4d=0x0;if(_0x363f47[_0x4d2563(0x23a)]){let _0x5ee915={};(_0x5dbd1e['includes'](_0x4d2563(0x245))||_0xe23ff9)&&(_0x5ee915={'reply_markup':{'inline_keyboard':[[{'text':_0x4d2563(0x219),'callback_data':_0x4d2563(0x131)}],[{'text':_0x4d2563(0x2e5),'callback_data':_0x4d2563(0x2c4)}]]}}),await _0x5c6ffe[_0x4d2563(0x20d)](_0x363f47['notifyTelegramInstance'],_0x4d2563(0x11b),{'text':_0x5dbd1e,'user':_0x363f47[_0x4d2563(0x274)],..._0x5ee915}),_0xae9e4d++;}if(_0x363f47['notifyPushoverEnabled']){let _0x5f19ad={'message':_0x5dbd1e,'title':_0xe23ff9?_0x4d2563(0x313):_0x4d2563(0x1b9),'priority':_0xe23ff9?0x2:0x1,'device':_0x363f47[_0x4d2563(0x2b3)]};_0xe23ff9&&(_0x5f19ad['retry']=0x1e,_0x5f19ad[_0x4d2563(0x2d3)]=0xe10,_0x5f19ad[_0x4d2563(0x101)]=_0x4d2563(0x1e7)),await _0x5c6ffe[_0x4d2563(0x20d)](_0x363f47['notifyPushoverInstance'],_0x4d2563(0x11b),_0x5f19ad),_0xae9e4d++;}return _0x363f47[_0x4d2563(0x110)]&&(await _0x5c6ffe[_0x4d2563(0x20d)](_0x363f47[_0x4d2563(0x300)],_0x4d2563(0x11b),{'text':_0x5dbd1e,'to':_0x363f47[_0x4d2563(0x17f)]}),_0xae9e4d++),_0xae9e4d;}async function setupTelegramListener(_0x4527cf){const _0x10858f=a0_0x42ed3a,_0x5ae29d=_0x4527cf['config'][_0x10858f(0x2c8)];_0x4527cf[_0x10858f(0x16c)]['notifyTelegramEnabled']&&_0x5ae29d&&(_0x4527cf['log'][_0x10858f(0x15e)](_0x10858f(0x2a9)+_0x5ae29d+_0x10858f(0x119)),await _0x4527cf[_0x10858f(0x1b3)](_0x5ae29d+'.communicate.request'));}async function handleTelegramResponse(_0x632a46,_0x364c1e){const _0xdbb40b=a0_0x42ed3a;let _0x403923=_0x364c1e;_0x364c1e[_0xdbb40b(0x136)]('[')&&(_0x403923=_0x364c1e[_0xdbb40b(0x1cf)](_0x364c1e[_0xdbb40b(0x1d4)](']')+0x1));if(_0x403923===_0xdbb40b(0x131))_0x632a46[_0xdbb40b(0x257)][_0xdbb40b(0x15e)](_0xdbb40b(0x241)),await _0x632a46['setStateAsync'](_0xdbb40b(0x261),{'val':![],'ack':!![]}),await _0x632a46[_0xdbb40b(0x2fb)](_0xdbb40b(0x182),{'val':_0xdbb40b(0x177),'ack':!![]}),_0x632a46[_0xdbb40b(0x266)]=![],sendNotification(_0x632a46,_0xdbb40b(0x314),![]);else _0x403923===_0xdbb40b(0x2c4)&&(_0x632a46[_0xdbb40b(0x257)]['warn'](_0xdbb40b(0x2dd)),sendNotification(_0x632a46,'üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.',![],!![]));}async function runAutopilot(_0x5e05ed){const _0x2f7ad4=a0_0x42ed3a,_0x24f9b2=_0x5e05ed[_0x2f7ad4(0x16c)][_0x2f7ad4(0x111)],_0x6d5fb=_0x5e05ed[_0x2f7ad4(0x2d6)][_0x2f7ad4(0x2f3)]>0x0?_0x5e05ed[_0x2f7ad4(0x2d6)][0x0]['timestamp']:Date[_0x2f7ad4(0x287)](),_0x5a23db=(Date[_0x2f7ad4(0x287)]()-_0x6d5fb)/(0x3e8*0x3c*0x3c);let _0x14fbd2='';_0x5e05ed[_0x2f7ad4(0x16c)][_0x2f7ad4(0x27c)]&&_0x5e05ed[_0x2f7ad4(0x275)]===SYSTEM_MODES[_0x2f7ad4(0x13b)]&&_0x5e05ed[_0x2f7ad4(0x1fd)]&&(_0x5a23db>_0x24f9b2&&(_0x14fbd2=_0x2f7ad4(0x30e)+_0x5a23db[_0x2f7ad4(0x215)](0x1)+_0x2f7ad4(0x27b))),runGeminiAnalysis(_0x5e05ed,_0x14fbd2)[_0x2f7ad4(0x317)](_0x54670b=>_0x5e05ed[_0x2f7ad4(0x257)][_0x2f7ad4(0x1be)](_0x54670b));}async function createDailyDigest(_0x2e2fa7){const _0x9347f5=a0_0x42ed3a;if(!_0x2e2fa7[_0x9347f5(0x238)])return;await _0x2e2fa7[_0x9347f5(0x2fb)](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()[_0x9347f5(0x297)](),'ack':!![]});if(!_0x2e2fa7[_0x9347f5(0x134)]||_0x2e2fa7[_0x9347f5(0x114)][_0x9347f5(0x2f3)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x2e2fa7[_0x9347f5(0x2fb)](LTM_DP_STATUS,{'val':_0x9347f5(0x2cf),'ack':!![]});return;}const _0x292f59=JSON['parse'](JSON[_0x9347f5(0x2c9)](_0x2e2fa7[_0x9347f5(0x114)])),_0x37ab46=_0x292f59[_0x9347f5(0x2f3)],_0x5c189f=_0x9347f5(0x12f)+JSON[_0x9347f5(0x2c9)](_0x292f59);try{const _0x4058f9=await _0x2e2fa7[_0x9347f5(0x134)][_0x9347f5(0x12a)](_0x5c189f),_0x4e0973=JSON[_0x9347f5(0x2de)](_0x4058f9[_0x9347f5(0x202)][_0x9347f5(0x1fc)]()[_0x9347f5(0x15b)](/```json|```/g,'')[_0x9347f5(0x301)]());_0x4e0973[_0x9347f5(0x252)]&&(_0x2e2fa7[_0x9347f5(0x1d7)][_0x9347f5(0x11f)]({'timestamp':new Date()['toISOString'](),'eventCount':_0x37ab46,'summary':_0x4e0973[_0x9347f5(0x252)],'activityLevel':_0x4e0973[_0x9347f5(0x206)],'systemMode':_0x2e2fa7[_0x9347f5(0x275)]}),await saveDailyDigests(_0x2e2fa7),_0x2e2fa7[_0x9347f5(0x114)]=[],await saveRawEventLog(_0x2e2fa7),await _0x2e2fa7[_0x9347f5(0x2fb)](LTM_DP_STATUS,{'val':_0x9347f5(0x14c)+_0x37ab46+_0x9347f5(0x26e),'ack':!![]}),runPythonHealthCheck(_0x2e2fa7));}catch(_0x21cdf6){await _0x2e2fa7[_0x9347f5(0x2fb)](LTM_DP_STATUS,{'val':_0x9347f5(0x277)+_0x21cdf6['message'],'ack':!![]});}}async function sendMorningBriefing(_0x31b1cc){const _0x235361=a0_0x42ed3a;if(!_0x31b1cc[_0x235361(0x134)])return;_0x31b1cc[_0x235361(0x257)][_0x235361(0x15e)](_0x235361(0x256));const _0x602b7c=_0x31b1cc[_0x235361(0x1d7)][_0x235361(0x2f3)]>0x0?_0x31b1cc[_0x235361(0x1d7)][_0x31b1cc[_0x235361(0x1d7)][_0x235361(0x2f3)]-0x1]:null,_0x125586=_0x602b7c&&_0x602b7c[_0x235361(0x1e2)]?_0x602b7c[_0x235361(0x1e2)][_0x235361(0x187)]:_0x235361(0x15d),_0x4b9636=new Date();_0x4b9636['setHours'](0x4,0x0,0x0,0x0);const _0x589451=_0x31b1cc[_0x235361(0x2d6)][_0x235361(0x250)](_0x31e80c=>new Date(_0x31e80c[_0x235361(0x20e)])>_0x4b9636),_0x27dabc=PERSONA_MAPPING[_0x31b1cc['config'][_0x235361(0x29d)]||_0x235361(0x286)],_0xc870ec=_0x31b1cc['config']['livingContext']||'',_0x4cf9c4=await getWeatherContext(_0x31b1cc),_0x3f5822=await getCalendarContext(_0x31b1cc),_0x3c68d9=_0x235361(0x11c)+_0x27dabc+_0x235361(0x127)+_0xc870ec+_0x235361(0x24b)+_0x4cf9c4+'\x20'+_0x3f5822+'.\x20DATEN:\x20Schlaf\x20'+_0x125586+_0x235361(0x118)+JSON['stringify'](_0x589451[_0x235361(0x2b6)](0x0,0xa))+_0x235361(0x263);try{const _0x5c530a=await _0x31b1cc['geminiModel'][_0x235361(0x12a)](_0x3c68d9),_0x1794ed=_0x235361(0x22b)+_0x5c530a['response']['text']()[_0x235361(0x301)]();sendNotification(_0x31b1cc,_0x1794ed),_0x31b1cc['log'][_0x235361(0x15e)](_0x235361(0x2d7));}catch(_0x3e0f4){_0x31b1cc['log'][_0x235361(0x1be)](_0x235361(0x10f)+_0x3e0f4[_0x235361(0x2e8)]);}}async function scanForDevices(_0x137d71,_0x12608c){const _0x302bd4=a0_0x42ed3a;_0x137d71[_0x302bd4(0x257)][_0x302bd4(0x15e)]('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x2f9015=[],_0x5b26eb=await _0x137d71[_0x302bd4(0x13d)]('*'),_0x4b780f=await _0x137d71[_0x302bd4(0x13d)](_0x302bd4(0x21b),_0x302bd4(0x197)),_0xe28c84=await _0x137d71[_0x302bd4(0x13d)](_0x302bd4(0x246),_0x302bd4(0x197)),_0x57ca5c={};if(_0x4b780f)for(const _0x372b23 in _0x4b780f){const _0x40ffab=_0x4b780f[_0x372b23][_0x302bd4(0x1f7)]['members']||[];_0x40ffab[_0x302bd4(0x251)](_0x135ccb=>{if(!_0x57ca5c[_0x135ccb])_0x57ca5c[_0x135ccb]=[];_0x57ca5c[_0x135ccb]['push'](_0x372b23);});}const _0x3ead8f={};if(_0xe28c84)for(const _0x5d66e2 in _0xe28c84){const _0x2279fd=_0xe28c84[_0x5d66e2][_0x302bd4(0x1f7)][_0x302bd4(0x28b)]||[],_0x1184b1=typeof _0xe28c84[_0x5d66e2][_0x302bd4(0x1f7)][_0x302bd4(0x26c)]===_0x302bd4(0x1e6)?_0xe28c84[_0x5d66e2]['common'][_0x302bd4(0x26c)]['de']:_0xe28c84[_0x5d66e2]['common']['name'];_0x2279fd[_0x302bd4(0x251)](_0xad1173=>_0x3ead8f[_0xad1173]=_0x1184b1);}const _0x4da8d8=_0x12608c[_0x302bd4(0x1ca)]||[],_0x27f10d=_0x12608c[_0x302bd4(0x1ac)]!==![],_0x44602c=_0x12608c['doors']!==![],_0x553903=_0x12608c[_0x302bd4(0x166)]!==![],_0x5d6077=_0x12608c[_0x302bd4(0x253)]===!![],_0x340184=_0x12608c[_0x302bd4(0x278)]===!![];for(const _0x21f27c in _0x5b26eb){const _0x4d93fa=_0x5b26eb[_0x21f27c];if(_0x4d93fa[_0x302bd4(0x15c)]!=='state'||!_0x4d93fa[_0x302bd4(0x1f7)])continue;if(ADAPTER_BLACKLIST[_0x302bd4(0x1c8)](_0x1370f6=>_0x21f27c[_0x302bd4(0x136)](_0x1370f6))&&!_0x340184)continue;const _0x36bebf=(_0x4d93fa[_0x302bd4(0x1f7)][_0x302bd4(0x2d5)]||'')[_0x302bd4(0x150)]();let _0x28e348=(typeof _0x4d93fa[_0x302bd4(0x1f7)][_0x302bd4(0x26c)]===_0x302bd4(0x1e6)?_0x4d93fa['common']['name']['de']:_0x4d93fa[_0x302bd4(0x1f7)][_0x302bd4(0x26c)])||_0x21f27c;const _0x22c430=_0x28e348[_0x302bd4(0x150)]();let _0xfc282f=![],_0x3a94b6=![];if(_0x4da8d8[_0x302bd4(0x2f3)]>0x0){const _0x9a0577=_0x57ca5c[_0x21f27c]||[],_0x551b62=_0x21f27c[_0x302bd4(0x316)]('.')[_0x302bd4(0x2b6)](0x0,-0x1)['join']('.'),_0x4b666c=_0x57ca5c[_0x551b62]||[];(_0x9a0577[_0x302bd4(0x1c8)](_0x42e1c4=>_0x4da8d8[_0x302bd4(0x20c)](_0x42e1c4))||_0x4b666c[_0x302bd4(0x1c8)](_0x8ac74c=>_0x4da8d8[_0x302bd4(0x20c)](_0x8ac74c)))&&(_0xfc282f=!![],_0x3a94b6=!![]);}if(!_0xfc282f&&!_0x340184){if(HARD_IGNORE_TERMS[_0x302bd4(0x1c8)](_0x34089b=>_0x21f27c[_0x302bd4(0x20c)](_0x34089b)||_0x22c430[_0x302bd4(0x20c)](_0x34089b[_0x302bd4(0x150)]())))continue;}if(BAD_NAMES[_0x302bd4(0x1c8)](_0x4530c6=>_0x22c430===_0x4530c6||_0x22c430[_0x302bd4(0x1fb)]('.'+_0x4530c6))){const _0x3617fe=_0x21f27c[_0x302bd4(0x316)]('.');if(_0x3617fe[_0x302bd4(0x2f3)]>0x2){const _0x1b1643=_0x3617fe['slice'](0x0,-0x1)['join']('.'),_0x51362d=_0x5b26eb[_0x1b1643];if(_0x51362d&&_0x51362d['common']&&_0x51362d[_0x302bd4(0x1f7)][_0x302bd4(0x26c)]){const _0xd5837b=typeof _0x51362d[_0x302bd4(0x1f7)][_0x302bd4(0x26c)]===_0x302bd4(0x1e6)?_0x51362d[_0x302bd4(0x1f7)][_0x302bd4(0x26c)]['de']:_0x51362d[_0x302bd4(0x1f7)][_0x302bd4(0x26c)];_0xd5837b&&!_0x28e348[_0x302bd4(0x20c)](_0xd5837b)&&(_0x28e348=_0xd5837b+'\x20'+_0x28e348);}}}let _0x205626='';if(_0x27f10d&&(_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x1ac))||_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x24d))||_0x22c430[_0x302bd4(0x20c)]('bewegung')||_0x22c430['includes'](_0x302bd4(0x188))))_0x205626=_0x302bd4(0x1ac);else{if(!_0x205626&&_0x44602c&&(_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x29f))||_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x204))||_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x221))||_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x2aa))||_0x36bebf['includes'](_0x302bd4(0x2bc))||_0x22c430['includes'](_0x302bd4(0x29a))||_0x22c430[_0x302bd4(0x20c)](_0x302bd4(0x311))||_0x22c430[_0x302bd4(0x20c)]('rollladen')))_0x205626=_0x302bd4(0x29f);else{if(!_0x205626&&_0x553903&&(_0x36bebf['includes']('light')||_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x205))||_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x184))||_0x22c430[_0x302bd4(0x20c)]('licht')||_0x22c430[_0x302bd4(0x20c)](_0x302bd4(0x25b))||_0x22c430[_0x302bd4(0x20c)](_0x302bd4(0x260)))){if(_0x4d93fa[_0x302bd4(0x1f7)]['write']||_0x36bebf[_0x302bd4(0x20c)]('sensor'))_0x205626='light';}else{if(!_0x205626&&_0x5d6077&&(_0x36bebf['includes'](_0x302bd4(0x253))||_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x213))||_0x36bebf[_0x302bd4(0x20c)](_0x302bd4(0x26f))||_0x22c430[_0x302bd4(0x20c)](_0x302bd4(0x267))||_0x22c430[_0x302bd4(0x20c)]('klima')||_0x22c430[_0x302bd4(0x20c)](_0x302bd4(0x1da))))_0x205626=_0x302bd4(0x253);else{if(!_0x205626&&_0x3a94b6)_0x205626=_0x302bd4(0x310);}}}}if(_0x205626){let _0x3718d9=_0x3ead8f[_0x21f27c]||'';if(!_0x3718d9){let _0x58c61a=_0x21f27c;for(let _0xb36d9f=0x0;_0xb36d9f<0x3;_0xb36d9f++){const _0x36fd0a=_0x58c61a['lastIndexOf']('.');if(_0x36fd0a===-0x1)break;_0x58c61a=_0x58c61a[_0x302bd4(0x1cf)](0x0,_0x36fd0a);if(_0x3ead8f[_0x58c61a]){_0x3718d9=_0x3ead8f[_0x58c61a];break;}}}_0x2f9015[_0x302bd4(0x11f)]({'id':_0x21f27c,'name':_0x28e348,'location':_0x3718d9,'type':_0x205626,'logDuplicates':_0x205626==='motion','isExit':![],'_score':_0x3718d9?0x50:_0x205626===_0x302bd4(0x310)?0x5a:0x28});}}return _0x2f9015[_0x302bd4(0x1db)]((_0x41ad1d,_0x36888b)=>_0x36888b['_score']-_0x41ad1d[_0x302bd4(0x1cd)]),_0x2f9015;}async function executeAutomationAction(_0x15c444){const _0x58c4f2=a0_0x42ed3a;try{const _0x4f55dd=await _0x15c444['getStateAsync'](_0x58c4f2(0x2bb)),_0x2c343a=await _0x15c444['getStateAsync'](_0x58c4f2(0x1af));if(_0x4f55dd&&_0x4f55dd[_0x58c4f2(0x1f0)]&&_0x2c343a){const _0xaea42d=_0x4f55dd[_0x58c4f2(0x1f0)];let _0x1d84f4=_0x2c343a['val'];try{_0x1d84f4=JSON[_0x58c4f2(0x2de)](_0x1d84f4);}catch(_0x1271eb){}_0x15c444[_0x58c4f2(0x257)][_0x58c4f2(0x15e)]('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0xaea42d+'\x20=\x20'+_0x1d84f4),await _0x15c444[_0x58c4f2(0x25e)](_0xaea42d,_0x1d84f4);}else _0x15c444[_0x58c4f2(0x257)][_0x58c4f2(0x25a)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x123e4f){_0x15c444['log'][_0x58c4f2(0x1be)](_0x58c4f2(0x1d0)+_0x123e4f['message']);}}function tryParse(_0x538d69){const _0x321b8d=a0_0x42ed3a;try{return JSON[_0x321b8d(0x2de)](_0x538d69);}catch(_0x27b1f9){return null;}}async function recordSequence(_0x140200,_0x51e4ec){const _0x500eb6=a0_0x42ed3a,_0x59282f=(_0x51e4ec['type']||'')[_0x500eb6(0x150)](),_0x250fef=[_0x500eb6(0x1ac),_0x500eb6(0x2b7),'pr√§senz',_0x500eb6(0x2f5),_0x500eb6(0x24d),_0x500eb6(0x29f),_0x500eb6(0x311),_0x500eb6(0x204),_0x500eb6(0x29a),_0x500eb6(0x2a3),_0x500eb6(0x1a2),_0x500eb6(0x21f),_0x500eb6(0x1d8),_0x500eb6(0x205),'schalter',_0x500eb6(0x184),'lampe'];if(!_0x250fef[_0x500eb6(0x1c8)](_0x14bf16=>_0x59282f[_0x500eb6(0x20c)](_0x14bf16))){_0x140200[_0x500eb6(0x257)]['debug']('[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20'+_0x51e4ec['id']+_0x500eb6(0x247)+_0x51e4ec[_0x500eb6(0x15c)]+_0x500eb6(0x27a));return;}if(!_0x51e4ec[_0x500eb6(0x235)]){_0x140200[_0x500eb6(0x257)][_0x500eb6(0x116)](_0x500eb6(0x28d)+_0x51e4ec['id']+_0x500eb6(0x1f3)+_0x51e4ec[_0x500eb6(0x235)]+')');return;}_0x140200[_0x500eb6(0x257)][_0x500eb6(0x116)]('[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20'+_0x51e4ec['id']+'\x20('+_0x51e4ec[_0x500eb6(0x1a9)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x5cb7cd={'loc':_0x51e4ec[_0x500eb6(0x1a9)]||_0x500eb6(0x1e4),'id':_0x51e4ec['id'],'ts':Date[_0x500eb6(0x287)]()};activeSequence['push'](_0x5cb7cd),_0x140200[_0x500eb6(0x257)][_0x500eb6(0x116)](_0x500eb6(0x10a)+_0x5cb7cd[_0x500eb6(0x2c3)]+_0x500eb6(0x1bc)+activeSequence[_0x500eb6(0x2f3)]+')'),sequenceTimer=setTimeout(async()=>{const _0x4e1d29=_0x500eb6;activeSequence[_0x4e1d29(0x2f3)]>0x1?await saveCompletedSequence(_0x140200):(_0x140200[_0x4e1d29(0x257)][_0x4e1d29(0x116)](_0x4e1d29(0x1a7)+activeSequence[_0x4e1d29(0x2f3)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x5e59f2){const _0x3ded89=a0_0x42ed3a;try{_0x5e59f2[_0x3ded89(0x257)][_0x3ded89(0x15e)]('[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20'+activeSequence[_0x3ded89(0x2f3)]+_0x3ded89(0x18b));const _0x6c2cd=await _0x5e59f2[_0x3ded89(0x156)](_0x3ded89(0x2ba));let _0x352d7d=[];if(_0x6c2cd&&_0x6c2cd[_0x3ded89(0x1f0)])try{_0x352d7d=JSON['parse'](_0x6c2cd[_0x3ded89(0x1f0)]);}catch(_0x465abd){}const _0x286511=activeSequence[0x0]['ts'],_0x4af484=activeSequence[_0x3ded89(0x18f)](_0x2c92aa=>({'loc':_0x2c92aa[_0x3ded89(0x2c3)],'t_delta':Math[_0x3ded89(0x25f)]((_0x2c92aa['ts']-_0x286511)/0x3e8)})),_0x207215={'timestamp':new Date(_0x286511)[_0x3ded89(0x174)](),'steps':_0x4af484,'duration':Math['round']((activeSequence[activeSequence[_0x3ded89(0x2f3)]-0x1]['ts']-_0x286511)/0x3e8),'daytime':new Date(_0x286511)[_0x3ded89(0x149)]()};_0x352d7d[_0x3ded89(0x11f)](_0x207215),_0x352d7d[_0x3ded89(0x2f3)]>MAX_TRAINING_SET_SIZE&&_0x352d7d[_0x3ded89(0x262)](),await _0x5e59f2[_0x3ded89(0x2fb)](_0x3ded89(0x2ba),{'val':JSON[_0x3ded89(0x2c9)](_0x352d7d),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x3ed697){_0x5e59f2[_0x3ded89(0x257)]['error'](_0x3ded89(0x157)+_0x3ed697[_0x3ded89(0x2e8)]);}}function a0_0x5743(_0x576822,_0x351d4c){const _0x281892=a0_0xb1c8();return a0_0x5743=function(_0x87b78c,_0x3009a6){_0x87b78c=_0x87b78c-0x101;let _0xb1c82f=_0x281892[_0x87b78c];return _0xb1c82f;},a0_0x5743(_0x576822,_0x351d4c);}async function getOutsideTemperatureNumeric(_0x361e4a){const _0x2a2ce2=a0_0x42ed3a;if(_0x361e4a[_0x2a2ce2(0x16c)][_0x2a2ce2(0x280)])try{const _0x5de01b=await _0x361e4a[_0x2a2ce2(0x14f)](_0x361e4a['config'][_0x2a2ce2(0x280)]);if(_0x5de01b&&_0x5de01b['val']!==undefined&&_0x5de01b['val']!==null){const _0x210fa4=parseFloat(_0x5de01b[_0x2a2ce2(0x1f0)]);if(!isNaN(_0x210fa4))return _0x210fa4;}}catch(_0x132399){_0x361e4a[_0x2a2ce2(0x257)][_0x2a2ce2(0x25a)](_0x2a2ce2(0x270)+_0x361e4a[_0x2a2ce2(0x16c)][_0x2a2ce2(0x280)]+':\x20'+_0x132399[_0x2a2ce2(0x2e8)]);}const _0xbc4057=_0x361e4a['config'][_0x2a2ce2(0x26a)];if(!_0x361e4a[_0x2a2ce2(0x16c)][_0x2a2ce2(0x199)]||!_0xbc4057)return null;try{let _0x49b05d='';if(_0xbc4057[_0x2a2ce2(0x20c)](_0x2a2ce2(0x105)))_0x49b05d=_0xbc4057+'.Current.Temperature';else{if(_0xbc4057[_0x2a2ce2(0x20c)](_0x2a2ce2(0x26b)))_0x49b05d=_0xbc4057+_0x2a2ce2(0x2e2);else{if(_0xbc4057[_0x2a2ce2(0x20c)](_0x2a2ce2(0x155)))_0x49b05d=_0xbc4057+_0x2a2ce2(0x2ea);else{if(_0xbc4057[_0x2a2ce2(0x20c)](_0x2a2ce2(0x1b2)))_0x49b05d=_0xbc4057+_0x2a2ce2(0x161);}}}if(_0x49b05d){const _0x56a6c7=await _0x361e4a[_0x2a2ce2(0x14f)](_0x49b05d);if(_0x56a6c7&&_0x56a6c7[_0x2a2ce2(0x1f0)]!==undefined&&_0x56a6c7[_0x2a2ce2(0x1f0)]!==null)return parseFloat(_0x56a6c7[_0x2a2ce2(0x1f0)]);}}catch(_0x31b0f2){}return null;}function a0_0xb1c8(){const _0x3a0074=['selectedFunctionIds','kill','scanDevices','_score','cogni-living\x20adapter\x20starting\x20(v','substring','BUTLER\x20Execution\x20Error:\x20',').\x20Starting\x20Timer.','20yfwixf','Comfort\x20Summary','indexOf','ltmStbWindowDays','online','dailyDigests','licht','Feedback\x20saved:\x20','heizung','sort','TREND_RESULT','stateChange','‚ùå\x20FREE\x20MODE','useCalendar','values','update','health','LTM.trainingData','Unknown','uuid','object','siren','uuid-error','calendarSelection','exitGraceTimer','feedbackHistory','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','):\x20','number','Event\x20received:\x20','val','licenseKey','triggerBriefing','\x20(Value\x20is\x20falsy:\x20','valve','.\x0a\x20\x20\x20\x20KONTEXT:\x20','üß™\x20Simulating\x20Butler\x20Proposal:\x20','common','scriptEnabled','data','_calName','endsWith','text','isPresent','write','indicator','systemUUID','events.lastEvent','response','reachable','window','switch','activityLevel','testNotification','python3\x20-m\x20pip\x20install\x20-r\x20\x22','Gemini\x20Analysis\x20Error:\x20','No\x20instance','details','includes','sendToAsync','timestamp','PRIORIT√ÑT:\x20Sicherheit.','.Summary.Current','analysis.activitySummary','Deaktiviert\x20(Pro-Feature)','humidity','native','toFixed','ical.0','Deviation','üêç\x20Stopping\x20Python\x20Sidecar...','‚úÖ\x20Alles\x20OK\x20(Reset)','No\x20module\x20named','enum.functions.*','working','Last\x20Result','ltmJob','light','apply','lock','maintenance','testApiKey','PRIORIT√ÑT:\x20Gesundheit/AAL.','TEST-PRO-KEY','.\x0a\x20\x20\x20\x20WETTER:\x20','\x20|\x20Status:\x20','cover','Gemini\x20AI\x20initialized.','events.history','üåÖ\x20Daily\x20Briefing:\x0a','join','javascript.','\x20*\x20*\x20*','Recorded\x20Motion\x20Sequences','analysis.automation.autoApply','normal','minDaysForBaseline','.NextHours.Location_1.Day_1.current.symbol_desc','isExit','value','Could\x20not\x20kill\x20Python\x20process:\x20','apiKey','isProVersion','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','notifyTelegramEnabled','Trend\x20Value\x20(%)','analysis.health.trendDiagnosis','genAI','\x22\x20--break-system-packages','events.history_debug_00','üêç\x20Guardian\x20Diagnosis\x20(','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','Guardian:\x20Sending\x20','livingContext','analysis.triggerBriefing','Alarm','enum.rooms.*','\x20(Type\x20\x27','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','analysisHistory','.\x20ZUSATZ:\x20','system.presenceWho','occupancy','Kalender:\x20Deaktiviert','onStateChange','filter','forEach','summary','temperature','Error\x20reading\x20calendar\x20table:\x20','Description','Generating\x20Morning\x20Briefing...','log','LTM',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','warn','lampe','version','system.config','setForeignStateAsync','round','schalter','analysis.isAlert','shift','.\x20OUTPUT:\x20Nur\x20Text.','10224247RbGtMk','python3','lastAlertState','temp','1457442zXgUFv','Invalid\x20JSON\x20from\x20Python:\x20','weatherInstance','daswetter','name','Automation\x20Proposals','\x20events','thermostat','Error\x20reading\x20outdoor\x20sensor\x20','writable','Wetter:\x20Deaktiviert','170gxILlR','notifyTelegramRecipient','currentSystemMode','Drift\x20Analysis','Error:\x20','weather','delObjectAsync','\x27\x20not\x20in\x20allowed\x20list)','\x20hours.\x20Potential\x20incapacitation.','inactivityMonitoringEnabled','indicator.alarm.fire','button','isAlert','outdoorSensorId','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','driftDetails','exports','stdout','system','generic','now','setObjectNotExistsAsync','constructor','channel','members','‚úÖ\x20PRO\x20ACTIVATED','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','Exit\x20Sensor\x20triggered\x20(','analysis.automation','devices','@iobroker/adapter-core','Training\x20Data\x20Sets','Kein\x20API\x20Key!','indicator.alarm','Daily\x20Digests','toLocaleString','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','analysis.analysisHistory','fenster','KALENDER:\x20','[PYTHON]\x20','aiPersona','Thermodynamic\x20Data\x20Points','door','analysis.feedbackHistory','Keine\x20Analyse.','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','contact','connection','latitude','Alert\x20Reason','getCalendarNames\x20Error:\x20','admin.','üì°\x20Hooking\x20into\x20','blind','Error\x20checking\x20WiFi:\x20','LTM.triggerDailyDigest','08:00','close','PONG','analysis.comfortSummary','Trigger\x20Analysis','ltmDriftCheckIntervalHours','notifyPushoverRecipient','LTM.rawEventLog','string','slice','bewegung','baselineDrift','Party','LTM.trainingData.sequences','analysis.automation.targetId','shutter','requirements.txt','splice','triggerDailyDigest','instance','power','system.mode','loc','COGNI_REQUEST_CALL','stdin','echarts.','analysis.lastResult','notifyTelegramInstance','stringify','Keiner','icons-mfd.','from','city','getLtmData','Skipped\x20(No\x20AI\x20or\x20Data)','scheduleJob','System\x20Mode','python_service','expire','unreach','role','eventHistory','Morning\x20Briefing\x20sent.','simple-api.','currentposition','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','KALENDER\x20ERROR:\x20','energy','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','parse','scriptProblem','KALENDER:\x20Keine\x20relevanten\x20Termine','Fokus\x20auf\x20Familienroutinen.','.NextHours.Location_1.Day_1.current.temp_value','onMessage','\x20=\x20','üìû\x20R√ºckruf\x20anfordern','vis.','Trigger\x20Digest','message','briefingJob','.forecast.current.temperature','analysis.health','PRO-','main','targetId','LTM.trainingData.thermodynamics','2681784wlRobr','getCalendarNames','getForeignObjectAsync','length','isArray','presence','calendarInstance','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','unknown','isEmergency','callback','setStateAsync','WETTER:\x20','Bibliotheken\x20nicht\x20gefunden','Health\x20&\x20Sleep\x20Analysis','dependencyInstallInProgress','notifyEmailInstance','trim','system.','Action','Say\x20Hello','(((.+)+)+)+$','find','1374ifXVqu','Kein\x20API\x20Key\x20eingegeben.','targetposition','KI-Modell\x20nicht\x20initialisiert','Health\x20Notes','Fehler:\x20','PARTY','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','accuweather.0','custom','t√ºr','models/gemini-flash-latest','üö®\x20EMERGENCY','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','automation.triggerAction','split','catch','ltmLtbWindowDays','sound','onUnload','Fokus\x20auf\x20Komfort.','509139YaviRW','accuweather','openweathermap.0','\x20presence\x20devices...','Sleep\x20Score\x20(0-100)','LTM.driftAnalysis.driftDetails','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','briefingTime','description','...','briefingEnabled','Briefing\x20Error:\x20','notifyEmailEnabled','inactivityThresholdHours','dutycycle','‚ö†Ô∏è\x20ALARM:\x20','rawEventLog','submitFeedback','debug','Trend\x20Diagnosis\x20(Python)','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','\x20for\x20interactive\x20buttons...','KALENDER:\x20Keine\x20Daten','send','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','position','Lernphase\x20(','push','state','event','dismissAutomation','@google/generative-ai','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','analysisTimer','sensorLastValues','.\x20KONTEXT:\x20','brightness','bind','generateContent','simulateButler','[LOG]','analysis.automation.patternDetected','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','detected','COGNI_CONFIRM_OK','onReady','weatherunderground.0','geminiModel','analysis.isEmergency','startsWith','party','Trigger\x20Briefing\x20(Test)','stderr','cogni-living','NORMAL','targetValue','getForeignObjectsAsync','[TEST]\x20','fault','9370hEmasD','lastCheck','boolean','\x20Tage)','alertReason','\x20(Value:\x20','Error\x20launching\x20Python\x20service:\x20','guest','Event\x20History','getHours','getTime','Starting\x20Autopilot\x20(','Success:\x20Compressed\x20','[RESULT]','sendTo','getForeignStateAsync','toLowerCase','date','getMonth','json','Restoring\x20sensor\x20cache\x20from\x20history\x20(','openweathermap','getStateAsync','[RECORDER]\x20Error\x20saving\x20sequence:\x20','Adapter','stick_unreach','Comfort\x20Suggestion','replace','type','N/A','info','logDuplicates','Briefing\x20Sched\x20Error:\x20','.forecast.current.temp','longitude','Urlaub','isGracePeriodActive','Subscribing\x20to\x20','lights','cancel','Last\x20Check','ack','LTM.baselineStatus','analysis.history_debug_00','config','9XhDUHm','path','analysis.health.trendValue','getGenerativeModel','\x0aSTB:\x20','payload','Baseline\x20Status','toISOString','.forecast.current.state','uuid-not-found','Vom\x20Benutzer\x20best√§tigt\x20(OK).','analysis.automation.suggestedAction','child_process','LTM.dailyDigests','LTM\x20Sched\x20Error:\x20','N/A\x20(Learning)','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','Target\x20ID','notifyEmailRecipient','getFullYear','System\x20Status\x20&\x20Control','analysis.alertReason','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','dimmer','presenceDevices','Processing\x20Status','sleepScore','pr√§senz','status','command',').\x20Saving\x20to\x20Training\x20Data.','analysis.automation.description','automationProposal','pop','map','getEnums','6861IdHYzT','üêç\x20Starting\x20Python\x20Sidecar:\x20','Scheduling\x20Morning\x20Briefing\x20for\x20','5071336YfephN','Aktiv\x20(','.data.table','enum','communicate.request','useWeather','analysis.health.notes','extendObjectAsync','Activity-Level','level','\x20days\x20of\x20activity\x20data\x20to\x20Python...','LTM.driftAnalysis','system.meta.uuid','driftAnalysisTimer','kontakt','getDate','Logbook','setState','namespace','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','VACATION','location','time','analysis.comfortSuggestion','motion','flot.','getObjectAsync','analysis.automation.targetValue','Sending\x20notification:\x20\x22','pythonProcess','weatherunderground','subscribeForeignStatesAsync','config_pending','analysis.trigger','Entry\x20detected\x20via\x20','AI\x20Emergency\x20Status','getOverviewData','Cogni-Living','0\x203\x20*\x20*\x20*','.\x20Welcome\x20home.','\x20(Length:\x20','toString','error','ready','subscribeStates','geminiApiKey','analysis.health.sleepScore','\x20events)...','Reset\x20Sched\x20Error:\x20','modeResetJob','rssi','exitTimer','some','\x20|\x20'];a0_0xb1c8=function(){return _0x3a0074;};return a0_0xb1c8();}async function recordThermodynamics(_0x3d0701,_0x37363b,_0x1f235e,_0x4cf010){const _0x2aed6e=a0_0x42ed3a,_0x1f11a9=await getOutsideTemperatureNumeric(_0x3d0701),_0xd03822=await _0x3d0701[_0x2aed6e(0x156)](_0x2aed6e(0x2ef));let _0x7e0be1=[];if(_0xd03822&&_0xd03822[_0x2aed6e(0x1f0)])try{_0x7e0be1=JSON[_0x2aed6e(0x2de)](_0xd03822[_0x2aed6e(0x1f0)]);}catch(_0x421bc1){}_0x7e0be1[_0x2aed6e(0x11f)]({'ts':Date[_0x2aed6e(0x287)](),'room':_0x4cf010||_0x2aed6e(0x1e4),'t_in':_0x1f235e,'t_out':_0x1f11a9});if(_0x7e0be1[_0x2aed6e(0x2f3)]>THERMO_LOG_SIZE)_0x7e0be1[_0x2aed6e(0x262)]();await _0x3d0701[_0x2aed6e(0x2fb)]('LTM.trainingData.thermodynamics',{'val':JSON[_0x2aed6e(0x2c9)](_0x7e0be1),'ack':!![]});}async function processSensorEvent(_0x198e45,_0x22ca36,_0x204013,_0x3c3288){const _0x42478e=a0_0x42ed3a;if(!_0x3c3288)return;const _0x2d72ff=_0x204013[_0x42478e(0x1f0)],_0x537811=Date[_0x42478e(0x287)]();_0x198e45['log']['debug'](_0x42478e(0x1ef)+_0x22ca36+'\x20=\x20'+_0x2d72ff);const _0x257b8a=_0x198e45[_0x42478e(0x126)][_0x22ca36];_0x198e45[_0x42478e(0x126)][_0x22ca36]=_0x2d72ff;if(!_0x3c3288[_0x42478e(0x15f)]&&_0x257b8a!=undefined&&_0x257b8a==_0x2d72ff){_0x198e45[_0x42478e(0x257)]['debug']('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x3c3288['name']+_0x42478e(0x145)+_0x2d72ff+')');return;}_0x198e45[_0x42478e(0x238)]&&_0x3c3288['type']==='temperature'&&recordThermodynamics(_0x198e45,_0x22ca36,_0x2d72ff,_0x3c3288[_0x42478e(0x1a9)]);const _0x3a4f07={'timestamp':_0x537811,'id':_0x22ca36,'name':_0x3c3288[_0x42478e(0x26c)],'type':_0x3c3288[_0x42478e(0x15c)],'location':_0x3c3288[_0x42478e(0x1a9)],'value':_0x2d72ff};_0x198e45['eventHistory']['unshift'](_0x3a4f07);if(_0x198e45[_0x42478e(0x2d6)]['length']>HISTORY_MAX_SIZE)_0x198e45[_0x42478e(0x2d6)][_0x42478e(0x18e)]();await _0x198e45['setStateAsync'](_0x42478e(0x201),{'val':JSON[_0x42478e(0x2c9)](_0x3a4f07),'ack':!![]}),await _0x198e45[_0x42478e(0x2fb)](_0x42478e(0x22a),{'val':JSON[_0x42478e(0x2c9)](_0x198e45[_0x42478e(0x2d6)]),'ack':!![]});_0x198e45[_0x42478e(0x238)]&&(_0x198e45['rawEventLog']['push'](_0x3a4f07),await saveRawEventLog(_0x198e45),recordSequence(_0x198e45,_0x3a4f07));if(_0x3c3288[_0x42478e(0x234)]&&_0x2d72ff===!![]){if(_0x198e45['isPresent']&&!_0x198e45[_0x42478e(0x164)])_0x198e45[_0x42478e(0x257)][_0x42478e(0x15e)](_0x42478e(0x28f)+_0x3c3288[_0x42478e(0x26c)]+_0x42478e(0x1d1)),startExitTimer(_0x198e45);else!_0x198e45['isPresent']&&(_0x198e45[_0x42478e(0x257)][_0x42478e(0x15e)](_0x42478e(0x1b6)+_0x3c3288[_0x42478e(0x26c)]+_0x42478e(0x1bb)),await setPresence(_0x198e45,!![]));}else _0x3c3288[_0x42478e(0x15c)]===_0x42478e(0x1ac)&&_0x2d72ff===!![]&&(_0x198e45[_0x42478e(0x1c7)]&&(_0x198e45[_0x42478e(0x257)][_0x42478e(0x15e)](_0x42478e(0x249)),abortExitTimer(_0x198e45)),!_0x198e45['isPresent']&&_0x198e45[_0x42478e(0x275)]===SYSTEM_MODES[_0x42478e(0x13b)]&&await setPresence(_0x198e45,!![]));}async function runGeminiAnalysis(_0x2b3a2c,_0xe2e3c2=''){const _0x54292b=a0_0x42ed3a;if(!_0x2b3a2c['geminiModel'])return;if(_0x2b3a2c[_0x54292b(0x2d6)][_0x54292b(0x2f3)]===0x0)return;const _0x21954b=_0x2b3a2c[_0x54292b(0x2d6)]['slice'](0x0,0xf),_0x253fb4=await getWeatherContext(_0x2b3a2c),_0x3b980e=_0x2b3a2c[_0x54292b(0x275)],_0x4eb054=PERSONA_MAPPING[_0x2b3a2c[_0x54292b(0x16c)][_0x54292b(0x29d)]||'generic'],_0x5157db=_0x2b3a2c[_0x54292b(0x16c)][_0x54292b(0x243)]||'Keine\x20Details.';let _0x5341e7=![];try{const _0x2232bc=await _0x2b3a2c['getStateAsync'](_0x54292b(0x230));if(_0x2232bc&&_0x2232bc[_0x54292b(0x1f0)])_0x5341e7=!![];}catch(_0x317e50){}const _0x1f266e=_0x54292b(0x2a2)+_0x4eb054+_0x54292b(0x1f5)+_0x5157db+_0x54292b(0x2da)+_0x3b980e+_0x54292b(0x226)+_0x253fb4+_0x54292b(0x183)+(_0xe2e3c2||_0x54292b(0x2ca))+'.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20'+JSON[_0x54292b(0x2c9)](_0x21954b)+_0x54292b(0x28e);try{const _0x480ec7=await _0x2b3a2c[_0x54292b(0x134)][_0x54292b(0x12a)](_0x1f266e),_0x1d2dd3=_0x480ec7['response']['text']()[_0x54292b(0x15b)](/```json|```/g,'')[_0x54292b(0x301)](),_0x4ca075=JSON[_0x54292b(0x2de)](_0x1d2dd3);await _0x2b3a2c['setStateAsync']('analysis.lastResult',{'val':JSON[_0x54292b(0x2c9)](_0x4ca075),'ack':!![]});_0x4ca075[_0x54292b(0x252)]&&await _0x2b3a2c[_0x54292b(0x2fb)](_0x54292b(0x211),{'val':_0x4ca075['summary'],'ack':!![]});const _0xf30fd8={'timestamp':Date[_0x54292b(0x287)](),'id':Date['now']()[_0x54292b(0x1bd)](),'analysis':{'activity':{'summary':_0x4ca075['summary']||_0x54292b(0x2a1),'isAlert':_0x4ca075[_0x54292b(0x27f)]||![],'alertReason':_0x4ca075[_0x54292b(0x144)]},'comfort':{'automationProposal':_0x4ca075[_0x54292b(0x18d)]}}};await updateAnalysisHistory(_0x2b3a2c,_0xf30fd8);const _0x545b53=_0x4ca075[_0x54292b(0x27f)]||![];_0x545b53!==_0x2b3a2c[_0x54292b(0x266)]&&(await _0x2b3a2c[_0x54292b(0x2fb)]('analysis.isAlert',{'val':_0x545b53,'ack':!![]}),_0x2b3a2c[_0x54292b(0x266)]=_0x545b53,_0x545b53&&(await _0x2b3a2c[_0x54292b(0x2fb)](_0x54292b(0x182),{'val':_0x4ca075[_0x54292b(0x144)],'ack':!![]}),sendNotification(_0x2b3a2c,_0x54292b(0x113)+_0x4ca075[_0x54292b(0x144)],![],_0x4ca075[_0x54292b(0x2f9)]))),_0x4ca075[_0x54292b(0x18d)]&&_0x4ca075[_0x54292b(0x18d)][_0x54292b(0x130)]&&_0x4ca075[_0x54292b(0x18d)]['targetId']&&(_0x2b3a2c['log'][_0x54292b(0x15e)](_0x54292b(0x17d)+_0x4ca075[_0x54292b(0x18d)][_0x54292b(0x10c)]),await _0x2b3a2c[_0x54292b(0x2fb)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x2b3a2c[_0x54292b(0x2fb)](_0x54292b(0x18c),{'val':_0x4ca075['automationProposal'][_0x54292b(0x10c)],'ack':!![]}),await _0x2b3a2c['setStateAsync']('analysis.automation.targetId',{'val':_0x4ca075[_0x54292b(0x18d)]['targetId'],'ack':!![]}),await _0x2b3a2c[_0x54292b(0x2fb)]('analysis.automation.targetValue',{'val':JSON['stringify'](_0x4ca075[_0x54292b(0x18d)][_0x54292b(0x13c)]),'ack':!![]}),_0x5341e7&&(_0x2b3a2c[_0x54292b(0x257)][_0x54292b(0x15e)](_0x54292b(0x12e)+_0x4ca075[_0x54292b(0x18d)][_0x54292b(0x2ee)]+_0x54292b(0x10d)),await executeAutomationAction(_0x2b3a2c)));}catch(_0x2f7297){_0x2b3a2c['log'][_0x54292b(0x1be)](_0x54292b(0x209)+_0x2f7297[_0x54292b(0x2e8)]);}}function installPythonDependencies(_0x9e3764){const _0x3d3fea=a0_0x42ed3a;if(_0x9e3764[_0x3d3fea(0x2ff)])return;_0x9e3764['dependencyInstallInProgress']=!![];const _0x2f1a24=path[_0x3d3fea(0x22c)](__dirname,_0x3d3fea(0x2d2),_0x3d3fea(0x2bd));_0x9e3764['log'][_0x3d3fea(0x15e)](_0x3d3fea(0x124)+_0x2f1a24+_0x3d3fea(0x10d)),stopPythonService(_0x9e3764);const _0x49828c=_0x3d3fea(0x208)+_0x2f1a24+_0x3d3fea(0x23e);exec(_0x49828c,(_0x14c2b2,_0x2b5b69,_0x40f1c3)=>{const _0x3fa30a=_0x3d3fea;_0x9e3764[_0x3fa30a(0x2ff)]=![],_0x14c2b2?(_0x9e3764[_0x3fa30a(0x257)]['error']('‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x49828c),_0x9e3764[_0x3fa30a(0x257)][_0x3fa30a(0x1be)]('Details:\x20'+(_0x40f1c3||_0x14c2b2['message']))):(_0x9e3764[_0x3fa30a(0x257)][_0x3fa30a(0x15e)](_0x3fa30a(0x281)),startPythonService(_0x9e3764));});}function sendToPython(_0x1caf1a,_0x400281,_0x34755b={}){const _0x49a3b4=a0_0x42ed3a;if(!_0x1caf1a[_0x49a3b4(0x1b1)]||!_0x1caf1a[_0x49a3b4(0x1b1)][_0x49a3b4(0x2c5)][_0x49a3b4(0x271)])return;const _0x5d8893=JSON['stringify']({'command':_0x400281,..._0x34755b});try{_0x1caf1a[_0x49a3b4(0x1b1)][_0x49a3b4(0x2c5)][_0x49a3b4(0x1fe)](_0x5d8893+'\x0a');}catch(_0xf142aa){_0x1caf1a[_0x49a3b4(0x257)][_0x49a3b4(0x1be)]('Failed\x20to\x20send\x20to\x20Python:\x20'+_0xf142aa[_0x49a3b4(0x2e8)]);}}function runPythonHealthCheck(_0x336cb1){const _0x5c6299=a0_0x42ed3a;if(!_0x336cb1['dailyDigests']||_0x336cb1[_0x5c6299(0x1d7)][_0x5c6299(0x2f3)]<0x2){_0x336cb1['log']['info']('Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.');return;}const _0x2426eb=_0x336cb1[_0x5c6299(0x1d7)][_0x5c6299(0x18f)](_0x4e2807=>{const _0x1fc99a=_0x5c6299,_0x31a770=(_0x4e2807[_0x1fc99a(0x206)]||'')[_0x1fc99a(0x150)]();return ACTIVITY_LEVEL_MAP[_0x31a770]||0x32;});_0x336cb1[_0x5c6299(0x257)][_0x5c6299(0x15e)](_0x5c6299(0x242)+_0x2426eb[_0x5c6299(0x2f3)]+_0x5c6299(0x19e)),sendToPython(_0x336cb1,'ANALYZE_TREND',{'values':_0x2426eb,'tag':_0x5c6299(0x19c)});}function handlePythonResult(_0x530081,_0x23adb8){const _0x3dc8dd=a0_0x42ed3a;if(_0x23adb8[_0x3dc8dd(0x15c)]===_0x3dc8dd(0x2af))_0x530081[_0x3dc8dd(0x257)][_0x3dc8dd(0x116)]('üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.');else{if(_0x23adb8[_0x3dc8dd(0x15c)]===_0x3dc8dd(0x1dc)){const {tag:_0x2c603c,diagnosis:_0xccea30,change_percent:_0x32281e}=_0x23adb8[_0x3dc8dd(0x172)];_0x530081[_0x3dc8dd(0x257)][_0x3dc8dd(0x15e)](_0x3dc8dd(0x240)+_0x2c603c+_0x3dc8dd(0x1ed)+_0xccea30+'\x20('+_0x32281e+'%)'),_0x530081['setStateAsync'](_0x3dc8dd(0x23c),{'val':_0xccea30,'ack':!![]}),_0x530081['setStateAsync'](_0x3dc8dd(0x16f),{'val':_0x32281e,'ack':!![]});}}}function startPythonService(_0x4487ff){const _0x6ab97d=a0_0x42ed3a;try{const _0x28a8b5=path[_0x6ab97d(0x22c)](__dirname,_0x6ab97d(0x2d2),'service.py');_0x4487ff[_0x6ab97d(0x257)][_0x6ab97d(0x15e)](_0x6ab97d(0x192)+_0x28a8b5),_0x4487ff[_0x6ab97d(0x1b1)]=spawn(_0x6ab97d(0x265),[_0x28a8b5]),_0x4487ff[_0x6ab97d(0x1b1)][_0x6ab97d(0x284)]['on'](_0x6ab97d(0x1f9),_0xcb242e=>{const _0x3f5fc4=_0x6ab97d,_0x2a2b57=_0xcb242e[_0x3f5fc4(0x1bd)]()['split']('\x0a');_0x2a2b57['forEach'](_0x3a7a67=>{const _0x490d6b=_0x3f5fc4,_0x491b9d=_0x3a7a67[_0x490d6b(0x301)]();if(!_0x491b9d)return;if(_0x491b9d[_0x490d6b(0x136)](_0x490d6b(0x12c)))_0x4487ff['log']['debug'](_0x490d6b(0x29c)+_0x491b9d['substring'](0x5)[_0x490d6b(0x301)]());else{if(_0x491b9d[_0x490d6b(0x136)](_0x490d6b(0x14d)))try{const _0x1e4080=JSON[_0x490d6b(0x2de)](_0x491b9d['substring'](0x8)[_0x490d6b(0x301)]());handlePythonResult(_0x4487ff,_0x1e4080);}catch(_0x3dc8bb){_0x4487ff[_0x490d6b(0x257)][_0x490d6b(0x25a)](_0x490d6b(0x269)+_0x491b9d);}}(_0x491b9d[_0x490d6b(0x20c)](_0x490d6b(0x21a))||_0x491b9d[_0x490d6b(0x20c)](_0x490d6b(0x2fd)))&&(_0x4487ff['log'][_0x490d6b(0x25a)]('‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...'),installPythonDependencies(_0x4487ff));});}),_0x4487ff['pythonProcess'][_0x6ab97d(0x139)]['on'](_0x6ab97d(0x1f9),_0x585da1=>{const _0x427eae=_0x6ab97d,_0x1a2578=_0x585da1[_0x427eae(0x1bd)]()[_0x427eae(0x301)]();_0x4487ff[_0x427eae(0x257)][_0x427eae(0x1be)]('[PYTHON\x20ERR]\x20'+_0x1a2578);}),_0x4487ff[_0x6ab97d(0x1b1)]['on'](_0x6ab97d(0x2ae),_0x427d5a=>{const _0xb3d21c=_0x6ab97d;_0x4487ff['log'][_0xb3d21c(0x15e)](_0xb3d21c(0x248)+_0x427d5a),_0x4487ff[_0xb3d21c(0x1b1)]=null;}),_0x4487ff[_0x6ab97d(0x1b1)]['on']('error',_0x129a4e=>{const _0x2ff19b=_0x6ab97d;_0x4487ff['log'][_0x2ff19b(0x25a)](_0x2ff19b(0x298)+_0x129a4e[_0x2ff19b(0x2e8)]);});}catch(_0x17687b){_0x4487ff[_0x6ab97d(0x257)][_0x6ab97d(0x1be)](_0x6ab97d(0x146)+_0x17687b[_0x6ab97d(0x2e8)]);}}function stopPythonService(_0x2a8109){const _0x2de06b=a0_0x42ed3a;if(_0x2a8109[_0x2de06b(0x1b1)]){_0x2a8109[_0x2de06b(0x257)][_0x2de06b(0x15e)](_0x2de06b(0x218));try{_0x2a8109[_0x2de06b(0x1b1)][_0x2de06b(0x1cb)]();}catch(_0x6d3457){_0x2a8109[_0x2de06b(0x257)][_0x2de06b(0x25a)](_0x2de06b(0x236)+_0x6d3457['message']);}_0x2a8109[_0x2de06b(0x1b1)]=null;}}class CogniLiving extends utils[a0_0x42ed3a(0x158)]{constructor(_0x1586df){const _0x11e216=a0_0x42ed3a;super({..._0x1586df,'name':_0x11e216(0x13a)}),this[_0x11e216(0x2d6)]=[],this[_0x11e216(0x24a)]=[],this[_0x11e216(0x1eb)]=[],this[_0x11e216(0x114)]=[],this[_0x11e216(0x1d7)]=[],this['sensorLastValues']={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x11e216(0x1fd)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x11e216(0x164)]=![],this['genAI']=null,this['geminiModel']=null,this[_0x11e216(0x275)]=SYSTEM_MODES['NORMAL'],this[_0x11e216(0x238)]=![],this[_0x11e216(0x266)]=![],this[_0x11e216(0x200)]=_0x11e216(0x2f8),this[_0x11e216(0x125)]=null,this['ltmJob']=null,this[_0x11e216(0x1c5)]=null,this[_0x11e216(0x1a1)]=null,this[_0x11e216(0x2e9)]=null,this[_0x11e216(0x1b1)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x11e216(0x1bf),this[_0x11e216(0x132)][_0x11e216(0x129)](this)),this['on'](_0x11e216(0x1dd),this[_0x11e216(0x24f)][_0x11e216(0x129)](this)),this['on']('unload',this[_0x11e216(0x102)][_0x11e216(0x129)](this)),this['on'](_0x11e216(0x2e8),this['onMessage'][_0x11e216(0x129)](this));}async[a0_0x42ed3a(0x132)](){const _0x249d07=a0_0x42ed3a;this[_0x249d07(0x257)][_0x249d07(0x15e)](_0x249d07(0x1ce)+this[_0x249d07(0x25c)]+_0x249d07(0x259)),await initZombies(this),this['config'][_0x249d07(0x1f1)]=this[_0x249d07(0x16c)][_0x249d07(0x1f1)]||'';try{this[_0x249d07(0x238)]=await checkLicense(this,this[_0x249d07(0x16c)][_0x249d07(0x1f1)]);}catch(_0x9a5d62){}this['log']['info']('[LICENSE\x20CHECK]\x20Key\x20present:\x20'+!!this[_0x249d07(0x16c)]['licenseKey']+_0x249d07(0x227)+(this[_0x249d07(0x238)]?_0x249d07(0x28c):_0x249d07(0x1de)));if(!this[_0x249d07(0x16c)][_0x249d07(0x111)]||this[_0x249d07(0x16c)][_0x249d07(0x111)]<0.1)this[_0x249d07(0x16c)][_0x249d07(0x111)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x249d07(0x16c)][_0x249d07(0x1c1)])try{this[_0x249d07(0x23d)]=new GoogleGenerativeAI(this[_0x249d07(0x16c)][_0x249d07(0x1c1)]),this[_0x249d07(0x134)]=this['genAI'][_0x249d07(0x170)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x249d07(0x257)][_0x249d07(0x15e)](_0x249d07(0x229));}catch(_0x457341){this[_0x249d07(0x257)]['error']('Gemini\x20Init\x20Error:\x20'+_0x457341[_0x249d07(0x2e8)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x249d07(0x1c0)](_0x249d07(0x1b5)),this[_0x249d07(0x1c0)](LTM_DP_TRIGGER_DIGEST),this[_0x249d07(0x1c0)](_0x249d07(0x2c2)),this[_0x249d07(0x1c0)](_0x249d07(0x244)),this[_0x249d07(0x1c0)]('analysis.automation.triggerAction'),this['subscribeStates'](_0x249d07(0x230)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x249d07(0x125)])clearInterval(this[_0x249d07(0x125)]);const _0xb59369=this['config']['analysisInterval']||0xf;_0xb59369>0x0&&(this[_0x249d07(0x257)][_0x249d07(0x15e)](_0x249d07(0x14b)+_0xb59369+'\x20min).'),this['analysisTimer']=setInterval(()=>{runAutopilot(this);},_0xb59369*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x585916=_0x249d07;this[_0x585916(0x1b1)]&&runPythonHealthCheck(this);},0x1388);}[a0_0x42ed3a(0x102)](_0x56daeb){const _0xee28f7=a0_0x42ed3a;if(this[_0xee28f7(0x125)])clearInterval(this[_0xee28f7(0x125)]);if(this[_0xee28f7(0x1a1)])clearInterval(this[_0xee28f7(0x1a1)]);if(this['ltmJob'])this[_0xee28f7(0x21e)][_0xee28f7(0x167)]();if(this[_0xee28f7(0x1c5)])this['modeResetJob']['cancel']();if(this[_0xee28f7(0x2e9)])this['briefingJob'][_0xee28f7(0x167)]();if(this[_0xee28f7(0x1c7)])clearTimeout(this['exitTimer']);if(this[_0xee28f7(0x1ea)])clearTimeout(this[_0xee28f7(0x1ea)]);stopPythonService(this),_0x56daeb();}async[a0_0x42ed3a(0x24f)](_0x3b9713,_0x91e687){const _0x1bd213=a0_0x42ed3a;if(!_0x91e687)return;if(_0x3b9713[_0x1bd213(0x20c)]('telegram')&&_0x3b9713[_0x1bd213(0x1fb)](_0x1bd213(0x198))&&_0x91e687[_0x1bd213(0x1f0)]){await handleTelegramResponse(this,_0x91e687[_0x1bd213(0x1f0)]);return;}if(_0x3b9713===this[_0x1bd213(0x1a6)]+'.'+SYSTEM_DP_MODE){_0x91e687[_0x1bd213(0x1f0)]&&Object[_0x1bd213(0x1e0)](SYSTEM_MODES)[_0x1bd213(0x20c)](_0x91e687[_0x1bd213(0x1f0)])&&(this[_0x1bd213(0x275)]=_0x91e687[_0x1bd213(0x1f0)],_0x91e687[_0x1bd213(0x1f0)]===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x91e687[_0x1bd213(0x169)])this[_0x1bd213(0x1a5)](_0x3b9713,{'val':this[_0x1bd213(0x275)],'ack':!![]});return;}if(!_0x91e687[_0x1bd213(0x169)]){_0x3b9713[_0x1bd213(0x20c)]('analysis.trigger')&&_0x91e687[_0x1bd213(0x1f0)]&&(this[_0x1bd213(0x1a5)](_0x3b9713,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x3b9713[_0x1bd213(0x20c)](_0x1bd213(0x2bf))&&_0x91e687[_0x1bd213(0x1f0)]){this[_0x1bd213(0x1a5)](_0x3b9713,{'val':![],'ack':!![]});if(this[_0x1bd213(0x238)])createDailyDigest(this);}_0x3b9713[_0x1bd213(0x20c)](_0x1bd213(0x1f2))&&_0x91e687[_0x1bd213(0x1f0)]&&(this[_0x1bd213(0x1a5)](_0x3b9713,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x3b9713[_0x1bd213(0x20c)](_0x1bd213(0x315))&&_0x91e687[_0x1bd213(0x1f0)]&&(this['setState'](_0x3b9713,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x1bd213(0x16c)]['presenceDevices']&&this[_0x1bd213(0x16c)][_0x1bd213(0x185)]['includes'](_0x3b9713)){await checkWifiPresence(this);return;}const _0x22f48b=(this[_0x1bd213(0x16c)]['devices']||[])[_0x1bd213(0x306)](_0x5af096=>_0x5af096['id']===_0x3b9713);if(_0x22f48b)processSensorEvent(this,_0x3b9713,_0x91e687,_0x22f48b);}async[a0_0x42ed3a(0x2e3)](_0x5986ea){const _0x316d24=a0_0x42ed3a;if(typeof _0x5986ea===_0x316d24(0x1e6)&&_0x5986ea[_0x316d24(0x2e8)])try{if(_0x5986ea['command']===_0x316d24(0x223)){const _0x3af78b=_0x5986ea[_0x316d24(0x2e8)][_0x316d24(0x237)]||this[_0x316d24(0x16c)][_0x316d24(0x1c1)];if(!_0x3af78b)return this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':![],'message':_0x316d24(0x308)},_0x5986ea['callback']);try{const _0x30561c=new GoogleGenerativeAI(_0x3af78b),_0xa0fd91=_0x30561c[_0x316d24(0x170)]({'model':GEMINI_MODEL}),_0x1f8a37=await _0xa0fd91[_0x316d24(0x12a)](_0x316d24(0x304)),_0x1d5353=await _0x1f8a37[_0x316d24(0x202)],_0x101ac5=_0x1d5353[_0x316d24(0x1fc)]();this[_0x316d24(0x14e)](_0x5986ea['from'],_0x5986ea[_0x316d24(0x18a)],{'success':!![],'message':'Verbindung\x20erfolgreich!\x20Antwort:\x20'+_0x101ac5[_0x316d24(0x1cf)](0x0,0x14)+_0x316d24(0x10d)},_0x5986ea[_0x316d24(0x2fa)]);}catch(_0x66e549){this['sendTo'](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea['command'],{'success':![],'message':_0x316d24(0x30c)+_0x66e549[_0x316d24(0x2e8)]},_0x5986ea['callback']);}}else{if(_0x5986ea[_0x316d24(0x18a)]==='testContext'){const _0x3a45d4=await getWeatherContext(this),_0x3d4a17=await getCalendarContext(this);this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea['command'],{'success':!![],'weather':_0x3a45d4,'calendar':_0x3d4a17},_0x5986ea[_0x316d24(0x2fa)]);}else{if(_0x5986ea['command']===_0x316d24(0x207)){}else{if(_0x5986ea['command']===_0x316d24(0x2ce)){if(!this['isProVersion'])return this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea['command'],{'success':![],'isPro':![]},_0x5986ea['callback']);let _0x316c0c={'status':_0x316d24(0x15d),'details':'','lastCheck':0x0};try{_0x316c0c['status']=(await this[_0x316d24(0x156)](LTM_DP_DRIFT_STATUS))[_0x316d24(0x1f0)],_0x316c0c[_0x316d24(0x20b)]=(await this[_0x316d24(0x156)](LTM_DP_DRIFT_DETAILS))[_0x316d24(0x1f0)],_0x316c0c[_0x316d24(0x141)]=(await this[_0x316d24(0x156)](LTM_DP_DRIFT_LAST_CHECK))[_0x316d24(0x1f0)];}catch(_0x1d013c){}const _0x2b6440=this[_0x316d24(0x24a)]||[];this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x316d24(0x1d7)],'driftAnalysis':_0x316c0c,'analysisHistory':_0x2b6440},_0x5986ea[_0x316d24(0x2fa)]);}else{if(_0x5986ea[_0x316d24(0x18a)]===_0x316d24(0x1b8)){const _0x310419=this[_0x316d24(0x1d7)][_0x316d24(0x2f3)],_0x30df07=new Date(),_0x12105d=new Date(_0x30df07[_0x316d24(0x180)](),_0x30df07[_0x316d24(0x152)](),_0x30df07[_0x316d24(0x1a3)]())[_0x316d24(0x14a)](),_0x2ab48f=this[_0x316d24(0x114)][_0x316d24(0x250)](_0x34b5e3=>new Date(_0x34b5e3[_0x316d24(0x20e)])[_0x316d24(0x14a)]()>_0x12105d)[_0x316d24(0x2f3)],_0x536910=new Array(0x18)['fill'](0x0);this[_0x316d24(0x114)]['forEach'](_0x327298=>{const _0x206880=_0x316d24,_0x35e6d4=new Date(_0x327298['timestamp']);if(_0x35e6d4['getTime']()>_0x12105d)_0x536910[_0x35e6d4[_0x206880(0x149)]()]++;});let _0x512d38={'status':_0x316d24(0x15d)};try{_0x512d38[_0x316d24(0x189)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x316d24(0x1f0)];}catch(_0x231c9a){}let _0x2eabba='';try{const _0x3f2398=await this['getStateAsync'](_0x316d24(0x24c));_0x2eabba=_0x3f2398?_0x3f2398[_0x316d24(0x1f0)]:'';}catch(_0x3c53ed){}let _0x5c774a=null;!this['geminiModel']&&(_0x5c774a=this[_0x316d24(0x16c)][_0x316d24(0x1c1)]?_0x316d24(0x30a):_0x316d24(0x294));let _0x4d8c51={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x4d3745=await this['getStateAsync'](_0x316d24(0x12d)),_0x2ad08d=await this[_0x316d24(0x156)](_0x316d24(0x18c)),_0x5e6504=await this[_0x316d24(0x156)]('analysis.automation.targetId'),_0x29fcfa=await this['getStateAsync']('analysis.automation.targetValue'),_0x1cef95=await this[_0x316d24(0x156)](_0x316d24(0x230));_0x4d3745&&_0x4d3745[_0x316d24(0x1f0)]&&(_0x4d8c51[_0x316d24(0x130)]=!![],_0x4d8c51[_0x316d24(0x10c)]=_0x2ad08d?_0x2ad08d[_0x316d24(0x1f0)]:'',_0x4d8c51['targetId']=_0x5e6504?_0x5e6504['val']:'',_0x4d8c51[_0x316d24(0x13c)]=_0x29fcfa?_0x29fcfa[_0x316d24(0x1f0)]:''),_0x4d8c51['autoApply']=_0x1cef95?!!_0x1cef95['val']:![];}catch(_0x435cfe){}this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':!![],'eventHistory':this[_0x316d24(0x2d6)][_0x316d24(0x2b6)](0x0,0xf),'stats':{'digestCount':_0x310419,'eventCountToday':_0x2ab48f,'hourlyActivity':_0x536910,'driftStatus':_0x512d38[_0x316d24(0x189)],'isPresent':this[_0x316d24(0x1fd)],'presenceWho':_0x2eabba,'minDays':this[_0x316d24(0x16c)][_0x316d24(0x232)]||0x7,'stbDays':this[_0x316d24(0x16c)]['ltmStbWindowDays']||0xe,'ltbDays':this[_0x316d24(0x16c)][_0x316d24(0x318)]||0x3c,'systemError':_0x5c774a},'automation':_0x4d8c51},_0x5986ea[_0x316d24(0x2fa)]);}else{if(_0x5986ea[_0x316d24(0x18a)]===_0x316d24(0x190)){const _0x229479=await this[_0x316d24(0x13d)](_0x316d24(0x21b),_0x316d24(0x197)),_0xad0f1a=[];if(_0x229479)for(const _0x1ba64f in _0x229479){const _0x2c1a07=_0x229479[_0x1ba64f],_0x2688b2=(_0x2c1a07[_0x316d24(0x1f7)]&&typeof _0x2c1a07[_0x316d24(0x1f7)][_0x316d24(0x26c)]===_0x316d24(0x1e6)?_0x2c1a07[_0x316d24(0x1f7)][_0x316d24(0x26c)]['de']:_0x2c1a07[_0x316d24(0x1f7)][_0x316d24(0x26c)])||_0x2c1a07[_0x316d24(0x1f7)][_0x316d24(0x26c)];_0xad0f1a[_0x316d24(0x11f)]({'id':_0x1ba64f,'name':_0x2688b2});}this[_0x316d24(0x14e)](_0x5986ea['from'],_0x5986ea[_0x316d24(0x18a)],{'success':!![],'enums':_0xad0f1a},_0x5986ea[_0x316d24(0x2fa)]);}else{if(_0x5986ea['command']===_0x316d24(0x1cc))try{const _0x5cfe16=await scanForDevices(this,_0x5986ea['message']||{});this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':!![],'devices':_0x5cfe16},_0x5986ea['callback']);}catch(_0x5bf198){this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':![],'error':_0x5bf198['message']},_0x5986ea['callback']);}else{if(_0x5986ea[_0x316d24(0x18a)]===_0x316d24(0x2f1)){const _0x4c17b9=_0x5986ea['message'][_0x316d24(0x2c0)];if(!_0x4c17b9)return this['sendTo'](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea['command'],{'success':![],'error':_0x316d24(0x20a)},_0x5986ea[_0x316d24(0x2fa)]);const _0x102f25=await getCalendarNames(this,_0x4c17b9);this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':!![],'names':_0x102f25},_0x5986ea[_0x316d24(0x2fa)]);}else{if(_0x5986ea[_0x316d24(0x18a)]===_0x316d24(0x12b)){const {targetId:_0x383811,targetValue:_0x3e67e9}=_0x5986ea[_0x316d24(0x2e8)];this['log'][_0x316d24(0x15e)](_0x316d24(0x1f6)+_0x383811+_0x316d24(0x2e4)+_0x3e67e9),await this[_0x316d24(0x2fb)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x316d24(0x2fb)](_0x316d24(0x18c),{'val':'SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20'+_0x383811,'ack':!![]}),await this[_0x316d24(0x2fb)]('analysis.automation.targetId',{'val':_0x383811,'ack':!![]}),await this[_0x316d24(0x2fb)](_0x316d24(0x1af),{'val':_0x3e67e9,'ack':!![]}),this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':!![]},_0x5986ea[_0x316d24(0x2fa)]);}else{if(_0x5986ea[_0x316d24(0x18a)]===_0x316d24(0x115)){const {historyId:_0x47f33a,rating:_0x48afa3,comment:_0xba898c,alertReason:_0x4c2f48}=_0x5986ea[_0x316d24(0x2e8)];_0x47f33a&&_0x48afa3?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x47f33a,'rating':_0x48afa3,'comment':_0xba898c,'alertReason':_0x4c2f48}),this[_0x316d24(0x14e)](_0x5986ea['from'],_0x5986ea[_0x316d24(0x18a)],{'success':!![]},_0x5986ea['callback'])):this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':![],'error':'Missing\x20data'},_0x5986ea['callback']);}else _0x5986ea[_0x316d24(0x18a)]===_0x316d24(0x122)&&(this[_0x316d24(0x257)][_0x316d24(0x15e)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x316d24(0x2fb)](_0x316d24(0x12d),{'val':![],'ack':!![]}),await this[_0x316d24(0x2fb)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x316d24(0x14e)](_0x5986ea['from'],_0x5986ea[_0x316d24(0x18a)],{'success':!![]},_0x5986ea['callback']));}}}}}}}}}}catch(_0x5f1c50){this[_0x316d24(0x257)][_0x316d24(0x1be)]('Error\x20in\x20onMessage\x20command\x20'+_0x5986ea['command']+':\x20'+_0x5f1c50[_0x316d24(0x2e8)]);if(_0x5986ea['callback'])this[_0x316d24(0x14e)](_0x5986ea[_0x316d24(0x2cc)],_0x5986ea[_0x316d24(0x18a)],{'success':![],'error':_0x5f1c50[_0x316d24(0x2e8)]},_0x5986ea[_0x316d24(0x2fa)]);}}}if(require[a0_0x42ed3a(0x2ed)]!==module)module[a0_0x42ed3a(0x283)]=_0x20bf80=>new CogniLiving(_0x20bf80);else new CogniLiving();