const a0_0x3efa97=a0_0x349c;(function(_0x5ed2d9,_0x5cf3d6){const _0xeb682d=a0_0x349c,_0x411036=_0x5ed2d9();while(!![]){try{const _0x3d114b=-parseInt(_0xeb682d(0x387))/0x1+parseInt(_0xeb682d(0x1c0))/0x2+-parseInt(_0xeb682d(0x1aa))/0x3+parseInt(_0xeb682d(0x2b6))/0x4*(parseInt(_0xeb682d(0x1fe))/0x5)+parseInt(_0xeb682d(0x1ec))/0x6*(-parseInt(_0xeb682d(0x239))/0x7)+-parseInt(_0xeb682d(0x317))/0x8*(-parseInt(_0xeb682d(0x214))/0x9)+parseInt(_0xeb682d(0x35a))/0xa;if(_0x3d114b===_0x5cf3d6)break;else _0x411036['push'](_0x411036['shift']());}catch(_0x203e7a){_0x411036['push'](_0x411036['shift']());}}}(a0_0x30b8,0x4bf20));function a0_0x30b8(){const _0x44b959=['notifyWhatsappInstance','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','analysis.automation.description','RSSI','value.health','.\x20PR√ÑSENZ:\x20','loadDailyDigests','0\x204\x20*\x20*\x20*','PARTY','\x20*\x20*\x20*','Briefing\x20Error:\x20','update','License\x20Check\x20failed:\x20','system','rollladen','weather','selectedFunctionIds','time','WORKING','LTM.processingStatus','events.lastEvent','splice','.NextHours.Location_1.Day_1.current.symbol_desc','Last\x20Check','notifyEmailInstance','description','slice','join','LTM.driftAnalysis.lastCheck','sendTo','08:00','Drift\x20Status','LTM.rawEventLog','notes','search','analysisTimer','logDuplicates','callback','presenceDevices','constructor','analysis.analysisHistory','type','/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20','health','loadRawEventLog','LTM.baselineStatus','genAI','AI\x20Emergency\x20Status','signal','events.history_debug_03','error','exitGraceTimer','Success','useWeather','755308dxtPGh','uuid-not-found','catch','Normal','subscribeStates','toLocaleString','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','delObjectAsync','.SECTION','on/off','sendToAsync','Processing\x20Status','custom','getStateAsync','ltmLtbWindowDays','schlaf','systemUUID','geminiApiKey','Adapter','enum','submitFeedback','parse','accuweather','send','event','de-DE','Trigger\x20Analysis','log','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','summary','switch','checkSystemObjects','Last\x20Result','Logbook','testNotification','events.history_debug_00','isProVersion','checkLtmObjects','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','sendNotification','\x20sent','Daily\x20Digest\x20Error:\x20','rating','NORMAL','KALENDER:\x20Keine\x20Daten','uuid','isPresent','\x20min).\x20Watchdog\x20Limit:\x20','unshift','system.config','apiKey','tryParse','some','generateContent','getCalendarContext','Drift\x20Sched\x20Error:\x20','analysis.history_debug_04','modeResetJob','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','enum.rooms.*','garten','analysis.history_debug_01','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','feedbackHistory','apply','Error\x20checking\x20WiFi:\x20','isGracePeriodActive','indicator','city','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','flot.','saveDailyDigests','saveRawEventLog','setupLtmScheduler','location','LTM','blind','command','setupModeResetScheduler','setState','admin.','getForeignObjectAsync','scanForDevices','Comfort\x20Summary','wohn','ltmDriftCheckIntervalHours','icons-mfd.','cogni-living','wetter','exitTimer','getObjectAsync','Error\x20creating\x20objects:\x20','onMessage','system.','details','json','Error\x20reading\x20calendar\x20table:\x20','8HxdVTf','members','notifySignalInstance','testContext','includes','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','setHours','notifyEmailEnabled','info','bewegung','unload','\x0aFEEDBACK:\x0a','\x20sensors...','k√ºche','analysis.health.sleepScore','Presence\x20Status','analysis.comfortSuggestion','bind','activityLevel','analysis.automation.patternDetected','automationProposal','Action','setupBriefingScheduler','Starting\x20Autopilot\x20(','find','Wohnzimmer','weatherInstance','push','sendMorningBriefing','accuweather.0','events.history_debug_01','string','livingContext','runAutopilot','state','\x0a\x0aA\x20(STB):\x0a','Urlaub','sensorLastValues','calendarInstance','scheduleJob','TEST-PRO-KEY','analysis.health','main','Health\x20&\x20Sleep\x20Analysis','@iobroker/adapter-core','diele','KALENDER\x20ERROR:\x20','Alert\x20Reason','Pattern\x20Detected','getCalendarNames\x20Error:\x20','updateBaselineStatus','flur','Restlessness\x20Level','message','uuid-error','.\x20PERSONA:\x20','events.history_debug_04','scanDevices','driftDetails','analysis.health.restlessness','Feedback\x20Log','Analysiere\x20Tag...','licht','analysis.health.notes','analysis.history_debug_00','üö®üö®\x20NOTFALL','[Test]\x20Notification','1852870DUEbvm','replace','saveFeedback','createAllObjects','Deaktiviert\x20(Pro-Feature)','toLowerCase','analysis.comfortSummary','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','alertReason','setPresence','Daily\x20Digests','lastAlertState','analysis.automation','.forecast.current.state','system.meta.uuid','Generating\x20Morning\x20Briefing...','humidity','notifyEmailRecipient','material.','cancel','light','ltmStbWindowDays','response','indicator.alarm','contact','common','none','generic','rawEventLog','deviationFromBaseline','version','initSystemConfig','toString','dimmer','getForeignStateAsync','warn','b√ºro','lampe','Daily\x20Digest\x20created\x20successfully.','echarts.','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','ERROR','K√ºche','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','System\x20Status\x20&\x20Control','44130EKGNVt','initHistory','\x20|\x20','notifyPushoverEnabled','analysis.history_debug_02','setStateAsync','setupDriftAnalysisScheduler','sound','checkLicense','@google/generative-ai','getWeatherContext','DIRECTION','76278fMsnpP','LTM\x20Sched\x20Error:\x20','Baseline\x20Status','VACATION','analysis.isEmergency','write','analysis.activitySummary','triggerBriefing','connection','exports','Description','LTM.driftAnalysis.baselineDrift','sensor','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','analysis.alertReason','No\x20instance','shutter','\x20raw\x20events...','analysisHistory','isArray','965188LAyfHu','WETTER:\x20','STICKY_UNREACH','pressure','Lernphase\x20(','analysis.lastResult','forecast','2-digit','klima','ltmJob','KALENDER:\x20','bad','date','currentSystemMode','No\x20Key','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','expire','notifyTelegramInstance','Gemini\x20Init\x20Error:\x20','isAlert','object','Reset\x20Sched\x20Error:\x20','SABOTAGE','length','thermostat','latitude','instance','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','Gast','Party','analysis.triggerBriefing','subscribeForeignStatesAsync','onUnload','baselineDrift','updateAnalysisHistory','getGenerativeModel','restlessness','isEmergency','config','split','loadSystemMode','analysis.history_debug_03','getLtmData','boolean','222yZwzUC','number','GUEST','map','text.alarm','enum.functions.*','\x20Tage)','lock','Event\x20History','notifySignalEnabled','siren','suggestion','suggestedAction','startsWith','onReady','Briefing\x20Sched\x20Error:\x20','.data.table','minDaysForBaseline','5HHDJtQ','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','online','ack','vacation','initSensorSubscriptions','inactivityMonitoringEnabled','initZombies','lights','analysis.trigger','isExit','Missing\x20data','Gemini\x20AI\x20initialized.','Trigger\x20Briefing\x20(Test)','Scanning\x20for\x20devices\x20(Smart\x20Naming\x20v2\x20+\x20Legacy\x20Filters)...','scene','sleepScore','WETTER\x20ERROR:\x20','Schlafzimmer','Subscribing\x20to\x20','_calName','Health\x20Notes','256401tbwOSr','system.mode','notifyPushoverInstance','(((.+)+)+)+$','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','security','timestamp','analysisInterval','test','from','weatherunderground.0','schalter','analysis.deviationFromBaseline','aiPersona','comfort','systemConfig','activity','pop','checkLtmDriftObjects','N/A','.TEST','checkWifiPresence','N/A\x20(Learning)','briefingJob','No\x20recorded\x20events\x20yet.','PRO-','runGeminiAnalysis','abortExitTimer','analysis.automation.suggestedAction','toISOString','eventHistory','processSensorEvent','Trigger\x20Digest','analysis.isAlert','now','runBaselineDriftAnalysis','sort','95459KlDiDi','name','toFixed','Activity\x20Summary','guest','dailyDigests','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','events.history','party','.INSTALL_TEST','_score','stringify','extendObjectAsync','Sleep\x20Score\x20(0-100)','onStateChange','models/gemini-flash-latest','triggerDailyDigest','LOWBAT','motion','briefingTime','.Summary.Current','UNREACH','analysis.feedbackHistory','driftAnalysisTimer','initPresenceSubscriptions','createDailyDigest','Feedback\x20saved:\x20','briefingEnabled','LTM.dailyDigests','Creating\x20Daily\x20Digest\x20from\x20','inactivityThresholdHours','System\x20Mode','temperature','text','notifyWhatsappRecipient','calendarSelection','Fehler:\x20','icon','vis.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}','cogni-living\x20adapter\x20starting\x20(v','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','startExitTimer','getForeignObjectsAsync','User\x20Feedback:\x20Alarm\x20\x22','long','Baseline:\x20Inactive\x20(Pro\x20Feature).','filter','window','LTM.driftAnalysis.driftDetails','val','button','channel','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','history.','CONFIG_PENDING','devices','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','trim','longitude','door','getSystemUUID','Flur','setObjectNotExistsAsync','Raw\x20Log','ready','unknown','Morning\x20Briefing\x20sent.','geminiModel','normal','licenseKey'];a0_0x30b8=function(){return _0x44b959;};return a0_0x30b8();}const a0_0x31d40f=(function(){let _0x4c58ab=!![];return function(_0x31023a,_0x106f12){const _0x1db6a3=_0x4c58ab?function(){const _0x49935c=a0_0x349c;if(_0x106f12){const _0x4741ce=_0x106f12[_0x49935c(0x2f6)](_0x31023a,arguments);return _0x106f12=null,_0x4741ce;}}:function(){};return _0x4c58ab=![],_0x1db6a3;};}()),a0_0x19b5e4=a0_0x31d40f(this,function(){const _0x3d394a=a0_0x349c;return a0_0x19b5e4['toString']()[_0x3d394a(0x2a2)](_0x3d394a(0x217))['toString']()[_0x3d394a(0x2a7)](a0_0x19b5e4)[_0x3d394a(0x2a2)]('(((.+)+)+)+$');});a0_0x19b5e4();function a0_0x349c(_0x175245,_0x5f26d0){const _0x3591ca=a0_0x30b8();return a0_0x349c=function(_0x19b5e4,_0x31d40f){_0x19b5e4=_0x19b5e4-0x19f;let _0x30b8d7=_0x3591ca[_0x19b5e4];return _0x30b8d7;},a0_0x349c(_0x175245,_0x5f26d0);}'use strict';const utils=require(a0_0x3efa97(0x343)),{GoogleGenerativeAI}=require(a0_0x3efa97(0x1a7)),schedule=require('node-schedule'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x3efa97(0x248),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x3efa97(0x287),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x3efa97(0x2a0),LTM_DP_DAILY_DIGESTS=a0_0x3efa97(0x255),LTM_DP_STATUS=a0_0x3efa97(0x293),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x3efa97(0x2ad),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x3efa97(0x1b5),LTM_DP_DRIFT_DETAILS=a0_0x3efa97(0x26a),LTM_DP_DRIFT_LAST_CHECK=a0_0x3efa97(0x29c),SYSTEM_DP_MODE=a0_0x3efa97(0x215),IGNORE_TERMS=[a0_0x3efa97(0x24e),a0_0x3efa97(0x24a),a0_0x3efa97(0x283),a0_0x3efa97(0x383),'FAULT',a0_0x3efa97(0x1d6),'ALARM',a0_0x3efa97(0x270),'DUTYCYCLE',a0_0x3efa97(0x292),a0_0x3efa97(0x1a9),a0_0x3efa97(0x1c2),a0_0x3efa97(0x28b),'firmware',a0_0x3efa97(0x378),a0_0x3efa97(0x1b2),'info',a0_0x3efa97(0x2b0),'battery',a0_0x3efa97(0x20d),'group','all_lights',a0_0x3efa97(0x2be),a0_0x3efa97(0x228),a0_0x3efa97(0x242),a0_0x3efa97(0x30e),a0_0x3efa97(0x28f),a0_0x3efa97(0x1c6),a0_0x3efa97(0x2d3),a0_0x3efa97(0x25e),'wind',a0_0x3efa97(0x1c3),'uv','history'],ADAPTER_BLACKLIST=[a0_0x3efa97(0x313),a0_0x3efa97(0x306),'info.',a0_0x3efa97(0x25f),a0_0x3efa97(0x26f),a0_0x3efa97(0x36c),a0_0x3efa97(0x30c),a0_0x3efa97(0x2fc),a0_0x3efa97(0x381)],SYSTEM_MODES={'NORMAL':a0_0x3efa97(0x27e),'VACATION':a0_0x3efa97(0x202),'PARTY':a0_0x3efa97(0x241),'GUEST':a0_0x3efa97(0x23d)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x3efa97(0x1ee)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x3efa97(0x31c),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','family':a0_0x3efa97(0x218),'single_comfort':a0_0x3efa97(0x2dc),'security':a0_0x3efa97(0x1cf)};class CogniLiving extends utils[a0_0x3efa97(0x2c8)]{constructor(_0x136358){const _0x1a6a4d=a0_0x3efa97;super({..._0x136358,'name':_0x1a6a4d(0x30d)}),this[_0x1a6a4d(0x232)]=[],this[_0x1a6a4d(0x1be)]=[],this['feedbackHistory']=[],this[_0x1a6a4d(0x376)]=[],this['dailyDigests']=[],this[_0x1a6a4d(0x33c)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this[_0x1a6a4d(0x2e4)]=!![],this[_0x1a6a4d(0x30f)]=null,this[_0x1a6a4d(0x2b3)]=null,this[_0x1a6a4d(0x2f8)]=![],this[_0x1a6a4d(0x2ae)]=null,this['geminiModel']=null,this[_0x1a6a4d(0x1cd)]=SYSTEM_MODES['NORMAL'],this[_0x1a6a4d(0x2da)]=![],this[_0x1a6a4d(0x365)]=![],this[_0x1a6a4d(0x2c6)]=_0x1a6a4d(0x27b),this[_0x1a6a4d(0x2a3)]=null,this[_0x1a6a4d(0x1c9)]=null,this[_0x1a6a4d(0x2ef)]=null,this[_0x1a6a4d(0x250)]=null,this['briefingJob']=null,this['on'](_0x1a6a4d(0x27a),this['onReady'][_0x1a6a4d(0x328)](this)),this['on']('stateChange',this[_0x1a6a4d(0x247)]['bind'](this)),this['on'](_0x1a6a4d(0x321),this[_0x1a6a4d(0x1e0)][_0x1a6a4d(0x328)](this)),this['on']('message',this[_0x1a6a4d(0x312)]['bind'](this));}async[a0_0x3efa97(0x1fa)](){const _0x3e1568=a0_0x3efa97;this[_0x3e1568(0x2d1)]['info'](_0x3e1568(0x261)+this['version']+')\x20-\x20OBFUSCATION\x20SAFE\x20MODE'),await this['initZombies'](),this[_0x3e1568(0x1e6)][_0x3e1568(0x27f)]=this['config']['licenseKey']||'';try{this[_0x3e1568(0x2da)]=await this[_0x3e1568(0x1a6)](this[_0x3e1568(0x1e6)][_0x3e1568(0x27f)]);}catch(_0x233493){this[_0x3e1568(0x2d1)][_0x3e1568(0x2b2)](_0x3e1568(0x28c)+_0x233493[_0x3e1568(0x34c)]);}if(!this[_0x3e1568(0x1e6)][_0x3e1568(0x257)]||this[_0x3e1568(0x1e6)][_0x3e1568(0x257)]<0.1)this[_0x3e1568(0x1e6)][_0x3e1568(0x257)]=0xc;await this[_0x3e1568(0x19f)](),await this[_0x3e1568(0x379)]();if(this[_0x3e1568(0x1e6)][_0x3e1568(0x2c7)])try{this[_0x3e1568(0x2ae)]=new GoogleGenerativeAI(this[_0x3e1568(0x1e6)][_0x3e1568(0x2c7)]),this[_0x3e1568(0x27d)]=this['genAI']['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x3e1568(0x2d1)][_0x3e1568(0x31f)](_0x3e1568(0x20a));}catch(_0x5ba304){this['log'][_0x3e1568(0x2b2)](_0x3e1568(0x1d2)+_0x5ba304[_0x3e1568(0x34c)]);}await this[_0x3e1568(0x35d)](),await this[_0x3e1568(0x1e8)](),await this[_0x3e1568(0x2ac)](),await this[_0x3e1568(0x286)](),this[_0x3e1568(0x2ba)](_0x3e1568(0x207)),this[_0x3e1568(0x2ba)](LTM_DP_TRIGGER_DIGEST),this[_0x3e1568(0x2ba)](_0x3e1568(0x215)),this['subscribeStates']('analysis.triggerBriefing'),await this[_0x3e1568(0x203)](),await this[_0x3e1568(0x251)]();if(this[_0x3e1568(0x2a3)])clearInterval(this[_0x3e1568(0x2a3)]);const _0x282a8f=this[_0x3e1568(0x1e6)][_0x3e1568(0x21b)]||0xf;_0x282a8f>0x0&&(this[_0x3e1568(0x2d1)][_0x3e1568(0x31f)](_0x3e1568(0x32e)+_0x282a8f+_0x3e1568(0x2e5)+this[_0x3e1568(0x1e6)][_0x3e1568(0x257)]+'h.'),this[_0x3e1568(0x2a3)]=setInterval(()=>{const _0x295d5f=_0x3e1568;this[_0x295d5f(0x338)]();},_0x282a8f*0x3c*0x3e8)),this[_0x3e1568(0x2ff)](),this['setupModeResetScheduler'](),this[_0x3e1568(0x1a4)](),this[_0x3e1568(0x32d)]();}[a0_0x3efa97(0x1e0)](_0x83de4c){const _0x1959d3=a0_0x3efa97;if(this[_0x1959d3(0x2a3)])clearInterval(this[_0x1959d3(0x2a3)]);if(this[_0x1959d3(0x250)])clearInterval(this['driftAnalysisTimer']);if(this[_0x1959d3(0x1c9)])this[_0x1959d3(0x1c9)][_0x1959d3(0x36d)]();if(this['modeResetJob'])this[_0x1959d3(0x2ef)][_0x1959d3(0x36d)]();if(this['briefingJob'])this[_0x1959d3(0x22b)]['cancel']();if(this[_0x1959d3(0x30f)])clearTimeout(this[_0x1959d3(0x30f)]);if(this[_0x1959d3(0x2b3)])clearTimeout(this[_0x1959d3(0x2b3)]);_0x83de4c();}async[a0_0x3efa97(0x247)](_0x2333d9,_0x13f0b1){const _0x5b2d50=a0_0x3efa97;if(!_0x13f0b1)return;if(_0x2333d9===this['namespace']+'.'+SYSTEM_DP_MODE){_0x13f0b1[_0x5b2d50(0x26b)]&&Object['values'](SYSTEM_MODES)[_0x5b2d50(0x31b)](_0x13f0b1[_0x5b2d50(0x26b)])&&(this[_0x5b2d50(0x1cd)]=_0x13f0b1[_0x5b2d50(0x26b)],_0x13f0b1[_0x5b2d50(0x26b)]===SYSTEM_MODES['VACATION']?await this[_0x5b2d50(0x363)](![]):await this[_0x5b2d50(0x363)](!![]));if(!_0x13f0b1[_0x5b2d50(0x201)])this[_0x5b2d50(0x305)](_0x2333d9,{'val':this[_0x5b2d50(0x1cd)],'ack':!![]});return;}if(!_0x13f0b1['ack']){_0x2333d9[_0x5b2d50(0x31b)]('analysis.trigger')&&_0x13f0b1[_0x5b2d50(0x26b)]&&(this[_0x5b2d50(0x305)](_0x2333d9,{'val':![],'ack':!![]}),this[_0x5b2d50(0x22e)]());if(_0x2333d9[_0x5b2d50(0x31b)](_0x5b2d50(0x249))&&_0x13f0b1[_0x5b2d50(0x26b)]){this[_0x5b2d50(0x305)](_0x2333d9,{'val':![],'ack':!![]});if(this[_0x5b2d50(0x2da)])this[_0x5b2d50(0x252)]();}_0x2333d9['includes'](_0x5b2d50(0x1b1))&&_0x13f0b1['val']&&(this[_0x5b2d50(0x305)](_0x2333d9,{'val':![],'ack':!![]}),this[_0x5b2d50(0x333)]());return;}if(this['config'][_0x5b2d50(0x2a6)]&&this[_0x5b2d50(0x1e6)][_0x5b2d50(0x2a6)][_0x5b2d50(0x31b)](_0x2333d9)){await this[_0x5b2d50(0x229)]();return;}const _0x93ef49=(this['config'][_0x5b2d50(0x271)]||[])[_0x5b2d50(0x32f)](_0xbdc425=>_0xbdc425['id']===_0x2333d9);if(_0x93ef49)this[_0x5b2d50(0x233)](_0x2333d9,_0x13f0b1,_0x93ef49);}async[a0_0x3efa97(0x312)](_0x33099b){const _0x43e6dd=a0_0x3efa97;if(typeof _0x33099b===_0x43e6dd(0x1d4)&&_0x33099b[_0x43e6dd(0x34c)])try{if(_0x33099b[_0x43e6dd(0x303)]==='testApiKey'){if(!_0x33099b[_0x43e6dd(0x34c)][_0x43e6dd(0x2e8)])return this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':![],'message':_0x43e6dd(0x1ce)},_0x33099b[_0x43e6dd(0x2a5)]);try{const _0x50fc9e=new GoogleGenerativeAI(_0x33099b[_0x43e6dd(0x34c)][_0x43e6dd(0x2e8)])[_0x43e6dd(0x1e3)]({'model':_0x43e6dd(0x248)});await _0x50fc9e[_0x43e6dd(0x2eb)](_0x43e6dd(0x21c)),this['sendTo'](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':!![],'message':_0x43e6dd(0x2b4)},_0x33099b['callback']);}catch(_0x157095){this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b['command'],{'success':![],'message':_0x157095['message']},_0x33099b[_0x43e6dd(0x2a5)]);}}else{if(_0x33099b[_0x43e6dd(0x303)]===_0x43e6dd(0x2d8)){const _0x2328c7=await this[_0x43e6dd(0x2dd)](_0x43e6dd(0x359),!![]);this[_0x43e6dd(0x29d)](_0x33099b['from'],_0x33099b[_0x43e6dd(0x303)],{'success':_0x2328c7>0x0,'message':_0x2328c7+_0x43e6dd(0x2de)},_0x33099b[_0x43e6dd(0x2a5)]);}else{if(_0x33099b['command']===_0x43e6dd(0x1ea)){if(!this[_0x43e6dd(0x2da)])return this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':![],'isPro':![]},_0x33099b[_0x43e6dd(0x2a5)]);let _0x265378={'status':_0x43e6dd(0x227),'details':'','lastCheck':0x0};try{_0x265378['status']=(await this[_0x43e6dd(0x2c3)](LTM_DP_DRIFT_STATUS))[_0x43e6dd(0x26b)],_0x265378[_0x43e6dd(0x314)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x43e6dd(0x26b)],_0x265378['lastCheck']=(await this[_0x43e6dd(0x2c3)](LTM_DP_DRIFT_LAST_CHECK))[_0x43e6dd(0x26b)];}catch(_0xf75e3b){}this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x43e6dd(0x23e)],'driftAnalysis':_0x265378,'analysisHistory':this[_0x43e6dd(0x1be)]},_0x33099b[_0x43e6dd(0x2a5)]);}else{if(_0x33099b['command']==='getEnums'){const _0x1eb06b=await this[_0x43e6dd(0x264)](_0x43e6dd(0x1f1),_0x43e6dd(0x2c9)),_0x49a8db=[];if(_0x1eb06b)for(const _0x2ade42 in _0x1eb06b){const _0x3fa5a8=_0x1eb06b[_0x2ade42],_0x32b110=(_0x3fa5a8[_0x43e6dd(0x373)]&&typeof _0x3fa5a8[_0x43e6dd(0x373)][_0x43e6dd(0x23a)]==='object'?_0x3fa5a8[_0x43e6dd(0x373)][_0x43e6dd(0x23a)]['de']:_0x3fa5a8[_0x43e6dd(0x373)][_0x43e6dd(0x23a)])||_0x3fa5a8[_0x43e6dd(0x373)]['name'];_0x49a8db['push']({'id':_0x2ade42,'name':_0x32b110});}this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':!![],'enums':_0x49a8db},_0x33099b[_0x43e6dd(0x2a5)]);}else{if(_0x33099b[_0x43e6dd(0x303)]===_0x43e6dd(0x350))try{const _0x30ed0b=await this[_0x43e6dd(0x308)](_0x33099b['message']||{});this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':!![],'devices':_0x30ed0b},_0x33099b[_0x43e6dd(0x2a5)]);}catch(_0x387333){this['sendTo'](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':![],'error':_0x387333['message']},_0x33099b[_0x43e6dd(0x2a5)]);}else{if(_0x33099b[_0x43e6dd(0x303)]===_0x43e6dd(0x2ca)){const {historyId:_0x4ff61d,rating:_0x914b61,comment:_0x3ef532,alertReason:_0x31c9ca}=_0x33099b[_0x43e6dd(0x34c)];_0x4ff61d&&_0x914b61?(await this[_0x43e6dd(0x35c)]({'timestamp':Date['now'](),'historyId':_0x4ff61d,'rating':_0x914b61,'comment':_0x3ef532,'alertReason':_0x31c9ca}),this[_0x43e6dd(0x29d)](_0x33099b['from'],_0x33099b[_0x43e6dd(0x303)],{'success':!![]},_0x33099b[_0x43e6dd(0x2a5)])):this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':![],'error':_0x43e6dd(0x209)},_0x33099b[_0x43e6dd(0x2a5)]);}else{if(_0x33099b[_0x43e6dd(0x303)]===_0x43e6dd(0x31a)){const _0x3aa8b4=await this[_0x43e6dd(0x1a8)](),_0x282afd=await this['getCalendarContext']();this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':!![],'weather':_0x3aa8b4,'calendar':_0x282afd},_0x33099b[_0x43e6dd(0x2a5)]);}else{if(_0x33099b['command']==='getCalendarNames'){const _0x964e60=_0x33099b[_0x43e6dd(0x34c)][_0x43e6dd(0x1da)];if(!_0x964e60)return this[_0x43e6dd(0x29d)](_0x33099b[_0x43e6dd(0x21d)],_0x33099b[_0x43e6dd(0x303)],{'success':![],'error':_0x43e6dd(0x1bb)},_0x33099b[_0x43e6dd(0x2a5)]);const _0x36f634=await this['getCalendarNames'](_0x964e60);this[_0x43e6dd(0x29d)](_0x33099b['from'],_0x33099b[_0x43e6dd(0x303)],{'success':!![],'names':_0x36f634},_0x33099b[_0x43e6dd(0x2a5)]);}}}}}}}}}catch(_0x2af714){this[_0x43e6dd(0x2d1)][_0x43e6dd(0x2b2)]('Error\x20in\x20onMessage\x20command\x20'+_0x33099b[_0x43e6dd(0x303)]+':\x20'+_0x2af714[_0x43e6dd(0x34c)]);if(_0x33099b['callback'])this[_0x43e6dd(0x29d)](_0x33099b['from'],_0x33099b[_0x43e6dd(0x303)],{'success':![],'error':_0x2af714['message']},_0x33099b[_0x43e6dd(0x2a5)]);}}async[a0_0x3efa97(0x233)](_0x140845,_0x374d27,_0x301ad9){const _0x32fc1c=a0_0x3efa97;if(!_0x301ad9[_0x32fc1c(0x2a4)]&&this[_0x32fc1c(0x33c)][_0x140845]===_0x374d27[_0x32fc1c(0x26b)])return;this[_0x32fc1c(0x33c)][_0x140845]=_0x374d27['val'];if(this['isGracePeriodActive'])return;const _0x153bd8=await this[_0x32fc1c(0x229)]();if(_0x153bd8){if(!this[_0x32fc1c(0x2e4)])await this[_0x32fc1c(0x363)](!![]);}else{const _0x6c96d8=_0x301ad9[_0x32fc1c(0x208)]===!![];_0x6c96d8?this[_0x32fc1c(0x263)]():(this[_0x32fc1c(0x30f)]&&(this['log'][_0x32fc1c(0x31f)](_0x32fc1c(0x272)),this['abortExitTimer']()),!this['isPresent']&&this[_0x32fc1c(0x1cd)]===SYSTEM_MODES[_0x32fc1c(0x2e1)]&&await this['setPresence'](!![]));}const _0x11a27f={'timestamp':_0x374d27['ts'],'id':_0x140845,'name':_0x301ad9[_0x32fc1c(0x23a)],'value':_0x374d27[_0x32fc1c(0x26b)],'location':_0x301ad9[_0x32fc1c(0x300)],'type':_0x301ad9['type']};this[_0x32fc1c(0x232)][_0x32fc1c(0x2e6)](_0x11a27f);if(this['eventHistory'][_0x32fc1c(0x1d7)]>HISTORY_MAX_SIZE)this['eventHistory'][_0x32fc1c(0x225)]();await this[_0x32fc1c(0x1a3)]('events.lastEvent',{'val':JSON['stringify'](_0x11a27f),'ack':!![]}),await this['setStateAsync'](_0x32fc1c(0x240),{'val':JSON[_0x32fc1c(0x244)](this[_0x32fc1c(0x232)]),'ack':!![]}),this[_0x32fc1c(0x376)][_0x32fc1c(0x332)]({'timestamp':new Date(_0x374d27['ts'])['toISOString'](),'sensorName':_0x301ad9[_0x32fc1c(0x23a)],'location':_0x301ad9[_0x32fc1c(0x300)],'value':_0x374d27['val']}),await this[_0x32fc1c(0x2fe)]();}async['runAutopilot'](){const _0x4d2a55=a0_0x3efa97,_0x1ff027=this['config']['inactivityThresholdHours'],_0x42d808=this[_0x4d2a55(0x1e6)][_0x4d2a55(0x204)],_0x3e1d56=this['eventHistory'][_0x4d2a55(0x1d7)]>0x0?this['eventHistory'][0x0]['timestamp']:Date[_0x4d2a55(0x236)](),_0x4a3c86=(Date[_0x4d2a55(0x236)]()-_0x3e1d56)/(0x3e8*0x3c*0x3c);let _0x1496c5='';_0x42d808&&this['currentSystemMode']===SYSTEM_MODES[_0x4d2a55(0x2e1)]&&this[_0x4d2a55(0x2e4)]&&(_0x4a3c86>_0x1ff027&&(_0x1496c5=_0x4d2a55(0x385)+_0x4a3c86[_0x4d2a55(0x23b)](0x1)+_0x4d2a55(0x2bc)));if(_0x1496c5){this[_0x4d2a55(0x22e)](_0x1496c5)[_0x4d2a55(0x2b8)](_0x41c1df=>this[_0x4d2a55(0x2d1)][_0x4d2a55(0x2b2)](_0x41c1df));return;}const _0xe79cab=Date['now'](),_0xac44c9=_0xe79cab-_0x3e1d56,_0x2a3cc4=(this[_0x4d2a55(0x1e6)][_0x4d2a55(0x21b)]||0xf)*0x3c*0x3e8;this[_0x4d2a55(0x232)][_0x4d2a55(0x1d7)]>0x0&&_0xac44c9<=_0x2a3cc4?this[_0x4d2a55(0x22e)]()['catch'](_0x3de2ab=>this['log'][_0x4d2a55(0x2b2)](_0x3de2ab)):!this[_0x4d2a55(0x365)]&&(this[_0x4d2a55(0x305)](_0x4d2a55(0x235),{'val':![],'ack':!![]}),this[_0x4d2a55(0x305)](_0x4d2a55(0x1ae),{'val':![],'ack':!![]}));}async['runGeminiAnalysis'](_0x380983=''){const _0x149d4e=a0_0x3efa97;if(!this[_0x149d4e(0x27d)])return;const _0x24e5a0=this[_0x149d4e(0x232)][_0x149d4e(0x1d7)]>0x0?this[_0x149d4e(0x232)]:[{'note':_0x149d4e(0x22c)}],_0x7754f=PERSONA_MAPPING[this[_0x149d4e(0x1e6)]['aiPersona']||_0x149d4e(0x375)],_0xc0c895=this[_0x149d4e(0x1e6)][_0x149d4e(0x337)]||'',_0x4084d8=this[_0x149d4e(0x1cd)],_0x4c48dd=await this[_0x149d4e(0x1a8)](),_0x5a279b=await this['getCalendarContext'](),_0x1033c4=(_0x4c48dd+'\x20'+_0x5a279b)[_0x149d4e(0x273)](),_0x33af75=new Date(),_0x3bdeb9=_0x33af75[_0x149d4e(0x2bb)](_0x149d4e(0x2cf),{'weekday':_0x149d4e(0x266),'hour':'2-digit','minute':_0x149d4e(0x1c7)}),_0x403f85=this[_0x149d4e(0x223)];let _0x5d0e95='';if(this[_0x149d4e(0x2f5)][_0x149d4e(0x1d7)]>0x0){const _0x2539ed=this['feedbackHistory'][_0x149d4e(0x29a)](0x0,0x3)['map'](_0x1422aa=>_0x149d4e(0x265)+_0x1422aa[_0x149d4e(0x362)]+'\x22\x20was\x20'+_0x1422aa[_0x149d4e(0x2e0)]+'.')[_0x149d4e(0x29b)]('\x0a');_0x5d0e95=_0x149d4e(0x322)+_0x2539ed+'\x0a';}const _0x3c7d27=_0x380983?_0x149d4e(0x1b8)+_0x380983+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x586990=_0x149d4e(0x267),_0xf9cdf6=_0x149d4e(0x1ff)+_0x3bdeb9+'.\x20ORT:\x20'+_0x403f85['city']+_0x149d4e(0x1db)+_0x4084d8+_0x149d4e(0x285)+(this[_0x149d4e(0x2e4)]?'Ja':'Nein')+_0x149d4e(0x26e)+_0xc0c895+_0x149d4e(0x34e)+_0x7754f+_0x149d4e(0x1b9)+_0x1033c4+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x586990+'\x20'+_0x5d0e95+'\x20'+_0x3c7d27+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20'+JSON[_0x149d4e(0x244)](_0x24e5a0)+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}';try{const _0x17d587=await this['geminiModel'][_0x149d4e(0x2eb)](_0xf9cdf6),_0x526fc2=_0x17d587['response']['text']()[_0x149d4e(0x35b)](/```json|```/g,'')[_0x149d4e(0x273)](),_0x26ec66=JSON[_0x149d4e(0x2cb)](_0x526fc2);await this[_0x149d4e(0x1a3)]('analysis.lastResult',{'val':_0x526fc2,'ack':!![]}),await this[_0x149d4e(0x1a3)](_0x149d4e(0x1ba),{'val':_0x26ec66[_0x149d4e(0x224)][_0x149d4e(0x362)]||'','ack':!![]}),await this[_0x149d4e(0x1a3)](_0x149d4e(0x1b0),{'val':_0x26ec66[_0x149d4e(0x224)]['summary']||'N/A','ack':!![]}),await this['setStateAsync'](_0x149d4e(0x220),{'val':_0x26ec66[_0x149d4e(0x224)][_0x149d4e(0x377)]||_0x149d4e(0x227),'ack':!![]});_0x26ec66['comfort']&&(await this[_0x149d4e(0x1a3)](_0x149d4e(0x360),{'val':_0x26ec66[_0x149d4e(0x222)][_0x149d4e(0x2d3)]||'','ack':!![]}),await this[_0x149d4e(0x1a3)](_0x149d4e(0x327),{'val':_0x26ec66[_0x149d4e(0x222)][_0x149d4e(0x1f7)]||'','ack':!![]}),_0x26ec66['comfort']['automationProposal']&&(await this[_0x149d4e(0x1a3)](_0x149d4e(0x32a),{'val':_0x26ec66[_0x149d4e(0x222)][_0x149d4e(0x32b)]['patternDetected']||![],'ack':!![]}),await this[_0x149d4e(0x1a3)]('analysis.automation.description',{'val':_0x26ec66['comfort'][_0x149d4e(0x32b)][_0x149d4e(0x299)]||'','ack':!![]}),await this[_0x149d4e(0x1a3)](_0x149d4e(0x230),{'val':_0x26ec66[_0x149d4e(0x222)]['automationProposal'][_0x149d4e(0x1f8)]||'','ack':!![]})));_0x26ec66[_0x149d4e(0x2ab)]&&(await this[_0x149d4e(0x1a3)](_0x149d4e(0x325),{'val':typeof _0x26ec66[_0x149d4e(0x2ab)][_0x149d4e(0x20e)]===_0x149d4e(0x1ed)?_0x26ec66['health'][_0x149d4e(0x20e)]:0x0,'ack':!![]}),await this[_0x149d4e(0x1a3)](_0x149d4e(0x352),{'val':_0x26ec66[_0x149d4e(0x2ab)][_0x149d4e(0x1e4)]||_0x149d4e(0x374),'ack':!![]}),await this['setStateAsync']('analysis.health.notes',{'val':_0x26ec66[_0x149d4e(0x2ab)][_0x149d4e(0x2a1)]||'','ack':!![]}));const _0x301c5f=_0x26ec66[_0x149d4e(0x224)][_0x149d4e(0x1d3)]||![],_0x49ff18=_0x26ec66[_0x149d4e(0x224)][_0x149d4e(0x1e5)]||![];if(_0x301c5f||_0x49ff18){await this['setStateAsync']('analysis.isAlert',{'val':!![],'ack':!![]}),await this[_0x149d4e(0x1a3)]('analysis.isEmergency',{'val':_0x49ff18,'ack':!![]});if(!this['lastAlertState']||_0x49ff18){const _0x4e5c3a=_0x49ff18?_0x149d4e(0x358):'‚ö†Ô∏è\x20Alarm';this[_0x149d4e(0x2dd)](_0x4e5c3a+':\x20'+_0x26ec66[_0x149d4e(0x224)][_0x149d4e(0x362)],![],_0x49ff18);}}else await this[_0x149d4e(0x1a3)](_0x149d4e(0x235),{'val':![],'ack':!![]}),await this[_0x149d4e(0x1a3)](_0x149d4e(0x1ae),{'val':![],'ack':!![]});this[_0x149d4e(0x365)]=_0x301c5f||_0x49ff18;const _0xa6ee73={'timestamp':Date[_0x149d4e(0x236)](),'id':Date[_0x149d4e(0x236)]()['toString'](),'analysis':_0x26ec66,'systemMode':_0x4084d8,'isPro':this[_0x149d4e(0x2da)]};this[_0x149d4e(0x1e2)](_0xa6ee73);}catch(_0x30e009){this[_0x149d4e(0x2d1)][_0x149d4e(0x2b2)]('Analysis\x20Error:\x20'+_0x30e009[_0x149d4e(0x34c)]);}}async[a0_0x3efa97(0x252)](){const _0xdeb150=a0_0x3efa97;if(!this[_0xdeb150(0x27d)]||this[_0xdeb150(0x376)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0xdeb150(0x1a3)](LTM_DP_STATUS,{'val':_0xdeb150(0x382),'ack':!![]});return;}this['log']['info'](_0xdeb150(0x256)+this[_0xdeb150(0x376)][_0xdeb150(0x1d7)]+_0xdeb150(0x1bd)),await this[_0xdeb150(0x1a3)](LTM_DP_STATUS,{'val':_0xdeb150(0x354),'ack':!![]});const _0x376f84=this[_0xdeb150(0x376)][_0xdeb150(0x1d7)]>0x320?this[_0xdeb150(0x376)][_0xdeb150(0x29a)](this['rawEventLog']['length']-0x320):this[_0xdeb150(0x376)],_0x2be4d1=PERSONA_MAPPING[this[_0xdeb150(0x1e6)][_0xdeb150(0x221)]||_0xdeb150(0x375)],_0x36be00=_0xdeb150(0x1b7)+_0x2be4d1+_0xdeb150(0x2f4)+JSON['stringify'](_0x376f84)+_0xdeb150(0x260);try{const _0x48518d=await this[_0xdeb150(0x27d)][_0xdeb150(0x2eb)](_0x36be00),_0x2633ec=_0x48518d[_0xdeb150(0x370)][_0xdeb150(0x25a)]()[_0xdeb150(0x35b)](/```json|```/g,'')[_0xdeb150(0x273)](),_0x41e53d=JSON[_0xdeb150(0x2cb)](_0x2633ec),_0x2bde6e={'timestamp':new Date()[_0xdeb150(0x231)](),'eventCount':this[_0xdeb150(0x376)][_0xdeb150(0x1d7)],'summary':_0x41e53d[_0xdeb150(0x2d3)],'activityLevel':_0x41e53d[_0xdeb150(0x329)],'health':{'sleepScore':_0x41e53d[_0xdeb150(0x2ab)]?_0x41e53d[_0xdeb150(0x2ab)][_0xdeb150(0x20e)]:0x0,'restlessness':_0x41e53d['health']?_0x41e53d[_0xdeb150(0x2ab)][_0xdeb150(0x1e4)]:_0xdeb150(0x374)},'systemMode':this['currentSystemMode']};this[_0xdeb150(0x23e)][_0xdeb150(0x332)](_0x2bde6e),await this[_0xdeb150(0x2fd)](),this[_0xdeb150(0x376)]=[],await this[_0xdeb150(0x2fe)](),await this[_0xdeb150(0x1a3)](LTM_DP_STATUS,{'val':_0xdeb150(0x281),'ack':!![]}),this[_0xdeb150(0x2d1)]['info'](_0xdeb150(0x380));}catch(_0x28dead){this['log'][_0xdeb150(0x2b2)](_0xdeb150(0x2df)+_0x28dead[_0xdeb150(0x34c)]),await this[_0xdeb150(0x1a3)](LTM_DP_STATUS,{'val':_0xdeb150(0x25d)+_0x28dead['message'],'ack':!![]});}}async[a0_0x3efa97(0x333)](){const _0x483399=a0_0x3efa97;if(!this['geminiModel'])return;this[_0x483399(0x2d1)][_0x483399(0x31f)](_0x483399(0x369));const _0x43b8c5=this[_0x483399(0x23e)][_0x483399(0x1d7)]>0x0?this[_0x483399(0x23e)][this[_0x483399(0x23e)][_0x483399(0x1d7)]-0x1]:null,_0x4b8ebf=_0x43b8c5&&_0x43b8c5[_0x483399(0x2ab)]?_0x43b8c5[_0x483399(0x2ab)][_0x483399(0x20e)]:_0x483399(0x227),_0x9daa10=new Date();_0x9daa10[_0x483399(0x31d)](0x4,0x0,0x0,0x0);const _0x1fe188=this[_0x483399(0x232)][_0x483399(0x268)](_0x26ee2b=>new Date(_0x26ee2b[_0x483399(0x21a)])>_0x9daa10),_0x46c9fe=PERSONA_MAPPING[this['config'][_0x483399(0x221)]||_0x483399(0x375)],_0x217c95=this['config'][_0x483399(0x337)]||'',_0xe7b6f0=await this['getWeatherContext'](),_0x355f9a=await this[_0x483399(0x2ec)](),_0x3499cd=_0x483399(0x2d2)+_0x46c9fe+_0x483399(0x262)+_0x217c95+_0x483399(0x361)+_0xe7b6f0+'\x20'+_0x355f9a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20'+_0x4b8ebf+_0x483399(0x2aa)+JSON[_0x483399(0x244)](_0x1fe188[_0x483399(0x29a)](0x0,0xa))+_0x483399(0x2fb);try{const _0x436908=await this[_0x483399(0x27d)][_0x483399(0x2eb)](_0x3499cd),_0x186524='üåÖ\x20Daily\x20Briefing:\x0a'+_0x436908['response'][_0x483399(0x25a)]()['trim']();this[_0x483399(0x2dd)](_0x186524),this[_0x483399(0x2d1)][_0x483399(0x31f)](_0x483399(0x27c));}catch(_0x40b33c){this[_0x483399(0x2d1)]['error'](_0x483399(0x28a)+_0x40b33c['message']);}}async[a0_0x3efa97(0x308)](_0x6e6602){const _0x39ab63=a0_0x3efa97;this['log'][_0x39ab63(0x31f)](_0x39ab63(0x20c));const _0x21e0fb=[],_0xa9f86e=await this[_0x39ab63(0x264)]('*'),_0x3807eb=await this[_0x39ab63(0x264)](_0x39ab63(0x2f1),_0x39ab63(0x2c9)),_0x5d8829={};if(_0x3807eb)for(const _0x3f0901 in _0x3807eb){const _0x59d9fe=_0x3807eb[_0x3f0901][_0x39ab63(0x373)]['members'];if(_0x59d9fe&&Array[_0x39ab63(0x1bf)](_0x59d9fe)){const _0x34ea71=typeof _0x3807eb[_0x3f0901][_0x39ab63(0x373)][_0x39ab63(0x23a)]===_0x39ab63(0x1d4)?_0x3807eb[_0x3f0901][_0x39ab63(0x373)][_0x39ab63(0x23a)]['de']:_0x3807eb[_0x3f0901]['common']['name'];for(const _0x43eeb6 of _0x59d9fe){_0x5d8829[_0x43eeb6]=_0x34ea71;}}}const _0x2f7ad7=await this[_0x39ab63(0x264)](_0x39ab63(0x1f1),_0x39ab63(0x2c9)),_0x214035={};if(_0x2f7ad7)for(const _0x54dc9e in _0x2f7ad7){const _0x2caaa3=_0x2f7ad7[_0x54dc9e]['common']['members'],_0x17cc62=_0x54dc9e[_0x39ab63(0x1e7)]('.')[_0x39ab63(0x225)]()[_0x39ab63(0x35f)]();if(_0x2caaa3&&Array[_0x39ab63(0x1bf)](_0x2caaa3))for(const _0x36cedd of _0x2caaa3){if(!_0x214035[_0x36cedd])_0x214035[_0x36cedd]=[];_0x214035[_0x36cedd]['push'](_0x17cc62);}}const _0x32a638=_0x6e6602[_0x39ab63(0x290)]||[],_0x1a754a=_0x6e6602[_0x39ab63(0x24b)]!==![],_0x300be5=_0x6e6602['doors']!==![],_0x4641e3=_0x6e6602[_0x39ab63(0x206)]!==![],_0x3e3029=_0x6e6602[_0x39ab63(0x259)]===!![],_0x457bc1=_0x6e6602[_0x39ab63(0x28f)]===!![];for(const _0x4e381a in _0xa9f86e){const _0x575fa1=_0xa9f86e[_0x4e381a];if(_0x575fa1[_0x39ab63(0x2a9)]!==_0x39ab63(0x339))continue;if(!_0x575fa1[_0x39ab63(0x373)])continue;if(ADAPTER_BLACKLIST[_0x39ab63(0x2ea)](_0x7b646=>_0x4e381a[_0x39ab63(0x1f9)](_0x7b646))){if(!_0x457bc1)continue;}const _0x41f16e=(_0x575fa1[_0x39ab63(0x373)]['role']||'')[_0x39ab63(0x35f)]();let _0x526559=(typeof _0x575fa1[_0x39ab63(0x373)][_0x39ab63(0x23a)]==='object'?_0x575fa1[_0x39ab63(0x373)][_0x39ab63(0x23a)]['de']:_0x575fa1['common'][_0x39ab63(0x23a)])||_0x4e381a;const _0x17c4fc=_0x4e381a['split']('.');let _0xe1bd0d=null;if(_0x17c4fc[_0x39ab63(0x1d7)]>0x2){_0xe1bd0d=_0x17c4fc[_0x39ab63(0x29a)](0x0,-0x1)[_0x39ab63(0x29b)]('.');const _0x4230c1=_0xa9f86e[_0xe1bd0d],_0x29bf43=_0x17c4fc[_0x39ab63(0x29a)](0x0,-0x2)[_0x39ab63(0x29b)]('.'),_0x201708=_0xa9f86e[_0x29bf43];let _0x3be66e='';if(_0x201708&&_0x201708[_0x39ab63(0x373)]&&_0x201708[_0x39ab63(0x373)][_0x39ab63(0x23a)]){const _0x276b54=typeof _0x201708[_0x39ab63(0x373)][_0x39ab63(0x23a)]===_0x39ab63(0x1d4)?_0x201708[_0x39ab63(0x373)]['name']['de']:_0x201708[_0x39ab63(0x373)]['name'];_0x276b54&&typeof _0x276b54===_0x39ab63(0x336)&&_0x276b54[_0x39ab63(0x273)]()['length']>0x0&&(_0x3be66e=_0x276b54);}if(!_0x3be66e&&_0x4230c1&&_0x4230c1[_0x39ab63(0x373)]&&_0x4230c1[_0x39ab63(0x373)][_0x39ab63(0x23a)]){const _0x317c8c=typeof _0x4230c1['common'][_0x39ab63(0x23a)]===_0x39ab63(0x1d4)?_0x4230c1[_0x39ab63(0x373)][_0x39ab63(0x23a)]['de']:_0x4230c1[_0x39ab63(0x373)][_0x39ab63(0x23a)];_0x317c8c&&typeof _0x317c8c==='string'&&(_0x3be66e=_0x317c8c);}_0x3be66e&&(!_0x526559[_0x39ab63(0x35f)]()[_0x39ab63(0x31b)](_0x3be66e['toLowerCase']())&&(_0x526559=_0x3be66e+'\x20'+_0x526559));}const _0x52fd57=_0x526559['toLowerCase'](),_0x2dd9c8=_0x214035[_0x4e381a]||[];let _0x589fab=![],_0x4b3b3d=![];if(_0x32a638[_0x39ab63(0x1d7)]>0x0)for(const _0x569cbd of _0x32a638){if(_0x2f7ad7[_0x569cbd]&&_0x2f7ad7[_0x569cbd][_0x39ab63(0x373)][_0x39ab63(0x318)]){const _0x3a9860=_0x2f7ad7[_0x569cbd][_0x39ab63(0x373)][_0x39ab63(0x318)];if(_0x3a9860['includes'](_0x4e381a)||_0x3a9860[_0x39ab63(0x2ea)](_0x759aa8=>_0x4e381a[_0x39ab63(0x1f9)](_0x759aa8+'.'))){_0x589fab=!![],_0x4b3b3d=!![];break;}}}if(!_0x589fab&&!_0x457bc1){if(IGNORE_TERMS[_0x39ab63(0x2ea)](_0x2eae4d=>_0x4e381a['toUpperCase']()['includes'](_0x2eae4d)||_0x52fd57['includes'](_0x2eae4d['toLowerCase']()))){if(!_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x24b))&&!_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x275))&&!_0x41f16e[_0x39ab63(0x31b)]('switch'))continue;}}let _0x2a208c='';if(_0x1a754a){if(_0x41f16e['includes'](_0x39ab63(0x24b))||_0x41f16e==='sensor.alarm'||_0x2dd9c8[_0x39ab63(0x2ea)](_0xdde4cc=>_0xdde4cc['includes'](_0x39ab63(0x24b))||_0xdde4cc[_0x39ab63(0x31b)](_0x39ab63(0x219))))_0x2a208c=_0x39ab63(0x24b);else{if(_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x320))||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x24b))||_0x52fd57['includes']('presence'))_0x2a208c=_0x39ab63(0x24b);}}if(!_0x2a208c&&_0x300be5){if(_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x275))||_0x41f16e['includes'](_0x39ab63(0x269))||_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x1f3))||_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x302))||_0x2dd9c8[_0x39ab63(0x2ea)](_0x20faee=>_0x20faee[_0x39ab63(0x31b)](_0x39ab63(0x269))||_0x20faee[_0x39ab63(0x31b)](_0x39ab63(0x275))||_0x20faee[_0x39ab63(0x31b)](_0x39ab63(0x1f3))))_0x2a208c=_0x39ab63(0x275);else{if(_0x52fd57[_0x39ab63(0x31b)]('fenster')||_0x52fd57[_0x39ab63(0x31b)]('t√ºr')||_0x52fd57['includes'](_0x39ab63(0x275))||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x269))||_0x52fd57['includes'](_0x39ab63(0x372))||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x28e))||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x1bc))||_0x52fd57['includes'](_0x39ab63(0x302)))_0x2a208c=_0x39ab63(0x275);}}if(!_0x2a208c&&_0x4641e3){if(_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x36e))||_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x2d4))||_0x41f16e['includes'](_0x39ab63(0x37b))||_0x2dd9c8[_0x39ab63(0x2ea)](_0x46aa6c=>_0x46aa6c[_0x39ab63(0x31b)](_0x39ab63(0x36e)))){if(_0x575fa1[_0x39ab63(0x373)][_0x39ab63(0x1af)]||_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x1b6)))_0x2a208c='light';}else{if(_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x355))||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x36e))||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x37f))||_0x52fd57['includes'](_0x39ab63(0x21f))||_0x52fd57['includes'](_0x39ab63(0x2bf))){if(_0x575fa1['common'][_0x39ab63(0x1af)])_0x2a208c='light';}}}if(!_0x2a208c&&_0x3e3029){if(_0x41f16e['includes'](_0x39ab63(0x259))||_0x41f16e['includes'](_0x39ab63(0x36a))||_0x41f16e[_0x39ab63(0x31b)](_0x39ab63(0x1d8)))_0x2a208c=_0x39ab63(0x259);else{if(_0x52fd57[_0x39ab63(0x31b)]('temp')||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x1c8))||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x1d8)))_0x2a208c=_0x39ab63(0x259);}}!_0x2a208c&&_0x4b3b3d&&(_0x2a208c='custom');if(_0x2a208c){let _0x3e5c45=_0x5d8829[_0x4e381a]||'';!_0x3e5c45&&_0xe1bd0d&&(_0x3e5c45=_0x5d8829[_0xe1bd0d]||'');if(!_0x3e5c45){if(_0x52fd57['includes'](_0x39ab63(0x1cb)))_0x3e5c45='Badezimmer';else{if(_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x324)))_0x3e5c45=_0x39ab63(0x384);else{if(_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x30a)))_0x3e5c45=_0x39ab63(0x330);else{if(_0x52fd57['includes'](_0x39ab63(0x2c5)))_0x3e5c45=_0x39ab63(0x210);else{if(_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x34a))||_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x344)))_0x3e5c45=_0x39ab63(0x277);else{if(_0x52fd57['includes'](_0x39ab63(0x2f2)))_0x3e5c45='Garten';else{if(_0x52fd57[_0x39ab63(0x31b)](_0x39ab63(0x37e)))_0x3e5c45='B√ºro';}}}}}}}_0x21e0fb[_0x39ab63(0x332)]({'id':_0x4e381a,'name':_0x526559,'location':_0x3e5c45,'type':_0x2a208c,'logDuplicates':_0x2a208c===_0x39ab63(0x24b),'isExit':![],'_score':_0x3e5c45?0x50:_0x2a208c===_0x39ab63(0x2c2)?0x5a:0x28});}}return _0x21e0fb[_0x39ab63(0x238)]((_0x100e99,_0x29724a)=>_0x29724a['_score']-_0x100e99[_0x39ab63(0x243)]),_0x21e0fb;}['tryParse'](_0x4dccc6){const _0x36e7e2=a0_0x3efa97;if(typeof _0x4dccc6===_0x36e7e2(0x1d4))return _0x4dccc6;try{return JSON[_0x36e7e2(0x2cb)](_0x4dccc6);}catch(_0x59f3f6){return null;}}async[a0_0x3efa97(0x205)](){const _0x297363=a0_0x3efa97;try{const _0x500f85=[_0x297363(0x357),_0x297363(0x2f3),_0x297363(0x1a2),_0x297363(0x1e9),_0x297363(0x2ee),_0x297363(0x2d9),_0x297363(0x335),'events.history_debug_02',_0x297363(0x2b1),_0x297363(0x34f)];for(const _0x4c0477 of _0x500f85){try{const _0x3ad6d6=await this[_0x297363(0x310)](_0x4c0477);_0x3ad6d6&&await this[_0x297363(0x2bd)](_0x4c0477);}catch(_0x5ee9ad){}}}catch(_0xefe8b3){}}async['initHistory'](){const _0x4ed903=a0_0x3efa97;try{const _0x53748f=await this['getStateAsync'](_0x4ed903(0x240));_0x53748f&&_0x53748f[_0x4ed903(0x26b)]&&(this['eventHistory']=JSON[_0x4ed903(0x2cb)](_0x53748f[_0x4ed903(0x26b)][_0x4ed903(0x37a)]()));}catch(_0x86b0c){this[_0x4ed903(0x232)]=[];}try{const _0x363807=await this[_0x4ed903(0x2c3)](_0x4ed903(0x2a8));if(_0x363807&&_0x363807[_0x4ed903(0x26b)])this[_0x4ed903(0x1be)]=JSON['parse'](_0x363807[_0x4ed903(0x26b)][_0x4ed903(0x37a)]());}catch(_0x29bb27){this[_0x4ed903(0x1be)]=[];}}async[a0_0x3efa97(0x379)](){const _0xc961df=a0_0x3efa97;try{const _0x22a2f4=await this[_0xc961df(0x307)](_0xc961df(0x2e7));_0x22a2f4&&_0x22a2f4[_0xc961df(0x373)]&&(this[_0xc961df(0x223)]={'latitude':_0x22a2f4[_0xc961df(0x373)][_0xc961df(0x1d9)]||0x0,'longitude':_0x22a2f4[_0xc961df(0x373)][_0xc961df(0x274)]||0x0,'city':_0x22a2f4[_0xc961df(0x373)][_0xc961df(0x2fa)]||''});}catch(_0x5929b0){}}async[a0_0x3efa97(0x1a6)](_0x3dea40){const _0x859efa=a0_0x3efa97;if(!_0x3dea40)return![];this[_0x859efa(0x2c6)]=await this[_0x859efa(0x276)]();if(_0x3dea40===_0x859efa(0x33f)||_0x3dea40[_0x859efa(0x1f9)](_0x859efa(0x22d)))return!![];return![];}async[a0_0x3efa97(0x276)](){const _0xe89e22=a0_0x3efa97;try{const _0x28f4fd=await this[_0xe89e22(0x307)](_0xe89e22(0x368));if(_0x28f4fd&&_0x28f4fd['native']&&_0x28f4fd['native'][_0xe89e22(0x2e3)])return _0x28f4fd['native']['uuid'];return _0xe89e22(0x2b7);}catch(_0x26113d){return _0xe89e22(0x34d);}}async['createAllObjects'](){const _0x9a4e80=a0_0x3efa97;try{await this[_0x9a4e80(0x2d5)](),await this['setObjectNotExistsAsync']('system.isPresent',{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x326),'type':_0x9a4e80(0x1eb),'role':_0x9a4e80(0x2f9),'read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x294),{'type':'state','common':{'name':'Last\x20raw\x20event','type':_0x9a4e80(0x336),'role':_0x9a4e80(0x315),'read':!![],'write':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x240),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x1f4),'type':_0x9a4e80(0x336),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x207),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x2d0),'type':'boolean','role':_0x9a4e80(0x26c),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x1de),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x20b),'type':_0x9a4e80(0x1eb),'role':_0x9a4e80(0x26c),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x1c5),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x2d6),'type':'string','role':_0x9a4e80(0x315),'read':!![],'write':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x235),{'type':'state','common':{'name':'AI\x20Alert\x20Status','type':'boolean','role':_0x9a4e80(0x371),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x1ae),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x2af),'type':_0x9a4e80(0x1eb),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x1ba),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x346),'type':_0x9a4e80(0x336),'role':_0x9a4e80(0x1f0),'read':!![],'write':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x1b0),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x23c),'type':_0x9a4e80(0x336),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x220),{'type':_0x9a4e80(0x339),'common':{'name':'Deviation','type':_0x9a4e80(0x336),'role':_0x9a4e80(0x339),'read':!![],'write':![],'def':_0x9a4e80(0x227)},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x360),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x309),'type':_0x9a4e80(0x336),'role':_0x9a4e80(0x25a),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x9a4e80(0x327),{'type':'state','common':{'name':'Comfort\x20Suggestion','type':'string','role':_0x9a4e80(0x25a),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](_0x9a4e80(0x366),{'type':_0x9a4e80(0x26d),'common':{'name':'Automation\x20Proposals'},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x32a),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x347),'type':_0x9a4e80(0x1eb),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x282),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x1b4),'type':_0x9a4e80(0x336),'role':_0x9a4e80(0x25a),'read':!![],'write':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x230),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x32c),'type':_0x9a4e80(0x336),'role':_0x9a4e80(0x25a),'read':!![],'write':![]},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x2a8),{'type':'state','common':{'name':_0x9a4e80(0x2d7),'type':_0x9a4e80(0x336),'role':_0x9a4e80(0x315),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x24f),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x353),'type':_0x9a4e80(0x336),'role':_0x9a4e80(0x315),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x9a4e80(0x245)](_0x9a4e80(0x340),{'type':_0x9a4e80(0x26d),'common':{'name':_0x9a4e80(0x342)},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x325),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x246),'type':'number','role':_0x9a4e80(0x284),'read':!![],'write':![],'def':0x0},'native':{}}),await this[_0x9a4e80(0x278)]('analysis.health.restlessness',{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x34b),'type':_0x9a4e80(0x336),'role':_0x9a4e80(0x25a),'read':!![],'write':![],'def':'none'},'native':{}}),await this[_0x9a4e80(0x278)](_0x9a4e80(0x356),{'type':_0x9a4e80(0x339),'common':{'name':_0x9a4e80(0x213),'type':_0x9a4e80(0x336),'role':_0x9a4e80(0x25a),'read':!![],'write':![],'def':''},'native':{}}),await this[_0x9a4e80(0x2db)](),await this[_0x9a4e80(0x226)]();}catch(_0x5bcdad){this['log'][_0x9a4e80(0x2b2)](_0x9a4e80(0x311)+_0x5bcdad[_0x9a4e80(0x34c)]);}}async[a0_0x3efa97(0x2d5)](){const _0x1dcb0f=a0_0x3efa97;await this[_0x1dcb0f(0x245)](_0x1dcb0f(0x28d),{'type':'channel','common':{'name':_0x1dcb0f(0x386)},'native':{}}),await this[_0x1dcb0f(0x245)](SYSTEM_DP_MODE,{'type':_0x1dcb0f(0x339),'common':{'name':_0x1dcb0f(0x258),'type':_0x1dcb0f(0x336),'role':_0x1dcb0f(0x339),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x1dcb0f(0x2e1)],'states':{[SYSTEM_MODES[_0x1dcb0f(0x2e1)]]:_0x1dcb0f(0x2b9),[SYSTEM_MODES[_0x1dcb0f(0x1ad)]]:_0x1dcb0f(0x33b),[SYSTEM_MODES[_0x1dcb0f(0x288)]]:_0x1dcb0f(0x1dd),[SYSTEM_MODES[_0x1dcb0f(0x1ee)]]:_0x1dcb0f(0x1dc)}},'native':{}});}async[a0_0x3efa97(0x2db)](){const _0x322ca9=a0_0x3efa97;await this[_0x322ca9(0x245)](_0x322ca9(0x301),{'type':_0x322ca9(0x26d),'common':{'name':_0x322ca9(0x301)},'native':{}}),await this[_0x322ca9(0x245)](LTM_DP_RAW_LOG,{'type':_0x322ca9(0x339),'common':{'name':_0x322ca9(0x279),'type':_0x322ca9(0x336),'role':_0x322ca9(0x315),'read':!![],'write':![]},'native':{}}),await this[_0x322ca9(0x245)](LTM_DP_DAILY_DIGESTS,{'type':_0x322ca9(0x339),'common':{'name':_0x322ca9(0x364),'type':_0x322ca9(0x336),'role':_0x322ca9(0x315),'read':!![],'write':![]},'native':{}}),await this[_0x322ca9(0x245)](LTM_DP_STATUS,{'type':_0x322ca9(0x339),'common':{'name':_0x322ca9(0x2c1),'type':_0x322ca9(0x336),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x322ca9(0x245)](LTM_DP_TRIGGER_DIGEST,{'type':_0x322ca9(0x339),'common':{'name':_0x322ca9(0x234),'type':_0x322ca9(0x1eb),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x322ca9(0x245)](LTM_DP_BASELINE_STATUS,{'type':_0x322ca9(0x339),'common':{'name':_0x322ca9(0x1ac),'type':_0x322ca9(0x336),'role':_0x322ca9(0x25a),'read':!![],'write':![]},'native':{}});}async[a0_0x3efa97(0x226)](){const _0xe3edc4=a0_0x3efa97;await this['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0xe3edc4(0x26d),'common':{'name':'Drift\x20Analysis'},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0xe3edc4(0x29f),'type':'string','role':'state','read':!![],'write':![],'def':_0xe3edc4(0x227)},'native':{}}),await this[_0xe3edc4(0x245)](LTM_DP_DRIFT_DETAILS,{'type':_0xe3edc4(0x339),'common':{'name':'Drift\x20Details','type':_0xe3edc4(0x336),'role':_0xe3edc4(0x25a),'read':!![],'write':![]},'native':{}}),await this[_0xe3edc4(0x245)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0xe3edc4(0x297),'type':_0xe3edc4(0x1ed),'role':_0xe3edc4(0x1cc),'read':!![],'write':![]},'native':{}});}async[a0_0x3efa97(0x1e8)](){const _0x4a8190=a0_0x3efa97;try{const _0x302324=await this[_0x4a8190(0x2c3)](SYSTEM_DP_MODE);_0x302324&&_0x302324[_0x4a8190(0x26b)]&&Object['values'](SYSTEM_MODES)[_0x4a8190(0x31b)](_0x302324[_0x4a8190(0x26b)])?this[_0x4a8190(0x1cd)]=_0x302324[_0x4a8190(0x26b)]:(this[_0x4a8190(0x1cd)]=SYSTEM_MODES['NORMAL'],await this[_0x4a8190(0x1a3)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x3384f1){this[_0x4a8190(0x1cd)]=SYSTEM_MODES['NORMAL'];}}async[a0_0x3efa97(0x2ac)](){const _0x4e5844=a0_0x3efa97;try{const _0x283a32=await this[_0x4e5844(0x2c3)](LTM_DP_RAW_LOG);if(_0x283a32&&_0x283a32['val'])this[_0x4e5844(0x376)]=JSON[_0x4e5844(0x2cb)](_0x283a32[_0x4e5844(0x26b)]);}catch(_0x24fac8){this[_0x4e5844(0x376)]=[];}}async[a0_0x3efa97(0x286)](){const _0x18dd26=a0_0x3efa97;try{const _0x47096f=await this[_0x18dd26(0x2c3)](LTM_DP_DAILY_DIGESTS);if(_0x47096f&&_0x47096f[_0x18dd26(0x26b)])this['dailyDigests']=JSON[_0x18dd26(0x2cb)](_0x47096f['val']);}catch(_0xfceff5){this[_0x18dd26(0x23e)]=[];}await this['updateBaselineStatus']();}async[a0_0x3efa97(0x2fe)](){const _0x20c16c=a0_0x3efa97;this['rawEventLog']['length']>RAW_LOG_MAX_SIZE&&this['rawEventLog'][_0x20c16c(0x295)](0x0,this[_0x20c16c(0x376)][_0x20c16c(0x1d7)]-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x20c16c(0x244)](this[_0x20c16c(0x376)]),'ack':!![]});}async[a0_0x3efa97(0x2fd)](_0x42696f=!![]){const _0x372e75=a0_0x3efa97,_0x2dfe63=this[_0x372e75(0x1e6)][_0x372e75(0x2c4)]||0x3c;this['dailyDigests'][_0x372e75(0x1d7)]>_0x2dfe63&&this[_0x372e75(0x23e)]['splice'](0x0,this['dailyDigests']['length']-_0x2dfe63);await this[_0x372e75(0x1a3)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x372e75(0x244)](this[_0x372e75(0x23e)]),'ack':!![]});if(_0x42696f)await this['updateBaselineStatus']();}async[a0_0x3efa97(0x1e2)](_0xa4dc8){const _0x3014bc=a0_0x3efa97;this['analysisHistory'][_0x3014bc(0x2e6)](_0xa4dc8);if(this[_0x3014bc(0x1be)][_0x3014bc(0x1d7)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x3014bc(0x1be)][_0x3014bc(0x225)]();await this['setStateAsync'](_0x3014bc(0x2a8),{'val':JSON['stringify'](this[_0x3014bc(0x1be)]),'ack':!![]});}async[a0_0x3efa97(0x349)](){const _0x51b6bf=a0_0x3efa97;if(!this['isProVersion']){await this[_0x51b6bf(0x1a3)](LTM_DP_BASELINE_STATUS,{'val':_0x51b6bf(0x35e),'ack':!![]});return;}const _0xf323fe=this['dailyDigests'][_0x51b6bf(0x1d7)]>=(this['config'][_0x51b6bf(0x1fd)]||0x7)?'Aktiv\x20('+this['dailyDigests'][_0x51b6bf(0x1d7)]+_0x51b6bf(0x1f2):_0x51b6bf(0x1c4)+this[_0x51b6bf(0x23e)][_0x51b6bf(0x1d7)]+'/'+(this['config'][_0x51b6bf(0x1fd)]||0x7)+')';await this[_0x51b6bf(0x1a3)](LTM_DP_BASELINE_STATUS,{'val':_0xf323fe,'ack':!![]});}async[a0_0x3efa97(0x203)](){const _0x328f02=a0_0x3efa97,_0x2f25ce=this['config']['devices'];if(_0x2f25ce&&_0x2f25ce[_0x328f02(0x1d7)]>0x0){this[_0x328f02(0x2d1)]['info'](_0x328f02(0x211)+_0x2f25ce['length']+_0x328f02(0x323));for(const _0x19adb8 of _0x2f25ce){if(_0x19adb8['id']){await this[_0x328f02(0x1df)](_0x19adb8['id']);try{const _0x3936be=await this[_0x328f02(0x37c)](_0x19adb8['id']);if(_0x3936be)this[_0x328f02(0x33c)][_0x19adb8['id']]=_0x3936be[_0x328f02(0x26b)];}catch(_0x1de040){}}}}}async['initPresenceSubscriptions'](){const _0x210749=a0_0x3efa97,_0x399c1e=this[_0x210749(0x1e6)][_0x210749(0x2a6)]||[];if(_0x399c1e['length']>0x0){this['log'][_0x210749(0x31f)](_0x210749(0x211)+_0x399c1e[_0x210749(0x1d7)]+'\x20presence\x20devices...');for(const _0x254efe of _0x399c1e){await this[_0x210749(0x1df)](_0x254efe);}try{await this[_0x210749(0x229)]();}catch(_0x20db96){}}}async[a0_0x3efa97(0x1a8)](){const _0x12b778=a0_0x3efa97;try{if(!this[_0x12b778(0x1e6)][_0x12b778(0x2b5)])return'Wetter:\x20Deaktiviert';let _0x928d15='';const _0x366b8a=this[_0x12b778(0x1e6)][_0x12b778(0x331)];if(_0x366b8a)try{if(_0x366b8a[_0x12b778(0x31b)](_0x12b778(0x2cc))){const _0x407881=await this[_0x12b778(0x37c)](_0x366b8a+_0x12b778(0x24d));if(_0x407881&&_0x407881[_0x12b778(0x26b)])_0x928d15=_0x407881[_0x12b778(0x26b)];}else{if(_0x366b8a[_0x12b778(0x31b)]('daswetter')){const _0xd20d7d=await this[_0x12b778(0x37c)](_0x366b8a+_0x12b778(0x296));if(_0xd20d7d&&_0xd20d7d[_0x12b778(0x26b)])_0x928d15=_0xd20d7d[_0x12b778(0x26b)];}else{if(_0x366b8a[_0x12b778(0x31b)]('openweathermap')){const _0x1b1fd1=await this[_0x12b778(0x37c)](_0x366b8a+_0x12b778(0x367));if(_0x1b1fd1&&_0x1b1fd1[_0x12b778(0x26b)])_0x928d15=_0x1b1fd1['val'];}}}}catch(_0x4b313a){}if(!_0x928d15){const _0xc3d03=[_0x12b778(0x334),'daswetter.0',_0x12b778(0x21e),'openweathermap.0'];for(const _0x1a7691 of _0xc3d03){try{const _0x23e421=await this[_0x12b778(0x307)](_0x1a7691);if(_0x23e421){if(_0x1a7691[_0x12b778(0x31b)](_0x12b778(0x2cc))){const _0x5c99b3=await this[_0x12b778(0x37c)](_0x1a7691+'.Summary.Current');if(_0x5c99b3&&_0x5c99b3[_0x12b778(0x26b)]){_0x928d15=_0x5c99b3['val'];break;}}}}catch(_0x4565fb){}}}return _0x928d15?_0x12b778(0x1c1)+_0x928d15:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x1c0b0a){return _0x12b778(0x20f)+_0x1c0b0a[_0x12b778(0x34c)];}}async['getCalendarContext'](){const _0x45bbf0=a0_0x3efa97;try{if(!this['config']['useCalendar'])return'Kalender:\x20Deaktiviert';let _0x5d59d0=this['config'][_0x45bbf0(0x33d)]||'ical.0',_0x573e62=this[_0x45bbf0(0x1e6)][_0x45bbf0(0x25c)]||[];if(typeof _0x573e62===_0x45bbf0(0x336))_0x573e62=_0x573e62[_0x45bbf0(0x1e7)](',');try{const _0x44ca90=await this[_0x45bbf0(0x37c)](_0x5d59d0+_0x45bbf0(0x1fc));if(_0x44ca90&&_0x44ca90[_0x45bbf0(0x26b)]){let _0x2b0f05=this[_0x45bbf0(0x2e9)](_0x44ca90[_0x45bbf0(0x26b)]);if(_0x2b0f05&&Array[_0x45bbf0(0x1bf)](_0x2b0f05)){if(_0x573e62['length']>0x0)_0x2b0f05=_0x2b0f05['filter'](_0x247b53=>_0x573e62['includes'](_0x247b53[_0x45bbf0(0x212)]||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x2b0f05[_0x45bbf0(0x1d7)]>0x0){const _0x59a3a7=_0x2b0f05[_0x45bbf0(0x29a)](0x0,0x3)[_0x45bbf0(0x1ef)](_0x46c108=>{const _0x41f9e4=_0x45bbf0;let _0x44cfbf=_0x46c108['date'];if(_0x46c108[_0x41f9e4(0x291)])_0x44cfbf+='\x20'+_0x46c108[_0x41f9e4(0x291)];return _0x44cfbf+':\x20'+_0x46c108[_0x41f9e4(0x2ce)]+'\x20('+_0x46c108['_calName']+')';});return _0x45bbf0(0x1ca)+_0x59a3a7['join'](_0x45bbf0(0x1a0));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x2cd2c0){this[_0x45bbf0(0x2d1)][_0x45bbf0(0x37d)](_0x45bbf0(0x316)+_0x2cd2c0['message']);}return _0x45bbf0(0x2e2);}catch(_0x5e6c47){return _0x45bbf0(0x345)+_0x5e6c47['message'];}}async['getCalendarNames'](_0x430067){const _0x5a8360=a0_0x3efa97;try{const _0x51242a=await this[_0x5a8360(0x37c)](_0x430067+_0x5a8360(0x1fc));if(_0x51242a&&_0x51242a[_0x5a8360(0x26b)]){const _0x2faa90=this['tryParse'](_0x51242a[_0x5a8360(0x26b)]);if(_0x2faa90&&Array[_0x5a8360(0x1bf)](_0x2faa90)){const _0x26d7af=[...new Set(_0x2faa90[_0x5a8360(0x1ef)](_0x1cff37=>_0x1cff37[_0x5a8360(0x212)])['filter'](Boolean))];return _0x26d7af[_0x5a8360(0x238)]();}}return[];}catch(_0x57817e){return this[_0x5a8360(0x2d1)]['error'](_0x5a8360(0x348)+_0x57817e[_0x5a8360(0x34c)]),[];}}async[a0_0x3efa97(0x229)](){const _0x54ff55=a0_0x3efa97;try{const _0xde03cc=this[_0x54ff55(0x1e6)][_0x54ff55(0x2a6)]||[];let _0x10ed3e=![];for(const _0x4ed546 of _0xde03cc){try{const _0x5153ff=await this[_0x54ff55(0x37c)](_0x4ed546);if(_0x5153ff&&(_0x5153ff[_0x54ff55(0x26b)]===!![]||_0x5153ff[_0x54ff55(0x26b)]===_0x54ff55(0x200)||_0x5153ff[_0x54ff55(0x26b)]===0x1)){_0x10ed3e=!![];break;}}catch(_0x2abbee){}}return _0x10ed3e&&(this['exitTimer']&&(this[_0x54ff55(0x2d1)][_0x54ff55(0x31f)](_0x54ff55(0x23f)),this[_0x54ff55(0x22f)]()),!this[_0x54ff55(0x2e4)]&&this[_0x54ff55(0x1cd)]===SYSTEM_MODES[_0x54ff55(0x2e1)]&&await this['setPresence'](!![])),_0x10ed3e;}catch(_0x557bc6){return this[_0x54ff55(0x2d1)]['error'](_0x54ff55(0x2f7)+_0x557bc6['message']),![];}}[a0_0x3efa97(0x263)](){const _0x1959b4=a0_0x3efa97;this[_0x1959b4(0x22f)](),this['isGracePeriodActive']=!![],this[_0x1959b4(0x2b3)]=setTimeout(()=>{const _0x558736=_0x1959b4;this[_0x558736(0x2f8)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x1959b4(0x30f)]=setTimeout(()=>{const _0x17802d=_0x1959b4;this[_0x17802d(0x363)](![]),this['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x3efa97(0x22f)](){const _0x530744=a0_0x3efa97;if(this['exitTimer'])clearTimeout(this[_0x530744(0x30f)]);if(this[_0x530744(0x2b3)])clearTimeout(this[_0x530744(0x2b3)]);this[_0x530744(0x30f)]=null,this[_0x530744(0x2b3)]=null,this['isGracePeriodActive']=![];}async['setPresence'](_0x171bd1){const _0x6fcf12=a0_0x3efa97;if(this[_0x6fcf12(0x2e4)]===_0x171bd1)return;this[_0x6fcf12(0x2e4)]=_0x171bd1,await this[_0x6fcf12(0x1a3)]('system.isPresent',{'val':_0x171bd1,'ack':!![]});}async['saveFeedback'](_0x35f353){const _0x42faa2=a0_0x3efa97;this['log']['info'](_0x42faa2(0x253)+JSON[_0x42faa2(0x244)](_0x35f353));}async['runBaselineDriftAnalysis'](){const _0x1a9db7=a0_0x3efa97;if(!this[_0x1a9db7(0x2da)]||!this[_0x1a9db7(0x27d)])return;const _0x2f311e=this[_0x1a9db7(0x1e6)][_0x1a9db7(0x36f)]||0xe;if(this[_0x1a9db7(0x23e)][_0x1a9db7(0x1d7)]<_0x2f311e+(this[_0x1a9db7(0x1e6)][_0x1a9db7(0x1fd)]||0x7)){await this[_0x1a9db7(0x1a3)](LTM_DP_DRIFT_STATUS,{'val':_0x1a9db7(0x22a),'ack':!![]});return;}const _0x11d6ae=this[_0x1a9db7(0x23e)][_0x1a9db7(0x29a)](-_0x2f311e),_0x2db023=this['dailyDigests']['slice'](0x0,this[_0x1a9db7(0x23e)][_0x1a9db7(0x1d7)]-_0x2f311e),_0x2e5a91=_0x1a9db7(0x2f0)+JSON[_0x1a9db7(0x244)](_0x2db023)+_0x1a9db7(0x33a)+JSON[_0x1a9db7(0x244)](_0x11d6ae);try{const _0x2e495f=await this[_0x1a9db7(0x27d)][_0x1a9db7(0x2eb)](_0x2e5a91),_0xa08d76=JSON[_0x1a9db7(0x2cb)](_0x2e495f[_0x1a9db7(0x370)][_0x1a9db7(0x25a)]()['replace'](/```json|```/g,'')[_0x1a9db7(0x273)]());_0xa08d76[_0x1a9db7(0x1e1)]&&(await this[_0x1a9db7(0x1a3)](LTM_DP_DRIFT_STATUS,{'val':_0xa08d76[_0x1a9db7(0x1e1)],'ack':!![]}),await this[_0x1a9db7(0x1a3)](LTM_DP_DRIFT_DETAILS,{'val':_0xa08d76[_0x1a9db7(0x351)],'ack':!![]}),await this[_0x1a9db7(0x1a3)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x1a9db7(0x236)](),'ack':!![]}));}catch(_0x47ffd5){}}[a0_0x3efa97(0x2ff)](){const _0x17f9b6=a0_0x3efa97;try{if(this['ltmJob'])this[_0x17f9b6(0x1c9)][_0x17f9b6(0x36d)]();if(!this[_0x17f9b6(0x2da)]){this[_0x17f9b6(0x1a3)](LTM_DP_STATUS,{'val':_0x17f9b6(0x35e),'ack':!![]});return;}this['ltmJob']=schedule[_0x17f9b6(0x33e)](LTM_SCHEDULE,()=>this['createDailyDigest']());}catch(_0x1e7839){this[_0x17f9b6(0x2d1)]['error'](_0x17f9b6(0x1ab)+_0x1e7839[_0x17f9b6(0x34c)]);}}[a0_0x3efa97(0x304)](){const _0x3236bb=a0_0x3efa97;try{if(this[_0x3236bb(0x2ef)])this['modeResetJob'][_0x3236bb(0x36d)]();this[_0x3236bb(0x2ef)]=schedule[_0x3236bb(0x33e)](MODE_RESET_SCHEDULE,async()=>{const _0x3fa39d=_0x3236bb;await this[_0x3fa39d(0x1e8)](),AUTO_RESET_MODES['includes'](this[_0x3fa39d(0x1cd)])&&await this[_0x3fa39d(0x1a3)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3fa39d(0x2e1)],'ack':![]});});}catch(_0x2244ba){this[_0x3236bb(0x2d1)]['error'](_0x3236bb(0x1d5)+_0x2244ba[_0x3236bb(0x34c)]);}}['setupDriftAnalysisScheduler'](){const _0x138f59=a0_0x3efa97;try{if(this[_0x138f59(0x250)])clearInterval(this[_0x138f59(0x250)]);if(!this[_0x138f59(0x2da)])return;this['driftAnalysisTimer']=setInterval(()=>this[_0x138f59(0x237)](),(this['config'][_0x138f59(0x30b)]||0x18)*0x36ee80),setTimeout(()=>this['runBaselineDriftAnalysis'](),0x1388);}catch(_0x2be054){this[_0x138f59(0x2d1)][_0x138f59(0x2b2)](_0x138f59(0x2ed)+_0x2be054[_0x138f59(0x34c)]);}}[a0_0x3efa97(0x32d)](){const _0x285c69=a0_0x3efa97;try{if(this['briefingJob'])this[_0x285c69(0x22b)][_0x285c69(0x36d)]();if(!this[_0x285c69(0x1e6)][_0x285c69(0x254)])return;const _0x4ecf0a=(this['config'][_0x285c69(0x24c)]||_0x285c69(0x29e))['split'](':'),_0x49f736=parseInt(_0x4ecf0a[0x0])||0x8,_0x3675d3=parseInt(_0x4ecf0a[0x1])||0x0,_0x2df71c=_0x3675d3+'\x20'+_0x49f736+_0x285c69(0x289);this[_0x285c69(0x2d1)][_0x285c69(0x31f)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x49f736+':'+(_0x3675d3<0xa?'0'+_0x3675d3:_0x3675d3)),this['briefingJob']=schedule['scheduleJob'](_0x2df71c,()=>{this['sendMorningBriefing']();});}catch(_0x3e0664){this[_0x285c69(0x2d1)][_0x285c69(0x2b2)](_0x285c69(0x1fb)+_0x3e0664['message']);}}async[a0_0x3efa97(0x2dd)](_0x3e40f9,_0xbf7cef=![],_0x46679e=![]){const _0xbfa85a=a0_0x3efa97;this['log'][_0xbfa85a(0x31f)]((_0xbf7cef?'[TEST]\x20':'')+'Sending\x20notification:\x20\x22'+_0x3e40f9+'\x22'+(_0x46679e?'\x20(EMERGENCY)':''));const _0x6e2cac=this[_0xbfa85a(0x1e6)];let _0xae63e8=0x0;_0x6e2cac['notifyTelegramEnabled']&&_0x6e2cac['notifyTelegramInstance']&&(await this['sendToAsync'](_0x6e2cac[_0xbfa85a(0x1d1)],_0xbfa85a(0x2cd),{'text':_0x3e40f9,'user':_0x6e2cac['notifyTelegramRecipient']}),_0xae63e8++);if(_0x6e2cac[_0xbfa85a(0x1a1)]&&_0x6e2cac[_0xbfa85a(0x216)]){let _0x35d913={'message':_0x3e40f9,'title':_0x46679e?'üö®\x20EMERGENCY':'Cogni-Living\x20Alert','priority':_0x46679e?0x2:0x1,'device':_0x6e2cac['notifyPushoverRecipient']};_0x46679e&&(_0x35d913['retry']=0x1e,_0x35d913[_0xbfa85a(0x1d0)]=0xe10,_0x35d913[_0xbfa85a(0x1a5)]=_0xbfa85a(0x1f6)),await this[_0xbfa85a(0x2c0)](_0x6e2cac[_0xbfa85a(0x216)],'send',_0x35d913),_0xae63e8++;}return _0x6e2cac[_0xbfa85a(0x31e)]&&_0x6e2cac[_0xbfa85a(0x298)]&&(await this[_0xbfa85a(0x2c0)](_0x6e2cac[_0xbfa85a(0x298)],'send',{'text':_0x3e40f9,'to':_0x6e2cac[_0xbfa85a(0x36b)]}),_0xae63e8++),_0x6e2cac['notifyWhatsappEnabled']&&_0x6e2cac[_0xbfa85a(0x280)]&&(await this['sendToAsync'](_0x6e2cac[_0xbfa85a(0x280)],_0xbfa85a(0x2cd),{'text':_0x3e40f9,'phone':_0x6e2cac[_0xbfa85a(0x25b)]}),_0xae63e8++),_0x6e2cac[_0xbfa85a(0x1f5)]&&_0x6e2cac[_0xbfa85a(0x319)]&&(await this['sendToAsync'](_0x6e2cac[_0xbfa85a(0x319)],_0xbfa85a(0x2cd),{'text':_0x3e40f9,'phone':_0x6e2cac['notifySignalRecipient']}),_0xae63e8++),_0xae63e8;}}if(require[a0_0x3efa97(0x341)]!==module)module[a0_0x3efa97(0x1b3)]=_0x427eae=>new CogniLiving(_0x427eae);else new CogniLiving();