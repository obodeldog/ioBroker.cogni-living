const a0_0x4555e1=a0_0x48cb;(function(_0x1c7bb2,_0x359658){const _0x53da78=a0_0x48cb,_0x4ff60b=_0x1c7bb2();while(!![]){try{const _0x6d995b=parseInt(_0x53da78(0x1d2))/0x1*(-parseInt(_0x53da78(0x16c))/0x2)+parseInt(_0x53da78(0x171))/0x3+-parseInt(_0x53da78(0x196))/0x4*(parseInt(_0x53da78(0x2dc))/0x5)+-parseInt(_0x53da78(0x241))/0x6*(parseInt(_0x53da78(0x216))/0x7)+-parseInt(_0x53da78(0x2bc))/0x8*(parseInt(_0x53da78(0x160))/0x9)+parseInt(_0x53da78(0x16e))/0xa+parseInt(_0x53da78(0x1e3))/0xb*(parseInt(_0x53da78(0x222))/0xc);if(_0x6d995b===_0x359658)break;else _0x4ff60b['push'](_0x4ff60b['shift']());}catch(_0x5ca665){_0x4ff60b['push'](_0x4ff60b['shift']());}}}(a0_0x50bc,0x65db1));const a0_0x39065b=(function(){let _0x2328d0=!![];return function(_0x5e0942,_0x1d7b49){const _0x18c12f=_0x2328d0?function(){const _0x231d62=a0_0x48cb;if(_0x1d7b49){const _0x24e300=_0x1d7b49[_0x231d62(0x232)](_0x5e0942,arguments);return _0x1d7b49=null,_0x24e300;}}:function(){};return _0x2328d0=![],_0x18c12f;};}()),a0_0x1d0a94=a0_0x39065b(this,function(){const _0x20eb55=a0_0x48cb;return a0_0x1d0a94[_0x20eb55(0x219)]()[_0x20eb55(0x1a1)](_0x20eb55(0x20f))['toString']()[_0x20eb55(0x206)](a0_0x1d0a94)['search']('(((.+)+)+)+$');});a0_0x1d0a94();'use strict';const utils=require(a0_0x4555e1(0x178)),{GoogleGenerativeAI}=require(a0_0x4555e1(0x173)),schedule=require(a0_0x4555e1(0x20a)),{spawn,exec}=require('child_process'),path=require(a0_0x4555e1(0x177)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x4555e1(0x202),LTM_SCHEDULE=a0_0x4555e1(0x27b),MODE_RESET_SCHEDULE=a0_0x4555e1(0x2f7),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x4555e1(0x271),LTM_DP_DAILY_DIGESTS=a0_0x4555e1(0x2cb),LTM_DP_STATUS=a0_0x4555e1(0x1a9),LTM_DP_TRIGGER_DIGEST=a0_0x4555e1(0x15b),LTM_DP_BASELINE_STATUS=a0_0x4555e1(0x2a7),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x4555e1(0x300),LTM_DP_DRIFT_DETAILS=a0_0x4555e1(0x2df),LTM_DP_DRIFT_LAST_CHECK=a0_0x4555e1(0x161),SYSTEM_DP_MODE=a0_0x4555e1(0x29d),SYSTEM_MODES={'NORMAL':a0_0x4555e1(0x231),'VACATION':a0_0x4555e1(0x1dc),'PARTY':a0_0x4555e1(0x2de),'GUEST':a0_0x4555e1(0x1e9)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x4555e1(0x1ca)],SYSTEM_MODES[a0_0x4555e1(0x240)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x4555e1(0x309),'family':a0_0x4555e1(0x22e),'single_comfort':a0_0x4555e1(0x1ff),'security':a0_0x4555e1(0x243)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process['platform']===a0_0x4555e1(0x24f),PERSISTENT_DIR=path[a0_0x4555e1(0x25a)](__dirname,'.venv'),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path[a0_0x4555e1(0x25a)](VENV_PATH,'Scripts',a0_0x4555e1(0x157)):path[a0_0x4555e1(0x25a)](VENV_PATH,a0_0x4555e1(0x26d),a0_0x4555e1(0x19c)),PIP_EXE=IS_WIN?path['join'](VENV_PATH,a0_0x4555e1(0x1cd),a0_0x4555e1(0x2db)):path[a0_0x4555e1(0x25a)](VENV_PATH,a0_0x4555e1(0x26d),a0_0x4555e1(0x285));let activeSequence=[],sequenceTimer=null;async function startSystem(_0x393d27){const _0xb9a54b=a0_0x4555e1;_0x393d27[_0xb9a54b(0x2e4)][_0xb9a54b(0x1c9)]('üöÄ\x20Starting\x20NUUKANNI\x20Logic\x20(v0.10.0)...'),await initZombies(_0x393d27);try{_0x393d27['isProVersion']=await checkLicense(_0x393d27['config'][_0xb9a54b(0x2f8)]);}catch(_0x413635){}if(!_0x393d27[_0xb9a54b(0x252)][_0xb9a54b(0x298)]||_0x393d27['config'][_0xb9a54b(0x298)]<0.1)_0x393d27[_0xb9a54b(0x252)][_0xb9a54b(0x298)]=0xc;await initHistory(_0x393d27),await initSystemConfig(_0x393d27);if(_0x393d27['config'][_0xb9a54b(0x1e5)])try{_0x393d27[_0xb9a54b(0x299)]=new GoogleGenerativeAI(_0x393d27[_0xb9a54b(0x252)]['geminiApiKey']),_0x393d27['geminiModel']=_0x393d27['genAI']['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xb9a54b(0x289)}}),_0x393d27[_0xb9a54b(0x2e4)][_0xb9a54b(0x1c9)](_0xb9a54b(0x307));}catch(_0x150be7){_0x393d27[_0xb9a54b(0x2e4)][_0xb9a54b(0x199)](_0xb9a54b(0x303)+_0x150be7[_0xb9a54b(0x2b9)]);}await createAllObjects(_0x393d27),await loadSystemMode(_0x393d27),await loadRawEventLog(_0x393d27),await loadDailyDigests(_0x393d27),_0x393d27['subscribeStates'](_0xb9a54b(0x2c6)),_0x393d27['subscribeStates'](LTM_DP_TRIGGER_DIGEST),_0x393d27[_0xb9a54b(0x2ec)](_0xb9a54b(0x29d)),_0x393d27[_0xb9a54b(0x2ec)](_0xb9a54b(0x1cb)),_0x393d27[_0xb9a54b(0x2ec)](_0xb9a54b(0x258)),_0x393d27[_0xb9a54b(0x2ec)](_0xb9a54b(0x21d)),_0x393d27[_0xb9a54b(0x2ec)]('analysis.training.triggerSecurity'),_0x393d27['subscribeStates'](_0xb9a54b(0x1f7)),_0x393d27[_0xb9a54b(0x2ec)](_0xb9a54b(0x2c3)),_0x393d27[_0xb9a54b(0x2ec)](_0xb9a54b(0x30b)),await initSensorSubscriptions(_0x393d27),await initPresenceSubscriptions(_0x393d27),await setupTelegramListener(_0x393d27),setTimeout(()=>checkWifiPresence(_0x393d27),0x1388);if(_0x393d27[_0xb9a54b(0x2f9)])clearInterval(_0x393d27[_0xb9a54b(0x2f9)]);const _0x4bd6c2=_0x393d27[_0xb9a54b(0x252)][_0xb9a54b(0x2b2)]||0xf;_0x4bd6c2>0x0&&(_0x393d27['analysisTimer']=setInterval(()=>{runAutopilot(_0x393d27);},_0x4bd6c2*0x3c*0x3e8)),setupLtmScheduler(_0x393d27),setupModeResetScheduler(_0x393d27),setupDriftAnalysisScheduler(_0x393d27),setupBriefingScheduler(_0x393d27),startPythonService(_0x393d27),setTimeout(()=>{if(_0x393d27['pythonProcess'])runPythonHealthCheck(_0x393d27);},0x1388);}async function runAutopilot(_0x28bfaf){const _0x2629f1=a0_0x4555e1;_0x28bfaf['log']['debug'](_0x2629f1(0x2a5)),await runGeminiAnalysis(_0x28bfaf);}async function scanForDevices(_0xfd8d3a,_0x2d94f1){const _0x2085f3=a0_0x4555e1;_0xfd8d3a['log'][_0x2085f3(0x1c9)](_0x2085f3(0x2a8));const _0x6b9c54=[],_0x14ec3a=await _0xfd8d3a[_0x2085f3(0x2d7)]('*');for(const _0x2d2be8 in _0x14ec3a){const _0x22d16d=_0x14ec3a[_0x2d2be8];if(_0x22d16d&&_0x22d16d[_0x2085f3(0x2c1)]&&_0x22d16d[_0x2085f3(0x15e)]==='state'){const _0x254181=(_0x22d16d[_0x2085f3(0x2c1)][_0x2085f3(0x2cd)]&&typeof _0x22d16d[_0x2085f3(0x2c1)]['name']===_0x2085f3(0x1d9)?_0x22d16d[_0x2085f3(0x2c1)]['name']['de']:_0x22d16d['common'][_0x2085f3(0x2cd)])||'',_0x3314b5=_0x22d16d['common'][_0x2085f3(0x30a)]||'';let _0x499f00=null;if(_0x2d94f1[_0x2085f3(0x1e8)]&&(_0x3314b5[_0x2085f3(0x192)]('motion')||_0x254181[_0x2085f3(0x27f)]()[_0x2085f3(0x192)](_0x2085f3(0x1c0))))_0x499f00=_0x2085f3(0x1e8);else{if(_0x2d94f1[_0x2085f3(0x237)]&&(_0x3314b5[_0x2085f3(0x192)](_0x2085f3(0x183))||_0x3314b5['includes'](_0x2085f3(0x169))||_0x254181[_0x2085f3(0x27f)]()[_0x2085f3(0x192)](_0x2085f3(0x253))||_0x254181[_0x2085f3(0x27f)]()[_0x2085f3(0x192)](_0x2085f3(0x27e))))_0x499f00=_0x2085f3(0x183);else{if(_0x2d94f1['lights']&&(_0x3314b5[_0x2085f3(0x192)]('light')||_0x3314b5[_0x2085f3(0x192)]('switch')||_0x254181[_0x2085f3(0x27f)]()['includes'](_0x2085f3(0x1c4))))_0x499f00=_0x2085f3(0x1da);else{if(_0x2d94f1[_0x2085f3(0x166)]&&(_0x3314b5['includes'](_0x2085f3(0x166))||_0x254181['toLowerCase']()['includes'](_0x2085f3(0x174))))_0x499f00='temperature';}}}if(_0x499f00){let _0x41888e='';const _0x5ac6ef=_0x2d2be8[_0x2085f3(0x1ef)]('.');if(_0x5ac6ef[_0x2085f3(0x1b8)]>0x2)_0x41888e=_0x5ac6ef[0x2];_0x6b9c54[_0x2085f3(0x204)]({'id':_0x2d2be8,'name':_0x254181||_0x2d2be8,'type':_0x499f00,'location':_0x41888e,'_score':0x32});}}}return _0x6b9c54;}async function getWeatherContext(_0x49392e){const _0x4280fe=a0_0x4555e1;if(!_0x49392e['config'][_0x4280fe(0x255)]||!_0x49392e[_0x4280fe(0x252)][_0x4280fe(0x265)])return _0x4280fe(0x2d1);try{const _0x23e837=_0x49392e['config'][_0x4280fe(0x265)];let _0x3570fa=await _0x49392e['getForeignStateAsync'](_0x23e837+'.Current.Temperature');if(!_0x3570fa)_0x3570fa=await _0x49392e[_0x4280fe(0x28d)](_0x23e837+_0x4280fe(0x2f4));let _0x2d364d=await _0x49392e['getForeignStateAsync'](_0x23e837+_0x4280fe(0x167));if(!_0x2d364d)_0x2d364d=await _0x49392e[_0x4280fe(0x28d)](_0x23e837+_0x4280fe(0x2fc));if(_0x3570fa&&_0x2d364d)return _0x3570fa[_0x4280fe(0x1a2)]+_0x4280fe(0x1ed)+_0x2d364d['val'];}catch(_0x6cd251){}return _0x4280fe(0x2d6);}async function getCalendarContext(_0x5624fc){const _0x25b684=a0_0x4555e1;if(!_0x5624fc['config'][_0x25b684(0x2f0)]||!_0x5624fc['config'][_0x25b684(0x1ba)])return _0x25b684(0x27d);return _0x25b684(0x1a8);}async function getCalendarNames(_0x179e1d,_0x1ef519){return[];}async function saveFeedback(_0x696085,_0x359452){const _0x39d6ab=a0_0x4555e1;_0x696085[_0x39d6ab(0x2e4)][_0x39d6ab(0x1c9)](_0x39d6ab(0x220)+_0x359452['rating']);}async function sendMorningBriefing(_0x12e63a){const _0x276308=a0_0x4555e1;if(!_0x12e63a[_0x276308(0x1b3)])return;try{const _0x12e6d5=_0x276308(0x17b),_0xe72b8b=await _0x12e63a['geminiModel'][_0x276308(0x1d1)](_0x12e6d5),_0x535e99=_0xe72b8b[_0x276308(0x2ae)][_0x276308(0x2e8)]();sendNotification(_0x12e63a,_0x276308(0x25e)+_0x535e99);}catch(_0x2c4dce){_0x12e63a[_0x276308(0x2e4)][_0x276308(0x199)]('Briefing\x20Error:\x20'+_0x2c4dce[_0x276308(0x2b9)]);}}function checkAndInstall(_0x76833f){const _0x5379d0=a0_0x4555e1;if(!fs[_0x5379d0(0x1a4)](VENV_PATH)||!fs[_0x5379d0(0x1a4)](PIP_EXE))return _0x76833f[_0x5379d0(0x2e4)][_0x5379d0(0x200)](_0x5379d0(0x259)),installPythonDependencies(_0x76833f),![];return!![];}function installPythonDependencies(_0x2b9904){const _0x1d4033=a0_0x4555e1;if(_0x2b9904[_0x1d4033(0x1a0)])return;_0x2b9904[_0x1d4033(0x1a0)]=!![];const _0x46ad1d=path[_0x1d4033(0x25a)](__dirname,_0x1d4033(0x2c7),_0x1d4033(0x1c7));stopPythonService(_0x2b9904);if(fs[_0x1d4033(0x1a4)](VENV_PATH))try{fs['rmSync'](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x53d46e){}exec(_0x1d4033(0x2d4)+VENV_PATH+'\x22',_0x2f83dc=>{const _0x17432d=_0x1d4033;if(_0x2f83dc){_0x2b9904[_0x17432d(0x2e4)][_0x17432d(0x199)](_0x17432d(0x2f5)+_0x2f83dc[_0x17432d(0x2b9)]),_0x2b9904[_0x17432d(0x1a0)]=![];return;}installRequirementsInVenv(_0x2b9904,_0x46ad1d);});}function installRequirementsInVenv(_0x9cd8ed,_0x113b24){const _0x365abd=a0_0x4555e1;_0x9cd8ed[_0x365abd(0x2e4)][_0x365abd(0x1c9)](_0x365abd(0x1b6));const _0x6ca08f='\x22'+PIP_EXE+'\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22'+_0x113b24+'\x22';exec(_0x6ca08f,{'timeout':0x124f80},(_0x172e35,_0x4e21d4,_0x5a8765)=>{const _0x20e0e3=_0x365abd;_0x9cd8ed[_0x20e0e3(0x1a0)]=![],_0x172e35?_0x9cd8ed[_0x20e0e3(0x2e4)]['error'](_0x20e0e3(0x20b)+(_0x5a8765||_0x172e35[_0x20e0e3(0x2b9)])):(_0x9cd8ed[_0x20e0e3(0x2e4)]['info'](_0x20e0e3(0x215)),startSystem(_0x9cd8ed));});}async function initZombies(_0x2405e2){const _0xf155a=a0_0x4555e1;try{const _0x254a4f=[_0xf155a(0x2ac),_0xf155a(0x18d)];for(const _0x3180f8 of _0x254a4f){try{const _0x27e6c6=await _0x2405e2['getObjectAsync'](_0x3180f8);if(_0x27e6c6)await _0x2405e2['delObjectAsync'](_0x3180f8);}catch(_0x509084){}}}catch(_0x32df79){}}async function checkLicense(_0x2177d6){return!![];}async function initHistory(_0x231e85){const _0x354b9a=a0_0x4555e1;try{const _0x16ba4e=await _0x231e85[_0x354b9a(0x23f)](_0x354b9a(0x27a));_0x16ba4e&&_0x16ba4e[_0x354b9a(0x1a2)]&&(_0x231e85[_0x354b9a(0x297)]=JSON['parse'](_0x16ba4e['val'][_0x354b9a(0x219)]()));}catch(_0x42fcb7){_0x231e85['eventHistory']=[];}try{const _0x10d3dd=await _0x231e85[_0x354b9a(0x23f)](_0x354b9a(0x209));if(_0x10d3dd&&_0x10d3dd[_0x354b9a(0x1a2)])_0x231e85[_0x354b9a(0x246)]=JSON[_0x354b9a(0x2b1)](_0x10d3dd[_0x354b9a(0x1a2)][_0x354b9a(0x219)]());}catch(_0x5c60b2){_0x231e85[_0x354b9a(0x246)]=[];}if(_0x231e85[_0x354b9a(0x297)]&&_0x231e85[_0x354b9a(0x297)][_0x354b9a(0x1b8)]>0x0){_0x231e85[_0x354b9a(0x2e4)][_0x354b9a(0x1c9)](_0x354b9a(0x2f1));for(let _0x4a2122=_0x231e85[_0x354b9a(0x297)][_0x354b9a(0x1b8)]-0x1;_0x4a2122>=0x0;_0x4a2122--){const _0x51a876=_0x231e85[_0x354b9a(0x297)][_0x4a2122];if(_0x51a876&&_0x51a876['id']!==undefined&&_0x51a876['value']!==undefined)_0x231e85['sensorLastValues'][_0x51a876['id']]=_0x51a876[_0x354b9a(0x2b7)];}}}async function initSystemConfig(_0x28baef){const _0x4351eb=a0_0x4555e1;try{const _0x2fe1d4=await _0x28baef[_0x4351eb(0x1b5)](_0x4351eb(0x20c));if(_0x2fe1d4&&_0x2fe1d4[_0x4351eb(0x2c1)])_0x28baef[_0x4351eb(0x23b)]={'latitude':_0x2fe1d4[_0x4351eb(0x2c1)][_0x4351eb(0x256)]||0x0,'longitude':_0x2fe1d4[_0x4351eb(0x2c1)][_0x4351eb(0x233)]||0x0,'city':_0x2fe1d4[_0x4351eb(0x2c1)][_0x4351eb(0x172)]||''};}catch(_0x29cb6b){}}async function createAllObjects(_0x5cd889){const _0x1ecd73=a0_0x4555e1;await _0x5cd889[_0x1ecd73(0x2da)](_0x1ecd73(0x1f8),{'type':_0x1ecd73(0x28c),'common':{'name':_0x1ecd73(0x24b)},'native':{}}),await _0x5cd889[_0x1ecd73(0x2da)](SYSTEM_DP_MODE,{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x1f2),'type':_0x1ecd73(0x207),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x1ecd73(0x26c)]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x2c0),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x2c4),'type':'string','role':_0x1ecd73(0x2e8),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x245),{'type':'state','common':{'name':_0x1ecd73(0x268),'type':_0x1ecd73(0x207),'role':'json','read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x27a),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x1b9),'type':_0x1ecd73(0x207),'role':'json','read':!![],'write':![]},'native':{}}),await _0x5cd889['extendObjectAsync'](_0x1ecd73(0x213),{'type':_0x1ecd73(0x28c),'common':{'name':_0x1ecd73(0x182)},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x188),{'type':_0x1ecd73(0x248),'common':{'name':'Train\x20Security','type':_0x1ecd73(0x19b),'role':_0x1ecd73(0x290),'read':!![],'write':!![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x1f7),{'type':'state','common':{'name':'Train\x20Health','type':_0x1ecd73(0x19b),'role':_0x1ecd73(0x290),'read':!![],'write':!![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x2c3),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x2e5),'type':_0x1ecd73(0x19b),'role':_0x1ecd73(0x290),'read':!![],'write':!![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)]('analysis.training.triggerComfort',{'type':'state','common':{'name':'Train\x20Comfort','type':'boolean','role':_0x1ecd73(0x290),'read':!![],'write':!![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)]('analysis.training.status',{'type':'state','common':{'name':_0x1ecd73(0x2bd),'type':_0x1ecd73(0x207),'role':_0x1ecd73(0x2e8),'read':!![],'write':![]},'native':{}}),await _0x5cd889['extendObjectAsync'](_0x1ecd73(0x191),{'type':'channel','common':{'name':'Security\x20Monitor'},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x2d8),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x24e),'type':_0x1ecd73(0x1fc),'role':_0x1ecd73(0x2b7),'read':!![],'write':![]},'native':{}}),await _0x5cd889['setObjectNotExistsAsync'](_0x1ecd73(0x272),{'type':'state','common':{'name':'Current\x20Threshold','type':_0x1ecd73(0x1fc),'role':_0x1ecd73(0x2b7),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x1d5),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x2ce),'type':_0x1ecd73(0x207),'role':_0x1ecd73(0x267),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x2da)]('analysis.health',{'type':'channel','common':{'name':_0x1ecd73(0x280)},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x29e),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x2ce),'type':'string','role':'date','read':!![],'write':![]},'native':{}}),await _0x5cd889['setObjectNotExistsAsync']('analysis.health.isAnomaly',{'type':'state','common':{'name':_0x1ecd73(0x2e2),'type':_0x1ecd73(0x19b),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)]('analysis.health.trendDiagnosis',{'type':'state','common':{'name':'Trend','type':_0x1ecd73(0x207),'role':_0x1ecd73(0x2e8),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x225),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x28e),'type':_0x1ecd73(0x1fc),'role':_0x1ecd73(0x2b7),'read':!![],'write':![]},'native':{}}),await _0x5cd889['extendObjectAsync'](_0x1ecd73(0x291),{'type':_0x1ecd73(0x28c),'common':{'name':_0x1ecd73(0x1d3)},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x2a4),{'type':'state','common':{'name':_0x1ecd73(0x29f),'type':_0x1ecd73(0x207),'role':_0x1ecd73(0x2e8),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x1c1),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x15f),'type':_0x1ecd73(0x207),'role':'text','read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x2da)]('LTM',{'type':_0x1ecd73(0x28c),'common':{'name':'LTM'},'native':{}}),await _0x5cd889[_0x1ecd73(0x2da)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x1ecd73(0x2a6),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x2da)](LTM_DP_DAILY_DIGESTS,{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x187),'type':'string','role':_0x1ecd73(0x239),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x1fd),{'type':_0x1ecd73(0x248),'common':{'name':'Sequences','type':_0x1ecd73(0x207),'role':_0x1ecd73(0x239),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)]('LTM.trainingData.thermodynamics',{'type':'state','common':{'name':_0x1ecd73(0x1f5),'type':'string','role':_0x1ecd73(0x239),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x2c6),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x2b3),'type':_0x1ecd73(0x19b),'role':_0x1ecd73(0x290),'read':!![],'write':!![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x1cb),{'type':_0x1ecd73(0x248),'common':{'name':'Trigger\x20Briefing','type':'boolean','role':_0x1ecd73(0x290),'read':!![],'write':!![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x179),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x2b6),'type':_0x1ecd73(0x19b),'role':_0x1ecd73(0x301),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x2fd),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x1b1),'type':_0x1ecd73(0x207),'role':_0x1ecd73(0x15a),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x159),{'type':_0x1ecd73(0x248),'common':{'name':'Activity\x20Summary','type':_0x1ecd73(0x207),'role':'text','read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)]('analysis.automation.patternDetected',{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x181),'type':_0x1ecd73(0x19b),'role':_0x1ecd73(0x284),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x264),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x2cf),'type':_0x1ecd73(0x207),'role':_0x1ecd73(0x2e8),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)]('analysis.automation.detectedPatterns',{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x2b8),'type':'string','role':_0x1ecd73(0x239),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x16a),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x170),'type':'string','role':_0x1ecd73(0x2e8),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)]('analysis.automation.targetValue',{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x16f),'type':_0x1ecd73(0x207),'role':_0x1ecd73(0x2e8),'read':!![],'write':![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)](_0x1ecd73(0x21d),{'type':_0x1ecd73(0x248),'common':{'name':_0x1ecd73(0x210),'type':_0x1ecd73(0x19b),'role':'switch','read':!![],'write':!![]},'native':{}}),await _0x5cd889[_0x1ecd73(0x17e)]('analysis.automation.triggerAction',{'type':_0x1ecd73(0x248),'common':{'name':'Trigger\x20Action','type':_0x1ecd73(0x19b),'role':_0x1ecd73(0x290),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x1d2b4){const _0x162af7=a0_0x4555e1;try{const _0x2ad3d3=await _0x1d2b4['getStateAsync'](SYSTEM_DP_MODE);_0x2ad3d3&&_0x2ad3d3[_0x162af7(0x1a2)]&&Object[_0x162af7(0x17a)](SYSTEM_MODES)[_0x162af7(0x192)](_0x2ad3d3[_0x162af7(0x1a2)])?_0x1d2b4[_0x162af7(0x254)]=_0x2ad3d3[_0x162af7(0x1a2)]:(_0x1d2b4[_0x162af7(0x254)]=SYSTEM_MODES[_0x162af7(0x26c)],await _0x1d2b4['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x162af7(0x26c)],'ack':!![]}));}catch(_0x21080e){_0x1d2b4['currentSystemMode']=SYSTEM_MODES[_0x162af7(0x26c)];}}async function loadRawEventLog(_0x587c07){const _0x1a2274=a0_0x4555e1;try{const _0x1a52df=await _0x587c07[_0x1a2274(0x23f)](LTM_DP_RAW_LOG);if(_0x1a52df&&_0x1a52df[_0x1a2274(0x1a2)])_0x587c07[_0x1a2274(0x211)]=JSON['parse'](_0x1a52df[_0x1a2274(0x1a2)]);}catch(_0x384dd2){_0x587c07['rawEventLog']=[];}}async function saveRawEventLog(_0x18da00){const _0x218abf=a0_0x4555e1;if(_0x18da00['rawEventLog']['length']>RAW_LOG_MAX_SIZE)_0x18da00[_0x218abf(0x211)][_0x218abf(0x2e9)](0x0,_0x18da00[_0x218abf(0x211)][_0x218abf(0x1b8)]-RAW_LOG_MAX_SIZE);await _0x18da00['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x218abf(0x296)](_0x18da00['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x5ed188){const _0x5cff7b=a0_0x4555e1;try{const _0x4e0d83=await _0x5ed188['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x4e0d83&&_0x4e0d83[_0x5cff7b(0x1a2)])_0x5ed188[_0x5cff7b(0x238)]=JSON[_0x5cff7b(0x2b1)](_0x4e0d83[_0x5cff7b(0x1a2)]);}catch(_0x3e26f7){_0x5ed188['dailyDigests']=[];}await updateBaselineStatus(_0x5ed188);}async function saveDailyDigests(_0xe94bf2,_0xa66cfd=!![]){const _0x230716=a0_0x4555e1,_0x5324e8=_0xe94bf2[_0x230716(0x252)][_0x230716(0x278)]||0x3c;_0xe94bf2[_0x230716(0x238)]['length']>_0x5324e8&&_0xe94bf2[_0x230716(0x238)]['splice'](0x0,_0xe94bf2[_0x230716(0x238)][_0x230716(0x1b8)]-_0x5324e8);await _0xe94bf2[_0x230716(0x221)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x230716(0x296)](_0xe94bf2['dailyDigests']),'ack':!![]});if(_0xa66cfd)await updateBaselineStatus(_0xe94bf2);}async function updateAnalysisHistory(_0x3b892c,_0x406900){const _0x456f19=a0_0x4555e1;_0x3b892c[_0x456f19(0x246)]['unshift'](_0x406900);if(_0x3b892c[_0x456f19(0x246)]['length']>HISTORY_MAX_SIZE)_0x3b892c[_0x456f19(0x246)][_0x456f19(0x25b)]();await _0x3b892c[_0x456f19(0x221)](_0x456f19(0x209),{'val':JSON[_0x456f19(0x296)](_0x3b892c['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x423618){const _0x11d50a=a0_0x4555e1;if(!_0x423618[_0x11d50a(0x26a)]){await _0x423618[_0x11d50a(0x221)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x449a8c=_0x423618[_0x11d50a(0x238)][_0x11d50a(0x1b8)]>=(_0x423618[_0x11d50a(0x252)][_0x11d50a(0x308)]||0x7)?'Aktiv\x20('+_0x423618['dailyDigests']['length']+_0x11d50a(0x1c5):_0x11d50a(0x27c)+_0x423618['dailyDigests'][_0x11d50a(0x1b8)]+'/'+(_0x423618['config'][_0x11d50a(0x308)]||0x7)+')';await _0x423618[_0x11d50a(0x221)](LTM_DP_BASELINE_STATUS,{'val':_0x449a8c,'ack':!![]});}async function initSensorSubscriptions(_0x19b76f){const _0x33dffe=a0_0x4555e1,_0xf56fe7=_0x19b76f[_0x33dffe(0x252)][_0x33dffe(0x274)];if(_0xf56fe7)for(const _0x3ba735 of _0xf56fe7){await _0x19b76f['subscribeForeignStatesAsync'](_0x3ba735['id']);}}async function initPresenceSubscriptions(_0x515f0d){const _0x1d487b=a0_0x4555e1,_0x1a8cb3=_0x515f0d[_0x1d487b(0x252)][_0x1d487b(0x2d5)];if(_0x1a8cb3)for(const _0x56355a of _0x1a8cb3){await _0x515f0d[_0x1d487b(0x1de)](_0x56355a);}}async function setupTelegramListener(_0x1fd3bf){const _0x4e1684=a0_0x4555e1,_0x594b63=_0x1fd3bf[_0x4e1684(0x252)][_0x4e1684(0x28b)];if(_0x1fd3bf['config']['notifyTelegramEnabled']&&_0x594b63)await _0x1fd3bf[_0x4e1684(0x1de)](_0x594b63+_0x4e1684(0x155));}async function checkWifiPresence(_0xfad391){const _0x441239=a0_0x4555e1;try{const _0x372363=_0xfad391[_0x441239(0x252)]['presenceDevices']||[];let _0xa4653c=![];const _0xce68c9=[];for(const _0x261092 of _0x372363){try{const _0x5e59af=await _0xfad391[_0x441239(0x28d)](_0x261092);_0x5e59af&&(_0x5e59af['val']===!![]||_0x5e59af[_0x441239(0x1a2)]===_0x441239(0x1b4)||_0x5e59af[_0x441239(0x1a2)]===0x1)&&(_0xa4653c=!![],_0xce68c9[_0x441239(0x204)](_0x261092));}catch(_0x1dd07f){}}return await _0xfad391[_0x441239(0x221)](_0x441239(0x2c0),{'val':_0xce68c9['join'](',\x20'),'ack':!![]}),_0xa4653c&&(_0xfad391[_0x441239(0x2eb)]&&(_0xfad391['log']['info'](_0x441239(0x279)),abortExitTimer(_0xfad391)),!_0xfad391['isPresent']&&_0xfad391[_0x441239(0x254)]===SYSTEM_MODES[_0x441239(0x26c)]&&await setPresence(_0xfad391,!![])),_0xa4653c;}catch(_0x17e232){return![];}}function startExitTimer(_0x319038){const _0x13fd2b=a0_0x4555e1;abortExitTimer(_0x319038),_0x319038[_0x13fd2b(0x1cf)]=!![],_0x319038['exitGraceTimer']=setTimeout(()=>{const _0x540aba=_0x13fd2b;_0x319038[_0x540aba(0x1cf)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x319038['exitTimer']=setTimeout(()=>{const _0x1f4a90=_0x13fd2b;setPresence(_0x319038,![]),_0x319038[_0x1f4a90(0x2eb)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x55ea03){const _0x5d0528=a0_0x4555e1;if(_0x55ea03[_0x5d0528(0x2eb)])clearTimeout(_0x55ea03[_0x5d0528(0x2eb)]);if(_0x55ea03[_0x5d0528(0x1c2)])clearTimeout(_0x55ea03[_0x5d0528(0x1c2)]);_0x55ea03['exitTimer']=null,_0x55ea03[_0x5d0528(0x1c2)]=null,_0x55ea03[_0x5d0528(0x1cf)]=![];}function a0_0x50bc(){const _0xc4dc3d=['log','Train\x20Energy','weatherunderground','.forecast.current.temp','text','splice','TRAIN_ENERGY','exitTimer','subscribeStates','üß™\x20Simulating\x20Butler\x20Proposal:\x20','LTM\x20Sched\x20Error:\x20','OK:\x20','useCalendar','Restoring\x20sensor\x20cache...','analysis.automation.detectedPatterns','schalter','.forecast.current.temperature','‚ùå\x20VENV\x20FAILED:\x20','analysis.automation.targetValue','0\x204\x20*\x20*\x20*','licenseKey','analysisTimer','Drift\x20Sched\x20Error:\x20','sendToAsync','.forecast.current.state','analysis.alertReason','Kein\x20API\x20Key!','system.isPresent','LTM.driftAnalysis.baselineDrift','indicator.alarm','close','Gemini\x20Init\x20Error:\x20','üß†\x20Triggering\x20Security\x20Training...','getTime','fill','Gemini\x20AI\x20initialized.','minDaysForBaseline','PRIORIT√ÑT:\x20Gesundheit/AAL.','role','analysis.training.triggerComfort','bind','now','ready','.communicate.request','getMinutes','python.exe','briefingEnabled','analysis.activitySummary','text.alarm','LTM.triggerDailyDigest','‚ö†Ô∏è\x20ALARM:\x20','dimmer','type','Heating\x20Score','2214IJOdBb','LTM.driftAnalysis.lastCheck','.Current.Temperature','toISOString','enum.functions.*','No\x20instance','temperature','.Current.WeatherText','Failed:\x20','window','analysis.automation.targetId','N/A\x20(Learning)','1046TecWnV','round','697440gLGPTk','Target\x20Value','Target\x20ID','2100342bMJFdr','city','@google/generative-ai','temperatur','analysis.lastResult','scanDevices','path','@iobroker/adapter-core','analysis.isAlert','values','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','getDate','.\x20EVENTS:\x20','setObjectNotExistsAsync','Gemini\x20Error:\x20','[PYTHON]\x20','Pattern\x20Detected','AI\x20Training','door','diagnosis','openweathermap','Cogni-Living','Daily\x20Digests','analysis.training.triggerSecurity','cogni-living','TRAINING_COMPLETE','setState','driftAnalysisTimer','events.history_debug_00','driftDetails','detected','.\x20KONTEXT:\x20','analysis.security','includes','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','getMonth','threshold','3812DQUtWM','ack','setHours','error','write','boolean','python','.\x20ANWESEND:\x20','shift','telegram','dependencyInstallInProgress','search','val','writable','existsSync','.\x20WETTER:\x20','getFullYear','ANALYZE_HEALTH','Keine\x20Termine.','LTM.processingStatus','Unbekannt','description','heizung','endsWith','isPresent','Error\x20launching\x20Python:\x20','\x20->\x20','Alert\x20Reason','status','geminiModel','online','getForeignObjectAsync','Installing\x20pip\x20packages...','some','length','Event\x20History','calendarInstance','livingContext','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','User\x20dismissed\x20automation\x20proposal.','presence','LTM.trainingData.thermodynamics','bewegung','analysis.energy.heatingScore','exitGraceTimer','onUnload','licht','\x20Tage)','.NextHours.Location_1.Day_1.current.temp_value','requirements.txt','timestamp','info','PARTY','analysis.triggerBriefing','map','Scripts','accuweather','isGracePeriodActive','substring','generateContent','307GyPASm','Energy\x20Intelligence','stdin','analysis.security.lastCheck','analysis.health.isAnomaly','setForeignStateAsync','ENERGY_TRAIN_RESULT','object','light','autoApply','vacation','callback','subscribeForeignStatesAsync','kontakt','slice','onMessage','rule','8235337jEQKmw','expire','geminiApiKey','location','Missing\x20data','motion','guest','Activity-Level','üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','generic','¬∞C,\x20','sensorLastValues','split','notifyPushoverInstance','Success','System\x20Mode','toLocaleTimeString','targetId','Thermodynamics','floor','analysis.training.triggerHealth','system','service.py','submitFeedback','notifyEmailRecipient','number','LTM.trainingData.sequences','Unknown','Fokus\x20auf\x20Komfort.','warn','‚úÖ\x20Alles\x20OK\x20(Reset)','models/gemini-flash-latest','logDuplicates','push','loc','constructor','string','lampe','analysis.analysisHistory','node-schedule','‚ùå\x20INSTALL\x20FAILED:\x20','system.config','sound','getHours','(((.+)+)+)+$','Auto\x20Apply','rawEventLog','unknown','analysis.training','COMFORT_RESULT','‚úÖ\x20INSTALL\x20SUCCESS.','14GtboPH','scheduleJob','pr√§senz','toString','analysis.automation.patternDetected','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','occupancy','analysis.automation.autoApply','testApiKey','08:00','üìù\x20Feedback\x20received:\x20','setStateAsync','24XpvDMS','command','VACATION','analysis.health.trendValue','[RECORDER]\x20Error:\x20','modeResetJob','Adapter','namespace','replace','instance','toFixed','trim','Fokus\x20auf\x20Familienroutinen.','payload','triggerDailyDigest','normal','apply','longitude','switch','confidence','klima','doors','dailyDigests','json','analysis.health.trendDiagnosis','systemConfig','\x20=\x20','debug','ltmJob','getStateAsync','GUEST','566754ZgJssN','üõãÔ∏è\x20BUTLER:\x20Found\x20','PRIORIT√ÑT:\x20Sicherheit.','cancel','events.lastEvent','analysisHistory','targetValue','state','Vom\x20Benutzer\x20best√§tigt\x20(OK).','Err:\x20','System','ltmDriftCheckIntervalHours','isEmergency','Anomaly\x20Score','win32','HEALTH_TRAIN_RESULT','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','config','t√ºr','currentSystemMode','useWeather','latitude','notifyPushoverEnabled','analysis.automation.triggerAction','‚ö†Ô∏è\x20Python\x20VENV\x20missing.\x20Installing\x20locally...','join','pop','ltmStbWindowDays','outdoorSensorId','üåÖ\x20Morning\x20Briefing:\x0a','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.',')\x20-\x20SAFE\x20BOOT','TRAIN_COMFORT','ANOMALY','forEach','analysis.automation.description','weatherInstance','COGNI_CONFIRM_OK','date','Last\x20raw\x20event','contact','isProVersion','exports','NORMAL','bin','alertReason','onStateChange','.\x20SYSTEM_MODE:\x20','LTM.rawEventLog','analysis.security.currentThreshold','from','devices','dismissAutomation','summary','is_anomaly','ltmLtbWindowDays','WiFi\x20Presence\x20detected.','events.history','0\x203\x20*\x20*\x20*','Lernphase\x20(','Kalender\x20deaktiviert.','fenster','toLowerCase','Health\x20Analysis','SECURITY_RESULT','\x0aSTB:\x20','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','indicator','pip','onReady','systemUUID','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','application/json','data','notifyTelegramInstance','channel','getForeignStateAsync','Trend\x20Value','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','button','analysis.energy','ANALYZE_SEQUENCE','send','startsWith','notifyTelegramRecipient','stringify','eventHistory','inactivityThresholdHours','genAI','find','change_percent','Briefing\x20Sched\x20Error:\x20','system.mode','analysis.health.lastCheck','Insulation\x20Score','activityLevel','N/A','unshift','KI-Modell\x20nicht\x20initialisiert','analysis.energy.insulationScore','ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...','Raw\x20Log','LTM.baselineStatus','üîç\x20Scanning\x20for\x20devices...','aiPersona','\x20new\x20patterns.','lastAlertState','analysis.history_debug_00','briefingJob','response','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','apiKey','parse','analysisInterval','Trigger\x20Analysis','automationProposal','pythonProcess','Alert\x20Status','value','Detected\x20Patterns','message','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','TRAIN_SECURITY','22640AnawcR','Training\x20Status','getCalendarNames','siren','system.presenceWho','common','retry','analysis.training.triggerEnergy','Who\x20is\x20present?','‚úÖ\x20HEALTH\x20TRAINED.','analysis.trigger','python_service','sendTo','heating','details','LTM.dailyDigests','daswetter','name','Last\x20Check','Description','cogni-living\x20adapter\x20starting\x20(v','Wetterdaten\x20deaktiviert.','simulateButler','success','python3\x20-m\x20venv\x20\x22','presenceDevices','Keine\x20Wetterdaten\x20verf√ºgbar.','getForeignObjectsAsync','analysis.security.lastScore','notifyTelegramEnabled','extendObjectAsync','pip.exe','4220sLWZCc','testContext','party','LTM.driftAnalysis.driftDetails','insulation','analysis.training.status','Anomaly\x20Detected','PONG'];a0_0x50bc=function(){return _0xc4dc3d;};return a0_0x50bc();}async function setPresence(_0x1c4709,_0x2ecc3c){const _0x1aa75d=a0_0x4555e1;if(_0x1c4709[_0x1aa75d(0x1ae)]===_0x2ecc3c)return;_0x1c4709[_0x1aa75d(0x1ae)]=_0x2ecc3c,await _0x1c4709[_0x1aa75d(0x221)](_0x1aa75d(0x2ff),{'val':_0x2ecc3c,'ack':!![]});}async function executeAutomationAction(_0x1f69ed){const _0x4a0441=a0_0x4555e1;try{const _0x2ade28=await _0x1f69ed['getStateAsync'](_0x4a0441(0x16a)),_0x1140c6=await _0x1f69ed[_0x4a0441(0x23f)](_0x4a0441(0x2f6));if(_0x2ade28&&_0x2ade28[_0x4a0441(0x1a2)]&&_0x1140c6){const _0xc9b698=_0x2ade28['val'];let _0x28ef76=_0x1140c6['val'];try{_0x28ef76=JSON['parse'](_0x28ef76);}catch(_0x30fca1){}_0x1f69ed['log'][_0x4a0441(0x1c9)]('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0xc9b698+_0x4a0441(0x23c)+_0x28ef76),await _0x1f69ed[_0x4a0441(0x1d7)](_0xc9b698,_0x28ef76);}else _0x1f69ed['log']['warn'](_0x4a0441(0x1bc));}catch(_0x688442){_0x1f69ed['log'][_0x4a0441(0x199)]('BUTLER\x20Execution\x20Error:\x20'+_0x688442[_0x4a0441(0x2b9)]);}}async function processSensorEvent(_0xc40a48,_0x8b1970,_0x4e58a0,_0x384c8e){const _0x3eb2ad=a0_0x4555e1;if(!_0x384c8e)return;const _0x455284=_0x4e58a0[_0x3eb2ad(0x1a2)],_0x3c82fc=Date[_0x3eb2ad(0x153)](),_0x159f6f=_0xc40a48['sensorLastValues'][_0x8b1970];_0xc40a48[_0x3eb2ad(0x1ee)][_0x8b1970]=_0x455284;if(!_0x384c8e[_0x3eb2ad(0x203)]&&_0x159f6f!=undefined&&_0x159f6f==_0x455284)return;const _0x25e227=(_0x384c8e[_0x3eb2ad(0x15e)]||'')['toLowerCase'](),_0x2694d8=_0x25e227[_0x3eb2ad(0x192)]('temperature')||_0x25e227['includes'](_0x3eb2ad(0x174))||_0x25e227[_0x3eb2ad(0x192)](_0x3eb2ad(0x236))||_0x25e227[_0x3eb2ad(0x192)](_0x3eb2ad(0x1ac));_0xc40a48[_0x3eb2ad(0x26a)]&&_0x2694d8&&recordThermodynamics(_0xc40a48,_0x8b1970,_0x455284,_0x384c8e[_0x3eb2ad(0x1e6)]);const _0x2ef45c={'timestamp':_0x3c82fc,'id':_0x8b1970,'name':_0x384c8e[_0x3eb2ad(0x2cd)],'type':_0x384c8e[_0x3eb2ad(0x15e)],'location':_0x384c8e[_0x3eb2ad(0x1e6)],'value':_0x455284};_0xc40a48['eventHistory'][_0x3eb2ad(0x2a2)](_0x2ef45c);if(_0xc40a48[_0x3eb2ad(0x297)][_0x3eb2ad(0x1b8)]>HISTORY_MAX_SIZE)_0xc40a48[_0x3eb2ad(0x297)][_0x3eb2ad(0x25b)]();await _0xc40a48[_0x3eb2ad(0x221)](_0x3eb2ad(0x245),{'val':JSON['stringify'](_0x2ef45c),'ack':!![]}),await _0xc40a48[_0x3eb2ad(0x221)](_0x3eb2ad(0x27a),{'val':JSON['stringify'](_0xc40a48[_0x3eb2ad(0x297)]),'ack':!![]});_0xc40a48['isProVersion']&&(_0xc40a48[_0x3eb2ad(0x211)][_0x3eb2ad(0x204)](_0x2ef45c),await saveRawEventLog(_0xc40a48),recordSequence(_0xc40a48,_0x2ef45c));if(_0x384c8e['isExit']&&_0x455284===!![]){if(_0xc40a48['isPresent']&&!_0xc40a48[_0x3eb2ad(0x1cf)])startExitTimer(_0xc40a48);else{if(!_0xc40a48['isPresent'])setPresence(_0xc40a48,!![]);}}else{if(_0x384c8e[_0x3eb2ad(0x15e)]===_0x3eb2ad(0x1e8)&&_0x455284===!![]){if(_0xc40a48[_0x3eb2ad(0x2eb)])abortExitTimer(_0xc40a48);if(!_0xc40a48[_0x3eb2ad(0x1ae)]&&_0xc40a48[_0x3eb2ad(0x254)]===SYSTEM_MODES[_0x3eb2ad(0x26c)])setPresence(_0xc40a48,!![]);}}}async function recordThermodynamics(_0x3b81b8,_0x21bae3,_0x3368c9,_0x5e6d5d){const _0x1393ae=a0_0x4555e1,_0x421ac2=await getOutsideTemperatureNumeric(_0x3b81b8),_0x19d729=await _0x3b81b8['getStateAsync']('LTM.trainingData.thermodynamics');let _0x1fb55e=[];if(_0x19d729&&_0x19d729[_0x1393ae(0x1a2)])try{_0x1fb55e=JSON[_0x1393ae(0x2b1)](_0x19d729[_0x1393ae(0x1a2)]);}catch(_0xe34e36){}_0x1fb55e[_0x1393ae(0x204)]({'ts':Date['now'](),'room':_0x5e6d5d||_0x1393ae(0x1fe),'t_in':_0x3368c9,'t_out':_0x421ac2});if(_0x1fb55e['length']>THERMO_LOG_SIZE)_0x1fb55e[_0x1393ae(0x19e)]();await _0x3b81b8[_0x1393ae(0x221)](_0x1393ae(0x1bf),{'val':JSON['stringify'](_0x1fb55e),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x384e88){const _0x3a57ae=a0_0x4555e1;if(_0x384e88[_0x3a57ae(0x252)][_0x3a57ae(0x25d)])try{const _0x92c192=await _0x384e88['getForeignStateAsync'](_0x384e88[_0x3a57ae(0x252)][_0x3a57ae(0x25d)]);if(_0x92c192&&_0x92c192['val']!==undefined&&_0x92c192['val']!==null)return parseFloat(_0x92c192[_0x3a57ae(0x1a2)]);}catch(_0x443931){}const _0x43272e=_0x384e88[_0x3a57ae(0x252)][_0x3a57ae(0x265)];if(!_0x384e88[_0x3a57ae(0x252)]['useWeather']||!_0x43272e)return null;try{let _0x557802='';if(_0x43272e['includes'](_0x3a57ae(0x1ce)))_0x557802=_0x43272e+_0x3a57ae(0x162);else{if(_0x43272e[_0x3a57ae(0x192)](_0x3a57ae(0x2cc)))_0x557802=_0x43272e+_0x3a57ae(0x1c6);else{if(_0x43272e['includes'](_0x3a57ae(0x185)))_0x557802=_0x43272e+_0x3a57ae(0x2f4);else{if(_0x43272e[_0x3a57ae(0x192)](_0x3a57ae(0x2e6)))_0x557802=_0x43272e+_0x3a57ae(0x2e7);}}}if(_0x557802){const _0x1e8bfd=await _0x384e88[_0x3a57ae(0x28d)](_0x557802);if(_0x1e8bfd&&_0x1e8bfd[_0x3a57ae(0x1a2)]!==undefined&&_0x1e8bfd[_0x3a57ae(0x1a2)]!==null)return parseFloat(_0x1e8bfd[_0x3a57ae(0x1a2)]);}}catch(_0x340f0b){}return null;}async function recordSequence(_0x2f840f,_0x6f8ac9){const _0x1905bf=a0_0x4555e1,_0x78603d=(_0x6f8ac9[_0x1905bf(0x15e)]||'')[_0x1905bf(0x27f)](),_0x4a8502=[_0x1905bf(0x1e8),_0x1905bf(0x1c0),_0x1905bf(0x218),_0x1905bf(0x1be),_0x1905bf(0x21c),'door',_0x1905bf(0x253),_0x1905bf(0x169),_0x1905bf(0x27e),_0x1905bf(0x269),_0x1905bf(0x1df),_0x1905bf(0x1da),_0x1905bf(0x1c4),_0x1905bf(0x234),_0x1905bf(0x2f3),_0x1905bf(0x15d),_0x1905bf(0x208)];if(!_0x4a8502[_0x1905bf(0x1b7)](_0x23e662=>_0x78603d[_0x1905bf(0x192)](_0x23e662)))return;if(!_0x6f8ac9[_0x1905bf(0x2b7)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x6f8ac9['location']||'Unknown','id':_0x6f8ac9['id'],'ts':Date[_0x1905bf(0x153)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x2f840f);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x252503){const _0x16e769=a0_0x4555e1;try{const _0x2dbd29=await _0x252503['getStateAsync'](_0x16e769(0x1fd));let _0x531e40=[];if(_0x2dbd29&&_0x2dbd29[_0x16e769(0x1a2)])try{_0x531e40=JSON[_0x16e769(0x2b1)](_0x2dbd29[_0x16e769(0x1a2)]);}catch(_0x536604){}const _0x331d14=activeSequence[0x0]['ts'],_0x562887=activeSequence[_0x16e769(0x1cc)](_0x24b0be=>({'loc':_0x24b0be[_0x16e769(0x205)],'t_delta':Math[_0x16e769(0x16d)]((_0x24b0be['ts']-_0x331d14)/0x3e8)})),_0x52a625={'timestamp':new Date(_0x331d14)['toISOString'](),'steps':_0x562887,'duration':Math[_0x16e769(0x16d)]((activeSequence[activeSequence[_0x16e769(0x1b8)]-0x1]['ts']-_0x331d14)/0x3e8),'daytime':new Date(_0x331d14)['getHours']()};_0x531e40[_0x16e769(0x204)](_0x52a625);if(_0x531e40['length']>MAX_TRAINING_SET_SIZE)_0x531e40[_0x16e769(0x19e)]();await _0x252503[_0x16e769(0x221)](_0x16e769(0x1fd),{'val':JSON[_0x16e769(0x296)](_0x531e40),'ack':!![]}),runSecurityCheck(_0x252503,_0x52a625);}catch(_0x4a70b8){_0x252503['log'][_0x16e769(0x199)](_0x16e769(0x226)+_0x4a70b8[_0x16e769(0x2b9)]);}}function runSecurityCheck(_0x2bc082,_0x341088){const _0x289edf=a0_0x4555e1;if(!_0x2bc082[_0x289edf(0x26a)])return;sendToPython(_0x2bc082,_0x289edf(0x292),{'sequence':_0x341088});}function sendToPython(_0x1897c9,_0x162e7a,_0xdc9cd5={}){const _0x3d41ad=a0_0x4555e1;if(!_0x1897c9[_0x3d41ad(0x2b5)]||!_0x1897c9['pythonProcess'][_0x3d41ad(0x1d4)][_0x3d41ad(0x1a3)])return;const _0x2e2593=JSON[_0x3d41ad(0x296)]({'command':_0x162e7a,..._0xdc9cd5});try{_0x1897c9[_0x3d41ad(0x2b5)][_0x3d41ad(0x1d4)][_0x3d41ad(0x19a)](_0x2e2593+'\x0a');}catch(_0x3b659c){}}function startPythonService(_0x34a6f2){const _0x59efc8=a0_0x4555e1;let _0x1e85fb='python3';if(fs[_0x59efc8(0x1a4)](PYTHON_EXE))_0x1e85fb=PYTHON_EXE;try{const _0x2d4b3d=path[_0x59efc8(0x25a)](__dirname,_0x59efc8(0x2c7),_0x59efc8(0x1f9));_0x34a6f2[_0x59efc8(0x2b5)]=spawn(_0x1e85fb,[_0x2d4b3d]),_0x34a6f2['pythonProcess']['stdout']['on'](_0x59efc8(0x28a),_0x39baa9=>{const _0x10e5f6=_0x59efc8,_0x4b297e=_0x39baa9[_0x10e5f6(0x219)]()[_0x10e5f6(0x1ef)]('\x0a');_0x4b297e[_0x10e5f6(0x263)](_0x51c1ba=>{const _0x15f174=_0x10e5f6,_0x25bd63=_0x51c1ba[_0x15f174(0x22d)]();if(!_0x25bd63)return;if(_0x25bd63['startsWith']('[LOG]'))_0x34a6f2[_0x15f174(0x2e4)][_0x15f174(0x23d)](_0x15f174(0x180)+_0x25bd63[_0x15f174(0x1d0)](0x5)[_0x15f174(0x22d)]());else{if(_0x25bd63[_0x15f174(0x294)]('[RESULT]'))try{const _0x38c022=JSON[_0x15f174(0x2b1)](_0x25bd63[_0x15f174(0x1d0)](0x8)[_0x15f174(0x22d)]());handlePythonResult(_0x34a6f2,_0x38c022);}catch(_0x806ed6){}}});}),_0x34a6f2[_0x59efc8(0x2b5)]['on'](_0x59efc8(0x302),_0x1b657f=>{const _0x104dad=_0x59efc8;_0x34a6f2[_0x104dad(0x2b5)]=null;});}catch(_0x3c9093){_0x34a6f2['log']['error'](_0x59efc8(0x1af)+_0x3c9093[_0x59efc8(0x2b9)]);}}function stopPythonService(_0x1ae86c){const _0xf53a38=a0_0x4555e1;if(_0x1ae86c['pythonProcess']){try{_0x1ae86c[_0xf53a38(0x2b5)]['kill']();}catch(_0x14dd64){}_0x1ae86c[_0xf53a38(0x2b5)]=null;}}function handlePythonResult(_0x8ebea0,_0x2ed6e3){const _0x557481=a0_0x4555e1;if(_0x2ed6e3[_0x557481(0x15e)]===_0x557481(0x2e3))_0x8ebea0[_0x557481(0x2e4)][_0x557481(0x23d)]('üêç\x20Python\x20Pong');else{if(_0x2ed6e3['type']===_0x557481(0x281)){const {anomaly_score:_0x2b95a3,is_anomaly:_0x55b11b,threshold:_0x163d12,explanation:_0x54ee29}=_0x2ed6e3[_0x557481(0x22f)];_0x8ebea0[_0x557481(0x2e4)][_0x557481(0x1c9)](_0x557481(0x2af)+_0x2b95a3[_0x557481(0x22c)](0x5)+_0x557481(0x1b0)+(_0x55b11b?_0x557481(0x262):'OK')),_0x8ebea0[_0x557481(0x221)](_0x557481(0x2d8),{'val':_0x2b95a3,'ack':!![]}),_0x8ebea0[_0x557481(0x221)](_0x557481(0x1d5),{'val':new Date()[_0x557481(0x163)](),'ack':!![]});if(_0x163d12)_0x8ebea0[_0x557481(0x221)](_0x557481(0x272),{'val':_0x163d12,'ack':!![]});if(_0x55b11b){let _0x1ba729=_0x557481(0x283)+_0x2b95a3[_0x557481(0x22c)](0x4)+')';if(_0x54ee29&&_0x54ee29!=='Unknown')_0x1ba729+='\x0aGrund:\x20'+_0x54ee29;_0x8ebea0['setStateAsync']('analysis.isAlert',{'val':!![],'ack':!![]}),_0x8ebea0['setStateAsync'](_0x557481(0x2fd),{'val':_0x1ba729,'ack':!![]}),sendNotification(_0x8ebea0,'‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20'+_0x1ba729,![],!![]);}}else{if(_0x2ed6e3['type']===_0x557481(0x18a)){const _0x54d0a3=_0x2ed6e3[_0x557481(0x22f)][_0x557481(0x2ca)]||'',_0x1d480b=_0x2ed6e3[_0x557481(0x22f)][_0x557481(0x195)],_0x2c23eb=_0x2ed6e3[_0x557481(0x22f)][_0x557481(0x2d3)]?'Success:\x20'+new Date()[_0x557481(0x1f3)]()+'\x20('+_0x54d0a3+')':_0x557481(0x168)+_0x2ed6e3['payload']['reason'];_0x8ebea0[_0x557481(0x221)](_0x557481(0x2e1),{'val':_0x2c23eb,'ack':!![]});if(_0x2ed6e3[_0x557481(0x22f)][_0x557481(0x2d3)]&&_0x1d480b)_0x8ebea0[_0x557481(0x221)](_0x557481(0x272),{'val':_0x1d480b,'ack':!![]});}else{if(_0x2ed6e3[_0x557481(0x15e)]===_0x557481(0x214)){const {patterns:_0x4227d8}=_0x2ed6e3[_0x557481(0x22f)];if(_0x4227d8&&_0x4227d8['length']>0x0){_0x8ebea0[_0x557481(0x2e4)]['info'](_0x557481(0x242)+_0x4227d8[_0x557481(0x1b8)]+_0x557481(0x2aa)),_0x8ebea0['setStateAsync'](_0x557481(0x2f2),{'val':JSON[_0x557481(0x296)](_0x4227d8),'ack':!![]});const _0x18d5e7=_0x4227d8[0x0],_0x45f974='Regel\x20erkannt:\x20'+_0x18d5e7[_0x557481(0x1e2)]+'\x20('+(_0x18d5e7[_0x557481(0x235)]*0x64)['toFixed'](0x0)+'%)';_0x8ebea0[_0x557481(0x221)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),_0x8ebea0['setStateAsync'](_0x557481(0x264),{'val':_0x45f974,'ack':!![]});}else _0x8ebea0[_0x557481(0x2e4)][_0x557481(0x1c9)]('üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x8ebea0[_0x557481(0x221)](_0x557481(0x21a),{'val':![],'ack':!![]}),_0x8ebea0[_0x557481(0x221)](_0x557481(0x2f2),{'val':'[]','ack':!![]});}else{if(_0x2ed6e3['type']===_0x557481(0x1d8)){if(_0x2ed6e3['payload'][_0x557481(0x2d3)])try{const _0xe6b93e=JSON['parse'](_0x2ed6e3['payload'][_0x557481(0x2ca)]);if(_0xe6b93e['insulation'])_0x8ebea0[_0x557481(0x221)]('analysis.energy.insulationScore',{'val':JSON['stringify'](_0xe6b93e[_0x557481(0x2e0)]),'ack':!![]});if(_0xe6b93e[_0x557481(0x2c9)])_0x8ebea0[_0x557481(0x221)](_0x557481(0x1c1),{'val':JSON[_0x557481(0x296)](_0xe6b93e['heating']),'ack':!![]});}catch(_0x376944){}}else{if(_0x2ed6e3['type']===_0x557481(0x250)){if(_0x2ed6e3['payload']['success'])_0x8ebea0['log']['info'](_0x557481(0x2c5));}else{if(_0x2ed6e3[_0x557481(0x15e)]==='HEALTH_RESULT')_0x8ebea0[_0x557481(0x221)](_0x557481(0x29e),{'val':new Date()['toISOString'](),'ack':!![]}),_0x8ebea0[_0x557481(0x221)](_0x557481(0x1d6),{'val':_0x2ed6e3['payload'][_0x557481(0x277)],'ack':!![]});else _0x2ed6e3[_0x557481(0x15e)]==='TREND_RESULT'&&(_0x8ebea0[_0x557481(0x221)](_0x557481(0x23a),{'val':_0x2ed6e3[_0x557481(0x22f)][_0x557481(0x184)],'ack':!![]}),_0x8ebea0[_0x557481(0x221)](_0x557481(0x225),{'val':_0x2ed6e3[_0x557481(0x22f)][_0x557481(0x29b)],'ack':!![]}));}}}}}}}function runPythonHealthCheck(_0x4d68dc){const _0xbf3747=a0_0x4555e1;if(!_0x4d68dc[_0xbf3747(0x238)]||_0x4d68dc['dailyDigests'][_0xbf3747(0x1b8)]<0x2)return;const _0x240f92=_0x4d68dc['dailyDigests']['map'](_0xa3f62e=>{const _0x65197e=(_0xa3f62e['activityLevel']||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x65197e]||0x32;});sendToPython(_0x4d68dc,'ANALYZE_TREND',{'values':_0x240f92,'tag':_0xbf3747(0x1ea)});}async function handleTelegramResponse(_0xfc6552,_0xe593bb){const _0x530605=a0_0x4555e1;let _0x3dada2=_0xe593bb;_0xe593bb['startsWith']('[')&&(_0x3dada2=_0xe593bb[_0x530605(0x1d0)](_0xe593bb['indexOf'](']')+0x1));if(_0x3dada2===_0x530605(0x266))await _0xfc6552['setStateAsync'](_0x530605(0x179),{'val':![],'ack':!![]}),await _0xfc6552['setStateAsync'](_0x530605(0x2fd),{'val':_0x530605(0x249),'ack':!![]}),_0xfc6552['lastAlertState']=![],sendNotification(_0xfc6552,_0x530605(0x25f),![]);else _0x3dada2==='COGNI_REQUEST_CALL'&&sendNotification(_0xfc6552,_0x530605(0x2ba),![],!![]);}async function sendNotification(_0xf4f7a6,_0x3e1616,_0x539f40=![],_0x209574=![]){const _0x1f683d=a0_0x4555e1,_0x35a073=_0xf4f7a6['config'];if(_0x35a073[_0x1f683d(0x2d9)]){let _0x184293={};(_0x3e1616[_0x1f683d(0x192)]('Alarm')||_0x209574)&&(_0x184293={'reply_markup':{'inline_keyboard':[[{'text':_0x1f683d(0x201),'callback_data':_0x1f683d(0x266)}],[{'text':'üìû\x20R√ºckruf\x20anfordern','callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0xf4f7a6['sendToAsync'](_0x35a073[_0x1f683d(0x28b)],_0x1f683d(0x293),{'text':_0x3e1616,'user':_0x35a073[_0x1f683d(0x295)],..._0x184293});}if(_0x35a073[_0x1f683d(0x257)]){let _0x1a32bf={'message':_0x3e1616,'title':_0x209574?'üö®\x20EMERGENCY':_0x1f683d(0x186),'priority':_0x209574?0x2:0x1,'device':_0x35a073['notifyPushoverRecipient']};_0x209574&&(_0x1a32bf[_0x1f683d(0x2c2)]=0x1e,_0x1a32bf[_0x1f683d(0x1e4)]=0xe10,_0x1a32bf[_0x1f683d(0x20d)]=_0x1f683d(0x2bf)),await _0xf4f7a6[_0x1f683d(0x2fb)](_0x35a073[_0x1f683d(0x1f0)],_0x1f683d(0x293),_0x1a32bf);}_0x35a073['notifyEmailEnabled']&&await _0xf4f7a6[_0x1f683d(0x2fb)](_0x35a073['notifyEmailInstance'],_0x1f683d(0x293),{'text':_0x3e1616,'to':_0x35a073[_0x1f683d(0x1fb)]});}async function runGeminiAnalysis(_0x2d3090,_0x25854c=''){const _0x4bfd7e=a0_0x4555e1;if(!_0x2d3090['geminiModel'])return;if(_0x2d3090[_0x4bfd7e(0x297)][_0x4bfd7e(0x1b8)]===0x0)return;const _0x572a9f=_0x2d3090[_0x4bfd7e(0x297)]['slice'](0x0,0xf),_0x1d2e13=await getWeatherContext(_0x2d3090),_0x1e697d=_0x2d3090[_0x4bfd7e(0x254)],_0x1092c1=PERSONA_MAPPING[_0x2d3090[_0x4bfd7e(0x252)][_0x4bfd7e(0x2a9)]||_0x4bfd7e(0x1ec)],_0x39fcc1=_0x2d3090[_0x4bfd7e(0x252)][_0x4bfd7e(0x1bb)]||'Keine\x20Details.';let _0x4ec065=_0x4bfd7e(0x1aa);try{const _0x1bded3=await _0x2d3090[_0x4bfd7e(0x23f)](_0x4bfd7e(0x2c0));if(_0x1bded3&&_0x1bded3[_0x4bfd7e(0x1a2)])_0x4ec065=_0x1bded3[_0x4bfd7e(0x1a2)];}catch(_0x3d35b7){}let _0x38367b=![];try{const _0x2ff0eb=await _0x2d3090['getStateAsync'](_0x4bfd7e(0x21d));if(_0x2ff0eb&&_0x2ff0eb[_0x4bfd7e(0x1a2)])_0x38367b=!![];}catch(_0x12febf){}const _0x3742a6=_0x4bfd7e(0x251)+_0x1092c1+_0x4bfd7e(0x190)+_0x39fcc1+_0x4bfd7e(0x270)+_0x1e697d+_0x4bfd7e(0x1a5)+_0x1d2e13+_0x4bfd7e(0x19d)+_0x4ec065+_0x4bfd7e(0x17d)+JSON[_0x4bfd7e(0x296)](_0x572a9f)+'.\x20EMERGENCY:\x20'+_0x25854c+_0x4bfd7e(0x193);try{const _0x57f912=await _0x2d3090[_0x4bfd7e(0x1b3)][_0x4bfd7e(0x1d1)](_0x3742a6),_0x52f01a=JSON['parse'](_0x57f912[_0x4bfd7e(0x2ae)][_0x4bfd7e(0x2e8)]()[_0x4bfd7e(0x22a)](/```json|```/g,'')[_0x4bfd7e(0x22d)]());await _0x2d3090[_0x4bfd7e(0x221)](_0x4bfd7e(0x175),{'val':JSON[_0x4bfd7e(0x296)](_0x52f01a),'ack':!![]});if(_0x52f01a['summary'])await _0x2d3090[_0x4bfd7e(0x221)](_0x4bfd7e(0x159),{'val':_0x52f01a[_0x4bfd7e(0x276)],'ack':!![]});const _0x295525={'timestamp':Date[_0x4bfd7e(0x153)](),'id':Date[_0x4bfd7e(0x153)]()[_0x4bfd7e(0x219)](),'analysis':{'activity':{'summary':_0x52f01a['summary'],'isAlert':_0x52f01a['isAlert'],'alertReason':_0x52f01a[_0x4bfd7e(0x26e)]},'comfort':{'automationProposal':_0x52f01a[_0x4bfd7e(0x2b4)]}}};await updateAnalysisHistory(_0x2d3090,_0x295525);const _0x320fb0=_0x52f01a['isAlert']||![];_0x320fb0!==_0x2d3090[_0x4bfd7e(0x2ab)]&&(await _0x2d3090[_0x4bfd7e(0x221)]('analysis.isAlert',{'val':_0x320fb0,'ack':!![]}),_0x2d3090[_0x4bfd7e(0x2ab)]=_0x320fb0,_0x320fb0&&(await _0x2d3090[_0x4bfd7e(0x221)](_0x4bfd7e(0x2fd),{'val':_0x52f01a[_0x4bfd7e(0x26e)],'ack':!![]}),sendNotification(_0x2d3090,_0x4bfd7e(0x15c)+_0x52f01a[_0x4bfd7e(0x26e)],![],_0x52f01a[_0x4bfd7e(0x24d)])));if(_0x52f01a[_0x4bfd7e(0x2b4)]&&_0x52f01a[_0x4bfd7e(0x2b4)][_0x4bfd7e(0x18f)]){await _0x2d3090[_0x4bfd7e(0x221)](_0x4bfd7e(0x21a),{'val':!![],'ack':!![]}),await _0x2d3090[_0x4bfd7e(0x221)](_0x4bfd7e(0x264),{'val':_0x52f01a[_0x4bfd7e(0x2b4)][_0x4bfd7e(0x1ab)],'ack':!![]}),await _0x2d3090[_0x4bfd7e(0x221)](_0x4bfd7e(0x16a),{'val':_0x52f01a[_0x4bfd7e(0x2b4)][_0x4bfd7e(0x1f4)],'ack':!![]}),await _0x2d3090['setStateAsync']('analysis.automation.targetValue',{'val':JSON[_0x4bfd7e(0x296)](_0x52f01a['automationProposal'][_0x4bfd7e(0x247)]),'ack':!![]});if(_0x38367b)executeAutomationAction(_0x2d3090);}}catch(_0xbd4bd4){_0x2d3090[_0x4bfd7e(0x2e4)][_0x4bfd7e(0x199)](_0x4bfd7e(0x17f)+_0xbd4bd4[_0x4bfd7e(0x2b9)]);}}async function createDailyDigest(_0xdec36e){const _0x6032f4=a0_0x4555e1;if(!_0xdec36e[_0x6032f4(0x26a)])return;await _0xdec36e[_0x6032f4(0x221)](LTM_DP_STATUS,{'val':'Started...','ack':!![]});if(!_0xdec36e[_0x6032f4(0x1b3)]||_0xdec36e['rawEventLog'][_0x6032f4(0x1b8)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0xdec36e[_0x6032f4(0x221)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x2719b5=JSON[_0x6032f4(0x2b1)](JSON['stringify'](_0xdec36e[_0x6032f4(0x211)])),_0x5a2f03=_0x2719b5[_0x6032f4(0x1b8)],_0x197527=new Array(0x60)[_0x6032f4(0x306)](0x0),_0x139d2f=new Date()[_0x6032f4(0x198)](0x0,0x0,0x0,0x0);_0x2719b5[_0x6032f4(0x263)](_0x4a318b=>{const _0x4c2c9a=_0x6032f4,_0xed77b8=new Date(_0x4a318b[_0x4c2c9a(0x1c8)]),_0x3d761f=_0xed77b8[_0x4c2c9a(0x20e)](),_0x19af78=_0xed77b8[_0x4c2c9a(0x156)](),_0xb11ce=_0x3d761f*0x4+Math[_0x4c2c9a(0x1f6)](_0x19af78/0xf);if(_0xb11ce>=0x0&&_0xb11ce<0x60)_0x197527[_0xb11ce]++;});const _0x4cf078=_0x6032f4(0x28f)+JSON[_0x6032f4(0x296)](_0x2719b5[_0x6032f4(0x1e0)](0x0,0x32));try{const _0x5caa87=await _0xdec36e[_0x6032f4(0x1b3)]['generateContent'](_0x4cf078),_0x3dd311=JSON['parse'](_0x5caa87[_0x6032f4(0x2ae)]['text']()[_0x6032f4(0x22a)](/```json|```/g,'')[_0x6032f4(0x22d)]()),_0x2988cf={'timestamp':new Date()['toISOString'](),'eventCount':_0x5a2f03,'summary':_0x3dd311['summary']||'Digest','activityLevel':_0x3dd311[_0x6032f4(0x2a0)]||_0x6032f4(0x231),'systemMode':_0xdec36e[_0x6032f4(0x254)],'activityVector':_0x197527};_0xdec36e[_0x6032f4(0x238)][_0x6032f4(0x204)](_0x2988cf),await saveDailyDigests(_0xdec36e),_0xdec36e[_0x6032f4(0x211)]=[],await saveRawEventLog(_0xdec36e),await _0xdec36e[_0x6032f4(0x221)](LTM_DP_STATUS,{'val':_0x6032f4(0x1f1),'ack':!![]});if(_0xdec36e['isProVersion'])sendToPython(_0xdec36e,_0x6032f4(0x1a7),{'digest':_0x2988cf});}catch(_0x47e4d9){_0xdec36e[_0x6032f4(0x2e4)][_0x6032f4(0x199)](_0x47e4d9['message']);}}function setupLtmScheduler(_0x5d85e6){const _0xea003c=a0_0x4555e1;try{if(_0x5d85e6['ltmJob'])_0x5d85e6['ltmJob'][_0xea003c(0x244)]();if(!_0x5d85e6[_0xea003c(0x26a)])return;_0x5d85e6[_0xea003c(0x23e)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x5d85e6));}catch(_0x2ae678){_0x5d85e6[_0xea003c(0x2e4)][_0xea003c(0x199)](_0xea003c(0x2ee)+_0x2ae678[_0xea003c(0x2b9)]);}}function setupModeResetScheduler(_0x33c5f5){const _0x34ff0d=a0_0x4555e1;try{if(_0x33c5f5[_0x34ff0d(0x227)])_0x33c5f5[_0x34ff0d(0x227)][_0x34ff0d(0x244)]();_0x33c5f5['modeResetJob']=schedule[_0x34ff0d(0x217)](MODE_RESET_SCHEDULE,async()=>{const _0x23d73d=_0x34ff0d;await loadSystemMode(_0x33c5f5),AUTO_RESET_MODES[_0x23d73d(0x192)](_0x33c5f5[_0x23d73d(0x254)])&&await _0x33c5f5[_0x23d73d(0x221)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x23d73d(0x26c)],'ack':![]});});}catch(_0x276ad8){_0x33c5f5[_0x34ff0d(0x2e4)][_0x34ff0d(0x199)]('Reset\x20Sched\x20Error:\x20'+_0x276ad8[_0x34ff0d(0x2b9)]);}}function setupDriftAnalysisScheduler(_0x3aa3bd){const _0x38f9c4=a0_0x4555e1;try{if(_0x3aa3bd[_0x38f9c4(0x18c)])clearInterval(_0x3aa3bd[_0x38f9c4(0x18c)]);if(!_0x3aa3bd['isProVersion'])return;_0x3aa3bd[_0x38f9c4(0x18c)]=setInterval(()=>runBaselineDriftAnalysis(_0x3aa3bd),(_0x3aa3bd['config'][_0x38f9c4(0x24c)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3aa3bd),0x1388);}catch(_0x343e06){_0x3aa3bd['log'][_0x38f9c4(0x199)](_0x38f9c4(0x2fa)+_0x343e06[_0x38f9c4(0x2b9)]);}}function setupBriefingScheduler(_0x3b9047){const _0x35d0cc=a0_0x4555e1;try{if(_0x3b9047[_0x35d0cc(0x2ad)])_0x3b9047[_0x35d0cc(0x2ad)][_0x35d0cc(0x244)]();if(!_0x3b9047[_0x35d0cc(0x252)][_0x35d0cc(0x158)])return;const _0x59429a=(_0x3b9047[_0x35d0cc(0x252)]['briefingTime']||_0x35d0cc(0x21f))[_0x35d0cc(0x1ef)](':'),_0xf2b293=parseInt(_0x59429a[0x0])||0x8,_0x410094=parseInt(_0x59429a[0x1])||0x0,_0x1f38fe=_0x410094+'\x20'+_0xf2b293+'\x20*\x20*\x20*';_0x3b9047[_0x35d0cc(0x2ad)]=schedule['scheduleJob'](_0x1f38fe,()=>{sendMorningBriefing(_0x3b9047);});}catch(_0x21c569){_0x3b9047['log'][_0x35d0cc(0x199)](_0x35d0cc(0x29c)+_0x21c569[_0x35d0cc(0x2b9)]);}}function a0_0x48cb(_0x487e30,_0x3575cb){const _0x299911=a0_0x50bc();return a0_0x48cb=function(_0x1d0a94,_0x39065b){_0x1d0a94=_0x1d0a94-0x153;let _0x50bc70=_0x299911[_0x1d0a94];return _0x50bc70;},a0_0x48cb(_0x487e30,_0x3575cb);}async function runBaselineDriftAnalysis(_0x2086ec){const _0xb25c23=a0_0x4555e1;if(!_0x2086ec[_0xb25c23(0x26a)]||!_0x2086ec[_0xb25c23(0x1b3)])return;const _0xc1b90d=_0x2086ec['config']['ltmStbWindowDays']||0xe;if(_0x2086ec[_0xb25c23(0x238)][_0xb25c23(0x1b8)]<_0xc1b90d+0x7){await _0x2086ec[_0xb25c23(0x221)](LTM_DP_DRIFT_STATUS,{'val':_0xb25c23(0x16b),'ack':!![]});return;}const _0x1f3d89=_0x2086ec[_0xb25c23(0x238)][_0xb25c23(0x1e0)](-_0xc1b90d),_0x32a29b=_0x2086ec[_0xb25c23(0x238)]['slice'](0x0,_0x2086ec[_0xb25c23(0x238)][_0xb25c23(0x1b8)]-_0xc1b90d),_0x5452e7=_0xb25c23(0x21b)+JSON[_0xb25c23(0x296)](_0x32a29b)+_0xb25c23(0x282)+JSON[_0xb25c23(0x296)](_0x1f3d89);try{const _0x330526=await _0x2086ec[_0xb25c23(0x1b3)]['generateContent'](_0x5452e7),_0x26b591=JSON[_0xb25c23(0x2b1)](_0x330526[_0xb25c23(0x2ae)][_0xb25c23(0x2e8)]()['replace'](/```json|```/g,'')[_0xb25c23(0x22d)]());_0x26b591['baselineDrift']&&(await _0x2086ec[_0xb25c23(0x221)](LTM_DP_DRIFT_STATUS,{'val':_0x26b591['baselineDrift'],'ack':!![]}),await _0x2086ec[_0xb25c23(0x221)](LTM_DP_DRIFT_DETAILS,{'val':_0x26b591[_0xb25c23(0x18e)],'ack':!![]}),await _0x2086ec[_0xb25c23(0x221)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0xb25c23(0x153)](),'ack':!![]}));}catch(_0x16d54a){}}class CogniLiving extends utils[a0_0x4555e1(0x228)]{constructor(_0x434ae2){const _0x1d5cca=a0_0x4555e1;super({..._0x434ae2,'name':_0x1d5cca(0x189)}),this[_0x1d5cca(0x297)]=[],this[_0x1d5cca(0x246)]=[],this[_0x1d5cca(0x211)]=[],this[_0x1d5cca(0x238)]=[],this[_0x1d5cca(0x1ee)]={},this[_0x1d5cca(0x23b)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x1d5cca(0x1ae)]=!![],this[_0x1d5cca(0x2eb)]=null,this[_0x1d5cca(0x1c2)]=null,this[_0x1d5cca(0x1cf)]=![],this['genAI']=null,this[_0x1d5cca(0x1b3)]=null,this[_0x1d5cca(0x254)]=SYSTEM_MODES[_0x1d5cca(0x26c)],this[_0x1d5cca(0x26a)]=![],this[_0x1d5cca(0x2ab)]=![],this[_0x1d5cca(0x287)]=_0x1d5cca(0x212),this[_0x1d5cca(0x2f9)]=null,this[_0x1d5cca(0x23e)]=null,this[_0x1d5cca(0x227)]=null,this['driftAnalysisTimer']=null,this[_0x1d5cca(0x2ad)]=null,this['pythonProcess']=null,this['dependencyInstallInProgress']=![],this['on'](_0x1d5cca(0x154),this[_0x1d5cca(0x286)]['bind'](this)),this['on']('stateChange',this[_0x1d5cca(0x26f)][_0x1d5cca(0x30c)](this)),this['on']('unload',this[_0x1d5cca(0x1c3)][_0x1d5cca(0x30c)](this)),this['on'](_0x1d5cca(0x2b9),this['onMessage'][_0x1d5cca(0x30c)](this));}async[a0_0x4555e1(0x286)](){const _0x4bba36=a0_0x4555e1;this[_0x4bba36(0x2e4)]['info'](_0x4bba36(0x2d0)+this['version']+_0x4bba36(0x260));if(!checkAndInstall(this))return;await startSystem(this);}['onUnload'](_0x1ff6e3){const _0x3c7160=a0_0x4555e1;if(this[_0x3c7160(0x2f9)])clearInterval(this[_0x3c7160(0x2f9)]);if(this[_0x3c7160(0x18c)])clearInterval(this[_0x3c7160(0x18c)]);if(this[_0x3c7160(0x23e)])this[_0x3c7160(0x23e)][_0x3c7160(0x244)]();if(this[_0x3c7160(0x227)])this['modeResetJob'][_0x3c7160(0x244)]();if(this[_0x3c7160(0x2ad)])this[_0x3c7160(0x2ad)][_0x3c7160(0x244)]();if(this['exitTimer'])clearTimeout(this['exitTimer']);if(this[_0x3c7160(0x1c2)])clearTimeout(this[_0x3c7160(0x1c2)]);stopPythonService(this),_0x1ff6e3();}async[a0_0x4555e1(0x26f)](_0xb05d14,_0x3dd362){const _0x5ab73d=a0_0x4555e1;if(!_0x3dd362||this[_0x5ab73d(0x1a0)])return;if(_0xb05d14[_0x5ab73d(0x192)](_0x5ab73d(0x19f))&&_0xb05d14[_0x5ab73d(0x1ad)]('communicate.request')&&_0x3dd362[_0x5ab73d(0x1a2)]){await handleTelegramResponse(this,_0x3dd362[_0x5ab73d(0x1a2)]);return;}if(_0xb05d14===this[_0x5ab73d(0x229)]+'.'+SYSTEM_DP_MODE){if(_0x3dd362[_0x5ab73d(0x1a2)]&&Object[_0x5ab73d(0x17a)](SYSTEM_MODES)['includes'](_0x3dd362['val'])){this[_0x5ab73d(0x254)]=_0x3dd362[_0x5ab73d(0x1a2)];if(_0x3dd362['val']===SYSTEM_MODES[_0x5ab73d(0x224)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x3dd362[_0x5ab73d(0x197)])this[_0x5ab73d(0x18b)](_0xb05d14,{'val':this[_0x5ab73d(0x254)],'ack':!![]});return;}if(!_0x3dd362[_0x5ab73d(0x197)]){_0xb05d14[_0x5ab73d(0x192)](_0x5ab73d(0x2c6))&&_0x3dd362[_0x5ab73d(0x1a2)]&&(this[_0x5ab73d(0x18b)](_0xb05d14,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0xb05d14[_0x5ab73d(0x192)](_0x5ab73d(0x230))&&_0x3dd362['val']){this['setState'](_0xb05d14,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0xb05d14[_0x5ab73d(0x192)]('triggerBriefing')&&_0x3dd362[_0x5ab73d(0x1a2)]&&(this[_0x5ab73d(0x18b)](_0xb05d14,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0xb05d14[_0x5ab73d(0x192)]('automation.triggerAction')&&_0x3dd362[_0x5ab73d(0x1a2)]&&(this[_0x5ab73d(0x18b)](_0xb05d14,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0xb05d14['includes'](_0x5ab73d(0x188))&&_0x3dd362[_0x5ab73d(0x1a2)]){this[_0x5ab73d(0x18b)](_0xb05d14,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x166a9b=await this[_0x5ab73d(0x23f)](_0x5ab73d(0x1fd));if(_0x166a9b&&_0x166a9b[_0x5ab73d(0x1a2)]){const _0x48e8fa=JSON[_0x5ab73d(0x2b1)](_0x166a9b[_0x5ab73d(0x1a2)]);this[_0x5ab73d(0x2e4)][_0x5ab73d(0x1c9)](_0x5ab73d(0x304)),this[_0x5ab73d(0x221)](_0x5ab73d(0x2e1),{'val':'Sec-Training\x20started...','ack':!![]}),sendToPython(this,_0x5ab73d(0x2bb),{'sequences':_0x48e8fa});}}catch(_0x2d9369){this['log'][_0x5ab73d(0x199)]('Training\x20Error:\x20'+_0x2d9369[_0x5ab73d(0x2b9)]);}}if(_0xb05d14['includes'](_0x5ab73d(0x1f7))&&_0x3dd362[_0x5ab73d(0x1a2)]){this['setState'](_0xb05d14,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x213880=await this[_0x5ab73d(0x23f)](LTM_DP_DAILY_DIGESTS);if(_0x213880&&_0x213880[_0x5ab73d(0x1a2)])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0x5ab73d(0x2b1)](_0x213880['val'])});}catch(_0x446612){}}if(_0xb05d14[_0x5ab73d(0x192)]('analysis.training.triggerEnergy')&&_0x3dd362['val']){this[_0x5ab73d(0x18b)](_0xb05d14,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x11f4d3=await this[_0x5ab73d(0x23f)]('LTM.trainingData.thermodynamics');if(_0x11f4d3&&_0x11f4d3[_0x5ab73d(0x1a2)])sendToPython(this,_0x5ab73d(0x2ea),{'points':JSON[_0x5ab73d(0x2b1)](_0x11f4d3[_0x5ab73d(0x1a2)])});}catch(_0x5454ca){}}if(_0xb05d14[_0x5ab73d(0x192)](_0x5ab73d(0x30b))&&_0x3dd362[_0x5ab73d(0x1a2)]){this['setState'](_0xb05d14,{'val':![],'ack':!![]});if(this[_0x5ab73d(0x26a)])try{const _0x2df671=await this[_0x5ab73d(0x23f)](LTM_DP_RAW_LOG);_0x2df671&&_0x2df671[_0x5ab73d(0x1a2)]&&(this[_0x5ab73d(0x2e4)][_0x5ab73d(0x1c9)](_0x5ab73d(0x1eb)),sendToPython(this,_0x5ab73d(0x261),{'events':JSON[_0x5ab73d(0x2b1)](_0x2df671[_0x5ab73d(0x1a2)])}));}catch(_0x2879f4){}}return;}if(this[_0x5ab73d(0x252)][_0x5ab73d(0x2d5)]&&this['config'][_0x5ab73d(0x2d5)][_0x5ab73d(0x192)](_0xb05d14)){await checkWifiPresence(this);return;}const _0x2c7242=(this[_0x5ab73d(0x252)][_0x5ab73d(0x274)]||[])[_0x5ab73d(0x29a)](_0x19ceba=>_0x19ceba['id']===_0xb05d14);if(_0x2c7242)processSensorEvent(this,_0xb05d14,_0x3dd362,_0x2c7242);}async[a0_0x4555e1(0x1e1)](_0x8e84bc){const _0x86287=a0_0x4555e1;if(typeof _0x8e84bc==='object'&&_0x8e84bc[_0x86287(0x2b9)]){if(_0x8e84bc['command']===_0x86287(0x21e)){const _0x4d9859=_0x8e84bc[_0x86287(0x2b9)][_0x86287(0x2b0)]||this[_0x86287(0x252)][_0x86287(0x1e5)];if(!_0x4d9859)return this[_0x86287(0x2c8)](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':![],'message':'Kein\x20API\x20Key.'},_0x8e84bc[_0x86287(0x1dd)]);try{const _0x23d614=new GoogleGenerativeAI(_0x4d9859),_0x5980a9=_0x23d614['getGenerativeModel']({'model':GEMINI_MODEL}),_0xf9dacd=await _0x5980a9['generateContent']('Hi');this['sendTo'](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':!![],'message':_0x86287(0x2ef)+_0xf9dacd[_0x86287(0x2ae)]['text']()},_0x8e84bc['callback']);}catch(_0x5e9f71){this[_0x86287(0x2c8)](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':![],'message':_0x86287(0x24a)+_0x5e9f71[_0x86287(0x2b9)]},_0x8e84bc[_0x86287(0x1dd)]);}}else{if(_0x8e84bc[_0x86287(0x223)]===_0x86287(0x2dd)){const _0x14f562=await getWeatherContext(this),_0x1271db=await getCalendarContext(this);this[_0x86287(0x2c8)](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':!![],'weather':_0x14f562,'calendar':_0x1271db},_0x8e84bc[_0x86287(0x1dd)]);}else{if(_0x8e84bc[_0x86287(0x223)]==='getLtmData'){if(!this[_0x86287(0x26a)])return this[_0x86287(0x2c8)](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':![],'isPro':![]},_0x8e84bc[_0x86287(0x1dd)]);let _0x101fef={'status':_0x86287(0x2a1)};try{const _0x11a006=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x101fef[_0x86287(0x1b2)]=_0x11a006?_0x11a006[_0x86287(0x1a2)]:'N/A';}catch(_0x1320a5){}this['sendTo'](_0x8e84bc[_0x86287(0x273)],_0x8e84bc['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x101fef,'analysisHistory':this[_0x86287(0x246)]},_0x8e84bc['callback']);}else{if(_0x8e84bc['command']==='getOverviewData'){const _0x23d57b=this[_0x86287(0x238)][_0x86287(0x1b8)],_0x3f05de=new Date(),_0x48baa8=new Date(_0x3f05de[_0x86287(0x1a6)](),_0x3f05de[_0x86287(0x194)](),_0x3f05de[_0x86287(0x17c)]())[_0x86287(0x305)](),_0x2c326b=this[_0x86287(0x211)]['filter'](_0x2acd6f=>new Date(_0x2acd6f[_0x86287(0x1c8)])[_0x86287(0x305)]()>_0x48baa8)[_0x86287(0x1b8)],_0x482289=new Array(0x18)['fill'](0x0);this[_0x86287(0x211)]['forEach'](_0x13de6b=>{const _0x1cc0a6=_0x86287,_0x220ad1=new Date(_0x13de6b[_0x1cc0a6(0x1c8)]);if(_0x220ad1[_0x1cc0a6(0x305)]()>_0x48baa8)_0x482289[_0x220ad1[_0x1cc0a6(0x20e)]()]++;});let _0x524a44={'status':_0x86287(0x2a1)};try{const _0x3cb1ca=await this[_0x86287(0x23f)](LTM_DP_DRIFT_STATUS);_0x524a44[_0x86287(0x1b2)]=_0x3cb1ca?_0x3cb1ca[_0x86287(0x1a2)]:_0x86287(0x2a1);}catch(_0x77f8ac){}let _0x27a06e='';try{const _0x4c2c25=await this[_0x86287(0x23f)]('system.presenceWho');_0x27a06e=_0x4c2c25?_0x4c2c25[_0x86287(0x1a2)]:'';}catch(_0x2479e5){}let _0x2cabd7=null;!this[_0x86287(0x1b3)]&&(_0x2cabd7=this['config'][_0x86287(0x1e5)]?_0x86287(0x2a3):_0x86287(0x2fe));let _0xc56666={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x12cb20=await this['getStateAsync']('analysis.automation.patternDetected');if(_0x12cb20&&_0x12cb20[_0x86287(0x1a2)]){_0xc56666[_0x86287(0x18f)]=!![];const _0x4ce4fe=await this[_0x86287(0x23f)](_0x86287(0x264));_0xc56666['description']=_0x4ce4fe?_0x4ce4fe[_0x86287(0x1a2)]:'';const _0x5a2eb7=await this[_0x86287(0x23f)]('analysis.automation.targetId');_0xc56666[_0x86287(0x1f4)]=_0x5a2eb7?_0x5a2eb7['val']:'';const _0x13b9be=await this[_0x86287(0x23f)](_0x86287(0x2f6));_0xc56666[_0x86287(0x247)]=_0x13b9be?_0x13b9be[_0x86287(0x1a2)]:'';}const _0x5ea519=await this['getStateAsync'](_0x86287(0x21d));_0xc56666[_0x86287(0x1db)]=_0x5ea519?!!_0x5ea519[_0x86287(0x1a2)]:![];}catch(_0x498d26){}this['sendTo'](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0xf),'stats':{'digestCount':_0x23d57b,'eventCountToday':_0x2c326b,'hourlyActivity':_0x482289,'driftStatus':_0x524a44[_0x86287(0x1b2)],'isPresent':this[_0x86287(0x1ae)],'presenceWho':_0x27a06e,'minDays':this[_0x86287(0x252)][_0x86287(0x308)]||0x7,'stbDays':this['config'][_0x86287(0x25c)]||0xe,'ltbDays':this['config'][_0x86287(0x278)]||0x3c,'systemError':_0x2cabd7},'automation':_0xc56666},_0x8e84bc['callback']);}else{if(_0x8e84bc['command']===_0x86287(0x176))try{const _0x346ffa=await scanForDevices(this,_0x8e84bc[_0x86287(0x2b9)]||{});this[_0x86287(0x2c8)](_0x8e84bc['from'],_0x8e84bc[_0x86287(0x223)],{'success':!![],'devices':_0x346ffa},_0x8e84bc[_0x86287(0x1dd)]);}catch(_0x33c16c){this[_0x86287(0x2c8)](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':![],'error':_0x33c16c[_0x86287(0x2b9)]},_0x8e84bc[_0x86287(0x1dd)]);}else{if(_0x8e84bc[_0x86287(0x223)]==='getEnums'){const _0x3e9802=await this[_0x86287(0x2d7)](_0x86287(0x164),'enum'),_0x14a435=[];if(_0x3e9802)for(const _0xfef5f4 in _0x3e9802){const _0x446b89=_0x3e9802[_0xfef5f4],_0xe753f1=(_0x446b89[_0x86287(0x2c1)]&&typeof _0x446b89[_0x86287(0x2c1)][_0x86287(0x2cd)]===_0x86287(0x1d9)?_0x446b89['common'][_0x86287(0x2cd)]['de']:_0x446b89[_0x86287(0x2c1)]['name'])||_0x446b89[_0x86287(0x2c1)][_0x86287(0x2cd)];_0x14a435[_0x86287(0x204)]({'id':_0xfef5f4,'name':_0xe753f1});}this[_0x86287(0x2c8)](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':!![],'enums':_0x14a435},_0x8e84bc[_0x86287(0x1dd)]);}else{if(_0x8e84bc[_0x86287(0x223)]===_0x86287(0x2be)){const _0x14e71a=_0x8e84bc[_0x86287(0x2b9)][_0x86287(0x22b)];if(!_0x14e71a)return this[_0x86287(0x2c8)](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':![],'error':_0x86287(0x165)},_0x8e84bc['callback']);const _0x18c881=await getCalendarNames(this,_0x14e71a);this[_0x86287(0x2c8)](_0x8e84bc['from'],_0x8e84bc[_0x86287(0x223)],{'success':!![],'names':_0x18c881},_0x8e84bc[_0x86287(0x1dd)]);}else{if(_0x8e84bc[_0x86287(0x223)]===_0x86287(0x2d2)){const {targetId:_0x337fc2,targetValue:_0x4d7c3e}=_0x8e84bc['message'];this[_0x86287(0x2e4)]['info'](_0x86287(0x2ed)+_0x337fc2+'\x20=\x20'+_0x4d7c3e),await this['setStateAsync'](_0x86287(0x21a),{'val':!![],'ack':!![]}),await this[_0x86287(0x221)](_0x86287(0x264),{'val':_0x86287(0x288)+_0x337fc2,'ack':!![]}),await this['setStateAsync']('analysis.automation.targetId',{'val':_0x337fc2,'ack':!![]}),await this[_0x86287(0x221)](_0x86287(0x2f6),{'val':_0x4d7c3e,'ack':!![]}),this[_0x86287(0x2c8)](_0x8e84bc['from'],_0x8e84bc[_0x86287(0x223)],{'success':!![]},_0x8e84bc[_0x86287(0x1dd)]);}else{if(_0x8e84bc[_0x86287(0x223)]===_0x86287(0x1fa)){const {historyId:_0x2c37d1,rating:_0x2750eb,comment:_0x3f0b4a,alertReason:_0x180b58}=_0x8e84bc[_0x86287(0x2b9)];_0x2c37d1&&_0x2750eb?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x2c37d1,'rating':_0x2750eb,'comment':_0x3f0b4a,'alertReason':_0x180b58}),this['sendTo'](_0x8e84bc['from'],_0x8e84bc[_0x86287(0x223)],{'success':!![]},_0x8e84bc[_0x86287(0x1dd)])):this['sendTo'](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':![],'error':_0x86287(0x1e7)},_0x8e84bc['callback']);}else _0x8e84bc[_0x86287(0x223)]===_0x86287(0x275)&&(this[_0x86287(0x2e4)][_0x86287(0x1c9)](_0x86287(0x1bd)),await this[_0x86287(0x221)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this['setStateAsync']('analysis.automation.description',{'val':'','ack':!![]}),this['sendTo'](_0x8e84bc[_0x86287(0x273)],_0x8e84bc[_0x86287(0x223)],{'success':!![]},_0x8e84bc[_0x86287(0x1dd)]));}}}}}}}}}}}if(require['main']!==module)module[a0_0x4555e1(0x26b)]=_0xc012e8=>new CogniLiving(_0xc012e8);else new CogniLiving();