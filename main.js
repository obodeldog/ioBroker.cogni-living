const a0_0x1632af=a0_0x4af4;function a0_0x4af4(_0x1bd45b,_0x102874){const _0x13cd7f=a0_0x58d5();return a0_0x4af4=function(_0xb1e7bd,_0x2adb8b){_0xb1e7bd=_0xb1e7bd-0xf4;let _0x58d5f0=_0x13cd7f[_0xb1e7bd];return _0x58d5f0;},a0_0x4af4(_0x1bd45b,_0x102874);}function a0_0x58d5(){const _0x19c4bb=['sort','./lib/dead_man','./lib/topology','forEach','inactivityThresholdHours','Adapter','ltmJob','./lib/recorder','split','endsWith','notifyTelegramInstance','devices','search','stateChange','analysis.health.todayVector','sendMorningBriefing','includes','VACATION','setStateAsync','updated','WiFi\x20Presence\x20detected.','(((.+)+)+)+$','values','Activity-Level','Lernphase\x20(','./lib/setup','from','calendarInstance','config','briefingJob','10147621VUOTQJ','models/gemini-flash-latest','Gemini\x20AI\x20initialized.','initSystemConfig','analysis.training.triggerHealth','executeAutomationAction','getLtmData',')\x20-\x20Phase\x20C\x20(Hardened)','setupBriefingScheduler','send','triggerBriefing','apply','LTM.triggerDailyDigest','push','matrix','./lib/installer','timestamp','setPresence','.communicate.request','calendarName','common','map','getForeignObjectsAsync','updateLocation','generateContent','LTM.dailyDigests','Gesendet','onReady','exitGraceTimer','setState','SYSTEM_DP_MODE','automation.triggerAction','exitTimer','TRAIN_ENERGY','apiKey','motion','updateHealthVector','command','analysis.trigger','@google/generative-ai','abortExitTimer','checkWifiPresence','system.presenceWho','toLowerCase','runGeminiAnalysis','slice','rawEventLog','pop','analysisTimer','setupModeResetScheduler','weatherInstance','triggerEnergyPrediction','fill','ANALYZE_GAIT','onMessage','toString','modeResetJob','sendTo','main','presenceDevices','SET_TOPOLOGY','onUnload','checkLicense','log','\x20Tage)','instance','namespace','info','checkAndInstall','getStateAsync','cogni-living\x20adapter\x20starting\x20(v','callback','getOutsideTemperatureNumeric','144WCriir','error','processSensorEvent','PYTHON_EXE','text','message','subscribeStates','parse','runBaselineDriftAnalysis','add','length','dependencyInstallInProgress','triggerGaitAnalysis','.system.mode','name','ANALYZE_TREND','getGenerativeModel','Notification\x20Test\x20Failed:\x20','lastAlertState','analysis.training.triggerComfort','testApiKey','runPythonHealthCheck','analysis.training.triggerSecurity','TRAIN_HEALTH','449511JGKgjb','PREDICT_ENERGY','sensorLastValues','runAutopilot','Instanz\x20nicht\x20gefunden','driftAnalysisTimer','getTime','SYSTEM_MODES','getForeignStateAsync','Gemini\x20Init\x20Error:\x20','version','join','loadSystemMode','eventHistory','minDaysForBaseline','221104gsoDMs','enum','getEnums','analysisHistory','cancel','NORMAL','13148hNmpys','Keine\x20Antwort\x20von\x20Gemini','@iobroker/adapter-core','isPresent','onStateChange','enum.functions.*','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','geminiApiKey','Daten\x20nicht\x20verfÃ¼gbar','createAllObjects','Kein\x20API\x20Key\x20Ã¼bergeben','_calName','154jlGiQD','./lib/python_bridge','scanDevices','845935rbxenO','now','online','12UcmRfj','ack','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','scanForDevices','4264872gpttPi','analysis.automation.autoApply','communicate.request','val','location','analysis.topology.structure','isGracePeriodActive','getHours','analysis.triggerBriefing','genAI','94fZYcGs','Sec-Training\x20started...','debug','notifyTelegramEnabled','cogni-living','enum.rooms.*','dailyDigests','Fehler:\x20','isProVersion','LTM.trainingData.sequences','type','Aktiv\x20(','telegram','activityLevel','systemConfig','TRAIN_COMFORT','constructor','sendNotification','initHistory','getState','startSystem','Kein\x20Wetter-Adapter','updateTopology','196770AVbWAF','startService','setHours','currentSystemMode','system.adapter.','getCalendarNames','analysis.training.triggerTopology','analysis.automation.triggerAction','object','subscribeForeignStatesAsync','response','testNotification','geminiModel','getMinutes','bind'];a0_0x58d5=function(){return _0x19c4bb;};return a0_0x58d5();}(function(_0x29fb34,_0x3bcf3d){const _0x1476a9=a0_0x4af4,_0x320515=_0x29fb34();while(!![]){try{const _0x27931a=parseInt(_0x1476a9(0x120))/0x1*(-parseInt(_0x1476a9(0x100))/0x2)+-parseInt(_0x1476a9(0x1c5))/0x3*(-parseInt(_0x1476a9(0x112))/0x4)+-parseInt(_0x1476a9(0x10f))/0x5+parseInt(_0x1476a9(0x116))/0x6+-parseInt(_0x1476a9(0x10c))/0x7*(parseInt(_0x1476a9(0xfa))/0x8)+-parseInt(_0x1476a9(0x1ad))/0x9*(parseInt(_0x1476a9(0x137))/0xa)+parseInt(_0x1476a9(0x164))/0xb;if(_0x27931a===_0x3bcf3d)break;else _0x320515['push'](_0x320515['shift']());}catch(_0x109d2c){_0x320515['push'](_0x320515['shift']());}}}(a0_0x58d5,0x5b057));const a0_0x2adb8b=(function(){let _0x2b6ce8=!![];return function(_0x3c49ff,_0x108e18){const _0x487034=_0x2b6ce8?function(){const _0x6e7bb3=a0_0x4af4;if(_0x108e18){const _0x5b4da5=_0x108e18[_0x6e7bb3(0x16f)](_0x3c49ff,arguments);return _0x108e18=null,_0x5b4da5;}}:function(){};return _0x2b6ce8=![],_0x487034;};}()),a0_0xb1e7bd=a0_0x2adb8b(this,function(){const _0x2871eb=a0_0x4af4;return a0_0xb1e7bd[_0x2871eb(0x19b)]()[_0x2871eb(0x152)](_0x2871eb(0x15b))['toString']()[_0x2871eb(0x130)](a0_0xb1e7bd)['search'](_0x2871eb(0x15b));});a0_0xb1e7bd();'use strict';const utils=require(a0_0x1632af(0x102)),{GoogleGenerativeAI}=require(a0_0x1632af(0x18b)),installer=require(a0_0x1632af(0x173)),scanner=require('./lib/scanner'),schedulers=require('./lib/scheduler'),topology=require(a0_0x1632af(0x148)),setup=require(a0_0x1632af(0x15f)),recorder=require(a0_0x1632af(0x14d)),pythonBridge=require(a0_0x1632af(0x10d)),aiAgent=require('./lib/ai_agent'),deadMan=require(a0_0x1632af(0x147)),GEMINI_MODEL=a0_0x1632af(0x165),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils[a0_0x1632af(0x14b)]{constructor(_0x2a2295){const _0x1f299e=a0_0x1632af;super({..._0x2a2295,'name':_0x1f299e(0x124)}),this[_0x1f299e(0xf8)]=[],this[_0x1f299e(0xfd)]=[],this['rawEventLog']=[],this[_0x1f299e(0x126)]=[],this[_0x1f299e(0x1c7)]={},this[_0x1f299e(0x12e)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x1f299e(0x103)]=!![],this[_0x1f299e(0x184)]=null,this[_0x1f299e(0x180)]=null,this[_0x1f299e(0x11c)]=![],this['genAI']=null,this[_0x1f299e(0x143)]=null,this[_0x1f299e(0x13a)]=setup[_0x1f299e(0x1cc)][_0x1f299e(0xff)],this[_0x1f299e(0x128)]=![],this[_0x1f299e(0x1bf)]=![],this[_0x1f299e(0x194)]=null,this[_0x1f299e(0x14c)]=null,this[_0x1f299e(0x19c)]=null,this['driftAnalysisTimer']=null,this[_0x1f299e(0x163)]=null,this[_0x1f299e(0x1b8)]=![],this['on']('ready',this[_0x1f299e(0x17f)][_0x1f299e(0x145)](this)),this['on'](_0x1f299e(0x153),this[_0x1f299e(0x104)][_0x1f299e(0x145)](this)),this['on']('unload',this[_0x1f299e(0x1a1)][_0x1f299e(0x145)](this)),this['on'](_0x1f299e(0x1b2),this['onMessage'][_0x1f299e(0x145)](this));}async['onReady'](){const _0x502e67=a0_0x1632af;this['log'][_0x502e67(0x1a7)](_0x502e67(0x1aa)+this[_0x502e67(0xf5)]+_0x502e67(0x16b));if(!installer[_0x502e67(0x1a8)](this,()=>this[_0x502e67(0x134)]()))return;}async[a0_0x1632af(0x134)](){const _0x7f935f=a0_0x1632af;await setup['initZombies'](this);try{this[_0x7f935f(0x128)]=await setup[_0x7f935f(0x1a2)](this[_0x7f935f(0x162)]['licenseKey']);}catch(_0x3768cd){}if(!this['config'][_0x7f935f(0x14a)]||this[_0x7f935f(0x162)]['inactivityThresholdHours']<0.1)this['config'][_0x7f935f(0x14a)]=0xc;await setup[_0x7f935f(0x132)](this),await setup[_0x7f935f(0x167)](this);if(this[_0x7f935f(0x162)][_0x7f935f(0x107)])try{this[_0x7f935f(0x11f)]=new GoogleGenerativeAI(this['config']['geminiApiKey']),this[_0x7f935f(0x143)]=this[_0x7f935f(0x11f)][_0x7f935f(0x1bd)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x7f935f(0x1a3)][_0x7f935f(0x1a7)](_0x7f935f(0x166));}catch(_0x24b9ec){this['log'][_0x7f935f(0x1ae)](_0x7f935f(0xf4)+_0x24b9ec[_0x7f935f(0x1b2)]);}await setup[_0x7f935f(0x109)](this),await this['loadSystemMode']();try{const _0x35b156=await this['getStateAsync']('LTM.rawEventLog');if(_0x35b156&&_0x35b156['val'])this[_0x7f935f(0x192)]=JSON[_0x7f935f(0x1b4)](_0x35b156['val']);}catch(_0x1c12f0){this[_0x7f935f(0x192)]=[];}try{const _0x1f14f7=await this['getStateAsync'](_0x7f935f(0x17d));if(_0x1f14f7&&_0x1f14f7[_0x7f935f(0x119)])this[_0x7f935f(0x126)]=JSON[_0x7f935f(0x1b4)](_0x1f14f7[_0x7f935f(0x119)]);}catch(_0x8a0de5){this[_0x7f935f(0x126)]=[];}const _0x125c38=this[_0x7f935f(0x126)][_0x7f935f(0x1b7)]>=(this[_0x7f935f(0x162)][_0x7f935f(0xf9)]||0x7)?_0x7f935f(0x12b)+this['dailyDigests']['length']+_0x7f935f(0x1a4):_0x7f935f(0x15e)+this[_0x7f935f(0x126)][_0x7f935f(0x1b7)]+'/'+(this['config']['minDaysForBaseline']||0x7)+')';await this[_0x7f935f(0x158)]('LTM.baselineStatus',{'val':_0x125c38,'ack':!![]}),this[_0x7f935f(0x1b3)](_0x7f935f(0x18a)),this[_0x7f935f(0x1b3)](_0x7f935f(0x170)),this['subscribeStates']('system.mode'),this['subscribeStates'](_0x7f935f(0x11e)),this[_0x7f935f(0x1b3)](_0x7f935f(0x13e)),this['subscribeStates'](_0x7f935f(0x117)),this['subscribeStates']('analysis.training.triggerSecurity'),this['subscribeStates'](_0x7f935f(0x168)),this[_0x7f935f(0x1b3)]('analysis.training.triggerEnergy'),this['subscribeStates'](_0x7f935f(0x1c0)),this[_0x7f935f(0x1b3)](_0x7f935f(0x13d));const _0x289fa7=this[_0x7f935f(0x162)][_0x7f935f(0x151)];if(_0x289fa7)for(const _0x2f6c78 of _0x289fa7){await this[_0x7f935f(0x140)](_0x2f6c78['id']);}const _0x402c71=this[_0x7f935f(0x162)][_0x7f935f(0x19f)];if(_0x402c71)for(const _0x2e2e70 of _0x402c71){await this[_0x7f935f(0x140)](_0x2e2e70);}if(this[_0x7f935f(0x162)][_0x7f935f(0x123)]&&this[_0x7f935f(0x162)][_0x7f935f(0x150)])await this[_0x7f935f(0x140)](this[_0x7f935f(0x162)]['notifyTelegramInstance']+_0x7f935f(0x176));setTimeout(()=>this[_0x7f935f(0x18d)](),0x1388);if(this[_0x7f935f(0x194)])clearInterval(this[_0x7f935f(0x194)]);const _0x1b1599=this[_0x7f935f(0x162)]['analysisInterval']||0xf;_0x1b1599>0x0&&(this['analysisTimer']=setInterval(()=>{const _0x41dc72=_0x7f935f;this[_0x41dc72(0x1c8)]();},_0x1b1599*0x3c*0x3e8)),schedulers['setupLtmScheduler'](this,()=>aiAgent['createDailyDigest'](this,pythonBridge)),schedulers[_0x7f935f(0x195)](this),schedulers['setupDriftAnalysisScheduler'](this,()=>aiAgent[_0x7f935f(0x1b5)](this)),schedulers[_0x7f935f(0x16c)](this,()=>aiAgent[_0x7f935f(0x155)](this)),pythonBridge[_0x7f935f(0x138)](this,installer[_0x7f935f(0x1b0)]),setTimeout(async()=>{const _0x25bb98=_0x7f935f;await topology[_0x25bb98(0x136)](this);try{const _0x4c95d5=await this[_0x25bb98(0x1a9)](_0x25bb98(0x11b));if(_0x4c95d5&&_0x4c95d5[_0x25bb98(0x119)])pythonBridge[_0x25bb98(0x16d)](this,_0x25bb98(0x1a0),JSON[_0x25bb98(0x1b4)](_0x4c95d5[_0x25bb98(0x119)]));}catch(_0x436e48){}this[_0x25bb98(0x1c2)](),this[_0x25bb98(0x1b9)](),this[_0x25bb98(0x197)](),this[_0x25bb98(0x188)]();},0x1388);}[a0_0x1632af(0x1a1)](_0x1468bf){const _0x224494=a0_0x1632af;if(this['analysisTimer'])clearInterval(this[_0x224494(0x194)]);if(this[_0x224494(0x1ca)])clearInterval(this['driftAnalysisTimer']);if(this[_0x224494(0x14c)])this[_0x224494(0x14c)]['cancel']();if(this['modeResetJob'])this[_0x224494(0x19c)]['cancel']();if(this[_0x224494(0x163)])this[_0x224494(0x163)][_0x224494(0xfe)]();recorder['abortExitTimer'](this),pythonBridge['stopService'](this),_0x1468bf();}async['onStateChange'](_0x846d8c,_0x371293){const _0x5bd740=a0_0x1632af;if(!_0x371293||this[_0x5bd740(0x1b8)])return;if(_0x846d8c[_0x5bd740(0x156)](_0x5bd740(0x12c))&&_0x846d8c[_0x5bd740(0x14f)](_0x5bd740(0x118))&&_0x371293[_0x5bd740(0x119)])return;if(_0x846d8c===this[_0x5bd740(0x1a6)]+_0x5bd740(0x1ba)){if(_0x371293['val']&&Object[_0x5bd740(0x15c)](setup[_0x5bd740(0x1cc)])['includes'](_0x371293['val'])){this['currentSystemMode']=_0x371293['val'];if(_0x371293[_0x5bd740(0x119)]===setup['SYSTEM_MODES'][_0x5bd740(0x157)])await recorder[_0x5bd740(0x175)](this,![]);else await recorder[_0x5bd740(0x175)](this,!![]);}if(!_0x371293[_0x5bd740(0x113)])this[_0x5bd740(0x181)](_0x846d8c,{'val':this[_0x5bd740(0x13a)],'ack':!![]});return;}if(!_0x371293[_0x5bd740(0x113)]){_0x846d8c[_0x5bd740(0x156)](_0x5bd740(0x18a))&&_0x371293['val']&&(this[_0x5bd740(0x181)](_0x846d8c,{'val':![],'ack':!![]}),aiAgent[_0x5bd740(0x190)](this));if(_0x846d8c[_0x5bd740(0x156)]('triggerDailyDigest')&&_0x371293[_0x5bd740(0x119)]){this[_0x5bd740(0x181)](_0x846d8c,{'val':![],'ack':!![]});if(this[_0x5bd740(0x128)])aiAgent['createDailyDigest'](this,pythonBridge);}_0x846d8c[_0x5bd740(0x156)](_0x5bd740(0x16e))&&_0x371293[_0x5bd740(0x119)]&&(this[_0x5bd740(0x181)](_0x846d8c,{'val':![],'ack':!![]}),aiAgent[_0x5bd740(0x155)](this));_0x846d8c[_0x5bd740(0x156)](_0x5bd740(0x183))&&_0x371293[_0x5bd740(0x119)]&&(this[_0x5bd740(0x181)](_0x846d8c,{'val':![],'ack':!![]}),aiAgent[_0x5bd740(0x169)](this));if(_0x846d8c['includes'](_0x5bd740(0x1c3))&&_0x371293[_0x5bd740(0x119)]){this[_0x5bd740(0x181)](_0x846d8c,{'val':![],'ack':!![]});if(this[_0x5bd740(0x128)])try{const _0x3fb027=await this[_0x5bd740(0x1a9)](_0x5bd740(0x129));if(_0x3fb027&&_0x3fb027[_0x5bd740(0x119)]){const _0x3a974f=JSON[_0x5bd740(0x1b4)](_0x3fb027[_0x5bd740(0x119)]);this[_0x5bd740(0x158)]('analysis.training.status',{'val':_0x5bd740(0x121),'ack':!![]}),pythonBridge[_0x5bd740(0x16d)](this,'TRAIN_SECURITY',{'sequences':_0x3a974f});}}catch(_0x358b3a){}}if(_0x846d8c[_0x5bd740(0x156)](_0x5bd740(0x168))&&_0x371293['val']){this[_0x5bd740(0x181)](_0x846d8c,{'val':![],'ack':!![]});if(this[_0x5bd740(0x128)])try{const _0x32bbc1=await this[_0x5bd740(0x1a9)](_0x5bd740(0x17d));if(_0x32bbc1&&_0x32bbc1[_0x5bd740(0x119)])pythonBridge['send'](this,_0x5bd740(0x1c4),{'digests':JSON[_0x5bd740(0x1b4)](_0x32bbc1[_0x5bd740(0x119)])});}catch(_0x1e47f2){}}if(_0x846d8c[_0x5bd740(0x156)]('analysis.training.triggerEnergy')&&_0x371293[_0x5bd740(0x119)]){this['setState'](_0x846d8c,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x2fea1f=await this[_0x5bd740(0x1a9)]('LTM.trainingData.thermodynamics');if(_0x2fea1f&&_0x2fea1f[_0x5bd740(0x119)])pythonBridge[_0x5bd740(0x16d)](this,_0x5bd740(0x185),{'points':JSON['parse'](_0x2fea1f[_0x5bd740(0x119)])});}catch(_0x357598){}}if(_0x846d8c[_0x5bd740(0x156)](_0x5bd740(0x1c0))&&_0x371293[_0x5bd740(0x119)]){this[_0x5bd740(0x181)](_0x846d8c,{'val':![],'ack':!![]});if(this[_0x5bd740(0x128)])try{const _0x4bc7dc=await this[_0x5bd740(0x1a9)]('LTM.rawEventLog');if(_0x4bc7dc&&_0x4bc7dc[_0x5bd740(0x119)])pythonBridge[_0x5bd740(0x16d)](this,_0x5bd740(0x12f),{'events':JSON['parse'](_0x4bc7dc[_0x5bd740(0x119)])});}catch(_0x501127){}}_0x846d8c[_0x5bd740(0x156)](_0x5bd740(0x13d))&&_0x371293['val']&&(this['setState'](_0x846d8c,{'val':![],'ack':!![]}),topology[_0x5bd740(0x136)](this));return;}if(this[_0x5bd740(0x162)]['presenceDevices']&&this[_0x5bd740(0x162)][_0x5bd740(0x19f)]['includes'](_0x846d8c)){await this['checkWifiPresence']();return;}const _0x42f153=(this[_0x5bd740(0x162)][_0x5bd740(0x151)]||[])['find'](_0x3243a9=>_0x3243a9['id']===_0x846d8c);if(_0x42f153){const _0xa2ba15=await recorder[_0x5bd740(0x1af)](this,_0x846d8c,_0x371293,_0x42f153);_0xa2ba15&&_0xa2ba15[_0x5bd740(0x12a)]===_0x5bd740(0x187)&&_0xa2ba15[_0x5bd740(0x11a)]&&this[_0x5bd740(0x128)]&&deadMan[_0x5bd740(0x17b)](this,_0xa2ba15[_0x5bd740(0x11a)]);}}async[a0_0x1632af(0x19a)](_0x31b66b){const _0x1c7e85=a0_0x1632af;if(typeof _0x31b66b===_0x1c7e85(0x13f)&&_0x31b66b['message']){if(_0x31b66b[_0x1c7e85(0x189)]===_0x1c7e85(0x1c1))try{const _0x3bfa2e=_0x31b66b[_0x1c7e85(0x1b2)][_0x1c7e85(0x186)];if(!_0x3bfa2e)throw new Error(_0x1c7e85(0x10a));const _0x6c5345=new GoogleGenerativeAI(_0x3bfa2e),_0x5591f8=_0x6c5345[_0x1c7e85(0x1bd)]({'model':GEMINI_MODEL}),_0x3a60d0=await _0x5591f8[_0x1c7e85(0x17c)]('Test'),_0x33b80b=await _0x3a60d0[_0x1c7e85(0x141)];if(_0x33b80b[_0x1c7e85(0x1b1)]())this[_0x1c7e85(0x19d)](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':!![],'message':'Verbindung\x20erfolgreich!'},_0x31b66b[_0x1c7e85(0x1ab)]);else throw new Error(_0x1c7e85(0x101));}catch(_0x4da3fb){this[_0x1c7e85(0x19d)](_0x31b66b['from'],_0x31b66b['command'],{'success':![],'message':_0x4da3fb[_0x1c7e85(0x1b2)]},_0x31b66b[_0x1c7e85(0x1ab)]);}else{if(_0x31b66b[_0x1c7e85(0x189)]===_0x1c7e85(0x10e))try{const _0x6f94e0=await scanner[_0x1c7e85(0x115)](this,_0x31b66b['message']||{});this[_0x1c7e85(0x19d)](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':!![],'devices':_0x6f94e0},_0x31b66b[_0x1c7e85(0x1ab)]);}catch(_0xca76b1){this['sendTo'](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':![],'error':_0xca76b1['message']},_0x31b66b[_0x1c7e85(0x1ab)]);}else{if(_0x31b66b[_0x1c7e85(0x189)]==='updateTopologyMatrix')try{const {matrix:_0x2b7678}=_0x31b66b['message'],_0x526b87=await this[_0x1c7e85(0x1a9)](_0x1c7e85(0x11b));if(_0x526b87&&_0x526b87[_0x1c7e85(0x119)]){const _0xef7175=JSON['parse'](_0x526b87[_0x1c7e85(0x119)]);_0xef7175[_0x1c7e85(0x172)]=_0x2b7678,_0xef7175[_0x1c7e85(0x159)]=Date[_0x1c7e85(0x110)](),await this[_0x1c7e85(0x158)](_0x1c7e85(0x11b),{'val':JSON['stringify'](_0xef7175),'ack':!![]}),pythonBridge['send'](this,_0x1c7e85(0x1a0),_0xef7175);}this[_0x1c7e85(0x19d)](_0x31b66b['from'],_0x31b66b['command'],{'success':!![]},_0x31b66b[_0x1c7e85(0x1ab)]);}catch(_0x36ad18){this['log'][_0x1c7e85(0x1ae)](_0x36ad18);}else{if(_0x31b66b[_0x1c7e85(0x189)]===_0x1c7e85(0x16a))this['sendTo'](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':!![],'dailyDigests':this[_0x1c7e85(0x126)]||[],'analysisHistory':this[_0x1c7e85(0xfd)]||[]},_0x31b66b[_0x1c7e85(0x1ab)]);else{if(_0x31b66b['command']==='getOverviewData'){const _0x4bc0ea=this[_0x1c7e85(0x126)][_0x1c7e85(0x1b7)],_0x40fe0e=new Array(0x18)['fill'](0x0),_0x2df802=new Date()[_0x1c7e85(0x139)](0x0,0x0,0x0,0x0);this['eventHistory']&&this['eventHistory'][_0x1c7e85(0x149)](_0x1ed483=>{const _0x414bd7=_0x1c7e85;if(_0x1ed483[_0x414bd7(0x174)]>=_0x2df802){const _0x5d359b=new Date(_0x1ed483['timestamp'])[_0x414bd7(0x11d)]();if(_0x5d359b>=0x0&&_0x5d359b<0x18)_0x40fe0e[_0x5d359b]++;}}),this[_0x1c7e85(0x19d)](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':!![],'eventHistory':this['eventHistory'][_0x1c7e85(0x191)](0x0,0xf),'stats':{'digestCount':_0x4bc0ea,'isPresent':this[_0x1c7e85(0x103)],'hourlyActivity':_0x40fe0e},'automation':{'detected':![]}},_0x31b66b[_0x1c7e85(0x1ab)]);}else{if(_0x31b66b['command']===_0x1c7e85(0xfc)){const _0x4a8776=await this[_0x1c7e85(0x17a)](_0x1c7e85(0x105),_0x1c7e85(0xfb)),_0x593258=[];if(_0x4a8776)for(const _0x166a70 in _0x4a8776){const _0x205cb0=_0x4a8776[_0x166a70],_0xd26edd=(_0x205cb0[_0x1c7e85(0x178)]&&typeof _0x205cb0[_0x1c7e85(0x178)][_0x1c7e85(0x1bb)]===_0x1c7e85(0x13f)?_0x205cb0[_0x1c7e85(0x178)][_0x1c7e85(0x1bb)]['de']:_0x205cb0[_0x1c7e85(0x178)][_0x1c7e85(0x1bb)])||_0x205cb0[_0x1c7e85(0x178)][_0x1c7e85(0x1bb)];_0x593258[_0x1c7e85(0x171)]({'id':_0x166a70,'name':_0xd26edd});}const _0x51afa1=await this[_0x1c7e85(0x17a)](_0x1c7e85(0x125),_0x1c7e85(0xfb)),_0x30df78=[];if(_0x51afa1)for(const _0xb79c79 in _0x51afa1){const _0x2da69c=_0x51afa1[_0xb79c79],_0x37cace=(_0x2da69c[_0x1c7e85(0x178)]&&typeof _0x2da69c[_0x1c7e85(0x178)][_0x1c7e85(0x1bb)]===_0x1c7e85(0x13f)?_0x2da69c[_0x1c7e85(0x178)][_0x1c7e85(0x1bb)]['de']:_0x2da69c['common'][_0x1c7e85(0x1bb)])||_0xb79c79[_0x1c7e85(0x14e)]('.')[_0x1c7e85(0x193)]();_0x30df78[_0x1c7e85(0x171)](_0x37cace);}this[_0x1c7e85(0x19d)](_0x31b66b['from'],_0x31b66b['command'],{'success':!![],'enums':_0x593258,'rooms':_0x30df78},_0x31b66b['callback']);}else{if(_0x31b66b[_0x1c7e85(0x189)]==='testContext')try{let _0x313478=_0x1c7e85(0x135),_0x5ebe32='Kein\x20Kalender-Adapter';if(this[_0x1c7e85(0x162)][_0x1c7e85(0x196)]){const _0xb2b1e7=await recorder['getOutsideTemperatureNumeric'](this);_0x313478=_0xb2b1e7!==null?_0xb2b1e7+'Â°C':_0x1c7e85(0x108);}if(this['config'][_0x1c7e85(0x161)]){const _0x4be803=await this['getForeignObjectAsync'](_0x1c7e85(0x13b)+this[_0x1c7e85(0x162)][_0x1c7e85(0x161)]);_0x5ebe32=_0x4be803?'Verbunden':_0x1c7e85(0x1c9);}this[_0x1c7e85(0x19d)](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':!![],'weather':_0x313478,'calendar':_0x5ebe32},_0x31b66b[_0x1c7e85(0x1ab)]);}catch(_0x2359f4){this[_0x1c7e85(0x19d)](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':![],'error':_0x2359f4['message']},_0x31b66b[_0x1c7e85(0x1ab)]);}else{if(_0x31b66b[_0x1c7e85(0x189)]===_0x1c7e85(0x13c))try{const _0x425c11=_0x31b66b[_0x1c7e85(0x1b2)][_0x1c7e85(0x1a5)],_0x372a59=await this[_0x1c7e85(0x1cd)](_0x425c11+'.data.table');let _0x46048b=[];if(_0x372a59&&_0x372a59[_0x1c7e85(0x119)]){const _0x5653ac=JSON['parse'](_0x372a59[_0x1c7e85(0x119)]),_0x1ca6e8=new Set();Array['isArray'](_0x5653ac)&&_0x5653ac['forEach'](_0x43cb7e=>{const _0x59da64=_0x1c7e85;if(_0x43cb7e[_0x59da64(0x10b)])_0x1ca6e8[_0x59da64(0x1b6)](_0x43cb7e[_0x59da64(0x10b)]);else{if(_0x43cb7e[_0x59da64(0x177)])_0x1ca6e8['add'](_0x43cb7e[_0x59da64(0x177)]);}}),_0x46048b=Array['from'](_0x1ca6e8)[_0x1c7e85(0x146)]();}if(_0x46048b[_0x1c7e85(0x1b7)]===0x0)_0x46048b=['Standard'];this[_0x1c7e85(0x19d)](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':!![],'names':_0x46048b},_0x31b66b[_0x1c7e85(0x1ab)]);}catch(_0x4e48bb){this[_0x1c7e85(0x19d)](_0x31b66b['from'],_0x31b66b[_0x1c7e85(0x189)],{'success':![],'error':_0x4e48bb[_0x1c7e85(0x1b2)]},_0x31b66b[_0x1c7e85(0x1ab)]);}else{if(_0x31b66b[_0x1c7e85(0x189)]===_0x1c7e85(0x142))try{await setup[_0x1c7e85(0x131)](this,_0x1c7e85(0x114),![],![]),this['sendTo'](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':!![],'message':_0x1c7e85(0x17e)},_0x31b66b[_0x1c7e85(0x1ab)]);}catch(_0x1da1b7){this[_0x1c7e85(0x1a3)][_0x1c7e85(0x1ae)](_0x1c7e85(0x1be)+_0x1da1b7['message']),this[_0x1c7e85(0x19d)](_0x31b66b[_0x1c7e85(0x160)],_0x31b66b[_0x1c7e85(0x189)],{'success':![],'message':_0x1c7e85(0x127)+_0x1da1b7[_0x1c7e85(0x1b2)]},_0x31b66b[_0x1c7e85(0x1ab)]);}}}}}}}}}}}async[a0_0x1632af(0xf7)](){const _0x5993e8=a0_0x1632af;try{const _0x6ee3fd=await this['getStateAsync'](setup[_0x5993e8(0x182)]);_0x6ee3fd&&_0x6ee3fd['val']&&Object[_0x5993e8(0x15c)](setup[_0x5993e8(0x1cc)])[_0x5993e8(0x156)](_0x6ee3fd[_0x5993e8(0x119)])?this['currentSystemMode']=_0x6ee3fd['val']:(this[_0x5993e8(0x13a)]=setup['SYSTEM_MODES']['NORMAL'],await this[_0x5993e8(0x158)](setup[_0x5993e8(0x182)],{'val':setup['SYSTEM_MODES'][_0x5993e8(0xff)],'ack':!![]}));}catch(_0x2462a1){this[_0x5993e8(0x13a)]=setup[_0x5993e8(0x1cc)][_0x5993e8(0xff)];}}async[a0_0x1632af(0x18d)](){const _0xc745ad=a0_0x1632af;try{const _0x28853b=this[_0xc745ad(0x162)][_0xc745ad(0x19f)]||[];let _0x46674f=![];const _0x345137=[];for(const _0x2db79f of _0x28853b){try{const _0x4e0eb5=await this['getForeignStateAsync'](_0x2db79f);_0x4e0eb5&&(_0x4e0eb5['val']===!![]||_0x4e0eb5[_0xc745ad(0x119)]===_0xc745ad(0x111)||_0x4e0eb5[_0xc745ad(0x119)]===0x1)&&(_0x46674f=!![],_0x345137['push'](_0x2db79f));}catch(_0x3b4c9e){}}return await this[_0xc745ad(0x158)](_0xc745ad(0x18e),{'val':_0x345137[_0xc745ad(0xf6)](',\x20'),'ack':!![]}),_0x46674f&&(this[_0xc745ad(0x184)]&&(this[_0xc745ad(0x1a3)][_0xc745ad(0x1a7)](_0xc745ad(0x15a)),recorder[_0xc745ad(0x18c)](this)),!this[_0xc745ad(0x103)]&&this[_0xc745ad(0x13a)]===setup['SYSTEM_MODES'][_0xc745ad(0xff)]&&await recorder[_0xc745ad(0x175)](this,!![])),_0x46674f;}catch(_0x28303c){return![];}}async[a0_0x1632af(0x1c8)](){const _0x3ae319=a0_0x1632af;this[_0x3ae319(0x1a3)][_0x3ae319(0x122)](_0x3ae319(0x106)),await aiAgent['runGeminiAnalysis'](this),this[_0x3ae319(0x188)](),this[_0x3ae319(0x1b9)](),this[_0x3ae319(0x197)]();}[a0_0x1632af(0x1b9)](){const _0xfe4965=a0_0x1632af;if(!this[_0xfe4965(0x128)])return;try{this[_0xfe4965(0x133)](_0xfe4965(0x129),(_0x261afc,_0x42cfd2)=>{const _0x16b8e4=_0xfe4965;_0x42cfd2&&_0x42cfd2['val']&&pythonBridge[_0x16b8e4(0x16d)](this,_0x16b8e4(0x199),{'sequences':JSON['parse'](_0x42cfd2['val'])});});}catch(_0x4b3a45){}}async[a0_0x1632af(0x197)](){const _0x5801a5=a0_0x1632af;if(!this[_0x5801a5(0x128)])return;try{const _0x4a3564=await recorder[_0x5801a5(0x1ac)](this);if(_0x4a3564===null)return;const _0x24eb74={},_0x2362e6=this[_0x5801a5(0x162)][_0x5801a5(0x151)]||[];for(const _0x4cb1dd of _0x2362e6){if(_0x4cb1dd['type']==='temperature'&&_0x4cb1dd['location']){const _0x38b5d9=this[_0x5801a5(0x1c7)][_0x4cb1dd['id']];if(_0x38b5d9!==undefined)_0x24eb74[_0x4cb1dd[_0x5801a5(0x11a)]]=_0x38b5d9;}}Object['keys'](_0x24eb74)['length']>0x0&&pythonBridge[_0x5801a5(0x16d)](this,_0x5801a5(0x1c6),{'current_temps':_0x24eb74,'t_out':_0x4a3564});}catch(_0x20a5ba){}}['updateHealthVector'](){const _0x563c78=a0_0x1632af;if(!this['rawEventLog']||this[_0x563c78(0x192)][_0x563c78(0x1b7)]===0x0)return;const _0x2adab9=new Array(0x60)[_0x563c78(0x198)](0x0),_0x25365a=new Date()[_0x563c78(0x139)](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x563c78(0x149)](_0x358f00=>{const _0x206c61=_0x563c78,_0x1da736=new Date(_0x358f00[_0x206c61(0x174)]);if(_0x1da736[_0x206c61(0x1cb)]()>=_0x25365a){const _0xf7cfc8=_0x1da736['getHours'](),_0x56d1de=_0x1da736[_0x206c61(0x144)](),_0x13f987=_0xf7cfc8*0x4+Math['floor'](_0x56d1de/0xf);if(_0x13f987>=0x0&&_0x13f987<0x60)_0x2adab9[_0x13f987]++;}}),this[_0x563c78(0x158)](_0x563c78(0x154),{'val':JSON['stringify'](_0x2adab9),'ack':!![]});}[a0_0x1632af(0x1c2)](){const _0x53880f=a0_0x1632af;if(!this[_0x53880f(0x126)]||this[_0x53880f(0x126)]['length']<0x2)return;const _0xf96c32=this[_0x53880f(0x126)][_0x53880f(0x179)](_0x38cd02=>{const _0x26ed20=_0x53880f,_0xbe5bc=(_0x38cd02[_0x26ed20(0x12d)]||'')[_0x26ed20(0x18f)]();return ACTIVITY_LEVEL_MAP[_0xbe5bc]||0x32;});pythonBridge[_0x53880f(0x16d)](this,_0x53880f(0x1bc),{'values':_0xf96c32,'tag':_0x53880f(0x15d)});}}if(require[a0_0x1632af(0x19e)]!==module)module['exports']=_0x23ebcb=>new CogniLiving(_0x23ebcb);else new CogniLiving();