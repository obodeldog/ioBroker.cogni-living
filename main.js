const a0_0x23bf25=a0_0x2094;(function(_0x1a6b30,_0x417479){const _0x2a7bfe=a0_0x2094,_0x3f1559=_0x1a6b30();while(!![]){try{const _0x554d76=-parseInt(_0x2a7bfe(0x1f8))/0x1+parseInt(_0x2a7bfe(0x30a))/0x2+-parseInt(_0x2a7bfe(0x34d))/0x3*(parseInt(_0x2a7bfe(0x2a9))/0x4)+parseInt(_0x2a7bfe(0x2a0))/0x5*(-parseInt(_0x2a7bfe(0x232))/0x6)+parseInt(_0x2a7bfe(0x2b3))/0x7+-parseInt(_0x2a7bfe(0x334))/0x8*(parseInt(_0x2a7bfe(0x330))/0x9)+parseInt(_0x2a7bfe(0x33e))/0xa;if(_0x554d76===_0x417479)break;else _0x3f1559['push'](_0x3f1559['shift']());}catch(_0x31ded8){_0x3f1559['push'](_0x3f1559['shift']());}}}(a0_0x53ae,0x27578));const a0_0x15ebb9=(function(){let _0x3dce48=!![];return function(_0x350971,_0x5c8047){const _0x2c9969=_0x3dce48?function(){if(_0x5c8047){const _0x5d0c99=_0x5c8047['apply'](_0x350971,arguments);return _0x5c8047=null,_0x5d0c99;}}:function(){};return _0x3dce48=![],_0x2c9969;};}()),a0_0x3045ad=a0_0x15ebb9(this,function(){const _0x36cb8a=a0_0x2094;return a0_0x3045ad[_0x36cb8a(0x2cb)]()[_0x36cb8a(0x312)](_0x36cb8a(0x31f))['toString']()[_0x36cb8a(0x1eb)](a0_0x3045ad)[_0x36cb8a(0x312)](_0x36cb8a(0x31f));});a0_0x3045ad();'use strict';const utils=require(a0_0x23bf25(0x245)),{GoogleGenerativeAI}=require(a0_0x23bf25(0x28e)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x23bf25(0x2e7)),path=require(a0_0x23bf25(0x1b1)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x23bf25(0x2f5),LTM_SCHEDULE=a0_0x23bf25(0x253),MODE_RESET_SCHEDULE=a0_0x23bf25(0x2a4),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x23bf25(0x326),LTM_DP_DAILY_DIGESTS=a0_0x23bf25(0x370),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x23bf25(0x1d4),LTM_DP_BASELINE_STATUS=a0_0x23bf25(0x357),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x23bf25(0x2e2),LTM_DP_DRIFT_DETAILS=a0_0x23bf25(0x2e9),LTM_DP_DRIFT_LAST_CHECK=a0_0x23bf25(0x32f),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=['scriptProblem',a0_0x23bf25(0x28c),'update','unreach',a0_0x23bf25(0x1a7),a0_0x23bf25(0x2ae),a0_0x23bf25(0x2fa),a0_0x23bf25(0x22a),'error',a0_0x23bf25(0x372),'working',a0_0x23bf25(0x377),'stick_unreach',a0_0x23bf25(0x1d0),a0_0x23bf25(0x21c),a0_0x23bf25(0x25c),a0_0x23bf25(0x2d6),a0_0x23bf25(0x31d)],BAD_NAMES=[a0_0x23bf25(0x30e),a0_0x23bf25(0x388),a0_0x23bf25(0x201),a0_0x23bf25(0x34f),a0_0x23bf25(0x361),a0_0x23bf25(0x36a),'on',a0_0x23bf25(0x373),a0_0x23bf25(0x1a6),'position',a0_0x23bf25(0x25f),'blind',a0_0x23bf25(0x24b),a0_0x23bf25(0x2df),a0_0x23bf25(0x1cc),a0_0x23bf25(0x322),a0_0x23bf25(0x321),a0_0x23bf25(0x2c6),a0_0x23bf25(0x217),a0_0x23bf25(0x311),a0_0x23bf25(0x2e5),a0_0x23bf25(0x314),a0_0x23bf25(0x266),a0_0x23bf25(0x296),a0_0x23bf25(0x36e)],ADAPTER_BLACKLIST=[a0_0x23bf25(0x1ff),a0_0x23bf25(0x1b3),'info.',a0_0x23bf25(0x220),a0_0x23bf25(0x1b8),a0_0x23bf25(0x20d),a0_0x23bf25(0x304),a0_0x23bf25(0x1c8),'echarts.',a0_0x23bf25(0x287),a0_0x23bf25(0x1ae)],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x23bf25(0x2b7),'PARTY':a0_0x23bf25(0x324),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x23bf25(0x2c5)],SYSTEM_MODES[a0_0x23bf25(0x2be)]],PERSONA_MAPPING={'generic':a0_0x23bf25(0x260),'senior_aal':a0_0x23bf25(0x233),'family':a0_0x23bf25(0x222),'single_comfort':a0_0x23bf25(0x209),'security':a0_0x23bf25(0x20a)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};async function initZombies(_0x2792bd){const _0x54eeaa=a0_0x23bf25;try{const _0xe6238f=[_0x54eeaa(0x32e),_0x54eeaa(0x29f)];for(const _0x3c7ead of _0xe6238f){try{const _0x2be1ec=await _0x2792bd[_0x54eeaa(0x1b7)](_0x3c7ead);_0x2be1ec&&await _0x2792bd[_0x54eeaa(0x2c2)](_0x3c7ead);}catch(_0x21edd0){}}}catch(_0x2ba7d2){}}async function initHistory(_0x55978a){const _0x1ef70c=a0_0x23bf25;try{const _0x2210f1=await _0x55978a[_0x1ef70c(0x1c6)](_0x1ef70c(0x27a));_0x2210f1&&_0x2210f1[_0x1ef70c(0x1b0)]&&(_0x55978a[_0x1ef70c(0x379)]=JSON[_0x1ef70c(0x35d)](_0x2210f1[_0x1ef70c(0x1b0)]['toString']()));}catch(_0x1b8300){_0x55978a['eventHistory']=[];}try{const _0x2a0e70=await _0x55978a[_0x1ef70c(0x1c6)](_0x1ef70c(0x1f5));if(_0x2a0e70&&_0x2a0e70[_0x1ef70c(0x1b0)])_0x55978a[_0x1ef70c(0x1ce)]=JSON[_0x1ef70c(0x35d)](_0x2a0e70['val'][_0x1ef70c(0x2cb)]());}catch(_0x14fafd){_0x55978a[_0x1ef70c(0x1ce)]=[];}if(_0x55978a[_0x1ef70c(0x379)]&&_0x55978a[_0x1ef70c(0x379)]['length']>0x0){_0x55978a['log'][_0x1ef70c(0x1e2)](_0x1ef70c(0x36d)+_0x55978a[_0x1ef70c(0x379)][_0x1ef70c(0x36b)]+_0x1ef70c(0x20c));for(let _0x3aee1e=_0x55978a['eventHistory']['length']-0x1;_0x3aee1e>=0x0;_0x3aee1e--){const _0x4ade15=_0x55978a[_0x1ef70c(0x379)][_0x3aee1e];_0x4ade15&&_0x4ade15['id']!==undefined&&_0x4ade15[_0x1ef70c(0x361)]!==undefined&&(_0x55978a[_0x1ef70c(0x2cf)][_0x4ade15['id']]=_0x4ade15[_0x1ef70c(0x361)]);}}}async function initSystemConfig(_0x2bcf13){const _0x4d6cd3=a0_0x23bf25;try{const _0x406aa7=await _0x2bcf13['getForeignObjectAsync'](_0x4d6cd3(0x33d));_0x406aa7&&_0x406aa7[_0x4d6cd3(0x2cc)]&&(_0x2bcf13[_0x4d6cd3(0x225)]={'latitude':_0x406aa7['common'][_0x4d6cd3(0x339)]||0x0,'longitude':_0x406aa7[_0x4d6cd3(0x2cc)]['longitude']||0x0,'city':_0x406aa7[_0x4d6cd3(0x2cc)][_0x4d6cd3(0x37f)]||''});}catch(_0x2cee51){}}async function checkLicense(_0xe986c2,_0x1c8621){const _0x211d30=a0_0x23bf25;if(!_0x1c8621)return![];_0xe986c2[_0x211d30(0x2f2)]=await getSystemUUID(_0xe986c2);if(_0x1c8621===_0x211d30(0x221)||_0x1c8621['startsWith'](_0x211d30(0x376)))return!![];return![];}async function getSystemUUID(_0x2f9aa1){const _0x4b7a52=a0_0x23bf25;try{const _0x20c67d=await _0x2f9aa1[_0x4b7a52(0x2b1)]('system.meta.uuid');if(_0x20c67d&&_0x20c67d[_0x4b7a52(0x30c)]&&_0x20c67d[_0x4b7a52(0x30c)][_0x4b7a52(0x1de)])return _0x20c67d[_0x4b7a52(0x30c)]['uuid'];return _0x4b7a52(0x349);}catch(_0x3ca20f){return'uuid-error';}}async function createAllObjects(_0x47926a){const _0x5affec=a0_0x23bf25;await checkSystemObjects(_0x47926a),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x383),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x1d1),'type':_0x5affec(0x33a),'role':_0x5affec(0x2a5),'read':!![],'write':![],'def':''},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x218),{'type':'state','common':{'name':'Last\x20raw\x20event','type':_0x5affec(0x33a),'role':_0x5affec(0x29a),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x27a),{'type':_0x5affec(0x201),'common':{'name':'Event\x20History','type':_0x5affec(0x33a),'role':_0x5affec(0x29a),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x275),{'type':'state','common':{'name':_0x5affec(0x22e),'type':_0x5affec(0x1ab),'role':_0x5affec(0x247),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x210),{'type':'state','common':{'name':_0x5affec(0x2ac),'type':_0x5affec(0x1ab),'role':_0x5affec(0x247),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x250),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x2ec),'type':_0x5affec(0x33a),'role':_0x5affec(0x29a),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x2e0),{'type':'state','common':{'name':_0x5affec(0x356),'type':_0x5affec(0x1ab),'role':_0x5affec(0x1d8),'read':!![],'write':![],'def':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x1b2),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x2d1),'type':_0x5affec(0x1ab),'role':_0x5affec(0x244),'read':!![],'write':![],'def':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x21f),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x2c9),'type':_0x5affec(0x33a),'role':_0x5affec(0x30f),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x1f9),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x21b),'type':'string','role':_0x5affec(0x2a5),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x27e),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x2c1),'type':_0x5affec(0x33a),'role':_0x5affec(0x201),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x295),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x2f8),'type':'string','role':_0x5affec(0x2a5),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x2d5),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x24a),'type':'string','role':_0x5affec(0x2a5),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x1ac)]('analysis.automation',{'type':_0x5affec(0x265),'common':{'name':_0x5affec(0x2e1)},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x28d),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x2f0),'type':_0x5affec(0x1ab),'role':_0x5affec(0x351),'read':!![],'write':![],'def':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)]('analysis.automation.description',{'type':'state','common':{'name':_0x5affec(0x1c5),'type':_0x5affec(0x33a),'role':_0x5affec(0x2a5),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x2b2),{'type':'state','common':{'name':_0x5affec(0x329),'type':'string','role':_0x5affec(0x2a5),'read':!![],'write':![]},'native':{}}),await _0x47926a['setObjectNotExistsAsync']('analysis.automation.targetId',{'type':_0x5affec(0x201),'common':{'name':'Target\x20ID','type':_0x5affec(0x33a),'role':_0x5affec(0x2a5),'read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)]('analysis.automation.targetValue',{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x282),'type':_0x5affec(0x33a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x1d2),{'type':'state','common':{'name':_0x5affec(0x35b),'type':'boolean','role':_0x5affec(0x1a6),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x291),{'type':'state','common':{'name':_0x5affec(0x348),'type':_0x5affec(0x1ab),'role':_0x5affec(0x247),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x1f5),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x208),'type':_0x5affec(0x33a),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x47926a[_0x5affec(0x301)]('analysis.feedbackHistory',{'type':'state','common':{'name':_0x5affec(0x31b),'type':_0x5affec(0x33a),'role':_0x5affec(0x29a),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x47926a[_0x5affec(0x1ac)](_0x5affec(0x1b6),{'type':'channel','common':{'name':_0x5affec(0x1be)},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x1e3),{'type':_0x5affec(0x201),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x5affec(0x2db),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x47926a[_0x5affec(0x301)]('analysis.health.restlessness',{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x270),'type':'string','role':_0x5affec(0x2a5),'read':!![],'write':![],'def':_0x5affec(0x1a1)},'native':{}}),await _0x47926a['setObjectNotExistsAsync'](_0x5affec(0x24f),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x2fe),'type':_0x5affec(0x33a),'role':_0x5affec(0x2a5),'read':!![],'write':![],'def':''},'native':{}}),await _0x47926a['setObjectNotExistsAsync'](_0x5affec(0x32d),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x28b),'type':_0x5affec(0x33a),'role':_0x5affec(0x2a5),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x47926a[_0x5affec(0x301)](_0x5affec(0x31e),{'type':_0x5affec(0x201),'common':{'name':_0x5affec(0x380),'type':'number','role':_0x5affec(0x361),'read':!![],'write':![],'def':0x0},'native':{}}),await checkLtmObjects(_0x47926a),await checkLtmDriftObjects(_0x47926a);}async function checkSystemObjects(_0x50893a){const _0x53d0bf=a0_0x23bf25;await _0x50893a[_0x53d0bf(0x1ac)](_0x53d0bf(0x2d3),{'type':'channel','common':{'name':_0x53d0bf(0x211)},'native':{}}),await _0x50893a[_0x53d0bf(0x1ac)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x53d0bf(0x2a7),'type':_0x53d0bf(0x33a),'role':_0x53d0bf(0x201),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x53d0bf(0x2ef)]]:_0x53d0bf(0x236),[SYSTEM_MODES['VACATION']]:_0x53d0bf(0x20f),[SYSTEM_MODES[_0x53d0bf(0x2c5)]]:_0x53d0bf(0x1fb),[SYSTEM_MODES['GUEST']]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x47dee6){const _0x3155fc=a0_0x23bf25;await _0x47dee6[_0x3155fc(0x1ac)]('LTM',{'type':_0x3155fc(0x265),'common':{'name':_0x3155fc(0x281)},'native':{}}),await _0x47dee6['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x3155fc(0x201),'common':{'name':_0x3155fc(0x284),'type':_0x3155fc(0x33a),'role':_0x3155fc(0x29a),'read':!![],'write':![]},'native':{}}),await _0x47dee6[_0x3155fc(0x1ac)](LTM_DP_DAILY_DIGESTS,{'type':_0x3155fc(0x201),'common':{'name':_0x3155fc(0x37c),'type':_0x3155fc(0x33a),'role':_0x3155fc(0x29a),'read':!![],'write':![]},'native':{}}),await _0x47dee6[_0x3155fc(0x1ac)](LTM_DP_STATUS,{'type':_0x3155fc(0x201),'common':{'name':_0x3155fc(0x1aa),'type':'string','role':_0x3155fc(0x2a5),'read':!![],'write':![]},'native':{}}),await _0x47dee6[_0x3155fc(0x1ac)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x3155fc(0x1db),'type':'boolean','role':_0x3155fc(0x247),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x47dee6[_0x3155fc(0x1ac)](LTM_DP_BASELINE_STATUS,{'type':_0x3155fc(0x201),'common':{'name':_0x3155fc(0x2bb),'type':_0x3155fc(0x33a),'role':_0x3155fc(0x2a5),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x5b6fd3){const _0x441dd=a0_0x23bf25;await _0x5b6fd3['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x441dd(0x265),'common':{'name':_0x441dd(0x34c)},'native':{}}),await _0x5b6fd3[_0x441dd(0x1ac)](LTM_DP_DRIFT_STATUS,{'type':_0x441dd(0x201),'common':{'name':'Drift\x20Status','type':_0x441dd(0x33a),'role':'state','read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x5b6fd3[_0x441dd(0x1ac)](LTM_DP_DRIFT_DETAILS,{'type':_0x441dd(0x201),'common':{'name':'Drift\x20Details','type':_0x441dd(0x33a),'role':_0x441dd(0x2a5),'read':!![],'write':![]},'native':{}}),await _0x5b6fd3[_0x441dd(0x1ac)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x441dd(0x1f1),'type':_0x441dd(0x2db),'role':_0x441dd(0x1d5),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x18f284){const _0x3a676a=a0_0x23bf25;try{const _0x20971b=await _0x18f284[_0x3a676a(0x1c6)](SYSTEM_DP_MODE);_0x20971b&&_0x20971b[_0x3a676a(0x1b0)]&&Object[_0x3a676a(0x2c0)](SYSTEM_MODES)[_0x3a676a(0x29b)](_0x20971b[_0x3a676a(0x1b0)])?_0x18f284[_0x3a676a(0x23c)]=_0x20971b[_0x3a676a(0x1b0)]:(_0x18f284['currentSystemMode']=SYSTEM_MODES[_0x3a676a(0x2ef)],await _0x18f284['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x3a676a(0x2ef)],'ack':!![]}));}catch(_0x4fc56d){_0x18f284[_0x3a676a(0x23c)]=SYSTEM_MODES[_0x3a676a(0x2ef)];}}async function loadRawEventLog(_0x1034df){const _0x5ebb77=a0_0x23bf25;try{const _0x310a13=await _0x1034df[_0x5ebb77(0x1c6)](LTM_DP_RAW_LOG);if(_0x310a13&&_0x310a13['val'])_0x1034df[_0x5ebb77(0x200)]=JSON[_0x5ebb77(0x35d)](_0x310a13['val']);}catch(_0x47b371){_0x1034df['rawEventLog']=[];}}async function saveRawEventLog(_0x49b427){const _0x151da2=a0_0x23bf25;_0x49b427[_0x151da2(0x200)][_0x151da2(0x36b)]>RAW_LOG_MAX_SIZE&&_0x49b427[_0x151da2(0x200)][_0x151da2(0x285)](0x0,_0x49b427['rawEventLog'][_0x151da2(0x36b)]-RAW_LOG_MAX_SIZE),await _0x49b427[_0x151da2(0x362)](LTM_DP_RAW_LOG,{'val':JSON['stringify'](_0x49b427['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x34ae57){const _0x4b65fa=a0_0x23bf25;try{const _0x16cfba=await _0x34ae57['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x16cfba&&_0x16cfba[_0x4b65fa(0x1b0)])_0x34ae57['dailyDigests']=JSON[_0x4b65fa(0x35d)](_0x16cfba[_0x4b65fa(0x1b0)]);}catch(_0x150f98){_0x34ae57[_0x4b65fa(0x1e6)]=[];}await updateBaselineStatus(_0x34ae57);}async function saveDailyDigests(_0x525daa,_0x4305c9=!![]){const _0x1576b5=a0_0x23bf25,_0x3a858c=_0x525daa[_0x1576b5(0x26d)][_0x1576b5(0x2fc)]||0x3c;_0x525daa[_0x1576b5(0x1e6)]['length']>_0x3a858c&&_0x525daa[_0x1576b5(0x1e6)][_0x1576b5(0x285)](0x0,_0x525daa[_0x1576b5(0x1e6)][_0x1576b5(0x36b)]-_0x3a858c);await _0x525daa[_0x1576b5(0x362)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1576b5(0x228)](_0x525daa['dailyDigests']),'ack':!![]});if(_0x4305c9)await updateBaselineStatus(_0x525daa);}function a0_0x2094(_0x1ceb38,_0x1114fc){const _0x90fc5f=a0_0x53ae();return a0_0x2094=function(_0x3045ad,_0x15ebb9){_0x3045ad=_0x3045ad-0x1a0;let _0x53aed5=_0x90fc5f[_0x3045ad];return _0x53aed5;},a0_0x2094(_0x1ceb38,_0x1114fc);}async function updateAnalysisHistory(_0x255734,_0x3d8f1c){const _0x356760=a0_0x23bf25;_0x255734['analysisHistory'][_0x356760(0x22d)](_0x3d8f1c);if(_0x255734[_0x356760(0x1ce)]['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x255734[_0x356760(0x1ce)]['pop']();await _0x255734[_0x356760(0x362)]('analysis.analysisHistory',{'val':JSON[_0x356760(0x228)](_0x255734['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0xde6759){const _0x3d653e=a0_0x23bf25;if(!_0xde6759[_0x3d653e(0x352)]){await _0xde6759['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x3d653e(0x288),'ack':!![]});return;}const _0x32f66d=_0xde6759['dailyDigests']['length']>=(_0xde6759['config']['minDaysForBaseline']||0x7)?_0x3d653e(0x2d7)+_0xde6759[_0x3d653e(0x1e6)][_0x3d653e(0x36b)]+_0x3d653e(0x313):_0x3d653e(0x29e)+_0xde6759[_0x3d653e(0x1e6)]['length']+'/'+(_0xde6759['config'][_0x3d653e(0x1f6)]||0x7)+')';await _0xde6759[_0x3d653e(0x362)](LTM_DP_BASELINE_STATUS,{'val':_0x32f66d,'ack':!![]});}async function initSensorSubscriptions(_0x1cfc6f){const _0x2e02f0=a0_0x23bf25,_0x16f97a=_0x1cfc6f[_0x2e02f0(0x26d)]['devices'];if(_0x16f97a&&_0x16f97a[_0x2e02f0(0x36b)]>0x0){_0x1cfc6f['log'][_0x2e02f0(0x1e2)]('Subscribing\x20to\x20'+_0x16f97a[_0x2e02f0(0x36b)]+_0x2e02f0(0x1bf));for(const _0x1c97fc of _0x16f97a){if(_0x1c97fc['id']){await _0x1cfc6f[_0x2e02f0(0x238)](_0x1c97fc['id']);try{const _0x56e400=await _0x1cfc6f[_0x2e02f0(0x2e3)](_0x1c97fc['id']);if(_0x56e400)_0x1cfc6f['sensorLastValues'][_0x1c97fc['id']]=_0x56e400[_0x2e02f0(0x1b0)];}catch(_0x5984b2){}}}}}async function initPresenceSubscriptions(_0x1fa3ab){const _0x243f8f=a0_0x23bf25,_0x195dd1=_0x1fa3ab[_0x243f8f(0x26d)][_0x243f8f(0x2fd)]||[];if(_0x195dd1['length']>0x0){_0x1fa3ab[_0x243f8f(0x1c0)][_0x243f8f(0x1e2)](_0x243f8f(0x1f0)+_0x195dd1['length']+_0x243f8f(0x29c));for(const _0x31fee3 of _0x195dd1){await _0x1fa3ab[_0x243f8f(0x238)](_0x31fee3);}try{await checkWifiPresence(_0x1fa3ab);}catch(_0x168514){}}}async function getWeatherContext(_0x5bdfa2){const _0x55e826=a0_0x23bf25;try{if(!_0x5bdfa2['config']['useWeather'])return _0x55e826(0x1fa);let _0x1e02ae='';const _0x1abd56=_0x5bdfa2['config'][_0x55e826(0x2bd)];if(_0x1abd56)try{if(_0x1abd56['includes'](_0x55e826(0x30d))){const _0x386e90=await _0x5bdfa2[_0x55e826(0x2e3)](_0x1abd56+_0x55e826(0x35c));if(_0x386e90&&_0x386e90[_0x55e826(0x1b0)])_0x1e02ae=_0x386e90[_0x55e826(0x1b0)];}else{if(_0x1abd56['includes']('daswetter')){const _0x354afc=await _0x5bdfa2['getForeignStateAsync'](_0x1abd56+_0x55e826(0x340));if(_0x354afc&&_0x354afc[_0x55e826(0x1b0)])_0x1e02ae=_0x354afc[_0x55e826(0x1b0)];}else{if(_0x1abd56[_0x55e826(0x29b)](_0x55e826(0x2f7))){const _0x126009=await _0x5bdfa2[_0x55e826(0x2e3)](_0x1abd56+'.forecast.current.state');if(_0x126009&&_0x126009[_0x55e826(0x1b0)])_0x1e02ae=_0x126009[_0x55e826(0x1b0)];}}}}catch(_0x39f459){}if(!_0x1e02ae){const _0x209e67=[_0x55e826(0x271),'daswetter.0',_0x55e826(0x360),_0x55e826(0x268)];for(const _0x411443 of _0x209e67){try{const _0x3e0803=await _0x5bdfa2[_0x55e826(0x2b1)](_0x411443);if(_0x3e0803){if(_0x411443[_0x55e826(0x29b)](_0x55e826(0x30d))){const _0x49b593=await _0x5bdfa2[_0x55e826(0x2e3)](_0x411443+_0x55e826(0x35c));if(_0x49b593&&_0x49b593[_0x55e826(0x1b0)]){_0x1e02ae=_0x49b593['val'];break;}}}}catch(_0x5a998a){}}}return _0x1e02ae?'WETTER:\x20'+_0x1e02ae:_0x55e826(0x1a0);}catch(_0x290b34){return'WETTER\x20ERROR:\x20'+_0x290b34[_0x55e826(0x27b)];}}async function getCalendarContext(_0x15f240){const _0x25b954=a0_0x23bf25;try{if(!_0x15f240[_0x25b954(0x26d)]['useCalendar'])return _0x25b954(0x202);let _0x2ed5b9=_0x15f240[_0x25b954(0x26d)][_0x25b954(0x215)]||_0x25b954(0x289),_0x215a4a=_0x15f240[_0x25b954(0x26d)]['calendarSelection']||[];if(typeof _0x215a4a===_0x25b954(0x33a))_0x215a4a=_0x215a4a[_0x25b954(0x368)](',');try{const _0x58dc60=await _0x15f240[_0x25b954(0x2e3)](_0x2ed5b9+_0x25b954(0x257));if(_0x58dc60&&_0x58dc60['val']){let _0x56045c=tryParse(_0x58dc60[_0x25b954(0x1b0)]);if(_0x56045c&&Array[_0x25b954(0x354)](_0x56045c)){if(_0x215a4a[_0x25b954(0x36b)]>0x0)_0x56045c=_0x56045c[_0x25b954(0x2da)](_0x31d8b3=>_0x215a4a[_0x25b954(0x29b)](_0x31d8b3['_calName']||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x56045c[_0x25b954(0x36b)]>0x0){const _0xe741a2=_0x56045c[_0x25b954(0x2fb)](0x0,0x3)[_0x25b954(0x1ea)](_0x9b0c18=>{const _0x6b9bd5=_0x25b954;let _0x36545d=_0x9b0c18['date'];if(_0x9b0c18[_0x6b9bd5(0x37b)])_0x36545d+='\x20'+_0x9b0c18[_0x6b9bd5(0x37b)];return _0x36545d+':\x20'+_0x9b0c18[_0x6b9bd5(0x1fe)]+'\x20('+_0x9b0c18[_0x6b9bd5(0x2d8)]+')';});return _0x25b954(0x358)+_0xe741a2[_0x25b954(0x1ba)](_0x25b954(0x204));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x17628b){_0x15f240['log'][_0x25b954(0x346)]('Error\x20reading\x20calendar\x20table:\x20'+_0x17628b[_0x25b954(0x27b)]);}return _0x25b954(0x276);}catch(_0x1986c4){return _0x25b954(0x249)+_0x1986c4[_0x25b954(0x27b)];}}async function getCalendarNames(_0x423349,_0x278533){const _0x2be04c=a0_0x23bf25;try{const _0x1f301e=await _0x423349[_0x2be04c(0x2e3)](_0x278533+'.data.table');if(_0x1f301e&&_0x1f301e['val']){const _0x4748f1=tryParse(_0x1f301e['val']);if(_0x4748f1&&Array[_0x2be04c(0x354)](_0x4748f1)){const _0x15ac2e=[...new Set(_0x4748f1[_0x2be04c(0x1ea)](_0x19bd85=>_0x19bd85[_0x2be04c(0x2d8)])[_0x2be04c(0x2da)](Boolean))];return _0x15ac2e[_0x2be04c(0x30b)]();}}return[];}catch(_0x4e10da){return _0x423349[_0x2be04c(0x1c0)][_0x2be04c(0x1da)](_0x2be04c(0x34a)+_0x4e10da[_0x2be04c(0x27b)]),[];}}async function checkWifiPresence(_0x2ea297){const _0x3679fd=a0_0x23bf25;try{const _0x2214fd=_0x2ea297[_0x3679fd(0x26d)]['presenceDevices']||[];let _0x510310=![];const _0x516ee6=[];for(const _0x204c2c of _0x2214fd){try{const _0x149d69=await _0x2ea297['getForeignStateAsync'](_0x204c2c);if(_0x149d69&&(_0x149d69[_0x3679fd(0x1b0)]===!![]||_0x149d69[_0x3679fd(0x1b0)]===_0x3679fd(0x2a2)||_0x149d69['val']===0x1)){_0x510310=!![];const _0x3f9e7f=await _0x2ea297[_0x3679fd(0x2b1)](_0x204c2c);let _0x325cd7=_0x204c2c;_0x3f9e7f&&_0x3f9e7f['common']&&_0x3f9e7f[_0x3679fd(0x2cc)][_0x3679fd(0x1ed)]&&(_0x325cd7=typeof _0x3f9e7f[_0x3679fd(0x2cc)][_0x3679fd(0x1ed)]===_0x3679fd(0x1dd)?_0x3f9e7f[_0x3679fd(0x2cc)]['name']['de']||_0x3f9e7f[_0x3679fd(0x2cc)][_0x3679fd(0x1ed)]['en']:_0x3f9e7f[_0x3679fd(0x2cc)][_0x3679fd(0x1ed)]),_0x516ee6[_0x3679fd(0x22b)](_0x325cd7);}}catch(_0x502e81){}}return await _0x2ea297[_0x3679fd(0x362)](_0x3679fd(0x383),{'val':_0x516ee6['join'](',\x20'),'ack':!![]}),_0x510310&&(_0x2ea297['exitTimer']&&(_0x2ea297[_0x3679fd(0x1c0)][_0x3679fd(0x1e2)](_0x3679fd(0x336)),abortExitTimer(_0x2ea297)),!_0x2ea297[_0x3679fd(0x1d9)]&&_0x2ea297['currentSystemMode']===SYSTEM_MODES['NORMAL']&&await setPresence(_0x2ea297,!![])),_0x510310;}catch(_0x3c0137){return _0x2ea297[_0x3679fd(0x1c0)][_0x3679fd(0x1da)](_0x3679fd(0x33b)+_0x3c0137[_0x3679fd(0x27b)]),![];}}function startExitTimer(_0x287c95){const _0x4c37ee=a0_0x23bf25;abortExitTimer(_0x287c95),_0x287c95[_0x4c37ee(0x20b)]=!![],_0x287c95[_0x4c37ee(0x1a9)]=setTimeout(()=>{const _0x39de99=_0x4c37ee;_0x287c95[_0x39de99(0x20b)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x287c95['exitTimer']=setTimeout(()=>{setPresence(_0x287c95,![]),_0x287c95['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x2adfdd){const _0x419425=a0_0x23bf25;if(_0x2adfdd[_0x419425(0x205)])clearTimeout(_0x2adfdd['exitTimer']);if(_0x2adfdd[_0x419425(0x1a9)])clearTimeout(_0x2adfdd[_0x419425(0x1a9)]);_0x2adfdd[_0x419425(0x205)]=null,_0x2adfdd[_0x419425(0x1a9)]=null,_0x2adfdd['isGracePeriodActive']=![];}async function setPresence(_0x3ec840,_0x22e8bd){const _0x2105f1=a0_0x23bf25;if(_0x3ec840[_0x2105f1(0x1d9)]===_0x22e8bd)return;_0x3ec840[_0x2105f1(0x1d9)]=_0x22e8bd,await _0x3ec840['setStateAsync'](_0x2105f1(0x2b6),{'val':_0x22e8bd,'ack':!![]});}async function saveFeedback(_0xd35356,_0x29d722){const _0x3a6bab=a0_0x23bf25;_0xd35356[_0x3a6bab(0x1c0)][_0x3a6bab(0x1e2)](_0x3a6bab(0x26e)+JSON['stringify'](_0x29d722));}function a0_0x53ae(){const _0xf21394=['getForeignObjectAsync','analysis.automation.suggestedAction','1120539BbhyPU','getGenerativeModel','ack','system.isPresent','vacation','scanDevices','üåÖ\x20Daily\x20Briefing:\x0a','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','Baseline\x20Status','t√ºr','weatherInstance','GUEST','pr√§senz','values','Deviation','delObjectAsync','heizung','‚ö†Ô∏è\x20ALARM:\x20','PARTY','temperature','targetId','enum.rooms.*','Alert\x20Reason','.\x20KONTEXT:\x20','toString','common','Guardian:\x20Sending\x20','ltmJob','sensorLastValues','targetValue','AI\x20Emergency\x20Status','.\x20OUTPUT:\x20Nur\x20Text.','system','Gemini\x20Init\x20Error:\x20','analysis.comfortSuggestion','reachable','Aktiv\x20(','_calName','enum.functions.*','filter','number','onUnload','PONG','[LOG]','status','analysis.isAlert','Automation\x20Proposals','LTM.driftAnalysis.baselineDrift','getForeignStateAsync','.\x20DATEN:\x20Schlaf\x20','energy','schalter','child_process','instance','LTM.driftAnalysis.driftDetails','\x20for\x20interactive\x20buttons...','\x20min).','Last\x20Result','python3\x20-m\x20pip\x20install\x20-r\x20\x22','unload','NORMAL','Pattern\x20Detected','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','systemUUID','KI-Modell\x20nicht\x20initialisiert','üêç\x20Guardian\x20Diagnosis\x20(','models/gemini-flash-latest','üìû\x20R√ºckruf\x20anfordern','openweathermap','Comfort\x20Summary','bind','connection','slice','ltmLtbWindowDays','presenceDevices','Health\x20Notes','lastIndexOf','isAlert','setObjectNotExistsAsync','notifyPushoverRecipient','stdin','icons-mfd.','getOverviewData','dependencyInstallInProgress','...','[RESULT]','Gemini\x20AI\x20initialized.','408714NULpoY','sort','native','accuweather','targetposition','text.alarm','automation.triggerAction','power','search','\x20Tage)','setpoint','automationProposal','Bibliotheken\x20nicht\x20gefunden','expire','\x20=\x20','.\x20ZUSATZ:\x20','analysis.automation.description','Feedback\x20Log','\x20hours.\x20Potential\x20incapacitation.','link_quality','analysis.health.trendValue','(((.+)+)+)+$','window','occupancy','presence','No\x20module\x20named','party','lastAlertState','LTM.rawEventLog','getForeignObjectsAsync','retry','Action','analysis.automation.targetValue','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','geminiModel','analysis.health.trendDiagnosis','analysis.history_debug_00','LTM.driftAnalysis.lastCheck','9aAnZnp','notifyPushoverEnabled','.communicate.request','from','172792MrnyiO','data','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','custom','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','latitude','string','Error\x20checking\x20WiFi:\x20','‚úÖ\x20Alles\x20OK\x20(Reset)','system.config','2821200FvhjCE','selectedFunctionIds','.NextHours.Location_1.Day_1.current.symbol_desc','generic','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','getCalendarNames','forEach','lights','warn','ltmStbWindowDays','Trigger\x20Action\x20Now','uuid-not-found','getCalendarNames\x20Error:\x20','COGNI_CONFIRM_OK','Drift\x20Analysis','3wAVxhP','Generating\x20Morning\x20Briefing...','level','Exit\x20Sensor\x20triggered\x20(','indicator','isProVersion','baselineDrift','isArray','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','AI\x20Alert\x20Status','LTM.baselineStatus','KALENDER:\x20','triggerDailyDigest','description','Auto\x20Apply\x20Rule','.Summary.Current','parse','toISOString','timestamp','weatherunderground.0','value','setStateAsync','Error:\x20','Cogni-Living','User\x20dismissed\x20automation\x20proposal.','Details:\x20','telegram','split','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','brightness','length','pythonProcess','Restoring\x20sensor\x20cache\x20from\x20history\x20(','set_temperature','replace','LTM.dailyDigests','LTM\x20Sched\x20Error:\x20','fault','off','namespace','weather','PRO-','direction','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','eventHistory','onMessage','time','Daily\x20Digests','getEnums','now','city','Trend\x20Value\x20(%)','dimmer','trim','system.presenceWho','aiPersona','send','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','Alarm','currentposition','endsWith','stateChange','application/json','WETTER:\x20Keine\x20Daten\x20gefunden','none','ltmDriftCheckIntervalHours','main','command','some','switch','lowbat','klima','exitGraceTimer','Processing\x20Status','boolean','extendObjectAsync',').\x20Starting\x20Timer.','simple-api.','cancel','val','path','analysis.isEmergency','admin.','[PYTHON\x20ERR]\x20','version','analysis.health','getObjectAsync','history.','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','join','sendToAsync','08:00','system.mode','Health\x20&\x20Sleep\x20Analysis','\x20sensors...','log','Invalid\x20JSON\x20from\x20Python:\x20','role','getDate','fenster','Description','getStateAsync','getLtmData','flot.','setHours','Adapter','light','motion','setForeignStateAsync','analysisHistory','toLowerCase','config_pending','Who\x20is\x20present?','analysis.automation.autoApply','Gemini\x20Analysis\x20Error:\x20','LTM.triggerDailyDigest','date',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','indexOf','indicator.alarm','isPresent','error','Trigger\x20Digest','briefingEnabled','object','uuid','detected','door','sound','info','analysis.health.sleepScore','livingContext','inactivityThresholdHours','dailyDigests','sendTo','fill','\x20*\x20*\x20*','map','constructor','notifyTelegramInstance','name','type','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','Subscribing\x20to\x20','Last\x20Check','scheduleJob','COGNI_REQUEST_CALL','driftAnalysisTimer','analysis.analysisHistory','minDaysForBaseline','toLocaleString','224852dIGXEl','analysis.activitySummary','Wetter:\x20Deaktiviert','Party','VACATION','onStateChange','event','system.','rawEventLog','state','Kalender:\x20Deaktiviert','lock','\x20|\x20','exitTimer','ANALYZE_TREND','BUTLER\x20Execution\x20Error:\x20','Logbook','Fokus\x20auf\x20Komfort.','PRIORIT√ÑT:\x20Sicherheit.','isGracePeriodActive','\x20events)...','material.','getMonth','Urlaub','analysis.triggerBriefing','System\x20Status\x20&\x20Control','activityLevel','Starting\x20Autopilot\x20(','Keine\x20Details.','calendarInstance','inactivityMonitoringEnabled','humidity','events.lastEvent','analysisTimer','Failed\x20to\x20send\x20to\x20Python:\x20','Activity\x20Summary','dutycycle','python_service','alertReason','analysis.alertReason','vis.','TEST-PRO-KEY','Fokus\x20auf\x20Familienroutinen.','Kein\x20API\x20Key!','testApiKey','systemConfig','onReady','isEmergency','stringify','Briefing\x20Sched\x20Error:\x20','maintenance','push','Reset\x20Sched\x20Error:\x20','unshift','Trigger\x20Analysis','health','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','siren','36222UoJasI','PRIORIT√ÑT:\x20Gesundheit/AAL.','licenseKey','Morning\x20Briefing\x20sent.','Normal','lampe','subscribeForeignStatesAsync','üì°\x20Hooking\x20into\x20','Vom\x20Benutzer\x20best√§tigt\x20(OK).','N/A\x20(Learning)','currentSystemMode','Missing\x20data','notifyEmailInstance','üß™\x20Simulating\x20Butler\x20Proposal:\x20','genAI','_score','python3','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','indicator.alarm.fire','@iobroker/adapter-core','Error\x20in\x20onMessage\x20command\x20','button','payload','KALENDER\x20ERROR:\x20','Comfort\x20Suggestion','cover','notifyTelegramRecipient','analysis.automation.targetId','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','analysis.health.notes','analysis.lastResult','unknown','subscribeStates','0\x203\x20*\x20*\x20*','writable','summary','Sending\x20notification:\x20\x22','.data.table','analysisInterval','licht','driftDetails','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','firmware','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','briefingTime','shutter','Analysiere\x20ausgewogen.','N/A','startsWith','setState','modeResetJob','channel','valve','service.py','openweathermap.0','.\x0a\x20\x20\x20\x20KONTEXT:\x20','write','enum','Scheduling\x20Morning\x20Briefing\x20for\x20','config','Feedback\x20saved:\x20','close','Restlessness\x20Level','accuweather.0','simulateButler','getHours','Success:\x20Compressed\x20','analysis.trigger','KALENDER:\x20Keine\x20Daten','substring','dismissAutomation','details','events.history','message','geminiApiKey','location','analysis.deviationFromBaseline','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','kill','LTM','Target\x20Value','Event\x20received:\x20','Raw\x20Log','splice','feedbackHistory','javascript.','Deaktiviert\x20(Pro-Feature)','ical.0','testNotification','Trend\x20Diagnosis\x20(Python)','scriptEnabled','analysis.automation.patternDetected','@google/generative-ai','submitFeedback','Drift\x20Sched\x20Error:\x20','analysis.automation.triggerAction','üö®\x20EMERGENCY','notifyTelegramEnabled','cogni-living','analysis.comfortSummary','actual_temperature','members','notifyEmailEnabled','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','json','includes','\x20presence\x20devices...','getTime','Lernphase\x20(','events.history_debug_00','140UNdWex','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','online','response','0\x204\x20*\x20*\x20*','text','sleepScore','System\x20Mode','generateContent','279692kKihrO','Entry\x20detected\x20via\x20','callback','Trigger\x20Briefing\x20(Test)','ready','rssi','briefingJob','devices'];a0_0x53ae=function(){return _0xf21394;};return a0_0x53ae();}async function runBaselineDriftAnalysis(_0x17a2d0){const _0x25eb91=a0_0x23bf25;if(!_0x17a2d0[_0x25eb91(0x352)]||!_0x17a2d0[_0x25eb91(0x32c)])return;const _0x561cc3=_0x17a2d0[_0x25eb91(0x26d)]['ltmStbWindowDays']||0xe;if(_0x17a2d0[_0x25eb91(0x1e6)][_0x25eb91(0x36b)]<_0x561cc3+(_0x17a2d0[_0x25eb91(0x26d)][_0x25eb91(0x1f6)]||0x7)){await _0x17a2d0[_0x25eb91(0x362)](LTM_DP_DRIFT_STATUS,{'val':_0x25eb91(0x23b),'ack':!![]});return;}const _0x295041=_0x17a2d0[_0x25eb91(0x1e6)]['slice'](-_0x561cc3),_0x5c167f=_0x17a2d0['dailyDigests'][_0x25eb91(0x2fb)](0x0,_0x17a2d0[_0x25eb91(0x1e6)][_0x25eb91(0x36b)]-_0x561cc3),_0xf364f0=_0x25eb91(0x27f)+JSON[_0x25eb91(0x228)](_0x5c167f)+'\x0aSTB:\x20'+JSON[_0x25eb91(0x228)](_0x295041);try{const _0x4a5ebe=await _0x17a2d0[_0x25eb91(0x32c)][_0x25eb91(0x2a8)](_0xf364f0),_0x4e37f7=JSON[_0x25eb91(0x35d)](_0x4a5ebe['response'][_0x25eb91(0x2a5)]()[_0x25eb91(0x36f)](/```json|```/g,'')[_0x25eb91(0x382)]());_0x4e37f7[_0x25eb91(0x353)]&&(await _0x17a2d0['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x4e37f7[_0x25eb91(0x353)],'ack':!![]}),await _0x17a2d0[_0x25eb91(0x362)](LTM_DP_DRIFT_DETAILS,{'val':_0x4e37f7[_0x25eb91(0x25a)],'ack':!![]}),await _0x17a2d0['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x312067){}}function setupLtmScheduler(_0x1468ad){const _0xa95682=a0_0x23bf25;try{if(_0x1468ad['ltmJob'])_0x1468ad[_0xa95682(0x2ce)][_0xa95682(0x1af)]();if(!_0x1468ad[_0xa95682(0x352)]){_0x1468ad[_0xa95682(0x362)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x1468ad[_0xa95682(0x2ce)]=schedule[_0xa95682(0x1f2)](LTM_SCHEDULE,()=>createDailyDigest(_0x1468ad));}catch(_0x3b77ae){_0x1468ad[_0xa95682(0x1c0)]['error'](_0xa95682(0x371)+_0x3b77ae['message']);}}function setupModeResetScheduler(_0x375996){const _0x4e1fa1=a0_0x23bf25;try{if(_0x375996[_0x4e1fa1(0x264)])_0x375996[_0x4e1fa1(0x264)]['cancel']();_0x375996[_0x4e1fa1(0x264)]=schedule[_0x4e1fa1(0x1f2)](MODE_RESET_SCHEDULE,async()=>{const _0x1b7883=_0x4e1fa1;await loadSystemMode(_0x375996),AUTO_RESET_MODES[_0x1b7883(0x29b)](_0x375996[_0x1b7883(0x23c)])&&await _0x375996[_0x1b7883(0x362)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x498027){_0x375996[_0x4e1fa1(0x1c0)][_0x4e1fa1(0x1da)](_0x4e1fa1(0x22c)+_0x498027[_0x4e1fa1(0x27b)]);}}function setupDriftAnalysisScheduler(_0x274ea7){const _0x3b9581=a0_0x23bf25;try{if(_0x274ea7['driftAnalysisTimer'])clearInterval(_0x274ea7[_0x3b9581(0x1f4)]);if(!_0x274ea7['isProVersion'])return;_0x274ea7[_0x3b9581(0x1f4)]=setInterval(()=>runBaselineDriftAnalysis(_0x274ea7),(_0x274ea7[_0x3b9581(0x26d)][_0x3b9581(0x1a2)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x274ea7),0x1388);}catch(_0xbf4258){_0x274ea7[_0x3b9581(0x1c0)]['error'](_0x3b9581(0x290)+_0xbf4258['message']);}}function setupBriefingScheduler(_0xf3c13c){const _0x203dda=a0_0x23bf25;try{if(_0xf3c13c['briefingJob'])_0xf3c13c['briefingJob'][_0x203dda(0x1af)]();if(!_0xf3c13c[_0x203dda(0x26d)][_0x203dda(0x1dc)])return;const _0x2fb8fd=(_0xf3c13c[_0x203dda(0x26d)][_0x203dda(0x25e)]||_0x203dda(0x1bc))[_0x203dda(0x368)](':'),_0x30aed7=parseInt(_0x2fb8fd[0x0])||0x8,_0x1207ed=parseInt(_0x2fb8fd[0x1])||0x0,_0x28dc94=_0x1207ed+'\x20'+_0x30aed7+_0x203dda(0x1e9);_0xf3c13c[_0x203dda(0x1c0)]['info'](_0x203dda(0x26c)+_0x30aed7+':'+(_0x1207ed<0xa?'0'+_0x1207ed:_0x1207ed)),_0xf3c13c['briefingJob']=schedule[_0x203dda(0x1f2)](_0x28dc94,()=>{sendMorningBriefing(_0xf3c13c);});}catch(_0x5df17b){_0xf3c13c[_0x203dda(0x1c0)][_0x203dda(0x1da)](_0x203dda(0x229)+_0x5df17b[_0x203dda(0x27b)]);}}async function sendNotification(_0x564c01,_0x3ac999,_0x14138b=![],_0x4235e0=![]){const _0x20681d=a0_0x23bf25;_0x564c01[_0x20681d(0x1c0)][_0x20681d(0x1e2)]((_0x14138b?'[TEST]\x20':'')+_0x20681d(0x256)+_0x3ac999+'\x22');const _0x301677=_0x564c01[_0x20681d(0x26d)];let _0x4685fa=0x0;if(_0x301677[_0x20681d(0x293)]){let _0x127d91={};(_0x3ac999['includes'](_0x20681d(0x387))||_0x4235e0)&&(_0x127d91={'reply_markup':{'inline_keyboard':[[{'text':_0x20681d(0x33c),'callback_data':_0x20681d(0x34b)}],[{'text':_0x20681d(0x2f6),'callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0x564c01[_0x20681d(0x1bb)](_0x301677['notifyTelegramInstance'],_0x20681d(0x385),{'text':_0x3ac999,'user':_0x301677[_0x20681d(0x24c)],..._0x127d91}),_0x4685fa++;}if(_0x301677[_0x20681d(0x331)]){let _0x378a37={'message':_0x3ac999,'title':_0x4235e0?_0x20681d(0x292):_0x20681d(0x364),'priority':_0x4235e0?0x2:0x1,'device':_0x301677[_0x20681d(0x302)]};_0x4235e0&&(_0x378a37[_0x20681d(0x328)]=0x1e,_0x378a37[_0x20681d(0x317)]=0xe10,_0x378a37[_0x20681d(0x1e1)]=_0x20681d(0x231)),await _0x564c01['sendToAsync'](_0x301677['notifyPushoverInstance'],'send',_0x378a37),_0x4685fa++;}return _0x301677[_0x20681d(0x298)]&&(await _0x564c01[_0x20681d(0x1bb)](_0x301677[_0x20681d(0x23e)],_0x20681d(0x385),{'text':_0x3ac999,'to':_0x301677['notifyEmailRecipient']}),_0x4685fa++),_0x4685fa;}async function setupTelegramListener(_0x3eced1){const _0x2bc6ec=a0_0x23bf25,_0x4463e5=_0x3eced1[_0x2bc6ec(0x26d)][_0x2bc6ec(0x1ec)];_0x3eced1['config'][_0x2bc6ec(0x293)]&&_0x4463e5&&(_0x3eced1[_0x2bc6ec(0x1c0)]['info'](_0x2bc6ec(0x239)+_0x4463e5+_0x2bc6ec(0x2ea)),await _0x3eced1['subscribeForeignStatesAsync'](_0x4463e5+_0x2bc6ec(0x332)));}async function handleTelegramResponse(_0x11e243,_0x446b74){const _0x508da5=a0_0x23bf25;let _0x270390=_0x446b74;_0x446b74[_0x508da5(0x262)]('[')&&(_0x270390=_0x446b74['substring'](_0x446b74[_0x508da5(0x1d7)](']')+0x1));if(_0x270390===_0x508da5(0x34b))_0x11e243[_0x508da5(0x1c0)]['info'](_0x508da5(0x342)),await _0x11e243[_0x508da5(0x362)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x11e243[_0x508da5(0x362)](_0x508da5(0x21f),{'val':_0x508da5(0x23a),'ack':!![]}),_0x11e243[_0x508da5(0x325)]=![],sendNotification(_0x11e243,_0x508da5(0x243),![]);else _0x270390===_0x508da5(0x1f3)&&(_0x11e243[_0x508da5(0x1c0)]['warn']('üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x11e243,_0x508da5(0x355),![],!![]));}async function runAutopilot(_0x18f766){const _0x29bb80=a0_0x23bf25,_0x29bd41=_0x18f766['config']['inactivityThresholdHours'],_0x5aa82e=_0x18f766[_0x29bb80(0x379)][_0x29bb80(0x36b)]>0x0?_0x18f766[_0x29bb80(0x379)][0x0][_0x29bb80(0x35f)]:Date[_0x29bb80(0x37e)](),_0x31f4a6=(Date['now']()-_0x5aa82e)/(0x3e8*0x3c*0x3c);let _0x17815b='';_0x18f766[_0x29bb80(0x26d)][_0x29bb80(0x216)]&&_0x18f766['currentSystemMode']===SYSTEM_MODES[_0x29bb80(0x2ef)]&&_0x18f766[_0x29bb80(0x1d9)]&&(_0x31f4a6>_0x29bd41&&(_0x17815b=_0x29bb80(0x32b)+_0x31f4a6['toFixed'](0x1)+_0x29bb80(0x31c))),runGeminiAnalysis(_0x18f766,_0x17815b)['catch'](_0xc6b5a4=>_0x18f766[_0x29bb80(0x1c0)][_0x29bb80(0x1da)](_0xc6b5a4));}async function createDailyDigest(_0x5f3396){const _0x31d294=a0_0x23bf25;if(!_0x5f3396[_0x31d294(0x352)])return;await _0x5f3396['setStateAsync'](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()[_0x31d294(0x1f7)](),'ack':!![]});if(!_0x5f3396['geminiModel']||_0x5f3396[_0x31d294(0x200)][_0x31d294(0x36b)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x5f3396[_0x31d294(0x362)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x2b336d=JSON[_0x31d294(0x35d)](JSON[_0x31d294(0x228)](_0x5f3396[_0x31d294(0x200)])),_0x3e3393=_0x2b336d[_0x31d294(0x36b)],_0x388836=_0x31d294(0x25b)+JSON[_0x31d294(0x228)](_0x2b336d);try{const _0x263eee=await _0x5f3396[_0x31d294(0x32c)][_0x31d294(0x2a8)](_0x388836),_0x368988=JSON['parse'](_0x263eee['response'][_0x31d294(0x2a5)]()[_0x31d294(0x36f)](/```json|```/g,'')['trim']());_0x368988['summary']&&(_0x5f3396[_0x31d294(0x1e6)][_0x31d294(0x22b)]({'timestamp':new Date()[_0x31d294(0x35e)](),'eventCount':_0x3e3393,'summary':_0x368988[_0x31d294(0x255)],'activityLevel':_0x368988[_0x31d294(0x212)],'systemMode':_0x5f3396[_0x31d294(0x23c)]}),await saveDailyDigests(_0x5f3396),_0x5f3396['rawEventLog']=[],await saveRawEventLog(_0x5f3396),await _0x5f3396[_0x31d294(0x362)](LTM_DP_STATUS,{'val':_0x31d294(0x274)+_0x3e3393+'\x20events','ack':!![]}),runPythonHealthCheck(_0x5f3396));}catch(_0x3c9cd8){await _0x5f3396['setStateAsync'](LTM_DP_STATUS,{'val':_0x31d294(0x363)+_0x3c9cd8['message'],'ack':!![]});}}async function sendMorningBriefing(_0x110413){const _0x14a983=a0_0x23bf25;if(!_0x110413[_0x14a983(0x32c)])return;_0x110413[_0x14a983(0x1c0)][_0x14a983(0x1e2)](_0x14a983(0x34e));const _0x43db7a=_0x110413[_0x14a983(0x1e6)][_0x14a983(0x36b)]>0x0?_0x110413['dailyDigests'][_0x110413[_0x14a983(0x1e6)][_0x14a983(0x36b)]-0x1]:null,_0x5348d9=_0x43db7a&&_0x43db7a[_0x14a983(0x22f)]?_0x43db7a[_0x14a983(0x22f)][_0x14a983(0x2a6)]:_0x14a983(0x261),_0x5a9761=new Date();_0x5a9761[_0x14a983(0x1c9)](0x4,0x0,0x0,0x0);const _0x458513=_0x110413['eventHistory'][_0x14a983(0x2da)](_0x24ef2e=>new Date(_0x24ef2e[_0x14a983(0x35f)])>_0x5a9761),_0x348c15=PERSONA_MAPPING[_0x110413[_0x14a983(0x26d)][_0x14a983(0x384)]||_0x14a983(0x341)],_0x474855=_0x110413['config'][_0x14a983(0x1e4)]||'',_0x114d5a=await getWeatherContext(_0x110413),_0x2786fd=await getCalendarContext(_0x110413),_0x1d3ffd=_0x14a983(0x299)+_0x348c15+_0x14a983(0x2ca)+_0x474855+_0x14a983(0x319)+_0x114d5a+'\x20'+_0x2786fd+_0x14a983(0x2e4)+_0x5348d9+_0x14a983(0x2ba)+JSON[_0x14a983(0x228)](_0x458513[_0x14a983(0x2fb)](0x0,0xa))+_0x14a983(0x2d2);try{const _0x488d26=await _0x110413[_0x14a983(0x32c)][_0x14a983(0x2a8)](_0x1d3ffd),_0x46ca3e=_0x14a983(0x2b9)+_0x488d26[_0x14a983(0x2a3)][_0x14a983(0x2a5)]()['trim']();sendNotification(_0x110413,_0x46ca3e),_0x110413[_0x14a983(0x1c0)][_0x14a983(0x1e2)](_0x14a983(0x235));}catch(_0x34b7cd){_0x110413['log'][_0x14a983(0x1da)]('Briefing\x20Error:\x20'+_0x34b7cd['message']);}}async function scanForDevices(_0x4fe15e,_0x231f61){const _0x93d973=a0_0x23bf25;_0x4fe15e[_0x93d973(0x1c0)][_0x93d973(0x1e2)](_0x93d973(0x2f1));const _0x50c1f9=[],_0x4194f8=await _0x4fe15e['getForeignObjectsAsync']('*'),_0x3b5e79=await _0x4fe15e[_0x93d973(0x327)](_0x93d973(0x2d9),_0x93d973(0x26b)),_0x831b3f=await _0x4fe15e['getForeignObjectsAsync'](_0x93d973(0x2c8),_0x93d973(0x26b)),_0x186fab={};if(_0x3b5e79)for(const _0x34ce29 in _0x3b5e79){const _0x3eff8c=_0x3b5e79[_0x34ce29][_0x93d973(0x2cc)][_0x93d973(0x297)]||[];_0x3eff8c[_0x93d973(0x344)](_0x4125ce=>{const _0x3d7622=_0x93d973;if(!_0x186fab[_0x4125ce])_0x186fab[_0x4125ce]=[];_0x186fab[_0x4125ce][_0x3d7622(0x22b)](_0x34ce29);});}const _0x55de11={};if(_0x831b3f)for(const _0x58132f in _0x831b3f){const _0xa76ebb=_0x831b3f[_0x58132f][_0x93d973(0x2cc)]['members']||[],_0x136ff8=typeof _0x831b3f[_0x58132f][_0x93d973(0x2cc)][_0x93d973(0x1ed)]==='object'?_0x831b3f[_0x58132f][_0x93d973(0x2cc)][_0x93d973(0x1ed)]['de']:_0x831b3f[_0x58132f][_0x93d973(0x2cc)][_0x93d973(0x1ed)];_0xa76ebb[_0x93d973(0x344)](_0x1e1e19=>_0x55de11[_0x1e1e19]=_0x136ff8);}const _0x18099a=_0x231f61[_0x93d973(0x33f)]||[],_0x54f999=_0x231f61[_0x93d973(0x1cc)]!==![],_0x4273da=_0x231f61['doors']!==![],_0x51424a=_0x231f61[_0x93d973(0x345)]!==![],_0x57af70=_0x231f61[_0x93d973(0x2c6)]===!![],_0x4cd3bb=_0x231f61[_0x93d973(0x375)]===!![];for(const _0x2c0bd1 in _0x4194f8){const _0x39629b=_0x4194f8[_0x2c0bd1];if(_0x39629b['type']!==_0x93d973(0x201)||!_0x39629b[_0x93d973(0x2cc)])continue;if(ADAPTER_BLACKLIST['some'](_0xe9ace2=>_0x2c0bd1[_0x93d973(0x262)](_0xe9ace2))&&!_0x4cd3bb)continue;const _0x114b01=(_0x39629b[_0x93d973(0x2cc)][_0x93d973(0x1c2)]||'')[_0x93d973(0x1cf)]();let _0x1fec06=(typeof _0x39629b[_0x93d973(0x2cc)][_0x93d973(0x1ed)]===_0x93d973(0x1dd)?_0x39629b[_0x93d973(0x2cc)]['name']['de']:_0x39629b[_0x93d973(0x2cc)][_0x93d973(0x1ed)])||_0x2c0bd1;const _0x467678=_0x1fec06['toLowerCase']();let _0xd2ea04=![],_0x5cf038=![];if(_0x18099a[_0x93d973(0x36b)]>0x0){const _0x29c26e=_0x186fab[_0x2c0bd1]||[],_0x1ee507=_0x2c0bd1['split']('.')[_0x93d973(0x2fb)](0x0,-0x1)[_0x93d973(0x1ba)]('.'),_0x13609f=_0x186fab[_0x1ee507]||[];(_0x29c26e[_0x93d973(0x1a5)](_0x72359b=>_0x18099a[_0x93d973(0x29b)](_0x72359b))||_0x13609f[_0x93d973(0x1a5)](_0x1780c6=>_0x18099a[_0x93d973(0x29b)](_0x1780c6)))&&(_0xd2ea04=!![],_0x5cf038=!![]);}if(!_0xd2ea04&&!_0x4cd3bb){if(HARD_IGNORE_TERMS[_0x93d973(0x1a5)](_0xdac568=>_0x2c0bd1[_0x93d973(0x29b)](_0xdac568)||_0x467678[_0x93d973(0x29b)](_0xdac568[_0x93d973(0x1cf)]())))continue;}if(BAD_NAMES[_0x93d973(0x1a5)](_0x36f8fb=>_0x467678===_0x36f8fb||_0x467678[_0x93d973(0x389)]('.'+_0x36f8fb))){const _0x52ce7d=_0x2c0bd1['split']('.');if(_0x52ce7d[_0x93d973(0x36b)]>0x2){const _0x4e7fb3=_0x52ce7d[_0x93d973(0x2fb)](0x0,-0x1)[_0x93d973(0x1ba)]('.'),_0x4da38f=_0x4194f8[_0x4e7fb3];if(_0x4da38f&&_0x4da38f[_0x93d973(0x2cc)]&&_0x4da38f['common']['name']){const _0x25caba=typeof _0x4da38f[_0x93d973(0x2cc)][_0x93d973(0x1ed)]===_0x93d973(0x1dd)?_0x4da38f['common']['name']['de']:_0x4da38f[_0x93d973(0x2cc)]['name'];_0x25caba&&!_0x1fec06['includes'](_0x25caba)&&(_0x1fec06=_0x25caba+'\x20'+_0x1fec06);}}}let _0x131caa='';if(_0x54f999&&(_0x114b01['includes'](_0x93d973(0x1cc))||_0x114b01['includes'](_0x93d973(0x321))||_0x467678[_0x93d973(0x29b)]('bewegung')||_0x467678[_0x93d973(0x29b)](_0x93d973(0x2bf))))_0x131caa=_0x93d973(0x1cc);else{if(!_0x131caa&&_0x4273da&&(_0x114b01[_0x93d973(0x29b)](_0x93d973(0x1e0))||_0x114b01['includes'](_0x93d973(0x320))||_0x114b01[_0x93d973(0x29b)](_0x93d973(0x203))||_0x114b01[_0x93d973(0x29b)]('blind')||_0x114b01[_0x93d973(0x29b)](_0x93d973(0x25f))||_0x467678[_0x93d973(0x29b)](_0x93d973(0x1c4))||_0x467678['includes'](_0x93d973(0x2bc))||_0x467678[_0x93d973(0x29b)]('rollladen')))_0x131caa=_0x93d973(0x1e0);else{if(!_0x131caa&&_0x51424a&&(_0x114b01[_0x93d973(0x29b)](_0x93d973(0x1cb))||_0x114b01[_0x93d973(0x29b)](_0x93d973(0x1a6))||_0x114b01[_0x93d973(0x29b)](_0x93d973(0x381))||_0x467678['includes'](_0x93d973(0x259))||_0x467678[_0x93d973(0x29b)](_0x93d973(0x237))||_0x467678['includes'](_0x93d973(0x2e6)))){if(_0x39629b[_0x93d973(0x2cc)][_0x93d973(0x26a)]||_0x114b01[_0x93d973(0x29b)]('sensor'))_0x131caa=_0x93d973(0x1cb);}else{if(!_0x131caa&&_0x57af70&&(_0x114b01['includes']('temperature')||_0x114b01[_0x93d973(0x29b)](_0x93d973(0x217))||_0x114b01[_0x93d973(0x29b)]('thermostat')||_0x467678[_0x93d973(0x29b)]('temp')||_0x467678[_0x93d973(0x29b)](_0x93d973(0x1a8))||_0x467678['includes'](_0x93d973(0x2c3))))_0x131caa='temperature';else{if(!_0x131caa&&_0x5cf038)_0x131caa=_0x93d973(0x337);}}}}if(_0x131caa){let _0x66acf4=_0x55de11[_0x2c0bd1]||'';if(!_0x66acf4){let _0x5e948d=_0x2c0bd1;for(let _0x536141=0x0;_0x536141<0x3;_0x536141++){const _0x1a7795=_0x5e948d[_0x93d973(0x2ff)]('.');if(_0x1a7795===-0x1)break;_0x5e948d=_0x5e948d[_0x93d973(0x277)](0x0,_0x1a7795);if(_0x55de11[_0x5e948d]){_0x66acf4=_0x55de11[_0x5e948d];break;}}}_0x50c1f9[_0x93d973(0x22b)]({'id':_0x2c0bd1,'name':_0x1fec06,'location':_0x66acf4,'type':_0x131caa,'logDuplicates':_0x131caa===_0x93d973(0x1cc),'isExit':![],'_score':_0x66acf4?0x50:_0x131caa==='custom'?0x5a:0x28});}}return _0x50c1f9[_0x93d973(0x30b)]((_0x331059,_0x26883f)=>_0x26883f[_0x93d973(0x241)]-_0x331059['_score']),_0x50c1f9;}async function executeAutomationAction(_0x3c93b9){const _0x8cf416=a0_0x23bf25;try{const _0xb45d38=await _0x3c93b9[_0x8cf416(0x1c6)]('analysis.automation.targetId'),_0x67ce12=await _0x3c93b9[_0x8cf416(0x1c6)](_0x8cf416(0x32a));if(_0xb45d38&&_0xb45d38[_0x8cf416(0x1b0)]&&_0x67ce12){const _0x628e98=_0xb45d38[_0x8cf416(0x1b0)];let _0x29d8d5=_0x67ce12['val'];try{_0x29d8d5=JSON['parse'](_0x29d8d5);}catch(_0x1a6d1b){}_0x3c93b9[_0x8cf416(0x1c0)][_0x8cf416(0x1e2)]('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x628e98+_0x8cf416(0x318)+_0x29d8d5),await _0x3c93b9[_0x8cf416(0x1cd)](_0x628e98,_0x29d8d5);}else _0x3c93b9[_0x8cf416(0x1c0)][_0x8cf416(0x346)](_0x8cf416(0x24e));}catch(_0x504427){_0x3c93b9[_0x8cf416(0x1c0)][_0x8cf416(0x1da)](_0x8cf416(0x207)+_0x504427[_0x8cf416(0x27b)]);}}function tryParse(_0x1f2c64){try{return JSON['parse'](_0x1f2c64);}catch(_0x17e8b2){return null;}}async function processSensorEvent(_0x471338,_0x2d8db3,_0x14394f,_0x4c9e54){const _0xbaff32=a0_0x23bf25;if(!_0x4c9e54)return;const _0x5da126=_0x14394f['val'],_0x3760f3=Date[_0xbaff32(0x37e)]();_0x471338[_0xbaff32(0x1c0)]['debug'](_0xbaff32(0x283)+_0x2d8db3+'\x20=\x20'+_0x5da126);const _0x23aa82=_0x471338[_0xbaff32(0x2cf)][_0x2d8db3];_0x471338[_0xbaff32(0x2cf)][_0x2d8db3]=_0x5da126;if(!_0x4c9e54['logDuplicates']&&_0x23aa82!=undefined&&_0x23aa82==_0x5da126){_0x471338[_0xbaff32(0x1c0)]['debug']('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x4c9e54[_0xbaff32(0x1ed)]+'\x20(Value:\x20'+_0x5da126+')');return;}const _0x358ca7={'timestamp':_0x3760f3,'id':_0x2d8db3,'name':_0x4c9e54['name'],'type':_0x4c9e54[_0xbaff32(0x1ee)],'location':_0x4c9e54[_0xbaff32(0x27d)],'value':_0x5da126};_0x471338['eventHistory'][_0xbaff32(0x22d)](_0x358ca7);if(_0x471338['eventHistory'][_0xbaff32(0x36b)]>HISTORY_MAX_SIZE)_0x471338[_0xbaff32(0x379)]['pop']();await _0x471338['setStateAsync'](_0xbaff32(0x218),{'val':JSON[_0xbaff32(0x228)](_0x358ca7),'ack':!![]}),await _0x471338[_0xbaff32(0x362)](_0xbaff32(0x27a),{'val':JSON[_0xbaff32(0x228)](_0x471338[_0xbaff32(0x379)]),'ack':!![]});_0x471338[_0xbaff32(0x352)]&&(_0x471338['rawEventLog'][_0xbaff32(0x22b)](_0x358ca7),await saveRawEventLog(_0x471338));if(_0x4c9e54['isExit']&&_0x5da126===!![]){if(_0x471338[_0xbaff32(0x1d9)]&&!_0x471338[_0xbaff32(0x20b)])_0x471338['log']['info'](_0xbaff32(0x350)+_0x4c9e54['name']+_0xbaff32(0x1ad)),startExitTimer(_0x471338);else!_0x471338[_0xbaff32(0x1d9)]&&(_0x471338[_0xbaff32(0x1c0)][_0xbaff32(0x1e2)](_0xbaff32(0x2aa)+_0x4c9e54[_0xbaff32(0x1ed)]+'.\x20Welcome\x20home.'),await setPresence(_0x471338,!![]));}else _0x4c9e54[_0xbaff32(0x1ee)]===_0xbaff32(0x1cc)&&_0x5da126===!![]&&(_0x471338[_0xbaff32(0x205)]&&(_0x471338[_0xbaff32(0x1c0)]['info'](_0xbaff32(0x25d)),abortExitTimer(_0x471338)),!_0x471338[_0xbaff32(0x1d9)]&&_0x471338[_0xbaff32(0x23c)]===SYSTEM_MODES[_0xbaff32(0x2ef)]&&await setPresence(_0x471338,!![]));}async function runGeminiAnalysis(_0x10be30,_0x48111d=''){const _0x41aa8a=a0_0x23bf25;if(!_0x10be30[_0x41aa8a(0x32c)])return;if(_0x10be30[_0x41aa8a(0x379)]['length']===0x0)return;const _0x45073b=_0x10be30[_0x41aa8a(0x379)]['slice'](0x0,0xf),_0x29094b=await getWeatherContext(_0x10be30),_0x4558fc=_0x10be30[_0x41aa8a(0x23c)],_0x1038fd=PERSONA_MAPPING[_0x10be30['config'][_0x41aa8a(0x384)]||_0x41aa8a(0x341)],_0x1389bf=_0x10be30[_0x41aa8a(0x26d)]['livingContext']||_0x41aa8a(0x214);let _0x529645=![];try{const _0x3fc09c=await _0x10be30[_0x41aa8a(0x1c6)](_0x41aa8a(0x1d2));if(_0x3fc09c&&_0x3fc09c[_0x41aa8a(0x1b0)])_0x529645=!![];}catch(_0x52ef63){}const _0x36982f=_0x41aa8a(0x1b9)+_0x1038fd+_0x41aa8a(0x269)+_0x1389bf+'.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20'+_0x4558fc+'.\x0a\x20\x20\x20\x20WETTER:\x20'+_0x29094b+_0x41aa8a(0x230)+(_0x48111d||'Keiner')+_0x41aa8a(0x369)+JSON['stringify'](_0x45073b)+'\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20';try{const _0x3ce159=await _0x10be30['geminiModel'][_0x41aa8a(0x2a8)](_0x36982f),_0x5854e7=_0x3ce159['response'][_0x41aa8a(0x2a5)]()[_0x41aa8a(0x36f)](/```json|```/g,'')[_0x41aa8a(0x382)](),_0x5e368f=JSON[_0x41aa8a(0x35d)](_0x5854e7);await _0x10be30['setStateAsync']('analysis.lastResult',{'val':JSON[_0x41aa8a(0x228)](_0x5e368f),'ack':!![]});const _0x193d20=_0x5e368f[_0x41aa8a(0x300)]||![];_0x193d20!==_0x10be30['lastAlertState']&&(await _0x10be30['setStateAsync'](_0x41aa8a(0x2e0),{'val':_0x193d20,'ack':!![]}),_0x10be30[_0x41aa8a(0x325)]=_0x193d20,_0x193d20&&(await _0x10be30[_0x41aa8a(0x362)](_0x41aa8a(0x21f),{'val':_0x5e368f[_0x41aa8a(0x21e)],'ack':!![]}),sendNotification(_0x10be30,_0x41aa8a(0x2c4)+_0x5e368f[_0x41aa8a(0x21e)],![],_0x5e368f[_0x41aa8a(0x227)]))),_0x5e368f[_0x41aa8a(0x315)]&&_0x5e368f[_0x41aa8a(0x315)][_0x41aa8a(0x1df)]&&_0x5e368f['automationProposal']['targetId']&&(_0x10be30['log'][_0x41aa8a(0x1e2)](_0x41aa8a(0x338)+_0x5e368f[_0x41aa8a(0x315)][_0x41aa8a(0x35a)]),await _0x10be30[_0x41aa8a(0x362)](_0x41aa8a(0x28d),{'val':!![],'ack':!![]}),await _0x10be30['setStateAsync'](_0x41aa8a(0x31a),{'val':_0x5e368f['automationProposal'][_0x41aa8a(0x35a)],'ack':!![]}),await _0x10be30[_0x41aa8a(0x362)](_0x41aa8a(0x24d),{'val':_0x5e368f[_0x41aa8a(0x315)][_0x41aa8a(0x2c7)],'ack':!![]}),await _0x10be30['setStateAsync'](_0x41aa8a(0x32a),{'val':JSON['stringify'](_0x5e368f[_0x41aa8a(0x315)][_0x41aa8a(0x2d0)]),'ack':!![]}),_0x529645&&(_0x10be30[_0x41aa8a(0x1c0)]['info']('ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20'+_0x5e368f[_0x41aa8a(0x315)][_0x41aa8a(0x2c7)]+'...'),await executeAutomationAction(_0x10be30)));}catch(_0x57c88b){_0x10be30[_0x41aa8a(0x1c0)][_0x41aa8a(0x1da)](_0x41aa8a(0x1d3)+_0x57c88b['message']);}}function installPythonDependencies(_0xb7f471){const _0x20a19e=a0_0x23bf25;if(_0xb7f471['dependencyInstallInProgress'])return;_0xb7f471[_0x20a19e(0x306)]=!![];const _0x369d3c=path[_0x20a19e(0x1ba)](__dirname,_0x20a19e(0x21d),'requirements.txt');_0xb7f471[_0x20a19e(0x1c0)][_0x20a19e(0x1e2)]('üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20'+_0x369d3c+_0x20a19e(0x307)),stopPythonService(_0xb7f471);const _0x4002c7=_0x20a19e(0x2ed)+_0x369d3c+'\x22\x20--break-system-packages';exec(_0x4002c7,(_0xd7bf55,_0x18b0ec,_0x29fee7)=>{const _0xe447b1=_0x20a19e;_0xb7f471[_0xe447b1(0x306)]=![],_0xd7bf55?(_0xb7f471[_0xe447b1(0x1c0)]['error']('‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x4002c7),_0xb7f471[_0xe447b1(0x1c0)][_0xe447b1(0x1da)](_0xe447b1(0x366)+(_0x29fee7||_0xd7bf55[_0xe447b1(0x27b)]))):(_0xb7f471[_0xe447b1(0x1c0)]['info']('‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...'),startPythonService(_0xb7f471));});}function sendToPython(_0x40a23d,_0x2ff4f6,_0x5d3a90={}){const _0x1f1af8=a0_0x23bf25;if(!_0x40a23d[_0x1f1af8(0x36c)]||!_0x40a23d[_0x1f1af8(0x36c)][_0x1f1af8(0x303)][_0x1f1af8(0x254)])return;const _0x10a981=JSON[_0x1f1af8(0x228)]({'command':_0x2ff4f6,..._0x5d3a90});try{_0x40a23d[_0x1f1af8(0x36c)][_0x1f1af8(0x303)][_0x1f1af8(0x26a)](_0x10a981+'\x0a');}catch(_0x47b7b6){_0x40a23d['log'][_0x1f1af8(0x1da)](_0x1f1af8(0x21a)+_0x47b7b6['message']);}}function runPythonHealthCheck(_0x42c029){const _0x53749c=a0_0x23bf25;if(!_0x42c029[_0x53749c(0x1e6)]||_0x42c029[_0x53749c(0x1e6)][_0x53749c(0x36b)]<0x2){_0x42c029[_0x53749c(0x1c0)][_0x53749c(0x1e2)](_0x53749c(0x1ef));return;}const _0xbec71a=_0x42c029['dailyDigests'][_0x53749c(0x1ea)](_0x27aabc=>{const _0x11453e=_0x53749c,_0x154ed6=(_0x27aabc[_0x11453e(0x212)]||'')[_0x11453e(0x1cf)]();return ACTIVITY_LEVEL_MAP[_0x154ed6]||0x32;});_0x42c029[_0x53749c(0x1c0)]['info'](_0x53749c(0x2cd)+_0xbec71a['length']+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x42c029,_0x53749c(0x206),{'values':_0xbec71a,'tag':'Activity-Level'});}function handlePythonResult(_0x44b032,_0x2e2cdb){const _0x2e6187=a0_0x23bf25;if(_0x2e2cdb['type']===_0x2e6187(0x2dd))_0x44b032[_0x2e6187(0x1c0)]['debug']('üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.');else{if(_0x2e2cdb[_0x2e6187(0x1ee)]==='TREND_RESULT'){const {tag:_0x1494a5,diagnosis:_0x37be9c,change_percent:_0x26652c}=_0x2e2cdb[_0x2e6187(0x248)];_0x44b032[_0x2e6187(0x1c0)][_0x2e6187(0x1e2)](_0x2e6187(0x2f4)+_0x1494a5+'):\x20'+_0x37be9c+'\x20('+_0x26652c+'%)'),_0x44b032[_0x2e6187(0x362)](_0x2e6187(0x32d),{'val':_0x37be9c,'ack':!![]}),_0x44b032[_0x2e6187(0x362)](_0x2e6187(0x31e),{'val':_0x26652c,'ack':!![]});}}}function startPythonService(_0x4629d9){const _0x722d32=a0_0x23bf25;try{const _0x372d80=path[_0x722d32(0x1ba)](__dirname,'python_service',_0x722d32(0x267));_0x4629d9['log'][_0x722d32(0x1e2)]('üêç\x20Starting\x20Python\x20Sidecar:\x20'+_0x372d80),_0x4629d9[_0x722d32(0x36c)]=spawn(_0x722d32(0x242),[_0x372d80]),_0x4629d9[_0x722d32(0x36c)]['stdout']['on'](_0x722d32(0x335),_0x482ee6=>{const _0x4801b7=_0x722d32,_0x23b741=_0x482ee6[_0x4801b7(0x2cb)]()[_0x4801b7(0x368)]('\x0a');_0x23b741['forEach'](_0x153a4c=>{const _0x37ea27=_0x4801b7,_0x560237=_0x153a4c['trim']();if(!_0x560237)return;if(_0x560237[_0x37ea27(0x262)](_0x37ea27(0x2de)))_0x4629d9[_0x37ea27(0x1c0)]['debug']('[PYTHON]\x20'+_0x560237['substring'](0x5)[_0x37ea27(0x382)]());else{if(_0x560237['startsWith'](_0x37ea27(0x308)))try{const _0x5557ee=JSON['parse'](_0x560237[_0x37ea27(0x277)](0x8)[_0x37ea27(0x382)]());handlePythonResult(_0x4629d9,_0x5557ee);}catch(_0xc249a3){_0x4629d9[_0x37ea27(0x1c0)][_0x37ea27(0x346)](_0x37ea27(0x1c1)+_0x560237);}}(_0x560237[_0x37ea27(0x29b)](_0x37ea27(0x323))||_0x560237[_0x37ea27(0x29b)](_0x37ea27(0x316)))&&(_0x4629d9[_0x37ea27(0x1c0)][_0x37ea27(0x346)](_0x37ea27(0x378)),installPythonDependencies(_0x4629d9));});}),_0x4629d9[_0x722d32(0x36c)]['stderr']['on']('data',_0xd16f17=>{const _0x2de126=_0x722d32,_0x26b8e5=_0xd16f17[_0x2de126(0x2cb)]()[_0x2de126(0x382)]();_0x4629d9[_0x2de126(0x1c0)][_0x2de126(0x1da)](_0x2de126(0x1b4)+_0x26b8e5);}),_0x4629d9['pythonProcess']['on'](_0x722d32(0x26f),_0x1c7c39=>{const _0x3b84d1=_0x722d32;_0x4629d9[_0x3b84d1(0x1c0)][_0x3b84d1(0x1e2)]('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x1c7c39),_0x4629d9[_0x3b84d1(0x36c)]=null;}),_0x4629d9[_0x722d32(0x36c)]['on'](_0x722d32(0x1da),_0xb487e7=>{const _0x497a67=_0x722d32;_0x4629d9[_0x497a67(0x1c0)][_0x497a67(0x346)](_0x497a67(0x386)+_0xb487e7[_0x497a67(0x27b)]);});}catch(_0x53e911){_0x4629d9[_0x722d32(0x1c0)][_0x722d32(0x1da)]('Error\x20launching\x20Python\x20service:\x20'+_0x53e911['message']);}}function stopPythonService(_0x229a90){const _0x2e1c3a=a0_0x23bf25;if(_0x229a90[_0x2e1c3a(0x36c)]){_0x229a90[_0x2e1c3a(0x1c0)]['info']('üêç\x20Stopping\x20Python\x20Sidecar...');try{_0x229a90['pythonProcess'][_0x2e1c3a(0x280)]();}catch(_0x347664){_0x229a90['log'][_0x2e1c3a(0x346)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x347664[_0x2e1c3a(0x27b)]);}_0x229a90[_0x2e1c3a(0x36c)]=null;}}class CogniLiving extends utils[a0_0x23bf25(0x1ca)]{constructor(_0x86dd20){const _0x2cbbd2=a0_0x23bf25;super({..._0x86dd20,'name':_0x2cbbd2(0x294)}),this['eventHistory']=[],this['analysisHistory']=[],this[_0x2cbbd2(0x286)]=[],this['rawEventLog']=[],this[_0x2cbbd2(0x1e6)]=[],this[_0x2cbbd2(0x2cf)]={},this[_0x2cbbd2(0x225)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x2cbbd2(0x1d9)]=!![],this[_0x2cbbd2(0x205)]=null,this[_0x2cbbd2(0x1a9)]=null,this[_0x2cbbd2(0x20b)]=![],this[_0x2cbbd2(0x240)]=null,this[_0x2cbbd2(0x32c)]=null,this[_0x2cbbd2(0x23c)]=SYSTEM_MODES['NORMAL'],this[_0x2cbbd2(0x352)]=![],this[_0x2cbbd2(0x325)]=![],this[_0x2cbbd2(0x2f2)]=_0x2cbbd2(0x251),this[_0x2cbbd2(0x219)]=null,this['ltmJob']=null,this['modeResetJob']=null,this[_0x2cbbd2(0x1f4)]=null,this[_0x2cbbd2(0x2af)]=null,this['pythonProcess']=null,this[_0x2cbbd2(0x306)]=![],this['on'](_0x2cbbd2(0x2ad),this[_0x2cbbd2(0x226)]['bind'](this)),this['on'](_0x2cbbd2(0x38a),this[_0x2cbbd2(0x1fd)][_0x2cbbd2(0x2f9)](this)),this['on'](_0x2cbbd2(0x2ee),this[_0x2cbbd2(0x2dc)]['bind'](this)),this['on'](_0x2cbbd2(0x27b),this[_0x2cbbd2(0x37a)][_0x2cbbd2(0x2f9)](this));}async[a0_0x23bf25(0x226)](){const _0x42367a=a0_0x23bf25;this[_0x42367a(0x1c0)][_0x42367a(0x1e2)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x42367a(0x1b5)]+_0x42367a(0x1d6)),await initZombies(this),this[_0x42367a(0x26d)]['licenseKey']=this[_0x42367a(0x26d)][_0x42367a(0x234)]||'';try{this[_0x42367a(0x352)]=await checkLicense(this,this[_0x42367a(0x26d)][_0x42367a(0x234)]);}catch(_0x2c58d3){}if(!this[_0x42367a(0x26d)][_0x42367a(0x1e5)]||this[_0x42367a(0x26d)][_0x42367a(0x1e5)]<0.1)this[_0x42367a(0x26d)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x42367a(0x26d)][_0x42367a(0x27c)])try{this[_0x42367a(0x240)]=new GoogleGenerativeAI(this['config']['geminiApiKey']),this[_0x42367a(0x32c)]=this[_0x42367a(0x240)][_0x42367a(0x2b4)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x42367a(0x38b)}}),this[_0x42367a(0x1c0)][_0x42367a(0x1e2)](_0x42367a(0x309));}catch(_0x43024d){this[_0x42367a(0x1c0)][_0x42367a(0x1da)](_0x42367a(0x2d4)+_0x43024d['message']);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x42367a(0x252)](_0x42367a(0x275)),this[_0x42367a(0x252)](LTM_DP_TRIGGER_DIGEST),this[_0x42367a(0x252)](_0x42367a(0x1bd)),this[_0x42367a(0x252)](_0x42367a(0x210)),this[_0x42367a(0x252)](_0x42367a(0x291)),this[_0x42367a(0x252)](_0x42367a(0x1d2)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x42367a(0x219)])clearInterval(this[_0x42367a(0x219)]);const _0x2a0b79=this[_0x42367a(0x26d)][_0x42367a(0x258)]||0xf;_0x2a0b79>0x0&&(this['log'][_0x42367a(0x1e2)](_0x42367a(0x213)+_0x2a0b79+_0x42367a(0x2eb)),this[_0x42367a(0x219)]=setInterval(()=>{runAutopilot(this);},_0x2a0b79*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{this['pythonProcess']&&runPythonHealthCheck(this);},0x1388);}['onUnload'](_0x35f2f5){const _0x100133=a0_0x23bf25;if(this['analysisTimer'])clearInterval(this[_0x100133(0x219)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x100133(0x1f4)]);if(this[_0x100133(0x2ce)])this[_0x100133(0x2ce)][_0x100133(0x1af)]();if(this[_0x100133(0x264)])this[_0x100133(0x264)][_0x100133(0x1af)]();if(this[_0x100133(0x2af)])this[_0x100133(0x2af)][_0x100133(0x1af)]();if(this[_0x100133(0x205)])clearTimeout(this[_0x100133(0x205)]);if(this['exitGraceTimer'])clearTimeout(this[_0x100133(0x1a9)]);stopPythonService(this),_0x35f2f5();}async[a0_0x23bf25(0x1fd)](_0x4875d2,_0x35e3c1){const _0x98a504=a0_0x23bf25;if(!_0x35e3c1)return;if(_0x4875d2['includes'](_0x98a504(0x367))&&_0x4875d2['endsWith']('communicate.request')&&_0x35e3c1[_0x98a504(0x1b0)]){await handleTelegramResponse(this,_0x35e3c1[_0x98a504(0x1b0)]);return;}if(_0x4875d2===this[_0x98a504(0x374)]+'.'+SYSTEM_DP_MODE){_0x35e3c1[_0x98a504(0x1b0)]&&Object[_0x98a504(0x2c0)](SYSTEM_MODES)[_0x98a504(0x29b)](_0x35e3c1[_0x98a504(0x1b0)])&&(this[_0x98a504(0x23c)]=_0x35e3c1[_0x98a504(0x1b0)],_0x35e3c1[_0x98a504(0x1b0)]===SYSTEM_MODES[_0x98a504(0x1fc)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x35e3c1['ack'])this[_0x98a504(0x263)](_0x4875d2,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x35e3c1[_0x98a504(0x2b5)]){_0x4875d2[_0x98a504(0x29b)](_0x98a504(0x275))&&_0x35e3c1[_0x98a504(0x1b0)]&&(this[_0x98a504(0x263)](_0x4875d2,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x4875d2[_0x98a504(0x29b)](_0x98a504(0x359))&&_0x35e3c1[_0x98a504(0x1b0)]){this[_0x98a504(0x263)](_0x4875d2,{'val':![],'ack':!![]});if(this[_0x98a504(0x352)])createDailyDigest(this);}_0x4875d2[_0x98a504(0x29b)]('triggerBriefing')&&_0x35e3c1['val']&&(this['setState'](_0x4875d2,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x4875d2['includes'](_0x98a504(0x310))&&_0x35e3c1['val']&&(this[_0x98a504(0x263)](_0x4875d2,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x98a504(0x26d)][_0x98a504(0x2fd)]&&this['config'][_0x98a504(0x2fd)][_0x98a504(0x29b)](_0x4875d2)){await checkWifiPresence(this);return;}const _0x5df669=(this[_0x98a504(0x26d)][_0x98a504(0x2b0)]||[])['find'](_0xe70ec5=>_0xe70ec5['id']===_0x4875d2);if(_0x5df669)processSensorEvent(this,_0x4875d2,_0x35e3c1,_0x5df669);}async[a0_0x23bf25(0x37a)](_0x3b8f2b){const _0x25ce92=a0_0x23bf25;if(typeof _0x3b8f2b===_0x25ce92(0x1dd)&&_0x3b8f2b[_0x25ce92(0x27b)])try{if(_0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x224)){}else{if(_0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x28a)){}else{if(_0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x1c7)){if(!this['isProVersion'])return this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':![],'isPro':![]},_0x3b8f2b[_0x25ce92(0x2ab)]);let _0x5c0722={'status':_0x25ce92(0x261),'details':'','lastCheck':0x0};try{_0x5c0722['status']=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))['val'],_0x5c0722[_0x25ce92(0x279)]=(await this[_0x25ce92(0x1c6)](LTM_DP_DRIFT_DETAILS))[_0x25ce92(0x1b0)],_0x5c0722['lastCheck']=(await this[_0x25ce92(0x1c6)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x1604c9){}const _0x30a13a=this[_0x25ce92(0x1ce)]||[];this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x25ce92(0x1e6)],'driftAnalysis':_0x5c0722,'analysisHistory':_0x30a13a},_0x3b8f2b[_0x25ce92(0x2ab)]);}else{if(_0x3b8f2b['command']===_0x25ce92(0x305)){const _0x6487fc=this[_0x25ce92(0x1e6)][_0x25ce92(0x36b)],_0x4da051=new Date(),_0x24b743=new Date(_0x4da051['getFullYear'](),_0x4da051[_0x25ce92(0x20e)](),_0x4da051[_0x25ce92(0x1c3)]())[_0x25ce92(0x29d)](),_0x275d1c=this[_0x25ce92(0x200)]['filter'](_0x27fe8a=>new Date(_0x27fe8a[_0x25ce92(0x35f)])['getTime']()>_0x24b743)[_0x25ce92(0x36b)],_0x4e3a6e=new Array(0x18)[_0x25ce92(0x1e8)](0x0);this['rawEventLog'][_0x25ce92(0x344)](_0x5328cf=>{const _0x32d320=_0x25ce92,_0x3b66ee=new Date(_0x5328cf[_0x32d320(0x35f)]);if(_0x3b66ee[_0x32d320(0x29d)]()>_0x24b743)_0x4e3a6e[_0x3b66ee[_0x32d320(0x273)]()]++;});let _0x55dcd7={'status':_0x25ce92(0x261)};try{_0x55dcd7[_0x25ce92(0x2df)]=(await this[_0x25ce92(0x1c6)](LTM_DP_DRIFT_STATUS))[_0x25ce92(0x1b0)];}catch(_0x4a9b63){}let _0x59ae2a='';try{const _0xedd8da=await this[_0x25ce92(0x1c6)](_0x25ce92(0x383));_0x59ae2a=_0xedd8da?_0xedd8da[_0x25ce92(0x1b0)]:'';}catch(_0x52e93a){}let _0x3918bf=null;!this[_0x25ce92(0x32c)]&&(_0x3918bf=this[_0x25ce92(0x26d)][_0x25ce92(0x27c)]?_0x25ce92(0x2f3):_0x25ce92(0x223));let _0x3cf888={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x4ccfd7=await this[_0x25ce92(0x1c6)]('analysis.automation.patternDetected'),_0x33596a=await this[_0x25ce92(0x1c6)](_0x25ce92(0x31a)),_0x5570c0=await this['getStateAsync'](_0x25ce92(0x24d)),_0x39202a=await this[_0x25ce92(0x1c6)]('analysis.automation.targetValue'),_0x346945=await this[_0x25ce92(0x1c6)](_0x25ce92(0x1d2));_0x4ccfd7&&_0x4ccfd7[_0x25ce92(0x1b0)]&&(_0x3cf888['detected']=!![],_0x3cf888[_0x25ce92(0x35a)]=_0x33596a?_0x33596a[_0x25ce92(0x1b0)]:'',_0x3cf888[_0x25ce92(0x2c7)]=_0x5570c0?_0x5570c0[_0x25ce92(0x1b0)]:'',_0x3cf888['targetValue']=_0x39202a?_0x39202a[_0x25ce92(0x1b0)]:''),_0x3cf888['autoApply']=_0x346945?!!_0x346945[_0x25ce92(0x1b0)]:![];}catch(_0x2bff45){}this[_0x25ce92(0x1e7)](_0x3b8f2b['from'],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':!![],'eventHistory':this[_0x25ce92(0x379)][_0x25ce92(0x2fb)](0x0,0xf),'stats':{'digestCount':_0x6487fc,'eventCountToday':_0x275d1c,'hourlyActivity':_0x4e3a6e,'driftStatus':_0x55dcd7[_0x25ce92(0x2df)],'isPresent':this[_0x25ce92(0x1d9)],'presenceWho':_0x59ae2a,'minDays':this['config'][_0x25ce92(0x1f6)]||0x7,'stbDays':this[_0x25ce92(0x26d)][_0x25ce92(0x347)]||0xe,'ltbDays':this[_0x25ce92(0x26d)][_0x25ce92(0x2fc)]||0x3c,'systemError':_0x3918bf},'automation':_0x3cf888},_0x3b8f2b[_0x25ce92(0x2ab)]);}else{if(_0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x37d)){const _0x4c17ad=await this[_0x25ce92(0x327)]('enum.functions.*',_0x25ce92(0x26b)),_0x185d6b=[];if(_0x4c17ad)for(const _0x40a588 in _0x4c17ad){const _0x1ccf24=_0x4c17ad[_0x40a588],_0xbb2f08=(_0x1ccf24[_0x25ce92(0x2cc)]&&typeof _0x1ccf24[_0x25ce92(0x2cc)][_0x25ce92(0x1ed)]===_0x25ce92(0x1dd)?_0x1ccf24['common'][_0x25ce92(0x1ed)]['de']:_0x1ccf24['common'][_0x25ce92(0x1ed)])||_0x1ccf24[_0x25ce92(0x2cc)][_0x25ce92(0x1ed)];_0x185d6b[_0x25ce92(0x22b)]({'id':_0x40a588,'name':_0xbb2f08});}this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':!![],'enums':_0x185d6b},_0x3b8f2b[_0x25ce92(0x2ab)]);}else{if(_0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x2b8))try{const _0x4e78a7=await scanForDevices(this,_0x3b8f2b[_0x25ce92(0x27b)]||{});this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':!![],'devices':_0x4e78a7},_0x3b8f2b['callback']);}catch(_0x496932){this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b['command'],{'success':![],'error':_0x496932['message']},_0x3b8f2b[_0x25ce92(0x2ab)]);}else{if(_0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x343)){const _0x24284d=_0x3b8f2b[_0x25ce92(0x27b)][_0x25ce92(0x2e8)];if(!_0x24284d)return this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':![],'error':'No\x20instance'},_0x3b8f2b[_0x25ce92(0x2ab)]);const _0x15639f=await getCalendarNames(this,_0x24284d);this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':!![],'names':_0x15639f},_0x3b8f2b[_0x25ce92(0x2ab)]);}else{if(_0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x272)){const {targetId:_0x1f7bf7,targetValue:_0x344fce}=_0x3b8f2b[_0x25ce92(0x27b)];this[_0x25ce92(0x1c0)][_0x25ce92(0x1e2)](_0x25ce92(0x23f)+_0x1f7bf7+_0x25ce92(0x318)+_0x344fce),await this[_0x25ce92(0x362)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x25ce92(0x362)]('analysis.automation.description',{'val':_0x25ce92(0x2a1)+_0x1f7bf7,'ack':!![]}),await this[_0x25ce92(0x362)](_0x25ce92(0x24d),{'val':_0x1f7bf7,'ack':!![]}),await this['setStateAsync'](_0x25ce92(0x32a),{'val':_0x344fce,'ack':!![]}),this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':!![]},_0x3b8f2b[_0x25ce92(0x2ab)]);}else{if(_0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x28f)){const {historyId:_0x17ee87,rating:_0x5a000d,comment:_0x4bff28,alertReason:_0xc8649b}=_0x3b8f2b[_0x25ce92(0x27b)];_0x17ee87&&_0x5a000d?(await saveFeedback(this,{'timestamp':Date[_0x25ce92(0x37e)](),'historyId':_0x17ee87,'rating':_0x5a000d,'comment':_0x4bff28,'alertReason':_0xc8649b}),this['sendTo'](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b['command'],{'success':!![]},_0x3b8f2b[_0x25ce92(0x2ab)])):this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':![],'error':_0x25ce92(0x23d)},_0x3b8f2b[_0x25ce92(0x2ab)]);}else _0x3b8f2b[_0x25ce92(0x1a4)]===_0x25ce92(0x278)&&(this[_0x25ce92(0x1c0)]['info'](_0x25ce92(0x365)),await this['setStateAsync']('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x25ce92(0x362)](_0x25ce92(0x31a),{'val':'','ack':!![]}),this['sendTo'](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b[_0x25ce92(0x1a4)],{'success':!![]},_0x3b8f2b[_0x25ce92(0x2ab)]));}}}}}}}}}catch(_0x26fe79){this[_0x25ce92(0x1c0)][_0x25ce92(0x1da)](_0x25ce92(0x246)+_0x3b8f2b[_0x25ce92(0x1a4)]+':\x20'+_0x26fe79[_0x25ce92(0x27b)]);if(_0x3b8f2b[_0x25ce92(0x2ab)])this[_0x25ce92(0x1e7)](_0x3b8f2b[_0x25ce92(0x333)],_0x3b8f2b['command'],{'success':![],'error':_0x26fe79[_0x25ce92(0x27b)]},_0x3b8f2b[_0x25ce92(0x2ab)]);}}}if(require[a0_0x23bf25(0x1a3)]!==module)module['exports']=_0x29cfa3=>new CogniLiving(_0x29cfa3);else new CogniLiving();