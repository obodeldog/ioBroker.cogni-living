const a0_0x5289eb=a0_0x4aaa;(function(_0x1c413e,_0x3820aa){const _0x427317=a0_0x4aaa,_0x437192=_0x1c413e();while(!![]){try{const _0x19cb81=parseInt(_0x427317(0xf0))/0x1*(parseInt(_0x427317(0xcd))/0x2)+-parseInt(_0x427317(0x1df))/0x3+parseInt(_0x427317(0x1a7))/0x4+parseInt(_0x427317(0x107))/0x5+-parseInt(_0x427317(0xb1))/0x6*(-parseInt(_0x427317(0x12b))/0x7)+parseInt(_0x427317(0x15c))/0x8+-parseInt(_0x427317(0x8d))/0x9;if(_0x19cb81===_0x3820aa)break;else _0x437192['push'](_0x437192['shift']());}catch(_0x2b51bb){_0x437192['push'](_0x437192['shift']());}}}(a0_0x3223,0x22cd0));const a0_0x2618ed=(function(){let _0x4b8917=!![];return function(_0xd8eeae,_0x3f90f4){const _0x599206=_0x4b8917?function(){const _0x25c9cd=a0_0x4aaa;if(_0x3f90f4){const _0x43cb1d=_0x3f90f4[_0x25c9cd(0x1f2)](_0xd8eeae,arguments);return _0x3f90f4=null,_0x43cb1d;}}:function(){};return _0x4b8917=![],_0x599206;};}()),a0_0x429c9b=a0_0x2618ed(this,function(){const _0x5c791e=a0_0x4aaa;return a0_0x429c9b[_0x5c791e(0x1de)]()[_0x5c791e(0x1a2)](_0x5c791e(0x14f))[_0x5c791e(0x1de)]()[_0x5c791e(0x17a)](a0_0x429c9b)['search'](_0x5c791e(0x14f));});a0_0x429c9b();'use strict';const utils=require(a0_0x5289eb(0xc7)),{GoogleGenerativeAI}=require(a0_0x5289eb(0x129)),schedule=require(a0_0x5289eb(0x140)),{spawn,exec}=require(a0_0x5289eb(0x19d)),path=require('path'),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x5289eb(0x170),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE=a0_0x5289eb(0x1fb),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x5289eb(0x21a),LTM_DP_DAILY_DIGESTS=a0_0x5289eb(0x103),LTM_DP_STATUS=a0_0x5289eb(0x21e),LTM_DP_TRIGGER_DIGEST=a0_0x5289eb(0x128),LTM_DP_BASELINE_STATUS=a0_0x5289eb(0x135),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x5289eb(0xc2),LTM_DP_DRIFT_DETAILS=a0_0x5289eb(0x14c),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x5289eb(0x1e1),SYSTEM_MODES={'NORMAL':a0_0x5289eb(0x9a),'VACATION':'vacation','PARTY':a0_0x5289eb(0x154),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x5289eb(0x18f)]],PERSONA_MAPPING={'generic':a0_0x5289eb(0xd2),'senior_aal':'PRIORITÃ„T:\x20Gesundheit/AAL.','family':a0_0x5289eb(0x132),'single_comfort':a0_0x5289eb(0xf9),'security':'PRIORITÃ„T:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},HARD_IGNORE_TERMS=[a0_0x5289eb(0x111),a0_0x5289eb(0x1ca),'update',a0_0x5289eb(0x206),'lowbat','rssi','connection','maintenance',a0_0x5289eb(0x1ab),a0_0x5289eb(0x150),a0_0x5289eb(0x15b),a0_0x5289eb(0x122),a0_0x5289eb(0xe2),a0_0x5289eb(0x1db),a0_0x5289eb(0x1f6),a0_0x5289eb(0x11d),a0_0x5289eb(0x198),a0_0x5289eb(0x163)],BAD_NAMES=[a0_0x5289eb(0x197),a0_0x5289eb(0xa2),a0_0x5289eb(0x195),a0_0x5289eb(0x204),a0_0x5289eb(0x12d),'brightness','on',a0_0x5289eb(0x157),'switch',a0_0x5289eb(0x1c8),a0_0x5289eb(0x13b),a0_0x5289eb(0x15a),'cover',a0_0x5289eb(0x1f9),a0_0x5289eb(0x109),a0_0x5289eb(0x1be),a0_0x5289eb(0x1ba),a0_0x5289eb(0x104),a0_0x5289eb(0x1aa),a0_0x5289eb(0x99),a0_0x5289eb(0xe4),a0_0x5289eb(0x172),'valve','actual_temperature','set_temperature'],ADAPTER_BLACKLIST=[a0_0x5289eb(0xcf),a0_0x5289eb(0xee),a0_0x5289eb(0x9d),a0_0x5289eb(0xeb),a0_0x5289eb(0x110),'material.','icons-mfd.',a0_0x5289eb(0x152),'echarts.',a0_0x5289eb(0x13d),'simple-api.'],IS_WIN=process['platform']===a0_0x5289eb(0x1e6),VENV_PATH=path[a0_0x5289eb(0x19c)](__dirname,'.venv'),PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,'Scripts',a0_0x5289eb(0x203)):path[a0_0x5289eb(0x19c)](VENV_PATH,'bin',a0_0x5289eb(0x208)),PIP_EXE=IS_WIN?path[a0_0x5289eb(0x19c)](VENV_PATH,a0_0x5289eb(0x1ed),a0_0x5289eb(0x1ee)):path[a0_0x5289eb(0x19c)](VENV_PATH,a0_0x5289eb(0xbf),a0_0x5289eb(0x188));let activeSequence=[],sequenceTimer=null;async function initZombies(_0x2a18ee){const _0x480523=a0_0x5289eb;try{const _0x493019=[_0x480523(0x93),_0x480523(0xa3)];for(const _0x118458 of _0x493019){try{const _0x5d2d47=await _0x2a18ee[_0x480523(0x1ff)](_0x118458);if(_0x5d2d47)await _0x2a18ee['delObjectAsync'](_0x118458);}catch(_0x1880ce){}}}catch(_0x482fa7){}}async function initHistory(_0x16c13c){const _0x43f6e4=a0_0x5289eb;try{const _0x5a91db=await _0x16c13c[_0x43f6e4(0x1ae)](_0x43f6e4(0x112));_0x5a91db&&_0x5a91db[_0x43f6e4(0x1c7)]&&(_0x16c13c[_0x43f6e4(0x19f)]=JSON[_0x43f6e4(0x115)](_0x5a91db[_0x43f6e4(0x1c7)][_0x43f6e4(0x1de)]()));}catch(_0x471f3b){_0x16c13c[_0x43f6e4(0x19f)]=[];}try{const _0x10e035=await _0x16c13c['getStateAsync'](_0x43f6e4(0x202));if(_0x10e035&&_0x10e035[_0x43f6e4(0x1c7)])_0x16c13c[_0x43f6e4(0x174)]=JSON[_0x43f6e4(0x115)](_0x10e035[_0x43f6e4(0x1c7)]['toString']());}catch(_0x33c280){_0x16c13c['analysisHistory']=[];}if(_0x16c13c['eventHistory']&&_0x16c13c[_0x43f6e4(0x19f)]['length']>0x0){_0x16c13c[_0x43f6e4(0x192)][_0x43f6e4(0x180)]('Restoring\x20sensor\x20cache\x20from\x20history\x20('+_0x16c13c[_0x43f6e4(0x19f)][_0x43f6e4(0x1b8)]+_0x43f6e4(0xde));for(let _0x1ac417=_0x16c13c[_0x43f6e4(0x19f)][_0x43f6e4(0x1b8)]-0x1;_0x1ac417>=0x0;_0x1ac417--){const _0x25e073=_0x16c13c[_0x43f6e4(0x19f)][_0x1ac417];if(_0x25e073&&_0x25e073['id']!==undefined&&_0x25e073['value']!==undefined)_0x16c13c[_0x43f6e4(0x1a0)][_0x25e073['id']]=_0x25e073[_0x43f6e4(0x12d)];}}}async function initSystemConfig(_0x5e5e5c){const _0x47760e=a0_0x5289eb;try{const _0x29cd4d=await _0x5e5e5c[_0x47760e(0xbd)](_0x47760e(0x1c1));if(_0x29cd4d&&_0x29cd4d[_0x47760e(0x12f)])_0x5e5e5c[_0x47760e(0xf2)]={'latitude':_0x29cd4d['common']['latitude']||0x0,'longitude':_0x29cd4d[_0x47760e(0x12f)]['longitude']||0x0,'city':_0x29cd4d[_0x47760e(0x12f)][_0x47760e(0x1dd)]||''};}catch(_0x2ffab6){}}async function checkLicense(_0x163382,_0x3ae6fe){return!![];}async function getSystemUUID(_0x10d7b2){const _0x467e6b=a0_0x5289eb;return _0x467e6b(0xbc);}async function loadRawEventLog(_0x13f59c){const _0x188b4d=a0_0x5289eb;try{const _0x42a2ca=await _0x13f59c[_0x188b4d(0x1ae)](LTM_DP_RAW_LOG);if(_0x42a2ca&&_0x42a2ca[_0x188b4d(0x1c7)])_0x13f59c['rawEventLog']=JSON[_0x188b4d(0x115)](_0x42a2ca[_0x188b4d(0x1c7)]);}catch(_0x1e1875){_0x13f59c[_0x188b4d(0x1fe)]=[];}}async function saveRawEventLog(_0x3f962d){const _0x491052=a0_0x5289eb;if(_0x3f962d[_0x491052(0x1fe)]['length']>RAW_LOG_MAX_SIZE)_0x3f962d['rawEventLog'][_0x491052(0x165)](0x0,_0x3f962d[_0x491052(0x1fe)]['length']-RAW_LOG_MAX_SIZE);await _0x3f962d['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x491052(0x194)](_0x3f962d[_0x491052(0x1fe)]),'ack':!![]});}async function loadDailyDigests(_0x36f59e){const _0x57bfc4=a0_0x5289eb;try{const _0xe50da=await _0x36f59e[_0x57bfc4(0x1ae)](LTM_DP_DAILY_DIGESTS);if(_0xe50da&&_0xe50da[_0x57bfc4(0x1c7)])_0x36f59e[_0x57bfc4(0xe5)]=JSON[_0x57bfc4(0x115)](_0xe50da['val']);}catch(_0x215831){_0x36f59e[_0x57bfc4(0xe5)]=[];}await updateBaselineStatus(_0x36f59e);}async function saveDailyDigests(_0x4fb366,_0x599eb0=!![]){const _0x6fbb94=a0_0x5289eb,_0x14bb4b=_0x4fb366['config'][_0x6fbb94(0x136)]||0x3c;_0x4fb366[_0x6fbb94(0xe5)][_0x6fbb94(0x1b8)]>_0x14bb4b&&_0x4fb366[_0x6fbb94(0xe5)][_0x6fbb94(0x165)](0x0,_0x4fb366[_0x6fbb94(0xe5)][_0x6fbb94(0x1b8)]-_0x14bb4b);await _0x4fb366[_0x6fbb94(0x1d9)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x6fbb94(0x194)](_0x4fb366[_0x6fbb94(0xe5)]),'ack':!![]});if(_0x599eb0)await updateBaselineStatus(_0x4fb366);}async function updateAnalysisHistory(_0x2c021a,_0x5d34c3){const _0xe5f59=a0_0x5289eb;_0x2c021a[_0xe5f59(0x174)][_0xe5f59(0x216)](_0x5d34c3);if(_0x2c021a[_0xe5f59(0x174)][_0xe5f59(0x1b8)]>ANALYSIS_HISTORY_MAX_SIZE)_0x2c021a[_0xe5f59(0x174)][_0xe5f59(0x1b4)]();await _0x2c021a[_0xe5f59(0x1d9)](_0xe5f59(0x202),{'val':JSON[_0xe5f59(0x194)](_0x2c021a[_0xe5f59(0x174)]),'ack':!![]});}async function updateBaselineStatus(_0x10a079){const _0x30f8ef=a0_0x5289eb;if(!_0x10a079['isProVersion']){await _0x10a079[_0x30f8ef(0x1d9)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x48b49e=_0x10a079[_0x30f8ef(0xe5)][_0x30f8ef(0x1b8)]>=(_0x10a079[_0x30f8ef(0xa0)]['minDaysForBaseline']||0x7)?_0x30f8ef(0xd8)+_0x10a079[_0x30f8ef(0xe5)][_0x30f8ef(0x1b8)]+'\x20Tage)':_0x30f8ef(0x20d)+_0x10a079[_0x30f8ef(0xe5)][_0x30f8ef(0x1b8)]+'/'+(_0x10a079[_0x30f8ef(0xa0)][_0x30f8ef(0x124)]||0x7)+')';await _0x10a079[_0x30f8ef(0x1d9)](LTM_DP_BASELINE_STATUS,{'val':_0x48b49e,'ack':!![]});}async function loadSystemMode(_0x375ff5){const _0x352e7e=a0_0x5289eb;try{const _0x45b252=await _0x375ff5[_0x352e7e(0x1ae)](SYSTEM_DP_MODE);_0x45b252&&_0x45b252['val']&&Object[_0x352e7e(0x143)](SYSTEM_MODES)[_0x352e7e(0x1f7)](_0x45b252[_0x352e7e(0x1c7)])?_0x375ff5['currentSystemMode']=_0x45b252[_0x352e7e(0x1c7)]:(_0x375ff5[_0x352e7e(0x15e)]=SYSTEM_MODES[_0x352e7e(0x12e)],await _0x375ff5[_0x352e7e(0x1d9)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x352e7e(0x12e)],'ack':!![]}));}catch(_0x5cdd58){_0x375ff5[_0x352e7e(0x15e)]=SYSTEM_MODES[_0x352e7e(0x12e)];}}function a0_0x4aaa(_0x2d86fa,_0x2e9c93){const _0x4a2e44=a0_0x3223();return a0_0x4aaa=function(_0x429c9b,_0x2618ed){_0x429c9b=_0x429c9b-0x8c;let _0x32239c=_0x4a2e44[_0x429c9b];return _0x32239c;},a0_0x4aaa(_0x2d86fa,_0x2e9c93);}async function createAllObjects(_0x2269b7){const _0x521061=a0_0x5289eb;await _0x2269b7[_0x521061(0x191)](_0x521061(0x156),{'type':_0x521061(0xef),'common':{'name':_0x521061(0xb8)},'native':{}}),await _0x2269b7[_0x521061(0x191)](SYSTEM_DP_MODE,{'type':_0x521061(0x195),'common':{'name':_0x521061(0xfa),'type':_0x521061(0xad),'role':_0x521061(0x195),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x521061(0x12e)]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x213),{'type':_0x521061(0x195),'common':{'name':'Who\x20is\x20present?','type':_0x521061(0xad),'role':_0x521061(0xff),'read':!![],'write':![]},'native':{}}),await _0x2269b7['setObjectNotExistsAsync'](_0x521061(0x1e8),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x10b),'type':_0x521061(0xad),'role':_0x521061(0x14a),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x112),{'type':_0x521061(0x195),'common':{'name':'Event\x20History','type':_0x521061(0xad),'role':_0x521061(0x14a),'read':!![],'write':![]},'native':{}}),await _0x2269b7['extendObjectAsync'](_0x521061(0x105),{'type':_0x521061(0xef),'common':{'name':'AI\x20Training'},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x131),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x146),'type':'boolean','role':'button','read':!![],'write':!![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x1d4),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x1f3),'type':_0x521061(0xc9),'role':_0x521061(0x17d),'read':!![],'write':!![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)]('analysis.training.triggerEnergy',{'type':_0x521061(0x195),'common':{'name':_0x521061(0x113),'type':_0x521061(0xc9),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x2269b7['setObjectNotExistsAsync'](_0x521061(0x97),{'type':_0x521061(0x195),'common':{'name':_0x521061(0xa1),'type':_0x521061(0xad),'role':_0x521061(0xff),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x191)]('analysis.security',{'type':_0x521061(0xef),'common':{'name':_0x521061(0x1e2)},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0xb2),{'type':'state','common':{'name':'Anomaly\x20Score','type':_0x521061(0x1c9),'role':_0x521061(0x12d),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x16b),{'type':'state','common':{'name':_0x521061(0x1fc),'type':_0x521061(0xad),'role':_0x521061(0xf5),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x191)](_0x521061(0x1e5),{'type':_0x521061(0xef),'common':{'name':_0x521061(0xc1)},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x1dc),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x1fc),'type':_0x521061(0xad),'role':_0x521061(0xf5),'read':!![],'write':![]},'native':{}}),await _0x2269b7['setObjectNotExistsAsync']('analysis.health.isAnomaly',{'type':_0x521061(0x195),'common':{'name':'Anomaly\x20Detected','type':'boolean','role':_0x521061(0x1b2),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0xd6),{'type':'state','common':{'name':_0x521061(0x126),'type':_0x521061(0xad),'role':'text','read':!![],'write':![]},'native':{}}),await _0x2269b7['setObjectNotExistsAsync'](_0x521061(0x92),{'type':'state','common':{'name':_0x521061(0x189),'type':_0x521061(0x1c9),'role':_0x521061(0x12d),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x191)]('analysis.energy',{'type':_0x521061(0xef),'common':{'name':_0x521061(0x18d)},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x176),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x1b7),'type':_0x521061(0xad),'role':'text','read':!![],'write':![]},'native':{}}),await _0x2269b7['setObjectNotExistsAsync'](_0x521061(0x1d6),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x13f),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x191)](_0x521061(0x178),{'type':'channel','common':{'name':_0x521061(0x178)},'native':{}}),await _0x2269b7['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x521061(0x195),'common':{'name':_0x521061(0x220),'type':_0x521061(0xad),'role':_0x521061(0x14a),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x191)](LTM_DP_DAILY_DIGESTS,{'type':_0x521061(0x195),'common':{'name':_0x521061(0xaa),'type':_0x521061(0xad),'role':_0x521061(0x14a),'read':!![],'write':![]},'native':{}}),await _0x2269b7['setObjectNotExistsAsync'](_0x521061(0x148),{'type':'state','common':{'name':_0x521061(0x127),'type':_0x521061(0xad),'role':_0x521061(0x14a),'read':!![],'write':![]},'native':{}}),await _0x2269b7['setObjectNotExistsAsync']('LTM.trainingData.thermodynamics',{'type':_0x521061(0x195),'common':{'name':_0x521061(0xdb),'type':_0x521061(0xad),'role':_0x521061(0x14a),'read':!![],'write':![]},'native':{}}),await _0x2269b7['setObjectNotExistsAsync'](_0x521061(0x10c),{'type':_0x521061(0x195),'common':{'name':_0x521061(0xba),'type':_0x521061(0xc9),'role':_0x521061(0x17d),'read':!![],'write':!![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x1a4),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x1d0),'type':_0x521061(0xc9),'role':_0x521061(0x17d),'read':!![],'write':!![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0xca),{'type':_0x521061(0x195),'common':{'name':_0x521061(0xd3),'type':'boolean','role':_0x521061(0x169),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x183),{'type':_0x521061(0x195),'common':{'name':_0x521061(0xda),'type':_0x521061(0xad),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x211),{'type':_0x521061(0x195),'common':{'name':_0x521061(0xc6),'type':_0x521061(0xad),'role':_0x521061(0xff),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x1fa),{'type':_0x521061(0x195),'common':{'name':_0x521061(0xb7),'type':_0x521061(0xc9),'role':_0x521061(0x1b2),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x133),{'type':_0x521061(0x195),'common':{'name':'Description','type':_0x521061(0xad),'role':_0x521061(0xff),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x149),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x173),'type':'string','role':_0x521061(0xff),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x15f),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x193),'type':_0x521061(0xad),'role':_0x521061(0xff),'read':!![],'write':![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x1d3),{'type':_0x521061(0x195),'common':{'name':_0x521061(0x162),'type':_0x521061(0xc9),'role':_0x521061(0x1b5),'read':!![],'write':!![]},'native':{}}),await _0x2269b7[_0x521061(0x1a1)](_0x521061(0x1b6),{'type':_0x521061(0x195),'common':{'name':'Trigger\x20Action','type':_0x521061(0xc9),'role':_0x521061(0x17d),'read':!![],'write':!![]},'native':{}});}async function recordThermodynamics(_0x3ac088,_0x2c2685,_0x2bcea1,_0x18cf04){const _0xee443e=a0_0x5289eb,_0x40e9bc=await getOutsideTemperatureNumeric(_0x3ac088),_0x1ea91b=await _0x3ac088[_0xee443e(0x1ae)](_0xee443e(0x100));let _0x3cb09c=[];if(_0x1ea91b&&_0x1ea91b[_0xee443e(0x1c7)])try{_0x3cb09c=JSON[_0xee443e(0x115)](_0x1ea91b['val']);}catch(_0x29a73c){}_0x3cb09c[_0xee443e(0x1cf)]({'ts':Date['now'](),'room':_0x18cf04||_0xee443e(0x1ef),'t_in':_0x2bcea1,'t_out':_0x40e9bc});if(_0x3cb09c[_0xee443e(0x1b8)]>THERMO_LOG_SIZE)_0x3cb09c[_0xee443e(0x1ec)]();await _0x3ac088[_0xee443e(0x1d9)](_0xee443e(0x100),{'val':JSON[_0xee443e(0x194)](_0x3cb09c),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x493b1d){const _0x3ac028=a0_0x5289eb;if(_0x493b1d[_0x3ac028(0xa0)][_0x3ac028(0x1af)])try{const _0x251b65=await _0x493b1d[_0x3ac028(0xe6)](_0x493b1d[_0x3ac028(0xa0)][_0x3ac028(0x1af)]);if(_0x251b65&&_0x251b65['val']!==undefined&&_0x251b65[_0x3ac028(0x1c7)]!==null)return parseFloat(_0x251b65[_0x3ac028(0x1c7)]);}catch(_0x3f7ba9){}const _0x374113=_0x493b1d['config'][_0x3ac028(0x1e4)];if(!_0x493b1d[_0x3ac028(0xa0)]['useWeather']||!_0x374113)return null;try{let _0x2d30d1='';if(_0x374113[_0x3ac028(0x1f7)](_0x3ac028(0x116)))_0x2d30d1=_0x374113+_0x3ac028(0x10a);else{if(_0x374113[_0x3ac028(0x1f7)](_0x3ac028(0x121)))_0x2d30d1=_0x374113+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x374113[_0x3ac028(0x1f7)](_0x3ac028(0x171)))_0x2d30d1=_0x374113+'.forecast.current.temperature';else{if(_0x374113[_0x3ac028(0x1f7)](_0x3ac028(0xb6)))_0x2d30d1=_0x374113+_0x3ac028(0x1e0);}}}if(_0x2d30d1){const _0x340e88=await _0x493b1d[_0x3ac028(0xe6)](_0x2d30d1);if(_0x340e88&&_0x340e88[_0x3ac028(0x1c7)]!==undefined&&_0x340e88[_0x3ac028(0x1c7)]!==null)return parseFloat(_0x340e88['val']);}}catch(_0x3118df){}return null;}async function recordSequence(_0x50fd79,_0x1b9218){const _0x18093b=a0_0x5289eb,_0x3ed26f=(_0x1b9218[_0x18093b(0xa5)]||'')[_0x18093b(0x1bb)](),_0x4a318a=[_0x18093b(0x109),_0x18093b(0x20e),_0x18093b(0x21d),_0x18093b(0x1be),_0x18093b(0x1ba),'door',_0x18093b(0xe7),_0x18093b(0xf6),_0x18093b(0xfe),'contact','kontakt','light',_0x18093b(0x1c2),_0x18093b(0x1b5),_0x18093b(0x147),_0x18093b(0x1bd),_0x18093b(0xb5)];if(!_0x4a318a[_0x18093b(0xe8)](_0x3add5e=>_0x3ed26f[_0x18093b(0x1f7)](_0x3add5e)))return;if(!_0x1b9218['value'])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x1b9218[_0x18093b(0x1d1)]||_0x18093b(0x1ef),'id':_0x1b9218['id'],'ts':Date[_0x18093b(0x118)]()}),_0x50fd79[_0x18093b(0x192)][_0x18093b(0x190)](_0x18093b(0x108)+_0x1b9218[_0x18093b(0x1d1)]+_0x18093b(0x1ce)+activeSequence['length']+')'),sequenceTimer=setTimeout(async()=>{const _0x5e7c07=_0x18093b;if(activeSequence[_0x5e7c07(0x1b8)]>0x1)await saveCompletedSequence(_0x50fd79);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x353f22){const _0x3fed7c=a0_0x5289eb;try{const _0x4f222f=await _0x353f22[_0x3fed7c(0x1ae)](_0x3fed7c(0x148));let _0xdccf06=[];if(_0x4f222f&&_0x4f222f['val'])try{_0xdccf06=JSON[_0x3fed7c(0x115)](_0x4f222f[_0x3fed7c(0x1c7)]);}catch(_0x27fb59){}const _0x55f0cc=activeSequence[0x0]['ts'],_0x1f2d39=activeSequence[_0x3fed7c(0x11f)](_0x5f2abc=>({'loc':_0x5f2abc['loc'],'t_delta':Math[_0x3fed7c(0x1a5)]((_0x5f2abc['ts']-_0x55f0cc)/0x3e8)})),_0x45dc6c={'timestamp':new Date(_0x55f0cc)['toISOString'](),'steps':_0x1f2d39,'duration':Math[_0x3fed7c(0x1a5)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x55f0cc)/0x3e8),'daytime':new Date(_0x55f0cc)[_0x3fed7c(0x219)]()};_0xdccf06[_0x3fed7c(0x1cf)](_0x45dc6c);if(_0xdccf06[_0x3fed7c(0x1b8)]>MAX_TRAINING_SET_SIZE)_0xdccf06['shift']();await _0x353f22[_0x3fed7c(0x1d9)](_0x3fed7c(0x148),{'val':JSON[_0x3fed7c(0x194)](_0xdccf06),'ack':!![]}),runSecurityCheck(_0x353f22,_0x45dc6c);}catch(_0x4de864){_0x353f22[_0x3fed7c(0x192)]['error'](_0x3fed7c(0x175)+_0x4de864[_0x3fed7c(0x139)]);}}function runSecurityCheck(_0x3af334,_0x14148b){const _0x1a9ea5=a0_0x5289eb;if(!_0x3af334[_0x1a9ea5(0x10d)])return;_0x3af334[_0x1a9ea5(0x192)][_0x1a9ea5(0x190)](_0x1a9ea5(0x9c)),sendToPython(_0x3af334,_0x1a9ea5(0xcc),{'sequence':_0x14148b});}async function processSensorEvent(_0x288e04,_0x318e1a,_0x506e56,_0x3c8212){const _0x2d7440=a0_0x5289eb;if(!_0x3c8212)return;const _0xc898a9=_0x506e56['val'],_0x135495=Date[_0x2d7440(0x118)](),_0x27005d=_0x288e04['sensorLastValues'][_0x318e1a];_0x288e04[_0x2d7440(0x1a0)][_0x318e1a]=_0xc898a9;if(!_0x3c8212[_0x2d7440(0x138)]&&_0x27005d!=undefined&&_0x27005d==_0xc898a9)return;const _0x29d7bd=(_0x3c8212['type']||'')[_0x2d7440(0x1bb)](),_0x42bcff=_0x29d7bd[_0x2d7440(0x1f7)](_0x2d7440(0x104))||_0x29d7bd[_0x2d7440(0x1f7)](_0x2d7440(0x14e))||_0x29d7bd[_0x2d7440(0x1f7)](_0x2d7440(0x1cb))||_0x29d7bd[_0x2d7440(0x1f7)](_0x2d7440(0x120));_0x288e04[_0x2d7440(0x10d)]&&_0x42bcff&&recordThermodynamics(_0x288e04,_0x318e1a,_0xc898a9,_0x3c8212[_0x2d7440(0x1d1)]);const _0x532ec9={'timestamp':_0x135495,'id':_0x318e1a,'name':_0x3c8212['name'],'type':_0x3c8212['type'],'location':_0x3c8212['location'],'value':_0xc898a9};_0x288e04[_0x2d7440(0x19f)][_0x2d7440(0x216)](_0x532ec9);if(_0x288e04[_0x2d7440(0x19f)][_0x2d7440(0x1b8)]>HISTORY_MAX_SIZE)_0x288e04['eventHistory'][_0x2d7440(0x1b4)]();await _0x288e04['setStateAsync']('events.lastEvent',{'val':JSON['stringify'](_0x532ec9),'ack':!![]}),await _0x288e04['setStateAsync'](_0x2d7440(0x112),{'val':JSON[_0x2d7440(0x194)](_0x288e04[_0x2d7440(0x19f)]),'ack':!![]});_0x288e04[_0x2d7440(0x10d)]&&(_0x288e04[_0x2d7440(0x1fe)][_0x2d7440(0x1cf)](_0x532ec9),await saveRawEventLog(_0x288e04),recordSequence(_0x288e04,_0x532ec9));if(_0x3c8212['isExit']&&_0xc898a9===!![]){if(_0x288e04['isPresent']&&!_0x288e04['isGracePeriodActive'])startExitTimer(_0x288e04);else{if(!_0x288e04[_0x2d7440(0xa7)])setPresence(_0x288e04,!![]);}}else{if(_0x3c8212['type']===_0x2d7440(0x109)&&_0xc898a9===!![]){if(_0x288e04[_0x2d7440(0x217)])abortExitTimer(_0x288e04);if(!_0x288e04['isPresent']&&_0x288e04[_0x2d7440(0x15e)]===SYSTEM_MODES[_0x2d7440(0x12e)])setPresence(_0x288e04,!![]);}}}function installPythonDependencies(_0x1d6e32){const _0x24abeb=a0_0x5289eb;if(_0x1d6e32['dependencyInstallInProgress'])return;_0x1d6e32[_0x24abeb(0x1c6)]=!![];const _0xa627d0=path[_0x24abeb(0x19c)](__dirname,_0x24abeb(0xa4),_0x24abeb(0x1f0));_0x1d6e32[_0x24abeb(0x192)][_0x24abeb(0x180)](_0x24abeb(0x14d)),stopPythonService(_0x1d6e32),fs['existsSync'](VENV_PATH)?installRequirementsInVenv(_0x1d6e32,_0xa627d0):exec('python3\x20-m\x20venv\x20\x22'+VENV_PATH+'\x22',_0x13f4b9=>{const _0x15b795=_0x24abeb;if(_0x13f4b9){_0x1d6e32[_0x15b795(0x192)][_0x15b795(0x1ab)]('âŒ\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv'),_0x1d6e32[_0x15b795(0x1c6)]=![];return;}installRequirementsInVenv(_0x1d6e32,_0xa627d0);});}function installRequirementsInVenv(_0xe7a57c,_0x651dde){const _0x275f42=a0_0x5289eb,_0x2ba93a='\x22'+PIP_EXE+_0x275f42(0x17e),_0x3029f7='\x22'+PIP_EXE+_0x275f42(0xc5)+_0x651dde+'\x22';_0xe7a57c[_0x275f42(0x192)][_0x275f42(0x180)](_0x275f42(0x184)),exec(_0x2ba93a,{'timeout':0x493e0},_0x5b49c2=>{const _0x331190=_0x275f42;if(_0x5b49c2)_0xe7a57c[_0x331190(0x192)][_0x331190(0xdc)](_0x331190(0x12c)+_0x5b49c2[_0x331190(0x139)]);_0xe7a57c['log'][_0x331190(0x180)]('Step\x202:\x20Installing\x20requirements\x20(FORCE\x20REINSTALL)...'),exec(_0x3029f7,{'timeout':0x124f80,'maxBuffer':0x400*0x400*0x32},(_0x4a2540,_0x3b073d,_0x2144dd)=>{const _0x461dc8=_0x331190;_0xe7a57c[_0x461dc8(0x1c6)]=![],_0x4a2540?(_0xe7a57c['log'][_0x461dc8(0x1ab)](_0x461dc8(0x212)+(_0x2144dd||_0x4a2540['message'])),_0xe7a57c[_0x461dc8(0x192)][_0x461dc8(0x1ab)](_0x461dc8(0x9e)+_0x3b073d)):(_0xe7a57c[_0x461dc8(0x192)][_0x461dc8(0x180)]('âœ…\x20INFRASTRUCTURE\x20READY.\x20Starting\x20Service...'),startPythonService(_0xe7a57c));});});}function startPythonService(_0x57b92f){const _0xc11d1d=a0_0x5289eb;if(_0x57b92f[_0xc11d1d(0x1c6)])return;let _0x4d0826=_0xc11d1d(0x119);if(fs[_0xc11d1d(0x1eb)](PYTHON_EXE))_0x57b92f[_0xc11d1d(0x192)][_0xc11d1d(0x180)](_0xc11d1d(0x17f)+PYTHON_EXE),_0x4d0826=PYTHON_EXE;else{_0x57b92f[_0xc11d1d(0x192)]['warn'](_0xc11d1d(0x9b)),installPythonDependencies(_0x57b92f);return;}try{const _0x545dd3=path[_0xc11d1d(0x19c)](__dirname,_0xc11d1d(0xa4),_0xc11d1d(0xe9));_0x57b92f[_0xc11d1d(0x1ac)]=spawn(_0x4d0826,[_0x545dd3]),_0x57b92f[_0xc11d1d(0x1ac)][_0xc11d1d(0x141)]['on'](_0xc11d1d(0x20b),_0x2a0b41=>{const _0x9f0642=_0xc11d1d,_0x1ea01f=_0x2a0b41['toString']()[_0x9f0642(0x12a)]('\x0a');_0x1ea01f['forEach'](_0x52e5e3=>{const _0x22efa1=_0x9f0642,_0x20e9c1=_0x52e5e3[_0x22efa1(0x182)]();if(!_0x20e9c1)return;if(_0x20e9c1[_0x22efa1(0x1d8)](_0x22efa1(0xe3)))_0x57b92f[_0x22efa1(0x192)][_0x22efa1(0x190)](_0x22efa1(0x8c)+_0x20e9c1[_0x22efa1(0x181)](0x5)['trim']());else{if(_0x20e9c1['startsWith'](_0x22efa1(0x13c)))try{const _0x3d8da9=JSON[_0x22efa1(0x115)](_0x20e9c1[_0x22efa1(0x181)](0x8)[_0x22efa1(0x182)]());handlePythonResult(_0x57b92f,_0x3d8da9);}catch(_0x3a22b0){_0x57b92f[_0x22efa1(0x192)][_0x22efa1(0xdc)](_0x22efa1(0x14b)+_0x20e9c1);}}(_0x20e9c1['includes'](_0x22efa1(0x145))||_0x20e9c1[_0x22efa1(0x1f7)](_0x22efa1(0xa8)))&&(_0x57b92f[_0x22efa1(0x192)][_0x22efa1(0xdc)](_0x22efa1(0x1fd)),installPythonDependencies(_0x57b92f));});}),_0x57b92f[_0xc11d1d(0x1ac)][_0xc11d1d(0x130)]['on']('data',_0x1d6976=>{const _0x5b90b4=_0xc11d1d,_0x4d1510=_0x1d6976['toString']()[_0x5b90b4(0x182)]();if(!_0x4d1510[_0x5b90b4(0x1f7)](_0x5b90b4(0x101)))_0x57b92f[_0x5b90b4(0x192)][_0x5b90b4(0x1ab)](_0x5b90b4(0xdd)+_0x4d1510);}),_0x57b92f[_0xc11d1d(0x1ac)]['on'](_0xc11d1d(0x200),_0x1ea73e=>{const _0x583215=_0xc11d1d;_0x57b92f[_0x583215(0x192)][_0x583215(0x180)](_0x583215(0x18e)+_0x1ea73e),_0x57b92f['pythonProcess']=null;});}catch(_0x86960d){_0x57b92f[_0xc11d1d(0x192)][_0xc11d1d(0x1ab)]('Error\x20launching\x20Python:\x20'+_0x86960d[_0xc11d1d(0x139)]);}}function stopPythonService(_0xb63f69){const _0x5295b3=a0_0x5289eb;if(_0xb63f69['pythonProcess']){_0xb63f69[_0x5295b3(0x192)]['info'](_0x5295b3(0x196));try{_0xb63f69[_0x5295b3(0x1ac)][_0x5295b3(0x19b)]();}catch(_0x180d14){}_0xb63f69[_0x5295b3(0x1ac)]=null;}}function handlePythonResult(_0x21c377,_0x418d5d){const _0x4a76bc=a0_0x5289eb;if(_0x418d5d['type']==='PONG')_0x21c377[_0x4a76bc(0x192)][_0x4a76bc(0x190)](_0x4a76bc(0xc4));else{if(_0x418d5d[_0x4a76bc(0xa5)]===_0x4a76bc(0x1b0)){const {anomaly_score:_0x2467fe,is_anomaly:_0x1c1f9c,threshold:_0x288f8e}=_0x418d5d[_0x4a76bc(0xd5)];_0x21c377[_0x4a76bc(0x192)][_0x4a76bc(0x180)]('ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20'+_0x2467fe['toFixed'](0x5)+_0x4a76bc(0x94)+(_0x1c1f9c?_0x4a76bc(0x186):'OK')),_0x21c377[_0x4a76bc(0x1d9)](_0x4a76bc(0xb2),{'val':_0x2467fe,'ack':!![]}),_0x21c377[_0x4a76bc(0x1d9)]('analysis.security.lastCheck',{'val':new Date()[_0x4a76bc(0xed)](),'ack':!![]});if(_0x1c1f9c){const _0x36cec2='UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20'+_0x2467fe['toFixed'](0x4)+')';_0x21c377[_0x4a76bc(0x1d9)](_0x4a76bc(0xca),{'val':!![],'ack':!![]}),_0x21c377['setStateAsync'](_0x4a76bc(0x183),{'val':_0x36cec2,'ack':!![]}),sendNotification(_0x21c377,_0x4a76bc(0x137)+_0x36cec2,![],!![]);}}else{if(_0x418d5d['type']==='TRAINING_COMPLETE'){const {success:_0x230105,details:_0x478f6c}=_0x418d5d['payload'];_0x21c377['setStateAsync'](_0x4a76bc(0x97),{'val':_0x230105?_0x4a76bc(0x21c)+new Date()[_0x4a76bc(0x123)]()+'\x20('+_0x478f6c+')':_0x4a76bc(0xe1)+_0x478f6c,'ack':!![]});}else{if(_0x418d5d[_0x4a76bc(0xa5)]===_0x4a76bc(0x144)){const {success:_0x28bd2f,details:_0x323967}=_0x418d5d[_0x4a76bc(0xd5)];if(_0x28bd2f)try{const _0x46e584=JSON[_0x4a76bc(0x115)](_0x323967);if(_0x46e584['insulation'])_0x21c377[_0x4a76bc(0x1d9)](_0x4a76bc(0x176),{'val':JSON[_0x4a76bc(0x194)](_0x46e584[_0x4a76bc(0xbb)]),'ack':!![]});if(_0x46e584['heating'])_0x21c377['setStateAsync']('analysis.energy.heatingScore',{'val':JSON[_0x4a76bc(0x194)](_0x46e584['heating']),'ack':!![]});}catch(_0x37e808){}}else{if(_0x418d5d[_0x4a76bc(0xa5)]==='HEALTH_TRAIN_RESULT'){const {success:_0x3d46d5,details:_0x26fba9}=_0x418d5d[_0x4a76bc(0xd5)];if(_0x3d46d5)_0x21c377[_0x4a76bc(0x192)][_0x4a76bc(0x180)](_0x4a76bc(0x214)+_0x26fba9);}else{if(_0x418d5d[_0x4a76bc(0xa5)]===_0x4a76bc(0x1e7)){const {is_anomaly:_0x2e8c97,details:_0x385e3b}=_0x418d5d[_0x4a76bc(0xd5)];_0x21c377['setStateAsync'](_0x4a76bc(0x1dc),{'val':new Date()['toISOString'](),'ack':!![]}),_0x21c377['setStateAsync'](_0x4a76bc(0x1e9),{'val':_0x2e8c97,'ack':!![]});}}}}}}}function sendToPython(_0x119a5c,_0x42a937,_0x3311d4={}){const _0x33f90c=a0_0x5289eb;if(!_0x119a5c['pythonProcess']||!_0x119a5c[_0x33f90c(0x1ac)][_0x33f90c(0x16a)][_0x33f90c(0x153)])return;const _0x2c474f=JSON[_0x33f90c(0x194)]({'command':_0x42a937,..._0x3311d4});try{_0x119a5c['pythonProcess']['stdin'][_0x33f90c(0x1d7)](_0x2c474f+'\x0a');}catch(_0x1db23c){}}async function initSensorSubscriptions(_0x32d170){const _0x10257f=a0_0x5289eb,_0x2f26f0=_0x32d170[_0x10257f(0xa0)]['devices'];if(_0x2f26f0)for(const _0x3da063 of _0x2f26f0){await _0x32d170[_0x10257f(0xb9)](_0x3da063['id']);}}async function initPresenceSubscriptions(_0x12322e){const _0x5ca168=a0_0x5289eb,_0x41dbe2=_0x12322e[_0x5ca168(0xa0)][_0x5ca168(0x10f)];if(_0x41dbe2)for(const _0x158428 of _0x41dbe2){await _0x12322e['subscribeForeignStatesAsync'](_0x158428);}}async function setupTelegramListener(_0x62f38f){const _0x305d9f=a0_0x5289eb,_0x23b4fb=_0x62f38f[_0x305d9f(0xa0)][_0x305d9f(0x1f5)];if(_0x62f38f[_0x305d9f(0xa0)][_0x305d9f(0x1d2)]&&_0x23b4fb)await _0x62f38f[_0x305d9f(0xb9)](_0x23b4fb+_0x305d9f(0x1cc));}async function checkWifiPresence(_0x3ade99){const _0x4bc929=a0_0x5289eb;try{const _0x195fce=_0x3ade99[_0x4bc929(0xa0)]['presenceDevices']||[];let _0x390f47=![];const _0x7a192f=[];for(const _0x3ee98a of _0x195fce){try{const _0x9bb850=await _0x3ade99[_0x4bc929(0xe6)](_0x3ee98a);_0x9bb850&&(_0x9bb850['val']===!![]||_0x9bb850[_0x4bc929(0x1c7)]===_0x4bc929(0x17c)||_0x9bb850['val']===0x1)&&(_0x390f47=!![],_0x7a192f[_0x4bc929(0x1cf)](_0x3ee98a));}catch(_0xa28f9e){}}return await _0x3ade99[_0x4bc929(0x1d9)](_0x4bc929(0x213),{'val':_0x7a192f[_0x4bc929(0x19c)](',\x20'),'ack':!![]}),_0x390f47&&(_0x3ade99[_0x4bc929(0x217)]&&(_0x3ade99[_0x4bc929(0x192)]['info'](_0x4bc929(0xdf)),abortExitTimer(_0x3ade99)),!_0x3ade99[_0x4bc929(0xa7)]&&_0x3ade99['currentSystemMode']===SYSTEM_MODES[_0x4bc929(0x12e)]&&await setPresence(_0x3ade99,!![])),_0x390f47;}catch(_0x31ff54){return![];}}function startExitTimer(_0x36142d){const _0x4b922d=a0_0x5289eb;abortExitTimer(_0x36142d),_0x36142d['isGracePeriodActive']=!![],_0x36142d[_0x4b922d(0xae)]=setTimeout(()=>{_0x36142d['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x36142d[_0x4b922d(0x217)]=setTimeout(()=>{setPresence(_0x36142d,![]),_0x36142d['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x46bc40){const _0x80e27a=a0_0x5289eb;if(_0x46bc40[_0x80e27a(0x217)])clearTimeout(_0x46bc40[_0x80e27a(0x217)]);if(_0x46bc40[_0x80e27a(0xae)])clearTimeout(_0x46bc40[_0x80e27a(0xae)]);_0x46bc40[_0x80e27a(0x217)]=null,_0x46bc40[_0x80e27a(0xae)]=null,_0x46bc40['isGracePeriodActive']=![];}async function setPresence(_0x351dd3,_0x1253ae){const _0x1db819=a0_0x5289eb;if(_0x351dd3[_0x1db819(0xa7)]===_0x1253ae)return;_0x351dd3[_0x1db819(0xa7)]=_0x1253ae,await _0x351dd3[_0x1db819(0x1d9)](_0x1db819(0x18b),{'val':_0x1253ae,'ack':!![]});}async function executeAutomationAction(_0xeaa151){const _0x2308ab=a0_0x5289eb;try{const _0x34975d=await _0xeaa151['getStateAsync'](_0x2308ab(0x149)),_0xaf4cdf=await _0xeaa151[_0x2308ab(0x1ae)]('analysis.automation.targetValue');if(_0x34975d&&_0x34975d[_0x2308ab(0x1c7)]&&_0xaf4cdf){const _0x3d7368=_0x34975d['val'];let _0x2f028f=_0xaf4cdf[_0x2308ab(0x1c7)];try{_0x2f028f=JSON[_0x2308ab(0x115)](_0x2f028f);}catch(_0x38c60f){}_0xeaa151[_0x2308ab(0x192)][_0x2308ab(0x180)]('ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x3d7368+_0x2308ab(0x1c3)+_0x2f028f),await _0xeaa151['setForeignStateAsync'](_0x3d7368,_0x2f028f);}else _0xeaa151[_0x2308ab(0x192)][_0x2308ab(0xdc)]('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x397fa6){_0xeaa151[_0x2308ab(0x192)][_0x2308ab(0x1ab)]('BUTLER\x20Execution\x20Error:\x20'+_0x397fa6[_0x2308ab(0x139)]);}}async function handleTelegramResponse(_0x2d1647,_0x54cfdf){const _0x5a7d27=a0_0x5289eb;let _0x4e59e5=_0x54cfdf;_0x54cfdf[_0x5a7d27(0x1d8)]('[')&&(_0x4e59e5=_0x54cfdf['substring'](_0x54cfdf[_0x5a7d27(0x18a)](']')+0x1));if(_0x4e59e5==='COGNI_CONFIRM_OK')await _0x2d1647[_0x5a7d27(0x1d9)](_0x5a7d27(0xca),{'val':![],'ack':!![]}),await _0x2d1647['setStateAsync'](_0x5a7d27(0x183),{'val':_0x5a7d27(0x159),'ack':!![]}),_0x2d1647[_0x5a7d27(0x1bf)]=![],sendNotification(_0x2d1647,_0x5a7d27(0x10e),![]);else _0x4e59e5===_0x5a7d27(0xb3)&&sendNotification(_0x2d1647,_0x5a7d27(0xd7),![],!![]);}async function sendNotification(_0x2e9dea,_0x57eb83,_0x54ba4f=![],_0x47ee72=![]){const _0x1bda91=a0_0x5289eb,_0x23ba12=_0x2e9dea['config'];if(_0x23ba12[_0x1bda91(0x1d2)]){let _0x5a6c7c={};(_0x57eb83[_0x1bda91(0x1f7)](_0x1bda91(0x166))||_0x47ee72)&&(_0x5a6c7c={'reply_markup':{'inline_keyboard':[[{'text':_0x1bda91(0x1a6),'callback_data':_0x1bda91(0x168)}],[{'text':'ðŸ“ž\x20RÃ¼ckruf\x20anfordern','callback_data':_0x1bda91(0xb3)}]]}}),await _0x2e9dea[_0x1bda91(0x1cd)](_0x23ba12[_0x1bda91(0x1f5)],_0x1bda91(0x20f),{'text':_0x57eb83,'user':_0x23ba12[_0x1bda91(0xd1)],..._0x5a6c7c});}if(_0x23ba12[_0x1bda91(0x95)]){let _0x5b0c15={'message':_0x57eb83,'title':_0x47ee72?_0x1bda91(0x125):_0x1bda91(0xb0),'priority':_0x47ee72?0x2:0x1,'device':_0x23ba12[_0x1bda91(0xaf)]};_0x47ee72&&(_0x5b0c15[_0x1bda91(0xf3)]=0x1e,_0x5b0c15[_0x1bda91(0x18c)]=0xe10,_0x5b0c15['sound']='siren'),await _0x2e9dea['sendToAsync'](_0x23ba12[_0x1bda91(0xd9)],_0x1bda91(0x20f),_0x5b0c15);}_0x23ba12['notifyEmailEnabled']&&await _0x2e9dea[_0x1bda91(0x1cd)](_0x23ba12[_0x1bda91(0x215)],_0x1bda91(0x20f),{'text':_0x57eb83,'to':_0x23ba12['notifyEmailRecipient']});}async function runAutopilot(_0x22543d){const _0x1c0a1b=a0_0x5289eb,_0x10a389=_0x22543d['config']['inactivityThresholdHours'],_0x3a32da=_0x22543d[_0x1c0a1b(0x19f)]['length']>0x0?_0x22543d[_0x1c0a1b(0x19f)][0x0][_0x1c0a1b(0x91)]:Date[_0x1c0a1b(0x118)](),_0x32576c=(Date[_0x1c0a1b(0x118)]()-_0x3a32da)/(0x3e8*0x3c*0x3c);let _0x135bfc='';_0x22543d[_0x1c0a1b(0xa0)][_0x1c0a1b(0xbe)]&&_0x22543d[_0x1c0a1b(0x15e)]===SYSTEM_MODES[_0x1c0a1b(0x12e)]&&_0x22543d[_0x1c0a1b(0xa7)]&&(_0x32576c>_0x10a389&&(_0x135bfc='HARD\x20WATCHDOG:\x20No\x20activity\x20for\x20'+_0x32576c[_0x1c0a1b(0xf1)](0x1)+'h.')),runGeminiAnalysis(_0x22543d,_0x135bfc);}async function runPythonHealthCheck(_0x36bbdf){const _0x1fc8ed=a0_0x5289eb;if(!_0x36bbdf[_0x1fc8ed(0xe5)]||_0x36bbdf[_0x1fc8ed(0xe5)][_0x1fc8ed(0x1b8)]<0x2)return;const _0x523769=_0x36bbdf[_0x1fc8ed(0xe5)][_0x1fc8ed(0x11f)](_0x3871a1=>{const _0x2b9803=_0x1fc8ed,_0x37dd35=(_0x3871a1[_0x2b9803(0x102)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x37dd35]||0x32;});sendToPython(_0x36bbdf,_0x1fc8ed(0x1a3),{'values':_0x523769,'tag':_0x1fc8ed(0x161)});}class CogniLiving extends utils[a0_0x5289eb(0x205)]{constructor(_0x1ef748){const _0xd0066b=a0_0x5289eb;super({..._0x1ef748,'name':_0xd0066b(0x106)}),this[_0xd0066b(0x19f)]=[],this[_0xd0066b(0x174)]=[],this[_0xd0066b(0x1fe)]=[],this[_0xd0066b(0xe5)]=[],this[_0xd0066b(0x1a0)]={},this[_0xd0066b(0xf2)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0xd0066b(0xa7)]=!![],this['exitTimer']=null,this[_0xd0066b(0xae)]=null,this[_0xd0066b(0xa9)]=![],this[_0xd0066b(0x151)]=null,this[_0xd0066b(0x1a9)]=null,this['currentSystemMode']=SYSTEM_MODES[_0xd0066b(0x12e)],this['isProVersion']=![],this[_0xd0066b(0x1bf)]=![],this[_0xd0066b(0x20c)]=_0xd0066b(0x114),this[_0xd0066b(0x1ea)]=null,this[_0xd0066b(0x1b1)]=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this[_0xd0066b(0xd0)]=null,this[_0xd0066b(0x1ac)]=null,this[_0xd0066b(0x1c6)]=![],this['on'](_0xd0066b(0x1c5),this['onReady'][_0xd0066b(0x1e3)](this)),this['on'](_0xd0066b(0x209),this[_0xd0066b(0x17b)][_0xd0066b(0x1e3)](this)),this['on'](_0xd0066b(0xc3),this[_0xd0066b(0x11a)]['bind'](this)),this['on'](_0xd0066b(0x139),this['onMessage'][_0xd0066b(0x1e3)](this));}async[a0_0x5289eb(0x16d)](){const _0xf37729=a0_0x5289eb;this[_0xf37729(0x192)]['info']('cogni-living\x20adapter\x20starting\x20(v'+this[_0xf37729(0x1bc)]+_0xf37729(0x1d5)),await initZombies(this);try{this[_0xf37729(0x10d)]=await checkLicense(this,this[_0xf37729(0xa0)]['licenseKey']);}catch(_0x465a4b){}if(!this[_0xf37729(0xa0)][_0xf37729(0xac)]||this[_0xf37729(0xa0)][_0xf37729(0xac)]<0.1)this[_0xf37729(0xa0)][_0xf37729(0xac)]=0xc;await initHistory(this),await initSystemConfig(this);if(this['config'][_0xf37729(0x16e)])try{this[_0xf37729(0x151)]=new GoogleGenerativeAI(this[_0xf37729(0xa0)][_0xf37729(0x16e)]),this[_0xf37729(0x1a9)]=this[_0xf37729(0x151)][_0xf37729(0x117)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xf37729(0x155)}}),this[_0xf37729(0x192)][_0xf37729(0x180)](_0xf37729(0x16f));}catch(_0x5695f0){this[_0xf37729(0x192)]['error'](_0xf37729(0xea)+_0x5695f0[_0xf37729(0x139)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates'](_0xf37729(0x10c)),this[_0xf37729(0xfc)](LTM_DP_TRIGGER_DIGEST),this[_0xf37729(0xfc)](_0xf37729(0x1e1)),this['subscribeStates']('analysis.triggerBriefing'),this[_0xf37729(0xfc)](_0xf37729(0x1b6)),this[_0xf37729(0xfc)]('analysis.automation.autoApply'),this[_0xf37729(0xfc)](_0xf37729(0x131)),this[_0xf37729(0xfc)](_0xf37729(0x1d4)),this['subscribeStates']('analysis.training.triggerEnergy'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0xf37729(0x1ea)]);const _0x26d1f9=this['config'][_0xf37729(0x210)]||0xf;_0x26d1f9>0x0&&(this[_0xf37729(0x1ea)]=setInterval(()=>{runAutopilot(this);},_0x26d1f9*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{if(this['pythonProcess'])runPythonHealthCheck(this);},0x1388);}['onUnload'](_0x1a8cd9){const _0x1afa7b=a0_0x5289eb;if(this[_0x1afa7b(0x1ea)])clearInterval(this[_0x1afa7b(0x1ea)]);if(this[_0x1afa7b(0x164)])clearInterval(this[_0x1afa7b(0x164)]);if(this[_0x1afa7b(0x1b1)])this[_0x1afa7b(0x1b1)]['cancel']();if(this[_0x1afa7b(0x20a)])this[_0x1afa7b(0x20a)][_0x1afa7b(0x1c0)]();if(this['briefingJob'])this[_0x1afa7b(0xd0)][_0x1afa7b(0x1c0)]();if(this['exitTimer'])clearTimeout(this[_0x1afa7b(0x217)]);if(this['exitGraceTimer'])clearTimeout(this[_0x1afa7b(0xae)]);stopPythonService(this),_0x1a8cd9();}async[a0_0x5289eb(0x17b)](_0x54a927,_0x5f1e68){const _0x63b7fe=a0_0x5289eb;if(!_0x5f1e68||this[_0x63b7fe(0x1c6)])return;if(_0x54a927[_0x63b7fe(0x1f7)](_0x63b7fe(0x1ad))&&_0x54a927[_0x63b7fe(0x187)](_0x63b7fe(0x1a8))&&_0x5f1e68[_0x63b7fe(0x1c7)]){await handleTelegramResponse(this,_0x5f1e68[_0x63b7fe(0x1c7)]);return;}if(_0x54a927===this[_0x63b7fe(0x160)]+'.'+SYSTEM_DP_MODE){if(_0x5f1e68['val']&&Object[_0x63b7fe(0x143)](SYSTEM_MODES)[_0x63b7fe(0x1f7)](_0x5f1e68['val'])){this[_0x63b7fe(0x15e)]=_0x5f1e68[_0x63b7fe(0x1c7)];if(_0x5f1e68[_0x63b7fe(0x1c7)]===SYSTEM_MODES[_0x63b7fe(0xab)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x5f1e68[_0x63b7fe(0xc0)])this[_0x63b7fe(0xa6)](_0x54a927,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x5f1e68[_0x63b7fe(0xc0)]){_0x54a927[_0x63b7fe(0x1f7)](_0x63b7fe(0x10c))&&_0x5f1e68[_0x63b7fe(0x1c7)]&&(this[_0x63b7fe(0xa6)](_0x54a927,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x54a927[_0x63b7fe(0x1f7)](_0x63b7fe(0x96))&&_0x5f1e68[_0x63b7fe(0x1c7)]){this['setState'](_0x54a927,{'val':![],'ack':!![]});if(this[_0x63b7fe(0x10d)])createDailyDigest(this);}_0x54a927[_0x63b7fe(0x1f7)](_0x63b7fe(0x21b))&&_0x5f1e68[_0x63b7fe(0x1c7)]&&(this[_0x63b7fe(0xa6)](_0x54a927,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x54a927[_0x63b7fe(0x1f7)](_0x63b7fe(0x1f1))&&_0x5f1e68[_0x63b7fe(0x1c7)]&&(this[_0x63b7fe(0xa6)](_0x54a927,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x54a927['includes']('analysis.training.triggerSecurity')&&_0x5f1e68[_0x63b7fe(0x1c7)]){this['setState'](_0x54a927,{'val':![],'ack':!![]});if(this[_0x63b7fe(0x10d)])try{const _0x28a797=await this[_0x63b7fe(0x1ae)](_0x63b7fe(0x148));if(_0x28a797&&_0x28a797[_0x63b7fe(0x1c7)]){const _0x16dc68=JSON[_0x63b7fe(0x115)](_0x28a797['val']);this[_0x63b7fe(0x192)][_0x63b7fe(0x180)](_0x63b7fe(0x1f4)),this[_0x63b7fe(0x1d9)](_0x63b7fe(0x97),{'val':'Sec-Training\x20started...','ack':!![]}),sendToPython(this,_0x63b7fe(0x19e),{'sequences':_0x16dc68});}}catch(_0x564847){this['log'][_0x63b7fe(0x1ab)](_0x63b7fe(0x8f)+_0x564847[_0x63b7fe(0x139)]);}}if(_0x54a927[_0x63b7fe(0x1f7)]('analysis.training.triggerHealth')&&_0x5f1e68[_0x63b7fe(0x1c7)]){this['setState'](_0x54a927,{'val':![],'ack':!![]});if(this[_0x63b7fe(0x10d)])try{const _0x2c6dd6=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x2c6dd6&&_0x2c6dd6[_0x63b7fe(0x1c7)])sendToPython(this,_0x63b7fe(0xcb),{'digests':JSON[_0x63b7fe(0x115)](_0x2c6dd6[_0x63b7fe(0x1c7)])});}catch(_0x4cd770){}}if(_0x54a927[_0x63b7fe(0x1f7)](_0x63b7fe(0x1f8))&&_0x5f1e68[_0x63b7fe(0x1c7)]){this[_0x63b7fe(0xa6)](_0x54a927,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x5ce309=await this[_0x63b7fe(0x1ae)](_0x63b7fe(0x100));if(_0x5ce309&&_0x5ce309[_0x63b7fe(0x1c7)])sendToPython(this,_0x63b7fe(0x8e),{'points':JSON[_0x63b7fe(0x115)](_0x5ce309[_0x63b7fe(0x1c7)])});}catch(_0xca9ea5){}}return;}if(this[_0x63b7fe(0xa0)][_0x63b7fe(0x10f)]&&this[_0x63b7fe(0xa0)][_0x63b7fe(0x10f)][_0x63b7fe(0x1f7)](_0x54a927)){await checkWifiPresence(this);return;}const _0x5e9df0=(this[_0x63b7fe(0xa0)][_0x63b7fe(0xf4)]||[])['find'](_0x461d1d=>_0x461d1d['id']===_0x54a927);if(_0x5e9df0)processSensorEvent(this,_0x54a927,_0x5f1e68,_0x5e9df0);}async[a0_0x5289eb(0xd4)](_0x3bccdf){const _0x2cb494=a0_0x5289eb;if(typeof _0x3bccdf===_0x2cb494(0x1da)&&_0x3bccdf[_0x2cb494(0x139)]){if(_0x3bccdf[_0x2cb494(0xf8)]===_0x2cb494(0x177)){const _0x51681c=_0x3bccdf['message']['apiKey']||this[_0x2cb494(0xa0)][_0x2cb494(0x16e)];if(!_0x51681c)return this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':![],'message':_0x2cb494(0xfd)},_0x3bccdf[_0x2cb494(0x179)]);try{const _0x2ec672=new GoogleGenerativeAI(_0x51681c),_0x4cadfa=_0x2ec672['getGenerativeModel']({'model':GEMINI_MODEL}),_0x1ba5e7=await _0x4cadfa[_0x2cb494(0x142)]('Hi');this['sendTo'](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':!![],'message':'OK:\x20'+_0x1ba5e7['response'][_0x2cb494(0xff)]()},_0x3bccdf[_0x2cb494(0x179)]);}catch(_0x455c25){this['sendTo'](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':![],'message':'Err:\x20'+_0x455c25[_0x2cb494(0x139)]},_0x3bccdf[_0x2cb494(0x179)]);}}else{if(_0x3bccdf['command']===_0x2cb494(0x16c)){const _0x2489c3=await getWeatherContext(this),_0x40d494=await getCalendarContext(this);this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf['command'],{'success':!![],'weather':_0x2489c3,'calendar':_0x40d494},_0x3bccdf[_0x2cb494(0x179)]);}else{if(_0x3bccdf[_0x2cb494(0xf8)]===_0x2cb494(0x21f)){if(!this[_0x2cb494(0x10d)])return this[_0x2cb494(0x207)](_0x3bccdf['from'],_0x3bccdf[_0x2cb494(0xf8)],{'success':![],'isPro':![]},_0x3bccdf['callback']);let _0x133183={'status':'N/A'};try{const _0x1193c1=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x133183[_0x2cb494(0x1f9)]=_0x1193c1?_0x1193c1['val']:_0x2cb494(0xfb);}catch(_0x2d767b){}this[_0x2cb494(0x207)](_0x3bccdf['from'],_0x3bccdf[_0x2cb494(0xf8)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x2cb494(0xe5)],'driftAnalysis':_0x133183,'analysisHistory':this[_0x2cb494(0x174)]},_0x3bccdf['callback']);}else{if(_0x3bccdf[_0x2cb494(0xf8)]===_0x2cb494(0x13a)){const _0x3ea629=this[_0x2cb494(0xe5)]['length'],_0x8a0b6a=new Date(),_0x19b4e0=new Date(_0x8a0b6a[_0x2cb494(0xf7)](),_0x8a0b6a[_0x2cb494(0x98)](),_0x8a0b6a[_0x2cb494(0x15d)]())['getTime'](),_0x2caaa9=this[_0x2cb494(0x1fe)]['filter'](_0x425365=>new Date(_0x425365['timestamp'])[_0x2cb494(0x218)]()>_0x19b4e0)[_0x2cb494(0x1b8)],_0x57430f=new Array(0x18)['fill'](0x0);this[_0x2cb494(0x1fe)]['forEach'](_0x5996fa=>{const _0x4ec1d5=_0x2cb494,_0x6fc045=new Date(_0x5996fa[_0x4ec1d5(0x91)]);if(_0x6fc045[_0x4ec1d5(0x218)]()>_0x19b4e0)_0x57430f[_0x6fc045[_0x4ec1d5(0x219)]()]++;});let _0x14d2b8={'status':_0x2cb494(0xfb)};try{const _0x286f1d=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x14d2b8[_0x2cb494(0x1f9)]=_0x286f1d?_0x286f1d[_0x2cb494(0x1c7)]:_0x2cb494(0xfb);}catch(_0x4d2a05){}let _0x4df2c0='';try{const _0x1b7eda=await this[_0x2cb494(0x1ae)](_0x2cb494(0x213));_0x4df2c0=_0x1b7eda?_0x1b7eda[_0x2cb494(0x1c7)]:'';}catch(_0x483ad9){}let _0x25c4ff=null;!this[_0x2cb494(0x1a9)]&&(_0x25c4ff=this[_0x2cb494(0xa0)][_0x2cb494(0x16e)]?_0x2cb494(0x19a):_0x2cb494(0x185));let _0x470b2d={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x173d8f=await this['getStateAsync'](_0x2cb494(0x1fa));if(_0x173d8f&&_0x173d8f['val']){_0x470b2d[_0x2cb494(0x1b9)]=!![];const _0x2c1726=await this['getStateAsync'](_0x2cb494(0x133));_0x470b2d[_0x2cb494(0xe0)]=_0x2c1726?_0x2c1726[_0x2cb494(0x1c7)]:'';const _0x21111e=await this[_0x2cb494(0x1ae)](_0x2cb494(0x149));_0x470b2d[_0x2cb494(0xec)]=_0x21111e?_0x21111e[_0x2cb494(0x1c7)]:'';const _0x1d1f14=await this['getStateAsync'](_0x2cb494(0x15f));_0x470b2d[_0x2cb494(0x199)]=_0x1d1f14?_0x1d1f14[_0x2cb494(0x1c7)]:'';}const _0x14d7b5=await this[_0x2cb494(0x1ae)](_0x2cb494(0x1d3));_0x470b2d['autoApply']=_0x14d7b5?!!_0x14d7b5[_0x2cb494(0x1c7)]:![];}catch(_0x2ffe60){}this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':!![],'eventHistory':this['eventHistory'][_0x2cb494(0xc8)](0x0,0xf),'stats':{'digestCount':_0x3ea629,'eventCountToday':_0x2caaa9,'hourlyActivity':_0x57430f,'driftStatus':_0x14d2b8[_0x2cb494(0x1f9)],'isPresent':this[_0x2cb494(0xa7)],'presenceWho':_0x4df2c0,'minDays':this[_0x2cb494(0xa0)][_0x2cb494(0x124)]||0x7,'stbDays':this[_0x2cb494(0xa0)]['ltmStbWindowDays']||0xe,'ltbDays':this['config'][_0x2cb494(0x136)]||0x3c,'systemError':_0x25c4ff},'automation':_0x470b2d},_0x3bccdf[_0x2cb494(0x179)]);}else{if(_0x3bccdf[_0x2cb494(0xf8)]===_0x2cb494(0x11b))try{const _0x420067=await scanForDevices(this,_0x3bccdf[_0x2cb494(0x139)]||{});this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':!![],'devices':_0x420067},_0x3bccdf[_0x2cb494(0x179)]);}catch(_0x2af823){this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':![],'error':_0x2af823['message']},_0x3bccdf[_0x2cb494(0x179)]);}else{if(_0x3bccdf[_0x2cb494(0xf8)]===_0x2cb494(0x1b3)){const _0x32fd7c=await this['getForeignObjectsAsync']('enum.functions.*',_0x2cb494(0x11c)),_0x1e1160=[];if(_0x32fd7c)for(const _0x466c8a in _0x32fd7c){const _0x507b97=_0x32fd7c[_0x466c8a],_0x4449e6=(_0x507b97[_0x2cb494(0x12f)]&&typeof _0x507b97[_0x2cb494(0x12f)]['name']===_0x2cb494(0x1da)?_0x507b97['common'][_0x2cb494(0xb4)]['de']:_0x507b97['common'][_0x2cb494(0xb4)])||_0x507b97[_0x2cb494(0x12f)]['name'];_0x1e1160['push']({'id':_0x466c8a,'name':_0x4449e6});}this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf['command'],{'success':!![],'enums':_0x1e1160},_0x3bccdf[_0x2cb494(0x179)]);}else{if(_0x3bccdf[_0x2cb494(0xf8)]==='getCalendarNames'){const _0x559164=_0x3bccdf[_0x2cb494(0x139)]['instance'];if(!_0x559164)return this['sendTo'](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':![],'error':_0x2cb494(0x11e)},_0x3bccdf['callback']);const _0x744085=await getCalendarNames(this,_0x559164);this[_0x2cb494(0x207)](_0x3bccdf['from'],_0x3bccdf[_0x2cb494(0xf8)],{'success':!![],'names':_0x744085},_0x3bccdf['callback']);}else{if(_0x3bccdf[_0x2cb494(0xf8)]===_0x2cb494(0x90)){const {targetId:_0x4c65af,targetValue:_0x46e241}=_0x3bccdf[_0x2cb494(0x139)];this['log'][_0x2cb494(0x180)](_0x2cb494(0x134)+_0x4c65af+_0x2cb494(0x1c3)+_0x46e241),await this['setStateAsync']('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x2cb494(0x1d9)]('analysis.automation.description',{'val':_0x2cb494(0x201)+_0x4c65af,'ack':!![]}),await this[_0x2cb494(0x1d9)](_0x2cb494(0x149),{'val':_0x4c65af,'ack':!![]}),await this[_0x2cb494(0x1d9)]('analysis.automation.targetValue',{'val':_0x46e241,'ack':!![]}),this['sendTo'](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':!![]},_0x3bccdf['callback']);}else{if(_0x3bccdf[_0x2cb494(0xf8)]===_0x2cb494(0x13e)){const {historyId:_0x5ca5ea,rating:_0x187228,comment:_0x2bac7a,alertReason:_0x11cc31}=_0x3bccdf[_0x2cb494(0x139)];_0x5ca5ea&&_0x187228?(await saveFeedback(this,{'timestamp':Date[_0x2cb494(0x118)](),'historyId':_0x5ca5ea,'rating':_0x187228,'comment':_0x2bac7a,'alertReason':_0x11cc31}),this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':!![]},_0x3bccdf[_0x2cb494(0x179)])):this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':![],'error':_0x2cb494(0x1c4)},_0x3bccdf[_0x2cb494(0x179)]);}else _0x3bccdf['command']===_0x2cb494(0xce)&&(this[_0x2cb494(0x192)][_0x2cb494(0x180)](_0x2cb494(0x167)),await this[_0x2cb494(0x1d9)](_0x2cb494(0x1fa),{'val':![],'ack':!![]}),await this[_0x2cb494(0x1d9)](_0x2cb494(0x133),{'val':'','ack':!![]}),this[_0x2cb494(0x207)](_0x3bccdf[_0x2cb494(0x9f)],_0x3bccdf[_0x2cb494(0xf8)],{'success':!![]},_0x3bccdf[_0x2cb494(0x179)]));}}}}}}}}}}}if(require[a0_0x5289eb(0x158)]!==module)module['exports']=_0xf70771=>new CogniLiving(_0xf70771);else new CogniLiving();function a0_0x3223(){const _0x1d6b4b=['switch','analysis.automation.triggerAction','Insulation\x20Score','length','detected','occupancy','toLowerCase','version','dimmer','presence','lastAlertState','cancel','system.config','licht','\x20=\x20','Missing\x20data','ready','dependencyInstallInProgress','val','position','number','scriptEnabled','klima','.communicate.request','sendToAsync','\x20(Length:\x20','push','Trigger\x20Briefing','location','notifyTelegramEnabled','analysis.automation.autoApply','analysis.training.triggerHealth',')\x20-\x20FINAL\x20STRICT\x20FIX','analysis.energy.heatingScore','write','startsWith','setStateAsync','object','config_pending','analysis.health.lastCheck','city','toString','23631uHmclQ','.forecast.current.temp','system.mode','Security\x20Monitor','bind','weatherInstance','analysis.health','win32','HEALTH_RESULT','events.lastEvent','analysis.health.isAnomaly','analysisTimer','existsSync','shift','Scripts','pip.exe','Unknown','requirements.txt','automation.triggerAction','apply','Train\x20Health','ðŸ§ \x20Triggering\x20Security\x20Training...','notifyTelegramInstance','dutycycle','includes','analysis.training.triggerEnergy','status','analysis.automation.patternDetected','0\x204\x20*\x20*\x20*','Last\x20Check','âš ï¸\x20Python\x20missing\x20libs.\x20Auto-Install\x20triggered.','rawEventLog','getObjectAsync','close','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','analysis.analysisHistory','python.exe','level','Adapter','unreach','sendTo','python','stateChange','modeResetJob','data','systemUUID','Lernphase\x20(','bewegung','send','analysisInterval','analysis.activitySummary','âŒ\x20PIP\x20INSTALL\x20FAILED:\x20','system.presenceWho','âœ…\x20HEALTH\x20TRAINED:\x20','notifyEmailInstance','unshift','exitTimer','getTime','getHours','LTM.rawEventLog','triggerBriefing','Success:\x20','prÃ¤senz','LTM.processingStatus','getLtmData','Raw\x20Log','[PYTHON]\x20','5142933ILsqSa','TRAIN_ENERGY','Training\x20Error:\x20','simulateButler','timestamp','analysis.health.trendValue','analysis.history_debug_00','\x20->\x20','notifyPushoverEnabled','triggerDailyDigest','analysis.training.status','getMonth','power','normal','âš ï¸\x20VENV\x20missing.\x20Attempting\x20install...','ðŸ›¡ï¸\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','info.','STDOUT:\x20','from','config','Training\x20Status','currentposition','events.history_debug_00','python_service','type','setState','isPresent','Bibliotheken\x20nicht\x20gefunden','isGracePeriodActive','Daily\x20Digests','VACATION','inactivityThresholdHours','string','exitGraceTimer','notifyPushoverRecipient','Cogni-Living','6zBSHEb','analysis.security.lastScore','COGNI_REQUEST_CALL','name','lampe','weatherunderground','Pattern\x20Detected','System','subscribeForeignStatesAsync','Trigger\x20Analysis','insulation','uuid','getForeignObjectAsync','inactivityMonitoringEnabled','bin','ack','Health\x20Analysis','LTM.driftAnalysis.baselineDrift','unload','ðŸ\x20Python\x20Pong','\x22\x20install\x20--force-reinstall\x20-r\x20\x22','Activity\x20Summary','@iobroker/adapter-core','slice','boolean','analysis.isAlert','TRAIN_HEALTH','ANALYZE_SEQUENCE','467350LAPAOK','dismissAutomation','system.','briefingJob','notifyTelegramRecipient','Analysiere\x20ausgewogen.','Alert\x20Status','onMessage','payload','analysis.health.trendDiagnosis','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','Aktiv\x20(','notifyPushoverInstance','Alert\x20Reason','Thermodynamics','warn','[PYTHON\x20ERR]\x20','\x20events)...','WiFi\x20Presence\x20detected.','description','Failed:\x20','stick_unreach','[LOG]','energy','dailyDigests','getForeignStateAsync','tÃ¼r','some','service.py','Gemini\x20Init\x20Error:\x20','vis.','targetId','toISOString','admin.','channel','1ffGeWP','toFixed','systemConfig','retry','devices','date','window','getFullYear','command','Fokus\x20auf\x20Komfort.','System\x20Mode','N/A','subscribeStates','Kein\x20API\x20Key.','fenster','text','LTM.trainingData.thermodynamics','cpu_feature_guard','activityLevel','LTM.dailyDigests','temperature','analysis.training','cogni-living','448485TVcorh','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','motion','.Current.Temperature','Last\x20raw\x20event','analysis.trigger','isProVersion','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','presenceDevices','history.','scriptProblem','events.history','Train\x20Energy','unknown','parse','accuweather','getGenerativeModel','now','python3','onUnload','scanDevices','enum','firmware','No\x20instance','map','heizung','daswetter','direction','toLocaleTimeString','minDaysForBaseline','ðŸš¨\x20EMERGENCY','Trend','Sequences','LTM.triggerDailyDigest','@google/generative-ai','split','1754515WgNQdr','Pip\x20upgrade\x20failed\x20(ignoring):\x20','value','NORMAL','common','stderr','analysis.training.triggerSecurity','Fokus\x20auf\x20Familienroutinen.','analysis.automation.description','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','LTM.baselineStatus','ltmLtbWindowDays','âš ï¸\x20SECURITY\x20ALARM:\x20','logDuplicates','message','getOverviewData','shutter','[RESULT]','javascript.','submitFeedback','Heating\x20Score','node-schedule','stdout','generateContent','values','ENERGY_TRAIN_RESULT','No\x20module\x20named','Train\x20Security','schalter','LTM.trainingData.sequences','analysis.automation.targetId','json','Invalid\x20JSON:\x20','LTM.driftAnalysis.driftDetails','ðŸ› ï¸\x20MAINTENANCE\x20MODE:\x20Installing\x20Python\x20dependencies\x20(This\x20can\x20take\x20>5\x20minutes)...','temperatur','(((.+)+)+)+$','fault','genAI','flot.','writable','party','application/json','system','off','main','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','blind','working','1072576MhxfEQ','getDate','currentSystemMode','analysis.automation.targetValue','namespace','Activity-Level','Auto\x20Apply','link_quality','driftAnalysisTimer','splice','Alarm','User\x20dismissed\x20automation\x20proposal.','COGNI_CONFIRM_OK','indicator.alarm','stdin','analysis.security.lastCheck','testContext','onReady','geminiApiKey','Gemini\x20AI\x20initialized.','models/gemini-flash-latest','openweathermap','setpoint','Target\x20ID','analysisHistory','[RECORDER]\x20Error\x20saving\x20sequence:\x20','analysis.energy.insulationScore','testApiKey','LTM','callback','constructor','onStateChange','online','button','\x22\x20install\x20--upgrade\x20pip','ðŸ\x20Using\x20VENV\x20Python:\x20','info','substring','trim','analysis.alertReason','Step\x201:\x20Upgrading\x20pip...','Kein\x20API\x20Key!','ANOMALY','endsWith','pip','Trend\x20Value','indexOf','system.isPresent','expire','Energy\x20Intelligence','[PYTHON]\x20Exited\x20code\x20','GUEST','debug','extendObjectAsync','log','Target\x20Value','stringify','state','ðŸ\x20Stopping\x20Python...','targetposition','reachable','targetValue','KI-Modell\x20nicht\x20initialisiert','kill','join','child_process','TRAIN_SECURITY','eventHistory','sensorLastValues','setObjectNotExistsAsync','search','ANALYZE_TREND','analysis.triggerBriefing','round','âœ…\x20Alles\x20OK\x20(Reset)]','55076KNMujK','communicate.request','geminiModel','humidity','error','pythonProcess','telegram','getStateAsync','outdoorSensorId','SECURITY_RESULT','ltmJob','indicator','getEnums','pop'];a0_0x3223=function(){return _0x1d6b4b;};return a0_0x3223();}