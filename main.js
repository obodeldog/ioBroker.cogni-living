const a0_0x3b7d7b=a0_0x27c3;(function(_0x1e23ac,_0xd8ad8d){const _0xfbb5fd=a0_0x27c3,_0x1ef650=_0x1e23ac();while(!![]){try{const _0x3eeb04=parseInt(_0xfbb5fd(0x278))/0x1+-parseInt(_0xfbb5fd(0x1e4))/0x2+-parseInt(_0xfbb5fd(0x2fb))/0x3+parseInt(_0xfbb5fd(0x2dc))/0x4+-parseInt(_0xfbb5fd(0x3af))/0x5+-parseInt(_0xfbb5fd(0x352))/0x6*(parseInt(_0xfbb5fd(0x33f))/0x7)+parseInt(_0xfbb5fd(0x323))/0x8;if(_0x3eeb04===_0xd8ad8d)break;else _0x1ef650['push'](_0x1ef650['shift']());}catch(_0x37d0da){_0x1ef650['push'](_0x1ef650['shift']());}}}(a0_0x35a8,0x209f9));const a0_0x1998e6=(function(){let _0x148d9b=!![];return function(_0x48ad1a,_0x48966d){const _0x167c08=_0x148d9b?function(){const _0x51d5d5=a0_0x27c3;if(_0x48966d){const _0x497100=_0x48966d[_0x51d5d5(0x1fe)](_0x48ad1a,arguments);return _0x48966d=null,_0x497100;}}:function(){};return _0x148d9b=![],_0x167c08;};}()),a0_0x56c3ab=a0_0x1998e6(this,function(){const _0x132bda=a0_0x27c3;return a0_0x56c3ab['toString']()[_0x132bda(0x2d3)](_0x132bda(0x291))[_0x132bda(0x233)]()[_0x132bda(0x2cb)](a0_0x56c3ab)[_0x132bda(0x2d3)](_0x132bda(0x291));});a0_0x56c3ab();'use strict';const utils=require(a0_0x3b7d7b(0x34d)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x3b7d7b(0x35c)),path=require(a0_0x3b7d7b(0x3c0)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x3b7d7b(0x362),LTM_SCHEDULE=a0_0x3b7d7b(0x225),MODE_RESET_SCHEDULE=a0_0x3b7d7b(0x279),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0x3b7d7b(0x316),LTM_DP_DAILY_DIGESTS=a0_0x3b7d7b(0x274),LTM_DP_STATUS=a0_0x3b7d7b(0x2f0),LTM_DP_TRIGGER_DIGEST=a0_0x3b7d7b(0x2ed),LTM_DP_BASELINE_STATUS=a0_0x3b7d7b(0x3cb),LTM_DP_DRIFT_CHANNEL=a0_0x3b7d7b(0x2d7),LTM_DP_DRIFT_STATUS=a0_0x3b7d7b(0x2ef),LTM_DP_DRIFT_DETAILS=a0_0x3b7d7b(0x2e1),LTM_DP_DRIFT_LAST_CHECK=a0_0x3b7d7b(0x1cf),SYSTEM_DP_MODE=a0_0x3b7d7b(0x2ce),HARD_IGNORE_TERMS=[a0_0x3b7d7b(0x370),'scriptEnabled',a0_0x3b7d7b(0x402),a0_0x3b7d7b(0x33d),a0_0x3b7d7b(0x3bf),a0_0x3b7d7b(0x2bc),'connection',a0_0x3b7d7b(0x2b9),'error',a0_0x3b7d7b(0x210),a0_0x3b7d7b(0x26a),a0_0x3b7d7b(0x38f),a0_0x3b7d7b(0x372),a0_0x3b7d7b(0x35a),a0_0x3b7d7b(0x2ee),'firmware',a0_0x3b7d7b(0x392),a0_0x3b7d7b(0x3dc)],BAD_NAMES=[a0_0x3b7d7b(0x1d2),a0_0x3b7d7b(0x383),a0_0x3b7d7b(0x368),a0_0x3b7d7b(0x21a),a0_0x3b7d7b(0x29e),a0_0x3b7d7b(0x3e7),'on','off','switch',a0_0x3b7d7b(0x2fd),a0_0x3b7d7b(0x407),a0_0x3b7d7b(0x1dd),'cover','status',a0_0x3b7d7b(0x3ed),a0_0x3b7d7b(0x3a9),a0_0x3b7d7b(0x1ca),a0_0x3b7d7b(0x29f),'humidity',a0_0x3b7d7b(0x366),a0_0x3b7d7b(0x27a),a0_0x3b7d7b(0x1d9),a0_0x3b7d7b(0x204),a0_0x3b7d7b(0x39d),a0_0x3b7d7b(0x3f6)],ADAPTER_BLACKLIST=[a0_0x3b7d7b(0x322),a0_0x3b7d7b(0x2e5),'info.',a0_0x3b7d7b(0x1c8),a0_0x3b7d7b(0x1d1),'material.',a0_0x3b7d7b(0x22f),'flot.',a0_0x3b7d7b(0x20a),'javascript.','simple-api.'],SYSTEM_MODES={'NORMAL':a0_0x3b7d7b(0x394),'VACATION':a0_0x3b7d7b(0x39a),'PARTY':a0_0x3b7d7b(0x23f),'GUEST':a0_0x3b7d7b(0x30a)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES['GUEST']],PERSONA_MAPPING={'generic':a0_0x3b7d7b(0x3fd),'senior_aal':'PRIORITÃ„T:\x20Gesundheit/AAL.','family':a0_0x3b7d7b(0x37e),'single_comfort':a0_0x3b7d7b(0x265),'security':a0_0x3b7d7b(0x1ef)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x2d3ba8){const _0x8c71e5=a0_0x3b7d7b;try{const _0x5e1f57=[_0x8c71e5(0x24e),'events.history_debug_00'];for(const _0x2ca494 of _0x5e1f57){try{const _0x8a6c19=await _0x2d3ba8[_0x8c71e5(0x23e)](_0x2ca494);_0x8a6c19&&await _0x2d3ba8['delObjectAsync'](_0x2ca494);}catch(_0x1eea41){}}}catch(_0x30b075){}}async function initHistory(_0x5a266b){const _0x4ecbb2=a0_0x3b7d7b;try{const _0x8ac6a7=await _0x5a266b[_0x4ecbb2(0x357)](_0x4ecbb2(0x406));_0x8ac6a7&&_0x8ac6a7[_0x4ecbb2(0x28a)]&&(_0x5a266b[_0x4ecbb2(0x3d8)]=JSON['parse'](_0x8ac6a7['val']['toString']()));}catch(_0x300d42){_0x5a266b[_0x4ecbb2(0x3d8)]=[];}try{const _0x167b08=await _0x5a266b[_0x4ecbb2(0x357)](_0x4ecbb2(0x3c6));if(_0x167b08&&_0x167b08[_0x4ecbb2(0x28a)])_0x5a266b[_0x4ecbb2(0x3c4)]=JSON[_0x4ecbb2(0x2e6)](_0x167b08[_0x4ecbb2(0x28a)][_0x4ecbb2(0x233)]());}catch(_0x3a9122){_0x5a266b[_0x4ecbb2(0x3c4)]=[];}if(_0x5a266b['eventHistory']&&_0x5a266b[_0x4ecbb2(0x3d8)]['length']>0x0){_0x5a266b['log'][_0x4ecbb2(0x311)](_0x4ecbb2(0x3c9)+_0x5a266b['eventHistory'][_0x4ecbb2(0x3cc)]+_0x4ecbb2(0x329));for(let _0x232268=_0x5a266b[_0x4ecbb2(0x3d8)]['length']-0x1;_0x232268>=0x0;_0x232268--){const _0x25b9d4=_0x5a266b[_0x4ecbb2(0x3d8)][_0x232268];_0x25b9d4&&_0x25b9d4['id']!==undefined&&_0x25b9d4['value']!==undefined&&(_0x5a266b[_0x4ecbb2(0x379)][_0x25b9d4['id']]=_0x25b9d4['value']);}}}async function initSystemConfig(_0x1820c7){const _0x5aa25e=a0_0x3b7d7b;try{const _0x56e9c8=await _0x1820c7[_0x5aa25e(0x28f)](_0x5aa25e(0x27f));_0x56e9c8&&_0x56e9c8[_0x5aa25e(0x309)]&&(_0x1820c7[_0x5aa25e(0x227)]={'latitude':_0x56e9c8[_0x5aa25e(0x309)][_0x5aa25e(0x216)]||0x0,'longitude':_0x56e9c8[_0x5aa25e(0x309)][_0x5aa25e(0x25f)]||0x0,'city':_0x56e9c8[_0x5aa25e(0x309)][_0x5aa25e(0x2cc)]||''});}catch(_0x74e77a){}}async function checkLicense(_0x1db632,_0x59fda5){const _0x40052d=a0_0x3b7d7b;if(!_0x59fda5)return![];_0x1db632[_0x40052d(0x3e3)]=await getSystemUUID(_0x1db632);if(_0x59fda5===_0x40052d(0x314)||_0x59fda5['startsWith'](_0x40052d(0x224)))return!![];return![];}async function getSystemUUID(_0x2d07cb){const _0x518b79=a0_0x3b7d7b;try{const _0x1ebfb3=await _0x2d07cb['getForeignObjectAsync'](_0x518b79(0x2a2));if(_0x1ebfb3&&_0x1ebfb3[_0x518b79(0x1f2)]&&_0x1ebfb3[_0x518b79(0x1f2)][_0x518b79(0x2e8)])return _0x1ebfb3[_0x518b79(0x1f2)][_0x518b79(0x2e8)];return'uuid-not-found';}catch(_0x28bf0e){return'uuid-error';}}async function createAllObjects(_0x58b962){const _0x2db00f=a0_0x3b7d7b;await checkSystemObjects(_0x58b962),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x31a),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x1d7),'type':_0x2db00f(0x1df),'role':'text','read':!![],'write':![],'def':''},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x21e),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x3f1),'type':_0x2db00f(0x1df),'role':_0x2db00f(0x3b7),'read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x406),{'type':_0x2db00f(0x368),'common':{'name':'Event\x20History','type':_0x2db00f(0x1df),'role':_0x2db00f(0x3b7),'read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x1f0),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x2c4),'type':_0x2db00f(0x333),'role':_0x2db00f(0x3fe),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x58b962['setObjectNotExistsAsync']('analysis.triggerBriefing',{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x2f8),'type':_0x2db00f(0x333),'role':_0x2db00f(0x3fe),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x58b962[_0x2db00f(0x391)](_0x2db00f(0x253),{'type':_0x2db00f(0x23c),'common':{'name':_0x2db00f(0x403)},'native':{}}),await _0x58b962['setObjectNotExistsAsync']('analysis.training.triggerSecurity',{'type':'state','common':{'name':_0x2db00f(0x275),'type':_0x2db00f(0x333),'role':_0x2db00f(0x3fe),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x241),{'type':'state','common':{'name':_0x2db00f(0x260),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)]('analysis.training.status',{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x276),'type':_0x2db00f(0x1df),'role':'text','read':!![],'write':![],'def':'Idle'},'native':{}}),await _0x58b962[_0x2db00f(0x391)]('analysis.security',{'type':_0x2db00f(0x23c),'common':{'name':'Live\x20Security\x20Monitor'},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x28d),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x32e),'type':'number','role':_0x2db00f(0x29e),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x2bb),{'type':'state','common':{'name':_0x2db00f(0x21b),'type':_0x2db00f(0x1df),'role':'date','read':!![],'write':![],'def':''},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x2fe),{'type':_0x2db00f(0x368),'common':{'name':'Health\x20Last\x20Check','type':_0x2db00f(0x1df),'role':'date','read':!![],'write':![],'def':''},'native':{}}),await _0x58b962['setObjectNotExistsAsync']('analysis.health.isAnomaly',{'type':_0x2db00f(0x368),'common':{'name':'Health\x20Anomaly\x20Detected','type':_0x2db00f(0x333),'role':_0x2db00f(0x31b),'read':!![],'write':![],'def':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x226),{'type':'state','common':{'name':_0x2db00f(0x3e8),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)]('analysis.isAlert',{'type':_0x2db00f(0x368),'common':{'name':'AI\x20Alert\x20Status','type':'boolean','role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x2ec),{'type':_0x2db00f(0x368),'common':{'name':'AI\x20Emergency\x20Status','type':_0x2db00f(0x333),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)]('analysis.alertReason',{'type':'state','common':{'name':_0x2db00f(0x2a6),'type':_0x2db00f(0x1df),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)]('analysis.activitySummary',{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x33a),'type':'string','role':_0x2db00f(0x20c),'read':!![],'write':![]},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x3a1),{'type':_0x2db00f(0x368),'common':{'name':'Deviation','type':_0x2db00f(0x1df),'role':'state','read':!![],'write':![],'def':_0x2db00f(0x244)},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x2b0),{'type':_0x2db00f(0x368),'common':{'name':'Comfort\x20Summary','type':_0x2db00f(0x1df),'role':_0x2db00f(0x20c),'read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)]('analysis.comfortSuggestion',{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x249),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x391)](_0x2db00f(0x328),{'type':_0x2db00f(0x23c),'common':{'name':_0x2db00f(0x202)},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x3de),{'type':'state','common':{'name':_0x2db00f(0x303),'type':_0x2db00f(0x333),'role':_0x2db00f(0x2b6),'read':!![],'write':![],'def':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x32c),{'type':_0x2db00f(0x368),'common':{'name':'Description','type':_0x2db00f(0x1df),'role':_0x2db00f(0x20c),'read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)]('analysis.automation.suggestedAction',{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x2d2),'type':'string','role':_0x2db00f(0x20c),'read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x27c),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x2b5),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x211),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x1d5),'type':'string','role':_0x2db00f(0x20c),'read':!![],'write':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x376),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x277),'type':_0x2db00f(0x333),'role':_0x2db00f(0x30c),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x2aa),{'type':'state','common':{'name':_0x2db00f(0x2c9),'type':_0x2db00f(0x333),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x3c6),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x3a5),'type':_0x2db00f(0x1df),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x24b),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x243),'type':'string','role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x58b962['extendObjectAsync'](_0x2db00f(0x25e),{'type':_0x2db00f(0x23c),'common':{'name':_0x2db00f(0x2c3)},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x363),{'type':'state','common':{'name':_0x2db00f(0x3ca),'type':'number','role':_0x2db00f(0x2f6),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x1e8),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x1c7),'type':_0x2db00f(0x1df),'role':_0x2db00f(0x20c),'read':!![],'write':![],'def':'none'},'native':{}}),await _0x58b962['setObjectNotExistsAsync'](_0x2db00f(0x259),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x1e2),'type':_0x2db00f(0x1df),'role':_0x2db00f(0x20c),'read':!![],'write':![],'def':''},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)]('analysis.health.trendDiagnosis',{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x3be),'type':'string','role':_0x2db00f(0x20c),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)]('analysis.health.trendValue',{'type':'state','common':{'name':_0x2db00f(0x219),'type':_0x2db00f(0x380),'role':_0x2db00f(0x29e),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x58b962[_0x2db00f(0x391)](_0x2db00f(0x2a5),{'type':_0x2db00f(0x23c),'common':{'name':_0x2db00f(0x3ae)},'native':{}}),await _0x58b962[_0x2db00f(0x3fc)](_0x2db00f(0x378),{'type':_0x2db00f(0x368),'common':{'name':_0x2db00f(0x254),'type':_0x2db00f(0x1df),'role':_0x2db00f(0x3b7),'read':!![],'write':![],'def':'[]','desc':_0x2db00f(0x360)},'native':{}}),await _0x58b962['setObjectNotExistsAsync']('LTM.trainingData.thermodynamics',{'type':_0x2db00f(0x368),'common':{'name':'Thermodynamic\x20Data\x20Points','type':_0x2db00f(0x1df),'role':'json','read':!![],'write':![],'def':'[]','desc':_0x2db00f(0x2b8)},'native':{}}),await checkLtmObjects(_0x58b962),await checkLtmDriftObjects(_0x58b962);}async function checkSystemObjects(_0x5d70c1){const _0x306502=a0_0x3b7d7b;await _0x5d70c1[_0x306502(0x391)](_0x306502(0x3fb),{'type':'channel','common':{'name':_0x306502(0x30e)},'native':{}}),await _0x5d70c1['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x306502(0x368),'common':{'name':_0x306502(0x3f0),'type':'string','role':_0x306502(0x368),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x306502(0x3d4)],'states':{[SYSTEM_MODES[_0x306502(0x3d4)]]:'Normal',[SYSTEM_MODES[_0x306502(0x2fa)]]:_0x306502(0x3e6),[SYSTEM_MODES[_0x306502(0x3e9)]]:_0x306502(0x1f4),[SYSTEM_MODES[_0x306502(0x361)]]:_0x306502(0x35b)}},'native':{}});}async function checkLtmObjects(_0x257e95){const _0x4c4577=a0_0x3b7d7b;await _0x257e95[_0x4c4577(0x391)](_0x4c4577(0x3b3),{'type':_0x4c4577(0x23c),'common':{'name':_0x4c4577(0x3b3)},'native':{}}),await _0x257e95[_0x4c4577(0x391)](LTM_DP_RAW_LOG,{'type':_0x4c4577(0x368),'common':{'name':'Raw\x20Log','type':_0x4c4577(0x1df),'role':_0x4c4577(0x3b7),'read':!![],'write':![]},'native':{}}),await _0x257e95[_0x4c4577(0x391)](LTM_DP_DAILY_DIGESTS,{'type':_0x4c4577(0x368),'common':{'name':_0x4c4577(0x28b),'type':_0x4c4577(0x1df),'role':_0x4c4577(0x3b7),'read':!![],'write':![]},'native':{}}),await _0x257e95[_0x4c4577(0x391)](LTM_DP_STATUS,{'type':_0x4c4577(0x368),'common':{'name':_0x4c4577(0x3b6),'type':_0x4c4577(0x1df),'role':'text','read':!![],'write':![]},'native':{}}),await _0x257e95['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x4c4577(0x255),'type':'boolean','role':_0x4c4577(0x3fe),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x257e95[_0x4c4577(0x391)](LTM_DP_BASELINE_STATUS,{'type':_0x4c4577(0x368),'common':{'name':_0x4c4577(0x234),'type':_0x4c4577(0x1df),'role':_0x4c4577(0x20c),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x224532){const _0x4a87db=a0_0x3b7d7b;await _0x224532[_0x4a87db(0x391)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x4a87db(0x20f)},'native':{}}),await _0x224532[_0x4a87db(0x391)](LTM_DP_DRIFT_STATUS,{'type':_0x4a87db(0x368),'common':{'name':_0x4a87db(0x267),'type':'string','role':_0x4a87db(0x368),'read':!![],'write':![],'def':_0x4a87db(0x244)},'native':{}}),await _0x224532[_0x4a87db(0x391)](LTM_DP_DRIFT_DETAILS,{'type':_0x4a87db(0x368),'common':{'name':_0x4a87db(0x36f),'type':_0x4a87db(0x1df),'role':_0x4a87db(0x20c),'read':!![],'write':![]},'native':{}}),await _0x224532[_0x4a87db(0x391)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x4a87db(0x368),'common':{'name':_0x4a87db(0x1c9),'type':'number','role':_0x4a87db(0x1d0),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x5cf172){const _0x42124b=a0_0x3b7d7b;try{const _0xc183b3=await _0x5cf172[_0x42124b(0x357)](SYSTEM_DP_MODE);_0xc183b3&&_0xc183b3['val']&&Object[_0x42124b(0x2c1)](SYSTEM_MODES)['includes'](_0xc183b3[_0x42124b(0x28a)])?_0x5cf172[_0x42124b(0x223)]=_0xc183b3['val']:(_0x5cf172[_0x42124b(0x223)]=SYSTEM_MODES[_0x42124b(0x3d4)],await _0x5cf172[_0x42124b(0x2c5)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x42124b(0x3d4)],'ack':!![]}));}catch(_0x318cbc){_0x5cf172[_0x42124b(0x223)]=SYSTEM_MODES[_0x42124b(0x3d4)];}}async function loadRawEventLog(_0x16ab6e){const _0x25a4a5=a0_0x3b7d7b;try{const _0x16eec3=await _0x16ab6e[_0x25a4a5(0x357)](LTM_DP_RAW_LOG);if(_0x16eec3&&_0x16eec3[_0x25a4a5(0x28a)])_0x16ab6e[_0x25a4a5(0x302)]=JSON['parse'](_0x16eec3['val']);}catch(_0x52eefa){_0x16ab6e[_0x25a4a5(0x302)]=[];}}async function saveRawEventLog(_0x5dd6c0){const _0x3d7a19=a0_0x3b7d7b;_0x5dd6c0['rawEventLog']['length']>RAW_LOG_MAX_SIZE&&_0x5dd6c0[_0x3d7a19(0x302)][_0x3d7a19(0x236)](0x0,_0x5dd6c0['rawEventLog']['length']-RAW_LOG_MAX_SIZE),await _0x5dd6c0[_0x3d7a19(0x2c5)](LTM_DP_RAW_LOG,{'val':JSON[_0x3d7a19(0x28c)](_0x5dd6c0[_0x3d7a19(0x302)]),'ack':!![]});}async function loadDailyDigests(_0x3f3c1b){const _0xab51e0=a0_0x3b7d7b;try{const _0xc320e6=await _0x3f3c1b[_0xab51e0(0x357)](LTM_DP_DAILY_DIGESTS);if(_0xc320e6&&_0xc320e6[_0xab51e0(0x28a)])_0x3f3c1b['dailyDigests']=JSON[_0xab51e0(0x2e6)](_0xc320e6[_0xab51e0(0x28a)]);}catch(_0x39b30b){_0x3f3c1b['dailyDigests']=[];}await updateBaselineStatus(_0x3f3c1b);}async function saveDailyDigests(_0x2db61f,_0x301ed2=!![]){const _0x2cf2f3=a0_0x3b7d7b,_0x5e0b91=_0x2db61f[_0x2cf2f3(0x1d4)][_0x2cf2f3(0x1da)]||0x3c;_0x2db61f[_0x2cf2f3(0x340)]['length']>_0x5e0b91&&_0x2db61f[_0x2cf2f3(0x340)][_0x2cf2f3(0x236)](0x0,_0x2db61f[_0x2cf2f3(0x340)][_0x2cf2f3(0x3cc)]-_0x5e0b91);await _0x2db61f[_0x2cf2f3(0x2c5)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x2db61f['dailyDigests']),'ack':!![]});if(_0x301ed2)await updateBaselineStatus(_0x2db61f);}async function updateAnalysisHistory(_0x53c9d0,_0x58dce2){const _0x47f6ad=a0_0x3b7d7b;_0x53c9d0[_0x47f6ad(0x3c4)][_0x47f6ad(0x356)](_0x58dce2);if(_0x53c9d0[_0x47f6ad(0x3c4)][_0x47f6ad(0x3cc)]>ANALYSIS_HISTORY_MAX_SIZE)_0x53c9d0[_0x47f6ad(0x3c4)]['pop']();await _0x53c9d0[_0x47f6ad(0x2c5)](_0x47f6ad(0x3c6),{'val':JSON[_0x47f6ad(0x28c)](_0x53c9d0[_0x47f6ad(0x3c4)]),'ack':!![]});}async function updateBaselineStatus(_0x3d259c){const _0x5696fb=a0_0x3b7d7b;if(!_0x3d259c[_0x5696fb(0x283)]){await _0x3d259c[_0x5696fb(0x2c5)](LTM_DP_BASELINE_STATUS,{'val':_0x5696fb(0x33e),'ack':!![]});return;}const _0x336f2b=_0x3d259c['dailyDigests'][_0x5696fb(0x3cc)]>=(_0x3d259c['config'][_0x5696fb(0x1ea)]||0x7)?_0x5696fb(0x3ea)+_0x3d259c[_0x5696fb(0x340)][_0x5696fb(0x3cc)]+_0x5696fb(0x201):_0x5696fb(0x230)+_0x3d259c['dailyDigests'][_0x5696fb(0x3cc)]+'/'+(_0x3d259c[_0x5696fb(0x1d4)][_0x5696fb(0x1ea)]||0x7)+')';await _0x3d259c[_0x5696fb(0x2c5)](LTM_DP_BASELINE_STATUS,{'val':_0x336f2b,'ack':!![]});}async function initSensorSubscriptions(_0x152d7c){const _0x1e3cb8=a0_0x3b7d7b,_0x4a65c1=_0x152d7c['config'][_0x1e3cb8(0x365)];if(_0x4a65c1&&_0x4a65c1[_0x1e3cb8(0x3cc)]>0x0){_0x152d7c[_0x1e3cb8(0x2cf)][_0x1e3cb8(0x311)](_0x1e3cb8(0x405)+_0x4a65c1['length']+_0x1e3cb8(0x327));for(const _0x3b0c88 of _0x4a65c1){if(_0x3b0c88['id']){await _0x152d7c['subscribeForeignStatesAsync'](_0x3b0c88['id']);try{const _0x35924e=await _0x152d7c[_0x1e3cb8(0x342)](_0x3b0c88['id']);if(_0x35924e)_0x152d7c[_0x1e3cb8(0x379)][_0x3b0c88['id']]=_0x35924e[_0x1e3cb8(0x28a)];}catch(_0x175080){}}}}}async function initPresenceSubscriptions(_0x45d2fa){const _0x23bae8=a0_0x3b7d7b,_0x3f69e9=_0x45d2fa[_0x23bae8(0x1d4)][_0x23bae8(0x3ba)]||[];if(_0x3f69e9[_0x23bae8(0x3cc)]>0x0){_0x45d2fa[_0x23bae8(0x2cf)][_0x23bae8(0x311)](_0x23bae8(0x405)+_0x3f69e9[_0x23bae8(0x3cc)]+'\x20presence\x20devices...');for(const _0x2cd4d2 of _0x3f69e9){await _0x45d2fa[_0x23bae8(0x2c0)](_0x2cd4d2);}try{await checkWifiPresence(_0x45d2fa);}catch(_0x337040){}}}async function getWeatherContext(_0x121f2b){const _0x156797=a0_0x3b7d7b;try{if(!_0x121f2b['config'][_0x156797(0x2d4)])return _0x156797(0x1cb);let _0x5c33c7='';const _0x48c038=_0x121f2b[_0x156797(0x1d4)]['weatherInstance'];if(_0x48c038)try{if(_0x48c038[_0x156797(0x2a3)](_0x156797(0x371))){const _0x4683dc=await _0x121f2b[_0x156797(0x342)](_0x48c038+_0x156797(0x31d));if(_0x4683dc&&_0x4683dc[_0x156797(0x28a)])_0x5c33c7=_0x4683dc[_0x156797(0x28a)];}else{if(_0x48c038['includes']('daswetter')){const _0x54cce0=await _0x121f2b[_0x156797(0x342)](_0x48c038+_0x156797(0x248));if(_0x54cce0&&_0x54cce0[_0x156797(0x28a)])_0x5c33c7=_0x54cce0[_0x156797(0x28a)];}else{if(_0x48c038[_0x156797(0x2a3)]('openweathermap')){const _0x17d353=await _0x121f2b['getForeignStateAsync'](_0x48c038+_0x156797(0x294));if(_0x17d353&&_0x17d353[_0x156797(0x28a)])_0x5c33c7=_0x17d353[_0x156797(0x28a)];}}}}catch(_0x552998){}if(!_0x5c33c7){const _0x3df716=['accuweather.0','daswetter.0',_0x156797(0x326),_0x156797(0x317)];for(const _0x57e62d of _0x3df716){try{const _0x4bd479=await _0x121f2b[_0x156797(0x28f)](_0x57e62d);if(_0x4bd479){if(_0x57e62d[_0x156797(0x2a3)]('accuweather')){const _0x2c04fb=await _0x121f2b[_0x156797(0x342)](_0x57e62d+'.Summary.Current');if(_0x2c04fb&&_0x2c04fb['val']){_0x5c33c7=_0x2c04fb[_0x156797(0x28a)];break;}}}}catch(_0x46da4f){}}}return _0x5c33c7?_0x156797(0x2cd)+_0x5c33c7:_0x156797(0x2b1);}catch(_0x3acaf2){return'WETTER\x20ERROR:\x20'+_0x3acaf2[_0x156797(0x235)];}}async function getCalendarContext(_0x2adf46){const _0x2d0b18=a0_0x3b7d7b;try{if(!_0x2adf46['config'][_0x2d0b18(0x385)])return _0x2d0b18(0x321);let _0x35dfcf=_0x2adf46[_0x2d0b18(0x1d4)][_0x2d0b18(0x308)]||'ical.0',_0x26288f=_0x2adf46[_0x2d0b18(0x1d4)][_0x2d0b18(0x1f9)]||[];if(typeof _0x26288f==='string')_0x26288f=_0x26288f['split'](',');try{const _0x18f73=await _0x2adf46[_0x2d0b18(0x342)](_0x35dfcf+_0x2d0b18(0x29c));if(_0x18f73&&_0x18f73['val']){let _0x2991f4=tryParse(_0x18f73[_0x2d0b18(0x28a)]);if(_0x2991f4&&Array[_0x2d0b18(0x24f)](_0x2991f4)){if(_0x26288f['length']>0x0)_0x2991f4=_0x2991f4[_0x2d0b18(0x221)](_0x58b626=>_0x26288f['includes'](_0x58b626['_calName']||''));else return'KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)';if(_0x2991f4[_0x2d0b18(0x3cc)]>0x0){const _0x18b565=_0x2991f4[_0x2d0b18(0x3b2)](0x0,0x3)[_0x2d0b18(0x24a)](_0x4cdefa=>{const _0x424aa0=_0x2d0b18;let _0x179c35=_0x4cdefa[_0x424aa0(0x1d0)];if(_0x4cdefa[_0x424aa0(0x24d)])_0x179c35+='\x20'+_0x4cdefa[_0x424aa0(0x24d)];return _0x179c35+':\x20'+_0x4cdefa[_0x424aa0(0x35d)]+'\x20('+_0x4cdefa[_0x424aa0(0x298)]+')';});return _0x2d0b18(0x32d)+_0x18b565[_0x2d0b18(0x263)](_0x2d0b18(0x3a2));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x154d9d){_0x2adf46[_0x2d0b18(0x2cf)][_0x2d0b18(0x38b)](_0x2d0b18(0x1c5)+_0x154d9d[_0x2d0b18(0x235)]);}return _0x2d0b18(0x390);}catch(_0x25c3a5){return'KALENDER\x20ERROR:\x20'+_0x25c3a5[_0x2d0b18(0x235)];}}async function getCalendarNames(_0x32b9d7,_0x4708fb){const _0x1ab7c3=a0_0x3b7d7b;try{const _0x181ab7=await _0x32b9d7[_0x1ab7c3(0x342)](_0x4708fb+_0x1ab7c3(0x29c));if(_0x181ab7&&_0x181ab7['val']){const _0x2f0fe8=tryParse(_0x181ab7[_0x1ab7c3(0x28a)]);if(_0x2f0fe8&&Array[_0x1ab7c3(0x24f)](_0x2f0fe8)){const _0x464311=[...new Set(_0x2f0fe8[_0x1ab7c3(0x24a)](_0x57a67a=>_0x57a67a['_calName'])['filter'](Boolean))];return _0x464311[_0x1ab7c3(0x2f2)]();}}return[];}catch(_0x4dd981){return _0x32b9d7[_0x1ab7c3(0x2cf)][_0x1ab7c3(0x2f4)](_0x1ab7c3(0x3d2)+_0x4dd981[_0x1ab7c3(0x235)]),[];}}async function checkWifiPresence(_0x1c87ca){const _0x1bebed=a0_0x3b7d7b;try{const _0x4243f5=_0x1c87ca[_0x1bebed(0x1d4)][_0x1bebed(0x3ba)]||[];let _0x377a94=![];const _0x3b8487=[];for(const _0x1d3c51 of _0x4243f5){try{const _0x181469=await _0x1c87ca['getForeignStateAsync'](_0x1d3c51);if(_0x181469&&(_0x181469[_0x1bebed(0x28a)]===!![]||_0x181469[_0x1bebed(0x28a)]===_0x1bebed(0x239)||_0x181469[_0x1bebed(0x28a)]===0x1)){_0x377a94=!![];const _0x380c46=await _0x1c87ca[_0x1bebed(0x28f)](_0x1d3c51);let _0x49ea84=_0x1d3c51;_0x380c46&&_0x380c46[_0x1bebed(0x309)]&&_0x380c46[_0x1bebed(0x309)]['name']&&(_0x49ea84=typeof _0x380c46[_0x1bebed(0x309)][_0x1bebed(0x315)]===_0x1bebed(0x2d5)?_0x380c46[_0x1bebed(0x309)][_0x1bebed(0x315)]['de']||_0x380c46[_0x1bebed(0x309)][_0x1bebed(0x315)]['en']:_0x380c46[_0x1bebed(0x309)]['name']),_0x3b8487[_0x1bebed(0x1cc)](_0x49ea84);}}catch(_0x57d637){}}return await _0x1c87ca[_0x1bebed(0x2c5)]('system.presenceWho',{'val':_0x3b8487['join'](',\x20'),'ack':!![]}),_0x377a94&&(_0x1c87ca[_0x1bebed(0x237)]&&(_0x1c87ca[_0x1bebed(0x2cf)][_0x1bebed(0x311)](_0x1bebed(0x214)),abortExitTimer(_0x1c87ca)),!_0x1c87ca[_0x1bebed(0x25c)]&&_0x1c87ca[_0x1bebed(0x223)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x1c87ca,!![])),_0x377a94;}catch(_0x53d560){return _0x1c87ca[_0x1bebed(0x2cf)][_0x1bebed(0x2f4)](_0x1bebed(0x285)+_0x53d560[_0x1bebed(0x235)]),![];}}function startExitTimer(_0x13a471){const _0x58ea11=a0_0x3b7d7b;abortExitTimer(_0x13a471),_0x13a471[_0x58ea11(0x257)]=!![],_0x13a471['exitGraceTimer']=setTimeout(()=>{const _0x523114=_0x58ea11;_0x13a471[_0x523114(0x257)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x13a471['exitTimer']=setTimeout(()=>{const _0x35f6c1=_0x58ea11;setPresence(_0x13a471,![]),_0x13a471[_0x35f6c1(0x237)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x4fb852){const _0x38121f=a0_0x3b7d7b;if(_0x4fb852[_0x38121f(0x237)])clearTimeout(_0x4fb852['exitTimer']);if(_0x4fb852[_0x38121f(0x35e)])clearTimeout(_0x4fb852[_0x38121f(0x35e)]);_0x4fb852[_0x38121f(0x237)]=null,_0x4fb852['exitGraceTimer']=null,_0x4fb852[_0x38121f(0x257)]=![];}async function setPresence(_0x4da8cf,_0x3d9e2f){const _0x421c81=a0_0x3b7d7b;if(_0x4da8cf[_0x421c81(0x25c)]===_0x3d9e2f)return;_0x4da8cf[_0x421c81(0x25c)]=_0x3d9e2f,await _0x4da8cf['setStateAsync'](_0x421c81(0x3fa),{'val':_0x3d9e2f,'ack':!![]});}async function saveFeedback(_0x191f40,_0x588240){const _0x191ad0=a0_0x3b7d7b;_0x191f40[_0x191ad0(0x2cf)][_0x191ad0(0x311)]('Feedback\x20saved:\x20'+JSON[_0x191ad0(0x28c)](_0x588240));}async function runBaselineDriftAnalysis(_0x20c11e){const _0x25b1d2=a0_0x3b7d7b;if(!_0x20c11e[_0x25b1d2(0x283)]||!_0x20c11e[_0x25b1d2(0x306)])return;const _0x555445=_0x20c11e['config']['ltmStbWindowDays']||0xe;if(_0x20c11e[_0x25b1d2(0x340)][_0x25b1d2(0x3cc)]<_0x555445+(_0x20c11e[_0x25b1d2(0x1d4)][_0x25b1d2(0x1ea)]||0x7)){await _0x20c11e[_0x25b1d2(0x2c5)](LTM_DP_DRIFT_STATUS,{'val':_0x25b1d2(0x205),'ack':!![]});return;}const _0x315ff6=_0x20c11e['dailyDigests'][_0x25b1d2(0x3b2)](-_0x555445),_0x5747a3=_0x20c11e['dailyDigests'][_0x25b1d2(0x3b2)](0x0,_0x20c11e[_0x25b1d2(0x340)]['length']-_0x555445),_0x452232=_0x25b1d2(0x2eb)+JSON['stringify'](_0x5747a3)+_0x25b1d2(0x2b4)+JSON['stringify'](_0x315ff6);try{const _0xe48226=await _0x20c11e['geminiModel'][_0x25b1d2(0x3f4)](_0x452232),_0x3d3790=JSON['parse'](_0xe48226[_0x25b1d2(0x1eb)]['text']()[_0x25b1d2(0x2f3)](/```json|```/g,'')[_0x25b1d2(0x26d)]());_0x3d3790['baselineDrift']&&(await _0x20c11e[_0x25b1d2(0x2c5)](LTM_DP_DRIFT_STATUS,{'val':_0x3d3790['baselineDrift'],'ack':!![]}),await _0x20c11e[_0x25b1d2(0x2c5)](LTM_DP_DRIFT_DETAILS,{'val':_0x3d3790[_0x25b1d2(0x307)],'ack':!![]}),await _0x20c11e[_0x25b1d2(0x2c5)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x25b1d2(0x3bc)](),'ack':!![]}));}catch(_0x2ba41d){}}function setupLtmScheduler(_0x51fd17){const _0x3c4c23=a0_0x3b7d7b;try{if(_0x51fd17[_0x3c4c23(0x3e1)])_0x51fd17['ltmJob'][_0x3c4c23(0x318)]();if(!_0x51fd17['isProVersion']){_0x51fd17[_0x3c4c23(0x2c5)](LTM_DP_STATUS,{'val':_0x3c4c23(0x33e),'ack':!![]});return;}_0x51fd17['ltmJob']=schedule[_0x3c4c23(0x2de)](LTM_SCHEDULE,()=>createDailyDigest(_0x51fd17));}catch(_0x34151c){_0x51fd17[_0x3c4c23(0x2cf)]['error'](_0x3c4c23(0x22d)+_0x34151c[_0x3c4c23(0x235)]);}}function setupModeResetScheduler(_0x58221a){const _0x5b075b=a0_0x3b7d7b;try{if(_0x58221a[_0x5b075b(0x2ab)])_0x58221a[_0x5b075b(0x2ab)]['cancel']();_0x58221a['modeResetJob']=schedule[_0x5b075b(0x2de)](MODE_RESET_SCHEDULE,async()=>{const _0xe159c9=_0x5b075b;await loadSystemMode(_0x58221a),AUTO_RESET_MODES[_0xe159c9(0x2a3)](_0x58221a[_0xe159c9(0x223)])&&await _0x58221a[_0xe159c9(0x2c5)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0xe159c9(0x3d4)],'ack':![]});});}catch(_0xd609b0){_0x58221a[_0x5b075b(0x2cf)][_0x5b075b(0x2f4)](_0x5b075b(0x353)+_0xd609b0[_0x5b075b(0x235)]);}}function setupDriftAnalysisScheduler(_0x34aa9b){const _0x52be33=a0_0x3b7d7b;try{if(_0x34aa9b[_0x52be33(0x37b)])clearInterval(_0x34aa9b['driftAnalysisTimer']);if(!_0x34aa9b[_0x52be33(0x283)])return;_0x34aa9b['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x34aa9b),(_0x34aa9b[_0x52be33(0x1d4)][_0x52be33(0x2f7)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x34aa9b),0x1388);}catch(_0x2c4f85){_0x34aa9b[_0x52be33(0x2cf)][_0x52be33(0x2f4)](_0x52be33(0x229)+_0x2c4f85[_0x52be33(0x235)]);}}function setupBriefingScheduler(_0x46e581){const _0x1a978c=a0_0x3b7d7b;try{if(_0x46e581['briefingJob'])_0x46e581[_0x1a978c(0x395)][_0x1a978c(0x318)]();if(!_0x46e581[_0x1a978c(0x1d4)][_0x1a978c(0x325)])return;const _0x589d6b=(_0x46e581['config']['briefingTime']||'08:00')[_0x1a978c(0x34c)](':'),_0x543a24=parseInt(_0x589d6b[0x0])||0x8,_0x2a3539=parseInt(_0x589d6b[0x1])||0x0,_0x3c583=_0x2a3539+'\x20'+_0x543a24+_0x1a978c(0x3b1);_0x46e581[_0x1a978c(0x2cf)][_0x1a978c(0x311)](_0x1a978c(0x331)+_0x543a24+':'+(_0x2a3539<0xa?'0'+_0x2a3539:_0x2a3539)),_0x46e581['briefingJob']=schedule['scheduleJob'](_0x3c583,()=>{sendMorningBriefing(_0x46e581);});}catch(_0x5017cf){_0x46e581['log'][_0x1a978c(0x2f4)](_0x1a978c(0x2a9)+_0x5017cf[_0x1a978c(0x235)]);}}async function sendNotification(_0x1be272,_0x3ac559,_0xcd8476=![],_0x925586=![]){const _0x400922=a0_0x3b7d7b;_0x1be272[_0x400922(0x2cf)]['info']((_0xcd8476?_0x400922(0x2f9):'')+_0x400922(0x1f1)+_0x3ac559+'\x22');const _0x220737=_0x1be272[_0x400922(0x1d4)];let _0x124969=0x0;if(_0x220737['notifyTelegramEnabled']){let _0x1ac2e5={};(_0x3ac559[_0x400922(0x2a3)](_0x400922(0x27e))||_0x925586)&&(_0x1ac2e5={'reply_markup':{'inline_keyboard':[[{'text':_0x400922(0x400),'callback_data':_0x400922(0x401)}],[{'text':_0x400922(0x2c2),'callback_data':_0x400922(0x266)}]]}}),await _0x1be272[_0x400922(0x31c)](_0x220737[_0x400922(0x292)],_0x400922(0x304),{'text':_0x3ac559,'user':_0x220737[_0x400922(0x2d1)],..._0x1ac2e5}),_0x124969++;}if(_0x220737[_0x400922(0x262)]){let _0x590968={'message':_0x3ac559,'title':_0x925586?'ðŸš¨\x20EMERGENCY':_0x400922(0x301),'priority':_0x925586?0x2:0x1,'device':_0x220737[_0x400922(0x3b4)]};_0x925586&&(_0x590968[_0x400922(0x2b2)]=0x1e,_0x590968[_0x400922(0x1fb)]=0xe10,_0x590968[_0x400922(0x36b)]=_0x400922(0x305)),await _0x1be272[_0x400922(0x31c)](_0x220737[_0x400922(0x3ec)],_0x400922(0x304),_0x590968),_0x124969++;}return _0x220737[_0x400922(0x2a8)]&&(await _0x1be272[_0x400922(0x31c)](_0x220737[_0x400922(0x270)],'send',{'text':_0x3ac559,'to':_0x220737[_0x400922(0x3ac)]}),_0x124969++),_0x124969;}async function setupTelegramListener(_0x4585b6){const _0x3e48e6=a0_0x3b7d7b,_0x33352e=_0x4585b6[_0x3e48e6(0x1d4)][_0x3e48e6(0x292)];_0x4585b6[_0x3e48e6(0x1d4)][_0x3e48e6(0x252)]&&_0x33352e&&(_0x4585b6[_0x3e48e6(0x2cf)][_0x3e48e6(0x311)]('ðŸ“¡\x20Hooking\x20into\x20'+_0x33352e+_0x3e48e6(0x310)),await _0x4585b6['subscribeForeignStatesAsync'](_0x33352e+_0x3e48e6(0x3df)));}async function handleTelegramResponse(_0x10dab0,_0x2a3573){const _0x4fe9db=a0_0x3b7d7b;let _0x3d2b7a=_0x2a3573;_0x2a3573[_0x4fe9db(0x25d)]('[')&&(_0x3d2b7a=_0x2a3573[_0x4fe9db(0x398)](_0x2a3573['indexOf'](']')+0x1));if(_0x3d2b7a===_0x4fe9db(0x401))_0x10dab0[_0x4fe9db(0x2cf)]['info'](_0x4fe9db(0x2e0)),await _0x10dab0[_0x4fe9db(0x2c5)](_0x4fe9db(0x1c4),{'val':![],'ack':!![]}),await _0x10dab0['setStateAsync'](_0x4fe9db(0x293),{'val':_0x4fe9db(0x280),'ack':!![]}),_0x10dab0['lastAlertState']=![],sendNotification(_0x10dab0,_0x4fe9db(0x21d),![]);else _0x3d2b7a==='COGNI_REQUEST_CALL'&&(_0x10dab0[_0x4fe9db(0x2cf)]['warn']('ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x10dab0,_0x4fe9db(0x375),![],!![]));}function a0_0x27c3(_0x242c3b,_0xbc728a){const _0x385b76=a0_0x35a8();return a0_0x27c3=function(_0x56c3ab,_0x1998e6){_0x56c3ab=_0x56c3ab-0x1c4;let _0x35a8eb=_0x385b76[_0x56c3ab];return _0x35a8eb;},a0_0x27c3(_0x242c3b,_0xbc728a);}async function runAutopilot(_0x4933d6){const _0x4d3e18=a0_0x3b7d7b,_0x464029=_0x4933d6[_0x4d3e18(0x1d4)][_0x4d3e18(0x222)],_0x12af73=_0x4933d6[_0x4d3e18(0x3d8)][_0x4d3e18(0x3cc)]>0x0?_0x4933d6[_0x4d3e18(0x3d8)][0x0][_0x4d3e18(0x382)]:Date[_0x4d3e18(0x3bc)](),_0x3e4778=(Date['now']()-_0x12af73)/(0x3e8*0x3c*0x3c);let _0x5b7164='';_0x4933d6[_0x4d3e18(0x1d4)]['inactivityMonitoringEnabled']&&_0x4933d6[_0x4d3e18(0x223)]===SYSTEM_MODES[_0x4d3e18(0x3d4)]&&_0x4933d6['isPresent']&&(_0x3e4778>_0x464029&&(_0x5b7164=_0x4d3e18(0x37a)+_0x3e4778[_0x4d3e18(0x3dd)](0x1)+_0x4d3e18(0x2a4))),runGeminiAnalysis(_0x4933d6,_0x5b7164)[_0x4d3e18(0x34e)](_0x380fcd=>_0x4933d6[_0x4d3e18(0x2cf)][_0x4d3e18(0x2f4)](_0x380fcd));}async function createDailyDigest(_0x3820ad){const _0x2e6727=a0_0x3b7d7b;if(!_0x3820ad[_0x2e6727(0x283)])return;await _0x3820ad['setStateAsync'](LTM_DP_STATUS,{'val':'Started\x20at\x20'+new Date()['toLocaleString'](),'ack':!![]});if(!_0x3820ad[_0x2e6727(0x306)]||_0x3820ad[_0x2e6727(0x302)][_0x2e6727(0x3cc)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3820ad['setStateAsync'](LTM_DP_STATUS,{'val':_0x2e6727(0x28e),'ack':!![]});return;}const _0x46a3d0=JSON['parse'](JSON['stringify'](_0x3820ad[_0x2e6727(0x302)])),_0x2e6864=_0x46a3d0[_0x2e6727(0x3cc)],_0x1f9d78=_0x2e6727(0x3ce)+JSON['stringify'](_0x46a3d0);try{const _0x32ca80=await _0x3820ad[_0x2e6727(0x306)]['generateContent'](_0x1f9d78),_0x367351=JSON['parse'](_0x32ca80[_0x2e6727(0x1eb)][_0x2e6727(0x20c)]()[_0x2e6727(0x2f3)](/```json|```/g,'')[_0x2e6727(0x26d)]());if(_0x367351['summary']){const _0x442739={'timestamp':new Date()[_0x2e6727(0x26e)](),'eventCount':_0x2e6864,'summary':_0x367351['summary'],'activityLevel':_0x367351[_0x2e6727(0x2c7)],'systemMode':_0x3820ad[_0x2e6727(0x223)]};_0x3820ad[_0x2e6727(0x340)][_0x2e6727(0x1cc)](_0x442739),await saveDailyDigests(_0x3820ad),_0x3820ad[_0x2e6727(0x302)]=[],await saveRawEventLog(_0x3820ad),await _0x3820ad['setStateAsync'](LTM_DP_STATUS,{'val':_0x2e6727(0x3b5)+_0x2e6864+'\x20events','ack':!![]}),_0x3820ad['isProVersion']&&(_0x3820ad[_0x2e6727(0x2cf)][_0x2e6727(0x311)]('ðŸ©º\x20Triggering\x20Health\x20Analysis\x20on\x20new\x20Digest...'),sendToPython(_0x3820ad,_0x2e6727(0x3ab),{'digest':_0x442739}));}}catch(_0x1b4246){await _0x3820ad[_0x2e6727(0x2c5)](LTM_DP_STATUS,{'val':'Error:\x20'+_0x1b4246[_0x2e6727(0x235)],'ack':!![]});}}async function sendMorningBriefing(_0x563281){const _0x5d8407=a0_0x3b7d7b;if(!_0x563281[_0x5d8407(0x306)])return;_0x563281[_0x5d8407(0x2cf)][_0x5d8407(0x311)](_0x5d8407(0x350));const _0x30f2da=_0x563281[_0x5d8407(0x340)][_0x5d8407(0x3cc)]>0x0?_0x563281['dailyDigests'][_0x563281[_0x5d8407(0x340)]['length']-0x1]:null,_0x329bb4=_0x30f2da&&_0x30f2da[_0x5d8407(0x39b)]?_0x30f2da[_0x5d8407(0x39b)][_0x5d8407(0x399)]:_0x5d8407(0x244),_0x4f4487=new Date();_0x4f4487[_0x5d8407(0x3d0)](0x4,0x0,0x0,0x0);const _0x1b7977=_0x563281['eventHistory'][_0x5d8407(0x221)](_0x47d9d4=>new Date(_0x47d9d4[_0x5d8407(0x382)])>_0x4f4487),_0x1cc9df=PERSONA_MAPPING[_0x563281['config'][_0x5d8407(0x1ce)]||_0x5d8407(0x26b)],_0x49fec8=_0x563281[_0x5d8407(0x1d4)][_0x5d8407(0x3bb)]||'',_0x5730cb=await getWeatherContext(_0x563281),_0x589852=await getCalendarContext(_0x563281),_0x4b51d2=_0x5d8407(0x3cf)+_0x1cc9df+_0x5d8407(0x1c6)+_0x49fec8+_0x5d8407(0x2d6)+_0x5730cb+'\x20'+_0x589852+_0x5d8407(0x3ee)+_0x329bb4+_0x5d8407(0x37f)+JSON[_0x5d8407(0x28c)](_0x1b7977['slice'](0x0,0xa))+_0x5d8407(0x203);try{const _0x440092=await _0x563281[_0x5d8407(0x306)][_0x5d8407(0x3f4)](_0x4b51d2),_0x3fe876='ðŸŒ…\x20Daily\x20Briefing:\x0a'+_0x440092['response'][_0x5d8407(0x20c)]()[_0x5d8407(0x26d)]();sendNotification(_0x563281,_0x3fe876),_0x563281[_0x5d8407(0x2cf)][_0x5d8407(0x311)](_0x5d8407(0x287));}catch(_0x375ffd){_0x563281['log'][_0x5d8407(0x2f4)]('Briefing\x20Error:\x20'+_0x375ffd['message']);}}async function scanForDevices(_0x2e9bbd,_0x2ea14d){const _0x1e4171=a0_0x3b7d7b;_0x2e9bbd[_0x1e4171(0x2cf)]['info']('Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...');const _0x1f32ae=[],_0x242606=await _0x2e9bbd['getForeignObjectsAsync']('*'),_0x35af95=await _0x2e9bbd['getForeignObjectsAsync'](_0x1e4171(0x3f3),_0x1e4171(0x3eb)),_0x496144=await _0x2e9bbd[_0x1e4171(0x38a)](_0x1e4171(0x389),_0x1e4171(0x3eb)),_0x477b75={};if(_0x35af95)for(const _0x37633e in _0x35af95){const _0x2aa7ab=_0x35af95[_0x37633e][_0x1e4171(0x309)]['members']||[];_0x2aa7ab[_0x1e4171(0x32f)](_0x2276ce=>{if(!_0x477b75[_0x2276ce])_0x477b75[_0x2276ce]=[];_0x477b75[_0x2276ce]['push'](_0x37633e);});}const _0x418581={};if(_0x496144)for(const _0x3973fe in _0x496144){const _0x437634=_0x496144[_0x3973fe][_0x1e4171(0x309)]['members']||[],_0x1821cf=typeof _0x496144[_0x3973fe][_0x1e4171(0x309)][_0x1e4171(0x315)]===_0x1e4171(0x2d5)?_0x496144[_0x3973fe][_0x1e4171(0x309)][_0x1e4171(0x315)]['de']:_0x496144[_0x3973fe][_0x1e4171(0x309)]['name'];_0x437634[_0x1e4171(0x32f)](_0x476a0c=>_0x418581[_0x476a0c]=_0x1821cf);}const _0x97cea=_0x2ea14d[_0x1e4171(0x261)]||[],_0x322bc2=_0x2ea14d[_0x1e4171(0x3ed)]!==![],_0x2cf31f=_0x2ea14d['doors']!==![],_0x578ed5=_0x2ea14d[_0x1e4171(0x3a4)]!==![],_0x3d2252=_0x2ea14d[_0x1e4171(0x29f)]===!![],_0x286ad5=_0x2ea14d[_0x1e4171(0x348)]===!![];for(const _0x1d582f in _0x242606){const _0x4c90d7=_0x242606[_0x1d582f];if(_0x4c90d7[_0x1e4171(0x297)]!==_0x1e4171(0x368)||!_0x4c90d7[_0x1e4171(0x309)])continue;if(ADAPTER_BLACKLIST[_0x1e4171(0x2dd)](_0x260d4d=>_0x1d582f['startsWith'](_0x260d4d))&&!_0x286ad5)continue;const _0x43211d=(_0x4c90d7[_0x1e4171(0x309)][_0x1e4171(0x351)]||'')['toLowerCase']();let _0x2cbb7c=(typeof _0x4c90d7['common'][_0x1e4171(0x315)]===_0x1e4171(0x2d5)?_0x4c90d7[_0x1e4171(0x309)][_0x1e4171(0x315)]['de']:_0x4c90d7[_0x1e4171(0x309)][_0x1e4171(0x315)])||_0x1d582f;const _0x313510=_0x2cbb7c['toLowerCase']();let _0x24235e=![],_0x3e5eaa=![];if(_0x97cea['length']>0x0){const _0x4f3f46=_0x477b75[_0x1d582f]||[],_0x1730ed=_0x1d582f[_0x1e4171(0x34c)]('.')['slice'](0x0,-0x1)['join']('.'),_0x5137f3=_0x477b75[_0x1730ed]||[];(_0x4f3f46[_0x1e4171(0x2dd)](_0x569b05=>_0x97cea[_0x1e4171(0x2a3)](_0x569b05))||_0x5137f3[_0x1e4171(0x2dd)](_0x5f5495=>_0x97cea['includes'](_0x5f5495)))&&(_0x24235e=!![],_0x3e5eaa=!![]);}if(!_0x24235e&&!_0x286ad5){if(HARD_IGNORE_TERMS[_0x1e4171(0x2dd)](_0x36d8b6=>_0x1d582f[_0x1e4171(0x2a3)](_0x36d8b6)||_0x313510[_0x1e4171(0x2a3)](_0x36d8b6[_0x1e4171(0x22e)]())))continue;}if(BAD_NAMES[_0x1e4171(0x2dd)](_0x9bf7c8=>_0x313510===_0x9bf7c8||_0x313510[_0x1e4171(0x215)]('.'+_0x9bf7c8))){const _0x3cd464=_0x1d582f[_0x1e4171(0x34c)]('.');if(_0x3cd464[_0x1e4171(0x3cc)]>0x2){const _0x2ad47a=_0x3cd464[_0x1e4171(0x3b2)](0x0,-0x1)[_0x1e4171(0x263)]('.'),_0x9e66c5=_0x242606[_0x2ad47a];if(_0x9e66c5&&_0x9e66c5['common']&&_0x9e66c5[_0x1e4171(0x309)][_0x1e4171(0x315)]){const _0x23ec58=typeof _0x9e66c5[_0x1e4171(0x309)][_0x1e4171(0x315)]===_0x1e4171(0x2d5)?_0x9e66c5[_0x1e4171(0x309)][_0x1e4171(0x315)]['de']:_0x9e66c5[_0x1e4171(0x309)][_0x1e4171(0x315)];_0x23ec58&&!_0x2cbb7c[_0x1e4171(0x2a3)](_0x23ec58)&&(_0x2cbb7c=_0x23ec58+'\x20'+_0x2cbb7c);}}}let _0x578371='';if(_0x322bc2&&(_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x3ed))||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x1ca))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x3b0))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x264))))_0x578371=_0x1e4171(0x3ed);else{if(!_0x578371&&_0x2cf31f&&(_0x43211d['includes']('door')||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x345))||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x1e6))||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x1dd))||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x407))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x289))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x364))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x3f5))))_0x578371='door';else{if(!_0x578371&&_0x578ed5&&(_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x247))||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x30c))||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x2ea))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x2e4))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x213))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x1ee)))){if(_0x4c90d7[_0x1e4171(0x309)][_0x1e4171(0x218)]||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x3c2)))_0x578371=_0x1e4171(0x247);}else{if(!_0x578371&&_0x3d2252&&(_0x43211d[_0x1e4171(0x2a3)]('temperature')||_0x43211d[_0x1e4171(0x2a3)]('humidity')||_0x43211d[_0x1e4171(0x2a3)](_0x1e4171(0x20e))||_0x313510[_0x1e4171(0x2a3)]('temp')||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x386))||_0x313510[_0x1e4171(0x2a3)](_0x1e4171(0x2bf))))_0x578371=_0x1e4171(0x29f);else{if(!_0x578371&&_0x3e5eaa)_0x578371='custom';}}}}if(_0x578371){let _0x3597c9=_0x418581[_0x1d582f]||'';if(!_0x3597c9){let _0x380908=_0x1d582f;for(let _0x393ad2=0x0;_0x393ad2<0x3;_0x393ad2++){const _0x338fba=_0x380908[_0x1e4171(0x206)]('.');if(_0x338fba===-0x1)break;_0x380908=_0x380908[_0x1e4171(0x398)](0x0,_0x338fba);if(_0x418581[_0x380908]){_0x3597c9=_0x418581[_0x380908];break;}}}_0x1f32ae['push']({'id':_0x1d582f,'name':_0x2cbb7c,'location':_0x3597c9,'type':_0x578371,'logDuplicates':_0x578371===_0x1e4171(0x3ed),'isExit':![],'_score':_0x3597c9?0x50:_0x578371===_0x1e4171(0x25a)?0x5a:0x28});}}return _0x1f32ae['sort']((_0x50cf37,_0x85cfe9)=>_0x85cfe9[_0x1e4171(0x272)]-_0x50cf37[_0x1e4171(0x272)]),_0x1f32ae;}async function executeAutomationAction(_0x386fba){const _0x3781ec=a0_0x3b7d7b;try{const _0x469345=await _0x386fba['getStateAsync']('analysis.automation.targetId'),_0x3c2b78=await _0x386fba[_0x3781ec(0x357)]('analysis.automation.targetValue');if(_0x469345&&_0x469345[_0x3781ec(0x28a)]&&_0x3c2b78){const _0x1eb789=_0x469345[_0x3781ec(0x28a)];let _0x1fd2e2=_0x3c2b78[_0x3781ec(0x28a)];try{_0x1fd2e2=JSON['parse'](_0x1fd2e2);}catch(_0x1a1900){}_0x386fba['log'][_0x3781ec(0x311)](_0x3781ec(0x3a0)+_0x1eb789+_0x3781ec(0x3a8)+_0x1fd2e2),await _0x386fba[_0x3781ec(0x300)](_0x1eb789,_0x1fd2e2);}else _0x386fba[_0x3781ec(0x2cf)]['warn']('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x4e8e45){_0x386fba[_0x3781ec(0x2cf)][_0x3781ec(0x2f4)]('BUTLER\x20Execution\x20Error:\x20'+_0x4e8e45['message']);}}function tryParse(_0x39f5de){const _0x586c16=a0_0x3b7d7b;try{return JSON[_0x586c16(0x2e6)](_0x39f5de);}catch(_0xc225ed){return null;}}async function recordSequence(_0x59a880,_0x29bd1e){const _0x2a89e2=a0_0x3b7d7b,_0x3d7993=(_0x29bd1e[_0x2a89e2(0x297)]||'')[_0x2a89e2(0x22e)](),_0x46a155=[_0x2a89e2(0x3ed),'bewegung','prÃ¤senz',_0x2a89e2(0x3a9),_0x2a89e2(0x1ca),_0x2a89e2(0x20d),'tÃ¼r','window',_0x2a89e2(0x289),'contact',_0x2a89e2(0x281),_0x2a89e2(0x247),_0x2a89e2(0x2e4),_0x2a89e2(0x30c),_0x2a89e2(0x1ee),'dimmer',_0x2a89e2(0x213)];if(!_0x46a155[_0x2a89e2(0x2dd)](_0x5223e9=>_0x3d7993[_0x2a89e2(0x2a3)](_0x5223e9))){_0x59a880[_0x2a89e2(0x2cf)][_0x2a89e2(0x36e)](_0x2a89e2(0x373)+_0x29bd1e['id']+_0x2a89e2(0x1ff)+_0x29bd1e[_0x2a89e2(0x297)]+_0x2a89e2(0x2d0));return;}if(!_0x29bd1e['value']){_0x59a880[_0x2a89e2(0x2cf)][_0x2a89e2(0x36e)](_0x2a89e2(0x373)+_0x29bd1e['id']+_0x2a89e2(0x341)+_0x29bd1e['value']+')');return;}_0x59a880[_0x2a89e2(0x2cf)][_0x2a89e2(0x36e)](_0x2a89e2(0x246)+_0x29bd1e['id']+'\x20('+_0x29bd1e['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x57be8b={'loc':_0x29bd1e[_0x2a89e2(0x1f5)]||_0x2a89e2(0x22b),'id':_0x29bd1e['id'],'ts':Date[_0x2a89e2(0x3bc)]()};activeSequence[_0x2a89e2(0x1cc)](_0x57be8b),_0x59a880['log'][_0x2a89e2(0x36e)](_0x2a89e2(0x1d3)+_0x57be8b[_0x2a89e2(0x313)]+'\x20(Length:\x20'+activeSequence['length']+')'),sequenceTimer=setTimeout(async()=>{const _0x3b4e1f=_0x2a89e2;activeSequence[_0x3b4e1f(0x3cc)]>0x1?await saveCompletedSequence(_0x59a880):(_0x59a880[_0x3b4e1f(0x2cf)][_0x3b4e1f(0x36e)](_0x3b4e1f(0x3d9)+activeSequence[_0x3b4e1f(0x3cc)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x30019e){const _0x1da02f=a0_0x3b7d7b;try{_0x30019e['log'][_0x1da02f(0x311)](_0x1da02f(0x2d8)+activeSequence[_0x1da02f(0x3cc)]+').\x20Saving\x20to\x20Training\x20Data.');const _0x1e5059=await _0x30019e[_0x1da02f(0x357)](_0x1da02f(0x378));let _0x3d719d=[];if(_0x1e5059&&_0x1e5059[_0x1da02f(0x28a)])try{_0x3d719d=JSON[_0x1da02f(0x2e6)](_0x1e5059[_0x1da02f(0x28a)]);}catch(_0x155a03){}const _0x43499d=activeSequence[0x0]['ts'],_0x6590bd=activeSequence[_0x1da02f(0x24a)](_0x51f7d8=>({'loc':_0x51f7d8[_0x1da02f(0x313)],'t_delta':Math[_0x1da02f(0x3d3)]((_0x51f7d8['ts']-_0x43499d)/0x3e8)})),_0x4a648e={'timestamp':new Date(_0x43499d)[_0x1da02f(0x26e)](),'steps':_0x6590bd,'duration':Math[_0x1da02f(0x3d3)]((activeSequence[activeSequence[_0x1da02f(0x3cc)]-0x1]['ts']-_0x43499d)/0x3e8),'daytime':new Date(_0x43499d)['getHours']()};_0x3d719d[_0x1da02f(0x1cc)](_0x4a648e),_0x3d719d[_0x1da02f(0x3cc)]>MAX_TRAINING_SET_SIZE&&_0x3d719d[_0x1da02f(0x1fd)](),await _0x30019e['setStateAsync'](_0x1da02f(0x378),{'val':JSON[_0x1da02f(0x28c)](_0x3d719d),'ack':!![]}),runSecurityCheck(_0x30019e,_0x4a648e),activeSequence=[],sequenceTimer=null;}catch(_0x4a9bea){_0x30019e[_0x1da02f(0x2cf)][_0x1da02f(0x2f4)](_0x1da02f(0x349)+_0x4a9bea[_0x1da02f(0x235)]);}}function runSecurityCheck(_0x44f747,_0x3ced9a){const _0x106bd1=a0_0x3b7d7b;if(!_0x44f747['isProVersion'])return;_0x44f747[_0x106bd1(0x2cf)][_0x106bd1(0x36e)](_0x106bd1(0x1ec)),sendToPython(_0x44f747,_0x106bd1(0x3da),{'sequence':_0x3ced9a});}async function getOutsideTemperatureNumeric(_0x26354e){const _0x1812a5=a0_0x3b7d7b;if(_0x26354e[_0x1812a5(0x1d4)][_0x1812a5(0x209)])try{const _0x10d365=await _0x26354e[_0x1812a5(0x342)](_0x26354e[_0x1812a5(0x1d4)][_0x1812a5(0x209)]);if(_0x10d365&&_0x10d365[_0x1812a5(0x28a)]!==undefined&&_0x10d365['val']!==null){const _0x4567ec=parseFloat(_0x10d365[_0x1812a5(0x28a)]);if(!isNaN(_0x4567ec))return _0x4567ec;}}catch(_0x4fa5c8){_0x26354e['log'][_0x1812a5(0x38b)](_0x1812a5(0x2c8)+_0x26354e['config'][_0x1812a5(0x209)]+':\x20'+_0x4fa5c8[_0x1812a5(0x235)]);}const _0x558bc5=_0x26354e[_0x1812a5(0x1d4)]['weatherInstance'];if(!_0x26354e['config'][_0x1812a5(0x2d4)]||!_0x558bc5)return null;try{let _0x2da581='';if(_0x558bc5['includes']('accuweather'))_0x2da581=_0x558bc5+_0x1812a5(0x38e);else{if(_0x558bc5[_0x1812a5(0x2a3)]('daswetter'))_0x2da581=_0x558bc5+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x558bc5[_0x1812a5(0x2a3)](_0x1812a5(0x3c8)))_0x2da581=_0x558bc5+_0x1812a5(0x2ca);else{if(_0x558bc5['includes'](_0x1812a5(0x1e3)))_0x2da581=_0x558bc5+_0x1812a5(0x21c);}}}if(_0x2da581){const _0x171a75=await _0x26354e['getForeignStateAsync'](_0x2da581);if(_0x171a75&&_0x171a75[_0x1812a5(0x28a)]!==undefined&&_0x171a75[_0x1812a5(0x28a)]!==null)return parseFloat(_0x171a75[_0x1812a5(0x28a)]);}}catch(_0x40c08a){}return null;}async function recordThermodynamics(_0x47384e,_0x5066e4,_0x173547,_0x1c7399){const _0x2eaf9a=a0_0x3b7d7b,_0x5d4d24=await getOutsideTemperatureNumeric(_0x47384e),_0x3f89a5=await _0x47384e[_0x2eaf9a(0x357)]('LTM.trainingData.thermodynamics');let _0x44b719=[];if(_0x3f89a5&&_0x3f89a5[_0x2eaf9a(0x28a)])try{_0x44b719=JSON[_0x2eaf9a(0x2e6)](_0x3f89a5[_0x2eaf9a(0x28a)]);}catch(_0x5ce350){}_0x44b719[_0x2eaf9a(0x1cc)]({'ts':Date[_0x2eaf9a(0x3bc)](),'room':_0x1c7399||_0x2eaf9a(0x22b),'t_in':_0x173547,'t_out':_0x5d4d24});if(_0x44b719[_0x2eaf9a(0x3cc)]>THERMO_LOG_SIZE)_0x44b719[_0x2eaf9a(0x1fd)]();await _0x47384e[_0x2eaf9a(0x2c5)](_0x2eaf9a(0x30f),{'val':JSON[_0x2eaf9a(0x28c)](_0x44b719),'ack':!![]});}async function processSensorEvent(_0x5dea35,_0x46e8b7,_0x1be4a5,_0x55ffd6){const _0x3b3950=a0_0x3b7d7b;if(!_0x55ffd6)return;const _0x28a7df=_0x1be4a5[_0x3b3950(0x28a)],_0x4fc704=Date[_0x3b3950(0x3bc)]();_0x5dea35[_0x3b3950(0x2cf)][_0x3b3950(0x36e)]('Event\x20received:\x20'+_0x46e8b7+_0x3b3950(0x3a8)+_0x28a7df);const _0x4fe6c3=_0x5dea35[_0x3b3950(0x379)][_0x46e8b7];_0x5dea35[_0x3b3950(0x379)][_0x46e8b7]=_0x28a7df;if(!_0x55ffd6[_0x3b3950(0x29a)]&&_0x4fe6c3!=undefined&&_0x4fe6c3==_0x28a7df){_0x5dea35[_0x3b3950(0x2cf)]['debug'](_0x3b3950(0x337)+_0x55ffd6[_0x3b3950(0x315)]+_0x3b3950(0x286)+_0x28a7df+')');return;}const _0x416297=(_0x55ffd6[_0x3b3950(0x297)]||'')[_0x3b3950(0x22e)](),_0x2999d1=_0x416297[_0x3b3950(0x2a3)](_0x3b3950(0x29f))||_0x416297[_0x3b3950(0x2a3)]('temperatur')||_0x416297[_0x3b3950(0x2a3)](_0x3b3950(0x386))||_0x416297[_0x3b3950(0x2a3)]('heizung');_0x5dea35['isProVersion']&&_0x2999d1&&recordThermodynamics(_0x5dea35,_0x46e8b7,_0x28a7df,_0x55ffd6[_0x3b3950(0x1f5)]);const _0x3821c5={'timestamp':_0x4fc704,'id':_0x46e8b7,'name':_0x55ffd6['name'],'type':_0x55ffd6[_0x3b3950(0x297)],'location':_0x55ffd6['location'],'value':_0x28a7df};_0x5dea35[_0x3b3950(0x3d8)][_0x3b3950(0x356)](_0x3821c5);if(_0x5dea35[_0x3b3950(0x3d8)][_0x3b3950(0x3cc)]>HISTORY_MAX_SIZE)_0x5dea35[_0x3b3950(0x3d8)][_0x3b3950(0x3a6)]();await _0x5dea35[_0x3b3950(0x2c5)]('events.lastEvent',{'val':JSON['stringify'](_0x3821c5),'ack':!![]}),await _0x5dea35[_0x3b3950(0x2c5)](_0x3b3950(0x406),{'val':JSON[_0x3b3950(0x28c)](_0x5dea35['eventHistory']),'ack':!![]});_0x5dea35[_0x3b3950(0x283)]&&(_0x5dea35['rawEventLog']['push'](_0x3821c5),await saveRawEventLog(_0x5dea35),recordSequence(_0x5dea35,_0x3821c5));if(_0x55ffd6[_0x3b3950(0x3ef)]&&_0x28a7df===!![]){if(_0x5dea35['isPresent']&&!_0x5dea35['isGracePeriodActive'])_0x5dea35[_0x3b3950(0x2cf)]['info'](_0x3b3950(0x334)+_0x55ffd6[_0x3b3950(0x315)]+').\x20Starting\x20Timer.'),startExitTimer(_0x5dea35);else!_0x5dea35['isPresent']&&(_0x5dea35[_0x3b3950(0x2cf)][_0x3b3950(0x311)](_0x3b3950(0x2a0)+_0x55ffd6[_0x3b3950(0x315)]+_0x3b3950(0x220)),await setPresence(_0x5dea35,!![]));}else _0x55ffd6[_0x3b3950(0x297)]==='motion'&&_0x28a7df===!![]&&(_0x5dea35[_0x3b3950(0x237)]&&(_0x5dea35['log']['info']('Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.'),abortExitTimer(_0x5dea35)),!_0x5dea35[_0x3b3950(0x25c)]&&_0x5dea35[_0x3b3950(0x223)]===SYSTEM_MODES[_0x3b3950(0x3d4)]&&await setPresence(_0x5dea35,!![]));}async function runGeminiAnalysis(_0x3e7a53,_0x55b3ac=''){const _0x23f6a8=a0_0x3b7d7b;if(!_0x3e7a53[_0x23f6a8(0x306)])return;if(_0x3e7a53[_0x23f6a8(0x3d8)][_0x23f6a8(0x3cc)]===0x0)return;const _0x15d712=_0x3e7a53['eventHistory'][_0x23f6a8(0x3b2)](0x0,0xf),_0x51a445=await getWeatherContext(_0x3e7a53),_0x4a1a4a=_0x3e7a53['currentSystemMode'],_0x2d79c0=PERSONA_MAPPING[_0x3e7a53[_0x23f6a8(0x1d4)][_0x23f6a8(0x1ce)]||_0x23f6a8(0x26b)],_0x22ca58=_0x3e7a53[_0x23f6a8(0x1d4)][_0x23f6a8(0x3bb)]||'Keine\x20Details.';let _0x38562e=_0x23f6a8(0x2be);try{const _0x2b4fc2=await _0x3e7a53[_0x23f6a8(0x357)]('system.presenceWho');if(_0x2b4fc2&&_0x2b4fc2[_0x23f6a8(0x28a)])_0x38562e=_0x2b4fc2[_0x23f6a8(0x28a)];}catch(_0x3785fa){}let _0x1cd0c3=![];try{const _0x1357e3=await _0x3e7a53['getStateAsync'](_0x23f6a8(0x376));if(_0x1357e3&&_0x1357e3[_0x23f6a8(0x28a)])_0x1cd0c3=!![];}catch(_0x135e05){}const _0x5b62a5=_0x23f6a8(0x2af)+_0x2d79c0+_0x23f6a8(0x336)+_0x22ca58+_0x23f6a8(0x374)+_0x4a1a4a+_0x23f6a8(0x268)+_0x51a445+'.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20'+(_0x55b3ac||'Keiner')+_0x23f6a8(0x32b)+(_0x3e7a53[_0x23f6a8(0x25c)]?_0x23f6a8(0x1dc):_0x23f6a8(0x2ac))+_0x23f6a8(0x332)+_0x38562e+_0x23f6a8(0x3e4)+JSON[_0x23f6a8(0x28c)](_0x15d712)+_0x23f6a8(0x35f);try{const _0x5cc7d0=await _0x3e7a53[_0x23f6a8(0x306)]['generateContent'](_0x5b62a5),_0x2ad2a0=_0x5cc7d0[_0x23f6a8(0x1eb)]['text']()[_0x23f6a8(0x2f3)](/```json|```/g,'')['trim'](),_0x5ca795=JSON[_0x23f6a8(0x2e6)](_0x2ad2a0);await _0x3e7a53['setStateAsync'](_0x23f6a8(0x226),{'val':JSON[_0x23f6a8(0x28c)](_0x5ca795),'ack':!![]});_0x5ca795['summary']&&await _0x3e7a53[_0x23f6a8(0x2c5)](_0x23f6a8(0x25b),{'val':_0x5ca795['summary'],'ack':!![]});const _0x3102f0={'timestamp':Date[_0x23f6a8(0x3bc)](),'id':Date[_0x23f6a8(0x3bc)]()[_0x23f6a8(0x233)](),'analysis':{'activity':{'summary':_0x5ca795['summary']||_0x23f6a8(0x33c),'isAlert':_0x5ca795[_0x23f6a8(0x26c)]||![],'alertReason':_0x5ca795[_0x23f6a8(0x1e1)]},'comfort':{'automationProposal':_0x5ca795[_0x23f6a8(0x1f6)]}}};await updateAnalysisHistory(_0x3e7a53,_0x3102f0);const _0x39908f=_0x5ca795[_0x23f6a8(0x26c)]||![];_0x39908f!==_0x3e7a53['lastAlertState']&&(await _0x3e7a53[_0x23f6a8(0x2c5)]('analysis.isAlert',{'val':_0x39908f,'ack':!![]}),_0x3e7a53[_0x23f6a8(0x290)]=_0x39908f,_0x39908f&&(await _0x3e7a53['setStateAsync'](_0x23f6a8(0x293),{'val':_0x5ca795[_0x23f6a8(0x1e1)],'ack':!![]}),sendNotification(_0x3e7a53,_0x23f6a8(0x2ad)+_0x5ca795[_0x23f6a8(0x1e1)],![],_0x5ca795[_0x23f6a8(0x312)]))),_0x5ca795[_0x23f6a8(0x1f6)]&&_0x5ca795[_0x23f6a8(0x1f6)][_0x23f6a8(0x231)]&&_0x5ca795[_0x23f6a8(0x1f6)][_0x23f6a8(0x3f2)]&&(_0x3e7a53['log'][_0x23f6a8(0x311)](_0x23f6a8(0x34a)+_0x5ca795[_0x23f6a8(0x1f6)][_0x23f6a8(0x22c)]),await _0x3e7a53[_0x23f6a8(0x2c5)](_0x23f6a8(0x3de),{'val':!![],'ack':!![]}),await _0x3e7a53[_0x23f6a8(0x2c5)](_0x23f6a8(0x32c),{'val':_0x5ca795[_0x23f6a8(0x1f6)][_0x23f6a8(0x22c)],'ack':!![]}),await _0x3e7a53[_0x23f6a8(0x2c5)](_0x23f6a8(0x27c),{'val':_0x5ca795['automationProposal']['targetId'],'ack':!![]}),await _0x3e7a53[_0x23f6a8(0x2c5)]('analysis.automation.targetValue',{'val':JSON['stringify'](_0x5ca795['automationProposal'][_0x23f6a8(0x3f8)]),'ack':!![]}),_0x1cd0c3&&(_0x3e7a53[_0x23f6a8(0x2cf)][_0x23f6a8(0x311)](_0x23f6a8(0x1e5)+_0x5ca795[_0x23f6a8(0x1f6)][_0x23f6a8(0x3f2)]+_0x23f6a8(0x3c5)),await executeAutomationAction(_0x3e7a53)));}catch(_0x399de5){_0x3e7a53[_0x23f6a8(0x2cf)][_0x23f6a8(0x2f4)]('Gemini\x20Analysis\x20Error:\x20'+_0x399de5[_0x23f6a8(0x235)]);}}function installPythonDependencies(_0x4bdda8){const _0x45dd9a=a0_0x3b7d7b;if(_0x4bdda8[_0x45dd9a(0x367)])return;_0x4bdda8['dependencyInstallInProgress']=!![];const _0x76c2fb=path[_0x45dd9a(0x263)](__dirname,_0x45dd9a(0x1fa),_0x45dd9a(0x2e9));_0x4bdda8[_0x45dd9a(0x2cf)][_0x45dd9a(0x311)](_0x45dd9a(0x27b)+_0x76c2fb+_0x45dd9a(0x3c5)),stopPythonService(_0x4bdda8);const _0x596335=_0x45dd9a(0x1f8)+_0x76c2fb+'\x22\x20--break-system-packages';exec(_0x596335,(_0x452aaa,_0x72b8df,_0x38ea44)=>{const _0x4f00c2=_0x45dd9a,_0x52e518=_0x38ea44&&_0x38ea44['includes'](_0x4f00c2(0x282))||_0x452aaa&&_0x452aaa['message'][_0x4f00c2(0x2a3)]('No\x20module\x20named\x20pip');if(_0x52e518){_0x4bdda8[_0x4f00c2(0x2cf)][_0x4f00c2(0x38b)](_0x4f00c2(0x3a7)),exec(_0x4f00c2(0x295),(_0x571fec,_0x289ee6,_0x4a04ea)=>{const _0x1a038a=_0x4f00c2;_0x571fec?(_0x4bdda8[_0x1a038a(0x2cf)]['error'](_0x1a038a(0x381)),_0x4bdda8[_0x1a038a(0x2cf)][_0x1a038a(0x2f4)]('Please\x20run\x20this\x20MANUALLY\x20in\x20the\x20console\x20(as\x20root/sudo):\x20apt\x20install\x20python3-pip'),_0x4bdda8[_0x1a038a(0x367)]=![]):(_0x4bdda8['log']['info'](_0x1a038a(0x393)),exec(_0x1a038a(0x1f8)+_0x76c2fb+_0x1a038a(0x396),(_0x3dffe1,_0x3f9ef6,_0x12b40c)=>{const _0x31a554=_0x1a038a;_0x3dffe1?_0x4bdda8['log']['error'](_0x31a554(0x1fc)+_0x3dffe1[_0x31a554(0x235)]):(_0x4bdda8['log'][_0x31a554(0x311)](_0x31a554(0x31f)),startPythonService(_0x4bdda8)),_0x4bdda8[_0x31a554(0x367)]=![];}));});return;}_0x4bdda8[_0x4f00c2(0x367)]=![],_0x452aaa?(_0x4bdda8[_0x4f00c2(0x2cf)][_0x4f00c2(0x2f4)](_0x4f00c2(0x31e)),_0x4bdda8[_0x4f00c2(0x2cf)][_0x4f00c2(0x2f4)](_0x4f00c2(0x1d8)+(_0x38ea44||_0x452aaa[_0x4f00c2(0x235)]))):(_0x4bdda8[_0x4f00c2(0x2cf)][_0x4f00c2(0x311)](_0x4f00c2(0x200)),startPythonService(_0x4bdda8));});}function sendToPython(_0x4a7dd8,_0x383629,_0x10c784={}){const _0x5bd9b8=a0_0x3b7d7b;if(!_0x4a7dd8[_0x5bd9b8(0x2f5)]||!_0x4a7dd8[_0x5bd9b8(0x2f5)]['stdin'][_0x5bd9b8(0x397)])return;const _0x590e90=JSON[_0x5bd9b8(0x28c)]({'command':_0x383629,..._0x10c784});try{_0x4a7dd8[_0x5bd9b8(0x2f5)]['stdin'][_0x5bd9b8(0x218)](_0x590e90+'\x0a');}catch(_0x40677d){_0x4a7dd8['log'][_0x5bd9b8(0x2f4)](_0x5bd9b8(0x1ed)+_0x40677d[_0x5bd9b8(0x235)]);}}function runPythonHealthCheck(_0x37286e){const _0x5e74d7=a0_0x3b7d7b;if(!_0x37286e[_0x5e74d7(0x340)]||_0x37286e['dailyDigests'][_0x5e74d7(0x3cc)]<0x2){_0x37286e[_0x5e74d7(0x2cf)][_0x5e74d7(0x311)](_0x5e74d7(0x251));return;}const _0x3e3fa6=_0x37286e[_0x5e74d7(0x340)]['map'](_0x20b6ba=>{const _0x5ce36c=_0x5e74d7,_0x3bd871=(_0x20b6ba['activityLevel']||'')[_0x5ce36c(0x22e)]();return ACTIVITY_LEVEL_MAP[_0x3bd871]||0x32;});_0x37286e[_0x5e74d7(0x2cf)][_0x5e74d7(0x311)](_0x5e74d7(0x3d6)+_0x3e3fa6[_0x5e74d7(0x3cc)]+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x37286e,_0x5e74d7(0x21f),{'values':_0x3e3fa6,'tag':_0x5e74d7(0x408)});}function a0_0x35a8(){const _0x7a728c=['driftDetails','calendarInstance','common','guest','\x20daily\x20digests...','switch','analysisTimer','System\x20Status\x20&\x20Control','LTM.trainingData.thermodynamics','\x20for\x20interactive\x20buttons...','info','isEmergency','loc','TEST-PRO-KEY','name','LTM.rawEventLog','openweathermap.0','cancel','ðŸ©º\x20Triggering\x20Health\x20Training\x20with\x20','system.presenceWho','indicator.health','sendToAsync','.Summary.Current','âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20check\x20permissions.','âœ…\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','subscribeStates','Kalender:\x20Deaktiviert','system.','4765304FgGEUf','status','briefingEnabled','weatherunderground.0','\x20sensors...','analysis.automation','\x20events)...','analysis.health.isAnomaly','.\x0a\x20\x20\x20\x20ANWESENHEITS_STATUS:\x20','analysis.automation.description','KALENDER:\x20','Last\x20Anomaly\x20Score','forEach','unload','Scheduling\x20Morning\x20Briefing\x20for\x20','.\x0a\x20\x20\x20\x20ANWESENDE_GERAETE:\x20','boolean','Exit\x20Sensor\x20triggered\x20(','SECURITY_RESULT','.\x0a\x20\x20\x20\x20KONTEXT:\x20','IGNORING\x20DUPLICATE\x20(Cached):\x20','analysisInterval','Gemini\x20AI\x20initialized.','Activity\x20Summary','triggerDailyDigest','Keine\x20Analyse.','unreach','Deaktiviert\x20(Pro-Feature)','40607xacxal','dailyDigests','\x20(Value\x20is\x20falsy:\x20','getForeignStateAsync','Failed:\x20','ltmStbWindowDays','window','TRAINING_COMPLETE','Verbindung\x20erfolgreich!\x20Antwort:\x20','weather','[RECORDER]\x20Error\x20saving\x20sequence:\x20','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','Say\x20Hello','split','@iobroker/adapter-core','catch','fill','Generating\x20Morning\x20Briefing...','role','150EInTGE','Reset\x20Sched\x20Error:\x20','instance','simulateButler','unshift','getStateAsync','command','from','config_pending','Gast','child_process','event','exitGraceTimer','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','GUEST','models/gemini-flash-latest','analysis.health.sleepScore','tÃ¼r','devices','power','dependencyInstallInProgress','state','Training\x20Error:\x20','setState','sound','No\x20module\x20named','sendTo','debug','Drift\x20Details','scriptProblem','accuweather','stick_unreach','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','analysis.automation.autoApply','testContext','LTM.trainingData.sequences','sensorLastValues','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','driftAnalysisTimer','analysis.training.status','onUnload','Fokus\x20auf\x20Familienroutinen.','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','number','âŒ\x20CRITICAL:\x20Self-healing\x20failed.\x20The\x20system\x20is\x20locked\x20down.','timestamp','currentposition','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','useCalendar','klima','triggerBriefing','PONG','enum.rooms.*','getForeignObjectsAsync','warn','Invalid\x20JSON\x20from\x20Python:\x20','geminiApiKey','.Current.Temperature','direction','KALENDER:\x20Keine\x20Daten','extendObjectAsync','reachable','âœ…\x20PIP\x20bootstrapped\x20successfully.\x20Retrying\x20installation...','normal','briefingJob','\x22\x20--break-system-packages\x20--user','writable','substring','sleepScore','vacation','health','âŒ\x20Health\x20Training\x20Failed:\x20','actual_temperature','Error\x20in\x20onMessage\x20command\x20','testApiKey','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','analysis.deviationFromBaseline','\x20|\x20','Kein\x20API\x20Key!','lights','Logbook','pop','âš ï¸\x20PIP\x20is\x20missing.\x20Attempting\x20self-healing\x20via\x20ensurepip\x20(User\x20Mode)...','\x20=\x20','presence','ðŸ\x20Stopping\x20Python\x20Sidecar...','ANALYZE_HEALTH','notifyEmailRecipient','ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','Training\x20Data\x20Sets','1291690OjkvVt','bewegung','\x20*\x20*\x20*','slice','LTM','notifyPushoverRecipient','Success:\x20Compressed\x20','Processing\x20Status','json','getFullYear',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','presenceDevices','livingContext','now','Fehler:\x20','Trend\x20Diagnosis\x20(Python)','lowbat','path','âŒ\x20Training\x20failed:\x20','sensor','KI-Modell\x20nicht\x20initialisiert','analysisHistory','...','analysis.analysisHistory','cogni-living\x20adapter\x20starting\x20(v','openweathermap','Restoring\x20sensor\x20cache\x20from\x20history\x20(','Sleep\x20Score\x20(0-100)','LTM.baselineStatus','length','âœ…\x20HEALTH\x20MODEL\x20TRAINED!\x20','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','setHours','licenseKey','getCalendarNames\x20Error:\x20','round','NORMAL','unknown','Guardian:\x20Sending\x20','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','eventHistory','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','ANALYZE_SEQUENCE','data','link_quality','toFixed','analysis.automation.patternDetected','.communicate.request','Unknown\x20error','ltmJob','application/json','systemUUID','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','Urlaub','brightness','Last\x20Result','PARTY','Aktiv\x20(','enum','notifyPushoverInstance','motion','.\x20DATEN:\x20Schlaf\x20','isExit','System\x20Mode','Last\x20raw\x20event','targetId','enum.functions.*','generateContent','rollladen','set_temperature','dismissAutomation','targetValue','Bibliotheken\x20nicht\x20gefunden','system.isPresent','system','setObjectNotExistsAsync','Analysiere\x20ausgewogen.','button','ANOMALY','âœ…\x20Alles\x20OK\x20(Reset)]','COGNI_CONFIRM_OK','update','AI\x20Training\x20Control','onReady','Subscribing\x20to\x20','events.history','shutter','Activity-Level','analysis.isAlert','Error\x20reading\x20calendar\x20table:\x20','.\x20KONTEXT:\x20','Restlessness\x20Level','vis.','Last\x20Check','occupancy','Wetter:\x20Deaktiviert','push','User\x20dismissed\x20automation\x20proposal.','aiPersona','LTM.driftAnalysis.lastCheck','date','history.','targetposition','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','config','Target\x20Value','getDate','Who\x20is\x20present?','Details:\x20','setpoint','ltmLtbWindowDays','Gemini\x20Init\x20Error:\x20','Anwesend','blind','\x20sequences...','string','stderr','alertReason','Health\x20Notes','weatherunderground','443440vnqHEl','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','lock','genAI','analysis.health.restlessness','TREND_RESULT','minDaysForBaseline','response','ðŸ›¡ï¸\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...','Failed\x20to\x20send\x20to\x20Python:\x20','schalter','PRIORITÃ„T:\x20Sicherheit.','analysis.trigger','Sending\x20notification:\x20\x22','native','ML-Libs\x20fehlen','Party','location','automationProposal','getGenerativeModel','python3\x20-m\x20pip\x20install\x20-r\x20\x22','calendarSelection','python_service','expire','âŒ\x20Installation\x20failed\x20even\x20after\x20bootstrap:\x20','shift','apply','\x20(Type\x20\x27','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','\x20Tage)','Automation\x20Proposals','.\x20OUTPUT:\x20Nur\x20Text.','valve','N/A\x20(Learning)','lastIndexOf','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','[LOG]','outdoorSensorId','echarts.','onStateChange','text','door','thermostat','Drift\x20Analysis','fault','analysis.automation.targetValue','[PYTHON]\x20','lampe','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','endsWith','latitude',')\x20->\x20','write','Trend\x20Value\x20(%)','level','Last\x20Check\x20Time','.forecast.current.temp','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','events.lastEvent','ANALYZE_TREND','.\x20Welcome\x20home.','filter','inactivityThresholdHours','currentSystemMode','PRO-','0\x203\x20*\x20*\x20*','analysis.lastResult','systemConfig','ack','Drift\x20Sched\x20Error:\x20','version','Unknown','description','LTM\x20Sched\x20Error:\x20','toLowerCase','icons-mfd.','Lernphase\x20(','detected','analysis.health.trendDiagnosis','toString','Baseline\x20Status','message','splice','exitTimer','No\x20instance','online','âœ…\x20SECURITY\x20MODEL\x20TRAINED!\x20Details:\x20','HEALTH_TRAIN_RESULT','channel','TRAIN_SECURITY','getObjectAsync','party','onMessage','analysis.training.triggerHealth','service.py','Feedback\x20Log','N/A','analysis.triggerBriefing','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','light','.NextHours.Location_1.Day_1.current.symbol_desc','Comfort\x20Suggestion','map','analysis.feedbackHistory','submitFeedback','time','analysis.history_debug_00','isArray','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','notifyTelegramEnabled','analysis.training','Recorded\x20Motion\x20Sequences','Trigger\x20Digest','getCalendarNames','isGracePeriodActive','Kein\x20API\x20Key\x20eingegeben.','analysis.health.notes','custom','analysis.activitySummary','isPresent','startsWith','analysis.health','longitude','Train\x20Health\x20Model\x20(IsoForest)','selectedFunctionIds','notifyPushoverEnabled','join','prÃ¤senz','Fokus\x20auf\x20Komfort.','COGNI_REQUEST_CALL','Drift\x20Status','.\x0a\x20\x20\x20\x20WETTER:\x20','Missing\x20data','working','generic','isAlert','trim','toISOString','communicate.request','notifyEmailInstance','callback','_score','feedbackHistory','LTM.dailyDigests','Train\x20Security\x20Model\x20(LSTM)','Training\x20Status','Auto\x20Apply\x20Rule','234451TnXcZw','0\x204\x20*\x20*\x20*','energy','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','analysis.automation.targetId','close','Alarm','system.config','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','kontakt','No\x20module\x20named\x20pip','isProVersion','autoApply','Error\x20checking\x20WiFi:\x20','\x20(Value:\x20','Morning\x20Briefing\x20sent.','analysis.training.triggerSecurity','fenster','val','Daily\x20Digests','stringify','analysis.security.lastScore','Skipped\x20(No\x20AI\x20or\x20Data)','getForeignObjectAsync','lastAlertState','(((.+)+)+)+$','notifyTelegramInstance','analysis.alertReason','.forecast.current.state','python3\x20-m\x20ensurepip\x20--default-pip\x20--user','ðŸ\x20Guardian\x20Diagnosis\x20(','type','_calName','):\x20','logDuplicates','ðŸ§ \x20Triggering\x20Security\x20Training\x20with\x20','.data.table','python3','value','temperature','Entry\x20detected\x20via\x20','cogni-living','system.meta.uuid','includes','\x20hours.\x20Potential\x20incapacitation.','LTM.trainingData','Alert\x20Reason','getTime','notifyEmailEnabled','Briefing\x20Sched\x20Error:\x20','analysis.automation.triggerAction','modeResetJob','ABWESEND','âš ï¸\x20ALARM:\x20','stdout','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','analysis.comfortSummary','WETTER:\x20Keine\x20Daten\x20gefunden','retry','\x20(Threshold:\x20','\x0aSTB:\x20','Target\x20ID','indicator','[PYTHON\x20ERR]\x20','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','maintenance','bind','analysis.security.lastCheck','rssi','Error\x20launching\x20Python\x20service:\x20','Unbekannt','heizung','subscribeForeignStatesAsync','values','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','Health\x20&\x20Sleep\x20Analysis','Trigger\x20Analysis','setStateAsync','telegram','activityLevel','Error\x20reading\x20outdoor\x20sensor\x20','Trigger\x20Action\x20Now','.forecast.current.temperature','constructor','city','WETTER:\x20','system.mode','log','\x27\x20not\x20in\x20allowed\x20list)','notifyTelegramRecipient','Action','search','useWeather','object','.\x20ZUSATZ:\x20','LTM.driftAnalysis','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','TRAIN_HEALTH','getMonth','38532KpxYGO','some','scheduleJob','UngewÃ¶hnliches\x20Bewegungsmuster\x20erkannt!\x20(Score:\x20','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','LTM.driftAnalysis.driftDetails','payload','toLocaleTimeString','licht','admin.','parse','getOverviewData','uuid','requirements.txt','dimmer','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','analysis.isEmergency','LTM.triggerDailyDigest','dutycycle','LTM.driftAnalysis.baselineDrift','LTM.processingStatus','kill','sort','replace','error','pythonProcess','value.health','ltmDriftCheckIntervalHours','Trigger\x20Briefing\x20(Test)','[TEST]\x20','VACATION','243117rEYbGH','details','position','analysis.health.lastCheck','Health\x20Train\x20Error:\x20','setForeignStateAsync','Cogni-Living','rawEventLog','Pattern\x20Detected','send','siren','geminiModel'];a0_0x35a8=function(){return _0x7a728c;};return a0_0x35a8();}function handlePythonResult(_0x3ea608,_0x2d8dc2){const _0x3dded9=a0_0x3b7d7b;if(_0x2d8dc2[_0x3dded9(0x297)]===_0x3dded9(0x388))_0x3ea608[_0x3dded9(0x2cf)]['debug'](_0x3dded9(0x3ad));else{if(_0x2d8dc2['type']===_0x3dded9(0x1e9)){const {tag:_0x70761e,diagnosis:_0x237c77,change_percent:_0x2ae861}=_0x2d8dc2['payload'];_0x3ea608[_0x3dded9(0x2cf)][_0x3dded9(0x311)](_0x3dded9(0x296)+_0x70761e+_0x3dded9(0x299)+_0x237c77+'\x20('+_0x2ae861+'%)'),_0x3ea608[_0x3dded9(0x2c5)](_0x3dded9(0x232),{'val':_0x237c77,'ack':!![]}),_0x3ea608[_0x3dded9(0x2c5)]('analysis.health.trendValue',{'val':_0x2ae861,'ack':!![]});}else{if(_0x2d8dc2[_0x3dded9(0x297)]===_0x3dded9(0x346)){const {success:_0x28f414,details:_0x5a4d9c}=_0x2d8dc2['payload'];_0x28f414?(_0x3ea608[_0x3dded9(0x2cf)][_0x3dded9(0x311)](_0x3dded9(0x23a)+_0x5a4d9c),_0x3ea608['setStateAsync'](_0x3dded9(0x37c),{'val':'Success:\x20'+new Date()[_0x3dded9(0x2e3)]()+'\x20('+_0x5a4d9c+')','ack':!![]})):(_0x3ea608['log']['error'](_0x3dded9(0x3c1)+(_0x5a4d9c||_0x3dded9(0x3e0))),_0x3ea608[_0x3dded9(0x2c5)](_0x3dded9(0x37c),{'val':_0x3dded9(0x343)+_0x5a4d9c,'ack':!![]}));}else{if(_0x2d8dc2[_0x3dded9(0x297)]===_0x3dded9(0x23b)){const {success:_0x187bc6,details:_0x1f6d1d}=_0x2d8dc2[_0x3dded9(0x2e2)];_0x187bc6?_0x3ea608[_0x3dded9(0x2cf)]['info'](_0x3dded9(0x3cd)+_0x1f6d1d):_0x3ea608[_0x3dded9(0x2cf)][_0x3dded9(0x2f4)](_0x3dded9(0x39c)+_0x1f6d1d);}else{if(_0x2d8dc2[_0x3dded9(0x297)]==='HEALTH_RESULT'){const {is_anomaly:_0x4577d8,details:_0x3b9c6b}=_0x2d8dc2[_0x3dded9(0x2e2)];_0x3ea608[_0x3dded9(0x2c5)](_0x3dded9(0x2fe),{'val':new Date()[_0x3dded9(0x26e)](),'ack':!![]}),_0x3ea608['setStateAsync'](_0x3dded9(0x32a),{'val':_0x4577d8,'ack':!![]}),_0x4577d8&&_0x3ea608[_0x3dded9(0x2cf)][_0x3dded9(0x38b)]('ðŸ©º\x20HEALTH\x20WARNING:\x20'+_0x3b9c6b);}else{if(_0x2d8dc2[_0x3dded9(0x297)]===_0x3dded9(0x335)){const {anomaly_score:_0x3d7ddf,is_anomaly:_0xaed7c4,threshold:_0x312af5}=_0x2d8dc2['payload'];_0x3ea608[_0x3dded9(0x2cf)]['info'](_0x3dded9(0x384)+_0x3d7ddf[_0x3dded9(0x3dd)](0x5)+_0x3dded9(0x2b3)+_0x312af5+_0x3dded9(0x217)+(_0xaed7c4?_0x3dded9(0x3ff):'OK')),_0x3ea608[_0x3dded9(0x2c5)](_0x3dded9(0x28d),{'val':_0x3d7ddf,'ack':!![]}),_0x3ea608[_0x3dded9(0x2c5)](_0x3dded9(0x2bb),{'val':new Date()[_0x3dded9(0x26e)](),'ack':!![]});if(_0xaed7c4){const _0x28cc2b=_0x3dded9(0x2df)+_0x3d7ddf[_0x3dded9(0x3dd)](0x4)+')';_0x3ea608[_0x3dded9(0x2c5)](_0x3dded9(0x1c4),{'val':!![],'ack':!![]}),_0x3ea608['setStateAsync']('analysis.alertReason',{'val':_0x28cc2b,'ack':!![]}),sendNotification(_0x3ea608,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x28cc2b,![],!![]);}}}}}}}}function startPythonService(_0xba95c1){const _0x5afbea=a0_0x3b7d7b;try{const _0x1ff308=path['join'](__dirname,'python_service',_0x5afbea(0x242));_0xba95c1[_0x5afbea(0x2cf)][_0x5afbea(0x311)](_0x5afbea(0x3d7)+_0x1ff308),_0xba95c1['pythonProcess']=spawn(_0x5afbea(0x29d),[_0x1ff308]),_0xba95c1[_0x5afbea(0x2f5)][_0x5afbea(0x2ae)]['on'](_0x5afbea(0x3db),_0x247a7a=>{const _0x459dbb=_0x5afbea,_0x3476f7=_0x247a7a['toString']()[_0x459dbb(0x34c)]('\x0a');_0x3476f7[_0x459dbb(0x32f)](_0xc89b62=>{const _0x474672=_0x459dbb,_0x20651b=_0xc89b62['trim']();if(!_0x20651b)return;if(_0x20651b['startsWith'](_0x474672(0x208)))_0xba95c1[_0x474672(0x2cf)][_0x474672(0x36e)](_0x474672(0x212)+_0x20651b[_0x474672(0x398)](0x5)[_0x474672(0x26d)]());else{if(_0x20651b['startsWith']('[RESULT]'))try{const _0x4ae5b9=JSON[_0x474672(0x2e6)](_0x20651b['substring'](0x8)[_0x474672(0x26d)]());handlePythonResult(_0xba95c1,_0x4ae5b9);}catch(_0x1a6e6){_0xba95c1[_0x474672(0x2cf)][_0x474672(0x38b)](_0x474672(0x38c)+_0x20651b);}}(_0x20651b[_0x474672(0x2a3)](_0x474672(0x36c))||_0x20651b[_0x474672(0x2a3)](_0x474672(0x3f9))||_0x20651b[_0x474672(0x2a3)](_0x474672(0x1f3)))&&(_0xba95c1[_0x474672(0x2cf)]['warn'](_0x474672(0x2d9)),installPythonDependencies(_0xba95c1));});}),_0xba95c1[_0x5afbea(0x2f5)][_0x5afbea(0x1e0)]['on'](_0x5afbea(0x3db),_0x310f38=>{const _0x397f8e=_0x5afbea,_0x76b99e=_0x310f38[_0x397f8e(0x233)]()[_0x397f8e(0x26d)]();_0xba95c1[_0x397f8e(0x2cf)][_0x397f8e(0x2f4)](_0x397f8e(0x2b7)+_0x76b99e);}),_0xba95c1[_0x5afbea(0x2f5)]['on'](_0x5afbea(0x27d),_0x37c222=>{const _0x2b3463=_0x5afbea;_0xba95c1['log'][_0x2b3463(0x311)](_0x2b3463(0x3e5)+_0x37c222),_0xba95c1[_0x2b3463(0x2f5)]=null;}),_0xba95c1[_0x5afbea(0x2f5)]['on'](_0x5afbea(0x2f4),_0x4b1313=>{const _0xbe954b=_0x5afbea;_0xba95c1[_0xbe954b(0x2cf)]['warn'](_0xbe954b(0x207)+_0x4b1313[_0xbe954b(0x235)]);});}catch(_0x3d987f){_0xba95c1[_0x5afbea(0x2cf)]['error'](_0x5afbea(0x2bd)+_0x3d987f[_0x5afbea(0x235)]);}}function stopPythonService(_0x189952){const _0x2eeb9f=a0_0x3b7d7b;if(_0x189952[_0x2eeb9f(0x2f5)]){_0x189952[_0x2eeb9f(0x2cf)][_0x2eeb9f(0x311)](_0x2eeb9f(0x3aa));try{_0x189952[_0x2eeb9f(0x2f5)][_0x2eeb9f(0x2f1)]();}catch(_0x3778d4){_0x189952['log'][_0x2eeb9f(0x38b)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x3778d4['message']);}_0x189952[_0x2eeb9f(0x2f5)]=null;}}class CogniLiving extends utils['Adapter']{constructor(_0x1a0f32){const _0x1f7ec3=a0_0x3b7d7b;super({..._0x1a0f32,'name':_0x1f7ec3(0x2a1)}),this['eventHistory']=[],this[_0x1f7ec3(0x3c4)]=[],this[_0x1f7ec3(0x273)]=[],this[_0x1f7ec3(0x302)]=[],this[_0x1f7ec3(0x340)]=[],this[_0x1f7ec3(0x379)]={},this[_0x1f7ec3(0x227)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this[_0x1f7ec3(0x35e)]=null,this['isGracePeriodActive']=![],this[_0x1f7ec3(0x1e7)]=null,this[_0x1f7ec3(0x306)]=null,this['currentSystemMode']=SYSTEM_MODES[_0x1f7ec3(0x3d4)],this[_0x1f7ec3(0x283)]=![],this['lastAlertState']=![],this[_0x1f7ec3(0x3e3)]=_0x1f7ec3(0x3d5),this[_0x1f7ec3(0x30d)]=null,this[_0x1f7ec3(0x3e1)]=null,this[_0x1f7ec3(0x2ab)]=null,this[_0x1f7ec3(0x37b)]=null,this['briefingJob']=null,this[_0x1f7ec3(0x2f5)]=null,this['dependencyInstallInProgress']=![],this['on']('ready',this[_0x1f7ec3(0x404)][_0x1f7ec3(0x2ba)](this)),this['on']('stateChange',this[_0x1f7ec3(0x20b)][_0x1f7ec3(0x2ba)](this)),this['on'](_0x1f7ec3(0x330),this[_0x1f7ec3(0x37d)][_0x1f7ec3(0x2ba)](this)),this['on'](_0x1f7ec3(0x235),this[_0x1f7ec3(0x240)]['bind'](this));}async[a0_0x3b7d7b(0x404)](){const _0x36143f=a0_0x3b7d7b;this[_0x36143f(0x2cf)]['info'](_0x36143f(0x3c7)+this[_0x36143f(0x22a)]+_0x36143f(0x3b9)),await initZombies(this),this[_0x36143f(0x1d4)][_0x36143f(0x3d1)]=this[_0x36143f(0x1d4)][_0x36143f(0x3d1)]||'';try{this[_0x36143f(0x283)]=await checkLicense(this,this[_0x36143f(0x1d4)][_0x36143f(0x3d1)]);}catch(_0x37d063){}if(!this[_0x36143f(0x1d4)]['inactivityThresholdHours']||this[_0x36143f(0x1d4)][_0x36143f(0x222)]<0.1)this[_0x36143f(0x1d4)][_0x36143f(0x222)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x36143f(0x1d4)][_0x36143f(0x38d)])try{this[_0x36143f(0x1e7)]=new GoogleGenerativeAI(this[_0x36143f(0x1d4)]['geminiApiKey']),this['geminiModel']=this['genAI'][_0x36143f(0x1f7)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x36143f(0x3e2)}}),this[_0x36143f(0x2cf)][_0x36143f(0x311)](_0x36143f(0x339));}catch(_0x13be95){this[_0x36143f(0x2cf)]['error'](_0x36143f(0x1db)+_0x13be95[_0x36143f(0x235)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates'](_0x36143f(0x1f0)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x36143f(0x320)](_0x36143f(0x2ce)),this[_0x36143f(0x320)](_0x36143f(0x245)),this[_0x36143f(0x320)](_0x36143f(0x2aa)),this[_0x36143f(0x320)]('analysis.automation.autoApply'),this['subscribeStates']('analysis.training.triggerSecurity'),this[_0x36143f(0x320)]('analysis.training.triggerHealth'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0x36143f(0x30d)]);const _0x5838d4=this[_0x36143f(0x1d4)][_0x36143f(0x338)]||0xf;_0x5838d4>0x0&&(this[_0x36143f(0x2cf)][_0x36143f(0x311)]('Starting\x20Autopilot\x20('+_0x5838d4+'\x20min).'),this[_0x36143f(0x30d)]=setInterval(()=>{runAutopilot(this);},_0x5838d4*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{this['pythonProcess']&&runPythonHealthCheck(this);},0x1388);}[a0_0x3b7d7b(0x37d)](_0x280706){const _0xd1c201=a0_0x3b7d7b;if(this[_0xd1c201(0x30d)])clearInterval(this[_0xd1c201(0x30d)]);if(this[_0xd1c201(0x37b)])clearInterval(this[_0xd1c201(0x37b)]);if(this['ltmJob'])this['ltmJob']['cancel']();if(this[_0xd1c201(0x2ab)])this['modeResetJob'][_0xd1c201(0x318)]();if(this[_0xd1c201(0x395)])this[_0xd1c201(0x395)][_0xd1c201(0x318)]();if(this[_0xd1c201(0x237)])clearTimeout(this[_0xd1c201(0x237)]);if(this['exitGraceTimer'])clearTimeout(this[_0xd1c201(0x35e)]);stopPythonService(this),_0x280706();}async['onStateChange'](_0x471f63,_0x53735c){const _0x4eb908=a0_0x3b7d7b;if(!_0x53735c)return;if(_0x471f63['includes'](_0x4eb908(0x2c6))&&_0x471f63['endsWith'](_0x4eb908(0x26f))&&_0x53735c[_0x4eb908(0x28a)]){await handleTelegramResponse(this,_0x53735c[_0x4eb908(0x28a)]);return;}if(_0x471f63===this['namespace']+'.'+SYSTEM_DP_MODE){_0x53735c['val']&&Object[_0x4eb908(0x2c1)](SYSTEM_MODES)[_0x4eb908(0x2a3)](_0x53735c[_0x4eb908(0x28a)])&&(this[_0x4eb908(0x223)]=_0x53735c[_0x4eb908(0x28a)],_0x53735c[_0x4eb908(0x28a)]===SYSTEM_MODES[_0x4eb908(0x2fa)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x53735c[_0x4eb908(0x228)])this[_0x4eb908(0x36a)](_0x471f63,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x53735c[_0x4eb908(0x228)]){_0x471f63[_0x4eb908(0x2a3)](_0x4eb908(0x1f0))&&_0x53735c['val']&&(this[_0x4eb908(0x36a)](_0x471f63,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x471f63['includes'](_0x4eb908(0x33b))&&_0x53735c[_0x4eb908(0x28a)]){this[_0x4eb908(0x36a)](_0x471f63,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x471f63[_0x4eb908(0x2a3)](_0x4eb908(0x387))&&_0x53735c[_0x4eb908(0x28a)]&&(this[_0x4eb908(0x36a)](_0x471f63,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x471f63[_0x4eb908(0x2a3)]('automation.triggerAction')&&_0x53735c[_0x4eb908(0x28a)]&&(this['setState'](_0x471f63,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x471f63[_0x4eb908(0x2a3)](_0x4eb908(0x288))&&_0x53735c[_0x4eb908(0x28a)]){this[_0x4eb908(0x36a)](_0x471f63,{'val':![],'ack':!![]});if(!this['isProVersion'])return;try{const _0x57d1ff=await this[_0x4eb908(0x357)](_0x4eb908(0x378));if(_0x57d1ff&&_0x57d1ff['val']){const _0x49aa15=JSON['parse'](_0x57d1ff['val']);this[_0x4eb908(0x2cf)][_0x4eb908(0x311)](_0x4eb908(0x29b)+_0x49aa15[_0x4eb908(0x3cc)]+_0x4eb908(0x1de)),this['setStateAsync'](_0x4eb908(0x37c),{'val':'Sec-Training\x20started...','ack':!![]}),sendToPython(this,_0x4eb908(0x23d),{'sequences':_0x49aa15});}}catch(_0x4085ee){this[_0x4eb908(0x2cf)][_0x4eb908(0x2f4)](_0x4eb908(0x369)+_0x4085ee[_0x4eb908(0x235)]);}}if(_0x471f63[_0x4eb908(0x2a3)](_0x4eb908(0x241))&&_0x53735c[_0x4eb908(0x28a)]){this[_0x4eb908(0x36a)](_0x471f63,{'val':![],'ack':!![]});if(!this['isProVersion'])return;try{const _0x5024cb=await this[_0x4eb908(0x357)](LTM_DP_DAILY_DIGESTS);if(_0x5024cb&&_0x5024cb[_0x4eb908(0x28a)]){const _0x56d6b3=JSON[_0x4eb908(0x2e6)](_0x5024cb[_0x4eb908(0x28a)]);this[_0x4eb908(0x2cf)][_0x4eb908(0x311)](_0x4eb908(0x319)+_0x56d6b3[_0x4eb908(0x3cc)]+_0x4eb908(0x30b)),sendToPython(this,_0x4eb908(0x2da),{'digests':_0x56d6b3});}}catch(_0x4d6d5b){this[_0x4eb908(0x2cf)]['error'](_0x4eb908(0x2ff)+_0x4d6d5b[_0x4eb908(0x235)]);}}return;}if(this[_0x4eb908(0x1d4)][_0x4eb908(0x3ba)]&&this[_0x4eb908(0x1d4)]['presenceDevices'][_0x4eb908(0x2a3)](_0x471f63)){await checkWifiPresence(this);return;}const _0x4870b4=(this[_0x4eb908(0x1d4)]['devices']||[])['find'](_0x1963ef=>_0x1963ef['id']===_0x471f63);if(_0x4870b4)processSensorEvent(this,_0x471f63,_0x53735c,_0x4870b4);}async[a0_0x3b7d7b(0x240)](_0x49200d){const _0x55122d=a0_0x3b7d7b;if(typeof _0x49200d===_0x55122d(0x2d5)&&_0x49200d[_0x55122d(0x235)])try{if(_0x49200d[_0x55122d(0x358)]===_0x55122d(0x39f)){const _0x206041=_0x49200d['message']['apiKey']||this[_0x55122d(0x1d4)]['geminiApiKey'];if(!_0x206041)return this['sendTo'](_0x49200d['from'],_0x49200d[_0x55122d(0x358)],{'success':![],'message':_0x55122d(0x258)},_0x49200d[_0x55122d(0x271)]);try{const _0x76ff27=new GoogleGenerativeAI(_0x206041),_0x526dbe=_0x76ff27[_0x55122d(0x1f7)]({'model':GEMINI_MODEL}),_0x256993=await _0x526dbe[_0x55122d(0x3f4)](_0x55122d(0x34b)),_0x2bdbce=await _0x256993[_0x55122d(0x1eb)],_0x5487ac=_0x2bdbce['text']();this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':!![],'message':_0x55122d(0x347)+_0x5487ac[_0x55122d(0x398)](0x0,0x14)+_0x55122d(0x3c5)},_0x49200d[_0x55122d(0x271)]);}catch(_0x30129d){this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':![],'message':_0x55122d(0x3bd)+_0x30129d['message']},_0x49200d[_0x55122d(0x271)]);}}else{if(_0x49200d[_0x55122d(0x358)]===_0x55122d(0x377)){const _0x3ee846=await getWeatherContext(this),_0x4b45b4=await getCalendarContext(this);this[_0x55122d(0x36d)](_0x49200d['from'],_0x49200d[_0x55122d(0x358)],{'success':!![],'weather':_0x3ee846,'calendar':_0x4b45b4},_0x49200d[_0x55122d(0x271)]);}else{if(_0x49200d[_0x55122d(0x358)]==='testNotification'){}else{if(_0x49200d[_0x55122d(0x358)]==='getLtmData'){if(!this[_0x55122d(0x283)])return this['sendTo'](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':![],'isPro':![]},_0x49200d[_0x55122d(0x271)]);let _0x367387={'status':_0x55122d(0x244),'details':'','lastCheck':0x0};try{_0x367387['status']=(await this[_0x55122d(0x357)](LTM_DP_DRIFT_STATUS))[_0x55122d(0x28a)],_0x367387[_0x55122d(0x2fc)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))['val'],_0x367387['lastCheck']=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x55122d(0x28a)];}catch(_0x3a2a83){}const _0x444c6a=this[_0x55122d(0x3c4)]||[];this['sendTo'](_0x49200d['from'],_0x49200d[_0x55122d(0x358)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x367387,'analysisHistory':_0x444c6a},_0x49200d['callback']);}else{if(_0x49200d[_0x55122d(0x358)]===_0x55122d(0x2e7)){const _0x4eeb09=this[_0x55122d(0x340)]['length'],_0x6d0da1=new Date(),_0x1a4203=new Date(_0x6d0da1[_0x55122d(0x3b8)](),_0x6d0da1[_0x55122d(0x2db)](),_0x6d0da1[_0x55122d(0x1d6)]())[_0x55122d(0x2a7)](),_0x50d893=this[_0x55122d(0x302)]['filter'](_0x6fb267=>new Date(_0x6fb267['timestamp'])[_0x55122d(0x2a7)]()>_0x1a4203)[_0x55122d(0x3cc)],_0x49b3c5=new Array(0x18)[_0x55122d(0x34f)](0x0);this[_0x55122d(0x302)][_0x55122d(0x32f)](_0x4a594c=>{const _0x46203a=_0x55122d,_0x51a90e=new Date(_0x4a594c[_0x46203a(0x382)]);if(_0x51a90e[_0x46203a(0x2a7)]()>_0x1a4203)_0x49b3c5[_0x51a90e['getHours']()]++;});let _0x4628de={'status':_0x55122d(0x244)};try{_0x4628de[_0x55122d(0x324)]=(await this[_0x55122d(0x357)](LTM_DP_DRIFT_STATUS))[_0x55122d(0x28a)];}catch(_0xa8b64c){}let _0x258c0f='';try{const _0x4034e4=await this[_0x55122d(0x357)](_0x55122d(0x31a));_0x258c0f=_0x4034e4?_0x4034e4['val']:'';}catch(_0x1db9d9){}let _0x2220d7=null;!this[_0x55122d(0x306)]&&(_0x2220d7=this[_0x55122d(0x1d4)][_0x55122d(0x38d)]?_0x55122d(0x3c3):_0x55122d(0x3a3));let _0x1bea82={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x139730=await this['getStateAsync'](_0x55122d(0x3de)),_0x167e5c=await this[_0x55122d(0x357)](_0x55122d(0x32c)),_0x146522=await this[_0x55122d(0x357)](_0x55122d(0x27c)),_0x1b7242=await this[_0x55122d(0x357)](_0x55122d(0x211)),_0x1ae8d7=await this['getStateAsync'](_0x55122d(0x376));_0x139730&&_0x139730['val']&&(_0x1bea82['detected']=!![],_0x1bea82['description']=_0x167e5c?_0x167e5c['val']:'',_0x1bea82[_0x55122d(0x3f2)]=_0x146522?_0x146522['val']:'',_0x1bea82['targetValue']=_0x1b7242?_0x1b7242[_0x55122d(0x28a)]:''),_0x1bea82[_0x55122d(0x284)]=_0x1ae8d7?!!_0x1ae8d7[_0x55122d(0x28a)]:![];}catch(_0x15b6f6){}this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':!![],'eventHistory':this[_0x55122d(0x3d8)][_0x55122d(0x3b2)](0x0,0xf),'stats':{'digestCount':_0x4eeb09,'eventCountToday':_0x50d893,'hourlyActivity':_0x49b3c5,'driftStatus':_0x4628de[_0x55122d(0x324)],'isPresent':this[_0x55122d(0x25c)],'presenceWho':_0x258c0f,'minDays':this[_0x55122d(0x1d4)][_0x55122d(0x1ea)]||0x7,'stbDays':this[_0x55122d(0x1d4)][_0x55122d(0x344)]||0xe,'ltbDays':this[_0x55122d(0x1d4)][_0x55122d(0x1da)]||0x3c,'systemError':_0x2220d7},'automation':_0x1bea82},_0x49200d['callback']);}else{if(_0x49200d[_0x55122d(0x358)]==='getEnums'){const _0x3bac41=await this[_0x55122d(0x38a)]('enum.functions.*',_0x55122d(0x3eb)),_0x2e5912=[];if(_0x3bac41)for(const _0x487140 in _0x3bac41){const _0x3bbadf=_0x3bac41[_0x487140],_0x6544ba=(_0x3bbadf[_0x55122d(0x309)]&&typeof _0x3bbadf['common'][_0x55122d(0x315)]==='object'?_0x3bbadf['common'][_0x55122d(0x315)]['de']:_0x3bbadf[_0x55122d(0x309)][_0x55122d(0x315)])||_0x3bbadf[_0x55122d(0x309)][_0x55122d(0x315)];_0x2e5912[_0x55122d(0x1cc)]({'id':_0x487140,'name':_0x6544ba});}this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':!![],'enums':_0x2e5912},_0x49200d[_0x55122d(0x271)]);}else{if(_0x49200d[_0x55122d(0x358)]==='scanDevices')try{const _0x5969b6=await scanForDevices(this,_0x49200d[_0x55122d(0x235)]||{});this[_0x55122d(0x36d)](_0x49200d['from'],_0x49200d['command'],{'success':!![],'devices':_0x5969b6},_0x49200d[_0x55122d(0x271)]);}catch(_0x3ac973){this['sendTo'](_0x49200d[_0x55122d(0x359)],_0x49200d['command'],{'success':![],'error':_0x3ac973[_0x55122d(0x235)]},_0x49200d[_0x55122d(0x271)]);}else{if(_0x49200d[_0x55122d(0x358)]===_0x55122d(0x256)){const _0x1871d5=_0x49200d[_0x55122d(0x235)][_0x55122d(0x354)];if(!_0x1871d5)return this[_0x55122d(0x36d)](_0x49200d['from'],_0x49200d[_0x55122d(0x358)],{'success':![],'error':_0x55122d(0x238)},_0x49200d[_0x55122d(0x271)]);const _0x125081=await getCalendarNames(this,_0x1871d5);this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':!![],'names':_0x125081},_0x49200d[_0x55122d(0x271)]);}else{if(_0x49200d[_0x55122d(0x358)]===_0x55122d(0x355)){const {targetId:_0x3307b3,targetValue:_0x3d30d9}=_0x49200d[_0x55122d(0x235)];this[_0x55122d(0x2cf)][_0x55122d(0x311)]('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0x3307b3+_0x55122d(0x3a8)+_0x3d30d9),await this[_0x55122d(0x2c5)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x55122d(0x2c5)](_0x55122d(0x32c),{'val':_0x55122d(0x250)+_0x3307b3,'ack':!![]}),await this[_0x55122d(0x2c5)](_0x55122d(0x27c),{'val':_0x3307b3,'ack':!![]}),await this[_0x55122d(0x2c5)](_0x55122d(0x211),{'val':_0x3d30d9,'ack':!![]}),this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':!![]},_0x49200d[_0x55122d(0x271)]);}else{if(_0x49200d['command']===_0x55122d(0x24c)){const {historyId:_0x3b3772,rating:_0xad2652,comment:_0xe8685b,alertReason:_0x224e53}=_0x49200d[_0x55122d(0x235)];_0x3b3772&&_0xad2652?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x3b3772,'rating':_0xad2652,'comment':_0xe8685b,'alertReason':_0x224e53}),this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':!![]},_0x49200d[_0x55122d(0x271)])):this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':![],'error':_0x55122d(0x269)},_0x49200d[_0x55122d(0x271)]);}else _0x49200d['command']===_0x55122d(0x3f7)&&(this[_0x55122d(0x2cf)]['info'](_0x55122d(0x1cd)),await this[_0x55122d(0x2c5)](_0x55122d(0x3de),{'val':![],'ack':!![]}),await this[_0x55122d(0x2c5)](_0x55122d(0x32c),{'val':'','ack':!![]}),this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':!![]},_0x49200d[_0x55122d(0x271)]));}}}}}}}}}}catch(_0x31c7a7){this[_0x55122d(0x2cf)][_0x55122d(0x2f4)](_0x55122d(0x39e)+_0x49200d['command']+':\x20'+_0x31c7a7[_0x55122d(0x235)]);if(_0x49200d[_0x55122d(0x271)])this[_0x55122d(0x36d)](_0x49200d[_0x55122d(0x359)],_0x49200d[_0x55122d(0x358)],{'success':![],'error':_0x31c7a7[_0x55122d(0x235)]},_0x49200d[_0x55122d(0x271)]);}}}if(require['main']!==module)module['exports']=_0x308213=>new CogniLiving(_0x308213);else new CogniLiving();