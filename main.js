const a0_0x41bffb=a0_0x22a3;(function(_0x5ee9b4,_0x1e984a){const _0x3dd07c=a0_0x22a3,_0x4b73e7=_0x5ee9b4();while(!![]){try{const _0x12b2d9=parseInt(_0x3dd07c(0x185))/0x1+parseInt(_0x3dd07c(0x291))/0x2*(parseInt(_0x3dd07c(0x275))/0x3)+-parseInt(_0x3dd07c(0x1ac))/0x4+parseInt(_0x3dd07c(0x15b))/0x5*(-parseInt(_0x3dd07c(0x167))/0x6)+parseInt(_0x3dd07c(0x255))/0x7+-parseInt(_0x3dd07c(0x249))/0x8+parseInt(_0x3dd07c(0x26e))/0x9;if(_0x12b2d9===_0x1e984a)break;else _0x4b73e7['push'](_0x4b73e7['shift']());}catch(_0x310e8d){_0x4b73e7['push'](_0x4b73e7['shift']());}}}(a0_0x374c,0x2702e));const a0_0x40e1f5=(function(){let _0x24ce27=!![];return function(_0x359f25,_0x5913b5){const _0x1ddc44=_0x24ce27?function(){if(_0x5913b5){const _0x5ef47f=_0x5913b5['apply'](_0x359f25,arguments);return _0x5913b5=null,_0x5ef47f;}}:function(){};return _0x24ce27=![],_0x1ddc44;};}()),a0_0x4e856a=a0_0x40e1f5(this,function(){const _0xf3bce=a0_0x22a3;return a0_0x4e856a[_0xf3bce(0x2c0)]()[_0xf3bce(0x150)]('(((.+)+)+)+$')[_0xf3bce(0x2c0)]()[_0xf3bce(0x2da)](a0_0x4e856a)[_0xf3bce(0x150)](_0xf3bce(0x176));});a0_0x4e856a();'use strict';const utils=require(a0_0x41bffb(0x188)),{GoogleGenerativeAI}=require(a0_0x41bffb(0x28e)),schedule=require('node-schedule'),{spawn,exec,execSync}=require(a0_0x41bffb(0x198)),path=require(a0_0x41bffb(0x181)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x41bffb(0x201),LTM_SCHEDULE=a0_0x41bffb(0x1b5),MODE_RESET_SCHEDULE=a0_0x41bffb(0x1e7),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x41bffb(0x191),LTM_DP_DAILY_DIGESTS=a0_0x41bffb(0x1fd),LTM_DP_STATUS=a0_0x41bffb(0x1cc),LTM_DP_TRIGGER_DIGEST=a0_0x41bffb(0x1eb),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0x41bffb(0x2ca),LTM_DP_DRIFT_STATUS=a0_0x41bffb(0x1d4),LTM_DP_DRIFT_DETAILS=a0_0x41bffb(0x1db),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x41bffb(0x299),SYSTEM_MODES={'NORMAL':a0_0x41bffb(0x2d7),'VACATION':'vacation','PARTY':a0_0x41bffb(0x1aa),'GUEST':a0_0x41bffb(0x2bf)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x41bffb(0x296)]],PERSONA_MAPPING={'generic':a0_0x41bffb(0x246),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit/AAL.','family':a0_0x41bffb(0x1d8),'single_comfort':a0_0x41bffb(0x165),'security':a0_0x41bffb(0x27a)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process['platform']==='win32',PERSISTENT_DIR=path[a0_0x41bffb(0x2c2)](__dirname,a0_0x41bffb(0x2e8)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path[a0_0x41bffb(0x2c2)](VENV_PATH,a0_0x41bffb(0x245),a0_0x41bffb(0x18f)):path[a0_0x41bffb(0x2c2)](VENV_PATH,a0_0x41bffb(0x259),a0_0x41bffb(0x2e0)),PIP_EXE=IS_WIN?path[a0_0x41bffb(0x2c2)](VENV_PATH,a0_0x41bffb(0x245),a0_0x41bffb(0x19d)):path[a0_0x41bffb(0x2c2)](VENV_PATH,'bin','pip');let activeSequence=[],sequenceTimer=null;async function initZombies(_0x306786){const _0x494fde=a0_0x41bffb;try{const _0x3769ad=[_0x494fde(0x214),'events.history_debug_00'];for(const _0x35fc94 of _0x3769ad){try{const _0x2d6213=await _0x306786['getObjectAsync'](_0x35fc94);if(_0x2d6213)await _0x306786['delObjectAsync'](_0x35fc94);}catch(_0x3bed4){}}}catch(_0x421d7b){}}async function checkLicense(_0x4bfb7f){return!![];}async function initHistory(_0x354832){const _0x37eed0=a0_0x41bffb;try{const _0x51b86d=await _0x354832['getStateAsync'](_0x37eed0(0x2eb));_0x51b86d&&_0x51b86d[_0x37eed0(0x2d0)]&&(_0x354832[_0x37eed0(0x16a)]=JSON[_0x37eed0(0x251)](_0x51b86d[_0x37eed0(0x2d0)][_0x37eed0(0x2c0)]()));}catch(_0x48ea89){_0x354832[_0x37eed0(0x16a)]=[];}try{const _0x454eee=await _0x354832[_0x37eed0(0x1e9)](_0x37eed0(0x269));if(_0x454eee&&_0x454eee[_0x37eed0(0x2d0)])_0x354832[_0x37eed0(0x1f5)]=JSON[_0x37eed0(0x251)](_0x454eee[_0x37eed0(0x2d0)][_0x37eed0(0x2c0)]());}catch(_0x3d9e81){_0x354832['analysisHistory']=[];}if(_0x354832[_0x37eed0(0x16a)]&&_0x354832[_0x37eed0(0x16a)]['length']>0x0){_0x354832[_0x37eed0(0x281)][_0x37eed0(0x1b3)](_0x37eed0(0x20b));for(let _0x1d3524=_0x354832[_0x37eed0(0x16a)][_0x37eed0(0x189)]-0x1;_0x1d3524>=0x0;_0x1d3524--){const _0xccdcd2=_0x354832[_0x37eed0(0x16a)][_0x1d3524];if(_0xccdcd2&&_0xccdcd2['id']!==undefined&&_0xccdcd2['value']!==undefined)_0x354832[_0x37eed0(0x1cb)][_0xccdcd2['id']]=_0xccdcd2['value'];}}}async function initSystemConfig(_0x210d37){const _0xb5fb8=a0_0x41bffb;try{const _0x42a4bf=await _0x210d37[_0xb5fb8(0x18c)](_0xb5fb8(0x277));if(_0x42a4bf&&_0x42a4bf[_0xb5fb8(0x168)])_0x210d37[_0xb5fb8(0x240)]={'latitude':_0x42a4bf[_0xb5fb8(0x168)][_0xb5fb8(0x1ab)]||0x0,'longitude':_0x42a4bf[_0xb5fb8(0x168)]['longitude']||0x0,'city':_0x42a4bf[_0xb5fb8(0x168)][_0xb5fb8(0x257)]||''};}catch(_0x31dba3){}}async function createAllObjects(_0x1b79c2){const _0x1dfcf5=a0_0x41bffb;await _0x1b79c2[_0x1dfcf5(0x2b1)]('system',{'type':'channel','common':{'name':'System'},'native':{}}),await _0x1b79c2['extendObjectAsync'](SYSTEM_DP_MODE,{'type':_0x1dfcf5(0x24a),'common':{'name':'System\x20Mode','type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x24a),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x1dfcf5(0x28a)]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x228),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x26c),'type':'string','role':_0x1dfcf5(0x24c),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)]('events.lastEvent',{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x2ba),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x21f),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x2eb),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x244),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x21f),'read':!![],'write':![]},'native':{}}),await _0x1b79c2['extendObjectAsync'](_0x1dfcf5(0x27b),{'type':_0x1dfcf5(0x258),'common':{'name':_0x1dfcf5(0x1ec)},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x293),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x1cd),'type':_0x1dfcf5(0x1f8),'role':_0x1dfcf5(0x252),'read':!![],'write':!![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x1d9),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x215),'type':_0x1dfcf5(0x1f8),'role':_0x1dfcf5(0x252),'read':!![],'write':!![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x21e),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x2cc),'type':_0x1dfcf5(0x1f8),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x14b),{'type':_0x1dfcf5(0x24a),'common':{'name':'Train\x20Comfort','type':_0x1dfcf5(0x1f8),'role':_0x1dfcf5(0x252),'read':!![],'write':!![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x21d),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x2e9),'type':_0x1dfcf5(0x1f8),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x29a),{'type':'state','common':{'name':_0x1dfcf5(0x1b6),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x24c),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x2b1)]('analysis.security',{'type':_0x1dfcf5(0x258),'common':{'name':_0x1dfcf5(0x267)},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x22e),{'type':'state','common':{'name':_0x1dfcf5(0x1c0),'type':'number','role':_0x1dfcf5(0x1d7),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x170),{'type':_0x1dfcf5(0x24a),'common':{'name':'Current\x20Threshold','type':_0x1dfcf5(0x2aa),'role':_0x1dfcf5(0x1d7),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x1a4),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x223),'type':'string','role':_0x1dfcf5(0x178),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x17d),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x2be),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x1b79c2['extendObjectAsync'](_0x1dfcf5(0x17c),{'type':'channel','common':{'name':'Health\x20Analysis'},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x15e),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x223),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x178),'read':!![],'write':![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync'](_0x1dfcf5(0x254),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x1fa),'type':'boolean','role':_0x1dfcf5(0x146),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x297),{'type':_0x1dfcf5(0x24a),'common':{'name':'Trend','type':_0x1dfcf5(0x230),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x226),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x16c),'type':_0x1dfcf5(0x2aa),'role':'value','read':!![],'write':![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync'](_0x1dfcf5(0x2df),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x286),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x21f),'read':!![],'write':![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync']('analysis.health.gaitSpeed',{'type':_0x1dfcf5(0x24a),'common':{'name':'Gait\x20Speed\x20Trend','type':_0x1dfcf5(0x2aa),'role':_0x1dfcf5(0x1d7),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x2b1)](_0x1dfcf5(0x1a0),{'type':_0x1dfcf5(0x258),'common':{'name':'Energy\x20Intelligence'},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)]('analysis.energy.insulationScore',{'type':'state','common':{'name':_0x1dfcf5(0x20d),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync'](_0x1dfcf5(0x2d9),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x1f2),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x24c),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x1a9),{'type':_0x1dfcf5(0x24a),'common':{'name':'Temperature\x20Forecast','type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x21f),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x2b1)]('LTM',{'type':'channel','common':{'name':_0x1dfcf5(0x212)},'native':{}}),await _0x1b79c2['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x1c5),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x21f),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x2b1)](LTM_DP_DAILY_DIGESTS,{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x25d),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x21f),'read':!![],'write':![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync'](_0x1dfcf5(0x2db),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x190),'type':_0x1dfcf5(0x230),'role':'json','read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x14f),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x2cd),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x21f),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)]('analysis.trigger',{'type':'state','common':{'name':_0x1dfcf5(0x1a3),'type':_0x1dfcf5(0x1f8),'role':_0x1dfcf5(0x252),'read':!![],'write':!![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)]('analysis.triggerBriefing',{'type':'state','common':{'name':_0x1dfcf5(0x20a),'type':'boolean','role':_0x1dfcf5(0x252),'read':!![],'write':!![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync']('analysis.isAlert',{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x24b),'type':'boolean','role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync'](_0x1dfcf5(0x1dc),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x27c),'type':'string','role':'text.alarm','read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)]('analysis.activitySummary',{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x248),'type':_0x1dfcf5(0x230),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x294),{'type':_0x1dfcf5(0x24a),'common':{'name':'Pattern\x20Detected','type':_0x1dfcf5(0x1f8),'role':_0x1dfcf5(0x146),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x2bc),{'type':'state','common':{'name':_0x1dfcf5(0x25e),'type':'string','role':_0x1dfcf5(0x24c),'read':!![],'write':![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync']('analysis.automation.detectedPatterns',{'type':_0x1dfcf5(0x24a),'common':{'name':'Detected\x20Patterns','type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x21f),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x16f),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x1d1),'type':_0x1dfcf5(0x230),'role':_0x1dfcf5(0x24c),'read':!![],'write':![]},'native':{}}),await _0x1b79c2['setObjectNotExistsAsync'](_0x1dfcf5(0x173),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x18b),'type':'string','role':_0x1dfcf5(0x24c),'read':!![],'write':![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x283),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x260),'type':_0x1dfcf5(0x1f8),'role':'switch','read':!![],'write':!![]},'native':{}}),await _0x1b79c2[_0x1dfcf5(0x28b)](_0x1dfcf5(0x2dd),{'type':_0x1dfcf5(0x24a),'common':{'name':_0x1dfcf5(0x141),'type':_0x1dfcf5(0x1f8),'role':_0x1dfcf5(0x252),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x3ebeb2){const _0x46f8a3=a0_0x41bffb;try{const _0x2dc395=await _0x3ebeb2[_0x46f8a3(0x1e9)](SYSTEM_DP_MODE);_0x2dc395&&_0x2dc395['val']&&Object[_0x46f8a3(0x25b)](SYSTEM_MODES)['includes'](_0x2dc395[_0x46f8a3(0x2d0)])?_0x3ebeb2[_0x46f8a3(0x1de)]=_0x2dc395['val']:(_0x3ebeb2[_0x46f8a3(0x1de)]=SYSTEM_MODES[_0x46f8a3(0x28a)],await _0x3ebeb2['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x46f8a3(0x28a)],'ack':!![]}));}catch(_0x721002){_0x3ebeb2[_0x46f8a3(0x1de)]=SYSTEM_MODES[_0x46f8a3(0x28a)];}}async function loadRawEventLog(_0x4ba5f8){const _0x4f87a7=a0_0x41bffb;try{const _0x314b5b=await _0x4ba5f8['getStateAsync'](LTM_DP_RAW_LOG);if(_0x314b5b&&_0x314b5b[_0x4f87a7(0x2d0)])_0x4ba5f8['rawEventLog']=JSON[_0x4f87a7(0x251)](_0x314b5b['val']);}catch(_0x20ec99){_0x4ba5f8['rawEventLog']=[];}}async function saveRawEventLog(_0x199e58){const _0x1c24f8=a0_0x41bffb;if(_0x199e58[_0x1c24f8(0x2c5)][_0x1c24f8(0x189)]>RAW_LOG_MAX_SIZE)_0x199e58[_0x1c24f8(0x2c5)][_0x1c24f8(0x194)](0x0,_0x199e58[_0x1c24f8(0x2c5)]['length']-RAW_LOG_MAX_SIZE);await _0x199e58[_0x1c24f8(0x1dd)](LTM_DP_RAW_LOG,{'val':JSON[_0x1c24f8(0x1d5)](_0x199e58['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x114bd1){const _0x1e5666=a0_0x41bffb;try{const _0x5d1180=await _0x114bd1[_0x1e5666(0x1e9)](LTM_DP_DAILY_DIGESTS);if(_0x5d1180&&_0x5d1180[_0x1e5666(0x2d0)])_0x114bd1[_0x1e5666(0x290)]=JSON[_0x1e5666(0x251)](_0x5d1180[_0x1e5666(0x2d0)]);}catch(_0x4f9d05){_0x114bd1['dailyDigests']=[];}await updateBaselineStatus(_0x114bd1);}async function saveDailyDigests(_0x352cc2,_0x3e908d=!![]){const _0x5d6775=a0_0x41bffb,_0x431bf8=_0x352cc2[_0x5d6775(0x19f)][_0x5d6775(0x218)]||0x3c;_0x352cc2[_0x5d6775(0x290)][_0x5d6775(0x189)]>_0x431bf8&&_0x352cc2['dailyDigests'][_0x5d6775(0x194)](0x0,_0x352cc2[_0x5d6775(0x290)][_0x5d6775(0x189)]-_0x431bf8);await _0x352cc2['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5d6775(0x1d5)](_0x352cc2['dailyDigests']),'ack':!![]});if(_0x3e908d)await updateBaselineStatus(_0x352cc2);}async function updateAnalysisHistory(_0x2c447e,_0x168ca4){const _0x4895e3=a0_0x41bffb;_0x2c447e['analysisHistory'][_0x4895e3(0x20e)](_0x168ca4);if(_0x2c447e['analysisHistory'][_0x4895e3(0x189)]>HISTORY_MAX_SIZE)_0x2c447e[_0x4895e3(0x1f5)][_0x4895e3(0x15c)]();await _0x2c447e[_0x4895e3(0x1dd)]('analysis.analysisHistory',{'val':JSON[_0x4895e3(0x1d5)](_0x2c447e[_0x4895e3(0x1f5)]),'ack':!![]});}async function updateBaselineStatus(_0x377d7e){const _0x44639c=a0_0x41bffb;if(!_0x377d7e[_0x44639c(0x2c4)]){await _0x377d7e[_0x44639c(0x1dd)](LTM_DP_BASELINE_STATUS,{'val':_0x44639c(0x2a9),'ack':!![]});return;}const _0x32e2a=_0x377d7e[_0x44639c(0x290)][_0x44639c(0x189)]>=(_0x377d7e[_0x44639c(0x19f)][_0x44639c(0x264)]||0x7)?'Aktiv\x20('+_0x377d7e['dailyDigests'][_0x44639c(0x189)]+_0x44639c(0x17e):_0x44639c(0x1c4)+_0x377d7e[_0x44639c(0x290)][_0x44639c(0x189)]+'/'+(_0x377d7e[_0x44639c(0x19f)][_0x44639c(0x264)]||0x7)+')';await _0x377d7e[_0x44639c(0x1dd)](LTM_DP_BASELINE_STATUS,{'val':_0x32e2a,'ack':!![]});}function a0_0x22a3(_0x421e98,_0x5b2c84){const _0x5e0058=a0_0x374c();return a0_0x22a3=function(_0x4e856a,_0x40e1f5){_0x4e856a=_0x4e856a-0x13c;let _0x374c56=_0x5e0058[_0x4e856a];return _0x374c56;},a0_0x22a3(_0x421e98,_0x5b2c84);}async function initSensorSubscriptions(_0x29ec48){const _0x831db5=a0_0x41bffb,_0x986426=_0x29ec48[_0x831db5(0x19f)][_0x831db5(0x2a2)];if(_0x986426)for(const _0x70f650 of _0x986426){await _0x29ec48[_0x831db5(0x1f3)](_0x70f650['id']);}}async function initPresenceSubscriptions(_0x36099c){const _0x260aca=a0_0x41bffb,_0x34c9fe=_0x36099c[_0x260aca(0x19f)][_0x260aca(0x242)];if(_0x34c9fe)for(const _0x1548d0 of _0x34c9fe){await _0x36099c['subscribeForeignStatesAsync'](_0x1548d0);}}async function setupTelegramListener(_0x36c9ff){const _0xd4f661=a0_0x41bffb,_0x4942c7=_0x36c9ff[_0xd4f661(0x19f)]['notifyTelegramInstance'];if(_0x36c9ff[_0xd4f661(0x19f)][_0xd4f661(0x2af)]&&_0x4942c7)await _0x36c9ff[_0xd4f661(0x1f3)](_0x4942c7+_0xd4f661(0x2ea));}async function checkWifiPresence(_0x2d6ed0){const _0x1cee85=a0_0x41bffb;try{const _0x5ecc9c=_0x2d6ed0[_0x1cee85(0x19f)][_0x1cee85(0x242)]||[];let _0x83511e=![];const _0x3931cc=[];for(const _0x327937 of _0x5ecc9c){try{const _0x1f0348=await _0x2d6ed0[_0x1cee85(0x203)](_0x327937);_0x1f0348&&(_0x1f0348['val']===!![]||_0x1f0348[_0x1cee85(0x2d0)]===_0x1cee85(0x1a1)||_0x1f0348['val']===0x1)&&(_0x83511e=!![],_0x3931cc[_0x1cee85(0x1b2)](_0x327937));}catch(_0x566de1){}}return await _0x2d6ed0['setStateAsync'](_0x1cee85(0x228),{'val':_0x3931cc['join'](',\x20'),'ack':!![]}),_0x83511e&&(_0x2d6ed0[_0x1cee85(0x239)]&&(_0x2d6ed0[_0x1cee85(0x281)][_0x1cee85(0x1b3)](_0x1cee85(0x263)),abortExitTimer(_0x2d6ed0)),!_0x2d6ed0[_0x1cee85(0x23c)]&&_0x2d6ed0['currentSystemMode']===SYSTEM_MODES[_0x1cee85(0x28a)]&&await setPresence(_0x2d6ed0,!![])),_0x83511e;}catch(_0x2cefbb){return![];}}function startExitTimer(_0x48be9b){const _0x420638=a0_0x41bffb;abortExitTimer(_0x48be9b),_0x48be9b['isGracePeriodActive']=!![],_0x48be9b['exitGraceTimer']=setTimeout(()=>{const _0x313cd3=a0_0x22a3;_0x48be9b[_0x313cd3(0x2b9)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x48be9b[_0x420638(0x239)]=setTimeout(()=>{const _0x57e5da=_0x420638;setPresence(_0x48be9b,![]),_0x48be9b[_0x57e5da(0x239)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x7d2f77){const _0x397909=a0_0x41bffb;if(_0x7d2f77[_0x397909(0x239)])clearTimeout(_0x7d2f77[_0x397909(0x239)]);if(_0x7d2f77['exitGraceTimer'])clearTimeout(_0x7d2f77[_0x397909(0x1b0)]);_0x7d2f77[_0x397909(0x239)]=null,_0x7d2f77['exitGraceTimer']=null,_0x7d2f77['isGracePeriodActive']=![];}async function setPresence(_0x48b365,_0x3545c8){const _0x4b27f6=a0_0x41bffb;if(_0x48b365[_0x4b27f6(0x23c)]===_0x3545c8)return;_0x48b365['isPresent']=_0x3545c8,await _0x48b365[_0x4b27f6(0x1dd)](_0x4b27f6(0x21c),{'val':_0x3545c8,'ack':!![]});}async function executeAutomationAction(_0x597cdc){const _0x149582=a0_0x41bffb;try{const _0x3b39a1=await _0x597cdc[_0x149582(0x1e9)]('analysis.automation.targetId'),_0x138c51=await _0x597cdc[_0x149582(0x1e9)](_0x149582(0x173));if(_0x3b39a1&&_0x3b39a1['val']&&_0x138c51){const _0x1969e6=_0x3b39a1[_0x149582(0x2d0)];let _0x1530a9=_0x138c51[_0x149582(0x2d0)];try{_0x1530a9=JSON[_0x149582(0x251)](_0x1530a9);}catch(_0x31cc43){}_0x597cdc[_0x149582(0x281)][_0x149582(0x1b3)](_0x149582(0x221)+_0x1969e6+_0x149582(0x1ca)+_0x1530a9),await _0x597cdc[_0x149582(0x2c9)](_0x1969e6,_0x1530a9);}else _0x597cdc['log'][_0x149582(0x288)](_0x149582(0x22c));}catch(_0x11854c){_0x597cdc[_0x149582(0x281)][_0x149582(0x1c2)](_0x149582(0x159)+_0x11854c['message']);}}async function processSensorEvent(_0x387cf6,_0x27b77d,_0x1feb70,_0x430049){const _0x4e8f9e=a0_0x41bffb;if(!_0x430049)return;const _0x1cf017=_0x1feb70[_0x4e8f9e(0x2d0)],_0x1875d1=Date[_0x4e8f9e(0x24f)](),_0x3455cb=_0x387cf6[_0x4e8f9e(0x1cb)][_0x27b77d];_0x387cf6[_0x4e8f9e(0x1cb)][_0x27b77d]=_0x1cf017;if(!_0x430049['logDuplicates']&&_0x3455cb!=undefined&&_0x3455cb==_0x1cf017)return;const _0x16c2cb=(_0x430049[_0x4e8f9e(0x157)]||'')[_0x4e8f9e(0x1d6)](),_0x587173=_0x16c2cb['includes'](_0x4e8f9e(0x2ac))||_0x16c2cb[_0x4e8f9e(0x19e)](_0x4e8f9e(0x2b2))||_0x16c2cb[_0x4e8f9e(0x19e)](_0x4e8f9e(0x16d))||_0x16c2cb[_0x4e8f9e(0x19e)]('heizung');_0x387cf6[_0x4e8f9e(0x2c4)]&&_0x587173&&recordThermodynamics(_0x387cf6,_0x27b77d,_0x1cf017,_0x430049[_0x4e8f9e(0x287)]);const _0x540420={'timestamp':_0x1875d1,'id':_0x27b77d,'name':_0x430049['name'],'type':_0x430049[_0x4e8f9e(0x157)],'location':_0x430049['location'],'value':_0x1cf017};_0x387cf6[_0x4e8f9e(0x16a)][_0x4e8f9e(0x20e)](_0x540420);if(_0x387cf6['eventHistory']['length']>HISTORY_MAX_SIZE)_0x387cf6[_0x4e8f9e(0x16a)][_0x4e8f9e(0x15c)]();await _0x387cf6[_0x4e8f9e(0x1dd)]('events.lastEvent',{'val':JSON[_0x4e8f9e(0x1d5)](_0x540420),'ack':!![]}),await _0x387cf6[_0x4e8f9e(0x1dd)](_0x4e8f9e(0x2eb),{'val':JSON['stringify'](_0x387cf6[_0x4e8f9e(0x16a)]),'ack':!![]});_0x387cf6['isProVersion']&&(_0x387cf6[_0x4e8f9e(0x2c5)][_0x4e8f9e(0x1b2)](_0x540420),await saveRawEventLog(_0x387cf6),recordSequence(_0x387cf6,_0x540420));if(_0x430049[_0x4e8f9e(0x19c)]&&_0x1cf017===!![]){if(_0x387cf6['isPresent']&&!_0x387cf6['isGracePeriodActive'])startExitTimer(_0x387cf6);else{if(!_0x387cf6['isPresent'])setPresence(_0x387cf6,!![]);}}else{if(_0x430049[_0x4e8f9e(0x157)]===_0x4e8f9e(0x2ce)&&_0x1cf017===!![]){if(_0x387cf6[_0x4e8f9e(0x239)])abortExitTimer(_0x387cf6);if(!_0x387cf6[_0x4e8f9e(0x23c)]&&_0x387cf6[_0x4e8f9e(0x1de)]===SYSTEM_MODES[_0x4e8f9e(0x28a)])setPresence(_0x387cf6,!![]);}}}async function recordThermodynamics(_0x3dfc68,_0x50c864,_0x450083,_0xa7ddc9){const _0x592901=a0_0x41bffb,_0x5b6699=await getOutsideTemperatureNumeric(_0x3dfc68),_0x2baefd=await _0x3dfc68['getStateAsync']('LTM.trainingData.thermodynamics');let _0x646f27=[];if(_0x2baefd&&_0x2baefd[_0x592901(0x2d0)])try{_0x646f27=JSON[_0x592901(0x251)](_0x2baefd[_0x592901(0x2d0)]);}catch(_0x3ce93b){}_0x646f27['push']({'ts':Date['now'](),'room':_0xa7ddc9||_0x592901(0x1bb),'t_in':_0x450083,'t_out':_0x5b6699});if(_0x646f27['length']>THERMO_LOG_SIZE)_0x646f27['shift']();await _0x3dfc68[_0x592901(0x1dd)](_0x592901(0x14f),{'val':JSON[_0x592901(0x1d5)](_0x646f27),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x39b06a){const _0x42efef=a0_0x41bffb;if(_0x39b06a[_0x42efef(0x19f)][_0x42efef(0x1d2)])try{const _0x1264df=await _0x39b06a[_0x42efef(0x203)](_0x39b06a['config'][_0x42efef(0x1d2)]);if(_0x1264df&&_0x1264df[_0x42efef(0x2d0)]!==undefined&&_0x1264df[_0x42efef(0x2d0)]!==null)return parseFloat(_0x1264df[_0x42efef(0x2d0)]);}catch(_0x51ec37){}const _0x5f15aa=_0x39b06a[_0x42efef(0x19f)][_0x42efef(0x225)];if(!_0x39b06a['config'][_0x42efef(0x21b)]||!_0x5f15aa)return null;try{let _0x561815='';if(_0x5f15aa[_0x42efef(0x19e)](_0x42efef(0x247)))_0x561815=_0x5f15aa+_0x42efef(0x187);else{if(_0x5f15aa[_0x42efef(0x19e)]('daswetter'))_0x561815=_0x5f15aa+_0x42efef(0x19b);else{if(_0x5f15aa[_0x42efef(0x19e)](_0x42efef(0x1df)))_0x561815=_0x5f15aa+_0x42efef(0x18e);else{if(_0x5f15aa['includes'](_0x42efef(0x17a)))_0x561815=_0x5f15aa+_0x42efef(0x29c);}}}if(_0x561815){const _0x1afb05=await _0x39b06a[_0x42efef(0x203)](_0x561815);if(_0x1afb05&&_0x1afb05[_0x42efef(0x2d0)]!==undefined&&_0x1afb05['val']!==null)return parseFloat(_0x1afb05[_0x42efef(0x2d0)]);}}catch(_0x46f4eb){}return null;}async function recordSequence(_0x35c114,_0x3fde57){const _0x30a221=a0_0x41bffb,_0x13c4f0=(_0x3fde57['type']||'')['toLowerCase'](),_0x27b3e7=[_0x30a221(0x2ce),_0x30a221(0x1f1),_0x30a221(0x1f6),'presence',_0x30a221(0x2d5),_0x30a221(0x1e3),'t√ºr',_0x30a221(0x1fe),_0x30a221(0x1e1),_0x30a221(0x231),_0x30a221(0x1f9),_0x30a221(0x2e6),_0x30a221(0x2a7),_0x30a221(0x1e2),_0x30a221(0x2de),_0x30a221(0x208),_0x30a221(0x2ab)];if(!_0x27b3e7[_0x30a221(0x162)](_0x93c979=>_0x13c4f0[_0x30a221(0x19e)](_0x93c979)))return;if(!_0x3fde57[_0x30a221(0x1d7)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x30a221(0x1b2)]({'loc':_0x3fde57[_0x30a221(0x287)]||'Unknown','id':_0x3fde57['id'],'ts':Date[_0x30a221(0x24f)]()}),sequenceTimer=setTimeout(async()=>{const _0x8cd3ea=_0x30a221;if(activeSequence[_0x8cd3ea(0x189)]>0x1)await saveCompletedSequence(_0x35c114);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x2095d0){const _0x225ecc=a0_0x41bffb;try{const _0x505c01=await _0x2095d0[_0x225ecc(0x1e9)](_0x225ecc(0x2db));let _0x19b065=[];if(_0x505c01&&_0x505c01[_0x225ecc(0x2d0)])try{_0x19b065=JSON[_0x225ecc(0x251)](_0x505c01[_0x225ecc(0x2d0)]);}catch(_0xdd5e61){}const _0x3bbc08=activeSequence[0x0]['ts'],_0x3dd188=activeSequence[_0x225ecc(0x217)](_0x58f80e=>({'loc':_0x58f80e[_0x225ecc(0x19a)],'t_delta':Math[_0x225ecc(0x16e)]((_0x58f80e['ts']-_0x3bbc08)/0x3e8)})),_0x4c314c={'timestamp':new Date(_0x3bbc08)[_0x225ecc(0x2cf)](),'steps':_0x3dd188,'duration':Math[_0x225ecc(0x16e)]((activeSequence[activeSequence[_0x225ecc(0x189)]-0x1]['ts']-_0x3bbc08)/0x3e8),'daytime':new Date(_0x3bbc08)[_0x225ecc(0x1fb)]()};_0x19b065[_0x225ecc(0x1b2)](_0x4c314c);if(_0x19b065['length']>MAX_TRAINING_SET_SIZE)_0x19b065[_0x225ecc(0x1b7)]();await _0x2095d0[_0x225ecc(0x1dd)](_0x225ecc(0x2db),{'val':JSON[_0x225ecc(0x1d5)](_0x19b065),'ack':!![]}),runSecurityCheck(_0x2095d0,_0x4c314c);}catch(_0x1364b5){_0x2095d0['log'][_0x225ecc(0x1c2)](_0x225ecc(0x253)+_0x1364b5['message']);}}function runSecurityCheck(_0x125bfa,_0x5b3c16){const _0x539528=a0_0x41bffb;if(!_0x125bfa[_0x539528(0x2c4)])return;sendToPython(_0x125bfa,_0x539528(0x2b4),{'sequence':_0x5b3c16});}async function createDailyDigest(_0x33b9bd){const _0x26db1d=a0_0x41bffb;if(!_0x33b9bd['isProVersion'])return;await _0x33b9bd['setStateAsync'](LTM_DP_STATUS,{'val':_0x26db1d(0x22a),'ack':!![]});if(!_0x33b9bd[_0x26db1d(0x234)]||_0x33b9bd[_0x26db1d(0x2c5)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x33b9bd[_0x26db1d(0x1dd)](LTM_DP_STATUS,{'val':_0x26db1d(0x15a),'ack':!![]});return;}const _0x4639d2=JSON['parse'](JSON[_0x26db1d(0x1d5)](_0x33b9bd[_0x26db1d(0x2c5)])),_0x6c4316=_0x4639d2[_0x26db1d(0x189)],_0x14a32e=_0x26db1d(0x2e5)+JSON[_0x26db1d(0x1d5)](_0x4639d2);try{const _0xacdfdd=await _0x33b9bd[_0x26db1d(0x234)]['generateContent'](_0x14a32e),_0x12477=JSON[_0x26db1d(0x251)](_0xacdfdd[_0x26db1d(0x222)]['text']()[_0x26db1d(0x156)](/```json|```/g,'')[_0x26db1d(0x2a3)]()),_0x5e3bb5={'timestamp':new Date()['toISOString'](),'eventCount':_0x6c4316,'summary':_0x12477[_0x26db1d(0x274)]||'Digest','activityLevel':_0x12477[_0x26db1d(0x154)]||_0x26db1d(0x2d7),'systemMode':_0x33b9bd[_0x26db1d(0x1de)]};_0x33b9bd[_0x26db1d(0x290)]['push'](_0x5e3bb5),await saveDailyDigests(_0x33b9bd),_0x33b9bd[_0x26db1d(0x2c5)]=[],await saveRawEventLog(_0x33b9bd),await _0x33b9bd[_0x26db1d(0x1dd)](LTM_DP_STATUS,{'val':_0x26db1d(0x2ad),'ack':!![]});if(_0x33b9bd[_0x26db1d(0x2c4)])sendToPython(_0x33b9bd,'ANALYZE_HEALTH',{'digest':_0x5e3bb5});}catch(_0x5f50ab){_0x33b9bd[_0x26db1d(0x281)]['error'](_0x5f50ab[_0x26db1d(0x1ae)]);}}async function runGeminiAnalysis(_0x5ee263,_0x437259=''){const _0x354212=a0_0x41bffb;if(!_0x5ee263[_0x354212(0x234)])return;if(_0x5ee263[_0x354212(0x16a)]['length']===0x0)return;const _0x1d75f3=_0x5ee263[_0x354212(0x16a)][_0x354212(0x23e)](0x0,0xf),_0x8e917d=await getWeatherContext(_0x5ee263),_0x5161c7=_0x5ee263['currentSystemMode'],_0x66bc0c=PERSONA_MAPPING[_0x5ee263['config'][_0x354212(0x1be)]||_0x354212(0x25c)],_0x56a230=_0x5ee263[_0x354212(0x19f)][_0x354212(0x1ef)]||_0x354212(0x1e6);let _0x1eaab2=_0x354212(0x220);try{const _0x3e35cf=await _0x5ee263[_0x354212(0x1e9)](_0x354212(0x228));if(_0x3e35cf&&_0x3e35cf[_0x354212(0x2d0)])_0x1eaab2=_0x3e35cf['val'];}catch(_0xaedc86){}let _0x3df660=![];try{const _0x5a20e7=await _0x5ee263[_0x354212(0x1e9)]('analysis.automation.autoApply');if(_0x5a20e7&&_0x5a20e7['val'])_0x3df660=!![];}catch(_0x250c9d){}const _0x292a0a=_0x354212(0x232)+_0x66bc0c+_0x354212(0x1ba)+_0x56a230+_0x354212(0x209)+_0x5161c7+_0x354212(0x13d)+_0x8e917d+'.\x20ANWESEND:\x20'+_0x1eaab2+'.\x20EVENTS:\x20'+JSON['stringify'](_0x1d75f3)+_0x354212(0x1d0)+_0x437259+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{const _0x28b001=await _0x5ee263[_0x354212(0x234)]['generateContent'](_0x292a0a),_0x1f74b0=JSON[_0x354212(0x251)](_0x28b001[_0x354212(0x222)][_0x354212(0x24c)]()[_0x354212(0x156)](/```json|```/g,'')[_0x354212(0x2a3)]());await _0x5ee263[_0x354212(0x1dd)](_0x354212(0x1d3),{'val':JSON['stringify'](_0x1f74b0),'ack':!![]});if(_0x1f74b0[_0x354212(0x274)])await _0x5ee263[_0x354212(0x1dd)](_0x354212(0x289),{'val':_0x1f74b0[_0x354212(0x274)],'ack':!![]});const _0x2b24ca={'timestamp':Date[_0x354212(0x24f)](),'id':Date[_0x354212(0x24f)]()[_0x354212(0x2c0)](),'analysis':{'activity':{'summary':_0x1f74b0[_0x354212(0x274)],'isAlert':_0x1f74b0[_0x354212(0x235)],'alertReason':_0x1f74b0[_0x354212(0x200)]},'comfort':{'automationProposal':_0x1f74b0[_0x354212(0x1bc)]}}};await updateAnalysisHistory(_0x5ee263,_0x2b24ca);const _0x7ca48c=_0x1f74b0[_0x354212(0x235)]||![];_0x7ca48c!==_0x5ee263[_0x354212(0x14d)]&&(await _0x5ee263[_0x354212(0x1dd)](_0x354212(0x272),{'val':_0x7ca48c,'ack':!![]}),_0x5ee263[_0x354212(0x14d)]=_0x7ca48c,_0x7ca48c&&(await _0x5ee263[_0x354212(0x1dd)](_0x354212(0x1dc),{'val':_0x1f74b0[_0x354212(0x200)],'ack':!![]}),sendNotification(_0x5ee263,'‚ö†Ô∏è\x20ALARM:\x20'+_0x1f74b0[_0x354212(0x200)],![],_0x1f74b0[_0x354212(0x26f)])));if(_0x1f74b0[_0x354212(0x1bc)]&&_0x1f74b0[_0x354212(0x1bc)][_0x354212(0x27f)]){await _0x5ee263[_0x354212(0x1dd)](_0x354212(0x294),{'val':!![],'ack':!![]}),await _0x5ee263[_0x354212(0x1dd)](_0x354212(0x2bc),{'val':_0x1f74b0[_0x354212(0x1bc)]['description'],'ack':!![]}),await _0x5ee263[_0x354212(0x1dd)](_0x354212(0x16f),{'val':_0x1f74b0[_0x354212(0x1bc)]['targetId'],'ack':!![]}),await _0x5ee263[_0x354212(0x1dd)](_0x354212(0x173),{'val':JSON[_0x354212(0x1d5)](_0x1f74b0[_0x354212(0x1bc)][_0x354212(0x17f)]),'ack':!![]});if(_0x3df660)executeAutomationAction(_0x5ee263);}}catch(_0xf823cf){_0x5ee263[_0x354212(0x281)][_0x354212(0x1c2)](_0x354212(0x182)+_0xf823cf[_0x354212(0x1ae)]);}}function stopPythonService(_0x265d45){const _0x5439a8=a0_0x41bffb;if(_0x265d45['pythonProcess']){try{_0x265d45[_0x5439a8(0x268)]['kill']();}catch(_0x536c23){}_0x265d45[_0x5439a8(0x268)]=null;}}function a0_0x374c(){const _0x1dcd3b=['‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','parse','button','[RECORDER]\x20Error:\x20','analysis.health.isAnomaly','96348AapFhm','ANALYZE_TREND','city','channel','bin','‚ö†Ô∏è\x20Python\x20VENV\x20or\x20PIP\x20missing.\x20Installing...','values','generic','Daily\x20Digests','Description','ltmJob','Auto\x20Apply','Creating\x20new\x20VENV...','t√ºr','WiFi\x20Presence\x20detected.','minDaysForBaseline','COMFORT_RESULT','BUILD_TOPOLOGY','Security\x20Monitor','pythonProcess','analysis.analysisHistory','floor','unload','Who\x20is\x20present?','name','3425715OSirJm','isEmergency','Error\x20launching\x20Python:\x20','python_service','analysis.isAlert','üï∏Ô∏è\x20Topology\x20Map\x20updated.','summary','373728hPsRKz','PREDICT_ENERGY','system.config','\x22\x20-c\x20\x22import\x20tensorflow;\x20print(\x27libs_ok\x27)\x22','heating','PRIORIT√ÑT:\x20Sicherheit.','analysis.training','Alert\x20Reason','driftAnalysisTimer','ltmStbWindowDays','detected','split','log','‚úÖ\x20Fast-Boot:\x20Environment\x20healthy.\x20Skipping\x20installation.','analysis.automation.autoApply','namespace','keys','Today\x20Vector\x20(15m)','location','warn','analysis.activitySummary','NORMAL','setObjectNotExistsAsync','application/json','ENERGY_TRAIN_RESULT','@google/generative-ai','N/A','dailyDigests','2IyCQXD','TRAIN_COMFORT','analysis.training.triggerSecurity','analysis.automation.patternDetected','stdout','GUEST','analysis.health.trendDiagnosis','‚úÖ\x20INSTALL\x20SUCCESS.','system.mode','analysis.training.status','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','.forecast.current.temp','has','insulation','üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','setState','threshold','devices','trim','confidence','Enum','analysis.triggerBriefing','licht','object','Deaktiviert\x20(Pro-Feature)','number','lampe','temperature','Success','cogni-living','notifyTelegramEnabled','doors','extendObjectAsync','temperatur','unknown','ANALYZE_SEQUENCE','‚ùå\x20INSTALL\x20FAILED:\x20','briefingJob','existsSync','Training\x20Error:\x20','isGracePeriodActive','Last\x20raw\x20event','HEALTH_RESULT','analysis.automation.description','licenseKey','Topology\x20Matrix','guest','toString','timestamp','join','SECURITY_RESULT','isProVersion','rawEventLog','targetId','python3\x20-m\x20venv\x20\x22','Installing\x20pip\x20packages...\x20(Caching\x20enabled)','setForeignStateAsync','LTM.driftAnalysis','stdin','Train\x20Energy','Thermodynamics','motion','toISOString','val','subscribeStates','automation.triggerAction','ANALYZE_GAIT','üï∏Ô∏è\x20Building\x20Topology\x20Matrix...','occupancy','triggerDailyDigest','normal','enum','analysis.energy.heatingScore','constructor','LTM.trainingData.sequences','Could\x20not\x20load\x20rooms:\x20','analysis.automation.triggerAction','schalter','analysis.health.todayVector','python','communicate.request','analysis.energy.insulationScore','diagnosis','EACCES','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','light','description','.venv','Build\x20Topology','.communicate.request','events.history','requirements.txt','.\x20WETTER:\x20','role','‚úÖ\x20HEALTH\x20TRAINED.','inactivityThresholdHours','Trigger\x20Action','payload','toFixed','üõãÔ∏è\x20BUTLER:\x20Found\x20','HEALTH_TRAIN_RESULT','indicator','heizung','endsWith','‚ö†Ô∏è\x20Fast-Boot\x20failed.\x20Triggering\x20Self-Healing...','debug','analysis.training.triggerComfort','change_percent','lastAlertState','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','LTM.trainingData.thermodynamics','search','Topology\x20Error:\x20','success','startsWith','activityLevel','autoApply','replace','type','simulateButler','BUTLER\x20Execution\x20Error:\x20','Skipped\x20(No\x20AI\x20or\x20Data)','4355TdPapk','pop','üëâ\x20L√ñSUNG\x20(SSH):\x20sudo\x20chown\x20-R\x20iobroker:iobroker\x20','analysis.health.lastCheck','üß™\x20Simulating\x20Butler\x20Proposal:\x20','main','üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','some','enum.rooms.*','ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...','Fokus\x20auf\x20Komfort.','Kein\x20API\x20Key!','1542lagqyt','common','getMonth','eventHistory','getFullYear','Trend\x20Value','klima','round','analysis.automation.targetId','analysis.security.currentThreshold','testApiKey','analysis.trigger','analysis.automation.targetValue','\x22\x20install\x20-r\x20\x22','Success:\x20','(((.+)+)+)+$','testContext','date','scanDevices','weatherunderground','ack','analysis.health','analysis.security.topologyMatrix','\x20Tage)','targetValue','sendTo','path','Gemini\x20Error:\x20','members','Activity-Level','286026dtxrwf','bind','.Current.Temperature','@iobroker/adapter-core','length','onMessage','Target\x20Value','getForeignObjectAsync','close','.forecast.current.temperature','python.exe','Sequences','LTM.rawEventLog','üîç\x20Scan\x20finished.\x20Found\x20','geminiApiKey','splice','Delete\x20failed:\x20','version','\x20candidates.','child_process','getDate','loc','.NextHours.Location_1.Day_1.current.temp_value','isExit','pip.exe','includes','config','analysis.energy','online','dependencyInstallInProgress','Trigger\x20Analysis','analysis.security.lastCheck','Adapter','Missing\x20data','add','presence','analysis.energy.forecast','party','latitude','1175696ywuIMu','forEach','message','generateContent','exitGraceTimer','command','push','info','onStateChange','0\x203\x20*\x20*\x20*','Training\x20Status','shift','Kein\x20API\x20Key.','VACATION','.\x20KONTEXT:\x20','Unknown','automationProposal','Regel\x20erkannt:\x20','aiPersona','Heuristic','Anomaly\x20Score','Sec-Training\x20started...','error','modeResetJob','Lernphase\x20(','Raw\x20Log','genAI','onUnload','onReady','setHours','\x20=\x20','sensorLastValues','LTM.processingStatus','Train\x20Security','\x20->\x20','substring','.\x20EMERGENCY:\x20','Target\x20ID','outdoorSensorId','analysis.lastResult','LTM.driftAnalysis.baselineDrift','stringify','toLowerCase','value','Fokus\x20auf\x20Familienroutinen.','analysis.training.triggerHealth','\x0aGrund:\x20','LTM.driftAnalysis.driftDetails','analysis.alertReason','setStateAsync','currentSystemMode','openweathermap','systemUUID','fenster','switch','door','‚ôªÔ∏è\x20Found\x20broken\x20VENV\x20(no\x20pip).\x20Deleting\x20and\x20recreating...','\x20new\x20patterns.','Keine\x20Details.','0\x204\x20*\x20*\x20*','exports','getStateAsync','üß†\x20Triggering\x20Security\x20Training...','LTM.triggerDailyDigest','AI\x20Training','triggerBriefing','üõë\x20PERMISSION\x20ERROR:\x20Der\x20Adapter\x20darf\x20das\x20VENV\x20nicht\x20anlegen.','livingContext','üêç\x20Python\x20Pong','bewegung','Heating\x20Score','subscribeForeignStatesAsync','getForeignObjectsAsync','analysisHistory','pr√§senz','User\x20dismissed\x20automation\x20proposal.','boolean','kontakt','Anomaly\x20Detected','getHours',')\x20-\x20SAFE\x20BOOT','LTM.dailyDigests','window','find','alertReason','models/gemini-flash-latest','getTime','getForeignStateAsync','undefined','Failed:\x20','rmSync','Permission\x20denied','dimmer','.\x20SYSTEM_MODE:\x20','Trigger\x20Briefing','Restoring\x20sensor\x20cache...','rule','Insulation\x20Score','unshift','OK:\x20','.\x20(Is\x20\x27python3-venv\x27\x20installed?\x20\x27sudo\x20apt\x20install\x20python3-venv\x27)','callback','LTM','No\x20instance','analysis.history_debug_00','Train\x20Health','details','map','ltmLtbWindowDays','stateChange','thermostat','useWeather','system.isPresent','analysis.training.triggerTopology','analysis.training.triggerEnergy','json','Unbekannt','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','response','Last\x20Check','selectedFunctionIds','weatherInstance','analysis.health.trendValue','getMinutes','system.presenceWho','reason','Started...','python3','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','getGenerativeModel','analysis.security.lastScore','PONG','string','contact','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','getOverviewData','geminiModel','isAlert','cancel','Gemini\x20AI\x20initialized.','KI-Modell\x20nicht\x20initialisiert','exitTimer','write','from','isPresent','submitFeedback','slice','analysis.automation.detectedPatterns','systemConfig','analysisTimer','presenceDevices','üîç\x20Scanning\x20for\x20devices\x20(Aggressive\x20Parent\x20Lookup)...','Event\x20History','Scripts','Analysiere\x20ausgewogen.','accuweather','Activity\x20Summary','1019520CpHqez','state','Alert\x20Status','text','üöÄ\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.9)...','instance','now'];a0_0x374c=function(){return _0x1dcd3b;};return a0_0x374c();}function sendToPython(_0xdf89d4,_0x3cb747,_0x261934={}){const _0x43f42e=a0_0x41bffb;if(!_0xdf89d4[_0x43f42e(0x268)]||!_0xdf89d4[_0x43f42e(0x268)]['stdin']['writable'])return;const _0x594307=JSON[_0x43f42e(0x1d5)]({'command':_0x3cb747,..._0x261934});try{_0xdf89d4[_0x43f42e(0x268)][_0x43f42e(0x2cb)][_0x43f42e(0x23a)](_0x594307+'\x0a');}catch(_0x4dd720){}}function runPythonHealthCheck(_0x476c7e){const _0x515373=a0_0x41bffb;if(!_0x476c7e['dailyDigests']||_0x476c7e[_0x515373(0x290)][_0x515373(0x189)]<0x2)return;const _0x297068=_0x476c7e['dailyDigests'][_0x515373(0x217)](_0x37c3c0=>{const _0x156434=_0x515373,_0x896133=(_0x37c3c0[_0x156434(0x154)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x896133]||0x32;});sendToPython(_0x476c7e,_0x515373(0x256),{'values':_0x297068,'tag':_0x515373(0x184)});}function handlePythonResult(_0x1e7ed0,_0x33934f){const _0x144f49=a0_0x41bffb;if(_0x33934f[_0x144f49(0x157)]===_0x144f49(0x22f))_0x1e7ed0[_0x144f49(0x281)]['debug'](_0x144f49(0x1f0));else{if(_0x33934f[_0x144f49(0x157)]===_0x144f49(0x2c3)){const {anomaly_score:_0x53145f,is_anomaly:_0x5550eb,threshold:_0x352ff5,explanation:_0x2c62ec}=_0x33934f[_0x144f49(0x142)];_0x1e7ed0[_0x144f49(0x281)]['info']('üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20'+_0x53145f[_0x144f49(0x143)](0x5)+_0x144f49(0x1ce)+(_0x5550eb?'ANOMALY':'OK')),_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x22e),{'val':_0x53145f,'ack':!![]}),_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x1a4),{'val':new Date()[_0x144f49(0x2cf)](),'ack':!![]});if(_0x352ff5)_0x1e7ed0[_0x144f49(0x1dd)]('analysis.security.currentThreshold',{'val':_0x352ff5,'ack':!![]});if(_0x5550eb){let _0x383e9c=_0x144f49(0x14e)+_0x53145f['toFixed'](0x4)+')';if(_0x2c62ec&&_0x2c62ec!=='Unknown')_0x383e9c+=_0x144f49(0x1da)+_0x2c62ec;_0x1e7ed0['setStateAsync']('analysis.isAlert',{'val':!![],'ack':!![]}),_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x1dc),{'val':_0x383e9c,'ack':!![]}),sendNotification(_0x1e7ed0,_0x144f49(0x250)+_0x383e9c,![],!![]);}}else{if(_0x33934f['type']==='TRAINING_COMPLETE'){const _0xae83de=_0x33934f[_0x144f49(0x142)][_0x144f49(0x216)]||'',_0x54c8bf=_0x33934f[_0x144f49(0x142)][_0x144f49(0x2a1)],_0x2c7ab3=_0x33934f[_0x144f49(0x142)][_0x144f49(0x152)]?_0x144f49(0x175)+new Date()['toLocaleTimeString']()+'\x20('+_0xae83de+')':_0x144f49(0x205)+_0x33934f[_0x144f49(0x142)][_0x144f49(0x229)];_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x29a),{'val':_0x2c7ab3,'ack':!![]});if(_0x33934f[_0x144f49(0x142)][_0x144f49(0x152)]&&_0x54c8bf)_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x170),{'val':_0x54c8bf,'ack':!![]});}else{if(_0x33934f[_0x144f49(0x157)]===_0x144f49(0x265)){const {patterns:_0x5e622b}=_0x33934f['payload'];if(_0x5e622b&&_0x5e622b['length']>0x0){_0x1e7ed0[_0x144f49(0x281)][_0x144f49(0x1b3)](_0x144f49(0x144)+_0x5e622b[_0x144f49(0x189)]+_0x144f49(0x1e5)),_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x23f),{'val':JSON[_0x144f49(0x1d5)](_0x5e622b),'ack':!![]});const _0x34a062=_0x5e622b[0x0],_0x19289d=_0x144f49(0x1bd)+_0x34a062[_0x144f49(0x20c)]+'\x20('+(_0x34a062[_0x144f49(0x2a4)]*0x64)[_0x144f49(0x143)](0x0)+'%)';_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x294),{'val':!![],'ack':!![]}),_0x1e7ed0['setStateAsync']('analysis.automation.description',{'val':_0x19289d,'ack':!![]});}else _0x1e7ed0[_0x144f49(0x281)][_0x144f49(0x1b3)](_0x144f49(0x29f)),_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x294),{'val':![],'ack':!![]}),_0x1e7ed0[_0x144f49(0x1dd)]('analysis.automation.detectedPatterns',{'val':'[]','ack':!![]});}else{if(_0x33934f[_0x144f49(0x157)]===_0x144f49(0x28d)){if(_0x33934f['payload']['success'])try{const _0x280675=JSON[_0x144f49(0x251)](_0x33934f[_0x144f49(0x142)]['details']);if(_0x280675[_0x144f49(0x29e)])_0x1e7ed0['setStateAsync'](_0x144f49(0x2e2),{'val':JSON[_0x144f49(0x1d5)](_0x280675[_0x144f49(0x29e)]),'ack':!![]});if(_0x280675[_0x144f49(0x279)])_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x2d9),{'val':JSON[_0x144f49(0x1d5)](_0x280675[_0x144f49(0x279)]),'ack':!![]});}catch(_0x158ef3){}}else{if(_0x33934f[_0x144f49(0x157)]===_0x144f49(0x145)){if(_0x33934f['payload'][_0x144f49(0x152)])_0x1e7ed0[_0x144f49(0x281)][_0x144f49(0x1b3)](_0x144f49(0x13f));}else{if(_0x33934f['type']===_0x144f49(0x2bb))_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x15e),{'val':new Date()[_0x144f49(0x2cf)](),'ack':!![]}),_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x254),{'val':_0x33934f['payload']['is_anomaly'],'ack':!![]});else{if(_0x33934f[_0x144f49(0x157)]==='TREND_RESULT')_0x1e7ed0['setStateAsync'](_0x144f49(0x297),{'val':_0x33934f[_0x144f49(0x142)][_0x144f49(0x2e3)],'ack':!![]}),_0x1e7ed0['setStateAsync'](_0x144f49(0x226),{'val':_0x33934f[_0x144f49(0x142)][_0x144f49(0x14c)],'ack':!![]});else{if(_0x33934f[_0x144f49(0x157)]==='GAIT_RESULT'){const {speed_trend:_0x46f4fc}=_0x33934f[_0x144f49(0x142)];if(_0x46f4fc!==undefined)_0x1e7ed0[_0x144f49(0x1dd)]('analysis.health.gaitSpeed',{'val':_0x46f4fc,'ack':!![]});}else{if(_0x33934f[_0x144f49(0x157)]==='ENERGY_PREDICT_RESULT'){const {forecast:_0x15ab35}=_0x33934f[_0x144f49(0x142)];if(_0x15ab35)_0x1e7ed0['setStateAsync'](_0x144f49(0x1a9),{'val':JSON[_0x144f49(0x1d5)](_0x15ab35),'ack':!![]});}else{if(_0x33934f[_0x144f49(0x157)]==='TOPOLOGY_RESULT'){const {data:_0xeeaf53}=_0x33934f[_0x144f49(0x142)];_0xeeaf53&&(_0x1e7ed0['log'][_0x144f49(0x1b3)](_0x144f49(0x273)),_0x1e7ed0[_0x144f49(0x1dd)](_0x144f49(0x17d),{'val':JSON[_0x144f49(0x1d5)](_0xeeaf53),'ack':!![]}));}}}}}}}}}}}}function startPythonService(_0x4985e3){const _0x188a9e=a0_0x41bffb;let _0x216926=_0x188a9e(0x22b);if(fs['existsSync'](PYTHON_EXE))_0x216926=PYTHON_EXE;try{const _0x44bafa=path[_0x188a9e(0x2c2)](__dirname,_0x188a9e(0x271),'service.py');_0x4985e3['pythonProcess']=spawn(_0x216926,[_0x44bafa]),_0x4985e3['pythonProcess'][_0x188a9e(0x295)]['on']('data',_0x6a7205=>{const _0x3a41ec=_0x188a9e,_0x2149d0=_0x6a7205[_0x3a41ec(0x2c0)]()[_0x3a41ec(0x280)]('\x0a');_0x2149d0[_0x3a41ec(0x1ad)](_0x1fe419=>{const _0x3a7a07=_0x3a41ec,_0x378fb=_0x1fe419[_0x3a7a07(0x2a3)]();if(!_0x378fb)return;if(_0x378fb[_0x3a7a07(0x153)]('[LOG]'))_0x4985e3[_0x3a7a07(0x281)][_0x3a7a07(0x14a)]('[PYTHON]\x20'+_0x378fb[_0x3a7a07(0x1cf)](0x5)['trim']());else{if(_0x378fb[_0x3a7a07(0x153)]('[RESULT]'))try{const _0x777bd1=JSON[_0x3a7a07(0x251)](_0x378fb[_0x3a7a07(0x1cf)](0x8)['trim']());handlePythonResult(_0x4985e3,_0x777bd1);}catch(_0x4526fb){}}});}),_0x4985e3[_0x188a9e(0x268)]['on'](_0x188a9e(0x18d),_0x21bcaa=>{const _0x5194c3=_0x188a9e;_0x4985e3[_0x5194c3(0x268)]=null;});}catch(_0x328111){_0x4985e3['log']['error'](_0x188a9e(0x270)+_0x328111[_0x188a9e(0x1ae)]);}}async function runAutopilot(_0x10e054){const _0x118159=a0_0x41bffb;_0x10e054[_0x118159(0x281)][_0x118159(0x14a)](_0x118159(0x164)),await runGeminiAnalysis(_0x10e054),updateHealthVector(_0x10e054),triggerGaitAnalysis(_0x10e054),triggerEnergyPrediction(_0x10e054);}async function triggerGaitAnalysis(_0x2ebddf){const _0x3990f1=a0_0x41bffb;if(!_0x2ebddf['isProVersion'])return;try{const _0x6e3e6a=await _0x2ebddf[_0x3990f1(0x1e9)]('LTM.trainingData.sequences');_0x6e3e6a&&_0x6e3e6a[_0x3990f1(0x2d0)]&&sendToPython(_0x2ebddf,_0x3990f1(0x2d3),{'sequences':JSON[_0x3990f1(0x251)](_0x6e3e6a['val'])});}catch(_0x53f362){}}async function triggerEnergyPrediction(_0x3a76da){const _0x33ef4f=a0_0x41bffb;if(!_0x3a76da[_0x33ef4f(0x2c4)])return;try{const _0x39dbc5=await getOutsideTemperatureNumeric(_0x3a76da);if(_0x39dbc5===null)return;const _0x58b202={},_0x545673=_0x3a76da[_0x33ef4f(0x19f)]['devices']||[];for(const _0x3e9c77 of _0x545673){if(_0x3e9c77[_0x33ef4f(0x157)]===_0x33ef4f(0x2ac)&&_0x3e9c77['location']){const _0x4cb2a6=_0x3a76da[_0x33ef4f(0x1cb)][_0x3e9c77['id']];if(_0x4cb2a6!==undefined)_0x58b202[_0x3e9c77[_0x33ef4f(0x287)]]=_0x4cb2a6;}}Object[_0x33ef4f(0x285)](_0x58b202)[_0x33ef4f(0x189)]>0x0&&sendToPython(_0x3a76da,_0x33ef4f(0x276),{'current_temps':_0x58b202,'t_out':_0x39dbc5});}catch(_0x2a691a){}}function updateHealthVector(_0x492195){const _0x2817d8=a0_0x41bffb;if(!_0x492195[_0x2817d8(0x2c5)]||_0x492195[_0x2817d8(0x2c5)]['length']===0x0)return;const _0x3bbdc4=new Array(0x60)['fill'](0x0),_0x46cb5b=new Date()[_0x2817d8(0x1c9)](0x0,0x0,0x0,0x0);_0x492195[_0x2817d8(0x2c5)][_0x2817d8(0x1ad)](_0x23856d=>{const _0x35f413=_0x2817d8,_0x21b0c9=new Date(_0x23856d[_0x35f413(0x2c1)]);if(_0x21b0c9[_0x35f413(0x202)]()>=_0x46cb5b){const _0x103368=_0x21b0c9[_0x35f413(0x1fb)](),_0x381524=_0x21b0c9[_0x35f413(0x227)](),_0x18ee08=_0x103368*0x4+Math[_0x35f413(0x26a)](_0x381524/0xf);if(_0x18ee08>=0x0&&_0x18ee08<0x60)_0x3bbdc4[_0x18ee08]++;}}),_0x492195['setStateAsync'](_0x2817d8(0x2df),{'val':JSON[_0x2817d8(0x1d5)](_0x3bbdc4),'ack':!![]});}async function scanForDevices(_0x40b05a,_0x104d0f){const _0x43a0fd=a0_0x41bffb;_0x40b05a[_0x43a0fd(0x281)][_0x43a0fd(0x1b3)](_0x43a0fd(0x243));const _0x5d5ecb=[],_0xfb42c0=await _0x40b05a[_0x43a0fd(0x1f4)]('*'),_0x35ecda={};try{const _0x2e9dc1=await _0x40b05a['getForeignObjectsAsync'](_0x43a0fd(0x163),_0x43a0fd(0x2d8));for(const _0x436b34 in _0x2e9dc1){const _0x5952d9=_0x2e9dc1[_0x436b34],_0x4f88a3=(_0x5952d9[_0x43a0fd(0x168)]&&typeof _0x5952d9[_0x43a0fd(0x168)][_0x43a0fd(0x26d)]===_0x43a0fd(0x2a8)?_0x5952d9[_0x43a0fd(0x168)]['name']['de']:_0x5952d9[_0x43a0fd(0x168)]['name'])||_0x5952d9['common'][_0x43a0fd(0x26d)];if(_0x5952d9[_0x43a0fd(0x168)]&&_0x5952d9['common']['members'])for(const _0x25a7a4 of _0x5952d9[_0x43a0fd(0x168)][_0x43a0fd(0x183)]){_0x35ecda[_0x25a7a4]=_0x4f88a3;}}}catch(_0x23cca2){_0x40b05a[_0x43a0fd(0x281)][_0x43a0fd(0x288)](_0x43a0fd(0x2dc)+_0x23cca2['message']);}let _0x335a21=null,_0x579c9a={};if(_0x104d0f[_0x43a0fd(0x224)]&&_0x104d0f[_0x43a0fd(0x224)][_0x43a0fd(0x189)]>0x0){_0x335a21=new Set();for(const _0x25ca87 of _0x104d0f['selectedFunctionIds']){const _0xfb83f9=await _0x40b05a[_0x43a0fd(0x18c)](_0x25ca87);if(_0xfb83f9&&_0xfb83f9['common']&&_0xfb83f9[_0x43a0fd(0x168)][_0x43a0fd(0x183)]){let _0x3e3798=null;const _0x5350b8=_0x25ca87['toLowerCase']();if(_0x5350b8[_0x43a0fd(0x19e)](_0x43a0fd(0x2e6))||_0x5350b8['includes'](_0x43a0fd(0x2a7)))_0x3e3798=_0x43a0fd(0x2e6);else{if(_0x5350b8[_0x43a0fd(0x19e)](_0x43a0fd(0x279))||_0x5350b8['includes'](_0x43a0fd(0x147)))_0x3e3798=_0x43a0fd(0x2ac);else{if(_0x5350b8[_0x43a0fd(0x19e)](_0x43a0fd(0x1fe))||_0x5350b8[_0x43a0fd(0x19e)](_0x43a0fd(0x1e1)))_0x3e3798=_0x43a0fd(0x1e3);}}for(const _0x385e72 of _0xfb83f9[_0x43a0fd(0x168)]['members']){_0x335a21[_0x43a0fd(0x1a7)](_0x385e72);if(_0x3e3798)_0x579c9a[_0x385e72]=_0x3e3798;}}}}for(const _0x92ecc2 in _0xfb42c0){const _0x2c18f8=_0xfb42c0[_0x92ecc2];if(_0x2c18f8&&_0x2c18f8['common']&&_0x2c18f8[_0x43a0fd(0x157)]===_0x43a0fd(0x24a)){let _0x41883d=![],_0x414fea=null;if(_0x335a21){if(_0x335a21[_0x43a0fd(0x29d)](_0x92ecc2))_0x41883d=!![];else{const _0x5be2bc=_0x92ecc2[_0x43a0fd(0x280)]('.'),_0x45e1cd=_0x5be2bc[_0x43a0fd(0x23e)](0x0,-0x1)[_0x43a0fd(0x2c2)]('.'),_0x3a289b=_0x5be2bc[_0x43a0fd(0x23e)](0x0,-0x2)['join']('.');if(_0x335a21['has'](_0x45e1cd)){_0x41883d=!![];if(_0x579c9a[_0x45e1cd])_0x414fea=_0x579c9a[_0x45e1cd];}else{if(_0x335a21[_0x43a0fd(0x29d)](_0x3a289b)){_0x41883d=!![];if(_0x579c9a[_0x3a289b])_0x414fea=_0x579c9a[_0x3a289b];}}}}if(_0x414fea)_0x579c9a[_0x92ecc2]=_0x414fea;const _0x2b7f96=(_0x2c18f8[_0x43a0fd(0x168)][_0x43a0fd(0x26d)]&&typeof _0x2c18f8[_0x43a0fd(0x168)][_0x43a0fd(0x26d)]===_0x43a0fd(0x2a8)?_0x2c18f8[_0x43a0fd(0x168)][_0x43a0fd(0x26d)]['de']:_0x2c18f8['common'][_0x43a0fd(0x26d)])||'',_0x24beaf=(_0x2c18f8[_0x43a0fd(0x168)][_0x43a0fd(0x13e)]||'')['toLowerCase'](),_0x321d88=_0x2b7f96['toLowerCase']();if(!_0x414fea){if(_0x104d0f[_0x43a0fd(0x2ce)]&&(_0x24beaf[_0x43a0fd(0x19e)]('motion')||_0x321d88[_0x43a0fd(0x19e)](_0x43a0fd(0x1f1))||_0x24beaf[_0x43a0fd(0x19e)](_0x43a0fd(0x1a8))))_0x414fea='motion';else{if(_0x104d0f[_0x43a0fd(0x2b0)]&&(_0x24beaf[_0x43a0fd(0x19e)]('door')||_0x24beaf['includes']('window')||_0x321d88[_0x43a0fd(0x19e)](_0x43a0fd(0x262))||_0x321d88['includes'](_0x43a0fd(0x1e1))||_0x24beaf['includes'](_0x43a0fd(0x231))))_0x414fea=_0x43a0fd(0x1e3);else{if(_0x104d0f['lights']&&(_0x24beaf[_0x43a0fd(0x19e)](_0x43a0fd(0x2e6))||_0x24beaf[_0x43a0fd(0x19e)](_0x43a0fd(0x1e2))||_0x321d88[_0x43a0fd(0x19e)]('licht')||_0x24beaf[_0x43a0fd(0x19e)]('level.dimmer')))_0x414fea=_0x43a0fd(0x2e6);else{if(_0x104d0f['temperature']&&(_0x24beaf[_0x43a0fd(0x19e)](_0x43a0fd(0x2ac))||_0x321d88[_0x43a0fd(0x19e)]('temperatur')||_0x24beaf[_0x43a0fd(0x19e)](_0x43a0fd(0x21a))))_0x414fea=_0x43a0fd(0x2ac);}}}}if((_0x41883d||_0x414fea)&&_0x414fea){let _0x499282=_0x2b7f96||_0x92ecc2;const _0x4ce893=_0x92ecc2[_0x43a0fd(0x280)]('.');let _0xab5aca=![];const _0x398eba=_0x4ce893['slice'](0x0,-0x1)[_0x43a0fd(0x2c2)]('.'),_0x365d7c=_0xfb42c0[_0x398eba];if(_0x365d7c&&_0x365d7c[_0x43a0fd(0x168)]&&_0x365d7c['common'][_0x43a0fd(0x26d)]){let _0x250750=(typeof _0x365d7c[_0x43a0fd(0x168)][_0x43a0fd(0x26d)]==='object'?_0x365d7c['common']['name']['de']:_0x365d7c[_0x43a0fd(0x168)][_0x43a0fd(0x26d)])||'';_0x250750&&_0x250750!=='undefined'&&(!_0x250750[_0x43a0fd(0x1d6)]()['includes'](_0x43a0fd(0x258))&&_0x250750!==_0x398eba[_0x43a0fd(0x280)]('.')[_0x43a0fd(0x15c)]()&&(_0x499282=_0x250750+'\x20('+(_0x2b7f96||_0x92ecc2[_0x43a0fd(0x280)]('.')[_0x43a0fd(0x15c)]())+')',_0xab5aca=!![]));}if(!_0xab5aca){const _0x12f015=_0x4ce893[_0x43a0fd(0x23e)](0x0,-0x2)[_0x43a0fd(0x2c2)]('.'),_0x45e52f=_0xfb42c0[_0x12f015];if(_0x45e52f&&_0x45e52f['common']&&_0x45e52f[_0x43a0fd(0x168)]['name']){let _0x1b350d=(typeof _0x45e52f[_0x43a0fd(0x168)]['name']===_0x43a0fd(0x2a8)?_0x45e52f[_0x43a0fd(0x168)][_0x43a0fd(0x26d)]['de']:_0x45e52f[_0x43a0fd(0x168)]['name'])||'';_0x1b350d&&_0x1b350d!==_0x43a0fd(0x204)&&(_0x499282=_0x1b350d+'\x20('+(_0x2b7f96||_0x92ecc2[_0x43a0fd(0x280)]('.')['pop']())+')');}}let _0x92d14e=_0x35ecda[_0x92ecc2];if(!_0x92d14e){const _0x2752e9=_0x92ecc2[_0x43a0fd(0x280)]('.')['slice'](0x0,-0x1)[_0x43a0fd(0x2c2)]('.');_0x92d14e=_0x35ecda[_0x2752e9];}if(!_0x92d14e){const _0x3f9128=_0x92ecc2[_0x43a0fd(0x280)]('.')[_0x43a0fd(0x23e)](0x0,-0x2)[_0x43a0fd(0x2c2)]('.');_0x92d14e=_0x35ecda[_0x3f9128];}if(!_0x92d14e){if(_0x4ce893[_0x43a0fd(0x189)]>0x2)_0x92d14e=_0x4ce893[0x2];}const _0x694b00=_0x41883d?0x5a:0x32,_0x967a3f=_0x41883d?_0x43a0fd(0x2a5):_0x43a0fd(0x1bf);_0x5d5ecb['push']({'id':_0x92ecc2,'name':_0x499282,'type':_0x414fea,'location':_0x92d14e||'','_score':_0x694b00,'_source':_0x967a3f});}}}return _0x40b05a[_0x43a0fd(0x281)][_0x43a0fd(0x1b3)](_0x43a0fd(0x192)+_0x5d5ecb[_0x43a0fd(0x189)]+_0x43a0fd(0x197)),_0x5d5ecb;}function installRequirementsInVenv(_0x5ee56,_0x4f4ea8){const _0x575670=a0_0x41bffb;_0x5ee56[_0x575670(0x281)][_0x575670(0x1b3)](_0x575670(0x2c8));const _0x15091c='\x22'+PIP_EXE+_0x575670(0x174)+_0x4f4ea8+'\x22';exec(_0x15091c,{'timeout':0x1b7740},(_0x259d7f,_0x3456dc,_0x3a1171)=>{const _0x31d016=_0x575670;_0x5ee56[_0x31d016(0x1a2)]=![];if(_0x259d7f){_0x5ee56[_0x31d016(0x281)][_0x31d016(0x1c2)](_0x31d016(0x2b5)+(_0x3a1171||_0x259d7f[_0x31d016(0x1ae)]));try{fs[_0x31d016(0x206)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x4881c7){}}else _0x5ee56[_0x31d016(0x281)]['info'](_0x31d016(0x298)),startSystem(_0x5ee56);});}function installPythonDependencies(_0x78c899){const _0x1b4548=a0_0x41bffb;if(_0x78c899['dependencyInstallInProgress'])return;_0x78c899['dependencyInstallInProgress']=!![];const _0x56b6b8=path['join'](__dirname,_0x1b4548(0x271),_0x1b4548(0x13c));stopPythonService(_0x78c899);if(fs[_0x1b4548(0x2b7)](VENV_PATH)&&!fs[_0x1b4548(0x2b7)](PIP_EXE)){_0x78c899['log'][_0x1b4548(0x288)](_0x1b4548(0x1e4));try{fs['rmSync'](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x4c89a6){_0x78c899[_0x1b4548(0x281)][_0x1b4548(0x1c2)](_0x1b4548(0x195)+_0x4c89a6[_0x1b4548(0x1ae)]);}}if(!fs[_0x1b4548(0x2b7)](VENV_PATH))try{_0x78c899[_0x1b4548(0x281)][_0x1b4548(0x1b3)](_0x1b4548(0x261)),execSync(_0x1b4548(0x2c7)+VENV_PATH+'\x22');}catch(_0x23805f){_0x78c899['dependencyInstallInProgress']=![];_0x23805f[_0x1b4548(0x1ae)][_0x1b4548(0x19e)](_0x1b4548(0x2e4))||_0x23805f[_0x1b4548(0x1ae)][_0x1b4548(0x19e)](_0x1b4548(0x207))?(_0x78c899[_0x1b4548(0x281)][_0x1b4548(0x1c2)](_0x1b4548(0x1ee)),_0x78c899['log']['error'](_0x1b4548(0x15d)+path[_0x1b4548(0x2c2)](__dirname))):_0x78c899[_0x1b4548(0x281)][_0x1b4548(0x1c2)]('‚ùå\x20VENV\x20CREATION\x20FAILED:\x20'+_0x23805f[_0x1b4548(0x1ae)]+_0x1b4548(0x210));return;}installRequirementsInVenv(_0x78c899,_0x56b6b8);}function checkAndInstall(_0x68ca69){const _0x427bd5=a0_0x41bffb;if(fs[_0x427bd5(0x2b7)](PYTHON_EXE)&&fs[_0x427bd5(0x2b7)](PIP_EXE))try{return _0x68ca69['log'][_0x427bd5(0x1b3)]('üêç\x20Checking\x20Python\x20environment...'),execSync('\x22'+PYTHON_EXE+_0x427bd5(0x278),{'timeout':0x3a98}),_0x68ca69[_0x427bd5(0x281)]['info'](_0x427bd5(0x282)),!![];}catch(_0x365a44){_0x68ca69[_0x427bd5(0x281)]['warn'](_0x427bd5(0x149));}else _0x68ca69[_0x427bd5(0x281)][_0x427bd5(0x288)](_0x427bd5(0x25a));return installPythonDependencies(_0x68ca69),![];}async function startSystem(_0x31a766){const _0x583604=a0_0x41bffb;_0x31a766[_0x583604(0x281)][_0x583604(0x1b3)](_0x583604(0x24d)),await initZombies(_0x31a766);try{_0x31a766[_0x583604(0x2c4)]=await checkLicense(_0x31a766['config'][_0x583604(0x2bd)]);}catch(_0x41030e){}if(!_0x31a766[_0x583604(0x19f)][_0x583604(0x140)]||_0x31a766[_0x583604(0x19f)][_0x583604(0x140)]<0.1)_0x31a766[_0x583604(0x19f)]['inactivityThresholdHours']=0xc;await initHistory(_0x31a766),await initSystemConfig(_0x31a766);if(_0x31a766['config'][_0x583604(0x193)])try{_0x31a766[_0x583604(0x1c6)]=new GoogleGenerativeAI(_0x31a766['config'][_0x583604(0x193)]),_0x31a766[_0x583604(0x234)]=_0x31a766[_0x583604(0x1c6)][_0x583604(0x22d)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x583604(0x28c)}}),_0x31a766[_0x583604(0x281)][_0x583604(0x1b3)](_0x583604(0x237));}catch(_0x4a65c1){_0x31a766['log'][_0x583604(0x1c2)]('Gemini\x20Init\x20Error:\x20'+_0x4a65c1[_0x583604(0x1ae)]);}await createAllObjects(_0x31a766),await loadSystemMode(_0x31a766),await loadRawEventLog(_0x31a766),await loadDailyDigests(_0x31a766),_0x31a766[_0x583604(0x2d1)](_0x583604(0x172)),_0x31a766['subscribeStates'](LTM_DP_TRIGGER_DIGEST),_0x31a766[_0x583604(0x2d1)](_0x583604(0x299)),_0x31a766['subscribeStates'](_0x583604(0x2a6)),_0x31a766['subscribeStates'](_0x583604(0x2dd)),_0x31a766[_0x583604(0x2d1)](_0x583604(0x283)),_0x31a766[_0x583604(0x2d1)](_0x583604(0x293)),_0x31a766[_0x583604(0x2d1)](_0x583604(0x1d9)),_0x31a766[_0x583604(0x2d1)]('analysis.training.triggerEnergy'),_0x31a766[_0x583604(0x2d1)](_0x583604(0x14b)),_0x31a766[_0x583604(0x2d1)](_0x583604(0x21d)),await initSensorSubscriptions(_0x31a766),await initPresenceSubscriptions(_0x31a766),await setupTelegramListener(_0x31a766),setTimeout(()=>checkWifiPresence(_0x31a766),0x1388);if(_0x31a766[_0x583604(0x241)])clearInterval(_0x31a766[_0x583604(0x241)]);const _0x34e200=_0x31a766[_0x583604(0x19f)]['analysisInterval']||0xf;_0x34e200>0x0&&(_0x31a766['analysisTimer']=setInterval(()=>{runAutopilot(_0x31a766);},_0x34e200*0x3c*0x3e8)),setupLtmScheduler(_0x31a766),setupModeResetScheduler(_0x31a766),setupDriftAnalysisScheduler(_0x31a766),setupBriefingScheduler(_0x31a766),startPythonService(_0x31a766),setTimeout(()=>{const _0x299ec8=_0x583604;_0x31a766[_0x299ec8(0x268)]&&(runPythonHealthCheck(_0x31a766),triggerGaitAnalysis(_0x31a766),triggerEnergyPrediction(_0x31a766)),updateHealthVector(_0x31a766);},0x1388);}class CogniLiving extends utils[a0_0x41bffb(0x1a5)]{constructor(_0x279da3){const _0x5ee547=a0_0x41bffb;super({..._0x279da3,'name':_0x5ee547(0x2ae)}),this[_0x5ee547(0x16a)]=[],this[_0x5ee547(0x1f5)]=[],this[_0x5ee547(0x2c5)]=[],this[_0x5ee547(0x290)]=[],this['sensorLastValues']={},this[_0x5ee547(0x240)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x5ee547(0x23c)]=!![],this[_0x5ee547(0x239)]=null,this[_0x5ee547(0x1b0)]=null,this[_0x5ee547(0x2b9)]=![],this['genAI']=null,this['geminiModel']=null,this[_0x5ee547(0x1de)]=SYSTEM_MODES[_0x5ee547(0x28a)],this[_0x5ee547(0x2c4)]=![],this[_0x5ee547(0x14d)]=![],this[_0x5ee547(0x1e0)]=_0x5ee547(0x2b3),this['analysisTimer']=null,this[_0x5ee547(0x25f)]=null,this['modeResetJob']=null,this[_0x5ee547(0x27d)]=null,this[_0x5ee547(0x2b6)]=null,this['pythonProcess']=null,this[_0x5ee547(0x1a2)]=![],this['on']('ready',this[_0x5ee547(0x1c8)][_0x5ee547(0x186)](this)),this['on'](_0x5ee547(0x219),this[_0x5ee547(0x1b4)][_0x5ee547(0x186)](this)),this['on'](_0x5ee547(0x26b),this[_0x5ee547(0x1c7)][_0x5ee547(0x186)](this)),this['on']('message',this['onMessage']['bind'](this));}async[a0_0x41bffb(0x1c8)](){const _0x1098e1=a0_0x41bffb;this[_0x1098e1(0x281)][_0x1098e1(0x1b3)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x1098e1(0x196)]+_0x1098e1(0x1fc));if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x41bffb(0x1c7)](_0x5dd10b){const _0x1a56f1=a0_0x41bffb;if(this['analysisTimer'])clearInterval(this[_0x1a56f1(0x241)]);if(this[_0x1a56f1(0x27d)])clearInterval(this['driftAnalysisTimer']);if(this[_0x1a56f1(0x25f)])this[_0x1a56f1(0x25f)]['cancel']();if(this['modeResetJob'])this[_0x1a56f1(0x1c3)]['cancel']();if(this[_0x1a56f1(0x2b6)])this[_0x1a56f1(0x2b6)][_0x1a56f1(0x236)]();if(this[_0x1a56f1(0x239)])clearTimeout(this['exitTimer']);if(this[_0x1a56f1(0x1b0)])clearTimeout(this[_0x1a56f1(0x1b0)]);stopPythonService(this),_0x5dd10b();}async[a0_0x41bffb(0x1b4)](_0x366db8,_0x3e3fd9){const _0x456fe5=a0_0x41bffb;if(!_0x3e3fd9||this[_0x456fe5(0x1a2)])return;if(_0x366db8[_0x456fe5(0x19e)]('telegram')&&_0x366db8[_0x456fe5(0x148)](_0x456fe5(0x2e1))&&_0x3e3fd9[_0x456fe5(0x2d0)]){await handleTelegramResponse(this,_0x3e3fd9[_0x456fe5(0x2d0)]);return;}if(_0x366db8===this[_0x456fe5(0x284)]+'.'+SYSTEM_DP_MODE){if(_0x3e3fd9['val']&&Object[_0x456fe5(0x25b)](SYSTEM_MODES)['includes'](_0x3e3fd9[_0x456fe5(0x2d0)])){this[_0x456fe5(0x1de)]=_0x3e3fd9['val'];if(_0x3e3fd9[_0x456fe5(0x2d0)]===SYSTEM_MODES[_0x456fe5(0x1b9)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x3e3fd9['ack'])this[_0x456fe5(0x2a0)](_0x366db8,{'val':this[_0x456fe5(0x1de)],'ack':!![]});return;}if(!_0x3e3fd9[_0x456fe5(0x17b)]){_0x366db8[_0x456fe5(0x19e)](_0x456fe5(0x172))&&_0x3e3fd9[_0x456fe5(0x2d0)]&&(this[_0x456fe5(0x2a0)](_0x366db8,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x366db8[_0x456fe5(0x19e)](_0x456fe5(0x2d6))&&_0x3e3fd9['val']){this[_0x456fe5(0x2a0)](_0x366db8,{'val':![],'ack':!![]});if(this[_0x456fe5(0x2c4)])createDailyDigest(this);}_0x366db8[_0x456fe5(0x19e)](_0x456fe5(0x1ed))&&_0x3e3fd9['val']&&(this[_0x456fe5(0x2a0)](_0x366db8,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x366db8['includes'](_0x456fe5(0x2d2))&&_0x3e3fd9[_0x456fe5(0x2d0)]&&(this[_0x456fe5(0x2a0)](_0x366db8,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x366db8['includes'](_0x456fe5(0x293))&&_0x3e3fd9['val']){this[_0x456fe5(0x2a0)](_0x366db8,{'val':![],'ack':!![]});if(this[_0x456fe5(0x2c4)])try{const _0x57f87b=await this[_0x456fe5(0x1e9)](_0x456fe5(0x2db));if(_0x57f87b&&_0x57f87b[_0x456fe5(0x2d0)]){const _0x14164d=JSON['parse'](_0x57f87b[_0x456fe5(0x2d0)]);this[_0x456fe5(0x281)][_0x456fe5(0x1b3)](_0x456fe5(0x1ea)),this[_0x456fe5(0x1dd)](_0x456fe5(0x29a),{'val':_0x456fe5(0x1c1),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x14164d});}}catch(_0x1cac1f){this[_0x456fe5(0x281)][_0x456fe5(0x1c2)](_0x456fe5(0x2b8)+_0x1cac1f[_0x456fe5(0x1ae)]);}}if(_0x366db8[_0x456fe5(0x19e)](_0x456fe5(0x1d9))&&_0x3e3fd9[_0x456fe5(0x2d0)]){this[_0x456fe5(0x2a0)](_0x366db8,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x28cb84=await this[_0x456fe5(0x1e9)](LTM_DP_DAILY_DIGESTS);if(_0x28cb84&&_0x28cb84[_0x456fe5(0x2d0)])sendToPython(this,'TRAIN_HEALTH',{'digests':JSON[_0x456fe5(0x251)](_0x28cb84[_0x456fe5(0x2d0)])});}catch(_0x3b8728){}}if(_0x366db8[_0x456fe5(0x19e)](_0x456fe5(0x21e))&&_0x3e3fd9[_0x456fe5(0x2d0)]){this[_0x456fe5(0x2a0)](_0x366db8,{'val':![],'ack':!![]});if(this[_0x456fe5(0x2c4)])try{const _0x135db0=await this[_0x456fe5(0x1e9)](_0x456fe5(0x14f));if(_0x135db0&&_0x135db0[_0x456fe5(0x2d0)])sendToPython(this,'TRAIN_ENERGY',{'points':JSON[_0x456fe5(0x251)](_0x135db0[_0x456fe5(0x2d0)])});}catch(_0x56bdb7){}}if(_0x366db8['includes'](_0x456fe5(0x14b))&&_0x3e3fd9[_0x456fe5(0x2d0)]){this['setState'](_0x366db8,{'val':![],'ack':!![]});if(this[_0x456fe5(0x2c4)])try{const _0x1e5717=await this['getStateAsync'](LTM_DP_RAW_LOG);_0x1e5717&&_0x1e5717[_0x456fe5(0x2d0)]&&(this[_0x456fe5(0x281)]['info'](_0x456fe5(0x161)),sendToPython(this,_0x456fe5(0x292),{'events':JSON[_0x456fe5(0x251)](_0x1e5717[_0x456fe5(0x2d0)])}));}catch(_0x20ac42){}}if(_0x366db8[_0x456fe5(0x19e)](_0x456fe5(0x21d))&&_0x3e3fd9[_0x456fe5(0x2d0)]){this[_0x456fe5(0x2a0)](_0x366db8,{'val':![],'ack':!![]});if(this[_0x456fe5(0x2c4)])try{const _0xfa8b56=await this[_0x456fe5(0x1e9)](_0x456fe5(0x2db));if(_0xfa8b56&&_0xfa8b56[_0x456fe5(0x2d0)]){const _0x3f76d2=JSON[_0x456fe5(0x251)](_0xfa8b56[_0x456fe5(0x2d0)]);this[_0x456fe5(0x281)][_0x456fe5(0x1b3)](_0x456fe5(0x2d4)),sendToPython(this,_0x456fe5(0x266),{'sequences':_0x3f76d2});}}catch(_0x1a750f){this['log']['error'](_0x456fe5(0x151)+_0x1a750f['message']);}}return;}if(this[_0x456fe5(0x19f)][_0x456fe5(0x242)]&&this[_0x456fe5(0x19f)][_0x456fe5(0x242)][_0x456fe5(0x19e)](_0x366db8)){await checkWifiPresence(this);return;}const _0xcc333c=(this[_0x456fe5(0x19f)][_0x456fe5(0x2a2)]||[])[_0x456fe5(0x1ff)](_0x500241=>_0x500241['id']===_0x366db8);if(_0xcc333c)processSensorEvent(this,_0x366db8,_0x3e3fd9,_0xcc333c);}async[a0_0x41bffb(0x18a)](_0x2c9add){const _0x2d0e2b=a0_0x41bffb;if(typeof _0x2c9add===_0x2d0e2b(0x2a8)&&_0x2c9add[_0x2d0e2b(0x1ae)]){if(_0x2c9add[_0x2d0e2b(0x1b1)]===_0x2d0e2b(0x171)){const _0x228a3a=_0x2c9add[_0x2d0e2b(0x1ae)]['apiKey']||this[_0x2d0e2b(0x19f)][_0x2d0e2b(0x193)];if(!_0x228a3a)return this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':![],'message':_0x2d0e2b(0x1b8)},_0x2c9add[_0x2d0e2b(0x211)]);try{const _0x2d3fbf=new GoogleGenerativeAI(_0x228a3a),_0x59ef2b=_0x2d3fbf[_0x2d0e2b(0x22d)]({'model':GEMINI_MODEL}),_0x231230=await _0x59ef2b[_0x2d0e2b(0x1af)]('Hi');this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':!![],'message':_0x2d0e2b(0x20f)+_0x231230[_0x2d0e2b(0x222)][_0x2d0e2b(0x24c)]()},_0x2c9add[_0x2d0e2b(0x211)]);}catch(_0x4fb716){this['sendTo'](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':![],'message':'Err:\x20'+_0x4fb716[_0x2d0e2b(0x1ae)]},_0x2c9add[_0x2d0e2b(0x211)]);}}else{if(_0x2c9add['command']===_0x2d0e2b(0x177)){const _0x256cbb=await getWeatherContext(this),_0x55c557=await getCalendarContext(this);this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':!![],'weather':_0x256cbb,'calendar':_0x55c557},_0x2c9add[_0x2d0e2b(0x211)]);}else{if(_0x2c9add[_0x2d0e2b(0x1b1)]==='getLtmData'){if(!this[_0x2d0e2b(0x2c4)])return this['sendTo'](_0x2c9add['from'],_0x2c9add['command'],{'success':![],'isPro':![]},_0x2c9add[_0x2d0e2b(0x211)]);let _0x531a24={'status':_0x2d0e2b(0x28f)};try{const _0x2efff5=await this[_0x2d0e2b(0x1e9)](LTM_DP_DRIFT_STATUS);_0x531a24['status']=_0x2efff5?_0x2efff5[_0x2d0e2b(0x2d0)]:_0x2d0e2b(0x28f);}catch(_0x5acab3){}this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x2d0e2b(0x290)],'driftAnalysis':_0x531a24,'analysisHistory':this['analysisHistory']},_0x2c9add['callback']);}else{if(_0x2c9add[_0x2d0e2b(0x1b1)]===_0x2d0e2b(0x233)){const _0x1fca03=this[_0x2d0e2b(0x290)][_0x2d0e2b(0x189)],_0x313b33=new Date(),_0x4f5f78=new Date(_0x313b33[_0x2d0e2b(0x16b)](),_0x313b33[_0x2d0e2b(0x169)](),_0x313b33[_0x2d0e2b(0x199)]())[_0x2d0e2b(0x202)](),_0x4e6926=this['rawEventLog']['filter'](_0x23ee56=>new Date(_0x23ee56[_0x2d0e2b(0x2c1)])[_0x2d0e2b(0x202)]()>_0x4f5f78)['length'],_0x3b9a8a=new Array(0x18)['fill'](0x0);this[_0x2d0e2b(0x2c5)][_0x2d0e2b(0x1ad)](_0xcf0aa5=>{const _0x3c03ef=_0x2d0e2b,_0x6b8304=new Date(_0xcf0aa5[_0x3c03ef(0x2c1)]);if(_0x6b8304[_0x3c03ef(0x202)]()>_0x4f5f78)_0x3b9a8a[_0x6b8304[_0x3c03ef(0x1fb)]()]++;});let _0x36e1d5={'status':_0x2d0e2b(0x28f)};try{const _0x129c57=await this[_0x2d0e2b(0x1e9)](LTM_DP_DRIFT_STATUS);_0x36e1d5['status']=_0x129c57?_0x129c57[_0x2d0e2b(0x2d0)]:_0x2d0e2b(0x28f);}catch(_0x23770e){}let _0x316cb0='';try{const _0x34a3ac=await this[_0x2d0e2b(0x1e9)](_0x2d0e2b(0x228));_0x316cb0=_0x34a3ac?_0x34a3ac[_0x2d0e2b(0x2d0)]:'';}catch(_0x3bf177){}let _0x13f692=null;!this[_0x2d0e2b(0x234)]&&(_0x13f692=this['config'][_0x2d0e2b(0x193)]?_0x2d0e2b(0x238):_0x2d0e2b(0x166));let _0x7421ab={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x43c37a=await this[_0x2d0e2b(0x1e9)](_0x2d0e2b(0x294));if(_0x43c37a&&_0x43c37a[_0x2d0e2b(0x2d0)]){_0x7421ab[_0x2d0e2b(0x27f)]=!![];const _0x1b4d0d=await this[_0x2d0e2b(0x1e9)](_0x2d0e2b(0x2bc));_0x7421ab[_0x2d0e2b(0x2e7)]=_0x1b4d0d?_0x1b4d0d[_0x2d0e2b(0x2d0)]:'';const _0x949f80=await this[_0x2d0e2b(0x1e9)](_0x2d0e2b(0x16f));_0x7421ab[_0x2d0e2b(0x2c6)]=_0x949f80?_0x949f80[_0x2d0e2b(0x2d0)]:'';const _0x17f711=await this[_0x2d0e2b(0x1e9)](_0x2d0e2b(0x173));_0x7421ab['targetValue']=_0x17f711?_0x17f711[_0x2d0e2b(0x2d0)]:'';}const _0x390646=await this[_0x2d0e2b(0x1e9)]('analysis.automation.autoApply');_0x7421ab[_0x2d0e2b(0x155)]=_0x390646?!!_0x390646['val']:![];}catch(_0x5b6cc4){}this['sendTo'](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add['command'],{'success':!![],'eventHistory':this[_0x2d0e2b(0x16a)]['slice'](0x0,0xf),'stats':{'digestCount':_0x1fca03,'eventCountToday':_0x4e6926,'hourlyActivity':_0x3b9a8a,'driftStatus':_0x36e1d5['status'],'isPresent':this[_0x2d0e2b(0x23c)],'presenceWho':_0x316cb0,'minDays':this[_0x2d0e2b(0x19f)][_0x2d0e2b(0x264)]||0x7,'stbDays':this[_0x2d0e2b(0x19f)][_0x2d0e2b(0x27e)]||0xe,'ltbDays':this[_0x2d0e2b(0x19f)][_0x2d0e2b(0x218)]||0x3c,'systemError':_0x13f692},'automation':_0x7421ab},_0x2c9add[_0x2d0e2b(0x211)]);}else{if(_0x2c9add['command']===_0x2d0e2b(0x179))try{const _0x105ded=await scanForDevices(this,_0x2c9add[_0x2d0e2b(0x1ae)]||{});this['sendTo'](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':!![],'devices':_0x105ded},_0x2c9add[_0x2d0e2b(0x211)]);}catch(_0x514f6a){this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':![],'error':_0x514f6a[_0x2d0e2b(0x1ae)]},_0x2c9add['callback']);}else{if(_0x2c9add['command']==='getEnums'){const _0x392e26=await this[_0x2d0e2b(0x1f4)]('enum.functions.*','enum'),_0x38e2f3=[];if(_0x392e26)for(const _0x4384e3 in _0x392e26){const _0x211787=_0x392e26[_0x4384e3],_0x115e7d=(_0x211787[_0x2d0e2b(0x168)]&&typeof _0x211787[_0x2d0e2b(0x168)]['name']===_0x2d0e2b(0x2a8)?_0x211787[_0x2d0e2b(0x168)][_0x2d0e2b(0x26d)]['de']:_0x211787[_0x2d0e2b(0x168)][_0x2d0e2b(0x26d)])||_0x211787['common'][_0x2d0e2b(0x26d)];_0x38e2f3[_0x2d0e2b(0x1b2)]({'id':_0x4384e3,'name':_0x115e7d});}const _0x2e21a7=await this['getForeignObjectsAsync'](_0x2d0e2b(0x163),_0x2d0e2b(0x2d8)),_0x12e32e=[];if(_0x2e21a7)for(const _0x56e59d in _0x2e21a7){const _0x4be5e5=_0x2e21a7[_0x56e59d],_0x299c90=(_0x4be5e5[_0x2d0e2b(0x168)]&&typeof _0x4be5e5[_0x2d0e2b(0x168)]['name']===_0x2d0e2b(0x2a8)?_0x4be5e5[_0x2d0e2b(0x168)][_0x2d0e2b(0x26d)]['de']:_0x4be5e5['common']['name'])||_0x56e59d[_0x2d0e2b(0x280)]('.')[_0x2d0e2b(0x15c)]();_0x12e32e[_0x2d0e2b(0x1b2)](_0x299c90);}this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add['command'],{'success':!![],'enums':_0x38e2f3,'rooms':_0x12e32e},_0x2c9add['callback']);}else{if(_0x2c9add[_0x2d0e2b(0x1b1)]==='getCalendarNames'){const _0xc28f78=_0x2c9add['message'][_0x2d0e2b(0x24e)];if(!_0xc28f78)return this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':![],'error':_0x2d0e2b(0x213)},_0x2c9add[_0x2d0e2b(0x211)]);const _0x31dd16=await getCalendarNames(this,_0xc28f78);this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':!![],'names':_0x31dd16},_0x2c9add[_0x2d0e2b(0x211)]);}else{if(_0x2c9add[_0x2d0e2b(0x1b1)]===_0x2d0e2b(0x158)){const {targetId:_0x387dc9,targetValue:_0x475342}=_0x2c9add['message'];this[_0x2d0e2b(0x281)]['info'](_0x2d0e2b(0x15f)+_0x387dc9+'\x20=\x20'+_0x475342),await this[_0x2d0e2b(0x1dd)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x2d0e2b(0x1dd)]('analysis.automation.description',{'val':_0x2d0e2b(0x29b)+_0x387dc9,'ack':!![]}),await this[_0x2d0e2b(0x1dd)]('analysis.automation.targetId',{'val':_0x387dc9,'ack':!![]}),await this[_0x2d0e2b(0x1dd)]('analysis.automation.targetValue',{'val':_0x475342,'ack':!![]}),this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':!![]},_0x2c9add[_0x2d0e2b(0x211)]);}else{if(_0x2c9add[_0x2d0e2b(0x1b1)]===_0x2d0e2b(0x23d)){const {historyId:_0x38d182,rating:_0x2460bb,comment:_0x2949e5,alertReason:_0x5bdc42}=_0x2c9add['message'];_0x38d182&&_0x2460bb?(await saveFeedback(this,{'timestamp':Date[_0x2d0e2b(0x24f)](),'historyId':_0x38d182,'rating':_0x2460bb,'comment':_0x2949e5,'alertReason':_0x5bdc42}),this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':!![]},_0x2c9add[_0x2d0e2b(0x211)])):this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add['command'],{'success':![],'error':_0x2d0e2b(0x1a6)},_0x2c9add[_0x2d0e2b(0x211)]);}else _0x2c9add['command']==='dismissAutomation'&&(this['log'][_0x2d0e2b(0x1b3)](_0x2d0e2b(0x1f7)),await this[_0x2d0e2b(0x1dd)](_0x2d0e2b(0x294),{'val':![],'ack':!![]}),await this[_0x2d0e2b(0x1dd)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x2d0e2b(0x180)](_0x2c9add[_0x2d0e2b(0x23b)],_0x2c9add[_0x2d0e2b(0x1b1)],{'success':!![]},_0x2c9add[_0x2d0e2b(0x211)]));}}}}}}}}}}}if(require[a0_0x41bffb(0x160)]!==module)module[a0_0x41bffb(0x1e8)]=_0xf80abd=>new CogniLiving(_0xf80abd);else new CogniLiving();