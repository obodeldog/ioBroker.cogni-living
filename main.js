const a0_0x45af1a=a0_0x5c80;(function(_0x3f526b,_0x64afe6){const _0x5c6ed3=a0_0x5c80,_0x834b37=_0x3f526b();while(!![]){try{const _0x19b487=-parseInt(_0x5c6ed3(0x13a))/0x1+parseInt(_0x5c6ed3(0xf4))/0x2+parseInt(_0x5c6ed3(0x1ef))/0x3+-parseInt(_0x5c6ed3(0x16c))/0x4+parseInt(_0x5c6ed3(0x1c6))/0x5+parseInt(_0x5c6ed3(0x10a))/0x6+-parseInt(_0x5c6ed3(0x13c))/0x7;if(_0x19b487===_0x64afe6)break;else _0x834b37['push'](_0x834b37['shift']());}catch(_0x17b7a0){_0x834b37['push'](_0x834b37['shift']());}}}(a0_0x394c,0xc3ad3));const a0_0x169dc0=(function(){let _0x138a0b=!![];return function(_0x46fa29,_0x46b093){const _0x540947=_0x138a0b?function(){const _0x353e7d=a0_0x5c80;if(_0x46b093){const _0x17a984=_0x46b093[_0x353e7d(0x232)](_0x46fa29,arguments);return _0x46b093=null,_0x17a984;}}:function(){};return _0x138a0b=![],_0x540947;};}()),a0_0x5467ae=a0_0x169dc0(this,function(){const _0xb09200=a0_0x5c80;return a0_0x5467ae['toString']()['search'](_0xb09200(0x186))['toString']()['constructor'](a0_0x5467ae)[_0xb09200(0x158)](_0xb09200(0x186));});function a0_0x394c(){const _0x5730f5=['automationProposal','Last\x20raw\x20event','LTM.rawEventLog','scriptProblem','eventHistory','(((.+)+)+)+$','shutter','info.','Deviation','party','isPresent','setState','08:00','PRIORITÃ„T:\x20Sicherheit.','.forecast.current.state','telegram','Comfort\x20Summary','subscribeForeignStatesAsync','common','analysisHistory','forEach','driftAnalysisTimer','val','cancel','notifyPushoverInstance','siren','indexOf','âš ï¸\x20ALARM:\x20','brightness','Aktiv\x20(','KALENDER:\x20Keine\x20relevanten\x20Termine','Drift\x20Analysis','guest','isGracePeriodActive',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','pop','.\x0a\x20\x20\x20\x20KONTEXT:\x20','modeResetJob','cogni-living','briefingEnabled','expire','\x20presence\x20devices...','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','normal','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','maintenance','length','analysis.automation','humidity','.\x20DATEN:\x20Schlaf\x20','getLtmData','dutycycle','thermostat','Daily\x20Digests','weather','analysis.history_debug_00','system.presenceWho','Last\x20Result','autoApply','version','exitTimer','endsWith','Party','Cogni-Living','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','Error\x20reading\x20calendar\x20table:\x20','Action','submitFeedback','window','4811675HipxkL','analysis.automation.description','\x20events','Error\x20in\x20onMessage\x20command\x20','@iobroker/adapter-core','presenceDevices','occupancy','geminiModel','ltmJob','analysis.health','[PYTHON\x20ERR]\x20','accuweather','Description','pythonProcess','Keine\x20Details.','find','.\x20ZUSATZ:\x20','scriptEnabled','analysis.isAlert','openweathermap.0','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','notifyTelegramEnabled','native','text.alarm','energy','Alarm','.Summary.Current','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','toISOString','Starting\x20Autopilot\x20(','ðŸŒ…\x20Daily\x20Briefing:\x0a','WETTER\x20ERROR:\x20','cogni-living\x20adapter\x20starting\x20(v','Gemini\x20Init\x20Error:\x20','rollladen','analysis.health.notes','dailyDigests','openweathermap','fault','enum','simulateButler','884874CZvNBX','minDaysForBaseline','stick_unreach','geminiApiKey','push','python_service','close','inactivityMonitoringEnabled','date','rawEventLog','Error\x20checking\x20WiFi:\x20','state','number','LTM.driftAnalysis.driftDetails','_score','selectedFunctionIds','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','motion','N/A','replace','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','targetId','scheduleJob','@google/generative-ai','presence','calendarSelection','dismissAutomation','AI\x20Emergency\x20Status','Reset\x20Sched\x20Error:\x20','callback','object','bind','javascript.','inactivityThresholdHours','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','System\x20Mode','getCalendarNames','setObjectNotExistsAsync','System\x20Status\x20&\x20Control','actual_temperature','analysis.feedbackHistory','door','isArray','calendarInstance','COGNI_CONFIRM_OK','targetValue','application/json','generic','...','Trigger\x20Action\x20Now','licenseKey','history.','sort','Trigger\x20Analysis','event','indicator.alarm.fire','enum.rooms.*','currentSystemMode','json','notifyEmailRecipient','Comfort\x20Suggestion','0\x203\x20*\x20*\x20*','driftDetails','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','lock','_calName','Pattern\x20Detected','apply','main','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','button','service.py','systemConfig','instance','Last\x20Check','sendToAsync','isAlert','generateContent','update','value.health','COGNI_REQUEST_CALL','onUnload','toLocaleString','time','role','Target\x20ID','unload','Kalender:\x20Deaktiviert','level','substring','setStateAsync','lastAlertState','name','uuid','Gemini\x20Analysis\x20Error:\x20','isEmergency','Trigger\x20Briefing\x20(Test)','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','lights','analysis.automation.targetId','unreach','GUEST','ack','extendObjectAsync','.\x20KONTEXT:\x20','Feedback\x20saved:\x20','testApiKey','switch','Who\x20is\x20present?','Subscribing\x20to\x20','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','events.history_debug_00','system.isPresent','lampe','ðŸ“¡\x20Hooking\x20into\x20','now','[PYTHON]\x20','Keiner','stderr','\x20Tage)','PARTY','reachable','toLowerCase','split','vacation','string','\x20*\x20*\x20*','kill','User\x20dismissed\x20automation\x20proposal.','analysis.analysisHistory','location','Auto\x20Apply\x20Rule','LTM','WETTER:\x20Keine\x20Daten\x20gefunden','error','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','light','sound','toString','baselineDrift','\x20min).','AI\x20Alert\x20Status','Restlessness\x20Level','testNotification','connection','set_temperature','bewegung','KALENDER:\x20','icons-mfd.','splice','type','Lernphase\x20(','scanDevices','analysis.lastResult','onMessage','getStateAsync','.\x20OUTPUT:\x20Nur\x20Text.','from','Automation\x20Proposals','onStateChange','members','uuid-not-found','PRO-','ltmDriftCheckIntervalHours','analysis.health.sleepScore','analysis.automation.autoApply','enum.functions.*','\x20for\x20interactive\x20buttons...','summary','config','âœ…\x20Alles\x20OK\x20(Reset)','vis.','genAI','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','prÃ¤senz','fenster','Raw\x20Log','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','analysis.health.restlessness','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','health','off','analysis.triggerBriefing','retry','sensor','events.lastEvent','sendTo','getOverviewData','some','log','klima','Event\x20received:\x20','getGenerativeModel','channel','\x20=\x20','temperature','getDate','Skipped\x20(No\x20AI\x20or\x20Data)','warn','map','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','1927624lUAmmr','status','getHours','filter','getForeignObjectsAsync','[TEST]\x20','\x20|\x20','Deaktiviert\x20(Pro-Feature)','Error:\x20','events.history','Kein\x20API\x20Key!','getForeignStateAsync','analysis.activitySummary','parse','getEnums','indicator','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','working',').\x20Starting\x20Timer.','Error\x20launching\x20Python\x20service:\x20','stateChange','systemUUID','107400hhrJUF','sensorLastValues','subscribeStates','alertReason','No\x20instance','Analysiere\x20ausgewogen.','getObjectAsync','tÃ¼r','data','Morning\x20Briefing\x20sent.','admin.','licht','briefingTime','trim','message','blind','targetposition','slice','daswetter.0','Gemini\x20AI\x20initialized.','Sending\x20notification:\x20\x22','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','analysis.automation.patternDetected','\x20hours.\x20Potential\x20incapacitation.','Success:\x20Compressed\x20','accuweather.0','getTime','unshift','NORMAL','text','heizung','indicator.alarm','briefingJob','city','logDuplicates','delObjectAsync','VACATION','useCalendar','analysis.automation.targetValue','.\x0a\x20\x20\x20\x20WETTER:\x20','analysis.deviationFromBaseline','PRIORITÃ„T:\x20Gesundheit/AAL.','analysis.trigger','aiPersona','isProVersion','LTM.processingStatus','Activity\x20Summary','boolean','286255HdSiyd','description','6324626gWNsXb','analysisTimer','Baseline\x20Status','notifyEmailEnabled','notifyTelegramInstance','analysis.automation.triggerAction','communicate.request','ltmLtbWindowDays','setHours','Fokus\x20auf\x20Familienroutinen.','notifyTelegramRecipient','LTM.triggerDailyDigest','path','getForeignObjectAsync','system','detected','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','exitGraceTimer','ltmStbWindowDays','command','Health\x20&\x20Sleep\x20Analysis','âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','feedbackHistory','temp','.NextHours.Location_1.Day_1.current.symbol_desc','Generating\x20Morning\x20Briefing...','devices','daswetter','search','Missing\x20data','Event\x20History','analysis.comfortSummary','echarts.','send','setForeignStateAsync','notifyPushoverRecipient','response','LTM\x20Sched\x20Error:\x20','TEST-PRO-KEY','triggerBriefing','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','getMonth','uuid-error','startsWith','stringify','analysis.alertReason','join','online','990964QUGacv','namespace','simple-api.','timestamp','Logbook','onReady','notifyPushoverEnabled','Wetter:\x20Deaktiviert','LTM.driftAnalysis.lastCheck','includes','info','power','.data.table','Started\x20at\x20','notifyEmailInstance','.\x20Welcome\x20home.','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','rssi','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','cover','custom'];a0_0x394c=function(){return _0x5730f5;};return a0_0x394c();}a0_0x5467ae();'use strict';const utils=require(a0_0x45af1a(0x1ca)),{GoogleGenerativeAI}=require(a0_0x45af1a(0x206)),schedule=require('node-schedule'),{spawn}=require('child_process'),path=require(a0_0x45af1a(0x148)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x45af1a(0x22c),MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x45af1a(0x183),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x45af1a(0x137),LTM_DP_TRIGGER_DIGEST=a0_0x45af1a(0x147),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x45af1a(0x1fc),LTM_DP_DRIFT_LAST_CHECK=a0_0x45af1a(0x174),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=[a0_0x45af1a(0x184),a0_0x45af1a(0x1d7),a0_0x45af1a(0x23d),a0_0x45af1a(0x254),'lowbat',a0_0x45af1a(0x17d),a0_0x45af1a(0xbb),a0_0x45af1a(0x1ae),'error',a0_0x45af1a(0x1ec),a0_0x45af1a(0x105),'direction',a0_0x45af1a(0x1f1),'config_pending',a0_0x45af1a(0x1b4),'firmware',a0_0x45af1a(0xa4),'link_quality'],BAD_NAMES=[a0_0x45af1a(0x11a),'currentposition',a0_0x45af1a(0x1fa),a0_0x45af1a(0x247),'value',a0_0x45af1a(0x19d),'on',a0_0x45af1a(0xe0),a0_0x45af1a(0x25b),'position',a0_0x45af1a(0x187),a0_0x45af1a(0x119),a0_0x45af1a(0x17f),a0_0x45af1a(0xf5),'motion',a0_0x45af1a(0x207),a0_0x45af1a(0x1cc),'temperature',a0_0x45af1a(0x1b1),a0_0x45af1a(0x177),a0_0x45af1a(0x1de),'setpoint','valve',a0_0x45af1a(0x216),a0_0x45af1a(0xbc)],ADAPTER_BLACKLIST=['system.',a0_0x45af1a(0x114),a0_0x45af1a(0x188),a0_0x45af1a(0xd6),a0_0x45af1a(0x222),'material.',a0_0x45af1a(0xbf),'flot.',a0_0x45af1a(0x15c),a0_0x45af1a(0x20f),a0_0x45af1a(0x16e)],SYSTEM_MODES={'NORMAL':a0_0x45af1a(0x1ac),'VACATION':a0_0x45af1a(0xa7),'PARTY':a0_0x45af1a(0x18a),'GUEST':a0_0x45af1a(0x1a1)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x45af1a(0xa3)],SYSTEM_MODES[a0_0x45af1a(0x255)]],PERSONA_MAPPING={'generic':a0_0x45af1a(0x10f),'senior_aal':a0_0x45af1a(0x133),'family':a0_0x45af1a(0x145),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x45af1a(0x18e)};async function initZombies(_0x11cb16){const _0x250f2b=a0_0x45af1a;try{const _0x397883=[_0x250f2b(0x1b8),_0x250f2b(0x25f)];for(const _0x4141dd of _0x397883){try{const _0x1b2b54=await _0x11cb16[_0x250f2b(0x110)](_0x4141dd);_0x1b2b54&&await _0x11cb16[_0x250f2b(0x12d)](_0x4141dd);}catch(_0x1d5db4){}}}catch(_0x39bb53){}}async function initHistory(_0x39c582){const _0x464d15=a0_0x45af1a;try{const _0x2b2a48=await _0x39c582[_0x464d15(0xc6)](_0x464d15(0xfd));_0x2b2a48&&_0x2b2a48[_0x464d15(0x197)]&&(_0x39c582[_0x464d15(0x185)]=JSON['parse'](_0x2b2a48[_0x464d15(0x197)]['toString']()));}catch(_0x2b4bf4){_0x39c582['eventHistory']=[];}try{const _0x559dad=await _0x39c582[_0x464d15(0xc6)](_0x464d15(0xac));if(_0x559dad&&_0x559dad[_0x464d15(0x197)])_0x39c582[_0x464d15(0x194)]=JSON[_0x464d15(0x101)](_0x559dad[_0x464d15(0x197)][_0x464d15(0xb5)]());}catch(_0x493d8d){_0x39c582[_0x464d15(0x194)]=[];}}async function initSystemConfig(_0x163ab3){const _0x461a6d=a0_0x45af1a;try{const _0x5c5679=await _0x163ab3['getForeignObjectAsync']('system.config');_0x5c5679&&_0x5c5679[_0x461a6d(0x193)]&&(_0x163ab3[_0x461a6d(0x237)]={'latitude':_0x5c5679[_0x461a6d(0x193)]['latitude']||0x0,'longitude':_0x5c5679[_0x461a6d(0x193)]['longitude']||0x0,'city':_0x5c5679[_0x461a6d(0x193)][_0x461a6d(0x12b)]||''});}catch(_0x560d60){}}async function checkLicense(_0xc43dc5,_0x2b6bb9){const _0x4d3301=a0_0x45af1a;if(!_0x2b6bb9)return![];_0xc43dc5[_0x4d3301(0x109)]=await getSystemUUID(_0xc43dc5);if(_0x2b6bb9===_0x4d3301(0x162)||_0x2b6bb9[_0x4d3301(0x167)](_0x4d3301(0xcd)))return!![];return![];}async function getSystemUUID(_0x23ba43){const _0x5e1e3c=a0_0x45af1a;try{const _0x21ad65=await _0x23ba43[_0x5e1e3c(0x149)]('system.meta.uuid');if(_0x21ad65&&_0x21ad65[_0x5e1e3c(0x1dc)]&&_0x21ad65[_0x5e1e3c(0x1dc)][_0x5e1e3c(0x24c)])return _0x21ad65[_0x5e1e3c(0x1dc)][_0x5e1e3c(0x24c)];return _0x5e1e3c(0xcc);}catch(_0x37ddce){return _0x5e1e3c(0x166);}}async function createAllObjects(_0x342e98){const _0x1bbcfd=a0_0x45af1a;await checkSystemObjects(_0x342e98),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x1b9),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x25c),'type':_0x1bbcfd(0xa8),'role':_0x1bbcfd(0x127),'read':!![],'write':![],'def':''},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0xe4),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x182),'type':_0x1bbcfd(0xa8),'role':_0x1bbcfd(0x229),'read':!![],'write':![]},'native':{}}),await _0x342e98['setObjectNotExistsAsync'](_0x1bbcfd(0xfd),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x15a),'type':'string','role':_0x1bbcfd(0x229),'read':!![],'write':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x134),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x224),'type':_0x1bbcfd(0x139),'role':_0x1bbcfd(0x235),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0xe1),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x24f),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0xc4),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x1ba),'type':_0x1bbcfd(0xa8),'role':_0x1bbcfd(0x229),'read':!![],'write':![]},'native':{}}),await _0x342e98['setObjectNotExistsAsync'](_0x1bbcfd(0x1d8),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0xb8),'type':_0x1bbcfd(0x139),'role':_0x1bbcfd(0x129),'read':!![],'write':![],'def':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)]('analysis.isEmergency',{'type':'state','common':{'name':_0x1bbcfd(0x20a),'type':'boolean','role':_0x1bbcfd(0x226),'read':!![],'write':![],'def':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x169),{'type':'state','common':{'name':'Alert\x20Reason','type':'string','role':_0x1bbcfd(0x1dd),'read':!![],'write':![]},'native':{}}),await _0x342e98['setObjectNotExistsAsync'](_0x1bbcfd(0x100),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x138),'type':_0x1bbcfd(0xa8),'role':_0x1bbcfd(0x127),'read':!![],'write':![]},'native':{}}),await _0x342e98['setObjectNotExistsAsync'](_0x1bbcfd(0x132),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x189),'type':'string','role':_0x1bbcfd(0x1fa),'read':!![],'write':![],'def':_0x1bbcfd(0x201)},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x15b),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x191),'type':_0x1bbcfd(0xa8),'role':'text','read':!![],'write':![]},'native':{}}),await _0x342e98['setObjectNotExistsAsync']('analysis.comfortSuggestion',{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x22b),'type':_0x1bbcfd(0xa8),'role':_0x1bbcfd(0x127),'read':!![],'write':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x257)](_0x1bbcfd(0x1b0),{'type':_0x1bbcfd(0xec),'common':{'name':_0x1bbcfd(0xc9)},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x120),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x231),'type':'boolean','role':_0x1bbcfd(0x103),'read':!![],'write':![],'def':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x1c7),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x1d2),'type':_0x1bbcfd(0xa8),'role':'text','read':!![],'write':![]},'native':{}}),await _0x342e98['setObjectNotExistsAsync']('analysis.automation.suggestedAction',{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x1c3),'type':_0x1bbcfd(0xa8),'role':_0x1bbcfd(0x127),'read':!![],'write':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x253),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x244),'type':_0x1bbcfd(0xa8),'role':_0x1bbcfd(0x127),'read':!![],'write':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x130),{'type':_0x1bbcfd(0x1fa),'common':{'name':'Target\x20Value','type':'string','role':_0x1bbcfd(0x127),'read':!![],'write':![]},'native':{}}),await _0x342e98['setObjectNotExistsAsync'](_0x1bbcfd(0xd0),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0xae),'type':_0x1bbcfd(0x139),'role':_0x1bbcfd(0x25b),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x141),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x220),'type':_0x1bbcfd(0x139),'role':_0x1bbcfd(0x235),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x342e98['setObjectNotExistsAsync'](_0x1bbcfd(0xac),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0x170),'type':'string','role':_0x1bbcfd(0x229),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x217),{'type':_0x1bbcfd(0x1fa),'common':{'name':'Feedback\x20Log','type':'string','role':_0x1bbcfd(0x229),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x342e98[_0x1bbcfd(0x257)](_0x1bbcfd(0x1cf),{'type':_0x1bbcfd(0xec),'common':{'name':_0x1bbcfd(0x150)},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0xcf),{'type':_0x1bbcfd(0x1fa),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x1bbcfd(0x1fb),'role':_0x1bbcfd(0x23e),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x342e98['setObjectNotExistsAsync'](_0x1bbcfd(0xdd),{'type':_0x1bbcfd(0x1fa),'common':{'name':_0x1bbcfd(0xb9),'type':'string','role':_0x1bbcfd(0x127),'read':!![],'write':![],'def':'none'},'native':{}}),await _0x342e98[_0x1bbcfd(0x214)](_0x1bbcfd(0x1e9),{'type':_0x1bbcfd(0x1fa),'common':{'name':'Health\x20Notes','type':_0x1bbcfd(0xa8),'role':'text','read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x342e98),await checkLtmDriftObjects(_0x342e98);}async function checkSystemObjects(_0x264554){const _0x3091a2=a0_0x45af1a;await _0x264554[_0x3091a2(0x257)](_0x3091a2(0x14a),{'type':_0x3091a2(0xec),'common':{'name':_0x3091a2(0x215)},'native':{}}),await _0x264554[_0x3091a2(0x257)](SYSTEM_DP_MODE,{'type':_0x3091a2(0x1fa),'common':{'name':_0x3091a2(0x212),'type':'string','role':_0x3091a2(0x1fa),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x3091a2(0x126)]]:'Normal',[SYSTEM_MODES[_0x3091a2(0x12e)]]:'Urlaub',[SYSTEM_MODES[_0x3091a2(0xa3)]]:_0x3091a2(0x1bf),[SYSTEM_MODES[_0x3091a2(0x255)]]:'Gast'}},'native':{}});}async function checkLtmObjects(_0x183b68){const _0x38051a=a0_0x45af1a;await _0x183b68[_0x38051a(0x257)]('LTM',{'type':_0x38051a(0xec),'common':{'name':_0x38051a(0xaf)},'native':{}}),await _0x183b68[_0x38051a(0x257)](LTM_DP_RAW_LOG,{'type':_0x38051a(0x1fa),'common':{'name':_0x38051a(0xdb),'type':'string','role':_0x38051a(0x229),'read':!![],'write':![]},'native':{}}),await _0x183b68[_0x38051a(0x257)](LTM_DP_DAILY_DIGESTS,{'type':_0x38051a(0x1fa),'common':{'name':_0x38051a(0x1b6),'type':_0x38051a(0xa8),'role':'json','read':!![],'write':![]},'native':{}}),await _0x183b68[_0x38051a(0x257)](LTM_DP_STATUS,{'type':_0x38051a(0x1fa),'common':{'name':'Processing\x20Status','type':_0x38051a(0xa8),'role':_0x38051a(0x127),'read':!![],'write':![]},'native':{}}),await _0x183b68['extendObjectAsync'](LTM_DP_TRIGGER_DIGEST,{'type':_0x38051a(0x1fa),'common':{'name':'Trigger\x20Digest','type':_0x38051a(0x139),'role':_0x38051a(0x235),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x183b68['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x38051a(0x1fa),'common':{'name':_0x38051a(0x13e),'type':_0x38051a(0xa8),'role':_0x38051a(0x127),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x4caddf){const _0x59047a=a0_0x45af1a;await _0x4caddf[_0x59047a(0x257)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x59047a(0x1a0)},'native':{}}),await _0x4caddf[_0x59047a(0x257)](LTM_DP_DRIFT_STATUS,{'type':_0x59047a(0x1fa),'common':{'name':'Drift\x20Status','type':'string','role':_0x59047a(0x1fa),'read':!![],'write':![],'def':_0x59047a(0x201)},'native':{}}),await _0x4caddf[_0x59047a(0x257)](LTM_DP_DRIFT_DETAILS,{'type':_0x59047a(0x1fa),'common':{'name':'Drift\x20Details','type':_0x59047a(0xa8),'role':_0x59047a(0x127),'read':!![],'write':![]},'native':{}}),await _0x4caddf[_0x59047a(0x257)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x59047a(0x1fa),'common':{'name':_0x59047a(0x239),'type':'number','role':_0x59047a(0x1f7),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x5e9c73){const _0x521144=a0_0x45af1a;try{const _0x517eec=await _0x5e9c73[_0x521144(0xc6)](SYSTEM_DP_MODE);_0x517eec&&_0x517eec[_0x521144(0x197)]&&Object['values'](SYSTEM_MODES)['includes'](_0x517eec[_0x521144(0x197)])?_0x5e9c73[_0x521144(0x228)]=_0x517eec[_0x521144(0x197)]:(_0x5e9c73['currentSystemMode']=SYSTEM_MODES[_0x521144(0x126)],await _0x5e9c73[_0x521144(0x249)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x521144(0x126)],'ack':!![]}));}catch(_0x443293){_0x5e9c73[_0x521144(0x228)]=SYSTEM_MODES[_0x521144(0x126)];}}async function loadRawEventLog(_0x5e8fe5){const _0x3c3955=a0_0x45af1a;try{const _0x245091=await _0x5e8fe5[_0x3c3955(0xc6)](LTM_DP_RAW_LOG);if(_0x245091&&_0x245091['val'])_0x5e8fe5['rawEventLog']=JSON['parse'](_0x245091[_0x3c3955(0x197)]);}catch(_0x5847bd){_0x5e8fe5['rawEventLog']=[];}}async function saveRawEventLog(_0x2fdb67){const _0x57ffc5=a0_0x45af1a;_0x2fdb67[_0x57ffc5(0x1f8)][_0x57ffc5(0x1af)]>RAW_LOG_MAX_SIZE&&_0x2fdb67[_0x57ffc5(0x1f8)][_0x57ffc5(0xc0)](0x0,_0x2fdb67[_0x57ffc5(0x1f8)][_0x57ffc5(0x1af)]-RAW_LOG_MAX_SIZE),await _0x2fdb67[_0x57ffc5(0x249)](LTM_DP_RAW_LOG,{'val':JSON[_0x57ffc5(0x168)](_0x2fdb67[_0x57ffc5(0x1f8)]),'ack':!![]});}async function loadDailyDigests(_0x70fadf){const _0x40d1e9=a0_0x45af1a;try{const _0x3382fc=await _0x70fadf[_0x40d1e9(0xc6)](LTM_DP_DAILY_DIGESTS);if(_0x3382fc&&_0x3382fc[_0x40d1e9(0x197)])_0x70fadf[_0x40d1e9(0x1ea)]=JSON[_0x40d1e9(0x101)](_0x3382fc[_0x40d1e9(0x197)]);}catch(_0x11db2a){_0x70fadf[_0x40d1e9(0x1ea)]=[];}await updateBaselineStatus(_0x70fadf);}async function saveDailyDigests(_0x2be288,_0xeb115f=!![]){const _0x2a635f=a0_0x45af1a,_0x541f38=_0x2be288[_0x2a635f(0xd4)][_0x2a635f(0x143)]||0x3c;_0x2be288[_0x2a635f(0x1ea)][_0x2a635f(0x1af)]>_0x541f38&&_0x2be288['dailyDigests']['splice'](0x0,_0x2be288[_0x2a635f(0x1ea)][_0x2a635f(0x1af)]-_0x541f38);await _0x2be288[_0x2a635f(0x249)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2a635f(0x168)](_0x2be288[_0x2a635f(0x1ea)]),'ack':!![]});if(_0xeb115f)await updateBaselineStatus(_0x2be288);}async function updateAnalysisHistory(_0x2fbdc8,_0x13a9f8){const _0x5637ab=a0_0x45af1a;_0x2fbdc8[_0x5637ab(0x194)][_0x5637ab(0x125)](_0x13a9f8);if(_0x2fbdc8[_0x5637ab(0x194)][_0x5637ab(0x1af)]>ANALYSIS_HISTORY_MAX_SIZE)_0x2fbdc8[_0x5637ab(0x194)][_0x5637ab(0x1a4)]();await _0x2fbdc8[_0x5637ab(0x249)](_0x5637ab(0xac),{'val':JSON['stringify'](_0x2fbdc8[_0x5637ab(0x194)]),'ack':!![]});}async function updateBaselineStatus(_0x108626){const _0x1aa247=a0_0x45af1a;if(!_0x108626[_0x1aa247(0x136)]){await _0x108626[_0x1aa247(0x249)](LTM_DP_BASELINE_STATUS,{'val':_0x1aa247(0xfb),'ack':!![]});return;}const _0x3cf34b=_0x108626[_0x1aa247(0x1ea)][_0x1aa247(0x1af)]>=(_0x108626[_0x1aa247(0xd4)][_0x1aa247(0x1f0)]||0x7)?_0x1aa247(0x19e)+_0x108626[_0x1aa247(0x1ea)][_0x1aa247(0x1af)]+_0x1aa247(0xa2):_0x1aa247(0xc2)+_0x108626[_0x1aa247(0x1ea)]['length']+'/'+(_0x108626[_0x1aa247(0xd4)]['minDaysForBaseline']||0x7)+')';await _0x108626['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x3cf34b,'ack':!![]});}async function initSensorSubscriptions(_0x572094){const _0x5829ce=a0_0x45af1a,_0x5394b9=_0x572094[_0x5829ce(0xd4)][_0x5829ce(0x156)];if(_0x5394b9&&_0x5394b9[_0x5829ce(0x1af)]>0x0){_0x572094[_0x5829ce(0xe8)][_0x5829ce(0x176)](_0x5829ce(0x25d)+_0x5394b9[_0x5829ce(0x1af)]+'\x20sensors...');for(const _0x34b17a of _0x5394b9){if(_0x34b17a['id']){await _0x572094[_0x5829ce(0x192)](_0x34b17a['id']);try{const _0x322e5d=await _0x572094['getForeignStateAsync'](_0x34b17a['id']);if(_0x322e5d)_0x572094['sensorLastValues'][_0x34b17a['id']]=_0x322e5d['val'];}catch(_0x268be3){}}}}}async function initPresenceSubscriptions(_0x764577){const _0x5900e2=a0_0x45af1a,_0x83f4fa=_0x764577[_0x5900e2(0xd4)]['presenceDevices']||[];if(_0x83f4fa[_0x5900e2(0x1af)]>0x0){_0x764577[_0x5900e2(0xe8)][_0x5900e2(0x176)](_0x5900e2(0x25d)+_0x83f4fa[_0x5900e2(0x1af)]+_0x5900e2(0x1aa));for(const _0x5cbc03 of _0x83f4fa){await _0x764577[_0x5900e2(0x192)](_0x5cbc03);}try{await checkWifiPresence(_0x764577);}catch(_0x2f7533){}}}async function getWeatherContext(_0x424278){const _0x38cf73=a0_0x45af1a;try{if(!_0x424278[_0x38cf73(0xd4)]['useWeather'])return _0x38cf73(0x173);let _0xbd13de='';const _0x10d6fc=_0x424278[_0x38cf73(0xd4)]['weatherInstance'];if(_0x10d6fc)try{if(_0x10d6fc[_0x38cf73(0x175)](_0x38cf73(0x1d1))){const _0x5e1267=await _0x424278[_0x38cf73(0xff)](_0x10d6fc+_0x38cf73(0x1e0));if(_0x5e1267&&_0x5e1267[_0x38cf73(0x197)])_0xbd13de=_0x5e1267[_0x38cf73(0x197)];}else{if(_0x10d6fc[_0x38cf73(0x175)](_0x38cf73(0x157))){const _0x5375f4=await _0x424278[_0x38cf73(0xff)](_0x10d6fc+_0x38cf73(0x154));if(_0x5375f4&&_0x5375f4[_0x38cf73(0x197)])_0xbd13de=_0x5375f4[_0x38cf73(0x197)];}else{if(_0x10d6fc['includes'](_0x38cf73(0x1eb))){const _0x4db018=await _0x424278[_0x38cf73(0xff)](_0x10d6fc+_0x38cf73(0x18f));if(_0x4db018&&_0x4db018[_0x38cf73(0x197)])_0xbd13de=_0x4db018[_0x38cf73(0x197)];}}}}catch(_0x5f486a){}if(!_0xbd13de){const _0x2e95f7=[_0x38cf73(0x123),_0x38cf73(0x11c),'weatherunderground.0',_0x38cf73(0x1d9)];for(const _0x14d186 of _0x2e95f7){try{const _0x3b6b6b=await _0x424278[_0x38cf73(0x149)](_0x14d186);if(_0x3b6b6b){if(_0x14d186[_0x38cf73(0x175)](_0x38cf73(0x1d1))){const _0x2dd989=await _0x424278[_0x38cf73(0xff)](_0x14d186+_0x38cf73(0x1e0));if(_0x2dd989&&_0x2dd989[_0x38cf73(0x197)]){_0xbd13de=_0x2dd989[_0x38cf73(0x197)];break;}}}}catch(_0x4ca015){}}}return _0xbd13de?'WETTER:\x20'+_0xbd13de:_0x38cf73(0xb0);}catch(_0x15fc92){return _0x38cf73(0x1e5)+_0x15fc92['message'];}}async function getCalendarContext(_0x5decff){const _0x198161=a0_0x45af1a;try{if(!_0x5decff[_0x198161(0xd4)][_0x198161(0x12f)])return _0x198161(0x246);let _0x323e3f=_0x5decff['config'][_0x198161(0x21a)]||'ical.0',_0x44bbc0=_0x5decff[_0x198161(0xd4)][_0x198161(0x208)]||[];if(typeof _0x44bbc0===_0x198161(0xa8))_0x44bbc0=_0x44bbc0[_0x198161(0xa6)](',');try{const _0x4ace91=await _0x5decff[_0x198161(0xff)](_0x323e3f+_0x198161(0x178));if(_0x4ace91&&_0x4ace91['val']){let _0x1a7a57=tryParse(_0x4ace91[_0x198161(0x197)]);if(_0x1a7a57&&Array[_0x198161(0x219)](_0x1a7a57)){if(_0x44bbc0[_0x198161(0x1af)]>0x0)_0x1a7a57=_0x1a7a57['filter'](_0x2fbdc9=>_0x44bbc0[_0x198161(0x175)](_0x2fbdc9[_0x198161(0x230)]||''));else return _0x198161(0x17c);if(_0x1a7a57[_0x198161(0x1af)]>0x0){const _0x42781d=_0x1a7a57[_0x198161(0x11b)](0x0,0x3)[_0x198161(0xf2)](_0x2ba3c3=>{const _0x2723a9=_0x198161;let _0x482ace=_0x2ba3c3['date'];if(_0x2ba3c3['time'])_0x482ace+='\x20'+_0x2ba3c3[_0x2723a9(0x242)];return _0x482ace+':\x20'+_0x2ba3c3[_0x2723a9(0x225)]+'\x20('+_0x2ba3c3[_0x2723a9(0x230)]+')';});return _0x198161(0xbe)+_0x42781d['join'](_0x198161(0xfa));}else return _0x198161(0x19f);}}}catch(_0xf99f81){_0x5decff[_0x198161(0xe8)][_0x198161(0xf1)](_0x198161(0x1c2)+_0xf99f81[_0x198161(0x118)]);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x4ab4d8){return'KALENDER\x20ERROR:\x20'+_0x4ab4d8['message'];}}async function getCalendarNames(_0x4073bf,_0x3f6288){const _0x284bcf=a0_0x45af1a;try{const _0x556799=await _0x4073bf['getForeignStateAsync'](_0x3f6288+_0x284bcf(0x178));if(_0x556799&&_0x556799[_0x284bcf(0x197)]){const _0x2afefd=tryParse(_0x556799[_0x284bcf(0x197)]);if(_0x2afefd&&Array[_0x284bcf(0x219)](_0x2afefd)){const _0x52e8b8=[...new Set(_0x2afefd[_0x284bcf(0xf2)](_0x39e20c=>_0x39e20c[_0x284bcf(0x230)])[_0x284bcf(0xf7)](Boolean))];return _0x52e8b8[_0x284bcf(0x223)]();}}return[];}catch(_0x822c3e){return _0x4073bf[_0x284bcf(0xe8)][_0x284bcf(0xb1)]('getCalendarNames\x20Error:\x20'+_0x822c3e[_0x284bcf(0x118)]),[];}}async function checkWifiPresence(_0x455ba0){const _0x516d73=a0_0x45af1a;try{const _0x502bc1=_0x455ba0['config'][_0x516d73(0x1cb)]||[];let _0x2fb802=![];const _0x513573=[];for(const _0x286b89 of _0x502bc1){try{const _0xd2b955=await _0x455ba0[_0x516d73(0xff)](_0x286b89);if(_0xd2b955&&(_0xd2b955['val']===!![]||_0xd2b955[_0x516d73(0x197)]===_0x516d73(0x16b)||_0xd2b955['val']===0x1)){_0x2fb802=!![];const _0x7b5596=await _0x455ba0[_0x516d73(0x149)](_0x286b89);let _0x488a14=_0x286b89;_0x7b5596&&_0x7b5596[_0x516d73(0x193)]&&_0x7b5596[_0x516d73(0x193)][_0x516d73(0x24b)]&&(_0x488a14=typeof _0x7b5596['common'][_0x516d73(0x24b)]===_0x516d73(0x20d)?_0x7b5596[_0x516d73(0x193)][_0x516d73(0x24b)]['de']||_0x7b5596[_0x516d73(0x193)]['name']['en']:_0x7b5596[_0x516d73(0x193)][_0x516d73(0x24b)]),_0x513573[_0x516d73(0x1f3)](_0x488a14);}}catch(_0x10e8b7){}}return await _0x455ba0[_0x516d73(0x249)]('system.presenceWho',{'val':_0x513573[_0x516d73(0x16a)](',\x20'),'ack':!![]}),_0x2fb802&&(_0x455ba0['exitTimer']&&(_0x455ba0[_0x516d73(0xe8)][_0x516d73(0x176)]('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),abortExitTimer(_0x455ba0)),!_0x455ba0[_0x516d73(0x18b)]&&_0x455ba0[_0x516d73(0x228)]===SYSTEM_MODES[_0x516d73(0x126)]&&await setPresence(_0x455ba0,!![])),_0x2fb802;}catch(_0x20d015){return _0x455ba0[_0x516d73(0xe8)][_0x516d73(0xb1)](_0x516d73(0x1f9)+_0x20d015[_0x516d73(0x118)]),![];}}function startExitTimer(_0x1cadfa){const _0x26feca=a0_0x45af1a;abortExitTimer(_0x1cadfa),_0x1cadfa[_0x26feca(0x1a2)]=!![],_0x1cadfa[_0x26feca(0x14d)]=setTimeout(()=>{const _0xf99646=_0x26feca;_0x1cadfa[_0xf99646(0x1a2)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x1cadfa['exitTimer']=setTimeout(()=>{const _0x4da5ab=_0x26feca;setPresence(_0x1cadfa,![]),_0x1cadfa[_0x4da5ab(0x1bd)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x1a8429){const _0xa9b18e=a0_0x45af1a;if(_0x1a8429[_0xa9b18e(0x1bd)])clearTimeout(_0x1a8429['exitTimer']);if(_0x1a8429[_0xa9b18e(0x14d)])clearTimeout(_0x1a8429[_0xa9b18e(0x14d)]);_0x1a8429['exitTimer']=null,_0x1a8429[_0xa9b18e(0x14d)]=null,_0x1a8429['isGracePeriodActive']=![];}async function setPresence(_0x911e0b,_0x58b016){const _0x192cdd=a0_0x45af1a;if(_0x911e0b[_0x192cdd(0x18b)]===_0x58b016)return;_0x911e0b[_0x192cdd(0x18b)]=_0x58b016,await _0x911e0b[_0x192cdd(0x249)](_0x192cdd(0x260),{'val':_0x58b016,'ack':!![]});}async function saveFeedback(_0x4f3065,_0x23f464){const _0x416b86=a0_0x45af1a;_0x4f3065[_0x416b86(0xe8)]['info'](_0x416b86(0x259)+JSON[_0x416b86(0x168)](_0x23f464));}async function runBaselineDriftAnalysis(_0x285dd4){const _0x52408c=a0_0x45af1a;if(!_0x285dd4['isProVersion']||!_0x285dd4[_0x52408c(0x1cd)])return;const _0x1a22c6=_0x285dd4[_0x52408c(0xd4)][_0x52408c(0x14e)]||0xe;if(_0x285dd4[_0x52408c(0x1ea)][_0x52408c(0x1af)]<_0x1a22c6+(_0x285dd4[_0x52408c(0xd4)]['minDaysForBaseline']||0x7)){await _0x285dd4[_0x52408c(0x249)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x44639f=_0x285dd4[_0x52408c(0x1ea)]['slice'](-_0x1a22c6),_0x532909=_0x285dd4[_0x52408c(0x1ea)][_0x52408c(0x11b)](0x0,_0x285dd4[_0x52408c(0x1ea)][_0x52408c(0x1af)]-_0x1a22c6),_0x323569=_0x52408c(0x1c1)+JSON[_0x52408c(0x168)](_0x532909)+'\x0aSTB:\x20'+JSON['stringify'](_0x44639f);try{const _0x2a0c1e=await _0x285dd4[_0x52408c(0x1cd)][_0x52408c(0x23c)](_0x323569),_0x47a848=JSON[_0x52408c(0x101)](_0x2a0c1e[_0x52408c(0x160)][_0x52408c(0x127)]()['replace'](/```json|```/g,'')[_0x52408c(0x117)]());_0x47a848[_0x52408c(0xb6)]&&(await _0x285dd4[_0x52408c(0x249)](LTM_DP_DRIFT_STATUS,{'val':_0x47a848['baselineDrift'],'ack':!![]}),await _0x285dd4[_0x52408c(0x249)](LTM_DP_DRIFT_DETAILS,{'val':_0x47a848[_0x52408c(0x22d)],'ack':!![]}),await _0x285dd4[_0x52408c(0x249)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x52408c(0x9e)](),'ack':!![]}));}catch(_0x5b88f5){}}function setupLtmScheduler(_0x1cc3ff){const _0x266b0d=a0_0x45af1a;try{if(_0x1cc3ff[_0x266b0d(0x1ce)])_0x1cc3ff[_0x266b0d(0x1ce)][_0x266b0d(0x198)]();if(!_0x1cc3ff[_0x266b0d(0x136)]){_0x1cc3ff[_0x266b0d(0x249)](LTM_DP_STATUS,{'val':_0x266b0d(0xfb),'ack':!![]});return;}_0x1cc3ff[_0x266b0d(0x1ce)]=schedule[_0x266b0d(0x205)](LTM_SCHEDULE,()=>createDailyDigest(_0x1cc3ff));}catch(_0x4fce05){_0x1cc3ff[_0x266b0d(0xe8)][_0x266b0d(0xb1)](_0x266b0d(0x161)+_0x4fce05[_0x266b0d(0x118)]);}}function setupModeResetScheduler(_0x353c9c){const _0x2259bd=a0_0x45af1a;try{if(_0x353c9c['modeResetJob'])_0x353c9c[_0x2259bd(0x1a6)][_0x2259bd(0x198)]();_0x353c9c[_0x2259bd(0x1a6)]=schedule[_0x2259bd(0x205)](MODE_RESET_SCHEDULE,async()=>{const _0x2ce9d3=_0x2259bd;await loadSystemMode(_0x353c9c),AUTO_RESET_MODES['includes'](_0x353c9c[_0x2ce9d3(0x228)])&&await _0x353c9c[_0x2ce9d3(0x249)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x2ce9d3(0x126)],'ack':![]});});}catch(_0x2a2094){_0x353c9c[_0x2259bd(0xe8)][_0x2259bd(0xb1)](_0x2259bd(0x20b)+_0x2a2094[_0x2259bd(0x118)]);}}function setupDriftAnalysisScheduler(_0x3f28b8){const _0x497f29=a0_0x45af1a;try{if(_0x3f28b8[_0x497f29(0x196)])clearInterval(_0x3f28b8[_0x497f29(0x196)]);if(!_0x3f28b8[_0x497f29(0x136)])return;_0x3f28b8[_0x497f29(0x196)]=setInterval(()=>runBaselineDriftAnalysis(_0x3f28b8),(_0x3f28b8['config'][_0x497f29(0xce)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x3f28b8),0x1388);}catch(_0x395a9c){_0x3f28b8['log'][_0x497f29(0xb1)]('Drift\x20Sched\x20Error:\x20'+_0x395a9c[_0x497f29(0x118)]);}}function setupBriefingScheduler(_0x5a42e1){const _0x25c174=a0_0x45af1a;try{if(_0x5a42e1[_0x25c174(0x12a)])_0x5a42e1['briefingJob'][_0x25c174(0x198)]();if(!_0x5a42e1[_0x25c174(0xd4)][_0x25c174(0x1a8)])return;const _0x158cf1=(_0x5a42e1[_0x25c174(0xd4)][_0x25c174(0x116)]||_0x25c174(0x18d))[_0x25c174(0xa6)](':'),_0x375e7d=parseInt(_0x158cf1[0x0])||0x8,_0x19f185=parseInt(_0x158cf1[0x1])||0x0,_0xe430cb=_0x19f185+'\x20'+_0x375e7d+_0x25c174(0xa9);_0x5a42e1[_0x25c174(0xe8)][_0x25c174(0x176)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x375e7d+':'+(_0x19f185<0xa?'0'+_0x19f185:_0x19f185)),_0x5a42e1['briefingJob']=schedule[_0x25c174(0x205)](_0xe430cb,()=>{sendMorningBriefing(_0x5a42e1);});}catch(_0x35b734){_0x5a42e1[_0x25c174(0xe8)][_0x25c174(0xb1)]('Briefing\x20Sched\x20Error:\x20'+_0x35b734[_0x25c174(0x118)]);}}async function sendNotification(_0x3aac4f,_0x3ae6a6,_0x419fc0=![],_0x40a97b=![]){const _0x337d96=a0_0x45af1a;_0x3aac4f[_0x337d96(0xe8)][_0x337d96(0x176)]((_0x419fc0?_0x337d96(0xf9):'')+_0x337d96(0x11e)+_0x3ae6a6+'\x22');const _0x4f20a9=_0x3aac4f['config'];let _0x4dc720=0x0;if(_0x4f20a9[_0x337d96(0x1db)]){let _0x525e4d={};(_0x3ae6a6[_0x337d96(0x175)](_0x337d96(0x1df))||_0x40a97b)&&(_0x525e4d={'reply_markup':{'inline_keyboard':[[{'text':_0x337d96(0xd5),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x337d96(0x11f),'callback_data':_0x337d96(0x23f)}]]}}),await _0x3aac4f[_0x337d96(0x23a)](_0x4f20a9[_0x337d96(0x140)],_0x337d96(0x15d),{'text':_0x3ae6a6,'user':_0x4f20a9[_0x337d96(0x146)],..._0x525e4d}),_0x4dc720++;}if(_0x4f20a9[_0x337d96(0x172)]){let _0x421103={'message':_0x3ae6a6,'title':_0x40a97b?'ðŸš¨\x20EMERGENCY':_0x337d96(0x1c0),'priority':_0x40a97b?0x2:0x1,'device':_0x4f20a9[_0x337d96(0x15f)]};_0x40a97b&&(_0x421103[_0x337d96(0xe2)]=0x1e,_0x421103[_0x337d96(0x1a9)]=0xe10,_0x421103[_0x337d96(0xb4)]=_0x337d96(0x19a)),await _0x3aac4f['sendToAsync'](_0x4f20a9[_0x337d96(0x199)],_0x337d96(0x15d),_0x421103),_0x4dc720++;}return _0x4f20a9[_0x337d96(0x13f)]&&(await _0x3aac4f['sendToAsync'](_0x4f20a9[_0x337d96(0x17a)],_0x337d96(0x15d),{'text':_0x3ae6a6,'to':_0x4f20a9[_0x337d96(0x22a)]}),_0x4dc720++),_0x4dc720;}async function setupTelegramListener(_0x1fe37a){const _0x1e33a7=a0_0x45af1a,_0x42983c=_0x1fe37a[_0x1e33a7(0xd4)][_0x1e33a7(0x140)];_0x1fe37a[_0x1e33a7(0xd4)][_0x1e33a7(0x1db)]&&_0x42983c&&(_0x1fe37a[_0x1e33a7(0xe8)]['info'](_0x1e33a7(0x9d)+_0x42983c+_0x1e33a7(0xd2)),await _0x1fe37a[_0x1e33a7(0x192)](_0x42983c+'.communicate.request'));}async function handleTelegramResponse(_0x1fcbe1,_0x4c05f2){const _0x2222a6=a0_0x45af1a;let _0x4b2563=_0x4c05f2;_0x4c05f2['startsWith']('[')&&(_0x4b2563=_0x4c05f2[_0x2222a6(0x248)](_0x4c05f2[_0x2222a6(0x19b)](']')+0x1));if(_0x4b2563===_0x2222a6(0x21b))_0x1fcbe1[_0x2222a6(0xe8)][_0x2222a6(0x176)](_0x2222a6(0x151)),await _0x1fcbe1['setStateAsync'](_0x2222a6(0x1d8),{'val':![],'ack':!![]}),await _0x1fcbe1[_0x2222a6(0x249)](_0x2222a6(0x169),{'val':_0x2222a6(0x250),'ack':!![]}),_0x1fcbe1[_0x2222a6(0x24a)]=![],sendNotification(_0x1fcbe1,_0x2222a6(0x25e),![]);else _0x4b2563===_0x2222a6(0x23f)&&(_0x1fcbe1['log'][_0x2222a6(0xf1)](_0x2222a6(0x1ff)),sendNotification(_0x1fcbe1,_0x2222a6(0x164),![],!![]));}async function runAutopilot(_0x5cf4cd){const _0x2a97ec=a0_0x45af1a,_0x76b6bc=_0x5cf4cd[_0x2a97ec(0xd4)][_0x2a97ec(0x210)],_0x31f951=_0x5cf4cd['eventHistory'][_0x2a97ec(0x1af)]>0x0?_0x5cf4cd[_0x2a97ec(0x185)][0x0][_0x2a97ec(0x16f)]:Date['now'](),_0x144505=(Date[_0x2a97ec(0x9e)]()-_0x31f951)/(0x3e8*0x3c*0x3c);let _0xddcaec='';_0x5cf4cd[_0x2a97ec(0xd4)][_0x2a97ec(0x1f6)]&&_0x5cf4cd[_0x2a97ec(0x228)]===SYSTEM_MODES[_0x2a97ec(0x126)]&&_0x5cf4cd[_0x2a97ec(0x18b)]&&(_0x144505>_0x76b6bc&&(_0xddcaec=_0x2a97ec(0x211)+_0x144505['toFixed'](0x1)+_0x2a97ec(0x121))),runGeminiAnalysis(_0x5cf4cd,_0xddcaec)['catch'](_0x4588f7=>_0x5cf4cd[_0x2a97ec(0xe8)][_0x2a97ec(0xb1)](_0x4588f7));}async function createDailyDigest(_0x3d2e74){const _0x2ae890=a0_0x45af1a;if(!_0x3d2e74[_0x2ae890(0x136)])return;await _0x3d2e74[_0x2ae890(0x249)](LTM_DP_STATUS,{'val':_0x2ae890(0x179)+new Date()[_0x2ae890(0x241)](),'ack':!![]});if(!_0x3d2e74[_0x2ae890(0x1cd)]||_0x3d2e74[_0x2ae890(0x1f8)][_0x2ae890(0x1af)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3d2e74[_0x2ae890(0x249)](LTM_DP_STATUS,{'val':_0x2ae890(0xf0),'ack':!![]});return;}const _0x3aa01b=JSON[_0x2ae890(0x101)](JSON['stringify'](_0x3d2e74[_0x2ae890(0x1f8)])),_0x414228=_0x3aa01b[_0x2ae890(0x1af)],_0x180563=_0x2ae890(0x1ad)+JSON[_0x2ae890(0x168)](_0x3aa01b);try{const _0x1ba0b9=await _0x3d2e74[_0x2ae890(0x1cd)][_0x2ae890(0x23c)](_0x180563),_0x5691e8=JSON[_0x2ae890(0x101)](_0x1ba0b9['response'][_0x2ae890(0x127)]()[_0x2ae890(0x202)](/```json|```/g,'')[_0x2ae890(0x117)]());_0x5691e8[_0x2ae890(0xd3)]&&(_0x3d2e74['dailyDigests']['push']({'timestamp':new Date()[_0x2ae890(0x1e2)](),'eventCount':_0x414228,'summary':_0x5691e8[_0x2ae890(0xd3)],'activityLevel':_0x5691e8['activityLevel'],'systemMode':_0x3d2e74['currentSystemMode']}),await saveDailyDigests(_0x3d2e74),_0x3d2e74[_0x2ae890(0x1f8)]=[],await saveRawEventLog(_0x3d2e74),await _0x3d2e74[_0x2ae890(0x249)](LTM_DP_STATUS,{'val':_0x2ae890(0x122)+_0x414228+_0x2ae890(0x1c8),'ack':!![]}));}catch(_0x260c07){await _0x3d2e74[_0x2ae890(0x249)](LTM_DP_STATUS,{'val':_0x2ae890(0xfc)+_0x260c07[_0x2ae890(0x118)],'ack':!![]});}}async function sendMorningBriefing(_0x34796b){const _0x3fdc58=a0_0x45af1a;if(!_0x34796b['geminiModel'])return;_0x34796b[_0x3fdc58(0xe8)][_0x3fdc58(0x176)](_0x3fdc58(0x155));const _0x234bdf=_0x34796b['dailyDigests'][_0x3fdc58(0x1af)]>0x0?_0x34796b[_0x3fdc58(0x1ea)][_0x34796b[_0x3fdc58(0x1ea)][_0x3fdc58(0x1af)]-0x1]:null,_0x4c7b31=_0x234bdf&&_0x234bdf[_0x3fdc58(0xdf)]?_0x234bdf[_0x3fdc58(0xdf)]['sleepScore']:_0x3fdc58(0x201),_0xb76d41=new Date();_0xb76d41[_0x3fdc58(0x144)](0x4,0x0,0x0,0x0);const _0x360c22=_0x34796b[_0x3fdc58(0x185)][_0x3fdc58(0xf7)](_0x3c09c0=>new Date(_0x3c09c0[_0x3fdc58(0x16f)])>_0xb76d41),_0x19e3cf=PERSONA_MAPPING[_0x34796b[_0x3fdc58(0xd4)][_0x3fdc58(0x135)]||_0x3fdc58(0x21e)],_0x17f7f9=_0x34796b['config']['livingContext']||'',_0x2f0d78=await getWeatherContext(_0x34796b),_0x86129c=await getCalendarContext(_0x34796b),_0x52dd56='ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20'+_0x19e3cf+_0x3fdc58(0x258)+_0x17f7f9+_0x3fdc58(0x1d6)+_0x2f0d78+'\x20'+_0x86129c+_0x3fdc58(0x1b2)+_0x4c7b31+_0x3fdc58(0x1da)+JSON[_0x3fdc58(0x168)](_0x360c22[_0x3fdc58(0x11b)](0x0,0xa))+_0x3fdc58(0xc7);try{const _0x2b1424=await _0x34796b[_0x3fdc58(0x1cd)]['generateContent'](_0x52dd56),_0x47cf6f=_0x3fdc58(0x1e4)+_0x2b1424[_0x3fdc58(0x160)][_0x3fdc58(0x127)]()[_0x3fdc58(0x117)]();sendNotification(_0x34796b,_0x47cf6f),_0x34796b[_0x3fdc58(0xe8)]['info'](_0x3fdc58(0x113));}catch(_0x13e464){_0x34796b[_0x3fdc58(0xe8)][_0x3fdc58(0xb1)]('Briefing\x20Error:\x20'+_0x13e464[_0x3fdc58(0x118)]);}}async function scanForDevices(_0x39e19e,_0x3c93d1){const _0xb7f7e7=a0_0x45af1a;_0x39e19e['log'][_0xb7f7e7(0x176)](_0xb7f7e7(0xb2));const _0x386681=[],_0x3a72f3=await _0x39e19e[_0xb7f7e7(0xf8)]('*'),_0x2d673e=await _0x39e19e[_0xb7f7e7(0xf8)](_0xb7f7e7(0xd1),_0xb7f7e7(0x1ed)),_0x572da1=await _0x39e19e['getForeignObjectsAsync'](_0xb7f7e7(0x227),'enum'),_0x42b687={};if(_0x2d673e)for(const _0x58fd0c in _0x2d673e){const _0x418d76=_0x2d673e[_0x58fd0c]['common'][_0xb7f7e7(0xcb)]||[];_0x418d76[_0xb7f7e7(0x195)](_0x5369f8=>{const _0x3a113f=_0xb7f7e7;if(!_0x42b687[_0x5369f8])_0x42b687[_0x5369f8]=[];_0x42b687[_0x5369f8][_0x3a113f(0x1f3)](_0x58fd0c);});}const _0x5694de={};if(_0x572da1)for(const _0x235f95 in _0x572da1){const _0x13fc5a=_0x572da1[_0x235f95][_0xb7f7e7(0x193)]['members']||[],_0x390298=typeof _0x572da1[_0x235f95][_0xb7f7e7(0x193)][_0xb7f7e7(0x24b)]===_0xb7f7e7(0x20d)?_0x572da1[_0x235f95][_0xb7f7e7(0x193)][_0xb7f7e7(0x24b)]['de']:_0x572da1[_0x235f95][_0xb7f7e7(0x193)][_0xb7f7e7(0x24b)];_0x13fc5a[_0xb7f7e7(0x195)](_0x1e2217=>_0x5694de[_0x1e2217]=_0x390298);}const _0x468b47=_0x3c93d1[_0xb7f7e7(0x1fe)]||[],_0x45f750=_0x3c93d1[_0xb7f7e7(0x200)]!==![],_0x27461a=_0x3c93d1['doors']!==![],_0x491400=_0x3c93d1[_0xb7f7e7(0x252)]!==![],_0x5c99b4=_0x3c93d1[_0xb7f7e7(0xee)]===!![],_0xe8db5f=_0x3c93d1[_0xb7f7e7(0x1b7)]===!![];for(const _0xedf3d4 in _0x3a72f3){const _0x1ca950=_0x3a72f3[_0xedf3d4];if(_0x1ca950[_0xb7f7e7(0xc1)]!==_0xb7f7e7(0x1fa)||!_0x1ca950[_0xb7f7e7(0x193)])continue;if(ADAPTER_BLACKLIST[_0xb7f7e7(0xe7)](_0xc6b476=>_0xedf3d4[_0xb7f7e7(0x167)](_0xc6b476))&&!_0xe8db5f)continue;const _0x5232a3=(_0x1ca950[_0xb7f7e7(0x193)][_0xb7f7e7(0x243)]||'')[_0xb7f7e7(0xa5)]();let _0x4f0c9c=(typeof _0x1ca950['common'][_0xb7f7e7(0x24b)]===_0xb7f7e7(0x20d)?_0x1ca950[_0xb7f7e7(0x193)]['name']['de']:_0x1ca950['common'][_0xb7f7e7(0x24b)])||_0xedf3d4;const _0x159d72=_0x4f0c9c[_0xb7f7e7(0xa5)]();let _0x5277e4=![],_0x34b0cc=![];if(_0x468b47['length']>0x0){const _0x4d3e9d=_0x42b687[_0xedf3d4]||[],_0x38715a=_0xedf3d4['split']('.')[_0xb7f7e7(0x11b)](0x0,-0x1)[_0xb7f7e7(0x16a)]('.'),_0x49bfaa=_0x42b687[_0x38715a]||[];(_0x4d3e9d['some'](_0x46c6d4=>_0x468b47['includes'](_0x46c6d4))||_0x49bfaa[_0xb7f7e7(0xe7)](_0x1c8435=>_0x468b47[_0xb7f7e7(0x175)](_0x1c8435)))&&(_0x5277e4=!![],_0x34b0cc=!![]);}if(!_0x5277e4&&!_0xe8db5f){if(HARD_IGNORE_TERMS['some'](_0x1ed536=>_0xedf3d4['includes'](_0x1ed536)||_0x159d72[_0xb7f7e7(0x175)](_0x1ed536[_0xb7f7e7(0xa5)]())))continue;}if(BAD_NAMES[_0xb7f7e7(0xe7)](_0x5ab1da=>_0x159d72===_0x5ab1da||_0x159d72['endsWith']('.'+_0x5ab1da))){const _0x569449=_0xedf3d4['split']('.');if(_0x569449[_0xb7f7e7(0x1af)]>0x2){const _0x108e69=_0x569449[_0xb7f7e7(0x11b)](0x0,-0x1)[_0xb7f7e7(0x16a)]('.'),_0x5ba6e1=_0x3a72f3[_0x108e69];if(_0x5ba6e1&&_0x5ba6e1[_0xb7f7e7(0x193)]&&_0x5ba6e1[_0xb7f7e7(0x193)]['name']){const _0xbd3e19=typeof _0x5ba6e1[_0xb7f7e7(0x193)][_0xb7f7e7(0x24b)]===_0xb7f7e7(0x20d)?_0x5ba6e1['common'][_0xb7f7e7(0x24b)]['de']:_0x5ba6e1[_0xb7f7e7(0x193)][_0xb7f7e7(0x24b)];_0xbd3e19&&!_0x4f0c9c[_0xb7f7e7(0x175)](_0xbd3e19)&&(_0x4f0c9c=_0xbd3e19+'\x20'+_0x4f0c9c);}}}let _0x1d42b4='';if(_0x45f750&&(_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0x200))||_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0x1cc))||_0x159d72[_0xb7f7e7(0x175)](_0xb7f7e7(0xbd))||_0x159d72[_0xb7f7e7(0x175)](_0xb7f7e7(0xd9))))_0x1d42b4='motion';else{if(!_0x1d42b4&&_0x27461a&&(_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0x218))||_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0x1c5))||_0x5232a3['includes'](_0xb7f7e7(0x22f))||_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0x119))||_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0x187))||_0x159d72['includes'](_0xb7f7e7(0xda))||_0x159d72[_0xb7f7e7(0x175)](_0xb7f7e7(0x111))||_0x159d72[_0xb7f7e7(0x175)](_0xb7f7e7(0x1e8))))_0x1d42b4=_0xb7f7e7(0x218);else{if(!_0x1d42b4&&_0x491400&&(_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0xb3))||_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0x25b))||_0x5232a3[_0xb7f7e7(0x175)]('dimmer')||_0x159d72[_0xb7f7e7(0x175)](_0xb7f7e7(0x115))||_0x159d72['includes'](_0xb7f7e7(0x261))||_0x159d72[_0xb7f7e7(0x175)]('schalter'))){if(_0x1ca950[_0xb7f7e7(0x193)]['write']||_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0xe3)))_0x1d42b4=_0xb7f7e7(0xb3);}else{if(!_0x1d42b4&&_0x5c99b4&&(_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0xee))||_0x5232a3[_0xb7f7e7(0x175)](_0xb7f7e7(0x1b1))||_0x5232a3['includes'](_0xb7f7e7(0x1b5))||_0x159d72[_0xb7f7e7(0x175)](_0xb7f7e7(0x153))||_0x159d72['includes'](_0xb7f7e7(0xe9))||_0x159d72[_0xb7f7e7(0x175)](_0xb7f7e7(0x128))))_0x1d42b4=_0xb7f7e7(0xee);else{if(!_0x1d42b4&&_0x34b0cc)_0x1d42b4=_0xb7f7e7(0x180);}}}}if(_0x1d42b4){let _0x2a4c89=_0x5694de[_0xedf3d4]||'';if(!_0x2a4c89){let _0xe59aae=_0xedf3d4;for(let _0x496815=0x0;_0x496815<0x3;_0x496815++){const _0x18131b=_0xe59aae['lastIndexOf']('.');if(_0x18131b===-0x1)break;_0xe59aae=_0xe59aae[_0xb7f7e7(0x248)](0x0,_0x18131b);if(_0x5694de[_0xe59aae]){_0x2a4c89=_0x5694de[_0xe59aae];break;}}}_0x386681[_0xb7f7e7(0x1f3)]({'id':_0xedf3d4,'name':_0x4f0c9c,'location':_0x2a4c89,'type':_0x1d42b4,'logDuplicates':_0x1d42b4===_0xb7f7e7(0x200),'isExit':![],'_score':_0x2a4c89?0x50:_0x1d42b4===_0xb7f7e7(0x180)?0x5a:0x28});}}return _0x386681['sort']((_0x25e8fd,_0x20bc5d)=>_0x20bc5d['_score']-_0x25e8fd[_0xb7f7e7(0x1fd)]),_0x386681;}async function executeAutomationAction(_0x1a78ea){const _0x179c76=a0_0x45af1a;try{const _0x123eeb=await _0x1a78ea[_0x179c76(0xc6)]('analysis.automation.targetId'),_0xadcd26=await _0x1a78ea[_0x179c76(0xc6)]('analysis.automation.targetValue');if(_0x123eeb&&_0x123eeb[_0x179c76(0x197)]&&_0xadcd26){const _0xbd029e=_0x123eeb[_0x179c76(0x197)];let _0xe1e7fe=_0xadcd26[_0x179c76(0x197)];try{_0xe1e7fe=JSON['parse'](_0xe1e7fe);}catch(_0xc6366d){}_0x1a78ea[_0x179c76(0xe8)][_0x179c76(0x176)](_0x179c76(0x203)+_0xbd029e+_0x179c76(0xed)+_0xe1e7fe),await _0x1a78ea[_0x179c76(0x15e)](_0xbd029e,_0xe1e7fe);}else _0x1a78ea[_0x179c76(0xe8)][_0x179c76(0xf1)](_0x179c76(0x22e));}catch(_0x197132){_0x1a78ea[_0x179c76(0xe8)][_0x179c76(0xb1)]('BUTLER\x20Execution\x20Error:\x20'+_0x197132[_0x179c76(0x118)]);}}function tryParse(_0x14f938){const _0x29f5a6=a0_0x45af1a;try{return JSON[_0x29f5a6(0x101)](_0x14f938);}catch(_0x19cdde){return null;}}async function processSensorEvent(_0x467a20,_0x4ef40c,_0x6fefca,_0x35c6f6){const _0x4bf624=a0_0x45af1a;if(!_0x35c6f6)return;const _0x3c203b=_0x6fefca[_0x4bf624(0x197)],_0xaa6e28=Date['now']();_0x467a20[_0x4bf624(0xe8)]['debug'](_0x4bf624(0xea)+_0x4ef40c+_0x4bf624(0xed)+_0x3c203b),_0x467a20['sensorLastValues'][_0x4ef40c]=_0x3c203b;if(!_0x35c6f6[_0x4bf624(0x12c)]&&_0x467a20[_0x4bf624(0x185)]&&_0x467a20['eventHistory']['length']>0x0){const _0x2ccf9d=_0x467a20[_0x4bf624(0x185)][0x0];if(_0x2ccf9d['id']===_0x4ef40c&&_0x2ccf9d['value']===_0x3c203b&&_0xaa6e28-_0x2ccf9d['timestamp']<0x7d0)return;}const _0x5352fd={'timestamp':_0xaa6e28,'id':_0x4ef40c,'name':_0x35c6f6['name'],'type':_0x35c6f6[_0x4bf624(0xc1)],'location':_0x35c6f6[_0x4bf624(0xad)],'value':_0x3c203b};_0x467a20[_0x4bf624(0x185)]['unshift'](_0x5352fd);if(_0x467a20['eventHistory'][_0x4bf624(0x1af)]>HISTORY_MAX_SIZE)_0x467a20[_0x4bf624(0x185)][_0x4bf624(0x1a4)]();await _0x467a20['setStateAsync'](_0x4bf624(0xe4),{'val':JSON[_0x4bf624(0x168)](_0x5352fd),'ack':!![]}),await _0x467a20[_0x4bf624(0x249)](_0x4bf624(0xfd),{'val':JSON[_0x4bf624(0x168)](_0x467a20['eventHistory']),'ack':!![]});_0x467a20[_0x4bf624(0x136)]&&(_0x467a20['rawEventLog']['push'](_0x5352fd),await saveRawEventLog(_0x467a20));if(_0x35c6f6['isExit']&&_0x3c203b===!![]){if(_0x467a20[_0x4bf624(0x18b)]&&!_0x467a20[_0x4bf624(0x1a2)])_0x467a20[_0x4bf624(0xe8)][_0x4bf624(0x176)]('Exit\x20Sensor\x20triggered\x20('+_0x35c6f6[_0x4bf624(0x24b)]+_0x4bf624(0x106)),startExitTimer(_0x467a20);else!_0x467a20['isPresent']&&(_0x467a20[_0x4bf624(0xe8)][_0x4bf624(0x176)]('Entry\x20detected\x20via\x20'+_0x35c6f6[_0x4bf624(0x24b)]+_0x4bf624(0x17b)),await setPresence(_0x467a20,!![]));}else _0x35c6f6[_0x4bf624(0xc1)]==='motion'&&_0x3c203b===!![]&&(_0x467a20[_0x4bf624(0x1bd)]&&(_0x467a20[_0x4bf624(0xe8)]['info'](_0x4bf624(0x1ab)),abortExitTimer(_0x467a20)),!_0x467a20[_0x4bf624(0x18b)]&&_0x467a20['currentSystemMode']===SYSTEM_MODES[_0x4bf624(0x126)]&&await setPresence(_0x467a20,!![]));}async function runGeminiAnalysis(_0x80c4f,_0x24b5e9=''){const _0xaf5eaf=a0_0x45af1a;if(!_0x80c4f[_0xaf5eaf(0x1cd)])return;if(_0x80c4f[_0xaf5eaf(0x185)][_0xaf5eaf(0x1af)]===0x0)return;const _0x4252b4=_0x80c4f[_0xaf5eaf(0x185)][_0xaf5eaf(0x11b)](0x0,0xf),_0x219b8c=await getWeatherContext(_0x80c4f),_0x3b288d=_0x80c4f[_0xaf5eaf(0x228)],_0x3d1e31=PERSONA_MAPPING[_0x80c4f['config'][_0xaf5eaf(0x135)]||'generic'],_0x4f486e=_0x80c4f[_0xaf5eaf(0xd4)]['livingContext']||_0xaf5eaf(0x1d4);let _0x434873=![];try{const _0x46266c=await _0x80c4f[_0xaf5eaf(0xc6)](_0xaf5eaf(0xd0));if(_0x46266c&&_0x46266c[_0xaf5eaf(0x197)])_0x434873=!![];}catch(_0x3dbdab){}const _0x3a864b=_0xaf5eaf(0x234)+_0x3d1e31+_0xaf5eaf(0x1a5)+_0x4f486e+_0xaf5eaf(0x251)+_0x3b288d+_0xaf5eaf(0x131)+_0x219b8c+_0xaf5eaf(0xde)+(_0x24b5e9||_0xaf5eaf(0xa0))+'.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20'+JSON[_0xaf5eaf(0x168)](_0x4252b4)+_0xaf5eaf(0x1e1);try{const _0x3632bd=await _0x80c4f[_0xaf5eaf(0x1cd)][_0xaf5eaf(0x23c)](_0x3a864b),_0x5e51ed=_0x3632bd['response'][_0xaf5eaf(0x127)]()[_0xaf5eaf(0x202)](/```json|```/g,'')[_0xaf5eaf(0x117)](),_0xb6cdc=JSON[_0xaf5eaf(0x101)](_0x5e51ed);await _0x80c4f[_0xaf5eaf(0x249)](_0xaf5eaf(0xc4),{'val':JSON[_0xaf5eaf(0x168)](_0xb6cdc),'ack':!![]});const _0x5eae29=_0xb6cdc[_0xaf5eaf(0x23b)]||![];_0x5eae29!==_0x80c4f[_0xaf5eaf(0x24a)]&&(await _0x80c4f['setStateAsync'](_0xaf5eaf(0x1d8),{'val':_0x5eae29,'ack':!![]}),_0x80c4f[_0xaf5eaf(0x24a)]=_0x5eae29,_0x5eae29&&(await _0x80c4f[_0xaf5eaf(0x249)](_0xaf5eaf(0x169),{'val':_0xb6cdc[_0xaf5eaf(0x10d)],'ack':!![]}),sendNotification(_0x80c4f,_0xaf5eaf(0x19c)+_0xb6cdc[_0xaf5eaf(0x10d)],![],_0xb6cdc[_0xaf5eaf(0x24e)]))),_0xb6cdc['automationProposal']&&_0xb6cdc[_0xaf5eaf(0x181)][_0xaf5eaf(0x14b)]&&_0xb6cdc[_0xaf5eaf(0x181)][_0xaf5eaf(0x204)]&&(_0x80c4f[_0xaf5eaf(0xe8)]['info'](_0xaf5eaf(0xd8)+_0xb6cdc[_0xaf5eaf(0x181)][_0xaf5eaf(0x13b)]),await _0x80c4f[_0xaf5eaf(0x249)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x80c4f['setStateAsync'](_0xaf5eaf(0x1c7),{'val':_0xb6cdc[_0xaf5eaf(0x181)]['description'],'ack':!![]}),await _0x80c4f['setStateAsync']('analysis.automation.targetId',{'val':_0xb6cdc[_0xaf5eaf(0x181)][_0xaf5eaf(0x204)],'ack':!![]}),await _0x80c4f['setStateAsync'](_0xaf5eaf(0x130),{'val':JSON[_0xaf5eaf(0x168)](_0xb6cdc[_0xaf5eaf(0x181)]['targetValue']),'ack':!![]}),_0x434873&&(_0x80c4f[_0xaf5eaf(0xe8)][_0xaf5eaf(0x176)]('ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20'+_0xb6cdc[_0xaf5eaf(0x181)][_0xaf5eaf(0x204)]+_0xaf5eaf(0x21f)),await executeAutomationAction(_0x80c4f)));}catch(_0x2055d9){_0x80c4f[_0xaf5eaf(0xe8)]['error'](_0xaf5eaf(0x24d)+_0x2055d9['message']);}}function startPythonService(_0x4d3389){const _0x14297e=a0_0x45af1a;try{const _0x410448=path['join'](__dirname,_0x14297e(0x1f4),_0x14297e(0x236));_0x4d3389[_0x14297e(0xe8)]['info'](_0x14297e(0xf3)+_0x410448),_0x4d3389[_0x14297e(0x1d3)]=spawn('python3',[_0x410448]),_0x4d3389[_0x14297e(0x1d3)]['stdout']['on'](_0x14297e(0x112),_0x590f88=>{const _0x5d294b=_0x14297e,_0xb31ccf=_0x590f88[_0x5d294b(0xb5)]()['trim']();_0x4d3389[_0x5d294b(0xe8)]['debug'](_0x5d294b(0x9f)+_0xb31ccf);}),_0x4d3389[_0x14297e(0x1d3)][_0x14297e(0xa1)]['on']('data',_0x83ae46=>{const _0x49600b=_0x14297e,_0x571f45=_0x83ae46[_0x49600b(0xb5)]()[_0x49600b(0x117)]();_0x4d3389[_0x49600b(0xe8)][_0x49600b(0xb1)](_0x49600b(0x1d0)+_0x571f45);}),_0x4d3389[_0x14297e(0x1d3)]['on'](_0x14297e(0x1f5),_0x26238e=>{const _0x8f3836=_0x14297e;_0x4d3389[_0x8f3836(0xe8)][_0x8f3836(0x176)](_0x8f3836(0x14c)+_0x26238e),_0x4d3389[_0x8f3836(0x1d3)]=null;}),_0x4d3389['pythonProcess']['on'](_0x14297e(0xb1),_0x182933=>{const _0x4e6d3a=_0x14297e;_0x4d3389[_0x4e6d3a(0xe8)]['warn'](_0x4e6d3a(0x17e)+_0x182933[_0x4e6d3a(0x118)]);});}catch(_0x11fd00){_0x4d3389[_0x14297e(0xe8)]['error'](_0x14297e(0x107)+_0x11fd00[_0x14297e(0x118)]);}}function stopPythonService(_0x209d3f){const _0x7cf051=a0_0x45af1a;if(_0x209d3f['pythonProcess']){_0x209d3f[_0x7cf051(0xe8)][_0x7cf051(0x176)]('ðŸ\x20Stopping\x20Python\x20Sidecar...');try{_0x209d3f[_0x7cf051(0x1d3)][_0x7cf051(0xaa)]();}catch(_0xe9007b){_0x209d3f[_0x7cf051(0xe8)][_0x7cf051(0xf1)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0xe9007b[_0x7cf051(0x118)]);}_0x209d3f[_0x7cf051(0x1d3)]=null;}}function a0_0x5c80(_0x48d241,_0x5bf702){const _0x34b977=a0_0x394c();return a0_0x5c80=function(_0x5467ae,_0x169dc0){_0x5467ae=_0x5467ae-0x9d;let _0x394c73=_0x34b977[_0x5467ae];return _0x394c73;},a0_0x5c80(_0x48d241,_0x5bf702);}class CogniLiving extends utils['Adapter']{constructor(_0x19730f){const _0x217d7b=a0_0x45af1a;super({..._0x19730f,'name':_0x217d7b(0x1a7)}),this[_0x217d7b(0x185)]=[],this['analysisHistory']=[],this[_0x217d7b(0x152)]=[],this[_0x217d7b(0x1f8)]=[],this[_0x217d7b(0x1ea)]=[],this[_0x217d7b(0x10b)]={},this[_0x217d7b(0x237)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x217d7b(0x18b)]=!![],this[_0x217d7b(0x1bd)]=null,this[_0x217d7b(0x14d)]=null,this[_0x217d7b(0x1a2)]=![],this[_0x217d7b(0xd7)]=null,this['geminiModel']=null,this[_0x217d7b(0x228)]=SYSTEM_MODES[_0x217d7b(0x126)],this['isProVersion']=![],this[_0x217d7b(0x24a)]=![],this['systemUUID']='unknown',this[_0x217d7b(0x13d)]=null,this['ltmJob']=null,this[_0x217d7b(0x1a6)]=null,this['driftAnalysisTimer']=null,this[_0x217d7b(0x12a)]=null,this[_0x217d7b(0x1d3)]=null,this['on']('ready',this['onReady'][_0x217d7b(0x20e)](this)),this['on'](_0x217d7b(0x108),this[_0x217d7b(0xca)][_0x217d7b(0x20e)](this)),this['on'](_0x217d7b(0x245),this['onUnload'][_0x217d7b(0x20e)](this)),this['on']('message',this[_0x217d7b(0xc5)][_0x217d7b(0x20e)](this));}async[a0_0x45af1a(0x171)](){const _0x52cbb5=a0_0x45af1a;this[_0x52cbb5(0xe8)]['info'](_0x52cbb5(0x1e6)+this[_0x52cbb5(0x1bc)]+_0x52cbb5(0x1a3)),await initZombies(this),this['config'][_0x52cbb5(0x221)]=this['config'][_0x52cbb5(0x221)]||'';try{this[_0x52cbb5(0x136)]=await checkLicense(this,this[_0x52cbb5(0xd4)][_0x52cbb5(0x221)]);}catch(_0x1c841e){}if(!this[_0x52cbb5(0xd4)][_0x52cbb5(0x210)]||this[_0x52cbb5(0xd4)][_0x52cbb5(0x210)]<0.1)this[_0x52cbb5(0xd4)][_0x52cbb5(0x210)]=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x52cbb5(0xd4)][_0x52cbb5(0x1f2)])try{this[_0x52cbb5(0xd7)]=new GoogleGenerativeAI(this[_0x52cbb5(0xd4)][_0x52cbb5(0x1f2)]),this[_0x52cbb5(0x1cd)]=this[_0x52cbb5(0xd7)][_0x52cbb5(0xeb)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x52cbb5(0x21d)}}),this[_0x52cbb5(0xe8)]['info'](_0x52cbb5(0x11d));}catch(_0x730f5c){this['log']['error'](_0x52cbb5(0x1e7)+_0x730f5c[_0x52cbb5(0x118)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x52cbb5(0x10c)]('analysis.trigger'),this[_0x52cbb5(0x10c)](LTM_DP_TRIGGER_DIGEST),this[_0x52cbb5(0x10c)]('system.mode'),this[_0x52cbb5(0x10c)]('analysis.triggerBriefing'),this[_0x52cbb5(0x10c)](_0x52cbb5(0x141)),this[_0x52cbb5(0x10c)](_0x52cbb5(0xd0)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this['analysisTimer'])clearInterval(this[_0x52cbb5(0x13d)]);const _0x5a75c5=this[_0x52cbb5(0xd4)]['analysisInterval']||0xf;_0x5a75c5>0x0&&(this['log'][_0x52cbb5(0x176)](_0x52cbb5(0x1e3)+_0x5a75c5+_0x52cbb5(0xb7)),this[_0x52cbb5(0x13d)]=setInterval(()=>{runAutopilot(this);},_0x5a75c5*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this);}[a0_0x45af1a(0x240)](_0x5954c5){const _0x2c44bf=a0_0x45af1a;if(this[_0x2c44bf(0x13d)])clearInterval(this[_0x2c44bf(0x13d)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x2c44bf(0x196)]);if(this[_0x2c44bf(0x1ce)])this[_0x2c44bf(0x1ce)][_0x2c44bf(0x198)]();if(this[_0x2c44bf(0x1a6)])this[_0x2c44bf(0x1a6)]['cancel']();if(this[_0x2c44bf(0x12a)])this[_0x2c44bf(0x12a)][_0x2c44bf(0x198)]();if(this[_0x2c44bf(0x1bd)])clearTimeout(this['exitTimer']);if(this[_0x2c44bf(0x14d)])clearTimeout(this[_0x2c44bf(0x14d)]);stopPythonService(this),_0x5954c5();}async['onStateChange'](_0xd44846,_0x2f7d4f){const _0x206834=a0_0x45af1a;if(!_0x2f7d4f)return;if(_0xd44846[_0x206834(0x175)](_0x206834(0x190))&&_0xd44846[_0x206834(0x1be)](_0x206834(0x142))&&_0x2f7d4f[_0x206834(0x197)]){await handleTelegramResponse(this,_0x2f7d4f[_0x206834(0x197)]);return;}if(_0xd44846===this[_0x206834(0x16d)]+'.'+SYSTEM_DP_MODE){_0x2f7d4f['val']&&Object['values'](SYSTEM_MODES)[_0x206834(0x175)](_0x2f7d4f[_0x206834(0x197)])&&(this[_0x206834(0x228)]=_0x2f7d4f[_0x206834(0x197)],_0x2f7d4f['val']===SYSTEM_MODES[_0x206834(0x12e)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x2f7d4f[_0x206834(0x256)])this[_0x206834(0x18c)](_0xd44846,{'val':this[_0x206834(0x228)],'ack':!![]});return;}if(!_0x2f7d4f['ack']){_0xd44846[_0x206834(0x175)](_0x206834(0x134))&&_0x2f7d4f[_0x206834(0x197)]&&(this[_0x206834(0x18c)](_0xd44846,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0xd44846['includes']('triggerDailyDigest')&&_0x2f7d4f[_0x206834(0x197)]){this[_0x206834(0x18c)](_0xd44846,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0xd44846[_0x206834(0x175)](_0x206834(0x163))&&_0x2f7d4f[_0x206834(0x197)]&&(this['setState'](_0xd44846,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0xd44846[_0x206834(0x175)]('automation.triggerAction')&&_0x2f7d4f['val']&&(this[_0x206834(0x18c)](_0xd44846,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x206834(0xd4)]['presenceDevices']&&this[_0x206834(0xd4)][_0x206834(0x1cb)]['includes'](_0xd44846)){await checkWifiPresence(this);return;}const _0x3823e4=(this['config'][_0x206834(0x156)]||[])[_0x206834(0x1d5)](_0x599b0c=>_0x599b0c['id']===_0xd44846);if(_0x3823e4)processSensorEvent(this,_0xd44846,_0x2f7d4f,_0x3823e4);}async[a0_0x45af1a(0xc5)](_0x5d09d0){const _0x23ef44=a0_0x45af1a;if(typeof _0x5d09d0==='object'&&_0x5d09d0[_0x23ef44(0x118)])try{if(_0x5d09d0['command']===_0x23ef44(0x25a)){}else{if(_0x5d09d0[_0x23ef44(0x14f)]===_0x23ef44(0xba)){}else{if(_0x5d09d0['command']===_0x23ef44(0x1b3)){if(!this[_0x23ef44(0x136)])return this[_0x23ef44(0xe5)](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0['command'],{'success':![],'isPro':![]},_0x5d09d0[_0x23ef44(0x20c)]);let _0x104fd4={'status':_0x23ef44(0x201),'details':'','lastCheck':0x0};try{_0x104fd4['status']=(await this[_0x23ef44(0xc6)](LTM_DP_DRIFT_STATUS))['val'],_0x104fd4['details']=(await this[_0x23ef44(0xc6)](LTM_DP_DRIFT_DETAILS))['val'],_0x104fd4['lastCheck']=(await this[_0x23ef44(0xc6)](LTM_DP_DRIFT_LAST_CHECK))[_0x23ef44(0x197)];}catch(_0x42d7a6){}const _0x472008=this[_0x23ef44(0x194)]||[];this[_0x23ef44(0xe5)](_0x5d09d0['from'],_0x5d09d0[_0x23ef44(0x14f)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x23ef44(0x1ea)],'driftAnalysis':_0x104fd4,'analysisHistory':_0x472008},_0x5d09d0[_0x23ef44(0x20c)]);}else{if(_0x5d09d0[_0x23ef44(0x14f)]===_0x23ef44(0xe6)){const _0x2f6c7b=this[_0x23ef44(0x1ea)][_0x23ef44(0x1af)],_0x402d74=new Date(),_0x53083d=new Date(_0x402d74['getFullYear'](),_0x402d74[_0x23ef44(0x165)](),_0x402d74[_0x23ef44(0xef)]())[_0x23ef44(0x124)](),_0x2d11f6=this['rawEventLog'][_0x23ef44(0xf7)](_0x315c29=>new Date(_0x315c29[_0x23ef44(0x16f)])[_0x23ef44(0x124)]()>_0x53083d)['length'],_0x30427a=new Array(0x18)['fill'](0x0);this['rawEventLog'][_0x23ef44(0x195)](_0x437471=>{const _0x1cf6b6=_0x23ef44,_0x4c39b7=new Date(_0x437471['timestamp']);if(_0x4c39b7[_0x1cf6b6(0x124)]()>_0x53083d)_0x30427a[_0x4c39b7[_0x1cf6b6(0xf6)]()]++;});let _0x4d7ed5={'status':_0x23ef44(0x201)};try{_0x4d7ed5[_0x23ef44(0xf5)]=(await this[_0x23ef44(0xc6)](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x169c58){}let _0x192a8b='';try{const _0x6dec5e=await this[_0x23ef44(0xc6)](_0x23ef44(0x1b9));_0x192a8b=_0x6dec5e?_0x6dec5e['val']:'';}catch(_0x16a84d){}let _0x559fde=null;!this[_0x23ef44(0x1cd)]&&(_0x559fde=this[_0x23ef44(0xd4)][_0x23ef44(0x1f2)]?'KI-Modell\x20nicht\x20initialisiert':_0x23ef44(0xfe));let _0x290518={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x41d9c0=await this[_0x23ef44(0xc6)](_0x23ef44(0x120)),_0x143577=await this['getStateAsync'](_0x23ef44(0x1c7)),_0xbb06bb=await this['getStateAsync'](_0x23ef44(0x253)),_0x1eae78=await this[_0x23ef44(0xc6)](_0x23ef44(0x130)),_0x6ca6cf=await this[_0x23ef44(0xc6)](_0x23ef44(0xd0));_0x41d9c0&&_0x41d9c0[_0x23ef44(0x197)]&&(_0x290518['detected']=!![],_0x290518[_0x23ef44(0x13b)]=_0x143577?_0x143577['val']:'',_0x290518[_0x23ef44(0x204)]=_0xbb06bb?_0xbb06bb[_0x23ef44(0x197)]:'',_0x290518[_0x23ef44(0x21c)]=_0x1eae78?_0x1eae78[_0x23ef44(0x197)]:''),_0x290518[_0x23ef44(0x1bb)]=_0x6ca6cf?!!_0x6ca6cf[_0x23ef44(0x197)]:![];}catch(_0x579aa0){}this[_0x23ef44(0xe5)](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0[_0x23ef44(0x14f)],{'success':!![],'eventHistory':this[_0x23ef44(0x185)][_0x23ef44(0x11b)](0x0,0xf),'stats':{'digestCount':_0x2f6c7b,'eventCountToday':_0x2d11f6,'hourlyActivity':_0x30427a,'driftStatus':_0x4d7ed5[_0x23ef44(0xf5)],'isPresent':this[_0x23ef44(0x18b)],'presenceWho':_0x192a8b,'minDays':this[_0x23ef44(0xd4)][_0x23ef44(0x1f0)]||0x7,'stbDays':this[_0x23ef44(0xd4)][_0x23ef44(0x14e)]||0xe,'ltbDays':this[_0x23ef44(0xd4)][_0x23ef44(0x143)]||0x3c,'systemError':_0x559fde},'automation':_0x290518},_0x5d09d0[_0x23ef44(0x20c)]);}else{if(_0x5d09d0['command']===_0x23ef44(0x102)){const _0x1bbe63=await this['getForeignObjectsAsync'](_0x23ef44(0xd1),_0x23ef44(0x1ed)),_0x1d6bc5=[];if(_0x1bbe63)for(const _0x335570 in _0x1bbe63){const _0x290cec=_0x1bbe63[_0x335570],_0x337cf2=(_0x290cec[_0x23ef44(0x193)]&&typeof _0x290cec[_0x23ef44(0x193)][_0x23ef44(0x24b)]===_0x23ef44(0x20d)?_0x290cec[_0x23ef44(0x193)]['name']['de']:_0x290cec['common'][_0x23ef44(0x24b)])||_0x290cec['common'][_0x23ef44(0x24b)];_0x1d6bc5['push']({'id':_0x335570,'name':_0x337cf2});}this[_0x23ef44(0xe5)](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0[_0x23ef44(0x14f)],{'success':!![],'enums':_0x1d6bc5},_0x5d09d0[_0x23ef44(0x20c)]);}else{if(_0x5d09d0[_0x23ef44(0x14f)]===_0x23ef44(0xc3))try{const _0x5acfce=await scanForDevices(this,_0x5d09d0[_0x23ef44(0x118)]||{});this[_0x23ef44(0xe5)](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0[_0x23ef44(0x14f)],{'success':!![],'devices':_0x5acfce},_0x5d09d0[_0x23ef44(0x20c)]);}catch(_0x4661bd){this[_0x23ef44(0xe5)](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0[_0x23ef44(0x14f)],{'success':![],'error':_0x4661bd[_0x23ef44(0x118)]},_0x5d09d0['callback']);}else{if(_0x5d09d0[_0x23ef44(0x14f)]===_0x23ef44(0x213)){const _0x28321f=_0x5d09d0[_0x23ef44(0x118)][_0x23ef44(0x238)];if(!_0x28321f)return this[_0x23ef44(0xe5)](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0[_0x23ef44(0x14f)],{'success':![],'error':_0x23ef44(0x10e)},_0x5d09d0[_0x23ef44(0x20c)]);const _0x489b02=await getCalendarNames(this,_0x28321f);this[_0x23ef44(0xe5)](_0x5d09d0['from'],_0x5d09d0[_0x23ef44(0x14f)],{'success':!![],'names':_0x489b02},_0x5d09d0[_0x23ef44(0x20c)]);}else{if(_0x5d09d0['command']===_0x23ef44(0x1ee)){const {targetId:_0x7bbde3,targetValue:_0x2d5aec}=_0x5d09d0['message'];this['log'][_0x23ef44(0x176)](_0x23ef44(0xdc)+_0x7bbde3+_0x23ef44(0xed)+_0x2d5aec),await this[_0x23ef44(0x249)](_0x23ef44(0x120),{'val':!![],'ack':!![]}),await this[_0x23ef44(0x249)](_0x23ef44(0x1c7),{'val':_0x23ef44(0x104)+_0x7bbde3,'ack':!![]}),await this[_0x23ef44(0x249)](_0x23ef44(0x253),{'val':_0x7bbde3,'ack':!![]}),await this[_0x23ef44(0x249)]('analysis.automation.targetValue',{'val':_0x2d5aec,'ack':!![]}),this[_0x23ef44(0xe5)](_0x5d09d0['from'],_0x5d09d0[_0x23ef44(0x14f)],{'success':!![]},_0x5d09d0[_0x23ef44(0x20c)]);}else{if(_0x5d09d0[_0x23ef44(0x14f)]===_0x23ef44(0x1c4)){const {historyId:_0x16d8e7,rating:_0x2a1441,comment:_0x2d59d2,alertReason:_0xbde4d7}=_0x5d09d0[_0x23ef44(0x118)];_0x16d8e7&&_0x2a1441?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x16d8e7,'rating':_0x2a1441,'comment':_0x2d59d2,'alertReason':_0xbde4d7}),this['sendTo'](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0[_0x23ef44(0x14f)],{'success':!![]},_0x5d09d0[_0x23ef44(0x20c)])):this[_0x23ef44(0xe5)](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0[_0x23ef44(0x14f)],{'success':![],'error':_0x23ef44(0x159)},_0x5d09d0['callback']);}else _0x5d09d0[_0x23ef44(0x14f)]===_0x23ef44(0x209)&&(this[_0x23ef44(0xe8)][_0x23ef44(0x176)](_0x23ef44(0xab)),await this[_0x23ef44(0x249)](_0x23ef44(0x120),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x23ef44(0x1c7),{'val':'','ack':!![]}),this['sendTo'](_0x5d09d0[_0x23ef44(0xc8)],_0x5d09d0[_0x23ef44(0x14f)],{'success':!![]},_0x5d09d0[_0x23ef44(0x20c)]));}}}}}}}}}catch(_0x399aab){this[_0x23ef44(0xe8)][_0x23ef44(0xb1)](_0x23ef44(0x1c9)+_0x5d09d0[_0x23ef44(0x14f)]+':\x20'+_0x399aab[_0x23ef44(0x118)]);if(_0x5d09d0[_0x23ef44(0x20c)])this['sendTo'](_0x5d09d0['from'],_0x5d09d0[_0x23ef44(0x14f)],{'success':![],'error':_0x399aab[_0x23ef44(0x118)]},_0x5d09d0[_0x23ef44(0x20c)]);}}}if(require[a0_0x45af1a(0x233)]!==module)module['exports']=_0x4eeee6=>new CogniLiving(_0x4eeee6);else new CogniLiving();