const a0_0x2346fb=a0_0x16a7;(function(_0x493b5f,_0x35f57e){const _0x17244e=a0_0x16a7,_0x485cbe=_0x493b5f();while(!![]){try{const _0x1caa1d=parseInt(_0x17244e(0x1d2))/0x1*(-parseInt(_0x17244e(0x1df))/0x2)+-parseInt(_0x17244e(0x1ef))/0x3*(-parseInt(_0x17244e(0x20a))/0x4)+-parseInt(_0x17244e(0x298))/0x5+parseInt(_0x17244e(0x1f1))/0x6+parseInt(_0x17244e(0x1c8))/0x7*(parseInt(_0x17244e(0x218))/0x8)+parseInt(_0x17244e(0x1e5))/0x9*(-parseInt(_0x17244e(0x1dc))/0xa)+parseInt(_0x17244e(0x263))/0xb;if(_0x1caa1d===_0x35f57e)break;else _0x485cbe['push'](_0x485cbe['shift']());}catch(_0x38b952){_0x485cbe['push'](_0x485cbe['shift']());}}}(a0_0x32fb,0x8f760));function a0_0x16a7(_0x198bdb,_0x360fef){const _0x58cc7c=a0_0x32fb();return a0_0x16a7=function(_0x4ae2fb,_0x243857){_0x4ae2fb=_0x4ae2fb-0x1ba;let _0x32fb92=_0x58cc7c[_0x4ae2fb];return _0x32fb92;},a0_0x16a7(_0x198bdb,_0x360fef);}function a0_0x32fb(){const _0x522f94=['ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','startService','8hGyKix','Instanz\x20nicht\x20gefunden','runPythonHealthCheck','exitTimer','TRAIN_COMFORT','fill','PREDICT_ENERGY','VACATION','common','Keine\x20Antwort\x20von\x20Gemini','Gemini\x20AI\x20initialized.','triggerDailyDigest','map','ltmJob','analysis.topology.structure','location',')\x20-\x20Phase\x20C\x20(Solar\x20Gain)','Current.WeatherText','exitGraceTimer','timestamp','analysisInterval','analysis.trigger','TRAIN_ENERGY','analysis.automation.targetId','systemConfig','val','SYSTEM_MODES','floor','createDailyDigest','apply','Daten\x20nicht\x20verfÃ¼gbar','./lib/setup','setupBriefingScheduler','pop','analysis.training.triggerEnergy','initSystemConfig','getLtmData','isProVersion','enum.functions.*','command','analysisTimer','geminiModel','analysis.training.triggerSecurity','WiFi\x20Presence\x20detected.','dismissAutomation','message','./lib/scanner','models/gemini-flash-latest','sort','NORMAL','Kein\x20Kalender-Adapter','minutes_safe','presenceDevices','subscribeForeignStatesAsync','getForeignObjectsAsync','Activity-Level','add','sendTo','includes','Adapter','scanDevices','./lib/recorder','analysis.training.triggerComfort','analysis.automation.autoApply','instance','onUnload','toLowerCase','setStateAsync','callback','modeResetJob','forEach','briefingJob','./lib/ai_agent','response','Kein\x20API\x20Key\x20Ã¼bergeben','3582667VEQxMh','\x20Tage)','daswetter.0','setHours','updateLocation','cogni-living','send','sendMorningBriefing','object','text','./lib/dead_man','dependencyInstallInProgress','testNotification','setupModeResetScheduler','onMessage','activityLevel','error','online','communicate.request','sunny','SET_TOPOLOGY','checkThermostats','namespace','version','LTM.dailyDigests','motion','endsWith','SYSTEM_DP_MODE','config','getForeignStateAsync','dailyDigests','Fehler:\x20','notifyTelegramEnabled','scores','values','setPresence','getOutsideTemperatureNumeric','parse','subscribeStates','currentSystemMode','initZombies','scanForDevices','accuweather.0','length','triggerGaitAnalysis','sensorLastValues','Simulation\x20durch\x20Admin\x20(Test)','isSolar','analysis.training.status','ANALYZE_GAIT','@google/generative-ai','inactivityThresholdHours','name','1177950OBqwAw','clear','runBaselineDriftAnalysis','cancel','simulateEnergyMPC','type','Gemini\x20Init\x20Error:\x20','calendarName','stringify','rawEventLog','abs','analysis.triggerBriefing','heiter','LTM.baselineStatus','genAI','constructor','.communicate.request','analysis.energy.insulationScore','setState','analysis.training.triggerTopology','analysis.energy.mpcActive','getState','some','search','bind','getEnums','from','checkAndInstall','scanThermostats','push','stateChange','system.adapter.','now','entries','onStateChange','keys','5173217BvqFss','getHours','lastAlertState','loadSystemMode','NextHours.Location_1.Day_1.current.symbol_desc','initHistory','isPresent','.system.mode','createAllObjects','./lib/automation','1UklVkt','simulateButler','split','OPTIMIZE_ENERGY','updateTopologyMatrix','Sec-Training\x20started...','geminiApiKey','getOverviewData','enum.rooms.*','debug','80BunXCj','(((.+)+)+)+$','licenseKey','1237858CFtdXZ','weatherInstance','LTM.trainingData.sequences','main','Test','find','1147023DEjnUl','log','automation.triggerAction','driftAnalysisTimer','triggerEnergyPrediction','sonn','ack','abortExitTimer','processSensorEvent','analysis.automation.description','9543XtBPxi','calendarInstance','5022762fIKBqA','notifyTelegramInstance','updated','getMinutes','sendNotification','telegram','checkWifiPresence','analysisHistory','runGeminiAnalysis','@iobroker/adapter-core','Gesendet','onReady','startSystem','./lib/installer','cogni-living\x20adapter\x20starting\x20(v','updateTopology','analysis.training.triggerHealth','getStateAsync','./lib/topology','minDaysForBaseline','Verbindung\x20erfolgreich!','LTM.rawEventLog','setupDriftAnalysisScheduler','.data.table','Verbunden','704HhPGzF','eventHistory','info','analysis.automation.patternDetected','toString','getGenerativeModel','_calName','runAutopilot','unload','checkSolarCondition','exports','devices'];a0_0x32fb=function(){return _0x522f94;};return a0_0x32fb();}const a0_0x243857=(function(){let _0x12594c=!![];return function(_0x32c070,_0x2304f0){const _0x53fdd5=_0x12594c?function(){const _0x1b8b6e=a0_0x16a7;if(_0x2304f0){const _0x4f1d4a=_0x2304f0[_0x1b8b6e(0x235)](_0x32c070,arguments);return _0x2304f0=null,_0x4f1d4a;}}:function(){};return _0x12594c=![],_0x53fdd5;};}()),a0_0x4ae2fb=a0_0x243857(this,function(){const _0x202be4=a0_0x16a7;return a0_0x4ae2fb[_0x202be4(0x20e)]()[_0x202be4(0x1bb)]('(((.+)+)+)+$')[_0x202be4(0x20e)]()[_0x202be4(0x2a7)](a0_0x4ae2fb)['search'](_0x202be4(0x1dd));});a0_0x4ae2fb();'use strict';const utils=require(a0_0x2346fb(0x1fa)),{GoogleGenerativeAI}=require(a0_0x2346fb(0x295)),installer=require(a0_0x2346fb(0x1fe)),scanner=require(a0_0x2346fb(0x246)),schedulers=require('./lib/scheduler'),topology=require(a0_0x2346fb(0x203)),setup=require(a0_0x2346fb(0x237)),recorder=require(a0_0x2346fb(0x255)),pythonBridge=require('./lib/python_bridge'),aiAgent=require(a0_0x2346fb(0x260)),deadMan=require(a0_0x2346fb(0x26d)),automation=require(a0_0x2346fb(0x1d1)),GEMINI_MODEL=a0_0x2346fb(0x247),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};class CogniLiving extends utils[a0_0x2346fb(0x253)]{constructor(_0x4099a8){const _0x398274=a0_0x2346fb;super({..._0x4099a8,'name':_0x398274(0x268)}),this['eventHistory']=[],this['analysisHistory']=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x398274(0x290)]={},this[_0x398274(0x230)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x398274(0x1ce)]=!![],this[_0x398274(0x21b)]=null,this[_0x398274(0x22a)]=null,this['isGracePeriodActive']=![],this[_0x398274(0x2a6)]=null,this[_0x398274(0x241)]=null,this[_0x398274(0x28a)]=setup[_0x398274(0x232)][_0x398274(0x249)],this[_0x398274(0x23d)]=![],this[_0x398274(0x1ca)]=![],this[_0x398274(0x240)]=null,this['ltmJob']=null,this[_0x398274(0x25d)]=null,this[_0x398274(0x1e8)]=null,this['briefingJob']=null,this[_0x398274(0x26e)]=![],this['on']('ready',this[_0x398274(0x1fc)][_0x398274(0x1bc)](this)),this['on'](_0x398274(0x1c2),this[_0x398274(0x1c6)][_0x398274(0x1bc)](this)),this['on'](_0x398274(0x212),this['onUnload'][_0x398274(0x1bc)](this)),this['on'](_0x398274(0x245),this[_0x398274(0x271)][_0x398274(0x1bc)](this));}async['onReady'](){const _0x385ac9=a0_0x2346fb;this[_0x385ac9(0x1e6)][_0x385ac9(0x20c)](_0x385ac9(0x1ff)+this[_0x385ac9(0x27a)]+_0x385ac9(0x228));if(!installer[_0x385ac9(0x1bf)](this,()=>this[_0x385ac9(0x1fd)]()))return;}async['startSystem'](){const _0x44d1dc=a0_0x2346fb;await setup[_0x44d1dc(0x28b)](this);try{this['isProVersion']=await setup['checkLicense'](this[_0x44d1dc(0x27f)][_0x44d1dc(0x1de)]);}catch(_0x37adca){}if(!this[_0x44d1dc(0x27f)][_0x44d1dc(0x296)]||this[_0x44d1dc(0x27f)][_0x44d1dc(0x296)]<0.1)this[_0x44d1dc(0x27f)][_0x44d1dc(0x296)]=0xc;await setup[_0x44d1dc(0x1cd)](this),await setup[_0x44d1dc(0x23b)](this);if(this[_0x44d1dc(0x27f)][_0x44d1dc(0x1d8)])try{this[_0x44d1dc(0x2a6)]=new GoogleGenerativeAI(this['config'][_0x44d1dc(0x1d8)]),this[_0x44d1dc(0x241)]=this['genAI'][_0x44d1dc(0x20f)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x44d1dc(0x1e6)][_0x44d1dc(0x20c)](_0x44d1dc(0x222));}catch(_0x25f3af){this[_0x44d1dc(0x1e6)][_0x44d1dc(0x273)](_0x44d1dc(0x29e)+_0x25f3af[_0x44d1dc(0x245)]);}await setup[_0x44d1dc(0x1d0)](this),await this[_0x44d1dc(0x1cb)]();try{const _0x4d1cdd=await this['getStateAsync'](_0x44d1dc(0x206));if(_0x4d1cdd&&_0x4d1cdd['val'])this['rawEventLog']=JSON['parse'](_0x4d1cdd[_0x44d1dc(0x231)]);}catch(_0x5c4af2){this[_0x44d1dc(0x2a1)]=[];}try{const _0x115494=await this['getStateAsync'](_0x44d1dc(0x27b));if(_0x115494&&_0x115494[_0x44d1dc(0x231)])this[_0x44d1dc(0x281)]=JSON[_0x44d1dc(0x288)](_0x115494[_0x44d1dc(0x231)]);}catch(_0x373bce){this['dailyDigests']=[];}const _0x3307f7=this[_0x44d1dc(0x281)][_0x44d1dc(0x28e)]>=(this[_0x44d1dc(0x27f)][_0x44d1dc(0x204)]||0x7)?'Aktiv\x20('+this[_0x44d1dc(0x281)]['length']+_0x44d1dc(0x264):'Lernphase\x20('+this[_0x44d1dc(0x281)]['length']+'/'+(this['config']['minDaysForBaseline']||0x7)+')';await this['setStateAsync'](_0x44d1dc(0x2a5),{'val':_0x3307f7,'ack':!![]}),this[_0x44d1dc(0x289)](_0x44d1dc(0x22d)),this[_0x44d1dc(0x289)]('LTM.triggerDailyDigest'),this[_0x44d1dc(0x289)]('system.mode'),this['subscribeStates'](_0x44d1dc(0x2a3)),this[_0x44d1dc(0x289)]('analysis.automation.triggerAction'),this['subscribeStates'](_0x44d1dc(0x257)),this[_0x44d1dc(0x289)](_0x44d1dc(0x242)),this[_0x44d1dc(0x289)]('analysis.training.triggerHealth'),this[_0x44d1dc(0x289)]('analysis.training.triggerEnergy'),this[_0x44d1dc(0x289)](_0x44d1dc(0x256)),this['subscribeStates'](_0x44d1dc(0x2ab)),this[_0x44d1dc(0x289)](_0x44d1dc(0x2ac));const _0x1073cd=this[_0x44d1dc(0x27f)][_0x44d1dc(0x215)];if(_0x1073cd)for(const _0x4d8f4a of _0x1073cd){await this['subscribeForeignStatesAsync'](_0x4d8f4a['id']);}const _0x34acdd=this[_0x44d1dc(0x27f)][_0x44d1dc(0x24c)];if(_0x34acdd)for(const _0x3268dd of _0x34acdd){await this[_0x44d1dc(0x24d)](_0x3268dd);}if(this[_0x44d1dc(0x27f)][_0x44d1dc(0x283)]&&this[_0x44d1dc(0x27f)][_0x44d1dc(0x1f2)])await this[_0x44d1dc(0x24d)](this['config'][_0x44d1dc(0x1f2)]+_0x44d1dc(0x2a8));setTimeout(()=>this[_0x44d1dc(0x1f7)](),0x1388);if(this[_0x44d1dc(0x240)])clearInterval(this[_0x44d1dc(0x240)]);const _0x25429a=this[_0x44d1dc(0x27f)][_0x44d1dc(0x22c)]||0xf;_0x25429a>0x0&&(this[_0x44d1dc(0x240)]=setInterval(()=>{const _0x59b176=_0x44d1dc;this[_0x59b176(0x211)]();},_0x25429a*0x3c*0x3e8)),schedulers['setupLtmScheduler'](this,()=>aiAgent[_0x44d1dc(0x234)](this,pythonBridge)),schedulers[_0x44d1dc(0x270)](this),schedulers[_0x44d1dc(0x207)](this,()=>aiAgent[_0x44d1dc(0x29a)](this)),schedulers[_0x44d1dc(0x238)](this,()=>aiAgent[_0x44d1dc(0x26a)](this)),pythonBridge[_0x44d1dc(0x217)](this,installer['PYTHON_EXE']),setTimeout(async()=>{const _0xeec82f=_0x44d1dc;await topology[_0xeec82f(0x200)](this);try{const _0x32017d=await this['getStateAsync'](_0xeec82f(0x226));if(_0x32017d&&_0x32017d[_0xeec82f(0x231)])pythonBridge[_0xeec82f(0x269)](this,_0xeec82f(0x277),JSON[_0xeec82f(0x288)](_0x32017d[_0xeec82f(0x231)]));}catch(_0x418d94){}this[_0xeec82f(0x21a)](),this['triggerGaitAnalysis'](),this['triggerEnergyPrediction'](),this['updateHealthVector']();},0x1388);}[a0_0x2346fb(0x259)](_0x123152){const _0x5856ab=a0_0x2346fb;if(this['analysisTimer'])clearInterval(this['analysisTimer']);if(this[_0x5856ab(0x1e8)])clearInterval(this['driftAnalysisTimer']);if(this[_0x5856ab(0x225)])this[_0x5856ab(0x225)][_0x5856ab(0x29b)]();if(this[_0x5856ab(0x25d)])this['modeResetJob']['cancel']();if(this['briefingJob'])this[_0x5856ab(0x25f)][_0x5856ab(0x29b)]();recorder[_0x5856ab(0x1ec)](this),pythonBridge['stopService'](this),_0x123152();}async['onStateChange'](_0x54e624,_0x465c61){const _0x12e0e5=a0_0x2346fb;if(!_0x465c61||this[_0x12e0e5(0x26e)])return;if(_0x54e624['includes'](_0x12e0e5(0x1f6))&&_0x54e624[_0x12e0e5(0x27d)](_0x12e0e5(0x275))&&_0x465c61[_0x12e0e5(0x231)])return;if(_0x54e624===this[_0x12e0e5(0x279)]+_0x12e0e5(0x1cf)){if(_0x465c61[_0x12e0e5(0x231)]&&Object[_0x12e0e5(0x285)](setup[_0x12e0e5(0x232)])[_0x12e0e5(0x252)](_0x465c61[_0x12e0e5(0x231)])){this[_0x12e0e5(0x28a)]=_0x465c61[_0x12e0e5(0x231)];if(_0x465c61[_0x12e0e5(0x231)]===setup[_0x12e0e5(0x232)][_0x12e0e5(0x21f)])await recorder[_0x12e0e5(0x286)](this,![]);else await recorder[_0x12e0e5(0x286)](this,!![]);}if(!_0x465c61[_0x12e0e5(0x1eb)])this['setState'](_0x54e624,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x465c61[_0x12e0e5(0x1eb)]){_0x54e624[_0x12e0e5(0x252)]('analysis.trigger')&&_0x465c61[_0x12e0e5(0x231)]&&(this['setState'](_0x54e624,{'val':![],'ack':!![]}),aiAgent[_0x12e0e5(0x1f9)](this));if(_0x54e624[_0x12e0e5(0x252)](_0x12e0e5(0x223))&&_0x465c61[_0x12e0e5(0x231)]){this['setState'](_0x54e624,{'val':![],'ack':!![]});if(this[_0x12e0e5(0x23d)])aiAgent[_0x12e0e5(0x234)](this,pythonBridge);}_0x54e624[_0x12e0e5(0x252)]('triggerBriefing')&&_0x465c61[_0x12e0e5(0x231)]&&(this[_0x12e0e5(0x2aa)](_0x54e624,{'val':![],'ack':!![]}),aiAgent['sendMorningBriefing'](this));_0x54e624[_0x12e0e5(0x252)](_0x12e0e5(0x1e7))&&_0x465c61['val']&&(this[_0x12e0e5(0x2aa)](_0x54e624,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this));if(_0x54e624[_0x12e0e5(0x252)](_0x12e0e5(0x242))&&_0x465c61[_0x12e0e5(0x231)]){this[_0x12e0e5(0x2aa)](_0x54e624,{'val':![],'ack':!![]});if(this[_0x12e0e5(0x23d)])try{const _0x1cc333=await this[_0x12e0e5(0x202)](_0x12e0e5(0x1e1));if(_0x1cc333&&_0x1cc333['val']){const _0x3ce829=JSON[_0x12e0e5(0x288)](_0x1cc333[_0x12e0e5(0x231)]);this['setStateAsync'](_0x12e0e5(0x293),{'val':_0x12e0e5(0x1d7),'ack':!![]}),pythonBridge[_0x12e0e5(0x269)](this,'TRAIN_SECURITY',{'sequences':_0x3ce829});}}catch(_0x1ac0e0){}}if(_0x54e624[_0x12e0e5(0x252)](_0x12e0e5(0x201))&&_0x465c61[_0x12e0e5(0x231)]){this[_0x12e0e5(0x2aa)](_0x54e624,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x131fcb=await this[_0x12e0e5(0x202)]('LTM.dailyDigests');if(_0x131fcb&&_0x131fcb[_0x12e0e5(0x231)])pythonBridge[_0x12e0e5(0x269)](this,'TRAIN_HEALTH',{'digests':JSON['parse'](_0x131fcb['val'])});}catch(_0x19f13d){}}if(_0x54e624[_0x12e0e5(0x252)](_0x12e0e5(0x23a))&&_0x465c61[_0x12e0e5(0x231)]){this[_0x12e0e5(0x2aa)](_0x54e624,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x45f67b=await this[_0x12e0e5(0x202)]('LTM.trainingData.thermodynamics');if(_0x45f67b&&_0x45f67b[_0x12e0e5(0x231)])pythonBridge[_0x12e0e5(0x269)](this,_0x12e0e5(0x22e),{'points':JSON[_0x12e0e5(0x288)](_0x45f67b['val'])});}catch(_0x45dee8){}}if(_0x54e624[_0x12e0e5(0x252)](_0x12e0e5(0x256))&&_0x465c61['val']){this[_0x12e0e5(0x2aa)](_0x54e624,{'val':![],'ack':!![]});if(this[_0x12e0e5(0x23d)])try{const _0x15f315=await this[_0x12e0e5(0x202)](_0x12e0e5(0x206));if(_0x15f315&&_0x15f315[_0x12e0e5(0x231)])pythonBridge[_0x12e0e5(0x269)](this,_0x12e0e5(0x21c),{'events':JSON[_0x12e0e5(0x288)](_0x15f315[_0x12e0e5(0x231)])});}catch(_0xd335b5){}}_0x54e624[_0x12e0e5(0x252)](_0x12e0e5(0x2ab))&&_0x465c61[_0x12e0e5(0x231)]&&(this[_0x12e0e5(0x2aa)](_0x54e624,{'val':![],'ack':!![]}),topology[_0x12e0e5(0x200)](this));return;}if(this[_0x12e0e5(0x27f)][_0x12e0e5(0x24c)]&&this[_0x12e0e5(0x27f)][_0x12e0e5(0x24c)][_0x12e0e5(0x252)](_0x54e624)){await this[_0x12e0e5(0x1f7)]();return;}const _0x207bb4=(this['config'][_0x12e0e5(0x215)]||[])[_0x12e0e5(0x1e4)](_0x1cdc20=>_0x1cdc20['id']===_0x54e624);if(_0x207bb4){const _0x1677aa=await recorder[_0x12e0e5(0x1ed)](this,_0x54e624,_0x465c61,_0x207bb4);_0x1677aa&&_0x1677aa[_0x12e0e5(0x29d)]===_0x12e0e5(0x27c)&&_0x1677aa[_0x12e0e5(0x227)]&&this[_0x12e0e5(0x23d)]&&deadMan[_0x12e0e5(0x267)](this,_0x1677aa['location']);}}async[a0_0x2346fb(0x271)](_0x56a6ba){const _0x52e535=a0_0x2346fb;if(typeof _0x56a6ba==='object'&&_0x56a6ba[_0x52e535(0x245)]){if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x278))try{const _0x4a9d6b=await automation[_0x52e535(0x1c0)](this);this[_0x52e535(0x251)](_0x56a6ba['from'],_0x56a6ba[_0x52e535(0x23f)],{'success':!![],'results':_0x4a9d6b},_0x56a6ba[_0x52e535(0x25c)]);}catch(_0x25b5be){this[_0x52e535(0x251)](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba[_0x52e535(0x23f)],{'success':![],'error':_0x25b5be[_0x52e535(0x245)]},_0x56a6ba[_0x52e535(0x25c)]);}else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x29c))try{const {current_temps:_0x231a80,t_out:_0x53fae3,targets:_0x4feeb6,t_forecast:_0x559fc2}=_0x56a6ba[_0x52e535(0x245)],_0x482423=[];let _0x45cc23={};try{const _0x49e78c=await this['getStateAsync'](_0x52e535(0x2a9));if(_0x49e78c&&_0x49e78c['val']){const _0x46838a=JSON['parse'](_0x49e78c[_0x52e535(0x231)]);_0x45cc23=_0x46838a[_0x52e535(0x284)]||_0x46838a;}}catch(_0x23e46e){}const _0x413cba=_0x559fc2!==undefined&&_0x559fc2!==null?(_0x53fae3+_0x559fc2)/0x2:_0x53fae3;for(const [_0xf8a1d3,_0x23edc3]of Object[_0x52e535(0x1c5)](_0x231a80)){const _0x5bfd96=_0x4feeb6[_0xf8a1d3]||0x15;if(_0x23edc3<=_0x5bfd96)continue;let _0x5a0ff6=_0x45cc23[_0xf8a1d3]||-0.5;if(_0x5a0ff6>=0x0)_0x5a0ff6=-0.5;const _0x58c0ad=Math[_0x52e535(0x2a2)](_0x5a0ff6),_0x30608d=_0x23edc3-_0x5bfd96;let _0x585221=Math[_0x52e535(0x233)](_0x30608d/_0x58c0ad*0x3c);const _0x10476c=_0x23edc3-_0x53fae3,_0x27dca7=_0x23edc3-_0x413cba;if(_0x27dca7!==0x0&&_0x10476c!==0x0){const _0x451b24=_0x10476c/_0x27dca7;_0x585221=Math[_0x52e535(0x233)](_0x585221*_0x451b24);}if(_0x585221>0xf){if(_0x585221>0xf0)_0x585221=0xf0;_0x482423[_0x52e535(0x1c1)]({'room':_0xf8a1d3,'minutes_safe':_0x585221,'target':_0x5bfd96,'current':_0x23edc3,'savings_msg':'Heizung\x20kann\x20'+_0x585221+'\x20min\x20ausbleiben.'});}}_0x482423[_0x52e535(0x248)]((_0x2e8d59,_0x3ff06a)=>_0x3ff06a[_0x52e535(0x24b)]-_0x2e8d59[_0x52e535(0x24b)]),this['sendTo'](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba[_0x52e535(0x23f)],{'success':!![],'proposals':_0x482423},_0x56a6ba[_0x52e535(0x25c)]);}catch(_0x19dac8){this[_0x52e535(0x251)](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba[_0x52e535(0x23f)],{'success':![],'error':_0x19dac8[_0x52e535(0x245)]},_0x56a6ba[_0x52e535(0x25c)]);}else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x244))await this[_0x52e535(0x25b)](_0x52e535(0x20d),{'val':![],'ack':!![]}),await this[_0x52e535(0x25b)](_0x52e535(0x1ee),{'val':'','ack':!![]}),await this['setStateAsync'](_0x52e535(0x22f),{'val':'','ack':!![]}),this['sendTo'](_0x56a6ba['from'],_0x56a6ba[_0x52e535(0x23f)],{'success':!![]},_0x56a6ba['callback']);else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x1d3)){const {targetId:_0x24abc3,targetValue:_0x3d4c2b}=_0x56a6ba[_0x52e535(0x245)];await this[_0x52e535(0x25b)](_0x52e535(0x20d),{'val':!![],'ack':!![]}),await this[_0x52e535(0x25b)](_0x52e535(0x1ee),{'val':_0x52e535(0x291),'ack':!![]}),await this['setStateAsync'](_0x52e535(0x22f),{'val':_0x24abc3,'ack':!![]}),await this[_0x52e535(0x25b)]('analysis.automation.targetValue',{'val':String(_0x3d4c2b),'ack':!![]}),this[_0x52e535(0x251)](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba['command'],{'success':!![]},_0x56a6ba[_0x52e535(0x25c)]);}else{if(_0x56a6ba['command']==='testApiKey')try{const _0x138342=_0x56a6ba[_0x52e535(0x245)]['apiKey'];if(!_0x138342)throw new Error(_0x52e535(0x262));const _0x49caa5=new GoogleGenerativeAI(_0x138342),_0x28cb71=_0x49caa5['getGenerativeModel']({'model':GEMINI_MODEL}),_0x3570a5=await _0x28cb71['generateContent'](_0x52e535(0x1e3)),_0x2deaac=await _0x3570a5[_0x52e535(0x261)];if(_0x2deaac[_0x52e535(0x26c)]())this[_0x52e535(0x251)](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba[_0x52e535(0x23f)],{'success':!![],'message':_0x52e535(0x205)},_0x56a6ba[_0x52e535(0x25c)]);else throw new Error(_0x52e535(0x221));}catch(_0x3f18ef){this['sendTo'](_0x56a6ba['from'],_0x56a6ba[_0x52e535(0x23f)],{'success':![],'message':_0x3f18ef[_0x52e535(0x245)]},_0x56a6ba['callback']);}else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x254))try{const _0x359377=await scanner[_0x52e535(0x28c)](this,_0x56a6ba[_0x52e535(0x245)]||{});this[_0x52e535(0x251)](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba['command'],{'success':!![],'devices':_0x359377},_0x56a6ba[_0x52e535(0x25c)]);}catch(_0x116a18){this['sendTo'](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba['command'],{'success':![],'error':_0x116a18[_0x52e535(0x245)]},_0x56a6ba[_0x52e535(0x25c)]);}else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x1d6))try{const {matrix:_0x4cc5f3}=_0x56a6ba[_0x52e535(0x245)],_0x1a2d8d=await this[_0x52e535(0x202)](_0x52e535(0x226));if(_0x1a2d8d&&_0x1a2d8d['val']){const _0x15b063=JSON[_0x52e535(0x288)](_0x1a2d8d['val']);_0x15b063['matrix']=_0x4cc5f3,_0x15b063[_0x52e535(0x1f3)]=Date[_0x52e535(0x1c4)](),await this[_0x52e535(0x25b)](_0x52e535(0x226),{'val':JSON[_0x52e535(0x2a0)](_0x15b063),'ack':!![]}),pythonBridge[_0x52e535(0x269)](this,_0x52e535(0x277),_0x15b063);}this[_0x52e535(0x251)](_0x56a6ba['from'],_0x56a6ba['command'],{'success':!![]},_0x56a6ba[_0x52e535(0x25c)]);}catch(_0x574000){this[_0x52e535(0x1e6)][_0x52e535(0x273)](_0x574000);}else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x23c))this[_0x52e535(0x251)](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba[_0x52e535(0x23f)],{'success':!![],'dailyDigests':this[_0x52e535(0x281)]||[],'analysisHistory':this[_0x52e535(0x1f8)]||[]},_0x56a6ba[_0x52e535(0x25c)]);else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x1d9)){const _0x43d540=this[_0x52e535(0x281)][_0x52e535(0x28e)],_0xb6e2e3=new Array(0x18)[_0x52e535(0x21d)](0x0),_0xbb2b37=new Date()[_0x52e535(0x266)](0x0,0x0,0x0,0x0);this[_0x52e535(0x20b)]&&this['eventHistory']['forEach'](_0x1715af=>{const _0x4f2088=_0x52e535;if(_0x1715af[_0x4f2088(0x22b)]>=_0xbb2b37){const _0x4a00ef=new Date(_0x1715af[_0x4f2088(0x22b)])[_0x4f2088(0x1c9)]();if(_0x4a00ef>=0x0&&_0x4a00ef<0x18)_0xb6e2e3[_0x4a00ef]++;}});let _0x414fc9=![],_0x5b2c25='',_0x898a91='',_0x48cd3e='';try{const _0x5636bb=await this[_0x52e535(0x202)]('analysis.automation.patternDetected');if(_0x5636bb&&_0x5636bb[_0x52e535(0x231)]){_0x414fc9=!![];const _0x4fe1f4=await this[_0x52e535(0x202)](_0x52e535(0x1ee));_0x5b2c25=_0x4fe1f4?_0x4fe1f4['val']:'';const _0x6916e=await this[_0x52e535(0x202)](_0x52e535(0x22f));_0x898a91=_0x6916e?_0x6916e[_0x52e535(0x231)]:'';const _0x2fc095=await this[_0x52e535(0x202)]('analysis.automation.targetValue');_0x48cd3e=_0x2fc095?_0x2fc095[_0x52e535(0x231)]:'';}}catch(_0x13f7e5){}const _0x118df7=await this[_0x52e535(0x213)](),_0x14cfc3=(this[_0x52e535(0x27f)][_0x52e535(0x215)]||[])[_0x52e535(0x1ba)](_0x154790=>_0x154790[_0x52e535(0x292)]),_0x199ce1=_0x118df7&&_0x14cfc3;this['sendTo'](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba['command'],{'success':!![],'eventHistory':this['eventHistory']['slice'](0x0,0xf),'stats':{'digestCount':_0x43d540,'isPresent':this[_0x52e535(0x1ce)],'hourlyActivity':_0xb6e2e3,'solarActive':_0x199ce1},'automation':{'detected':_0x414fc9,'description':_0x5b2c25,'targetId':_0x898a91,'targetValue':_0x48cd3e}},_0x56a6ba[_0x52e535(0x25c)]);}else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x1bd)){const _0xa3d7c3=await this[_0x52e535(0x24e)](_0x52e535(0x23e),'enum'),_0x525af9=[];if(_0xa3d7c3)for(const _0x446a46 in _0xa3d7c3){const _0x592a63=_0xa3d7c3[_0x446a46],_0x1bfb80=(_0x592a63[_0x52e535(0x220)]&&typeof _0x592a63['common'][_0x52e535(0x297)]===_0x52e535(0x26b)?_0x592a63[_0x52e535(0x220)][_0x52e535(0x297)]['de']:_0x592a63['common'][_0x52e535(0x297)])||_0x592a63[_0x52e535(0x220)]['name'];_0x525af9[_0x52e535(0x1c1)]({'id':_0x446a46,'name':_0x1bfb80});}const _0xef4d32=await this['getForeignObjectsAsync'](_0x52e535(0x1da),'enum'),_0x389e0a=[];if(_0xef4d32)for(const _0x15b452 in _0xef4d32){const _0x4303cd=_0xef4d32[_0x15b452],_0x5d38ba=(_0x4303cd[_0x52e535(0x220)]&&typeof _0x4303cd['common'][_0x52e535(0x297)]===_0x52e535(0x26b)?_0x4303cd[_0x52e535(0x220)][_0x52e535(0x297)]['de']:_0x4303cd['common'][_0x52e535(0x297)])||_0x15b452[_0x52e535(0x1d4)]('.')[_0x52e535(0x239)]();_0x389e0a[_0x52e535(0x1c1)](_0x5d38ba);}this[_0x52e535(0x251)](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba[_0x52e535(0x23f)],{'success':!![],'enums':_0x525af9,'rooms':_0x389e0a},_0x56a6ba['callback']);}else{if(_0x56a6ba[_0x52e535(0x23f)]==='testContext')try{let _0x21b427='Kein\x20Wetter-Adapter',_0x3915e8=_0x52e535(0x24a);if(this[_0x52e535(0x27f)][_0x52e535(0x1e0)]){const _0x5c2358=await recorder[_0x52e535(0x287)](this);_0x21b427=_0x5c2358!==null?_0x5c2358+'Â°C':_0x52e535(0x236);}if(this[_0x52e535(0x27f)][_0x52e535(0x1f0)]){const _0x5b0f64=await this['getForeignObjectAsync'](_0x52e535(0x1c3)+this[_0x52e535(0x27f)][_0x52e535(0x1f0)]);_0x3915e8=_0x5b0f64?_0x52e535(0x209):_0x52e535(0x219);}this[_0x52e535(0x251)](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba[_0x52e535(0x23f)],{'success':!![],'weather':_0x21b427,'calendar':_0x3915e8},_0x56a6ba[_0x52e535(0x25c)]);}catch(_0x32d1a5){this[_0x52e535(0x251)](_0x56a6ba['from'],_0x56a6ba[_0x52e535(0x23f)],{'success':![],'error':_0x32d1a5[_0x52e535(0x245)]},_0x56a6ba[_0x52e535(0x25c)]);}else{if(_0x56a6ba[_0x52e535(0x23f)]==='getCalendarNames')try{const _0x15b6dd=_0x56a6ba[_0x52e535(0x245)][_0x52e535(0x258)],_0x100cc8=await this['getForeignStateAsync'](_0x15b6dd+_0x52e535(0x208));let _0x568c59=[];if(_0x100cc8&&_0x100cc8[_0x52e535(0x231)]){const _0x436d8d=JSON[_0x52e535(0x288)](_0x100cc8[_0x52e535(0x231)]),_0x77e833=new Set();Array['isArray'](_0x436d8d)&&_0x436d8d[_0x52e535(0x25e)](_0x5ff80c=>{const _0x46ae2e=_0x52e535;if(_0x5ff80c['_calName'])_0x77e833[_0x46ae2e(0x250)](_0x5ff80c[_0x46ae2e(0x210)]);else{if(_0x5ff80c[_0x46ae2e(0x29f)])_0x77e833['add'](_0x5ff80c[_0x46ae2e(0x29f)]);}}),_0x568c59=Array[_0x52e535(0x1be)](_0x77e833)[_0x52e535(0x248)]();}if(_0x568c59[_0x52e535(0x28e)]===0x0)_0x568c59=['Standard'];this['sendTo'](_0x56a6ba['from'],_0x56a6ba[_0x52e535(0x23f)],{'success':!![],'names':_0x568c59},_0x56a6ba[_0x52e535(0x25c)]);}catch(_0xb0a189){this[_0x52e535(0x251)](_0x56a6ba['from'],_0x56a6ba[_0x52e535(0x23f)],{'success':![],'error':_0xb0a189[_0x52e535(0x245)]},_0x56a6ba[_0x52e535(0x25c)]);}else{if(_0x56a6ba[_0x52e535(0x23f)]===_0x52e535(0x26f))try{await setup[_0x52e535(0x1f5)](this,_0x52e535(0x216),![],![]),this[_0x52e535(0x251)](_0x56a6ba['from'],_0x56a6ba[_0x52e535(0x23f)],{'success':!![],'message':_0x52e535(0x1fb)},_0x56a6ba['callback']);}catch(_0x2c7b55){this['log']['error']('Notification\x20Test\x20Failed:\x20'+_0x2c7b55['message']),this['sendTo'](_0x56a6ba[_0x52e535(0x1be)],_0x56a6ba[_0x52e535(0x23f)],{'success':![],'message':_0x52e535(0x282)+_0x2c7b55[_0x52e535(0x245)]},_0x56a6ba['callback']);}}}}}}}}}}}}}}}async[a0_0x2346fb(0x1cb)](){const _0x528615=a0_0x2346fb;try{const _0x10c4d5=await this[_0x528615(0x202)](setup[_0x528615(0x27e)]);_0x10c4d5&&_0x10c4d5['val']&&Object[_0x528615(0x285)](setup['SYSTEM_MODES'])[_0x528615(0x252)](_0x10c4d5['val'])?this['currentSystemMode']=_0x10c4d5[_0x528615(0x231)]:(this[_0x528615(0x28a)]=setup[_0x528615(0x232)][_0x528615(0x249)],await this[_0x528615(0x25b)](setup[_0x528615(0x27e)],{'val':setup[_0x528615(0x232)][_0x528615(0x249)],'ack':!![]}));}catch(_0xe85c0c){this[_0x528615(0x28a)]=setup[_0x528615(0x232)][_0x528615(0x249)];}}async[a0_0x2346fb(0x1f7)](){const _0x5a28ac=a0_0x2346fb;try{const _0x2593fc=this[_0x5a28ac(0x27f)][_0x5a28ac(0x24c)]||[];let _0x25e395=![];const _0x2dae5b=[];for(const _0x54e907 of _0x2593fc){try{const _0x517794=await this[_0x5a28ac(0x280)](_0x54e907);_0x517794&&(_0x517794[_0x5a28ac(0x231)]===!![]||_0x517794[_0x5a28ac(0x231)]===_0x5a28ac(0x274)||_0x517794[_0x5a28ac(0x231)]===0x1)&&(_0x25e395=!![],_0x2dae5b[_0x5a28ac(0x1c1)](_0x54e907));}catch(_0x48f23a){}}return await this[_0x5a28ac(0x25b)]('system.presenceWho',{'val':_0x2dae5b['join'](',\x20'),'ack':!![]}),_0x25e395&&(this['exitTimer']&&(this[_0x5a28ac(0x1e6)][_0x5a28ac(0x20c)](_0x5a28ac(0x243)),recorder[_0x5a28ac(0x1ec)](this)),!this[_0x5a28ac(0x1ce)]&&this['currentSystemMode']===setup[_0x5a28ac(0x232)]['NORMAL']&&await recorder['setPresence'](this,!![])),_0x25e395;}catch(_0xa488d5){return![];}}async[a0_0x2346fb(0x211)](){const _0x30dd32=a0_0x2346fb;this[_0x30dd32(0x1e6)][_0x30dd32(0x1db)]('ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...'),await aiAgent[_0x30dd32(0x1f9)](this),this['updateHealthVector'](),this[_0x30dd32(0x28f)](),this[_0x30dd32(0x1e9)]();}async[a0_0x2346fb(0x213)](){const _0x4d6ddf=a0_0x2346fb,_0x47a0fe=['weatherunderground.0',_0x4d6ddf(0x28d),_0x4d6ddf(0x265)],_0x1c8fb2=['forecast.current.weather',_0x4d6ddf(0x229),_0x4d6ddf(0x1cc)];for(const _0x457271 of _0x47a0fe){for(const _0x3b8538 of _0x1c8fb2){try{const _0x21fc41=_0x457271+'.'+_0x3b8538,_0x14f73b=await this[_0x4d6ddf(0x280)](_0x21fc41);if(_0x14f73b&&_0x14f73b[_0x4d6ddf(0x231)]){const _0x47e543=String(_0x14f73b[_0x4d6ddf(0x231)])[_0x4d6ddf(0x25a)]();if(_0x47e543[_0x4d6ddf(0x252)](_0x4d6ddf(0x1ea))||_0x47e543[_0x4d6ddf(0x252)](_0x4d6ddf(0x276))||_0x47e543[_0x4d6ddf(0x252)]('klar')||_0x47e543[_0x4d6ddf(0x252)](_0x4d6ddf(0x299))||_0x47e543[_0x4d6ddf(0x252)](_0x4d6ddf(0x2a4)))return!![];}}catch(_0x2a6021){}}}return![];}['triggerGaitAnalysis'](){const _0x131b2f=a0_0x2346fb;if(!this[_0x131b2f(0x23d)])return;try{this[_0x131b2f(0x2ad)]('LTM.trainingData.sequences',(_0x39a805,_0x3e4f89)=>{const _0x22554e=_0x131b2f;_0x3e4f89&&_0x3e4f89['val']&&pythonBridge[_0x22554e(0x269)](this,_0x22554e(0x294),{'sequences':JSON[_0x22554e(0x288)](_0x3e4f89[_0x22554e(0x231)])});});}catch(_0x42f7ae){}}async[a0_0x2346fb(0x1e9)](){const _0x547aa8=a0_0x2346fb;if(!this[_0x547aa8(0x23d)])return;try{const _0x33ba9c=await recorder[_0x547aa8(0x287)](this);if(_0x33ba9c===null)return;const _0x5474ff={},_0x148457={},_0x4b997a=this[_0x547aa8(0x27f)][_0x547aa8(0x215)]||[];for(const _0x7faeb2 of _0x4b997a){if(_0x7faeb2['type']==='temperature'&&_0x7faeb2[_0x547aa8(0x227)]){const _0x1196b6=this[_0x547aa8(0x290)][_0x7faeb2['id']];if(_0x1196b6!==undefined)_0x5474ff[_0x7faeb2[_0x547aa8(0x227)]]=_0x1196b6;if(_0x7faeb2[_0x547aa8(0x292)])_0x148457[_0x7faeb2[_0x547aa8(0x227)]]=!![];}}const _0x218d6c=await this[_0x547aa8(0x213)]();Object[_0x547aa8(0x1c7)](_0x5474ff)[_0x547aa8(0x28e)]>0x0&&(pythonBridge[_0x547aa8(0x269)](this,_0x547aa8(0x21e),{'current_temps':_0x5474ff,'t_out':_0x33ba9c,'is_sunny':_0x218d6c,'solar_flags':_0x148457}),pythonBridge[_0x547aa8(0x269)](this,_0x547aa8(0x1d5),{'current_temps':_0x5474ff,'t_out':_0x33ba9c,'targets':{}}));}catch(_0x538bdb){}}['updateHealthVector'](){const _0x4e8d14=a0_0x2346fb;if(!this[_0x4e8d14(0x2a1)]||this[_0x4e8d14(0x2a1)][_0x4e8d14(0x28e)]===0x0)return;const _0x253058=new Array(0x60)[_0x4e8d14(0x21d)](0x0),_0x2019bd=new Date()[_0x4e8d14(0x266)](0x0,0x0,0x0,0x0);this[_0x4e8d14(0x2a1)]['forEach'](_0x280565=>{const _0x29cd91=_0x4e8d14,_0x4676c5=new Date(_0x280565[_0x29cd91(0x22b)]);if(_0x4676c5['getTime']()>=_0x2019bd){const _0x3d6182=_0x4676c5[_0x29cd91(0x1c9)](),_0x30c4fb=_0x4676c5[_0x29cd91(0x1f4)](),_0x40a7ac=_0x3d6182*0x4+Math['floor'](_0x30c4fb/0xf);if(_0x40a7ac>=0x0&&_0x40a7ac<0x60)_0x253058[_0x40a7ac]++;}}),this[_0x4e8d14(0x25b)]('analysis.health.todayVector',{'val':JSON[_0x4e8d14(0x2a0)](_0x253058),'ack':!![]});}[a0_0x2346fb(0x21a)](){const _0x2718a7=a0_0x2346fb;if(!this['dailyDigests']||this['dailyDigests'][_0x2718a7(0x28e)]<0x2)return;const _0x523a00=this[_0x2718a7(0x281)][_0x2718a7(0x224)](_0x12215a=>{const _0x4c77e2=_0x2718a7,_0x4e375c=(_0x12215a[_0x4c77e2(0x272)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x4e375c]||0x32;});pythonBridge[_0x2718a7(0x269)](this,'ANALYZE_TREND',{'values':_0x523a00,'tag':_0x2718a7(0x24f)});}}if(require[a0_0x2346fb(0x1e2)]!==module)module[a0_0x2346fb(0x214)]=_0x9d1510=>new CogniLiving(_0x9d1510);else new CogniLiving();