const a0_0x421c3c=a0_0x5125;function a0_0x366b(){const _0x2bc0be=['motion','toFixed','Trigger\x20Digest','constructor','forEach','17212WHZcQP','unreach','map','systemUUID','N/A','slice','ltmLtbWindowDays','klima','stringify','kÃ¼che','Sending\x20notification:\x20\x22','generic','Logbook','analysis.health.notes','checkLicense','modeResetJob','Gemini\x20Init\x20Error:\x20','triggerBriefing','find','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','location','power','calendarSelection','Activity\x20Summary','daswetter.0','142950ZWTnxf','cancel','lock','.\x20MODUS:\x20','config','text','toLowerCase','shutter','scanForDevices','name','scheduleJob','bewegung','AI\x20Alert\x20Status','party','indicator','state','join','window','currentposition','subscribeStates','from','events.lastEvent','analysis.triggerBriefing','calendarInstance','scriptProblem','setupBriefingScheduler','connection','temp','vacation','geminiModel','loadSystemMode','onReady','\x0aSTB:\x20','3381IRmtTv','inactivityThresholdHours','systemConfig','analysis.activitySummary','sendMorningBriefing','Starting\x20Autopilot\x20(','bad','780050jNTZLQ','notifyPushoverEnabled','initSystemConfig','response','Aktiv\x20(','status','Health\x20Notes','initSensorSubscriptions','Gemini\x20AI\x20initialized.','setPresence','getOverviewData','link_quality','\x20|\x20','activity','sensorLastValues','ack','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20}','âš ï¸\x20Alarm','temperature','description','ical.0','LTM\x20Sched\x20Error:\x20','rssi','geminiApiKey','0\x204\x20*\x20*\x20*','history.','cover','getStateAsync','echarts.','_calName','presenceDevices','licht','filter','Feedback\x20Log','PARTY','KALENDER\x20ERROR:\x20','none','value.health','set_temperature','KI-Modell\x20nicht\x20initialisiert\x20(Neustart\x20erforderlich?)','getLtmData','abortExitTimer','ltmDriftCheckIntervalHours','Wohnzimmer','lastIndexOf','WETTER\x20ERROR:\x20','notifyTelegramInstance','WETTER:\x20Keine\x20Daten\x20gefunden','event','Subscribing\x20to\x20','fenster','valve','(((.+)+)+)+$','Triggered\x20analysis\x20but\x20Gemini\x20AI\x20is\x20not\x20initialized!\x20Check\x20API\x20Key.','PRO-','License\x20Check\x20failed:\x20','system.mode','exitTimer','longitude','NORMAL','briefingJob','isExit','useWeather','events.history','LTM.rawEventLog','flur','WETTER:\x20','openweathermap','KALENDER:\x20','Comfort\x20Summary','tÃ¼r','getCalendarContext','analysisHistory','driftDetails','analysis.deviationFromBaseline','selectedFunctionIds','analysis.automation.suggestedAction','triggerDailyDigest','getWeatherContext','licenseKey','Drift\x20Analysis','alertReason','maintenance','notifyTelegramEnabled','now','TEST-PRO-KEY','getSystemUUID','toISOString','members','log','values','stick_unreach','retry','position','doors','warn','generateContent','LTM.processingStatus','native','onMessage','trim','callback','includes','button','eventHistory','search','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','extendObjectAsync','startExitTimer','online','Keine\x20neuen\x20Automatisierungs-Muster\x20erkannt.','models/gemini-flash-latest','expire','Briefing\x20Sched\x20Error:\x20','system','\x20hours.\x20Potential\x20incapacitation.','prÃ¤senz','enum','notifyPushoverInstance','LTM.driftAnalysis.driftDetails','analysisTimer','startsWith','targetposition','Scheduling\x20Morning\x20Briefing\x20for\x20','livingContext','sensor','notifyPushoverRecipient','Restlessness\x20Level','2-digit',')\x20verdÃ¤chtig\x20still?\x20Erwartest\x20du\x20basierend\x20auf\x20der\x20Tageszeit\x20AktivitÃ¤t\x20(z.B.\x20Morgens\x20Aufstehen)?\x20Wenn\x20ja\x20->\x20ALARM.\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20Akut\x20(vs.\x20STB):\x20Weicht\x20das\x20heutige\x20Verhalten\x20stark\x20von\x20den\x20letzten\x2014\x20Tagen\x20ab?\x20(z.B.\x205x\x20Toilette\x20statt\x203x).\x20Wenn\x20ja\x20->\x20WARNUNG.\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20Schleichend\x20(Drift):\x20(Nur\x20relevant\x20wenn\x20Phase\x203\x20aktiv)\x20Gibt\x20es\x20einen\x20langsamen\x20Trend\x20ins\x20Negative?\x0a\x20\x20\x20\x20\x20\x20\x20\x20Ignoriere\x20Fehlalarme\x20durch\x20Kontext:\x20','actual_temperature','Deaktiviert\x20(Pro-Feature)','simple-api.','initZombies','vis.','inactivityMonitoringEnabled','ltmJob','scriptEnabled','onUnload','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','ðŸš¨ðŸš¨\x20NOTFALL','analysis.feedbackHistory','Gast','setState','loadRawEventLog','Cogni-Living','analysis.health','notifyEmailRecipient','Alert\x20Reason','N/A\x20(Learning)','notifyEmailEnabled','update','notifyEmailInstance','434925ynSacU','direction','accuweather.0','Kein\x20API\x20Key\x20konfiguriert!','info','error','System\x20Mode','isProVersion','system.isPresent','testApiKey','summary','sendTo','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','replace','ltmStbWindowDays','cogni-living',')\x20-\x20OBFUSCATION\x20SAFE\x20MODE','initHistory','reachable','PRIORITÃ„T:\x20Gesundheit\x20und\x20Sicherheit\x20fÃ¼r\x20Senioren\x20(AAL).\x20Erkenne\x20InaktivitÃ¤t,\x20potenzielle\x20StÃ¼rze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20nÃ¤chtliche\x20Unruhe.','ðŸš¨\x20EMERGENCY','toLocaleString','analysis.automation.description','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','setupModeResetScheduler','command','driftAnalysisTimer','VACATION','KALENDER:\x20Keine\x20relevanten\x20Termine','material.','Schlafzimmer','LTM.triggerDailyDigest','ready','application/json','switch','analysis.isAlert','Sleep\x20Score\x20(0-100)','@iobroker/adapter-core','Last\x20Check','timestamp','enum.rooms.*','some','runBaselineDriftAnalysis','onStateChange','val','lights','Badezimmer','uuid-not-found','setObjectNotExistsAsync','updateBaselineStatus','3126AjaCEM','heizung','LTM','bind','isArray','LTM.baselineStatus','GUEST','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','isPresent','.forecast.current.state','tryParse','333MNyTaR','fault','checkSystemObjects','Analysis\x20Error:\x20','isEmergency','updateAnalysisHistory','setStateAsync','boolean','.data.table','Reset\x20Sched\x20Error:\x20','normal','time','lastAlertState','_score','system.','setupDriftAnalysisScheduler','sound','analysis.automation','runGeminiAnalysis','analysis.health.restlessness','baselineDrift','checkLtmObjects','subscribeForeignStatesAsync','analysis.health.sleepScore','info.','type','light','split','Health\x20&\x20Sleep\x20Analysis','firmware','splice','LTM.driftAnalysis','logDuplicates','isAlert','rollladen','processSensorEvent','.NextHours.Location_1.Day_1.current.symbol_desc','weather','Urlaub','Deviation','getForeignStateAsync','analysis.lastResult','Drift\x20Sched\x20Error:\x20','[TEST]\x20','\x20sensors...','currentSystemMode','@google/generative-ai','Kalender:\x20Deaktiviert','sendNotification','analysisInterval','catch','main','Action','wohn','stateChange','apply','parse','Daily\x20Digests','humidity','date','Wetter:\x20Deaktiviert','getForeignObjectsAsync','endsWith','lowbat','level','setpoint','Adapter','dailyDigests','createAllObjects','energy','text.alarm','Error\x20checking\x20WiFi:\x20','setupLtmScheduler','enum.functions.*','Trigger\x20Analysis','analysis.analysisHistory','setHours','common','devices','analysis.alertReason','minDaysForBaseline','weatherunderground.0','200529kqzeml','checkLtmDriftObjects','runAutopilot','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20in\x20onMessage\x20command\x20','unshift','value','patternDetected','flot.','analysis.automation.patternDetected','.Summary.Current','string','isGracePeriodActive','length','object','analysis.isEmergency','send','saveFeedback','getForeignObjectAsync','createDailyDigest','0\x203\x20*\x20*\x20*','latitude','initPresenceSubscriptions','javascript.','scanDevices','city','checkWifiPresence','brightness','getGenerativeModel','analysis.trigger','\x20presence\x20devices...','saveRawEventLog','rawEventLog','exitGraceTimer','analysis.comfortSuggestion','write','indicator.alarm','number','Trigger\x20Briefing\x20(Test)','custom','getCalendarNames\x20Error:\x20','No\x20recorded\x20events\x20yet.','pop','6hQAyVd','50968aIobwQ','.\x20PRÃ„SENZ:\x20','working','json','testNotification','toString','channel','Scanning\x20for\x20devices\x20(V7:\x20Basics\x20+\x20Explicit\x20Whitelist)...','role','accuweather','push','admin.','Comfort\x20Suggestion','KÃ¼che','openweathermap.0','message','sendToAsync','blind','\x20*\x20*\x20*','uuid','Normal','Nein','genAI'];a0_0x366b=function(){return _0x2bc0be;};return a0_0x366b();}(function(_0x392a58,_0x17aec7){const _0xf3aef4=a0_0x5125,_0x49d92c=_0x392a58();while(!![]){try{const _0x5407a6=parseInt(_0xf3aef4(0x296))/0x1+-parseInt(_0xf3aef4(0x2f7))/0x2+-parseInt(_0xf3aef4(0x2c1))/0x3*(-parseInt(_0xf3aef4(0x2de))/0x4)+parseInt(_0xf3aef4(0x207))/0x5+parseInt(_0xf3aef4(0x239))/0x6*(parseInt(_0xf3aef4(0x318))/0x7)+parseInt(_0xf3aef4(0x2c2))/0x8*(-parseInt(_0xf3aef4(0x244))/0x9)+-parseInt(_0xf3aef4(0x16e))/0xa;if(_0x5407a6===_0x17aec7)break;else _0x49d92c['push'](_0x49d92c['shift']());}catch(_0x61568e){_0x49d92c['push'](_0x49d92c['shift']());}}}(a0_0x366b,0x27afc));const a0_0xab4aaf=(function(){let _0x5b15e4=!![];return function(_0x19324a,_0x490f84){const _0x37712c=_0x5b15e4?function(){const _0x30963f=a0_0x5125;if(_0x490f84){const _0x24a284=_0x490f84[_0x30963f(0x27b)](_0x19324a,arguments);return _0x490f84=null,_0x24a284;}}:function(){};return _0x5b15e4=![],_0x37712c;};}()),a0_0x6ed578=a0_0xab4aaf(this,function(){const _0x2f4e0e=a0_0x5125;return a0_0x6ed578[_0x2f4e0e(0x2c7)]()[_0x2f4e0e(0x1d7)]('(((.+)+)+)+$')[_0x2f4e0e(0x2c7)]()[_0x2f4e0e(0x2dc)](a0_0x6ed578)[_0x2f4e0e(0x1d7)](_0x2f4e0e(0x1a2));});a0_0x6ed578();'use strict';const utils=require(a0_0x421c3c(0x22c)),{GoogleGenerativeAI}=require(a0_0x421c3c(0x272)),schedule=require('node-schedule'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x421c3c(0x1dd),LTM_SCHEDULE=a0_0x421c3c(0x2aa),MODE_RESET_SCHEDULE=a0_0x421c3c(0x186),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x421c3c(0x1ae),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x421c3c(0x1cf),LTM_DP_TRIGGER_DIGEST=a0_0x421c3c(0x226),LTM_DP_BASELINE_STATUS=a0_0x421c3c(0x23e),LTM_DP_DRIFT_CHANNEL=a0_0x421c3c(0x263),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x421c3c(0x1e5),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x421c3c(0x1a6),HARD_IGNORE_TERMS=[a0_0x421c3c(0x30f),a0_0x421c3c(0x1f7),a0_0x421c3c(0x205),a0_0x421c3c(0x2df),a0_0x421c3c(0x283),a0_0x421c3c(0x184),a0_0x421c3c(0x311),a0_0x421c3c(0x1c0),a0_0x421c3c(0x20c),a0_0x421c3c(0x245),a0_0x421c3c(0x2c4),a0_0x421c3c(0x208),a0_0x421c3c(0x1c9),'config_pending','dutycycle',a0_0x421c3c(0x261),a0_0x421c3c(0x219),a0_0x421c3c(0x179)],GENERIC_NAMES=[a0_0x421c3c(0x1e8),a0_0x421c3c(0x309),a0_0x421c3c(0x306),a0_0x421c3c(0x284),a0_0x421c3c(0x29c),a0_0x421c3c(0x2b1),'on','off','switch',a0_0x421c3c(0x1cb),a0_0x421c3c(0x2fe),a0_0x421c3c(0x2d3),a0_0x421c3c(0x188),a0_0x421c3c(0x173),a0_0x421c3c(0x2d9),'presence','occupancy',a0_0x421c3c(0x180),a0_0x421c3c(0x27e),a0_0x421c3c(0x2f3),a0_0x421c3c(0x289),a0_0x421c3c(0x285),a0_0x421c3c(0x1a1),a0_0x421c3c(0x1f0),a0_0x421c3c(0x194)],ADAPTER_BLACKLIST=[a0_0x421c3c(0x252),a0_0x421c3c(0x2cd),a0_0x421c3c(0x25c),a0_0x421c3c(0x1f4),a0_0x421c3c(0x187),a0_0x421c3c(0x224),'icons-mfd.',a0_0x421c3c(0x29e),a0_0x421c3c(0x18a),a0_0x421c3c(0x2ad),a0_0x421c3c(0x1f2)],SYSTEM_MODES={'NORMAL':a0_0x421c3c(0x24e),'VACATION':a0_0x421c3c(0x313),'PARTY':a0_0x421c3c(0x304),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x421c3c(0x190)],SYSTEM_MODES[a0_0x421c3c(0x23f)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':a0_0x421c3c(0x21a),'family':a0_0x421c3c(0x2f1),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':'PRIORITÃ„T:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungewÃ¶hnliche\x20Anwesenheit.'};class CogniLiving extends utils[a0_0x421c3c(0x286)]{constructor(_0x528089){const _0x44adbd=a0_0x421c3c;super({..._0x528089,'name':_0x44adbd(0x216)}),this[_0x44adbd(0x1d6)]=[],this['analysisHistory']=[],this['feedbackHistory']=[],this['rawEventLog']=[],this['dailyDigests']=[],this[_0x44adbd(0x17c)]={},this[_0x44adbd(0x31a)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x44adbd(0x241)]=!![],this['exitTimer']=null,this[_0x44adbd(0x2b7)]=null,this['isGracePeriodActive']=![],this[_0x44adbd(0x2d8)]=null,this[_0x44adbd(0x314)]=null,this[_0x44adbd(0x271)]=SYSTEM_MODES[_0x44adbd(0x1a9)],this[_0x44adbd(0x20e)]=![],this['lastAlertState']=![],this[_0x44adbd(0x2e1)]='unknown',this[_0x44adbd(0x1e6)]=null,this[_0x44adbd(0x1f6)]=null,this[_0x44adbd(0x2ed)]=null,this[_0x44adbd(0x221)]=null,this['briefingJob']=null,this['on'](_0x44adbd(0x227),this[_0x44adbd(0x316)][_0x44adbd(0x23c)](this)),this['on'](_0x44adbd(0x27a),this['onStateChange'][_0x44adbd(0x23c)](this)),this['on']('unload',this['onUnload'][_0x44adbd(0x23c)](this)),this['on'](_0x44adbd(0x2d1),this[_0x44adbd(0x1d1)][_0x44adbd(0x23c)](this));}async[a0_0x421c3c(0x316)](){const _0x19fd40=a0_0x421c3c;this[_0x19fd40(0x1c7)][_0x19fd40(0x20b)]('cogni-living\x20adapter\x20starting\x20(v'+this['version']+_0x19fd40(0x217)),await this[_0x19fd40(0x1f3)](),this['config'][_0x19fd40(0x1bd)]=this[_0x19fd40(0x2fb)][_0x19fd40(0x1bd)]||'';try{this[_0x19fd40(0x20e)]=await this[_0x19fd40(0x2ec)](this[_0x19fd40(0x2fb)]['licenseKey']);}catch(_0x2d78e2){this[_0x19fd40(0x1c7)]['error'](_0x19fd40(0x1a5)+_0x2d78e2[_0x19fd40(0x2d1)]);}if(!this['config'][_0x19fd40(0x319)]||this[_0x19fd40(0x2fb)][_0x19fd40(0x319)]<0.1)this['config'][_0x19fd40(0x319)]=0xc;await this[_0x19fd40(0x218)](),await this[_0x19fd40(0x170)]();if(this[_0x19fd40(0x2fb)][_0x19fd40(0x185)])try{this['genAI']=new GoogleGenerativeAI(this[_0x19fd40(0x2fb)][_0x19fd40(0x185)]),this[_0x19fd40(0x314)]=this[_0x19fd40(0x2d8)][_0x19fd40(0x2b2)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x19fd40(0x228)}}),this['log'][_0x19fd40(0x20b)](_0x19fd40(0x176));}catch(_0x2ee74b){this[_0x19fd40(0x1c7)][_0x19fd40(0x20c)](_0x19fd40(0x2ee)+_0x2ee74b[_0x19fd40(0x2d1)]);}await this[_0x19fd40(0x288)](),await this[_0x19fd40(0x315)](),await this[_0x19fd40(0x1fe)](),await this['loadDailyDigests'](),this[_0x19fd40(0x30a)](_0x19fd40(0x2b3)),this[_0x19fd40(0x30a)](LTM_DP_TRIGGER_DIGEST),this[_0x19fd40(0x30a)](_0x19fd40(0x1a6)),this[_0x19fd40(0x30a)]('analysis.triggerBriefing'),await this[_0x19fd40(0x175)](),await this[_0x19fd40(0x2ac)]();if(this['analysisTimer'])clearInterval(this[_0x19fd40(0x1e6)]);const _0x208549=this[_0x19fd40(0x2fb)][_0x19fd40(0x275)]||0xf;_0x208549>0x0&&(this[_0x19fd40(0x1c7)][_0x19fd40(0x20b)](_0x19fd40(0x16c)+_0x208549+'\x20min).\x20Watchdog\x20Limit:\x20'+this[_0x19fd40(0x2fb)][_0x19fd40(0x319)]+'h.'),this['analysisTimer']=setInterval(()=>{const _0x3c3ada=_0x19fd40;this[_0x3c3ada(0x298)]();},_0x208549*0x3c*0x3e8)),this[_0x19fd40(0x28c)](),this[_0x19fd40(0x21f)](),this[_0x19fd40(0x253)](),this[_0x19fd40(0x310)]();}[a0_0x421c3c(0x1f8)](_0x4db457){const _0x46d308=a0_0x421c3c;if(this['analysisTimer'])clearInterval(this[_0x46d308(0x1e6)]);if(this[_0x46d308(0x221)])clearInterval(this[_0x46d308(0x221)]);if(this[_0x46d308(0x1f6)])this['ltmJob'][_0x46d308(0x2f8)]();if(this['modeResetJob'])this['modeResetJob'][_0x46d308(0x2f8)]();if(this[_0x46d308(0x1aa)])this['briefingJob']['cancel']();if(this['exitTimer'])clearTimeout(this['exitTimer']);if(this['exitGraceTimer'])clearTimeout(this[_0x46d308(0x2b7)]);_0x4db457();}async[a0_0x421c3c(0x232)](_0x45dc33,_0x2df0e3){const _0x23dcfb=a0_0x421c3c;if(!_0x2df0e3)return;if(_0x45dc33===this['namespace']+'.'+SYSTEM_DP_MODE){_0x2df0e3[_0x23dcfb(0x233)]&&Object['values'](SYSTEM_MODES)[_0x23dcfb(0x1d4)](_0x2df0e3[_0x23dcfb(0x233)])&&(this[_0x23dcfb(0x271)]=_0x2df0e3[_0x23dcfb(0x233)],_0x2df0e3[_0x23dcfb(0x233)]===SYSTEM_MODES[_0x23dcfb(0x222)]?await this['setPresence'](![]):await this[_0x23dcfb(0x177)](!![]));if(!_0x2df0e3[_0x23dcfb(0x17d)])this['setState'](_0x45dc33,{'val':this[_0x23dcfb(0x271)],'ack':!![]});return;}if(!_0x2df0e3['ack']){_0x45dc33[_0x23dcfb(0x1d4)]('analysis.trigger')&&_0x2df0e3[_0x23dcfb(0x233)]&&(this[_0x23dcfb(0x1fd)](_0x45dc33,{'val':![],'ack':!![]}),this['runGeminiAnalysis']());if(_0x45dc33['includes'](_0x23dcfb(0x1bb))&&_0x2df0e3[_0x23dcfb(0x233)]){this[_0x23dcfb(0x1fd)](_0x45dc33,{'val':![],'ack':!![]});if(this['isProVersion'])this[_0x23dcfb(0x2a9)]();}_0x45dc33[_0x23dcfb(0x1d4)](_0x23dcfb(0x2ef))&&_0x2df0e3[_0x23dcfb(0x233)]&&(this[_0x23dcfb(0x1fd)](_0x45dc33,{'val':![],'ack':!![]}),this[_0x23dcfb(0x16b)]());return;}if(this[_0x23dcfb(0x2fb)][_0x23dcfb(0x18c)]&&this[_0x23dcfb(0x2fb)]['presenceDevices']['includes'](_0x45dc33)){await this[_0x23dcfb(0x2b0)]();return;}const _0x5cef32=(this[_0x23dcfb(0x2fb)]['devices']||[])[_0x23dcfb(0x2f0)](_0x481b40=>_0x481b40['id']===_0x45dc33);if(_0x5cef32)this['processSensorEvent'](_0x45dc33,_0x2df0e3,_0x5cef32);}async[a0_0x421c3c(0x1d1)](_0x456a23){const _0x5c01a7=a0_0x421c3c;if(typeof _0x456a23===_0x5c01a7(0x2a4)&&_0x456a23[_0x5c01a7(0x2d1)])try{if(_0x456a23[_0x5c01a7(0x220)]===_0x5c01a7(0x210)){}else{if(_0x456a23['command']===_0x5c01a7(0x2c6)){}else{if(_0x456a23['command']===_0x5c01a7(0x196)){}else{if(_0x456a23[_0x5c01a7(0x220)]===_0x5c01a7(0x178)){const _0x23e9c3=this[_0x5c01a7(0x287)][_0x5c01a7(0x2a3)],_0x306113=this[_0x5c01a7(0x1d6)][_0x5c01a7(0x18e)](_0x3f14e9=>_0x3f14e9[_0x5c01a7(0x22e)]>new Date()[_0x5c01a7(0x290)](0x0,0x0,0x0,0x0))[_0x5c01a7(0x2a3)];let _0x8145e2={'status':_0x5c01a7(0x2e2)};try{_0x8145e2[_0x5c01a7(0x173)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x5c01a7(0x233)];}catch(_0x3ebfd5){}let _0x5d026f=null;!this[_0x5c01a7(0x314)]&&(_0x5d026f=this[_0x5c01a7(0x2fb)][_0x5c01a7(0x185)]?_0x5c01a7(0x195):_0x5c01a7(0x20a)),this['sendTo'](_0x456a23[_0x5c01a7(0x30b)],_0x456a23[_0x5c01a7(0x220)],{'success':!![],'eventHistory':this[_0x5c01a7(0x1d6)][_0x5c01a7(0x2e3)](0x0,0xf),'stats':{'digestCount':_0x23e9c3,'eventCountToday':_0x306113,'driftStatus':_0x8145e2[_0x5c01a7(0x173)],'isPresent':this[_0x5c01a7(0x241)],'minDays':this['config']['minDaysForBaseline']||0x7,'stbDays':this[_0x5c01a7(0x2fb)][_0x5c01a7(0x215)]||0xe,'ltbDays':this[_0x5c01a7(0x2fb)][_0x5c01a7(0x2e4)]||0x3c,'systemError':_0x5d026f}},_0x456a23[_0x5c01a7(0x1d3)]);}else{if(_0x456a23[_0x5c01a7(0x220)]==='getEnums'){const _0x2b2782=await this[_0x5c01a7(0x281)](_0x5c01a7(0x28d),_0x5c01a7(0x1e3)),_0x26bfb0=[];if(_0x2b2782)for(const _0x48253f in _0x2b2782){const _0x49f502=_0x2b2782[_0x48253f],_0x59ac1a=(_0x49f502[_0x5c01a7(0x291)]&&typeof _0x49f502[_0x5c01a7(0x291)][_0x5c01a7(0x300)]===_0x5c01a7(0x2a4)?_0x49f502[_0x5c01a7(0x291)][_0x5c01a7(0x300)]['de']:_0x49f502['common'][_0x5c01a7(0x300)])||_0x49f502['common'][_0x5c01a7(0x300)];_0x26bfb0[_0x5c01a7(0x2cc)]({'id':_0x48253f,'name':_0x59ac1a});}this['sendTo'](_0x456a23[_0x5c01a7(0x30b)],_0x456a23['command'],{'success':!![],'enums':_0x26bfb0},_0x456a23[_0x5c01a7(0x1d3)]);}else{if(_0x456a23[_0x5c01a7(0x220)]===_0x5c01a7(0x2ae))try{const _0x69a7c1=await this[_0x5c01a7(0x2ff)](_0x456a23[_0x5c01a7(0x2d1)]||{});this[_0x5c01a7(0x212)](_0x456a23[_0x5c01a7(0x30b)],_0x456a23[_0x5c01a7(0x220)],{'success':!![],'devices':_0x69a7c1},_0x456a23[_0x5c01a7(0x1d3)]);}catch(_0x31af8f){this[_0x5c01a7(0x212)](_0x456a23[_0x5c01a7(0x30b)],_0x456a23[_0x5c01a7(0x220)],{'success':![],'error':_0x31af8f[_0x5c01a7(0x2d1)]},_0x456a23[_0x5c01a7(0x1d3)]);}}}}}}}catch(_0xbc8531){this[_0x5c01a7(0x1c7)][_0x5c01a7(0x20c)](_0x5c01a7(0x29a)+_0x456a23[_0x5c01a7(0x220)]+':\x20'+_0xbc8531[_0x5c01a7(0x2d1)]);if(_0x456a23[_0x5c01a7(0x1d3)])this[_0x5c01a7(0x212)](_0x456a23[_0x5c01a7(0x30b)],_0x456a23[_0x5c01a7(0x220)],{'success':![],'error':_0xbc8531['message']},_0x456a23['callback']);}}async[a0_0x421c3c(0x267)](_0x55f192,_0x3f0c1e,_0x5eb4d7){const _0x5c9c4c=a0_0x421c3c;if(!_0x5eb4d7[_0x5c9c4c(0x264)]&&this[_0x5c9c4c(0x17c)][_0x55f192]===_0x3f0c1e['val'])return;this[_0x5c9c4c(0x17c)][_0x55f192]=_0x3f0c1e[_0x5c9c4c(0x233)];if(this[_0x5c9c4c(0x2a2)])return;const _0x1c3d3f=await this[_0x5c9c4c(0x2b0)]();if(_0x1c3d3f){if(!this[_0x5c9c4c(0x241)])await this['setPresence'](!![]);}else{const _0x2ab87e=_0x5eb4d7[_0x5c9c4c(0x1ab)]===!![];_0x2ab87e?this[_0x5c9c4c(0x1da)]():(this[_0x5c9c4c(0x1a7)]&&this[_0x5c9c4c(0x197)](),!this['isPresent']&&this['currentSystemMode']===SYSTEM_MODES[_0x5c9c4c(0x1a9)]&&await this[_0x5c9c4c(0x177)](!![]));}const _0x17f0f7={'timestamp':_0x3f0c1e['ts'],'id':_0x55f192,'name':_0x5eb4d7[_0x5c9c4c(0x300)],'value':_0x3f0c1e['val'],'location':_0x5eb4d7[_0x5c9c4c(0x2f2)],'type':_0x5eb4d7[_0x5c9c4c(0x25d)]};this[_0x5c9c4c(0x1d6)][_0x5c9c4c(0x29b)](_0x17f0f7);if(this[_0x5c9c4c(0x1d6)][_0x5c9c4c(0x2a3)]>HISTORY_MAX_SIZE)this['eventHistory']['pop']();await this[_0x5c9c4c(0x24a)](_0x5c9c4c(0x30c),{'val':JSON['stringify'](_0x17f0f7),'ack':!![]}),await this[_0x5c9c4c(0x24a)](_0x5c9c4c(0x1ad),{'val':JSON[_0x5c9c4c(0x2e6)](this[_0x5c9c4c(0x1d6)]),'ack':!![]}),this[_0x5c9c4c(0x2b6)][_0x5c9c4c(0x2cc)]({'timestamp':new Date(_0x3f0c1e['ts'])[_0x5c9c4c(0x1c5)](),'sensorName':_0x5eb4d7[_0x5c9c4c(0x300)],'location':_0x5eb4d7[_0x5c9c4c(0x2f2)],'value':_0x3f0c1e[_0x5c9c4c(0x233)]}),await this['saveRawEventLog']();}async[a0_0x421c3c(0x256)](_0x640455=''){const _0x8858c3=a0_0x421c3c;if(!this['geminiModel']){this[_0x8858c3(0x1c7)][_0x8858c3(0x1cd)](_0x8858c3(0x1a3));return;}const _0x2ca39a=this['eventHistory']['length']>0x0?this[_0x8858c3(0x1d6)]:[{'note':_0x8858c3(0x2bf)}],_0x2f951f=PERSONA_MAPPING[this['config']['aiPersona']||_0x8858c3(0x2e9)],_0x2f339f=this[_0x8858c3(0x2fb)][_0x8858c3(0x1ea)]||'',_0x5043da=this[_0x8858c3(0x271)],_0x54599d=await this[_0x8858c3(0x1bc)](),_0x3d0eb8=await this[_0x8858c3(0x1b5)](),_0x5f4253=(_0x54599d+'\x20'+_0x3d0eb8)[_0x8858c3(0x1d2)](),_0x2077e3=new Date(),_0x10addc=_0x2077e3[_0x8858c3(0x21c)]('de-DE',{'weekday':'long','hour':'2-digit','minute':_0x8858c3(0x1ee)});let _0x2e2820='Phase\x201:\x20Learning\x20(No\x20Baseline).\x20Rely\x20on\x20common\x20sense.';const _0x2376f3=this[_0x8858c3(0x287)][_0x8858c3(0x2a3)];if(this[_0x8858c3(0x20e)]&&_0x2376f3>=(this['config'][_0x8858c3(0x294)]||0x7)){const _0x547665=this[_0x8858c3(0x287)][_0x8858c3(0x2e3)](-(this[_0x8858c3(0x2fb)]['ltmStbWindowDays']||0xe));_0x2e2820='Phase\x202:\x20ACUTE\x20MONITORING.\x20STB\x20(Last\x2014d):\x20'+JSON['stringify'](_0x547665)+'.';if(_0x2376f3>=0x1e)_0x2e2820+='\x20Phase\x203:\x20DRIFT\x20ACTIVE.\x20Compare\x20recent\x20events\x20against\x20long-term\x20patterns.';}const _0x1a5e9b='\x0a\x20\x20\x20\x20\x20\x20\x20\x20CRITICAL\x20SAFETY\x20CHECK:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20Sofort/Ad-Hoc:\x20Ist\x20es\x20jetzt\x20('+_0x10addc+_0x8858c3(0x1ef)+_0x5f4253+_0x8858c3(0x21e),_0x2f471e=_0x8858c3(0x1d8)+_0x10addc+_0x8858c3(0x2fa)+_0x5043da+_0x8858c3(0x2c3)+(this[_0x8858c3(0x241)]?'Ja':_0x8858c3(0x2d7))+'.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20'+_0x2f339f+'.\x20PERSONA:\x20'+_0x2f951f+_0x8858c3(0x299)+_0x2e2820+'\x20'+(_0x640455?_0x640455:'')+_0x8858c3(0x21e)+_0x1a5e9b+_0x8858c3(0x1f9)+JSON['stringify'](_0x2ca39a)+_0x8858c3(0x17e);try{const _0x4c5d86=await this[_0x8858c3(0x314)]['generateContent'](_0x2f471e),_0x40bfba=_0x4c5d86[_0x8858c3(0x171)][_0x8858c3(0x2fc)]()[_0x8858c3(0x214)](/```json|```/g,'')[_0x8858c3(0x1d2)](),_0x544e8d=JSON[_0x8858c3(0x27c)](_0x40bfba);await this[_0x8858c3(0x24a)](_0x8858c3(0x26d),{'val':_0x40bfba,'ack':!![]}),await this[_0x8858c3(0x24a)](_0x8858c3(0x293),{'val':_0x544e8d['activity'][_0x8858c3(0x1bf)]||'','ack':!![]}),await this[_0x8858c3(0x24a)](_0x8858c3(0x16a),{'val':_0x544e8d[_0x8858c3(0x17b)][_0x8858c3(0x211)]||_0x8858c3(0x2e2),'ack':!![]});const _0x51a103=_0x544e8d['comfort']['automationProposal'],_0xe35c6e=this[_0x8858c3(0x20e)]?_0x51a103[_0x8858c3(0x29d)]:![];await this['setStateAsync'](_0x8858c3(0x29f),{'val':_0xe35c6e,'ack':!![]});let _0xaf349a='Pro\x20Feature';if(this[_0x8858c3(0x20e)])_0xaf349a=_0xe35c6e?_0x51a103[_0x8858c3(0x181)]:_0x8858c3(0x1dc);await this[_0x8858c3(0x24a)](_0x8858c3(0x21d),{'val':_0xaf349a,'ack':!![]});if(_0x544e8d['activity'][_0x8858c3(0x265)]||_0x544e8d[_0x8858c3(0x17b)][_0x8858c3(0x248)]){await this[_0x8858c3(0x24a)](_0x8858c3(0x22a),{'val':!![],'ack':!![]});if(!this[_0x8858c3(0x250)]||_0x544e8d[_0x8858c3(0x17b)][_0x8858c3(0x248)]){const _0x49d874=_0x544e8d['activity'][_0x8858c3(0x248)]?_0x8858c3(0x1fa):_0x8858c3(0x17f);this[_0x8858c3(0x274)](_0x49d874+':\x20'+_0x544e8d[_0x8858c3(0x17b)][_0x8858c3(0x1bf)],![],_0x544e8d[_0x8858c3(0x17b)][_0x8858c3(0x248)]);}}else await this[_0x8858c3(0x24a)](_0x8858c3(0x22a),{'val':![],'ack':!![]});this['lastAlertState']=_0x544e8d[_0x8858c3(0x17b)][_0x8858c3(0x265)]||_0x544e8d[_0x8858c3(0x17b)][_0x8858c3(0x248)];const _0x6ab557={'timestamp':Date[_0x8858c3(0x1c2)](),'id':Date[_0x8858c3(0x1c2)]()[_0x8858c3(0x2c7)](),'analysis':_0x544e8d,'systemMode':_0x5043da,'isPro':this[_0x8858c3(0x20e)]};this[_0x8858c3(0x249)](_0x6ab557);}catch(_0x3fd326){this['log'][_0x8858c3(0x20c)](_0x8858c3(0x247)+_0x3fd326[_0x8858c3(0x2d1)]);}}async[a0_0x421c3c(0x298)](){const _0xd6b623=a0_0x421c3c,_0x127c72=this['config'][_0xd6b623(0x319)],_0xc14990=this['eventHistory']['length']>0x0?this[_0xd6b623(0x1d6)][0x0][_0xd6b623(0x22e)]:Date[_0xd6b623(0x1c2)](),_0x254425=(Date[_0xd6b623(0x1c2)]()-_0xc14990)/(0x3e8*0x3c*0x3c);let _0xd93659='';this[_0xd6b623(0x2fb)][_0xd6b623(0x1f5)]&&this[_0xd6b623(0x271)]===SYSTEM_MODES[_0xd6b623(0x1a9)]&&this['isPresent']&&(_0x254425>_0x127c72&&(_0xd93659='HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20'+_0x254425[_0xd6b623(0x2da)](0x1)+_0xd6b623(0x1e1))),this[_0xd6b623(0x256)](_0xd93659)[_0xd6b623(0x276)](_0x4eee75=>this[_0xd6b623(0x1c7)][_0xd6b623(0x20c)](_0x4eee75));}async['createDailyDigest'](){}async[a0_0x421c3c(0x16b)](){}async[a0_0x421c3c(0x2ff)](_0x3a1c09){const _0x57730e=a0_0x421c3c;this[_0x57730e(0x1c7)][_0x57730e(0x20b)](_0x57730e(0x2c9));const _0xf1435c=[],_0x21bc46=await this[_0x57730e(0x281)]('*'),_0x1a1148=await this[_0x57730e(0x281)]('enum.functions.*',_0x57730e(0x1e3)),_0x7fd337=await this[_0x57730e(0x281)](_0x57730e(0x22f),_0x57730e(0x1e3)),_0x1ec36c={};if(_0x1a1148)for(const _0xa9195e in _0x1a1148){const _0x40eb9d=_0x1a1148[_0xa9195e]['common'][_0x57730e(0x1c6)]||[];_0x40eb9d[_0x57730e(0x2dd)](_0x297ff8=>{const _0xc1be4c=_0x57730e;if(!_0x1ec36c[_0x297ff8])_0x1ec36c[_0x297ff8]=[];_0x1ec36c[_0x297ff8][_0xc1be4c(0x2cc)](_0xa9195e);});}const _0x48f55d={};if(_0x7fd337)for(const _0x324608 in _0x7fd337){const _0xbb9ee2=_0x7fd337[_0x324608][_0x57730e(0x291)][_0x57730e(0x1c6)]||[],_0x42008b=typeof _0x7fd337[_0x324608]['common'][_0x57730e(0x300)]===_0x57730e(0x2a4)?_0x7fd337[_0x324608][_0x57730e(0x291)]['name']['de']:_0x7fd337[_0x324608]['common']['name'];_0xbb9ee2[_0x57730e(0x2dd)](_0x187607=>_0x48f55d[_0x187607]=_0x42008b);}const _0x1defe4=_0x3a1c09[_0x57730e(0x1b9)]||[],_0x133a38=_0x3a1c09[_0x57730e(0x2d9)]!==![],_0x27e3a4=_0x3a1c09[_0x57730e(0x1cc)]!==![],_0x426331=_0x3a1c09[_0x57730e(0x234)]!==![],_0x1c219a=_0x3a1c09['temperature']===!![],_0x2ab142=_0x3a1c09[_0x57730e(0x269)]===!![];for(const _0x344cbf in _0x21bc46){const _0x4f700c=_0x21bc46[_0x344cbf];if(_0x4f700c['type']!==_0x57730e(0x306)||!_0x4f700c[_0x57730e(0x291)])continue;if(ADAPTER_BLACKLIST[_0x57730e(0x230)](_0x4c2bac=>_0x344cbf[_0x57730e(0x1e7)](_0x4c2bac))&&!_0x2ab142)continue;const _0x320d04=(_0x4f700c[_0x57730e(0x291)][_0x57730e(0x2ca)]||'')[_0x57730e(0x2fd)]();let _0x3a6a24=(typeof _0x4f700c[_0x57730e(0x291)][_0x57730e(0x300)]===_0x57730e(0x2a4)?_0x4f700c['common'][_0x57730e(0x300)]['de']:_0x4f700c[_0x57730e(0x291)][_0x57730e(0x300)])||_0x344cbf;const _0x581ca4=_0x3a6a24[_0x57730e(0x2fd)]();let _0x30cc4d=![];if(_0x1defe4[_0x57730e(0x2a3)]>0x0){const _0x518087=_0x1ec36c[_0x344cbf]||[],_0x568401=_0x344cbf[_0x57730e(0x25f)]('.')[_0x57730e(0x2e3)](0x0,-0x1)[_0x57730e(0x307)]('.'),_0xdef100=_0x1ec36c[_0x568401]||[],_0x3bd8b0=_0x344cbf[_0x57730e(0x25f)]('.')[_0x57730e(0x2e3)](0x0,-0x2)['join']('.'),_0x40ed28=_0x1ec36c[_0x3bd8b0]||[];if(_0x518087[_0x57730e(0x230)](_0x44eb39=>_0x1defe4[_0x57730e(0x1d4)](_0x44eb39))||_0xdef100[_0x57730e(0x230)](_0x170612=>_0x1defe4['includes'](_0x170612))||_0x40ed28['some'](_0x1fc3ce=>_0x1defe4['includes'](_0x1fc3ce)))_0x30cc4d=!![];}if(!_0x30cc4d&&!_0x2ab142){if(HARD_IGNORE_TERMS['some'](_0x4dceb1=>_0x344cbf[_0x57730e(0x1d4)](_0x4dceb1)||_0x581ca4[_0x57730e(0x1d4)](_0x4dceb1[_0x57730e(0x2fd)]())))continue;}if(GENERIC_NAMES['some'](_0xf9bd62=>_0x581ca4===_0xf9bd62||_0x581ca4[_0x57730e(0x282)]('.'+_0xf9bd62))){const _0x39b15a=_0x344cbf[_0x57730e(0x25f)]('.');if(_0x39b15a['length']>0x2){const _0xe976b7=_0x39b15a[_0x57730e(0x2e3)](0x0,-0x1)[_0x57730e(0x307)]('.'),_0x1d8d43=_0x21bc46[_0xe976b7];if(_0x1d8d43&&_0x1d8d43['common']&&_0x1d8d43[_0x57730e(0x291)][_0x57730e(0x300)]){const _0x37a30b=typeof _0x1d8d43[_0x57730e(0x291)][_0x57730e(0x300)]===_0x57730e(0x2a4)?_0x1d8d43[_0x57730e(0x291)][_0x57730e(0x300)]['de']:_0x1d8d43[_0x57730e(0x291)][_0x57730e(0x300)];_0x37a30b&&!_0x3a6a24['includes'](_0x37a30b)&&(_0x3a6a24=_0x37a30b+'\x20'+_0x3a6a24);}}}let _0x18257a='';if(_0x133a38&&(_0x320d04[_0x57730e(0x1d4)](_0x57730e(0x2d9))||_0x320d04[_0x57730e(0x1d4)]('occupancy')||_0x581ca4[_0x57730e(0x1d4)](_0x57730e(0x302))||_0x581ca4['includes'](_0x57730e(0x1e2))))_0x18257a=_0x57730e(0x2d9);else{if(!_0x18257a&&_0x27e3a4&&(_0x320d04['includes']('door')||_0x320d04[_0x57730e(0x1d4)](_0x57730e(0x308))||_0x320d04['includes'](_0x57730e(0x2f9))||_0x320d04[_0x57730e(0x1d4)](_0x57730e(0x2d3))||_0x320d04['includes']('shutter')||_0x581ca4['includes'](_0x57730e(0x1a0))||_0x581ca4['includes'](_0x57730e(0x1b4))||_0x581ca4['includes'](_0x57730e(0x266))))_0x18257a='door';else{if(!_0x18257a&&_0x426331&&(_0x320d04[_0x57730e(0x1d4)](_0x57730e(0x25e))||_0x320d04[_0x57730e(0x1d4)](_0x57730e(0x229))||_0x320d04[_0x57730e(0x1d4)]('dimmer')||_0x581ca4[_0x57730e(0x1d4)](_0x57730e(0x18d))||_0x581ca4['includes']('lampe')||_0x581ca4[_0x57730e(0x1d4)]('schalter'))){if(_0x4f700c[_0x57730e(0x291)][_0x57730e(0x2b9)]||_0x320d04[_0x57730e(0x1d4)](_0x57730e(0x1eb)))_0x18257a=_0x57730e(0x25e);}else{if(!_0x18257a&&_0x1c219a&&(_0x320d04['includes']('temperature')||_0x320d04['includes'](_0x57730e(0x27e))||_0x320d04[_0x57730e(0x1d4)]('thermostat')||_0x581ca4[_0x57730e(0x1d4)](_0x57730e(0x312))||_0x581ca4[_0x57730e(0x1d4)](_0x57730e(0x2e5))||_0x581ca4[_0x57730e(0x1d4)](_0x57730e(0x23a))))_0x18257a=_0x57730e(0x180);else{if(!_0x18257a&&_0x30cc4d)_0x18257a=_0x57730e(0x2bd);}}}}if(_0x18257a){let _0x4458d7=_0x48f55d[_0x344cbf]||'';if(!_0x4458d7){let _0x49ba91=_0x344cbf;for(let _0x27a8f0=0x0;_0x27a8f0<0x3;_0x27a8f0++){const _0x559ac9=_0x49ba91[_0x57730e(0x19a)]('.');if(_0x559ac9===-0x1)break;_0x49ba91=_0x49ba91['substring'](0x0,_0x559ac9);if(_0x48f55d[_0x49ba91]){_0x4458d7=_0x48f55d[_0x49ba91];break;}}}if(!_0x4458d7){const _0x4d4403=(_0x344cbf+'\x20'+_0x3a6a24)[_0x57730e(0x2fd)]();if(_0x4d4403['includes'](_0x57730e(0x16d))||_0x4d4403['includes']('wc'))_0x4458d7=_0x57730e(0x235);else{if(_0x4d4403[_0x57730e(0x1d4)](_0x57730e(0x2e7)))_0x4458d7=_0x57730e(0x2cf);else{if(_0x4d4403['includes'](_0x57730e(0x279)))_0x4458d7=_0x57730e(0x199);else{if(_0x4d4403[_0x57730e(0x1d4)]('schlaf'))_0x4458d7=_0x57730e(0x225);else{if(_0x4d4403[_0x57730e(0x1d4)](_0x57730e(0x1af)))_0x4458d7='Flur';}}}}}_0xf1435c[_0x57730e(0x2cc)]({'id':_0x344cbf,'name':_0x3a6a24,'location':_0x4458d7,'type':_0x18257a,'logDuplicates':_0x18257a===_0x57730e(0x2d9),'isExit':![],'_score':_0x4458d7?0x50:_0x18257a===_0x57730e(0x2bd)?0x5a:0x28});}}return _0xf1435c['sort']((_0x5f3c8f,_0x2ed402)=>_0x2ed402[_0x57730e(0x251)]-_0x5f3c8f['_score']),_0xf1435c;}[a0_0x421c3c(0x243)](_0x2aeedf){const _0x3bb740=a0_0x421c3c;if(typeof _0x2aeedf===_0x3bb740(0x2a4))return _0x2aeedf;try{return JSON['parse'](_0x2aeedf);}catch(_0x1dca3b){return null;}}async[a0_0x421c3c(0x1f3)](){}async[a0_0x421c3c(0x218)](){const _0x208920=a0_0x421c3c;try{const _0x55bb8e=await this[_0x208920(0x189)](_0x208920(0x1ad));_0x55bb8e&&_0x55bb8e[_0x208920(0x233)]&&(this[_0x208920(0x1d6)]=JSON[_0x208920(0x27c)](_0x55bb8e[_0x208920(0x233)][_0x208920(0x2c7)]()));}catch(_0x280c43){this[_0x208920(0x1d6)]=[];}try{const _0x3629aa=await this[_0x208920(0x189)]('analysis.analysisHistory');if(_0x3629aa&&_0x3629aa[_0x208920(0x233)])this[_0x208920(0x1b6)]=JSON[_0x208920(0x27c)](_0x3629aa['val'][_0x208920(0x2c7)]());}catch(_0xa80750){this[_0x208920(0x1b6)]=[];}}async[a0_0x421c3c(0x170)](){const _0x5899d1=a0_0x421c3c;try{const _0x45cac5=await this[_0x5899d1(0x2a8)]('system.config');_0x45cac5&&_0x45cac5[_0x5899d1(0x291)]&&(this['systemConfig']={'latitude':_0x45cac5[_0x5899d1(0x291)][_0x5899d1(0x2ab)]||0x0,'longitude':_0x45cac5['common'][_0x5899d1(0x1a8)]||0x0,'city':_0x45cac5[_0x5899d1(0x291)][_0x5899d1(0x2af)]||''});}catch(_0x38f3f6){}}async['checkLicense'](_0x2e43f8){const _0x508048=a0_0x421c3c;if(!_0x2e43f8)return![];this[_0x508048(0x2e1)]=await this[_0x508048(0x1c4)]();if(_0x2e43f8===_0x508048(0x1c3)||_0x2e43f8[_0x508048(0x1e7)](_0x508048(0x1a4)))return!![];return![];}async[a0_0x421c3c(0x1c4)](){const _0x16fd46=a0_0x421c3c;try{const _0x3b327f=await this[_0x16fd46(0x2a8)]('system.meta.uuid');if(_0x3b327f&&_0x3b327f[_0x16fd46(0x1d0)]&&_0x3b327f[_0x16fd46(0x1d0)][_0x16fd46(0x2d5)])return _0x3b327f[_0x16fd46(0x1d0)][_0x16fd46(0x2d5)];return _0x16fd46(0x236);}catch(_0x46ca08){return'uuid-error';}}async[a0_0x421c3c(0x288)](){const _0x599a98=a0_0x421c3c;await this[_0x599a98(0x246)](),await this[_0x599a98(0x237)](_0x599a98(0x30c),{'type':_0x599a98(0x306),'common':{'name':'Last\x20raw\x20event','type':_0x599a98(0x2a1),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x599a98(0x237)]('events.history',{'type':_0x599a98(0x306),'common':{'name':'Event\x20History','type':'string','role':_0x599a98(0x2c5),'read':!![],'write':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x2b3),{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x28e),'type':_0x599a98(0x24b),'role':_0x599a98(0x1d5),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x30d),{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x2bc),'type':_0x599a98(0x24b),'role':_0x599a98(0x1d5),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x599a98(0x237)]('analysis.lastResult',{'type':_0x599a98(0x306),'common':{'name':'Last\x20Result','type':_0x599a98(0x2a1),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x22a),{'type':'state','common':{'name':_0x599a98(0x303),'type':'boolean','role':_0x599a98(0x2ba),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x2a5),{'type':_0x599a98(0x306),'common':{'name':'AI\x20Emergency\x20Status','type':_0x599a98(0x24b),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x293),{'type':'state','common':{'name':_0x599a98(0x202),'type':_0x599a98(0x2a1),'role':_0x599a98(0x28a),'read':!![],'write':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x16a),{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x2f5),'type':'string','role':_0x599a98(0x2fc),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x599a98(0x1b8),{'type':'state','common':{'name':_0x599a98(0x26b),'type':_0x599a98(0x2a1),'role':_0x599a98(0x306),'read':!![],'write':![],'def':_0x599a98(0x2e2)},'native':{}}),await this[_0x599a98(0x237)]('analysis.comfortSummary',{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x1b3),'type':_0x599a98(0x2a1),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x2b8),{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x2ce),'type':'string','role':_0x599a98(0x2fc),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](_0x599a98(0x255),{'type':_0x599a98(0x2c8),'common':{'name':'Automation\x20Proposals'},'native':{}}),await this[_0x599a98(0x237)]('analysis.automation.patternDetected',{'type':'state','common':{'name':'Pattern\x20Detected','type':_0x599a98(0x24b),'role':_0x599a98(0x305),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x21d),{'type':_0x599a98(0x306),'common':{'name':'Description','type':'string','role':_0x599a98(0x2fc),'read':!![],'write':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x1ba),{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x278),'type':'string','role':_0x599a98(0x2fc),'read':!![],'write':![]},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x28f),{'type':'state','common':{'name':_0x599a98(0x2ea),'type':_0x599a98(0x2a1),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x1fb),{'type':'state','common':{'name':_0x599a98(0x18f),'type':_0x599a98(0x2a1),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x599a98(0x1d9)](_0x599a98(0x200),{'type':_0x599a98(0x2c8),'common':{'name':_0x599a98(0x260)},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x25b),{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x22b),'type':_0x599a98(0x2bb),'role':_0x599a98(0x193),'read':!![],'write':![],'def':0x0},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x257),{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x1ed),'type':_0x599a98(0x2a1),'role':'text','read':!![],'write':![],'def':_0x599a98(0x192)},'native':{}}),await this[_0x599a98(0x237)](_0x599a98(0x2eb),{'type':_0x599a98(0x306),'common':{'name':_0x599a98(0x174),'type':_0x599a98(0x2a1),'role':_0x599a98(0x2fc),'read':!![],'write':![],'def':''},'native':{}}),await this[_0x599a98(0x259)](),await this[_0x599a98(0x297)]();}async[a0_0x421c3c(0x246)](){const _0x387625=a0_0x421c3c;await this['extendObjectAsync'](_0x387625(0x1e0),{'type':_0x387625(0x2c8),'common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await this[_0x387625(0x1d9)](SYSTEM_DP_MODE,{'type':_0x387625(0x306),'common':{'name':_0x387625(0x20d),'type':_0x387625(0x2a1),'role':_0x387625(0x306),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x387625(0x1a9)],'states':{[SYSTEM_MODES[_0x387625(0x1a9)]]:_0x387625(0x2d6),[SYSTEM_MODES['VACATION']]:_0x387625(0x26a),[SYSTEM_MODES[_0x387625(0x190)]]:'Party',[SYSTEM_MODES[_0x387625(0x23f)]]:_0x387625(0x1fc)}},'native':{}});}async[a0_0x421c3c(0x259)](){const _0x3d4389=a0_0x421c3c;await this['extendObjectAsync'](_0x3d4389(0x23b),{'type':_0x3d4389(0x2c8),'common':{'name':_0x3d4389(0x23b)},'native':{}}),await this[_0x3d4389(0x1d9)](LTM_DP_RAW_LOG,{'type':_0x3d4389(0x306),'common':{'name':'Raw\x20Log','type':'string','role':_0x3d4389(0x2c5),'read':!![],'write':![]},'native':{}}),await this[_0x3d4389(0x1d9)](LTM_DP_DAILY_DIGESTS,{'type':_0x3d4389(0x306),'common':{'name':_0x3d4389(0x27d),'type':_0x3d4389(0x2a1),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x3d4389(0x1d9)](LTM_DP_STATUS,{'type':_0x3d4389(0x306),'common':{'name':'Processing\x20Status','type':'string','role':_0x3d4389(0x2fc),'read':!![],'write':![]},'native':{}}),await this[_0x3d4389(0x1d9)](LTM_DP_TRIGGER_DIGEST,{'type':_0x3d4389(0x306),'common':{'name':_0x3d4389(0x2db),'type':_0x3d4389(0x24b),'role':_0x3d4389(0x1d5),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x3d4389(0x1d9)](LTM_DP_BASELINE_STATUS,{'type':_0x3d4389(0x306),'common':{'name':'Baseline\x20Status','type':_0x3d4389(0x2a1),'role':_0x3d4389(0x2fc),'read':!![],'write':![]},'native':{}});}async[a0_0x421c3c(0x297)](){const _0x186937=a0_0x421c3c;await this[_0x186937(0x1d9)](LTM_DP_DRIFT_CHANNEL,{'type':_0x186937(0x2c8),'common':{'name':_0x186937(0x1be)},'native':{}}),await this[_0x186937(0x1d9)](LTM_DP_DRIFT_STATUS,{'type':_0x186937(0x306),'common':{'name':'Drift\x20Status','type':_0x186937(0x2a1),'role':_0x186937(0x306),'read':!![],'write':![],'def':_0x186937(0x2e2)},'native':{}}),await this[_0x186937(0x1d9)](LTM_DP_DRIFT_DETAILS,{'type':_0x186937(0x306),'common':{'name':'Drift\x20Details','type':_0x186937(0x2a1),'role':_0x186937(0x2fc),'read':!![],'write':![]},'native':{}}),await this[_0x186937(0x1d9)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x186937(0x306),'common':{'name':_0x186937(0x22d),'type':_0x186937(0x2bb),'role':_0x186937(0x27f),'read':!![],'write':![]},'native':{}});}async[a0_0x421c3c(0x315)](){const _0x5395da=a0_0x421c3c;try{const _0x5e82b1=await this['getStateAsync'](SYSTEM_DP_MODE);_0x5e82b1&&_0x5e82b1['val']&&Object[_0x5395da(0x1c8)](SYSTEM_MODES)[_0x5395da(0x1d4)](_0x5e82b1[_0x5395da(0x233)])?this['currentSystemMode']=_0x5e82b1['val']:(this['currentSystemMode']=SYSTEM_MODES['NORMAL'],await this[_0x5395da(0x24a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x32929b){this[_0x5395da(0x271)]=SYSTEM_MODES[_0x5395da(0x1a9)];}}async[a0_0x421c3c(0x1fe)](){const _0x2f01f2=a0_0x421c3c;try{const _0xd22b0b=await this[_0x2f01f2(0x189)](LTM_DP_RAW_LOG);if(_0xd22b0b&&_0xd22b0b[_0x2f01f2(0x233)])this['rawEventLog']=JSON[_0x2f01f2(0x27c)](_0xd22b0b[_0x2f01f2(0x233)]);}catch(_0x3f5cda){this[_0x2f01f2(0x2b6)]=[];}}async['loadDailyDigests'](){const _0x1730c1=a0_0x421c3c;try{const _0x190e49=await this[_0x1730c1(0x189)](LTM_DP_DAILY_DIGESTS);if(_0x190e49&&_0x190e49['val'])this['dailyDigests']=JSON[_0x1730c1(0x27c)](_0x190e49[_0x1730c1(0x233)]);}catch(_0x4cca67){this[_0x1730c1(0x287)]=[];}await this[_0x1730c1(0x238)]();}async[a0_0x421c3c(0x2b5)](){const _0x1c7c8c=a0_0x421c3c;this[_0x1c7c8c(0x2b6)]['length']>RAW_LOG_MAX_SIZE&&this[_0x1c7c8c(0x2b6)][_0x1c7c8c(0x262)](0x0,this['rawEventLog'][_0x1c7c8c(0x2a3)]-RAW_LOG_MAX_SIZE),await this[_0x1c7c8c(0x24a)](LTM_DP_RAW_LOG,{'val':JSON[_0x1c7c8c(0x2e6)](this[_0x1c7c8c(0x2b6)]),'ack':!![]});}async['saveDailyDigests'](_0x4eac72=!![]){const _0x11c02c=a0_0x421c3c,_0x50b61a=this['config'][_0x11c02c(0x2e4)]||0x3c;this[_0x11c02c(0x287)][_0x11c02c(0x2a3)]>_0x50b61a&&this[_0x11c02c(0x287)][_0x11c02c(0x262)](0x0,this[_0x11c02c(0x287)][_0x11c02c(0x2a3)]-_0x50b61a);await this[_0x11c02c(0x24a)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x11c02c(0x2e6)](this[_0x11c02c(0x287)]),'ack':!![]});if(_0x4eac72)await this[_0x11c02c(0x238)]();}async['updateAnalysisHistory'](_0xd3c58d){const _0x2b30ef=a0_0x421c3c;this['analysisHistory'][_0x2b30ef(0x29b)](_0xd3c58d);if(this[_0x2b30ef(0x1b6)][_0x2b30ef(0x2a3)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x2b30ef(0x1b6)][_0x2b30ef(0x2c0)]();await this['setStateAsync'](_0x2b30ef(0x28f),{'val':JSON['stringify'](this[_0x2b30ef(0x1b6)]),'ack':!![]});}async[a0_0x421c3c(0x238)](){const _0x49a8a8=a0_0x421c3c;if(!this[_0x49a8a8(0x20e)]){await this[_0x49a8a8(0x24a)](LTM_DP_BASELINE_STATUS,{'val':_0x49a8a8(0x1f1),'ack':!![]});return;}const _0x44866b=this[_0x49a8a8(0x287)][_0x49a8a8(0x2a3)]>=(this[_0x49a8a8(0x2fb)][_0x49a8a8(0x294)]||0x7)?_0x49a8a8(0x172)+this['dailyDigests'][_0x49a8a8(0x2a3)]+'\x20Tage)':'Lernphase\x20('+this[_0x49a8a8(0x287)][_0x49a8a8(0x2a3)]+'/'+(this['config'][_0x49a8a8(0x294)]||0x7)+')';await this[_0x49a8a8(0x24a)](LTM_DP_BASELINE_STATUS,{'val':_0x44866b,'ack':!![]});}async[a0_0x421c3c(0x175)](){const _0x589afb=a0_0x421c3c,_0x11c716=this[_0x589afb(0x2fb)][_0x589afb(0x292)];if(_0x11c716&&_0x11c716['length']>0x0){this[_0x589afb(0x1c7)][_0x589afb(0x20b)](_0x589afb(0x19f)+_0x11c716[_0x589afb(0x2a3)]+_0x589afb(0x270));for(const _0x312b1a of _0x11c716){if(_0x312b1a['id']){await this['subscribeForeignStatesAsync'](_0x312b1a['id']);try{const _0x1406c3=await this[_0x589afb(0x26c)](_0x312b1a['id']);if(_0x1406c3)this[_0x589afb(0x17c)][_0x312b1a['id']]=_0x1406c3['val'];}catch(_0x511e03){}}}}}async[a0_0x421c3c(0x2ac)](){const _0x2f6b43=a0_0x421c3c,_0x4d2328=this[_0x2f6b43(0x2fb)][_0x2f6b43(0x18c)]||[];if(_0x4d2328[_0x2f6b43(0x2a3)]>0x0){this[_0x2f6b43(0x1c7)]['info'](_0x2f6b43(0x19f)+_0x4d2328['length']+_0x2f6b43(0x2b4));for(const _0x29052e of _0x4d2328){await this[_0x2f6b43(0x25a)](_0x29052e);}try{await this[_0x2f6b43(0x2b0)]();}catch(_0x3f0214){}}}async[a0_0x421c3c(0x1bc)](){const _0x18b17d=a0_0x421c3c;try{if(!this[_0x18b17d(0x2fb)][_0x18b17d(0x1ac)])return _0x18b17d(0x280);let _0x1e348c='';const _0x49d2f4=this['config']['weatherInstance'];if(_0x49d2f4)try{if(_0x49d2f4[_0x18b17d(0x1d4)](_0x18b17d(0x2cb))){const _0x506b0d=await this[_0x18b17d(0x26c)](_0x49d2f4+_0x18b17d(0x2a0));if(_0x506b0d&&_0x506b0d[_0x18b17d(0x233)])_0x1e348c=_0x506b0d['val'];}else{if(_0x49d2f4[_0x18b17d(0x1d4)]('daswetter')){const _0x1224c4=await this['getForeignStateAsync'](_0x49d2f4+_0x18b17d(0x268));if(_0x1224c4&&_0x1224c4[_0x18b17d(0x233)])_0x1e348c=_0x1224c4['val'];}else{if(_0x49d2f4[_0x18b17d(0x1d4)](_0x18b17d(0x1b1))){const _0x5492ed=await this['getForeignStateAsync'](_0x49d2f4+_0x18b17d(0x242));if(_0x5492ed&&_0x5492ed[_0x18b17d(0x233)])_0x1e348c=_0x5492ed[_0x18b17d(0x233)];}}}}catch(_0x1e12a8){}if(!_0x1e348c){const _0x5136dd=[_0x18b17d(0x209),_0x18b17d(0x2f6),_0x18b17d(0x295),_0x18b17d(0x2d0)];for(const _0x527683 of _0x5136dd){try{const _0x2f4218=await this[_0x18b17d(0x2a8)](_0x527683);if(_0x2f4218){if(_0x527683[_0x18b17d(0x1d4)](_0x18b17d(0x2cb))){const _0x2883f5=await this[_0x18b17d(0x26c)](_0x527683+_0x18b17d(0x2a0));if(_0x2883f5&&_0x2883f5[_0x18b17d(0x233)]){_0x1e348c=_0x2883f5['val'];break;}}}}catch(_0x3b3896){}}}return _0x1e348c?_0x18b17d(0x1b0)+_0x1e348c:_0x18b17d(0x19d);}catch(_0x5dba99){return _0x18b17d(0x19b)+_0x5dba99[_0x18b17d(0x2d1)];}}async[a0_0x421c3c(0x1b5)](){const _0x331968=a0_0x421c3c;try{if(!this[_0x331968(0x2fb)]['useCalendar'])return _0x331968(0x273);let _0xdf773c=this[_0x331968(0x2fb)][_0x331968(0x30e)]||_0x331968(0x182),_0x2a6c60=this[_0x331968(0x2fb)][_0x331968(0x2f4)]||[];if(typeof _0x2a6c60==='string')_0x2a6c60=_0x2a6c60['split'](',');try{const _0x488eb1=await this[_0x331968(0x26c)](_0xdf773c+_0x331968(0x24c));if(_0x488eb1&&_0x488eb1[_0x331968(0x233)]){let _0x5be84a=this[_0x331968(0x243)](_0x488eb1['val']);if(_0x5be84a&&Array[_0x331968(0x23d)](_0x5be84a)){if(_0x2a6c60[_0x331968(0x2a3)]>0x0)_0x5be84a=_0x5be84a[_0x331968(0x18e)](_0x1ee229=>_0x2a6c60[_0x331968(0x1d4)](_0x1ee229['_calName']||''));else return _0x331968(0x240);if(_0x5be84a[_0x331968(0x2a3)]>0x0){const _0x1abe1f=_0x5be84a[_0x331968(0x2e3)](0x0,0x3)[_0x331968(0x2e0)](_0x328554=>{const _0x77cc3e=_0x331968;let _0x47cecd=_0x328554[_0x77cc3e(0x27f)];if(_0x328554['time'])_0x47cecd+='\x20'+_0x328554[_0x77cc3e(0x24f)];return _0x47cecd+':\x20'+_0x328554[_0x77cc3e(0x19e)]+'\x20('+_0x328554[_0x77cc3e(0x18b)]+')';});return _0x331968(0x1b2)+_0x1abe1f[_0x331968(0x307)](_0x331968(0x17a));}else return _0x331968(0x223);}}}catch(_0x26c3e1){this[_0x331968(0x1c7)][_0x331968(0x1cd)]('Error\x20reading\x20calendar\x20table:\x20'+_0x26c3e1['message']);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x2b9ef9){return _0x331968(0x191)+_0x2b9ef9['message'];}}async['getCalendarNames'](_0x2dffcf){const _0x3a682b=a0_0x421c3c;try{const _0x48e57f=await this[_0x3a682b(0x26c)](_0x2dffcf+_0x3a682b(0x24c));if(_0x48e57f&&_0x48e57f[_0x3a682b(0x233)]){const _0x3d7a17=this['tryParse'](_0x48e57f['val']);if(_0x3d7a17&&Array['isArray'](_0x3d7a17)){const _0x1081dd=[...new Set(_0x3d7a17[_0x3a682b(0x2e0)](_0x3a753d=>_0x3a753d[_0x3a682b(0x18b)])['filter'](Boolean))];return _0x1081dd['sort']();}}return[];}catch(_0x17f155){return this[_0x3a682b(0x1c7)]['error'](_0x3a682b(0x2be)+_0x17f155[_0x3a682b(0x2d1)]),[];}}async[a0_0x421c3c(0x2b0)](){const _0x3ffac6=a0_0x421c3c;try{const _0x153af8=this[_0x3ffac6(0x2fb)][_0x3ffac6(0x18c)]||[];let _0x39a525=![];for(const _0x493739 of _0x153af8){try{const _0x4233d1=await this['getForeignStateAsync'](_0x493739);if(_0x4233d1&&(_0x4233d1[_0x3ffac6(0x233)]===!![]||_0x4233d1['val']===_0x3ffac6(0x1db)||_0x4233d1[_0x3ffac6(0x233)]===0x1)){_0x39a525=!![];break;}}catch(_0x1a9800){}}return _0x39a525&&(this[_0x3ffac6(0x1a7)]&&(this[_0x3ffac6(0x1c7)][_0x3ffac6(0x20b)]('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),this['abortExitTimer']()),!this[_0x3ffac6(0x241)]&&this[_0x3ffac6(0x271)]===SYSTEM_MODES['NORMAL']&&await this[_0x3ffac6(0x177)](!![])),_0x39a525;}catch(_0x23da19){return this['log'][_0x3ffac6(0x20c)](_0x3ffac6(0x28b)+_0x23da19[_0x3ffac6(0x2d1)]),![];}}[a0_0x421c3c(0x1da)](){const _0x25c5b0=a0_0x421c3c;this[_0x25c5b0(0x197)](),this[_0x25c5b0(0x2a2)]=!![],this[_0x25c5b0(0x2b7)]=setTimeout(()=>{this['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this['exitTimer']=setTimeout(()=>{const _0xb3ddae=_0x25c5b0;this[_0xb3ddae(0x177)](![]),this[_0xb3ddae(0x1a7)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x421c3c(0x197)](){const _0x3b3ed1=a0_0x421c3c;if(this[_0x3b3ed1(0x1a7)])clearTimeout(this[_0x3b3ed1(0x1a7)]);if(this[_0x3b3ed1(0x2b7)])clearTimeout(this['exitGraceTimer']);this[_0x3b3ed1(0x1a7)]=null,this[_0x3b3ed1(0x2b7)]=null,this[_0x3b3ed1(0x2a2)]=![];}async[a0_0x421c3c(0x177)](_0xb8c42f){const _0x2f5acd=a0_0x421c3c;if(this[_0x2f5acd(0x241)]===_0xb8c42f)return;this[_0x2f5acd(0x241)]=_0xb8c42f,await this['setStateAsync'](_0x2f5acd(0x20f),{'val':_0xb8c42f,'ack':!![]});}async[a0_0x421c3c(0x2a7)](_0x190bff){const _0x3200e5=a0_0x421c3c;this['log'][_0x3200e5(0x20b)]('Feedback\x20saved:\x20'+JSON[_0x3200e5(0x2e6)](_0x190bff));}async[a0_0x421c3c(0x231)](){const _0x4e5f4f=a0_0x421c3c;if(!this['isProVersion']||!this[_0x4e5f4f(0x314)])return;const _0x10cb58=this[_0x4e5f4f(0x2fb)][_0x4e5f4f(0x215)]||0xe;if(this['dailyDigests'][_0x4e5f4f(0x2a3)]<_0x10cb58+(this[_0x4e5f4f(0x2fb)][_0x4e5f4f(0x294)]||0x7)){await this[_0x4e5f4f(0x24a)](LTM_DP_DRIFT_STATUS,{'val':_0x4e5f4f(0x203),'ack':!![]});return;}const _0x23c9a3=this[_0x4e5f4f(0x287)]['slice'](-_0x10cb58),_0x4a9888=this[_0x4e5f4f(0x287)][_0x4e5f4f(0x2e3)](0x0,this['dailyDigests'][_0x4e5f4f(0x2a3)]-_0x10cb58),_0x10ed26=_0x4e5f4f(0x213)+JSON[_0x4e5f4f(0x2e6)](_0x4a9888)+_0x4e5f4f(0x317)+JSON[_0x4e5f4f(0x2e6)](_0x23c9a3);try{const _0x1d16bc=await this['geminiModel'][_0x4e5f4f(0x1ce)](_0x10ed26),_0x5509a2=JSON[_0x4e5f4f(0x27c)](_0x1d16bc['response'][_0x4e5f4f(0x2fc)]()['replace'](/```json|```/g,'')[_0x4e5f4f(0x1d2)]());_0x5509a2['baselineDrift']&&(await this[_0x4e5f4f(0x24a)](LTM_DP_DRIFT_STATUS,{'val':_0x5509a2[_0x4e5f4f(0x258)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x5509a2[_0x4e5f4f(0x1b7)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4e5f4f(0x1c2)](),'ack':!![]}));}catch(_0x38271c){}}[a0_0x421c3c(0x28c)](){const _0x280dcc=a0_0x421c3c;try{if(this[_0x280dcc(0x1f6)])this['ltmJob'][_0x280dcc(0x2f8)]();if(!this['isProVersion']){this['setStateAsync'](LTM_DP_STATUS,{'val':_0x280dcc(0x1f1),'ack':!![]});return;}this[_0x280dcc(0x1f6)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>this[_0x280dcc(0x2a9)]());}catch(_0x1084f2){this[_0x280dcc(0x1c7)][_0x280dcc(0x20c)](_0x280dcc(0x183)+_0x1084f2['message']);}}[a0_0x421c3c(0x21f)](){const _0x30a90c=a0_0x421c3c;try{if(this[_0x30a90c(0x2ed)])this[_0x30a90c(0x2ed)][_0x30a90c(0x2f8)]();this['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x28399e=_0x30a90c;await this[_0x28399e(0x315)](),AUTO_RESET_MODES['includes'](this[_0x28399e(0x271)])&&await this[_0x28399e(0x24a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x58c2d0){this[_0x30a90c(0x1c7)][_0x30a90c(0x20c)](_0x30a90c(0x24d)+_0x58c2d0[_0x30a90c(0x2d1)]);}}[a0_0x421c3c(0x253)](){const _0xe87946=a0_0x421c3c;try{if(this[_0xe87946(0x221)])clearInterval(this[_0xe87946(0x221)]);if(!this[_0xe87946(0x20e)])return;this[_0xe87946(0x221)]=setInterval(()=>this[_0xe87946(0x231)](),(this[_0xe87946(0x2fb)][_0xe87946(0x198)]||0x18)*0x36ee80),setTimeout(()=>this[_0xe87946(0x231)](),0x1388);}catch(_0x170ba4){this[_0xe87946(0x1c7)][_0xe87946(0x20c)](_0xe87946(0x26e)+_0x170ba4[_0xe87946(0x2d1)]);}}[a0_0x421c3c(0x310)](){const _0x18fc6b=a0_0x421c3c;try{if(this[_0x18fc6b(0x1aa)])this['briefingJob'][_0x18fc6b(0x2f8)]();if(!this[_0x18fc6b(0x2fb)]['briefingEnabled'])return;const _0x550e6c=(this[_0x18fc6b(0x2fb)]['briefingTime']||'08:00')['split'](':'),_0x3bc9dc=parseInt(_0x550e6c[0x0])||0x8,_0x1a3645=parseInt(_0x550e6c[0x1])||0x0,_0x137328=_0x1a3645+'\x20'+_0x3bc9dc+_0x18fc6b(0x2d4);this['log'][_0x18fc6b(0x20b)](_0x18fc6b(0x1e9)+_0x3bc9dc+':'+(_0x1a3645<0xa?'0'+_0x1a3645:_0x1a3645)),this[_0x18fc6b(0x1aa)]=schedule[_0x18fc6b(0x301)](_0x137328,()=>{const _0x3ffc46=_0x18fc6b;this[_0x3ffc46(0x16b)]();});}catch(_0x3c927e){this['log']['error'](_0x18fc6b(0x1df)+_0x3c927e[_0x18fc6b(0x2d1)]);}}async['sendNotification'](_0xc3eae9,_0x2e55d5=![],_0x127358=![]){const _0xc44dd9=a0_0x421c3c;this['log'][_0xc44dd9(0x20b)]((_0x2e55d5?_0xc44dd9(0x26f):'')+_0xc44dd9(0x2e8)+_0xc3eae9+'\x22');const _0xaea89a=this[_0xc44dd9(0x2fb)];let _0x25e576=0x0;_0xaea89a[_0xc44dd9(0x1c1)]&&(await this[_0xc44dd9(0x2d2)](_0xaea89a[_0xc44dd9(0x19c)],_0xc44dd9(0x2a6),{'text':_0xc3eae9,'user':_0xaea89a['notifyTelegramRecipient']}),_0x25e576++);if(_0xaea89a[_0xc44dd9(0x16f)]){let _0x4a38ad={'message':_0xc3eae9,'title':_0x127358?_0xc44dd9(0x21b):_0xc44dd9(0x1ff),'priority':_0x127358?0x2:0x1,'device':_0xaea89a[_0xc44dd9(0x1ec)]};_0x127358&&(_0x4a38ad[_0xc44dd9(0x1ca)]=0x1e,_0x4a38ad[_0xc44dd9(0x1de)]=0xe10,_0x4a38ad[_0xc44dd9(0x254)]='siren'),await this[_0xc44dd9(0x2d2)](_0xaea89a[_0xc44dd9(0x1e4)],_0xc44dd9(0x2a6),_0x4a38ad),_0x25e576++;}return _0xaea89a[_0xc44dd9(0x204)]&&(await this[_0xc44dd9(0x2d2)](_0xaea89a[_0xc44dd9(0x206)],_0xc44dd9(0x2a6),{'text':_0xc3eae9,'to':_0xaea89a[_0xc44dd9(0x201)]}),_0x25e576++),_0x25e576;}}function a0_0x5125(_0x131b13,_0x2b0e3e){const _0x381240=a0_0x366b();return a0_0x5125=function(_0x6ed578,_0xab4aaf){_0x6ed578=_0x6ed578-0x16a;let _0x366bd9=_0x381240[_0x6ed578];return _0x366bd9;},a0_0x5125(_0x131b13,_0x2b0e3e);}if(require[a0_0x421c3c(0x277)]!==module)module['exports']=_0x46b053=>new CogniLiving(_0x46b053);else new CogniLiving();