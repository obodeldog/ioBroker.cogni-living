const a0_0xdafc4b=a0_0x248c;(function(_0xc16fb8,_0x423401){const _0x443d6f=a0_0x248c,_0xd1b7bf=_0xc16fb8();while(!![]){try{const _0x1e0208=-parseInt(_0x443d6f(0x204))/0x1*(-parseInt(_0x443d6f(0x1f2))/0x2)+parseInt(_0x443d6f(0x21d))/0x3*(parseInt(_0x443d6f(0x320))/0x4)+-parseInt(_0x443d6f(0x1c7))/0x5+parseInt(_0x443d6f(0x2e1))/0x6*(parseInt(_0x443d6f(0x19a))/0x7)+parseInt(_0x443d6f(0x24f))/0x8*(-parseInt(_0x443d6f(0x2aa))/0x9)+parseInt(_0x443d6f(0x260))/0xa*(-parseInt(_0x443d6f(0x26d))/0xb)+parseInt(_0x443d6f(0x2a9))/0xc;if(_0x1e0208===_0x423401)break;else _0xd1b7bf['push'](_0xd1b7bf['shift']());}catch(_0x1600f6){_0xd1b7bf['push'](_0xd1b7bf['shift']());}}}(a0_0x5429,0x53782));const a0_0x262b68=(function(){let _0x162ca8=!![];return function(_0x198e4e,_0x420d33){const _0x4775e8=_0x162ca8?function(){if(_0x420d33){const _0x52a5f9=_0x420d33['apply'](_0x198e4e,arguments);return _0x420d33=null,_0x52a5f9;}}:function(){};return _0x162ca8=![],_0x4775e8;};}()),a0_0x5f3b22=a0_0x262b68(this,function(){const _0x17ef52=a0_0x248c;return a0_0x5f3b22[_0x17ef52(0x346)]()['search'](_0x17ef52(0x24e))[_0x17ef52(0x346)]()[_0x17ef52(0x19f)](a0_0x5f3b22)[_0x17ef52(0x1eb)](_0x17ef52(0x24e));});a0_0x5f3b22();'use strict';const utils=require(a0_0xdafc4b(0x334)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0xdafc4b(0x200)),{spawn,exec}=require(a0_0xdafc4b(0x1f4)),path=require(a0_0xdafc4b(0x1c1)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0xdafc4b(0x2c1),LTM_SCHEDULE=a0_0xdafc4b(0x323),MODE_RESET_SCHEDULE=a0_0xdafc4b(0x264),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0xdafc4b(0x2f4),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL=a0_0xdafc4b(0x24a),LTM_DP_DRIFT_STATUS=a0_0xdafc4b(0x319),LTM_DP_DRIFT_DETAILS=a0_0xdafc4b(0x22c),LTM_DP_DRIFT_LAST_CHECK=a0_0xdafc4b(0x253),SYSTEM_DP_MODE=a0_0xdafc4b(0x249),SYSTEM_MODES={'NORMAL':a0_0xdafc4b(0x26b),'VACATION':a0_0xdafc4b(0x1da),'PARTY':a0_0xdafc4b(0x28e),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0xdafc4b(0x263)],SYSTEM_MODES[a0_0xdafc4b(0x293)]],PERSONA_MAPPING={'generic':a0_0xdafc4b(0x1d2),'senior_aal':a0_0xdafc4b(0x1af),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0xdafc4b(0x238),'security':a0_0xdafc4b(0x2e6)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process['platform']==='win32',PERSISTENT_DIR=path['join'](__dirname,a0_0xdafc4b(0x2fa)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path[a0_0xdafc4b(0x1bf)](VENV_PATH,'Scripts',a0_0xdafc4b(0x292)):path['join'](VENV_PATH,a0_0xdafc4b(0x22d),a0_0xdafc4b(0x2e4)),PIP_EXE=IS_WIN?path[a0_0xdafc4b(0x1bf)](VENV_PATH,'Scripts','pip.exe'):path[a0_0xdafc4b(0x1bf)](VENV_PATH,a0_0xdafc4b(0x22d),a0_0xdafc4b(0x2d1));let activeSequence=[],sequenceTimer=null;async function startSystem(_0x1cb9b4){const _0x20ffc8=a0_0xdafc4b;_0x1cb9b4[_0x20ffc8(0x2bf)][_0x20ffc8(0x18f)]('üöÄ\x20Starting\x20NUUKANNI\x20Logic\x20(v0.11.0)...'),await initZombies(_0x1cb9b4);try{_0x1cb9b4[_0x20ffc8(0x23e)]=await checkLicense(_0x1cb9b4['config']['licenseKey']);}catch(_0x32f458){}if(!_0x1cb9b4[_0x20ffc8(0x338)][_0x20ffc8(0x1e9)]||_0x1cb9b4['config'][_0x20ffc8(0x1e9)]<0.1)_0x1cb9b4['config'][_0x20ffc8(0x1e9)]=0xc;await initHistory(_0x1cb9b4),await initSystemConfig(_0x1cb9b4);if(_0x1cb9b4['config'][_0x20ffc8(0x278)])try{_0x1cb9b4[_0x20ffc8(0x300)]=new GoogleGenerativeAI(_0x1cb9b4[_0x20ffc8(0x338)][_0x20ffc8(0x278)]),_0x1cb9b4[_0x20ffc8(0x226)]=_0x1cb9b4[_0x20ffc8(0x300)][_0x20ffc8(0x233)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x20ffc8(0x1f7)}}),_0x1cb9b4[_0x20ffc8(0x2bf)][_0x20ffc8(0x18f)](_0x20ffc8(0x1f6));}catch(_0x483672){_0x1cb9b4[_0x20ffc8(0x2bf)][_0x20ffc8(0x268)]('Gemini\x20Init\x20Error:\x20'+_0x483672['message']);}await createAllObjects(_0x1cb9b4),await loadSystemMode(_0x1cb9b4),await loadRawEventLog(_0x1cb9b4),await loadDailyDigests(_0x1cb9b4),_0x1cb9b4['subscribeStates'](_0x20ffc8(0x340)),_0x1cb9b4[_0x20ffc8(0x1a6)](LTM_DP_TRIGGER_DIGEST),_0x1cb9b4[_0x20ffc8(0x1a6)](_0x20ffc8(0x249)),_0x1cb9b4[_0x20ffc8(0x1a6)](_0x20ffc8(0x216)),_0x1cb9b4[_0x20ffc8(0x1a6)]('analysis.automation.triggerAction'),_0x1cb9b4[_0x20ffc8(0x1a6)]('analysis.automation.autoApply'),_0x1cb9b4[_0x20ffc8(0x1a6)]('analysis.training.triggerSecurity'),_0x1cb9b4[_0x20ffc8(0x1a6)](_0x20ffc8(0x21e)),_0x1cb9b4['subscribeStates'](_0x20ffc8(0x25a)),_0x1cb9b4[_0x20ffc8(0x1a6)](_0x20ffc8(0x197)),await initSensorSubscriptions(_0x1cb9b4),await initPresenceSubscriptions(_0x1cb9b4),await setupTelegramListener(_0x1cb9b4),setTimeout(()=>checkWifiPresence(_0x1cb9b4),0x1388);if(_0x1cb9b4['analysisTimer'])clearInterval(_0x1cb9b4[_0x20ffc8(0x1fd)]);const _0x2c7b6e=_0x1cb9b4[_0x20ffc8(0x338)][_0x20ffc8(0x1ba)]||0xf;_0x2c7b6e>0x0&&(_0x1cb9b4['analysisTimer']=setInterval(()=>{runAutopilot(_0x1cb9b4);},_0x2c7b6e*0x3c*0x3e8)),setupLtmScheduler(_0x1cb9b4),setupModeResetScheduler(_0x1cb9b4),setupDriftAnalysisScheduler(_0x1cb9b4),setupBriefingScheduler(_0x1cb9b4),startPythonService(_0x1cb9b4),setTimeout(()=>{const _0x2f5d1c=_0x20ffc8;_0x1cb9b4[_0x2f5d1c(0x1e6)]&&(runPythonHealthCheck(_0x1cb9b4),triggerGaitAnalysis(_0x1cb9b4),triggerEnergyPrediction(_0x1cb9b4)),updateHealthVector(_0x1cb9b4);},0x1388);}async function runAutopilot(_0x491927){const _0x8097f9=a0_0xdafc4b;_0x491927[_0x8097f9(0x2bf)][_0x8097f9(0x24c)](_0x8097f9(0x32c)),await runGeminiAnalysis(_0x491927),updateHealthVector(_0x491927),triggerGaitAnalysis(_0x491927),triggerEnergyPrediction(_0x491927);}async function triggerGaitAnalysis(_0x1531fa){const _0x1a87b7=a0_0xdafc4b;if(!_0x1531fa['isProVersion'])return;try{const _0x129933=await _0x1531fa[_0x1a87b7(0x198)]('LTM.trainingData.sequences');_0x129933&&_0x129933[_0x1a87b7(0x30d)]&&sendToPython(_0x1531fa,_0x1a87b7(0x1e0),{'sequences':JSON[_0x1a87b7(0x1a7)](_0x129933[_0x1a87b7(0x30d)])});}catch(_0x1fffdb){}}async function triggerEnergyPrediction(_0x452bc8){const _0x4abd3a=a0_0xdafc4b;if(!_0x452bc8[_0x4abd3a(0x23e)])return;try{const _0x23d759=await getOutsideTemperatureNumeric(_0x452bc8);if(_0x23d759===null)return;const _0x4be2ca={},_0x4ebbc2=_0x452bc8['config'][_0x4abd3a(0x276)]||[];for(const _0x2f0783 of _0x4ebbc2){if(_0x2f0783[_0x4abd3a(0x25c)]==='temperature'&&_0x2f0783['location']){const _0x826905=_0x452bc8[_0x4abd3a(0x31a)][_0x2f0783['id']];if(_0x826905!==undefined)_0x4be2ca[_0x2f0783[_0x4abd3a(0x195)]]=_0x826905;}}Object['keys'](_0x4be2ca)[_0x4abd3a(0x2c4)]>0x0&&sendToPython(_0x452bc8,'PREDICT_ENERGY',{'current_temps':_0x4be2ca,'t_out':_0x23d759});}catch(_0x2e8322){}}function updateHealthVector(_0x507aec){const _0x50bd0e=a0_0xdafc4b;if(!_0x507aec['rawEventLog']||_0x507aec[_0x50bd0e(0x192)][_0x50bd0e(0x2c4)]===0x0)return;const _0x42b085=new Array(0x60)[_0x50bd0e(0x21c)](0x0),_0x3fca4c=new Date()['setHours'](0x0,0x0,0x0,0x0);_0x507aec[_0x50bd0e(0x192)]['forEach'](_0x25af3b=>{const _0x113c29=_0x50bd0e,_0x48e972=new Date(_0x25af3b[_0x113c29(0x250)]);if(_0x48e972[_0x113c29(0x2a3)]()>=_0x3fca4c){const _0x5459bf=_0x48e972[_0x113c29(0x29c)](),_0xf36719=_0x48e972['getMinutes'](),_0x614027=_0x5459bf*0x4+Math['floor'](_0xf36719/0xf);if(_0x614027>=0x0&&_0x614027<0x60)_0x42b085[_0x614027]++;}}),_0x507aec[_0x50bd0e(0x1e4)](_0x50bd0e(0x1d1),{'val':JSON['stringify'](_0x42b085),'ack':!![]});}async function scanForDevices(_0x2fb15f,_0x156286){const _0x1e07df=a0_0xdafc4b;_0x2fb15f[_0x1e07df(0x2bf)][_0x1e07df(0x18f)](_0x1e07df(0x27c));const _0x314941=[],_0x500a7b=await _0x2fb15f[_0x1e07df(0x32a)]('*');for(const _0x5deb84 in _0x500a7b){const _0x4b82ab=_0x500a7b[_0x5deb84];if(_0x4b82ab&&_0x4b82ab[_0x1e07df(0x235)]&&_0x4b82ab[_0x1e07df(0x25c)]===_0x1e07df(0x1d4)){const _0x2ca093=(_0x4b82ab[_0x1e07df(0x235)][_0x1e07df(0x2e8)]&&typeof _0x4b82ab[_0x1e07df(0x235)][_0x1e07df(0x2e8)]===_0x1e07df(0x24b)?_0x4b82ab['common'][_0x1e07df(0x2e8)]['de']:_0x4b82ab[_0x1e07df(0x235)][_0x1e07df(0x2e8)])||'',_0x57a2a2=_0x4b82ab['common']['role']||'';let _0x30a67c=null;if(_0x156286[_0x1e07df(0x2f9)]&&(_0x57a2a2[_0x1e07df(0x23f)](_0x1e07df(0x2f9))||_0x2ca093[_0x1e07df(0x1ef)]()['includes']('bewegung')))_0x30a67c=_0x1e07df(0x2f9);else{if(_0x156286[_0x1e07df(0x1ca)]&&(_0x57a2a2['includes'](_0x1e07df(0x33c))||_0x57a2a2['includes'](_0x1e07df(0x191))||_0x2ca093[_0x1e07df(0x1ef)]()[_0x1e07df(0x23f)](_0x1e07df(0x2b4))||_0x2ca093['toLowerCase']()[_0x1e07df(0x23f)](_0x1e07df(0x25f))))_0x30a67c='door';else{if(_0x156286[_0x1e07df(0x257)]&&(_0x57a2a2[_0x1e07df(0x23f)](_0x1e07df(0x27f))||_0x57a2a2['includes'](_0x1e07df(0x2fe))||_0x2ca093[_0x1e07df(0x1ef)]()[_0x1e07df(0x23f)](_0x1e07df(0x240))))_0x30a67c=_0x1e07df(0x27f);else{if(_0x156286['temperature']&&(_0x57a2a2[_0x1e07df(0x23f)](_0x1e07df(0x22e))||_0x2ca093[_0x1e07df(0x1ef)]()[_0x1e07df(0x23f)](_0x1e07df(0x2df))))_0x30a67c=_0x1e07df(0x22e);}}}if(_0x30a67c){let _0x49c4b0='';const _0x17a695=_0x5deb84[_0x1e07df(0x1ac)]('.');if(_0x17a695[_0x1e07df(0x2c4)]>0x2)_0x49c4b0=_0x17a695[0x2];_0x314941[_0x1e07df(0x1b9)]({'id':_0x5deb84,'name':_0x2ca093||_0x5deb84,'type':_0x30a67c,'location':_0x49c4b0,'_score':0x32});}}}return _0x314941;}async function getWeatherContext(_0x35e21b){const _0x1fb8ff=a0_0xdafc4b;if(!_0x35e21b[_0x1fb8ff(0x338)][_0x1fb8ff(0x287)]||!_0x35e21b['config']['weatherInstance'])return _0x1fb8ff(0x2bc);try{const _0x45fd81=_0x35e21b['config'][_0x1fb8ff(0x2e2)];let _0x32e759=await _0x35e21b[_0x1fb8ff(0x337)](_0x45fd81+_0x1fb8ff(0x2eb));if(!_0x32e759)_0x32e759=await _0x35e21b['getForeignStateAsync'](_0x45fd81+'.forecast.current.temperature');let _0x54fca4=await _0x35e21b['getForeignStateAsync'](_0x45fd81+_0x1fb8ff(0x1a2));if(!_0x54fca4)_0x54fca4=await _0x35e21b[_0x1fb8ff(0x337)](_0x45fd81+'.forecast.current.state');if(_0x32e759&&_0x54fca4)return _0x32e759['val']+_0x1fb8ff(0x2ef)+_0x54fca4['val'];}catch(_0x269cbd){}return _0x1fb8ff(0x25b);}async function getCalendarContext(_0x2355be){const _0xaeeb93=a0_0xdafc4b;if(!_0x2355be['config'][_0xaeeb93(0x1e7)]||!_0x2355be[_0xaeeb93(0x338)][_0xaeeb93(0x207)])return _0xaeeb93(0x1d9);return'Keine\x20Termine.';}async function getCalendarNames(_0x5ddb45,_0x16f899){return[];}async function saveFeedback(_0x2726f7,_0x2cee06){const _0x4c19b3=a0_0xdafc4b;_0x2726f7[_0x4c19b3(0x2bf)]['info']('üìù\x20Feedback\x20received:\x20'+_0x2cee06[_0x4c19b3(0x303)]);}async function sendMorningBriefing(_0x90b3ce){const _0x10b605=a0_0xdafc4b;if(!_0x90b3ce[_0x10b605(0x226)])return;try{const _0x499bd4=_0x10b605(0x252),_0x350370=await _0x90b3ce[_0x10b605(0x226)][_0x10b605(0x345)](_0x499bd4),_0xc19ce9=_0x350370['response'][_0x10b605(0x1cf)]();sendNotification(_0x90b3ce,_0x10b605(0x1b1)+_0xc19ce9);}catch(_0x29c352){_0x90b3ce['log'][_0x10b605(0x268)]('Briefing\x20Error:\x20'+_0x29c352['message']);}}function checkAndInstall(_0x2553aa){const _0x35c523=a0_0xdafc4b;if(!fs['existsSync'](VENV_PATH)||!fs['existsSync'](PIP_EXE))return _0x2553aa[_0x35c523(0x2bf)][_0x35c523(0x213)](_0x35c523(0x230)),installPythonDependencies(_0x2553aa),![];return!![];}function installPythonDependencies(_0x45f171){const _0x5453c1=a0_0xdafc4b;if(_0x45f171[_0x5453c1(0x2c3)])return;_0x45f171[_0x5453c1(0x2c3)]=!![];const _0x300670=path['join'](__dirname,_0x5453c1(0x243),_0x5453c1(0x22b));stopPythonService(_0x45f171);if(fs[_0x5453c1(0x2d6)](VENV_PATH))try{fs[_0x5453c1(0x2f0)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x1cf5ed){}exec('python3\x20-m\x20venv\x20\x22'+VENV_PATH+'\x22',_0x27a9b5=>{const _0x25cde0=_0x5453c1;if(_0x27a9b5){_0x45f171[_0x25cde0(0x2bf)][_0x25cde0(0x268)](_0x25cde0(0x30a)+_0x27a9b5['message']),_0x45f171[_0x25cde0(0x2c3)]=![];return;}installRequirementsInVenv(_0x45f171,_0x300670);});}function installRequirementsInVenv(_0x28cac6,_0x102acf){const _0x4aa73b=a0_0xdafc4b;_0x28cac6[_0x4aa73b(0x2bf)]['info']('Installing\x20pip\x20packages...');const _0x3e29fd='\x22'+PIP_EXE+_0x4aa73b(0x1a4)+_0x102acf+'\x22';exec(_0x3e29fd,{'timeout':0x124f80},(_0x4e9bb1,_0x23820c,_0x4d91e2)=>{const _0x29bc16=_0x4aa73b;_0x28cac6[_0x29bc16(0x2c3)]=![],_0x4e9bb1?_0x28cac6['log']['error'](_0x29bc16(0x1b7)+(_0x4d91e2||_0x4e9bb1[_0x29bc16(0x2b6)])):(_0x28cac6[_0x29bc16(0x2bf)][_0x29bc16(0x18f)]('‚úÖ\x20INSTALL\x20SUCCESS.'),startSystem(_0x28cac6));});}async function initZombies(_0x1b1df7){const _0x1fd3da=a0_0xdafc4b;try{const _0x529571=[_0x1fd3da(0x1c3),_0x1fd3da(0x1ce)];for(const _0x3f80ba of _0x529571){try{const _0x5e59fd=await _0x1b1df7[_0x1fd3da(0x317)](_0x3f80ba);if(_0x5e59fd)await _0x1b1df7[_0x1fd3da(0x2d4)](_0x3f80ba);}catch(_0x22f20a){}}}catch(_0x5b0d0d){}}async function checkLicense(_0x2a11f7){return!![];}async function initHistory(_0x479153){const _0x5b5258=a0_0xdafc4b;try{const _0x1126c7=await _0x479153[_0x5b5258(0x198)](_0x5b5258(0x245));_0x1126c7&&_0x1126c7[_0x5b5258(0x30d)]&&(_0x479153[_0x5b5258(0x1e2)]=JSON[_0x5b5258(0x1a7)](_0x1126c7[_0x5b5258(0x30d)]['toString']()));}catch(_0x263ae6){_0x479153[_0x5b5258(0x1e2)]=[];}try{const _0x4de27d=await _0x479153[_0x5b5258(0x198)]('analysis.analysisHistory');if(_0x4de27d&&_0x4de27d[_0x5b5258(0x30d)])_0x479153[_0x5b5258(0x2a8)]=JSON[_0x5b5258(0x1a7)](_0x4de27d['val']['toString']());}catch(_0x3bb6a9){_0x479153[_0x5b5258(0x2a8)]=[];}if(_0x479153['eventHistory']&&_0x479153[_0x5b5258(0x1e2)][_0x5b5258(0x2c4)]>0x0){_0x479153[_0x5b5258(0x2bf)]['info'](_0x5b5258(0x1dd));for(let _0x2e96e9=_0x479153[_0x5b5258(0x1e2)][_0x5b5258(0x2c4)]-0x1;_0x2e96e9>=0x0;_0x2e96e9--){const _0x4f5ba0=_0x479153[_0x5b5258(0x1e2)][_0x2e96e9];if(_0x4f5ba0&&_0x4f5ba0['id']!==undefined&&_0x4f5ba0[_0x5b5258(0x332)]!==undefined)_0x479153['sensorLastValues'][_0x4f5ba0['id']]=_0x4f5ba0[_0x5b5258(0x332)];}}}async function initSystemConfig(_0x501a55){const _0x4f8add=a0_0xdafc4b;try{const _0x1d9bfe=await _0x501a55[_0x4f8add(0x26c)]('system.config');if(_0x1d9bfe&&_0x1d9bfe['common'])_0x501a55['systemConfig']={'latitude':_0x1d9bfe[_0x4f8add(0x235)][_0x4f8add(0x1a9)]||0x0,'longitude':_0x1d9bfe[_0x4f8add(0x235)][_0x4f8add(0x308)]||0x0,'city':_0x1d9bfe[_0x4f8add(0x235)]['city']||''};}catch(_0x353087){}}async function createAllObjects(_0x1cbdee){const _0x3f2403=a0_0xdafc4b;await _0x1cbdee[_0x3f2403(0x2a1)](_0x3f2403(0x270),{'type':'channel','common':{'name':_0x3f2403(0x2c8)},'native':{}}),await _0x1cbdee[_0x3f2403(0x2a1)](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x3f2403(0x218),'type':_0x3f2403(0x21a),'role':_0x3f2403(0x1d4),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x3f2403(0x256)]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x20f),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x1a1),'type':_0x3f2403(0x21a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x239),{'type':_0x3f2403(0x1d4),'common':{'name':'Last\x20raw\x20event','type':_0x3f2403(0x21a),'role':'json','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)]('events.history',{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x236),'type':'string','role':_0x3f2403(0x284),'read':!![],'write':![]},'native':{}}),await _0x1cbdee['extendObjectAsync'](_0x3f2403(0x2b0),{'type':'channel','common':{'name':_0x3f2403(0x2af)},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x255),{'type':_0x3f2403(0x1d4),'common':{'name':'Train\x20Security','type':_0x3f2403(0x190),'role':_0x3f2403(0x1f5),'read':!![],'write':!![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x21e),{'type':'state','common':{'name':'Train\x20Health','type':_0x3f2403(0x190),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x25a),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2b5),'type':_0x3f2403(0x190),'role':_0x3f2403(0x1f5),'read':!![],'write':!![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x197),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2e3),'type':_0x3f2403(0x190),'role':_0x3f2403(0x1f5),'read':!![],'write':!![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)]('analysis.training.status',{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x19e),'type':_0x3f2403(0x21a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x2a1)](_0x3f2403(0x2cf),{'type':_0x3f2403(0x1c0),'common':{'name':_0x3f2403(0x2bd)},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x2f1),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x254),'type':_0x3f2403(0x306),'role':_0x3f2403(0x332),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x229),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2d8),'type':_0x3f2403(0x306),'role':_0x3f2403(0x332),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x1b8),{'type':'state','common':{'name':_0x3f2403(0x2a0),'type':'string','role':'date','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x2a1)](_0x3f2403(0x343),{'type':_0x3f2403(0x1c0),'common':{'name':_0x3f2403(0x1aa)},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync']('analysis.health.lastCheck',{'type':'state','common':{'name':_0x3f2403(0x2a0),'type':_0x3f2403(0x21a),'role':_0x3f2403(0x33f),'read':!![],'write':![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync']('analysis.health.isAnomaly',{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2d3),'type':_0x3f2403(0x190),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x30c),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x326),'type':_0x3f2403(0x21a),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x2d2),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2f8),'type':_0x3f2403(0x306),'role':_0x3f2403(0x332),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x1d1),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2dd),'type':_0x3f2403(0x21a),'role':_0x3f2403(0x284),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x2c5),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x1fa),'type':_0x3f2403(0x306),'role':_0x3f2403(0x332),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x2a1)](_0x3f2403(0x2c2),{'type':_0x3f2403(0x1c0),'common':{'name':_0x3f2403(0x274)},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x31d),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x28b),'type':'string','role':_0x3f2403(0x1cf),'read':!![],'write':![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x318),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x286),'type':_0x3f2403(0x21a),'role':_0x3f2403(0x1cf),'read':!![],'write':![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x1e3),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x258),'type':'string','role':_0x3f2403(0x284),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x2a1)](_0x3f2403(0x31f),{'type':'channel','common':{'name':_0x3f2403(0x31f)},'native':{}}),await _0x1cbdee[_0x3f2403(0x2a1)](LTM_DP_RAW_LOG,{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x27a),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x2a1)](LTM_DP_DAILY_DIGESTS,{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x28a),'type':_0x3f2403(0x21a),'role':_0x3f2403(0x284),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x344),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2be),'type':_0x3f2403(0x21a),'role':_0x3f2403(0x284),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x1ab),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x232),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x340),{'type':'state','common':{'name':'Trigger\x20Analysis','type':_0x3f2403(0x190),'role':_0x3f2403(0x1f5),'read':!![],'write':!![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)]('analysis.triggerBriefing',{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x1db),'type':_0x3f2403(0x190),'role':_0x3f2403(0x1f5),'read':!![],'write':!![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x20e),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2bb),'type':_0x3f2403(0x190),'role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x2a2),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x221),'type':'string','role':_0x3f2403(0x313),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)]('analysis.activitySummary',{'type':_0x3f2403(0x1d4),'common':{'name':'Activity\x20Summary','type':_0x3f2403(0x21a),'role':_0x3f2403(0x1cf),'read':!![],'write':![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync'](_0x3f2403(0x280),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x2e0),'type':_0x3f2403(0x190),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x242),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x266),'type':_0x3f2403(0x21a),'role':_0x3f2403(0x1cf),'read':!![],'write':![]},'native':{}}),await _0x1cbdee['setObjectNotExistsAsync']('analysis.automation.detectedPatterns',{'type':'state','common':{'name':_0x3f2403(0x18e),'type':_0x3f2403(0x21a),'role':_0x3f2403(0x284),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)]('analysis.automation.targetId',{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x283),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x1b4),{'type':_0x3f2403(0x1d4),'common':{'name':'Target\x20Value','type':_0x3f2403(0x21a),'role':_0x3f2403(0x1cf),'read':!![],'write':![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x2ae),{'type':'state','common':{'name':_0x3f2403(0x298),'type':'boolean','role':_0x3f2403(0x2fe),'read':!![],'write':!![]},'native':{}}),await _0x1cbdee[_0x3f2403(0x224)](_0x3f2403(0x31c),{'type':_0x3f2403(0x1d4),'common':{'name':_0x3f2403(0x1d3),'type':_0x3f2403(0x190),'role':'button','read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0xde3518){const _0x131a4b=a0_0xdafc4b;try{const _0x1ce196=await _0xde3518[_0x131a4b(0x198)](SYSTEM_DP_MODE);_0x1ce196&&_0x1ce196[_0x131a4b(0x30d)]&&Object[_0x131a4b(0x259)](SYSTEM_MODES)[_0x131a4b(0x23f)](_0x1ce196[_0x131a4b(0x30d)])?_0xde3518[_0x131a4b(0x1ff)]=_0x1ce196[_0x131a4b(0x30d)]:(_0xde3518[_0x131a4b(0x1ff)]=SYSTEM_MODES[_0x131a4b(0x256)],await _0xde3518[_0x131a4b(0x1e4)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x5388f4){_0xde3518[_0x131a4b(0x1ff)]=SYSTEM_MODES[_0x131a4b(0x256)];}}async function loadRawEventLog(_0x4ceb80){const _0x2de43b=a0_0xdafc4b;try{const _0x462775=await _0x4ceb80[_0x2de43b(0x198)](LTM_DP_RAW_LOG);if(_0x462775&&_0x462775['val'])_0x4ceb80['rawEventLog']=JSON[_0x2de43b(0x1a7)](_0x462775[_0x2de43b(0x30d)]);}catch(_0x160c1a){_0x4ceb80[_0x2de43b(0x192)]=[];}}async function saveRawEventLog(_0x284efd){const _0x183f60=a0_0xdafc4b;if(_0x284efd[_0x183f60(0x192)][_0x183f60(0x2c4)]>RAW_LOG_MAX_SIZE)_0x284efd[_0x183f60(0x192)][_0x183f60(0x2ed)](0x0,_0x284efd[_0x183f60(0x192)][_0x183f60(0x2c4)]-RAW_LOG_MAX_SIZE);await _0x284efd[_0x183f60(0x1e4)](LTM_DP_RAW_LOG,{'val':JSON[_0x183f60(0x201)](_0x284efd[_0x183f60(0x192)]),'ack':!![]});}async function loadDailyDigests(_0x13d4db){const _0x58ed9e=a0_0xdafc4b;try{const _0x2b82a7=await _0x13d4db[_0x58ed9e(0x198)](LTM_DP_DAILY_DIGESTS);if(_0x2b82a7&&_0x2b82a7['val'])_0x13d4db[_0x58ed9e(0x302)]=JSON[_0x58ed9e(0x1a7)](_0x2b82a7['val']);}catch(_0x286e79){_0x13d4db['dailyDigests']=[];}await updateBaselineStatus(_0x13d4db);}async function saveDailyDigests(_0xe3df67,_0x1e1946=!![]){const _0x545c30=a0_0xdafc4b,_0x3877c3=_0xe3df67[_0x545c30(0x338)][_0x545c30(0x2a7)]||0x3c;_0xe3df67['dailyDigests'][_0x545c30(0x2c4)]>_0x3877c3&&_0xe3df67[_0x545c30(0x302)][_0x545c30(0x2ed)](0x0,_0xe3df67[_0x545c30(0x302)][_0x545c30(0x2c4)]-_0x3877c3);await _0xe3df67[_0x545c30(0x1e4)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x545c30(0x201)](_0xe3df67[_0x545c30(0x302)]),'ack':!![]});if(_0x1e1946)await updateBaselineStatus(_0xe3df67);}async function updateAnalysisHistory(_0x59cdb7,_0x58204d){const _0x2c06dc=a0_0xdafc4b;_0x59cdb7['analysisHistory'][_0x2c06dc(0x2d7)](_0x58204d);if(_0x59cdb7[_0x2c06dc(0x2a8)][_0x2c06dc(0x2c4)]>HISTORY_MAX_SIZE)_0x59cdb7['analysisHistory'][_0x2c06dc(0x32e)]();await _0x59cdb7['setStateAsync'](_0x2c06dc(0x267),{'val':JSON[_0x2c06dc(0x201)](_0x59cdb7[_0x2c06dc(0x2a8)]),'ack':!![]});}async function updateBaselineStatus(_0x4ff8fe){const _0x2d1144=a0_0xdafc4b;if(!_0x4ff8fe[_0x2d1144(0x23e)]){await _0x4ff8fe[_0x2d1144(0x1e4)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x4c7cba=_0x4ff8fe['dailyDigests'][_0x2d1144(0x2c4)]>=(_0x4ff8fe['config']['minDaysForBaseline']||0x7)?_0x2d1144(0x314)+_0x4ff8fe[_0x2d1144(0x302)][_0x2d1144(0x2c4)]+_0x2d1144(0x2ee):'Lernphase\x20('+_0x4ff8fe['dailyDigests'][_0x2d1144(0x2c4)]+'/'+(_0x4ff8fe[_0x2d1144(0x338)]['minDaysForBaseline']||0x7)+')';await _0x4ff8fe['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x4c7cba,'ack':!![]});}async function initSensorSubscriptions(_0x5e85e5){const _0x7c6ff9=a0_0xdafc4b,_0x449833=_0x5e85e5[_0x7c6ff9(0x338)]['devices'];if(_0x449833)for(const _0x53eff6 of _0x449833){await _0x5e85e5[_0x7c6ff9(0x29b)](_0x53eff6['id']);}}async function initPresenceSubscriptions(_0xa81d32){const _0x2709af=a0_0xdafc4b,_0x28420d=_0xa81d32[_0x2709af(0x338)]['presenceDevices'];if(_0x28420d)for(const _0x39fa0a of _0x28420d){await _0xa81d32[_0x2709af(0x29b)](_0x39fa0a);}}async function setupTelegramListener(_0x4c17e9){const _0x5bb579=a0_0xdafc4b,_0x391451=_0x4c17e9[_0x5bb579(0x338)][_0x5bb579(0x18b)];if(_0x4c17e9[_0x5bb579(0x338)][_0x5bb579(0x1dc)]&&_0x391451)await _0x4c17e9[_0x5bb579(0x29b)](_0x391451+_0x5bb579(0x21b));}async function checkWifiPresence(_0x51ab5b){const _0x3e937e=a0_0xdafc4b;try{const _0x4a5b92=_0x51ab5b[_0x3e937e(0x338)]['presenceDevices']||[];let _0x4a6c16=![];const _0x248b21=[];for(const _0x2a91ba of _0x4a5b92){try{const _0x1ca515=await _0x51ab5b[_0x3e937e(0x337)](_0x2a91ba);_0x1ca515&&(_0x1ca515[_0x3e937e(0x30d)]===!![]||_0x1ca515[_0x3e937e(0x30d)]===_0x3e937e(0x2ec)||_0x1ca515[_0x3e937e(0x30d)]===0x1)&&(_0x4a6c16=!![],_0x248b21['push'](_0x2a91ba));}catch(_0x133c9d){}}return await _0x51ab5b['setStateAsync'](_0x3e937e(0x20f),{'val':_0x248b21[_0x3e937e(0x1bf)](',\x20'),'ack':!![]}),_0x4a6c16&&(_0x51ab5b[_0x3e937e(0x27d)]&&(_0x51ab5b[_0x3e937e(0x2bf)][_0x3e937e(0x18f)](_0x3e937e(0x33a)),abortExitTimer(_0x51ab5b)),!_0x51ab5b[_0x3e937e(0x26f)]&&_0x51ab5b['currentSystemMode']===SYSTEM_MODES[_0x3e937e(0x256)]&&await setPresence(_0x51ab5b,!![])),_0x4a6c16;}catch(_0x527b5f){return![];}}function startExitTimer(_0x128f48){const _0x1e4e85=a0_0xdafc4b;abortExitTimer(_0x128f48),_0x128f48['isGracePeriodActive']=!![],_0x128f48[_0x1e4e85(0x26e)]=setTimeout(()=>{_0x128f48['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x128f48[_0x1e4e85(0x27d)]=setTimeout(()=>{const _0x25828a=_0x1e4e85;setPresence(_0x128f48,![]),_0x128f48[_0x25828a(0x27d)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x55763b){const _0x11e6a6=a0_0xdafc4b;if(_0x55763b[_0x11e6a6(0x27d)])clearTimeout(_0x55763b[_0x11e6a6(0x27d)]);if(_0x55763b['exitGraceTimer'])clearTimeout(_0x55763b[_0x11e6a6(0x26e)]);_0x55763b['exitTimer']=null,_0x55763b[_0x11e6a6(0x26e)]=null,_0x55763b['isGracePeriodActive']=![];}async function setPresence(_0x289af7,_0x5e1493){const _0x310b80=a0_0xdafc4b;if(_0x289af7[_0x310b80(0x26f)]===_0x5e1493)return;_0x289af7[_0x310b80(0x26f)]=_0x5e1493,await _0x289af7[_0x310b80(0x1e4)](_0x310b80(0x24d),{'val':_0x5e1493,'ack':!![]});}async function executeAutomationAction(_0x282d79){const _0x25bfa0=a0_0xdafc4b;try{const _0x16b758=await _0x282d79[_0x25bfa0(0x198)](_0x25bfa0(0x2c7)),_0x3b35a5=await _0x282d79[_0x25bfa0(0x198)]('analysis.automation.targetValue');if(_0x16b758&&_0x16b758['val']&&_0x3b35a5){const _0x103803=_0x16b758['val'];let _0x27120e=_0x3b35a5[_0x25bfa0(0x30d)];try{_0x27120e=JSON['parse'](_0x27120e);}catch(_0x203a03){}_0x282d79['log'][_0x25bfa0(0x18f)](_0x25bfa0(0x277)+_0x103803+_0x25bfa0(0x1b3)+_0x27120e),await _0x282d79[_0x25bfa0(0x199)](_0x103803,_0x27120e);}else _0x282d79['log'][_0x25bfa0(0x213)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x5369a4){_0x282d79['log']['error'](_0x25bfa0(0x20b)+_0x5369a4['message']);}}async function processSensorEvent(_0x22042b,_0x415d92,_0x18c1a9,_0x5ee7b3){const _0x28d0f2=a0_0xdafc4b;if(!_0x5ee7b3)return;const _0x179a29=_0x18c1a9[_0x28d0f2(0x30d)],_0x51c6b6=Date[_0x28d0f2(0x341)](),_0x4a37c0=_0x22042b[_0x28d0f2(0x31a)][_0x415d92];_0x22042b['sensorLastValues'][_0x415d92]=_0x179a29;if(!_0x5ee7b3['logDuplicates']&&_0x4a37c0!=undefined&&_0x4a37c0==_0x179a29)return;const _0xa8b621=(_0x5ee7b3[_0x28d0f2(0x25c)]||'')[_0x28d0f2(0x1ef)](),_0x1f8f4e=_0xa8b621['includes'](_0x28d0f2(0x22e))||_0xa8b621[_0x28d0f2(0x23f)]('temperatur')||_0xa8b621[_0x28d0f2(0x23f)](_0x28d0f2(0x210))||_0xa8b621['includes'](_0x28d0f2(0x1d8));_0x22042b[_0x28d0f2(0x23e)]&&_0x1f8f4e&&recordThermodynamics(_0x22042b,_0x415d92,_0x179a29,_0x5ee7b3[_0x28d0f2(0x195)]);const _0x54478b={'timestamp':_0x51c6b6,'id':_0x415d92,'name':_0x5ee7b3[_0x28d0f2(0x2e8)],'type':_0x5ee7b3[_0x28d0f2(0x25c)],'location':_0x5ee7b3[_0x28d0f2(0x195)],'value':_0x179a29};_0x22042b[_0x28d0f2(0x1e2)]['unshift'](_0x54478b);if(_0x22042b[_0x28d0f2(0x1e2)]['length']>HISTORY_MAX_SIZE)_0x22042b[_0x28d0f2(0x1e2)]['pop']();await _0x22042b[_0x28d0f2(0x1e4)](_0x28d0f2(0x239),{'val':JSON[_0x28d0f2(0x201)](_0x54478b),'ack':!![]}),await _0x22042b[_0x28d0f2(0x1e4)](_0x28d0f2(0x245),{'val':JSON[_0x28d0f2(0x201)](_0x22042b[_0x28d0f2(0x1e2)]),'ack':!![]});_0x22042b['isProVersion']&&(_0x22042b[_0x28d0f2(0x192)]['push'](_0x54478b),await saveRawEventLog(_0x22042b),recordSequence(_0x22042b,_0x54478b));if(_0x5ee7b3[_0x28d0f2(0x32f)]&&_0x179a29===!![]){if(_0x22042b[_0x28d0f2(0x26f)]&&!_0x22042b['isGracePeriodActive'])startExitTimer(_0x22042b);else{if(!_0x22042b[_0x28d0f2(0x26f)])setPresence(_0x22042b,!![]);}}else{if(_0x5ee7b3[_0x28d0f2(0x25c)]===_0x28d0f2(0x2f9)&&_0x179a29===!![]){if(_0x22042b[_0x28d0f2(0x27d)])abortExitTimer(_0x22042b);if(!_0x22042b['isPresent']&&_0x22042b[_0x28d0f2(0x1ff)]===SYSTEM_MODES[_0x28d0f2(0x256)])setPresence(_0x22042b,!![]);}}}async function recordThermodynamics(_0x42781a,_0x454878,_0x5d1981,_0x5f0dc3){const _0x404b0a=a0_0xdafc4b,_0x663e69=await getOutsideTemperatureNumeric(_0x42781a),_0x4e2243=await _0x42781a[_0x404b0a(0x198)]('LTM.trainingData.thermodynamics');let _0x4842d6=[];if(_0x4e2243&&_0x4e2243[_0x404b0a(0x30d)])try{_0x4842d6=JSON[_0x404b0a(0x1a7)](_0x4e2243[_0x404b0a(0x30d)]);}catch(_0x1ff74e){}_0x4842d6[_0x404b0a(0x1b9)]({'ts':Date[_0x404b0a(0x341)](),'room':_0x5f0dc3||_0x404b0a(0x234),'t_in':_0x5d1981,'t_out':_0x663e69});if(_0x4842d6['length']>THERMO_LOG_SIZE)_0x4842d6[_0x404b0a(0x2de)]();await _0x42781a[_0x404b0a(0x1e4)](_0x404b0a(0x1ab),{'val':JSON['stringify'](_0x4842d6),'ack':!![]});}function a0_0x248c(_0x201430,_0x1c7a65){const _0x469312=a0_0x5429();return a0_0x248c=function(_0x5f3b22,_0x262b68){_0x5f3b22=_0x5f3b22-0x188;let _0x5429b1=_0x469312[_0x5f3b22];return _0x5429b1;},a0_0x248c(_0x201430,_0x1c7a65);}async function getOutsideTemperatureNumeric(_0x10a4b7){const _0x47895d=a0_0xdafc4b;if(_0x10a4b7[_0x47895d(0x338)][_0x47895d(0x1c8)])try{const _0x485257=await _0x10a4b7[_0x47895d(0x337)](_0x10a4b7[_0x47895d(0x338)][_0x47895d(0x1c8)]);if(_0x485257&&_0x485257[_0x47895d(0x30d)]!==undefined&&_0x485257[_0x47895d(0x30d)]!==null)return parseFloat(_0x485257[_0x47895d(0x30d)]);}catch(_0x1bebc7){}const _0x1dd5bd=_0x10a4b7[_0x47895d(0x338)]['weatherInstance'];if(!_0x10a4b7[_0x47895d(0x338)][_0x47895d(0x287)]||!_0x1dd5bd)return null;try{let _0x43cca0='';if(_0x1dd5bd['includes'](_0x47895d(0x25e)))_0x43cca0=_0x1dd5bd+_0x47895d(0x2eb);else{if(_0x1dd5bd[_0x47895d(0x23f)](_0x47895d(0x225)))_0x43cca0=_0x1dd5bd+_0x47895d(0x1bc);else{if(_0x1dd5bd['includes'](_0x47895d(0x330)))_0x43cca0=_0x1dd5bd+_0x47895d(0x1e1);else{if(_0x1dd5bd[_0x47895d(0x23f)](_0x47895d(0x2b1)))_0x43cca0=_0x1dd5bd+_0x47895d(0x30e);}}}if(_0x43cca0){const _0x3a0256=await _0x10a4b7[_0x47895d(0x337)](_0x43cca0);if(_0x3a0256&&_0x3a0256[_0x47895d(0x30d)]!==undefined&&_0x3a0256[_0x47895d(0x30d)]!==null)return parseFloat(_0x3a0256[_0x47895d(0x30d)]);}}catch(_0x2abd03){}return null;}async function recordSequence(_0x3eb3b6,_0x41ca0c){const _0x59ffaa=a0_0xdafc4b,_0x3bf45e=(_0x41ca0c[_0x59ffaa(0x25c)]||'')[_0x59ffaa(0x1ef)](),_0x24e705=[_0x59ffaa(0x2f9),'bewegung',_0x59ffaa(0x247),_0x59ffaa(0x22f),_0x59ffaa(0x217),_0x59ffaa(0x33c),_0x59ffaa(0x2b4),_0x59ffaa(0x191),_0x59ffaa(0x25f),_0x59ffaa(0x2b3),_0x59ffaa(0x27e),_0x59ffaa(0x27f),_0x59ffaa(0x240),'switch',_0x59ffaa(0x231),'dimmer',_0x59ffaa(0x299)];if(!_0x24e705['some'](_0x399988=>_0x3bf45e[_0x59ffaa(0x23f)](_0x399988)))return;if(!_0x41ca0c[_0x59ffaa(0x332)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x59ffaa(0x1b9)]({'loc':_0x41ca0c[_0x59ffaa(0x195)]||'Unknown','id':_0x41ca0c['id'],'ts':Date[_0x59ffaa(0x341)]()}),sequenceTimer=setTimeout(async()=>{const _0x4928f8=_0x59ffaa;if(activeSequence[_0x4928f8(0x2c4)]>0x1)await saveCompletedSequence(_0x3eb3b6);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x4cdde7){const _0x34ad18=a0_0xdafc4b;try{const _0x515567=await _0x4cdde7['getStateAsync'](_0x34ad18(0x344));let _0x43af58=[];if(_0x515567&&_0x515567[_0x34ad18(0x30d)])try{_0x43af58=JSON['parse'](_0x515567[_0x34ad18(0x30d)]);}catch(_0x3c5f64){}const _0x466015=activeSequence[0x0]['ts'],_0x231cf4=activeSequence['map'](_0x3f5a09=>({'loc':_0x3f5a09[_0x34ad18(0x1e8)],'t_delta':Math[_0x34ad18(0x1d7)]((_0x3f5a09['ts']-_0x466015)/0x3e8)})),_0x287dd2={'timestamp':new Date(_0x466015)[_0x34ad18(0x2ba)](),'steps':_0x231cf4,'duration':Math['round']((activeSequence[activeSequence['length']-0x1]['ts']-_0x466015)/0x3e8),'daytime':new Date(_0x466015)[_0x34ad18(0x29c)]()};_0x43af58['push'](_0x287dd2);if(_0x43af58['length']>MAX_TRAINING_SET_SIZE)_0x43af58[_0x34ad18(0x2de)]();await _0x4cdde7[_0x34ad18(0x1e4)](_0x34ad18(0x344),{'val':JSON[_0x34ad18(0x201)](_0x43af58),'ack':!![]}),runSecurityCheck(_0x4cdde7,_0x287dd2);}catch(_0x4442d4){_0x4cdde7[_0x34ad18(0x2bf)]['error'](_0x34ad18(0x1b2)+_0x4442d4[_0x34ad18(0x2b6)]);}}function a0_0x5429(){const _0x1d34c2=['analysis.energy.heatingScore','LTM.driftAnalysis.baselineDrift','sensorLastValues','Activity-Level','analysis.automation.triggerAction','analysis.energy.insulationScore','notifyEmailRecipient','LTM','344QazWzA','COMFORT_RESULT','testContext','0\x203\x20*\x20*\x20*','close','enum.functions.*','Trend','substring','sendTo','TRAIN_HEALTH','getForeignObjectsAsync','.\x20KONTEXT:\x20','ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...','Drift\x20Sched\x20Error:\x20','pop','isExit','openweathermap','Skipped\x20(No\x20AI\x20or\x20Data)','value','VACATION','@iobroker/adapter-core','from','ENERGY_PREDICT_RESULT','getForeignStateAsync','config','systemUUID','WiFi\x20Presence\x20detected.','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','door','onUnload','stdin','date','analysis.trigger','now','details','analysis.health','LTM.trainingData.sequences','generateContent','toString','instance','isGracePeriodActive','Training\x20Error:\x20','notifyTelegramInstance','threshold','Vom\x20Benutzer\x20best√§tigt\x20(OK).','Detected\x20Patterns','info','boolean','window','rawEventLog','change_percent','analysis.health.lastCheck','location','stdout','analysis.training.triggerComfort','getStateAsync','setForeignStateAsync','182caCYVH','‚úÖ\x20Alles\x20OK\x20(Reset)','üõãÔ∏è\x20BUTLER:\x20Found\x20','modeResetJob','Training\x20Status','constructor','analysis.activitySummary','Who\x20is\x20present?','.Current.WeatherText','bind','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','Cogni-Living','subscribeStates','parse','replace','latitude','Health\x20Analysis','LTM.trainingData.thermodynamics','split','onReady','enum','PRIORIT√ÑT:\x20Gesundheit/AAL.','Sec-Training\x20started...','üåÖ\x20Morning\x20Briefing:\x0a','[RECORDER]\x20Error:\x20','\x20=\x20','analysis.automation.targetValue','minDaysForBaseline','apiKey','‚ùå\x20INSTALL\x20FAILED:\x20','analysis.security.lastCheck','push','analysisInterval','status','.NextHours.Location_1.Day_1.current.temp_value','briefingTime','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','join','channel','path','triggerBriefing','analysis.history_debug_00','detected','generic','getDate','2824985SzWNfn','outdoorSensorId','OK:\x20','doors','success','‚úÖ\x20HEALTH\x20TRAINED.','cancel','events.history_debug_00','text','activityLevel','analysis.health.todayVector','Analysiere\x20ausgewogen.','Trigger\x20Action','state','onMessage','service.py','round','heizung','Kalender\x20deaktiviert.','vacation','Trigger\x20Briefing','notifyTelegramEnabled','Restoring\x20sensor\x20cache...','notifyPushoverRecipient','writable','ANALYZE_GAIT','.forecast.current.temperature','eventHistory','analysis.energy.forecast','setStateAsync','N/A','pythonProcess','useCalendar','loc','inactivityThresholdHours','send','search','sound','\x0aSTB:\x20','notifyPushoverEnabled','toLowerCase','\x20*\x20*\x20*','TRAIN_ENERGY','8WDIVnk','stateChange','child_process','button','Gemini\x20AI\x20initialized.','application/json','Missing\x20data','is_anomaly','Gait\x20Speed\x20Trend','toLocaleTimeString','description','analysisTimer','getOverviewData','currentSystemMode','node-schedule','stringify','forEach','Alarm','29443ChtwRb','Adapter','ltmStbWindowDays','calendarInstance','indexOf','Keine\x20Details.','SECURITY_RESULT','BUTLER\x20Execution\x20Error:\x20',')\x20-\x20SAFE\x20BOOT','scheduleJob','analysis.isAlert','system.presenceWho','klima','getFullYear','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','warn','baselineDrift','targetId','analysis.triggerBriefing','occupancy','System\x20Mode','[RESULT]','string','.communicate.request','fill','963wTUPfd','analysis.training.triggerHealth','briefingEnabled','startsWith','Alert\x20Reason','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','rule','setObjectNotExistsAsync','daswetter','geminiModel','setState','unload','analysis.security.currentThreshold','systemConfig','requirements.txt','LTM.driftAnalysis.driftDetails','bin','temperature','presence','‚ö†Ô∏è\x20Python\x20VENV\x20missing.\x20Installing\x20locally...','schalter','Thermodynamics','getGenerativeModel','Unknown','common','Event\x20History','python3','Fokus\x20auf\x20Komfort.','events.lastEvent','lastAlertState','Success:\x20','livingContext','TREND_RESULT','isProVersion','includes','licht','TRAIN_SECURITY','analysis.automation.description','python_service','response','events.history','TRAINING_COMPLETE','pr√§senz','üö®\x20EMERGENCY','system.mode','LTM.driftAnalysis','object','debug','system.isPresent','(((.+)+)+)+$','653736ACYaXW','timestamp','notifyPushoverInstance','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','LTM.driftAnalysis.lastCheck','Anomaly\x20Score','analysis.training.triggerSecurity','NORMAL','lights','Temperature\x20Forecast','values','analysis.training.triggerEnergy','Keine\x20Wetterdaten\x20verf√ºgbar.','type','testApiKey','accuweather','fenster','15620ugZrfS','Regel\x20erkannt:\x20','Kein\x20API\x20Key.','PARTY','0\x204\x20*\x20*\x20*','HEALTH_RESULT','Description','analysis.analysisHistory','error','summary','expire','normal','getForeignObjectAsync','1705mqTNzV','exitGraceTimer','isPresent','system','HEALTH_TRAIN_RESULT','exports','[LOG]','Energy\x20Intelligence','ANALYZE_TREND','devices','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','geminiApiKey','diagnosis','Raw\x20Log','onStateChange','üîç\x20Scanning\x20for\x20devices...','exitTimer','kontakt','light','analysis.automation.patternDetected','ltmJob','ack','Target\x20ID','json','Error\x20launching\x20Python:\x20','Heating\x20Score','useWeather','COGNI_CONFIRM_OK','\x0aGrund:\x20','Daily\x20Digests','Insulation\x20Score','map','version','party','endsWith','alertReason','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','python.exe','GUEST','submitFeedback','08:00','triggerDailyDigest','getLtmData','Auto\x20Apply','lampe','getCalendarNames','subscribeForeignStatesAsync','getHours','filter','find','reason','Last\x20Check','extendObjectAsync','analysis.alertReason','getTime','üêç\x20Python\x20Pong','telegram','scanDevices','ltmLtbWindowDays','analysisHistory','12122040JrTysN','9eZtZaG','Success','.\x20WETTER:\x20','siren','analysis.automation.autoApply','AI\x20Training','analysis.training','weatherunderground','heating','contact','t√ºr','Train\x20Energy','message','analysis.health.isAnomaly','command','‚ö†Ô∏è\x20ALARM:\x20','toISOString','Alert\x20Status','Wetterdaten\x20deaktiviert.','Security\x20Monitor','Sequences','log','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','models/gemini-flash-latest','analysis.energy','dependencyInstallInProgress','length','analysis.health.gaitSpeed','cogni-living\x20adapter\x20starting\x20(v','analysis.automation.targetId','System','üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','trim','callback','payload','analysis.lastResult','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','analysis.security','Started...','pip','analysis.health.trendValue','Anomaly\x20Detected','delObjectAsync','\x20->\x20','existsSync','unshift','Current\x20Threshold','üß†\x20Triggering\x20Security\x20Training...','.\x20ANWESEND:\x20','notifyEmailInstance','toFixed','Today\x20Vector\x20(15m)','shift','temperatur','Pattern\x20Detected','17346LTrsnK','weatherInstance','Train\x20Comfort','python','ANOMALY','PRIORIT√ÑT:\x20Sicherheit.','driftAnalysisTimer','name','Err:\x20','Digest','.Current.Temperature','online','splice','\x20Tage)','¬∞C,\x20','rmSync','analysis.security.lastScore','data','insulation','LTM.triggerDailyDigest','sendToAsync','ready','simulateButler','Trend\x20Value','motion','.venv','aiPersona','GAIT_RESULT','automationProposal','switch','.\x20SYSTEM_MODE:\x20','genAI','notifyTelegramRecipient','dailyDigests','rating','.\x20EVENTS:\x20','User\x20dismissed\x20automation\x20proposal.','number','LTM\x20Sched\x20Error:\x20','longitude','analysis.automation.detectedPatterns','‚ùå\x20VENV\x20FAILED:\x20','Kein\x20API\x20Key!','analysis.health.trendDiagnosis','val','.forecast.current.temp','TRAIN_COMFORT','N/A\x20(Learning)','driftDetails','briefingJob','text.alarm','Aktiv\x20(','presenceDevices','slice','getObjectAsync'];a0_0x5429=function(){return _0x1d34c2;};return a0_0x5429();}function runSecurityCheck(_0x3d6370,_0x2581b0){const _0x3559b0=a0_0xdafc4b;if(!_0x3d6370[_0x3559b0(0x23e)])return;sendToPython(_0x3d6370,'ANALYZE_SEQUENCE',{'sequence':_0x2581b0});}function sendToPython(_0x112c58,_0x4f8fb8,_0xebe648={}){const _0x227afe=a0_0xdafc4b;if(!_0x112c58[_0x227afe(0x1e6)]||!_0x112c58[_0x227afe(0x1e6)][_0x227afe(0x33e)][_0x227afe(0x1df)])return;const _0x300eaa=JSON['stringify']({'command':_0x4f8fb8,..._0xebe648});try{_0x112c58['pythonProcess']['stdin']['write'](_0x300eaa+'\x0a');}catch(_0x58e979){}}function startPythonService(_0x497335){const _0x9ac0d0=a0_0xdafc4b;let _0x3efaf7=_0x9ac0d0(0x237);if(fs[_0x9ac0d0(0x2d6)](PYTHON_EXE))_0x3efaf7=PYTHON_EXE;try{const _0x2386c6=path['join'](__dirname,'python_service',_0x9ac0d0(0x1d6));_0x497335['pythonProcess']=spawn(_0x3efaf7,[_0x2386c6]),_0x497335[_0x9ac0d0(0x1e6)][_0x9ac0d0(0x196)]['on'](_0x9ac0d0(0x2f2),_0x2d63d1=>{const _0x345802=_0x9ac0d0,_0x5e4905=_0x2d63d1['toString']()[_0x345802(0x1ac)]('\x0a');_0x5e4905[_0x345802(0x202)](_0x56a63c=>{const _0x535d60=_0x345802,_0x2810d7=_0x56a63c[_0x535d60(0x2ca)]();if(!_0x2810d7)return;if(_0x2810d7['startsWith'](_0x535d60(0x273)))_0x497335['log']['debug']('[PYTHON]\x20'+_0x2810d7[_0x535d60(0x327)](0x5)[_0x535d60(0x2ca)]());else{if(_0x2810d7[_0x535d60(0x220)](_0x535d60(0x219)))try{const _0xcf367b=JSON[_0x535d60(0x1a7)](_0x2810d7[_0x535d60(0x327)](0x8)[_0x535d60(0x2ca)]());handlePythonResult(_0x497335,_0xcf367b);}catch(_0x17a244){}}});}),_0x497335[_0x9ac0d0(0x1e6)]['on'](_0x9ac0d0(0x324),_0x19f470=>{const _0x48619c=_0x9ac0d0;_0x497335[_0x48619c(0x1e6)]=null;});}catch(_0x425441){_0x497335[_0x9ac0d0(0x2bf)][_0x9ac0d0(0x268)](_0x9ac0d0(0x285)+_0x425441[_0x9ac0d0(0x2b6)]);}}function stopPythonService(_0x2220d7){const _0x2edac4=a0_0xdafc4b;if(_0x2220d7[_0x2edac4(0x1e6)]){try{_0x2220d7[_0x2edac4(0x1e6)]['kill']();}catch(_0x4d09d5){}_0x2220d7[_0x2edac4(0x1e6)]=null;}}function handlePythonResult(_0x57e1f3,_0x3c9bef){const _0x118add=a0_0xdafc4b;if(_0x3c9bef['type']==='PONG')_0x57e1f3[_0x118add(0x2bf)][_0x118add(0x24c)](_0x118add(0x2a4));else{if(_0x3c9bef[_0x118add(0x25c)]===_0x118add(0x20a)){const {anomaly_score:_0x2c9f53,is_anomaly:_0x824646,threshold:_0x358f9a,explanation:_0x5c25a4}=_0x3c9bef[_0x118add(0x2cc)];_0x57e1f3['log']['info'](_0x118add(0x222)+_0x2c9f53[_0x118add(0x2dc)](0x5)+_0x118add(0x2d5)+(_0x824646?_0x118add(0x2e5):'OK')),_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x2f1),{'val':_0x2c9f53,'ack':!![]}),_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x1b8),{'val':new Date()[_0x118add(0x2ba)](),'ack':!![]});if(_0x358f9a)_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x229),{'val':_0x358f9a,'ack':!![]});if(_0x824646){let _0x5741d7=_0x118add(0x2ce)+_0x2c9f53[_0x118add(0x2dc)](0x4)+')';if(_0x5c25a4&&_0x5c25a4!=='Unknown')_0x5741d7+=_0x118add(0x289)+_0x5c25a4;_0x57e1f3[_0x118add(0x1e4)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x2a2),{'val':_0x5741d7,'ack':!![]}),sendNotification(_0x57e1f3,_0x118add(0x2c0)+_0x5741d7,![],!![]);}}else{if(_0x3c9bef['type']===_0x118add(0x246)){const _0x10b800=_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x342)]||'',_0x24eef5=_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x18c)],_0xf10223=_0x3c9bef['payload'][_0x118add(0x1cb)]?_0x118add(0x23b)+new Date()[_0x118add(0x1fb)]()+'\x20('+_0x10b800+')':'Failed:\x20'+_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x29f)];_0x57e1f3['setStateAsync']('analysis.training.status',{'val':_0xf10223,'ack':!![]});if(_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x1cb)]&&_0x24eef5)_0x57e1f3['setStateAsync'](_0x118add(0x229),{'val':_0x24eef5,'ack':!![]});}else{if(_0x3c9bef['type']===_0x118add(0x321)){const {patterns:_0x3551ec}=_0x3c9bef[_0x118add(0x2cc)];if(_0x3551ec&&_0x3551ec[_0x118add(0x2c4)]>0x0){_0x57e1f3[_0x118add(0x2bf)]['info'](_0x118add(0x19c)+_0x3551ec['length']+'\x20new\x20patterns.'),_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x309),{'val':JSON[_0x118add(0x201)](_0x3551ec),'ack':!![]});const _0x1fdf8c=_0x3551ec[0x0],_0x55862a=_0x118add(0x261)+_0x1fdf8c[_0x118add(0x223)]+'\x20('+(_0x1fdf8c['confidence']*0x64)[_0x118add(0x2dc)](0x0)+'%)';_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x280),{'val':!![],'ack':!![]}),_0x57e1f3['setStateAsync'](_0x118add(0x242),{'val':_0x55862a,'ack':!![]});}else _0x57e1f3[_0x118add(0x2bf)][_0x118add(0x18f)]('üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x57e1f3['setStateAsync']('analysis.automation.patternDetected',{'val':![],'ack':!![]}),_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x309),{'val':'[]','ack':!![]});}else{if(_0x3c9bef['type']==='ENERGY_TRAIN_RESULT'){if(_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x1cb)])try{const _0x4f2af8=JSON[_0x118add(0x1a7)](_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x342)]);if(_0x4f2af8['insulation'])_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x31d),{'val':JSON[_0x118add(0x201)](_0x4f2af8[_0x118add(0x2f3)]),'ack':!![]});if(_0x4f2af8[_0x118add(0x2b2)])_0x57e1f3['setStateAsync'](_0x118add(0x318),{'val':JSON['stringify'](_0x4f2af8[_0x118add(0x2b2)]),'ack':!![]});}catch(_0x345869){}}else{if(_0x3c9bef[_0x118add(0x25c)]===_0x118add(0x271)){if(_0x3c9bef['payload']['success'])_0x57e1f3[_0x118add(0x2bf)][_0x118add(0x18f)](_0x118add(0x1cc));}else{if(_0x3c9bef['type']===_0x118add(0x265))_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x194),{'val':new Date()[_0x118add(0x2ba)](),'ack':!![]}),_0x57e1f3['setStateAsync'](_0x118add(0x2b7),{'val':_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x1f9)],'ack':!![]});else{if(_0x3c9bef[_0x118add(0x25c)]===_0x118add(0x23d))_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x30c),{'val':_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x279)],'ack':!![]}),_0x57e1f3[_0x118add(0x1e4)]('analysis.health.trendValue',{'val':_0x3c9bef[_0x118add(0x2cc)][_0x118add(0x193)],'ack':!![]});else{if(_0x3c9bef[_0x118add(0x25c)]===_0x118add(0x2fc)){const {speed_trend:_0x33a5ac}=_0x3c9bef[_0x118add(0x2cc)];_0x33a5ac!==undefined&&_0x57e1f3[_0x118add(0x1e4)](_0x118add(0x2c5),{'val':_0x33a5ac,'ack':!![]});}else{if(_0x3c9bef[_0x118add(0x25c)]===_0x118add(0x336)){const {forecast:_0x56b3cc}=_0x3c9bef[_0x118add(0x2cc)];_0x56b3cc&&_0x57e1f3['setStateAsync'](_0x118add(0x1e3),{'val':JSON[_0x118add(0x201)](_0x56b3cc),'ack':!![]});}}}}}}}}}}}function runPythonHealthCheck(_0x12c08a){const _0x443f3e=a0_0xdafc4b;if(!_0x12c08a[_0x443f3e(0x302)]||_0x12c08a['dailyDigests'][_0x443f3e(0x2c4)]<0x2)return;const _0x4eee8a=_0x12c08a[_0x443f3e(0x302)][_0x443f3e(0x28c)](_0xc10291=>{const _0x3dc452=_0x443f3e,_0x3b368f=(_0xc10291[_0x3dc452(0x1d0)]||'')[_0x3dc452(0x1ef)]();return ACTIVITY_LEVEL_MAP[_0x3b368f]||0x32;});sendToPython(_0x12c08a,_0x443f3e(0x275),{'values':_0x4eee8a,'tag':_0x443f3e(0x31b)});}async function handleTelegramResponse(_0x4c8f2a,_0x1181e8){const _0x414832=a0_0xdafc4b;let _0xaadab1=_0x1181e8;_0x1181e8[_0x414832(0x220)]('[')&&(_0xaadab1=_0x1181e8[_0x414832(0x327)](_0x1181e8[_0x414832(0x208)](']')+0x1));if(_0xaadab1===_0x414832(0x288))await _0x4c8f2a[_0x414832(0x1e4)](_0x414832(0x20e),{'val':![],'ack':!![]}),await _0x4c8f2a[_0x414832(0x1e4)]('analysis.alertReason',{'val':_0x414832(0x18d),'ack':!![]}),_0x4c8f2a['lastAlertState']=![],sendNotification(_0x4c8f2a,_0x414832(0x291),![]);else _0xaadab1==='COGNI_REQUEST_CALL'&&sendNotification(_0x4c8f2a,_0x414832(0x33b),![],!![]);}async function sendNotification(_0x43d070,_0xe6afa2,_0x5c756e=![],_0x5a04e2=![]){const _0x430c4b=a0_0xdafc4b,_0x45ccaa=_0x43d070[_0x430c4b(0x338)];if(_0x45ccaa[_0x430c4b(0x1dc)]){let _0x19152d={};(_0xe6afa2[_0x430c4b(0x23f)](_0x430c4b(0x203))||_0x5a04e2)&&(_0x19152d={'reply_markup':{'inline_keyboard':[[{'text':_0x430c4b(0x19b),'callback_data':_0x430c4b(0x288)}],[{'text':'üìû\x20R√ºckruf\x20anfordern','callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0x43d070[_0x430c4b(0x2f5)](_0x45ccaa['notifyTelegramInstance'],_0x430c4b(0x1ea),{'text':_0xe6afa2,'user':_0x45ccaa[_0x430c4b(0x301)],..._0x19152d});}if(_0x45ccaa[_0x430c4b(0x1ee)]){let _0x3c8fcc={'message':_0xe6afa2,'title':_0x5a04e2?_0x430c4b(0x248):_0x430c4b(0x1a5),'priority':_0x5a04e2?0x2:0x1,'device':_0x45ccaa[_0x430c4b(0x1de)]};_0x5a04e2&&(_0x3c8fcc['retry']=0x1e,_0x3c8fcc[_0x430c4b(0x26a)]=0xe10,_0x3c8fcc[_0x430c4b(0x1ec)]=_0x430c4b(0x2ad)),await _0x43d070['sendToAsync'](_0x45ccaa[_0x430c4b(0x251)],_0x430c4b(0x1ea),_0x3c8fcc);}_0x45ccaa['notifyEmailEnabled']&&await _0x43d070[_0x430c4b(0x2f5)](_0x45ccaa[_0x430c4b(0x2db)],_0x430c4b(0x1ea),{'text':_0xe6afa2,'to':_0x45ccaa[_0x430c4b(0x31e)]});}async function runGeminiAnalysis(_0x2f165f,_0x18a204=''){const _0x2c8474=a0_0xdafc4b;if(!_0x2f165f[_0x2c8474(0x226)])return;if(_0x2f165f[_0x2c8474(0x1e2)][_0x2c8474(0x2c4)]===0x0)return;const _0x1f56a1=_0x2f165f[_0x2c8474(0x1e2)][_0x2c8474(0x316)](0x0,0xf),_0x224f7c=await getWeatherContext(_0x2f165f),_0x16c0f6=_0x2f165f['currentSystemMode'],_0xd0d235=PERSONA_MAPPING[_0x2f165f[_0x2c8474(0x338)][_0x2c8474(0x2fb)]||_0x2c8474(0x1c5)],_0x38b0d3=_0x2f165f[_0x2c8474(0x338)][_0x2c8474(0x23c)]||_0x2c8474(0x209);let _0x1062b2='Unbekannt';try{const _0x5a53ed=await _0x2f165f[_0x2c8474(0x198)](_0x2c8474(0x20f));if(_0x5a53ed&&_0x5a53ed[_0x2c8474(0x30d)])_0x1062b2=_0x5a53ed[_0x2c8474(0x30d)];}catch(_0x49a46c){}let _0x1df525=![];try{const _0x43c953=await _0x2f165f[_0x2c8474(0x198)](_0x2c8474(0x2ae));if(_0x43c953&&_0x43c953[_0x2c8474(0x30d)])_0x1df525=!![];}catch(_0x2c12be){}const _0x24ac56='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0xd0d235+_0x2c8474(0x32b)+_0x38b0d3+_0x2c8474(0x2ff)+_0x16c0f6+_0x2c8474(0x2ac)+_0x224f7c+_0x2c8474(0x2da)+_0x1062b2+_0x2c8474(0x304)+JSON[_0x2c8474(0x201)](_0x1f56a1)+'.\x20EMERGENCY:\x20'+_0x18a204+_0x2c8474(0x212);try{const _0x214306=await _0x2f165f['geminiModel']['generateContent'](_0x24ac56),_0x1fd2f7=JSON[_0x2c8474(0x1a7)](_0x214306[_0x2c8474(0x244)]['text']()[_0x2c8474(0x1a8)](/```json|```/g,'')[_0x2c8474(0x2ca)]());await _0x2f165f[_0x2c8474(0x1e4)](_0x2c8474(0x2cd),{'val':JSON[_0x2c8474(0x201)](_0x1fd2f7),'ack':!![]});if(_0x1fd2f7[_0x2c8474(0x269)])await _0x2f165f[_0x2c8474(0x1e4)](_0x2c8474(0x1a0),{'val':_0x1fd2f7[_0x2c8474(0x269)],'ack':!![]});const _0xe193b={'timestamp':Date[_0x2c8474(0x341)](),'id':Date['now']()[_0x2c8474(0x346)](),'analysis':{'activity':{'summary':_0x1fd2f7[_0x2c8474(0x269)],'isAlert':_0x1fd2f7['isAlert'],'alertReason':_0x1fd2f7[_0x2c8474(0x290)]},'comfort':{'automationProposal':_0x1fd2f7[_0x2c8474(0x2fd)]}}};await updateAnalysisHistory(_0x2f165f,_0xe193b);const _0x22c16d=_0x1fd2f7['isAlert']||![];_0x22c16d!==_0x2f165f[_0x2c8474(0x23a)]&&(await _0x2f165f[_0x2c8474(0x1e4)](_0x2c8474(0x20e),{'val':_0x22c16d,'ack':!![]}),_0x2f165f[_0x2c8474(0x23a)]=_0x22c16d,_0x22c16d&&(await _0x2f165f[_0x2c8474(0x1e4)](_0x2c8474(0x2a2),{'val':_0x1fd2f7[_0x2c8474(0x290)],'ack':!![]}),sendNotification(_0x2f165f,_0x2c8474(0x2b9)+_0x1fd2f7['alertReason'],![],_0x1fd2f7['isEmergency'])));if(_0x1fd2f7['automationProposal']&&_0x1fd2f7['automationProposal'][_0x2c8474(0x1c4)]){await _0x2f165f[_0x2c8474(0x1e4)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await _0x2f165f[_0x2c8474(0x1e4)](_0x2c8474(0x242),{'val':_0x1fd2f7[_0x2c8474(0x2fd)][_0x2c8474(0x1fc)],'ack':!![]}),await _0x2f165f[_0x2c8474(0x1e4)](_0x2c8474(0x2c7),{'val':_0x1fd2f7['automationProposal'][_0x2c8474(0x215)],'ack':!![]}),await _0x2f165f[_0x2c8474(0x1e4)](_0x2c8474(0x1b4),{'val':JSON['stringify'](_0x1fd2f7[_0x2c8474(0x2fd)]['targetValue']),'ack':!![]});if(_0x1df525)executeAutomationAction(_0x2f165f);}}catch(_0x4cdc13){_0x2f165f[_0x2c8474(0x2bf)]['error']('Gemini\x20Error:\x20'+_0x4cdc13['message']);}}async function createDailyDigest(_0x52ab73){const _0x298c2d=a0_0xdafc4b;if(!_0x52ab73[_0x298c2d(0x23e)])return;await _0x52ab73['setStateAsync'](LTM_DP_STATUS,{'val':_0x298c2d(0x2d0),'ack':!![]});if(!_0x52ab73[_0x298c2d(0x226)]||_0x52ab73[_0x298c2d(0x192)][_0x298c2d(0x2c4)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x52ab73[_0x298c2d(0x1e4)](LTM_DP_STATUS,{'val':_0x298c2d(0x331),'ack':!![]});return;}const _0x3654e6=JSON[_0x298c2d(0x1a7)](JSON[_0x298c2d(0x201)](_0x52ab73[_0x298c2d(0x192)])),_0x6acdde=_0x3654e6[_0x298c2d(0x2c4)],_0x282823='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0x298c2d(0x201)](_0x3654e6);try{const _0x42ee05=await _0x52ab73[_0x298c2d(0x226)][_0x298c2d(0x345)](_0x282823),_0x4b6a88=JSON[_0x298c2d(0x1a7)](_0x42ee05[_0x298c2d(0x244)][_0x298c2d(0x1cf)]()[_0x298c2d(0x1a8)](/```json|```/g,'')[_0x298c2d(0x2ca)]()),_0x49b4a9={'timestamp':new Date()['toISOString'](),'eventCount':_0x6acdde,'summary':_0x4b6a88[_0x298c2d(0x269)]||_0x298c2d(0x2ea),'activityLevel':_0x4b6a88[_0x298c2d(0x1d0)]||_0x298c2d(0x26b),'systemMode':_0x52ab73['currentSystemMode']};_0x52ab73[_0x298c2d(0x302)]['push'](_0x49b4a9),await saveDailyDigests(_0x52ab73),_0x52ab73[_0x298c2d(0x192)]=[],await saveRawEventLog(_0x52ab73),await _0x52ab73[_0x298c2d(0x1e4)](LTM_DP_STATUS,{'val':_0x298c2d(0x2ab),'ack':!![]});if(_0x52ab73[_0x298c2d(0x23e)])sendToPython(_0x52ab73,'ANALYZE_HEALTH',{'digest':_0x49b4a9});}catch(_0x30d5d0){_0x52ab73[_0x298c2d(0x2bf)][_0x298c2d(0x268)](_0x30d5d0['message']);}}function setupLtmScheduler(_0x1ced12){const _0x27dbad=a0_0xdafc4b;try{if(_0x1ced12[_0x27dbad(0x281)])_0x1ced12[_0x27dbad(0x281)][_0x27dbad(0x1cd)]();if(!_0x1ced12['isProVersion'])return;_0x1ced12[_0x27dbad(0x281)]=schedule[_0x27dbad(0x20d)](LTM_SCHEDULE,()=>createDailyDigest(_0x1ced12));}catch(_0xd0133){_0x1ced12['log'][_0x27dbad(0x268)](_0x27dbad(0x307)+_0xd0133['message']);}}function setupModeResetScheduler(_0x29c689){const _0xfa59e6=a0_0xdafc4b;try{if(_0x29c689['modeResetJob'])_0x29c689[_0xfa59e6(0x19d)][_0xfa59e6(0x1cd)]();_0x29c689[_0xfa59e6(0x19d)]=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x341a36=_0xfa59e6;await loadSystemMode(_0x29c689),AUTO_RESET_MODES[_0x341a36(0x23f)](_0x29c689[_0x341a36(0x1ff)])&&await _0x29c689['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x341a36(0x256)],'ack':![]});});}catch(_0x3f6ed9){_0x29c689[_0xfa59e6(0x2bf)][_0xfa59e6(0x268)]('Reset\x20Sched\x20Error:\x20'+_0x3f6ed9['message']);}}function setupDriftAnalysisScheduler(_0x211ac7){const _0x201814=a0_0xdafc4b;try{if(_0x211ac7[_0x201814(0x2e7)])clearInterval(_0x211ac7[_0x201814(0x2e7)]);if(!_0x211ac7[_0x201814(0x23e)])return;_0x211ac7[_0x201814(0x2e7)]=setInterval(()=>runBaselineDriftAnalysis(_0x211ac7),(_0x211ac7['config']['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x211ac7),0x1388);}catch(_0x146385){_0x211ac7[_0x201814(0x2bf)]['error'](_0x201814(0x32d)+_0x146385['message']);}}function setupBriefingScheduler(_0x190753){const _0x3a2eab=a0_0xdafc4b;try{if(_0x190753['briefingJob'])_0x190753['briefingJob']['cancel']();if(!_0x190753[_0x3a2eab(0x338)][_0x3a2eab(0x21f)])return;const _0x30e126=(_0x190753['config'][_0x3a2eab(0x1bd)]||_0x3a2eab(0x295))[_0x3a2eab(0x1ac)](':'),_0x4e63d5=parseInt(_0x30e126[0x0])||0x8,_0x3ab02d=parseInt(_0x30e126[0x1])||0x0,_0x2116e4=_0x3ab02d+'\x20'+_0x4e63d5+_0x3a2eab(0x1f0);_0x190753[_0x3a2eab(0x312)]=schedule[_0x3a2eab(0x20d)](_0x2116e4,()=>{sendMorningBriefing(_0x190753);});}catch(_0xef3d3c){_0x190753[_0x3a2eab(0x2bf)]['error']('Briefing\x20Sched\x20Error:\x20'+_0xef3d3c[_0x3a2eab(0x2b6)]);}}async function runBaselineDriftAnalysis(_0x1cd9c0){const _0x5d0305=a0_0xdafc4b;if(!_0x1cd9c0[_0x5d0305(0x23e)]||!_0x1cd9c0['geminiModel'])return;const _0x360566=_0x1cd9c0[_0x5d0305(0x338)][_0x5d0305(0x206)]||0xe;if(_0x1cd9c0[_0x5d0305(0x302)]['length']<_0x360566+0x7){await _0x1cd9c0[_0x5d0305(0x1e4)](LTM_DP_DRIFT_STATUS,{'val':_0x5d0305(0x310),'ack':!![]});return;}const _0x4789a4=_0x1cd9c0[_0x5d0305(0x302)][_0x5d0305(0x316)](-_0x360566),_0x180a86=_0x1cd9c0[_0x5d0305(0x302)][_0x5d0305(0x316)](0x0,_0x1cd9c0[_0x5d0305(0x302)]['length']-_0x360566),_0x5d1491='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x5d0305(0x201)](_0x180a86)+_0x5d0305(0x1ed)+JSON['stringify'](_0x4789a4);try{const _0x476e33=await _0x1cd9c0['geminiModel'][_0x5d0305(0x345)](_0x5d1491),_0x19ca61=JSON[_0x5d0305(0x1a7)](_0x476e33[_0x5d0305(0x244)][_0x5d0305(0x1cf)]()[_0x5d0305(0x1a8)](/```json|```/g,'')[_0x5d0305(0x2ca)]());_0x19ca61[_0x5d0305(0x214)]&&(await _0x1cd9c0[_0x5d0305(0x1e4)](LTM_DP_DRIFT_STATUS,{'val':_0x19ca61[_0x5d0305(0x214)],'ack':!![]}),await _0x1cd9c0['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x19ca61[_0x5d0305(0x311)],'ack':!![]}),await _0x1cd9c0['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x5d0305(0x341)](),'ack':!![]}));}catch(_0x5adfd6){}}class CogniLiving extends utils[a0_0xdafc4b(0x205)]{constructor(_0x3beb11){const _0x5e4c5b=a0_0xdafc4b;super({..._0x3beb11,'name':'cogni-living'}),this[_0x5e4c5b(0x1e2)]=[],this[_0x5e4c5b(0x2a8)]=[],this[_0x5e4c5b(0x192)]=[],this[_0x5e4c5b(0x302)]=[],this['sensorLastValues']={},this[_0x5e4c5b(0x22a)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x5e4c5b(0x27d)]=null,this[_0x5e4c5b(0x26e)]=null,this[_0x5e4c5b(0x189)]=![],this[_0x5e4c5b(0x300)]=null,this[_0x5e4c5b(0x226)]=null,this[_0x5e4c5b(0x1ff)]=SYSTEM_MODES[_0x5e4c5b(0x256)],this['isProVersion']=![],this[_0x5e4c5b(0x23a)]=![],this[_0x5e4c5b(0x339)]='unknown',this['analysisTimer']=null,this['ltmJob']=null,this['modeResetJob']=null,this[_0x5e4c5b(0x2e7)]=null,this[_0x5e4c5b(0x312)]=null,this[_0x5e4c5b(0x1e6)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x5e4c5b(0x2f6),this['onReady']['bind'](this)),this['on'](_0x5e4c5b(0x1f3),this[_0x5e4c5b(0x27b)][_0x5e4c5b(0x1a3)](this)),this['on'](_0x5e4c5b(0x228),this[_0x5e4c5b(0x33d)][_0x5e4c5b(0x1a3)](this)),this['on']('message',this[_0x5e4c5b(0x1d5)]['bind'](this));}async[a0_0xdafc4b(0x1ad)](){const _0x40d8dc=a0_0xdafc4b;this['log'][_0x40d8dc(0x18f)](_0x40d8dc(0x2c6)+this[_0x40d8dc(0x28d)]+_0x40d8dc(0x20c));if(!checkAndInstall(this))return;await startSystem(this);}[a0_0xdafc4b(0x33d)](_0x328d94){const _0x204063=a0_0xdafc4b;if(this[_0x204063(0x1fd)])clearInterval(this[_0x204063(0x1fd)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x204063(0x2e7)]);if(this[_0x204063(0x281)])this[_0x204063(0x281)][_0x204063(0x1cd)]();if(this[_0x204063(0x19d)])this[_0x204063(0x19d)]['cancel']();if(this[_0x204063(0x312)])this[_0x204063(0x312)][_0x204063(0x1cd)]();if(this['exitTimer'])clearTimeout(this[_0x204063(0x27d)]);if(this[_0x204063(0x26e)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x328d94();}async['onStateChange'](_0x24acd9,_0x302b5b){const _0x20cc3c=a0_0xdafc4b;if(!_0x302b5b||this['dependencyInstallInProgress'])return;if(_0x24acd9['includes'](_0x20cc3c(0x2a5))&&_0x24acd9[_0x20cc3c(0x28f)]('communicate.request')&&_0x302b5b['val']){await handleTelegramResponse(this,_0x302b5b[_0x20cc3c(0x30d)]);return;}if(_0x24acd9===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0x302b5b[_0x20cc3c(0x30d)]&&Object['values'](SYSTEM_MODES)[_0x20cc3c(0x23f)](_0x302b5b['val'])){this[_0x20cc3c(0x1ff)]=_0x302b5b[_0x20cc3c(0x30d)];if(_0x302b5b['val']===SYSTEM_MODES[_0x20cc3c(0x333)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x302b5b[_0x20cc3c(0x282)])this[_0x20cc3c(0x227)](_0x24acd9,{'val':this[_0x20cc3c(0x1ff)],'ack':!![]});return;}if(!_0x302b5b[_0x20cc3c(0x282)]){_0x24acd9[_0x20cc3c(0x23f)]('analysis.trigger')&&_0x302b5b[_0x20cc3c(0x30d)]&&(this['setState'](_0x24acd9,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x24acd9[_0x20cc3c(0x23f)](_0x20cc3c(0x296))&&_0x302b5b[_0x20cc3c(0x30d)]){this[_0x20cc3c(0x227)](_0x24acd9,{'val':![],'ack':!![]});if(this[_0x20cc3c(0x23e)])createDailyDigest(this);}_0x24acd9[_0x20cc3c(0x23f)](_0x20cc3c(0x1c2))&&_0x302b5b[_0x20cc3c(0x30d)]&&(this[_0x20cc3c(0x227)](_0x24acd9,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x24acd9[_0x20cc3c(0x23f)]('automation.triggerAction')&&_0x302b5b['val']&&(this[_0x20cc3c(0x227)](_0x24acd9,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x24acd9[_0x20cc3c(0x23f)](_0x20cc3c(0x255))&&_0x302b5b[_0x20cc3c(0x30d)]){this[_0x20cc3c(0x227)](_0x24acd9,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x417b1b=await this['getStateAsync'](_0x20cc3c(0x344));if(_0x417b1b&&_0x417b1b[_0x20cc3c(0x30d)]){const _0x297535=JSON['parse'](_0x417b1b[_0x20cc3c(0x30d)]);this[_0x20cc3c(0x2bf)][_0x20cc3c(0x18f)](_0x20cc3c(0x2d9)),this['setStateAsync']('analysis.training.status',{'val':_0x20cc3c(0x1b0),'ack':!![]}),sendToPython(this,_0x20cc3c(0x241),{'sequences':_0x297535});}}catch(_0x229828){this[_0x20cc3c(0x2bf)][_0x20cc3c(0x268)](_0x20cc3c(0x18a)+_0x229828[_0x20cc3c(0x2b6)]);}}if(_0x24acd9['includes'](_0x20cc3c(0x21e))&&_0x302b5b[_0x20cc3c(0x30d)]){this[_0x20cc3c(0x227)](_0x24acd9,{'val':![],'ack':!![]});if(this[_0x20cc3c(0x23e)])try{const _0x1b16bb=await this[_0x20cc3c(0x198)](LTM_DP_DAILY_DIGESTS);if(_0x1b16bb&&_0x1b16bb[_0x20cc3c(0x30d)])sendToPython(this,_0x20cc3c(0x329),{'digests':JSON[_0x20cc3c(0x1a7)](_0x1b16bb[_0x20cc3c(0x30d)])});}catch(_0x5dd577){}}if(_0x24acd9[_0x20cc3c(0x23f)](_0x20cc3c(0x25a))&&_0x302b5b[_0x20cc3c(0x30d)]){this[_0x20cc3c(0x227)](_0x24acd9,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x76c3e5=await this[_0x20cc3c(0x198)](_0x20cc3c(0x1ab));if(_0x76c3e5&&_0x76c3e5[_0x20cc3c(0x30d)])sendToPython(this,_0x20cc3c(0x1f1),{'points':JSON['parse'](_0x76c3e5['val'])});}catch(_0x3f896b){}}if(_0x24acd9['includes'](_0x20cc3c(0x197))&&_0x302b5b[_0x20cc3c(0x30d)]){this[_0x20cc3c(0x227)](_0x24acd9,{'val':![],'ack':!![]});if(this[_0x20cc3c(0x23e)])try{const _0x5d7120=await this[_0x20cc3c(0x198)](LTM_DP_RAW_LOG);_0x5d7120&&_0x5d7120['val']&&(this[_0x20cc3c(0x2bf)][_0x20cc3c(0x18f)](_0x20cc3c(0x2c9)),sendToPython(this,_0x20cc3c(0x30f),{'events':JSON[_0x20cc3c(0x1a7)](_0x5d7120[_0x20cc3c(0x30d)])}));}catch(_0x5e6739){}}return;}if(this[_0x20cc3c(0x338)]['presenceDevices']&&this[_0x20cc3c(0x338)][_0x20cc3c(0x315)][_0x20cc3c(0x23f)](_0x24acd9)){await checkWifiPresence(this);return;}const _0x590c90=(this['config']['devices']||[])[_0x20cc3c(0x29e)](_0x17d872=>_0x17d872['id']===_0x24acd9);if(_0x590c90)processSensorEvent(this,_0x24acd9,_0x302b5b,_0x590c90);}async[a0_0xdafc4b(0x1d5)](_0x3ade64){const _0x498c91=a0_0xdafc4b;if(typeof _0x3ade64===_0x498c91(0x24b)&&_0x3ade64[_0x498c91(0x2b6)]){if(_0x3ade64[_0x498c91(0x2b8)]===_0x498c91(0x25d)){const _0x20dc5c=_0x3ade64[_0x498c91(0x2b6)][_0x498c91(0x1b6)]||this[_0x498c91(0x338)]['geminiApiKey'];if(!_0x20dc5c)return this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':![],'message':_0x498c91(0x262)},_0x3ade64['callback']);try{const _0xb4f04c=new GoogleGenerativeAI(_0x20dc5c),_0x4e205e=_0xb4f04c[_0x498c91(0x233)]({'model':GEMINI_MODEL}),_0x494275=await _0x4e205e[_0x498c91(0x345)]('Hi');this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':!![],'message':_0x498c91(0x1c9)+_0x494275[_0x498c91(0x244)][_0x498c91(0x1cf)]()},_0x3ade64['callback']);}catch(_0x2a2739){this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':![],'message':_0x498c91(0x2e9)+_0x2a2739[_0x498c91(0x2b6)]},_0x3ade64['callback']);}}else{if(_0x3ade64['command']===_0x498c91(0x322)){const _0x36b049=await getWeatherContext(this),_0x510934=await getCalendarContext(this);this[_0x498c91(0x328)](_0x3ade64['from'],_0x3ade64[_0x498c91(0x2b8)],{'success':!![],'weather':_0x36b049,'calendar':_0x510934},_0x3ade64[_0x498c91(0x2cb)]);}else{if(_0x3ade64[_0x498c91(0x2b8)]===_0x498c91(0x297)){if(!this[_0x498c91(0x23e)])return this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':![],'isPro':![]},_0x3ade64['callback']);let _0x34f80a={'status':_0x498c91(0x1e5)};try{const _0x37942d=await this[_0x498c91(0x198)](LTM_DP_DRIFT_STATUS);_0x34f80a['status']=_0x37942d?_0x37942d[_0x498c91(0x30d)]:'N/A';}catch(_0x234d4a){}this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64['command'],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x34f80a,'analysisHistory':this[_0x498c91(0x2a8)]},_0x3ade64[_0x498c91(0x2cb)]);}else{if(_0x3ade64['command']===_0x498c91(0x1fe)){const _0x27cde8=this[_0x498c91(0x302)][_0x498c91(0x2c4)],_0x1208f8=new Date(),_0x423d49=new Date(_0x1208f8[_0x498c91(0x211)](),_0x1208f8['getMonth'](),_0x1208f8[_0x498c91(0x1c6)]())[_0x498c91(0x2a3)](),_0x2def88=this[_0x498c91(0x192)][_0x498c91(0x29d)](_0x42a1f8=>new Date(_0x42a1f8[_0x498c91(0x250)])[_0x498c91(0x2a3)]()>_0x423d49)['length'],_0x5105b1=new Array(0x18)[_0x498c91(0x21c)](0x0);this[_0x498c91(0x192)][_0x498c91(0x202)](_0x1a22ed=>{const _0x5de1b3=_0x498c91,_0x2f0267=new Date(_0x1a22ed[_0x5de1b3(0x250)]);if(_0x2f0267[_0x5de1b3(0x2a3)]()>_0x423d49)_0x5105b1[_0x2f0267['getHours']()]++;});let _0x131a62={'status':_0x498c91(0x1e5)};try{const _0x2cc4e6=await this[_0x498c91(0x198)](LTM_DP_DRIFT_STATUS);_0x131a62[_0x498c91(0x1bb)]=_0x2cc4e6?_0x2cc4e6['val']:_0x498c91(0x1e5);}catch(_0x5a47fd){}let _0x31af67='';try{const _0x1b98e6=await this[_0x498c91(0x198)]('system.presenceWho');_0x31af67=_0x1b98e6?_0x1b98e6[_0x498c91(0x30d)]:'';}catch(_0x2624d5){}let _0x199067=null;!this[_0x498c91(0x226)]&&(_0x199067=this[_0x498c91(0x338)]['geminiApiKey']?'KI-Modell\x20nicht\x20initialisiert':_0x498c91(0x30b));let _0x5367fb={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x5b9261=await this['getStateAsync']('analysis.automation.patternDetected');if(_0x5b9261&&_0x5b9261[_0x498c91(0x30d)]){_0x5367fb[_0x498c91(0x1c4)]=!![];const _0xe1c7a7=await this[_0x498c91(0x198)]('analysis.automation.description');_0x5367fb[_0x498c91(0x1fc)]=_0xe1c7a7?_0xe1c7a7[_0x498c91(0x30d)]:'';const _0x370d7=await this['getStateAsync']('analysis.automation.targetId');_0x5367fb[_0x498c91(0x215)]=_0x370d7?_0x370d7[_0x498c91(0x30d)]:'';const _0x152ce0=await this['getStateAsync']('analysis.automation.targetValue');_0x5367fb['targetValue']=_0x152ce0?_0x152ce0['val']:'';}const _0x43f58d=await this[_0x498c91(0x198)](_0x498c91(0x2ae));_0x5367fb['autoApply']=_0x43f58d?!!_0x43f58d['val']:![];}catch(_0x385f35){}this['sendTo'](_0x3ade64['from'],_0x3ade64['command'],{'success':!![],'eventHistory':this[_0x498c91(0x1e2)][_0x498c91(0x316)](0x0,0xf),'stats':{'digestCount':_0x27cde8,'eventCountToday':_0x2def88,'hourlyActivity':_0x5105b1,'driftStatus':_0x131a62[_0x498c91(0x1bb)],'isPresent':this['isPresent'],'presenceWho':_0x31af67,'minDays':this[_0x498c91(0x338)][_0x498c91(0x1b5)]||0x7,'stbDays':this[_0x498c91(0x338)][_0x498c91(0x206)]||0xe,'ltbDays':this[_0x498c91(0x338)][_0x498c91(0x2a7)]||0x3c,'systemError':_0x199067},'automation':_0x5367fb},_0x3ade64[_0x498c91(0x2cb)]);}else{if(_0x3ade64[_0x498c91(0x2b8)]===_0x498c91(0x2a6))try{const _0x431959=await scanForDevices(this,_0x3ade64[_0x498c91(0x2b6)]||{});this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':!![],'devices':_0x431959},_0x3ade64[_0x498c91(0x2cb)]);}catch(_0x5b3d1d){this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':![],'error':_0x5b3d1d[_0x498c91(0x2b6)]},_0x3ade64[_0x498c91(0x2cb)]);}else{if(_0x3ade64[_0x498c91(0x2b8)]==='getEnums'){const _0x2e9b2=await this[_0x498c91(0x32a)](_0x498c91(0x325),_0x498c91(0x1ae)),_0x4836c2=[];if(_0x2e9b2)for(const _0x429a97 in _0x2e9b2){const _0x59ce7a=_0x2e9b2[_0x429a97],_0x5b3bb5=(_0x59ce7a[_0x498c91(0x235)]&&typeof _0x59ce7a[_0x498c91(0x235)][_0x498c91(0x2e8)]===_0x498c91(0x24b)?_0x59ce7a[_0x498c91(0x235)][_0x498c91(0x2e8)]['de']:_0x59ce7a[_0x498c91(0x235)]['name'])||_0x59ce7a[_0x498c91(0x235)][_0x498c91(0x2e8)];_0x4836c2[_0x498c91(0x1b9)]({'id':_0x429a97,'name':_0x5b3bb5});}this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':!![],'enums':_0x4836c2},_0x3ade64[_0x498c91(0x2cb)]);}else{if(_0x3ade64[_0x498c91(0x2b8)]===_0x498c91(0x29a)){const _0xdd8ff3=_0x3ade64[_0x498c91(0x2b6)][_0x498c91(0x188)];if(!_0xdd8ff3)return this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':![],'error':'No\x20instance'},_0x3ade64[_0x498c91(0x2cb)]);const _0x2f39e0=await getCalendarNames(this,_0xdd8ff3);this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':!![],'names':_0x2f39e0},_0x3ade64[_0x498c91(0x2cb)]);}else{if(_0x3ade64[_0x498c91(0x2b8)]===_0x498c91(0x2f7)){const {targetId:_0x52d129,targetValue:_0x458da9}=_0x3ade64[_0x498c91(0x2b6)];this[_0x498c91(0x2bf)][_0x498c91(0x18f)]('üß™\x20Simulating\x20Butler\x20Proposal:\x20'+_0x52d129+_0x498c91(0x1b3)+_0x458da9),await this[_0x498c91(0x1e4)](_0x498c91(0x280),{'val':!![],'ack':!![]}),await this[_0x498c91(0x1e4)](_0x498c91(0x242),{'val':_0x498c91(0x1be)+_0x52d129,'ack':!![]}),await this[_0x498c91(0x1e4)]('analysis.automation.targetId',{'val':_0x52d129,'ack':!![]}),await this[_0x498c91(0x1e4)](_0x498c91(0x1b4),{'val':_0x458da9,'ack':!![]}),this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64['command'],{'success':!![]},_0x3ade64['callback']);}else{if(_0x3ade64[_0x498c91(0x2b8)]===_0x498c91(0x294)){const {historyId:_0x44530f,rating:_0x5c8d8b,comment:_0x489823,alertReason:_0x2ee22a}=_0x3ade64[_0x498c91(0x2b6)];_0x44530f&&_0x5c8d8b?(await saveFeedback(this,{'timestamp':Date[_0x498c91(0x341)](),'historyId':_0x44530f,'rating':_0x5c8d8b,'comment':_0x489823,'alertReason':_0x2ee22a}),this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':!![]},_0x3ade64[_0x498c91(0x2cb)])):this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':![],'error':_0x498c91(0x1f8)},_0x3ade64[_0x498c91(0x2cb)]);}else _0x3ade64[_0x498c91(0x2b8)]==='dismissAutomation'&&(this['log']['info'](_0x498c91(0x305)),await this[_0x498c91(0x1e4)](_0x498c91(0x280),{'val':![],'ack':!![]}),await this[_0x498c91(0x1e4)](_0x498c91(0x242),{'val':'','ack':!![]}),this[_0x498c91(0x328)](_0x3ade64[_0x498c91(0x335)],_0x3ade64[_0x498c91(0x2b8)],{'success':!![]},_0x3ade64[_0x498c91(0x2cb)]));}}}}}}}}}}}if(require['main']!==module)module[a0_0xdafc4b(0x272)]=_0x3c3bf6=>new CogniLiving(_0x3c3bf6);else new CogniLiving();