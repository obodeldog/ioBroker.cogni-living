const a0_0x21965d=a0_0x3e02;(function(_0x208ec2,_0x130ff8){const _0x3fd8d3=a0_0x3e02,_0x330e16=_0x208ec2();while(!![]){try{const _0x18b223=parseInt(_0x3fd8d3(0x2a3))/0x1*(parseInt(_0x3fd8d3(0x2c2))/0x2)+-parseInt(_0x3fd8d3(0x1d0))/0x3+parseInt(_0x3fd8d3(0x2cb))/0x4+-parseInt(_0x3fd8d3(0x35f))/0x5*(-parseInt(_0x3fd8d3(0x357))/0x6)+parseInt(_0x3fd8d3(0x271))/0x7+parseInt(_0x3fd8d3(0x35a))/0x8+-parseInt(_0x3fd8d3(0x1ce))/0x9*(parseInt(_0x3fd8d3(0x1e2))/0xa);if(_0x18b223===_0x130ff8)break;else _0x330e16['push'](_0x330e16['shift']());}catch(_0x1b8041){_0x330e16['push'](_0x330e16['shift']());}}}(a0_0x4e50,0x3de83));const a0_0x6ba179=(function(){let _0x13bfb0=!![];return function(_0x4c949a,_0x433469){const _0x2a69f7=_0x13bfb0?function(){const _0x9b9864=a0_0x3e02;if(_0x433469){const _0x2ae833=_0x433469[_0x9b9864(0x2e9)](_0x4c949a,arguments);return _0x433469=null,_0x2ae833;}}:function(){};return _0x13bfb0=![],_0x2a69f7;};}()),a0_0x5d5c7b=a0_0x6ba179(this,function(){const _0x125e2d=a0_0x3e02;return a0_0x5d5c7b[_0x125e2d(0x279)]()[_0x125e2d(0x293)](_0x125e2d(0x1e5))['toString']()[_0x125e2d(0x233)](a0_0x5d5c7b)[_0x125e2d(0x293)](_0x125e2d(0x1e5));});function a0_0x3e02(_0x332baa,_0x4c82c2){const _0x33a18a=a0_0x4e50();return a0_0x3e02=function(_0x5d5c7b,_0x6ba179){_0x5d5c7b=_0x5d5c7b-0x1c6;let _0x4e506e=_0x33a18a[_0x5d5c7b];return _0x4e506e;},a0_0x3e02(_0x332baa,_0x4c82c2);}function a0_0x4e50(){const _0x58beb1=['2-digit','minDaysForBaseline','Processing\x20Status','test','createAllObjects','includes','getForeignObjectsAsync','Feedback\x20Log','Gast','now','dailyDigests','LOWBAT','message','VACATION','loadRawEventLog','@iobroker/adapter-core','enum','loadHistoryFromState','activity','Event\x20History','pr√§senz','INSTALL_TEST','DIRECTION','analysis.isEmergency','LTM.rawEventLog','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','notifyPushoverInstance','history','getGenerativeModel','cancel','Baseline\x20Status','setupModeResetScheduler','system.mode','sendToAsync','Activity\x20Summary','testApiKey','N/A\x20(Learning)','saveDailyDigests','find','OPERATING_VOLTAGE','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','lastAlertState','party','presence','\x20presence\x20devices...','subscribeForeignStatesAsync','notifyPushoverEnabled','aiPersona','events.history','sound','createDailyDigest','Presence\x20Status','startExitTimer','N/A','mac\x20address','shutter_contact','COMBINED_PARAMETER','notifyEmailRecipient','abortExitTimer','Gemini\x20Init\x20Error:\x20','AI\x20Alert\x20Status','boolean','last\x20action','type','lampe','retry','system','eingang','runBaselineDriftAnalysis','Sending\x20notification:\x20\x22','analysis.history_debug_01','vacation','toUpperCase','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getLtmData','location','automationProposal','systemConfig','version','events.history_debug_02','name','Last\x20Result','text','details','online','checkSystemObjects','setState','Logbook','generic','LTM.driftAnalysis.lastCheck','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','precip','bad','sat','Rauchmelder','currentSystemMode','loadSystemMode','driftAnalysisTimer','wohn','cogni-living','Adapter','processSensorEvent','notifyWhatsappInstance','ALARM','üö®üö®\x20NOTFALL','74058mEOufJ','getObjectAsync','feedbackHistory','2260536xXCghu','capabilities','resetAnalysisStates','Normal','rauch','35obdnfY','Deaktiviert\x20(Pro-Feature)','effect','deviationFromBaseline','Gemini\x20AI\x20initialized.','join','\x22\x20was\x20','wohnungst√ºr','slice','Subscribing\x20to\x20','Missing\x20data','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','PARTY','date','analysis.isAlert','isEmergency','timestamp','last_seen','Pattern\x20Detected','isProVersion','Starting\x20Smart\x20Scan\x20with\x20filters:\x20','systemUUID','9qKoXus','analysis.automation','1057488LnvJWq','channel','longitude','archetype','isPresent','common','notifyTelegramEnabled','notifyWhatsappRecipient','getSystemUUID','ltmStbWindowDays','NORMAL','analysis.automation.suggestedAction','string','getForeignStateAsync','getForeignObjectAsync','.\x20PR√ÑSENZ:\x20','onReady','callback','7573210Wfjjpx','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','onUnload','(((.+)+)+)+$','subscribeStates','\x20Tage)','long','val','sensorLastValues','notifyEmailInstance','comfort','AI\x20Emergency\x20Status','exports','LTM.processingStatus','events.lastEvent','de-DE','Drift\x20Analysis','updateAnalysisHistory','LTM.triggerDailyDigest','notifyWhatsappEnabled','analysis.trigger','log','description','replace','analysis.deviationFromBaseline','config','cogni-living\x20adapter\x20starting\x20(v','Automation\x20Proposals','sendNotification','LTM.baselineStatus','diele','AES_KEY','weather','modeResetJob','analysis.alertReason','setObjectNotExistsAsync','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','Alert\x20Reason','push','lastCheck','onMessage','sensor.motion','.\x20PERSONA:\x20','uuid','Starting\x20Autopilot\x20(','No\x20recorded\x20events\x20yet.','node-schedule','unload','analysis.activitySummary','geminiModel','some','link_quality','object','GUEST','WORKING','ltmDriftCheckIntervalHours','üö®\x20EMERGENCY','analysis.comfortSummary','namespace','events.history_debug_01','WEEK_PROGRAM','motion','unshift','from','No\x20recent\x20activity.','forecast','inactivityThresholdHours','Success','Raw\x20Log','hue','json','startsWith','PRO-','system.','toLocaleString','exitGraceTimer','Temperatur','scanForDevices','PROCESS','CONFIG_PENDING','LTM','constructor','response','.\x20ORT:\x20','isGracePeriodActive','Drift\x20Details','state','Licht','flur','rawEventLog','generateContent','_score','enum.functions.*','triggerDailyDigest','uuid-error','runGeminiAnalysis','licenseKey','sensor.door','smoke','javascript.0.script','firmware','notifyPushoverRecipient','update','analysis.lastResult','System\x20Status\x20&\x20Control','scheduleJob','schlaf','pop','role','events.history_debug_04','haust√ºr','openweathermap.','analysis.history_debug_03','@google/generative-ai','analysis.automation.patternDetected','runAutopilot','temperatur','events.history_debug_03','vis.','Fenster/T√ºr','delObjectAsync','sensor.window','inactivityMonitoringEnabled','indicator','analysis.automation.description','UNREACH','ready','logDuplicates','notifyTelegramInstance','selectedFunctionIds','analysisInterval','saveFeedback','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','Drift\x20Status','switch.light','system.isPresent','system.config','t√ºr','toFixed','events.history_debug_00','presenceDevices','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','patternDetected','506856pihBoc','send','bind','saveRawEventLog','map','checkLtmDriftObjects','genAI','Schalter/Licht','toString','LTM.driftAnalysis.driftDetails','Description','value.temperature','yr.','ltmJob','system.meta.uuid','splice','CONNECTION','sort','setupLtmScheduler','driftDetails','native','alertReason','length','command','livingContext','notifySignalInstance','exitTimer','User\x20Feedback:\x20Alarm\x20\x22','geminiApiKey','Trigger\x20Digest','icon','isExit','doors','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','search','stringify','baselineDrift','Trigger\x20Analysis','uuid-not-found','checkLtmObjects','analysis.history_debug_04','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20ungew√∂hnliche\x20n√§chtliche\x20Aktivit√§t.','checkWifiPresence','scriptProblem','devices','analysisTimer','summary','Action','scanDevices','guest','16587alsLGj','VIRTUAL_CHANNEL','\x20(EMERGENCY)','temperature','Urlaub','weatherunderground.','uniqueid','pressure','split','info','updateBaselineStatus','RSSI','Comfort\x20Summary','getStateAsync','models/gemini-flash-latest','submitFeedback','ERROR_CODE','button','history.','detectionState','error','wetter','values','parse','apiKey','toLowerCase','setStateAsync','System\x20Mode','TEST-PRO-KEY','getEnums','LTM.dailyDigests','56qgKAQX','toISOString','analysisHistory','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','‚ö†Ô∏è\x20Alarm','indicator.alarm','ack','signal','N/A\x20(Pro\x20Feature)','1830304LcTUZS','isAlert','eventHistory','material.','productname','Badezimmer','[TEST]\x20','catch','members','Flur','city','colormode','analysis.history_debug_00','Party','Schlafzimmer','onStateChange','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','SECTION','setPresence','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','unknown','text.alarm','expire','Wohnzimmer','\x20min).\x20Watchdog\x20Limit:\x20','K√ºche','mode','sendTo','extendObjectAsync','Deviation','apply','0\x204\x20*\x20*\x20*','Bewegung','analysis.comfortSuggestion','notifyEmailEnabled'];a0_0x4e50=function(){return _0x58beb1;};return a0_0x4e50();}a0_0x5d5c7b();'use strict';const utils=require(a0_0x21965d(0x2fd)),{GoogleGenerativeAI}=require(a0_0x21965d(0x253)),schedule=require(a0_0x21965d(0x210)),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL=a0_0x21965d(0x2b1),ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE='0\x203\x20*\x20*\x20*',LTM_DP_RAW_LOG=a0_0x21965d(0x306),LTM_DP_DAILY_DIGESTS=a0_0x21965d(0x2c1),LTM_DP_STATUS=a0_0x21965d(0x1ef),LTM_DP_TRIGGER_DIGEST=a0_0x21965d(0x1f4),LTM_DP_BASELINE_STATUS=a0_0x21965d(0x1ff),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x21965d(0x27a),LTM_DP_DRIFT_LAST_CHECK=a0_0x21965d(0x347),SYSTEM_DP_MODE=a0_0x21965d(0x30e),MODE_RESET_SCHEDULE=a0_0x21965d(0x2ea),SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x21965d(0x335),'PARTY':a0_0x21965d(0x318),'GUEST':a0_0x21965d(0x2a2)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x21965d(0x36b)],SYSTEM_MODES[a0_0x21965d(0x217)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':a0_0x21965d(0x29a),'family':a0_0x21965d(0x307),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':a0_0x21965d(0x2de)};class CogniLiving extends utils[a0_0x21965d(0x352)]{constructor(_0x867c33){const _0x5bd44a=a0_0x21965d;super({..._0x867c33,'name':_0x5bd44a(0x351)}),this[_0x5bd44a(0x2cd)]=[],this[_0x5bd44a(0x2c4)]=[],this[_0x5bd44a(0x359)]=[],this['rawEventLog']=[],this[_0x5bd44a(0x2f8)]=[],this[_0x5bd44a(0x1ea)]={},this[_0x5bd44a(0x33b)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x5bd44a(0x28b)]=null,this['exitGraceTimer']=null,this['isGracePeriodActive']=![],this[_0x5bd44a(0x277)]=null,this[_0x5bd44a(0x213)]=null,this[_0x5bd44a(0x34d)]=SYSTEM_MODES[_0x5bd44a(0x1da)],this[_0x5bd44a(0x1cb)]=![],this[_0x5bd44a(0x317)]=![],this[_0x5bd44a(0x1cd)]=_0x5bd44a(0x2df),this[_0x5bd44a(0x29e)]=null,this[_0x5bd44a(0x27e)]=null,this[_0x5bd44a(0x203)]=null,this[_0x5bd44a(0x34f)]=null,this['on'](_0x5bd44a(0x260),this['onReady'][_0x5bd44a(0x273)](this)),this['on']('stateChange',this['onStateChange'][_0x5bd44a(0x273)](this)),this['on'](_0x5bd44a(0x211),this[_0x5bd44a(0x1e4)][_0x5bd44a(0x273)](this)),this['on'](_0x5bd44a(0x2fa),this[_0x5bd44a(0x20a)][_0x5bd44a(0x273)](this));}async[a0_0x21965d(0x1e0)](){const _0x37c335=a0_0x21965d;this[_0x37c335(0x1f7)]['info'](_0x37c335(0x1fc)+this[_0x37c335(0x33c)]+')');const _0x44803f=[_0x37c335(0x2d7),_0x37c335(0x334),'analysis.history_debug_02',_0x37c335(0x252),_0x37c335(0x299),_0x37c335(0x26d),_0x37c335(0x21d),_0x37c335(0x33d),_0x37c335(0x257),_0x37c335(0x24f)];for(const _0x59161b of _0x44803f){try{const _0x3c17ed=await this[_0x37c335(0x358)](_0x59161b);_0x3c17ed&&await this[_0x37c335(0x25a)](_0x59161b);}catch(_0x6a5863){}}this[_0x37c335(0x1fb)][_0x37c335(0x242)]=this[_0x37c335(0x1fb)][_0x37c335(0x242)]||'',this[_0x37c335(0x1cb)]=await this['checkLicense'](this[_0x37c335(0x1fb)][_0x37c335(0x242)]);if(!this[_0x37c335(0x1fb)][_0x37c335(0x224)]||this['config']['inactivityThresholdHours']<0.1)this[_0x37c335(0x1fb)][_0x37c335(0x224)]=0xc;await this['loadHistoryFromState']();try{const _0x5a05e9=await this[_0x37c335(0x1de)](_0x37c335(0x26a));_0x5a05e9&&_0x5a05e9[_0x37c335(0x1d5)]&&(this[_0x37c335(0x33b)]={'latitude':_0x5a05e9[_0x37c335(0x1d5)]['latitude']||0x0,'longitude':_0x5a05e9[_0x37c335(0x1d5)][_0x37c335(0x1d2)]||0x0,'city':_0x5a05e9[_0x37c335(0x1d5)][_0x37c335(0x2d5)]||''});}catch(_0x3077c3){}if(this['config'][_0x37c335(0x28d)])try{this['genAI']=new GoogleGenerativeAI(this[_0x37c335(0x1fb)][_0x37c335(0x28d)]),this[_0x37c335(0x213)]=this[_0x37c335(0x277)][_0x37c335(0x30a)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x37c335(0x1f7)][_0x37c335(0x2ac)](_0x37c335(0x363));}catch(_0x508948){this[_0x37c335(0x1f7)][_0x37c335(0x2b7)](_0x37c335(0x329)+_0x508948['message']);}await this[_0x37c335(0x2f2)](),await this['loadSystemMode'](),await this[_0x37c335(0x2fc)](),await this['loadDailyDigests'](),this[_0x37c335(0x1e6)]('analysis.trigger'),this[_0x37c335(0x1e6)](LTM_DP_TRIGGER_DIGEST),this['subscribeStates'](_0x37c335(0x30e));const _0x58ceab=this['config'][_0x37c335(0x29d)];if(_0x58ceab&&_0x58ceab['length']>0x0){this[_0x37c335(0x1f7)][_0x37c335(0x2ac)](_0x37c335(0x368)+_0x58ceab['length']+'\x20sensors...');for(const _0x5dc8e9 of _0x58ceab){if(_0x5dc8e9['id']){await this['subscribeForeignStatesAsync'](_0x5dc8e9['id']);try{const _0xe724ec=await this[_0x37c335(0x1dd)](_0x5dc8e9['id']);if(_0xe724ec)this['sensorLastValues'][_0x5dc8e9['id']]=_0xe724ec[_0x37c335(0x1e9)];}catch(_0x44b53b){}}}}const _0x357d03=this['config'][_0x37c335(0x26e)]||[];if(_0x357d03[_0x37c335(0x287)]>0x0){this[_0x37c335(0x1f7)][_0x37c335(0x2ac)](_0x37c335(0x368)+_0x357d03['length']+_0x37c335(0x31a));for(const _0x148405 of _0x357d03){await this[_0x37c335(0x31b)](_0x148405);}await this['checkWifiPresence']();}if(this['analysisTimer'])clearInterval(this[_0x37c335(0x29e)]);const _0x325fa0=this[_0x37c335(0x1fb)]['analysisInterval']||0xf;_0x325fa0>0x0&&(this[_0x37c335(0x1f7)]['info'](_0x37c335(0x20e)+_0x325fa0+_0x37c335(0x2e3)+this[_0x37c335(0x1fb)][_0x37c335(0x224)]+'h.'),this[_0x37c335(0x29e)]=setInterval(()=>this[_0x37c335(0x255)](),_0x325fa0*0x3c*0x3e8)),this[_0x37c335(0x283)](),this[_0x37c335(0x30d)](),this['setupDriftAnalysisScheduler']();}async[a0_0x21965d(0x22f)](_0x49faf4={}){const _0x175d6d=a0_0x21965d;this[_0x175d6d(0x1f7)][_0x175d6d(0x2ac)](_0x175d6d(0x1cc)+JSON[_0x175d6d(0x294)](_0x49faf4));const _0x2fb1ed=[],_0x522feb=_0x49faf4[_0x175d6d(0x21f)]!==![],_0x48c882=_0x49faf4[_0x175d6d(0x291)]!==![],_0x1680e6=_0x49faf4['lights']!==![],_0x28aa9c=_0x49faf4[_0x175d6d(0x2a6)]===!![],_0xa072e=_0x49faf4[_0x175d6d(0x202)]===!![],_0x25114e=_0x49faf4[_0x175d6d(0x263)]||[],_0xd88944=await this[_0x175d6d(0x2f4)]('enum.rooms.*',_0x175d6d(0x2fe)),_0x9aac6=await this[_0x175d6d(0x2f4)](_0x175d6d(0x23e),_0x175d6d(0x2fe)),_0x269ba4={},_0x356aae={},_0x105270={},_0x56231a=(_0x55ca92,_0x5673ea,_0x1bedb2=![])=>{const _0x134925=_0x175d6d;if(!_0x55ca92)return;for(const _0x4d421d in _0x55ca92){const _0x2188b3=_0x55ca92[_0x4d421d];if(_0x2188b3&&_0x2188b3[_0x134925(0x1d5)]&&_0x2188b3[_0x134925(0x1d5)][_0x134925(0x2d3)]){const _0x3d9a79=(typeof _0x2188b3['common']['name']==='object'?_0x2188b3[_0x134925(0x1d5)][_0x134925(0x33e)]['de']:_0x2188b3[_0x134925(0x1d5)][_0x134925(0x33e)])||_0x2188b3['common'][_0x134925(0x33e)];if(_0x1bedb2)_0x105270[_0x4d421d]=_0x3d9a79;for(const _0x475993 of _0x2188b3['common']['members']){if(_0x1bedb2){if(!_0x5673ea[_0x475993])_0x5673ea[_0x475993]=[];_0x5673ea[_0x475993]['push'](_0x4d421d);}else _0x5673ea[_0x475993]=_0x3d9a79;}}}};_0x56231a(_0xd88944,_0x269ba4),_0x56231a(_0x9aac6,_0x356aae,!![]);const _0x31d863=await this[_0x175d6d(0x2f4)]('*',_0x175d6d(0x238)),_0x460ce7=[_0x175d6d(0x25f),_0x175d6d(0x2f9),_0x175d6d(0x2ae),'ERROR','FAULT','SABOTAGE',_0x175d6d(0x355),_0x175d6d(0x231),'DUTYCYCLE',_0x175d6d(0x218),_0x175d6d(0x304),'STICKY_UNREACH',_0x175d6d(0x315),_0x175d6d(0x2a4),_0x175d6d(0x303),_0x175d6d(0x326),_0x175d6d(0x21e),'ON_TIME',_0x175d6d(0x2dc),_0x175d6d(0x2b3),_0x175d6d(0x230),_0x175d6d(0x201),_0x175d6d(0x281),'reachable',_0x175d6d(0x215),'battery',_0x175d6d(0x248),_0x175d6d(0x246),_0x175d6d(0x33c),'connection',_0x175d6d(0x2ac),_0x175d6d(0x2c9),_0x175d6d(0x1c9),_0x175d6d(0x32c),_0x175d6d(0x1d3),'alert',_0x175d6d(0x2e5),_0x175d6d(0x2d6),_0x175d6d(0x361),'xy','ct',_0x175d6d(0x227),_0x175d6d(0x34b),_0x175d6d(0x2cf),'manufacturer','modelid',_0x175d6d(0x2a9),_0x175d6d(0x288),_0x175d6d(0x324),_0x175d6d(0x1f8),_0x175d6d(0x35b),'process','scriptEnabled',_0x175d6d(0x29c),_0x175d6d(0x245),_0x175d6d(0x2b6),'summary',_0x175d6d(0x28f),_0x175d6d(0x309),_0x175d6d(0x223),_0x175d6d(0x2ac),_0x175d6d(0x228)];if(!_0xa072e)_0x460ce7[_0x175d6d(0x208)](_0x175d6d(0x2b8),_0x175d6d(0x202),'wind',_0x175d6d(0x2aa),'uv','rain',_0x175d6d(0x349));const _0x1bc436=[_0x175d6d(0x22b),'admin.','info.',_0x175d6d(0x258),_0x175d6d(0x2b5),_0x175d6d(0x2ce),'icons-mfd.','flot.'];if(!_0xa072e)_0x1bc436[_0x175d6d(0x208)]('daswetter.',_0x175d6d(0x2a8),'accuweather.',_0x175d6d(0x27d),_0x175d6d(0x251));const _0x139cc7=(_0x27d790,_0x1d63bd,_0xc38314=![])=>{const _0x231c36=_0x175d6d,_0x581c05=_0x27d790[_0x231c36(0x2ab)]('.');if(_0x1d63bd[_0x27d790])return _0x1d63bd[_0x27d790];if(_0x581c05[_0x231c36(0x287)]>0x2&&_0x1d63bd[_0x581c05[_0x231c36(0x367)](0x0,-0x1)[_0x231c36(0x364)]('.')])return _0x1d63bd[_0x581c05[_0x231c36(0x367)](0x0,-0x1)[_0x231c36(0x364)]('.')];if(_0x581c05[_0x231c36(0x287)]>0x3&&_0x1d63bd[_0x581c05[_0x231c36(0x367)](0x0,-0x2)[_0x231c36(0x364)]('.')])return _0x1d63bd[_0x581c05['slice'](0x0,-0x2)[_0x231c36(0x364)]('.')];return _0xc38314?[]:null;};for(const _0x1925a2 in _0x31d863){const _0x24236a=_0x31d863[_0x1925a2];if(!_0x24236a||!_0x24236a['common'])continue;if(_0x1bc436[_0x175d6d(0x214)](_0x5eb2e0=>_0x1925a2[_0x175d6d(0x229)](_0x5eb2e0)))continue;const _0x4865ed=_0x24236a[_0x175d6d(0x1d5)][_0x175d6d(0x24e)]||'',_0x1a15d0=(_0x24236a[_0x175d6d(0x1d5)][_0x175d6d(0x33e)]&&typeof _0x24236a[_0x175d6d(0x1d5)][_0x175d6d(0x33e)]===_0x175d6d(0x216)?_0x24236a[_0x175d6d(0x1d5)][_0x175d6d(0x33e)]['de']:_0x24236a[_0x175d6d(0x1d5)][_0x175d6d(0x33e)])||'',_0x3b1939=_0x1a15d0?_0x1a15d0[_0x175d6d(0x2bc)]():'',_0x142f56=_0x1925a2['toLowerCase'](),_0x26b8e2=_0x139cc7(_0x1925a2,_0x269ba4),_0x54fd6d=_0x139cc7(_0x1925a2,_0x356aae,!![]);let _0x24e2ac=null,_0x121e62=![];if(_0x54fd6d&&_0x54fd6d[_0x175d6d(0x287)]>0x0){const _0x4c7fac=_0x54fd6d[_0x175d6d(0x314)](_0x115e26=>_0x25114e[_0x175d6d(0x2f3)](_0x115e26));if(_0x4c7fac){_0x121e62=!![];const _0x5157aa=_0x105270[_0x4c7fac];if(_0x142f56[_0x175d6d(0x2f3)](_0x175d6d(0x319))||_0x142f56[_0x175d6d(0x2f3)](_0x175d6d(0x21f)))_0x24e2ac=_0x175d6d(0x2eb);else{if(_0x142f56[_0x175d6d(0x2f3)](_0x175d6d(0x244))||_0x142f56[_0x175d6d(0x2f3)]('fire')||_0x3b1939['includes'](_0x175d6d(0x35e)))_0x24e2ac=_0x175d6d(0x34c);else{if(_0x142f56['includes'](_0x175d6d(0x238))||_0x142f56[_0x175d6d(0x2f3)]('level')||_0x142f56[_0x175d6d(0x2f3)]('on'))_0x24e2ac=_0x175d6d(0x278);else _0x24e2ac=_0x5157aa;}}}}if(!_0x121e62&&!_0xa072e){if(_0x460ce7[_0x175d6d(0x214)](_0x3f730c=>_0x3b1939[_0x175d6d(0x2f3)](_0x3f730c)||_0x1925a2[_0x175d6d(0x336)]()['includes'](_0x3f730c)))continue;}if(!_0x24e2ac&&_0x522feb){if(_0x4865ed[_0x175d6d(0x2f3)](_0x175d6d(0x20b))||_0x4865ed[_0x175d6d(0x2f3)]('occupancy')||_0x3b1939[_0x175d6d(0x2f3)]('bewegung')||_0x3b1939['includes'](_0x175d6d(0x302)))_0x24e2ac=_0x175d6d(0x2eb);}!_0x24e2ac&&_0x48c882&&((_0x142f56[_0x175d6d(0x2f3)](_0x175d6d(0x325))||_0x4865ed[_0x175d6d(0x2f3)](_0x175d6d(0x243))||_0x4865ed[_0x175d6d(0x2f3)](_0x175d6d(0x25b))||(_0x3b1939[_0x175d6d(0x2f3)]('fenster')||_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x26b)))&&!_0x3b1939[_0x175d6d(0x2f3)]('temp')&&!_0x3b1939['includes']('griff')&&(_0x24236a[_0x175d6d(0x1d5)][_0x175d6d(0x32d)]===_0x175d6d(0x32b)||_0x24236a['common'][_0x175d6d(0x32d)]==='number'))&&(_0x24e2ac='Fenster/T√ºr'));if(!_0x24e2ac&&_0x1680e6){if((_0x4865ed[_0x175d6d(0x2f3)](_0x175d6d(0x268))||_0x4865ed['includes']('level.dimmer')||_0x3b1939[_0x175d6d(0x2f3)]('licht')||_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x32e)))&&_0x24236a[_0x175d6d(0x1d5)]['write'])_0x24e2ac=_0x175d6d(0x239);}if(!_0x24e2ac&&_0x28aa9c){if(_0x4865ed[_0x175d6d(0x2f3)](_0x175d6d(0x27c))||_0x4865ed[_0x175d6d(0x2f3)]('value.humidity')||_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x256)))_0x24e2ac=_0x175d6d(0x22e);}if(_0x24e2ac){let _0x2a9a85=_0x26b8e2||'';if(!_0x2a9a85){if(_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x34a)))_0x2a9a85=_0x175d6d(0x2d0);else{if(_0x3b1939[_0x175d6d(0x2f3)]('k√ºche'))_0x2a9a85=_0x175d6d(0x2e4);else{if(_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x350)))_0x2a9a85=_0x175d6d(0x2e2);else{if(_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x24c)))_0x2a9a85=_0x175d6d(0x2d9);else{if(_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x23a))||_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x200)))_0x2a9a85=_0x175d6d(0x2d4);else{if(_0x3b1939[_0x175d6d(0x2f3)]('garten'))_0x2a9a85='Garten';}}}}}}let _0x1d5935=![];_0x24e2ac===_0x175d6d(0x259)&&((_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x250))||_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x331))||_0x3b1939[_0x175d6d(0x2f3)](_0x175d6d(0x366))||_0x2a9a85&&_0x2a9a85[_0x175d6d(0x2bc)]()[_0x175d6d(0x2f3)](_0x175d6d(0x23a))&&_0x3b1939['includes'](_0x175d6d(0x26b)))&&(_0x1d5935=!![]));let _0xf93cd0=0x0;if(_0x121e62)_0xf93cd0+=0x1e;else{if(_0x26b8e2)_0xf93cd0+=0x14;else{if(_0x2a9a85)_0xf93cd0+=0xa;}}if(_0x1d5935)_0xf93cd0+=0x5;_0x2fb1ed['push']({'id':_0x1925a2,'name':_0x1a15d0||_0x1925a2,'type':_0x24e2ac,'location':_0x2a9a85,'logDuplicates':_0x24e2ac===_0x175d6d(0x2eb),'isExit':_0x1d5935,'_score':_0xf93cd0});}}return _0x2fb1ed[_0x175d6d(0x282)]((_0x379c46,_0x2e6b1f)=>_0x2e6b1f[_0x175d6d(0x23d)]-_0x379c46['_score']),_0x2fb1ed;}async[a0_0x21965d(0x29b)](){const _0xb98ee=a0_0x21965d,_0x2f5e42=this['config'][_0xb98ee(0x26e)]||[];let _0x4572b7=![];for(const _0xe8f777 of _0x2f5e42){try{const _0x5c528e=await this[_0xb98ee(0x1dd)](_0xe8f777);if(_0x5c528e&&(_0x5c528e[_0xb98ee(0x1e9)]===!![]||_0x5c528e['val']===_0xb98ee(0x342)||_0x5c528e[_0xb98ee(0x1e9)]===0x1)){_0x4572b7=!![];break;}}catch(_0x43b487){}}return _0x4572b7&&(this[_0xb98ee(0x28b)]&&(this['log'][_0xb98ee(0x2ac)](_0xb98ee(0x348)),this[_0xb98ee(0x328)]()),!this[_0xb98ee(0x1d4)]&&this[_0xb98ee(0x34d)]===SYSTEM_MODES['NORMAL']&&this[_0xb98ee(0x2dd)](!![])),_0x4572b7;}async[a0_0x21965d(0x2da)](_0x2afe08,_0x37da9c){const _0x5b5949=a0_0x21965d;if(!_0x37da9c)return;if(_0x2afe08===this[_0x5b5949(0x21c)]+'.'+SYSTEM_DP_MODE){_0x37da9c[_0x5b5949(0x1e9)]&&Object[_0x5b5949(0x2b9)](SYSTEM_MODES)['includes'](_0x37da9c['val'])&&(this['currentSystemMode']=_0x37da9c[_0x5b5949(0x1e9)],_0x37da9c[_0x5b5949(0x1e9)]===SYSTEM_MODES[_0x5b5949(0x2fb)]?this['setPresence'](![]):this[_0x5b5949(0x2dd)](!![]));if(!_0x37da9c[_0x5b5949(0x2c8)])this[_0x5b5949(0x344)](_0x2afe08,{'val':this[_0x5b5949(0x34d)],'ack':!![]});return;}if(!_0x37da9c['ack']){_0x2afe08[_0x5b5949(0x2f3)]('analysis.trigger')&&_0x37da9c[_0x5b5949(0x1e9)]&&(this[_0x5b5949(0x344)](_0x2afe08,{'val':![],'ack':!![]}),this[_0x5b5949(0x241)]());if(_0x2afe08[_0x5b5949(0x2f3)](_0x5b5949(0x23f))&&_0x37da9c['val']){this[_0x5b5949(0x344)](_0x2afe08,{'val':![],'ack':!![]});if(this[_0x5b5949(0x1cb)])this[_0x5b5949(0x320)]();}return;}if(this[_0x5b5949(0x1fb)]['presenceDevices']&&this[_0x5b5949(0x1fb)][_0x5b5949(0x26e)][_0x5b5949(0x2f3)](_0x2afe08)){await this[_0x5b5949(0x29b)]();return;}const _0x22c68a=(this[_0x5b5949(0x1fb)]['devices']||[])[_0x5b5949(0x314)](_0x2e3a8f=>_0x2e3a8f['id']===_0x2afe08);if(_0x22c68a)this[_0x5b5949(0x353)](_0x2afe08,_0x37da9c,_0x22c68a);}async['processSensorEvent'](_0x381b19,_0x270b5b,_0xc780f8){const _0x5f1322=a0_0x21965d;if(!_0xc780f8[_0x5f1322(0x261)]&&this[_0x5f1322(0x1ea)][_0x381b19]===_0x270b5b[_0x5f1322(0x1e9)])return;this[_0x5f1322(0x1ea)][_0x381b19]=_0x270b5b[_0x5f1322(0x1e9)];if(this[_0x5f1322(0x236)])return;const _0x37c90d=await this[_0x5f1322(0x29b)]();if(_0x37c90d){if(!this[_0x5f1322(0x1d4)])this['setPresence'](!![]);}else{const _0x6e362f=_0xc780f8[_0x5f1322(0x290)]===!![];_0x6e362f?this[_0x5f1322(0x322)]():(this[_0x5f1322(0x28b)]&&(this['log'][_0x5f1322(0x2ac)](_0x5f1322(0x1e3)),this[_0x5f1322(0x328)]()),!this[_0x5f1322(0x1d4)]&&this[_0x5f1322(0x34d)]===SYSTEM_MODES['NORMAL']&&this['setPresence'](!![]));}const _0x240685={'timestamp':_0x270b5b['ts'],'id':_0x381b19,'name':_0xc780f8[_0x5f1322(0x33e)],'value':_0x270b5b[_0x5f1322(0x1e9)],'location':_0xc780f8[_0x5f1322(0x339)],'type':_0xc780f8[_0x5f1322(0x32d)]};this[_0x5f1322(0x2cd)][_0x5f1322(0x220)](_0x240685);if(this['eventHistory']['length']>HISTORY_MAX_SIZE)this[_0x5f1322(0x2cd)][_0x5f1322(0x24d)]();await this[_0x5f1322(0x2bd)]('events.lastEvent',{'val':JSON[_0x5f1322(0x294)](_0x240685),'ack':!![]}),await this[_0x5f1322(0x2bd)](_0x5f1322(0x31e),{'val':JSON[_0x5f1322(0x294)](this['eventHistory']),'ack':!![]}),this[_0x5f1322(0x23b)][_0x5f1322(0x208)]({'timestamp':new Date(_0x270b5b['ts'])[_0x5f1322(0x2c3)](),'sensorName':_0xc780f8[_0x5f1322(0x33e)],'location':_0xc780f8[_0x5f1322(0x339)],'value':_0x270b5b[_0x5f1322(0x1e9)]}),await this[_0x5f1322(0x274)]();}[a0_0x21965d(0x322)](){const _0x39d911=a0_0x21965d;this[_0x39d911(0x328)](),this[_0x39d911(0x236)]=!![],this[_0x39d911(0x22d)]=setTimeout(()=>{this['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x39d911(0x28b)]=setTimeout(()=>{const _0x48112b=_0x39d911;this[_0x48112b(0x2dd)](![]),this[_0x48112b(0x28b)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x21965d(0x328)](){const _0xb7d7d9=a0_0x21965d;if(this[_0xb7d7d9(0x28b)])clearTimeout(this['exitTimer']);if(this[_0xb7d7d9(0x22d)])clearTimeout(this[_0xb7d7d9(0x22d)]);this[_0xb7d7d9(0x28b)]=null,this[_0xb7d7d9(0x22d)]=null,this[_0xb7d7d9(0x236)]=![];}async[a0_0x21965d(0x2dd)](_0x4986f){const _0xfcb156=a0_0x21965d;if(this['isPresent']===_0x4986f)return;this[_0xfcb156(0x1d4)]=_0x4986f,await this[_0xfcb156(0x2bd)](_0xfcb156(0x269),{'val':_0x4986f,'ack':!![]});}[a0_0x21965d(0x255)](){const _0x5c42b0=a0_0x21965d,_0x35eacd=this[_0x5c42b0(0x1fb)][_0x5c42b0(0x224)],_0x44d899=this[_0x5c42b0(0x1fb)][_0x5c42b0(0x25c)],_0x1d1f69=this[_0x5c42b0(0x2cd)]['length']>0x0?this[_0x5c42b0(0x2cd)][0x0][_0x5c42b0(0x1c8)]:Date['now'](),_0x45064b=(Date[_0x5c42b0(0x2f7)]()-_0x1d1f69)/(0x3e8*0x3c*0x3c);let _0x4d1b09='';_0x44d899&&this[_0x5c42b0(0x34d)]===SYSTEM_MODES[_0x5c42b0(0x1da)]&&this[_0x5c42b0(0x1d4)]&&(_0x45064b>_0x35eacd&&(_0x4d1b09=_0x5c42b0(0x266)+_0x45064b[_0x5c42b0(0x26c)](0x1)+_0x5c42b0(0x36a)));if(_0x4d1b09){this['runGeminiAnalysis'](_0x4d1b09)[_0x5c42b0(0x2d2)](_0x1c24ee=>this[_0x5c42b0(0x1f7)][_0x5c42b0(0x2b7)](_0x1c24ee));return;}const _0x4fdae5=Date[_0x5c42b0(0x2f7)](),_0x3fcb82=_0x4fdae5-_0x1d1f69,_0xb8cdaf=(this[_0x5c42b0(0x1fb)][_0x5c42b0(0x264)]||0xf)*0x3c*0x3e8;this[_0x5c42b0(0x2cd)][_0x5c42b0(0x287)]>0x0&&_0x3fcb82<=_0xb8cdaf?this['runGeminiAnalysis']()[_0x5c42b0(0x2d2)](_0x24883c=>this[_0x5c42b0(0x1f7)][_0x5c42b0(0x2b7)](_0x24883c)):!this[_0x5c42b0(0x317)]&&(this[_0x5c42b0(0x344)]('analysis.isAlert',{'val':![],'ack':!![]}),this[_0x5c42b0(0x344)](_0x5c42b0(0x305),{'val':![],'ack':!![]}));}async['runGeminiAnalysis'](_0x914768=''){const _0x4b7b2c=a0_0x21965d;if(!this['geminiModel'])return;const _0x174b42=this[_0x4b7b2c(0x2cd)][_0x4b7b2c(0x287)]>0x0?this['eventHistory']:[{'note':_0x4b7b2c(0x20f)}],_0x269c49=PERSONA_MAPPING[this[_0x4b7b2c(0x1fb)][_0x4b7b2c(0x31d)]||_0x4b7b2c(0x346)],_0x5c1b0f=this[_0x4b7b2c(0x1fb)][_0x4b7b2c(0x289)]||'',_0x1daea5=this['currentSystemMode'],_0x236a2a=new Date(),_0x249ceb=_0x236a2a[_0x4b7b2c(0x22c)](_0x4b7b2c(0x1f1),{'weekday':_0x4b7b2c(0x1e8),'hour':_0x4b7b2c(0x2ee),'minute':_0x4b7b2c(0x2ee)}),_0xdfe9a4=this['systemConfig'];let _0x530bd8='';if(this[_0x4b7b2c(0x359)]['length']>0x0){const _0x4f4d17=this['feedbackHistory']['slice'](0x0,0x3)[_0x4b7b2c(0x275)](_0x5d9c12=>_0x4b7b2c(0x28c)+_0x5d9c12[_0x4b7b2c(0x286)]+_0x4b7b2c(0x365)+_0x5d9c12['rating']+'.')[_0x4b7b2c(0x364)]('\x0a');_0x530bd8='\x0aFEEDBACK:\x0a'+_0x4f4d17+'\x0a';}const _0x428b16=_0x914768?_0x4b7b2c(0x26f)+_0x914768+_0x4b7b2c(0x316):'',_0x3ff04b='Baseline:\x20Inactive\x20(Pro\x20Feature).',_0x1b7765=_0x4b7b2c(0x2c5)+_0x249ceb+_0x4b7b2c(0x235)+_0xdfe9a4['city']+_0x4b7b2c(0x2db)+_0x1daea5+_0x4b7b2c(0x1df)+(this[_0x4b7b2c(0x1d4)]?'Ja':'Nein')+'.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20'+_0x5c1b0f+_0x4b7b2c(0x20c)+_0x269c49+_0x4b7b2c(0x337)+_0x3ff04b+'\x20'+_0x530bd8+'\x20'+_0x428b16+_0x4b7b2c(0x206)+JSON['stringify'](_0x174b42)+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20}\x20}';try{const _0x4e3eef=await this[_0x4b7b2c(0x213)][_0x4b7b2c(0x23c)](_0x1b7765),_0x18b88e=_0x4e3eef['response'][_0x4b7b2c(0x340)]()[_0x4b7b2c(0x1f9)](/```json|```/g,'')['trim'](),_0x2e21b5=JSON[_0x4b7b2c(0x2ba)](_0x18b88e);await this[_0x4b7b2c(0x2bd)](_0x4b7b2c(0x249),{'val':_0x18b88e,'ack':!![]}),await this['setStateAsync']('analysis.alertReason',{'val':_0x2e21b5[_0x4b7b2c(0x300)][_0x4b7b2c(0x286)]||'','ack':!![]}),await this[_0x4b7b2c(0x2bd)](_0x4b7b2c(0x212),{'val':_0x2e21b5['activity']['summary']||_0x4b7b2c(0x323),'ack':!![]}),await this['setStateAsync'](_0x4b7b2c(0x1fa),{'val':_0x2e21b5[_0x4b7b2c(0x300)][_0x4b7b2c(0x362)]||_0x4b7b2c(0x323),'ack':!![]});_0x2e21b5['comfort']&&(await this['setStateAsync'](_0x4b7b2c(0x21b),{'val':_0x2e21b5['comfort'][_0x4b7b2c(0x29f)]||'','ack':!![]}),await this['setStateAsync'](_0x4b7b2c(0x2ec),{'val':_0x2e21b5[_0x4b7b2c(0x1ec)]['suggestion']||'','ack':!![]}),_0x2e21b5[_0x4b7b2c(0x1ec)][_0x4b7b2c(0x33a)]&&(await this[_0x4b7b2c(0x2bd)](_0x4b7b2c(0x254),{'val':_0x2e21b5['comfort'][_0x4b7b2c(0x33a)][_0x4b7b2c(0x270)]||![],'ack':!![]}),await this['setStateAsync'](_0x4b7b2c(0x25e),{'val':_0x2e21b5[_0x4b7b2c(0x1ec)][_0x4b7b2c(0x33a)]['description']||'','ack':!![]}),await this[_0x4b7b2c(0x2bd)](_0x4b7b2c(0x1db),{'val':_0x2e21b5['comfort'][_0x4b7b2c(0x33a)]['suggestedAction']||'','ack':!![]})));const _0x338286=_0x2e21b5['activity'][_0x4b7b2c(0x2cc)]||![],_0x2bf6a1=_0x2e21b5[_0x4b7b2c(0x300)][_0x4b7b2c(0x1c7)]||![];if(_0x338286||_0x2bf6a1){await this[_0x4b7b2c(0x2bd)]('analysis.isAlert',{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x4b7b2c(0x305),{'val':_0x2bf6a1,'ack':!![]});if(!this['lastAlertState']||_0x2bf6a1){const _0x4386ea=_0x2bf6a1?_0x4b7b2c(0x356):_0x4b7b2c(0x2c6);this['sendNotification'](_0x4386ea+':\x20'+_0x2e21b5[_0x4b7b2c(0x300)][_0x4b7b2c(0x286)],![],_0x2bf6a1);}}else await this[_0x4b7b2c(0x2bd)](_0x4b7b2c(0x1c6),{'val':![],'ack':!![]}),await this[_0x4b7b2c(0x2bd)](_0x4b7b2c(0x305),{'val':![],'ack':!![]});this[_0x4b7b2c(0x317)]=_0x338286||_0x2bf6a1;const _0x21dc13={'timestamp':Date[_0x4b7b2c(0x2f7)](),'id':Date[_0x4b7b2c(0x2f7)]()[_0x4b7b2c(0x279)](),'analysis':_0x2e21b5,'systemMode':_0x1daea5,'isPro':this['isProVersion']};this[_0x4b7b2c(0x1f3)](_0x21dc13);}catch(_0x4e7c31){this[_0x4b7b2c(0x1f7)][_0x4b7b2c(0x2b7)]('Analysis\x20Error:\x20'+_0x4e7c31[_0x4b7b2c(0x2fa)]);}}async[a0_0x21965d(0x2ff)](){const _0x417111=a0_0x21965d;try{const _0x50e185=await this[_0x417111(0x2b0)](_0x417111(0x31e));_0x50e185&&_0x50e185[_0x417111(0x1e9)]&&(this[_0x417111(0x2cd)]=JSON[_0x417111(0x2ba)](_0x50e185[_0x417111(0x1e9)][_0x417111(0x279)]()));}catch(_0x1d3f37){this[_0x417111(0x2cd)]=[];}try{const _0x4fcda6=await this['getStateAsync']('analysis.analysisHistory');if(_0x4fcda6&&_0x4fcda6[_0x417111(0x1e9)])this[_0x417111(0x2c4)]=JSON[_0x417111(0x2ba)](_0x4fcda6[_0x417111(0x1e9)][_0x417111(0x279)]());}catch(_0x2e7351){this['analysisHistory']=[];}}async[a0_0x21965d(0x2f2)](){const _0x3f4491=a0_0x21965d;await this[_0x3f4491(0x343)](),await this[_0x3f4491(0x205)]('system.isPresent',{'type':'state','common':{'name':_0x3f4491(0x321),'type':'boolean','role':_0x3f4491(0x25d),'read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x3f4491(0x205)](_0x3f4491(0x1f0),{'type':_0x3f4491(0x238),'common':{'name':'Last\x20raw\x20event','type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x205)](_0x3f4491(0x31e),{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x301),'type':'string','role':_0x3f4491(0x228),'read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x205)](_0x3f4491(0x1f6),{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x296),'type':_0x3f4491(0x32b),'role':_0x3f4491(0x2b4),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x3f4491(0x249),{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x33f),'type':_0x3f4491(0x1dc),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x205)]('analysis.isAlert',{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x32a),'type':_0x3f4491(0x32b),'role':_0x3f4491(0x2c7),'read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.isEmergency',{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x1ed),'type':_0x3f4491(0x32b),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x3f4491(0x204),{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x207),'type':_0x3f4491(0x1dc),'role':_0x3f4491(0x2e0),'read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x205)]('analysis.activitySummary',{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x310),'type':_0x3f4491(0x1dc),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x205)](_0x3f4491(0x1fa),{'type':'state','common':{'name':_0x3f4491(0x2e8),'type':_0x3f4491(0x1dc),'role':_0x3f4491(0x238),'read':!![],'write':![],'def':_0x3f4491(0x323)},'native':{}}),await this[_0x3f4491(0x205)](_0x3f4491(0x21b),{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x2af),'type':_0x3f4491(0x1dc),'role':_0x3f4491(0x340),'read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x205)]('analysis.comfortSuggestion',{'type':_0x3f4491(0x238),'common':{'name':'Comfort\x20Suggestion','type':_0x3f4491(0x1dc),'role':_0x3f4491(0x340),'read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x2e7)](_0x3f4491(0x1cf),{'type':_0x3f4491(0x1d1),'common':{'name':_0x3f4491(0x1fd)},'native':{}}),await this['setObjectNotExistsAsync'](_0x3f4491(0x254),{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x1ca),'type':_0x3f4491(0x32b),'role':_0x3f4491(0x25d),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x3f4491(0x205)](_0x3f4491(0x25e),{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x27b),'type':_0x3f4491(0x1dc),'role':_0x3f4491(0x340),'read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x205)](_0x3f4491(0x1db),{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x2a0),'type':_0x3f4491(0x1dc),'role':_0x3f4491(0x340),'read':!![],'write':![]},'native':{}}),await this[_0x3f4491(0x205)]('analysis.analysisHistory',{'type':_0x3f4491(0x238),'common':{'name':_0x3f4491(0x345),'type':'string','role':_0x3f4491(0x228),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x3f4491(0x205)]('analysis.feedbackHistory',{'type':'state','common':{'name':_0x3f4491(0x2f5),'type':_0x3f4491(0x1dc),'role':_0x3f4491(0x228),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x3f4491(0x298)](),await this[_0x3f4491(0x276)]();}async[a0_0x21965d(0x343)](){const _0x4a0319=a0_0x21965d;await this[_0x4a0319(0x2e7)](_0x4a0319(0x330),{'type':_0x4a0319(0x1d1),'common':{'name':_0x4a0319(0x24a)},'native':{}}),await this['extendObjectAsync'](SYSTEM_DP_MODE,{'type':'state','common':{'name':_0x4a0319(0x2be),'type':'string','role':_0x4a0319(0x238),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x4a0319(0x1da)],'states':{[SYSTEM_MODES[_0x4a0319(0x1da)]]:_0x4a0319(0x35d),[SYSTEM_MODES[_0x4a0319(0x2fb)]]:_0x4a0319(0x2a7),[SYSTEM_MODES[_0x4a0319(0x36b)]]:_0x4a0319(0x2d8),[SYSTEM_MODES['GUEST']]:_0x4a0319(0x2f6)}},'native':{}});}async[a0_0x21965d(0x1fe)](_0x8fb722,_0x41aebb=![],_0x4534d2=![]){const _0x285e13=a0_0x21965d;this[_0x285e13(0x1f7)][_0x285e13(0x2ac)]((_0x41aebb?_0x285e13(0x2d1):'')+_0x285e13(0x333)+_0x8fb722+'\x22'+(_0x4534d2?_0x285e13(0x2a5):''));const _0x178405=this['config'];let _0x14d1f7=0x0;_0x178405[_0x285e13(0x1d6)]&&_0x178405['notifyTelegramInstance']&&(await this[_0x285e13(0x30f)](_0x178405[_0x285e13(0x262)],_0x285e13(0x272),{'text':_0x8fb722,'user':_0x178405['notifyTelegramRecipient']}),_0x14d1f7++);if(_0x178405[_0x285e13(0x31c)]&&_0x178405[_0x285e13(0x308)]){let _0x3a8c60={'message':_0x8fb722,'title':_0x4534d2?_0x285e13(0x21a):'Cogni-Living\x20Alert','priority':_0x4534d2?0x2:0x1,'device':_0x178405[_0x285e13(0x247)]};_0x4534d2&&(_0x3a8c60[_0x285e13(0x32f)]=0x1e,_0x3a8c60[_0x285e13(0x2e1)]=0xe10,_0x3a8c60[_0x285e13(0x31f)]='siren'),await this[_0x285e13(0x30f)](_0x178405[_0x285e13(0x308)],_0x285e13(0x272),_0x3a8c60),_0x14d1f7++;}return _0x178405[_0x285e13(0x2ed)]&&_0x178405[_0x285e13(0x1eb)]&&(await this[_0x285e13(0x30f)](_0x178405[_0x285e13(0x1eb)],'send',{'text':_0x8fb722,'to':_0x178405[_0x285e13(0x327)]}),_0x14d1f7++),_0x178405[_0x285e13(0x1f5)]&&_0x178405['notifyWhatsappInstance']&&(await this[_0x285e13(0x30f)](_0x178405[_0x285e13(0x354)],_0x285e13(0x272),{'text':_0x8fb722,'phone':_0x178405[_0x285e13(0x1d7)]}),_0x14d1f7++),_0x178405['notifySignalEnabled']&&_0x178405[_0x285e13(0x28a)]&&(await this[_0x285e13(0x30f)](_0x178405[_0x285e13(0x28a)],_0x285e13(0x272),{'text':_0x8fb722,'phone':_0x178405['notifySignalRecipient']}),_0x14d1f7++),_0x14d1f7;}async[a0_0x21965d(0x2fc)](){const _0x3e917d=a0_0x21965d;try{const _0x5a1849=await this[_0x3e917d(0x2b0)](LTM_DP_RAW_LOG);if(_0x5a1849&&_0x5a1849[_0x3e917d(0x1e9)])this['rawEventLog']=JSON['parse'](_0x5a1849[_0x3e917d(0x1e9)]);}catch(_0x319167){this['rawEventLog']=[];}}async[a0_0x21965d(0x274)](){const _0x13a05a=a0_0x21965d;this[_0x13a05a(0x23b)]['length']>RAW_LOG_MAX_SIZE&&this[_0x13a05a(0x23b)][_0x13a05a(0x280)](0x0,this[_0x13a05a(0x23b)][_0x13a05a(0x287)]-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON['stringify'](this[_0x13a05a(0x23b)]),'ack':!![]});}async['loadDailyDigests'](){const _0x304546=a0_0x21965d;try{const _0x113c8b=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x113c8b&&_0x113c8b[_0x304546(0x1e9)])this[_0x304546(0x2f8)]=JSON[_0x304546(0x2ba)](_0x113c8b[_0x304546(0x1e9)]);}catch(_0x5a4ed9){this['dailyDigests']=[];}await this['updateBaselineStatus']();}async[a0_0x21965d(0x313)](_0x319712=!![]){const _0x15cb64=a0_0x21965d,_0x206d2a=this[_0x15cb64(0x1fb)]['ltmLtbWindowDays']||0x3c;this[_0x15cb64(0x2f8)][_0x15cb64(0x287)]>_0x206d2a&&this[_0x15cb64(0x2f8)][_0x15cb64(0x280)](0x0,this['dailyDigests'][_0x15cb64(0x287)]-_0x206d2a);await this[_0x15cb64(0x2bd)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x15cb64(0x294)](this['dailyDigests']),'ack':!![]});if(_0x319712)await this[_0x15cb64(0x2ad)]();}[a0_0x21965d(0x283)](){const _0x4107d1=a0_0x21965d;if(this[_0x4107d1(0x27e)])this[_0x4107d1(0x27e)][_0x4107d1(0x30b)]();if(!this[_0x4107d1(0x1cb)]){this[_0x4107d1(0x2bd)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}this[_0x4107d1(0x27e)]=schedule[_0x4107d1(0x24b)](LTM_SCHEDULE,()=>this['createDailyDigest']());}['setupDriftAnalysisScheduler'](){const _0x38260f=a0_0x21965d;if(this['driftAnalysisTimer'])clearInterval(this[_0x38260f(0x34f)]);if(!this['isProVersion'])return;this[_0x38260f(0x34f)]=setInterval(()=>this[_0x38260f(0x332)](),(this[_0x38260f(0x1fb)][_0x38260f(0x219)]||0x18)*0x36ee80),setTimeout(()=>this[_0x38260f(0x332)](),0x1388);}async[a0_0x21965d(0x35c)](){const _0xd03981=a0_0x21965d;await this[_0xd03981(0x2bd)](_0xd03981(0x212),{'val':_0xd03981(0x222),'ack':!![]}),await this[_0xd03981(0x2bd)]('analysis.deviationFromBaseline',{'val':this[_0xd03981(0x1cb)]?'N/A\x20(No\x20Activity)':_0xd03981(0x2ca),'ack':!![]}),await this[_0xd03981(0x2bd)]('analysis.isAlert',{'val':![],'ack':!![]}),await this[_0xd03981(0x2bd)](_0xd03981(0x305),{'val':![],'ack':!![]}),this['lastAlertState']=![];}async['updateAnalysisHistory'](_0xf4163){const _0x474d5d=a0_0x21965d;this[_0x474d5d(0x2c4)][_0x474d5d(0x220)](_0xf4163);if(this[_0x474d5d(0x2c4)][_0x474d5d(0x287)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x474d5d(0x2c4)]['pop']();await this[_0x474d5d(0x2bd)]('analysis.analysisHistory',{'val':JSON[_0x474d5d(0x294)](this['analysisHistory']),'ack':!![]});}['setupModeResetScheduler'](){const _0x4bdc45=a0_0x21965d;if(this[_0x4bdc45(0x203)])this[_0x4bdc45(0x203)][_0x4bdc45(0x30b)]();this[_0x4bdc45(0x203)]=schedule[_0x4bdc45(0x24b)](MODE_RESET_SCHEDULE,async()=>{const _0x2f4c89=_0x4bdc45;await this[_0x2f4c89(0x34e)](),AUTO_RESET_MODES[_0x2f4c89(0x2f3)](this['currentSystemMode'])&&await this[_0x2f4c89(0x2bd)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x2f4c89(0x1da)],'ack':![]});});}async[a0_0x21965d(0x2ad)](){const _0x1ddb07=a0_0x21965d;if(!this[_0x1ddb07(0x1cb)]){await this[_0x1ddb07(0x2bd)](LTM_DP_BASELINE_STATUS,{'val':_0x1ddb07(0x360),'ack':!![]});return;}const _0x36c3fb=this[_0x1ddb07(0x2f8)][_0x1ddb07(0x287)]>=(this[_0x1ddb07(0x1fb)]['minDaysForBaseline']||0x7)?'Aktiv\x20('+this['dailyDigests'][_0x1ddb07(0x287)]+_0x1ddb07(0x1e7):'Lernphase\x20('+this[_0x1ddb07(0x2f8)]['length']+'/'+(this[_0x1ddb07(0x1fb)][_0x1ddb07(0x2ef)]||0x7)+')';await this[_0x1ddb07(0x2bd)](LTM_DP_BASELINE_STATUS,{'val':_0x36c3fb,'ack':!![]});}async[a0_0x21965d(0x298)](){const _0x35073d=a0_0x21965d;await this[_0x35073d(0x2e7)](_0x35073d(0x232),{'type':_0x35073d(0x1d1),'common':{'name':_0x35073d(0x232)},'native':{}}),await this[_0x35073d(0x2e7)](LTM_DP_RAW_LOG,{'type':_0x35073d(0x238),'common':{'name':_0x35073d(0x226),'type':_0x35073d(0x1dc),'role':_0x35073d(0x228),'read':!![],'write':![]},'native':{}}),await this[_0x35073d(0x2e7)](LTM_DP_DAILY_DIGESTS,{'type':_0x35073d(0x238),'common':{'name':'Daily\x20Digests','type':_0x35073d(0x1dc),'role':_0x35073d(0x228),'read':!![],'write':![]},'native':{}}),await this[_0x35073d(0x2e7)](LTM_DP_STATUS,{'type':_0x35073d(0x238),'common':{'name':_0x35073d(0x2f0),'type':_0x35073d(0x1dc),'role':_0x35073d(0x340),'read':!![],'write':![]},'native':{}}),await this[_0x35073d(0x2e7)](LTM_DP_TRIGGER_DIGEST,{'type':_0x35073d(0x238),'common':{'name':_0x35073d(0x28e),'type':_0x35073d(0x32b),'role':_0x35073d(0x2b4),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x35073d(0x2e7)](LTM_DP_BASELINE_STATUS,{'type':_0x35073d(0x238),'common':{'name':_0x35073d(0x30c),'type':_0x35073d(0x1dc),'role':_0x35073d(0x340),'read':!![],'write':![]},'native':{}});}async[a0_0x21965d(0x276)](){const _0x51fac0=a0_0x21965d;await this['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x51fac0(0x1d1),'common':{'name':_0x51fac0(0x1f2)},'native':{}}),await this[_0x51fac0(0x2e7)](LTM_DP_DRIFT_STATUS,{'type':_0x51fac0(0x238),'common':{'name':_0x51fac0(0x267),'type':'string','role':_0x51fac0(0x238),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this[_0x51fac0(0x2e7)](LTM_DP_DRIFT_DETAILS,{'type':_0x51fac0(0x238),'common':{'name':_0x51fac0(0x237),'type':_0x51fac0(0x1dc),'role':_0x51fac0(0x340),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':'Last\x20Check','type':'number','role':_0x51fac0(0x36c),'read':!![],'write':![]},'native':{}});}async[a0_0x21965d(0x332)](){const _0x348b99=a0_0x21965d;if(!this[_0x348b99(0x1cb)]||!this['geminiModel'])return;const _0x4b9451=this[_0x348b99(0x1fb)][_0x348b99(0x1d9)]||0xe;if(this[_0x348b99(0x2f8)]['length']<_0x4b9451+(this[_0x348b99(0x1fb)]['minDaysForBaseline']||0x7)){await this[_0x348b99(0x2bd)](LTM_DP_DRIFT_STATUS,{'val':_0x348b99(0x312),'ack':!![]});return;}const _0x464409=this['dailyDigests']['slice'](-_0x4b9451),_0x81ec4e=this[_0x348b99(0x2f8)][_0x348b99(0x367)](0x0,this[_0x348b99(0x2f8)][_0x348b99(0x287)]-_0x4b9451),_0x58b579=_0x348b99(0x292)+JSON[_0x348b99(0x294)](_0x81ec4e)+'\x0a\x0aA\x20(STB):\x0a'+JSON['stringify'](_0x464409);try{const _0x1bd08e=await this[_0x348b99(0x213)][_0x348b99(0x23c)](_0x58b579),_0x1b1ede=JSON[_0x348b99(0x2ba)](_0x1bd08e[_0x348b99(0x234)][_0x348b99(0x340)]()[_0x348b99(0x1f9)](/```json|```/g,'')['trim']());_0x1b1ede['baselineDrift']&&(await this[_0x348b99(0x2bd)](LTM_DP_DRIFT_STATUS,{'val':_0x1b1ede[_0x348b99(0x295)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x1b1ede[_0x348b99(0x284)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x348b99(0x2f7)](),'ack':!![]}));}catch(_0x533706){}}async[a0_0x21965d(0x34e)](){const _0x33fecf=a0_0x21965d;try{const _0x5d1de9=await this[_0x33fecf(0x2b0)](SYSTEM_DP_MODE);_0x5d1de9&&_0x5d1de9[_0x33fecf(0x1e9)]&&Object[_0x33fecf(0x2b9)](SYSTEM_MODES)['includes'](_0x5d1de9[_0x33fecf(0x1e9)])?this['currentSystemMode']=_0x5d1de9[_0x33fecf(0x1e9)]:(this['currentSystemMode']=SYSTEM_MODES['NORMAL'],await this[_0x33fecf(0x2bd)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x3d4c17){this[_0x33fecf(0x34d)]=SYSTEM_MODES[_0x33fecf(0x1da)];}}async[a0_0x21965d(0x1d8)](){const _0x46c8e2=a0_0x21965d;try{const _0x101ab3=await this[_0x46c8e2(0x1de)](_0x46c8e2(0x27f));if(_0x101ab3&&_0x101ab3[_0x46c8e2(0x285)]&&_0x101ab3['native']['uuid'])return _0x101ab3['native'][_0x46c8e2(0x20d)];return _0x46c8e2(0x297);}catch(_0x12a702){return _0x46c8e2(0x240);}}async['checkLicense'](_0x137815){const _0x5b74b5=a0_0x21965d;if(!_0x137815)return![];this[_0x5b74b5(0x1cd)]=await this[_0x5b74b5(0x1d8)]();if(_0x137815===_0x5b74b5(0x2bf)||_0x137815['startsWith'](_0x5b74b5(0x22a)))return!![];return![];}['onUnload'](_0x3b5783){const _0x253e71=a0_0x21965d;if(this['analysisTimer'])clearInterval(this[_0x253e71(0x29e)]);if(this[_0x253e71(0x34f)])clearInterval(this['driftAnalysisTimer']);if(this['ltmJob'])this[_0x253e71(0x27e)][_0x253e71(0x30b)]();if(this[_0x253e71(0x203)])this[_0x253e71(0x203)][_0x253e71(0x30b)]();if(this[_0x253e71(0x28b)])clearTimeout(this[_0x253e71(0x28b)]);if(this['exitGraceTimer'])clearTimeout(this[_0x253e71(0x22d)]);_0x3b5783();}async[a0_0x21965d(0x20a)](_0x8ff273){const _0x572bc4=a0_0x21965d;if(typeof _0x8ff273==='object'&&_0x8ff273[_0x572bc4(0x2fa)]){if(_0x8ff273[_0x572bc4(0x288)]===_0x572bc4(0x311)){if(!_0x8ff273[_0x572bc4(0x2fa)]['apiKey'])return this[_0x572bc4(0x2e6)](_0x8ff273[_0x572bc4(0x221)],_0x8ff273[_0x572bc4(0x288)],{'success':![],'message':'No\x20Key'},_0x8ff273[_0x572bc4(0x1e1)]);try{const _0x97b5a7=new GoogleGenerativeAI(_0x8ff273[_0x572bc4(0x2fa)][_0x572bc4(0x2bb)])[_0x572bc4(0x30a)]({'model':_0x572bc4(0x2b1)});await _0x97b5a7['generateContent'](_0x572bc4(0x2f1)),this['sendTo'](_0x8ff273[_0x572bc4(0x221)],_0x8ff273['command'],{'success':!![],'message':_0x572bc4(0x225)},_0x8ff273[_0x572bc4(0x1e1)]);}catch(_0x57fc04){this['sendTo'](_0x8ff273[_0x572bc4(0x221)],_0x8ff273['command'],{'success':![],'message':_0x57fc04['message']},_0x8ff273['callback']);}}else{if(_0x8ff273['command']==='testNotification'){const _0x30c9a6=await this['sendNotification']('[Test]\x20Notification',!![]);this[_0x572bc4(0x2e6)](_0x8ff273[_0x572bc4(0x221)],_0x8ff273[_0x572bc4(0x288)],{'success':_0x30c9a6>0x0,'message':_0x30c9a6+'\x20sent'},_0x8ff273[_0x572bc4(0x1e1)]);}else{if(_0x8ff273['command']===_0x572bc4(0x338)){if(!this[_0x572bc4(0x1cb)])return this[_0x572bc4(0x2e6)](_0x8ff273['from'],_0x8ff273['command'],{'success':![],'isPro':![]},_0x8ff273[_0x572bc4(0x1e1)]);let _0x4d10ac={'status':_0x572bc4(0x323),'details':'','lastCheck':0x0};try{_0x4d10ac['status']=(await this[_0x572bc4(0x2b0)](LTM_DP_DRIFT_STATUS))[_0x572bc4(0x1e9)],_0x4d10ac[_0x572bc4(0x341)]=(await this['getStateAsync'](LTM_DP_DRIFT_DETAILS))[_0x572bc4(0x1e9)],_0x4d10ac[_0x572bc4(0x209)]=(await this[_0x572bc4(0x2b0)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0xc918ee){}this[_0x572bc4(0x2e6)](_0x8ff273['from'],_0x8ff273[_0x572bc4(0x288)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x4d10ac,'analysisHistory':this['analysisHistory']},_0x8ff273['callback']);}else{if(_0x8ff273['command']===_0x572bc4(0x2c0)){const _0x1e598a=await this[_0x572bc4(0x2f4)](_0x572bc4(0x23e),_0x572bc4(0x2fe)),_0x1abc0f=[];if(_0x1e598a)for(const _0x55f22a in _0x1e598a){const _0x5d096c=_0x1e598a[_0x55f22a],_0x1cd0a3=(_0x5d096c['common']&&typeof _0x5d096c['common'][_0x572bc4(0x33e)]===_0x572bc4(0x216)?_0x5d096c[_0x572bc4(0x1d5)][_0x572bc4(0x33e)]['de']:_0x5d096c[_0x572bc4(0x1d5)][_0x572bc4(0x33e)])||_0x5d096c[_0x572bc4(0x1d5)][_0x572bc4(0x33e)];_0x1abc0f['push']({'id':_0x55f22a,'name':_0x1cd0a3});}this['sendTo'](_0x8ff273[_0x572bc4(0x221)],_0x8ff273[_0x572bc4(0x288)],{'success':!![],'enums':_0x1abc0f},_0x8ff273['callback']);}else{if(_0x8ff273[_0x572bc4(0x288)]===_0x572bc4(0x2a1))try{const _0x5bdb73=await this['scanForDevices'](_0x8ff273['message']||{});this[_0x572bc4(0x2e6)](_0x8ff273[_0x572bc4(0x221)],_0x8ff273[_0x572bc4(0x288)],{'success':!![],'devices':_0x5bdb73},_0x8ff273[_0x572bc4(0x1e1)]);}catch(_0x2f3014){this[_0x572bc4(0x2e6)](_0x8ff273[_0x572bc4(0x221)],_0x8ff273[_0x572bc4(0x288)],{'success':![],'error':_0x2f3014[_0x572bc4(0x2fa)]},_0x8ff273['callback']);}else{if(_0x8ff273[_0x572bc4(0x288)]===_0x572bc4(0x2b2)){const {historyId:_0x29af92,rating:_0x5a4389,comment:_0x4cb7da,alertReason:_0x30c9e9}=_0x8ff273[_0x572bc4(0x2fa)];_0x29af92&&_0x5a4389?(await this[_0x572bc4(0x265)]({'timestamp':Date[_0x572bc4(0x2f7)](),'historyId':_0x29af92,'rating':_0x5a4389,'comment':_0x4cb7da,'alertReason':_0x30c9e9}),this[_0x572bc4(0x2e6)](_0x8ff273['from'],_0x8ff273[_0x572bc4(0x288)],{'success':!![]},_0x8ff273['callback'])):this[_0x572bc4(0x2e6)](_0x8ff273[_0x572bc4(0x221)],_0x8ff273[_0x572bc4(0x288)],{'success':![],'error':_0x572bc4(0x369)},_0x8ff273[_0x572bc4(0x1e1)]);}}}}}}}}}if(require['main']!==module)module[a0_0x21965d(0x1ee)]=_0x25e7b5=>new CogniLiving(_0x25e7b5);else new CogniLiving();