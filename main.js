const a0_0x5b5ac2=a0_0x53b4;(function(_0x41236a,_0x3c94b0){const _0x3e838a=a0_0x53b4,_0x2b005d=_0x41236a();while(!![]){try{const _0x9a322e=parseInt(_0x3e838a(0x1c0))/0x1*(parseInt(_0x3e838a(0x1ee))/0x2)+-parseInt(_0x3e838a(0x14f))/0x3*(-parseInt(_0x3e838a(0x20a))/0x4)+parseInt(_0x3e838a(0x158))/0x5+parseInt(_0x3e838a(0x168))/0x6+parseInt(_0x3e838a(0x16b))/0x7*(parseInt(_0x3e838a(0x2bc))/0x8)+-parseInt(_0x3e838a(0x232))/0x9*(-parseInt(_0x3e838a(0x2b4))/0xa)+-parseInt(_0x3e838a(0x229))/0xb;if(_0x9a322e===_0x3c94b0)break;else _0x2b005d['push'](_0x2b005d['shift']());}catch(_0x252fd3){_0x2b005d['push'](_0x2b005d['shift']());}}}(a0_0x8cc6,0xdbdfb));const a0_0x357b4c=(function(){let _0xc0fe3d=!![];return function(_0x11223b,_0x44e46e){const _0x2abcdf=_0xc0fe3d?function(){const _0x33472b=a0_0x53b4;if(_0x44e46e){const _0x3134e7=_0x44e46e[_0x33472b(0x1c4)](_0x11223b,arguments);return _0x44e46e=null,_0x3134e7;}}:function(){};return _0xc0fe3d=![],_0x2abcdf;};}()),a0_0x2cab33=a0_0x357b4c(this,function(){const _0x268ab6=a0_0x53b4;return a0_0x2cab33[_0x268ab6(0x1e6)]()[_0x268ab6(0x1f1)]('(((.+)+)+)+$')[_0x268ab6(0x1e6)]()[_0x268ab6(0x2ce)](a0_0x2cab33)[_0x268ab6(0x1f1)](_0x268ab6(0x182));});a0_0x2cab33();function a0_0x53b4(_0x28628d,_0xa3226c){const _0x3cbdd6=a0_0x8cc6();return a0_0x53b4=function(_0x2cab33,_0x357b4c){_0x2cab33=_0x2cab33-0x137;let _0x8cc6ff=_0x3cbdd6[_0x2cab33];return _0x8cc6ff;},a0_0x53b4(_0x28628d,_0xa3226c);}function a0_0x8cc6(){const _0x3d47ea=['User\x20Feedback:\x20Alarm\x20\x22','wind','initSystemConfig','PRO-','analysis.isEmergency','Creating\x20Daily\x20Digest\x20from\x20','events.history_debug_03','some','lastCheck','online','driftDetails','date','testContext','summary','notifyTelegramRecipient','System\x20Status\x20&\x20Control','Scanning\x20for\x20devices\x20(Smart\x20Naming\x20v3\x20Recursive)...','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','type','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','geminiApiKey','apiKey','stateChange','subscribeStates','createAllObjects','startsWith','initHistory','\x20sent','Schlafzimmer','indicator','getForeignStateAsync','checkLicense','error','unload','Sleep\x20Score\x20(0-100)','1AKxDlq','LTM.rawEventLog','onUnload','Urlaub','apply','join','text','value.health','instance','analysis.health.restlessness','weather','number','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','Baseline\x20Status','geminiModel','analysisHistory','command','üö®üö®\x20NOTFALL','latitude','createDailyDigest','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.','events.lastEvent','checkWifiPresence','subscribeForeignStatesAsync','Daily\x20Digest\x20created\x20successfully.','analysis.history_debug_01','runGeminiAnalysis','Reset\x20Sched\x20Error:\x20','ALARM','analysis.history_debug_02','Flur','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','notifyTelegramEnabled','channel','initPresenceSubscriptions','notes','daswetter','calendarSelection','toString','inactivityMonitoringEnabled','[TEST]\x20','time','Subscribing\x20to\x20','config','useCalendar','analysis.trigger','3340938MslSLm','setHours','suggestion','search','RSSI','models/gemini-flash-latest','garten','switch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','forecast','extendObjectAsync','bind','automationProposal','updateAnalysisHistory','enum','getCalendarNames','string','weatherInstance','isAlert','notifySignalRecipient','system.isPresent','getSystemUUID','Error\x20reading\x20calendar\x20table:\x20','eventHistory','openweathermap.0','briefingTime','system.mode','54584CJVIDn','K√ºche','replace','toLowerCase','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','includes','catch','substring','group','notifyPushoverRecipient','.INSTALL_TEST','sendTo','Raw\x20Log','licenseKey','.\x20PR√ÑSENZ:\x20','party','echarts.','node-schedule','uuid-error','Drift\x20Analysis','enum.functions.*','b√ºro','Aktiv\x20(','Restlessness\x20Level','LTM','N/A\x20(Learning)','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','isArray','custom','Wetter:\x20Deaktiviert','pop','53298553TuJxQE','from','.NextHours.Location_1.Day_1.current.symbol_desc','update','submitFeedback','common','analysis.comfortSuggestion','checkLtmObjects','send','5828436aMewGO','isPresent','Sending\x20notification:\x20\x22','trim','@iobroker/adapter-core','rollladen','processSensorEvent','text.alarm','longitude','accuweather','Briefing\x20Sched\x20Error:\x20','lampe','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20','getGenerativeModel','LTM.driftAnalysis.lastCheck','thermostat','boolean','UNREACH','Feedback\x20Log','\x20|\x20','ltmLtbWindowDays','analysis.automation.description','baselineDrift','name','analysis.triggerBriefing','guest','Party','callback','Trigger\x20Digest','ical.0','generic','Comfort\x20Suggestion','map','STICKY_UNREACH','System\x20Mode','systemUUID','checkLtmDriftObjects','LTM.driftAnalysis.baselineDrift','wohn','analysis.automation.suggestedAction','Pattern\x20Detected','events.history_debug_02','Last\x20Check','cogni-living\x20adapter\x20starting\x20(v','ltmStbWindowDays','scanDevices','WETTER:\x20','Last\x20Result','dailyDigests','\x20(EMERGENCY)','k√ºche','saveRawEventLog','accuweather.0','deviationFromBaseline','onMessage','briefingEnabled','Error\x20checking\x20WiFi:\x20','LTM\x20Sched\x20Error:\x20','notifyEmailInstance','_calName','de-DE','\x20Tage)','motion','scanForDevices','location','modeResetJob','Logbook','sleepScore','lights','activityLevel','Analysiere\x20Tag...','stringify','Deviation','\x20raw\x20events...','KALENDER:\x20Keine\x20Daten','push','getForeignObjectsAsync','WETTER\x20ERROR:\x20',')\x20-\x20OBFUSCATION\x20SAFE\x20MODE','analysisTimer','city','analysis.lastResult','Normal','notifyTelegramInstance','checkSystemObjects','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','.forecast.current.state','message','find','analysis.analysisHistory','status','WETTER:\x20Keine\x20Daten\x20gefunden','triggerDailyDigest','Deaktiviert\x20(Pro-Feature)','sensor','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','Processing\x20Status','License\x20Check\x20failed:\x20','analysis.health.notes','system.','.data.table','onStateChange','now','PARTY','retry','ERROR','lock','role','json','events.history_debug_04','analysis.activitySummary','\x0aFEEDBACK:\x0a','door','health','getCalendarNames\x20Error:\x20','fenster','native','LTM.driftAnalysis.driftDetails','getWeatherContext','generateContent','genAI','uuid-not-found','getCalendarContext','setPresence','\x20min).\x20Watchdog\x20Limit:\x20','notifyEmailEnabled','\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}','Alert\x20Reason','state','test','10DCgWLd','Action','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','timestamp','Daily\x20Digest\x20Error:\x20','tryParse','startExitTimer','indicator.alarm','8USMlaS','response','Error\x20in\x20onMessage\x20command\x20','contact','bewegung','expire','ack','comfort','vis.','info','NORMAL','openweathermap','setState','enum.rooms.*','events.history_debug_00','setupDriftAnalysisScheduler','lastAlertState','cancel','constructor','analysis.automation','cogni-living','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','Gast','DUTYCYCLE','CONFIG_PENDING','all_lights','analysis.health.sleepScore','.SECTION','LTM.driftAnalysis','No\x20recorded\x20events\x20yet.','button','schalter','abortExitTimer','exitTimer','getObjectAsync','analysis.automation.patternDetected','isExit','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','system','values','sensorLastValues','analysisInterval','splice','history','Analysis\x20Error:\x20','_score','scene','Cogni-Living\x20Alert','ltmJob','uuid','bad','logDuplicates','sendNotification','restlessness','window','driftAnalysisTimer','üö®\x20EMERGENCY','setStateAsync','isGracePeriodActive','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20','Presence\x20Status','\x20*\x20*\x20*','flur','GUEST','history.','inactivityThresholdHours','No\x20instance','filter','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','getStateAsync','analysis.deviationFromBaseline','Success','briefingJob','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','.TEST','loadSystemMode','slice','analysis.isAlert','icon','saveDailyDigests','split','Feedback\x20saved:\x20','Health\x20Notes','initSensorSubscriptions','event','saveFeedback','.\x20ORT:\x20','notifyWhatsappRecipient','KALENDER:\x20','wetter','Comfort\x20Summary','temp','analysis.comfortSummary','Gemini\x20AI\x20initialized.','lastIndexOf','write','exports','aiPersona','notifyWhatsappInstance','length','getForeignObjectAsync','admin.','flot.','Drift\x20Details','2-digit','loadRawEventLog','firmware','battery','sort','parse','Morning\x20Briefing\x20sent.','Badezimmer','presenceDevices','204YoeUPy','\x20sensors...','.Summary.Current','events.history','toISOString','description','icons-mfd.','alertReason','version','933340JCqlAb','feedbackHistory','initZombies','object','updateBaselineStatus','details','log','unshift','blind','scheduleJob','members','sendToAsync','setObjectNotExistsAsync','systemConfig','exitGraceTimer','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','3645720HIVaUM','isProVersion','DIRECTION','11939459euviDj','analysis.history_debug_03','suggestedAction','AI\x20Alert\x20Status','vacation','pressure','doors','minDaysForBaseline','getEnums','notifySignalInstance','setupBriefingScheduler','üåÖ\x20Daily\x20Briefing:\x0a','Daily\x20Digests','\x20presence\x20devices...','AI\x20Emergency\x20Status','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','Trigger\x20Analysis','light','sendMorningBriefing','LTM.baselineStatus','Kalender:\x20Deaktiviert','currentSystemMode','Description','(((.+)+)+)+$','notifySignalEnabled','licht','sound','Drift\x20Status','material.','humidity','runBaselineDriftAnalysis','rawEventLog','Starting\x20Autopilot\x20(','daswetter.0','N/A','devices','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}','setupLtmScheduler','activity','analysis.feedbackHistory','siren','VACATION','Adapter','temperature','on/off','analysis.history_debug_04','KALENDER\x20ERROR:\x20','Wohnzimmer','calendarInstance','val'];a0_0x8cc6=function(){return _0x3d47ea;};return a0_0x8cc6();}'use strict';const utils=require(a0_0x5b5ac2(0x236)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x5b5ac2(0x21b)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x5b5ac2(0x1f3),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x5b5ac2(0x1c1),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x5b5ac2(0x17e),LTM_DP_DRIFT_CHANNEL=a0_0x5b5ac2(0x2d8),LTM_DP_DRIFT_STATUS=a0_0x5b5ac2(0x257),LTM_DP_DRIFT_DETAILS=a0_0x5b5ac2(0x2a7),LTM_DP_DRIFT_LAST_CHECK=a0_0x5b5ac2(0x240),SYSTEM_DP_MODE=a0_0x5b5ac2(0x209),IGNORE_TERMS=[a0_0x5b5ac2(0x243),'LOWBAT',a0_0x5b5ac2(0x1f2),a0_0x5b5ac2(0x29b),'FAULT','SABOTAGE',a0_0x5b5ac2(0x1dc),a0_0x5b5ac2(0x2d4),a0_0x5b5ac2(0x2d3),'WORKING',a0_0x5b5ac2(0x16a),a0_0x5b5ac2(0x253),a0_0x5b5ac2(0x22c),a0_0x5b5ac2(0x148),a0_0x5b5ac2(0x157),'connection',a0_0x5b5ac2(0x2c5),'signal',a0_0x5b5ac2(0x149),a0_0x5b5ac2(0x2ea),a0_0x5b5ac2(0x212),a0_0x5b5ac2(0x2d5),a0_0x5b5ac2(0x2d7),a0_0x5b5ac2(0x306),a0_0x5b5ac2(0x214),a0_0x5b5ac2(0x137),a0_0x5b5ac2(0x1ca),a0_0x5b5ac2(0x1f8),a0_0x5b5ac2(0x1aa),a0_0x5b5ac2(0x30a),a0_0x5b5ac2(0x19e),a0_0x5b5ac2(0x170),'uv',a0_0x5b5ac2(0x2e7)],ADAPTER_BLACKLIST=[a0_0x5b5ac2(0x295),a0_0x5b5ac2(0x143),'info.',a0_0x5b5ac2(0x2c4),a0_0x5b5ac2(0x2fc),a0_0x5b5ac2(0x187),a0_0x5b5ac2(0x155),a0_0x5b5ac2(0x144),a0_0x5b5ac2(0x21a)],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x5b5ac2(0x16f),'PARTY':a0_0x5b5ac2(0x219),'GUEST':a0_0x5b5ac2(0x24b)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x5b5ac2(0x299)],SYSTEM_MODES[a0_0x5b5ac2(0x2fb)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x5b5ac2(0x1f7),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','family':a0_0x5b5ac2(0x167),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':a0_0x5b5ac2(0x1ae)};class CogniLiving extends utils[a0_0x5b5ac2(0x195)]{constructor(_0x21fff7){const _0x168e84=a0_0x5b5ac2;super({..._0x21fff7,'name':_0x168e84(0x2d0)}),this[_0x168e84(0x206)]=[],this[_0x168e84(0x1cf)]=[],this[_0x168e84(0x159)]=[],this[_0x168e84(0x18a)]=[],this[_0x168e84(0x262)]=[],this[_0x168e84(0x2e4)]={},this[_0x168e84(0x165)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x168e84(0x2dd)]=null,this['exitGraceTimer']=null,this[_0x168e84(0x2f6)]=![],this[_0x168e84(0x2aa)]=null,this[_0x168e84(0x1ce)]=null,this[_0x168e84(0x180)]=SYSTEM_MODES[_0x168e84(0x2c6)],this[_0x168e84(0x169)]=![],this[_0x168e84(0x2cc)]=![],this[_0x168e84(0x255)]='unknown',this['analysisTimer']=null,this[_0x168e84(0x2ec)]=null,this[_0x168e84(0x273)]=null,this[_0x168e84(0x2f3)]=null,this[_0x168e84(0x304)]=null,this['on']('ready',this['onReady'][_0x168e84(0x1fa)](this)),this['on'](_0x168e84(0x1b3),this[_0x168e84(0x297)]['bind'](this)),this['on'](_0x168e84(0x1be),this[_0x168e84(0x1c2)][_0x168e84(0x1fa)](this)),this['on'](_0x168e84(0x289),this[_0x168e84(0x268)][_0x168e84(0x1fa)](this));}async['onReady'](){const _0x37cd50=a0_0x5b5ac2;this['log'][_0x37cd50(0x2c5)](_0x37cd50(0x25d)+this[_0x37cd50(0x157)]+_0x37cd50(0x280)),await this[_0x37cd50(0x15a)](),this[_0x37cd50(0x1eb)][_0x37cd50(0x217)]=this[_0x37cd50(0x1eb)]['licenseKey']||'';try{this[_0x37cd50(0x169)]=await this[_0x37cd50(0x1bc)](this[_0x37cd50(0x1eb)][_0x37cd50(0x217)]);}catch(_0x46b7ec){this[_0x37cd50(0x15e)]['error'](_0x37cd50(0x293)+_0x46b7ec[_0x37cd50(0x289)]);}if(!this[_0x37cd50(0x1eb)][_0x37cd50(0x2fd)]||this['config'][_0x37cd50(0x2fd)]<0.1)this[_0x37cd50(0x1eb)][_0x37cd50(0x2fd)]=0xc;await this[_0x37cd50(0x1b7)](),await this[_0x37cd50(0x19f)]();if(this[_0x37cd50(0x1eb)]['geminiApiKey'])try{this[_0x37cd50(0x2aa)]=new GoogleGenerativeAI(this[_0x37cd50(0x1eb)][_0x37cd50(0x1b1)]),this[_0x37cd50(0x1ce)]=this[_0x37cd50(0x2aa)][_0x37cd50(0x23f)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x37cd50(0x15e)][_0x37cd50(0x2c5)](_0x37cd50(0x13b));}catch(_0x140732){this[_0x37cd50(0x15e)][_0x37cd50(0x1bd)]('Gemini\x20Init\x20Error:\x20'+_0x140732[_0x37cd50(0x289)]);}await this[_0x37cd50(0x1b5)](),await this['loadSystemMode'](),await this[_0x37cd50(0x147)](),await this['loadDailyDigests'](),this[_0x37cd50(0x1b4)](_0x37cd50(0x1ed)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x37cd50(0x1b4)](_0x37cd50(0x209)),this[_0x37cd50(0x1b4)](_0x37cd50(0x24a)),await this[_0x37cd50(0x30f)](),await this['initPresenceSubscriptions']();if(this[_0x37cd50(0x281)])clearInterval(this[_0x37cd50(0x281)]);const _0x3a6ef8=this['config'][_0x37cd50(0x2e5)]||0xf;_0x3a6ef8>0x0&&(this[_0x37cd50(0x15e)]['info'](_0x37cd50(0x18b)+_0x3a6ef8+_0x37cd50(0x2ae)+this['config']['inactivityThresholdHours']+'h.'),this[_0x37cd50(0x281)]=setInterval(()=>{this['runAutopilot']();},_0x3a6ef8*0x3c*0x3e8)),this[_0x37cd50(0x190)](),this['setupModeResetScheduler'](),this[_0x37cd50(0x2cb)](),this[_0x37cd50(0x175)]();}[a0_0x5b5ac2(0x1c2)](_0x103d98){const _0x47dae3=a0_0x5b5ac2;if(this[_0x47dae3(0x281)])clearInterval(this[_0x47dae3(0x281)]);if(this[_0x47dae3(0x2f3)])clearInterval(this[_0x47dae3(0x2f3)]);if(this[_0x47dae3(0x2ec)])this['ltmJob']['cancel']();if(this['modeResetJob'])this['modeResetJob']['cancel']();if(this[_0x47dae3(0x304)])this['briefingJob']['cancel']();if(this['exitTimer'])clearTimeout(this[_0x47dae3(0x2dd)]);if(this[_0x47dae3(0x166)])clearTimeout(this[_0x47dae3(0x166)]);_0x103d98();}async[a0_0x5b5ac2(0x297)](_0x5529d2,_0x870ba0){const _0x10fea0=a0_0x5b5ac2;if(!_0x870ba0)return;if(_0x5529d2===this['namespace']+'.'+SYSTEM_DP_MODE){_0x870ba0[_0x10fea0(0x19c)]&&Object[_0x10fea0(0x2e3)](SYSTEM_MODES)['includes'](_0x870ba0[_0x10fea0(0x19c)])&&(this[_0x10fea0(0x180)]=_0x870ba0[_0x10fea0(0x19c)],_0x870ba0[_0x10fea0(0x19c)]===SYSTEM_MODES[_0x10fea0(0x194)]?await this['setPresence'](![]):await this[_0x10fea0(0x2ad)](!![]));if(!_0x870ba0[_0x10fea0(0x2c2)])this[_0x10fea0(0x2c8)](_0x5529d2,{'val':this[_0x10fea0(0x180)],'ack':!![]});return;}if(!_0x870ba0['ack']){_0x5529d2[_0x10fea0(0x20f)](_0x10fea0(0x1ed))&&_0x870ba0['val']&&(this[_0x10fea0(0x2c8)](_0x5529d2,{'val':![],'ack':!![]}),this[_0x10fea0(0x1da)]());if(_0x5529d2[_0x10fea0(0x20f)](_0x10fea0(0x28e))&&_0x870ba0[_0x10fea0(0x19c)]){this[_0x10fea0(0x2c8)](_0x5529d2,{'val':![],'ack':!![]});if(this[_0x10fea0(0x169)])this[_0x10fea0(0x1d3)]();}_0x5529d2[_0x10fea0(0x20f)]('triggerBriefing')&&_0x870ba0[_0x10fea0(0x19c)]&&(this[_0x10fea0(0x2c8)](_0x5529d2,{'val':![],'ack':!![]}),this[_0x10fea0(0x17d)]());return;}if(this[_0x10fea0(0x1eb)][_0x10fea0(0x14e)]&&this['config'][_0x10fea0(0x14e)]['includes'](_0x5529d2)){await this[_0x10fea0(0x1d6)]();return;}const _0x10bb4c=(this['config'][_0x10fea0(0x18e)]||[])[_0x10fea0(0x28a)](_0x416da9=>_0x416da9['id']===_0x5529d2);if(_0x10bb4c)this[_0x10fea0(0x238)](_0x5529d2,_0x870ba0,_0x10bb4c);}async[a0_0x5b5ac2(0x268)](_0x576779){const _0x5d6dd7=a0_0x5b5ac2;if(typeof _0x576779===_0x5d6dd7(0x15b)&&_0x576779[_0x5d6dd7(0x289)])try{if(_0x576779['command']==='testApiKey'){if(!_0x576779[_0x5d6dd7(0x289)]['apiKey'])return this['sendTo'](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':![],'message':'No\x20Key'},_0x576779[_0x5d6dd7(0x24d)]);try{const _0x25d568=new GoogleGenerativeAI(_0x576779['message'][_0x5d6dd7(0x1b2)])[_0x5d6dd7(0x23f)]({'model':_0x5d6dd7(0x1f3)});await _0x25d568[_0x5d6dd7(0x2a9)](_0x5d6dd7(0x2b3)),this[_0x5d6dd7(0x215)](_0x576779['from'],_0x576779[_0x5d6dd7(0x1d0)],{'success':!![],'message':_0x5d6dd7(0x303)},_0x576779['callback']);}catch(_0x10384e){this['sendTo'](_0x576779[_0x5d6dd7(0x22a)],_0x576779['command'],{'success':![],'message':_0x10384e[_0x5d6dd7(0x289)]},_0x576779[_0x5d6dd7(0x24d)]);}}else{if(_0x576779[_0x5d6dd7(0x1d0)]==='testNotification'){const _0x197a7c=await this[_0x5d6dd7(0x2f0)]('[Test]\x20Notification',!![]);this[_0x5d6dd7(0x215)](_0x576779[_0x5d6dd7(0x22a)],_0x576779['command'],{'success':_0x197a7c>0x0,'message':_0x197a7c+_0x5d6dd7(0x1b8)},_0x576779['callback']);}else{if(_0x576779['command']==='getLtmData'){if(!this[_0x5d6dd7(0x169)])return this['sendTo'](_0x576779[_0x5d6dd7(0x22a)],_0x576779['command'],{'success':![],'isPro':![]},_0x576779[_0x5d6dd7(0x24d)]);let _0x48f620={'status':_0x5d6dd7(0x18d),'details':'','lastCheck':0x0};try{_0x48f620[_0x5d6dd7(0x28c)]=(await this[_0x5d6dd7(0x301)](LTM_DP_DRIFT_STATUS))['val'],_0x48f620[_0x5d6dd7(0x15d)]=(await this[_0x5d6dd7(0x301)](LTM_DP_DRIFT_DETAILS))[_0x5d6dd7(0x19c)],_0x48f620[_0x5d6dd7(0x1a5)]=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x5d6dd7(0x19c)];}catch(_0x64dd3f){}this[_0x5d6dd7(0x215)](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x5d6dd7(0x262)],'driftAnalysis':_0x48f620,'analysisHistory':this[_0x5d6dd7(0x1cf)]},_0x576779[_0x5d6dd7(0x24d)]);}else{if(_0x576779[_0x5d6dd7(0x1d0)]===_0x5d6dd7(0x173)){const _0x16a5e0=await this[_0x5d6dd7(0x27e)](_0x5d6dd7(0x21e),_0x5d6dd7(0x1fd)),_0xd65901=[];if(_0x16a5e0)for(const _0x3565af in _0x16a5e0){const _0x7826a0=_0x16a5e0[_0x3565af],_0x3e7600=(_0x7826a0['common']&&typeof _0x7826a0[_0x5d6dd7(0x22e)][_0x5d6dd7(0x249)]===_0x5d6dd7(0x15b)?_0x7826a0[_0x5d6dd7(0x22e)][_0x5d6dd7(0x249)]['de']:_0x7826a0[_0x5d6dd7(0x22e)]['name'])||_0x7826a0[_0x5d6dd7(0x22e)][_0x5d6dd7(0x249)];_0xd65901[_0x5d6dd7(0x27d)]({'id':_0x3565af,'name':_0x3e7600});}this[_0x5d6dd7(0x215)](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':!![],'enums':_0xd65901},_0x576779[_0x5d6dd7(0x24d)]);}else{if(_0x576779['command']===_0x5d6dd7(0x25f))try{const _0x593cac=await this[_0x5d6dd7(0x271)](_0x576779[_0x5d6dd7(0x289)]||{});this[_0x5d6dd7(0x215)](_0x576779['from'],_0x576779[_0x5d6dd7(0x1d0)],{'success':!![],'devices':_0x593cac},_0x576779[_0x5d6dd7(0x24d)]);}catch(_0x956be7){this[_0x5d6dd7(0x215)](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':![],'error':_0x956be7[_0x5d6dd7(0x289)]},_0x576779[_0x5d6dd7(0x24d)]);}else{if(_0x576779['command']===_0x5d6dd7(0x22d)){const {historyId:_0x4746f2,rating:_0x54f293,comment:_0x4e5bb6,alertReason:_0x4c7770}=_0x576779['message'];_0x4746f2&&_0x54f293?(await this[_0x5d6dd7(0x311)]({'timestamp':Date[_0x5d6dd7(0x298)](),'historyId':_0x4746f2,'rating':_0x54f293,'comment':_0x4e5bb6,'alertReason':_0x4c7770}),this[_0x5d6dd7(0x215)](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':!![]},_0x576779[_0x5d6dd7(0x24d)])):this[_0x5d6dd7(0x215)](_0x576779[_0x5d6dd7(0x22a)],_0x576779['command'],{'success':![],'error':'Missing\x20data'},_0x576779[_0x5d6dd7(0x24d)]);}else{if(_0x576779[_0x5d6dd7(0x1d0)]===_0x5d6dd7(0x1a9)){const _0x12ae93=await this[_0x5d6dd7(0x2a8)](),_0xd2c7d3=await this['getCalendarContext']();this['sendTo'](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':!![],'weather':_0x12ae93,'calendar':_0xd2c7d3},_0x576779[_0x5d6dd7(0x24d)]);}else{if(_0x576779[_0x5d6dd7(0x1d0)]==='getCalendarNames'){const _0x4c6664=_0x576779[_0x5d6dd7(0x289)][_0x5d6dd7(0x1c8)];if(!_0x4c6664)return this[_0x5d6dd7(0x215)](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':![],'error':_0x5d6dd7(0x2fe)},_0x576779['callback']);const _0x3d3f01=await this[_0x5d6dd7(0x1fe)](_0x4c6664);this[_0x5d6dd7(0x215)](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':!![],'names':_0x3d3f01},_0x576779[_0x5d6dd7(0x24d)]);}}}}}}}}}catch(_0x5e437a){this['log'][_0x5d6dd7(0x1bd)](_0x5d6dd7(0x2be)+_0x576779[_0x5d6dd7(0x1d0)]+':\x20'+_0x5e437a['message']);if(_0x576779[_0x5d6dd7(0x24d)])this['sendTo'](_0x576779[_0x5d6dd7(0x22a)],_0x576779[_0x5d6dd7(0x1d0)],{'success':![],'error':_0x5e437a[_0x5d6dd7(0x289)]},_0x576779[_0x5d6dd7(0x24d)]);}}async['processSensorEvent'](_0x500c4e,_0xb123d4,_0x32f953){const _0x531549=a0_0x5b5ac2;if(!_0x32f953[_0x531549(0x2ef)]&&this[_0x531549(0x2e4)][_0x500c4e]===_0xb123d4[_0x531549(0x19c)])return;this['sensorLastValues'][_0x500c4e]=_0xb123d4['val'];if(this[_0x531549(0x2f6)])return;const _0x13707a=await this[_0x531549(0x1d6)]();if(_0x13707a){if(!this[_0x531549(0x233)])await this[_0x531549(0x2ad)](!![]);}else{const _0x19ba56=_0x32f953[_0x531549(0x2e0)]===!![];_0x19ba56?this['startExitTimer']():(this[_0x531549(0x2dd)]&&(this[_0x531549(0x15e)][_0x531549(0x2c5)](_0x531549(0x224)),this[_0x531549(0x2dc)]()),!this[_0x531549(0x233)]&&this[_0x531549(0x180)]===SYSTEM_MODES[_0x531549(0x2c6)]&&await this['setPresence'](!![]));}const _0x409ec1={'timestamp':_0xb123d4['ts'],'id':_0x500c4e,'name':_0x32f953['name'],'value':_0xb123d4[_0x531549(0x19c)],'location':_0x32f953[_0x531549(0x272)],'type':_0x32f953['type']};this['eventHistory']['unshift'](_0x409ec1);if(this[_0x531549(0x206)]['length']>HISTORY_MAX_SIZE)this[_0x531549(0x206)][_0x531549(0x228)]();await this['setStateAsync'](_0x531549(0x1d5),{'val':JSON[_0x531549(0x279)](_0x409ec1),'ack':!![]}),await this[_0x531549(0x2f5)](_0x531549(0x152),{'val':JSON[_0x531549(0x279)](this['eventHistory']),'ack':!![]}),this['rawEventLog'][_0x531549(0x27d)]({'timestamp':new Date(_0xb123d4['ts'])[_0x531549(0x153)](),'sensorName':_0x32f953[_0x531549(0x249)],'location':_0x32f953[_0x531549(0x272)],'value':_0xb123d4[_0x531549(0x19c)]}),await this[_0x531549(0x265)]();}async['runAutopilot'](){const _0x5310e2=a0_0x5b5ac2,_0x4d6362=this['config'][_0x5310e2(0x2fd)],_0x18f083=this[_0x5310e2(0x1eb)][_0x5310e2(0x1e7)],_0x12a748=this[_0x5310e2(0x206)][_0x5310e2(0x141)]>0x0?this['eventHistory'][0x0][_0x5310e2(0x2b7)]:Date[_0x5310e2(0x298)](),_0x5e02fa=(Date[_0x5310e2(0x298)]()-_0x12a748)/(0x3e8*0x3c*0x3c);let _0x10a6a4='';_0x18f083&&this['currentSystemMode']===SYSTEM_MODES[_0x5310e2(0x2c6)]&&this[_0x5310e2(0x233)]&&(_0x5e02fa>_0x4d6362&&(_0x10a6a4=_0x5310e2(0x300)+_0x5e02fa['toFixed'](0x1)+_0x5310e2(0x305)));if(_0x10a6a4){this[_0x5310e2(0x1da)](_0x10a6a4)[_0x5310e2(0x210)](_0x411ae0=>this[_0x5310e2(0x15e)]['error'](_0x411ae0));return;}const _0x57622a=Date[_0x5310e2(0x298)](),_0x22ae29=_0x57622a-_0x12a748,_0x51be63=(this[_0x5310e2(0x1eb)][_0x5310e2(0x2e5)]||0xf)*0x3c*0x3e8;this[_0x5310e2(0x206)][_0x5310e2(0x141)]>0x0&&_0x22ae29<=_0x51be63?this[_0x5310e2(0x1da)]()[_0x5310e2(0x210)](_0x574269=>this[_0x5310e2(0x15e)]['error'](_0x574269)):!this[_0x5310e2(0x2cc)]&&(this[_0x5310e2(0x2c8)](_0x5310e2(0x309),{'val':![],'ack':!![]}),this[_0x5310e2(0x2c8)]('analysis.isEmergency',{'val':![],'ack':!![]}));}async['runGeminiAnalysis'](_0x27dcb6=''){const _0x2af5a5=a0_0x5b5ac2;if(!this[_0x2af5a5(0x1ce)])return;const _0x5334df=this[_0x2af5a5(0x206)]['length']>0x0?this['eventHistory']:[{'note':_0x2af5a5(0x2d9)}],_0x41e8a3=PERSONA_MAPPING[this[_0x2af5a5(0x1eb)][_0x2af5a5(0x13f)]||_0x2af5a5(0x250)],_0x14d8d8=this[_0x2af5a5(0x1eb)]['livingContext']||'',_0x5c20b5=this[_0x2af5a5(0x180)],_0x8492bd=await this[_0x2af5a5(0x2a8)](),_0x5e6d4d=await this[_0x2af5a5(0x2ac)](),_0x4bee40=(_0x8492bd+'\x20'+_0x5e6d4d)[_0x2af5a5(0x235)](),_0x17f559=new Date(),_0x467a43=_0x17f559['toLocaleString'](_0x2af5a5(0x26e),{'weekday':'long','hour':_0x2af5a5(0x146),'minute':_0x2af5a5(0x146)}),_0x532e98=this[_0x2af5a5(0x165)];let _0x5e54dc='';if(this[_0x2af5a5(0x159)][_0x2af5a5(0x141)]>0x0){const _0x150c28=this['feedbackHistory'][_0x2af5a5(0x308)](0x0,0x3)[_0x2af5a5(0x252)](_0x539e64=>_0x2af5a5(0x19d)+_0x539e64['alertReason']+'\x22\x20was\x20'+_0x539e64['rating']+'.')[_0x2af5a5(0x1c5)]('\x0a');_0x5e54dc=_0x2af5a5(0x2a1)+_0x150c28+'\x0a';}const _0x4289f1=_0x27dcb6?'\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a'+_0x27dcb6+_0x2af5a5(0x2e1):'',_0x12d2f1='Baseline:\x20Inactive\x20(Pro\x20Feature).',_0x5c7e64=_0x2af5a5(0x291)+_0x467a43+_0x2af5a5(0x312)+_0x532e98['city']+_0x2af5a5(0x287)+_0x5c20b5+_0x2af5a5(0x218)+(this[_0x2af5a5(0x233)]?'Ja':'Nein')+_0x2af5a5(0x1b0)+_0x14d8d8+'.\x20PERSONA:\x20'+_0x41e8a3+_0x2af5a5(0x2d1)+_0x4bee40+_0x2af5a5(0x1f6)+_0x12d2f1+'\x20'+_0x5e54dc+'\x20'+_0x4289f1+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20'+JSON[_0x2af5a5(0x279)](_0x5334df)+_0x2af5a5(0x18f);try{const _0x5153af=await this[_0x2af5a5(0x1ce)]['generateContent'](_0x5c7e64),_0x3fff5c=_0x5153af[_0x2af5a5(0x2bd)][_0x2af5a5(0x1c6)]()[_0x2af5a5(0x20c)](/```json|```/g,'')[_0x2af5a5(0x235)](),_0x2d7b81=JSON['parse'](_0x3fff5c);await this['setStateAsync'](_0x2af5a5(0x283),{'val':_0x3fff5c,'ack':!![]}),await this['setStateAsync']('analysis.alertReason',{'val':_0x2d7b81['activity'][_0x2af5a5(0x156)]||'','ack':!![]}),await this[_0x2af5a5(0x2f5)](_0x2af5a5(0x2a0),{'val':_0x2d7b81[_0x2af5a5(0x191)]['summary']||_0x2af5a5(0x18d),'ack':!![]}),await this[_0x2af5a5(0x2f5)](_0x2af5a5(0x302),{'val':_0x2d7b81[_0x2af5a5(0x191)][_0x2af5a5(0x267)]||_0x2af5a5(0x18d),'ack':!![]});_0x2d7b81[_0x2af5a5(0x2c3)]&&(await this[_0x2af5a5(0x2f5)](_0x2af5a5(0x13a),{'val':_0x2d7b81[_0x2af5a5(0x2c3)][_0x2af5a5(0x1aa)]||'','ack':!![]}),await this['setStateAsync'](_0x2af5a5(0x22f),{'val':_0x2d7b81[_0x2af5a5(0x2c3)][_0x2af5a5(0x1f0)]||'','ack':!![]}),_0x2d7b81['comfort'][_0x2af5a5(0x1fb)]&&(await this[_0x2af5a5(0x2f5)]('analysis.automation.patternDetected',{'val':_0x2d7b81['comfort'][_0x2af5a5(0x1fb)]['patternDetected']||![],'ack':!![]}),await this[_0x2af5a5(0x2f5)](_0x2af5a5(0x247),{'val':_0x2d7b81['comfort'][_0x2af5a5(0x1fb)][_0x2af5a5(0x154)]||'','ack':!![]}),await this[_0x2af5a5(0x2f5)]('analysis.automation.suggestedAction',{'val':_0x2d7b81[_0x2af5a5(0x2c3)][_0x2af5a5(0x1fb)][_0x2af5a5(0x16d)]||'','ack':!![]})));_0x2d7b81[_0x2af5a5(0x2a3)]&&(await this[_0x2af5a5(0x2f5)](_0x2af5a5(0x2d6),{'val':typeof _0x2d7b81['health']['sleepScore']===_0x2af5a5(0x1cb)?_0x2d7b81[_0x2af5a5(0x2a3)][_0x2af5a5(0x275)]:0x0,'ack':!![]}),await this['setStateAsync'](_0x2af5a5(0x1c9),{'val':_0x2d7b81[_0x2af5a5(0x2a3)][_0x2af5a5(0x2f1)]||'none','ack':!![]}),await this[_0x2af5a5(0x2f5)]('analysis.health.notes',{'val':_0x2d7b81[_0x2af5a5(0x2a3)][_0x2af5a5(0x1e3)]||'','ack':!![]}));const _0x36df12=_0x2d7b81[_0x2af5a5(0x191)][_0x2af5a5(0x201)]||![],_0x3bd5f0=_0x2d7b81['activity']['isEmergency']||![];if(_0x36df12||_0x3bd5f0){await this[_0x2af5a5(0x2f5)]('analysis.isAlert',{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x2af5a5(0x1a1),{'val':_0x3bd5f0,'ack':!![]});if(!this[_0x2af5a5(0x2cc)]||_0x3bd5f0){const _0x1424de=_0x3bd5f0?_0x2af5a5(0x1d1):'‚ö†Ô∏è\x20Alarm';this[_0x2af5a5(0x2f0)](_0x1424de+':\x20'+_0x2d7b81['activity'][_0x2af5a5(0x156)],![],_0x3bd5f0);}}else await this[_0x2af5a5(0x2f5)](_0x2af5a5(0x309),{'val':![],'ack':!![]}),await this[_0x2af5a5(0x2f5)](_0x2af5a5(0x1a1),{'val':![],'ack':!![]});this['lastAlertState']=_0x36df12||_0x3bd5f0;const _0x4da156={'timestamp':Date['now'](),'id':Date[_0x2af5a5(0x298)]()[_0x2af5a5(0x1e6)](),'analysis':_0x2d7b81,'systemMode':_0x5c20b5,'isPro':this[_0x2af5a5(0x169)]};this[_0x2af5a5(0x1fc)](_0x4da156);}catch(_0x2b8eb8){this['log']['error'](_0x2af5a5(0x2e8)+_0x2b8eb8[_0x2af5a5(0x289)]);}}async[a0_0x5b5ac2(0x1d3)](){const _0x1b3cba=a0_0x5b5ac2;if(!this['geminiModel']||this[_0x1b3cba(0x18a)][_0x1b3cba(0x141)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x1b3cba(0x2b6),'ack':!![]});return;}this['log']['info'](_0x1b3cba(0x1a2)+this[_0x1b3cba(0x18a)][_0x1b3cba(0x141)]+_0x1b3cba(0x27b)),await this[_0x1b3cba(0x2f5)](LTM_DP_STATUS,{'val':_0x1b3cba(0x278),'ack':!![]});const _0x4fb837=this[_0x1b3cba(0x18a)][_0x1b3cba(0x141)]>0x320?this[_0x1b3cba(0x18a)][_0x1b3cba(0x308)](this[_0x1b3cba(0x18a)]['length']-0x320):this[_0x1b3cba(0x18a)],_0xdf58bb=PERSONA_MAPPING[this[_0x1b3cba(0x1eb)]['aiPersona']||_0x1b3cba(0x250)],_0x441f7e='ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20'+_0xdf58bb+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20'+JSON[_0x1b3cba(0x279)](_0x4fb837)+_0x1b3cba(0x2b0);try{const _0x4b1b14=await this[_0x1b3cba(0x1ce)]['generateContent'](_0x441f7e),_0x391f65=_0x4b1b14[_0x1b3cba(0x2bd)][_0x1b3cba(0x1c6)]()[_0x1b3cba(0x20c)](/```json|```/g,'')[_0x1b3cba(0x235)](),_0x24ab1f=JSON[_0x1b3cba(0x14b)](_0x391f65),_0x4559c5={'timestamp':new Date()['toISOString'](),'eventCount':this[_0x1b3cba(0x18a)][_0x1b3cba(0x141)],'summary':_0x24ab1f['summary'],'activityLevel':_0x24ab1f[_0x1b3cba(0x277)],'health':{'sleepScore':_0x24ab1f['health']?_0x24ab1f[_0x1b3cba(0x2a3)][_0x1b3cba(0x275)]:0x0,'restlessness':_0x24ab1f['health']?_0x24ab1f['health']['restlessness']:'none'},'systemMode':this[_0x1b3cba(0x180)]};this[_0x1b3cba(0x262)]['push'](_0x4559c5),await this[_0x1b3cba(0x30b)](),this['rawEventLog']=[],await this[_0x1b3cba(0x265)](),await this[_0x1b3cba(0x2f5)](LTM_DP_STATUS,{'val':_0x1b3cba(0x20e),'ack':!![]}),this[_0x1b3cba(0x15e)][_0x1b3cba(0x2c5)](_0x1b3cba(0x1d8));}catch(_0x5d2919){this[_0x1b3cba(0x15e)][_0x1b3cba(0x1bd)](_0x1b3cba(0x2b8)+_0x5d2919['message']),await this['setStateAsync'](LTM_DP_STATUS,{'val':'Fehler:\x20'+_0x5d2919[_0x1b3cba(0x289)],'ack':!![]});}}async[a0_0x5b5ac2(0x17d)](){const _0x6f5a9c=a0_0x5b5ac2;if(!this[_0x6f5a9c(0x1ce)])return;this[_0x6f5a9c(0x15e)]['info']('Generating\x20Morning\x20Briefing...');const _0x1f6469=this[_0x6f5a9c(0x262)][_0x6f5a9c(0x141)]>0x0?this[_0x6f5a9c(0x262)][this[_0x6f5a9c(0x262)][_0x6f5a9c(0x141)]-0x1]:null,_0x2f5916=_0x1f6469&&_0x1f6469[_0x6f5a9c(0x2a3)]?_0x1f6469[_0x6f5a9c(0x2a3)][_0x6f5a9c(0x275)]:_0x6f5a9c(0x18d),_0x512c47=new Date();_0x512c47[_0x6f5a9c(0x1ef)](0x4,0x0,0x0,0x0);const _0x4a9f29=this[_0x6f5a9c(0x206)][_0x6f5a9c(0x2ff)](_0x521ce4=>new Date(_0x521ce4[_0x6f5a9c(0x2b7)])>_0x512c47),_0x20d36f=PERSONA_MAPPING[this[_0x6f5a9c(0x1eb)][_0x6f5a9c(0x13f)]||_0x6f5a9c(0x250)],_0x3533d9=this[_0x6f5a9c(0x1eb)]['livingContext']||'',_0x2ca47e=await this[_0x6f5a9c(0x2a8)](),_0x43c3b7=await this[_0x6f5a9c(0x2ac)](),_0x51b4c0=_0x6f5a9c(0x23e)+_0x20d36f+_0x6f5a9c(0x17a)+_0x3533d9+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20'+_0x2ca47e+'\x20'+_0x43c3b7+_0x6f5a9c(0x2f7)+_0x2f5916+'/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20'+JSON[_0x6f5a9c(0x279)](_0x4a9f29[_0x6f5a9c(0x308)](0x0,0xa))+_0x6f5a9c(0x1d4);try{const _0x135622=await this[_0x6f5a9c(0x1ce)]['generateContent'](_0x51b4c0),_0x1713ea=_0x6f5a9c(0x176)+_0x135622[_0x6f5a9c(0x2bd)][_0x6f5a9c(0x1c6)]()[_0x6f5a9c(0x235)]();this[_0x6f5a9c(0x2f0)](_0x1713ea),this['log']['info'](_0x6f5a9c(0x14c));}catch(_0x603fef){this[_0x6f5a9c(0x15e)]['error']('Briefing\x20Error:\x20'+_0x603fef[_0x6f5a9c(0x289)]);}}async[a0_0x5b5ac2(0x271)](_0x46b568){const _0x4dc702=a0_0x5b5ac2;this[_0x4dc702(0x15e)][_0x4dc702(0x2c5)](_0x4dc702(0x1ad));const _0x13b135=[],_0x3e71c8=await this[_0x4dc702(0x27e)]('*'),_0x378041=await this[_0x4dc702(0x27e)](_0x4dc702(0x2c9),_0x4dc702(0x1fd)),_0x399354={};if(_0x378041)for(const _0x2b2c70 in _0x378041){const _0x2b69a4=_0x378041[_0x2b2c70][_0x4dc702(0x22e)][_0x4dc702(0x162)];if(_0x2b69a4&&Array[_0x4dc702(0x225)](_0x2b69a4)){const _0x518f85=typeof _0x378041[_0x2b2c70][_0x4dc702(0x22e)][_0x4dc702(0x249)]==='object'?_0x378041[_0x2b2c70][_0x4dc702(0x22e)]['name']['de']:_0x378041[_0x2b2c70]['common'][_0x4dc702(0x249)];for(const _0x3970c4 of _0x2b69a4){_0x399354[_0x3970c4]=_0x518f85;}}}const _0x26fc2f=await this[_0x4dc702(0x27e)]('enum.functions.*',_0x4dc702(0x1fd)),_0x46cd69={};if(_0x26fc2f)for(const _0x197c97 in _0x26fc2f){const _0x490931=_0x26fc2f[_0x197c97]['common']['members'],_0x4f0550=_0x197c97['split']('.')[_0x4dc702(0x228)]()[_0x4dc702(0x20d)]();if(_0x490931&&Array[_0x4dc702(0x225)](_0x490931))for(const _0x326df0 of _0x490931){if(!_0x46cd69[_0x326df0])_0x46cd69[_0x326df0]=[];_0x46cd69[_0x326df0][_0x4dc702(0x27d)](_0x4f0550);}}const _0x4d700a=_0x46b568['selectedFunctionIds']||[],_0x5e16e2=_0x46b568[_0x4dc702(0x270)]!==![],_0x2248f8=_0x46b568[_0x4dc702(0x171)]!==![],_0x326d0d=_0x46b568[_0x4dc702(0x276)]!==![],_0x5e5fb4=_0x46b568[_0x4dc702(0x196)]===!![],_0x5b474d=_0x46b568['weather']===!![];for(const _0x50bdb3 in _0x3e71c8){const _0x256edc=_0x3e71c8[_0x50bdb3];if(_0x256edc[_0x4dc702(0x1af)]!==_0x4dc702(0x2b2))continue;if(!_0x256edc[_0x4dc702(0x22e)])continue;if(ADAPTER_BLACKLIST[_0x4dc702(0x1a4)](_0x519a62=>_0x50bdb3[_0x4dc702(0x1b6)](_0x519a62))){if(!_0x5b474d)continue;}const _0x2690aa=(_0x256edc[_0x4dc702(0x22e)][_0x4dc702(0x29d)]||'')[_0x4dc702(0x20d)]();let _0x489966=(typeof _0x256edc[_0x4dc702(0x22e)][_0x4dc702(0x249)]===_0x4dc702(0x15b)?_0x256edc[_0x4dc702(0x22e)][_0x4dc702(0x249)]['de']:_0x256edc[_0x4dc702(0x22e)][_0x4dc702(0x249)])||_0x50bdb3,_0x333ad0=_0x50bdb3,_0x5352ea='';for(let _0x3e1e92=0x0;_0x3e1e92<0x4;_0x3e1e92++){const _0x18b0d0=_0x333ad0[_0x4dc702(0x13c)]('.');if(_0x18b0d0===-0x1)break;_0x333ad0=_0x333ad0[_0x4dc702(0x211)](0x0,_0x18b0d0);if(_0x333ad0['split']('.')[_0x4dc702(0x141)]<0x2)break;const _0x1f2ac5=_0x3e71c8[_0x333ad0];if(_0x1f2ac5&&_0x1f2ac5[_0x4dc702(0x22e)]&&_0x1f2ac5[_0x4dc702(0x22e)]['name']){let _0x44d659=typeof _0x1f2ac5[_0x4dc702(0x22e)][_0x4dc702(0x249)]===_0x4dc702(0x15b)?_0x1f2ac5['common'][_0x4dc702(0x249)]['de']:_0x1f2ac5[_0x4dc702(0x22e)][_0x4dc702(0x249)];if(typeof _0x44d659===_0x4dc702(0x1ff)&&_0x44d659['trim']()){const _0x5be94b=_0x333ad0['split']('.')[_0x4dc702(0x228)](),_0x1db1c7=_0x44d659[_0x4dc702(0x20d)]()[_0x4dc702(0x235)]();_0x1db1c7!==_0x5be94b[_0x4dc702(0x20d)]()['trim']()&&!_0x1db1c7[_0x4dc702(0x20f)](_0x4dc702(0x1e1))&&!_0x1db1c7[_0x4dc702(0x20f)]('device')&&(_0x5352ea=_0x44d659);}}}_0x5352ea&&typeof _0x5352ea===_0x4dc702(0x1ff)&&(!_0x489966[_0x4dc702(0x20d)]()[_0x4dc702(0x20f)](_0x5352ea['toLowerCase']())&&(_0x489966=_0x5352ea+'\x20'+_0x489966));const _0x4a270b=_0x489966['toLowerCase'](),_0x2383b9=_0x46cd69[_0x50bdb3]||[];let _0x3839c0=![],_0x4a78bd=![];if(_0x4d700a[_0x4dc702(0x141)]>0x0)for(const _0x2c15de of _0x4d700a){if(_0x26fc2f[_0x2c15de]&&_0x26fc2f[_0x2c15de]['common'][_0x4dc702(0x162)]){const _0x44ec1f=_0x26fc2f[_0x2c15de][_0x4dc702(0x22e)][_0x4dc702(0x162)];if(_0x44ec1f['includes'](_0x50bdb3)||_0x44ec1f[_0x4dc702(0x1a4)](_0x4b2632=>_0x50bdb3[_0x4dc702(0x1b6)](_0x4b2632+'.'))){_0x3839c0=!![],_0x4a78bd=!![];break;}}}if(!_0x3839c0&&!_0x5b474d){if(IGNORE_TERMS['some'](_0x4dd8f6=>_0x50bdb3['toUpperCase']()['includes'](_0x4dd8f6)||_0x4a270b[_0x4dc702(0x20f)](_0x4dd8f6[_0x4dc702(0x20d)]()))){if(!_0x2690aa[_0x4dc702(0x20f)](_0x4dc702(0x270))&&!_0x2690aa['includes']('door')&&!_0x2690aa['includes'](_0x4dc702(0x1f5)))continue;}}let _0x92fdcf='';if(_0x5e16e2){if(_0x2690aa['includes'](_0x4dc702(0x270))||_0x2690aa==='sensor.alarm'||_0x2383b9[_0x4dc702(0x1a4)](_0x422303=>_0x422303[_0x4dc702(0x20f)]('motion')||_0x422303[_0x4dc702(0x20f)]('security')))_0x92fdcf='motion';else{if(_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x2c0))||_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x270))||_0x4a270b[_0x4dc702(0x20f)]('presence'))_0x92fdcf=_0x4dc702(0x270);}}if(!_0x92fdcf&&_0x2248f8){if(_0x2690aa[_0x4dc702(0x20f)](_0x4dc702(0x2a2))||_0x2690aa[_0x4dc702(0x20f)](_0x4dc702(0x2f2))||_0x2690aa[_0x4dc702(0x20f)](_0x4dc702(0x29c))||_0x2690aa[_0x4dc702(0x20f)](_0x4dc702(0x160))||_0x2383b9[_0x4dc702(0x1a4)](_0x40f0a3=>_0x40f0a3['includes']('window')||_0x40f0a3[_0x4dc702(0x20f)](_0x4dc702(0x2a2))||_0x40f0a3[_0x4dc702(0x20f)](_0x4dc702(0x29c))))_0x92fdcf=_0x4dc702(0x2a2);else{if(_0x4a270b['includes'](_0x4dc702(0x2a5))||_0x4a270b['includes']('t√ºr')||_0x4a270b[_0x4dc702(0x20f)]('door')||_0x4a270b[_0x4dc702(0x20f)]('window')||_0x4a270b['includes'](_0x4dc702(0x2bf))||_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x237))||_0x4a270b[_0x4dc702(0x20f)]('shutter')||_0x4a270b[_0x4dc702(0x20f)]('blind'))_0x92fdcf=_0x4dc702(0x2a2);}}if(!_0x92fdcf&&_0x326d0d){if(_0x2690aa['includes']('light')||_0x2690aa[_0x4dc702(0x20f)](_0x4dc702(0x1f5))||_0x2690aa[_0x4dc702(0x20f)]('dimmer')||_0x2383b9[_0x4dc702(0x1a4)](_0xd4144d=>_0xd4144d[_0x4dc702(0x20f)](_0x4dc702(0x17c)))){if(_0x256edc['common']['write']||_0x2690aa[_0x4dc702(0x20f)](_0x4dc702(0x290)))_0x92fdcf=_0x4dc702(0x17c);}else{if(_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x184))||_0x4a270b['includes'](_0x4dc702(0x17c))||_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x23d))||_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x2db))||_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x197))){if(_0x256edc[_0x4dc702(0x22e)][_0x4dc702(0x13d)])_0x92fdcf=_0x4dc702(0x17c);}}}if(!_0x92fdcf&&_0x5e5fb4){if(_0x2690aa[_0x4dc702(0x20f)]('temperature')||_0x2690aa[_0x4dc702(0x20f)](_0x4dc702(0x188))||_0x2690aa[_0x4dc702(0x20f)]('thermostat'))_0x92fdcf='temperature';else{if(_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x139))||_0x4a270b[_0x4dc702(0x20f)]('klima')||_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x241)))_0x92fdcf=_0x4dc702(0x196);}}!_0x92fdcf&&_0x4a78bd&&(_0x92fdcf=_0x4dc702(0x226));if(_0x92fdcf){let _0x2f5caa=_0x399354[_0x50bdb3]||'';if(!_0x2f5caa){let _0x5c8961=_0x50bdb3;for(let _0x4028ad=0x0;_0x4028ad<0x3;_0x4028ad++){const _0x53b0c2=_0x5c8961[_0x4dc702(0x13c)]('.');if(_0x53b0c2===-0x1)break;_0x5c8961=_0x5c8961['substring'](0x0,_0x53b0c2);if(_0x399354[_0x5c8961]){_0x2f5caa=_0x399354[_0x5c8961];break;}}}if(!_0x2f5caa){if(_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x2ee)))_0x2f5caa=_0x4dc702(0x14d);else{if(_0x4a270b['includes'](_0x4dc702(0x264)))_0x2f5caa=_0x4dc702(0x20b);else{if(_0x4a270b['includes'](_0x4dc702(0x258)))_0x2f5caa=_0x4dc702(0x19a);else{if(_0x4a270b[_0x4dc702(0x20f)]('schlaf'))_0x2f5caa=_0x4dc702(0x1b9);else{if(_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x2fa))||_0x4a270b[_0x4dc702(0x20f)]('diele'))_0x2f5caa=_0x4dc702(0x1de);else{if(_0x4a270b[_0x4dc702(0x20f)](_0x4dc702(0x1f4)))_0x2f5caa='Garten';else{if(_0x4a270b['includes'](_0x4dc702(0x21f)))_0x2f5caa='B√ºro';}}}}}}}_0x13b135['push']({'id':_0x50bdb3,'name':_0x489966,'location':_0x2f5caa,'type':_0x92fdcf,'logDuplicates':_0x92fdcf===_0x4dc702(0x270),'isExit':![],'_score':_0x2f5caa?0x50:_0x92fdcf==='custom'?0x5a:0x28});}}return _0x13b135[_0x4dc702(0x14a)]((_0x253061,_0x5f45b3)=>_0x5f45b3[_0x4dc702(0x2e9)]-_0x253061[_0x4dc702(0x2e9)]),_0x13b135;}[a0_0x5b5ac2(0x2b9)](_0x478925){if(typeof _0x478925==='object')return _0x478925;try{return JSON['parse'](_0x478925);}catch(_0x251303){return null;}}async[a0_0x5b5ac2(0x15a)](){const _0x43dce0=a0_0x5b5ac2;try{const _0x31c16c=['analysis.history_debug_00',_0x43dce0(0x1d9),_0x43dce0(0x1dd),_0x43dce0(0x16c),_0x43dce0(0x198),_0x43dce0(0x2ca),'events.history_debug_01',_0x43dce0(0x25b),_0x43dce0(0x1a3),_0x43dce0(0x29f)];for(const _0x35186c of _0x31c16c){try{const _0x194439=await this[_0x43dce0(0x2de)](_0x35186c);_0x194439&&await this['delObjectAsync'](_0x35186c);}catch(_0x4049c9){}}}catch(_0x317b11){}}async[a0_0x5b5ac2(0x1b7)](){const _0x21e8bb=a0_0x5b5ac2;try{const _0x4fdc23=await this[_0x21e8bb(0x301)](_0x21e8bb(0x152));_0x4fdc23&&_0x4fdc23[_0x21e8bb(0x19c)]&&(this[_0x21e8bb(0x206)]=JSON[_0x21e8bb(0x14b)](_0x4fdc23['val'][_0x21e8bb(0x1e6)]()));}catch(_0x226b8e){this[_0x21e8bb(0x206)]=[];}try{const _0x2ca38f=await this[_0x21e8bb(0x301)](_0x21e8bb(0x28b));if(_0x2ca38f&&_0x2ca38f[_0x21e8bb(0x19c)])this['analysisHistory']=JSON[_0x21e8bb(0x14b)](_0x2ca38f['val']['toString']());}catch(_0x238f1f){this['analysisHistory']=[];}}async['initSystemConfig'](){const _0x24d59b=a0_0x5b5ac2;try{const _0x306d45=await this[_0x24d59b(0x142)]('system.config');_0x306d45&&_0x306d45['common']&&(this[_0x24d59b(0x165)]={'latitude':_0x306d45[_0x24d59b(0x22e)][_0x24d59b(0x1d2)]||0x0,'longitude':_0x306d45['common'][_0x24d59b(0x23a)]||0x0,'city':_0x306d45['common'][_0x24d59b(0x282)]||''});}catch(_0x6a42b){}}async[a0_0x5b5ac2(0x1bc)](_0x50d5c5){const _0x586498=a0_0x5b5ac2;if(!_0x50d5c5)return![];this[_0x586498(0x255)]=await this[_0x586498(0x204)]();if(_0x50d5c5==='TEST-PRO-KEY'||_0x50d5c5[_0x586498(0x1b6)](_0x586498(0x1a0)))return!![];return![];}async['getSystemUUID'](){const _0x39a4f1=a0_0x5b5ac2;try{const _0x2e9d8a=await this[_0x39a4f1(0x142)]('system.meta.uuid');if(_0x2e9d8a&&_0x2e9d8a['native']&&_0x2e9d8a['native'][_0x39a4f1(0x2ed)])return _0x2e9d8a[_0x39a4f1(0x2a6)]['uuid'];return _0x39a4f1(0x2ab);}catch(_0x349ca8){return _0x39a4f1(0x21c);}}async[a0_0x5b5ac2(0x1b5)](){const _0x5ec804=a0_0x5b5ac2;try{await this[_0x5ec804(0x286)](),await this['setObjectNotExistsAsync'](_0x5ec804(0x203),{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x2f8),'type':_0x5ec804(0x242),'role':_0x5ec804(0x1ba),'read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x5ec804(0x164)]('events.lastEvent',{'type':_0x5ec804(0x2b2),'common':{'name':'Last\x20raw\x20event','type':_0x5ec804(0x1ff),'role':_0x5ec804(0x29e),'read':!![],'write':![]},'native':{}}),await this[_0x5ec804(0x164)]('events.history',{'type':_0x5ec804(0x2b2),'common':{'name':'Event\x20History','type':_0x5ec804(0x1ff),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x5ec804(0x164)]('analysis.trigger',{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x17b),'type':_0x5ec804(0x242),'role':_0x5ec804(0x2da),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x5ec804(0x164)](_0x5ec804(0x24a),{'type':_0x5ec804(0x2b2),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x5ec804(0x242),'role':_0x5ec804(0x2da),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.lastResult',{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x261),'type':_0x5ec804(0x1ff),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x5ec804(0x164)](_0x5ec804(0x309),{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x16e),'type':_0x5ec804(0x242),'role':_0x5ec804(0x2bb),'read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x5ec804(0x1a1),{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x179),'type':_0x5ec804(0x242),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x5ec804(0x164)]('analysis.alertReason',{'type':'state','common':{'name':_0x5ec804(0x2b1),'type':_0x5ec804(0x1ff),'role':_0x5ec804(0x239),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.activitySummary',{'type':_0x5ec804(0x2b2),'common':{'name':'Activity\x20Summary','type':_0x5ec804(0x1ff),'role':_0x5ec804(0x1c6),'read':!![],'write':![]},'native':{}}),await this[_0x5ec804(0x164)](_0x5ec804(0x302),{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x27a),'type':'string','role':_0x5ec804(0x2b2),'read':!![],'write':![],'def':_0x5ec804(0x18d)},'native':{}}),await this[_0x5ec804(0x164)]('analysis.comfortSummary',{'type':'state','common':{'name':_0x5ec804(0x138),'type':_0x5ec804(0x1ff),'role':_0x5ec804(0x1c6),'read':!![],'write':![]},'native':{}}),await this[_0x5ec804(0x164)]('analysis.comfortSuggestion',{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x251),'type':_0x5ec804(0x1ff),'role':_0x5ec804(0x1c6),'read':!![],'write':![]},'native':{}}),await this[_0x5ec804(0x1f9)](_0x5ec804(0x2cf),{'type':_0x5ec804(0x1e1),'common':{'name':'Automation\x20Proposals'},'native':{}}),await this[_0x5ec804(0x164)](_0x5ec804(0x2df),{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x25a),'type':_0x5ec804(0x242),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x5ec804(0x164)](_0x5ec804(0x247),{'type':'state','common':{'name':_0x5ec804(0x181),'type':_0x5ec804(0x1ff),'role':'text','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x5ec804(0x259),{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x2b5),'type':_0x5ec804(0x1ff),'role':_0x5ec804(0x1c6),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x5ec804(0x28b),{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x274),'type':_0x5ec804(0x1ff),'role':_0x5ec804(0x29e),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x5ec804(0x164)](_0x5ec804(0x192),{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x244),'type':_0x5ec804(0x1ff),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this['extendObjectAsync']('analysis.health',{'type':_0x5ec804(0x1e1),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await this[_0x5ec804(0x164)]('analysis.health.sleepScore',{'type':_0x5ec804(0x2b2),'common':{'name':_0x5ec804(0x1bf),'type':_0x5ec804(0x1cb),'role':_0x5ec804(0x1c7),'read':!![],'write':![],'def':0x0},'native':{}}),await this[_0x5ec804(0x164)](_0x5ec804(0x1c9),{'type':'state','common':{'name':_0x5ec804(0x221),'type':_0x5ec804(0x1ff),'role':_0x5ec804(0x1c6),'read':!![],'write':![],'def':'none'},'native':{}}),await this[_0x5ec804(0x164)](_0x5ec804(0x294),{'type':'state','common':{'name':_0x5ec804(0x30e),'type':'string','role':'text','read':!![],'write':![],'def':''},'native':{}}),await this[_0x5ec804(0x230)](),await this['checkLtmDriftObjects']();}catch(_0x4c3b6e){this['log'][_0x5ec804(0x1bd)]('Error\x20creating\x20objects:\x20'+_0x4c3b6e[_0x5ec804(0x289)]);}}async[a0_0x5b5ac2(0x286)](){const _0x1ffc1a=a0_0x5b5ac2;await this['extendObjectAsync'](_0x1ffc1a(0x2e2),{'type':'channel','common':{'name':_0x1ffc1a(0x1ac)},'native':{}}),await this[_0x1ffc1a(0x1f9)](SYSTEM_DP_MODE,{'type':_0x1ffc1a(0x2b2),'common':{'name':_0x1ffc1a(0x254),'type':_0x1ffc1a(0x1ff),'role':_0x1ffc1a(0x2b2),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x1ffc1a(0x2c6)],'states':{[SYSTEM_MODES[_0x1ffc1a(0x2c6)]]:_0x1ffc1a(0x284),[SYSTEM_MODES['VACATION']]:_0x1ffc1a(0x1c3),[SYSTEM_MODES['PARTY']]:_0x1ffc1a(0x24c),[SYSTEM_MODES[_0x1ffc1a(0x2fb)]]:_0x1ffc1a(0x2d2)}},'native':{}});}async[a0_0x5b5ac2(0x230)](){const _0x42ddb7=a0_0x5b5ac2;await this[_0x42ddb7(0x1f9)](_0x42ddb7(0x222),{'type':_0x42ddb7(0x1e1),'common':{'name':_0x42ddb7(0x222)},'native':{}}),await this[_0x42ddb7(0x1f9)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x42ddb7(0x216),'type':'string','role':_0x42ddb7(0x29e),'read':!![],'write':![]},'native':{}}),await this[_0x42ddb7(0x1f9)](LTM_DP_DAILY_DIGESTS,{'type':_0x42ddb7(0x2b2),'common':{'name':_0x42ddb7(0x177),'type':_0x42ddb7(0x1ff),'role':_0x42ddb7(0x29e),'read':!![],'write':![]},'native':{}}),await this[_0x42ddb7(0x1f9)](LTM_DP_STATUS,{'type':_0x42ddb7(0x2b2),'common':{'name':_0x42ddb7(0x292),'type':_0x42ddb7(0x1ff),'role':_0x42ddb7(0x1c6),'read':!![],'write':![]},'native':{}}),await this[_0x42ddb7(0x1f9)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x42ddb7(0x24e),'type':_0x42ddb7(0x242),'role':_0x42ddb7(0x2da),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x42ddb7(0x1f9)](LTM_DP_BASELINE_STATUS,{'type':_0x42ddb7(0x2b2),'common':{'name':_0x42ddb7(0x1cd),'type':_0x42ddb7(0x1ff),'role':_0x42ddb7(0x1c6),'read':!![],'write':![]},'native':{}});}async[a0_0x5b5ac2(0x256)](){const _0x1f9a76=a0_0x5b5ac2;await this[_0x1f9a76(0x1f9)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x1f9a76(0x21d)},'native':{}}),await this[_0x1f9a76(0x1f9)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x1f9a76(0x186),'type':_0x1f9a76(0x1ff),'role':_0x1f9a76(0x2b2),'read':!![],'write':![],'def':_0x1f9a76(0x18d)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x1f9a76(0x2b2),'common':{'name':_0x1f9a76(0x145),'type':_0x1f9a76(0x1ff),'role':_0x1f9a76(0x1c6),'read':!![],'write':![]},'native':{}}),await this[_0x1f9a76(0x1f9)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':_0x1f9a76(0x25c),'type':_0x1f9a76(0x1cb),'role':'date','read':!![],'write':![]},'native':{}});}async[a0_0x5b5ac2(0x307)](){const _0x31e4fe=a0_0x5b5ac2;try{const _0x2ac53d=await this['getStateAsync'](SYSTEM_DP_MODE);_0x2ac53d&&_0x2ac53d[_0x31e4fe(0x19c)]&&Object[_0x31e4fe(0x2e3)](SYSTEM_MODES)[_0x31e4fe(0x20f)](_0x2ac53d['val'])?this[_0x31e4fe(0x180)]=_0x2ac53d[_0x31e4fe(0x19c)]:(this[_0x31e4fe(0x180)]=SYSTEM_MODES[_0x31e4fe(0x2c6)],await this['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x31e4fe(0x2c6)],'ack':!![]}));}catch(_0x2b71db){this['currentSystemMode']=SYSTEM_MODES['NORMAL'];}}async['loadRawEventLog'](){const _0xead7bd=a0_0x5b5ac2;try{const _0x5a5286=await this[_0xead7bd(0x301)](LTM_DP_RAW_LOG);if(_0x5a5286&&_0x5a5286[_0xead7bd(0x19c)])this[_0xead7bd(0x18a)]=JSON['parse'](_0x5a5286[_0xead7bd(0x19c)]);}catch(_0xb9075){this[_0xead7bd(0x18a)]=[];}}async['loadDailyDigests'](){const _0x98d8f7=a0_0x5b5ac2;try{const _0x15e7a3=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x15e7a3&&_0x15e7a3[_0x98d8f7(0x19c)])this[_0x98d8f7(0x262)]=JSON[_0x98d8f7(0x14b)](_0x15e7a3[_0x98d8f7(0x19c)]);}catch(_0x3977d5){this['dailyDigests']=[];}await this[_0x98d8f7(0x15c)]();}async['saveRawEventLog'](){const _0x3aad04=a0_0x5b5ac2;this[_0x3aad04(0x18a)][_0x3aad04(0x141)]>RAW_LOG_MAX_SIZE&&this['rawEventLog']['splice'](0x0,this[_0x3aad04(0x18a)][_0x3aad04(0x141)]-RAW_LOG_MAX_SIZE),await this[_0x3aad04(0x2f5)](LTM_DP_RAW_LOG,{'val':JSON[_0x3aad04(0x279)](this[_0x3aad04(0x18a)]),'ack':!![]});}async[a0_0x5b5ac2(0x30b)](_0x485b9d=!![]){const _0x46c070=a0_0x5b5ac2,_0x15e3b4=this[_0x46c070(0x1eb)][_0x46c070(0x246)]||0x3c;this[_0x46c070(0x262)][_0x46c070(0x141)]>_0x15e3b4&&this['dailyDigests'][_0x46c070(0x2e6)](0x0,this[_0x46c070(0x262)][_0x46c070(0x141)]-_0x15e3b4);await this[_0x46c070(0x2f5)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x46c070(0x279)](this[_0x46c070(0x262)]),'ack':!![]});if(_0x485b9d)await this[_0x46c070(0x15c)]();}async['updateAnalysisHistory'](_0x5808d2){const _0x14ac9f=a0_0x5b5ac2;this['analysisHistory'][_0x14ac9f(0x15f)](_0x5808d2);if(this[_0x14ac9f(0x1cf)][_0x14ac9f(0x141)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x14ac9f(0x1cf)][_0x14ac9f(0x228)]();await this['setStateAsync'](_0x14ac9f(0x28b),{'val':JSON[_0x14ac9f(0x279)](this[_0x14ac9f(0x1cf)]),'ack':!![]});}async[a0_0x5b5ac2(0x15c)](){const _0x5c125f=a0_0x5b5ac2;if(!this[_0x5c125f(0x169)]){await this[_0x5c125f(0x2f5)](LTM_DP_BASELINE_STATUS,{'val':_0x5c125f(0x28f),'ack':!![]});return;}const _0x5ee524=this[_0x5c125f(0x262)][_0x5c125f(0x141)]>=(this[_0x5c125f(0x1eb)][_0x5c125f(0x172)]||0x7)?_0x5c125f(0x220)+this['dailyDigests'][_0x5c125f(0x141)]+_0x5c125f(0x26f):'Lernphase\x20('+this['dailyDigests']['length']+'/'+(this[_0x5c125f(0x1eb)][_0x5c125f(0x172)]||0x7)+')';await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x5ee524,'ack':!![]});}async['initSensorSubscriptions'](){const _0xfd1a3b=a0_0x5b5ac2,_0x40866b=this['config']['devices'];if(_0x40866b&&_0x40866b[_0xfd1a3b(0x141)]>0x0){this[_0xfd1a3b(0x15e)][_0xfd1a3b(0x2c5)](_0xfd1a3b(0x1ea)+_0x40866b[_0xfd1a3b(0x141)]+_0xfd1a3b(0x150));for(const _0x2c430d of _0x40866b){if(_0x2c430d['id']){await this[_0xfd1a3b(0x1d7)](_0x2c430d['id']);try{const _0x3bd83d=await this[_0xfd1a3b(0x1bb)](_0x2c430d['id']);if(_0x3bd83d)this[_0xfd1a3b(0x2e4)][_0x2c430d['id']]=_0x3bd83d['val'];}catch(_0x4c7bdb){}}}}}async[a0_0x5b5ac2(0x1e2)](){const _0x3e89aa=a0_0x5b5ac2,_0x475587=this[_0x3e89aa(0x1eb)][_0x3e89aa(0x14e)]||[];if(_0x475587[_0x3e89aa(0x141)]>0x0){this[_0x3e89aa(0x15e)][_0x3e89aa(0x2c5)](_0x3e89aa(0x1ea)+_0x475587[_0x3e89aa(0x141)]+_0x3e89aa(0x178));for(const _0x468c3b of _0x475587){await this[_0x3e89aa(0x1d7)](_0x468c3b);}try{await this[_0x3e89aa(0x1d6)]();}catch(_0x41611e){}}}async[a0_0x5b5ac2(0x2a8)](){const _0x225ef8=a0_0x5b5ac2;try{if(!this[_0x225ef8(0x1eb)]['useWeather'])return _0x225ef8(0x227);let _0x4c0594='';const _0x54ecc1=this[_0x225ef8(0x1eb)][_0x225ef8(0x200)];if(_0x54ecc1)try{if(_0x54ecc1[_0x225ef8(0x20f)](_0x225ef8(0x23b))){const _0x2febd6=await this[_0x225ef8(0x1bb)](_0x54ecc1+_0x225ef8(0x151));if(_0x2febd6&&_0x2febd6[_0x225ef8(0x19c)])_0x4c0594=_0x2febd6['val'];}else{if(_0x54ecc1[_0x225ef8(0x20f)](_0x225ef8(0x1e4))){const _0x5ec39a=await this['getForeignStateAsync'](_0x54ecc1+_0x225ef8(0x22b));if(_0x5ec39a&&_0x5ec39a[_0x225ef8(0x19c)])_0x4c0594=_0x5ec39a[_0x225ef8(0x19c)];}else{if(_0x54ecc1['includes'](_0x225ef8(0x2c7))){const _0x42ba27=await this[_0x225ef8(0x1bb)](_0x54ecc1+_0x225ef8(0x288));if(_0x42ba27&&_0x42ba27[_0x225ef8(0x19c)])_0x4c0594=_0x42ba27[_0x225ef8(0x19c)];}}}}catch(_0x1c5c7a){}if(!_0x4c0594){const _0x1fbe72=[_0x225ef8(0x266),_0x225ef8(0x18c),'weatherunderground.0',_0x225ef8(0x207)];for(const _0x246afa of _0x1fbe72){try{const _0x94f93e=await this[_0x225ef8(0x142)](_0x246afa);if(_0x94f93e){if(_0x246afa[_0x225ef8(0x20f)](_0x225ef8(0x23b))){const _0x2d775f=await this['getForeignStateAsync'](_0x246afa+_0x225ef8(0x151));if(_0x2d775f&&_0x2d775f[_0x225ef8(0x19c)]){_0x4c0594=_0x2d775f[_0x225ef8(0x19c)];break;}}}}catch(_0xf372ef){}}}return _0x4c0594?_0x225ef8(0x260)+_0x4c0594:_0x225ef8(0x28d);}catch(_0x1e6499){return _0x225ef8(0x27f)+_0x1e6499['message'];}}async[a0_0x5b5ac2(0x2ac)](){const _0x366b1d=a0_0x5b5ac2;try{if(!this['config'][_0x366b1d(0x1ec)])return _0x366b1d(0x17f);let _0x10352a=this['config'][_0x366b1d(0x19b)]||_0x366b1d(0x24f),_0x28e5f1=this[_0x366b1d(0x1eb)][_0x366b1d(0x1e5)]||[];if(typeof _0x28e5f1===_0x366b1d(0x1ff))_0x28e5f1=_0x28e5f1[_0x366b1d(0x30c)](',');try{const _0x2e4d97=await this[_0x366b1d(0x1bb)](_0x10352a+_0x366b1d(0x296));if(_0x2e4d97&&_0x2e4d97[_0x366b1d(0x19c)]){let _0x50d89f=this['tryParse'](_0x2e4d97[_0x366b1d(0x19c)]);if(_0x50d89f&&Array[_0x366b1d(0x225)](_0x50d89f)){if(_0x28e5f1[_0x366b1d(0x141)]>0x0)_0x50d89f=_0x50d89f[_0x366b1d(0x2ff)](_0xffd216=>_0x28e5f1[_0x366b1d(0x20f)](_0xffd216[_0x366b1d(0x26d)]||''));else return _0x366b1d(0x1cc);if(_0x50d89f['length']>0x0){const _0x4fa03f=_0x50d89f['slice'](0x0,0x3)['map'](_0x63fc00=>{const _0x16af73=_0x366b1d;let _0x22bda4=_0x63fc00[_0x16af73(0x1a8)];if(_0x63fc00[_0x16af73(0x1e9)])_0x22bda4+='\x20'+_0x63fc00[_0x16af73(0x1e9)];return _0x22bda4+':\x20'+_0x63fc00[_0x16af73(0x310)]+'\x20('+_0x63fc00[_0x16af73(0x26d)]+')';});return _0x366b1d(0x314)+_0x4fa03f[_0x366b1d(0x1c5)](_0x366b1d(0x245));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x4ecc4f){this[_0x366b1d(0x15e)]['warn'](_0x366b1d(0x205)+_0x4ecc4f[_0x366b1d(0x289)]);}return _0x366b1d(0x27c);}catch(_0xf3f16e){return _0x366b1d(0x199)+_0xf3f16e[_0x366b1d(0x289)];}}async['getCalendarNames'](_0x78e9c2){const _0x165b55=a0_0x5b5ac2;try{const _0x100327=await this[_0x165b55(0x1bb)](_0x78e9c2+_0x165b55(0x296));if(_0x100327&&_0x100327[_0x165b55(0x19c)]){const _0x1c6462=this[_0x165b55(0x2b9)](_0x100327[_0x165b55(0x19c)]);if(_0x1c6462&&Array['isArray'](_0x1c6462)){const _0x33228e=[...new Set(_0x1c6462[_0x165b55(0x252)](_0x597730=>_0x597730[_0x165b55(0x26d)])[_0x165b55(0x2ff)](Boolean))];return _0x33228e[_0x165b55(0x14a)]();}}return[];}catch(_0x7d55f4){return this[_0x165b55(0x15e)][_0x165b55(0x1bd)](_0x165b55(0x2a4)+_0x7d55f4[_0x165b55(0x289)]),[];}}async['checkWifiPresence'](){const _0x1377e0=a0_0x5b5ac2;try{const _0x200ad4=this[_0x1377e0(0x1eb)][_0x1377e0(0x14e)]||[];let _0x5a6eda=![];for(const _0x2a1445 of _0x200ad4){try{const _0x42437f=await this[_0x1377e0(0x1bb)](_0x2a1445);if(_0x42437f&&(_0x42437f[_0x1377e0(0x19c)]===!![]||_0x42437f[_0x1377e0(0x19c)]===_0x1377e0(0x1a6)||_0x42437f[_0x1377e0(0x19c)]===0x1)){_0x5a6eda=!![];break;}}catch(_0xdc71b5){}}return _0x5a6eda&&(this[_0x1377e0(0x2dd)]&&(this[_0x1377e0(0x15e)]['info']('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),this[_0x1377e0(0x2dc)]()),!this['isPresent']&&this['currentSystemMode']===SYSTEM_MODES['NORMAL']&&await this['setPresence'](!![])),_0x5a6eda;}catch(_0x5c71d1){return this[_0x1377e0(0x15e)]['error'](_0x1377e0(0x26a)+_0x5c71d1[_0x1377e0(0x289)]),![];}}[a0_0x5b5ac2(0x2ba)](){const _0x1c57d7=a0_0x5b5ac2;this[_0x1c57d7(0x2dc)](),this[_0x1c57d7(0x2f6)]=!![],this[_0x1c57d7(0x166)]=setTimeout(()=>{const _0x8a4c86=_0x1c57d7;this[_0x8a4c86(0x2f6)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x1c57d7(0x2dd)]=setTimeout(()=>{const _0x45d325=_0x1c57d7;this[_0x45d325(0x2ad)](![]),this[_0x45d325(0x2dd)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x5b5ac2(0x2dc)](){const _0x29eb42=a0_0x5b5ac2;if(this[_0x29eb42(0x2dd)])clearTimeout(this['exitTimer']);if(this[_0x29eb42(0x166)])clearTimeout(this[_0x29eb42(0x166)]);this[_0x29eb42(0x2dd)]=null,this[_0x29eb42(0x166)]=null,this[_0x29eb42(0x2f6)]=![];}async[a0_0x5b5ac2(0x2ad)](_0x2520d8){const _0x5a70b6=a0_0x5b5ac2;if(this[_0x5a70b6(0x233)]===_0x2520d8)return;this[_0x5a70b6(0x233)]=_0x2520d8,await this[_0x5a70b6(0x2f5)](_0x5a70b6(0x203),{'val':_0x2520d8,'ack':!![]});}async[a0_0x5b5ac2(0x311)](_0x46f66d){const _0x76ca4f=a0_0x5b5ac2;this['log'][_0x76ca4f(0x2c5)](_0x76ca4f(0x30d)+JSON['stringify'](_0x46f66d));}async[a0_0x5b5ac2(0x189)](){const _0x12a8eb=a0_0x5b5ac2;if(!this[_0x12a8eb(0x169)]||!this[_0x12a8eb(0x1ce)])return;const _0x116825=this[_0x12a8eb(0x1eb)][_0x12a8eb(0x25e)]||0xe;if(this[_0x12a8eb(0x262)][_0x12a8eb(0x141)]<_0x116825+(this[_0x12a8eb(0x1eb)][_0x12a8eb(0x172)]||0x7)){await this[_0x12a8eb(0x2f5)](LTM_DP_DRIFT_STATUS,{'val':_0x12a8eb(0x223),'ack':!![]});return;}const _0x5ab2ec=this['dailyDigests'][_0x12a8eb(0x308)](-_0x116825),_0xd993b4=this[_0x12a8eb(0x262)][_0x12a8eb(0x308)](0x0,this['dailyDigests'][_0x12a8eb(0x141)]-_0x116825),_0x48a9f9=_0x12a8eb(0x1df)+JSON[_0x12a8eb(0x279)](_0xd993b4)+'\x0a\x0aA\x20(STB):\x0a'+JSON['stringify'](_0x5ab2ec);try{const _0x922b30=await this['geminiModel'][_0x12a8eb(0x2a9)](_0x48a9f9),_0x6306e9=JSON[_0x12a8eb(0x14b)](_0x922b30[_0x12a8eb(0x2bd)]['text']()[_0x12a8eb(0x20c)](/```json|```/g,'')[_0x12a8eb(0x235)]());_0x6306e9[_0x12a8eb(0x248)]&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x6306e9[_0x12a8eb(0x248)],'ack':!![]}),await this[_0x12a8eb(0x2f5)](LTM_DP_DRIFT_DETAILS,{'val':_0x6306e9[_0x12a8eb(0x1a7)],'ack':!![]}),await this[_0x12a8eb(0x2f5)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x12a8eb(0x298)](),'ack':!![]}));}catch(_0x3fcae6){}}[a0_0x5b5ac2(0x190)](){const _0x3a3025=a0_0x5b5ac2;try{if(this[_0x3a3025(0x2ec)])this[_0x3a3025(0x2ec)][_0x3a3025(0x2cd)]();if(!this[_0x3a3025(0x169)]){this['setStateAsync'](LTM_DP_STATUS,{'val':_0x3a3025(0x28f),'ack':!![]});return;}this[_0x3a3025(0x2ec)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>this[_0x3a3025(0x1d3)]());}catch(_0x45be7b){this[_0x3a3025(0x15e)][_0x3a3025(0x1bd)](_0x3a3025(0x26b)+_0x45be7b[_0x3a3025(0x289)]);}}['setupModeResetScheduler'](){const _0x4786de=a0_0x5b5ac2;try{if(this['modeResetJob'])this['modeResetJob'][_0x4786de(0x2cd)]();this[_0x4786de(0x273)]=schedule[_0x4786de(0x161)](MODE_RESET_SCHEDULE,async()=>{const _0x11cbac=_0x4786de;await this[_0x11cbac(0x307)](),AUTO_RESET_MODES[_0x11cbac(0x20f)](this[_0x11cbac(0x180)])&&await this[_0x11cbac(0x2f5)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x11cbac(0x2c6)],'ack':![]});});}catch(_0x5c135a){this[_0x4786de(0x15e)][_0x4786de(0x1bd)](_0x4786de(0x1db)+_0x5c135a[_0x4786de(0x289)]);}}[a0_0x5b5ac2(0x2cb)](){const _0x1901c2=a0_0x5b5ac2;try{if(this[_0x1901c2(0x2f3)])clearInterval(this[_0x1901c2(0x2f3)]);if(!this[_0x1901c2(0x169)])return;this[_0x1901c2(0x2f3)]=setInterval(()=>this[_0x1901c2(0x189)](),(this[_0x1901c2(0x1eb)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>this['runBaselineDriftAnalysis'](),0x1388);}catch(_0x1cb450){this[_0x1901c2(0x15e)][_0x1901c2(0x1bd)]('Drift\x20Sched\x20Error:\x20'+_0x1cb450[_0x1901c2(0x289)]);}}['setupBriefingScheduler'](){const _0x53d329=a0_0x5b5ac2;try{if(this[_0x53d329(0x304)])this['briefingJob'][_0x53d329(0x2cd)]();if(!this[_0x53d329(0x1eb)][_0x53d329(0x269)])return;const _0x1e62b0=(this['config'][_0x53d329(0x208)]||'08:00')[_0x53d329(0x30c)](':'),_0x4e2451=parseInt(_0x1e62b0[0x0])||0x8,_0x435c83=parseInt(_0x1e62b0[0x1])||0x0,_0xec8a35=_0x435c83+'\x20'+_0x4e2451+_0x53d329(0x2f9);this[_0x53d329(0x15e)][_0x53d329(0x2c5)]('Scheduling\x20Morning\x20Briefing\x20for\x20'+_0x4e2451+':'+(_0x435c83<0xa?'0'+_0x435c83:_0x435c83)),this['briefingJob']=schedule['scheduleJob'](_0xec8a35,()=>{this['sendMorningBriefing']();});}catch(_0x1f83a7){this[_0x53d329(0x15e)][_0x53d329(0x1bd)](_0x53d329(0x23c)+_0x1f83a7[_0x53d329(0x289)]);}}async[a0_0x5b5ac2(0x2f0)](_0x57cbda,_0xb0df67=![],_0x18c1b1=![]){const _0x7334a6=a0_0x5b5ac2;this[_0x7334a6(0x15e)][_0x7334a6(0x2c5)]((_0xb0df67?_0x7334a6(0x1e8):'')+_0x7334a6(0x234)+_0x57cbda+'\x22'+(_0x18c1b1?_0x7334a6(0x263):''));const _0x3ea2d2=this['config'];let _0x1561ba=0x0;_0x3ea2d2[_0x7334a6(0x1e0)]&&_0x3ea2d2[_0x7334a6(0x285)]&&(await this[_0x7334a6(0x163)](_0x3ea2d2[_0x7334a6(0x285)],_0x7334a6(0x231),{'text':_0x57cbda,'user':_0x3ea2d2[_0x7334a6(0x1ab)]}),_0x1561ba++);if(_0x3ea2d2['notifyPushoverEnabled']&&_0x3ea2d2['notifyPushoverInstance']){let _0x1a4261={'message':_0x57cbda,'title':_0x18c1b1?_0x7334a6(0x2f4):_0x7334a6(0x2eb),'priority':_0x18c1b1?0x2:0x1,'device':_0x3ea2d2[_0x7334a6(0x213)]};_0x18c1b1&&(_0x1a4261[_0x7334a6(0x29a)]=0x1e,_0x1a4261[_0x7334a6(0x2c1)]=0xe10,_0x1a4261[_0x7334a6(0x185)]=_0x7334a6(0x193)),await this[_0x7334a6(0x163)](_0x3ea2d2['notifyPushoverInstance'],_0x7334a6(0x231),_0x1a4261),_0x1561ba++;}return _0x3ea2d2[_0x7334a6(0x2af)]&&_0x3ea2d2[_0x7334a6(0x26c)]&&(await this['sendToAsync'](_0x3ea2d2[_0x7334a6(0x26c)],_0x7334a6(0x231),{'text':_0x57cbda,'to':_0x3ea2d2['notifyEmailRecipient']}),_0x1561ba++),_0x3ea2d2['notifyWhatsappEnabled']&&_0x3ea2d2[_0x7334a6(0x140)]&&(await this[_0x7334a6(0x163)](_0x3ea2d2['notifyWhatsappInstance'],'send',{'text':_0x57cbda,'phone':_0x3ea2d2[_0x7334a6(0x313)]}),_0x1561ba++),_0x3ea2d2[_0x7334a6(0x183)]&&_0x3ea2d2['notifySignalInstance']&&(await this[_0x7334a6(0x163)](_0x3ea2d2[_0x7334a6(0x174)],'send',{'text':_0x57cbda,'phone':_0x3ea2d2[_0x7334a6(0x202)]}),_0x1561ba++),_0x1561ba;}}if(require['main']!==module)module[a0_0x5b5ac2(0x13e)]=_0xc9353c=>new CogniLiving(_0xc9353c);else new CogniLiving();