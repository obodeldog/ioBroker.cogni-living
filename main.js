const a0_0x41c4f3=a0_0x4056;(function(_0x3aa718,_0x3a2109){const _0x4b9a99=a0_0x4056,_0x47b525=_0x3aa718();while(!![]){try{const _0x1a267c=parseInt(_0x4b9a99(0x248))/0x1+-parseInt(_0x4b9a99(0x33d))/0x2+parseInt(_0x4b9a99(0x39a))/0x3*(parseInt(_0x4b9a99(0x272))/0x4)+-parseInt(_0x4b9a99(0x326))/0x5*(-parseInt(_0x4b9a99(0x24f))/0x6)+parseInt(_0x4b9a99(0x2a3))/0x7+parseInt(_0x4b9a99(0x28a))/0x8*(parseInt(_0x4b9a99(0x36d))/0x9)+-parseInt(_0x4b9a99(0x2d2))/0xa*(parseInt(_0x4b9a99(0x31a))/0xb);if(_0x1a267c===_0x3a2109)break;else _0x47b525['push'](_0x47b525['shift']());}catch(_0x582ad9){_0x47b525['push'](_0x47b525['shift']());}}}(a0_0xecd6,0x2a1dd));const a0_0x2f97a0=(function(){let _0x26b1e4=!![];return function(_0x50d097,_0x189f75){const _0x17391d=_0x26b1e4?function(){const _0x64c465=a0_0x4056;if(_0x189f75){const _0x3ada8a=_0x189f75[_0x64c465(0x38a)](_0x50d097,arguments);return _0x189f75=null,_0x3ada8a;}}:function(){};return _0x26b1e4=![],_0x17391d;};}()),a0_0x4cdf92=a0_0x2f97a0(this,function(){const _0x29a557=a0_0x4056;return a0_0x4cdf92[_0x29a557(0x23d)]()[_0x29a557(0x1da)](_0x29a557(0x1eb))[_0x29a557(0x23d)]()[_0x29a557(0x2da)](a0_0x4cdf92)['search'](_0x29a557(0x1eb));});a0_0x4cdf92();'use strict';const utils=require(a0_0x41c4f3(0x26c)),{GoogleGenerativeAI}=require(a0_0x41c4f3(0x1d5)),schedule=require(a0_0x41c4f3(0x381)),{spawn,exec}=require(a0_0x41c4f3(0x304)),path=require('path'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x41c4f3(0x2e2),LTM_SCHEDULE=a0_0x41c4f3(0x1e2),MODE_RESET_SCHEDULE=a0_0x41c4f3(0x1cc),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x41c4f3(0x360),LTM_DP_DAILY_DIGESTS=a0_0x41c4f3(0x355),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x41c4f3(0x2d5),LTM_DP_BASELINE_STATUS='LTM.baselineStatus',LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x41c4f3(0x331),LTM_DP_DRIFT_DETAILS=a0_0x41c4f3(0x1fb),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x41c4f3(0x2cd),HARD_IGNORE_TERMS=[a0_0x41c4f3(0x22c),a0_0x41c4f3(0x1f8),'update',a0_0x41c4f3(0x24e),a0_0x41c4f3(0x2ae),'rssi',a0_0x41c4f3(0x2d4),a0_0x41c4f3(0x37a),a0_0x41c4f3(0x278),a0_0x41c4f3(0x35a),'working',a0_0x41c4f3(0x2a6),a0_0x41c4f3(0x397),a0_0x41c4f3(0x2c9),a0_0x41c4f3(0x2f8),a0_0x41c4f3(0x25a),a0_0x41c4f3(0x343),a0_0x41c4f3(0x33b)],BAD_NAMES=[a0_0x41c4f3(0x352),a0_0x41c4f3(0x2be),a0_0x41c4f3(0x1d3),a0_0x41c4f3(0x357),a0_0x41c4f3(0x359),a0_0x41c4f3(0x21e),'on','off',a0_0x41c4f3(0x2cc),'position','shutter',a0_0x41c4f3(0x276),a0_0x41c4f3(0x33f),a0_0x41c4f3(0x29b),a0_0x41c4f3(0x206),a0_0x41c4f3(0x22f),a0_0x41c4f3(0x253),a0_0x41c4f3(0x294),'humidity',a0_0x41c4f3(0x1ee),a0_0x41c4f3(0x391),a0_0x41c4f3(0x2fe),a0_0x41c4f3(0x2fc),'actual_temperature','set_temperature'],ADAPTER_BLACKLIST=[a0_0x41c4f3(0x1e5),a0_0x41c4f3(0x25c),a0_0x41c4f3(0x275),'vis.','history.','material.',a0_0x41c4f3(0x377),a0_0x41c4f3(0x336),a0_0x41c4f3(0x302),a0_0x41c4f3(0x25f),a0_0x41c4f3(0x23b)],SYSTEM_MODES={'NORMAL':a0_0x41c4f3(0x346),'VACATION':a0_0x41c4f3(0x1ca),'PARTY':a0_0x41c4f3(0x34c),'GUEST':a0_0x41c4f3(0x252)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x41c4f3(0x319)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':a0_0x41c4f3(0x31d),'family':a0_0x41c4f3(0x263),'single_comfort':a0_0x41c4f3(0x2ec),'security':a0_0x41c4f3(0x309)};async function initZombies(_0x53ecc9){const _0x4fe7f4=a0_0x41c4f3;try{const _0x33b0b2=[_0x4fe7f4(0x37b),_0x4fe7f4(0x3a4)];for(const _0x425e65 of _0x33b0b2){try{const _0x3efdfe=await _0x53ecc9[_0x4fe7f4(0x2e9)](_0x425e65);_0x3efdfe&&await _0x53ecc9[_0x4fe7f4(0x23e)](_0x425e65);}catch(_0x110d77){}}}catch(_0x417e89){}}async function initHistory(_0x3639ac){const _0x530b7d=a0_0x41c4f3;try{const _0x2c9c9f=await _0x3639ac[_0x530b7d(0x323)]('events.history');_0x2c9c9f&&_0x2c9c9f[_0x530b7d(0x217)]&&(_0x3639ac[_0x530b7d(0x384)]=JSON[_0x530b7d(0x2dc)](_0x2c9c9f['val'][_0x530b7d(0x23d)]()));}catch(_0x2bd28e){_0x3639ac[_0x530b7d(0x384)]=[];}try{const _0x1ee4e3=await _0x3639ac[_0x530b7d(0x323)](_0x530b7d(0x2a0));if(_0x1ee4e3&&_0x1ee4e3[_0x530b7d(0x217)])_0x3639ac[_0x530b7d(0x39b)]=JSON[_0x530b7d(0x2dc)](_0x1ee4e3[_0x530b7d(0x217)][_0x530b7d(0x23d)]());}catch(_0x3920e8){_0x3639ac['analysisHistory']=[];}if(_0x3639ac[_0x530b7d(0x384)]&&_0x3639ac[_0x530b7d(0x384)]['length']>0x0){_0x3639ac[_0x530b7d(0x20a)][_0x530b7d(0x26e)](_0x530b7d(0x327)+_0x3639ac[_0x530b7d(0x384)][_0x530b7d(0x2bb)]+_0x530b7d(0x30f));for(let _0x36482b=_0x3639ac[_0x530b7d(0x384)]['length']-0x1;_0x36482b>=0x0;_0x36482b--){const _0x25a60c=_0x3639ac[_0x530b7d(0x384)][_0x36482b];_0x25a60c&&_0x25a60c['id']!==undefined&&_0x25a60c[_0x530b7d(0x359)]!==undefined&&(_0x3639ac[_0x530b7d(0x38f)][_0x25a60c['id']]=_0x25a60c[_0x530b7d(0x359)]);}}}async function initSystemConfig(_0x1d9f53){const _0x3b5a0c=a0_0x41c4f3;try{const _0x493be5=await _0x1d9f53[_0x3b5a0c(0x36e)](_0x3b5a0c(0x1db));_0x493be5&&_0x493be5[_0x3b5a0c(0x1fc)]&&(_0x1d9f53[_0x3b5a0c(0x333)]={'latitude':_0x493be5[_0x3b5a0c(0x1fc)]['latitude']||0x0,'longitude':_0x493be5[_0x3b5a0c(0x1fc)][_0x3b5a0c(0x345)]||0x0,'city':_0x493be5[_0x3b5a0c(0x1fc)][_0x3b5a0c(0x2a7)]||''});}catch(_0x54b0b0){}}async function checkLicense(_0x83d1a5,_0x2ce9bb){const _0x566ea3=a0_0x41c4f3;if(!_0x2ce9bb)return![];_0x83d1a5[_0x566ea3(0x27f)]=await getSystemUUID(_0x83d1a5);if(_0x2ce9bb===_0x566ea3(0x2e0)||_0x2ce9bb[_0x566ea3(0x242)](_0x566ea3(0x30c)))return!![];return![];}async function getSystemUUID(_0x24d2b4){const _0x25b945=a0_0x41c4f3;try{const _0x231b4f=await _0x24d2b4['getForeignObjectAsync'](_0x25b945(0x2d1));if(_0x231b4f&&_0x231b4f[_0x25b945(0x230)]&&_0x231b4f[_0x25b945(0x230)][_0x25b945(0x228)])return _0x231b4f[_0x25b945(0x230)][_0x25b945(0x228)];return'uuid-not-found';}catch(_0xd9defb){return'uuid-error';}}async function createAllObjects(_0x1fc8bf){const _0x2dc55f=a0_0x41c4f3;await checkSystemObjects(_0x1fc8bf),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x27d),{'type':_0x2dc55f(0x1d3),'common':{'name':'Who\x20is\x20present?','type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x280),'read':!![],'write':![],'def':''},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x2b0),{'type':_0x2dc55f(0x1d3),'common':{'name':'Last\x20raw\x20event','type':'string','role':_0x2dc55f(0x271),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x27c),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x1f4),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x1fc8bf['setObjectNotExistsAsync'](_0x2dc55f(0x375),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x258),'type':_0x2dc55f(0x1cf),'role':_0x2dc55f(0x207),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)]('analysis.triggerBriefing',{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x2ee),'type':_0x2dc55f(0x1cf),'role':_0x2dc55f(0x207),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)]('analysis.lastResult',{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x335),'type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x271),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf['setObjectNotExistsAsync'](_0x2dc55f(0x2f9),{'type':'state','common':{'name':_0x2dc55f(0x210),'type':_0x2dc55f(0x1cf),'role':_0x2dc55f(0x2fa),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x225),{'type':'state','common':{'name':_0x2dc55f(0x267),'type':_0x2dc55f(0x1cf),'role':_0x2dc55f(0x38d),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x30e),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x2aa),'type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x2bc),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf['setObjectNotExistsAsync'](_0x2dc55f(0x374),{'type':'state','common':{'name':_0x2dc55f(0x371),'type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x280),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf['setObjectNotExistsAsync'](_0x2dc55f(0x308),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x2ba),'type':_0x2dc55f(0x1e3),'role':'state','read':!![],'write':![],'def':_0x2dc55f(0x21f)},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x277),{'type':_0x2dc55f(0x1d3),'common':{'name':'Comfort\x20Summary','type':_0x2dc55f(0x1e3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)]('analysis.comfortSuggestion',{'type':_0x2dc55f(0x1d3),'common':{'name':'Comfort\x20Suggestion','type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x280),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x1d0)](_0x2dc55f(0x31f),{'type':_0x2dc55f(0x1e1),'common':{'name':_0x2dc55f(0x220)},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x36a),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x293),'type':'boolean','role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x21b),{'type':'state','common':{'name':_0x2dc55f(0x1c7),'type':'string','role':_0x2dc55f(0x280),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x1ec),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x1d7),'type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x280),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)]('analysis.automation.targetId',{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x344),'type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x280),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x1c8),{'type':_0x2dc55f(0x1d3),'common':{'name':'Target\x20Value','type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x280),'read':!![],'write':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)]('analysis.automation.autoApply',{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x1cd),'type':'boolean','role':_0x2dc55f(0x2cc),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x291),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x299),'type':_0x2dc55f(0x1cf),'role':_0x2dc55f(0x207),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x2a0),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x32b),'type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x271),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x2f6),{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x2a1),'type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x271),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x1d0)](_0x2dc55f(0x321),{'type':_0x2dc55f(0x1e1),'common':{'name':_0x2dc55f(0x238)},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)]('analysis.health.sleepScore',{'type':_0x2dc55f(0x1d3),'common':{'name':'Sleep\x20Score\x20(0-100)','type':_0x2dc55f(0x300),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)]('analysis.health.restlessness',{'type':_0x2dc55f(0x1d3),'common':{'name':_0x2dc55f(0x2b2),'type':_0x2dc55f(0x1e3),'role':'text','read':!![],'write':![],'def':'none'},'native':{}}),await _0x1fc8bf[_0x2dc55f(0x31b)](_0x2dc55f(0x366),{'type':_0x2dc55f(0x1d3),'common':{'name':'Health\x20Notes','type':_0x2dc55f(0x1e3),'role':_0x2dc55f(0x280),'read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x1fc8bf),await checkLtmDriftObjects(_0x1fc8bf);}async function checkSystemObjects(_0x5688c8){const _0x35a4db=a0_0x41c4f3;await _0x5688c8[_0x35a4db(0x1d0)](_0x35a4db(0x322),{'type':_0x35a4db(0x1e1),'common':{'name':_0x35a4db(0x30d)},'native':{}}),await _0x5688c8[_0x35a4db(0x1d0)](SYSTEM_DP_MODE,{'type':_0x35a4db(0x1d3),'common':{'name':_0x35a4db(0x1f6),'type':_0x35a4db(0x1e3),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x35a4db(0x2f7)],'states':{[SYSTEM_MODES[_0x35a4db(0x2f7)]]:_0x35a4db(0x212),[SYSTEM_MODES[_0x35a4db(0x306)]]:'Urlaub',[SYSTEM_MODES['PARTY']]:_0x35a4db(0x1e6),[SYSTEM_MODES[_0x35a4db(0x319)]]:'Gast'}},'native':{}});}function a0_0x4056(_0x480c7f,_0x5462a4){const _0x584feb=a0_0xecd6();return a0_0x4056=function(_0x4cdf92,_0x2f97a0){_0x4cdf92=_0x4cdf92-0x1c5;let _0xecd630=_0x584feb[_0x4cdf92];return _0xecd630;},a0_0x4056(_0x480c7f,_0x5462a4);}async function checkLtmObjects(_0x2f6b8c){const _0x2f49f4=a0_0x41c4f3;await _0x2f6b8c[_0x2f49f4(0x1d0)](_0x2f49f4(0x200),{'type':_0x2f49f4(0x1e1),'common':{'name':_0x2f49f4(0x200)},'native':{}}),await _0x2f6b8c[_0x2f49f4(0x1d0)](LTM_DP_RAW_LOG,{'type':_0x2f49f4(0x1d3),'common':{'name':_0x2f49f4(0x20f),'type':_0x2f49f4(0x1e3),'role':_0x2f49f4(0x271),'read':!![],'write':![]},'native':{}}),await _0x2f6b8c['extendObjectAsync'](LTM_DP_DAILY_DIGESTS,{'type':_0x2f49f4(0x1d3),'common':{'name':_0x2f49f4(0x1f3),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x2f6b8c['extendObjectAsync'](LTM_DP_STATUS,{'type':'state','common':{'name':_0x2f49f4(0x2ce),'type':_0x2f49f4(0x1e3),'role':'text','read':!![],'write':![]},'native':{}}),await _0x2f6b8c[_0x2f49f4(0x1d0)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x2f49f4(0x398),'type':_0x2f49f4(0x1cf),'role':_0x2f49f4(0x207),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x2f6b8c[_0x2f49f4(0x1d0)](LTM_DP_BASELINE_STATUS,{'type':_0x2f49f4(0x1d3),'common':{'name':'Baseline\x20Status','type':_0x2f49f4(0x1e3),'role':_0x2f49f4(0x280),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x1425db){const _0x5311dc=a0_0x41c4f3;await _0x1425db[_0x5311dc(0x1d0)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x5311dc(0x287)},'native':{}}),await _0x1425db[_0x5311dc(0x1d0)](LTM_DP_DRIFT_STATUS,{'type':_0x5311dc(0x1d3),'common':{'name':_0x5311dc(0x203),'type':_0x5311dc(0x1e3),'role':'state','read':!![],'write':![],'def':_0x5311dc(0x21f)},'native':{}}),await _0x1425db[_0x5311dc(0x1d0)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x5311dc(0x372),'type':_0x5311dc(0x1e3),'role':_0x5311dc(0x280),'read':!![],'write':![]},'native':{}}),await _0x1425db[_0x5311dc(0x1d0)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x5311dc(0x1d3),'common':{'name':_0x5311dc(0x1dc),'type':_0x5311dc(0x300),'role':'date','read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x85a289){const _0x31ae5c=a0_0x41c4f3;try{const _0x595653=await _0x85a289[_0x31ae5c(0x323)](SYSTEM_DP_MODE);_0x595653&&_0x595653['val']&&Object['values'](SYSTEM_MODES)[_0x31ae5c(0x37f)](_0x595653[_0x31ae5c(0x217)])?_0x85a289[_0x31ae5c(0x22e)]=_0x595653[_0x31ae5c(0x217)]:(_0x85a289[_0x31ae5c(0x22e)]=SYSTEM_MODES[_0x31ae5c(0x2f7)],await _0x85a289[_0x31ae5c(0x361)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x31ae5c(0x2f7)],'ack':!![]}));}catch(_0xce513){_0x85a289[_0x31ae5c(0x22e)]=SYSTEM_MODES['NORMAL'];}}async function loadRawEventLog(_0xf9bcce){const _0x42923c=a0_0x41c4f3;try{const _0x100c1e=await _0xf9bcce[_0x42923c(0x323)](LTM_DP_RAW_LOG);if(_0x100c1e&&_0x100c1e[_0x42923c(0x217)])_0xf9bcce[_0x42923c(0x386)]=JSON['parse'](_0x100c1e[_0x42923c(0x217)]);}catch(_0x408a62){_0xf9bcce[_0x42923c(0x386)]=[];}}async function saveRawEventLog(_0x4b57ba){const _0x4d8cb2=a0_0x41c4f3;_0x4b57ba[_0x4d8cb2(0x386)][_0x4d8cb2(0x2bb)]>RAW_LOG_MAX_SIZE&&_0x4b57ba[_0x4d8cb2(0x386)]['splice'](0x0,_0x4b57ba[_0x4d8cb2(0x386)]['length']-RAW_LOG_MAX_SIZE),await _0x4b57ba[_0x4d8cb2(0x361)](LTM_DP_RAW_LOG,{'val':JSON[_0x4d8cb2(0x2c3)](_0x4b57ba['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x4c7fda){const _0x4db0f6=a0_0x41c4f3;try{const _0x22b829=await _0x4c7fda[_0x4db0f6(0x323)](LTM_DP_DAILY_DIGESTS);if(_0x22b829&&_0x22b829['val'])_0x4c7fda[_0x4db0f6(0x274)]=JSON[_0x4db0f6(0x2dc)](_0x22b829[_0x4db0f6(0x217)]);}catch(_0x37444a){_0x4c7fda['dailyDigests']=[];}await updateBaselineStatus(_0x4c7fda);}async function saveDailyDigests(_0x3a9f23,_0x269387=!![]){const _0x530618=a0_0x41c4f3,_0x17deab=_0x3a9f23[_0x530618(0x37d)][_0x530618(0x2bd)]||0x3c;_0x3a9f23['dailyDigests'][_0x530618(0x2bb)]>_0x17deab&&_0x3a9f23['dailyDigests'][_0x530618(0x392)](0x0,_0x3a9f23['dailyDigests']['length']-_0x17deab);await _0x3a9f23[_0x530618(0x361)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x530618(0x2c3)](_0x3a9f23['dailyDigests']),'ack':!![]});if(_0x269387)await updateBaselineStatus(_0x3a9f23);}async function updateAnalysisHistory(_0x401f90,_0xe5ec6){const _0x2c6e97=a0_0x41c4f3;_0x401f90['analysisHistory'][_0x2c6e97(0x1ff)](_0xe5ec6);if(_0x401f90[_0x2c6e97(0x39b)][_0x2c6e97(0x2bb)]>ANALYSIS_HISTORY_MAX_SIZE)_0x401f90[_0x2c6e97(0x39b)]['pop']();await _0x401f90['setStateAsync'](_0x2c6e97(0x2a0),{'val':JSON[_0x2c6e97(0x2c3)](_0x401f90[_0x2c6e97(0x39b)]),'ack':!![]});}async function updateBaselineStatus(_0x353abc){const _0xf82c3f=a0_0x41c4f3;if(!_0x353abc[_0xf82c3f(0x339)]){await _0x353abc[_0xf82c3f(0x361)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x4dd3b8=_0x353abc['dailyDigests'][_0xf82c3f(0x2bb)]>=(_0x353abc['config']['minDaysForBaseline']||0x7)?_0xf82c3f(0x2d8)+_0x353abc[_0xf82c3f(0x274)][_0xf82c3f(0x2bb)]+'\x20Tage)':_0xf82c3f(0x201)+_0x353abc[_0xf82c3f(0x274)][_0xf82c3f(0x2bb)]+'/'+(_0x353abc[_0xf82c3f(0x37d)][_0xf82c3f(0x24b)]||0x7)+')';await _0x353abc[_0xf82c3f(0x361)](LTM_DP_BASELINE_STATUS,{'val':_0x4dd3b8,'ack':!![]});}async function initSensorSubscriptions(_0x2fb0ed){const _0x53f89b=a0_0x41c4f3,_0x51394e=_0x2fb0ed[_0x53f89b(0x37d)][_0x53f89b(0x395)];if(_0x51394e&&_0x51394e[_0x53f89b(0x2bb)]>0x0){_0x2fb0ed['log'][_0x53f89b(0x26e)]('Subscribing\x20to\x20'+_0x51394e[_0x53f89b(0x2bb)]+_0x53f89b(0x241));for(const _0x3e43c8 of _0x51394e){if(_0x3e43c8['id']){await _0x2fb0ed[_0x53f89b(0x202)](_0x3e43c8['id']);try{const _0x486270=await _0x2fb0ed['getForeignStateAsync'](_0x3e43c8['id']);if(_0x486270)_0x2fb0ed[_0x53f89b(0x38f)][_0x3e43c8['id']]=_0x486270[_0x53f89b(0x217)];}catch(_0x56d331){}}}}}async function initPresenceSubscriptions(_0x31d76b){const _0x3f4b40=a0_0x41c4f3,_0x19b609=_0x31d76b['config'][_0x3f4b40(0x2f1)]||[];if(_0x19b609[_0x3f4b40(0x2bb)]>0x0){_0x31d76b[_0x3f4b40(0x20a)][_0x3f4b40(0x26e)]('Subscribing\x20to\x20'+_0x19b609['length']+_0x3f4b40(0x29a));for(const _0xc706b0 of _0x19b609){await _0x31d76b[_0x3f4b40(0x202)](_0xc706b0);}try{await checkWifiPresence(_0x31d76b);}catch(_0x2c5d0b){}}}async function getWeatherContext(_0x5cb52e){const _0x25c2a6=a0_0x41c4f3;try{if(!_0x5cb52e[_0x25c2a6(0x37d)][_0x25c2a6(0x250)])return _0x25c2a6(0x29e);let _0x102fde='';const _0x97dfe5=_0x5cb52e[_0x25c2a6(0x37d)][_0x25c2a6(0x396)];if(_0x97dfe5)try{if(_0x97dfe5['includes']('accuweather')){const _0xfa79dc=await _0x5cb52e[_0x25c2a6(0x29c)](_0x97dfe5+'.Summary.Current');if(_0xfa79dc&&_0xfa79dc[_0x25c2a6(0x217)])_0x102fde=_0xfa79dc[_0x25c2a6(0x217)];}else{if(_0x97dfe5['includes'](_0x25c2a6(0x311))){const _0x4a1dea=await _0x5cb52e[_0x25c2a6(0x29c)](_0x97dfe5+_0x25c2a6(0x1fe));if(_0x4a1dea&&_0x4a1dea[_0x25c2a6(0x217)])_0x102fde=_0x4a1dea[_0x25c2a6(0x217)];}else{if(_0x97dfe5[_0x25c2a6(0x37f)](_0x25c2a6(0x2f4))){const _0x12821e=await _0x5cb52e[_0x25c2a6(0x29c)](_0x97dfe5+'.forecast.current.state');if(_0x12821e&&_0x12821e['val'])_0x102fde=_0x12821e['val'];}}}}catch(_0x6ee97c){}if(!_0x102fde){const _0x25a869=[_0x25c2a6(0x330),_0x25c2a6(0x1d2),_0x25c2a6(0x2e1),_0x25c2a6(0x34a)];for(const _0x557d7e of _0x25a869){try{const _0xa4d1c8=await _0x5cb52e[_0x25c2a6(0x36e)](_0x557d7e);if(_0xa4d1c8){if(_0x557d7e[_0x25c2a6(0x37f)](_0x25c2a6(0x1e8))){const _0x4f70bd=await _0x5cb52e['getForeignStateAsync'](_0x557d7e+'.Summary.Current');if(_0x4f70bd&&_0x4f70bd[_0x25c2a6(0x217)]){_0x102fde=_0x4f70bd[_0x25c2a6(0x217)];break;}}}}catch(_0x26e703){}}}return _0x102fde?_0x25c2a6(0x38b)+_0x102fde:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x5dca45){return _0x25c2a6(0x364)+_0x5dca45[_0x25c2a6(0x26f)];}}async function getCalendarContext(_0x2294dc){const _0x306293=a0_0x41c4f3;try{if(!_0x2294dc[_0x306293(0x37d)]['useCalendar'])return _0x306293(0x1d6);let _0x4da28b=_0x2294dc[_0x306293(0x37d)][_0x306293(0x30a)]||'ical.0',_0xfa26e5=_0x2294dc[_0x306293(0x37d)][_0x306293(0x385)]||[];if(typeof _0xfa26e5===_0x306293(0x1e3))_0xfa26e5=_0xfa26e5[_0x306293(0x1d8)](',');try{const _0x5a5cea=await _0x2294dc['getForeignStateAsync'](_0x4da28b+_0x306293(0x20e));if(_0x5a5cea&&_0x5a5cea[_0x306293(0x217)]){let _0x3ff18d=tryParse(_0x5a5cea[_0x306293(0x217)]);if(_0x3ff18d&&Array[_0x306293(0x234)](_0x3ff18d)){if(_0xfa26e5[_0x306293(0x2bb)]>0x0)_0x3ff18d=_0x3ff18d[_0x306293(0x24d)](_0x5ad8bc=>_0xfa26e5[_0x306293(0x37f)](_0x5ad8bc[_0x306293(0x314)]||''));else return _0x306293(0x236);if(_0x3ff18d[_0x306293(0x2bb)]>0x0){const _0x35cca2=_0x3ff18d[_0x306293(0x389)](0x0,0x3)[_0x306293(0x243)](_0x1ff3f0=>{const _0x49dd48=_0x306293;let _0x295392=_0x1ff3f0[_0x49dd48(0x266)];if(_0x1ff3f0['time'])_0x295392+='\x20'+_0x1ff3f0['time'];return _0x295392+':\x20'+_0x1ff3f0[_0x49dd48(0x2fd)]+'\x20('+_0x1ff3f0[_0x49dd48(0x314)]+')';});return _0x306293(0x310)+_0x35cca2['join'](_0x306293(0x2f5));}else return _0x306293(0x247);}}}catch(_0x353b8b){_0x2294dc[_0x306293(0x20a)][_0x306293(0x26d)](_0x306293(0x1e7)+_0x353b8b[_0x306293(0x26f)]);}return _0x306293(0x2e4);}catch(_0x43a8ec){return _0x306293(0x29d)+_0x43a8ec['message'];}}async function getCalendarNames(_0x125af8,_0x1fe524){const _0x45a36c=a0_0x41c4f3;try{const _0x16d101=await _0x125af8[_0x45a36c(0x29c)](_0x1fe524+'.data.table');if(_0x16d101&&_0x16d101[_0x45a36c(0x217)]){const _0x3c3596=tryParse(_0x16d101[_0x45a36c(0x217)]);if(_0x3c3596&&Array['isArray'](_0x3c3596)){const _0x5ddf5b=[...new Set(_0x3c3596[_0x45a36c(0x243)](_0x17f6a4=>_0x17f6a4[_0x45a36c(0x314)])[_0x45a36c(0x24d)](Boolean))];return _0x5ddf5b[_0x45a36c(0x3a5)]();}}return[];}catch(_0x39d6b2){return _0x125af8[_0x45a36c(0x20a)]['error']('getCalendarNames\x20Error:\x20'+_0x39d6b2['message']),[];}}async function checkWifiPresence(_0x16c506){const _0x2e90bd=a0_0x41c4f3;try{const _0x44f92a=_0x16c506[_0x2e90bd(0x37d)][_0x2e90bd(0x2f1)]||[];let _0xbe1af4=![];const _0x1890ee=[];for(const _0x531636 of _0x44f92a){try{const _0x4194ce=await _0x16c506[_0x2e90bd(0x29c)](_0x531636);if(_0x4194ce&&(_0x4194ce[_0x2e90bd(0x217)]===!![]||_0x4194ce[_0x2e90bd(0x217)]==='online'||_0x4194ce[_0x2e90bd(0x217)]===0x1)){_0xbe1af4=!![];const _0x2e4fea=await _0x16c506[_0x2e90bd(0x36e)](_0x531636);let _0x4950df=_0x531636;_0x2e4fea&&_0x2e4fea[_0x2e90bd(0x1fc)]&&_0x2e4fea['common']['name']&&(_0x4950df=typeof _0x2e4fea['common']['name']==='object'?_0x2e4fea['common']['name']['de']||_0x2e4fea['common'][_0x2e90bd(0x21d)]['en']:_0x2e4fea[_0x2e90bd(0x1fc)][_0x2e90bd(0x21d)]),_0x1890ee['push'](_0x4950df);}}catch(_0x2a313a){}}return await _0x16c506[_0x2e90bd(0x361)](_0x2e90bd(0x27d),{'val':_0x1890ee[_0x2e90bd(0x303)](',\x20'),'ack':!![]}),_0xbe1af4&&(_0x16c506[_0x2e90bd(0x2d9)]&&(_0x16c506[_0x2e90bd(0x20a)]['info'](_0x2e90bd(0x32c)),abortExitTimer(_0x16c506)),!_0x16c506[_0x2e90bd(0x23f)]&&_0x16c506[_0x2e90bd(0x22e)]===SYSTEM_MODES[_0x2e90bd(0x2f7)]&&await setPresence(_0x16c506,!![])),_0xbe1af4;}catch(_0x74f7cc){return _0x16c506[_0x2e90bd(0x20a)][_0x2e90bd(0x278)](_0x2e90bd(0x25d)+_0x74f7cc[_0x2e90bd(0x26f)]),![];}}function startExitTimer(_0x4e074d){const _0x26bf35=a0_0x41c4f3;abortExitTimer(_0x4e074d),_0x4e074d[_0x26bf35(0x2f0)]=!![],_0x4e074d[_0x26bf35(0x235)]=setTimeout(()=>{const _0x37ffa5=_0x26bf35;_0x4e074d[_0x37ffa5(0x2f0)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x4e074d[_0x26bf35(0x2d9)]=setTimeout(()=>{const _0x5de968=_0x26bf35;setPresence(_0x4e074d,![]),_0x4e074d[_0x5de968(0x2d9)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x2d933a){const _0x169347=a0_0x41c4f3;if(_0x2d933a[_0x169347(0x2d9)])clearTimeout(_0x2d933a[_0x169347(0x2d9)]);if(_0x2d933a['exitGraceTimer'])clearTimeout(_0x2d933a[_0x169347(0x235)]);_0x2d933a['exitTimer']=null,_0x2d933a[_0x169347(0x235)]=null,_0x2d933a[_0x169347(0x2f0)]=![];}async function setPresence(_0x2edd60,_0x187129){const _0x4bffb8=a0_0x41c4f3;if(_0x2edd60[_0x4bffb8(0x23f)]===_0x187129)return;_0x2edd60[_0x4bffb8(0x23f)]=_0x187129,await _0x2edd60[_0x4bffb8(0x361)](_0x4bffb8(0x24c),{'val':_0x187129,'ack':!![]});}async function saveFeedback(_0x476f6f,_0xcd47ea){const _0x250a48=a0_0x41c4f3;_0x476f6f[_0x250a48(0x20a)][_0x250a48(0x26e)]('Feedback\x20saved:\x20'+JSON[_0x250a48(0x2c3)](_0xcd47ea));}async function runBaselineDriftAnalysis(_0x3107f3){const _0x244dad=a0_0x41c4f3;if(!_0x3107f3['isProVersion']||!_0x3107f3['geminiModel'])return;const _0x1c92de=_0x3107f3[_0x244dad(0x37d)]['ltmStbWindowDays']||0xe;if(_0x3107f3[_0x244dad(0x274)][_0x244dad(0x2bb)]<_0x1c92de+(_0x3107f3[_0x244dad(0x37d)][_0x244dad(0x24b)]||0x7)){await _0x3107f3['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x244dad(0x1fd),'ack':!![]});return;}const _0x5e606b=_0x3107f3[_0x244dad(0x274)][_0x244dad(0x389)](-_0x1c92de),_0x43406d=_0x3107f3[_0x244dad(0x274)][_0x244dad(0x389)](0x0,_0x3107f3['dailyDigests']['length']-_0x1c92de),_0x5dba76=_0x244dad(0x33c)+JSON['stringify'](_0x43406d)+_0x244dad(0x362)+JSON[_0x244dad(0x2c3)](_0x5e606b);try{const _0x36a429=await _0x3107f3['geminiModel'][_0x244dad(0x2c7)](_0x5dba76),_0xe5ace4=JSON[_0x244dad(0x2dc)](_0x36a429['response']['text']()['replace'](/```json|```/g,'')[_0x244dad(0x39c)]());_0xe5ace4[_0x244dad(0x2ed)]&&(await _0x3107f3['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0xe5ace4[_0x244dad(0x2ed)],'ack':!![]}),await _0x3107f3['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0xe5ace4['driftDetails'],'ack':!![]}),await _0x3107f3[_0x244dad(0x361)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x2014ee){}}function setupLtmScheduler(_0x12afd7){const _0xc24a1c=a0_0x41c4f3;try{if(_0x12afd7[_0xc24a1c(0x2c4)])_0x12afd7[_0xc24a1c(0x2c4)]['cancel']();if(!_0x12afd7['isProVersion']){_0x12afd7[_0xc24a1c(0x361)](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x12afd7[_0xc24a1c(0x2c4)]=schedule[_0xc24a1c(0x2ad)](LTM_SCHEDULE,()=>createDailyDigest(_0x12afd7));}catch(_0x3228b2){_0x12afd7[_0xc24a1c(0x20a)][_0xc24a1c(0x278)](_0xc24a1c(0x382)+_0x3228b2['message']);}}function setupModeResetScheduler(_0x31a23b){const _0x133b5a=a0_0x41c4f3;try{if(_0x31a23b['modeResetJob'])_0x31a23b[_0x133b5a(0x36f)][_0x133b5a(0x1f7)]();_0x31a23b[_0x133b5a(0x36f)]=schedule[_0x133b5a(0x2ad)](MODE_RESET_SCHEDULE,async()=>{const _0x16320f=_0x133b5a;await loadSystemMode(_0x31a23b),AUTO_RESET_MODES[_0x16320f(0x37f)](_0x31a23b['currentSystemMode'])&&await _0x31a23b[_0x16320f(0x361)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x16320f(0x2f7)],'ack':![]});});}catch(_0x1cdc42){_0x31a23b[_0x133b5a(0x20a)][_0x133b5a(0x278)]('Reset\x20Sched\x20Error:\x20'+_0x1cdc42[_0x133b5a(0x26f)]);}}function setupDriftAnalysisScheduler(_0x9a2bbf){const _0xfcc19=a0_0x41c4f3;try{if(_0x9a2bbf['driftAnalysisTimer'])clearInterval(_0x9a2bbf[_0xfcc19(0x298)]);if(!_0x9a2bbf[_0xfcc19(0x339)])return;_0x9a2bbf[_0xfcc19(0x298)]=setInterval(()=>runBaselineDriftAnalysis(_0x9a2bbf),(_0x9a2bbf['config'][_0xfcc19(0x320)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x9a2bbf),0x1388);}catch(_0xd80676){_0x9a2bbf['log'][_0xfcc19(0x278)](_0xfcc19(0x3a1)+_0xd80676[_0xfcc19(0x26f)]);}}function setupBriefingScheduler(_0x25a126){const _0x1c26e2=a0_0x41c4f3;try{if(_0x25a126[_0x1c26e2(0x257)])_0x25a126[_0x1c26e2(0x257)][_0x1c26e2(0x1f7)]();if(!_0x25a126[_0x1c26e2(0x37d)]['briefingEnabled'])return;const _0xedb8f0=(_0x25a126[_0x1c26e2(0x37d)][_0x1c26e2(0x315)]||'08:00')['split'](':'),_0x113733=parseInt(_0xedb8f0[0x0])||0x8,_0x2656aa=parseInt(_0xedb8f0[0x1])||0x0,_0x490aae=_0x2656aa+'\x20'+_0x113733+_0x1c26e2(0x2d0);_0x25a126[_0x1c26e2(0x20a)][_0x1c26e2(0x26e)](_0x1c26e2(0x347)+_0x113733+':'+(_0x2656aa<0xa?'0'+_0x2656aa:_0x2656aa)),_0x25a126[_0x1c26e2(0x257)]=schedule['scheduleJob'](_0x490aae,()=>{sendMorningBriefing(_0x25a126);});}catch(_0x5a9070){_0x25a126[_0x1c26e2(0x20a)][_0x1c26e2(0x278)](_0x1c26e2(0x286)+_0x5a9070[_0x1c26e2(0x26f)]);}}async function sendNotification(_0xb0285d,_0x213ceb,_0x303cd4=![],_0x397d81=![]){const _0x3a79f2=a0_0x41c4f3;_0xb0285d['log']['info']((_0x303cd4?'[TEST]\x20':'')+_0x3a79f2(0x268)+_0x213ceb+'\x22');const _0xc84ba3=_0xb0285d[_0x3a79f2(0x37d)];let _0x5493c7=0x0;if(_0xc84ba3[_0x3a79f2(0x27b)]){let _0xb73fe={};(_0x213ceb[_0x3a79f2(0x37f)](_0x3a79f2(0x318))||_0x397d81)&&(_0xb73fe={'reply_markup':{'inline_keyboard':[[{'text':_0x3a79f2(0x244),'callback_data':_0x3a79f2(0x22b)}],[{'text':_0x3a79f2(0x2eb),'callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0xb0285d[_0x3a79f2(0x1c6)](_0xc84ba3['notifyTelegramInstance'],_0x3a79f2(0x204),{'text':_0x213ceb,'user':_0xc84ba3['notifyTelegramRecipient'],..._0xb73fe}),_0x5493c7++;}if(_0xc84ba3[_0x3a79f2(0x2d7)]){let _0x17762a={'message':_0x213ceb,'title':_0x397d81?_0x3a79f2(0x380):'Cogni-Living','priority':_0x397d81?0x2:0x1,'device':_0xc84ba3['notifyPushoverRecipient']};_0x397d81&&(_0x17762a[_0x3a79f2(0x2a2)]=0x1e,_0x17762a[_0x3a79f2(0x215)]=0xe10,_0x17762a[_0x3a79f2(0x232)]=_0x3a79f2(0x26b)),await _0xb0285d[_0x3a79f2(0x1c6)](_0xc84ba3[_0x3a79f2(0x261)],_0x3a79f2(0x204),_0x17762a),_0x5493c7++;}return _0xc84ba3[_0x3a79f2(0x1e9)]&&(await _0xb0285d[_0x3a79f2(0x1c6)](_0xc84ba3[_0x3a79f2(0x1ed)],_0x3a79f2(0x204),{'text':_0x213ceb,'to':_0xc84ba3[_0x3a79f2(0x31e)]}),_0x5493c7++),_0x5493c7;}async function setupTelegramListener(_0x49e7f1){const _0x180efc=a0_0x41c4f3,_0x473877=_0x49e7f1[_0x180efc(0x37d)][_0x180efc(0x245)];_0x49e7f1['config'][_0x180efc(0x27b)]&&_0x473877&&(_0x49e7f1[_0x180efc(0x20a)][_0x180efc(0x26e)]('üì°\x20Hooking\x20into\x20'+_0x473877+_0x180efc(0x2bf)),await _0x49e7f1[_0x180efc(0x202)](_0x473877+'.communicate.request'));}async function handleTelegramResponse(_0x1b6213,_0x6976d4){const _0x555c85=a0_0x41c4f3;let _0x22b1ba=_0x6976d4;_0x6976d4[_0x555c85(0x242)]('[')&&(_0x22b1ba=_0x6976d4[_0x555c85(0x2f2)](_0x6976d4[_0x555c85(0x328)](']')+0x1));if(_0x22b1ba===_0x555c85(0x22b))_0x1b6213[_0x555c85(0x20a)][_0x555c85(0x26e)](_0x555c85(0x313)),await _0x1b6213[_0x555c85(0x361)](_0x555c85(0x2f9),{'val':![],'ack':!![]}),await _0x1b6213[_0x555c85(0x361)]('analysis.alertReason',{'val':_0x555c85(0x363),'ack':!![]}),_0x1b6213[_0x555c85(0x351)]=![],sendNotification(_0x1b6213,_0x555c85(0x3a0),![]);else _0x22b1ba===_0x555c85(0x256)&&(_0x1b6213[_0x555c85(0x20a)]['warn'](_0x555c85(0x265)),sendNotification(_0x1b6213,_0x555c85(0x1f2),![],!![]));}async function runAutopilot(_0x56a207){const _0x288fc6=a0_0x41c4f3,_0x3fcc79=_0x56a207[_0x288fc6(0x37d)][_0x288fc6(0x2b7)],_0xfe6c62=_0x56a207['eventHistory'][_0x288fc6(0x2bb)]>0x0?_0x56a207[_0x288fc6(0x384)][0x0][_0x288fc6(0x3a2)]:Date['now'](),_0x442621=(Date[_0x288fc6(0x2b5)]()-_0xfe6c62)/(0x3e8*0x3c*0x3c);let _0x49aa25='';_0x56a207['config'][_0x288fc6(0x2ff)]&&_0x56a207[_0x288fc6(0x22e)]===SYSTEM_MODES[_0x288fc6(0x2f7)]&&_0x56a207['isPresent']&&(_0x442621>_0x3fcc79&&(_0x49aa25=_0x288fc6(0x34b)+_0x442621[_0x288fc6(0x288)](0x1)+_0x288fc6(0x367))),runGeminiAnalysis(_0x56a207,_0x49aa25)[_0x288fc6(0x354)](_0x8071d6=>_0x56a207[_0x288fc6(0x20a)][_0x288fc6(0x278)](_0x8071d6));}async function createDailyDigest(_0x3d2b54){const _0x4917a7=a0_0x41c4f3;if(!_0x3d2b54['isProVersion'])return;await _0x3d2b54[_0x4917a7(0x361)](LTM_DP_STATUS,{'val':_0x4917a7(0x1f5)+new Date()[_0x4917a7(0x383)](),'ack':!![]});if(!_0x3d2b54['geminiModel']||_0x3d2b54[_0x4917a7(0x386)][_0x4917a7(0x2bb)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3d2b54[_0x4917a7(0x361)](LTM_DP_STATUS,{'val':_0x4917a7(0x283),'ack':!![]});return;}const _0x55ac1a=JSON['parse'](JSON[_0x4917a7(0x2c3)](_0x3d2b54[_0x4917a7(0x386)])),_0x249ce9=_0x55ac1a[_0x4917a7(0x2bb)],_0x54e14f=_0x4917a7(0x2e8)+JSON['stringify'](_0x55ac1a);try{const _0x484104=await _0x3d2b54['geminiModel'][_0x4917a7(0x2c7)](_0x54e14f),_0x43e44e=JSON['parse'](_0x484104[_0x4917a7(0x36c)][_0x4917a7(0x280)]()['replace'](/```json|```/g,'')[_0x4917a7(0x39c)]());_0x43e44e[_0x4917a7(0x37e)]&&(_0x3d2b54['dailyDigests']['push']({'timestamp':new Date()['toISOString'](),'eventCount':_0x249ce9,'summary':_0x43e44e[_0x4917a7(0x37e)],'activityLevel':_0x43e44e[_0x4917a7(0x1ce)],'systemMode':_0x3d2b54[_0x4917a7(0x22e)]}),await saveDailyDigests(_0x3d2b54),_0x3d2b54[_0x4917a7(0x386)]=[],await saveRawEventLog(_0x3d2b54),await _0x3d2b54['setStateAsync'](LTM_DP_STATUS,{'val':_0x4917a7(0x338)+_0x249ce9+'\x20events','ack':!![]}));}catch(_0x4cc02a){await _0x3d2b54[_0x4917a7(0x361)](LTM_DP_STATUS,{'val':_0x4917a7(0x1dd)+_0x4cc02a['message'],'ack':!![]});}}async function sendMorningBriefing(_0x3373dc){const _0x3c16d6=a0_0x41c4f3;if(!_0x3373dc[_0x3c16d6(0x285)])return;_0x3373dc[_0x3c16d6(0x20a)]['info']('Generating\x20Morning\x20Briefing...');const _0x1b2af2=_0x3373dc[_0x3c16d6(0x274)][_0x3c16d6(0x2bb)]>0x0?_0x3373dc[_0x3c16d6(0x274)][_0x3373dc[_0x3c16d6(0x274)]['length']-0x1]:null,_0x2367e2=_0x1b2af2&&_0x1b2af2[_0x3c16d6(0x307)]?_0x1b2af2[_0x3c16d6(0x307)][_0x3c16d6(0x35e)]:_0x3c16d6(0x21f),_0x1ba890=new Date();_0x1ba890['setHours'](0x4,0x0,0x0,0x0);const _0x320879=_0x3373dc[_0x3c16d6(0x384)][_0x3c16d6(0x24d)](_0x248537=>new Date(_0x248537[_0x3c16d6(0x3a2)])>_0x1ba890),_0x1bf5f2=PERSONA_MAPPING[_0x3373dc[_0x3c16d6(0x37d)][_0x3c16d6(0x270)]||'generic'],_0xeea972=_0x3373dc[_0x3c16d6(0x37d)][_0x3c16d6(0x289)]||'',_0x461049=await getWeatherContext(_0x3373dc),_0x450400=await getCalendarContext(_0x3373dc),_0xe24c0e=_0x3c16d6(0x23a)+_0x1bf5f2+_0x3c16d6(0x2e3)+_0xeea972+_0x3c16d6(0x209)+_0x461049+'\x20'+_0x450400+_0x3c16d6(0x32e)+_0x2367e2+_0x3c16d6(0x39e)+JSON[_0x3c16d6(0x2c3)](_0x320879[_0x3c16d6(0x389)](0x0,0xa))+_0x3c16d6(0x2b8);try{const _0x47a4a6=await _0x3373dc[_0x3c16d6(0x285)][_0x3c16d6(0x2c7)](_0xe24c0e),_0x8f6d14='üåÖ\x20Daily\x20Briefing:\x0a'+_0x47a4a6[_0x3c16d6(0x36c)][_0x3c16d6(0x280)]()[_0x3c16d6(0x39c)]();sendNotification(_0x3373dc,_0x8f6d14),_0x3373dc[_0x3c16d6(0x20a)]['info'](_0x3c16d6(0x1e0));}catch(_0x55ac9c){_0x3373dc[_0x3c16d6(0x20a)][_0x3c16d6(0x278)](_0x3c16d6(0x28c)+_0x55ac9c[_0x3c16d6(0x26f)]);}}async function scanForDevices(_0x6e45a0,_0xf844b6){const _0x21e0d3=a0_0x41c4f3;_0x6e45a0[_0x21e0d3(0x20a)][_0x21e0d3(0x26e)](_0x21e0d3(0x1d4));const _0x3154f1=[],_0x4acd2d=await _0x6e45a0[_0x21e0d3(0x264)]('*'),_0x32a5f1=await _0x6e45a0[_0x21e0d3(0x264)](_0x21e0d3(0x20c),_0x21e0d3(0x27e)),_0x44e501=await _0x6e45a0[_0x21e0d3(0x264)](_0x21e0d3(0x334),_0x21e0d3(0x27e)),_0x2fceef={};if(_0x32a5f1)for(const _0x144f89 in _0x32a5f1){const _0x4f3137=_0x32a5f1[_0x144f89]['common'][_0x21e0d3(0x2c8)]||[];_0x4f3137[_0x21e0d3(0x226)](_0x126784=>{const _0x49a272=_0x21e0d3;if(!_0x2fceef[_0x126784])_0x2fceef[_0x126784]=[];_0x2fceef[_0x126784][_0x49a272(0x295)](_0x144f89);});}const _0x445554={};if(_0x44e501)for(const _0x3c7c57 in _0x44e501){const _0x5912d4=_0x44e501[_0x3c7c57][_0x21e0d3(0x1fc)][_0x21e0d3(0x2c8)]||[],_0x588dd4=typeof _0x44e501[_0x3c7c57][_0x21e0d3(0x1fc)][_0x21e0d3(0x21d)]===_0x21e0d3(0x369)?_0x44e501[_0x3c7c57][_0x21e0d3(0x1fc)]['name']['de']:_0x44e501[_0x3c7c57][_0x21e0d3(0x1fc)][_0x21e0d3(0x21d)];_0x5912d4['forEach'](_0x105b99=>_0x445554[_0x105b99]=_0x588dd4);}const _0x14846f=_0xf844b6['selectedFunctionIds']||[],_0x55c81c=_0xf844b6[_0x21e0d3(0x206)]!==![],_0x5d4099=_0xf844b6[_0x21e0d3(0x2c6)]!==![],_0x107d8b=_0xf844b6[_0x21e0d3(0x31c)]!==![],_0xbcf431=_0xf844b6[_0x21e0d3(0x294)]===!![],_0x1ae9d7=_0xf844b6[_0x21e0d3(0x365)]===!![];for(const _0x6c0e97 in _0x4acd2d){const _0x29f9ce=_0x4acd2d[_0x6c0e97];if(_0x29f9ce[_0x21e0d3(0x340)]!=='state'||!_0x29f9ce[_0x21e0d3(0x1fc)])continue;if(ADAPTER_BLACKLIST[_0x21e0d3(0x2b6)](_0x1527ea=>_0x6c0e97[_0x21e0d3(0x242)](_0x1527ea))&&!_0x1ae9d7)continue;const _0x2636b1=(_0x29f9ce[_0x21e0d3(0x1fc)]['role']||'')[_0x21e0d3(0x297)]();let _0x42d6e7=(typeof _0x29f9ce[_0x21e0d3(0x1fc)][_0x21e0d3(0x21d)]===_0x21e0d3(0x369)?_0x29f9ce[_0x21e0d3(0x1fc)]['name']['de']:_0x29f9ce[_0x21e0d3(0x1fc)][_0x21e0d3(0x21d)])||_0x6c0e97;const _0x5b41d2=_0x42d6e7[_0x21e0d3(0x297)]();let _0x318278=![],_0x224a11=![];if(_0x14846f[_0x21e0d3(0x2bb)]>0x0){const _0x4cb680=_0x2fceef[_0x6c0e97]||[],_0x5af7d2=_0x6c0e97[_0x21e0d3(0x1d8)]('.')[_0x21e0d3(0x389)](0x0,-0x1)[_0x21e0d3(0x303)]('.'),_0xe7b901=_0x2fceef[_0x5af7d2]||[];(_0x4cb680[_0x21e0d3(0x2b6)](_0x6fb0c3=>_0x14846f[_0x21e0d3(0x37f)](_0x6fb0c3))||_0xe7b901[_0x21e0d3(0x2b6)](_0x42df3f=>_0x14846f[_0x21e0d3(0x37f)](_0x42df3f)))&&(_0x318278=!![],_0x224a11=!![]);}if(!_0x318278&&!_0x1ae9d7){if(HARD_IGNORE_TERMS[_0x21e0d3(0x2b6)](_0x1e54f8=>_0x6c0e97[_0x21e0d3(0x37f)](_0x1e54f8)||_0x5b41d2[_0x21e0d3(0x37f)](_0x1e54f8[_0x21e0d3(0x297)]())))continue;}if(BAD_NAMES[_0x21e0d3(0x2b6)](_0xd09399=>_0x5b41d2===_0xd09399||_0x5b41d2[_0x21e0d3(0x2b1)]('.'+_0xd09399))){const _0x29eaea=_0x6c0e97[_0x21e0d3(0x1d8)]('.');if(_0x29eaea['length']>0x2){const _0x59367c=_0x29eaea['slice'](0x0,-0x1)[_0x21e0d3(0x303)]('.'),_0x466742=_0x4acd2d[_0x59367c];if(_0x466742&&_0x466742['common']&&_0x466742[_0x21e0d3(0x1fc)][_0x21e0d3(0x21d)]){const _0x1c4310=typeof _0x466742['common'][_0x21e0d3(0x21d)]===_0x21e0d3(0x369)?_0x466742[_0x21e0d3(0x1fc)][_0x21e0d3(0x21d)]['de']:_0x466742['common'][_0x21e0d3(0x21d)];_0x1c4310&&!_0x42d6e7['includes'](_0x1c4310)&&(_0x42d6e7=_0x1c4310+'\x20'+_0x42d6e7);}}}let _0x2ba846='';if(_0x55c81c&&(_0x2636b1[_0x21e0d3(0x37f)](_0x21e0d3(0x206))||_0x2636b1[_0x21e0d3(0x37f)](_0x21e0d3(0x253))||_0x5b41d2[_0x21e0d3(0x37f)](_0x21e0d3(0x312))||_0x5b41d2[_0x21e0d3(0x37f)](_0x21e0d3(0x2ca))))_0x2ba846=_0x21e0d3(0x206);else{if(!_0x2ba846&&_0x5d4099&&(_0x2636b1['includes'](_0x21e0d3(0x1d9))||_0x2636b1[_0x21e0d3(0x37f)](_0x21e0d3(0x370))||_0x2636b1[_0x21e0d3(0x37f)]('lock')||_0x2636b1[_0x21e0d3(0x37f)](_0x21e0d3(0x276))||_0x2636b1['includes'](_0x21e0d3(0x290))||_0x5b41d2[_0x21e0d3(0x37f)](_0x21e0d3(0x1f0))||_0x5b41d2['includes'](_0x21e0d3(0x2e6))||_0x5b41d2['includes']('rollladen')))_0x2ba846=_0x21e0d3(0x1d9);else{if(!_0x2ba846&&_0x107d8b&&(_0x2636b1[_0x21e0d3(0x37f)](_0x21e0d3(0x349))||_0x2636b1[_0x21e0d3(0x37f)]('switch')||_0x2636b1[_0x21e0d3(0x37f)](_0x21e0d3(0x255))||_0x5b41d2[_0x21e0d3(0x37f)](_0x21e0d3(0x373))||_0x5b41d2['includes'](_0x21e0d3(0x358))||_0x5b41d2['includes'](_0x21e0d3(0x296)))){if(_0x29f9ce['common'][_0x21e0d3(0x3a7)]||_0x2636b1[_0x21e0d3(0x37f)](_0x21e0d3(0x1c9)))_0x2ba846='light';}else{if(!_0x2ba846&&_0xbcf431&&(_0x2636b1['includes'](_0x21e0d3(0x294))||_0x2636b1[_0x21e0d3(0x37f)](_0x21e0d3(0x216))||_0x2636b1['includes'](_0x21e0d3(0x2d6))||_0x5b41d2[_0x21e0d3(0x37f)]('temp')||_0x5b41d2[_0x21e0d3(0x37f)](_0x21e0d3(0x20b))||_0x5b41d2['includes'](_0x21e0d3(0x269))))_0x2ba846='temperature';else{if(!_0x2ba846&&_0x224a11)_0x2ba846=_0x21e0d3(0x2ab);}}}}if(_0x2ba846){let _0x4fccea=_0x445554[_0x6c0e97]||'';if(!_0x4fccea){let _0xbc7908=_0x6c0e97;for(let _0x15c4a4=0x0;_0x15c4a4<0x3;_0x15c4a4++){const _0x4638a5=_0xbc7908[_0x21e0d3(0x260)]('.');if(_0x4638a5===-0x1)break;_0xbc7908=_0xbc7908[_0x21e0d3(0x2f2)](0x0,_0x4638a5);if(_0x445554[_0xbc7908]){_0x4fccea=_0x445554[_0xbc7908];break;}}}_0x3154f1['push']({'id':_0x6c0e97,'name':_0x42d6e7,'location':_0x4fccea,'type':_0x2ba846,'logDuplicates':_0x2ba846===_0x21e0d3(0x206),'isExit':![],'_score':_0x4fccea?0x50:_0x2ba846===_0x21e0d3(0x2ab)?0x5a:0x28});}}return _0x3154f1[_0x21e0d3(0x3a5)]((_0x2e5245,_0x5a30fe)=>_0x5a30fe[_0x21e0d3(0x240)]-_0x2e5245[_0x21e0d3(0x240)]),_0x3154f1;}async function executeAutomationAction(_0x7abc4e){const _0x945d6b=a0_0x41c4f3;try{const _0x296a4b=await _0x7abc4e[_0x945d6b(0x323)](_0x945d6b(0x23c)),_0x5a8558=await _0x7abc4e[_0x945d6b(0x323)](_0x945d6b(0x1c8));if(_0x296a4b&&_0x296a4b[_0x945d6b(0x217)]&&_0x5a8558){const _0x5d57c1=_0x296a4b[_0x945d6b(0x217)];let _0x54e9cf=_0x5a8558[_0x945d6b(0x217)];try{_0x54e9cf=JSON[_0x945d6b(0x2dc)](_0x54e9cf);}catch(_0x22c162){}_0x7abc4e[_0x945d6b(0x20a)][_0x945d6b(0x26e)]('ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20'+_0x5d57c1+_0x945d6b(0x325)+_0x54e9cf),await _0x7abc4e[_0x945d6b(0x2de)](_0x5d57c1,_0x54e9cf);}else _0x7abc4e[_0x945d6b(0x20a)][_0x945d6b(0x26d)](_0x945d6b(0x348));}catch(_0x4f3e3a){_0x7abc4e['log'][_0x945d6b(0x278)](_0x945d6b(0x281)+_0x4f3e3a['message']);}}function tryParse(_0x5dd583){const _0x41bb99=a0_0x41c4f3;try{return JSON[_0x41bb99(0x2dc)](_0x5dd583);}catch(_0x79da15){return null;}}async function processSensorEvent(_0x1d522e,_0x18a8d1,_0x179ad5,_0x2b3018){const _0x1e5ae1=a0_0x41c4f3;if(!_0x2b3018)return;const _0x1da3c2=_0x179ad5[_0x1e5ae1(0x217)],_0x30781b=Date[_0x1e5ae1(0x2b5)]();_0x1d522e['log'][_0x1e5ae1(0x233)]('Event\x20received:\x20'+_0x18a8d1+_0x1e5ae1(0x325)+_0x1da3c2);const _0x38b14a=_0x1d522e['sensorLastValues'][_0x18a8d1];_0x1d522e[_0x1e5ae1(0x38f)][_0x18a8d1]=_0x1da3c2;if(!_0x2b3018[_0x1e5ae1(0x2d3)]&&_0x38b14a!=undefined&&_0x38b14a==_0x1da3c2){_0x1d522e[_0x1e5ae1(0x20a)][_0x1e5ae1(0x233)](_0x1e5ae1(0x254)+_0x2b3018[_0x1e5ae1(0x21d)]+_0x1e5ae1(0x387)+_0x1da3c2+')');return;}const _0x4d58c2={'timestamp':_0x30781b,'id':_0x18a8d1,'name':_0x2b3018[_0x1e5ae1(0x21d)],'type':_0x2b3018[_0x1e5ae1(0x340)],'location':_0x2b3018[_0x1e5ae1(0x273)],'value':_0x1da3c2};_0x1d522e['eventHistory'][_0x1e5ae1(0x1ff)](_0x4d58c2);if(_0x1d522e[_0x1e5ae1(0x384)][_0x1e5ae1(0x2bb)]>HISTORY_MAX_SIZE)_0x1d522e[_0x1e5ae1(0x384)][_0x1e5ae1(0x1f1)]();await _0x1d522e[_0x1e5ae1(0x361)](_0x1e5ae1(0x2b0),{'val':JSON[_0x1e5ae1(0x2c3)](_0x4d58c2),'ack':!![]}),await _0x1d522e[_0x1e5ae1(0x361)](_0x1e5ae1(0x27c),{'val':JSON[_0x1e5ae1(0x2c3)](_0x1d522e[_0x1e5ae1(0x384)]),'ack':!![]});_0x1d522e[_0x1e5ae1(0x339)]&&(_0x1d522e[_0x1e5ae1(0x386)]['push'](_0x4d58c2),await saveRawEventLog(_0x1d522e));if(_0x2b3018['isExit']&&_0x1da3c2===!![]){if(_0x1d522e[_0x1e5ae1(0x23f)]&&!_0x1d522e[_0x1e5ae1(0x2f0)])_0x1d522e[_0x1e5ae1(0x20a)][_0x1e5ae1(0x26e)](_0x1e5ae1(0x376)+_0x2b3018[_0x1e5ae1(0x21d)]+_0x1e5ae1(0x399)),startExitTimer(_0x1d522e);else!_0x1d522e['isPresent']&&(_0x1d522e[_0x1e5ae1(0x20a)][_0x1e5ae1(0x26e)](_0x1e5ae1(0x229)+_0x2b3018[_0x1e5ae1(0x21d)]+_0x1e5ae1(0x2c1)),await setPresence(_0x1d522e,!![]));}else _0x2b3018[_0x1e5ae1(0x340)]==='motion'&&_0x1da3c2===!![]&&(_0x1d522e[_0x1e5ae1(0x2d9)]&&(_0x1d522e[_0x1e5ae1(0x20a)][_0x1e5ae1(0x26e)](_0x1e5ae1(0x324)),abortExitTimer(_0x1d522e)),!_0x1d522e['isPresent']&&_0x1d522e[_0x1e5ae1(0x22e)]===SYSTEM_MODES[_0x1e5ae1(0x2f7)]&&await setPresence(_0x1d522e,!![]));}async function runGeminiAnalysis(_0x5908c5,_0x9f21ac=''){const _0x3f7208=a0_0x41c4f3;if(!_0x5908c5[_0x3f7208(0x285)])return;if(_0x5908c5['eventHistory']['length']===0x0)return;const _0x15d070=_0x5908c5[_0x3f7208(0x384)]['slice'](0x0,0xf),_0x3d7661=await getWeatherContext(_0x5908c5),_0x38fbb6=_0x5908c5[_0x3f7208(0x22e)],_0x5f3e25=PERSONA_MAPPING[_0x5908c5[_0x3f7208(0x37d)][_0x3f7208(0x270)]||_0x3f7208(0x35b)],_0x58a269=_0x5908c5[_0x3f7208(0x37d)]['livingContext']||_0x3f7208(0x2af);let _0x249d4c=![];try{const _0x352b50=await _0x5908c5[_0x3f7208(0x323)](_0x3f7208(0x239));if(_0x352b50&&_0x352b50[_0x3f7208(0x217)])_0x249d4c=!![];}catch(_0x1f6112){}const _0x3f382f='\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20'+_0x5f3e25+_0x3f7208(0x251)+_0x58a269+_0x3f7208(0x35f)+_0x38fbb6+_0x3f7208(0x2b9)+_0x3d7661+_0x3f7208(0x214)+(_0x9f21ac||'Keiner')+_0x3f7208(0x2ac)+JSON[_0x3f7208(0x2c3)](_0x15d070)+_0x3f7208(0x2c2);try{const _0x58c9a7=await _0x5908c5[_0x3f7208(0x285)][_0x3f7208(0x2c7)](_0x3f382f),_0x107d22=_0x58c9a7[_0x3f7208(0x36c)][_0x3f7208(0x280)]()[_0x3f7208(0x32d)](/```json|```/g,'')['trim'](),_0x123ab9=JSON['parse'](_0x107d22);await _0x5908c5['setStateAsync'](_0x3f7208(0x259),{'val':JSON[_0x3f7208(0x2c3)](_0x123ab9),'ack':!![]});const _0x1d0676=_0x123ab9[_0x3f7208(0x282)]||![];_0x1d0676!==_0x5908c5[_0x3f7208(0x351)]&&(await _0x5908c5[_0x3f7208(0x361)](_0x3f7208(0x2f9),{'val':_0x1d0676,'ack':!![]}),_0x5908c5[_0x3f7208(0x351)]=_0x1d0676,_0x1d0676&&(await _0x5908c5['setStateAsync']('analysis.alertReason',{'val':_0x123ab9['alertReason'],'ack':!![]}),sendNotification(_0x5908c5,_0x3f7208(0x1ef)+_0x123ab9[_0x3f7208(0x231)],![],_0x123ab9['isEmergency']))),_0x123ab9[_0x3f7208(0x22a)]&&_0x123ab9[_0x3f7208(0x22a)][_0x3f7208(0x38c)]&&_0x123ab9[_0x3f7208(0x22a)][_0x3f7208(0x26a)]&&(_0x5908c5['log'][_0x3f7208(0x26e)](_0x3f7208(0x393)+_0x123ab9[_0x3f7208(0x22a)]['description']),await _0x5908c5['setStateAsync'](_0x3f7208(0x36a),{'val':!![],'ack':!![]}),await _0x5908c5[_0x3f7208(0x361)]('analysis.automation.description',{'val':_0x123ab9[_0x3f7208(0x22a)]['description'],'ack':!![]}),await _0x5908c5[_0x3f7208(0x361)](_0x3f7208(0x23c),{'val':_0x123ab9[_0x3f7208(0x22a)]['targetId'],'ack':!![]}),await _0x5908c5['setStateAsync'](_0x3f7208(0x1c8),{'val':JSON['stringify'](_0x123ab9['automationProposal'][_0x3f7208(0x37c)]),'ack':!![]}),_0x249d4c&&(_0x5908c5[_0x3f7208(0x20a)]['info'](_0x3f7208(0x32f)+_0x123ab9[_0x3f7208(0x22a)][_0x3f7208(0x26a)]+_0x3f7208(0x262)),await executeAutomationAction(_0x5908c5)));}catch(_0x510977){_0x5908c5[_0x3f7208(0x20a)]['error'](_0x3f7208(0x34e)+_0x510977['message']);}}function a0_0xecd6(){const _0x3a5128=['üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','.\x20ZUSATZ:\x20','log','klima','enum.functions.*','[PYTHON]\x20Service\x20exited\x20with\x20code\x20','.data.table','Raw\x20Log','AI\x20Alert\x20Status','Failed\x20to\x20send\x20to\x20Python:\x20','Normal','[PYTHON]\x20','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','expire','humidity','val','Invalid\x20JSON\x20from\x20Python:\x20','\x22\x20--break-system-packages','bind','analysis.automation.description','analysis.triggerBriefing','name','brightness','N/A','Automation\x20Proposals','Starting\x20Autopilot\x20(','onStateChange','namespace','getGenerativeModel','analysis.isEmergency','forEach','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','uuid','Entry\x20detected\x20via\x20','automationProposal','COGNI_CONFIRM_OK','scriptProblem','stdin','currentSystemMode','presence','native','alertReason','sound','debug','isArray','exitGraceTimer','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','onUnload','Health\x20&\x20Sleep\x20Analysis','analysis.automation.autoApply','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','simple-api.','analysis.automation.targetId','toString','delObjectAsync','isPresent','_score','\x20sensors...','startsWith','map','‚úÖ\x20Alles\x20OK\x20(Reset)','notifyTelegramInstance','Bibliotheken\x20nicht\x20gefunden','KALENDER:\x20Keine\x20relevanten\x20Termine','187976dOqKxA','User\x20dismissed\x20automation\x20proposal.','kill','minDaysForBaseline','system.isPresent','filter','unreach','78YAdgsi','useWeather','.\x0a\x20\x20\x20\x20KONTEXT:\x20','guest','occupancy','IGNORING\x20DUPLICATE\x20(Cached):\x20','dimmer','COGNI_REQUEST_CALL','briefingJob','Trigger\x20Analysis','analysis.lastResult','firmware','sendTo','admin.','Error\x20checking\x20WiFi:\x20','telegram','javascript.','lastIndexOf','notifyPushoverInstance','...','Fokus\x20auf\x20Familienroutinen.','getForeignObjectsAsync','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','date','AI\x20Emergency\x20Status','Sending\x20notification:\x20\x22','heizung','targetId','siren','@iobroker/adapter-core','warn','info','message','aiPersona','json','1065128gFHCCS','location','dailyDigests','info.','blind','analysis.comfortSummary','error','[LOG]','getTime','notifyTelegramEnabled','events.history','system.presenceWho','enum','systemUUID','text','BUTLER\x20Execution\x20Error:\x20','isAlert','Skipped\x20(No\x20AI\x20or\x20Data)','main','geminiModel','Briefing\x20Sched\x20Error:\x20','Drift\x20Analysis','toFixed','livingContext','400912lrcOLS','\x20min).','Briefing\x20Error:\x20','unknown','analysisInterval','python3\x20-m\x20pip\x20install\x20-r\x20\x22','shutter','analysis.automation.triggerAction',',\x20Trend=','Pattern\x20Detected','temperature','push','schalter','toLowerCase','driftAnalysisTimer','Trigger\x20Action\x20Now','\x20presence\x20devices...','status','getForeignStateAsync','KALENDER\x20ERROR:\x20','Wetter:\x20Deaktiviert','payload','analysis.analysisHistory','Feedback\x20Log','retry','997255VIDYpV','üêç\x20Starting\x20Python\x20Sidecar:\x20','üêç\x20Python\x20Trend\x20Analysis:\x20Tag=','direction','city','genAI','TREND_RESULT','Alert\x20Reason','custom','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','scheduleJob','lowbat','Keine\x20Details.','events.lastEvent','endsWith','Restlessness\x20Level','data','getLtmData','now','some','inactivityThresholdHours','.\x20OUTPUT:\x20Nur\x20Text.','.\x0a\x20\x20\x20\x20WETTER:\x20','Deviation','length','text.alarm','ltmLtbWindowDays','currentposition','\x20for\x20interactive\x20buttons...','from','.\x20Welcome\x20home.','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','stringify','ltmJob','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','doors','generateContent','members','config_pending','pr√§senz','stderr','switch','system.mode','Processing\x20Status','No\x20module\x20named','\x20*\x20*\x20*','system.meta.uuid','3393070IbGmnh','logDuplicates','connection','LTM.triggerDailyDigest','thermostat','notifyPushoverEnabled','Aktiv\x20(','exitTimer','constructor','version','parse','getDate','setForeignStateAsync','change_percent','TEST-PRO-KEY','weatherunderground.0','models/gemini-flash-latest','.\x20KONTEXT:\x20','KALENDER:\x20Keine\x20Daten','analysisTimer','t√ºr','testApiKey','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','getObjectAsync','licenseKey','üìû\x20R√ºckruf\x20anfordern','Fokus\x20auf\x20Komfort.','baselineDrift','Trigger\x20Briefing\x20(Test)','subscribeStates','isGracePeriodActive','presenceDevices','substring','stateChange','openweathermap','\x20|\x20','analysis.feedbackHistory','NORMAL','dutycycle','analysis.isAlert','indicator.alarm','service.py','valve','event','setpoint','inactivityMonitoringEnabled','number','python3','echarts.','join','child_process','find','VACATION','health','analysis.deviationFromBaseline','PRIORIT√ÑT:\x20Sicherheit.','calendarInstance','Kein\x20API\x20Key!','PRO-','System\x20Status\x20&\x20Control','analysis.alertReason','\x20events)...','KALENDER:\x20','daswetter','bewegung','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','_calName','briefingTime','getEnums','values','Alarm','GUEST','11WybDSG','setObjectNotExistsAsync','lights','PRIORIT√ÑT:\x20Gesundheit/AAL.','notifyEmailRecipient','analysis.automation','ltmDriftCheckIntervalHours','analysis.health','system','getStateAsync','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','\x20=\x20','27620agxEya','Restoring\x20sensor\x20cache\x20from\x20history\x20(','indexOf','python_service','Gemini\x20AI\x20initialized.','Logbook','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','replace','.\x20DATEN:\x20Schlaf\x20','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','accuweather.0','LTM.driftAnalysis.baselineDrift','getMonth','systemConfig','enum.rooms.*','Last\x20Result','flot.','geminiApiKey','Success:\x20Compressed\x20','isProVersion','onReady','link_quality','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','614122xpzniY','application/json','cover','type','close','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','reachable','Target\x20ID','longitude','normal','Scheduling\x20Morning\x20Briefing\x20for\x20','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','light','openweathermap.0','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','party','command','Gemini\x20Analysis\x20Error:\x20','onMessage','üêç\x20Stopping\x20Python\x20Sidecar...','lastAlertState','targetposition','cogni-living\x20adapter\x20starting\x20(v','catch','LTM.dailyDigests','scanDevices','level','lampe','value','fault','generic','triggerBriefing','dismissAutomation','sleepScore','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','LTM.rawEventLog','setStateAsync','\x0aSTB:\x20','Vom\x20Benutzer\x20best√§tigt\x20(OK).','WETTER\x20ERROR:\x20','weather','analysis.health.notes','\x20hours.\x20Potential\x20incapacitation.','ltmStbWindowDays','object','analysis.automation.patternDetected','callback','response','27DJSLfJ','getForeignObjectAsync','modeResetJob','window','Activity\x20Summary','Drift\x20Details','licht','analysis.activitySummary','analysis.trigger','Exit\x20Sensor\x20triggered\x20(','icons-mfd.','Testing\x20\x27The\x20Guardian\x27\x20(Simulating\x20Health\x20Decline:\x20[100,\x2095...\x2060])...','fill','maintenance','analysis.history_debug_00','targetValue','config','summary','includes','üö®\x20EMERGENCY','node-schedule','LTM\x20Sched\x20Error:\x20','toLocaleString','eventHistory','calendarSelection','rawEventLog','\x20(Value:\x20','testNotification','slice','apply','WETTER:\x20','detected','indicator.alarm.fire','No\x20instance','sensorLastValues','Adapter','energy','splice','ü§ñ\x20BUTLER\x20PROPOSAL:\x20','unload','devices','weatherInstance','stick_unreach','Trigger\x20Digest',').\x20Starting\x20Timer.','3rEteMO','analysisHistory','trim','writable','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','diagnosis','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','Drift\x20Sched\x20Error:\x20','timestamp','details','events.history_debug_00','sort','communicate.request','write','getCalendarNames','ack','sendToAsync','Description','analysis.automation.targetValue','sensor','vacation','instance','0\x204\x20*\x20*\x20*','Auto\x20Apply\x20Rule','activityLevel','boolean','extendObjectAsync','requirements.txt','daswetter.0','state','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','@google/generative-ai','Kalender:\x20Deaktiviert','Action','split','door','search','system.config','Last\x20Check','Error:\x20','description','üß™\x20Simulating\x20Butler\x20Proposal:\x20','Morning\x20Briefing\x20sent.','channel','0\x203\x20*\x20*\x20*','string','pythonProcess','system.','Party','Error\x20reading\x20calendar\x20table:\x20','accuweather','notifyEmailEnabled','lastCheck','(((.+)+)+)+$','analysis.automation.suggestedAction','notifyEmailInstance','power','‚ö†Ô∏è\x20ALARM:\x20','fenster','pop','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','Daily\x20Digests','Event\x20History','Started\x20at\x20','System\x20Mode','cancel','scriptEnabled','getFullYear','dependencyInstallInProgress','LTM.driftAnalysis.driftDetails','common','N/A\x20(Learning)','.NextHours.Location_1.Day_1.current.symbol_desc','unshift','LTM','Lernphase\x20(','subscribeForeignStatesAsync','Drift\x20Status','send','setState','motion','button'];a0_0xecd6=function(){return _0x3a5128;};return a0_0xecd6();}function installPythonDependencies(_0x1665a0){const _0x4aa6c0=a0_0x41c4f3;if(_0x1665a0[_0x4aa6c0(0x1fa)])return;_0x1665a0[_0x4aa6c0(0x1fa)]=!![];const _0x2ac343=path[_0x4aa6c0(0x303)](__dirname,_0x4aa6c0(0x329),_0x4aa6c0(0x1d1));_0x1665a0[_0x4aa6c0(0x20a)]['info'](_0x4aa6c0(0x342)+_0x2ac343+'...'),stopPythonService(_0x1665a0);const _0x144272=_0x4aa6c0(0x28f)+_0x2ac343+_0x4aa6c0(0x219);exec(_0x144272,(_0x41413f,_0x1d3533,_0x190ad2)=>{const _0x44ffa2=_0x4aa6c0;_0x1665a0[_0x44ffa2(0x1fa)]=![],_0x41413f?(_0x1665a0['log'][_0x44ffa2(0x278)]('‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x144272),_0x1665a0[_0x44ffa2(0x20a)][_0x44ffa2(0x278)]('Details:\x20'+(_0x190ad2||_0x41413f[_0x44ffa2(0x26f)]))):(_0x1665a0['log']['info'](_0x44ffa2(0x2c5)),startPythonService(_0x1665a0));});}function sendToPython(_0xbd06f9,_0x3f0719,_0x26133d={}){const _0x95484e=a0_0x41c4f3;if(!_0xbd06f9[_0x95484e(0x1e4)]||!_0xbd06f9[_0x95484e(0x1e4)][_0x95484e(0x22d)][_0x95484e(0x39d)])return;const _0x1b3162=JSON[_0x95484e(0x2c3)]({'command':_0x3f0719,..._0x26133d});try{_0xbd06f9[_0x95484e(0x1e4)][_0x95484e(0x22d)][_0x95484e(0x3a7)](_0x1b3162+'\x0a');}catch(_0x40d0e8){_0xbd06f9[_0x95484e(0x20a)][_0x95484e(0x278)](_0x95484e(0x211)+_0x40d0e8['message']);}}function handlePythonResult(_0xc92d10,_0x418797){const _0x38063f=a0_0x41c4f3;if(_0x418797['type']==='PONG')_0xc92d10['log'][_0x38063f(0x233)](_0x38063f(0x208));else _0x418797['type']===_0x38063f(0x2a9)&&_0xc92d10[_0x38063f(0x20a)][_0x38063f(0x26e)](_0x38063f(0x2a5)+_0x418797['payload']['tag']+_0x38063f(0x292)+_0x418797[_0x38063f(0x29f)][_0x38063f(0x39f)]+'\x20('+_0x418797[_0x38063f(0x29f)][_0x38063f(0x2df)]+'%)');}function startPythonService(_0x1d4d13){const _0x3a48c0=a0_0x41c4f3;try{const _0xb6a804=path[_0x3a48c0(0x303)](__dirname,_0x3a48c0(0x329),_0x3a48c0(0x2fb));_0x1d4d13['log']['info'](_0x3a48c0(0x2a4)+_0xb6a804),_0x1d4d13[_0x3a48c0(0x1e4)]=spawn(_0x3a48c0(0x301),[_0xb6a804]),_0x1d4d13[_0x3a48c0(0x1e4)]['stdout']['on']('data',_0x2d395e=>{const _0x5b2d7a=_0x3a48c0,_0x25687f=_0x2d395e[_0x5b2d7a(0x23d)]()[_0x5b2d7a(0x1d8)]('\x0a');_0x25687f[_0x5b2d7a(0x226)](_0x199736=>{const _0x50be6a=_0x5b2d7a,_0x26fb61=_0x199736[_0x50be6a(0x39c)]();if(!_0x26fb61)return;if(_0x26fb61['startsWith'](_0x50be6a(0x279)))_0x1d4d13[_0x50be6a(0x20a)][_0x50be6a(0x233)](_0x50be6a(0x213)+_0x26fb61[_0x50be6a(0x2f2)](0x5)[_0x50be6a(0x39c)]());else{if(_0x26fb61['startsWith']('[RESULT]'))try{const _0x478a43=JSON[_0x50be6a(0x2dc)](_0x26fb61[_0x50be6a(0x2f2)](0x8)[_0x50be6a(0x39c)]());handlePythonResult(_0x1d4d13,_0x478a43);}catch(_0x24b925){_0x1d4d13['log'][_0x50be6a(0x26d)](_0x50be6a(0x218)+_0x26fb61);}}(_0x26fb61[_0x50be6a(0x37f)](_0x50be6a(0x2cf))||_0x26fb61['includes'](_0x50be6a(0x246)))&&(_0x1d4d13[_0x50be6a(0x20a)][_0x50be6a(0x26d)]('‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...'),installPythonDependencies(_0x1d4d13));});}),_0x1d4d13[_0x3a48c0(0x1e4)][_0x3a48c0(0x2cb)]['on'](_0x3a48c0(0x2b3),_0x4ea41a=>{const _0x23ee05=_0x3a48c0,_0x273810=_0x4ea41a[_0x23ee05(0x23d)]()['trim']();_0x1d4d13['log']['error']('[PYTHON\x20ERR]\x20'+_0x273810);}),_0x1d4d13[_0x3a48c0(0x1e4)]['on'](_0x3a48c0(0x341),_0x426a05=>{const _0x36e919=_0x3a48c0;_0x1d4d13[_0x36e919(0x20a)][_0x36e919(0x26e)](_0x36e919(0x20d)+_0x426a05),_0x1d4d13[_0x36e919(0x1e4)]=null;}),_0x1d4d13[_0x3a48c0(0x1e4)]['on'](_0x3a48c0(0x278),_0x3d2f93=>{const _0x4c8f46=_0x3a48c0;_0x1d4d13[_0x4c8f46(0x20a)]['warn'](_0x4c8f46(0x227)+_0x3d2f93[_0x4c8f46(0x26f)]);});}catch(_0x6d65ec){_0x1d4d13[_0x3a48c0(0x20a)][_0x3a48c0(0x278)]('Error\x20launching\x20Python\x20service:\x20'+_0x6d65ec[_0x3a48c0(0x26f)]);}}function stopPythonService(_0x16a59a){const _0x5707ed=a0_0x41c4f3;if(_0x16a59a[_0x5707ed(0x1e4)]){_0x16a59a[_0x5707ed(0x20a)]['info'](_0x5707ed(0x350));try{_0x16a59a['pythonProcess'][_0x5707ed(0x24a)]();}catch(_0xef925d){_0x16a59a[_0x5707ed(0x20a)][_0x5707ed(0x26d)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0xef925d['message']);}_0x16a59a['pythonProcess']=null;}}class CogniLiving extends utils[a0_0x41c4f3(0x390)]{constructor(_0x35fd77){const _0x47ed64=a0_0x41c4f3;super({..._0x35fd77,'name':'cogni-living'}),this[_0x47ed64(0x384)]=[],this['analysisHistory']=[],this['feedbackHistory']=[],this[_0x47ed64(0x386)]=[],this[_0x47ed64(0x274)]=[],this[_0x47ed64(0x38f)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x47ed64(0x2d9)]=null,this[_0x47ed64(0x235)]=null,this[_0x47ed64(0x2f0)]=![],this[_0x47ed64(0x2a8)]=null,this['geminiModel']=null,this['currentSystemMode']=SYSTEM_MODES[_0x47ed64(0x2f7)],this[_0x47ed64(0x339)]=![],this[_0x47ed64(0x351)]=![],this[_0x47ed64(0x27f)]=_0x47ed64(0x28d),this[_0x47ed64(0x2e5)]=null,this[_0x47ed64(0x2c4)]=null,this[_0x47ed64(0x36f)]=null,this[_0x47ed64(0x298)]=null,this['briefingJob']=null,this[_0x47ed64(0x1e4)]=null,this[_0x47ed64(0x1fa)]=![],this['on']('ready',this[_0x47ed64(0x33a)][_0x47ed64(0x21a)](this)),this['on'](_0x47ed64(0x2f3),this['onStateChange'][_0x47ed64(0x21a)](this)),this['on'](_0x47ed64(0x394),this[_0x47ed64(0x237)][_0x47ed64(0x21a)](this)),this['on'](_0x47ed64(0x26f),this[_0x47ed64(0x34f)][_0x47ed64(0x21a)](this));}async['onReady'](){const _0x19f710=a0_0x41c4f3;this['log'][_0x19f710(0x26e)](_0x19f710(0x353)+this[_0x19f710(0x2db)]+')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE'),await initZombies(this),this[_0x19f710(0x37d)][_0x19f710(0x2ea)]=this['config'][_0x19f710(0x2ea)]||'';try{this['isProVersion']=await checkLicense(this,this[_0x19f710(0x37d)][_0x19f710(0x2ea)]);}catch(_0x3859de){}if(!this['config'][_0x19f710(0x2b7)]||this[_0x19f710(0x37d)]['inactivityThresholdHours']<0.1)this[_0x19f710(0x37d)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x19f710(0x37d)]['geminiApiKey'])try{this[_0x19f710(0x2a8)]=new GoogleGenerativeAI(this['config'][_0x19f710(0x337)]),this[_0x19f710(0x285)]=this[_0x19f710(0x2a8)][_0x19f710(0x224)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x19f710(0x33e)}}),this['log'][_0x19f710(0x26e)](_0x19f710(0x32a));}catch(_0x2118b7){this['log'][_0x19f710(0x278)]('Gemini\x20Init\x20Error:\x20'+_0x2118b7[_0x19f710(0x26f)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x19f710(0x2ef)](_0x19f710(0x375)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x19f710(0x2ef)](_0x19f710(0x2cd)),this[_0x19f710(0x2ef)](_0x19f710(0x21c)),this[_0x19f710(0x2ef)]('analysis.automation.triggerAction'),this[_0x19f710(0x2ef)](_0x19f710(0x239)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x19f710(0x2e5)])clearInterval(this['analysisTimer']);const _0x32fe6b=this[_0x19f710(0x37d)][_0x19f710(0x28e)]||0xf;_0x32fe6b>0x0&&(this[_0x19f710(0x20a)][_0x19f710(0x26e)](_0x19f710(0x221)+_0x32fe6b+_0x19f710(0x28b)),this[_0x19f710(0x2e5)]=setInterval(()=>{runAutopilot(this);},_0x32fe6b*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x531321=_0x19f710;this[_0x531321(0x1e4)]&&(this[_0x531321(0x20a)][_0x531321(0x26e)](_0x531321(0x378)),sendToPython(this,'ANALYZE_TREND',{'values':[0x64,0x5a,0x50,0x46,0x3c],'tag':'Simulated-Vitality'}));},0x1388);}['onUnload'](_0x43e5a0){const _0x29b81e=a0_0x41c4f3;if(this[_0x29b81e(0x2e5)])clearInterval(this[_0x29b81e(0x2e5)]);if(this[_0x29b81e(0x298)])clearInterval(this[_0x29b81e(0x298)]);if(this[_0x29b81e(0x2c4)])this[_0x29b81e(0x2c4)][_0x29b81e(0x1f7)]();if(this[_0x29b81e(0x36f)])this['modeResetJob']['cancel']();if(this[_0x29b81e(0x257)])this[_0x29b81e(0x257)][_0x29b81e(0x1f7)]();if(this[_0x29b81e(0x2d9)])clearTimeout(this[_0x29b81e(0x2d9)]);if(this['exitGraceTimer'])clearTimeout(this[_0x29b81e(0x235)]);stopPythonService(this),_0x43e5a0();}async[a0_0x41c4f3(0x222)](_0xf99f7,_0x27294e){const _0x683c13=a0_0x41c4f3;if(!_0x27294e)return;if(_0xf99f7[_0x683c13(0x37f)](_0x683c13(0x25e))&&_0xf99f7[_0x683c13(0x2b1)](_0x683c13(0x3a6))&&_0x27294e[_0x683c13(0x217)]){await handleTelegramResponse(this,_0x27294e[_0x683c13(0x217)]);return;}if(_0xf99f7===this[_0x683c13(0x223)]+'.'+SYSTEM_DP_MODE){_0x27294e[_0x683c13(0x217)]&&Object[_0x683c13(0x317)](SYSTEM_MODES)['includes'](_0x27294e['val'])&&(this[_0x683c13(0x22e)]=_0x27294e[_0x683c13(0x217)],_0x27294e[_0x683c13(0x217)]===SYSTEM_MODES[_0x683c13(0x306)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x27294e[_0x683c13(0x1c5)])this[_0x683c13(0x205)](_0xf99f7,{'val':this[_0x683c13(0x22e)],'ack':!![]});return;}if(!_0x27294e[_0x683c13(0x1c5)]){_0xf99f7[_0x683c13(0x37f)](_0x683c13(0x375))&&_0x27294e['val']&&(this['setState'](_0xf99f7,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0xf99f7[_0x683c13(0x37f)]('triggerDailyDigest')&&_0x27294e[_0x683c13(0x217)]){this[_0x683c13(0x205)](_0xf99f7,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0xf99f7['includes'](_0x683c13(0x35c))&&_0x27294e['val']&&(this['setState'](_0xf99f7,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0xf99f7[_0x683c13(0x37f)]('automation.triggerAction')&&_0x27294e[_0x683c13(0x217)]&&(this[_0x683c13(0x205)](_0xf99f7,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x683c13(0x37d)]['presenceDevices']&&this[_0x683c13(0x37d)]['presenceDevices']['includes'](_0xf99f7)){await checkWifiPresence(this);return;}const _0x1eccc3=(this[_0x683c13(0x37d)][_0x683c13(0x395)]||[])[_0x683c13(0x305)](_0x1bf9c7=>_0x1bf9c7['id']===_0xf99f7);if(_0x1eccc3)processSensorEvent(this,_0xf99f7,_0x27294e,_0x1eccc3);}async[a0_0x41c4f3(0x34f)](_0x1c63ba){const _0x2cc76e=a0_0x41c4f3;if(typeof _0x1c63ba===_0x2cc76e(0x369)&&_0x1c63ba['message'])try{if(_0x1c63ba[_0x2cc76e(0x34d)]===_0x2cc76e(0x2e7)){}else{if(_0x1c63ba[_0x2cc76e(0x34d)]===_0x2cc76e(0x388)){}else{if(_0x1c63ba[_0x2cc76e(0x34d)]===_0x2cc76e(0x2b4)){if(!this[_0x2cc76e(0x339)])return this[_0x2cc76e(0x25b)](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba[_0x2cc76e(0x34d)],{'success':![],'isPro':![]},_0x1c63ba[_0x2cc76e(0x36b)]);let _0x584417={'status':_0x2cc76e(0x21f),'details':'','lastCheck':0x0};try{_0x584417[_0x2cc76e(0x29b)]=(await this[_0x2cc76e(0x323)](LTM_DP_DRIFT_STATUS))['val'],_0x584417[_0x2cc76e(0x3a3)]=(await this[_0x2cc76e(0x323)](LTM_DP_DRIFT_DETAILS))[_0x2cc76e(0x217)],_0x584417[_0x2cc76e(0x1ea)]=(await this[_0x2cc76e(0x323)](LTM_DP_DRIFT_LAST_CHECK))[_0x2cc76e(0x217)];}catch(_0xc4a1d6){}const _0x2ecd32=this[_0x2cc76e(0x39b)]||[];this[_0x2cc76e(0x25b)](_0x1c63ba['from'],_0x1c63ba[_0x2cc76e(0x34d)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x2cc76e(0x274)],'driftAnalysis':_0x584417,'analysisHistory':_0x2ecd32},_0x1c63ba['callback']);}else{if(_0x1c63ba[_0x2cc76e(0x34d)]==='getOverviewData'){const _0x4492ee=this[_0x2cc76e(0x274)][_0x2cc76e(0x2bb)],_0x502fa5=new Date(),_0x2a0652=new Date(_0x502fa5[_0x2cc76e(0x1f9)](),_0x502fa5[_0x2cc76e(0x332)](),_0x502fa5[_0x2cc76e(0x2dd)]())[_0x2cc76e(0x27a)](),_0x58da37=this[_0x2cc76e(0x386)][_0x2cc76e(0x24d)](_0x33d428=>new Date(_0x33d428[_0x2cc76e(0x3a2)])[_0x2cc76e(0x27a)]()>_0x2a0652)[_0x2cc76e(0x2bb)],_0x4ac2d8=new Array(0x18)[_0x2cc76e(0x379)](0x0);this['rawEventLog']['forEach'](_0x454004=>{const _0x2fa7c0=_0x2cc76e,_0x3ae14e=new Date(_0x454004[_0x2fa7c0(0x3a2)]);if(_0x3ae14e['getTime']()>_0x2a0652)_0x4ac2d8[_0x3ae14e['getHours']()]++;});let _0x1d0afb={'status':'N/A'};try{_0x1d0afb[_0x2cc76e(0x29b)]=(await this[_0x2cc76e(0x323)](LTM_DP_DRIFT_STATUS))[_0x2cc76e(0x217)];}catch(_0x1e3547){}let _0x3c3514='';try{const _0x32114d=await this[_0x2cc76e(0x323)](_0x2cc76e(0x27d));_0x3c3514=_0x32114d?_0x32114d[_0x2cc76e(0x217)]:'';}catch(_0x3900cd){}let _0x43fd57=null;!this[_0x2cc76e(0x285)]&&(_0x43fd57=this[_0x2cc76e(0x37d)][_0x2cc76e(0x337)]?'KI-Modell\x20nicht\x20initialisiert':_0x2cc76e(0x30b));let _0x2193eb={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x3b2d38=await this[_0x2cc76e(0x323)](_0x2cc76e(0x36a)),_0x4e9f44=await this['getStateAsync'](_0x2cc76e(0x21b)),_0x325f22=await this[_0x2cc76e(0x323)]('analysis.automation.targetId'),_0x30efcf=await this[_0x2cc76e(0x323)](_0x2cc76e(0x1c8)),_0x1abe1b=await this[_0x2cc76e(0x323)](_0x2cc76e(0x239));_0x3b2d38&&_0x3b2d38[_0x2cc76e(0x217)]&&(_0x2193eb['detected']=!![],_0x2193eb[_0x2cc76e(0x1de)]=_0x4e9f44?_0x4e9f44[_0x2cc76e(0x217)]:'',_0x2193eb[_0x2cc76e(0x26a)]=_0x325f22?_0x325f22[_0x2cc76e(0x217)]:'',_0x2193eb['targetValue']=_0x30efcf?_0x30efcf['val']:''),_0x2193eb['autoApply']=_0x1abe1b?!!_0x1abe1b[_0x2cc76e(0x217)]:![];}catch(_0x161235){}this[_0x2cc76e(0x25b)](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba['command'],{'success':!![],'eventHistory':this[_0x2cc76e(0x384)][_0x2cc76e(0x389)](0x0,0xf),'stats':{'digestCount':_0x4492ee,'eventCountToday':_0x58da37,'hourlyActivity':_0x4ac2d8,'driftStatus':_0x1d0afb[_0x2cc76e(0x29b)],'isPresent':this[_0x2cc76e(0x23f)],'presenceWho':_0x3c3514,'minDays':this[_0x2cc76e(0x37d)][_0x2cc76e(0x24b)]||0x7,'stbDays':this[_0x2cc76e(0x37d)][_0x2cc76e(0x368)]||0xe,'ltbDays':this[_0x2cc76e(0x37d)][_0x2cc76e(0x2bd)]||0x3c,'systemError':_0x43fd57},'automation':_0x2193eb},_0x1c63ba[_0x2cc76e(0x36b)]);}else{if(_0x1c63ba[_0x2cc76e(0x34d)]===_0x2cc76e(0x316)){const _0x2d80cc=await this['getForeignObjectsAsync']('enum.functions.*',_0x2cc76e(0x27e)),_0x4db8ba=[];if(_0x2d80cc)for(const _0x4dedc4 in _0x2d80cc){const _0xe7425f=_0x2d80cc[_0x4dedc4],_0x500189=(_0xe7425f[_0x2cc76e(0x1fc)]&&typeof _0xe7425f['common']['name']===_0x2cc76e(0x369)?_0xe7425f['common'][_0x2cc76e(0x21d)]['de']:_0xe7425f[_0x2cc76e(0x1fc)]['name'])||_0xe7425f[_0x2cc76e(0x1fc)][_0x2cc76e(0x21d)];_0x4db8ba[_0x2cc76e(0x295)]({'id':_0x4dedc4,'name':_0x500189});}this[_0x2cc76e(0x25b)](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba['command'],{'success':!![],'enums':_0x4db8ba},_0x1c63ba['callback']);}else{if(_0x1c63ba[_0x2cc76e(0x34d)]===_0x2cc76e(0x356))try{const _0x22d3cc=await scanForDevices(this,_0x1c63ba[_0x2cc76e(0x26f)]||{});this[_0x2cc76e(0x25b)](_0x1c63ba['from'],_0x1c63ba[_0x2cc76e(0x34d)],{'success':!![],'devices':_0x22d3cc},_0x1c63ba['callback']);}catch(_0xcbe51f){this[_0x2cc76e(0x25b)](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba['command'],{'success':![],'error':_0xcbe51f[_0x2cc76e(0x26f)]},_0x1c63ba[_0x2cc76e(0x36b)]);}else{if(_0x1c63ba[_0x2cc76e(0x34d)]===_0x2cc76e(0x3a8)){const _0x1fcda0=_0x1c63ba[_0x2cc76e(0x26f)][_0x2cc76e(0x1cb)];if(!_0x1fcda0)return this['sendTo'](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba[_0x2cc76e(0x34d)],{'success':![],'error':_0x2cc76e(0x38e)},_0x1c63ba[_0x2cc76e(0x36b)]);const _0x14bb79=await getCalendarNames(this,_0x1fcda0);this[_0x2cc76e(0x25b)](_0x1c63ba['from'],_0x1c63ba[_0x2cc76e(0x34d)],{'success':!![],'names':_0x14bb79},_0x1c63ba[_0x2cc76e(0x36b)]);}else{if(_0x1c63ba[_0x2cc76e(0x34d)]==='simulateButler'){const {targetId:_0x1ef5f9,targetValue:_0x2b779c}=_0x1c63ba[_0x2cc76e(0x26f)];this['log']['info'](_0x2cc76e(0x1df)+_0x1ef5f9+'\x20=\x20'+_0x2b779c),await this[_0x2cc76e(0x361)](_0x2cc76e(0x36a),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x2cc76e(0x21b),{'val':'SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20'+_0x1ef5f9,'ack':!![]}),await this[_0x2cc76e(0x361)](_0x2cc76e(0x23c),{'val':_0x1ef5f9,'ack':!![]}),await this[_0x2cc76e(0x361)]('analysis.automation.targetValue',{'val':_0x2b779c,'ack':!![]}),this['sendTo'](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba['command'],{'success':!![]},_0x1c63ba[_0x2cc76e(0x36b)]);}else{if(_0x1c63ba[_0x2cc76e(0x34d)]==='submitFeedback'){const {historyId:_0x319bdc,rating:_0x14695b,comment:_0x18cf36,alertReason:_0x587b90}=_0x1c63ba['message'];_0x319bdc&&_0x14695b?(await saveFeedback(this,{'timestamp':Date[_0x2cc76e(0x2b5)](),'historyId':_0x319bdc,'rating':_0x14695b,'comment':_0x18cf36,'alertReason':_0x587b90}),this['sendTo'](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba[_0x2cc76e(0x34d)],{'success':!![]},_0x1c63ba['callback'])):this['sendTo'](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba[_0x2cc76e(0x34d)],{'success':![],'error':'Missing\x20data'},_0x1c63ba['callback']);}else _0x1c63ba[_0x2cc76e(0x34d)]===_0x2cc76e(0x35d)&&(this['log'][_0x2cc76e(0x26e)](_0x2cc76e(0x249)),await this['setStateAsync'](_0x2cc76e(0x36a),{'val':![],'ack':!![]}),await this[_0x2cc76e(0x361)](_0x2cc76e(0x21b),{'val':'','ack':!![]}),this[_0x2cc76e(0x25b)](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba[_0x2cc76e(0x34d)],{'success':!![]},_0x1c63ba['callback']));}}}}}}}}}catch(_0x2ca0d7){this[_0x2cc76e(0x20a)][_0x2cc76e(0x278)]('Error\x20in\x20onMessage\x20command\x20'+_0x1c63ba['command']+':\x20'+_0x2ca0d7[_0x2cc76e(0x26f)]);if(_0x1c63ba['callback'])this[_0x2cc76e(0x25b)](_0x1c63ba[_0x2cc76e(0x2c0)],_0x1c63ba['command'],{'success':![],'error':_0x2ca0d7[_0x2cc76e(0x26f)]},_0x1c63ba[_0x2cc76e(0x36b)]);}}}if(require[a0_0x41c4f3(0x284)]!==module)module['exports']=_0x18aa8f=>new CogniLiving(_0x18aa8f);else new CogniLiving();