function a0_0xc823(){const _0x4caac6=['timestamp','Alert\x20Reason','modeResetJob','Success','analysis.comfortSuggestion','briefingEnabled','minDaysForBaseline','notifyWhatsappEnabled','\x20min).\x20Watchdog\x20Limit:\x20','getForeignObjectsAsync','version','toLocaleString','description','slice','name','setState','Creating\x20Daily\x20Digest\x20from\x20','lastAlertState','config','checkLtmDriftObjects','message','cancel','\x0a\x0aA\x20(STB):\x0a','unload','Presence\x20Status','processSensorEvent','exitTimer','log','@google/generative-ai','Adapter','Briefing\x20Error:\x20','sendMorningBriefing','livingContext','val','triggerBriefing','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','08:00','weatherunderground.0','‚ö†Ô∏è\x20Alarm','instance','currentSystemMode','button','LTM','notifyPushoverRecipient','Gemini\x20Init\x20Error:\x20','ROLLE:\x20Data\x20Analyst.\x20AUFGABE:\x20Fasse\x20den\x20heutigen\x20Tag\x20basierend\x20auf\x20den\x20Sensor-Logs\x20zusammen.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA:\x20','Trigger\x20Briefing\x20(Test)','runAutopilot','enum.functions.*','exports','suggestion','city','isEmergency','uuid','initPresenceSubscriptions','analysis.automation.patternDetected','setStateAsync','startExitTimer','includes','text.alarm','setupDriftAnalysisScheduler','initSensorSubscriptions','guest','TEST-PRO-KEY','subscribeStates','events.history_debug_01','GUEST','Party','.\x20PR√ÑSENZ:\x20','Logbook','20497824Ptksly','Description','1407Ghyyuq','isPresent','initZombies','weatherInstance','3783915oondIm','number','openweathermap.0','5967192ElAHfk','info','extendObjectAsync','runGeminiAnalysis','lastCheck','briefingJob','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','suggestedAction','analysisHistory','system.isPresent','delObjectAsync','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','now','eventHistory','response','analysis.analysisHistory','json','state','time','daswetter.0','uuid-error','Lernphase\x20(','LTM.baselineStatus','sendToAsync','2405431fJmsex','length','test','dailyDigests','onReady','activity','Deaktiviert\x20(Pro-Feature)','triggerDailyDigest','error','systemUUID','search','isExit','VACATION','ltmStbWindowDays','apiKey','getWeatherContext','events.lastEvent','sendTo','analysis.activitySummary','KALENDER:\x20Keine\x20Daten','filter','loadSystemMode','send','generic','testNotification','system.meta.uuid','Feedback\x20saved:\x20','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','values','\x0aFEEDBACK:\x0a','events.history_debug_02','\x20*\x20*\x20*','Restlessness\x20Level','sendNotification','_calName','presenceDevices','(((.+)+)+)+$','User\x20Feedback:\x20Alarm\x20\x22','System\x20Status\x20&\x20Control','text','analysisInterval','saveDailyDigests','Trigger\x20Digest','long','14296936hmUEcG','Drift\x20Status','tryParse','Daily\x20Digests','Urlaub','push','.\x20ORT:\x20','notifyPushoverEnabled','vacation','analysis.comfortSummary','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','LTM.rawEventLog','Briefing\x20Sched\x20Error:\x20','analysis.history_debug_01','Normal','.Summary.Current','\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wer\x20wohnt\x20hier?):\x20','analysis.history_debug_02','join','\x20|\x20','WETTER:\x20','notifyTelegramEnabled','notifyEmailEnabled','analysis.isAlert','Daily\x20Digest\x20created\x20successfully.','replace','find','cogni-living\x20adapter\x20starting\x20(v','LTM.driftAnalysis.driftDetails','581118XFAIev','system','Wetter:\x20Deaktiviert','split','analysis.health.restlessness','5458zBnQfP','toISOString','KALENDER:\x20','ltmDriftCheckIntervalHours','ack','LTM.driftAnalysis.lastCheck','isGracePeriodActive','updateBaselineStatus','ltmJob','Subscribing\x20to\x20','geminiModel','driftAnalysisTimer','date','bind','subscribeForeignStatesAsync','runBaselineDriftAnalysis','logDuplicates','models/gemini-flash-latest','updateAnalysisHistory','Starting\x20Autopilot\x20(','getStateAsync','notifySignalInstance','common','createAllObjects','indicator','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','getGenerativeModel','analysis.lastResult','Kalender:\x20Deaktiviert','notes','onStateChange','analysis.trigger','@iobroker/adapter-core','\x0a\x20\x20\x20\x20\x20\x20\x20\x20INPUT:\x20','uuid-not-found','checkLicense','Trigger\x20Analysis','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','\x20sensors...','rawEventLog','parse','N/A','setupModeResetScheduler','expire','native','initHistory','scheduleJob','Fehler:\x20','command','location','notifyWhatsappInstance','setupLtmScheduler','PARTY','inactivityThresholdHours','ical.0','callback','abortExitTimer','events.history','Nein','party','Scheduling\x20Morning\x20Briefing\x20for\x20','briefingTime','restlessness','Sending\x20notification:\x20\x22','comfort','generateContent','getForeignStateAsync','normal','feedbackHistory','analysisTimer','notifyPushoverInstance','Analysis\x20Error:\x20','genAI','events.history_debug_04','channel','main','catch','Daily\x20Digest\x20erstellt\x20&\x20gespeichert.','analysis.history_debug_00','analysis.health.sleepScore','system.mode','object','0\x204\x20*\x20*\x20*','Comfort\x20Suggestion','analysis.health.notes','analysis.isEmergency','map','retry','/100\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Aktivit√§t\x20seit\x2004:00\x20Uhr:\x20','Error\x20creating\x20objects:\x20','sleepScore','NORMAL','onMessage','LTM.triggerDailyDigest','analysis.history_debug_04','health','.data.table','initSystemConfig','analysis.alertReason','events.history_debug_03','accuweather','LTM.driftAnalysis','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20EXTERNER\x20KONTEXT\x20(WICHTIG):\x20','isArray','Raw\x20Log','Sleep\x20Score\x20(0-100)','Drift\x20Sched\x20Error:\x20','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','Automation\x20Proposals','boolean','getForeignObjectAsync','scanDevices','0\x203\x20*\x20*\x20*','exitGraceTimer','notifyTelegramInstance','setPresence','sensorLastValues','aiPersona','rating','analysis.automation.description','analysis.automation','ready','LTM.driftAnalysis.baselineDrift','siren','setObjectNotExistsAsync','checkLtmObjects','isProVersion','\x20Tage)','saveFeedback','getCalendarContext','notifySignalRecipient','unknown','onUnload','ltmLtbWindowDays','none','4WZkzlF','loadRawEventLog','licenseKey','createDailyDigest','devices','driftDetails','Last\x20Check','baselineDrift','trim','checkWifiPresence','patternDetected','getObjectAsync','Missing\x20data','startsWith','useCalendar','Error\x20checking\x20WiFi:\x20','Baseline:\x20Inactive\x20(Pro\x20Feature).','N/A\x20(Learning)','alertReason','calendarSelection','Zu\x20wenig\x20Daten\x20f√ºr\x20Daily\x20Digest.','License\x20Check\x20failed:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20ZUSATZ-KONTEXT:\x20','analysis.automation.suggestedAction','Processing\x20Status','notifyEmailInstance','System\x20Mode','accuweather.0','analysis.health','testContext','pop','analysis.triggerBriefing','stringify','No\x20Key','üö®\x20EMERGENCY','summary','\x20raw\x20events...','splice','activityLevel','setupBriefingScheduler','automationProposal','.\x20PERSONA:\x20','de-DE','status','.NextHours.Location_1.Day_1.current.symbol_desc','\x20presence\x20devices...','unshift','apply','constructor','[TEST]\x20','loadDailyDigests','saveRawEventLog','Gast','useWeather','systemConfig','calendarInstance','checkSystemObjects','2-digit','sound','from','latitude','online','LTM.processingStatus','üö®üö®\x20NOTFALL','longitude','analysis.history_debug_03','toFixed','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','Drift\x20Details','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','details','toString','getSystemUUID','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT\x20(Wohnen):\x20','AI\x20Emergency\x20Status','testApiKey','application/json','getCalendarNames','string','isAlert'];a0_0xc823=function(){return _0x4caac6;};return a0_0xc823();}const a0_0x2fbfd0=a0_0x1fa6;(function(_0x1b3524,_0x594722){const _0x142144=a0_0x1fa6,_0x40c1c4=_0x1b3524();while(!![]){try{const _0x1762e3=parseInt(_0x142144(0x100))/0x1+-parseInt(_0x142144(0x105))/0x2*(parseInt(_0x142144(0x224))/0x3)+-parseInt(_0x142144(0x18c))/0x4*(-parseInt(_0x142144(0x228))/0x5)+parseInt(_0x142144(0x22b))/0x6+parseInt(_0x142144(0xb7))/0x7+parseInt(_0x142144(0xe3))/0x8+-parseInt(_0x142144(0x222))/0x9;if(_0x1762e3===_0x594722)break;else _0x40c1c4['push'](_0x40c1c4['shift']());}catch(_0x25567a){_0x40c1c4['push'](_0x40c1c4['shift']());}}}(a0_0xc823,0xdd212));const a0_0x1dad9e=(function(){let _0x413be7=!![];return function(_0x5169c1,_0x16c972){const _0x5d4f60=_0x413be7?function(){const _0x492c12=a0_0x1fa6;if(_0x16c972){const _0x5200b0=_0x16c972[_0x492c12(0x1bb)](_0x5169c1,arguments);return _0x16c972=null,_0x5200b0;}}:function(){};return _0x413be7=![],_0x5d4f60;};}()),a0_0x15f80f=a0_0x1dad9e(this,function(){const _0x558791=a0_0x1fa6;return a0_0x15f80f[_0x558791(0x1d3)]()[_0x558791(0xc1)](_0x558791(0xdb))[_0x558791(0x1d3)]()[_0x558791(0x1bc)](a0_0x15f80f)[_0x558791(0xc1)](_0x558791(0xdb));});function a0_0x1fa6(_0x4bd03a,_0x166dab){const _0x283675=a0_0xc823();return a0_0x1fa6=function(_0x15f80f,_0x1dad9e){_0x15f80f=_0x15f80f-0xb7;let _0xc8232f=_0x283675[_0x15f80f];return _0xc8232f;},a0_0x1fa6(_0x4bd03a,_0x166dab);}a0_0x15f80f();'use strict';const utils=require(a0_0x2fbfd0(0x125)),{GoogleGenerativeAI}=require(a0_0x2fbfd0(0x1f8)),schedule=require('node-schedule'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x2fbfd0(0x175),MODE_RESET_SCHEDULE=a0_0x2fbfd0(0x157),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x2fbfd0(0xee),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x2fbfd0(0x1ca),LTM_DP_TRIGGER_DIGEST=a0_0x2fbfd0(0x162),LTM_DP_BASELINE_STATUS=a0_0x2fbfd0(0x241),LTM_DP_DRIFT_CHANNEL=a0_0x2fbfd0(0x16a),LTM_DP_DRIFT_STATUS=a0_0x2fbfd0(0x17f),LTM_DP_DRIFT_DETAILS=a0_0x2fbfd0(0xff),LTM_DP_DRIFT_LAST_CHECK=a0_0x2fbfd0(0x10a),SYSTEM_DP_MODE=a0_0x2fbfd0(0x155),SYSTEM_MODES={'NORMAL':a0_0x2fbfd0(0x148),'VACATION':a0_0x2fbfd0(0xeb),'PARTY':a0_0x2fbfd0(0x140),'GUEST':a0_0x2fbfd0(0x21a)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x2fbfd0(0x139)],SYSTEM_MODES[a0_0x2fbfd0(0x21e)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x2fbfd0(0x1ff),'senior_aal':a0_0x2fbfd0(0x1d1),'family':a0_0x2fbfd0(0x1cf),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':'PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.'};class CogniLiving extends utils[a0_0x2fbfd0(0x1f9)]{constructor(_0x3bfbbc){const _0x2b8cc8=a0_0x2fbfd0;super({..._0x3bfbbc,'name':'cogni-living'}),this[_0x2b8cc8(0x238)]=[],this['analysisHistory']=[],this[_0x2b8cc8(0x149)]=[],this[_0x2b8cc8(0x12c)]=[],this[_0x2b8cc8(0xba)]=[],this[_0x2b8cc8(0x179)]={},this['systemConfig']={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this['exitTimer']=null,this[_0x2b8cc8(0x176)]=null,this[_0x2b8cc8(0x10b)]=![],this[_0x2b8cc8(0x14d)]=null,this['geminiModel']=null,this['currentSystemMode']=SYSTEM_MODES[_0x2b8cc8(0x160)],this[_0x2b8cc8(0x183)]=![],this[_0x2b8cc8(0x1ed)]=![],this[_0x2b8cc8(0xc0)]=_0x2b8cc8(0x188),this[_0x2b8cc8(0x14a)]=null,this['ltmJob']=null,this['modeResetJob']=null,this[_0x2b8cc8(0x110)]=null,this[_0x2b8cc8(0x230)]=null,this['on'](_0x2b8cc8(0x17e),this[_0x2b8cc8(0xbb)][_0x2b8cc8(0x112)](this)),this['on']('stateChange',this[_0x2b8cc8(0x123)]['bind'](this)),this['on'](_0x2b8cc8(0x1f3),this['onUnload']['bind'](this)),this['on'](_0x2b8cc8(0x1f0),this['onMessage'][_0x2b8cc8(0x112)](this));}async[a0_0x2fbfd0(0xbb)](){const _0x4ae430=a0_0x2fbfd0;this[_0x4ae430(0x1f7)]['info'](_0x4ae430(0xfe)+this[_0x4ae430(0x1e6)]+')\x20-\x20OBFUSCATION\x20SAFE\x20MODE'),await this[_0x4ae430(0x226)](),this['config'][_0x4ae430(0x18e)]=this[_0x4ae430(0x1ee)][_0x4ae430(0x18e)]||'';try{this[_0x4ae430(0x183)]=await this['checkLicense'](this[_0x4ae430(0x1ee)]['licenseKey']);}catch(_0x9fc638){this[_0x4ae430(0x1f7)]['error'](_0x4ae430(0x1a1)+_0x9fc638['message']);}if(!this[_0x4ae430(0x1ee)][_0x4ae430(0x13a)]||this['config'][_0x4ae430(0x13a)]<0.1)this['config'][_0x4ae430(0x13a)]=0xc;await this['initHistory'](),await this[_0x4ae430(0x166)]();if(this[_0x4ae430(0x1ee)]['geminiApiKey'])try{this[_0x4ae430(0x14d)]=new GoogleGenerativeAI(this['config']['geminiApiKey']),this[_0x4ae430(0x10f)]=this[_0x4ae430(0x14d)][_0x4ae430(0x11f)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x4ae430(0x1d8)}}),this[_0x4ae430(0x1f7)][_0x4ae430(0x22c)]('Gemini\x20AI\x20initialized.');}catch(_0x575481){this[_0x4ae430(0x1f7)][_0x4ae430(0xbf)](_0x4ae430(0x208)+_0x575481[_0x4ae430(0x1f0)]);}await this[_0x4ae430(0x11c)](),await this['loadSystemMode'](),await this[_0x4ae430(0x18d)](),await this[_0x4ae430(0x1be)](),this['subscribeStates'](_0x4ae430(0x124)),this[_0x4ae430(0x21c)](LTM_DP_TRIGGER_DIGEST),this[_0x4ae430(0x21c)]('system.mode'),this[_0x4ae430(0x21c)](_0x4ae430(0x1ab)),await this[_0x4ae430(0x219)](),await this[_0x4ae430(0x212)]();if(this[_0x4ae430(0x14a)])clearInterval(this[_0x4ae430(0x14a)]);const _0xf8bec8=this[_0x4ae430(0x1ee)]['analysisInterval']||0xf;_0xf8bec8>0x0&&(this[_0x4ae430(0x1f7)]['info'](_0x4ae430(0x118)+_0xf8bec8+_0x4ae430(0x1e4)+this[_0x4ae430(0x1ee)][_0x4ae430(0x13a)]+'h.'),this[_0x4ae430(0x14a)]=setInterval(()=>{const _0x215929=_0x4ae430;this[_0x215929(0x20b)]();},_0xf8bec8*0x3c*0x3e8)),this['setupLtmScheduler'](),this[_0x4ae430(0x12f)](),this['setupDriftAnalysisScheduler'](),this['setupBriefingScheduler']();}[a0_0x2fbfd0(0x189)](_0x59382a){const _0x28e5cb=a0_0x2fbfd0;if(this[_0x28e5cb(0x14a)])clearInterval(this[_0x28e5cb(0x14a)]);if(this[_0x28e5cb(0x110)])clearInterval(this['driftAnalysisTimer']);if(this[_0x28e5cb(0x10d)])this[_0x28e5cb(0x10d)][_0x28e5cb(0x1f1)]();if(this[_0x28e5cb(0x1de)])this[_0x28e5cb(0x1de)][_0x28e5cb(0x1f1)]();if(this['briefingJob'])this[_0x28e5cb(0x230)]['cancel']();if(this[_0x28e5cb(0x1f6)])clearTimeout(this[_0x28e5cb(0x1f6)]);if(this[_0x28e5cb(0x176)])clearTimeout(this[_0x28e5cb(0x176)]);_0x59382a();}async['onStateChange'](_0x12ee3f,_0x1584ce){const _0x2ca1a9=a0_0x2fbfd0;if(!_0x1584ce)return;if(_0x12ee3f===this['namespace']+'.'+SYSTEM_DP_MODE){_0x1584ce['val']&&Object[_0x2ca1a9(0xd3)](SYSTEM_MODES)[_0x2ca1a9(0x216)](_0x1584ce[_0x2ca1a9(0x1fd)])&&(this[_0x2ca1a9(0x204)]=_0x1584ce[_0x2ca1a9(0x1fd)],_0x1584ce[_0x2ca1a9(0x1fd)]===SYSTEM_MODES[_0x2ca1a9(0xc3)]?await this['setPresence'](![]):await this[_0x2ca1a9(0x178)](!![]));if(!_0x1584ce['ack'])this[_0x2ca1a9(0x1eb)](_0x12ee3f,{'val':this[_0x2ca1a9(0x204)],'ack':!![]});return;}if(!_0x1584ce[_0x2ca1a9(0x109)]){_0x12ee3f['includes'](_0x2ca1a9(0x124))&&_0x1584ce[_0x2ca1a9(0x1fd)]&&(this[_0x2ca1a9(0x1eb)](_0x12ee3f,{'val':![],'ack':!![]}),this[_0x2ca1a9(0x22e)]());if(_0x12ee3f['includes'](_0x2ca1a9(0xbe))&&_0x1584ce[_0x2ca1a9(0x1fd)]){this[_0x2ca1a9(0x1eb)](_0x12ee3f,{'val':![],'ack':!![]});if(this[_0x2ca1a9(0x183)])this[_0x2ca1a9(0x18f)]();}_0x12ee3f[_0x2ca1a9(0x216)](_0x2ca1a9(0x1fe))&&_0x1584ce[_0x2ca1a9(0x1fd)]&&(this[_0x2ca1a9(0x1eb)](_0x12ee3f,{'val':![],'ack':!![]}),this[_0x2ca1a9(0x1fb)]());return;}if(this[_0x2ca1a9(0x1ee)]['presenceDevices']&&this[_0x2ca1a9(0x1ee)][_0x2ca1a9(0xda)][_0x2ca1a9(0x216)](_0x12ee3f)){await this[_0x2ca1a9(0x195)]();return;}const _0x1463fb=(this['config'][_0x2ca1a9(0x190)]||[])[_0x2ca1a9(0xfd)](_0xb404c3=>_0xb404c3['id']===_0x12ee3f);if(_0x1463fb)this[_0x2ca1a9(0x1f5)](_0x12ee3f,_0x1584ce,_0x1463fb);}async[a0_0x2fbfd0(0x161)](_0xb28cc2){const _0x46d3de=a0_0x2fbfd0;if(typeof _0xb28cc2==='object'&&_0xb28cc2[_0x46d3de(0x1f0)])try{if(_0xb28cc2[_0x46d3de(0x135)]===_0x46d3de(0x1d7)){if(!_0xb28cc2['message'][_0x46d3de(0xc5)])return this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2['command'],{'success':![],'message':_0x46d3de(0x1ad)},_0xb28cc2[_0x46d3de(0x13c)]);try{const _0x2aa720=new GoogleGenerativeAI(_0xb28cc2[_0x46d3de(0x1f0)][_0x46d3de(0xc5)])[_0x46d3de(0x11f)]({'model':_0x46d3de(0x116)});await _0x2aa720[_0x46d3de(0x146)](_0x46d3de(0xb9)),this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':!![],'message':_0x46d3de(0x1df)},_0xb28cc2[_0x46d3de(0x13c)]);}catch(_0x58c154){this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':![],'message':_0x58c154[_0x46d3de(0x1f0)]},_0xb28cc2[_0x46d3de(0x13c)]);}}else{if(_0xb28cc2[_0x46d3de(0x135)]===_0x46d3de(0xcf)){const _0x175f19=await this[_0x46d3de(0xd8)]('[Test]\x20Notification',!![]);this[_0x46d3de(0xc8)](_0xb28cc2['from'],_0xb28cc2[_0x46d3de(0x135)],{'success':_0x175f19>0x0,'message':_0x175f19+'\x20sent'},_0xb28cc2[_0x46d3de(0x13c)]);}else{if(_0xb28cc2[_0x46d3de(0x135)]==='getLtmData'){if(!this[_0x46d3de(0x183)])return this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':![],'isPro':![]},_0xb28cc2[_0x46d3de(0x13c)]);let _0x1d3e3e={'status':_0x46d3de(0x12e),'details':'','lastCheck':0x0};try{_0x1d3e3e[_0x46d3de(0x1b7)]=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x46d3de(0x1fd)],_0x1d3e3e[_0x46d3de(0x1d2)]=(await this[_0x46d3de(0x119)](LTM_DP_DRIFT_DETAILS))['val'],_0x1d3e3e[_0x46d3de(0x22f)]=(await this[_0x46d3de(0x119)](LTM_DP_DRIFT_LAST_CHECK))['val'];}catch(_0x7ebc4c){}this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x46d3de(0xba)],'driftAnalysis':_0x1d3e3e,'analysisHistory':this[_0x46d3de(0x233)]},_0xb28cc2[_0x46d3de(0x13c)]);}else{if(_0xb28cc2['command']==='getEnums'){const _0x24007f=await this[_0x46d3de(0x1e5)](_0x46d3de(0x20c),'enum'),_0x426888=[];if(_0x24007f)for(const _0x2bd65c in _0x24007f){const _0x12408b=_0x24007f[_0x2bd65c],_0x5cfc9e=(_0x12408b[_0x46d3de(0x11b)]&&typeof _0x12408b[_0x46d3de(0x11b)][_0x46d3de(0x1ea)]===_0x46d3de(0x156)?_0x12408b[_0x46d3de(0x11b)][_0x46d3de(0x1ea)]['de']:_0x12408b['common']['name'])||_0x12408b[_0x46d3de(0x11b)][_0x46d3de(0x1ea)];_0x426888[_0x46d3de(0xe8)]({'id':_0x2bd65c,'name':_0x5cfc9e});}this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2['command'],{'success':!![],'enums':_0x426888},_0xb28cc2[_0x46d3de(0x13c)]);}else{if(_0xb28cc2[_0x46d3de(0x135)]===_0x46d3de(0x174))try{const _0x9f5ae=await this['scanForDevices'](_0xb28cc2[_0x46d3de(0x1f0)]||{});this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':!![],'devices':_0x9f5ae},_0xb28cc2['callback']);}catch(_0x3aab07){this['sendTo'](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':![],'error':_0x3aab07[_0x46d3de(0x1f0)]},_0xb28cc2[_0x46d3de(0x13c)]);}else{if(_0xb28cc2[_0x46d3de(0x135)]==='submitFeedback'){const {historyId:_0xd1ef4f,rating:_0x40b8e8,comment:_0x598e2c,alertReason:_0x214379}=_0xb28cc2['message'];_0xd1ef4f&&_0x40b8e8?(await this[_0x46d3de(0x185)]({'timestamp':Date[_0x46d3de(0x237)](),'historyId':_0xd1ef4f,'rating':_0x40b8e8,'comment':_0x598e2c,'alertReason':_0x214379}),this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':!![]},_0xb28cc2[_0x46d3de(0x13c)])):this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':![],'error':_0x46d3de(0x198)},_0xb28cc2[_0x46d3de(0x13c)]);}else{if(_0xb28cc2[_0x46d3de(0x135)]===_0x46d3de(0x1a9)){const _0x5ad4af=await this[_0x46d3de(0xc6)](),_0x3d345e=await this[_0x46d3de(0x186)]();this['sendTo'](_0xb28cc2['from'],_0xb28cc2[_0x46d3de(0x135)],{'success':!![],'weather':_0x5ad4af,'calendar':_0x3d345e},_0xb28cc2[_0x46d3de(0x13c)]);}else{if(_0xb28cc2[_0x46d3de(0x135)]===_0x46d3de(0x1d9)){const _0x33a834=_0xb28cc2['message'][_0x46d3de(0x203)];if(!_0x33a834)return this['sendTo'](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':![],'error':'No\x20instance'},_0xb28cc2[_0x46d3de(0x13c)]);const _0x30dbc9=await this['getCalendarNames'](_0x33a834);this[_0x46d3de(0xc8)](_0xb28cc2['from'],_0xb28cc2[_0x46d3de(0x135)],{'success':!![],'names':_0x30dbc9},_0xb28cc2[_0x46d3de(0x13c)]);}}}}}}}}}catch(_0x56f89c){this[_0x46d3de(0x1f7)][_0x46d3de(0xbf)]('Error\x20in\x20onMessage\x20command\x20'+_0xb28cc2[_0x46d3de(0x135)]+':\x20'+_0x56f89c['message']);if(_0xb28cc2[_0x46d3de(0x13c)])this[_0x46d3de(0xc8)](_0xb28cc2[_0x46d3de(0x1c7)],_0xb28cc2[_0x46d3de(0x135)],{'success':![],'error':_0x56f89c[_0x46d3de(0x1f0)]},_0xb28cc2['callback']);}}async[a0_0x2fbfd0(0x1f5)](_0x51f0cd,_0x380877,_0x3b98eb){const _0x4383b4=a0_0x2fbfd0;if(!_0x3b98eb[_0x4383b4(0x115)]&&this['sensorLastValues'][_0x51f0cd]===_0x380877[_0x4383b4(0x1fd)])return;this[_0x4383b4(0x179)][_0x51f0cd]=_0x380877[_0x4383b4(0x1fd)];if(this[_0x4383b4(0x10b)])return;const _0x567854=await this[_0x4383b4(0x195)]();if(_0x567854){if(!this[_0x4383b4(0x225)])await this[_0x4383b4(0x178)](!![]);}else{const _0x5451a0=_0x3b98eb[_0x4383b4(0xc2)]===!![];_0x5451a0?this[_0x4383b4(0x215)]():(this[_0x4383b4(0x1f6)]&&(this[_0x4383b4(0x1f7)][_0x4383b4(0x22c)]('Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.'),this[_0x4383b4(0x13d)]()),!this[_0x4383b4(0x225)]&&this[_0x4383b4(0x204)]===SYSTEM_MODES['NORMAL']&&await this[_0x4383b4(0x178)](!![]));}const _0x56ea46={'timestamp':_0x380877['ts'],'id':_0x51f0cd,'name':_0x3b98eb['name'],'value':_0x380877[_0x4383b4(0x1fd)],'location':_0x3b98eb[_0x4383b4(0x136)],'type':_0x3b98eb['type']};this['eventHistory']['unshift'](_0x56ea46);if(this['eventHistory'][_0x4383b4(0xb8)]>HISTORY_MAX_SIZE)this['eventHistory'][_0x4383b4(0x1aa)]();await this[_0x4383b4(0x214)](_0x4383b4(0xc7),{'val':JSON['stringify'](_0x56ea46),'ack':!![]}),await this[_0x4383b4(0x214)](_0x4383b4(0x13e),{'val':JSON[_0x4383b4(0x1ac)](this['eventHistory']),'ack':!![]}),this[_0x4383b4(0x12c)][_0x4383b4(0xe8)]({'timestamp':new Date(_0x380877['ts'])[_0x4383b4(0x106)](),'sensorName':_0x3b98eb[_0x4383b4(0x1ea)],'location':_0x3b98eb[_0x4383b4(0x136)],'value':_0x380877[_0x4383b4(0x1fd)]}),await this[_0x4383b4(0x1bf)]();}async['runAutopilot'](){const _0x4fcb09=a0_0x2fbfd0,_0x1081a7=this[_0x4fcb09(0x1ee)]['inactivityThresholdHours'],_0x1d5856=this['config']['inactivityMonitoringEnabled'],_0x58d4f1=this[_0x4fcb09(0x238)]['length']>0x0?this[_0x4fcb09(0x238)][0x0]['timestamp']:Date[_0x4fcb09(0x237)](),_0x237fbb=(Date[_0x4fcb09(0x237)]()-_0x58d4f1)/(0x3e8*0x3c*0x3c);let _0x23f4de='';_0x1d5856&&this['currentSystemMode']===SYSTEM_MODES[_0x4fcb09(0x160)]&&this[_0x4fcb09(0x225)]&&(_0x237fbb>_0x1081a7&&(_0x23f4de=_0x4fcb09(0x12a)+_0x237fbb[_0x4fcb09(0x1ce)](0x1)+'\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.'));if(_0x23f4de){this[_0x4fcb09(0x22e)](_0x23f4de)[_0x4fcb09(0x151)](_0x2727ef=>this[_0x4fcb09(0x1f7)][_0x4fcb09(0xbf)](_0x2727ef));return;}const _0x4b931a=Date[_0x4fcb09(0x237)](),_0x308c0f=_0x4b931a-_0x58d4f1,_0xd1fac5=(this[_0x4fcb09(0x1ee)][_0x4fcb09(0xdf)]||0xf)*0x3c*0x3e8;this[_0x4fcb09(0x238)][_0x4fcb09(0xb8)]>0x0&&_0x308c0f<=_0xd1fac5?this[_0x4fcb09(0x22e)]()[_0x4fcb09(0x151)](_0x585c53=>this[_0x4fcb09(0x1f7)][_0x4fcb09(0xbf)](_0x585c53)):!this['lastAlertState']&&(this[_0x4fcb09(0x1eb)](_0x4fcb09(0xfa),{'val':![],'ack':!![]}),this[_0x4fcb09(0x1eb)](_0x4fcb09(0x15a),{'val':![],'ack':!![]}));}async['runGeminiAnalysis'](_0x1071ff=''){const _0x108de2=a0_0x2fbfd0;if(!this[_0x108de2(0x10f)])return;const _0x19d53f=this['eventHistory'][_0x108de2(0xb8)]>0x0?this[_0x108de2(0x238)]:[{'note':'No\x20recorded\x20events\x20yet.'}],_0xcdcbae=PERSONA_MAPPING[this[_0x108de2(0x1ee)]['aiPersona']||'generic'],_0x23294f=this[_0x108de2(0x1ee)][_0x108de2(0x1fc)]||'',_0x241b49=this['currentSystemMode'],_0xa912ed=await this['getWeatherContext'](),_0xa9d027=await this[_0x108de2(0x186)](),_0x2b3d18=(_0xa912ed+'\x20'+_0xa9d027)['trim'](),_0x4924fb=new Date(),_0x4c8389=_0x4924fb[_0x108de2(0x1e7)](_0x108de2(0x1b6),{'weekday':_0x108de2(0xe2),'hour':'2-digit','minute':_0x108de2(0x1c5)}),_0x1ea6d0=this[_0x108de2(0x1c2)];let _0x36a4cb='';if(this['feedbackHistory'][_0x108de2(0xb8)]>0x0){const _0x483bc5=this[_0x108de2(0x149)]['slice'](0x0,0x3)[_0x108de2(0x15b)](_0x203e8d=>_0x108de2(0xdc)+_0x203e8d[_0x108de2(0x19e)]+'\x22\x20was\x20'+_0x203e8d[_0x108de2(0x17b)]+'.')[_0x108de2(0xf5)]('\x0a');_0x36a4cb=_0x108de2(0xd4)+_0x483bc5+'\x0a';}const _0x105600=_0x1071ff?_0x108de2(0x236)+_0x1071ff+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x2a5d9a=_0x108de2(0x19c),_0x19f5fe=_0x108de2(0x231)+_0x4c8389+_0x108de2(0xe9)+_0x1ea6d0[_0x108de2(0x20f)]+'.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20'+_0x241b49+_0x108de2(0x220)+(this[_0x108de2(0x225)]?'Ja':_0x108de2(0x13f))+_0x108de2(0x1d5)+_0x23294f+_0x108de2(0x1b5)+_0xcdcbae+_0x108de2(0x16b)+_0x2b3d18+_0x108de2(0xed)+_0x2a5d9a+'\x20'+_0x36a4cb+'\x20'+_0x105600+_0x108de2(0x11e)+JSON[_0x108de2(0x1ac)](_0x19d53f)+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Analysiere\x20die\x20Events\x20auf\x20Aktivit√§t,\x20Komfort\x20und\x20GESUNDHEIT.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Nutze\x20den\x20EXTERNEN\x20KONTEXT\x20(Wetter/Kalender)\x20um\x20Fehlalarme\x20zu\x20vermeiden\x20(z.B.\x20Regen\x20=\x20keine\x20Gartenaktivit√§t,\x20Termin\x20=\x20Abwesend).\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number\x20(0-100),\x20\x22restlessness\x22:\x20\x22none|low|medium|high\x22,\x20\x22notes\x22:\x20\x22string\x22\x20}\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}';try{const _0x2c3d49=await this['geminiModel'][_0x108de2(0x146)](_0x19f5fe),_0x5141b4=_0x2c3d49[_0x108de2(0x239)][_0x108de2(0xde)]()['replace'](/```json|```/g,'')[_0x108de2(0x194)](),_0x58e317=JSON[_0x108de2(0x12d)](_0x5141b4);await this[_0x108de2(0x214)](_0x108de2(0x120),{'val':_0x5141b4,'ack':!![]}),await this[_0x108de2(0x214)](_0x108de2(0x167),{'val':_0x58e317['activity'][_0x108de2(0x19e)]||'','ack':!![]}),await this[_0x108de2(0x214)]('analysis.activitySummary',{'val':_0x58e317[_0x108de2(0xbc)][_0x108de2(0x1af)]||'N/A','ack':!![]}),await this['setStateAsync']('analysis.deviationFromBaseline',{'val':_0x58e317[_0x108de2(0xbc)]['deviationFromBaseline']||_0x108de2(0x12e),'ack':!![]});_0x58e317['comfort']&&(await this[_0x108de2(0x214)](_0x108de2(0xec),{'val':_0x58e317[_0x108de2(0x145)][_0x108de2(0x1af)]||'','ack':!![]}),await this[_0x108de2(0x214)](_0x108de2(0x1e0),{'val':_0x58e317[_0x108de2(0x145)][_0x108de2(0x20e)]||'','ack':!![]}),_0x58e317[_0x108de2(0x145)][_0x108de2(0x1b4)]&&(await this[_0x108de2(0x214)](_0x108de2(0x213),{'val':_0x58e317[_0x108de2(0x145)]['automationProposal'][_0x108de2(0x196)]||![],'ack':!![]}),await this[_0x108de2(0x214)](_0x108de2(0x17c),{'val':_0x58e317[_0x108de2(0x145)][_0x108de2(0x1b4)][_0x108de2(0x1e8)]||'','ack':!![]}),await this['setStateAsync'](_0x108de2(0x1a3),{'val':_0x58e317[_0x108de2(0x145)][_0x108de2(0x1b4)][_0x108de2(0x232)]||'','ack':!![]})));_0x58e317[_0x108de2(0x164)]&&(await this[_0x108de2(0x214)](_0x108de2(0x154),{'val':typeof _0x58e317[_0x108de2(0x164)][_0x108de2(0x15f)]===_0x108de2(0x229)?_0x58e317['health']['sleepScore']:0x0,'ack':!![]}),await this[_0x108de2(0x214)]('analysis.health.restlessness',{'val':_0x58e317[_0x108de2(0x164)]['restlessness']||_0x108de2(0x18b),'ack':!![]}),await this[_0x108de2(0x214)](_0x108de2(0x159),{'val':_0x58e317['health'][_0x108de2(0x122)]||'','ack':!![]}));const _0x58eb9c=_0x58e317[_0x108de2(0xbc)][_0x108de2(0x1db)]||![],_0x15f8ce=_0x58e317[_0x108de2(0xbc)][_0x108de2(0x210)]||![];if(_0x58eb9c||_0x15f8ce){await this[_0x108de2(0x214)](_0x108de2(0xfa),{'val':!![],'ack':!![]}),await this[_0x108de2(0x214)](_0x108de2(0x15a),{'val':_0x15f8ce,'ack':!![]});if(!this[_0x108de2(0x1ed)]||_0x15f8ce){const _0x4c01dc=_0x15f8ce?_0x108de2(0x1cb):_0x108de2(0x202);this[_0x108de2(0xd8)](_0x4c01dc+':\x20'+_0x58e317['activity'][_0x108de2(0x19e)],![],_0x15f8ce);}}else await this[_0x108de2(0x214)](_0x108de2(0xfa),{'val':![],'ack':!![]}),await this[_0x108de2(0x214)]('analysis.isEmergency',{'val':![],'ack':!![]});this['lastAlertState']=_0x58eb9c||_0x15f8ce;const _0xef050={'timestamp':Date['now'](),'id':Date[_0x108de2(0x237)]()[_0x108de2(0x1d3)](),'analysis':_0x58e317,'systemMode':_0x241b49,'isPro':this['isProVersion']};this[_0x108de2(0x117)](_0xef050);}catch(_0x3dc7c8){this[_0x108de2(0x1f7)][_0x108de2(0xbf)](_0x108de2(0x14c)+_0x3dc7c8['message']);}}async['createDailyDigest'](){const _0x2813e6=a0_0x2fbfd0;if(!this[_0x2813e6(0x10f)]||this[_0x2813e6(0x12c)][_0x2813e6(0xb8)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x2813e6(0x214)](LTM_DP_STATUS,{'val':_0x2813e6(0x1a0),'ack':!![]});return;}this[_0x2813e6(0x1f7)][_0x2813e6(0x22c)](_0x2813e6(0x1ec)+this[_0x2813e6(0x12c)][_0x2813e6(0xb8)]+_0x2813e6(0x1b0)),await this[_0x2813e6(0x214)](LTM_DP_STATUS,{'val':'Analysiere\x20Tag...','ack':!![]});const _0x459664=this[_0x2813e6(0x12c)][_0x2813e6(0xb8)]>0x320?this[_0x2813e6(0x12c)][_0x2813e6(0x1e9)](this['rawEventLog']['length']-0x320):this[_0x2813e6(0x12c)],_0x3be61e=PERSONA_MAPPING[this[_0x2813e6(0x1ee)]['aiPersona']||_0x2813e6(0xce)],_0x56a984=_0x2813e6(0x209)+_0x3be61e+_0x2813e6(0x126)+JSON[_0x2813e6(0x1ac)](_0x459664)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22,\x20\x22health\x22:\x20{\x20\x22sleepScore\x22:\x20number,\x20\x22restlessness\x22:\x20\x22string\x22\x20}\x20}';try{const _0x4a0df6=await this[_0x2813e6(0x10f)]['generateContent'](_0x56a984),_0x1bb9f7=_0x4a0df6['response'][_0x2813e6(0xde)]()[_0x2813e6(0xfc)](/```json|```/g,'')[_0x2813e6(0x194)](),_0x2f88a1=JSON[_0x2813e6(0x12d)](_0x1bb9f7),_0x1a6dd1={'timestamp':new Date()['toISOString'](),'eventCount':this[_0x2813e6(0x12c)][_0x2813e6(0xb8)],'summary':_0x2f88a1[_0x2813e6(0x1af)],'activityLevel':_0x2f88a1[_0x2813e6(0x1b2)],'health':{'sleepScore':_0x2f88a1['health']?_0x2f88a1[_0x2813e6(0x164)][_0x2813e6(0x15f)]:0x0,'restlessness':_0x2f88a1['health']?_0x2f88a1['health'][_0x2813e6(0x143)]:_0x2813e6(0x18b)},'systemMode':this[_0x2813e6(0x204)]};this[_0x2813e6(0xba)][_0x2813e6(0xe8)](_0x1a6dd1),await this[_0x2813e6(0xe0)](),this[_0x2813e6(0x12c)]=[],await this[_0x2813e6(0x1bf)](),await this[_0x2813e6(0x214)](LTM_DP_STATUS,{'val':_0x2813e6(0x152),'ack':!![]}),this['log'][_0x2813e6(0x22c)](_0x2813e6(0xfb));}catch(_0x3facef){this['log'][_0x2813e6(0xbf)]('Daily\x20Digest\x20Error:\x20'+_0x3facef['message']),await this[_0x2813e6(0x214)](LTM_DP_STATUS,{'val':_0x2813e6(0x134)+_0x3facef[_0x2813e6(0x1f0)],'ack':!![]});}}async[a0_0x2fbfd0(0x1fb)](){const _0x3576ab=a0_0x2fbfd0;if(!this[_0x3576ab(0x10f)])return;this['log']['info']('Generating\x20Morning\x20Briefing...');const _0x3687bf=this['dailyDigests']['length']>0x0?this['dailyDigests'][this[_0x3576ab(0xba)][_0x3576ab(0xb8)]-0x1]:null,_0x7623f0=_0x3687bf&&_0x3687bf['health']?_0x3687bf[_0x3576ab(0x164)]['sleepScore']:_0x3576ab(0x12e),_0x1680c1=new Date();_0x1680c1['setHours'](0x4,0x0,0x0,0x0);const _0x15828b=this['eventHistory']['filter'](_0x1466dc=>new Date(_0x1466dc[_0x3576ab(0x1dc)])>_0x1680c1),_0x300f7c=PERSONA_MAPPING[this[_0x3576ab(0x1ee)][_0x3576ab(0x17a)]||_0x3576ab(0xce)],_0x238a48=this[_0x3576ab(0x1ee)][_0x3576ab(0x1fc)]||'',_0x39cf34=await this['getWeatherContext'](),_0x351c96=await this[_0x3576ab(0x186)](),_0x2d8464='ROLLE:\x20F√ºrsorglicher\x20Assistent.\x0a\x20\x20\x20\x20\x20\x20\x20\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht\x20an\x20die\x20Angeh√∂rigen/Bewohner.\x0a\x20\x20\x20\x20\x20\x20\x20\x20TON:\x20Freundlich,\x20professionell,\x20kurz.\x0a\x20\x20\x20\x20\x20\x20\x20\x20PERSONA\x20(Fokus):\x20'+_0x300f7c+_0x3576ab(0xf3)+_0x238a48+_0x3576ab(0x1a2)+_0x39cf34+'\x20'+_0x351c96+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATEN:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Schlafqualit√§t\x20letzte\x20Nacht:\x20'+_0x7623f0+_0x3576ab(0x15d)+JSON[_0x3576ab(0x1ac)](_0x15828b[_0x3576ab(0x1e9)](0x0,0xa))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20OUTPUT:\x20Nur\x20der\x20Nachrichtentext\x20(kein\x20JSON).\x20Integriere\x20den\x20Kontext\x20(Wetter/Kalender)\x20nur\x20wenn\x20relevant.';try{const _0x37e04e=await this[_0x3576ab(0x10f)][_0x3576ab(0x146)](_0x2d8464),_0x4bfa11='üåÖ\x20Daily\x20Briefing:\x0a'+_0x37e04e['response'][_0x3576ab(0xde)]()[_0x3576ab(0x194)]();this['sendNotification'](_0x4bfa11),this[_0x3576ab(0x1f7)][_0x3576ab(0x22c)]('Morning\x20Briefing\x20sent.');}catch(_0x26f2b5){this[_0x3576ab(0x1f7)][_0x3576ab(0xbf)](_0x3576ab(0x1fa)+_0x26f2b5[_0x3576ab(0x1f0)]);}}[a0_0x2fbfd0(0xe5)](_0x42896f){const _0x3a44dd=a0_0x2fbfd0;if(typeof _0x42896f===_0x3a44dd(0x156))return _0x42896f;try{return JSON[_0x3a44dd(0x12d)](_0x42896f);}catch(_0x9334be){return null;}}async[a0_0x2fbfd0(0x226)](){const _0x3ab617=a0_0x2fbfd0;try{const _0x4503b2=[_0x3ab617(0x153),_0x3ab617(0xf0),_0x3ab617(0xf4),_0x3ab617(0x1cd),_0x3ab617(0x163),'events.history_debug_00',_0x3ab617(0x21d),_0x3ab617(0xd5),_0x3ab617(0x168),_0x3ab617(0x14e)];for(const _0x4c22a0 of _0x4503b2){try{const _0x18ae66=await this[_0x3ab617(0x197)](_0x4c22a0);_0x18ae66&&await this[_0x3ab617(0x235)](_0x4c22a0);}catch(_0x568dd2){}}}catch(_0x339f4c){}}async[a0_0x2fbfd0(0x132)](){const _0x35e85f=a0_0x2fbfd0;try{const _0x665bac=await this[_0x35e85f(0x119)](_0x35e85f(0x13e));_0x665bac&&_0x665bac[_0x35e85f(0x1fd)]&&(this['eventHistory']=JSON[_0x35e85f(0x12d)](_0x665bac[_0x35e85f(0x1fd)]['toString']()));}catch(_0xdac276){this['eventHistory']=[];}try{const _0x14a44d=await this[_0x35e85f(0x119)]('analysis.analysisHistory');if(_0x14a44d&&_0x14a44d[_0x35e85f(0x1fd)])this[_0x35e85f(0x233)]=JSON[_0x35e85f(0x12d)](_0x14a44d[_0x35e85f(0x1fd)][_0x35e85f(0x1d3)]());}catch(_0xf529fa){this[_0x35e85f(0x233)]=[];}}async[a0_0x2fbfd0(0x166)](){const _0x5b527b=a0_0x2fbfd0;try{const _0x3c31d6=await this[_0x5b527b(0x173)]('system.config');_0x3c31d6&&_0x3c31d6[_0x5b527b(0x11b)]&&(this[_0x5b527b(0x1c2)]={'latitude':_0x3c31d6[_0x5b527b(0x11b)][_0x5b527b(0x1c8)]||0x0,'longitude':_0x3c31d6[_0x5b527b(0x11b)][_0x5b527b(0x1cc)]||0x0,'city':_0x3c31d6[_0x5b527b(0x11b)][_0x5b527b(0x20f)]||''});}catch(_0x342a77){}}async[a0_0x2fbfd0(0x128)](_0xe5e6ca){const _0x508908=a0_0x2fbfd0;if(!_0xe5e6ca)return![];this[_0x508908(0xc0)]=await this[_0x508908(0x1d4)]();if(_0xe5e6ca===_0x508908(0x21b)||_0xe5e6ca[_0x508908(0x199)]('PRO-'))return!![];return![];}async[a0_0x2fbfd0(0x1d4)](){const _0x2d92d9=a0_0x2fbfd0;try{const _0x1b44fc=await this[_0x2d92d9(0x173)](_0x2d92d9(0xd0));if(_0x1b44fc&&_0x1b44fc[_0x2d92d9(0x131)]&&_0x1b44fc[_0x2d92d9(0x131)][_0x2d92d9(0x211)])return _0x1b44fc['native'][_0x2d92d9(0x211)];return _0x2d92d9(0x127);}catch(_0x203a50){return _0x2d92d9(0x23f);}}async[a0_0x2fbfd0(0x11c)](){const _0x372a60=a0_0x2fbfd0;try{await this[_0x372a60(0x1c4)](),await this[_0x372a60(0x181)]('system.isPresent',{'type':_0x372a60(0x23c),'common':{'name':_0x372a60(0x1f4),'type':_0x372a60(0x172),'role':_0x372a60(0x11d),'read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0xc7),{'type':_0x372a60(0x23c),'common':{'name':'Last\x20raw\x20event','type':_0x372a60(0x1da),'role':_0x372a60(0x23b),'read':!![],'write':![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0x13e),{'type':_0x372a60(0x23c),'common':{'name':'Event\x20History','type':'string','role':_0x372a60(0x23b),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x372a60(0x124),{'type':_0x372a60(0x23c),'common':{'name':_0x372a60(0x129),'type':'boolean','role':_0x372a60(0x205),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0x1ab),{'type':_0x372a60(0x23c),'common':{'name':_0x372a60(0x20a),'type':'boolean','role':_0x372a60(0x205),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x372a60(0x120),{'type':_0x372a60(0x23c),'common':{'name':'Last\x20Result','type':'string','role':_0x372a60(0x23b),'read':!![],'write':![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0xfa),{'type':_0x372a60(0x23c),'common':{'name':'AI\x20Alert\x20Status','type':'boolean','role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0x15a),{'type':'state','common':{'name':_0x372a60(0x1d6),'type':_0x372a60(0x172),'role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x372a60(0x181)]('analysis.alertReason',{'type':_0x372a60(0x23c),'common':{'name':_0x372a60(0x1dd),'type':_0x372a60(0x1da),'role':_0x372a60(0x217),'read':!![],'write':![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0xc9),{'type':_0x372a60(0x23c),'common':{'name':'Activity\x20Summary','type':_0x372a60(0x1da),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x372a60(0x181)]('analysis.deviationFromBaseline',{'type':_0x372a60(0x23c),'common':{'name':'Deviation','type':'string','role':'state','read':!![],'write':![],'def':_0x372a60(0x12e)},'native':{}}),await this['setObjectNotExistsAsync'](_0x372a60(0xec),{'type':_0x372a60(0x23c),'common':{'name':'Comfort\x20Summary','type':'string','role':_0x372a60(0xde),'read':!![],'write':![]},'native':{}}),await this[_0x372a60(0x181)]('analysis.comfortSuggestion',{'type':_0x372a60(0x23c),'common':{'name':_0x372a60(0x158),'type':_0x372a60(0x1da),'role':_0x372a60(0xde),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](_0x372a60(0x17d),{'type':_0x372a60(0x14f),'common':{'name':_0x372a60(0x171)},'native':{}}),await this['setObjectNotExistsAsync']('analysis.automation.patternDetected',{'type':_0x372a60(0x23c),'common':{'name':'Pattern\x20Detected','type':_0x372a60(0x172),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0x17c),{'type':_0x372a60(0x23c),'common':{'name':_0x372a60(0x223),'type':'string','role':_0x372a60(0xde),'read':!![],'write':![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0x1a3),{'type':'state','common':{'name':'Action','type':_0x372a60(0x1da),'role':_0x372a60(0xde),'read':!![],'write':![]},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0x23a),{'type':'state','common':{'name':_0x372a60(0x221),'type':_0x372a60(0x1da),'role':_0x372a60(0x23b),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x372a60(0x181)]('analysis.feedbackHistory',{'type':_0x372a60(0x23c),'common':{'name':'Feedback\x20Log','type':_0x372a60(0x1da),'role':_0x372a60(0x23b),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['extendObjectAsync'](_0x372a60(0x1a8),{'type':_0x372a60(0x14f),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await this['setObjectNotExistsAsync'](_0x372a60(0x154),{'type':_0x372a60(0x23c),'common':{'name':_0x372a60(0x16e),'type':_0x372a60(0x229),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await this[_0x372a60(0x181)](_0x372a60(0x104),{'type':_0x372a60(0x23c),'common':{'name':_0x372a60(0xd7),'type':_0x372a60(0x1da),'role':_0x372a60(0xde),'read':!![],'write':![],'def':'none'},'native':{}}),await this['setObjectNotExistsAsync']('analysis.health.notes',{'type':_0x372a60(0x23c),'common':{'name':'Health\x20Notes','type':_0x372a60(0x1da),'role':_0x372a60(0xde),'read':!![],'write':![],'def':''},'native':{}}),await this[_0x372a60(0x182)](),await this['checkLtmDriftObjects']();}catch(_0xd10c54){this[_0x372a60(0x1f7)][_0x372a60(0xbf)](_0x372a60(0x15e)+_0xd10c54['message']);}}async[a0_0x2fbfd0(0x1c4)](){const _0x7c0314=a0_0x2fbfd0;await this[_0x7c0314(0x22d)](_0x7c0314(0x101),{'type':'channel','common':{'name':_0x7c0314(0xdd)},'native':{}}),await this[_0x7c0314(0x22d)](SYSTEM_DP_MODE,{'type':_0x7c0314(0x23c),'common':{'name':_0x7c0314(0x1a6),'type':'string','role':_0x7c0314(0x23c),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x7c0314(0x160)]]:_0x7c0314(0xf1),[SYSTEM_MODES[_0x7c0314(0xc3)]]:_0x7c0314(0xe7),[SYSTEM_MODES[_0x7c0314(0x139)]]:_0x7c0314(0x21f),[SYSTEM_MODES[_0x7c0314(0x21e)]]:_0x7c0314(0x1c0)}},'native':{}});}async['checkLtmObjects'](){const _0x184b10=a0_0x2fbfd0;await this['extendObjectAsync'](_0x184b10(0x206),{'type':'channel','common':{'name':_0x184b10(0x206)},'native':{}}),await this[_0x184b10(0x22d)](LTM_DP_RAW_LOG,{'type':_0x184b10(0x23c),'common':{'name':_0x184b10(0x16d),'type':'string','role':_0x184b10(0x23b),'read':!![],'write':![]},'native':{}}),await this[_0x184b10(0x22d)](LTM_DP_DAILY_DIGESTS,{'type':_0x184b10(0x23c),'common':{'name':_0x184b10(0xe6),'type':_0x184b10(0x1da),'role':_0x184b10(0x23b),'read':!![],'write':![]},'native':{}}),await this[_0x184b10(0x22d)](LTM_DP_STATUS,{'type':'state','common':{'name':_0x184b10(0x1a4),'type':_0x184b10(0x1da),'role':_0x184b10(0xde),'read':!![],'write':![]},'native':{}}),await this[_0x184b10(0x22d)](LTM_DP_TRIGGER_DIGEST,{'type':_0x184b10(0x23c),'common':{'name':_0x184b10(0xe1),'type':'boolean','role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':'state','common':{'name':'Baseline\x20Status','type':_0x184b10(0x1da),'role':_0x184b10(0xde),'read':!![],'write':![]},'native':{}});}async[a0_0x2fbfd0(0x1ef)](){const _0x2b27a0=a0_0x2fbfd0;await this[_0x2b27a0(0x22d)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':'Drift\x20Analysis'},'native':{}}),await this[_0x2b27a0(0x22d)](LTM_DP_DRIFT_STATUS,{'type':_0x2b27a0(0x23c),'common':{'name':_0x2b27a0(0xe4),'type':_0x2b27a0(0x1da),'role':_0x2b27a0(0x23c),'read':!![],'write':![],'def':_0x2b27a0(0x12e)},'native':{}}),await this['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x2b27a0(0x23c),'common':{'name':_0x2b27a0(0x1d0),'type':'string','role':_0x2b27a0(0xde),'read':!![],'write':![]},'native':{}}),await this[_0x2b27a0(0x22d)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x2b27a0(0x23c),'common':{'name':_0x2b27a0(0x192),'type':_0x2b27a0(0x229),'role':'date','read':!![],'write':![]},'native':{}});}async[a0_0x2fbfd0(0xcc)](){const _0x14ec9b=a0_0x2fbfd0;try{const _0x31610e=await this[_0x14ec9b(0x119)](SYSTEM_DP_MODE);_0x31610e&&_0x31610e[_0x14ec9b(0x1fd)]&&Object['values'](SYSTEM_MODES)[_0x14ec9b(0x216)](_0x31610e['val'])?this[_0x14ec9b(0x204)]=_0x31610e['val']:(this[_0x14ec9b(0x204)]=SYSTEM_MODES[_0x14ec9b(0x160)],await this[_0x14ec9b(0x214)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x14ec9b(0x160)],'ack':!![]}));}catch(_0x2cec10){this[_0x14ec9b(0x204)]=SYSTEM_MODES[_0x14ec9b(0x160)];}}async['loadRawEventLog'](){const _0x23765d=a0_0x2fbfd0;try{const _0x550bb6=await this[_0x23765d(0x119)](LTM_DP_RAW_LOG);if(_0x550bb6&&_0x550bb6[_0x23765d(0x1fd)])this[_0x23765d(0x12c)]=JSON[_0x23765d(0x12d)](_0x550bb6[_0x23765d(0x1fd)]);}catch(_0xd2d1e0){this['rawEventLog']=[];}}async['loadDailyDigests'](){const _0xa4fd99=a0_0x2fbfd0;try{const _0x293b74=await this[_0xa4fd99(0x119)](LTM_DP_DAILY_DIGESTS);if(_0x293b74&&_0x293b74[_0xa4fd99(0x1fd)])this[_0xa4fd99(0xba)]=JSON[_0xa4fd99(0x12d)](_0x293b74['val']);}catch(_0x9d7493){this[_0xa4fd99(0xba)]=[];}await this['updateBaselineStatus']();}async[a0_0x2fbfd0(0x1bf)](){const _0x11f033=a0_0x2fbfd0;this[_0x11f033(0x12c)][_0x11f033(0xb8)]>RAW_LOG_MAX_SIZE&&this[_0x11f033(0x12c)][_0x11f033(0x1b1)](0x0,this[_0x11f033(0x12c)][_0x11f033(0xb8)]-RAW_LOG_MAX_SIZE),await this[_0x11f033(0x214)](LTM_DP_RAW_LOG,{'val':JSON[_0x11f033(0x1ac)](this['rawEventLog']),'ack':!![]});}async['saveDailyDigests'](_0x3c90f6=!![]){const _0x439d6c=a0_0x2fbfd0,_0x4490a9=this[_0x439d6c(0x1ee)][_0x439d6c(0x18a)]||0x3c;this[_0x439d6c(0xba)][_0x439d6c(0xb8)]>_0x4490a9&&this['dailyDigests'][_0x439d6c(0x1b1)](0x0,this['dailyDigests'][_0x439d6c(0xb8)]-_0x4490a9);await this[_0x439d6c(0x214)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x439d6c(0x1ac)](this[_0x439d6c(0xba)]),'ack':!![]});if(_0x3c90f6)await this[_0x439d6c(0x10c)]();}async['updateAnalysisHistory'](_0x15a095){const _0x82e0ec=a0_0x2fbfd0;this['analysisHistory'][_0x82e0ec(0x1ba)](_0x15a095);if(this['analysisHistory'][_0x82e0ec(0xb8)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x82e0ec(0x233)][_0x82e0ec(0x1aa)]();await this[_0x82e0ec(0x214)](_0x82e0ec(0x23a),{'val':JSON['stringify'](this[_0x82e0ec(0x233)]),'ack':!![]});}async[a0_0x2fbfd0(0x10c)](){const _0x59553e=a0_0x2fbfd0;if(!this[_0x59553e(0x183)]){await this[_0x59553e(0x214)](LTM_DP_BASELINE_STATUS,{'val':_0x59553e(0xbd),'ack':!![]});return;}const _0x2f7fd2=this[_0x59553e(0xba)][_0x59553e(0xb8)]>=(this[_0x59553e(0x1ee)]['minDaysForBaseline']||0x7)?'Aktiv\x20('+this['dailyDigests']['length']+_0x59553e(0x184):_0x59553e(0x240)+this['dailyDigests'][_0x59553e(0xb8)]+'/'+(this[_0x59553e(0x1ee)][_0x59553e(0x1e2)]||0x7)+')';await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x2f7fd2,'ack':!![]});}async[a0_0x2fbfd0(0x219)](){const _0x24987f=a0_0x2fbfd0,_0x41975e=this[_0x24987f(0x1ee)][_0x24987f(0x190)];if(_0x41975e&&_0x41975e[_0x24987f(0xb8)]>0x0){this['log'][_0x24987f(0x22c)](_0x24987f(0x10e)+_0x41975e[_0x24987f(0xb8)]+_0x24987f(0x12b));for(const _0x453d3a of _0x41975e){if(_0x453d3a['id']){await this[_0x24987f(0x113)](_0x453d3a['id']);try{const _0x375d51=await this['getForeignStateAsync'](_0x453d3a['id']);if(_0x375d51)this[_0x24987f(0x179)][_0x453d3a['id']]=_0x375d51[_0x24987f(0x1fd)];}catch(_0x453d8){}}}}}async[a0_0x2fbfd0(0x212)](){const _0x1a3fe2=a0_0x2fbfd0,_0x5b2747=this[_0x1a3fe2(0x1ee)][_0x1a3fe2(0xda)]||[];if(_0x5b2747[_0x1a3fe2(0xb8)]>0x0){this[_0x1a3fe2(0x1f7)]['info'](_0x1a3fe2(0x10e)+_0x5b2747['length']+_0x1a3fe2(0x1b9));for(const _0x2b60ce of _0x5b2747){await this['subscribeForeignStatesAsync'](_0x2b60ce);}try{await this[_0x1a3fe2(0x195)]();}catch(_0x174972){}}}async['getWeatherContext'](){const _0x522a66=a0_0x2fbfd0;try{if(!this[_0x522a66(0x1ee)][_0x522a66(0x1c1)])return _0x522a66(0x102);let _0x474173='';const _0x5d1ee4=this[_0x522a66(0x1ee)][_0x522a66(0x227)];if(_0x5d1ee4)try{if(_0x5d1ee4[_0x522a66(0x216)](_0x522a66(0x169))){const _0x30f5e4=await this[_0x522a66(0x147)](_0x5d1ee4+'.Summary.Current');if(_0x30f5e4&&_0x30f5e4[_0x522a66(0x1fd)])_0x474173=_0x30f5e4[_0x522a66(0x1fd)];}else{if(_0x5d1ee4[_0x522a66(0x216)]('daswetter')){const _0x51dbe4=await this[_0x522a66(0x147)](_0x5d1ee4+_0x522a66(0x1b8));if(_0x51dbe4&&_0x51dbe4['val'])_0x474173=_0x51dbe4[_0x522a66(0x1fd)];}else{if(_0x5d1ee4[_0x522a66(0x216)]('openweathermap')){const _0x3cc205=await this[_0x522a66(0x147)](_0x5d1ee4+'.forecast.current.state');if(_0x3cc205&&_0x3cc205[_0x522a66(0x1fd)])_0x474173=_0x3cc205[_0x522a66(0x1fd)];}}}}catch(_0x476d2a){}if(!_0x474173){const _0x36a5e5=[_0x522a66(0x1a7),_0x522a66(0x23e),_0x522a66(0x201),_0x522a66(0x22a)];for(const _0x671da8 of _0x36a5e5){try{const _0x296c5a=await this[_0x522a66(0x173)](_0x671da8);if(_0x296c5a){if(_0x671da8[_0x522a66(0x216)]('accuweather')){const _0x30e591=await this[_0x522a66(0x147)](_0x671da8+_0x522a66(0xf2));if(_0x30e591&&_0x30e591[_0x522a66(0x1fd)]){_0x474173=_0x30e591['val'];break;}}}}catch(_0x3dc8c8){}}}return _0x474173?_0x522a66(0xf7)+_0x474173:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x1d4112){return'WETTER\x20ERROR:\x20'+_0x1d4112[_0x522a66(0x1f0)];}}async[a0_0x2fbfd0(0x186)](){const _0x448e42=a0_0x2fbfd0;try{if(!this[_0x448e42(0x1ee)][_0x448e42(0x19a)])return _0x448e42(0x121);let _0x4e7295=this['config'][_0x448e42(0x1c3)]||_0x448e42(0x13b),_0x3a5312=this[_0x448e42(0x1ee)][_0x448e42(0x19f)]||[];if(typeof _0x3a5312===_0x448e42(0x1da))_0x3a5312=_0x3a5312[_0x448e42(0x103)](',');try{const _0x494607=await this[_0x448e42(0x147)](_0x4e7295+_0x448e42(0x165));if(_0x494607&&_0x494607[_0x448e42(0x1fd)]){let _0x1829ca=this[_0x448e42(0xe5)](_0x494607[_0x448e42(0x1fd)]);if(_0x1829ca&&Array[_0x448e42(0x16c)](_0x1829ca)){if(_0x3a5312['length']>0x0)_0x1829ca=_0x1829ca[_0x448e42(0xcb)](_0x5ed704=>_0x3a5312[_0x448e42(0x216)](_0x5ed704[_0x448e42(0xd9)]||''));else return _0x448e42(0x170);if(_0x1829ca['length']>0x0){const _0x7fb81=_0x1829ca[_0x448e42(0x1e9)](0x0,0x3)['map'](_0x578daf=>{const _0x62355a=_0x448e42;let _0x4c26cb=_0x578daf[_0x62355a(0x111)];if(_0x578daf['time'])_0x4c26cb+='\x20'+_0x578daf[_0x62355a(0x23d)];return _0x4c26cb+':\x20'+_0x578daf['event']+'\x20('+_0x578daf[_0x62355a(0xd9)]+')';});return _0x448e42(0x107)+_0x7fb81[_0x448e42(0xf5)](_0x448e42(0xf6));}else return'KALENDER:\x20Keine\x20relevanten\x20Termine';}}}catch(_0x5c6e35){this['log']['warn']('Error\x20reading\x20calendar\x20table:\x20'+_0x5c6e35[_0x448e42(0x1f0)]);}return _0x448e42(0xca);}catch(_0x28b381){return'KALENDER\x20ERROR:\x20'+_0x28b381[_0x448e42(0x1f0)];}}async[a0_0x2fbfd0(0x1d9)](_0x313f01){const _0x399af6=a0_0x2fbfd0;try{const _0x5e9173=await this[_0x399af6(0x147)](_0x313f01+_0x399af6(0x165));if(_0x5e9173&&_0x5e9173[_0x399af6(0x1fd)]){const _0x3e7f37=this[_0x399af6(0xe5)](_0x5e9173[_0x399af6(0x1fd)]);if(_0x3e7f37&&Array[_0x399af6(0x16c)](_0x3e7f37)){const _0x2a3854=[...new Set(_0x3e7f37[_0x399af6(0x15b)](_0x14a2c7=>_0x14a2c7[_0x399af6(0xd9)])[_0x399af6(0xcb)](Boolean))];return _0x2a3854['sort']();}}return[];}catch(_0x572bf0){return this[_0x399af6(0x1f7)][_0x399af6(0xbf)]('getCalendarNames\x20Error:\x20'+_0x572bf0['message']),[];}}async[a0_0x2fbfd0(0x195)](){const _0x13c17b=a0_0x2fbfd0;try{const _0x141f8=this[_0x13c17b(0x1ee)][_0x13c17b(0xda)]||[];let _0x4e53a6=![];for(const _0x22413e of _0x141f8){try{const _0x202eaf=await this[_0x13c17b(0x147)](_0x22413e);if(_0x202eaf&&(_0x202eaf[_0x13c17b(0x1fd)]===!![]||_0x202eaf[_0x13c17b(0x1fd)]===_0x13c17b(0x1c9)||_0x202eaf['val']===0x1)){_0x4e53a6=!![];break;}}catch(_0x27878c){}}return _0x4e53a6&&(this['exitTimer']&&(this[_0x13c17b(0x1f7)]['info']('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),this[_0x13c17b(0x13d)]()),!this['isPresent']&&this['currentSystemMode']===SYSTEM_MODES[_0x13c17b(0x160)]&&await this[_0x13c17b(0x178)](!![])),_0x4e53a6;}catch(_0x4f1828){return this[_0x13c17b(0x1f7)]['error'](_0x13c17b(0x19b)+_0x4f1828[_0x13c17b(0x1f0)]),![];}}['startExitTimer'](){const _0x3af035=a0_0x2fbfd0;this['abortExitTimer'](),this[_0x3af035(0x10b)]=!![],this[_0x3af035(0x176)]=setTimeout(()=>{const _0x569600=_0x3af035;this[_0x569600(0x10b)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x3af035(0x1f6)]=setTimeout(()=>{const _0x1864a3=_0x3af035;this[_0x1864a3(0x178)](![]),this[_0x1864a3(0x1f6)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x2fbfd0(0x13d)](){const _0x2334f6=a0_0x2fbfd0;if(this[_0x2334f6(0x1f6)])clearTimeout(this[_0x2334f6(0x1f6)]);if(this[_0x2334f6(0x176)])clearTimeout(this['exitGraceTimer']);this[_0x2334f6(0x1f6)]=null,this[_0x2334f6(0x176)]=null,this[_0x2334f6(0x10b)]=![];}async[a0_0x2fbfd0(0x178)](_0x5b7b43){const _0x23ad98=a0_0x2fbfd0;if(this[_0x23ad98(0x225)]===_0x5b7b43)return;this[_0x23ad98(0x225)]=_0x5b7b43,await this['setStateAsync'](_0x23ad98(0x234),{'val':_0x5b7b43,'ack':!![]});}async[a0_0x2fbfd0(0x185)](_0x3f2b02){const _0x597f1a=a0_0x2fbfd0;this[_0x597f1a(0x1f7)][_0x597f1a(0x22c)](_0x597f1a(0xd1)+JSON[_0x597f1a(0x1ac)](_0x3f2b02));}async[a0_0x2fbfd0(0x114)](){const _0x4b3455=a0_0x2fbfd0;if(!this['isProVersion']||!this['geminiModel'])return;const _0x1561b1=this[_0x4b3455(0x1ee)][_0x4b3455(0xc4)]||0xe;if(this[_0x4b3455(0xba)][_0x4b3455(0xb8)]<_0x1561b1+(this[_0x4b3455(0x1ee)][_0x4b3455(0x1e2)]||0x7)){await this[_0x4b3455(0x214)](LTM_DP_DRIFT_STATUS,{'val':_0x4b3455(0x19d),'ack':!![]});return;}const _0x550400=this[_0x4b3455(0xba)][_0x4b3455(0x1e9)](-_0x1561b1),_0x5b9429=this[_0x4b3455(0xba)]['slice'](0x0,this['dailyDigests'][_0x4b3455(0xb8)]-_0x1561b1),_0x176e16=_0x4b3455(0xd2)+JSON[_0x4b3455(0x1ac)](_0x5b9429)+_0x4b3455(0x1f2)+JSON['stringify'](_0x550400);try{const _0x3e78b6=await this[_0x4b3455(0x10f)][_0x4b3455(0x146)](_0x176e16),_0x4747c9=JSON[_0x4b3455(0x12d)](_0x3e78b6[_0x4b3455(0x239)][_0x4b3455(0xde)]()[_0x4b3455(0xfc)](/```json|```/g,'')[_0x4b3455(0x194)]());_0x4747c9[_0x4b3455(0x193)]&&(await this[_0x4b3455(0x214)](LTM_DP_DRIFT_STATUS,{'val':_0x4747c9['baselineDrift'],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x4747c9[_0x4b3455(0x191)],'ack':!![]}),await this[_0x4b3455(0x214)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x58b7b7){}}[a0_0x2fbfd0(0x138)](){const _0x2b5180=a0_0x2fbfd0;try{if(this[_0x2b5180(0x10d)])this[_0x2b5180(0x10d)]['cancel']();if(!this[_0x2b5180(0x183)]){this[_0x2b5180(0x214)](LTM_DP_STATUS,{'val':_0x2b5180(0xbd),'ack':!![]});return;}this[_0x2b5180(0x10d)]=schedule[_0x2b5180(0x133)](LTM_SCHEDULE,()=>this['createDailyDigest']());}catch(_0x1f6b15){this[_0x2b5180(0x1f7)][_0x2b5180(0xbf)]('LTM\x20Sched\x20Error:\x20'+_0x1f6b15[_0x2b5180(0x1f0)]);}}['setupModeResetScheduler'](){const _0x170a94=a0_0x2fbfd0;try{if(this[_0x170a94(0x1de)])this[_0x170a94(0x1de)]['cancel']();this[_0x170a94(0x1de)]=schedule[_0x170a94(0x133)](MODE_RESET_SCHEDULE,async()=>{const _0x198dcd=_0x170a94;await this[_0x198dcd(0xcc)](),AUTO_RESET_MODES['includes'](this[_0x198dcd(0x204)])&&await this[_0x198dcd(0x214)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x198dcd(0x160)],'ack':![]});});}catch(_0x4c9c06){this[_0x170a94(0x1f7)]['error']('Reset\x20Sched\x20Error:\x20'+_0x4c9c06['message']);}}[a0_0x2fbfd0(0x218)](){const _0x3b3bf6=a0_0x2fbfd0;try{if(this[_0x3b3bf6(0x110)])clearInterval(this[_0x3b3bf6(0x110)]);if(!this[_0x3b3bf6(0x183)])return;this[_0x3b3bf6(0x110)]=setInterval(()=>this[_0x3b3bf6(0x114)](),(this[_0x3b3bf6(0x1ee)][_0x3b3bf6(0x108)]||0x18)*0x36ee80),setTimeout(()=>this[_0x3b3bf6(0x114)](),0x1388);}catch(_0x30722a){this[_0x3b3bf6(0x1f7)][_0x3b3bf6(0xbf)](_0x3b3bf6(0x16f)+_0x30722a[_0x3b3bf6(0x1f0)]);}}[a0_0x2fbfd0(0x1b3)](){const _0x53b7fd=a0_0x2fbfd0;try{if(this[_0x53b7fd(0x230)])this[_0x53b7fd(0x230)][_0x53b7fd(0x1f1)]();if(!this[_0x53b7fd(0x1ee)][_0x53b7fd(0x1e1)])return;const _0x9200c9=(this[_0x53b7fd(0x1ee)][_0x53b7fd(0x142)]||_0x53b7fd(0x200))[_0x53b7fd(0x103)](':'),_0x26a161=parseInt(_0x9200c9[0x0])||0x8,_0x191f21=parseInt(_0x9200c9[0x1])||0x0,_0x4838c4=_0x191f21+'\x20'+_0x26a161+_0x53b7fd(0xd6);this['log'][_0x53b7fd(0x22c)](_0x53b7fd(0x141)+_0x26a161+':'+(_0x191f21<0xa?'0'+_0x191f21:_0x191f21)),this[_0x53b7fd(0x230)]=schedule['scheduleJob'](_0x4838c4,()=>{this['sendMorningBriefing']();});}catch(_0x2aa1af){this['log'][_0x53b7fd(0xbf)](_0x53b7fd(0xef)+_0x2aa1af[_0x53b7fd(0x1f0)]);}}async[a0_0x2fbfd0(0xd8)](_0x528fe7,_0x1d62d8=![],_0x203764=![]){const _0x4f998c=a0_0x2fbfd0;this['log'][_0x4f998c(0x22c)]((_0x1d62d8?_0x4f998c(0x1bd):'')+_0x4f998c(0x144)+_0x528fe7+'\x22'+(_0x203764?'\x20(EMERGENCY)':''));const _0x13f3f2=this[_0x4f998c(0x1ee)];let _0x23e59e=0x0;_0x13f3f2[_0x4f998c(0xf8)]&&_0x13f3f2[_0x4f998c(0x177)]&&(await this[_0x4f998c(0x242)](_0x13f3f2[_0x4f998c(0x177)],'send',{'text':_0x528fe7,'user':_0x13f3f2['notifyTelegramRecipient']}),_0x23e59e++);if(_0x13f3f2[_0x4f998c(0xea)]&&_0x13f3f2[_0x4f998c(0x14b)]){let _0x34c85e={'message':_0x528fe7,'title':_0x203764?_0x4f998c(0x1ae):'Cogni-Living\x20Alert','priority':_0x203764?0x2:0x1,'device':_0x13f3f2[_0x4f998c(0x207)]};_0x203764&&(_0x34c85e[_0x4f998c(0x15c)]=0x1e,_0x34c85e[_0x4f998c(0x130)]=0xe10,_0x34c85e[_0x4f998c(0x1c6)]=_0x4f998c(0x180)),await this[_0x4f998c(0x242)](_0x13f3f2[_0x4f998c(0x14b)],_0x4f998c(0xcd),_0x34c85e),_0x23e59e++;}return _0x13f3f2[_0x4f998c(0xf9)]&&_0x13f3f2[_0x4f998c(0x1a5)]&&(await this[_0x4f998c(0x242)](_0x13f3f2[_0x4f998c(0x1a5)],_0x4f998c(0xcd),{'text':_0x528fe7,'to':_0x13f3f2['notifyEmailRecipient']}),_0x23e59e++),_0x13f3f2[_0x4f998c(0x1e3)]&&_0x13f3f2['notifyWhatsappInstance']&&(await this[_0x4f998c(0x242)](_0x13f3f2[_0x4f998c(0x137)],_0x4f998c(0xcd),{'text':_0x528fe7,'phone':_0x13f3f2['notifyWhatsappRecipient']}),_0x23e59e++),_0x13f3f2['notifySignalEnabled']&&_0x13f3f2[_0x4f998c(0x11a)]&&(await this[_0x4f998c(0x242)](_0x13f3f2[_0x4f998c(0x11a)],_0x4f998c(0xcd),{'text':_0x528fe7,'phone':_0x13f3f2[_0x4f998c(0x187)]}),_0x23e59e++),_0x23e59e;}}if(require[a0_0x2fbfd0(0x150)]!==module)module[a0_0x2fbfd0(0x20d)]=_0x2ff495=>new CogniLiving(_0x2ff495);else new CogniLiving();