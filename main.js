const a0_0x66ac15=a0_0x5f4c;(function(_0x320cdf,_0x51cda3){const _0x1bcff2=a0_0x5f4c,_0x412fe1=_0x320cdf();while(!![]){try{const _0x184fdc=-parseInt(_0x1bcff2(0xfc))/0x1*(parseInt(_0x1bcff2(0x19f))/0x2)+parseInt(_0x1bcff2(0x1e8))/0x3*(-parseInt(_0x1bcff2(0x252))/0x4)+-parseInt(_0x1bcff2(0x229))/0x5+-parseInt(_0x1bcff2(0x120))/0x6+parseInt(_0x1bcff2(0x1c5))/0x7+-parseInt(_0x1bcff2(0x1eb))/0x8*(parseInt(_0x1bcff2(0x16a))/0x9)+parseInt(_0x1bcff2(0x1df))/0xa;if(_0x184fdc===_0x51cda3)break;else _0x412fe1['push'](_0x412fe1['shift']());}catch(_0x1ca9c8){_0x412fe1['push'](_0x412fe1['shift']());}}}(a0_0x2354,0x25196));const a0_0x53af52=(function(){let _0x260603=!![];return function(_0x47de98,_0x2f40ac){const _0x28236b=_0x260603?function(){if(_0x2f40ac){const _0x301476=_0x2f40ac['apply'](_0x47de98,arguments);return _0x2f40ac=null,_0x301476;}}:function(){};return _0x260603=![],_0x28236b;};}()),a0_0xc947b8=a0_0x53af52(this,function(){const _0x87d4e3=a0_0x5f4c;return a0_0xc947b8[_0x87d4e3(0x20e)]()[_0x87d4e3(0x116)](_0x87d4e3(0x1cb))[_0x87d4e3(0x20e)]()[_0x87d4e3(0xf3)](a0_0xc947b8)[_0x87d4e3(0x116)](_0x87d4e3(0x1cb));});a0_0xc947b8();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x66ac15(0x13a)),schedule=require(a0_0x66ac15(0x220)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x66ac15(0x15f),LTM_SCHEDULE=a0_0x66ac15(0x20f),MODE_RESET_SCHEDULE=a0_0x66ac15(0x20b),ANALYSIS_HISTORY_MAX_SIZE=0x64,LTM_DP_RAW_LOG=a0_0x66ac15(0x126),LTM_DP_DAILY_DIGESTS=a0_0x66ac15(0x18d),LTM_DP_STATUS=a0_0x66ac15(0x1ef),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x66ac15(0x18c),LTM_DP_DRIFT_CHANNEL=a0_0x66ac15(0xe8),LTM_DP_DRIFT_STATUS=a0_0x66ac15(0x159),LTM_DP_DRIFT_DETAILS=a0_0x66ac15(0x15d),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x66ac15(0x1c3),HARD_IGNORE_TERMS=[a0_0x66ac15(0x122),a0_0x66ac15(0x1cc),a0_0x66ac15(0x1fc),'unreach',a0_0x66ac15(0x156),'rssi',a0_0x66ac15(0x1a5),'maintenance',a0_0x66ac15(0x24e),'fault','working',a0_0x66ac15(0x1a7),a0_0x66ac15(0x1d6),a0_0x66ac15(0x1a9),a0_0x66ac15(0x141),'firmware',a0_0x66ac15(0x219),'link_quality'],GENERIC_NAMES=[a0_0x66ac15(0x169),a0_0x66ac15(0xeb),a0_0x66ac15(0x24b),a0_0x66ac15(0x257),'value','brightness','on',a0_0x66ac15(0x1f9),'switch',a0_0x66ac15(0x1f2),a0_0x66ac15(0x158),a0_0x66ac15(0x14e),'cover','status','motion',a0_0x66ac15(0x228),a0_0x66ac15(0x139),a0_0x66ac15(0x1d0),a0_0x66ac15(0x23b),a0_0x66ac15(0x1a6),a0_0x66ac15(0x134),a0_0x66ac15(0x209),a0_0x66ac15(0x198)],ADAPTER_BLACKLIST=['system.',a0_0x66ac15(0x233),a0_0x66ac15(0x223),'vis.',a0_0x66ac15(0x212),a0_0x66ac15(0x17d),a0_0x66ac15(0x21e),a0_0x66ac15(0x1e1),'echarts.',a0_0x66ac15(0x1b6),a0_0x66ac15(0x12c)],SYSTEM_MODES={'NORMAL':a0_0x66ac15(0x1ce),'VACATION':a0_0x66ac15(0x232),'PARTY':a0_0x66ac15(0x14b),'GUEST':a0_0x66ac15(0x181)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x66ac15(0x17b)],SYSTEM_MODES[a0_0x66ac15(0x193)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x66ac15(0x157),'senior_aal':a0_0x66ac15(0x19a),'family':a0_0x66ac15(0x224),'single_comfort':a0_0x66ac15(0x1d7),'security':a0_0x66ac15(0xe0)};function a0_0x5f4c(_0x4d1095,_0x5b9707){const _0x45c6c3=a0_0x2354();return a0_0x5f4c=function(_0xc947b8,_0x53af52){_0xc947b8=_0xc947b8-0xe0;let _0x23549b=_0x45c6c3[_0xc947b8];return _0x23549b;},a0_0x5f4c(_0x4d1095,_0x5b9707);}class CogniLiving extends utils[a0_0x66ac15(0x1e7)]{constructor(_0x402571){const _0x253710=a0_0x66ac15;super({..._0x402571,'name':_0x253710(0x118)}),this[_0x253710(0x11d)]=[],this[_0x253710(0x114)]=[],this[_0x253710(0x14f)]=[],this[_0x253710(0x267)]=[],this[_0x253710(0x127)]=[],this[_0x253710(0xf1)]={},this[_0x253710(0x22c)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x253710(0x1fe)]=!![],this[_0x253710(0x18e)]=null,this[_0x253710(0x154)]=null,this[_0x253710(0x14a)]=![],this[_0x253710(0x111)]=null,this['geminiModel']=null,this[_0x253710(0x186)]=SYSTEM_MODES['NORMAL'],this[_0x253710(0x21f)]=![],this[_0x253710(0x1b4)]=![],this[_0x253710(0x171)]='unknown',this[_0x253710(0x162)]=null,this['ltmJob']=null,this[_0x253710(0x1de)]=null,this[_0x253710(0x266)]=null,this[_0x253710(0x1c8)]=null,this['on'](_0x253710(0x214),this['onReady'][_0x253710(0x243)](this)),this['on'](_0x253710(0x145),this[_0x253710(0x241)][_0x253710(0x243)](this)),this['on']('unload',this[_0x253710(0x160)]['bind'](this)),this['on'](_0x253710(0x168),this[_0x253710(0x23e)][_0x253710(0x243)](this));}async['onReady'](){const _0xb332b5=a0_0x66ac15;this[_0xb332b5(0x25f)]['info']('cogni-living\x20adapter\x20starting\x20(v'+this[_0xb332b5(0x166)]+')\x20-\x20OBFUSCATION\x20SAFE\x20MODE'),await this[_0xb332b5(0x191)](),this[_0xb332b5(0x109)]['licenseKey']=this['config'][_0xb332b5(0x25e)]||'';try{this[_0xb332b5(0x21f)]=await this[_0xb332b5(0xf7)](this['config']['licenseKey']);}catch(_0x40f60b){this[_0xb332b5(0x25f)][_0xb332b5(0x24e)](_0xb332b5(0x15a)+_0x40f60b[_0xb332b5(0x168)]);}if(!this['config'][_0xb332b5(0x12a)]||this['config'][_0xb332b5(0x12a)]<0.1)this[_0xb332b5(0x109)]['inactivityThresholdHours']=0xc;await this[_0xb332b5(0x22f)](),await this[_0xb332b5(0x11a)]();if(this[_0xb332b5(0x109)][_0xb332b5(0x259)])try{this[_0xb332b5(0x111)]=new GoogleGenerativeAI(this['config'][_0xb332b5(0x259)]),this[_0xb332b5(0x19d)]=this['genAI'][_0xb332b5(0xf6)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xb332b5(0x180)}}),this[_0xb332b5(0x25f)][_0xb332b5(0x188)](_0xb332b5(0x21d));}catch(_0x2f8964){this[_0xb332b5(0x25f)]['error'](_0xb332b5(0x1bb)+_0x2f8964[_0xb332b5(0x168)]);}await this[_0xb332b5(0x21c)](),await this[_0xb332b5(0x125)](),await this[_0xb332b5(0x1c1)](),await this['loadDailyDigests'](),this[_0xb332b5(0x242)]('analysis.trigger'),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0xb332b5(0x242)]('system.mode'),this[_0xb332b5(0x242)](_0xb332b5(0x103)),await this['initSensorSubscriptions'](),await this['initPresenceSubscriptions']();if(this[_0xb332b5(0x162)])clearInterval(this['analysisTimer']);const _0x9e4bc3=this['config'][_0xb332b5(0x165)]||0xf;_0x9e4bc3>0x0&&(this[_0xb332b5(0x25f)][_0xb332b5(0x188)](_0xb332b5(0x10c)+_0x9e4bc3+_0xb332b5(0x260)+this[_0xb332b5(0x109)][_0xb332b5(0x12a)]+'h.'),this[_0xb332b5(0x162)]=setInterval(()=>{this['runAutopilot']();},_0x9e4bc3*0x3c*0x3e8)),this[_0xb332b5(0x113)](),this[_0xb332b5(0x16c)](),this[_0xb332b5(0x249)](),this[_0xb332b5(0x15e)]();}[a0_0x66ac15(0x160)](_0x2263e7){const _0x584374=a0_0x66ac15;if(this[_0x584374(0x162)])clearInterval(this['analysisTimer']);if(this[_0x584374(0x266)])clearInterval(this[_0x584374(0x266)]);if(this['ltmJob'])this[_0x584374(0x239)][_0x584374(0x161)]();if(this[_0x584374(0x1de)])this['modeResetJob'][_0x584374(0x161)]();if(this[_0x584374(0x1c8)])this[_0x584374(0x1c8)]['cancel']();if(this[_0x584374(0x18e)])clearTimeout(this[_0x584374(0x18e)]);if(this[_0x584374(0x154)])clearTimeout(this[_0x584374(0x154)]);_0x2263e7();}async['onStateChange'](_0x161762,_0x47cf41){const _0x175877=a0_0x66ac15;if(!_0x47cf41)return;if(_0x161762===this['namespace']+'.'+SYSTEM_DP_MODE){_0x47cf41[_0x175877(0x11c)]&&Object[_0x175877(0x1e5)](SYSTEM_MODES)[_0x175877(0x208)](_0x47cf41[_0x175877(0x11c)])&&(this[_0x175877(0x186)]=_0x47cf41[_0x175877(0x11c)],_0x47cf41[_0x175877(0x11c)]===SYSTEM_MODES[_0x175877(0xf0)]?await this[_0x175877(0x262)](![]):await this[_0x175877(0x262)](!![]));if(!_0x47cf41['ack'])this[_0x175877(0xfe)](_0x161762,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x47cf41[_0x175877(0xea)]){_0x161762[_0x175877(0x208)](_0x175877(0xf5))&&_0x47cf41['val']&&(this[_0x175877(0xfe)](_0x161762,{'val':![],'ack':!![]}),this['runGeminiAnalysis']());if(_0x161762[_0x175877(0x208)]('triggerDailyDigest')&&_0x47cf41['val']){this[_0x175877(0xfe)](_0x161762,{'val':![],'ack':!![]});if(this[_0x175877(0x21f)])this[_0x175877(0x174)]();}_0x161762['includes'](_0x175877(0x1d1))&&_0x47cf41['val']&&(this[_0x175877(0xfe)](_0x161762,{'val':![],'ack':!![]}),this[_0x175877(0x14c)]());return;}if(this[_0x175877(0x109)]['presenceDevices']&&this[_0x175877(0x109)][_0x175877(0x110)][_0x175877(0x208)](_0x161762)){await this[_0x175877(0x142)]();return;}const _0x2f2014=(this['config'][_0x175877(0x179)]||[])[_0x175877(0x1b1)](_0x184aa0=>_0x184aa0['id']===_0x161762);if(_0x2f2014)this[_0x175877(0x150)](_0x161762,_0x47cf41,_0x2f2014);}async[a0_0x66ac15(0x23e)](_0x362bde){const _0x4c0fa3=a0_0x66ac15;if(typeof _0x362bde===_0x4c0fa3(0x17f)&&_0x362bde[_0x4c0fa3(0x168)])try{if(_0x362bde['command']==='testApiKey'){}else{if(_0x362bde[_0x4c0fa3(0x1dd)]===_0x4c0fa3(0x184)){}else{if(_0x362bde[_0x4c0fa3(0x1dd)]===_0x4c0fa3(0x255)){}else{if(_0x362bde[_0x4c0fa3(0x1dd)]===_0x4c0fa3(0x13c)){const _0x2c5255=this[_0x4c0fa3(0x127)][_0x4c0fa3(0x182)],_0x1f12d9=this['eventHistory'][_0x4c0fa3(0x1a1)](_0x42798b=>_0x42798b['timestamp']>new Date()['setHours'](0x0,0x0,0x0,0x0))[_0x4c0fa3(0x182)];let _0x46a45f={'status':_0x4c0fa3(0x207)};try{_0x46a45f['status']=(await this[_0x4c0fa3(0x1c7)](LTM_DP_DRIFT_STATUS))[_0x4c0fa3(0x11c)];}catch(_0x3f97cb){}this[_0x4c0fa3(0x1cd)](_0x362bde[_0x4c0fa3(0x192)],_0x362bde[_0x4c0fa3(0x1dd)],{'success':!![],'eventHistory':this[_0x4c0fa3(0x11d)][_0x4c0fa3(0x15b)](0x0,0xf),'stats':{'digestCount':_0x2c5255,'eventCountToday':_0x1f12d9,'driftStatus':_0x46a45f[_0x4c0fa3(0x18f)],'isPresent':this[_0x4c0fa3(0x1fe)],'minDays':this[_0x4c0fa3(0x109)][_0x4c0fa3(0x204)]||0x7,'stbDays':this['config'][_0x4c0fa3(0x136)]||0xe,'ltbDays':this[_0x4c0fa3(0x109)][_0x4c0fa3(0x227)]||0x3c}},_0x362bde[_0x4c0fa3(0x10a)]);}else{if(_0x362bde[_0x4c0fa3(0x1dd)]===_0x4c0fa3(0x226)){const _0x308324=await this[_0x4c0fa3(0x26b)](_0x4c0fa3(0x25b),_0x4c0fa3(0x16d)),_0x20bb22=[];if(_0x308324)for(const _0x5597d5 in _0x308324){const _0x590048=_0x308324[_0x5597d5],_0x53c300=(_0x590048['common']&&typeof _0x590048[_0x4c0fa3(0x1ee)][_0x4c0fa3(0x106)]===_0x4c0fa3(0x17f)?_0x590048[_0x4c0fa3(0x1ee)][_0x4c0fa3(0x106)]['de']:_0x590048[_0x4c0fa3(0x1ee)][_0x4c0fa3(0x106)])||_0x590048[_0x4c0fa3(0x1ee)]['name'];_0x20bb22[_0x4c0fa3(0xfa)]({'id':_0x5597d5,'name':_0x53c300});}this[_0x4c0fa3(0x1cd)](_0x362bde[_0x4c0fa3(0x192)],_0x362bde[_0x4c0fa3(0x1dd)],{'success':!![],'enums':_0x20bb22},_0x362bde[_0x4c0fa3(0x10a)]);}else{if(_0x362bde[_0x4c0fa3(0x1dd)]===_0x4c0fa3(0x244))try{const _0x57e889=await this[_0x4c0fa3(0x222)](_0x362bde[_0x4c0fa3(0x168)]||{});this[_0x4c0fa3(0x1cd)](_0x362bde[_0x4c0fa3(0x192)],_0x362bde[_0x4c0fa3(0x1dd)],{'success':!![],'devices':_0x57e889},_0x362bde['callback']);}catch(_0x1f92e1){this['sendTo'](_0x362bde['from'],_0x362bde['command'],{'success':![],'error':_0x1f92e1[_0x4c0fa3(0x168)]},_0x362bde['callback']);}}}}}}}catch(_0x46e7e8){this['log'][_0x4c0fa3(0x24e)]('Error\x20in\x20onMessage\x20command\x20'+_0x362bde[_0x4c0fa3(0x1dd)]+':\x20'+_0x46e7e8[_0x4c0fa3(0x168)]);if(_0x362bde['callback'])this[_0x4c0fa3(0x1cd)](_0x362bde[_0x4c0fa3(0x192)],_0x362bde['command'],{'success':![],'error':_0x46e7e8[_0x4c0fa3(0x168)]},_0x362bde[_0x4c0fa3(0x10a)]);}}async[a0_0x66ac15(0x150)](_0x299134,_0x290384,_0x198e1d){const _0x14a8c7=a0_0x66ac15;if(!_0x198e1d[_0x14a8c7(0x117)]&&this[_0x14a8c7(0xf1)][_0x299134]===_0x290384[_0x14a8c7(0x11c)])return;this[_0x14a8c7(0xf1)][_0x299134]=_0x290384['val'];if(this[_0x14a8c7(0x14a)])return;const _0x2e7fc9=await this[_0x14a8c7(0x142)]();if(_0x2e7fc9){if(!this[_0x14a8c7(0x1fe)])await this[_0x14a8c7(0x262)](!![]);}else{const _0x537ea9=_0x198e1d[_0x14a8c7(0x254)]===!![];_0x537ea9?this[_0x14a8c7(0xed)]():(this['exitTimer']&&this[_0x14a8c7(0x1f0)](),!this[_0x14a8c7(0x1fe)]&&this['currentSystemMode']===SYSTEM_MODES[_0x14a8c7(0x23f)]&&await this['setPresence'](!![]));}const _0x2be0b1={'timestamp':_0x290384['ts'],'id':_0x299134,'name':_0x198e1d['name'],'value':_0x290384['val'],'location':_0x198e1d[_0x14a8c7(0x177)],'type':_0x198e1d[_0x14a8c7(0x24a)]};this[_0x14a8c7(0x11d)][_0x14a8c7(0x20d)](_0x2be0b1);if(this[_0x14a8c7(0x11d)][_0x14a8c7(0x182)]>HISTORY_MAX_SIZE)this[_0x14a8c7(0x11d)][_0x14a8c7(0x137)]();await this[_0x14a8c7(0x26a)](_0x14a8c7(0x1e4),{'val':JSON[_0x14a8c7(0xf4)](_0x2be0b1),'ack':!![]}),await this['setStateAsync'](_0x14a8c7(0x237),{'val':JSON[_0x14a8c7(0xf4)](this[_0x14a8c7(0x11d)]),'ack':!![]}),this[_0x14a8c7(0x267)][_0x14a8c7(0xfa)]({'timestamp':new Date(_0x290384['ts'])[_0x14a8c7(0x190)](),'sensorName':_0x198e1d[_0x14a8c7(0x106)],'location':_0x198e1d[_0x14a8c7(0x177)],'value':_0x290384[_0x14a8c7(0x11c)]}),await this['saveRawEventLog']();}async[a0_0x66ac15(0x20a)](){}async[a0_0x66ac15(0x167)](_0x31ba19=''){}async[a0_0x66ac15(0x174)](){}async[a0_0x66ac15(0x14c)](){}async[a0_0x66ac15(0x222)](_0x203b8d){const _0xd5d254=a0_0x66ac15;this[_0xd5d254(0x25f)][_0xd5d254(0x188)](_0xd5d254(0x238));const _0x24a7ac=[],_0x2254bf=await this['getForeignObjectsAsync']('*'),_0x4bff19=await this[_0xd5d254(0x26b)](_0xd5d254(0x25b),'enum'),_0x53c77e={};if(_0x4bff19)for(const _0x4f2395 in _0x4bff19){const _0xa2fa36=_0x4bff19[_0x4f2395]['common'][_0xd5d254(0x24f)]||[];_0xa2fa36['forEach'](_0x23b304=>{const _0xe7ed2=_0xd5d254;if(!_0x53c77e[_0x23b304])_0x53c77e[_0x23b304]=[];_0x53c77e[_0x23b304][_0xe7ed2(0xfa)](_0x4f2395);});}const _0x1edf04=_0x203b8d[_0xd5d254(0x1f1)]||[],_0x2054a3=_0x203b8d[_0xd5d254(0x250)]!==![],_0x2d424c=_0x203b8d[_0xd5d254(0x203)]!==![],_0x3e9625=_0x203b8d['lights']!==![],_0x5c9b23=_0x203b8d[_0xd5d254(0x1d0)]===!![],_0x503f2a=_0x203b8d[_0xd5d254(0x147)]===!![];for(const _0x5e79a7 in _0x2254bf){const _0x4f5f6e=_0x2254bf[_0x5e79a7];if(_0x4f5f6e[_0xd5d254(0x24a)]!==_0xd5d254(0x24b)||!_0x4f5f6e[_0xd5d254(0x1ee)])continue;if(ADAPTER_BLACKLIST[_0xd5d254(0x164)](_0x520556=>_0x5e79a7[_0xd5d254(0x1fb)](_0x520556))&&!_0x503f2a)continue;const _0x2a342e=(_0x4f5f6e[_0xd5d254(0x1ee)][_0xd5d254(0x231)]||'')['toLowerCase']();let _0x1f16c6=(typeof _0x4f5f6e['common']['name']==='object'?_0x4f5f6e[_0xd5d254(0x1ee)][_0xd5d254(0x106)]['de']:_0x4f5f6e[_0xd5d254(0x1ee)][_0xd5d254(0x106)])||_0x5e79a7;const _0x6035a=_0x1f16c6['toLowerCase']();if(HARD_IGNORE_TERMS[_0xd5d254(0x164)](_0x3bd7c7=>_0x5e79a7['includes'](_0x3bd7c7)||_0x6035a[_0xd5d254(0x208)](_0x3bd7c7[_0xd5d254(0x221)]())))continue;const _0x80790a=_0x5e79a7[_0xd5d254(0x1ed)]('.');if(_0x80790a[_0xd5d254(0x182)]>0x2){const _0x2814dc=_0x80790a[_0xd5d254(0x15b)](0x0,-0x1)[_0xd5d254(0x216)]('.'),_0xe0603=_0x2254bf[_0x2814dc];if(_0xe0603&&_0xe0603[_0xd5d254(0x1ee)]&&_0xe0603[_0xd5d254(0x1ee)]['name']){const _0x1f2586=typeof _0xe0603[_0xd5d254(0x1ee)][_0xd5d254(0x106)]==='object'?_0xe0603[_0xd5d254(0x1ee)][_0xd5d254(0x106)]['de']:_0xe0603['common'][_0xd5d254(0x106)];if(_0x1f2586&&typeof _0x1f2586==='string'){const _0x17b125=_0x1f2586[_0xd5d254(0xe1)](/channel\s*\d*/gi,'')[_0xd5d254(0x218)]();_0x17b125&&!_0x6035a[_0xd5d254(0x208)](_0x17b125['toLowerCase']())&&(_0x1f16c6=_0x17b125+'\x20'+_0x1f16c6);}}}let _0x3c9492=![];if(_0x1edf04[_0xd5d254(0x182)]>0x0){const _0x175a6e=_0x53c77e[_0x5e79a7]||[],_0x192adf=_0x5e79a7['split']('.')[_0xd5d254(0x15b)](0x0,-0x1)[_0xd5d254(0x216)]('.'),_0xaffc87=_0x53c77e[_0x192adf]||[];(_0x175a6e[_0xd5d254(0x164)](_0x31f5c5=>_0x1edf04[_0xd5d254(0x208)](_0x31f5c5))||_0xaffc87[_0xd5d254(0x164)](_0x5d016a=>_0x1edf04[_0xd5d254(0x208)](_0x5d016a)))&&(_0x3c9492=!![]);}let _0x300722='';if(_0x2054a3){if(_0x2a342e[_0xd5d254(0x208)](_0xd5d254(0x250))||_0x2a342e[_0xd5d254(0x208)](_0xd5d254(0x139))||_0x6035a[_0xd5d254(0x208)]('bewegung')||_0x6035a['includes']('pr√§senz'))_0x300722=_0xd5d254(0x250);}if(!_0x300722&&_0x2d424c){if(_0x2a342e[_0xd5d254(0x208)](_0xd5d254(0x1ca))||_0x2a342e[_0xd5d254(0x208)]('window')||_0x2a342e[_0xd5d254(0x208)]('lock')||_0x2a342e['includes'](_0xd5d254(0x14e))||_0x2a342e[_0xd5d254(0x208)]('shutter'))_0x300722=_0xd5d254(0x1ca);else{if(_0x6035a[_0xd5d254(0x208)](_0xd5d254(0x230))||_0x6035a['includes'](_0xd5d254(0x1c9))||_0x6035a[_0xd5d254(0x208)](_0xd5d254(0x1ca))||_0x6035a[_0xd5d254(0x208)]('rollladen'))_0x300722=_0xd5d254(0x1ca);}}if(!_0x300722&&_0x3e9625){if(_0x2a342e[_0xd5d254(0x208)]('light')||_0x2a342e[_0xd5d254(0x208)](_0xd5d254(0x12b))||_0x2a342e['includes'](_0xd5d254(0xef)))_0x300722=_0xd5d254(0x235);else{if(_0x6035a[_0xd5d254(0x208)](_0xd5d254(0x1f4))||_0x6035a[_0xd5d254(0x208)](_0xd5d254(0x14d))||_0x6035a[_0xd5d254(0x208)](_0xd5d254(0x225))){if(_0x4f5f6e[_0xd5d254(0x1ee)][_0xd5d254(0x155)]||_0x2a342e[_0xd5d254(0x208)](_0xd5d254(0x253)))_0x300722=_0xd5d254(0x235);}}}if(!_0x300722&&_0x5c9b23){if(_0x2a342e[_0xd5d254(0x208)](_0xd5d254(0x1d0))||_0x2a342e['includes']('humidity')||_0x2a342e[_0xd5d254(0x208)]('thermostat')||_0x2a342e[_0xd5d254(0x208)]('value.valve')||_0x2a342e[_0xd5d254(0x208)](_0xd5d254(0x189)))_0x300722=_0xd5d254(0x1d0);else{if(_0x6035a['includes'](_0xd5d254(0x129))||_0x6035a[_0xd5d254(0x208)](_0xd5d254(0x153))||_0x6035a['includes'](_0xd5d254(0x1d5))||_0x6035a[_0xd5d254(0x208)]('thermostat')||_0x6035a[_0xd5d254(0x208)]('sollwert')||_0x6035a[_0xd5d254(0x208)]('setpoint')||_0x6035a[_0xd5d254(0x208)](_0xd5d254(0x121)))_0x300722=_0xd5d254(0x1d0);}}!_0x300722&&_0x3c9492&&(_0x300722=_0xd5d254(0x23c));if(_0x300722){let _0x509d2d='';const _0x1c5682=(_0x5e79a7+'\x20'+_0x1f16c6)['toLowerCase']();if(_0x1c5682['includes'](_0xd5d254(0x1db))||_0x1c5682['includes']('wc')||_0x1c5682[_0xd5d254(0x208)](_0xd5d254(0xe2)))_0x509d2d=_0xd5d254(0x16b);else{if(_0x1c5682['includes'](_0xd5d254(0x196)))_0x509d2d=_0xd5d254(0xe7);else{if(_0x1c5682['includes'](_0xd5d254(0x108)))_0x509d2d=_0xd5d254(0x178);else{if(_0x1c5682['includes'](_0xd5d254(0x1e6)))_0x509d2d='Schlafzimmer';else{if(_0x1c5682['includes']('flur')||_0x1c5682[_0xd5d254(0x208)]('diele')||_0x1c5682[_0xd5d254(0x208)](_0xd5d254(0x1e9)))_0x509d2d=_0xd5d254(0x20c);else{if(_0x1c5682[_0xd5d254(0x208)]('garten')||_0x1c5682[_0xd5d254(0x208)]('terrasse')||_0x1c5682[_0xd5d254(0x208)](_0xd5d254(0x1b3)))_0x509d2d=_0xd5d254(0x1f7);else{if(_0x1c5682['includes'](_0xd5d254(0x1a8))||_0x1c5682['includes']('arbeit'))_0x509d2d=_0xd5d254(0x119);else{if(_0x1c5682[_0xd5d254(0x208)]('keller'))_0x509d2d=_0xd5d254(0x11f);else{if(_0x1c5682[_0xd5d254(0x208)]('garage'))_0x509d2d='Garage';}}}}}}}}_0x24a7ac[_0xd5d254(0xfa)]({'id':_0x5e79a7,'name':_0x1f16c6,'location':_0x509d2d,'type':_0x300722,'logDuplicates':_0x300722===_0xd5d254(0x250),'isExit':![],'_score':_0x509d2d?0x50:_0x300722===_0xd5d254(0x23c)?0x5a:0x28}),_0x24a7ac[_0xd5d254(0x182)]<=0xa&&this['log'][_0xd5d254(0x188)](_0xd5d254(0xe6)+_0x1f16c6+'\x20('+_0x300722+_0xd5d254(0x151)+(_0x509d2d||_0xd5d254(0x25c)));}}return _0x24a7ac[_0xd5d254(0x24d)]((_0x29ed0d,_0x47140d)=>_0x47140d[_0xd5d254(0x269)]-_0x29ed0d[_0xd5d254(0x269)]),_0x24a7ac;}['tryParse'](_0x1514a3){const _0xa5c3bd=a0_0x66ac15;if(typeof _0x1514a3===_0xa5c3bd(0x17f))return _0x1514a3;try{return JSON[_0xa5c3bd(0x143)](_0x1514a3);}catch(_0xbe4190){return null;}}async[a0_0x66ac15(0x191)](){}async['initHistory'](){const _0x106db8=a0_0x66ac15;try{const _0x2fd1af=await this['getStateAsync'](_0x106db8(0x237));_0x2fd1af&&_0x2fd1af['val']&&(this[_0x106db8(0x11d)]=JSON[_0x106db8(0x143)](_0x2fd1af[_0x106db8(0x11c)][_0x106db8(0x20e)]()));}catch(_0x54408b){this[_0x106db8(0x11d)]=[];}try{const _0x48defb=await this['getStateAsync'](_0x106db8(0x16e));if(_0x48defb&&_0x48defb[_0x106db8(0x11c)])this[_0x106db8(0x114)]=JSON['parse'](_0x48defb[_0x106db8(0x11c)][_0x106db8(0x20e)]());}catch(_0x391f5d){this[_0x106db8(0x114)]=[];}}async[a0_0x66ac15(0x11a)](){const _0xaf5407=a0_0x66ac15;try{const _0x3b3ea8=await this[_0xaf5407(0x19e)](_0xaf5407(0x1ff));_0x3b3ea8&&_0x3b3ea8[_0xaf5407(0x1ee)]&&(this['systemConfig']={'latitude':_0x3b3ea8[_0xaf5407(0x1ee)]['latitude']||0x0,'longitude':_0x3b3ea8[_0xaf5407(0x1ee)]['longitude']||0x0,'city':_0x3b3ea8[_0xaf5407(0x1ee)][_0xaf5407(0xff)]||''});}catch(_0x2d20d6){}}async['checkLicense'](_0x3a6d36){const _0x1d3191=a0_0x66ac15;if(!_0x3a6d36)return![];this[_0x1d3191(0x171)]=await this[_0x1d3191(0x24c)]();if(_0x3a6d36===_0x1d3191(0x21b)||_0x3a6d36[_0x1d3191(0x1fb)](_0x1d3191(0x1ab)))return!![];return![];}async[a0_0x66ac15(0x24c)](){const _0x2d5acd=a0_0x66ac15;try{const _0x29e175=await this['getForeignObjectAsync'](_0x2d5acd(0x1a0));if(_0x29e175&&_0x29e175[_0x2d5acd(0x215)]&&_0x29e175[_0x2d5acd(0x215)][_0x2d5acd(0x26d)])return _0x29e175[_0x2d5acd(0x215)][_0x2d5acd(0x26d)];return _0x2d5acd(0x1b8);}catch(_0x33a0a6){return _0x2d5acd(0x172);}}async[a0_0x66ac15(0x21c)](){const _0x1ff740=a0_0x66ac15;await this['checkSystemObjects'](),await this[_0x1ff740(0xe5)](_0x1ff740(0x1e4),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x206),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x237),{'type':_0x1ff740(0x24b),'common':{'name':'Event\x20History','type':'string','role':_0x1ff740(0x175),'read':!![],'write':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0xf5),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x1e3),'type':_0x1ff740(0x22a),'role':_0x1ff740(0x240),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x103),{'type':_0x1ff740(0x24b),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x1ff740(0x22a),'role':_0x1ff740(0x240),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x22d),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x1ac),'type':_0x1ff740(0x194),'role':_0x1ff740(0x175),'read':!![],'write':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x210),{'type':_0x1ff740(0x24b),'common':{'name':'AI\x20Alert\x20Status','type':'boolean','role':'indicator.alarm','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x1c2),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x1cf),'type':'boolean','role':'indicator.alarm.fire','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x10b),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x1ba),'type':_0x1ff740(0x194),'role':'text.alarm','read':!![],'write':![]},'native':{}}),await this[_0x1ff740(0xe5)]('analysis.activitySummary',{'type':'state','common':{'name':'Activity\x20Summary','type':_0x1ff740(0x194),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x183),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x1b2),'type':_0x1ff740(0x194),'role':'state','read':!![],'write':![],'def':_0x1ff740(0x207)},'native':{}}),await this['setObjectNotExistsAsync'](_0x1ff740(0x133),{'type':_0x1ff740(0x24b),'common':{'name':'Comfort\x20Summary','type':_0x1ff740(0x194),'role':_0x1ff740(0x25a),'read':!![],'write':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x202),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x263),'type':'string','role':_0x1ff740(0x25a),'read':!![],'write':![]},'native':{}}),await this[_0x1ff740(0x131)](_0x1ff740(0x1a2),{'type':_0x1ff740(0x19b),'common':{'name':_0x1ff740(0x128)},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x12f),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x211),'type':_0x1ff740(0x22a),'role':_0x1ff740(0x112),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x130),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x256),'type':_0x1ff740(0x194),'role':_0x1ff740(0x25a),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x1ff740(0x1bd),{'type':_0x1ff740(0x24b),'common':{'name':'Action','type':_0x1ff740(0x194),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x16e),{'type':_0x1ff740(0x24b),'common':{'name':'Logbook','type':_0x1ff740(0x194),'role':_0x1ff740(0x175),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x234),{'type':'state','common':{'name':_0x1ff740(0x13d),'type':_0x1ff740(0x194),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1ff740(0x131)](_0x1ff740(0x10f),{'type':_0x1ff740(0x19b),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x149),{'type':'state','common':{'name':_0x1ff740(0x1fa),'type':_0x1ff740(0x102),'role':_0x1ff740(0x163),'read':!![],'write':![],'def':0x0},'native':{}}),await this['setObjectNotExistsAsync']('analysis.health.restlessness',{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x1bf),'type':_0x1ff740(0x194),'role':_0x1ff740(0x25a),'read':!![],'write':![],'def':_0x1ff740(0x22b)},'native':{}}),await this[_0x1ff740(0xe5)](_0x1ff740(0x144),{'type':_0x1ff740(0x24b),'common':{'name':_0x1ff740(0x187),'type':_0x1ff740(0x194),'role':'text','read':!![],'write':![],'def':''},'native':{}}),await this[_0x1ff740(0x17c)](),await this['checkLtmDriftObjects']();}async[a0_0x66ac15(0x246)](){const _0x278efa=a0_0x66ac15;await this[_0x278efa(0x131)]('system',{'type':_0x278efa(0x19b),'common':{'name':_0x278efa(0x247)},'native':{}}),await this[_0x278efa(0x131)](SYSTEM_DP_MODE,{'type':_0x278efa(0x24b),'common':{'name':'System\x20Mode','type':_0x278efa(0x194),'role':_0x278efa(0x24b),'read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES['NORMAL']]:_0x278efa(0x201),[SYSTEM_MODES[_0x278efa(0xf0)]]:_0x278efa(0xec),[SYSTEM_MODES[_0x278efa(0x17b)]]:_0x278efa(0x17e),[SYSTEM_MODES['GUEST']]:_0x278efa(0x185)}},'native':{}});}async['checkLtmObjects'](){const _0x3ad6a5=a0_0x66ac15;await this[_0x3ad6a5(0x131)](_0x3ad6a5(0x11e),{'type':_0x3ad6a5(0x19b),'common':{'name':_0x3ad6a5(0x11e)},'native':{}}),await this[_0x3ad6a5(0x131)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x3ad6a5(0x170),'type':_0x3ad6a5(0x194),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x3ad6a5(0x131)](LTM_DP_DAILY_DIGESTS,{'type':_0x3ad6a5(0x24b),'common':{'name':'Daily\x20Digests','type':_0x3ad6a5(0x194),'role':_0x3ad6a5(0x175),'read':!![],'write':![]},'native':{}}),await this[_0x3ad6a5(0x131)](LTM_DP_STATUS,{'type':_0x3ad6a5(0x24b),'common':{'name':_0x3ad6a5(0x23d),'type':_0x3ad6a5(0x194),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x3ad6a5(0x131)](LTM_DP_TRIGGER_DIGEST,{'type':_0x3ad6a5(0x24b),'common':{'name':_0x3ad6a5(0xe3),'type':_0x3ad6a5(0x22a),'role':_0x3ad6a5(0x240),'read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x3ad6a5(0x24b),'common':{'name':_0x3ad6a5(0x197),'type':'string','role':'text','read':!![],'write':![]},'native':{}});}async[a0_0x66ac15(0x1dc)](){const _0x14260c=a0_0x66ac15;await this[_0x14260c(0x131)](LTM_DP_DRIFT_CHANNEL,{'type':_0x14260c(0x19b),'common':{'name':_0x14260c(0x101)},'native':{}}),await this[_0x14260c(0x131)](LTM_DP_DRIFT_STATUS,{'type':_0x14260c(0x24b),'common':{'name':_0x14260c(0x138),'type':_0x14260c(0x194),'role':_0x14260c(0x24b),'read':!![],'write':![],'def':_0x14260c(0x207)},'native':{}}),await this[_0x14260c(0x131)](LTM_DP_DRIFT_DETAILS,{'type':_0x14260c(0x24b),'common':{'name':_0x14260c(0x146),'type':_0x14260c(0x194),'role':_0x14260c(0x25a),'read':!![],'write':![]},'native':{}}),await this[_0x14260c(0x131)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x14260c(0x24b),'common':{'name':_0x14260c(0x261),'type':_0x14260c(0x102),'role':_0x14260c(0xf9),'read':!![],'write':![]},'native':{}});}async[a0_0x66ac15(0x125)](){const _0x5037e8=a0_0x66ac15;try{const _0x1532f8=await this[_0x5037e8(0x1c7)](SYSTEM_DP_MODE);_0x1532f8&&_0x1532f8['val']&&Object[_0x5037e8(0x1e5)](SYSTEM_MODES)[_0x5037e8(0x208)](_0x1532f8[_0x5037e8(0x11c)])?this[_0x5037e8(0x186)]=_0x1532f8[_0x5037e8(0x11c)]:(this[_0x5037e8(0x186)]=SYSTEM_MODES[_0x5037e8(0x23f)],await this[_0x5037e8(0x26a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x5037e8(0x23f)],'ack':!![]}));}catch(_0x4369dc){this[_0x5037e8(0x186)]=SYSTEM_MODES[_0x5037e8(0x23f)];}}async['loadRawEventLog'](){const _0xc3886e=a0_0x66ac15;try{const _0x48029f=await this[_0xc3886e(0x1c7)](LTM_DP_RAW_LOG);if(_0x48029f&&_0x48029f['val'])this[_0xc3886e(0x267)]=JSON[_0xc3886e(0x143)](_0x48029f['val']);}catch(_0x5067e4){this['rawEventLog']=[];}}async[a0_0x66ac15(0x217)](){const _0x4a2fa0=a0_0x66ac15;try{const _0xd668fb=await this[_0x4a2fa0(0x1c7)](LTM_DP_DAILY_DIGESTS);if(_0xd668fb&&_0xd668fb[_0x4a2fa0(0x11c)])this[_0x4a2fa0(0x127)]=JSON[_0x4a2fa0(0x143)](_0xd668fb['val']);}catch(_0x30cc41){this[_0x4a2fa0(0x127)]=[];}await this[_0x4a2fa0(0x12d)]();}async['saveRawEventLog'](){const _0x380a12=a0_0x66ac15;this[_0x380a12(0x267)][_0x380a12(0x182)]>RAW_LOG_MAX_SIZE&&this[_0x380a12(0x267)]['splice'](0x0,this['rawEventLog'][_0x380a12(0x182)]-RAW_LOG_MAX_SIZE),await this[_0x380a12(0x26a)](LTM_DP_RAW_LOG,{'val':JSON[_0x380a12(0xf4)](this[_0x380a12(0x267)]),'ack':!![]});}async[a0_0x66ac15(0x26c)](_0x30316e=!![]){const _0x807a7d=a0_0x66ac15,_0x5c4505=this[_0x807a7d(0x109)][_0x807a7d(0x227)]||0x3c;this[_0x807a7d(0x127)][_0x807a7d(0x182)]>_0x5c4505&&this[_0x807a7d(0x127)]['splice'](0x0,this[_0x807a7d(0x127)][_0x807a7d(0x182)]-_0x5c4505);await this[_0x807a7d(0x26a)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](this[_0x807a7d(0x127)]),'ack':!![]});if(_0x30316e)await this[_0x807a7d(0x12d)]();}async[a0_0x66ac15(0x1da)](_0x105bf3){const _0x289bac=a0_0x66ac15;this[_0x289bac(0x114)][_0x289bac(0x20d)](_0x105bf3);if(this[_0x289bac(0x114)][_0x289bac(0x182)]>ANALYSIS_HISTORY_MAX_SIZE)this['analysisHistory'][_0x289bac(0x137)]();await this[_0x289bac(0x26a)](_0x289bac(0x16e),{'val':JSON['stringify'](this[_0x289bac(0x114)]),'ack':!![]});}async[a0_0x66ac15(0x12d)](){const _0x5dabf8=a0_0x66ac15;if(!this[_0x5dabf8(0x21f)]){await this[_0x5dabf8(0x26a)](LTM_DP_BASELINE_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}const _0x2c4a0c=this['dailyDigests'][_0x5dabf8(0x182)]>=(this[_0x5dabf8(0x109)]['minDaysForBaseline']||0x7)?'Aktiv\x20('+this[_0x5dabf8(0x127)]['length']+_0x5dabf8(0x199):_0x5dabf8(0x213)+this[_0x5dabf8(0x127)]['length']+'/'+(this[_0x5dabf8(0x109)][_0x5dabf8(0x204)]||0x7)+')';await this[_0x5dabf8(0x26a)](LTM_DP_BASELINE_STATUS,{'val':_0x2c4a0c,'ack':!![]});}async[a0_0x66ac15(0x264)](){const _0x512816=a0_0x66ac15,_0x4415d5=this['config'][_0x512816(0x179)];if(_0x4415d5&&_0x4415d5[_0x512816(0x182)]>0x0){this[_0x512816(0x25f)]['info'](_0x512816(0x1af)+_0x4415d5[_0x512816(0x182)]+'\x20sensors...');for(const _0x560960 of _0x4415d5){if(_0x560960['id']){await this['subscribeForeignStatesAsync'](_0x560960['id']);try{const _0x1a997b=await this[_0x512816(0x1c4)](_0x560960['id']);if(_0x1a997b)this['sensorLastValues'][_0x560960['id']]=_0x1a997b[_0x512816(0x11c)];}catch(_0x6cfca8){}}}}}async[a0_0x66ac15(0x1e2)](){const _0x2ebffd=a0_0x66ac15,_0x34426b=this['config'][_0x2ebffd(0x110)]||[];if(_0x34426b[_0x2ebffd(0x182)]>0x0){this[_0x2ebffd(0x25f)][_0x2ebffd(0x188)](_0x2ebffd(0x1af)+_0x34426b[_0x2ebffd(0x182)]+_0x2ebffd(0x1fd));for(const _0x5b1c64 of _0x34426b){await this[_0x2ebffd(0xfd)](_0x5b1c64);}try{await this[_0x2ebffd(0x142)]();}catch(_0x1f83dc){}}}async[a0_0x66ac15(0x11b)](){const _0x31c519=a0_0x66ac15;try{if(!this[_0x31c519(0x109)][_0x31c519(0x1f6)])return _0x31c519(0x1ea);let _0x476fee='';const _0x344f5e=this[_0x31c519(0x109)][_0x31c519(0x1f3)];if(_0x344f5e)try{if(_0x344f5e['includes'](_0x31c519(0x1ec))){const _0x5cdce8=await this[_0x31c519(0x1c4)](_0x344f5e+'.Summary.Current');if(_0x5cdce8&&_0x5cdce8['val'])_0x476fee=_0x5cdce8[_0x31c519(0x11c)];}else{if(_0x344f5e[_0x31c519(0x208)](_0x31c519(0x19c))){const _0xb91dbe=await this['getForeignStateAsync'](_0x344f5e+_0x31c519(0x200));if(_0xb91dbe&&_0xb91dbe['val'])_0x476fee=_0xb91dbe[_0x31c519(0x11c)];}else{if(_0x344f5e[_0x31c519(0x208)](_0x31c519(0x1d4))){const _0x31fb44=await this[_0x31c519(0x1c4)](_0x344f5e+_0x31c519(0x115));if(_0x31fb44&&_0x31fb44[_0x31c519(0x11c)])_0x476fee=_0x31fb44['val'];}}}}catch(_0xf7b0d){}if(!_0x476fee){const _0x5e2b9a=[_0x31c519(0x21a),_0x31c519(0x1d8),_0x31c519(0x1ad),_0x31c519(0x245)];for(const _0xa4cf68 of _0x5e2b9a){try{const _0x467f25=await this[_0x31c519(0x19e)](_0xa4cf68);if(_0x467f25){if(_0xa4cf68[_0x31c519(0x208)]('accuweather')){const _0x1fa013=await this[_0x31c519(0x1c4)](_0xa4cf68+_0x31c519(0x1d3));if(_0x1fa013&&_0x1fa013[_0x31c519(0x11c)]){_0x476fee=_0x1fa013[_0x31c519(0x11c)];break;}}}}catch(_0x40c189){}}}return _0x476fee?_0x31c519(0x1ae)+_0x476fee:_0x31c519(0x1d9);}catch(_0x1f8f12){return _0x31c519(0x248)+_0x1f8f12[_0x31c519(0x168)];}}async[a0_0x66ac15(0x1f8)](){const _0x1633d0=a0_0x66ac15;try{if(!this['config']['useCalendar'])return _0x1633d0(0x1c0);let _0xfe7f58=this[_0x1633d0(0x109)][_0x1633d0(0x1b7)]||_0x1633d0(0x17a),_0x5f0b8f=this['config'][_0x1633d0(0x123)]||[];if(typeof _0x5f0b8f===_0x1633d0(0x194))_0x5f0b8f=_0x5f0b8f['split'](',');try{const _0x1faf9b=await this[_0x1633d0(0x1c4)](_0xfe7f58+_0x1633d0(0x1b0));if(_0x1faf9b&&_0x1faf9b[_0x1633d0(0x11c)]){let _0x39f18e=this[_0x1633d0(0x140)](_0x1faf9b[_0x1633d0(0x11c)]);if(_0x39f18e&&Array[_0x1633d0(0x1e0)](_0x39f18e)){if(_0x5f0b8f[_0x1633d0(0x182)]>0x0)_0x39f18e=_0x39f18e[_0x1633d0(0x1a1)](_0x2d9749=>_0x5f0b8f[_0x1633d0(0x208)](_0x2d9749[_0x1633d0(0x13f)]||''));else return _0x1633d0(0x13e);if(_0x39f18e['length']>0x0){const _0x426de9=_0x39f18e[_0x1633d0(0x15b)](0x0,0x3)[_0x1633d0(0x15c)](_0x538ae5=>{const _0x46a178=_0x1633d0;let _0x1fafaf=_0x538ae5['date'];if(_0x538ae5['time'])_0x1fafaf+='\x20'+_0x538ae5[_0x46a178(0x1bc)];return _0x1fafaf+':\x20'+_0x538ae5[_0x46a178(0xf2)]+'\x20('+_0x538ae5['_calName']+')';});return _0x1633d0(0x23a)+_0x426de9[_0x1633d0(0x216)](_0x1633d0(0x13b));}else return _0x1633d0(0xfb);}}}catch(_0x318242){this[_0x1633d0(0x25f)][_0x1633d0(0x1c6)](_0x1633d0(0x152)+_0x318242[_0x1633d0(0x168)]);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x2cc1e3){return _0x1633d0(0x1aa)+_0x2cc1e3[_0x1633d0(0x168)];}}async[a0_0x66ac15(0x1f5)](_0x258012){const _0x566df4=a0_0x66ac15;try{const _0x7ce5f4=await this['getForeignStateAsync'](_0x258012+_0x566df4(0x1b0));if(_0x7ce5f4&&_0x7ce5f4[_0x566df4(0x11c)]){const _0x3fe9f0=this[_0x566df4(0x140)](_0x7ce5f4['val']);if(_0x3fe9f0&&Array[_0x566df4(0x1e0)](_0x3fe9f0)){const _0x286f68=[...new Set(_0x3fe9f0[_0x566df4(0x15c)](_0x5056a9=>_0x5056a9[_0x566df4(0x13f)])['filter'](Boolean))];return _0x286f68[_0x566df4(0x24d)]();}}return[];}catch(_0x4ef31b){return this[_0x566df4(0x25f)][_0x566df4(0x24e)]('getCalendarNames\x20Error:\x20'+_0x4ef31b['message']),[];}}async[a0_0x66ac15(0x142)](){const _0x1930af=a0_0x66ac15;try{const _0x24e835=this[_0x1930af(0x109)][_0x1930af(0x110)]||[];let _0x23564b=![];for(const _0x38f5b1 of _0x24e835){try{const _0x126234=await this[_0x1930af(0x1c4)](_0x38f5b1);if(_0x126234&&(_0x126234[_0x1930af(0x11c)]===!![]||_0x126234[_0x1930af(0x11c)]===_0x1930af(0x1be)||_0x126234[_0x1930af(0x11c)]===0x1)){_0x23564b=!![];break;}}catch(_0x3e9634){}}return _0x23564b&&(this[_0x1930af(0x18e)]&&(this[_0x1930af(0x25f)]['info']('WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.'),this[_0x1930af(0x1f0)]()),!this[_0x1930af(0x1fe)]&&this[_0x1930af(0x186)]===SYSTEM_MODES['NORMAL']&&await this[_0x1930af(0x262)](!![])),_0x23564b;}catch(_0x37b5bb){return this['log']['error'](_0x1930af(0x268)+_0x37b5bb[_0x1930af(0x168)]),![];}}['startExitTimer'](){const _0x50b0d2=a0_0x66ac15;this[_0x50b0d2(0x1f0)](),this[_0x50b0d2(0x14a)]=!![],this[_0x50b0d2(0x154)]=setTimeout(()=>{this['isGracePeriodActive']=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this['exitTimer']=setTimeout(()=>{const _0xef30d3=_0x50b0d2;this[_0xef30d3(0x262)](![]),this[_0xef30d3(0x18e)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}['abortExitTimer'](){const _0x376193=a0_0x66ac15;if(this[_0x376193(0x18e)])clearTimeout(this[_0x376193(0x18e)]);if(this[_0x376193(0x154)])clearTimeout(this[_0x376193(0x154)]);this[_0x376193(0x18e)]=null,this[_0x376193(0x154)]=null,this[_0x376193(0x14a)]=![];}async[a0_0x66ac15(0x262)](_0x2c433b){const _0x4c6ba7=a0_0x66ac15;if(this['isPresent']===_0x2c433b)return;this['isPresent']=_0x2c433b,await this[_0x4c6ba7(0x26a)]('system.isPresent',{'val':_0x2c433b,'ack':!![]});}async[a0_0x66ac15(0x22e)](_0x3af583){const _0x28cf36=a0_0x66ac15;this['log']['info'](_0x28cf36(0xe4)+JSON[_0x28cf36(0xf4)](_0x3af583));}async[a0_0x66ac15(0x135)](){const _0xa010a8=a0_0x66ac15;if(!this['isProVersion']||!this[_0xa010a8(0x19d)])return;const _0x646c76=this[_0xa010a8(0x109)][_0xa010a8(0x136)]||0xe;if(this[_0xa010a8(0x127)][_0xa010a8(0x182)]<_0x646c76+(this[_0xa010a8(0x109)]['minDaysForBaseline']||0x7)){await this[_0xa010a8(0x26a)](LTM_DP_DRIFT_STATUS,{'val':'N/A\x20(Learning)','ack':!![]});return;}const _0x38471f=this['dailyDigests']['slice'](-_0x646c76),_0x5514b1=this['dailyDigests'][_0xa010a8(0x15b)](0x0,this[_0xa010a8(0x127)][_0xa010a8(0x182)]-_0x646c76),_0x31e7da=_0xa010a8(0x1a4)+JSON[_0xa010a8(0xf4)](_0x5514b1)+_0xa010a8(0x104)+JSON[_0xa010a8(0xf4)](_0x38471f);try{const _0x289c72=await this[_0xa010a8(0x19d)][_0xa010a8(0x25d)](_0x31e7da),_0x2393a3=JSON[_0xa010a8(0x143)](_0x289c72['response'][_0xa010a8(0x25a)]()[_0xa010a8(0xe1)](/```json|```/g,'')[_0xa010a8(0x218)]());_0x2393a3['baselineDrift']&&(await this[_0xa010a8(0x26a)](LTM_DP_DRIFT_STATUS,{'val':_0x2393a3[_0xa010a8(0x132)],'ack':!![]}),await this[_0xa010a8(0x26a)](LTM_DP_DRIFT_DETAILS,{'val':_0x2393a3[_0xa010a8(0x124)],'ack':!![]}),await this[_0xa010a8(0x26a)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x413a18){}}[a0_0x66ac15(0x113)](){const _0x4f3038=a0_0x66ac15;try{if(this['ltmJob'])this[_0x4f3038(0x239)][_0x4f3038(0x161)]();if(!this[_0x4f3038(0x21f)]){this[_0x4f3038(0x26a)](LTM_DP_STATUS,{'val':_0x4f3038(0x148),'ack':!![]});return;}this['ltmJob']=schedule[_0x4f3038(0x12e)](LTM_SCHEDULE,()=>this['createDailyDigest']());}catch(_0x355011){this[_0x4f3038(0x25f)][_0x4f3038(0x24e)]('LTM\x20Sched\x20Error:\x20'+_0x355011[_0x4f3038(0x168)]);}}[a0_0x66ac15(0x16c)](){const _0x53f168=a0_0x66ac15;try{if(this[_0x53f168(0x1de)])this[_0x53f168(0x1de)][_0x53f168(0x161)]();this[_0x53f168(0x1de)]=schedule[_0x53f168(0x12e)](MODE_RESET_SCHEDULE,async()=>{const _0x42fa7d=_0x53f168;await this[_0x42fa7d(0x125)](),AUTO_RESET_MODES[_0x42fa7d(0x208)](this[_0x42fa7d(0x186)])&&await this[_0x42fa7d(0x26a)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x42fa7d(0x23f)],'ack':![]});});}catch(_0x6ece20){this[_0x53f168(0x25f)][_0x53f168(0x24e)]('Reset\x20Sched\x20Error:\x20'+_0x6ece20['message']);}}['setupDriftAnalysisScheduler'](){const _0xb63854=a0_0x66ac15;try{if(this[_0xb63854(0x266)])clearInterval(this[_0xb63854(0x266)]);if(!this['isProVersion'])return;this[_0xb63854(0x266)]=setInterval(()=>this[_0xb63854(0x135)](),(this['config']['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>this[_0xb63854(0x135)](),0x1388);}catch(_0x289ebe){this[_0xb63854(0x25f)]['error'](_0xb63854(0x16f)+_0x289ebe['message']);}}[a0_0x66ac15(0x15e)](){const _0x3d0be8=a0_0x66ac15;try{if(this['briefingJob'])this['briefingJob']['cancel']();if(!this[_0x3d0be8(0x109)][_0x3d0be8(0x205)])return;const _0x2b1612=(this[_0x3d0be8(0x109)][_0x3d0be8(0xf8)]||'08:00')[_0x3d0be8(0x1ed)](':'),_0x212dc7=parseInt(_0x2b1612[0x0])||0x8,_0x6b3fe=parseInt(_0x2b1612[0x1])||0x0,_0x284056=_0x6b3fe+'\x20'+_0x212dc7+_0x3d0be8(0x173);this[_0x3d0be8(0x25f)][_0x3d0be8(0x188)](_0x3d0be8(0x18a)+_0x212dc7+':'+(_0x6b3fe<0xa?'0'+_0x6b3fe:_0x6b3fe)),this[_0x3d0be8(0x1c8)]=schedule[_0x3d0be8(0x12e)](_0x284056,()=>{const _0x263c5f=_0x3d0be8;this[_0x263c5f(0x14c)]();});}catch(_0x4176b1){this[_0x3d0be8(0x25f)]['error'](_0x3d0be8(0x195)+_0x4176b1[_0x3d0be8(0x168)]);}}async[a0_0x66ac15(0xe9)](_0x505076,_0x542fe6=![],_0x29a4b6=![]){const _0x31c8b6=a0_0x66ac15;this['log'][_0x31c8b6(0x188)]((_0x542fe6?'[TEST]\x20':'')+_0x31c8b6(0x1a3)+_0x505076+'\x22');const _0x299a3=this['config'];let _0x25481d=0x0;_0x299a3[_0x31c8b6(0x251)]&&(await this[_0x31c8b6(0x1b9)](_0x299a3[_0x31c8b6(0xee)],'send',{'text':_0x505076,'user':_0x299a3['notifyTelegramRecipient']}),_0x25481d++);if(_0x299a3[_0x31c8b6(0x105)]){let _0x5ebd44={'message':_0x505076,'title':_0x29a4b6?'üö®\x20EMERGENCY':_0x31c8b6(0x100),'priority':_0x29a4b6?0x2:0x1,'device':_0x299a3[_0x31c8b6(0x1b5)]};_0x29a4b6&&(_0x5ebd44[_0x31c8b6(0x10d)]=0x1e,_0x5ebd44[_0x31c8b6(0x10e)]=0xe10,_0x5ebd44[_0x31c8b6(0x265)]='siren'),await this[_0x31c8b6(0x1b9)](_0x299a3[_0x31c8b6(0x176)],_0x31c8b6(0x236),_0x5ebd44),_0x25481d++;}return _0x299a3[_0x31c8b6(0x107)]&&(await this[_0x31c8b6(0x1b9)](_0x299a3[_0x31c8b6(0x18b)],_0x31c8b6(0x236),{'text':_0x505076,'to':_0x299a3['notifyEmailRecipient']}),_0x25481d++),_0x25481d;}}function a0_0x2354(){const _0x2668e6=['from','GUEST','string','Briefing\x20Sched\x20Error:\x20','k√ºche','Baseline\x20Status','valve','\x20Tage)','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20Schlafunterbrechungen\x20und\x20n√§chtliche\x20Unruhe.','channel','daswetter','geminiModel','getForeignObjectAsync','231428oAwWtX','system.meta.uuid','filter','analysis.automation','Sending\x20notification:\x20\x22','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','connection','power','direction','b√ºro','config_pending','KALENDER\x20ERROR:\x20','PRO-','Last\x20Result','weatherunderground.0','WETTER:\x20','Subscribing\x20to\x20','.data.table','find','Deviation','balkon','lastAlertState','notifyPushoverRecipient','javascript.','calendarInstance','uuid-not-found','sendToAsync','Alert\x20Reason','Gemini\x20Init\x20Error:\x20','time','analysis.automation.suggestedAction','online','Restlessness\x20Level','Kalender:\x20Deaktiviert','loadRawEventLog','analysis.isEmergency','system.mode','getForeignStateAsync','1072183MlxSbT','warn','getStateAsync','briefingJob','t√ºr','door','(((.+)+)+)+$','scriptEnabled','sendTo','normal','AI\x20Emergency\x20Status','temperature','triggerBriefing','exports','.Summary.Current','openweathermap','heizung','stick_unreach','Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','daswetter.0','WETTER:\x20Keine\x20Daten\x20gefunden','updateAnalysisHistory','bad','checkLtmDriftObjects','command','modeResetJob','6505500NuyMQt','isArray','flot.','initPresenceSubscriptions','Trigger\x20Analysis','events.lastEvent','values','schlaf','Adapter','2826EMGXQl','gang','Wetter:\x20Deaktiviert','2161976mWjtjG','accuweather','split','common','LTM.processingStatus','abortExitTimer','selectedFunctionIds','position','weatherInstance','licht','getCalendarNames','useWeather','Garten','getCalendarContext','off','Sleep\x20Score\x20(0-100)','startsWith','update','\x20presence\x20devices...','isPresent','system.config','.NextHours.Location_1.Day_1.current.symbol_desc','Normal','analysis.comfortSuggestion','doors','minDaysForBaseline','briefingEnabled','Last\x20raw\x20event','N/A','includes','setpoint','runAutopilot','0\x204\x20*\x20*\x20*','Flur','unshift','toString','0\x203\x20*\x20*\x20*','analysis.isAlert','Pattern\x20Detected','history.','Lernphase\x20(','ready','native','join','loadDailyDigests','trim','reachable','accuweather.0','TEST-PRO-KEY','createAllObjects','Gemini\x20AI\x20initialized.','icons-mfd.','isProVersion','node-schedule','toLowerCase','scanForDevices','info.','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','schalter','getEnums','ltmLtbWindowDays','presence','60420WHjNGI','boolean','none','systemConfig','analysis.lastResult','saveFeedback','initHistory','fenster','role','vacation','admin.','analysis.feedbackHistory','light','send','events.history','Scanning\x20for\x20devices\x20(Legacy\x20+\x20Heating\x20Fix)...','ltmJob','KALENDER:\x20','humidity','custom','Processing\x20Status','onMessage','NORMAL','button','onStateChange','subscribeStates','bind','scanDevices','openweathermap.0','checkSystemObjects','System\x20Status\x20&\x20Control','WETTER\x20ERROR:\x20','setupDriftAnalysisScheduler','type','state','getSystemUUID','sort','error','members','motion','notifyTelegramEnabled','828BiMWNH','sensor','isExit','getLtmData','Description','level','main','geminiApiKey','text','enum.functions.*','Unknown','generateContent','licenseKey','log','\x20min).\x20Watchdog\x20Limit:\x20','Last\x20Check','setPresence','Comfort\x20Suggestion','initSensorSubscriptions','sound','driftAnalysisTimer','rawEventLog','Error\x20checking\x20WiFi:\x20','_score','setStateAsync','getForeignObjectsAsync','saveDailyDigests','uuid','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','replace','toilette','Trigger\x20Digest','Feedback\x20saved:\x20','setObjectNotExistsAsync','[SCANNER]\x20FOUND:\x20','K√ºche','LTM.driftAnalysis','sendNotification','ack','currentposition','Urlaub','startExitTimer','notifyTelegramInstance','dimmer','VACATION','sensorLastValues','event','constructor','stringify','analysis.trigger','getGenerativeModel','checkLicense','briefingTime','date','push','KALENDER:\x20Keine\x20relevanten\x20Termine','1bRyRnU','subscribeForeignStatesAsync','setState','city','Cogni-Living','Drift\x20Analysis','number','analysis.triggerBriefing','\x0aSTB:\x20','notifyPushoverEnabled','name','notifyEmailEnabled','wohn','config','callback','analysis.alertReason','Starting\x20Autopilot\x20(','retry','expire','analysis.health','presenceDevices','genAI','indicator','setupLtmScheduler','analysisHistory','.forecast.current.state','search','logDuplicates','cogni-living','B√ºro','initSystemConfig','getWeatherContext','val','eventHistory','LTM','Keller','352332aPucGP','istwert','scriptProblem','calendarSelection','driftDetails','loadSystemMode','LTM.rawEventLog','dailyDigests','Automation\x20Proposals','temp','inactivityThresholdHours','switch','simple-api.','updateBaselineStatus','scheduleJob','analysis.automation.patternDetected','analysis.automation.description','extendObjectAsync','baselineDrift','analysis.comfortSummary','energy','runBaselineDriftAnalysis','ltmStbWindowDays','pop','Drift\x20Status','occupancy','@google/generative-ai','\x20|\x20','getOverviewData','Feedback\x20Log','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','_calName','tryParse','dutycycle','checkWifiPresence','parse','analysis.health.notes','stateChange','Drift\x20Details','weather','Deaktiviert\x20(Pro-Feature)','analysis.health.sleepScore','isGracePeriodActive','party','sendMorningBriefing','lampe','blind','feedbackHistory','processSensorEvent',')\x20in\x20','Error\x20reading\x20calendar\x20table:\x20','klima','exitGraceTimer','write','lowbat','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','shutter','LTM.driftAnalysis.baselineDrift','License\x20Check\x20failed:\x20','slice','map','LTM.driftAnalysis.driftDetails','setupBriefingScheduler','models/gemini-flash-latest','onUnload','cancel','analysisTimer','value.health','some','analysisInterval','version','runGeminiAnalysis','message','targetposition','9copaOG','Badezimmer','setupModeResetScheduler','enum','analysis.analysisHistory','Drift\x20Sched\x20Error:\x20','Raw\x20Log','systemUUID','uuid-error','\x20*\x20*\x20*','createDailyDigest','json','notifyPushoverInstance','location','Wohnzimmer','devices','ical.0','PARTY','checkLtmObjects','material.','Party','object','application/json','guest','length','analysis.deviationFromBaseline','testNotification','Gast','currentSystemMode','Health\x20Notes','info','level.valve','Scheduling\x20Morning\x20Briefing\x20for\x20','notifyEmailInstance','LTM.baselineStatus','LTM.dailyDigests','exitTimer','status','toISOString','initZombies'];a0_0x2354=function(){return _0x2668e6;};return a0_0x2354();}if(require[a0_0x66ac15(0x258)]!==module)module[a0_0x66ac15(0x1d2)]=_0x3b12cf=>new CogniLiving(_0x3b12cf);else new CogniLiving();