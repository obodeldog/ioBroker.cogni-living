const a0_0x2efbe2=a0_0x6a99;(function(_0x573da2,_0x2020ad){const _0x3928d0=a0_0x6a99,_0x339727=_0x573da2();while(!![]){try{const _0x305559=parseInt(_0x3928d0(0x290))/0x1*(-parseInt(_0x3928d0(0x1bb))/0x2)+parseInt(_0x3928d0(0x281))/0x3+parseInt(_0x3928d0(0x15e))/0x4*(-parseInt(_0x3928d0(0x149))/0x5)+-parseInt(_0x3928d0(0x1b2))/0x6+-parseInt(_0x3928d0(0x1db))/0x7+-parseInt(_0x3928d0(0x29a))/0x8+-parseInt(_0x3928d0(0x184))/0x9*(-parseInt(_0x3928d0(0x12f))/0xa);if(_0x305559===_0x2020ad)break;else _0x339727['push'](_0x339727['shift']());}catch(_0xe406f7){_0x339727['push'](_0x339727['shift']());}}}(a0_0x8434,0x32367));const a0_0x5e5ae5=(function(){let _0x3d2fa0=!![];return function(_0x2f843d,_0x3cb907){const _0x5dc37f=_0x3d2fa0?function(){const _0x141a7a=a0_0x6a99;if(_0x3cb907){const _0x3ee07e=_0x3cb907[_0x141a7a(0x17f)](_0x2f843d,arguments);return _0x3cb907=null,_0x3ee07e;}}:function(){};return _0x3d2fa0=![],_0x5dc37f;};}()),a0_0x407a55=a0_0x5e5ae5(this,function(){const _0x1f3a8=a0_0x6a99;return a0_0x407a55[_0x1f3a8(0x22d)]()[_0x1f3a8(0x250)](_0x1f3a8(0x14c))['toString']()[_0x1f3a8(0x173)](a0_0x407a55)[_0x1f3a8(0x250)]('(((.+)+)+)+$');});a0_0x407a55();'use strict';const utils=require(a0_0x2efbe2(0x13a)),{GoogleGenerativeAI}=require(a0_0x2efbe2(0x2ca)),schedule=require('node-schedule'),{spawn,exec}=require(a0_0x2efbe2(0x1e8)),path=require(a0_0x2efbe2(0x246)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x2efbe2(0x258),LTM_SCHEDULE=a0_0x2efbe2(0x1f3),MODE_RESET_SCHEDULE=a0_0x2efbe2(0x1b5),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x2efbe2(0x175),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x2efbe2(0x198),LTM_DP_DRIFT_CHANNEL=a0_0x2efbe2(0x12b),LTM_DP_DRIFT_STATUS=a0_0x2efbe2(0x214),LTM_DP_DRIFT_DETAILS=a0_0x2efbe2(0x19b),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x2efbe2(0x17e),SYSTEM_MODES={'NORMAL':a0_0x2efbe2(0x129),'VACATION':a0_0x2efbe2(0x124),'PARTY':a0_0x2efbe2(0x10e),'GUEST':a0_0x2efbe2(0x28e)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x2efbe2(0x22e)],SYSTEM_MODES[a0_0x2efbe2(0x19f)]],PERSONA_MAPPING={'generic':a0_0x2efbe2(0x1f5),'senior_aal':a0_0x2efbe2(0x28b),'family':a0_0x2efbe2(0x222),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0x2efbe2(0x158)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},HARD_IGNORE_TERMS=['scriptProblem','scriptEnabled',a0_0x2efbe2(0x211),a0_0x2efbe2(0x249),a0_0x2efbe2(0x16c),a0_0x2efbe2(0x25e),a0_0x2efbe2(0x224),'maintenance',a0_0x2efbe2(0x140),'fault','working',a0_0x2efbe2(0x11d),a0_0x2efbe2(0x2aa),a0_0x2efbe2(0x152),a0_0x2efbe2(0x278),a0_0x2efbe2(0x1aa),'reachable',a0_0x2efbe2(0x1fa)],BAD_NAMES=[a0_0x2efbe2(0x192),a0_0x2efbe2(0x23c),'state',a0_0x2efbe2(0x2c9),a0_0x2efbe2(0x144),'brightness','on',a0_0x2efbe2(0x2c8),a0_0x2efbe2(0x145),a0_0x2efbe2(0x1e1),'shutter','blind','cover','status','motion',a0_0x2efbe2(0x185),a0_0x2efbe2(0x229),a0_0x2efbe2(0x1ca),a0_0x2efbe2(0x11e),a0_0x2efbe2(0x147),a0_0x2efbe2(0x1d1),'setpoint',a0_0x2efbe2(0x2ce),a0_0x2efbe2(0x239),'set_temperature'],ADAPTER_BLACKLIST=[a0_0x2efbe2(0x2bb),a0_0x2efbe2(0x17b),a0_0x2efbe2(0x1e9),a0_0x2efbe2(0x267),a0_0x2efbe2(0x253),a0_0x2efbe2(0x2c0),a0_0x2efbe2(0x12e),'flot.',a0_0x2efbe2(0x1e7),'javascript.',a0_0x2efbe2(0x1ac)],IS_WIN=process[a0_0x2efbe2(0x1a3)]==='win32',VENV_PATH=path[a0_0x2efbe2(0x2b8)](__dirname,a0_0x2efbe2(0x24f)),PYTHON_EXE=IS_WIN?path[a0_0x2efbe2(0x2b8)](VENV_PATH,a0_0x2efbe2(0x268),a0_0x2efbe2(0x116)):path['join'](VENV_PATH,a0_0x2efbe2(0x180),a0_0x2efbe2(0x26a)),PIP_EXE=IS_WIN?path[a0_0x2efbe2(0x2b8)](VENV_PATH,a0_0x2efbe2(0x268),a0_0x2efbe2(0x1b6)):path[a0_0x2efbe2(0x2b8)](VENV_PATH,a0_0x2efbe2(0x180),a0_0x2efbe2(0x177));let activeSequence=[],sequenceTimer=null,panicMode=![];async function initZombies(_0x52adf5){const _0x448d77=a0_0x2efbe2;try{const _0x27c3db=['analysis.history_debug_00',_0x448d77(0x1cd)];for(const _0x550251 of _0x27c3db){try{const _0x292401=await _0x52adf5[_0x448d77(0x21f)](_0x550251);if(_0x292401)await _0x52adf5[_0x448d77(0x289)](_0x550251);}catch(_0x22398e){}}}catch(_0x54b6ae){}}async function initHistory(_0xbef451){const _0xe19548=a0_0x2efbe2;try{const _0x53d627=await _0xbef451[_0xe19548(0x1dc)](_0xe19548(0x1eb));_0x53d627&&_0x53d627['val']&&(_0xbef451['eventHistory']=JSON[_0xe19548(0x2ad)](_0x53d627[_0xe19548(0x18a)][_0xe19548(0x22d)]()));}catch(_0x523abd){_0xbef451[_0xe19548(0x215)]=[];}try{const _0x4fa17f=await _0xbef451[_0xe19548(0x1dc)](_0xe19548(0x15f));if(_0x4fa17f&&_0x4fa17f[_0xe19548(0x18a)])_0xbef451['analysisHistory']=JSON['parse'](_0x4fa17f[_0xe19548(0x18a)][_0xe19548(0x22d)]());}catch(_0x2ea9ff){_0xbef451[_0xe19548(0x12d)]=[];}if(_0xbef451[_0xe19548(0x215)]&&_0xbef451['eventHistory']['length']>0x0){_0xbef451[_0xe19548(0x118)]['info']('Restoring\x20sensor\x20cache\x20from\x20history\x20('+_0xbef451['eventHistory'][_0xe19548(0x2b9)]+_0xe19548(0x1d3));for(let _0x47756c=_0xbef451[_0xe19548(0x215)][_0xe19548(0x2b9)]-0x1;_0x47756c>=0x0;_0x47756c--){const _0x22e19a=_0xbef451[_0xe19548(0x215)][_0x47756c];if(_0x22e19a&&_0x22e19a['id']!==undefined&&_0x22e19a['value']!==undefined)_0xbef451['sensorLastValues'][_0x22e19a['id']]=_0x22e19a[_0xe19548(0x144)];}}}async function initSystemConfig(_0x1b141d){const _0x381540=a0_0x2efbe2;try{const _0x5349bd=await _0x1b141d[_0x381540(0x230)](_0x381540(0x25a));if(_0x5349bd&&_0x5349bd[_0x381540(0x1cc)])_0x1b141d[_0x381540(0x1ce)]={'latitude':_0x5349bd['common'][_0x381540(0x285)]||0x0,'longitude':_0x5349bd[_0x381540(0x1cc)][_0x381540(0x1f6)]||0x0,'city':_0x5349bd['common'][_0x381540(0x2d0)]||''};}catch(_0x302ba3){}}async function checkLicense(_0x359341,_0x1bed29){return!![];}function a0_0x6a99(_0x11b4ce,_0x725ae5){const _0x2ddae4=a0_0x8434();return a0_0x6a99=function(_0x407a55,_0x5e5ae5){_0x407a55=_0x407a55-0x10b;let _0x8434b=_0x2ddae4[_0x407a55];return _0x8434b;},a0_0x6a99(_0x11b4ce,_0x725ae5);}async function getSystemUUID(_0x5c297e){return'uuid';}async function loadRawEventLog(_0x1a9780){const _0x1f6c72=a0_0x2efbe2;try{const _0x40e3f0=await _0x1a9780[_0x1f6c72(0x1dc)](LTM_DP_RAW_LOG);if(_0x40e3f0&&_0x40e3f0[_0x1f6c72(0x18a)])_0x1a9780[_0x1f6c72(0x28f)]=JSON[_0x1f6c72(0x2ad)](_0x40e3f0[_0x1f6c72(0x18a)]);}catch(_0x2ee470){_0x1a9780[_0x1f6c72(0x28f)]=[];}}async function saveRawEventLog(_0x1eb058){const _0x26aedc=a0_0x2efbe2;if(_0x1eb058[_0x26aedc(0x28f)][_0x26aedc(0x2b9)]>RAW_LOG_MAX_SIZE)_0x1eb058['rawEventLog']['splice'](0x0,_0x1eb058['rawEventLog'][_0x26aedc(0x2b9)]-RAW_LOG_MAX_SIZE);await _0x1eb058[_0x26aedc(0x233)](LTM_DP_RAW_LOG,{'val':JSON[_0x26aedc(0x163)](_0x1eb058[_0x26aedc(0x28f)]),'ack':!![]});}async function loadDailyDigests(_0x24de87){const _0x1d099d=a0_0x2efbe2;try{const _0x22dafc=await _0x24de87[_0x1d099d(0x1dc)](LTM_DP_DAILY_DIGESTS);if(_0x22dafc&&_0x22dafc['val'])_0x24de87[_0x1d099d(0x137)]=JSON[_0x1d099d(0x2ad)](_0x22dafc[_0x1d099d(0x18a)]);}catch(_0x3536bf){_0x24de87[_0x1d099d(0x137)]=[];}await updateBaselineStatus(_0x24de87);}async function saveDailyDigests(_0x4427b6,_0x354cc6=!![]){const _0x1c5fd4=a0_0x2efbe2,_0x215e5f=_0x4427b6[_0x1c5fd4(0x148)][_0x1c5fd4(0x2cf)]||0x3c;_0x4427b6[_0x1c5fd4(0x137)][_0x1c5fd4(0x2b9)]>_0x215e5f&&_0x4427b6['dailyDigests'][_0x1c5fd4(0x26b)](0x0,_0x4427b6[_0x1c5fd4(0x137)][_0x1c5fd4(0x2b9)]-_0x215e5f);await _0x4427b6[_0x1c5fd4(0x233)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x4427b6[_0x1c5fd4(0x137)]),'ack':!![]});if(_0x354cc6)await updateBaselineStatus(_0x4427b6);}async function updateAnalysisHistory(_0x5b360d,_0x2e4595){const _0x35fad7=a0_0x2efbe2;_0x5b360d[_0x35fad7(0x12d)][_0x35fad7(0x228)](_0x2e4595);if(_0x5b360d[_0x35fad7(0x12d)]['length']>ANALYSIS_HISTORY_MAX_SIZE)_0x5b360d[_0x35fad7(0x12d)][_0x35fad7(0x121)]();await _0x5b360d[_0x35fad7(0x233)](_0x35fad7(0x15f),{'val':JSON[_0x35fad7(0x163)](_0x5b360d[_0x35fad7(0x12d)]),'ack':!![]});}async function updateBaselineStatus(_0x3135e0){const _0x2cd2a1=a0_0x2efbe2;if(!_0x3135e0[_0x2cd2a1(0x2be)]){await _0x3135e0[_0x2cd2a1(0x233)](LTM_DP_BASELINE_STATUS,{'val':_0x2cd2a1(0x29b),'ack':!![]});return;}const _0x24ae1f=_0x3135e0[_0x2cd2a1(0x137)]['length']>=(_0x3135e0[_0x2cd2a1(0x148)]['minDaysForBaseline']||0x7)?_0x2cd2a1(0x151)+_0x3135e0['dailyDigests'][_0x2cd2a1(0x2b9)]+_0x2cd2a1(0x2d2):_0x2cd2a1(0x1a2)+_0x3135e0[_0x2cd2a1(0x137)][_0x2cd2a1(0x2b9)]+'/'+(_0x3135e0[_0x2cd2a1(0x148)]['minDaysForBaseline']||0x7)+')';await _0x3135e0[_0x2cd2a1(0x233)](LTM_DP_BASELINE_STATUS,{'val':_0x24ae1f,'ack':!![]});}async function loadSystemMode(_0x5456f0){const _0x5b79fa=a0_0x2efbe2;try{const _0x25731e=await _0x5456f0[_0x5b79fa(0x1dc)](SYSTEM_DP_MODE);_0x25731e&&_0x25731e[_0x5b79fa(0x18a)]&&Object[_0x5b79fa(0x168)](SYSTEM_MODES)['includes'](_0x25731e[_0x5b79fa(0x18a)])?_0x5456f0[_0x5b79fa(0x155)]=_0x25731e[_0x5b79fa(0x18a)]:(_0x5456f0[_0x5b79fa(0x155)]=SYSTEM_MODES[_0x5b79fa(0x153)],await _0x5456f0['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x5b79fa(0x153)],'ack':!![]}));}catch(_0x27e8d7){_0x5456f0[_0x5b79fa(0x155)]=SYSTEM_MODES[_0x5b79fa(0x153)];}}async function createAllObjects(_0xf4e3ef){const _0x2a505b=a0_0x2efbe2;await _0xf4e3ef[_0x2a505b(0x24a)](_0x2a505b(0x2d4),{'type':_0x2a505b(0x127),'common':{'name':'System'},'native':{}}),await _0xf4e3ef['extendObjectAsync'](SYSTEM_DP_MODE,{'type':'state','common':{'name':'System\x20Mode','type':_0x2a505b(0x277),'role':'state','read':!![],'write':!![],'def':SYSTEM_MODES[_0x2a505b(0x153)]},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync'](_0x2a505b(0x1c4),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x284),'type':'string','role':_0x2a505b(0x1cb),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x2b4),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x174),'type':_0x2a505b(0x277),'role':'json','read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x1eb),{'type':'state','common':{'name':_0x2a505b(0x196),'type':_0x2a505b(0x277),'role':'json','read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x24a)]('analysis.training',{'type':'channel','common':{'name':_0x2a505b(0x1da)},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x1f7),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x10d),'type':_0x2a505b(0x1ef),'role':'button','read':!![],'write':!![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x2c4),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x18e),'type':_0x2a505b(0x1ef),'role':_0x2a505b(0x21d),'read':!![],'write':!![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)]('analysis.training.triggerEnergy',{'type':'state','common':{'name':_0x2a505b(0x1e4),'type':_0x2a505b(0x1ef),'role':_0x2a505b(0x21d),'read':!![],'write':!![]},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync'](_0x2a505b(0x156),{'type':'state','common':{'name':_0x2a505b(0x1e5),'type':'string','role':_0x2a505b(0x1cb),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x24a)](_0x2a505b(0x200),{'type':_0x2a505b(0x127),'common':{'name':'Security\x20Monitor'},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync'](_0x2a505b(0x1a7),{'type':_0x2a505b(0x2bf),'common':{'name':'Anomaly\x20Score','type':_0x2a505b(0x213),'role':'value','read':!![],'write':![]},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync']('analysis.security.lastCheck',{'type':'state','common':{'name':_0x2a505b(0x189),'type':'string','role':_0x2a505b(0x17a),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x24a)](_0x2a505b(0x165),{'type':_0x2a505b(0x127),'common':{'name':_0x2a505b(0x20c)},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync'](_0x2a505b(0x1ad),{'type':_0x2a505b(0x2bf),'common':{'name':'Last\x20Check','type':'string','role':_0x2a505b(0x17a),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x1a6),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x2a6),'type':'boolean','role':_0x2a505b(0x19d),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)]('analysis.health.trendDiagnosis',{'type':'state','common':{'name':_0x2a505b(0x2d5),'type':_0x2a505b(0x277),'role':'text','read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)]('analysis.health.trendValue',{'type':'state','common':{'name':_0x2a505b(0x234),'type':_0x2a505b(0x213),'role':_0x2a505b(0x144),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x24a)]('analysis.energy',{'type':_0x2a505b(0x127),'common':{'name':_0x2a505b(0x14f)},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync']('analysis.energy.insulationScore',{'type':_0x2a505b(0x2bf),'common':{'name':'Insulation\x20Score','type':_0x2a505b(0x277),'role':_0x2a505b(0x1cb),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x195),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x16e),'type':_0x2a505b(0x277),'role':_0x2a505b(0x1cb),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x24a)](_0x2a505b(0x265),{'type':'channel','common':{'name':'LTM'},'native':{}}),await _0xf4e3ef[_0x2a505b(0x24a)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x2a505b(0x29f),'type':_0x2a505b(0x277),'role':_0x2a505b(0x1e2),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x24a)](LTM_DP_DAILY_DIGESTS,{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x162),'type':_0x2a505b(0x277),'role':'json','read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x171),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x29d),'type':_0x2a505b(0x277),'role':_0x2a505b(0x1e2),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x299),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x292),'type':_0x2a505b(0x277),'role':_0x2a505b(0x1e2),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x1c2),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x135),'type':_0x2a505b(0x1ef),'role':_0x2a505b(0x21d),'read':!![],'write':!![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x23d),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x1ab),'type':_0x2a505b(0x1ef),'role':_0x2a505b(0x21d),'read':!![],'write':!![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)]('analysis.isAlert',{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x1f9),'type':_0x2a505b(0x1ef),'role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)]('analysis.alertReason',{'type':_0x2a505b(0x2bf),'common':{'name':'Alert\x20Reason','type':'string','role':_0x2a505b(0x1d6),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync'](_0x2a505b(0x136),{'type':_0x2a505b(0x2bf),'common':{'name':'Activity\x20Summary','type':_0x2a505b(0x277),'role':_0x2a505b(0x1cb),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)]('analysis.automation.patternDetected',{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x2a2),'type':_0x2a505b(0x1ef),'role':_0x2a505b(0x19d),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync']('analysis.automation.description',{'type':'state','common':{'name':'Description','type':_0x2a505b(0x277),'role':_0x2a505b(0x1cb),'read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x24d),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x2c2),'type':_0x2a505b(0x277),'role':'text','read':!![],'write':![]},'native':{}}),await _0xf4e3ef['setObjectNotExistsAsync'](_0x2a505b(0x1b1),{'type':_0x2a505b(0x2bf),'common':{'name':_0x2a505b(0x295),'type':_0x2a505b(0x277),'role':'text','read':!![],'write':![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)](_0x2a505b(0x244),{'type':_0x2a505b(0x2bf),'common':{'name':'Auto\x20Apply','type':_0x2a505b(0x1ef),'role':_0x2a505b(0x145),'read':!![],'write':!![]},'native':{}}),await _0xf4e3ef[_0x2a505b(0x221)]('analysis.automation.triggerAction',{'type':'state','common':{'name':_0x2a505b(0x256),'type':'boolean','role':'button','read':!![],'write':!![]},'native':{}});}async function recordThermodynamics(_0x26d63d,_0x205fc5,_0x43ff48,_0xdfdd8f){const _0x507dcc=a0_0x2efbe2,_0x2c2ef1=await getOutsideTemperatureNumeric(_0x26d63d),_0x38ae13=await _0x26d63d[_0x507dcc(0x1dc)](_0x507dcc(0x299));let _0x2b9310=[];if(_0x38ae13&&_0x38ae13[_0x507dcc(0x18a)])try{_0x2b9310=JSON[_0x507dcc(0x2ad)](_0x38ae13[_0x507dcc(0x18a)]);}catch(_0xc6a7b4){}_0x2b9310[_0x507dcc(0x15b)]({'ts':Date[_0x507dcc(0x1ba)](),'room':_0xdfdd8f||'Unknown','t_in':_0x43ff48,'t_out':_0x2c2ef1});if(_0x2b9310[_0x507dcc(0x2b9)]>THERMO_LOG_SIZE)_0x2b9310[_0x507dcc(0x2ab)]();await _0x26d63d[_0x507dcc(0x233)]('LTM.trainingData.thermodynamics',{'val':JSON[_0x507dcc(0x163)](_0x2b9310),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x135f35){const _0x2087a6=a0_0x2efbe2;if(_0x135f35[_0x2087a6(0x148)][_0x2087a6(0x1bc)])try{const _0x1c75eb=await _0x135f35[_0x2087a6(0x241)](_0x135f35[_0x2087a6(0x148)]['outdoorSensorId']);if(_0x1c75eb&&_0x1c75eb[_0x2087a6(0x18a)]!==undefined&&_0x1c75eb[_0x2087a6(0x18a)]!==null)return parseFloat(_0x1c75eb[_0x2087a6(0x18a)]);}catch(_0x22dee6){}const _0x4aaad8=_0x135f35[_0x2087a6(0x148)][_0x2087a6(0x216)];if(!_0x135f35['config'][_0x2087a6(0x166)]||!_0x4aaad8)return null;try{let _0x1f5e86='';if(_0x4aaad8['includes']('accuweather'))_0x1f5e86=_0x4aaad8+'.Current.Temperature';else{if(_0x4aaad8[_0x2087a6(0x210)](_0x2087a6(0x12a)))_0x1f5e86=_0x4aaad8+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x4aaad8['includes'](_0x2087a6(0x164)))_0x1f5e86=_0x4aaad8+_0x2087a6(0x25b);else{if(_0x4aaad8[_0x2087a6(0x210)](_0x2087a6(0x24b)))_0x1f5e86=_0x4aaad8+'.forecast.current.temp';}}}if(_0x1f5e86){const _0x1fd24d=await _0x135f35[_0x2087a6(0x241)](_0x1f5e86);if(_0x1fd24d&&_0x1fd24d[_0x2087a6(0x18a)]!==undefined&&_0x1fd24d[_0x2087a6(0x18a)]!==null)return parseFloat(_0x1fd24d['val']);}}catch(_0x5bdaea){}return null;}async function recordSequence(_0x4a08ae,_0x4b3821){const _0x2f1906=a0_0x2efbe2,_0x3994ac=(_0x4b3821[_0x2f1906(0x176)]||'')['toLowerCase'](),_0x4407c6=[_0x2f1906(0x22b),_0x2f1906(0x120),_0x2f1906(0x2ac),_0x2f1906(0x185),_0x2f1906(0x229),_0x2f1906(0x1bf),_0x2f1906(0x1af),_0x2f1906(0x16f),_0x2f1906(0x139),_0x2f1906(0x20a),_0x2f1906(0x245),_0x2f1906(0x23b),'licht','switch',_0x2f1906(0x11f),_0x2f1906(0x1be),_0x2f1906(0x18b)];if(!_0x4407c6[_0x2f1906(0x191)](_0xbbea25=>_0x3994ac[_0x2f1906(0x210)](_0xbbea25)))return;if(!_0x4b3821[_0x2f1906(0x144)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x2f1906(0x15b)]({'loc':_0x4b3821[_0x2f1906(0x26f)]||_0x2f1906(0x21a),'id':_0x4b3821['id'],'ts':Date['now']()}),_0x4a08ae[_0x2f1906(0x118)][_0x2f1906(0x2b7)]('[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20'+_0x4b3821['location']+_0x2f1906(0x186)+activeSequence['length']+')'),sequenceTimer=setTimeout(async()=>{const _0x2f0d16=_0x2f1906;if(activeSequence[_0x2f0d16(0x2b9)]>0x1)await saveCompletedSequence(_0x4a08ae);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x21e54c){const _0x4399d2=a0_0x2efbe2;try{const _0x502881=await _0x21e54c[_0x4399d2(0x1dc)](_0x4399d2(0x171));let _0x5a1f72=[];if(_0x502881&&_0x502881[_0x4399d2(0x18a)])try{_0x5a1f72=JSON[_0x4399d2(0x2ad)](_0x502881[_0x4399d2(0x18a)]);}catch(_0x401cfa){}const _0x43af34=activeSequence[0x0]['ts'],_0x228970=activeSequence[_0x4399d2(0x248)](_0x5456b0=>({'loc':_0x5456b0[_0x4399d2(0x225)],'t_delta':Math['round']((_0x5456b0['ts']-_0x43af34)/0x3e8)})),_0x9c4e7d={'timestamp':new Date(_0x43af34)[_0x4399d2(0x1c8)](),'steps':_0x228970,'duration':Math['round']((activeSequence[activeSequence[_0x4399d2(0x2b9)]-0x1]['ts']-_0x43af34)/0x3e8),'daytime':new Date(_0x43af34)[_0x4399d2(0x25d)]()};_0x5a1f72[_0x4399d2(0x15b)](_0x9c4e7d);if(_0x5a1f72[_0x4399d2(0x2b9)]>MAX_TRAINING_SET_SIZE)_0x5a1f72[_0x4399d2(0x2ab)]();await _0x21e54c[_0x4399d2(0x233)]('LTM.trainingData.sequences',{'val':JSON['stringify'](_0x5a1f72),'ack':!![]}),runSecurityCheck(_0x21e54c,_0x9c4e7d);}catch(_0x172130){_0x21e54c[_0x4399d2(0x118)][_0x4399d2(0x140)](_0x4399d2(0x110)+_0x172130[_0x4399d2(0x282)]);}}function runSecurityCheck(_0x59ac0c,_0x383641){const _0x5c72f4=a0_0x2efbe2;if(!_0x59ac0c[_0x5c72f4(0x2be)])return;_0x59ac0c[_0x5c72f4(0x118)][_0x5c72f4(0x2b7)]('ðŸ›¡ï¸\x20SECURITY:\x20Sending\x20sequence\x20to\x20Guard\x20for\x20analysis...'),sendToPython(_0x59ac0c,_0x5c72f4(0x169),{'sequence':_0x383641});}async function processSensorEvent(_0x150db3,_0x52bbec,_0x316294,_0x2c5b78){const _0x232426=a0_0x2efbe2;if(!_0x2c5b78)return;const _0x18031f=_0x316294[_0x232426(0x18a)],_0x2bfd26=Date[_0x232426(0x1ba)](),_0x7e4afd=_0x150db3[_0x232426(0x247)][_0x52bbec];_0x150db3['sensorLastValues'][_0x52bbec]=_0x18031f;if(!_0x2c5b78[_0x232426(0x1d9)]&&_0x7e4afd!=undefined&&_0x7e4afd==_0x18031f)return;const _0x29bb88=(_0x2c5b78['type']||'')[_0x232426(0x1ea)](),_0x5dd5da=_0x29bb88[_0x232426(0x210)](_0x232426(0x1ca))||_0x29bb88['includes'](_0x232426(0x25f))||_0x29bb88[_0x232426(0x210)]('klima')||_0x29bb88['includes'](_0x232426(0x1f0));_0x150db3[_0x232426(0x2be)]&&_0x5dd5da&&recordThermodynamics(_0x150db3,_0x52bbec,_0x18031f,_0x2c5b78['location']);const _0x13759d={'timestamp':_0x2bfd26,'id':_0x52bbec,'name':_0x2c5b78[_0x232426(0x1d8)],'type':_0x2c5b78[_0x232426(0x176)],'location':_0x2c5b78['location'],'value':_0x18031f};_0x150db3[_0x232426(0x215)]['unshift'](_0x13759d);if(_0x150db3[_0x232426(0x215)][_0x232426(0x2b9)]>HISTORY_MAX_SIZE)_0x150db3[_0x232426(0x215)][_0x232426(0x121)]();await _0x150db3[_0x232426(0x233)](_0x232426(0x2b4),{'val':JSON['stringify'](_0x13759d),'ack':!![]}),await _0x150db3[_0x232426(0x233)](_0x232426(0x1eb),{'val':JSON['stringify'](_0x150db3['eventHistory']),'ack':!![]});_0x150db3[_0x232426(0x2be)]&&(_0x150db3[_0x232426(0x28f)][_0x232426(0x15b)](_0x13759d),await saveRawEventLog(_0x150db3),recordSequence(_0x150db3,_0x13759d));if(_0x2c5b78[_0x232426(0x113)]&&_0x18031f===!![]){if(_0x150db3[_0x232426(0x23e)]&&!_0x150db3[_0x232426(0x209)])startExitTimer(_0x150db3);else{if(!_0x150db3[_0x232426(0x23e)])setPresence(_0x150db3,!![]);}}else{if(_0x2c5b78[_0x232426(0x176)]===_0x232426(0x22b)&&_0x18031f===!![]){if(_0x150db3[_0x232426(0x2af)])abortExitTimer(_0x150db3);if(!_0x150db3[_0x232426(0x23e)]&&_0x150db3[_0x232426(0x155)]===SYSTEM_MODES[_0x232426(0x153)])setPresence(_0x150db3,!![]);}}}function installPythonDependencies(_0x3f11ea){const _0x1701e1=a0_0x2efbe2;if(_0x3f11ea[_0x1701e1(0x26c)]||panicMode)return;_0x3f11ea[_0x1701e1(0x26c)]=!![];const _0x2351dd=path[_0x1701e1(0x2b8)](__dirname,'python_service','requirements.txt');_0x3f11ea[_0x1701e1(0x118)][_0x1701e1(0x205)](_0x1701e1(0x286)),stopPythonService(_0x3f11ea);if(fs[_0x1701e1(0x18d)](VENV_PATH))try{fs[_0x1701e1(0x274)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x2629b1){}exec(_0x1701e1(0x1e0)+VENV_PATH+'\x22',_0x45c063=>{const _0x20dcfe=_0x1701e1;if(_0x45c063){_0x3f11ea[_0x20dcfe(0x118)][_0x20dcfe(0x140)](_0x20dcfe(0x1fe)),_0x3f11ea[_0x20dcfe(0x26c)]=![],panicMode=!![];return;}installRequirementsInVenv(_0x3f11ea,_0x2351dd);});}function installRequirementsInVenv(_0x118870,_0x59bfd8){const _0x16137b=a0_0x2efbe2;_0x118870[_0x16137b(0x118)][_0x16137b(0x205)](_0x16137b(0x23a));const _0x464deb='\x22'+PIP_EXE+_0x16137b(0x160)+_0x59bfd8+'\x22';exec(_0x464deb,{'timeout':0x124f80},(_0x242614,_0x38cc50,_0x2df107)=>{const _0x3afae4=_0x16137b;_0x118870['dependencyInstallInProgress']=![],_0x242614?(_0x118870[_0x3afae4(0x118)][_0x3afae4(0x140)](_0x3afae4(0x293)+(_0x2df107||_0x242614['message'])),panicMode=!![]):(_0x118870[_0x3afae4(0x118)][_0x3afae4(0x205)](_0x3afae4(0x1b9)),exec('\x22'+PYTHON_EXE+_0x3afae4(0x1a5),(_0x11a1ff,_0x3da55d)=>{const _0xeb78fe=_0x3afae4;_0x3da55d&&_0x3da55d[_0xeb78fe(0x210)]('OK')?(_0x118870[_0xeb78fe(0x118)][_0xeb78fe(0x205)](_0xeb78fe(0x182)),startPythonService(_0x118870)):(_0x118870['log'][_0xeb78fe(0x140)](_0xeb78fe(0x1cf)),panicMode=!![]);}));});}function startPythonService(_0x392fe9){const _0xf29cd7=a0_0x2efbe2;if(_0x392fe9[_0xf29cd7(0x26c)]||panicMode)return;let _0x22fb9a=_0xf29cd7(0x252);if(fs[_0xf29cd7(0x18d)](PYTHON_EXE))_0x392fe9[_0xf29cd7(0x118)]['info'](_0xf29cd7(0x11b)+PYTHON_EXE),_0x22fb9a=PYTHON_EXE;else{_0x392fe9[_0xf29cd7(0x118)][_0xf29cd7(0x20e)](_0xf29cd7(0x206)),installPythonDependencies(_0x392fe9);return;}try{const _0x430f39=path[_0xf29cd7(0x2b8)](__dirname,_0xf29cd7(0x143),_0xf29cd7(0x2c6));_0x392fe9['pythonProcess']=spawn(_0x22fb9a,[_0x430f39]),_0x392fe9[_0xf29cd7(0x146)][_0xf29cd7(0x259)]['on'](_0xf29cd7(0x1b4),_0x364f66=>{const _0x499911=_0xf29cd7,_0x1b9714=_0x364f66[_0x499911(0x22d)]()['split']('\x0a');_0x1b9714[_0x499911(0x28d)](_0x36e0e3=>{const _0x440cb5=_0x499911,_0x199b25=_0x36e0e3[_0x440cb5(0x21e)]();if(!_0x199b25)return;if(_0x199b25[_0x440cb5(0x199)](_0x440cb5(0x1de)))_0x392fe9[_0x440cb5(0x118)]['debug'](_0x440cb5(0x219)+_0x199b25['substring'](0x5)['trim']());else{if(_0x199b25[_0x440cb5(0x199)](_0x440cb5(0x203)))try{const _0xe6f9ca=JSON[_0x440cb5(0x2ad)](_0x199b25['substring'](0x8)[_0x440cb5(0x21e)]());handlePythonResult(_0x392fe9,_0xe6f9ca);}catch(_0x8790e6){_0x392fe9[_0x440cb5(0x118)]['warn'](_0x440cb5(0x1d2)+_0x199b25);}}_0x199b25['includes'](_0x440cb5(0x1b7))&&(_0x392fe9[_0x440cb5(0x118)][_0x440cb5(0x140)]('âš ï¸\x20Module\x20missing.\x20Panic\x20Stop.'),panicMode=!![],stopPythonService(_0x392fe9));});}),_0x392fe9['pythonProcess'][_0xf29cd7(0x15c)]['on'](_0xf29cd7(0x1b4),_0x5dcd7c=>{const _0x35aa3e=_0xf29cd7,_0x17f60a=_0x5dcd7c[_0x35aa3e(0x22d)]()[_0x35aa3e(0x21e)]();if(!_0x17f60a['includes'](_0x35aa3e(0x28a)))_0x392fe9[_0x35aa3e(0x118)][_0x35aa3e(0x140)](_0x35aa3e(0x266)+_0x17f60a);}),_0x392fe9[_0xf29cd7(0x146)]['on'](_0xf29cd7(0x2b3),_0x344f4b=>{const _0x45ea25=_0xf29cd7;_0x392fe9[_0x45ea25(0x118)]['info']('[PYTHON]\x20Exited\x20'+_0x344f4b),_0x392fe9[_0x45ea25(0x146)]=null;});}catch(_0x1f5020){_0x392fe9[_0xf29cd7(0x118)][_0xf29cd7(0x140)](_0xf29cd7(0x269)+_0x1f5020['message']);}}function stopPythonService(_0x58b831){const _0x184caf=a0_0x2efbe2;if(_0x58b831[_0x184caf(0x146)]){_0x58b831['log'][_0x184caf(0x205)](_0x184caf(0x13b));try{_0x58b831[_0x184caf(0x146)]['kill']();}catch(_0x538319){}_0x58b831['pythonProcess']=null;}}function handlePythonResult(_0x270312,_0x18659b){const _0x321780=a0_0x2efbe2;if(_0x18659b[_0x321780(0x176)]===_0x321780(0x2c5))_0x270312['log'][_0x321780(0x2b7)]('ðŸ\x20Python\x20Pong');else{if(_0x18659b[_0x321780(0x176)]===_0x321780(0x2ae)){const {anomaly_score:_0x4463b9,is_anomaly:_0xa4a217,threshold:_0x103596}=_0x18659b[_0x321780(0x22f)];_0x270312[_0x321780(0x118)][_0x321780(0x205)](_0x321780(0x111)+_0x4463b9[_0x321780(0x2a8)](0x5)+_0x321780(0x2b6)+(_0xa4a217?_0x321780(0x22a):'OK')),_0x270312['setStateAsync'](_0x321780(0x1a7),{'val':_0x4463b9,'ack':!![]}),_0x270312[_0x321780(0x233)](_0x321780(0x232),{'val':new Date()[_0x321780(0x1c8)](),'ack':!![]});if(_0xa4a217){const _0x603cd4=_0x321780(0x141)+_0x4463b9[_0x321780(0x2a8)](0x4)+')';_0x270312[_0x321780(0x233)](_0x321780(0x2a0),{'val':!![],'ack':!![]}),_0x270312[_0x321780(0x233)](_0x321780(0x138),{'val':_0x603cd4,'ack':!![]}),sendNotification(_0x270312,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x603cd4,![],!![]);}}else{if(_0x18659b['type']===_0x321780(0x14e)){const {success:_0x584103,details:_0x4a2880}=_0x18659b[_0x321780(0x22f)];_0x270312['setStateAsync'](_0x321780(0x156),{'val':_0x584103?_0x321780(0x1c7)+new Date()['toLocaleTimeString']()+'\x20('+_0x4a2880+')':_0x321780(0x16b)+_0x4a2880,'ack':!![]});}else{if(_0x18659b[_0x321780(0x176)]===_0x321780(0x271)){const {success:_0x3bc71b,details:_0x446ad4}=_0x18659b['payload'];if(_0x3bc71b)try{const _0x4d99f8=JSON[_0x321780(0x2ad)](_0x446ad4);if(_0x4d99f8[_0x321780(0x194)])_0x270312[_0x321780(0x233)](_0x321780(0x227),{'val':JSON[_0x321780(0x163)](_0x4d99f8['insulation']),'ack':!![]});if(_0x4d99f8[_0x321780(0x19e)])_0x270312[_0x321780(0x233)](_0x321780(0x195),{'val':JSON[_0x321780(0x163)](_0x4d99f8[_0x321780(0x19e)]),'ack':!![]});}catch(_0x388752){}}else{if(_0x18659b[_0x321780(0x176)]===_0x321780(0x131)){const {success:_0x1a78a7,details:_0x43f12b}=_0x18659b[_0x321780(0x22f)];if(_0x1a78a7)_0x270312[_0x321780(0x118)][_0x321780(0x205)](_0x321780(0x272)+_0x43f12b);}else{if(_0x18659b[_0x321780(0x176)]==='HEALTH_RESULT'){const {is_anomaly:_0x5d6e01,details:_0x3c011a}=_0x18659b[_0x321780(0x22f)];_0x270312[_0x321780(0x233)](_0x321780(0x1ad),{'val':new Date()['toISOString'](),'ack':!![]}),_0x270312['setStateAsync']('analysis.health.isAnomaly',{'val':_0x5d6e01,'ack':!![]});}else{if(_0x18659b[_0x321780(0x176)]==='TREND_RESULT'){const {diagnosis:_0x3639f8,change_percent:_0x3b7061}=_0x18659b[_0x321780(0x22f)];_0x270312['log'][_0x321780(0x205)](_0x321780(0x260)+_0x3639f8+'\x20('+_0x3b7061+'%)'),_0x270312['setStateAsync'](_0x321780(0x142),{'val':_0x3639f8,'ack':!![]}),_0x270312['setStateAsync'](_0x321780(0x2a4),{'val':_0x3b7061,'ack':!![]});}}}}}}}}function sendToPython(_0x4bc960,_0x2a97e7,_0x5991b8={}){const _0x56d51e=a0_0x2efbe2;if(!_0x4bc960[_0x56d51e(0x146)]||!_0x4bc960[_0x56d51e(0x146)][_0x56d51e(0x13d)]['writable'])return;const _0x811210=JSON['stringify']({'command':_0x2a97e7,..._0x5991b8});try{_0x4bc960[_0x56d51e(0x146)][_0x56d51e(0x13d)][_0x56d51e(0x297)](_0x811210+'\x0a');}catch(_0x5ab464){}}function a0_0x8434(){const _0x1c4bb9=['\x20*\x20*\x20*','notifyPushoverEnabled','text.alarm','getCalendarNames','name','logDuplicates','AI\x20Training','1666140JcSCrA','getStateAsync','Skipped\x20(No\x20AI\x20or\x20Data)','[LOG]','aiPersona','python3\x20-m\x20venv\x20\x22','position','json','Training\x20Error:\x20','Train\x20Energy','Training\x20Status','onUnload','echarts.','child_process','info.','toLowerCase','events.history','generic','getTime','command','boolean','heizung','COGNI_REQUEST_CALL','from','0\x203\x20*\x20*\x20*','weather','Analysiere\x20ausgewogen.','longitude','analysis.training.triggerSecurity','simulateButler','Alert\x20Status','link_quality','notifyEmailInstance','endsWith','submitFeedback','âŒ\x20VENV\x20CREATION\x20FAILED.\x20Please\x20run:\x20sudo\x20apt\x20install\x20python3-venv','driftAnalysisTimer','analysis.security','briefingTime','.\x20KONTEXT:\x20','[RESULT]','ltmStbWindowDays','info','âš ï¸\x20VENV\x20missing.\x20Triggering\x20install...','analysis.automation.description','testApiKey','isGracePeriodActive','contact','send','Health\x20Analysis','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','warn','exports','includes','update','generateContent','number','LTM.driftAnalysis.baselineDrift','eventHistory','weatherInstance','minDaysForBaseline','BUTLER\x20Execution\x20Error:\x20','[PYTHON]\x20','Unknown','object','isAlert','button','trim','getObjectAsync','VACATION','setObjectNotExistsAsync','Fokus\x20auf\x20Familienroutinen.','targetId','connection','loc','Missing\x20data','analysis.energy.insulationScore','unshift','occupancy','ANOMALY','motion','calendarInstance','toString','PARTY','payload','getForeignObjectAsync','detected','analysis.security.lastCheck','setStateAsync','Trend\x20Value','selectedFunctionIds','.\x20ANWESEND:\x20','exitGraceTimer','automationProposal','actual_temperature','Installing\x20pip\x20packages\x20(this\x20takes\x20time)...','light','currentposition','analysis.triggerBriefing','isPresent','enum','notifyPushoverRecipient','getForeignStateAsync','Kalender:\x20Deaktiviert','Reset\x20Sched\x20Error:\x20','analysis.automation.autoApply','kontakt','path','sensorLastValues','map','unreach','extendObjectAsync','weatherunderground','subscribeStates','analysis.automation.targetId','system.isPresent','.venv','search','inactivityThresholdHours','python3','history.','cogni-living','Gemini\x20AI\x20initialized.','Trigger\x20Action','geminiApiKey','models/gemini-flash-latest','stdout','system.config','.forecast.current.temperature','Digest','getHours','rssi','temperatur','ðŸ\x20Guardian\x20Diagnosis:\x20','notifyEmailEnabled','Kein\x20API\x20Key!','fill','testContext','LTM','[PYTHON\x20ERR]\x20','vis.','Scripts','Error\x20launching\x20Python:\x20','python','splice','dependencyInstallInProgress','inactivityMonitoringEnabled','siren','location','genAI','ENERGY_TRAIN_RESULT','âœ…\x20HEALTH\x20TRAINED:\x20','briefingEnabled','rmSync','.data.table','analysisTimer','string','dutycycle','briefingJob','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','split','response','modeResetJob','members','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','filter','648204MHzmmE','message','notifyPushoverInstance','Who\x20is\x20present?','latitude','ðŸ› ï¸\x20MAINTENANCE\x20MODE:\x20Clean\x20installing\x20Python\x20environment...','onReady','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','delObjectAsync','cpu_feature_guard','PRIORITÃ„T:\x20Gesundheit/AAL.','autoApply','forEach','guest','rawEventLog','2789ZdLGMs','getFullYear','Thermodynamics','âŒ\x20INSTALL\x20FAILED:\x20','version','Target\x20Value','KI-Modell\x20nicht\x20initialisiert','write','sendToAsync','LTM.trainingData.thermodynamics','1538488MCfPOt','Deaktiviert\x20(Pro-Feature)','onMessage','Sequences','ready','Raw\x20Log','analysis.isAlert','analysis.automation.patternDetected','Pattern\x20Detected','_calName','analysis.health.trendValue','cogni-living\x20adapter\x20starting\x20(v','Anomaly\x20Detected','analysisInterval','toFixed','TRAIN_HEALTH','stick_unreach','shift','prÃ¤senz','parse','SECURITY_RESULT','exitTimer','lights','getGenerativeModel','callback','close','events.lastEvent','summary','\x20->\x20','debug','join','length','Gemini\x20Init\x20Error:\x20','system.','getForeignObjectsAsync','devices','isProVersion','state','material.','presenceDevices','Target\x20ID','TRAIN_ENERGY','analysis.training.triggerHealth','PONG','service.py','Keine\x20Details.','off','level','@google/generative-ai','analysis.lastResult','status','N/A','valve','ltmLtbWindowDays','city','apiKey','\x20Tage)','notifyTelegramInstance','system','Trend','scheduleJob','isEmergency','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','Train\x20Security','party','indexOf','[RECORDER]\x20Error\x20saving\x20sequence:\x20','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','main','isExit','automation.triggerAction','doors','python.exe','Scanning\x20for\x20devices...','log','OK:\x20','targetValue','ðŸ\x20Using\x20VENV:\x20','lastAlertState','direction','humidity','schalter','bewegung','pop','Briefing\x20Sched\x20Error:\x20','cancel','vacation','LTM\x20Sched\x20Error:\x20','ack','channel',')\x20-\x20STRICT\x20FIX','normal','daswetter','LTM.driftAnalysis','sendTo','analysisHistory','icons-mfd.','2568490ciLxqi','unknown','HEALTH_TRAIN_RESULT','stateChange','application/json','HARD\x20WATCHDOG:\x20No\x20activity\x20for\x20','Trigger\x20Analysis','analysis.activitySummary','dailyDigests','analysis.alertReason','fenster','@iobroker/adapter-core','ðŸ\x20Stopping\x20Python...','activityLevel','stdin','description','08:00','error','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','analysis.health.trendDiagnosis','python_service','value','switch','pythonProcess','power','config','15UAKhsI','Sec-Training\x20started...','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','(((.+)+)+)+$','Kein\x20API\x20Key.','TRAINING_COMPLETE','Energy\x20Intelligence','isArray','Aktiv\x20(','config_pending','NORMAL','Cogni-Living','currentSystemMode','analysis.training.status','analysis.training.triggerEnergy','PRIORITÃ„T:\x20Sicherheit.','dismissAutomation','bind','push','stderr','subscribeForeignStatesAsync','185116sQhIEa','analysis.analysisHistory','\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22','âš ï¸\x20ALARM:\x20','Daily\x20Digests','stringify','openweathermap','analysis.health','useWeather','systemUUID','values','ANALYZE_SEQUENCE','ðŸ§ \x20Triggering\x20Security\x20Training...','Failed:\x20','lowbat','Keine\x20Termine','Heating\x20Score','window','livingContext','LTM.trainingData.sequences','âœ…\x20Alles\x20OK\x20(Reset)]','constructor','Last\x20raw\x20event','LTM.dailyDigests','type','pip','ical.0','Feedback:\x20','date','admin.','notifyTelegramEnabled','retry','system.mode','apply','bin','getOverviewData','âœ…\x20VERIFIED.\x20Starting\x20Service.','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','36lTtvZF','presence','\x20(Length:\x20','ltmJob','getDate','Last\x20Check','val','lampe','sound','existsSync','Train\x20Health','.\x20WETTER:\x20','getEnums','some','targetposition','role','insulation','analysis.energy.heatingScore','Event\x20History','timestamp','LTM.baselineStatus','startsWith','instance','LTM.driftAnalysis.driftDetails','enum.functions.*','indicator','heating','GUEST','onStateChange','COGNI_CONFIRM_OK','Lernphase\x20(','platform','Success','\x22\x20-c\x20\x22import\x20tensorflow;\x20print(\x27OK\x27)\x22','analysis.health.isAnomaly','analysis.security.lastScore','Started...','Activity-Level','firmware','Trigger\x20Briefing','simple-api.','analysis.health.lastCheck','notifyEmailRecipient','tÃ¼r','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','analysis.automation.targetValue','2092188tHfEWi','Drift\x20Sched\x20Error:\x20','data','0\x204\x20*\x20*\x20*','pip.exe','No\x20module\x20named','ANALYZE_HEALTH','âœ…\x20INSTALL\x20SUCCESS.\x20Verifying...','now','86HkYFSE','outdoorSensorId','\x20=\x20','dimmer','door','slice','alertReason','analysis.trigger','geminiModel','system.presenceWho','communicate.request','KALENDER:\x20','Success:\x20','toISOString','Alarm','temperature','text','common','events.history_debug_00','systemConfig','âŒ\x20VERIFICATION\x20FAILED.\x20Panic\x20Mode.','setState','energy','Invalid\x20JSON:\x20','\x20events)...'];a0_0x8434=function(){return _0x1c4bb9;};return a0_0x8434();}function setupLtmScheduler(_0x5b8501){const _0x2b4f03=a0_0x2efbe2;try{if(_0x5b8501[_0x2b4f03(0x187)])_0x5b8501[_0x2b4f03(0x187)][_0x2b4f03(0x123)]();if(!_0x5b8501[_0x2b4f03(0x2be)])return;_0x5b8501['ltmJob']=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x5b8501));}catch(_0x3d75fe){_0x5b8501['log'][_0x2b4f03(0x140)](_0x2b4f03(0x125)+_0x3d75fe[_0x2b4f03(0x282)]);}}function setupModeResetScheduler(_0x1570f0){const _0x43cb38=a0_0x2efbe2;try{if(_0x1570f0['modeResetJob'])_0x1570f0[_0x43cb38(0x27d)]['cancel']();_0x1570f0[_0x43cb38(0x27d)]=schedule[_0x43cb38(0x2d6)](MODE_RESET_SCHEDULE,async()=>{const _0x21a381=_0x43cb38;await loadSystemMode(_0x1570f0),AUTO_RESET_MODES[_0x21a381(0x210)](_0x1570f0['currentSystemMode'])&&await _0x1570f0[_0x21a381(0x233)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x65c07b){_0x1570f0[_0x43cb38(0x118)]['error'](_0x43cb38(0x243)+_0x65c07b[_0x43cb38(0x282)]);}}function setupDriftAnalysisScheduler(_0x465240){const _0x4f3ea2=a0_0x2efbe2;try{if(_0x465240[_0x4f3ea2(0x1ff)])clearInterval(_0x465240[_0x4f3ea2(0x1ff)]);if(!_0x465240[_0x4f3ea2(0x2be)])return;_0x465240[_0x4f3ea2(0x1ff)]=setInterval(()=>runBaselineDriftAnalysis(_0x465240),(_0x465240[_0x4f3ea2(0x148)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x465240),0x1388);}catch(_0x96ca93){_0x465240[_0x4f3ea2(0x118)][_0x4f3ea2(0x140)](_0x4f3ea2(0x1b3)+_0x96ca93[_0x4f3ea2(0x282)]);}}function setupBriefingScheduler(_0x70b825){const _0x4350a0=a0_0x2efbe2;try{if(_0x70b825[_0x4350a0(0x279)])_0x70b825[_0x4350a0(0x279)][_0x4350a0(0x123)]();if(!_0x70b825[_0x4350a0(0x148)][_0x4350a0(0x273)])return;const _0xe84cf3=(_0x70b825[_0x4350a0(0x148)][_0x4350a0(0x201)]||_0x4350a0(0x13f))['split'](':'),_0xf22d3a=parseInt(_0xe84cf3[0x0])||0x8,_0x820a5b=parseInt(_0xe84cf3[0x1])||0x0,_0x449cff=_0x820a5b+'\x20'+_0xf22d3a+_0x4350a0(0x1d4);_0x70b825[_0x4350a0(0x279)]=schedule[_0x4350a0(0x2d6)](_0x449cff,()=>{sendMorningBriefing(_0x70b825);});}catch(_0x1c8ce7){_0x70b825['log'][_0x4350a0(0x140)](_0x4350a0(0x122)+_0x1c8ce7[_0x4350a0(0x282)]);}}async function runGeminiAnalysis(_0xd73fee,_0x109a00=''){const _0x26dcce=a0_0x2efbe2;if(!_0xd73fee['geminiModel'])return;if(_0xd73fee[_0x26dcce(0x215)][_0x26dcce(0x2b9)]===0x0)return;const _0x39fdaf=_0xd73fee[_0x26dcce(0x215)][_0x26dcce(0x1c0)](0x0,0xf),_0x14abf9=await getWeatherContext(_0xd73fee),_0x16ad5e=_0xd73fee[_0x26dcce(0x155)],_0x499c0c=PERSONA_MAPPING[_0xd73fee['config'][_0x26dcce(0x1df)]||_0x26dcce(0x1ec)],_0x2b4bfa=_0xd73fee[_0x26dcce(0x148)][_0x26dcce(0x170)]||_0x26dcce(0x2c7);let _0x5ea63b='Unbekannt';try{const _0x3c6386=await _0xd73fee[_0x26dcce(0x1dc)]('system.presenceWho');if(_0x3c6386&&_0x3c6386['val'])_0x5ea63b=_0x3c6386[_0x26dcce(0x18a)];}catch(_0x5c7674){}let _0x10ae11=![];try{const _0x3e01f4=await _0xd73fee[_0x26dcce(0x1dc)]('analysis.automation.autoApply');if(_0x3e01f4&&_0x3e01f4[_0x26dcce(0x18a)])_0x10ae11=!![];}catch(_0x5e269a){}const _0x29ab31='ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20'+_0x499c0c+_0x26dcce(0x202)+_0x2b4bfa+'.\x20SYSTEM_MODE:\x20'+_0x16ad5e+_0x26dcce(0x18f)+_0x14abf9+_0x26dcce(0x236)+_0x5ea63b+'.\x20EVENTS:\x20'+JSON[_0x26dcce(0x163)](_0x39fdaf)+'.\x20EMERGENCY:\x20'+_0x109a00+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{const _0xc0488d=await _0xd73fee[_0x26dcce(0x1c3)][_0x26dcce(0x212)](_0x29ab31),_0x34fc9d=_0xc0488d[_0x26dcce(0x27c)][_0x26dcce(0x1cb)]()['replace'](/```json|```/g,'')['trim'](),_0xe34120=JSON[_0x26dcce(0x2ad)](_0x34fc9d);await _0xd73fee[_0x26dcce(0x233)](_0x26dcce(0x2cb),{'val':JSON[_0x26dcce(0x163)](_0xe34120),'ack':!![]});if(_0xe34120[_0x26dcce(0x2b5)])await _0xd73fee['setStateAsync']('analysis.activitySummary',{'val':_0xe34120['summary'],'ack':!![]});const _0x215cee={'timestamp':Date['now'](),'id':Date['now']()[_0x26dcce(0x22d)](),'analysis':{'activity':{'summary':_0xe34120[_0x26dcce(0x2b5)],'isAlert':_0xe34120['isAlert'],'alertReason':_0xe34120[_0x26dcce(0x1c1)]},'comfort':{'automationProposal':_0xe34120[_0x26dcce(0x238)]}}};await updateAnalysisHistory(_0xd73fee,_0x215cee);const _0x1244ec=_0xe34120[_0x26dcce(0x21c)]||![];_0x1244ec!==_0xd73fee['lastAlertState']&&(await _0xd73fee[_0x26dcce(0x233)](_0x26dcce(0x2a0),{'val':_0x1244ec,'ack':!![]}),_0xd73fee[_0x26dcce(0x11c)]=_0x1244ec,_0x1244ec&&(await _0xd73fee[_0x26dcce(0x233)](_0x26dcce(0x138),{'val':_0xe34120['alertReason'],'ack':!![]}),sendNotification(_0xd73fee,_0x26dcce(0x161)+_0xe34120['alertReason'],![],_0xe34120[_0x26dcce(0x10b)])));if(_0xe34120[_0x26dcce(0x238)]&&_0xe34120[_0x26dcce(0x238)]['detected']){await _0xd73fee[_0x26dcce(0x233)](_0x26dcce(0x2a1),{'val':!![],'ack':!![]}),await _0xd73fee[_0x26dcce(0x233)]('analysis.automation.description',{'val':_0xe34120['automationProposal']['description'],'ack':!![]}),await _0xd73fee[_0x26dcce(0x233)](_0x26dcce(0x24d),{'val':_0xe34120['automationProposal']['targetId'],'ack':!![]}),await _0xd73fee['setStateAsync']('analysis.automation.targetValue',{'val':JSON['stringify'](_0xe34120['automationProposal']['targetValue']),'ack':!![]});if(_0x10ae11)executeAutomationAction(_0xd73fee);}}catch(_0x39936b){_0xd73fee[_0x26dcce(0x118)][_0x26dcce(0x140)]('Gemini\x20Error:\x20'+_0x39936b['message']);}}async function createDailyDigest(_0x5ed098){const _0x406535=a0_0x2efbe2;if(!_0x5ed098[_0x406535(0x2be)])return;await _0x5ed098['setStateAsync'](LTM_DP_STATUS,{'val':_0x406535(0x1a8),'ack':!![]});if(!_0x5ed098['geminiModel']||_0x5ed098['rawEventLog'][_0x406535(0x2b9)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x5ed098['setStateAsync'](LTM_DP_STATUS,{'val':_0x406535(0x1dd),'ack':!![]});return;}const _0x222e19=JSON[_0x406535(0x2ad)](JSON[_0x406535(0x163)](_0x5ed098[_0x406535(0x28f)])),_0x3ef3a4=_0x222e19[_0x406535(0x2b9)],_0x4c2b66=_0x406535(0x27a)+JSON[_0x406535(0x163)](_0x222e19);try{const _0x4ad93e=await _0x5ed098[_0x406535(0x1c3)][_0x406535(0x212)](_0x4c2b66),_0xacd062=JSON[_0x406535(0x2ad)](_0x4ad93e[_0x406535(0x27c)][_0x406535(0x1cb)]()['replace'](/```json|```/g,'')[_0x406535(0x21e)]()),_0xdae35={'timestamp':new Date()[_0x406535(0x1c8)](),'eventCount':_0x3ef3a4,'summary':_0xacd062['summary']||_0x406535(0x25c),'activityLevel':_0xacd062[_0x406535(0x13c)]||_0x406535(0x129),'systemMode':_0x5ed098[_0x406535(0x155)]};_0x5ed098[_0x406535(0x137)]['push'](_0xdae35),await saveDailyDigests(_0x5ed098),_0x5ed098[_0x406535(0x28f)]=[],await saveRawEventLog(_0x5ed098),await _0x5ed098[_0x406535(0x233)](LTM_DP_STATUS,{'val':_0x406535(0x1a4),'ack':!![]});if(_0x5ed098[_0x406535(0x2be)])sendToPython(_0x5ed098,_0x406535(0x1b8),{'digest':_0xdae35});}catch(_0x304558){_0x5ed098['log'][_0x406535(0x140)](_0x304558[_0x406535(0x282)]);}}async function runPythonHealthCheck(_0x560eb2){const _0x5b3571=a0_0x2efbe2;if(!_0x560eb2[_0x5b3571(0x137)]||_0x560eb2['dailyDigests']['length']<0x2)return;const _0x5da232=_0x560eb2[_0x5b3571(0x137)][_0x5b3571(0x248)](_0x2d5455=>{const _0x12bc03=_0x5b3571,_0xf868c9=(_0x2d5455[_0x12bc03(0x13c)]||'')[_0x12bc03(0x1ea)]();return ACTIVITY_LEVEL_MAP[_0xf868c9]||0x32;});sendToPython(_0x560eb2,'ANALYZE_TREND',{'values':_0x5da232,'tag':_0x5b3571(0x1a9)});}async function scanForDevices(_0x4b825a,_0xf28b3d){const _0x56feb3=a0_0x2efbe2;_0x4b825a['log'][_0x56feb3(0x205)](_0x56feb3(0x117));const _0x580f20=[],_0x13f839=await _0x4b825a[_0x56feb3(0x2bc)]('*'),_0x4bbda9=await _0x4b825a[_0x56feb3(0x2bc)](_0x56feb3(0x19c),_0x56feb3(0x23f)),_0x407352=await _0x4b825a[_0x56feb3(0x2bc)]('enum.rooms.*',_0x56feb3(0x23f)),_0xa202ed={};if(_0x4bbda9)for(const _0xb71704 in _0x4bbda9){const _0x3c873f=_0x4bbda9[_0xb71704][_0x56feb3(0x1cc)][_0x56feb3(0x27e)]||[];_0x3c873f[_0x56feb3(0x28d)](_0x18905a=>{const _0x315a15=_0x56feb3;if(!_0xa202ed[_0x18905a])_0xa202ed[_0x18905a]=[];_0xa202ed[_0x18905a][_0x315a15(0x15b)](_0xb71704);});}const _0xc73012={};if(_0x407352)for(const _0x27f372 in _0x407352){const _0x364d5e=_0x407352[_0x27f372][_0x56feb3(0x1cc)][_0x56feb3(0x27e)]||[],_0x10c07d=typeof _0x407352[_0x27f372][_0x56feb3(0x1cc)][_0x56feb3(0x1d8)]===_0x56feb3(0x21b)?_0x407352[_0x27f372]['common'][_0x56feb3(0x1d8)]['de']:_0x407352[_0x27f372][_0x56feb3(0x1cc)][_0x56feb3(0x1d8)];_0x364d5e['forEach'](_0x2d5c31=>_0xc73012[_0x2d5c31]=_0x10c07d);}const _0x294322=_0xf28b3d[_0x56feb3(0x22b)]!==![],_0x51dbe9=_0xf28b3d[_0x56feb3(0x115)]!==![],_0x128a56=_0xf28b3d[_0x56feb3(0x2b0)]!==![],_0x277cb9=_0xf28b3d[_0x56feb3(0x1ca)]===!![],_0x5342f1=_0xf28b3d[_0x56feb3(0x1f4)]===!![];for(const _0x3c51b7 in _0x13f839){const _0x4bb2f8=_0x13f839[_0x3c51b7];if(_0x4bb2f8['type']!=='state'||!_0x4bb2f8[_0x56feb3(0x1cc)])continue;if(ADAPTER_BLACKLIST[_0x56feb3(0x191)](_0x3a504f=>_0x3c51b7[_0x56feb3(0x199)](_0x3a504f))&&!_0x5342f1)continue;const _0x4dc14d=(_0x4bb2f8[_0x56feb3(0x1cc)][_0x56feb3(0x193)]||'')[_0x56feb3(0x1ea)]();let _0x40c1f8=(typeof _0x4bb2f8[_0x56feb3(0x1cc)]['name']===_0x56feb3(0x21b)?_0x4bb2f8[_0x56feb3(0x1cc)][_0x56feb3(0x1d8)]['de']:_0x4bb2f8[_0x56feb3(0x1cc)][_0x56feb3(0x1d8)])||_0x3c51b7;const _0x100b48=_0x40c1f8[_0x56feb3(0x1ea)]();let _0x5ea15e=![];if(_0xf28b3d['selectedFunctionIds']&&_0xf28b3d[_0x56feb3(0x235)][_0x56feb3(0x2b9)]>0x0){const _0x53f2da=_0xa202ed[_0x3c51b7]||[],_0x54f839=_0x3c51b7[_0x56feb3(0x27b)]('.')[_0x56feb3(0x1c0)](0x0,-0x1)[_0x56feb3(0x2b8)]('.'),_0x1c14e8=_0xa202ed[_0x54f839]||[];(_0x53f2da[_0x56feb3(0x191)](_0xe99058=>_0xf28b3d[_0x56feb3(0x235)][_0x56feb3(0x210)](_0xe99058))||_0x1c14e8['some'](_0x495330=>_0xf28b3d[_0x56feb3(0x235)][_0x56feb3(0x210)](_0x495330)))&&(_0x5ea15e=!![]);}if(_0x5342f1&&_0x3c51b7[_0x56feb3(0x210)](_0x56feb3(0x1ca)))_0x5ea15e=!![];if(!_0x5ea15e&&!_0x5342f1){if(HARD_IGNORE_TERMS[_0x56feb3(0x191)](_0x548787=>_0x3c51b7[_0x56feb3(0x210)](_0x548787)||_0x100b48['includes'](_0x548787[_0x56feb3(0x1ea)]())))continue;}let _0x1deada='';if(_0x294322&&(_0x4dc14d[_0x56feb3(0x210)](_0x56feb3(0x22b))||_0x4dc14d[_0x56feb3(0x210)](_0x56feb3(0x229))))_0x1deada=_0x56feb3(0x22b);else{if(_0x51dbe9&&(_0x4dc14d[_0x56feb3(0x210)](_0x56feb3(0x1bf))||_0x4dc14d[_0x56feb3(0x210)]('window')))_0x1deada=_0x56feb3(0x1bf);else{if(_0x128a56&&(_0x4dc14d['includes'](_0x56feb3(0x23b))||_0x4dc14d[_0x56feb3(0x210)](_0x56feb3(0x145))))_0x1deada=_0x56feb3(0x23b);else{if(_0x277cb9&&(_0x4dc14d[_0x56feb3(0x210)]('temperature')||_0x4dc14d[_0x56feb3(0x210)](_0x56feb3(0x11e))))_0x1deada=_0x56feb3(0x1ca);}}}if(_0x1deada){let _0x3b95f8=_0xc73012[_0x3c51b7]||'';if(!_0x3b95f8){let _0x111d84=_0x3c51b7;for(let _0x224f9d=0x0;_0x224f9d<0x3;_0x224f9d++){const _0x2bb6bb=_0x111d84['lastIndexOf']('.');if(_0x2bb6bb===-0x1)break;_0x111d84=_0x111d84['substring'](0x0,_0x2bb6bb);if(_0xc73012[_0x111d84]){_0x3b95f8=_0xc73012[_0x111d84];break;}}}_0x580f20[_0x56feb3(0x15b)]({'id':_0x3c51b7,'name':_0x40c1f8,'location':_0x3b95f8,'type':_0x1deada,'logDuplicates':_0x1deada===_0x56feb3(0x22b),'isExit':![],'_score':_0x3b95f8?0x50:0x28});}}return _0x580f20;}async function getCalendarNames(_0x3eac1d,_0x2acb46){const _0x1405eb=a0_0x2efbe2;try{const _0x36480a=await _0x3eac1d[_0x1405eb(0x241)](_0x2acb46+_0x1405eb(0x275));if(_0x36480a&&_0x36480a[_0x1405eb(0x18a)]){const _0x34b457=JSON[_0x1405eb(0x2ad)](_0x36480a[_0x1405eb(0x18a)]);if(Array[_0x1405eb(0x150)](_0x34b457))return[...new Set(_0x34b457[_0x1405eb(0x248)](_0x4143c2=>_0x4143c2[_0x1405eb(0x2a3)])[_0x1405eb(0x280)](Boolean))]['sort']();}}catch(_0x37ee8d){}return[];}async function getCalendarContext(_0x2cf31b){const _0xbd1bf0=a0_0x2efbe2;if(!_0x2cf31b['config']['useCalendar'])return _0xbd1bf0(0x242);const _0x3b0a71=_0x2cf31b[_0xbd1bf0(0x148)][_0xbd1bf0(0x22c)]||_0xbd1bf0(0x178);try{const _0x309618=await _0x2cf31b[_0xbd1bf0(0x241)](_0x3b0a71+'.data.table');if(_0x309618&&_0x309618[_0xbd1bf0(0x18a)]){let _0x259dbe=JSON['parse'](_0x309618[_0xbd1bf0(0x18a)]);if(Array[_0xbd1bf0(0x150)](_0x259dbe)){if(_0x259dbe[_0xbd1bf0(0x2b9)]>0x0)return _0xbd1bf0(0x1c6)+_0x259dbe[_0xbd1bf0(0x1c0)](0x0,0x3)['map'](_0x4420ef=>_0x4420ef['event'])[_0xbd1bf0(0x2b8)](',\x20');}}}catch(_0x4deca2){}return _0xbd1bf0(0x16d);}async function saveFeedback(_0x9686ad,_0x5a2a12){const _0x5e0b04=a0_0x2efbe2;_0x9686ad[_0x5e0b04(0x118)]['info'](_0x5e0b04(0x179)+JSON[_0x5e0b04(0x163)](_0x5a2a12));}async function initSensorSubscriptions(_0x3238d7){const _0x3d5c65=a0_0x2efbe2,_0x369df3=_0x3238d7[_0x3d5c65(0x148)][_0x3d5c65(0x2bd)];if(_0x369df3)for(const _0x57da06 of _0x369df3){await _0x3238d7[_0x3d5c65(0x15d)](_0x57da06['id']);}}async function initPresenceSubscriptions(_0x3d6714){const _0x50a5a9=a0_0x2efbe2,_0x3cf3cc=_0x3d6714[_0x50a5a9(0x148)][_0x50a5a9(0x2c1)];if(_0x3cf3cc)for(const _0x278c85 of _0x3cf3cc){await _0x3d6714[_0x50a5a9(0x15d)](_0x278c85);}}async function setupTelegramListener(_0x5d2792){const _0x38ae55=a0_0x2efbe2,_0x33bf4a=_0x5d2792[_0x38ae55(0x148)][_0x38ae55(0x2d3)];if(_0x5d2792[_0x38ae55(0x148)][_0x38ae55(0x17c)]&&_0x33bf4a)await _0x5d2792['subscribeForeignStatesAsync'](_0x33bf4a+'.communicate.request');}async function handleTelegramResponse(_0x46ad87,_0x6fd408){const _0x47ba8a=a0_0x2efbe2;let _0x246ccc=_0x6fd408;_0x6fd408['startsWith']('[')&&(_0x246ccc=_0x6fd408['substring'](_0x6fd408[_0x47ba8a(0x10f)](']')+0x1));if(_0x246ccc===_0x47ba8a(0x1a1))await _0x46ad87[_0x47ba8a(0x233)](_0x47ba8a(0x2a0),{'val':![],'ack':!![]}),await _0x46ad87[_0x47ba8a(0x233)](_0x47ba8a(0x138),{'val':_0x47ba8a(0x288),'ack':!![]}),_0x46ad87[_0x47ba8a(0x11c)]=![],sendNotification(_0x46ad87,_0x47ba8a(0x10c),![]);else _0x246ccc===_0x47ba8a(0x1f1)&&sendNotification(_0x46ad87,_0x47ba8a(0x183),![],!![]);}async function sendNotification(_0x4b1316,_0x4ca8a0,_0x5825d3=![],_0x152505=![]){const _0x332ae9=a0_0x2efbe2,_0x13a52e=_0x4b1316[_0x332ae9(0x148)];if(_0x13a52e['notifyTelegramEnabled']){let _0x452e39={};(_0x4ca8a0[_0x332ae9(0x210)](_0x332ae9(0x1c9))||_0x152505)&&(_0x452e39={'reply_markup':{'inline_keyboard':[[{'text':_0x332ae9(0x172),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x332ae9(0x14b),'callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0x4b1316[_0x332ae9(0x298)](_0x13a52e[_0x332ae9(0x2d3)],_0x332ae9(0x20b),{'text':_0x4ca8a0,'user':_0x13a52e['notifyTelegramRecipient'],..._0x452e39});}if(_0x13a52e[_0x332ae9(0x1d5)]){let _0xa906db={'message':_0x4ca8a0,'title':_0x152505?'ðŸš¨\x20EMERGENCY':_0x332ae9(0x154),'priority':_0x152505?0x2:0x1,'device':_0x13a52e[_0x332ae9(0x240)]};_0x152505&&(_0xa906db[_0x332ae9(0x17d)]=0x1e,_0xa906db['expire']=0xe10,_0xa906db[_0x332ae9(0x18c)]=_0x332ae9(0x26e)),await _0x4b1316['sendToAsync'](_0x13a52e[_0x332ae9(0x283)],_0x332ae9(0x20b),_0xa906db);}_0x13a52e[_0x332ae9(0x261)]&&await _0x4b1316[_0x332ae9(0x298)](_0x13a52e[_0x332ae9(0x1fb)],'send',{'text':_0x4ca8a0,'to':_0x13a52e[_0x332ae9(0x1ae)]});}async function runAutopilot(_0x16fc29){const _0x30436a=a0_0x2efbe2,_0x33254d=_0x16fc29[_0x30436a(0x148)][_0x30436a(0x251)],_0x15cce0=_0x16fc29[_0x30436a(0x215)][_0x30436a(0x2b9)]>0x0?_0x16fc29[_0x30436a(0x215)][0x0][_0x30436a(0x197)]:Date[_0x30436a(0x1ba)](),_0x34ee09=(Date[_0x30436a(0x1ba)]()-_0x15cce0)/(0x3e8*0x3c*0x3c);let _0x488218='';_0x16fc29[_0x30436a(0x148)][_0x30436a(0x26d)]&&_0x16fc29[_0x30436a(0x155)]===SYSTEM_MODES[_0x30436a(0x153)]&&_0x16fc29[_0x30436a(0x23e)]&&(_0x34ee09>_0x33254d&&(_0x488218=_0x30436a(0x134)+_0x34ee09[_0x30436a(0x2a8)](0x1)+'h.')),runGeminiAnalysis(_0x16fc29,_0x488218);}async function checkWifiPresence(_0xa1f33b){const _0xa3c611=a0_0x2efbe2;try{const _0x44de97=_0xa1f33b[_0xa3c611(0x148)][_0xa3c611(0x2c1)]||[];let _0x1a285b=![];const _0x3c8af2=[];for(const _0x1a1698 of _0x44de97){try{const _0x1805a9=await _0xa1f33b[_0xa3c611(0x241)](_0x1a1698);_0x1805a9&&(_0x1805a9[_0xa3c611(0x18a)]===!![]||_0x1805a9[_0xa3c611(0x18a)]==='online'||_0x1805a9[_0xa3c611(0x18a)]===0x1)&&(_0x1a285b=!![],_0x3c8af2['push'](_0x1a1698));}catch(_0x199d0c){}}return await _0xa1f33b[_0xa3c611(0x233)]('system.presenceWho',{'val':_0x3c8af2[_0xa3c611(0x2b8)](',\x20'),'ack':!![]}),_0x1a285b&&(_0xa1f33b[_0xa3c611(0x2af)]&&(_0xa1f33b[_0xa3c611(0x118)][_0xa3c611(0x205)]('WiFi\x20Presence\x20detected.'),abortExitTimer(_0xa1f33b)),!_0xa1f33b['isPresent']&&_0xa1f33b[_0xa3c611(0x155)]===SYSTEM_MODES[_0xa3c611(0x153)]&&await setPresence(_0xa1f33b,!![])),_0x1a285b;}catch(_0x41bfc6){return![];}}function startExitTimer(_0x2a8776){const _0x20c568=a0_0x2efbe2;abortExitTimer(_0x2a8776),_0x2a8776[_0x20c568(0x209)]=!![],_0x2a8776['exitGraceTimer']=setTimeout(()=>{const _0x4d1ea1=_0x20c568;_0x2a8776[_0x4d1ea1(0x209)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x2a8776[_0x20c568(0x2af)]=setTimeout(()=>{const _0x580a67=_0x20c568;setPresence(_0x2a8776,![]),_0x2a8776[_0x580a67(0x2af)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x300a1d){const _0x28b9db=a0_0x2efbe2;if(_0x300a1d[_0x28b9db(0x2af)])clearTimeout(_0x300a1d['exitTimer']);if(_0x300a1d['exitGraceTimer'])clearTimeout(_0x300a1d['exitGraceTimer']);_0x300a1d[_0x28b9db(0x2af)]=null,_0x300a1d[_0x28b9db(0x237)]=null,_0x300a1d[_0x28b9db(0x209)]=![];}async function setPresence(_0x3cfe9b,_0x21cfd6){const _0x20f5bf=a0_0x2efbe2;if(_0x3cfe9b[_0x20f5bf(0x23e)]===_0x21cfd6)return;_0x3cfe9b[_0x20f5bf(0x23e)]=_0x21cfd6,await _0x3cfe9b[_0x20f5bf(0x233)](_0x20f5bf(0x24e),{'val':_0x21cfd6,'ack':!![]});}async function executeAutomationAction(_0x225d05){const _0x425c87=a0_0x2efbe2;try{const _0x596db3=await _0x225d05[_0x425c87(0x1dc)](_0x425c87(0x24d)),_0x45e0a9=await _0x225d05[_0x425c87(0x1dc)](_0x425c87(0x1b1));if(_0x596db3&&_0x596db3[_0x425c87(0x18a)]&&_0x45e0a9){const _0x31c293=_0x596db3[_0x425c87(0x18a)];let _0x5884cc=_0x45e0a9[_0x425c87(0x18a)];try{_0x5884cc=JSON['parse'](_0x5884cc);}catch(_0x115657){}_0x225d05[_0x425c87(0x118)]['info'](_0x425c87(0x1b0)+_0x31c293+_0x425c87(0x1bd)+_0x5884cc),await _0x225d05['setForeignStateAsync'](_0x31c293,_0x5884cc);}else _0x225d05['log'][_0x425c87(0x20e)](_0x425c87(0x27f));}catch(_0x224ec3){_0x225d05['log'][_0x425c87(0x140)](_0x425c87(0x218)+_0x224ec3['message']);}}class CogniLiving extends utils['Adapter']{constructor(_0xf9721c){const _0x5af0d3=a0_0x2efbe2;super({..._0xf9721c,'name':_0x5af0d3(0x254)}),this[_0x5af0d3(0x215)]=[],this['analysisHistory']=[],this[_0x5af0d3(0x28f)]=[],this[_0x5af0d3(0x137)]=[],this[_0x5af0d3(0x247)]={},this[_0x5af0d3(0x1ce)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x5af0d3(0x23e)]=!![],this[_0x5af0d3(0x2af)]=null,this[_0x5af0d3(0x237)]=null,this[_0x5af0d3(0x209)]=![],this[_0x5af0d3(0x270)]=null,this['geminiModel']=null,this[_0x5af0d3(0x155)]=SYSTEM_MODES['NORMAL'],this[_0x5af0d3(0x2be)]=![],this[_0x5af0d3(0x11c)]=![],this[_0x5af0d3(0x167)]=_0x5af0d3(0x130),this['analysisTimer']=null,this[_0x5af0d3(0x187)]=null,this['modeResetJob']=null,this[_0x5af0d3(0x1ff)]=null,this[_0x5af0d3(0x279)]=null,this[_0x5af0d3(0x146)]=null,this[_0x5af0d3(0x26c)]=![],this['on'](_0x5af0d3(0x29e),this[_0x5af0d3(0x287)][_0x5af0d3(0x15a)](this)),this['on'](_0x5af0d3(0x132),this[_0x5af0d3(0x1a0)][_0x5af0d3(0x15a)](this)),this['on']('unload',this[_0x5af0d3(0x1e6)][_0x5af0d3(0x15a)](this)),this['on'](_0x5af0d3(0x282),this[_0x5af0d3(0x29c)][_0x5af0d3(0x15a)](this));}async['onReady'](){const _0x520192=a0_0x2efbe2;this[_0x520192(0x118)][_0x520192(0x205)](_0x520192(0x2a5)+this[_0x520192(0x294)]+_0x520192(0x128)),await initZombies(this);try{this[_0x520192(0x2be)]=await checkLicense(this,this[_0x520192(0x148)]['licenseKey']);}catch(_0x23be43){}if(!this[_0x520192(0x148)]['inactivityThresholdHours']||this['config'][_0x520192(0x251)]<0.1)this[_0x520192(0x148)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x520192(0x148)]['geminiApiKey'])try{this['genAI']=new GoogleGenerativeAI(this[_0x520192(0x148)][_0x520192(0x257)]),this[_0x520192(0x1c3)]=this[_0x520192(0x270)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x520192(0x133)}}),this[_0x520192(0x118)][_0x520192(0x205)](_0x520192(0x255));}catch(_0x26785e){this[_0x520192(0x118)][_0x520192(0x140)](_0x520192(0x2ba)+_0x26785e[_0x520192(0x282)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates'](_0x520192(0x1c2)),this[_0x520192(0x24c)](LTM_DP_TRIGGER_DIGEST),this[_0x520192(0x24c)]('system.mode'),this[_0x520192(0x24c)](_0x520192(0x23d)),this[_0x520192(0x24c)]('analysis.automation.triggerAction'),this[_0x520192(0x24c)](_0x520192(0x244)),this[_0x520192(0x24c)](_0x520192(0x1f7)),this[_0x520192(0x24c)](_0x520192(0x2c4)),this['subscribeStates']('analysis.training.triggerEnergy'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x520192(0x276)])clearInterval(this[_0x520192(0x276)]);const _0x449ab4=this[_0x520192(0x148)][_0x520192(0x2a7)]||0xf;_0x449ab4>0x0&&(this['analysisTimer']=setInterval(()=>{runAutopilot(this);},_0x449ab4*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x4f2692=_0x520192;if(this[_0x4f2692(0x146)])runPythonHealthCheck(this);},0x1388);}[a0_0x2efbe2(0x1e6)](_0x2a6083){const _0x1febab=a0_0x2efbe2;if(this[_0x1febab(0x276)])clearInterval(this[_0x1febab(0x276)]);if(this[_0x1febab(0x1ff)])clearInterval(this[_0x1febab(0x1ff)]);if(this[_0x1febab(0x187)])this['ltmJob']['cancel']();if(this[_0x1febab(0x27d)])this[_0x1febab(0x27d)][_0x1febab(0x123)]();if(this[_0x1febab(0x279)])this['briefingJob'][_0x1febab(0x123)]();if(this[_0x1febab(0x2af)])clearTimeout(this[_0x1febab(0x2af)]);if(this['exitGraceTimer'])clearTimeout(this[_0x1febab(0x237)]);stopPythonService(this),_0x2a6083();}async['onStateChange'](_0x5d69e7,_0x638719){const _0x36ce2a=a0_0x2efbe2;if(!_0x638719||this['dependencyInstallInProgress'])return;if(_0x5d69e7[_0x36ce2a(0x210)]('telegram')&&_0x5d69e7[_0x36ce2a(0x1fc)](_0x36ce2a(0x1c5))&&_0x638719[_0x36ce2a(0x18a)]){await handleTelegramResponse(this,_0x638719['val']);return;}if(_0x5d69e7===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0x638719[_0x36ce2a(0x18a)]&&Object[_0x36ce2a(0x168)](SYSTEM_MODES)['includes'](_0x638719['val'])){this[_0x36ce2a(0x155)]=_0x638719[_0x36ce2a(0x18a)];if(_0x638719['val']===SYSTEM_MODES[_0x36ce2a(0x220)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x638719[_0x36ce2a(0x126)])this['setState'](_0x5d69e7,{'val':this[_0x36ce2a(0x155)],'ack':!![]});return;}if(!_0x638719[_0x36ce2a(0x126)]){_0x5d69e7[_0x36ce2a(0x210)]('analysis.trigger')&&_0x638719[_0x36ce2a(0x18a)]&&(this[_0x36ce2a(0x1d0)](_0x5d69e7,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x5d69e7[_0x36ce2a(0x210)]('triggerDailyDigest')&&_0x638719[_0x36ce2a(0x18a)]){this['setState'](_0x5d69e7,{'val':![],'ack':!![]});if(this[_0x36ce2a(0x2be)])createDailyDigest(this);}_0x5d69e7[_0x36ce2a(0x210)]('triggerBriefing')&&_0x638719[_0x36ce2a(0x18a)]&&(this[_0x36ce2a(0x1d0)](_0x5d69e7,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x5d69e7['includes'](_0x36ce2a(0x114))&&_0x638719['val']&&(this[_0x36ce2a(0x1d0)](_0x5d69e7,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x5d69e7[_0x36ce2a(0x210)](_0x36ce2a(0x1f7))&&_0x638719[_0x36ce2a(0x18a)]){this[_0x36ce2a(0x1d0)](_0x5d69e7,{'val':![],'ack':!![]});if(this[_0x36ce2a(0x2be)])try{const _0x1025db=await this[_0x36ce2a(0x1dc)](_0x36ce2a(0x171));if(_0x1025db&&_0x1025db['val']){const _0x95ede4=JSON[_0x36ce2a(0x2ad)](_0x1025db['val']);this['log'][_0x36ce2a(0x205)](_0x36ce2a(0x16a)),this[_0x36ce2a(0x233)](_0x36ce2a(0x156),{'val':_0x36ce2a(0x14a),'ack':!![]}),sendToPython(this,'TRAIN_SECURITY',{'sequences':_0x95ede4});}}catch(_0x450c75){this[_0x36ce2a(0x118)][_0x36ce2a(0x140)](_0x36ce2a(0x1e3)+_0x450c75[_0x36ce2a(0x282)]);}}if(_0x5d69e7['includes'](_0x36ce2a(0x2c4))&&_0x638719[_0x36ce2a(0x18a)]){this[_0x36ce2a(0x1d0)](_0x5d69e7,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x197cd5=await this[_0x36ce2a(0x1dc)](LTM_DP_DAILY_DIGESTS);if(_0x197cd5&&_0x197cd5[_0x36ce2a(0x18a)])sendToPython(this,_0x36ce2a(0x2a9),{'digests':JSON[_0x36ce2a(0x2ad)](_0x197cd5[_0x36ce2a(0x18a)])});}catch(_0x239ea2){}}if(_0x5d69e7[_0x36ce2a(0x210)](_0x36ce2a(0x157))&&_0x638719[_0x36ce2a(0x18a)]){this[_0x36ce2a(0x1d0)](_0x5d69e7,{'val':![],'ack':!![]});if(this[_0x36ce2a(0x2be)])try{const _0x41702b=await this['getStateAsync'](_0x36ce2a(0x299));if(_0x41702b&&_0x41702b[_0x36ce2a(0x18a)])sendToPython(this,_0x36ce2a(0x2c3),{'points':JSON[_0x36ce2a(0x2ad)](_0x41702b[_0x36ce2a(0x18a)])});}catch(_0x70bfa2){}}return;}if(this['config'][_0x36ce2a(0x2c1)]&&this[_0x36ce2a(0x148)]['presenceDevices']['includes'](_0x5d69e7)){await checkWifiPresence(this);return;}const _0x51fa9d=(this[_0x36ce2a(0x148)][_0x36ce2a(0x2bd)]||[])['find'](_0x4e20d3=>_0x4e20d3['id']===_0x5d69e7);if(_0x51fa9d)processSensorEvent(this,_0x5d69e7,_0x638719,_0x51fa9d);}async[a0_0x2efbe2(0x29c)](_0x5e44b1){const _0x2f13c5=a0_0x2efbe2;if(typeof _0x5e44b1===_0x2f13c5(0x21b)&&_0x5e44b1[_0x2f13c5(0x282)]){if(_0x5e44b1[_0x2f13c5(0x1ee)]===_0x2f13c5(0x208)){const _0x2510dc=_0x5e44b1[_0x2f13c5(0x282)][_0x2f13c5(0x2d1)]||this[_0x2f13c5(0x148)]['geminiApiKey'];if(!_0x2510dc)return this[_0x2f13c5(0x12c)](_0x5e44b1['from'],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':![],'message':_0x2f13c5(0x14d)},_0x5e44b1['callback']);try{const _0x4205ed=new GoogleGenerativeAI(_0x2510dc),_0x308831=_0x4205ed[_0x2f13c5(0x2b1)]({'model':GEMINI_MODEL}),_0xe566b6=await _0x308831[_0x2f13c5(0x212)]('Hi');this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1['command'],{'success':!![],'message':_0x2f13c5(0x119)+_0xe566b6[_0x2f13c5(0x27c)][_0x2f13c5(0x1cb)]()},_0x5e44b1['callback']);}catch(_0x3a6bc2){this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':![],'message':'Err:\x20'+_0x3a6bc2['message']},_0x5e44b1[_0x2f13c5(0x2b2)]);}}else{if(_0x5e44b1[_0x2f13c5(0x1ee)]===_0x2f13c5(0x264)){const _0x5f3bed=await getWeatherContext(this),_0x4614bf=await getCalendarContext(this);this['sendTo'](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':!![],'weather':_0x5f3bed,'calendar':_0x4614bf},_0x5e44b1[_0x2f13c5(0x2b2)]);}else{if(_0x5e44b1[_0x2f13c5(0x1ee)]==='getLtmData'){if(!this[_0x2f13c5(0x2be)])return this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':![],'isPro':![]},_0x5e44b1[_0x2f13c5(0x2b2)]);let _0x2e22ef={'status':_0x2f13c5(0x2cd)};try{const _0x50ac4c=await this[_0x2f13c5(0x1dc)](LTM_DP_DRIFT_STATUS);_0x2e22ef[_0x2f13c5(0x2cc)]=_0x50ac4c?_0x50ac4c[_0x2f13c5(0x18a)]:_0x2f13c5(0x2cd);}catch(_0x5abcdd){}this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x2f13c5(0x137)],'driftAnalysis':_0x2e22ef,'analysisHistory':this['analysisHistory']},_0x5e44b1[_0x2f13c5(0x2b2)]);}else{if(_0x5e44b1[_0x2f13c5(0x1ee)]===_0x2f13c5(0x181)){const _0xf189b9=this[_0x2f13c5(0x137)]['length'],_0x3f8399=new Date(),_0x51abe1=new Date(_0x3f8399[_0x2f13c5(0x291)](),_0x3f8399['getMonth'](),_0x3f8399[_0x2f13c5(0x188)]())[_0x2f13c5(0x1ed)](),_0x2a6471=this['rawEventLog']['filter'](_0xb76b17=>new Date(_0xb76b17['timestamp'])[_0x2f13c5(0x1ed)]()>_0x51abe1)[_0x2f13c5(0x2b9)],_0x417f9b=new Array(0x18)[_0x2f13c5(0x263)](0x0);this[_0x2f13c5(0x28f)][_0x2f13c5(0x28d)](_0x1af1cf=>{const _0x5212a4=_0x2f13c5,_0x61c7f5=new Date(_0x1af1cf[_0x5212a4(0x197)]);if(_0x61c7f5[_0x5212a4(0x1ed)]()>_0x51abe1)_0x417f9b[_0x61c7f5['getHours']()]++;});let _0x9018a4={'status':_0x2f13c5(0x2cd)};try{const _0x5a4e40=await this[_0x2f13c5(0x1dc)](LTM_DP_DRIFT_STATUS);_0x9018a4[_0x2f13c5(0x2cc)]=_0x5a4e40?_0x5a4e40[_0x2f13c5(0x18a)]:_0x2f13c5(0x2cd);}catch(_0x100b59){}let _0x5b5701='';try{const _0x1a2bf5=await this[_0x2f13c5(0x1dc)](_0x2f13c5(0x1c4));_0x5b5701=_0x1a2bf5?_0x1a2bf5['val']:'';}catch(_0x491096){}let _0x31c3d9=null;!this[_0x2f13c5(0x1c3)]&&(_0x31c3d9=this[_0x2f13c5(0x148)][_0x2f13c5(0x257)]?_0x2f13c5(0x296):_0x2f13c5(0x262));let _0x27678c={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0xa25f5c=await this[_0x2f13c5(0x1dc)]('analysis.automation.patternDetected');if(_0xa25f5c&&_0xa25f5c[_0x2f13c5(0x18a)]){_0x27678c[_0x2f13c5(0x231)]=!![];const _0x2df7de=await this['getStateAsync'](_0x2f13c5(0x207));_0x27678c[_0x2f13c5(0x13e)]=_0x2df7de?_0x2df7de[_0x2f13c5(0x18a)]:'';const _0x1f8a63=await this[_0x2f13c5(0x1dc)]('analysis.automation.targetId');_0x27678c[_0x2f13c5(0x223)]=_0x1f8a63?_0x1f8a63[_0x2f13c5(0x18a)]:'';const _0x4eba63=await this['getStateAsync']('analysis.automation.targetValue');_0x27678c[_0x2f13c5(0x11a)]=_0x4eba63?_0x4eba63[_0x2f13c5(0x18a)]:'';}const _0x4f2255=await this[_0x2f13c5(0x1dc)](_0x2f13c5(0x244));_0x27678c[_0x2f13c5(0x28c)]=_0x4f2255?!!_0x4f2255['val']:![];}catch(_0x399c2e){}this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':!![],'eventHistory':this[_0x2f13c5(0x215)][_0x2f13c5(0x1c0)](0x0,0xf),'stats':{'digestCount':_0xf189b9,'eventCountToday':_0x2a6471,'hourlyActivity':_0x417f9b,'driftStatus':_0x9018a4[_0x2f13c5(0x2cc)],'isPresent':this[_0x2f13c5(0x23e)],'presenceWho':_0x5b5701,'minDays':this['config'][_0x2f13c5(0x217)]||0x7,'stbDays':this['config'][_0x2f13c5(0x204)]||0xe,'ltbDays':this[_0x2f13c5(0x148)][_0x2f13c5(0x2cf)]||0x3c,'systemError':_0x31c3d9},'automation':_0x27678c},_0x5e44b1[_0x2f13c5(0x2b2)]);}else{if(_0x5e44b1['command']==='scanDevices')try{const _0x5e5c5a=await scanForDevices(this,_0x5e44b1[_0x2f13c5(0x282)]||{});this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1['command'],{'success':!![],'devices':_0x5e5c5a},_0x5e44b1[_0x2f13c5(0x2b2)]);}catch(_0x245db2){this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':![],'error':_0x245db2[_0x2f13c5(0x282)]},_0x5e44b1['callback']);}else{if(_0x5e44b1[_0x2f13c5(0x1ee)]===_0x2f13c5(0x190)){const _0x333fb7=await this['getForeignObjectsAsync'](_0x2f13c5(0x19c),'enum'),_0x3dce8f=[];if(_0x333fb7)for(const _0x57e43f in _0x333fb7){const _0x44e5ed=_0x333fb7[_0x57e43f],_0x4edacc=(_0x44e5ed[_0x2f13c5(0x1cc)]&&typeof _0x44e5ed[_0x2f13c5(0x1cc)][_0x2f13c5(0x1d8)]==='object'?_0x44e5ed[_0x2f13c5(0x1cc)][_0x2f13c5(0x1d8)]['de']:_0x44e5ed[_0x2f13c5(0x1cc)]['name'])||_0x44e5ed['common']['name'];_0x3dce8f[_0x2f13c5(0x15b)]({'id':_0x57e43f,'name':_0x4edacc});}this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':!![],'enums':_0x3dce8f},_0x5e44b1['callback']);}else{if(_0x5e44b1[_0x2f13c5(0x1ee)]===_0x2f13c5(0x1d7)){const _0x121e24=_0x5e44b1[_0x2f13c5(0x282)][_0x2f13c5(0x19a)];if(!_0x121e24)return this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1['command'],{'success':![],'error':'No\x20instance'},_0x5e44b1[_0x2f13c5(0x2b2)]);const _0xb431ed=await getCalendarNames(this,_0x121e24);this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1['command'],{'success':!![],'names':_0xb431ed},_0x5e44b1[_0x2f13c5(0x2b2)]);}else{if(_0x5e44b1[_0x2f13c5(0x1ee)]===_0x2f13c5(0x1f8)){const {targetId:_0xf5ffa4,targetValue:_0x540f8d}=_0x5e44b1[_0x2f13c5(0x282)];this[_0x2f13c5(0x118)]['info']('ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20'+_0xf5ffa4+'\x20=\x20'+_0x540f8d),await this['setStateAsync'](_0x2f13c5(0x2a1),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x2f13c5(0x207),{'val':_0x2f13c5(0x20d)+_0xf5ffa4,'ack':!![]}),await this[_0x2f13c5(0x233)]('analysis.automation.targetId',{'val':_0xf5ffa4,'ack':!![]}),await this[_0x2f13c5(0x233)](_0x2f13c5(0x1b1),{'val':_0x540f8d,'ack':!![]}),this[_0x2f13c5(0x12c)](_0x5e44b1['from'],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':!![]},_0x5e44b1[_0x2f13c5(0x2b2)]);}else{if(_0x5e44b1[_0x2f13c5(0x1ee)]===_0x2f13c5(0x1fd)){const {historyId:_0x572641,rating:_0x3185f7,comment:_0x184a43,alertReason:_0x5490b1}=_0x5e44b1[_0x2f13c5(0x282)];_0x572641&&_0x3185f7?(await saveFeedback(this,{'timestamp':Date[_0x2f13c5(0x1ba)](),'historyId':_0x572641,'rating':_0x3185f7,'comment':_0x184a43,'alertReason':_0x5490b1}),this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':!![]},_0x5e44b1[_0x2f13c5(0x2b2)])):this[_0x2f13c5(0x12c)](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1['command'],{'success':![],'error':_0x2f13c5(0x226)},_0x5e44b1['callback']);}else _0x5e44b1['command']===_0x2f13c5(0x159)&&(this[_0x2f13c5(0x118)][_0x2f13c5(0x205)]('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x2f13c5(0x2a1),{'val':![],'ack':!![]}),await this[_0x2f13c5(0x233)](_0x2f13c5(0x207),{'val':'','ack':!![]}),this['sendTo'](_0x5e44b1[_0x2f13c5(0x1f2)],_0x5e44b1[_0x2f13c5(0x1ee)],{'success':!![]},_0x5e44b1['callback']));}}}}}}}}}}}if(require[a0_0x2efbe2(0x112)]!==module)module[a0_0x2efbe2(0x20f)]=_0x361d55=>new CogniLiving(_0x361d55);else new CogniLiving();