const a0_0xfba026=a0_0x3e03;(function(_0x1e530f,_0x25aa9e){const _0x311ba6=a0_0x3e03,_0x36f80a=_0x1e530f();while(!![]){try{const _0x2c8653=parseInt(_0x311ba6(0x194))/0x1+-parseInt(_0x311ba6(0x1ee))/0x2*(parseInt(_0x311ba6(0x12e))/0x3)+-parseInt(_0x311ba6(0x1b5))/0x4+-parseInt(_0x311ba6(0x15e))/0x5*(parseInt(_0x311ba6(0x100))/0x6)+parseInt(_0x311ba6(0x152))/0x7*(-parseInt(_0x311ba6(0xcb))/0x8)+-parseInt(_0x311ba6(0x281))/0x9*(-parseInt(_0x311ba6(0x217))/0xa)+parseInt(_0x311ba6(0x185))/0xb;if(_0x2c8653===_0x25aa9e)break;else _0x36f80a['push'](_0x36f80a['shift']());}catch(_0x4091b3){_0x36f80a['push'](_0x36f80a['shift']());}}}(a0_0x150e,0x22b66));const a0_0x3b697f=(function(){let _0x453df2=!![];return function(_0x5b4727,_0x1a066f){const _0x57b402=_0x453df2?function(){const _0x2a38ad=a0_0x3e03;if(_0x1a066f){const _0x573da9=_0x1a066f[_0x2a38ad(0xaf)](_0x5b4727,arguments);return _0x1a066f=null,_0x573da9;}}:function(){};return _0x453df2=![],_0x57b402;};}()),a0_0x242f15=a0_0x3b697f(this,function(){const _0x5a5313=a0_0x3e03;return a0_0x242f15['toString']()[_0x5a5313(0x1ad)]('(((.+)+)+)+$')[_0x5a5313(0x180)]()[_0x5a5313(0x1ba)](a0_0x242f15)[_0x5a5313(0x1ad)](_0x5a5313(0x133));});a0_0x242f15();'use strict';const utils=require(a0_0xfba026(0x10c)),{GoogleGenerativeAI}=require(a0_0xfba026(0xdd)),schedule=require('node-schedule'),{spawn,exec}=require('child_process'),path=require(a0_0xfba026(0x109)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0xfba026(0x280),LTM_SCHEDULE=a0_0xfba026(0xbf),MODE_RESET_SCHEDULE=a0_0xfba026(0x1ca),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0xfba026(0x1f7),LTM_DP_DAILY_DIGESTS=a0_0xfba026(0x23f),LTM_DP_STATUS=a0_0xfba026(0x27c),LTM_DP_TRIGGER_DIGEST=a0_0xfba026(0x111),LTM_DP_BASELINE_STATUS=a0_0xfba026(0x26e),LTM_DP_DRIFT_CHANNEL=a0_0xfba026(0x132),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0xfba026(0x271),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0xfba026(0x250),HARD_IGNORE_TERMS=[a0_0xfba026(0x1bd),'scriptEnabled',a0_0xfba026(0xfb),a0_0xfba026(0x10b),'lowbat','rssi',a0_0xfba026(0x12f),'maintenance',a0_0xfba026(0x246),'fault','working','direction',a0_0xfba026(0x1cd),'config_pending','dutycycle',a0_0xfba026(0x233),a0_0xfba026(0x104),a0_0xfba026(0x105)],BAD_NAMES=['targetposition',a0_0xfba026(0x166),a0_0xfba026(0x18a),'level',a0_0xfba026(0x1c1),a0_0xfba026(0x117),'on',a0_0xfba026(0x205),a0_0xfba026(0x158),'position',a0_0xfba026(0x10a),a0_0xfba026(0x148),'cover',a0_0xfba026(0x192),'motion',a0_0xfba026(0x22b),a0_0xfba026(0xc2),'temperature',a0_0xfba026(0x1b4),a0_0xfba026(0xb2),a0_0xfba026(0x20b),a0_0xfba026(0x1f4),a0_0xfba026(0x107),a0_0xfba026(0xe0),a0_0xfba026(0x1fd)],ADAPTER_BLACKLIST=[a0_0xfba026(0xcd),'admin.',a0_0xfba026(0x216),a0_0xfba026(0xd9),'history.',a0_0xfba026(0x178),a0_0xfba026(0x2b7),a0_0xfba026(0x202),a0_0xfba026(0xd7),a0_0xfba026(0x23a),'simple-api.'],SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0xfba026(0x26d),'PARTY':a0_0xfba026(0x273),'GUEST':a0_0xfba026(0x222)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0xfba026(0x108)],SYSTEM_MODES[a0_0xfba026(0x261)]],PERSONA_MAPPING={'generic':a0_0xfba026(0x1b0),'senior_aal':'PRIORIT√ÑT:\x20Gesundheit/AAL.','family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0xfba026(0x2ad)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x44d2d4){const _0x6252e6=a0_0xfba026;try{const _0x301491=[_0x6252e6(0x207),_0x6252e6(0x103)];for(const _0x2d9e59 of _0x301491){try{const _0x4406b0=await _0x44d2d4[_0x6252e6(0x1f6)](_0x2d9e59);_0x4406b0&&await _0x44d2d4[_0x6252e6(0x188)](_0x2d9e59);}catch(_0x56ee06){}}}catch(_0x3e4fbe){}}async function initHistory(_0x36ee73){const _0x1512a8=a0_0xfba026;try{const _0x3c7304=await _0x36ee73[_0x1512a8(0x199)](_0x1512a8(0x245));_0x3c7304&&_0x3c7304[_0x1512a8(0x213)]&&(_0x36ee73[_0x1512a8(0x170)]=JSON[_0x1512a8(0xfd)](_0x3c7304['val'][_0x1512a8(0x180)]()));}catch(_0x2f8a8d){_0x36ee73[_0x1512a8(0x170)]=[];}try{const _0x580c6f=await _0x36ee73[_0x1512a8(0x199)](_0x1512a8(0x114));if(_0x580c6f&&_0x580c6f['val'])_0x36ee73['analysisHistory']=JSON['parse'](_0x580c6f['val']['toString']());}catch(_0x5babbe){_0x36ee73[_0x1512a8(0xf4)]=[];}if(_0x36ee73['eventHistory']&&_0x36ee73[_0x1512a8(0x170)]['length']>0x0){_0x36ee73[_0x1512a8(0x19a)][_0x1512a8(0x1e1)](_0x1512a8(0x10f)+_0x36ee73[_0x1512a8(0x170)][_0x1512a8(0xd4)]+_0x1512a8(0x204));for(let _0x24e869=_0x36ee73[_0x1512a8(0x170)][_0x1512a8(0xd4)]-0x1;_0x24e869>=0x0;_0x24e869--){const _0x7b0ebf=_0x36ee73['eventHistory'][_0x24e869];_0x7b0ebf&&_0x7b0ebf['id']!==undefined&&_0x7b0ebf['value']!==undefined&&(_0x36ee73[_0x1512a8(0x297)][_0x7b0ebf['id']]=_0x7b0ebf[_0x1512a8(0x1c1)]);}}}async function initSystemConfig(_0x48655f){const _0x4d7a7a=a0_0xfba026;try{const _0x389381=await _0x48655f[_0x4d7a7a(0x257)]('system.config');_0x389381&&_0x389381['common']&&(_0x48655f['systemConfig']={'latitude':_0x389381['common'][_0x4d7a7a(0x1bb)]||0x0,'longitude':_0x389381[_0x4d7a7a(0x2a9)][_0x4d7a7a(0x24e)]||0x0,'city':_0x389381[_0x4d7a7a(0x2a9)][_0x4d7a7a(0x182)]||''});}catch(_0x4cbd83){}}async function checkLicense(_0x368cc2,_0x3de531){const _0x48c65b=a0_0xfba026;if(!_0x3de531)return![];_0x368cc2[_0x48c65b(0xd6)]=await getSystemUUID(_0x368cc2);if(_0x3de531===_0x48c65b(0x1ea)||_0x3de531[_0x48c65b(0xe1)](_0x48c65b(0x134)))return!![];return![];}async function getSystemUUID(_0x3ecb3c){const _0x314290=a0_0xfba026;try{const _0x125bb8=await _0x3ecb3c[_0x314290(0x257)](_0x314290(0x288));if(_0x125bb8&&_0x125bb8[_0x314290(0x2a7)]&&_0x125bb8['native'][_0x314290(0x22c)])return _0x125bb8[_0x314290(0x2a7)][_0x314290(0x22c)];return _0x314290(0x11c);}catch(_0x158a66){return _0x314290(0xc7);}}async function createAllObjects(_0xfc3c94){const _0x50cded=a0_0xfba026;await checkSystemObjects(_0xfc3c94),await _0xfc3c94['setObjectNotExistsAsync']('system.presenceWho',{'type':_0x50cded(0x18a),'common':{'name':'Who\x20is\x20present?','type':_0x50cded(0x13e),'role':_0x50cded(0x17b),'read':!![],'write':![],'def':''},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0xd3),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x112),'type':_0x50cded(0x13e),'role':_0x50cded(0x123),'read':!![],'write':![]},'native':{}}),await _0xfc3c94['setObjectNotExistsAsync'](_0x50cded(0x245),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x101),'type':_0x50cded(0x13e),'role':_0x50cded(0x123),'read':!![],'write':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x143),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x25b),'type':_0x50cded(0x153),'role':_0x50cded(0x144),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x10d),{'type':'state','common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x50cded(0x153),'role':_0x50cded(0x144),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x15b),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x201),'type':'string','role':_0x50cded(0x123),'read':!![],'write':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0xd5),{'type':'state','common':{'name':_0x50cded(0xb1),'type':_0x50cded(0x153),'role':_0x50cded(0x1ff),'read':!![],'write':![],'def':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x19c),{'type':'state','common':{'name':_0x50cded(0x285),'type':'boolean','role':_0x50cded(0x1be),'read':!![],'write':![],'def':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x2b2),{'type':_0x50cded(0x18a),'common':{'name':'Alert\x20Reason','type':'string','role':_0x50cded(0x21a),'read':!![],'write':![]},'native':{}}),await _0xfc3c94['setObjectNotExistsAsync'](_0x50cded(0x183),{'type':'state','common':{'name':_0x50cded(0x1a8),'type':_0x50cded(0x13e),'role':_0x50cded(0x17b),'read':!![],'write':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x28d),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x156),'type':_0x50cded(0x13e),'role':'state','read':!![],'write':![],'def':_0x50cded(0xd0)},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x218),{'type':_0x50cded(0x18a),'common':{'name':'Comfort\x20Summary','type':_0x50cded(0x13e),'role':_0x50cded(0x17b),'read':!![],'write':![]},'native':{}}),await _0xfc3c94['setObjectNotExistsAsync'](_0x50cded(0x28a),{'type':'state','common':{'name':_0x50cded(0x282),'type':_0x50cded(0x13e),'role':_0x50cded(0x17b),'read':!![],'write':![]},'native':{}}),await _0xfc3c94[_0x50cded(0x1ed)](_0x50cded(0x248),{'type':_0x50cded(0x196),'common':{'name':'Automation\x20Proposals'},'native':{}}),await _0xfc3c94['setObjectNotExistsAsync'](_0x50cded(0x1bf),{'type':'state','common':{'name':_0x50cded(0x1d7),'type':'boolean','role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x2b3),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x29a),'type':'string','role':_0x50cded(0x17b),'read':!![],'write':![]},'native':{}}),await _0xfc3c94['setObjectNotExistsAsync'](_0x50cded(0x11e),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x24b),'type':_0x50cded(0x13e),'role':'text','read':!![],'write':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x264),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x128),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x277),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x1f3),'type':_0x50cded(0x13e),'role':_0x50cded(0x17b),'read':!![],'write':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x24f),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x15f),'type':_0x50cded(0x153),'role':_0x50cded(0x158),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)]('analysis.automation.triggerAction',{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x210),'type':_0x50cded(0x153),'role':_0x50cded(0x144),'read':!![],'write':!![],'def':![]},'native':{}}),await _0xfc3c94['setObjectNotExistsAsync'](_0x50cded(0x114),{'type':'state','common':{'name':_0x50cded(0x235),'type':_0x50cded(0x13e),'role':_0x50cded(0x123),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)]('analysis.feedbackHistory',{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x231),'type':_0x50cded(0x13e),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0xfc3c94[_0x50cded(0x1ed)](_0x50cded(0xb3),{'type':'channel','common':{'name':_0x50cded(0x163)},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x126),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x29e),'type':_0x50cded(0x2a2),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x2ba),{'type':_0x50cded(0x18a),'common':{'name':'Restlessness\x20Level','type':_0x50cded(0x13e),'role':_0x50cded(0x17b),'read':!![],'write':![],'def':'none'},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x125),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x289),'type':'string','role':_0x50cded(0x17b),'read':!![],'write':![],'def':''},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)]('analysis.health.trendDiagnosis',{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x16b),'type':_0x50cded(0x13e),'role':'text','read':!![],'write':![],'def':_0x50cded(0xd0)},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x241),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x1e5),'type':'number','role':_0x50cded(0x1c1),'read':!![],'write':![],'def':0x0},'native':{}}),await _0xfc3c94[_0x50cded(0x1ed)](_0x50cded(0xf1),{'type':_0x50cded(0x196),'common':{'name':'Training\x20Data\x20Sets'},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)]('LTM.trainingData.sequences',{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0x1aa),'type':_0x50cded(0x13e),'role':'json','read':!![],'write':![],'def':'[]','desc':_0x50cded(0x251)},'native':{}}),await _0xfc3c94[_0x50cded(0xeb)](_0x50cded(0x119),{'type':_0x50cded(0x18a),'common':{'name':_0x50cded(0xba),'type':'string','role':_0x50cded(0x123),'read':!![],'write':![],'def':'[]','desc':_0x50cded(0x157)},'native':{}}),await checkLtmObjects(_0xfc3c94),await checkLtmDriftObjects(_0xfc3c94);}async function checkSystemObjects(_0x1763e4){const _0x56593a=a0_0xfba026;await _0x1763e4[_0x56593a(0x1ed)](_0x56593a(0xc3),{'type':_0x56593a(0x196),'common':{'name':_0x56593a(0x17a)},'native':{}}),await _0x1763e4[_0x56593a(0x1ed)](SYSTEM_DP_MODE,{'type':_0x56593a(0x18a),'common':{'name':'System\x20Mode','type':_0x56593a(0x13e),'role':_0x56593a(0x18a),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x56593a(0x28b)],'states':{[SYSTEM_MODES[_0x56593a(0x28b)]]:_0x56593a(0x22e),[SYSTEM_MODES[_0x56593a(0x214)]]:_0x56593a(0xda),[SYSTEM_MODES[_0x56593a(0x108)]]:_0x56593a(0x234),[SYSTEM_MODES[_0x56593a(0x261)]]:_0x56593a(0x11b)}},'native':{}});}async function checkLtmObjects(_0x5df8e9){const _0x40a4b1=a0_0xfba026;await _0x5df8e9['extendObjectAsync']('LTM',{'type':_0x40a4b1(0x196),'common':{'name':_0x40a4b1(0x29b)},'native':{}}),await _0x5df8e9[_0x40a4b1(0x1ed)](LTM_DP_RAW_LOG,{'type':_0x40a4b1(0x18a),'common':{'name':_0x40a4b1(0x17c),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await _0x5df8e9[_0x40a4b1(0x1ed)](LTM_DP_DAILY_DIGESTS,{'type':_0x40a4b1(0x18a),'common':{'name':_0x40a4b1(0x2ac),'type':_0x40a4b1(0x13e),'role':'json','read':!![],'write':![]},'native':{}}),await _0x5df8e9['extendObjectAsync'](LTM_DP_STATUS,{'type':'state','common':{'name':_0x40a4b1(0x175),'type':'string','role':_0x40a4b1(0x17b),'read':!![],'write':![]},'native':{}}),await _0x5df8e9[_0x40a4b1(0x1ed)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':'Trigger\x20Digest','type':_0x40a4b1(0x153),'role':_0x40a4b1(0x144),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x5df8e9['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x40a4b1(0x18a),'common':{'name':_0x40a4b1(0xee),'type':_0x40a4b1(0x13e),'role':_0x40a4b1(0x17b),'read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x325234){const _0x2a0a26=a0_0xfba026;await _0x325234[_0x2a0a26(0x1ed)](LTM_DP_DRIFT_CHANNEL,{'type':_0x2a0a26(0x196),'common':{'name':_0x2a0a26(0x142)},'native':{}}),await _0x325234[_0x2a0a26(0x1ed)](LTM_DP_DRIFT_STATUS,{'type':_0x2a0a26(0x18a),'common':{'name':'Drift\x20Status','type':_0x2a0a26(0x13e),'role':'state','read':!![],'write':![],'def':_0x2a0a26(0xd0)},'native':{}}),await _0x325234['extendObjectAsync'](LTM_DP_DRIFT_DETAILS,{'type':_0x2a0a26(0x18a),'common':{'name':'Drift\x20Details','type':_0x2a0a26(0x13e),'role':_0x2a0a26(0x17b),'read':!![],'write':![]},'native':{}}),await _0x325234[_0x2a0a26(0x1ed)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x2a0a26(0x18a),'common':{'name':_0x2a0a26(0x2ab),'type':'number','role':_0x2a0a26(0x181),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x5de8a8){const _0x43cf65=a0_0xfba026;try{const _0x59757c=await _0x5de8a8[_0x43cf65(0x199)](SYSTEM_DP_MODE);_0x59757c&&_0x59757c['val']&&Object['values'](SYSTEM_MODES)['includes'](_0x59757c['val'])?_0x5de8a8[_0x43cf65(0x18c)]=_0x59757c[_0x43cf65(0x213)]:(_0x5de8a8[_0x43cf65(0x18c)]=SYSTEM_MODES['NORMAL'],await _0x5de8a8[_0x43cf65(0x1c4)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x43cf65(0x28b)],'ack':!![]}));}catch(_0x3f2932){_0x5de8a8[_0x43cf65(0x18c)]=SYSTEM_MODES[_0x43cf65(0x28b)];}}async function loadRawEventLog(_0x1f6a33){const _0x15541c=a0_0xfba026;try{const _0x47972a=await _0x1f6a33['getStateAsync'](LTM_DP_RAW_LOG);if(_0x47972a&&_0x47972a[_0x15541c(0x213)])_0x1f6a33[_0x15541c(0x164)]=JSON['parse'](_0x47972a[_0x15541c(0x213)]);}catch(_0x373507){_0x1f6a33['rawEventLog']=[];}}async function saveRawEventLog(_0x50d506){const _0x5edc0=a0_0xfba026;_0x50d506['rawEventLog'][_0x5edc0(0xd4)]>RAW_LOG_MAX_SIZE&&_0x50d506[_0x5edc0(0x164)][_0x5edc0(0x1c0)](0x0,_0x50d506[_0x5edc0(0x164)][_0x5edc0(0xd4)]-RAW_LOG_MAX_SIZE),await _0x50d506[_0x5edc0(0x1c4)](LTM_DP_RAW_LOG,{'val':JSON[_0x5edc0(0x1da)](_0x50d506[_0x5edc0(0x164)]),'ack':!![]});}async function loadDailyDigests(_0x572513){const _0x5a1b3f=a0_0xfba026;try{const _0x56f5f4=await _0x572513['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x56f5f4&&_0x56f5f4['val'])_0x572513['dailyDigests']=JSON[_0x5a1b3f(0xfd)](_0x56f5f4[_0x5a1b3f(0x213)]);}catch(_0x1fd4a0){_0x572513['dailyDigests']=[];}await updateBaselineStatus(_0x572513);}async function saveDailyDigests(_0x3e550b,_0x338002=!![]){const _0x34d771=a0_0xfba026,_0x2c591f=_0x3e550b[_0x34d771(0x225)][_0x34d771(0x2a6)]||0x3c;_0x3e550b[_0x34d771(0xdb)][_0x34d771(0xd4)]>_0x2c591f&&_0x3e550b[_0x34d771(0xdb)][_0x34d771(0x1c0)](0x0,_0x3e550b[_0x34d771(0xdb)]['length']-_0x2c591f);await _0x3e550b['setStateAsync'](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x34d771(0x1da)](_0x3e550b[_0x34d771(0xdb)]),'ack':!![]});if(_0x338002)await updateBaselineStatus(_0x3e550b);}async function updateAnalysisHistory(_0x5ce0b7,_0x5801dc){const _0x7fba9c=a0_0xfba026;_0x5ce0b7[_0x7fba9c(0xf4)][_0x7fba9c(0x256)](_0x5801dc);if(_0x5ce0b7[_0x7fba9c(0xf4)][_0x7fba9c(0xd4)]>ANALYSIS_HISTORY_MAX_SIZE)_0x5ce0b7[_0x7fba9c(0xf4)][_0x7fba9c(0xa7)]();await _0x5ce0b7[_0x7fba9c(0x1c4)](_0x7fba9c(0x114),{'val':JSON[_0x7fba9c(0x1da)](_0x5ce0b7[_0x7fba9c(0xf4)]),'ack':!![]});}async function updateBaselineStatus(_0x4717f8){const _0x1605fb=a0_0xfba026;if(!_0x4717f8[_0x1605fb(0x255)]){await _0x4717f8[_0x1605fb(0x1c4)](LTM_DP_BASELINE_STATUS,{'val':_0x1605fb(0x239),'ack':!![]});return;}const _0x24f355=_0x4717f8[_0x1605fb(0xdb)]['length']>=(_0x4717f8[_0x1605fb(0x225)][_0x1605fb(0xc1)]||0x7)?_0x1605fb(0x139)+_0x4717f8[_0x1605fb(0xdb)][_0x1605fb(0xd4)]+_0x1605fb(0x237):_0x1605fb(0x229)+_0x4717f8[_0x1605fb(0xdb)]['length']+'/'+(_0x4717f8[_0x1605fb(0x225)]['minDaysForBaseline']||0x7)+')';await _0x4717f8['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x24f355,'ack':!![]});}async function initSensorSubscriptions(_0x4ee9a1){const _0x2d99e2=a0_0xfba026,_0x14d90e=_0x4ee9a1[_0x2d99e2(0x225)][_0x2d99e2(0x28e)];if(_0x14d90e&&_0x14d90e[_0x2d99e2(0xd4)]>0x0){_0x4ee9a1[_0x2d99e2(0x19a)][_0x2d99e2(0x1e1)](_0x2d99e2(0x1e9)+_0x14d90e[_0x2d99e2(0xd4)]+_0x2d99e2(0x1d0));for(const _0x451fb5 of _0x14d90e){if(_0x451fb5['id']){await _0x4ee9a1[_0x2d99e2(0x1d4)](_0x451fb5['id']);try{const _0x1f07ee=await _0x4ee9a1[_0x2d99e2(0xc5)](_0x451fb5['id']);if(_0x1f07ee)_0x4ee9a1[_0x2d99e2(0x297)][_0x451fb5['id']]=_0x1f07ee[_0x2d99e2(0x213)];}catch(_0x2c2897){}}}}}async function initPresenceSubscriptions(_0x41782c){const _0x1ea195=a0_0xfba026,_0x2a5838=_0x41782c[_0x1ea195(0x225)]['presenceDevices']||[];if(_0x2a5838[_0x1ea195(0xd4)]>0x0){_0x41782c[_0x1ea195(0x19a)][_0x1ea195(0x1e1)](_0x1ea195(0x1e9)+_0x2a5838[_0x1ea195(0xd4)]+_0x1ea195(0x198));for(const _0x21acd9 of _0x2a5838){await _0x41782c[_0x1ea195(0x1d4)](_0x21acd9);}try{await checkWifiPresence(_0x41782c);}catch(_0x5a4811){}}}async function getWeatherContext(_0x2f5151){const _0x4ff31a=a0_0xfba026;try{if(!_0x2f5151[_0x4ff31a(0x225)][_0x4ff31a(0x227)])return _0x4ff31a(0x283);let _0x2c1939='';const _0x18ae54=_0x2f5151[_0x4ff31a(0x225)]['weatherInstance'];if(_0x18ae54)try{if(_0x18ae54['includes'](_0x4ff31a(0x167))){const _0x888985=await _0x2f5151[_0x4ff31a(0xc5)](_0x18ae54+_0x4ff31a(0x19e));if(_0x888985&&_0x888985['val'])_0x2c1939=_0x888985['val'];}else{if(_0x18ae54[_0x4ff31a(0x1b7)](_0x4ff31a(0xc0))){const _0x49af00=await _0x2f5151[_0x4ff31a(0xc5)](_0x18ae54+_0x4ff31a(0xaa));if(_0x49af00&&_0x49af00[_0x4ff31a(0x213)])_0x2c1939=_0x49af00[_0x4ff31a(0x213)];}else{if(_0x18ae54[_0x4ff31a(0x1b7)]('openweathermap')){const _0x368b20=await _0x2f5151['getForeignStateAsync'](_0x18ae54+_0x4ff31a(0x21b));if(_0x368b20&&_0x368b20[_0x4ff31a(0x213)])_0x2c1939=_0x368b20['val'];}}}}catch(_0x22404d){}if(!_0x2c1939){const _0x1160fa=[_0x4ff31a(0x278),'daswetter.0',_0x4ff31a(0x275),'openweathermap.0'];for(const _0xbb11d9 of _0x1160fa){try{const _0x887485=await _0x2f5151['getForeignObjectAsync'](_0xbb11d9);if(_0x887485){if(_0xbb11d9[_0x4ff31a(0x1b7)](_0x4ff31a(0x167))){const _0x42d9eb=await _0x2f5151[_0x4ff31a(0xc5)](_0xbb11d9+'.Summary.Current');if(_0x42d9eb&&_0x42d9eb[_0x4ff31a(0x213)]){_0x2c1939=_0x42d9eb[_0x4ff31a(0x213)];break;}}}}catch(_0x529c65){}}}return _0x2c1939?_0x4ff31a(0x102)+_0x2c1939:_0x4ff31a(0x27f);}catch(_0x3f3213){return _0x4ff31a(0x249)+_0x3f3213[_0x4ff31a(0xea)];}}async function getCalendarContext(_0x3637ed){const _0x2f2106=a0_0xfba026;try{if(!_0x3637ed[_0x2f2106(0x225)]['useCalendar'])return _0x2f2106(0x1a2);let _0x4e1f73=_0x3637ed[_0x2f2106(0x225)][_0x2f2106(0x1db)]||_0x2f2106(0x179),_0x3bfb58=_0x3637ed[_0x2f2106(0x225)]['calendarSelection']||[];if(typeof _0x3bfb58===_0x2f2106(0x13e))_0x3bfb58=_0x3bfb58[_0x2f2106(0x11d)](',');try{const _0x54adaa=await _0x3637ed[_0x2f2106(0xc5)](_0x4e1f73+_0x2f2106(0xce));if(_0x54adaa&&_0x54adaa[_0x2f2106(0x213)]){let _0x11582a=tryParse(_0x54adaa[_0x2f2106(0x213)]);if(_0x11582a&&Array[_0x2f2106(0x12a)](_0x11582a)){if(_0x3bfb58[_0x2f2106(0xd4)]>0x0)_0x11582a=_0x11582a[_0x2f2106(0x191)](_0x202fea=>_0x3bfb58['includes'](_0x202fea[_0x2f2106(0x270)]||''));else return _0x2f2106(0x20f);if(_0x11582a[_0x2f2106(0xd4)]>0x0){const _0x34a91a=_0x11582a['slice'](0x0,0x3)[_0x2f2106(0x22f)](_0x4bcd74=>{const _0x295258=_0x2f2106;let _0x2bcfe9=_0x4bcd74[_0x295258(0x181)];if(_0x4bcd74[_0x295258(0xe4)])_0x2bcfe9+='\x20'+_0x4bcd74[_0x295258(0xe4)];return _0x2bcfe9+':\x20'+_0x4bcd74['event']+'\x20('+_0x4bcd74[_0x295258(0x270)]+')';});return'KALENDER:\x20'+_0x34a91a[_0x2f2106(0xfa)](_0x2f2106(0x186));}else return _0x2f2106(0x12d);}}}catch(_0x26509c){_0x3637ed['log'][_0x2f2106(0x22a)](_0x2f2106(0x162)+_0x26509c['message']);}return _0x2f2106(0x25c);}catch(_0x1dc538){return _0x2f2106(0x298)+_0x1dc538['message'];}}async function getCalendarNames(_0x5a1b99,_0x13eaf5){const _0x35b7b6=a0_0xfba026;try{const _0x2f378c=await _0x5a1b99[_0x35b7b6(0xc5)](_0x13eaf5+_0x35b7b6(0xce));if(_0x2f378c&&_0x2f378c[_0x35b7b6(0x213)]){const _0x1b7d2b=tryParse(_0x2f378c['val']);if(_0x1b7d2b&&Array[_0x35b7b6(0x12a)](_0x1b7d2b)){const _0x4a50ac=[...new Set(_0x1b7d2b[_0x35b7b6(0x22f)](_0x51af80=>_0x51af80['_calName'])[_0x35b7b6(0x191)](Boolean))];return _0x4a50ac[_0x35b7b6(0x1ef)]();}}return[];}catch(_0x358eaa){return _0x5a1b99[_0x35b7b6(0x19a)]['error'](_0x35b7b6(0xe8)+_0x358eaa[_0x35b7b6(0xea)]),[];}}async function checkWifiPresence(_0x13b7cf){const _0x18a28d=a0_0xfba026;try{const _0x1efedb=_0x13b7cf[_0x18a28d(0x225)][_0x18a28d(0x242)]||[];let _0x3cc562=![];const _0x36b045=[];for(const _0x37f49b of _0x1efedb){try{const _0x184a4b=await _0x13b7cf[_0x18a28d(0xc5)](_0x37f49b);if(_0x184a4b&&(_0x184a4b[_0x18a28d(0x213)]===!![]||_0x184a4b[_0x18a28d(0x213)]===_0x18a28d(0x1df)||_0x184a4b[_0x18a28d(0x213)]===0x1)){_0x3cc562=!![];const _0x15a361=await _0x13b7cf[_0x18a28d(0x257)](_0x37f49b);let _0x1b93be=_0x37f49b;_0x15a361&&_0x15a361['common']&&_0x15a361[_0x18a28d(0x2a9)][_0x18a28d(0xde)]&&(_0x1b93be=typeof _0x15a361['common'][_0x18a28d(0xde)]===_0x18a28d(0xf6)?_0x15a361[_0x18a28d(0x2a9)][_0x18a28d(0xde)]['de']||_0x15a361['common'][_0x18a28d(0xde)]['en']:_0x15a361['common']['name']),_0x36b045['push'](_0x1b93be);}}catch(_0x47d924){}}return await _0x13b7cf[_0x18a28d(0x1c4)](_0x18a28d(0x1a7),{'val':_0x36b045[_0x18a28d(0xfa)](',\x20'),'ack':!![]}),_0x3cc562&&(_0x13b7cf[_0x18a28d(0xe9)]&&(_0x13b7cf[_0x18a28d(0x19a)][_0x18a28d(0x1e1)](_0x18a28d(0x127)),abortExitTimer(_0x13b7cf)),!_0x13b7cf[_0x18a28d(0x145)]&&_0x13b7cf[_0x18a28d(0x18c)]===SYSTEM_MODES[_0x18a28d(0x28b)]&&await setPresence(_0x13b7cf,!![])),_0x3cc562;}catch(_0x59e70d){return _0x13b7cf[_0x18a28d(0x19a)][_0x18a28d(0x246)](_0x18a28d(0x22d)+_0x59e70d[_0x18a28d(0xea)]),![];}}function startExitTimer(_0x128f13){const _0x591279=a0_0xfba026;abortExitTimer(_0x128f13),_0x128f13[_0x591279(0x16c)]=!![],_0x128f13[_0x591279(0xb5)]=setTimeout(()=>{const _0x3338d8=_0x591279;_0x128f13[_0x3338d8(0x16c)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x128f13[_0x591279(0xe9)]=setTimeout(()=>{setPresence(_0x128f13,![]),_0x128f13['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x151f06){const _0x42ed42=a0_0xfba026;if(_0x151f06[_0x42ed42(0xe9)])clearTimeout(_0x151f06[_0x42ed42(0xe9)]);if(_0x151f06[_0x42ed42(0xb5)])clearTimeout(_0x151f06[_0x42ed42(0xb5)]);_0x151f06[_0x42ed42(0xe9)]=null,_0x151f06[_0x42ed42(0xb5)]=null,_0x151f06[_0x42ed42(0x16c)]=![];}async function setPresence(_0x3e3d2c,_0x366647){const _0xa47a51=a0_0xfba026;if(_0x3e3d2c[_0xa47a51(0x145)]===_0x366647)return;_0x3e3d2c[_0xa47a51(0x145)]=_0x366647,await _0x3e3d2c[_0xa47a51(0x1c4)](_0xa47a51(0x232),{'val':_0x366647,'ack':!![]});}async function saveFeedback(_0x2c1bb6,_0x2522f7){const _0x3dd685=a0_0xfba026;_0x2c1bb6[_0x3dd685(0x19a)]['info'](_0x3dd685(0x1cb)+JSON['stringify'](_0x2522f7));}async function runBaselineDriftAnalysis(_0x46c272){const _0x52cb95=a0_0xfba026;if(!_0x46c272[_0x52cb95(0x255)]||!_0x46c272[_0x52cb95(0x1c9)])return;const _0x10f35=_0x46c272[_0x52cb95(0x225)][_0x52cb95(0x262)]||0xe;if(_0x46c272['dailyDigests']['length']<_0x10f35+(_0x46c272['config'][_0x52cb95(0xc1)]||0x7)){await _0x46c272[_0x52cb95(0x1c4)](LTM_DP_DRIFT_STATUS,{'val':_0x52cb95(0x1b2),'ack':!![]});return;}const _0x543a01=_0x46c272[_0x52cb95(0xdb)]['slice'](-_0x10f35),_0x4325a9=_0x46c272[_0x52cb95(0xdb)][_0x52cb95(0xd8)](0x0,_0x46c272[_0x52cb95(0xdb)][_0x52cb95(0xd4)]-_0x10f35),_0x4fb471=_0x52cb95(0xf7)+JSON['stringify'](_0x4325a9)+_0x52cb95(0xbc)+JSON[_0x52cb95(0x1da)](_0x543a01);try{const _0x1ee7c4=await _0x46c272[_0x52cb95(0x1c9)][_0x52cb95(0x1c3)](_0x4fb471),_0x2cd879=JSON['parse'](_0x1ee7c4[_0x52cb95(0x228)]['text']()[_0x52cb95(0x1c2)](/```json|```/g,'')[_0x52cb95(0x18e)]());_0x2cd879[_0x52cb95(0x1a4)]&&(await _0x46c272[_0x52cb95(0x1c4)](LTM_DP_DRIFT_STATUS,{'val':_0x2cd879[_0x52cb95(0x1a4)],'ack':!![]}),await _0x46c272['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x2cd879[_0x52cb95(0xbe)],'ack':!![]}),await _0x46c272[_0x52cb95(0x1c4)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x52cb95(0x12b)](),'ack':!![]}));}catch(_0x5181e6){}}function setupLtmScheduler(_0x4a19e1){const _0xeec986=a0_0xfba026;try{if(_0x4a19e1[_0xeec986(0xb8)])_0x4a19e1[_0xeec986(0xb8)][_0xeec986(0x224)]();if(!_0x4a19e1[_0xeec986(0x255)]){_0x4a19e1[_0xeec986(0x1c4)](LTM_DP_STATUS,{'val':_0xeec986(0x239),'ack':!![]});return;}_0x4a19e1[_0xeec986(0xb8)]=schedule[_0xeec986(0x25a)](LTM_SCHEDULE,()=>createDailyDigest(_0x4a19e1));}catch(_0x269c97){_0x4a19e1[_0xeec986(0x19a)]['error'](_0xeec986(0x159)+_0x269c97[_0xeec986(0xea)]);}}function a0_0x3e03(_0x40ae7e,_0x405063){const _0x442b48=a0_0x150e();return a0_0x3e03=function(_0x242f15,_0x3b697f){_0x242f15=_0x242f15-0xa7;let _0x150e32=_0x442b48[_0x242f15];return _0x150e32;},a0_0x3e03(_0x40ae7e,_0x405063);}function setupModeResetScheduler(_0x1e7e83){const _0x181a00=a0_0xfba026;try{if(_0x1e7e83[_0x181a00(0xf9)])_0x1e7e83[_0x181a00(0xf9)][_0x181a00(0x224)]();_0x1e7e83[_0x181a00(0xf9)]=schedule[_0x181a00(0x25a)](MODE_RESET_SCHEDULE,async()=>{const _0x490217=_0x181a00;await loadSystemMode(_0x1e7e83),AUTO_RESET_MODES['includes'](_0x1e7e83[_0x490217(0x18c)])&&await _0x1e7e83['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x490217(0x28b)],'ack':![]});});}catch(_0x429be8){_0x1e7e83[_0x181a00(0x19a)][_0x181a00(0x246)]('Reset\x20Sched\x20Error:\x20'+_0x429be8[_0x181a00(0xea)]);}}function setupDriftAnalysisScheduler(_0x281ffd){const _0x17c283=a0_0xfba026;try{if(_0x281ffd[_0x17c283(0x2b5)])clearInterval(_0x281ffd[_0x17c283(0x2b5)]);if(!_0x281ffd[_0x17c283(0x255)])return;_0x281ffd['driftAnalysisTimer']=setInterval(()=>runBaselineDriftAnalysis(_0x281ffd),(_0x281ffd['config']['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x281ffd),0x1388);}catch(_0x2d7b38){_0x281ffd[_0x17c283(0x19a)]['error'](_0x17c283(0x21c)+_0x2d7b38[_0x17c283(0xea)]);}}function setupBriefingScheduler(_0x136996){const _0x965498=a0_0xfba026;try{if(_0x136996['briefingJob'])_0x136996['briefingJob'][_0x965498(0x224)]();if(!_0x136996['config']['briefingEnabled'])return;const _0x4f8b7d=(_0x136996[_0x965498(0x225)]['briefingTime']||_0x965498(0xc6))[_0x965498(0x11d)](':'),_0x301df7=parseInt(_0x4f8b7d[0x0])||0x8,_0x44ff5f=parseInt(_0x4f8b7d[0x1])||0x0,_0x44aa5a=_0x44ff5f+'\x20'+_0x301df7+_0x965498(0x1c6);_0x136996[_0x965498(0x19a)][_0x965498(0x1e1)](_0x965498(0x238)+_0x301df7+':'+(_0x44ff5f<0xa?'0'+_0x44ff5f:_0x44ff5f)),_0x136996['briefingJob']=schedule['scheduleJob'](_0x44aa5a,()=>{sendMorningBriefing(_0x136996);});}catch(_0xec416a){_0x136996['log'][_0x965498(0x246)]('Briefing\x20Sched\x20Error:\x20'+_0xec416a[_0x965498(0xea)]);}}async function sendNotification(_0x365f1b,_0xc0731e,_0x36af7b=![],_0x1b506a=![]){const _0xe357ad=a0_0xfba026;_0x365f1b[_0xe357ad(0x19a)]['info']((_0x36af7b?_0xe357ad(0x2a0):'')+'Sending\x20notification:\x20\x22'+_0xc0731e+'\x22');const _0x4a439d=_0x365f1b[_0xe357ad(0x225)];let _0x4eef7c=0x0;if(_0x4a439d[_0xe357ad(0x1ce)]){let _0x3beca9={};(_0xc0731e[_0xe357ad(0x1b7)](_0xe357ad(0x13b))||_0x1b506a)&&(_0x3beca9={'reply_markup':{'inline_keyboard':[[{'text':_0xe357ad(0x16e),'callback_data':_0xe357ad(0x295)}],[{'text':_0xe357ad(0x173),'callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0x365f1b['sendToAsync'](_0x4a439d[_0xe357ad(0x15c)],_0xe357ad(0x16d),{'text':_0xc0731e,'user':_0x4a439d[_0xe357ad(0x15d)],..._0x3beca9}),_0x4eef7c++;}if(_0x4a439d[_0xe357ad(0x130)]){let _0x4f94e2={'message':_0xc0731e,'title':_0x1b506a?_0xe357ad(0x299):_0xe357ad(0xae),'priority':_0x1b506a?0x2:0x1,'device':_0x4a439d[_0xe357ad(0x174)]};_0x1b506a&&(_0x4f94e2['retry']=0x1e,_0x4f94e2[_0xe357ad(0x137)]=0xe10,_0x4f94e2[_0xe357ad(0x291)]=_0xe357ad(0xac)),await _0x365f1b[_0xe357ad(0x266)](_0x4a439d[_0xe357ad(0xf8)],'send',_0x4f94e2),_0x4eef7c++;}return _0x4a439d[_0xe357ad(0x141)]&&(await _0x365f1b[_0xe357ad(0x266)](_0x4a439d[_0xe357ad(0x193)],_0xe357ad(0x16d),{'text':_0xc0731e,'to':_0x4a439d['notifyEmailRecipient']}),_0x4eef7c++),_0x4eef7c;}async function setupTelegramListener(_0x2e5c82){const _0xc167c=a0_0xfba026,_0x31f450=_0x2e5c82[_0xc167c(0x225)][_0xc167c(0x15c)];_0x2e5c82[_0xc167c(0x225)][_0xc167c(0x1ce)]&&_0x31f450&&(_0x2e5c82[_0xc167c(0x19a)][_0xc167c(0x1e1)]('üì°\x20Hooking\x20into\x20'+_0x31f450+_0xc167c(0x240)),await _0x2e5c82[_0xc167c(0x1d4)](_0x31f450+_0xc167c(0x1c7)));}async function handleTelegramResponse(_0x4d4367,_0x534452){const _0x31d179=a0_0xfba026;let _0x376ba1=_0x534452;_0x534452['startsWith']('[')&&(_0x376ba1=_0x534452[_0x31d179(0x25e)](_0x534452[_0x31d179(0x25f)](']')+0x1));if(_0x376ba1===_0x31d179(0x295))_0x4d4367[_0x31d179(0x19a)][_0x31d179(0x1e1)](_0x31d179(0xec)),await _0x4d4367[_0x31d179(0x1c4)](_0x31d179(0xd5),{'val':![],'ack':!![]}),await _0x4d4367[_0x31d179(0x1c4)](_0x31d179(0x2b2),{'val':_0x31d179(0x197),'ack':!![]}),_0x4d4367[_0x31d179(0x14e)]=![],sendNotification(_0x4d4367,_0x31d179(0x13d),![]);else _0x376ba1===_0x31d179(0x1b9)&&(_0x4d4367['log'][_0x31d179(0x22a)](_0x31d179(0x1d2)),sendNotification(_0x4d4367,_0x31d179(0x2a1),![],!![]));}async function runAutopilot(_0x571749){const _0x389031=a0_0xfba026,_0x3a6a9a=_0x571749[_0x389031(0x225)][_0x389031(0x1b3)],_0x10730c=_0x571749[_0x389031(0x170)][_0x389031(0xd4)]>0x0?_0x571749[_0x389031(0x170)][0x0][_0x389031(0xbd)]:Date[_0x389031(0x12b)](),_0x2ccfce=(Date[_0x389031(0x12b)]()-_0x10730c)/(0x3e8*0x3c*0x3c);let _0xc8e348='';_0x571749[_0x389031(0x225)][_0x389031(0x1bc)]&&_0x571749[_0x389031(0x18c)]===SYSTEM_MODES[_0x389031(0x28b)]&&_0x571749['isPresent']&&(_0x2ccfce>_0x3a6a9a&&(_0xc8e348=_0x389031(0x15a)+_0x2ccfce[_0x389031(0xb4)](0x1)+_0x389031(0x13a))),runGeminiAnalysis(_0x571749,_0xc8e348)[_0x389031(0x236)](_0x30b580=>_0x571749[_0x389031(0x19a)][_0x389031(0x246)](_0x30b580));}async function createDailyDigest(_0x3c2f39){const _0xef3e4c=a0_0xfba026;if(!_0x3c2f39[_0xef3e4c(0x255)])return;await _0x3c2f39['setStateAsync'](LTM_DP_STATUS,{'val':_0xef3e4c(0x177)+new Date()[_0xef3e4c(0x110)](),'ack':!![]});if(!_0x3c2f39[_0xef3e4c(0x1c9)]||_0x3c2f39[_0xef3e4c(0x164)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x3c2f39['setStateAsync'](LTM_DP_STATUS,{'val':_0xef3e4c(0x147),'ack':!![]});return;}const _0x3c56e7=JSON[_0xef3e4c(0xfd)](JSON[_0xef3e4c(0x1da)](_0x3c2f39['rawEventLog'])),_0x59ee1b=_0x3c56e7['length'],_0x1622c0=_0xef3e4c(0x1f0)+JSON[_0xef3e4c(0x1da)](_0x3c56e7);try{const _0x42bee2=await _0x3c2f39[_0xef3e4c(0x1c9)][_0xef3e4c(0x1c3)](_0x1622c0),_0x155d5b=JSON['parse'](_0x42bee2[_0xef3e4c(0x228)][_0xef3e4c(0x17b)]()['replace'](/```json|```/g,'')[_0xef3e4c(0x18e)]());_0x155d5b[_0xef3e4c(0xdc)]&&(_0x3c2f39[_0xef3e4c(0xdb)][_0xef3e4c(0x189)]({'timestamp':new Date()[_0xef3e4c(0x18d)](),'eventCount':_0x59ee1b,'summary':_0x155d5b['summary'],'activityLevel':_0x155d5b[_0xef3e4c(0x120)],'systemMode':_0x3c2f39[_0xef3e4c(0x18c)]}),await saveDailyDigests(_0x3c2f39),_0x3c2f39[_0xef3e4c(0x164)]=[],await saveRawEventLog(_0x3c2f39),await _0x3c2f39[_0xef3e4c(0x1c4)](LTM_DP_STATUS,{'val':_0xef3e4c(0x160)+_0x59ee1b+_0xef3e4c(0x25d),'ack':!![]}),runPythonHealthCheck(_0x3c2f39));}catch(_0x33e632){await _0x3c2f39[_0xef3e4c(0x1c4)](LTM_DP_STATUS,{'val':'Error:\x20'+_0x33e632['message'],'ack':!![]});}}async function sendMorningBriefing(_0x5c08f4){const _0x2e0702=a0_0xfba026;if(!_0x5c08f4[_0x2e0702(0x1c9)])return;_0x5c08f4[_0x2e0702(0x19a)][_0x2e0702(0x1e1)](_0x2e0702(0xa9));const _0x1c4934=_0x5c08f4[_0x2e0702(0xdb)][_0x2e0702(0xd4)]>0x0?_0x5c08f4['dailyDigests'][_0x5c08f4[_0x2e0702(0xdb)][_0x2e0702(0xd4)]-0x1]:null,_0x5763bd=_0x1c4934&&_0x1c4934[_0x2e0702(0x172)]?_0x1c4934['health'][_0x2e0702(0x26c)]:_0x2e0702(0xd0),_0x559e49=new Date();_0x559e49[_0x2e0702(0x14a)](0x4,0x0,0x0,0x0);const _0x4d0528=_0x5c08f4[_0x2e0702(0x170)][_0x2e0702(0x191)](_0x4559f6=>new Date(_0x4559f6[_0x2e0702(0xbd)])>_0x559e49),_0x4e45f5=PERSONA_MAPPING[_0x5c08f4[_0x2e0702(0x225)][_0x2e0702(0x1a9)]||_0x2e0702(0x2a3)],_0x3b075d=_0x5c08f4[_0x2e0702(0x225)]['livingContext']||'',_0x3b46c2=await getWeatherContext(_0x5c08f4),_0xcae8c9=await getCalendarContext(_0x5c08f4),_0x22818c=_0x2e0702(0x290)+_0x4e45f5+_0x2e0702(0x23e)+_0x3b075d+_0x2e0702(0x279)+_0x3b46c2+'\x20'+_0xcae8c9+'.\x20DATEN:\x20Schlaf\x20'+_0x5763bd+_0x2e0702(0x1fe)+JSON[_0x2e0702(0x1da)](_0x4d0528['slice'](0x0,0xa))+_0x2e0702(0x27e);try{const _0x522c34=await _0x5c08f4[_0x2e0702(0x1c9)][_0x2e0702(0x1c3)](_0x22818c),_0x17bd42='üåÖ\x20Daily\x20Briefing:\x0a'+_0x522c34[_0x2e0702(0x228)]['text']()[_0x2e0702(0x18e)]();sendNotification(_0x5c08f4,_0x17bd42),_0x5c08f4['log'][_0x2e0702(0x1e1)](_0x2e0702(0x26b));}catch(_0x5453e9){_0x5c08f4[_0x2e0702(0x19a)][_0x2e0702(0x246)](_0x2e0702(0xcf)+_0x5453e9[_0x2e0702(0xea)]);}}async function scanForDevices(_0x2223cf,_0x3f9efe){const _0x13f43d=a0_0xfba026;_0x2223cf['log'][_0x13f43d(0x1e1)](_0x13f43d(0x1a1));const _0xb05699=[],_0x318aeb=await _0x2223cf['getForeignObjectsAsync']('*'),_0x28e9e3=await _0x2223cf[_0x13f43d(0x21f)]('enum.functions.*','enum'),_0x46ee0e=await _0x2223cf['getForeignObjectsAsync']('enum.rooms.*',_0x13f43d(0xe5)),_0x49f758={};if(_0x28e9e3)for(const _0xcf5f2f in _0x28e9e3){const _0x446892=_0x28e9e3[_0xcf5f2f][_0x13f43d(0x2a9)][_0x13f43d(0x12c)]||[];_0x446892['forEach'](_0x513bf4=>{const _0x599dcf=_0x13f43d;if(!_0x49f758[_0x513bf4])_0x49f758[_0x513bf4]=[];_0x49f758[_0x513bf4][_0x599dcf(0x189)](_0xcf5f2f);});}const _0x5c7fb4={};if(_0x46ee0e)for(const _0x134ff5 in _0x46ee0e){const _0xa5b2dd=_0x46ee0e[_0x134ff5][_0x13f43d(0x2a9)][_0x13f43d(0x12c)]||[],_0x145119=typeof _0x46ee0e[_0x134ff5]['common'][_0x13f43d(0xde)]===_0x13f43d(0xf6)?_0x46ee0e[_0x134ff5]['common'][_0x13f43d(0xde)]['de']:_0x46ee0e[_0x134ff5][_0x13f43d(0x2a9)][_0x13f43d(0xde)];_0xa5b2dd[_0x13f43d(0x2b0)](_0x246c55=>_0x5c7fb4[_0x246c55]=_0x145119);}const _0x167495=_0x3f9efe[_0x13f43d(0xff)]||[],_0x278f04=_0x3f9efe[_0x13f43d(0x1dd)]!==![],_0xc4a2e3=_0x3f9efe[_0x13f43d(0xb0)]!==![],_0x58633f=_0x3f9efe[_0x13f43d(0x20c)]!==![],_0x1dc56e=_0x3f9efe[_0x13f43d(0x19b)]===!![],_0x2c4b53=_0x3f9efe['weather']===!![];for(const _0xf2a9d2 in _0x318aeb){const _0x51dc07=_0x318aeb[_0xf2a9d2];if(_0x51dc07['type']!=='state'||!_0x51dc07['common'])continue;if(ADAPTER_BLACKLIST[_0x13f43d(0x244)](_0x289f2c=>_0xf2a9d2[_0x13f43d(0xe1)](_0x289f2c))&&!_0x2c4b53)continue;const _0x2fca0f=(_0x51dc07[_0x13f43d(0x2a9)][_0x13f43d(0xf5)]||'')[_0x13f43d(0x2aa)]();let _0x1c4505=(typeof _0x51dc07[_0x13f43d(0x2a9)][_0x13f43d(0xde)]===_0x13f43d(0xf6)?_0x51dc07[_0x13f43d(0x2a9)][_0x13f43d(0xde)]['de']:_0x51dc07[_0x13f43d(0x2a9)][_0x13f43d(0xde)])||_0xf2a9d2;const _0x3530f8=_0x1c4505[_0x13f43d(0x2aa)]();let _0x33fc0e=![],_0xdee969=![];if(_0x167495[_0x13f43d(0xd4)]>0x0){const _0x3acafd=_0x49f758[_0xf2a9d2]||[],_0x5ea75c=_0xf2a9d2[_0x13f43d(0x11d)]('.')[_0x13f43d(0xd8)](0x0,-0x1)[_0x13f43d(0xfa)]('.'),_0x5ea58a=_0x49f758[_0x5ea75c]||[];(_0x3acafd[_0x13f43d(0x244)](_0x398039=>_0x167495[_0x13f43d(0x1b7)](_0x398039))||_0x5ea58a['some'](_0x115d3a=>_0x167495[_0x13f43d(0x1b7)](_0x115d3a)))&&(_0x33fc0e=!![],_0xdee969=!![]);}if(!_0x33fc0e&&!_0x2c4b53){if(HARD_IGNORE_TERMS[_0x13f43d(0x244)](_0x51b08b=>_0xf2a9d2[_0x13f43d(0x1b7)](_0x51b08b)||_0x3530f8[_0x13f43d(0x1b7)](_0x51b08b['toLowerCase']())))continue;}if(BAD_NAMES[_0x13f43d(0x244)](_0x39566f=>_0x3530f8===_0x39566f||_0x3530f8[_0x13f43d(0x1af)]('.'+_0x39566f))){const _0x1f0d98=_0xf2a9d2[_0x13f43d(0x11d)]('.');if(_0x1f0d98[_0x13f43d(0xd4)]>0x2){const _0xc339c=_0x1f0d98['slice'](0x0,-0x1)[_0x13f43d(0xfa)]('.'),_0x8ad178=_0x318aeb[_0xc339c];if(_0x8ad178&&_0x8ad178['common']&&_0x8ad178[_0x13f43d(0x2a9)][_0x13f43d(0xde)]){const _0x4105f8=typeof _0x8ad178['common']['name']===_0x13f43d(0xf6)?_0x8ad178[_0x13f43d(0x2a9)][_0x13f43d(0xde)]['de']:_0x8ad178[_0x13f43d(0x2a9)]['name'];_0x4105f8&&!_0x1c4505[_0x13f43d(0x1b7)](_0x4105f8)&&(_0x1c4505=_0x4105f8+'\x20'+_0x1c4505);}}}let _0x44f7b3='';if(_0x278f04&&(_0x2fca0f['includes']('motion')||_0x2fca0f[_0x13f43d(0x1b7)](_0x13f43d(0xc2))||_0x3530f8[_0x13f43d(0x1b7)]('bewegung')||_0x3530f8[_0x13f43d(0x1b7)](_0x13f43d(0x2b1))))_0x44f7b3='motion';else{if(!_0x44f7b3&&_0xc4a2e3&&(_0x2fca0f[_0x13f43d(0x1b7)](_0x13f43d(0x18f))||_0x2fca0f[_0x13f43d(0x1b7)](_0x13f43d(0x17e))||_0x2fca0f[_0x13f43d(0x1b7)](_0x13f43d(0x260))||_0x2fca0f[_0x13f43d(0x1b7)](_0x13f43d(0x148))||_0x2fca0f[_0x13f43d(0x1b7)](_0x13f43d(0x10a))||_0x3530f8[_0x13f43d(0x1b7)](_0x13f43d(0x272))||_0x3530f8[_0x13f43d(0x1b7)]('t√ºr')||_0x3530f8[_0x13f43d(0x1b7)](_0x13f43d(0x1b6))))_0x44f7b3=_0x13f43d(0x18f);else{if(!_0x44f7b3&&_0x58633f&&(_0x2fca0f[_0x13f43d(0x1b7)]('light')||_0x2fca0f['includes'](_0x13f43d(0x158))||_0x2fca0f['includes']('dimmer')||_0x3530f8['includes'](_0x13f43d(0x2b8))||_0x3530f8[_0x13f43d(0x1b7)](_0x13f43d(0x274))||_0x3530f8[_0x13f43d(0x1b7)](_0x13f43d(0x258)))){if(_0x51dc07[_0x13f43d(0x2a9)]['write']||_0x2fca0f[_0x13f43d(0x1b7)](_0x13f43d(0x269)))_0x44f7b3=_0x13f43d(0x1ac);}else{if(!_0x44f7b3&&_0x1dc56e&&(_0x2fca0f['includes'](_0x13f43d(0x19b))||_0x2fca0f['includes'](_0x13f43d(0x1b4))||_0x2fca0f[_0x13f43d(0x1b7)](_0x13f43d(0x122))||_0x3530f8[_0x13f43d(0x1b7)]('temp')||_0x3530f8[_0x13f43d(0x1b7)](_0x13f43d(0x184))||_0x3530f8['includes'](_0x13f43d(0xc8))))_0x44f7b3=_0x13f43d(0x19b);else{if(!_0x44f7b3&&_0xdee969)_0x44f7b3=_0x13f43d(0x286);}}}}if(_0x44f7b3){let _0x517c41=_0x5c7fb4[_0xf2a9d2]||'';if(!_0x517c41){let _0x3c2b1e=_0xf2a9d2;for(let _0x2a2d89=0x0;_0x2a2d89<0x3;_0x2a2d89++){const _0x55ca51=_0x3c2b1e[_0x13f43d(0x221)]('.');if(_0x55ca51===-0x1)break;_0x3c2b1e=_0x3c2b1e[_0x13f43d(0x25e)](0x0,_0x55ca51);if(_0x5c7fb4[_0x3c2b1e]){_0x517c41=_0x5c7fb4[_0x3c2b1e];break;}}}_0xb05699['push']({'id':_0xf2a9d2,'name':_0x1c4505,'location':_0x517c41,'type':_0x44f7b3,'logDuplicates':_0x44f7b3===_0x13f43d(0x1dd),'isExit':![],'_score':_0x517c41?0x50:_0x44f7b3==='custom'?0x5a:0x28});}}return _0xb05699['sort']((_0x513704,_0xb8109)=>_0xb8109['_score']-_0x513704[_0x13f43d(0x190)]),_0xb05699;}async function executeAutomationAction(_0x515ed7){const _0x19ed4b=a0_0xfba026;try{const _0x5458c7=await _0x515ed7[_0x19ed4b(0x199)]('analysis.automation.targetId'),_0x61a571=await _0x515ed7[_0x19ed4b(0x199)](_0x19ed4b(0x277));if(_0x5458c7&&_0x5458c7[_0x19ed4b(0x213)]&&_0x61a571){const _0x51e3d0=_0x5458c7[_0x19ed4b(0x213)];let _0xb9e9bb=_0x61a571[_0x19ed4b(0x213)];try{_0xb9e9bb=JSON['parse'](_0xb9e9bb);}catch(_0x291838){}_0x515ed7[_0x19ed4b(0x19a)]['info'](_0x19ed4b(0x29d)+_0x51e3d0+_0x19ed4b(0x24c)+_0xb9e9bb),await _0x515ed7['setForeignStateAsync'](_0x51e3d0,_0xb9e9bb);}else _0x515ed7[_0x19ed4b(0x19a)][_0x19ed4b(0x22a)](_0x19ed4b(0x11a));}catch(_0x1367dd){_0x515ed7['log'][_0x19ed4b(0x246)]('BUTLER\x20Execution\x20Error:\x20'+_0x1367dd[_0x19ed4b(0xea)]);}}function tryParse(_0x44bf2d){const _0x5c1477=a0_0xfba026;try{return JSON[_0x5c1477(0xfd)](_0x44bf2d);}catch(_0x539398){return null;}}async function recordSequence(_0x574675,_0x8262b0){const _0x242250=a0_0xfba026,_0x5088d2=(_0x8262b0[_0x242250(0x19f)]||'')['toLowerCase'](),_0x445356=[_0x242250(0x1dd),_0x242250(0xab),_0x242250(0x2b1),_0x242250(0x22b),'occupancy',_0x242250(0x18f),_0x242250(0x150),_0x242250(0x17e),_0x242250(0x272),_0x242250(0x1e2),_0x242250(0x294),_0x242250(0x1ac),_0x242250(0x2b8),_0x242250(0x158),_0x242250(0x258),'dimmer',_0x242250(0x274)];if(!_0x445356[_0x242250(0x244)](_0x803cfe=>_0x5088d2['includes'](_0x803cfe))){_0x574675['log'][_0x242250(0xe3)](_0x242250(0xb7)+_0x8262b0['id']+_0x242250(0x1cf)+_0x8262b0[_0x242250(0x19f)]+_0x242250(0x1f2));return;}if(!_0x8262b0['value']){_0x574675[_0x242250(0x19a)][_0x242250(0xe3)]('[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20'+_0x8262b0['id']+'\x20(Value\x20is\x20falsy:\x20'+_0x8262b0[_0x242250(0x1c1)]+')');return;}_0x574675[_0x242250(0x19a)][_0x242250(0xe3)](_0x242250(0x247)+_0x8262b0['id']+'\x20('+_0x8262b0[_0x242250(0x19d)]+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0x592d81={'loc':_0x8262b0[_0x242250(0x19d)]||_0x242250(0x1fc),'id':_0x8262b0['id'],'ts':Date['now']()};activeSequence[_0x242250(0x189)](_0x592d81),_0x574675[_0x242250(0x19a)][_0x242250(0xe3)](_0x242250(0x161)+_0x592d81['loc']+'\x20(Length:\x20'+activeSequence[_0x242250(0xd4)]+')'),sequenceTimer=setTimeout(async()=>{const _0x371e16=_0x242250;activeSequence[_0x371e16(0xd4)]>0x1?await saveCompletedSequence(_0x574675):(_0x574675[_0x371e16(0x19a)]['debug'](_0x371e16(0x11f)+activeSequence[_0x371e16(0xd4)]+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0xc4a27a){const _0x2b4bac=a0_0xfba026;try{_0xc4a27a[_0x2b4bac(0x19a)]['info'](_0x2b4bac(0x176)+activeSequence[_0x2b4bac(0xd4)]+').\x20Saving\x20to\x20Training\x20Data.');const _0x3d9f61=await _0xc4a27a[_0x2b4bac(0x199)]('LTM.trainingData.sequences');let _0x26983d=[];if(_0x3d9f61&&_0x3d9f61[_0x2b4bac(0x213)])try{_0x26983d=JSON[_0x2b4bac(0xfd)](_0x3d9f61[_0x2b4bac(0x213)]);}catch(_0x9f5126){}const _0x46c7c7=activeSequence[0x0]['ts'],_0x5e49ac=activeSequence[_0x2b4bac(0x22f)](_0xebbd81=>({'loc':_0xebbd81['loc'],'t_delta':Math[_0x2b4bac(0x1e7)]((_0xebbd81['ts']-_0x46c7c7)/0x3e8)})),_0x41105f={'timestamp':new Date(_0x46c7c7)[_0x2b4bac(0x18d)](),'steps':_0x5e49ac,'duration':Math[_0x2b4bac(0x1e7)]((activeSequence[activeSequence[_0x2b4bac(0xd4)]-0x1]['ts']-_0x46c7c7)/0x3e8),'daytime':new Date(_0x46c7c7)['getHours']()};_0x26983d[_0x2b4bac(0x189)](_0x41105f),_0x26983d[_0x2b4bac(0xd4)]>MAX_TRAINING_SET_SIZE&&_0x26983d[_0x2b4bac(0xb9)](),await _0xc4a27a[_0x2b4bac(0x1c4)](_0x2b4bac(0x23d),{'val':JSON[_0x2b4bac(0x1da)](_0x26983d),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x360208){_0xc4a27a[_0x2b4bac(0x19a)][_0x2b4bac(0x246)](_0x2b4bac(0x135)+_0x360208[_0x2b4bac(0xea)]);}}async function getOutsideTemperatureNumeric(_0x1c4d86){const _0x9ff44a=a0_0xfba026;if(_0x1c4d86[_0x9ff44a(0x225)][_0x9ff44a(0x29f)])try{const _0x10faa1=await _0x1c4d86[_0x9ff44a(0xc5)](_0x1c4d86[_0x9ff44a(0x225)][_0x9ff44a(0x29f)]);if(_0x10faa1&&_0x10faa1[_0x9ff44a(0x213)]!==undefined&&_0x10faa1[_0x9ff44a(0x213)]!==null){const _0x39a9de=parseFloat(_0x10faa1[_0x9ff44a(0x213)]);if(!isNaN(_0x39a9de))return _0x39a9de;}}catch(_0x2a3c66){_0x1c4d86[_0x9ff44a(0x19a)][_0x9ff44a(0x22a)](_0x9ff44a(0xed)+_0x1c4d86[_0x9ff44a(0x225)][_0x9ff44a(0x29f)]+':\x20'+_0x2a3c66['message']);}const _0x3bbbe0=_0x1c4d86['config']['weatherInstance'];if(!_0x1c4d86[_0x9ff44a(0x225)][_0x9ff44a(0x227)]||!_0x3bbbe0)return null;try{let _0x56cf4d='';if(_0x3bbbe0[_0x9ff44a(0x1b7)](_0x9ff44a(0x167)))_0x56cf4d=_0x3bbbe0+_0x9ff44a(0x1e3);else{if(_0x3bbbe0[_0x9ff44a(0x1b7)](_0x9ff44a(0xc0)))_0x56cf4d=_0x3bbbe0+_0x9ff44a(0x146);else{if(_0x3bbbe0[_0x9ff44a(0x1b7)](_0x9ff44a(0x24a)))_0x56cf4d=_0x3bbbe0+_0x9ff44a(0x2af);else{if(_0x3bbbe0[_0x9ff44a(0x1b7)](_0x9ff44a(0x1dc)))_0x56cf4d=_0x3bbbe0+'.forecast.current.temp';}}}if(_0x56cf4d){const _0x35c538=await _0x1c4d86[_0x9ff44a(0xc5)](_0x56cf4d);if(_0x35c538&&_0x35c538[_0x9ff44a(0x213)]!==undefined&&_0x35c538[_0x9ff44a(0x213)]!==null)return parseFloat(_0x35c538[_0x9ff44a(0x213)]);}}catch(_0x366e5e){}return null;}async function recordThermodynamics(_0x170816,_0x4486d,_0x244cc0,_0x42a996){const _0x3a5af1=a0_0xfba026,_0x5b2500=await getOutsideTemperatureNumeric(_0x170816),_0x32df03=await _0x170816['getStateAsync'](_0x3a5af1(0x119));let _0x84a8f6=[];if(_0x32df03&&_0x32df03['val'])try{_0x84a8f6=JSON[_0x3a5af1(0xfd)](_0x32df03[_0x3a5af1(0x213)]);}catch(_0x154315){}_0x84a8f6[_0x3a5af1(0x189)]({'ts':Date['now'](),'room':_0x42a996||_0x3a5af1(0x1fc),'t_in':_0x244cc0,'t_out':_0x5b2500});if(_0x84a8f6[_0x3a5af1(0xd4)]>THERMO_LOG_SIZE)_0x84a8f6[_0x3a5af1(0xb9)]();await _0x170816[_0x3a5af1(0x1c4)](_0x3a5af1(0x119),{'val':JSON['stringify'](_0x84a8f6),'ack':!![]});}async function processSensorEvent(_0x3dd699,_0x5472ff,_0x32dd95,_0x1b9ae7){const _0x8f5ccb=a0_0xfba026;if(!_0x1b9ae7)return;const _0x196bdd=_0x32dd95[_0x8f5ccb(0x213)],_0x44282d=Date[_0x8f5ccb(0x12b)]();_0x3dd699['log'][_0x8f5ccb(0xe3)](_0x8f5ccb(0x27b)+_0x5472ff+_0x8f5ccb(0x24c)+_0x196bdd);const _0x69fd7=_0x3dd699[_0x8f5ccb(0x297)][_0x5472ff];_0x3dd699[_0x8f5ccb(0x297)][_0x5472ff]=_0x196bdd;if(!_0x1b9ae7[_0x8f5ccb(0x1d6)]&&_0x69fd7!=undefined&&_0x69fd7==_0x196bdd){_0x3dd699[_0x8f5ccb(0x19a)][_0x8f5ccb(0xe3)]('IGNORING\x20DUPLICATE\x20(Cached):\x20'+_0x1b9ae7[_0x8f5ccb(0xde)]+_0x8f5ccb(0x287)+_0x196bdd+')');return;}_0x3dd699[_0x8f5ccb(0x255)]&&_0x1b9ae7[_0x8f5ccb(0x19f)]===_0x8f5ccb(0x19b)&&recordThermodynamics(_0x3dd699,_0x5472ff,_0x196bdd,_0x1b9ae7[_0x8f5ccb(0x19d)]);const _0x43eff2={'timestamp':_0x44282d,'id':_0x5472ff,'name':_0x1b9ae7[_0x8f5ccb(0xde)],'type':_0x1b9ae7[_0x8f5ccb(0x19f)],'location':_0x1b9ae7[_0x8f5ccb(0x19d)],'value':_0x196bdd};_0x3dd699[_0x8f5ccb(0x170)]['unshift'](_0x43eff2);if(_0x3dd699[_0x8f5ccb(0x170)][_0x8f5ccb(0xd4)]>HISTORY_MAX_SIZE)_0x3dd699[_0x8f5ccb(0x170)][_0x8f5ccb(0xa7)]();await _0x3dd699[_0x8f5ccb(0x1c4)]('events.lastEvent',{'val':JSON[_0x8f5ccb(0x1da)](_0x43eff2),'ack':!![]}),await _0x3dd699['setStateAsync'](_0x8f5ccb(0x245),{'val':JSON[_0x8f5ccb(0x1da)](_0x3dd699[_0x8f5ccb(0x170)]),'ack':!![]});_0x3dd699[_0x8f5ccb(0x255)]&&(_0x3dd699[_0x8f5ccb(0x164)][_0x8f5ccb(0x189)](_0x43eff2),await saveRawEventLog(_0x3dd699),recordSequence(_0x3dd699,_0x43eff2));if(_0x1b9ae7['isExit']&&_0x196bdd===!![]){if(_0x3dd699[_0x8f5ccb(0x145)]&&!_0x3dd699[_0x8f5ccb(0x16c)])_0x3dd699['log'][_0x8f5ccb(0x1e1)](_0x8f5ccb(0x223)+_0x1b9ae7['name']+').\x20Starting\x20Timer.'),startExitTimer(_0x3dd699);else!_0x3dd699['isPresent']&&(_0x3dd699[_0x8f5ccb(0x19a)][_0x8f5ccb(0x1e1)](_0x8f5ccb(0x2b6)+_0x1b9ae7[_0x8f5ccb(0xde)]+_0x8f5ccb(0x1eb)),await setPresence(_0x3dd699,!![]));}else _0x1b9ae7['type']===_0x8f5ccb(0x1dd)&&_0x196bdd===!![]&&(_0x3dd699[_0x8f5ccb(0xe9)]&&(_0x3dd699[_0x8f5ccb(0x19a)][_0x8f5ccb(0x1e1)](_0x8f5ccb(0x1a6)),abortExitTimer(_0x3dd699)),!_0x3dd699['isPresent']&&_0x3dd699[_0x8f5ccb(0x18c)]===SYSTEM_MODES[_0x8f5ccb(0x28b)]&&await setPresence(_0x3dd699,!![]));}async function runGeminiAnalysis(_0x2849f8,_0x2c010e=''){const _0x1a0ef0=a0_0xfba026;if(!_0x2849f8[_0x1a0ef0(0x1c9)])return;if(_0x2849f8[_0x1a0ef0(0x170)]['length']===0x0)return;const _0x4accd7=_0x2849f8['eventHistory'][_0x1a0ef0(0xd8)](0x0,0xf),_0x3ad896=await getWeatherContext(_0x2849f8),_0x302fb8=_0x2849f8[_0x1a0ef0(0x18c)],_0x2c2c46=PERSONA_MAPPING[_0x2849f8[_0x1a0ef0(0x225)][_0x1a0ef0(0x1a9)]||_0x1a0ef0(0x2a3)],_0x1ccd61=_0x2849f8[_0x1a0ef0(0x225)][_0x1a0ef0(0xb6)]||_0x1a0ef0(0x169);let _0x21419f=![];try{const _0xd9e03e=await _0x2849f8[_0x1a0ef0(0x199)](_0x1a0ef0(0x24f));if(_0xd9e03e&&_0xd9e03e[_0x1a0ef0(0x213)])_0x21419f=!![];}catch(_0x2bf6b4){}const _0x540c88='\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20'+_0x2c2c46+_0x1a0ef0(0x1f5)+_0x1ccd61+_0x1a0ef0(0x20a)+_0x302fb8+_0x1a0ef0(0x27d)+_0x3ad896+'.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20'+(_0x2c010e||_0x1a0ef0(0xad))+_0x1a0ef0(0x20e)+JSON[_0x1a0ef0(0x1da)](_0x4accd7)+_0x1a0ef0(0x14f);try{const _0x3af76c=await _0x2849f8[_0x1a0ef0(0x1c9)][_0x1a0ef0(0x1c3)](_0x540c88),_0x386bd4=_0x3af76c[_0x1a0ef0(0x228)][_0x1a0ef0(0x17b)]()[_0x1a0ef0(0x1c2)](/```json|```/g,'')[_0x1a0ef0(0x18e)](),_0x437a1a=JSON[_0x1a0ef0(0xfd)](_0x386bd4);await _0x2849f8[_0x1a0ef0(0x1c4)](_0x1a0ef0(0x15b),{'val':JSON['stringify'](_0x437a1a),'ack':!![]});_0x437a1a[_0x1a0ef0(0xdc)]&&await _0x2849f8[_0x1a0ef0(0x1c4)](_0x1a0ef0(0x183),{'val':_0x437a1a[_0x1a0ef0(0xdc)],'ack':!![]});const _0x507cc7={'timestamp':Date['now'](),'id':Date[_0x1a0ef0(0x12b)]()[_0x1a0ef0(0x180)](),'analysis':{'activity':{'summary':_0x437a1a[_0x1a0ef0(0xdc)]||'Keine\x20Analyse.','isAlert':_0x437a1a['isAlert']||![],'alertReason':_0x437a1a[_0x1a0ef0(0x10e)]},'comfort':{'automationProposal':_0x437a1a[_0x1a0ef0(0x1e0)]}}};await updateAnalysisHistory(_0x2849f8,_0x507cc7);const _0x34fa61=_0x437a1a[_0x1a0ef0(0x219)]||![];_0x34fa61!==_0x2849f8[_0x1a0ef0(0x14e)]&&(await _0x2849f8[_0x1a0ef0(0x1c4)]('analysis.isAlert',{'val':_0x34fa61,'ack':!![]}),_0x2849f8[_0x1a0ef0(0x14e)]=_0x34fa61,_0x34fa61&&(await _0x2849f8['setStateAsync'](_0x1a0ef0(0x2b2),{'val':_0x437a1a[_0x1a0ef0(0x10e)],'ack':!![]}),sendNotification(_0x2849f8,_0x1a0ef0(0x21d)+_0x437a1a[_0x1a0ef0(0x10e)],![],_0x437a1a[_0x1a0ef0(0x1e6)]))),_0x437a1a['automationProposal']&&_0x437a1a[_0x1a0ef0(0x1e0)][_0x1a0ef0(0x118)]&&_0x437a1a[_0x1a0ef0(0x1e0)][_0x1a0ef0(0x17f)]&&(_0x2849f8[_0x1a0ef0(0x19a)][_0x1a0ef0(0x1e1)]('ü§ñ\x20BUTLER\x20PROPOSAL:\x20'+_0x437a1a[_0x1a0ef0(0x1e0)][_0x1a0ef0(0x1f1)]),await _0x2849f8[_0x1a0ef0(0x1c4)](_0x1a0ef0(0x1bf),{'val':!![],'ack':!![]}),await _0x2849f8[_0x1a0ef0(0x1c4)](_0x1a0ef0(0x2b3),{'val':_0x437a1a[_0x1a0ef0(0x1e0)][_0x1a0ef0(0x1f1)],'ack':!![]}),await _0x2849f8[_0x1a0ef0(0x1c4)]('analysis.automation.targetId',{'val':_0x437a1a['automationProposal'][_0x1a0ef0(0x17f)],'ack':!![]}),await _0x2849f8[_0x1a0ef0(0x1c4)](_0x1a0ef0(0x277),{'val':JSON['stringify'](_0x437a1a[_0x1a0ef0(0x1e0)][_0x1a0ef0(0x131)]),'ack':!![]}),_0x21419f&&(_0x2849f8[_0x1a0ef0(0x19a)][_0x1a0ef0(0x1e1)](_0x1a0ef0(0x284)+_0x437a1a['automationProposal'][_0x1a0ef0(0x17f)]+_0x1a0ef0(0x187)),await executeAutomationAction(_0x2849f8)));}catch(_0x51662a){_0x2849f8[_0x1a0ef0(0x19a)][_0x1a0ef0(0x246)](_0x1a0ef0(0x28c)+_0x51662a[_0x1a0ef0(0xea)]);}}function installPythonDependencies(_0x37e909){const _0x450ac5=a0_0xfba026;if(_0x37e909['dependencyInstallInProgress'])return;_0x37e909['dependencyInstallInProgress']=!![];const _0x2051d7=path[_0x450ac5(0xfa)](__dirname,'python_service',_0x450ac5(0x1f8));_0x37e909['log']['info'](_0x450ac5(0xbb)+_0x2051d7+'...'),stopPythonService(_0x37e909);const _0xd6592e='python3\x20-m\x20pip\x20install\x20-r\x20\x22'+_0x2051d7+'\x22\x20--break-system-packages';exec(_0xd6592e,(_0x5bab86,_0x257245,_0x4f6ad1)=>{const _0x255079=_0x450ac5;_0x37e909['dependencyInstallInProgress']=![],_0x5bab86?(_0x37e909[_0x255079(0x19a)][_0x255079(0x246)](_0x255079(0x1a5)+_0xd6592e),_0x37e909[_0x255079(0x19a)][_0x255079(0x246)](_0x255079(0x1d3)+(_0x4f6ad1||_0x5bab86['message']))):(_0x37e909[_0x255079(0x19a)][_0x255079(0x1e1)](_0x255079(0x24d)),startPythonService(_0x37e909));});}function a0_0x150e(){const _0x1dea6f=['info.','2082230kUSKbM','analysis.comfortSummary','isAlert','text.alarm','.forecast.current.state','Drift\x20Sched\x20Error:\x20','‚ö†Ô∏è\x20ALARM:\x20','unload','getForeignObjectsAsync','getGenerativeModel','lastIndexOf','guest','Exit\x20Sensor\x20triggered\x20(','cancel','config','analysisInterval','useWeather','response','Lernphase\x20(','warn','presence','uuid','Error\x20checking\x20WiFi:\x20','Normal','map','kill','Feedback\x20Log','system.isPresent','firmware','Party','Logbook','catch','\x20Tage)','Scheduling\x20Morning\x20Briefing\x20for\x20','Deaktiviert\x20(Pro-Feature)','javascript.','onReady','triggerBriefing','LTM.trainingData.sequences','.\x20KONTEXT:\x20','LTM.dailyDigests','\x20for\x20interactive\x20buttons...','analysis.health.trendValue','presenceDevices','telegram','some','events.history','error','[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20','analysis.automation','WETTER\x20ERROR:\x20','openweathermap','Action','\x20=\x20','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','longitude','analysis.automation.autoApply','system.mode','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','getOverviewData','exports','getLtmData','isProVersion','unshift','getForeignObjectAsync','schalter','instance','scheduleJob','Trigger\x20Analysis','KALENDER:\x20Keine\x20Daten','\x20events','substring','indexOf','lock','GUEST','ltmStbWindowDays','TREND_RESULT','analysis.automation.targetId','üêç\x20Guardian\x20Diagnosis\x20(','sendToAsync','lastCheck','systemConfig','sensor','üêç\x20Starting\x20Python\x20Sidecar:\x20','Morning\x20Briefing\x20sent.','sleepScore','vacation','LTM.baselineStatus','Say\x20Hello','_calName','LTM.driftAnalysis.driftDetails','fenster','party','lampe','weatherunderground.0','scanDevices','analysis.automation.targetValue','accuweather.0','.\x20ZUSATZ:\x20','writable','Event\x20received:\x20','LTM.processingStatus','.\x0a\x20\x20\x20\x20WETTER:\x20','.\x20OUTPUT:\x20Nur\x20Text.','WETTER:\x20Keine\x20Daten\x20gefunden','models/gemini-flash-latest','9TlLcgG','Comfort\x20Suggestion','Wetter:\x20Deaktiviert','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','AI\x20Emergency\x20Status','custom','\x20(Value:\x20','system.meta.uuid','Health\x20Notes','analysis.comfortSuggestion','NORMAL','Gemini\x20Analysis\x20Error:\x20','analysis.deviationFromBaseline','devices','testApiKey','ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','sound','\x20min).','Starting\x20Autopilot\x20(','kontakt','COGNI_CONFIRM_OK','geminiApiKey','sensorLastValues','KALENDER\x20ERROR:\x20','üö®\x20EMERGENCY','Description','LTM','cogni-living','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','Sleep\x20Score\x20(0-100)','outdoorSensorId','[TEST]\x20','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','number','generic','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','Guardian:\x20Sending\x20','ltmLtbWindowDays','native','pythonProcess','common','toLowerCase','Last\x20Check','Daily\x20Digests','PRIORIT√ÑT:\x20Sicherheit.','details','.forecast.current.temperature','forEach','pr√§senz','analysis.alertReason','analysis.automation.description','No\x20instance','driftAnalysisTimer','Entry\x20detected\x20via\x20','icons-mfd.','licht','autoApply','analysis.health.restlessness','pop','python_service','Generating\x20Morning\x20Briefing...','.NextHours.Location_1.Day_1.current.symbol_desc','bewegung','siren','Keiner','Cogni-Living','apply','doors','AI\x20Alert\x20Status','power','analysis.health','toFixed','exitGraceTimer','livingContext','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','ltmJob','shift','Thermodynamic\x20Data\x20Points','üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','\x0aSTB:\x20','timestamp','driftDetails','0\x203\x20*\x20*\x20*','daswetter','minDaysForBaseline','occupancy','system','Failed\x20to\x20send\x20to\x20Python:\x20','getForeignStateAsync','08:00','uuid-error','heizung','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','service.py','11624uWwUXK','[PYTHON\x20ERR]\x20','system.','.data.table','Briefing\x20Error:\x20','N/A','namespace','\x20days\x20of\x20activity\x20data\x20to\x20Python...','events.lastEvent','length','analysis.isAlert','systemUUID','echarts.','slice','vis.','Urlaub','dailyDigests','summary','@google/generative-ai','name','getHours','actual_temperature','startsWith','sendTo','debug','time','enum','find','briefingJob','getCalendarNames\x20Error:\x20','exitTimer','message','setObjectNotExistsAsync','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','Error\x20reading\x20outdoor\x20sensor\x20','Baseline\x20Status','getTime','dependencyInstallInProgress','LTM.trainingData','write','callback','analysisHistory','role','object','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','notifyPushoverInstance','modeResetJob','join','update','setState','parse','Error\x20launching\x20Python\x20service:\x20','selectedFunctionIds','172314nNGBKr','Event\x20History','WETTER:\x20','events.history_debug_00','reachable','link_quality','licenseKey','valve','PARTY','path','shutter','unreach','@iobroker/adapter-core','analysis.triggerBriefing','alertReason','Restoring\x20sensor\x20cache\x20from\x20history\x20(','toLocaleString','LTM.triggerDailyDigest','Last\x20raw\x20event','feedbackHistory','analysis.analysisHistory','User\x20dismissed\x20automation\x20proposal.','genAI','brightness','detected','LTM.trainingData.thermodynamics','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','Gast','uuid-not-found','split','analysis.automation.suggestedAction','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','activityLevel',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','thermostat','json','KI-Modell\x20nicht\x20initialisiert','analysis.health.notes','analysis.health.sleepScore','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','Target\x20ID','data','isArray','now','members','KALENDER:\x20Keine\x20relevanten\x20Termine','3CgLIxv','connection','notifyPushoverEnabled','targetValue','LTM.driftAnalysis','(((.+)+)+)+$','PRO-','[RECORDER]\x20Error\x20saving\x20sequence:\x20','[LOG]','expire','apiKey','Aktiv\x20(','\x20hours.\x20Potential\x20incapacitation.','Alarm','submitFeedback','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','string','onUnload','version','notifyEmailEnabled','Drift\x20Analysis','analysis.trigger','button','isPresent','.NextHours.Location_1.Day_1.current.temp_value','Skipped\x20(No\x20AI\x20or\x20Data)','blind','No\x20module\x20named','setHours','Missing\x20data','‚úÖ\x20PRO\x20ACTIVATED','Error\x20in\x20onMessage\x20command\x20','lastAlertState','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','t√ºr','Kein\x20API\x20Key\x20eingegeben.','7UaEKfL','boolean','):\x20','Gemini\x20AI\x20initialized.','Deviation','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','switch','LTM\x20Sched\x20Error:\x20','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','analysis.lastResult','notifyTelegramInstance','notifyTelegramRecipient','10WVLTjr','Auto\x20Apply\x20Rule','Success:\x20Compressed\x20','[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20','Error\x20reading\x20calendar\x20table:\x20','Health\x20&\x20Sleep\x20Analysis','rawEventLog','Adapter','currentposition','accuweather','stderr','Keine\x20Details.','analysisTimer','Trend\x20Diagnosis\x20(Python)','isGracePeriodActive','send','‚úÖ\x20Alles\x20OK\x20(Reset)','üß™\x20Simulating\x20Butler\x20Proposal:\x20','eventHistory','onMessage','health','üìû\x20R√ºckruf\x20anfordern','notifyPushoverRecipient','Processing\x20Status','[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20','Started\x20at\x20','material.','ical.0','System\x20Status\x20&\x20Control','text','Raw\x20Log','enum.functions.*','window','targetId','toString','date','city','analysis.activitySummary','klima','2337368QfuiiP','\x20|\x20','...','delObjectAsync','push','state','üêç\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','currentSystemMode','toISOString','trim','door','_score','filter','status','notifyEmailInstance','261719amKnhN','communicate.request','channel','Vom\x20Benutzer\x20best√§tigt\x20(OK).','\x20presence\x20devices...','getStateAsync','log','temperature','analysis.isEmergency','location','.Summary.Current','type','stateChange','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','Kalender:\x20Deaktiviert','subscribeStates','baselineDrift','‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','system.presenceWho','Activity\x20Summary','aiPersona','Recorded\x20Motion\x20Sequences','getFullYear','light','search','ANALYZE_TREND','endsWith','Analysiere\x20ausgewogen.','triggerDailyDigest','N/A\x20(Learning)','inactivityThresholdHours','humidity','1114760oHmbdB','rollladen','includes','bind','COGNI_REQUEST_CALL','constructor','latitude','inactivityMonitoringEnabled','scriptProblem','indicator.alarm.fire','analysis.automation.patternDetected','splice','value','replace','generateContent','setStateAsync','onStateChange','\x20*\x20*\x20*','.communicate.request','close','geminiModel','0\x204\x20*\x20*\x20*','Feedback\x20saved:\x20','Invalid\x20JSON\x20from\x20Python:\x20','stick_unreach','notifyTelegramEnabled','\x20(Type\x20\x27','\x20sensors...','\x20|\x20Status:\x20','üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!','Details:\x20','subscribeForeignStatesAsync','command','logDuplicates','Pattern\x20Detected','application/json','üêç\x20Stopping\x20Python\x20Sidecar...','stringify','calendarInstance','weatherunderground','motion','cogni-living\x20adapter\x20starting\x20(v','online','automationProposal','info','contact','.Current.Temperature','stdin','Trend\x20Value\x20(%)','isEmergency','round','[RESULT]','Subscribing\x20to\x20','TEST-PRO-KEY','.\x20Welcome\x20home.','unknown','extendObjectAsync','405334wyPKlE','sort','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','description','\x27\x20not\x20in\x20allowed\x20list)','Target\x20Value','setpoint','.\x0a\x20\x20\x20\x20KONTEXT:\x20','getObjectAsync','LTM.rawEventLog','requirements.txt','stdout','dismissAutomation','from','Unknown','set_temperature','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','indicator.alarm','simulateButler','Last\x20Result','flot.','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','\x20events)...','off','ack','analysis.history_debug_00','getMonth','Fehler:\x20','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','energy','lights','[PYTHON]\x20','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','Trigger\x20Action\x20Now','ready','‚ùå\x20FREE\x20MODE','val','VACATION','Gemini\x20Init\x20Error:\x20'];a0_0x150e=function(){return _0x1dea6f;};return a0_0x150e();}function sendToPython(_0x128594,_0x3a350c,_0x34157a={}){const _0x261555=a0_0xfba026;if(!_0x128594[_0x261555(0x2a8)]||!_0x128594[_0x261555(0x2a8)][_0x261555(0x1e4)][_0x261555(0x27a)])return;const _0x938a8=JSON['stringify']({'command':_0x3a350c,..._0x34157a});try{_0x128594[_0x261555(0x2a8)][_0x261555(0x1e4)][_0x261555(0xf2)](_0x938a8+'\x0a');}catch(_0x32b505){_0x128594[_0x261555(0x19a)][_0x261555(0x246)](_0x261555(0xc4)+_0x32b505[_0x261555(0xea)]);}}function runPythonHealthCheck(_0x3a49cb){const _0x38eb2e=a0_0xfba026;if(!_0x3a49cb[_0x38eb2e(0xdb)]||_0x3a49cb[_0x38eb2e(0xdb)][_0x38eb2e(0xd4)]<0x2){_0x3a49cb['log'][_0x38eb2e(0x1e1)](_0x38eb2e(0xc9));return;}const _0x304f25=_0x3a49cb['dailyDigests'][_0x38eb2e(0x22f)](_0x59f298=>{const _0x5108ad=_0x38eb2e,_0x4aa8aa=(_0x59f298['activityLevel']||'')[_0x5108ad(0x2aa)]();return ACTIVITY_LEVEL_MAP[_0x4aa8aa]||0x32;});_0x3a49cb[_0x38eb2e(0x19a)][_0x38eb2e(0x1e1)](_0x38eb2e(0x2a5)+_0x304f25[_0x38eb2e(0xd4)]+_0x38eb2e(0xd2)),sendToPython(_0x3a49cb,_0x38eb2e(0x1ae),{'values':_0x304f25,'tag':'Activity-Level'});}function handlePythonResult(_0x1fb827,_0x332878){const _0xae50c2=a0_0xfba026;if(_0x332878[_0xae50c2(0x19f)]==='PONG')_0x1fb827[_0xae50c2(0x19a)]['debug'](_0xae50c2(0x18b));else{if(_0x332878[_0xae50c2(0x19f)]===_0xae50c2(0x263)){const {tag:_0xcd2d5b,diagnosis:_0x780c32,change_percent:_0x1d9177}=_0x332878['payload'];_0x1fb827[_0xae50c2(0x19a)][_0xae50c2(0x1e1)](_0xae50c2(0x265)+_0xcd2d5b+_0xae50c2(0x154)+_0x780c32+'\x20('+_0x1d9177+'%)'),_0x1fb827[_0xae50c2(0x1c4)]('analysis.health.trendDiagnosis',{'val':_0x780c32,'ack':!![]}),_0x1fb827['setStateAsync']('analysis.health.trendValue',{'val':_0x1d9177,'ack':!![]});}}}function startPythonService(_0x17ddf7){const _0x308411=a0_0xfba026;try{const _0x40d48b=path[_0x308411(0xfa)](__dirname,_0x308411(0xa8),_0x308411(0xca));_0x17ddf7[_0x308411(0x19a)][_0x308411(0x1e1)](_0x308411(0x26a)+_0x40d48b),_0x17ddf7[_0x308411(0x2a8)]=spawn('python3',[_0x40d48b]),_0x17ddf7[_0x308411(0x2a8)][_0x308411(0x1f9)]['on']('data',_0x423e28=>{const _0x5b8970=_0x308411,_0x4c9436=_0x423e28['toString']()[_0x5b8970(0x11d)]('\x0a');_0x4c9436['forEach'](_0x19cb9b=>{const _0x5c9d3e=_0x5b8970,_0x26f799=_0x19cb9b['trim']();if(!_0x26f799)return;if(_0x26f799[_0x5c9d3e(0xe1)](_0x5c9d3e(0x136)))_0x17ddf7[_0x5c9d3e(0x19a)]['debug'](_0x5c9d3e(0x20d)+_0x26f799['substring'](0x5)['trim']());else{if(_0x26f799[_0x5c9d3e(0xe1)](_0x5c9d3e(0x1e8)))try{const _0x432374=JSON[_0x5c9d3e(0xfd)](_0x26f799[_0x5c9d3e(0x25e)](0x8)['trim']());handlePythonResult(_0x17ddf7,_0x432374);}catch(_0x450585){_0x17ddf7['log'][_0x5c9d3e(0x22a)](_0x5c9d3e(0x1cc)+_0x26f799);}}(_0x26f799[_0x5c9d3e(0x1b7)](_0x5c9d3e(0x149))||_0x26f799[_0x5c9d3e(0x1b7)]('Bibliotheken\x20nicht\x20gefunden'))&&(_0x17ddf7[_0x5c9d3e(0x19a)]['warn'](_0x5c9d3e(0x203)),installPythonDependencies(_0x17ddf7));});}),_0x17ddf7[_0x308411(0x2a8)][_0x308411(0x168)]['on'](_0x308411(0x129),_0x2595ed=>{const _0x1dbeb6=_0x308411,_0x4cfe56=_0x2595ed[_0x1dbeb6(0x180)]()[_0x1dbeb6(0x18e)]();_0x17ddf7[_0x1dbeb6(0x19a)][_0x1dbeb6(0x246)](_0x1dbeb6(0xcc)+_0x4cfe56);}),_0x17ddf7[_0x308411(0x2a8)]['on'](_0x308411(0x1c8),_0x1ffaa4=>{const _0x151821=_0x308411;_0x17ddf7[_0x151821(0x19a)][_0x151821(0x1e1)]('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x1ffaa4),_0x17ddf7['pythonProcess']=null;}),_0x17ddf7['pythonProcess']['on']('error',_0x2b616e=>{const _0x28a86c=_0x308411;_0x17ddf7[_0x28a86c(0x19a)][_0x28a86c(0x22a)]('[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20'+_0x2b616e[_0x28a86c(0xea)]);});}catch(_0x1320ab){_0x17ddf7[_0x308411(0x19a)][_0x308411(0x246)](_0x308411(0xfe)+_0x1320ab[_0x308411(0xea)]);}}function stopPythonService(_0x279521){const _0x4d79b2=a0_0xfba026;if(_0x279521[_0x4d79b2(0x2a8)]){_0x279521[_0x4d79b2(0x19a)][_0x4d79b2(0x1e1)](_0x4d79b2(0x1d9));try{_0x279521[_0x4d79b2(0x2a8)][_0x4d79b2(0x230)]();}catch(_0x1472ff){_0x279521['log'][_0x4d79b2(0x22a)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x1472ff['message']);}_0x279521[_0x4d79b2(0x2a8)]=null;}}class CogniLiving extends utils[a0_0xfba026(0x165)]{constructor(_0x17e8c9){const _0x650279=a0_0xfba026;super({..._0x17e8c9,'name':_0x650279(0x29c)}),this[_0x650279(0x170)]=[],this[_0x650279(0xf4)]=[],this[_0x650279(0x113)]=[],this[_0x650279(0x164)]=[],this[_0x650279(0xdb)]=[],this[_0x650279(0x297)]={},this[_0x650279(0x268)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x650279(0x145)]=!![],this['exitTimer']=null,this[_0x650279(0xb5)]=null,this[_0x650279(0x16c)]=![],this['genAI']=null,this[_0x650279(0x1c9)]=null,this[_0x650279(0x18c)]=SYSTEM_MODES[_0x650279(0x28b)],this[_0x650279(0x255)]=![],this[_0x650279(0x14e)]=![],this[_0x650279(0xd6)]=_0x650279(0x1ec),this[_0x650279(0x16a)]=null,this['ltmJob']=null,this[_0x650279(0xf9)]=null,this[_0x650279(0x2b5)]=null,this[_0x650279(0xe7)]=null,this['pythonProcess']=null,this[_0x650279(0xf0)]=![],this['on'](_0x650279(0x211),this['onReady'][_0x650279(0x1b8)](this)),this['on'](_0x650279(0x1a0),this['onStateChange'][_0x650279(0x1b8)](this)),this['on'](_0x650279(0x21e),this[_0x650279(0x13f)][_0x650279(0x1b8)](this)),this['on'](_0x650279(0xea),this['onMessage'][_0x650279(0x1b8)](this));}async[a0_0xfba026(0x23b)](){const _0x2edb01=a0_0xfba026;this['log']['info'](_0x2edb01(0x1de)+this[_0x2edb01(0x140)]+_0x2edb01(0x121)),await initZombies(this),this[_0x2edb01(0x225)][_0x2edb01(0x106)]=this['config'][_0x2edb01(0x106)]||'';try{this['isProVersion']=await checkLicense(this,this[_0x2edb01(0x225)]['licenseKey']);}catch(_0x2160c7){}this[_0x2edb01(0x19a)][_0x2edb01(0x1e1)]('[LICENSE\x20CHECK]\x20Key\x20present:\x20'+!!this['config']['licenseKey']+_0x2edb01(0x1d1)+(this['isProVersion']?_0x2edb01(0x14c):_0x2edb01(0x212)));if(!this['config'][_0x2edb01(0x1b3)]||this[_0x2edb01(0x225)][_0x2edb01(0x1b3)]<0.1)this[_0x2edb01(0x225)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x2edb01(0x225)][_0x2edb01(0x296)])try{this[_0x2edb01(0x116)]=new GoogleGenerativeAI(this[_0x2edb01(0x225)][_0x2edb01(0x296)]),this[_0x2edb01(0x1c9)]=this[_0x2edb01(0x116)][_0x2edb01(0x220)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x2edb01(0x1d8)}}),this[_0x2edb01(0x19a)][_0x2edb01(0x1e1)](_0x2edb01(0x155));}catch(_0x5086b9){this[_0x2edb01(0x19a)][_0x2edb01(0x246)](_0x2edb01(0x215)+_0x5086b9[_0x2edb01(0xea)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this['subscribeStates'](_0x2edb01(0x143)),this[_0x2edb01(0x1a3)](LTM_DP_TRIGGER_DIGEST),this[_0x2edb01(0x1a3)]('system.mode'),this[_0x2edb01(0x1a3)](_0x2edb01(0x10d)),this[_0x2edb01(0x1a3)]('analysis.automation.triggerAction'),this['subscribeStates']('analysis.automation.autoApply'),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x2edb01(0x16a)])clearInterval(this[_0x2edb01(0x16a)]);const _0x34e3d7=this['config'][_0x2edb01(0x226)]||0xf;_0x34e3d7>0x0&&(this[_0x2edb01(0x19a)][_0x2edb01(0x1e1)](_0x2edb01(0x293)+_0x34e3d7+_0x2edb01(0x292)),this[_0x2edb01(0x16a)]=setInterval(()=>{runAutopilot(this);},_0x34e3d7*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x47244a=_0x2edb01;this[_0x47244a(0x2a8)]&&runPythonHealthCheck(this);},0x1388);}['onUnload'](_0x1892bb){const _0x5c1b90=a0_0xfba026;if(this['analysisTimer'])clearInterval(this[_0x5c1b90(0x16a)]);if(this[_0x5c1b90(0x2b5)])clearInterval(this['driftAnalysisTimer']);if(this['ltmJob'])this['ltmJob'][_0x5c1b90(0x224)]();if(this[_0x5c1b90(0xf9)])this[_0x5c1b90(0xf9)][_0x5c1b90(0x224)]();if(this['briefingJob'])this[_0x5c1b90(0xe7)][_0x5c1b90(0x224)]();if(this[_0x5c1b90(0xe9)])clearTimeout(this[_0x5c1b90(0xe9)]);if(this[_0x5c1b90(0xb5)])clearTimeout(this[_0x5c1b90(0xb5)]);stopPythonService(this),_0x1892bb();}async[a0_0xfba026(0x1c5)](_0x33dc5a,_0x1c4745){const _0x5948bc=a0_0xfba026;if(!_0x1c4745)return;if(_0x33dc5a['includes'](_0x5948bc(0x243))&&_0x33dc5a[_0x5948bc(0x1af)](_0x5948bc(0x195))&&_0x1c4745[_0x5948bc(0x213)]){await handleTelegramResponse(this,_0x1c4745['val']);return;}if(_0x33dc5a===this[_0x5948bc(0xd1)]+'.'+SYSTEM_DP_MODE){_0x1c4745[_0x5948bc(0x213)]&&Object['values'](SYSTEM_MODES)[_0x5948bc(0x1b7)](_0x1c4745[_0x5948bc(0x213)])&&(this[_0x5948bc(0x18c)]=_0x1c4745[_0x5948bc(0x213)],_0x1c4745['val']===SYSTEM_MODES[_0x5948bc(0x214)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x1c4745[_0x5948bc(0x206)])this[_0x5948bc(0xfc)](_0x33dc5a,{'val':this[_0x5948bc(0x18c)],'ack':!![]});return;}if(!_0x1c4745['ack']){_0x33dc5a['includes'](_0x5948bc(0x143))&&_0x1c4745[_0x5948bc(0x213)]&&(this[_0x5948bc(0xfc)](_0x33dc5a,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x33dc5a[_0x5948bc(0x1b7)](_0x5948bc(0x1b1))&&_0x1c4745[_0x5948bc(0x213)]){this['setState'](_0x33dc5a,{'val':![],'ack':!![]});if(this[_0x5948bc(0x255)])createDailyDigest(this);}_0x33dc5a['includes'](_0x5948bc(0x23c))&&_0x1c4745[_0x5948bc(0x213)]&&(this[_0x5948bc(0xfc)](_0x33dc5a,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x33dc5a['includes']('automation.triggerAction')&&_0x1c4745['val']&&(this[_0x5948bc(0xfc)](_0x33dc5a,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x5948bc(0x225)][_0x5948bc(0x242)]&&this[_0x5948bc(0x225)][_0x5948bc(0x242)][_0x5948bc(0x1b7)](_0x33dc5a)){await checkWifiPresence(this);return;}const _0x26603e=(this[_0x5948bc(0x225)][_0x5948bc(0x28e)]||[])[_0x5948bc(0xe6)](_0x5a0c72=>_0x5a0c72['id']===_0x33dc5a);if(_0x26603e)processSensorEvent(this,_0x33dc5a,_0x1c4745,_0x26603e);}async[a0_0xfba026(0x171)](_0x15bf85){const _0x3aac8a=a0_0xfba026;if(typeof _0x15bf85===_0x3aac8a(0xf6)&&_0x15bf85[_0x3aac8a(0xea)])try{if(_0x15bf85['command']===_0x3aac8a(0x28f)){const _0x4c6e70=_0x15bf85[_0x3aac8a(0xea)][_0x3aac8a(0x138)]||this[_0x3aac8a(0x225)][_0x3aac8a(0x296)];if(!_0x4c6e70)return this['sendTo'](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':![],'message':_0x3aac8a(0x151)},_0x15bf85['callback']);try{const _0x2c4dc1=new GoogleGenerativeAI(_0x4c6e70),_0x1bc4a1=_0x2c4dc1[_0x3aac8a(0x220)]({'model':GEMINI_MODEL}),_0x57293f=await _0x1bc4a1[_0x3aac8a(0x1c3)](_0x3aac8a(0x26f)),_0x2b536f=await _0x57293f[_0x3aac8a(0x228)],_0x5979b4=_0x2b536f['text']();this[_0x3aac8a(0xe2)](_0x15bf85['from'],_0x15bf85[_0x3aac8a(0x1d5)],{'success':!![],'message':'Verbindung\x20erfolgreich!\x20Antwort:\x20'+_0x5979b4[_0x3aac8a(0x25e)](0x0,0x14)+_0x3aac8a(0x187)},_0x15bf85['callback']);}catch(_0x8ec39a){this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85['command'],{'success':![],'message':_0x3aac8a(0x209)+_0x8ec39a['message']},_0x15bf85[_0x3aac8a(0xf3)]);}}else{if(_0x15bf85[_0x3aac8a(0x1d5)]==='testNotification'){}else{if(_0x15bf85['command']===_0x3aac8a(0x254)){if(!this[_0x3aac8a(0x255)])return this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':![],'isPro':![]},_0x15bf85['callback']);let _0x1288b0={'status':_0x3aac8a(0xd0),'details':'','lastCheck':0x0};try{_0x1288b0['status']=(await this[_0x3aac8a(0x199)](LTM_DP_DRIFT_STATUS))['val'],_0x1288b0[_0x3aac8a(0x2ae)]=(await this[_0x3aac8a(0x199)](LTM_DP_DRIFT_DETAILS))[_0x3aac8a(0x213)],_0x1288b0[_0x3aac8a(0x267)]=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x3aac8a(0x213)];}catch(_0x13098e){}const _0x46566a=this[_0x3aac8a(0xf4)]||[];this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x1288b0,'analysisHistory':_0x46566a},_0x15bf85[_0x3aac8a(0xf3)]);}else{if(_0x15bf85[_0x3aac8a(0x1d5)]===_0x3aac8a(0x252)){const _0x5e1afd=this[_0x3aac8a(0xdb)]['length'],_0x3dfeea=new Date(),_0x19e9ff=new Date(_0x3dfeea[_0x3aac8a(0x1ab)](),_0x3dfeea[_0x3aac8a(0x208)](),_0x3dfeea['getDate']())['getTime'](),_0x168fce=this[_0x3aac8a(0x164)][_0x3aac8a(0x191)](_0x86b7b=>new Date(_0x86b7b[_0x3aac8a(0xbd)])[_0x3aac8a(0xef)]()>_0x19e9ff)['length'],_0x50dc47=new Array(0x18)['fill'](0x0);this['rawEventLog']['forEach'](_0x1b2df7=>{const _0x48e677=_0x3aac8a,_0xb4fa50=new Date(_0x1b2df7[_0x48e677(0xbd)]);if(_0xb4fa50[_0x48e677(0xef)]()>_0x19e9ff)_0x50dc47[_0xb4fa50[_0x48e677(0xdf)]()]++;});let _0x1ff2f8={'status':_0x3aac8a(0xd0)};try{_0x1ff2f8['status']=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))[_0x3aac8a(0x213)];}catch(_0x10cfb2){}let _0x220d4b='';try{const _0x2344ed=await this[_0x3aac8a(0x199)](_0x3aac8a(0x1a7));_0x220d4b=_0x2344ed?_0x2344ed['val']:'';}catch(_0x284a0d){}let _0x1f2b6b=null;!this[_0x3aac8a(0x1c9)]&&(_0x1f2b6b=this[_0x3aac8a(0x225)]['geminiApiKey']?_0x3aac8a(0x124):'Kein\x20API\x20Key!');let _0x28e43a={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x27d611=await this[_0x3aac8a(0x199)](_0x3aac8a(0x1bf)),_0x29c004=await this[_0x3aac8a(0x199)](_0x3aac8a(0x2b3)),_0x27c635=await this['getStateAsync']('analysis.automation.targetId'),_0x30edae=await this[_0x3aac8a(0x199)](_0x3aac8a(0x277)),_0xca284e=await this[_0x3aac8a(0x199)](_0x3aac8a(0x24f));_0x27d611&&_0x27d611[_0x3aac8a(0x213)]&&(_0x28e43a[_0x3aac8a(0x118)]=!![],_0x28e43a[_0x3aac8a(0x1f1)]=_0x29c004?_0x29c004[_0x3aac8a(0x213)]:'',_0x28e43a[_0x3aac8a(0x17f)]=_0x27c635?_0x27c635[_0x3aac8a(0x213)]:'',_0x28e43a[_0x3aac8a(0x131)]=_0x30edae?_0x30edae[_0x3aac8a(0x213)]:''),_0x28e43a[_0x3aac8a(0x2b9)]=_0xca284e?!!_0xca284e[_0x3aac8a(0x213)]:![];}catch(_0xf27467){}this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':!![],'eventHistory':this[_0x3aac8a(0x170)][_0x3aac8a(0xd8)](0x0,0xf),'stats':{'digestCount':_0x5e1afd,'eventCountToday':_0x168fce,'hourlyActivity':_0x50dc47,'driftStatus':_0x1ff2f8[_0x3aac8a(0x192)],'isPresent':this[_0x3aac8a(0x145)],'presenceWho':_0x220d4b,'minDays':this[_0x3aac8a(0x225)][_0x3aac8a(0xc1)]||0x7,'stbDays':this['config'][_0x3aac8a(0x262)]||0xe,'ltbDays':this[_0x3aac8a(0x225)]['ltmLtbWindowDays']||0x3c,'systemError':_0x1f2b6b},'automation':_0x28e43a},_0x15bf85['callback']);}else{if(_0x15bf85[_0x3aac8a(0x1d5)]==='getEnums'){const _0x55c4ce=await this['getForeignObjectsAsync'](_0x3aac8a(0x17d),_0x3aac8a(0xe5)),_0x2f23c7=[];if(_0x55c4ce)for(const _0x300694 in _0x55c4ce){const _0x15cc59=_0x55c4ce[_0x300694],_0x473eba=(_0x15cc59[_0x3aac8a(0x2a9)]&&typeof _0x15cc59[_0x3aac8a(0x2a9)][_0x3aac8a(0xde)]===_0x3aac8a(0xf6)?_0x15cc59[_0x3aac8a(0x2a9)][_0x3aac8a(0xde)]['de']:_0x15cc59[_0x3aac8a(0x2a9)][_0x3aac8a(0xde)])||_0x15cc59[_0x3aac8a(0x2a9)][_0x3aac8a(0xde)];_0x2f23c7[_0x3aac8a(0x189)]({'id':_0x300694,'name':_0x473eba});}this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':!![],'enums':_0x2f23c7},_0x15bf85['callback']);}else{if(_0x15bf85[_0x3aac8a(0x1d5)]===_0x3aac8a(0x276))try{const _0x141acf=await scanForDevices(this,_0x15bf85[_0x3aac8a(0xea)]||{});this['sendTo'](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':!![],'devices':_0x141acf},_0x15bf85['callback']);}catch(_0x52b0c7){this['sendTo'](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':![],'error':_0x52b0c7[_0x3aac8a(0xea)]},_0x15bf85[_0x3aac8a(0xf3)]);}else{if(_0x15bf85[_0x3aac8a(0x1d5)]==='getCalendarNames'){const _0x4a5457=_0x15bf85['message'][_0x3aac8a(0x259)];if(!_0x4a5457)return this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':![],'error':_0x3aac8a(0x2b4)},_0x15bf85[_0x3aac8a(0xf3)]);const _0x37bf88=await getCalendarNames(this,_0x4a5457);this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85['command'],{'success':!![],'names':_0x37bf88},_0x15bf85['callback']);}else{if(_0x15bf85[_0x3aac8a(0x1d5)]===_0x3aac8a(0x200)){const {targetId:_0x35cf02,targetValue:_0x445eb8}=_0x15bf85[_0x3aac8a(0xea)];this['log'][_0x3aac8a(0x1e1)](_0x3aac8a(0x16f)+_0x35cf02+_0x3aac8a(0x24c)+_0x445eb8),await this[_0x3aac8a(0x1c4)](_0x3aac8a(0x1bf),{'val':!![],'ack':!![]}),await this[_0x3aac8a(0x1c4)](_0x3aac8a(0x2b3),{'val':_0x3aac8a(0x2a4)+_0x35cf02,'ack':!![]}),await this[_0x3aac8a(0x1c4)](_0x3aac8a(0x264),{'val':_0x35cf02,'ack':!![]}),await this[_0x3aac8a(0x1c4)]('analysis.automation.targetValue',{'val':_0x445eb8,'ack':!![]}),this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':!![]},_0x15bf85[_0x3aac8a(0xf3)]);}else{if(_0x15bf85[_0x3aac8a(0x1d5)]===_0x3aac8a(0x13c)){const {historyId:_0x5a80b4,rating:_0x37f231,comment:_0x41304c,alertReason:_0x4a68c2}=_0x15bf85['message'];_0x5a80b4&&_0x37f231?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x5a80b4,'rating':_0x37f231,'comment':_0x41304c,'alertReason':_0x4a68c2}),this['sendTo'](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85['command'],{'success':!![]},_0x15bf85[_0x3aac8a(0xf3)])):this['sendTo'](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':![],'error':_0x3aac8a(0x14b)},_0x15bf85[_0x3aac8a(0xf3)]);}else _0x15bf85[_0x3aac8a(0x1d5)]===_0x3aac8a(0x1fa)&&(this[_0x3aac8a(0x19a)][_0x3aac8a(0x1e1)](_0x3aac8a(0x115)),await this[_0x3aac8a(0x1c4)](_0x3aac8a(0x1bf),{'val':![],'ack':!![]}),await this[_0x3aac8a(0x1c4)]('analysis.automation.description',{'val':'','ack':!![]}),this[_0x3aac8a(0xe2)](_0x15bf85['from'],_0x15bf85['command'],{'success':!![]},_0x15bf85[_0x3aac8a(0xf3)]));}}}}}}}}}catch(_0x59c94b){this['log'][_0x3aac8a(0x246)](_0x3aac8a(0x14d)+_0x15bf85[_0x3aac8a(0x1d5)]+':\x20'+_0x59c94b['message']);if(_0x15bf85[_0x3aac8a(0xf3)])this[_0x3aac8a(0xe2)](_0x15bf85[_0x3aac8a(0x1fb)],_0x15bf85[_0x3aac8a(0x1d5)],{'success':![],'error':_0x59c94b[_0x3aac8a(0xea)]},_0x15bf85[_0x3aac8a(0xf3)]);}}}if(require['main']!==module)module[a0_0xfba026(0x253)]=_0x10ddf1=>new CogniLiving(_0x10ddf1);else new CogniLiving();