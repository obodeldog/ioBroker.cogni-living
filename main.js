const a0_0x2a75cb=a0_0x4d5d;function a0_0x2d91(){const _0x1a6096=['motion','driftAnalysisTimer','createAllObjects','Room\x20Dwell\x20Time\x20Stats','date','historyJob','toISOString','LTM.dailyDigests','[Integrator]\x20Error:\x20','callback','NORMAL','object','./lib/setup','roomIntegratorTimer','min','toLocaleDateString','add','DAY','infrasoundEnabled','1878056AQwltg','outdoorSensorId','command','utf8','analysis.health.todayRoomDetails','manual','ltmJob','modeResetJob','weatherTempId','\x20events\x20from\x20today...','analysis.prediction.trackerTopRoom','./lib/recorder','namespace','moduleSecurity','analysisHistory','moduleComfort','search','push','setStateAsync','setObjectNotExistsAsync','existsSync','onUnload','testApiKey','error','split','abortExitTimer','keys','parse','response','runAutopilot','Verbindung\x20erfolgreich:\x20','startSystem','stopService','Keine\x20Daten','from','filter','üíæ\x20Saving\x20Daily\x20History\x20for\x20','generateHealthReport','@google/generative-ai','getCalendarNames','checkWifiPresence','getAbsoluteDefaultDataDir','./lib/ai_agent','initSchedules','subscribeForeignStates','triggerGaitAnalysis','rows','analysis.automation.patternDetected','system.adapter.ical.È¶ô','location','version','Room\x20History\x20(24h\x20Buckets)','debug','isSolar','open','SET_LEARNING_MODE','checkSolarCondition','send','max','slice','toLowerCase','sendTo','dependencyInstallInProgress','cleanupGhostInterventions','@iobroker/adapter-core','fill','.json','Guest\x20Mode','getDate','TRAIN_COMFORT','testContext','includes','unload','Corrupt','203970nzPcYS','stateChange','moduleHealth','TRAIN_SECURITY','all','cancel','number','getOverviewData','path','VACATION','getObjectViewAsync','Gemini\x20Init\x20Error:\x20','val','eventHistory','LTM.trainingData.sequences','615Dzfrxh','writeFileSync','calendarName','temperature','comfort','licenseKey','analysis.automation.targetValue','‚Ü∫\x20Replaying\x20','runPythonHealthCheck','times','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','trackerHeartbeat','healthTrendInterval','setDate','getGenerativeModel','replayTodayEvents','./lib/automation','LTM.rawEventLog','analysis.security.learningStatus',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','./lib/scheduler','common','General\x20Activity\x20Trend','name','message','genAI','enum','onReady','executeAutomationAction','analysis.activity.roomStats','system.adapter.','getForeignStateAsync','updateHealthVector','application/json','ready','moduleEnergy','node-schedule','cogni-living\x20adapter\x20starting\x20(v','Lernphase\x20(','history','runGeminiAnalysis','system','loadSystemMode','Aktiv\x20(','onStateChange','refreshCalendar\x20failed:\x20','energy','haust√ºr','üì¶\x20Restored\x20','.data.table','2zuAOwq','./lib/python_bridge','systemConfig','analysis.automation.description','Daily\x20Room\x20Details\x20(48x30min)','getStateAsync','triggerBriefing','cogni-living','apply','state','9057191UBmNMM','communicate.request','reduce','party','Sonne:\x20','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','checkThermostats','handleInfrasound','Party\x20Mode','bootTime','Sec-Training\x20started...','integrateRoomTime','presenceDevices','updateSchedulePreview','No\x20data','substring','91PbrBSt','json','analysis.visualization.pulse','LTM.baselineStatus','lastTrackerEventTime','analysis.activity.roomHistory','string','analysis.energy.warmupSources','analysis.health.geminiNight','exitTimer','door','models/gemini-flash-latest','isGracePeriodActive','join','1816IYGqRx','scheduleJob','refreshCalendar','text','20JhiUuq','analysisTimer','briefingJob','main','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','getForeignObjectsAsync','lastAlertState','checkCalendarTriggers','setHours','round','dailyDigests','triggerInfrasoundCorrelation','telegram','automation.triggerAction','onMessage','createDailyDigest','warn','analysis.health.todayVector','analysis.training.status','saveDailyHistory','sources','protectAiMemory','devices','timestamp','processSensorEvent','(((.+)+)+)+$','todayVector','stringify','type','events.history','\x20Kalender-Adapter\x20gefunden.','isRelevantActivity','Warte\x20auf\x20Analyse...','analysis.training.triggerHealth','analysis.energy.warmupTimes','\x20Tage)','History\x20Save\x20Error:\x20','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','isProVersion','values','üîÆ\x20Energy\x20Prediction\x20triggered\x20(','analysis.automation.targetId','15145616NkpWtR','info','triggerEnergyPrediction','Kein\x20API\x20Key\x20√ºbergeben.','isArray','system.presenceWho','value','‚úÖ\x20History\x20saved:\x20','59\x2023\x20*\x20*\x20*',',\x20Temp:\x20','analysis.training.triggerTopology','inactivityThresholdHours','health','updateTopology','analysis.energy.warmupTargets','Standard','ack','setState','toString','security','log','readFileSync','2392533yMOSxS','analysis.health.geminiDay','Unknown','system.adapter.ical.','minDaysForBaseline','bind','geminiModel','SYSTEM_MODES','triggerEnergyPrediction\x20Error:\x20','sensorLastValues','analysis.security.lastScore','replace','pop','geminiApiKey','analysis.trigger','CALCULATE_HEALTH_TREND','currentSystemMode','5666148HiuoQX','rawEventLog','window','activeModules','Init...','modules','updateLocation','memoryCache','subscribeStates','config','TRAIN_TOPOLOGY','enum.rooms.*','getEnums','endsWith','getHours','scanDevices','analysis.prediction.trackerConfidence','isPresent','./lib/installer','python','apiKey','appendToLog','infrasoundSensorId','length','sendMorningBriefing','now','analyzeWindowOpening'];a0_0x2d91=function(){return _0x1a6096;};return a0_0x2d91();}(function(_0x374e54,_0x41c5c5){const _0x2367a1=a0_0x4d5d,_0x2a96cd=_0x374e54();while(!![]){try{const _0x3f4ca3=-parseInt(_0x2367a1(0x17b))/0x1*(-parseInt(_0x2367a1(0x226))/0x2)+parseInt(_0x2367a1(0x1f8))/0x3+-parseInt(_0x2367a1(0x1a3))/0x4*(-parseInt(_0x2367a1(0x149))/0x5)+-parseInt(_0x2367a1(0x13a))/0x6*(-parseInt(_0x2367a1(0x195))/0x7)+-parseInt(_0x2367a1(0x1d1))/0x8+parseInt(_0x2367a1(0x1e7))/0x9+-parseInt(_0x2367a1(0x1a7))/0xa*(parseInt(_0x2367a1(0x185))/0xb);if(_0x3f4ca3===_0x41c5c5)break;else _0x2a96cd['push'](_0x2a96cd['shift']());}catch(_0x269988){_0x2a96cd['push'](_0x2a96cd['shift']());}}}(a0_0x2d91,0xf1cd6));const a0_0x5481f9=(function(){let _0x1e4632=!![];return function(_0xd5325,_0x528c11){const _0x1e77e8=_0x1e4632?function(){const _0x47d666=a0_0x4d5d;if(_0x528c11){const _0x1bd35a=_0x528c11[_0x47d666(0x183)](_0xd5325,arguments);return _0x528c11=null,_0x1bd35a;}}:function(){};return _0x1e4632=![],_0x1e77e8;};}()),a0_0x5d93be=a0_0x5481f9(this,function(){const _0x324c8d=a0_0x4d5d;return a0_0x5d93be[_0x324c8d(0x1e3)]()['search']('(((.+)+)+)+$')[_0x324c8d(0x1e3)]()['constructor'](a0_0x5d93be)[_0x324c8d(0x100)](_0x324c8d(0x1c0));});a0_0x5d93be();'use strict';const utils=require(a0_0x2a75cb(0x130)),{GoogleGenerativeAI}=require(a0_0x2a75cb(0x116)),path=require(a0_0x2a75cb(0x142)),fs=require('fs'),installer=require(a0_0x2a75cb(0x20a)),scanner=require('./lib/scanner'),schedulers=require(a0_0x2a75cb(0x15d)),topology=require('./lib/topology'),setup=require(a0_0x2a75cb(0x21f)),recorder=require(a0_0x2a75cb(0x231)),pythonBridge=require(a0_0x2a75cb(0x17c)),aiAgent=require(a0_0x2a75cb(0x11a)),deadMan=require('./lib/dead_man'),automation=require(a0_0x2a75cb(0x159)),GEMINI_MODEL=a0_0x2a75cb(0x1a0);class CogniLiving extends utils['Adapter']{constructor(_0x29cee1){const _0x692846=a0_0x2a75cb;super({..._0x29cee1,'name':_0x692846(0x182)}),this[_0x692846(0x147)]=[],this[_0x692846(0xfe)]=[],this[_0x692846(0x1f9)]=[],this[_0x692846(0x1b1)]=[],this[_0x692846(0x1f0)]={},this[_0x692846(0x17d)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x692846(0x209)]=!![],this[_0x692846(0x19e)]=null,this['exitGraceTimer']=null,this[_0x692846(0x1a1)]=![],this[_0x692846(0x162)]=null,this[_0x692846(0x1ed)]=null,this[_0x692846(0x1f7)]=setup[_0x692846(0x1ee)][_0x692846(0x21d)],this['isProVersion']=![],this[_0x692846(0x1ad)]=![],this['analysisTimer']=null,this[_0x692846(0x22c)]=null,this[_0x692846(0x22d)]=null,this[_0x692846(0x214)]=null,this[_0x692846(0x1a9)]=null,this[_0x692846(0x218)]=null,this[_0x692846(0x154)]=null,this[_0x692846(0x155)]=null,this[_0x692846(0x220)]=null,this[_0x692846(0x12e)]=![],this[_0x692846(0x199)]=Date[_0x692846(0x211)](),this[_0x692846(0x1ff)]=null,this['bootTime']=Date[_0x692846(0x211)](),this['infrasoundLocked']=![],this['pressureBuffer']=[],this[_0x692846(0x1fb)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on'](_0x692846(0x16b),this[_0x692846(0x164)][_0x692846(0x1ec)](this)),this['on'](_0x692846(0x13b),this['onStateChange'][_0x692846(0x1ec)](this)),this['on'](_0x692846(0x138),this[_0x692846(0x105)][_0x692846(0x1ec)](this)),this['on'](_0x692846(0x161),this[_0x692846(0x1b5)][_0x692846(0x1ec)](this));}async[a0_0x2a75cb(0x164)](){const _0x59ba3d=a0_0x2a75cb;this[_0x59ba3d(0x1e5)]['info'](_0x59ba3d(0x16e)+this[_0x59ba3d(0x122)]+_0x59ba3d(0x15c));if(this[_0x59ba3d(0x201)][_0x59ba3d(0x13c)]!==undefined)this['activeModules'][_0x59ba3d(0x1dd)]=this['config'][_0x59ba3d(0x13c)];if(this[_0x59ba3d(0x201)][_0x59ba3d(0xfd)]!==undefined)this[_0x59ba3d(0x1fb)][_0x59ba3d(0x1e4)]=this[_0x59ba3d(0x201)][_0x59ba3d(0xfd)];if(this[_0x59ba3d(0x201)][_0x59ba3d(0x16c)]!==undefined)this[_0x59ba3d(0x1fb)][_0x59ba3d(0x177)]=this[_0x59ba3d(0x201)][_0x59ba3d(0x16c)];if(this['config'][_0x59ba3d(0xff)]!==undefined)this[_0x59ba3d(0x1fb)][_0x59ba3d(0x14d)]=this[_0x59ba3d(0x201)]['moduleComfort'];if(this[_0x59ba3d(0x201)][_0x59ba3d(0x1fd)])this[_0x59ba3d(0x1fb)]={...this[_0x59ba3d(0x1fb)],...this[_0x59ba3d(0x201)][_0x59ba3d(0x1fd)]};this['startSystem']();}async[a0_0x2a75cb(0x10f)](){const _0x4c9624=a0_0x2a75cb;await setup['initZombies'](this);try{this[_0x4c9624(0x1cd)]=await setup['checkLicense'](this[_0x4c9624(0x201)][_0x4c9624(0x14e)]);}catch(_0x525402){}if(!this[_0x4c9624(0x201)][_0x4c9624(0x1dc)]||this[_0x4c9624(0x201)][_0x4c9624(0x1dc)]<0.1)this[_0x4c9624(0x201)][_0x4c9624(0x1dc)]=0xc;await setup['initHistory'](this),await setup['initSystemConfig'](this);try{const _0x2fa1ac=await this[_0x4c9624(0x180)](_0x4c9624(0x1c9)),_0x37307d=await this[_0x4c9624(0x180)](_0x4c9624(0x19c));_0x2fa1ac&&_0x2fa1ac['val']&&_0x37307d&&_0x37307d['val']&&(Date['now']()-_0x2fa1ac['ts']<0x4*0xe10*0x3e8&&(this[_0x4c9624(0x1ff)]={'times':JSON[_0x4c9624(0x10b)](_0x2fa1ac[_0x4c9624(0x146)]),'sources':JSON[_0x4c9624(0x10b)](_0x37307d[_0x4c9624(0x146)])}));}catch(_0x3112c6){}if(this[_0x4c9624(0x201)]['geminiApiKey'])try{this[_0x4c9624(0x162)]=new GoogleGenerativeAI(this[_0x4c9624(0x201)][_0x4c9624(0x1f4)]),this[_0x4c9624(0x1ed)]=this[_0x4c9624(0x162)][_0x4c9624(0x157)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x4c9624(0x16a)}});}catch(_0x433790){this['log'][_0x4c9624(0x107)](_0x4c9624(0x145)+_0x433790[_0x4c9624(0x161)]);}await setup[_0x4c9624(0x215)](this),await this[_0x4c9624(0x173)](),schedulers[_0x4c9624(0x11b)](this),await this[_0x4c9624(0x103)](_0x4c9624(0x197),{'type':_0x4c9624(0x184),'common':{'name':'Live\x20Event\x20Pulse','type':'number','role':_0x4c9624(0x1d7),'read':!![],'write':![]},'native':{}}),await this[_0x4c9624(0x103)]('analysis.activity.roomStats',{'type':_0x4c9624(0x184),'common':{'name':_0x4c9624(0x216),'type':_0x4c9624(0x19b),'role':'json','read':!![],'write':![],'def':_0x4c9624(0x153)},'native':{}}),await this[_0x4c9624(0x103)]('analysis.activity.roomHistory',{'type':_0x4c9624(0x184),'common':{'name':_0x4c9624(0x123),'type':_0x4c9624(0x19b),'role':_0x4c9624(0x196),'read':!![],'write':![],'def':'{\x22history\x22:{}}'},'native':{}}),await this[_0x4c9624(0x103)](_0x4c9624(0x19d),{'type':_0x4c9624(0x184),'common':{'name':'Gemini\x20Report\x20Night','type':_0x4c9624(0x19b),'role':'text','read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x4c9624(0x103)](_0x4c9624(0x1e8),{'type':_0x4c9624(0x184),'common':{'name':'Gemini\x20Report\x20Day','type':_0x4c9624(0x19b),'role':_0x4c9624(0x1a6),'read':!![],'write':![],'def':_0x4c9624(0x1c7)},'native':{}}),await this[_0x4c9624(0x103)](_0x4c9624(0x1b8),{'type':'state','common':{'name':'Daily\x20Activity\x20Vector\x20(48x30min)','type':_0x4c9624(0x19b),'role':_0x4c9624(0x196),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x4c9624(0x103)](_0x4c9624(0x22a),{'type':_0x4c9624(0x184),'common':{'name':_0x4c9624(0x17f),'type':_0x4c9624(0x19b),'role':_0x4c9624(0x196),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x4c9624(0x103)]('analysis.health.activityTrend',{'type':_0x4c9624(0x184),'common':{'name':_0x4c9624(0x15f),'type':_0x4c9624(0x140),'role':_0x4c9624(0x1d7),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x4c9624(0x103)](_0x4c9624(0x1c9),{'type':_0x4c9624(0x184),'common':{'name':'Warm-Up\x20Time','type':_0x4c9624(0x19b),'role':'json','read':!![],'write':![]},'native':{}});try{const _0x248f7c=await this['getStateAsync'](_0x4c9624(0x1c4));if(_0x248f7c&&_0x248f7c[_0x4c9624(0x146)]){this[_0x4c9624(0x147)]=JSON['parse'](_0x248f7c['val']);if(this['isProVersion']){const _0x280092=await this[_0x4c9624(0x180)](_0x4c9624(0x15a));if(_0x280092&&_0x280092[_0x4c9624(0x146)])this[_0x4c9624(0x1f9)]=JSON[_0x4c9624(0x10b)](_0x280092[_0x4c9624(0x146)]);}this[_0x4c9624(0x1e5)][_0x4c9624(0x1d2)](_0x4c9624(0x179)+this['eventHistory'][_0x4c9624(0x20f)]+'\x20events\x20from\x20standard\x20storage.');}}catch(_0x16726b){this[_0x4c9624(0x147)]=[];}try{const _0x462433=await this['getStateAsync'](_0x4c9624(0x21a));if(_0x462433&&_0x462433[_0x4c9624(0x146)])this['dailyDigests']=JSON[_0x4c9624(0x10b)](_0x462433[_0x4c9624(0x146)]);}catch(_0x306d67){this['dailyDigests']=[];}const _0x49e198=this['dailyDigests'][_0x4c9624(0x20f)]>=(this[_0x4c9624(0x201)]['minDaysForBaseline']||0x7)?_0x4c9624(0x174)+this[_0x4c9624(0x1b1)][_0x4c9624(0x20f)]+_0x4c9624(0x1ca):_0x4c9624(0x16f)+this[_0x4c9624(0x1b1)][_0x4c9624(0x20f)]+'/'+(this[_0x4c9624(0x201)][_0x4c9624(0x1eb)]||0x7)+')';await this['setStateAsync'](_0x4c9624(0x198),{'val':_0x49e198,'ack':!![]}),this[_0x4c9624(0x200)]('analysis.trigger'),this[_0x4c9624(0x200)]('LTM.triggerDailyDigest'),this[_0x4c9624(0x200)](_0x4c9624(0x1c8));this[_0x4c9624(0x201)][_0x4c9624(0x225)]&&this[_0x4c9624(0x201)][_0x4c9624(0x20e)]&&this[_0x4c9624(0x1fb)][_0x4c9624(0x1e4)]&&this[_0x4c9624(0x11c)](this[_0x4c9624(0x201)][_0x4c9624(0x20e)]);const _0x30c448=this[_0x4c9624(0x201)][_0x4c9624(0x1bd)];if(_0x30c448)for(const _0xf003fd of _0x30c448){await this['subscribeForeignStatesAsync'](_0xf003fd['id']);}const _0x5ab2af=this[_0x4c9624(0x201)][_0x4c9624(0x191)];if(_0x5ab2af)for(const _0x36674b of _0x5ab2af){await this['subscribeForeignStatesAsync'](_0x36674b);}const _0x1681a1=require(_0x4c9624(0x16d));if(this['historyJob'])this[_0x4c9624(0x218)][_0x4c9624(0x13f)]();this[_0x4c9624(0x218)]=_0x1681a1[_0x4c9624(0x1a4)](_0x4c9624(0x1d9),()=>{const _0x179aa7=_0x4c9624;this[_0x179aa7(0x1ba)]();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this[_0x4c9624(0x220)])clearInterval(this[_0x4c9624(0x220)]);this[_0x4c9624(0x190)](),this[_0x4c9624(0x220)]=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this[_0x4c9624(0x155)])clearInterval(this[_0x4c9624(0x155)]);this['healthTrendInterval']=setInterval(()=>{const _0x198719=_0x4c9624;this[_0x198719(0x1cd)]&&this[_0x198719(0x1fb)][_0x198719(0x1dd)]&&this['runPythonHealthCheck']();},0x4*0x3c*0x3c*0x3e8);if(this[_0x4c9624(0x1a8)])clearInterval(this[_0x4c9624(0x1a8)]);this['activeModules'][_0x4c9624(0x177)]&&(this['analysisTimer']=setInterval(()=>{const _0xd9d09f=_0x4c9624;this[_0xd9d09f(0x1d3)]();},0xf*0x3c*0x3e8),setTimeout(()=>this['triggerEnergyPrediction'](),0x2710));const _0x13fb69=path[_0x4c9624(0x1a2)](__dirname,'.venv','bin',_0x4c9624(0x20b));pythonBridge['startService'](this,_0x13fb69);}[a0_0x2a75cb(0x105)](_0x2897f0){const _0x5ca3cf=a0_0x2a75cb;if(this[_0x5ca3cf(0x218)])this[_0x5ca3cf(0x218)][_0x5ca3cf(0x13f)]();this[_0x5ca3cf(0x1ba)]()['then'](()=>{const _0x196028=_0x5ca3cf;if(this[_0x196028(0x1a8)])clearInterval(this[_0x196028(0x1a8)]);if(this[_0x196028(0x220)])clearInterval(this[_0x196028(0x220)]);recorder[_0x196028(0x109)](this),pythonBridge[_0x196028(0x110)](this),_0x2897f0();});}async[a0_0x2a75cb(0x158)](){const _0x255b2a=a0_0x2a75cb;if(!this[_0x255b2a(0x147)]||this['eventHistory'][_0x255b2a(0x20f)]===0x0){this[_0x255b2a(0x1e5)][_0x255b2a(0x1b7)]('‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.');return;}this[_0x255b2a(0x1e5)][_0x255b2a(0x1d2)](_0x255b2a(0x150)+this[_0x255b2a(0x147)][_0x255b2a(0x20f)]+_0x255b2a(0x22f));const _0x5e4d5e=new Date()[_0x255b2a(0x1af)](0x0,0x0,0x0,0x0),_0x530482=_0x255b2a(0x19a);let _0x4e2741={'history':{},'date':new Date()['toLocaleDateString']()};const _0x223a29=_0x255b2a(0x1b8),_0x21d12c=_0x255b2a(0x22a);let _0x2af973=new Array(0x30)[_0x255b2a(0x131)](0x0),_0x445e85=Array[_0x255b2a(0x112)]({'length':0x30},()=>[]);this[_0x255b2a(0x147)]['forEach'](_0x25fb45=>{const _0x579a01=_0x255b2a;if(_0x25fb45[_0x579a01(0x1be)]>=_0x5e4d5e){if(recorder[_0x579a01(0x1c6)](_0x25fb45[_0x579a01(0x1c3)],_0x25fb45[_0x579a01(0x1d7)])){const _0x3e094d=new Date(_0x25fb45['timestamp']),_0x315f6e=_0x3e094d['getHours']()*0x2+(_0x3e094d['getMinutes']()>=0x1e?0x1:0x0);if(_0x315f6e<0x30){_0x2af973[_0x315f6e]++;const _0xa4338c=_0x25fb45[_0x579a01(0x121)]||_0x25fb45[_0x579a01(0x160)]||'?';let _0x31697d=_0x445e85[_0x315f6e];!_0x31697d[_0x579a01(0x137)](_0xa4338c)&&_0x31697d[_0x579a01(0x101)](_0xa4338c);}const _0x197d49=_0x3e094d[_0x579a01(0x206)]();let _0x318e47=_0x25fb45[_0x579a01(0x121)]||_0x579a01(0x1e9);const _0x16ec9e=(this[_0x579a01(0x201)][_0x579a01(0x1bd)]||[])['find'](_0x1aa9c7=>_0x1aa9c7[_0x579a01(0x121)]===_0x318e47);if(_0x16ec9e)_0x318e47=_0x16ec9e[_0x579a01(0x121)];if(!_0x4e2741[_0x579a01(0x170)][_0x318e47])_0x4e2741['history'][_0x318e47]=new Array(0x18)[_0x579a01(0x131)](0x0);if(_0x4e2741[_0x579a01(0x170)][_0x318e47][_0x197d49]<0x3c)_0x4e2741['history'][_0x318e47][_0x197d49]++;}}});const _0x1665a0=await this[_0x255b2a(0x180)](_0x530482);(!_0x1665a0||!_0x1665a0[_0x255b2a(0x146)]||_0x1665a0[_0x255b2a(0x146)]==='{}'||_0x1665a0['val'][_0x255b2a(0x137)]('\x22history\x22:{}'))&&await this['setStateAsync'](_0x530482,{'val':JSON[_0x255b2a(0x1c2)](_0x4e2741),'ack':!![]}),await this[_0x255b2a(0x102)](_0x223a29,{'val':JSON[_0x255b2a(0x1c2)](_0x2af973),'ack':!![]}),await this['setStateAsync'](_0x21d12c,{'val':JSON[_0x255b2a(0x1c2)](_0x445e85),'ack':!![]}),this[_0x255b2a(0x1e5)][_0x255b2a(0x1d2)](_0x255b2a(0x1cc));}async[a0_0x2a75cb(0x1ba)](){const _0x42665b=a0_0x2a75cb;if(!this[_0x42665b(0x1fb)][_0x42665b(0x1dd)])return;const _0x1f5df9=new Date()[_0x42665b(0x219)]()[_0x42665b(0x108)]('T')[0x0];this[_0x42665b(0x1e5)][_0x42665b(0x124)](_0x42665b(0x114)+_0x1f5df9+'...');try{const [_0x398d41,_0x4f0190,_0x36f717,_0x583edf,_0x3fdf94,_0x498a1a]=await Promise[_0x42665b(0x13e)]([this['getStateAsync'](_0x42665b(0x19a)),this['getStateAsync'](_0x42665b(0x19d)),this[_0x42665b(0x180)]('analysis.health.geminiDay'),this['getStateAsync'](_0x42665b(0x1f1)),this[_0x42665b(0x180)]('analysis.health.todayVector'),this[_0x42665b(0x180)]('analysis.health.activityTrend')]),_0x179fa6=this[_0x42665b(0x147)][_0x42665b(0x113)](_0x29044c=>_0x29044c[_0x42665b(0x1be)]>=new Date()['setHours'](0x0,0x0,0x0,0x0)&&(_0x29044c[_0x42665b(0x160)][_0x42665b(0x12c)]()[_0x42665b(0x137)](_0x42665b(0x178))||_0x29044c[_0x42665b(0x160)][_0x42665b(0x12c)]()[_0x42665b(0x137)]('terrasse'))&&(_0x29044c[_0x42665b(0x1d7)]===!![]||_0x29044c[_0x42665b(0x1d7)]===_0x42665b(0x126)))[_0x42665b(0x20f)];let _0x31c5a8=0x55;if(_0x498a1a&&_0x498a1a['val']!==undefined)_0x31c5a8=Math[_0x42665b(0x221)](0x64,Math[_0x42665b(0x12a)](0x14,Math[_0x42665b(0x1b0)](0x50+Number(_0x498a1a['val'])*0x5)));const _0xe9d3e={'date':_0x1f5df9,'timestamp':Date[_0x42665b(0x211)](),'roomHistory':_0x398d41?.[_0x42665b(0x146)]?JSON[_0x42665b(0x10b)](_0x398d41[_0x42665b(0x146)]):{},'geminiNight':_0x4f0190?.[_0x42665b(0x146)]||_0x42665b(0x111),'geminiDay':_0x36f717?.['val']||'Keine\x20Daten','anomalyScore':_0x583edf?.[_0x42665b(0x146)]||0.1,'todayVector':_0x3fdf94?.[_0x42665b(0x146)]?JSON[_0x42665b(0x10b)](_0x3fdf94[_0x42665b(0x146)]):new Array(0x30)['fill'](0x0),'batteryLevel':_0x31c5a8,'freshAirCount':_0x179fa6,'eventHistory':this[_0x42665b(0x147)]},_0x1b3167=utils[_0x42665b(0x119)](),_0x16d8f9=path[_0x42665b(0x1a2)](_0x1b3167,_0x42665b(0x182),_0x42665b(0x170));if(!fs[_0x42665b(0x104)](_0x16d8f9))fs['mkdirSync'](_0x16d8f9,{'recursive':!![]});const _0x4a93eb=path[_0x42665b(0x1a2)](_0x16d8f9,_0x1f5df9+'.json');fs[_0x42665b(0x14a)](_0x4a93eb,JSON[_0x42665b(0x1c2)](_0xe9d3e)),this[_0x42665b(0x1e5)][_0x42665b(0x1d2)](_0x42665b(0x1d8)+_0x4a93eb);}catch(_0x1c09d0){this['log'][_0x42665b(0x107)](_0x42665b(0x1cb)+_0x1c09d0[_0x42665b(0x161)]);}}async[a0_0x2a75cb(0x190)](){const _0x47bb4c=a0_0x2a75cb;if(!this[_0x47bb4c(0x209)])return;try{let _0x2edc7b=null;try{const _0x4a357c=await this[_0x47bb4c(0x180)](_0x47bb4c(0x230)),_0x104387=await this[_0x47bb4c(0x180)](_0x47bb4c(0x208));if(_0x4a357c&&_0x4a357c[_0x47bb4c(0x146)]&&_0x104387&&_0x104387[_0x47bb4c(0x146)]&&_0x104387[_0x47bb4c(0x146)]>0.3){if(_0x4a357c['val']!==_0x47bb4c(0x1e9)&&_0x4a357c[_0x47bb4c(0x146)]!==_0x47bb4c(0x1fc))_0x2edc7b=_0x4a357c[_0x47bb4c(0x146)];}}catch(_0x249028){}if(!_0x2edc7b){const _0x5c40e0=this[_0x47bb4c(0x201)]['devices']||[];for(const _0x55f594 of _0x5c40e0){if(_0x55f594[_0x47bb4c(0x1c3)]===_0x47bb4c(0x213)&&_0x55f594['location'])try{const _0x2e4a1d=await this[_0x47bb4c(0x168)](_0x55f594['id']);if(_0x2e4a1d&&(_0x2e4a1d['val']===!![]||_0x2e4a1d['val']==='on'||_0x2e4a1d['val']===0x1)){_0x2edc7b=_0x55f594[_0x47bb4c(0x121)];break;}}catch(_0x143604){}}}if(!_0x2edc7b)return;const _0x22647f=this[_0x47bb4c(0x201)]['devices']||[];let _0x4977e2=_0x2edc7b;const _0x33df79=_0x22647f['find'](_0x361f61=>_0x361f61[_0x47bb4c(0x121)]&&_0x361f61[_0x47bb4c(0x121)][_0x47bb4c(0x12c)]()===_0x2edc7b['toLowerCase']());if(_0x33df79)_0x4977e2=_0x33df79[_0x47bb4c(0x121)];const _0x28b27b=_0x47bb4c(0x19a),_0x3998ae=await this[_0x47bb4c(0x180)](_0x28b27b),_0x13efde=new Date()[_0x47bb4c(0x222)]();let _0x186494={'history':{},'date':_0x13efde};if(_0x3998ae&&_0x3998ae[_0x47bb4c(0x146)])try{_0x186494=JSON[_0x47bb4c(0x10b)](_0x3998ae['val']);}catch(_0x913450){}_0x186494[_0x47bb4c(0x217)]!==_0x13efde&&(_0x186494['history']={},_0x186494[_0x47bb4c(0x217)]=_0x13efde);if(!_0x186494[_0x47bb4c(0x170)][_0x4977e2])_0x186494[_0x47bb4c(0x170)][_0x4977e2]=new Array(0x18)[_0x47bb4c(0x131)](0x0);const _0xb4a094=new Date()[_0x47bb4c(0x206)]();if(_0x186494[_0x47bb4c(0x170)][_0x4977e2][_0xb4a094]<0x3c)_0x186494['history'][_0x4977e2][_0xb4a094]++;await this[_0x47bb4c(0x102)](_0x28b27b,{'val':JSON[_0x47bb4c(0x1c2)](_0x186494),'ack':!![]});}catch(_0x4583df){this[_0x47bb4c(0x1e5)]['warn'](_0x47bb4c(0x21b)+_0x4583df[_0x47bb4c(0x161)]);}}async[a0_0x2a75cb(0x1b5)](_0xa9d3d0){const _0xea87b2=a0_0x2a75cb;if(typeof _0xa9d3d0===_0xea87b2(0x21e)&&_0xa9d3d0[_0xea87b2(0x161)]){if(_0xa9d3d0[_0xea87b2(0x228)]==='getHistoryData'){const _0x41a111=_0xa9d3d0['message']['date'],_0x35b786=utils[_0xea87b2(0x119)](),_0x4a1dff=path[_0xea87b2(0x1a2)](_0x35b786,_0xea87b2(0x182),_0xea87b2(0x170),_0x41a111+_0xea87b2(0x132));if(fs['existsSync'](_0x4a1dff))try{const _0x9dc9ac=JSON['parse'](fs[_0xea87b2(0x1e6)](_0x4a1dff,'utf8'));this[_0xea87b2(0x12d)](_0xa9d3d0[_0xea87b2(0x112)],_0xa9d3d0['command'],{'success':!![],'data':_0x9dc9ac},_0xa9d3d0[_0xea87b2(0x21c)]);}catch(_0x1a4a8d){this['sendTo'](_0xa9d3d0['from'],_0xa9d3d0[_0xea87b2(0x228)],{'success':![],'error':_0xea87b2(0x139)},_0xa9d3d0[_0xea87b2(0x21c)]);}else this[_0xea87b2(0x12d)](_0xa9d3d0[_0xea87b2(0x112)],_0xa9d3d0[_0xea87b2(0x228)],{'success':![],'error':_0xea87b2(0x193)},_0xa9d3d0[_0xea87b2(0x21c)]);}else{if(_0xa9d3d0[_0xea87b2(0x228)]===_0xea87b2(0x141)){const _0x4bcde6=this[_0xea87b2(0x1b1)][_0xea87b2(0x20f)];let _0x5f5b1c=new Array(0x30)[_0xea87b2(0x131)](0x0),_0x9eef76=Array[_0xea87b2(0x112)]({'length':0x30},()=>[]);try{const _0x546c4f=await this[_0xea87b2(0x180)](_0xea87b2(0x1b8));if(_0x546c4f&&_0x546c4f[_0xea87b2(0x146)])_0x5f5b1c=JSON['parse'](_0x546c4f['val']);const _0x1226f3=await this['getStateAsync'](_0xea87b2(0x22a));if(_0x1226f3&&_0x1226f3[_0xea87b2(0x146)])_0x9eef76=JSON[_0xea87b2(0x10b)](_0x1226f3[_0xea87b2(0x146)]);}catch(_0x3fba4f){}let _0x3ef4ef=new Array(0x30)[_0xea87b2(0x131)](0x0);try{const _0x5c9684=new Date();_0x5c9684[_0xea87b2(0x156)](_0x5c9684[_0xea87b2(0x134)]()-0x1);const _0xfd5db0=_0x5c9684[_0xea87b2(0x219)]()[_0xea87b2(0x108)]('T')[0x0],_0x5b9917=utils[_0xea87b2(0x119)](),_0x1ec67a=path[_0xea87b2(0x1a2)](_0x5b9917,_0xea87b2(0x182),'history',_0xfd5db0+_0xea87b2(0x132));if(fs[_0xea87b2(0x104)](_0x1ec67a)){const _0x39fbb2=JSON['parse'](fs[_0xea87b2(0x1e6)](_0x1ec67a,_0xea87b2(0x229)));if(_0x39fbb2&&_0x39fbb2[_0xea87b2(0x1c1)])_0x3ef4ef=_0x39fbb2[_0xea87b2(0x1c1)];}}catch(_0x23c405){}let _0x918972={'today':{},'yesterday':{}};try{const _0x227fbd=await this[_0xea87b2(0x180)](_0xea87b2(0x166));if(_0x227fbd&&_0x227fbd[_0xea87b2(0x146)])_0x918972=JSON[_0xea87b2(0x10b)](_0x227fbd[_0xea87b2(0x146)]);}catch(_0x33e273){}let _0x450e30=null;try{const _0xc5dec1=await this[_0xea87b2(0x180)]('analysis.health.activityTrend');if(_0xc5dec1)_0x450e30=_0xc5dec1['val'];}catch(_0x23d288){}if(_0x450e30===undefined||_0x450e30===null){const _0xfe027b=_0x5f5b1c[_0xea87b2(0x187)]((_0x8127c7,_0x198c29)=>_0x8127c7+_0x198c29,0x0),_0x48d184=Math[_0xea87b2(0x221)](0x2,Math[_0xea87b2(0x12a)](-0x2,(0x64-_0xfe027b)/0x32));_0x450e30=_0x48d184;}let _0x5dd1a8=![],_0x2cdcb4='',_0x5de130='',_0x5bef68='';try{const _0x282647=await this['getStateAsync'](_0xea87b2(0x11f));if(_0x282647&&_0x282647[_0xea87b2(0x146)]){_0x5dd1a8=!![];const _0x5e7061=await this[_0xea87b2(0x180)](_0xea87b2(0x17e));_0x2cdcb4=_0x5e7061?_0x5e7061[_0xea87b2(0x146)]:'';const _0x18e371=await this[_0xea87b2(0x180)](_0xea87b2(0x1d0));_0x5de130=_0x18e371?_0x18e371[_0xea87b2(0x146)]:'';const _0x5a1309=await this['getStateAsync'](_0xea87b2(0x14f));_0x5bef68=_0x5a1309?_0x5a1309['val']:'';}}catch(_0x5c22c0){}const _0x3b3493=await this[_0xea87b2(0x128)](),_0x51abcb=(this[_0xea87b2(0x201)][_0xea87b2(0x1bd)]||[])['some'](_0x3f0f2c=>_0x3f0f2c[_0xea87b2(0x125)]),_0x102b84=_0x3b3493&&_0x51abcb;let _0x27bec7='';try{const _0x31cfb9=await this[_0xea87b2(0x180)](_0xea87b2(0x1d6));if(_0x31cfb9&&_0x31cfb9['val'])_0x27bec7=_0x31cfb9[_0xea87b2(0x146)];}catch(_0x2e9583){}this['sendTo'](_0xa9d3d0['from'],_0xa9d3d0['command'],{'success':!![],'eventHistory':this[_0xea87b2(0x147)][_0xea87b2(0x12b)](0x0,0x7d0),'stats':{'digestCount':_0x4bcde6,'isPresent':this['isPresent'],'hourlyActivity':_0x5f5b1c,'hourlyDetails':_0x9eef76,'yesterdayActivity':_0x3ef4ef,'solarActive':_0x102b84,'presenceWho':_0x27bec7,'roomStats':_0x918972,'activityTrend':_0x450e30,'modules':this['activeModules']},'automation':{'detected':_0x5dd1a8,'description':_0x2cdcb4,'targetId':_0x5de130,'targetValue':_0x5bef68}},_0xa9d3d0[_0xea87b2(0x21c)]);}else{if(_0xa9d3d0['command']===_0xea87b2(0x18b))try{const _0x27d923=await automation['scanThermostats'](this);this['sendTo'](_0xa9d3d0[_0xea87b2(0x112)],_0xa9d3d0[_0xea87b2(0x228)],{'success':!![],'results':_0x27d923},_0xa9d3d0[_0xea87b2(0x21c)]);}catch(_0x5d097f){this['sendTo'](_0xa9d3d0[_0xea87b2(0x112)],_0xa9d3d0[_0xea87b2(0x228)],{'success':![],'error':_0x5d097f[_0xea87b2(0x161)]},_0xa9d3d0['callback']);}else{if(_0xa9d3d0['command']===_0xea87b2(0x207))try{const _0x4a274d=await scanner['scanForDevices'](this,_0xa9d3d0[_0xea87b2(0x161)]||{});this[_0xea87b2(0x12d)](_0xa9d3d0['from'],_0xa9d3d0[_0xea87b2(0x228)],{'success':!![],'devices':_0x4a274d},_0xa9d3d0['callback']);}catch(_0x40edc0){}else{if(_0xa9d3d0[_0xea87b2(0x228)]===_0xea87b2(0x204)){const _0x30e407=await this[_0xea87b2(0x1ac)]('enum.functions.*',_0xea87b2(0x163)),_0x57f8fd=[];if(_0x30e407)for(const _0x318ad4 in _0x30e407){let _0x4d6a9b=_0x30e407[_0x318ad4][_0xea87b2(0x15e)][_0xea87b2(0x160)];if(_0x4d6a9b&&typeof _0x4d6a9b==='object')_0x4d6a9b=_0x4d6a9b['de']||_0x4d6a9b['en']||Object[_0xea87b2(0x1ce)](_0x4d6a9b)[0x0]||JSON[_0xea87b2(0x1c2)](_0x4d6a9b);_0x57f8fd[_0xea87b2(0x101)]({'id':_0x318ad4,'name':String(_0x4d6a9b||_0x318ad4)});}const _0x217415=await this[_0xea87b2(0x1ac)](_0xea87b2(0x203),_0xea87b2(0x163)),_0x12d790=[];if(_0x217415)for(const _0x30bc9f in _0x217415){let _0x2f37f2=_0x217415[_0x30bc9f][_0xea87b2(0x15e)][_0xea87b2(0x160)];if(_0x2f37f2&&typeof _0x2f37f2===_0xea87b2(0x21e))_0x2f37f2=_0x2f37f2['de']||_0x2f37f2['en']||Object['values'](_0x2f37f2)[0x0]||JSON[_0xea87b2(0x1c2)](_0x2f37f2);_0x12d790['push'](String(_0x2f37f2||_0x30bc9f[_0xea87b2(0x108)]('.')[_0xea87b2(0x1f3)]()));}this[_0xea87b2(0x12d)](_0xa9d3d0[_0xea87b2(0x112)],_0xa9d3d0['command'],{'success':!![],'enums':_0x57f8fd,'rooms':_0x12d790},_0xa9d3d0[_0xea87b2(0x21c)]);}else{if(_0xa9d3d0[_0xea87b2(0x228)]===_0xea87b2(0x117))try{const _0x21401b=await this[_0xea87b2(0x144)](_0xea87b2(0x172),'instance',{'startkey':_0xea87b2(0x1ea),'endkey':_0xea87b2(0x120)}),_0x3d5bb7=new Set();if(_0x21401b&&_0x21401b[_0xea87b2(0x11e)])for(const _0x33bbd0 of _0x21401b[_0xea87b2(0x11e)]){const _0x2794b7=_0x33bbd0['id'][_0xea87b2(0x1f2)](_0xea87b2(0x167),''),_0x5cfcad=await this[_0xea87b2(0x168)](_0x2794b7+_0xea87b2(0x17a));let _0x10de30=![];if(_0x5cfcad&&_0x5cfcad['val']){const _0x5a66f7=typeof _0x5cfcad[_0xea87b2(0x146)]===_0xea87b2(0x19b)?JSON[_0xea87b2(0x10b)](_0x5cfcad[_0xea87b2(0x146)]):_0x5cfcad[_0xea87b2(0x146)];Array[_0xea87b2(0x1d5)](_0x5a66f7)&&_0x5a66f7['forEach'](_0x1677be=>{const _0x4eb0dd=_0xea87b2;_0x1677be[_0x4eb0dd(0x14b)]&&(_0x3d5bb7['add'](_0x1677be['calendarName']),_0x10de30=!![]);});}!_0x10de30&&_0x3d5bb7[_0xea87b2(0x223)](_0x2794b7);}const _0x2dae13=Array[_0xea87b2(0x112)](_0x3d5bb7);if(_0x2dae13[_0xea87b2(0x20f)]===0x0)_0x2dae13[_0xea87b2(0x101)](_0xea87b2(0x1e0));this[_0xea87b2(0x12d)](_0xa9d3d0['from'],_0xa9d3d0[_0xea87b2(0x228)],{'success':!![],'names':_0x2dae13},_0xa9d3d0[_0xea87b2(0x21c)]);}catch(_0x42d4d2){this[_0xea87b2(0x12d)](_0xa9d3d0[_0xea87b2(0x112)],_0xa9d3d0[_0xea87b2(0x228)],{'success':![],'error':'Scan\x20Error:\x20'+_0x42d4d2[_0xea87b2(0x161)]},_0xa9d3d0[_0xea87b2(0x21c)]);}else{if(_0xa9d3d0[_0xea87b2(0x228)]===_0xea87b2(0x1a5))try{await automation[_0xea87b2(0x192)](this),this['sendTo'](_0xa9d3d0[_0xea87b2(0x112)],_0xa9d3d0[_0xea87b2(0x228)],{'success':!![]},_0xa9d3d0[_0xea87b2(0x21c)]);}catch(_0x596790){this[_0xea87b2(0x1e5)][_0xea87b2(0x1b7)](_0xea87b2(0x176)+_0x596790[_0xea87b2(0x161)]),this[_0xea87b2(0x12d)](_0xa9d3d0['from'],_0xa9d3d0['command'],{'success':![],'error':_0x596790[_0xea87b2(0x161)]},_0xa9d3d0[_0xea87b2(0x21c)]);}else{if(_0xa9d3d0['command']===_0xea87b2(0x106))try{const _0x58ca42=_0xa9d3d0[_0xea87b2(0x161)]?_0xa9d3d0[_0xea87b2(0x161)][_0xea87b2(0x20c)]:'';if(!_0x58ca42)throw new Error(_0xea87b2(0x1d4));const _0x2af508=new GoogleGenerativeAI(_0x58ca42),_0x588f5d=_0x2af508[_0xea87b2(0x157)]({'model':GEMINI_MODEL}),_0x1661be=await _0x588f5d['generateContent']('Say\x20Hello'),_0x526c8b=await _0x1661be[_0xea87b2(0x10c)],_0x4bdab0=_0x526c8b[_0xea87b2(0x1a6)]();this[_0xea87b2(0x12d)](_0xa9d3d0['from'],_0xa9d3d0['command'],{'success':!![],'message':_0xea87b2(0x10e)+_0x4bdab0[_0xea87b2(0x194)](0x0,0x14)+'...'},_0xa9d3d0[_0xea87b2(0x21c)]);}catch(_0x403b75){this[_0xea87b2(0x12d)](_0xa9d3d0['from'],_0xa9d3d0[_0xea87b2(0x228)],{'success':![],'message':_0x403b75['message']},_0xa9d3d0[_0xea87b2(0x21c)]);}else{if(_0xa9d3d0['command']===_0xea87b2(0x136))try{const _0x59abb0=await this[_0xea87b2(0x128)](),_0x4dd4d4=await this[_0xea87b2(0x144)](_0xea87b2(0x172),'instance',{'startkey':_0xea87b2(0x1ea),'endkey':_0xea87b2(0x120)}),_0x1ddffa=_0x4dd4d4&&_0x4dd4d4[_0xea87b2(0x11e)]?_0x4dd4d4['rows'][_0xea87b2(0x20f)]:0x0;this['sendTo'](_0xa9d3d0[_0xea87b2(0x112)],_0xa9d3d0[_0xea87b2(0x228)],{'success':!![],'weather':_0xea87b2(0x189)+_0x59abb0+_0xea87b2(0x1da)+(this[_0xea87b2(0x1f0)][this[_0xea87b2(0x201)][_0xea87b2(0x227)]]||'?')+'¬∞C','calendar':_0x1ddffa+_0xea87b2(0x1c5)},_0xa9d3d0[_0xea87b2(0x21c)]);}catch(_0x335b9f){this['sendTo'](_0xa9d3d0['from'],_0xa9d3d0[_0xea87b2(0x228)],{'success':![]},_0xa9d3d0[_0xea87b2(0x21c)]);}}}}}}}}}}}[a0_0x2a75cb(0x151)](){const _0x326d5d=a0_0x2a75cb;if(!this[_0x326d5d(0x1fb)]['health'])return;this[_0x326d5d(0x1e5)][_0x326d5d(0x124)](_0x326d5d(0x18a));try{const _0x539298=this[_0x326d5d(0x1f9)]||[];pythonBridge[_0x326d5d(0x129)](this,_0x326d5d(0x1f6),{'events':_0x539298});}catch(_0x4aa8d9){this[_0x326d5d(0x1e5)][_0x326d5d(0x1b7)](_0x326d5d(0x1ab));}}async[a0_0x2a75cb(0x175)](_0x854566,_0x1ca594){const _0x20f5ff=a0_0x2a75cb;if(!_0x1ca594||this[_0x20f5ff(0x12e)])return;if(_0x854566[_0x20f5ff(0x137)](_0x20f5ff(0x1b3))&&_0x854566[_0x20f5ff(0x205)](_0x20f5ff(0x186))&&_0x1ca594[_0x20f5ff(0x146)])return;if(this[_0x20f5ff(0x201)]['infrasoundEnabled']&&_0x854566===this[_0x20f5ff(0x201)][_0x20f5ff(0x20e)]&&this[_0x20f5ff(0x1fb)][_0x20f5ff(0x1e4)]){this[_0x20f5ff(0x18c)](_0x1ca594[_0x20f5ff(0x146)]);return;}if(_0x1ca594[_0x20f5ff(0x1e1)]&&_0x854566['endsWith']('pulse'))return;if(_0x854566===this[_0x20f5ff(0xfc)]+'.system.mode'){if(_0x1ca594[_0x20f5ff(0x146)]&&Object[_0x20f5ff(0x1ce)](setup[_0x20f5ff(0x1ee)])[_0x20f5ff(0x137)](_0x1ca594[_0x20f5ff(0x146)])){this[_0x20f5ff(0x1f7)]=_0x1ca594[_0x20f5ff(0x146)];if(_0x1ca594[_0x20f5ff(0x146)]===setup['SYSTEM_MODES'][_0x20f5ff(0x143)])await recorder['setPresence'](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x20f5ff(0x1cd)]){let _0xa3e87d=![],_0x195afc=0x0,_0xcd3dde=_0x20f5ff(0x22b);if(this[_0x20f5ff(0x1f7)]===_0x20f5ff(0x188))_0xa3e87d=!![],_0x195afc=0x168,_0xcd3dde=_0x20f5ff(0x18d);else this[_0x20f5ff(0x1f7)]==='guest'&&(_0xa3e87d=!![],_0x195afc=0x5a0,_0xcd3dde=_0x20f5ff(0x133));pythonBridge[_0x20f5ff(0x129)](this,_0x20f5ff(0x127),{'active':_0xa3e87d,'duration':_0x195afc,'label':_0xcd3dde}),await this['setStateAsync'](_0x20f5ff(0x15b),{'val':JSON['stringify']({'active':_0xa3e87d,'label':_0xcd3dde,'timestamp':Date[_0x20f5ff(0x211)]()}),'ack':!![]});}}if(!_0x1ca594[_0x20f5ff(0x1e1)])this['setState'](_0x854566,{'val':this[_0x20f5ff(0x1f7)],'ack':!![]});return;}if(_0x854566[_0x20f5ff(0x205)](_0x20f5ff(0x19c))&&_0x1ca594[_0x20f5ff(0x1e1)])this['protectAiMemory'](_0x1ca594[_0x20f5ff(0x146)]);if(_0x854566['endsWith'](_0x20f5ff(0x1c9))&&_0x1ca594['ack']&&this['activeModules'][_0x20f5ff(0x177)])automation[_0x20f5ff(0x1ae)](this);if(!_0x1ca594[_0x20f5ff(0x1e1)]){if(_0x854566[_0x20f5ff(0x137)](_0x20f5ff(0x1f5))&&_0x1ca594[_0x20f5ff(0x146)]){this['setState'](_0x854566,{'val':![],'ack':!![]}),aiAgent[_0x20f5ff(0x171)](this);return;}if(_0x854566[_0x20f5ff(0x137)]('triggerDailyDigest')&&_0x1ca594[_0x20f5ff(0x146)]){this[_0x20f5ff(0x1e2)](_0x854566,{'val':![],'ack':!![]});if(this[_0x20f5ff(0x1cd)])aiAgent[_0x20f5ff(0x1b6)](this,pythonBridge);return;}if(_0x854566['includes'](_0x20f5ff(0x181))&&_0x1ca594[_0x20f5ff(0x146)]){this['setState'](_0x854566,{'val':![],'ack':!![]}),aiAgent[_0x20f5ff(0x210)](this);return;}if(_0x854566[_0x20f5ff(0x137)](_0x20f5ff(0x1b4))&&_0x1ca594['val']){this[_0x20f5ff(0x1e2)](_0x854566,{'val':![],'ack':!![]}),aiAgent[_0x20f5ff(0x165)](this);return;}if(_0x854566[_0x20f5ff(0x137)]('analysis.training.triggerSecurity')&&_0x1ca594['val']){this[_0x20f5ff(0x1e2)](_0x854566,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x32a47b=await this[_0x20f5ff(0x180)](_0x20f5ff(0x148));if(_0x32a47b&&_0x32a47b['val']){const _0x50c11a=JSON['parse'](_0x32a47b['val']);this[_0x20f5ff(0x102)](_0x20f5ff(0x1b9),{'val':_0x20f5ff(0x18f),'ack':!![]}),pythonBridge[_0x20f5ff(0x129)](this,_0x20f5ff(0x13d),{'sequences':_0x50c11a});}}catch(_0x4479b2){}return;}if(_0x854566[_0x20f5ff(0x137)](_0x20f5ff(0x1c8))&&_0x1ca594[_0x20f5ff(0x146)]){this[_0x20f5ff(0x1e2)](_0x854566,{'val':![],'ack':!![]});if(this[_0x20f5ff(0x1cd)])try{this[_0x20f5ff(0x151)]();const _0x37c8e9=await this[_0x20f5ff(0x180)](_0x20f5ff(0x21a));if(_0x37c8e9&&_0x37c8e9[_0x20f5ff(0x146)])pythonBridge['send'](this,'TRAIN_HEALTH',{'digests':JSON[_0x20f5ff(0x10b)](_0x37c8e9[_0x20f5ff(0x146)])});aiAgent[_0x20f5ff(0x115)](this,'NIGHT'),setTimeout(()=>aiAgent[_0x20f5ff(0x115)](this,_0x20f5ff(0x224)),0x2ee0);}catch(_0x1c2a3f){}return;}if(_0x854566[_0x20f5ff(0x137)]('analysis.training.triggerEnergy')&&_0x1ca594[_0x20f5ff(0x146)]){this[_0x20f5ff(0x1e2)](_0x854566,{'val':![],'ack':!![]}),await this[_0x20f5ff(0x1d3)]();return;}if(_0x854566['includes']('analysis.training.triggerComfort')&&_0x1ca594[_0x20f5ff(0x146)]){this[_0x20f5ff(0x1e2)](_0x854566,{'val':![],'ack':!![]});if(this[_0x20f5ff(0x1cd)])try{const _0xacb679=await this[_0x20f5ff(0x180)](_0x20f5ff(0x15a));if(_0xacb679&&_0xacb679['val']){const _0x1ed80e={};if(this[_0x20f5ff(0x201)]['devices'])this['config'][_0x20f5ff(0x1bd)]['forEach'](_0x570369=>{const _0x2f97d6=_0x20f5ff;if(_0x570369['id']&&_0x570369[_0x2f97d6(0x1c3)])_0x1ed80e[_0x570369['id']]=_0x570369[_0x2f97d6(0x1c3)];});pythonBridge['send'](this,_0x20f5ff(0x135),{'events':JSON[_0x20f5ff(0x10b)](_0xacb679['val']),'deviceMap':_0x1ed80e});}}catch(_0x1e687b){}return;}if(_0x854566['includes'](_0x20f5ff(0x1db))&&_0x1ca594['val']){this[_0x20f5ff(0x1e2)](_0x854566,{'val':![],'ack':!![]}),topology[_0x20f5ff(0x1de)](this);if(this[_0x20f5ff(0x1cd)])try{const _0x4bb74d=await this[_0x20f5ff(0x180)](_0x20f5ff(0x148));if(_0x4bb74d&&_0x4bb74d[_0x20f5ff(0x146)])pythonBridge[_0x20f5ff(0x129)](this,_0x20f5ff(0x202),{'sequences':JSON['parse'](_0x4bb74d['val'])});}catch(_0x1c06c0){}return;}}const _0x222345=(this[_0x20f5ff(0x201)][_0x20f5ff(0x1bd)]||[])['find'](_0x18fb5a=>_0x18fb5a['id']===_0x854566);if(_0x222345){const _0x283016=await recorder[_0x20f5ff(0x1bf)](this,_0x854566,_0x1ca594,_0x222345);_0x283016&&this['setState'](_0x20f5ff(0x197),{'val':Date[_0x20f5ff(0x211)](),'ack':!![]});_0x283016&&_0x283016[_0x20f5ff(0x1c3)]===_0x20f5ff(0x213)&&_0x283016[_0x20f5ff(0x121)]&&this[_0x20f5ff(0x1cd)]&&deadMan[_0x20f5ff(0x1fe)](this,_0x283016[_0x20f5ff(0x121)]);_0x1ca594['val']&&(_0x1ca594['val']===!![]||_0x1ca594[_0x20f5ff(0x146)]===0x1||String(_0x1ca594['val'])['toLowerCase']()===_0x20f5ff(0x126))&&(_0x222345[_0x20f5ff(0x1c3)]&&(_0x222345[_0x20f5ff(0x1c3)]['includes'](_0x20f5ff(0x1fa))||_0x222345[_0x20f5ff(0x1c3)]['includes'](_0x20f5ff(0x19f)))&&this[_0x20f5ff(0x212)](_0x222345));if(_0x222345['type']===_0x20f5ff(0x14c)||_0x222345[_0x20f5ff(0x1c3)]==='thermostat'){if(this[_0x20f5ff(0x1fb)][_0x20f5ff(0x177)])automation[_0x20f5ff(0x12f)](this);}}}async[a0_0x2a75cb(0x1bc)](_0x440813){const _0x4b8f46=a0_0x2a75cb;if(!this[_0x4b8f46(0x1ff)]||Date[_0x4b8f46(0x211)]()-this[_0x4b8f46(0x18e)]>0x493e0)return;try{const _0x408ce7=JSON[_0x4b8f46(0x10b)](_0x440813),_0x2fe8b2=this[_0x4b8f46(0x1ff)][_0x4b8f46(0x1bb)];let _0x40d170=![];for(const _0x966767 in _0x2fe8b2){if(_0x2fe8b2[_0x966767][_0x4b8f46(0x137)]('AI')&&_0x408ce7[_0x966767]&&!_0x408ce7[_0x966767][_0x4b8f46(0x137)]('AI')){_0x40d170=!![];break;}}_0x40d170&&(await this[_0x4b8f46(0x102)]('analysis.energy.warmupTimes',{'val':JSON[_0x4b8f46(0x1c2)](this[_0x4b8f46(0x1ff)][_0x4b8f46(0x152)]),'ack':!![]}),await this[_0x4b8f46(0x102)](_0x4b8f46(0x19c),{'val':JSON[_0x4b8f46(0x1c2)](this[_0x4b8f46(0x1ff)]['sources']),'ack':!![]}));}catch(_0x44347c){}}async[a0_0x2a75cb(0x173)](){const _0x5a76c7=a0_0x2a75cb;try{const _0x147822=await this['getStateAsync'](setup['SYSTEM_DP_MODE']);if(_0x147822&&_0x147822[_0x5a76c7(0x146)])this[_0x5a76c7(0x1f7)]=_0x147822[_0x5a76c7(0x146)];}catch(_0x4efb9b){this['currentSystemMode']=setup[_0x5a76c7(0x1ee)][_0x5a76c7(0x21d)];}}async[a0_0x2a75cb(0x118)](){return![];}async[a0_0x2a75cb(0x10d)](){const _0x38f3c7=a0_0x2a75cb;await aiAgent[_0x38f3c7(0x171)](this);this[_0x38f3c7(0x1fb)][_0x38f3c7(0x1dd)]&&(this['updateHealthVector'](),this[_0x38f3c7(0x11d)]());if(this[_0x38f3c7(0x1fb)][_0x38f3c7(0x177)])this[_0x38f3c7(0x1d3)]();}async[a0_0x2a75cb(0x128)](){return![];}['triggerGaitAnalysis'](){if(!this['isProVersion'])return;}async[a0_0x2a75cb(0x1d3)](){const _0xe2a559=a0_0x2a75cb;if(!this['isProVersion']||!this['activeModules']['energy'])return;try{const _0x5db681={},_0x21279a={},_0x244609=this[_0xe2a559(0x201)][_0xe2a559(0x1bd)]||[];for(const _0x7c35c of _0x244609){if((_0x7c35c[_0xe2a559(0x1c3)]===_0xe2a559(0x14c)||_0x7c35c[_0xe2a559(0x1c3)]==='thermostat')&&_0x7c35c['location'])try{const _0x3af761=await this[_0xe2a559(0x168)](_0x7c35c['id']);_0x3af761&&typeof _0x3af761[_0xe2a559(0x146)]===_0xe2a559(0x140)&&(_0x5db681[_0x7c35c[_0xe2a559(0x121)]]=_0x3af761[_0xe2a559(0x146)],_0x21279a[_0x7c35c[_0xe2a559(0x121)]]=_0x7c35c[_0xe2a559(0x125)]||![]);}catch(_0xe3e6f){}}let _0x2a5819=0xa;if(this[_0xe2a559(0x201)]['weatherTempId'])try{const _0x11cacd=await this[_0xe2a559(0x168)](this['config'][_0xe2a559(0x22e)]);if(_0x11cacd&&typeof _0x11cacd[_0xe2a559(0x146)]===_0xe2a559(0x140))_0x2a5819=_0x11cacd[_0xe2a559(0x146)];}catch(_0x2e99d3){}const _0x233839=await this[_0xe2a559(0x128)]();let _0x283031={};try{const _0x2bbfee=await this['getStateAsync'](_0xe2a559(0x1df));if(_0x2bbfee&&_0x2bbfee['val'])_0x283031=JSON[_0xe2a559(0x10b)](_0x2bbfee[_0xe2a559(0x146)]);}catch(_0x2301a2){}pythonBridge['send'](this,'PREDICT_ENERGY',{'current_temps':_0x5db681,'t_out':_0x2a5819,'is_sunny':_0x233839,'solar_flags':_0x21279a,'warmup_targets':_0x283031}),this[_0xe2a559(0x1e5)][_0xe2a559(0x1d2)](_0xe2a559(0x1cf)+Object[_0xe2a559(0x10a)](_0x5db681)['length']+'\x20rooms)');}catch(_0x34b9ca){this['log'][_0xe2a559(0x1b7)](_0xe2a559(0x1ef)+_0x34b9ca['message']);}}[a0_0x2a75cb(0x169)](){}async[a0_0x2a75cb(0x18c)](_0xcd3137){}async[a0_0x2a75cb(0x1b2)](_0x4afd95,_0x40bd28){}async['analyzeWindowOpening'](_0x22eb04){}async[a0_0x2a75cb(0x20d)](_0x193bf3){}['sendNotification'](_0x3368e9){}}function a0_0x4d5d(_0xab4403,_0x3f1b26){const _0x5104c2=a0_0x2d91();return a0_0x4d5d=function(_0x5d93be,_0x5481f9){_0x5d93be=_0x5d93be-0xfc;let _0x2d9142=_0x5104c2[_0x5d93be];return _0x2d9142;},a0_0x4d5d(_0xab4403,_0x3f1b26);}if(require[a0_0x2a75cb(0x1aa)]!==module)module['exports']=_0x2ddc9f=>new CogniLiving(_0x2ddc9f);else new CogniLiving();