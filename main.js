const a0_0x220c0d=a0_0x395f;(function(_0x2a7adc,_0x20410a){const _0x51c5ed=a0_0x395f,_0x21a0d9=_0x2a7adc();while(!![]){try{const _0x34283a=-parseInt(_0x51c5ed(0x1d9))/0x1+parseInt(_0x51c5ed(0x267))/0x2+-parseInt(_0x51c5ed(0x24d))/0x3+-parseInt(_0x51c5ed(0x2bd))/0x4*(-parseInt(_0x51c5ed(0x2b1))/0x5)+-parseInt(_0x51c5ed(0x288))/0x6+-parseInt(_0x51c5ed(0x1b0))/0x7*(-parseInt(_0x51c5ed(0x2cf))/0x8)+-parseInt(_0x51c5ed(0x273))/0x9;if(_0x34283a===_0x20410a)break;else _0x21a0d9['push'](_0x21a0d9['shift']());}catch(_0x3a65f7){_0x21a0d9['push'](_0x21a0d9['shift']());}}}(a0_0x731a,0x734f1));const a0_0x42ea43=(function(){let _0x4b1102=!![];return function(_0x28d0c7,_0x375761){const _0x2d65e1=_0x4b1102?function(){if(_0x375761){const _0x4cdc65=_0x375761['apply'](_0x28d0c7,arguments);return _0x375761=null,_0x4cdc65;}}:function(){};return _0x4b1102=![],_0x2d65e1;};}()),a0_0x1b91c0=a0_0x42ea43(this,function(){const _0x55a771=a0_0x395f;return a0_0x1b91c0['toString']()[_0x55a771(0x2f4)](_0x55a771(0x2ea))[_0x55a771(0x20f)]()[_0x55a771(0x24c)](a0_0x1b91c0)[_0x55a771(0x2f4)](_0x55a771(0x2ea));});function a0_0x731a(){const _0x28a1b4=['.json','de-DE','analyzeWindowOpening\x20error:\x20','Gute\x20L√ºftungsm√∂glichkeit!','testApiKey','updateHealthVector','analysis.prediction.trackerConfidence','LTM.dailyDigests','python','moduleEnergy','then','subscribeForeignStatesAsync','./lib/dead_man','üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','analysis.health.todayVector','modules','enum.functions.*','exports','namespace','existsSync','analysis.automation.targetValue','door','toLocaleDateString','ERROR','temperature','window','NIGHT','response','üí®\x20L√ºftung\x20in\x20','some','‚úÖ\x20History\x20saved:\x20','clear','üìù\x20Manual\x20event\x20logged:\x20','infrasoundSensorId','scanDevices','number','checkSolarCondition','geminiModel','endsWith','analysis.visualization.pulse','SYSTEM_MODES','value','No\x20data','cogni-living','LTM.rawEventLog','system','manual','times','healthTrendInterval','weatherTempId','getDate','Unbekannt','constructor','644535FcItFP','¬∞C\x20(Innen:\x20','map','infrasoundThreshold','rawEventLog','filter','getForeignObjectsAsync','trackerHeartbeat','fill','driftAnalysisTimer','from','custom','object','Sonne:\x20','...','toFixed','\x20(Threshold)','licenseKey','Kein\x20API\x20Key\x20√ºbergeben.','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','setPresence','isArray','loadSystemMode','getStateAsync','useCalendar','party','1701616SafzPe','memoryCache','Party\x20Mode','common','infrasoundLocked','lastAlertState','join','üîä\x20Infraschall-Alarm:\x20','command','bind','ltmJob','processSensorEvent','7721955Sxxhlg','.isOnline','thermostat','energy','./lib/ai_agent','abs','setObjectNotExistsAsync','moduleSecurity','Current.WeatherText','debug','replayTodayEvents','getTime','NextHours.Location_1.Day_1.current.symbol_desc','checkThermostats','onMessage','Warte\x20auf\x20Analyse...','location','testContext','security','parse','analysis.trigger','1698870YNzEBk','Scan\x20Error:\x20','LTM.triggerDailyDigest','initSchedules','message','analysis.ventilation.lastWindow','pythonBridge','LTM.trainingData.sequences','{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}','Warm-Up\x20Time','analysis.automation.targetId','getOverviewData','2-digit','CALCULATE_HEALTH_TREND','initSystemConfig','values','checkCalendarTriggers','\x20events\x20from\x20today...','state','toLocaleTimeString','genAI','presenceCheckTimer','enum','dailyDigests','name','models/gemini-flash-latest','calendarName','sensorLastValues','Daily\x20Room\x20Details\x20(48x30min)','now','analysis.health.activityTrend','send','subscribeForeignStates','error','ANALYZE_GAIT','health','runPythonHealthCheck','\x20Kalender-Adapter\x20gefunden.','activeModules','analysis.activity.roomStats','analysis.training.triggerHealth','5QBHsoB','guest','General\x20Activity\x20Trend','isProVersion','analysisTimer','\x22history\x22:{}','L√ºften\x20empfohlen','system.adapter.ical.','onStateChange','analysis.security.learningStatus','analysis.energy.warmupTimes','haust√ºr','3009148PFrbay','ack','slice','moduleHealth','type','calendarCheckTimer','sources','@google/generative-ai','length','Room\x20History\x20(24h\x20Buckets)','systemConfig','max','push','saveDailyHistory','Daily\x20Activity\x20Vector\x20(48x30min)','find','./lib/recorder','PREDICT_ENERGY','458776ACYFdD','startService','getForeignStateAsync','telegram','all','inactivityThresholdHours','handleInfrasound',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','timestamp','bootTime','TRAIN_SECURITY','getHistoryData','onReady','currentSystemMode','.data.table',':\x20Temp-Differenz\x20','historyJob','string','toISOString','roomIntegratorTimer','reduce','unload','appendToLog','todayVector','klar','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','.system.mode','(((.+)+)+)+$','motion','stringify','createAllObjects','shift','analysis.activity.roomHistory','sendNotification','History\x20Save\x20Error:\x20','pressureBuffer','forecast.current.weather','search','json','TRAIN_TOPOLOGY','weatherunderground.0','heiter','Corrupt','min','writeFileSync','subscribeStates','triggerGaitAnalysis','Adapter','pythonBridge\x20command\x20failed:\x20','triggerDailyDigest','\x20-\x20','getCalendarNames','analyzeWindowOpening','unshift','Guest\x20Mode','Aktiv\x20(','stopService','split','isGracePeriodActive','./lib/installer','round','analysis.training.triggerEnergy','utf8','59\x2023\x20*\x20*\x20*','devices','Lernphase\x20(','Manual\x20Event','Gemini\x20Init\x20Error:\x20','log','startSystem','35tilOLp','setStateAsync','integrateRoomTime','instance','analysis.training.status','./lib/automation','sendTo','minDaysForBaseline','NORMAL','[PythonBridge]\x20Forwarding\x20command:\x20',',\x20Temp:\x20','analysis.health.todayRoomDetails','readFileSync','info','getEnums','onUnload','config','\x20sequences','infrasoundEnabled','analysis.energy.warmupSources','open','getGenerativeModel','Unknown','infrasoundArmingId','pulse','Gemini\x20Report\x20Night','updateSchedulePreview','\x20events\x20from\x20standard\x20storage.','refreshCalendar\x20failed:\x20','generateHealthReport','isSolar','triggerGaitAnalysis\x20parse\x20error:\x20','events.history','updateTopology','warn','Keine\x20Daten','Standard','\x20(Bewohner\x20anwesend\x20-\x20normal)','dependencyInstallInProgress','setState','text','61540ARIXMd','checkLicense','includes','getHours','eventHistory','scanForDevices','cogni-living\x20adapter\x20starting\x20(v','getAbsoluteDefaultDataDir','checkWifiPresence','üíæ\x20Saving\x20Daily\x20History\x20for\x20','runGeminiAnalysis','[Integrator]\x20Error:\x20','\x20>\x20','replace','triggerInfrasoundCorrelation','getObjectViewAsync','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','isPresent','VACATION','initZombies','application/json','Init...','triggerEnergyPrediction','TRAIN_COMFORT','pop','moduleComfort','history','getMinutes','Live\x20Event\x20Pulse','keys','system.adapter.ical.È¶ô','presenceDevices','apiKey','rows','outdoorSensorId','substring','callback','automation.triggerAction','Niemand','analysis.health.geminiNight','stateChange','forEach','date','checkWifiPresence:\x20Error\x20checking\x20','terrasse','sunny','add','analysis.training.triggerSecurity','analysis.automation.patternDetected','‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','analysis.energy.warmupTargets','toLowerCase','scanThermostats','setHours','toString','Sec-Training\x20started...','geminiApiKey','scheduleJob','üîä\x20Infraschall:\x20','refreshCalendar','Gemini\x20Report\x20Day','¬∞C)','val'];a0_0x731a=function(){return _0x28a1b4;};return a0_0x731a();}a0_0x1b91c0();'use strict';function a0_0x395f(_0x5526f1,_0x54c794){const _0x4c6f7a=a0_0x731a();return a0_0x395f=function(_0x1b91c0,_0x42ea43){_0x1b91c0=_0x1b91c0-0x1a2;let _0x731a3=_0x4c6f7a[_0x1b91c0];return _0x731a3;},a0_0x395f(_0x5526f1,_0x54c794);}const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x220c0d(0x2c4)),path=require('path'),fs=require('fs'),installer=require(a0_0x220c0d(0x1a5)),scanner=require('./lib/scanner'),schedulers=require('./lib/scheduler'),topology=require('./lib/topology'),setup=require('./lib/setup'),recorder=require(a0_0x220c0d(0x2cd)),pythonBridge=require('./lib/python_bridge'),aiAgent=require(a0_0x220c0d(0x277)),deadMan=require(a0_0x220c0d(0x224)),automation=require(a0_0x220c0d(0x1b5)),GEMINI_MODEL=a0_0x220c0d(0x2a1);class CogniLiving extends utils[a0_0x220c0d(0x2fe)]{constructor(_0x416086){const _0x3f7d7b=a0_0x220c0d;super({..._0x416086,'name':_0x3f7d7b(0x243)}),this['eventHistory']=[],this['analysisHistory']=[],this[_0x3f7d7b(0x251)]=[],this[_0x3f7d7b(0x29f)]=[],this[_0x3f7d7b(0x2a3)]={},this[_0x3f7d7b(0x2c7)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x3f7d7b(0x1ea)]=!![],this['exitTimer']=null,this['exitGraceTimer']=null,this[_0x3f7d7b(0x1a4)]=![],this[_0x3f7d7b(0x29c)]=null,this[_0x3f7d7b(0x23d)]=null,this[_0x3f7d7b(0x2dc)]=setup[_0x3f7d7b(0x240)][_0x3f7d7b(0x1b8)],this[_0x3f7d7b(0x2b4)]=![],this[_0x3f7d7b(0x26c)]=![],this[_0x3f7d7b(0x2b5)]=null,this['calendarCheckTimer']=null,this['presenceCheckTimer']=null,this[_0x3f7d7b(0x271)]=null,this['modeResetJob']=null,this[_0x3f7d7b(0x256)]=null,this['briefingJob']=null,this[_0x3f7d7b(0x2df)]=null,this[_0x3f7d7b(0x254)]=null,this[_0x3f7d7b(0x248)]=null,this['roomIntegratorTimer']=null,this[_0x3f7d7b(0x1d6)]=![],this['lastTrackerEventTime']=Date['now'](),this[_0x3f7d7b(0x268)]=null,this[_0x3f7d7b(0x2d8)]=Date[_0x3f7d7b(0x2a5)](),this[_0x3f7d7b(0x26b)]=![],this[_0x3f7d7b(0x2f2)]=[],this[_0x3f7d7b(0x2ae)]={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on']('ready',this[_0x3f7d7b(0x2db)]['bind'](this)),this['on'](_0x3f7d7b(0x201),this[_0x3f7d7b(0x2b9)][_0x3f7d7b(0x270)](this)),this['on'](_0x3f7d7b(0x2e4),this[_0x3f7d7b(0x1bf)][_0x3f7d7b(0x270)](this)),this['on'](_0x3f7d7b(0x28c),this[_0x3f7d7b(0x281)][_0x3f7d7b(0x270)](this));}async[a0_0x220c0d(0x2db)](){const _0x2f5e1f=a0_0x220c0d;this[_0x2f5e1f(0x1ae)][_0x2f5e1f(0x1bd)](_0x2f5e1f(0x1df)+this['version']+_0x2f5e1f(0x2d6));if(this[_0x2f5e1f(0x1c0)]['moduleHealth']!==undefined)this[_0x2f5e1f(0x2ae)][_0x2f5e1f(0x2ab)]=this['config'][_0x2f5e1f(0x2c0)];if(this['config'][_0x2f5e1f(0x27a)]!==undefined)this[_0x2f5e1f(0x2ae)][_0x2f5e1f(0x285)]=this[_0x2f5e1f(0x1c0)][_0x2f5e1f(0x27a)];if(this[_0x2f5e1f(0x1c0)][_0x2f5e1f(0x221)]!==undefined)this[_0x2f5e1f(0x2ae)][_0x2f5e1f(0x276)]=this['config']['moduleEnergy'];if(this['config']['moduleComfort']!==undefined)this[_0x2f5e1f(0x2ae)]['comfort']=this[_0x2f5e1f(0x1c0)][_0x2f5e1f(0x1f2)];if(this[_0x2f5e1f(0x1c0)][_0x2f5e1f(0x227)])this[_0x2f5e1f(0x2ae)]={...this[_0x2f5e1f(0x2ae)],...this[_0x2f5e1f(0x1c0)][_0x2f5e1f(0x227)]};this[_0x2f5e1f(0x1af)]();}async[a0_0x220c0d(0x1af)](){const _0x1f3711=a0_0x220c0d;await setup[_0x1f3711(0x1ec)](this);try{this[_0x1f3711(0x2b4)]=await setup[_0x1f3711(0x1da)](this['config'][_0x1f3711(0x25e)]);}catch(_0x24a5b1){}if(!this[_0x1f3711(0x1c0)][_0x1f3711(0x2d4)]||this[_0x1f3711(0x1c0)][_0x1f3711(0x2d4)]<0.1)this[_0x1f3711(0x1c0)][_0x1f3711(0x2d4)]=0xc;await setup['initHistory'](this),await setup[_0x1f3711(0x296)](this),topology[_0x1f3711(0x1d1)](this);try{const _0x112956=await this[_0x1f3711(0x264)](_0x1f3711(0x2bb)),_0x35a472=await this[_0x1f3711(0x264)](_0x1f3711(0x1c3));_0x112956&&_0x112956[_0x1f3711(0x217)]&&_0x35a472&&_0x35a472[_0x1f3711(0x217)]&&(Date[_0x1f3711(0x2a5)]()-_0x112956['ts']<0x4*0xe10*0x3e8&&(this[_0x1f3711(0x268)]={'times':JSON['parse'](_0x112956['val']),'sources':JSON[_0x1f3711(0x286)](_0x35a472[_0x1f3711(0x217)])}));}catch(_0x2f85f7){}if(this['config'][_0x1f3711(0x211)])try{this[_0x1f3711(0x29c)]=new GoogleGenerativeAI(this[_0x1f3711(0x1c0)]['geminiApiKey']),this[_0x1f3711(0x23d)]=this[_0x1f3711(0x29c)][_0x1f3711(0x1c5)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x1f3711(0x1ed)}});}catch(_0x50852a){this['log'][_0x1f3711(0x2a9)](_0x1f3711(0x1ad)+_0x50852a['message']);}await setup[_0x1f3711(0x2ed)](this),await this[_0x1f3711(0x263)](),schedulers[_0x1f3711(0x28b)](this),await this[_0x1f3711(0x279)]('analysis.visualization.pulse',{'type':_0x1f3711(0x29a),'common':{'name':_0x1f3711(0x1f5),'type':_0x1f3711(0x23b),'role':_0x1f3711(0x241),'read':!![],'write':![]},'native':{}}),await this[_0x1f3711(0x279)](_0x1f3711(0x2af),{'type':_0x1f3711(0x29a),'common':{'name':'Room\x20Dwell\x20Time\x20Stats','type':'string','role':_0x1f3711(0x2f5),'read':!![],'write':![],'def':_0x1f3711(0x290)},'native':{}}),await this[_0x1f3711(0x279)](_0x1f3711(0x2ef),{'type':_0x1f3711(0x29a),'common':{'name':_0x1f3711(0x2c6),'type':_0x1f3711(0x2e0),'role':'json','read':!![],'write':![],'def':'{\x22history\x22:{}}'},'native':{}}),await this[_0x1f3711(0x279)](_0x1f3711(0x200),{'type':_0x1f3711(0x29a),'common':{'name':_0x1f3711(0x1c9),'type':_0x1f3711(0x2e0),'role':_0x1f3711(0x1d8),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this[_0x1f3711(0x279)]('analysis.health.geminiDay',{'type':_0x1f3711(0x29a),'common':{'name':_0x1f3711(0x215),'type':_0x1f3711(0x2e0),'role':_0x1f3711(0x1d8),'read':!![],'write':![],'def':_0x1f3711(0x282)},'native':{}}),await this[_0x1f3711(0x279)](_0x1f3711(0x226),{'type':_0x1f3711(0x29a),'common':{'name':_0x1f3711(0x2cb),'type':'string','role':_0x1f3711(0x2f5),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1f3711(0x279)](_0x1f3711(0x1bb),{'type':'state','common':{'name':_0x1f3711(0x2a4),'type':_0x1f3711(0x2e0),'role':_0x1f3711(0x2f5),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x1f3711(0x279)](_0x1f3711(0x2a6),{'type':'state','common':{'name':_0x1f3711(0x2b3),'type':'number','role':_0x1f3711(0x241),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x1f3711(0x279)](_0x1f3711(0x2bb),{'type':'state','common':{'name':_0x1f3711(0x291),'type':_0x1f3711(0x2e0),'role':_0x1f3711(0x2f5),'read':!![],'write':![]},'native':{}});try{const _0x5d1588=await this[_0x1f3711(0x264)](_0x1f3711(0x1d0));if(_0x5d1588&&_0x5d1588[_0x1f3711(0x217)]){this[_0x1f3711(0x1dd)]=JSON[_0x1f3711(0x286)](_0x5d1588['val']);if(this['isProVersion']){const _0x49fe2c=await this[_0x1f3711(0x264)](_0x1f3711(0x244));if(_0x49fe2c&&_0x49fe2c[_0x1f3711(0x217)])this[_0x1f3711(0x251)]=JSON[_0x1f3711(0x286)](_0x49fe2c[_0x1f3711(0x217)]);}this['log']['info']('üì¶\x20Restored\x20'+this['eventHistory']['length']+_0x1f3711(0x1cb));}}catch(_0x5ab529){this['eventHistory']=[];}try{const _0x4e0455=await this[_0x1f3711(0x264)](_0x1f3711(0x21f));if(_0x4e0455&&_0x4e0455[_0x1f3711(0x217)])this[_0x1f3711(0x29f)]=JSON[_0x1f3711(0x286)](_0x4e0455['val']);}catch(_0x5bbd58){this[_0x1f3711(0x29f)]=[];}const _0x13d609=this[_0x1f3711(0x29f)]['length']>=(this[_0x1f3711(0x1c0)][_0x1f3711(0x1b7)]||0x7)?_0x1f3711(0x306)+this[_0x1f3711(0x29f)][_0x1f3711(0x2c5)]+'\x20Tage)':_0x1f3711(0x1ab)+this['dailyDigests'][_0x1f3711(0x2c5)]+'/'+(this[_0x1f3711(0x1c0)]['minDaysForBaseline']||0x7)+')';await this['setStateAsync']('LTM.baselineStatus',{'val':_0x13d609,'ack':!![]}),this[_0x1f3711(0x2fc)](_0x1f3711(0x287)),this[_0x1f3711(0x2fc)](_0x1f3711(0x28a)),this[_0x1f3711(0x2fc)](_0x1f3711(0x2b0));this[_0x1f3711(0x1c0)][_0x1f3711(0x1c2)]&&this['config'][_0x1f3711(0x239)]&&this[_0x1f3711(0x2ae)]['security']&&this[_0x1f3711(0x2a8)](this[_0x1f3711(0x1c0)][_0x1f3711(0x239)]);const _0x5cf7ac=this[_0x1f3711(0x1c0)][_0x1f3711(0x1aa)];if(_0x5cf7ac)for(const _0x174c7c of _0x5cf7ac){await this[_0x1f3711(0x223)](_0x174c7c['id']);}const _0x410fb1=this[_0x1f3711(0x1c0)][_0x1f3711(0x1f8)];if(_0x410fb1)for(const _0x468ec9 of _0x410fb1){await this['subscribeForeignStatesAsync'](_0x468ec9);}const _0x1c3b42=require('node-schedule');if(this[_0x1f3711(0x2df)])this[_0x1f3711(0x2df)]['cancel']();this['historyJob']=_0x1c3b42[_0x1f3711(0x212)](_0x1f3711(0x1a9),()=>{const _0x338f8d=_0x1f3711;this[_0x338f8d(0x2ca)]();}),setTimeout(()=>this['replayTodayEvents'](),0x1388);if(this[_0x1f3711(0x2e2)])clearInterval(this[_0x1f3711(0x2e2)]);this[_0x1f3711(0x1b2)](),this['roomIntegratorTimer']=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this['healthTrendInterval'])clearInterval(this[_0x1f3711(0x248)]);this[_0x1f3711(0x248)]=setInterval(()=>{const _0x137869=_0x1f3711;this[_0x137869(0x2b4)]&&this[_0x137869(0x2ae)][_0x137869(0x2ab)]&&this[_0x137869(0x2ac)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x1f3711(0x2b5)])clearInterval(this[_0x1f3711(0x2b5)]);this[_0x1f3711(0x2ae)]['energy']&&(this[_0x1f3711(0x2b5)]=setInterval(()=>{this['triggerEnergyPrediction']();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x1f3711(0x1ef)](),0x2710));if(this['calendarCheckTimer'])clearInterval(this[_0x1f3711(0x2c2)]);this['config'][_0x1f3711(0x265)]&&this[_0x1f3711(0x2ae)]['energy']&&(this[_0x1f3711(0x2c2)]=setInterval(()=>{const _0x370236=_0x1f3711;automation[_0x370236(0x298)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x1f3711(0x298)](this),0x3a98));if(this[_0x1f3711(0x29d)])clearInterval(this['presenceCheckTimer']);this['config']['presenceDevices']&&this[_0x1f3711(0x1c0)][_0x1f3711(0x1f8)][_0x1f3711(0x2c5)]>0x0&&(this[_0x1f3711(0x29d)]=setInterval(async()=>{const _0x40fa36=_0x1f3711;await this[_0x40fa36(0x1e1)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0x1f3711(0x1e1)](),0x1388));const _0x3ea0b4=path[_0x1f3711(0x26d)](__dirname,'.venv','bin',_0x1f3711(0x220));pythonBridge[_0x1f3711(0x2d0)](this,_0x3ea0b4);}[a0_0x220c0d(0x1bf)](_0x1f42c2){const _0xc4848d=a0_0x220c0d;if(this['historyJob'])this[_0xc4848d(0x2df)]['cancel']();this['saveDailyHistory']()[_0xc4848d(0x222)](()=>{const _0x28ee84=_0xc4848d;if(this[_0x28ee84(0x2b5)])clearInterval(this[_0x28ee84(0x2b5)]);if(this['calendarCheckTimer'])clearInterval(this['calendarCheckTimer']);if(this[_0x28ee84(0x29d)])clearInterval(this[_0x28ee84(0x29d)]);if(this['roomIntegratorTimer'])clearInterval(this[_0x28ee84(0x2e2)]);recorder['abortExitTimer'](this),pythonBridge[_0x28ee84(0x1a2)](this),_0x1f42c2();});}async[a0_0x220c0d(0x27d)](){const _0xef2d91=a0_0x220c0d;if(!this[_0xef2d91(0x1dd)]||this['eventHistory'][_0xef2d91(0x2c5)]===0x0){this['log']['warn'](_0xef2d91(0x2e8));return;}this['log'][_0xef2d91(0x1bd)]('‚Ü∫\x20Replaying\x20'+this['eventHistory'][_0xef2d91(0x2c5)]+_0xef2d91(0x299));const _0x3493c1=new Date()[_0xef2d91(0x20e)](0x0,0x0,0x0,0x0),_0x4a9c36=_0xef2d91(0x2ef);let _0x461ec3={'history':{},'date':new Date()[_0xef2d91(0x22e)]()};const _0x139dbb=_0xef2d91(0x226),_0x5b8bfb=_0xef2d91(0x1bb);let _0x1d8253=new Array(0x30)[_0xef2d91(0x255)](0x0),_0x20f929=Array[_0xef2d91(0x257)]({'length':0x30},()=>[]);this['eventHistory']['forEach'](_0x352b15=>{const _0x24bde4=_0xef2d91;if(_0x352b15[_0x24bde4(0x2d7)]>=_0x3493c1){if(recorder['isRelevantActivity'](_0x352b15[_0x24bde4(0x2c1)],_0x352b15[_0x24bde4(0x241)])){const _0x2a3446=new Date(_0x352b15[_0x24bde4(0x2d7)]),_0x40b8ae=_0x2a3446[_0x24bde4(0x1dc)]()*0x2+(_0x2a3446[_0x24bde4(0x1f4)]()>=0x1e?0x1:0x0);if(_0x40b8ae<0x30){_0x1d8253[_0x40b8ae]++;const _0x2feac5=_0x352b15[_0x24bde4(0x283)]||_0x352b15[_0x24bde4(0x2a0)]||'?';let _0x5035ce=_0x20f929[_0x40b8ae];!_0x5035ce[_0x24bde4(0x1db)](_0x2feac5)&&_0x5035ce[_0x24bde4(0x2c9)](_0x2feac5);}const _0x3e3eef=_0x2a3446['getHours']();let _0x4f5c36=_0x352b15['location']||_0x24bde4(0x1c6);const _0x331fa6=(this['config'][_0x24bde4(0x1aa)]||[])['find'](_0x3bd219=>_0x3bd219[_0x24bde4(0x283)]===_0x4f5c36);if(_0x331fa6)_0x4f5c36=_0x331fa6[_0x24bde4(0x283)];if(!_0x461ec3[_0x24bde4(0x1f3)][_0x4f5c36])_0x461ec3[_0x24bde4(0x1f3)][_0x4f5c36]=new Array(0x18)[_0x24bde4(0x255)](0x0);if(_0x461ec3[_0x24bde4(0x1f3)][_0x4f5c36][_0x3e3eef]<0x3c)_0x461ec3['history'][_0x4f5c36][_0x3e3eef]++;}}});const _0x1e4d7a=await this[_0xef2d91(0x264)](_0x4a9c36);(!_0x1e4d7a||!_0x1e4d7a['val']||_0x1e4d7a[_0xef2d91(0x217)]==='{}'||_0x1e4d7a[_0xef2d91(0x217)][_0xef2d91(0x1db)](_0xef2d91(0x2b6)))&&await this[_0xef2d91(0x1b1)](_0x4a9c36,{'val':JSON[_0xef2d91(0x2ec)](_0x461ec3),'ack':!![]}),await this[_0xef2d91(0x1b1)](_0x139dbb,{'val':JSON[_0xef2d91(0x2ec)](_0x1d8253),'ack':!![]}),await this['setStateAsync'](_0x5b8bfb,{'val':JSON[_0xef2d91(0x2ec)](_0x20f929),'ack':!![]}),this['log']['info'](_0xef2d91(0x1e9));}async['saveDailyHistory'](){const _0x3f8a41=a0_0x220c0d;if(!this[_0x3f8a41(0x2ae)][_0x3f8a41(0x2ab)])return;const _0x36a9c3=new Date()[_0x3f8a41(0x2e1)]()[_0x3f8a41(0x1a3)]('T')[0x0];this['log'][_0x3f8a41(0x27c)](_0x3f8a41(0x1e2)+_0x36a9c3+_0x3f8a41(0x25b));try{const [_0x16eac5,_0x49bd11,_0x4a1038,_0x1001bf,_0x1ff832,_0x263d21]=await Promise[_0x3f8a41(0x2d3)]([this[_0x3f8a41(0x264)](_0x3f8a41(0x2ef)),this[_0x3f8a41(0x264)](_0x3f8a41(0x200)),this[_0x3f8a41(0x264)]('analysis.health.geminiDay'),this[_0x3f8a41(0x264)]('analysis.security.lastScore'),this['getStateAsync']('analysis.health.todayVector'),this[_0x3f8a41(0x264)](_0x3f8a41(0x2a6))]),_0x1b6151=this[_0x3f8a41(0x1dd)][_0x3f8a41(0x252)](_0x5b6b06=>_0x5b6b06[_0x3f8a41(0x2d7)]>=new Date()[_0x3f8a41(0x20e)](0x0,0x0,0x0,0x0)&&(_0x5b6b06[_0x3f8a41(0x2a0)]['toLowerCase']()['includes'](_0x3f8a41(0x2bc))||_0x5b6b06[_0x3f8a41(0x2a0)][_0x3f8a41(0x20c)]()[_0x3f8a41(0x1db)](_0x3f8a41(0x205)))&&(_0x5b6b06[_0x3f8a41(0x241)]===!![]||_0x5b6b06['value']===_0x3f8a41(0x1c4)))[_0x3f8a41(0x2c5)];let _0x42b614=0x55;if(_0x263d21&&_0x263d21[_0x3f8a41(0x217)]!==undefined)_0x42b614=Math[_0x3f8a41(0x2fa)](0x64,Math[_0x3f8a41(0x2c8)](0x14,Math[_0x3f8a41(0x1a6)](0x50+Number(_0x263d21[_0x3f8a41(0x217)])*0x5)));const _0x522605={'date':_0x36a9c3,'timestamp':Date[_0x3f8a41(0x2a5)](),'roomHistory':_0x16eac5?.[_0x3f8a41(0x217)]?JSON['parse'](_0x16eac5[_0x3f8a41(0x217)]):{},'geminiNight':_0x49bd11?.[_0x3f8a41(0x217)]||_0x3f8a41(0x1d3),'geminiDay':_0x4a1038?.['val']||'Keine\x20Daten','anomalyScore':_0x1001bf?.[_0x3f8a41(0x217)]||0.1,'todayVector':_0x1ff832?.[_0x3f8a41(0x217)]?JSON[_0x3f8a41(0x286)](_0x1ff832['val']):new Array(0x30)[_0x3f8a41(0x255)](0x0),'batteryLevel':_0x42b614,'freshAirCount':_0x1b6151,'eventHistory':this[_0x3f8a41(0x1dd)]},_0x202e89=utils[_0x3f8a41(0x1e0)](),_0x599fed=path[_0x3f8a41(0x26d)](_0x202e89,_0x3f8a41(0x243),_0x3f8a41(0x1f3));if(!fs['existsSync'](_0x599fed))fs['mkdirSync'](_0x599fed,{'recursive':!![]});const _0x5c6c9c=path[_0x3f8a41(0x26d)](_0x599fed,_0x36a9c3+_0x3f8a41(0x218));fs[_0x3f8a41(0x2fb)](_0x5c6c9c,JSON[_0x3f8a41(0x2ec)](_0x522605)),this[_0x3f8a41(0x1ae)][_0x3f8a41(0x1bd)](_0x3f8a41(0x236)+_0x5c6c9c);}catch(_0x346d6a){this[_0x3f8a41(0x1ae)][_0x3f8a41(0x2a9)](_0x3f8a41(0x2f1)+_0x346d6a[_0x3f8a41(0x28c)]);}}async[a0_0x220c0d(0x1b2)](){const _0xaeb62=a0_0x220c0d;if(!this['isPresent'])return;try{let _0xed37cd=null;try{const _0x21bfd3=await this[_0xaeb62(0x264)]('analysis.prediction.trackerTopRoom'),_0x579b5b=await this[_0xaeb62(0x264)](_0xaeb62(0x21e));if(_0x21bfd3&&_0x21bfd3['val']&&_0x579b5b&&_0x579b5b[_0xaeb62(0x217)]&&_0x579b5b[_0xaeb62(0x217)]>0.3){if(_0x21bfd3[_0xaeb62(0x217)]!=='Unknown'&&_0x21bfd3['val']!==_0xaeb62(0x1ee))_0xed37cd=_0x21bfd3[_0xaeb62(0x217)];}}catch(_0x2e8039){}if(!_0xed37cd){const _0x41b30a=this[_0xaeb62(0x1c0)][_0xaeb62(0x1aa)]||[];for(const _0x503358 of _0x41b30a){if(_0x503358[_0xaeb62(0x2c1)]===_0xaeb62(0x2eb)&&_0x503358[_0xaeb62(0x283)])try{const _0x2b2833=await this[_0xaeb62(0x2d1)](_0x503358['id']);if(_0x2b2833&&(_0x2b2833[_0xaeb62(0x217)]===!![]||_0x2b2833[_0xaeb62(0x217)]==='on'||_0x2b2833[_0xaeb62(0x217)]===0x1)){_0xed37cd=_0x503358['location'];break;}}catch(_0x19ebe0){}}}if(!_0xed37cd)return;const _0x2afb7f=this['config'][_0xaeb62(0x1aa)]||[];let _0x595e07=_0xed37cd;const _0x33a58b=_0x2afb7f[_0xaeb62(0x2cc)](_0x19ae0a=>_0x19ae0a[_0xaeb62(0x283)]&&_0x19ae0a['location'][_0xaeb62(0x20c)]()===_0xed37cd[_0xaeb62(0x20c)]());if(_0x33a58b)_0x595e07=_0x33a58b[_0xaeb62(0x283)];const _0x69b7a3=_0xaeb62(0x2ef),_0x421fe4=await this[_0xaeb62(0x264)](_0x69b7a3),_0x367239=new Date()[_0xaeb62(0x22e)]();let _0x1e9624={'history':{},'date':_0x367239};if(_0x421fe4&&_0x421fe4[_0xaeb62(0x217)])try{_0x1e9624=JSON[_0xaeb62(0x286)](_0x421fe4['val']);}catch(_0x59dd46){}_0x1e9624['date']!==_0x367239&&(_0x1e9624[_0xaeb62(0x1f3)]={},_0x1e9624[_0xaeb62(0x203)]=_0x367239);if(!_0x1e9624[_0xaeb62(0x1f3)][_0x595e07])_0x1e9624[_0xaeb62(0x1f3)][_0x595e07]=new Array(0x18)[_0xaeb62(0x255)](0x0);const _0x5bdda8=new Date()[_0xaeb62(0x1dc)]();if(_0x1e9624[_0xaeb62(0x1f3)][_0x595e07][_0x5bdda8]<0x3c)_0x1e9624[_0xaeb62(0x1f3)][_0x595e07][_0x5bdda8]++;await this[_0xaeb62(0x1b1)](_0x69b7a3,{'val':JSON[_0xaeb62(0x2ec)](_0x1e9624),'ack':!![]});}catch(_0x5bca40){this[_0xaeb62(0x1ae)][_0xaeb62(0x1d2)](_0xaeb62(0x1e4)+_0x5bca40['message']);}}async['onMessage'](_0x154986){const _0x1bfa59=a0_0x220c0d;if(typeof _0x154986==='object'&&_0x154986[_0x1bfa59(0x28c)]){if(_0x154986[_0x1bfa59(0x26f)]===_0x1bfa59(0x2da)){const _0x3131ab=_0x154986[_0x1bfa59(0x28c)]['date'],_0x50a3e6=utils['getAbsoluteDefaultDataDir'](),_0x4a81b1=path[_0x1bfa59(0x26d)](_0x50a3e6,_0x1bfa59(0x243),_0x1bfa59(0x1f3),_0x3131ab+'.json');if(fs[_0x1bfa59(0x22b)](_0x4a81b1))try{const _0x2717a0=JSON[_0x1bfa59(0x286)](fs['readFileSync'](_0x4a81b1,_0x1bfa59(0x1a8)));this[_0x1bfa59(0x1b6)](_0x154986['from'],_0x154986['command'],{'success':!![],'data':_0x2717a0},_0x154986['callback']);}catch(_0x179245){this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986[_0x1bfa59(0x26f)],{'success':![],'error':_0x1bfa59(0x2f9)},_0x154986[_0x1bfa59(0x1fd)]);}else this[_0x1bfa59(0x1b6)](_0x154986['from'],_0x154986[_0x1bfa59(0x26f)],{'success':![],'error':_0x1bfa59(0x242)},_0x154986[_0x1bfa59(0x1fd)]);}else{if(_0x154986[_0x1bfa59(0x26f)]===_0x1bfa59(0x293)){const _0x1cb882=this[_0x1bfa59(0x29f)][_0x1bfa59(0x2c5)];let _0x31032f=new Array(0x30)[_0x1bfa59(0x255)](0x0),_0x1ae9d5=Array[_0x1bfa59(0x257)]({'length':0x30},()=>[]);try{const _0x46d8b0=await this[_0x1bfa59(0x264)](_0x1bfa59(0x226));if(_0x46d8b0&&_0x46d8b0[_0x1bfa59(0x217)])_0x31032f=JSON[_0x1bfa59(0x286)](_0x46d8b0[_0x1bfa59(0x217)]);const _0x5821e5=await this['getStateAsync'](_0x1bfa59(0x1bb));if(_0x5821e5&&_0x5821e5[_0x1bfa59(0x217)])_0x1ae9d5=JSON[_0x1bfa59(0x286)](_0x5821e5[_0x1bfa59(0x217)]);}catch(_0x60b7ee){}let _0x3ac4cf=new Array(0x30)['fill'](0x0);try{const _0x4a1ad1=new Date();_0x4a1ad1['setDate'](_0x4a1ad1[_0x1bfa59(0x24a)]()-0x1);const _0x4a3e39=_0x4a1ad1[_0x1bfa59(0x2e1)]()['split']('T')[0x0],_0x36e313=utils[_0x1bfa59(0x1e0)](),_0x35f4d7=path[_0x1bfa59(0x26d)](_0x36e313,_0x1bfa59(0x243),'history',_0x4a3e39+_0x1bfa59(0x218));if(fs[_0x1bfa59(0x22b)](_0x35f4d7)){const _0x53d5f4=JSON[_0x1bfa59(0x286)](fs[_0x1bfa59(0x1bc)](_0x35f4d7,_0x1bfa59(0x1a8)));if(_0x53d5f4&&_0x53d5f4['todayVector'])_0x3ac4cf=_0x53d5f4[_0x1bfa59(0x2e6)];}}catch(_0x2ce50c){}let _0x3beb43={'today':{},'yesterday':{}};try{const _0x3c9e4c=await this['getStateAsync'](_0x1bfa59(0x2af));if(_0x3c9e4c&&_0x3c9e4c[_0x1bfa59(0x217)])_0x3beb43=JSON[_0x1bfa59(0x286)](_0x3c9e4c['val']);}catch(_0x2c84d6){}let _0x24858d=null;try{const _0xc7310f=await this[_0x1bfa59(0x264)](_0x1bfa59(0x2a6));if(_0xc7310f)_0x24858d=_0xc7310f[_0x1bfa59(0x217)];}catch(_0x55d531){}if(_0x24858d===undefined||_0x24858d===null){const _0x4e1c17=_0x31032f[_0x1bfa59(0x2e3)]((_0x485a57,_0xbc1ec9)=>_0x485a57+_0xbc1ec9,0x0),_0x59fe6b=Math[_0x1bfa59(0x2fa)](0x2,Math[_0x1bfa59(0x2c8)](-0x2,(0x64-_0x4e1c17)/0x32));_0x24858d=_0x59fe6b;}let _0xde9d15=![],_0x3d91ed='',_0x50effd='',_0x2d3e80='';try{const _0x4706bb=await this[_0x1bfa59(0x264)](_0x1bfa59(0x209));if(_0x4706bb&&_0x4706bb[_0x1bfa59(0x217)]){_0xde9d15=!![];const _0x777bce=await this[_0x1bfa59(0x264)]('analysis.automation.description');_0x3d91ed=_0x777bce?_0x777bce[_0x1bfa59(0x217)]:'';const _0x11e0b4=await this[_0x1bfa59(0x264)](_0x1bfa59(0x292));_0x50effd=_0x11e0b4?_0x11e0b4['val']:'';const _0x340347=await this['getStateAsync'](_0x1bfa59(0x22c));_0x2d3e80=_0x340347?_0x340347[_0x1bfa59(0x217)]:'';}}catch(_0x465ca7){}const _0x59e9af=await this[_0x1bfa59(0x23c)](),_0x43b57d=(this[_0x1bfa59(0x1c0)][_0x1bfa59(0x1aa)]||[])[_0x1bfa59(0x235)](_0x17dba7=>_0x17dba7[_0x1bfa59(0x1ce)]),_0x401de1=_0x59e9af&&_0x43b57d;let _0x25f3fd='';try{const _0x2c9858=await this[_0x1bfa59(0x264)]('system.presenceWho');if(_0x2c9858&&_0x2c9858[_0x1bfa59(0x217)])_0x25f3fd=_0x2c9858[_0x1bfa59(0x217)];}catch(_0xcca263){}this['sendTo'](_0x154986[_0x1bfa59(0x257)],_0x154986['command'],{'success':!![],'eventHistory':this['eventHistory'][_0x1bfa59(0x2bf)](0x0,0x7d0),'stats':{'digestCount':_0x1cb882,'isPresent':this[_0x1bfa59(0x1ea)],'hourlyActivity':_0x31032f,'hourlyDetails':_0x1ae9d5,'yesterdayActivity':_0x3ac4cf,'solarActive':_0x401de1,'presenceWho':_0x25f3fd,'roomStats':_0x3beb43,'activityTrend':_0x24858d,'modules':this[_0x1bfa59(0x2ae)]},'automation':{'detected':_0xde9d15,'description':_0x3d91ed,'targetId':_0x50effd,'targetValue':_0x2d3e80}},_0x154986['callback']);}else{if(_0x154986[_0x1bfa59(0x26f)]===_0x1bfa59(0x280))try{const _0x29cac8=await automation[_0x1bfa59(0x20d)](this);this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986['command'],{'success':!![],'results':_0x29cac8},_0x154986[_0x1bfa59(0x1fd)]);}catch(_0x26c7da){this['sendTo'](_0x154986[_0x1bfa59(0x257)],_0x154986['command'],{'success':![],'error':_0x26c7da[_0x1bfa59(0x28c)]},_0x154986[_0x1bfa59(0x1fd)]);}else{if(_0x154986[_0x1bfa59(0x26f)]===_0x1bfa59(0x23a))try{const _0x3b241a=await scanner[_0x1bfa59(0x1de)](this,_0x154986[_0x1bfa59(0x28c)]||{});this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986[_0x1bfa59(0x26f)],{'success':!![],'devices':_0x3b241a},_0x154986[_0x1bfa59(0x1fd)]);}catch(_0x3540d6){}else{if(_0x154986[_0x1bfa59(0x26f)]===_0x1bfa59(0x1be)){const _0x4e5dbf=await this[_0x1bfa59(0x253)](_0x1bfa59(0x228),_0x1bfa59(0x29e)),_0x3a8126=[];if(_0x4e5dbf)for(const _0x33d357 in _0x4e5dbf){let _0x325e3a=_0x4e5dbf[_0x33d357][_0x1bfa59(0x26a)][_0x1bfa59(0x2a0)];if(_0x325e3a&&typeof _0x325e3a==='object')_0x325e3a=_0x325e3a['de']||_0x325e3a['en']||Object[_0x1bfa59(0x297)](_0x325e3a)[0x0]||JSON[_0x1bfa59(0x2ec)](_0x325e3a);_0x3a8126['push']({'id':_0x33d357,'name':String(_0x325e3a||_0x33d357)});}const _0x33ca3b=await this['getForeignObjectsAsync']('enum.rooms.*',_0x1bfa59(0x29e)),_0x3383a7=[];if(_0x33ca3b)for(const _0x5774d5 in _0x33ca3b){let _0x3f8b34=_0x33ca3b[_0x5774d5][_0x1bfa59(0x26a)][_0x1bfa59(0x2a0)];if(_0x3f8b34&&typeof _0x3f8b34===_0x1bfa59(0x259))_0x3f8b34=_0x3f8b34['de']||_0x3f8b34['en']||Object['values'](_0x3f8b34)[0x0]||JSON['stringify'](_0x3f8b34);_0x3383a7[_0x1bfa59(0x2c9)](String(_0x3f8b34||_0x5774d5[_0x1bfa59(0x1a3)]('.')['pop']()));}this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986[_0x1bfa59(0x26f)],{'success':!![],'enums':_0x3a8126,'rooms':_0x3383a7},_0x154986[_0x1bfa59(0x1fd)]);}else{if(_0x154986[_0x1bfa59(0x26f)]===_0x1bfa59(0x302))try{const _0x54449a=await this[_0x1bfa59(0x1e8)]('system',_0x1bfa59(0x1b3),{'startkey':_0x1bfa59(0x2b8),'endkey':_0x1bfa59(0x1f7)}),_0x54691c=new Set();if(_0x54449a&&_0x54449a[_0x1bfa59(0x1fa)])for(const _0xad0393 of _0x54449a[_0x1bfa59(0x1fa)]){const _0x12bb84=_0xad0393['id'][_0x1bfa59(0x1e6)]('system.adapter.',''),_0x1c31b9=await this['getForeignStateAsync'](_0x12bb84+_0x1bfa59(0x2dd));let _0xe237e4=![];if(_0x1c31b9&&_0x1c31b9['val']){const _0x14d374=typeof _0x1c31b9[_0x1bfa59(0x217)]==='string'?JSON[_0x1bfa59(0x286)](_0x1c31b9[_0x1bfa59(0x217)]):_0x1c31b9['val'];Array[_0x1bfa59(0x262)](_0x14d374)&&_0x14d374['forEach'](_0x4f722a=>{const _0x3881f3=_0x1bfa59;_0x4f722a['calendarName']&&(_0x54691c['add'](_0x4f722a[_0x3881f3(0x2a2)]),_0xe237e4=!![]);});}!_0xe237e4&&_0x54691c[_0x1bfa59(0x207)](_0x12bb84);}const _0x22f25f=Array[_0x1bfa59(0x257)](_0x54691c);if(_0x22f25f['length']===0x0)_0x22f25f[_0x1bfa59(0x2c9)](_0x1bfa59(0x1d4));this[_0x1bfa59(0x1b6)](_0x154986['from'],_0x154986[_0x1bfa59(0x26f)],{'success':!![],'names':_0x22f25f},_0x154986[_0x1bfa59(0x1fd)]);}catch(_0x194f2d){this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986[_0x1bfa59(0x26f)],{'success':![],'error':_0x1bfa59(0x289)+_0x194f2d[_0x1bfa59(0x28c)]},_0x154986[_0x1bfa59(0x1fd)]);}else{if(_0x154986['command']===_0x1bfa59(0x214))try{await automation[_0x1bfa59(0x1ca)](this),this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986['command'],{'success':!![]},_0x154986[_0x1bfa59(0x1fd)]);}catch(_0x619551){this[_0x1bfa59(0x1ae)][_0x1bfa59(0x1d2)](_0x1bfa59(0x1cc)+_0x619551[_0x1bfa59(0x28c)]),this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986[_0x1bfa59(0x26f)],{'success':![],'error':_0x619551['message']},_0x154986[_0x1bfa59(0x1fd)]);}else{if(_0x154986[_0x1bfa59(0x26f)]===_0x1bfa59(0x28e))try{const _0xd462b3=_0x154986[_0x1bfa59(0x28c)]['command'],_0x2dfb4c=_0x154986[_0x1bfa59(0x28c)];this['log'][_0x1bfa59(0x27c)](_0x1bfa59(0x1b9)+_0xd462b3),pythonBridge['send'](this,_0xd462b3,_0x2dfb4c,_0x4710da=>{const _0x41801f=_0x1bfa59;this[_0x41801f(0x1b6)](_0x154986['from'],_0x154986[_0x41801f(0x26f)],_0x4710da,_0x154986[_0x41801f(0x1fd)]);});}catch(_0x47abcc){this[_0x1bfa59(0x1ae)][_0x1bfa59(0x1d2)](_0x1bfa59(0x2ff)+_0x47abcc[_0x1bfa59(0x28c)]),this[_0x1bfa59(0x1b6)](_0x154986['from'],_0x154986['command'],{'type':_0x1bfa59(0x22f),'payload':_0x47abcc['message']},_0x154986[_0x1bfa59(0x1fd)]);}else{if(_0x154986[_0x1bfa59(0x26f)]===_0x1bfa59(0x21c))try{const _0x189fc2=_0x154986[_0x1bfa59(0x28c)]?_0x154986['message'][_0x1bfa59(0x1f9)]:'';if(!_0x189fc2)throw new Error(_0x1bfa59(0x25f));const _0x44e18e=new GoogleGenerativeAI(_0x189fc2),_0x34ccd3=_0x44e18e[_0x1bfa59(0x1c5)]({'model':GEMINI_MODEL}),_0x50172c=await _0x34ccd3['generateContent']('Say\x20Hello'),_0x52f79c=await _0x50172c[_0x1bfa59(0x233)],_0x3b22d8=_0x52f79c['text']();this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986['command'],{'success':!![],'message':'Verbindung\x20erfolgreich:\x20'+_0x3b22d8[_0x1bfa59(0x1fc)](0x0,0x14)+_0x1bfa59(0x25b)},_0x154986[_0x1bfa59(0x1fd)]);}catch(_0x3334d4){this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986['command'],{'success':![],'message':_0x3334d4[_0x1bfa59(0x28c)]},_0x154986[_0x1bfa59(0x1fd)]);}else{if(_0x154986['command']===_0x1bfa59(0x284))try{const _0x3822df=await this['checkSolarCondition'](),_0x17e882=await this['getObjectViewAsync'](_0x1bfa59(0x245),_0x1bfa59(0x1b3),{'startkey':'system.adapter.ical.','endkey':_0x1bfa59(0x1f7)}),_0x1c3219=_0x17e882&&_0x17e882[_0x1bfa59(0x1fa)]?_0x17e882[_0x1bfa59(0x1fa)][_0x1bfa59(0x2c5)]:0x0;this[_0x1bfa59(0x1b6)](_0x154986['from'],_0x154986[_0x1bfa59(0x26f)],{'success':!![],'weather':_0x1bfa59(0x25a)+_0x3822df+_0x1bfa59(0x1ba)+(this[_0x1bfa59(0x2a3)][this[_0x1bfa59(0x1c0)][_0x1bfa59(0x1fb)]]||'?')+'¬∞C','calendar':_0x1c3219+_0x1bfa59(0x2ad)},_0x154986[_0x1bfa59(0x1fd)]);}catch(_0x16673c){this[_0x1bfa59(0x1b6)](_0x154986[_0x1bfa59(0x257)],_0x154986[_0x1bfa59(0x26f)],{'success':![]},_0x154986[_0x1bfa59(0x1fd)]);}}}}}}}}}}}}['runPythonHealthCheck'](){const _0x3beccb=a0_0x220c0d;if(!this[_0x3beccb(0x2ae)][_0x3beccb(0x2ab)])return;this[_0x3beccb(0x1ae)]['debug'](_0x3beccb(0x260));try{const _0x3c2c31=this[_0x3beccb(0x251)]||[];pythonBridge['send'](this,_0x3beccb(0x295),{'events':_0x3c2c31});}catch(_0x376052){this[_0x3beccb(0x1ae)]['warn']('Failed\x20to\x20trigger\x20Python\x20Health\x20Check');}}async[a0_0x220c0d(0x2b9)](_0x2ee4db,_0x34568b){const _0x48d1a7=a0_0x220c0d;if(!_0x34568b||this[_0x48d1a7(0x1d6)])return;if(_0x2ee4db[_0x48d1a7(0x1db)](_0x48d1a7(0x2d2))&&_0x2ee4db[_0x48d1a7(0x23e)]('communicate.request')&&_0x34568b[_0x48d1a7(0x217)])return;if(this[_0x48d1a7(0x1c0)]['infrasoundEnabled']&&_0x2ee4db===this[_0x48d1a7(0x1c0)][_0x48d1a7(0x239)]&&this[_0x48d1a7(0x2ae)][_0x48d1a7(0x285)]){this['handleInfrasound'](_0x34568b[_0x48d1a7(0x217)]);return;}if(_0x34568b[_0x48d1a7(0x2be)]&&_0x2ee4db['endsWith'](_0x48d1a7(0x1c8)))return;if(_0x2ee4db===this[_0x48d1a7(0x22a)]+_0x48d1a7(0x2e9)){if(_0x34568b[_0x48d1a7(0x217)]&&Object[_0x48d1a7(0x297)](setup['SYSTEM_MODES'])['includes'](_0x34568b[_0x48d1a7(0x217)])){this[_0x48d1a7(0x2dc)]=_0x34568b[_0x48d1a7(0x217)];if(_0x34568b[_0x48d1a7(0x217)]===setup[_0x48d1a7(0x240)][_0x48d1a7(0x1eb)])await recorder['setPresence'](this,![]);else await recorder[_0x48d1a7(0x261)](this,!![]);if(this['isProVersion']){let _0x4e2c09=![],_0x392411=0x0,_0x776dcd=_0x48d1a7(0x246);if(this['currentSystemMode']===_0x48d1a7(0x266))_0x4e2c09=!![],_0x392411=0x168,_0x776dcd=_0x48d1a7(0x269);else this[_0x48d1a7(0x2dc)]===_0x48d1a7(0x2b2)&&(_0x4e2c09=!![],_0x392411=0x5a0,_0x776dcd=_0x48d1a7(0x305));pythonBridge['send'](this,'SET_LEARNING_MODE',{'active':_0x4e2c09,'duration':_0x392411,'label':_0x776dcd}),await this[_0x48d1a7(0x1b1)](_0x48d1a7(0x2ba),{'val':JSON[_0x48d1a7(0x2ec)]({'active':_0x4e2c09,'label':_0x776dcd,'timestamp':Date['now']()}),'ack':!![]});}}if(!_0x34568b[_0x48d1a7(0x2be)])this[_0x48d1a7(0x1d7)](_0x2ee4db,{'val':this[_0x48d1a7(0x2dc)],'ack':!![]});return;}if(_0x2ee4db[_0x48d1a7(0x23e)](_0x48d1a7(0x1c3))&&_0x34568b[_0x48d1a7(0x2be)])this['protectAiMemory'](_0x34568b[_0x48d1a7(0x217)]);if(_0x2ee4db['endsWith'](_0x48d1a7(0x2bb))&&_0x34568b[_0x48d1a7(0x2be)]&&this[_0x48d1a7(0x2ae)][_0x48d1a7(0x276)])automation[_0x48d1a7(0x298)](this);if(!_0x34568b['ack']){if(_0x2ee4db[_0x48d1a7(0x1db)]('analysis.trigger')&&_0x34568b['val']){this[_0x48d1a7(0x1d7)](_0x2ee4db,{'val':![],'ack':!![]}),aiAgent[_0x48d1a7(0x1e3)](this);return;}if(_0x2ee4db[_0x48d1a7(0x1db)](_0x48d1a7(0x300))&&_0x34568b[_0x48d1a7(0x217)]){this[_0x48d1a7(0x1d7)](_0x2ee4db,{'val':![],'ack':!![]});if(this[_0x48d1a7(0x2b4)])aiAgent['createDailyDigest'](this,pythonBridge);return;}if(_0x2ee4db[_0x48d1a7(0x1db)]('triggerBriefing')&&_0x34568b[_0x48d1a7(0x217)]){this[_0x48d1a7(0x1d7)](_0x2ee4db,{'val':![],'ack':!![]}),aiAgent['sendMorningBriefing'](this);return;}if(_0x2ee4db[_0x48d1a7(0x1db)](_0x48d1a7(0x1fe))&&_0x34568b[_0x48d1a7(0x217)]){this['setState'](_0x2ee4db,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x2ee4db[_0x48d1a7(0x1db)](_0x48d1a7(0x208))&&_0x34568b[_0x48d1a7(0x217)]){this[_0x48d1a7(0x1d7)](_0x2ee4db,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x30d805=await this[_0x48d1a7(0x264)]('LTM.trainingData.sequences');if(_0x30d805&&_0x30d805[_0x48d1a7(0x217)]){const _0xf61190=JSON['parse'](_0x30d805[_0x48d1a7(0x217)]);this['setStateAsync'](_0x48d1a7(0x1b4),{'val':_0x48d1a7(0x210),'ack':!![]}),pythonBridge[_0x48d1a7(0x2a7)](this,_0x48d1a7(0x2d9),{'sequences':_0xf61190});}}catch(_0x3b383f){}return;}if(_0x2ee4db['includes'](_0x48d1a7(0x2b0))&&_0x34568b[_0x48d1a7(0x217)]){this[_0x48d1a7(0x1d7)](_0x2ee4db,{'val':![],'ack':!![]});try{aiAgent[_0x48d1a7(0x1cd)](this,_0x48d1a7(0x232)),setTimeout(()=>aiAgent[_0x48d1a7(0x1cd)](this,'DAY'),0x2ee0);if(this['isProVersion']){this[_0x48d1a7(0x2ac)]();const _0x379719=await this[_0x48d1a7(0x264)]('LTM.dailyDigests');if(_0x379719&&_0x379719[_0x48d1a7(0x217)])pythonBridge[_0x48d1a7(0x2a7)](this,'TRAIN_HEALTH',{'digests':JSON[_0x48d1a7(0x286)](_0x379719[_0x48d1a7(0x217)])});}}catch(_0x5cfcfe){this['log'][_0x48d1a7(0x1d2)]('triggerHealth\x20error:\x20'+_0x5cfcfe[_0x48d1a7(0x28c)]);}return;}if(_0x2ee4db[_0x48d1a7(0x1db)](_0x48d1a7(0x1a7))&&_0x34568b[_0x48d1a7(0x217)]){this[_0x48d1a7(0x1d7)](_0x2ee4db,{'val':![],'ack':!![]}),await this[_0x48d1a7(0x1ef)]();return;}if(_0x2ee4db[_0x48d1a7(0x1db)]('analysis.training.triggerComfort')&&_0x34568b[_0x48d1a7(0x217)]){this[_0x48d1a7(0x1d7)](_0x2ee4db,{'val':![],'ack':!![]});if(this[_0x48d1a7(0x2b4)])try{const _0x4d0672=await this[_0x48d1a7(0x264)](_0x48d1a7(0x244));if(_0x4d0672&&_0x4d0672['val']){const _0x21dd5c={};if(this[_0x48d1a7(0x1c0)][_0x48d1a7(0x1aa)])this['config'][_0x48d1a7(0x1aa)][_0x48d1a7(0x202)](_0x4f9431=>{const _0x351f42=_0x48d1a7;if(_0x4f9431['id']&&_0x4f9431[_0x351f42(0x2c1)])_0x21dd5c[_0x4f9431['id']]=_0x4f9431[_0x351f42(0x2c1)];});pythonBridge[_0x48d1a7(0x2a7)](this,_0x48d1a7(0x1f0),{'events':JSON[_0x48d1a7(0x286)](_0x4d0672[_0x48d1a7(0x217)]),'deviceMap':_0x21dd5c});}}catch(_0xd9a998){}return;}if(_0x2ee4db[_0x48d1a7(0x1db)]('analysis.training.triggerTopology')&&_0x34568b[_0x48d1a7(0x217)]){this['setState'](_0x2ee4db,{'val':![],'ack':!![]}),topology[_0x48d1a7(0x1d1)](this);if(this[_0x48d1a7(0x2b4)])try{const _0x24324b=await this[_0x48d1a7(0x264)](_0x48d1a7(0x28f));if(_0x24324b&&_0x24324b['val'])pythonBridge['send'](this,_0x48d1a7(0x2f6),{'sequences':JSON[_0x48d1a7(0x286)](_0x24324b[_0x48d1a7(0x217)])});}catch(_0x2bc7ac){}return;}}const _0x22b83a=(this[_0x48d1a7(0x1c0)][_0x48d1a7(0x1aa)]||[])[_0x48d1a7(0x2cc)](_0x46711f=>_0x46711f['id']===_0x2ee4db);if(_0x22b83a){const _0x40a7ac=await recorder[_0x48d1a7(0x272)](this,_0x2ee4db,_0x34568b,_0x22b83a);_0x40a7ac&&this[_0x48d1a7(0x1d7)](_0x48d1a7(0x23f),{'val':Date[_0x48d1a7(0x2a5)](),'ack':!![]});_0x40a7ac&&_0x40a7ac[_0x48d1a7(0x2c1)]===_0x48d1a7(0x2eb)&&_0x40a7ac[_0x48d1a7(0x283)]&&this[_0x48d1a7(0x2b4)]&&deadMan['updateLocation'](this,_0x40a7ac[_0x48d1a7(0x283)]);_0x34568b['val']&&(_0x34568b[_0x48d1a7(0x217)]===!![]||_0x34568b[_0x48d1a7(0x217)]===0x1||String(_0x34568b['val'])['toLowerCase']()===_0x48d1a7(0x1c4))&&(_0x22b83a[_0x48d1a7(0x2c1)]&&(_0x22b83a['type'][_0x48d1a7(0x1db)](_0x48d1a7(0x231))||_0x22b83a['type'][_0x48d1a7(0x1db)](_0x48d1a7(0x22d)))&&this[_0x48d1a7(0x303)](_0x22b83a));if(_0x22b83a[_0x48d1a7(0x2c1)]===_0x48d1a7(0x230)||_0x22b83a[_0x48d1a7(0x2c1)]===_0x48d1a7(0x275)){if(this['activeModules'][_0x48d1a7(0x276)])automation['cleanupGhostInterventions'](this);}}}async['protectAiMemory'](_0x6331f3){const _0x538eb1=a0_0x220c0d;if(!this[_0x538eb1(0x268)]||Date[_0x538eb1(0x2a5)]()-this['bootTime']>0x493e0)return;try{const _0x23b753=JSON[_0x538eb1(0x286)](_0x6331f3),_0x4f3e3c=this[_0x538eb1(0x268)][_0x538eb1(0x2c3)];let _0x4faf8a=![];for(const _0x702c48 in _0x4f3e3c){if(_0x4f3e3c[_0x702c48][_0x538eb1(0x1db)]('AI')&&_0x23b753[_0x702c48]&&!_0x23b753[_0x702c48]['includes']('AI')){_0x4faf8a=!![];break;}}_0x4faf8a&&(await this[_0x538eb1(0x1b1)](_0x538eb1(0x2bb),{'val':JSON[_0x538eb1(0x2ec)](this['memoryCache'][_0x538eb1(0x247)]),'ack':!![]}),await this['setStateAsync'](_0x538eb1(0x1c3),{'val':JSON['stringify'](this['memoryCache'][_0x538eb1(0x2c3)]),'ack':!![]}));}catch(_0x166c2d){}}async[a0_0x220c0d(0x263)](){const _0x1cca41=a0_0x220c0d;try{const _0x5e0331=await this['getStateAsync'](setup['SYSTEM_DP_MODE']);if(_0x5e0331&&_0x5e0331[_0x1cca41(0x217)])this[_0x1cca41(0x2dc)]=_0x5e0331['val'];}catch(_0x55432b){this[_0x1cca41(0x2dc)]=setup[_0x1cca41(0x240)]['NORMAL'];}}async['checkWifiPresence'](){const _0x46cf2e=a0_0x220c0d,_0x2baffc=this['config']['presenceDevices']||[];if(_0x2baffc[_0x46cf2e(0x2c5)]===0x0)return![];const _0x2a3d10=[],_0x5dfa3f=Date[_0x46cf2e(0x2a5)](),_0x519492=0x5*0x3c*0x3e8;for(const _0x853f75 of _0x2baffc){try{let _0xa726cc=![];try{const _0x127240=await this[_0x46cf2e(0x2d1)](_0x853f75+_0x46cf2e(0x274));if(_0x127240&&_0x127240[_0x46cf2e(0x217)]===!![])_0xa726cc=!![];}catch(_0x87944e){}if(!_0xa726cc)try{const _0x142acf=await this[_0x46cf2e(0x2d1)](_0x853f75+'.last_seen');if(_0x142acf&&_0x142acf['ts']){const _0x16f4ed=_0x5dfa3f-_0x142acf['ts'];if(_0x16f4ed<_0x519492)_0xa726cc=!![];}}catch(_0x42593f){}if(!_0xa726cc)try{const _0x201659=await this[_0x46cf2e(0x2d1)](_0x853f75+'.uptime');if(_0x201659&&typeof _0x201659[_0x46cf2e(0x217)]===_0x46cf2e(0x23b)&&_0x201659[_0x46cf2e(0x217)]>0x0)_0xa726cc=!![];}catch(_0x1e5f16){}if(!_0xa726cc)try{const _0x1d55ca=await this[_0x46cf2e(0x2d1)](_0x853f75);if(_0x1d55ca){const _0x404627=_0x5dfa3f-(_0x1d55ca['ts']||0x0);_0x404627<_0x519492&&(_0x1d55ca[_0x46cf2e(0x217)]===!![]||_0x1d55ca[_0x46cf2e(0x217)]==='online'||_0x1d55ca['val']===0x1)&&(_0xa726cc=!![]);}}catch(_0x4f9a27){}if(_0xa726cc){const _0x4627f8=_0x853f75[_0x46cf2e(0x1a3)]('.'),_0x86404=_0x4627f8[_0x4627f8['length']-0x1]||_0x853f75;_0x2a3d10[_0x46cf2e(0x2c9)](_0x86404);}}catch(_0x33ae2a){this[_0x46cf2e(0x1ae)][_0x46cf2e(0x1d2)](_0x46cf2e(0x204)+_0x853f75+':\x20'+_0x33ae2a[_0x46cf2e(0x28c)]);}}const _0x1e4cb1=_0x2a3d10[_0x46cf2e(0x2c5)]>0x0?_0x2a3d10[_0x46cf2e(0x26d)](',\x20'):_0x46cf2e(0x1ff);return await this[_0x46cf2e(0x1b1)]('system.presenceWho',{'val':_0x1e4cb1,'ack':!![]}),_0x2a3d10[_0x46cf2e(0x2c5)]>0x0;}async['runAutopilot'](){const _0x3f8410=a0_0x220c0d;await aiAgent[_0x3f8410(0x1e3)](this);this[_0x3f8410(0x2ae)][_0x3f8410(0x2ab)]&&(this[_0x3f8410(0x21d)](),this[_0x3f8410(0x2fd)]());if(this['activeModules'][_0x3f8410(0x276)])this[_0x3f8410(0x1ef)]();}async[a0_0x220c0d(0x23c)](){const _0x5ee9a9=a0_0x220c0d,_0x67c210=[_0x5ee9a9(0x2f7),'accuweather.0','daswetter.0'],_0x213c6d=[_0x5ee9a9(0x2f3),_0x5ee9a9(0x27b),_0x5ee9a9(0x27f)];for(const _0xecfeb8 of _0x67c210){for(const _0xf6edfe of _0x213c6d){try{const _0x246383=_0xecfeb8+'.'+_0xf6edfe,_0x331132=await this[_0x5ee9a9(0x2d1)](_0x246383);if(_0x331132&&_0x331132[_0x5ee9a9(0x217)]){const _0x22283b=String(_0x331132[_0x5ee9a9(0x217)])[_0x5ee9a9(0x20c)]();if(_0x22283b['includes'](_0x5ee9a9(0x206))||_0x22283b['includes'](_0x5ee9a9(0x2f8))||_0x22283b['includes'](_0x5ee9a9(0x2e7))||_0x22283b[_0x5ee9a9(0x1db)]('sonn')||_0x22283b[_0x5ee9a9(0x1db)](_0x5ee9a9(0x237)))return this[_0x5ee9a9(0x1ae)]['debug'](_0x5ee9a9(0x20a)+_0x246383),!![];}}catch(_0x3032aa){}}}return![];}[a0_0x220c0d(0x2fd)](){const _0xbf860d=a0_0x220c0d;if(!this['isProVersion'])return;try{this[_0xbf860d(0x264)]('LTM.trainingData.sequences',(_0x399494,_0x4bb325)=>{const _0x3add03=_0xbf860d;if(_0x399494||!_0x4bb325||!_0x4bb325[_0x3add03(0x217)])return;try{const _0x22ec95=JSON['parse'](_0x4bb325[_0x3add03(0x217)]);if(!_0x22ec95||_0x22ec95[_0x3add03(0x2c5)]===0x0)return;pythonBridge[_0x3add03(0x2a7)](this,_0x3add03(0x2aa),{'sequences':_0x22ec95}),this[_0x3add03(0x1ae)]['debug']('üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20'+_0x22ec95[_0x3add03(0x2c5)]+_0x3add03(0x1c1));}catch(_0x3bc808){this[_0x3add03(0x1ae)][_0x3add03(0x1d2)](_0x3add03(0x1cf)+_0x3bc808[_0x3add03(0x28c)]);}});}catch(_0x4062b3){this[_0xbf860d(0x1ae)][_0xbf860d(0x1d2)]('triggerGaitAnalysis\x20error:\x20'+_0x4062b3[_0xbf860d(0x28c)]);}}async[a0_0x220c0d(0x1ef)](){const _0x28b58a=a0_0x220c0d;if(!this[_0x28b58a(0x2b4)]||!this[_0x28b58a(0x2ae)][_0x28b58a(0x276)])return;try{const _0x37480a={},_0x260b5a={},_0x3851d3=this[_0x28b58a(0x1c0)][_0x28b58a(0x1aa)]||[];for(const _0x25da64 of _0x3851d3){if((_0x25da64[_0x28b58a(0x2c1)]===_0x28b58a(0x230)||_0x25da64['type']===_0x28b58a(0x275))&&_0x25da64[_0x28b58a(0x283)])try{const _0x487760=await this[_0x28b58a(0x2d1)](_0x25da64['id']);_0x487760&&typeof _0x487760[_0x28b58a(0x217)]===_0x28b58a(0x23b)&&(_0x37480a[_0x25da64[_0x28b58a(0x283)]]=_0x487760[_0x28b58a(0x217)],_0x260b5a[_0x25da64[_0x28b58a(0x283)]]=_0x25da64[_0x28b58a(0x1ce)]||![]);}catch(_0x48580a){}}let _0x5e636b=0xa;if(this[_0x28b58a(0x1c0)]['weatherTempId'])try{const _0x38c717=await this[_0x28b58a(0x2d1)](this['config'][_0x28b58a(0x249)]);if(_0x38c717&&typeof _0x38c717[_0x28b58a(0x217)]==='number')_0x5e636b=_0x38c717[_0x28b58a(0x217)];}catch(_0x45a32b){}const _0x179a26=await this[_0x28b58a(0x23c)]();let _0x3f6c10={};try{const _0x2cede2=await this[_0x28b58a(0x264)](_0x28b58a(0x20b));if(_0x2cede2&&_0x2cede2[_0x28b58a(0x217)])_0x3f6c10=JSON[_0x28b58a(0x286)](_0x2cede2['val']);}catch(_0xa4b002){}pythonBridge['send'](this,_0x28b58a(0x2ce),{'current_temps':_0x37480a,'t_out':_0x5e636b,'is_sunny':_0x179a26,'solar_flags':_0x260b5a,'warmup_targets':_0x3f6c10}),this['log'][_0x28b58a(0x1bd)]('üîÆ\x20Energy\x20Prediction\x20triggered\x20('+Object[_0x28b58a(0x1f6)](_0x37480a)[_0x28b58a(0x2c5)]+'\x20rooms)');}catch(_0x1d455f){this['log'][_0x28b58a(0x1d2)]('triggerEnergyPrediction\x20Error:\x20'+_0x1d455f['message']);}}[a0_0x220c0d(0x21d)](){const _0x3ae6d1=a0_0x220c0d;if(!this[_0x3ae6d1(0x251)]||this[_0x3ae6d1(0x251)][_0x3ae6d1(0x2c5)]===0x0)return;const _0x1ac636=new Array(0x30)[_0x3ae6d1(0x255)](0x0),_0x58c36f=Array[_0x3ae6d1(0x257)]({'length':0x30},()=>[]),_0x2247ad=new Date()['setHours'](0x0,0x0,0x0,0x0);this['rawEventLog'][_0x3ae6d1(0x202)](_0x929c16=>{const _0x3d54c4=_0x3ae6d1,_0x4ba7dc=new Date(_0x929c16[_0x3d54c4(0x2d7)]);if(_0x4ba7dc[_0x3d54c4(0x27e)]()>=_0x2247ad){const _0x46ac5f=_0x4ba7dc['getHours'](),_0x4e55ab=_0x4ba7dc[_0x3d54c4(0x1f4)](),_0x2df864=_0x46ac5f*0x2+Math['floor'](_0x4e55ab/0x1e);_0x2df864>=0x0&&_0x2df864<0x30&&(_0x1ac636[_0x2df864]++,_0x58c36f[_0x2df864]['push']({'time':_0x4ba7dc[_0x3d54c4(0x29b)](_0x3d54c4(0x219),{'hour':_0x3d54c4(0x294),'minute':_0x3d54c4(0x294)}),'location':_0x929c16[_0x3d54c4(0x283)]||_0x3d54c4(0x24b),'type':_0x929c16[_0x3d54c4(0x2c1)]||'Event'}));}}),this['setStateAsync'](_0x3ae6d1(0x226),{'val':JSON[_0x3ae6d1(0x2ec)](_0x1ac636),'ack':!![]}),this[_0x3ae6d1(0x1b1)](_0x3ae6d1(0x1bb),{'val':JSON['stringify'](_0x58c36f),'ack':!![]});}async[a0_0x220c0d(0x2d5)](_0x4da648){const _0x5af582=a0_0x220c0d;if(!this[_0x5af582(0x1c0)][_0x5af582(0x1c2)]||typeof _0x4da648!==_0x5af582(0x23b))return;const _0x200bca=this[_0x5af582(0x1c0)][_0x5af582(0x250)]||0.04;this[_0x5af582(0x2f2)][_0x5af582(0x2c9)]({'timestamp':Date[_0x5af582(0x2a5)](),'value':_0x4da648}),this[_0x5af582(0x2f2)][_0x5af582(0x2c5)]>0x64&&this[_0x5af582(0x2f2)][_0x5af582(0x2ee)](),_0x4da648>_0x200bca&&!this['infrasoundLocked']&&(this[_0x5af582(0x26b)]=!![],this[_0x5af582(0x1ae)][_0x5af582(0x1d2)](_0x5af582(0x26e)+_0x4da648[_0x5af582(0x25c)](0x4)+_0x5af582(0x1e5)+_0x200bca+_0x5af582(0x25d)),await this[_0x5af582(0x1e7)](_0x4da648,'threshold_exceeded'),setTimeout(()=>{const _0x4e2648=_0x5af582;this[_0x4e2648(0x26b)]=![];},0x5*0x3c*0x3e8));}async[a0_0x220c0d(0x1e7)](_0x1258aa,_0x339f5f){const _0x17e3ae=a0_0x220c0d;if(!this[_0x17e3ae(0x1ea)]){const _0x26d61b=this['eventHistory']['slice'](0x0,0xa),_0x23132d=_0x26d61b[_0x17e3ae(0x24f)](_0x5c1a3c=>new Date(_0x5c1a3c[_0x17e3ae(0x2d7)])[_0x17e3ae(0x29b)](_0x17e3ae(0x219))+_0x17e3ae(0x301)+(_0x5c1a3c[_0x17e3ae(0x283)]||'Unknown')+':\x20'+_0x5c1a3c[_0x17e3ae(0x2a0)])[_0x17e3ae(0x26d)]('\x0a');this['log'][_0x17e3ae(0x1d2)]('üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20'+_0x1258aa['toFixed'](0x4)+',\x20Events:\x0a'+_0x23132d);if(this['config'][_0x17e3ae(0x1c7)])try{const _0x5a5fc9=await this[_0x17e3ae(0x2d1)](this[_0x17e3ae(0x1c0)][_0x17e3ae(0x1c7)]);_0x5a5fc9&&_0x5a5fc9['val']===!![]&&(await this[_0x17e3ae(0x1b1)]('analysis.safety.infrasoundAlert',{'val':JSON[_0x17e3ae(0x2ec)]({'timestamp':Date[_0x17e3ae(0x2a5)](),'pressure':_0x1258aa['toFixed'](0x4),'eventType':_0x339f5f,'recentEvents':_0x26d61b[_0x17e3ae(0x2bf)](0x0,0x3)}),'ack':!![]}),this[_0x17e3ae(0x1ae)][_0x17e3ae(0x2a9)](_0x17e3ae(0x225)));}catch(_0x96c2d9){}}else this[_0x17e3ae(0x1ae)]['debug'](_0x17e3ae(0x213)+_0x1258aa[_0x17e3ae(0x25c)](0x4)+_0x17e3ae(0x1d5));}async[a0_0x220c0d(0x303)](_0x4e5b4d){const _0x5d8d5e=a0_0x220c0d;if(!_0x4e5b4d||!_0x4e5b4d[_0x5d8d5e(0x283)])return;try{const _0x4ae1d5=(this['config']['devices']||[])['filter'](_0x35eea5=>_0x35eea5[_0x5d8d5e(0x283)]===_0x4e5b4d[_0x5d8d5e(0x283)]&&(_0x35eea5[_0x5d8d5e(0x2c1)]==='temperature'||_0x35eea5[_0x5d8d5e(0x2c1)]==='thermostat'));if(_0x4ae1d5[_0x5d8d5e(0x2c5)]===0x0)return;const _0x4fc998=await this[_0x5d8d5e(0x2d1)](_0x4ae1d5[0x0]['id']);if(!_0x4fc998||typeof _0x4fc998[_0x5d8d5e(0x217)]!==_0x5d8d5e(0x23b))return;const _0x20f9a0=_0x4fc998['val'];let _0x42ed78=null;if(this[_0x5d8d5e(0x1c0)][_0x5d8d5e(0x249)]){const _0x3e15db=await this[_0x5d8d5e(0x2d1)](this['config'][_0x5d8d5e(0x249)]);_0x3e15db&&typeof _0x3e15db[_0x5d8d5e(0x217)]==='number'&&(_0x42ed78=_0x3e15db[_0x5d8d5e(0x217)]);}if(_0x42ed78!==null){const _0x495916=Math[_0x5d8d5e(0x278)](_0x20f9a0-_0x42ed78);_0x495916>0x3&&(this[_0x5d8d5e(0x1ae)][_0x5d8d5e(0x27c)](_0x5d8d5e(0x234)+_0x4e5b4d[_0x5d8d5e(0x283)]+_0x5d8d5e(0x2de)+_0x495916['toFixed'](0x1)+_0x5d8d5e(0x24e)+_0x20f9a0+'¬∞C,\x20Au√üen:\x20'+_0x42ed78+_0x5d8d5e(0x216)),await this[_0x5d8d5e(0x1b1)](_0x5d8d5e(0x28d),{'val':JSON[_0x5d8d5e(0x2ec)]({'room':_0x4e5b4d['location'],'timestamp':Date[_0x5d8d5e(0x2a5)](),'tempDiff':_0x495916['toFixed'](0x1),'recommendation':_0x495916>0x5?_0x5d8d5e(0x21b):_0x5d8d5e(0x2b7)}),'ack':!![]}));}}catch(_0x25373f){this['log'][_0x5d8d5e(0x1d2)](_0x5d8d5e(0x21a)+_0x25373f[_0x5d8d5e(0x28c)]);}}async[a0_0x220c0d(0x2e5)](_0x4fd9af){const _0x432b99=a0_0x220c0d;if(!_0x4fd9af||typeof _0x4fd9af!==_0x432b99(0x259))return;const _0x3da57e={'timestamp':_0x4fd9af['timestamp']||Date[_0x432b99(0x2a5)](),'id':_0x4fd9af['id']||Date['now']()['toString'](),'name':_0x4fd9af['name']||_0x432b99(0x1ac),'type':_0x4fd9af[_0x432b99(0x2c1)]||_0x432b99(0x258),'location':_0x4fd9af[_0x432b99(0x283)]||_0x432b99(0x1c6),'value':_0x4fd9af[_0x432b99(0x241)]||null};this[_0x432b99(0x1dd)][_0x432b99(0x304)](_0x3da57e);if(this[_0x432b99(0x1dd)]['length']>0x1388)this[_0x432b99(0x1dd)][_0x432b99(0x1f1)]();await this['setStateAsync'](_0x432b99(0x1d0),{'val':JSON[_0x432b99(0x2ec)](this['eventHistory']),'ack':!![]}),this['log'][_0x432b99(0x27c)](_0x432b99(0x238)+_0x3da57e[_0x432b99(0x2a0)]+'\x20('+_0x3da57e[_0x432b99(0x283)]+')');}[a0_0x220c0d(0x2f0)](_0x3a04f3){}}if(require['main']!==module)module[a0_0x220c0d(0x229)]=_0x351cd6=>new CogniLiving(_0x351cd6);else new CogniLiving();