const a0_0x1f5fbb=a0_0x338f;(function(_0x2515de,_0x95f6ea){const _0x52da44=a0_0x338f,_0x550d94=_0x2515de();while(!![]){try{const _0x40cdd5=-parseInt(_0x52da44(0x1f8))/0x1+parseInt(_0x52da44(0x14b))/0x2*(parseInt(_0x52da44(0x1ee))/0x3)+-parseInt(_0x52da44(0x21b))/0x4*(-parseInt(_0x52da44(0x278))/0x5)+-parseInt(_0x52da44(0x288))/0x6*(parseInt(_0x52da44(0x1c0))/0x7)+parseInt(_0x52da44(0x1e3))/0x8+-parseInt(_0x52da44(0x19d))/0x9*(parseInt(_0x52da44(0x16f))/0xa)+-parseInt(_0x52da44(0x242))/0xb*(-parseInt(_0x52da44(0x166))/0xc);if(_0x40cdd5===_0x95f6ea)break;else _0x550d94['push'](_0x550d94['shift']());}catch(_0x1b68de){_0x550d94['push'](_0x550d94['shift']());}}}(a0_0xfb24,0x72545));const a0_0x41c9f2=(function(){let _0x32e4c5=!![];return function(_0x1f5590,_0x12739d){const _0x9d647b=_0x32e4c5?function(){const _0x2d4b17=a0_0x338f;if(_0x12739d){const _0x25be31=_0x12739d[_0x2d4b17(0x27a)](_0x1f5590,arguments);return _0x12739d=null,_0x25be31;}}:function(){};return _0x32e4c5=![],_0x9d647b;};}()),a0_0x28c112=a0_0x41c9f2(this,function(){const _0x520915=a0_0x338f;return a0_0x28c112[_0x520915(0x1a8)]()[_0x520915(0x20b)](_0x520915(0x1db))['toString']()[_0x520915(0x25b)](a0_0x28c112)[_0x520915(0x20b)](_0x520915(0x1db));});a0_0x28c112();'use strict';const utils=require(a0_0x1f5fbb(0x1c3)),{GoogleGenerativeAI}=require(a0_0x1f5fbb(0x266)),installer=require(a0_0x1f5fbb(0x1d4)),scanner=require(a0_0x1f5fbb(0x26f)),schedulers=require('./lib/scheduler'),topology=require(a0_0x1f5fbb(0x279)),setup=require(a0_0x1f5fbb(0x1ed)),recorder=require(a0_0x1f5fbb(0x220)),pythonBridge=require(a0_0x1f5fbb(0x13a)),aiAgent=require(a0_0x1f5fbb(0x224)),deadMan=require(a0_0x1f5fbb(0x13c)),automation=require(a0_0x1f5fbb(0x1a7)),GEMINI_MODEL=a0_0x1f5fbb(0x184),ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};function a0_0xfb24(){const _0x429767=['klar','initZombies','initHistory','.communicate.request','triggerInfrasoundCorrelation','Key\x20not\x20found\x20or\x20not\x20provided','isPresent','Adapter','exports','triggerDailyDigest','1866904ygcUKT','party','ack','scanThermostats','PREDICT_ENERGY','./lib/recorder','daswetter.0','geminiApiKey','analysis.training.triggerTopology','./lib/ai_agent','Activity-Level','notifyTelegramEnabled','checkCalendarTriggers','endsWith','Keine\x20Antwort\x20von\x20Gemini','triggerEnergyPrediction','push','Sec-Training\x20started...','send','scanForDevices','triggerGaitAnalysis','magnet','analysis.health.activityTrend','\x20rooms\x20(preventing\x20Cold\x20Start\x20Amnesia).','initSystemConfig','\x20Tage)','sensor.window','analysis.training.triggerComfort','minutes_safe','analysis.automation.description','getStateAsync','main','manual','minDaysForBaseline','startSystem','TRAIN_HEALTH','fill','cogni-living','analysisHistory','99WEwZGg','analysis.security.learningStatus','setObjectNotExistsAsync','Verbunden','briefingJob','infrasoundArmingId','rawEventLog','[Forensics]\x20Save\x20failed:\x20','response','Gait\x20Speed\x20Calculation\x20Proof','communicate.request','checkAndInstall','SET_TOPOLOGY','setState','abs','setupDriftAnalysisScheduler','TRAIN_SECURITY','updateHealthVector','sonn','system.adapter.','driftAnalysisTimer','currentSystemMode','CALIB','PINN\x20AI\x20Forecast','isArray','constructor','Test','_calName','Active\x20Calendar\x20Enforcements\x20(Locks)','protectAiMemory','setStateAsync','LTM.baselineStatus','analysis.energy.warmupSources','analysis.security.infrasoundLog','key','updateTopology','@google/generative-ai','thermostat','createAllObjects','updateLocation','MATCH\x20(False\x20Positive)','analysisInterval','name','licenseKey','onStateChange','./lib/scanner','getForeignObjectsAsync','split','Gemini\x20AI\x20initialized.','ltmJob','sources','sunny','\x20hPa\x20(Threshold:\x20','system.mode','10gJAtuE','./lib/topology','apply','analysisTimer','checkWifiPresence','abortExitTimer','Notification\x20Test\x20Failed:\x20','analysis.energy.warmupTimes','setupModeResetScheduler','forEach','parse','location','state','open','Fenster\x20geÃ¶ffnet:\x20','apiKey','2334RefuEl','â¤ï¸\x20Auto-Heartbeat:\x20Aktualisiere\x20Gesundheits-Trends...','./lib/python_bridge','Aktiv\x20(','./lib/dead_man','bootTime','[Calibration]\x20Window\x20','notifyPushoverInstance','Standard','analyzeWindowOpening','setupLtmScheduler','string','toLowerCase','number','updateTopologyMatrix','ðŸ§ \x20Memory:\x20Cache\x20hydrated\x20with\x20','analysis.automation.patternDetected','enum','ALARM','430046yEAWhR','Kein\x20Kalender-Adapter','timestamp','analysis.training.status','warn','length','now','enum.rooms.*','ANOMALY\x20(Real\x20Threat?)','Party\x20Mode','subscribeStates','runPythonHealthCheck','Keine\x20Sensor-AktivitÃ¤t','Verbindung\x20erfolgreich!','Reinforcement\x20Learning\x20Penalties','pop','getMinutes','NORMAL','instance','analysis.automation.autoApply','dependencyInstallInProgress','accuweather.0','window','processSensorEvent','dismissAutomation','setPresence','exitTimer','636828ypEBRX','Daten\x20nicht\x20verfÃ¼gbar','ready','genAI','guest','onReady','bind','Nuukanni\x20Security','notifyTelegramInstance','364750GLcWwW','sensorLastValues',')\x20-\x20Phase\x20D\x20(Forensic\x20Calibration)','json','text','Instanz\x20nicht\x20gefunden','sendMorningBriefing','INTERNAL','stopService','type','checkSolarCondition','values','temperature','some','getForeignStateAsync','SYSTEM_DP_MODE','analysis.training.triggerHealth','calendarInstance','analysis.energy.warmupTargets','testNotification','getGenerativeModel','models/gemini-flash-latest','Memory\x20Hydration\x20Failed:\x20','devices','object','ErklÃ¤rt\x20durch:\x20','LTM.trainingData.thermodynamics','lastTrackerEventTime','stringify','appendToLog','Gesendet','val','getEnums','setupBriefingScheduler','infrasoundSensorId','analysis.topology.structure','door','inactivityThresholdHours','runAutopilot','runGeminiAnalysis','floor','analysis.training.triggerSecurity','times','config','Warm-Up\x20Time\x20(Minutes\x20to\x20Target)','slice','171ZZHxoe','getOutsideTemperatureNumeric','analysis.automation.targetValue','geminiModel','trackerHeartbeat','handleInfrasound','scanDevices','cleanupGhostInterventions','callback','isSolar','./lib/automation','toString','getHours','log','isGracePeriodActive','systemConfig','error','common','startService','ANALYZE_GAIT','Kein\x20Wetter-Adapter','monitorEnforcements','presenceDevices','pressureBuffer','infrasoundEnabled','Current.WeatherText','onMessage','info','\x20hPa\x20(Limit:\x20','getState','entries','analysis.automation.triggerAction','onUnload','subscribeForeignStatesAsync','General\x20Activity\x20Trend\x20(%)','2513JIDnvw','add','analysis.health.todayVector','@iobroker/adapter-core','getLtmData','heiter','eventHistory','cancel','sendTo','toFixed','Active\x20Ventilation\x20Alerts','dailyDigests','ðŸŽ“\x20[RL-RESET]\x20Lern-Sperre\x20(Penalty)\x20fÃ¼r\x20\x27','healthTrendInterval','PYTHON_EXE','reed','command','value','getTime','\x20opened.\x20Peak\x20Pressure:\x20','./lib/installer','.system.mode','version','analysis.energy.pinnForecast','system.presenceWho','find','Sensors\x20used\x20for\x20Gait\x20Analysis','(((.+)+)+)+$','analysis.automation.targetId','simulateButler','activityLevel','Warm-Up\x20Target\x20Temps\x20(JSON)','infrasoundThreshold','forecast.current.weather','SYSTEM_MODES','1487680cnlaNw','modeResetJob','ðŸ””\x20Dies\x20ist\x20ein\x20Test\x20von\x20Cogni-Living.','LTM.dailyDigests','message','ANALYZE_TREND','infrasoundLocked','debug','memoryCache','Forensic\x20Infrasound\x20Log','./lib/setup','6KYnbev','isProVersion','TRAIN_ENERGY','Kein\x20API\x20Key\x20Ã¼bergeben','checkLicense','analysis.health.gaitDebug','sensor.door','resetRLPenalty','from','sort','726110mFsrGg','ðŸš¨\x20DRUCKWELLEN-ALARM!\x20StÃ¤rke:\x20','useWeather','calendarName','{\x22default\x22:\x2021}','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','filter','keys','analysis.energy.rlPenalties','motion','includes','analysis.training.triggerEnergy','LTM.trainingData.sequences','testContext','setHours','sendNotification','lastAlertState','createDailyDigest','.data.table','search','[Forensics]\x20Infrasound\x20Event\x20correlated:\x20','TRACK_EVENT','role','unload','ðŸ§ \x20Memory\x20Protection:\x20Restoring\x20persisted\x20AI-Calculations\x20(preventing\x20\x27Cold\x20Start\x27\x20amnesia).'];a0_0xfb24=function(){return _0x429767;};return a0_0xfb24();}class CogniLiving extends utils[a0_0x1f5fbb(0x218)]{constructor(_0x556409){const _0x287596=a0_0x1f5fbb;super({..._0x556409,'name':_0x287596(0x240)}),this[_0x287596(0x1c6)]=[],this[_0x287596(0x241)]=[],this['rawEventLog']=[],this['dailyDigests']=[],this['sensorLastValues']={},this[_0x287596(0x1ac)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0x287596(0x165)]=null,this['exitGraceTimer']=null,this[_0x287596(0x1ab)]=![],this[_0x287596(0x169)]=null,this['geminiModel']=null,this[_0x287596(0x257)]=setup[_0x287596(0x1e2)][_0x287596(0x15c)],this[_0x287596(0x1ef)]=![],this[_0x287596(0x208)]=![],this[_0x287596(0x27b)]=null,this[_0x287596(0x273)]=null,this[_0x287596(0x1e4)]=null,this[_0x287596(0x256)]=null,this['briefingJob']=null,this[_0x287596(0x1a1)]=null,this[_0x287596(0x1cd)]=null,this[_0x287596(0x15f)]=![],this[_0x287596(0x18a)]=Date['now'](),this['memoryCache']=null,this[_0x287596(0x13d)]=Date[_0x287596(0x151)](),this[_0x287596(0x1e9)]=![],this[_0x287596(0x1b4)]=[],this['on'](_0x287596(0x168),this[_0x287596(0x16b)][_0x287596(0x16c)](this)),this['on']('stateChange',this[_0x287596(0x26e)][_0x287596(0x16c)](this)),this['on'](_0x287596(0x20f),this[_0x287596(0x1bd)][_0x287596(0x16c)](this)),this['on'](_0x287596(0x1e7),this['onMessage']['bind'](this));}async['onReady'](){const _0x706aef=a0_0x1f5fbb;this[_0x706aef(0x1aa)][_0x706aef(0x1b8)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x706aef(0x1d6)]+_0x706aef(0x171));if(!installer[_0x706aef(0x24d)](this,()=>this[_0x706aef(0x23d)]()))return;}async[a0_0x1f5fbb(0x23d)](){const _0x4587d9=a0_0x1f5fbb;await setup[_0x4587d9(0x212)](this);try{this[_0x4587d9(0x1ef)]=await setup[_0x4587d9(0x1f2)](this[_0x4587d9(0x19a)][_0x4587d9(0x26d)]);}catch(_0xac2572){}if(!this[_0x4587d9(0x19a)][_0x4587d9(0x194)]||this[_0x4587d9(0x19a)][_0x4587d9(0x194)]<0.1)this['config'][_0x4587d9(0x194)]=0xc;await setup[_0x4587d9(0x213)](this),await setup[_0x4587d9(0x233)](this);try{const _0x11b7f4=await this['getStateAsync'](_0x4587d9(0x27f)),_0x11901b=await this['getStateAsync'](_0x4587d9(0x262));_0x11b7f4&&_0x11b7f4[_0x4587d9(0x18e)]&&_0x11901b&&_0x11901b['val']&&(Date[_0x4587d9(0x151)]()-_0x11b7f4['ts']<0x4*0xe10*0x3e8&&(this[_0x4587d9(0x1eb)]={'times':JSON[_0x4587d9(0x282)](_0x11b7f4[_0x4587d9(0x18e)]),'sources':JSON[_0x4587d9(0x282)](_0x11901b[_0x4587d9(0x18e)])},this[_0x4587d9(0x1aa)][_0x4587d9(0x1b8)](_0x4587d9(0x147)+Object[_0x4587d9(0x1ff)](this[_0x4587d9(0x1eb)][_0x4587d9(0x199)])[_0x4587d9(0x150)]+_0x4587d9(0x232))));}catch(_0x4440b9){this['log'][_0x4587d9(0x14f)](_0x4587d9(0x185)+_0x4440b9['message']);}if(this[_0x4587d9(0x19a)][_0x4587d9(0x222)])try{this[_0x4587d9(0x169)]=new GoogleGenerativeAI(this[_0x4587d9(0x19a)][_0x4587d9(0x222)]),this[_0x4587d9(0x1a0)]=this[_0x4587d9(0x169)][_0x4587d9(0x183)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':'application/json'}}),this[_0x4587d9(0x1aa)][_0x4587d9(0x1b8)](_0x4587d9(0x272));}catch(_0x2d5a17){this[_0x4587d9(0x1aa)][_0x4587d9(0x1ad)]('Gemini\x20Init\x20Error:\x20'+_0x2d5a17[_0x4587d9(0x1e7)]);}await setup[_0x4587d9(0x268)](this),await this['loadSystemMode'](),await this[_0x4587d9(0x244)](_0x4587d9(0x1d7),{'type':_0x4587d9(0x284),'common':{'name':_0x4587d9(0x259),'type':_0x4587d9(0x143),'role':_0x4587d9(0x172),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.energy.ventilationAlerts',{'type':'state','common':{'name':_0x4587d9(0x1ca),'type':_0x4587d9(0x143),'role':_0x4587d9(0x172),'read':!![],'write':![]},'native':{}}),await this[_0x4587d9(0x244)](_0x4587d9(0x27f),{'type':_0x4587d9(0x284),'common':{'name':_0x4587d9(0x19b),'type':_0x4587d9(0x143),'role':_0x4587d9(0x172),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.energy.warmupTargets',{'type':_0x4587d9(0x284),'common':{'name':_0x4587d9(0x1df),'type':_0x4587d9(0x143),'role':_0x4587d9(0x172),'read':!![],'write':!![],'def':_0x4587d9(0x1fc)},'native':{}}),await this[_0x4587d9(0x244)](_0x4587d9(0x200),{'type':_0x4587d9(0x284),'common':{'name':_0x4587d9(0x159),'type':_0x4587d9(0x143),'role':_0x4587d9(0x172),'read':!![],'write':![],'def':'{}'},'native':{}}),await this[_0x4587d9(0x244)](_0x4587d9(0x231),{'type':_0x4587d9(0x284),'common':{'name':_0x4587d9(0x1bf),'type':_0x4587d9(0x145),'role':_0x4587d9(0x1d1),'unit':'%','read':!![],'write':![]},'native':{}}),await this[_0x4587d9(0x244)]('analysis.health.gaitSensors',{'type':_0x4587d9(0x284),'common':{'name':_0x4587d9(0x1da),'type':'string','role':_0x4587d9(0x173),'read':!![],'write':![]},'native':{}}),await this[_0x4587d9(0x244)]('analysis.energy.activeEnforcements',{'type':'state','common':{'name':_0x4587d9(0x25e),'type':'string','role':_0x4587d9(0x172),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x4587d9(0x244)](_0x4587d9(0x263),{'type':_0x4587d9(0x284),'common':{'name':_0x4587d9(0x1ec),'type':_0x4587d9(0x143),'role':_0x4587d9(0x172),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x4587d9(0x244)](_0x4587d9(0x1f3),{'type':_0x4587d9(0x284),'common':{'name':_0x4587d9(0x24b),'type':_0x4587d9(0x143),'role':_0x4587d9(0x173),'read':!![],'write':![]},'native':{}});try{const _0x13b620=await this[_0x4587d9(0x239)]('LTM.rawEventLog');if(_0x13b620&&_0x13b620[_0x4587d9(0x18e)])this[_0x4587d9(0x248)]=JSON[_0x4587d9(0x282)](_0x13b620[_0x4587d9(0x18e)]);}catch(_0x11a39d){this[_0x4587d9(0x248)]=[];}try{const _0x57bf93=await this[_0x4587d9(0x239)](_0x4587d9(0x1e6));if(_0x57bf93&&_0x57bf93[_0x4587d9(0x18e)])this[_0x4587d9(0x1cb)]=JSON[_0x4587d9(0x282)](_0x57bf93[_0x4587d9(0x18e)]);}catch(_0x3f5ed9){this['dailyDigests']=[];}const _0x424338=this['dailyDigests'][_0x4587d9(0x150)]>=(this['config'][_0x4587d9(0x23c)]||0x7)?_0x4587d9(0x13b)+this['dailyDigests'][_0x4587d9(0x150)]+_0x4587d9(0x234):'Lernphase\x20('+this[_0x4587d9(0x1cb)]['length']+'/'+(this['config'][_0x4587d9(0x23c)]||0x7)+')';await this['setStateAsync'](_0x4587d9(0x261),{'val':_0x424338,'ack':!![]}),this[_0x4587d9(0x155)]('analysis.trigger'),this['subscribeStates']('LTM.triggerDailyDigest'),this[_0x4587d9(0x155)](_0x4587d9(0x277)),this[_0x4587d9(0x155)]('analysis.triggerBriefing'),this['subscribeStates'](_0x4587d9(0x1bc)),this[_0x4587d9(0x155)](_0x4587d9(0x15e)),this[_0x4587d9(0x155)](_0x4587d9(0x198)),this['subscribeStates'](_0x4587d9(0x17f)),this[_0x4587d9(0x155)](_0x4587d9(0x203)),this[_0x4587d9(0x155)](_0x4587d9(0x236)),this[_0x4587d9(0x155)](_0x4587d9(0x223)),this[_0x4587d9(0x155)]('analysis.energy.mpcActive'),this[_0x4587d9(0x155)](_0x4587d9(0x262));this[_0x4587d9(0x19a)][_0x4587d9(0x1b5)]&&this[_0x4587d9(0x19a)][_0x4587d9(0x191)]&&(this['log'][_0x4587d9(0x1b8)]('[Infrasound]\x20Subscribing\x20to\x20external\x20sensor:\x20'+this[_0x4587d9(0x19a)][_0x4587d9(0x191)]),this['subscribeForeignStates'](this['config']['infrasoundSensorId']));const _0x21c8b9=this[_0x4587d9(0x19a)][_0x4587d9(0x186)];if(_0x21c8b9)for(const _0x99c252 of _0x21c8b9){await this[_0x4587d9(0x1be)](_0x99c252['id']);}const _0x844b43=this[_0x4587d9(0x19a)][_0x4587d9(0x1b3)];if(_0x844b43)for(const _0x590283 of _0x844b43){await this[_0x4587d9(0x1be)](_0x590283);}if(this['config'][_0x4587d9(0x226)]&&this[_0x4587d9(0x19a)][_0x4587d9(0x16e)])await this[_0x4587d9(0x1be)](this[_0x4587d9(0x19a)][_0x4587d9(0x16e)]+_0x4587d9(0x214));setTimeout(()=>this[_0x4587d9(0x27c)](),0x1388);if(this['analysisTimer'])clearInterval(this[_0x4587d9(0x27b)]);const _0x2853fd=this[_0x4587d9(0x19a)][_0x4587d9(0x26b)]||0xf;_0x2853fd>0x0&&(this[_0x4587d9(0x27b)]=setInterval(()=>{const _0x5f26b3=_0x4587d9;this[_0x5f26b3(0x195)](),automation[_0x5f26b3(0x227)](this),automation['monitorEnforcements'](this);},_0x2853fd*0x3c*0x3e8));setTimeout(()=>{const _0x407825=_0x4587d9;automation[_0x407825(0x227)](this),automation[_0x407825(0x1b2)](this);},0x2710);this[_0x4587d9(0x19a)]['trackerEnabled']!==![]&&(this[_0x4587d9(0x1a1)]=setInterval(()=>{const _0x1687fd=_0x4587d9;if(this[_0x1687fd(0x1ef)]){const _0x402286=Date[_0x1687fd(0x151)](),_0x195227=this[_0x1687fd(0x18a)]||_0x402286,_0x49933e=(_0x402286-_0x195227)/0x3e8;_0x49933e>0x2&&(this['lastTrackerEventTime']=_0x402286,pythonBridge[_0x1687fd(0x22d)](this,_0x1687fd(0x20d),{'room':null,'dt':_0x49933e}));}},0xbb8));if(this[_0x4587d9(0x1cd)])clearInterval(this[_0x4587d9(0x1cd)]);this[_0x4587d9(0x1cd)]=setInterval(()=>{const _0x59821a=_0x4587d9;this[_0x59821a(0x1ef)]&&(this[_0x59821a(0x1aa)][_0x59821a(0x1b8)](_0x59821a(0x139)),this[_0x59821a(0x156)]());},0x4*0x3c*0x3c*0x3e8),schedulers[_0x4587d9(0x142)](this,()=>aiAgent['createDailyDigest'](this,pythonBridge)),schedulers[_0x4587d9(0x280)](this),schedulers[_0x4587d9(0x251)](this,()=>aiAgent['runBaselineDriftAnalysis'](this)),schedulers[_0x4587d9(0x190)](this,()=>aiAgent[_0x4587d9(0x175)](this)),pythonBridge[_0x4587d9(0x1af)](this,installer[_0x4587d9(0x1ce)]),setTimeout(async()=>{const _0x5e4d0f=_0x4587d9;await topology[_0x5e4d0f(0x265)](this);try{const _0x1b588d=await this[_0x5e4d0f(0x239)](_0x5e4d0f(0x192));if(_0x1b588d&&_0x1b588d[_0x5e4d0f(0x18e)])pythonBridge[_0x5e4d0f(0x22d)](this,'SET_TOPOLOGY',JSON[_0x5e4d0f(0x282)](_0x1b588d[_0x5e4d0f(0x18e)]));}catch(_0x4635f4){}this['runPythonHealthCheck'](),this['triggerGaitAnalysis'](),this[_0x5e4d0f(0x22a)](),this[_0x5e4d0f(0x253)]();},0x1388);}[a0_0x1f5fbb(0x1bd)](_0x3156be){const _0x5db897=a0_0x1f5fbb;if(this[_0x5db897(0x27b)])clearInterval(this[_0x5db897(0x27b)]);if(this[_0x5db897(0x256)])clearInterval(this[_0x5db897(0x256)]);if(this[_0x5db897(0x1a1)])clearInterval(this[_0x5db897(0x1a1)]);if(this[_0x5db897(0x1cd)])clearInterval(this[_0x5db897(0x1cd)]);if(this[_0x5db897(0x273)])this[_0x5db897(0x273)][_0x5db897(0x1c7)]();if(this['modeResetJob'])this[_0x5db897(0x1e4)]['cancel']();if(this[_0x5db897(0x246)])this['briefingJob']['cancel']();recorder['abortExitTimer'](this),pythonBridge[_0x5db897(0x177)](this),_0x3156be();}async[a0_0x1f5fbb(0x26e)](_0x33a762,_0x877194){const _0x3600a3=a0_0x1f5fbb;if(!_0x877194||this[_0x3600a3(0x15f)])return;if(_0x33a762[_0x3600a3(0x202)]('telegram')&&_0x33a762[_0x3600a3(0x228)](_0x3600a3(0x24c))&&_0x877194['val'])return;if(this[_0x3600a3(0x19a)][_0x3600a3(0x1b5)]&&_0x33a762===this['config'][_0x3600a3(0x191)]){this[_0x3600a3(0x1a2)](_0x877194[_0x3600a3(0x18e)]);return;}if(_0x33a762===this['namespace']+_0x3600a3(0x1d5)){if(_0x877194['val']&&Object[_0x3600a3(0x17a)](setup['SYSTEM_MODES'])[_0x3600a3(0x202)](_0x877194['val'])){this[_0x3600a3(0x257)]=_0x877194[_0x3600a3(0x18e)];if(_0x877194[_0x3600a3(0x18e)]===setup['SYSTEM_MODES']['VACATION'])await recorder[_0x3600a3(0x164)](this,![]);else await recorder['setPresence'](this,!![]);if(this[_0x3600a3(0x1ef)]){let _0x33c707=![],_0x4a2262=0x0,_0x426ae7=_0x3600a3(0x23b);if(this['currentSystemMode']===_0x3600a3(0x21c))_0x33c707=!![],_0x4a2262=0x168,_0x426ae7=_0x3600a3(0x154);else this[_0x3600a3(0x257)]===_0x3600a3(0x16a)&&(_0x33c707=!![],_0x4a2262=0x5a0,_0x426ae7='Guest\x20Mode');pythonBridge['send'](this,'SET_LEARNING_MODE',{'active':_0x33c707,'duration':_0x4a2262,'label':_0x426ae7}),await this[_0x3600a3(0x260)](_0x3600a3(0x243),{'val':JSON[_0x3600a3(0x18b)]({'active':_0x33c707,'label':_0x426ae7,'timestamp':Date['now']()}),'ack':!![]});}}if(!_0x877194[_0x3600a3(0x21d)])this['setState'](_0x33a762,{'val':this['currentSystemMode'],'ack':!![]});return;}_0x33a762[_0x3600a3(0x228)]('analysis.energy.warmupSources')&&_0x877194[_0x3600a3(0x21d)]&&this[_0x3600a3(0x25f)](_0x877194['val']);if(!_0x877194['ack']){if(_0x33a762['includes']('analysis.trigger')&&_0x877194[_0x3600a3(0x18e)]){this[_0x3600a3(0x24f)](_0x33a762,{'val':![],'ack':!![]}),aiAgent['runGeminiAnalysis'](this);return;}if(_0x33a762[_0x3600a3(0x202)](_0x3600a3(0x21a))&&_0x877194['val']){this['setState'](_0x33a762,{'val':![],'ack':!![]});if(this['isProVersion'])aiAgent[_0x3600a3(0x209)](this,pythonBridge);return;}if(_0x33a762[_0x3600a3(0x202)]('triggerBriefing')&&_0x877194['val']){this[_0x3600a3(0x24f)](_0x33a762,{'val':![],'ack':!![]}),aiAgent[_0x3600a3(0x175)](this);return;}if(_0x33a762[_0x3600a3(0x202)]('automation.triggerAction')&&_0x877194[_0x3600a3(0x18e)]){this[_0x3600a3(0x24f)](_0x33a762,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x33a762[_0x3600a3(0x202)]('analysis.training.triggerSecurity')&&_0x877194['val']){this[_0x3600a3(0x24f)](_0x33a762,{'val':![],'ack':!![]});if(this[_0x3600a3(0x1ef)])try{const _0x5d9daf=await this[_0x3600a3(0x239)](_0x3600a3(0x204));if(_0x5d9daf&&_0x5d9daf['val']){const _0x2db444=JSON[_0x3600a3(0x282)](_0x5d9daf[_0x3600a3(0x18e)]);this[_0x3600a3(0x260)](_0x3600a3(0x14e),{'val':_0x3600a3(0x22c),'ack':!![]}),pythonBridge[_0x3600a3(0x22d)](this,_0x3600a3(0x252),{'sequences':_0x2db444});}}catch(_0x9e6dff){}return;}if(_0x33a762['includes']('analysis.training.triggerHealth')&&_0x877194[_0x3600a3(0x18e)]){this[_0x3600a3(0x24f)](_0x33a762,{'val':![],'ack':!![]});if(this[_0x3600a3(0x1ef)])try{const _0x118f0a=await this[_0x3600a3(0x239)](_0x3600a3(0x1e6));if(_0x118f0a&&_0x118f0a[_0x3600a3(0x18e)])pythonBridge['send'](this,_0x3600a3(0x23e),{'digests':JSON[_0x3600a3(0x282)](_0x118f0a[_0x3600a3(0x18e)])});}catch(_0x22fbec){}return;}if(_0x33a762['includes'](_0x3600a3(0x203))&&_0x877194[_0x3600a3(0x18e)]){this[_0x3600a3(0x24f)](_0x33a762,{'val':![],'ack':!![]});if(this[_0x3600a3(0x1ef)])try{const _0x40c52f=await this[_0x3600a3(0x239)](_0x3600a3(0x189));if(_0x40c52f&&_0x40c52f['val'])pythonBridge[_0x3600a3(0x22d)](this,_0x3600a3(0x1f0),{'points':JSON[_0x3600a3(0x282)](_0x40c52f['val'])});}catch(_0x47c573){}return;}if(_0x33a762[_0x3600a3(0x202)](_0x3600a3(0x236))&&_0x877194[_0x3600a3(0x18e)]){this[_0x3600a3(0x24f)](_0x33a762,{'val':![],'ack':!![]});if(this['isProVersion'])try{const _0x172a39=await this[_0x3600a3(0x239)]('LTM.rawEventLog');if(_0x172a39&&_0x172a39['val'])pythonBridge[_0x3600a3(0x22d)](this,'TRAIN_COMFORT',{'events':JSON['parse'](_0x172a39[_0x3600a3(0x18e)])});}catch(_0x15fcb7){}return;}if(_0x33a762[_0x3600a3(0x202)](_0x3600a3(0x223))&&_0x877194['val']){this[_0x3600a3(0x24f)](_0x33a762,{'val':![],'ack':!![]}),topology[_0x3600a3(0x265)](this);return;}}if(this['config'][_0x3600a3(0x1b3)]&&this[_0x3600a3(0x19a)][_0x3600a3(0x1b3)][_0x3600a3(0x202)](_0x33a762)){await this[_0x3600a3(0x27c)]();return;}const _0x4a4532=(this[_0x3600a3(0x19a)][_0x3600a3(0x186)]||[])[_0x3600a3(0x1d9)](_0x5ac517=>_0x5ac517['id']===_0x33a762);if(_0x4a4532){const _0x58799b=await recorder[_0x3600a3(0x162)](this,_0x33a762,_0x877194,_0x4a4532);_0x58799b&&_0x58799b[_0x3600a3(0x178)]===_0x3600a3(0x201)&&_0x58799b[_0x3600a3(0x283)]&&this[_0x3600a3(0x1ef)]&&deadMan[_0x3600a3(0x269)](this,_0x58799b[_0x3600a3(0x283)]),_0x877194['val']&&(_0x877194[_0x3600a3(0x18e)]===!![]||_0x877194['val']===0x1||String(_0x877194[_0x3600a3(0x18e)])[_0x3600a3(0x144)]()===_0x3600a3(0x285))&&(_0x4a4532[_0x3600a3(0x178)]&&(_0x4a4532[_0x3600a3(0x178)][_0x3600a3(0x202)](_0x3600a3(0x161))||_0x4a4532[_0x3600a3(0x178)][_0x3600a3(0x202)](_0x3600a3(0x193))||_0x4a4532[_0x3600a3(0x178)][_0x3600a3(0x202)]('magnet'))&&this[_0x3600a3(0x141)](_0x4a4532)),(_0x4a4532[_0x3600a3(0x178)]===_0x3600a3(0x17b)||_0x4a4532[_0x3600a3(0x178)]===_0x3600a3(0x267))&&automation[_0x3600a3(0x1a4)](this);}}async[a0_0x1f5fbb(0x25f)](_0x48aad2){const _0x498e83=a0_0x1f5fbb;if(!this[_0x498e83(0x1eb)]||Date[_0x498e83(0x151)]()-this[_0x498e83(0x13d)]>0x493e0)return;if(!this['memoryCache'][_0x498e83(0x274)]||!this[_0x498e83(0x1eb)][_0x498e83(0x199)])return;try{const _0x1b8022=JSON[_0x498e83(0x282)](_0x48aad2),_0x880ed5=this[_0x498e83(0x1eb)][_0x498e83(0x274)];let _0x2b0ea4=![];for(const _0x1c2387 in _0x880ed5){if(_0x880ed5[_0x1c2387]['includes']('AI')&&_0x1b8022[_0x1c2387]&&!_0x1b8022[_0x1c2387][_0x498e83(0x202)]('AI')){_0x2b0ea4=!![];break;}}_0x2b0ea4&&(this[_0x498e83(0x1aa)][_0x498e83(0x1b8)](_0x498e83(0x210)),await this[_0x498e83(0x260)](_0x498e83(0x27f),{'val':JSON[_0x498e83(0x18b)](this[_0x498e83(0x1eb)][_0x498e83(0x199)]),'ack':!![]}),await this[_0x498e83(0x260)](_0x498e83(0x262),{'val':JSON[_0x498e83(0x18b)](this['memoryCache']['sources']),'ack':!![]}));}catch(_0x1c4bdc){}}async[a0_0x1f5fbb(0x1b7)](_0x5a7514){const _0x407956=a0_0x1f5fbb;if(typeof _0x5a7514===_0x407956(0x187)&&_0x5a7514[_0x407956(0x1e7)]){if(_0x5a7514[_0x407956(0x1d0)]==='checkThermostats')try{const _0x15c126=await automation[_0x407956(0x21e)](this);this['sendTo'](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':!![],'results':_0x15c126},_0x5a7514['callback']);}catch(_0x404cd0){this['sendTo'](_0x5a7514['from'],_0x5a7514['command'],{'success':![],'error':_0x404cd0[_0x407956(0x1e7)]},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514[_0x407956(0x1d0)]==='simulateEnergyMPC')try{const {current_temps:_0x32bc06,t_out:_0x265c1b,targets:_0x1c067e,t_forecast:_0x4885b9}=_0x5a7514['message'],_0x2ad20e=[];let _0x245e15={};try{const _0x3475a6=await this[_0x407956(0x239)]('analysis.energy.insulationScore');if(_0x3475a6&&_0x3475a6['val']){const _0x4d8e32=JSON[_0x407956(0x282)](_0x3475a6[_0x407956(0x18e)]);_0x245e15=_0x4d8e32['scores']||_0x4d8e32;}}catch(_0xa0e43f){}const _0x2a752e=_0x4885b9!==undefined&&_0x4885b9!==null?(_0x265c1b+_0x4885b9)/0x2:_0x265c1b;for(const [_0x14d8dd,_0x1f2740]of Object[_0x407956(0x1bb)](_0x32bc06)){const _0x39cd6a=_0x1c067e[_0x14d8dd]||0x15;if(_0x1f2740<=_0x39cd6a)continue;let _0x542128=_0x245e15[_0x14d8dd]||-0.5;if(_0x542128>=0x0)_0x542128=-0.5;const _0x27da12=Math[_0x407956(0x250)](_0x542128),_0x24aa17=_0x1f2740-_0x39cd6a;let _0x42f7c5=Math[_0x407956(0x197)](_0x24aa17/_0x27da12*0x3c);const _0x7f3716=_0x1f2740-_0x265c1b,_0x5de3a3=_0x1f2740-_0x2a752e;if(_0x5de3a3!==0x0&&_0x7f3716!==0x0){const _0x12ef86=_0x7f3716/_0x5de3a3;_0x42f7c5=Math[_0x407956(0x197)](_0x42f7c5*_0x12ef86);}if(_0x42f7c5>0xf){if(_0x42f7c5>0xf0)_0x42f7c5=0xf0;_0x2ad20e[_0x407956(0x22b)]({'room':_0x14d8dd,'minutes_safe':_0x42f7c5,'target':_0x39cd6a,'current':_0x1f2740,'savings_msg':'Heizung\x20kann\x20'+_0x42f7c5+'\x20min\x20ausbleiben.'});}}_0x2ad20e[_0x407956(0x1f7)]((_0x46eaa1,_0x34d5f8)=>_0x34d5f8['minutes_safe']-_0x46eaa1[_0x407956(0x237)]),this[_0x407956(0x1c8)](_0x5a7514[_0x407956(0x1f6)],_0x5a7514['command'],{'success':!![],'proposals':_0x2ad20e},_0x5a7514[_0x407956(0x1a5)]);}catch(_0x377677){this['sendTo'](_0x5a7514[_0x407956(0x1f6)],_0x5a7514[_0x407956(0x1d0)],{'success':![],'error':_0x377677[_0x407956(0x1e7)]},_0x5a7514['callback']);}else{if(_0x5a7514[_0x407956(0x1d0)]===_0x407956(0x1f5))try{const _0x1fef21=_0x5a7514[_0x407956(0x1e7)][_0x407956(0x264)],_0x5ce7af=_0x407956(0x200),_0x3fa623=await this[_0x407956(0x239)](_0x5ce7af);let _0xb3c543={};if(_0x3fa623&&_0x3fa623[_0x407956(0x18e)])try{_0xb3c543=JSON[_0x407956(0x282)](_0x3fa623[_0x407956(0x18e)]);}catch(_0x447f17){}_0x1fef21&&_0xb3c543[_0x1fef21]?(delete _0xb3c543[_0x1fef21],await this['setStateAsync'](_0x5ce7af,{'val':JSON[_0x407956(0x18b)](_0xb3c543),'ack':!![]}),this[_0x407956(0x1aa)][_0x407956(0x1b8)](_0x407956(0x1cc)+_0x1fef21+'\x27\x20wurde\x20manuell\x20vom\x20Benutzer\x20gelÃ¶scht.'),this['sendTo'](_0x5a7514[_0x407956(0x1f6)],_0x5a7514[_0x407956(0x1d0)],{'success':!![]},_0x5a7514[_0x407956(0x1a5)])):this[_0x407956(0x1c8)](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':![],'error':_0x407956(0x216)},_0x5a7514[_0x407956(0x1a5)]);}catch(_0xef2d16){this[_0x407956(0x1c8)](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':![],'error':_0xef2d16[_0x407956(0x1e7)]},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514[_0x407956(0x1d0)]===_0x407956(0x163))await this['setStateAsync'](_0x407956(0x148),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x407956(0x238),{'val':'','ack':!![]}),await this['setStateAsync']('analysis.automation.targetId',{'val':'','ack':!![]}),this[_0x407956(0x1c8)](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':!![]},_0x5a7514['callback']);else{if(_0x5a7514[_0x407956(0x1d0)]===_0x407956(0x1dd)){const {targetId:_0xe4303,targetValue:_0x3590f6}=_0x5a7514[_0x407956(0x1e7)];await this[_0x407956(0x260)](_0x407956(0x148),{'val':!![],'ack':!![]}),await this['setStateAsync']('analysis.automation.description',{'val':'Simulation\x20durch\x20Admin\x20(Test)','ack':!![]}),await this['setStateAsync'](_0x407956(0x1dc),{'val':_0xe4303,'ack':!![]}),await this[_0x407956(0x260)](_0x407956(0x19f),{'val':String(_0x3590f6),'ack':!![]}),this['sendTo'](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':!![]},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514[_0x407956(0x1d0)]==='testApiKey')try{const _0x173931=_0x5a7514[_0x407956(0x1e7)][_0x407956(0x287)];if(!_0x173931)throw new Error(_0x407956(0x1f1));const _0x2ad191=new GoogleGenerativeAI(_0x173931),_0x5303bb=_0x2ad191[_0x407956(0x183)]({'model':GEMINI_MODEL}),_0x1172a9=await _0x5303bb['generateContent'](_0x407956(0x25c)),_0x88486b=await _0x1172a9[_0x407956(0x24a)];if(_0x88486b[_0x407956(0x173)]())this['sendTo'](_0x5a7514[_0x407956(0x1f6)],_0x5a7514[_0x407956(0x1d0)],{'success':!![],'message':_0x407956(0x158)},_0x5a7514[_0x407956(0x1a5)]);else throw new Error(_0x407956(0x229));}catch(_0x4fc815){this['sendTo'](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':![],'message':_0x4fc815[_0x407956(0x1e7)]},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514[_0x407956(0x1d0)]===_0x407956(0x1a3))try{const _0x211da8=await scanner[_0x407956(0x22e)](this,_0x5a7514[_0x407956(0x1e7)]||{});this[_0x407956(0x1c8)](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':!![],'devices':_0x211da8},_0x5a7514[_0x407956(0x1a5)]);}catch(_0x311f9b){this[_0x407956(0x1c8)](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':![],'error':_0x311f9b[_0x407956(0x1e7)]},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514['command']===_0x407956(0x146))try{const {matrix:_0x23312c}=_0x5a7514[_0x407956(0x1e7)],_0x3ffb07=await this['getStateAsync']('analysis.topology.structure');if(_0x3ffb07&&_0x3ffb07['val']){const _0x1d0190=JSON[_0x407956(0x282)](_0x3ffb07[_0x407956(0x18e)]);_0x1d0190['matrix']=_0x23312c,_0x1d0190['updated']=Date['now'](),await this[_0x407956(0x260)](_0x407956(0x192),{'val':JSON['stringify'](_0x1d0190),'ack':!![]}),pythonBridge[_0x407956(0x22d)](this,_0x407956(0x24e),_0x1d0190);}this[_0x407956(0x1c8)](_0x5a7514[_0x407956(0x1f6)],_0x5a7514[_0x407956(0x1d0)],{'success':!![]},_0x5a7514[_0x407956(0x1a5)]);}catch(_0x29a81f){this[_0x407956(0x1aa)]['error'](_0x29a81f);}else{if(_0x5a7514[_0x407956(0x1d0)]===_0x407956(0x1c4))this[_0x407956(0x1c8)](_0x5a7514[_0x407956(0x1f6)],_0x5a7514['command'],{'success':!![],'dailyDigests':this[_0x407956(0x1cb)]||[],'analysisHistory':this[_0x407956(0x241)]||[]},_0x5a7514[_0x407956(0x1a5)]);else{if(_0x5a7514[_0x407956(0x1d0)]==='getOverviewData'){const _0x6d5814=this['dailyDigests'][_0x407956(0x150)],_0x4c4d88=new Array(0x18)[_0x407956(0x23f)](0x0),_0x4ccd6c=new Date()[_0x407956(0x206)](0x0,0x0,0x0,0x0);this[_0x407956(0x1c6)]&&this['eventHistory'][_0x407956(0x281)](_0x5bd617=>{const _0x331780=_0x407956;if(_0x5bd617['timestamp']>=_0x4ccd6c){const _0xcb26ce=new Date(_0x5bd617[_0x331780(0x14d)])[_0x331780(0x1a9)]();if(_0xcb26ce>=0x0&&_0xcb26ce<0x18)_0x4c4d88[_0xcb26ce]++;}});let _0x963342=![],_0x694292='',_0x185555='',_0x371b15='';try{const _0x5e4ef2=await this[_0x407956(0x239)]('analysis.automation.patternDetected');if(_0x5e4ef2&&_0x5e4ef2[_0x407956(0x18e)]){_0x963342=!![];const _0x34d52f=await this[_0x407956(0x239)](_0x407956(0x238));_0x694292=_0x34d52f?_0x34d52f[_0x407956(0x18e)]:'';const _0x41748e=await this[_0x407956(0x239)](_0x407956(0x1dc));_0x185555=_0x41748e?_0x41748e[_0x407956(0x18e)]:'';const _0x28e5a5=await this[_0x407956(0x239)](_0x407956(0x19f));_0x371b15=_0x28e5a5?_0x28e5a5['val']:'';}}catch(_0x2196c9){}const _0x39d0f7=await this[_0x407956(0x179)](),_0x5c10a2=(this[_0x407956(0x19a)][_0x407956(0x186)]||[])[_0x407956(0x17c)](_0x2a929a=>_0x2a929a['isSolar']),_0x1149cd=_0x39d0f7&&_0x5c10a2;let _0x3118b0='';try{const _0x4044b4=await this[_0x407956(0x239)](_0x407956(0x1d8));if(_0x4044b4&&_0x4044b4[_0x407956(0x18e)])_0x3118b0=_0x4044b4['val'];}catch(_0x35dda0){}this[_0x407956(0x1c8)](_0x5a7514[_0x407956(0x1f6)],_0x5a7514['command'],{'success':!![],'eventHistory':this[_0x407956(0x1c6)][_0x407956(0x19c)](0x0,0xf),'stats':{'digestCount':_0x6d5814,'isPresent':this[_0x407956(0x217)],'hourlyActivity':_0x4c4d88,'solarActive':_0x1149cd,'presenceWho':_0x3118b0},'automation':{'detected':_0x963342,'description':_0x694292,'targetId':_0x185555,'targetValue':_0x371b15}},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514[_0x407956(0x1d0)]===_0x407956(0x18f)){const _0x4471f5=await this[_0x407956(0x270)]('enum.functions.*',_0x407956(0x149)),_0x3bdc36=[];if(_0x4471f5)for(const _0x41342f in _0x4471f5){const _0x3e0324=_0x4471f5[_0x41342f],_0x1a49b0=(_0x3e0324[_0x407956(0x1ae)]&&typeof _0x3e0324[_0x407956(0x1ae)]['name']===_0x407956(0x187)?_0x3e0324['common'][_0x407956(0x26c)]['de']:_0x3e0324[_0x407956(0x1ae)]['name'])||_0x3e0324[_0x407956(0x1ae)][_0x407956(0x26c)];_0x3bdc36['push']({'id':_0x41342f,'name':_0x1a49b0});}const _0x3ef876=await this[_0x407956(0x270)](_0x407956(0x152),_0x407956(0x149)),_0x2cb1f2=[];if(_0x3ef876)for(const _0x4a1c57 in _0x3ef876){const _0x36bef6=_0x3ef876[_0x4a1c57],_0xd1ce92=(_0x36bef6[_0x407956(0x1ae)]&&typeof _0x36bef6[_0x407956(0x1ae)][_0x407956(0x26c)]===_0x407956(0x187)?_0x36bef6[_0x407956(0x1ae)]['name']['de']:_0x36bef6[_0x407956(0x1ae)]['name'])||_0x4a1c57['split']('.')[_0x407956(0x15a)]();_0x2cb1f2[_0x407956(0x22b)](_0xd1ce92);}this[_0x407956(0x1c8)](_0x5a7514[_0x407956(0x1f6)],_0x5a7514['command'],{'success':!![],'enums':_0x3bdc36,'rooms':_0x2cb1f2},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514[_0x407956(0x1d0)]===_0x407956(0x205))try{let _0xc79def=_0x407956(0x1b1),_0xa871d=_0x407956(0x14c);if(this[_0x407956(0x19a)][_0x407956(0x1fa)]){const _0x5aeb16=await recorder[_0x407956(0x19e)](this);_0xc79def=_0x5aeb16!==null?_0x5aeb16+'Â°C':_0x407956(0x167);}if(this[_0x407956(0x19a)][_0x407956(0x180)]){const _0x17242c=await this['getForeignObjectAsync'](_0x407956(0x255)+this[_0x407956(0x19a)][_0x407956(0x180)]);_0xa871d=_0x17242c?_0x407956(0x245):_0x407956(0x174);}this['sendTo'](_0x5a7514[_0x407956(0x1f6)],_0x5a7514[_0x407956(0x1d0)],{'success':!![],'weather':_0xc79def,'calendar':_0xa871d},_0x5a7514[_0x407956(0x1a5)]);}catch(_0x3df2d8){this[_0x407956(0x1c8)](_0x5a7514[_0x407956(0x1f6)],_0x5a7514[_0x407956(0x1d0)],{'success':![],'error':_0x3df2d8['message']},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514[_0x407956(0x1d0)]==='getCalendarNames')try{const _0x568ef0=_0x5a7514['message'][_0x407956(0x15d)],_0xea9ca8=await this[_0x407956(0x17d)](_0x568ef0+_0x407956(0x20a));let _0x12dc7f=[];if(_0xea9ca8&&_0xea9ca8[_0x407956(0x18e)]){const _0x2db385=JSON[_0x407956(0x282)](_0xea9ca8[_0x407956(0x18e)]),_0x4b0c9a=new Set();Array[_0x407956(0x25a)](_0x2db385)&&_0x2db385[_0x407956(0x281)](_0x12d448=>{const _0x2c8ae7=_0x407956;if(_0x12d448[_0x2c8ae7(0x25d)])_0x4b0c9a['add'](_0x12d448[_0x2c8ae7(0x25d)]);else{if(_0x12d448[_0x2c8ae7(0x1fb)])_0x4b0c9a[_0x2c8ae7(0x1c1)](_0x12d448[_0x2c8ae7(0x1fb)]);}}),_0x12dc7f=Array['from'](_0x4b0c9a)[_0x407956(0x1f7)]();}if(_0x12dc7f[_0x407956(0x150)]===0x0)_0x12dc7f=[_0x407956(0x140)];this['sendTo'](_0x5a7514[_0x407956(0x1f6)],_0x5a7514['command'],{'success':!![],'names':_0x12dc7f},_0x5a7514[_0x407956(0x1a5)]);}catch(_0x181e13){this[_0x407956(0x1c8)](_0x5a7514['from'],_0x5a7514[_0x407956(0x1d0)],{'success':![],'error':_0x181e13[_0x407956(0x1e7)]},_0x5a7514[_0x407956(0x1a5)]);}else{if(_0x5a7514[_0x407956(0x1d0)]===_0x407956(0x182))try{await setup['sendNotification'](this,_0x407956(0x1e5),![],![]),this[_0x407956(0x1c8)](_0x5a7514[_0x407956(0x1f6)],_0x5a7514[_0x407956(0x1d0)],{'success':!![],'message':_0x407956(0x18d)},_0x5a7514['callback']);}catch(_0x278d22){this[_0x407956(0x1aa)]['error'](_0x407956(0x27e)+_0x278d22[_0x407956(0x1e7)]),this[_0x407956(0x1c8)](_0x5a7514['from'],_0x5a7514['command'],{'success':![],'message':'Fehler:\x20'+_0x278d22[_0x407956(0x1e7)]},_0x5a7514[_0x407956(0x1a5)]);}}}}}}}}}}}}}}}}async['loadSystemMode'](){const _0x29525f=a0_0x1f5fbb;try{const _0xfeb7e6=await this[_0x29525f(0x239)](setup[_0x29525f(0x17e)]);_0xfeb7e6&&_0xfeb7e6['val']&&Object[_0x29525f(0x17a)](setup[_0x29525f(0x1e2)])['includes'](_0xfeb7e6[_0x29525f(0x18e)])?this['currentSystemMode']=_0xfeb7e6[_0x29525f(0x18e)]:(this[_0x29525f(0x257)]=setup[_0x29525f(0x1e2)]['NORMAL'],await this['setStateAsync'](setup[_0x29525f(0x17e)],{'val':setup[_0x29525f(0x1e2)]['NORMAL'],'ack':!![]}));}catch(_0x230d86){this['currentSystemMode']=setup[_0x29525f(0x1e2)][_0x29525f(0x15c)];}}async['checkWifiPresence'](){const _0x2f3253=a0_0x1f5fbb;try{const _0x1aa91c=this[_0x2f3253(0x19a)]['presenceDevices']||[];let _0x179f07=![];const _0x14c91e=[];for(const _0x26f73e of _0x1aa91c){try{const _0x4ab8a8=await this[_0x2f3253(0x17d)](_0x26f73e);_0x4ab8a8&&(_0x4ab8a8[_0x2f3253(0x18e)]===!![]||_0x4ab8a8['val']==='online'||_0x4ab8a8['val']===0x1)&&(_0x179f07=!![],_0x14c91e[_0x2f3253(0x22b)](_0x26f73e));}catch(_0x36ab34){}}return await this['setStateAsync'](_0x2f3253(0x1d8),{'val':_0x14c91e['join'](',\x20'),'ack':!![]}),_0x179f07&&(this['exitTimer']&&(this['log'][_0x2f3253(0x1b8)]('WiFi\x20Presence\x20detected.'),recorder[_0x2f3253(0x27d)](this)),!this[_0x2f3253(0x217)]&&this['currentSystemMode']===setup[_0x2f3253(0x1e2)]['NORMAL']&&await recorder[_0x2f3253(0x164)](this,!![])),_0x179f07;}catch(_0x482602){return![];}}async[a0_0x1f5fbb(0x195)](){const _0x4e2877=a0_0x1f5fbb;this[_0x4e2877(0x1aa)][_0x4e2877(0x1ea)](_0x4e2877(0x1fd)),await aiAgent[_0x4e2877(0x196)](this),this[_0x4e2877(0x253)](),this[_0x4e2877(0x22f)](),this[_0x4e2877(0x22a)]();}async[a0_0x1f5fbb(0x179)](){const _0x31071b=a0_0x1f5fbb,_0x382f18=['weatherunderground.0',_0x31071b(0x160),_0x31071b(0x221)],_0x58437d=[_0x31071b(0x1e1),_0x31071b(0x1b6),'NextHours.Location_1.Day_1.current.symbol_desc'];for(const _0x1c03c0 of _0x382f18){for(const _0x2f7143 of _0x58437d){try{const _0x38941d=_0x1c03c0+'.'+_0x2f7143,_0x20a59f=await this['getForeignStateAsync'](_0x38941d);if(_0x20a59f&&_0x20a59f['val']){const _0x486d6c=String(_0x20a59f['val'])['toLowerCase']();if(_0x486d6c[_0x31071b(0x202)](_0x31071b(0x254))||_0x486d6c[_0x31071b(0x202)](_0x31071b(0x275))||_0x486d6c[_0x31071b(0x202)](_0x31071b(0x211))||_0x486d6c[_0x31071b(0x202)]('clear')||_0x486d6c[_0x31071b(0x202)](_0x31071b(0x1c5)))return!![];}}catch(_0x543ace){}}}return![];}[a0_0x1f5fbb(0x22f)](){const _0x559a97=a0_0x1f5fbb;if(!this[_0x559a97(0x1ef)])return;try{this[_0x559a97(0x1ba)]('LTM.trainingData.sequences',(_0x4bb501,_0xd7aa72)=>{const _0x491566=_0x559a97;_0xd7aa72&&_0xd7aa72[_0x491566(0x18e)]&&pythonBridge[_0x491566(0x22d)](this,_0x491566(0x1b0),{'sequences':JSON['parse'](_0xd7aa72[_0x491566(0x18e)])});});}catch(_0x5c8704){}}async[a0_0x1f5fbb(0x22a)](){const _0x1760f9=a0_0x1f5fbb;if(!this[_0x1760f9(0x1ef)])return;try{const _0x480e86=await recorder['getOutsideTemperatureNumeric'](this);if(_0x480e86===null)return;const _0x5e4bf={},_0x35bc67={},_0x88995e=this['config'][_0x1760f9(0x186)]||[];for(const _0x5b725c of _0x88995e){if(_0x5b725c[_0x1760f9(0x178)]===_0x1760f9(0x17b)&&_0x5b725c[_0x1760f9(0x283)]){const _0x40629a=this[_0x1760f9(0x170)][_0x5b725c['id']];if(_0x40629a!==undefined)_0x5e4bf[_0x5b725c['location']]=_0x40629a;if(_0x5b725c[_0x1760f9(0x1a6)])_0x35bc67[_0x5b725c[_0x1760f9(0x283)]]=!![];}}const _0x2071f=await this[_0x1760f9(0x179)]();let _0x3e60f7={};try{const _0x2bafc0=await this['getStateAsync'](_0x1760f9(0x181));if(_0x2bafc0&&_0x2bafc0[_0x1760f9(0x18e)])_0x3e60f7=JSON['parse'](_0x2bafc0['val']);}catch(_0x4a9b16){}Object[_0x1760f9(0x1ff)](_0x5e4bf)[_0x1760f9(0x150)]>0x0&&(pythonBridge['send'](this,_0x1760f9(0x21f),{'current_temps':_0x5e4bf,'t_out':_0x480e86,'is_sunny':_0x2071f,'solar_flags':_0x35bc67,'warmup_targets':_0x3e60f7}),pythonBridge[_0x1760f9(0x22d)](this,'OPTIMIZE_ENERGY',{'current_temps':_0x5e4bf,'t_out':_0x480e86,'targets':{}}));}catch(_0x1353a4){}}[a0_0x1f5fbb(0x253)](){const _0x483fce=a0_0x1f5fbb;if(!this[_0x483fce(0x248)]||this[_0x483fce(0x248)]['length']===0x0)return;const _0x39896f=new Array(0x60)[_0x483fce(0x23f)](0x0),_0x582e17=new Date()[_0x483fce(0x206)](0x0,0x0,0x0,0x0);this[_0x483fce(0x248)][_0x483fce(0x281)](_0x48bc16=>{const _0xa6f82=_0x483fce,_0xe0975d=new Date(_0x48bc16['timestamp']);if(_0xe0975d[_0xa6f82(0x1d2)]()>=_0x582e17){const _0x4117fd=_0xe0975d[_0xa6f82(0x1a9)](),_0xed6369=_0xe0975d[_0xa6f82(0x15b)](),_0xd318a1=_0x4117fd*0x4+Math['floor'](_0xed6369/0xf);if(_0xd318a1>=0x0&&_0xd318a1<0x60)_0x39896f[_0xd318a1]++;}}),this[_0x483fce(0x260)](_0x483fce(0x1c2),{'val':JSON[_0x483fce(0x18b)](_0x39896f),'ack':!![]});}[a0_0x1f5fbb(0x156)](){const _0x4f4109=a0_0x1f5fbb;if(!this[_0x4f4109(0x1cb)]||this[_0x4f4109(0x1cb)][_0x4f4109(0x150)]<0x2)return;const _0x16c1af=this['dailyDigests']['map'](_0x1d1161=>{const _0x266082=_0x4f4109,_0x3a9d53=(_0x1d1161[_0x266082(0x1de)]||'')['toLowerCase']();return ACTIVITY_LEVEL_MAP[_0x3a9d53]||0x32;});pythonBridge['send'](this,_0x4f4109(0x1e8),{'values':_0x16c1af,'tag':_0x4f4109(0x225)});}async['handleInfrasound'](_0x5f4bec){const _0x583026=a0_0x1f5fbb;if(_0x5f4bec==null||typeof _0x5f4bec!==_0x583026(0x145))return;const _0x16ce1b=Date[_0x583026(0x151)]();this['pressureBuffer'][_0x583026(0x22b)]({'ts':_0x16ce1b,'val':_0x5f4bec}),this[_0x583026(0x1b4)]=this[_0x583026(0x1b4)]['filter'](_0x336b49=>_0x16ce1b-_0x336b49['ts']<0x1388);if(this[_0x583026(0x1e9)])return;if(this[_0x583026(0x19a)]['infrasoundArmingId']){const _0x1d0c55=await this[_0x583026(0x17d)](this[_0x583026(0x19a)][_0x583026(0x247)]);if(_0x1d0c55&&!_0x1d0c55[_0x583026(0x18e)])return;}const _0x3aa570=this[_0x583026(0x19a)]['infrasoundThreshold']||0.04;if(Math[_0x583026(0x250)](_0x5f4bec)>=_0x3aa570){this['log']['warn']('[Infrasound]\x20ðŸš¨\x20ALARM\x20TRIGGERED!\x20Pressure\x20Wave:\x20'+_0x5f4bec+_0x583026(0x1b9)+_0x3aa570+')'),await this['setStateAsync']('security.alarm_triggered',{'val':!![],'ack':!![]});const _0x450c6a=this['isPresent'];_0x450c6a?(this[_0x583026(0x1aa)][_0x583026(0x1b8)]('[Infrasound]\x20ðŸŸ¡\x20Debug-Mode:\x20Alarm\x20detected\x20but\x20suppressed\x20because\x20presence=true.'),this[_0x583026(0x215)](_0x5f4bec,_0x583026(0x176))):(this[_0x583026(0x215)](_0x5f4bec,_0x583026(0x14a)),this[_0x583026(0x207)](_0x583026(0x1f9)+_0x5f4bec+'\x20hPa.\x20Einbruch\x20wahrscheinlich.')),this[_0x583026(0x1e9)]=!![],setTimeout(()=>{const _0x3a78b2=_0x583026;this[_0x3a78b2(0x1e9)]=![];},0x2710);}}async['triggerInfrasoundCorrelation'](_0x47d057,_0x41cbbe='ALARM'){const _0x172918=a0_0x1f5fbb,_0x1811b1=Date[_0x172918(0x151)](),_0x41ff9b=this[_0x172918(0x19a)][_0x172918(0x186)]||[];setTimeout(async()=>{const _0x309e00=_0x172918;let _0x229c44=null,_0x1d763c=_0x309e00(0x157);const _0x4b33cd=[],_0x4e8eb8=_0x41ff9b[_0x309e00(0x1fe)](_0x30f9bc=>_0x30f9bc[_0x309e00(0x178)]&&(_0x30f9bc[_0x309e00(0x178)]['includes']('window')||_0x30f9bc[_0x309e00(0x178)]['includes'](_0x309e00(0x193))||_0x30f9bc['type'][_0x309e00(0x202)](_0x309e00(0x230))||_0x30f9bc['type']['includes'](_0x309e00(0x1cf)))||_0x30f9bc[_0x309e00(0x20e)]&&(_0x30f9bc['role'][_0x309e00(0x202)](_0x309e00(0x235))||_0x30f9bc[_0x309e00(0x20e)][_0x309e00(0x202)](_0x309e00(0x1f4))));for(const _0x270712 of _0x4e8eb8){try{const _0x2cf279=await this['getForeignStateAsync'](_0x270712['id']);if(_0x2cf279){if(_0x2cf279['ts']>=_0x1811b1-0x7d0){_0x229c44=_0x270712[_0x309e00(0x26c)]||_0x270712['id'],_0x1d763c=_0x309e00(0x188)+_0x229c44;break;}}}catch(_0x49f846){}}const _0x167dd0={'timestamp':_0x1811b1,'pressure':_0x47d057,'isMatch':!!_0x229c44,'explanation':_0x1d763c,'type':_0x41cbbe};await this[_0x309e00(0x18c)](_0x167dd0),this[_0x309e00(0x1aa)][_0x309e00(0x1b8)](_0x309e00(0x20c)+(!!_0x229c44?_0x309e00(0x26a):_0x309e00(0x153)));},0x1388);}async[a0_0x1f5fbb(0x141)](_0x588487){const _0x34fb3=a0_0x1f5fbb,_0x4408cc=Date['now'](),_0x99909b=_0x588487[_0x34fb3(0x26c)]||_0x588487['id'][_0x34fb3(0x271)]('.')[_0x34fb3(0x15a)]();let _0x30c76d=0x0;setTimeout(async()=>{const _0x45a0da=_0x34fb3;this['pressureBuffer'][_0x45a0da(0x281)](_0x1b912f=>{const _0x632394=_0x45a0da;_0x1b912f['ts']>=_0x4408cc-0xfa0&&_0x1b912f['ts']<=_0x4408cc+0x3e8&&(Math[_0x632394(0x250)](_0x1b912f[_0x632394(0x18e)])>Math[_0x632394(0x250)](_0x30c76d)&&(_0x30c76d=_0x1b912f['val']));});const _0x5f3c57=this[_0x45a0da(0x19a)][_0x45a0da(0x1e0)]||0.04,_0x3f9df2=Math['abs'](_0x30c76d)>=_0x5f3c57,_0x20b7cc={'timestamp':_0x4408cc,'pressure':_0x30c76d,'isMatch':_0x3f9df2,'explanation':_0x45a0da(0x286)+_0x99909b,'type':_0x45a0da(0x258)};await this['appendToLog'](_0x20b7cc),this['log'][_0x45a0da(0x1ea)](_0x45a0da(0x13e)+_0x99909b+_0x45a0da(0x1d3)+_0x30c76d[_0x45a0da(0x1c9)](0x4)+_0x45a0da(0x276)+_0x5f3c57+')');},0x1f4);}async[a0_0x1f5fbb(0x18c)](_0x5adb0b){const _0x5ebb2c=a0_0x1f5fbb;try{const _0x2e02f4=await this[_0x5ebb2c(0x239)]('analysis.security.infrasoundLog');let _0x26f5cb=[];if(_0x2e02f4&&_0x2e02f4[_0x5ebb2c(0x18e)])_0x26f5cb=JSON['parse'](_0x2e02f4['val']);_0x26f5cb['unshift'](_0x5adb0b);if(_0x26f5cb[_0x5ebb2c(0x150)]>0x14)_0x26f5cb=_0x26f5cb[_0x5ebb2c(0x19c)](0x0,0x14);await this[_0x5ebb2c(0x260)](_0x5ebb2c(0x263),{'val':JSON['stringify'](_0x26f5cb),'ack':!![]});}catch(_0x10b56a){this[_0x5ebb2c(0x1aa)][_0x5ebb2c(0x1ad)](_0x5ebb2c(0x249)+_0x10b56a[_0x5ebb2c(0x1e7)]);}}[a0_0x1f5fbb(0x207)](_0x5419e0){const _0x2d8dce=a0_0x1f5fbb;this[_0x2d8dce(0x19a)]['notifyPushoverEnabled']&&this[_0x2d8dce(0x19a)][_0x2d8dce(0x13f)]&&this[_0x2d8dce(0x1c8)](this['config'][_0x2d8dce(0x13f)],_0x2d8dce(0x22d),{'message':_0x5419e0,'title':_0x2d8dce(0x16d),'priority':0x1}),this[_0x2d8dce(0x19a)][_0x2d8dce(0x226)]&&this['config'][_0x2d8dce(0x16e)]&&this[_0x2d8dce(0x1c8)](this[_0x2d8dce(0x19a)]['notifyTelegramInstance'],_0x2d8dce(0x22d),{'text':_0x5419e0});}}function a0_0x338f(_0x5006e9,_0x5b569a){const _0x419722=a0_0xfb24();return a0_0x338f=function(_0x28c112,_0x41c9f2){_0x28c112=_0x28c112-0x139;let _0xfb24fc=_0x419722[_0x28c112];return _0xfb24fc;},a0_0x338f(_0x5006e9,_0x5b569a);}if(require[a0_0x1f5fbb(0x23a)]!==module)module[a0_0x1f5fbb(0x219)]=_0x30652c=>new CogniLiving(_0x30652c);else new CogniLiving();