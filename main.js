const a0_0x5f0772=a0_0x2b21;(function(_0x14fcd3,_0x30e4ac){const _0x2fbc6a=a0_0x2b21,_0x1af560=_0x14fcd3();while(!![]){try{const _0x3153c6=parseInt(_0x2fbc6a(0x31b))/0x1+parseInt(_0x2fbc6a(0x235))/0x2*(parseInt(_0x2fbc6a(0x31c))/0x3)+parseInt(_0x2fbc6a(0x30a))/0x4*(-parseInt(_0x2fbc6a(0x33f))/0x5)+parseInt(_0x2fbc6a(0x23e))/0x6*(-parseInt(_0x2fbc6a(0x26b))/0x7)+parseInt(_0x2fbc6a(0x385))/0x8+parseInt(_0x2fbc6a(0x26e))/0x9+parseInt(_0x2fbc6a(0x2f7))/0xa*(-parseInt(_0x2fbc6a(0x206))/0xb);if(_0x3153c6===_0x30e4ac)break;else _0x1af560['push'](_0x1af560['shift']());}catch(_0x2bac7f){_0x1af560['push'](_0x1af560['shift']());}}}(a0_0x3027,0xe39b5));const a0_0x5943a9=(function(){let _0x1a0b91=!![];return function(_0xca2c72,_0x4248dd){const _0x238704=_0x1a0b91?function(){if(_0x4248dd){const _0x144f4c=_0x4248dd['apply'](_0xca2c72,arguments);return _0x4248dd=null,_0x144f4c;}}:function(){};return _0x1a0b91=![],_0x238704;};}()),a0_0x324fea=a0_0x5943a9(this,function(){const _0x4126e4=a0_0x2b21;return a0_0x324fea[_0x4126e4(0x254)]()[_0x4126e4(0x2e2)](_0x4126e4(0x2e9))['toString']()[_0x4126e4(0x21b)](a0_0x324fea)[_0x4126e4(0x2e2)](_0x4126e4(0x2e9));});a0_0x324fea();'use strict';const utils=require(a0_0x5f0772(0x1fd)),{GoogleGenerativeAI}=require(a0_0x5f0772(0x2c9)),{spawn}=require(a0_0x5f0772(0x334)),path=require(a0_0x5f0772(0x2f9)),fs=require('fs'),installer=require('./lib/installer'),scanner=require('./lib/scanner'),schedulers=require(a0_0x5f0772(0x2fc)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x5f0772(0x313),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x5f0772(0x23f),LTM_DP_DAILY_DIGESTS=a0_0x5f0772(0x372),LTM_DP_STATUS=a0_0x5f0772(0x304),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x5f0772(0x351),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x5f0772(0x296),LTM_DP_DRIFT_DETAILS=a0_0x5f0772(0x371),LTM_DP_DRIFT_LAST_CHECK=a0_0x5f0772(0x347),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x5f0772(0x2a5),'VACATION':a0_0x5f0772(0x212),'PARTY':a0_0x5f0772(0x2c5),'GUEST':a0_0x5f0772(0x29d)},AUTO_RESET_MODES=[SYSTEM_MODES['PARTY'],SYSTEM_MODES[a0_0x5f0772(0x2d7)]],PERSONA_MAPPING={'generic':a0_0x5f0772(0x249),'senior_aal':'PRIORITÃ„T:\x20Gesundheit/AAL.','family':a0_0x5f0772(0x293),'single_comfort':a0_0x5f0772(0x357),'security':'PRIORITÃ„T:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x4bcf1c){const _0x4610fe=a0_0x5f0772;try{const _0x131f50=[_0x4610fe(0x201),_0x4610fe(0x2a8)];for(const _0x5f4196 of _0x131f50){try{const _0x5996fb=await _0x4bcf1c[_0x4610fe(0x2ff)](_0x5f4196);if(_0x5996fb)await _0x4bcf1c[_0x4610fe(0x25f)](_0x5f4196);}catch(_0x56965c){}}}catch(_0x159844){}}async function checkLicense(_0x51d264){return!![];}async function initHistory(_0x2ef0b5){const _0x1f243d=a0_0x5f0772;try{const _0x10c4b1=await _0x2ef0b5[_0x1f243d(0x270)](_0x1f243d(0x358));_0x10c4b1&&_0x10c4b1[_0x1f243d(0x241)]&&(_0x2ef0b5['eventHistory']=JSON[_0x1f243d(0x24a)](_0x10c4b1[_0x1f243d(0x241)][_0x1f243d(0x254)]()));}catch(_0x1b19f3){_0x2ef0b5['eventHistory']=[];}try{const _0x321af2=await _0x2ef0b5[_0x1f243d(0x270)]('analysis.analysisHistory');if(_0x321af2&&_0x321af2[_0x1f243d(0x241)])_0x2ef0b5['analysisHistory']=JSON['parse'](_0x321af2[_0x1f243d(0x241)][_0x1f243d(0x254)]());}catch(_0x29609e){_0x2ef0b5['analysisHistory']=[];}if(_0x2ef0b5['eventHistory']&&_0x2ef0b5[_0x1f243d(0x325)][_0x1f243d(0x340)]>0x0){_0x2ef0b5[_0x1f243d(0x319)][_0x1f243d(0x35c)]('Restoring\x20sensor\x20cache...');for(let _0x57b77e=_0x2ef0b5['eventHistory']['length']-0x1;_0x57b77e>=0x0;_0x57b77e--){const _0x12c5dc=_0x2ef0b5[_0x1f243d(0x325)][_0x57b77e];if(_0x12c5dc&&_0x12c5dc['id']!==undefined&&_0x12c5dc['value']!==undefined)_0x2ef0b5[_0x1f243d(0x24c)][_0x12c5dc['id']]=_0x12c5dc[_0x1f243d(0x272)];}}}async function initSystemConfig(_0x7ca5c1){const _0x289791=a0_0x5f0772;try{const _0x21f910=await _0x7ca5c1[_0x289791(0x205)](_0x289791(0x2cd));if(_0x21f910&&_0x21f910['common'])_0x7ca5c1[_0x289791(0x244)]={'latitude':_0x21f910[_0x289791(0x318)][_0x289791(0x2bc)]||0x0,'longitude':_0x21f910['common'][_0x289791(0x288)]||0x0,'city':_0x21f910['common'][_0x289791(0x222)]||''};}catch(_0x231eab){}}async function createAllObjects(_0x457fb9){const _0x3716fc=a0_0x5f0772;await _0x457fb9[_0x3716fc(0x2d9)](_0x3716fc(0x299),{'type':_0x3716fc(0x1fa),'common':{'name':_0x3716fc(0x2fe)},'native':{}}),await _0x457fb9[_0x3716fc(0x2d9)](SYSTEM_DP_MODE,{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x20c),'type':'string','role':'state','read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL']},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x2d8),{'type':_0x3716fc(0x259),'common':{'name':'Who\x20is\x20present?','type':_0x3716fc(0x2cf),'role':_0x3716fc(0x337),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x356),{'type':'state','common':{'name':_0x3716fc(0x305),'type':_0x3716fc(0x2cf),'role':'json','read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x358),{'type':'state','common':{'name':_0x3716fc(0x342),'type':_0x3716fc(0x2cf),'role':'json','read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2d9)](_0x3716fc(0x35b),{'type':_0x3716fc(0x1fa),'common':{'name':'AI\x20Training'},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x374),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x239),'type':_0x3716fc(0x306),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)]('analysis.training.triggerHealth',{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x2e6),'type':_0x3716fc(0x306),'role':_0x3716fc(0x274),'read':!![],'write':!![]},'native':{}}),await _0x457fb9['setObjectNotExistsAsync'](_0x3716fc(0x32a),{'type':_0x3716fc(0x259),'common':{'name':'Train\x20Energy','type':'boolean','role':_0x3716fc(0x274),'read':!![],'write':!![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x25c),{'type':'state','common':{'name':_0x3716fc(0x256),'type':_0x3716fc(0x306),'role':_0x3716fc(0x274),'read':!![],'write':!![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x28b),{'type':'state','common':{'name':_0x3716fc(0x339),'type':_0x3716fc(0x306),'role':_0x3716fc(0x274),'read':!![],'write':!![]},'native':{}}),await _0x457fb9['setObjectNotExistsAsync'](_0x3716fc(0x28c),{'type':_0x3716fc(0x259),'common':{'name':'Training\x20Status','type':_0x3716fc(0x2cf),'role':_0x3716fc(0x337),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2d9)](_0x3716fc(0x377),{'type':'channel','common':{'name':_0x3716fc(0x331)},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x2e3),{'type':_0x3716fc(0x259),'common':{'name':'Anomaly\x20Score','type':'number','role':_0x3716fc(0x272),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x25d),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x247),'type':_0x3716fc(0x320),'role':_0x3716fc(0x272),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x369),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x27e),'type':_0x3716fc(0x2cf),'role':_0x3716fc(0x2f2),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)]('analysis.security.topologyMatrix',{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x2a1),'type':_0x3716fc(0x2cf),'role':'json','read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2d9)]('analysis.health',{'type':'channel','common':{'name':_0x3716fc(0x284)},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x2b1),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x27e),'type':_0x3716fc(0x2cf),'role':'date','read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x368),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x28a),'type':_0x3716fc(0x306),'role':_0x3716fc(0x33d),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x231),{'type':'state','common':{'name':_0x3716fc(0x352),'type':_0x3716fc(0x2cf),'role':_0x3716fc(0x337),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)]('analysis.health.trendValue',{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x2aa),'type':_0x3716fc(0x320),'role':_0x3716fc(0x272),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x36d),{'type':_0x3716fc(0x259),'common':{'name':'Today\x20Vector\x20(15m)','type':_0x3716fc(0x2cf),'role':_0x3716fc(0x2f3),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x261),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x381),'type':_0x3716fc(0x320),'role':_0x3716fc(0x272),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2d9)](_0x3716fc(0x221),{'type':_0x3716fc(0x1fa),'common':{'name':_0x3716fc(0x301)},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x315),{'type':'state','common':{'name':_0x3716fc(0x271),'type':_0x3716fc(0x2cf),'role':_0x3716fc(0x337),'read':!![],'write':![]},'native':{}}),await _0x457fb9['setObjectNotExistsAsync'](_0x3716fc(0x290),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x354),'type':_0x3716fc(0x2cf),'role':_0x3716fc(0x337),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x2d0),{'type':'state','common':{'name':'Temperature\x20Forecast','type':_0x3716fc(0x2cf),'role':_0x3716fc(0x2f3),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2d9)](_0x3716fc(0x355),{'type':_0x3716fc(0x1fa),'common':{'name':_0x3716fc(0x355)},'native':{}}),await _0x457fb9['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x3716fc(0x361),'type':'string','role':_0x3716fc(0x2f3),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2d9)](LTM_DP_DAILY_DIGESTS,{'type':_0x3716fc(0x259),'common':{'name':'Daily\x20Digests','type':_0x3716fc(0x2cf),'role':'json','read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x34e),{'type':'state','common':{'name':_0x3716fc(0x376),'type':'string','role':_0x3716fc(0x2f3),'read':!![],'write':![]},'native':{}}),await _0x457fb9['setObjectNotExistsAsync'](_0x3716fc(0x360),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x2ba),'type':_0x3716fc(0x2cf),'role':'json','read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)]('analysis.trigger',{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x32c),'type':'boolean','role':_0x3716fc(0x274),'read':!![],'write':!![]},'native':{}}),await _0x457fb9['setObjectNotExistsAsync']('analysis.triggerBriefing',{'type':'state','common':{'name':_0x3716fc(0x2cc),'type':_0x3716fc(0x306),'role':_0x3716fc(0x274),'read':!![],'write':!![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x24d),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x37b),'type':'boolean','role':'indicator.alarm','read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x2b3),{'type':_0x3716fc(0x259),'common':{'name':'Alert\x20Reason','type':_0x3716fc(0x2cf),'role':_0x3716fc(0x1f3),'read':!![],'write':![]},'native':{}}),await _0x457fb9['setObjectNotExistsAsync']('analysis.activitySummary',{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x303),'type':_0x3716fc(0x2cf),'role':_0x3716fc(0x337),'read':!![],'write':![]},'native':{}}),await _0x457fb9['setObjectNotExistsAsync']('analysis.automation.patternDetected',{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x280),'type':_0x3716fc(0x306),'role':_0x3716fc(0x33d),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x384),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x2c8),'type':_0x3716fc(0x2cf),'role':'text','read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x297),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x1fb),'type':_0x3716fc(0x2cf),'role':_0x3716fc(0x2f3),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x218),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x1f8),'type':'string','role':_0x3716fc(0x337),'read':!![],'write':![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x232),{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x383),'type':_0x3716fc(0x2cf),'role':_0x3716fc(0x337),'read':!![],'write':![]},'native':{}}),await _0x457fb9['setObjectNotExistsAsync']('analysis.automation.autoApply',{'type':_0x3716fc(0x259),'common':{'name':_0x3716fc(0x2f0),'type':'boolean','role':_0x3716fc(0x2ca),'read':!![],'write':!![]},'native':{}}),await _0x457fb9[_0x3716fc(0x2df)](_0x3716fc(0x35f),{'type':'state','common':{'name':'Trigger\x20Action','type':_0x3716fc(0x306),'role':_0x3716fc(0x274),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x1cbac7){const _0x29ef5d=a0_0x5f0772;try{const _0x4d0044=await _0x1cbac7[_0x29ef5d(0x270)](SYSTEM_DP_MODE);_0x4d0044&&_0x4d0044[_0x29ef5d(0x241)]&&Object[_0x29ef5d(0x36c)](SYSTEM_MODES)[_0x29ef5d(0x21e)](_0x4d0044[_0x29ef5d(0x241)])?_0x1cbac7[_0x29ef5d(0x370)]=_0x4d0044[_0x29ef5d(0x241)]:(_0x1cbac7['currentSystemMode']=SYSTEM_MODES[_0x29ef5d(0x2a4)],await _0x1cbac7[_0x29ef5d(0x24b)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x881eff){_0x1cbac7[_0x29ef5d(0x370)]=SYSTEM_MODES[_0x29ef5d(0x2a4)];}}async function loadRawEventLog(_0x13fe25){const _0x55334a=a0_0x5f0772;try{const _0x4956c6=await _0x13fe25[_0x55334a(0x270)](LTM_DP_RAW_LOG);if(_0x4956c6&&_0x4956c6['val'])_0x13fe25[_0x55334a(0x257)]=JSON['parse'](_0x4956c6[_0x55334a(0x241)]);}catch(_0x19fb48){_0x13fe25[_0x55334a(0x257)]=[];}}async function saveRawEventLog(_0x5ba694){const _0x32fcda=a0_0x5f0772;if(_0x5ba694[_0x32fcda(0x257)][_0x32fcda(0x340)]>RAW_LOG_MAX_SIZE)_0x5ba694['rawEventLog'][_0x32fcda(0x291)](0x0,_0x5ba694[_0x32fcda(0x257)]['length']-RAW_LOG_MAX_SIZE);await _0x5ba694[_0x32fcda(0x24b)](LTM_DP_RAW_LOG,{'val':JSON[_0x32fcda(0x2b6)](_0x5ba694[_0x32fcda(0x257)]),'ack':!![]});}async function loadDailyDigests(_0x57291c){const _0x8410ee=a0_0x5f0772;try{const _0x106f6c=await _0x57291c[_0x8410ee(0x270)](LTM_DP_DAILY_DIGESTS);if(_0x106f6c&&_0x106f6c['val'])_0x57291c[_0x8410ee(0x332)]=JSON['parse'](_0x106f6c['val']);}catch(_0x5ef1ba){_0x57291c[_0x8410ee(0x332)]=[];}await updateBaselineStatus(_0x57291c);}async function saveDailyDigests(_0x520466,_0x7dac5d=!![]){const _0x2cbf97=a0_0x5f0772,_0x252ec9=_0x520466[_0x2cbf97(0x363)][_0x2cbf97(0x2a3)]||0x3c;_0x520466[_0x2cbf97(0x332)]['length']>_0x252ec9&&_0x520466[_0x2cbf97(0x332)][_0x2cbf97(0x291)](0x0,_0x520466[_0x2cbf97(0x332)][_0x2cbf97(0x340)]-_0x252ec9);await _0x520466[_0x2cbf97(0x24b)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x2cbf97(0x2b6)](_0x520466[_0x2cbf97(0x332)]),'ack':!![]});if(_0x7dac5d)await updateBaselineStatus(_0x520466);}async function updateAnalysisHistory(_0x43a219,_0x3c7651){const _0x2d04b7=a0_0x5f0772;_0x43a219[_0x2d04b7(0x31d)]['unshift'](_0x3c7651);if(_0x43a219['analysisHistory'][_0x2d04b7(0x340)]>HISTORY_MAX_SIZE)_0x43a219[_0x2d04b7(0x31d)]['pop']();await _0x43a219[_0x2d04b7(0x24b)](_0x2d04b7(0x2af),{'val':JSON[_0x2d04b7(0x2b6)](_0x43a219[_0x2d04b7(0x31d)]),'ack':!![]});}async function updateBaselineStatus(_0x2afdbe){const _0x4d11a0=a0_0x5f0772;if(!_0x2afdbe[_0x4d11a0(0x23b)]){await _0x2afdbe['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x4d11a0(0x227),'ack':!![]});return;}const _0x5ccdb5=_0x2afdbe['dailyDigests'][_0x4d11a0(0x340)]>=(_0x2afdbe[_0x4d11a0(0x363)][_0x4d11a0(0x2fa)]||0x7)?'Aktiv\x20('+_0x2afdbe[_0x4d11a0(0x332)][_0x4d11a0(0x340)]+_0x4d11a0(0x30e):_0x4d11a0(0x213)+_0x2afdbe['dailyDigests'][_0x4d11a0(0x340)]+'/'+(_0x2afdbe[_0x4d11a0(0x363)][_0x4d11a0(0x2fa)]||0x7)+')';await _0x2afdbe[_0x4d11a0(0x24b)](LTM_DP_BASELINE_STATUS,{'val':_0x5ccdb5,'ack':!![]});}async function initSensorSubscriptions(_0x26f3bc){const _0x8b3009=a0_0x5f0772,_0x3dc05e=_0x26f3bc[_0x8b3009(0x363)][_0x8b3009(0x224)];if(_0x3dc05e)for(const _0x23e0a2 of _0x3dc05e){await _0x26f3bc[_0x8b3009(0x25a)](_0x23e0a2['id']);}}function a0_0x3027(){const _0x11ffdf=['HEALTH_TRAIN_RESULT','Training\x20Error:\x20','constructor','kontakt','HEALTH_RESULT','includes','exitTimer','BUILD_TOPOLOGY','analysis.energy','city','python_service','devices','outdoorSensorId','GAIT_RESULT','Deaktiviert\x20(Pro-Feature)','Briefing\x20Error:\x20','data','scanDevices','toLocaleTimeString','Gemini\x20AI\x20initialized.','ðŸ›‹ï¸\x20BUTLER:\x20Found\x20','ANOMALY','occupancy','targetValue','analysis.health.trendDiagnosis','analysis.automation.targetValue','OK:\x20','driftDetails','2vnzRxC','systemUUID','TRAIN_ENERGY','\x0aGrund:\x20','Train\x20Security','analysis.lastResult','isProVersion','dependencyInstallInProgress','ltmStbWindowDays','1251804oltdxL','LTM.rawEventLog','debug','val','setupLtmScheduler','[PYTHON]\x20','systemConfig','response','.forecast.current.temperature','Current\x20Threshold','submitFeedback','Analysiere\x20ausgewogen.','parse','setStateAsync','sensorLastValues','analysis.isAlert','trim','PREDICT_ENERGY','isGracePeriodActive','main','details','TRAIN_HEALTH','toString','ANALYZE_GAIT','Train\x20Comfort','rawEventLog','schalter','state','subscribeForeignStatesAsync','unknown','analysis.training.triggerComfort','analysis.security.currentThreshold','Skipped\x20(No\x20AI\x20or\x20Data)','delObjectAsync','getFullYear','analysis.health.gaitSpeed','getEnums','sendTo','timestamp','useWeather','ready','analysis.triggerBriefing','[RECORDER]\x20Error:\x20','\x0aSTB:\x20','endsWith','49wXwWlF','presence','rule','11277684oVBrHR','find','getStateAsync','Insulation\x20Score','value','service.py','button','location','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','setupDriftAnalysisScheduler','Gemini\x20Error:\x20','error','.\x20KONTEXT:\x20','slice','is_anomaly','Last\x20Check','automation.triggerAction','Pattern\x20Detected','setHours','TOPOLOGY_RESULT','window','Health\x20Analysis','getForeignStateAsync','rating','map','longitude','bewegung','Anomaly\x20Detected','analysis.training.triggerTopology','analysis.training.status','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','getLtmData','ack','analysis.energy.heatingScore','splice','motion','Fokus\x20auf\x20Familienroutinen.','N/A\x20(Learning)','fenster','LTM.driftAnalysis.baselineDrift','analysis.automation.detectedPatterns','PYTHON_EXE','system','weatherunderground','checkAndInstall','shift','guest','.communicate.request','Keine\x20Details.','payload','Topology\x20Matrix','âš ï¸\x20ALARM:\x20','ltmLtbWindowDays','NORMAL','normal','getMinutes','startsWith','events.history_debug_00','genAI','Trend\x20Value','analysis.training.triggerHealth','licht','ltmJob','apiKey','analysis.analysisHistory','inactivityThresholdHours','analysis.health.lastCheck','presenceDevices','analysis.alertReason','getMonth','toLowerCase','stringify','from','analysisTimer','SECURITY_RESULT','Thermodynamics','ðŸ“\x20Feedback\x20received:\x20','latitude','writable','ANALYZE_TREND','Started...','analysis.security.topologyMatrix','lampe','ðŸ•¸ï¸\x20Topology\x20Map\x20updated.','automationProposal','Regel\x20erkannt:\x20','party','split','getGenerativeModel','Description','@google/generative-ai','switch','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','Trigger\x20Briefing','system.config','enum','string','analysis.energy.forecast','temperatur','livingContext','.NextHours.Location_1.Day_1.current.temp_value','driftAnalysisTimer','keys','ENERGY_TRAIN_RESULT','GUEST','system.presenceWho','extendObjectAsync','pop','isExit','instance','geminiModel','setState','setObjectNotExistsAsync','exitGraceTimer','summary','search','analysis.security.lastScore','name','ðŸ§ \x20Triggering\x20Security\x20Training...','Train\x20Health','getHours','lastAlertState','(((.+)+)+)+$','getTime','insulation','Â°C,\x20','scanForDevices','toISOString','N/A','Auto\x20Apply','object','date','json','confidence','Unknown','dimmer','657860yPVFTK','User\x20dismissed\x20automation\x20proposal.','path','minDaysForBaseline','success','./lib/scheduler','.\x20WETTER:\x20','System','getObjectAsync','BUTLER\x20Execution\x20Error:\x20','Energy\x20Intelligence','[RESULT]','Activity\x20Summary','LTM.processingStatus','Last\x20raw\x20event','boolean','calendarInstance','bind','activityLevel','12KDWPiL','forEach','status','analysis.trigger','\x20Tage)','now','ðŸ›‹ï¸\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.','analysis.automation.patternDetected','geminiApiKey','models/gemini-flash-latest','generic','analysis.energy.insulationScore','TRAIN_SECURITY','stateChange','common','log','callback','1145469rjaxBV','3649494kMfRZa','analysisHistory','onUnload','.forecast.current.temp','number','openweathermap','kill','application/json','loc','eventHistory','onStateChange','threshold','heating','triggerDailyDigest','analysis.training.triggerEnergy','Activity-Level','Trigger\x20Analysis','system.mode','unshift','WiFi\x20Presence\x20detected.','isPresent','Security\x20Monitor','dailyDigests','getDate','child_process','isAlert','stdout','text','ðŸ›‹ï¸\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','Build\x20Topology','ðŸ¤–\x20Autopilot:\x20Running\x20periodic\x20analysis...','licenseKey','Keine\x20Wetterdaten\x20verfÃ¼gbar.','indicator','some','193305WplJWK','length','testApiKey','Event\x20History','Failed:\x20','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','analysis.automation.autoApply','Success:\x20','LTM.driftAnalysis.lastCheck','cogni-living','PONG','weatherInstance','\x20=\x20','Missing\x20data','briefingJob','LTM.trainingData.sequences','toFixed','\x20->\x20','LTM.baselineStatus','Trend','ENERGY_PREDICT_RESULT','Heating\x20Score','LTM','events.lastEvent','Fokus\x20auf\x20Komfort.','events.history','testContext','push','analysis.training','info','.\x20EMERGENCY:\x20','tÃ¼r','analysis.automation.triggerAction','LTM.trainingData.thermodynamics','Raw\x20Log','cogni-living\x20adapter\x20starting\x20(v','config','stdin','temperature','prÃ¤senz','No\x20instance','analysis.health.isAnomaly','analysis.security.lastCheck','Kalender\x20deaktiviert.','modeResetJob','values','analysis.health.todayVector','notifyTelegramEnabled','Wetterdaten\x20deaktiviert.','currentSystemMode','LTM.driftAnalysis.driftDetails','LTM.dailyDigests','Kein\x20API\x20Key.','analysis.training.triggerSecurity','ðŸŒ…\x20Morning\x20Briefing:\x0a','Sequences','analysis.security','ðŸš€\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.10)...','type','ðŸ•¸ï¸\x20Building\x20Topology\x20Matrix...','Alert\x20Status','subscribeStates','.forecast.current.state','version','contact','Topology\x20Error:\x20','Gait\x20Speed\x20Trend','pythonProcess','Target\x20Value','analysis.automation.description','3253864GAChSg','text.alarm','daswetter','round','fill','Unbekannt','Target\x20ID','command','channel','Detected\x20Patterns','triggerBriefing','@iobroker/adapter-core','setupBriefingScheduler','description','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','analysis.history_debug_00','dismissAutomation','onMessage','targetId','getForeignObjectAsync','253opRAXW','ANALYZE_HEALTH','Sec-Training\x20started...','simulateButler','cancel','message','System\x20Mode',')\x20-\x20SAFE\x20BOOT','isEmergency','VACATION','communicate.request','alertReason','vacation','Lernphase\x20(','write','generateContent','onReady','substring','analysis.automation.targetId'];a0_0x3027=function(){return _0x11ffdf;};return a0_0x3027();}async function initPresenceSubscriptions(_0x4dbe6f){const _0x3d852e=a0_0x5f0772,_0x1e8f04=_0x4dbe6f[_0x3d852e(0x363)][_0x3d852e(0x2b2)];if(_0x1e8f04)for(const _0x2689a3 of _0x1e8f04){await _0x4dbe6f[_0x3d852e(0x25a)](_0x2689a3);}}async function setupTelegramListener(_0x108d28){const _0x4b548c=a0_0x5f0772,_0x553884=_0x108d28[_0x4b548c(0x363)]['notifyTelegramInstance'];if(_0x108d28['config'][_0x4b548c(0x36e)]&&_0x553884)await _0x108d28['subscribeForeignStatesAsync'](_0x553884+_0x4b548c(0x29e));}async function checkWifiPresence(_0x49effa){const _0x3312e3=a0_0x5f0772;try{const _0xdad30e=_0x49effa[_0x3312e3(0x363)][_0x3312e3(0x2b2)]||[];let _0x4f8450=![];const _0x24f3b1=[];for(const _0x30601d of _0xdad30e){try{const _0xfaaba2=await _0x49effa[_0x3312e3(0x285)](_0x30601d);_0xfaaba2&&(_0xfaaba2['val']===!![]||_0xfaaba2['val']==='online'||_0xfaaba2[_0x3312e3(0x241)]===0x1)&&(_0x4f8450=!![],_0x24f3b1[_0x3312e3(0x35a)](_0x30601d));}catch(_0x136dc4){}}return await _0x49effa[_0x3312e3(0x24b)](_0x3312e3(0x2d8),{'val':_0x24f3b1['join'](',\x20'),'ack':!![]}),_0x4f8450&&(_0x49effa[_0x3312e3(0x21f)]&&(_0x49effa[_0x3312e3(0x319)][_0x3312e3(0x35c)](_0x3312e3(0x32f)),abortExitTimer(_0x49effa)),!_0x49effa[_0x3312e3(0x330)]&&_0x49effa[_0x3312e3(0x370)]===SYSTEM_MODES[_0x3312e3(0x2a4)]&&await setPresence(_0x49effa,!![])),_0x4f8450;}catch(_0x43b3d3){return![];}}function startExitTimer(_0x486765){const _0x1fdf0e=a0_0x5f0772;abortExitTimer(_0x486765),_0x486765[_0x1fdf0e(0x250)]=!![],_0x486765[_0x1fdf0e(0x2e0)]=setTimeout(()=>{const _0x26b7d2=_0x1fdf0e;_0x486765[_0x26b7d2(0x250)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x486765['exitTimer']=setTimeout(()=>{const _0x1814a1=_0x1fdf0e;setPresence(_0x486765,![]),_0x486765[_0x1814a1(0x21f)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x4177aa){const _0x4c5997=a0_0x5f0772;if(_0x4177aa['exitTimer'])clearTimeout(_0x4177aa[_0x4c5997(0x21f)]);if(_0x4177aa[_0x4c5997(0x2e0)])clearTimeout(_0x4177aa[_0x4c5997(0x2e0)]);_0x4177aa[_0x4c5997(0x21f)]=null,_0x4177aa[_0x4c5997(0x2e0)]=null,_0x4177aa[_0x4c5997(0x250)]=![];}async function setPresence(_0x5e1aaa,_0xf2021c){const _0x2da67b=a0_0x5f0772;if(_0x5e1aaa[_0x2da67b(0x330)]===_0xf2021c)return;_0x5e1aaa[_0x2da67b(0x330)]=_0xf2021c,await _0x5e1aaa[_0x2da67b(0x24b)]('system.isPresent',{'val':_0xf2021c,'ack':!![]});}async function executeAutomationAction(_0x3b77fa){const _0x22a68f=a0_0x5f0772;try{const _0x1a60ad=await _0x3b77fa[_0x22a68f(0x270)](_0x22a68f(0x218)),_0x51a4ba=await _0x3b77fa[_0x22a68f(0x270)]('analysis.automation.targetValue');if(_0x1a60ad&&_0x1a60ad[_0x22a68f(0x241)]&&_0x51a4ba){const _0x2d5e09=_0x1a60ad[_0x22a68f(0x241)];let _0x458577=_0x51a4ba['val'];try{_0x458577=JSON[_0x22a68f(0x24a)](_0x458577);}catch(_0x1bf4aa){}_0x3b77fa[_0x22a68f(0x319)][_0x22a68f(0x35c)](_0x22a68f(0x2cb)+_0x2d5e09+_0x22a68f(0x34b)+_0x458577),await _0x3b77fa['setForeignStateAsync'](_0x2d5e09,_0x458577);}else _0x3b77fa['log']['warn']('ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x124dda){_0x3b77fa[_0x22a68f(0x319)][_0x22a68f(0x27a)](_0x22a68f(0x300)+_0x124dda[_0x22a68f(0x20b)]);}}async function processSensorEvent(_0x56718d,_0x585f0c,_0x464d8a,_0x50b727){const _0x4a2a3e=a0_0x5f0772;if(!_0x50b727)return;const _0x1fb395=_0x464d8a[_0x4a2a3e(0x241)],_0x1bb72e=Date['now'](),_0x59a879=_0x56718d[_0x4a2a3e(0x24c)][_0x585f0c];_0x56718d[_0x4a2a3e(0x24c)][_0x585f0c]=_0x1fb395;if(!_0x50b727['logDuplicates']&&_0x59a879!=undefined&&_0x59a879==_0x1fb395)return;const _0x13e9f0=(_0x50b727[_0x4a2a3e(0x379)]||'')[_0x4a2a3e(0x2b5)](),_0x45666f=_0x13e9f0[_0x4a2a3e(0x21e)](_0x4a2a3e(0x365))||_0x13e9f0[_0x4a2a3e(0x21e)](_0x4a2a3e(0x2d1))||_0x13e9f0[_0x4a2a3e(0x21e)]('klima')||_0x13e9f0[_0x4a2a3e(0x21e)]('heizung');_0x56718d[_0x4a2a3e(0x23b)]&&_0x45666f&&recordThermodynamics(_0x56718d,_0x585f0c,_0x1fb395,_0x50b727[_0x4a2a3e(0x275)]);const _0x507856={'timestamp':_0x1bb72e,'id':_0x585f0c,'name':_0x50b727['name'],'type':_0x50b727[_0x4a2a3e(0x379)],'location':_0x50b727['location'],'value':_0x1fb395};_0x56718d[_0x4a2a3e(0x325)][_0x4a2a3e(0x32e)](_0x507856);if(_0x56718d[_0x4a2a3e(0x325)]['length']>HISTORY_MAX_SIZE)_0x56718d['eventHistory'][_0x4a2a3e(0x2da)]();await _0x56718d[_0x4a2a3e(0x24b)](_0x4a2a3e(0x356),{'val':JSON[_0x4a2a3e(0x2b6)](_0x507856),'ack':!![]}),await _0x56718d['setStateAsync'](_0x4a2a3e(0x358),{'val':JSON[_0x4a2a3e(0x2b6)](_0x56718d[_0x4a2a3e(0x325)]),'ack':!![]});_0x56718d[_0x4a2a3e(0x23b)]&&(_0x56718d[_0x4a2a3e(0x257)]['push'](_0x507856),await saveRawEventLog(_0x56718d),recordSequence(_0x56718d,_0x507856));if(_0x50b727[_0x4a2a3e(0x2db)]&&_0x1fb395===!![]){if(_0x56718d['isPresent']&&!_0x56718d[_0x4a2a3e(0x250)])startExitTimer(_0x56718d);else{if(!_0x56718d[_0x4a2a3e(0x330)])setPresence(_0x56718d,!![]);}}else{if(_0x50b727[_0x4a2a3e(0x379)]==='motion'&&_0x1fb395===!![]){if(_0x56718d[_0x4a2a3e(0x21f)])abortExitTimer(_0x56718d);if(!_0x56718d[_0x4a2a3e(0x330)]&&_0x56718d[_0x4a2a3e(0x370)]===SYSTEM_MODES['NORMAL'])setPresence(_0x56718d,!![]);}}}async function recordThermodynamics(_0x51c56b,_0x4567be,_0x24fa0b,_0x5e0cf6){const _0x19d846=a0_0x5f0772,_0x4a44f6=await getOutsideTemperatureNumeric(_0x51c56b),_0x1b7dd2=await _0x51c56b[_0x19d846(0x270)](_0x19d846(0x360));let _0x1588d1=[];if(_0x1b7dd2&&_0x1b7dd2[_0x19d846(0x241)])try{_0x1588d1=JSON[_0x19d846(0x24a)](_0x1b7dd2['val']);}catch(_0x1ae64d){}_0x1588d1['push']({'ts':Date[_0x19d846(0x30f)](),'room':_0x5e0cf6||_0x19d846(0x2f5),'t_in':_0x24fa0b,'t_out':_0x4a44f6});if(_0x1588d1['length']>THERMO_LOG_SIZE)_0x1588d1[_0x19d846(0x29c)]();await _0x51c56b[_0x19d846(0x24b)](_0x19d846(0x360),{'val':JSON[_0x19d846(0x2b6)](_0x1588d1),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x4232cf){const _0x51b462=a0_0x5f0772;if(_0x4232cf[_0x51b462(0x363)][_0x51b462(0x225)])try{const _0x34e025=await _0x4232cf['getForeignStateAsync'](_0x4232cf['config'][_0x51b462(0x225)]);if(_0x34e025&&_0x34e025[_0x51b462(0x241)]!==undefined&&_0x34e025[_0x51b462(0x241)]!==null)return parseFloat(_0x34e025['val']);}catch(_0x5036f5){}const _0x566999=_0x4232cf[_0x51b462(0x363)]['weatherInstance'];if(!_0x4232cf[_0x51b462(0x363)][_0x51b462(0x265)]||!_0x566999)return null;try{let _0x126c68='';if(_0x566999[_0x51b462(0x21e)]('accuweather'))_0x126c68=_0x566999+'.Current.Temperature';else{if(_0x566999[_0x51b462(0x21e)](_0x51b462(0x1f4)))_0x126c68=_0x566999+_0x51b462(0x2d3);else{if(_0x566999[_0x51b462(0x21e)](_0x51b462(0x321)))_0x126c68=_0x566999+_0x51b462(0x246);else{if(_0x566999['includes'](_0x51b462(0x29a)))_0x126c68=_0x566999+_0x51b462(0x31f);}}}if(_0x126c68){const _0x371424=await _0x4232cf[_0x51b462(0x285)](_0x126c68);if(_0x371424&&_0x371424[_0x51b462(0x241)]!==undefined&&_0x371424[_0x51b462(0x241)]!==null)return parseFloat(_0x371424[_0x51b462(0x241)]);}}catch(_0x189b2){}return null;}async function recordSequence(_0x59fde4,_0x2b530b){const _0x303393=a0_0x5f0772,_0x300610=(_0x2b530b[_0x303393(0x379)]||'')[_0x303393(0x2b5)](),_0x8c471f=[_0x303393(0x292),_0x303393(0x289),_0x303393(0x366),_0x303393(0x26c),_0x303393(0x22f),'door',_0x303393(0x35e),_0x303393(0x283),_0x303393(0x295),_0x303393(0x37f),_0x303393(0x21c),'light',_0x303393(0x2ac),_0x303393(0x2ca),_0x303393(0x258),_0x303393(0x2f6),_0x303393(0x2c1)];if(!_0x8c471f[_0x303393(0x33e)](_0xd83760=>_0x300610[_0x303393(0x21e)](_0xd83760)))return;if(!_0x2b530b[_0x303393(0x272)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x303393(0x35a)]({'loc':_0x2b530b[_0x303393(0x275)]||_0x303393(0x2f5),'id':_0x2b530b['id'],'ts':Date[_0x303393(0x30f)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x59fde4);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x40eae1){const _0x257602=a0_0x5f0772;try{const _0x1d5e0e=await _0x40eae1[_0x257602(0x270)](_0x257602(0x34e));let _0x44aa9d=[];if(_0x1d5e0e&&_0x1d5e0e[_0x257602(0x241)])try{_0x44aa9d=JSON['parse'](_0x1d5e0e[_0x257602(0x241)]);}catch(_0x555186){}const _0x31218f=activeSequence[0x0]['ts'],_0x489bd3=activeSequence[_0x257602(0x287)](_0x37fd6e=>({'loc':_0x37fd6e[_0x257602(0x324)],'t_delta':Math[_0x257602(0x1f5)]((_0x37fd6e['ts']-_0x31218f)/0x3e8)})),_0xde38dc={'timestamp':new Date(_0x31218f)[_0x257602(0x2ee)](),'steps':_0x489bd3,'duration':Math['round']((activeSequence[activeSequence[_0x257602(0x340)]-0x1]['ts']-_0x31218f)/0x3e8),'daytime':new Date(_0x31218f)[_0x257602(0x2e7)]()};_0x44aa9d[_0x257602(0x35a)](_0xde38dc);if(_0x44aa9d[_0x257602(0x340)]>MAX_TRAINING_SET_SIZE)_0x44aa9d['shift']();await _0x40eae1[_0x257602(0x24b)](_0x257602(0x34e),{'val':JSON[_0x257602(0x2b6)](_0x44aa9d),'ack':!![]}),runSecurityCheck(_0x40eae1,_0xde38dc);}catch(_0x53863b){_0x40eae1[_0x257602(0x319)][_0x257602(0x27a)](_0x257602(0x268)+_0x53863b[_0x257602(0x20b)]);}}function runSecurityCheck(_0x5323c1,_0x55766a){const _0x34f731=a0_0x5f0772;if(!_0x5323c1[_0x34f731(0x23b)])return;sendToPython(_0x5323c1,'ANALYZE_SEQUENCE',{'sequence':_0x55766a});}async function createDailyDigest(_0x5d5596){const _0x225306=a0_0x5f0772;if(!_0x5d5596[_0x225306(0x23b)])return;await _0x5d5596[_0x225306(0x24b)](LTM_DP_STATUS,{'val':_0x225306(0x2bf),'ack':!![]});if(!_0x5d5596[_0x225306(0x2dd)]||_0x5d5596['rawEventLog'][_0x225306(0x340)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x5d5596[_0x225306(0x24b)](LTM_DP_STATUS,{'val':_0x225306(0x25e),'ack':!![]});return;}const _0x422a11=JSON[_0x225306(0x24a)](JSON['stringify'](_0x5d5596[_0x225306(0x257)])),_0x5954d9=_0x422a11[_0x225306(0x340)],_0xd3479a=_0x225306(0x200)+JSON['stringify'](_0x422a11);try{const _0x34b97e=await _0x5d5596[_0x225306(0x2dd)][_0x225306(0x215)](_0xd3479a),_0x5960db=JSON[_0x225306(0x24a)](_0x34b97e[_0x225306(0x245)][_0x225306(0x337)]()['replace'](/```json|```/g,'')[_0x225306(0x24e)]()),_0x41b598={'timestamp':new Date()['toISOString'](),'eventCount':_0x5954d9,'summary':_0x5960db['summary']||'Digest','activityLevel':_0x5960db[_0x225306(0x309)]||'normal','systemMode':_0x5d5596['currentSystemMode']};_0x5d5596[_0x225306(0x332)][_0x225306(0x35a)](_0x41b598),await saveDailyDigests(_0x5d5596),_0x5d5596['rawEventLog']=[],await saveRawEventLog(_0x5d5596),await _0x5d5596[_0x225306(0x24b)](LTM_DP_STATUS,{'val':'Success','ack':!![]});if(_0x5d5596['isProVersion'])sendToPython(_0x5d5596,_0x225306(0x207),{'digest':_0x41b598});}catch(_0x330a53){_0x5d5596[_0x225306(0x319)][_0x225306(0x27a)](_0x330a53[_0x225306(0x20b)]);}}async function runBaselineDriftAnalysis(_0x2d76aa){const _0x4bc468=a0_0x5f0772;if(!_0x2d76aa[_0x4bc468(0x23b)]||!_0x2d76aa['geminiModel'])return;const _0x4455a7=_0x2d76aa[_0x4bc468(0x363)][_0x4bc468(0x23d)]||0xe;if(_0x2d76aa['dailyDigests'][_0x4bc468(0x340)]<_0x4455a7+0x7){await _0x2d76aa[_0x4bc468(0x24b)](LTM_DP_DRIFT_STATUS,{'val':_0x4bc468(0x294),'ack':!![]});return;}const _0x4c86bd=_0x2d76aa[_0x4bc468(0x332)]['slice'](-_0x4455a7),_0x2b46dc=_0x2d76aa[_0x4bc468(0x332)][_0x4bc468(0x27c)](0x0,_0x2d76aa[_0x4bc468(0x332)]['length']-_0x4455a7),_0x126c08='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x4bc468(0x2b6)](_0x2b46dc)+_0x4bc468(0x269)+JSON[_0x4bc468(0x2b6)](_0x4c86bd);try{const _0x3026e6=await _0x2d76aa[_0x4bc468(0x2dd)][_0x4bc468(0x215)](_0x126c08),_0x46be19=JSON[_0x4bc468(0x24a)](_0x3026e6[_0x4bc468(0x245)][_0x4bc468(0x337)]()['replace'](/```json|```/g,'')[_0x4bc468(0x24e)]());_0x46be19['baselineDrift']&&(await _0x2d76aa[_0x4bc468(0x24b)](LTM_DP_DRIFT_STATUS,{'val':_0x46be19['baselineDrift'],'ack':!![]}),await _0x2d76aa[_0x4bc468(0x24b)](LTM_DP_DRIFT_DETAILS,{'val':_0x46be19[_0x4bc468(0x234)],'ack':!![]}),await _0x2d76aa[_0x4bc468(0x24b)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4bc468(0x30f)](),'ack':!![]}));}catch(_0x5358e1){}}async function sendMorningBriefing(_0x907618){const _0xb7061c=a0_0x5f0772;if(!_0x907618['geminiModel'])return;try{const _0x262426='Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.',_0x5eb4ed=await _0x907618[_0xb7061c(0x2dd)][_0xb7061c(0x215)](_0x262426),_0x5d028b=_0x5eb4ed[_0xb7061c(0x245)][_0xb7061c(0x337)]();sendNotification(_0x907618,_0xb7061c(0x375)+_0x5d028b);}catch(_0x807f0d){_0x907618[_0xb7061c(0x319)]['error'](_0xb7061c(0x228)+_0x807f0d['message']);}}function stopPythonService(_0x57ee5d){const _0x862ad=a0_0x5f0772;if(_0x57ee5d[_0x862ad(0x382)]){try{_0x57ee5d['pythonProcess'][_0x862ad(0x322)]();}catch(_0x3b5bf7){}_0x57ee5d[_0x862ad(0x382)]=null;}}function sendToPython(_0x3f71fd,_0x3f7cf7,_0x16efe5={}){const _0x48e008=a0_0x5f0772;if(!_0x3f71fd[_0x48e008(0x382)]||!_0x3f71fd['pythonProcess'][_0x48e008(0x364)][_0x48e008(0x2bd)])return;const _0x409de0=JSON[_0x48e008(0x2b6)]({'command':_0x3f7cf7,..._0x16efe5});try{_0x3f71fd['pythonProcess'][_0x48e008(0x364)][_0x48e008(0x214)](_0x409de0+'\x0a');}catch(_0x5ce8a0){}}function runPythonHealthCheck(_0x16edb1){const _0x236a64=a0_0x5f0772;if(!_0x16edb1[_0x236a64(0x332)]||_0x16edb1[_0x236a64(0x332)][_0x236a64(0x340)]<0x2)return;const _0x1f611a=_0x16edb1[_0x236a64(0x332)][_0x236a64(0x287)](_0x5dc584=>{const _0x20dc43=_0x236a64,_0xf33226=(_0x5dc584['activityLevel']||'')[_0x20dc43(0x2b5)]();return ACTIVITY_LEVEL_MAP[_0xf33226]||0x32;});sendToPython(_0x16edb1,_0x236a64(0x2be),{'values':_0x1f611a,'tag':_0x236a64(0x32b)});}function handlePythonResult(_0xc17ad9,_0x4daf2a){const _0x490be5=a0_0x5f0772;if(_0x4daf2a[_0x490be5(0x379)]===_0x490be5(0x349))_0xc17ad9[_0x490be5(0x319)]['debug']('ðŸ\x20Python\x20Pong');else{if(_0x4daf2a[_0x490be5(0x379)]===_0x490be5(0x2b9)){const {anomaly_score:_0x407530,is_anomaly:_0x59ed5f,threshold:_0xc04c4b,explanation:_0x484400}=_0x4daf2a[_0x490be5(0x2a0)];_0xc17ad9[_0x490be5(0x319)][_0x490be5(0x35c)](_0x490be5(0x28d)+_0x407530[_0x490be5(0x34f)](0x5)+_0x490be5(0x350)+(_0x59ed5f?_0x490be5(0x22e):'OK')),_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x2e3),{'val':_0x407530,'ack':!![]}),_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x369),{'val':new Date()[_0x490be5(0x2ee)](),'ack':!![]});if(_0xc04c4b)_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x25d),{'val':_0xc04c4b,'ack':!![]});if(_0x59ed5f){let _0x1acbd7=_0x490be5(0x276)+_0x407530[_0x490be5(0x34f)](0x4)+')';if(_0x484400&&_0x484400!=='Unknown')_0x1acbd7+=_0x490be5(0x238)+_0x484400;_0xc17ad9['setStateAsync'](_0x490be5(0x24d),{'val':!![],'ack':!![]}),_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x2b3),{'val':_0x1acbd7,'ack':!![]}),sendNotification(_0xc17ad9,'âš ï¸\x20SECURITY\x20ALARM:\x20'+_0x1acbd7,![],!![]);}}else{if(_0x4daf2a[_0x490be5(0x379)]==='TRAINING_COMPLETE'){const _0xf92ac4=_0x4daf2a[_0x490be5(0x2a0)][_0x490be5(0x252)]||'',_0x141c44=_0x4daf2a[_0x490be5(0x2a0)][_0x490be5(0x327)],_0x5e5520=_0x4daf2a[_0x490be5(0x2a0)][_0x490be5(0x2fb)]?_0x490be5(0x346)+new Date()[_0x490be5(0x22b)]()+'\x20('+_0xf92ac4+')':_0x490be5(0x343)+_0x4daf2a[_0x490be5(0x2a0)]['reason'];_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x28c),{'val':_0x5e5520,'ack':!![]});if(_0x4daf2a[_0x490be5(0x2a0)]['success']&&_0x141c44)_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x25d),{'val':_0x141c44,'ack':!![]});}else{if(_0x4daf2a['type']==='COMFORT_RESULT'){const {patterns:_0x52a462}=_0x4daf2a[_0x490be5(0x2a0)];if(_0x52a462&&_0x52a462[_0x490be5(0x340)]>0x0){_0xc17ad9[_0x490be5(0x319)][_0x490be5(0x35c)](_0x490be5(0x22d)+_0x52a462[_0x490be5(0x340)]+'\x20new\x20patterns.'),_0xc17ad9[_0x490be5(0x24b)]('analysis.automation.detectedPatterns',{'val':JSON['stringify'](_0x52a462),'ack':!![]});const _0x8142d5=_0x52a462[0x0],_0x5194ad=_0x490be5(0x2c4)+_0x8142d5[_0x490be5(0x26d)]+'\x20('+(_0x8142d5[_0x490be5(0x2f4)]*0x64)[_0x490be5(0x34f)](0x0)+'%)';_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x311),{'val':!![],'ack':!![]}),_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x384),{'val':_0x5194ad,'ack':!![]});}else _0xc17ad9[_0x490be5(0x319)][_0x490be5(0x35c)](_0x490be5(0x310)),_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x311),{'val':![],'ack':!![]}),_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x297),{'val':'[]','ack':!![]});}else{if(_0x4daf2a[_0x490be5(0x379)]===_0x490be5(0x2d6)){if(_0x4daf2a['payload'][_0x490be5(0x2fb)])try{const _0x45bc69=JSON[_0x490be5(0x24a)](_0x4daf2a[_0x490be5(0x2a0)][_0x490be5(0x252)]);if(_0x45bc69[_0x490be5(0x2eb)])_0xc17ad9[_0x490be5(0x24b)]('analysis.energy.insulationScore',{'val':JSON['stringify'](_0x45bc69[_0x490be5(0x2eb)]),'ack':!![]});if(_0x45bc69[_0x490be5(0x328)])_0xc17ad9['setStateAsync'](_0x490be5(0x290),{'val':JSON[_0x490be5(0x2b6)](_0x45bc69[_0x490be5(0x328)]),'ack':!![]});}catch(_0x21cf90){}}else{if(_0x4daf2a['type']===_0x490be5(0x219)){if(_0x4daf2a[_0x490be5(0x2a0)][_0x490be5(0x2fb)])_0xc17ad9[_0x490be5(0x319)][_0x490be5(0x35c)]('âœ…\x20HEALTH\x20TRAINED.');}else{if(_0x4daf2a['type']===_0x490be5(0x21d))_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x2b1),{'val':new Date()[_0x490be5(0x2ee)](),'ack':!![]}),_0xc17ad9[_0x490be5(0x24b)]('analysis.health.isAnomaly',{'val':_0x4daf2a[_0x490be5(0x2a0)][_0x490be5(0x27d)],'ack':!![]});else{if(_0x4daf2a['type']==='TREND_RESULT')_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x231),{'val':_0x4daf2a[_0x490be5(0x2a0)]['diagnosis'],'ack':!![]}),_0xc17ad9['setStateAsync']('analysis.health.trendValue',{'val':_0x4daf2a[_0x490be5(0x2a0)]['change_percent'],'ack':!![]});else{if(_0x4daf2a[_0x490be5(0x379)]===_0x490be5(0x226)){const {speed_trend:_0x4f2531}=_0x4daf2a['payload'];if(_0x4f2531!==undefined)_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x261),{'val':_0x4f2531,'ack':!![]});}else{if(_0x4daf2a[_0x490be5(0x379)]===_0x490be5(0x353)){const {forecast:_0x4d8982}=_0x4daf2a[_0x490be5(0x2a0)];if(_0x4d8982)_0xc17ad9[_0x490be5(0x24b)](_0x490be5(0x2d0),{'val':JSON[_0x490be5(0x2b6)](_0x4d8982),'ack':!![]});}else{if(_0x4daf2a[_0x490be5(0x379)]===_0x490be5(0x282)){const {data:_0x186208}=_0x4daf2a[_0x490be5(0x2a0)];_0x186208&&(_0xc17ad9[_0x490be5(0x319)][_0x490be5(0x35c)](_0x490be5(0x2c2)),_0xc17ad9['setStateAsync'](_0x490be5(0x2c0),{'val':JSON[_0x490be5(0x2b6)](_0x186208),'ack':!![]}));}}}}}}}}}}}}function startPythonService(_0x234f81){const _0xf99d0b=a0_0x5f0772;let _0x3349e2='python3';if(fs['existsSync'](installer[_0xf99d0b(0x298)]))_0x3349e2=installer[_0xf99d0b(0x298)];try{const _0x2b0d6a=path['join'](__dirname,_0xf99d0b(0x223),_0xf99d0b(0x273));_0x234f81[_0xf99d0b(0x382)]=spawn(_0x3349e2,[_0x2b0d6a]),_0x234f81[_0xf99d0b(0x382)][_0xf99d0b(0x336)]['on'](_0xf99d0b(0x229),_0x136a5e=>{const _0x2bd225=_0xf99d0b,_0x1437f4=_0x136a5e[_0x2bd225(0x254)]()[_0x2bd225(0x2c6)]('\x0a');_0x1437f4[_0x2bd225(0x30b)](_0x36df55=>{const _0x17edb9=_0x2bd225,_0x44461c=_0x36df55[_0x17edb9(0x24e)]();if(!_0x44461c)return;if(_0x44461c[_0x17edb9(0x2a7)]('[LOG]'))_0x234f81[_0x17edb9(0x319)]['debug'](_0x17edb9(0x243)+_0x44461c[_0x17edb9(0x217)](0x5)[_0x17edb9(0x24e)]());else{if(_0x44461c['startsWith'](_0x17edb9(0x302)))try{const _0x168430=JSON['parse'](_0x44461c[_0x17edb9(0x217)](0x8)['trim']());handlePythonResult(_0x234f81,_0x168430);}catch(_0x577709){}}});}),_0x234f81[_0xf99d0b(0x382)]['on']('close',_0x12c21b=>{const _0x17e946=_0xf99d0b;_0x234f81[_0x17e946(0x382)]=null;});}catch(_0x15816b){_0x234f81['log'][_0xf99d0b(0x27a)]('Error\x20launching\x20Python:\x20'+_0x15816b[_0xf99d0b(0x20b)]);}}async function runAutopilot(_0x174b69){const _0x34a703=a0_0x5f0772;_0x174b69[_0x34a703(0x319)][_0x34a703(0x240)](_0x34a703(0x33a)),await runGeminiAnalysis(_0x174b69),updateHealthVector(_0x174b69),triggerGaitAnalysis(_0x174b69),triggerEnergyPrediction(_0x174b69);}async function triggerGaitAnalysis(_0xecf6e2){const _0x520000=a0_0x5f0772;if(!_0xecf6e2[_0x520000(0x23b)])return;try{const _0x13666a=await _0xecf6e2[_0x520000(0x270)](_0x520000(0x34e));_0x13666a&&_0x13666a[_0x520000(0x241)]&&sendToPython(_0xecf6e2,_0x520000(0x255),{'sequences':JSON[_0x520000(0x24a)](_0x13666a['val'])});}catch(_0x104dda){}}async function triggerEnergyPrediction(_0x5766fb){const _0x135c4d=a0_0x5f0772;if(!_0x5766fb[_0x135c4d(0x23b)])return;try{const _0xabc35a=await getOutsideTemperatureNumeric(_0x5766fb);if(_0xabc35a===null)return;const _0x1e0ddb={},_0x5eabfd=_0x5766fb[_0x135c4d(0x363)][_0x135c4d(0x224)]||[];for(const _0x87ccc7 of _0x5eabfd){if(_0x87ccc7['type']==='temperature'&&_0x87ccc7[_0x135c4d(0x275)]){const _0x37ed66=_0x5766fb[_0x135c4d(0x24c)][_0x87ccc7['id']];if(_0x37ed66!==undefined)_0x1e0ddb[_0x87ccc7[_0x135c4d(0x275)]]=_0x37ed66;}}Object[_0x135c4d(0x2d5)](_0x1e0ddb)[_0x135c4d(0x340)]>0x0&&sendToPython(_0x5766fb,_0x135c4d(0x24f),{'current_temps':_0x1e0ddb,'t_out':_0xabc35a});}catch(_0x498cfd){}}function updateHealthVector(_0x3aed30){const _0x1eeb8e=a0_0x5f0772;if(!_0x3aed30[_0x1eeb8e(0x257)]||_0x3aed30['rawEventLog'][_0x1eeb8e(0x340)]===0x0)return;const _0x8621e0=new Array(0x60)[_0x1eeb8e(0x1f6)](0x0),_0x340e9c=new Date()[_0x1eeb8e(0x281)](0x0,0x0,0x0,0x0);_0x3aed30['rawEventLog'][_0x1eeb8e(0x30b)](_0x5168d3=>{const _0x3163c3=_0x1eeb8e,_0x20c672=new Date(_0x5168d3[_0x3163c3(0x264)]);if(_0x20c672[_0x3163c3(0x2ea)]()>=_0x340e9c){const _0x3b17b=_0x20c672['getHours'](),_0x510561=_0x20c672[_0x3163c3(0x2a6)](),_0x87e484=_0x3b17b*0x4+Math['floor'](_0x510561/0xf);if(_0x87e484>=0x0&&_0x87e484<0x60)_0x8621e0[_0x87e484]++;}}),_0x3aed30[_0x1eeb8e(0x24b)](_0x1eeb8e(0x36d),{'val':JSON[_0x1eeb8e(0x2b6)](_0x8621e0),'ack':!![]});}async function getWeatherContext(_0x546f40){const _0x4fcfb0=a0_0x5f0772;if(!_0x546f40[_0x4fcfb0(0x363)]['useWeather']||!_0x546f40['config'][_0x4fcfb0(0x34a)])return _0x4fcfb0(0x36f);try{const _0x364bc6=_0x546f40[_0x4fcfb0(0x363)][_0x4fcfb0(0x34a)];let _0x3a48d2=await _0x546f40[_0x4fcfb0(0x285)](_0x364bc6+'.Current.Temperature');if(!_0x3a48d2)_0x3a48d2=await _0x546f40[_0x4fcfb0(0x285)](_0x364bc6+'.forecast.current.temperature');let _0x32992c=await _0x546f40[_0x4fcfb0(0x285)](_0x364bc6+'.Current.WeatherText');if(!_0x32992c)_0x32992c=await _0x546f40[_0x4fcfb0(0x285)](_0x364bc6+_0x4fcfb0(0x37d));if(_0x3a48d2&&_0x32992c)return _0x3a48d2['val']+_0x4fcfb0(0x2ec)+_0x32992c['val'];}catch(_0xc9b3f2){}return _0x4fcfb0(0x33c);}async function getCalendarContext(_0x3c6778){const _0x498652=a0_0x5f0772;if(!_0x3c6778[_0x498652(0x363)]['useCalendar']||!_0x3c6778[_0x498652(0x363)][_0x498652(0x307)])return _0x498652(0x36a);return'Keine\x20Termine.';}async function getCalendarNames(_0x2edd46,_0x320443){return[];}async function saveFeedback(_0x351b5c,_0x1f0416){const _0x268d28=a0_0x5f0772;_0x351b5c['log']['info'](_0x268d28(0x2bb)+_0x1f0416[_0x268d28(0x286)]);}async function runGeminiAnalysis(_0x5835f1,_0x470d06=''){const _0x18081c=a0_0x5f0772;if(!_0x5835f1[_0x18081c(0x2dd)])return;if(_0x5835f1['eventHistory'][_0x18081c(0x340)]===0x0)return;const _0x33e839=_0x5835f1['eventHistory']['slice'](0x0,0xf),_0x20f2e8=await getWeatherContext(_0x5835f1),_0x521a60=_0x5835f1[_0x18081c(0x370)],_0x167bb0=PERSONA_MAPPING[_0x5835f1['config']['aiPersona']||_0x18081c(0x314)],_0x598c79=_0x5835f1['config'][_0x18081c(0x2d2)]||_0x18081c(0x29f);let _0x51d6f7=_0x18081c(0x1f7);try{const _0x3211cd=await _0x5835f1['getStateAsync'](_0x18081c(0x2d8));if(_0x3211cd&&_0x3211cd[_0x18081c(0x241)])_0x51d6f7=_0x3211cd[_0x18081c(0x241)];}catch(_0x803886){}let _0x554c14=![];try{const _0xcad30a=await _0x5835f1[_0x18081c(0x270)](_0x18081c(0x345));if(_0xcad30a&&_0xcad30a['val'])_0x554c14=!![];}catch(_0x5b5283){}const _0x3b3f7c=_0x18081c(0x277)+_0x167bb0+_0x18081c(0x27b)+_0x598c79+'.\x20SYSTEM_MODE:\x20'+_0x521a60+_0x18081c(0x2fd)+_0x20f2e8+'.\x20ANWESEND:\x20'+_0x51d6f7+'.\x20EVENTS:\x20'+JSON['stringify'](_0x33e839)+_0x18081c(0x35d)+_0x470d06+'.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}';try{const _0x3b88d8=await _0x5835f1[_0x18081c(0x2dd)][_0x18081c(0x215)](_0x3b3f7c),_0x224f04=JSON[_0x18081c(0x24a)](_0x3b88d8[_0x18081c(0x245)][_0x18081c(0x337)]()['replace'](/```json|```/g,'')['trim']());await _0x5835f1[_0x18081c(0x24b)](_0x18081c(0x23a),{'val':JSON['stringify'](_0x224f04),'ack':!![]});if(_0x224f04['summary'])await _0x5835f1['setStateAsync']('analysis.activitySummary',{'val':_0x224f04[_0x18081c(0x2e1)],'ack':!![]});const _0x527b3e={'timestamp':Date[_0x18081c(0x30f)](),'id':Date['now']()[_0x18081c(0x254)](),'analysis':{'activity':{'summary':_0x224f04[_0x18081c(0x2e1)],'isAlert':_0x224f04['isAlert'],'alertReason':_0x224f04[_0x18081c(0x211)]},'comfort':{'automationProposal':_0x224f04[_0x18081c(0x2c3)]}}};await updateAnalysisHistory(_0x5835f1,_0x527b3e);const _0x48dfd5=_0x224f04[_0x18081c(0x335)]||![];_0x48dfd5!==_0x5835f1[_0x18081c(0x2e8)]&&(await _0x5835f1[_0x18081c(0x24b)](_0x18081c(0x24d),{'val':_0x48dfd5,'ack':!![]}),_0x5835f1[_0x18081c(0x2e8)]=_0x48dfd5,_0x48dfd5&&(await _0x5835f1[_0x18081c(0x24b)](_0x18081c(0x2b3),{'val':_0x224f04[_0x18081c(0x211)],'ack':!![]}),sendNotification(_0x5835f1,_0x18081c(0x2a2)+_0x224f04[_0x18081c(0x211)],![],_0x224f04[_0x18081c(0x20e)])));if(_0x224f04[_0x18081c(0x2c3)]&&_0x224f04[_0x18081c(0x2c3)]['detected']){await _0x5835f1['setStateAsync'](_0x18081c(0x311),{'val':!![],'ack':!![]}),await _0x5835f1['setStateAsync'](_0x18081c(0x384),{'val':_0x224f04['automationProposal'][_0x18081c(0x1ff)],'ack':!![]}),await _0x5835f1[_0x18081c(0x24b)](_0x18081c(0x218),{'val':_0x224f04['automationProposal']['targetId'],'ack':!![]}),await _0x5835f1['setStateAsync']('analysis.automation.targetValue',{'val':JSON['stringify'](_0x224f04[_0x18081c(0x2c3)][_0x18081c(0x230)]),'ack':!![]});if(_0x554c14)executeAutomationAction(_0x5835f1);}}catch(_0x991115){_0x5835f1[_0x18081c(0x319)][_0x18081c(0x27a)](_0x18081c(0x279)+_0x991115['message']);}}async function startSystem(_0x4c5581){const _0xfec861=a0_0x5f0772;_0x4c5581['log'][_0xfec861(0x35c)](_0xfec861(0x378)),await initZombies(_0x4c5581);try{_0x4c5581[_0xfec861(0x23b)]=await checkLicense(_0x4c5581[_0xfec861(0x363)][_0xfec861(0x33b)]);}catch(_0x4482d2){}if(!_0x4c5581['config'][_0xfec861(0x2b0)]||_0x4c5581[_0xfec861(0x363)]['inactivityThresholdHours']<0.1)_0x4c5581[_0xfec861(0x363)][_0xfec861(0x2b0)]=0xc;await initHistory(_0x4c5581),await initSystemConfig(_0x4c5581);if(_0x4c5581[_0xfec861(0x363)][_0xfec861(0x312)])try{_0x4c5581[_0xfec861(0x2a9)]=new GoogleGenerativeAI(_0x4c5581['config'][_0xfec861(0x312)]),_0x4c5581[_0xfec861(0x2dd)]=_0x4c5581[_0xfec861(0x2a9)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xfec861(0x323)}}),_0x4c5581['log'][_0xfec861(0x35c)](_0xfec861(0x22c));}catch(_0x1ca4fc){_0x4c5581[_0xfec861(0x319)]['error']('Gemini\x20Init\x20Error:\x20'+_0x1ca4fc[_0xfec861(0x20b)]);}await createAllObjects(_0x4c5581),await loadSystemMode(_0x4c5581),await loadRawEventLog(_0x4c5581),await loadDailyDigests(_0x4c5581),_0x4c5581[_0xfec861(0x37c)](_0xfec861(0x30d)),_0x4c5581['subscribeStates'](LTM_DP_TRIGGER_DIGEST),_0x4c5581[_0xfec861(0x37c)](_0xfec861(0x32d)),_0x4c5581[_0xfec861(0x37c)](_0xfec861(0x267)),_0x4c5581[_0xfec861(0x37c)](_0xfec861(0x35f)),_0x4c5581[_0xfec861(0x37c)](_0xfec861(0x345)),_0x4c5581[_0xfec861(0x37c)](_0xfec861(0x374)),_0x4c5581[_0xfec861(0x37c)](_0xfec861(0x2ab)),_0x4c5581['subscribeStates'](_0xfec861(0x32a)),_0x4c5581['subscribeStates'](_0xfec861(0x25c)),_0x4c5581[_0xfec861(0x37c)](_0xfec861(0x28b)),await initSensorSubscriptions(_0x4c5581),await initPresenceSubscriptions(_0x4c5581),await setupTelegramListener(_0x4c5581),setTimeout(()=>checkWifiPresence(_0x4c5581),0x1388);if(_0x4c5581[_0xfec861(0x2b8)])clearInterval(_0x4c5581['analysisTimer']);const _0x3d1652=_0x4c5581[_0xfec861(0x363)]['analysisInterval']||0xf;_0x3d1652>0x0&&(_0x4c5581[_0xfec861(0x2b8)]=setInterval(()=>{runAutopilot(_0x4c5581);},_0x3d1652*0x3c*0x3e8)),schedulers[_0xfec861(0x242)](_0x4c5581,()=>createDailyDigest(_0x4c5581)),schedulers['setupModeResetScheduler'](_0x4c5581),schedulers[_0xfec861(0x278)](_0x4c5581,()=>runBaselineDriftAnalysis(_0x4c5581)),schedulers[_0xfec861(0x1fe)](_0x4c5581,()=>sendMorningBriefing(_0x4c5581)),startPythonService(_0x4c5581),setTimeout(()=>{const _0x5cc958=_0xfec861;_0x4c5581[_0x5cc958(0x382)]&&(runPythonHealthCheck(_0x4c5581),triggerGaitAnalysis(_0x4c5581),triggerEnergyPrediction(_0x4c5581)),updateHealthVector(_0x4c5581);},0x1388);}function a0_0x2b21(_0x2c2b75,_0x35c508){const _0x4e0077=a0_0x3027();return a0_0x2b21=function(_0x324fea,_0x5943a9){_0x324fea=_0x324fea-0x1f3;let _0x302781=_0x4e0077[_0x324fea];return _0x302781;},a0_0x2b21(_0x2c2b75,_0x35c508);}class CogniLiving extends utils['Adapter']{constructor(_0x119122){const _0x160c8f=a0_0x5f0772;super({..._0x119122,'name':_0x160c8f(0x348)}),this[_0x160c8f(0x325)]=[],this[_0x160c8f(0x31d)]=[],this[_0x160c8f(0x257)]=[],this[_0x160c8f(0x332)]=[],this[_0x160c8f(0x24c)]={},this[_0x160c8f(0x244)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x160c8f(0x330)]=!![],this[_0x160c8f(0x21f)]=null,this['exitGraceTimer']=null,this[_0x160c8f(0x250)]=![],this['genAI']=null,this[_0x160c8f(0x2dd)]=null,this['currentSystemMode']=SYSTEM_MODES[_0x160c8f(0x2a4)],this[_0x160c8f(0x23b)]=![],this[_0x160c8f(0x2e8)]=![],this[_0x160c8f(0x236)]=_0x160c8f(0x25b),this[_0x160c8f(0x2b8)]=null,this[_0x160c8f(0x2ad)]=null,this[_0x160c8f(0x36b)]=null,this[_0x160c8f(0x2d4)]=null,this[_0x160c8f(0x34d)]=null,this[_0x160c8f(0x382)]=null,this['dependencyInstallInProgress']=![],this['on'](_0x160c8f(0x266),this[_0x160c8f(0x216)][_0x160c8f(0x308)](this)),this['on'](_0x160c8f(0x317),this[_0x160c8f(0x326)][_0x160c8f(0x308)](this)),this['on']('unload',this[_0x160c8f(0x31e)]['bind'](this)),this['on']('message',this[_0x160c8f(0x203)][_0x160c8f(0x308)](this));}async[a0_0x5f0772(0x216)](){const _0xcdb1d1=a0_0x5f0772;this['log'][_0xcdb1d1(0x35c)](_0xcdb1d1(0x362)+this[_0xcdb1d1(0x37e)]+_0xcdb1d1(0x20d));if(!installer[_0xcdb1d1(0x29b)](this,()=>startSystem(this)))return;}[a0_0x5f0772(0x31e)](_0x35927e){const _0x41beba=a0_0x5f0772;if(this[_0x41beba(0x2b8)])clearInterval(this[_0x41beba(0x2b8)]);if(this[_0x41beba(0x2d4)])clearInterval(this[_0x41beba(0x2d4)]);if(this[_0x41beba(0x2ad)])this[_0x41beba(0x2ad)][_0x41beba(0x20a)]();if(this['modeResetJob'])this[_0x41beba(0x36b)][_0x41beba(0x20a)]();if(this[_0x41beba(0x34d)])this[_0x41beba(0x34d)][_0x41beba(0x20a)]();if(this[_0x41beba(0x21f)])clearTimeout(this[_0x41beba(0x21f)]);if(this[_0x41beba(0x2e0)])clearTimeout(this[_0x41beba(0x2e0)]);stopPythonService(this),_0x35927e();}async[a0_0x5f0772(0x326)](_0x4af2e9,_0x3ea934){const _0x48844a=a0_0x5f0772;if(!_0x3ea934||this[_0x48844a(0x23c)])return;if(_0x4af2e9[_0x48844a(0x21e)]('telegram')&&_0x4af2e9[_0x48844a(0x26a)](_0x48844a(0x210))&&_0x3ea934['val']){await handleTelegramResponse(this,_0x3ea934[_0x48844a(0x241)]);return;}if(_0x4af2e9===this['namespace']+'.'+SYSTEM_DP_MODE){if(_0x3ea934[_0x48844a(0x241)]&&Object['values'](SYSTEM_MODES)[_0x48844a(0x21e)](_0x3ea934[_0x48844a(0x241)])){this[_0x48844a(0x370)]=_0x3ea934['val'];if(_0x3ea934[_0x48844a(0x241)]===SYSTEM_MODES[_0x48844a(0x20f)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x3ea934[_0x48844a(0x28f)])this['setState'](_0x4af2e9,{'val':this[_0x48844a(0x370)],'ack':!![]});return;}if(!_0x3ea934[_0x48844a(0x28f)]){_0x4af2e9[_0x48844a(0x21e)]('analysis.trigger')&&_0x3ea934[_0x48844a(0x241)]&&(this[_0x48844a(0x2de)](_0x4af2e9,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x4af2e9[_0x48844a(0x21e)](_0x48844a(0x329))&&_0x3ea934[_0x48844a(0x241)]){this[_0x48844a(0x2de)](_0x4af2e9,{'val':![],'ack':!![]});if(this[_0x48844a(0x23b)])createDailyDigest(this);}_0x4af2e9[_0x48844a(0x21e)](_0x48844a(0x1fc))&&_0x3ea934['val']&&(this[_0x48844a(0x2de)](_0x4af2e9,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x4af2e9[_0x48844a(0x21e)](_0x48844a(0x27f))&&_0x3ea934[_0x48844a(0x241)]&&(this[_0x48844a(0x2de)](_0x4af2e9,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x4af2e9['includes'](_0x48844a(0x374))&&_0x3ea934[_0x48844a(0x241)]){this['setState'](_0x4af2e9,{'val':![],'ack':!![]});if(this[_0x48844a(0x23b)])try{const _0x58d664=await this[_0x48844a(0x270)](_0x48844a(0x34e));if(_0x58d664&&_0x58d664[_0x48844a(0x241)]){const _0x2af4ea=JSON[_0x48844a(0x24a)](_0x58d664['val']);this[_0x48844a(0x319)][_0x48844a(0x35c)](_0x48844a(0x2e5)),this[_0x48844a(0x24b)]('analysis.training.status',{'val':_0x48844a(0x208),'ack':!![]}),sendToPython(this,_0x48844a(0x316),{'sequences':_0x2af4ea});}}catch(_0x1c3836){this[_0x48844a(0x319)]['error'](_0x48844a(0x21a)+_0x1c3836['message']);}}if(_0x4af2e9[_0x48844a(0x21e)](_0x48844a(0x2ab))&&_0x3ea934[_0x48844a(0x241)]){this[_0x48844a(0x2de)](_0x4af2e9,{'val':![],'ack':!![]});if(this[_0x48844a(0x23b)])try{const _0x3cda3d=await this[_0x48844a(0x270)](LTM_DP_DAILY_DIGESTS);if(_0x3cda3d&&_0x3cda3d[_0x48844a(0x241)])sendToPython(this,_0x48844a(0x253),{'digests':JSON[_0x48844a(0x24a)](_0x3cda3d[_0x48844a(0x241)])});}catch(_0x3a2058){}}if(_0x4af2e9[_0x48844a(0x21e)](_0x48844a(0x32a))&&_0x3ea934[_0x48844a(0x241)]){this[_0x48844a(0x2de)](_0x4af2e9,{'val':![],'ack':!![]});if(this[_0x48844a(0x23b)])try{const _0x176415=await this[_0x48844a(0x270)]('LTM.trainingData.thermodynamics');if(_0x176415&&_0x176415[_0x48844a(0x241)])sendToPython(this,_0x48844a(0x237),{'points':JSON[_0x48844a(0x24a)](_0x176415[_0x48844a(0x241)])});}catch(_0x3ab65f){}}if(_0x4af2e9['includes'](_0x48844a(0x25c))&&_0x3ea934[_0x48844a(0x241)]){this[_0x48844a(0x2de)](_0x4af2e9,{'val':![],'ack':!![]});if(this[_0x48844a(0x23b)])try{const _0x18146d=await this['getStateAsync'](LTM_DP_RAW_LOG);_0x18146d&&_0x18146d['val']&&(this[_0x48844a(0x319)][_0x48844a(0x35c)](_0x48844a(0x338)),sendToPython(this,'TRAIN_COMFORT',{'events':JSON[_0x48844a(0x24a)](_0x18146d[_0x48844a(0x241)])}));}catch(_0x5f5241){}}if(_0x4af2e9[_0x48844a(0x21e)](_0x48844a(0x28b))&&_0x3ea934['val']){this[_0x48844a(0x2de)](_0x4af2e9,{'val':![],'ack':!![]});if(this[_0x48844a(0x23b)])try{const _0xafcb58=await this[_0x48844a(0x270)]('LTM.trainingData.sequences');if(_0xafcb58&&_0xafcb58['val']){const _0x3ccbde=JSON['parse'](_0xafcb58[_0x48844a(0x241)]);this[_0x48844a(0x319)]['info'](_0x48844a(0x37a)),sendToPython(this,_0x48844a(0x220),{'sequences':_0x3ccbde});}}catch(_0x106923){this[_0x48844a(0x319)][_0x48844a(0x27a)](_0x48844a(0x380)+_0x106923['message']);}}return;}if(this[_0x48844a(0x363)]['presenceDevices']&&this[_0x48844a(0x363)]['presenceDevices'][_0x48844a(0x21e)](_0x4af2e9)){await checkWifiPresence(this);return;}const _0x562262=(this[_0x48844a(0x363)][_0x48844a(0x224)]||[])[_0x48844a(0x26f)](_0x5c2f14=>_0x5c2f14['id']===_0x4af2e9);if(_0x562262)processSensorEvent(this,_0x4af2e9,_0x3ea934,_0x562262);}async[a0_0x5f0772(0x203)](_0x235f08){const _0x229039=a0_0x5f0772;if(typeof _0x235f08==='object'&&_0x235f08['message']){if(_0x235f08['command']===_0x229039(0x341)){const _0x26a38d=_0x235f08[_0x229039(0x20b)][_0x229039(0x2ae)]||this[_0x229039(0x363)][_0x229039(0x312)];if(!_0x26a38d)return this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08['command'],{'success':![],'message':_0x229039(0x373)},_0x235f08['callback']);try{const _0x210d6e=new GoogleGenerativeAI(_0x26a38d),_0x4693c3=_0x210d6e[_0x229039(0x2c7)]({'model':GEMINI_MODEL}),_0x5abda8=await _0x4693c3['generateContent']('Hi');this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08['command'],{'success':!![],'message':_0x229039(0x233)+_0x5abda8[_0x229039(0x245)][_0x229039(0x337)]()},_0x235f08[_0x229039(0x31a)]);}catch(_0x1ce9e2){this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08['command'],{'success':![],'message':'Err:\x20'+_0x1ce9e2['message']},_0x235f08['callback']);}}else{if(_0x235f08['command']===_0x229039(0x359)){const _0xa0e70f=await getWeatherContext(this),_0x45b85f=await getCalendarContext(this);this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':!![],'weather':_0xa0e70f,'calendar':_0x45b85f},_0x235f08[_0x229039(0x31a)]);}else{if(_0x235f08[_0x229039(0x1f9)]===_0x229039(0x28e)){if(!this[_0x229039(0x23b)])return this['sendTo'](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':![],'isPro':![]},_0x235f08[_0x229039(0x31a)]);let _0x5687c2={'status':_0x229039(0x2ef)};try{const _0x1cb9ce=await this[_0x229039(0x270)](LTM_DP_DRIFT_STATUS);_0x5687c2['status']=_0x1cb9ce?_0x1cb9ce[_0x229039(0x241)]:_0x229039(0x2ef);}catch(_0x11aa48){}this[_0x229039(0x263)](_0x235f08['from'],_0x235f08[_0x229039(0x1f9)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x229039(0x332)],'driftAnalysis':_0x5687c2,'analysisHistory':this[_0x229039(0x31d)]},_0x235f08['callback']);}else{if(_0x235f08[_0x229039(0x1f9)]==='getOverviewData'){const _0x482b7b=this['dailyDigests'][_0x229039(0x340)],_0x26df90=new Date(),_0x171810=new Date(_0x26df90[_0x229039(0x260)](),_0x26df90[_0x229039(0x2b4)](),_0x26df90[_0x229039(0x333)]())[_0x229039(0x2ea)](),_0x33897=this['rawEventLog']['filter'](_0x227157=>new Date(_0x227157['timestamp'])['getTime']()>_0x171810)[_0x229039(0x340)],_0x2a1de0=new Array(0x18)['fill'](0x0);this[_0x229039(0x257)]['forEach'](_0x205730=>{const _0x1cbcc2=_0x229039,_0xafd534=new Date(_0x205730['timestamp']);if(_0xafd534[_0x1cbcc2(0x2ea)]()>_0x171810)_0x2a1de0[_0xafd534[_0x1cbcc2(0x2e7)]()]++;});let _0x185283={'status':_0x229039(0x2ef)};try{const _0x3417c8=await this[_0x229039(0x270)](LTM_DP_DRIFT_STATUS);_0x185283[_0x229039(0x30c)]=_0x3417c8?_0x3417c8['val']:_0x229039(0x2ef);}catch(_0x2565de){}let _0x4f52b1='';try{const _0x17c30d=await this[_0x229039(0x270)]('system.presenceWho');_0x4f52b1=_0x17c30d?_0x17c30d[_0x229039(0x241)]:'';}catch(_0x429c62){}let _0x5be8e7=null;!this['geminiModel']&&(_0x5be8e7=this[_0x229039(0x363)]['geminiApiKey']?'KI-Modell\x20nicht\x20initialisiert':'Kein\x20API\x20Key!');let _0x57913d={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x5cb4c4=await this[_0x229039(0x270)](_0x229039(0x311));if(_0x5cb4c4&&_0x5cb4c4[_0x229039(0x241)]){_0x57913d['detected']=!![];const _0x3bd021=await this[_0x229039(0x270)](_0x229039(0x384));_0x57913d[_0x229039(0x1ff)]=_0x3bd021?_0x3bd021[_0x229039(0x241)]:'';const _0x5275cb=await this['getStateAsync'](_0x229039(0x218));_0x57913d[_0x229039(0x204)]=_0x5275cb?_0x5275cb[_0x229039(0x241)]:'';const _0x4bff56=await this['getStateAsync'](_0x229039(0x232));_0x57913d[_0x229039(0x230)]=_0x4bff56?_0x4bff56[_0x229039(0x241)]:'';}const _0x1dfa61=await this[_0x229039(0x270)]('analysis.automation.autoApply');_0x57913d['autoApply']=_0x1dfa61?!!_0x1dfa61[_0x229039(0x241)]:![];}catch(_0x3e561b){}this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':!![],'eventHistory':this[_0x229039(0x325)][_0x229039(0x27c)](0x0,0xf),'stats':{'digestCount':_0x482b7b,'eventCountToday':_0x33897,'hourlyActivity':_0x2a1de0,'driftStatus':_0x185283[_0x229039(0x30c)],'isPresent':this[_0x229039(0x330)],'presenceWho':_0x4f52b1,'minDays':this[_0x229039(0x363)][_0x229039(0x2fa)]||0x7,'stbDays':this[_0x229039(0x363)][_0x229039(0x23d)]||0xe,'ltbDays':this[_0x229039(0x363)][_0x229039(0x2a3)]||0x3c,'systemError':_0x5be8e7},'automation':_0x57913d},_0x235f08[_0x229039(0x31a)]);}else{if(_0x235f08[_0x229039(0x1f9)]===_0x229039(0x22a))try{const _0x2c2b04=await scanner[_0x229039(0x2ed)](this,_0x235f08[_0x229039(0x20b)]||{});this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':!![],'devices':_0x2c2b04},_0x235f08[_0x229039(0x31a)]);}catch(_0x509f6f){this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08['command'],{'success':![],'error':_0x509f6f[_0x229039(0x20b)]},_0x235f08['callback']);}else{if(_0x235f08[_0x229039(0x1f9)]===_0x229039(0x262)){const _0x297f20=await this['getForeignObjectsAsync']('enum.functions.*','enum'),_0x3824e2=[];if(_0x297f20)for(const _0xe42a8b in _0x297f20){const _0x5db74=_0x297f20[_0xe42a8b],_0x1ee342=(_0x5db74[_0x229039(0x318)]&&typeof _0x5db74[_0x229039(0x318)][_0x229039(0x2e4)]===_0x229039(0x2f1)?_0x5db74[_0x229039(0x318)]['name']['de']:_0x5db74[_0x229039(0x318)][_0x229039(0x2e4)])||_0x5db74[_0x229039(0x318)][_0x229039(0x2e4)];_0x3824e2[_0x229039(0x35a)]({'id':_0xe42a8b,'name':_0x1ee342});}const _0x3bc461=await this['getForeignObjectsAsync']('enum.rooms.*',_0x229039(0x2ce)),_0x461eef=[];if(_0x3bc461)for(const _0x1371cd in _0x3bc461){const _0x596cf3=_0x3bc461[_0x1371cd],_0x372286=(_0x596cf3[_0x229039(0x318)]&&typeof _0x596cf3[_0x229039(0x318)]['name']===_0x229039(0x2f1)?_0x596cf3[_0x229039(0x318)][_0x229039(0x2e4)]['de']:_0x596cf3['common'][_0x229039(0x2e4)])||_0x1371cd[_0x229039(0x2c6)]('.')[_0x229039(0x2da)]();_0x461eef[_0x229039(0x35a)](_0x372286);}this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':!![],'enums':_0x3824e2,'rooms':_0x461eef},_0x235f08[_0x229039(0x31a)]);}else{if(_0x235f08[_0x229039(0x1f9)]==='getCalendarNames'){const _0x2619b5=_0x235f08[_0x229039(0x20b)][_0x229039(0x2dc)];if(!_0x2619b5)return this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':![],'error':_0x229039(0x367)},_0x235f08[_0x229039(0x31a)]);const _0x464d52=await getCalendarNames(this,_0x2619b5);this['sendTo'](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':!![],'names':_0x464d52},_0x235f08['callback']);}else{if(_0x235f08[_0x229039(0x1f9)]===_0x229039(0x209)){const {targetId:_0x1272d3,targetValue:_0x3c2765}=_0x235f08[_0x229039(0x20b)];this[_0x229039(0x319)][_0x229039(0x35c)](_0x229039(0x344)+_0x1272d3+_0x229039(0x34b)+_0x3c2765),await this[_0x229039(0x24b)](_0x229039(0x311),{'val':!![],'ack':!![]}),await this[_0x229039(0x24b)](_0x229039(0x384),{'val':'SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20'+_0x1272d3,'ack':!![]}),await this[_0x229039(0x24b)](_0x229039(0x218),{'val':_0x1272d3,'ack':!![]}),await this[_0x229039(0x24b)](_0x229039(0x232),{'val':_0x3c2765,'ack':!![]}),this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':!![]},_0x235f08[_0x229039(0x31a)]);}else{if(_0x235f08[_0x229039(0x1f9)]===_0x229039(0x248)){const {historyId:_0x1d165e,rating:_0x175300,comment:_0x5879e6,alertReason:_0x143d4d}=_0x235f08[_0x229039(0x20b)];_0x1d165e&&_0x175300?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x1d165e,'rating':_0x175300,'comment':_0x5879e6,'alertReason':_0x143d4d}),this[_0x229039(0x263)](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':!![]},_0x235f08[_0x229039(0x31a)])):this['sendTo'](_0x235f08[_0x229039(0x2b7)],_0x235f08[_0x229039(0x1f9)],{'success':![],'error':_0x229039(0x34c)},_0x235f08[_0x229039(0x31a)]);}else _0x235f08['command']===_0x229039(0x202)&&(this[_0x229039(0x319)][_0x229039(0x35c)](_0x229039(0x2f8)),await this[_0x229039(0x24b)](_0x229039(0x311),{'val':![],'ack':!![]}),await this['setStateAsync'](_0x229039(0x384),{'val':'','ack':!![]}),this[_0x229039(0x263)](_0x235f08['from'],_0x235f08[_0x229039(0x1f9)],{'success':!![]},_0x235f08[_0x229039(0x31a)]));}}}}}}}}}}}if(require[a0_0x5f0772(0x251)]!==module)module['exports']=_0xfeb6ed=>new CogniLiving(_0xfeb6ed);else new CogniLiving();