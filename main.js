const a0_0x4a1786=a0_0x5184;(function(_0x1e034a,_0x5d57b4){const _0x262d99=a0_0x5184,_0x3ca3dd=_0x1e034a();while(!![]){try{const _0x23ff3b=-parseInt(_0x262d99(0x219))/0x1+-parseInt(_0x262d99(0x2d0))/0x2+-parseInt(_0x262d99(0x134))/0x3+-parseInt(_0x262d99(0x299))/0x4+parseInt(_0x262d99(0x13a))/0x5*(parseInt(_0x262d99(0x11c))/0x6)+-parseInt(_0x262d99(0x227))/0x7+parseInt(_0x262d99(0x288))/0x8;if(_0x23ff3b===_0x5d57b4)break;else _0x3ca3dd['push'](_0x3ca3dd['shift']());}catch(_0x255da1){_0x3ca3dd['push'](_0x3ca3dd['shift']());}}}(a0_0x284e,0xa3be7));const a0_0x478496=(function(){let _0x2aa89b=!![];return function(_0x3d1768,_0x1fdf08){const _0x5982b9=_0x2aa89b?function(){const _0x566bfd=a0_0x5184;if(_0x1fdf08){const _0x3fbe17=_0x1fdf08[_0x566bfd(0x234)](_0x3d1768,arguments);return _0x1fdf08=null,_0x3fbe17;}}:function(){};return _0x2aa89b=![],_0x5982b9;};}()),a0_0x7ebebf=a0_0x478496(this,function(){const _0x3cedd0=a0_0x5184;return a0_0x7ebebf[_0x3cedd0(0x2c8)]()[_0x3cedd0(0x26a)]('(((.+)+)+)+$')[_0x3cedd0(0x2c8)]()[_0x3cedd0(0x19f)](a0_0x7ebebf)[_0x3cedd0(0x26a)]('(((.+)+)+)+$');});a0_0x7ebebf();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x4a1786(0x259)),schedule=require(a0_0x4a1786(0x15a)),{spawn,exec}=require('child_process'),path=require(a0_0x4a1786(0x256)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x4a1786(0x261),MODE_RESET_SCHEDULE=a0_0x4a1786(0x1f1),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x4a1786(0x1e3),LTM_DP_DAILY_DIGESTS=a0_0x4a1786(0x1a8),LTM_DP_STATUS=a0_0x4a1786(0x1ec),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x4a1786(0x2e9),LTM_DP_DRIFT_CHANNEL='LTM.driftAnalysis',LTM_DP_DRIFT_STATUS=a0_0x4a1786(0x181),LTM_DP_DRIFT_DETAILS='LTM.driftAnalysis.driftDetails',LTM_DP_DRIFT_LAST_CHECK=a0_0x4a1786(0x1a3),SYSTEM_DP_MODE=a0_0x4a1786(0x271),HARD_IGNORE_TERMS=[a0_0x4a1786(0x2d7),a0_0x4a1786(0x25f),'update',a0_0x4a1786(0x1f3),a0_0x4a1786(0x203),a0_0x4a1786(0x2ba),a0_0x4a1786(0x140),a0_0x4a1786(0x287),a0_0x4a1786(0x1d5),a0_0x4a1786(0x11b),a0_0x4a1786(0x294),a0_0x4a1786(0x2b1),'stick_unreach',a0_0x4a1786(0x198),a0_0x4a1786(0x1f6),'firmware',a0_0x4a1786(0x264),a0_0x4a1786(0x28c)],BAD_NAMES=[a0_0x4a1786(0x154),a0_0x4a1786(0x1f8),a0_0x4a1786(0x16a),a0_0x4a1786(0x167),a0_0x4a1786(0x2c2),'brightness','on',a0_0x4a1786(0x2cc),a0_0x4a1786(0x23a),a0_0x4a1786(0x15f),'shutter','blind','cover','status','motion','presence',a0_0x4a1786(0x20c),a0_0x4a1786(0x133),a0_0x4a1786(0x26f),a0_0x4a1786(0x2e0),a0_0x4a1786(0x1be),'setpoint',a0_0x4a1786(0x2d9),a0_0x4a1786(0x278),a0_0x4a1786(0x176)],ADAPTER_BLACKLIST=[a0_0x4a1786(0x2a9),a0_0x4a1786(0x2b2),a0_0x4a1786(0x2c5),a0_0x4a1786(0x1de),'history.','material.',a0_0x4a1786(0x220),'flot.',a0_0x4a1786(0x27c),a0_0x4a1786(0x19e),a0_0x4a1786(0x282)],SYSTEM_MODES={'NORMAL':a0_0x4a1786(0x2e6),'VACATION':a0_0x4a1786(0x17c),'PARTY':a0_0x4a1786(0x156),'GUEST':a0_0x4a1786(0x1fe)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x4a1786(0x2c1)],SYSTEM_MODES[a0_0x4a1786(0x2ed)]],PERSONA_MAPPING={'generic':a0_0x4a1786(0x14e),'senior_aal':a0_0x4a1786(0x192),'family':a0_0x4a1786(0x1b5),'single_comfort':a0_0x4a1786(0x145),'security':a0_0x4a1786(0x213)};async function initZombies(_0x497232){const _0x3c3b34=a0_0x4a1786;try{const _0x539ab6=[_0x3c3b34(0x1a6),_0x3c3b34(0x252)];for(const _0x9ba6ff of _0x539ab6){try{const _0x3f8b5b=await _0x497232['getObjectAsync'](_0x9ba6ff);_0x3f8b5b&&await _0x497232[_0x3c3b34(0x1b3)](_0x9ba6ff);}catch(_0x29a74d){}}}catch(_0xbba6e7){}}async function initHistory(_0x1a8693){const _0x12a009=a0_0x4a1786;try{const _0x3cec00=await _0x1a8693[_0x12a009(0x260)](_0x12a009(0x267));_0x3cec00&&_0x3cec00[_0x12a009(0x248)]&&(_0x1a8693['eventHistory']=JSON[_0x12a009(0x15d)](_0x3cec00[_0x12a009(0x248)][_0x12a009(0x2c8)]()));}catch(_0x5dd253){_0x1a8693[_0x12a009(0x1e2)]=[];}try{const _0x52b3ca=await _0x1a8693['getStateAsync'](_0x12a009(0x22f));if(_0x52b3ca&&_0x52b3ca[_0x12a009(0x248)])_0x1a8693['analysisHistory']=JSON[_0x12a009(0x15d)](_0x52b3ca[_0x12a009(0x248)]['toString']());}catch(_0x27c300){_0x1a8693[_0x12a009(0x22d)]=[];}if(_0x1a8693[_0x12a009(0x1e2)]&&_0x1a8693['eventHistory'][_0x12a009(0x240)]>0x0){_0x1a8693[_0x12a009(0x172)][_0x12a009(0x225)]('Restoring\x20sensor\x20cache\x20from\x20history\x20('+_0x1a8693[_0x12a009(0x1e2)][_0x12a009(0x240)]+_0x12a009(0x1e8));for(let _0x27cdd7=_0x1a8693[_0x12a009(0x1e2)][_0x12a009(0x240)]-0x1;_0x27cdd7>=0x0;_0x27cdd7--){const _0x2841c2=_0x1a8693[_0x12a009(0x1e2)][_0x27cdd7];_0x2841c2&&_0x2841c2['id']!==undefined&&_0x2841c2[_0x12a009(0x2c2)]!==undefined&&(_0x1a8693[_0x12a009(0x217)][_0x2841c2['id']]=_0x2841c2[_0x12a009(0x2c2)]);}}}async function initSystemConfig(_0x48522e){const _0x24af01=a0_0x4a1786;try{const _0x4b6886=await _0x48522e[_0x24af01(0x13c)](_0x24af01(0x16c));_0x4b6886&&_0x4b6886[_0x24af01(0x1ff)]&&(_0x48522e['systemConfig']={'latitude':_0x4b6886['common'][_0x24af01(0x245)]||0x0,'longitude':_0x4b6886[_0x24af01(0x1ff)][_0x24af01(0x28b)]||0x0,'city':_0x4b6886['common'][_0x24af01(0x146)]||''});}catch(_0x3308a2){}}function a0_0x284e(){const _0x41c72d=['system.config','python_service','doors','Drift\x20Sched\x20Error:\x20','NORMAL','Gast','log','callback','Briefing\x20Error:\x20','telegram','set_temperature','driftAnalysisTimer','substring','setState','Feedback\x20saved:\x20','Description','vacation','targetValue','door','Bibliotheken\x20nicht\x20gefunden','Subscribing\x20to\x20','LTM.driftAnalysis.baselineDrift','Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.','N/A','write','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','exitTimer','triggerDailyDigest','analysis.isAlert','activityLevel','sort','command','isPresent','motion','version','geminiApiKey','uuid','namespace','PRIORIT√ÑT:\x20Gesundheit/AAL.','lastAlertState','analysis.isEmergency','getGenerativeModel','Sending\x20notification:\x20\x22','lock','config_pending','...','\x20presence\x20devices...','KALENDER\x20ERROR:\x20','online','Started\x20at\x20','javascript.','constructor','Missing\x20data','.NextHours.Location_1.Day_1.current.symbol_desc','enum','LTM.driftAnalysis.lastCheck','analysis.alertReason','isArray','analysis.history_debug_00','KALENDER:\x20Keine\x20Kalender\x20ausgew√§hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','LTM.dailyDigests','time','status','ltmStbWindowDays','calendarInstance','\x20=\x20','analysis.health.notes','getForeignObjectsAsync','WETTER\x20ERROR:\x20','Auto\x20Apply\x20Rule','minDaysForBaseline','delObjectAsync','devices','Fokus\x20auf\x20Familienroutinen.','python3\x20-m\x20pip\x20install\x20-r\x20\x22','uuid-error','temp','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','Action','AI\x20Alert\x20Status','WETTER:\x20Keine\x20Daten\x20gefunden','analysis.activitySummary','energy','.\x20OUTPUT:\x20Nur\x20Text.','unknown','unshift','Baseline\x20Status','stringify','Error\x20checking\x20WiFi:\x20','pop','useCalendar','genAI','replace','Error\x20launching\x20Python\x20service:\x20','[PYTHON]\x20','presenceDevices','schalter','Deviation','Lernphase\x20(','events.lastEvent','Gemini\x20Analysis\x20Error:\x20','summary','generic','_score','startsWith','error','Drift\x20Details','members','‚úÖ\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.','Deaktiviert\x20(Pro-Feature)','subscribeForeignStatesAsync','Vom\x20Benutzer\x20best√§tigt\x20(OK).','debug','üìû\x20R√úCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20R√ºckruf-Button\x20gedr√ºckt.','vis.','Processing\x20Status','modeResetJob','number','eventHistory','LTM.rawEventLog','Entry\x20detected\x20via\x20','onUnload','timestamp','Generating\x20Morning\x20Briefing...','\x20events)...','getLtmData','setForeignStateAsync','.communicate.request','LTM.processingStatus','join','dimmer','weatherInstance','systemConfig','0\x204\x20*\x20*\x20*','KALENDER:\x20','unreach','analysis.comfortSuggestion','generateContent','dutycycle','Cogni-Living','currentposition','role','toLowerCase','\x20|\x20','‚úÖ\x20Alarm\x20quittiert.\x20System\x20normal.','onReady','guest','common','heizung','data','isGracePeriodActive','lowbat','Pattern\x20Detected','onStateChange','endsWith','COGNI_CONFIRM_OK','üö®\x20EMERGENCY','.\x20KONTEXT:\x20','VACATION','baselineDrift','occupancy','toFixed','ltmLtbWindowDays','some','getMonth','subscribeStates','filter','PRIORIT√ÑT:\x20Sicherheit.','isAlert','setStateAsync','Trigger\x20Digest','sensorLastValues','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','27948afixXX','includes','none','blind','Last\x20Result','alertReason','PRO-','icons-mfd.','Success:\x20Compressed\x20','daswetter.0','ready','[PYTHON\x20ERR]\x20','info','analysis.automation.description','2185106gNpaul','unload','getForeignStateAsync','cancel','config','Event\x20received:\x20','analysisHistory','trim','analysis.analysisHistory','type','analysis.automation.autoApply','thermostat','event','apply','split','light','Alarm','‚ö†Ô∏è\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','automation.triggerAction','switch','useWeather','location','Morning\x20Briefing\x20sent.','communicate.request','values','length','triggerBriefing','channel','Sleep\x20Score\x20(0-100)','main','latitude','pr√§senz','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','val','analysis.automation.targetId','AI\x20Emergency\x20Status','livingContext','exitGraceTimer','forEach','python3','.\x20ZUSATZ:\x20','weather','analysis.health.restlessness','events.history_debug_00','analysis.automation.suggestedAction','analysis.automation.patternDetected','ü§ñ\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','path','sendToAsync','enum.rooms.*','@google/generative-ai','system.presenceWho','.forecast.current.state','splice','sensor','geminiModel','scriptEnabled','getStateAsync','0\x203\x20*\x20*\x20*','notifyEmailRecipient','setHours','reachable','\x20min).','siren','events.history','LTM\x20Sched\x20Error:\x20','extendObjectAsync','search','isEmergency','Trigger\x20Action\x20Now','native','\x20events','humidity','üì°\x20Hooking\x20into\x20','system.mode','Target\x20ID','SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','Normal','lastCheck','BUTLER\x20Execution\x20Error:\x20','toISOString','actual_temperature','.data.table','exports','licenseKey','echarts.','health','üåÖ\x20Daily\x20Briefing:\x0a','aiPersona','getTime','string','simple-api.','message','date','pythonProcess','Daily\x20Digests','maintenance','27449824PHTzNC','lights','\x0aSTB:\x20','longitude','link_quality','notifyTelegramRecipient','push','Reset\x20Sched\x20Error:\x20','Starting\x20Autopilot\x20(','analysis.automation.targetValue','Error\x20in\x20onMessage\x20command\x20','KALENDER:\x20Keine\x20relevanten\x20Termine','working','N/A\x20(Learning)','Error\x20reading\x20calendar\x20table:\x20','indicator.alarm',').\x20Starting\x20Timer.','4699968nHSjlO','notifyTelegramInstance','\x22\x20--break-system-packages','description','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','.\x0a\x20\x20\x20\x20KONTEXT:\x20','Raw\x20Log','expire','Gemini\x20AI\x20initialized.','No\x20module\x20named','.\x0a\x20\x20\x20\x20WETTER:\x20','Scheduling\x20Morning\x20Briefing\x20for\x20','.\x20Welcome\x20home.','now','stderr','dailyDigests','system.','text.alarm','catch','Briefing\x20Sched\x20Error:\x20','setObjectNotExistsAsync','\x20(Value:\x20','Gemini\x20Init\x20Error:\x20','service.py','direction','admin.','fill','User\x20dismissed\x20automation\x20proposal.','Alert\x20Reason','analysisInterval','notifyPushoverInstance','‚ö†Ô∏è\x20ALARM:\x20','ack','rssi','feedbackHistory','Drift\x20Analysis','\x20for\x20interactive\x20buttons...','COGNI_REQUEST_CALL','üìû\x20R√ºckruf\x20anfordern','shutter','PARTY','value','Error:\x20','system','info.','.Summary.Current','/100,\x20Aktivit√§t\x20seit\x2004:00:\x20','toString','getCalendarNames','object','Trigger\x20Analysis','off','accuweather.0','notifyEmailEnabled','LTM','2217974otxnOr','Event\x20History','IGNORING\x20DUPLICATE\x20(Cached):\x20','Keiner','isExit','text','fenster','scriptProblem','WETTER:\x20','valve','close','from','analysis.lastResult','Urlaub','details','autoApply','power','\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20','systemUUID','analysis.automation.triggerAction','inactivityMonitoringEnabled','bind','normal','ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','getHours','LTM.baselineStatus','inactivityThresholdHours','getCalendarNames\x20Error:\x20','cogni-living','GUEST','sendTo','detected','Adapter','scheduleJob','system.meta.uuid','daswetter','fault','60906cVXhVX','Wetter:\x20Deaktiviert','enum.functions.*','accuweather','targetId','map','bewegung','lastIndexOf','Party','briefingJob','No\x20instance','Exit\x20Sensor\x20triggered\x20(','response','dependencyInstallInProgress','‚úÖ\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','openweathermap','analysis.deviationFromBaseline','getOverviewData','application/json','instance','.\x20DATEN:\x20Schlaf\x20','\x20hours.\x20Potential\x20incapacitation.','automationProposal','temperature','1718823LvpOJq','analysis.comfortSummary','openweathermap.0','briefingTime','boolean','stdout','215TLsUFk','analysis.health.sleepScore','getForeignObjectAsync','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','analysis.triggerBriefing','warn','connection','submitFeedback','Feedback\x20Log','üêç\x20Starting\x20Python\x20Sidecar:\x20','08:00','Fokus\x20auf\x20Komfort.','city','notifyPushoverRecipient','üêç\x20Stopping\x20Python\x20Sidecar...','stateChange','klima','\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20Inaktivit√§t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','onMessage','sound','Analysiere\x20ausgewogen.','Details:\x20','button','analysis.trigger','rawEventLog','Logbook','targetposition','Activity\x20Summary','party','Health\x20Notes','getFullYear','currentSystemMode','node-schedule','isProVersion','Aktiv\x20(','parse','indicator.alarm.fire','position','analysisTimer','name','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','slice','_calName','json','send','level','ltmJob',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','state','uuid-not-found'];a0_0x284e=function(){return _0x41c72d;};return a0_0x284e();}async function checkLicense(_0x53afe2,_0x30cca2){const _0x9bc395=a0_0x4a1786;if(!_0x30cca2)return![];_0x53afe2[_0x9bc395(0x2e2)]=await getSystemUUID(_0x53afe2);if(_0x30cca2==='TEST-PRO-KEY'||_0x30cca2[_0x9bc395(0x1d4)](_0x9bc395(0x21f)))return!![];return![];}function a0_0x5184(_0x5edd30,_0x3b8794){const _0x3644d4=a0_0x284e();return a0_0x5184=function(_0x7ebebf,_0x478496){_0x7ebebf=_0x7ebebf-0x115;let _0x284e7f=_0x3644d4[_0x7ebebf];return _0x284e7f;},a0_0x5184(_0x5edd30,_0x3b8794);}async function getSystemUUID(_0x2986b3){const _0x2bf22c=a0_0x4a1786;try{const _0x11b5f5=await _0x2986b3[_0x2bf22c(0x13c)](_0x2bf22c(0x119));if(_0x11b5f5&&_0x11b5f5[_0x2bf22c(0x26d)]&&_0x11b5f5['native'][_0x2bf22c(0x190)])return _0x11b5f5['native']['uuid'];return _0x2bf22c(0x16b);}catch(_0x3e42e0){return _0x2bf22c(0x1b7);}}async function createAllObjects(_0x34650d){const _0x4e6279=a0_0x4a1786;await checkSystemObjects(_0x34650d),await _0x34650d[_0x4e6279(0x2ad)]('system.presenceWho',{'type':_0x4e6279(0x16a),'common':{'name':'Who\x20is\x20present?','type':_0x4e6279(0x281),'role':_0x4e6279(0x2d5),'read':!![],'write':![],'def':''},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x1cf),{'type':_0x4e6279(0x16a),'common':{'name':'Last\x20raw\x20event','type':_0x4e6279(0x281),'role':_0x4e6279(0x165),'read':!![],'write':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)]('events.history',{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x2d1),'type':'string','role':_0x4e6279(0x165),'read':!![],'write':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x151),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x2cb),'type':_0x4e6279(0x138),'role':_0x4e6279(0x150),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x13e),{'type':'state','common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x4e6279(0x138),'role':_0x4e6279(0x150),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x2dc),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x21d),'type':_0x4e6279(0x281),'role':'json','read':!![],'write':![]},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x188),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x1bb),'type':_0x4e6279(0x138),'role':_0x4e6279(0x297),'read':!![],'write':![],'def':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x194),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x24a),'type':_0x4e6279(0x138),'role':_0x4e6279(0x15e),'read':!![],'write':![],'def':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)]('analysis.alertReason',{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x2b5),'type':_0x4e6279(0x281),'role':_0x4e6279(0x2aa),'read':!![],'write':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x1bd),{'type':'state','common':{'name':_0x4e6279(0x155),'type':_0x4e6279(0x281),'role':_0x4e6279(0x2d5),'read':!![],'write':![]},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x12c),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x1cd),'type':_0x4e6279(0x281),'role':_0x4e6279(0x16a),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x135),{'type':_0x4e6279(0x16a),'common':{'name':'Comfort\x20Summary','type':_0x4e6279(0x281),'role':'text','read':!![],'write':![]},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x1f4),{'type':'state','common':{'name':'Comfort\x20Suggestion','type':'string','role':_0x4e6279(0x2d5),'read':!![],'write':![]},'native':{}}),await _0x34650d[_0x4e6279(0x269)]('analysis.automation',{'type':_0x4e6279(0x242),'common':{'name':'Automation\x20Proposals'},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x254),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x204),'type':_0x4e6279(0x138),'role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x226),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x17b),'type':_0x4e6279(0x281),'role':_0x4e6279(0x2d5),'read':!![],'write':![]},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x253),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x1ba),'type':_0x4e6279(0x281),'role':_0x4e6279(0x2d5),'read':!![],'write':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x249),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x272),'type':_0x4e6279(0x281),'role':'text','read':!![],'write':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x291),{'type':_0x4e6279(0x16a),'common':{'name':'Target\x20Value','type':'string','role':_0x4e6279(0x2d5),'read':!![],'write':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)]('analysis.automation.autoApply',{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x1b1),'type':_0x4e6279(0x138),'role':_0x4e6279(0x23a),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x2e3),{'type':'state','common':{'name':_0x4e6279(0x26c),'type':_0x4e6279(0x138),'role':_0x4e6279(0x150),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x34650d[_0x4e6279(0x2ad)](_0x4e6279(0x22f),{'type':'state','common':{'name':_0x4e6279(0x153),'type':_0x4e6279(0x281),'role':_0x4e6279(0x165),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x34650d['setObjectNotExistsAsync']('analysis.feedbackHistory',{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x142),'type':'string','role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await _0x34650d[_0x4e6279(0x269)]('analysis.health',{'type':_0x4e6279(0x242),'common':{'name':'Health\x20&\x20Sleep\x20Analysis'},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x13b),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x243),'type':_0x4e6279(0x1e1),'role':'value.health','read':!![],'write':![],'def':0x0},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x251),{'type':_0x4e6279(0x16a),'common':{'name':'Restlessness\x20Level','type':_0x4e6279(0x281),'role':_0x4e6279(0x2d5),'read':!![],'write':![],'def':_0x4e6279(0x21b)},'native':{}}),await _0x34650d['setObjectNotExistsAsync'](_0x4e6279(0x1ae),{'type':_0x4e6279(0x16a),'common':{'name':_0x4e6279(0x157),'type':_0x4e6279(0x281),'role':_0x4e6279(0x2d5),'read':!![],'write':![],'def':''},'native':{}}),await checkLtmObjects(_0x34650d),await checkLtmDriftObjects(_0x34650d);}async function checkSystemObjects(_0x2fbf25){const _0x11523b=a0_0x4a1786;await _0x2fbf25[_0x11523b(0x269)](_0x11523b(0x2c4),{'type':_0x11523b(0x242),'common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0x2fbf25[_0x11523b(0x269)](SYSTEM_DP_MODE,{'type':_0x11523b(0x16a),'common':{'name':'System\x20Mode','type':_0x11523b(0x281),'role':_0x11523b(0x16a),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x11523b(0x170)],'states':{[SYSTEM_MODES[_0x11523b(0x170)]]:_0x11523b(0x274),[SYSTEM_MODES[_0x11523b(0x20a)]]:_0x11523b(0x2dd),[SYSTEM_MODES[_0x11523b(0x2c1)]]:_0x11523b(0x124),[SYSTEM_MODES[_0x11523b(0x2ed)]]:_0x11523b(0x171)}},'native':{}});}async function checkLtmObjects(_0x531547){const _0x188590=a0_0x4a1786;await _0x531547[_0x188590(0x269)](_0x188590(0x2cf),{'type':'channel','common':{'name':_0x188590(0x2cf)},'native':{}}),await _0x531547['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x188590(0x29f),'type':'string','role':_0x188590(0x165),'read':!![],'write':![]},'native':{}}),await _0x531547[_0x188590(0x269)](LTM_DP_DAILY_DIGESTS,{'type':_0x188590(0x16a),'common':{'name':_0x188590(0x286),'type':_0x188590(0x281),'role':_0x188590(0x165),'read':!![],'write':![]},'native':{}}),await _0x531547[_0x188590(0x269)](LTM_DP_STATUS,{'type':_0x188590(0x16a),'common':{'name':_0x188590(0x1df),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x531547[_0x188590(0x269)](LTM_DP_TRIGGER_DIGEST,{'type':_0x188590(0x16a),'common':{'name':_0x188590(0x216),'type':_0x188590(0x138),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await _0x531547[_0x188590(0x269)](LTM_DP_BASELINE_STATUS,{'type':_0x188590(0x16a),'common':{'name':_0x188590(0x1c2),'type':_0x188590(0x281),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x5e914d){const _0x211703=a0_0x4a1786;await _0x5e914d['extendObjectAsync'](LTM_DP_DRIFT_CHANNEL,{'type':_0x211703(0x242),'common':{'name':_0x211703(0x2bc)},'native':{}}),await _0x5e914d['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x211703(0x16a),'common':{'name':'Drift\x20Status','type':_0x211703(0x281),'role':_0x211703(0x16a),'read':!![],'write':![],'def':_0x211703(0x183)},'native':{}}),await _0x5e914d[_0x211703(0x269)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x211703(0x1d6),'type':_0x211703(0x281),'role':_0x211703(0x2d5),'read':!![],'write':![]},'native':{}}),await _0x5e914d[_0x211703(0x269)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x211703(0x16a),'common':{'name':'Last\x20Check','type':_0x211703(0x1e1),'role':_0x211703(0x284),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x1b9ffa){const _0x766757=a0_0x4a1786;try{const _0x58e9be=await _0x1b9ffa[_0x766757(0x260)](SYSTEM_DP_MODE);_0x58e9be&&_0x58e9be[_0x766757(0x248)]&&Object[_0x766757(0x23f)](SYSTEM_MODES)['includes'](_0x58e9be['val'])?_0x1b9ffa[_0x766757(0x159)]=_0x58e9be[_0x766757(0x248)]:(_0x1b9ffa[_0x766757(0x159)]=SYSTEM_MODES[_0x766757(0x170)],await _0x1b9ffa['setStateAsync'](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x4b55e4){_0x1b9ffa[_0x766757(0x159)]=SYSTEM_MODES[_0x766757(0x170)];}}async function loadRawEventLog(_0x1dd2c8){const _0x1f50ae=a0_0x4a1786;try{const _0x2ed1ae=await _0x1dd2c8[_0x1f50ae(0x260)](LTM_DP_RAW_LOG);if(_0x2ed1ae&&_0x2ed1ae[_0x1f50ae(0x248)])_0x1dd2c8[_0x1f50ae(0x152)]=JSON['parse'](_0x2ed1ae[_0x1f50ae(0x248)]);}catch(_0xd628a7){_0x1dd2c8[_0x1f50ae(0x152)]=[];}}async function saveRawEventLog(_0x4f12df){const _0x5f4faf=a0_0x4a1786;_0x4f12df[_0x5f4faf(0x152)][_0x5f4faf(0x240)]>RAW_LOG_MAX_SIZE&&_0x4f12df[_0x5f4faf(0x152)][_0x5f4faf(0x25c)](0x0,_0x4f12df[_0x5f4faf(0x152)][_0x5f4faf(0x240)]-RAW_LOG_MAX_SIZE),await _0x4f12df['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x5f4faf(0x1c3)](_0x4f12df[_0x5f4faf(0x152)]),'ack':!![]});}async function loadDailyDigests(_0x58d9ac){const _0x25b9be=a0_0x4a1786;try{const _0x25714b=await _0x58d9ac[_0x25b9be(0x260)](LTM_DP_DAILY_DIGESTS);if(_0x25714b&&_0x25714b[_0x25b9be(0x248)])_0x58d9ac[_0x25b9be(0x2a8)]=JSON[_0x25b9be(0x15d)](_0x25714b['val']);}catch(_0x461b3c){_0x58d9ac[_0x25b9be(0x2a8)]=[];}await updateBaselineStatus(_0x58d9ac);}async function saveDailyDigests(_0x385ab4,_0x4ec6db=!![]){const _0x255325=a0_0x4a1786,_0x2a2813=_0x385ab4[_0x255325(0x22b)][_0x255325(0x20e)]||0x3c;_0x385ab4['dailyDigests'][_0x255325(0x240)]>_0x2a2813&&_0x385ab4['dailyDigests'][_0x255325(0x25c)](0x0,_0x385ab4['dailyDigests']['length']-_0x2a2813);await _0x385ab4[_0x255325(0x215)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x385ab4[_0x255325(0x2a8)]),'ack':!![]});if(_0x4ec6db)await updateBaselineStatus(_0x385ab4);}async function updateAnalysisHistory(_0x142c9a,_0x277b7f){const _0x2decc7=a0_0x4a1786;_0x142c9a[_0x2decc7(0x22d)][_0x2decc7(0x1c1)](_0x277b7f);if(_0x142c9a[_0x2decc7(0x22d)][_0x2decc7(0x240)]>ANALYSIS_HISTORY_MAX_SIZE)_0x142c9a[_0x2decc7(0x22d)][_0x2decc7(0x1c5)]();await _0x142c9a[_0x2decc7(0x215)]('analysis.analysisHistory',{'val':JSON[_0x2decc7(0x1c3)](_0x142c9a[_0x2decc7(0x22d)]),'ack':!![]});}async function updateBaselineStatus(_0x1f9666){const _0x1b6f89=a0_0x4a1786;if(!_0x1f9666[_0x1b6f89(0x15b)]){await _0x1f9666[_0x1b6f89(0x215)](LTM_DP_BASELINE_STATUS,{'val':_0x1b6f89(0x1d9),'ack':!![]});return;}const _0x3c2924=_0x1f9666[_0x1b6f89(0x2a8)]['length']>=(_0x1f9666['config']['minDaysForBaseline']||0x7)?_0x1b6f89(0x15c)+_0x1f9666[_0x1b6f89(0x2a8)][_0x1b6f89(0x240)]+'\x20Tage)':_0x1b6f89(0x1ce)+_0x1f9666[_0x1b6f89(0x2a8)][_0x1b6f89(0x240)]+'/'+(_0x1f9666[_0x1b6f89(0x22b)][_0x1b6f89(0x1b2)]||0x7)+')';await _0x1f9666[_0x1b6f89(0x215)](LTM_DP_BASELINE_STATUS,{'val':_0x3c2924,'ack':!![]});}async function initSensorSubscriptions(_0x4f3c0e){const _0x39e22e=a0_0x4a1786,_0x3e9351=_0x4f3c0e[_0x39e22e(0x22b)]['devices'];if(_0x3e9351&&_0x3e9351[_0x39e22e(0x240)]>0x0){_0x4f3c0e[_0x39e22e(0x172)]['info']('Subscribing\x20to\x20'+_0x3e9351['length']+'\x20sensors...');for(const _0x3ef9ad of _0x3e9351){if(_0x3ef9ad['id']){await _0x4f3c0e[_0x39e22e(0x1da)](_0x3ef9ad['id']);try{const _0x1f55ff=await _0x4f3c0e[_0x39e22e(0x229)](_0x3ef9ad['id']);if(_0x1f55ff)_0x4f3c0e[_0x39e22e(0x217)][_0x3ef9ad['id']]=_0x1f55ff[_0x39e22e(0x248)];}catch(_0x27d881){}}}}}async function initPresenceSubscriptions(_0x4edac3){const _0xeef0f0=a0_0x4a1786,_0x15c02a=_0x4edac3[_0xeef0f0(0x22b)][_0xeef0f0(0x1cb)]||[];if(_0x15c02a[_0xeef0f0(0x240)]>0x0){_0x4edac3[_0xeef0f0(0x172)][_0xeef0f0(0x225)](_0xeef0f0(0x180)+_0x15c02a[_0xeef0f0(0x240)]+_0xeef0f0(0x19a));for(const _0x46d1f9 of _0x15c02a){await _0x4edac3['subscribeForeignStatesAsync'](_0x46d1f9);}try{await checkWifiPresence(_0x4edac3);}catch(_0x437864){}}}async function getWeatherContext(_0xabe653){const _0x400eec=a0_0x4a1786;try{if(!_0xabe653[_0x400eec(0x22b)][_0x400eec(0x23b)])return _0x400eec(0x11d);let _0x4a29c6='';const _0x2f5737=_0xabe653[_0x400eec(0x22b)][_0x400eec(0x1ef)];if(_0x2f5737)try{if(_0x2f5737[_0x400eec(0x21a)](_0x400eec(0x11f))){const _0x4a88e6=await _0xabe653[_0x400eec(0x229)](_0x2f5737+_0x400eec(0x2c6));if(_0x4a88e6&&_0x4a88e6[_0x400eec(0x248)])_0x4a29c6=_0x4a88e6[_0x400eec(0x248)];}else{if(_0x2f5737[_0x400eec(0x21a)](_0x400eec(0x11a))){const _0x583cf8=await _0xabe653['getForeignStateAsync'](_0x2f5737+_0x400eec(0x1a1));if(_0x583cf8&&_0x583cf8[_0x400eec(0x248)])_0x4a29c6=_0x583cf8[_0x400eec(0x248)];}else{if(_0x2f5737[_0x400eec(0x21a)](_0x400eec(0x12b))){const _0x462fd1=await _0xabe653[_0x400eec(0x229)](_0x2f5737+_0x400eec(0x25b));if(_0x462fd1&&_0x462fd1[_0x400eec(0x248)])_0x4a29c6=_0x462fd1[_0x400eec(0x248)];}}}}catch(_0x4880c8){}if(!_0x4a29c6){const _0x44f8a3=[_0x400eec(0x2cd),_0x400eec(0x222),'weatherunderground.0',_0x400eec(0x136)];for(const _0x21a0d0 of _0x44f8a3){try{const _0x1e6881=await _0xabe653['getForeignObjectAsync'](_0x21a0d0);if(_0x1e6881){if(_0x21a0d0[_0x400eec(0x21a)]('accuweather')){const _0x4a3ad2=await _0xabe653[_0x400eec(0x229)](_0x21a0d0+_0x400eec(0x2c6));if(_0x4a3ad2&&_0x4a3ad2[_0x400eec(0x248)]){_0x4a29c6=_0x4a3ad2['val'];break;}}}}catch(_0x1bcdd6){}}}return _0x4a29c6?_0x400eec(0x2d8)+_0x4a29c6:_0x400eec(0x1bc);}catch(_0x34b2ca){return _0x400eec(0x1b0)+_0x34b2ca['message'];}}async function getCalendarContext(_0xa5b11b){const _0x38039d=a0_0x4a1786;try{if(!_0xa5b11b['config'][_0x38039d(0x1c6)])return'Kalender:\x20Deaktiviert';let _0x540111=_0xa5b11b[_0x38039d(0x22b)][_0x38039d(0x1ac)]||'ical.0',_0xdc3fb6=_0xa5b11b['config']['calendarSelection']||[];if(typeof _0xdc3fb6===_0x38039d(0x281))_0xdc3fb6=_0xdc3fb6['split'](',');try{const _0x4563b5=await _0xa5b11b[_0x38039d(0x229)](_0x540111+_0x38039d(0x279));if(_0x4563b5&&_0x4563b5[_0x38039d(0x248)]){let _0x6583a7=tryParse(_0x4563b5['val']);if(_0x6583a7&&Array[_0x38039d(0x1a5)](_0x6583a7)){if(_0xdc3fb6['length']>0x0)_0x6583a7=_0x6583a7[_0x38039d(0x212)](_0x2f899b=>_0xdc3fb6[_0x38039d(0x21a)](_0x2f899b[_0x38039d(0x164)]||''));else return _0x38039d(0x1a7);if(_0x6583a7[_0x38039d(0x240)]>0x0){const _0x1759c9=_0x6583a7[_0x38039d(0x163)](0x0,0x3)[_0x38039d(0x121)](_0x4e167f=>{const _0x240e1e=_0x38039d;let _0x485421=_0x4e167f[_0x240e1e(0x284)];if(_0x4e167f[_0x240e1e(0x1a9)])_0x485421+='\x20'+_0x4e167f[_0x240e1e(0x1a9)];return _0x485421+':\x20'+_0x4e167f[_0x240e1e(0x233)]+'\x20('+_0x4e167f[_0x240e1e(0x164)]+')';});return _0x38039d(0x1f2)+_0x1759c9[_0x38039d(0x1ed)](_0x38039d(0x1fb));}else return _0x38039d(0x293);}}}catch(_0x1f8f6b){_0xa5b11b['log'][_0x38039d(0x13f)](_0x38039d(0x296)+_0x1f8f6b[_0x38039d(0x283)]);}return'KALENDER:\x20Keine\x20Daten';}catch(_0x74fb44){return _0x38039d(0x19b)+_0x74fb44['message'];}}async function getCalendarNames(_0x44ea7b,_0x5f1266){const _0x48158a=a0_0x4a1786;try{const _0x15d83a=await _0x44ea7b['getForeignStateAsync'](_0x5f1266+_0x48158a(0x279));if(_0x15d83a&&_0x15d83a[_0x48158a(0x248)]){const _0x4baa33=tryParse(_0x15d83a[_0x48158a(0x248)]);if(_0x4baa33&&Array[_0x48158a(0x1a5)](_0x4baa33)){const _0x4b0f14=[...new Set(_0x4baa33[_0x48158a(0x121)](_0x1c7dcb=>_0x1c7dcb[_0x48158a(0x164)])['filter'](Boolean))];return _0x4b0f14['sort']();}}return[];}catch(_0x1cb1e2){return _0x44ea7b[_0x48158a(0x172)][_0x48158a(0x1d5)](_0x48158a(0x2eb)+_0x1cb1e2[_0x48158a(0x283)]),[];}}async function checkWifiPresence(_0xf90a72){const _0x51c306=a0_0x4a1786;try{const _0x4d3103=_0xf90a72[_0x51c306(0x22b)]['presenceDevices']||[];let _0xffdd6e=![];const _0x930758=[];for(const _0x3b030b of _0x4d3103){try{const _0x3145dd=await _0xf90a72[_0x51c306(0x229)](_0x3b030b);if(_0x3145dd&&(_0x3145dd[_0x51c306(0x248)]===!![]||_0x3145dd[_0x51c306(0x248)]===_0x51c306(0x19c)||_0x3145dd[_0x51c306(0x248)]===0x1)){_0xffdd6e=!![];const _0x452e26=await _0xf90a72[_0x51c306(0x13c)](_0x3b030b);let _0x16ae17=_0x3b030b;_0x452e26&&_0x452e26[_0x51c306(0x1ff)]&&_0x452e26['common'][_0x51c306(0x161)]&&(_0x16ae17=typeof _0x452e26[_0x51c306(0x1ff)][_0x51c306(0x161)]===_0x51c306(0x2ca)?_0x452e26[_0x51c306(0x1ff)][_0x51c306(0x161)]['de']||_0x452e26[_0x51c306(0x1ff)]['name']['en']:_0x452e26[_0x51c306(0x1ff)][_0x51c306(0x161)]),_0x930758[_0x51c306(0x28e)](_0x16ae17);}}catch(_0x18aad3){}}return await _0xf90a72[_0x51c306(0x215)](_0x51c306(0x25a),{'val':_0x930758['join'](',\x20'),'ack':!![]}),_0xffdd6e&&(_0xf90a72['exitTimer']&&(_0xf90a72[_0x51c306(0x172)][_0x51c306(0x225)](_0x51c306(0x185)),abortExitTimer(_0xf90a72)),!_0xf90a72['isPresent']&&_0xf90a72[_0x51c306(0x159)]===SYSTEM_MODES[_0x51c306(0x170)]&&await setPresence(_0xf90a72,!![])),_0xffdd6e;}catch(_0x3655d8){return _0xf90a72['log'][_0x51c306(0x1d5)](_0x51c306(0x1c4)+_0x3655d8[_0x51c306(0x283)]),![];}}function startExitTimer(_0x1f082c){const _0x45a4de=a0_0x4a1786;abortExitTimer(_0x1f082c),_0x1f082c[_0x45a4de(0x202)]=!![],_0x1f082c['exitGraceTimer']=setTimeout(()=>{const _0x2ce665=_0x45a4de;_0x1f082c[_0x2ce665(0x202)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x1f082c[_0x45a4de(0x186)]=setTimeout(()=>{const _0x590367=_0x45a4de;setPresence(_0x1f082c,![]),_0x1f082c[_0x590367(0x186)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x35df67){const _0x583377=a0_0x4a1786;if(_0x35df67['exitTimer'])clearTimeout(_0x35df67['exitTimer']);if(_0x35df67[_0x583377(0x24c)])clearTimeout(_0x35df67[_0x583377(0x24c)]);_0x35df67['exitTimer']=null,_0x35df67[_0x583377(0x24c)]=null,_0x35df67[_0x583377(0x202)]=![];}async function setPresence(_0x5a82d2,_0x58eeab){const _0x24dd8b=a0_0x4a1786;if(_0x5a82d2['isPresent']===_0x58eeab)return;_0x5a82d2[_0x24dd8b(0x18c)]=_0x58eeab,await _0x5a82d2['setStateAsync']('system.isPresent',{'val':_0x58eeab,'ack':!![]});}async function saveFeedback(_0x16761d,_0x4f4349){const _0x50f9c4=a0_0x4a1786;_0x16761d[_0x50f9c4(0x172)][_0x50f9c4(0x225)](_0x50f9c4(0x17a)+JSON['stringify'](_0x4f4349));}async function runBaselineDriftAnalysis(_0x1bf41a){const _0x4cfdc0=a0_0x4a1786;if(!_0x1bf41a[_0x4cfdc0(0x15b)]||!_0x1bf41a['geminiModel'])return;const _0x2ec874=_0x1bf41a[_0x4cfdc0(0x22b)][_0x4cfdc0(0x1ab)]||0xe;if(_0x1bf41a['dailyDigests']['length']<_0x2ec874+(_0x1bf41a[_0x4cfdc0(0x22b)][_0x4cfdc0(0x1b2)]||0x7)){await _0x1bf41a[_0x4cfdc0(0x215)](LTM_DP_DRIFT_STATUS,{'val':_0x4cfdc0(0x295),'ack':!![]});return;}const _0x2897ee=_0x1bf41a[_0x4cfdc0(0x2a8)][_0x4cfdc0(0x163)](-_0x2ec874),_0x2ea8e1=_0x1bf41a[_0x4cfdc0(0x2a8)][_0x4cfdc0(0x163)](0x0,_0x1bf41a['dailyDigests']['length']-_0x2ec874),_0x80b86e='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x4cfdc0(0x1c3)](_0x2ea8e1)+_0x4cfdc0(0x28a)+JSON[_0x4cfdc0(0x1c3)](_0x2897ee);try{const _0x279717=await _0x1bf41a['geminiModel'][_0x4cfdc0(0x1f5)](_0x80b86e),_0x3bad0d=JSON[_0x4cfdc0(0x15d)](_0x279717[_0x4cfdc0(0x128)][_0x4cfdc0(0x2d5)]()[_0x4cfdc0(0x1c8)](/```json|```/g,'')[_0x4cfdc0(0x22e)]());_0x3bad0d[_0x4cfdc0(0x20b)]&&(await _0x1bf41a['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x3bad0d[_0x4cfdc0(0x20b)],'ack':!![]}),await _0x1bf41a['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x3bad0d['driftDetails'],'ack':!![]}),await _0x1bf41a['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x4cfdc0(0x2a6)](),'ack':!![]}));}catch(_0x3e1f9d){}}function setupLtmScheduler(_0x563162){const _0x2e29d6=a0_0x4a1786;try{if(_0x563162[_0x2e29d6(0x168)])_0x563162[_0x2e29d6(0x168)][_0x2e29d6(0x22a)]();if(!_0x563162['isProVersion']){_0x563162['setStateAsync'](LTM_DP_STATUS,{'val':_0x2e29d6(0x1d9),'ack':!![]});return;}_0x563162[_0x2e29d6(0x168)]=schedule[_0x2e29d6(0x118)](LTM_SCHEDULE,()=>createDailyDigest(_0x563162));}catch(_0x634b24){_0x563162[_0x2e29d6(0x172)][_0x2e29d6(0x1d5)](_0x2e29d6(0x268)+_0x634b24[_0x2e29d6(0x283)]);}}function setupModeResetScheduler(_0x37c0af){const _0xbcfa26=a0_0x4a1786;try{if(_0x37c0af[_0xbcfa26(0x1e0)])_0x37c0af[_0xbcfa26(0x1e0)][_0xbcfa26(0x22a)]();_0x37c0af['modeResetJob']=schedule[_0xbcfa26(0x118)](MODE_RESET_SCHEDULE,async()=>{const _0x1326f9=_0xbcfa26;await loadSystemMode(_0x37c0af),AUTO_RESET_MODES[_0x1326f9(0x21a)](_0x37c0af['currentSystemMode'])&&await _0x37c0af[_0x1326f9(0x215)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x25bc1a){_0x37c0af[_0xbcfa26(0x172)][_0xbcfa26(0x1d5)](_0xbcfa26(0x28f)+_0x25bc1a[_0xbcfa26(0x283)]);}}function setupDriftAnalysisScheduler(_0x56b897){const _0xdbe5f5=a0_0x4a1786;try{if(_0x56b897['driftAnalysisTimer'])clearInterval(_0x56b897[_0xdbe5f5(0x177)]);if(!_0x56b897['isProVersion'])return;_0x56b897[_0xdbe5f5(0x177)]=setInterval(()=>runBaselineDriftAnalysis(_0x56b897),(_0x56b897[_0xdbe5f5(0x22b)]['ltmDriftCheckIntervalHours']||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x56b897),0x1388);}catch(_0x214717){_0x56b897[_0xdbe5f5(0x172)][_0xdbe5f5(0x1d5)](_0xdbe5f5(0x16f)+_0x214717[_0xdbe5f5(0x283)]);}}function setupBriefingScheduler(_0x84f025){const _0x2e76f6=a0_0x4a1786;try{if(_0x84f025[_0x2e76f6(0x125)])_0x84f025['briefingJob'][_0x2e76f6(0x22a)]();if(!_0x84f025[_0x2e76f6(0x22b)]['briefingEnabled'])return;const _0x5203f6=(_0x84f025[_0x2e76f6(0x22b)][_0x2e76f6(0x137)]||_0x2e76f6(0x144))[_0x2e76f6(0x235)](':'),_0x460db1=parseInt(_0x5203f6[0x0])||0x8,_0x1731de=parseInt(_0x5203f6[0x1])||0x0,_0x2df210=_0x1731de+'\x20'+_0x460db1+'\x20*\x20*\x20*';_0x84f025['log']['info'](_0x2e76f6(0x2a4)+_0x460db1+':'+(_0x1731de<0xa?'0'+_0x1731de:_0x1731de)),_0x84f025[_0x2e76f6(0x125)]=schedule['scheduleJob'](_0x2df210,()=>{sendMorningBriefing(_0x84f025);});}catch(_0x34ef22){_0x84f025[_0x2e76f6(0x172)]['error'](_0x2e76f6(0x2ac)+_0x34ef22[_0x2e76f6(0x283)]);}}async function sendNotification(_0x199322,_0x5f2192,_0x1e4e94=![],_0x3de14a=![]){const _0x2762a7=a0_0x4a1786;_0x199322['log']['info']((_0x1e4e94?'[TEST]\x20':'')+_0x2762a7(0x196)+_0x5f2192+'\x22');const _0x4282c2=_0x199322[_0x2762a7(0x22b)];let _0x59adfe=0x0;if(_0x4282c2['notifyTelegramEnabled']){let _0x10ef57={};(_0x5f2192[_0x2762a7(0x21a)](_0x2762a7(0x237))||_0x3de14a)&&(_0x10ef57={'reply_markup':{'inline_keyboard':[[{'text':'‚úÖ\x20Alles\x20OK\x20(Reset)','callback_data':_0x2762a7(0x207)}],[{'text':_0x2762a7(0x2bf),'callback_data':_0x2762a7(0x2be)}]]}}),await _0x199322['sendToAsync'](_0x4282c2['notifyTelegramInstance'],'send',{'text':_0x5f2192,'user':_0x4282c2[_0x2762a7(0x28d)],..._0x10ef57}),_0x59adfe++;}if(_0x4282c2['notifyPushoverEnabled']){let _0x58efdf={'message':_0x5f2192,'title':_0x3de14a?_0x2762a7(0x208):_0x2762a7(0x1f7),'priority':_0x3de14a?0x2:0x1,'device':_0x4282c2[_0x2762a7(0x147)]};_0x3de14a&&(_0x58efdf['retry']=0x1e,_0x58efdf[_0x2762a7(0x2a0)]=0xe10,_0x58efdf[_0x2762a7(0x14d)]=_0x2762a7(0x266)),await _0x199322[_0x2762a7(0x257)](_0x4282c2[_0x2762a7(0x2b7)],_0x2762a7(0x166),_0x58efdf),_0x59adfe++;}return _0x4282c2[_0x2762a7(0x2ce)]&&(await _0x199322[_0x2762a7(0x257)](_0x4282c2['notifyEmailInstance'],_0x2762a7(0x166),{'text':_0x5f2192,'to':_0x4282c2[_0x2762a7(0x262)]}),_0x59adfe++),_0x59adfe;}async function setupTelegramListener(_0x4ce13a){const _0x597466=a0_0x4a1786,_0x503f19=_0x4ce13a[_0x597466(0x22b)][_0x597466(0x29a)];_0x4ce13a[_0x597466(0x22b)]['notifyTelegramEnabled']&&_0x503f19&&(_0x4ce13a['log'][_0x597466(0x225)](_0x597466(0x270)+_0x503f19+_0x597466(0x2bd)),await _0x4ce13a[_0x597466(0x1da)](_0x503f19+_0x597466(0x1eb)));}async function handleTelegramResponse(_0x57d4fd,_0x31360a){const _0x4d7090=a0_0x4a1786;let _0x16561c=_0x31360a;_0x31360a[_0x4d7090(0x1d4)]('[')&&(_0x16561c=_0x31360a[_0x4d7090(0x178)](_0x31360a['indexOf'](']')+0x1));if(_0x16561c===_0x4d7090(0x207))_0x57d4fd[_0x4d7090(0x172)][_0x4d7090(0x225)](_0x4d7090(0x1d8)),await _0x57d4fd['setStateAsync'](_0x4d7090(0x188),{'val':![],'ack':!![]}),await _0x57d4fd[_0x4d7090(0x215)](_0x4d7090(0x1a4),{'val':_0x4d7090(0x1db),'ack':!![]}),_0x57d4fd['lastAlertState']=![],sendNotification(_0x57d4fd,_0x4d7090(0x1fc),![]);else _0x16561c===_0x4d7090(0x2be)&&(_0x57d4fd[_0x4d7090(0x172)][_0x4d7090(0x13f)]('üìû\x20User\x20requested\x20CALL\x20via\x20Telegram!'),sendNotification(_0x57d4fd,_0x4d7090(0x1dd),![],!![]));}async function runAutopilot(_0x113470){const _0x39ba20=a0_0x4a1786,_0x3b6e6b=_0x113470['config'][_0x39ba20(0x2ea)],_0xc64c60=_0x113470[_0x39ba20(0x1e2)][_0x39ba20(0x240)]>0x0?_0x113470[_0x39ba20(0x1e2)][0x0][_0x39ba20(0x1e6)]:Date[_0x39ba20(0x2a6)](),_0x685d23=(Date[_0x39ba20(0x2a6)]()-_0xc64c60)/(0x3e8*0x3c*0x3c);let _0x5e832d='';_0x113470[_0x39ba20(0x22b)][_0x39ba20(0x2e4)]&&_0x113470[_0x39ba20(0x159)]===SYSTEM_MODES[_0x39ba20(0x170)]&&_0x113470[_0x39ba20(0x18c)]&&(_0x685d23>_0x3b6e6b&&(_0x5e832d=_0x39ba20(0x162)+_0x685d23[_0x39ba20(0x20d)](0x1)+_0x39ba20(0x131))),runGeminiAnalysis(_0x113470,_0x5e832d)[_0x39ba20(0x2ab)](_0x48b848=>_0x113470[_0x39ba20(0x172)]['error'](_0x48b848));}async function createDailyDigest(_0x55a589){const _0x5f450c=a0_0x4a1786;if(!_0x55a589['isProVersion'])return;await _0x55a589['setStateAsync'](LTM_DP_STATUS,{'val':_0x5f450c(0x19d)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x55a589[_0x5f450c(0x25e)]||_0x55a589[_0x5f450c(0x152)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x55a589[_0x5f450c(0x215)](LTM_DP_STATUS,{'val':'Skipped\x20(No\x20AI\x20or\x20Data)','ack':!![]});return;}const _0x3ae6b2=JSON[_0x5f450c(0x15d)](JSON[_0x5f450c(0x1c3)](_0x55a589[_0x5f450c(0x152)])),_0x1fae8e=_0x3ae6b2[_0x5f450c(0x240)],_0x2269e5=_0x5f450c(0x29d)+JSON['stringify'](_0x3ae6b2);try{const _0x545d82=await _0x55a589[_0x5f450c(0x25e)]['generateContent'](_0x2269e5),_0x447eff=JSON['parse'](_0x545d82['response'][_0x5f450c(0x2d5)]()['replace'](/```json|```/g,'')[_0x5f450c(0x22e)]());_0x447eff[_0x5f450c(0x1d1)]&&(_0x55a589[_0x5f450c(0x2a8)][_0x5f450c(0x28e)]({'timestamp':new Date()[_0x5f450c(0x277)](),'eventCount':_0x1fae8e,'summary':_0x447eff[_0x5f450c(0x1d1)],'activityLevel':_0x447eff[_0x5f450c(0x189)],'systemMode':_0x55a589['currentSystemMode']}),await saveDailyDigests(_0x55a589),_0x55a589[_0x5f450c(0x152)]=[],await saveRawEventLog(_0x55a589),await _0x55a589['setStateAsync'](LTM_DP_STATUS,{'val':_0x5f450c(0x221)+_0x1fae8e+_0x5f450c(0x26e),'ack':!![]}));}catch(_0x5422ef){await _0x55a589[_0x5f450c(0x215)](LTM_DP_STATUS,{'val':_0x5f450c(0x2c3)+_0x5422ef[_0x5f450c(0x283)],'ack':!![]});}}async function sendMorningBriefing(_0x3713c2){const _0x4627ae=a0_0x4a1786;if(!_0x3713c2[_0x4627ae(0x25e)])return;_0x3713c2[_0x4627ae(0x172)][_0x4627ae(0x225)](_0x4627ae(0x1e7));const _0x344cd3=_0x3713c2[_0x4627ae(0x2a8)]['length']>0x0?_0x3713c2[_0x4627ae(0x2a8)][_0x3713c2[_0x4627ae(0x2a8)]['length']-0x1]:null,_0xb4d335=_0x344cd3&&_0x344cd3[_0x4627ae(0x27d)]?_0x344cd3[_0x4627ae(0x27d)]['sleepScore']:_0x4627ae(0x183),_0xc47864=new Date();_0xc47864[_0x4627ae(0x263)](0x4,0x0,0x0,0x0);const _0x581e3f=_0x3713c2['eventHistory']['filter'](_0x1b517c=>new Date(_0x1b517c[_0x4627ae(0x1e6)])>_0xc47864),_0x371472=PERSONA_MAPPING[_0x3713c2[_0x4627ae(0x22b)]['aiPersona']||'generic'],_0x4c6f32=_0x3713c2[_0x4627ae(0x22b)][_0x4627ae(0x24b)]||'',_0x49e007=await getWeatherContext(_0x3713c2),_0x37a225=await getCalendarContext(_0x3713c2),_0x5cdbf9='ROLLE:\x20F√ºrsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20'+_0x371472+_0x4627ae(0x209)+_0x4c6f32+_0x4627ae(0x24f)+_0x49e007+'\x20'+_0x37a225+_0x4627ae(0x130)+_0xb4d335+_0x4627ae(0x2c7)+JSON[_0x4627ae(0x1c3)](_0x581e3f['slice'](0x0,0xa))+_0x4627ae(0x1bf);try{const _0x3598da=await _0x3713c2[_0x4627ae(0x25e)]['generateContent'](_0x5cdbf9),_0x5df5bb=_0x4627ae(0x27e)+_0x3598da['response']['text']()[_0x4627ae(0x22e)]();sendNotification(_0x3713c2,_0x5df5bb),_0x3713c2[_0x4627ae(0x172)][_0x4627ae(0x225)](_0x4627ae(0x23d));}catch(_0x326945){_0x3713c2[_0x4627ae(0x172)][_0x4627ae(0x1d5)](_0x4627ae(0x174)+_0x326945[_0x4627ae(0x283)]);}}async function scanForDevices(_0x4a7a62,_0x38dd1a){const _0x5bfb25=a0_0x4a1786;_0x4a7a62[_0x5bfb25(0x172)]['info'](_0x5bfb25(0x247));const _0x1c9d56=[],_0x1d14a6=await _0x4a7a62[_0x5bfb25(0x1af)]('*'),_0x7c40e7=await _0x4a7a62[_0x5bfb25(0x1af)](_0x5bfb25(0x11e),'enum'),_0x364a12=await _0x4a7a62[_0x5bfb25(0x1af)](_0x5bfb25(0x258),'enum'),_0x31c8c7={};if(_0x7c40e7)for(const _0x4de4fd in _0x7c40e7){const _0x592374=_0x7c40e7[_0x4de4fd][_0x5bfb25(0x1ff)][_0x5bfb25(0x1d7)]||[];_0x592374[_0x5bfb25(0x24d)](_0x47eb56=>{const _0x3d6358=_0x5bfb25;if(!_0x31c8c7[_0x47eb56])_0x31c8c7[_0x47eb56]=[];_0x31c8c7[_0x47eb56][_0x3d6358(0x28e)](_0x4de4fd);});}const _0x48903b={};if(_0x364a12)for(const _0x6f8bb2 in _0x364a12){const _0x441970=_0x364a12[_0x6f8bb2]['common'][_0x5bfb25(0x1d7)]||[],_0x259a8c=typeof _0x364a12[_0x6f8bb2][_0x5bfb25(0x1ff)][_0x5bfb25(0x161)]===_0x5bfb25(0x2ca)?_0x364a12[_0x6f8bb2][_0x5bfb25(0x1ff)]['name']['de']:_0x364a12[_0x6f8bb2][_0x5bfb25(0x1ff)][_0x5bfb25(0x161)];_0x441970[_0x5bfb25(0x24d)](_0x48c7f5=>_0x48903b[_0x48c7f5]=_0x259a8c);}const _0x431339=_0x38dd1a['selectedFunctionIds']||[],_0x3774cd=_0x38dd1a[_0x5bfb25(0x18d)]!==![],_0x5f1f73=_0x38dd1a[_0x5bfb25(0x16e)]!==![],_0x130fb2=_0x38dd1a[_0x5bfb25(0x289)]!==![],_0x3a2e11=_0x38dd1a[_0x5bfb25(0x133)]===!![],_0xf7634a=_0x38dd1a[_0x5bfb25(0x250)]===!![];for(const _0x2c0fbb in _0x1d14a6){const _0x275537=_0x1d14a6[_0x2c0fbb];if(_0x275537['type']!==_0x5bfb25(0x16a)||!_0x275537[_0x5bfb25(0x1ff)])continue;if(ADAPTER_BLACKLIST[_0x5bfb25(0x20f)](_0x173aff=>_0x2c0fbb[_0x5bfb25(0x1d4)](_0x173aff))&&!_0xf7634a)continue;const _0x27ce62=(_0x275537[_0x5bfb25(0x1ff)][_0x5bfb25(0x1f9)]||'')['toLowerCase']();let _0x471f17=(typeof _0x275537[_0x5bfb25(0x1ff)]['name']===_0x5bfb25(0x2ca)?_0x275537['common'][_0x5bfb25(0x161)]['de']:_0x275537[_0x5bfb25(0x1ff)][_0x5bfb25(0x161)])||_0x2c0fbb;const _0x39b8bf=_0x471f17[_0x5bfb25(0x1fa)]();let _0x1978a3=![],_0x102c75=![];if(_0x431339['length']>0x0){const _0x3e3deb=_0x31c8c7[_0x2c0fbb]||[],_0xcdbad=_0x2c0fbb[_0x5bfb25(0x235)]('.')[_0x5bfb25(0x163)](0x0,-0x1)[_0x5bfb25(0x1ed)]('.'),_0x1f28af=_0x31c8c7[_0xcdbad]||[];(_0x3e3deb[_0x5bfb25(0x20f)](_0x2ab41a=>_0x431339[_0x5bfb25(0x21a)](_0x2ab41a))||_0x1f28af['some'](_0xde8373=>_0x431339[_0x5bfb25(0x21a)](_0xde8373)))&&(_0x1978a3=!![],_0x102c75=!![]);}if(!_0x1978a3&&!_0xf7634a){if(HARD_IGNORE_TERMS[_0x5bfb25(0x20f)](_0x3678c8=>_0x2c0fbb[_0x5bfb25(0x21a)](_0x3678c8)||_0x39b8bf['includes'](_0x3678c8[_0x5bfb25(0x1fa)]())))continue;}if(BAD_NAMES[_0x5bfb25(0x20f)](_0x2a78b8=>_0x39b8bf===_0x2a78b8||_0x39b8bf[_0x5bfb25(0x206)]('.'+_0x2a78b8))){const _0x420e3e=_0x2c0fbb[_0x5bfb25(0x235)]('.');if(_0x420e3e[_0x5bfb25(0x240)]>0x2){const _0x3f00dd=_0x420e3e[_0x5bfb25(0x163)](0x0,-0x1)[_0x5bfb25(0x1ed)]('.'),_0xaa81ff=_0x1d14a6[_0x3f00dd];if(_0xaa81ff&&_0xaa81ff[_0x5bfb25(0x1ff)]&&_0xaa81ff[_0x5bfb25(0x1ff)][_0x5bfb25(0x161)]){const _0x231a74=typeof _0xaa81ff[_0x5bfb25(0x1ff)][_0x5bfb25(0x161)]===_0x5bfb25(0x2ca)?_0xaa81ff['common']['name']['de']:_0xaa81ff[_0x5bfb25(0x1ff)]['name'];_0x231a74&&!_0x471f17[_0x5bfb25(0x21a)](_0x231a74)&&(_0x471f17=_0x231a74+'\x20'+_0x471f17);}}}let _0x52547f='';if(_0x3774cd&&(_0x27ce62[_0x5bfb25(0x21a)](_0x5bfb25(0x18d))||_0x27ce62[_0x5bfb25(0x21a)](_0x5bfb25(0x20c))||_0x39b8bf['includes'](_0x5bfb25(0x122))||_0x39b8bf['includes'](_0x5bfb25(0x246))))_0x52547f=_0x5bfb25(0x18d);else{if(!_0x52547f&&_0x5f1f73&&(_0x27ce62['includes'](_0x5bfb25(0x17e))||_0x27ce62[_0x5bfb25(0x21a)]('window')||_0x27ce62[_0x5bfb25(0x21a)](_0x5bfb25(0x197))||_0x27ce62[_0x5bfb25(0x21a)](_0x5bfb25(0x21c))||_0x27ce62[_0x5bfb25(0x21a)](_0x5bfb25(0x2c0))||_0x39b8bf[_0x5bfb25(0x21a)](_0x5bfb25(0x2d6))||_0x39b8bf[_0x5bfb25(0x21a)]('t√ºr')||_0x39b8bf[_0x5bfb25(0x21a)]('rollladen')))_0x52547f='door';else{if(!_0x52547f&&_0x130fb2&&(_0x27ce62[_0x5bfb25(0x21a)]('light')||_0x27ce62[_0x5bfb25(0x21a)](_0x5bfb25(0x23a))||_0x27ce62[_0x5bfb25(0x21a)](_0x5bfb25(0x1ee))||_0x39b8bf[_0x5bfb25(0x21a)]('licht')||_0x39b8bf[_0x5bfb25(0x21a)]('lampe')||_0x39b8bf[_0x5bfb25(0x21a)](_0x5bfb25(0x1cc)))){if(_0x275537['common'][_0x5bfb25(0x184)]||_0x27ce62['includes'](_0x5bfb25(0x25d)))_0x52547f=_0x5bfb25(0x236);}else{if(!_0x52547f&&_0x3a2e11&&(_0x27ce62[_0x5bfb25(0x21a)]('temperature')||_0x27ce62[_0x5bfb25(0x21a)](_0x5bfb25(0x26f))||_0x27ce62['includes'](_0x5bfb25(0x232))||_0x39b8bf[_0x5bfb25(0x21a)](_0x5bfb25(0x1b8))||_0x39b8bf['includes'](_0x5bfb25(0x14a))||_0x39b8bf[_0x5bfb25(0x21a)](_0x5bfb25(0x200))))_0x52547f=_0x5bfb25(0x133);else{if(!_0x52547f&&_0x102c75)_0x52547f='custom';}}}}if(_0x52547f){let _0x58cd2d=_0x48903b[_0x2c0fbb]||'';if(!_0x58cd2d){let _0x49d8ef=_0x2c0fbb;for(let _0x3fb7ea=0x0;_0x3fb7ea<0x3;_0x3fb7ea++){const _0x3aa74d=_0x49d8ef[_0x5bfb25(0x123)]('.');if(_0x3aa74d===-0x1)break;_0x49d8ef=_0x49d8ef[_0x5bfb25(0x178)](0x0,_0x3aa74d);if(_0x48903b[_0x49d8ef]){_0x58cd2d=_0x48903b[_0x49d8ef];break;}}}_0x1c9d56[_0x5bfb25(0x28e)]({'id':_0x2c0fbb,'name':_0x471f17,'location':_0x58cd2d,'type':_0x52547f,'logDuplicates':_0x52547f==='motion','isExit':![],'_score':_0x58cd2d?0x50:_0x52547f==='custom'?0x5a:0x28});}}return _0x1c9d56[_0x5bfb25(0x18a)]((_0x3aeac5,_0x305958)=>_0x305958['_score']-_0x3aeac5[_0x5bfb25(0x1d3)]),_0x1c9d56;}async function executeAutomationAction(_0x5af550){const _0x4746d6=a0_0x4a1786;try{const _0x338eb6=await _0x5af550['getStateAsync'](_0x4746d6(0x249)),_0x23c036=await _0x5af550[_0x4746d6(0x260)]('analysis.automation.targetValue');if(_0x338eb6&&_0x338eb6['val']&&_0x23c036){const _0x306408=_0x338eb6[_0x4746d6(0x248)];let _0x419ef7=_0x23c036['val'];try{_0x419ef7=JSON[_0x4746d6(0x15d)](_0x419ef7);}catch(_0x2a3969){}_0x5af550[_0x4746d6(0x172)]['info'](_0x4746d6(0x13d)+_0x306408+'\x20=\x20'+_0x419ef7),await _0x5af550[_0x4746d6(0x1ea)](_0x306408,_0x419ef7);}else _0x5af550[_0x4746d6(0x172)][_0x4746d6(0x13f)](_0x4746d6(0x2e7));}catch(_0x5ecdcd){_0x5af550['log'][_0x4746d6(0x1d5)](_0x4746d6(0x276)+_0x5ecdcd[_0x4746d6(0x283)]);}}function tryParse(_0xd58527){const _0x49243f=a0_0x4a1786;try{return JSON[_0x49243f(0x15d)](_0xd58527);}catch(_0x553886){return null;}}async function processSensorEvent(_0x41fff7,_0x22f59d,_0x23dca2,_0x3647d1){const _0x54f826=a0_0x4a1786;if(!_0x3647d1)return;const _0x236aff=_0x23dca2['val'],_0x6fb0aa=Date[_0x54f826(0x2a6)]();_0x41fff7[_0x54f826(0x172)][_0x54f826(0x1dc)](_0x54f826(0x22c)+_0x22f59d+_0x54f826(0x1ad)+_0x236aff);const _0x5075a8=_0x41fff7[_0x54f826(0x217)][_0x22f59d];_0x41fff7[_0x54f826(0x217)][_0x22f59d]=_0x236aff;if(!_0x3647d1['logDuplicates']&&_0x5075a8!=undefined&&_0x5075a8==_0x236aff){_0x41fff7['log'][_0x54f826(0x1dc)](_0x54f826(0x2d2)+_0x3647d1[_0x54f826(0x161)]+_0x54f826(0x2ae)+_0x236aff+')');return;}const _0x15e856={'timestamp':_0x6fb0aa,'id':_0x22f59d,'name':_0x3647d1['name'],'type':_0x3647d1[_0x54f826(0x230)],'location':_0x3647d1[_0x54f826(0x23c)],'value':_0x236aff};_0x41fff7['eventHistory']['unshift'](_0x15e856);if(_0x41fff7['eventHistory'][_0x54f826(0x240)]>HISTORY_MAX_SIZE)_0x41fff7[_0x54f826(0x1e2)][_0x54f826(0x1c5)]();await _0x41fff7[_0x54f826(0x215)](_0x54f826(0x1cf),{'val':JSON[_0x54f826(0x1c3)](_0x15e856),'ack':!![]}),await _0x41fff7[_0x54f826(0x215)](_0x54f826(0x267),{'val':JSON[_0x54f826(0x1c3)](_0x41fff7[_0x54f826(0x1e2)]),'ack':!![]});_0x41fff7[_0x54f826(0x15b)]&&(_0x41fff7[_0x54f826(0x152)][_0x54f826(0x28e)](_0x15e856),await saveRawEventLog(_0x41fff7));if(_0x3647d1[_0x54f826(0x2d4)]&&_0x236aff===!![]){if(_0x41fff7[_0x54f826(0x18c)]&&!_0x41fff7['isGracePeriodActive'])_0x41fff7[_0x54f826(0x172)][_0x54f826(0x225)](_0x54f826(0x127)+_0x3647d1['name']+_0x54f826(0x298)),startExitTimer(_0x41fff7);else!_0x41fff7[_0x54f826(0x18c)]&&(_0x41fff7[_0x54f826(0x172)]['info'](_0x54f826(0x1e4)+_0x3647d1[_0x54f826(0x161)]+_0x54f826(0x2a5)),await setPresence(_0x41fff7,!![]));}else _0x3647d1[_0x54f826(0x230)]==='motion'&&_0x236aff===!![]&&(_0x41fff7[_0x54f826(0x186)]&&(_0x41fff7['log'][_0x54f826(0x225)](_0x54f826(0x182)),abortExitTimer(_0x41fff7)),!_0x41fff7[_0x54f826(0x18c)]&&_0x41fff7[_0x54f826(0x159)]===SYSTEM_MODES[_0x54f826(0x170)]&&await setPresence(_0x41fff7,!![]));}async function runGeminiAnalysis(_0xa9ca0f,_0xac09e9=''){const _0xbae8e9=a0_0x4a1786;if(!_0xa9ca0f[_0xbae8e9(0x25e)])return;if(_0xa9ca0f['eventHistory'][_0xbae8e9(0x240)]===0x0)return;const _0x32d947=_0xa9ca0f['eventHistory'][_0xbae8e9(0x163)](0x0,0xf),_0x2a5b19=await getWeatherContext(_0xa9ca0f),_0x4f3d7c=_0xa9ca0f['currentSystemMode'],_0x7bafaa=PERSONA_MAPPING[_0xa9ca0f[_0xbae8e9(0x22b)][_0xbae8e9(0x27f)]||_0xbae8e9(0x1d2)],_0x1a2111=_0xa9ca0f['config'][_0xbae8e9(0x24b)]||'Keine\x20Details.';let _0x219b10=![];try{const _0x29a002=await _0xa9ca0f[_0xbae8e9(0x260)](_0xbae8e9(0x231));if(_0x29a002&&_0x29a002['val'])_0x219b10=!![];}catch(_0x5c08cf){}const _0xe9a4c4=_0xbae8e9(0x2e1)+_0x7bafaa+_0xbae8e9(0x29e)+_0x1a2111+'.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20'+_0x4f3d7c+_0xbae8e9(0x2a3)+_0x2a5b19+'.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20'+(_0xac09e9||_0xbae8e9(0x2d3))+_0xbae8e9(0x218)+JSON['stringify'](_0x32d947)+_0xbae8e9(0x14b);try{const _0x2e243c=await _0xa9ca0f[_0xbae8e9(0x25e)]['generateContent'](_0xe9a4c4),_0x9b2abc=_0x2e243c[_0xbae8e9(0x128)][_0xbae8e9(0x2d5)]()[_0xbae8e9(0x1c8)](/```json|```/g,'')[_0xbae8e9(0x22e)](),_0x2fbc49=JSON['parse'](_0x9b2abc);await _0xa9ca0f[_0xbae8e9(0x215)](_0xbae8e9(0x2dc),{'val':JSON[_0xbae8e9(0x1c3)](_0x2fbc49),'ack':!![]});const _0x350b86=_0x2fbc49[_0xbae8e9(0x214)]||![];_0x350b86!==_0xa9ca0f[_0xbae8e9(0x193)]&&(await _0xa9ca0f['setStateAsync'](_0xbae8e9(0x188),{'val':_0x350b86,'ack':!![]}),_0xa9ca0f[_0xbae8e9(0x193)]=_0x350b86,_0x350b86&&(await _0xa9ca0f['setStateAsync'](_0xbae8e9(0x1a4),{'val':_0x2fbc49[_0xbae8e9(0x21e)],'ack':!![]}),sendNotification(_0xa9ca0f,_0xbae8e9(0x2b8)+_0x2fbc49[_0xbae8e9(0x21e)],![],_0x2fbc49[_0xbae8e9(0x26b)]))),_0x2fbc49[_0xbae8e9(0x132)]&&_0x2fbc49[_0xbae8e9(0x132)][_0xbae8e9(0x116)]&&_0x2fbc49[_0xbae8e9(0x132)]['targetId']&&(_0xa9ca0f[_0xbae8e9(0x172)][_0xbae8e9(0x225)]('ü§ñ\x20BUTLER\x20PROPOSAL:\x20'+_0x2fbc49[_0xbae8e9(0x132)]['description']),await _0xa9ca0f['setStateAsync'](_0xbae8e9(0x254),{'val':!![],'ack':!![]}),await _0xa9ca0f[_0xbae8e9(0x215)](_0xbae8e9(0x226),{'val':_0x2fbc49[_0xbae8e9(0x132)][_0xbae8e9(0x29c)],'ack':!![]}),await _0xa9ca0f['setStateAsync'](_0xbae8e9(0x249),{'val':_0x2fbc49[_0xbae8e9(0x132)][_0xbae8e9(0x120)],'ack':!![]}),await _0xa9ca0f['setStateAsync'](_0xbae8e9(0x291),{'val':JSON[_0xbae8e9(0x1c3)](_0x2fbc49[_0xbae8e9(0x132)][_0xbae8e9(0x17d)]),'ack':!![]}),_0x219b10&&(_0xa9ca0f['log'][_0xbae8e9(0x225)](_0xbae8e9(0x255)+_0x2fbc49[_0xbae8e9(0x132)]['targetId']+'...'),await executeAutomationAction(_0xa9ca0f)));}catch(_0x478e2c){_0xa9ca0f[_0xbae8e9(0x172)][_0xbae8e9(0x1d5)](_0xbae8e9(0x1d0)+_0x478e2c['message']);}}function installPythonDependencies(_0x170cfc){const _0x122cf6=a0_0x4a1786;if(_0x170cfc[_0x122cf6(0x129)])return;_0x170cfc['dependencyInstallInProgress']=!![];const _0x4be6f8=path['join'](__dirname,'python_service','requirements.txt');_0x170cfc[_0x122cf6(0x172)][_0x122cf6(0x225)]('üõ†Ô∏è\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20'+_0x4be6f8+_0x122cf6(0x199)),stopPythonService(_0x170cfc);const _0x204ad6=_0x122cf6(0x1b6)+_0x4be6f8+_0x122cf6(0x29b);exec(_0x204ad6,(_0x44cf15,_0x26a1c6,_0xe48a2a)=>{const _0x8d8cb2=_0x122cf6;_0x170cfc[_0x8d8cb2(0x129)]=![],_0x44cf15?(_0x170cfc[_0x8d8cb2(0x172)][_0x8d8cb2(0x1d5)]('‚ùå\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20'+_0x204ad6),_0x170cfc[_0x8d8cb2(0x172)][_0x8d8cb2(0x1d5)](_0x8d8cb2(0x14f)+(_0xe48a2a||_0x44cf15[_0x8d8cb2(0x283)]))):(_0x170cfc[_0x8d8cb2(0x172)][_0x8d8cb2(0x225)](_0x8d8cb2(0x12a)),startPythonService(_0x170cfc));});}function startPythonService(_0x293f48){const _0x573f43=a0_0x4a1786;try{const _0x18e5a9=path[_0x573f43(0x1ed)](__dirname,_0x573f43(0x16d),_0x573f43(0x2b0));_0x293f48[_0x573f43(0x172)][_0x573f43(0x225)](_0x573f43(0x143)+_0x18e5a9),_0x293f48[_0x573f43(0x285)]=spawn(_0x573f43(0x24e),[_0x18e5a9]),_0x293f48['pythonProcess'][_0x573f43(0x139)]['on'](_0x573f43(0x201),_0x5c936c=>{const _0x3ac8fb=_0x573f43,_0x2b4559=_0x5c936c[_0x3ac8fb(0x2c8)]()[_0x3ac8fb(0x22e)]();_0x293f48[_0x3ac8fb(0x172)][_0x3ac8fb(0x1dc)](_0x3ac8fb(0x1ca)+_0x2b4559),(_0x2b4559[_0x3ac8fb(0x21a)](_0x3ac8fb(0x2a2))||_0x2b4559['includes'](_0x3ac8fb(0x17f)))&&(_0x293f48[_0x3ac8fb(0x172)][_0x3ac8fb(0x13f)](_0x3ac8fb(0x238)),installPythonDependencies(_0x293f48));}),_0x293f48[_0x573f43(0x285)][_0x573f43(0x2a7)]['on'](_0x573f43(0x201),_0xa46d28=>{const _0x294a10=_0x573f43,_0x43952b=_0xa46d28['toString']()[_0x294a10(0x22e)]();_0x293f48[_0x294a10(0x172)][_0x294a10(0x1d5)](_0x294a10(0x224)+_0x43952b);}),_0x293f48['pythonProcess']['on'](_0x573f43(0x2da),_0x35f6d0=>{const _0x3f8b22=_0x573f43;_0x293f48[_0x3f8b22(0x172)][_0x3f8b22(0x225)]('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x35f6d0),_0x293f48[_0x3f8b22(0x285)]=null;}),_0x293f48[_0x573f43(0x285)]['on'](_0x573f43(0x1d5),_0x3b3dd2=>{const _0x3ace1c=_0x573f43;_0x293f48[_0x3ace1c(0x172)]['warn'](_0x3ace1c(0x1b9)+_0x3b3dd2['message']);});}catch(_0x5068e9){_0x293f48['log']['error'](_0x573f43(0x1c9)+_0x5068e9[_0x573f43(0x283)]);}}function stopPythonService(_0x45b72a){const _0x2cb585=a0_0x4a1786;if(_0x45b72a['pythonProcess']){_0x45b72a['log']['info'](_0x2cb585(0x148));try{_0x45b72a[_0x2cb585(0x285)]['kill']();}catch(_0x5a0b8d){_0x45b72a['log'][_0x2cb585(0x13f)]('Could\x20not\x20kill\x20Python\x20process:\x20'+_0x5a0b8d['message']);}_0x45b72a[_0x2cb585(0x285)]=null;}}class CogniLiving extends utils[a0_0x4a1786(0x117)]{constructor(_0x1e36a1){const _0x120a00=a0_0x4a1786;super({..._0x1e36a1,'name':_0x120a00(0x2ec)}),this['eventHistory']=[],this[_0x120a00(0x22d)]=[],this[_0x120a00(0x2bb)]=[],this['rawEventLog']=[],this[_0x120a00(0x2a8)]=[],this[_0x120a00(0x217)]={},this[_0x120a00(0x1f0)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x120a00(0x18c)]=!![],this[_0x120a00(0x186)]=null,this[_0x120a00(0x24c)]=null,this[_0x120a00(0x202)]=![],this[_0x120a00(0x1c7)]=null,this['geminiModel']=null,this[_0x120a00(0x159)]=SYSTEM_MODES[_0x120a00(0x170)],this[_0x120a00(0x15b)]=![],this[_0x120a00(0x193)]=![],this[_0x120a00(0x2e2)]=_0x120a00(0x1c0),this[_0x120a00(0x160)]=null,this[_0x120a00(0x168)]=null,this[_0x120a00(0x1e0)]=null,this[_0x120a00(0x177)]=null,this[_0x120a00(0x125)]=null,this['pythonProcess']=null,this[_0x120a00(0x129)]=![],this['on'](_0x120a00(0x223),this[_0x120a00(0x1fd)][_0x120a00(0x2e5)](this)),this['on'](_0x120a00(0x149),this[_0x120a00(0x205)][_0x120a00(0x2e5)](this)),this['on'](_0x120a00(0x228),this[_0x120a00(0x1e5)][_0x120a00(0x2e5)](this)),this['on'](_0x120a00(0x283),this[_0x120a00(0x14c)][_0x120a00(0x2e5)](this));}async[a0_0x4a1786(0x1fd)](){const _0x4a2e67=a0_0x4a1786;this['log'][_0x4a2e67(0x225)]('cogni-living\x20adapter\x20starting\x20(v'+this[_0x4a2e67(0x18e)]+_0x4a2e67(0x169)),await initZombies(this),this[_0x4a2e67(0x22b)][_0x4a2e67(0x27b)]=this['config'][_0x4a2e67(0x27b)]||'';try{this['isProVersion']=await checkLicense(this,this[_0x4a2e67(0x22b)][_0x4a2e67(0x27b)]);}catch(_0x4ed5c3){}if(!this['config'][_0x4a2e67(0x2ea)]||this['config']['inactivityThresholdHours']<0.1)this[_0x4a2e67(0x22b)]['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x4a2e67(0x22b)][_0x4a2e67(0x18f)])try{this['genAI']=new GoogleGenerativeAI(this[_0x4a2e67(0x22b)][_0x4a2e67(0x18f)]),this[_0x4a2e67(0x25e)]=this[_0x4a2e67(0x1c7)][_0x4a2e67(0x195)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x4a2e67(0x12e)}}),this['log'][_0x4a2e67(0x225)](_0x4a2e67(0x2a1));}catch(_0x3a07b6){this['log'][_0x4a2e67(0x1d5)](_0x4a2e67(0x2af)+_0x3a07b6[_0x4a2e67(0x283)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x4a2e67(0x211)](_0x4a2e67(0x151)),this[_0x4a2e67(0x211)](LTM_DP_TRIGGER_DIGEST),this[_0x4a2e67(0x211)](_0x4a2e67(0x271)),this[_0x4a2e67(0x211)](_0x4a2e67(0x13e)),this['subscribeStates'](_0x4a2e67(0x2e3)),this[_0x4a2e67(0x211)](_0x4a2e67(0x231)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x4a2e67(0x160)])clearInterval(this['analysisTimer']);const _0x26b436=this[_0x4a2e67(0x22b)][_0x4a2e67(0x2b6)]||0xf;_0x26b436>0x0&&(this[_0x4a2e67(0x172)][_0x4a2e67(0x225)](_0x4a2e67(0x290)+_0x26b436+_0x4a2e67(0x265)),this[_0x4a2e67(0x160)]=setInterval(()=>{runAutopilot(this);},_0x26b436*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this);}[a0_0x4a1786(0x1e5)](_0x1e17fd){const _0x27ef55=a0_0x4a1786;if(this[_0x27ef55(0x160)])clearInterval(this['analysisTimer']);if(this[_0x27ef55(0x177)])clearInterval(this[_0x27ef55(0x177)]);if(this[_0x27ef55(0x168)])this[_0x27ef55(0x168)][_0x27ef55(0x22a)]();if(this['modeResetJob'])this[_0x27ef55(0x1e0)]['cancel']();if(this[_0x27ef55(0x125)])this['briefingJob']['cancel']();if(this[_0x27ef55(0x186)])clearTimeout(this['exitTimer']);if(this['exitGraceTimer'])clearTimeout(this[_0x27ef55(0x24c)]);stopPythonService(this),_0x1e17fd();}async[a0_0x4a1786(0x205)](_0x2ad09b,_0x48b443){const _0x2d8358=a0_0x4a1786;if(!_0x48b443)return;if(_0x2ad09b[_0x2d8358(0x21a)](_0x2d8358(0x175))&&_0x2ad09b[_0x2d8358(0x206)](_0x2d8358(0x23e))&&_0x48b443[_0x2d8358(0x248)]){await handleTelegramResponse(this,_0x48b443['val']);return;}if(_0x2ad09b===this[_0x2d8358(0x191)]+'.'+SYSTEM_DP_MODE){_0x48b443[_0x2d8358(0x248)]&&Object[_0x2d8358(0x23f)](SYSTEM_MODES)['includes'](_0x48b443[_0x2d8358(0x248)])&&(this['currentSystemMode']=_0x48b443[_0x2d8358(0x248)],_0x48b443[_0x2d8358(0x248)]===SYSTEM_MODES['VACATION']?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x48b443[_0x2d8358(0x2b9)])this['setState'](_0x2ad09b,{'val':this[_0x2d8358(0x159)],'ack':!![]});return;}if(!_0x48b443['ack']){_0x2ad09b[_0x2d8358(0x21a)](_0x2d8358(0x151))&&_0x48b443[_0x2d8358(0x248)]&&(this['setState'](_0x2ad09b,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x2ad09b[_0x2d8358(0x21a)](_0x2d8358(0x187))&&_0x48b443['val']){this[_0x2d8358(0x179)](_0x2ad09b,{'val':![],'ack':!![]});if(this[_0x2d8358(0x15b)])createDailyDigest(this);}_0x2ad09b[_0x2d8358(0x21a)](_0x2d8358(0x241))&&_0x48b443[_0x2d8358(0x248)]&&(this[_0x2d8358(0x179)](_0x2ad09b,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x2ad09b[_0x2d8358(0x21a)](_0x2d8358(0x239))&&_0x48b443[_0x2d8358(0x248)]&&(this[_0x2d8358(0x179)](_0x2ad09b,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x2d8358(0x22b)][_0x2d8358(0x1cb)]&&this[_0x2d8358(0x22b)][_0x2d8358(0x1cb)][_0x2d8358(0x21a)](_0x2ad09b)){await checkWifiPresence(this);return;}const _0x5700f4=(this[_0x2d8358(0x22b)][_0x2d8358(0x1b4)]||[])['find'](_0x54fb9e=>_0x54fb9e['id']===_0x2ad09b);if(_0x5700f4)processSensorEvent(this,_0x2ad09b,_0x48b443,_0x5700f4);}async[a0_0x4a1786(0x14c)](_0x1fd297){const _0x4d6851=a0_0x4a1786;if(typeof _0x1fd297===_0x4d6851(0x2ca)&&_0x1fd297[_0x4d6851(0x283)])try{if(_0x1fd297['command']==='testApiKey'){}else{if(_0x1fd297[_0x4d6851(0x18b)]==='testNotification'){}else{if(_0x1fd297[_0x4d6851(0x18b)]===_0x4d6851(0x1e9)){if(!this[_0x4d6851(0x15b)])return this[_0x4d6851(0x115)](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297[_0x4d6851(0x18b)],{'success':![],'isPro':![]},_0x1fd297['callback']);let _0x41af03={'status':_0x4d6851(0x183),'details':'','lastCheck':0x0};try{_0x41af03['status']=(await this[_0x4d6851(0x260)](LTM_DP_DRIFT_STATUS))['val'],_0x41af03[_0x4d6851(0x2de)]=(await this[_0x4d6851(0x260)](LTM_DP_DRIFT_DETAILS))['val'],_0x41af03[_0x4d6851(0x275)]=(await this[_0x4d6851(0x260)](LTM_DP_DRIFT_LAST_CHECK))[_0x4d6851(0x248)];}catch(_0x802c81){}const _0x53f79e=this[_0x4d6851(0x22d)]||[];this[_0x4d6851(0x115)](_0x1fd297['from'],_0x1fd297[_0x4d6851(0x18b)],{'success':!![],'isPro':!![],'dailyDigests':this['dailyDigests'],'driftAnalysis':_0x41af03,'analysisHistory':_0x53f79e},_0x1fd297['callback']);}else{if(_0x1fd297['command']===_0x4d6851(0x12d)){const _0x1dd9b7=this['dailyDigests']['length'],_0x2dacfc=new Date(),_0x1daf4a=new Date(_0x2dacfc[_0x4d6851(0x158)](),_0x2dacfc[_0x4d6851(0x210)](),_0x2dacfc['getDate']())[_0x4d6851(0x280)](),_0x1655e3=this[_0x4d6851(0x152)][_0x4d6851(0x212)](_0x3ab680=>new Date(_0x3ab680['timestamp'])['getTime']()>_0x1daf4a)[_0x4d6851(0x240)],_0x1a7538=new Array(0x18)[_0x4d6851(0x2b3)](0x0);this[_0x4d6851(0x152)]['forEach'](_0x20418a=>{const _0x420a58=_0x4d6851,_0x8b62cf=new Date(_0x20418a[_0x420a58(0x1e6)]);if(_0x8b62cf['getTime']()>_0x1daf4a)_0x1a7538[_0x8b62cf[_0x420a58(0x2e8)]()]++;});let _0x53ce1e={'status':_0x4d6851(0x183)};try{_0x53ce1e['status']=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))['val'];}catch(_0x4b942e){}let _0x483521='';try{const _0x3ae855=await this[_0x4d6851(0x260)](_0x4d6851(0x25a));_0x483521=_0x3ae855?_0x3ae855[_0x4d6851(0x248)]:'';}catch(_0x64bae4){}let _0x523a44=null;!this[_0x4d6851(0x25e)]&&(_0x523a44=this[_0x4d6851(0x22b)][_0x4d6851(0x18f)]?'KI-Modell\x20nicht\x20initialisiert':'Kein\x20API\x20Key!');let _0x5cfcdc={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0xb415a=await this[_0x4d6851(0x260)](_0x4d6851(0x254)),_0x19c6b1=await this['getStateAsync']('analysis.automation.description'),_0x131100=await this[_0x4d6851(0x260)](_0x4d6851(0x249)),_0x46d219=await this[_0x4d6851(0x260)](_0x4d6851(0x291)),_0x51a174=await this[_0x4d6851(0x260)](_0x4d6851(0x231));_0xb415a&&_0xb415a['val']&&(_0x5cfcdc[_0x4d6851(0x116)]=!![],_0x5cfcdc[_0x4d6851(0x29c)]=_0x19c6b1?_0x19c6b1[_0x4d6851(0x248)]:'',_0x5cfcdc['targetId']=_0x131100?_0x131100['val']:'',_0x5cfcdc['targetValue']=_0x46d219?_0x46d219['val']:''),_0x5cfcdc[_0x4d6851(0x2df)]=_0x51a174?!!_0x51a174[_0x4d6851(0x248)]:![];}catch(_0x3dc4b1){}this[_0x4d6851(0x115)](_0x1fd297['from'],_0x1fd297[_0x4d6851(0x18b)],{'success':!![],'eventHistory':this[_0x4d6851(0x1e2)][_0x4d6851(0x163)](0x0,0xf),'stats':{'digestCount':_0x1dd9b7,'eventCountToday':_0x1655e3,'hourlyActivity':_0x1a7538,'driftStatus':_0x53ce1e[_0x4d6851(0x1aa)],'isPresent':this[_0x4d6851(0x18c)],'presenceWho':_0x483521,'minDays':this['config'][_0x4d6851(0x1b2)]||0x7,'stbDays':this[_0x4d6851(0x22b)][_0x4d6851(0x1ab)]||0xe,'ltbDays':this['config'][_0x4d6851(0x20e)]||0x3c,'systemError':_0x523a44},'automation':_0x5cfcdc},_0x1fd297[_0x4d6851(0x173)]);}else{if(_0x1fd297[_0x4d6851(0x18b)]==='getEnums'){const _0x1bd865=await this[_0x4d6851(0x1af)](_0x4d6851(0x11e),_0x4d6851(0x1a2)),_0x78f0d3=[];if(_0x1bd865)for(const _0x3a8ee7 in _0x1bd865){const _0xa27da8=_0x1bd865[_0x3a8ee7],_0x18d03f=(_0xa27da8[_0x4d6851(0x1ff)]&&typeof _0xa27da8[_0x4d6851(0x1ff)][_0x4d6851(0x161)]==='object'?_0xa27da8[_0x4d6851(0x1ff)][_0x4d6851(0x161)]['de']:_0xa27da8[_0x4d6851(0x1ff)][_0x4d6851(0x161)])||_0xa27da8[_0x4d6851(0x1ff)][_0x4d6851(0x161)];_0x78f0d3[_0x4d6851(0x28e)]({'id':_0x3a8ee7,'name':_0x18d03f});}this['sendTo'](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297[_0x4d6851(0x18b)],{'success':!![],'enums':_0x78f0d3},_0x1fd297[_0x4d6851(0x173)]);}else{if(_0x1fd297[_0x4d6851(0x18b)]==='scanDevices')try{const _0x32d58f=await scanForDevices(this,_0x1fd297[_0x4d6851(0x283)]||{});this[_0x4d6851(0x115)](_0x1fd297['from'],_0x1fd297[_0x4d6851(0x18b)],{'success':!![],'devices':_0x32d58f},_0x1fd297[_0x4d6851(0x173)]);}catch(_0x5387b5){this[_0x4d6851(0x115)](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297[_0x4d6851(0x18b)],{'success':![],'error':_0x5387b5[_0x4d6851(0x283)]},_0x1fd297['callback']);}else{if(_0x1fd297[_0x4d6851(0x18b)]===_0x4d6851(0x2c9)){const _0x2063b7=_0x1fd297[_0x4d6851(0x283)][_0x4d6851(0x12f)];if(!_0x2063b7)return this[_0x4d6851(0x115)](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297[_0x4d6851(0x18b)],{'success':![],'error':_0x4d6851(0x126)},_0x1fd297[_0x4d6851(0x173)]);const _0x1b0fa2=await getCalendarNames(this,_0x2063b7);this[_0x4d6851(0x115)](_0x1fd297['from'],_0x1fd297[_0x4d6851(0x18b)],{'success':!![],'names':_0x1b0fa2},_0x1fd297[_0x4d6851(0x173)]);}else{if(_0x1fd297['command']==='simulateButler'){const {targetId:_0x3896b7,targetValue:_0x47b228}=_0x1fd297[_0x4d6851(0x283)];this[_0x4d6851(0x172)]['info']('üß™\x20Simulating\x20Butler\x20Proposal:\x20'+_0x3896b7+'\x20=\x20'+_0x47b228),await this[_0x4d6851(0x215)](_0x4d6851(0x254),{'val':!![],'ack':!![]}),await this[_0x4d6851(0x215)]('analysis.automation.description',{'val':_0x4d6851(0x273)+_0x3896b7,'ack':!![]}),await this[_0x4d6851(0x215)](_0x4d6851(0x249),{'val':_0x3896b7,'ack':!![]}),await this['setStateAsync']('analysis.automation.targetValue',{'val':_0x47b228,'ack':!![]}),this[_0x4d6851(0x115)](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297[_0x4d6851(0x18b)],{'success':!![]},_0x1fd297[_0x4d6851(0x173)]);}else{if(_0x1fd297[_0x4d6851(0x18b)]===_0x4d6851(0x141)){const {historyId:_0x1cfba9,rating:_0x13def3,comment:_0x34b06d,alertReason:_0x5bdd61}=_0x1fd297[_0x4d6851(0x283)];_0x1cfba9&&_0x13def3?(await saveFeedback(this,{'timestamp':Date[_0x4d6851(0x2a6)](),'historyId':_0x1cfba9,'rating':_0x13def3,'comment':_0x34b06d,'alertReason':_0x5bdd61}),this[_0x4d6851(0x115)](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297[_0x4d6851(0x18b)],{'success':!![]},_0x1fd297[_0x4d6851(0x173)])):this[_0x4d6851(0x115)](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297['command'],{'success':![],'error':_0x4d6851(0x1a0)},_0x1fd297[_0x4d6851(0x173)]);}else _0x1fd297['command']==='dismissAutomation'&&(this[_0x4d6851(0x172)][_0x4d6851(0x225)](_0x4d6851(0x2b4)),await this[_0x4d6851(0x215)](_0x4d6851(0x254),{'val':![],'ack':!![]}),await this[_0x4d6851(0x215)](_0x4d6851(0x226),{'val':'','ack':!![]}),this[_0x4d6851(0x115)](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297[_0x4d6851(0x18b)],{'success':!![]},_0x1fd297[_0x4d6851(0x173)]));}}}}}}}}}catch(_0x450ff8){this[_0x4d6851(0x172)][_0x4d6851(0x1d5)](_0x4d6851(0x292)+_0x1fd297[_0x4d6851(0x18b)]+':\x20'+_0x450ff8['message']);if(_0x1fd297[_0x4d6851(0x173)])this['sendTo'](_0x1fd297[_0x4d6851(0x2db)],_0x1fd297[_0x4d6851(0x18b)],{'success':![],'error':_0x450ff8[_0x4d6851(0x283)]},_0x1fd297[_0x4d6851(0x173)]);}}}if(require[a0_0x4a1786(0x244)]!==module)module[a0_0x4a1786(0x27a)]=_0x5805b0=>new CogniLiving(_0x5805b0);else new CogniLiving();